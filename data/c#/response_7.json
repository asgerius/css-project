[{"tags": ["c#", ".net", "windows", "winforms"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1424908898, "post_id": 28732078, "comment_id": 45750158, "body": "What was the &#39;open&#39; command you specified when registering your file extension?"}, {"owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1424909740, "post_id": 28732078, "comment_id": 45750397, "body": "My manifest file has this line: &lt;fileAssociation extension=&quot;.psi&quot; description=&quot;PSISuite Project File&quot; progid=&quot;01&quot; defaultIcon=&quot;favicon.ico&quot; xmlns=&quot;urn:schemas-microsoft-com:clickonce.v1&quot; /&gt;"}, {"owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1424910066, "post_id": 28732078, "comment_id": 45750500, "body": "Sorry,  Rufus L your link doesn&#39;t really have answer to my question."}], "answers": [{"comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1424915438, "post_id": 28732461, "comment_id": 45751911, "body": "Copy-pasting whole answer is generally not recommended - you could flag your question to be closed as duplicate (which is perfectly fine way to mark question as solved problem)."}], "tags": [], "owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "is_accepted": false, "score": 2, "last_activity_date": 1449773858, "last_edit_date": 1495540324, "creation_date": 1424911002, "answer_id": 28732461, "question_id": 28732078, "link": "https://stackoverflow.com/questions/28732078/open-custom-file-args-is-always-empty/28732461#28732461", "title": "Open custom file, args is always empty", "body": "<p>Found the solution <a href=\"https://stackoverflow.com/questions/4607632/how-to-get-command-line-from-a-clickonce-application\">here.</a></p>\n\n<blockquote>\n  <p>When you publish an app with ClickOnce and then launch it by double-clicking an associated file, the path to that file actually gets stored here:</p>\n  \n  <p><strong>AppDomain.CurrentDomain.SetupInformation.ActivationArguments.ActivationData[0]</strong></p>\n  \n  <p>See MSDN's documentation for it here:</p>\n  \n  <p><a href=\"http://msdn.microsoft.com/en-us/library/system.runtime.hosting.activationarguments.aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/system.runtime.hosting.activationarguments.aspx</a></p>\n  \n  <p>Plus a tutorial on adding file associations to \"Published\" projects:</p>\n  \n  <p><a href=\"http://blogs.msdn.com/b/mwade/archive/2008/01/30/how-to-add-file-associations-to-a-clickonce-application.aspx\" rel=\"nofollow noreferrer\">http://blogs.msdn.com/b/mwade/archive/2008/01/30/how-to-add-file-associations-to-a-clickonce-application.aspx</a></p>\n</blockquote>\n"}], "owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "closed_date": 1424915335, "answer_count": 1, "score": 1, "last_activity_date": 1449773858, "creation_date": 1424908595, "last_edit_date": 1424910159, "question_id": 28732078, "link": "https://stackoverflow.com/questions/28732078/open-custom-file-args-is-always-empty", "closed_reason": "Duplicate", "title": "Open custom file, args is always empty", "body": "<p>I have C# WinForm .NET 4.5 application. I set Project -> Properties -> Publish -> Options -> File Associations. This part seems to work because it sets icon that I selected and if I double click file with custom extension (in this case *.psi) it opens my application. But I am having hard time getting file name that was double clicked. Somehow my static void Main(string[] args) args are always empty. \nI use ClickOnce deployment method. </p>\n\n<p>Can anyone help me with what I am missing to open custom file with my application. </p>\n\n<pre><code>static void Main(string[] args)\n    {\n        if(args.Length &gt; 0)\n        {\n            MessageBox.Show(args[0]);\n        }else {\n          MessageBox.Show(\"args is empty!\");\n        }\n\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n        DevExpress.Skins.SkinManager.EnableFormSkins();\n\n        UserLookAndFeel.Default.SetSkinStyle(Properties.Settings.Default.ActiveSkinName);\n\n\n        Application.Run(new MainForm(args));\n    }\n</code></pre>\n"}, {"tags": ["c#", "dictionary"], "comments": [{"owner": {"reputation": 6252, "user_id": 533686, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ssrjP.png?s=128&g=1", "display_name": "rducom", "link": "https://stackoverflow.com/users/533686/rducom"}, "edited": false, "score": 0, "creation_date": 1424909080, "post_id": 28732074, "comment_id": 45750208, "body": "I doubt you have wrote this code in VS and compiled it... Can you please correct it, my eyes are bleeding."}, {"owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "reply_to_user": {"reputation": 6252, "user_id": 533686, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ssrjP.png?s=128&g=1", "display_name": "rducom", "link": "https://stackoverflow.com/users/533686/rducom"}, "edited": false, "score": 0, "creation_date": 1424909393, "post_id": 28732074, "comment_id": 45750307, "body": "@Sharped: I was more focused on the Idea than on the Syntax while posting this..hope I got it right now. sorry about that"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1424911119, "post_id": 28732074, "comment_id": 45750805, "body": "Did you really mean to get <code>&lt;10, A&gt;</code> or did you actually want <code>&lt;10, A1&gt;</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1424909364, "post_id": 28732121, "comment_id": 45750301, "body": "It&#39;s hard to tell from his question whether or not he intends the result to be <code>Dictionary&lt;int, string&gt;</code> or <code>Dictionary&lt;string, string&gt;</code> - this produces the latter, if he&#39;s after the former he&#39;d need to convert (or try to) <code>x.Key</code> to an <code>int</code> in the <code>ToDictionary</code> invocation."}], "tags": [], "owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "is_accepted": false, "score": 3, "last_activity_date": 1424908866, "creation_date": 1424908866, "answer_id": 28732121, "question_id": 28732074, "link": "https://stackoverflow.com/questions/28732074/get-a-join-on-two-dictionaries-with-different-datatypes-in-c/28732121#28732121", "title": "Get a Join on Two Dictionaries with different Datatypes in C#", "body": "<pre><code>DictA.Join(DictB, \n           a =&gt; a.Key,\n           b =&gt; b.Key,\n           (a,b) =&gt; new KeyValuePair&lt;int,string&gt;(b.Value,a.Key))\n    .ToDictionary(x =&gt; x.Key, x =&gt; x.Value);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "is_accepted": false, "score": 2, "last_activity_date": 1424990226, "last_edit_date": 1424990226, "creation_date": 1424910953, "answer_id": 28732455, "question_id": 28732074, "link": "https://stackoverflow.com/questions/28732074/get-a-join-on-two-dictionaries-with-different-datatypes-in-c/28732455#28732455", "title": "Get a Join on Two Dictionaries with different Datatypes in C#", "body": "<p>Very simple:</p>\n\n<pre><code>var query =\n    DictA\n        .Where(a =&gt; DictB.ContainsKey(a.Key))\n        .ToDictionary(a =&gt; DictB[a.Key], a =&gt; a.Value);\n</code></pre>\n\n<p>I get this result:</p>\n\n<p><img src=\"https://i.stack.imgur.com/OPd2c.png\" alt=\"result\"></p>\n"}], "owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1424990226, "creation_date": 1424908575, "last_edit_date": 1424913489, "question_id": 28732074, "link": "https://stackoverflow.com/questions/28732074/get-a-join-on-two-dictionaries-with-different-datatypes-in-c", "title": "Get a Join on Two Dictionaries with different Datatypes in C#", "body": "<p>I have two dictionaries, namely </p>\n\n<pre><code>Dictionary&lt;string,string&gt; DictA=new Dictionary&lt;string,string&gt;();\nDictionary&lt;string,int&gt; DictB=new Dictionary&lt;string,int&gt;();\nDictA.Add(\"A\",\"A1\");\nDictA.Add(\"B\",\"B1\");\nDictA.Add(\"C\",\"C1\");\n\nDictB.Add(\"A\",10);\nDictB.Add(\"B\",20);\nDictB.Add(\"K\",30);\n</code></pre>\n\n<p>Now I need to form a Third dictionary like this.</p>\n\n<pre><code>&lt;10,A1&gt;\n&lt;20,B1&gt;\n</code></pre>\n\n<p>I am pretty much sure this is doable with operations on Dictionaries or Lambda Expressions but not sure on how to achieve this.</p>\n"}, {"tags": ["c#", "wix", "windows-installer", "burn"], "answers": [{"tags": [], "owner": {"reputation": 6646, "user_id": 628981, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6zEll.jpg?s=128&g=1", "display_name": "Sean Hall", "link": "https://stackoverflow.com/users/628981/sean-hall"}, "is_accepted": true, "score": 1, "last_activity_date": 1424909296, "creation_date": 1424909296, "answer_id": 28732205, "question_id": 28732070, "link": "https://stackoverflow.com/questions/28732070/how-to-allow-wix-burn-bundle-to-be-partially-uninstalled/28732205#28732205", "title": "How to allow WiX Burn Bundle to be partially uninstalled?", "body": "<p>Use the Modify action when calling Plan and Apply.</p>\n"}], "owner": {"reputation": 528, "user_id": 1778653, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a053d7e0df955cf3e2428619f0933242?s=128&d=identicon&r=PG", "display_name": "dspiegs", "link": "https://stackoverflow.com/users/1778653/dspiegs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 28732205, "answer_count": 1, "score": 0, "last_activity_date": 1424909296, "creation_date": 1424908554, "last_edit_date": 1424908912, "question_id": 28732070, "link": "https://stackoverflow.com/questions/28732070/how-to-allow-wix-burn-bundle-to-be-partially-uninstalled", "title": "How to allow WiX Burn Bundle to be partially uninstalled?", "body": "<p>Currently I have a WiX/Burn Custom Managed Bootstrapper Application that allows the user to selectively install and uninstall different MsiPackages. That code that handles that looks something like this. </p>\n\n<pre><code>private void PlanPackageBegin(object sender, PlanPackageBeginEventArgs args)\n{\n    var app = applicationViewModels.FirstOrDefault(app =&gt; app.PackageID == args.PackageId);\n    if (app == null)\n    {       \n        return;\n    }\n\n    switch (Mode)\n    {                    \n        case InstallMode.Install:\n            if (!app.Install)\n            {\n                e.State = RequestState.None;\n            }\n            break;\n        case InstallMode.Uninstall:\n            if (!app.Uninstall)\n            {\n                e.State = RequestState.None;\n            }\n            break;\n        case InstallMode.Repair:\n            if (!app.Repair)\n            {\n                e.State = RequestState.None;\n            }\n            break;\n    }\n}\n</code></pre>\n\n<p>The problem I have is that if just one application is uninstalled, then the entire Managed Bootstrapper Application is removed from Add/Remove Programs and the install cannot be managed any longer.</p>\n\n<p>How can I force the bundle to stay until all of its packages are removed?</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1424908915, "post_id": 28732029, "comment_id": 45750166, "body": "<code>.</code> isn\u2019t in <code>[0-9]</code>. Try adding it?"}], "answers": [{"comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1424912460, "post_id": 28732208, "comment_id": 45751219, "body": "@Tim - It would be better to avoid asking questions inside an answer. Those are best put as comments under the question."}, {"owner": {"reputation": 2748, "user_id": 4270311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b58c7c818a816d2cf5cf9c78fa987cb4?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/4270311/tim"}, "edited": false, "score": 0, "creation_date": 1424913020, "post_id": 28732208, "comment_id": 45751348, "body": "Not sure why. I can answer the question exactly as asked and help him 0 because he is not considering all the cases, or I can answer his question , while making sure I ask probing questions in case I can help direct him toward the best solution. Seems like helping the most I can is the better way."}], "tags": [], "owner": {"reputation": 2748, "user_id": 4270311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b58c7c818a816d2cf5cf9c78fa987cb4?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/4270311/tim"}, "is_accepted": true, "score": 0, "last_activity_date": 1424912358, "last_edit_date": 1424912358, "creation_date": 1424909302, "answer_id": 28732208, "question_id": 28732029, "link": "https://stackoverflow.com/questions/28732029/split-a-decimal-number-and-a-text-in-c/28732208#28732208", "title": "Split a decimal number and a text in c#", "body": "<p>I think the only current issue is that <code>.</code> is not in [0-9] but I can see this being a fragile solution depending on the input strings. Can you describe the desired behavior a bit more? Will you ever get H3.88? H3.88H? If so what are you expecting out of it?</p>\n\n<p>If your strings will always be in the same order and format, then adding <code>.</code> will get you there. If not, describe the scenario a little more and maybe we can come up with a more suitable solution.</p>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 4283098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1590811637/picture?type=large", "display_name": "William Callahan", "link": "https://stackoverflow.com/users/4283098/william-callahan"}, "is_accepted": false, "score": 0, "last_activity_date": 1424911098, "creation_date": 1424911098, "answer_id": 28732478, "question_id": 28732029, "link": "https://stackoverflow.com/questions/28732029/split-a-decimal-number-and-a-text-in-c/28732478#28732478", "title": "Split a decimal number and a text in c#", "body": "<p><strong>You may want to try to use the <em>split</em> method in RegEx.</strong></p>\n\n<hr>\n\n<blockquote>\n  <p>To get the string of numbers, split with this expression</p>\n</blockquote>\n\n<pre><code>[A-Z]+\n</code></pre>\n\n<blockquote>\n  <p>To get the string of characters, try this expression</p>\n</blockquote>\n\n<pre><code>[0-9]+\\.[0-9]+\n</code></pre>\n\n<hr>\n\n<p>You should use the split method in the following format:</p>\n\n<pre><code>string expr1 = Regex.Split(\"30.88H\", @\"[0-9]+\\.[0-9]+\"); \\\\Returns H\nstring expr2 = Regex.Split(\"30.88H\", @\"[A-Z]+\"); \\\\Returns 30.88\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4608116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c1ac61c2f4236de282c12d1a83e1f0f?s=128&d=identicon&r=PG&f=1", "display_name": "Anju", "link": "https://stackoverflow.com/users/4608116/anju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 28732208, "answer_count": 2, "score": -2, "last_activity_date": 1424912358, "creation_date": 1424908320, "last_edit_date": 1424908733, "question_id": 28732029, "link": "https://stackoverflow.com/questions/28732029/split-a-decimal-number-and-a-text-in-c", "title": "Split a decimal number and a text in c#", "body": "<p>I am trying to split a string that contains a decimal number and text characters for ex: </p>\n\n<p><code>\"30.88H\"</code> into an array containing <code>30.88</code> and <code>H</code>.</p>\n\n<p>I used the following regex:</p>\n\n<pre><code>string[] a = \n   Regex.Matches(\"30.88H\", \"([A-Z]+)|([0-9]+)\").Cast&lt;Match&gt;().Select(m =&gt; m.Value).ToArray();\n</code></pre>\n\n<p>...But this gives me \"30\",\"88\" and \"H\", instead of \"30.88\" and \"H\".\nCould any one suggest the fix?</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1424908119, "post_id": 28731958, "comment_id": 45749903, "body": "In what context are you using this? Are you trying to bind to a property of type <code>ImmutableStruct</code>?"}, {"owner": {"reputation": 398, "user_id": 212427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f019c1f7aad94d186b9af9843619911?s=128&d=identicon&r=PG", "display_name": "newmanth", "link": "https://stackoverflow.com/users/212427/newmanth"}, "edited": false, "score": 0, "creation_date": 1424908479, "post_id": 28731958, "comment_id": 45750025, "body": "Yes, I&#39;ve added some code fragments to clarify."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1424908618, "post_id": 28731958, "comment_id": 45750075, "body": "As AaronLS has pointed out below, You need a parameterless constructor, and in any case a setter is required to bind a to a property on post back. Not really clear what you trying to achieve with this."}, {"owner": {"reputation": 398, "user_id": 212427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f019c1f7aad94d186b9af9843619911?s=128&d=identicon&r=PG", "display_name": "newmanth", "link": "https://stackoverflow.com/users/212427/newmanth"}, "edited": false, "score": 0, "creation_date": 1424909343, "post_id": 28731958, "comment_id": 45750288, "body": "Our project has some legacy structs that we wanted to hook into MVC that are similar to this (except they have multiple properties). Wasn&#39;t sure of the most appropriate course of action."}], "answers": [{"comments": [{"owner": {"reputation": 549, "user_id": 9720972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25769ed2ec1668187c3cc9f7e5cc0689?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Arnold", "link": "https://stackoverflow.com/users/9720972/matt-arnold"}, "edited": false, "score": 0, "creation_date": 1547565118, "post_id": 28732048, "comment_id": 95230163, "body": "One could create a more genericized custom model binder using reflection based on the assumption that every model would have a constructor with parameters corresponding to each property in the class.  I wouldn&#39;t have said that&#39;s any worse an assumption than MVC&#39;s default behaviour of assuming every model is mutable and has a default constructor."}, {"owner": {"reputation": 34608, "user_id": 84206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144fd462785db33cf6665cafd54101c7?s=128&d=identicon&r=PG", "display_name": "AaronLS", "link": "https://stackoverflow.com/users/84206/aaronls"}, "reply_to_user": {"reputation": 549, "user_id": 9720972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25769ed2ec1668187c3cc9f7e5cc0689?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Arnold", "link": "https://stackoverflow.com/users/9720972/matt-arnold"}, "edited": false, "score": 1, "creation_date": 1547579562, "post_id": 28732048, "comment_id": 95237531, "body": "@MattArnold True.  I used AutoMapper for awhile, and it was something I had imagined was possible, was glad someone made it, but after a couple years I came to the conclusion it&#39;s easier to just have explicit mappings and use interfaces to avoid a multitude of duplicate/all-combinations mappings.  When the &quot;magic&quot; of reflective/dynamic mapping doesn&#39;t work, it&#39;s often difficult to find the problem. It&#39;s alot easier to just have a tangible <code>ToModel&lt;ISomeReturnModel&gt;(ISomeFromEntity fromEntity)</code> and step through all the child object mappings until you encounter the property/item that didn&#39;t map."}, {"owner": {"reputation": 549, "user_id": 9720972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25769ed2ec1668187c3cc9f7e5cc0689?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Arnold", "link": "https://stackoverflow.com/users/9720972/matt-arnold"}, "edited": false, "score": 0, "creation_date": 1547636553, "post_id": 28732048, "comment_id": 95256821, "body": "My thinking was along the lines that MVC&#39;s Default Model Binder must use some form of reflection also to perform postback-data-to-property-mapping.  There is still the added issue of an assignment constructor&#39;s parameters having a naming convention used by the custom model binder (e.g. every parameter name is a camel case variant of the pascal case property name it maps to) which could catch someone out if they decide to use a different convention.  I do wonder if a T4-Template-Generated Model Binder for each model might be a better solution as this would then have compile-time type safety."}], "tags": [], "owner": {"reputation": 34608, "user_id": 84206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144fd462785db33cf6665cafd54101c7?s=128&d=identicon&r=PG", "display_name": "AaronLS", "link": "https://stackoverflow.com/users/84206/aaronls"}, "is_accepted": true, "score": 3, "last_activity_date": 1424908766, "last_edit_date": 1495539865, "creation_date": 1424908450, "answer_id": 28732048, "question_id": 28731958, "link": "https://stackoverflow.com/questions/28731958/immutable-structs-in-asp-net-mvc-model/28732048#28732048", "title": "Immutable structs in ASP.NET MVC model", "body": "<p>MVC requires a default parameterless constructor as far as I am aware.  Your constructor does not qualify because it requires a parameter.  MVC does binding via properties, and your property has no setter.</p>\n\n<p>I believe a custom model binder will solve your problem, allowing you to call the constructor.  Seems alot more trouble than it's worth though, especially since you'll probably have to modify your custom model binder anytime you add properties to your class.  But I'll leave that up to you to decide.</p>\n\n<p>The details of how to do model binding to a parameterized constructor are exemplified in this model binder:</p>\n\n<p><a href=\"https://stackoverflow.com/a/13535545/84206\">https://stackoverflow.com/a/13535545/84206</a></p>\n\n<p>Notice <code>return new Company(customProfile);</code> would be similar to <code>new ImmutableStruct(someValue)</code></p>\n"}], "owner": {"reputation": 398, "user_id": 212427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f019c1f7aad94d186b9af9843619911?s=128&d=identicon&r=PG", "display_name": "newmanth", "link": "https://stackoverflow.com/users/212427/newmanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1844, "favorite_count": 1, "accepted_answer_id": 28732048, "answer_count": 1, "score": 1, "last_activity_date": 1424908766, "creation_date": 1424907900, "last_edit_date": 1424908448, "question_id": 28731958, "link": "https://stackoverflow.com/questions/28731958/immutable-structs-in-asp-net-mvc-model", "title": "Immutable structs in ASP.NET MVC model", "body": "<p>If I use an immutable struct in my model, i.e.:</p>\n\n<pre><code>public struct ImmutableStruct\n{\n    private readonly int firstProperty;\n\n    public ImmutableStruct(int firstProperty) : this()\n    {\n        this.firstProperty = firstProperty\n    }\n\n    public int FirstProperty { get { return firstProperty; } }\n}\n</code></pre>\n\n<p>The model fragment:</p>\n\n<pre><code>public class SomeModel\n{\n    public ImmutableStruct structProperty { get; set; }\n}\n</code></pre>\n\n<p>The view fragment:</p>\n\n<pre><code>@model SomeModel\n\n&lt;div&gt;\n    @Html.EditorFor(x = x.structProperty.FirstProperty)\n&lt;/div&gt;\n</code></pre>\n\n<p>The model binder does not seem to be able to bind any data when posting back to the controller.  Does this mean (1) that immutable structs should not be used, (2) need to use a custom model binder, (3) or I need to do something else instead?</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 3312, "user_id": 1845672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bddb39c831fe488900043133a4420c4e?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/1845672/roland"}, "edited": false, "score": 0, "creation_date": 1424911876, "post_id": 28731955, "comment_id": 45751025, "body": "This is rather a regular expression question. I would suggest to add the tag for REGEX."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4608035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e150a816d6e4b8fb45e601300e3d0a9d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeric Elopre", "link": "https://stackoverflow.com/users/4608035/jeric-elopre"}, "edited": false, "score": 0, "creation_date": 1424915043, "post_id": 28732616, "comment_id": 45751829, "body": "i try this code. but it doesn&#39;t change anything. :("}, {"owner": {"reputation": 609, "user_id": 4283098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1590811637/picture?type=large", "display_name": "William Callahan", "link": "https://stackoverflow.com/users/4283098/william-callahan"}, "reply_to_user": {"reputation": 11, "user_id": 4608035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e150a816d6e4b8fb45e601300e3d0a9d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeric Elopre", "link": "https://stackoverflow.com/users/4608035/jeric-elopre"}, "edited": false, "score": 0, "creation_date": 1424970201, "post_id": 28732616, "comment_id": 45778809, "body": "I updated the post. It should work now. I didn&#39;t test it earlier and assumed it would work."}], "tags": [], "owner": {"reputation": 609, "user_id": 4283098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1590811637/picture?type=large", "display_name": "William Callahan", "link": "https://stackoverflow.com/users/4283098/william-callahan"}, "is_accepted": false, "score": 0, "last_activity_date": 1424970166, "last_edit_date": 1424970166, "creation_date": 1424912019, "answer_id": 28732616, "question_id": 28731955, "link": "https://stackoverflow.com/questions/28731955/how-can-i-remove-the-parenthesis-and-all-of-the-text-inside-of-it-using-c/28732616#28732616", "title": "How can I remove the parenthesis and all of the text inside of it using c#?", "body": "<p>You may want to try the following solution. You usually have to delimit special characters like parenthesis in order to use them in your RegEx expression.</p>\n\n<pre><code>(\\(.*?\\))*\n</code></pre>\n\n<p>Also, there are two solutions to this problem depending on what kind of text you put into the RexEg machine. If you are using new lines in your text, you should use <code>@\"(\\([\\S\\s]*?\\))*\"</code>. The [\\S\\s] means anything that is or is not a space. In other words, literally any ASCII character. If you do not use new lines, you should simply use <code>@\"(\\(.*?\\))*\"</code>.</p>\n\n<hr>\n\n<blockquote>\n  <p>Using New Lines</p>\n</blockquote>\n\n<pre><code>richTextBox1.Text = Regex.Replace(richTextBox1.Text, @\"(\\([\\S\\s]*?\\))*\", \"\");\n</code></pre>\n\n<blockquote>\n  <p>Not Using New Lines</p>\n</blockquote>\n\n<pre><code>richTextBox1.Text = Regex.Replace(richTextBox1.Text, @\"(\\(.*?\\))*\", \"\");\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4608035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e150a816d6e4b8fb45e601300e3d0a9d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeric Elopre", "link": "https://stackoverflow.com/users/4608035/jeric-elopre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1424970166, "creation_date": 1424907891, "last_edit_date": 1424911919, "question_id": 28731955, "link": "https://stackoverflow.com/questions/28731955/how-can-i-remove-the-parenthesis-and-all-of-the-text-inside-of-it-using-c", "title": "How can I remove the parenthesis and all of the text inside of it using c#?", "body": "<p>here is the example:</p>\n\n<pre><code>(abad_string.cpp To abad_string.cpp :  0.00%\nData Type: 0.00%\nControl Structure: 0.00%\n0 VARIABLES are the same\n\nabad_string.cpp To Alarcon_string.cpp :  81.03%\nData Type: 100.00%\nControl Structure: 0.00%\n2 VARIABLES are the same\n\n)\n\nAlarcon_string.cpp To abad_string.cpp :  81.03%\nData Type: 100.00%\nControl Structure: 0.00%\n2 VARIABLES are the same\n\nAlarcon_string.cpp To Alarcon_string.cpp :  0.00%\nData Type: 0.00%\nControl Structure: 0.00%\n0 VARIABLES are the same\n\n)\n</code></pre>\n\n<p>i want to remove all the text inside of the parenthesis...\ni want the result like this..</p>\n\n<pre><code>Alarcon_string.cpp To abad_string.cpp :  81.03%\nData Type: 100.00%\nControl Structure: 0.00%\n2 VARIABLES are the same\n\nAlarcon_string.cpp To Alarcon_string.cpp :  0.00%\nData Type: 0.00%\nControl Structure: 0.00%\n0 VARIABLES are the same\n\n)\n</code></pre>\n\n<p>i try this code but all of the text is remove :(</p>\n\n<pre><code>richTextBox1.Text = Regex.Replace(\n    richTextBox1.Text, \"((.*?)\\n)\", \"\", RegexOptions.Multiline);\n</code></pre>\n\n<p>pls help. TIA!</p>\n"}, {"tags": ["c#", "sql", "sql-server", "visual-studio-2012", "ssis"], "answers": [{"comments": [{"owner": {"reputation": 16356, "user_id": 1913888, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MqCvM.jpg?s=128&g=1", "display_name": "Aaron Lelevier", "link": "https://stackoverflow.com/users/1913888/aaron-lelevier"}, "edited": false, "score": 0, "creation_date": 1424912288, "post_id": 28732258, "comment_id": 45751166, "body": "Thank you for your help.  I showed my working solution above in the <b>edit</b>."}], "tags": [], "owner": {"reputation": 4777, "user_id": 4606787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb2784cf02ecb4bc970211990764e842?s=128&d=identicon&r=PG&f=1", "display_name": "benjamin moskovits", "link": "https://stackoverflow.com/users/4606787/benjamin-moskovits"}, "is_accepted": false, "score": 1, "last_activity_date": 1424909623, "creation_date": 1424909623, "answer_id": 28732258, "question_id": 28731927, "link": "https://stackoverflow.com/questions/28731927/ssis-use-part-of-a-filename-as-a-variable-within-a-foreach-loop-container/28732258#28732258", "title": "SSIS use part of a filename as a variable within a Foreach Loop Container", "body": "<p>Yes you can use the execute SQL Task. You will have to map the query parameter to variable within an update statement. </p>\n\n<p>You can look up how to do it here:\n<a href=\"https://www.simple-talk.com/sql/ssis/passing-variables-to-and-from-an-ssis-task/\" rel=\"nofollow\">https://www.simple-talk.com/sql/ssis/passing-variables-to-and-from-an-ssis-task/</a></p>\n"}], "owner": {"reputation": 16356, "user_id": 1913888, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/MqCvM.jpg?s=128&g=1", "display_name": "Aaron Lelevier", "link": "https://stackoverflow.com/users/1913888/aaron-lelevier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424912246, "creation_date": 1424907795, "last_edit_date": 1424912246, "question_id": 28731927, "link": "https://stackoverflow.com/questions/28731927/ssis-use-part-of-a-filename-as-a-variable-within-a-foreach-loop-container", "title": "SSIS use part of a filename as a variable within a Foreach Loop Container", "body": "<p>I'd like to <em>SSIS</em> use part of a filename as a variable within a foreach loop.</p>\n\n<p>Within a <code>Foreach Loop Container</code> I\u2019d like to take a filename, i.e. <em>7788-Trailer Park Boys</em>, and to split at the \u201c-\u201c mark, and set the <em>7788</em> as a variable.  </p>\n\n<p>Then I\u2019d like to use that variable to update a table referenced within the <code>Foreach Loop Container</code>.  So, change all columns in one table to <em>7788</em>.  Can this be easily done in <em>SSIS</em> without custom scripting?</p>\n\n<p>If it can, what <em>SSIS</em> components would I need to use?</p>\n\n<p>Thank you in advance.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>I got it working using this link:</p>\n\n<p>This link helped me get it working: <a href=\"http://sqlage.blogspot.com/2013/11/ssis-use-variable-in-execute-sql-task.html\" rel=\"nofollow\">http://sqlage.blogspot.com/2013/11/ssis-use-variable-in-execute-sql-task.html</a>.</p>\n\n<p>Here is the code that I used in the Execute SQL Task:</p>\n\n<pre><code>declare @promoid varchar(255);\n\nset @promoid = ?\n\nupdate hr_sandbox.dbo.tbu_tracking_block\nset PromoID = substring(@promoid,charindex('blocks\\', @promoid)+7, len(@promoid)-charindex('.xlsx', @promoid))\n</code></pre>\n\n<p>The only problem with my code is that my variable was the full path name, so I had to slice it to get out the file name.  Is there an easier way to extract the file name our of a fully qualified file path?</p>\n"}, {"tags": ["c#", "json", "json.net", "jsonschema"], "comments": [{"owner": {"reputation": 2946, "user_id": 2913306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N9TWX.jpg?s=128&g=1", "display_name": "wahwahwah", "link": "https://stackoverflow.com/users/2913306/wahwahwah"}, "edited": false, "score": 0, "creation_date": 1424908319, "post_id": 28731866, "comment_id": 45749970, "body": "Are you referencing <code>Newtonsoft.Json.Schema</code>?"}, {"owner": {"reputation": 117, "user_id": 2471846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8J3rg.png?s=128&g=1", "display_name": "gDexter42", "link": "https://stackoverflow.com/users/2471846/gdexter42"}, "reply_to_user": {"reputation": 2946, "user_id": 2913306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N9TWX.jpg?s=128&g=1", "display_name": "wahwahwah", "link": "https://stackoverflow.com/users/2913306/wahwahwah"}, "edited": false, "score": 0, "creation_date": 1424912478, "post_id": 28731866, "comment_id": 45751222, "body": "Yes I am. Also referencing Newtonsoft.Json.Schema"}], "answers": [{"tags": [], "owner": {"reputation": 4587, "user_id": 1466960, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/LJK98.jpg?s=128&g=1", "display_name": "RagtimeWilly", "link": "https://stackoverflow.com/users/1466960/ragtimewilly"}, "is_accepted": true, "score": 1, "last_activity_date": 1424908633, "creation_date": 1424908633, "answer_id": 28732082, "question_id": 28731866, "link": "https://stackoverflow.com/questions/28731866/parsing-json-schema-using-json-net-schema-throws-error-system-methodaccessexcept/28732082#28732082", "title": "Parsing JSON Schema using Json.NET schema throws error System.MethodAccessException", "body": "<p>Sounds like a package mismatch between Newtonsoft.Json and Newtonsoft.Json.Schema.</p>\n\n<p>Newtonsoft.Json.Schema relies on Newtonsoft.Json version>= 6.0.8. So make sure it is up to date in your project.</p>\n\n<p>I installed Newtonsoft.Json first and then the schema package and code ran fine for me.</p>\n\n<p>My packages config:</p>\n\n<pre><code> &lt;packages&gt;   \n    &lt;package id=\"Newtonsoft.Json\" version=\"6.0.8\" targetFramework=\"net45\" /&gt;   \n    &lt;package id=\"Newtonsoft.Json.Schema\" version=\"1.0.8\" targetFramework=\"net45\"/&gt; \n&lt;/packages&gt;\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 2471846, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8J3rg.png?s=128&g=1", "display_name": "gDexter42", "link": "https://stackoverflow.com/users/2471846/gdexter42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "accepted_answer_id": 28732082, "answer_count": 1, "score": 1, "last_activity_date": 1424908633, "creation_date": 1424907491, "question_id": 28731866, "link": "https://stackoverflow.com/questions/28731866/parsing-json-schema-using-json-net-schema-throws-error-system-methodaccessexcept", "title": "Parsing JSON Schema using Json.NET schema throws error System.MethodAccessException", "body": "<p>I am trying to experiment with JSON schema validation. I am using the basic example for the schema on the <a href=\"http://www.newtonsoft.com/jsonschema/help/html/JTokenIsValid.htm\" rel=\"nofollow\">JSON.NET Help page</a>. I get the exception</p>\n\n<pre><code>System.MethodAccessException: Attempt by method\n'Newtonsoft.Json.Schema.JSchema.Parse(System.String)' to access method\n'Newtonsoft.Json.Utilities.ValidationUtils.ArgumentNotNull(System.Object, System.String)' failed\n</code></pre>\n\n<p>My code is below</p>\n\n<pre><code>[TestMethod]\n    public void prettySimple()\n    {\n      string schemaJson = @\"{\n             'type': 'object',\n             'properties': {\n             'name': {'type':'string'},\n             'hobbies': {\n             'type': 'array',\n             'items': {'type':'string'}\n                }\n               }\n              }\";\n\n      JSchema schema = JSchema.Parse(schemaJson);\n    }\n</code></pre>\n"}, {"tags": ["c#", "regex", "asp.net-mvc", "asp.net-mvc-4"], "answers": [{"tags": [], "owner": {"reputation": 8267, "user_id": 1810429, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/68c4911127e973b1fc529ee79cc73cfb?s=128&d=identicon&r=PG", "display_name": "J0e3gan", "link": "https://stackoverflow.com/users/1810429/j0e3gan"}, "is_accepted": true, "score": 1, "last_activity_date": 1424909854, "last_edit_date": 1424909854, "creation_date": 1424908478, "answer_id": 28732054, "question_id": 28731783, "link": "https://stackoverflow.com/questions/28731783/regex-matches-url-path-fraction-for-mvc-previous-url-constraint/28732054#28732054", "title": "Regex matches URL path fraction for MVC previous URL constraint", "body": "<p>Try the following pattern, which should at least be a good start if not exactly what you need:</p>\n\n<pre><code>(?:prefix/|/)?controller/[a-z]+(?:/|(?:\\?[a-z]+=[a-zA-Z0-9]+(?:&amp;[a-z]+=[a-zA-Z0-9]+)*))\n</code></pre>\n\n<p>Key points:</p>\n\n<ul>\n<li><code>(?:prefix/|/)?</code> \u2013 optionally (per the terminal <code>?</code>) starting with <code>prefix/</code> <em>or</em> (per <code>|</code>) just <code>/</code>, which we choose not to capture (per <code>?:</code>)</li>\n<li><code>controller/</code></li>\n<li><code>[a-z]+</code> \u2013 the action</li>\n<li><code>(?:/|(?:\\?[a-z]+=[a-zA-Z0-9]+(?:&amp;[a-z]+=[a-zA-Z0-9]+)*))</code> \u2013 ending with <code>/</code> <em>or</em> (per <code>|</code>) <code>?</code> followed by at least one parameter and value</li>\n</ul>\n\n<p>It matches all your sample inputs:</p>\n\n<pre><code>prefix/controller/action/\ncontroller/action/\n/controller/action/\n/controller/action?param=val\n/controller/action?param=val&amp;param2=val\n</code></pre>\n\n<p>You can test it in a <a href=\"http://fiddle.re/1keud6\" rel=\"nofollow\">related RegexPlanet demo</a>.</p>\n"}], "owner": {"reputation": 4084, "user_id": 849275, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02bedb45c9e410b856e81c0b7f3cb95?s=128&d=identicon&r=PG&f=1", "display_name": "MR.ABC", "link": "https://stackoverflow.com/users/849275/mr-abc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 0, "accepted_answer_id": 28732054, "answer_count": 1, "score": 0, "last_activity_date": 1424909854, "creation_date": 1424907125, "last_edit_date": 1424908615, "question_id": 28731783, "link": "https://stackoverflow.com/questions/28731783/regex-matches-url-path-fraction-for-mvc-previous-url-constraint", "title": "Regex matches URL path fraction for MVC previous URL constraint", "body": "<p>I'm looking for a URL path fraction regex pattern. It should match:</p>\n\n<pre><code>prefix/controller/action/\ncontroller/action/\n/controller/action/\n/controller/action?param=val\n/controller/action?param=val&amp;param2=val\n...\n</code></pre>\n\n<p>I would like to use it in a route constraint for the previous URL in MVC.</p>\n"}, {"tags": ["c#", "string", "contains", "indexof"], "comments": [{"owner": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 0, "creation_date": 1424907885, "post_id": 28731773, "comment_id": 45749829, "body": "Please debug and you&#39;ll certainly find the issue yourself."}, {"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1424919883, "post_id": 28731773, "comment_id": 45752950, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/4660142/what-is-a-nullreferenceexception-and-how-do-i-fix-it\">What is a NullReferenceException and how do I fix it?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4518864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9a978d962a128c4ae7e6dfbe33e293?s=128&d=identicon&r=PG&f=1", "display_name": "124356user", "link": "https://stackoverflow.com/users/4518864/124356user"}, "edited": false, "score": 0, "creation_date": 1424907914, "post_id": 28731815, "comment_id": 45749839, "body": "Thank you so much! I added an if statement: <code>if (x == null)                     continue;</code> to check for null. It worked."}, {"owner": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 1, "creation_date": 1424908062, "post_id": 28731815, "comment_id": 45749882, "body": "If the answer helped please select this to be the most helpful answer!"}, {"owner": {"reputation": 480, "user_id": 2215451, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/xNKWp.jpg?s=128&g=1", "display_name": "Guillermo Mestre", "link": "https://stackoverflow.com/users/2215451/guillermo-mestre"}, "edited": false, "score": 0, "creation_date": 1424910307, "post_id": 28731815, "comment_id": 45750573, "body": "One mechanism that I use with functions that take parameter by reference (any <code>object</code> accounts for it) is to actually throw <code>ArgumentNullException</code>, <code>ArgumentException</code>... depending on the case IF the input is NOT expected to not be null. One easy way to check it is to ask yourself &quot;is it valid for the input to be null? how the function should behave if the input is null?&quot;, if the answer is &quot;input shouldn&#39;t be null&quot; then throw, otherwise code accordingly. Welcome to Stack Overflow, and if the answer helped you please hit the check at the left =)"}, {"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1424920160, "post_id": 28731815, "comment_id": 45753017, "body": "@GuillermoMestre Reference types <i>aren&#39;t</i> passed by reference by default in C#. References are passed by value in C# unless the <code>ref</code> or <code>out</code> modifiers are used."}, {"owner": {"reputation": 480, "user_id": 2215451, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/xNKWp.jpg?s=128&g=1", "display_name": "Guillermo Mestre", "link": "https://stackoverflow.com/users/2215451/guillermo-mestre"}, "reply_to_user": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1424942572, "post_id": 28731815, "comment_id": 45760881, "body": "@PrestonGuillot you are right, I wanted to say &quot;any parameter that is a reference type&quot; but said it the other way around. Definitely yesterday was not my day :P"}], "tags": [], "owner": {"reputation": 480, "user_id": 2215451, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/xNKWp.jpg?s=128&g=1", "display_name": "Guillermo Mestre", "link": "https://stackoverflow.com/users/2215451/guillermo-mestre"}, "is_accepted": false, "score": 1, "last_activity_date": 1424907276, "creation_date": 1424907276, "answer_id": 28731815, "question_id": 28731773, "link": "https://stackoverflow.com/questions/28731773/nullreferenceexception-in-if-statement-c/28731815#28731815", "title": "NullReferenceException in &#39;if&#39; statement C#", "body": "<p>On the code you don't check if <code>list</code> is <code>null</code> (which would throw on the line <code>for (int i = 0; i &lt; list.Length; i++)</code> nor you check for null on each element, that would throw on the line that you said on your question.</p>\n"}, {"tags": [], "owner": {"reputation": 3012, "user_id": 3101082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1WxPj.jpg?s=128&g=1", "display_name": "dub stylee", "link": "https://stackoverflow.com/users/3101082/dub-stylee"}, "is_accepted": false, "score": 0, "last_activity_date": 1424907971, "creation_date": 1424907971, "answer_id": 28731970, "question_id": 28731773, "link": "https://stackoverflow.com/questions/28731773/nullreferenceexception-in-if-statement-c/28731970#28731970", "title": "NullReferenceException in &#39;if&#39; statement C#", "body": "<p>As Guillermo said, you should be checking <code>null</code> before accessing those items:</p>\n\n<pre><code>public static string[] getStrands(string[] list, string sequence)\n{\n    if (list == null) {\n        return null;\n    }\n    List&lt;string&gt; temp = new List&lt;string&gt;();\n    for (int i = 0; i &lt; list.Length; i++)\n    {\n        if (list[i] != null) {\n            string x = list[i];\n            if (x.IndexOf(sequence) != -1)\n                temp.Add(x);\n        }\n    }\n\n    //converts temp List into a string[] to return\n    string[] result = new string[temp.Count];\n    for (int i = 0; i &lt; temp.Count; i++)\n        result[i] = temp.ElementAt(i);\n\n    return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4518864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e9a978d962a128c4ae7e6dfbe33e293?s=128&d=identicon&r=PG&f=1", "display_name": "124356user", "link": "https://stackoverflow.com/users/4518864/124356user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1424907971, "creation_date": 1424907048, "question_id": 28731773, "link": "https://stackoverflow.com/questions/28731773/nullreferenceexception-in-if-statement-c", "title": "NullReferenceException in &#39;if&#39; statement C#", "body": "<p>This is a simple program of string array and string manipulation.</p>\n\n<p>I have a string array called <code>list</code> that has strings that represent a single line of a file that I read earlier (each line contains DNA chemical sequence like <code>AGCTTTTCATTCT</code>).</p>\n\n<p>This <code>getStrands()</code> method is supposed to take out each individual line (which is a single element in <code>list</code>) that contains a desired substring called <code>sequence</code> (like \"CATTCT\") and put all of these lines with the sequence into another string array called <code>result</code> and return it. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>    public static string[] getStrands(string[] list, string sequence)\r\n        {\r\n            List&lt;string&gt; temp = new List&lt;string&gt;();\r\n            for (int i = 0; i &lt; list.Length; i++)\r\n            {\r\n                string x = list[i];\r\n                if (x.IndexOf(sequence) != -1)\r\n                    temp.Add(x);\r\n            }\r\n\r\n            //converts temp List into a string[] to return\r\n            string[] result = new string[temp.Count];\r\n            for (int i = 0; i &lt; temp.Count; i++)\r\n                result[i] = temp.ElementAt(i);\r\n\r\n            return result;\r\n        }</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The error:\n    System.NullReferenceException was unhandled\n  HResult=-2147467261\n  Message=Object reference not set to an instance of an object.</p>\n\n<p>The error occurs at this line: <code>if (x.IndexOf(sequence) != -1)</code></p>\n\n<p>I checked to see if <code>x</code> or <code>sequence</code> was <code>null</code>, but they're not. How come when I try to see if <code>x</code> contains <code>sequence</code>, it gives me this error (I also tried the Contains() method and it gave me the same error)?</p>\n"}, {"tags": ["c#", "constructor"], "comments": [{"owner": {"reputation": 600, "user_id": 2252950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69ae4ded2f699ed432a90b456856f2e?s=128&d=identicon&r=PG", "display_name": "BoldAsLove", "link": "https://stackoverflow.com/users/2252950/boldaslove"}, "edited": false, "score": 0, "creation_date": 1424906845, "post_id": 28731613, "comment_id": 45749485, "body": "<i>you</i> need to tell us what problem you would like to be solved. what is your goal, what have you tried, and what errors did you get"}, {"owner": {"reputation": 5521, "user_id": 755851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb0ef4d5aebec860f85f7c76b894fd?s=128&d=identicon&r=PG", "display_name": "Foon", "link": "https://stackoverflow.com/users/755851/foon"}, "edited": false, "score": 0, "creation_date": 1424908665, "post_id": 28731613, "comment_id": 45750089, "body": "Your C example doesn&#39;t make any sense.  If C doesn&#39;t have a,b,c or d defined in the constructor arguments, where do you expect the compiler to get these values?"}, {"owner": {"reputation": 57, "user_id": 4565252, "user_type": "registered", "profile_image": "https://graph.facebook.com/891780704175339/picture?type=large", "display_name": "Lucky Buggy", "link": "https://stackoverflow.com/users/4565252/lucky-buggy"}, "edited": false, "score": 0, "creation_date": 1424909332, "post_id": 28731613, "comment_id": 45750281, "body": "Yeah, this is the problem. I create an object in Class Main and there the values are transferred and the constructor of Class A is called. These values a=13, b=14, c=15, d=&quot;I don&#39;t know how to explain better!&quot; should be transferred to Class C somehow. Then it looks a bit like the code from Alexei Levenkov but he has initialized in class C. Instead of values it should be variables."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1425007757, "post_id": 28731613, "comment_id": 45794873, "body": "Any chance that you expect <code>new C(...)</code> somehow pick arguments from completely unrelated separate call to <code>new A(...)</code>? Sample code that you want to see working may be useful...."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4565252, "user_type": "registered", "profile_image": "https://graph.facebook.com/891780704175339/picture?type=large", "display_name": "Lucky Buggy", "link": "https://stackoverflow.com/users/4565252/lucky-buggy"}, "edited": false, "score": 0, "creation_date": 1424908216, "post_id": 28731788, "comment_id": 45749939, "body": "Okay, this is good. Let&#39;s see this: My values are in class A. In Class Main where the main method is I&#39;d like to transfer the values like 42, 43, 44 and &quot;Why?&quot;. Then the values are like this for example:                                                       public A(42, 43, 44, &quot;Why?&quot;) { }                            I don&#39;t like to write the values in class C because it&#39;s not flexible any more. All the values are written in Class Main whether I create an object and transfer the values to the constructor."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 57, "user_id": 4565252, "user_type": "registered", "profile_image": "https://graph.facebook.com/891780704175339/picture?type=large", "display_name": "Lucky Buggy", "link": "https://stackoverflow.com/users/4565252/lucky-buggy"}, "edited": false, "score": 1, "creation_date": 1424908628, "post_id": 28731788, "comment_id": 45750080, "body": "@LuckyBuggy your question feels like &quot;how to make <code>public C(int w, int x, string y, string z) : base(a, b, c, d) </code> compile irrespective of result&quot; - I have no idea what your actual goal is."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 47259, "user_id": 109702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1206798ebe0afcb9cb722ef597573853?s=128&d=identicon&r=PG&f=1", "display_name": "slugster", "link": "https://stackoverflow.com/users/109702/slugster"}, "edited": false, "score": 0, "creation_date": 1424909046, "post_id": 28731788, "comment_id": 45750197, "body": "@slugster also note that static fields/properties can stay implicitly initialized with default values (you get warning, but not error for that)."}], "tags": [], "owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "is_accepted": false, "score": 2, "last_activity_date": 1424914994, "last_edit_date": 1424914994, "creation_date": 1424907143, "answer_id": 28731788, "question_id": 28731613, "link": "https://stackoverflow.com/questions/28731613/possibility-taking-values-from-base-constructor-whose-variables-are-different-fr/28731788#28731788", "title": "Possibility taking values from base constructor whose variables are different from the variables in derived constructor?", "body": "<p>There is really no magic to pass values from outside to base class constructor - derived class must somehow specify all arguments to base constructor either passing directly or computing in some other way. Usually you'd compute parameters of base constructor from arguments and some constant values:</p>\n\n<pre><code> public C(int w, int x, string y, string z) : \n       base(w+x, x*3, 42, \"Test:\" + y+z) {...}\n</code></pre>\n\n<hr>\n\n<p>Below is answer to code puzzle interpretation of the question:  </p>\n\n<blockquote>\n  <p>how to make <code>public C(int w, int x, string y, string z) : base(a, b, c, d)</code> compile irrespective of result\" </p>\n</blockquote>\n\n<p>To be able to compile <code>base(a, b, c, d)</code> which are not passed as arguments you need them to be static fields/properties or <code>const</code> values visible in the derived class (i.e. defined in derived class with any accessibility or defined in base class with non-private accessibility). You can't use instance fields/properties as parameters of base constructor per C# specification (reasoning: there is really no \"instance\" at that point). </p>\n\n<p>Sample that would let code to compile (you can also move any of a,b,c,d to base class with <code>public</code>/<code>internal</code>/<code>protected</code> access modifier):</p>\n\n<pre><code>class C : A \n{\n  static int a = 42; // static value, initialization is optional \n  static int b {get;set;} // static property ok, with default 0 value\n  const int c = 44;\n  const string d = \"Why?\";\n\n  public C(int w, int x, string y, string z) : base(a, b, c, d) {...}\n  ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 4565252, "user_type": "registered", "profile_image": "https://graph.facebook.com/891780704175339/picture?type=large", "display_name": "Lucky Buggy", "link": "https://stackoverflow.com/users/4565252/lucky-buggy"}, "is_accepted": false, "score": 0, "last_activity_date": 1425062811, "last_edit_date": 1425062811, "creation_date": 1425061970, "answer_id": 28771931, "question_id": 28731613, "link": "https://stackoverflow.com/questions/28731613/possibility-taking-values-from-base-constructor-whose-variables-are-different-fr/28771931#28771931", "title": "Possibility taking values from base constructor whose variables are different from the variables in derived constructor?", "body": "<p>I hope this sample of code might help you helping me ;-).</p>\n\n<p>First of all, I'm jumping into the main method. Then an object of class B is created by using following code:</p>\n\n<pre><code>new B(global::Test.Properties.Resources.MyPlane, 100, 100, 200, 100, 10, 10);\n</code></pre>\n\n<p>Then I'm coming to the constructor of B with following arguments (no execution yet):</p>\n\n<pre><code>public B(Bitmap pathOfMovingObject, int xPositionObject, int yPositionObject, int widthOfObject, int heightOfObject, int tank_size, int life)\n            : base(pathOfMovingObject, xPositionObject, yPositionObject, widthOfObject, heightOfObject)\n</code></pre>\n\n<p>Then it's coming to the constructor of A with following arguments:</p>\n\n<pre><code> private PictureBox picBoxImage;     \n    protected Bitmap path;\n    protected int x, y, width, height;\n</code></pre>\n\n<p><strong>If I change the instance variables to static like this, then it's working but I can't create two instances of class B any more:</strong></p>\n\n<pre><code>protected static Bitmap path;\nprotected static int x, y, width, height;\n</code></pre>\n\n<p>If I change the static variables to instance variables again, then I've got the problem that this error report appears:</p>\n\n<p>An object reference is required for the nonstatic field, method, or property 'A.path'.</p>\n\n<pre><code>    public A(Bitmap pathOfMovingObject, int xPositionObject, int yPositionObject, int widthOfObject, int heightOfObject)\n        {\n            path = pathOfMovingObject;\n            x = xPositionObject;\n            y = yPositionObject;\n            width = widthOfObject;\n            height = heightOfObject;\n\npicBoxImage = new PictureBox();\n            picBoxImage.Image = pathOfMovingObject;\n            picBoxImage.BackColor = Color.Transparent;\n            picBoxImage.SetBounds(xPositionObject, yPositionObject, widthOfObject, heightOfObject);\n            this.Controls.Add(picBoxImage);\n        }\n</code></pre>\n\n<p>Then the constructor of B is called and the code in the block is executed. </p>\n\n<p>Then I'm jumping back to main class with main method. Object of class C is created.</p>\n\n<pre><code>new C(1000, 650, 5, \"stackoverflow\", global::Test.Properties.Resources.sky);\n</code></pre>\n\n<p>Then I'm coming to C constructor (no execution yet).</p>\n\n<p>Then I'm jumping to constructor of the class A and the block is executed.</p>\n\n<p>Then I'm coming to C constructor again:</p>\n\n<pre><code>public C(int width, int height, int speed, string title, Bitmap path)\n\n    : base(path, x, y, width, height)  -- There you can see the error...\n</code></pre>\n\n<p>An object reference is required for the nonstatic field, method, or property 'A.path'.</p>\n\n<p><strong>So, my question is... how is it possible to create two instances of class B which are displayed on the screen either and to set the values valid in class C and to disable the upper error report?</strong></p>\n"}], "owner": {"reputation": 57, "user_id": 4565252, "user_type": "registered", "profile_image": "https://graph.facebook.com/891780704175339/picture?type=large", "display_name": "Lucky Buggy", "link": "https://stackoverflow.com/users/4565252/lucky-buggy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1425062953, "creation_date": 1424906322, "last_edit_date": 1425062953, "question_id": 28731613, "link": "https://stackoverflow.com/questions/28731613/possibility-taking-values-from-base-constructor-whose-variables-are-different-fr", "title": "Possibility taking values from base constructor whose variables are different from the variables in derived constructor?", "body": "<p>It's a bit different to explain what I want but I hope that I can explain the way you can understand.</p>\n\n<p>I have a class A (the main class)</p>\n\n<p><strong>class B : A (inheritance)</strong></p>\n\n<p><strong>class C : A</strong></p>\n\n<p>Class A has got my own written constructor like this:</p>\n\n<pre><code>public A(int a, int b, int c, string d)\n{\n}\n</code></pre>\n\n<p>Let's see class B:\nClass B inherits from class A.\nHere I'd like to write an another individual constructor which has more possibilities than the other from A.</p>\n\n<p>It looks like this:</p>\n\n<pre><code>public B(int a, int b, int c, string d, int e)\n{\n}\n</code></pre>\n\n<p>Now the compiler will probably return an error because the standard constructor in class A has been deleted. So, I have to write like this:</p>\n\n<pre><code> public B(int a, int b, int c, string d, int e) : base(a, b, c, d)\n    {\n       /* It's working because I've added the variable \"e\" only.\n       The other variables haven't been changed. */\n    }\n</code></pre>\n\n<p>But what about this situation?\nClass C which doesn't have to do anything with class A also wants to have its own constructor. It looks like this:</p>\n\n<pre><code> public C(int w, int x, string y, string z) : base(a, b, c, d)\n    {\n         /* Class C does have completely different values than class A.\n            But I'd like to have all the variables the way I've written above.\n            I'd like to use variable \"w\" for example. But \"a\" should be valid \n            to use as well. How is it possible to make the variables\n            a, b, c and d valid to class C? */\n}\n</code></pre>\n\n<p>I hope you understand which problem I'd like to be solved.</p>\n"}, {"tags": ["c#", "asp.net", "vb.net", "treeview"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 4409300, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/400d83e073a1b9088f7c1e4258c1e4b3?s=128&d=identicon&r=PG&f=1", "display_name": "Huy Zukerman", "link": "https://stackoverflow.com/users/4409300/huy-zukerman"}, "edited": false, "score": 0, "creation_date": 1424908183, "post_id": 28731900, "comment_id": 45749925, "body": "Maybe I wasn&#39;t clear in my Master Page I have Left Hand Side and Right Hand side....When the user clicked on the Node I&#39;m reloading the same page again and on page load I&#39;m reading what&#39;s in the QueryString if it&#39;s equal to my condition I&#39;m doing something like that  Me.Master.FindControl(&quot;RightContent&quot;).Controls.Add(Page.Load&zwnj;&#8203;Control((&quot;/Controls/&zwnj;&#8203;Reports/rptTimeOfDay&zwnj;&#8203;.ascx&quot;)))    Now the ascx been load but It&#39;s not coming on top of the last ascx it&#39;s shown below it. What should I do?"}], "tags": [], "owner": {"reputation": 13539, "user_id": 41782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ZaggO.jpg?s=128&g=1", "display_name": "Atilla Ozgur", "link": "https://stackoverflow.com/users/41782/atilla-ozgur"}, "is_accepted": true, "score": 0, "last_activity_date": 1424908659, "last_edit_date": 1424908659, "creation_date": 1424907658, "answer_id": 28731900, "question_id": 28731604, "link": "https://stackoverflow.com/questions/28731604/load-different-ascxs-in-aspx-page/28731900#28731900", "title": "Load different ascx&#39;s in aspx page", "body": "<p>You are trying to load user control in the Page Load event. It is too LATE. Read more about <a href=\"https://msdn.microsoft.com/en-us/library/ms178472(v=vs.100).aspx\" rel=\"nofollow\">Asp.Net Page Life Cycle</a>. Relevant part quoted below.</p>\n\n<blockquote>\n  <p>Page Event Init: Raised after all controls have been initialized and\n  any skin settings have been applied. The Init event of individual\n  controls occurs before the Init event of the page. Use this event to\n  read or initialize control properties.</p>\n</blockquote>\n\n<p>You need to load your control before this event. </p>\n\n<p>Instead of Page.LoadControl(\"UserControlPath\"), you can control visibility of your ascx files. Try following code. </p>\n\n<pre><code>If m_qrptTOD = \"tod\" Then\n       ascxRptTimeOfDay.Visible = False\nEnd If\n</code></pre>\n\n<p>Note that your rptTimeOfDay.ascx UserControl will always be loaded in this approach, you only change its visibility. But, in Asp.NET , no html code will be sent to client if user control is not visible.</p>\n"}], "owner": {"reputation": 215, "user_id": 4409300, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/400d83e073a1b9088f7c1e4258c1e4b3?s=128&d=identicon&r=PG&f=1", "display_name": "Huy Zukerman", "link": "https://stackoverflow.com/users/4409300/huy-zukerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 28731900, "answer_count": 1, "score": 1, "last_activity_date": 1424908659, "creation_date": 1424906302, "question_id": 28731604, "link": "https://stackoverflow.com/questions/28731604/load-different-ascxs-in-aspx-page", "title": "Load different ascx&#39;s in aspx page", "body": "<p>On my aspx page I have on the left hand side TreeView for each of every node in the TreeView I want to load a different ascx which going to change only the right hand side of the page.</p>\n\n<p>Thats how my aspx.vb look like:</p>\n\n<pre><code> Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load\n\n    RetrieveAllQueryStringParams()\n\n    If Not IsPostBack Then\n        GenerateDataSets()\n        GenerateLabels()\n        GenerateLinks()\n        GenerateControls()\n        GenerateOther()\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>When it's getting to GenerateLinks()</p>\n\n<pre><code> Protected Sub GenerateLinks()\n        Dim subTreeStatisticalReport As RadTreeNode = rtvReports.Nodes.FindNodeByValue(\"StatisticalReport\")\n        Dim subTreeIncidentComparisons As RadTreeNode = rtvReports.Nodes.FindNodeByValue(\"IncidentComparisons\")\n        Dim subTreeGeographicLocations As RadTreeNode = rtvReports.Nodes.FindNodeByValue(\"GeographicLocations\")\n\n        Dim statTimeOfDayNode As RadTreeNode = subTreeStatisticalReport.Nodes.FindNodeByValue(\"TimeofDay\")\n        Dim statTrendsNode As RadTreeNode = subTreeStatisticalReport.Nodes.FindNodeByValue(\"Trends\")\n        Dim statTopSevenIncidents As RadTreeNode = subTreeStatisticalReport.Nodes.FindNodeByValue(\"Top7Incidents\")\n        Dim statIncidentPerCategory As RadTreeNode = subTreeStatisticalReport.Nodes.FindNodeByValue(\"IncidentsPerCategory\")\n        Dim compIncidentLoss As RadTreeNode = subTreeIncidentComparisons.Nodes.FindNodeByValue(\"IncidentLoss\")\n        Dim GeoMaps As RadTreeNode = subTreeGeographicLocations.Nodes.FindNodeByValue(\"Maps\")\n\n\n\n\n        statTimeOfDayNode.NavigateUrl = Globals.gRootRelativeSecureURL(\"/Reports/Reports.aspx?SessionID=\" + m_SessionID + \"&amp;qrptTOD=tod\")\nEnd Sub\n</code></pre>\n\n<p>Now if the user is going to click on the Time Of Day Node it's going to load the same page again but different ascx.</p>\n\n<pre><code>Private Sub RetrieveAllQueryStringParams()\n        Try\n            If Not String.IsNullOrEmpty(Request.QueryString(\"SessionID\")) Then\n                m_SessionID = Request.QueryString(\"SessionID\")\n                m_qrptTOD = Request.QueryString(\"qrptTOD\")\n            ElseIf Not String.IsNullOrEmpty(Session(\"SessionID\")) Then\n                m_SessionID = Session(\"SessionID\")\n            End If\n\n            If m_qrptTOD = \"tod\" Then\n                Page.LoadControl(\"/Controls/Reports/rptTimeOfDay.ascx\")\n            End If\n\n\n        Catch ex As Exception\n\n        End Try\n    End Sub\n</code></pre>\n\n<p>When it's getting here:</p>\n\n<pre><code> If m_qrptTOD = \"tod\" Then\n                Page.LoadControl(\"/Controls/Reports/rptTimeOfDay.ascx\")\n            End If\n</code></pre>\n\n<p>the ascx page is not loading for some reason!!\nWhat I'm doing wrong?!?!?</p>\n"}, {"tags": ["javascript", "c#", "jquery", "model-view-controller"], "comments": [{"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "edited": false, "score": 0, "creation_date": 1424906821, "post_id": 28731595, "comment_id": 45749480, "body": "Is it loading the page with an empty data-id?  Seems to me you should move the onchange onto the dropdownlist and call feedback onload also (change this in event handler to &quot;#userDiscomfortResponse&quot;)"}, {"owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "reply_to_user": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "edited": false, "score": 0, "creation_date": 1424906907, "post_id": 28731595, "comment_id": 45749507, "body": "No, data-id=&#39;@Model.userDiscomfortResponse&#39; has a value of &quot;Yes&quot; as soon as the page loads"}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "edited": false, "score": 0, "creation_date": 1424907089, "post_id": 28731595, "comment_id": 45749575, "body": "In the Javascript is $(this) evaluating to the DIV? or is &#39;this&#39; something else.  Also, try $(this).data(&quot;id&quot;) instead of attr(&quot;id&quot;)"}, {"owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "reply_to_user": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "edited": false, "score": 0, "creation_date": 1424907098, "post_id": 28731595, "comment_id": 45749578, "body": "Would you be able to provide some sample code regarding your suggestion?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424908128, "post_id": 28731830, "comment_id": 45749906, "body": "Copy and Pasted your sample got: Uncaught ReferenceError: $ is not defined  On line 1"}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "reply_to_user": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424908207, "post_id": 28731830, "comment_id": 45749936, "body": "Your using JQuery right - so have you not create the javascript after your having included the jquery.js?"}, {"owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424908876, "post_id": 28731830, "comment_id": 45750147, "body": "I dont know anymore haha xD apologies, I&#39;m new to all this, am I missing a component?"}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "reply_to_user": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424909055, "post_id": 28731830, "comment_id": 45750200, "body": "The HTML page that contained the javascript before needs to contain the javascript in the answer."}, {"owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424910435, "post_id": 28731830, "comment_id": 45750613, "body": "I&#39;ve replaced my original JavaScript code with the one in the answer, both pieces of code were stored in a single .JS file In my HTML I have the following: &lt;script type=&quot;text/javascript&quot; src=&quot;~/Scripts/ReviewContentControl.js&quot;&gt; &lt;/script&gt; Have I missed something?"}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "reply_to_user": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424938116, "post_id": 28731830, "comment_id": 45758608, "body": "Sounds like you have included the ReviewContentControl.js before jquery.js.  jquery.js might be included in a master page / layout page somewhere and the order is incorrect.  You can check the source in the browser and see what order they come in and then fix in the code.  You were using JQuery previously however it was probably executing later due to the onclick event which meant it was then defined"}, {"owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424987116, "post_id": 28731830, "comment_id": 45788507, "body": "Yeah, you&#39;re right I was missing &lt;script type=&quot;text/javascript&quot; src=&quot;<a href=\"http://code.jquery.com/jquery-1.10.0.min.js&quot;&gt;&lt;/script\" rel=\"nofollow noreferrer\">code.jquery.com/jquery-1.10.0.min.js&quot;&gt;&lt;/script</a>&gt; before ReviewContentControl.js So now it works, However... var feedback = $(&#39;#userDiscomfortResponse&#39;).val() The value is 0 instead of &quot;Yes&quot; any ideas?"}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "reply_to_user": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1424989086, "post_id": 28731830, "comment_id": 45789423, "body": "The htmlHelper EnumDropDownListFor is rendering this out with integer values, so its probably 0 = Yes, 1 = No.  I would just change the If statement in the javascript, e.g .val() == 0"}, {"owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "edited": false, "score": 0, "creation_date": 1426986551, "post_id": 28731830, "comment_id": 46594225, "body": "Sorry for the late response. Yes I did get it working however var feedback = $(&#39;#userDiscomfortResponse&#39;).val() returned value 0 (for Yes) 1 for (no) simply changing the if statement to reflect this made the above solution to work brilliantly, thank you"}], "tags": [], "owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "is_accepted": true, "score": 0, "last_activity_date": 1424907328, "creation_date": 1424907328, "answer_id": 28731830, "question_id": 28731595, "link": "https://stackoverflow.com/questions/28731595/passing-values-from-viewmodel-to-javascript/28731830#28731830", "title": "Passing values from ViewModel to JavaScript", "body": "<p>Ok, try removing the onclick on the div and add:</p>\n\n<pre><code>$(document).ready(function()\n{\n    function feedback() {\n        var feedback = $('#userDiscomfortResponse').val()\n        if (feedback == \"Yes\") {\n            document.getElementById(\"UserDiscomfortExerciseLabel\").style.display = \"block\"\n        }\n       else {\n           document.getElementById(\"UserDiscomfortExerciseLabel\").style.display = \"none\"\n       }\n    }\n\n    $(\"#userDiscomfortResponse\").change(feedback);\n    feedback();\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4608024, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9ad4e760a6c744419694618eea9828?s=128&d=identicon&r=PG&f=1", "display_name": "DreamingInCode", "link": "https://stackoverflow.com/users/4608024/dreamingincode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 28731830, "answer_count": 1, "score": 1, "last_activity_date": 1424907328, "creation_date": 1424906259, "question_id": 28731595, "link": "https://stackoverflow.com/questions/28731595/passing-values-from-viewmodel-to-javascript", "title": "Passing values from ViewModel to JavaScript", "body": "<p>I am making an MVC 5 web application and I am looking to pass a value from my ViewModel to a function in my JavaScript</p>\n\n<p>The aim is hide a Label/Div when the user selects the option \"No\" and make it reappear when the user changes the option back to \"Yes\"</p>\n\n<p>Here is what I have so far:</p>\n\n<p>ViewModel:</p>\n\n<pre><code>public enum BasicAnswer\n        {\n            [Display(Name= \"Yes\")]\n            Yes,\n            [Display(Name= \"No\")]\n            No\n        }\n public BasicAnswer userDiscomfortResponse { get; set; }\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>   &lt;div id=\"UserDiscomfortAnswerLabel\"&gt;\n            &lt;label id=\"somelabel\"&gt;Did you have any discomfort with an exercise?&lt;/label&gt;\n            &lt;div class=\"Answer1\" onclick=feedback data-id='@Model.userDiscomfortResponse'&gt;\n                @Html.EnumDropDownListFor(m =&gt; m.userDiscomfortResponse, new { @class = \"form-control\" })\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"Question2\"&gt;\n        &lt;label id=\"UserDiscomfortExerciseLabel\"&gt;What exercise was the issue?&lt;/label&gt; \n        &lt;div class=\"Answer2\"&gt;\n            @Html.DropDownListFor(m =&gt; m.discomfortExercise, Model.UsersSelectedExcerises, new { @class = \"form-control\" })\n        &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>JavaScript:</p>\n\n<pre><code>function feedback() {\n    var feedback = $(this).attr('data-id'); \n    if (feedback == \"Yes\") {\n        document.getElementById(\"UserDiscomfortExerciseLabel\").style.display = \"block\"\n    }\n    else {\n        document.getElementById(\"UserDiscomfortExerciseLabel\").style.display = \"none\"\n    }\n}\n</code></pre>\n\n<p>The issue I am having is var feedback = $(this).attr('data-id') results as undefined and so the label hides on click but never shows again. </p>\n\n<p>Is there something I've missed?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c#", "dynamic", "virtual", "channel", "citrix"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3998590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/99492ee41a477797f3a90d247052b3df?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Smith", "link": "https://stackoverflow.com/users/3998590/harry-smith"}, "edited": false, "score": 0, "creation_date": 1426412368, "post_id": 29023917, "comment_id": 46354828, "body": "Thanks.  The name that I&#39;m using is fine but your advice about the registry keys could be a pointer to the problem.  I&#39;ll experiment with the registry keys under which the plugin is listed and will post a comment here about the outcome. Cheers"}], "tags": [], "owner": {"reputation": 1402, "user_id": 533213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2255ae27bddc12aecd4e8b6341fe943?s=128&d=identicon&r=PG", "display_name": "donovan", "link": "https://stackoverflow.com/users/533213/donovan"}, "is_accepted": false, "score": 1, "last_activity_date": 1426213774, "creation_date": 1426213774, "answer_id": 29023917, "question_id": 28731570, "link": "https://stackoverflow.com/questions/28731570/citrix-dynamic-virtual-channel-error-cannot-find-a-transport-to-support-dvc/29023917#29023917", "title": "Citrix dynamic virtual channel error: Cannot find a transport to support DVC", "body": "<p>No there's no assignment of VCs for dynamic VCs. They work by getting multiplexed over the one static (underlying) VC.</p>\n\n<p>What name are you using for the \"pluginName\"? If you look at the vdping sample that comes with the SDK you will see a line in the client code for the DriverOpen implementation as follows:</p>\n\n<pre><code>OpenVirtualChannel.pVCName = CTXPING_VIRTUAL_CHANNEL_NAME;\n</code></pre>\n\n<p>This constant is defined in the associated vdping.h header file:</p>\n\n<pre><code>#define CTXPING_VIRTUAL_CHANNEL_NAME  \"CTXPING\"\n</code></pre>\n\n<p>So if I then wanted to open this VD on the server I would need to use \"CTXPING\" as the plugin name, which you can see in the associated server sample code in ctxping.c in the SDK (note the samples are quite old, so they're using the Citrix WF APIs, using WTSVirtualChannelOpenEx is also fine):</p>\n\n<pre><code>hVC = WFVirtualChannelOpen( WF_CURRENT_SERVER,\n                            WF_CURRENT_SESSION,\n                            CTXPING_VIRTUAL_CHANNEL_NAME );\n</code></pre>\n\n<p>Apart from that you just have to ensure you have properly followed the registration steps and added the necessary registry keys. Note that the docs were created pre-x64. So while the docs state:</p>\n\n<pre><code>HKLM\\Software\\Citrix\\ICA Client\\etc...\n</code></pre>\n\n<p>You need to ensure you use the 32 bit registry hive instead since the Windows client is 32 bit:</p>\n\n<pre><code>HKLM\\Software\\Wow6432Node\\Citrix\\ICA Client\\etc...\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3998590, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/99492ee41a477797f3a90d247052b3df?s=128&d=identicon&r=PG&f=1", "display_name": "Harry Smith", "link": "https://stackoverflow.com/users/3998590/harry-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426213774, "creation_date": 1424906138, "question_id": 28731570, "link": "https://stackoverflow.com/questions/28731570/citrix-dynamic-virtual-channel-error-cannot-find-a-transport-to-support-dvc", "title": "Citrix dynamic virtual channel error: Cannot find a transport to support DVC", "body": "<p>I'm having trouble getting a dynamic virtual channel created between the Citrix server and the local PC.  The error that is coming up on the server side is:</p>\n\n<p>CSession::CreateDynamicChannel:Cannot find a transport to support DVC= </p>\n\n<p>I have a C++ COM dll registered as a plugin on the local PC and it appears that it is being loaded correctly by the Citrix Receiver's virtual channel manager (my trace logging from initialization through to attaching a listener to the end point indicates that all is working fine).</p>\n\n<p>However, when we start the executable on the Citrix server, we get the error mentioned above.  The executable is a C#/.Net application.  The error occurs in response to my call to WTSVirtualChannelOpenEx.</p>\n\n<p>My function prototype in C# for that function is as follows:</p>\n\n<pre><code>[DllImport(\"wtsapi32.dll\", SetLastError = true)]\nprivate static extern IntPtr WTSVirtualChannelOpenEx(\n    [In]\n    [param: MarshalAs(UnmanagedType.I4)]\n    int SessionId,\n    [In]\n    [param: MarshalAs(UnmanagedType.LPStr)]\n    string VirtualName,\n    [In]\n    [param: MarshalAs(UnmanagedType.U4)]\n    int flags);\n</code></pre>\n\n<p>My actual call to the function is as follows:</p>\n\n<pre><code>_vcHandle = WTSVirtualChannelOpenEx(\n    (int)Session.WTS_CURRENT_SESSION,\n    pluginName,\n    (int)(DynamicChannel.WTS_CHANNEL_OPTION_DYNAMIC | DynamicChannel.WTS_CHANNEL_OPTION_DYNAMIC_PRI_HIGH)\n    );\n</code></pre>\n\n<p>The value for \"pluginName\" is a 7-character string loaded from a config file.</p>\n\n<p>The Citrix documentation on dynamic virtual channels says simply to follow the Microsoft API on both the client and server ends, which I've done.  That documentation specifies how to register the plugin on the client but doesn't stipulate having to do anything extra on the server.</p>\n\n<p>From my understanding, the virtual channel manager on the server gets a list of names of plugins from the virtual channel manager on the client.  The server-side virtual channel manager then stores the names in a table.  Thereafter, when any program requests a connection via a dynamic virtual channel to a client-side plugin, the server-side virtual channel manager looks up the name in the table and then sends the connection request through to the client.</p>\n\n<p>Is there possibly something in the setup that needs to be done.  For example, does a dynamic virtual channel need to be assigned by an administrator to a specific static virtual channel number, or does the virtual channel manager take care of that dynamically (hence the name \"dynamic\") at the time that a request is made?</p>\n\n<p>I haven't been able to find any references, in documentation or in searching the Web, to the sort of error that we're experiencing. </p>\n"}, {"tags": ["c#", "xaml", "windows-8", "windows-runtime", "windows-8-mail-app"], "answers": [{"tags": [], "owner": {"reputation": 21144, "user_id": 4068779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0Hsj.png?s=128&g=1", "display_name": "Rob Caplan - MSFT", "link": "https://stackoverflow.com/users/4068779/rob-caplan-msft"}, "is_accepted": true, "score": 1, "last_activity_date": 1424919480, "creation_date": 1424919480, "answer_id": 28733683, "question_id": 28731538, "link": "https://stackoverflow.com/questions/28731538/winrt-windows-8-app-connecting-to-a-service-control/28733683#28733683", "title": "WinRT/Windows 8 app - &quot;Connecting to a service&quot; control?", "body": "<p>That looks like the <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.security.authentication.web.webauthenticationbroker.aspx\" rel=\"nofollow\">WebAuthenticationBroker</a> used to connect to oAuth providers. It hosts an internal WebView and manages the callbacks to support single-sign-on via your identity provider.</p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh750301.aspx\" rel=\"nofollow\">Authentication and user identity (C#/C++/VB)</a> and the <a href=\"http://code.msdn.microsoft.com/windowsapps/Web-Authentication-d0485122\" rel=\"nofollow\">Web authentication broker sample</a> for details.</p>\n"}], "owner": {"reputation": 757, "user_id": 2714911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2OBhl.jpg?s=128&g=1", "display_name": "Travis Liew", "link": "https://stackoverflow.com/users/2714911/travis-liew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 28733683, "answer_count": 1, "score": 0, "last_activity_date": 1424919480, "creation_date": 1424906015, "last_edit_date": 1495542027, "question_id": 28731538, "link": "https://stackoverflow.com/questions/28731538/winrt-windows-8-app-connecting-to-a-service-control", "title": "WinRT/Windows 8 app - &quot;Connecting to a service&quot; control?", "body": "<p>Is there a specific control for the \"Connecting to a service\" window? Or is it a flyout-type control (or something else) with an embedded WebView?</p>\n\n<p>Thanks.</p>\n\n<p><a href=\"http://fud.community.services.support.microsoft.com/Fud/FileDownloadHandler.ashx?fid=2394286f-e26d-4ceb-82f4-3cfd66b5b9a2\" rel=\"nofollow noreferrer\">Example 1</a>, <a href=\"https://stackoverflow.com/questions/16281274/c-sharp-custom-connecting-to-a-service-metro-app\">Example 2</a></p>\n"}, {"tags": ["c#", ".net", "monogame"], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 749490, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/I33ol.jpg?s=128&g=1", "display_name": "Chris Clements", "link": "https://stackoverflow.com/users/749490/chris-clements"}, "is_accepted": false, "score": 1, "last_activity_date": 1425004181, "creation_date": 1425004181, "answer_id": 28756528, "question_id": 28731449, "link": "https://stackoverflow.com/questions/28731449/monogame-error-9009-ignoreme-dll-not-found/28756528#28756528", "title": "MonoGame - Error 9009 &amp; IgnoreMe.dll not found", "body": "<p>I wouldn't expect that you would want to create content for the PSM (PlayStation Mobile).  Check the targeted platform of the ContentBuilder project to ensure you are building for Windows.</p>\n"}], "owner": {"reputation": 73, "user_id": 4126581, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GETlu.png?s=128&g=1", "display_name": "JustBenji", "link": "https://stackoverflow.com/users/4126581/justbenji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1425114678, "creation_date": 1424905595, "last_edit_date": 1425114678, "question_id": 28731449, "link": "https://stackoverflow.com/questions/28731449/monogame-error-9009-ignoreme-dll-not-found", "title": "MonoGame - Error 9009 &amp; IgnoreMe.dll not found", "body": "<p>i've just installed MonoGame and XNA and i'm having some issues from the jump, from googling it seems as though i need to add 'C:\\Windows\\System32' to my path environment variables, i've tried adding it here</p>\n\n<p><img src=\"https://i.stack.imgur.com/71IxO.png\" alt=\"enter image description here\"></p>\n\n<p>but i'm still getting these errors</p>\n\n<p>Error   1   </p>\n\n<blockquote>\n  <p>The command \"SETX MONOGAME_PLATFORM \"PSM\" > NUL\" exited with code 9009.    MyMonoGameContent</p>\n</blockquote>\n\n<p>Error   2   </p>\n\n<blockquote>\n  <p>Metadata file 'C:\\Users\\Benji\\documents\\visual studio 2013\\Projects\\myMonoGame\\MyMonoGameContent\\MyMonoGameContent\\bin\\PSM\\IgnoreMe.dll' could not be found    C:\\Users\\Benji\\documents\\visual studio 2013\\Projects\\myMonoGame\\myMonoGame\\CSC  myMonoGame</p>\n</blockquote>\n\n<p>This happens when i try to compile after referencing my content project</p>\n\n<p><img src=\"https://i.stack.imgur.com/0QFq5.png\" alt=\"enter image description here\"></p>\n\n<p>i'm following these <a href=\"http://rbwhitaker.wikidot.com/monogame-tutorials\" rel=\"nofollow noreferrer\">http://rbwhitaker.wikidot.com/monogame-tutorials</a> </p>\n\n<p>no idea what's up, was that the wrong place to set the enviroment variable? i've tried looking for a user property sheet but can't find one in my project </p>\n\n<p><img src=\"https://i.stack.imgur.com/2aWRz.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 12837, "user_id": 1289283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6032d2f69702e956cefaa866eb90d6c7?s=128&d=identicon&r=PG&f=1", "display_name": "walther", "link": "https://stackoverflow.com/users/1289283/walther"}, "edited": false, "score": 2, "creation_date": 1424905683, "post_id": 28731424, "comment_id": 45749000, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/1651424/mdi-applications-in-wpf\">MDI Applications in WPF</a>"}, {"owner": {"reputation": 5960, "user_id": 1522548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/swFB2.png?s=128&g=1", "display_name": "JWP", "link": "https://stackoverflow.com/users/1522548/jwp"}, "edited": false, "score": 0, "creation_date": 1424905721, "post_id": 28731424, "comment_id": 45749017, "body": "You will want to use what is called a POPUP, take a look here:  <a href=\"https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=popup%20wpf\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>   Remember that with WPF a Popup is wholly contained in the main window and cannot go beyond it."}, {"owner": {"reputation": 5960, "user_id": 1522548, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/swFB2.png?s=128&g=1", "display_name": "JWP", "link": "https://stackoverflow.com/users/1522548/jwp"}, "edited": false, "score": 1, "creation_date": 1424906310, "post_id": 28731424, "comment_id": 45749278, "body": "You can also add a TabControl with TabItems.  When a button is clieck the tabcontrol&#39;s current item is set the proper one."}, {"owner": {"reputation": 7, "user_id": 3489530, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004164848890/picture?type=large", "display_name": "RuthGoodloser", "link": "https://stackoverflow.com/users/3489530/ruthgoodloser"}, "edited": false, "score": 0, "creation_date": 1424906479, "post_id": 28731424, "comment_id": 45749342, "body": "Thank you dear, Let me try that."}], "answers": [{"comments": [{"owner": {"reputation": 1458, "user_id": 4547223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ylCvJ.jpg?s=128&g=1", "display_name": "Rainer Schaack", "link": "https://stackoverflow.com/users/4547223/rainer-schaack"}, "edited": false, "score": 0, "creation_date": 1424938541, "post_id": 28732317, "comment_id": 45758802, "body": "+1. Seems like a reasonable solution. If I understand it, RuthGoodloser do not want a popup or another window. Using tabs / panes will handle all this IN the main window."}], "tags": [], "owner": {"reputation": 609, "user_id": 4283098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1590811637/picture?type=large", "display_name": "William Callahan", "link": "https://stackoverflow.com/users/4283098/william-callahan"}, "is_accepted": false, "score": 1, "last_activity_date": 1424910018, "creation_date": 1424910018, "answer_id": 28732317, "question_id": 28731424, "link": "https://stackoverflow.com/questions/28731424/how-do-i-add-another-components-on-the-mainwindow/28732317#28732317", "title": "How do i add another components on the MainWindow?", "body": "<p>There are a couple different solutions to you problem, but Visual Studio doesn't quite have something like the Master View option through ASP .NET with webforms.</p>\n\n<p><strong>Option One</strong>\nUsing <em>TabControl</em>. This option is the easiest solution to your problem. The GUI in Visual studio has support for adding components to each tab, which nothing else has. This is the closest component to something like multi-panels in Java, but it will still create the Tabs, which may not be what you are looking for.</p>\n\n<p><strong>Option Two</strong>\nUsing multiple <em>Panel</em>s over one another. With this option, you can add multiple panels to your main window and layer each panel over one another. You can add a button or other control which will hide each panel and all of its contents. This is a great solution if you don't want tabs, but it can be frustrating to create in Visual Studio since you must move each panel away from another in order to add/remove/adjust the components on the underlying panel.</p>\n\n<p>Of course there are still a few more controls you can use to produce the results you are looking for, but these are probably the most applicable solutions to your problem.</p>\n"}], "owner": {"reputation": 7, "user_id": 3489530, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004164848890/picture?type=large", "display_name": "RuthGoodloser", "link": "https://stackoverflow.com/users/3489530/ruthgoodloser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1424910018, "creation_date": 1424905524, "last_edit_date": 1424909155, "question_id": 28731424, "link": "https://stackoverflow.com/questions/28731424/how-do-i-add-another-components-on-the-mainwindow", "title": "How do i add another components on the MainWindow?", "body": "<p>Struggling, I need a button to open up a window but below the MainWindow in C#. Like in a website you can open other pages but the master page layout doesn't change only the page you are viewing shows differently. </p>\n\n<p>I need similar thing. I have components (tools i added from toolbox) on my MainWindow.xaml so for example if i click on a button i named new student, a tabbed-window where i can capture student details must appear but it must not be a separate windows it must appear within the mainwindow and seem like a one thing. Forgive for my English. I hope someone will understand me though, thanks in advance. I want to have components/functionality according a specific button click but constant Mainwindow, the one with \"File\" \"Edit\" \"View\" \"Help\". </p>\n"}, {"tags": ["c#", "arrays", "csv", "multidimensional-array"], "comments": [{"owner": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 0, "creation_date": 1424905490, "post_id": 28731365, "comment_id": 45748928, "body": "Use the proper tool.  Check out <code>Microsoft.VisualBasic.FileIO.TextFieldParser</code>"}, {"owner": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 0, "creation_date": 1424905673, "post_id": 28731365, "comment_id": 45748997, "body": "I would rather <a href=\"http://stackoverflow.com/questions/1050112/how-to-read-a-csv-file-into-a-net-datatable\">read it into a DataTable</a>."}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 1355697, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/40846f17b4bd8cf38aa950eee8845d4d?s=128&d=identicon&r=PG", "display_name": "Graham Warrender", "link": "https://stackoverflow.com/users/1355697/graham-warrender"}, "edited": false, "score": 0, "creation_date": 1425429460, "post_id": 28731533, "comment_id": 45958266, "body": "In this instance line 2 would be accessed via <code>string name = contacts[1].LastName;</code> ?"}, {"owner": {"reputation": 25180, "user_id": 668272, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e4b4df6df17383aa6721c783a5a87335?s=128&d=identicon&r=PG", "display_name": "Bas", "link": "https://stackoverflow.com/users/668272/bas"}, "reply_to_user": {"reputation": 365, "user_id": 1355697, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/40846f17b4bd8cf38aa950eee8845d4d?s=128&d=identicon&r=PG", "display_name": "Graham Warrender", "link": "https://stackoverflow.com/users/1355697/graham-warrender"}, "edited": false, "score": 0, "creation_date": 1425488786, "post_id": 28731533, "comment_id": 45986478, "body": "@GrahamWarrender Yes indeed"}], "tags": [], "owner": {"reputation": 25180, "user_id": 668272, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e4b4df6df17383aa6721c783a5a87335?s=128&d=identicon&r=PG", "display_name": "Bas", "link": "https://stackoverflow.com/users/668272/bas"}, "is_accepted": true, "score": 3, "last_activity_date": 1424906317, "last_edit_date": 1424906317, "creation_date": 1424905977, "answer_id": 28731533, "question_id": 28731365, "link": "https://stackoverflow.com/questions/28731365/csv-to-multidimensional-array-with-c/28731533#28731533", "title": "CSV to multidimensional array with c#", "body": "<p>The comments explain that it might be better to use a predefined library, and perhaps parse into a <code>DataTable</code>. </p>\n\n<p>If you do not mind a jagged array instead of a two-dimensional array, consider the following one-liner:</p>\n\n<pre><code>string[][] lines = File.ReadLines(path)\n          .Select(s =&gt; s.Split(\",\".ToCharArray())).ToArray().ToArray();\n</code></pre>\n\n<p>You can access it using <code>lines[1][3]</code> instead of <code>lines[1,3]</code></p>\n\n<p>In your case, perhaps it would be even better to create a class for it:</p>\n\n<pre><code>public class Contact\n{\n    public string FirstName { get; set; }\n    public string LastName { get; set; }\n    public string EmailAddress { get; set; }\n\n    public Contact(string firstName, string lastName, string emailAddress)\n    {\n        this.FirstName = firstName;\n        this.LastName = lastName;\n        this.EmailAddress = emailAddress;\n    }\n\n    public static Contact[] LoadContacts(string csvFile)\n    {\n        return File.ReadLines(csvFile).Select(CreateFromCsvLine).ToArray();\n    }\n    private static readonly char[] separator = new[] { ',' };\n    private static Contact CreateFromCsvLine(string line)\n    {\n        string[] split = line.Split(separator);\n        return new Contact(split[0], split[1], split[2]);\n    }\n}\n</code></pre>\n\n<p>In that case you can do:</p>\n\n<pre><code>Contact[] contacts = Contact.LoadContacts(\"contacts.csv\");\nstring name = contacts[0].LastName;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35071, "user_id": 316799, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0fa8da5d4aacf3078d23d33c4effadd5?s=128&d=identicon&r=PG", "display_name": "Felipe Oriani", "link": "https://stackoverflow.com/users/316799/felipe-oriani"}, "is_accepted": false, "score": 2, "last_activity_date": 1424906155, "creation_date": 1424906155, "answer_id": 28731574, "question_id": 28731365, "link": "https://stackoverflow.com/questions/28731365/csv-to-multidimensional-array-with-c/28731574#28731574", "title": "CSV to multidimensional array with c#", "body": "<p>You could add a method which recivies a path and a separator and prepare it to return a <code>string[][]</code>. For sample:</p>\n\n<pre><code>using System.IO;\n\npublic static string[][] CSV_ToArray(string path, string separator = \";\")\n{\n    // check if the file exists\n    if (!File.Exists(path))\n        throw new FileNotFoundException(\"The CSV specified was not found.\");\n\n    // temporary list to store information\n    List&lt;string[]&gt; temp = new List&lt;string[]&gt;();\n\n    using (var reader = new StreamReader(File.OpenRead(path)))\n    {\n        while (!reader.EndOfStream)\n        {\n            // read the line\n            string line = reader.ReadLine();\n\n            // if you need to give some changes on the inforation\n            // do it here!\n            string[] values = line.Split(separator.ToCharArray());\n\n            // add to the temporary list\n            temp.Add(values);           \n        }\n    }\n\n    // convert te list to array, which it will be a string[][]\n    return temp.ToArray();  \n}\n</code></pre>\n\n<p>and use it:</p>\n\n<pre><code>string[][] csv = CSV_ToArray(\"myFile.csv\");\n</code></pre>\n\n<p>or using another separator:</p>\n\n<pre><code>string[][] csv = CSV_ToArray(\"myFile.csv\", \",\");\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 1355697, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/40846f17b4bd8cf38aa950eee8845d4d?s=128&d=identicon&r=PG", "display_name": "Graham Warrender", "link": "https://stackoverflow.com/users/1355697/graham-warrender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2222, "favorite_count": 0, "accepted_answer_id": 28731533, "answer_count": 2, "score": 3, "last_activity_date": 1424906317, "creation_date": 1424905319, "question_id": 28731365, "link": "https://stackoverflow.com/questions/28731365/csv-to-multidimensional-array-with-c", "title": "CSV to multidimensional array with c#", "body": "<p>How can i read a CSV file into a multidimensional array?</p>\n\n<pre><code>public void CSV_ToArray(string filePath)\n    {\n        try\n        {\n            StreamReader sr = new StreamReader(filePath);\n            int colCount = 3;\n            int rowCount = getNumberOfRows(sr);\n\n            string[,] Contacts = new string[rowCount, colCount];\n        }\n        catch (Exception error)\n        {\n            MessageBox.Show(error.ToString());\n        }\n\n    }\n</code></pre>\n\n<p>I've already created the array with it's dimensions but unsure as to how to assign the data to each position in the array</p>\n\n<p>The format of the CSV file will be \nfirstName, LastName, Email</p>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 1436, "user_id": 2316913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437000ec8b08ec25f03352ecdebfb724?s=128&d=identicon&r=PG", "display_name": "Leandro", "link": "https://stackoverflow.com/users/2316913/leandro"}, "edited": false, "score": 0, "creation_date": 1424908074, "post_id": 28731363, "comment_id": 45749885, "body": "Sounds like an issue with the <code>CD</code> (current directory) set at application startup. How are you starting the application on user log-on? A shortcut in the start menu or what? If it is a shortcut, you might get along by setting the &quot;Start In:&quot; property pointing to your app&#39;s directory."}, {"owner": {"reputation": 4471, "user_id": 1676134, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8a615f415d1d78c5c83dacd66468086?s=128&d=identicon&r=PG", "display_name": "E-Bat", "link": "https://stackoverflow.com/users/1676134/e-bat"}, "reply_to_user": {"reputation": 1436, "user_id": 2316913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437000ec8b08ec25f03352ecdebfb724?s=128&d=identicon&r=PG", "display_name": "Leandro", "link": "https://stackoverflow.com/users/2316913/leandro"}, "edited": false, "score": 0, "creation_date": 1424961841, "post_id": 28731363, "comment_id": 45773146, "body": "@LeandroTaset,  application loading is configured via user Registry at user logon, for unknown reasons in this cases the application cant resolve the path to files. Notably if the application is launched manually by the user (i.e. double clicking) all works fine."}], "answers": [{"comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "reply_to_user": {"reputation": 1436, "user_id": 2316913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/437000ec8b08ec25f03352ecdebfb724?s=128&d=identicon&r=PG", "display_name": "Leandro", "link": "https://stackoverflow.com/users/2316913/leandro"}, "edited": false, "score": 1, "creation_date": 1424909740, "post_id": 28731662, "comment_id": 45750396, "body": "No, in code behind you&#39;ll have to write a full Pack Uri."}], "tags": [], "owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1424906524, "creation_date": 1424906524, "answer_id": 28731662, "question_id": 28731363, "link": "https://stackoverflow.com/questions/28731363/setting-wpf-window-background-image-at-app-start-up/28731662#28731662", "title": "Setting WPF Window Background Image at App Start Up", "body": "<p>Better load the image as embedded resource.</p>\n\n<p>Set the Build Action to Resource (and do not copy to output directory), and load it via a <a href=\"https://msdn.microsoft.com/en-us/library/aa970069.aspx\" rel=\"nofollow\">Resource Pack URI</a>:</p>\n\n<pre><code>imgBackground.ImageSource = new BitmapImage(\n    new Uri(\"pack://application:,,,/Resources/Background.png\"));\n</code></pre>\n"}], "owner": {"reputation": 4471, "user_id": 1676134, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8a615f415d1d78c5c83dacd66468086?s=128&d=identicon&r=PG", "display_name": "E-Bat", "link": "https://stackoverflow.com/users/1676134/e-bat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 28731662, "answer_count": 1, "score": 0, "last_activity_date": 1424963119, "creation_date": 1424905316, "last_edit_date": 1424963119, "question_id": 28731363, "link": "https://stackoverflow.com/questions/28731363/setting-wpf-window-background-image-at-app-start-up", "title": "Setting WPF Window Background Image at App Start Up", "body": "<p>I have an application that shows a different background images according to environment state, this app is launched at user logon via Windows Registry (HKEY_CURRENT_USER).<br> After user login the application is launched but it crashes afterward, complaining that the Uri for the image is not valid. <br>Notably if the application is launched manually by the user (i.e. double clicking) all works fine, and the corresponding image is successfully loaded.<br>\nImages are configured with <em>Build Action = None, and Copy to output directory= Copy if newer</em>.</p>\n\n<p>This markup in my main window:</p>\n\n<pre><code>&lt;Window.Background&gt;\n    &lt;ImageBrush x:Name=\"imgBackground\" &gt;&lt;/ImageBrush&gt;\n&lt;/Window.Background&gt;\n</code></pre>\n\n<p>Then in codebehind I want to set the corresponding image:</p>\n\n<pre><code>imgBackground.ImageSource = \n     new BitmapImage(new Uri(@\"Resources\\Background.png\",UriKind.RelativeOrAbsolute));\n</code></pre>\n\n<p>Images are configured with <em>Build Action = None, and Copy to output directory= Copy if newer</em>.</p>\n"}, {"tags": ["c#", "forms"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4556062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60044e6d5c507f0fe33a40b5d140b297?s=128&d=identicon&r=PG&f=1", "display_name": "Robert K", "link": "https://stackoverflow.com/users/4556062/robert-k"}, "edited": false, "score": 0, "creation_date": 1424905689, "post_id": 28731413, "comment_id": 45749003, "body": "can&#39;t believe I didn&#39;t see that. Thanks so much!"}, {"owner": {"reputation": 5421, "user_id": 1594449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688d73160b862fef962b8981a8ae620c?s=128&d=identicon&r=PG", "display_name": "gknicker", "link": "https://stackoverflow.com/users/1594449/gknicker"}, "reply_to_user": {"reputation": 19, "user_id": 4556062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60044e6d5c507f0fe33a40b5d140b297?s=128&d=identicon&r=PG&f=1", "display_name": "Robert K", "link": "https://stackoverflow.com/users/4556062/robert-k"}, "edited": false, "score": 0, "creation_date": 1424920035, "post_id": 28731413, "comment_id": 45752991, "body": "@RobertK Then you should <a href=\"http://meta.stackexchange.com/a/5235/236612\">accept his answer</a>."}], "tags": [], "owner": {"reputation": 35069, "user_id": 1324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883238a436c061eaf848af87b8fda561?s=128&d=identicon&r=PG", "display_name": "Paul Roub", "link": "https://stackoverflow.com/users/1324/paul-roub"}, "is_accepted": false, "score": 3, "last_activity_date": 1424905478, "creation_date": 1424905478, "answer_id": 28731413, "question_id": 28731355, "link": "https://stackoverflow.com/questions/28731355/system-formatexception-error-issues-in/28731413#28731413", "title": "System.FormatException error issues in", "body": "<p>In this line:</p>\n\n<pre><code>(string.Format(\"{0,-10} | {1,20}  | {2,-23} | {3,40}\", \"tile      \" + \"Pallets   \", pallet, palletcost.ToString(\"C2\"))) + \"\\n\" +\n</code></pre>\n\n<p>You're looking for 4 parameters, but only three are passed:</p>\n\n<pre><code>\"tile      \" + \"Pallets   \", \npallet, \npalletcost.ToString(\"C2\")\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4556062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60044e6d5c507f0fe33a40b5d140b297?s=128&d=identicon&r=PG&f=1", "display_name": "Robert K", "link": "https://stackoverflow.com/users/4556062/robert-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "closed_date": 1424931135, "answer_count": 1, "score": 0, "last_activity_date": 1424905478, "creation_date": 1424905295, "question_id": 28731355, "link": "https://stackoverflow.com/questions/28731355/system-formatexception-error-issues-in", "closed_reason": "Not suitable for this site", "title": "System.FormatException error issues in", "body": "<p>I keep getting a system.formatexception error every time I run my program and it keeps highlighting this section with a red underline at the last semicolon. Any idea on why it's doing this and how I can remedy the situation?</p>\n\n<pre><code> output1.Text = \"Supplies\" + \"\\n\" +\n            (string.Format(\"{0,-10} | {1,20}  | {2,-23} | {3,40}\", \"Underlay  \", underlay, \" panels\", underlaycost.ToString(\"C2\"))) + \"\\n\" +\n            (string.Format(\"{0,-10} | {1,20}  | {2,-23} | {3,40}\", \"Screws    \", screws, \" boxes\", screwscost.ToString(\"C2\"))) + \"\\n\" +\n            (string.Format(\"{0,-10} | {1,20}  | {2,-23} | {3,40}\", \"Adhesive  \", gallonsofadhesive, \" gallons\", adhesivecost.ToString(\"C2\"))) + \"\\n\" +\n            (string.Format(\"{0,-10} | {1,20}  | {2,-23} | {3,40}\", \"Grout     \", bagsofgrout, \" bags\", groutcost.ToString(\"C2\"))) + \"\\n\" +\n            (string.Format(\"{0,-10} | {1,20}  | {2,-23} | {3,40}\", \"tile      \" + \"Pallets   \", pallet, palletcost.ToString(\"C2\"))) + \"\\n\" +\n            (string.Format(\"{0,20}  | {1,-23} | {2,40}\", \"Packs     \", packs, packcost.ToString(\"C2\"))) + \"\\n\" +\n            (string.Format(\"{0,20}  | {1,-23} | {2,40}\", \"Tiles     \", tiles, individualtilescost.ToString(\"C2\"))) + \"\\n\" +\n            (string.Format(\"{0,20}  | {1,-23} | {2,40}\", \"Thresholds\", threshold, thresholdscost.ToString(\"C2\")));\n</code></pre>\n"}, {"tags": ["c#", "linq", "grouping"], "answers": [{"comments": [{"owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "edited": false, "score": 0, "creation_date": 1424906141, "post_id": 28731419, "comment_id": 45749193, "body": "We override Equals to tell define the mean of equality between these class&#39;s objects. What about the override of GetHashCode? thank you"}, {"owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "reply_to_user": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "edited": false, "score": 0, "creation_date": 1424906325, "post_id": 28731419, "comment_id": 45749286, "body": "@Med.Amine.Touil well that is the point here.determining if two objects are equal so they can put into the same group.overriding gethashcode only is not enough you need to override them both. if gethashcode returns false the Equals method is called."}, {"owner": {"reputation": 1625, "user_id": 1619231, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/QXIgS.jpg?s=128&g=1", "display_name": "Daniel Leiszen", "link": "https://stackoverflow.com/users/1619231/daniel-leiszen"}, "edited": false, "score": 0, "creation_date": 1424906500, "post_id": 28731419, "comment_id": 45749354, "body": "Thanks for the fast answer. It&#39;s kinda obvious afterwards :) The difference between Linq to Objects and Linq to Entities always fools me."}], "tags": [], "owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "is_accepted": true, "score": 2, "last_activity_date": 1424905495, "creation_date": 1424905495, "answer_id": 28731419, "question_id": 28731348, "link": "https://stackoverflow.com/questions/28731348/linq-groupby-behaves-differently-for-classes-and-values/28731419#28731419", "title": "Linq GroupBy behaves differently for classes and values", "body": "<p><code>GroupBy</code> uses default equality comparer for the type unless you provide any implementation.The default comparer for reference types only return true if they are same instances, meaning they have same references. If this is not the behaviour you want you have two choices:</p>\n\n<ol>\n<li>Override <code>Equals</code> and <code>GetHashCode</code> methods in your clas</li>\n<li>Implement an <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/ms132151%28v=vs.100%29.aspx\" rel=\"nofollow\"><code>IEqualityComparer</code></a> for your type and pass it to <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/bb534334(v=vs.100).aspx\" rel=\"nofollow\"><code>GroupBy</code></a></li>\n</ol>\n"}], "owner": {"reputation": 1625, "user_id": 1619231, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/QXIgS.jpg?s=128&g=1", "display_name": "Daniel Leiszen", "link": "https://stackoverflow.com/users/1619231/daniel-leiszen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 28731419, "answer_count": 1, "score": 0, "last_activity_date": 1424905495, "creation_date": 1424905258, "question_id": 28731348, "link": "https://stackoverflow.com/questions/28731348/linq-groupby-behaves-differently-for-classes-and-values", "title": "Linq GroupBy behaves differently for classes and values", "body": "<p>Please consider the following code segment:</p>\n\n<pre><code>var list = new string[] { \"ab\", \"ab\", \"cd\", \"cd\", \"cd\" };\nvar groups = list.GroupBy(l =&gt; l);\nvar count = groups.Count();\n</code></pre>\n\n<p>The results:</p>\n\n<pre><code>count: 2,\ngroups: [{ Key: \"ab\", elements: [\"ab\", \"ab\"] }, { Key: \"cd\", elements: [\"cd\", \"cd\", \"cd\"] }]\n</code></pre>\n\n<p>When I do the same for class X:</p>\n\n<pre><code>public class X\n{\n    public int A { get; set; }\n    public string B { get; set; }\n}\n</code></pre>\n\n<p>And the same algorithm is used in order to create the grouped results:</p>\n\n<pre><code>var list2 = new X[] \n    {\n        new X { A = 1, B = \"b1\" },\n        new X { A = 1, B = \"b1\" },\n        new X { A = 2, B = \"b2\" },\n        new X { A = 2, B = \"b2\" },\n        new X { A = 2, B = \"b2\" },\n    };\n\nvar groups2 = list2.GroupBy(l =&gt; l);\nvar count2 = groups2.Count();\n</code></pre>\n\n<p>I would expect the same behavior. I would say count2 is 2, and groups2 contains the two different distinct data sets with 2 and 3 elements respectively.</p>\n\n<p>However when I run this, I get 5 as count and a list of groups containing one item each. Why is the different behavior? I would expect the same aggregation algorithm to behave the same.</p>\n\n<p>Thanks in advance for the explanation.</p>\n"}, {"tags": ["c#", "winforms", "datagridview"], "answers": [{"tags": [], "owner": {"reputation": 970, "user_id": 4018460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Bhaskar", "link": "https://stackoverflow.com/users/4018460/bhaskar"}, "is_accepted": false, "score": 0, "last_activity_date": 1424918595, "creation_date": 1424918595, "answer_id": 28733581, "question_id": 28731264, "link": "https://stackoverflow.com/questions/28731264/datagridview-time-sheet-similar-to-outlook-calendar/28733581#28733581", "title": "DataGridView: Time sheet similar to Outlook Calendar", "body": "<p>Use first column of DGV for the dates and another 24 columns for the 24 hours range (total 25 columns). Go to <code>ColumnCollection</code> to set Column <code>HeaderText</code> property. Have a database of 3-4 columns storing datetime, user, events, etc. When you load the database, fill DGV according to datetime column.</p>\n\n<p>Use the <code>CellClick</code> or <code>CellDoubleClick</code> Event for the employees to select the cell.</p>\n\n<p>Do comment if I miss something.</p>\n"}], "owner": {"reputation": 41, "user_id": 4154221, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8f21491bf16669f193efe8c4dff341c1?s=128&d=identicon&r=PG&f=1", "display_name": "Basit", "link": "https://stackoverflow.com/users/4154221/basit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424918595, "creation_date": 1424904930, "question_id": 28731264, "link": "https://stackoverflow.com/questions/28731264/datagridview-time-sheet-similar-to-outlook-calendar", "title": "DataGridView: Time sheet similar to Outlook Calendar", "body": "<p>I need to create a time sheet for employee in datagrid view, where employee can select working hours of each day.\nI want to display DataGrid in such a way that hours of day appear as columns (24 columns) and rows appear as days (30-31 depending upon month), similar to Outlook Calendar thing where we select number of hours for some event on a particular day.\nSo that when employee selects cells I can get work time from corresponding selected columns.\nCan some one point me to direction how I can label my rows and columns with dates and time. </p>\n"}, {"tags": ["c#", "c++", "wcf"], "answers": [{"tags": [], "owner": {"reputation": 1463, "user_id": 1548997, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/lBhvJ.png?s=128&g=1", "display_name": "pixelbadger", "link": "https://stackoverflow.com/users/1548997/pixelbadger"}, "is_accepted": false, "score": 0, "last_activity_date": 1424905751, "last_edit_date": 1424905751, "creation_date": 1424905442, "answer_id": 28731398, "question_id": 28731245, "link": "https://stackoverflow.com/questions/28731245/how-to-raise-events-from-c-code-and-call-handlers-in-c-code-on-another-proces/28731398#28731398", "title": "how to raise events from C++ code and call handlers in C# code on another process?", "body": "<p>There are a <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365574%28v=vs.85%29.aspx\" rel=\"nofollow\">number of IPC mechanisms</a> to choose from in Windows. </p>\n\n<p>Having evaluated a number of them, its really a case of deciding which one has the least disadvantages for your use case. I've used named pipes for a C# to C++ messaging system, and I'm still not sure I made the right choice.</p>\n\n<p>That said, if you are <em>just</em> looking at signalling events (and don't need to include state) a <a href=\"https://msdn.microsoft.com/en-us/library/System.Threading.Mutex(v=vs.100).aspx\" rel=\"nofollow\">shared mutex</a> might be a lightweight alternative.</p>\n\n<p>EDIT: I meant to say that if you do choose named pipes you'll need to use a custom solution. Using WCF would mean reverse engineering the WCF messaging format and reimplementing it in C++.</p>\n"}, {"comments": [{"owner": {"reputation": 2967, "user_id": 2324576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/993e0f8ecc3e4d85f2990b6a6fe5b0a1?s=128&d=identicon&r=PG", "display_name": "James Joshua Street", "link": "https://stackoverflow.com/users/2324576/james-joshua-street"}, "edited": false, "score": 0, "creation_date": 1424909405, "post_id": 28731456, "comment_id": 45750309, "body": "are COM objects a windows only thing? they seem to be language independent, so i would assume they are OS independent. Is that the case?"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "reply_to_user": {"reputation": 2967, "user_id": 2324576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/993e0f8ecc3e4d85f2990b6a6fe5b0a1?s=128&d=identicon&r=PG", "display_name": "James Joshua Street", "link": "https://stackoverflow.com/users/2324576/james-joshua-street"}, "edited": false, "score": 0, "creation_date": 1424910117, "post_id": 28731456, "comment_id": 45750512, "body": "Windows only as far as I&#39;m aware.  Yes, COM is a binary protocol and is language-independent but the underlying COM system is essentially Windows-only.  <a href=\"https://www.microsoft.com/com/default.mspx\" rel=\"nofollow noreferrer\">Tell me more</a>"}], "tags": [], "owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "is_accepted": false, "score": -1, "last_activity_date": 1424909070, "last_edit_date": 1495542512, "creation_date": 1424905621, "answer_id": 28731456, "question_id": 28731245, "link": "https://stackoverflow.com/questions/28731245/how-to-raise-events-from-c-code-and-call-handlers-in-c-code-on-another-proces/28731456#28731456", "title": "how to raise events from C++ code and call handlers in C# code on another process?", "body": "<h2>Named pipes</h2>\n\n<p>Going by your question title</p>\n\n<blockquote>\n  <p>how to raise events from C++ code and <strong>call handlers in C# code on another process</strong>?</p>\n</blockquote>\n\n<p>...so I'm assuming you're wanting a subscription model of sorts that when the event is fired automatically calls your handlers.</p>\n\n<p>Your first body:</p>\n\n<blockquote>\n  <p>I have been trying to do some reading on how to communicate best, and it appears that the way to communicate between non-related processes running code in different languages is usually through the use of \"named pipes.\"</p>\n</blockquote>\n\n<p>...well it can be done over a named pipe transport but you'll need to convert raw incoming data and pass that through a routing mechanism to actually fire the events.  Named pipes is just a low-level IPC sending raw data. It's not a subscription model.  <strong>It won't call into and invoke handlers in your code</strong> in the same way as shared memory won't.  So if you are looking to subscribe to something in c++ over raw named pipes and have it call into your c# handler it requires more work on your part compared to COM (below).</p>\n\n<blockquote>\n  <p>However, in C++, should i just directly create a named pipe or is there some framework/library that I should use to create named pipes?</p>\n</blockquote>\n\n<p>In c++ it's relatively easy to create a named pipe yourself.  In C# you can use <a href=\"https://msdn.microsoft.com/en-us/library/system.io.pipes.namedpipeclientstream(v=vs.110).aspx\" rel=\"nofollow noreferrer\">NamedPipeClientStream</a></p>\n\n<h2>COM</h2>\n\n<blockquote>\n  <p>Also, what alternative options do I have to create events in C++ that a C# application can hear?</p>\n</blockquote>\n\n<p>Again, keeping to your subscription and \"call handler\" needs I would recommend COM over other IPC technologies.</p>\n\n<p>In c++ you can create a COM object that will fire <code>COM events</code> that can be received in the same/another process.  </p>\n\n<p>MSDN defines COM as:</p>\n\n<blockquote>\n  <p>The Microsoft Component Object Model (COM) is a platform-independent, distributed, object-oriented system for creating binary software components that can interact.</p>\n</blockquote>\n\n<p>In c# you can subscribe to these events and be notified when they occur.</p>\n\n<p>It is generally more efficient to use named pipes or COM for local machine IPC than WCF due to the overhead imposed by the latter - particularly the way data is encoded.</p>\n\n<h2>Tell me more</h2>\n\n<p>For more comparisons of IPC <a href=\"https://stackoverflow.com/questions/28335037/object-sharing-between-applications\">see my answer to this SO question here</a></p>\n"}], "owner": {"reputation": 2967, "user_id": 2324576, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/993e0f8ecc3e4d85f2990b6a6fe5b0a1?s=128&d=identicon&r=PG", "display_name": "James Joshua Street", "link": "https://stackoverflow.com/users/2324576/james-joshua-street"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 465, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424909070, "creation_date": 1424904839, "question_id": 28731245, "link": "https://stackoverflow.com/questions/28731245/how-to-raise-events-from-c-code-and-call-handlers-in-c-code-on-another-proces", "title": "how to raise events from C++ code and call handlers in C# code on another process?", "body": "<p>I have been trying to do some reading on how to communicate best, and it appears that the way to communicate between non-related processes running code in different languages is usually through the use of \"named pipes.\"</p>\n\n<p>it seems like in C# you would normally use WCF while setting some bindings to make use of named pipes.  However, in C++, should i just directly create a named pipe or is there some framework/library that I should use to create named pipes?</p>\n\n<p>Also, what alternative options do I have to create events in C++ that a C# application can hear?</p>\n"}, {"tags": ["c#", "sql", "sql-server"], "comments": [{"owner": {"reputation": 1836, "user_id": 3410918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GZfU9.png?s=128&g=1", "display_name": "SoulTrain", "link": "https://stackoverflow.com/users/3410918/soultrain"}, "edited": false, "score": 0, "creation_date": 1424904742, "post_id": 28731163, "comment_id": 45748622, "body": "Looks like you are spawning multiple connections and are not closing them and eventually exceeding your pool size. Put a Using statement around you connection code piece or have a finally to close the connections..try this <a href=\"http://stackoverflow.com/questions/4717789/in-a-using-block-is-a-sqlconnection-closed-on-return-or-exception\" title=\"in a using block is a sqlconnection closed on return or exception\">stackoverflow.com/questions/4717789/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1583, "user_id": 567269, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/3vkNn.jpg?s=128&g=1", "display_name": "Phoenix", "link": "https://stackoverflow.com/users/567269/phoenix"}, "is_accepted": false, "score": 0, "last_activity_date": 1424904831, "last_edit_date": 1495542512, "creation_date": 1424904831, "answer_id": 28731241, "question_id": 28731163, "link": "https://stackoverflow.com/questions/28731163/sql-server-error-while-pulling-hundreds-of-records/28731241#28731241", "title": "SQL Server Error while pulling hundreds of records", "body": "<p>You're getting that error because a connection cannot be established, not <strong>only</strong> because they aren't being closed properly. Check permissions for the user you're trying to authenticate against the database with. Also be sure to call <code>.open()</code>/<code>.close()</code> when/if you are programatically opening/closing connections.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15848239/how-to-solve-max-connection-pool-error\">Check this link</a>. You may want to increase your pool size, or check for long-running queries.</p>\n"}], "owner": {"reputation": 2228, "user_id": 2522162, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/645e349de791bc124bdb4d6fd921b3d7?s=128&d=identicon&r=PG", "display_name": "Alma", "link": "https://stackoverflow.com/users/2522162/alma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424904831, "creation_date": 1424904474, "question_id": 28731163, "link": "https://stackoverflow.com/questions/28731163/sql-server-error-while-pulling-hundreds-of-records", "title": "SQL Server Error while pulling hundreds of records", "body": "<p>I am getting this error when I try to get all the username password from production copied local database, I guess it is because of not closing the connection properly, but I am not sure how . I am using the Microsoft Enterprise Library, ant thought or comment about it?</p>\n\n<pre><code> Timeout expired.  The timeout period elapsed prior to \n obtaining a connection    from the pool.  This may have occurred\n because all pooled    connections were in use and max pool size was reached.\n</code></pre>\n\n<p>this is the mothod that is getting the username and password and producing the error.</p>\n\n<pre><code>private Model.UsernameandPass GetUsernamePass(string AccountNumber)\n    {\n        Model.UsernameandPass model = null;\n\n        string myConnection = System.Configuration.ConfigurationManager.ConnectionStrings[connectionName].ToString();\n        SqlDatabase db = new SqlDatabase(myConnection);\n\n        using (DbCommand command = db.GetStoredProcCommand(\"Get_TheUsernamePassWordFromProduction\"))\n        {\n            db.AddInParameter(command, \"AccountNumber\", DbType.String, AccountNumber);\n            var result = db.ExecuteReader(command);\n\n            try\n            {\n\n\n                while (result.Read())\n                {\n\n                    model = new Model.UsernameandPass();\n\n                    model.Username = result.GetString(1);\n                    model.Password = result.GetString(2);\n                }\n\n            }\n\n            catch (Exception ex)\n            {\n\n\n            }\n\n\n        }\n        db = null;\n        return model;\n    }\n</code></pre>\n\n<p>I am getting the error in this line after program runs for a while.</p>\n\n<pre><code> var result = db.ExecuteReader(command);\n</code></pre>\n"}, {"tags": ["c#", "visual-c++", "stl", "c++-cli", "snowcrash"], "comments": [{"owner": {"reputation": 3350, "user_id": 217239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7a5cd5e29666bd220d57aa1ea50c3cd?s=128&d=identicon&r=PG&f=1", "display_name": "WorkSmarter", "link": "https://stackoverflow.com/users/217239/worksmarter"}, "edited": false, "score": 0, "creation_date": 1424905363, "post_id": 28731148, "comment_id": 45748871, "body": "Did you try setting the 32bit parameter on the application pool to true?"}, {"owner": {"reputation": 3384, "user_id": 225022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/adLN3.jpg?s=128&g=1", "display_name": "Bishoy", "link": "https://stackoverflow.com/users/225022/bishoy"}, "reply_to_user": {"reputation": 3350, "user_id": 217239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7a5cd5e29666bd220d57aa1ea50c3cd?s=128&d=identicon&r=PG&f=1", "display_name": "WorkSmarter", "link": "https://stackoverflow.com/users/217239/worksmarter"}, "edited": false, "score": 0, "creation_date": 1424906722, "post_id": 28731148, "comment_id": 45749443, "body": "I did try that (enable 32 bit) and did not help under IIS 8.0, but that made it work under IIS 7.x though."}, {"owner": {"reputation": 19232, "user_id": 73025, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/96c00320ab4ac01d8dbef2688cc7edb9?s=128&d=identicon&r=PG", "display_name": "Dennis", "link": "https://stackoverflow.com/users/73025/dennis"}, "edited": false, "score": 0, "creation_date": 1424913540, "post_id": 28731148, "comment_id": 45751489, "body": "Do you have to host under IIS 8.0? What about a self-hosted API using OWIN? You can create the service using TopShelf and this package: <a href=\"https://github.com/dennisroche/Topshelf.Owin/\" rel=\"nofollow noreferrer\">github.com/dennisroche/Topshelf.Owin</a>"}, {"owner": {"reputation": 3384, "user_id": 225022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/adLN3.jpg?s=128&g=1", "display_name": "Bishoy", "link": "https://stackoverflow.com/users/225022/bishoy"}, "edited": false, "score": 0, "creation_date": 1424913755, "post_id": 28731148, "comment_id": 45751540, "body": "The plan is to allow this to run as an ASP.net module and be part of the same website, so IIS is by choice here. I was not trying to create a stand-alone tool."}, {"owner": {"reputation": 25655, "user_id": 480937, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/448470e105833cd4179b24314714360e?s=128&d=identicon&r=PG", "display_name": "David Yaw", "link": "https://stackoverflow.com/users/480937/david-yaw"}, "edited": false, "score": 2, "creation_date": 1424982964, "post_id": 28731148, "comment_id": 45786487, "body": "Are you deploying the Debug build, or the Release build? They use different runtimes, and the debug runtime is not available as a redistributable."}, {"owner": {"reputation": 3384, "user_id": 225022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/adLN3.jpg?s=128&g=1", "display_name": "Bishoy", "link": "https://stackoverflow.com/users/225022/bishoy"}, "edited": false, "score": 0, "creation_date": 1424985547, "post_id": 28731148, "comment_id": 45787778, "body": "I will check if debug or release, but how can I tell? Because my c++ dll comes in a nugget package and I don&#39;t know how it&#39;s built."}, {"owner": {"reputation": 25655, "user_id": 480937, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/448470e105833cd4179b24314714360e?s=128&d=identicon&r=PG", "display_name": "David Yaw", "link": "https://stackoverflow.com/users/480937/david-yaw"}, "edited": false, "score": 0, "creation_date": 1424990015, "post_id": 28731148, "comment_id": 45789837, "body": "Ah, I misunderstood, I thought the C++ DLL was yours, not NuGet. Regardless, release compiles will be linked against &quot;MSVCR&lt;version&gt;.DLL&quot;, debug will be linked against &quot;MSVCR&lt;version&gt;D.DLL&quot; (the trailing &#39;D&#39; stands for &#39;Debug&#39;). Download the dependency walker from <a href=\"http://www.dependencywalker.com/\" rel=\"nofollow noreferrer\">dependencywalker.com</a> to see what it links against."}], "answers": [{"tags": [], "owner": {"reputation": 3384, "user_id": 225022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/adLN3.jpg?s=128&g=1", "display_name": "Bishoy", "link": "https://stackoverflow.com/users/225022/bishoy"}, "is_accepted": true, "score": 2, "last_activity_date": 1425004436, "creation_date": 1425004436, "answer_id": 28756564, "question_id": 28731148, "link": "https://stackoverflow.com/questions/28731148/cannot-use-a-c-cli-dll-unless-visual-studio-is-installed/28756564#28756564", "title": "Cannot use a C++/CLI DLL unless visual studio is installed", "body": "<p>By doing lots of digging on the inter-webs I found that there was a missing dependency that the SnowCrash DLL needs in order to run, which was Visual C++ runtime 2012 x86.</p>\n\n<p>since its a mixed (managed CLR + Native) DLL, it needs the C++ MFC library, that comes with the VC++ runtime. and it must be the right version in order to run properly.</p>\n\n<p>Installing the runtime from <a href=\"http://www.microsoft.com/en-au/download/details.aspx?id=30679\" rel=\"nofollow\">this MSDN URL</a> onto the target computer solved my problem.</p>\n"}], "owner": {"reputation": 3384, "user_id": 225022, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/adLN3.jpg?s=128&g=1", "display_name": "Bishoy", "link": "https://stackoverflow.com/users/225022/bishoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 2, "accepted_answer_id": 28756564, "answer_count": 1, "score": 8, "last_activity_date": 1425004436, "creation_date": 1424904434, "last_edit_date": 1424932903, "question_id": 28731148, "link": "https://stackoverflow.com/questions/28731148/cannot-use-a-c-cli-dll-unless-visual-studio-is-installed", "title": "Cannot use a C++/CLI DLL unless visual studio is installed", "body": "<h2>Intro</h2>\n\n<p>I'm Developing a tool that can interpret and use API Blueprints.</p>\n\n<p>I created a new console app, added <a href=\"https://github.com/brutski/snowcrash-dot-net-wrapper\" rel=\"noreferrer\">SnowCrash.NET nuget package</a> and wrote this code:</p>\n\n\n\n<pre><code>    static void Main(string[] args)\n    {\n        snowcrashCLR.Blueprint blueprint;\n        snowcrashCLR.Result result;\n\n        var path = args.Length &gt; 1 ? args[1] : @\"c:\\\";\n\n        snowcrashCLR.SnowCrashCLR.parse(path, out blueprint, out result);\n        if (result != null)\n        {\n            var warnings = result.GetWarningsCs();\n            foreach (var warning in warnings)\n            {\n                Console.WriteLine(\"{0}: {1}\", warning.code, warning.message);\n            }\n        }\n    }\n</code></pre>\n\n\n\n<h2>Problem</h2>\n\n<p>When I deployed my code (copied the bin folder) to a different computer than my development environment, I get a FileNotFoundException pointing to SnowCrash.dll</p>\n\n<p>here is a snapshop from the error message:</p>\n\n<blockquote>\n  <p>Could not load file or assembly 'snowcrashCLR.DLL' or one of its dependencies. The specified module could not be found.</p>\n</blockquote>\n\n<h2>Details:</h2>\n\n\n\n<pre><code>[FileNotFoundException: Could not load file or assembly 'snowcrashCLR.DLL' or one of its dependencies. The specified module could not be found.]\n   System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&amp; stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0\n   System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&amp; stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +34\n   System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark&amp; stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +152\n   System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, IntPtr pPrivHostBinder, Boolean forIntrospection) +77\n   System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection) +16\n   System.Reflection.Assembly.Load(String assemblyString) +28\n</code></pre>\n\n\n\n<h2>What I've tried so far</h2>\n\n<ul>\n<li>I used sysinternal procmon on both machines to compare and it looks like my dev machine (which runs fine) is loading this DLL:</li>\n</ul>\n\n<blockquote>\n  <p><strong>Load Image</strong>\n  C:\\Windows\\Microsoft.NET\\assembly\\GAC_MSIL\\Microsoft.VisualC.STLCLR\\v4.0_2.0.0.0__b03f5f7f11d50a3a\\Microsoft.VisualC.STLCLR.dll</p>\n</blockquote>\n\n<ul>\n<li>My computer, which the application works fine on, has these runtimes installed</li>\n</ul>\n\n\n\n<pre><code>MS Visual C++ 2005 Redist (x64)\nMS Visual C++ 2008 Redist (x64) 9.0.30729.4148\nMS Visual C++ 2008 Redist (x64) 9.0.30729.6161\nMS Visual C++ 2008 Redist (x86) 9.0.30729.4148\nMS Visual C++ 2008 Redist (x86) 9.0.30729.6161\nMS Visual C++ 2010 x64 Redist - 10.0.40219\nMS Visual C++ 2013 x64 Redist - 12.0.30501\nMS Visual C++ 2013 x86 Redist - 12.0.30501\n</code></pre>\n\n\n\n<ul>\n<li><p>On the computer that had the error (did not work), I installed the same identical list of runtimes above, but that did not solve the problem or made it work.</p></li>\n<li><p>I installed visual studio on that computer, that did not work previously, and when I tried my application and it worked</p></li>\n</ul>\n\n<h2>Your help is greatly appreciated if you have better knowledge or battle scars with a similar issue.</h2>\n"}, {"tags": ["c#", "wpf", "user-controls", "multibinding", "imultivalueconverter"], "comments": [{"owner": {"reputation": 13507, "user_id": 2846483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/X2Bfs.jpg?s=128&g=1", "display_name": "dymanoid", "link": "https://stackoverflow.com/users/2846483/dymanoid"}, "edited": false, "score": 0, "creation_date": 1424940926, "post_id": 28731132, "comment_id": 45759925, "body": "That&#39;s just a warning in the debug window of Visual Studio. It doesn&#39;t affect anything, it&#39;s just an information for you. The binding will not be set in that case. What&#39;s the point in removing this warning message?"}, {"owner": {"reputation": 1030, "user_id": 2410892, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/depsm.jpg?s=128&g=1", "display_name": "Karl Stephen", "link": "https://stackoverflow.com/users/2410892/karl-stephen"}, "reply_to_user": {"reputation": 13507, "user_id": 2846483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/X2Bfs.jpg?s=128&g=1", "display_name": "dymanoid", "link": "https://stackoverflow.com/users/2846483/dymanoid"}, "edited": false, "score": 0, "creation_date": 1424942752, "post_id": 28731132, "comment_id": 45761015, "body": "Ah!? Are you sure I can leave that warning there and go on ? I assumed <i>&quot;warning = something wrong in your code ..!&quot;</i> that&#39;s why I&#39;m looking for the steps to fix this exact specific warning. Yeah, the Binding is not set, that&#39;s why I have DependencyProperty.UnsetValue in the converter, but looks hacky to me. I just hoped something I missed could be done in the xaml MultiBinding. But if it&#39;s the way to go.."}, {"owner": {"reputation": 13507, "user_id": 2846483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/X2Bfs.jpg?s=128&g=1", "display_name": "dymanoid", "link": "https://stackoverflow.com/users/2846483/dymanoid"}, "edited": false, "score": 0, "creation_date": 1424943386, "post_id": 28731132, "comment_id": 45761387, "body": "A data binding warning is just a diagnostic message. So, if you know that a missing binding source is okay, then just ignore the warning. It might help you to find out data binding problems, e. g. if you <b>have to</b> resolve all the bindings."}, {"owner": {"reputation": 1030, "user_id": 2410892, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/depsm.jpg?s=128&g=1", "display_name": "Karl Stephen", "link": "https://stackoverflow.com/users/2410892/karl-stephen"}, "reply_to_user": {"reputation": 13507, "user_id": 2846483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/X2Bfs.jpg?s=128&g=1", "display_name": "dymanoid", "link": "https://stackoverflow.com/users/2846483/dymanoid"}, "edited": false, "score": 0, "creation_date": 1424944715, "post_id": 28731132, "comment_id": 45762215, "body": "okay :) Thanks. The ScalingOverride Binding is only required for displaying purposes within the ancestor scope; I actually don&#39;t have to resolve this Binding if the ancestor is not there. I&#39;ll probably use the &quot;wpf inheritable property&quot; at a later time as a workaround (sorry, I&#39;m stubborn I know, but those warnings somewhat bugs me :P )"}], "owner": {"reputation": 1030, "user_id": 2410892, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/depsm.jpg?s=128&g=1", "display_name": "Karl Stephen", "link": "https://stackoverflow.com/users/2410892/karl-stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424904380, "creation_date": 1424904380, "last_edit_date": 1592644375, "question_id": 28731132, "link": "https://stackoverflow.com/questions/28731132/multibinding-seeking-for-a-missing-ancestor-source-error-simple-tip", "title": "Multibinding seeking for a missing ancestor source error : simple tip?", "body": "<p>Let's say I have an UserControl like this :</p>\n<pre><code>&lt;UserControl \n    x:Class=&quot;SandBox.IconUC&quot; \n    xmlns:sb=&quot;clr-namespace:SandBox&quot; \n    x:Name=&quot;Icon_Control&quot; ...&gt;\n\n    &lt;UserControl.Resources&gt;\n        &lt;sb:IconActualScalingConverter x:Key=&quot;IconActualScaling_Converter&quot; /&gt;\n    &lt;/UserControl.Resources&gt;\n\n    &lt;!-- ... --&gt;\n        &lt;ScaleTransform.ScaleX&gt;\n            &lt;MultiBinding Converter=&quot;{StaticResource IconActualScaling_Converter}&quot;&gt;\n                &lt;Binding Path=&quot;BaseSize&quot; ElementName=&quot;Icon_Control&quot; /&gt;\n                &lt;Binding \n                    Path=&quot;ScalingOverride&quot; \n                    RelativeSource=&quot;{RelativeSource AncestorType=sb:ContainerUC}&quot; /&gt;\n            &lt;/MultiBinding&gt;\n        &lt;/ScaleTransform.ScaleX&gt;\n    &lt;!-- ... --&gt;\n&lt;/UserControl&gt;\n</code></pre>\n<p>Obviously, I want to scale its <strong>content</strong> based on a dependency property of its own called <strong><code>BaseSize</code></strong>, <strong>and a dependency property of a container UserControl somewhere in the path through this IconUC ancestors of type <code>ContainerUC</code></strong>.</p>\n<p>This works very well when I set the IconUC as a decendant of one ContainerUC.</p>\n<p>Unfortunately, when I put the Icon in another control, like a StackPanel, that has NO ContainerUC as ancestor, <strong>I get the following warning</strong> :</p>\n<blockquote>\n<p>System.Windows.Data Warning: 4 :<br />\n<strong>Cannot find source for binding</strong> with reference<br />\n'RelativeSource FindAncestor, AncestorType='<strong>SandBox.ContainerUC</strong>', AncestorLevel='1''.<br />\nBindingExpression:Path=<strong>ScalingOverride</strong>; DataItem=null;<br />\ntarget element is 'ScaleTransform' (HashCode=51921052);<br />\ntarget property is 'ScaleX' (type 'Double')</p>\n</blockquote>\n<p>And that's normal.</p>\n<h2>How to simply prevent that warning, like ignoring the Binding if resolving the path to the source failed ?</h2>\n<p>What I would like <strong>is NOT a workaround</strong> :</p>\n<ol>\n<li>Using DependencyProperty.RegisterAttached on ContainerUC, and getting a default Metadata value in IconUC if no Ancestor was found. I know this is a good workaround.</li>\n<li>Using (heavy) code behind to retrieve the desired Ancestor, or using a default value instead. This also works, and I don't even need a Converter for that.</li>\n<li>Putting the StackPanel inside a ContainerUC. The StackPanel is there to test the Icons Sizes. Anyway, the Icons are in fact much more complex objects that would land in multiple type of containers, not just this ContainerUC.</li>\n</ol>\n<p>What I would like <strong>is just to learn whether it exists one way</strong> to avoid errors even if the desired ancestor is missing in MultiBindings.</p>\n<p>Tried <strong><code>FallbackValue=&quot;1.0&quot;</code></strong> in Binding. Still getting the warning.<br />\nTried <strong><code>TargetNullValue=&quot;1.0&quot;</code></strong>. Still getting the warning.<br />\nTried <strong><code>UpdateSourceExceptionFilter=&quot;SomeMethod&quot;</code></strong>. Still getting the warning.<br />\nTried <strong><code>NotifyOnValidationError=&quot;False&quot;</code></strong>. Still getting the warning.</p>\n<p>If the answer is <em><strong>No, your IconUC UserControl is doomed to be a descendant of ContainerUC</strong></em> in this case, then I'll be fine with that. :)</p>\n<hr />\n<p>This is the simplified version of the converter. But I highly doubt the answer (if any) would land here : the warning is thrown well before the Converter handles the datas.</p>\n<pre><code>public class IconActualScalingConverter : IMultiValueConverter\n{\n    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n    {\n        double definedScaling = (double)values[0];\n        double scalingFactor = 1.0;\n\n        if (values.Length &gt; 1)\n        {\n            if (values[1] != DependencyProperty.UnsetValue)\n            {\n                scalingFactor = (double)values[1];\n            }\n        }\n        return definedScaling * scalingFactor;\n    }\n    \n    public object[] ConvertBack(...)\n    {\n        throw new NotImplementedException();\n    }\n}\n</code></pre>\n<p>Thanks.</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 1, "creation_date": 1424904687, "post_id": 28731126, "comment_id": 45748589, "body": "You are returning the view before you sort."}, {"owner": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "reply_to_user": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 0, "creation_date": 1424908283, "post_id": 28731126, "comment_id": 45749963, "body": "I did try to sort before I return the view but without any result. When I look closer at the debugging it looks like I am missing my search string when I try to sort. I tried with <code>text = text.OrderBy(s =&gt; s.Price).Where(x =&gt; x.Name.Contains(search);</code> but with no luck."}], "answers": [{"comments": [{"owner": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425507241, "post_id": 28732289, "comment_id": 45997100, "body": "I have now edited the code so I should only return the view at the end. But it still doesnt solve my problem. It still shows all nodes after a search."}, {"owner": {"reputation": 2748, "user_id": 4270311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b58c7c818a816d2cf5cf9c78fa987cb4?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/4270311/tim"}, "reply_to_user": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425509358, "post_id": 28732289, "comment_id": 45998063, "body": "Maybe I am being dumb, but I don&#39;t see you passing back the sort param to the controller for any of your controller calls. Do you have anything in the search string in the controller when searching?"}, {"owner": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425509869, "post_id": 28732289, "comment_id": 45998280, "body": "I am pretty new at MVC and C# so I might be asking the wrong questions here. After searching my searchstring in the URL looks like this: <code>?searchBy=Tekst&amp;search=car</code>. If I search &quot;car&quot; and if I debug at shows &quot;car&quot; in the search string."}, {"owner": {"reputation": 2748, "user_id": 4270311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b58c7c818a816d2cf5cf9c78fa987cb4?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/4270311/tim"}, "reply_to_user": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425510326, "post_id": 28732289, "comment_id": 45998460, "body": "OK, if it is making it to your controller then you are fine. I must have been being blind. So after the search your text list is still 10 elements?"}, {"owner": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425510803, "post_id": 28732289, "comment_id": 45998623, "body": "The search works fine. I have 3 nodes with &quot;car&quot; in the name. If I search &quot;car&quot; I get 3 results. If I then afterwards (while having the 3 results showing) presses one of the link to for example sort by price - it sorts - but it shows all the 10 notes again and not only the 3 I just narroved it down to with my search."}, {"owner": {"reputation": 2748, "user_id": 4270311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b58c7c818a816d2cf5cf9c78fa987cb4?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/4270311/tim"}, "reply_to_user": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425511092, "post_id": 28732289, "comment_id": 45998735, "body": "Ah. Now it all makes sense. The issue is that on the sort you are having to re-hit the data so you are no longer filtering to the search. Make your action links pass in the search and search by params like you are doing for the sort"}, {"owner": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425511976, "post_id": 28732289, "comment_id": 45999026, "body": "Hmm. Alright. I can see where you are going at but I am not sure how to do it. I have tried to include the entire switch within the <code>if (searchBy == &quot;Tekst&quot;)</code> and <code>else</code> but with no luck. I am sorry if I am being a bit slow here. If it is not too much trouble could I you please show a short example?"}, {"owner": {"reputation": 2748, "user_id": 4270311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b58c7c818a816d2cf5cf9c78fa987cb4?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/4270311/tim"}, "reply_to_user": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 1, "creation_date": 1425518562, "post_id": 28732289, "comment_id": 46001068, "body": "In your various sorting action links you pass in the sortOrder, but not the current search. Try passing in the search there so that you have it the second time. @Html.ActionLink(&quot;Kostpris pr m2 bygning&quot;, &quot;Index&quot;, new { sortOrder = ViewBag.PricePerCubicSortParm })"}, {"owner": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "edited": false, "score": 0, "creation_date": 1425540805, "post_id": 28732289, "comment_id": 46007489, "body": "Thank you Jim. Now I know what you mean. I just needs to figure out how to pass the searchstring in the actionlink. I will take a look at it. Thanks!"}], "tags": [], "owner": {"reputation": 2748, "user_id": 4270311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b58c7c818a816d2cf5cf9c78fa987cb4?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/4270311/tim"}, "is_accepted": false, "score": 2, "last_activity_date": 1424914652, "last_edit_date": 1424914652, "creation_date": 1424909869, "answer_id": 28732289, "question_id": 28731126, "link": "https://stackoverflow.com/questions/28731126/sorting-after-search-is-performed/28732289#28732289", "title": "Sorting after search is performed", "body": "<p>Comment above has it.</p>\n\n<p>Don't return the view until the very end of your function. Create the collection and save it to a local variable.</p>\n\n<p>Then on that local variable call your order by clause.</p>\n\n<p>Pseudo-code:</p>\n\n<pre><code>var results = search();\n\n\nIf (orderBy)\n{\n    Results = results.orderBy(X);\n}\n\nreturn view(Results);\n</code></pre>\n"}], "owner": {"reputation": 957, "user_id": 4013033, "user_type": "registered", "accept_rate": 66, "profile_image": "https://lh3.googleusercontent.com/-zEKF8g6QCq4/AAAAAAAAAAI/AAAAAAAAADc/Z8HLJ_QNYFk/photo.jpg?sz=128", "display_name": "Casper Nybroe", "link": "https://stackoverflow.com/users/4013033/casper-nybroe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472440178, "creation_date": 1424904352, "last_edit_date": 1472440178, "question_id": 28731126, "link": "https://stackoverflow.com/questions/28731126/sorting-after-search-is-performed", "title": "Sorting after search is performed", "body": "<p>I have a MVC where I am able to search the database for different values. I am also able to sort the list in both ascending and descending order of for example prise and alphabet.\nBut lets say that I have a total of 10 rows in the database. I then make a search which gives two results. If I then try to sort those two it reloads all the 10 rows again.</p>\n\n<p>How am I able to make a sorting after a search without it reloading the entire list?</p>\n\n<p><strong>My controller:</strong></p>\n\n<pre><code>public ActionResult Index(string searchBy, string search, string sortOrder)\n{\n\n    ViewBag.NameSortParm = String.IsNullOrEmpty(sortOrder) ? \"name_desc\" : \"\";\n    ViewBag.TextSortParm = String.IsNullOrEmpty(sortOrder) ? \"text_desc\" : \"\";\n    ViewBag.PriceSortParm = sortOrder == \"Price\" ? \"price_desc\" : \"Price\";\n    ViewBag.CubicMeterSortParm = sortOrder == \"CubicMeter\" ? \"cubicMeter_desc\" : \"CubicMeter\";\n    ViewBag.PricePerCubicSortParm = sortOrder == \"PricePerCubic\" ? \"pricePerCubic_desc\" : \"PricePerCubic\";\n\n    var text = from s in db.LearningNumbers select s;\n\n    switch (sortOrder)\n    {\n        case \"name_desc\":\n            text = text.OrderByDescending(s =&gt; s.Name);\n            break;\n        case \"text_desc\":\n            text = text.OrderByDescending(s =&gt; s.Note);\n            break;\n        case \"Price\":\n            text = text.OrderBy(s =&gt; s.Price);\n            break;\n        case \"price_desc\":\n            text = text.OrderByDescending(s =&gt; s.Price);\n            break;\n        case \"CubicMeter\":\n            text = text.OrderBy(s =&gt; s.CubicMeter);\n            break;\n        case \"cubicMeter_desc\":\n            text = text.OrderByDescending(s =&gt; s.CubicMeter);\n            break;\n        case \"PricePerCubic\":\n            text = text.OrderBy(s =&gt; s.PricePerCubic);\n            break;\n        case \"pricePerCubic_desc\":\n            text = text.OrderByDescending(s =&gt; s.PricePerCubic);\n            break;\n    }\n\n    if (!String.IsNullOrEmpty(search))\n    {\n        if (searchBy == \"Tekst\")\n        {\n            text = text.Where(x =&gt; x.Note.Contains(search) || search == null);\n        }\n        else\n        {\n            text = text.Where(x =&gt; x.Name.Contains(search) || search == null); \n        }\n    }\n\n    return View(text.ToList());\n}\n</code></pre>\n\n<p><strong>My view:</strong></p>\n\n<pre><code>@using (Html.BeginForm(\"Index\", \"Home\", FormMethod.Get))\n{\n    @Html.RadioButton(\"searchBy\", \"Navn\", true) &lt;text&gt;Navn&lt;/text&gt;\n    @Html.RadioButton(\"searchBy\", \"Tekst\") &lt;text&gt;Tekst&lt;/text&gt;&lt;br /&gt;\n    @Html.TextBox(\"search\")&lt;input class=\"btn btn-primary\" style=\"margin:0 10px;\" type=\"submit\" value=\"S\u00f8g\" /&gt;\n}\n\n&lt;div class=\"col-md-12 table\" style=\"display:table; margin:45px 0 25px 0;\"&gt;\n    &lt;div class=\"col-md-2\"&gt;\n        @*&lt;b&gt;Tekst&lt;/b&gt;&lt;br /&gt;*@\n        &lt;h4&gt;@Html.ActionLink(\"Navn\", \"Index\", new { sortOrder = ViewBag.NameSortParm })&lt;/h4&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-md-2\"&gt;\n        @*&lt;b&gt;Tekst&lt;/b&gt;&lt;br /&gt;*@\n        &lt;h4&gt;\n            @Html.ActionLink(\"Tekst\", \"Index\", new { sortOrder = ViewBag.TextSortParm })\n        &lt;/h4&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-md-2\"&gt;\n        @*&lt;b&gt;Kostpris med till\u00e6g&lt;/b&gt;&lt;br /&gt;*@\n        &lt;h4&gt;\n            @Html.ActionLink(\"Kostpris med till\u00e6g\", \"Index\", new { sortOrder = ViewBag.PriceSortParm })\n        &lt;/h4&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-md-2\"&gt;\n        @*&lt;b&gt;Brutto m2&lt;/b&gt;&lt;br /&gt;*@\n        &lt;h4&gt;\n            @Html.ActionLink(\"Brutto m2\", \"Index\", new { sortOrder = ViewBag.CubicMeterSortParm })\n        &lt;/h4&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-md-2\"&gt;\n        @*&lt;b&gt;Kostpris pr m2 bygning&lt;/b&gt;&lt;br /&gt;*@\n        &lt;h4&gt;\n            @Html.ActionLink(\"Kostpris pr m2 bygning\", \"Index\", new { sortOrder = ViewBag.PricePerCubicSortParm })\n        &lt;/h4&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n@if (Model.Count() == 0)\n{\n    &lt;h3&gt;Beklager! Vi fandt desv\u00e6rre ingen resultater med dine s\u00f8gekriterier.&lt;/h3&gt;\n    &lt;p&gt;Pr\u00f8v venligst igen.&lt;/p&gt;\n}\nelse\n{\n    foreach (var item in Model)\n    {\n\n        &lt;div class=\"col-md-12 table\" style=\"display: table; margin: 0 0 0 0; \"&gt;\n            &lt;div class=\"col-md-2\"&gt;\n                &lt;p&gt;&lt;b&gt;@Html.DisplayFor(modelItem =&gt; item.Name)&lt;/b&gt;&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-md-2\"&gt;\n                &lt;p&gt;@Html.DisplayFor(modelItem =&gt; item.Note)&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-md-2\"&gt;\n                &lt;p&gt;@Html.DisplayFor(modelItem =&gt; item.Price)&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-md-2\"&gt;\n                &lt;p&gt;@Html.DisplayFor(modelItem =&gt; item.CubicMeter)&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div class=\"col-md-2\"&gt;\n                &lt;p&gt;@Html.DisplayFor(modelItem =&gt; item.PricePerCubic)&lt;/p&gt;\n            &lt;/div&gt;\n\n        &lt;/div&gt;\n        &lt;hr /&gt;\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "generics", "reflection", "type-equivalence"], "comments": [{"owner": {"reputation": 25180, "user_id": 668272, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e4b4df6df17383aa6721c783a5a87335?s=128&d=identicon&r=PG", "display_name": "Bas", "link": "https://stackoverflow.com/users/668272/bas"}, "edited": false, "score": 0, "creation_date": 1424905265, "post_id": 28731094, "comment_id": 45748837, "body": "It is logical that this fails, never in your code you are binding type parameter T to a type argument using <code>MakeGenericMethod</code>"}, {"owner": {"reputation": 117905, "user_id": 1163867, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fe5ef74a2c17f19c75d2f49b95fb71d?s=128&d=identicon&r=PG", "display_name": "MarcinJuraszek", "link": "https://stackoverflow.com/users/1163867/marcinjuraszek"}, "edited": false, "score": 0, "creation_date": 1424905304, "post_id": 28731094, "comment_id": 45748851, "body": "There is no type you could bind using <code>MakeGenericMethod</code> as it&#39;s still <code>List&lt;T&gt;</code> with unknown <code>T</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3513472"}, "reply_to_user": {"reputation": 25180, "user_id": 668272, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e4b4df6df17383aa6721c783a5a87335?s=128&d=identicon&r=PG", "display_name": "Bas", "link": "https://stackoverflow.com/users/668272/bas"}, "edited": false, "score": 0, "creation_date": 1424905481, "post_id": 28731094, "comment_id": 45748923, "body": "@Bas - You cannot bind with an unknown! <code>Edit:</code> @Marcin beat me to it. Yup, that&#39;s the problem."}, {"owner": {"reputation": 25180, "user_id": 668272, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e4b4df6df17383aa6721c783a5a87335?s=128&d=identicon&r=PG", "display_name": "Bas", "link": "https://stackoverflow.com/users/668272/bas"}, "edited": false, "score": 0, "creation_date": 1424905750, "post_id": 28731094, "comment_id": 45749028, "body": "Apologies, I misread. It however cannot work with a <code>List&lt;&gt;</code> as the parameter needs to be <code>List&lt;T&gt;</code>, which is a different type. You cannot use equality comparison to compare your &#39;placeholder&#39; <code>List&lt;&gt;</code> to <code>List&lt;T&gt;</code>. Use the method described in the answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3513472"}, "reply_to_user": {"reputation": 117905, "user_id": 1163867, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fe5ef74a2c17f19c75d2f49b95fb71d?s=128&d=identicon&r=PG", "display_name": "MarcinJuraszek", "link": "https://stackoverflow.com/users/1163867/marcinjuraszek"}, "edited": false, "score": 0, "creation_date": 1424906065, "post_id": 28731094, "comment_id": 45749159, "body": "Got answer, as described by @Marcin, However, this is confusing, as both types seem to show the (almost) same metadata! The image above demonstrates it. A transparent <code>GenericTypeDefinition (List&lt;&gt;)</code> could have solved it cleanly. Anyhow, thanks for the quick resolution. Cheers. :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3513472"}, "edited": false, "score": 0, "creation_date": 1424905728, "post_id": 28731303, "comment_id": 45749019, "body": "Perfect! But quite confusing that <code>GenericTypeDefinition</code> is not a transparent and public type. Wish it was, could be lot more logical that way. Sorry about the unreadable code, I did it intently do set breakpoints in between.  PS: Allow me to cancel the effects of the downvoter with my upvote :)"}], "tags": [], "owner": {"reputation": 117905, "user_id": 1163867, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fe5ef74a2c17f19c75d2f49b95fb71d?s=128&d=identicon&r=PG", "display_name": "MarcinJuraszek", "link": "https://stackoverflow.com/users/1163867/marcinjuraszek"}, "is_accepted": true, "score": 3, "last_activity_date": 1539082271, "last_edit_date": 1539082271, "creation_date": 1424905098, "answer_id": 28731303, "question_id": 28731094, "link": "https://stackoverflow.com/questions/28731094/generics-fun-where-typeoflistt-typeoflistt-and-using-reflection-to/28731303#28731303", "title": "Generics Fun: Where typeof(List&lt;T&gt;) != typeof(List&lt;T&gt;), and using Reflection to get a generic method, with generic parameters", "body": "<p>That's because your type is a <code>GenericTypeDefinition</code> (<code>List&lt;&gt;</code>) and the one taken from reflecting your class is an actual <code>List&lt;T&gt;</code>.</p>\n\n<p>Your code is not readable, so I wrote my own from scratch. The important part is in <code>TypesMatch</code> method.</p>\n\n<pre><code>public static MethodInfo GetRuntimeMethodEx(\n        this Type type, string name, params Type[] types)\n{\n    var withMatchingParamTypes =\n        from m in type.GetRuntimeMethods()\n        where m.Name == name\n        let parameterTypes = m.GetParameters().Select(p =&gt; p.ParameterType).ToArray()\n        where parameterTypes.Length == types.Length\n        let pairs = parameterTypes.Zip(types, (actual, expected) =&gt; new {actual, expected})\n        where pairs.All(x =&gt; TypesMatch(x.actual, x.expected))\n        select m;\n\n    return withMatchingParamTypes.FirstOrDefault();\n}\n\nprivate static bool TypesMatch(Type actual, Type expected)\n{\n    if (actual == expected)\n        return true;\n\n    if (actual.IsGenericType &amp;&amp; expected.IsGenericTypeDefinition)\n        return actual.GetGenericTypeDefinition() == expected;\n\n    return false;\n}\n</code></pre>\n\n<p>Returns your method, as expected.</p>\n\n<p>You can't create a <code>Type</code> instance that represents <code>List&lt;T&gt;</code> with unknown <code>T</code>. That's what <code>GetGenericTypeDefinition</code> and <code>List&lt;&gt;</code> are for.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3513472"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 28731303, "answer_count": 1, "score": 3, "last_activity_date": 1539082271, "creation_date": 1424904229, "last_edit_date": 1424905061, "question_id": 28731094, "link": "https://stackoverflow.com/questions/28731094/generics-fun-where-typeoflistt-typeoflistt-and-using-reflection-to", "title": "Generics Fun: Where typeof(List&lt;T&gt;) != typeof(List&lt;T&gt;), and using Reflection to get a generic method, with generic parameters", "body": "<p>It was just another day with .NET. Until I had to get generic method of a static class with a generic parameter, using reflection for serialization. Doesn't sound so bad. <code>GetRuntimeMethod(\"x\", new[] { type })</code>, as usual should do the trick, or so I thought. </p>\n\n<p>Now, this method keeps returning null for the following variant:\n<code>public static Surrogate&lt;T&gt; BuildSurrogate&lt;T&gt;(List&lt;T&gt; collection)</code>. </p>\n\n<p>So, a quick copy to LinqPad, and a <code>GetRuntimeMethods</code> run later, it seemed to have all the methods as expected. Naturally, I thought perhaps, something wasn't right with the behavior of GetRuntimeMethod, so, I whipped up a quick extension, <code>GetRuntimeMethodEx</code> that iterates through, and to my surprise, it failed. What? How could that fail. GetRuntimeMethods has the exact the methodInfo I need. </p>\n\n<p>So, I ended up breaking up the extension into parts to understand what exactly is going on, as in the code below. And it turns out <code>(cType != cGivenType)</code> always ended up true. </p>\n\n<p>But a quick inspection, shows they were the same 'apparent' type - <code>List&lt;T&gt;</code>. Now being utterly confused, a diff on the dump of the two <code>typeof(List&lt;T&gt;)</code>, and it turns out they were not the same! </p>\n\n<p>The <code>MetadataToken</code> of the two were exactly the same. However the <code>RuntimeTypeHandle</code> were different. The given type had the correct <code>AssemblyQualifiedName</code>, and <code>FullName</code>, belonging to <code>System.Collections.Generic.List``1, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</code>. Great. But oddly enough, the type on the generic method, had both of them as \"<code>null</code>\"!  So, basically, the <code>List&lt;T&gt;</code> is a magical type with no corresponding assembly(!?). <code>It exists, but doesn't</code>. How fascinating!</p>\n\n<p>Here's a quick dump of the diff between the two, that's relevant. </p>\n\n<p><img src=\"https://i.stack.imgur.com/XFpJa.png\" alt=\"Image of the differences\"></p>\n\n<p>Note the <code>GenericTypeParameters</code>, and <code>IsGenericTypeDefinition</code> - They are the ones which seem to make perfect sense. The oddities aside, now how could one create a Type that matches this type on the MethodInfo? Potentially, the compiler expects a generic type of <code>List&lt;&gt;</code> with the generic parameter <code>T</code> - The only problem is, you can't literally make a generic type with <code>T</code>. The <code>T</code> has to be a type of something, which now invalidates the equality. </p>\n\n<pre><code> private void Main()\n    {\n        var type = typeof (List&lt;&gt;);\n        var m = typeof (Builders).GetRuntimeMethods();\n        var surrogateBuilder = typeof (Builders)\n                        .GetRuntimeMethodEx(\"BuildSurrogate\", new[] {type});\n    }\n\n    static class Builders\n    {\n        public static Surrogate&lt;T&gt; BuildSurrogate&lt;T&gt;(List&lt;T&gt; collection)\n        {\n            return new Surrogate&lt;T&gt;\n            {\n                Items = collection.ToArray(),\n            };\n        }\n\n        public class Surrogate&lt;T&gt;\n        {\n            public IEnumerable&lt;T&gt; Items;\n        }\n    }\n\n    public static class ReflectionExtensions\n    {\n        public static MethodInfo GetRuntimeMethodEx(\n                this Type type, string name, params Type[] types)\n        {\n            var m = type.GetRuntimeMethods();\n            var res = (m.Where(t =&gt;\n            {\n                var n = name;\n                return t.Name.Equals(n);\n            }).FirstOrDefault(t =&gt;\n            {\n                var px = t.GetParameters().ToArray();\n                var currentTypes = px.Select(p =&gt; p.ParameterType).ToArray();\n                if (currentTypes.Length &lt; 1) return false;\n                for (var i = 0; i &lt; types.Length; i++)\n                {\n                    var cGivenType = types[i];\n                    for (var j = 0; j &lt; currentTypes.Length; j++)\n                    {\n                        var cType = currentTypes[j];\n                        if (cType != cGivenType) return false;\n                    }\n                }\n                return true;\n            }));\n            return res;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "html", "webbrowser-control"], "comments": [{"owner": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "edited": false, "score": 0, "creation_date": 1425021654, "post_id": 28731087, "comment_id": 45799185, "body": "Check this: <a href=\"http://stackoverflow.com/a/19063643\">stackoverflow.com/a/19063643</a>"}], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 4584064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f750e1298e02c3687c8e490c5a852921?s=128&d=identicon&r=PG&f=1", "display_name": "Uri Netanel", "link": "https://stackoverflow.com/users/4584064/uri-netanel"}, "is_accepted": false, "score": 0, "last_activity_date": 1446451018, "creation_date": 1446451018, "answer_id": 33472988, "question_id": 28731087, "link": "https://stackoverflow.com/questions/28731087/c-webbrowser-htmlelement-invokememberclick-not-working-within-form-tag/33472988#33472988", "title": "C# WebBrowser HTMLElement.InvokeMember(&quot;click&quot;) not working within &lt;form&gt; tag", "body": "<p>Try letting your application pause before invoking the clicks and between them, because the page may still be busy with some earlier processes.\nyou can use a timer control for that effect.</p>\n"}], "owner": {"reputation": 385, "user_id": 1444175, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7ad769027b5957a96ea1335d3ec09a3e?s=128&d=identicon&r=PG&f=1", "display_name": "dodo", "link": "https://stackoverflow.com/users/1444175/dodo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1860, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1566941263, "creation_date": 1424904205, "last_edit_date": 1425021646, "question_id": 28731087, "link": "https://stackoverflow.com/questions/28731087/c-webbrowser-htmlelement-invokememberclick-not-working-within-form-tag", "title": "C# WebBrowser HTMLElement.InvokeMember(&quot;click&quot;) not working within &lt;form&gt; tag", "body": "<p>I'm writing a C# form application which automates some user behaviour by clicking through buttons, links, forms, etc in a WebBrowser. Everything worked fine, im using InvokeMember(\"click\") without problem on several buttons and links, but now i'm stuck with one click.</p>\n\n<p>I'm struggling for days, and i have tried several tips, but nothing worked yet. The HTML code with the form basically looks like the following:</p>\n\n<pre><code>&lt;form name=\"shipsChosen\" id=\"shipsChosen\" method=\"post\" action=\"http://www.example.com/index.php?page=2\"&gt;\n\n&lt;li class=\"off\" id=\"button1\"&gt;\n            &lt;div class=\"buildingimg\"&gt;&lt;a  href=\"javascript:void(0);\"&gt;&lt;/a&gt;&lt;/div&gt;\n            &lt;input id=\"ship_1\"/&gt;\n&lt;/li&gt;\n\n&lt;li class=\"off\" id=\"button2\"&gt;\n            &lt;div class=\"buildingimg\"&gt;&lt;a  href=\"javascript:void(0);\"&gt;&lt;/a&gt;&lt;/div&gt;\n            &lt;input id=\"ship_2\"/&gt;\n&lt;/li&gt;\n\n&lt;li class=\"off\" id=\"button3\"&gt;\n            &lt;div class=\"buildingimg\"&gt;&lt;a  href=\"javascript:void(0);\"&gt;&lt;/a&gt;&lt;/div&gt;\n            &lt;input id=\"ship_3\"/&gt;\n&lt;/li&gt;\n\n&lt;/form&gt;\n\n&lt;a  href=\"javascript:void(0);\" onClick='setMaxIntInput();' id=\"sendall\"&gt;&lt;/a&gt;\n&lt;a id=\"continue\" class=\"off\" href=\"\" onClick=\"trySubmit(); return false;\"&gt;&lt;span&gt;Submit&lt;/span&gt;&lt;/a&gt;\n</code></pre>\n\n<p><strong>What i want, is to click on the link with \"sendall\" ID, and then click on the link with \"continue\" ID.</strong></p>\n\n<p>I have already tried the followings, but none of them worked. Nothing happens:</p>\n\n<pre><code>HtmlElement AllShips = webBrowser1.Document.GetElementById(\"sendall\");\nAllShips.RaiseEvent(\"onclick\");\nAllShips.InvokeMember(\"click\");\n</code></pre>\n\n<p>I have also tried to put some value into the input fields, but it's not works neither:</p>\n\n<pre><code>HtmlElement Input= webBrowser1.Document.GetElementById(\"ship_202\");\nInput.Focus();\nInput.InnerText = \"ship_1\";\n</code></pre>\n\n<p>It's very interesting to me, since althought it's not working when i run this without any user interaction in my C# form application with WebBrowser, <strong>BUT</strong> if i click once by myself in the WebBrowser, and run the click codes above, it works. But it's not automation right..? </p>\n\n<p>Anyone experienced similar problems like this? The only difference i found between the working clicks and in this, is the  in the HTML. </p>\n\n<p><em>More:</em>\nI'm using Internet Explorer 11 FEATURE_BROWSER_EMULATION for the WebBrowser.\nThe page is fully loaded.</p>\n"}, {"tags": ["c#", "generic-collections"], "comments": [{"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424903787, "post_id": 28730971, "comment_id": 45748149, "body": "You seem to be on the right track. This is actually valid C#, assuming the existence of <code>Swizzle</code> and <code>Wibble</code>. What&#39;s your question?"}, {"owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424903955, "post_id": 28730971, "comment_id": 45748225, "body": "@JeroenMostert not valid because there is no such type as List. (non-generic)"}, {"owner": {"reputation": 3564, "user_id": 977472, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/mWgBh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/977472/joe"}, "edited": false, "score": 0, "creation_date": 1424903965, "post_id": 28730971, "comment_id": 45748229, "body": "The example code fails on the expression <code>x is List</code>.  <code>List</code> isn&#39;t really a type you can use, it has to be <code>List&lt;</code>something<code>&gt;</code>."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424904000, "post_id": 28730971, "comment_id": 45748248, "body": "Ah, right, sorry about that. There is a non-generic list type, of course, but it&#39;s <code>ArrayList</code>, and <code>List&lt;T&gt;</code> doesn&#39;t inherit from it (obviously). But <code>List&lt;T&gt;</code> is an <code>IList</code> and an <code>IEnumerable</code>, though."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424904302, "post_id": 28730971, "comment_id": 45748402, "body": "Is this an academic exercise or something that&#39;s supposed to have practical value? Because practically speaking, you&#39;re much better off writing <code>DoSomething&lt;T&gt;(List&lt;T&gt; objects)</code> and then check if <code>objects.Count == 1</code> if you really must do something special for a single value. Or you can simply write two (overloaded) functions: <code>DoSomething&lt;T&gt;(List&lt;T&gt; objects)</code> and <code>DoSomething&lt;T&gt;(T object)</code>."}, {"owner": {"reputation": 3564, "user_id": 977472, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/mWgBh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/977472/joe"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424904398, "post_id": 28730971, "comment_id": 45748449, "body": "@JeroenMostert, let&#39;s treat it as an academic exercise."}], "answers": [{"comments": [{"owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "reply_to_user": {"reputation": 3564, "user_id": 977472, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/mWgBh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/977472/joe"}, "edited": false, "score": 0, "creation_date": 1424904298, "post_id": 28731006, "comment_id": 45748401, "body": "@Joe yes you need to make sure the type is generic before calling that method. I updated the code accordingly"}], "tags": [], "owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "is_accepted": false, "score": 1, "last_activity_date": 1424904272, "last_edit_date": 1424904272, "creation_date": 1424903835, "answer_id": 28731006, "question_id": 28730971, "link": "https://stackoverflow.com/questions/28730971/do-one-thing-with-an-object-do-another-thing-with-a-list-of-objects/28731006#28731006", "title": "Do one thing with an object, do another thing with a list of objects", "body": "<p>You can use <code>Reflection</code> to see if it's <code>List&lt;T&gt;</code></p>\n\n<pre><code>var type = x.GetType();\nif(type.IsGenericType &amp;&amp;\n   type.GetGenericTypeDefinition() == typeof(List&lt;&gt;))\n</code></pre>\n\n<p>Or, if you wanna know if it's a collection in general, you can try checking if it's <code>IList</code>:</p>\n\n<pre><code>if(x is IList)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "is_accepted": false, "score": 3, "last_activity_date": 1424904379, "creation_date": 1424904379, "answer_id": 28731131, "question_id": 28730971, "link": "https://stackoverflow.com/questions/28730971/do-one-thing-with-an-object-do-another-thing-with-a-list-of-objects/28731131#28731131", "title": "Do one thing with an object, do another thing with a list of objects", "body": "<p>So you need to cast it to a List</p>\n\n<p>Without attempting reflection why not just use function overloading:</p>\n\n<pre><code>void DoSomething&lt;T&gt;(List&lt;T&gt; aList)\n{\n    // this is Swizzle\n}\n\nvoid DoSomething(object obj)\n{\n    // this is Wibble\n}\n</code></pre>\n\n<p>If you don't know the type at compile time, and hence function overloading does not work, you can use reflection</p>\n\n<pre><code>    public class Foo\n    {\n        private void Swizzle&lt;T&gt;(List&lt;T&gt; list)\n        {\n            Console.WriteLine(\"Sizzle\");\n        }\n\n        private void Wibble(object o)\n        {\n            Console.WriteLine(\"Wibble\");\n        }\n\n        public void DoSomething(object o)\n        {\n             var ot = o.GetType();\n             if (ot.IsGenericType &amp;&amp; ot.GetGenericTypeDefinition() == typeof(List&lt;&gt;))\n             {\n                 this.GetType().GetMethod(\"Swizzle\", BindingFlags.NonPublic | BindingFlags.Instance).MakeGenericMethod(ot.GetGenericArguments()[0])\n                     .Invoke(this, new object[] { o });\n             }\n             else\n                 this.Wibble(o);\n        }\n    }\n\n\n// Then usage\n var foo = new Foo();\n foo.DoSomething(new List&lt;int&gt;());\n foo.DoSomething(new object());\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424905206, "post_id": 28731215, "comment_id": 45748820, "body": "This will work just as well with <code>Call&lt;T&gt;(List&lt;T&gt; items)</code>, by the way, to stay in the constraints of the question. (Of course then the array no longer matches.) <code>IList&lt;object&gt;</code> is no better than <code>IList</code>; <code>IEnumerable&lt;T&gt;</code> would be better than either in terms of generality."}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "edited": false, "score": 0, "creation_date": 1424969407, "post_id": 28731215, "comment_id": 45778310, "body": "Like it - Forgot about dynamic typing.  This should probably be the answer for .NET versions that support it."}], "tags": [], "owner": {"reputation": 18976, "user_id": 580951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xN8BV.jpg?s=128&g=1", "display_name": "Dustin Kingen", "link": "https://stackoverflow.com/users/580951/dustin-kingen"}, "is_accepted": false, "score": 3, "last_activity_date": 1424915487, "last_edit_date": 1424915487, "creation_date": 1424904757, "answer_id": 28731215, "question_id": 28730971, "link": "https://stackoverflow.com/questions/28730971/do-one-thing-with-an-object-do-another-thing-with-a-list-of-objects/28731215#28731215", "title": "Do one thing with an object, do another thing with a list of objects", "body": "<p>If this is an academic exercise then you can abuse the runtime type resolution.</p>\n\n<pre><code>void DoSomething(object x)\n{\n    Call((dynamic) x);\n}\n\nvoid Call(IList items)\n{\n    Console.WriteLine(\"Swizzle\");\n}\n\nvoid Call(object item)\n{\n    Console.WriteLine(\"Wibble\");\n}\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>DoSomething(new object[] { });     // Swizzle\nDoSomething(new List&lt;object&gt; { }); // Swizzle\nDoSomething(new List&lt;int&gt; { });    // Swizzle\nDoSomething(1);                    // Wibble\nDoSomething(new object());         // Wibble\n</code></pre>\n"}], "owner": {"reputation": 3564, "user_id": 977472, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/mWgBh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/977472/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1424915487, "creation_date": 1424903677, "question_id": 28730971, "link": "https://stackoverflow.com/questions/28730971/do-one-thing-with-an-object-do-another-thing-with-a-list-of-objects", "title": "Do one thing with an object, do another thing with a list of objects", "body": "<p>I'd like to write a function that takes one input parameter, then:</p>\n\n<ul>\n<li>if it's a list of objects, does one thing, but</li>\n<li>if it's a single object, does another thing.</li>\n</ul>\n\n<p>I'm imagining this function to look like this:</p>\n\n<pre><code> void DoSomething(object x) {\n      if (x is List) { Swizzle(x); }\n      else { Wibble(x); }\n }\n</code></pre>\n\n<p>For various reasons, it would be best to do this all inside a single function.</p>\n\n<p>(The <code>List</code> I'm using is the standard one found in <code>System.Collections.Generic</code>.)</p>\n"}, {"tags": ["c#", "ios", "apple-push-notifications"], "answers": [{"tags": [], "owner": {"reputation": 301, "user_id": 3224317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2498f8638fd5143d34338a5062fcf09?s=128&d=identicon&r=PG&f=1", "display_name": "Diff", "link": "https://stackoverflow.com/users/3224317/diff"}, "is_accepted": true, "score": 0, "last_activity_date": 1425416949, "creation_date": 1425416949, "answer_id": 28841934, "question_id": 28730938, "link": "https://stackoverflow.com/questions/28730938/authenticateasclient-error-when-attempting-push-notification-with-apns/28841934#28841934", "title": "AuthenticateAsClient error when attempting push notification with APNs", "body": "<p>Two things were happening:  </p>\n\n<p>First, I had some bad logging that was receiving a NullReferenceException and was covering up the real exception.  </p>\n\n<p>Second, the real exception was indicating that I was attempting multiple simultaneous reads, whic h SslStream does not support.  </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.net.security.sslstream.beginread(v=vs.100).aspx\" rel=\"nofollow\">SslStream.BeginRead</a></p>\n"}], "owner": {"reputation": 301, "user_id": 3224317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2498f8638fd5143d34338a5062fcf09?s=128&d=identicon&r=PG&f=1", "display_name": "Diff", "link": "https://stackoverflow.com/users/3224317/diff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "accepted_answer_id": 28841934, "answer_count": 1, "score": 1, "last_activity_date": 1425416949, "creation_date": 1424903522, "question_id": 28730938, "link": "https://stackoverflow.com/questions/28730938/authenticateasclient-error-when-attempting-push-notification-with-apns", "title": "AuthenticateAsClient error when attempting push notification with APNs", "body": "<p>I'm working on push notifications (using C#) for my company's app.  I seem to have hit every issue that is possible in the process.  I finally have push notifications working, but I still have a glitch that I have not been able to figure out.</p>\n\n<p>I'm using the <code>gateway.sandbox.push.apple.com</code> service for testing and most of the time everything works correctly.  But occasionally, I will receive <code>Authentication failed because the remote party has closed the transport stream</code>.  There doesn't appear to be anything to do to correct this either.  It just continues to fail until it starts working again.  The call that randomly fails is:   </p>\n\n<pre><code>sslStream.AuthenticateAsClient(APN_SERVICE, localCertCollection, System.Security.Authentication.SslProtocols.TLS, false);\n</code></pre>\n\n<p>According to the Apple docs, APN will close the stream if it is given a bad token, but in this case I know I am using a good token.  And I'm not sending a large number of requests - only one or two every couple of minutes.</p>\n\n<p>Has anyone else run into this behavior?  Am I hitting a APN limit of some sort?  Any ideas as to what might be happening?</p>\n"}, {"tags": ["c#", "sql-server", "linq"], "comments": [{"owner": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 0, "creation_date": 1424903613, "post_id": 28730885, "comment_id": 45748066, "body": "What does SQL Profiler show when you execute that linq?"}, {"owner": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 0, "creation_date": 1424903672, "post_id": 28730885, "comment_id": 45748098, "body": "Also - you are constructing a linq query object here, but NOT executing it (at least in the code you have shared with us)."}, {"owner": {"reputation": 2009, "user_id": 1353677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GxDPi.jpg?s=128&g=1", "display_name": "nXu", "link": "https://stackoverflow.com/users/1353677/nxu"}, "edited": false, "score": 1, "creation_date": 1424903722, "post_id": 28730885, "comment_id": 45748124, "body": "Check this out: <a href=\"http://stackoverflow.com/questions/586097/compare-nullable-types-in-linq-to-sql\" title=\"compare nullable types in linq to sql\">stackoverflow.com/questions/586097/&hellip;</a>"}, {"owner": {"reputation": 349, "user_id": 3919774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26e5d3d437db41fae2cf36e465cfaae9?s=128&d=identicon&r=PG&f=1", "display_name": "Chewdoggie", "link": "https://stackoverflow.com/users/3919774/chewdoggie"}, "edited": false, "score": 0, "creation_date": 1424903824, "post_id": 28730885, "comment_id": 45748168, "body": "I&#39;m not familiar with SQL Profiler.  The db object is a DataClasses1DataContext object added to my project."}, {"owner": {"reputation": 349, "user_id": 3919774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26e5d3d437db41fae2cf36e465cfaae9?s=128&d=identicon&r=PG&f=1", "display_name": "Chewdoggie", "link": "https://stackoverflow.com/users/3919774/chewdoggie"}, "edited": false, "score": 0, "creation_date": 1424904333, "post_id": 28730885, "comment_id": 45748424, "body": "The output from the db.log is &quot;WHERE ([t0].[jobmst_type] &lt;&gt; @p0) AND ([t0].[jobmst_prntid] = @p1)&quot;"}, {"owner": {"reputation": 349, "user_id": 3919774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26e5d3d437db41fae2cf36e465cfaae9?s=128&d=identicon&r=PG&f=1", "display_name": "Chewdoggie", "link": "https://stackoverflow.com/users/3919774/chewdoggie"}, "edited": false, "score": 0, "creation_date": 1424904568, "post_id": 28730885, "comment_id": 45748533, "body": "p0: Input Int (Size = -1; Prec = 0; Scale = 0) [1] p1: Input Int (Size = -1; Prec = 0; Scale = 0) [Null]"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 3919774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26e5d3d437db41fae2cf36e465cfaae9?s=128&d=identicon&r=PG&f=1", "display_name": "Chewdoggie", "link": "https://stackoverflow.com/users/3919774/chewdoggie"}, "edited": false, "score": 0, "creation_date": 1424905972, "post_id": 28731130, "comment_id": 45749122, "body": "That syntax is for a nullable value in the join statement.  My issue is a nullable value in the where clause.  I tried the syntax but it didn&#39;t work.  Thanks tho."}], "tags": [], "owner": {"reputation": 21, "user_id": 4288346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4db63db400df0b1ba3991999bb4e64?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan  De Lara ", "link": "https://stackoverflow.com/users/4288346/ivan-de-lara"}, "is_accepted": false, "score": 2, "last_activity_date": 1424916834, "last_edit_date": 1424916834, "creation_date": 1424904378, "answer_id": 28731130, "question_id": 28730885, "link": "https://stackoverflow.com/questions/28730885/linq-to-sql-nullable-int/28731130#28731130", "title": "Linq to SQL nullable int?", "body": "<p>I think you have to prepend <code>(int ?)</code> in the expression to work when you have null</p>\n\n<pre><code>j.jobmst_prntid.Equals ( folder.FolderID )\nj.jobmst_prntid.Equals ( (int ? ) folder.FolderID )\n</code></pre>\n\n<p>For more reference:\n<a href=\"https://msdn.microsoft.com/en-us/library/bb882535.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bb882535.aspx</a></p>\n\n<p>or you can try this</p>\n\n<pre><code> where j.jobmst_type != 1 &amp;&amp; j.jobmst_prntid.Equals(folder.FolderID== null ?   null : folder.FolderID)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2009, "user_id": 1353677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GxDPi.jpg?s=128&g=1", "display_name": "nXu", "link": "https://stackoverflow.com/users/1353677/nxu"}, "is_accepted": false, "score": 3, "last_activity_date": 1424904555, "last_edit_date": 1495540792, "creation_date": 1424904555, "answer_id": 28731182, "question_id": 28730885, "link": "https://stackoverflow.com/questions/28730885/linq-to-sql-nullable-int/28731182#28731182", "title": "Linq to SQL nullable int?", "body": "<p>As I already mentioned it in a comment: <a href=\"https://stackoverflow.com/questions/586097/compare-nullable-types-in-linq-to-sql\">Compare nullable types in Linq to Sql</a></p>\n\n<p>The answer to that question also applies here: Linq to SQL behaves kind of strangely when querying nullable types. The solution is to check for <code>null</code> explicitly if the value of the nullable type is <code>null</code>. If you don't want to write two queries, just write different where clauses (you have to mix in some lambda syntax):</p>\n\n<pre><code>Expression&lt;Func&lt;Job,bool&gt;&gt; predicate;\nif(folder.FolderID == null) {\n    predicate = j=&gt;j.jobmst_prntid == null &amp;&amp; j.jobmst_type != 1;\n} else {\n    predicate = j=&gt;j.jobmst_prntid == folder.FolderID &amp;&amp; j.jobmst_type != 1;\n}\n\n//...\n.Where(predicate)\nselect new\n{\n    // ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 349, "user_id": 3919774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26e5d3d437db41fae2cf36e465cfaae9?s=128&d=identicon&r=PG&f=1", "display_name": "Chewdoggie", "link": "https://stackoverflow.com/users/3919774/chewdoggie"}, "is_accepted": false, "score": 0, "last_activity_date": 1426788475, "creation_date": 1426788475, "answer_id": 29151982, "question_id": 28730885, "link": "https://stackoverflow.com/questions/28730885/linq-to-sql-nullable-int/29151982#29151982", "title": "Linq to SQL nullable int?", "body": "<p>I ended up doing this for my situation:</p>\n\n<pre><code>List&lt;Job&gt; folderJobs = new List&lt;Job&gt;();\nvar tidalJobs = (dynamic) null;\nif (folder.FolderID == 0)\n{\n    tidalJobs = from \n                    master in tidal.jobmsts\n                join\n                    detail in tidal.jobdtls\n                on\n                    master.jobdtl_id equals detail.jobdtl_id\n                where \n                    master.jobmst_prntid.HasValue == false &amp;&amp; master.jobmst_type != 1\n                select new\n                {\n                    JobID = master.jobmst_id,\n                    JobName = master.jobmst_name,\n                    Description = master.jobmst_desc == null ? string.Empty : master.jobmst_desc,\n                    Source = detail.jobdtl_cmd == null ? string.Empty : detail.jobdtl_cmd\n                };\n}\nelse\n{\n    tidalJobs = from\n                    master in tidal.jobmsts\n                join\n                    detail in tidal.jobdtls\n                on\n                    master.jobdtl_id equals detail.jobdtl_id\n                where \n                    master.jobmst_prntid == folder.FolderID &amp;&amp; master.jobmst_type != 1\n                select new\n                {\n                    JobID = master.jobmst_id,\n                    JobName = master.jobmst_name,\n                    Description = master.jobmst_desc == null ? string.Empty : master.jobmst_desc,\n                    Source = detail.jobdtl_cmd == null ? string.Empty : detail.jobdtl_cmd\n                };\n}\n\nforeach (var folderJob in tidalJobs)\n{\n    ...\n}\n</code></pre>\n\n<p>In short, var tidalJobs = (dynamic) null and .HasValue == false is what I needed to get this working.  The only caveat is that setting a var to (dynamic) null disables intellisense b/c everything is evaluated at runtime.  So, your typing better be spot on.</p>\n"}], "owner": {"reputation": 349, "user_id": 3919774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26e5d3d437db41fae2cf36e465cfaae9?s=128&d=identicon&r=PG&f=1", "display_name": "Chewdoggie", "link": "https://stackoverflow.com/users/3919774/chewdoggie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4265, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1426788475, "creation_date": 1424903315, "question_id": 28730885, "link": "https://stackoverflow.com/questions/28730885/linq-to-sql-nullable-int", "title": "Linq to SQL nullable int?", "body": "<p>I have the following linq query (pretty simple):</p>\n\n<pre><code>var jobs = from j in db.jobmsts\n    join jd in db.jobdtls on j.jobdtl_id equals jd.jobdtl_id\n    where j.jobmst_type != 1 &amp;&amp; j.jobmst_prntid.Equals(folder.FolderID)\n    orderby j.jobmst_name\n    select new\n        {\n            JobID = j.jobmst_id,\n            JobName = j.jobmst_name,\n            Description = j.jobmst_desc,\n            Source = jd.Source\n        };\n</code></pre>\n\n<p>folder.FolderID is a nullable int (int?) that is passed into the method as a parameter.  So, when it's null, the query returns no results.  But if I execute the same query in TSQL:</p>\n\n<pre><code>select * from jobmst j \njoin jobdtl jd on j.jobdtl_id = jd.jobdtl_id \nwhere j.jobmst_type != 1 and j.jobmst_prntid is null\n</code></pre>\n\n<p>I get 6 records.  Oddly, if I substitute \"folder.FolderID\" with \"null\" (in the linq code), it does return 6 records.  So, obviously there's a difference between \"null\" and an object with a null value.  I just don't know what is it and how to fix this.</p>\n\n<p>FYI, I had the code so that the where clause looked like this:</p>\n\n<pre><code>where j.jobmst_type != 1 &amp;&amp; j.jobmst_prntid == folder.FolderID\n</code></pre>\n\n<p>But it didn't produce any results either.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c#", "arrays", "sorting"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1424903134, "post_id": 28730823, "comment_id": 45747828, "body": "Sort/OrderBy doesnt act on the object - it returns a new <code>valid</code> ordered"}], "answers": [{"tags": [], "owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "is_accepted": true, "score": 2, "last_activity_date": 1424903155, "creation_date": 1424903155, "answer_id": 28730848, "question_id": 28730823, "link": "https://stackoverflow.com/questions/28730823/sorting-array-with-multiple-different-fields-doesnt-sort-by-char/28730848#28730848", "title": "Sorting array with multiple different fields - doesn&#39;t sort by char", "body": "<p><code>OrderBy</code> returns a new sequence, it doesn't change your array. You need to assign it back:</p>\n\n<pre><code>valid = valid.OrderBy(a =&gt; a.znak).ToArray();\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 4205734, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dc95ad735dd20baac803fb43d081e502?s=128&d=identicon&r=PG&f=1", "display_name": "Januszoff", "link": "https://stackoverflow.com/users/4205734/januszoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 28730848, "answer_count": 1, "score": 0, "last_activity_date": 1424903155, "creation_date": 1424903017, "question_id": 28730823, "link": "https://stackoverflow.com/questions/28730823/sorting-array-with-multiple-different-fields-doesnt-sort-by-char", "title": "Sorting array with multiple different fields - doesn&#39;t sort by char", "body": "<p>Here's my class:</p>\n\n<pre><code>public class walidacja\n{\n    public char znak { get; set; }\n    public double wyj_neuron_1 { get; set; }\n    public double wyj_neuron_2 { get; set; }\n    public double wyj_neuron_3 { get; set; }\n    public double wyj_neuron_1_norm { get; set; }\n    public double wyj_neuron_2_norm { get; set; }\n    public double wyj_neuron_3_norm { get; set; }\n    public bool rozpoznaj { get; set; }\n\n    public walidacja(char lit, double a, double b, double c, bool test)\n    {\n        this.znak = lit;\n        this.wyj_neuron_1 = a;\n        this.wyj_neuron_2 = b;\n        this.wyj_neuron_3 = c;\n        this.wyj_neuron_1_norm = a / (a + b + c);\n        this.wyj_neuron_2_norm = b / (a + b + c);\n        this.wyj_neuron_3_norm = c / (a + b + c);\n        this.rozpoznaj = test;\n    }\n}\n</code></pre>\n\n<p>Then I declare</p>\n\n<pre><code>valid = new walidacja[counter];\n</code></pre>\n\n<p>I fill the array with data. Znak gets filled with equal number of 3 letters (so if counter = 15, there will be 5 a's, 5 b's, 5 c's in the znak field).</p>\n\n<p>Why does this not sort the array by char znak?</p>\n\n<pre><code>valid.OrderBy(a =&gt; a.znak);\n</code></pre>\n"}, {"tags": ["c#", "generics", "expression-trees", "builder"], "comments": [{"owner": {"reputation": 117905, "user_id": 1163867, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fe5ef74a2c17f19c75d2f49b95fb71d?s=128&d=identicon&r=PG", "display_name": "MarcinJuraszek", "link": "https://stackoverflow.com/users/1163867/marcinjuraszek"}, "edited": false, "score": 5, "creation_date": 1424903022, "post_id": 28730782, "comment_id": 45747782, "body": "I can&#39;t see why it wouldn&#39;t be possible."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "reply_to_user": {"reputation": 117905, "user_id": 1163867, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fe5ef74a2c17f19c75d2f49b95fb71d?s=128&d=identicon&r=PG", "display_name": "MarcinJuraszek", "link": "https://stackoverflow.com/users/1163867/marcinjuraszek"}, "edited": false, "score": 3, "creation_date": 1424903252, "post_id": 28730782, "comment_id": 45747899, "body": "@MarcinJuraszek: please make that an answer so we can upvote it. :-) ...all kidding aside, though, what are you expecting out of this question? Yes, it seems possible. Do you want someone to blurt out the whole code for it? That&#39;s rather a lot of work."}, {"owner": {"reputation": 11566, "user_id": 71200, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0a9d0aadd049fa597a20fe4274e8d1b9?s=128&d=identicon&r=PG", "display_name": "Kenneth Cochran", "link": "https://stackoverflow.com/users/71200/kenneth-cochran"}, "edited": false, "score": 0, "creation_date": 1424903827, "post_id": 28730782, "comment_id": 45748171, "body": "Of course not. I didn&#39;t ask anyone to &quot;give me the codez&quot;. I was hoping for confirmation (which you&#39;ve given) that I wouldn&#39;t be wasting my time to attempt this and possibly a link to an article or a library where someone has already pioneered the idea."}], "answers": [{"tags": [], "owner": {"reputation": 117905, "user_id": 1163867, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fe5ef74a2c17f19c75d2f49b95fb71d?s=128&d=identicon&r=PG", "display_name": "MarcinJuraszek", "link": "https://stackoverflow.com/users/1163867/marcinjuraszek"}, "is_accepted": false, "score": 2, "last_activity_date": 1424903929, "last_edit_date": 1424903929, "creation_date": 1424903594, "answer_id": 28730956, "question_id": 28730782, "link": "https://stackoverflow.com/questions/28730782/is-a-generic-object-builder-possible-in-c/28730956#28730956", "title": "Is a generic object builder possible in C#?", "body": "<p>I can't see why it wouldn't be possible. You might need a bit different syntax to make structure a bit more obvious, e.g.:</p>\n\n<pre><code>Builder.Add&lt;Item&gt;(i =&gt;\n           i.With&lt;Thing&gt;(t =&gt;\n               t.With&lt;Stuff&gt;(s =&gt;\n                   s.Add&lt;Widget&gt;(w =&gt; w.With&lt;string&gt;(\"Red\"))\n                    .Add&lt;Widget&gt;(w =&gt; w.With&lt;string&gt;(\"Green\")))\n                .Add&lt;Bubble&gt;()\n                .Add&lt;Bubble&gt;()));\n</code></pre>\n\n<p>It assumes that there is exactly one property with given type. E.g. <code>With&lt;T&gt;</code> would look for a property typed as <code>&lt;T&gt;</code> and <code>Add&lt;T&gt;</code> would look for property typed <code>List&lt;T&gt;</code>.</p>\n\n<p>It would get a bit messy when there is more than one property of given type. You'd have to somehow determine which one should be set with given Value.</p>\n\n<pre><code>s.Add&lt;Widget&gt;(w =&gt; w.With(x =&gt; x.Color, \"Red\").With(x =&gt; x.Name, \"MyWidget\"));\n</code></pre>\n\n<p>Get's ugly real quick. Also perf wouldn't be ideal, so I can't see any real usage other than crafting instances for Unit Testing.</p>\n\n<p>I know nothing about existing library like this.</p>\n"}, {"tags": [], "owner": {"reputation": 2857, "user_id": 1693158, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/BeQ2W.jpg?s=128&g=1", "display_name": "dustinmoris", "link": "https://stackoverflow.com/users/1693158/dustinmoris"}, "is_accepted": true, "score": 1, "last_activity_date": 1424904421, "creation_date": 1424904421, "answer_id": 28731145, "question_id": 28730782, "link": "https://stackoverflow.com/questions/28730782/is-a-generic-object-builder-possible-in-c/28731145#28731145", "title": "Is a generic object builder possible in C#?", "body": "<p>Sounds like NBuilder could satisfy your requirements: <a href=\"https://code.google.com/p/nbuilder/\" rel=\"nofollow\">https://code.google.com/p/nbuilder/</a></p>\n\n<p>It already exists, is widely used and very popular.</p>\n"}, {"comments": [{"owner": {"reputation": 213217, "user_id": 41071, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ec0f5be7749c8cc8ccda4a809103f36?s=128&d=identicon&r=PG", "display_name": "svick", "link": "https://stackoverflow.com/users/41071/svick"}, "edited": false, "score": 0, "creation_date": 1428851870, "post_id": 28731173, "comment_id": 47329048, "body": "Except that C# object initializer syntax <i>is</i> a declarative (sub-)language."}], "tags": [], "owner": {"reputation": 41499, "user_id": 643085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svAcm.png?s=128&g=1", "display_name": "Federico Berasategui", "link": "https://stackoverflow.com/users/643085/federico-berasategui"}, "is_accepted": false, "score": 1, "last_activity_date": 1424905574, "last_edit_date": 1424905574, "creation_date": 1424904527, "answer_id": 28731173, "question_id": 28730782, "link": "https://stackoverflow.com/questions/28730782/is-a-generic-object-builder-possible-in-c/28731173#28731173", "title": "Is a generic object builder possible in C#?", "body": "<p>If XML, JSON and XAML have teached us anything, it's that <strong>declarative languages are much better suited to create object graphs</strong> than imperative ones.</p>\n\n<p>Forget all that and use XML, JSON or XAML de/serialization:</p>\n\n<p>Here's an example of how your code would look like, using JSON:</p>\n\n<pre><code>\"items\": [\n    \"item\": { \n       \"Things\": [\n           \"Thing\": {\n               \"Stuff\": {\n                   \"Widgets\" [\n                      \"Widget\": {\"Color\" = \"Red\"}\n                    ],\n                \"Bobbles\": [ \n                   \"Bobble\": { }],\n               },\n            },\n        ],\n     },\n },\n</code></pre>\n\n<p>Then, it's just a matter of using any of the many well-known de/serialization libraries (such as <a href=\"http://www.newtonsoft.com/json\" rel=\"nofollow\">Json.NET</a>), to convert your serialized data into a strongly typed object graph.</p>\n\n<blockquote>\n  <p>Disclaimer: I hand-typed the above JSON so it might have syntax errors, but you get the idea.</p>\n</blockquote>\n"}], "owner": {"reputation": 11566, "user_id": 71200, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0a9d0aadd049fa597a20fe4274e8d1b9?s=128&d=identicon&r=PG", "display_name": "Kenneth Cochran", "link": "https://stackoverflow.com/users/71200/kenneth-cochran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 28731145, "answer_count": 3, "score": -1, "last_activity_date": 1424905574, "creation_date": 1424902856, "last_edit_date": 1424903431, "question_id": 28730782, "link": "https://stackoverflow.com/questions/28730782/is-a-generic-object-builder-possible-in-c", "title": "Is a generic object builder possible in C#?", "body": "<p>I'm writing some unit tests for a reporting system that uses some pretty complex composition of DTOs. To test the system I find myself writing a lot of code like this:</p>\n\n<pre><code>var items = new List&lt;Item&gt;\n{\n    new Item\n    {\n        Things =\n            new List&lt;Thing&gt;\n            {\n                new Thing\n                {\n                    Stuff =\n                        new Stuff\n                        {\n                            Widgets = new List&lt;Widget&gt; {new Widget {Color = \"Red\"}}\n                        },\n                    Bobbles = new List&lt;Bobble&gt;{new Bobble(), new Bobble()}\n                }\n            }\n    }\n};\n</code></pre>\n\n<p>This strikes me as verbose and cumbersome so my first thought was to use the builder pattern with a fluent interface:</p>\n\n<pre><code>var items = ItemBuilder.AddItem()\n                           .WithThing()\n                           .WithStuff()\n                           .WithWidget()\n                           .WithColor(\"Red\");\n</code></pre>\n\n<p>Or something to that effect. Then it hit me that I have other objects I need to create like this and that it would be nice if I could use generics to apply this to any object I needed to:</p>\n\n<pre><code>var items = Builder.Add&lt;Item&gt;()\n                           .With&lt;Thing&gt;()\n                           .With&lt;Stuff&gt;()\n                           .With&lt;Widget&gt;()\n                           .With&lt;Color&gt;(\"Red\");\n</code></pre>\n\n<p>Obviously these examples only approximate what the real interface might look like.</p>\n\n<p>With such syntactic sugar as generics, lambdas and expression trees is this possible with C#?</p>\n\n<p>I searched to see if anyone had attempted something like this but only found one or two incomplete series of blog posts on the topic. It seems to me that if it were possible there would be a complete example or an open source or commercial library available.</p>\n"}, {"tags": ["c#", ".net", "json"], "answers": [{"tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": true, "score": 5, "last_activity_date": 1424902596, "creation_date": 1424902596, "answer_id": 28730732, "question_id": 28730679, "link": "https://stackoverflow.com/questions/28730679/access-to-json-data-properties/28730732#28730732", "title": "Access to JSON Data Properties", "body": "<p>I would suggest using \"LINQ to JSON\" instead of <code>DeserializeObject</code>, personally - although that may just due to having more experience with it:</p>\n\n<pre><code>using System;\nusing System.IO;\n\nusing Newtonsoft.Json.Linq;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string text = File.ReadAllText(\"Test.json\");\n\n        var json = JObject.Parse(text);\n        var data = json[\"data\"];\n        foreach (var item in data)\n        {\n            Console.WriteLine(item[\"Href\"]);\n        }\n    }\n}\n</code></pre>\n\n<p>Having said that, you can use <code>DeserializeObject</code> perfectly well, just accessing the members dynamically:</p>\n\n<pre><code>using System;\nusing System.IO;\n\nusing Newtonsoft.Json;\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        string text = File.ReadAllText(\"Test.json\");\n        var json = JsonConvert.DeserializeObject&lt;dynamic&gt;(text);\n        var data = json.data;\n        foreach (var item in data)\n        {\n            Console.WriteLine(item.Href);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11486, "user_id": 1765862, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3a746ea2091abf7d4373f86136d83091?s=128&d=identicon&r=PG", "display_name": "user1765862", "link": "https://stackoverflow.com/users/1765862/user1765862"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 28730732, "answer_count": 1, "score": -1, "last_activity_date": 1424902912, "creation_date": 1424902392, "last_edit_date": 1424902832, "question_id": 28730679, "link": "https://stackoverflow.com/questions/28730679/access-to-json-data-properties", "title": "Access to JSON Data Properties", "body": "<p>I have the following string </p>\n\n<pre><code>{\n    data: [\n                {\"Href\":\"1.jpg\",\"Id\":1,\"Height\":55,\"Width\":55,\"Index\":0},\n                {\"Href\":\"2.jpg\",\"Id\":2,\"Height\":55,\"Width\":55,\"Index\":1},\n                {\"Href\":\"3.jpg\",\"Id\":3,\"Height\":55,\"Width\":55,\"Index\":2},\n                {\"Href\":\"4.jpg\",\"Id\":4,\"Height\":55,\"Width\":55,\"Index\":3}\n            ]\n}\n</code></pre>\n\n<p>which is converted back to json</p>\n\n<pre><code> var data = Newtonsoft.Json.JsonConvert.DeserializeObject&lt;dynamic&gt;(parsedString);\n</code></pre>\n\n<p>My question is:</p>\n\n<p>How can I access each json attribute, for example <code>Something.Href</code> to extract <code>1.jpg</code>, <code>2.jpg</code> or only <code>Id</code> properties?</p>\n"}, {"tags": ["c#", "combobox", "int", "var"], "comments": [{"owner": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424903391, "post_id": 28730637, "comment_id": 45747953, "body": "I&#39;m not sure I quite understand the problem.  Are you getting an error with the code above?  If so what?  If not, what part is not working as intended?"}, {"owner": {"reputation": 103, "user_id": 4607857, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10204728118136944/picture?type=large", "display_name": "Joe Pearson", "link": "https://stackoverflow.com/users/4607857/joe-pearson"}, "reply_to_user": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424906244, "post_id": 28730637, "comment_id": 45749241, "body": "I am not getting an error yes. However, if I add                                                                                                                     else if (comboBox1.SelectedIndex == 0)         {             var sub1 = 1;                                                                                                                       }                                                                                                                 I get something that tells me that sub1 is not available in the context"}, {"owner": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424907204, "post_id": 28730637, "comment_id": 45749606, "body": "if you declare <code>sub1</code> inside an if statement, its scope is only available inside the if statement.  It cannot be used outside the braces."}, {"owner": {"reputation": 103, "user_id": 4607857, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10204728118136944/picture?type=large", "display_name": "Joe Pearson", "link": "https://stackoverflow.com/users/4607857/joe-pearson"}, "reply_to_user": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424907449, "post_id": 28730637, "comment_id": 45749704, "body": "so do I just make one super long if statement that first determines the strings displayed (which it does now) then a second if statement under the same rule that adds a value to textbox2? if so, how would that look?"}, {"owner": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424908057, "post_id": 28730637, "comment_id": 45749878, "body": "why do you have <code>if (comboBox1.SelectedIndex == 0)</code> 3 times doing the same thing?"}, {"owner": {"reputation": 103, "user_id": 4607857, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10204728118136944/picture?type=large", "display_name": "Joe Pearson", "link": "https://stackoverflow.com/users/4607857/joe-pearson"}, "reply_to_user": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424908937, "post_id": 28730637, "comment_id": 45750169, "body": "this way the next combobox can dynamically change the available values based on the selection of combobox1"}, {"owner": {"reputation": 103, "user_id": 4607857, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10204728118136944/picture?type=large", "display_name": "Joe Pearson", "link": "https://stackoverflow.com/users/4607857/joe-pearson"}, "reply_to_user": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424909011, "post_id": 28730637, "comment_id": 45750184, "body": "oh I see what you are saying, there is a redundant string of If statements. I removed it. the Debug didnt notice it and neither did i haha. but that wasnt causing any issues."}, {"owner": {"reputation": 103, "user_id": 4607857, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10204728118136944/picture?type=large", "display_name": "Joe Pearson", "link": "https://stackoverflow.com/users/4607857/joe-pearson"}, "reply_to_user": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 0, "creation_date": 1424909064, "post_id": 28730637, "comment_id": 45750202, "body": "it should only have one of those sections, not 3. I removed the extra ones. I must have copied them over from another section and missed something."}], "answers": [{"tags": [], "owner": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "is_accepted": true, "score": 0, "last_activity_date": 1424967768, "last_edit_date": 1424967768, "creation_date": 1424908979, "answer_id": 28732139, "question_id": 28730637, "link": "https://stackoverflow.com/questions/28730637/how-do-i-assign-an-int-from-comboboxes-to-add-them-and-display-result-in-textbox/28732139#28732139", "title": "How do I assign an INT from comboboxes to add them and display result in textbox1", "body": "<p>Normally, these items would be populated by some external source, like a database.  However, as you are hard-coding the values in each drop down, I suggest you populate the textbox like this:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsApplication3\n{\n  public partial class Form1 : Form\n  {\n    public Form1()\n    {\n      InitializeComponent();\n      Dictionary&lt;int, string[]&gt; comboBox1Options = new Dictionary&lt;int, string[]&gt;();\n      comboBox1Options.Add(0, new[] { \"1\", \"2\", \"3\", \"4\" });\n\n      comboBox1.Items.Clear();\n      comboBox1.Items.AddRange(comboBox1Options[0]);\n\n    }\n    private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)\n    {\n      Dictionary&lt;int, string[]&gt; comboBox2Options = new Dictionary&lt;int, string[]&gt;();\n      comboBox2Options.Add(0, new[] { \"1\", \"2\", \"3\", \"4\" });\n      comboBox2Options.Add(1, new[] { \"5\", \"6\", \"7\", \"8\" });\n      comboBox2Options.Add(2, new[] { \"Corp Over 250k\", \"Corp Under 250k\", \"Hybrid Over 250k\", \"Hybrid Under 250k\" });\n\n      comboBox2.Items.Clear();\n      comboBox2.Items.AddRange(comboBox2Options[comboBox1.SelectedIndex]);\n      textBox2.Text = comboBox1.SelectedIndex.ToString();\n    }\n\n    private void comboBox2_SelectedIndexChanged(object sender, EventArgs e)\n    {\n      Dictionary&lt;int, string[]&gt; comboBox3Options = new Dictionary&lt;int, string[]&gt;();\n      comboBox3Options.Add(0, new[] { \"Move Amendment Override\" });\n      comboBox3Options.Add(1, new[] { \"Move Ammendment Override INTERNAL\" });\n      comboBox3Options.Add(2, new[] { \"250 - 399\", \"400 - 599\", \"600 - 799\", \"800 - 999\" });\n      comboBox3Options.Add(3, new[] { \"Move Hybrid Documents\" });\n\n      comboBox3.Items.Clear();\n      comboBox3.Items.AddRange(comboBox3Options[comboBox2.SelectedIndex]);\n      textBox2.Text += comboBox2.SelectedIndex.ToString();\n    }\n\n    private void comboBox3_SelectedIndexChanged(object sender, EventArgs e)\n    {\n      textBox2.Text += comboBox3.SelectedIndex.ToString();\n    }\n  }\n}\n</code></pre>\n\n<p>Additionally, using a dictionary instead of many if statements drastically simplifies your code.</p>\n"}], "owner": {"reputation": 103, "user_id": 4607857, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10204728118136944/picture?type=large", "display_name": "Joe Pearson", "link": "https://stackoverflow.com/users/4607857/joe-pearson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 28732139, "answer_count": 1, "score": 0, "last_activity_date": 1430333640, "creation_date": 1424902231, "question_id": 28730637, "link": "https://stackoverflow.com/questions/28730637/how-do-i-assign-an-int-from-comboboxes-to-add-them-and-display-result-in-textbox", "title": "How do I assign an INT from comboboxes to add them and display result in textbox1", "body": "<p>I am trying to have a dynamic set of comboboxes that change based on the last selection. However, I want them to create a custom string of numbers for each possible outcome. When I would like is to have each one add a value of 1s, 10s, 100s, and 1000s. </p>\n\n<p>(for example selection the first option in each combobox would display 1111 in the textbox2 or if they select the second option in combobox1 then the first for the rest it would display 1112) here is the code below: </p>\n\n<p>Essentially I just want to add values that are created based on the selection from each combobox in textbox2 and have them display. </p>\n\n<pre><code>    private void comboBox1_SelectedIndexChanged_1(object sender, EventArgs e)\n    {\n\n\n        if (comboBox1.SelectedIndex == 0)\n        {\n            comboBox2.Items.Clear();\n            comboBox2.Items.Add(\"1\");\n            comboBox2.Items.Add(\"2\");\n            comboBox2.Items.Add(\"3\");\n            comboBox2.Items.Add(\"4\");\n        }\n        else if (comboBox1.SelectedIndex == 0)\n        {\n            comboBox2.Items.Clear();\n            comboBox2.Items.Add(\"1\");\n            comboBox2.Items.Add(\"2\");\n            comboBox2.Items.Add(\"3\");\n            comboBox2.Items.Add(\"4\");\n        }\n        else if (comboBox1.SelectedIndex == 1)\n        {\n            comboBox2.Items.Clear();\n            comboBox2.Items.Add(\"5\");\n            comboBox2.Items.Add(\"6\");\n            comboBox2.Items.Add(\"7\");\n            comboBox2.Items.Add(\"8\");\n        }\n        else if (comboBox1.SelectedIndex == 2)\n        {\n            comboBox2.Items.Clear();\n            comboBox2.Items.Add(\"Corp Over 250k\");\n            comboBox2.Items.Add(\"Corp Under 250k\");\n            comboBox2.Items.Add(\"Hybrid Over 250k\");\n            comboBox2.Items.Add(\"Hybrid Under 250k\");\n        }\n        if (comboBox1.SelectedIndex == 0)\n        {\n            comboBox2.Items.Clear();\n            comboBox2.Items.Add(\"1\");\n            comboBox2.Items.Add(\"2\");\n            comboBox2.Items.Add(\"3\");\n            comboBox2.Items.Add(\"4\");\n        }\n    }\n\n    private void comboBox2_SelectedIndexChanged(object sender, EventArgs e)\n    {\n        if (comboBox2.SelectedIndex == 0)\n        {\n            comboBox3.Items.Clear();\n            comboBox3.Items.Add(\"Move Amendment Override\");\n        }\n        else if (comboBox2.SelectedIndex == 1)\n        {\n            comboBox3.Items.Clear();\n            comboBox3.Items.Add(\"Move Ammendment Override INTERNAL\");\n        }\n        else if (comboBox2.SelectedIndex == 2)\n        {\n            comboBox3.Items.Clear();\n            comboBox3.Items.Add(\"250 - 399\");\n            comboBox3.Items.Add(\"400 - 599\");\n            comboBox3.Items.Add(\"600 - 799\");\n            comboBox3.Items.Add(\"800 - 999\");\n            comboBox3.Items.Add(\"1000 - 1499\");\n            comboBox3.Items.Add(\"1500 - 1999\");\n            comboBox3.Items.Add(\"2000+\");\n        }\n        else if (comboBox2.SelectedIndex == 3)\n        {\n            comboBox3.Items.Clear();\n            comboBox3.Items.Add(\"Move Hybrid Documents\");\n        }\n    }\n\n    private void textBox2_TextChanged(object sender, EventArgs e)\n    {\n\n    }\n</code></pre>\n"}, {"tags": ["c#", "plugins", "crm", "microsoft-dynamics"], "comments": [{"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424902436, "post_id": 28730626, "comment_id": 45747513, "body": "How is this not a duplicate of your earlier question: <a href=\"http://stackoverflow.com/questions/28730095/unable-to-compile-code-when-using-orderclose-class\" title=\"unable to compile code when using orderclose class\">stackoverflow.com/questions/28730095/&hellip;</a>?"}, {"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "reply_to_user": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424902555, "post_id": 28730626, "comment_id": 45747569, "body": "It&#39;s a different problem. I thought it was better to create a new question."}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424902556, "post_id": 28730626, "comment_id": 45747571, "body": "Also, whenever you have a question about an exception, you need to post the complete exception. The best way to do this is <code>try {&#47;* code *&#47;} catch (Exception ex){MessageBox.Show(ex.ToString()); &#47;* or whatever *&#47; throw;}</code>. Then post the result of <code>ex.ToString()</code>."}, {"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "reply_to_user": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424902851, "post_id": 28730626, "comment_id": 45747700, "body": "System.ServiceModel.FaultException`1[Microsoft.Xrm.Sdk.Organ&zwnj;&#8203;izationServiceFault]&zwnj;&#8203;: An unexpected error occurred. (Fault Detail is equal to Microsoft.Xrm.Sdk.OrganizationServiceFault)."}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424913404, "post_id": 28730626, "comment_id": 45751450, "body": "Please post that in the body of your question. Also, is that the <i>full</i> exception? Post the results of <code>ex.ToString()</code>, please."}], "owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 552, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424902479, "creation_date": 1424902158, "last_edit_date": 1424902479, "question_id": 28730626, "link": "https://stackoverflow.com/questions/28730626/cannot-set-salesorder-to-fulfilled", "title": "Cannot set salesorder to fulfilled", "body": "<p>I'm trying to set a certain sales order to Fulfilled state. The plugin executes on the update of a salesorderdetail.</p>\n\n<pre><code>        var request = new FulfillSalesOrderRequest();\n\n        request.OrderClose = new Entity();\n\n        request.OrderClose.LogicalName = ordineEntityName;\n        request.OrderClose.Id = orderId;\n        request.Status = new OptionSetValue(newStatus);\n\n        service.Execute(request);\n</code></pre>\n\n<p>But when I execute the code I receive an Exception with \"An unexpected error occured\" message.</p>\n\n<p>Any suggestion?</p>\n"}, {"tags": ["c#", "xml", "wpf", "datagrid", "valueconverter"], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 971583, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/19074c3be125ac36f7a55a71798c65d3?s=128&d=identicon&r=PG", "display_name": "Alan Baljeu", "link": "https://stackoverflow.com/users/971583/alan-baljeu"}, "is_accepted": false, "score": 0, "last_activity_date": 1424909145, "creation_date": 1424909145, "answer_id": 28732173, "question_id": 28730623, "link": "https://stackoverflow.com/questions/28730623/wpf-converting-xml-elements-to-datagrid-content/28732173#28732173", "title": "WPF Converting XML elements to DataGrid content", "body": "<p>This works, but is tedious.  I need to remake everything between DataGridTextColumn.Binding in every column, changing up each time the XPath.  </p>\n\n<p>If anybody can come up with a better way, the prize is open.</p>\n\n<pre><code>  &lt;W3V:UnitsConverter x:Key=\"unitsConverter\" /&gt;\n</code></pre>\n\n<p>...</p>\n\n<pre><code>    &lt;DataGridTextColumn Header=\"Length\"&gt;\n      &lt;DataGridTextColumn.Binding&gt;\n        &lt;MultiBinding Converter=\"{StaticResource unitsConverter}\"&gt;\n          &lt;Binding XPath=\"length/@value\"/&gt;\n          &lt;Binding XPath=\"length/@type\"/&gt;\n          &lt;Binding XPath=\"length/@units\"/&gt;\n        &lt;/MultiBinding&gt;\n      &lt;/DataGridTextColumn.Binding&gt;\n    &lt;/DataGridTextColumn&gt;\n</code></pre>\n\n<p>...</p>\n\n<pre><code>[ValueConversion(typeof(XmlElement), typeof(string))]\npublic class UnitsConverter : IMultiValueConverter\n{\n\nobject IMultiValueConverter.Convert(object[] value, Type targetType, \n                   object parameter, System.Globalization.CultureInfo culture)\n{\n  if (value == null) return new List&lt;string&gt;();\n\n  string data = value[0] as string;\n  string type = value[1] as string;\n  string unit = value[2] as string;\n\n  return Information.FormatValue(data, type, unit);\n\n}\n....\n}\n</code></pre>\n"}], "owner": {"reputation": 2313, "user_id": 971583, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/19074c3be125ac36f7a55a71798c65d3?s=128&d=identicon&r=PG", "display_name": "Alan Baljeu", "link": "https://stackoverflow.com/users/971583/alan-baljeu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1424909145, "creation_date": 1424902151, "last_edit_date": 1495541188, "question_id": 28730623, "link": "https://stackoverflow.com/questions/28730623/wpf-converting-xml-elements-to-datagrid-content", "title": "WPF Converting XML elements to DataGrid content", "body": "<p>EDIT: I'm open to another approach.  The source data is XML, but there's surely other ways to get the datagrid behaving.</p>\n\n<p><a href=\"https://stackoverflow.com/a/28619434/971583\">This answer got me started</a>, but things seem to be different within a DataGrid.  The code works fine if I leave out the value converter, but if I put in the value converter, all I receive as input are empty strings.</p>\n\n<p>Good but imperfect:</p>\n\n<pre><code>    &lt;DataGridTextColumn \n                Header=\"Length\" \n                Binding=\"{Binding XPath=length/@value}}\" /&gt;\n</code></pre>\n\n<p>Junk:</p>\n\n<pre><code>    &lt;DataGridTextColumn \n                Header=\"Length\" \n                Binding=\"{Binding XPath=length, \n                          Converter={StaticResource valueFormattingConverter }}\" /&gt;\n</code></pre>\n\n<p>I have a theory that the above is giving me the element content for element ./length (it's an empty element), but I actually want the element ./length because the attributes need to be processed.</p>\n\n<p>Good but for combo boxes:</p>\n\n<pre><code>&lt;ComboBox Style=\"{StaticResource ComboButtonStyle}\" Width=\"200\" \n        Text=\"{Binding Path=., Converter={StaticResource valueFormattingConverter }}\"\n          IsEditable=\"True\" /&gt;\n</code></pre>\n\n<p>So with the Combo example, valueFormattingConverter.Convert gets called with an XmlElement (yay!).  With the DataGridTextColumn example, it's called with an empty string.</p>\n\n<p>EDIT: ongoing research points to IMultiValueConverter as something I might want.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "windows-phone-8", "windows-phone-8.1"], "answers": [{"tags": [], "owner": {"reputation": 21144, "user_id": 4068779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0Hsj.png?s=128&g=1", "display_name": "Rob Caplan - MSFT", "link": "https://stackoverflow.com/users/4068779/rob-caplan-msft"}, "is_accepted": false, "score": 3, "last_activity_date": 1424904734, "creation_date": 1424904734, "answer_id": 28731212, "question_id": 28730616, "link": "https://stackoverflow.com/questions/28730616/listen-the-show-hide-events-for-soft-keyboard-windows-8-1-rt-xaml/28731212#28731212", "title": "Listen the show / hide events for soft keyboard (Windows 8.1 RT, XAML)", "body": "<p>The article you quote is intended for Windows Runtime apps, but it has a minor bug. The <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.viewmanagement.inputpane.aspx\" rel=\"nofollow\">InputPane</a> is in <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.viewmanagement.aspx\" rel=\"nofollow\">Windows.UI.ViewManagement</a> not in Windows.Foundation.Application. Change that and the rest should work fine.</p>\n\n<p>I've reported the doc bug so it can be fixed.</p>\n"}, {"tags": [], "owner": {"reputation": 28335, "user_id": 853836, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fc609f2f90e5d5d6802b0201c15db5b6?s=128&d=identicon&r=PG", "display_name": "Addev", "link": "https://stackoverflow.com/users/853836/addev"}, "is_accepted": true, "score": 3, "last_activity_date": 1424905367, "creation_date": 1424905367, "answer_id": 28731375, "question_id": 28730616, "link": "https://stackoverflow.com/questions/28730616/listen-the-show-hide-events-for-soft-keyboard-windows-8-1-rt-xaml/28731375#28731375", "title": "Listen the show / hide events for soft keyboard (Windows 8.1 RT, XAML)", "body": "<p>Found the answer, registering for those events is enough:</p>\n\n<pre><code>protected override void OnNavigatedTo(NavigationEventArgs e)\n{\n        InputPane.GetForCurrentView().Showing += onKeyboardShowing;\n        InputPane.GetForCurrentView().Hiding += onKeyboardHidding;\n}\n\nprivate void onKeyboardShowing(InputPane sender, InputPaneVisibilityEventArgs args)\n{\n    KeyboardVisible = true;\n}\n\nprivate void onKeyboardHidding(InputPane sender, InputPaneVisibilityEventArgs args)\n{\n\n    KeyboardVisible = false;\n}\n</code></pre>\n"}], "owner": {"reputation": 28335, "user_id": 853836, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fc609f2f90e5d5d6802b0201c15db5b6?s=128&d=identicon&r=PG", "display_name": "Addev", "link": "https://stackoverflow.com/users/853836/addev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1934, "favorite_count": 1, "accepted_answer_id": 28731375, "answer_count": 2, "score": 0, "last_activity_date": 1424905367, "creation_date": 1424902117, "question_id": 28730616, "link": "https://stackoverflow.com/questions/28730616/listen-the-show-hide-events-for-soft-keyboard-windows-8-1-rt-xaml", "title": "Listen the show / hide events for soft keyboard (Windows 8.1 RT, XAML)", "body": "<p>How can I know when the soft keyboard is shown/dismissed in my app or within a page?</p>\n\n<p>Found this snipplet in <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/hh972345.aspx?cs-save-lang=1&amp;cs-lang=csharp#code-snippet-1\" rel=\"nofollow\">THIS</a> article. But is not valid for WP 8.1 RT. How can I translate it or get a similar behavior?</p>\n\n<pre><code>public class MyApplication\n{\n    public MyApplication()\n    {\n        // Grab the input pane for the main application window and attach\n        // touch keyboard event handlers.\n        Windows.Foundation.Application.InputPane.GetForCurrentView().Showing\n            += new EventHandler(_OnInputPaneShowing);\n        Windows.Foundation.Application.InputPane.GetForCurrentView().Hiding\n            += new EventHandler(_OnInputPaneHiding);\n    }\n\n    private void _OnInputPaneShowing(object sender, IInputPaneVisibilityEventArgs eventArgs)\n    {\n        // If the size of this window is going to be too small, the app uses \n        // the Showing event to begin some element removal animations.\n        if (eventArgs.OccludedRect.Top &lt; 400)\n        {\n            _StartElementRemovalAnimations();\n\n            // Don't use framework scroll- or visibility-related \n            // animations that might conflict with the app's logic.\n            eventArgs.EnsuredFocusedElementInView = true;\n        }\n    }\n\n    private void _OnInputPaneHiding(object sender, IInputPaneVisibilityEventArgs eventArgs)\n    {\n        if (_ResetToDefaultElements())\n        {\n            eventArgs.EnsuredFocusedElementInView = true;\n        }\n    }\n\n    private void _StartElementRemovalAnimations()\n    {\n        // This function starts the process of removing elements \n        // and starting the animation.\n    }\n\n    private void _ResetToDefaultElements()\n    {\n        // This function resets the window's elements to their default state.\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424902245, "post_id": 28730598, "comment_id": 45747438, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/4205502/wpf-not-updating-textbox-while-in-progress\">WPF not updating textbox while in progress</a>"}, {"owner": {"reputation": 396, "user_id": 3677161, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dff11cb16ea8045ddc1187863d0e14ed?s=128&d=identicon&r=PG&f=1", "display_name": "Michel de Nijs", "link": "https://stackoverflow.com/users/3677161/michel-de-nijs"}, "edited": false, "score": 0, "creation_date": 1424902290, "post_id": 28730598, "comment_id": 45747452, "body": "What is the return type of <code>functionThatTakesASecondOrTwoToRun();</code>? Also use <code>x:Name</code> instead of <code>Name</code>. See <a href=\"https://msdn.microsoft.com/en-us/library/ms752290%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms752290%28v=vs.110%29.aspx</a> for reference."}, {"owner": {"reputation": 3570, "user_id": 612091, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ea573e8afddc40b7fca1125793049ef9?s=128&d=identicon&r=PG", "display_name": "spiderplant0", "link": "https://stackoverflow.com/users/612091/spiderplant0"}, "edited": false, "score": 0, "creation_date": 1424904053, "post_id": 28730598, "comment_id": 45748267, "body": "It is not a duplicate as the question refered to is for a particular case which I cant figure out how to convert to my case."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4508837, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k4rg_NfJHPI/AAAAAAAAAAI/AAAAAAAAFDs/c2c9H75jkf8/photo.jpg?sz=128", "display_name": "Ghali Sriparthu", "link": "https://stackoverflow.com/users/4508837/ghali-sriparthu"}, "is_accepted": false, "score": 0, "last_activity_date": 1424902699, "creation_date": 1424902699, "answer_id": 28730757, "question_id": 28730598, "link": "https://stackoverflow.com/questions/28730598/text-in-a-textbox-does-not-update-instantly-when-change-it-in-the-code-behind/28730757#28730757", "title": "Text in a TextBox does not update instantly when change it in the code-behind", "body": "<p>TextBox.Text Property, sets to the most recent value that is assigned. Hence You are not able to see the \"please wait...\". You may try the following way:\n1. Show the Please wait in a text box\n2. Hide the please wait text box once you have the value and show the value in another text box</p>\n\n<p>Method 2:\nYou can use System.Threading.Thread.Sleep(1000); in between the lines</p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 3570, "user_id": 612091, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ea573e8afddc40b7fca1125793049ef9?s=128&d=identicon&r=PG", "display_name": "spiderplant0", "link": "https://stackoverflow.com/users/612091/spiderplant0"}, "edited": false, "score": 0, "creation_date": 1424904948, "post_id": 28730783, "comment_id": 45748711, "body": "Wait, In one of the places it doesnt work because it reads the value of another text box and I get an exception when I try to access this other text box within <code>functionThatTakesASecondOrTwoToRun()</code>\t\t&quot;The calling thread cannot access this object because a different thread owns it.&quot;}\tSystem.Exception {System.InvalidOperationException}"}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "reply_to_user": {"reputation": 3570, "user_id": 612091, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ea573e8afddc40b7fca1125793049ef9?s=128&d=identicon&r=PG", "display_name": "spiderplant0", "link": "https://stackoverflow.com/users/612091/spiderplant0"}, "edited": false, "score": 0, "creation_date": 1424905008, "post_id": 28730783, "comment_id": 45748735, "body": "Get these values first outside of the task and pass them into the function"}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "reply_to_user": {"reputation": 3570, "user_id": 612091, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ea573e8afddc40b7fca1125793049ef9?s=128&d=identicon&r=PG", "display_name": "spiderplant0", "link": "https://stackoverflow.com/users/612091/spiderplant0"}, "edited": false, "score": 0, "creation_date": 1424905365, "post_id": 28730783, "comment_id": 45748874, "body": "No Problem, Your Welcome!"}], "tags": [], "owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "is_accepted": true, "score": 2, "last_activity_date": 1424902858, "creation_date": 1424902858, "answer_id": 28730783, "question_id": 28730598, "link": "https://stackoverflow.com/questions/28730598/text-in-a-textbox-does-not-update-instantly-when-change-it-in-the-code-behind/28730783#28730783", "title": "Text in a TextBox does not update instantly when change it in the code-behind", "body": "<p>The work needs to happen in a background thread, e.g</p>\n\n<pre><code>resultTextBox.Text = \"Please wait...\";   // this never appears\n\nTask.Factory.StartNew(() =&gt; functionThatTakesASecondOrTwoToRun())\n.ContinueWith((t) =&gt; resultTextBox.Text = t.Result, \nTaskScheduler.FromCurrentSynchronizationContext());\n</code></pre>\n\n<p>The UI is not getting a change to update as the the UI is blocking the thread.  TaskScheduler.FromCurrentSynchronizationContext() so the ContinueWith is executed on the UI thread and has access to the controls.</p>\n"}, {"tags": [], "owner": {"reputation": 162, "user_id": 4194502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sqy0h.jpg?s=128&g=1", "display_name": "jklingler", "link": "https://stackoverflow.com/users/4194502/jklingler"}, "is_accepted": false, "score": 2, "last_activity_date": 1453219024, "last_edit_date": 1453219024, "creation_date": 1445332721, "answer_id": 33232693, "question_id": 28730598, "link": "https://stackoverflow.com/questions/28730598/text-in-a-textbox-does-not-update-instantly-when-change-it-in-the-code-behind/33232693#33232693", "title": "Text in a TextBox does not update instantly when change it in the code-behind", "body": "<p>In addition to James Simpson's answer, here's another way:</p>\n\n<pre><code>resultTextBox.Text = \"Please wait...\";\nDispatcher.Invoke(() =&gt; {}, DispatcherPriority.Background);\nresult = functionThatTakesASecondOrTwoToRun();\nresultTextBox.Text = result;\n</code></pre>\n"}], "owner": {"reputation": 3570, "user_id": 612091, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ea573e8afddc40b7fca1125793049ef9?s=128&d=identicon&r=PG", "display_name": "spiderplant0", "link": "https://stackoverflow.com/users/612091/spiderplant0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5909, "favorite_count": 0, "accepted_answer_id": 28730783, "answer_count": 3, "score": 1, "last_activity_date": 1453219024, "creation_date": 1424902078, "question_id": 28730598, "link": "https://stackoverflow.com/questions/28730598/text-in-a-textbox-does-not-update-instantly-when-change-it-in-the-code-behind", "title": "Text in a TextBox does not update instantly when change it in the code-behind", "body": "<p>In the simplified code below, I want the text box to say \"Please wait..\" while the result is being fetched. However it never appears, instead the textBox only displays the result of <code>functionThatTakesASecondOrTwoToRun()</code></p>\n\n<p>xaml...</p>\n\n<pre><code>&lt;Button Name=\"readDutButton\" Content=\"Read DUT\" Click=\"readDutButton_Click\"/&gt;\n&lt;TextBox Name=\"resultTextBox\"/&gt;\n</code></pre>\n\n<p>code behind....</p>\n\n<pre><code>    private void readDutButton_Click(object sender, RoutedEventArgs e)\n    {\n        resultTextBox.Text = \"Please wait...\";   # this never appears\n\n        result = functionThatTakesASecondOrTwoToRun();\n\n        resultTextBox.Text = result;\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 7677, "user_id": 649922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6018c4ebb37ea82122c941aeaaab3b4b?s=128&d=identicon&r=PG", "display_name": "Ortiga", "link": "https://stackoverflow.com/users/649922/ortiga"}, "edited": false, "score": 0, "creation_date": 1424902729, "post_id": 28730555, "comment_id": 45747642, "body": "Setting <code>padding:0;</code> seems to fix it."}, {"owner": {"reputation": 5775, "user_id": 4607841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71cd701f6826481858ee299f68f3205a?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4607841/tom"}, "reply_to_user": {"reputation": 7677, "user_id": 649922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6018c4ebb37ea82122c941aeaaab3b4b?s=128&d=identicon&r=PG", "display_name": "Ortiga", "link": "https://stackoverflow.com/users/649922/ortiga"}, "edited": false, "score": 0, "creation_date": 1424903532, "post_id": 28730555, "comment_id": 45748026, "body": "i tried it but doesnt work for me"}, {"owner": {"reputation": 7677, "user_id": 649922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6018c4ebb37ea82122c941aeaaab3b4b?s=128&d=identicon&r=PG", "display_name": "Ortiga", "link": "https://stackoverflow.com/users/649922/ortiga"}, "edited": false, "score": 0, "creation_date": 1424903699, "post_id": 28730555, "comment_id": 45748113, "body": "Which browser are you testing on? Here, using latest Opera, it seems aligned."}, {"owner": {"reputation": 7677, "user_id": 649922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6018c4ebb37ea82122c941aeaaab3b4b?s=128&d=identicon&r=PG", "display_name": "Ortiga", "link": "https://stackoverflow.com/users/649922/ortiga"}, "edited": false, "score": 0, "creation_date": 1424904745, "post_id": 28730555, "comment_id": 45748626, "body": "Seems ok in chrome for me too. Can you give me an image of what`s unaligned? Or. better yet, an example in any site like jsfiddle.net"}, {"owner": {"reputation": 7677, "user_id": 649922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6018c4ebb37ea82122c941aeaaab3b4b?s=128&d=identicon&r=PG", "display_name": "Ortiga", "link": "https://stackoverflow.com/users/649922/ortiga"}, "edited": false, "score": 0, "creation_date": 1424904863, "post_id": 28730555, "comment_id": 45748665, "body": "I also recommend you inspect the element using chrome&#39;s inspect (right click -&gt; inspect element) tool to find any CSS rule that might be applying to it."}, {"owner": {"reputation": 5775, "user_id": 4607841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71cd701f6826481858ee299f68f3205a?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4607841/tom"}, "reply_to_user": {"reputation": 7677, "user_id": 649922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6018c4ebb37ea82122c941aeaaab3b4b?s=128&d=identicon&r=PG", "display_name": "Ortiga", "link": "https://stackoverflow.com/users/649922/ortiga"}, "edited": false, "score": 0, "creation_date": 1424948740, "post_id": 28730555, "comment_id": 45764863, "body": "Thanks for your suggestion. I tried but it didnt. I used an alternative approach of using the a href tag to do the postback instead of using html submit button and that sorted my issue. Thanks for your help Andre"}], "owner": {"reputation": 5775, "user_id": 4607841, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71cd701f6826481858ee299f68f3205a?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/4607841/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424901898, "creation_date": 1424901898, "question_id": 28730555, "link": "https://stackoverflow.com/questions/28730555/align-the-button-within-paragraph-tag", "title": "Align the button within paragraph tag", "body": "<p>I have written some inline css for the button to look like a link. The purpose of doing this is because I wanted to postback the form. The problem I am facing is with the formatting. Originally it was a href which I replaced with the button. The link is not wrapping with the text. Could somebody help. There is a lot of space before and after the button. </p>\n\n<pre><code>&lt;p&gt;\n  To transact through FundsNetwork you will firstly need to login to your &lt;input style=\"background-color: transparent; text-decoration: underline; border: none; white-space: normal; color: blue; cursor: pointer; \"  title=\"Link to FundsNetwork account manager. (opens in a new window)\" \n                                             type=submit  value=\"FundsNetwork Account Manager\" &gt;\n\n\n\n\n                                                To access this you will need your \n                                                FundsNetwork Customer Reference Number (a ten digit number beginning with \u20181\u2019 \n                                                that can found on your most recent statement from FundsNetwork) and pin. Please \n                                                call FundsNetwork on 0800 995511 if you need help logging in to the account manager.\n                                       &lt;/p&gt;\n</code></pre>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 7216, "user_id": 1030449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/4uEa5.png?s=128&g=1", "display_name": "Kalel Wade", "link": "https://stackoverflow.com/users/1030449/kalel-wade"}, "edited": false, "score": 3, "creation_date": 1424901566, "post_id": 28730466, "comment_id": 45747142, "body": "Missing runat=server on the label?"}, {"owner": {"reputation": 197, "user_id": 4080425, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/687576302ba489a615b579919b66438f?s=128&d=identicon&r=PG&f=1", "display_name": "user1989", "link": "https://stackoverflow.com/users/4080425/user1989"}, "reply_to_user": {"reputation": 7216, "user_id": 1030449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/4uEa5.png?s=128&g=1", "display_name": "Kalel Wade", "link": "https://stackoverflow.com/users/1030449/kalel-wade"}, "edited": false, "score": 0, "creation_date": 1424901755, "post_id": 28730466, "comment_id": 45747233, "body": "@KalelWade Still getting the same error."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1424901777, "post_id": 28730466, "comment_id": 45747247, "body": "when you debug the code on after this line <code>Label label = e.Item.FindControl(&quot;lbl1&quot;) as Label;</code> what is the value of <code>label</code> if it&#39;s null or empty then you need to add the &#39;runat=&quot;server&quot;` attribute to the <code>lbl1</code> object in your aspx markup best to check out the example here on this msdn documentation -<a href=\"https://msdn.microsoft.com/en-us/library/31hxzsdw(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=csharp#code-snippet-2\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 197, "user_id": 4080425, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/687576302ba489a615b579919b66438f?s=128&d=identicon&r=PG&f=1", "display_name": "user1989", "link": "https://stackoverflow.com/users/4080425/user1989"}, "edited": false, "score": 0, "creation_date": 1424901868, "post_id": 28730466, "comment_id": 45747292, "body": "It is null, but I added runat=&quot;server&quot;, still its giving the same error."}, {"owner": {"reputation": 7216, "user_id": 1030449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/4uEa5.png?s=128&g=1", "display_name": "Kalel Wade", "link": "https://stackoverflow.com/users/1030449/kalel-wade"}, "edited": false, "score": 0, "creation_date": 1424901968, "post_id": 28730466, "comment_id": 45747338, "body": "Did you click save and rebuild? Figured I would ask, sometimes those simple things are missed."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1424901978, "post_id": 28730466, "comment_id": 45747343, "body": "you need to use <code>&lt;asp:label&gt;</code> look at the correct answer provided below or read the msdn documentation they provide an exact example.things of this nature should be googled"}], "answers": [{"comments": [{"owner": {"reputation": 3012, "user_id": 3101082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1WxPj.jpg?s=128&g=1", "display_name": "dub stylee", "link": "https://stackoverflow.com/users/3101082/dub-stylee"}, "edited": false, "score": 0, "creation_date": 1424901907, "post_id": 28730547, "comment_id": 45747311, "body": "I was just about to post the <code>&lt;asp:Label...&gt;</code>, beat me to it!"}, {"owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "reply_to_user": {"reputation": 3012, "user_id": 3101082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1WxPj.jpg?s=128&g=1", "display_name": "dub stylee", "link": "https://stackoverflow.com/users/3101082/dub-stylee"}, "edited": false, "score": 0, "creation_date": 1424901928, "post_id": 28730547, "comment_id": 45747321, "body": "HtmlGenericControl exists in System.Web.UI.HtmlControls NameSpace"}, {"owner": {"reputation": 197, "user_id": 4080425, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/687576302ba489a615b579919b66438f?s=128&d=identicon&r=PG&f=1", "display_name": "user1989", "link": "https://stackoverflow.com/users/4080425/user1989"}, "edited": false, "score": 0, "creation_date": 1424902436, "post_id": 28730547, "comment_id": 45747514, "body": "Thank you, but suppose I want to hide the full td with id = &quot;td1&quot; (see the code), then what should I do ?"}, {"owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "edited": false, "score": 0, "creation_date": 1424902845, "post_id": 28730547, "comment_id": 45747698, "body": "have a look to my second answer and if it helps you mark it as a correct one .  thank you :)"}, {"owner": {"reputation": 17007, "user_id": 4188450, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Jwayq.jpg?s=128&g=1", "display_name": "Arunprasanth K V", "link": "https://stackoverflow.com/users/4188450/arunprasanth-k-v"}, "edited": false, "score": 0, "creation_date": 1425891567, "post_id": 28730547, "comment_id": 46131350, "body": "need double quotes for server tag  like runat=&quot;server&quot;"}, {"owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "reply_to_user": {"reputation": 17007, "user_id": 4188450, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Jwayq.jpg?s=128&g=1", "display_name": "Arunprasanth K V", "link": "https://stackoverflow.com/users/4188450/arunprasanth-k-v"}, "edited": false, "score": 0, "creation_date": 1425891753, "post_id": 28730547, "comment_id": 46131442, "body": "@ArunprasanthKV. Done again :)"}, {"owner": {"reputation": 17007, "user_id": 4188450, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Jwayq.jpg?s=128&g=1", "display_name": "Arunprasanth K V", "link": "https://stackoverflow.com/users/4188450/arunprasanth-k-v"}, "edited": false, "score": 0, "creation_date": 1425891764, "post_id": 28730547, "comment_id": 46131449, "body": "also make a not if we use  label.Visible = false; in server side then we can&#39;t visible it in client side. so it is better to use labelid.Attributes.Add(&quot;style&quot;, &quot;display:none&quot;);"}, {"owner": {"reputation": 17007, "user_id": 4188450, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Jwayq.jpg?s=128&g=1", "display_name": "Arunprasanth K V", "link": "https://stackoverflow.com/users/4188450/arunprasanth-k-v"}, "edited": false, "score": 0, "creation_date": 1425891793, "post_id": 28730547, "comment_id": 46131463, "body": "Ok now it&#39;s looks fine"}, {"owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "reply_to_user": {"reputation": 17007, "user_id": 4188450, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Jwayq.jpg?s=128&g=1", "display_name": "Arunprasanth K V", "link": "https://stackoverflow.com/users/4188450/arunprasanth-k-v"}, "edited": false, "score": 0, "creation_date": 1425891969, "post_id": 28730547, "comment_id": 46131564, "body": "Yes @ArunprasanthKV , i don&#39;t need to generate HTML code client side that&#39;s why i used Visibule attribute server side :)"}, {"owner": {"reputation": 17007, "user_id": 4188450, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Jwayq.jpg?s=128&g=1", "display_name": "Arunprasanth K V", "link": "https://stackoverflow.com/users/4188450/arunprasanth-k-v"}, "edited": false, "score": 0, "creation_date": 1425892311, "post_id": 28730547, "comment_id": 46131743, "body": "Ok then i have a doubt , if you don&#39;t need to generate HTML code client side then what is the significance of that label ? why we need a label control in that page ??"}, {"owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "reply_to_user": {"reputation": 17007, "user_id": 4188450, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Jwayq.jpg?s=128&g=1", "display_name": "Arunprasanth K V", "link": "https://stackoverflow.com/users/4188450/arunprasanth-k-v"}, "edited": false, "score": 0, "creation_date": 1425893593, "post_id": 28730547, "comment_id": 46132427, "body": "@ArunprasanthKV. i m working on a project where webUI control generation depends on user profile (Manager,salesman,account manager...)"}], "tags": [], "owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "is_accepted": false, "score": 6, "last_activity_date": 1425891728, "last_edit_date": 1425891728, "creation_date": 1424901876, "answer_id": 28730547, "question_id": 28730466, "link": "https://stackoverflow.com/questions/28730466/hiding-label-at-runtime/28730547#28730547", "title": "Hiding Label at Runtime", "body": "<p>transform your label to asp:Label with a runat=\"server\"</p>\n\n<pre><code> &lt;asp:label id=\"lbl1\" runat=\"server\"&gt;\n</code></pre>\n\n<p>Or keep it as you wrote and add runat=\"server\" and in your codebihind</p>\n\n<pre><code>HtmlGenericControl label = e.Item.FindControl(\"lbl1\") as HtmlGenericControl;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "is_accepted": true, "score": 1, "last_activity_date": 1424902759, "creation_date": 1424902759, "answer_id": 28730769, "question_id": 28730466, "link": "https://stackoverflow.com/questions/28730466/hiding-label-at-runtime/28730769#28730769", "title": "Hiding Label at Runtime", "body": "<p>if you are talking about td</p>\n\n<p>in your aspx or ascx </p>\n\n<pre><code>&lt;td id=\"tdid\" runat=\"server\"&gt;\n</code></pre>\n\n<p>code behind</p>\n\n<pre><code>HtmlTableCell td=e.Item.FindControl(\"tdid\") as HtmlTableCell ;\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 4080425, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/687576302ba489a615b579919b66438f?s=128&d=identicon&r=PG&f=1", "display_name": "user1989", "link": "https://stackoverflow.com/users/4080425/user1989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 28730769, "answer_count": 2, "score": 1, "last_activity_date": 1425891728, "creation_date": 1424901484, "last_edit_date": 1592644375, "question_id": 28730466, "link": "https://stackoverflow.com/questions/28730466/hiding-label-at-runtime", "title": "Hiding Label at Runtime", "body": "<p>I am trying to hide a label inside a repeater.</p>\n<pre><code>&lt;td&gt;\n   &lt;div&gt;\n      &lt;asp:Repeater ID=&quot;rpt1&quot; runat=&quot;server&quot; \n                    OnItemDataBound=&quot;rpt1_ItemDataBound&quot;&gt;\n            &lt;HeaderTemplate&gt;\n               &lt;table&gt;\n                  &lt;tr&gt;\n                     &lt;td&gt;\n                        &lt;div&gt;\n                           &lt;label id=&quot;lbl1&quot;  runat=&quot;server&quot;&gt;\n                              &lt;b&gt;Project&lt;/b&gt;\n                            &lt;/label&gt;\n                        &lt;/div&gt;\n                     &lt;/td&gt;\n                  &lt;/tr&gt;\n               &lt;/table&gt;\n            &lt;/HeaderTemplate&gt;\n        &lt;/asp:Repeater&gt;\n    &lt;/div&gt;\n&lt;/td&gt;\n</code></pre>\n<p>I want to hide Label lbl1 dynamically.</p>\n<pre><code>protected void rpt1_ItemDataBound(object sender, RepeaterItemEventArgs e)\n    {\n        if (e.Item.ItemType == ListItemType.Header)\n        {\n            //IT COMES HERE\n            Label label = e.Item.FindControl(&quot;lbl1&quot;) as Label;\n            label.Visible = false;\n            // ERROR: OBJECT REFERENCE NOT SET TO AN INSTANCE OF AN OBJ\n        }\n    }\n</code></pre>\n<p>Here, when I try to debug the code, it comes inside the loop but gives me object reference not set to an instance of an object error.</p>\n<p><strong>UPDATE</strong></p>\n<p>If I Try,</p>\n<pre><code>  HtmlGenericControl label = e.Item.FindControl(&quot;lbl1&quot;) as HtmlGenericControl;\n            label.Visible = false;\n</code></pre>\n<p>It works</p>\n"}, {"tags": ["c#", "office-automation"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1424901662, "post_id": 28730464, "comment_id": 45747187, "body": "There is no Word 2005 or Word 2008."}, {"owner": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 0, "creation_date": 1424902109, "post_id": 28730464, "comment_id": 45747394, "body": "If I had to solve this, I would use something like <a href=\"http://www.aspose.com/.net/word-component.aspx\" rel=\"nofollow noreferrer\">Aspose.Words</a> (costs certain amount of money!) to render the Word document to images and display the images in a picture box control or similar."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 1, "creation_date": 1424902150, "post_id": 28730464, "comment_id": 45747408, "body": "@UweKeim yup, I use Aspose.Words for my own projects and I&#39;ve found it to be a very capable system, if expensive."}, {"owner": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1424902314, "post_id": 28730464, "comment_id": 45747460, "body": "@Dai There is also <a href=\"http://www.e-iceblue.com/Introduce/word-viewer-net-introduce.html#.VO5Ibqi5ZBc\" rel=\"nofollow noreferrer\">Spire.Doc</a> with similar functionality and probably a few bucks less, altough I&#39;ve never tried myself so I don&#39;t know the quality of their Word renderer."}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 2, "creation_date": 1424902325, "post_id": 28730464, "comment_id": 45747463, "body": "What are you trying to accomplish? Just hosting Word in a form?"}, {"owner": {"reputation": 754, "user_id": 804018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e06f036f3791979a5eb13a387b5bb?s=128&d=identicon&r=PG", "display_name": "qwerty13579", "link": "https://stackoverflow.com/users/804018/qwerty13579"}, "edited": false, "score": 0, "creation_date": 1424902489, "post_id": 28730464, "comment_id": 45747536, "body": "&gt; Just hosting Word in a form? - yes"}], "answers": [{"comments": [{"owner": {"reputation": 754, "user_id": 804018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e06f036f3791979a5eb13a387b5bb?s=128&d=identicon&r=PG", "display_name": "qwerty13579", "link": "https://stackoverflow.com/users/804018/qwerty13579"}, "edited": false, "score": 0, "creation_date": 1424902377, "post_id": 28730577, "comment_id": 45747488, "body": "Thanks for the help, I hope MS realizes this really puts developers in a bad spot.  They give us an easy way to deliver cool functionality to our users, then they break it when the user updates.  Now the user expects functionality that MS has prevented us from using for no good reason."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "reply_to_user": {"reputation": 754, "user_id": 804018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e06f036f3791979a5eb13a387b5bb?s=128&d=identicon&r=PG", "display_name": "qwerty13579", "link": "https://stackoverflow.com/users/804018/qwerty13579"}, "edited": false, "score": 0, "creation_date": 1424903943, "post_id": 28730577, "comment_id": 45748214, "body": "@qwerty13579 I sympathize, however I disagree that the change was done &quot;for no good reason&quot; - I&#39;ve already cited usability and platform concerns as the basis for such a decision. It is the responsibility of developers and system-integrators to test new versions of software (such as Office) before deploying them to identify issues like these (and develop alternative solutions for them) before users do."}, {"owner": {"reputation": 754, "user_id": 804018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e06f036f3791979a5eb13a387b5bb?s=128&d=identicon&r=PG", "display_name": "qwerty13579", "link": "https://stackoverflow.com/users/804018/qwerty13579"}, "edited": false, "score": 1, "creation_date": 1424907353, "post_id": 28730577, "comment_id": 45749663, "body": "Dai - as a developer, I have no control over when a user updates his version of Office, then his software stops working.  A core tenant of compatibility is not taking away functionality, and for what this functionality was typically used for (simply displaying an Office doc to a user) there were no usability problems"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 3, "last_activity_date": 1424901993, "creation_date": 1424901993, "answer_id": 28730577, "question_id": 28730464, "link": "https://stackoverflow.com/questions/28730464/how-do-i-open-a-word-2013-document-in-a-webbrowser-control-on-a-c-winform/28730577#28730577", "title": "How do I open a Word 2013 document in a WebBrowser control on a C# Winform?", "body": "<p>(Disclaimer: While I work for Microsoft and on Internet Explorer, I have no special knowledge in this area)</p>\n\n<p>I believe the problem is because Office 2013 no-longer supports being hosted by Internet Explorer[citation needed!]. This is for a variety of reasons, but I think because the vision we (as a company) held for OLE and COM never really worked-out and it generally presents a poor user-experience (remember trying to edit an embedded Excel spreadsheet in a Word document after resizing it?).</p>\n\n<p>I remember that Office 2003 did support being hosted by other processes (such as Internet Explorer and even Visual Studio 6.0) but since Office 2007 I believe they disabled that functionality by default and you had to jump through hoops to get it to work, and then they disabled it completely in 2013. <strong>I think</strong>, do not take this as authoritative information!</p>\n\n<p>If I'm wrong (which I very well might be) the problem might be because you have a 64-bit process (e.g. <code>AnyCPU</code> in .NET on an x64 OS) but the 32-bit version of Office installed, you cannot mix 32-bit and 64-bit binaries in the same process, so it's possible that it would work, but fails in this because because it's the wrong ISA.</p>\n"}], "owner": {"reputation": 754, "user_id": 804018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e06f036f3791979a5eb13a387b5bb?s=128&d=identicon&r=PG", "display_name": "qwerty13579", "link": "https://stackoverflow.com/users/804018/qwerty13579"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424901993, "creation_date": 1424901474, "last_edit_date": 1424901942, "question_id": 28730464, "link": "https://stackoverflow.com/questions/28730464/how-do-i-open-a-word-2013-document-in-a-webbrowser-control-on-a-c-winform", "title": "How do I open a Word 2013 document in a WebBrowser control on a C# Winform?", "body": "<p>In my C# Winforms application, I have a WebBrowser control in which I want to show a Word document.  I display the document by calling\n<code>webBrowser1.Navigate(myDocName)</code>.</p>\n\n<p>This works fine for documents through Word 2003.    </p>\n\n<p>For Word 2007 and 2010, this caused Word to open the document in a newly created instance of Word, not on the Winform containing the WebBrowser.  I was able to fix this by adding the following registry entries on the client machine (note that this can be done for Excel as well - the value to write is <code>(int)0x80000A00</code>, and the classes are <code>\\Excel.Sheet</code> in place of <code>\\Word.Document</code>):</p>\n\n<pre><code>int wordFlagValue = (int)0x80000024;\n\nCommon.SaveToRegistryLocalMachine(@\"SOFTWARE\\Classes\\Word.Document.8\", \"BrowserFlags\", wordFlagValue);\n\nCommon.SaveToRegistryLocalMachine(@\"SOFTWARE\\Classes\\Word.Document.12\", \"BrowserFlags\", wordFlagValue);\n</code></pre>\n\n<p>Note: <code>Common.SaveToRegistryLocalMachine()</code> is simply a wrapper function to write a registry entry under HKEY_LOCAL_MACHINE</p>\n\n<p>The problem is that some clients now have Word 2013 installed, and the new Word instance problem appeared again.  I tried adding the following registry entries (to reflect the new versions of Word), but to no effect:</p>\n\n<pre><code>Common.SaveToRegistryLocalMachine(@\"SOFTWARE\\Classes\\Word.Document.14\", \"BrowserFlags\", wordFlagValue);\nCommon.SaveToRegistryLocalMachine(@\"SOFTWARE\\Classes\\Word.Document.15\", \"BrowserFlags\", wordFlagValue);   \n</code></pre>\n\n<p>Any ideas on how to work around this problem?</p>\n"}, {"tags": ["c#", "wpf", "mahapps.metro"], "comments": [{"owner": {"reputation": 13601, "user_id": 920384, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1aea0f4dba1906e759377308c0df08f6?s=128&d=identicon&r=PG", "display_name": "punker76", "link": "https://stackoverflow.com/users/920384/punker76"}, "edited": false, "score": 0, "creation_date": 1424948944, "post_id": 28730406, "comment_id": 45764977, "body": "mh, downloaded my example, compiled it, and it works for me..."}, {"owner": {"reputation": 1, "user_id": 4605859, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cu5Ogy8TR30/AAAAAAAAAAI/AAAAAAAAAEE/DISQze3hdR4/photo.jpg?sz=128", "display_name": "sdonecker23", "link": "https://stackoverflow.com/users/4605859/sdonecker23"}, "reply_to_user": {"reputation": 13601, "user_id": 920384, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1aea0f4dba1906e759377308c0df08f6?s=128&d=identicon&r=PG", "display_name": "punker76", "link": "https://stackoverflow.com/users/920384/punker76"}, "edited": false, "score": 0, "creation_date": 1424969215, "post_id": 28730406, "comment_id": 45778168, "body": "Thank you for the response punker76; when you compile do you still see the dll files in your bin\\debug directory? The references are set to &quot;Build Action: Embedded Resource&quot; and &quot;Copy to Output: Do not copy&quot;, yet they show up in the debug directory when the project gets compiled. P.s. How did you add the references to the dll&#39;s as a link in your demo project?"}], "owner": {"reputation": 1, "user_id": 4605859, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-cu5Ogy8TR30/AAAAAAAAAAI/AAAAAAAAAEE/DISQze3hdR4/photo.jpg?sz=128", "display_name": "sdonecker23", "link": "https://stackoverflow.com/users/4605859/sdonecker23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 652, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424901251, "creation_date": 1424901251, "question_id": 28730406, "link": "https://stackoverflow.com/questions/28730406/issue-with-bundling-dlls-in-mahapps-metro-simple-demo-sample-project", "title": "Issue with bundling DLLs in MahApps.Metro.Simple.Demo sample project", "body": "<p>Here is the sample project I'm using on GitHub: <a href=\"https://github.com/punker76/MahApps.Metro.Simple.Demo\" rel=\"nofollow\">MahApps.Metro.Simple.Demo</a></p>\n\n<p>Here is the original question I found on StackOverflow: <a href=\"https://stackoverflow.com/questions/21725420/how-to-bundle-mahapps-metro-into-single-exe/22119351#22119351?newreg=c61ebcc0d57548d88fc2a4f02837c48b\">How to bundle MahApps.Metro into single exe</a></p>\n\n<p>My goal is to be able to run the compiled EXE file on another computer without including the <em>MahApps.Metro.dll</em> and <em>System.Windows.Interactivity.dll</em> files alongside the executable.</p>\n\n<p>I am using the VisualStudio Professional 2013 IDE and have not modified the demo project aside from installing the MahApps.Metro NuGet package.</p>\n\n<p>Here are the exact steps I'm currently attempting:</p>\n\n<ol>\n<li>Run the debugger and make a copy of the compiled executable from the \"project name\"\\bin\\degbug directory.</li>\n<li>Place the copy of the compiled executable file on another computer and attempt to run it.</li>\n</ol>\n\n<p>The application fails to run and the <em>System.Windows.Markup.XamlParseException</em> error gets recorded in the Windows Application log.</p>\n\n<p>However, when I copy the previously mentioned DLLs and place them within the same directory alongside the executable file it runs successfully.</p>\n\n<p>Am I not compiling the project correctly to get the desired result?</p>\n\n<p>I've verified all of the items posted by punker76, in the response to the previously linked question, and everything matches.</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "google-chrome", "cookies"], "answers": [{"comments": [{"owner": {"reputation": 1391, "user_id": 480848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/315121a173b6235d773a41ada04900d9?s=128&d=identicon&r=PG", "display_name": "Valchris", "link": "https://stackoverflow.com/users/480848/valchris"}, "edited": false, "score": 0, "creation_date": 1424906858, "post_id": 28731663, "comment_id": 45749489, "body": "Important note: When I have fiddler turned on, I see totally different results, the cookie operates as expected. I am also on Win 10, will investigate that further"}, {"owner": {"reputation": 21, "user_id": 4137496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa4b189ae62300f9857bc17de23693cc?s=128&d=identicon&r=PG", "display_name": "Patrick Roza", "link": "https://stackoverflow.com/users/4137496/patrick-roza"}, "reply_to_user": {"reputation": 1391, "user_id": 480848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/315121a173b6235d773a41ada04900d9?s=128&d=identicon&r=PG", "display_name": "Valchris", "link": "https://stackoverflow.com/users/480848/valchris"}, "edited": false, "score": 1, "creation_date": 1424907908, "post_id": 28731663, "comment_id": 45749835, "body": "I can confirm, it is indeed when Fiddler is in the mix it changes up."}, {"owner": {"reputation": 21, "user_id": 4137496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa4b189ae62300f9857bc17de23693cc?s=128&d=identicon&r=PG", "display_name": "Patrick Roza", "link": "https://stackoverflow.com/users/4137496/patrick-roza"}, "reply_to_user": {"reputation": 1391, "user_id": 480848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/315121a173b6235d773a41ada04900d9?s=128&d=identicon&r=PG", "display_name": "Valchris", "link": "https://stackoverflow.com/users/480848/valchris"}, "edited": false, "score": 0, "creation_date": 1424910573, "post_id": 28731663, "comment_id": 45750654, "body": "As a dirty workaround in debug/local mode I came up with: var cookieHeader = HttpContext.Current.Request.Headers[&quot;Cookie&quot;]; if (cookieHeader != null)    HttpContext.Current.Request.Headers.Set(&quot;Cookie&quot;, cookieHeader.Replace(&quot;,&quot;, &quot;;&quot;));"}], "tags": [], "owner": {"reputation": 21, "user_id": 4137496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa4b189ae62300f9857bc17de23693cc?s=128&d=identicon&r=PG", "display_name": "Patrick Roza", "link": "https://stackoverflow.com/users/4137496/patrick-roza"}, "is_accepted": false, "score": 0, "last_activity_date": 1424906527, "creation_date": 1424906527, "answer_id": 28731663, "question_id": 28730402, "link": "https://stackoverflow.com/questions/28730402/asp-net-cookies-missing-in-httpcontext-request-cookies-comma-vs-semi-colon-sepa/28731663#28731663", "title": "ASP.NET cookies missing in HttpContext.Request.Cookies. Comma vs semi-colon separated cookies from Chrome/IE", "body": "<p>I am noticing odd behavior like this right now too.\nBut looking at Fiddler, the cookie list is actually sent as ';' separated..</p>\n\n<p>I am on Windows 10. I've tried rolling back my commit history to several months back but keep running into the issue.</p>\n\n<p>The issue seems to especially happen on SSL. Can it be OS/WindowsUpdate related?</p>\n"}], "owner": {"reputation": 1391, "user_id": 480848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/315121a173b6235d773a41ada04900d9?s=128&d=identicon&r=PG", "display_name": "Valchris", "link": "https://stackoverflow.com/users/480848/valchris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1196, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1424906794, "creation_date": 1424901249, "last_edit_date": 1424906794, "question_id": 28730402, "link": "https://stackoverflow.com/questions/28730402/asp-net-cookies-missing-in-httpcontext-request-cookies-comma-vs-semi-colon-sepa", "title": "ASP.NET cookies missing in HttpContext.Request.Cookies. Comma vs semi-colon separated cookies from Chrome/IE", "body": "<p>I'm observing an issue where I make a request to my server and inspect the <code>HttpContext.Request.Cookies</code> collection to be different in Chrome vs IE.</p>\n\n<p>My process is as follows:</p>\n\n<ol>\n<li>Launch a new inPrivate browser for IE, go to site url</li>\n<li>Observe  <code>HttpContext.Request.Cookies</code> to have <strong>three</strong> values, <em>siteLang</em>, <em>siteDir</em>, <em>isNative</em></li>\n<li><p>Observe the value of each cookie to respectively be:</p>\n\n<ul>\n<li><code>HttpContext.Request.Cookies[\"siteDir\"].Value</code>  == \"ltr\"</li>\n<li><code>HttpContext.Request.Cookies[\"siteLang\"].Value</code> == \"en-US\"</li>\n<li><code>HttpContext.Request.Cookies[\"isNative\"].Value</code> == true</li>\n</ul></li>\n<li><p>Launch a new incognito browser for Chrome, go to site url</p></li>\n<li>Observe <code>HttpContext.Request.Cookies</code> to have <strong>one</strong> value, <em>siteDir</em></li>\n<li>Observe the value of <code>HttpContext.Request.Cookies[\"siteDir\"].Value</code> to be <em>\"ltr, siteLang=en-US, isNative=true\"</em></li>\n</ol>\n\n<hr>\n\n<p>I have also observed <code>HttpContext.Request.Headers[\"Cookie\"]</code> to contain the following values dependent on browser:</p>\n\n<ul>\n<li><p>siteLang=en-US; siteDir=ltr; isNative=true       // IE</p></li>\n<li><p>siteDir=ltr, siteLang=en-US, isNative=true       // Chrome</p></li>\n</ul>\n\n<hr>\n\n<p>So it appears Chrome is comma separating my cookies and IE is using semi-colons and Mvc can't figure out how to deal with the commas. Has anyone else seen this? I feel like this issue should be incredibly widespread if my diagnosis is correct. Any input is greatly appreciated.</p>\n\n<h2>EDIT</h2>\n\n<p>I've looked into the ASP.NET source and found the following code snippet in HttpRequest.cs (found here: [<a href=\"http://referencesource.microsoft.com/#System.Web/HttpRequest.cs][1]\" rel=\"nofollow\">http://referencesource.microsoft.com/#System.Web/HttpRequest.cs][1]</a>):</p>\n\n<pre><code>while (i &lt; l) {\n    // find next ';' (don't look to ',' as per 91884)\n    j = i;\n    while (j &lt; l) {\n        ch = s[j];\n        if (ch == ';')\n            break;\n        j++;\n    }\n    // create cookie form string\n    ...{continued}\n</code></pre>\n\n<p>Any ideas how I get information on 91884 to understand why they are ignoring comma separated cookies?</p>\n"}, {"tags": ["c#", "elasticsearch", "search-engine"], "comments": [{"owner": {"reputation": 1163, "user_id": 4520320, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/7kU8N.png?s=128&g=1", "display_name": "Ako", "link": "https://stackoverflow.com/users/4520320/ako"}, "edited": false, "score": 0, "creation_date": 1424901295, "post_id": 28730306, "comment_id": 45746998, "body": "What is your goal that you try to accomplish with indexing whole database ?"}, {"owner": {"reputation": 4218, "user_id": 855229, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9dbb8de494086864cc45b89113ed5b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor Lova", "link": "https://stackoverflow.com/users/855229/viktor-lova"}, "edited": false, "score": 0, "creation_date": 1424902124, "post_id": 28730306, "comment_id": 45747402, "body": "If u already have data you can&#39;t index it without querying all table (you can perform something like index with pagination - firstly index decords 0-20, then 20-40 and so on). Let\u2019s try to imagine that you just started project and you have no data. You want to keep elasticsearch and sql store sync. So you must handle each update. You can do that with CQRS pattern, or manually add in your repositories logic to sync with elasticsearch (to reduce overhead caused by work with elasticsearch you can create in memory queue and use rabbitmq to balance indexing between different instances of your app)"}, {"owner": {"reputation": 67, "user_id": 4607785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf5f53aacdb1c74b9c8e4b93e31f5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/4607785/oscar"}, "edited": false, "score": 0, "creation_date": 1424902168, "post_id": 28730306, "comment_id": 45747411, "body": "Mi goal is to have all information in the database indexed in the search Engine ready, to retrieve the information whenever I want search for objects. As far as I know i can not search for an specific object if this is not indexed, for example a Person."}, {"owner": {"reputation": 4218, "user_id": 855229, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9dbb8de494086864cc45b89113ed5b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor Lova", "link": "https://stackoverflow.com/users/855229/viktor-lova"}, "edited": false, "score": 0, "creation_date": 1424902510, "post_id": 28730306, "comment_id": 45747546, "body": "Also you can create sql trigger on each update of your table.  In this trigger you will write to another table info about updated entity (table + id). But this is slow"}, {"owner": {"reputation": 4218, "user_id": 855229, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9dbb8de494086864cc45b89113ed5b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor Lova", "link": "https://stackoverflow.com/users/855229/viktor-lova"}, "edited": false, "score": 0, "creation_date": 1424902573, "post_id": 28730306, "comment_id": 45747578, "body": "Also elasticsearch is not just a search. It is NoSql solution and you can use it as primary store"}, {"owner": {"reputation": 67, "user_id": 4607785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf5f53aacdb1c74b9c8e4b93e31f5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/4607785/oscar"}, "edited": false, "score": 0, "creation_date": 1425092332, "post_id": 28730306, "comment_id": 45833159, "body": "Thanks for the info!"}], "owner": {"reputation": 67, "user_id": 4607785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf5f53aacdb1c74b9c8e4b93e31f5e6?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar", "link": "https://stackoverflow.com/users/4607785/oscar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424901724, "creation_date": 1424900895, "last_edit_date": 1424901724, "question_id": 28730306, "link": "https://stackoverflow.com/questions/28730306/indexing-the-whole-database", "title": "Indexing the whole database", "body": "<p>I would like to know if it is possible to index a whole relational database without indexing all records and tables at once, and if so, how can I would be able to do this?</p>\n\n<p>For example, I already have the database, but I do not want to query records manually over all tables of my database and index them all. I was thinking in implementing an event engine which every time a record is used, this is added, deleted or updated in the index until the full database is completed indexing, but this is just something I do not know how to do.</p>\n\n<p>I am using nest(elasticSearch) and c#.</p>\n"}, {"tags": ["c#", "mathematical-expressions"], "comments": [{"owner": {"reputation": 2943, "user_id": 2250588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67a4afaa3e67ed31d90400f2eb9a22a?s=128&d=identicon&r=PG", "display_name": "iheanyi", "link": "https://stackoverflow.com/users/2250588/iheanyi"}, "edited": false, "score": 0, "creation_date": 1424900943, "post_id": 28730241, "comment_id": 45746826, "body": "I don&#39;t understand what you&#39;re asking. Do you not know how to compute LINEST with zero-intercept? Or do you have a specific problem implementing the method you&#39;re using in C#? If the former, your question is better sourced in mathematics SE. If the latter, you should provide details on your implementation, preferably with code, and indicate where you&#39;re having problems."}], "answers": [{"tags": [], "owner": {"reputation": 5000, "user_id": 3856907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ub3wd.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3856907/erik"}, "is_accepted": true, "score": -1, "last_activity_date": 1424901459, "last_edit_date": 1424901459, "creation_date": 1424900800, "answer_id": 28730277, "question_id": 28730241, "link": "https://stackoverflow.com/questions/28730241/how-do-i-calculate-linest-in-c-with-a-zero-intercept/28730277#28730277", "title": "How do I calculate LINEST in C# with a zero intercept?", "body": "<p>This is a math question, not a coding question. <a href=\"http://en.wikipedia.org/wiki/Simple_linear_regression#Linear_regression_without_the_intercept_term\" rel=\"nofollow\">Use linear regression without the intercept term.</a></p>\n\n<hr>\n\n<pre><code>    public static LineSpec LinestConst(IList&lt;double&gt; yValues, IList&lt;double&gt; xValues)\n    {\n        var yAvg = yValues.Sum() / yValues.Count;\n        var xAvg = xValues.Sum() / xValues.Count;\n\n        double upperSum = 0;\n        double lowerSum = 0;\n        for (var i = 0; i &lt; yValues.Count; i++)\n        {\n            upperSum += (xValues[i] * yValues[i] );\n            lowerSum += (xValues[i] * xValues[i] );\n        }\n\n        var m = upperSum / lowerSum;\n        var b = 0;\n        return new LineSpec() { Slope = m, Intercept = b };\n    }\n</code></pre>\n"}], "owner": {"reputation": 63245, "user_id": 5274, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/lSmPG.jpg?s=128&g=1", "display_name": "Jonathan Allen", "link": "https://stackoverflow.com/users/5274/jonathan-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 28730277, "answer_count": 1, "score": -2, "last_activity_date": 1424901459, "creation_date": 1424900618, "question_id": 28730241, "link": "https://stackoverflow.com/questions/28730241/how-do-i-calculate-linest-in-c-with-a-zero-intercept", "title": "How do I calculate LINEST in C# with a zero intercept?", "body": "<p>The normal Linest is easy, but I don't know how to \"b is set equal to 0 and the m-values are adjusted to fit y = mx.\"</p>\n\n<pre><code>static class Program\n{\n    static void Main(string[] args)\n    {\n        var yValues = new double[] { 1, 9, 5, 7 };\n        var xValues = new double[] { 0, 4, 2, 3 };\n\n\n        var noConst = Linest(yValues, xValues);\n        Console.WriteLine(\"m = {0}, b = {1}\", noConst.Slope, noConst.Intercept);\n\n\n    }\n\n    public static LineSpec Linest(IList&lt;double&gt; yValues, IList&lt;double&gt; xValues)\n    {\n        var yAvg = yValues.Sum() / yValues.Count;\n        var xAvg = xValues.Sum() / xValues.Count;\n\n        double upperSum = 0;\n        double lowerSum = 0;\n        for (var i = 0; i &lt; yValues.Count; i++)\n        {\n            upperSum += (xValues[i] - xAvg) * (yValues[i] - yAvg);\n            lowerSum += (xValues[i] - xAvg) * (xValues[i] - xAvg);\n        }\n\n        var m = upperSum / lowerSum;\n        var b = yAvg - m * xAvg;\n        return new LineSpec() { Slope = m, Intercept = b };\n    }\n\n}\n\nstruct LineSpec\n{\n    public double Slope { get; set; }\n    public double Intercept { get; set; }\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml", "windows-runtime", "windows-store-apps"], "answers": [{"tags": [], "owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "is_accepted": false, "score": 0, "last_activity_date": 1432720028, "last_edit_date": 1432720028, "creation_date": 1432710577, "answer_id": 30475480, "question_id": 28730192, "link": "https://stackoverflow.com/questions/28730192/iobservablevectort-in-windows-store-apps-cannot-be-used-as-databinding-source/30475480#30475480", "title": "IObservableVector&lt;T&gt; in Windows Store apps cannot be used as databinding source", "body": "<p>The <code>IObservableVector&lt;object&gt;</code> must be used for some reason. \nFor interest, here is an experiment using Rx in this context\n<a href=\"http://www.codeproject.com/Articles/995043/An-experiment-with-random-access-data-virtualisati\" rel=\"nofollow\">http://www.codeproject.com/Articles/995043/An-experiment-with-random-access-data-virtualisati</a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 1712647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0edeba893fa1eaefbcc61f73ee5c55b?s=128&d=identicon&r=PG&f=1", "display_name": "Marco D.", "link": "https://stackoverflow.com/users/1712647/marco-d"}, "edited": false, "score": 0, "creation_date": 1454073919, "post_id": 35084893, "comment_id": 57892885, "body": "I now understand the problem and experience it myself. When you use Platform::Collections::Vector&lt;&gt; you can use any of the complying types. If you decide to implement IObservableVector in your own class, it only works if you cast to IObservableVector&lt;Platform::Object^&gt;^.... I also don&#39;t know why it is like that but it also bothers me a lot."}, {"owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "edited": false, "score": 0, "creation_date": 1454077998, "post_id": 35084893, "comment_id": 57895641, "body": "Yeah...have a look at the link below, I managed to get all that working in a demo project with Rx"}], "tags": [], "owner": {"reputation": 31, "user_id": 1712647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0edeba893fa1eaefbcc61f73ee5c55b?s=128&d=identicon&r=PG&f=1", "display_name": "Marco D.", "link": "https://stackoverflow.com/users/1712647/marco-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1454071502, "creation_date": 1454071502, "answer_id": 35084893, "question_id": 28730192, "link": "https://stackoverflow.com/questions/28730192/iobservablevectort-in-windows-store-apps-cannot-be-used-as-databinding-source/35084893#35084893", "title": "IObservableVector&lt;T&gt; in Windows Store apps cannot be used as databinding source", "body": "<p>You say you cannot use a concrete type, so what type exactly are you using?\nAccording to <a href=\"https://msdn.microsoft.com/en-us/library/hh441570%28v=vs.120%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/hh441570%28v=vs.120%29.aspx</a> the supported types are one of the 5 listed in the \"Remarks\" section. Does your type comply?</p>\n"}], "owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 814, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1454071502, "creation_date": 1424900450, "last_edit_date": 1430474700, "question_id": 28730192, "link": "https://stackoverflow.com/questions/28730192/iobservablevectort-in-windows-store-apps-cannot-be-used-as-databinding-source", "title": "IObservableVector&lt;T&gt; in Windows Store apps cannot be used as databinding source", "body": "<p>I have been following the <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh780657.aspx\" rel=\"nofollow\">developer guidelines from MS</a> to implement Data Virtualisation, which state that IObservableVector must be implemented for random access data virtualization. </p>\n\n<p>I am using Reactive Extensions in a read only asynchronous implementation of <code>IObservableVector&lt;T&gt;,</code> which I am calling AsyncReadOnlyVirtualCollection.</p>\n\n<p>When I bind a GridView to an instance of this <code>IObservableVector&lt;SomeConcreteType&gt;</code> then I get an exception at runtime that the type cannot be instantiated due to incompatible types with WinRT. (Unable to compute GUID for type 'Windows.Foundation.Collections.IObservableVector`1[Foo]' because the instantiation contains types that are not supported by Windows Runtime.)</p>\n\n<p>If I use <code>*object*</code> instead of <code>*SomeConcreteType*,</code> which was suggested on earlier blogs when WinRT and XAML were still in CTP and framework errors were still present, then this works. Given that it is now 2015 and I am now on Windows 8.1, with the latest install of Visual Studio 2013 Community, I can only assume that I must be making some kind of error.</p>\n\n<p>Why can <code>IObservableVector&lt;ConcreteType&gt;</code> not be used as a data source, if MS guidelines declare it must be for such databinding? If the docs are out of date, what is the correct approach?</p>\n\n<p>---UPDATE---\nIt seems the core code that throws this error is here <a href=\"https://github.com/dotnet/coreclr/blob/d758145b547cc00aba3f0e3f101af27bf118e9af/src/vm/methodtable.cpp\" rel=\"nofollow\">https://github.com/dotnet/coreclr/blob/d758145b547cc00aba3f0e3f101af27bf118e9af/src/vm/methodtable.cpp</a> in the method BOOL MethodTable::IsLegalNonArrayWinRTType() which is applied to the generic type ConcreteType or Object above\n---MORE---\nOK after hacking through the above GitHub WinRT coreclr code, I see that there are checks to make sure the IObservableVector's generic type is WinRT compatible. I do not know why this is at the moment...can anyone enlighten me?</p>\n\n<p>Anyway, to comply, I moved the concrete type to a new Windows Runtime Component project and added assembly references, while changing the  back to </p>\n\n<p>This now \"works\" (the error goes away)...I now have a separate issue: The original error goes away but the Enumerator is iterated instead of indexer requested.....so not a solution after all....but WHY?</p>\n\n<hr>\n\n<p>FURTHER UPDATE\nThe class works if it implements <code>IObservableVector&lt;object&gt;</code> not <code>IObservabeVector&lt;T&gt;</code>. I didn't have time to find out why, but I suspect that it has something to do with inability to cast <code>&lt;T&gt;</code> to <code>&lt;object&gt;</code>...I will post my implementation for discussion on Codeplex as I think the Rx approach is probably novel. I will update here later when this done.</p>\n"}, {"tags": ["c#", "asp.net", "registration"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1424900354, "post_id": 28730139, "comment_id": 45746527, "body": "First off, you need to show the complete error message, and add a try/catch block to your event handler and print message.  What do you mean, &quot;unsure of how to pass the userid?&quot;"}, {"owner": {"reputation": 1643, "user_id": 3057983, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wNqvM.jpg?s=128&g=1", "display_name": "JohnH", "link": "https://stackoverflow.com/users/3057983/johnh"}, "edited": false, "score": 0, "creation_date": 1424900923, "post_id": 28730139, "comment_id": 45746813, "body": "I concur with the try/catch suggestion from OldProgrammer. You&#39;ll want to do that anyways in case there are issues on your database server during your &#39;INSERT&#39; command. Once you see the exception error message caught by the added try/catch block you&#39;ll probably see the cause of your error."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4547858, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/beb6ed0282b89ef24b40b2b431ad51e2?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefghijklmnop", "link": "https://stackoverflow.com/users/4547858/abcdefghijklmnop"}, "edited": false, "score": 0, "creation_date": 1424901220, "post_id": 28730271, "comment_id": 45746966, "body": "it still gives me an error because userid is NOT NULL"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 45, "user_id": 4547858, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/beb6ed0282b89ef24b40b2b431ad51e2?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefghijklmnop", "link": "https://stackoverflow.com/users/4547858/abcdefghijklmnop"}, "edited": false, "score": 0, "creation_date": 1424901614, "post_id": 28730271, "comment_id": 45747166, "body": "How is defined that field in your database? Has it the IDENTITY set to yes? If yes, then no value should be given, if no, then you should write the query as you have now and provide a parameter with a value for the userid. (However I think that you should put an IDENTITY on this field and let the database engine calculate it for you)"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 45, "user_id": 4547858, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/beb6ed0282b89ef24b40b2b431ad51e2?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefghijklmnop", "link": "https://stackoverflow.com/users/4547858/abcdefghijklmnop"}, "edited": false, "score": 0, "creation_date": 1424902297, "post_id": 28730271, "comment_id": 45747456, "body": "Using Sql Server Management Studio, go to your table and right click on it. Choose Design, select the UserID field and, in the Column Properties window scroll until you see the Identity Specification group (SQL Server 2014) open it and set to true the IsIdentity cell"}], "tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": true, "score": 3, "last_activity_date": 1424901111, "last_edit_date": 1424901111, "creation_date": 1424900772, "answer_id": 28730271, "question_id": 28730139, "link": "https://stackoverflow.com/questions/28730139/an-exception-of-type-system-data-sqlclient-sqlexception-in-registration-asp-ne/28730271#28730271", "title": "An exception of type &#39;System.Data.SqlClient.SqlException&#39; in Registration asp.net", "body": "<p>Your code tries to write 5 fields but pass only 4 parameters.<br>\nThe <code>@userid</code> parameter is missing from the SqlCommand.Parameters collection.</p>\n\n<p>Now there are two possibilities. If your userid field is an IDENTITY column then you shouldn't pass anything for the <code>userid</code> field and the query becomes </p>\n\n<pre><code>  String str = @\"INSERT INTO users (username, password, confirmpassword, email) \n                VALUES(@username, @password, @confirmpassword, @email)\";\n</code></pre>\n\n<p>or, if it is a normal field, you need to add that parameter to your SqlCommand parameter collection.</p>\n"}, {"comments": [{"owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "edited": false, "score": 0, "creation_date": 1424903360, "post_id": 28730310, "comment_id": 45747939, "body": "Did you try my suggestion ??"}, {"owner": {"reputation": 45, "user_id": 4547858, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/beb6ed0282b89ef24b40b2b431ad51e2?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefghijklmnop", "link": "https://stackoverflow.com/users/4547858/abcdefghijklmnop"}, "edited": false, "score": 0, "creation_date": 1424903581, "post_id": 28730310, "comment_id": 45748049, "body": "I have tried without the dbName.dbo.users I just had users and it works thanks"}], "tags": [], "owner": {"reputation": 1155, "user_id": 3252679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4e93ea51d93ce9a00e991076650a9e73?s=128&d=identicon&r=PG&f=1", "display_name": "Med.Amine.Touil", "link": "https://stackoverflow.com/users/3252679/med-amine-touil"}, "is_accepted": false, "score": 1, "last_activity_date": 1424900898, "creation_date": 1424900898, "answer_id": 28730310, "question_id": 28730139, "link": "https://stackoverflow.com/questions/28730139/an-exception-of-type-system-data-sqlclient-sqlexception-in-registration-asp-ne/28730310#28730310", "title": "An exception of type &#39;System.Data.SqlClient.SqlException&#39; in Registration asp.net", "body": "<p>First of all; if isIdentity is set to true do not pass the userId param.\nSecond, even it is mentioned in your connectionstring but you call your table by <code>CatalogName.dbo.TableName</code> in your query.</p>\n\n<pre><code>\"INSERT INTO dbName.dbo.users (username, password, confirmpassword, email) VALUES(@username, @password, @confirmpassword, @email)\";\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4547858, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/beb6ed0282b89ef24b40b2b431ad51e2?s=128&d=identicon&r=PG&f=1", "display_name": "abcdefghijklmnop", "link": "https://stackoverflow.com/users/4547858/abcdefghijklmnop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1695, "favorite_count": 0, "accepted_answer_id": 28730271, "answer_count": 2, "score": 0, "last_activity_date": 1424903519, "creation_date": 1424900247, "last_edit_date": 1424903519, "question_id": 28730139, "link": "https://stackoverflow.com/questions/28730139/an-exception-of-type-system-data-sqlclient-sqlexception-in-registration-asp-ne", "title": "An exception of type &#39;System.Data.SqlClient.SqlException&#39; in Registration asp.net", "body": "<p>I am attempting at creating a registration page but it's not going as planned. It keeps throwing this error: </p>\n\n<blockquote>\n  <p>An exception of type 'System.Data.SqlClient.SqlException' occurred in System.Data.dll but was not handled in user code</p>\n</blockquote>\n\n<p>In my table I have, </p>\n\n<pre><code>    [userid]          INT          NOT NULL,\n    [username]        VARCHAR (50) NULL,\n</code></pre>\n\n<p>This is my c# code</p>\n\n<pre><code> protected void Button1_Click(object sender, EventArgs e)\n        {\n            if (txtPassword.Text == txtConfirmPassword.Text)\n            {\n                string username = txtUsername.Text;\n                string password = txtPassword.Text;\n                string confirmpassword = txtConfirmPassword.Text;\n                string email = txtEmail.Text;\n\n                con.Open();\n                String str = \"INSERT INTO users (userid, username, password, confirmpassword, email) VALUES(@userid, @username, @password, @confirmpassword, @email)\";\n\n                SqlCommand cmd = new SqlCommand(str, con);\n\n                cmd.Parameters.AddWithValue(\"@username\", username);\n                cmd.Parameters.AddWithValue(\"@password\", password);\n                cmd.Parameters.AddWithValue(\"@confirmpassword\", confirmpassword);\n                cmd.Parameters.AddWithValue(\"@email\", email);\n\n                cmd.ExecuteNonQuery();\n\n                lblMessage.Text = \"OK!!!!!!!!!!!!!!!!!!!\";\n                con.Close();\n            }\n        }\n</code></pre>\n\n<p>I am unsure of how to pass the userid? </p>\n\n<p><strong>Update</strong>\nNeeded to set IDENTITY to userid in database. Thanks all</p>\n"}, {"tags": ["c#", "dynamics-crm", "crm"], "comments": [{"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 1, "creation_date": 1424900185, "post_id": 28730095, "comment_id": 45746430, "body": "Sounds like you are missing an assembly reference. You need to include any assemblies that the SDK requires in order to reference the SDK objects."}, {"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "reply_to_user": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424900291, "post_id": 28730095, "comment_id": 45746495, "body": "Yeah but FulfillSalesOrderRequest is under  Microsoft.Crm.Sdk.Messages  namespace and I have already include it."}, {"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 1, "creation_date": 1424900337, "post_id": 28730095, "comment_id": 45746521, "body": "That doesn&#39;t necessarily mean that <code>OrderClose</code> is in the same assembly.  Have you confirmed that it is?"}, {"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "reply_to_user": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424900487, "post_id": 28730095, "comment_id": 45746595, "body": "Looking at FulfillSalesOrderRequest in the documentation it seems that OrderClose is a property of FulfillSalesOrderRequest class of type Entity (that is a standard CRM type)"}, {"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424900577, "post_id": 28730095, "comment_id": 45746637, "body": "Again, just because <code>FulfillSalesOrderRequest</code> may make use of <code>OrderClose</code>, such as exposing an instance of it through a property, that doesn&#39;t mean that it&#39;s in the same assembly.  You need to confirm exactly what assembly <code>OrderClose</code> is actually defined in.  Take a look at @pittofdirk&#39;s answer; he&#39;s on the right track."}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424900701, "post_id": 28730095, "comment_id": 45746708, "body": "I have edited your title. Please see, &quot;<a href=\"http://meta.stackexchange.com/questions/19190/\">Should questions include \u201ctags\u201d in their titles?</a>&quot;, where the consensus is &quot;no, they should not&quot;."}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424900748, "post_id": 28730095, "comment_id": 45746733, "body": "Which &quot;CRM&quot; are you using? Dynamics?"}, {"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "reply_to_user": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424901035, "post_id": 28730095, "comment_id": 45746861, "body": "@Nathan A the OrderClose property of FulfillSalesOrderRequest is of type Entity"}, {"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424901104, "post_id": 28730095, "comment_id": 45746907, "body": "...Ok, then why are you trying to create a <code>OrderClose</code> instance?  Instead, you should be doing <code>request.OrderClose = new Entity();</code>"}, {"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "edited": false, "score": 0, "creation_date": 1424901242, "post_id": 28730095, "comment_id": 45746976, "body": "I tryed also this way (and it compiles) but when I execute the request to fulfill the order I receive an Exception saying &quot;An unexpected error occurred.&quot;."}, {"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424901357, "post_id": 28730095, "comment_id": 45747032, "body": "That&#39;s another question all together.  If <code>OrderClose</code> isn&#39;t a class/struct, you cannot create it with <code>new</code>."}, {"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "edited": false, "score": 0, "creation_date": 1424901472, "post_id": 28730095, "comment_id": 45747088, "body": "Of course. I initially thought it was part of the SDK. Anyway now I don&#39;t understand why I receive that error :)"}, {"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "edited": false, "score": 0, "creation_date": 1424901602, "post_id": 28730095, "comment_id": 45747161, "body": "I&#39;d suggest you post a new question with your source code and error details, so you can get the answer you are looking for.  Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "edited": false, "score": 0, "creation_date": 1424901835, "post_id": 28730222, "comment_id": 45747274, "body": "I have already added Microsoft.Crm.Sdk.Proxy to the project and used Microsoft.Crm.Sdk.Messages in the code"}], "tags": [], "owner": {"reputation": 1003, "user_id": 2946639, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6mPR.jpg?s=128&g=1", "display_name": "Andrew Roth", "link": "https://stackoverflow.com/users/2946639/andrew-roth"}, "is_accepted": false, "score": 0, "last_activity_date": 1424900569, "creation_date": 1424900569, "answer_id": 28730222, "question_id": 28730095, "link": "https://stackoverflow.com/questions/28730095/unable-to-compile-code-when-using-orderclose-class/28730222#28730222", "title": "Unable to compile code when using OrderClose class", "body": "<p>OrderClose is in the Assembly \"Microsoft.Crm.Sdk.Proxy\" (in Microsoft.Crm.Sdk.Proxy.dll)</p>\n\n<p>Have you added Microsoft.Crm.Sdk.Proxy.dll as a reference? Not just</p>\n\n<pre><code>using Microsoft.Crm.Sdk.Messages;\n</code></pre>\n\n<p>but actually going over to the solution explorer pane and right clicking References > Add Reference and choosing Microsoft.Crm.Sdk.Proxy.dll.</p>\n\n<p>Edit: Right clicking on something red-squigglied and picking \"Resolve\" won't work unless the correct assembly is referenced.</p>\n"}, {"tags": [], "owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1424901663, "creation_date": 1424901663, "answer_id": 28730509, "question_id": 28730095, "link": "https://stackoverflow.com/questions/28730095/unable-to-compile-code-when-using-orderclose-class/28730509#28730509", "title": "Unable to compile code when using OrderClose class", "body": "<p>Since <code>OrderClose</code> is not a class, but the name of a Property, you cannot create it using <code>new</code>.</p>\n\n<p>As the property is of type <code>Entity</code>, you need to create an instance of <code>Entity</code> like this:</p>\n\n<pre><code>request.OrderClose = new Entity();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1848, "user_id": 1159711, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/UFuNN.jpg?s=128&g=1", "display_name": "BlueSam", "link": "https://stackoverflow.com/users/1159711/bluesam"}, "is_accepted": false, "score": 0, "last_activity_date": 1424911153, "creation_date": 1424911153, "answer_id": 28732495, "question_id": 28730095, "link": "https://stackoverflow.com/questions/28730095/unable-to-compile-code-when-using-orderclose-class/28732495#28732495", "title": "Unable to compile code when using OrderClose class", "body": "<p>It sounds like the sample code assumes you have generated the early-bound code for your organization. If you included the early-bound code in your project, this reference would resolve. See this link:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/gg327844.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/gg327844.aspx</a></p>\n\n<p>The CrmSvcUtil.exe is part of the CRM SDK. Here is a template of how to use it: </p>\n\n<pre><code>CrmSvcUtil.exe /url:http://&lt;serverName&gt;/&lt;organizationName&gt;/XRMServices/2011/Organization.svc    /out:&lt;outputFilename&gt;.cs /username:&lt;username&gt; /password:&lt;password&gt; /domain:&lt;domainName&gt;    /namespace:&lt;outputNamespace&gt; /serviceContextName:&lt;serviceContextName&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 825, "user_id": 4070633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tdwfs.jpg?s=128&g=1", "display_name": "Sxntk", "link": "https://stackoverflow.com/users/4070633/sxntk"}, "is_accepted": false, "score": 0, "last_activity_date": 1508366180, "creation_date": 1508366180, "answer_id": 46820278, "question_id": 28730095, "link": "https://stackoverflow.com/questions/28730095/unable-to-compile-code-when-using-orderclose-class/46820278#46820278", "title": "Unable to compile code when using OrderClose class", "body": "<p>That is an early bound request, that's why you can't compile, if you aren't using the CrmScvUtil.</p>\n\n<p>This is an example of a late bound request:</p>\n\n<p>This namespace is needed.</p>\n\n<pre><code>using Microsoft.Xrm.Sdk.Messages;\n</code></pre>\n\n<p>And this is the code.</p>\n\n<pre><code>var request = new FulfillSalesOrderRequest();\nrequest.OrderClose = new Entity(\"orderclose\");\nrequest.OrderClose[\"salesorderid\"] = new EntityReference(\"salesorder\", new Guid(\"YOURGUID\"));\nrequest.Status = new OptionSetValue(100001);\nservice.Execute(request);\n</code></pre>\n\n<p><code>100001</code> is the status code for Complete.</p>\n\n<p>If you want to handle the response, use a variable to receive the answer.</p>\n"}], "owner": {"reputation": 985, "user_id": 1030956, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/8a76c84ee57c075c32d1fd50af2ce706?s=128&d=identicon&r=PG", "display_name": "lugeno", "link": "https://stackoverflow.com/users/1030956/lugeno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 614, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1508366180, "creation_date": 1424900132, "last_edit_date": 1424902397, "question_id": 28730095, "link": "https://stackoverflow.com/questions/28730095/unable-to-compile-code-when-using-orderclose-class", "title": "Unable to compile code when using OrderClose class", "body": "<p>I'm trying to build a plugin that does some operations on a salesorder. I also have to set a order as fulfilled. I found on the SDK documentation an extract that must be used to fulfill the order in the right way</p>\n\n<pre><code>var request = new FulfillSalesOrderRequest\n        {\n            OrderClose = new OrderClose\n            {\n                SalesOrderId = new EntityReference \n                    { LogicalName = orderEntityName, Id = orderId }\n\n            },\n            Status = new OptionSetValue(newStatus)\n        };\n</code></pre>\n\n<p>The problem is that the code cannot be compiled because MVS says \"The type or namespace name 'OrderClose' could not be found (are you missing a using directive or an assembly reference?)\". RightClicking on \"new OrderClose\" (OrderClose is underlined in red) I cannot see the Resolve section in the menu. \nI have also tried this way:</p>\n\n<pre><code>        var request = new FulfillSalesOrderRequest();\n\n        request.OrderClose = new OrderClose();\n\n        request.OrderClose.LogicalName = orderEntityName;\n        request.OrderClose.Id = orderId;\n        request.Status = new OptionSetValue(newStatus);\n</code></pre>\n\n<p>How can I make the code compiling (and hopefully working)?</p>\n"}, {"tags": ["c#", "linq"], "comments": [{"owner": {"reputation": 33608, "user_id": 1651298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sy8Lv.jpg?s=128&g=1", "display_name": "Giorgi Nakeuri", "link": "https://stackoverflow.com/users/1651298/giorgi-nakeuri"}, "edited": false, "score": 0, "creation_date": 1424900302, "post_id": 28730068, "comment_id": 45746501, "body": "v.property1 = null; you can do it in one query with complex where clause. You can create list of warnings and use contains"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 33608, "user_id": 1651298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sy8Lv.jpg?s=128&g=1", "display_name": "Giorgi Nakeuri", "link": "https://stackoverflow.com/users/1651298/giorgi-nakeuri"}, "edited": false, "score": 0, "creation_date": 1424900617, "post_id": 28730068, "comment_id": 45746662, "body": "@GiorgiNakeuri He needs to conditionally null out certain values, not unconditionally null out all of the values."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1424901504, "post_id": 28730068, "comment_id": 45747106, "body": "Is this just to make it easier (which is valid) or is it a problem to traverse <code>rList</code> six times because of its size?"}], "answers": [{"comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1424901024, "post_id": 28730229, "comment_id": 45746856, "body": "I think to have the same effect you need to use the <code>Contains</code> with an <code>IEqualityComparer</code>. The <code>StringComparer</code> of the hashset is for comparing the items in the set itself."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 1, "creation_date": 1424901158, "post_id": 28730229, "comment_id": 45746932, "body": "@GertArnold There is no overload of <code>Contains</code> within <code>hashSet</code> that accepts an <code>IEqualityComparer&lt;T&gt;</code>.  it always uses the comparer specified in the constructor (or uses the default, if the constructor didn&#39;t specify one).  This of course to be expected; one could not find the value in a <code>HashSet</code> using a different comparer than the one that added the items to the set."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1424901307, "post_id": 28730229, "comment_id": 45747004, "body": "Ah yes, it&#39;s an instance method."}, {"owner": {"reputation": 21, "user_id": 3376377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209ba8995ec19b81428859fe97a1f37d?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/3376377/scott"}, "edited": false, "score": 0, "creation_date": 1424957637, "post_id": 28730229, "comment_id": 45770278, "body": "That will work.  I need to have 6 foreach&#39;s, but that&#39;s fine."}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": false, "score": 1, "last_activity_date": 1424900587, "creation_date": 1424900587, "answer_id": 28730229, "question_id": 28730068, "link": "https://stackoverflow.com/questions/28730068/howto-change-values-in-ilistobject-properties/28730229#28730229", "title": "HOWTO: Change values in IList&lt;object&gt; properties", "body": "<p>The first thing that you can do is put all of the warning in a collection and then use operations of that collection in your query:</p>\n\n<pre><code>var warnings = new HashSet&lt;string&gt;(StringComparer.OrdinalIgnoreCase)\n{\n    warning1,\n    warning2,\n    warning3,\n};\nforeach(var item in rList.Where(ppe =&gt; warnings.Contains(ppe.Property1)))\n    item.Property1 = null;\n</code></pre>\n\n<p>Note that as long as the set does not contain null values (meaning warning1, warning2, and warning3 are not <code>null</code>) there is no need for the <code>Where</code> to have the null check.</p>\n"}], "owner": {"reputation": 21, "user_id": 3376377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209ba8995ec19b81428859fe97a1f37d?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/3376377/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1275, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424902401, "creation_date": 1424900095, "last_edit_date": 1424902401, "question_id": 28730068, "link": "https://stackoverflow.com/questions/28730068/howto-change-values-in-ilistobject-properties", "title": "HOWTO: Change values in IList&lt;object&gt; properties", "body": "<p>I have a list of objects (rList in query below).  Each object (v in query below) has 6 string objects inside of it.  I need to query each property and change the value to null if it equals a certain string.  </p>\n\n<p>Is there an easier way to do this than doing 6 different linq queries (IE: one of these for each of the 6 properties)?</p>\n\n<pre><code>foreach (var v in rList.Where(ppe =&gt; ppe.Property1 != null\n                &amp;&amp; (ppe.Property1.Equals(warning1, StringComparison.OrdinalIgnoreCase)\n                    || ppe.Property1.Equals(warning2, StringComparison.OrdinalIgnoreCase)\n                    || ppe.Property1.Equals(warning3, StringComparison.OrdinalIgnoreCase))))\n            {\n                ppe.Property1 = null;\n            }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "iis"], "answers": [{"comments": [{"owner": {"reputation": 846, "user_id": 2216468, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ebd95af2580df14c468adbad9827e012?s=128&d=identicon&r=PG", "display_name": "badazzhindu", "link": "https://stackoverflow.com/users/2216468/badazzhindu"}, "edited": false, "score": 0, "creation_date": 1425324929, "post_id": 28743276, "comment_id": 45907676, "body": "When I try to enumerate the appdomains - i get back two transparent proxy types and one app domain (my current appdomain). How do i actually get information from the transparent proxies? I would like to atleast see their &#39;FriendlyNames&#39; so I can make sure i stop work on the correct app domain."}, {"owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "reply_to_user": {"reputation": 846, "user_id": 2216468, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ebd95af2580df14c468adbad9827e012?s=128&d=identicon&r=PG", "display_name": "badazzhindu", "link": "https://stackoverflow.com/users/2216468/badazzhindu"}, "edited": false, "score": 0, "creation_date": 1425326833, "post_id": 28743276, "comment_id": 45908688, "body": "@badazzhindu I remember that no information are displayed in debug mode but you can access FriendlyName at runtime. BTW, I tried GetData/SetData and data can&#39;t be shared accross appdomain :-/. If you need to share information, try to access a static type that host these information inside the appdomain."}, {"owner": {"reputation": 846, "user_id": 2216468, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ebd95af2580df14c468adbad9827e012?s=128&d=identicon&r=PG", "display_name": "badazzhindu", "link": "https://stackoverflow.com/users/2216468/badazzhindu"}, "edited": false, "score": 0, "creation_date": 1425327948, "post_id": 28743276, "comment_id": 45909297, "body": "This results in a serialization exception. It is unable to retrieve friendly names for older app domains  <code>[HttpGet] \t\tpublic ActionResult GetAppDomains() \t\t{ \t\t\tvar domains = AppDomainEnumerator.GetAppDomains(); \t\t\t  \t\t\treturn new ContentResult() \t\t\t{ \t\t\t\tContent = domains.Select(a =&gt; a.FriendlyName).ToDelimitedString() \t\t\t}; \t\t}</code>"}, {"owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "reply_to_user": {"reputation": 846, "user_id": 2216468, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ebd95af2580df14c468adbad9827e012?s=128&d=identicon&r=PG", "display_name": "badazzhindu", "link": "https://stackoverflow.com/users/2216468/badazzhindu"}, "edited": false, "score": 0, "creation_date": 1425328467, "post_id": 28743276, "comment_id": 45909614, "body": "I have not try it yet but if you return <code>AppDomain.CurrentDomain.FriendlyName</code> inside the <code>MarshalByRefObject</code> ?"}], "tags": [], "owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "is_accepted": false, "score": 1, "last_activity_date": 1424955930, "creation_date": 1424955930, "answer_id": 28743276, "question_id": 28730045, "link": "https://stackoverflow.com/questions/28730045/force-unload-of-appdomain-when-using-iregisteredobject/28743276#28743276", "title": "Force Unload of Appdomain when using IRegisteredObject", "body": "<p>You can enumerate all domains using this piece of code <a href=\"http://blogs.msdn.com/b/jackg/archive/2007/06/11/enumerating-appdomains.aspx\" rel=\"nofollow\">Enumerating AppDomains</a></p>\n\n<p>Then, you can execute code on the remote AppDomain using <a href=\"https://msdn.microsoft.com/en-us/library/system.appdomain.createinstanceandunwrap(v=vs.110).aspx\" rel=\"nofollow\"><code>AppDomain.CreateInstanceAndUnwrap</code></a> method. The domain should have the assembly containing this shared type loaded.</p>\n\n<pre><code>    CrossAppDomainExecuteStopper stopper = (CrossAppDomainExecuteStopper)appDomain.CreateInstanceAndUnwrap(typeof(CrossAppDomainExecuteStopper).Assembly.FullName, typeof(CrossAppDomainExecuteStopper).FullName);\n    stopper.StopWork();\n</code></pre>\n\n<p>and <code>CrossAppDomainExecuteStopper</code> must inherits from <code>MarshalByRefObject</code></p>\n\n<pre><code>public class CrossAppDomainExecuteStopper : MarshalByRefObject\n{\n    public void StopWork()\n    {\n        // force stop the work\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 846, "user_id": 2216468, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ebd95af2580df14c468adbad9827e012?s=128&d=identicon&r=PG", "display_name": "badazzhindu", "link": "https://stackoverflow.com/users/2216468/badazzhindu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1424955930, "creation_date": 1424900012, "question_id": 28730045, "link": "https://stackoverflow.com/questions/28730045/force-unload-of-appdomain-when-using-iregisteredobject", "title": "Force Unload of Appdomain when using IRegisteredObject", "body": "<p>We have some background processes that run on IIS ASP.NET websites. To prevent these processes from dying when the application recycles, we implemented an instance of IRegisteredObject, where we wait for work on a server to finish before unloading the appdomain (see contrived example below). </p>\n\n<p>Our code is working as expected, however as we do deployments - old appdomains persist until the work we want is completed (which we want) - however, with frequent deployments / lots of work - we run into a situation where resources on our virtual machines are almost exhausted. </p>\n\n<p>Is there an external way to force an unload (regardless of IRegisteredObject existence) / kill older appdomains? or a way that we can communicate with an older appdomain to tell it to terminate within code?</p>\n\n<pre><code>internal class ShutdownHelper : IRegisteredObject\n{\n    public ShutdownHelper() {\n        HostingEnvironment.RegisterObject(this);\n    }\n\n    void IRegisteredObject.Stop(bool immediate)\n    {\n        if (immediate)\n        {\n            WaitForAllWorkToComplete(TIMEOUT /* Some arbitrary timeout*/); // This function returns when all processing on the server has completed\n            HostingEnvironment.UnregisterObject(this);\n        }\n        else\n        {\n            // Similar logic as immediate but run asynchronously and we only unload if the task completes (in a continuation)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "coordinates", "polygon"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4607682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed1f8e5d5e92539187ad89d45bc7d6a?s=128&d=identicon&r=PG", "display_name": "Robert Lange", "link": "https://stackoverflow.com/users/4607682/robert-lange"}, "edited": false, "score": 0, "creation_date": 1424906636, "post_id": 28730766, "comment_id": 45749409, "body": "Everything works now properly, thanks. When I add the ellipses to the grid the first time right after the polygon creation method, it takes the original positions. I think because the polygon hasen&#39;t yet rendered in this tick. If I do it separately with a button, the polygon has rendered and it takes the new stretched positions. Do you know a way, doing both without a separate button click?"}, {"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "reply_to_user": {"reputation": 15, "user_id": 4607682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed1f8e5d5e92539187ad89d45bc7d6a?s=128&d=identicon&r=PG", "display_name": "Robert Lange", "link": "https://stackoverflow.com/users/4607682/robert-lange"}, "edited": false, "score": 0, "creation_date": 1424906783, "post_id": 28730766, "comment_id": 45749472, "body": "You might do it in a SizeChanged event handler of the Grid (which you would have to do anyway). However, make sure that you delete all existing Ellipses before adding new ones."}, {"owner": {"reputation": 15, "user_id": 4607682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed1f8e5d5e92539187ad89d45bc7d6a?s=128&d=identicon&r=PG", "display_name": "Robert Lange", "link": "https://stackoverflow.com/users/4607682/robert-lange"}, "edited": false, "score": 1, "creation_date": 1424907419, "post_id": 28730766, "comment_id": 45749693, "body": "Right, didn&#39;t thought about it. Thanks again. Now I can finally finish my project."}], "tags": [], "owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1424903067, "last_edit_date": 1424903067, "creation_date": 1424902741, "answer_id": 28730766, "question_id": 28729994, "link": "https://stackoverflow.com/questions/28729994/c-wpf-how-to-get-the-coordinates-from-a-stretcheduniform-polygon-on-a-grid/28730766#28730766", "title": "C# WPF -&gt; How to get the coordinates from a stretched(uniform) polygon on a grid", "body": "<p>You have to take two more things into account.</p>\n\n<p>First, the Grid may align (i.e. move) the whole stretched Polygon according to its HorizontalAlignment and VerticalAlignment properties. If you don't want to calculate that by yourself, you could get an appropriate GeneralTransform object by <code>myPolygon.TransformToAncestor(grid)</code>:</p>\n\n<pre><code>var polygonGeometryTransform = myPolygon.RenderedGeometry.Transform;\nvar polygonToGridTransform = myPolygon.TransformToAncestor(gridPoly);\n\nforeach (var point in myPolygon.Points)\n{\n    var transformedPoint = polygonToGridTransform.Transform(\n                           polygonGeometryTransform.Transform(point));\n    CreateEllipse(5, 5, transformedPoint.X, transformedPoint.Y, gridPoly);\n}\n</code></pre>\n\n<p>Second, when you do an absolute positioning of the Ellipses relative to the upper left corner of the Grid, you would have to set their HorizontalAlignment to <code>Left</code> and the VerticalAlignment to <code>Top</code>:</p>\n\n<pre><code>ellipse.HorizontalAlignment = HorizontalAlignment.Left;\nellipse.VerticalAlignment = VerticalAlignment.Top;\ngrid.Children.Add(ellipse);\n</code></pre>\n\n<p>That said, you wouldn't typically set an element's Margin for absolute positioning. It would be much cleaner to use a separate Canvas for the Ellipses and set their <code>Canvas.Left</code> and <code>Canvas.Top</code> properties.</p>\n"}], "owner": {"reputation": 15, "user_id": 4607682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed1f8e5d5e92539187ad89d45bc7d6a?s=128&d=identicon&r=PG", "display_name": "Robert Lange", "link": "https://stackoverflow.com/users/4607682/robert-lange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1098, "favorite_count": 0, "accepted_answer_id": 28730766, "answer_count": 1, "score": 0, "last_activity_date": 1424903363, "creation_date": 1424899850, "last_edit_date": 1424903363, "question_id": 28729994, "link": "https://stackoverflow.com/questions/28729994/c-wpf-how-to-get-the-coordinates-from-a-stretcheduniform-polygon-on-a-grid", "title": "C# WPF -&gt; How to get the coordinates from a stretched(uniform) polygon on a grid", "body": "<p>I searched a lot to find a solution for my problem. Couldn't find anything.</p>\n\n<p>This is what I do:</p>\n\n<p>I render a polygon via point array on a grid. The polygon autoresizing itself to match the grids size(uniform). I get the new stretched coordinates with the following lines and create the ellipses with a method:</p>\n\n<pre><code>var transform = myPolygon.RenderedGeometry.Transform;\nforeach (var point in myPolygon.Points)\n{\n    var transformedPoint = transform.Transform(point);\n    CreateEllipse(5, 5, Convert.ToDouble(Convert.ToString(transformedPoint).Split(';')[0]), Convert.ToDouble(Convert.ToString(transformedPoint).Split(';')[1]), gridPoly);\n}\n\nEllipse CreateEllipse(double width, double height, double desiredCenterX, double desiredCenterY, Grid grid)\n{\n    Ellipse ellipse = new Ellipse { Width = width, Height = height };\n    double left = desiredCenterX - (width / 2);\n    double top = desiredCenterY - (height / 2);\n    ellipse.Stroke = System.Windows.Media.Brushes.Black;\n    ellipse.Fill = System.Windows.Media.Brushes.DarkBlue;\n    ellipse.Margin = new Thickness(left, top, 0, 0);\n    grid.Children.Add(ellipse);\n    return ellipse;\n}\n</code></pre>\n\n<p>The problem is, if I put the polygon on a grid and the ellipses afterwards, they will render exact the half size and not at the correct position, not even relative. Same happens if I set stretch to 'none'.</p>\n\n<p>If I render my polygon and ellipses on a canvas, they render exact on each polygon point and everything is perfect. Beside, canvas doesn't support stretch.Uniform. And I need to dynamically fit the polygon into its parent object.</p>\n\n<p>My question is, how do I render ellipses on an auto resizing polygon using the point positiondata?</p>\n"}, {"tags": ["c#", ".net", "json", "asp.net-web-api2"], "comments": [{"owner": {"reputation": 18924, "user_id": 3970411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f2479dbd50036c3d580be156c176fb?s=128&d=identicon&r=PG", "display_name": "Hamid Pourjam", "link": "https://stackoverflow.com/users/3970411/hamid-pourjam"}, "edited": false, "score": 0, "creation_date": 1424899746, "post_id": 28729858, "comment_id": 45746135, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/26474436/return-camelcased-json-from-web-api\">Return camelCased JSON from Web API</a>"}, {"owner": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "edited": false, "score": 0, "creation_date": 1424900396, "post_id": 28729858, "comment_id": 45746548, "body": "If you have three methods, say A, B, and C, is your need to dynamically change the case across any/all methods, or do you only need to run Pascal case for method C always?"}, {"owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "edited": false, "score": 0, "creation_date": 1424900831, "post_id": 28729858, "comment_id": 45746773, "body": "I need to run Pascal case for only method C (always). Other methods should continue to use default setting of camel case."}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 0, "creation_date": 1424901839, "post_id": 28729858, "comment_id": 45747279, "body": "You could probably have your method return a string and in the body use <code>JsonSerializer</code> directly passing in whatever settings you want/need. That shouldn&#39;t effect the global settings for everything else."}, {"owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "edited": false, "score": 0, "creation_date": 1424968225, "post_id": 28729858, "comment_id": 45777514, "body": "Correct. Returning a string can be a valid solution, but I am looking for a more elegant solution that I was hoping Newtonsoft.Json could provide. As of now, Request.CreateResponse() approach is the solution I am going with. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "edited": false, "score": 0, "creation_date": 1424965738, "post_id": 28730510, "comment_id": 45775856, "body": "First, thank you for your response.  I attempted your solution with the latest version of Newtonsoft.Json (6.0.0.0). I was not able to find &quot;JsonRequestBehavior&quot;. Also, the comment [// This serializes explicitly, <b>before</b> WebApi invokes the default serializer] confused me a bit. If the Json() serializer is called before the WebAPI serializer, then what&#39;s the point? Won&#39;t the WebAPI serializer just trump whatever Json() has done? I was not able to compile code and verify.  Please see my response below to David Peden&#39;s suggestion."}], "tags": [], "owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "is_accepted": false, "score": 0, "last_activity_date": 1424901665, "creation_date": 1424901665, "answer_id": 28730510, "question_id": 28729858, "link": "https://stackoverflow.com/questions/28729858/newtonsoft-json-optionally-change-payload-casing-webapi-2/28730510#28730510", "title": "Newtonsoft JSON optionally change payload casing WebAPI 2", "body": "<p>You need to explicitly serialize your JSON, rather than returning an object and letting WebApi serialize it for you.  Try something like:</p>\n\n<pre><code>public JSonResult Get(int id, int jtStartIndex = 0, int jtPageSize = 0, string jtSorting = \"\")\n{\n   List&lt;MobileOrderModel&gt; orders = _svc.GetMobileOrders(id);\n   var dto = new JTableDtoMobileOrdersImpl(orders, jtStartIndex, jtPageSize) {\n      Message = string.Format(\"DataSource:{0}\", _svc.DataSource)\n   };\n   return Json(dto, JsonRequestBehavior.AllowGet); // This serializes explicitly, before WebApi invokes the default serializer\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "edited": false, "score": 0, "creation_date": 1424966966, "post_id": 28730718, "comment_id": 45776706, "body": "David, thank you for the suggestion. I used it and it <b>works</b>. I suppose I was too fixated on trying to accomplish this using the Newtonsoft.Json library. I guess I was hoping it had some type of a MediaTypeFormatter override option that could be used to change how JSON payloads are returned depending which WebAPI is being called."}, {"owner": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "reply_to_user": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "edited": false, "score": 0, "creation_date": 1424968083, "post_id": 28730718, "comment_id": 45777408, "body": "If you want to control which serialization settings are used across many API methods in a centralized location, you should look into writing your own <code>MediaTypeFormatter</code>. You could then inspect the request and have a map of serializer to route or something along those lines."}, {"owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "edited": false, "score": 0, "creation_date": 1424971520, "post_id": 28730718, "comment_id": 45779660, "body": "Ha. Finally figured out I need to click on the check mark to have this marked as the accepted solution. Thanks again David for all your suggestions."}], "tags": [], "owner": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "is_accepted": true, "score": 1, "last_activity_date": 1424902531, "creation_date": 1424902531, "answer_id": 28730718, "question_id": 28729858, "link": "https://stackoverflow.com/questions/28729858/newtonsoft-json-optionally-change-payload-casing-webapi-2/28730718#28730718", "title": "Newtonsoft JSON optionally change payload casing WebAPI 2", "body": "<p>You can call <code>Request.CreateResponse</code> with <a href=\"https://msdn.microsoft.com/en-us/library/hh969002(v=vs.118).aspx\" rel=\"nofollow\">the overload that takes a MediaTypeFormatter</a> and pass in the <code>new JsonMediaTypeFormatter()</code> similarly to how you were setting it globally but specifically for this one method. And, of course, you can specify whatever <code>SerializerSettings</code> you want. It would probably be best to keep a private static instance of it in your controller so you're not <code>new</code>ing it up every time.</p>\n"}, {"comments": [{"owner": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "edited": false, "score": 0, "creation_date": 1424968216, "post_id": 28747506, "comment_id": 45777500, "body": "<code>JsonMediaTypeFormatter</code> uses Json.Net under the hood. The serialized response is the same, regardless of what the actual return type is on your API method. Not sure why you don&#39;t like this solution..."}, {"owner": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "edited": false, "score": 0, "creation_date": 1424968320, "post_id": 28747506, "comment_id": 45777581, "body": "I&#39;d also recommend explicitly setting the serializer settings to maintain the casing that you want so that a.) your intent is declared and b.) if the default were to ever change, your code would not break."}, {"owner": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "edited": false, "score": 0, "creation_date": 1424968610, "post_id": 28747506, "comment_id": 45777770, "body": "And one more thing, if you&#39;re running Web API 2, you can return an <code>OkNegotiatedContentResult&lt;T&gt;</code> (see <a href=\"https://msdn.microsoft.com/en-us/library/dn308866(v=vs.118).aspx\" rel=\"nofollow noreferrer\">here</a>) to get a strongly typed response."}, {"owner": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "edited": false, "score": 0, "creation_date": 1425014661, "post_id": 28747506, "comment_id": 45796772, "body": "Regarding my comment about declaring intent, I would change your formatters variable to this: <code>private static readonly IEnumerable&lt;JsonMediaTypeFormatter&gt; _mediaTypeFormatters = new[] { new JsonMediaTypeFormatter { SerializerSettings = new JsonSerializerSettings { ContractResolver = new DefaultContractResolver() } } };</code>"}, {"owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "reply_to_user": {"reputation": 15089, "user_id": 607701, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/uwMvs.jpg?s=128&g=1", "display_name": "David Peden", "link": "https://stackoverflow.com/users/607701/david-peden"}, "edited": false, "score": 0, "creation_date": 1425057686, "post_id": 28747506, "comment_id": 45819993, "body": "Thank you. I updated the code snippet with your line. And using it in my project."}], "tags": [], "owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "is_accepted": false, "score": 0, "last_activity_date": 1425058488, "last_edit_date": 1425058488, "creation_date": 1424967730, "answer_id": 28747506, "question_id": 28729858, "link": "https://stackoverflow.com/questions/28729858/newtonsoft-json-optionally-change-payload-casing-webapi-2/28747506#28747506", "title": "Newtonsoft JSON optionally change payload casing WebAPI 2", "body": "<p>Here is my final WebAPI method that works the way I needed. It's too bad I was not able to get this functionality through the Newtonsoft.Json library so the method would be returning the business object and not a response object. I removed code from the class for clarity. (ie: tracing, comments, etc).</p>\n\n<pre><code>public class MobileOrdersController : ApiController {\n    private static readonly MobileOrdersService _svc = new MobileOrdersService();\n    private static readonly MediaTypeFormatter _properCaseFormatter = new JsonMediaTypeFormatter{\n        SerializerSettings = new JsonSerializerSettings {\n            ContractResolver = new DefaultContractResolver()\n        }\n    };\n\n    [Authorize][HttpGet]\n    public HttpResponseMessage GetCustomerMobileOrders(int id, int jtStartIndex = 0, int jtPageSize = 0, string jtSorting = \"\") {\n        try {\n            List&lt;MobileOrderModel&gt; orders = _svc.GetMobileOrders(id);\n            var dto = new JTableDtoMobileOrdersImpl(orders, jtStartIndex, jtPageSize) {\n                Message = string.Format(\"DataSource:{0}\", _svc.DataSource)\n            };\n            return Request.CreateResponse(HttpStatusCode.OK, dto, _properCaseFormatter);\n        } catch (Exception ex) {\n            return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ex);\n        }\n    }\n}\n</code></pre>\n\n<p>The following is my solution with OkNegotiatedContentResult&lt;> as recommended by David since I'm using WebAPI 2.</p>\n\n<pre><code>public class MobileOrdersController : ApiController {\n    private static readonly MobileOrdersService _svc = new MobileOrdersService();\n    private static readonly IContentNegotiator _conneg = GlobalConfiguration.Configuration.Services.GetContentNegotiator();\n    private static readonly IEnumerable&lt;JsonMediaTypeFormatter&gt; _mediaTypeFormatters = new[] {\n        new JsonMediaTypeFormatter {\n            SerializerSettings = new JsonSerializerSettings {\n                ContractResolver = new DefaultContractResolver()\n            }\n        }\n    };\n\n    [Authorize][HttpGet]\n    public IHttpActionResult GetCustomerMobileOrders(int id, int jtStartIndex = 0, int jtPageSize = 0, string jtSorting = \"\") {\n        try {\n            List&lt;MobileOrderModel&gt; orders = _svc.GetMobileOrders(id);\n            var dto = new JTableDtoMobileOrdersImpl(orders, jtStartIndex, jtPageSize) {\n                Message = string.Format(\"DataSource:{0}\", _svc.DataSource)\n            };\n            return new OkNegotiatedContentResult&lt;JTableDtoMobileOrdersImpl&gt;(dto, _conneg, Request, _mediaTypeFormatters);\n        } catch (Exception ex) {\n            return new ExceptionResult(ex, this);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4607635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b7982cb64a735d88a4446cadb21929?s=128&d=identicon&r=PG", "display_name": "sandor", "link": "https://stackoverflow.com/users/4607635/sandor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1150, "favorite_count": 0, "accepted_answer_id": 28730718, "answer_count": 3, "score": 1, "last_activity_date": 1425058488, "creation_date": 1424899344, "last_edit_date": 1424972265, "question_id": 28729858, "link": "https://stackoverflow.com/questions/28729858/newtonsoft-json-optionally-change-payload-casing-webapi-2", "title": "Newtonsoft JSON optionally change payload casing WebAPI 2", "body": "<p>I have camel casing configured as the default JSON output from Newtonsoft library. The following line is called during Application_Start:</p>\n\n<pre><code>config.Formatters.JsonFormatter.SerializerSettings.ContractResolver = new CamelCasePropertyNamesContractResolver();\n</code></pre>\n\n<p>All javascript REST calls to the WebAPIs (using WebAPI 2) work fine and return camel cased JSON strings to the client.</p>\n\n<p>Now, I am using jTable control (<a href=\"http://www.jtable.org/\" rel=\"nofollow\">http://www.jtable.org</a>) on one of my webpages, and this control requires that JSON payloads be returned in <strong>Proper Case</strong>. <em>So the question is</em> <strong>how can I optionally change the WebAPI to return Proper Case JSON payload even though the default configuration through the Application_Start is set to camel case without changing what the global default setting is?</strong> I need Proper Case JSON payload returned just for this one WebAPI call within the application.</p>\n\n<p>I've tried [<a href=\"http://fizzylogic.nl/2014/07/30/changing-the-casing-of-json-properties-in-asp-dot-net-web-api/]\" rel=\"nofollow\">http://fizzylogic.nl/2014/07/30/changing-the-casing-of-json-properties-in-asp-dot-net-web-api/]</a> this, but I was not able to get the ActionFilterAttribute.OnActionExecuting to fire. So the solution did not work.</p>\n\n<p>I also added the following line of code in the WebAPI method</p>\n\n<pre><code>GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ContractResolver = new JsonContractResolver(new JsonMediaTypeFormatter());\n</code></pre>\n\n<p>This works, but Proper Case now becomes the default format for other WebAPI calls.</p>\n\n<p>Here's the WebAPI snippet</p>\n\n<pre><code>public JTableDtoImpl Get(int id, int jtStartIndex = 0, int jtPageSize = 0, string jtSorting = \"\") {\n        List&lt;MobileOrderModel&gt; orders = _svc.GetMobileOrders(id);\n        var dto = new JTableDtoMobileOrdersImpl(orders, jtStartIndex, jtPageSize) {\n            Message = string.Format(\"DataSource:{0}\", _svc.DataSource)\n        };\n        GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.ContractResolver = new JsonContractResolver(new JsonMediaTypeFormatter());\n        return dto;\n}\n</code></pre>\n\n<p>Problem here is that I now cannot revert back to default camel case formatting since the method has returned by then.</p>\n\n<p>Any other suggestions?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1636, "user_id": 292039, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/b24a79efecb701b028563f0a067c3477?s=128&d=identicon&r=PG", "display_name": "sithereal", "link": "https://stackoverflow.com/users/292039/sithereal"}, "edited": false, "score": 0, "creation_date": 1424900314, "post_id": 28729854, "comment_id": 45746505, "body": "can you provide Form1.Designer.cs?"}, {"owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "reply_to_user": {"reputation": 1636, "user_id": 292039, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/b24a79efecb701b028563f0a067c3477?s=128&d=identicon&r=PG", "display_name": "sithereal", "link": "https://stackoverflow.com/users/292039/sithereal"}, "edited": false, "score": 0, "creation_date": 1424900820, "post_id": 28729854, "comment_id": 45746770, "body": "Added it to the original post for you. It default created by VSE"}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 1, "creation_date": 1424900965, "post_id": 28729854, "comment_id": 45746833, "body": "Sorry, what? Forgive me for potentially asking something stupid, but is your <i>form</i> resizing when you click the button or is a new dialog box put on top of your form, containing an error message? Because that&#39;s what I&#39;d expect. Not a resizing form."}, {"owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "edited": false, "score": 0, "creation_date": 1424901123, "post_id": 28729854, "comment_id": 45746912, "body": "My original program is much bigger but after finding the issue i cut it right back. So yes all the form code is posted.  Steps to recreate, 1. New C# application,  2. add a button 3. add my code.      ...........  When running the code, the form loads. Click the button and the form shrinks"}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 1, "creation_date": 1424901709, "post_id": 28729854, "comment_id": 45747209, "body": "Does the shrunken form have an &quot;OK&quot; button on it, by any chance?"}, {"owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "edited": false, "score": 0, "creation_date": 1424901901, "post_id": 28729854, "comment_id": 45747309, "body": "just a bog standard button. The button literally just opens and closed a db connection."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424902263, "post_id": 28729854, "comment_id": 45747447, "body": "What happens if you remove the <code>try</code>/<code>catch</code> block and just do <code>myConn.Open()</code>?"}, {"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1424902322, "post_id": 28729854, "comment_id": 45747462, "body": "Can you show screenshots?"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1424902385, "post_id": 28729854, "comment_id": 45747491, "body": "My guess is it&#39;s the <code>AutoScaleMode</code>.  Try setting it to <code>None</code> and see if the problem goes away,"}, {"owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "edited": false, "score": 0, "creation_date": 1424903713, "post_id": 28729854, "comment_id": 45748120, "body": "AutoscaleMode does nothing. Removing try/catch does nothing.   Uploaded a video to youtube. apologies for the shaky hands."}, {"owner": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 0, "creation_date": 1424904458, "post_id": 28729854, "comment_id": 45748488, "body": "What is your Windows DPI setting?"}, {"owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "edited": false, "score": 0, "creation_date": 1424905889, "post_id": 28729854, "comment_id": 45749094, "body": "<a href=\"http://youtu.be/zdby6gmbX_4\" rel=\"nofollow noreferrer\">youtu.be/zdby6gmbX_4</a>"}, {"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 1, "creation_date": 1424953808, "post_id": 28729854, "comment_id": 45767898, "body": "I find it very hard to believe the <code>OleDbConnection</code> is the cause. Does it work without? Do you have any IntelliPoint / Logitech mouse helpers installed?"}, {"owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "edited": false, "score": 0, "creation_date": 1424958236, "post_id": 28729854, "comment_id": 45770662, "body": "Happens on PC and laptop. Has anyone tried it to see? No mouse helpers that i know of"}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1424958247, "post_id": 28729854, "comment_id": 45770673, "body": "Obviously <code>OleDbConnection</code> is irrelevant. It looks like some problem with DPI -- the form is scaled correctly on startup, but jumps to the lower DPI when the button is clicked. As to what could cause that, no clue (common control library mismatch? Assistive technology? Windows Update?), but it ain&#39;t a database connection."}, {"owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "edited": false, "score": 0, "creation_date": 1424967762, "post_id": 28729854, "comment_id": 45777209, "body": "I used the flowing to test for DPI and it reports 96 dpi onload and after button click  <code>float dpiX, dpiY;             Graphics graphics = this.CreateGraphics();             dpiX = graphics.DpiX;             dpiY = graphics.DpiY;              label1.Text = dpiX.ToString() + &quot; x &quot; + dpiY.ToString();</code>"}, {"owner": {"reputation": 1, "user_id": 14213858, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gg9wTvCEiuZWoBAhEgk7CGybDEqqybthmXYki1c=k-s128", "display_name": "TALAL AHMED", "link": "https://stackoverflow.com/users/14213858/talal-ahmed"}, "edited": false, "score": 0, "creation_date": 1599122968, "post_id": 28729854, "comment_id": 112693713, "body": "Just try to change the resolution of your screen from display settings. It worked for me!"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 2757016, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gRB6u.jpg?s=128&g=1", "display_name": "sgtBlueBird", "link": "https://stackoverflow.com/users/2757016/sgtbluebird"}, "edited": false, "score": 0, "creation_date": 1472195031, "post_id": 29291714, "comment_id": 65663834, "body": "I didn&#39;t think this would&#39;ve worked but it did. Thanks a lot, you saved me!"}], "tags": [], "owner": {"reputation": 41, "user_id": 4718730, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152976680140668/picture?type=large", "display_name": "Glenn Wilson", "link": "https://stackoverflow.com/users/4718730/glenn-wilson"}, "is_accepted": false, "score": 4, "last_activity_date": 1427488827, "last_edit_date": 1427488827, "creation_date": 1427418877, "answer_id": 29291714, "question_id": 28729854, "link": "https://stackoverflow.com/questions/28729854/oledb-oledbconnection-resizing-form-bug/29291714#29291714", "title": "OleDb / OleDbConnection resizing form (bug?)", "body": "<p>This must be a OleDb or .NET bug.   It is only noticeable on very high resolution screens and the simple act of calling OleDb.OleDbConnection.Open causes the form to ignore any DPI or Font scaling.</p>\n\n<p>I've tried moving the call to open the OleDb to a separate class and also to a separate DLL but the results are always the same.</p>\n\n<p>A user posted an example on YouTube here: <a href=\"https://www.youtube.com/watch?v=zdby6gmbX_4\" rel=\"nofollow\">https://www.youtube.com/watch?v=zdby6gmbX_4</a></p>\n\n<p>I guess we'll just need to report it to MS</p>\n\n<p>***** Found a way to fix it</p>\n\n<p>If you uninstall the \"Microsoft Access Database Engine 2010 Redistributable\" 32 bit version and then install the 64 bit version.  You then uninstall the 64 bit version and then reinstall the 32 bit version it will now work</p>\n"}], "owner": {"reputation": 33, "user_id": 4333998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d3864fcf3ccca1f1605cb430eb45e45?s=128&d=identicon&r=PG&f=1", "display_name": "Osprey231", "link": "https://stackoverflow.com/users/4333998/osprey231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1313, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1599122968, "creation_date": 1424899326, "last_edit_date": 1424903794, "question_id": 28729854, "link": "https://stackoverflow.com/questions/28729854/oledb-oledbconnection-resizing-form-bug", "title": "OleDb / OleDbConnection resizing form (bug?)", "body": "<p>Can someone help with a problem I can't seem to resolve.  I have created a C# form in both VSE2012 express for desktop and VSE2013 express for Desktop, where i have left the form the default size and added one button again totally default. The button is coded to open and close a db connection. </p>\n\n<p>When the button is clicked the form and its contents all shrink by about 25%, i have tried all the default setting with no joy. I even substituted the access db file for a text file and it still happens.  Tried this on both window 7 and 8.1</p>\n\n<p>Form1.cs (all the code)</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing System.Data.OleDb;\n\nnamespace WindowsFormsApplication2\n{\n\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        OleDbConnection myConn = new OleDbConnection(\"Provider=Microsoft.ACE.OLEDB.12.0;\"\n    + @\"Data Source=\"\n    + @\"..\\..\\..\\x.accdb\");\n\n\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            try\n            {\n\n                myConn.Open();\n                myConn.Close();\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Uneditted Form1.Designer.cs</p>\n\n<pre><code>#region Windows Form Designer generated code\n\n/// &lt;summary&gt;\n/// Required method for Designer support - do not modify\n/// the contents of this method with the code editor.\n/// &lt;/summary&gt;\nprivate void InitializeComponent()\n{\n    this.button1 = new System.Windows.Forms.Button();\n    this.SuspendLayout();\n    // \n    // button1\n    // \n    this.button1.Location = new System.Drawing.Point(106, 138);\n    this.button1.Name = \"button1\";\n    this.button1.Size = new System.Drawing.Size(75, 23);\n    this.button1.TabIndex = 0;\n    this.button1.Text = \"button1\";\n    this.button1.UseVisualStyleBackColor = true;\n    this.button1.Click += new System.EventHandler(this.button1_Click);\n    // \n    // Form1\n    // \n    this.AutoScaleDimensions = new System.Drawing.SizeF(8F, 16F);\n    this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n    this.ClientSize = new System.Drawing.Size(282, 253);\n    this.Controls.Add(this.button1);\n    this.Name = \"Form1\";\n    this.Text = \"Form1\";\n    this.ResumeLayout(false);\n\n}\n\n#endregion\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "cookies", "asp.net-mvc-5", "forms-authentication"], "comments": [{"owner": {"reputation": 37911, "user_id": 130387, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/I6FfT.jpg?s=128&g=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/130387/tommy"}, "edited": false, "score": 0, "creation_date": 1424899363, "post_id": 28729732, "comment_id": 45745900, "body": "First, you can do custom authentication and still use the provided functionality of <code>SetAuthCookie().</code> This takes care of things automatically such as sliding expiration, which your code is showing you did not do right.  For example, if you are extending the timeout by 10 minutes each time and I hit 10 pages on your site in under a minute, you are going to add 100 minutes to my cookie expiration time.  If someone spends a few hours on your site, their cookie might not expire for years."}, {"owner": {"reputation": 4408, "user_id": 1979729, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ddfbfebda687c12ca91b02c683f4c3a2?s=128&d=identicon&r=PG&f=1", "display_name": "neildt", "link": "https://stackoverflow.com/users/1979729/neildt"}, "reply_to_user": {"reputation": 37911, "user_id": 130387, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/I6FfT.jpg?s=128&g=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/130387/tommy"}, "edited": false, "score": 0, "creation_date": 1424940156, "post_id": 28729732, "comment_id": 45759558, "body": "@Tommy The sliding expiration is working correctly, it takes the current DateTime."}, {"owner": {"reputation": 37911, "user_id": 130387, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/I6FfT.jpg?s=128&g=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/130387/tommy"}, "edited": false, "score": 0, "creation_date": 1424959840, "post_id": 28729732, "comment_id": 45771738, "body": "I see that now and cannot edit my comment, but the first part stands.  You can authenticate people however you want and then use the SetAuthCookie to handle the cookie parts of authentication."}], "answers": [{"tags": [], "owner": {"reputation": 7510, "user_id": 1324741, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Awrr0.jpg?s=128&g=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/1324741/derek"}, "is_accepted": true, "score": 1, "last_activity_date": 1424974631, "creation_date": 1424974631, "answer_id": 28749842, "question_id": 28729732, "link": "https://stackoverflow.com/questions/28729732/custom-mvc-authentication-without-setauthcookie/28749842#28749842", "title": "Custom MVC Authentication without SetAuthCookie()", "body": "<p>You basically need to look at creating a Custom Authentication Attribute.</p>\n\n<p>I'm not going to provide the actual implementation here, but this will put you on the right path.</p>\n\n<p>Here's the basic representation :-</p>\n\n<pre><code> public class GoogleAuthAttribute : FilterAttribute, IAuthenticationFilter\n    {\n        public void OnAuthentication(AuthenticationContext filterContext)\n        {\n\n            IIdentity ident = filterContext.Principal.Identity;\n\n            if (!ident.IsAuthenticated || !ident.Name.EndsWith(\"@google.com\"))\n            {\n                filterContext.Result = new HttpUnauthorizedResult();\n            }\n        }\n\n        public void OnAuthenticationChallenge(AuthenticationChallengeContext filterContext)\n        {\n            if (filterContext.Result == null || filterContext.Result is HttpUnauthorizedResult)\n            {\n                filterContext.Result =\n                    new RedirectToRouteResult(new RouteValueDictionary\n                    {\n                        {\"controller\", \"GoogleAccount\"},\n                        {\"action\", \"Login\"},\n                        {\"returnUrl\", filterContext.HttpContext.Request.RawUrl}\n                    });\n            }\n\n        }\n    }\n</code></pre>\n\n<p>I've took this from the Apress Book i'm currently reading on MVC5. If OnAuthentification fails, you set the Result property of the AuthenticationContext, this is then passed to the AuthenticationChallengeContext, where you can add your challenge code.</p>\n\n<p>In my example, the user is redirected to the login page.</p>\n\n<p>All you need t do, is place this AuthentificationAttribute on the Action Methods you require.</p>\n\n<p>You should be able to build in or work your custome security code in to this.</p>\n\n<p>You should really ask yourself if its a good idea to be adding custom security measures, as it can lead to more problems that you want.</p>\n"}], "owner": {"reputation": 4408, "user_id": 1979729, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ddfbfebda687c12ca91b02c683f4c3a2?s=128&d=identicon&r=PG&f=1", "display_name": "neildt", "link": "https://stackoverflow.com/users/1979729/neildt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 1, "accepted_answer_id": 28749842, "answer_count": 1, "score": 0, "last_activity_date": 1424974631, "creation_date": 1424898859, "question_id": 28729732, "link": "https://stackoverflow.com/questions/28729732/custom-mvc-authentication-without-setauthcookie", "title": "Custom MVC Authentication without SetAuthCookie()", "body": "<p>Because of the requirements of my project, I'm wanting to provide custom authenticate for my MVC controller actions.  Therefore, I will not be using SetAuthCookie().</p>\n\n<p>Intially I set a cookie as follows;</p>\n\n<pre><code>string userData = EncDec.MakeString(user.Email + \"|\" + user.UserId);\n\n//the Cookie and FormsAuthenticationTicket expiration date/time is the same\nDateTime cookieExpiry = DateTime.Now.AddMinutes(AccountPage.MvcApplication.COOKIE_EXPIRY_MINUTES);\n\nFormsAuthenticationTicket ticket = new FormsAuthenticationTicket(\n          1,                                     // ticket version\n          user.UserName,                         // authenticated username\n          DateTime.Now,                          // issueDate\n          cookieExpiry,                          // expiryDate\n          false,                                 // true to persist across browser sessions\n          userData,                              // can be used to store additional user data\n          FormsAuthentication.FormsCookiePath);  // the path for the cookie\n\nstring encryptedTicket = FormsAuthentication.Encrypt(ticket);\n\n//create the cookie\nHttpCookie cookie = new HttpCookie(\"ADV_\" + Extensions.ControllerExtensionMethods.GetGuid(this), encryptedTicket);\ncookie.Secure = true;\ncookie.HttpOnly = true;\ncookie.Expires = cookieExpiry;\nResponse.Cookies.Add(cookie);\n</code></pre>\n\n<p>The HttpCookie is being saved in the client browser with a encrypted FormsAuthenticationTicket. </p>\n\n<p>Then within my controller actions, whenever I need to check and verify that the user is authenticated I call this method;</p>\n\n<pre><code>public static FormsAuthenticationTicket IsAuthenticated(string guid)\n{\n     HttpCookie cookie = HttpContext.Current.Request.Cookies[\"ADV_\" + guid];\n\n     if (cookie != null)\n     {\n           string encryptedTicket = cookie.Value;\n           FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt(encryptedTicket);\n\n            if (!ticket.Expired)\n            {\n               //if the user is authenticated and the cookie hasn't expired we increase the expiry of the cookie - keep alive\n               DateTime cookieExpiry = DateTime.Now.AddMinutes(AccountPage.MvcApplication.COOKIE_EXPIRY_MINUTES);\n\n               //create a new ticket based on the existing one\n               FormsAuthenticationTicket newTicket = new FormsAuthenticationTicket(\n                      ticket.Version,                        // ticket version\n                      ticket.Name,                           // authenticated username\n                      ticket.IssueDate,                      // issueDate\n                      cookieExpiry,                          // expiryDate, changed to keep alive if user is navigating around site\n                      false,                                 // true to persist across browser sessions\n                      ticket.UserData,                       // can be used to store additional user data\n                      ticket.CookiePath);                    // the path for the cookie\n\n               string newEncryptedTicket = FormsAuthentication.Encrypt(newTicket);\n\n               //keep alive\n               HttpCookie newCookie = new HttpCookie(\"ADV_\" + guid, newEncryptedTicket);\n               newCookie.Secure = true;\n               newCookie.HttpOnly = true;\n               newCookie.Expires = cookieExpiry;\n\n               HttpContext.Current.Response.Cookies.Set(newCookie);\n\n               return newTicket;\n          }\n     }\n\n            return null; \n}\n</code></pre>\n\n<p>Every time the user is re-authenticated, I am increasing the time out of when the cookie will expire, so that the login is keep alive.</p>\n\n<p>Everything seems to work fine, and the users are correctly authenticated, and if they aren't authenticated I redirect them to a login page, and they can't access methods if they aren't authenticated either.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>Is this way of dealing with the authentication secure.</li>\n<li>Is there anything I should be aware of, in terms of a security risk.</li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "clone", "automapper", "deep-copy", "valueinjecter"], "comments": [{"owner": {"reputation": 14733, "user_id": 2589202, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/KBJx4.jpg?s=128&g=1", "display_name": "crthompson", "link": "https://stackoverflow.com/users/2589202/crthompson"}, "edited": false, "score": 1, "creation_date": 1424899023, "post_id": 28729683, "comment_id": 45745721, "body": "How about a nice <a href=\"http://stackoverflow.com/a/13199808/2589202\">reflection and recursion</a>?"}, {"owner": {"reputation": 9933, "user_id": 678410, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/57083a995514ca4e66842dec135edd6f?s=128&d=identicon&r=PG", "display_name": "Anders Forsgren", "link": "https://stackoverflow.com/users/678410/anders-forsgren"}, "edited": false, "score": 0, "creation_date": 1424899309, "post_id": 28729683, "comment_id": 45745875, "body": "To clone an object with any kind of hand-rolled serialization (reflection and recursion as suggested) you should start by just creating a blank instance <i>without</i> constructor call, via <code>FormatterServices.GetUninitializedObject(type)</code>."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1424899484, "post_id": 28729683, "comment_id": 45745976, "body": "Maybe something like:<a href=\"https://code.msdn.microsoft.com/CSDeepCloneObject-8a53311e\" rel=\"nofollow noreferrer\">code.msdn.microsoft.com/CSDeepCloneObject-8a53311e</a> or  <a href=\"http://www.codeproject.com/Articles/38270/Deep-copy-of-objects-in-C\" rel=\"nofollow noreferrer\">codeproject.com/Articles/38270/Deep-copy-of-objects-in-C</a> or <a href=\"http://thomashapp.com/node/106\" rel=\"nofollow noreferrer\">thomashapp.com/node/106</a>"}, {"owner": {"reputation": 34608, "user_id": 84206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144fd462785db33cf6665cafd54101c7?s=128&d=identicon&r=PG", "display_name": "AaronLS", "link": "https://stackoverflow.com/users/84206/aaronls"}, "edited": false, "score": 0, "creation_date": 1424900067, "post_id": 28729683, "comment_id": 45746354, "body": "I&#39;d personally create my own class for each of theirs, and inherit theirs.  Many of the above techniques will fail if they update their library and change their classes.  It&#39;ll be easier to mitigate these problems in your own classes, and you can even add properties that better suit the needs of your editor."}, {"owner": {"reputation": 16232, "user_id": 224410, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f43a88df1e9cb67bb9ca09038e1382d1?s=128&d=identicon&r=PG", "display_name": "wal", "link": "https://stackoverflow.com/users/224410/wal"}, "edited": false, "score": 1, "creation_date": 1424900612, "post_id": 28729683, "comment_id": 45746660, "body": "I think this is a fair enough question and different from the dup. link insofar as he/she doesnt have access to the classes being cloned"}], "answers": [{"comments": [{"owner": {"reputation": 368, "user_id": 3574368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3275560ad9b8e65250e4c14d28e3aa24?s=128&d=identicon&r=PG&f=1", "display_name": "mslissap", "link": "https://stackoverflow.com/users/3574368/mslissap"}, "edited": false, "score": 0, "creation_date": 1424987787, "post_id": 28730378, "comment_id": 45788852, "body": "Thanks for the recommendation. I was finally able to get the first of 7 fields to copy successfully using AutoMapper. I&#39;m still not sure this is the best solution though. The PDFView4Net class library contains 266 classes. It took over 400 lines of code just to get that first one to copy without error. Still, I guess it&#39;s better than doing it all manually."}, {"owner": {"reputation": 16232, "user_id": 224410, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f43a88df1e9cb67bb9ca09038e1382d1?s=128&d=identicon&r=PG", "display_name": "wal", "link": "https://stackoverflow.com/users/224410/wal"}, "reply_to_user": {"reputation": 368, "user_id": 3574368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3275560ad9b8e65250e4c14d28e3aa24?s=128&d=identicon&r=PG&f=1", "display_name": "mslissap", "link": "https://stackoverflow.com/users/3574368/mslissap"}, "edited": false, "score": 0, "creation_date": 1424987848, "post_id": 28730378, "comment_id": 45788882, "body": "@mslissap why so many lines ?? (how many classes were involved in that first copy?)"}, {"owner": {"reputation": 368, "user_id": 3574368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3275560ad9b8e65250e4c14d28e3aa24?s=128&d=identicon&r=PG&f=1", "display_name": "mslissap", "link": "https://stackoverflow.com/users/3574368/mslissap"}, "edited": false, "score": 0, "creation_date": 1424988666, "post_id": 28730378, "comment_id": 45789242, "body": "116 classes for the 1st copy. The vendor uses a lot of &quot;mini&quot; classes to inherit from (property is C, inherits from B, inherits from A, inherits from base). There could be 4-5 classes required for just one property. This was the simplest one of the 7 objects I need to copy, though the others use a lot of the same &quot;base&quot; classes to inherit from. For many of those I had to create a ResolutionContext for CreateMap.ConstructUsing since there was no parameterless constructor (I defaulted these), then create an AfterMap action to get the real value out of the source and into the destination."}, {"owner": {"reputation": 16232, "user_id": 224410, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f43a88df1e9cb67bb9ca09038e1382d1?s=128&d=identicon&r=PG", "display_name": "wal", "link": "https://stackoverflow.com/users/224410/wal"}, "reply_to_user": {"reputation": 368, "user_id": 3574368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3275560ad9b8e65250e4c14d28e3aa24?s=128&d=identicon&r=PG&f=1", "display_name": "mslissap", "link": "https://stackoverflow.com/users/3574368/mslissap"}, "edited": false, "score": 0, "creation_date": 1424990603, "post_id": 28730378, "comment_id": 45790098, "body": "@mslissap woah nasty! However i do not believe there is an easy/quick solution to what you are trying to achieve. Conceptually (say to a manager!) it seems easy as you just want to copy an object but the reality is much more difficult. At least you have the ability to write good tests to check your copying is correct."}], "tags": [], "owner": {"reputation": 16232, "user_id": 224410, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f43a88df1e9cb67bb9ca09038e1382d1?s=128&d=identicon&r=PG", "display_name": "wal", "link": "https://stackoverflow.com/users/224410/wal"}, "is_accepted": true, "score": 3, "last_activity_date": 1424901173, "creation_date": 1424901173, "answer_id": 28730378, "question_id": 28729683, "link": "https://stackoverflow.com/questions/28729683/deep-copy-of-complex-third-party-objects-classes/28730378#28730378", "title": "Deep Copy of Complex Third Party Objects/Classes", "body": "<p>I would use AutoMapper for this. Consider the following class definition: (note private ctor)</p>\n\n<pre><code>public class Parent\n{\n    public string Field1 { get; set; }\n    public Level1 Level1 { get; set; }\n    public static Parent GetInstance()\n    {\n        return new Parent() { Field1 = \"1\", Level1 = new Level1 { Field2 = \"2\", Level2 = new Level2() { Field3 = \"3\"}}};\n    }\n    private Parent()  {              }\n}\n\npublic class Level1\n{\n    public string Field2 { get; set; }\n    public Level2 Level2 { get; set; }\n}\n\npublic class Level2\n{\n    public string Field3 { get; set; }\n}\n</code></pre>\n\n<p>You can then setup AutoMapper to deep clone as required:</p>\n\n<pre><code>[TestMethod]\npublic void DeepCloneParent()\n{\n    Mapper.CreateMap&lt;Parent, Parent&gt;();\n    Mapper.CreateMap&lt;Level1, Level1&gt;();\n    Mapper.CreateMap&lt;Level2, Level2&gt;();\n    var parent = Parent.GetInstance();\n\n    var copy = Mapper.Map&lt;Parent, Parent&gt;(parent);\n\n    Assert.IsFalse(copy == parent);//diff object\n    Assert.IsFalse(copy.Level1 == parent.Level1);//diff object\n    Assert.IsFalse(copy.Level1.Level2 == parent.Level1.Level2);//diff object\n    Assert.AreEqual(\"1\", copy.Field1);\n    Assert.AreEqual(\"2\", copy.Level1.Field2);\n    Assert.AreEqual(\"3\", copy.Level1.Level2.Field3);\n}\n</code></pre>\n"}], "owner": {"reputation": 368, "user_id": 3574368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3275560ad9b8e65250e4c14d28e3aa24?s=128&d=identicon&r=PG&f=1", "display_name": "mslissap", "link": "https://stackoverflow.com/users/3574368/mslissap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1270, "favorite_count": 0, "closed_date": 1424904549, "accepted_answer_id": 28730378, "answer_count": 1, "score": 13, "last_activity_date": 1424987817, "creation_date": 1424898703, "last_edit_date": 1424987817, "question_id": 28729683, "link": "https://stackoverflow.com/questions/28729683/deep-copy-of-complex-third-party-objects-classes", "closed_reason": "Duplicate", "title": "Deep Copy of Complex Third Party Objects/Classes", "body": "<p>I'm have been working on a project to create PDF forms using PDFView4Net. While the library is generally good, the forms creator is primitive and lacking basic features (such as copy/paste, alignment, formatting, etc.) when working with form fields (i.e. text boxes, check boxes, etc.). </p>\n\n<p><strong><em>The problem</em></strong>: I have been extending the functionality for field objects and getting tripped up on copy/paste. To do this, I need a deep copy of the object with no references to the original whatsoever. I emailed the vendor, requesting information about their recommended method for copying these objects, to which they replied I needed make a copy of each property by hand, manually ... <em>beats head on desk</em>. These are large classes, with multiple embedded classes as properties, as well as UI elements.</p>\n\n<p><strong><em>The question</em></strong>: Are there any good methods out there that perform a deep copy for complex objects that don't require serialization, doesn't require access to or changes to the source classes and doesn't require a default constructor?</p>\n\n<p><strong><em>What I have tried/reviewed</em></strong>:\nI have researched various ways to make a deep copy of an object and discarded them one by one:</p>\n\n<ul>\n<li>Manually, Property by Painstaking Property: I attempted this with the first of 7 field objects (PDFTextBoxField), but it quickly got out of hand with the multitude properties that are also different types of classes. In the end, I still had lingering references to the original object where it a shallow copy was created instead of a deep copy as intended.</li>\n<li>Serialization: The classes are not marked as Serializable, nor will the vendor change this. I asked them to and they said no.</li>\n<li>ICloneable: Would need to be implemented by the vendor.</li>\n<li>AutoMapper: This seems to be for copying data from one or more object types into another object type. The objects I'm working with are the same type. Though I'm not opposed to using this if it is the best solution.</li>\n<li>Emit Mapper: This project appears to have been abandoned.</li>\n<li>MemberwiseClone: Does a shallow copy, not the deep copy I'm looking for, though this is suggested on a ton of other posts when the questioner specifically requests a deep copy.</li>\n<li>Value Injecter: I implemented FastDeepCloneInjection from <a href=\"http://valueinjecter.codeplex.com/wikipage?title=Faster%20Deep%20Cloning%20using%20SmartConventionInjection%20and%20FastMember&amp;referringTitle=Deep%20Cloning\" rel=\"noreferrer\">ValueInjecter</a> on CodePlex but the majority of the classes that need to be injected from do not have a 0 parameter constructor which is required when creating a new instance for the copy. ValueInjecter doesn't allow skipping of certain properties, or I would just skip the items with no default constructor and leave them set to null (the default). I ran into this right away with the very first class. To attempt to get around the issue, I created a wrapper class inherited from the original and cast the original into the wrapper (and vice versa on return), but I don't think that's a good solution.</li>\n</ul>\n\n<p><strong>Edit:</strong> I really do not feel this question is a duplicate. I've searched extensively for a solution, including the post marked as the duplicate/original, and was unable to find a satisfactory resolution. As stated, I don't have access to change the classes that I need to copy. This discounts DataContractSerializer, BinaryFormatter, and any other type of serialization. This also discounts the reflection examples I've seen using Activator.CreateInstance, as about 95% of the classes I need to copy don't have a constructor that takes 0 arguments. This is the same issue I ran into using ValueInjecter. This also discounts using ICloneable.</p>\n"}, {"tags": ["c#", ".net", "asynchronous", "tcpclient", "freeze"], "comments": [{"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 2, "creation_date": 1424898989, "post_id": 28729662, "comment_id": 45745710, "body": "If you want to <b>ping</b> a machine, use <i>ping</i>, not <code>tcpClient.Connect</code>"}, {"owner": {"reputation": 45, "user_id": 4458006, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/256077469c951339d603588bf618ba01?s=128&d=identicon&r=PG&f=1", "display_name": "Showdown", "link": "https://stackoverflow.com/users/4458006/showdown"}, "reply_to_user": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1424899376, "post_id": 28729662, "comment_id": 45745906, "body": "Ping sadly doesn&#39;t support ports, or does it?"}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1424899808, "post_id": 28729662, "comment_id": 45746192, "body": "<a href=\"http://www.perlmonks.org/?node=xy+problem\" rel=\"nofollow noreferrer\">perlmonks.org/?node=xy+problem</a> How about explaining your real problem."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4458006, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/256077469c951339d603588bf618ba01?s=128&d=identicon&r=PG&f=1", "display_name": "Showdown", "link": "https://stackoverflow.com/users/4458006/showdown"}, "edited": false, "score": 0, "creation_date": 1424900156, "post_id": 28729947, "comment_id": 45746412, "body": "I should have taken more time looking into the tcpclient class, maybe then I&#39;d have seen that it has its own timeout property. &gt;.&gt; Thank you very much :)"}, {"owner": {"reputation": 45, "user_id": 4458006, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/256077469c951339d603588bf618ba01?s=128&d=identicon&r=PG&f=1", "display_name": "Showdown", "link": "https://stackoverflow.com/users/4458006/showdown"}, "edited": false, "score": 0, "creation_date": 1425208770, "post_id": 28729947, "comment_id": 45860617, "body": "I noticed that the timeout property doesn&#39;t apply to the connection establishment. Anyways, I found a solution for an asynchronous TCPclient ping request with timeout. I simply dispose my tcpclient, as soon as it takes more time than the given timeout value."}, {"owner": {"reputation": 1564, "user_id": 3250318, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/EFWrn.jpg?s=128&g=1", "display_name": "Adam Heeg", "link": "https://stackoverflow.com/users/3250318/adam-heeg"}, "reply_to_user": {"reputation": 45, "user_id": 4458006, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/256077469c951339d603588bf618ba01?s=128&d=identicon&r=PG&f=1", "display_name": "Showdown", "link": "https://stackoverflow.com/users/4458006/showdown"}, "edited": false, "score": 0, "creation_date": 1502112797, "post_id": 28729947, "comment_id": 78055964, "body": "@Showdown can you share any links or info regarding your comment &#39;the timeout property doesn&#39;t apply to the connection establishment.&#39;"}], "tags": [], "owner": {"reputation": 6154, "user_id": 3447502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G5H93.png?s=128&g=1", "display_name": "MatthewG", "link": "https://stackoverflow.com/users/3447502/matthewg"}, "is_accepted": false, "score": 2, "last_activity_date": 1424899646, "creation_date": 1424899646, "answer_id": 28729947, "question_id": 28729662, "link": "https://stackoverflow.com/questions/28729662/tcp-client-connection-freezes-program/28729947#28729947", "title": "TCP client connection freezes program", "body": "<p>If you want your application to remain responsive and not hang, you cannot build your own loop and keep the thread occupied.  Instead, let C# take care of managing the Task for you by using the <code>await</code> keyword.  Instead of looping and checking for timeout, just set a timeout on the request using <code>SendTimeout</code>.  Here is an example:</p>\n\n<pre><code>    public async void Start(string ip)\n    {\n        label1.Text = \"Begin\";\n        Stopwatch watch = new Stopwatch();\n\n        while (true)\n        {\n            watch.Restart();\n            using (TcpClient tcp = new TcpClient())\n            {\n                //try to connect to a closed port\n                // First set a timeout value\n                tcp.SendTimeout = 1000;\n                try\n                {\n                    await tcp.ConnectAsync(\"127.0.0.1\", 1234);\n                }\n                catch (SocketException)\n                {\n                    Debug.Assert(!tcp.Connected);\n                }\n\n                watch.Stop();\n                if (tcp.Connected)\n                {\n                    label1.Text = watch.ElapsedMilliseconds.ToString() + \" ms\";\n                }\n                else\n                {\n                    label1.Text = \"Offline\";\n                }\n            }\n            //wait 3secs for the next request\n            await Task.Delay(3000);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 4458006, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/256077469c951339d603588bf618ba01?s=128&d=identicon&r=PG&f=1", "display_name": "Showdown", "link": "https://stackoverflow.com/users/4458006/showdown"}, "is_accepted": true, "score": 1, "last_activity_date": 1425209395, "creation_date": 1425209395, "answer_id": 28793009, "question_id": 28729662, "link": "https://stackoverflow.com/questions/28729662/tcp-client-connection-freezes-program/28793009#28793009", "title": "TCP client connection freezes program", "body": "<p>If you want to do an asynchronous ping request to a port along with a timeout, this code did it for me:</p>\n\n<pre><code>    private async Task&lt;long&gt; Ping(string host, int port, int timeOut)\n    {\n        long elapsed = -1;\n        Stopwatch watch = new Stopwatch();\n\n        using (TcpClient tcp = new TcpClient())\n        {\n            try\n            {\n                using (CancellationTokenSource cts = new CancellationTokenSource())\n                {\n                    StartConnection(host, port, tcp, watch, cts);\n                    await Task.Delay(timeOut, cts.Token);\n                }\n            }\n            catch {}\n            finally\n            {\n                if (tcp.Connected)\n                {\n                    tcp.GetStream().Close();\n                    elapsed = watch.ElapsedMilliseconds;\n                }\n                tcp.Close();\n            }\n        }\n\n        return elapsed;\n    }\n\n    private async void StartConnection(string host, int port, TcpClient tcp, Stopwatch watch, CancellationTokenSource cts)\n    {\n        try\n        {\n            watch.Start();\n            await tcp.ConnectAsync(host,port);\n            watch.Stop();\n            cts.Cancel();\n        }\n        catch {}\n    }\n</code></pre>\n\n<p>It simply disposes the tcpClient as soon as the time is over and returns -1 when the server is offline or something went wrong.</p>\n"}], "owner": {"reputation": 45, "user_id": 4458006, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/256077469c951339d603588bf618ba01?s=128&d=identicon&r=PG&f=1", "display_name": "Showdown", "link": "https://stackoverflow.com/users/4458006/showdown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3117, "favorite_count": 0, "accepted_answer_id": 28793009, "answer_count": 2, "score": 0, "last_activity_date": 1425209395, "creation_date": 1424898644, "question_id": 28729662, "link": "https://stackoverflow.com/questions/28729662/tcp-client-connection-freezes-program", "title": "TCP client connection freezes program", "body": "<p>I'd like to have an asynchronous continuous ping request on a ip + port.\nThe problem is, when the targeted server is offline, the whole program freezes during request time. But this shouldn't happen.</p>\n\n<p>This is my ping function which is called once when starting the program.\nIt should do a ping request every 3 seconds.</p>\n\n<pre><code>    public async void Start(string ip)\n    {\n        Stopwatch watch = new Stopwatch();\n\n        while (true)\n        {\n            watch.Restart();\n            using (TcpClient tcp = new TcpClient())\n            {\n                //try to connect to a closed port\n                IAsyncResult res = tcp.ConnectAsync(\"127.0.0.1\", 1234);\n\n                //during the following while-loop the whole program freezes\n                //although this is an asynchronous function\n                while (watch.ElapsedMilliseconds &lt; 1000) \n                {\n                    if (tcp.Connected)\n                    {\n                        break;\n                    }\n                }\n                watch.Stop();\n                if (tcp.Connected)\n                {\n                    StatusControl.Text = watch.ElapsedMilliseconds.ToString() + \" ms\";\n                }\n                else\n                {\n                    StatusControl.Text = \"Offline\";\n                }\n            }\n            //wait 3secs for the next request\n            await Task.Delay(3000);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "jquery", "kendo-ui"], "answers": [{"comments": [{"owner": {"reputation": 1248, "user_id": 1691103, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/wlrMV.png?s=128&g=1", "display_name": "Vahe Jabagchourian", "link": "https://stackoverflow.com/users/1691103/vahe-jabagchourian"}, "edited": false, "score": 0, "creation_date": 1424988543, "post_id": 28751810, "comment_id": 45789191, "body": "Thank you very much for the reply!  I appreciate it.  I got a suggestion from a colleague to use additional fields to capture minutes and seconds.  I made the change so now it is actually storing the field values.   The problem I face now is how to I &quot;get back&quot; the value from the two fields, minutes and seconds as a templated value in kendo.   I will post what I did for further clarification."}, {"owner": {"reputation": 1248, "user_id": 1691103, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/wlrMV.png?s=128&g=1", "display_name": "Vahe Jabagchourian", "link": "https://stackoverflow.com/users/1691103/vahe-jabagchourian"}, "edited": false, "score": 0, "creation_date": 1424989488, "post_id": 28751810, "comment_id": 45789582, "body": "I have modified my original post.  I am now trying to get the new value in the same cell as a concatenation of two other cells (namely, DurationMinutes and DurationSeconds)"}, {"owner": {"reputation": 1248, "user_id": 1691103, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/wlrMV.png?s=128&g=1", "display_name": "Vahe Jabagchourian", "link": "https://stackoverflow.com/users/1691103/vahe-jabagchourian"}, "edited": false, "score": 0, "creation_date": 1424994037, "post_id": 28751810, "comment_id": 45791342, "body": "Turns out my C# LINQ query was missing the required extra columns.  After adding in the columns (fields) in the query I was able to retrieve the proper timespan values successfully!"}], "tags": [], "owner": {"reputation": 19379, "user_id": 332124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddb14cbe41a6977ecc16075f372b0cd2?s=128&d=identicon&r=PG", "display_name": "Petur Subev", "link": "https://stackoverflow.com/users/332124/petur-subev"}, "is_accepted": true, "score": 1, "last_activity_date": 1424981361, "creation_date": 1424981361, "answer_id": 28751810, "question_id": 28729541, "link": "https://stackoverflow.com/questions/28729541/kendo-ui-how-do-i-capture-only-minutes-and-seconds-for-a-date-field-in-a-grid/28751810#28751810", "title": "Kendo UI - How do I capture only minutes and seconds for a date field in a grid?", "body": "<p>The appropriate way is to define your own <a href=\"http://docs.telerik.com/kendo-ui/api/javascript/data/datasource#configuration-transport.parameterMap\" rel=\"nofollow\">parameterMap</a> function for the transport. The work-around would be to use the <a href=\"http://docs.telerik.com/kendo-ui/api/javascript/data/datasource#configuration-transport.update.data\" rel=\"nofollow\">dataSource.transport.update.data</a> function to modify the data object or add one more value to it which uses the format you mentioned.</p>\n"}], "owner": {"reputation": 1248, "user_id": 1691103, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/wlrMV.png?s=128&g=1", "display_name": "Vahe Jabagchourian", "link": "https://stackoverflow.com/users/1691103/vahe-jabagchourian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 28751810, "answer_count": 1, "score": 0, "last_activity_date": 1424989416, "creation_date": 1424898271, "last_edit_date": 1424989416, "question_id": 28729541, "link": "https://stackoverflow.com/questions/28729541/kendo-ui-how-do-i-capture-only-minutes-and-seconds-for-a-date-field-in-a-grid", "title": "Kendo UI - How do I capture only minutes and seconds for a date field in a grid?", "body": "<p>How do I send only minutes/seconds from Kendo UI Grid to a server api method that receives my row data for an update operation?</p>\n\n<p>Using the following format I want hours to be zero and the model to receive minutes and seconds only, and not hours.</p>\n\n<p>Is this possible?</p>\n\n<p>EDIT</p>\n\n<p><strong>WebApi update method</strong></p>\n\n<pre><code>public void Post(int id, [FromBody]Episode value)\n{\n    var episode = db.Episodes.Find(value.id);\n    episode.DurationMinutes = value.DurationMinutes;\n    episode.DurationSeconds = value.DurationSeconds;\n    episode.Duration = new TimeSpan(0, value.DurationMinutes, value.DurationSeconds);  \n    db.SaveChanges();\n} \n</code></pre>\n\n<p><strong>Database Model</strong></p>\n\n<pre><code> public partial class Episode\n        {\n            public int Id { get; set; }\n            public Nullable&lt;System.TimeSpan&gt; Duration { get; set; }\n            public int DurationMinutes { get; set; }\n            public int DurationSeconds { get; set; }\n        }    \n</code></pre>\n\n<p><strong>Kendo Column Array - This is where I am trying to \"get\" the values I posted but in my Kendo grid I get undefined!</strong></p>\n\n<pre><code> var columns = [{\n            field: \"Duration\",\n            title: \"Duration\",\n            template: \"#= DurationMinutes + ':' + DurationSeconds #\",\n            width: 100\n        },\n        {\n            field: \"DurationMinutes\",\n            title: \"DurationMinutes\",\n            width: 100,\n            //hidden: true\n        },\n        {\n            field: \"DurationSeconds\",\n            title: \"DurationSeconds\",\n            width: 100,\n            //hidden: true\n        }];\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/SVv82.png\" alt=\"Example Grid\"></p>\n\n<p><strong>Parameter Map Definition</strong></p>\n\n<pre><code>    parameterMap: function (data, operation) {\n        if (operation === \"update\") {\n            var mm = data.Duration.split(':')[0];\n            var ss = data.Duration.split(':')[1]; \n            data.DurationMinutes = mm;\n            data.DurationSeconds = ss;\n            return kendo.data.transports.odata.parameterMap(data);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "oracle", "visual-studio-2012"], "comments": [{"owner": {"reputation": 3012, "user_id": 3101082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1WxPj.jpg?s=128&g=1", "display_name": "dub stylee", "link": "https://stackoverflow.com/users/3101082/dub-stylee"}, "edited": false, "score": 0, "creation_date": 1424898558, "post_id": 28729535, "comment_id": 45745473, "body": "It is telling you that the <code>GetString()</code> method is expecting an integer as the argument.  You need to provide the column index of the <code>Title</code> column, rather than the column name."}], "answers": [{"tags": [], "owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "is_accepted": false, "score": 0, "last_activity_date": 1424898612, "creation_date": 1424898612, "answer_id": 28729652, "question_id": 28729535, "link": "https://stackoverflow.com/questions/28729535/auto-complete-the-textbox-from-the-oracle-database/28729652#28729652", "title": "Auto complete the textbox from the oracle database", "body": "\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getstring.aspx\" rel=\"nofollow\"><code>GetString</code></a> takes an <code>int</code> as an argument. You're trying to pass a <code>string</code>. You can use <a href=\"https://msdn.microsoft.com/en-us/library/system.data.common.dbdatareader.getordinal.aspx\" rel=\"nofollow\"><code>GetOrdinal</code></a> to get the column ordinal of the named column:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>while (myReader.Read())\n{\n    string sName = myReader.GetString(myReader.GetOrdinal(\"Title\"));\n    coll.Add(sName);\n}\n</code></pre>\n\n<p>Alternatively, this should work as well:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>string sName = (string) myReader[\"Title\"];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4607593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5194bb7fcacc55b0b4aaf99a2f669d81?s=128&d=identicon&r=PG&f=1", "display_name": "Shoeb_Shahriar", "link": "https://stackoverflow.com/users/4607593/shoeb-shahriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424898621, "creation_date": 1424898268, "last_edit_date": 1424898621, "question_id": 28729535, "link": "https://stackoverflow.com/questions/28729535/auto-complete-the-textbox-from-the-oracle-database", "title": "Auto complete the textbox from the oracle database", "body": "<pre><code>    void AutoCompleteText()\n    {\n        textBox1.AutoCompleteMode = AutoCompleteMode.SuggestAppend;\n        textBox1.AutoCompleteSource = AutoCompleteSource.CustomSource;\n        AutoCompleteStringCollection coll = new AutoCompleteStringCollection();\n\n        string query = \"select * from Book;\";\n        OracleConnection con = new OracleConnection(ConString);\n        OracleCommand cmd = new OracleCommand(query, con);\n        OracleDataReader myReader;\n\n        try\n        {\n            con.Open();\n            myReader = cmd.ExecuteReader();\n\n            while (myReader.Read())\n            {\n                string sName = myReader.GetString(\"Title\");\n                coll.Add(sName);\n            }\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.Message);\n        }\n        textBox1.AutoCompleteCustomSource = coll;\n    }\n</code></pre>\n\n<p>In the table Book I have a column named Title, I want to suggest me when I'm searching in the textbox1, suppose I write A in the textbox1, then it will automatically pop up all the title starting with A from the Oracle Database.</p>\n\n<p>But by implementing the code I got the following Errors:</p>\n\n<p>Error-1: The best overloaded method match for 'System.Data.Common.DbDataReader.GetString(int)' has some invalid arguments</p>\n\n<p>Error-2: Argument 1: cannot convert from 'string' to 'int'</p>\n"}, {"tags": ["c#", "wpf", "xceed-datagrid"], "comments": [{"owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1424901967, "post_id": 28729527, "comment_id": 45747337, "body": "&quot;but not both at the same time.&quot; What would you like to achieve? &quot;Both&quot; at the same time?"}, {"owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1424902015, "post_id": 28729527, "comment_id": 45747365, "body": "Could you please post the implementation of the <code>ViewModel</code> which contains the definition of the <code>OpenPiWebCommand</code> property?"}, {"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "reply_to_user": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1424965751, "post_id": 28729527, "comment_id": 45775866, "body": "Updated post by adding the view model implementation."}, {"owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1424975843, "post_id": 28729527, "comment_id": 45782194, "body": "Thanks! But there is an open question about &quot;both&quot; (please see the first comment)."}, {"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "reply_to_user": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425025545, "post_id": 28729527, "comment_id": 45800871, "body": "Ok, sorry, did not read for first comment! With both I mean: The binding of the &quot;OpenPiWebCommand&quot; and the one of the DataTrigger."}, {"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "reply_to_user": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425026153, "post_id": 28729527, "comment_id": 45801185, "body": "The binding of the Command and also the CommandParameter works when using the DataContext I use in the example above. But the same value: &quot;PiWebReport&quot; from a cell does not work in the DataTrigger. It only works when using another DataContext: `{Binding RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type xcdg:Cell}},Path=DataContext}&#39; , but then the command does not work anymore"}, {"owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425065249, "post_id": 28729527, "comment_id": 45823986, "body": "Good. Could you please post the more or less <b>complete</b> implementation of the <code>ViewModel</code> (command initialization, <code>PiWebReport</code> property and its usages within the <code>ViewModel</code>)?"}, {"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "reply_to_user": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425320221, "post_id": 28729527, "comment_id": 45905055, "body": "Further info attached. Hope this is sufficient"}, {"owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425321170, "post_id": 28729527, "comment_id": 45905547, "body": "Sorry, but still do not have the &quot;whole picture&quot;: not all the required code is posted to reproduce the behavior. Please see <a href=\"http://stackoverflow.com/help/mcve\">the page</a>."}, {"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "reply_to_user": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425674130, "post_id": 28729527, "comment_id": 46073817, "body": "Ok, I am sorry I couldn&#180;t make the point! Instead of giving you more code and making it more complex, just a more abstract question: How would you enable/disable a button in a dataGrid row, depending on one of the field values of this row? I thought best would be to use a Button.Style, but is there another way by binding the IsEnabled attribute to something like CanExecute? Btw. I am using RealyCommand!"}, {"owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425674545, "post_id": 28729527, "comment_id": 46074001, "body": "1. <code>PiWebReport</code> seems to be a property of the same <code>ViewModel</code> as <code>OpenPiWebCommand</code>? 2. Could you please post the implementation of <code>PiWebReport</code> property?"}, {"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "reply_to_user": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425675646, "post_id": 28729527, "comment_id": 46074477, "body": "It&#180;s basically a simple string property of the data class ResultDataV1, which appears in the data grid. Above you&#180;ll find the class."}, {"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "reply_to_user": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1425995243, "post_id": 28729527, "comment_id": 46182493, "body": "The property is called &quot;ResultData&quot; of the type: ObservableCollection&lt;ResultDataV1&gt;), which belongs to the same ViewModel as the OpenPiWebCommand!"}, {"owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "edited": false, "score": 0, "creation_date": 1426972086, "post_id": 28729527, "comment_id": 46590925, "body": "Please see the answer."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "edited": false, "score": 0, "creation_date": 1427106279, "post_id": 29133647, "comment_id": 46625911, "body": "Thanks a lot for your hints and the example! The CanExecute method is definitely the correct approach, but even when trying that, I got only all buttons of the column enabled/disabled and not just each cell. I figured eventually that I had to select the specific context: <code>&lt;DataTrigger Binding=&quot;{Binding DataContext.PiWebReport, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type xcdg:Cell}}}&quot; \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t Value=&quot;{x:Static System:String.Empty}&quot;&gt;</code> And that works perfectly, but anyway I will now change it to the CanExecute method approach in order to make it the way it should."}], "tags": [], "owner": {"reputation": 11725, "user_id": 490018, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dbf3953a5b7a3d89c4839f4a7f34fe4f?s=128&d=identicon&r=PG", "display_name": "Sergey Brunov", "link": "https://stackoverflow.com/users/490018/sergey-brunov"}, "is_accepted": true, "score": 0, "last_activity_date": 1426717242, "last_edit_date": 1426717242, "creation_date": 1426716532, "answer_id": 29133647, "question_id": 28729527, "link": "https://stackoverflow.com/questions/28729527/how-to-bind-value-from-datagridcell-to-datatrigger/29133647#29133647", "title": "How to bind value from DataGrid:Cell to DataTrigger", "body": "<p>The main idea is to use the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.input.icommand.canexecute%28v=vs.110%29.aspx\" rel=\"nofollow\">ICommand.CanExecute Method</a>. Initially the button becomes enabled or disabled based on the value of the method (of the bound <code>ICommand</code> instance). Also, firing <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.input.icommand.canexecutechanged(v=vs.110).aspx\" rel=\"nofollow\">ICommand.CanExecuteChanged Event</a> can be used to notify the user-interface (<code>Button</code> class) about the property change.</p>\n\n<p>The implementation of the structure:</p>\n\n<pre><code>internal sealed class ResultData\n{\n    private readonly string piWebReport;\n\n    public ResultData(string piWebReport)\n    {\n        this.piWebReport = piWebReport;\n    }\n\n    public string PiWebReport\n    {\n        get { return this.piWebReport; }\n    }\n}\n</code></pre>\n\n<p>The implementation of the <code>ViewModel</code> class:</p>\n\n<pre><code>internal sealed class MainViewModel\n{\n    private readonly IEnumerable&lt;ResultData&gt; items = new[]\n        {\n            new ResultData(\"Report 00\"),\n            new ResultData(\"Report 01\"),\n            new ResultData(\"Report 02\"),\n            new ResultData(null)\n        };\n\n    private readonly ICommand openPiWebCommand;\n\n    public MainViewModel()\n    {\n        openPiWebCommand = new RelayCommand&lt;ResultData&gt;(\n            OpenPiWeb,\n            x =&gt; x != null &amp;&amp; x.PiWebReport != null);\n    }\n\n    public IEnumerable&lt;ResultData&gt; Items\n    {\n        get { return items; }\n    }\n\n    public ICommand OpenPiWebCommand\n    {\n        get { return openPiWebCommand; }\n    }\n\n    private void OpenPiWeb(ResultData data)\n    {\n        // Implement the command logic.\n    }\n}\n</code></pre>\n\n<p>XAML:</p>\n\n<pre><code>&lt;Window x:Class=\"...\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:xcdg=\"http://schemas.xceed.com/wpf/xaml/datagrid\"\n        ...&gt;\n    &lt;Grid&gt;\n        &lt;xcdg:DataGridControl ItemsSource=\"{Binding Items}\"&gt;\n            &lt;xcdg:DataGridControl.Columns&gt;\n                &lt;xcdg:Column FieldName=\"PiWebReport\"\n                             Title=\"PiWeb Report\"&gt;\n                    &lt;xcdg:Column.DisplayMemberBindingInfo&gt;\n                        &lt;xcdg:DataGridBindingInfo Path=\".\" ReadOnly=\"True\" /&gt;\n                    &lt;/xcdg:Column.DisplayMemberBindingInfo&gt;\n\n                    &lt;xcdg:Column.CellContentTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;Grid&gt;\n                                &lt;Button Content=\"Open PiWeb\"\n                                        CommandParameter=\"{Binding}\"\n                                        Command=\"{Binding RelativeSource={RelativeSource Self}, Path=(xcdg:DataGridControl.ParentDataGridControl).DataContext.OpenPiWebCommand}\" /&gt;\n                            &lt;/Grid&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/xcdg:Column.CellContentTemplate&gt;\n                &lt;/xcdg:Column&gt;\n            &lt;/xcdg:DataGridControl.Columns&gt;\n        &lt;/xcdg:DataGridControl&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>References:</p>\n\n<ul>\n<li>Example of <code>Column.DisplayMemberBindingInfo</code> usage: <a href=\"http://sysmagazine.com/posts/167751/\" rel=\"nofollow\">Difficult choice of grid for projects on WPF</a>.</li>\n</ul>\n\n<p>Hope this is useful for you!</p>\n"}], "owner": {"reputation": 27, "user_id": 3619400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f66cbc80ab5e0394c5c38a8d8caad585?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/3619400/richard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1598, "favorite_count": 1, "accepted_answer_id": 29133647, "answer_count": 1, "score": 2, "last_activity_date": 1426972723, "creation_date": 1424898247, "last_edit_date": 1426972723, "question_id": 28729527, "link": "https://stackoverflow.com/questions/28729527/how-to-bind-value-from-datagridcell-to-datatrigger", "title": "How to bind value from DataGrid:Cell to DataTrigger", "body": "<p>My Problem: </p>\n\n<ul>\n<li>I have a Xceed <code>DataGrid</code> column with a button, which is bound to a Command (that part works)</li>\n<li>Now I want the button to be enabled/disabled depending on a certain value in the current <code>DataRow</code>.</li>\n<li>So far I can either get the command bind work or the <code>DataTrigger</code> depending on the <code>DataContext</code> I use, but not both at the same time.</li>\n</ul>\n\n<p>I am stuck with the following code:</p>\n\n<pre><code>&lt;xcdg:Column FieldName=\"OpenInPiWebIdentifier\"\n             Title=\"PiWeb Report\"\n             VisiblePosition=\"6\"&gt;\n    &lt;xcdg:Column.CellContentTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;Button DataContext=\"{Binding RelativeSource={RelativeSource Self}, Path=(xcdg:DataGridControl.ParentDataGridControl).DataContext}\"\n                    Content=\"Open PiWeb\"\n                    Command=\"{Binding OpenPiWebCommand}\"\n                    CommandParameter=\"{Binding DataContext.ResultData/PiWebReport, Mode=OneWay, RelativeSource={RelativeSource Self}}\"&gt;\n                &lt;Button.Style&gt;\n                    &lt;Style TargetType=\"Button\"&gt;\n                        &lt;Style.Triggers&gt;\n                            &lt;DataTrigger Binding=\"{Binding PiWebReport}\"\n                                         Value=\"{x:Null}\"&gt;\n                                &lt;Setter Property=\"IsEnabled\"\n                                        Value=\"False\" /&gt;\n                            &lt;/DataTrigger&gt;\n                        &lt;/Style.Triggers&gt;\n                    &lt;/Style&gt;\n                &lt;/Button.Style&gt;\n            &lt;/Button&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/xcdg:Column.CellContentTemplate&gt;\n&lt;/xcdg:Column&gt;\n</code></pre>\n\n<p>And the view model implementation of the command:</p>\n\n<pre><code>public ICommand OpenPiWebCommand\n{\n    get\n    {\n        return _OpenPiWebCommand;\n    }\n\n    set\n    {\n        if (value != _OpenPiWebCommand)\n        {\n            _OpenPiWebCommand = value;\n            OnPropertyChanged(\"OpenPiWebCommand\");\n        }\n    }\n}\n\nprivate ICommand _OpenPiWebCommand;\n</code></pre>\n\n<p>In the constructor I initialize the command:</p>\n\n<pre><code>OpenPiWebCommand = new RelayCommand(new Action&lt;object&gt;(OpenPiWeb));\n</code></pre>\n\n<p>The property <code>PiWebReport</code> belongs to a class <code>ResultDataV1</code>. All data is put into this property <code>ResultData = new ObservableCollection&lt;ResultDataV1&gt;();</code> \nwhich is displayed in the <code>DataGrid</code> as columns/rows. \nSo, now I can access either the property value <code>PiWebReport</code> or the command, depending on the context I use, but not both at the same time.</p>\n\n<p>The data class:</p>\n\n<pre><code>public class ResultDataV1\n{\n    public ResultDataV1(long dataId, DateTime dateTime, DateTime? endDateTime, string partId, string scanId, bool measurementNotVolumejoin, string piWebReport, FileInfo volumeFileInfo, FileInfo volumeVglFileInfo, DirectoryInfo volumeDirectoryInfo, string inspectionPlanName, string paletteName, AutomationStateEnum? automationState);\n\n    public AutomationStateEnum? AutomationState { get; }\n    public long DataId { get; }\n    public DateTime DateTime { get; }\n    public DateTime? EndDateTime { get; }\n    public string InspectionPlanName { get; }\n    public bool MeasurementNotVolumejoin { get; }\n    public string PaletteName { get; }\n    public string PartId { get; }\n    public string PiWebReport { get; }\n    public string ScanId { get; }\n    public List&lt;SubResultDataV1&gt; SubResults { get; }\n    public DirectoryInfo VolumeDirectoryInfo { get; }\n    public FileInfo VolumeFileInfo { get; }\n    public FileInfo VolumeVglFileInfo { get; }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "sql-server-2008-r2", "installation"], "comments": [{"owner": {"reputation": 13804, "user_id": 15754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DrITH.jpg?s=128&g=1", "display_name": "dbugger", "link": "https://stackoverflow.com/users/15754/dbugger"}, "edited": false, "score": 0, "creation_date": 1424898844, "post_id": 28729483, "comment_id": 45745633, "body": "SQL Server -- an express edition I assume -- the other versions require licenses. Does SAP Crystal Reports require a license?"}, {"owner": {"reputation": 557, "user_id": 2386228, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/z5mML.jpg?s=128&g=1", "display_name": "Haider Khattak", "link": "https://stackoverflow.com/users/2386228/haider-khattak"}, "reply_to_user": {"reputation": 13804, "user_id": 15754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DrITH.jpg?s=128&g=1", "display_name": "dbugger", "link": "https://stackoverflow.com/users/15754/dbugger"}, "edited": false, "score": 0, "creation_date": 1424898875, "post_id": 28729483, "comment_id": 45745655, "body": "no SAP Crystal Reports does not require license"}], "answers": [{"tags": [], "owner": {"reputation": 3452, "user_id": 449061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c641bf78515c0061b2647950b72abf30?s=128&d=identicon&r=PG", "display_name": "Jake C", "link": "https://stackoverflow.com/users/449061/jake-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1424909058, "last_edit_date": 1495542512, "creation_date": 1424909058, "answer_id": 28732158, "question_id": 28729483, "link": "https://stackoverflow.com/questions/28729483/how-to-create-a-setup-for-net-project-with-sap-sql-server-2008-r2-and-net-fra/28732158#28732158", "title": "how to create a setup for .net project with sap, sql server 2008 r2 and .net framework", "body": "<blockquote>\n  <p>What is the best solution and steps for it?</p>\n</blockquote>\n\n<p>Just document these software packages as prerequisites and provide your users some documentation as to where to download and how to install them. We use an almost identical software stack for our applications at my current place of employment, and this is what we do. There are a few reasons for this:</p>\n\n<ol>\n<li><strong>Error Handling</strong> A lot of things can go wrong when installing these applications. SQL Server especially has a lot of prerequisites and configuration requirements that are too numerous to account for all of the things that could possibly go wrong. Crystal Reports also might be problematic.</li>\n<li><strong>Legal</strong> In order to redistribute software you need to have the right to do so. .NET and CR both provide redistributables, SQL Server 2008 R2 Express used to require you to register in order to redistribute, however, according to <a href=\"https://stackoverflow.com/questions/15925740/register-for-sql-server-express-redistribution\">this question</a> it looks like they stopped offering that and now it is built into the 2012 license.</li>\n<li><strong>Control</strong> Let's say you figure out how to get this installer working, but lets say one of the software packages needs to be updated to fix a security problem. At the same time they change the installer logic, and it breaks your installer procedure. Because these installers are outside of your control keeping a consistent installation process can be very time intensive.</li>\n</ol>\n\n<p>Now I realize the end goal is to have a good user experience, run one installer and everything necessary gets installed. However, the potential for this to break and cause problems and give a really negative user experience, in my opinion, far outweighs any potential user experience gain that might be earned by a unified installer.</p>\n\n<p>If you are really dead set on doing this, I'd recommend just googling it. Generally by searching something like <code>crystal reports silent install</code> or <code>sql server unattended install</code> you can usually find instructions on how to supply the proper command line options to get it to install without any user input.</p>\n"}], "owner": {"reputation": 557, "user_id": 2386228, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/z5mML.jpg?s=128&g=1", "display_name": "Haider Khattak", "link": "https://stackoverflow.com/users/2386228/haider-khattak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424909058, "creation_date": 1424898118, "last_edit_date": 1424900019, "question_id": 28729483, "link": "https://stackoverflow.com/questions/28729483/how-to-create-a-setup-for-net-project-with-sap-sql-server-2008-r2-and-net-fra", "title": "how to create a setup for .net project with sap, sql server 2008 r2 and .net framework", "body": "<p>I have created a .NET application which is a WPF application and it consists of database and reports. What i want to do is to create a setups which consists of .Net Framework, SQL Server 2008 R2 and SAP Crystal Reports. All of these should be in a single setup. If any of these exists in OS so that should be skipped and which are not existing should be installed. If the software are not present so they should be download first and then installed.</p>\n\n<p>What is the best solution and steps for it?</p>\n\n<p>If reference are available similar to my problem please post their links.</p>\n\n<p>If you down vote my question, please tell me the reason for it as to be careful next time.</p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1424913538, "post_id": 28729403, "comment_id": 45751487, "body": "Seems telling: <code>ASP.test_aspx</code> vs. <code>website</code> (namespaces)."}, {"owner": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "reply_to_user": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1424943229, "post_id": 28729403, "comment_id": 45761304, "body": "what do you mean? explain your comment, please."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1424943134, "post_id": 28732807, "comment_id": 45761253, "body": "I have removed the old button and then double clicked from the design panel and created event handler associated with the new added button and pasted my code in there! I also ran rebuild my solution and removed the old test.aspx.designer.cs and right clicked on the test.aspx to convert to application to make new designer. All of these DID NOT work for me!"}, {"owner": {"reputation": 3312, "user_id": 1845672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bddb39c831fe488900043133a4420c4e?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/1845672/roland"}, "reply_to_user": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1425031544, "post_id": 28732807, "comment_id": 45804102, "body": "You don&#39;t have to paste anything. Just create the button and the event in Visual Studio and set a debugger breakpoint in the empty event handler. Check that the event handler is executed when the button is clicked. If that is working, then start putting in your code in the event handler. But if it is NOT working, you have to fix your solution and/or project that may have become corrupt."}, {"owner": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1425041941, "post_id": 28732807, "comment_id": 45810153, "body": "I replaced the old button with a new one, left breaking point on the new button (with no codes in). The button worked in my development machine. However, it didn&#39;t work when deployed in the hosting website and it gave a Compilation Error!"}, {"owner": {"reputation": 3312, "user_id": 1845672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bddb39c831fe488900043133a4420c4e?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/1845672/roland"}, "reply_to_user": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1425044391, "post_id": 28732807, "comment_id": 45811729, "body": "@Max Looks like a deployment problem. Same CPU architecture (32/64bit) ? Do you have all debug options enabled on the hosting website? Different IIS settings on development and hosting web sites? What is the exact error msg? At least I guess the error msg is different from your original posting above, because now the <code>btnSubmit_Click</code> should be present. Did you do a <code>publish</code> in VS?"}, {"owner": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1425044728, "post_id": 28732807, "comment_id": 45811942, "body": "Just quick update. I have just changed the codebehind to CodeFile and the button worked!"}, {"owner": {"reputation": 3312, "user_id": 1845672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bddb39c831fe488900043133a4420c4e?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/1845672/roland"}, "reply_to_user": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1425047507, "post_id": 28732807, "comment_id": 45813652, "body": "@Max Great! Perhaps good to mention this in your question description, and put the word <code>Solved</code> in the title. Have a nice weekend"}, {"owner": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1425072872, "post_id": 28732807, "comment_id": 45827624, "body": "Thank you for help and you too"}], "tags": [], "owner": {"reputation": 3312, "user_id": 1845672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bddb39c831fe488900043133a4420c4e?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/1845672/roland"}, "is_accepted": true, "score": 1, "last_activity_date": 1424913116, "creation_date": 1424913116, "answer_id": 28732807, "question_id": 28729403, "link": "https://stackoverflow.com/questions/28729403/button-click-event-is-not-working-in-code-behind-asp-net-c/28732807#28732807", "title": "Button click event is not working in code behind ASP.NET C#", "body": "<p>You did not show the 3rd part of required code, where the event gets initialized with the delegate, that kind of stuff. Automatically created code, that we normally don't pay much attention to. See method <code>InitializeComponent()</code> in file <code>Formxxx.Designer.cs</code>.</p>\n\n<p>To keep it simple, I would suggest: just remove the button click event handler and create it again with Visual Studio by clicking the button in the designer. Then all required code parts get created correctly.</p>\n"}, {"comments": [{"owner": {"reputation": 11216, "user_id": 2692688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/woiEs.png?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/2692688/tushar"}, "reply_to_user": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1424944250, "post_id": 28738760, "comment_id": 45761914, "body": "As you like..you can do in any of the two way!"}, {"owner": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "edited": false, "score": 0, "creation_date": 1424944823, "post_id": 28738760, "comment_id": 45762295, "body": "I tried exactly what you said once manually and the other one automatically, but didn&#39;t work!"}], "tags": [], "owner": {"reputation": 11216, "user_id": 2692688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/woiEs.png?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/2692688/tushar"}, "is_accepted": false, "score": 0, "last_activity_date": 1424943188, "creation_date": 1424943188, "answer_id": 28738760, "question_id": 28729403, "link": "https://stackoverflow.com/questions/28729403/button-click-event-is-not-working-in-code-behind-asp-net-c/28738760#28738760", "title": "Button click event is not working in code behind ASP.NET C#", "body": "<p>Just remove the click event  <code>protected void btnSubmit_Click(object sender, EventArgs e)</code>from backend and <code>OnClick=\"btnSubmit_Click\"</code> from the aspx build the solution and then again define the click event and bind it.</p>\n\n<p>This happens when you delete the auto generated click event.</p>\n"}], "owner": {"reputation": 19, "user_id": 4565186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f624f2df62f7fa8fcd7596949199b4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4565186/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3986, "favorite_count": 0, "accepted_answer_id": 28732807, "answer_count": 2, "score": 1, "last_activity_date": 1425073162, "creation_date": 1424897822, "last_edit_date": 1495535365, "question_id": 28729403, "link": "https://stackoverflow.com/questions/28729403/button-click-event-is-not-working-in-code-behind-asp-net-c", "title": "Button click event is not working in code behind ASP.NET C#", "body": "<p>I have a button in my web site that doesn't work at all. Every time I write my script inside the button event in code behind I get this error:</p>\n\n<pre><code> Server Error in '/website.com' Application.\n  Compilation Error\n   Description: An error occurred during the compilation of a resource       \n   required to service this request. Please review the following specific \n   error details and modify your source code appropriately.\n\n   Compiler Error Message: CS1061: 'ASP.test_aspx' does not contain a \n   definition for 'btnSubmit_Click' and no extension method \n   'btnSubmit_Click' accepting a first argument of type 'ASP.test_aspx' \n   could be found (are you missing a using directive or an assembly \n   reference?)\n\n Source Error:\n\n\n  Line 5:  \n  Line 6:  \n  Line 7:  &lt;asp:Button ID=\"btnSubmit\" runat=\"server\" Text=\"Submit\" \n     OnClick=\"btnSubmit_Click\" /&gt;\n  Line 8:  \n  Line 9:  \n</code></pre>\n\n<p>Code Behind</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n\nnamespace website\n{\n    public partial class Test : System.Web.UI.Page\n    {\n        protected void Page_Load(object sender, EventArgs e)\n        {\n\n        }\n\n        protected void btnSubmit_Click(object sender, EventArgs e)\n        {\n            lblmsg.Text = \"Hello World!\";\n        }\n    }\n}\n</code></pre>\n\n<p>Source :</p>\n\n<pre><code>  &lt;%@ Page Title=\"\" Language=\"C#\" MasterPageFile=\"~/webMaster.Master\"  \n  AutoEventWireup=\"True\" CodeBehind=\"Test.aspx.cs\"  \n  Inherits=\"website.Test\"  %&gt;\n\n    &lt;asp:Content ID=\"Content1\" ContentPlaceHolderID=\"head\" runat=\"server\"&gt;\n    &lt;/asp:Content&gt;\n    &lt;asp:Content ID=\"Content2\" ContentPlaceHolderID=\"ContentPlaceHolder1\" \n     runat=\"server\"&gt;\n      &lt;asp:Button ID=\"btnSubmit\" runat=\"server\" Text=\"Submit\" \n       OnClick=\"btnSubmit_Click\" CausesValidation=\"False\" /&gt;\n\n      &lt;asp:Label ID=\"lblmsg\" runat=\"server\"&gt;&lt;/asp:Label&gt;  \n    &lt;/asp:Content&gt;\n</code></pre>\n\n<p>This is my Test.aspx.designer.cs code:</p>\n\n<pre><code> namespace website {\n     public partial class Test {\n\n    /// &lt;summary&gt;\n    /// btnSubmit control.\n    /// &lt;/summary&gt;\n    /// &lt;remarks&gt;\n    /// Auto-generated field.\n    /// To modify move field declaration from designer file to code-behind  \n        file.\n    /// &lt;/remarks&gt;\n       protected global::System.Web.UI.WebControls.Button btnSubmit;\n\n    /// &lt;summary&gt;\n    /// lblmsg control.\n    /// &lt;/summary&gt;\n    /// &lt;remarks&gt;\n    /// Auto-generated field.\n    /// To modify move field declaration from designer file to code-behind \n        file.\n    /// &lt;/remarks&gt;\n    protected global::System.Web.UI.WebControls.Label lblmsg;\n   }\n }\n</code></pre>\n\n<p>Update:</p>\n\n<p>I solved the problem after changing CodeBehind=\"Test.aspx.cs\" to CodeFile=\"Test.aspx.cs\". More information <a href=\"https://stackoverflow.com/questions/73022/codefile-vs-codebehind\">CodeFile vs CodeBehind</a></p>\n"}, {"tags": ["c#", ".net", "interop", "pinvoke", "unmanaged"], "owner": {"reputation": 846, "user_id": 2391685, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fca5621cdafc7a44b79e8cb4690a7d0e?s=128&d=identicon&r=PG", "display_name": "user2391685", "link": "https://stackoverflow.com/users/2391685/user2391685"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1424897438, "creation_date": 1424897438, "question_id": 28729315, "link": "https://stackoverflow.com/questions/28729315/how-to-wrap-out-intptr-or-ref-intptr-into-handleref", "title": "How to wrap out IntPtr or ref IntPtr into HandleRef", "body": "<p>According to the documentation <a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.handleref(v=vs.100).aspx\" rel=\"nofollow\">here</a>, HandleRef can wrap a IntPtr to unmanaged resource.</p>\n\n<pre><code>HandleRef href = new HandleRef(obj, obj.unmanagedIntPtr);\n</code></pre>\n\n<p>I am wondering if I can wrap out IntPtr and ref IntPtr into HandleRef, because some of my pinvoke calls take out and/or ref.</p>\n"}, {"tags": ["c#", "sql-server", "linq"], "comments": [{"owner": {"reputation": 1700, "user_id": 2125444, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/VqC96.jpg?s=128&g=1", "display_name": "reggaeguitar", "link": "https://stackoverflow.com/users/2125444/reggaeguitar"}, "edited": false, "score": 0, "creation_date": 1424898719, "post_id": 28729302, "comment_id": 45745566, "body": "What is your question? Please read this sscce.org"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "reply_to_user": {"reputation": 1700, "user_id": 2125444, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/VqC96.jpg?s=128&g=1", "display_name": "reggaeguitar", "link": "https://stackoverflow.com/users/2125444/reggaeguitar"}, "edited": false, "score": 0, "creation_date": 1424898960, "post_id": 28729302, "comment_id": 45745698, "body": "@reggaeguitar I read it as, &quot;I want to get rid of the first query where I check to see if the user has any prescribers, and also get rid of the if/else statements, by modifying my linq query to handle both cases where the user DOES have some Prescribers and DOES NOT have any Prescribers&quot;"}, {"owner": {"reputation": 37, "user_id": 1322532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3a609e03b1296b75826a25de1369da2d?s=128&d=identicon&r=PG", "display_name": "chuckb35", "link": "https://stackoverflow.com/users/1322532/chuckb35"}, "edited": false, "score": 0, "creation_date": 1424961458, "post_id": 28729302, "comment_id": 45772887, "body": "Yes Rufus L, that is what I meant. I want to eliminate the first query and the if/else statement in the second.  I want a Linq to sql query to show me all the drugs being prescribed for this clinic unless the user is restricted to a set of prescribers then only show me the ones that those prescribers wrote. Thanks for looking."}], "owner": {"reputation": 37, "user_id": 1322532, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3a609e03b1296b75826a25de1369da2d?s=128&d=identicon&r=PG", "display_name": "chuckb35", "link": "https://stackoverflow.com/users/1322532/chuckb35"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424898757, "creation_date": 1424897403, "last_edit_date": 1424898757, "question_id": 28729302, "link": "https://stackoverflow.com/questions/28729302/need-a-linq-to-sql-statement-to-join-or-default", "title": "need a linq to sql statement to join or default", "body": "<p>I have a Prescription table. Prescriptions are related to a Clinic table and a Doctor table.\nI also have two relations tables, UserToClinic and UserToPrescribers\nEvery user is in UserToClinic one or more times. A user is only in UserToPrescribers if the user is restricted to seeing only those Doctors.\nIf a user is not in UserToPrescribers they should be able to see all Doctors for the Clinics they can see.\nI could look for the user in the UserToPrescribers then branch to a different linq query but I am going to have to do this a lot and that will get ugly.</p>\n\n<pre><code>var UserPrescribers = from up in c.UserToPrescribers\n    where up.UserName == username\n    select up;\n\nif (UserPrescribers.Count() == 0)\n{\n    var result = (from d in c.Drugs\n        join s in c.RXes on d.NDC equals s.NDC\n        where s.ClinicId == clinicId\n\n        select new Drug\n        {\n            Name = d.Name,\n            NDC = d.NDC\n        }).Distinct().OrderBy(m =&gt; m.Name).ToList();\n\n    return result;\n}\nelse\n{\n    var result = (from d in c.Drugs\n        join s in c.RXes on d.NDC equals s.NDC\n        join p in c.Prescribers on s.PrescriberNPI equals p.NPI\n        join up in c.UserToPrescribers on p.NPI equals up.PrescriberNPI\n        where s.ClinicId == clinicId &amp;&amp; up.UserName == username\n\n        select new Drug\n        {\n            Name = d.Name,\n            NDC = d.NDC\n        }).Distinct().OrderBy(m =&gt; m.Name).ToList();\n\n    return result;\n}\n</code></pre>\n"}, {"tags": ["c#", "microsoft-fakes"], "answers": [{"tags": [], "owner": {"reputation": 3988, "user_id": 819436, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c5c68ed8055f0e84684bcad710195c00?s=128&d=identicon&r=PG", "display_name": "ConditionRacer", "link": "https://stackoverflow.com/users/819436/conditionracer"}, "is_accepted": true, "score": 0, "last_activity_date": 1424924744, "last_edit_date": 1424924744, "creation_date": 1424900243, "answer_id": 28730137, "question_id": 28729289, "link": "https://stackoverflow.com/questions/28729289/msfakes-how-do-i-stub-this-call-twice/28730137#28730137", "title": "MSFakes, how do I stub this call twice?", "body": "<p>It looks like MSFakes builds a dictionary internally with the return type as the key, and the Func delegate as the value. Unfortunately, it doesn't let you change the delegate after you've set it once.</p>\n\n<p>So something like this is ok:</p>\n\n<pre><code>var session = new StubIDbSession();\nsession.QueryOf1StringObject((sql1, param1) =&gt;\n{\n    return new List&lt;string&gt;();\n});\nsession.QueryOf1StringObject((sql1, param1) =&gt;\n{\n    return new List&lt;int&gt;();\n});\n</code></pre>\n\n<p>But this will throw an exception because it's trying to use the same return type twice:</p>\n\n<pre><code>var session = new StubIDbSession();\nsession.QueryOf1StringObject((sql1, param1) =&gt;\n{\n    return new List&lt;string&gt; { \"STRING 1\" }\n});\nsession.QueryOf1StringObject((sql1, param1) =&gt;\n{\n    return new List&lt;string&gt; { \"STRING 2\" }\n});\n</code></pre>\n\n<p>Here is how I worked around it:</p>\n\n<pre><code>bool called = false;\nsession.QueryOf1StringObject((sql1, param1) =&gt;\n{\n    if(called)\n    {\n        return new List&lt;string&gt; { \"STRING 2\" };\n    }\n    else\n    {\n        called = true;\n        return new List&lt;string&gt; { \"STRING 1\" }\n    }\n});\n</code></pre>\n\n<p>Good luck if you need to call a method 3 times or more.</p>\n"}], "owner": {"reputation": 3988, "user_id": 819436, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c5c68ed8055f0e84684bcad710195c00?s=128&d=identicon&r=PG", "display_name": "ConditionRacer", "link": "https://stackoverflow.com/users/819436/conditionracer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 28730137, "answer_count": 1, "score": 0, "last_activity_date": 1424924744, "creation_date": 1424897351, "question_id": 28729289, "link": "https://stackoverflow.com/questions/28729289/msfakes-how-do-i-stub-this-call-twice", "title": "MSFakes, how do I stub this call twice?", "body": "<p>I have an interface like this:</p>\n\n<pre><code>IDbSession\n{\n    IEnumerable&lt;T&gt; Query&lt;T&gt;(string sql, object param = null);\n}\n</code></pre>\n\n<p>MSFakes generates an object that looks like this:</p>\n\n<pre><code>class StubIDbSession : StubBase&lt;IDbSession&gt;, IDbSession, IDisposable\n{\n    public void QueryOf1StringObject&lt;T&gt;(FakesDelegates.Func&lt;string, object, System.Collections.Generic.IEnumerable&lt;T&gt;&gt; stub);\n}\n</code></pre>\n\n<p>Which I then use like this:</p>\n\n<pre><code>var session = new StubIDbSession();\nsession.QueryOf1StringObject((sql1, param1) =&gt;\n{\n    // Stub the second call\n    session.QueryOf1StringObject((sql2, param2) =&gt; new List&lt;MyDto&gt;());\n\n    return myDtos.Take(1);\n});\n</code></pre>\n\n<p>However, when stubbing the call a second time, it throws this exception:</p>\n\n<pre><code>ArgumentException: An item with the same key has already been added.\n\n   at System.ThrowHelper.ThrowArgumentException(ExceptionResource resource)\n   at System.Collections.Generic.Dictionary`2.Insert(TKey key, TValue value, Boolean add)\n   at System.Collections.Generic.Dictionary`2.Add(TKey key, TValue value)\n   at Microsoft.QualityTools.Testing.Fakes.Stubs.StubDelegateMap.Concat(StubDelegateMap dictionary, Delegate delegate)\n   ...\n</code></pre>\n\n<p>How can I stub the second call to this method??</p>\n"}, {"tags": ["c#", "asp.net", "system.reactive"], "comments": [{"owner": {"reputation": 7876, "user_id": 2321874, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fbIIO.jpg?s=128&g=1", "display_name": "Mihai Caracostea", "link": "https://stackoverflow.com/users/2321874/mihai-caracostea"}, "edited": false, "score": 0, "creation_date": 1424897578, "post_id": 28729254, "comment_id": 45744946, "body": "System.Threading is here since .Net 1.1, mate! <a href=\"https://msdn.microsoft.com/en-us/library/system.threading(v=vs.71).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/system.threading(v=vs.71).a&zwnj;&#8203;spx</a>"}, {"owner": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "reply_to_user": {"reputation": 7876, "user_id": 2321874, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fbIIO.jpg?s=128&g=1", "display_name": "Mihai Caracostea", "link": "https://stackoverflow.com/users/2321874/mihai-caracostea"}, "edited": false, "score": 0, "creation_date": 1424897643, "post_id": 28729254, "comment_id": 45744991, "body": "&quot;System.Threading.dll was added in .NET 4.0 (though the namespace System.Threading has been around since v1)&quot;  <a href=\"http://stackoverflow.com/questions/3405662/why-might-system-threading-dll-be-missing-from-windows-assembly\" title=\"why might system threading dll be missing from windows assembly\">stackoverflow.com/questions/3405662/&hellip;</a>   I clarified the question a bit."}, {"owner": {"reputation": 7876, "user_id": 2321874, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fbIIO.jpg?s=128&g=1", "display_name": "Mihai Caracostea", "link": "https://stackoverflow.com/users/2321874/mihai-caracostea"}, "edited": false, "score": 0, "creation_date": 1424897884, "post_id": 28729254, "comment_id": 45745124, "body": "So until 4.0 those classes in System.Threading were sitting where? Another assembly maybe?"}, {"owner": {"reputation": 27123, "user_id": 87427, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lf6af.jpg?s=128&g=1", "display_name": "James World", "link": "https://stackoverflow.com/users/87427/james-world"}, "edited": false, "score": 1, "creation_date": 1424898516, "post_id": 28729254, "comment_id": 45745456, "body": "Do you have a .gitignore hiding the fact the DLLs are still sitting in your bin folder?"}, {"owner": {"reputation": 7876, "user_id": 2321874, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fbIIO.jpg?s=128&g=1", "display_name": "Mihai Caracostea", "link": "https://stackoverflow.com/users/2321874/mihai-caracostea"}, "edited": false, "score": 0, "creation_date": 1424898569, "post_id": 28729254, "comment_id": 45745481, "body": "Regarding your error, maybe that assembly is a reference for another assembly referenced in your solution. A decompiler should help you see what are the references for an assembly."}, {"owner": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "reply_to_user": {"reputation": 7876, "user_id": 2321874, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fbIIO.jpg?s=128&g=1", "display_name": "Mihai Caracostea", "link": "https://stackoverflow.com/users/2321874/mihai-caracostea"}, "edited": false, "score": 0, "creation_date": 1424912101, "post_id": 28729254, "comment_id": 45751098, "body": "@mihai The namespace was in mscorlib I believe. What do you mean by decompiler can assist? Is there a tool to trace the dependencies?"}, {"owner": {"reputation": 7876, "user_id": 2321874, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fbIIO.jpg?s=128&g=1", "display_name": "Mihai Caracostea", "link": "https://stackoverflow.com/users/2321874/mihai-caracostea"}, "edited": false, "score": 0, "creation_date": 1424912294, "post_id": 28729254, "comment_id": 45751167, "body": "I use JustDecompile <a href=\"http://www.telerik.com/download/justdecompile\" rel=\"nofollow noreferrer\">telerik.com/download/justdecompile</a> from Telerik. I got a licence for the whole lot, but I think this particular package is freeware, anyway. When you decompile any .net assembly, you can also view its dependencies (referenced assemblies)."}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "edited": false, "score": 0, "creation_date": 1424951099, "post_id": 28741339, "comment_id": 45766300, "body": "I originally tried the nuget packages but ended up using their actual installer that put the binaries in the Microsoft.NET extensions folder in the Windows directory."}, {"owner": {"reputation": 34013, "user_id": 674326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1ffcb8355a833bc34334d75cefeb3d?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/674326/brandon"}, "reply_to_user": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "edited": false, "score": 0, "creation_date": 1424951328, "post_id": 28741339, "comment_id": 45766444, "body": "which Rx assemblies are you referencing in your project?"}, {"owner": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "edited": false, "score": 0, "creation_date": 1424951457, "post_id": 28741339, "comment_id": 45766531, "body": "None. Absolutely zero. That&#39;s the mind boggling part. I&#39;ve returned back to the branch prior to doing any of this experimentation."}, {"owner": {"reputation": 34013, "user_id": 674326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1ffcb8355a833bc34334d75cefeb3d?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/674326/brandon"}, "reply_to_user": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "edited": false, "score": 0, "creation_date": 1424952722, "post_id": 28741339, "comment_id": 45767259, "body": "Then most likely it is a dependency of the 3rd party library you are originally trying to use, or possibly a dependency of the &quot;backported&quot; System.Threading"}], "tags": [], "owner": {"reputation": 34013, "user_id": 674326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1ffcb8355a833bc34334d75cefeb3d?s=128&d=identicon&r=PG", "display_name": "Brandon", "link": "https://stackoverflow.com/users/674326/brandon"}, "is_accepted": false, "score": -1, "last_activity_date": 1424950417, "creation_date": 1424950417, "answer_id": 28741339, "question_id": 28729254, "link": "https://stackoverflow.com/questions/28729254/why-is-system-reactive-windows-threading-loading/28741339#28741339", "title": "Why is System.Reactive.Windows.Threading loading?", "body": "<p>When you say you \"installed\" Rx what do you mean?  Which NuGet package did you use?  What Rx references does your project have?  Make sure you just use <code>Rx-Main</code>.  It sounds like you might have used one of the flavors that includes Rx-Xaml (such as Rx-WPF or Rx-Silverlight).  Rx-Xaml loads System.Reactive.Windows.Threading.</p>\n\n<p><a href=\"http://blogs.msdn.com/b/rxteam/archive/2012/08/15/reactive-extensions-v2-0-has-arrived.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/rxteam/archive/2012/08/15/reactive-extensions-v2-0-has-arrived.aspx</a> describes the different packages and what they include.</p>\n"}, {"comments": [{"owner": {"reputation": 513, "user_id": 1900615, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/13Qlu.jpg?s=128&g=1", "display_name": "r.pedrosa", "link": "https://stackoverflow.com/users/1900615/r-pedrosa"}, "edited": false, "score": 0, "creation_date": 1535451290, "post_id": 28747470, "comment_id": 91060852, "body": "important to mention that if you do this, all <a href=\"https://git-scm.com/docs/git-clean\" rel=\"nofollow noreferrer\">&quot;untracked directories in addition to untracked files&quot;</a> and you <a href=\"https://stackoverflow.com/questions/6267180/can-i-undo-a-git-clean-fdx\">can not undo this operation</a>"}], "tags": [], "owner": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "is_accepted": true, "score": 0, "last_activity_date": 1424967628, "creation_date": 1424967628, "answer_id": 28747470, "question_id": 28729254, "link": "https://stackoverflow.com/questions/28729254/why-is-system-reactive-windows-threading-loading/28747470#28747470", "title": "Why is System.Reactive.Windows.Threading loading?", "body": "<p>Found it.\nSo there were genuinely no dependencies to the reactive extension left in my solution. However the old libraries that needed it were still left in my bin folder. Uninstalling the nuget packages doesn't remove them. \nOnce the nuget packages are removed, it appears a Clean doesn't remove them. </p>\n\n<p>Here's what I think happened. \nSo there they are sitting in my bin folder which is ignored by git so switching branches doesn't remove them. .NET sees them in the bin folder and despite nothing needing them tries to load them. I had to completely clean out the workspace of all ignored files as well. </p>\n\n<pre><code>git clean -fxd\n</code></pre>\n\n<p>Build from there and I'm good to go. </p>\n"}], "owner": {"reputation": 713, "user_id": 64740, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc5fd0a3134933777cbe3bb5b26cdca6?s=128&d=identicon&r=PG", "display_name": "kareem", "link": "https://stackoverflow.com/users/64740/kareem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "accepted_answer_id": 28747470, "answer_count": 2, "score": 0, "last_activity_date": 1424967628, "creation_date": 1424897233, "last_edit_date": 1424897712, "question_id": 28729254, "link": "https://stackoverflow.com/questions/28729254/why-is-system-reactive-windows-threading-loading", "title": "Why is System.Reactive.Windows.Threading loading?", "body": "<p>I was trying to get a library that required System.Threading.Dll to work with my .NET 3.5 web application project. Since 3.5 doesn't have System.Threading.Dll, I followed a tip to install the Reactive extensions because it has a backported version of System.Threading for 3.5. </p>\n\n<p>The attempt still failed and after enough frustration I backed out abandoned the branch entirely. </p>\n\n<p>Now in my original branch that didn't have any of the experimental work, I'm getting this error. </p>\n\n<pre><code>[BadImageFormatException: Could not load file or assembly 'System.Reactive.Windows.Threading' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded.]\n</code></pre>\n\n<p>The error makes sense. What doesn't make sense is why is it even attempting to load the System.Reactive.Windows.Threading assembly in the first place? There is no reference to it in the solution. I even went as far as uninstalling the extensions altogether from the OS. </p>\n\n<p>Here's the binding info. </p>\n\n<pre><code>=== Pre-bind state information ===\nLOG: User = IIS APPPOOL\\.NET v2.0\nLOG: DisplayName = System.Reactive.Windows.Threading\n (Partial)\nLOG: Appbase = file:///C:/GitHub/v44/Web/\nLOG: Initial PrivatePath = C:\\GitHub\\v44\\Web\\bin\nCalling assembly : (Unknown).\n===\nLOG: This bind starts in default load context.\nLOG: Using application configuration file: C:\\GitHub\\v44\\Web\\web.config\nLOG: Using host configuration file: C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\Aspnet.config\nLOG: Using machine configuration file from C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727\\config\\machine.config.\nLOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).\nLOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v2.0.50727/Temporary ASP.NET Files/root/65a2449d/ebe221c1/System.Reactive.Windows.Threading.DLL.\nLOG: Attempting download of new URL file:///C:/Windows/Microsoft.NET/Framework64/v2.0.50727/Temporary ASP.NET Files/root/65a2449d/ebe221c1/System.Reactive.Windows.Threading/System.Reactive.Windows.Threading.DLL.\nLOG: Attempting download of new URL file:///C:/GitHub/v44/Web/bin/System.Reactive.Windows.Threading.DLL.\nERR: Failed to complete setup of assembly (hr = 0x8013101b). Probing terminated.\n</code></pre>\n\n<p>What is making .NET think it needs to load this assembly?</p>\n"}, {"tags": ["c#", "entity-framework-6"], "comments": [{"owner": {"reputation": 9407, "user_id": 3997611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a853b68fa6a8c75f7490deb6ffdc639?s=128&d=identicon&r=PG", "display_name": "Crypt32", "link": "https://stackoverflow.com/users/3997611/crypt32"}, "edited": false, "score": 0, "creation_date": 1424900050, "post_id": 28729154, "comment_id": 45746345, "body": "how did you implement your DbContext?"}, {"owner": {"reputation": 2857, "user_id": 1693158, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/BeQ2W.jpg?s=128&g=1", "display_name": "dustinmoris", "link": "https://stackoverflow.com/users/1693158/dustinmoris"}, "edited": false, "score": 0, "creation_date": 1424904985, "post_id": 28729154, "comment_id": 45748725, "body": "May I ask why you would want to hide your DbContext? You could wrap it into a repository pattern, which your other classes access then, but I still wouldn&#39;t make it internal."}, {"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1424905086, "post_id": 28729154, "comment_id": 45748773, "body": "What code throws that exception?"}, {"owner": {"reputation": 403, "user_id": 3042893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yyj34.png?s=128&g=1", "display_name": "Zeus-Adenilton", "link": "https://stackoverflow.com/users/3042893/zeus-adenilton"}, "edited": false, "score": 2, "creation_date": 1424955468, "post_id": 28729154, "comment_id": 45768950, "body": "I edited the message and include the implementation of my context. I do not want a public context, because I do not want other libraries to access it directly, because I want to completely encapsulate the data layer. I do not want another developer without access to the source code of the data layer can save an entity using directly Context.SaveChanges () ..."}, {"owner": {"reputation": 45101, "user_id": 304832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6678ab39685245af4ae529ec4c5f112c?s=128&d=identicon&r=PG", "display_name": "danludwig", "link": "https://stackoverflow.com/users/304832/danludwig"}, "edited": false, "score": 0, "creation_date": 1424959351, "post_id": 28729154, "comment_id": 45771412, "body": "Invert your project assemblies so that the code where you do not want DbContext to be used does not take a dependency on the EntityFramework assembly or the assembly where your DbContext is defined. Then you can make it public."}, {"owner": {"reputation": 403, "user_id": 3042893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yyj34.png?s=128&g=1", "display_name": "Zeus-Adenilton", "link": "https://stackoverflow.com/users/3042893/zeus-adenilton"}, "edited": false, "score": 1, "creation_date": 1424960380, "post_id": 28729154, "comment_id": 45772089, "body": "This would not prevent another developer make reference to the library and would add in his project a reference to the assembly EntityFramework. In this way he would have full access to the Context"}, {"owner": {"reputation": 403, "user_id": 3042893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yyj34.png?s=128&g=1", "display_name": "Zeus-Adenilton", "link": "https://stackoverflow.com/users/3042893/zeus-adenilton"}, "edited": false, "score": 0, "creation_date": 1424960817, "post_id": 28729154, "comment_id": 45772414, "body": "Apparently my problem is with the Migration, more precisely in line:SetDatabaseInitializer(new MigrateDatabaseToLatestVersion&lt;Contexto, Configuration&gt;());"}, {"owner": {"reputation": 45101, "user_id": 304832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6678ab39685245af4ae529ec4c5f112c?s=128&d=identicon&r=PG", "display_name": "danludwig", "link": "https://stackoverflow.com/users/304832/danludwig"}, "edited": false, "score": 0, "creation_date": 1424962282, "post_id": 28729154, "comment_id": 45773446, "body": "This does not prevent a developer from using reflection to create an instance of the DbContext."}, {"owner": {"reputation": 403, "user_id": 3042893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yyj34.png?s=128&g=1", "display_name": "Zeus-Adenilton", "link": "https://stackoverflow.com/users/3042893/zeus-adenilton"}, "edited": false, "score": 0, "creation_date": 1424962497, "post_id": 28729154, "comment_id": 45773601, "body": "I am new to C#, please have any suggestions on how I can isolate it completely?"}, {"owner": {"reputation": 45101, "user_id": 304832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6678ab39685245af4ae529ec4c5f112c?s=128&d=identicon&r=PG", "display_name": "danludwig", "link": "https://stackoverflow.com/users/304832/danludwig"}, "edited": false, "score": 0, "creation_date": 1424962660, "post_id": 28729154, "comment_id": 45773737, "body": "You can&#39;t. Best mitigation tactic is regular code reviews on developer commits."}, {"owner": {"reputation": 2034, "user_id": 2816057, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1585677544/picture?type=large", "display_name": "Michael Tranchida", "link": "https://stackoverflow.com/users/2816057/michael-tranchida"}, "reply_to_user": {"reputation": 45101, "user_id": 304832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6678ab39685245af4ae529ec4c5f112c?s=128&d=identicon&r=PG", "display_name": "danludwig", "link": "https://stackoverflow.com/users/304832/danludwig"}, "edited": false, "score": 3, "creation_date": 1455457658, "post_id": 28729154, "comment_id": 58488829, "body": "@danludwig True on the reflection, but as an analogy, locked doors don&#39;t prevent people from entering your house, however, they do provide a pretty good indicator you don&#39;t want them in there."}, {"owner": {"reputation": 3283, "user_id": 1729973, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hokAm.jpg?s=128&g=1", "display_name": "Emad", "link": "https://stackoverflow.com/users/1729973/emad"}, "edited": false, "score": 0, "creation_date": 1474383055, "post_id": 28729154, "comment_id": 66503150, "body": "I personally think that it&#39;s a valid task to make dbcontext internal. The internal EF libraries that are using public properties of the dbcontext through reflection might as well consider  internal properties. This is more important for obfuscation than for layer abstraction. I hope they implement this feature this way."}, {"owner": {"reputation": 10379, "user_id": 263832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2096b47631d1c0690f7a149de682b19b?s=128&d=identicon&r=PG", "display_name": "xr280xr", "link": "https://stackoverflow.com/users/263832/xr280xr"}, "reply_to_user": {"reputation": 45101, "user_id": 304832, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6678ab39685245af4ae529ec4c5f112c?s=128&d=identicon&r=PG", "display_name": "danludwig", "link": "https://stackoverflow.com/users/304832/danludwig"}, "edited": false, "score": 0, "creation_date": 1491578734, "post_id": 28729154, "comment_id": 73631743, "body": "@danludwig - Its about a separation of concerns, not security. Your data layer should be in charge of data access and managing connections. These responsibilities should not be extended outside of your data layer. If the DBcontext is not exposed, you won&#39;t have developers misusing it and violating data access boundaries. You seem to be arguing against the very concept of access modifiers."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 7696658, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_IVq6hWeGv8/AAAAAAAAAAI/AAAAAAAAAyE/eI1davQfPe8/photo.jpg?sz=128", "display_name": "Chad Greer", "link": "https://stackoverflow.com/users/7696658/chad-greer"}, "is_accepted": false, "score": 3, "last_activity_date": 1489276958, "creation_date": 1489276958, "answer_id": 42742139, "question_id": 28729154, "link": "https://stackoverflow.com/questions/28729154/how-to-use-an-internal-dbcontext/42742139#42742139", "title": "How to use an internal DbContext?", "body": "<p>The <strong>virtual DBSet&lt;></strong> properties on the DbContext class must be public (as you found out in your solution.</p>\n\n<p>If you're using TT templates, you can make this happen by changing the <strong>DbSet(EntitySet entitySet)</strong> function.  Notice that the term <strong>public</strong> replaces the original <strong>{0}</strong> parameter in the string format.</p>\n\n<pre><code>public string DbSet(EntitySet entitySet) {\n    return string.Format(\n        CultureInfo.InvariantCulture,\n        \"public virtual DbSet&lt;{0}&gt; {1} {{ get; set; }}\",\n        _typeMapper.GetTypeName(entitySet.ElementType),\n        _code.Escape(entitySet));\n}\n</code></pre>\n\n<p>Now, you can have an internal DbContext, internal objects, and still have the public automatic properties so EF can do its data-binding.</p>\n"}], "owner": {"reputation": 403, "user_id": 3042893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yyj34.png?s=128&g=1", "display_name": "Zeus-Adenilton", "link": "https://stackoverflow.com/users/3042893/zeus-adenilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1646, "favorite_count": 3, "answer_count": 1, "score": 5, "last_activity_date": 1489276958, "creation_date": 1424896898, "last_edit_date": 1424961517, "question_id": 28729154, "link": "https://stackoverflow.com/questions/28729154/how-to-use-an-internal-dbcontext", "title": "How to use an internal DbContext?", "body": "<p>How to use an internal DbContext?\nI wonder how can I hide the DbContext object so that other libraries of my project not directly access.</p>\n\n<p>I put my DbContext as internal in the library, and apparently should work, however when I run the application, the following error appears:</p>\n\n<p>The target context 'Context' is not constructible. Add a default constructor or Provide an Implementation of IDbContextFactory</p>\n\n<p>Could someone help me?</p>\n\n<p>My implementation of data layer is:</p>\n\n<pre><code>[DbConfigurationType(typeof (ConfigContext))]\ninternal class Context : DbContext\n{\n    internal Context()\n        : base(ConfigDataBase.GetSqlServerString(ConfigZnfce.Instance.SqlServerInstance))\n    {\n    }\n    //More code below\n}\n\n\npublic class ConfigContext: DbConfiguration\n{\n    public ConfigContext()\n    {\n        SetDefaultConnectionFactory(new System.Data.Entity.Infrastructure.LocalDbConnectionFactory(\"v11.0\"));\n        SetProviderServices(\"System.Data.SqlClient\", System.Data.Entity.SqlServer.SqlProviderServices.Instance);\n        SetDatabaseInitializer(new CreateDatabaseIfNotExists&lt;Context&gt;());\n        SetDatabaseInitializer(new MigrateDatabaseToLatestVersion&lt;Context, Configuration&gt;());            \n    }\n}\n</code></pre>\n\n<p>I want all the other libraries are required to go through a unit of work and repositories in order to do any operation with the database</p>\n\n<p>[SOLVED]</p>\n\n<p>I left as internal context and the constructor context and public as in the code below:</p>\n\n<pre><code>[DbConfigurationType(typeof (ConfigContext))]\ninternal class Context : DbContext\n{\n    public Context()\n        : base(ConfigDataBase.GetSqlServerString(ConfigZnfce.Instance.SqlServerInstance))\n    {\n    }\n    //More code below\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml"], "answers": [{"comments": [{"owner": {"reputation": 410, "user_id": 1100074, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9f1a98dd407687f7fe98f10028462c54?s=128&d=identicon&r=PG", "display_name": "Wannabe Coder", "link": "https://stackoverflow.com/users/1100074/wannabe-coder"}, "edited": false, "score": 0, "creation_date": 1424898124, "post_id": 28729415, "comment_id": 45745248, "body": "That worked. I can see the header and it is the Channel I want to see. What I don&#39;t understand is why you had me put Name in for the binding since I want to group on Channel. Can you explain to me what I missed?"}, {"owner": {"reputation": 30479, "user_id": 1432140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wBPnm.jpg?s=128&g=1", "display_name": "dkozl", "link": "https://stackoverflow.com/users/1432140/dkozl"}, "reply_to_user": {"reputation": 410, "user_id": 1100074, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9f1a98dd407687f7fe98f10028462c54?s=128&d=identicon&r=PG", "display_name": "Wannabe Coder", "link": "https://stackoverflow.com/users/1100074/wannabe-coder"}, "edited": false, "score": 0, "creation_date": 1424898160, "post_id": 28729415, "comment_id": 45745270, "body": "I&#39;ve added a bit more description. Hope it explains more"}, {"owner": {"reputation": 410, "user_id": 1100074, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9f1a98dd407687f7fe98f10028462c54?s=128&d=identicon&r=PG", "display_name": "Wannabe Coder", "link": "https://stackoverflow.com/users/1100074/wannabe-coder"}, "edited": false, "score": 0, "creation_date": 1424898867, "post_id": 28729415, "comment_id": 45745649, "body": "Ok...I think I understand. I thought it was a property of my data that had to go in there, but it is a property of the CollectionViewGroup that I defined in the &lt;CollectionViewSource.GroupDescriptions&gt; section of my XAML. Right?"}], "tags": [], "owner": {"reputation": 30479, "user_id": 1432140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wBPnm.jpg?s=128&g=1", "display_name": "dkozl", "link": "https://stackoverflow.com/users/1432140/dkozl"}, "is_accepted": true, "score": 0, "last_activity_date": 1424898302, "last_edit_date": 1424898302, "creation_date": 1424897848, "answer_id": 28729415, "question_id": 28729077, "link": "https://stackoverflow.com/questions/28729077/groupbox-header-not-showing/28729415#28729415", "title": "GroupBox Header Not Showing", "body": "<p><code>DataContext</code> against each <code>GroupItem</code> will be of <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewgroup(v=vs.110).aspx\" rel=\"nofollow\"><code>CollectionViewGroup</code></a> type which contains information about each group like <code>Items</code> or <code>Name</code>. You need to change binding in a group header to <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewgroup.name(v=vs.110).aspx\" rel=\"nofollow\"><code>Name</code></a> which will be the value grouped by</p>\n\n<pre><code>&lt;GroupBox.Header&gt;\n    &lt;TextBlock Text=\"{Binding Name}\" FontWeight=\"Bold\" FontSize=\"16\" /&gt;\n&lt;/GroupBox.Header&gt;\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 1100074, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9f1a98dd407687f7fe98f10028462c54?s=128&d=identicon&r=PG", "display_name": "Wannabe Coder", "link": "https://stackoverflow.com/users/1100074/wannabe-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 28729415, "answer_count": 1, "score": 0, "last_activity_date": 1424898302, "creation_date": 1424896606, "last_edit_date": 1495539813, "question_id": 28729077, "link": "https://stackoverflow.com/questions/28729077/groupbox-header-not-showing", "title": "GroupBox Header Not Showing", "body": "<p>I followed an this <a href=\"https://stackoverflow.com/questions/3883955/wpf-itemscontrol-itemtemplate-border-with-groupstyle\">StackOverflow</a> question, which has a link to another article, on how to group data, but my header is not showing. Can someone point me to the problem of why my header is not showing in the grouping of my data. The only thing different between the article and my markup that I see is that my data is in a different format, but I have no control on how I receive it.</p>\n\n<p>Representation of my data:</p>\n\n<pre><code>&lt;MyDetails xmlns=\"clr-namespace:MyCompany.Mapping;assembly=Mapping\" xmlns:scg=\"clr-\n    namespace:System.Collections.Generic;assembly=mscorlib\" xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"&gt;\n    &lt;MyDetails.Details&gt;\n        &lt;scg:List x:TypeArguments=\"MyAttributes\" Capacity=\"64\"&gt;\n            &lt;MyAttributes Bit=\"0\" Channel=\"1\" Name=\"SomeName\" IOAttribute=\"O\" /&gt;\n        &lt;/scg:List&gt;\n    &lt;/MyDetails.Details&gt;\n&lt;/MyDetails&gt;\n</code></pre>\n\n<p>ViewModel Property I bind to:</p>\n\n<pre><code>ObservableCollection&lt;MyDetails&gt; Channels= new \nObservableCollection&lt;MyDetails&gt;();\n</code></pre>\n\n<p>MyDetails Class Public Property (Defined as a DataMember):</p>\n\n<pre><code>List&lt;MyAttributes&gt; Details = new List&lt;MyAttributes&gt;();\n</code></pre>\n\n<p>MyAttributes Class Public Properties (All defined as a DataMembers):</p>\n\n<pre><code>property string Channel {get; set;}\nproperty string Bit {get; set;}\nproperty string Name {get; set;}\nproperty string Attribute {get; set;}\n</code></pre>\n\n<p>XAML Resource Header:</p>\n\n<pre><code>&lt;CollectionViewSource x:Key=\"MyDetails\" Source=\"{Binding Channels[0].Details}\"&gt;\n    &lt;CollectionViewSource.GroupDescriptions&gt;\n        &lt;PropertyGroupDescription PropertyName=\"Channel\" /&gt;\n    &lt;/CollectionViewSource.GroupDescriptions&gt;\n&lt;/CollectionViewSource&gt;\n</code></pre>\n\n<p>XAML:</p>\n\n<pre><code>&lt;ItemsControl ItemsSource=\"{Binding Source={StaticResource MyDetails}}\"&gt;\n&lt;ItemsControl.GroupStyle&gt;\n    &lt;GroupStyle&gt;\n        &lt;GroupStyle.ContainerStyle&gt;\n            &lt;Style TargetType=\"{x:Type GroupItem}\"&gt;\n                &lt;Setter Property=\"Template\"&gt;\n                    &lt;Setter.Value&gt;\n                        &lt;ControlTemplate TargetType=\"{x:Type GroupItem}\"&gt;\n                            &lt;GroupBox Margin=\"10\" &gt;\n                                &lt;GroupBox.Header&gt;\n                                &lt;TextBlock Text=\"{Binding Channel}\" FontWeight=\"Bold\" FontSize=\"16\" /&gt; &lt;!-- Does not show --&gt;\n                                &lt;/GroupBox.Header&gt;\n                                &lt;ItemsPresenter /&gt;\n                            &lt;/GroupBox&gt;\n                        &lt;/ControlTemplate&gt;\n                    &lt;/Setter.Value&gt;\n                &lt;/Setter&gt;\n            &lt;/Style&gt;\n        &lt;/GroupStyle.ContainerStyle&gt;\n    &lt;/GroupStyle&gt;\n&lt;/ItemsControl.GroupStyle&gt;\n&lt;ItemsControl.ItemTemplate&gt;\n    &lt;DataTemplate&gt;\n        &lt;StackPanel Orientation=\"Horizontal\"&gt;\n            &lt;TextBlock Text=\"{Binding Path=Bit}\" Width=\"50\" /&gt;\n            &lt;TextBlock Text=\"{Binding Path=Name}\" Width=\"150\" /&gt;\n            &lt;TextBlock Text=\"{Binding Path=Attribute}\" Width=\"50\" /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n&lt;/ItemsControl.ItemTemplate&gt;\n&lt;/ItemsControl&gt;\n</code></pre>\n"}, {"tags": ["c#", ".net", "reportviewer", "rdlc"], "comments": [{"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1424896761, "post_id": 28729050, "comment_id": 45744486, "body": "There are multiple versions. This question may be useful --&gt; <a href=\"http://stackoverflow.com/questions/27293005/microsoft-reportviewer-dlls-are-not-showing-up-in-references-v11-or-12/27299537#27299537\" title=\"microsoft reportviewer dlls are not showing up in references v11 or 12\">stackoverflow.com/questions/27293005/&hellip;</a>"}, {"owner": {"reputation": 413, "user_id": 1063474, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caafe52a8d9e565719997511c8af01c6?s=128&d=identicon&r=PG", "display_name": "Digital God", "link": "https://stackoverflow.com/users/1063474/digital-god"}, "reply_to_user": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1424896840, "post_id": 28729050, "comment_id": 45744530, "body": "I know. 2005, 2008, 2010, 2012... I need one, that will run on each OS and .Net version."}], "owner": {"reputation": 413, "user_id": 1063474, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caafe52a8d9e565719997511c8af01c6?s=128&d=identicon&r=PG", "display_name": "Digital God", "link": "https://stackoverflow.com/users/1063474/digital-god"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424896505, "creation_date": 1424896505, "question_id": 28729050, "link": "https://stackoverflow.com/questions/28729050/using-reportviewer-in-net-app", "title": "Using ReportViewer in .NET app", "body": "<p>I'm trying to create simple app that support multiple .NET framework versions (2.0, 3.0, 3.5, 4.0, 4.5) on Windows XP, Vista, 7, 8.\nAll what the programm have to do - it is printing a rdlc report.</p>\n\n<p>Currently i configured <strong>supportedRuntime</strong> to </p>\n\n<ol>\n<li>v2.0.50727</li>\n<li>v4.0</li>\n<li>v4.0 sku=.NETFramework,Version=v4.5</li>\n</ol>\n\n<p>What version of ReportViewer i must use?</p>\n"}, {"tags": ["c#", "python", ".net", "ironpython"], "comments": [{"owner": {"reputation": 233, "user_id": 4035921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57cec0585de63772d3b4e65003e0c61?s=128&d=identicon&r=PG&f=1", "display_name": "TechneWare", "link": "https://stackoverflow.com/users/4035921/techneware"}, "edited": false, "score": 0, "creation_date": 1424897082, "post_id": 28729031, "comment_id": 45744664, "body": "Not at all familiar with IronPython, but from a C# point of view It looks like your values are all hiding within the struct &quot;Parameters&quot;.  So it would make sense that anIntValue is not defined on the MyClass object since it is defined under MyClass.Parameters.anIntValue.  Does it work if you expose anIntValue directly as a member of the class?"}, {"owner": {"reputation": 718, "user_id": 942696, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/95e24ee53fe0f34f7bb7a0cdbe64d53b?s=128&d=identicon&r=PG&f=1", "display_name": "ElCapitaine", "link": "https://stackoverflow.com/users/942696/elcapitaine"}, "reply_to_user": {"reputation": 233, "user_id": 4035921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57cec0585de63772d3b4e65003e0c61?s=128&d=identicon&r=PG&f=1", "display_name": "TechneWare", "link": "https://stackoverflow.com/users/4035921/techneware"}, "edited": false, "score": 0, "creation_date": 1424897488, "post_id": 28729031, "comment_id": 45744881, "body": "This is actually an error on my part, obj = MyClass.Parameters() is really how I wrote it in IronPython code. (I can&#39;t seem to have privileges to edit my own question)"}], "answers": [{"tags": [], "owner": {"reputation": 718, "user_id": 942696, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/95e24ee53fe0f34f7bb7a0cdbe64d53b?s=128&d=identicon&r=PG&f=1", "display_name": "ElCapitaine", "link": "https://stackoverflow.com/users/942696/elcapitaine"}, "is_accepted": true, "score": 0, "last_activity_date": 1424899152, "creation_date": 1424899152, "answer_id": 28729805, "question_id": 28729031, "link": "https://stackoverflow.com/questions/28729031/setting-field-in-ironpython-resulting-in-none-value/28729805#28729805", "title": "Setting field in IronPython resulting in None value", "body": "<p>I resolved it because actually,</p>\n\n<p>the instance I had to call in </p>\n\n<pre><code> MyClass.Parameters.anIntValue.SetValue(instance,value)\n</code></pre>\n\n<p>was not :</p>\n\n<pre><code>MyClass.Parameters.anIntValue.SetValue(obj.anIntValue,8)\n</code></pre>\n\n<p>but rather :</p>\n\n<pre><code>MyClass.Parameters.anIntValue.SetValue(obj,8)\n</code></pre>\n"}], "owner": {"reputation": 718, "user_id": 942696, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/95e24ee53fe0f34f7bb7a0cdbe64d53b?s=128&d=identicon&r=PG&f=1", "display_name": "ElCapitaine", "link": "https://stackoverflow.com/users/942696/elcapitaine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 28729805, "answer_count": 1, "score": 0, "last_activity_date": 1424899152, "creation_date": 1424896443, "last_edit_date": 1424896683, "question_id": 28729031, "link": "https://stackoverflow.com/questions/28729031/setting-field-in-ironpython-resulting-in-none-value", "title": "Setting field in IronPython resulting in None value", "body": "<p>I have an issue using IronPython. I created a C# DLL in which I have a class that looks like this :</p>\n\n<pre><code>namespace MyNamespace\n{\n\n    public static class MyClass\n    {\n\n       public struct Parameters\n       {\n           public String str1;\n           public String str2;\n           public int anIntValue;\n       }\n\n       public static void MyMethod(Parameters param, out Double Result, ref String msg)\n       {\n           //...Stuff...\n       }\n</code></pre>\n\n<p>And the code in IronPython looks like this :</p>\n\n<pre><code>import clr\nclr.AddReferenceToFileAndPath(\"C:\\MyPath\\MyFile.dll\")\n\nfrom MyFile import MyNamespace\n\nobj = MyClass()\nobj.anIntValue = 8\nprint obj.anIntValue \n</code></pre>\n\n<p>It outputs the value \"0\" and I get a warning : </p>\n\n<pre><code>RuntimeWarning: Setting field anIntValue on value type MyClass may result in updating a copy. \nUse MyClass.anIntValue.SetValue(instance, value)...\n</code></pre>\n\n<p>So I tried the following : </p>\n\n<pre><code>MyClass.anIntValue.SetValue(obj.anIntValue,8)\n</code></pre>\n\n<p>And I get the following error : </p>\n\n<pre><code>ValueError : Field 'anIntValue' defined on type 'MyNamespace.MyClass' is not\na field on the target object which is of type 'System.Int32'. \n</code></pre>\n\n<p>So basically, the only thing I would like to do, is to create an object from \"MyClass\" and assign values to its attributes, but when I tried to do it the \"standard way\", like <code>anAttribute = aValue</code>, If I understand this correctly, it only copies the value into a temporary object and not to the object I want to modify. </p>\n\n<p>Am I missing something here ?</p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 1, "creation_date": 1424896497, "post_id": 28729017, "comment_id": 45744331, "body": "which <code>Application</code> class is this? what not found error?"}, {"owner": {"reputation": 23604, "user_id": 1043198, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/fd794fa557e412eefe8aa19251412df8?s=128&d=identicon&r=PG", "display_name": "Ant P", "link": "https://stackoverflow.com/users/1043198/ant-p"}, "edited": false, "score": 1, "creation_date": 1424896562, "post_id": 28729017, "comment_id": 45744368, "body": "Have you tried spelling &quot;First&quot; the same everywhere?"}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 1, "creation_date": 1424896597, "post_id": 28729017, "comment_id": 45744384, "body": "If this is really C#, then you want <code>Application[&quot;First&quot;]</code>"}, {"owner": {"reputation": 135, "user_id": 4010045, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/66d7be161027620dbafc646dc377703e?s=128&d=identicon&r=PG&f=1", "display_name": "User765876", "link": "https://stackoverflow.com/users/4010045/user765876"}, "reply_to_user": {"reputation": 23604, "user_id": 1043198, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/fd794fa557e412eefe8aa19251412df8?s=128&d=identicon&r=PG", "display_name": "Ant P", "link": "https://stackoverflow.com/users/1043198/ant-p"}, "edited": false, "score": 0, "creation_date": 1424896704, "post_id": 28729017, "comment_id": 45744440, "body": "@AntP Spelling is not the mistake, that was just a typo when i was typing here."}, {"owner": {"reputation": 135, "user_id": 4010045, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/66d7be161027620dbafc646dc377703e?s=128&d=identicon&r=PG&f=1", "display_name": "User765876", "link": "https://stackoverflow.com/users/4010045/user765876"}, "reply_to_user": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 0, "creation_date": 1424896775, "post_id": 28729017, "comment_id": 45744493, "body": "@john how would I use it? it still says <code>cannot resolve symbol Application</code>"}, {"owner": {"reputation": 157295, "user_id": 76337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1aa48f7606f5b08595b0a0356a61e8b6?s=128&d=identicon&r=PG", "display_name": "John Saunders", "link": "https://stackoverflow.com/users/76337/john-saunders"}, "edited": false, "score": 1, "creation_date": 1424897493, "post_id": 28729017, "comment_id": 45744887, "body": "Try using <code>HttpContext.Application</code>."}], "answers": [{"tags": [], "owner": {"reputation": 36615, "user_id": 111266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/441c43192e97e0374d0c18d8c37ebe47?s=128&d=identicon&r=PG", "display_name": "Joe Enos", "link": "https://stackoverflow.com/users/111266/joe-enos"}, "is_accepted": true, "score": 2, "last_activity_date": 1424897808, "creation_date": 1424897808, "answer_id": 28729401, "question_id": 28729017, "link": "https://stackoverflow.com/questions/28729017/how-to-use-application-objects-in-asp-net-mvc/28729401#28729401", "title": "How to use Application objects in asp.net mvc?", "body": "<p>In a controller action, it would be <code>HttpContext.Application[\"First\"]</code>.</p>\n\n<p>If you're in a static method or outside a controller, you could do <code>System.Web.HttpContext.Current.Application[\"First\"]</code>.</p>\n"}], "owner": {"reputation": 135, "user_id": 4010045, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/66d7be161027620dbafc646dc377703e?s=128&d=identicon&r=PG&f=1", "display_name": "User765876", "link": "https://stackoverflow.com/users/4010045/user765876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 28729401, "answer_count": 1, "score": -3, "last_activity_date": 1424903370, "creation_date": 1424896392, "last_edit_date": 1424903370, "question_id": 28729017, "link": "https://stackoverflow.com/questions/28729017/how-to-use-application-objects-in-asp-net-mvc", "title": "How to use Application objects in asp.net mvc?", "body": "<p>In the Global.asax I added a few values to the application object:</p>\n\n<pre><code>Application.Add(\"First\", \"One\");\nApplication.Add(\"Second\", \"Two\");\nApplication.Add(\"Third\", \"Three\");\nApplication.Add(\"Forth\", \"Four\");\n</code></pre>\n\n<p>How do I use them in my controller?</p>\n\n<p>I tried:</p>\n\n<pre><code>var x = Application(\"First\");\n</code></pre>\n\n<p>But <code>Application</code> is giving me an error, it says <code>cannot resolve symbol Application</code></p>\n"}, {"tags": ["c#", "asp.net", "iframe", "reporting-services"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 1290922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a75a0ae49481b639e96f35e3ea62c3f?s=128&d=identicon&r=PG", "display_name": "Grinder", "link": "https://stackoverflow.com/users/1290922/grinder"}, "is_accepted": false, "score": 0, "last_activity_date": 1424976548, "creation_date": 1424976548, "answer_id": 28750394, "question_id": 28729011, "link": "https://stackoverflow.com/questions/28729011/iframe-not-rendering-in-net-reportviewer-web-control/28750394#28750394", "title": "iframe not Rendering in .NET ReportViewer Web Control", "body": "<p>So it looks like this was an environment issue after all and had nothing to do with the code. The custom control that contained the report viewer control was blocking it from allowing errors to bubble up since it was directly writing the render to HTML. It turned out to be Report Server permissions.</p>\n"}], "owner": {"reputation": 81, "user_id": 1290922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5a75a0ae49481b639e96f35e3ea62c3f?s=128&d=identicon&r=PG", "display_name": "Grinder", "link": "https://stackoverflow.com/users/1290922/grinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424976548, "creation_date": 1424896371, "question_id": 28729011, "link": "https://stackoverflow.com/questions/28729011/iframe-not-rendering-in-net-reportviewer-web-control", "title": "iframe not Rendering in .NET ReportViewer Web Control", "body": "<p>I have a .NET Webform ReportViewer control. When I run it locally everything is fine. But when deployed to a server it won't render. debugging on the browser shows that the iframe that handles everything is simply not present. </p>\n\n<p>this is all in a custom control that was here before my time. So basically when the render method is called the custom control adds the controls to a panel control, then uses the HTMLWriter class so create a div, calls .Render() and then passes in the HTMLwriter. I used string comparison to see if the iframe was somehow being sanitized(for security)  by the browser, but it is not. I have verified the server has v 8,9, and 10 of both ReportViewer.Common and ReportViewer.Webform. I have tried referencing all of these in my web.config and msproj references and still no joy. Its the weirdest thing, same microsoft library, 2 different boxes, writes two different HTML strings.</p>\n\n<p>Anyone seen anything like this. I have definitely checked through SO and found most of it has to do with the missing assemblies from the GAC, but I am seeing all of them present. Environment issues are so frustrating!</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 5, "creation_date": 1424896897, "post_id": 28728982, "comment_id": 45744558, "body": "Just one line :) <code>int indexOfSpace = response.IndexOf(&quot; &quot;);  int indexOfNewLine = response.IndexOf(&quot;\\n&quot;);  string responseSubString = &quot;&quot;;    if (indexOfNewLine &gt; 0 &amp;&amp; indexOfNewLine &lt; indexOfSpace)  {      responseSubString = response.Substring(0, response.IndexOf(&quot;\\n&quot;));  }  else  {      responseSubString = response.Substring(0, response.IndexOf(&quot; &quot;));  }</code>"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1424897646, "post_id": 28728982, "comment_id": 45744992, "body": "@EZI :) also <code>string.Join(&quot;&quot;, response.TakeWhile(c =&gt; c!=&#39; &#39; &amp;&amp; c != &#39;\\n&#39;))</code> is more honest one-line..."}, {"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1424898146, "post_id": 28728982, "comment_id": 45745261, "body": "<code>responseSubString = str.Split(new[]{&#39; &#39;,&#39;\\n&#39;},2).First();</code>"}, {"owner": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "reply_to_user": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1424898211, "post_id": 28728982, "comment_id": 45745294, "body": "@Habib Why <code>FirstOrDefault</code> ? Split always returns an array with 1 element for sure. You can use <code>First</code> or just access array[0];"}, {"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "reply_to_user": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 0, "creation_date": 1424898258, "post_id": 28728982, "comment_id": 45745322, "body": "@SriramSakthivel, Yup right."}], "answers": [{"comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1424896569, "post_id": 28729043, "comment_id": 45744372, "body": "It does unnecessarily spend the effort to split the entire string, looking for every single space and new line, rather than just the first."}, {"owner": {"reputation": 1728, "user_id": 3630637, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/aad28ff725c539aff3e1004f863da15e?s=128&d=identicon&r=PG&f=1", "display_name": "learningcs", "link": "https://stackoverflow.com/users/3630637/learningcs"}, "edited": false, "score": 1, "creation_date": 1424896642, "post_id": 28729043, "comment_id": 45744409, "body": "<code>responseSubString = response != null ? response.Split(&#39; &#39;, &#39;\\n&#39;)[0] : null;</code> returns the first word of the string, or null if the string is null."}, {"owner": {"reputation": 4940, "user_id": 2284240, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/oD1Lo.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/2284240/vishal"}, "edited": false, "score": 0, "creation_date": 1424896653, "post_id": 28729043, "comment_id": 45744412, "body": "I have tried your code. It gives me the result when response string contains a new line just after the first word. But it does not work, if first word is followed by a space."}, {"owner": {"reputation": 23345, "user_id": 3697011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98fc0c1fce045a8b4946943c079ce538?s=128&d=identicon&r=PG&f=1", "display_name": "dotnetom", "link": "https://stackoverflow.com/users/3697011/dotnetom"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1424896812, "post_id": 28729043, "comment_id": 45744515, "body": "@Servy That&#39;s right, thanks for noticing that. I updated the answer"}, {"owner": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1424896843, "post_id": 28729043, "comment_id": 45744533, "body": "@Servy If splitting all over the string is a concern, you could limit it using the overload of split method which takes count as parameter and provide <code>2</code> as a input for it. It will  not split the string fully, but just once."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1424896848, "post_id": 28729043, "comment_id": 45744535, "body": "@dotnetom Yeah, still has the issue of unnecessarily parsing the whole string though."}, {"owner": {"reputation": 4940, "user_id": 2284240, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/oD1Lo.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/2284240/vishal"}, "edited": false, "score": 0, "creation_date": 1424896966, "post_id": 28729043, "comment_id": 45744591, "body": "Oops! I was wrong. It works fine. Thanks for the answer."}, {"owner": {"reputation": 23345, "user_id": 3697011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98fc0c1fce045a8b4946943c079ce538?s=128&d=identicon&r=PG&f=1", "display_name": "dotnetom", "link": "https://stackoverflow.com/users/3697011/dotnetom"}, "reply_to_user": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 1, "creation_date": 1424897214, "post_id": 28729043, "comment_id": 45744731, "body": "@SriramSakthivel Thank you for the tip, I updated the answer accordingly"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1424897409, "post_id": 28729043, "comment_id": 45744832, "body": "You do not want to have <code>RemoveEmptyEntries</code>.  That will in fact <i>break</i> the code if there is an empty string, or if there is a delimiter at the start of the string."}], "tags": [], "owner": {"reputation": 23345, "user_id": 3697011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98fc0c1fce045a8b4946943c079ce538?s=128&d=identicon&r=PG&f=1", "display_name": "dotnetom", "link": "https://stackoverflow.com/users/3697011/dotnetom"}, "is_accepted": true, "score": 4, "last_activity_date": 1424897132, "last_edit_date": 1424897132, "creation_date": 1424896485, "answer_id": 28729043, "question_id": 28728982, "link": "https://stackoverflow.com/questions/28728982/can-you-shorten-this-code-to-single-liner/28729043#28729043", "title": "Can you shorten this code to single liner?", "body": "<p>Try this:</p>\n\n<pre><code>responseSubString = response.Split(' ', '\\n')[0];\n</code></pre>\n\n<p>This code splits your string by space and new line symbol and returns the first member. It assumes string is not null, in which case you would get a <code>NullReferenceException</code>.</p>\n\n<p>For better control you can use the overload with extra parameters, which define how many string items to use in split operation (you don't need more than 1) and options to remove empty strings (if you have multiple strings in a row):</p>\n\n<pre><code>responseSubString = response.Split(new char[] {' ', '\\n'}, 2, StringSplitOptions.RemoveEmptyEntries)[0]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4940, "user_id": 2284240, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/oD1Lo.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/2284240/vishal"}, "edited": false, "score": 0, "creation_date": 1424897619, "post_id": 28729338, "comment_id": 45744968, "body": "Thanks for trying to answer my question."}], "tags": [], "owner": {"reputation": 1728, "user_id": 3630637, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/aad28ff725c539aff3e1004f863da15e?s=128&d=identicon&r=PG&f=1", "display_name": "learningcs", "link": "https://stackoverflow.com/users/3630637/learningcs"}, "is_accepted": false, "score": 2, "last_activity_date": 1424899356, "last_edit_date": 1424899356, "creation_date": 1424897553, "answer_id": 28729338, "question_id": 28728982, "link": "https://stackoverflow.com/questions/28728982/can-you-shorten-this-code-to-single-liner/28729338#28729338", "title": "Can you shorten this code to single liner?", "body": "<p>Alternatively to using String.Split, this Regex should also work:</p>\n\n<pre><code>//Find the first word in a string\nstring myString = \"thisisthefirstword of this\\nstring\\n\";\nstring firstWord = Regex.Match(myString, @\"^([\\w\\-]+)\").Value;\n\n// firstWord: \"thisisthefirstword\"\n</code></pre>\n\n<p>However, the accepted answer is about 10x faster (2 minutes versus 20 minutes for 1 million executions).</p>\n"}, {"tags": [], "owner": {"reputation": 59791, "user_id": 467473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af668442ab8ce6408bd051b350d89c01?s=128&d=identicon&r=PG", "display_name": "Nicholas Carey", "link": "https://stackoverflow.com/users/467473/nicholas-carey"}, "is_accepted": false, "score": 0, "last_activity_date": 1424906570, "creation_date": 1424906570, "answer_id": 28731677, "question_id": 28728982, "link": "https://stackoverflow.com/questions/28728982/can-you-shorten-this-code-to-single-liner/28731677#28731677", "title": "Can you shorten this code to single liner?", "body": "<p>Here's five:</p>\n\n<ul>\n<li><p>Regular Expression: anchored match from start of string to 1st whitespace</p>\n\n<pre><code>firstWord = Regex.Match(   text , @\"^\\S+\"       ).Value ;\n</code></pre></li>\n<li><p>Regular Expression: trim from 1st whitespace to end-of-string using anchored match</p>\n\n<pre><code>firstWord = Regex.Replace( text , @\"\\s.*$\" , \"\" ) ;\n</code></pre></li>\n<li><p>Linq</p>\n\n<pre><code>firstWord = text.TakeWhile( c =&gt; !char.IsWhiteSpace(c) ).Aggregate(new StringBuilder(), (sb,c) =&gt; sb.Append(c) ).ToString();\n</code></pre></li>\n<li><p>Two variants using <code>string.Substring()</code> and <code>string.IndexofAny()</code></p>\n\n<pre><code>// this will fail if the string has no whitespace\nfirstWord = text.Substring(0, text.IndexOfAny( \" \\r\\n\\t\\f\\v\".ToCharArray() ) ) ;\n\n// this will NOT fail in the same condition ... at the expense of creating a temporary\nfirstWord = (text+\" \").Substring(0, text.IndexOfAny( \" \\r\\n\\t\\f\\v\".ToCharArray() ) );\n</code></pre></li>\n</ul>\n\n<p>One should note that none of these are likely to be as speedy as the simple and obvious:</p>\n\n<pre><code>public static string FirstWord( this string s )\n{\n  if ( s == null ) throw new ArgumentNullException(\"s\");\n\n  int i = 0 ;\n  while ( i &lt; s.Length &amp;&amp; !char.isWhiteSpace(s[i]) )\n  {\n    ++i ;\n  }\n\n  if ( i == 0 ) throw new InvalidOperationException(\"no word found\");\n  return s.Substring(0,i);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 4940, "user_id": 2284240, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/oD1Lo.jpg?s=128&g=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/2284240/vishal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 28729043, "answer_count": 3, "score": -2, "last_activity_date": 1424906570, "creation_date": 1424896284, "question_id": 28728982, "link": "https://stackoverflow.com/questions/28728982/can-you-shorten-this-code-to-single-liner", "title": "Can you shorten this code to single liner?", "body": "<p>Is this code convertible to 1 liner or at the max 2 liner?</p>\n\n<pre><code>int indexOfSpace = response.IndexOf(\" \");\nint indexOfNewLine = response.IndexOf(\"\\n\");\nstring responseSubString = \"\";\n\nif (indexOfNewLine &gt; 0 &amp;&amp; indexOfNewLine &lt; indexOfSpace)\n{\n    responseSubString = response.Substring(0, response.IndexOf(\"\\n\"));\n}\nelse\n{\n    responseSubString = response.Substring(0, response.IndexOf(\" \"));\n}\n</code></pre>\n\n<p>Basically, I am trying to get the first word from a string that may contain a space or a new line after the first word.</p>\n"}, {"tags": ["c#", ".net", ".net-4.0", "filestream", "streamreader"], "comments": [{"owner": {"reputation": 10256, "user_id": 1043380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2388aa1beb9ac75029a5b4fafec11eec?s=128&d=identicon&r=PG", "display_name": "gunr2171", "link": "https://stackoverflow.com/users/1043380/gunr2171"}, "edited": false, "score": 0, "creation_date": 1424897286, "post_id": 28728903, "comment_id": 45744776, "body": "Why do you have to close the reader before opening the writer? Why can&#39;t you have them both open at the same time?"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "reply_to_user": {"reputation": 10256, "user_id": 1043380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2388aa1beb9ac75029a5b4fafec11eec?s=128&d=identicon&r=PG", "display_name": "gunr2171", "link": "https://stackoverflow.com/users/1043380/gunr2171"}, "edited": false, "score": 0, "creation_date": 1424897515, "post_id": 28728903, "comment_id": 45744902, "body": "@gunr2171 &quot;Long running application&quot;. The first phase is to replay a log, the second phase is to append to the same log.. while I could keep the Reader around indefinitely, such that it is never Closed, I&#39;d really like to find a &#39;better&#39; way."}, {"owner": {"reputation": 3053, "user_id": 1322693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcf6557df415fcd3b6824338a38eb6b?s=128&d=identicon&r=PG", "display_name": "konkked", "link": "https://stackoverflow.com/users/1322693/konkked"}, "edited": false, "score": 0, "creation_date": 1424897560, "post_id": 28728903, "comment_id": 45744932, "body": "I think the heaviest thing about the stream readers is the actual stream, I don&#39;t see the harm with just keeping them both open, the only other way to solve this in your case would be to implement a new stream reader and writer that don&#39;t dispose the file stream"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1424897610, "post_id": 28728903, "comment_id": 45744963, "body": "It&#39;s not about &quot;using resources&quot; (there is only one FileStream after all, and the entire buffer used by the reader is inconsequential)  - it&#39;s about &quot;shaking my head&quot; at using a field just to maintain the reader lifetime (it must be kept GC-alive) and omitting using <code>using</code> around the read (which is a local operation, the write will happen many times until the parent is Disposed)."}, {"owner": {"reputation": 3053, "user_id": 1322693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcf6557df415fcd3b6824338a38eb6b?s=128&d=identicon&r=PG", "display_name": "konkked", "link": "https://stackoverflow.com/users/1322693/konkked"}, "edited": false, "score": 1, "creation_date": 1424897775, "post_id": 28728903, "comment_id": 45745060, "body": "@user2864740 I understand that you want to do it that way (because it makes more sense that way) but you would either have to implement it yourself or just keep the variables open, or upgrade to a version of .NET that allows you to use the flag you mentioned to keep the file stream open"}], "answers": [{"comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1424896233, "post_id": 28728955, "comment_id": 45744183, "body": "FileStream does not offer Text-related operations methods like WriteLine and ReadLine which come from StreamReader/StreamWriter - and when a StreamReader/StreamWriter is Disposed it will (by default) <i>automatically dispose the underlying stream</i>. I am limited to .NET 4 so I <a href=\"https://msdn.microsoft.com/en-us/library/gg712952(v=vs.110).aspx\" rel=\"nofollow noreferrer\">cannot use the &quot;leaveOpen&quot; constructor overloads</a>."}, {"owner": {"reputation": 3053, "user_id": 1322693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcf6557df415fcd3b6824338a38eb6b?s=128&d=identicon&r=PG", "display_name": "konkked", "link": "https://stackoverflow.com/users/1322693/konkked"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1424897040, "post_id": 28728955, "comment_id": 45744638, "body": "@user2864740, updated answer, you should be able to still modify the stream even when it is consumed by a reader, if this is the case just wait until the end to dispose both of the stream handling objects"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1424897046, "post_id": 28728955, "comment_id": 45744642, "body": "While that update &quot;would work&quot; by effect of not doing the writing <i>after</i> the reader is disposed (and the fact the Dispose calls are idempotent), it dodges the question. I don&#39;t want to keep around the reader &quot;just so that doesn&#39;t Close the source&quot; (it has to be kept GC-alive as well). In this application the reading is done once at the start and the writing over some time, until the application closes (think of it as a log)."}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1424898600, "post_id": 28728955, "comment_id": 45745498, "body": "@user2864740: Are you worried that keeping the TextReader undisposed would cause some kind of performance issue? I suspect that the memory cost of keeping a TextReader open is pretty trivial, considering you want the underlying stream to be left open anyway."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "reply_to_user": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "edited": false, "score": 0, "creation_date": 1424899302, "post_id": 28728955, "comment_id": 45745870, "body": "@StriplingWarrior No, I am not worried about &quot;performance&quot; - I go by 97/3. I also go by the 3 (or 6) virtues. See my comment on the main question."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1425488199, "post_id": 28728955, "comment_id": 45986083, "body": "While I&#39;m <i>not</i> fond of &quot;leaving the reader open indefinitely over the writing&quot; this approach does work so.."}], "tags": [], "owner": {"reputation": 3053, "user_id": 1322693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bcf6557df415fcd3b6824338a38eb6b?s=128&d=identicon&r=PG", "display_name": "konkked", "link": "https://stackoverflow.com/users/1322693/konkked"}, "is_accepted": true, "score": 5, "last_activity_date": 1424897854, "last_edit_date": 1424897854, "creation_date": 1424896167, "answer_id": 28728955, "question_id": 28728903, "link": "https://stackoverflow.com/questions/28728903/how-to-read-from-and-then-write-append-to-a-text-file-without-re-opening-the-fil/28728955#28728955", "title": "How to Read from and then Write/Append to a Text File without re-opening the file?", "body": "<p>You be able to just set the position of the stream to the end of the stream and write from there</p>\n\n<pre><code> fs.Position = fs.Length;\n //then do the write operations you need to do\n</code></pre>\n\n<p>Even if you are using a stream writer or reader you should be able to modify the FileStream that the reader/writer is consuming, which would allow you to read then write</p>\n\n<pre><code>using(var fs = File.Open(filename, FileMode.OpenOrCreate, FileAccess.ReadWrite)\n{\n    using(var reader = new TextReader(fs))\n    using(var writer = new TextWriter(fs))\n    {\n        //read\n\n        fs.Position = fs.Length;\n\n        //write\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1454, "favorite_count": 0, "accepted_answer_id": 28728955, "answer_count": 1, "score": 3, "last_activity_date": 1424898189, "creation_date": 1424895943, "last_edit_date": 1495541334, "question_id": 28728903, "link": "https://stackoverflow.com/questions/28728903/how-to-read-from-and-then-write-append-to-a-text-file-without-re-opening-the-fil", "title": "How to Read from and then Write/Append to a Text File without re-opening the file?", "body": "<p>How can I open a FileStream, <em>read</em> the file contents, and then <em>write</em> (append) to file without re-opening the file?</p>\n\n<p>A problem with StreamReader/StreamWriter in this case is <a href=\"https://stackoverflow.com/questions/23162988/who-owns-wrapped-streams-e-g-textwriter-in-net\">they assume ownwership of the underlying stream</a>. Since the target is .NET 4 the <a href=\"https://msdn.microsoft.com/en-us/library/gg712952(v=vs.110).aspx\" rel=\"nofollow noreferrer\">\"leaveOpen\" constructor overloads</a> cannot be used. (I don't care if StreamReader/StreamWriter are used - but they do provide ReadLine and WriteLine operations.)</p>\n\n<p>In summary, example of problematic code related to the question and how the application will access and manage the lifetime of the FileStream (that is to be opened once):</p>\n\n<pre><code>var fs = File.Open(..);\nusing (var reader = new StreamReader(fs)) {\n   // Do all reading here, then ditch the reader\n}  // .. but StreamReader will Close the FileStream\n\nSeekToEnd(fs);\n\nusing (var writer = new StreamWriter(fs)) {\n   // Do all writing here, then ditch the writer\n   // .. ideal, but FileStream already Closed\n}\n\n// Finally, somewhere else:\nfs.Close();\n</code></pre>\n\n<p>The \"relevant\" MSDN articles I have found always show this as two separate steps: this question is about doing the read-then-write operation of <em>Text</em> in a Line-oriented manner <em>without</em> opening the file twice.</p>\n\n<p>The file is opened as </p>\n\n<pre><code>File.Open(filename, FileMode.OpenOrCreate, FileAccess.ReadWrite)\n</code></pre>\n\n<p>and the underlying stream will always be seek-able and write-able.</p>\n"}, {"tags": ["c#", "c++", "dll", "pinvoke", "loadlibrary"], "comments": [{"owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "edited": false, "score": 2, "creation_date": 1424898093, "post_id": 28728891, "comment_id": 45745232, "body": "It&#39;s pretty certain that freeing the library twice is why it fails on subsequent reload. Why do you feel you need to free it twice?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1424899434, "post_id": 28728891, "comment_id": 45745944, "body": "That behaviour cannot readily be re-produced. So until you can show us how to reproduce this, there&#39;s nothing to answer."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1424901162, "post_id": 28728891, "comment_id": 45746939, "body": "@DavidHeffernan You&#39;re right. I should think about how to provide information to be able to reproduce this behavior."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1424901821, "post_id": 28728891, "comment_id": 45747266, "body": "My psychic debugger says that you forgot to post your [DllImport] declaration that <i>also</i> uses this DLL.  You cannot do it both ways."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1424957527, "post_id": 28728891, "comment_id": 45770201, "body": "@HansPassant Right, I added now."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1424958235, "post_id": 28728891, "comment_id": 45770660, "body": "You still cannot do it both ways."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1424961432, "post_id": 28728891, "comment_id": 45772866, "body": "@HansPassant I didn&#39;t understand what you meant. Can you explain."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1424961562, "post_id": 28728891, "comment_id": 45772964, "body": "Not until you explain why you think you need to do this.  Up until now it looks completely pointless to use LoadLibrary."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1424961795, "post_id": 28728891, "comment_id": 45773114, "body": "@HansPassant I was using <code>LoadLibrary</code> to be able to use <code>SetDllDirectory</code>, but I think you mean it is a better idea to use <a href=\"http://stackoverflow.com/a/11418341/3405291\">this</a> procedure. Right?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1424961914, "post_id": 28728891, "comment_id": 45773195, "body": "Hmm, hardly.  But given how confused you are about SetDllDirectory(), you&#39;ll certainly have better luck with that."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1424962035, "post_id": 28728891, "comment_id": 45773270, "body": "@HansPassant I&#39;m going to test with <a href=\"http://stackoverflow.com/a/11418341/3405291\">that</a> procedure."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1424962152, "post_id": 28728891, "comment_id": 45773353, "body": "@HansPassant btw, please let me know if I&#39;m not aware of any better procedure to use instead of <code>SetDllDirectory</code>."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1424962406, "post_id": 28728891, "comment_id": 45773532, "body": "SetDllDirectory is fine. You have to stop calling LoadLibrary. Then it&#39;s all good. Or follow the rules and call FreeLibrary as many times as you called LoadLibrary."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "edited": false, "score": 0, "creation_date": 1427204283, "post_id": 28728891, "comment_id": 46674192, "body": "Down-vote is not fair!"}], "answers": [{"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1424899490, "post_id": 28729523, "comment_id": 45745980, "body": "I think that the asker knows this but can&#39;t understand why the number of calls to <code>LoadLibrary</code> doesn&#39;t match the number made to <code>FreeLibrary</code>. Do you know why?"}], "tags": [], "owner": {"reputation": 91523, "user_id": 251738, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b01b33120fefaad052b4a6864cbc7517?s=128&d=identicon&r=PG", "display_name": "Mark B", "link": "https://stackoverflow.com/users/251738/mark-b"}, "is_accepted": false, "score": -1, "last_activity_date": 1424898229, "creation_date": 1424898229, "answer_id": 28729523, "question_id": 28728891, "link": "https://stackoverflow.com/questions/28728891/have-to-do-freelibrary-2-times-although-i-have-done-loadlibrary-only-1-time-als/28729523#28729523", "title": "Have to do FreeLibrary 2 times although I have done LoadLibrary only 1 time. Also, after unloading DLL, when trying to load it again, error happens", "body": "<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683152%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms683152%28v=vs.85%29.aspx</a> (the first google hit) <code>If the function succeeds, the return value is nonzero.</code> Your unload loop basically says \"as long as freeing the library worked, free it again, until the unload fails\".</p>\n"}, {"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1424899515, "post_id": 28729559, "comment_id": 45745999, "body": "The question is asking why that second call succeeds. Can you explain why that happens?"}, {"owner": {"reputation": 219, "user_id": 3469133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f7a2b26f98e2cd51e113a53e787b37?s=128&d=identicon&r=PG&f=1", "display_name": "rgoble", "link": "https://stackoverflow.com/users/3469133/rgoble"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1424922492, "post_id": 28729559, "comment_id": 45753560, "body": "The second call doesn&#39;t succeed, it fails. The docs clearly state that it returns 0 if there is an error, which is why it exits the loop after the second call."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1424934108, "post_id": 28729559, "comment_id": 45756943, "body": "The second call succeeds which is why it enters the loop body a second time"}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "edited": false, "score": 0, "creation_date": 1424959520, "post_id": 28729559, "comment_id": 45771524, "body": "@rgoble I implemented your procedure with <code>GetModuleHandle</code> and behavior is the same: I load DLL 1 time, and <code>int_FreeLibrary_counter++</code> shows that it has to be unloaded 2 times."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "edited": false, "score": 1, "creation_date": 1424962288, "post_id": 28729559, "comment_id": 45773454, "body": "@user Why did you think anything would change. rgoble hasn&#39;t attempted to explain where the extra ref count comes from."}, {"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1424962504, "post_id": 28729559, "comment_id": 45773609, "body": "@DavidHeffernan You&#39;re right. Code of rgoble was basically doing the same thing, no change expected."}, {"owner": {"reputation": 219, "user_id": 3469133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f7a2b26f98e2cd51e113a53e787b37?s=128&d=identicon&r=PG&f=1", "display_name": "rgoble", "link": "https://stackoverflow.com/users/3469133/rgoble"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1424966982, "post_id": 28729559, "comment_id": 45776720, "body": "@DavidHeffernan You were correct that it was unloading it twice. I was mistaken and thought FreeLibrary was only being called twice, but it was actually called 3 times."}], "tags": [], "owner": {"reputation": 219, "user_id": 3469133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46f7a2b26f98e2cd51e113a53e787b37?s=128&d=identicon&r=PG&f=1", "display_name": "rgoble", "link": "https://stackoverflow.com/users/3469133/rgoble"}, "is_accepted": false, "score": 0, "last_activity_date": 1424923891, "last_edit_date": 1424923891, "creation_date": 1424898333, "answer_id": 28729559, "question_id": 28728891, "link": "https://stackoverflow.com/questions/28728891/have-to-do-freelibrary-2-times-although-i-have-done-loadlibrary-only-1-time-als/28729559#28729559", "title": "Have to do FreeLibrary 2 times although I have done LoadLibrary only 1 time. Also, after unloading DLL, when trying to load it again, error happens", "body": "<p>If you only call LoadLibrary once then you only need to call FreeLibrary once as well. Calling it a second time is moving into undefined behavior.</p>\n\n<p>If you look at the MSDN docs <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683152%28v=vs.85%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms683152%28v=vs.85%29.aspx</a> the function returns a non zero value if it succeeds, or 0 if there is an error.</p>\n\n<p>If you want to be sure that its unloaded then you can call GetModuleHandle on it after the call to FreeLibrary and it should return null.\n<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms683199(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms683199(v=vs.85).aspx</a></p>\n\n<p>Updated your invoke method class to include:</p>\n\n<pre><code>[DllImport(\"kernel32.dll\", CharSet=CharSet.Auto, SetLastError=true)]\npublic static extern IntPtr GetModuleHandle(string lpModuleName);\n</code></pre>\n\n<p>Then change your button5 click handler to the following:</p>\n\n<pre><code>private void button5_Click(object sender, EventArgs e)\n{\n    try\n    {\n        int freeCount = 0;\n        while(Call_DLL.GetModuleHandle(\"DLL.dll\") != System.IntPtr.Zero)\n        {\n             Call_DLL.FreeLibrary(SystemIntPtr_handle_of_DLL);\n             freeCount++;\n        }\n\n        MessageBox.Show(\"DLL unloaded. You will have to load it again. (Unloaded\" + int_FreeLibrary_counter + \" times)\");\n     }\n     catch(Exception Exception_Object)\n     {\n        MessageBox.Show(Exception_Object.Message);\n     }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "edited": false, "score": 0, "creation_date": 1424966779, "post_id": 28745693, "comment_id": 45776580, "body": "In a comment of <a href=\"http://stackoverflow.com/a/11418341/3405291\">this</a> post, it is mentioned that <i>Path set via SetDllDirectory function will not be used when you&#39;re loading dlls via .NET interop (DllImport)</i>. My observation implies that that comment looks misleading."}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": true, "score": 5, "last_activity_date": 1424962801, "creation_date": 1424962801, "answer_id": 28745693, "question_id": 28728891, "link": "https://stackoverflow.com/questions/28728891/have-to-do-freelibrary-2-times-although-i-have-done-loadlibrary-only-1-time-als/28745693#28745693", "title": "Have to do FreeLibrary 2 times although I have done LoadLibrary only 1 time. Also, after unloading DLL, when trying to load it again, error happens", "body": "<p>The update to your question provides enough information to explain the behaviour.</p>\n\n<ol>\n<li>You call <code>LoadLibrary</code> to load your DLL which accounts for one of the references.</li>\n<li>You call <code>DllImport</code> p/invoke functions which in turn lead to a call to <code>LoadLibrary</code>. That's the other reference to the library.</li>\n<li>Then when you call <code>FreeLibrary</code>, this succeeds twice since there were two calls to <code>LoadLibrary</code>.</li>\n</ol>\n\n<p>But now you are in trouble because you've gone behind the back of the p/invoke system and it still believes that it owns one of the references to the DLL. A reference that you stole from it with your second call to <code>FreeLibrary</code>.</p>\n\n<p>I guess that the information you are missing is how the <code>DllImport</code> p/invokes bind to the function. You are hoping that they will obtain a module handle by calling <code>GetModuleHandle</code>. They don't. They call <code>LoadLibrary</code>. They do this the first time they are called and the module they load stays loaded until the assembly itself unloads.</p>\n\n<p>What you have to do, above all else, is follow the rules. The rules state that each call to <code>LoadLibrary</code> is to be matched by a call to <code>FreeLibrary</code>. You call <code>LoadLibrary</code> once. So you must call <code>FreeLibrary</code> exactly once also. Stop calling it twice and all is well.</p>\n\n<p>I suspect that you are actually trying to arrange a system whereby you can load and unload DLLs. This prevents you from using p/invoke via <code>DllImport</code>. You'll have to do it all with <code>LoadLibrary</code> and <code>GetProcAddress</code>.</p>\n\n<p>Your usage of <code>SetDllDirectory</code> looks somewhat messed up. What do you expect <code>\".\\\\DLL_Dependencies\\\\\"</code> to be relative to? Supply a full path. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12791987, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCLfePePmnESZwbSTRKkWlv4vEu8Jp6lJwIQ8k6Gw=k-s128", "display_name": "Aironangel", "link": "https://stackoverflow.com/users/12791987/aironangel"}, "is_accepted": false, "score": 0, "last_activity_date": 1583919790, "creation_date": 1583919790, "answer_id": 60633080, "question_id": 28728891, "link": "https://stackoverflow.com/questions/28728891/have-to-do-freelibrary-2-times-although-i-have-done-loadlibrary-only-1-time-als/60633080#60633080", "title": "Have to do FreeLibrary 2 times although I have done LoadLibrary only 1 time. Also, after unloading DLL, when trying to load it again, error happens", "body": "<p>I know that this question come to completion, but working on a similar problem I have found a way to load and unload library dynamically using DllImport and without exceptions.</p>\n\n<p>The approach is based on these stakeholders:<br/>\n<strong>- the DllImport load the library on the first call to a method wrapped.<br/>\n- if a library is alredy loaded on the stack the call to a method will use this instance of the library instead load another one</strong></p>\n\n<p>based on these considerations you can manage your module in this way:</p>\n\n<ol>\n<li>implement your class which wrap the library<br/></li>\n</ol>\n\n<pre><code>    public class MyWrapper\n    {\n        int _libraryHandle = 0;\n\n        [DllImport(\"mylibrary.dll\")]\n        public external static void MyMethod();\n    }\n</code></pre>\n\n<ol start=\"2\">\n<li>in the constructor load the library using LoadLibrary:<br/></li>\n</ol>\n\n<pre><code>    public MyWrapper()\n    {\n        _libraryHandle = LoadLibrary(\"mylibrary.dll\");\n    }\n</code></pre>\n\n<ol start=\"3\">\n<li>in the dispose method unload the library using FreeLibrary:<br/></li>\n</ol>\n\n<pre><code>    public Dispose()\n    {\n        FreeLibrary(_libraryHandle);\n    }\n</code></pre>\n\n<p>in this way everytime you'll instance your wrapper a new occurrence of the library will be loaded on the stack without any exception.</p>\n"}], "owner": {"reputation": 5298, "user_id": 3405291, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6499e84a22df10a3f4fec15a8bd0d06?s=128&d=identicon&r=PG&f=1", "display_name": "user3405291", "link": "https://stackoverflow.com/users/3405291/user3405291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1936, "favorite_count": 0, "accepted_answer_id": 28745693, "answer_count": 4, "score": -1, "last_activity_date": 1583919790, "creation_date": 1424895888, "last_edit_date": 1424958056, "question_id": 28728891, "link": "https://stackoverflow.com/questions/28728891/have-to-do-freelibrary-2-times-although-i-have-done-loadlibrary-only-1-time-als", "title": "Have to do FreeLibrary 2 times although I have done LoadLibrary only 1 time. Also, after unloading DLL, when trying to load it again, error happens", "body": "<p>Have the following C# code for loading and unloading a C++ DLL. </p>\n\n<p>I load DLL only once, but code has to unload DLL 2 times. Also after unloading DLL, when I load it again, and I call DLL's exported function, I get the following error message: </p>\n\n<blockquote>\n  <p>Attempted to read or write protected memory. This is often an indication that other memory is corrupt. </p>\n</blockquote>\n\n<p>DLL depends on other DLLs. </p>\n\n<pre><code>    /// //////////////handle of FDD DLL:\n    System.IntPtr SystemIntPtr_handle_of_DLL=System.IntPtr.Zero;\n\n    private void button4_Click(object sender, EventArgs e)\n    {\n        try\n        {\n            string string_Dependency_path = \".\\\\DLL_Dependencies\\\\\";\n            Call_DLL.SetDllDirectory(string_Dependency_path);\n            SystemIntPtr_handle_of_DLL = Call_DLL.LoadLibrary(\"DLL.dll\");\n            if (SystemIntPtr_handle_of_DLL == System.IntPtr.Zero) { throw new Exception(\"DLL did not load\"); }\n\n        }\n        catch (Exception Exception_Object) { MessageBox.Show(Exception_Object.Message); }\n    }\n\n    private void button5_Click(object sender, EventArgs e)\n    {\n        try\n        {\n            int int_FreeLibrary_counter = 0;\n            while (Call_DLL.FreeLibrary(SystemIntPtr_handle_of_DLL))\n            {\n                int_FreeLibrary_counter++;\n            }\n            MessageBox.Show(\"DLL unloaded. You will have to load it again. (Unloaded\" + int_FreeLibrary_counter + \" times)\");\n        }\n        catch (Exception Exception_Object) { MessageBox.Show(Exception_Object.Message); }\n    }\n</code></pre>\n\n<p>The invoke method: </p>\n\n<pre><code>class Call_DLL\n{\n    [DllImport(\"kernel32.dll\", CharSet = CharSet.Unicode, SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    public static extern bool SetDllDirectory(string string_Dependency_path);\n    [DllImport(\"kernel32.dll\")]\n    public static extern IntPtr LoadLibrary(string string_DLL_name);\n    [DllImport(\"kernel32.dll\", SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    public static extern bool FreeLibrary(IntPtr IntPtr_handle_of_DLL);\n}\n</code></pre>\n\n<h2>EDIT</h2>\n\n<p>I forgot to include the following which call DLL exported functions, after loading DLL and before unloading DLL. It makes sense to think that something else is going on inside these exported functions which is causing strange behavior (i.e. loading 1 time, having to unload 2 times):</p>\n\n<pre><code>    [DllImport(@\"DLL.dll\", EntryPoint = \"getFreq\")]\n    public static extern System.IntPtr getFreq([In, Out, MarshalAs(UnmanagedType.LPStr)] string char_Address, [In, Out, MarshalAs(UnmanagedType.I4)]int int_Num, [In, Out, MarshalAs(UnmanagedType.I4)]int int_Samp);\n    [DllImport(@\"DLL.dll\", EntryPoint = \"setNat\")]\n    public static extern System.IntPtr setNat([In, Out, MarshalAs(UnmanagedType.LPStr)]string char_Address_File_nat);\n    [DllImport(@\"DLL.dll\", EntryPoint = \"getMode\")]\n    public static extern System.IntPtr getMode();\n</code></pre>\n"}, {"tags": ["c#", "class", "asynchronous"], "comments": [{"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 1, "creation_date": 1424896303, "post_id": 28728879, "comment_id": 45744226, "body": "Are you saying that the UI <i>never</i> shows the data, or that the UI does not show the data until after the entire collection is updated?"}], "answers": [{"tags": [], "owner": {"reputation": 8056, "user_id": 1061668, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Vmm1b.png?s=128&g=1", "display_name": "Mikko Viitala", "link": "https://stackoverflow.com/users/1061668/mikko-viitala"}, "is_accepted": true, "score": 0, "last_activity_date": 1424900839, "last_edit_date": 1424900839, "creation_date": 1424899885, "answer_id": 28730008, "question_id": 28728879, "link": "https://stackoverflow.com/questions/28728879/using-dispatcher-to-update-ui-from-class-with-async-methods-in-wpf/28730008#28730008", "title": "using dispatcher to update UI from class with async methods in wpf", "body": "<p>There's few things in this code which makes me \"itchy\" but anyway... </p>\n\n<p>You have <code>public DAL Data</code> property but you are binding to <code>DAL.EstadosPausa</code>. You need to bind to <code>Data.EstadosPausa</code> and that'll solve it. You'll see all binding errors in your debuggers <code>Output</code> window.</p>\n\n<hr>\n\n<p>Here, consider this simplified yet 100% working version of your code base. Now you are fooling around with <code>async/await</code>s, returning <code>Task&lt;bool&gt;</code> and <code>Dispatching</code> work to UI thread for no good reason (that is obvious from your example).</p>\n\n<p><strong>XAML</strong></p>\n\n<pre><code>&lt;Menu Grid.Row=\"1\"&gt;\n    &lt;MenuItem Header=\"Uno\" ItemsSource=\"{Binding Data.EstadosPausa}\"&gt;\n        &lt;MenuItem.ItemContainerStyle&gt;\n            &lt;Style TargetType=\"MenuItem\"&gt;\n                &lt;Setter Property=\"Header\" Value=\"{Binding Estado}\"/&gt;\n                &lt;Setter Property=\"Tag\" Value=\"{Binding}\" /&gt;\n            &lt;/Style&gt;\n        &lt;/MenuItem.ItemContainerStyle&gt;\n    &lt;/MenuItem&gt;\n&lt;/Menu&gt;\n</code></pre>\n\n<p><strong>CodeBehind</strong></p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    private readonly Dal _data = new Dal();\n\n    public MainWindow()\n    {\n        InitializeComponent();\n        DataContext = this;\n\n        _data.GetAgentStatesAsync(); // Fire Task away, no time to wait!!1\n    }\n\n    public Dal Data { get { return _data; } }  \n}\n\npublic class EstadosAgente\n{\n    public string Estado { get; set; }\n}\n\npublic class Dal : INotifyPropertyChanged\n{\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    public Task GetAgentStatesAsync()\n    {\n        return Task.Run(() =&gt;\n            {\n                Thread.Sleep(1000); // I'm a long running operation...\n                var estados = new List&lt;EstadosAgente&gt;\n                    {\n                        new EstadosAgente { Estado = \"Estado 1\" },\n                        new EstadosAgente { Estado = \"Estado 2\" }\n                    };\n                EstadosPausa = new ObservableCollection&lt;EstadosAgente&gt;(estados);\n                OnPropertyChanged(\"EstadosPausa\");\n            });\n    }\n\n    public ObservableCollection&lt;EstadosAgente&gt; EstadosPausa { get; private set; }\n\n    private void OnPropertyChanged(string propertyName)\n    {\n        var handler = PropertyChanged; // &lt;- always assign to local variable!\n        if (handler != null)\n            handler(this, new PropertyChangedEventArgs(propertyName));\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4607464, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nRoM_xfI_rQ/AAAAAAAAAAI/AAAAAAAAADk/gEzAjurA3Gc/photo.jpg?sz=128", "display_name": "Pedro Perquez", "link": "https://stackoverflow.com/users/4607464/pedro-perquez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 28730008, "answer_count": 1, "score": 1, "last_activity_date": 1424900839, "creation_date": 1424895847, "last_edit_date": 1424895993, "question_id": 28728879, "link": "https://stackoverflow.com/questions/28728879/using-dispatcher-to-update-ui-from-class-with-async-methods-in-wpf", "title": "using dispatcher to update UI from class with async methods in wpf", "body": "<p>I've got a class with manage data, and this class has a ObservableCollection which is bind in UI menu. The problem is that the observable collection loads data, but my UI does not show it.</p>\n\n<p>My class is like this</p>\n\n<pre><code>public class DAL : INotifyPropertyChanged\n{\n    public DAL()\n    {\n        this.unity = new UnitOfWork(@\"http://192.168.0.173/vocalcontactapi\");\n    }\n\n    private UnitOfWork unity;\n\n    public event PropertyChangedEventHandler PropertyChanged;\n    private void OnPropertyChanged(string propertyName)\n    {\n        if (this.PropertyChanged != null)\n            this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n    }\n\n    private ObservableCollection&lt;EstadosAgente&gt; estadosPausa = new ObservableCollection&lt;EstadosAgente&gt;();\n    public ObservableCollection&lt;EstadosAgente&gt; EstadosPausa\n    {\n        get { return this.estadosPausa; }\n    }\n\n    public async Task&lt;bool&gt; GetAgentStatesAsync()\n    {\n        await awaitGetAgentStatesTask();\n        OnPropertyChanged(\"EstadosPausa\");\n        return true;\n    }\n\n    private Task awaitGetAgentStatesTask()\n    {\n        //UnitOfWork unity = new UnitOfWork(Properties.Settings.Default.restServer);\n        NameValueCollection parms = new NameValueCollection();\n        parms.Add(\"servicioId\", \"1\");\n        return Task.Run(() =&gt;\n        {\n            try\n            {\n                var estados = unity.EstadosAgente.GetAll(parms).Where(q =&gt; q.habilitado == true).Select(p =&gt; p).ToList();\n                if (estados == null)\n                    return;\n\n                estados.ForEach(x =&gt;\n                {\n                    Application.Current.Dispatcher.Invoke(new Action(() =&gt;\n                    {\n                        this.EstadosPausa.Add(x); //*** I think here is the problem***\n                    }));\n                });\n\n            }\n            catch (Exception ex)\n            {\n                string err = ex.Message;\n            }\n        });\n    }\n\n}\n</code></pre>\n\n<p>And mainWindow I have a Property of class DAL:</p>\n\n<pre><code>private DAL data = new DAL();\npublic DAL Data { get{ return this.data}}\n</code></pre>\n\n<p>In my menu I've got next:</p>\n\n<pre><code>  &lt;Menu Grid.Row=\"1\"&gt;\n            &lt;MenuItem Header=\"uno\" ItemsSource=\"{Binding DAL.EstadosPausa}\" Click=\"DataBoundMenuItem_Click\"&gt;\n                &lt;MenuItem.ItemContainerStyle&gt;\n                    &lt;Style TargetType=\"MenuItem\"&gt;\n                        &lt;Setter Property=\"Header\" Value=\"{Binding estado}\"/&gt;\n                        &lt;Setter Property=\"Tag\" Value=\"{Binding}\" /&gt;\n                    &lt;/Style&gt;\n                &lt;/MenuItem.ItemContainerStyle&gt;\n            &lt;/MenuItem&gt;\n        &lt;/Menu&gt;\n</code></pre>\n\n<p>Obviously, all properties of the loaded data are correct. Any help please?</p>\n"}, {"tags": ["c#", "linq"], "comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 3, "creation_date": 1424896059, "post_id": 28728784, "comment_id": 45744074, "body": "Well, go ahead, do it."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1424896161, "post_id": 28728784, "comment_id": 45744139, "body": "Sounds like a simple iteration of the list would work; just keep track of when the last On you saw was - when you find the matching Off, yield the pair if the time difference is 7 minutes or less."}], "answers": [{"comments": [{"owner": {"reputation": 49678, "user_id": 1149773, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4f82e58a808f8b7964956410a8a436a?s=128&d=identicon&r=PG&f=1", "display_name": "Douglas", "link": "https://stackoverflow.com/users/1149773/douglas"}, "edited": false, "score": 1, "creation_date": 1424897101, "post_id": 28728956, "comment_id": 45744677, "body": "Wouldn&#39;t the filtering take O(n&#178;) time, as opposed to O(n) for a simple sweep?"}, {"owner": {"reputation": 23953, "user_id": 469533, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/CQueM.jpg?s=128&g=1", "display_name": "Aducci", "link": "https://stackoverflow.com/users/469533/aducci"}, "reply_to_user": {"reputation": 49678, "user_id": 1149773, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4f82e58a808f8b7964956410a8a436a?s=128&d=identicon&r=PG&f=1", "display_name": "Douglas", "link": "https://stackoverflow.com/users/1149773/douglas"}, "edited": false, "score": 1, "creation_date": 1424897456, "post_id": 28728956, "comment_id": 45744861, "body": "@Douglas most likely if it is <code>linq-to-objects</code>. However its a whole different story if it is moved to <code>linq-to-entities</code>"}], "tags": [], "owner": {"reputation": 23953, "user_id": 469533, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/CQueM.jpg?s=128&g=1", "display_name": "Aducci", "link": "https://stackoverflow.com/users/469533/aducci"}, "is_accepted": true, "score": 2, "last_activity_date": 1424896511, "last_edit_date": 1424896511, "creation_date": 1424896173, "answer_id": 28728956, "question_id": 28728784, "link": "https://stackoverflow.com/questions/28728784/retrieve-pairs-from-a-list-that-are-within-a-certain-time-of-one-and-another/28728956#28728956", "title": "Retrieve pairs from a list that are within a certain time of one and another", "body": "<p>If you are not planning on using the <code>linq</code> expression against a <code>dataprovider</code> (database) I would recommend using a <code>for</code> loop to iterate the list.</p>\n\n<p>Here is a <code>linq</code> implementation if you are still interested:</p>\n\n<pre><code>var query = from x in list\n            from z in list.Where(y =&gt; y.State == eState.Off)\n                          .Where(y =&gt; y.Time &gt; x.Time)\n                          .Where(y =&gt; y.Time &lt;= x.Time.AddMinutes(7))\n                          .OrderBy(y =&gt; y.Time)\n                          .Take(1)\n            where x.State == eState.On\n            select new\n            {\n                 x, z\n            };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49678, "user_id": 1149773, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f4f82e58a808f8b7964956410a8a436a?s=128&d=identicon&r=PG&f=1", "display_name": "Douglas", "link": "https://stackoverflow.com/users/1149773/douglas"}, "is_accepted": false, "score": 1, "last_activity_date": 1424980516, "last_edit_date": 1424980516, "creation_date": 1424896457, "answer_id": 28729034, "question_id": 28728784, "link": "https://stackoverflow.com/questions/28728784/retrieve-pairs-from-a-list-that-are-within-a-certain-time-of-one-and-another/28729034#28729034", "title": "Retrieve pairs from a list that are within a certain time of one and another", "body": "<pre><code>TestA lastOn = null;\nint lastIndex = -1;\n\nfor (int i = 0; i &lt; tests.Length; i++)\n{\n    switch (test[i].State)\n    {\n        case eState.On:\n            if (lastOn == null)\n            {\n                lastOn = test[i];\n                lastIndex = i;\n            }\n            break;\n\n        case eState.Off:\n            if (lastOn != null)\n            {\n               if (test[i].Time - lastOn.Time &lt; TimeSpan.FromMinutes(7))\n                   Console.WriteLine(lastIndex + \",\" + i);\n               lastOn = null;\n            }\n            break;\n    }       \n}\n</code></pre>\n"}], "owner": {"reputation": 790, "user_id": 3723720, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7250da486b2f693d3b8259c0e39fa3d3?s=128&d=identicon&r=PG&f=1", "display_name": "ashlar64", "link": "https://stackoverflow.com/users/3723720/ashlar64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 28728956, "answer_count": 2, "score": -1, "last_activity_date": 1424980516, "creation_date": 1424895452, "question_id": 28728784, "link": "https://stackoverflow.com/questions/28728784/retrieve-pairs-from-a-list-that-are-within-a-certain-time-of-one-and-another", "title": "Retrieve pairs from a list that are within a certain time of one and another", "body": "<p>I am trying to get groups that have a pair of items in it.</p>\n\n<pre><code>public enum eState\n{\n   On,\n   Off,\n   blah,\n}\n\npublic class TestA\n{\n   public DateTime Time {get; set;}\n   public eState State {get; set;}\n}\n</code></pre>\n\n<p>If I have a list of TestA items.  If one if the item's state is On it will have a following Off.  There could be other items between the On and Off.  I need to get a list of pairs that are within 7 minutes of each other.</p>\n\n<p>For instance if my List looked like:</p>\n\n<pre><code>1)  5/30/2014 8:30  | blah\n2)  5/30/2014 8:32  | On \n3)  5/30/2014 8:33  | blah\n4)  5/30/2014 8:34  | blah\n5)  5/30/2014 8:35  | Off\n6)  5/30/2014 8:36  | blah\n7)  5/30/2014 8:37  | On\n8)  5/30/2014 8:55  | blah\n9)  5/30/2014 8:56  | Off\n10) 5/30/2014 8:57  | On\n11) 5/30/2014 8:58  | Off\n12) 5/30/2014 8:59  | blah\n</code></pre>\n\n<p>It should return these Pairs:\n2,5  and 10,11   both these on and off pairs are within 7 minutes of each other.\nThere will never be a situation where there is a off before a corresponding on.</p>\n"}, {"tags": ["c#", "asp.net", "web-services", "visual-studio-2012", "wsdl"], "answers": [{"tags": [], "owner": {"reputation": 5508, "user_id": 28074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UIiBo.jpg?s=128&g=1", "display_name": "Donnelle", "link": "https://stackoverflow.com/users/28074/donnelle"}, "is_accepted": true, "score": 5, "last_activity_date": 1429739606, "creation_date": 1429739606, "answer_id": 29809587, "question_id": 28728766, "link": "https://stackoverflow.com/questions/28728766/how-do-i-import-a-discomap-file-into-my-project-in-visual-studio-2012/29809587#29809587", "title": "How do I import a .discomap file into my project in Visual Studio 2012?", "body": "<p><img src=\"https://i.stack.imgur.com/i1Yeh.png\" alt=\"Dialogs\"></p>\n\n<p>Right-click the project in the solution explorer, and choose \"Add Service Reference...\".  In that window, click \"Advanced\". In that window, click \"Add Web Reference...\"</p>\n\n<p>That should probably get you there.</p>\n\n<p>If not, read up about using wsdl.exe to generate the discomap.</p>\n"}], "owner": {"reputation": 555, "user_id": 1319657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/tYlyV.jpg?s=128&g=1", "display_name": "Mucida", "link": "https://stackoverflow.com/users/1319657/mucida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3431, "favorite_count": 1, "accepted_answer_id": 29809587, "answer_count": 1, "score": 1, "last_activity_date": 1429739606, "creation_date": 1424895365, "last_edit_date": 1424896633, "question_id": 28728766, "link": "https://stackoverflow.com/questions/28728766/how-do-i-import-a-discomap-file-into-my-project-in-visual-studio-2012", "title": "How do I import a .discomap file into my project in Visual Studio 2012?", "body": "<p>In an old solution, I have a folder called <code>App_WebReferences</code>, it contains another folder called <code>ReportExecution</code>. This contains a file called <code>ReportExection2005.discomap</code> and this file has a symbol of a web service. </p>\n\n<p>And finally inside this file I have a <code>ReportExection2005.wsdl</code>.</p>\n\n<p>I want to do the same thing on the new solution, but I only could import the <code>.wsdl</code> file, not the <code>.discomap</code>. I don't know if it has to be done automatically or I should create that folders by myself. </p>\n\n<p>My <code>using ReportService;</code> is not being recognized by any kind way that I import a web service. I tried using \"Add Web References\", \"Add existing file\". Nothing works</p>\n"}, {"tags": ["c#", "asp.net-mvc", "razor", "umbraco"], "comments": [{"owner": {"reputation": 1754, "user_id": 2001263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46c0ac75b9723f05e2eccb085cc82fb7?s=128&d=identicon&r=PG", "display_name": "Morten OC", "link": "https://stackoverflow.com/users/2001263/morten-oc"}, "edited": false, "score": 0, "creation_date": 1424937373, "post_id": 28728755, "comment_id": 45758244, "body": "Is your template a masterpage or a razor file?"}, {"owner": {"reputation": 11, "user_id": 3289345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecf1654dbc01bb020634fab2d73c5187?s=128&d=identicon&r=PG&f=1", "display_name": "user3289345", "link": "https://stackoverflow.com/users/3289345/user3289345"}, "reply_to_user": {"reputation": 1754, "user_id": 2001263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/46c0ac75b9723f05e2eccb085cc82fb7?s=128&d=identicon&r=PG", "display_name": "Morten OC", "link": "https://stackoverflow.com/users/2001263/morten-oc"}, "edited": false, "score": 0, "creation_date": 1425087021, "post_id": 28728755, "comment_id": 45832156, "body": "masterpage @MortenOC"}], "owner": {"reputation": 11, "user_id": 3289345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecf1654dbc01bb020634fab2d73c5187?s=128&d=identicon&r=PG&f=1", "display_name": "user3289345", "link": "https://stackoverflow.com/users/3289345/user3289345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 782, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424896809, "creation_date": 1424895326, "last_edit_date": 1424896809, "question_id": 28728755, "link": "https://stackoverflow.com/questions/28728755/using-razor-to-point-to-a-rich-text-editor-in-umbraco", "title": "using razor to point to a rich text editor in umbraco", "body": "<p>Hi i am using umbraco and i have created a rich text editor which holds some info i want to show.. now i am not to sure how to point to it using razor.. i want to point to its id but again i am getting confused.</p>\n\n<p>My rich text editor is called 'Terms and conditions' and it is a children of another page.. i have tried to do something like this..</p>\n\n<pre><code>   &lt;umbraco:macro runat=\"server\" language=\"cshtml\"&gt;\n          @inherits umbraco.MacroEngines.DynamicNodeContext             \n          @{ var termsHtml = Model.Children.Where(\"Name == \\\"Terms and Conditions\\\"\"); }                    \n           @if (termsHtml.Count() == 0) { termsHtml = Model.Parent.Children.Where(\"Name == \\\"Terms and Conditions\\\"\"); }                    \n            @if (termsHtml.Count() == 1){    @Html.Raw(@termsHtml.First().GetProperty(\"htmlContent\").Value) }                   \n     &lt;/umbraco:macro&gt;\n</code></pre>\n\n<p>i dont want to do this messy macros i want to know a way in razor i can just point to the children rich text editor id without having to hard code a name in it.. plus this macro does not even work.</p>\n\n<p>Any help would be great..\nThanks</p>\n"}, {"tags": ["javascript", "c#", "sha", "hmacsha1"], "comments": [{"owner": {"reputation": 49639, "user_id": 231716, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f983f7a23d33aa383453583cbf20bf2a?s=128&d=identicon&r=PG", "display_name": "Brian Mains", "link": "https://stackoverflow.com/users/231716/brian-mains"}, "edited": false, "score": 0, "creation_date": 1424895474, "post_id": 28728732, "comment_id": 45743768, "body": "Are you 100% sure encryption key and timestamp are exact?  That&#39;s what often tripped me up in the past....  Also compare values before and after the hash and again before and after the  base 64 conversion to see where the differences may lie."}], "answers": [{"comments": [{"owner": {"reputation": 42796, "user_id": 929902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/7ORhC.jpg?s=128&g=1", "display_name": "Teoman shipahi", "link": "https://stackoverflow.com/users/929902/teoman-shipahi"}, "edited": false, "score": 0, "creation_date": 1424902841, "post_id": 28728940, "comment_id": 45747696, "body": "Simply works great. I wish I would have Javascript equivalent of Guid.Parse(encryptionKey).ToByteArray(); but anyway I will convert it manually for now."}, {"owner": {"reputation": 36615, "user_id": 111266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/441c43192e97e0374d0c18d8c37ebe47?s=128&d=identicon&r=PG", "display_name": "Joe Enos", "link": "https://stackoverflow.com/users/111266/joe-enos"}, "reply_to_user": {"reputation": 42796, "user_id": 929902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/7ORhC.jpg?s=128&g=1", "display_name": "Teoman shipahi", "link": "https://stackoverflow.com/users/929902/teoman-shipahi"}, "edited": false, "score": 0, "creation_date": 1424910893, "post_id": 28728940, "comment_id": 45750746, "body": "CryptoJS might have something that can do it - I didn&#39;t dig too much into their helper libraries."}], "tags": [], "owner": {"reputation": 36615, "user_id": 111266, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/441c43192e97e0374d0c18d8c37ebe47?s=128&d=identicon&r=PG", "display_name": "Joe Enos", "link": "https://stackoverflow.com/users/111266/joe-enos"}, "is_accepted": true, "score": 2, "last_activity_date": 1424897197, "last_edit_date": 1424897197, "creation_date": 1424896110, "answer_id": 28728940, "question_id": 28728732, "link": "https://stackoverflow.com/questions/28728732/create-c-generated-hmac-hash-in-javascript/28728940#28728940", "title": "Create C# generated HMAC hash in Javascript", "body": "<p>Your issue is due to your key. In C#, you're passing in a 16-byte array as the key. In CryptoJS, you're passing in a string which CryptoJS is interpreting as a passphrase, so it's going to generate a totally different key from that.</p>\n\n<p><strong>EDIT</strong>: Here's how to get the correct key in javascript:</p>\n\n<p>If you convert your 16-byte key to Base64, in javascript you can do the following. It will generate a WordArray as the key, and use that key to generate your hash.</p>\n\n<pre><code>var keyBase64 = \"eFY0EiMBZ0UBI0VniRI0Vg==\";\nvar key = CryptoJS.enc.Base64.parse(keyBase64);\nvar hash = CryptoJS.HmacSHA1(\"Hello\", key);\nvar hashInBase64 = CryptoJS.enc.Base64.stringify(hash); \nconsole.log(hashInBase64);\n</code></pre>\n"}], "owner": {"reputation": 42796, "user_id": 929902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/7ORhC.jpg?s=128&g=1", "display_name": "Teoman shipahi", "link": "https://stackoverflow.com/users/929902/teoman-shipahi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 28728940, "answer_count": 1, "score": 3, "last_activity_date": 1424897197, "creation_date": 1424895250, "question_id": 28728732, "link": "https://stackoverflow.com/questions/28728732/create-c-generated-hmac-hash-in-javascript", "title": "Create C# generated HMAC hash in Javascript", "body": "<p>I have C# function below;</p>\n\n<pre><code>private string GetEncyptionData(string encryptionKey)\n    {\n        string hashString = string.Format(\"{{timestamp:{0},client_id:{1}}}\", Timestamp, ClientId);\n        HMAC hmac = HMAC.Create();\n        hmac.Key = Guid.Parse(encryptionKey).ToByteArray();\n        byte[] hash = hmac.ComputeHash(Encoding.UTF8.GetBytes(hashString));\n        string encData = Convert.ToBase64String(hash);\n        return encData;\n    }\n</code></pre>\n\n<p>I am trying to convert this code in Javascript. I found <a href=\"http://code.google.com/p/crypto-js/#SHA-1\" rel=\"nofollow\">this</a> library as helper.</p>\n\n<p>Here is code I am using;</p>\n\n<pre><code> &lt;script&gt;\n            var timestamp = 1424890904;\n            var client_id = \"496ADAA8-36D0-4B65-A9EF-EE4E3659910D\";\n            var EncryptionKey = \"E69B1B7D-8DFD-4DEA-824A-8D43B42BECC5\";\n\n            var message = \"{timestamp:{0},client_id:{1}}\".replace(\"{0}\", timestamp).replace(\"{1}\", client_id);\n\n            var hash = CryptoJS.HmacSHA1(message, EncryptionKey);\n            var hashInBase64 = CryptoJS.enc.Base64.stringify(hash);       \n\n             alert(hashInBase64);\n        &lt;/script&gt;\n</code></pre>\n\n<p>but code above is not generating same output from C# code.\nHow can I achieve it in Javascript?</p>\n"}, {"tags": ["c#", "linq", "many-to-many", "where-clause"], "comments": [{"owner": {"reputation": 91923, "user_id": 41956, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b9da2ca6abf3a1e28fb470f2b3ae2c34?s=128&d=identicon&r=PG", "display_name": "abatishchev", "link": "https://stackoverflow.com/users/41956/abatishchev"}, "edited": false, "score": 0, "creation_date": 1424895646, "post_id": 28728722, "comment_id": 45743864, "body": "LINQ to SQL or Entity Framework?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 2, "creation_date": 1424895659, "post_id": 28728722, "comment_id": 45743872, "body": "<code>This requires the user to be in both DivisionId 1 AND 7</code> No it doesn&#39;t.  It already has the semantics you want.  If any of the divisions match any of the values, the row is returned, which is what you say you want."}, {"owner": {"reputation": 1951, "user_id": 2103759, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/13ed694bd9caf6638ed002d2f2ba1d29?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2103759/andrew"}, "edited": false, "score": 0, "creation_date": 1424896624, "post_id": 28728722, "comment_id": 45744400, "body": "Maybe there is another issue then that I&#39;ll look into, but right only only users who have both divisionIds are appearing."}, {"owner": {"reputation": 3600, "user_id": 913421, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c1d2c3a67345c7af4f2dbcb4697cce65?s=128&d=identicon&r=PG", "display_name": "sinanakyazici", "link": "https://stackoverflow.com/users/913421/sinanakyazici"}, "edited": false, "score": 0, "creation_date": 1424901876, "post_id": 28728722, "comment_id": 45747295, "body": "@Andrew I have edited my answer."}], "owner": {"reputation": 1951, "user_id": 2103759, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/13ed694bd9caf6638ed002d2f2ba1d29?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2103759/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1424974432, "creation_date": 1424895219, "last_edit_date": 1424958885, "question_id": 28728722, "link": "https://stackoverflow.com/questions/28728722/many-to-many-and-where-clause", "title": "Many-To-Many and Where Clause", "body": "<p>I have a many-to-many relationship between <code>Users</code> and <code>Divisions</code>.  I need to be able to get the users based off their divisionId.</p>\n\n<p>I want to write a linq query that would be translated to something like this:</p>\n\n<pre><code>SELECT * FROM Users\nWHERE divisionId IN (1, 7)\n</code></pre>\n\n<p>The linq I tried looks like:</p>\n\n<pre><code>var users = context.Users.Where(u =&gt;\n    u.Divisions.Any(d =&gt;\n        divisionIds.Contains(d.DivisionId)));\n</code></pre>\n\n<p>In the above linq, <code>u.Divisions</code> is type <code>List&lt;Division&gt;</code> and <code>divisionIds</code> is of type array (<code>int[] divisionIds = new int[] { 1, 7 }</code>) (the divisionIds array is dynamic, it won't always be 1 and 7.  This is just an example).</p>\n\n<p>This requires the user to be in both DivisionId 1 <code>AND</code> 7 (I want <code>OR</code>).  Any suggestions on what I should do?</p>\n\n<h2>Update</h2>\n\n<p>This has been solved.  My code above works, there was another issue.</p>\n"}, {"tags": ["c#", "itext", "coordinates", "absolute"], "answers": [{"comments": [{"owner": {"reputation": 1826, "user_id": 4389432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RcLKe.png?s=128&g=1", "display_name": "Paulo Soares", "link": "https://stackoverflow.com/users/4389432/paulo-soares"}, "edited": false, "score": 1, "creation_date": 1424942311, "post_id": 28731762, "comment_id": 45760700, "body": "I know of pirated copies of the ebook but it&#39;s the first time I saw a conversion to html to read online."}, {"owner": {"reputation": 5372, "user_id": 1700890, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae3069bce34ea67aa6ed85035fac697?s=128&d=identicon&r=PG", "display_name": "user1700890", "link": "https://stackoverflow.com/users/1700890/user1700890"}, "edited": false, "score": 0, "creation_date": 1424987120, "post_id": 28731762, "comment_id": 45788511, "body": "Thank you, Bruno! I am sorry for referencing pirating resource. The last line of your code is supposed to be <code>table.WriteSelectedRows(0, -1, 200, 50, cb);</code> is not it?"}], "tags": [], "owner": {"reputation": 70840, "user_id": 1622493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7S0d.jpg?s=128&g=1", "display_name": "Bruno Lowagie", "link": "https://stackoverflow.com/users/1622493/bruno-lowagie"}, "is_accepted": true, "score": 13, "last_activity_date": 1425003941, "last_edit_date": 1425003941, "creation_date": 1424906995, "answer_id": 28731762, "question_id": 28728653, "link": "https://stackoverflow.com/questions/28728653/itextsharp-table-in-absolute-coordinates/28731762#28731762", "title": "iTextSharp - Table in absolute coordinates", "body": "<p>You have several errors in your code.</p>\n\n<p>When you add a table at absolute positions, it is forbidden to use <code>BeginText()</code> and <code>EndText()</code> as that would cause nested text objects. As explained in ISO-32000-1, you can not next <code>BT</code>/<code>ET</code> sequences and that's exactly what will happen if your table contains text. As you can not add a table inside a text object, it also doesn't make sense to use <code>SetFontAndSize()</code>.</p>\n\n<p>This being said: you need to define a width for the table:</p>\n\n<pre><code>PdfContentByte cb = writer.DirectContent;\nPdfPTable table = new PdfPTable(1);\ntable.TotalWidth = 400f;\ntable.AddCell(\"Test\");\ntable.WriteSelectedRows(0, -1, 200, 50, cb);\n</code></pre>\n\n<p>Note that the site you refer too contains an illegal copy of a book published by Manning Publications of which I am the author.</p>\n"}], "owner": {"reputation": 5372, "user_id": 1700890, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae3069bce34ea67aa6ed85035fac697?s=128&d=identicon&r=PG", "display_name": "user1700890", "link": "https://stackoverflow.com/users/1700890/user1700890"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15461, "favorite_count": 1, "accepted_answer_id": 28731762, "answer_count": 1, "score": 5, "last_activity_date": 1598454575, "creation_date": 1424894995, "last_edit_date": 1493928981, "question_id": 28728653, "link": "https://stackoverflow.com/questions/28728653/itextsharp-table-in-absolute-coordinates", "title": "iTextSharp - Table in absolute coordinates", "body": "<p>I am trying to use this <a href=\"http://what-when-how.com/itext-5/adding-a-table-at-an-absolute-position-itext-5/\" rel=\"nofollow noreferrer\">tutorial</a> to position table in absolute coordinates using iTextSharp. Here is my code: </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing iTextSharp;\nusing iTextSharp.text;\nusing iTextSharp.text.pdf;\nusing System.IO;\n\nnamespace iTextSharpQuestion\n{\n    class Program\n{\n    static void Main(string[] args)\n    {\n        System.IO.FileStream fs = new FileStream(@\"C:\\Temp\\\" + \"First PDF document.pdf\", FileMode.Create);\n        Document document = new Document(PageSize.LETTER, 25, 25, 30, 30);\n        document.SetPageSize(iTextSharp.text.PageSize.LETTER.Rotate());\n        PdfWriter writer = PdfWriter.GetInstance(document, fs);\n        document.Open();\n        PdfContentByte cb = writer.DirectContent;\n        BaseFont f_cn = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1252, false);\n        cb.BeginText();\n        cb.SetFontAndSize(f_cn, 9);\n\n        PdfPTable ObjTestTable = TestTable();\n        ObjTestTable.WriteSelectedRows(0, -1, 200, 50, cb);\n\n        cb.EndText();\n        // Close the document\n        document.Close();\n        // Close the writer instance\n        writer.Close();\n        // Always close open filehandles explicity\n        fs.Close();\n    }\n    public static PdfPTable TestTable()\n    {\n        PdfPTable table = new PdfPTable(3);\n        PdfPCell cell = new PdfPCell(new Phrase(\"Header spanning 3 columns\"));\n        cell.Colspan = 3;\n        cell.HorizontalAlignment = 1; //0=Left, 1=Centre, 2=Right\n        table.AddCell(cell);\n        table.AddCell(\"Col 1 Row 1\");\n        table.AddCell(\"Col 2 Row 1\");\n        table.AddCell(\"Col 3 Row 1\");\n        table.AddCell(\"Col 1 Row 2\");\n        table.AddCell(\"Col 2 Row 2\");\n        table.AddCell(\"Col 3 Row 2\");\n        return table;\n\n    }\n\n}\n}\n</code></pre>\n\n<p>The following line generates error message</p>\n\n<pre><code>ObjTestTable.WriteSelectedRows(0, -1, 200, 50, cb);\n</code></pre>\n\n<p>The error message is </p>\n\n<blockquote>\n  <p>The table width must be greater than zero.</p>\n</blockquote>\n\n<p>Tutorial suggests to use width zero. What am I doing wrong?</p>\n"}, {"tags": ["c#", "windows-runtime", "system.reactive"], "answers": [{"tags": [], "owner": {"reputation": 3366, "user_id": 1235520, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/81405f60e6922b4de689e25ebcd47a7f?s=128&d=identicon&r=PG&f=1", "display_name": "fex", "link": "https://stackoverflow.com/users/1235520/fex"}, "is_accepted": false, "score": 0, "last_activity_date": 1424896725, "last_edit_date": 1424896725, "creation_date": 1424895550, "answer_id": 28728807, "question_id": 28728646, "link": "https://stackoverflow.com/questions/28728646/rx-on-winrt-dispatch-on-ui-thread/28728807#28728807", "title": "Rx on WinRT - dispatch on UI thread", "body": "<p>Not sure if that helps you - but if you buffer your events then you can use <code>Scheduler</code> (and dispatch to UI thread):</p>\n\n<pre><code>var uiScheduler = new SynchronizationContextScheduler(SynchronizationContext.Current);\nyourObservable.Buffer(SomeTimeSpan, uiScheduler).Subscribe(..)\n</code></pre>\n\n<p>By the way - if you decide to buffer your observables - be sure that you use same <code>Scheduler</code> across different <code>Observables</code> (for performance reason)</p>\n"}, {"comments": [{"owner": {"reputation": 80, "user_id": 3023074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593a9acc6ac8ff601e4b5ea8b34e2d91?s=128&d=identicon&r=PG&f=1", "display_name": "cheneryc", "link": "https://stackoverflow.com/users/3023074/cheneryc"}, "edited": false, "score": 0, "creation_date": 1424899296, "post_id": 28729008, "comment_id": 45745867, "body": "Installing Rx-WindowStoreApp gave me the ObserveOnDispatcher method which fixed the threading issue. I had installed Rx-WinRT rather than Rx-WindowStoreApp. Rx-WindowStoreApp appears to include everything in Rx-WinRT and also has the System.Reactive.Windows.Threading assembly that contains the dispatcher functionality."}, {"owner": {"reputation": 27123, "user_id": 87427, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lf6af.jpg?s=128&g=1", "display_name": "James World", "link": "https://stackoverflow.com/users/87427/james-world"}, "reply_to_user": {"reputation": 80, "user_id": 3023074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593a9acc6ac8ff601e4b5ea8b34e2d91?s=128&d=identicon&r=PG&f=1", "display_name": "cheneryc", "link": "https://stackoverflow.com/users/3023074/cheneryc"}, "edited": false, "score": 0, "creation_date": 1424899747, "post_id": 28729008, "comment_id": 45746138, "body": "Yeah. <code>Rx-WindowStoreApps</code> <i>note the spelling</i> - singular <code>Window</code>, plural <code>Apps</code>, is a pretty undiscoverable name, seeing as Microsoft has never been into single Window installations!!!"}], "tags": [], "owner": {"reputation": 27123, "user_id": 87427, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lf6af.jpg?s=128&g=1", "display_name": "James World", "link": "https://stackoverflow.com/users/87427/james-world"}, "is_accepted": true, "score": 4, "last_activity_date": 1424898116, "last_edit_date": 1424898116, "creation_date": 1424896367, "answer_id": 28729008, "question_id": 28728646, "link": "https://stackoverflow.com/questions/28728646/rx-on-winrt-dispatch-on-ui-thread/28729008#28729008", "title": "Rx on WinRT - dispatch on UI thread", "body": "<p>You should be able to get <code>CoreDispatcherScheduler</code> and <code>ObserveOnDispatcher</code> by including nuget package <code>rx-windowstoreapps</code>.</p>\n\n<p>From there you can do:</p>\n\n<pre><code>service = Observable.FromAsync(fn)\n                    .ObserveOnDispatcher()\n                    .Subscribe(videoColl =&gt;\n</code></pre>\n\n<p>if you are calling from the UI thread - I would suggest that is where you should create Observables destined to update the UI thread anyway.</p>\n\n<p>If you can't do that you will need to get and squirrel away a reference to the Dispatcher and use <code>.ObserveOn(dispatcher)</code> instead (where <code>dispatcher</code> is said reference, obtained from the <code>Dispatcher</code> property of the page or window etc.</p>\n"}], "owner": {"reputation": 80, "user_id": 3023074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593a9acc6ac8ff601e4b5ea8b34e2d91?s=128&d=identicon&r=PG&f=1", "display_name": "cheneryc", "link": "https://stackoverflow.com/users/3023074/cheneryc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 28729008, "answer_count": 2, "score": 3, "last_activity_date": 1424898116, "creation_date": 1424894977, "question_id": 28728646, "link": "https://stackoverflow.com/questions/28728646/rx-on-winrt-dispatch-on-ui-thread", "title": "Rx on WinRT - dispatch on UI thread", "body": "<p>I'm currently just getting started with Rx and finding it very useful so far. However I'm running into issues when creating an observable from an async method and updating the UI with the result. I'm (unsurprisingly) getting RPC_E_WRONG_THREAD errors with the following code:</p>\n\n<pre><code>IDisposable service = null;\n\nservice = Observable.FromAsync(fn).Subscribe(videoColl =&gt;\n{\n    foreach (var video in videoColl.Videos)\n    {\n        // _videos is an ObservableCollection bound to a GridView's ItemsSource property\n        _videos.Add(video.SmallImageUrl);\n    }\n});\n</code></pre>\n\n<p>I've had a look at a few similar answers and they suggest using ObserveOnDispatcher or CoreDispatcherScheduler neither of which appear to be available to me.</p>\n\n<p>I'm creating a Windows 8.1 UAP app and I got the latest version (2.2.5) of Rx via Nuget. I'm wondering if the UI dispatcher functionality is missing from this release?</p>\n"}, {"tags": ["c#", "xml"], "comments": [{"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 2, "creation_date": 1424894828, "post_id": 28728561, "comment_id": 45743405, "body": "Any reason you aren&#39;t using LinqToXML?"}, {"owner": {"reputation": 137, "user_id": 3356801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1169974964/picture?type=large", "display_name": "Onlytito", "link": "https://stackoverflow.com/users/3356801/onlytito"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1424894904, "post_id": 28728561, "comment_id": 45743447, "body": "Its a project, to learn XML."}, {"owner": {"reputation": 3393, "user_id": 4434850, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8-OgJJG3Uqs/AAAAAAAAAAI/AAAAAAAAAB4/NKQCgziF6BI/photo.jpg?sz=128", "display_name": "Nadia Chibrikova", "link": "https://stackoverflow.com/users/4434850/nadia-chibrikova"}, "edited": false, "score": 0, "creation_date": 1424894926, "post_id": 28728561, "comment_id": 45743459, "body": "what&#39;s <code>xmlnode</code>? why do you need <code>xmlnode.Count - 1</code> in <code>i &lt; xmlnode.Count - 1</code>? That is it looks like you deliberately skip the last node."}, {"owner": {"reputation": 6250, "user_id": 2359643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05ea83110037dc15d8d22e722fd184f4?s=128&d=identicon&r=PG", "display_name": "JNYRanger", "link": "https://stackoverflow.com/users/2359643/jnyranger"}, "edited": false, "score": 1, "creation_date": 1424895632, "post_id": 28728561, "comment_id": 45743857, "body": "This has nothing to do with your question, but I can see in your commented out code that you&#39;re introducing variables directly into a SQL statement...NEVER DO THAT!  Use parameters in your sql instead. <a href=\"http://www.devart.com/dotconnect/sqlite/docs/Devart.Data.SQLite~Devart.Data.SQLite.SQLiteCommand~Parameters.html\" rel=\"nofollow noreferrer\">Example in SQLite</a>"}, {"owner": {"reputation": 137, "user_id": 3356801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1169974964/picture?type=large", "display_name": "Onlytito", "link": "https://stackoverflow.com/users/3356801/onlytito"}, "reply_to_user": {"reputation": 3393, "user_id": 4434850, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8-OgJJG3Uqs/AAAAAAAAAAI/AAAAAAAAAB4/NKQCgziF6BI/photo.jpg?sz=128", "display_name": "Nadia Chibrikova", "link": "https://stackoverflow.com/users/4434850/nadia-chibrikova"}, "edited": false, "score": 0, "creation_date": 1424897034, "post_id": 28728561, "comment_id": 45744631, "body": "@nadia {xmlnode} is an xmlnodelist within an xml tag.  xmlnode.count counts the nodes within a parent tag -1 since it starts at 0. I dont think that xmlnode.count is the problem because it displays all my attributes for my parent tag correctly. its the nested for loop that skips the last attibute within the nested tag set, which is xmlnode."}, {"owner": {"reputation": 137, "user_id": 3356801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1169974964/picture?type=large", "display_name": "Onlytito", "link": "https://stackoverflow.com/users/3356801/onlytito"}, "reply_to_user": {"reputation": 6250, "user_id": 2359643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05ea83110037dc15d8d22e722fd184f4?s=128&d=identicon&r=PG", "display_name": "JNYRanger", "link": "https://stackoverflow.com/users/2359643/jnyranger"}, "edited": false, "score": 1, "creation_date": 1424897059, "post_id": 28728561, "comment_id": 45744650, "body": "@JNYRanger good tip. thanks."}, {"owner": {"reputation": 3393, "user_id": 4434850, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8-OgJJG3Uqs/AAAAAAAAAAI/AAAAAAAAAB4/NKQCgziF6BI/photo.jpg?sz=128", "display_name": "Nadia Chibrikova", "link": "https://stackoverflow.com/users/4434850/nadia-chibrikova"}, "edited": false, "score": 2, "creation_date": 1424897257, "post_id": 28728561, "comment_id": 45744757, "body": "just try <code>i &lt; xmlnode.Count</code> without -1, as it is you loop from 0 to 2( i&lt;4-1 =&gt; i&lt;3)"}], "answers": [{"tags": [], "owner": {"reputation": 6250, "user_id": 2359643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05ea83110037dc15d8d22e722fd184f4?s=128&d=identicon&r=PG", "display_name": "JNYRanger", "link": "https://stackoverflow.com/users/2359643/jnyranger"}, "is_accepted": false, "score": 3, "last_activity_date": 1424914196, "last_edit_date": 1424914196, "creation_date": 1424895132, "answer_id": 28728695, "question_id": 28728561, "link": "https://stackoverflow.com/questions/28728561/c-application-will-not-display-last-attribute-value-in-xml-document/28728695#28728695", "title": "C# application will not display last Attribute Value in XML Document", "body": "<p>This probably isn't the answer you are looking for, but in Linq-to-XML this is very easy.  Lets assume you loaded your xml into a <code>XDocument</code> named \"xml\".</p>\n\n<pre><code>for(XNode node in xml.Element(\"purpose\").Elements(\"intendedUse\"))\n{\n    //sets the value of the id attribute to str2\n    str2 = node.Attribute(\"id\").Value;\n}\n</code></pre>\n\n<p>With the above solution you can have a possible <code>NullReferenceException</code> if the no id attribute exists, or there's no \"purpose\" nodes, but the concept should be pretty clear from my example.</p>\n\n<p>Obviously you can do whatever you want in there, but LINQ-to-XML is far easier to use than <code>XmlDocument</code> especially if you're trying to learn how to do XML parsing.</p>\n\n<p>Here's a link to get you started:  <a href=\"https://msdn.microsoft.com/en-us/library/bb387098.aspx\" rel=\"nofollow\">Linq-to-XML MSDN</a></p>\n"}, {"tags": [], "owner": {"reputation": 137, "user_id": 3356801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1169974964/picture?type=large", "display_name": "Onlytito", "link": "https://stackoverflow.com/users/3356801/onlytito"}, "is_accepted": true, "score": 1, "last_activity_date": 1424915200, "last_edit_date": 1424915200, "creation_date": 1424897297, "answer_id": 28729267, "question_id": 28728561, "link": "https://stackoverflow.com/questions/28728561/c-application-will-not-display-last-attribute-value-in-xml-document/28729267#28729267", "title": "C# application will not display last Attribute Value in XML Document", "body": "<p>Figured it out. I was supposed to remove the <code>-1</code> in </p>\n\n<pre><code>count &lt; xmlnode[num].FirstChild.NextSibling.ChildNodes.Count - 1`\n</code></pre>\n\n<p>Didnt notice until @Nadia brought it up for my first for loop, and I didn't notice that I added the <code>-1</code> by habit. </p>\n"}], "owner": {"reputation": 137, "user_id": 3356801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1169974964/picture?type=large", "display_name": "Onlytito", "link": "https://stackoverflow.com/users/3356801/onlytito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 28729267, "answer_count": 2, "score": 1, "last_activity_date": 1424915200, "creation_date": 1424894665, "last_edit_date": 1424896764, "question_id": 28728561, "link": "https://stackoverflow.com/questions/28728561/c-application-will-not-display-last-attribute-value-in-xml-document", "title": "C# application will not display last Attribute Value in XML Document", "body": "<p>A C# project I am working on will not display/insert the last value within an XML tag. \nFor Example my application iterates through this tag and will get 1, 2 3 but not 4. It does that with every iteration. </p>\n\n<pre><code>&lt;purpose&gt;\n &lt;intendedUse id=\"1\"/&gt;\n &lt;intendedUse id=\"2\"/&gt;\n &lt;intendedUse id=\"3\"/&gt;\n &lt;intendedUse id=\"4\"/&gt;\n&lt;/purpose&gt;\n</code></pre>\n\n<p>I believe it has something to do with the <code>int num</code> declaration. NOTE: I commented my sqlite command so i wont write to the database. I have a messagebox to display what the values will be. </p>\n\n<pre><code> for (i = 0; i &lt; xmlnode.Count - 1; i++ )\n            {\n                str = xmlnode[i].Attributes[0].Value;\n                int num = Int32.Parse(str) - 1;\n                for ( var count = 0; count &lt; xmlnode[num].FirstChild.NextSibling.ChildNodes.Count - 1; count++)\n                {\n                    str2 = xmlnode[num].FirstChild.NextSibling.ChildNodes[count].Attributes[0].Value; \n                    MessageBox.Show(str2);\n                }\n\n                //SQLiteCommand cmd = new SQLiteCommand(connection);\n                //cmd.CommandText = \"INSERT INTO languagePurpose (purposeID, languageID) VALUES ('\" + str2 + \"', '\" + str + \"')\";\n                //SQLiteDataReader dr = cmd.ExecuteReader();\n               // MessageBox.Show(str);\n            }\n</code></pre>\n"}, {"tags": ["c#", "mysql"], "answers": [{"tags": [], "owner": {"reputation": 5291, "user_id": 82709, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/35f3d71c8430bf8fab3e8681c9ce7750?s=128&d=identicon&r=PG", "display_name": "vikasde", "link": "https://stackoverflow.com/users/82709/vikasde"}, "is_accepted": false, "score": 0, "last_activity_date": 1424897356, "creation_date": 1424897356, "answer_id": 28729291, "question_id": 28728558, "link": "https://stackoverflow.com/questions/28728558/mysqlbulkloader-is-not-importing-first-column/28729291#28729291", "title": "MySqlBulkLoader is not importing first column", "body": "<p>I found the issue. The LineTerminator had to be set to \\r\\n. </p>\n"}], "owner": {"reputation": 5291, "user_id": 82709, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/35f3d71c8430bf8fab3e8681c9ce7750?s=128&d=identicon&r=PG", "display_name": "vikasde", "link": "https://stackoverflow.com/users/82709/vikasde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424897356, "creation_date": 1424894660, "question_id": 28728558, "link": "https://stackoverflow.com/questions/28728558/mysqlbulkloader-is-not-importing-first-column", "title": "MySqlBulkLoader is not importing first column", "body": "<p>I have a very simple csv file with two columns that I need to import into MySQl. The table has the same columns with same names. When I run the below code, the first column gets imported as 0 and the second column imports the correct values.</p>\n\n<p>C# Code:</p>\n\n<pre><code>MySqlBulkLoader bl = new MySqlBulkLoader(conn)\n                {\n                    TableName = \"tableName\",\n                    FieldTerminator = \",\",\n                    LineTerminator = \"\\r\",\n                    FileName = fileName,\n                    NumberOfLinesToSkip = 1,\n                    Timeout = 0\n                };\nbl.Load();\n</code></pre>\n\n<p>CSV:</p>\n\n<pre><code>product_id,qty\n35373,155\n35374,169\n</code></pre>\n\n<p>Table Structure:</p>\n\n<pre><code>CREATE TABLE `tableName` (\n `product_id` int(11) NOT NULL,\n `qty` int(11) NOT NULL\n) ENGINE=InnoDB DEFAULT CHARSET=latin1\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "templates", "dotnetnuke"], "comments": [{"owner": {"reputation": 8804, "user_id": 21362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff097b7cc348bebce39ee1c7694d125?s=128&d=identicon&r=PG", "display_name": "Chris Hammond", "link": "https://stackoverflow.com/users/21362/chris-hammond"}, "edited": false, "score": 0, "creation_date": 1424968420, "post_id": 28728541, "comment_id": 45777659, "body": "What is the name of your project and Solution? Do you happen to have underscores in them?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 1254951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5a733dddfbea206566feca533ead9f?s=128&d=identicon&r=PG", "display_name": "Henk", "link": "https://stackoverflow.com/users/1254951/henk"}, "edited": false, "score": 0, "creation_date": 1425247379, "post_id": 28747798, "comment_id": 45873416, "body": "I checked the suggestions but everything seems ok. Luckily I am able to sove it by reinstalling the dotnetnuke site again. The steps I did: delete the website, delete the database and add a new database again, delete t everything under \\websites\\dnndev.me and copy agina"}, {"owner": {"reputation": 9, "user_id": 1254951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5a733dddfbea206566feca533ead9f?s=128&d=identicon&r=PG", "display_name": "Henk", "link": "https://stackoverflow.com/users/1254951/henk"}, "edited": false, "score": 0, "creation_date": 1425248288, "post_id": 28747798, "comment_id": 45873696, "body": "I checked the suggestions but everything seems ok. I can login in the dnn site. Luckily I am able to sove it by reinstalling the dotnetnuke site again. The steps I did: 1. delete the website and create again the website, 2. delete the database and add a new database again, 3. delete  everything under \\websites\\dnndev.me and copy again the files from the install directory,  4. Install dotnetnuke (see youre last video 4 for installing dotnetnuke 7.x). I was happy that the error does not occur when creating a new dotnet module (dal7)."}], "tags": [], "owner": {"reputation": 8804, "user_id": 21362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff097b7cc348bebce39ee1c7694d125?s=128&d=identicon&r=PG", "display_name": "Chris Hammond", "link": "https://stackoverflow.com/users/21362/chris-hammond"}, "is_accepted": false, "score": 0, "last_activity_date": 1424968560, "creation_date": 1424968560, "answer_id": 28747798, "question_id": 28728541, "link": "https://stackoverflow.com/questions/28728541/hresult-e-fail-error-using-christoc-template/28747798#28747798", "title": "hresult e_fail error using christoc template", "body": "<p>I restored the Discussions tab on Codeplex and dug through the posts there.</p>\n\n<p><a href=\"https://christoctemplate.codeplex.com/discussions/355503\" rel=\"nofollow\">https://christoctemplate.codeplex.com/discussions/355503</a></p>\n\n<p>Looks like it is either caused by </p>\n\n<ul>\n<li>Underscore or Dashes in the project/solution name </li>\n<li>Bad configuration in IIS, make sure you don't have a virtualdirectory/application on the desktopmodules or the module folder in IIS.</li>\n</ul>\n"}], "owner": {"reputation": 9, "user_id": 1254951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5a733dddfbea206566feca533ead9f?s=128&d=identicon&r=PG", "display_name": "Henk", "link": "https://stackoverflow.com/users/1254951/henk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424968560, "creation_date": 1424894624, "question_id": 28728541, "link": "https://stackoverflow.com/questions/28728541/hresult-e-fail-error-using-christoc-template", "title": "hresult e_fail error using christoc template", "body": "<p>I have setup a new development environment using</p>\n\n<p>WIN 8.1, VS2013, Telerik controls q3 2014, Dotnetnuke 7.03.04, Json.net 6.08 and latest DNN 7 Project Templates V4 for VS2013.</p>\n\n<p>When I create a new DAL2 project and open view.ascx in design mode then I get \"hresult e_fail...\" error for the rptItemList control. I am also not able to put a control in design mode. If I write the control in the source and go back to design mode then I get the same error for the created control..</p>\n\n<p>If I create a new ASP.NET web application project I have NO problems adding controls and no errors.</p>\n\n<p>Please help.</p>\n\n<p>Kind regards,</p>\n\n<p>Henk</p>\n"}, {"tags": ["c#", "web-services", "wcf", "authentication", "iis"], "comments": [{"owner": {"reputation": 233, "user_id": 4035921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57cec0585de63772d3b4e65003e0c61?s=128&d=identicon&r=PG&f=1", "display_name": "TechneWare", "link": "https://stackoverflow.com/users/4035921/techneware"}, "edited": false, "score": 1, "creation_date": 1424895234, "post_id": 28728525, "comment_id": 45743625, "body": "It looks like your using active directory authentication inside your network and of course the clients outside the network are not domain members so NTLM won&#39;t work there. See: <a href=\"https://msdn.microsoft.com/en-us/library/ms734769.aspx\" rel=\"nofollow noreferrer\">Securing Services</a> for more information on how to secure WCF services."}, {"owner": {"reputation": 2032, "user_id": 218441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BKhf0.jpg?s=128&g=1", "display_name": "Jocke", "link": "https://stackoverflow.com/users/218441/jocke"}, "edited": false, "score": 0, "creation_date": 1424898430, "post_id": 28728525, "comment_id": 45745419, "body": "how does the web.config file for the service look like?"}, {"owner": {"reputation": 2032, "user_id": 218441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BKhf0.jpg?s=128&g=1", "display_name": "Jocke", "link": "https://stackoverflow.com/users/218441/jocke"}, "edited": false, "score": 0, "creation_date": 1424898865, "post_id": 28728525, "comment_id": 45745648, "body": "perhaps this could help you out <a href=\"http://www.codeproject.com/Articles/36289/steps-to-enable-windows-authentication-on-WCF-Ba\" rel=\"nofollow noreferrer\">codeproject.com/Articles/36289/&hellip;</a>"}, {"owner": {"reputation": 91, "user_id": 2611414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9c437a8eb6bf905b73ecd3b1c32a197?s=128&d=identicon&r=PG", "display_name": "Stoic Developer", "link": "https://stackoverflow.com/users/2611414/stoic-developer"}, "reply_to_user": {"reputation": 2032, "user_id": 218441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BKhf0.jpg?s=128&g=1", "display_name": "Jocke", "link": "https://stackoverflow.com/users/218441/jocke"}, "edited": false, "score": 0, "creation_date": 1424899148, "post_id": 28728525, "comment_id": 45745795, "body": "@Jocke See update section Web.Config of WCF Service on IIS"}, {"owner": {"reputation": 2032, "user_id": 218441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BKhf0.jpg?s=128&g=1", "display_name": "Jocke", "link": "https://stackoverflow.com/users/218441/jocke"}, "edited": false, "score": 0, "creation_date": 1424899457, "post_id": 28728525, "comment_id": 45745958, "body": "Is NTLM added as a provider for IIS: <a href=\"http://debugmode.net/2009/12/18/ntlm-and-windows-authentication-on-wcf-service/\" rel=\"nofollow noreferrer\">debugmode.net/2009/12/18/&hellip;</a>"}, {"owner": {"reputation": 91, "user_id": 2611414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9c437a8eb6bf905b73ecd3b1c32a197?s=128&d=identicon&r=PG", "display_name": "Stoic Developer", "link": "https://stackoverflow.com/users/2611414/stoic-developer"}, "reply_to_user": {"reputation": 2032, "user_id": 218441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BKhf0.jpg?s=128&g=1", "display_name": "Jocke", "link": "https://stackoverflow.com/users/218441/jocke"}, "edited": false, "score": 0, "creation_date": 1424899471, "post_id": 28728525, "comment_id": 45745965, "body": "@Jocke, I used that tutorial initially when setting up the service.  But it is only for internal since it uses Windows authentication which wont work outside the network so far as I am aware."}, {"owner": {"reputation": 91, "user_id": 2611414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9c437a8eb6bf905b73ecd3b1c32a197?s=128&d=identicon&r=PG", "display_name": "Stoic Developer", "link": "https://stackoverflow.com/users/2611414/stoic-developer"}, "reply_to_user": {"reputation": 2032, "user_id": 218441, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BKhf0.jpg?s=128&g=1", "display_name": "Jocke", "link": "https://stackoverflow.com/users/218441/jocke"}, "edited": false, "score": 0, "creation_date": 1424899555, "post_id": 28728525, "comment_id": 45746027, "body": "@Jocke, Yes.  Ntlm is set up as a provider for IIS.  It is currently set as the priority Provider before Negotiate."}], "owner": {"reputation": 91, "user_id": 2611414, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9c437a8eb6bf905b73ecd3b1c32a197?s=128&d=identicon&r=PG", "display_name": "Stoic Developer", "link": "https://stackoverflow.com/users/2611414/stoic-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1424899075, "creation_date": 1424894579, "last_edit_date": 1424899075, "question_id": 28728525, "link": "https://stackoverflow.com/questions/28728525/wcf-service-authenticated-outside-network", "title": "WCF service authenticated outside network", "body": "<p>I have a WCF Service posted to IIS so that it can be accessed publicly with the right credentials.  For the past few days I have been trying to get the service to work outside of my company's network.  But nothing I do has worked.</p>\n\n<p>Inside my company network, I can call the service and work with it without issues.  I can locate the service externally through the browser.  When I try to use the service in code outside the network, I get error messages:\n<code>The HTTP request is unauthorized with client authentication scheme 'Ntlm'. The authentication header received from the server was 'NTLM'.</code></p>\n\n<p>That error was after I reordered the authentication providers to Ntlm and then Negotiate.</p>\n\n<p>What am I missing so that clients outside the company network can access the service?</p>\n\n<p>App.Config of Test in Console Application</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n&lt;startup&gt; \n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.5\" /&gt;\n&lt;/startup&gt;\n&lt;system.serviceModel&gt;\n    &lt;bindings&gt;\n        &lt;basicHttpBinding&gt;\n            &lt;binding name=\"BasicHttpEndpoint\"&gt;\n                &lt;security mode=\"Transport\"&gt;\n                    &lt;transport clientCredentialType=\"Ntlm\" /&gt;\n                &lt;/security&gt;\n            &lt;/binding&gt;\n        &lt;/basicHttpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;client&gt;\n        &lt;endpoint address=\"https://&lt;iis server&gt;/services/360Review/ReviewSvc.svc\"\n            binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpEndpoint\"\n            contract=\"WebSTGReviewReference.IReviewSvc\" name=\"BasicHttpEndpoint\" /&gt;\n    &lt;/client&gt;\n&lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Test Program in Console Application</p>\n\n<pre><code>enter code here\nEndpointAddress endpoint = new EndpointAddress(\"https://&lt;BizTalk server&gt;/&lt;service folder&gt;/ReviewSvc.svc\");\nBasicHttpsBinding binding = new BasicHttpsBinding();\nbinding.Security.Mode = BasicHttpsSecurityMode.Transport;\nbinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Ntlm;\n\ntry\n{\n    ServiceReference.ReviewSvcClient client = new ServiceReference.ReviewSvcClient(binding, endpoint);\n    ServiceReference.ActivityType act = client.GetActivityTypes()[0];\n    Console.WriteLine(\"Test 1 Complete\");\n}\ncatch (Exception e)\n{\n    Console.WriteLine(e.Message);\n    if (e.InnerException != null)\n        Console.WriteLine(e.InnerException.Message);\n}\n</code></pre>\n\n<p>Web.Config of WCF Service on IIS</p>\n\n<pre><code>&lt;configuration&gt;\n\n&lt;appSettings&gt;\n  &lt;add key=\"aspnet:UseTaskFriendlySynchronizationContext\" value=\"true\" /&gt;\n&lt;/appSettings&gt;\n&lt;system.web&gt;\n  &lt;compilation targetFramework=\"4.5\" /&gt;\n  &lt;httpRuntime targetFramework=\"4.5\"/&gt;\n  &lt;authentication mode=\"Windows\"&gt;&lt;/authentication&gt;\n  &lt;customErrors mode=\"Off\"/&gt;\n&lt;/system.web&gt;\n&lt;system.serviceModel&gt;\n  &lt;client&gt;\n    &lt;endpoint address=\"https://&lt;BizTalk Server&gt;/&lt;service folder&gt;/ReviewSvc.svc\"\n    binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpsBinding_IReviewSvc\"\n    contract=\"BTReviewSvc.IReviewSvc\" name=\"BasicHttpsBinding_IReviewSvc\" /&gt;\n  &lt;/client&gt;\n  &lt;bindings&gt;\n    &lt;basicHttpBinding&gt;\n      &lt;binding name=\"BasicBinding\"&gt;\n        &lt;security mode=\"TransportCredentialOnly\"&gt;\n          &lt;transport clientCredentialType=\"Ntlm\" /&gt;\n        &lt;/security&gt;\n      &lt;/binding&gt;\n      &lt;binding name=\"SSLBinding\"&gt;\n        &lt;security mode=\"Transport\"&gt;\n          &lt;transport clientCredentialType=\"Ntlm\" /&gt;\n        &lt;/security&gt;\n      &lt;/binding&gt;\n      &lt;binding name=\"BasicHttpsBinding_IReviewSvc\"&gt;\n        &lt;security mode=\"Transport\"&gt;\n          &lt;transport clientCredentialType=\"Ntlm\"/&gt;\n        &lt;/security&gt;\n      &lt;/binding&gt;\n    &lt;/basicHttpBinding&gt;\n  &lt;/bindings&gt;\n  &lt;services&gt;\n    &lt;service behaviorConfiguration=\"&lt;namespace&gt;.ReviewSvcBehavior\" name=\"&lt;namespace&gt;.ReviewSvc\"&gt;\n      &lt;endpoint address=\"\" binding=\"basicHttpBinding\" bindingConfiguration=\"SSLBinding\" name=\"BasicHttpEndpoint\" contract=\"&lt;namespace&gt;.IReviewSvc\"&gt;&lt;/endpoint&gt;\n    &lt;/service&gt;\n  &lt;/services&gt;\n  &lt;behaviors&gt;\n    &lt;serviceBehaviors&gt;\n       &lt;behavior name=\"&lt;namespace&gt;.ReviewSvcBehavior\"&gt;\n        &lt;!-- To avoid disclosing metadata information, set the values below to false before deployment --&gt;\n        &lt;serviceMetadata httpGetEnabled=\"true\" httpsGetEnabled=\"true\"/&gt;\n        &lt;!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information --&gt;\n        &lt;serviceDebug includeExceptionDetailInFaults=\"true\"/&gt;\n      &lt;/behavior&gt;\n    &lt;/serviceBehaviors&gt;\n  &lt;/behaviors&gt;\n  &lt;protocolMapping&gt;\n      &lt;add binding=\"basicHttpsBinding\" scheme=\"https\" /&gt;\n  &lt;/protocolMapping&gt;    \n  &lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\" multipleSiteBindingsEnabled=\"true\" /&gt;\n&lt;/system.serviceModel&gt;\n&lt;system.webServer&gt;\n  &lt;modules runAllManagedModulesForAllRequests=\"true\"/&gt;\n  &lt;!--\n    To browse web app root directory during debugging, set the value below to true.\n    Set to false before deployment to avoid disclosing web app folder information.\n    --&gt;\n  &lt;directoryBrowse enabled=\"true\"/&gt;\n&lt;/system.webServer&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n"}, {"tags": ["c#", ".net", ".net-3.5"], "comments": [{"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1424894578, "post_id": 28728485, "comment_id": 45743282, "body": "It shouldn&#39;t. Can you provide the name of <i>other</i> files in your question."}, {"owner": {"reputation": 147, "user_id": 768241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7b71e04eac3132597c10b36a80dd35fb?s=128&d=identicon&r=PG", "display_name": "GhostDZ9", "link": "https://stackoverflow.com/users/768241/ghostdz9"}, "reply_to_user": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1424894702, "post_id": 28728485, "comment_id": 45743351, "body": "I know it shouldn&#39;t but it currently is."}, {"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 2, "creation_date": 1424894807, "post_id": 28728485, "comment_id": 45743394, "body": "Clean/Rebuild your solution, This shouldn&#39;t happen."}, {"owner": {"reputation": 147, "user_id": 768241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7b71e04eac3132597c10b36a80dd35fb?s=128&d=identicon&r=PG", "display_name": "GhostDZ9", "link": "https://stackoverflow.com/users/768241/ghostdz9"}, "reply_to_user": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1424896371, "post_id": 28728485, "comment_id": 45744270, "body": "I have done that it still happens."}, {"owner": {"reputation": 147, "user_id": 768241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7b71e04eac3132597c10b36a80dd35fb?s=128&d=identicon&r=PG", "display_name": "GhostDZ9", "link": "https://stackoverflow.com/users/768241/ghostdz9"}, "reply_to_user": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1424899678, "post_id": 28728485, "comment_id": 45746087, "body": "I resolved the issue."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 768241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7b71e04eac3132597c10b36a80dd35fb?s=128&d=identicon&r=PG", "display_name": "GhostDZ9", "link": "https://stackoverflow.com/users/768241/ghostdz9"}, "is_accepted": false, "score": 0, "last_activity_date": 1424899721, "creation_date": 1424899721, "answer_id": 28729973, "question_id": 28728485, "link": "https://stackoverflow.com/questions/28728485/directory-getfiles-not-getting-specific-files/28729973#28729973", "title": "Directory.GetFiles not getting specific files", "body": "<p>The file copy elsewhere in my code was coping all files instead of the ones that start with JobLog.</p>\n"}, {"tags": [], "owner": {"reputation": 3312, "user_id": 1845672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bddb39c831fe488900043133a4420c4e?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/1845672/roland"}, "is_accepted": false, "score": 0, "last_activity_date": 1424913919, "creation_date": 1424913919, "answer_id": 28732918, "question_id": 28728485, "link": "https://stackoverflow.com/questions/28728485/directory-getfiles-not-getting-specific-files/28732918#28732918", "title": "Directory.GetFiles not getting specific files", "body": "<p>I used code like:</p>\n\n<pre><code>DirectoryInfo DirInfo = ...\nFileInfo[] fi = DirInfo.GetFiles(\"...*\");\n</code></pre>\n\n<p>The various <code>GetFiles()</code> might work slightly different, just try it.</p>\n"}], "owner": {"reputation": 147, "user_id": 768241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7b71e04eac3132597c10b36a80dd35fb?s=128&d=identicon&r=PG", "display_name": "GhostDZ9", "link": "https://stackoverflow.com/users/768241/ghostdz9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424913919, "creation_date": 1424894442, "last_edit_date": 1424894710, "question_id": 28728485, "link": "https://stackoverflow.com/questions/28728485/directory-getfiles-not-getting-specific-files", "title": "Directory.GetFiles not getting specific files", "body": "<p>I am trying to get files with specific name however it is grabbing all the text files. below is my code.</p>\n\n<pre><code>string dir = @\"C:\\Jobs\\Input\"\n\nstring[] filepaths = Directory.GetFiles(dir, \"JobLog*.txt\");\n</code></pre>\n\n<p>This ends up getting all text files that are in the folder not the ones that start with \"JobLog\"</p>\n\n<p>File Names:</p>\n\n<pre><code>JobLog123.txt\nJobLog456.txt\ntesta.txt\ntestb.txt\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 7185, "user_id": 1645737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0tr7.png?s=128&g=1", "display_name": "keenthinker", "link": "https://stackoverflow.com/users/1645737/keenthinker"}, "edited": false, "score": 1, "creation_date": 1424894836, "post_id": 28728480, "comment_id": 45743412, "body": "What have you tried so far? Have a look at <a href=\"http://stackoverflow.com/help/mcve\">this SO help article</a> for a start how and when to ask. A starting approach to solve your problem could look like this: disassemble your problem into smaller parts and start implementing them one by one. For example: create a TextBox and a Button; create a button handler event in which the content of the TextBox is fetched; and so on."}, {"owner": {"reputation": 1100, "user_id": 1378739, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/df219748d1d82e8741f91ed45bffaca1?s=128&d=identicon&r=PG", "display_name": "Setsu", "link": "https://stackoverflow.com/users/1378739/setsu"}, "edited": false, "score": 0, "creation_date": 1424896105, "post_id": 28728480, "comment_id": 45744099, "body": "The current answers assume you want to read from a text file, but if you want to read <i>directly</i> from notepad then you can look at UI Automation to see if you can grab the contents of the edit control. Failing that, you&#39;d have to PInvoke WinAPI to read the memory directly."}], "answers": [{"tags": [], "owner": {"reputation": 1978, "user_id": 178643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/ktj4Q.jpg?s=128&g=1", "display_name": "Babak Fakhriloo", "link": "https://stackoverflow.com/users/178643/babak-fakhriloo"}, "is_accepted": false, "score": 0, "last_activity_date": 1424894999, "creation_date": 1424894999, "answer_id": 28728654, "question_id": 28728480, "link": "https://stackoverflow.com/questions/28728480/how-to-check-if-entered-data-in-a-textbox-is-matching-a-list-of-words-from-notep/28728654#28728654", "title": "How to check if entered data in a TextBox is matching a list of words from notepad", "body": "<p>You dont need to attach your notepad to project, just open it using System.Io classes and read it all and check your string using comparison methods.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 4094984, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AXoWzv5hOdw/AAAAAAAAAAI/AAAAAAAAAO0/PICSvHGL1QI/photo.jpg?sz=128", "display_name": "Rohit Sharma", "link": "https://stackoverflow.com/users/4094984/rohit-sharma"}, "is_accepted": true, "score": 0, "last_activity_date": 1425072439, "last_edit_date": 1425072439, "creation_date": 1424895594, "answer_id": 28728819, "question_id": 28728480, "link": "https://stackoverflow.com/questions/28728480/how-to-check-if-entered-data-in-a-textbox-is-matching-a-list-of-words-from-notep/28728819#28728819", "title": "How to check if entered data in a TextBox is matching a list of words from notepad", "body": "<pre><code>//This code first read the words in text file one by one, \n//which are save in notepad file like one word per line \n\nint aCounter = 0; string aWordInTextFile;\n// Read the file and display it line by line.\nSystem.IO.StreamReader file = new System.IO.StreamReader(\"c:\\notePadFile.txt\");\nwhile((aWordInTextFile = file.ReadLine()) != null){\n   Console.WriteLine (aWordInTextFile);\n   if(textbox.text == aWordInTextFile){\n        messagebox.show(\"String Match, found a string in notepad file\");\n   }\n   aCounter++;\n\n}\n\nfile.Close();\n\n// Suspend the screen.\nConsole.ReadLine();\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4578226, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e4cf4332d4556f05d92a3475d965221b?s=128&d=identicon&r=PG&f=1", "display_name": "Rajsekhar pakalapati", "link": "https://stackoverflow.com/users/4578226/rajsekhar-pakalapati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 28728819, "answer_count": 2, "score": -1, "last_activity_date": 1425072439, "creation_date": 1424894422, "last_edit_date": 1424895139, "question_id": 28728480, "link": "https://stackoverflow.com/questions/28728480/how-to-check-if-entered-data-in-a-textbox-is-matching-a-list-of-words-from-notep", "title": "How to check if entered data in a TextBox is matching a list of words from notepad", "body": "<p>I am doing a project on my own. I want to check if the entered text in a TextBox control matches a list of words entered in notepad.</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>How to attach notepad to my project?</li>\n<li>How to check the words against the list of the words found in notepad?</li>\n</ol>\n\n<p>Please guide me in the right direction.</p>\n"}, {"tags": ["c#", "jquery", "asp.net", "datepicker", "setvalue"], "comments": [{"owner": {"reputation": 10530, "user_id": 1157952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1ee519d700b75e9abff4a5d9ca0d09eb?s=128&d=identicon&r=PG", "display_name": "Catalin", "link": "https://stackoverflow.com/users/1157952/catalin"}, "edited": false, "score": 0, "creation_date": 1424896717, "post_id": 28728434, "comment_id": 45744451, "body": "Try to set the datetime format on the datepicker plugin same as the one from server side <code>dd&#47;MM&#47;yyyy</code>"}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "reply_to_user": {"reputation": 10530, "user_id": 1157952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1ee519d700b75e9abff4a5d9ca0d09eb?s=128&d=identicon&r=PG", "display_name": "Catalin", "link": "https://stackoverflow.com/users/1157952/catalin"}, "edited": false, "score": 0, "creation_date": 1424897104, "post_id": 28728434, "comment_id": 45744679, "body": "Just tried, not working."}, {"owner": {"reputation": 10530, "user_id": 1157952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1ee519d700b75e9abff4a5d9ca0d09eb?s=128&d=identicon&r=PG", "display_name": "Catalin", "link": "https://stackoverflow.com/users/1157952/catalin"}, "edited": false, "score": 0, "creation_date": 1424898284, "post_id": 28728434, "comment_id": 45745338, "body": "If you chose a date from the picker, what format does it have? Maybe you need to set the culture, the default US is MM/dd/yyyy"}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "reply_to_user": {"reputation": 10530, "user_id": 1157952, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/1ee519d700b75e9abff4a5d9ca0d09eb?s=128&d=identicon&r=PG", "display_name": "Catalin", "link": "https://stackoverflow.com/users/1157952/catalin"}, "edited": false, "score": 0, "creation_date": 1424898895, "post_id": 28728434, "comment_id": 45745664, "body": "I don&#39;t have problem reading from datepicker field, but setting it... Format is set as  $(&quot;#dateTextBox&quot;).datepicker(&quot;option&quot;, &quot;dateFormat&quot;, &quot;dd/mm/yy&quot;);"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424899079, "post_id": 28729760, "comment_id": 45745750, "body": "I&#39;ll try asap, but could you explain to me why is it such a complicated process?"}, {"owner": {"reputation": 876, "user_id": 458635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pmeUv.jpg?s=128&g=1", "display_name": "Sankalp", "link": "https://stackoverflow.com/users/458635/sankalp"}, "reply_to_user": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424899309, "post_id": 28729760, "comment_id": 45745874, "body": "Datepicker control that you are using is a javascript control. In ASP.net webpage life cycle, code behind runs first then it executes HTML / javascript part. Your datepicker control is being generated in HTML part. so you can&#39;t set a value for the control which is not generated yet."}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424900560, "post_id": 28729760, "comment_id": 45746627, "body": "Works, but increments my month by 1... Any clue?"}, {"owner": {"reputation": 876, "user_id": 458635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pmeUv.jpg?s=128&g=1", "display_name": "Sankalp", "link": "https://stackoverflow.com/users/458635/sankalp"}, "reply_to_user": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424900711, "post_id": 28729760, "comment_id": 45746713, "body": "Did you try debugging the code and checking the value what is stored in HiddenField ? is the month being incremented by code behind or the script  ?"}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424900883, "post_id": 28729760, "comment_id": 45746794, "body": "datepicker(&quot;setDate&quot;) is incrementing"}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424901141, "post_id": 28729760, "comment_id": 45746923, "body": "Copy paste of yours... Plus the one given in the question. dtString[1] contains correct value."}, {"owner": {"reputation": 876, "user_id": 458635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pmeUv.jpg?s=128&g=1", "display_name": "Sankalp", "link": "https://stackoverflow.com/users/458635/sankalp"}, "reply_to_user": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424901535, "post_id": 28729760, "comment_id": 45747122, "body": "Are you sure, datepicker&#39;s date format is correct ? is it mm/dd/yyyy or dd/mm/yyyy?   what is date value that you are setting to datePicker ?  If it is formatting issue, try this line at the end of your script: $(&quot;#dateTextBox&quot;).datepicker(&quot;option&quot;, &quot;dateFormat&quot;, &quot;dd/mm/yy&quot;);"}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424901809, "post_id": 28729760, "comment_id": 45747261, "body": "I added, below the code in the question: var dtString = $(&quot;#&lt;%=hdnDate.ClientID%&gt;&quot;).val();             if (dtString !== &quot;&quot;) {                 dtString = dtString.split(&#39;,&#39;);                 var defaultDate = new Date(dtString[0], dtString[1], dtString[2]);                 $(&quot;#dateTextBox&quot;).datepicker(&quot;setDate&quot;, defaultDate);             }"}, {"owner": {"reputation": 876, "user_id": 458635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pmeUv.jpg?s=128&g=1", "display_name": "Sankalp", "link": "https://stackoverflow.com/users/458635/sankalp"}, "reply_to_user": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424902006, "post_id": 28729760, "comment_id": 45747361, "body": "I don&#39;t see any issue with the jquery.   what about the code behind ? did you set correct value in hiddenfield through codebehind?   One question - what date value you are expecting and what is being displayed ?"}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424903316, "post_id": 28729760, "comment_id": 45747920, "body": "Months start at 0 index... That&#39;s why its incremented. Update in your answer and I&#39;ll mark as accepted"}, {"owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "edited": false, "score": 0, "creation_date": 1424904165, "post_id": 28729760, "comment_id": 45748334, "body": "I see I wasn&#39;t clear enough in my last comment... So (dt.Month - 1).ToString() is needed..."}, {"owner": {"reputation": 14609, "user_id": 1694368, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ce50876f1ca095cb2b4c3f2033f72ed0?s=128&d=identicon&r=PG", "display_name": "Koby Douek", "link": "https://stackoverflow.com/users/1694368/koby-douek"}, "edited": false, "score": 0, "creation_date": 1473500846, "post_id": 28729760, "comment_id": 66173617, "body": "Works perfectly for me. Thanks."}], "tags": [], "owner": {"reputation": 876, "user_id": 458635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pmeUv.jpg?s=128&g=1", "display_name": "Sankalp", "link": "https://stackoverflow.com/users/458635/sankalp"}, "is_accepted": true, "score": 3, "last_activity_date": 1424920198, "last_edit_date": 1424920198, "creation_date": 1424898973, "answer_id": 28729760, "question_id": 28728434, "link": "https://stackoverflow.com/questions/28728434/asp-net-cant-set-value-to-datepicker-from-code-behind/28729760#28729760", "title": "ASP.NET Can&#39;t set value to datepicker from code behind", "body": "<p>In order to achieve this, you need to read details from client side using hidden field. This hiddenfield value can be set at server side.</p>\n\n<p>For example:</p>\n\n<p>create hidden field on page</p>\n\n<pre><code>&lt;asp:HiddenField id=\"hdnDate\" runat=\"server\" /&gt;\n</code></pre>\n\n<p>set date string in hiddenField :</p>\n\n<pre><code>protected void button_Clicked (...)\n{\n     DateTime dt = DateTime.Now;\n     hdnDate.Value = dt.Year.ToString() + \",\" + (dt.Month - 1 ).ToString() + \",\" + dt.Day.ToString();\n}\n</code></pre>\n\n<p>now, on document.ready of jquery event, do this  </p>\n\n<pre><code>$(document).ready(function() {\n $(\"#dateTextBox\").datepicker({\n        changeMonth: true,\n        changeYear: true\n    });\n\n  dtString = $(\"#&lt;%=hdnDate.ClientID%&gt;\").val();\n  dtString = dtString.split(',');\n  var defaultDate = new Date(dtString[0], dtString[1], dtString[2]);\n  $(\"#dateTextBox\").datepicker(\"setDate\",defaultDate);\n\n});\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6918546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b774a8192d2e6b0fe2364b6ba28b6a02?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Twiss", "link": "https://stackoverflow.com/users/6918546/jay-twiss"}, "is_accepted": false, "score": 0, "last_activity_date": 1575681534, "last_edit_date": 1575681534, "creation_date": 1575680381, "answer_id": 59222116, "question_id": 28728434, "link": "https://stackoverflow.com/questions/28728434/asp-net-cant-set-value-to-datepicker-from-code-behind/59222116#59222116", "title": "ASP.NET Can&#39;t set value to datepicker from code behind", "body": "<p>Try this:</p>\n\n<pre><code>dateTextBox.Value = DateTime.Now.ToString(\"yyyy-MM-dd\");\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 2926286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edf9c5181b350a89cf789223c3b1a0b6?s=128&d=identicon&r=PG&f=1", "display_name": "Marko Milojevic", "link": "https://stackoverflow.com/users/2926286/marko-milojevic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7675, "favorite_count": 0, "accepted_answer_id": 28729760, "answer_count": 2, "score": 0, "last_activity_date": 1575681534, "creation_date": 1424894254, "question_id": 28728434, "link": "https://stackoverflow.com/questions/28728434/asp-net-cant-set-value-to-datepicker-from-code-behind", "title": "ASP.NET Can&#39;t set value to datepicker from code behind", "body": "<p>I have a datepicker field</p>\n\n<pre><code>$(function () {\n        $(\"#dateTextBox\").datepicker({\n            changeMonth: true,\n            changeYear: true\n        });\n\n        $(\"#dateTextBox\").datepicker(\"option\", \"dateFormat\", \"dd/mm/yy\");\n});\n</code></pre>\n\n<p>In code behind, on button click, I'm trying to set value to datepicker field:</p>\n\n<pre><code>dateTextBox.Value = date.ToString(\"dd/MM/yyyy\");\n</code></pre>\n\n<p>But after postback, textbox is empty...</p>\n"}, {"tags": ["c#", "asp.net-mvc", "sorting", "kendo-grid", "kendo-asp.net-mvc"], "comments": [{"owner": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 1, "creation_date": 1424894551, "post_id": 28728384, "comment_id": 45743267, "body": "Not directly supported but this post has a workaround: <a href=\"http://stackoverflow.com/questions/16366450/controlling-group-order-in-a-kendo-ui-grid\" title=\"controlling group order in a kendo ui grid\">stackoverflow.com/questions/16366450/&hellip;</a>"}, {"owner": {"reputation": 3333, "user_id": 401393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7e05b41d301e148c7500fcbcfc90db09?s=128&d=identicon&r=PG", "display_name": "Fillip Peyton", "link": "https://stackoverflow.com/users/401393/fillip-peyton"}, "reply_to_user": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 0, "creation_date": 1424895332, "post_id": 28728384, "comment_id": 45743689, "body": "Sounds like a capable workaround. We could use an enum for the Status column and convert it via a ClientTemplate. That would just mean we have to create a custom filter function for this column too..."}, {"owner": {"reputation": 1510, "user_id": 2577784, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/0UtjR.png?s=128&g=1", "display_name": "djs", "link": "https://stackoverflow.com/users/2577784/djs"}, "edited": false, "score": 0, "creation_date": 1449697450, "post_id": 28728384, "comment_id": 56125440, "body": "I added a new answer to <a href=\"http://stackoverflow.com/questions/16366450/controlling-group-order-in-a-kendo-ui-grid\" title=\"controlling group order in a kendo ui grid\">stackoverflow.com/questions/16366450/&hellip;</a>, which is probably also relevant here."}], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 401393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7e05b41d301e148c7500fcbcfc90db09?s=128&d=identicon&r=PG", "display_name": "Fillip Peyton", "link": "https://stackoverflow.com/users/401393/fillip-peyton"}, "edited": false, "score": 0, "creation_date": 1424895889, "post_id": 28728512, "comment_id": 45743976, "body": "Sounds like a similar solution we came up with too. I&#39;ll check it out and let you know how it goes."}], "tags": [], "owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "is_accepted": false, "score": 2, "last_activity_date": 1424896319, "last_edit_date": 1424896319, "creation_date": 1424894515, "answer_id": 28728512, "question_id": 28728384, "link": "https://stackoverflow.com/questions/28728384/kendo-grid-custom-grouping-sort-order/28728512#28728512", "title": "Kendo Grid custom grouping sort order", "body": "<p>This is possible by returning a calculated field with your data that is a numeric value representing the items order in the sort. Then group by the calculated field but display the status value in the group header.</p>\n\n<p>I used a hack to get this to work and it basically goes like this:</p>\n\n<p>In the Controller:</p>\n\n<pre><code>foreach (MyCustomModelitem in MyCustomModel)\n{\n    item.CustomGroupField= item.Status+ \"_@@\" + MyGetSortIndexForStatus(item.Status).ToString();\n}            \n</code></pre>\n\n<p>In the View</p>\n\n<pre><code>.Columns(columns =&gt;\n{   \n    columns.Bound(t =&gt; t.CustomGroupField).Width(185).Title(\"Status\")\n      .ClientGroupHeaderTemplate(\"# var a = value.split('_@@')  # #=a[0]#\")   \n      .ClientTemplate(\"${Status}\")\n      .Filterable(filterable =&gt; filterable.UI(\"customFieldFilter\"));      \n})\n....\n.DataSource(dataSource =&gt; dataSource\n    .Ajax()\n    .PageSize(750)  \n    .Read(read =&gt; read.Action(\"GetSummaryData\", \"MyContgroller\", @Model))\n    .ServerOperation(true)           \n    .Group(grp =&gt;\n     {\n         if(!String.IsNullOrEmpty(@Model.Groups))\n             foreach(string g in @Model.Groups.Split(','))           \n                 grp.Add(g, typeof(string));\n     })\n )\n</code></pre>\n\n<p>Optional Custom Drop Down List</p>\n\n<pre><code>function customFieldFilter(element) {\n    if (element == null) return;\n    element.kendoDropDownList({\n        dataTextField: \"Status\",\n        dataValueField: \"CustomSortField\",                \n        dataSource: {\n            transport: {                       \n                read: \"@Url.Action(\"GetMyStatuses\", \"MyController\")\"\n            }\n        }\n    });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3333, "user_id": 401393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7e05b41d301e148c7500fcbcfc90db09?s=128&d=identicon&r=PG", "display_name": "Fillip Peyton", "link": "https://stackoverflow.com/users/401393/fillip-peyton"}, "is_accepted": true, "score": -1, "last_activity_date": 1425925674, "creation_date": 1425925674, "answer_id": 28949228, "question_id": 28728384, "link": "https://stackoverflow.com/questions/28728384/kendo-grid-custom-grouping-sort-order/28949228#28949228", "title": "Kendo Grid custom grouping sort order", "body": "<p>How I ended up achieving this was creating an enum for this property, which was sorted in the custom order I wanted. Then, I just used <code>.ClientTemplate()</code> and <code>.ClientGroupHeaderTemplate()</code> to convert these values into the correct strings.</p>\n"}], "owner": {"reputation": 3333, "user_id": 401393, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7e05b41d301e148c7500fcbcfc90db09?s=128&d=identicon&r=PG", "display_name": "Fillip Peyton", "link": "https://stackoverflow.com/users/401393/fillip-peyton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4060, "favorite_count": 0, "accepted_answer_id": 28949228, "answer_count": 2, "score": 1, "last_activity_date": 1456424727, "creation_date": 1424894089, "question_id": 28728384, "link": "https://stackoverflow.com/questions/28728384/kendo-grid-custom-grouping-sort-order", "title": "Kendo Grid custom grouping sort order", "body": "<p>I'm trying to figure out how to have a custom sorting for a column when grouped. Here is a screenshot depicting how I'd like this to work:</p>\n\n<p><img src=\"https://i.stack.imgur.com/bzFsO.jpg\" alt=\"enter image description here\"></p>\n\n<p>In the screenshot, I am defaulting the grouping by the \"<strong>Status</strong>\" column. The column has four possible values: <strong>Unsafe | Quarantined | Waived | Abnormal</strong>. The normal sorting goes by an alphabetical sorting, but I am looking to have just the grouping sorting of the \"<strong>Status</strong>\" column sort by <strong>Unsafe | Quarantined | Waived | Abnormal</strong>. Is this possible to just have the grouping sorting of the column \"Status\" in the order I described?</p>\n\n<p>If this is not possible, what are my options? Thanks!</p>\n"}, {"tags": ["c#", "class", "variables", "unity3d"], "comments": [{"owner": {"reputation": 3559, "user_id": 893219, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/clKUT.jpg?s=128&g=1", "display_name": "PhillyNJ", "link": "https://stackoverflow.com/users/893219/phillynj"}, "edited": false, "score": 1, "creation_date": 1424893972, "post_id": 28728304, "comment_id": 45742960, "body": "You may get a better response if you post a small example of the issue you are having."}, {"owner": {"reputation": 12321, "user_id": 770270, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e658b4994f3a50e22daf9da655ec2282?s=128&d=identicon&r=PG", "display_name": "tnw", "link": "https://stackoverflow.com/users/770270/tnw"}, "edited": false, "score": 1, "creation_date": 1424893979, "post_id": 28728304, "comment_id": 45742965, "body": "Instead of some vague description of your code, show it instead. Please show your attempts and describe what didn&#39;t work. I also have no clue what this means or what you&#39;re asking: <code>If this is true the script runs and if false it doesn&#39;t.</code> Please note that <code>C#</code> is not a scripting language, it is an object-oriented language."}, {"owner": {"reputation": 111, "user_id": 2468432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/813846e703af36c6399623a46c969185?s=128&d=identicon&r=PG", "display_name": "Asd20752", "link": "https://stackoverflow.com/users/2468432/asd20752"}, "edited": false, "score": 0, "creation_date": 1424901954, "post_id": 28728304, "comment_id": 45747332, "body": "In short I were just wondering how to access a variable form another class. But I have updated the post. Hope it is what was missing ;)"}], "answers": [{"tags": [], "owner": {"reputation": 886, "user_id": 629662, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/92ad9a2267c609c2d053c2322942b67f?s=128&d=identicon&r=PG", "display_name": "firebellys", "link": "https://stackoverflow.com/users/629662/firebellys"}, "is_accepted": true, "score": 1, "last_activity_date": 1424907576, "creation_date": 1424907576, "answer_id": 28731879, "question_id": 28728304, "link": "https://stackoverflow.com/questions/28728304/pass-variables-between-classes/28731879#28731879", "title": "pass variables between classes", "body": "<p>I see you are using Unity. You must get the instance of the GameObject you are trying to impact. Example, if you have a Hero GameObject with a Hero.cs (Hero Class) attached to it and you want the Enemy to change the hit points, you must either add the Hero GameObject to the Enemy instance such as:</p>\n\n<pre><code>public GameObject LocalHero;\n</code></pre>\n\n<p>This is added via the inspector window.</p>\n\n<p>Now you have access to a class in another Object.</p>\n\n<p>You can access the Hero class on the Hero GameObject like this.</p>\n\n<pre><code>LocalHero.GetComponent&lt;Hero&gt;.HitPoints = 20;\n</code></pre>\n\n<p>If you don't use the instance by manually adding via the UI, you must use something like GameObject.Find() or similar to get the INSTANCE of the GameObject.</p>\n"}], "owner": {"reputation": 111, "user_id": 2468432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/813846e703af36c6399623a46c969185?s=128&d=identicon&r=PG", "display_name": "Asd20752", "link": "https://stackoverflow.com/users/2468432/asd20752"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 28731879, "answer_count": 1, "score": -2, "last_activity_date": 1424976378, "creation_date": 1424893831, "last_edit_date": 1424976378, "question_id": 28728304, "link": "https://stackoverflow.com/questions/28728304/pass-variables-between-classes", "title": "pass variables between classes", "body": "<p>I just started with C# recently. I used PHP so I'm not into the syntax yet. </p>\n\n<p>I am using Unity and trying to send a variable between two classes. What I have is a mouse movement and a pause class. In the Mouse class I have a variable called state. If this is true the script runs and if false it doesn't. </p>\n\n<p>What I am wondering is how can I change this variable from another class. Since I was not successful in this, I made a class called vars for trying to make it work. No luck there ether.</p>\n\n<p>pauseMenu.cs</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\nusing UnityEngine.UI;\n\npublic class pauseMenu : MonoBehaviour {\npublic bool isMenu = false;\npublic Texture btnTexture;\npublic bool isShown = false;\npublic MouseLook mouse = new MouseLook();\n\n// Update is called once per frame\nvoid Start (){\n\n\n\n    }\nvoid Update () {\n     if (mouse.state== false) {\n                    Debug.Log (\"Some\");\n            }\n            if (Input.GetKeyDown (KeyCode.P) || Input.GetKeyDown (KeyCode.Escape) &amp;&amp; isMenu == false) {\n                    Debug.Log (\"Show\");\n                    isShown = (isShown == false) ? true : false;\n\n\n            }\n            if (isShown) {\n                    Screen.showCursor = true;\n                    Screen.lockCursor = false;\n                    mouse.state= false;\n            }\n    }\nvoid OnGUI()\n{\n    if (isShown) {\n\n        if (GUI.Button (new Rect (10, 10, 50, 50), \"Quit\")) {\n            Application.Quit();\n            Debug.Log(\"Quit\");\n        }\n    }\n}\n}\n</code></pre>\n\n<p>MouseLock.cs</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\n\n[AddComponentMenu(\"Camera-Control/Mouse Look\")]\n\npublic class MouseLook : MonoBehaviour {\n\npublic enum RotationAxes { MouseXAndY = 0, MouseX = 1, MouseY = 2 }\npublic RotationAxes axes = RotationAxes.MouseXAndY;\npublic float sensitivityX = 15F;\npublic float sensitivityY = 15F;\n\npublic float minimumX = -360F;\npublic float maximumX = 360F;\n\npublic float minimumY = -60F;\npublic float maximumY = 60F;\nfloat rotationY = 0F;\npublic bool state { get; set; }\n\nvoid Update ()\n{\n            if (state == true) {\n                    if (axes == RotationAxes.MouseXAndY) {\n                            float rotationX = transform.localEulerAngles.y + Input.GetAxis (\"Mouse X\") * sensitivityX;\n\n                            rotationY += Input.GetAxis (\"Mouse Y\") * sensitivityY;\n                            rotationY = Mathf.Clamp (rotationY, minimumY, maximumY);\n\n                            transform.localEulerAngles = new Vector3 (-rotationY, rotationX, 0);\n                    } else if (axes == RotationAxes.MouseX) {\n                            transform.Rotate (0, Input.GetAxis (\"Mouse X\") * sensitivityX, 0);\n                    } else {\n                            rotationY += Input.GetAxis (\"Mouse Y\") * sensitivityY;\n                            rotationY = Mathf.Clamp (rotationY, minimumY, maximumY);\n\n                            transform.localEulerAngles = new Vector3 (-rotationY, transform.localEulerAngles.y, 0);\n                    }\n            }\n    if (state == false) {\n        Debug.Log (\"false\");\n\n\n    }\n    }\n\nvoid Start ()\n{\n    state = true;\n    //state = true;\n    Debug.Log (\"Started\");\n    // Make the rigid body not change rotation\n    if (rigidbody)\n        rigidbody.freezeRotation = true;\n}\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml", "mvvm", "mvvm-light"], "comments": [{"owner": {"reputation": 1700, "user_id": 2125444, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/VqC96.jpg?s=128&g=1", "display_name": "reggaeguitar", "link": "https://stackoverflow.com/users/2125444/reggaeguitar"}, "edited": false, "score": 0, "creation_date": 1424897100, "post_id": 28728303, "comment_id": 45744676, "body": "I use the EventToCommand code instead of events, it allows me to never write any code behind at all (except to call Close() on a dialog window)"}, {"owner": {"reputation": 51674, "user_id": 455493, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ub5uS.jpg?s=128&g=1", "display_name": "Tseng", "link": "https://stackoverflow.com/users/455493/tseng"}, "edited": false, "score": 0, "creation_date": 1425305932, "post_id": 28728303, "comment_id": 45895871, "body": "General rule of thumb: Messanger for ViewModel communication, Events for UserControls or view-specific stuff (everything that can&#39;t be done via  &quot;Interactivity behaviors&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4592580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a121db1276ed8b61809762ca39adb0a?s=128&d=identicon&r=PG&f=1", "display_name": "AIVoid", "link": "https://stackoverflow.com/users/4592580/aivoid"}, "is_accepted": true, "score": 3, "last_activity_date": 1424899422, "creation_date": 1424899422, "answer_id": 28729882, "question_id": 28728303, "link": "https://stackoverflow.com/questions/28728303/using-mvvm-light-messanger-instead-of-events/28729882#28729882", "title": "Using MVVM Light Messanger instead of Events", "body": "<p>Generally messages in any MVVM frameworks (Prism , MVVM Light) are great way to communicate between loosely coupled components in applications with plugin architecture, because you can send message from one module to another by contract declared in shared library. And it's ok to use it while you develop your application alone or in small team highly skilled programmers. </p>\n\n<p>Otherwise there is a major drawback: it's extremely hard to refactor and debug, because you can't just click on message and \"find usages\" you need first to go to contract (Interface) than \"find usages\", and then visually find places with Subscribe/Register directive. Moreover usually developers forget to unsubscribe from messages so you will face problem while message sent from one module and intended to be processed in same module will be mistakenly processed in other modules, so it will cause unexpected behavior and create so many painful bugs.</p>\n\n<p>All above are based on my personal experience so results may differ. Just be careful with messages and it will serve you well. Also in my opinion messages as replacement for events are a little bit overhead/overengineering because you don't really need it while you have tightly coupled components.</p>\n"}], "owner": {"reputation": 1595, "user_id": 1130329, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d46f987bcbc230f05516cfb260f6c815?s=128&d=identicon&r=PG", "display_name": "user1130329", "link": "https://stackoverflow.com/users/1130329/user1130329"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1164, "favorite_count": 0, "accepted_answer_id": 28729882, "answer_count": 1, "score": 2, "last_activity_date": 1424899422, "creation_date": 1424893830, "question_id": 28728303, "link": "https://stackoverflow.com/questions/28728303/using-mvvm-light-messanger-instead-of-events", "title": "Using MVVM Light Messanger instead of Events", "body": "<p>I am using MVVM Light for my current WPF project and I wonder when I should use MVVM Light's Messaging over WPF Events. </p>\n\n<p><strong>WPF Event:</strong></p>\n\n<p><em>MyControl.xaml</em></p>\n\n<pre><code>&lt;ListView SelectionChanged=\"ListView_OnSelectionChanged\" /&gt;\n</code></pre>\n\n<p><em>MyControl.cs</em></p>\n\n<pre><code>private MyViewModel ViewModel\n{\n    get { return this.DataContext as MyViewModel; }\n}\n\nprivate void ListView_OnSelectionChanged( object sender, SelectionChangedEventArgs e )\n{\n    this.ViewModel.ListViewSelectionChanged( ( (ListView) sender ).SelectedItems );\n}\n</code></pre>\n\n<p><strong>MVVM Light Messaging:</strong></p>\n\n<p><em>MyControl.cs</em></p>\n\n<pre><code>private void ListView_OnSelectionChanged( object sender, SelectionChangedEventArgs e )\n{\n    Messenger.Default.Send( new ListViewSelectionMessage {SelectedItems = ((ListView)sender).SelectedItems} );\n}\n</code></pre>\n\n<p><em>ListViewSelectionMessage.cs</em></p>\n\n<pre><code>public class ListViewSelectionMessage\n{\n    public IList SelectedItems { get; set; }\n}\n</code></pre>\n\n<p><em>MyViewModel</em></p>\n\n<pre><code>public class MyViewModel\n{\n    MyViewModel()\n    {\n        Messenger.Default.Register&lt;ListViewSelectionMessage&gt;(this, this.ListViewSelectionChaged);\n    }\n\n    private void ListViewSelectionChaged( ListViewSelectionMessage message )\n    {\n        // ...\n    }\n}\n</code></pre>\n\n<p>Because using a Messanger everything is decoupled pretty easily I am tempted to use a Messanger everywhere. Is there something wrong using a Messanger instead of Events? Or does this produce problems I am not aware of. Thanks!</p>\n"}, {"tags": ["c#", "recursion"], "comments": [{"owner": {"reputation": 5106, "user_id": 3005513, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XKxoq.png?s=128&g=1", "display_name": "Alex A.", "link": "https://stackoverflow.com/users/3005513/alex-a"}, "edited": false, "score": 4, "creation_date": 1424893852, "post_id": 28728254, "comment_id": 45742895, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/9830069/searching-for-file-in-directories-recursively\">Searching for file in directories recursively</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "is_accepted": false, "score": 0, "last_activity_date": 1424894210, "creation_date": 1424894210, "answer_id": 28728418, "question_id": 28728254, "link": "https://stackoverflow.com/questions/28728254/how-do-i-search-through-directories-recursively/28728418#28728418", "title": "How do I search through directories recursively?", "body": "<p>The functionality exist, it will implement the <code>Enum SearchOption.AllDirectories</code>.  This will trigger the recursive functionality:</p>\n\n<pre><code>var directories = Directory.GetFiles(path, \"*.*\", SearchOption.AllDirectories);\n</code></pre>\n\n<p>You can also do the same thing for <code>DirectoryInfo</code> with some slight modification.</p>\n\n<blockquote>\n  <p>searchOption Type: </p>\n  \n  <p>System.IO.SearchOption One of the enumeration\n  values that specifies whether the search operation should include only\n  the current directory or all subdirectories.</p>\n</blockquote>\n\n<p>More information about this can be found <a href=\"https://msdn.microsoft.com/en-us/library/ms143327(v=vs.110).aspx\" rel=\"nofollow\">here</a>.</p>\n\n<p>Important note, once you've obtained the list of those directories you can loop through and modify in whatever manner you would like.  You'll also want to implement the <code>File.Move</code> if your simply renaming your file.</p>\n"}, {"tags": [], "owner": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "is_accepted": false, "score": 0, "last_activity_date": 1424894283, "creation_date": 1424894283, "answer_id": 28728444, "question_id": 28728254, "link": "https://stackoverflow.com/questions/28728254/how-do-i-search-through-directories-recursively/28728444#28728444", "title": "How do I search through directories recursively?", "body": "<p>Use the below method. Pass the root directory in the function as the parameter.</p>\n\n<pre><code>void DirSearch(string sDir) \n{\ntry \n{\n   foreach (string d in Directory.GetDirectories(sDir)) \n   {\n    foreach (string f in Directory.GetFiles(d, txtFile.Text)) \n    {\n       ChangeFileName();\n    }\n    DirSearch(d);\n   }\n}\ncatch (System.Exception excpt) \n{\n    Console.WriteLine(excpt.Message);\n}\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335, "user_id": 534768, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ef61eb661b143999b047d7ce0d3d91a0?s=128&d=identicon&r=PG", "display_name": "bernd_rausch", "link": "https://stackoverflow.com/users/534768/bernd-rausch"}, "is_accepted": false, "score": 0, "last_activity_date": 1424894427, "creation_date": 1424894427, "answer_id": 28728482, "question_id": 28728254, "link": "https://stackoverflow.com/questions/28728254/how-do-i-search-through-directories-recursively/28728482#28728482", "title": "How do I search through directories recursively?", "body": "<p>Recursive functions are hard to debug. You can try a non-recursive version like this:</p>\n\n<pre><code>    public void ChangeAllFiles(String root)\n    {\n        Stack&lt;String&gt; searchStack = new Stack&lt;string&gt;();\n        searchStack.Push(root);\n\n        while (searchStack.Count &gt; 0)\n        {\n            String path = searchStack.Pop();\n            foreach (var file in Directory.GetFiles(path))\n            {\n                ChangeFileName(file);\n            }\n\n            foreach (var subDir in Directory.GetDirectories(path))\n            {\n                searchStack.Push(subDir);\n            }\n        }\n    }\n</code></pre>\n\n<p>If that doesn't work: What folders are missing?</p>\n"}, {"comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1424896664, "post_id": 28728502, "comment_id": 45744422, "body": "This only looks in sub-directories if there are also files present in the current directory."}], "tags": [], "owner": {"reputation": 39, "user_id": 2325658, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eb090b252bb3f1a684fbdce8dc265a49?s=128&d=identicon&r=PG", "display_name": "RobDev", "link": "https://stackoverflow.com/users/2325658/robdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1424894486, "creation_date": 1424894486, "answer_id": 28728502, "question_id": 28728254, "link": "https://stackoverflow.com/questions/28728254/how-do-i-search-through-directories-recursively/28728502#28728502", "title": "How do I search through directories recursively?", "body": "<p>this one should do the trick.</p>\n\n<pre><code>public void cascade(string path)\n{\n    String[] childFiles = Directory.GetFiles(path);\n    if(childFiles.lenght &gt; 0)\n    {\n        String[] childFolders = Directory.GetDirectories(path); \n        ChangeFileName(childFiles); //iterate and change each fileName\n\n        for (int p = 0; p &lt; childFolders.Length; p++)\n        {\n            cascade(childFolders[p]);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 3641268, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/0ab181c83ef9b427cae2f60f3bccc86e?s=128&d=identicon&r=PG&f=1", "display_name": "user3641268", "link": "https://stackoverflow.com/users/3641268/user3641268"}, "is_accepted": false, "score": 0, "last_activity_date": 1424895338, "creation_date": 1424895338, "answer_id": 28728760, "question_id": 28728254, "link": "https://stackoverflow.com/questions/28728254/how-do-i-search-through-directories-recursively/28728760#28728760", "title": "How do I search through directories recursively?", "body": "<p>I needed to change the changeFiles method to accept a path as an arguement. Then in the cascade method I passed the change files method the path that was passed to the cascade method.</p>\n\n<pre><code>public void cascade(string path)\n    {\n        if(IsDirectoryEmpty(path) == true) \n        { }\n        else\n        {\n            String[] childFolders = Directory.GetDirectories(path);\n            String[] childFiles = Directory.GetFiles(path);\n            ChangeFileName(path);\n\n            for (int p = 0; p &lt; childFolders.Length; p++)\n            {\n                cascade(childFolders[p]);\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3641268, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/0ab181c83ef9b427cae2f60f3bccc86e?s=128&d=identicon&r=PG&f=1", "display_name": "user3641268", "link": "https://stackoverflow.com/users/3641268/user3641268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1089, "favorite_count": 1, "answer_count": 5, "score": -1, "last_activity_date": 1424895338, "creation_date": 1424893659, "question_id": 28728254, "link": "https://stackoverflow.com/questions/28728254/how-do-i-search-through-directories-recursively", "title": "How do I search through directories recursively?", "body": "<p>I need to change a lot of file names all in the same way. They all share a common root but are scattered through out that root in other folders. I am trying to write a program in c# that starts at the root and recursively goes through all of its children and either changes file names or goes into the next folder.  Here is what I have:</p>\n\n<pre><code>public void cascade(string path)\n    {\n        if(IsDirectoryEmpty(path) == true) \n        { }\n        else\n        {\n            String[] childFolders = Directory.GetDirectories(path);\n            String[] childFiles = Directory.GetFiles(path);\n            ChangeFileName();\n\n            for (int p = 0; p &lt; childFolders.Length; p++)\n            {\n                cascade(childFolders[p]);\n            }\n        }\n    }\n</code></pre>\n\n<p>A button calls to cascade and passes in the initial root directory. I then found someones method they wrote to check if its empty:</p>\n\n<pre><code>public bool IsDirectoryEmpty(string path)\n    {\n        return !Directory.EnumerateFileSystemEntries(path).Any();\n    }\n</code></pre>\n\n<p>Im trying to change the fileNames everytime I enter a new directory and if there are more folders I enter them to change more file names. It isnt working and I have no clue why. Changing the file names works but this method isnt reaching all of the folders.</p>\n"}, {"tags": ["c#", "wpf", "gdi+", "gdi", "undo"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1425085195, "post_id": 28728203, "comment_id": 45831725, "body": "I don&#39;t understand: In your animation the undo action seems to be reasonably fast. FWIW, your last approach is also what I have done in the past (maintain a list of actions and implement undo as starting over and doing every action again, except the last one)."}, {"owner": {"reputation": 881, "user_id": 451136, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/88c2bf7ba0c7cab2da7921b29fefa606?s=128&d=identicon&r=PG", "display_name": "Infodayne", "link": "https://stackoverflow.com/users/451136/infodayne"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1425096539, "post_id": 28728203, "comment_id": 45833800, "body": "@500-InternalServerError I need it to be much faster. Like I mentioned, that is only with 3 actions on the stack. If however there are 20+ actions on the stack, with each action having 50+ drawImage calls, and a canvas size of 2048x2028 the speed becomes unacceptable. Also for some reason it am getting out of mem exception when I undo while there are too many things to redraw.  I will have to think of something else. Maybe instead of redrawing multiple images with each stroke, render those to one image first, then I will just have to redraw one image composed of many images."}], "owner": {"reputation": 881, "user_id": 451136, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/88c2bf7ba0c7cab2da7921b29fefa606?s=128&d=identicon&r=PG", "display_name": "Infodayne", "link": "https://stackoverflow.com/users/451136/infodayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1425076350, "creation_date": 1424893517, "last_edit_date": 1425076350, "question_id": 28728203, "link": "https://stackoverflow.com/questions/28728203/undo-redo-for-gdi-graphics", "title": "Undo &amp; redo for gdi graphics", "body": "<p>Im trying to implement undo and redo using gdi in wpf. I am not very familiar with gdi and my attempts have been unsuccessful.</p>\n\n<p>On my mouse move event I draw like this:</p>\n\n<pre><code>    using (var g = Gdi.Graphics.FromImage(tempBitmap))\n    {\n        g.SmoothingMode = Gdi.Drawing2D.SmoothingMode.AntiAlias;\n        g.CompositingQuality = Gdi.Drawing2D.CompositingQuality.HighQuality;\n        if (currentTool == \"eraserBrush\")\n            g.CompositingMode = Gdi.Drawing2D.CompositingMode.SourceCopy;\n        else\n            g.CompositingMode = Gdi.Drawing2D.CompositingMode.SourceOver;\n        g.DrawLine(pen,p0,p1);\n    }\n\n    // Copy GDI bitmap to WPF bitmap.\n    var hbmp = tempBitmap.GetHbitmap();\n    var options = BitmapSizeOptions.FromEmptyOptions();\n    this.writableBmp.Source = Imaging.CreateBitmapSourceFromHBitmap(hbmp,\n        IntPtr.Zero, Int32Rect.Empty, options);\n\n    // Redraw the WPF Image control.\n    this.writableBmp.InvalidateMeasure();\n    this.writableBmp.InvalidateVisual();\n</code></pre>\n\n<p><code>tempBitmap</code> is a Gdi bitmap</p>\n\n<p>On my mouse up event I push tempBitmap to a stack, and on my undo event I pop from the stack and do the following:</p>\n\n<pre><code>if (paintStack.Count &lt;= 1)\n                    return;\n\n                paintStack.Pop();\n                tempBitmap = paintStack.Peek();\n var hbmp = paintStack.Peek().GetHbitmap();\n                var options = BitmapSizeOptions.FromEmptyOptions();\n                this.writableBmp.Source = Imaging.CreateBitmapSourceFromHBitmap(hbmp,\n                    IntPtr.Zero, Int32Rect.Empty, options);\n\n                // Redraw the WPF Image control.\n                this.writableBmp.InvalidateMeasure();\n                this.writableBmp.InvalidateVisual();\n</code></pre>\n\n<p>But hitting undo does nothing. I believe I am pushing and poping the wrong item to the stack. I think I should be doing the gdi graphics, and not the tempbitmap, but I am not sure how.</p>\n\n<p>Edit:----------------------------------------------------</p>\n\n<p>I took a different approach but it seems its a dead end. I created a stack for the history of actions. Pushed an action to the stack after every stroke, and pop'd after an undo. Then on my undo event I just redraw everything minus the last action. This works fine if I am just drawing lines and simple stuff with gdi. However, I also have a tool that draws images, and a lot of them. This approach is way too slow. \n<img src=\"https://i.stack.imgur.com/ORDLq.gif\" alt=\"enter image description here\">\nThe above demonstrates only three levels of undo, the more I draw the slower the undo is (obviously has more actions to read from the stack and redraw).</p>\n\n<p>Theres got to be a way to make this work by just taking a snapshot of the current canvas. Any ideas guys?</p>\n"}, {"tags": ["c#", "entity-framework", "ef-code-first", "poco", "ef-model-first"], "owner": {"reputation": 311, "user_id": 690166, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cbda26b74435db2e8fd845e460065a75?s=128&d=identicon&r=PG", "display_name": "juniper", "link": "https://stackoverflow.com/users/690166/juniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1424939343, "creation_date": 1424893320, "last_edit_date": 1495542027, "question_id": 28728145, "link": "https://stackoverflow.com/questions/28728145/ef-model-first-create-entity-in-edmx-and-db-table-from-class", "title": "EF &quot;Model First&quot;: Create entity in edmx and db-table from class?", "body": "<p>This question is part of my following one I already asked roughly 2.5 years ago:\n<a href=\"https://stackoverflow.com/questions/11415504/entity-framework-net-round-trip-modelling-with-model-first?rq=1\">Entity Framework (.NET) Round-Trip Modelling with Model First?</a></p>\n\n<p>I wanted to ask if in the meantime, the following is possible (and from which version\nof EF upwards):</p>\n\n<p>We are currently using EF 5.0 with the \"Model First\" approach (VS 2012).\nAfter first problems, we managed to configure the two T4 templates for\ngenerating the DbContext-derived class and the POCOs so that if we\nneed to map a new (or existing) database table, we can do that\nvia right-clicking into the VS EF designer > \"update model\nfrom database...\" all works well (our DB has many tables\nand my EF model doesn't map all of them).</p>\n\n<p>Now we have some other (POCO) classes which are not yet mapped to entities\n(in the designer/edmx) AND we do not have any tables in the database\nfor them.\nUsing the \"model first\" approach (we used so far), is it possible to\ngenerate both, the the table schemata (we need the generated SQL as well)\nin the database and the entities in the designer/edmx (meta-data)?\n(I know the name \"model first\" may say it, but maybe the same\napplies as the link for \"code first\" in the next section says:\n\"edmx based\" should have been better?)</p>\n\n<p>I know \"code first\" (or better: \"code based\",\n<a href=\"http://blogs.msdn.com/b/adonet/archive/2014/10/21/ef7-what-does-code-first-only-really-mean.aspx\" rel=\"nofollow noreferrer\">http://blogs.msdn.com/b/adonet/archive/2014/10/21/ef7-what-does-code-first-only-really-mean.aspx</a>)\ncan do such things, but as far as I know, the mappings then are\nonly created temporarily in virtual memory, instead of in the\nedmx (which is, what we need).</p>\n\n<p>One idea I have is to create an additional mini-project using code first,\ngenerate the db tables, and from these, update my edmx in our\nproject mentioned above; or is it possible to somehow\nwrite out an edmx from the temporary model generated by\ncode first?</p>\n\n<p>Would be great if anyone knows a more elegant solution,<br>\nthanks in advance.</p>\n\n<p>Helpful articles from Arthur Vickers:<br>\n<a href=\"http://blog.oneunicorn.com/2012/02/26/dont-use-code-first-by-mistake/\" rel=\"nofollow noreferrer\">http://blog.oneunicorn.com/2012/02/26/dont-use-code-first-by-mistake/</a><br>\n<a href=\"http://blogs.msdn.com/b/adonet/archive/2011/03/07/when-is-code-first-not-code-first.aspx\" rel=\"nofollow noreferrer\">http://blogs.msdn.com/b/adonet/archive/2011/03/07/when-is-code-first-not-code-first.aspx</a></p>\n\n<p>The following SO threads are good matches, too, but somewhat old, too (EF 4):<br>\n<a href=\"https://stackoverflow.com/questions/10179896/using-ef4-migration-tool-with-model-first-approach\">Using EF4 migration tool with model-first approach</a><br>\n<a href=\"https://stackoverflow.com/questions/10385432/entity-framework-4-1-code-first-edmx-issue?rq=1\">Entity Framework 4.1 Code First EDMX issue</a></p>\n"}, {"tags": ["c#", ".net", ".net-4.5", "code-generation", "reflection.emit"], "comments": [{"owner": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 0, "creation_date": 1424893454, "post_id": 28728003, "comment_id": 45742623, "body": "<a href=\"http://stackoverflow.com/a/25311889/2530848\">Does this helps</a>?"}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "reply_to_user": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 0, "creation_date": 1424893649, "post_id": 28728003, "comment_id": 45742753, "body": "@SriramSakthivel no, because there is no problem with method Serialize (and then with Marshal.Copy), it&#39;s problem with emitting it."}, {"owner": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 0, "creation_date": 1424893753, "post_id": 28728003, "comment_id": 45742824, "body": "I understand, but why do you need to emit dynamic method in first place? My answer in given link is generic, you can use it."}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "reply_to_user": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 0, "creation_date": 1424893849, "post_id": 28728003, "comment_id": 45742892, "body": "Because I cannot take an address for an unknown generic type T in C#, can do it using IL. See edit"}, {"owner": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 0, "creation_date": 1424894118, "post_id": 28728003, "comment_id": 45743056, "body": "Again I don&#39;t understand why do you need to emit a method(which is unsafe too) when I give you a solution without unsafe code? What is your goal? To convert any struct to byte[] right? My code exactly does that."}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "reply_to_user": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "edited": false, "score": 0, "creation_date": 1424894474, "post_id": 28728003, "comment_id": 45743226, "body": "@SriramSakthivel for performance reasons. It&#39;s ~80 times slower than direct Ptr casting. Calling it through delegate should half this benefit, but it still 50x times faster than <code>GCHandle.Alloc</code> approach. Anyway, this code should work, problem is in a little mistake that I don&#39;t see. I would be very grateful if you helped me to find and fix it, not to change my approcah"}], "answers": [{"comments": [{"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "edited": false, "score": 0, "creation_date": 1424895510, "post_id": 28728703, "comment_id": 45743788, "body": "Thanks a lot, problem was really with <code>byte</code> instead of <code>byte[]</code> declaration. But I disagree that <code>Ldc_I4_S</code> with byte parameter because struct may be bigger than 256 bytes."}, {"owner": {"reputation": 20516, "user_id": 381588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cff6fe4f2e32e4ae131e65a0fda7f88?s=128&d=identicon&r=PG", "display_name": "Iridium", "link": "https://stackoverflow.com/users/381588/iridium"}, "reply_to_user": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "edited": false, "score": 1, "creation_date": 1424895914, "post_id": 28728703, "comment_id": 45743992, "body": "@AlexZhukovskiy - I understand that the struct may be large, however the specific short-form op-code <code>Ldc_I4_S</code> only allows loading <code>int</code> values that are within the range of an <code>sbyte</code> (not an unsigned <code>byte</code> as I originally suggested - I have corrected this in the answer). If you wish to support structs of &gt;127 bytes, you must use <code>Ldc_I4</code> instead, which allows loading any 32-bit <code>int</code> value, or dynamically switch between short and long form of the instruction depending on the value."}, {"owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "edited": false, "score": 0, "creation_date": 1424896510, "post_id": 28728703, "comment_id": 45744337, "body": "you&#39;re right again, I replaced it with <code>OpCode loadStructSizeOpCode = sizeInBytes &lt; sbyte.MaxValue ? OpCodes.Ldc_I4_S : OpCodes.Ldc_I4</code>"}], "tags": [], "owner": {"reputation": 20516, "user_id": 381588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cff6fe4f2e32e4ae131e65a0fda7f88?s=128&d=identicon&r=PG", "display_name": "Iridium", "link": "https://stackoverflow.com/users/381588/iridium"}, "is_accepted": true, "score": 2, "last_activity_date": 1424895983, "last_edit_date": 1424895983, "creation_date": 1424895168, "answer_id": 28728703, "question_id": 28728003, "link": "https://stackoverflow.com/questions/28728003/il-emit-struct-serializer/28728703#28728703", "title": "IL Emit struct serializer", "body": "<p>There are a few problems. Firstly, your use of <code>parameterName</code> for <code>Ldarga_S</code> is incorrect, it should be <code>(byte)0</code>. Note that the <code>byte</code> cast is required to ensure you're calling the correct <code>Emit()</code> overload - <code>Ldarga_S</code> takes a <code>byte</code> parameter, but without the cast you're calling the overload with  <code>int</code> as its second parameter, this isn't actually a major issue in this instance though you'll get <code>nop</code>s in your output IL - a similar issue is present for your <code>Ldc_I4_S</code>, which takes an <code>sbyte</code> parameter.</p>\n\n<p>Your local variables are also defined incorrectly - you're defining them as <code>typeof(byte)</code> whereas they should be <code>typeof(byte[])</code>.</p>\n\n<p>Once these are corrected, it appears to work as expected.</p>\n"}, {"tags": [], "owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "is_accepted": false, "score": 0, "last_activity_date": 1424895796, "creation_date": 1424895796, "answer_id": 28728868, "question_id": 28728003, "link": "https://stackoverflow.com/questions/28728003/il-emit-struct-serializer/28728868#28728868", "title": "IL Emit struct serializer", "body": "<p>You're making this too complicated. This part</p>\n\n<pre><code>    byte[] result = new byte[12]; \n    Marshal.Copy(p, result, 0, result.Length);\n    return result;\n</code></pre>\n\n<p>does not need to be emitted at all. You only need to emit the pointer taking operation which should be very few easy instructions. Emit only:</p>\n\n<pre><code>Serialize(new IntPtr(&amp;value), restOfArgs);\n</code></pre>\n\n<p>Where <code>Serialize</code> is the three lines from the beginning of this post.</p>\n"}], "owner": {"reputation": 8137, "user_id": 2559709, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RHGiu.jpg?s=128&g=1", "display_name": "Alex Zhukovskiy", "link": "https://stackoverflow.com/users/2559709/alex-zhukovskiy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 2, "accepted_answer_id": 28728703, "answer_count": 2, "score": 1, "last_activity_date": 1424895983, "creation_date": 1424892878, "last_edit_date": 1424893923, "question_id": 28728003, "link": "https://stackoverflow.com/questions/28728003/il-emit-struct-serializer", "title": "IL Emit struct serializer", "body": "<p>I'm writing a code that marshal any structure to byte array. I have a method:</p>\n\n<pre><code>    public static byte[] Serialize(MyStruct value)\n    {\n        IntPtr p = new IntPtr(&amp;value);\n        byte[] result = new byte[12]; \n        Marshal.Copy(p, result, 0, result.Length);\n        return result;\n    }\n</code></pre>\n\n<p>Here is IL for this code:</p>\n\n<pre><code>.method public hidebysig static uint8[]  Serialize(valuetype Program/MyStruct 'value') cil managed\n{\n  // code size:       37 (0x25)\n  .maxstack  4\n  .locals init ([0] native int p,\n           [1] uint8[] result,\n           [2] uint8[] V_2)\n  IL_0000:  nop\n  IL_0001:  ldloca.s   p\n  IL_0003:  ldarga.s   'value'\n  IL_0005:  conv.u\n  IL_0006:  call       instance void [mscorlib]System.IntPtr::.ctor(void*)\n  IL_000b:  ldc.i4.s   12\n  IL_000d:  newarr     [mscorlib]System.Byte\n  IL_0012:  stloc.1\n  IL_0013:  ldloc.0\n  IL_0014:  ldloc.1\n  IL_0015:  ldc.i4.0\n  IL_0016:  ldloc.1\n  IL_0017:  ldlen\n  IL_0018:  conv.i4\n  IL_0019:  call       void [mscorlib]System.Runtime.InteropServices.Marshal::Copy(native int,\n                                                                                   uint8[],\n                                                                                   int32,\n                                                                                   int32)\n  IL_001e:  nop\n  IL_001f:  ldloc.1\n  IL_0020:  stloc.2\n  IL_0021:  br.s       IL_0023\n  IL_0023:  ldloc.2\n  IL_0024:  ret\n} // end of method MyStruct::Serialize\n</code></pre>\n\n<p>now I'm trying to emit generic method:</p>\n\n<pre><code>private static class SerializationHolder&lt;T&gt; where T : struct\n{\n    public static readonly Func&lt;T, byte[]&gt; Value = CreateDelegate();\n\n    private static Func&lt;T, byte[]&gt; CreateDelegate()\n    {\n        var dm = new DynamicMethod(\"Serialize\" + typeof (T).Name,\n            typeof (byte[]),\n            new[] {typeof (T)},\n            Assembly.GetExecutingAssembly().ManifestModule);\n        const string parameterName = \"value\";\n        dm.DefineParameter(1, ParameterAttributes.None, parameterName);\n        var generator = dm.GetILGenerator();\n        var p = generator.DeclareLocal(typeof (IntPtr));\n        generator.DeclareLocal(typeof (byte));\n        generator.DeclareLocal(typeof (byte));\n        generator.Emit(OpCodes.Ldloca_S, p);\n        generator.Emit(OpCodes.Ldarga_S, parameterName);\n        generator.Emit(OpCodes.Conv_U);\n\n        var intPtrCtor = typeof (IntPtr).GetConstructor(new[] {typeof(void*)});\n        Debug.Assert(intPtrCtor != null);\n        generator.Emit(OpCodes.Call, intPtrCtor);\n        var sizeInBytes = Marshal.SizeOf(typeof (T));\n        generator.Emit(OpCodes.Ldc_I4_S, sizeInBytes);\n        generator.Emit(OpCodes.Newarr, typeof (byte));\n        generator.Emit(OpCodes.Stloc_1);\n        generator.Emit(OpCodes.Ldloc_0);\n        generator.Emit(OpCodes.Ldloc_1);\n        generator.Emit(OpCodes.Ldc_I4_0);\n        generator.Emit(OpCodes.Ldloc_1);\n        generator.Emit(OpCodes.Ldlen);\n        generator.Emit(OpCodes.Conv_I4);\n\n        var marshalCopy = typeof (Marshal).GetMethod(\"Copy\", new[] {typeof (IntPtr), typeof (byte[]), typeof (int), typeof (int)});\n        generator.EmitCall(OpCodes.Call, marshalCopy, null);\n        generator.Emit(OpCodes.Ldloc_1);\n        generator.Emit(OpCodes.Stloc_2);\n        generator.Emit(OpCodes.Ldloc_2);\n        generator.Emit(OpCodes.Ret);\n\n        return (Func&lt;T, byte[]&gt;)dm.CreateDelegate(typeof(Func&lt;T, byte[]&gt;));\n    }\n}\n</code></pre>\n\n<p>but when I'm trying to call it it fails with <code>CLR detected an invalid program</code>. I think the problem is in this line:</p>\n\n<pre><code>        generator.Emit(OpCodes.Ldarga_S, parameterName);\n</code></pre>\n\n<p>but if I'm writing:</p>\n\n<pre><code>        generator.Emit(OpCodes.Ldarga_S, 0);\n</code></pre>\n\n<p>if fails with <code>NullReferenceException</code></p>\n\n<hr>\n\n<p>Now I have a code that do it with generic type T but it uses undocumented keywords </p>\n\n<pre><code>public static byte[] Serialize&lt;T&gt;(this T value) where T : struct\n{\n    TypedReference tr = __makeref(value);\n    IntPtr p = *(IntPtr*)&amp;tr;\n    int sizeInBytes = Marshal.SizeOf(typeof(T));\n    byte[] result = new byte[sizeInBytes];\n    Marshal.Copy(p, result, 0, result.Length);\n    return result;\n}\n</code></pre>\n\n<p>It's unstable and can break down in new .Net releases so I want to replace it with Emit-based code</p>\n"}, {"tags": ["c#", "dapper", "typehandler"], "comments": [{"owner": {"reputation": 1794, "user_id": 311809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18da418fdfd9db446f008af48c2305cf?s=128&d=identicon&r=PG", "display_name": "LongZheng", "link": "https://stackoverflow.com/users/311809/longzheng"}, "edited": false, "score": 2, "creation_date": 1436149795, "post_id": 28727962, "comment_id": 50472380, "body": "The bug has now been fixed in Dapper.Net <a href=\"https://github.com/StackExchange/dapper-dot-net/issues/253\" rel=\"nofollow noreferrer\">github.com/StackExchange/dapper-dot-net/issues/253</a>"}], "owner": {"reputation": 3907, "user_id": 3791372, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xEZFO.jpg?s=128&g=1", "display_name": "user3791372", "link": "https://stackoverflow.com/users/3791372/user3791372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2854, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1424907570, "creation_date": 1424892713, "last_edit_date": 1495535220, "question_id": 28727962, "link": "https://stackoverflow.com/questions/28727962/dapper-custom-typehandler-setvalue-not-being-called", "title": "Dapper custom TypeHandler SetValue not being called?", "body": "<p>So, I have an data type which contains some <code>List&lt;string&gt;</code>'s, and as I want to serialize these to Json inside the table column, I added a simple TypeHandler for <code>List&lt;string&gt;</code>:</p>\n\n<pre><code>class Foo : SqlMapper.TypeHandler&lt;List&lt;string&gt;&gt;\n{\n    public override void SetValue(IDbDataParameter parameter, List&lt;string&gt; value)\n    {\n        // never hit\n        throw new NotImplementedException();\n    }\n\n    public override List&lt;string&gt; Parse(object value)\n    {\n        var val = value as string;\n        if (val != null)\n        {\n            var list = JsonConvert.DeserializeObject&lt;List&lt;string&gt;&gt;(val);\n            return list;\n        }\n        throw new Exception(\"unknown value?\");\n\n    }\n}\n\nSqlMapper.AddTypeHandler&lt;List&lt;string&gt;&gt;(new Foo());\n</code></pre>\n\n<p>I'm trying to update a record, but <code>SqlMapper.ExecuteCommand</code> doesn't seem to call the SetValue on the List (though when reading fields, the Parse is called correctly). Instead it errors out telling me I have an error in my sql near ',' - I've used the same SQL before, so I know it's fine. For the parameters, I'm passing the properties that are of type <code>List&lt;string&gt;</code> rather than serializing them at the point of setting parameter values. I've tried modifying the query, removing all params that are <code>List&lt;string&gt;</code> and it's works flawlessly. I've also removed all params except for one <code>List&lt;string&gt;</code> param and I still get the same error that my SQL is wrong near ','.</p>\n\n<p>I've double checked that the data type in the command is indeed <code>List&lt;string&gt;</code> and not some other implementation of <code>ICollection&lt;string&gt;</code> so the <code>SetValue</code> should be called.</p>\n\n<p>Maybe it's worth pointing out I'm using SQLite.</p>\n\n<p>Am I doing something wrong, or is this a bug? I note <a href=\"https://stackoverflow.com/questions/25568657/dapper-typehandler-setvalue-not-being-called\">a similar question</a> has no answer.</p>\n\n<p><strong>Update</strong>: I've done lots of digging and think I may have found a bug - though would like someone more knowledgeable to say so. I have a <code>List&lt;string&gt;</code> param called Foo with two string values, and <code>SetupCommand</code> is trying to bind Foo1 and Foo2 to the underlying cmd. I assume this is the internal handling of enumerable, but shouldn't my custom data type have higher priority? </p>\n\n<p>After stepping through: here's the <a href=\"https://github.com/StackExchange/dapper-dot-net/blob/master/Dapper%20NET40/SqlMapper.cs#L888\" rel=\"nofollow noreferrer\">problem</a> - a simple swapping of the <code>trygetvalue</code> below this code, and all works as expected - my handling of the list supersedes the default <code>enumerable</code> handling. Fix?</p>\n"}, {"tags": ["c#", "integration-testing", "readability"], "answers": [{"comments": [{"owner": {"reputation": 1480, "user_id": 441430, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/D6nl4.png?s=128&g=1", "display_name": "Mr Balanikas", "link": "https://stackoverflow.com/users/441430/mr-balanikas"}, "edited": false, "score": 0, "creation_date": 1424894218, "post_id": 28728278, "comment_id": 45743097, "body": "what exactly do you mean by a TestAPI, implementation-wise? a fluent test api, static &quot;pure&quot; methods, something else?  thx for the book tip :)"}, {"owner": {"reputation": 10532, "user_id": 492701, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/189471ba701cd80f6dfec2f8db53f7a8?s=128&d=identicon&r=PG", "display_name": "Scott Nimrod", "link": "https://stackoverflow.com/users/492701/scott-nimrod"}, "reply_to_user": {"reputation": 1480, "user_id": 441430, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/D6nl4.png?s=128&g=1", "display_name": "Mr Balanikas", "link": "https://stackoverflow.com/users/441430/mr-balanikas"}, "edited": false, "score": 0, "creation_date": 1424894444, "post_id": 28728278, "comment_id": 45743215, "body": "An example: See unit test section of my post... <a href=\"http://stackoverflow.com/questions/26871519/construct-testable-business-layer-logic/26871728#26871728\" title=\"construct testable business layer logic\">stackoverflow.com/questions/26871519/&hellip;</a>"}], "tags": [], "owner": {"reputation": 10532, "user_id": 492701, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/189471ba701cd80f6dfec2f8db53f7a8?s=128&d=identicon&r=PG", "display_name": "Scott Nimrod", "link": "https://stackoverflow.com/users/492701/scott-nimrod"}, "is_accepted": false, "score": 1, "last_activity_date": 1424894313, "last_edit_date": 1424894313, "creation_date": 1424893760, "answer_id": 28728278, "question_id": 28727873, "link": "https://stackoverflow.com/questions/28727873/how-to-organize-test-data-in-integration-tests/28728278#28728278", "title": "how to organize test data in integration tests", "body": "<p>I would shy away from xml files that specify test dependencies.</p>\n\n<p>My thought process stems from a lack of refactoring tools that these xml files cannot take advantage of within the Visual Studio ecosystem.</p>\n\n<p>Instead, I would create a TestAPI.\nThis API will be responsible for serving dependency data to test clients.</p>\n\n<p>Note that the dependency data that is being requested will already be initialized with general data and ready to go for the clients that are requesting the dependencies.</p>\n\n<p>Any values that serve as required test inputs for a particular test would be assigned within the test itself. This is because I want the test to self document its intent or objective and abstract away the dependencies that are not being tested.</p>\n\n<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/0131495054\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">XUnit Test Patterns</a> provided me a lot of insight for writing tests.</p>\n"}, {"comments": [{"owner": {"reputation": 1573, "user_id": 3825959, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/31ed123526ed092add6c2ef7a4b87742?s=128&d=identicon&r=PG&f=1", "display_name": "moarboilerplate", "link": "https://stackoverflow.com/users/3825959/moarboilerplate"}, "edited": false, "score": 0, "creation_date": 1424965897, "post_id": 28728285, "comment_id": 45775974, "body": "+1 for another answer I would have written but you beat me to...:)  Just curious, how do you handle the problem where you do a &quot;default&quot; setup on a mock in one method but then you want to add more to it later in another method? Most mocking frameworks usually blast away any previous setups if you define the same setup again. For example using Moq, how do I set a <code>.Returns</code> in one method, but then define a <code>.Callback</code> in another method (or directly in my test)? My workaround is to either copy the <code>.Returns</code> into said callback-setting area or maintain a collection of the setups."}, {"owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "reply_to_user": {"reputation": 1573, "user_id": 3825959, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/31ed123526ed092add6c2ef7a4b87742?s=128&d=identicon&r=PG&f=1", "display_name": "moarboilerplate", "link": "https://stackoverflow.com/users/3825959/moarboilerplate"}, "edited": false, "score": 1, "creation_date": 1424969297, "post_id": 28728285, "comment_id": 45778235, "body": "I don&#39;t beleive I have had to do that yet.  When using Moq the setups are usually very concise, and to be honest I tend not to use callbacks anyway, usually it&#39;s Just OK to verify the method call with given parameters in the assertion.  You could however apply the same Builder pattern for building your Mock&lt;T&gt; ?"}, {"owner": {"reputation": 1573, "user_id": 3825959, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/31ed123526ed092add6c2ef7a4b87742?s=128&d=identicon&r=PG&f=1", "display_name": "moarboilerplate", "link": "https://stackoverflow.com/users/3825959/moarboilerplate"}, "edited": false, "score": 0, "creation_date": 1424969892, "post_id": 28728285, "comment_id": 45778618, "body": "Yep, I&#39;ve taken that approach and I also have experimented with mixing in functionality with Mocks using Castle.DynamicProxy as well..quite the adventure!"}], "tags": [], "owner": {"reputation": 1090, "user_id": 4555256, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/YX0yx.jpg?s=128&g=1", "display_name": "James Simpson", "link": "https://stackoverflow.com/users/4555256/james-simpson"}, "is_accepted": false, "score": 1, "last_activity_date": 1424893780, "creation_date": 1424893780, "answer_id": 28728285, "question_id": 28727873, "link": "https://stackoverflow.com/questions/28727873/how-to-organize-test-data-in-integration-tests/28728285#28728285", "title": "how to organize test data in integration tests", "body": "<p>For code, use a simple method chaining builder pattern:</p>\n\n<pre><code>public class TestOrderBuilder\n{\n    private order = new Order();\n\n    //  These methods represent sentances / grammar that describe the sort   \n    //  of test data you are building\n    public AnObjectBuilder AddHighQuantityOrderLine()\n    {\n         //... code to add a high quantity order line\n\n         return this; // for method chaining\n    }\n\n    //  These methods represent sentances / grammar that describe the sort   \n    //  of test data you are building\n    public AnObjectBuilder MakeDescriptionInvalid()\n    {\n         //... code to set descriptions etc...\n\n         return this; // for method chaining\n    }\n\n    public Order Order\n    {\n         get { return this.order; }\n    }\n}\n\n// then using it:\nvar order = new TestOrderBuilder()\n                 .AddHighQuantityOrderLine()\n                 .MakeDescriptionInvalid()\n                 .Order\n</code></pre>\n"}], "owner": {"reputation": 1480, "user_id": 441430, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/D6nl4.png?s=128&g=1", "display_name": "Mr Balanikas", "link": "https://stackoverflow.com/users/441430/mr-balanikas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1424894313, "creation_date": 1424892431, "question_id": 28727873, "link": "https://stackoverflow.com/questions/28727873/how-to-organize-test-data-in-integration-tests", "title": "how to organize test data in integration tests", "body": "<p>I am working on a large test project consisting of thousands of integration tests.\nIt is a bit messy with lots of code duplication. Most tests are composed of several steps, and a lot of \"dummy\" objects are created. With dummy I mean something like this:</p>\n\n<pre><code>new Address {\n    Name = \"fake address\",\n    Email = \"some@email.com\",\n    ... and so on\n}\n</code></pre>\n\n<p>where it often really doesn't matter what the data is. This kind of code is spread out and duplicated in tests, test base classes, and helpers. </p>\n\n<p>What I want is to have a single \"test data builder\", having a single responsibility, generate test data which is consumed by the tests. </p>\n\n<p>One approach is to have a class with a bunch of static methods like following:</p>\n\n<pre><code>Something CreateSomething(){\n    return new Something {\n    // set default dummy values\n}\n</code></pre>\n\n<p>and an overload:</p>\n\n<pre><code>Something CreateSomething(params){\n    return new Something {\n    // create the Something from the params\n}\n</code></pre>\n\n<p>Another approach is to have xml files containing the data but i am afraid then it would be too far away from the tests.</p>\n\n<p>The goal is to move this kind of code out of the tests because right now the tests are big and not readable. In a typical case, of 50 lines of test code, 20-30 is of this kind of code.</p>\n\n<p>Are there any patterns for accomplishing this? Or any example of big open source codebase with something similar that I can have a look at?</p>\n"}]