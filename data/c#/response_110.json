[{"tags": ["c#", "mysql", "linux", "database", "connection"], "comments": [{"owner": {"reputation": 949, "user_id": 5458310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rqcmV.png?s=128&g=1", "display_name": "Bitcoin Murderous Maniac", "link": "https://stackoverflow.com/users/5458310/bitcoin-murderous-maniac"}, "edited": false, "score": 0, "creation_date": 1487203286, "post_id": 42262344, "comment_id": 71682292, "body": "Ensure that the server is listening on the port with a simple telnet, etc. to the IP address.  Be sure there are no firewall or routing rules that&#39;d prevent the connection. Try running from a different machine just in case."}, {"owner": {"reputation": 79883, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "edited": false, "score": 0, "creation_date": 1487203510, "post_id": 42262344, "comment_id": 71682361, "body": "Can you connect to the database on your server from a client (HeidiSQL or the mysql command line client or something) running on the same machine as your C# code? That&#39;s an easier way to troubleshoot than running your code. Make sure the MySQL server is actually lstening for connections on a network interface other than <code>127.0.0.1</code>. (<code>netstat -anp | grep 3306</code> will tell you.) You may need to edit your <code>my.cnf</code> file to make that happen."}, {"owner": {"reputation": 1158, "user_id": 7236414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/KhLFV.png?s=128&g=1", "display_name": "Csharpest", "link": "https://stackoverflow.com/users/7236414/csharpest"}, "edited": false, "score": 0, "creation_date": 1487204507, "post_id": 42262344, "comment_id": 71682634, "body": "I have written &quot;netstat -anp | grep 3306&quot; into my putty (not as &quot;mysql&gt;&quot;-command) and it indeed just prompts me the following: tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      31892/mysqld"}, {"owner": {"reputation": 1158, "user_id": 7236414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/KhLFV.png?s=128&g=1", "display_name": "Csharpest", "link": "https://stackoverflow.com/users/7236414/csharpest"}, "edited": false, "score": 0, "creation_date": 1487204879, "post_id": 42262344, "comment_id": 71682751, "body": "cat /etc/mysql/my.cnf tells me that only 127.0.0.1 is the binded adress. Should I set another IP to it?"}, {"owner": {"reputation": 1158, "user_id": 7236414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/KhLFV.png?s=128&g=1", "display_name": "Csharpest", "link": "https://stackoverflow.com/users/7236414/csharpest"}, "edited": false, "score": 0, "creation_date": 1487205109, "post_id": 42262344, "comment_id": 71682816, "body": "Setting the connection IP to 127.0.0.1 prompts the same error btw"}], "answers": [{"comments": [{"owner": {"reputation": 1158, "user_id": 7236414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/KhLFV.png?s=128&g=1", "display_name": "Csharpest", "link": "https://stackoverflow.com/users/7236414/csharpest"}, "edited": false, "score": 0, "creation_date": 1523877792, "post_id": 49855941, "comment_id": 86726574, "body": "Thanks for the input, to be honest, i dont own this server and mysql server anymore, so i cant test it. But this is still helpful"}], "tags": [], "owner": {"reputation": 344, "user_id": 9628596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kp8A0.png?s=128&g=1", "display_name": "arjun", "link": "https://stackoverflow.com/users/9628596/arjun"}, "is_accepted": false, "score": 1, "last_activity_date": 1523877317, "creation_date": 1523877317, "answer_id": 49855941, "question_id": 42262344, "link": "https://stackoverflow.com/questions/42262344/c-issue-connecting-to-mysql-linux-database/49855941#49855941", "title": "C# issue connecting to MySQL Linux Database", "body": "<ol>\n<li>Try below commands from client machine <code># telnet &lt;serverip&gt; 3306</code></li>\n<li>If first point fails, Check if there is Firewall rule to accept all incoming mysql connections on port 3306.</li>\n<li>Server accept connections from all ip's if mysql id binded to 0.0.0.0 check it in /etc/my.cnf </li>\n<li><p>It's just for confirmation , I assume you have added client IP[not the server IP] in below user creation command.</p>\n\n<p><code>GRANT ALL PRIVILEGES on frag_huans.* to fh@myclientServerIP;\nFLUSH PRIVILEGES;</code></p></li>\n</ol>\n"}], "owner": {"reputation": 1158, "user_id": 7236414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/KhLFV.png?s=128&g=1", "display_name": "Csharpest", "link": "https://stackoverflow.com/users/7236414/csharpest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523877317, "creation_date": 1487202923, "question_id": 42262344, "link": "https://stackoverflow.com/questions/42262344/c-issue-connecting-to-mysql-linux-database", "title": "C# issue connecting to MySQL Linux Database", "body": "<p>It's the first time I'm using <strong>PuTTY</strong> + <strong>dedicated Linux Server</strong>.</p>\n\n<p>I have installed the <strong>MySQL server client</strong> on my <strong>dedicated Linux server</strong>:</p>\n\n<pre><code>apt-get install mysql-server\n</code></pre>\n\n<p>After installing, I had to set the MySQL Server password, which is what I did.\nI have then created a database and a table, which I inserted one row into.</p>\n\n<pre><code>CREATE DATABASE frag_huans;\n\nuse frag_huans;\n\nCREATE TABLE hero_data (\n-&gt; ID int(2),....);\n\nINSERT INTO hero_data VALUES ('1',...);\n</code></pre>\n\n<p>this is literally <strong>all I have done so far in regards to PuTTY</strong>.</p>\n\n<p>What I now tried to achieve, was <strong>connecting to the database</strong> via my C# Class (in Unity3D).</p>\n\n<p>I've done this with my localhost (xampp) server and it worked fine.</p>\n\n<pre><code>string constr = \"Server=localhost;Database=letzter;User ID=root;Password=;Pooling=true\";\n</code></pre>\n\n<p>Now I wanted to connect to the Linux MySQL database the same way:</p>\n\n<pre><code>string constr = \"Server=myServerIP;Database=frag_huans;Uid=root@serverIP;Pwd=myPassword\";\n</code></pre>\n\n<p>where \"myServerIP\" is definitely my servers IP and the Uid is the ID that gets shown in PuTTY at the start of the command line.</p>\n\n<p><strong>The connection won't set up</strong>, Unity debugger prompting:</p>\n\n<pre><code>MySql.Data.MySqlClient.MySqlException: Unable to connect to any of the specified MySQL hosts. ---&gt; System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it.\n\n  at System.Net.Sockets.Socket.Connect (System.Net.EndPoint remoteEP, Boolean requireSocketPolicy) [0x00000] in &lt;filename unknown&gt;:0 \n  at System.Net.Sockets.Socket+Worker.Connect () [0x00000] in &lt;filename unknown&gt;:0 \n  --- End of inner exception stack trace ---\n  at MySql.Data.MySqlClient.NativeDriver.Open () [0x00000] in &lt;filename unknown&gt;:0 \n  at MySql.Data.MySqlClient.Driver.Open () [0x00000] in &lt;filename unknown&gt;:0 \n  at MySql.Data.MySqlClient.Driver.Create (MySql.Data.MySqlClient.MySqlConnectionStringBuilder settings) [0x00000] in &lt;filename unknown&gt;:0 \n  at MySql.Data.MySqlClient.MySqlPool.CreateNewPooledConnection () [0x00000] in &lt;filename unknown&gt;:0 \n  at MySql.Data.MySqlClient.MySqlPool.GetPooledConnection () [0x00000] in &lt;filename unknown&gt;:0 \n  at MySql.Data.MySqlClient.MySqlPool.TryToGetDriver () [0x00000] in &lt;filename unknown&gt;:0 \nUnityEngine.Debug:Log(Object)\nHeroDB:Awake() (at Assets/Preload/HeroDB.cs:51)\n</code></pre>\n\n<p>Using another value at \"Server=...\" tells me that the host can't be found which ensures me that <strong>my host address seems to be correct</strong>.</p>\n\n<p>I have also tried to <strong>create another \"user\"</strong> for the MySQL Server + <strong>grant</strong> this one <strong>all privileges</strong>:</p>\n\n<pre><code>CREATE USER fh@myServerIP IDENTIFIED BY 'password';\n\nGRANT ALL PRIVILEGES on frag_huans.* to fh@myServerIP;\nFLUSH PRIVILEGES;\n</code></pre>\n\n<p>Changing the connection string to the user shown above didn't change the outcome.</p>\n\n<p>I believe that the Linux server/MySQL database <strong>blocks my access</strong>. Is there any <strong>privileges I have to set to the connection?</strong> What could be a possible cause for this problem? I've seen many people having the \"No connection could be made because the target machine actively refused it\" - issue, but there seem to be too many different cases.</p>\n\n<p>If you can help me in any way, I would be very happy</p>\n\n<p>Thanks in advance, Cshaprest</p>\n"}, {"tags": ["c#", "asp.net", "gridview"], "comments": [{"owner": {"reputation": 2021, "user_id": 1518100, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EW5RK.jpg?s=128&g=1", "display_name": "Lei Yang", "link": "https://stackoverflow.com/users/1518100/lei-yang"}, "edited": false, "score": 0, "creation_date": 1487206811, "post_id": 42262307, "comment_id": 71683336, "body": "Is <code>AutoGenerateColumns</code> set to true?"}, {"owner": {"reputation": 1, "user_id": 7571852, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ehnIS1Rg8XM/AAAAAAAAAAI/AAAAAAAAAIk/l7Nv_P76xbY/photo.jpg?sz=128", "display_name": "user7571852", "link": "https://stackoverflow.com/users/7571852/user7571852"}, "reply_to_user": {"reputation": 2021, "user_id": 1518100, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EW5RK.jpg?s=128&g=1", "display_name": "Lei Yang", "link": "https://stackoverflow.com/users/1518100/lei-yang"}, "edited": false, "score": 0, "creation_date": 1487256354, "post_id": 42262307, "comment_id": 71710405, "body": "Thank you so much...I know it is something simple :)"}], "owner": {"reputation": 1, "user_id": 7571852, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ehnIS1Rg8XM/AAAAAAAAAAI/AAAAAAAAAIk/l7Nv_P76xbY/photo.jpg?sz=128", "display_name": "user7571852", "link": "https://stackoverflow.com/users/7571852/user7571852"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487202728, "creation_date": 1487202728, "question_id": 42262307, "link": "https://stackoverflow.com/questions/42262307/gridview-failed-to-display-data", "title": "Gridview failed to display data", "body": "<p>newbi to .Net code; I appreciate if someone can answer this fairly easy question. I made sure that the SQL command is returning the data, but I cant make it populate and display the datagrid. </p>\n\n<p>Here is the code </p>\n\n<pre><code>   cmd.Connection = conn;\n    SqlDataAdapter sda = new SqlDataAdapter(cmd);\n    //DataTable dt = new DataTable();\n    var dt = new DataSet();\n    sda.Fill(dt);\n    //DataGrid GV1 = new DataGrid(); \n    //Response.Write(ds.Rows[0][0].ToString()); \n    //GV.DataSource = dt;\n    GV.DataSource = dt.Tables[0];\n    GV.DataBind();\n    Response.Write(\"Hello\");\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "sql-server", "iis", "dll"], "owner": {"reputation": 887, "user_id": 1471755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b6b301de9d2105273bfd743f15f399ad?s=128&d=identicon&r=PG", "display_name": "Sam Thornton", "link": "https://stackoverflow.com/users/1471755/sam-thornton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1861, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1487301628, "creation_date": 1487202522, "last_edit_date": 1487301628, "question_id": 42262278, "link": "https://stackoverflow.com/questions/42262278/iis-error-loading-msvcr100-dll-from-microsoft-sqlserver-types-loader-cs", "title": "IIS &quot;Error loading msvcr100.dll&quot; from Microsoft.SqlServer.Types loader.cs", "body": "<p>After setting up an existing (and functioning) .net api application on a new machine, I encounter this error: <code>Error loading msvcr100.dll (ErrorCode: 5)</code>. That error is coming from <code>SqlServerTypes.Utilities.LoadNativeAssembly</code> which is a generated method from the Microsoft.SqlServer.Types <a href=\"https://www.nuget.org/packages/Microsoft.SqlServer.Types/\" rel=\"nofollow noreferrer\">nuget package</a>. (You can take a look at <a href=\"http://sourcebrowser.io/Browse/jonwagner/Insight.Database/Insight.Tests/SqlServerTypes/Loader.cs\" rel=\"nofollow noreferrer\">the generated code</a>).</p>\n\n<p>I know that error code 5 is a permissions error, but I can't find anything wrong with the permissions itself. If I comment out the <code>msvcr100.dll</code> line, the same error occurs trying to load <code>SqlServerSpatial110.dll</code>.</p>\n\n<p>As many other posts have mentioned, this is normally an issue with Visual C++ Redistributable 2010, but I've reinstalled that multiple times now.</p>\n\n<p>I suspect the issue is in my IIS settings, but I'm unable to figure out where that might be. Any help on this?</p>\n\n<hr>\n\n<p>*Update: I was able to fix the issue by explicitly <a href=\"https://www.iis.net/learn/manage/configuring-security/application-pool-identities\" rel=\"nofollow noreferrer\">adding <code>IIS AppPool\\DefaultAppPool</code></a> as a user with access to the project folder. But, no one else on the team has had to do this, so I still believe there is some setting in IIS I'm missing.</p>\n"}, {"tags": ["c#", "forms", "http-post"], "answers": [{"tags": [], "owner": {"reputation": 2767, "user_id": 55154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fse7P.jpg?s=128&g=1", "display_name": "Fredy Treboux", "link": "https://stackoverflow.com/users/55154/fredy-treboux"}, "is_accepted": true, "score": 1, "last_activity_date": 1487202793, "creation_date": 1487202793, "answer_id": 42262320, "question_id": 42262248, "link": "https://stackoverflow.com/questions/42262248/c-visual-studio-post-form-going-to-different-route/42262320#42262320", "title": "C# Visual Studio post form going to different route", "body": "<p>Your SendPassword Action does not include the [AllowAnonymous] attribute like the one above does.</p>\n\n<p>Due to your current set up, ASP.NET is trying to authenticate you by sending you to the Account/Login route.</p>\n\n<p>If you need the ability to POST to the SendPassword action without being authenticated, add the [AllowAnonymous] attribute to it as well like so:</p>\n\n<pre><code>[AllowAnonymous, HttpPost]\npublic ActionResult SendPassword(string email)\n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 1238856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/FKWJR.jpg?s=128&g=1", "display_name": "KBouldin9", "link": "https://stackoverflow.com/users/1238856/kbouldin9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 1, "accepted_answer_id": 42262320, "answer_count": 1, "score": 0, "last_activity_date": 1487202793, "creation_date": 1487202337, "question_id": 42262248, "link": "https://stackoverflow.com/questions/42262248/c-visual-studio-post-form-going-to-different-route", "title": "C# Visual Studio post form going to different route", "body": "<p>I have this form in <code>RetrievePassword.cshtml</code>:</p>\n\n<pre><code>@using (Html.BeginForm(\"SendPassword\", \"Users\", FormMethod.Post))\n{\n    &lt;input type=\"text\" name=\"email\" /&gt;\n    &lt;button type=\"submit\" name=\"submit\" class=\"btn btn-primary\"&gt;Submit&lt;/button&gt;\n}\n</code></pre>\n\n<p>With this in my UsersController:</p>\n\n<pre><code>[AllowAnonymous]\npublic ActionResult RetrievePassword() \n{\n    return View();\n}\n\n[HttpPost]\npublic ActionResult SendPassword(string email)\n{\n    System.Diagnostics.Debug.WriteLine(\"SendPassword POST\");\n    return null;\n}\n</code></pre>\n\n<p>But, when I click the submit button in the form, the webpage tries to navigate to /Accounts/Login with the URL being <code>localhost:58893/Account/Login?ReturnUrl=%fUsers%2SendPassword</code>. An account controller exists but there is no login method. However, I get the correct <code>Users/SendPassword</code> URL when if I remove the SendPassword method in the Users Controller, but of course nothing shows up since there is no method or view attached. </p>\n\n<p>Any ideas to why it tries to navigate to <code>Account/Login</code> instead of <code>Users/SendPassword</code>? OR why the URL is correct only if I remove the method in the controller?</p>\n"}, {"tags": ["c#", ".net", "clr", "windbg", "jit"], "comments": [{"owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1487222323, "post_id": 42262201, "comment_id": 71687813, "body": "My first thought has been that it&#39;s very useless that you&#39;ve added a new Q&amp;A when it could be enough that you comment out Jon Skeet&#39;s answer on that old Q&amp;A to verify if that info is still valid..."}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "reply_to_user": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1487228539, "post_id": 42262201, "comment_id": 71690581, "body": "@Mat&#237;asFidemraizer: so you think I should add a comment on Jon Skeets answer and ask for clarification? IMHO I have already explained why it&#39;s not a duplicate. The answer from 2009 can only have considered .NET up to 3.5, I&#39;m asking for newer versions as well."}, {"owner": {"reputation": 219328, "user_id": 15498, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Wi4EN.png?s=128&g=1", "display_name": "Damien_The_Unbeliever", "link": "https://stackoverflow.com/users/15498/damien-the-unbeliever"}, "edited": false, "score": 1, "creation_date": 1487233147, "post_id": 42262201, "comment_id": 71693087, "body": "I don&#39;t see how Code Access Security would change anything about how IL is turned into real code, and I don&#39;t think that new frameworks have changed the <i>decision</i> about <i>when</i> to JIT (but have introduced a new JIT compiler). But your point about app domains does seem to raise a genuine new aspect that&#39;s not been addressed."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1487238722, "post_id": 42262201, "comment_id": 71696924, "body": "It is not really obvious to me why this has to be proven.  The claim is certainly not true (ducking bolt of lighting), generic code gets compiled multiple times by the jitter.  One copy that handles any reference type argument and additional copies for each distinct value type argument.  And sure, for AppDomains the LoaderOptimization applies.  There are profiler callbacks that tells you what the jitter is working on, ICorProfilerCallback::JITCompilationStarted() and ICorProfilerCallback4::ReJITCompilationStarted()."}, {"owner": {"reputation": 2574, "user_id": 274204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3LYJr.png?s=128&g=1", "display_name": "Brian Reichle", "link": "https://stackoverflow.com/users/274204/brian-reichle"}, "edited": false, "score": 1, "creation_date": 1487255625, "post_id": 42262201, "comment_id": 71709879, "body": "In addition to Hans&#39; comments, as of .NET 4.5, a managed profiler can request that the runtime re-jitt a method (so that it can instrument it differently). There is also a case where the run time can <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/0c9d618e-d5f5-4bf5-bbb9-b76214ceb1be/icorprofilercallbackjitcompilationstarted-firing-multiple-times?forum=clr\" rel=\"nofollow noreferrer\">start jitting a method it is already in the process of jitting</a>."}, {"owner": {"reputation": 24288, "user_id": 1466046, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Fa7gP.png?s=128&g=1", "display_name": "magicandre1981", "link": "https://stackoverflow.com/users/1466046/magicandre1981"}, "edited": false, "score": 1, "creation_date": 1487263522, "post_id": 42262201, "comment_id": 71716299, "body": "use ETW to capture .net Jit events (<a href=\"http://stackoverflow.com/a/30289933/1466046\">stackoverflow.com/a/30289933/1466046</a>). In the profile, replace 0x8008 with 0x8018 to also capture Jit events. now you see loader, jit and exception data with callstacks. now look when jit happens"}, {"owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1487266902, "post_id": 42262201, "comment_id": 71718689, "body": "@ThomasWeller Just try to ask Jon Skeet to update his answer if there&#39;s something new in newer CLR versions."}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "reply_to_user": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1487267811, "post_id": 42262201, "comment_id": 71719250, "body": "@Mat&#237;asFidemraizer: I did; see his comment on the linked answer. It seems he does not have enough knowledge to update."}, {"owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1487267955, "post_id": 42262201, "comment_id": 71719334, "body": "@ThomasWeller I see. Actually who can answer you with 100% of accuracy can be a .net development team member..."}], "answers": [{"tags": [], "owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "is_accepted": false, "score": 2, "last_activity_date": 1488568432, "creation_date": 1488568432, "answer_id": 42586720, "question_id": 42262201, "link": "https://stackoverflow.com/questions/42262201/how-to-prove-that-the-net-clr-jit-compiles-every-method-only-once-per-run/42586720#42586720", "title": "How to prove that the .NET CLR JIT compiles every method only once per run?", "body": "<p>The \"design principle\" of the JIT is to compile a method (an instantiation of method for generic methods) once and and reuse the same native code. Of course, the implementation is extremely complicated and I'll try simplify the answer without compromising accuracy. The answer is the same for all versions of the runtime since .NET 2.0 and up to the latest .NET 4.6 (I don't know about .NET 1.x, probably the same).</p>\n\n<p>The runtime profiler callbacks and the ETW events are poorly documented. Both of them occur when JIT compilation is attempted, but not necessarily succeeded. There are three cases where this can happen: 1- the method fails to meet certain security requirements, 2- the verification of the method failed, and 3- memory could not be allocated to hold the native code to be emitted. Therefore, the JIT start callback and event can overestimate the number of times a method has actually been compiled. Similarly, the JIT completion callback and event are inaccurate. There are few rarely occurring cases in which they might underestimate the number of times the same method has been successfully compiled. It's worth mentioning at this point that the <a href=\"https://msdn.microsoft.com/en-us/library/w8f5kw2e%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396#jit\" rel=\"nofollow noreferrer\"># of Methods JITted performance counter</a> reports accurately the number of times all IL methods have been compiled collectively in all appdomains of a process.</p>\n\n<p>For appdomain-specific assemblies, methods are compiled in each appdomain separately. There is no sharing (even though it can be technically possible sometimes). For appdomain-neutral assemblies, the runtime <strong>attempts</strong> to compile each method once and share the native code with all appdomains.</p>\n\n<blockquote>\n  <p>How to prove that the .NET CLR JIT compiles every method only once per\n  run?</p>\n</blockquote>\n\n<p>Well, in some cases (such as when using background JIT, and other extremely subtle cases), a method can get compiled without ever getting executed. So saying every method is compiled once per run is inaccurate.</p>\n\n<p>You can refer to the CoreCLR JIT source code for more information (the JIT is the same one used in the .NET framework 4.5+ but this answer applies to older versions since the JIT triggering mechanism is mostly the same). The source code is the proof.</p>\n\n<blockquote>\n  <p>methods are JITted for every object per thread</p>\n</blockquote>\n\n<p>Yes, that doesn't make any sense. The scope of compilation is appdomains.</p>\n"}], "owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1488568432, "creation_date": 1487202046, "last_edit_date": 1495535401, "question_id": 42262201, "link": "https://stackoverflow.com/questions/42262201/how-to-prove-that-the-net-clr-jit-compiles-every-method-only-once-per-run", "title": "How to prove that the .NET CLR JIT compiles every method only once per run?", "body": "<p>There's <a href=\"https://stackoverflow.com/questions/1255803/does-the-net-clr-jit-compile-every-method-every-time/1255832\">an old question</a> asking whether C# is JIT compiled every time and the answer by famous Jon Skeet is: \"no, it's compiled only once per application\" as long as we're talking about desktop applications which are not NGENed.</p>\n\n<p>I want to know if that information from 2009 is still true and I want to figure that out by experiment and debugging, potentially by putting a breakpoint on the JITter and using WinDbg commands to inspect objects and methods.</p>\n\n<h2>My research so far</h2>\n\n<p>I know that the .NET memory layout considers a Header (at address A-4) and a Method Table (at address A+0) per object before the actual data starts (at address A+4). So it would be possible that each object has a different method table and thus could have different JITted methods.</p>\n\n<h2>Why do I have doubts about the correctness of the statement?</h2>\n\n<p>We had a workshop for parallel programming and one claim by the trainer was that methods are JITted for every object per thread. That clearly didn't make sense to me and I was able to write a counter example application.</p>\n\n<p>Unfortunately, the following other topics came up, for which I also want to write a demonstration:</p>\n\n<ul>\n<li>new .NET frameworks</li>\n<li>application domains</li>\n<li>code access security</li>\n</ul>\n\n<p>The linked answer was written when .NET 3.5 was released. It was not substantially changed since then, i.e. it has not received updates for .NET 4.0, 4.6 and 4.6.</p>\n\n<p>Regarding application domains, my personal opinion is that I could unload an application domain, which unloads assemblies. If an assembly is unloaded, it's gone and the IL code goes with it. I don't see much benefit in keeping native code for IL code which was destroyed. Therefore, I could imagine that creating an application domain and loading the assembly again might result in JITting the method again.</p>\n\n<p>Regarding code access security, I'm not sure if it is considered by the JIT compiler based on the current permissions or whether it's done by reflection at runtime. If it's done by the JIT compiler, the compiled code will differ, depending on the permission set.</p>\n"}, {"tags": ["c#", ".net", "sql-server", "deadlock"], "comments": [{"owner": {"reputation": 629, "user_id": 7211523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCauX.jpg?s=128&g=1", "display_name": "Ibrahim Malluf", "link": "https://stackoverflow.com/users/7211523/ibrahim-malluf"}, "edited": false, "score": 2, "creation_date": 1487202447, "post_id": 42262161, "comment_id": 71682023, "body": "&gt;&gt;end transaction (which rolls back because of no explicit transaction.commit)  Are you doing an explicit rollback?"}, {"owner": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "reply_to_user": {"reputation": 629, "user_id": 7211523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCauX.jpg?s=128&g=1", "display_name": "Ibrahim Malluf", "link": "https://stackoverflow.com/users/7211523/ibrahim-malluf"}, "edited": false, "score": 0, "creation_date": 1487203196, "post_id": 42262161, "comment_id": 71682261, "body": "No. the code is in a .net <code>using</code> scope, so it auto-rollsback because there is not explicit <code>commit()</code>;"}, {"owner": {"reputation": 14963, "user_id": 834261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vxyWz.png?s=128&g=1", "display_name": "hatchet - done with SOverflow", "link": "https://stackoverflow.com/users/834261/hatchet-done-with-soverflow"}, "edited": false, "score": 0, "creation_date": 1487204970, "post_id": 42262161, "comment_id": 71682771, "body": "What indexes are on this table? What does the query plan for <code>SELECT COUNT(PersonId) FROM [dbo].[People]</code> look like?"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1487216892, "post_id": 42262161, "comment_id": 71686072, "body": "Don&#39;t use <code>SELECT CAST(SCOPE_IDENTITY()</code>. Use <code>Output Inserted...</code>"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1487216941, "post_id": 42262161, "comment_id": 71686091, "body": "You can add <code>with nolock</code> hint to your select"}], "answers": [{"comments": [{"owner": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "edited": false, "score": 0, "creation_date": 1487222674, "post_id": 42262736, "comment_id": 71687953, "body": "Hi @pent - thank you kindly for your answer. Is there any chance you can please elaborate on your answer. I really don&#39;t understand what that means right now. Are these locks good? Should they be doing this? Are there some other suggestions to how I could improve things to remove these problems?"}, {"owner": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "edited": false, "score": 0, "creation_date": 1487285803, "post_id": 42262736, "comment_id": 71729150, "body": "I&#39;m trying to understand the technical points to your answer ... so as I work through that, i&#39;ll be posting the odd question. Firstly - why would the code be using <code>IX_People_Name</code> as the index when I&#39;m not doing any <code>WHERE</code> clauses against that particular field?"}, {"owner": {"reputation": 5236, "user_id": 17122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7q596.jpg?s=128&g=1", "display_name": "Pent Ploompuu", "link": "https://stackoverflow.com/users/17122/pent-ploompuu"}, "reply_to_user": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "edited": false, "score": 0, "creation_date": 1487286215, "post_id": 42262736, "comment_id": 71729327, "body": "The index needs to be updated for the new/changed rows. The count query is using the index most likely because it&#39;s the smallest (narrowest) index on the table - it&#39;s the fastest way to enumerate all the rows."}, {"owner": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "edited": false, "score": 0, "creation_date": 1487291967, "post_id": 42262736, "comment_id": 71731168, "body": "Why would the count be using the <code>IX_People_Name</code> index instead of the Primary Key ? wouldn&#39;t the Primary Key be the smallest (narrowest) index on that table?"}, {"owner": {"reputation": 5236, "user_id": 17122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7q596.jpg?s=128&g=1", "display_name": "Pent Ploompuu", "link": "https://stackoverflow.com/users/17122/pent-ploompuu"}, "reply_to_user": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "edited": false, "score": 0, "creation_date": 1487297714, "post_id": 42262736, "comment_id": 71732862, "body": "The primary key is most probably a clustered index - it contains all the columns, i.e. the entire table."}, {"owner": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "edited": false, "score": 0, "creation_date": 1487298650, "post_id": 42262736, "comment_id": 71733124, "body": "How about using an INDEX HINT for the <code>COUNT</code> statement, instead of creating another index (like you suggestion #1). This <code>COUNT</code> is only used in a TEST suite. Secondly, you suggest this: &quot;<i>It also improves concurrency and performance of foreign key integrity checks</i>&quot; .. so does this mean you personally create these narrow indexes for FK&#39;s, in your own Db&#39;s ?"}, {"owner": {"reputation": 5236, "user_id": 17122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7q596.jpg?s=128&g=1", "display_name": "Pent Ploompuu", "link": "https://stackoverflow.com/users/17122/pent-ploompuu"}, "reply_to_user": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "edited": false, "score": 0, "creation_date": 1487329778, "post_id": 42262736, "comment_id": 71747591, "body": "A <code>WITH(READCOMMITTED)</code> hint would work - with <code>READ_COMMITTED_SNAPSHOT</code> on it doesn&#39;t cause a deadlock. I personally create these narrow indexes only on some high-concurrency tables that also have many references to them (a People table looks like a good candiate)."}], "tags": [], "owner": {"reputation": 5236, "user_id": 17122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7q596.jpg?s=128&g=1", "display_name": "Pent Ploompuu", "link": "https://stackoverflow.com/users/17122/pent-ploompuu"}, "is_accepted": true, "score": 2, "last_activity_date": 1487330002, "last_edit_date": 1487330002, "creation_date": 1487205414, "answer_id": 42262736, "question_id": 42262161, "link": "https://stackoverflow.com/questions/42262161/trying-to-prevent-this-deadlock-from-happening-in-my-net-code-on-sql-server/42262736#42262736", "title": "Trying to prevent this Deadlock from happening in my .NET code on SQL Server", "body": "<p>You have an index on the name column, so the update behaves as a delete+insert for locking/IO purposes.</p>\n\n<p>The deadlock graph shows Test1 waiting to acquire a <code>RangeS-S</code> lock to count all rows while holding a <code>RangeX-X</code> lock on the inserted row(s). It needs a shared lock over the entire table to count the rows and an exclusive lock for the inserted rows (not sure why it's using a range lock).</p>\n\n<p>At the same time Test2 is waiting to acquire a <code>RangeI-N</code> lock to insert the new name row while holding a <code>X</code> lock on the removed old name row.</p>\n\n<p>I would suggest one of the following:</p>\n\n<ul>\n<li>Create a narrow unique index on the primary key(<code>PersonID?</code>) field - this index would not need locking for updates, can be used to do a fast count(*) and it's quite cheap to maintain. It also improves concurrency and performance of foreign key integrity checks (for this to take effect the FK-s referencing <code>[People]</code> table have to be re-created).</li>\n<li>Change the locking of the count query (if business requirements allow) - e.g. use <code>WITH(READCOMMITTED)</code> table hint or do it after committing the inserts.</li>\n<li>Run the count query before the inserts and increment it by the inserted row count (this might be bad for concurrency because it holds a shared lock on the entire table)</li>\n</ul>\n"}], "owner": {"reputation": 78716, "user_id": 30674, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5f1a1d3e883676684f288f4ed973f9aa?s=128&d=identicon&r=PG", "display_name": "Pure.Krome", "link": "https://stackoverflow.com/users/30674/pure-krome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "accepted_answer_id": 42262736, "answer_count": 1, "score": 2, "last_activity_date": 1487330002, "creation_date": 1487201839, "last_edit_date": 1487286090, "question_id": 42262161, "link": "https://stackoverflow.com/questions/42262161/trying-to-prevent-this-deadlock-from-happening-in-my-net-code-on-sql-server", "title": "Trying to prevent this Deadlock from happening in my .NET code on SQL Server", "body": "<p>A deadlock is occurring during my integration tests for some C# code that is testing my SQL queries against a SQL Server.</p>\n\n<ul>\n<li>Software: SQL Server 2012</li>\n<li>Database: <code>READ COMMITTED ISOLATION</code> is set to <code>ON</code></li>\n</ul>\n\n<p>I have two tests that are fighting each other as this happens in parallel. </p>\n\n<p>Test 1 (Pseudo C# code)</p>\n\n<pre><code>using (start a new transaction)\n{\n    foreach Person in the People-Collection\n    {\n        Insert this Person into the DB and grab the ID of this inserted person.\n        =&gt; INSERT INTO [dbo].[People] (...) VALUES (...);\n           SELECT CAST(SCOPE_IDENTITY() AS INT);\n    }\n\n    Now, count how many people are in the DB right now (because there might have been more, from before we inserted these temp people).\n        =&gt; SELECT COUNT(PersonId) FROM [dbo].[People]\n}\n// end transaction (which rolls back because of no explicit transaction.commit)\n</code></pre>\n\n<p>Test 2</p>\n\n<pre><code>using (start a new transaction)\n{\n    Update a person\n    =&gt; UPDATE [dbo].[People]\n       SET    .....\n       WHERE  PersonId = @personId\n}\n// end transaction which auto rolls back.\n</code></pre>\n\n<p>So <em>I'm guessing</em> that the following is happening:</p>\n\n<ul>\n<li>Test1 runs the INSERT/SELECT</li>\n<li>Test2 runs the UPDATE (waits for test1 to finish)</li>\n<li>Test1 finishes but now runs the SELECT COUNT(..)</li>\n</ul>\n\n<p>and for some reason, test1 is waiting for test2 to complete it's update but test2 can't update (for reasons I can't imagine).</p>\n\n<p>I would have thought the following <em>should</em> have occurred:</p>\n\n<ul>\n<li>Test1 starts running (and in a TRANSACTION).</li>\n<li>Test2 starts running .. and notices that there's a transaction running so it either waits for that transaction to complete <em>OR</em> can figure out that it's update has <em>nothing</em> to do with test1's transaction so it updates.</li>\n<li>Test1 eventually completes.</li>\n</ul>\n\n<p>Obviously, I don't get what is happening :(</p>\n\n<p>Index\nThe deadlock graph lists a particular index as a cause of grief. Here's the index:</p>\n\n<pre><code>ALTER TABLE [dbo].[People] ADD  CONSTRAINT [IX_People_Name] UNIQUE NONCLUSTERED \n(\n    [Name] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]\nGO\n</code></pre>\n\n<p>Can someone make some suggestions to how I can fix this, please?</p>\n\n<p>NOTE: <a href=\"https://gist.github.com/PureKrome/8a3fe15bec04172b2d165fabf22ddcd9\" rel=\"nofollow noreferrer\">This gist</a> contains the full deadlock graph as a reference.</p>\n\n<p>EDIT 1: Added <code>using</code> statement code for better understanding of logic/flow.\nEDIT 2: Added index schema/code</p>\n"}, {"tags": ["c#", "sql-server", "database"], "comments": [{"owner": {"reputation": 2021, "user_id": 1518100, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EW5RK.jpg?s=128&g=1", "display_name": "Lei Yang", "link": "https://stackoverflow.com/users/1518100/lei-yang"}, "edited": false, "score": 0, "creation_date": 1487207248, "post_id": 42262152, "comment_id": 71683461, "body": "You can reduce columns, and put you stored procedure here, for faster finding root cause."}], "answers": [{"tags": [], "owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1487226840, "creation_date": 1487226840, "answer_id": 42266582, "question_id": 42262152, "link": "https://stackoverflow.com/questions/42262152/why-does-trying-to-save-a-url-with-a-stored-procedure-only-insert-a-point/42266582#42266582", "title": "Why does trying to save a URL with a stored procedure only insert a point?", "body": "<p>You didn't show us your stored procedure you're calling, but from the symptoms described, I'm <em>guessing</em> that you've probably defined a parameter in that stored procedure as <code>VARCHAR</code> or <code>NVARCHAR</code> - <em>without</em> specifying a <strong>length</strong> for that string.</p>\n\n<p>In SQL Server, if you <em>omit</em> the length, the strings will default to a system-given length - in the case of <strong>parameters</strong> for a stored procedure, that length is <strong>exactly one character</strong>.</p>\n\n<p>So <code>VARCHAR</code> is identical to <code>VARCHAR(1)</code> and thus accepts only <strong>one character</strong> long strings - everything else is silently truncated.</p>\n\n<p>The moral of the story: you should <strong><em>ALWAYS</em></strong> (no exceptions!) define an <strong>explicit length</strong> with your <code>VARCHAR</code> and <code>NVARCHAR</code> (and also <code>CHAR</code> and <code>NCHAR</code>) datatypes!</p>\n\n<p>Change your <code>VARCHAR</code> to something like <code>VARCHAR(100)</code> (or whatever length makes sense in your scenario) and you should be fine</p>\n"}], "owner": {"reputation": 287, "user_id": 6273112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1049654298413829/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/6273112/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 42266582, "answer_count": 1, "score": 1, "last_activity_date": 1487270787, "creation_date": 1487201784, "last_edit_date": 1487270787, "question_id": 42262152, "link": "https://stackoverflow.com/questions/42262152/why-does-trying-to-save-a-url-with-a-stored-procedure-only-insert-a-point", "title": "Why does trying to save a URL with a stored procedure only insert a point?", "body": "<p>What I want is to save the url of an image, as I have seen the URLs are saved with two or four diagonals depending, so they are not taken as special characters and I already try those two ways, sending my URL string with more than one Diagonal attached.</p>\n\n<p>I have debugged and followed the insertion process and all the way always carries the URL the additional diagonals, except at the time of inserting because the only thing that is saved in the URL field is a \".\"</p>\n\n<p>The address goes in this way in the whole process <code>\"..//..//../images/images/Logo.png\"</code>, in its defect it goes with four diagonals but in no way is saved correctly.</p>\n\n<p>The URL should go after the last pipe |, but only one point is seen.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0kKjp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0kKjp.png\" alt=\"enter image description here\"></a></p>\n\n<p>Insert Code:</p>\n\n<pre><code>#region EMPRESA\n    #region insertar Empresa\n    public string insertarEmpresa(int idEmpresa, string nombre, string rfc, string direccion, int codPostal, string idEstado, string telefono, string colonia, string pais, string ciudad,int tipoS,string immex,string logo, int idUser, string ip)\n    {\n        establecerConexion();\n        string result = \"\";\n        try\n        {\n            SqlDataReader read = null;\n            comando = new SqlCommand(\"sp_InsertarEmpresa\", conexion);\n            comando.CommandType = CommandType.StoredProcedure;\n            comando.Parameters.Add(\"@idEmpresa\", SqlDbType.Int).Value = idEmpresa;\n            comando.Parameters.Add(\"@nomEmpresa\", SqlDbType.VarChar).Value = nombre;\n            comando.Parameters.Add(\"@rfc\", SqlDbType.VarChar).Value = rfc;\n            comando.Parameters.Add(\"@direccion\", SqlDbType.VarChar).Value = direccion;\n            comando.Parameters.Add(\"@codPostal\", SqlDbType.Int).Value = codPostal;\n            comando.Parameters.Add(\"@estado\", SqlDbType.VarChar).Value = idEstado;\n            comando.Parameters.Add(\"@telefono\", SqlDbType.VarChar).Value = telefono;\n            comando.Parameters.Add(\"@colonia\", SqlDbType.VarChar).Value = colonia;\n            comando.Parameters.Add(\"@pais\", SqlDbType.VarChar).Value = pais;\n            comando.Parameters.Add(\"@ciudad\", SqlDbType.VarChar).Value = ciudad;\n            comando.Parameters.Add(\"@tipoS\", SqlDbType.Int).Value =tipoS;\n            comando.Parameters.Add(\"@immex\", SqlDbType.VarChar).Value = immex;\n            comando.Parameters.Add(\"@logo\", SqlDbType.VarChar).Value = logo;\n            comando.Parameters.Add(\"@idUser\", SqlDbType.Int).Value = idUser;\n            comando.Parameters.Add(\"@ip\", SqlDbType.VarChar).Value = ciudad;\n            conexion.Open();\n            read = comando.ExecuteReader();\n            if (read.HasRows)\n            {\n                while (read.Read())\n                {\n                    result = read.GetValue(0).ToString();\n                } return \"1\";\n            }\n            else return \"1\";\n\n        }\n        catch (SqlException ex)\n        {\n            return \"2\";\n        }\n        finally\n        {\n            if (comando != null)\n                comando.Dispose();\n            conexion.Close();\n        }\n\n    }\n    #endregion\n</code></pre>\n\n<p>The code of store procedure:</p>\n\n<pre><code>USE [DBSIADANA]\nGO\n\n/****** Object:  StoredProcedure [dbo].[sp_InsertarEmpresa]    Script Date: 02/16/2017 12:33:38 ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nALTER Procedure [dbo].[sp_InsertarEmpresa]\n(\n    @idEmpresa int,\n    @nomEmpresa varchar(max),\n    @rfc varchar(max),\n    @direccion varchar(max),\n    @codPostal int,\n    @estado varchar(50),\n    @telefono varchar(30),\n    @colonia varchar(max),\n    @pais varchar(50),\n    @ciudad varchar(50),\n    @tipoS int,\n    @immex varchar,\n    @logo varchar,\n    @idUser int,\n    @ip varchar(50)\n\n )\nAs\nBegin\n    Declare\n    @idCiudad int,\n    @idEstado int,\n    @idPais int\n\n    set @idCiudad = (Select idCiudad from DBSGICE.dbo.cCiudad where nomCiudad like '%'+@ciudad+'%')\n    set @idEstado = (Select idEstado from DBSGICE.dbo.cEstado where nomEstado like '%'+@estado+'%')\n    set @idPais = (Select idPais from DBSGICE.dbo.cPais where nomPais like '%'+@pais+'%')\n\n    If exists(Select idEmpresa from DBEMPDEV.dbo.tEmpresa where idEmpresa=@idEmpresa)\n        Update DBEMPDEV.dbo.tEmpresa Set nomEmpresa=@nomEmpresa,direccion=@direccion,colonia=@colonia,codPostal=@codPostal,idCiudad=@idCiudad\n        where idEmpresa=@idEmpresa\n    Else\n        Insert into DBEMPDEV.dbo.tEmpresa (nomEmpresa,rfc,direccion,codPostal,idEstado,telefono,colonia,idPais,idCiudad,immex,logotipo,principal)\n        values (@nomEmpresa,@rfc,@direccion,@codPostal,@idEstado,@telefono, @colonia, @idPais,@idCiudad,@immex,@logo,0)\n        SET @idEmpresa=(SELECT TOP 1 idEmpresa FROM DBEMPDEV.dbo.tEmpresa ORDER BY idEmpresa DESC);\n            Insert into DBSIADANA.dbo.tSistemaEmpresa(idEmpresa,idTipoSistema)values(@idEmpresa,@tipoS)\n\n    Insert Into DBSIADANA.dbo.tLogEmpresa Values(GETDATE(), @idUser, 3, @ip, CONVERT(varchar(10),@idEmpresa)+' | '+@rfc)\n\nEnd\n\nGO\n</code></pre>\n"}, {"tags": ["c#", "xamarin.forms"], "answers": [{"comments": [{"owner": {"reputation": 975, "user_id": 4757847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-0KiPcedyLN0/AAAAAAAAAAI/AAAAAAAAB_8/r1Cp2yzOfa4/photo.jpg?sz=128", "display_name": "Umar3x", "link": "https://stackoverflow.com/users/4757847/umar3x"}, "edited": false, "score": 0, "creation_date": 1487235660, "post_id": 42268297, "comment_id": 71694622, "body": "Was a typo mistake ... still I changed considering your post, my button is not enabled at start, so it seems correctly binded to the IsValid property, but I does not changes when the mail is valid (when color is back to normal, If i dump the IsValid value in the handleTextChanged function of behavior it works ... seems something wrong)"}, {"owner": {"reputation": 15380, "user_id": 1063783, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dae907d26dd200d065227e2a020bc999?s=128&d=identicon&r=PG", "display_name": "Stephane Delcroix", "link": "https://stackoverflow.com/users/1063783/stephane-delcroix"}, "edited": false, "score": 0, "creation_date": 1487257593, "post_id": 42268297, "comment_id": 71711471, "body": "Please fix the typo in your question"}, {"owner": {"reputation": 13840, "user_id": 1177147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/zHhAS.jpg?s=128&g=1", "display_name": "Mark Feldman", "link": "https://stackoverflow.com/users/1177147/mark-feldman"}, "edited": false, "score": 0, "creation_date": 1487279089, "post_id": 42268297, "comment_id": 71725895, "body": "You&#39;re still doing <code>_isEnabled = _isValid;</code>. You have to set <code>isEnabled</code> instead, otherwise the property change notification won&#39;t get raised."}], "tags": [], "owner": {"reputation": 13840, "user_id": 1177147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/zHhAS.jpg?s=128&g=1", "display_name": "Mark Feldman", "link": "https://stackoverflow.com/users/1177147/mark-feldman"}, "is_accepted": false, "score": 1, "last_activity_date": 1487232838, "creation_date": 1487232838, "answer_id": 42268297, "question_id": 42262043, "link": "https://stackoverflow.com/questions/42262043/how-to-bind-isvalidproperty-behavior-on-button/42268297#42268297", "title": "How to bind IsValidProperty behavior on button", "body": "<p>You don't have an <code>IsEnabled</code> property in your view model, so the line <code>OnPropertyChanged(\"IsEnabled\");</code> won't do anything at all. What I believe you need to do is change the name of your <code>SetIsEnabledButton</code> property to <code>IsEnabled</code> and change the line <code>_isEnabled = _isValid;</code> to <code>IsEnabled = _isValid;</code>. That way when <code>IsValid</code> gets set it will transfer control to the <code>IsEnabled</code> setter which will then raise the property change notification for itself.</p>\n\n<p>Post back here if you still have trouble getting it to work.</p>\n"}, {"tags": [], "owner": {"reputation": 15380, "user_id": 1063783, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dae907d26dd200d065227e2a020bc999?s=128&d=identicon&r=PG", "display_name": "Stephane Delcroix", "link": "https://stackoverflow.com/users/1063783/stephane-delcroix"}, "is_accepted": true, "score": 3, "last_activity_date": 1487233463, "creation_date": 1487233463, "answer_id": 42268482, "question_id": 42262043, "link": "https://stackoverflow.com/questions/42262043/how-to-bind-isvalidproperty-behavior-on-button/42268482#42268482", "title": "How to bind IsValidProperty behavior on button", "body": "<p>Looking at the <code>Debug.WriteLine()</code> you added, I'm guessing the <code>IsValid</code> property isn't set by the Binding.</p>\n\n<p>It is because you're not setting the <code>DefaultBindingMode</code> of the <code>BindableProperty</code>, or because you're not setting the <code>BindingMode</code> of the <code>Binding</code> itself. So the binding defaults to <code>OneWay</code>, which means your behavior <code>IsValid</code> is modified when the view model is changed, but not the other way around.</p>\n\n<p>Create your <code>BindableProperty</code> this way:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static BindableProperty IsValidProperty =\n    BindableProperty.Create(\"IsValid\", typeof(bool), typeof(EmailValidatorBehavior),\n        false, BindingMode.TwoWay);\n</code></pre>\n\n<p>And that should work.</p>\n\n<p>Some additional remarks if I may:</p>\n\n<h3>1. going through the ViewModel is not required</h3>\n\n<p>You could bind the <code>Entry</code> <code>IsEnabled</code> property directly to the behavior <code>IsValid</code> property.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var behavior = new EmailValidatorBehavior();\n_okButton.SetBinding(MR.Gestures.Button.IsEnabledProperty, new Binding(\"IsEnabled\", source: behavior));\n_emailEntry.Behaviors.Add(behavior);\n</code></pre>\n\n<p>And if you do that, the behavior becomes the source of the binding and you don't have to create a <code>BindableProperty</code>, you just have to implement <code>INotifyPropertyChanged</code>.</p>\n\n<h3>2. make sure that you never share the Behavior across <code>Entry</code> instances</h3>\n\n<p>if you share this Behavior in a Style, the same instance will be reused, and it won't work as expected.</p>\n"}, {"tags": [], "owner": {"reputation": 975, "user_id": 4757847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-0KiPcedyLN0/AAAAAAAAAAI/AAAAAAAAB_8/r1Cp2yzOfa4/photo.jpg?sz=128", "display_name": "Umar3x", "link": "https://stackoverflow.com/users/4757847/umar3x"}, "is_accepted": false, "score": 0, "last_activity_date": 1513296054, "last_edit_date": 1513296054, "creation_date": 1488569452, "answer_id": 42586980, "question_id": 42262043, "link": "https://stackoverflow.com/questions/42262043/how-to-bind-isvalidproperty-behavior-on-button/42586980#42586980", "title": "How to bind IsValidProperty behavior on button", "body": "<p>I've found out to make it work, and I did not need any viewmodel to do that thanks to @Stephane Delcroix post. </p>\n\n<p>I still have my bindable property on the behavior following @Stephane Delcroix advice. </p>\n\n<pre><code>public static BindableProperty IsValidProperty = BindableProperty.Create(\"IsValid\", typeof(bool), typeof(EmailValidatorBehavior), false, BindingMode.TwoWay);\n</code></pre>\n\n<p>To bind my button on the isValid property I wrote that : </p>\n\n<pre><code>_okButton.SetBinding(IsEnabledProperty,\n                new Binding(EmailValidatorBehavior.IsValidProperty.PropertyName));\n</code></pre>\n\n<p>\"It's a good practise to refer to the PropertyName instead of the \"Value\" like \"IsValid\", in such a way it avoids any typos within the string and both the compilier and completion avoid mistakes\".</p>\n\n<p>I set the bindingContext of my button on the behavior just like that : </p>\n\n<pre><code> _okButton.BindingContext = _emailBehavior;\n</code></pre>\n"}], "owner": {"reputation": 975, "user_id": 4757847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-0KiPcedyLN0/AAAAAAAAAAI/AAAAAAAAB_8/r1Cp2yzOfa4/photo.jpg?sz=128", "display_name": "Umar3x", "link": "https://stackoverflow.com/users/4757847/umar3x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 42268482, "answer_count": 3, "score": 0, "last_activity_date": 1554072773, "creation_date": 1487201168, "last_edit_date": 1554072773, "question_id": 42262043, "link": "https://stackoverflow.com/questions/42262043/how-to-bind-isvalidproperty-behavior-on-button", "title": "How to bind IsValidProperty behavior on button", "body": "<p>I'm trying to achieve a validation control.</p>\n\n<p>I've got a page, in which I've got an <em>entry</em> and an ok <em>button</em>.</p>\n\n<p>The entry is an email input, and I implemented a <strong>Behavior</strong> to display to the user whether his input is good or not. I'd like to bind the <em>IsEnabled</em> Property of the button to the <em>IsValid</em> property of the behavior.</p>\n\n<p>Here is the behavior code : </p>\n\n<pre><code>public class EmailValidatorBehavior : Behavior&lt;Entry&gt;\n{\n    const string emailRegex = @\"^(?(\"\")(\"\".+?(?&lt;!\\\\)\"\"@)|(([0-9a-z]((\\.(?!\\.))|[-!#\\$%&amp;'\\*\\+/=\\?\\^`\\{\\}\\|~\\w])*)(?&lt;=[0-9a-z])@))\" +\n        @\"(?(\\[)(\\[(\\d{1,3}\\.){3}\\d{1,3}\\])|(([0-9a-z][-\\w]*[0-9a-z]*\\.)+[a-z0-9][\\-a-z0-9]{0,22}[a-z0-9]))$\";\n\n\n    public static BindableProperty IsValidProperty = BindableProperty.Create(\"IsValid\", typeof(bool), typeof(EmailValidatorBehavior), false);\n\n    public bool IsValid\n    {\n        get { return (bool)base.GetValue(IsValidProperty); }\n        private set { base.SetValue(IsValidProperty, value); }\n    }\n\n    protected override void OnAttachedTo(Entry entry)\n    {\n        entry.TextChanged += HandleTextChanged;\n        base.OnAttachedTo(entry);\n    }\n\n    void HandleTextChanged(object sender, TextChangedEventArgs e)\n    {\n        bool IsValid = false;\n        IsValid = (Regex.IsMatch(e.NewTextValue, emailRegex, RegexOptions.IgnoreCase, TimeSpan.FromMilliseconds(250)));\n        ((Entry)sender).TextColor = IsValid ? Color.Default : Color.Red;\n    }\n\n    protected override void OnDetachingFrom(Entry entry)\n    {\n        entry.TextChanged -= HandleTextChanged;\n        base.OnDetachingFrom(entry);\n    }\n}\n</code></pre>\n\n<p>And in the page, I had the behavior like that. \nIt wokrs, color changes back to normal only if email validates regex</p>\n\n<pre><code>_emailEntry.Behaviors.Add(new EmailValidatorBehavior());\n</code></pre>\n\n<p>Plus, my page has a <em>bindingContext</em> which is a view model. As I know I'm going to do my logic here to bind . I see that I have to listen to the property changed event on the IsValidProperty but I can't resolve how to implement it. Something's not clear with binding and <em>bindableProperty</em> for me even if I read a lot of the doc on xamarin's website, especially in the case of behavior and creating bindable properties. I've begun that : </p>\n\n<p>In page : </p>\n\n<pre><code>     var behavior = new EmailValidatorBehavior();\n        //Binding context is LandingViewModel \n        behavior.SetBinding(EmailValidatorBehavior.IsValidProperty, \"IsValid\");\n        _okButton.SetBinding(MR.Gestures.Button.IsEnabledProperty, \"IsEnabled\");\n        _emailEntry.Behaviors.Add(behavior);\n</code></pre>\n\n<p>And here is the view model : </p>\n\n<pre><code>public class LandingViewModel : BaseViewModel\n{\n\n    private bool _isEnabled;\n    private bool _isValid;\n\n    public bool IsEnabled\n    {\n        get { return _isEnabled; }\n        set\n        {\n            if (_isEnabled == value) return;\n            _isEnabled = value;\n            OnPropertyChanged(\"IsEnabled\");\n        }   \n    }\n\n    public bool IsValid\n    {\n        get { return _isValid; }\n        set\n        {\n            Debug.WriteLine(_isValid);\n            if (_isValid == value) return;\n            _isValid = value;\n            IsEnabled = _isValid;\n            Debug.WriteLine(_isValid);\n            OnPropertyChanged(\"IsValid\");\n        }\n    }\n</code></pre>\n\n<p>I'm not happy, I see I'm clearly missing something, but can't see what ... </p>\n\n<p>Thank you very much. </p>\n"}, {"tags": ["c#", "visual-studio", "itext"], "comments": [{"owner": {"reputation": 5322, "user_id": 7411852, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10210681797466386/picture?type=large", "display_name": "Matt Spinks", "link": "https://stackoverflow.com/users/7411852/matt-spinks"}, "edited": false, "score": 0, "creation_date": 1487201232, "post_id": 42262033, "comment_id": 71681637, "body": "Are you running your executable within the same environment when you run the release vs test build?"}, {"owner": {"reputation": 33, "user_id": 7285668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336b75a5530d9ea219067958d6559390?s=128&d=identicon&r=PG&f=1", "display_name": "stutch", "link": "https://stackoverflow.com/users/7285668/stutch"}, "reply_to_user": {"reputation": 5322, "user_id": 7411852, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10210681797466386/picture?type=large", "display_name": "Matt Spinks", "link": "https://stackoverflow.com/users/7411852/matt-spinks"}, "edited": false, "score": 0, "creation_date": 1487201387, "post_id": 42262033, "comment_id": 71681686, "body": "@MattSpinks yep, I am. The build in /bin/Debug works fine, but the build in /bin/Debug/app.publish has issues."}, {"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1487201397, "post_id": 42262033, "comment_id": 71681691, "body": "I just wanted to point out that your try catch block is guarding something going wrong during a string to a string assignment."}, {"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1487201920, "post_id": 42262033, "comment_id": 71681863, "body": "Can you do a global search for &quot;SelectedFile&quot; in your project to verify that the only occurrences are in the three places that you listed above."}, {"owner": {"reputation": 33, "user_id": 7285668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336b75a5530d9ea219067958d6559390?s=128&d=identicon&r=PG&f=1", "display_name": "stutch", "link": "https://stackoverflow.com/users/7285668/stutch"}, "reply_to_user": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1487202176, "post_id": 42262033, "comment_id": 71681937, "body": "@RossBush I have it in two other place, in a check of <code>if (string.IsNullOrEmpty(SelectedFile))</code> and to set a textbox text <code>FilenameTextBox.Text = SelectedFile;</code>"}, {"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1487202382, "post_id": 42262033, "comment_id": 71682004, "body": "The code that you submitted looks ok besides changing your event handler from protected to private, I don&#39;t see anything that would cause the error. It is almost like you called your process file method prior to calling browse for file. Can you call your process file method multiple times while only selecting the file initially?"}, {"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1487202561, "post_id": 42262033, "comment_id": 71682057, "body": "Also see if this line works --&gt; new PdfReader(LoadFileDialog.FileName);. If it you do not get an error then there is an error somewhere else in your code."}, {"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1487203102, "post_id": 42262033, "comment_id": 71682237, "body": "One last one, are you using UNC file paths?"}, {"owner": {"reputation": 33, "user_id": 7285668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336b75a5530d9ea219067958d6559390?s=128&d=identicon&r=PG&f=1", "display_name": "stutch", "link": "https://stackoverflow.com/users/7285668/stutch"}, "reply_to_user": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1487205998, "post_id": 42262033, "comment_id": 71683081, "body": "@RossBush neither of these helped unfortunately."}], "answers": [{"tags": [], "owner": {"reputation": 49855, "user_id": 5862071, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/II4q8.jpg?s=128&g=1", "display_name": "Ousmane D.", "link": "https://stackoverflow.com/users/5862071/ousmane-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1487201453, "creation_date": 1487201453, "answer_id": 42262097, "question_id": 42262033, "link": "https://stackoverflow.com/questions/42262033/itextsharp-system-io-filenotfoundexception/42262097#42262097", "title": "iTextSharp System.IO.FileNotFoundException", "body": "<p>If you're completely sure that the path you've specified is correct even though that is probably unlikely then I can suggest you use either:</p>\n\n<p>Request.PhysicalApplicationPath(\"enter path here\"); </p>\n\n<p>Server.MapPath(\"enter path here\");</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 7285668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336b75a5530d9ea219067958d6559390?s=128&d=identicon&r=PG&f=1", "display_name": "stutch", "link": "https://stackoverflow.com/users/7285668/stutch"}, "is_accepted": true, "score": 1, "last_activity_date": 1487206341, "creation_date": 1487206341, "answer_id": 42262907, "question_id": 42262033, "link": "https://stackoverflow.com/questions/42262033/itextsharp-system-io-filenotfoundexception/42262907#42262907", "title": "iTextSharp System.IO.FileNotFoundException", "body": "<p>The issue here was that the <code>itextsharp.dll</code> needs to be in the same directory as the built .exe.</p>\n"}], "owner": {"reputation": 33, "user_id": 7285668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336b75a5530d9ea219067958d6559390?s=128&d=identicon&r=PG&f=1", "display_name": "stutch", "link": "https://stackoverflow.com/users/7285668/stutch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 42262907, "answer_count": 2, "score": 0, "last_activity_date": 1487206341, "creation_date": 1487201117, "question_id": 42262033, "link": "https://stackoverflow.com/questions/42262033/itextsharp-system-io-filenotfoundexception", "title": "iTextSharp System.IO.FileNotFoundException", "body": "<p>I am getting a System.IO.FileNotFoundException on the release build of the below but not getting it while debugging.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Navigation;\nusing System.Windows.Shapes;\nusing System.Windows.Forms;\nusing System.Text.RegularExpressions;\nusing Microsoft.Office.Interop.Word;\nusing System.IO;\nusing iTextSharp.text.pdf;\nusing iTextSharp.text.pdf.parser;\nusing iTextSharp.text.xml;\nusing Microsoft.VisualBasic;\n\nnamespace CountingTool\n{\n    public partial class MainWindow : System.Windows.Window\n    {\n        private string SelectedFile;\n\n        public MainWindow()\n        {\n            InitializeComponent();\n        }        \n\n        private void LoadFileButton_Click(object sender, System.EventArgs e)\n        {\n            OpenFileDialog LoadFileDialog = new OpenFileDialog();\n\n            LoadFileDialog.Title = \"Select file\";\n            LoadFileDialog.Filter = \"PDF files|*.pdf\";\n            LoadFileDialog.InitialDirectory = @\"C:\\\";\n\n            if (LoadFileDialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n            {\n                try\n                {\n                    SelectedFile = LoadFileDialog.FileName;\n                 }\n                catch (Exception ex)\n                {\n                    System.Windows.Forms.MessageBox.Show(\"Error: Could not read file from disk. Original error: \" + ex.Message);\n                }\n            }\n        }\n\n        private void CountEach()\n        {\n            string FullPdf = ExtractFullPdf();\n            ...\n        }\n\n        private string ExtractFullPdf()\n        {\n            PdfReader sourceDocument = new PdfReader(SelectedFile);\n            StringBuilder text = new StringBuilder();\n\n            for (int i = 1; i &lt;= sourceDocument.NumberOfPages; i++)\n            {\n                text.Append(PdfTextExtractor.GetTextFromPage(sourceDocument, i));\n            }\n\n            sourceDocument.Close();\n            return text.ToString();\n        }\n}\n</code></pre>\n\n<p>The line that seems to be causing the issue is <code>PdfReader sourceDocument = new PdfReader(SelectedFile);</code>. </p>\n\n<p>Any thoughts would be greatly appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", ".net", "ziparchive", "argumentexception", "illegal-characters"], "comments": [{"owner": {"reputation": 269390, "user_id": 98713, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f4acdb91aba11ddf8f03d4b12453f3d5?s=128&d=identicon&r=PG", "display_name": "Thomas Levesque", "link": "https://stackoverflow.com/users/98713/thomas-levesque"}, "edited": false, "score": 0, "creation_date": 1487202151, "post_id": 42262013, "comment_id": 71681927, "body": "Have you tried with a different library, e.g. DotNetZip or SharpZipLib?"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487204108, "post_id": 42262013, "comment_id": 71682522, "body": "This is a known bug. You&#39;ll have to use some library other than .NET, one which can accommodate .zip archives that have entries with names that don&#39;t comply with the Windows rules. <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/808187/ziparchive-does-not-handle-archives-containing-items-with-names-that-have-windows-prohibited-characters-in-them\" rel=\"nofollow noreferrer\">connect.microsoft.com/VisualStudio/feedback/details/808187/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 7169215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/anaCW.jpg?s=128&g=1", "display_name": "Juan Luis Hidalgo", "link": "https://stackoverflow.com/users/7169215/juan-luis-hidalgo"}, "edited": false, "score": 0, "creation_date": 1487205921, "post_id": 42262013, "comment_id": 71683051, "body": "We are currently using SharpZipLib, and it works very well, but we have had some problems recently with some zip files, the effect we are observing is similar to ZipBomb, but in this case, the zip files are corrupted, other libraries are able to identify these quickly, but SharpZipLib cannot, and it goes through an infinite loop adding and adding bytes to the extracted file in the hard drive until it runs out of space. So we are evaluating other libraries, and that is how we come up with Microsoft&#39;s zip library."}, {"owner": {"reputation": 31, "user_id": 7169215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/anaCW.jpg?s=128&g=1", "display_name": "Juan Luis Hidalgo", "link": "https://stackoverflow.com/users/7169215/juan-luis-hidalgo"}, "edited": false, "score": 0, "creation_date": 1487206519, "post_id": 42262013, "comment_id": 71683247, "body": "Hey Peter, your link is very useful, thanks for sharing it, and it is a shame that this bug is not going to be fixed in .NET any soon. Apart of this problem, the library worked very well to us during the proof of concept as the replacement of SharpZipLib.  Oh man, I&#39;ll have to look for another option."}, {"owner": {"reputation": 269390, "user_id": 98713, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f4acdb91aba11ddf8f03d4b12453f3d5?s=128&d=identicon&r=PG", "display_name": "Thomas Levesque", "link": "https://stackoverflow.com/users/98713/thomas-levesque"}, "edited": false, "score": 1, "creation_date": 1487207565, "post_id": 42262013, "comment_id": 71683557, "body": "The issue on Connect is closed as &quot;won&#39;t fix&quot; (as is often the case on Connect), but it seems to have been fixed in .NET Core: <a href=\"https://github.com/dotnet/corefx/issues/4991\" rel=\"nofollow noreferrer\">github.com/dotnet/corefx/issues/4991</a>"}, {"owner": {"reputation": 31, "user_id": 7169215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/anaCW.jpg?s=128&g=1", "display_name": "Juan Luis Hidalgo", "link": "https://stackoverflow.com/users/7169215/juan-luis-hidalgo"}, "edited": false, "score": 0, "creation_date": 1487374560, "post_id": 42262013, "comment_id": 71773226, "body": "Thanks Thomas, your answer is much appreciated."}], "answers": [{"tags": [], "owner": {"reputation": 479, "user_id": 12508260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528eb34ff1053a8e0a203bb19223b120?s=128&d=identicon&r=PG&f=1", "display_name": "Jon R", "link": "https://stackoverflow.com/users/12508260/jon-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1589489010, "last_edit_date": 1589489010, "creation_date": 1589332939, "answer_id": 61764786, "question_id": 42262013, "link": "https://stackoverflow.com/questions/42262013/how-can-i-get-the-valid-entries-of-a-ziparchive-when-one-them-contains-illegal-c/61764786#61764786", "title": "How can I get the valid Entries of a ZipArchive when one them contains illegal characters?", "body": "<p>Using System.Reflection you can at least hide the errors, although you only get entries up to the one with the path containing illegal characters.</p>\n\n<p>Add this class and use archive.GetRawEntries() instead of archive.Entries</p>\n\n<pre><code>public static class ZipArchiveHelper\n{\n    private static FieldInfo _Entries;\n    private static MethodInfo _EnsureDirRead;\n    static ZipArchiveHelper()\n    {\n        _Entries = typeof(ZipArchive).GetField(\"_entries\", BindingFlags.NonPublic | BindingFlags.Instance);\n        _EnsureDirRead = typeof(ZipArchive).GetMethod(\"EnsureCentralDirectoryRead\", BindingFlags.NonPublic | BindingFlags.Instance);\n    }\n    public static List&lt;ZipArchiveEntry&gt; GetRawEntries(this ZipArchive archive)\n    {\n        try { _EnsureDirRead.Invoke(archive, null); } catch { }\n        return (List&lt;ZipArchiveEntry&gt;)_Entries.GetValue(archive);\n    }\n}\n</code></pre>\n\n<p>The try-catch is ugly and you could catch a specific exceptions if it bugs you.\nAccording to the comments above, this is fixed in .NET Core. (<strong>UPDATE:</strong> Confirmed this is fixed in .Net Core 3.1, maybe earlier).</p>\n\n<p>Credit for this (partial) fix to <a href=\"https://www.codeproject.com/Tips/1007398/Avoid-Illegal-Characters-in-Path-error-in-ZipArchi\" rel=\"nofollow noreferrer\">https://www.codeproject.com/Tips/1007398/Avoid-Illegal-Characters-in-Path-error-in-ZipArchi</a> and <a href=\"https://gist.github.com/rdavisau/b66df9c99a4b11c5ceff\" rel=\"nofollow noreferrer\">https://gist.github.com/rdavisau/b66df9c99a4b11c5ceff</a></p>\n\n<p>More pointers on fixing paths with illegal characters (not just zip files) at <a href=\"https://stackoverflow.com/questions/23407717/zipfile-extracttodirectory-illegal-characters-in-path\">ZipFile.ExtractToDirectory &quot;Illegal characters in path&quot;</a></p>\n"}], "owner": {"reputation": 31, "user_id": 7169215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/anaCW.jpg?s=128&g=1", "display_name": "Juan Luis Hidalgo", "link": "https://stackoverflow.com/users/7169215/juan-luis-hidalgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1895, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1589489010, "creation_date": 1487201014, "last_edit_date": 1487201466, "question_id": 42262013, "link": "https://stackoverflow.com/questions/42262013/how-can-i-get-the-valid-entries-of-a-ziparchive-when-one-them-contains-illegal-c", "title": "How can I get the valid Entries of a ZipArchive when one them contains illegal characters?", "body": "<p>I am using System.IO.Compression to extract the content of some Zip files. The problem is that whenever there is an entry with a filename that contains some Windows' illegal characters then an exception is thrown. I have tried several things but I still didn't find any way to disregard the bad entries and extract those that are good. Please, consider that modifying the content of the zip file is not a possibility for the type of processing we are performing, so I must process the file as it is.</p>\n\n<p>The system usually processes files with several entries, this number is variable, but it could be up to 300 entries in one zip file, and occasionally there will be an entry with a filename such as <code>'myfile&lt;name&gt;.txt'</code>, which contains angle brackets that are clearly illegal characters for Windows. I really want to disregard this entry and move on to extract the rest of the entries within the ZipArchive. But it looks that this is not possible.</p>\n\n<p>Any idea on how to disregard the bad entries of a ZipArchive?</p>\n\n<p>So far I have tried different things to get the entries separately, but I am always getting the exact same exception error.</p>\n\n<p>Here are some of the things I have tried so far: </p>\n\n<ul>\n<li><p>Implementing the regular way to iterate over the entries:</p>\n\n<pre><code>foreach (ZipArchiveEntry entry in ZipArchive.Entries)\n</code></pre></li>\n<li><p>Trying to get only one entry by index (same exception here even though the first entry is a valid one):</p>\n\n<pre><code>ZipArchiveEntry entry = ZipArchive.Entries[0]\n</code></pre></li>\n<li><p>Applying a filter using a lambda expression to disregard the invalid entries (same exception also):</p>\n\n<pre><code>var entries = zipArchive.Entries.Where(a =&gt; \na.FullName.IndexOfAny(Path.GetInvalidFileNameChars() ) == -1);\n</code></pre></li>\n</ul>\n\n<p>Nothing of this helps and the exception I get every single time is as follows:</p>\n\n<blockquote>\n  <p>at System.IO.Path.CheckInvalidPathChars(String path, Boolean\n  checkAdditional)    at System.IO.Path.GetFileName(String path)    at\n  System.IO.Compression.ZipHelper.EndsWithDirChar(String test)    at\n  System.IO.Compression.ZipArchiveEntry.set_FullName(String value)    at\n  System.IO.Compression.ZipArchiveEntry..ctor(ZipArchive archive,\n  ZipCentralDirectoryFileHeader cd)    at\n  System.IO.Compression.ZipArchive.ReadCentralDirectory()    at\n  System.IO.Compression.ZipArchive.get_Entries()    at\n  ZipLibraryConsole.MicrosoftExtraction.RecursiveExtract(Stream\n  fileToExtract, Int32 maxDepthLevel, Attachment att) in\n  C:\\Users\\myUser\\Documents\\Visual Studio\n  2015\\Projects\\ZipLibraryConsole\\ZipLibraryConsole\\MicrosoftExtraction.cs:line\n  47</p>\n</blockquote>\n\n<p>This is a snippet of the implemented code:</p>\n\n<pre><code>var zipArchive = new ZipArchive(fileToExtract, ZipArchiveMode.Read);\n  try\n    {\n      foreach (var zipEntry in zipArchive.Entries) // the exception is thrown  here, there is no chance to process valid entries at all\n      {\n        // Do something and extract the file\n      }\n    catch (ArgumentException exception)\n    {\n      Console.WriteLine(\n        String.Format(\"Failed to complete the extraction. At least one path contains invalid characters for the Operating System: {0}{1}\",                       att.Name, att.Extention));\n     }\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 797, "user_id": 2756489, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/p7Fwh.png?s=128&g=1", "display_name": "Bennett Yeo", "link": "https://stackoverflow.com/users/2756489/bennett-yeo"}, "edited": false, "score": 0, "creation_date": 1487201185, "post_id": 42261960, "comment_id": 71681620, "body": "Take a look at <a href=\"https://stackoverflow.com/questions/13509532/how-to-find-and-replace-text-in-a-file-with-c-sharp\">this Stackoverflow question</a>"}, {"owner": {"reputation": 2021, "user_id": 1518100, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EW5RK.jpg?s=128&g=1", "display_name": "Lei Yang", "link": "https://stackoverflow.com/users/1518100/lei-yang"}, "edited": false, "score": 0, "creation_date": 1487207428, "post_id": 42261960, "comment_id": 71683521, "body": "No need put &#39;batch file&#39; here, I think."}, {"owner": {"reputation": 143, "user_id": 5754913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09634e922fce794090f58065e2ffa5a1?s=128&d=identicon&r=PG&f=1", "display_name": "Kristof.V", "link": "https://stackoverflow.com/users/5754913/kristof-v"}, "reply_to_user": {"reputation": 2021, "user_id": 1518100, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/EW5RK.jpg?s=128&g=1", "display_name": "Lei Yang", "link": "https://stackoverflow.com/users/1518100/lei-yang"}, "edited": false, "score": 0, "creation_date": 1487244993, "post_id": 42261960, "comment_id": 71701620, "body": "@Lei Yang , i just putted it there for the people that know batch so they kbow exactly what i mean :)"}, {"owner": {"reputation": 143, "user_id": 5754913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09634e922fce794090f58065e2ffa5a1?s=128&d=identicon&r=PG&f=1", "display_name": "Kristof.V", "link": "https://stackoverflow.com/users/5754913/kristof-v"}, "reply_to_user": {"reputation": 797, "user_id": 2756489, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/p7Fwh.png?s=128&g=1", "display_name": "Bennett Yeo", "link": "https://stackoverflow.com/users/2756489/bennett-yeo"}, "edited": false, "score": 0, "creation_date": 1487245852, "post_id": 42261960, "comment_id": 71702243, "body": "@Bennett Yeo , i dont need to change a text i need to change number behind a text &quot;X and/or Y&quot; and that can be different from 0.000 to 9000.000"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 5754913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09634e922fce794090f58065e2ffa5a1?s=128&d=identicon&r=PG&f=1", "display_name": "Kristof.V", "link": "https://stackoverflow.com/users/5754913/kristof-v"}, "edited": false, "score": 0, "creation_date": 1487245685, "post_id": 42262104, "comment_id": 71702135, "body": "I&#39;ll check this evening how i can use that in my code,  not used to code with regex codes :)"}], "tags": [], "owner": {"reputation": 348, "user_id": 2431645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/hrRUl.png?s=128&g=1", "display_name": "GY_", "link": "https://stackoverflow.com/users/2431645/gy"}, "is_accepted": true, "score": 1, "last_activity_date": 1487201907, "last_edit_date": 1487201907, "creation_date": 1487201492, "answer_id": 42262104, "question_id": 42261960, "link": "https://stackoverflow.com/questions/42261960/edit-part-of-text-in-text-file-using-c/42262104#42262104", "title": "edit part of text in text file using C#", "body": "<blockquote>\n  <p>but not about to change something behind a specified text.</p>\n</blockquote>\n\n<p>Try this regex <code>(?&lt;=X)[0-9\\.]+(?= )</code>\nIt will help you find the number behind X.</p>\n\n<blockquote>\n  <p>N9 G00 X<strong>2675.766</strong> Y427.409 Z730</p>\n</blockquote>\n\n<p>You can try <a href=\"https://regex101.com/r/zeflVd/1\" rel=\"nofollow noreferrer\">regex101.com</a>. It will clearly explain the code.</p>\n"}], "owner": {"reputation": 143, "user_id": 5754913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09634e922fce794090f58065e2ffa5a1?s=128&d=identicon&r=PG&f=1", "display_name": "Kristof.V", "link": "https://stackoverflow.com/users/5754913/kristof-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 42262104, "answer_count": 1, "score": 1, "last_activity_date": 1487201907, "creation_date": 1487200772, "question_id": 42261960, "link": "https://stackoverflow.com/questions/42261960/edit-part-of-text-in-text-file-using-c", "title": "edit part of text in text file using C#", "body": "<p>I'm looking for a way to find a part of text and change the number behind the text using C#</p>\n\n<p>I've made it work in a .batch program but i would like to make it more proper in visual studio.</p>\n\n<p>This is the kind of text file where i need to be able to change the number afther X or/and Y: (with change i mean add a specific number to the number there already us)</p>\n\n<pre><code>N1 G17 G90\nN3 G54\nN5 S24000\nN7 M03\nN9 G00 X2675.766 Y427.409 Z730\nN11 G00 X2675.766 Y427.409\nN13 G00 X2675.766 Y427.409\nN15 G00 X2675.766 Y427.409 Z505\nN17 F4000\nN19 G01 X2675.766 Y427.409 Z447.5\nN21 F4000\nN23 G01 X2565.966 Y475.823 Z447.5\nN25 F4000\nN27 G02 X1852.832 Y871.38 Z447.5 I4373.42 J4575.032\nN29 G03 X705.065 Y871.38 Z447.5 I1278.948 J28.138\nN31 G02 X-8.069 Y475.823 Z447.5 I-1815.523 J4575.032\nN33 M05\nN35 M30\n</code></pre>\n\n<p>this is how the batch file works at the moment.</p>\n\n<pre><code>@echo off\nsetlocal EnableDelayedExpansion\necho[\necho[\nset /p file=\"file name? = \"\necho[\necho[\nset /p Xdir=\"X + :\"\necho[\necho[\nset /p Ydir=\"Y + :\"\n\n\n(for /F \"tokens=1-4*\" %%a in (%file%.nc) do (\n   if \"%%d\" equ \"\" (\n      echo %%a %%b %%c\n   ) else (\n      for /F \"tokens=1,2 delims=X.\" %%C in (\"%%c\") do (\n         set /A X=%%C+%Xdir%\n         if \"%%D\" neq \"\" set \"X=!X!.%%D\"\n      )\n      for /F \"tokens=1,2 delims=Y.\" %%D in (\"%%d\") do (\n         set /A Y=%%D+%Ydir%\n         if \"%%E\" neq \"\" set \"Y=!Y!.%%E\"\n      )\n      echo %%a %%b X!X! Y!Y! %%e\n   )\n)) &gt; %file%_ar.nc\necho je Your new file \" %file%_ar.nc \" is created.\npause\n</code></pre>\n\n<p>in my Visual studio i got :\n2 text fields for X and/or Y. named Xdir_btn,Ydir_btn\n1 btn called Generate. named Generate_btn\n1 richtextBox. named RichTextBox (this is where my text file gets in when i open it).\nThere are enoguh tutorials online to find and replace a specified text, but not about to change something behind a specified text.</p>\n"}, {"tags": ["c#", "asp.net-web-api"], "comments": [{"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1487211610, "post_id": 42261888, "comment_id": 71684563, "body": "The problem is not max allowed content length. It is the URL length. Which maxes out at around 2,000 characters. You may need to POST your input in the body of the request."}, {"owner": {"reputation": 1891, "user_id": 2891081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0c9047f1344aed308ca82e4f64fc9d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2891081/dave"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1487261515, "post_id": 42261888, "comment_id": 71714681, "body": "Thanks. I was trying to build a quick Proof of Concept for something and was hoping I could do this instead of fighting with CORS."}], "answers": [{"tags": [], "owner": {"reputation": 1891, "user_id": 2891081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0c9047f1344aed308ca82e4f64fc9d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2891081/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1487276405, "creation_date": 1487276405, "answer_id": 42283821, "question_id": 42261888, "link": "https://stackoverflow.com/questions/42261888/how-to-increase-parameter-length-in-web-api/42283821#42283821", "title": "How to increase parameter length in WEB API", "body": "<p>Ended up stumbling across something that worked.</p>\n\n<p><a href=\"https://blogs.msdn.microsoft.com/amyd/2014/02/06/response-400-bad-request-on-long-url/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/amyd/2014/02/06/response-400-bad-request-on-long-url/</a></p>\n\n<p>Need to add or update the following registry key:</p>\n\n<blockquote>\n  <p>HKLM:\\System\\CurrentControlSet\\Services\\HTTP\\Parameters\\UrlSegmentMaxLength</p>\n</blockquote>\n\n<p>Also still need to do: </p>\n\n<pre><code>&lt;httpRuntimetargetFramework=\"4.5\" maxUrlLength=\"2083\" maxQueryStringLength=\"2048\" /&gt;\n</code></pre>\n\n<p>Lastly restart the http service. Just like the author, I could not get this to work, so I simply rebooted. </p>\n"}], "owner": {"reputation": 1891, "user_id": 2891081, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0c9047f1344aed308ca82e4f64fc9d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/2891081/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487276405, "creation_date": 1487200412, "question_id": 42261888, "link": "https://stackoverflow.com/questions/42261888/how-to-increase-parameter-length-in-web-api", "title": "How to increase parameter length in WEB API", "body": "<p>I am trying to get my WEB API to accept long request strings, but no matter what I try, I end up getting a 400 Bad Request. My method is accessed via: </p>\n\n<blockquote>\n  <p><a href=\"http://server/api/controller/method/\" rel=\"nofollow noreferrer\">http://server/api/controller/method/</a>{input}</p>\n</blockquote>\n\n<p>The code is </p>\n\n<pre><code>[HttpGet]\npublic IHttpActionResult method(string input) {\n   //Do Stuff\n   return Ok();\n}\n</code></pre>\n\n<p>The following type of call will work just fine. </p>\n\n<blockquote>\n  <p><a href=\"http://server/api/controller/ShortInputString\" rel=\"nofollow noreferrer\">http://server/api/controller/ShortInputString</a></p>\n</blockquote>\n\n<p>However something like: </p>\n\n<blockquote>\n  <p><a href=\"http://server/api/controller/SuperHugeReallyReallyLongInputString\" rel=\"nofollow noreferrer\">http://server/api/controller/SuperHugeReallyReallyLongInputString</a></p>\n</blockquote>\n\n<p>results in a 400 Bad Request.</p>\n\n<p>From my understanding, this is because the there is a max length that my input argument can have. I have tried increasing this in the following ways found in other Stack Overflow posts, yet none of them work. </p>\n\n<pre><code>&lt;httpRuntime targetFramework=\"4.5.2\" maxRequestLength=\"4096\"/&gt; //in web.config\n\n    &lt;security&gt;\n  &lt;requestFiltering&gt;\n    &lt;requestLimits maxAllowedContentLength=\"52428800\" /&gt;\n    &lt;!--50MB--&gt;\n  &lt;/requestFiltering&gt;\n&lt;/security&gt; //also in web.config \n\n\nconfig.Formatters.FormUrlEncodedFormatter.ReadBufferSize = int.MaxValue / 10; //in WebApiConfig.cs \n</code></pre>\n\n<p>None of the above seem to have any impact on the max length the input can be. What am I missing? </p>\n\n<p>Thanks </p>\n"}, {"tags": ["c#", "wpf", "collections"], "comments": [{"owner": {"reputation": 348, "user_id": 2431645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/hrRUl.png?s=128&g=1", "display_name": "GY_", "link": "https://stackoverflow.com/users/2431645/gy"}, "edited": false, "score": 0, "creation_date": 1487200934, "post_id": 42261865, "comment_id": 71681519, "body": "Will a <code>List&lt;StockInfo1&gt;</code> solve your problem?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5043982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b5699bfa7b189ad3670177aaf29aa81?s=128&d=identicon&r=PG&f=1", "display_name": "Mano Appapillai", "link": "https://stackoverflow.com/users/5043982/mano-appapillai"}, "edited": false, "score": 0, "creation_date": 1487214980, "post_id": 42262011, "comment_id": 71685486, "body": "Further clarification: Data comes from the exchanges(NYSE, CME, NASDAQ etc). Every second/minute real time, a quote with a  (symbol, price, time). The right collection has to be located and the quote added to the collection. In Microsoft&#39;s Dynamic Data Display ObservableData Source has an AppendAsync function that allows chart data to be added asynchronously Handy when there is lots of data coming in as a steady stream. Currently I read the symbol, identify Collection (StockInfo1, StockInfo2,  . . 20) and add datapoint to be charted."}], "tags": [], "owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "is_accepted": false, "score": 1, "last_activity_date": 1487201011, "creation_date": 1487201011, "answer_id": 42262011, "question_id": 42261865, "link": "https://stackoverflow.com/questions/42261865/c-class-addition-to-collection/42262011#42262011", "title": "C# Class addition to collection", "body": "<p>Just have a class for the stock  </p>\n\n<pre><code>public class Stock\n{\n    public string Symbol { get; set; }\n    public ObservableCollection&lt;StockInfo&gt; StockInfos { get; } = new ObservableCollection&lt;StockInfo&gt;();\n}    \n\npublic class StockInfo\n{\n    public DateTime Time { get; set; }\n    public double Price { get; set; }\n    public double Range { get; set; }\n}\n</code></pre>\n\n<p>then in the main class </p>\n\n<pre><code>public ObservableCollection&lt;Stock&gt; Stocks { get; } = new ObservableCollection&lt;Stock&gt;();\n</code></pre>\n\n<p>no need for this <code>AppendAsync</code> stuff</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 6559715, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pAHRKVcH-zQ/AAAAAAAAAAI/AAAAAAAAAlg/I852xfmsK8Q/photo.jpg?sz=128", "display_name": "Matz Reckeweg", "link": "https://stackoverflow.com/users/6559715/matz-reckeweg"}, "is_accepted": false, "score": 1, "last_activity_date": 1487201935, "creation_date": 1487201935, "answer_id": 42262172, "question_id": 42261865, "link": "https://stackoverflow.com/questions/42261865/c-class-addition-to-collection/42262172#42262172", "title": "C# Class addition to collection", "body": "<p>you dont need <code>StockInfo2</code>\njust use a list or an array</p>\n\n<pre><code>public List&lt;ObservableDataSource&lt;StockInfo&gt;&gt; StockList = new List&lt;ObservableDataSource&lt;StockInfo&gt;&gt;();\n</code></pre>\n\n<p>then you can use </p>\n\n<pre><code>var info = new ObservableDataSource&lt;StockInfo&gt;&gt;(new StockInfo {\n    Time = DateTime.Now,\n    Price = 20\n})\nStockList.add(info);\n</code></pre>\n\n<p>to add a new Stock to your List</p>\n\n<p>or you write a function to add a new StockInfo</p>\n\n<pre><code>public void addStockInfo(Double price,DateTime time){\n    StockList.add(new ObservableDataSource&lt;StockInfo&gt;&gt;(new StockInfo {\n        Time = time,\n        Price = price\n    });\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5043982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b5699bfa7b189ad3670177aaf29aa81?s=128&d=identicon&r=PG&f=1", "display_name": "Mano Appapillai", "link": "https://stackoverflow.com/users/5043982/mano-appapillai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487201935, "creation_date": 1487200308, "question_id": 42261865, "link": "https://stackoverflow.com/questions/42261865/c-class-addition-to-collection", "title": "C# Class addition to collection", "body": "<pre><code>using System;\nusing System.Windows;\nusing System.Collections.Generic;\nusing Microsoft.Research.DynamicDataDisplay.DataSources;\nusing System.Windows.Threading;\n\nnamespace ClassReferenceStackOverFlow\n{\n\npublic partial class MainWindow : Window\n{\n    public ObservableDataSource&lt;StockInfo1&gt; stockData1 = null;\n    public MainWindow()\n    {\n        InitializeComponent();\n\n        DateTime time = DateTime.Now;\n        double price = 180.00; // IBM stock price\n        StockInfo1 info = new StockInfo1 { Time = time, Price = price };\n        stockData1.AppendAsync(Dispatcher, info);\n    }\n\n    public class StockInfo1\n    {\n        public DateTime Time { get; set; }\n        public double Price { get; set; }\n        public double Range { get; set; }\n    }\n}\n}\n</code></pre>\n\n<p>I am fairly new to C#/WPF. Would like to have many stocks tracked/charted(here for example: IBM as StockInfo1). How can I accomplish neatly without creating ugly StockInfo2, StockInfo3 etc. ?\nBeen searching and trying several options but many beyond my limited knowledge of C#.\nThanks for any direction/example/code snippets in advance</p>\n"}, {"tags": ["c#", "jquery", ".net", "jquery-ui", "jquery-ui-sortable"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 2398500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/igZI3.png?s=128&g=1", "display_name": "Andrew Mcghie", "link": "https://stackoverflow.com/users/2398500/andrew-mcghie"}, "is_accepted": false, "score": 0, "last_activity_date": 1487207396, "creation_date": 1487207396, "answer_id": 42263055, "question_id": 42261535, "link": "https://stackoverflow.com/questions/42261535/how-to-save-net-gridview-row-order-to-database-after-reordering-using-jquery-so/42263055#42263055", "title": "How to save .NET Gridview row order to database after reordering using JQuery Sortable", "body": "<p>The jquery sortable as an update event that gets triggered every time the you drop an element. It also has a toArray method which returns an array of the ids of the elements in the order which they currently appear.\nPutting this with AJAX you can do something like this to call server side code.\nThis passes the array of ids as a json string that will need to be decoded server side.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$(function () {\r\n  $(\".sortable\").sortable({\r\n    items: \"tr:not(tr:first-child)\",\r\n    axis: \"y\",\r\n    update: function(event, ui) {\r\n      var sortedIDs = $(event.target).sortableGrid( \"toArray\" );\r\n      $.ajax({\r\n        url: your url,\r\n        data: JSON.stringify(sortedIDs)\r\n      });\r\n    }\r\n  }).disableSelection();\r\n});</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Sorry I don't know .NET so I cant help you server side but hope this helps.</p>\n"}], "owner": {"reputation": 1109, "user_id": 2706919, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/623320009/picture?type=large", "display_name": "Simon", "link": "https://stackoverflow.com/users/2706919/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 714, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487207396, "creation_date": 1487198751, "question_id": 42261535, "link": "https://stackoverflow.com/questions/42261535/how-to-save-net-gridview-row-order-to-database-after-reordering-using-jquery-so", "title": "How to save .NET Gridview row order to database after reordering using JQuery Sortable", "body": "<p>I have a database table that contains two fields, <code>ColumnName</code> and <code>SortOrder</code>.</p>\n\n<p>I am using a gridview to display the ColumnName field on a page of a C# .NET web application.</p>\n\n<p>I would like the user to be able reorder the rows by dragging and dropping the gridview rows, and then save this new order to the database by inserting the new row number into the SortOrder field in the DB table.</p>\n\n<p>I have managed to get the drag and drop feature to work using <code>JQueryUI Sortable</code>. But I am struggling to get the new order of the rows server side so I can get it into the database.</p>\n\n<p><strong>Gridview Code</strong></p>\n\n<pre><code>&lt;asp:GridView ID=\"GV_ColumnNames\" runat=\"server\" CssClass=\"sortable\"&gt;\n    &lt;Columns&gt;\n        &lt;asp:BoundField DataField=\"ColumnName\" HeaderText=\"ColumnName\" SortExpression=\"ColumnName\" /&gt;\n    &lt;/Columns&gt;\n&lt;/asp:GridView&gt;\n</code></pre>\n\n<p><strong>JQuery</strong></p>\n\n<pre><code>    $(function () {\n\n        $(\".sortable\").sortable({\n            items: \"tr:not(tr:first-child)\",\n            axis: \"y\"\n        }).disableSelection();\n\n    });\n</code></pre>\n\n<p>As a test to see if I can get the new row order clientside i wrote the C# code below but this just outputs the original row order.</p>\n\n<pre><code>    protected void BTN_Confirm_Click(object sender, EventArgs e)\n    {\n        string orderTest = \"\";\n\n        foreach(GridViewRow row in GV_FlatFileColumnSetting.Rows)\n        {\n            orderTest += row.Cells[0].Text;\n        }\n\n        Response.Write(orderTest);\n\n    }\n</code></pre>\n\n<p>Does anybody have any ideas as to how I can get the row order from client side to server side so I can run an SQL Command to insert the new order into a DB?</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["c#", "entity-framework", "linq"], "answers": [{"tags": [], "owner": {"reputation": 4535, "user_id": 25650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f52d9bce4427e6a0e36a0f7d78ec6ae?s=128&d=identicon&r=PG", "display_name": "Andrew Lewis", "link": "https://stackoverflow.com/users/25650/andrew-lewis"}, "is_accepted": false, "score": 5, "last_activity_date": 1487198875, "last_edit_date": 1487198875, "creation_date": 1487198818, "answer_id": 42261544, "question_id": 42261515, "link": "https://stackoverflow.com/questions/42261515/how-can-i-combine-two-entity-framework-calls-into-one/42261544#42261544", "title": "How can I combine two Entity Framework calls into one?", "body": "<pre><code>var result = (from b in context.TRANSPORT_PLANNER_TRACK_CAP\n              where b.WAREHOUSE.Equals(warehouse)\n              select new { b.MAX_VOLUME, b.MAX_WEIGHT}).SingleOrDefault();\n</code></pre>\n\n<p>Then just reference it as:</p>\n\n<pre><code>result.MAX_WEIGHT or result.MAX_VOLUME\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7392784, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/deb6de7e087e48d2a2fbf099e73dfe2e?s=128&d=identicon&r=PG&f=1", "display_name": "doodles", "link": "https://stackoverflow.com/users/7392784/doodles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1487198901, "creation_date": 1487198652, "last_edit_date": 1487198901, "question_id": 42261515, "link": "https://stackoverflow.com/questions/42261515/how-can-i-combine-two-entity-framework-calls-into-one", "title": "How can I combine two Entity Framework calls into one?", "body": "<p>So I have the following code:</p>\n\n<pre><code>    var MAX_VOLUME = (from b in context.TRANSPORT_PLANNER_TRACK_CAP.Where(b =&gt; b.WAREHOUSE.Equals(warehouse)) select b.MAX_VOLUME).SingleOrDefault();\n    var MAX_WEIGHT = (from b in context.TRANSPORT_PLANNER_TRACK_CAP.Where(b =&gt; b.WAREHOUSE.Equals(warehouse)) select b.MAX_WEIGHT).SingleOrDefault();\nstring maxVolume = MAX_VOLUME.ToString();\nstring maxWeight = MAX_WEIGHT.ToString();\n</code></pre>\n\n<p>I want to combine these two statements into a single EF call, to reduce redundancy. What's the best approach? </p>\n"}, {"tags": ["c#", "vb.net"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 2, "creation_date": 1487198897, "post_id": 42261495, "comment_id": 71680773, "body": "Your question is very (too) broad.  a) What are you going to do with the ID?    How is that &quot;security&quot;? How would it replace a user log on? b) an MD5 hash is not encryption, its a hash, c) MD5 is outdated.  Also, please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">Tour</a>"}, {"owner": {"reputation": 75, "user_id": 5280130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-tQpgiDPwyk8/AAAAAAAAAAI/AAAAAAAAAFw/eOM2gfDJt6Q/photo.jpg?sz=128", "display_name": "Kenion", "link": "https://stackoverflow.com/users/5280130/kenion"}, "edited": false, "score": 0, "creation_date": 1487199081, "post_id": 42261495, "comment_id": 71680854, "body": "<a href=\"http://stackoverflow.com/questions/31746613/how-do-i-get-a-unique-identifier-for-a-device-within-windows-10-universal\" title=\"how do i get a unique identifier for a device within windows 10 universal\">stackoverflow.com/questions/31746613/&hellip;</a> check the answer someone explain how to get the HWID"}, {"owner": {"reputation": 39, "user_id": 5810136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8d468c3cfd1dc8c2db2bba29074ed90?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago Turella", "link": "https://stackoverflow.com/users/5810136/tiago-turella"}, "edited": false, "score": 0, "creation_date": 1487199570, "post_id": 42261495, "comment_id": 71681052, "body": "I&#39;ve read all those questions and didn&#39;t help me quite well. First, since this program is just to be used on a single company computer, that&#39;s my purpose to use HWID. Secondly, improves security because, very often they pass the reports throught USB drives, and if anyone gets a copy, they can easly debug it and steal and finaly it wont replace the login form because I still have the login form, it&#39;s just a sort of extra verification for my purpose. You can check some code i&#39;ve tryied to explain what i really want."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1487209409, "post_id": 42261495, "comment_id": 71684033, "body": "Questions in comments are not supposed to help <i>you</i>,they help us understand what you are asking.  if you want to do that before the form loads, start your app from Sub Main and do it there.  That &quot;security&quot; is trivial to defeat though and means the user cant upgrade their hardware without causing it to not validate.  Have you considered a dongle?"}, {"owner": {"reputation": 39, "user_id": 5810136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8d468c3cfd1dc8c2db2bba29074ed90?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago Turella", "link": "https://stackoverflow.com/users/5810136/tiago-turella"}, "edited": false, "score": 0, "creation_date": 1487248285, "post_id": 42261495, "comment_id": 71704083, "body": "The hardware is from the same company that provided the software, so if there is any necessity, it would be updated.Why buying a dongle when you can create a function regarding this type of situation and save some money?"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 5810136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8d468c3cfd1dc8c2db2bba29074ed90?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago Turella", "link": "https://stackoverflow.com/users/5810136/tiago-turella"}, "is_accepted": true, "score": 0, "last_activity_date": 1487251205, "creation_date": 1487251205, "answer_id": 42275153, "question_id": 42261495, "link": "https://stackoverflow.com/questions/42261495/how-can-i-make-a-hwid-verification-before-form-load/42275153#42275153", "title": "How can I make a HWID verification before form load", "body": "<p>I've found a way to resolve my problem.\nHere is the code i made:</p>\n\n<pre><code>Dim hwid As String = String.Empty\n    Dim mc As New ManagementClass(\"win32_processor\")\n    Dim moc As ManagementObjectCollection = mc.GetInstances()\n    For Each mo As ManagementObject In moc\n        If hwid = \"\" Then\n            hwid = mo.Properties(\"processorID\").Value.ToString()\n            Exit For\n        End If\n    Next\n    Dim hash As List(Of String) = New List(Of String)(System.IO.File.ReadAllLines(\"..\\HWID.txt\"))\n\n    If Not hash.Contains(hwid) Then\n        MsgBox(\"Contact administrator to activate the hardware on the database.\", MessageBoxButtons.OK, \"INFORTGEI\")\n        If DialogResult.OK = True Then\n            Close()\n        End If\n    Else\n        MsgBox(\"Activated sucessfully!\", MessageBoxButtons.OK, \"INFORTGEI\")\n    End If\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5810136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c8d468c3cfd1dc8c2db2bba29074ed90?s=128&d=identicon&r=PG&f=1", "display_name": "Tiago Turella", "link": "https://stackoverflow.com/users/5810136/tiago-turella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 42275153, "answer_count": 1, "score": 0, "last_activity_date": 1487251205, "creation_date": 1487198585, "last_edit_date": 1487199661, "question_id": 42261495, "link": "https://stackoverflow.com/questions/42261495/how-can-i-make-a-hwid-verification-before-form-load", "title": "How can I make a HWID verification before form load", "body": "<p>First of all I want to make it clear that I'm no \"PRO\" at visual basic, neither c#. But I had this question for a few days in my head.</p>\n\n<p>\"Is it possible to verify HWID before a form load? And how it works?\"</p>\n\n<p>Since I'm creating a software for a local gym, I would like to implement some security, not just a basic \"login form\". So, it brings me to this question... How can i create a simple way to get the HWID from the CPU and verify from a plain text(maybe encripted with md5 hash) if the same value is on that list?\nI was looking for some explanation on how to do it and how to implement it on both VB.NET and C#.</p>\n\n<pre><code>Private Sub frmprincipal_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n    Dim janela As New frmLogin\n    janela.MdiParent = Me\n    janela.Show()\n    Label4.Text = \"Fa\u00e7a login!\"\n    tmrRelogio.Enabled = True\n    bttLogout.Enabled = False\n    bttLogout.Visible = False\n    Dim hwid As String = String.Empty\n    Dim mc As New ManagementClass(\"win32_processor\")\n    Dim moc As ManagementObjectCollection = mc.GetInstances()\n    For Each mo As ManagementObject In moc\n        If hwid = \"\" Then\n            hwid = mo.Properties(\"processorID\").Value.ToString()\n            Exit For\n        End If\n    Next\n    Dim request As System.Net.HttpWebRequest = System.Net.HttpWebRequest.Create(\"https://www.dropbox.com/s/zewro4zubg9qc1s/HWID.txt\")\n    Dim response As System.Net.HttpWebResponse = request.GetResponse()\n    Dim sr As System.IO.StreamReader = New System.IO.StreamReader(response.GetResponseStream())\n    Dim hwidcheck As String = sr.ReadToEnd\n    If hwidcheck.Contains(hwid) Then\n        MsgBox(\"This is the original copy!\", \"INFORTGEI\", MessageBoxButtons.OK)\n        If DialogResult.OK = True Then\n            Close()\n        End If\n    Else\n        MsgBox(\"Contact the admin to activate the copy!\", MessageBoxButtons.OK, \"INFORTGEI\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>Any advices?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "oracle", "rest"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7571618, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8e1aee37771c8cae6f6d8e2bfe83e67a?s=128&d=identicon&r=PG&f=1", "display_name": "johnquinn", "link": "https://stackoverflow.com/users/7571618/johnquinn"}, "edited": false, "score": 0, "creation_date": 1487245505, "post_id": 42261884, "comment_id": 71701995, "body": "Thanks for replying. I will follow up your suggestion."}], "tags": [], "owner": {"reputation": 2767, "user_id": 55154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fse7P.jpg?s=128&g=1", "display_name": "Fredy Treboux", "link": "https://stackoverflow.com/users/55154/fredy-treboux"}, "is_accepted": false, "score": 1, "last_activity_date": 1487200382, "creation_date": 1487200382, "answer_id": 42261884, "question_id": 42261428, "link": "https://stackoverflow.com/questions/42261428/connect-to-oracle-db-via-net-mvc/42261884#42261884", "title": "Connect to Oracle DB via .NET mvc", "body": "<p>The actual issue you have to analyze at this point is <strong>ORA-12170: TNS:Connect timeout occurred</strong>. </p>\n\n<p>You will find online that are plenty of reasons why this error might be triggered but possibly the first thing for you to check is making sure that your connection string / TNS entry is set up properly.</p>\n\n<p>Attempt to use the same connection string from the same machine but another client (e.g. sqlplus) and see if that works (to confirm that the database is up and reachable from the client computer).</p>\n"}], "owner": {"reputation": 27, "user_id": 7571618, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8e1aee37771c8cae6f6d8e2bfe83e67a?s=128&d=identicon&r=PG&f=1", "display_name": "johnquinn", "link": "https://stackoverflow.com/users/7571618/johnquinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487201445, "creation_date": 1487198290, "last_edit_date": 1487201445, "question_id": 42261428, "link": "https://stackoverflow.com/questions/42261428/connect-to-oracle-db-via-net-mvc", "title": "Connect to Oracle DB via .NET mvc", "body": "<p>I connected my C# MVC API to Oracle, however when I ran the API and tested it I got the error below. I checked .NET references and Oracle.Data.Access is installed, in addition I removed it and reinstalled Oracle.Data.Access but the same error persists. What might this be?</p>\n\n<pre><code> {\n \"Message\": \"An error has occurred.\",\n \"ExceptionMessage\": \"ORA-12170: TNS:Connect timeout occurred\",\n \"ExceptionType\": \"Oracle.DataAccess.Client.OracleException\",\n \"StackTrace\": \"   at         Oracle.DataAccess.Client.OracleException.HandleErrorHelper(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, OpoSqlValCtx* pOpoSqlValCtx, Object src, String procedure, Boolean bCheck)\\r\\n   at Oracle.DataAccess.Client.OracleException.HandleError(Int32 errCode, OracleConnection conn, IntPtr opsErrCtx, Object src)\\r\\n   at Oracle.DataAccess.Client.OracleConnection.Open()\\r\\n   at MRF_API.Controllers.ItemController.Get(String searchdesc) in C:\\\\Users\\\\nevinj\\\\Documents\\\\Visual Studio 2015\\\\Projects\\\\MRF_API\\\\MRF_API\\\\Controllers\\\\ItemController.cs:line 88\\r\\n   at lambda_method(Closure , Object , Object[] )\\r\\n   at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.&lt;&gt;c__DisplayClass10.&lt;GetExecutor&gt;b__9(Object instance, Object[] methodParameters)\\r\\n   at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments)\\r\\n   at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ExecuteAsync(HttpControllerContext controllerContext, IDictionary`2 arguments, CancellationToken cancellationToken)\\r\\n--- End of stack trace from previous location where exception was thrown ---\\r\\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\\r\\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\\r\\n   at System.Web.Http.Controllers.ApiControllerActionInvoker.&lt;InvokeActionAsyncCore&gt;d__0.MoveNext()\\r\\n--- End of stack trace from previous location where exception was thrown ---\\r\\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\\r\\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\\r\\n   at System.Web.Http.Controllers.ActionFilterResult.&lt;ExecuteAsync&gt;d__2.MoveNext()\\r\\n--- End of stack trace from previous location where exception was thrown ---\\r\\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\\r\\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\\r\\n   at System.Web.Http.Dispatcher.HttpControllerDispatcher.&lt;SendAsync&gt;d__1.MoveNext()\"\n  }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "controller", "asp.net-core"], "answers": [{"tags": [], "owner": {"reputation": 598, "user_id": 573208, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/TJS1j.jpg?s=128&g=1", "display_name": "To Ka", "link": "https://stackoverflow.com/users/573208/to-ka"}, "is_accepted": true, "score": 6, "last_activity_date": 1487199135, "creation_date": 1487199135, "answer_id": 42261618, "question_id": 42261389, "link": "https://stackoverflow.com/questions/42261389/how-do-i-replace-the-default-icontrollerfactory-with-my-own-implementation-in-as/42261618#42261618", "title": "How do I replace the default IControllerFactory with my own implementation in asp.net core?", "body": "<p>I found a solution by calling</p>\n\n<pre><code>services.AddSingleton&lt;Microsoft.AspNetCore.Mvc.Controllers.IControllerFactory, MyOwnImplementationClassOfControllerFactory&gt;();\n</code></pre>\n\n<p>right before calling <code>services.AddMvc();</code>\nwhere <code>MyOwnImplementationClassOfControllerFactory</code> is the custom implementation of IControllerFactory that is derived form <code>DefaultControllerFactory</code>.</p>\n\n<p>I used singleton, because I found that the <a href=\"https://github.com/aspnet/Mvc/blob/48546dbb28ee762014f49caf052dc9c8a01eec3a/src/Microsoft.AspNetCore.Mvc.Core/DependencyInjection/MvcCoreServiceCollectionExtensions.cs\" rel=\"noreferrer\">default implementation</a> uses the following call <code>services.TryAddSingleton&lt;IControllerFactory, DefaultControllerFactory&gt;();</code></p>\n"}], "owner": {"reputation": 598, "user_id": 573208, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/TJS1j.jpg?s=128&g=1", "display_name": "To Ka", "link": "https://stackoverflow.com/users/573208/to-ka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1713, "favorite_count": 2, "accepted_answer_id": 42261618, "answer_count": 1, "score": 4, "last_activity_date": 1487199135, "creation_date": 1487198130, "question_id": 42261389, "link": "https://stackoverflow.com/questions/42261389/how-do-i-replace-the-default-icontrollerfactory-with-my-own-implementation-in-as", "title": "How do I replace the default IControllerFactory with my own implementation in asp.net core?", "body": "<p>I want to create my own implementation of IControllerFactory and IActionInvoker in an ASP.NET core application. How do I replace the default implementation with my custom class?</p>\n\n<p>I found the solution for older versions of MVC <code>ControllerBuilder.Current.SetControllerFactory</code> but cannot find a way to do that in ASP.NET core.</p>\n\n<p>I believe I should configure this somewhere in Startup => ConfigureServices</p>\n"}, {"tags": ["c#", "winforms", "datagridview", "event-log"], "answers": [{"tags": [], "owner": {"reputation": 4985, "user_id": 3773066, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mPcCO.jpg?s=128&g=1", "display_name": "OhBeWise", "link": "https://stackoverflow.com/users/3773066/ohbewise"}, "is_accepted": false, "score": 0, "last_activity_date": 1487259638, "last_edit_date": 1487259638, "creation_date": 1487255834, "answer_id": 42276975, "question_id": 42261369, "link": "https://stackoverflow.com/questions/42261369/trying-to-get-list-of-event-logs-into-a-datagridview-getting-error-on-readeven/42276975#42276975", "title": "Trying to get List of Event Logs into a dataGridView | getting error on ReadEventLog() method", "body": "<p>In the MSDN documentation for <a href=\"https://msdn.microsoft.com/en-us/library/f9hdxtte(v=vs.110).aspx\" rel=\"nofollow noreferrer\">EventLog Constructor (String)</a> - <code>public EventLog(string logName)</code> - we read under <strong>Exceptions</strong>:</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/library/system.argumentexception(v=vs.110).aspx\" rel=\"nofollow noreferrer\">ArgumentException</a> | The log name is invalid.</p>\n</blockquote>\n\n<p>In <code>ReadEventLog()</code> you construct <code>EventLog</code> using a parameter named <code>EvlLocation</code>. But nowhere in the code you've shown do you initialize that property. Instead, in <code>OpenFile()</code> you initialize a local variable:</p>\n\n<pre><code>string evlLocation = \"\";\n// ...\nevlLocation = openFile.FileName;\n</code></pre>\n\n<ol>\n<li>Ensure you initialize<code>EvlLocation</code>.</li>\n<li>If the error persists, verify the string passed from <code>openFile.FileName</code> is valid - because the constructor doesn't seem to agree.</li>\n</ol>\n"}], "owner": {"reputation": 19, "user_id": 7021385, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/SNI6u.png?s=128&g=1", "display_name": "Brendon &#39;Shadow&#39; Banville", "link": "https://stackoverflow.com/users/7021385/brendon-shadow-banville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487259638, "creation_date": 1487198028, "question_id": 42261369, "link": "https://stackoverflow.com/questions/42261369/trying-to-get-list-of-event-logs-into-a-datagridview-getting-error-on-readeven", "title": "Trying to get List of Event Logs into a dataGridView | getting error on ReadEventLog() method", "body": "<p>I need to get this list of event logs <code>public static List&lt;EventLogEntry&gt; _LogEntries { get; private set; }</code> into <code>dataGridView</code> in Windows Forms.</p>\n\n<blockquote>\n  <p>Current Issue: Everytime I call the method <code>ReadEventLog()</code> it breaks with the exception <strong>An unhandled exception of type 'System.ArgumentException' occurred in System.dll</strong> at the line <code>EventLog eventLog = new EventLog(EvlLocation);</code></p>\n</blockquote>\n\n<hr>\n\n<p>First I open the file</p>\n\n<pre><code>    // Open the log file\n    private void OpenFile()\n    {\n        string evlLocation = \"\";\n        // Show file open dialog\n        if (openFile.ShowDialog() == DialogResult.OK)\n        {\n            // Create a dataset for binding the data to the grid.\n            ds = new DataSet(\"EventLog Entries\");\n            ds.Tables.Add(\"Events\");\n            ds.Tables[\"Events\"].Columns.Add(\"ComputerName\");\n            ds.Tables[\"Events\"].Columns.Add(\"EventId\");\n            ds.Tables[\"Events\"].Columns.Add(\"EventType\");\n            ds.Tables[\"Events\"].Columns.Add(\"SourceName\");\n            ds.Tables[\"Events\"].Columns.Add(\"Message\");\n            // Start the processing as a background process\n            evlLocation = openFile.FileName;\n            parser.setLogLocation(openFile.FileName);\n            worker.RunWorkerAsync(openFile.FileName);\n        }\n    }\n</code></pre>\n\n<p>// Then the below method is called. </p>\n\n<pre><code>    // Bind the dataset to the grid.\n    private void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n    {\n        parser.ReadEventLog();\n        bs = new BindingSource(ds, \"Events\");\n        Foo foo1 = new Foo(\"TEST PC\");\n        ComputerName.Add(foo1);\n\n        bs.DataSource = parser._LogEntries;\n        //Bind fooList to the dataGridView\n        dataGridView1.DataSource = bs;\n\n        this.Invoke(pbHandler, new object[] { 100, 100 });\n    }\n</code></pre>\n\n<hr>\n\n<p>Then when <code>ReadEventLog()</code> is called it breaks at the line <code>EventLog eventLog = new EventLog(EvlLocation);</code>\n<code>ReadEventLog()</code> method below</p>\n\n<pre><code>    public static void ReadEventLog()\n    {\n        // Line in question below\n        EventLog eventLog = new EventLog(EvlLocation);\n        EventLogEntryCollection eventLogEntries = eventLog.Entries;\n        int eventLogEntryCount = eventLogEntries.Count;\n        for (int i = 0; i &lt; eventLogEntries.Count; i++)\n        {\n            EventLogEntry entry = eventLog.Entries[i];\n            //Do Some processing on the entry\n        }\n        _LogEntries = eventLogEntries.Cast&lt;EventLogEntry&gt;().ToList();\n    }\n</code></pre>\n\n<hr>\n"}, {"tags": ["c#", ".net", "multithreading", "winforms"], "comments": [{"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 1, "creation_date": 1487197963, "post_id": 42261329, "comment_id": 71680381, "body": "You should only call <code>Application.Run</code> once during your program&#39;s lifetime. Use <code>Show</code> or <code>ShowDialog</code> on the <code>Manager</code> instead."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6465254"}, "reply_to_user": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 0, "creation_date": 1487198236, "post_id": 42261329, "comment_id": 71680488, "body": "@Cameron I already tried that but it does not work because upon disposing/closing the first form, Manager form does not even open. Program lifetime ends."}], "answers": [{"tags": [], "owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "is_accepted": true, "score": 2, "last_activity_date": 1487198865, "creation_date": 1487198865, "answer_id": 42261556, "question_id": 42261329, "link": "https://stackoverflow.com/questions/42261329/c-winforms-starting-a-second-message-loop-on-a-single-thread-is-not-a-valid-ope/42261556#42261556", "title": "C# Winforms Starting a second message loop on a single thread is not a valid operation. Use Form.ShowDialog instead", "body": "<p>Your first Application.Run is still running during that OnValidationSuccessful event.  Assuming that event is closing the form, try setting a variable instead:</p>\n\n<pre><code>static bool appOK = false;\n</code></pre>\n\n<p>then in your event, set it to true:</p>\n\n<pre><code>static void OnValidationSuccessful()\n{\n  appOK = true;\n}\n</code></pre>\n\n<p>then in your Main procedure, it would look like this:</p>\n\n<pre><code>Application.Run(appStartUp_);\nif (appOK) {\n  Application.Run(new Manager());\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6465254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1616, "favorite_count": 0, "accepted_answer_id": 42261556, "answer_count": 1, "score": 2, "last_activity_date": 1487201987, "creation_date": 1487197832, "last_edit_date": 1487201987, "question_id": 42261329, "link": "https://stackoverflow.com/questions/42261329/c-winforms-starting-a-second-message-loop-on-a-single-thread-is-not-a-valid-ope", "title": "C# Winforms Starting a second message loop on a single thread is not a valid operation. Use Form.ShowDialog instead", "body": "<p>Summary: My application starts off with a license validation form and if the client's license is valid. It should launch the main form.</p>\n\n<p>However I am receiving the following error: Starting a second message loop on a single thread is not a valid operation. Use Form.ShowDialog instead.</p>\n\n<p>My implementation:</p>\n\n<pre><code>static class Program\n{\n    static AppStartUp appStartUp_;\n\n    /// &lt;summary&gt;\n    /// The main entry point for the application.\n    /// &lt;/summary&gt;\n    [STAThread]\n    static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n\n        appStartUp_ = new AppStartUp();\n        appStartUp_.OnValidationSuccessful += OnValidationSuccessful;\n\n        Application.Run(appStartUp_);\n    }\n\n    static void OnValidationSuccessful()\n    {\n        appStartUp_.OnValidationSuccessful -= OnValidationSuccessful;\n        appStartUp_.Close();\n        appStartUp_.Dispose();\n\n        //Application.ExitThread();\n        Application.Run(new Manager());\n    }\n}\n</code></pre>\n\n<p>Is there something that I am doing wrong?</p>\n"}, {"tags": ["c#", "wpf", "datagrid", "right-click"], "comments": [{"owner": {"reputation": 13, "user_id": 3874544, "user_type": "registered", "profile_image": "https://graph.facebook.com/1093031379/picture?type=large", "display_name": "Martin Etcharran", "link": "https://stackoverflow.com/users/3874544/martin-etcharran"}, "reply_to_user": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "edited": false, "score": 0, "creation_date": 1487202530, "post_id": 42261262, "comment_id": 71682049, "body": "That Answer is for winforms, mi question is about wpf"}, {"owner": {"reputation": 3117, "user_id": 5615980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a3c026c1a72be812594861aeec8f56?s=128&d=identicon&r=PG&f=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/5615980/ron"}, "edited": false, "score": 0, "creation_date": 1487204121, "post_id": 42261262, "comment_id": 71682526, "body": "Please post your code too."}], "answers": [{"tags": [], "owner": {"reputation": 1246, "user_id": 1852526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e66cfb9b607ef879597a01bd2ab71bd6?s=128&d=identicon&r=PG", "display_name": "nikhil", "link": "https://stackoverflow.com/users/1852526/nikhil"}, "is_accepted": false, "score": 1, "last_activity_date": 1487207799, "creation_date": 1487207799, "answer_id": 42263112, "question_id": 42261262, "link": "https://stackoverflow.com/questions/42261262/wpf-datagrid-selectitem-beforerightclick/42263112#42263112", "title": "WPF DataGrid SelectItem BeforeRightClick", "body": "<p>Try something like this,</p>\n\n<pre><code>    private void fileGrid_MouseRightButtonUp(object sender, MouseButtonEventArgs e)\n    {\n        foreach (var item in fileGrid.Rows)\n                    {\n                        if (item.IsMouseOver)\n                        {\n                            fileGrid.SelectedIndex = item.Index;\n                            break;\n                        }\n                    }\n//Then do what you want to do.\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3874544, "user_type": "registered", "profile_image": "https://graph.facebook.com/1093031379/picture?type=large", "display_name": "Martin Etcharran", "link": "https://stackoverflow.com/users/3874544/martin-etcharran"}, "edited": false, "score": 0, "creation_date": 1487288182, "post_id": 42263241, "comment_id": 71729984, "body": "thanks this was what i was looking for!"}], "tags": [], "owner": {"reputation": 3117, "user_id": 5615980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a3c026c1a72be812594861aeec8f56?s=128&d=identicon&r=PG&f=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/5615980/ron"}, "is_accepted": true, "score": 0, "last_activity_date": 1487208659, "creation_date": 1487208659, "answer_id": 42263241, "question_id": 42261262, "link": "https://stackoverflow.com/questions/42261262/wpf-datagrid-selectitem-beforerightclick/42263241#42263241", "title": "WPF DataGrid SelectItem BeforeRightClick", "body": "<p>Based on <a href=\"http://blog.scottlogic.com/2008/12/02/wpf-datagrid-detecting-clicked-cell-and-row.html\" rel=\"nofollow noreferrer\">this article</a>, you can use</p>\n\n<pre><code>    private void DataGrid_MouseRightButtonUp(object sender, MouseButtonEventArgs e)\n    {\n        DependencyObject dep = (DependencyObject)e.OriginalSource;\n\n        // iteratively traverse the visual tree\n        while ((dep != null) &amp;&amp; !(dep is DataGridCell) &amp;&amp; !(dep is DataGridColumnHeader))\n        {\n            dep = VisualTreeHelper.GetParent(dep);\n        }\n\n        if (dep == null)\n            return;\n\n        if (dep is DataGridColumnHeader)\n        {\n            DataGridColumnHeader columnHeader = dep as DataGridColumnHeader;\n            // do something\n        }\n\n        if (dep is DataGridCell)\n        {\n            DataGridCell cell = dep as DataGridCell;\n            // do something\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3874544, "user_type": "registered", "profile_image": "https://graph.facebook.com/1093031379/picture?type=large", "display_name": "Martin Etcharran", "link": "https://stackoverflow.com/users/3874544/martin-etcharran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1487248948, "accepted_answer_id": 42263241, "answer_count": 2, "score": 0, "last_activity_date": 1487208659, "creation_date": 1487197529, "last_edit_date": 1487204651, "question_id": 42261262, "link": "https://stackoverflow.com/questions/42261262/wpf-datagrid-selectitem-beforerightclick", "closed_reason": "Duplicate", "title": "WPF DataGrid SelectItem BeforeRightClick", "body": "<p>I Have a DataGrid and I'd like to open a context Menu on rightclick, and filter it in base of a property of the selected item.</p>\n\n<p>The problem is that with \"fileGrid_MouseRightButtonUp\" the selected item isnot the one under the cursor, but the previeouly selected one.</p>\n\n<p>So how can i select the item of the datagrid on rightclick?</p>\n\n<p>Its WPF im talking about</p>\n\n<p>The piece of code:</p>\n\n<pre><code>        private void fileGrid_MouseRightButtonUp(object sender, MouseButtonEventArgs e)\n    {\n        if (fileGrid.SelectedItems.Count != 0)\n        {\n            if(fileGrid.SelectedItems.Count == 1 &amp;&amp; !(fileGrid.SelectedItem as FileD).EsAudio)\n            {\n                cMenu.Items.Filter = item =&gt;\n                {\n                    var it = item as MenuItem;\n                    return it.Header.ToString() != \"ConvertToAudio\";\n                };\n            }\n            else\n            {\n                cMenu.Items.Filter = item =&gt;\n                {\n                    return true;\n                };\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "css", "syntax-highlighting"], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 7124040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d271bfbd772c614a53e8534c2907063c?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Pai", "link": "https://stackoverflow.com/users/7124040/rohit-pai"}, "edited": false, "score": 0, "creation_date": 1487238869, "post_id": 42261305, "comment_id": 71697046, "body": "<code>([\\.#_A-Za-z0-9\\-][_A-Za-z0-9\\-]+)[^}]*{[^}]*}</code> this would be better"}, {"owner": {"reputation": 76, "user_id": 7124040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d271bfbd772c614a53e8534c2907063c?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Pai", "link": "https://stackoverflow.com/users/7124040/rohit-pai"}, "edited": false, "score": 0, "creation_date": 1487284554, "post_id": 42261305, "comment_id": 71728642, "body": "How would I do it for CSS properties? I have ben working on this for a while now and got nowhere. Thanks if you could help"}, {"owner": {"reputation": 76, "user_id": 7124040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d271bfbd772c614a53e8534c2907063c?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Pai", "link": "https://stackoverflow.com/users/7124040/rohit-pai"}, "edited": false, "score": 0, "creation_date": 1487336087, "post_id": 42261305, "comment_id": 71751463, "body": "Don&#39;t worry I worked it out for the properties <a href=\"http://stackoverflow.com/users/6454584/zroq\">@Zroq</a> Here <code>string attributes = @&quot;([A-Za-z0-9-]*:)&quot;;</code>"}], "tags": [], "owner": {"reputation": 5839, "user_id": 6454584, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YR4dt.png?s=128&g=1", "display_name": "Zroq", "link": "https://stackoverflow.com/users/6454584/zroq"}, "is_accepted": true, "score": 1, "last_activity_date": 1487198505, "last_edit_date": 1487198505, "creation_date": 1487197707, "answer_id": 42261305, "question_id": 42261257, "link": "https://stackoverflow.com/questions/42261257/css-syntax-highlighting-in-c-with-regex/42261305#42261305", "title": "CSS syntax Highlighting in c# with regex", "body": "<p>You can use this pattern to match classes/ids: <code>([\\.#][_A-Za-z0-9\\-]+)[^}]*{[^}]*}</code>. </p>\n\n<p><a href=\"https://regex101.com/r/z0Zle1/2\" rel=\"nofollow noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 76, "user_id": 7124040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d271bfbd772c614a53e8534c2907063c?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Pai", "link": "https://stackoverflow.com/users/7124040/rohit-pai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 42261305, "answer_count": 1, "score": 0, "last_activity_date": 1487198505, "creation_date": 1487197506, "question_id": 42261257, "link": "https://stackoverflow.com/questions/42261257/css-syntax-highlighting-in-c-with-regex", "title": "CSS syntax Highlighting in c# with regex", "body": "<p>I want to add CSS syntax highlighting to my rich text box in C#. How would I do that using regex e.g. highlighting the tag names/classes/id's. I have this so far for HTM, but I would like to do for CSS too. </p>\n\n<pre><code>            string tags = @\"&lt;([/A-Za-z0-9]*)\\b[^&gt;]*&gt;(.*?)\";\n            tagMatches = Regex.Matches(rtb.Text, tags, RegexOptions.Multiline);\n\n            // getting attributes from the text \n            string attributes = @\"[A-Za-z0-9-_]*=[A-Za-z0-9-_]*\";\n            attributeMatches = Regex.Matches(rtb.Text, attributes);\n\n            // getting comments (inline or multiline)\n            string comments = @\"(\\&lt;![ \\r\\n\\t]*(--([^\\-]|[\\r\\n]|-[^\\-])*--[ \\r\\n\\t]*)\\&gt;)\";\n            commentMatches = Regex.Matches(rtb.Text, comments, RegexOptions.Multiline);\n\n            // getting strings\n            string strings = \"(\\\".+?\\\"|\\'.+?\\')\";\n            stringMatches = Regex.Matches(rtb.Text, strings);\n</code></pre>\n"}, {"tags": ["c#", "http", "web"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1487197634, "post_id": 42261068, "comment_id": 71680225, "body": "Probably contain useful answers: <a href=\"http://stackoverflow.com/q/4379450/11683\">stackoverflow.com/q/4379450/11683</a>, <a href=\"http://stackoverflow.com/q/1452418/11683\">stackoverflow.com/q/1452418/11683</a>"}, {"owner": {"reputation": 255, "user_id": 4191475, "user_type": "registered", "profile_image": "https://graph.facebook.com/1514112274/picture?type=large", "display_name": "Andy Arndt", "link": "https://stackoverflow.com/users/4191475/andy-arndt"}, "edited": false, "score": 0, "creation_date": 1487198054, "post_id": 42261068, "comment_id": 71680421, "body": "Some sample code to create a mock HTTPContext here: <a href=\"http://stackoverflow.com/a/10126711/4191475\">stackoverflow.com/a/10126711/4191475</a>"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487198361, "creation_date": 1487196724, "last_edit_date": 1487198361, "question_id": 42261068, "link": "https://stackoverflow.com/questions/42261068/how-can-i-prepare-an-argument-of-type-httpcontext-for-a-method", "title": "How can I prepare an argument of type HttpContext for a method?", "body": "<p>I am trying unit-test a method. The method takes in a single argument, which belongs to the class <code>HttpContext</code> in NET Framework Class Library. \nSo I guess I need to prepare an object of <code>HttpContext</code>.</p>\n\n<p>All that the method needs from the argument, say <code>context</code>, are</p>\n\n<ul>\n<li><code>context.Request.QueryString</code></li>\n<li><code>context.Request.Headers</code></li>\n</ul>\n\n<p>Here are my thoughts and questions</p>\n\n<ol>\n<li><p>To learn how to use <code>HttpContext</code>, I click going to definition in\nVisual Studio, I found that the class has a constructor</p>\n\n<pre><code>    public HttpContext(HttpRequest request, HttpResponse response);\n</code></pre>\n\n<p>so I need to provide its two arguments, in order to create a object\nof the class.</p>\n\n<p>To provide the first argument, which is an object of HttpRequest, I found its constructor</p>\n\n<pre><code>//\n// Summary:\n//     Initializes an System.Web.HttpRequest object.\n//\n// Parameters:\n//   filename:\n//     The name of the file associated with the request.\n//\n//   url:\n//     The information regarding the URL of the current request.\n//\n//   queryString:\n//     The entire query string sent with the request (everything after the'?').\npublic HttpRequest(string filename, string url, string queryString);\n</code></pre>\n\n<ul>\n<li><p>What does <code>filename</code> mean?</p></li>\n<li><p>Which is <code>url</code>, the full url containing the query strings, or just the part before <code>?</code>?</p></li>\n</ul>\n\n<p>To provide the second argument of class <code>HttpResponse</code>, I found its constructor</p>\n\n<pre><code>public HttpResponse(TextWriter writer);\n</code></pre>\n\n<p>The method to be tested actually doesn't need <code>context.Response</code>. So can I simply create this as the second argument to the constructor of <code>HttpContext</code>:</p>\n\n<pre><code>writer = new TextWriter ();\nresponse = new HttpResponse(writer);\n</code></pre>\n\n<p>given that the constructors of <code>TextWriter</code> are protected?</p>\n\n<pre><code>protected TextWriter();\nprotected TextWriter(IFormatProvider formatProvider);\n</code></pre></li>\n<li><p>After I can create an object of HttpContext, do I need to call some\nmethod to parse the url and query strings to obtain  </p>\n\n<ul>\n<li><code>context.Request.QueryString</code></li>\n<li><code>context.Request.Headers</code></li>\n</ul>\n\n<p>or the <code>HttpContext</code> will implicitly do the work without me\nexplicitly calling any method?</p></li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "windows", "winapi", "keyboard", "on-screen-keyboard"], "answers": [{"comments": [{"owner": {"reputation": 7293, "user_id": 5994041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dWWF9.png?s=128&g=1", "display_name": "Peter Badida", "link": "https://stackoverflow.com/users/5994041/peter-badida"}, "edited": false, "score": 0, "creation_date": 1487230542, "post_id": 42262774, "comment_id": 71691623, "body": "Yeah, that will be most likely the thing I&#39;m missing. Have you tried running the script elevated? I&#39;m not really sure I can write&amp;sign it as I intend to run in from powershell."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 3, "last_activity_date": 1487205608, "creation_date": 1487205608, "answer_id": 42262774, "question_id": 42261030, "link": "https://stackoverflow.com/questions/42261030/move-on-screen-keyboard-osk-exe-with-c-win-api/42262774#42262774", "title": "Move On-Screen Keyboard (osk.exe) with C# &amp; Win API", "body": "<p>OSK has <code>UIAccess=\"true\"</code> in its manifest so it runs at a higher integrity level (slightly above medium).</p>\n\n<p>To interact with it you need to:</p>\n\n<ol>\n<li>Run your app elevated</li>\n</ol>\n\n<p>or</p>\n\n<ol>\n<li>Put UIAccess=\"true\" in your manifest</li>\n<li>Sign the .exe (<a href=\"https://blogs.techsmith.com/inside-techsmith/devcorner-debug-uiaccess/\" rel=\"nofollow noreferrer\">This blog post</a> indicates that you can self sign during testing)</li>\n<li>Put the .exe somewhere inside the Program Files folder</li>\n</ol>\n\n<p>You can also try to disable UAC to verify that your lack of UIAccess is the problem.</p>\n"}], "owner": {"reputation": 7293, "user_id": 5994041, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dWWF9.png?s=128&g=1", "display_name": "Peter Badida", "link": "https://stackoverflow.com/users/5994041/peter-badida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1889, "favorite_count": 0, "accepted_answer_id": 42262774, "answer_count": 1, "score": 1, "last_activity_date": 1487205608, "creation_date": 1487196573, "last_edit_date": 1487198349, "question_id": 42261030, "link": "https://stackoverflow.com/questions/42261030/move-on-screen-keyboard-osk-exe-with-c-win-api", "title": "Move On-Screen Keyboard (osk.exe) with C# &amp; Win API", "body": "<p>I've made this little <code>.ps1</code> script as it allows me to run C# without using a compiler (directly at least). I'd like to move the \"Accessibility On-Screen Keyboard\" that opens with <code>cmd /c osk.exe</code> as I can't really use <code>TabTip</code> - the panned touchscreen keyboard on Win8+.</p>\n\n<p>As the On-Screen Keyboard isn't really that pretty like the panned keyboard, I'd like to <em>move</em> the keyboard to a desired location <strong>and</strong> resize it. I noticed the OSK has a child window (<code>OSKMainClass</code> \u2192 <code>DirectUIHWND</code>), so I went even for that, but no luck. On the other hand, the same code for a single window works for notepad and correctly places and resizes it.</p>\n\n<p>I put <code>Process.Start()</code> into the if, so that it gave back some feedback, therefore I see it found the child window - that's nice. <strong>BUT</strong>, it didn't move it.</p>\n\n<p>An interesting thing appeared when I pressed <code>Alt+Tab</code> and held the <code>Alt</code> - the OSK window appeared like a grey fullscreen one (metro-like style). I'm not sure if that's an intended behavior for a parent window or not.</p>\n\n<p>Also, I thought it'd be the window styles' thingy, but no, the styles are almost the same (except two unrelated styles), so I'm without any clue how to continue. Any ideas?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>$CSsource = @\"\nusing System;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\n\nnamespace Win {\n    public static class API {\n        [DllImport(\"user32.dll\")]\n        static extern IntPtr FindWindow(\n            string lpClassName,\n            string lpWindowName\n        );\n\n        [DllImport(\"user32.dll\")]\n        public static extern IntPtr FindWindowEx(\n            IntPtr parentHwnd,\n            IntPtr childAfter,\n            string className,\n            string windowTitle\n        );\n\n        [DllImport(\"user32.dll\")]\n        static extern bool ShowWindow(\n            IntPtr hWnd,\n            int nCmdShow\n        );\n\n        [DllImport(\"user32.dll\")]\n        static extern bool MoveWindow(\n            IntPtr hWnd,\n            int X, int Y,\n            int Width, int Height,\n            bool Repaint\n        );\n\n        public static void Move(\n            string wClass, string wName,\n            string childClass,\n            int top, int left,\n            int width, int height\n        ) {\n            IntPtr hwnd = FindWindow(wClass, wName);\n            if ((int) hwnd &gt; 0) {\n                IntPtr subHwnd;\n                if (childClass != String.Empty) {\n                    subHwnd = FindWindowEx(hwnd, IntPtr.Zero, childClass, null);\n                } else {\n                    subHwnd = IntPtr.Zero;\n                }\n\n                if ((int) subHwnd &gt; 0) {\n                    MoveWindow(subHwnd, left, top, width, height + 50, true);\n                    Process.Start(\"cmd\"); //feedback from loop, heh\n                } else {\n                    MoveWindow(hwnd, left, top, width, height + 50, true);\n                }\n            }\n        }\n    }\n}\n\"@\n\nadd-type -TypeDefinition $CSsource\n#[Win.API]::Move('OSKMainClass', 'On-Screen Keyboard', 'DirectUIHWND', 50, 50, 200, 100)\n#[Win.API]::Move('OSKMainClass', 'Accessibility On-Screen Keyboard', 'DirectUIHWND', 50, 50, 200, 100)\n[Win.API]::Move('OSKMainClass', 'Accessibility On-Screen Keyboard', '', 50, 50, 200, 100)\n[Win.API]::Move('Notepad', 'Untitled - Notepad', '', 50, 50, 200, 100)\n</code></pre>\n\n<p><strong>OSK window styles:</strong></p>\n\n<ul>\n<li>WS_CAPTION</li>\n<li>WS_VISIBLE</li>\n<li>WS_CLIPSIBLINGS</li>\n<li>WS_CLIPCHILDREN</li>\n<li>WS_SYSMENU</li>\n<li>WS_THICKFRAME</li>\n<li>WS_OVERLAPPED</li>\n<li>WS_MINIMIZEBOX</li>\n<li>WS_EX_LEFT</li>\n<li>WS_EX_LTRREADING</li>\n<li>WS_EX_TOPMOST</li>\n<li>WS_EX_WINDOWEDGE</li>\n<li>WS_EX_APPWINDOW</li>\n<li>WS_EX_LAYERED</li>\n<li>WS_EX_NOACTIVATE</li>\n</ul>\n\n<p><strong>Notepad window styles:</strong></p>\n\n<p>above +</p>\n\n<ul>\n<li>WS_RIGHTSCROLLBAR</li>\n<li>WS_ACCEPTFILES</li>\n</ul>\n"}, {"tags": ["c#", "performance", "oop", "caching"], "comments": [{"owner": {"reputation": 8936, "user_id": 532721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b17e0da18252fa4c27ea798f0125d8?s=128&d=identicon&r=PG&f=1", "display_name": "reaanb", "link": "https://stackoverflow.com/users/532721/reaanb"}, "edited": false, "score": 0, "creation_date": 1487221571, "post_id": 42261029, "comment_id": 71687547, "body": "&quot;There are only two hard things in Computer Science: cache invalidation and naming things.&quot; -- Phil Karlton"}], "owner": {"reputation": 348, "user_id": 2431645, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/hrRUl.png?s=128&g=1", "display_name": "GY_", "link": "https://stackoverflow.com/users/2431645/gy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "closed_date": 1487230920, "answer_count": 0, "score": 3, "last_activity_date": 1487199178, "creation_date": 1487196570, "last_edit_date": 1487199178, "question_id": 42261029, "link": "https://stackoverflow.com/questions/42261029/oop-design-cache-data", "closed_reason": "Needs more focus", "title": "OOP design: cache data", "body": "<p>I want to design a program so that I can efficiently fetch and display data for users.</p>\n\n<p>The steps are:</p>\n\n<ol>\n<li>users specify some settings (SettingOne, SettingTwo, SettingThree...);</li>\n<li>load different data from database according to different settings;</li>\n<li>display data;</li>\n</ol>\n\n<p>My problem is that getting data from database is expensive, I can improve the performance by caching data. For example, if both userA and userB ask for <code>SettingOne</code> data, I can load data for userA, and cache the result, and give userB the cached result.</p>\n\n<p>Settings are: </p>\n\n<pre><code>class Setting {Operation Op, int A, double B, int C, string D}\nenum Operation {Op1, Op2, Op3}\n// there will be more settings and operations in the future\n</code></pre>\n\n<p>The returned data from database are:</p>\n\n<pre><code>// I have no control over this part\nOp1: find data based on A and B, return an int\nOp2: find data based on C and D, return a string\nOp3: find data based on A and D, return an array\n</code></pre>\n\n<p>How can I design a cache class (follow OOP) to efficiently store the data? It means that the code is well-designed so that I can easily add more operations or settings.</p>\n\n<hr>\n\n<p>My C# solution is to use a <code>Dictionary&lt;Setting, object&gt;</code> to store data and override <code>Setting.GetHashCode()</code>. <code>object</code> is not perfect because I need to display data in different forms according to their type (<code>int</code>, <code>string</code> or <code>double[]</code>)</p>\n\n<pre><code>public override int GetHashCode()\n{\n    switch(Op)\n    {\n        case Op1: return GetHashCode(A, B);\n        case Op2: return GetHashCode(C, D);\n        case Op3: return GetHashCode(A, D);\n        default: return 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc"], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 2092996, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6fffb42153f656792b2e7619aa265f8?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/2092996/blake"}, "edited": false, "score": 0, "creation_date": 1487253497, "post_id": 42262092, "comment_id": 71708072, "body": "Thank you.  I am aware of this and use this for other examples <b>but</b> I want more than one &#39;shared&#39; display template for the same data type.&lt;br/&gt;      Therefore, placing in the controller&#39;s folder does not achieve what I am looking for.  However, using UIHint is something I do today but If I choose not to use UIHint or specify a display template for a data type and there are two templates in the &#39;shared&#39; display template folder for the relative data type which one is used."}, {"owner": {"reputation": 179, "user_id": 2092996, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6fffb42153f656792b2e7619aa265f8?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/2092996/blake"}, "edited": false, "score": 0, "creation_date": 1487254610, "post_id": 42262092, "comment_id": 71709029, "body": "<b>LAST COMMENT TIMED OUT BEFORE COMPLETE</b> Thank you. Let me clarify my question further. I am aware of the &quot;search order&quot; and also of &quot;UIHint attribute&quot;.  I left out that I want the templates for the same data type to be shared by multiple controllers.  Therefore, both would be placed in the &#39;shared&#39; display template folder.  As a result, what template is used when I don&#39;t use UIHint or the template name? What would be the default template used and is there a way I can specify what that default template is - either by annotating it or by annotating that the others are <b>not</b> the default?"}, {"owner": {"reputation": 45663, "user_id": 12752, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/3Ofg1.jpg?s=128&g=1", "display_name": "Jamie Ide", "link": "https://stackoverflow.com/users/12752/jamie-ide"}, "edited": false, "score": 0, "creation_date": 1487255148, "post_id": 42262092, "comment_id": 71709506, "body": "The file that has the same name as the data type is the default. You can only have one file named DateTime.cshtml so that will be the default. If you want to use an alternate template e.g. DateTimeAlt.cshtml you will have to explicitly specify it using UIHint or DisplayFor."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "reply_to_user": {"reputation": 179, "user_id": 2092996, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6fffb42153f656792b2e7619aa265f8?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/2092996/blake"}, "edited": false, "score": 0, "creation_date": 1487279980, "post_id": 42262092, "comment_id": 71726374, "body": "@Blake, As per the answer, if the file is named the same as type type (i.e. for <code>DateTime</code> - name the file <code>DateTime.cshtml</code>) and its located in the <code>&#47;Views&#47;Shared&#47;EditorTemplates</code> folder, then that template will be used as the default."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "is_accepted": false, "score": 1, "last_activity_date": 1487201405, "creation_date": 1487201405, "answer_id": 42262092, "question_id": 42260973, "link": "https://stackoverflow.com/questions/42260973/for-mvc5-can-i-have-multiple-display-templates-for-same-data-type-but-have-one/42262092#42262092", "title": "For MVC5, can I have multiple display templates for same data type but have one be the default used", "body": "<p>If you do not specify a location (using <code>[UIHint]</code> of the 2nd parameter of <code>DisplayFor()</code>),templates are searched in the following order</p>\n\n<pre><code>/Views/YourControllerName/DisplayTemplates\n</code></pre>\n\n<p>if nothing is found, then</p>\n\n<pre><code>/Views/Shared/DisplayTemplates\n</code></pre>\n\n<p>and if nothing is found, then the default (in-built) template for the property type is used.</p>\n\n<p>Locate you <code>DateTime.cshtml</code> template in <code>/Views/Shared/DisplayTemplates</code> and it will be used unless you override it using <code>[UIHint]</code> or by specifying the location in <code>@Html.DisplayFor()</code>, or by including a specific template for the controller.</p>\n"}], "owner": {"reputation": 179, "user_id": 2092996, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6fffb42153f656792b2e7619aa265f8?s=128&d=identicon&r=PG", "display_name": "Blake", "link": "https://stackoverflow.com/users/2092996/blake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487254852, "creation_date": 1487196363, "last_edit_date": 1487254852, "question_id": 42260973, "link": "https://stackoverflow.com/questions/42260973/for-mvc5-can-i-have-multiple-display-templates-for-same-data-type-but-have-one", "title": "For MVC5, can I have multiple display templates for same data type but have one be the default used", "body": "<p>In MVC5 I have multiple <strong>'shared'</strong> display templates for the same data type such as <code>DateTime</code>used with <strong>multiple controllers</strong> but I want one of the templates to be the one used unless I specifically state the template name.</p>\n\n<p>Is there a way I can do the following:</p>\n\n<ol>\n<li>Require that a display template only be used if it was specified using the 'UIHint' attribute or template name specified in <code>DisplayFor(x =&gt; x.Time, \"templatename\")</code></li>\n</ol>\n\n<p>OR </p>\n\n<ol start=\"2\">\n<li>Indicate that a certain display template is used unless the template name is provided.</li>\n</ol>\n\n<p>I am aware of placing the template in the controller's shared display template folder and the search order but I'm referring to multiple templates for the same data type being in the shared display template folder.  </p>\n"}, {"tags": ["c#", "async-await", "task"], "comments": [{"owner": {"reputation": 6076, "user_id": 2711582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7oA0B.jpg?s=128&g=1", "display_name": "Wagner DosAnjos", "link": "https://stackoverflow.com/users/2711582/wagner-dosanjos"}, "edited": false, "score": 0, "creation_date": 1487196544, "post_id": 42260916, "comment_id": 71679674, "body": "Perhaps <a href=\"https://msdn.microsoft.com/en-us/library/system.threading.semaphoreslim(v=vs.110).aspx\" rel=\"nofollow noreferrer\">System.Threading.SemaphoreSlim</a>"}, {"owner": {"reputation": 8613, "user_id": 1644813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HgpPS.jpg?s=128&g=1", "display_name": "Kirill Shlenskiy", "link": "https://stackoverflow.com/users/1644813/kirill-shlenskiy"}, "edited": false, "score": 1, "creation_date": 1487197690, "post_id": 42260916, "comment_id": 71680257, "body": "If the number of queued up tasks is not expected to be very large, use <code>SemaphoreSlim</code> if others have suggested. If the queue is expected to get long, or if you continuously produce new tasks, and need to be able to throttle the producer, you&#39;ll need to think about employing TPL Dataflow or rolling your own mechanism which supports limiting the maximum degree of parallelism (which isn&#39;t particularly easy)."}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 1332305, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d82234c774fdf160efa0afef09c5f63d?s=128&d=identicon&r=PG", "display_name": "Habib", "link": "https://stackoverflow.com/users/1332305/habib"}, "edited": false, "score": 0, "creation_date": 1487365501, "post_id": 42261215, "comment_id": 71769602, "body": "Isn&#39;t SemaphoreSlim recommended for tasks that will finish in a very short period of time?"}], "tags": [], "owner": {"reputation": 6076, "user_id": 2711582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7oA0B.jpg?s=128&g=1", "display_name": "Wagner DosAnjos", "link": "https://stackoverflow.com/users/2711582/wagner-dosanjos"}, "is_accepted": true, "score": 6, "last_activity_date": 1487197343, "creation_date": 1487197343, "answer_id": 42261215, "question_id": 42260916, "link": "https://stackoverflow.com/questions/42260916/async-tasks-with-controlled-parallelism-and-awaitall-option/42261215#42261215", "title": "Async Tasks with Controlled parallelism and AwaitAll option", "body": "<p>You can try the <a href=\"https://msdn.microsoft.com/en-us/library/system.threading.semaphoreslim(v=vs.110).aspx\" rel=\"noreferrer\">SemaphoreSlim</a> class as follows:</p>\n\n<pre><code>SemaphoreSlim semaphore = new SemaphoreSlim(5, 5);\n\nasync Task downloadFile(string fileName)\n{\n    await semaphore.WaitAsync();\n\n    try\n    {\n        await downloadService(fileName);\n    }\n    finally\n    {\n        semaphore.Release();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 178, "user_id": 1332305, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d82234c774fdf160efa0afef09c5f63d?s=128&d=identicon&r=PG", "display_name": "Habib", "link": "https://stackoverflow.com/users/1332305/habib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 42261215, "answer_count": 1, "score": 2, "last_activity_date": 1487197343, "creation_date": 1487196145, "question_id": 42260916, "link": "https://stackoverflow.com/questions/42260916/async-tasks-with-controlled-parallelism-and-awaitall-option", "title": "Async Tasks with Controlled parallelism and AwaitAll option", "body": "<p>I have a scenario where different code from my application can call the following method</p>\n\n<pre><code>async Task downloadFile(string fileName)\n{\n    await downloadService(fileName);\n}\n</code></pre>\n\n<p>Need a machanism where I can control the max number of requests it can send. For example after 5 active requests I want the rest to be queued up and next will only initiate once we get a response from one of the existing requests. I also need a machanism where I can listen to all the active/queued requests in my code something like Task.WhenAll</p>\n\n<p>I am mostly interested in a built-in .Net library. I know <a href=\"https://msdn.microsoft.com/library/system.threading.tasks.taskscheduler.aspx\" rel=\"nofollow noreferrer\">TaskScheduler</a> but seems like I've to implement majority of the Enqueue/Dequeue stuff myself. Wondering if a more suitable library exists.</p>\n"}, {"tags": ["c#", ".net", "compilation", "roslyn", "codedom"], "answers": [{"comments": [{"owner": {"reputation": 4651, "user_id": 1878141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/XYDte.jpg?s=128&g=1", "display_name": "Christian Findlay", "link": "https://stackoverflow.com/users/1878141/christian-findlay"}, "edited": false, "score": 0, "creation_date": 1487283399, "post_id": 42263416, "comment_id": 71728106, "body": "Ah yes. This is hacky but it looks like it might solve the problem."}], "tags": [], "owner": {"reputation": 303, "user_id": 1676558, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5de7da07fe5ff39842a006f8e204e970?s=128&d=identicon&r=PG", "display_name": "user1676558", "link": "https://stackoverflow.com/users/1676558/user1676558"}, "is_accepted": false, "score": 1, "last_activity_date": 1487210061, "creation_date": 1487210061, "answer_id": 42263416, "question_id": 42260915, "link": "https://stackoverflow.com/questions/42260915/codedomprovider-compileassemblyfromsource-cant-find-roslyn-csc-exe/42263416#42263416", "title": "CodeDomProvider.CompileAssemblyFromSource - Can&#39;t Find Roslyn (csc.exe)", "body": "<p>I'd take a look at the NuGet package Microsoft.CodeDom.Providers.DotNetCompilerPlatform.BinFix. I haven't used it but it has 10K downloads because this is a problem a lot of people have run into, I think. I ran into this problem and I remember using reflection to workaround it, here's the snippet I wrote with a reference to the Stack Overflow answer I was basing it on, where _compiler is my CSharpCodeProvider:</p>\n\n<pre><code>// Little hack here, see http://stackoverflow.com/a/40311406/1676558.\nobject compilerSettings = typeof(CSharpCodeProvider)\n    .GetField(\"_compilerSettings\", BindingFlags.Instance | BindingFlags.NonPublic)\n    .GetValue(_compiler);\nFieldInfo compilerSettingsFullPathField = compilerSettings\n    .GetType()\n    .GetField(\"_compilerFullPath\", BindingFlags.Instance | BindingFlags.NonPublic);\nstring desiredCompilerSettingsFullPath = ((string)compilerSettingsFullPathField\n    .GetValue(compilerSettings))\n    .Replace(@\"bin\\roslyn\\\", @\"roslyn\\\");\ncompilerSettingsFullPathField.SetValue(compilerSettings, desiredCompilerSettingsFullPath);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4651, "user_id": 1878141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/XYDte.jpg?s=128&g=1", "display_name": "Christian Findlay", "link": "https://stackoverflow.com/users/1878141/christian-findlay"}, "edited": false, "score": 0, "creation_date": 1487283356, "post_id": 42270394, "comment_id": 71728091, "body": "I realise that I can do this, but that&#39;s beside the point. I want to keep all my binaries in the one folder. Why is Roslyn hard coded to only work if it&#39;s in one spot?"}], "tags": [], "owner": {"reputation": 765, "user_id": 7573660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FpEpb.jpg?s=128&g=1", "display_name": "Ivan Kishchenko", "link": "https://stackoverflow.com/users/7573660/ivan-kishchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1487238758, "creation_date": 1487238758, "answer_id": 42270394, "question_id": 42260915, "link": "https://stackoverflow.com/questions/42260915/codedomprovider-compileassemblyfromsource-cant-find-roslyn-csc-exe/42270394#42270394", "title": "CodeDomProvider.CompileAssemblyFromSource - Can&#39;t Find Roslyn (csc.exe)", "body": "<p>Change '<em>Post-build event command line</em>' in '<em>Build Events</em>' tab of your project settings to:</p>\n\n<pre><code>IF EXIST $(TargetDir)roslyn\\csc.exe (MKDIR $(TargetDir)bin &amp; MOVE /Y $(TargetDir)roslyn $(TargetDir)bin\\roslyn)\n</code></pre>\n"}], "owner": {"reputation": 4651, "user_id": 1878141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/XYDte.jpg?s=128&g=1", "display_name": "Christian Findlay", "link": "https://stackoverflow.com/users/1878141/christian-findlay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1487238758, "creation_date": 1487196138, "question_id": 42260915, "link": "https://stackoverflow.com/questions/42260915/codedomprovider-compileassemblyfromsource-cant-find-roslyn-csc-exe", "title": "CodeDomProvider.CompileAssemblyFromSource - Can&#39;t Find Roslyn (csc.exe)", "body": "<p>We recently upgraded from an old CodeDomProvider to the new Roslyn CodeDomProvider called Microsoft.CodeDom.Providers.DotNetCompilerPlatform. It works fine, but it looks for the csc.exe in the wrong place. The NuGet package puts the exe in the path:</p>\n\n<p>[App Path]\\bin\\Debug\\roslyn</p>\n\n<p>But, when we compile, we get this error:\n<em>Could not find a part of the path '[App Path]\\bin\\Debug\\bin\\roslyn\\csc.exe'.</em></p>\n\n<p>Notice that it is looking for the exe in the wrong place. It's looking for it inside the \"bin\" folder which is already in the bin\\Debug folder. So, in order to make our code compile, we need to move the Roslyn compiler to:\n[App Path]\\bin\\Debug\\bin\\roslyn\\csc.exe</p>\n\n<p>Is there any way to tell the CodeDomProvider where the Roslyn compiler is located? Isn't this just a straight up bug in the Roslyn compiler code?</p>\n"}, {"tags": ["c#", "database", "ms-access", "exception"], "comments": [{"owner": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 0, "creation_date": 1487196445, "post_id": 42260904, "comment_id": 71679630, "body": "Next time please do some research before you post a possibly duplicate question: <a href=\"http://stackoverflow.com/questions/14024660/how-to-open-connection-with-microsoft-access-database-in-c-sharp\" title=\"how to open connection with microsoft access database in c sharp\">stackoverflow.com/questions/14024660/&hellip;</a>"}, {"owner": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 1, "creation_date": 1487196453, "post_id": 42260904, "comment_id": 71679632, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14024660/how-to-open-connection-with-microsoft-access-database-in-c-sharp\">How to open connection with Microsoft Access database in C#</a>"}, {"owner": {"reputation": 1, "user_id": 7094858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62cb12c249b964e5a5e24fc3dcfde4b?s=128&d=identicon&r=PG&f=1", "display_name": "Zbyszko", "link": "https://stackoverflow.com/users/7094858/zbyszko"}, "reply_to_user": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 0, "creation_date": 1487230069, "post_id": 42260904, "comment_id": 71691345, "body": "Post is not duplicate!"}, {"owner": {"reputation": 5573, "user_id": 1547591, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa6bd0c119d364ba4c96501478600c5c?s=128&d=identicon&r=PG", "display_name": "andy", "link": "https://stackoverflow.com/users/1547591/andy"}, "edited": false, "score": 0, "creation_date": 1487230510, "post_id": 42260904, "comment_id": 71691591, "body": "Microsoft.ACE.OleDB.12.0"}, {"owner": {"reputation": 1, "user_id": 7094858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62cb12c249b964e5a5e24fc3dcfde4b?s=128&d=identicon&r=PG&f=1", "display_name": "Zbyszko", "link": "https://stackoverflow.com/users/7094858/zbyszko"}, "edited": false, "score": 0, "creation_date": 1487231152, "post_id": 42260904, "comment_id": 71691952, "body": "I&#39;ve another problem, because in the same platform I can connect to my database using VS Server Explorer. Next I copy ConnectionString from the connection properties. Using the same ConnectionString I tried to connect to this database from my program, but this time I get the exception. Ok, it began to work when I replaced ConnectionString with &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|\\\\Kadry2002.mdb&quot;. Problem is solved."}, {"owner": {"reputation": 1, "user_id": 7094858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62cb12c249b964e5a5e24fc3dcfde4b?s=128&d=identicon&r=PG&f=1", "display_name": "Zbyszko", "link": "https://stackoverflow.com/users/7094858/zbyszko"}, "edited": false, "score": 0, "creation_date": 1487231320, "post_id": 42260904, "comment_id": 71692041, "body": "Ok, it began to work when I replaced ConnectionString with &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|\\\\Kadry2002.mdb&quot;. Problem is solved."}, {"owner": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 0, "creation_date": 1487242034, "post_id": 42260904, "comment_id": 71699449, "body": "If it is not a duplicate indeed please post your solution as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7094858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62cb12c249b964e5a5e24fc3dcfde4b?s=128&d=identicon&r=PG&f=1", "display_name": "Zbyszko", "link": "https://stackoverflow.com/users/7094858/zbyszko"}, "is_accepted": false, "score": 0, "last_activity_date": 1487286512, "creation_date": 1487286512, "answer_id": 42286446, "question_id": 42260904, "link": "https://stackoverflow.com/questions/42260904/an-unhandled-exception-of-type-system-data-oledb-oledbexception-occurred-in-sy/42286446#42286446", "title": "An unhandled exception of type &#39;System.Data.OleDb.OleDbException&#39; occurred in System.Data.dll Additional information: Unrecognized database format", "body": "<p>Ok, I solved this issue. It began to work when I replaced ConnectionString with </p>\n\n<pre><code>var cs = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=|DataDirectory|\\\\Kadry2002.mdb\";\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7094858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c62cb12c249b964e5a5e24fc3dcfde4b?s=128&d=identicon&r=PG&f=1", "display_name": "Zbyszko", "link": "https://stackoverflow.com/users/7094858/zbyszko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1373, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1487286512, "creation_date": 1487196110, "last_edit_date": 1487203769, "question_id": 42260904, "link": "https://stackoverflow.com/questions/42260904/an-unhandled-exception-of-type-system-data-oledb-oledbexception-occurred-in-sy", "title": "An unhandled exception of type &#39;System.Data.OleDb.OleDbException&#39; occurred in System.Data.dll Additional information: Unrecognized database format", "body": "<p>I tried to open the access database. I can open it from the Server Explorer from Visual Studio, and I can browse all tables and the other data. But if I tried to do it programmatically, I get the exception like in the topic.\nI used the same ConnectionString, I copy it. What is the reason?</p>\n\n<pre><code>var cs =\"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=c:\\\\Data\\\\Kadry2002.mdb;Persist Security Info=False;\";\nvar connection = new OleDbConnection(cs);\nconnection.Open();\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "wpf", "mvvm"], "comments": [{"owner": {"reputation": 16352, "user_id": 932728, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/4PyNZ.jpg?s=128&g=1", "display_name": "Peter Bons", "link": "https://stackoverflow.com/users/932728/peter-bons"}, "edited": false, "score": 2, "creation_date": 1487195976, "post_id": 42260845, "comment_id": 71679383, "body": "Comparing an MVC web app with a WPF desktop app is like comparing apples with cars. Do not make the mistake of trying to port it. Forget what you&#39;ve done so far and start from scratch."}, {"owner": {"reputation": 1055, "user_id": 2683179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3a694541424ada818eaced5da59772f4?s=128&d=identicon&r=PG&f=1", "display_name": "LCaraway", "link": "https://stackoverflow.com/users/2683179/lcaraway"}, "reply_to_user": {"reputation": 16352, "user_id": 932728, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/4PyNZ.jpg?s=128&g=1", "display_name": "Peter Bons", "link": "https://stackoverflow.com/users/932728/peter-bons"}, "edited": false, "score": 0, "creation_date": 1487196083, "post_id": 42260845, "comment_id": 71679431, "body": "That&#39;s fair, and ultimately what I had in mind. Still was hoping to start a discussion as to how the different design paterns accomplish the same goals."}, {"owner": {"reputation": 1297, "user_id": 485732, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a53158dc923f43bab7e0d6f2af668326?s=128&d=identicon&r=PG", "display_name": "Martino Bordin", "link": "https://stackoverflow.com/users/485732/martino-bordin"}, "edited": false, "score": 3, "creation_date": 1487197394, "post_id": 42260845, "comment_id": 71680113, "body": "I would suggest you to take a look to <a href=\"http://knockoutjs.com\" rel=\"nofollow noreferrer\">knockoutjs.com</a> It&#39;s a framework to develop Javascript UI using MVVM pattern."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "reply_to_user": {"reputation": 1297, "user_id": 485732, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a53158dc923f43bab7e0d6f2af668326?s=128&d=identicon&r=PG", "display_name": "Martino Bordin", "link": "https://stackoverflow.com/users/485732/martino-bordin"}, "edited": false, "score": 1, "creation_date": 1487256794, "post_id": 42260845, "comment_id": 71710774, "body": "I do both myself, and the only similarity between the two patterns is that in a webpage that relies heavily on ajax requests to handle things the user is doing in the UI, it is very beneficial to use a javascript MVVM like knockoutjs as @MartinoBordin mentioned.  They take care of all those fiddly UI &lt;--&gt; javascript updates for you, just like Bindings do in WPF."}], "answers": [{"comments": [{"owner": {"reputation": 1055, "user_id": 2683179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3a694541424ada818eaced5da59772f4?s=128&d=identicon&r=PG&f=1", "display_name": "LCaraway", "link": "https://stackoverflow.com/users/2683179/lcaraway"}, "edited": false, "score": 0, "creation_date": 1487196880, "post_id": 42260941, "comment_id": 71679828, "body": "OK, thank you Steve. I appreciate the input. Still learning a lot of this. Wasn&#39;t sure if there was an mvc way of initializing the model in the controller, set values, and then passing whatever values to the view. Then go back the other way when something is changed in the view. Sounds like I will be doing a lot of JavaScript."}, {"owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "reply_to_user": {"reputation": 1055, "user_id": 2683179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3a694541424ada818eaced5da59772f4?s=128&d=identicon&r=PG&f=1", "display_name": "LCaraway", "link": "https://stackoverflow.com/users/2683179/lcaraway"}, "edited": false, "score": 0, "creation_date": 1487197103, "post_id": 42260941, "comment_id": 71679957, "body": "if the server needs to know when the user&#39;s selection changed before the user hits submit then chances are you are doing it wrong. There might be some cases which this is valid (for example you only want to load something when it is requested), in that case you can look into API calls. But do remember the stateless nature of HTTP"}, {"owner": {"reputation": 361, "user_id": 8512394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47e55a45d1d34e317a5444dc2a7b8812?s=128&d=identicon&r=PG&f=1", "display_name": "Luis", "link": "https://stackoverflow.com/users/8512394/luis"}, "edited": false, "score": 0, "creation_date": 1524352593, "post_id": 42260941, "comment_id": 86938411, "body": "@steve, if you need real time SPA you can use mvvm, viewmodel in the server, and the view with html and Javascript. There are frameworks for that."}], "tags": [], "owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "is_accepted": false, "score": 1, "last_activity_date": 1487196261, "creation_date": 1487196261, "answer_id": 42260941, "question_id": 42260845, "link": "https://stackoverflow.com/questions/42260845/comparison-of-asp-net-mvc-and-wpf-mvvm-is-there-a-data-binding-equivalent/42260941#42260941", "title": "Comparison of Asp.net (MVC) and WPF (MVVM) - Is There a Data Binding Equivalent?", "body": "<p>No, No, No and...NO</p>\n\n<p>WPF is run at client side and everything is happening on the client side. It keeps all the states and data in the same machine's memory. </p>\n\n<p>MVC on the other hand runs on both the client and server side where the server does NOT store the state (you can read more about HTTP stateless) and the client/server does not share the same piece of memory or data. </p>\n\n<p>So those are completely different technology targeting completely different use cases. </p>\n\n<p>Classic ASP on the other hand is trying to simulate the behavior you described by using post back. Basically it is sending back all the user's action back to the server and the server can act correspondingly (such as change the value, disable button ect).  </p>\n\n<p>I would not recommend using it anymore since it is putting lots of unnecessary pressure on the server</p>\n"}, {"comments": [{"owner": {"reputation": 1055, "user_id": 2683179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3a694541424ada818eaced5da59772f4?s=128&d=identicon&r=PG&f=1", "display_name": "LCaraway", "link": "https://stackoverflow.com/users/2683179/lcaraway"}, "edited": false, "score": 2, "creation_date": 1487198740, "post_id": 42261453, "comment_id": 71680704, "body": "Thank you Simon for taking the time to draw the comparison. Definitely helps in my understanding of MVC from the WPF/MVVM perspective.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 1, "creation_date": 1487256874, "post_id": 42261453, "comment_id": 71710845, "body": "This is incomplete.  Client side MVVM frameworks are common for applications that utilize ajax more than postbacks.  You&#39;re just covering the server side (which is important, but still...)."}], "tags": [], "owner": {"reputation": 10041, "user_id": 16861, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/563899015cc26b2f431e26d3049e4a05?s=128&d=identicon&r=PG", "display_name": "Simon Fox", "link": "https://stackoverflow.com/users/16861/simon-fox"}, "is_accepted": true, "score": 5, "last_activity_date": 1487198771, "last_edit_date": 1487198771, "creation_date": 1487198385, "answer_id": 42261453, "question_id": 42260845, "link": "https://stackoverflow.com/questions/42260845/comparison-of-asp-net-mvc-and-wpf-mvvm-is-there-a-data-binding-equivalent/42261453#42261453", "title": "Comparison of Asp.net (MVC) and WPF (MVVM) - Is There a Data Binding Equivalent?", "body": "<p>I think some of the comments on this question so far are a little unfair...Yes the two technologies (ASP.Net MVC and WPF) are used to build for completely different platforms, but there are comparisons that can be made between the architectures (MVC and MVVM) being used in each of those platforms.</p>\n\n<p>In WPF you have a <em>ViewModel</em> that exposes your <em>Model</em> to your <em>View</em>. In your example, <code>MainViewModel</code> exposes a model that contains a from and a to date via the <code>FromDate</code> and <code>ToDate</code> properties. The view can then choose to display those values as it pleases.</p>\n\n<p>In ASP.Net MVC, you still have a <em>Model</em> and a <em>View</em> and something that connects the two - a <em>Controller</em>. The action invoked on your controller by some HTTP request is responsible for populating a model to be rendered by a view and returned to the client as an HTTP response.</p>\n\n<pre><code>public class MainController : Controller\n{\n  public ActionResult ShowMeTheModel()\n  {\n    SimpleModel model = new SimpleModel\n    {\n      FromDate = DateTime.Today,\n      ToDate = DateTime.Today.AddDays(7)\n    };\n\n    return View(model);\n  }\n\n  [HttpPost]\n  public ActionResult UpdateTheModel(SimpleModel model)\n  {\n    // use the model parameter to persist changes or otherwise        \n\n    return Redirect(\"ShowMeAllTheModels\");\n  }\n}\n</code></pre>\n\n<p>And a basic View</p>\n\n<pre><code>&lt;h2&gt;A Simple Model&lt;/h2&gt;\n\n&lt;% using(Html.BeginForm(\"UpdateTheModel\", \"Main\")) %&gt;\n&lt;% { %&gt;\n\n  &lt;table&gt;\n    &lt;tr&gt;\n      &lt;th&gt;From Date&lt;/th&gt;\n      &lt;th&gt;To Date&lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n      &lt;td&gt;\n        &lt;%= Html.DatePickerFor(model =&gt; model.FromDate) %&gt;\n      &lt;/td&gt;\n      &lt;td&gt;\n        &lt;%= Html.DatePickerFor(model =&gt; model.ToDate) %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/table&gt;\n&lt;% } %&gt;\n</code></pre>\n\n<p>Databinding occurs in the post back - put very simply, an <code>[HttpPost]</code> action with a parameter of type <code>SimpleModel</code> will populate that model with the values contained in the HTTP post. That action can then use that values in that model to persist changes or trigger some action.</p>\n\n<p>So yes the platforms are very different and you need to be fully aware of these differences, but there are definitely comparisons that can be made as I have outlined above.</p>\n"}], "owner": {"reputation": 1055, "user_id": 2683179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3a694541424ada818eaced5da59772f4?s=128&d=identicon&r=PG&f=1", "display_name": "LCaraway", "link": "https://stackoverflow.com/users/2683179/lcaraway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1396, "favorite_count": 1, "accepted_answer_id": 42261453, "answer_count": 2, "score": 1, "last_activity_date": 1487198771, "creation_date": 1487195883, "last_edit_date": 1487195983, "question_id": 42260845, "link": "https://stackoverflow.com/questions/42260845/comparison-of-asp-net-mvc-and-wpf-mvvm-is-there-a-data-binding-equivalent", "title": "Comparison of Asp.net (MVC) and WPF (MVVM) - Is There a Data Binding Equivalent?", "body": "<p>I am considering a transition form WPF (mvvm) to asp.net (MVC). I thought it might be useful for sanity sake to draw a lose comparison of asp.net(MVC) and WPF(MVVM). </p>\n\n<p>What would a MVC equivalent of the following WPF Example look like? To be specific, I am curious as to how the separation of UI and application logic is maintained and perhaps more importantly, if there is a data binding equivalent. How would the two different design patterns accomplish the same scenario.</p>\n\n<p><strong>Viewmodel</strong></p>\n\n<p>In your view model, you would have a class in which a component in the view will bind too. Something to the tune of:</p>\n\n<pre><code>namespace solution.ViewModels\n{\n    public class MainViewModel : BaseViewModel\n    {\n        private DateTime _fromDate;\n\n        public DateTime FromDate\n        {\n            get { return _fromDate; }\n            set { _fromDate = value; OnPropertyChanged(\"FromDate\"); }\n        }\n\n        private DateTime _toDate;\n\n        public DateTime ToDate\n        {\n            get { return _toDate; }\n            set { _toDate = value; OnPropertyChanged(\"ToDate\");}\n        }\n    }\n}\n</code></pre>\n\n<p>Where BaseViewModel is:</p>\n\n<pre><code>public class BaseViewModel : INotifyPropertyChanged\n{\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    protected void OnPropertyChanged(string propertyName)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n        }\n    }\n}\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>&lt;Window .......&gt;\n    &lt;Grid&gt;\n       &lt;DatePicker SelectedDate = \"{Binding ToDate}\"&gt;\n       &lt;DatePicker SelectedDate = \"{Binding FromDate}\"&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n"}, {"tags": ["c#", "itext"], "answers": [{"comments": [{"owner": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1487248842, "post_id": 42273041, "comment_id": 71704503, "body": "Thank you for answer. Does it mean that <b>AA</b> entry store JavaScript in the second annotation. I&#39;m puzzled because in another <a href=\"https://www.upload.ee/files/6680430/sandri6.pdf.html\" rel=\"nofollow noreferrer\">file</a> where annotations are empty (Adobe Acrobat says so) they are not removed by the code. How do I fix this?"}, {"owner": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "reply_to_user": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1487251659, "post_id": 42273041, "comment_id": 71706564, "body": "@menteith <i>&quot;Does it mean that AA entry store JavaScript in the second annotation.&quot;</i> - No. As you see in the screenshot, the second annotation has neither an <b>A</b> nor an <b>AA</b> entry."}, {"owner": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "reply_to_user": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1487253269, "post_id": 42273041, "comment_id": 71707851, "body": "@menteith Concerning your other file: I cannot reproduce your observation. Exactly those annotations without action (which happen to be the link annotations around the author names) are removed. And I checked both by inspecting the PDF objects and by clicking around in Acrobat."}, {"owner": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1487253848, "post_id": 42273041, "comment_id": 71708381, "body": "That&#39;s weird, because I doubled checked and these annotations have not been removed in my case. Which version of iTextSharp do you use? I use latest \u2013 5.5.10 and compile the code using VS 2015. <a href=\"https://www.upload.ee/files/6680677/output.pdf.html\" rel=\"nofollow noreferrer\">Here</a> is the output file with actions that have not been removed. I also updated my first post to show all the code. Would you be so kind to examine this?"}, {"owner": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "reply_to_user": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1487256633, "post_id": 42273041, "comment_id": 71710639, "body": "@menteith You changed your code and don&#39;t check for <b>A</b> anymore, only for <b>AA</b>. I used your original code which checked again <b>A</b>. (When I mentioned <b>AA</b> I did not mean you have look for it <i>instead of</i> looking for <b>A</b> but <i>in addition to</i> looking for <b>A</b>). But now an actual error even in your original code becomes clear. I&#39;ll edit my answer."}, {"owner": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "edited": false, "score": 0, "creation_date": 1487259332, "post_id": 42273041, "comment_id": 71712764, "body": "I am deeply thankful for your explanations. I will knuckle down on your solution to get a better understanding of it. I&#39;m new to C# and I&#39;d like to learn this language. I have already accepted and upvoted your answer but you would help me a lot  if you could have a look at my code after a few days. Thanks to you I have a working code to remove empty annotations ,and I have another piece of code (working) to change annotations. I&#39;d like to combine these two pieces of code as as a way of advancing my C# skills. Once again \u2013 I really appreciate your explanations!"}], "tags": [], "owner": {"reputation": 77029, "user_id": 1729265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMMeP.jpg?s=128&g=1", "display_name": "mkl", "link": "https://stackoverflow.com/users/1729265/mkl"}, "is_accepted": true, "score": 1, "last_activity_date": 1487257613, "last_edit_date": 1487257613, "creation_date": 1487245551, "answer_id": 42273041, "question_id": 42260643, "link": "https://stackoverflow.com/questions/42260643/removing-empty-annotations-from-pdf/42273041#42273041", "title": "Removing empty annotations from PDF", "body": "<p>The document you provided contains 13 link annotations on its only page. And in contrast to your assumption (that all annotations have associated actions), the second one does not have an action and, therefore, is correctly removed by your code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/b0f8K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b0f8K.png\" alt=\"Annotations screenshot\"></a></p>\n\n<p>As you see, the second annotation in object 778 has no <strong>A</strong> entry.</p>\n\n<hr>\n\n<p>Thus, in case of your sample document, your code works correctly.</p>\n\n<p>Please be aware, though, that some annotation types can not only have a standard action (<strong>A</strong> entry), they may also (or instead!) have additional actions in response to various trigger events. So, for a generic solution you also have to check for <strong>AA</strong> entries in annotations of those types.</p>\n\n<hr>\n\n<p>There is an error in the code, though, even though it did not trigger in the sample document. In the annotation removal loop we see:</p>\n\n<pre><code>for (int j = 0; j &lt; annotationsArray.Size; j++) {\n    // for current annotation\n    PdfDictionary currentAnnotation = annotationsArray.GetAsDict(j);\n\n    PdfDictionary annotationAction = currentAnnotation.GetAsDict(PdfName.A);\n    if (annotationAction == null) {\n        annotationsArray.Remove(j);\n        Console.Write(\"Removed annotation {0} with no action from page {1}\\n\", j, i);\n    }\n}\n</code></pre>\n\n<p>Now let's assume we have a document with a page with two consecutive annotations without an action. Running the code against that document, only the first one will be removed, not the second, because <code>annotationsArray.Remove(j)</code> moves the annotation at <code>j+1</code> to position <code>j</code>, and then the loop variable is incremented, i.e. the annotation following the removed one is not tested at all!</p>\n\n<p>You can fix this by either looping backwards, i.e. </p>\n\n<pre><code>for (int j = annotationsArray.Size - 1; j &gt;= 0; j--)\n</code></pre>\n\n<p>or by decrementing <code>j</code> after a <code>annotationsArray.Remove(j)</code> call.</p>\n\n<p>Looping backwards has the advantage that the <code>Console</code> output makes more sense, in the latter case the annotation index does not always represent the index in the original array, merely in the current intermediary array.</p>\n"}], "owner": {"reputation": 628, "user_id": 2657875, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/40690e8e76fcc4af11b19b4a2f4a3072?s=128&d=identicon&r=PG", "display_name": "menteith", "link": "https://stackoverflow.com/users/2657875/menteith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 42273041, "answer_count": 1, "score": 0, "last_activity_date": 1487257613, "creation_date": 1487195063, "last_edit_date": 1487253627, "question_id": 42260643, "link": "https://stackoverflow.com/questions/42260643/removing-empty-annotations-from-pdf", "title": "Removing empty annotations from PDF", "body": "<p>I wrote a <code>C#</code> program to remove annotations with no actions from PDF files. I use <code>iTextSharp</code>. However, in one of my files one non-empty annotation is removed (it's JavaScript action) while other non-empty aren't removed. Is it the case? Is it because of my code or is it faulty <a href=\"https://www.upload.ee/files/6679061/file.pdf.html\" rel=\"nofollow noreferrer\">PDF file</a>?</p>\n\n<pre><code>using System;\nusing System.IO;\nusing iTextSharp.text.pdf;\n\nnamespace removeEmpty\n{\n    class Program\n    {\n        public static void Main()\n        {\n            //Bytes will hold our final PDFs\n            byte[] bytes;\n\n            using (var ms = new MemoryStream()) {\n                using (var reader = new PdfReader(\"sandri6.pdf\")) {\n                    using (var stamper = new PdfStamper(reader, ms)) {\n                        for (int i = 1; i &lt;= reader.NumberOfPages; i++) {\n                            // get a page a PDF page\n                            PdfDictionary page = reader.GetPageN(i);\n                            // get all the annotations of page i\n                            PdfArray annotationsArray = page.GetAsArray(PdfName.ANNOTS);\n\n                            // if page does not have annotations\n                            if (annotationsArray == null) {\n                                continue;\n                            }\n\n                            // for each annotation\n                            for (int j = 0; j &lt; annotationsArray.Size; j++) {\n                                // for current annotation\n                                PdfDictionary currentAnnotation = annotationsArray.GetAsDict(j);\n\n                                PdfDictionary annotationAction = currentAnnotation.GetAsDict(PdfName.AA);\n                                if (annotationAction == null) {\n                                    annotationsArray.Remove(j);\n                                    Console.Write(\"Removed annotation {0} with no action from page {1}\\n\", j, i);\n                                }\n                            }\n                        }   \n                    }\n                }\n\n                //grab the bytes before closing things out\n                bytes = ms.ToArray();\n            }\n\n            //write thebytes to disk\n            File.WriteAllBytes(\"output.pdf\", bytes);\n            Console.ReadKey();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "class", "entity"], "comments": [{"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 1, "creation_date": 1487194855, "post_id": 42260579, "comment_id": 71678796, "body": "<a href=\"https://en.wikipedia.org/wiki/Factory_method_pattern\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Factory_method_pattern</a>"}, {"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "reply_to_user": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 0, "creation_date": 1487195060, "post_id": 42260579, "comment_id": 71678907, "body": "@Matthew with the factory pattern, the caller knows what they want instantiated. As you can see in the C# code example, the factory still needs a switch."}, {"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 0, "creation_date": 1487195439, "post_id": 42260579, "comment_id": 71679120, "body": "That&#39;s one way to do a factory.  There are lots of others."}], "answers": [{"comments": [{"owner": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "edited": false, "score": 1, "creation_date": 1487195398, "post_id": 42260659, "comment_id": 71679102, "body": "With 200+ types, this is probably how I would do it."}, {"owner": {"reputation": 607, "user_id": 6869507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f47de3ffc0a9dfdef69bf98fea974db?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Powolozki", "link": "https://stackoverflow.com/users/6869507/alexander-powolozki"}, "reply_to_user": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "edited": false, "score": 0, "creation_date": 1487196500, "post_id": 42260659, "comment_id": 71679652, "body": "@MichaelGunter you can never know with how many types you have to deal in the future :)"}, {"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 2, "creation_date": 1487196591, "post_id": 42260659, "comment_id": 71679691, "body": "Personally if I had over 200 types already declared I&#39;d find a new pattern.  That sounds like a maintenance nightmare."}, {"owner": {"reputation": 607, "user_id": 6869507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f47de3ffc0a9dfdef69bf98fea974db?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Powolozki", "link": "https://stackoverflow.com/users/6869507/alexander-powolozki"}, "reply_to_user": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "edited": false, "score": 1, "creation_date": 1487196850, "post_id": 42260659, "comment_id": 71679809, "body": "@MatthewWhited the very first requirement for search for new pattern is the understanding that something is going wrong, which is not always present by affected persons"}], "tags": [], "owner": {"reputation": 607, "user_id": 6869507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f47de3ffc0a9dfdef69bf98fea974db?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Powolozki", "link": "https://stackoverflow.com/users/6869507/alexander-powolozki"}, "is_accepted": true, "score": 3, "last_activity_date": 1487196151, "last_edit_date": 1487196151, "creation_date": 1487195130, "answer_id": 42260659, "question_id": 42260579, "link": "https://stackoverflow.com/questions/42260579/how-do-i-create-an-object-with-its-type-defined-conditionally/42260659#42260659", "title": "How do I create an object with its type defined conditionally?", "body": "<p>Best way would be to define an Attribute-Subclass containing an ID property and then to annotate all types with the attribute providing a unique id for each type.<br>\nLayter you can collect and filter loaded types containing given attribute and filter by the ID property of the attribute.<br>\nWith this approach you could later add additional subtypes without the need to modify the consuming code.<br>\nThe implementation could look like:</p>\n\n<pre><code>public sealed class MyCustomAttribute : Attribute\n{\n    public ushort Id { get; set; }\n\n    public MyCustomAttribute(ushort id)\n    {\n        this.Id = id;\n    }\n}\n\npublic class MyDemoConsumer\n{\n    public void MyConsumingMethod(ushort requiredTypeId)\n    {\n        var requestedType = AppDomain\n            .CurrentDomain\n            .GetAssemblies()\n            .SelectMany(asm =&gt; asm.GetTypes())\n            .Where(type =&gt; type.GetCustomAttributes(typeof(MyCustomAttribute), false).Any())\n            .Select(type =&gt; new { Type = type, CustomId = type.GetCustomAttributes(typeof(MyCustomAttribute), false).Cast&lt;MyCustomAttribute&gt;().Single().Id })\n            .Where(item =&gt; item.CustomId == requiredTypeId)\n            .Select(item =&gt; item.Type)\n            .SingleOrDefault();\n\n        if (requestedType != null)\n        {\n            var result = Activator.CreateInstance(requestedType);\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8411, "user_id": 359157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gQiBp.png?s=128&g=1", "display_name": "TyCobb", "link": "https://stackoverflow.com/users/359157/tycobb"}, "edited": false, "score": 0, "creation_date": 1487195236, "post_id": 42260666, "comment_id": 71679003, "body": "I wrote the exact same thing... damn your quick fingers! +1"}, {"owner": {"reputation": 50118, "user_id": 913124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20dGq.jpg?s=128&g=1", "display_name": "Christos", "link": "https://stackoverflow.com/users/913124/christos"}, "edited": false, "score": 0, "creation_date": 1487195386, "post_id": 42260666, "comment_id": 71679098, "body": "@MichaelGunter very nice approach (+1) from me !"}], "tags": [], "owner": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "is_accepted": false, "score": 8, "last_activity_date": 1487195303, "last_edit_date": 1487195303, "creation_date": 1487195143, "answer_id": 42260666, "question_id": 42260579, "link": "https://stackoverflow.com/questions/42260579/how-do-i-create-an-object-with-its-type-defined-conditionally/42260666#42260666", "title": "How do I create an object with its type defined conditionally?", "body": "<p>If I understand your question, here's one way to go about it (there are many).</p>\n\n<pre><code>private static Dictionary&lt;ushort, Type&gt; TypeMap = new Dictionary&lt;ushort, Type&gt;()\n                                                   {\n                                                       { 1, typeof(TestEntity) },\n                                                       { 2, typeof(OtherEntity) }\n                                                   };\n\nprivate EntityBase CreateEntity(ushort id)\n{\n    var type = TypeMap[id];\n    return (EntityBase) Activator.CreateInstance(type);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "edited": false, "score": 1, "creation_date": 1487195579, "post_id": 42260732, "comment_id": 71679181, "body": "You get my +1 for using lambdas to avoid reflection."}, {"owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "reply_to_user": {"reputation": 11788, "user_id": 2360169, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/x8M06.jpg?s=128&g=1", "display_name": "Michael Gunter", "link": "https://stackoverflow.com/users/2360169/michael-gunter"}, "edited": false, "score": 0, "creation_date": 1487196275, "post_id": 42260732, "comment_id": 71679529, "body": "I like this pattern because it also makes it easy to provide parameters to the constructors where I would otherwise be unable to do so... such as <code>T Create&lt;T&gt;() where T class, new() {...}</code>"}], "tags": [], "owner": {"reputation": 21178, "user_id": 89586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe3afc9020eddb5c7445e286eead4a?s=128&d=identicon&r=PG", "display_name": "Matthew Whited", "link": "https://stackoverflow.com/users/89586/matthew-whited"}, "is_accepted": false, "score": 3, "last_activity_date": 1487195385, "creation_date": 1487195385, "answer_id": 42260732, "question_id": 42260579, "link": "https://stackoverflow.com/questions/42260579/how-do-i-create-an-object-with-its-type-defined-conditionally/42260732#42260732", "title": "How do I create an object with its type defined conditionally?", "body": "<p>... tons of ways of doing this but here's a simple one ...</p>\n\n<pre><code>class Program\n{\n    static void Main()\n    {\n        var simpleFactory = new SimpleFactory();\n        var entity = simpleFactory.Create(1);\n        entity.Something();\n    }\n}\n\npublic abstract class EntityBase\n{\n    public abstract ushort ID { get; }\n    public abstract void Something();\n}\n\npublic class TestEntity : EntityBase\n{\n    public override ushort ID { get { return 1; } }\n    public override void something() { }\n}\npublic class OtherEntity : EntityBase\n{\n    public override ushort ID { get { return 2; } }\n    public override void something() { }\n}\n\npublic class SimpleFactory\n{\n    private Dictionary&lt;ushort, Func&lt;EntityBase&gt;&gt; config = new Dictionary&lt;ushort, Func&lt;EntityBase&gt;&gt;\n    {\n        { 1, ()=&gt;new TestEntity()},\n        { 2, ()=&gt;new OtherEntity()},\n    };\n\n    public EntityBase Create(ushort entityId)\n    {\n        if (!config.ContainsKey(entityId))\n            throw new InvalidOperationException();\n\n        return config[entityId]();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 656012, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bf3721ab72b51a60358cf1a6c45fd0bd?s=128&d=identicon&r=PG", "display_name": "Exec", "link": "https://stackoverflow.com/users/656012/exec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 42260659, "answer_count": 3, "score": 2, "last_activity_date": 1487206880, "creation_date": 1487194772, "last_edit_date": 1487206880, "question_id": 42260579, "link": "https://stackoverflow.com/questions/42260579/how-do-i-create-an-object-with-its-type-defined-conditionally", "title": "How do I create an object with its type defined conditionally?", "body": "<p>I have a series of classes each having different properties and each of them having an ID (per-type not per-instance).</p>\n\n<p>Given the following:</p>\n\n<pre><code>public class TestEntity : EntityBase {\n    public override ushort ID { get; } = 1;\n    public override void something() { do_something(); }\n}\npublic class OtherEntity : EntityBase {\n    public override ushort ID { get; } = 2;\n    public override void something() { something_else(); }\n}\n</code></pre>\n\n<p>When reading data I only have a <code>ushort</code>:</p>\n\n<pre><code>ushort EntityId = BitConverter.ToUInt16(data.GetRange(CURRENT_POSITION + TILE_ENTITY_ID_OFFSET, TILE_ENTITY_ID_LENGTH).ToArray().Reverse().ToArray(), 0);\n</code></pre>\n\n<p>How do I use the value of <code>EntityId</code> to create different type of objects based on its value? Using <code>if</code> or <code>switch</code> statements is not an option as there will be more than 200 types.</p>\n"}, {"tags": ["c#", ".net", "visual-studio", ".net-framework-version"], "comments": [{"owner": {"reputation": 2806, "user_id": 884561, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26262f09f8ab613b167886a5d8b558ec?s=128&d=identicon&r=PG", "display_name": "Kenneth K.", "link": "https://stackoverflow.com/users/884561/kenneth-k"}, "edited": false, "score": 2, "creation_date": 1487194722, "post_id": 42260526, "comment_id": 71678736, "body": "Some classes were not available in 3.5. I believe Tasks didn&#39;t arrive until 4.0."}, {"owner": {"reputation": 385, "user_id": 2348046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66849468f80ef3027592e338080da126?s=128&d=identicon&r=PG", "display_name": "Craig Selbert", "link": "https://stackoverflow.com/users/2348046/craig-selbert"}, "edited": false, "score": 1, "creation_date": 1487196023, "post_id": 42260526, "comment_id": 71679404, "body": "Why are you moving the application from 4.5.2 to 3.5.1?  As others are saying here, there are many changes between those versions and yes you can move 3.5.1 to 4.5.1 easily,  moving backwards is a whole different beast."}, {"owner": {"reputation": 608, "user_id": 1596398, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/81e87ea542561d278a41b0d016d52158?s=128&d=identicon&r=PG&f=1", "display_name": "Hmmmmm", "link": "https://stackoverflow.com/users/1596398/hmmmmm"}, "edited": false, "score": 0, "creation_date": 1487198140, "post_id": 42260526, "comment_id": 71680456, "body": "The customer is saying they won&#39;t be able to migrate one system away from 3.5 for a while and they need to go live with this application. Believe me, I don&#39;t want to do it :)"}], "answers": [{"comments": [{"owner": {"reputation": 608, "user_id": 1596398, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/81e87ea542561d278a41b0d016d52158?s=128&d=identicon&r=PG&f=1", "display_name": "Hmmmmm", "link": "https://stackoverflow.com/users/1596398/hmmmmm"}, "edited": false, "score": 0, "creation_date": 1487198378, "post_id": 42260564, "comment_id": 71680554, "body": "Sorry for the newbie question, but how do I readd the System.Core.dll and mscorlib.dll references? I see the references section on the right hand side of the IDE but I don&#39;t see how to add System.Core.dll."}, {"owner": {"reputation": 7727, "user_id": 1411687, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9256a2cdde17f80bb2273952c9f6b22f?s=128&d=identicon&r=PG", "display_name": "Alex Wiese", "link": "https://stackoverflow.com/users/1411687/alex-wiese"}, "reply_to_user": {"reputation": 608, "user_id": 1596398, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/81e87ea542561d278a41b0d016d52158?s=128&d=identicon&r=PG&f=1", "display_name": "Hmmmmm", "link": "https://stackoverflow.com/users/1596398/hmmmmm"}, "edited": false, "score": 0, "creation_date": 1487200629, "post_id": 42260564, "comment_id": 71681406, "body": "@Hmmmmm you will need to remove them first, right-click on the reference and click Remove. Then re-add them by right-clicking on References and clicking Add References and then picking those two from the list."}, {"owner": {"reputation": 608, "user_id": 1596398, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/81e87ea542561d278a41b0d016d52158?s=128&d=identicon&r=PG&f=1", "display_name": "Hmmmmm", "link": "https://stackoverflow.com/users/1596398/hmmmmm"}, "edited": false, "score": 0, "creation_date": 1487200963, "post_id": 42260564, "comment_id": 71681539, "body": "Sorry, I should have been more clear. Originally I didn&#39;t see where to find System.Core but I found it. I don&#39;t see a mscorlib.dll referenced? Is that the same as Microsoft.CSharp?"}, {"owner": {"reputation": 7727, "user_id": 1411687, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9256a2cdde17f80bb2273952c9f6b22f?s=128&d=identicon&r=PG", "display_name": "Alex Wiese", "link": "https://stackoverflow.com/users/1411687/alex-wiese"}, "reply_to_user": {"reputation": 608, "user_id": 1596398, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/81e87ea542561d278a41b0d016d52158?s=128&d=identicon&r=PG&f=1", "display_name": "Hmmmmm", "link": "https://stackoverflow.com/users/1596398/hmmmmm"}, "edited": false, "score": 0, "creation_date": 1487203850, "post_id": 42260564, "comment_id": 71682445, "body": "Sorry replace the reference to System. Do any references have a yellow exclamation mark? Are there any Warnings in the Error List?"}], "tags": [], "owner": {"reputation": 7727, "user_id": 1411687, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9256a2cdde17f80bb2273952c9f6b22f?s=128&d=identicon&r=PG", "display_name": "Alex Wiese", "link": "https://stackoverflow.com/users/1411687/alex-wiese"}, "is_accepted": false, "score": 1, "last_activity_date": 1487195043, "last_edit_date": 1487195043, "creation_date": 1487194716, "answer_id": 42260564, "question_id": 42260526, "link": "https://stackoverflow.com/questions/42260526/compilation-error-when-changing-c-application-from-net-framework-4-5-2-to-3-5/42260564#42260564", "title": "Compilation error when changing C# application from .NET Framework 4.5.2 to 3.5", "body": "<p>Remove and re-add references to <code>System.Core.dll</code> and <code>mscorlib.dll</code>.</p>\n\n<p>The <code>Task</code> class will not be available as it was only added in .NET 4.0. You could use the nuget package <a href=\"https://www.nuget.org/packages/TaskParallelLibrary/\" rel=\"nofollow noreferrer\">Task Parallel Library for .NET 3.5</a> which is a backport of <code>Task</code> that works on .NET 3.5.</p>\n"}], "owner": {"reputation": 608, "user_id": 1596398, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/81e87ea542561d278a41b0d016d52158?s=128&d=identicon&r=PG&f=1", "display_name": "Hmmmmm", "link": "https://stackoverflow.com/users/1596398/hmmmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487195043, "creation_date": 1487194537, "question_id": 42260526, "link": "https://stackoverflow.com/questions/42260526/compilation-error-when-changing-c-application-from-net-framework-4-5-2-to-3-5", "title": "Compilation error when changing C# application from .NET Framework 4.5.2 to 3.5", "body": "<p>I have a C# application that works fine when compiled with a Target Framework of 4.5.2. However, when I change that setting in Visual Studio (Version 14.0.25424.00 Update 3) to 3.5 I get a bunch of errors and I am (obviously) not able to compile. Some of the errors I see have to do with trying to use the following namespaces and types:</p>\n\n<ol>\n<li>System.Net</li>\n<li>System.Xml</li>\n<li>System.Security.Authentication</li>\n<li>SslStream</li>\n<li>X509Certificate2</li>\n<li>System.Linq</li>\n<li>System.Threading.Tasks</li>\n</ol>\n\n<p>I saw some other posts about trying to modify the references and add a new System.Core library but nothing has worked so far.</p>\n"}, {"tags": ["c#", ".net", "file", "permissions", "directory-security"], "comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1487194705, "post_id": 42260390, "comment_id": 71678725, "body": "Probably should be duplicate of <a href=\"http://stackoverflow.com/questions/1339976/how-to-check-if-any-flags-of-a-flag-combination-are-set\" title=\"how to check if any flags of a flag combination are set\">stackoverflow.com/questions/1339976/&hellip;</a>, but need some tweaking of the question... so just comment instead of VTC."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7557934, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2997450b54fc361d43b57fa209acb56?s=128&d=identicon&r=PG&f=1", "display_name": "Madcode", "link": "https://stackoverflow.com/users/7557934/madcode"}, "edited": false, "score": 0, "creation_date": 1487228826, "post_id": 42262444, "comment_id": 71690720, "body": "Thanks. It workes but gives result 3 times, I suspect it counts all the accounts on the system."}], "tags": [], "owner": {"reputation": 1962, "user_id": 131431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ac9c37f8a690da1665770957db85ff?s=128&d=identicon&r=PG", "display_name": "Ehz", "link": "https://stackoverflow.com/users/131431/ehz"}, "is_accepted": false, "score": 0, "last_activity_date": 1487203619, "creation_date": 1487203619, "answer_id": 42262444, "question_id": 42260390, "link": "https://stackoverflow.com/questions/42260390/get-files-permissions-for-current-user-net/42262444#42262444", "title": "Get file&#39;s permissions for current user .net", "body": "<p>FileSystemRights is a flagged enum, that means you must perform an AND operation to test for a single value of the enum.</p>\n\n<pre><code>    string scanPath = @\"C:\\Test\";\n    string permissionShort = string.Empty;\n    DirectorySecurity dSecurity = Directory.GetAccessControl(scanPath);\n    foreach (FileSystemAccessRule rule in dSecurity.GetAccessRules(true, true, typeof(NTAccount)))\n    {\n        permissionShort += rule.FileSystemRights.ToString() + \" : \";\n        permissionShort += ((rule.FileSystemRights &amp; FileSystemRights.FullControl) == FileSystemRights.FullControl) ? \"f\" : \"-\";\n        permissionShort += ((rule.FileSystemRights &amp; FileSystemRights.Write)== FileSystemRights.Write) ? \"w\" : \"-\";\n        permissionShort += ((rule.FileSystemRights &amp; FileSystemRights.Read) == FileSystemRights.Read) ? \"r\" : \"-\";\n        permissionShort += ((rule.FileSystemRights &amp; FileSystemRights.AppendData) == FileSystemRights.AppendData) ? \"a\" : \"-\";\n        permissionShort += ((rule.FileSystemRights &amp; FileSystemRights.Modify) == FileSystemRights.Modify) ? \"m\" : \"-\";\n        permissionShort += ((rule.FileSystemRights &amp; FileSystemRights.ExecuteFile) == FileSystemRights.ExecuteFile) ? \"e\" : \"-\";\n        permissionShort += \"\\n\";\n    }\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7557934, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2997450b54fc361d43b57fa209acb56?s=128&d=identicon&r=PG&f=1", "display_name": "Madcode", "link": "https://stackoverflow.com/users/7557934/madcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487203619, "creation_date": 1487194053, "question_id": 42260390, "link": "https://stackoverflow.com/questions/42260390/get-files-permissions-for-current-user-net", "title": "Get file&#39;s permissions for current user .net", "body": "<p>I'm scanning the folder for files and I need to get each file's permissions for current user in any way to be represented as a string.\nSo for the attached file's properties I would like to represent something like <a href=\"https://i.stack.imgur.com/N417O.jpg\" rel=\"nofollow noreferrer\">f-m-r-w</a>\nstring.</p>\n\n<p>I'm trying to accomplish this in my scan loop like this, but getting empty strings. Could you hint to where should I go from here or chose another approach? Thanks in advance!</p>\n\n<pre><code>            string permissionShort = string.Empty;\n            DirectorySecurity dSecurity = Directory.GetAccessControl(_directory.FullName);\n            foreach (FileSystemAccessRule rule in dSecurity.GetAccessRules(true, true, typeof(NTAccount)))\n            {\n                if (rule.FileSystemRights == FileSystemRights.Write)\n                    permissionShort = permissionShort + \"x\";\n                if (rule.FileSystemRights == FileSystemRights.Read)\n                    permissionShort = permissionShort + \"x\";\n                if (rule.FileSystemRights == FileSystemRights.AppendData)\n                    permissionShort = permissionShort + \"x\";\n                if (rule.FileSystemRights == FileSystemRights.Modify)\n                    permissionShort = permissionShort + \"x\";\n                if (rule.FileSystemRights == FileSystemRights.ExecuteFile)\n                    permissionShort = permissionShort + \"x\";\n            }\n</code></pre>\n"}, {"tags": ["c#", "skype-for-business", "ucma"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7401621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c429b2653bf6549b4fbd5145c2a99a?s=128&d=identicon&r=PG&f=1", "display_name": "Monitor Hash", "link": "https://stackoverflow.com/users/7401621/monitor-hash"}, "is_accepted": true, "score": 0, "last_activity_date": 1490371832, "creation_date": 1490371832, "answer_id": 43004272, "question_id": 42260366, "link": "https://stackoverflow.com/questions/42260366/how-to-display-image-as-a-reply-using-ucma-skype-for-business/43004272#43004272", "title": "How to display image as a reply using UCMA skype for business", "body": "<p>I was able to resolve it by using \nMimePartContentDescription(new ContentType(\"multipart/alternative\").</p>\n\n<p>I cannot paste the working code for propriety reasons - but if you look for MimePartContentDescription(new ContentType(\"multipart/alternative\") you should see be able to read documenation/examples for usage. </p>\n\n<p>I did have a limitation of displaying image based on size - anything less than 40kb works. Its not a show stopper for me as the images are actually small in my use case. I will mark this as answered for now, but if someone has any idea why the sixe limitation I would love to know.</p>\n"}], "owner": {"reputation": 1, "user_id": 7401621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c429b2653bf6549b4fbd5145c2a99a?s=128&d=identicon&r=PG&f=1", "display_name": "Monitor Hash", "link": "https://stackoverflow.com/users/7401621/monitor-hash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 43004272, "answer_count": 1, "score": 0, "last_activity_date": 1490371832, "creation_date": 1487193991, "question_id": 42260366, "link": "https://stackoverflow.com/questions/42260366/how-to-display-image-as-a-reply-using-ucma-skype-for-business", "title": "How to display image as a reply using UCMA skype for business", "body": "<p>I have created an application that connects the user to a chat bot behind the scene. The responses from chat bot when text work fine but I also need to display images when necessary. Does anyone have any direction or code snippet I can use. I have this code that does not work</p>\n\n<pre><code>FileStream fs = File.OpenRead(@\"C:\\data\\logo2.png\");\n                var fileBytes = new byte[fs.Length];\n                fs.Read(fileBytes, 0, fileBytes.Length);\n\n                ContentType ct = new ContentType(\"image/png\");\n                ct.CharSet = \"UTF-8\";\n\n                byte[] bytes1 = Encoding.UTF8.GetBytes(fileBytes.ToString());\n\n                _instantMessagingFlow.BeginSendInstantMessage(ct, bytes1, SendMessageCompleted,\n                _instantMessagingFlow);\n</code></pre>\n"}, {"tags": ["c#", "ienumerable", "avl-tree"], "comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1487194159, "post_id": 42260365, "comment_id": 71678438, "body": "Set a breakpoint, step through the code? Your methods are calling themselves. Why do you implement <code>IEnumerable&lt;T&gt;</code>? What is <code>BSTree&lt;T&gt;</code>?"}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1487194220, "post_id": 42260365, "comment_id": 71678478, "body": "@CodeCaster This is another class, I have a BSTree, BinaryTree and AVLTree as well as a Node class which has the Left, Right, T Data and BalanceFactor getters/setters."}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1487194253, "post_id": 42260365, "comment_id": 71678501, "body": "Your GetEnumerator keeps calling itself. It will of course cause stack overflow. A debugger would show immediately this problem."}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1487194292, "post_id": 42260365, "comment_id": 71678518, "body": "@SamiKuhmonen How would I eliminate this loop?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1487194339, "post_id": 42260365, "comment_id": 71678543, "body": "<code>GetEnumerator</code> does nothing but call itself which results in the exception. If you&#39;ve implemented it in your base class you should just be able to remove this version."}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1487195276, "post_id": 42260365, "comment_id": 71679033, "body": "@Lee I can&#39;t as I&#39;m using <code>foreach (Country country in avlTree)</code> in my FormClass and I must implemented an IEnumerable inteface."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487195213, "post_id": 42260438, "comment_id": 71678988, "body": "Hello, thank you for your answer. My mistake is becoming more and more apparent. Just one question Isn&#39;t it meant to be <code>foreach</code> and instead of <code>var item</code> couldn&#39;t it be <code>Country item</code>? I&#39;ve never used this. Also I&#39;m struggling with the <code>in (?)</code>. All I have is a <code>Node&lt;T&gt;</code>, <code>rotateLeft</code>, <code>rotateRight</code> and <code>insertItem</code>. In my AVLTree class."}, {"owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "reply_to_user": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487195550, "post_id": 42260438, "comment_id": 71679164, "body": "Yes. <code>Country item</code> and <code>var item</code> mean the same thing. You can write any sort of for/foreach/while loop you like. The important part is to <code>yield return</code> each item. <a href=\"https://www.dotnetperls.com/yield\" rel=\"nofollow noreferrer\">dotnetperls.com/yield</a>"}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487195786, "post_id": 42260438, "comment_id": 71679290, "body": "I&#39;m just struggling to understand the <code>in (...)</code>. What should I put? <code>foreach (Country item in ... )</code> ."}, {"owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "reply_to_user": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487197187, "post_id": 42260438, "comment_id": 71680008, "body": "Can you post some code with how you typically walk your tree? Then I can adapt the answer based on your usage."}, {"owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "reply_to_user": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487198248, "post_id": 42260438, "comment_id": 71680498, "body": "So, the logic for how you would like to walk the tree isn&#39;t clear. It isn&#39;t a simple linear flow. Are you hoping to list every item on all branches? Are you hoping to walk one branch? Are you walking from trunk to leaf or from leaf to trunk?   It is likely that you will need to design the iteration flow, and then it will be easy for you to write the code."}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487198442, "post_id": 42260438, "comment_id": 71680589, "body": "Basically, I wish to read in a CSV file and use either a ListView or a DataGridView and display each column of the CSV file seperately i.e. CountryName, Inflation, GDP etc. I wish to load the CSV file&#39;s contents into the datastructure; AVLTree. And from there on remove, update, display, create, sort."}, {"owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "reply_to_user": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487198896, "post_id": 42260438, "comment_id": 71680772, "body": "A simpler solution might be to load the CSV into a List&lt;Country&gt;, and then separately use an instance of AVLTree. Then you can populate your DataGridView from the List. I&#39;m not sure that a DataGridView really is the right control for displaying Trees. Does that seem possible?"}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487199333, "post_id": 42260438, "comment_id": 71680955, "body": "How would I do that? I understand create a new instance of a List&lt;Country&gt; but to append iit to the AVLTree?"}, {"owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "reply_to_user": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487199608, "post_id": 42260438, "comment_id": 71681070, "body": "You could have the code who calls <code>tree.InsertItem()</code> also call <code>list.Add()</code>, and similar for remove/change/etc."}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487199718, "post_id": 42260438, "comment_id": 71681108, "body": "I have this, thus far <code>private AVLTree&lt;Country&gt; avlTree = new AVLTree&lt;Country&gt;();</code>, I create a temporary instance of a country <code>private LinkedList&lt;String&gt; tempCountry;</code> and after iterating through I use <code>avlTree.InsertItem(tempCountry);</code>"}, {"owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "reply_to_user": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487200157, "post_id": 42260438, "comment_id": 71681251, "body": "This sounds like a different scenario than the original question. If you are having a problem when implementing that, create a new StackOverflow question with the appropriate code, and I can help you out. I believe that the current issue (StackOverflow on GetEnumerator) has been answered."}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487201781, "post_id": 42260438, "comment_id": 71681810, "body": "I appreciate your help, still don&#39;t know what to do though when I type <code>in ...</code> . But none-the-less, thanks for your help."}, {"owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "reply_to_user": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487224105, "post_id": 42260438, "comment_id": 71688479, "body": "You an use <code>foreach</code> syntax in anything with an Enumerator. <code>IEnumerable&lt;string&gt; strings = new List&lt;string&gt;(); foreach (var str in strings)     Console.WriteLine(str);</code>"}, {"owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "edited": false, "score": 0, "creation_date": 1487253345, "post_id": 42260438, "comment_id": 71707918, "body": "Thanks, bud! Worked a charm, have another error but isn&#39;t in correlation to this. I&#39;ll accept your answer."}], "tags": [], "owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "is_accepted": true, "score": 0, "last_activity_date": 1487195441, "last_edit_date": 1487195441, "creation_date": 1487194228, "answer_id": 42260438, "question_id": 42260365, "link": "https://stackoverflow.com/questions/42260365/c-ienumerable-stackoverflowexception-avltree/42260438#42260438", "title": "C# - IEnumerable&lt;&gt; StackOverFlowException (AVLTree)", "body": "<p>You need to actually implement an enumerator. Right now your implementation loops infinitely by calling itself -- no enumerator is returned.</p>\n\n<pre><code>public IEnumerator&lt;Country&gt; GetEnumerator()\n{\n    // Some iterator/loop which uses \"yield return\" for each item\n    foreach (var item in items)\n        yield return item;\n}\n\nIEnumerator IEnumerable.GetEnumerator()\n{\n    return GetEnumerator();\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7534982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23828808a14765c1019cf3b362d1787?s=128&d=identicon&r=PG&f=1", "display_name": "ImTheOneWhoCodes", "link": "https://stackoverflow.com/users/7534982/imtheonewhocodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 42260438, "answer_count": 1, "score": 0, "last_activity_date": 1487197410, "creation_date": 1487193990, "last_edit_date": 1487197410, "question_id": 42260365, "link": "https://stackoverflow.com/questions/42260365/c-ienumerable-stackoverflowexception-avltree", "title": "C# - IEnumerable&lt;&gt; StackOverFlowException (AVLTree)", "body": "<p>I am having an issue with using <code>IEnumerable&lt;&gt;</code></p>\n\n<p>I am reading in a CSV File, I have my get/set methods sorted and I have tested my code before implementing <code>IEnumerable&lt;&gt;</code> and the Autos/Locals are displayed correctly.</p>\n\n<p>I'm trying to display the CSV file's content within a DataGridView</p>\n\n<pre><code>foreach (Country country in avlTree)\n                    {\n\n                      displayCountriesDataGridView.Rows.Add(country.CountryName, country.GDPGrowth, country.Inflation, country.TradeBalance, country.HDIRank, country.TradingPartners);\n\n                    }\n</code></pre>\n\n<p>And using an AVLTree and the <code>InsertItem</code> method I have wrote to append this data to the AVLTree</p>\n\n<pre><code>  avlTree.InsertItem(tempCountry);\n</code></pre>\n\n<p>This problem arises when I use:</p>\n\n<pre><code>class AVLTree&lt;T&gt; : BSTree&lt;T&gt;, IEnumerable&lt;Country&gt; where T : IComparable\n</code></pre>\n\n<p>I have implemented the interfaces :</p>\n\n<pre><code> public IEnumerator&lt;Country&gt; GetEnumerator()\n        {\n\n            return this.GetEnumerator();\n\n            throw new NotImplementedException();\n        }\n\n        IEnumerator IEnumerable.GetEnumerator()\n        {\n\n            return GetEnumerator();\n            throw new NotImplementedException();\n        }\n\n\n    }\n</code></pre>\n\n<p>However, no luck what-so-ever. </p>\n\n<p>In the Locals, I get this output-</p>\n\n<pre><code>$exception {\"Exception of type \"System.StackOverflowException' was thrown\"}\n</code></pre>\n\n<p>I get a red-cross and the name <code>this</code> with the value <code>Unable to read memory</code></p>\n\n<p>And <code>Type Variables T</code> has the value <code>System.__Canon</code></p>\n\n<p>I implemented <code>IEnumerable&lt;&gt;</code> in my Country class and no issues. </p>\n\n<p>I just can't seem to understand what is causing this issue. </p>\n\n<p>Could someone please offer some guidance or shed light on this matter.</p>\n\n<p>Thank you.</p>\n\n<p>EDIT - Implementation of my AVLTree</p>\n\n<pre><code>   class AVLTree&lt;T&gt; : BSTree&lt;T&gt;, IEnumerable&lt;Country&gt; where T : IComparable\n    {\n\n        Node&lt;T&gt; newRoot;\n\n\n\n        public new void InsertItem(T item)\n        {\n            insertItem(item, ref root);\n        }\n\n\n\n        private void insertItem(T item, ref Node&lt;T&gt; tree)\n        {\n            if (tree == null)\n            {\n                tree = new Node&lt;T&gt;(item);\n            }\n\n            else if (item.CompareTo(tree.Data) &lt; 0)\n            {\n                insertItem(item, ref tree.Left);\n            }\n            else if (item.CompareTo(tree.Data) &gt; 0)\n            {\n                insertItem(item, ref tree.Right);\n            }\n\n            tree.BalanceFactor = Height(ref tree.Left) - Height(ref tree.Right);\n\n            if (tree.BalanceFactor &lt;= -2)\n            {\n                rotateLeft(ref tree);\n            }\n            if (tree.BalanceFactor &gt;= 2)\n            {\n                rotateRight(ref tree);\n            }\n        }\n\n\n\n\n        private void rotateRight(ref Node&lt;T&gt; tree)\n        {\n            if (tree.Left.BalanceFactor &lt; 0)\n            {\n                rotateLeft(ref tree.Left);\n            }\n            newRoot = tree.Left;\n            tree.Left = newRoot.Right;\n            newRoot.Right = tree;\n            tree = newRoot;\n\n        }\n\n\n        private void rotateLeft(ref Node&lt;T&gt; tree)\n        {\n            if (tree.Right.BalanceFactor &gt; 0)\n            {\n                rotateRight(ref tree.Right);\n            }\n\n            newRoot = tree.Right;\n            tree.Right = newRoot.Left;\n            newRoot.Left = tree;\n            tree = newRoot;\n\n        }\n\n        public IEnumerator&lt;Country&gt; GetEnumerator()\n        {\n            // Some iterator/loop which uses \"yield return\" for each item\n\n        }\n\n\n        IEnumerator IEnumerable.GetEnumerator()\n        {\n            return GetEnumerator();\n        }\n</code></pre>\n"}, {"tags": ["c#", "excel", "visual-studio", "epplus"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1487200383, "post_id": 42260357, "comment_id": 71681325, "body": "The debugger in VS2015 is a crappy bag &#39;o bugs, it won&#39;t let you look at the InnerException.  Use Tools &gt; Options &gt; Debugging &gt; General &gt; tick &quot;Use Managed Compatibility Mode&quot; and now you can see it.  Careful with those statics, their initializer can byte you in the rear end badly."}, {"owner": {"reputation": 1645, "user_id": 3346752, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3CyPY.jpg?s=128&g=1", "display_name": "3therk1ll", "link": "https://stackoverflow.com/users/3346752/3therk1ll"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1487237640, "post_id": 42260357, "comment_id": 71696091, "body": "@HansPassant I will check that out when I get in. Can you elaborate or post an &#39;answer&#39; regarding the statics warning you mentioned?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1487238938, "post_id": 42260357, "comment_id": 71697090, "body": "I don&#39;t know the answer.  I&#39;d guess at NullReferenceException since <code>_excelFile</code> is still null, you can get a fact by using the debugger tweak I recommended."}], "answers": [{"tags": [], "owner": {"reputation": 1645, "user_id": 3346752, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3CyPY.jpg?s=128&g=1", "display_name": "3therk1ll", "link": "https://stackoverflow.com/users/3346752/3therk1ll"}, "is_accepted": true, "score": 1, "last_activity_date": 1487249188, "creation_date": 1487249188, "answer_id": 42274397, "question_id": 42260357, "link": "https://stackoverflow.com/questions/42260357/typeinitializationexception-with-epplus-script/42274397#42274397", "title": "TypeInitializationException with EPPlus script", "body": "<p>So, turns out the issue was staring me in the face, I went through below steps provided by, Hans Passant in the issue comments:</p>\n\n<blockquote>\n  <p>\"The debugger in VS2015 is a crappy bag 'o bugs, it won't let you look\n  at the InnerException. Use Tools > Options > Debugging > General >\n  tick \"Use Managed Compatibility Mode\" and now you can see it. Careful\n  with those statics, their initializer can byte you in the rear end\n  badly.\"</p>\n</blockquote>\n\n<p>It was a null reference exception caused by me declaring the excel file with a path argument that had yet to be declared itself.</p>\n\n<pre><code>private static ExcelPackage _package = new ExcelPackage(new FileInfo(_excelFile));\nprivate static string _excelFile = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop),\n                \"Compare GNED and TOP V1.0.xlsx\");\n</code></pre>\n"}], "owner": {"reputation": 1645, "user_id": 3346752, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3CyPY.jpg?s=128&g=1", "display_name": "3therk1ll", "link": "https://stackoverflow.com/users/3346752/3therk1ll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 42274397, "answer_count": 1, "score": 0, "last_activity_date": 1487249188, "creation_date": 1487193961, "question_id": 42260357, "link": "https://stackoverflow.com/questions/42260357/typeinitializationexception-with-epplus-script", "title": "TypeInitializationException with EPPlus script", "body": "<p>I am trying to run a script to read values from an Excel sheet using <code>EPPlus</code> and load them into a list of tuples.\nHowever when I run the script I am getting two errors, the first is:</p>\n\n<pre><code>An unhandled exception of type 'System.TypeInitializationException' occurred in mscorlib.dll\n</code></pre>\n\n<p>I have seen in other posts that I need to check for the inner exception, however none is offered by Visual Studio 15.\nThis is all the exception details that are available.</p>\n\n<pre><code>System.TypeInitializationException was unhandled\nMessage: An unhandled exception of type 'System.TypeInitializationException' occurred in mscorlib.dll\nAdditional information: The type initializer for 'CGCompare2.Program' threw an exception.\n</code></pre>\n\n<p>Then when I close the VS15 exception window I get a pop up dialogue:</p>\n\n<pre><code>Cannot access a disposed object.\nObject name: 'HwndSourceAdapter'\n</code></pre>\n\n<p>I am unsure what the issue is, if this is caused by my code or not. Any help, much appreciated.</p>\n\n<p><code>Program.cs</code></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing OfficeOpenXml;\n\nnamespace CGComparer\n{\n    class Program\n    {\n        private static List&lt;Tuple&lt;string, string&gt;&gt; _listTop;\n        private static List&lt;Tuple&lt;string, string&gt;&gt; _listGNED;\n        private static Base _baseCell;\n        private static ExcelPackage _package = new ExcelPackage(new FileInfo(_excelFile));\n        private static string _excelFile = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop),\n                \"Compare GNED and TOP V1.0.xlsx\");\n\n        static void Main(string[] args)\n        {\n            _baseCell = new Base(1, 2);\n            _listTop = ColumnsToList(_baseCell.Column(),_baseCell.Row());\n\n            _baseCell = new Base(3, 2);\n            _listGNED = ColumnsToList(_baseCell.Column(),_baseCell.Row());\n        }\n\n        public static List&lt;Tuple&lt;string, string&gt;&gt; ColumnsToList(int column, int row)\n        {\n            var list = new List&lt;Tuple&lt;string, string&gt;&gt;();\n            var ws = _package.Workbook.Worksheets[1];\n            var ListIsValid = true;\n            do\n            {\n                var userEmail = (string)ws.Cells[column, row].Value;\n                var customerGroup = (string)ws.Cells[column + 1, row].Value;\n\n                if (!string.IsNullOrEmpty(userEmail))\n                {\n                    list.Add(new Tuple&lt;string, string&gt;(userEmail, customerGroup));\n                    row = row++;\n                }\n                else\n                {\n                    ListIsValid = false;\n                }\n\n            } while (ListIsValid);\n\n            return list;\n        }\n    }\n}\n</code></pre>\n\n<p><code>Base.cs</code></p>\n\n<pre><code>namespace CGComparer\n{\n    public class Base\n    {\n        private static int _column;\n        private static int _row;\n\n        public Base(int column, int row)\n        {\n            _column = column;\n            _row = row;\n        }\n\n        public int Column()\n        {\n            return _column;\n        }\n\n        public int Row()\n        {\n            return _row;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "xml", "winforms"], "comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 2, "creation_date": 1487194029, "post_id": 42260318, "comment_id": 71678386, "body": "Does it work?  Leave it be and move on to other higher priority options.  And please take the time to format your code - thanks :)"}, {"owner": {"reputation": 49, "user_id": 6525696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hMzxL.jpg?s=128&g=1", "display_name": "TAdams79", "link": "https://stackoverflow.com/users/6525696/tadams79"}, "reply_to_user": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1487195257, "post_id": 42260318, "comment_id": 71679023, "body": "I did format the code. I was under the impression that all must be tabbed in 4 spaces. It works, however I cannot gain access to the file. It says it doesn&#39;t exist but yet it does."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1487199675, "post_id": 42260318, "comment_id": 71681095, "body": "Any data that is used by more than one person at the same time should be stored in a database since file sharing on Windows can cause problems.  A database base is designed to handle conflicts when more than one user attempts to use same data at the same time."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6525696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hMzxL.jpg?s=128&g=1", "display_name": "TAdams79", "link": "https://stackoverflow.com/users/6525696/tadams79"}, "edited": false, "score": 0, "creation_date": 1487202956, "post_id": 42262039, "comment_id": 71682184, "body": "Thanks for all the replies. The email addresses do not change a lot, however I am thinking ahead. There are people who will be retiring at some point in that list or quit for whatever reason. My idea was to be able to give managers an easy way of updating that list. There are different cases in which the distribution list is changed depending on what the user has entered into the form."}], "tags": [], "owner": {"reputation": 1962, "user_id": 131431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63ac9c37f8a690da1665770957db85ff?s=128&d=identicon&r=PG", "display_name": "Ehz", "link": "https://stackoverflow.com/users/131431/ehz"}, "is_accepted": true, "score": 0, "last_activity_date": 1487201861, "last_edit_date": 1487201861, "creation_date": 1487201152, "answer_id": 42262039, "question_id": 42260318, "link": "https://stackoverflow.com/questions/42260318/xmlreader-other-options/42262039#42262039", "title": "XmlReader Other Options", "body": "<p>There isn't necessarily anything wrong with flat file configuration files. It really depends on your use case. How often do the emails in the file change? How many entries are there? Do users of the application edit the list? Are there any complex rules where different addresses will get sent different emails?</p>\n\n<p>If this just a simple mailing list that doesn't change often it's probably fine to use the xml file. You could also just create an email distribution list to send to instead, like ApplicationDiscrepancyReport. That way you can just manage the recipients in active directory. If you stick with the XML email addresses, at the very least I would try to get rid of the hardcoded path to the xml file located on your file share.</p>\n\n<p>If the email addresses change a lot, and are changed by users of the application, I would recommend moving this to a SQL database. If the recipients list is changing frequently you may want to add tracking of when these addresses get edited as well.</p>\n"}], "owner": {"reputation": 49, "user_id": 6525696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hMzxL.jpg?s=128&g=1", "display_name": "TAdams79", "link": "https://stackoverflow.com/users/6525696/tadams79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 42262039, "answer_count": 1, "score": 0, "last_activity_date": 1487219678, "creation_date": 1487193797, "last_edit_date": 1487219678, "question_id": 42260318, "link": "https://stackoverflow.com/questions/42260318/xmlreader-other-options", "title": "XmlReader Other Options", "body": "<p>I am currently working on an application for the company I work for. Part of this application deals with discrepancy reporting and sending emails out when a new discrepancy number has been created. First, it is important to realize that I am redeveloping this application from VB.NET to C#. In the old application the developer chose to read an XML file for a few email addresses. I've read to use alternate options unless the XML file is full of information. This is not intended to be an opinionated question and sorry if this sounds like one. However, I am looking for the correct way of doing this. Should these email addresses be kept in a database table for easy adding/deleting or is there a more standardized way to do this? Please find the current code below.</p>\n\n<pre><code>public void PrepareEmail(string subject, string message)\n{\n\n    if (MessageBox.Show(@\"Are you sure you want to save and send Discrepancy Report: \" + tbxDRNumber.Text + @\"?\\n Click YES to save\\n Click NO to cancel\", @\"Confirm\", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.Yes)\n    {\n\n        SendEmail(subject, message);\n    }\n}\n\npublic Array AddEmail()\n{\n\n    string[] dRemail = { \"\", \"\", \"\" };\n\n    if (File.Exists(@\"\\\\fs01\\Applications\\EMS-Manager\\DREmailAddresses.xml\"))\n    {\n        XmlReader emailDocument = new XmlTextReader(@\"\\\\fs01\\Applications\\EMS-Manager\\DREmailAddresses.xml\");\n\n        while (emailDocument.Read())\n        {\n            var type = emailDocument.NodeType;\n\n            switch (type)\n            {\n                case XmlNodeType.Element:\n                    if (emailDocument.Name == \"DRCreatedAddEmail\")\n                    {\n                        dRemail[0] = emailDocument.ReadInnerXml();\n                    }\n                    if (emailDocument.Name == \"DRActionNeededAddEmail\")\n                    {\n                        dRemail[1] = emailDocument.ReadInnerXml();\n                    }\n                    if (emailDocument.Name == \"DRPendingAddEmail\")\n                    {\n                        dRemail[2] = emailDocument.ReadInnerXml();\n                    }\n                    else\n                    {\n                        MessageBox.Show(@\"The file: 'DREmailAddresses.xml' was not found at: \\\\fs01\\Applications\\EMS-Manager\");\n                    }\n                    break;\n            }\n        }\n    }\n\n    return dRemail;\n}\n\npublic void SendEmail(string subjectText, string bodyText)\n{\n\n    string[] email = (string[])AddEmail();\n    //object oOutlook = default(Microsoft.Office.Interop.Outlook.Application);\n    var oMessage = default(MailItem);\n    Activator.CreateInstance(Type.GetTypeFromProgID(\"Outlook.Application\"));\n\n    if (subjectText == \"New Discrepancy Created. DR\" + tbxDRNumber.Text + \"  \")\n    {\n        oMessage.To = email[0];\n        oMessage.Subject = subjectText;\n        oMessage.HTMLBody = bodyText;\n\n        try\n        {\n            oMessage.Send();\n        }\n        catch (System.Exception e)\n        {\n            MessageBox.Show(@\"Send Failed with error: \" + e);\n            throw;\n        }\n    }\n    else if (subjectText == tbxDRNumber.Text + \" - Action Needed\")\n    {\n        oMessage.To = email[1];\n        oMessage.Subject = subjectText;\n        oMessage.HTMLBody = bodyText;\n\n        try\n        {\n            oMessage.Send();\n        }\n        catch (System.Exception e)\n        {\n            MessageBox.Show(@\"Send Failed with error: \" + e);\n            throw;\n        }\n    }\n    else if (subjectText == tbxDRNumber.Text + \"DR Pending Approval\")\n    {\n        oMessage.To = email[2];\n        oMessage.Subject = subjectText;\n        oMessage.HTMLBody = bodyText;\n\n        try\n        {\n            oMessage.Send();\n        }\n        catch (System.Exception e)\n        {\n            MessageBox.Show(@\"Send Failed with error: \" + e);\n            throw;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "outlook", "ms-word", "vsto", "mailitem"], "answers": [{"tags": [], "owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1492288000, "creation_date": 1492288000, "answer_id": 43430945, "question_id": 42260257, "link": "https://stackoverflow.com/questions/42260257/modify-htmlbody-for-inline-response-in-outlook/43430945#43430945", "title": "Modify HTMLBody for Inline Response in outlook", "body": "<p>Try to use the <code>Save</code> method of the MailItem class.</p>\n"}, {"tags": [], "owner": {"reputation": 690, "user_id": 3967709, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cbd703ea47b16b8f56e2f8f639c93ea7?s=128&d=identicon&r=PG&f=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/3967709/gokul"}, "is_accepted": false, "score": 1, "last_activity_date": 1495786769, "creation_date": 1495786769, "answer_id": 44196828, "question_id": 42260257, "link": "https://stackoverflow.com/questions/42260257/modify-htmlbody-for-inline-response-in-outlook/44196828#44196828", "title": "Modify HTMLBody for Inline Response in outlook", "body": "<pre><code>Outlook.MailItem newmail = item.Reply();\nnewmail.BodyFormat = Outlook.OlBodyFormat.olFormatHTML;\nnewmail.HTMLBody = item.HTMLBody.Replace(\"Test\", \"INLINE BODY\");\n</code></pre>\n\n<p>You can try getting the reply of the mail and doing changes in that.</p>\n"}], "owner": {"reputation": 591, "user_id": 742374, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2934dc85ee4064f4089973556de9f29e?s=128&d=identicon&r=PG", "display_name": "Matt Kagan", "link": "https://stackoverflow.com/users/742374/matt-kagan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1495786769, "creation_date": 1487193518, "last_edit_date": 1487810519, "question_id": 42260257, "link": "https://stackoverflow.com/questions/42260257/modify-htmlbody-for-inline-response-in-outlook", "title": "Modify HTMLBody for Inline Response in outlook", "body": "<p>I am trying to modify the body of an inline reply in Outlook. I need to insert HTML into the inline response editor. </p>\n\n<p>I am trying to do it like this:</p>\n\n<pre><code>                    var explorer = application.ActiveExplorer();\n                    MailItem item = explorer.ActiveInlineResponse;\n                    item.Subject = \"INLINE SUBJECT\";\n                    item.HTMLBody = item.HTMLBody.Replace(\"Test\", \"INLINE BODY\");\n</code></pre>\n\n<p>For some reason, the item.Subject is set correctly but the body doesn't get set. I used the replace to make sure I wasn't messing up the HTML - I thought I would just try to replace a word with another word without modifying the HTML.</p>\n\n<p>I tried changing the text in the inline response using <code>ActiveInlineResponseWordEditor</code> which worked - but the problem is that I need to insert HTML and I dont know how to do that using the word editor object.</p>\n\n<p>Any ideas of how I can either successfully modify the <code>HtmlBody</code> or insert html using <code>ActiveInlineResponseWordEditor</code> ? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", "asp.net-mvc", "entity-framework", "generics"], "comments": [{"owner": {"reputation": 1, "user_id": 7571304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84466ca564e34eb0e9d57454b34020a7?s=128&d=identicon&r=PG&f=1", "display_name": "T.Stanford", "link": "https://stackoverflow.com/users/7571304/t-stanford"}, "edited": false, "score": 0, "creation_date": 1487194748, "post_id": 42260245, "comment_id": 71678744, "body": "there are occasional misspellings or plurals left out of Class/Service/Controller names, due to sensitivity.  I do not have issues along those lines here..."}, {"owner": {"reputation": 3615, "user_id": 853295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a1p7H.jpg?s=128&g=1", "display_name": "garethb", "link": "https://stackoverflow.com/users/853295/garethb"}, "edited": false, "score": 0, "creation_date": 1487217293, "post_id": 42260245, "comment_id": 71686206, "body": "Can you post your generic repository code?"}, {"owner": {"reputation": 1, "user_id": 7571304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84466ca564e34eb0e9d57454b34020a7?s=128&d=identicon&r=PG&f=1", "display_name": "T.Stanford", "link": "https://stackoverflow.com/users/7571304/t-stanford"}, "reply_to_user": {"reputation": 3615, "user_id": 853295, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/a1p7H.jpg?s=128&g=1", "display_name": "garethb", "link": "https://stackoverflow.com/users/853295/garethb"}, "edited": false, "score": 0, "creation_date": 1487253193, "post_id": 42260245, "comment_id": 71707789, "body": "added to the OP, with naming corrections added"}, {"owner": {"reputation": 31485, "user_id": 809357, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fe164036841e4bc8029ea2f842a5e5d7?s=128&d=identicon&r=PG", "display_name": "trailmax", "link": "https://stackoverflow.com/users/809357/trailmax"}, "edited": false, "score": 0, "creation_date": 1487255242, "post_id": 42260245, "comment_id": 71709568, "body": "Your class  &#39;MyTables.DataAccess.Account&#39; must implement <code>IMyTableEntity</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7571304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84466ca564e34eb0e9d57454b34020a7?s=128&d=identicon&r=PG&f=1", "display_name": "T.Stanford", "link": "https://stackoverflow.com/users/7571304/t-stanford"}, "is_accepted": false, "score": 0, "last_activity_date": 1487258058, "creation_date": 1487258058, "answer_id": 42277821, "question_id": 42260245, "link": "https://stackoverflow.com/questions/42260245/generic-mvc-controller-cannot-provide-delegate-to-ef-findby-function/42277821#42277821", "title": "Generic MVC Controller cannot provide delegate to EF FindBy function", "body": "<p>trailmax may have found it...</p>\n\n<blockquote>\n  <p>Your class 'MyTables.DataAccess.Account' must implement IMyTableEntity</p>\n</blockquote>\n\n<p>My Data modelling is set up in this way:</p>\n\n<ol>\n<li><p>EF base partial classes:</p>\n\n<pre><code>public partial class Accounts  {\n   public int Id { get; set; }\n   public string Code { get; set; }\n   public string Description { get; set; }\n}\n</code></pre></li>\n<li><p>Metadata models that contain data Annotations:</p>\n\n<pre><code>public class AccountsMetadata : MyTables.DataAccess.Metadata.Base.MyTableEntity {\n[Key]\n[Required]\n[UniqueValidator]        \npublic string Code { get; set; }\n\n[Display(Name=\"Description\")]\n[StringLength(100)]\npublic string Description { get; set; }\n}\n</code></pre></li>\n<li><p>a bootstrap that ties them together</p>\n\n<pre><code>[MetadataType(typeof(AccountsMetadata))]\n  public partial class Accounts { }\n</code></pre></li>\n</ol>\n\n<p>what i needed to do was add the implementation of the interface to the bootstrap definitions for every partial, i.e.:</p>\n\n<pre><code>[MetadataType(typeof(AccountsMetadata))]\npublic partial class Accounts : MyTables.DataAccess.Metadata.Base.IMyTableEntity { }\n</code></pre>\n\n<p>and then follow that up by setting the IMyTableEntity interface as a constraint on T in the Generic Controller, as i outlined above... </p>\n"}], "owner": {"reputation": 1, "user_id": 7571304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84466ca564e34eb0e9d57454b34020a7?s=128&d=identicon&r=PG&f=1", "display_name": "T.Stanford", "link": "https://stackoverflow.com/users/7571304/t-stanford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576348035, "creation_date": 1487193474, "last_edit_date": 1576348035, "question_id": 42260245, "link": "https://stackoverflow.com/questions/42260245/generic-mvc-controller-cannot-provide-delegate-to-ef-findby-function", "title": "Generic MVC Controller cannot provide delegate to EF FindBy function", "body": "<p>I am wrapping up a generically-crafted SQL table editor for a configuration application, using Entity Framework, a Repository pattern, so on and so forth.  Probably a bit overkill on the layers.  In any case, I have a generic MVC controller (we'll call it <code>MyController&lt;T&gt;</code>) looking to send its calls to a generic service layer (<code>MyServices&lt;T&gt;</code>), where everything \"of T\" is some data model class representing a SQL table, directly.  Each and every data model class has an ident field called \"Id\", that is implemented from a base model (that itself, is implementing an interface).   </p>\n\n<p>Everything is very simple and smooth, except when I need to call the FindBy option on a data set, where i have to provide a delegate to search on something of a generic type.  I understand that the type constraints need to have an interface attached to it so that I can access that \"Id\" field in any type T, but doing so causes conflict with any controllers that explicitly implement the generic controller.  So:</p>\n\n<p>Generic Service layer:</p>\n\n<pre><code>public abstract class MyServices&lt;T&gt; : IMyService&lt;T&gt; where T : class,  new()\n{\n    IMyRepository&lt;T&gt; _MyRepository;\n\n    public MyServices(IMyRepository&lt;T&gt; MyRepository)\n    {\n        _MyRepository = MyRepository;\n    }\n    public IQueryable&lt;T&gt; FindBy(System.Linq.Expressions.Expression&lt;Func&lt;T, bool&gt;&gt; predicate)\n    {\n       return _MyRepository.FindBy(predicate);\n    }\n}\n</code></pre>\n\n<p>Generic Repository:</p>\n\n<pre><code>public partial class MyRepository&lt;T&gt; : IMyRepository&lt;T&gt; where T : class, new() \n{\n     MyTablesEntities _entities = new MyTablesEntities();\n\n     public IQueryable&lt;T&gt; FindBy(System.Linq.Expressions.Expression&lt;Func&lt;T, bool&gt;&gt; predicate)\n    {\n\n        IQueryable&lt;T&gt; query = _entities.Set&lt;T&gt;().Where(predicate);\n        return query;\n    }\n}\n</code></pre>\n\n<p>Generic Controller:</p>\n\n<pre><code>public class MyController&lt;T&gt; : Controller where T : class, new()\n{\n    private string ViewTitle = typeof(T).ToString();\n    private readonly IMyServices&lt;T&gt; _MyServices = default(IMyServices&lt;T&gt;);\n\n    public MyController() { }\n\n    public MyController(IMyServices&lt;T&gt; mtt)\n    {\n        _MyServices = mtt;\n    }\n\n public ActionResult Edit(int? id) \n    {\n        if (id == null)\n        {\n            return new HttpStatusCodeResult(HttpStatusCode.BadRequest);\n        }\n\n        T editItem = _MyServices.FindBy(c =&gt; **c.Id == id**).SingleOrDefault(); \n\n        if (editItem == null)\n        {\n            return HttpNotFound();\n        }\n\n        return PartialView(editItem);\n    }\n}\n</code></pre>\n\n<p>and a Controller using MyController:</p>\n\n<pre><code> public class AccountsController : MTTablesController&lt;Accounts&gt;\n{  }\n</code></pre>\n\n<p>Obviously, with this setup, the FindBy delegate clause cannot differentiate the type of T until runtime, so it fails to compile this way, giving: </p>\n\n<blockquote>\n  <p>'T' does not contain a definition for 'Id' and no extension method 'Id' accepting a first argument of type 'T' could be found </p>\n</blockquote>\n\n<p>If, however, I add the interface (IMyTableEntity) that contains a property of 'Id' to the constraint of the generic controller:</p>\n\n<pre><code>public class MyController&lt;T&gt; : Controller where T : class, MyTables.DataAccess.Metadata.Base.IMyTableEntity, new()\n\npublic interface IMyTableEntity\n{\n    int Id { get; set; }\n}\n</code></pre>\n\n<p>I now get THIS error, over on the implementing Controller:</p>\n\n<blockquote>\n  <p>The type 'MyTables.DataAccess.Account' cannot be used as type parameter 'T' in the generic type or method 'MyController&lt;T>'. There is no implicit reference conversion from 'MyTables.DataAccess.Account' to 'MyTables.DataAccess.Metadata.Base.IMyTableEntity'.   </p>\n</blockquote>\n\n<p>I am at an impasse here as both errors lead me back into trying the other way, neither of which are working.  I need the generic 'T' on the generic controller  to be smart enough to carry the Id field with it, without confusing the implementing controllers above it.</p>\n"}, {"tags": ["c#", "xamarin", "mvvmcross"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 1, "creation_date": 1487193017, "post_id": 42260065, "comment_id": 71677854, "body": "Why can&#39;t you just call <code>BSelected</code>?"}, {"owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1487193155, "post_id": 42260065, "comment_id": 71677930, "body": "<code>BSelected</code> looks for a parameter - <code>bViewModel</code>?, but how <code>ICommand</code> calls it without passing paramater?"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1487193208, "post_id": 42260065, "comment_id": 71677963, "body": "I don&#39;t get what you&#39;re asking."}, {"owner": {"reputation": 3672, "user_id": 828184, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Drsll.png?s=128&g=1", "display_name": "CodingYourLife", "link": "https://stackoverflow.com/users/828184/codingyourlife"}, "edited": false, "score": 0, "creation_date": 1487193276, "post_id": 42260065, "comment_id": 71678000, "body": "It&#39;s hard to tell because it&#39;s unclear what BViewModel is in your example."}, {"owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "edited": false, "score": 0, "creation_date": 1487193280, "post_id": 42260065, "comment_id": 71678005, "body": "I need to call <code>BSelected()?</code> or <code>BSelected(bViewModel)</code>. I am asking because <code>MvxCommand&lt;BViewModel&gt;(BSelected)</code> passing <code>bViewModel</code>"}, {"owner": {"reputation": 3672, "user_id": 828184, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Drsll.png?s=128&g=1", "display_name": "CodingYourLife", "link": "https://stackoverflow.com/users/828184/codingyourlife"}, "edited": false, "score": 0, "creation_date": 1487193431, "post_id": 42260065, "comment_id": 71678094, "body": "Because you have &quot;BViewModel bViewModel&quot; as parameter you need to pass something of type BViewModel. You could pass null but you have a null check in your method. If you have a field called bViewModel as your comment suggests BSelected(bViewModel); would call the method, yes"}, {"owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "edited": false, "score": 0, "creation_date": 1487193868, "post_id": 42260065, "comment_id": 71678301, "body": "how can I call <code>IMvxCommand BSelectedCommand</code> programatically?"}, {"owner": {"reputation": 3672, "user_id": 828184, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Drsll.png?s=128&g=1", "display_name": "CodingYourLife", "link": "https://stackoverflow.com/users/828184/codingyourlife"}, "edited": false, "score": 0, "creation_date": 1487194290, "post_id": 42260065, "comment_id": 71678517, "body": "I&#39;m unfamiliar with this framework but usually you have something like BSelectedCommand.Execute(); but as you noticed you need to pass BViewModel. Also if you call the command instead of the method you need to pass that. Maybe you are looking for BSelectedCommand.Execute(new BViewModel()); this would pass a NEW BViewModel object. You need to share more code if that doesn&#39;t answer your question"}], "answers": [{"tags": [], "owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "is_accepted": false, "score": 0, "last_activity_date": 1487196522, "creation_date": 1487196522, "answer_id": 42261023, "question_id": 42260065, "link": "https://stackoverflow.com/questions/42260065/call-a-method-in-the-viewmodel-programatically/42261023#42261023", "title": "Call a method in the ViewModel Programatically", "body": "<p>I assume IMvxCommand has a method called \"Excute(BSelected)\" - it would be a typical MVVM command object then. In which case you </p>\n\n<pre><code>AViewModel avm = new AViewModel();\navm.BSelectCommand.Execute(new BViewModel());\n</code></pre>\n"}], "owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487196522, "creation_date": 1487192862, "question_id": 42260065, "link": "https://stackoverflow.com/questions/42260065/call-a-method-in-the-viewmodel-programatically", "title": "Call a method in the ViewModel Programatically", "body": "<p>I have A and B ViewModels, and I add a click button to call a method. However, I wonder how could I call it programatically without clicking on the button</p>\n\n<p><strong>AViewModel.cs</strong></p>\n\n<pre><code>public IMvxCommand BSelectedCommand =&gt; new MvxCommand&lt;BViewModel&gt;(BSelected);\n\npublic void BSelected(BViewModel bViewModel)\n{\n    if (bViewModel != null)\n    {\n       SelectedStudents = bViewModel;\n       bViewModel.IsSelected = true;\n    }\n }\n</code></pre>\n"}, {"tags": ["c#", "xaml", "uwp", "launcher"], "comments": [{"owner": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 1, "creation_date": 1487226548, "post_id": 42259980, "comment_id": 71689551, "body": "Realistically this has nothing to do with T10 either, but basic design.  Unfortunately, unless MS Dynamics AX is a UWP app you will probably be SOL. Ultimately this is something that won&#39;t work since the design of UWP prevents you from working in directories outside of your profile."}, {"owner": {"reputation": 135, "user_id": 7540846, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh4.googleusercontent.com/-UluzFmJA39k/AAAAAAAAAAI/AAAAAAAAArg/adB4N-p6wW4/photo.jpg?sz=128", "display_name": "ekgcorp", "link": "https://stackoverflow.com/users/7540846/ekgcorp"}, "reply_to_user": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 0, "creation_date": 1487281200, "post_id": 42259980, "comment_id": 71727030, "body": "Well that is the confusing part.. the first link I added had this as the answer..."}, {"owner": {"reputation": 135, "user_id": 7540846, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh4.googleusercontent.com/-UluzFmJA39k/AAAAAAAAAAI/AAAAAAAAArg/adB4N-p6wW4/photo.jpg?sz=128", "display_name": "ekgcorp", "link": "https://stackoverflow.com/users/7540846/ekgcorp"}, "reply_to_user": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 0, "creation_date": 1487281627, "post_id": 42259980, "comment_id": 71727255, "body": "Well that is the confusing part.. the first link I added had this as the answer... A Universal Windows app CAN call Launcher.QueryUriSupportAsync to see if the app is installed which supports the URI and package you want to launch.  I&#39;m I not fully understanding what that is saying. To me it says a UWP can call the &lt;LaunchQuerySupportStatus&gt; and get back Available or AppNotInstalled . <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.system.launchquerysupportstatus\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/uwp/api/&hellip;</a>"}, {"owner": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 1, "creation_date": 1487452390, "post_id": 42259980, "comment_id": 71794676, "body": "Simple UWP -&gt; UWP yes, UWP -&gt; WIn32 not able."}, {"owner": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 0, "creation_date": 1487453487, "post_id": 42259980, "comment_id": 71795014, "body": "Since I don&#39;t know MS Dynamics does it have a Win32 client or a UWP app? Since attempting to go down the road of discovery and only finding out what you searched was pointless is a complete waste of time.  That is why I originally stated that unless MS Dynamics AX is a UWP that it won&#39;t work."}, {"owner": {"reputation": 135, "user_id": 7540846, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh4.googleusercontent.com/-UluzFmJA39k/AAAAAAAAAAI/AAAAAAAAArg/adB4N-p6wW4/photo.jpg?sz=128", "display_name": "ekgcorp", "link": "https://stackoverflow.com/users/7540846/ekgcorp"}, "reply_to_user": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 0, "creation_date": 1488215022, "post_id": 42259980, "comment_id": 72122389, "body": "Dynamics is a Win32 client."}], "answers": [{"comments": [{"owner": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "edited": false, "score": 0, "creation_date": 1548380521, "post_id": 43464189, "comment_id": 95530485, "body": "I&#39;ve a similar question, in reverse order, posted <a href=\"https://social.msdn.microsoft.com/Forums/windowsapps/en-US/e452a8a3-80e4-4399-9116-f5fe966c8c76/using-c-how-can-i-detect-if-my-uwp-app-is-installed-on-windows-10?forum=wpdevelop\" rel=\"nofollow noreferrer\">here</a> on an <code>MSD forum</code>. Would you have time to share your thoughts and/or a suggestion/comments."}, {"owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "reply_to_user": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "edited": false, "score": 0, "creation_date": 1548388357, "post_id": 43464189, "comment_id": 95531917, "body": "Post a new question on SO and I will answer it :-)"}, {"owner": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "edited": false, "score": 0, "creation_date": 1548435655, "post_id": 43464189, "comment_id": 95553605, "body": "Per your suggestion, I&#39;ve posted the question on SO <a href=\"https://stackoverflow.com/q/54369640/1232087\">here</a>."}, {"owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "reply_to_user": {"reputation": 15178, "user_id": 1232087, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5dd18aac5106e03afdffc1da755b1695?s=128&d=identicon&r=PG", "display_name": "nam", "link": "https://stackoverflow.com/users/1232087/nam"}, "edited": false, "score": 0, "creation_date": 1548440040, "post_id": 43464189, "comment_id": 95555767, "body": "I have posted an answer"}], "tags": [], "owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "is_accepted": true, "score": 1, "last_activity_date": 1492492884, "creation_date": 1492492884, "answer_id": 43464189, "question_id": 42259980, "link": "https://stackoverflow.com/questions/42259980/how-to-detect-if-a-desktop-app-is-installed-from-a-uwp-app/43464189#43464189", "title": "How to detect if a desktop app is installed from a UWP app", "body": "<p>The short answer to the question as articulated is: no, a UWP cannot detect what Win32 apps are installed on the system.</p>\n\n<p>Slightly longer answer: if what you really want to know is whether an app is installed that supports a specific protocol or supports a specific file type, you can find that out using QueryUriSupportAsync or QueryFileSupportAsync. These APIs also consider installed Win32 apps.</p>\n\n<p>Thanks,\nStefan Wick - Windows Developer Platform</p>\n"}], "owner": {"reputation": 135, "user_id": 7540846, "user_type": "registered", "accept_rate": 31, "profile_image": "https://lh4.googleusercontent.com/-UluzFmJA39k/AAAAAAAAAAI/AAAAAAAAArg/adB4N-p6wW4/photo.jpg?sz=128", "display_name": "ekgcorp", "link": "https://stackoverflow.com/users/7540846/ekgcorp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 0, "accepted_answer_id": 43464189, "answer_count": 1, "score": 1, "last_activity_date": 1492492884, "creation_date": 1487192523, "last_edit_date": 1487244172, "question_id": 42259980, "link": "https://stackoverflow.com/questions/42259980/how-to-detect-if-a-desktop-app-is-installed-from-a-uwp-app", "title": "How to detect if a desktop app is installed from a UWP app", "body": "<p>I'm basically asking the same question as this person on MSDN: <a href=\"https://social.msdn.microsoft.com/Forums/sqlserver/en-US/debfb69a-7a35-4a20-9ee3-bf471137d276/uwphow-to-detect-if-application-is-installed-on-the-device?forum=wpdevelop\" rel=\"nofollow noreferrer\">How to detect if application is installed on the device</a></p>\n\n<p>However, I am new to Development and the answer was pointed back to Docs.microsoft.com which I was glad, but I guess I got lost in how to pull it off.</p>\n\n<p>I'm assuming this code needs to reside on App.xaml.cs, and that it actually sets a property that I can use to turn on or off the visibility of my View's button.</p>\n\n<pre><code>public static IAsyncOperation&lt;LaunchQuerySupportStatus&gt; \n    QueryUriSupportAsync(Windows.Foundation.Uri,Windows.System.LaunchQuerySupportType,System.String)\n</code></pre>\n\n<p>What I want to do, is Mark the visibility of one of my Views within the app, to NOT be shown if Microsoft Dyanmics AX is installed.</p>\n\n<p>Here is Code in XAML for button.</p>\n\n<pre><code>&lt;Controls:HamburgerButtonInfo ClearHistory=\"True\" PageType=\"views:DevicePage\"&gt;\n&lt;StackPanel Orientation=\"Horizontal\"&gt;\n    &lt;SymbolIcon Width=\"48\"\n                Height=\"48\"\n                Symbol=\"Keyboard\" /&gt;\n    &lt;TextBlock Margin=\"12,0,0,0\"\n               VerticalAlignment=\"Center\"\n               Text=\"Manage Device\" /&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>BTW, I'm using Template10 as a framework. So i'm assuming that since all of my Views are displayed within the <code>Shell.xaml</code> I would put a Condition on the above button as <code>Visibility=Visible</code>.</p>\n"}, {"tags": ["c#", "json", "asp.net-mvc", "parsing"], "comments": [{"owner": {"reputation": 1842, "user_id": 6939109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pwfCA.jpg?s=128&g=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/6939109/coder"}, "edited": false, "score": 0, "creation_date": 1487192939, "post_id": 42259970, "comment_id": 71677820, "body": "are you getting any error?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5048395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c32c0610d087504b55469cefe9fb58?s=128&d=identicon&r=PG&f=1", "display_name": "ka222jm", "link": "https://stackoverflow.com/users/5048395/ka222jm"}, "edited": false, "score": 0, "creation_date": 1487195141, "post_id": 42260131, "comment_id": 71678944, "body": "Thank you very much :) Works like a charm."}], "tags": [], "owner": {"reputation": 69261, "user_id": 557445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93a0d4a722b2fae0bf159c9283fe1aff?s=128&d=identicon&r=PG", "display_name": "Rion Williams", "link": "https://stackoverflow.com/users/557445/rion-williams"}, "is_accepted": true, "score": 5, "last_activity_date": 1487193786, "last_edit_date": 1487193786, "creation_date": 1487193082, "answer_id": 42260131, "question_id": 42259970, "link": "https://stackoverflow.com/questions/42259970/parse-json-file-in-asp-net-mvc-and-display-the-data-in-the-webpage/42260131#42260131", "title": "Parse JSON file in ASP.NET MVC and display the data in the webpage", "body": "<p>Your <code>Books</code> class already contains a collection property to represent each of your individual books, so you don't need to actually deserialize a <code>Books[]</code> but rather just a <code>Books</code> object :</p>\n\n<pre><code>// Since Books is already a container element, it will map the \"books\" property\n// from your JSON object to the matching IList&lt;Book&gt; property\nvar books = JsonConvert.DeserializeObject&lt;Books&gt;(json);\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/RecFp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RecFp.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can <a href=\"https://dotnetfiddle.net/lYjXhc\" rel=\"nofollow noreferrer\">see a complete working example of this here</a> and the example code demonstrated in the snippet below.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>// YourClasses.cs\r\nnamespace Example\r\n{\r\n\tpublic class Book\r\n\t{\r\n\t\tpublic string title;\r\n\t\r\n\t\tpublic string author;\r\n\t\r\n\t\tpublic string price;\r\n\t\r\n\t\tpublic string inStock;\r\n\t}\r\n\t\r\n\tpublic class Books\r\n\t{\r\n\t\tpublic IList&lt;Book&gt; books;\r\n\t}\r\n}\r\n\r\n// YourController.cs\r\nnamespace Example\r\n{\r\n\tpublic class HomeController : Controller\r\n\t{\r\n\t\t[HttpGet]\r\n\t\tpublic ActionResult Index()\r\n\t\t{\r\n\t\t\t// Example JSON in lieu of API call\r\n\t\t\tvar json = \"{\\\"books\\\":[{\\\"title\\\":\\\"Book 1\\\", \\\"author\\\":\\\"Author1\\\", \\\"price\\\":762, \\\"inStock\\\":15},{\\\"title\\\":\\\"Book 2\\\", \\\"author\\\":\\\"Author2\\\", \\\"price\\\":100, \\\"inStock\\\":1},{\\\"title\\\":\\\"Book 3\\\", \\\"author\\\":\\\"Author3\\\", \\\"price\\\":185.5, \\\"inStock\\\":5},{\\\"title\\\":\\\"Book 4\\\", \\\"author\\\":\\\"Author 4\\\", \\\"price\\\":1748, \\\"inStock\\\":3},{\\\"title\\\":\\\"Book 5\\\", \\\"author\\\":\\\"Author 5\\\", \\\"price\\\":999, \\\"inStock\\\":20},{\\\"title\\\":\\\"Book 6\\\", \\\"author\\\":\\\"Author 6\\\", \\\"price\\\":499.5, \\\"inStock\\\":3},{\\\"title\\\":\\\"Book 7\\\", \\\"author\\\":\\\"Author 7\\\", \\\"price\\\":564.5, \\\"inStock\\\":0}]}\";\t\r\n\t\t\tvar books = JsonConvert.DeserializeObject&lt;Books&gt;(json);\r\n\t\t\treturn View(books);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Index.cshtml\r\n@model Example.Books\r\n&lt;ul&gt;\r\n    @foreach(var book in Model.books){\r\n\t\t&lt;li&gt;@book.title&lt;/li&gt;\r\n\t}\r\n&lt;/ul&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 888, "user_id": 7302864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vAgan.png?s=128&g=1", "display_name": "chadnt", "link": "https://stackoverflow.com/users/7302864/chadnt"}, "is_accepted": false, "score": 2, "last_activity_date": 1487193117, "creation_date": 1487193117, "answer_id": 42260143, "question_id": 42259970, "link": "https://stackoverflow.com/questions/42259970/parse-json-file-in-asp-net-mvc-and-display-the-data-in-the-webpage/42260143#42260143", "title": "Parse JSON file in ASP.NET MVC and display the data in the webpage", "body": "<p>You don't want an array of <code>Books</code>.  You just want the <code>Books</code> container:</p>\n\n<pre><code>Books books = JsonConvert.DeserializeObject&lt;Books&gt;(json);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1842, "user_id": 6939109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pwfCA.jpg?s=128&g=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/6939109/coder"}, "is_accepted": false, "score": 1, "last_activity_date": 1487193215, "creation_date": 1487193215, "answer_id": 42260170, "question_id": 42259970, "link": "https://stackoverflow.com/questions/42259970/parse-json-file-in-asp-net-mvc-and-display-the-data-in-the-webpage/42260170#42260170", "title": "Parse JSON file in ASP.NET MVC and display the data in the webpage", "body": "<p>Here is the Book class you need</p>\n\n<pre><code>public class Book\n{\n    public string title { get; set; }\n    public string author { get; set; }\n    public double price { get; set; }\n    public int inStock { get; set; }\n}\n</code></pre>\n\n<p>Here is the Books class you need</p>\n\n<pre><code>public class Books\n{\n    public List&lt;Book&gt; books { get; set; }\n}\n</code></pre>\n\n<p>You need to have this in your code </p>\n\n<pre><code>public ActionResult Index()\n{\n    var webClient = new WebClient();\n    var json = webClient.DownloadString(@\"http://www.myurl.json\");\n    Books books = JsonConvert.DeserializeObject&lt;Books&gt;(json);\n\n    return View(books);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 2463199, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/baedb86182954a84f95c208e4b2861e8?s=128&d=identicon&r=PG", "display_name": "Nothing", "link": "https://stackoverflow.com/users/2463199/nothing"}, "is_accepted": false, "score": 0, "last_activity_date": 1487193432, "creation_date": 1487193432, "answer_id": 42260232, "question_id": 42259970, "link": "https://stackoverflow.com/questions/42259970/parse-json-file-in-asp-net-mvc-and-display-the-data-in-the-webpage/42260232#42260232", "title": "Parse JSON file in ASP.NET MVC and display the data in the webpage", "body": "<p>To make sure your classes are correct for your JSON, you could \"paste JSON as classes\" in VS pro and then deserialise.</p>\n"}, {"tags": [], "owner": {"reputation": 1570, "user_id": 5008193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iOKgE.jpg?s=128&g=1", "display_name": "Graffito", "link": "https://stackoverflow.com/users/5008193/graffito"}, "is_accepted": false, "score": 0, "last_activity_date": 1487193490, "creation_date": 1487193490, "answer_id": 42260249, "question_id": 42259970, "link": "https://stackoverflow.com/questions/42259970/parse-json-file-in-asp-net-mvc-and-display-the-data-in-the-webpage/42260249#42260249", "title": "Parse JSON file in ASP.NET MVC and display the data in the webpage", "body": "<p>Declare Books as:</p>\n\n<pre><code>public class Books : List&lt;Book&gt; \n</code></pre>\n\n<p>And desrialize it as indicated by @chadnt:</p>\n\n<pre><code>Books books = JsonConvert.DeserializeObject&lt;Books&gt;(json);\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5048395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76c32c0610d087504b55469cefe9fb58?s=128&d=identicon&r=PG&f=1", "display_name": "ka222jm", "link": "https://stackoverflow.com/users/5048395/ka222jm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13737, "favorite_count": 2, "accepted_answer_id": 42260131, "answer_count": 5, "score": 2, "last_activity_date": 1487214492, "creation_date": 1487192481, "last_edit_date": 1487214492, "question_id": 42259970, "link": "https://stackoverflow.com/questions/42259970/parse-json-file-in-asp-net-mvc-and-display-the-data-in-the-webpage", "title": "Parse JSON file in ASP.NET MVC and display the data in the webpage", "body": "<p>I have a remote URL from where I read a JSON Object that looks like this:</p>\n\n<pre><code>{\"books\":\n [\n   {\"title\":\"Book 1\", \"author\":\"Author1\", \"price\":762, \"inStock\":15},\n   {\"title\":\"Book 2\", \"author\":\"Author2\", \"price\":100, \"inStock\":1},\n   {\"title\":\"Book 3\", \"author\":\"Author3\", \"price\":185.5, \"inStock\":5},\n   {\"title\":\"Book 4\", \"author\":\"Author 4\", \"price\":1748, \"inStock\":3},\n   {\"title\":\"Book 5\", \"author\":\"Author 5\", \"price\":999, \"inStock\":20},\n   {\"title\":\"Book 6\", \"author\":\"Author 6\", \"price\":499.5, \"inStock\":3},\n   {\"title\":\"Book 7\", \"author\":\"Author 7\", \"price\":564.5, \"inStock\":0}\n ]\n}\n</code></pre>\n\n<p>I have created two classes Book.cs</p>\n\n<pre><code>public class Book\n{\n    public string title;\n\n    public string author;\n\n    public string price;\n\n    public string inStock;\n}\n</code></pre>\n\n<p>And Books.cs</p>\n\n<pre><code>public class Books\n{\n    public IList&lt;Book&gt; books { get; set; }\n}\n</code></pre>\n\n<p>How to correctly parse the JSON so I can show the contents in the Razor HTML</p>\n\n<p>This is my controller:</p>\n\n<pre><code>public ActionResult Index()\n{\n    var webClient = new WebClient();\n    var json = webClient.DownloadString(@\"http://www.myurl.json\");\n    Books[] books = JsonConvert.DeserializeObject&lt;Books[]&gt;(json);\n\n    return View(books);\n}\n</code></pre>\n"}, {"tags": ["c#", "class", "enums"], "comments": [{"owner": {"reputation": 8041, "user_id": 1771817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/zeTmI.jpg?s=128&g=1", "display_name": "adv12", "link": "https://stackoverflow.com/users/1771817/adv12"}, "edited": false, "score": 0, "creation_date": 1487192242, "post_id": 42259872, "comment_id": 71677433, "body": "Do some reading about <a href=\"https://msdn.microsoft.com/en-us/library/sbbt4032.aspx\" rel=\"nofollow noreferrer\">enums in C#</a>."}, {"owner": {"reputation": 8648, "user_id": 2263584, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0cbfedf2ba321ff26ef16fb682689cd5?s=128&d=identicon&r=PG", "display_name": "Geeky Guy", "link": "https://stackoverflow.com/users/2263584/geeky-guy"}, "edited": false, "score": 0, "creation_date": 1487192247, "post_id": 42259872, "comment_id": 71677436, "body": "You are probably looking for enumerations.."}, {"owner": {"reputation": 43, "user_id": 6944778, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/833c3a27a45eb9783adda196d087b793?s=128&d=identicon&r=PG&f=1", "display_name": "F17CH", "link": "https://stackoverflow.com/users/6944778/f17ch"}, "edited": false, "score": 0, "creation_date": 1487192351, "post_id": 42259872, "comment_id": 71677489, "body": "Can i not create it as a class, and also a static class with the options, like Drawing.Color?"}, {"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 1, "creation_date": 1487192549, "post_id": 42259872, "comment_id": 71677583, "body": "You might want to follow <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_5218\" rel=\"nofollow noreferrer\">ISO/IEC 5218</a>. The correct term is &quot;sex&quot;, not &quot;gender&quot;, although &quot;political correctness&quot; is trying to pervert the meanings. However, language does evolve."}], "answers": [{"comments": [{"owner": {"reputation": 2393, "user_id": 986846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55280bd5ca07d70702cc458f174ade6c?s=128&d=identicon&r=PG&f=1", "display_name": "Renats Stozkovs", "link": "https://stackoverflow.com/users/986846/renats-stozkovs"}, "edited": false, "score": 3, "creation_date": 1487192327, "post_id": 42259906, "comment_id": 71677479, "body": "That is not politically correct. How do you represent shemale? Or <code>Apache Helicopter</code>?"}, {"owner": {"reputation": 43, "user_id": 6944778, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/833c3a27a45eb9783adda196d087b793?s=128&d=identicon&r=PG&f=1", "display_name": "F17CH", "link": "https://stackoverflow.com/users/6944778/f17ch"}, "edited": false, "score": 0, "creation_date": 1487192543, "post_id": 42259906, "comment_id": 71677578, "body": "Where is the Gender enumeration created? In the Person class?"}, {"owner": {"reputation": 833, "user_id": 2654498, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/JENRC.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/2654498/nick"}, "edited": false, "score": 0, "creation_date": 1487192605, "post_id": 42259906, "comment_id": 71677623, "body": "It&#39;s up to you. In the Person class is one option."}, {"owner": {"reputation": 50118, "user_id": 913124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20dGq.jpg?s=128&g=1", "display_name": "Christos", "link": "https://stackoverflow.com/users/913124/christos"}, "reply_to_user": {"reputation": 2393, "user_id": 986846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55280bd5ca07d70702cc458f174ade6c?s=128&d=identicon&r=PG&f=1", "display_name": "Renats Stozkovs", "link": "https://stackoverflow.com/users/986846/renats-stozkovs"}, "edited": false, "score": 0, "creation_date": 1487192642, "post_id": 42259906, "comment_id": 71677654, "body": "@bc004346 I mentioned the values Male and Female, since these values have been mentioned by the OP. Of course anyone can add as many values in this enum provided that these values make sense for her application."}, {"owner": {"reputation": 50118, "user_id": 913124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20dGq.jpg?s=128&g=1", "display_name": "Christos", "link": "https://stackoverflow.com/users/913124/christos"}, "reply_to_user": {"reputation": 43, "user_id": 6944778, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/833c3a27a45eb9783adda196d087b793?s=128&d=identicon&r=PG&f=1", "display_name": "F17CH", "link": "https://stackoverflow.com/users/6944778/f17ch"}, "edited": false, "score": 0, "creation_date": 1487192666, "post_id": 42259906, "comment_id": 71677670, "body": "@F17CH I would opt to create it in a separate file, called <code>Gender.cs</code>"}, {"owner": {"reputation": 43, "user_id": 6944778, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/833c3a27a45eb9783adda196d087b793?s=128&d=identicon&r=PG&f=1", "display_name": "F17CH", "link": "https://stackoverflow.com/users/6944778/f17ch"}, "edited": false, "score": 0, "creation_date": 1487193194, "post_id": 42259906, "comment_id": 71677953, "body": "I&#39;m still confused as to where to create the enum, so that outside files can still reference it when creating the person."}, {"owner": {"reputation": 50118, "user_id": 913124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20dGq.jpg?s=128&g=1", "display_name": "Christos", "link": "https://stackoverflow.com/users/913124/christos"}, "reply_to_user": {"reputation": 43, "user_id": 6944778, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/833c3a27a45eb9783adda196d087b793?s=128&d=identicon&r=PG&f=1", "display_name": "F17CH", "link": "https://stackoverflow.com/users/6944778/f17ch"}, "edited": false, "score": 2, "creation_date": 1487193412, "post_id": 42259906, "comment_id": 71678076, "body": "@F17CH You should add a file called in <code>Gender.cs</code> to your project. Then you should add the definition of the enum there, <code>public enum Gender { Male, Female }</code>. Marking the enum as public you state that every type in your assembly or in any other assembly that references your assembly would have the opportunity to access and use your enum. I hope that I answered your question. If not, please let me know. Thanks !"}], "tags": [], "owner": {"reputation": 50118, "user_id": 913124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20dGq.jpg?s=128&g=1", "display_name": "Christos", "link": "https://stackoverflow.com/users/913124/christos"}, "is_accepted": false, "score": 7, "last_activity_date": 1487193317, "last_edit_date": 1487193317, "creation_date": 1487192268, "answer_id": 42259906, "question_id": 42259872, "link": "https://stackoverflow.com/questions/42259872/represent-gender-in-person-class/42259906#42259906", "title": "Represent Gender in Person Class", "body": "<p>You could create an enum:</p>\n\n<pre><code>public enum Gender { Male, Female }\n</code></pre>\n\n<p>and then use it as below:</p>\n\n<pre><code>public class Person\n{\n    public string FirstName { get; set; }\n    public string LastName { get; set; }\n    public Gender Gender { get; set; }\n}\n\nvar person = new Person\n{\n    FirstName = \"Foo\",\n    LastName = \"Bar\",\n    Gender = Gender.Male\n};\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6944778, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/833c3a27a45eb9783adda196d087b793?s=128&d=identicon&r=PG&f=1", "display_name": "F17CH", "link": "https://stackoverflow.com/users/6944778/f17ch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1362, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1568179800, "creation_date": 1487192148, "last_edit_date": 1487193505, "question_id": 42259872, "link": "https://stackoverflow.com/questions/42259872/represent-gender-in-person-class", "title": "Represent Gender in Person Class", "body": "<p>With a Person class, how do I go about representing Gender, I want to create it as a class, much like the <code>System.Drawing.Color</code> setup, but I am unsure how to do this.</p>\n\n<p>So I can do <code>Gender = Gender.Male</code> or <code>Gender = Gender.Female</code> etc.</p>\n\n<p>Sorry if this makes no sense.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "mvvm", "treeview"], "comments": [{"owner": {"reputation": 301, "user_id": 2643896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5885af1b3b38dab9476e023d5e85deb4?s=128&d=identicon&r=PG", "display_name": "barbrady", "link": "https://stackoverflow.com/users/2643896/barbrady"}, "edited": false, "score": 0, "creation_date": 1487198626, "post_id": 42259843, "comment_id": 71680658, "body": "As a temporary work-around, I tested handling the Click event in the code behind (not very MVVM-ish, I know)....but I can see from the &#39;sender&#39; of the event that the CommandParameter is set correctly, but the Command is null.  If I give myself a reference to the view model in the view code-behind (yea, I know I know...terrible), I can execute the command (ICommand property) passing the sender.CommandParameter and it works fine.  I have no idea why the Command isn&#39;t being set correctly in the XAML though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1487253752, "post_id": 42259843, "comment_id": 71708299, "body": "1) click <a href=\"https://stackoverflow.com/posts/42259843/edit\">edit</a> 2) select code 3) ctrl-k until code is indented four spaces rather than fourty"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 2643896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5885af1b3b38dab9476e023d5e85deb4?s=128&d=identicon&r=PG", "display_name": "barbrady", "link": "https://stackoverflow.com/users/2643896/barbrady"}, "edited": false, "score": 0, "creation_date": 1487628867, "post_id": 42263099, "comment_id": 71860987, "body": "This I still couldn&#39;t get to work, because even the TreeView itself does not have the correct DataContext...it has as a DataContext the ObservableCollection in the view model that is used to populate the TreeView, which makes sense.  It seems that really you&#39;d want a Tag reference to the main Window (or UserControl, in my case) itself...but when I tried to modify the code to accomplish them, I couldn&#39;t get it."}, {"owner": {"reputation": 3117, "user_id": 5615980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a3c026c1a72be812594861aeec8f56?s=128&d=identicon&r=PG&f=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/5615980/ron"}, "reply_to_user": {"reputation": 301, "user_id": 2643896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5885af1b3b38dab9476e023d5e85deb4?s=128&d=identicon&r=PG", "display_name": "barbrady", "link": "https://stackoverflow.com/users/2643896/barbrady"}, "edited": false, "score": 0, "creation_date": 1487644854, "post_id": 42263099, "comment_id": 71866223, "body": "I wrote the full example. let me know if you couldn&#39;t get it to work. Note that the DataContext must be set to the ViewModel (a class with ObservableCollection)"}], "tags": [], "owner": {"reputation": 3117, "user_id": 5615980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a3c026c1a72be812594861aeec8f56?s=128&d=identicon&r=PG&f=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/5615980/ron"}, "is_accepted": false, "score": 1, "last_activity_date": 1487644742, "last_edit_date": 1487644742, "creation_date": 1487207678, "answer_id": 42263099, "question_id": 42259843, "link": "https://stackoverflow.com/questions/42259843/wpf-binding-contextmenu-for-textblock-in-treeview/42263099#42263099", "title": "WPF Binding ContextMenu for TextBlock in TreeView", "body": "<p>(Updated)</p>\n\n<p>The Tag of TextBlock can be bound to the parent TreeView which its DataContext is the ViewModel. The Tag of the Context menu can be bound to this Tag (again). You can now use</p>\n\n<pre><code>PlacementTarget.Tag.DataContext. `Your Command`\n</code></pre>\n\n<p>in other words:</p>\n\n<pre><code>&lt;TreeView DataContext=\"{Binding}\" ItemsSource=\"{Binding Models}\"&gt;\n    &lt;TreeView.ItemTemplate&gt;\n        &lt;HierarchicalDataTemplate ItemsSource=\"{Binding Models}\"&gt;\n            &lt;Grid&gt;\n                &lt;Grid.ColumnDefinitions&gt;\n                    &lt;ColumnDefinition Width=\"*\"/&gt;\n                    &lt;ColumnDefinition Width=\"13\"/&gt;\n                    &lt;ColumnDefinition Width=\"13\"/&gt;\n                &lt;/Grid.ColumnDefinitions&gt;\n                &lt;Grid.RowDefinitions&gt;\n                    &lt;RowDefinition Height=\"20\" /&gt;\n                &lt;/Grid.RowDefinitions&gt;\n                &lt;TextBlock Text=\"{Binding Name}\" Grid.Column=\"0\" Tag=\"{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=TreeView}}\"&gt;\n                    &lt;TextBlock.ContextMenu&gt;\n                        &lt;ContextMenu Tag=\"{Binding Path=PlacementTarget.Tag, RelativeSource={RelativeSource Self}}\"&gt;\n                            &lt;MenuItem Header=\"Delete Document\" ToolTip=\"{Binding Name}\" \n                                              Command=\"{Binding PlacementTarget.Tag.DataContext.PCommand, \n                                                        RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}\"    \n                                              CommandParameter=\"{Binding Name}\" /&gt;\n                        &lt;/ContextMenu&gt;\n                    &lt;/TextBlock.ContextMenu&gt;\n                &lt;/TextBlock&gt;\n            &lt;/Grid&gt;\n        &lt;/HierarchicalDataTemplate&gt;\n    &lt;/TreeView.ItemTemplate&gt;\n &lt;/TreeView&gt;\n</code></pre>\n\n<p>Regarding the <code>DataContext</code>, you should set it to be the ViewModel, But not the <code>ObservableCollection</code> in the ViewModel. something like this:</p>\n\n<pre><code>    public MainWindow()\n    { \n        InitializeComponent();\n\n        ViewModel mv = new ViewModel();\n        this.DataContext = mv;\n    }\n</code></pre>\n\n<p>There are other options that you can Google. Note that the ViewModel/Model/Commad classes are:</p>\n\n<pre><code>public class ViewModel :INotifyPropertyChanged\n{\n    public ViewModel()\n    { \n        _pCommand = new Command(DoParameterisedCommand);\n\n\n        Model m1 = new Model() { Name = \"model1\" };\n        Model m2 = new Model() { Name = \"model2\" };\n        Model m3 = new Model() { Name = \"model3\" };\n        Model m4 = new Model() { Name = \"model4\", Models = new Model[2] { m1, m2 } };\n        Model m5 = new Model() { Name = \"model5\", Models = new Model[2] { m4, m3 } };\n        Model m6 = new Model() { Name = \"model6\" };\n        Model m7 = new Model() { Name = \"model7\" };\n        Model m8 = new Model() { Name = \"model8\" };\n        Model m9 = new Model() { Name = \"model9\", Models = new Model[2] { m6, m7 } };\n        Model m10 = new Model() { Name = \"model10\", Models = new Model[2] { m8, m9 } };\n        _models = new ObservableCollection&lt;Model&gt;(new Collection&lt;Model&gt;() { m1, m2, m3, m4, m5 });\n\n    }\n\n    ObservableCollection&lt;Model&gt; _models;\n    public ObservableCollection&lt;Model&gt; Models { get { return _models; } set { _models = value; RaisePropertyChanged(\"Models\"); } }\n\n\n    private void DoParameterisedCommand(object parameter)\n    {\n        MessageBox.Show(\"Parameterised Command; Parameter is '\" +\n                     parameter.ToString() + \"'.\");\n    }\n    Command _pCommand;\n    public Command PCommand\n    {\n        get { return _pCommand; }\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n    void RaisePropertyChanged(string propname)\n    {\n        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propname));\n    }\n}\n\npublic class Model : INotifyPropertyChanged\n{\n    Model[] _models;\n    public Model[] Models { get { return _models; } set { _models = value; RaisePropertyChanged(\"Models\"); } }\n\n    string _name;\n    public string Name { get { return _name; } set { _name = value; RaisePropertyChanged(\"Name\"); } }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n    void RaisePropertyChanged(string propname)\n    {\n        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propname));\n    }\n}\n\npublic class Command : ICommand\n{\n    public Command(Action&lt;object&gt; parameterizedAction, bool canExecute = true)\n    {\n        _parameterizedAction = parameterizedAction;\n        _canExecute = canExecute;\n    }\n\n    Action&lt;object&gt; _parameterizedAction = null;\n    bool _canExecute = false;\n\n    public bool CanExecute\n    {\n        get { return _canExecute; }\n        set\n        {\n            if (_canExecute != value)\n            {\n                _canExecute = value;\n                CanExecuteChanged?.Invoke(this, EventArgs.Empty);\n            }\n        }\n    }\n    public event EventHandler CanExecuteChanged;\n    bool ICommand.CanExecute(object parameter)\n    {\n        return _canExecute;\n    }\n\n    void ICommand.Execute(object parameter)\n    {\n        this.DoExecute(parameter);\n    }\n    public virtual void DoExecute(object param)\n    {\n        if (_parameterizedAction != null)\n            _parameterizedAction(param);\n        else\n            throw new Exception();\n    }\n }\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 2643896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5885af1b3b38dab9476e023d5e85deb4?s=128&d=identicon&r=PG", "display_name": "barbrady", "link": "https://stackoverflow.com/users/2643896/barbrady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487644742, "creation_date": 1487192025, "last_edit_date": 1487258905, "question_id": 42259843, "link": "https://stackoverflow.com/questions/42259843/wpf-binding-contextmenu-for-textblock-in-treeview", "title": "WPF Binding ContextMenu for TextBlock in TreeView", "body": "<p>I've got a Treeview setup in a WPF (trying to mostly follow MVVM) application with a HierarchicalDataTemplate setup...for each item I've got a TextBlock and a couple buttons, as such:</p>\n\n<pre><code>&lt;HierarchicalDataTemplate.ItemTemplate&gt;\n    &lt;DataTemplate&gt;\n        &lt;Grid&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n                &lt;ColumnDefinition Width=\"13\"/&gt;\n                &lt;ColumnDefinition Width=\"13\"/&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;Grid.RowDefinitions&gt;\n                &lt;RowDefinition Height=\"20\" /&gt;\n            &lt;/Grid.RowDefinitions&gt;\n            &lt;TextBlock Text=\"{Binding Name}\" Grid.Column=\"0\"&gt;\n                &lt;TextBlock.ContextMenu&gt;\n                    &lt;ContextMenu DataContext=\"{Binding Path=PlacementTarget.DataContext, RelativeSource={RelativeSource Mode=Self}}\"&gt;\n                        &lt;MenuItem Header=\"Delete Document\" ToolTip=\"{Binding IDPath}\" Command=\"{Binding DeleteDocumentCommand}\"\n                                                                                        CommandParameter=\"{Binding IDPath}\" /&gt;\n                    &lt;/ContextMenu&gt;\n                &lt;/TextBlock.ContextMenu&gt;\n            &lt;/TextBlock&gt;\n            &lt;Button Content=\"X\" Grid.Column=\"1\" Height=\"12\" Width=\"12\" HorizontalAlignment=\"Center\" ToolTip=\"Delete Document\" Command=\"{Binding DataContext.DeleteDocumentCommand, RelativeSource={RelativeSource AncestorType=TreeView}}\" CommandParameter=\"{Binding IDPath}\"  /&gt;\n            &lt;Button Content=\"X\" Grid.Column=\"2\" Height=\"12\" Width=\"12\" HorizontalAlignment=\"Center\" ToolTip=\"Move Document\" Command=\"{Binding DataContext.MoveDocumentCommand, RelativeSource={RelativeSource AncestorType=TreeView}}\" CommandParameter=\"{Binding IDPath}\" /&gt;\n        &lt;/Grid&gt;\n    &lt;/DataTemplate&gt;\n&lt;/HierarchicalDataTemplate.ItemTemplate&gt;\n</code></pre>\n\n<p>All of these bindings are working well, except for the Command on the context menu MenuItem.  I have looked through several solutions here on SO (above is one attempt, I also tried to set the \"Tag\" of the parent  ...which also did not help (using PlacementTarget.Tab instead of DataContext).</p>\n\n<p>I must be missing something simple but I just can't figure it out.  I setup a binding to the 's Tooltip property, just to verify that the IDPath is bound correct (it is)...but the DeleteDocumentCommand just refuses to fire.</p>\n\n<p>If anybody has any ideas I'd appreciate it, this has been killing me for the last few hours...thanks!</p>\n\n<p>Edit, here's an example with the \"Tag\" concept to kind of transfer the DataContext from an object in the viewtree (The TextBlock) and make it accessible to the ContextMenu.  With this method, again, everything binds fine (MenuItem->Tooltip for example), but still the method won't fire...</p>\n\n<pre><code>&lt;HierarchicalDataTemplate.ItemTemplate&gt;\n    &lt;DataTemplate&gt;\n        &lt;Grid&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n                &lt;ColumnDefinition Width=\"13\"/&gt;\n                &lt;ColumnDefinition Width=\"13\"/&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;Grid.RowDefinitions&gt;\n                &lt;RowDefinition Height=\"20\" /&gt;\n            &lt;/Grid.RowDefinitions&gt;\n            &lt;TextBlock Text=\"{Binding Name}\" Grid.Column=\"0\" Tag=\"{Binding DataContext, RelativeSource={RelativeSource Self}}\"&gt;\n                &lt;TextBlock.ContextMenu&gt;\n                    &lt;ContextMenu DataContext=\"{Binding Path=PlacementTarget.Tag, RelativeSource={RelativeSource Self}}\"&gt;\n                        &lt;MenuItem Header=\"Delete Document\" ToolTip=\"{Binding IDPath}\" Command=\"{Binding DeleteDocumentCommand}\"\n                                                                                        CommandParameter=\"{Binding IDPath}\" /&gt;\n                    &lt;/ContextMenu&gt;\n                &lt;/TextBlock.ContextMenu&gt;\n            &lt;/TextBlock&gt;\n            &lt;Button Content=\"X\" Grid.Column=\"1\" Height=\"12\" Width=\"12\" HorizontalAlignment=\"Center\" ToolTip=\"Delete Document\" Command=\"{Binding DataContext.DeleteDocumentCommand, RelativeSource={RelativeSource AncestorType=TreeView}}\" CommandParameter=\"{Binding IDPath}\"  /&gt;\n            &lt;Button Content=\"X\" Grid.Column=\"2\" Height=\"12\" Width=\"12\" HorizontalAlignment=\"Center\" ToolTip=\"Move Document\" Command=\"{Binding DataContext.MoveDocumentCommand, RelativeSource={RelativeSource AncestorType=TreeView}}\" CommandParameter=\"{Binding IDPath}\" /&gt;\n        &lt;/Grid&gt;\n    &lt;/DataTemplate&gt;\n&lt;/HierarchicalDataTemplate.ItemTemplate&gt;\n</code></pre>\n\n<p>My instincts tell me that since the Tooltip binding it working, that I am successfully getting the DataContext down to the ContextMenu level...and yet, the Command won't fire...I'm not sure what else I'm missing here.</p>\n\n<p>Edit Again:  Ok...I see now that the DataContext that I'm gaining access via the \"Tag\" attribute is the collection that is populating the treeview...not the actual ViewModel object itself...so I'm assuming that's why the command doesn't work.  So I'm not sure how to get the correct DataContext at this point...should it be coming from the top-most window?</p>\n"}, {"tags": ["c#", ".net", "asp.net-mvc", "asynchronous", "simple-injector"], "comments": [{"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1487192785, "post_id": 42259821, "comment_id": 71677732, "body": "You state &quot;error out before hit this line&quot; when using the <code>WebRequestLifestyle</code>. Can you post the complete exception details (exception type, message and stack trace of the exception and all inner exceptions) that you get?"}, {"owner": {"reputation": 1230, "user_id": 2589021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f860b6ac3f9160ae12f92104fbf88e13?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/2589021/quentin"}, "reply_to_user": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1487193256, "post_id": 42259821, "comment_id": 71677989, "body": "@Steven added the full error details."}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1487193474, "post_id": 42259821, "comment_id": 71678120, "body": "Hi Quentin, that was not the error I was looking for. This is the exception you get when you are using the <code>ExecutionContextScopeLifestyle</code>. Instead, change the <code>Container.Options.DefaultScopedLifestyle</code> to <code>WebRequestLifestyle</code> and post the exception related to that change. ps. Instead of posting an image, please post the exception details as text instead. This makes it easier to read, copy and for other search engines to index your question."}, {"owner": {"reputation": 1230, "user_id": 2589021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f860b6ac3f9160ae12f92104fbf88e13?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/2589021/quentin"}, "reply_to_user": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1487194127, "post_id": 42259821, "comment_id": 71678428, "body": "@Steven It&#39;s <code>The asynchronous action method &#39;foo&#39; returns a Task, which cannot be executed synchronously.</code> I&#39;m adding the details momentarily."}], "answers": [{"comments": [{"owner": {"reputation": 1230, "user_id": 2589021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f860b6ac3f9160ae12f92104fbf88e13?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/2589021/quentin"}, "edited": false, "score": 0, "creation_date": 1487257691, "post_id": 42268390, "comment_id": 71711559, "body": "Thank you for the input. So should I use <code>ExecutionContextScopeLifestyle</code> instead of <code>WebRequestLifestyle</code> when dealing with async methods?"}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "reply_to_user": {"reputation": 1230, "user_id": 2589021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f860b6ac3f9160ae12f92104fbf88e13?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/2589021/quentin"}, "edited": false, "score": 2, "creation_date": 1487258340, "post_id": 42268390, "comment_id": 71712035, "body": "@Quentin: No, you can keep using the <code>WebRequestLifestyle</code> in MVC."}], "tags": [], "owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "is_accepted": false, "score": 2, "last_activity_date": 1487233168, "creation_date": 1487233168, "answer_id": 42268390, "question_id": 42259821, "link": "https://stackoverflow.com/questions/42259821/di-ioc-for-net-mvc-async-await/42268390#42268390", "title": "DI/IoC for .net mvc async/await", "body": "<p>As far as I can see, this problem is not related to Simple Injector and its scoping; if you wrap an execution context scope around a web request (which is something you can do by hooking into the request_start and request_end events), you will be faced by the same problem.</p>\n\n<p>There are several issues about this on Stackoverflow and the rest of the interwebs, that you should take a look at, such as <a href=\"https://stackoverflow.com/questions/14994335/\">this q/a</a>.</p>\n"}], "owner": {"reputation": 1230, "user_id": 2589021, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f860b6ac3f9160ae12f92104fbf88e13?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/2589021/quentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1487342166, "creation_date": 1487191933, "last_edit_date": 1487342166, "question_id": 42259821, "link": "https://stackoverflow.com/questions/42259821/di-ioc-for-net-mvc-async-await", "title": "DI/IoC for .net mvc async/await", "body": "<p>I'm using <a href=\"https://simpleinjector.org/index.html\" rel=\"nofollow noreferrer\">Simple Injector</a> as the IoC container for my .Net MVC project. Here is how I register the services.</p>\n\n<p><strong>SimpleInjectorInitializer.cs</strong></p>\n\n<pre><code> public static void Initialize() {\n    var container = new Container();\n\n    container.Options.DefaultScopedLifestyle = new WebRequestLifestyle();  \n    //container.Options.DefaultScopedLifestyle = new ExecutionContextScopeLifestyle(); // replace last line with this for async/await\n\n    InitializeContainer(container);\n    container.RegisterMvcControllers(Assembly.GetExecutingAssembly());\n    container.Verify();\n    DependencyResolver.SetResolver(new SimpleInjectorDependencyResolver(container));\n}\n\nprivate static void InitializeContainer(Container container) {\n    container.Register&lt;MyDbContext&gt;(Lifestyle.Scoped);\n    container.Register(typeof(IUnitOfWork&lt;&gt;), typeof(UnitOfWork&lt;&gt;), Lifestyle.Scoped);\n    container.Register(typeof(IRepository&lt;&gt;), typeof(Repository&lt;&gt;), Lifestyle.Scoped);\n    container.Register&lt;ICustomerService, CustomerService&gt;(Lifestyle.Scoped);\n\n    //what does this do by the way?\n    //using (container.BeginExecutionContextScope()) {\n    //}\n}\n</code></pre>\n\n<p><strong>CustomerController</strong></p>\n\n<pre><code>public interface ICustomerService : IService&lt;Customer&gt; {}\n\npublic class CustomerService : BaseService&lt;Customer, MyDbContext&gt;, ICustomerService {\n    public CustomerService(IUnitOfWork&lt;MyDbContext&gt; unitOfWork) : base(unitOfWork) {}\n    // do stuff\n}\n\npublic class CustomerController : Controller {\n    private readonly ICustomerService _service;\n\n    public CustomerController(ICustomerService service) {\n        _service = service;\n    }\n\n    public ActionResult Index() {\n        var foo = _service.GetById(112); // works\n        // do stuff\n        return View();\n    }\n\n    public async Task&lt;int&gt; Foo() { // error out on calling this method\n        var foo = await _service.GetByIdAsync(112); \n        return foo.SomeId;\n    }\n}\n</code></pre>\n\n<p>My problem is that whenever I used async/await, the ioc failed. Then I looked its <a href=\"https://simpleinjector.readthedocs.io/en/latest/lifetimes.html#per-execution-context-scope-async-await\" rel=\"nofollow noreferrer\">documentation</a>, it got a different <code>LifeStyle</code> for Asynchronous methods. So I changed the <code>DefaultScopeLifeStyle</code> to <code>ExecutionContextScopeLifestyle()</code>, it errored out </p>\n\n<blockquote>\n  <p>The ICustomerService is registered as 'Execution Context Scope' lifestyle, but the instance is requested outside the context of a Execution Context Scope.</p>\n</blockquote>\n\n<p>Do I need to implement a hybrid lifestyle for using asyn/await as well as synchronous methods? Or something is wrong in my design?</p>\n\n<p><strong>Error detail</strong> (with <code>WebRequestLifestyle</code>)</p>\n\n<blockquote>\n  <p>The asynchronous action method 'foo' returns a Task, which cannot be executed synchronously.</p>\n  \n  <p>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. </p>\n  \n  <p>Exception Details: System.InvalidOperationException: The asynchronous action method 'foo' returns a Task, which cannot be executed synchronously.</p>\n  \n  <p>Source Error: </p>\n  \n  <p>An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.</p>\n  \n  <p>Stack Trace: </p>\n  \n  <p>[InvalidOperationException: The asynchronous action method 'foo' returns a Task, which cannot be executed synchronously.]\n     System.Web.Mvc.Async.TaskAsyncActionDescriptor.Execute(ControllerContext controllerContext, IDictionary<code>2 parameters) +119\n     System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary</code>2 parameters) +27\n     System.Web.Mvc.&lt;>c__DisplayClass15.b__12() +56\n     System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func<code>1 continuation) +256\n     System.Web.Mvc.&lt;&gt;c__DisplayClass17.&lt;InvokeActionMethodWithFilters&gt;b__14() +22\n     System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList</code>1 filters, ActionDescriptor actionDescriptor, IDictionary<code>2 parameters) +190\n     System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +522\n     NotFoundMvc.ActionInvokerWrapper.InvokeActionWith404Catch(ControllerContext controllerContext, String actionName) +32\n     NotFoundMvc.ActionInvokerWrapper.InvokeAction(ControllerContext controllerContext, String actionName) +16\n     System.Web.Mvc.&lt;&gt;c__DisplayClass22.&lt;BeginExecuteCore&gt;b__1e() +23\n     System.Web.Mvc.Async.AsyncResultWrapper.&lt;.cctor&gt;b__0(IAsyncResult asyncResult, Action action) +15\n     System.Web.Mvc.Async.WrappedAsyncResult</code>2.CallEndDelegate(IAsyncResult asyncResult) +16\n     System.Web.Mvc.Async.WrappedAsyncResultBase<code>1.End() +49\n     System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +36\n     System.Web.Mvc.Controller.&lt;BeginExecute&gt;b__15(IAsyncResult asyncResult, Controller controller) +12\n     System.Web.Mvc.Async.WrappedAsyncVoid</code>1.CallEndDelegate(IAsyncResult asyncResult) +22\n     System.Web.Mvc.Async.WrappedAsyncResultBase<code>1.End() +49\n     System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +26\n     System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +10\n     System.Web.Mvc.MvcHandler.&lt;BeginProcessRequest&gt;b__5(IAsyncResult asyncResult, ProcessRequestState innerState) +21\n     System.Web.Mvc.Async.WrappedAsyncVoid</code>1.CallEndDelegate(IAsyncResult asyncResult) +29\n     System.Web.Mvc.Async.WrappedAsyncResultBase`1.End() +49\n     System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +28\n     System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9\n     System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +9765121\n     System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +155</p>\n</blockquote>\n\n<p><strong>Edit</strong>\nI've confirmed it's not a Simple Injector issue, it's really <a href=\"https://stackoverflow.com/questions/14994335/the-asynchronous-action-method-returns-a-task-which-cannot-be-executed-synchron?noredirect=1&amp;lq=1\">this</a>. I've tried to clean the solution, remove the dlls in the bin folder, still no luck with same error. However, I changed the controller to an ApiController, the asyn worked well. </p>\n"}, {"tags": ["c#", "file", "serialization", "protocol-buffers", "memorystream"], "answers": [{"tags": [], "owner": {"reputation": 2566, "user_id": 5874702, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/IPSB7.png?s=128&g=1", "display_name": "Roka545", "link": "https://stackoverflow.com/users/5874702/roka545"}, "is_accepted": false, "score": 0, "last_activity_date": 1487192912, "creation_date": 1487192912, "answer_id": 42260079, "question_id": 42259811, "link": "https://stackoverflow.com/questions/42259811/google-protocol-buffers-setting-a-field/42260079#42260079", "title": "Google Protocol Buffers - setting a field.", "body": "<p>Figured it out. All you have to do is set the field and place it in bracket. So in my example I would need to do this:</p>\n\n<pre><code>FilePaths fpTest = new FilePaths\n{\n    Path = { filepaths }\n};\n</code></pre>\n"}], "owner": {"reputation": 2566, "user_id": 5874702, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/IPSB7.png?s=128&g=1", "display_name": "Roka545", "link": "https://stackoverflow.com/users/5874702/roka545"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487192912, "creation_date": 1487191916, "question_id": 42259811, "link": "https://stackoverflow.com/questions/42259811/google-protocol-buffers-setting-a-field", "title": "Google Protocol Buffers - setting a field.", "body": "<p>I'm using Google Protocol Buffers with C# and I'm unable to set a field for an object I have. I have two .proto files: filepath.proto and filepaths.proto. Filepaths.proto contains a repeated field for Filepath.proto messages. Here are both files:</p>\n\n<pre><code>// filepath.proto\n\nsyntax = \"proto3\";\npackage TEST;\n\nmessage FilePath\n{\n   string path = 1;\n}\n\n// filepaths.proto\nsyntax = \"proto3\";\nimport \"filepath.proto\";\npackage TEST;\n\nmessage FilePaths\n{\n   repeated FilePath file_path = 1;\n}\n</code></pre>\n\n<p>I know how to create FilePath objects: </p>\n\n<p>As you can see, the FilePaths message uses several FilePath objects. I know how to create several FilePath objects using: </p>\n\n<pre><code>Google.Protobuf.Collections.RepeatedField&lt;FilePath&gt; filepaths = new Google.Protobuf.Collections.RepeatedField&lt;FilePath&gt;();\nfilepaths.Add(fp1);\nfilepaths.Add(fp2);\nfilepaths.Add(fp3);\nfilepaths.Add(fp4);\nfilepaths.Add(fp5);\n</code></pre>\n\n<p>where fp1, fp2, fp3, fp4, and fp5 are FilePath objects I created earlier in code. I create the FilePaths object like this:</p>\n\n<pre><code>FilePaths fpTest = new FilePaths\n{\n    Path = filepaths // ERROR HERE\n};\n</code></pre>\n\n<p>Visual Studio tells me that the field \"Paths\" of FilePaths is read-only, i.e., I only get a GET, not a SET. Is there anyway around this or a way to fix this? Basically I'm trying to create a FilePaths object that contains several FilePath objects. </p>\n"}, {"tags": ["c#", "winforms", "richtextbox"], "comments": [{"owner": {"reputation": 563, "user_id": 466316, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1d8d318b49aebd4265b6da27efe6f8c6?s=128&d=identicon&r=PG", "display_name": "MrSparkly", "link": "https://stackoverflow.com/users/466316/mrsparkly"}, "reply_to_user": {"reputation": 18158, "user_id": 3293914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fPAnb.jpg?s=128&g=1", "display_name": "Dan Field", "link": "https://stackoverflow.com/users/3293914/dan-field"}, "edited": false, "score": 0, "creation_date": 1487192006, "post_id": 42259788, "comment_id": 71677292, "body": "WinForm (I&#39;ll edit the original)"}, {"owner": {"reputation": 563, "user_id": 466316, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1d8d318b49aebd4265b6da27efe6f8c6?s=128&d=identicon&r=PG", "display_name": "MrSparkly", "link": "https://stackoverflow.com/users/466316/mrsparkly"}, "edited": false, "score": 0, "creation_date": 1487192637, "post_id": 42259788, "comment_id": 71677649, "body": "I don&#39;t want to disable shortcuts, I just want Ctrl-Shift-Z to work like Ctrl-Y (Redo)."}], "answers": [{"tags": [], "owner": {"reputation": 3571, "user_id": 2018731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134baab491cb1a3ebff752e5ea96dcaa?s=128&d=identicon&r=PG", "display_name": "RogerN", "link": "https://stackoverflow.com/users/2018731/rogern"}, "is_accepted": false, "score": 1, "last_activity_date": 1487193123, "creation_date": 1487193123, "answer_id": 42260146, "question_id": 42259788, "link": "https://stackoverflow.com/questions/42259788/c-richtextbox-filter-out-or-remap-a-keystroke/42260146#42260146", "title": "C# richTextBox filter out or remap a keystroke", "body": "<p>In your parent form, set the KeyPreview property to true and then look for the desired shortcut in the Form's KeyDown event.</p>\n\n<pre><code>public partial class MyForm : Form\n{\n    public MyForm()\n    {\n        InitializeComponent();\n        this.KeyPreview = true;\n        this.KeyDown += MyForm_KeyDown;\n    }\n\n    private void MyForm_KeyDown(object sender, KeyEventArgs e)\n    {\n        if ((e.Modifiers &amp; Keys.Shift) != 0 &amp;&amp;\n            (e.Modifiers &amp; Keys.Control) != 0 &amp;&amp;\n            (e.KeyCode == Keys.Z))\n        {\n            e.Handled = true;\n            richTextBox1.Redo();\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 563, "user_id": 466316, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1d8d318b49aebd4265b6da27efe6f8c6?s=128&d=identicon&r=PG", "display_name": "MrSparkly", "link": "https://stackoverflow.com/users/466316/mrsparkly"}, "edited": false, "score": 0, "creation_date": 1487193640, "post_id": 42260191, "comment_id": 71678213, "body": "Perfect. Exactly what I wanted."}, {"owner": {"reputation": 1135, "user_id": 5708847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af01b6f72c50ddff14e8e2b3e6a59993?s=128&d=identicon&r=PG&f=1", "display_name": "Ethilium", "link": "https://stackoverflow.com/users/5708847/ethilium"}, "reply_to_user": {"reputation": 563, "user_id": 466316, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1d8d318b49aebd4265b6da27efe6f8c6?s=128&d=identicon&r=PG", "display_name": "MrSparkly", "link": "https://stackoverflow.com/users/466316/mrsparkly"}, "edited": false, "score": 0, "creation_date": 1487193666, "post_id": 42260191, "comment_id": 71678219, "body": "Glad to help. Happy coding!"}], "tags": [], "owner": {"reputation": 1135, "user_id": 5708847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af01b6f72c50ddff14e8e2b3e6a59993?s=128&d=identicon&r=PG&f=1", "display_name": "Ethilium", "link": "https://stackoverflow.com/users/5708847/ethilium"}, "is_accepted": true, "score": 2, "last_activity_date": 1487193273, "last_edit_date": 1495540395, "creation_date": 1487193273, "answer_id": 42260191, "question_id": 42259788, "link": "https://stackoverflow.com/questions/42259788/c-richtextbox-filter-out-or-remap-a-keystroke/42260191#42260191", "title": "C# richTextBox filter out or remap a keystroke", "body": "<p>Something like:</p>\n\n<pre><code>protected override bool ProcessCmdKey(ref Message msg, Keys keyData) {\n  if (keyData == (Keys.Control | Keys.Shift | Keys.Z)) {\n    richTextBox.Redo();\n    return true;\n  }\n  return base.ProcessCmdKey(ref msg, keyData);\n}\n</code></pre>\n\n<p>As <a href=\"https://stackoverflow.com/questions/400113/best-way-to-implement-keyboard-shortcuts-in-a-windows-forms-application\">Hans Passant</a> said in his answer, you should also check to make sure you have the form's <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx\" rel=\"nofollow noreferrer\">KeyPreview</a> property to True.</p>\n"}], "owner": {"reputation": 563, "user_id": 466316, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1d8d318b49aebd4265b6da27efe6f8c6?s=128&d=identicon&r=PG", "display_name": "MrSparkly", "link": "https://stackoverflow.com/users/466316/mrsparkly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 42260191, "answer_count": 2, "score": 2, "last_activity_date": 1487193273, "creation_date": 1487191879, "last_edit_date": 1487192257, "question_id": 42259788, "link": "https://stackoverflow.com/questions/42259788/c-richtextbox-filter-out-or-remap-a-keystroke", "title": "C# richTextBox filter out or remap a keystroke", "body": "<p>Using C#, in a Win form, what's the simplest way to filter out (or remap) a keystroke (Ctrl-Shift-Z) in a richTextBox? I know of various keyboard hook projects on CodeProject, but they involve entire classes. I'd like to use the simplest method possible, such as one function override. The reason: richTextBox seems to treat Ctrl-Shift-Z the same way as Ctrl-Z i.e. as Undo. I'd prefer to use Ctrl-Shift-Z as Redo. I tried the \"KeyDown\" method, but it doesn't seem to capture the keystroke, keystrokes seem to be handled lower than that.</p>\n\n<pre><code>private void richTextBox_KeyDown(object sender, KeyEventArgs e) {\n    if (e.KeyCode == Keys.Z &amp;&amp; Control.ModifierKeys == Keys.Shift &amp;&amp; Control.ModifierKeys == Keys.Control) {\n        richTextBox.Redo();\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "visual-studio", "oop", "c#-6.0"], "comments": [{"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1487193030, "post_id": 42259783, "comment_id": 71677863, "body": "Listen to uncle @Habib. don&#39;t even try to do what you do. Although, it is totally possible. An exe in .net can be referenced same way as dll and if you have public API - there you go. But this is just bad idea"}], "answers": [{"tags": [], "owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "is_accepted": false, "score": 4, "last_activity_date": 1487192016, "creation_date": 1487192016, "answer_id": 42259840, "question_id": 42259783, "link": "https://stackoverflow.com/questions/42259783/access-to-the-project-classes-from-library-project-c/42259840#42259840", "title": "Access to the project classes from library project C#", "body": "<p>It is not a good idea to reference the executable/main project in the library project. It should be vice versa. </p>\n\n<p>The Library project should be independent of the application's platform. What you should do is to extract the data access code in another library project. That way you will be able to access it in other libraries/projects. </p>\n"}], "owner": {"reputation": 99, "user_id": 4032961, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-TfckFARue4I/AAAAAAAAAAI/AAAAAAAAADg/OT1v8PlMFCA/photo.jpg?sz=128", "display_name": "Fernando Bernal", "link": "https://stackoverflow.com/users/4032961/fernando-bernal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487196965, "creation_date": 1487191862, "last_edit_date": 1487196965, "question_id": 42259783, "link": "https://stackoverflow.com/questions/42259783/access-to-the-project-classes-from-library-project-c", "title": "Access to the project classes from library project C#", "body": "<p>I have the following question.</p>\n\n<p>I am currently working on a C # project and need to create some library projects, but at the time of creating these projects I was presented with the following scenario:\nI need access to the classes in the main project from within the library projects\nSince my data base access layer is in the main project, I'm looking for a way so that I don't have to add this into every library project.</p>\n\n<p>Really only needed to execute SELECT statements. I use ADO.NET to execute all transactions over the data base.</p>\n\n<p>Any help will be really useful.</p>\n\n<p>Thanks for your time.</p>\n"}, {"tags": ["c#", "linq", "many-to-many"], "comments": [{"owner": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "edited": false, "score": 0, "creation_date": 1487191961, "post_id": 42259767, "comment_id": 71677269, "body": "Where does <code>query</code> come from?  Why are you assigning to <code>q</code> twice?"}, {"owner": {"reputation": 696, "user_id": 2472097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dc7528e5c08bdc18c80374187395bcdc?s=128&d=identicon&r=PG", "display_name": "kurgaan", "link": "https://stackoverflow.com/users/2472097/kurgaan"}, "reply_to_user": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "edited": false, "score": 0, "creation_date": 1487192527, "post_id": 42259767, "comment_id": 71677568, "body": "Sorry, that was a typo. I have edited the code to show where query comes from. In my actual code I have several query = query.Where  statements."}, {"owner": {"reputation": 1392, "user_id": 3617120, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/y3aLt.jpg?s=128&g=1", "display_name": "awh112", "link": "https://stackoverflow.com/users/3617120/awh112"}, "edited": false, "score": 0, "creation_date": 1487192566, "post_id": 42259767, "comment_id": 71677593, "body": "What error message are you seeing, or what&#39;s not working as you expect it to?"}, {"owner": {"reputation": 696, "user_id": 2472097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dc7528e5c08bdc18c80374187395bcdc?s=128&d=identicon&r=PG", "display_name": "kurgaan", "link": "https://stackoverflow.com/users/2472097/kurgaan"}, "edited": false, "score": 0, "creation_date": 1487192955, "post_id": 42259767, "comment_id": 71677827, "body": "sorry, added the error message"}, {"owner": {"reputation": 1392, "user_id": 3617120, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/y3aLt.jpg?s=128&g=1", "display_name": "awh112", "link": "https://stackoverflow.com/users/3617120/awh112"}, "edited": false, "score": 0, "creation_date": 1487193196, "post_id": 42259767, "comment_id": 71677956, "body": "Try enumerating your first results set (<code>query</code>) using <code>ToList()</code> and seeing if you can search that result set.  I included some code in my answer below."}, {"owner": {"reputation": 696, "user_id": 2472097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dc7528e5c08bdc18c80374187395bcdc?s=128&d=identicon&r=PG", "display_name": "kurgaan", "link": "https://stackoverflow.com/users/2472097/kurgaan"}, "edited": false, "score": 0, "creation_date": 1487193741, "post_id": 42259767, "comment_id": 71678245, "body": "It seems to be complaining that ICollection&lt;ItemsBuckets&gt;&#39;  is an ICollection and therefor does not known about Buckets. Each Item has multiple ItemsBuckets. Each ItemBucket would then have a Bucket. Enumerating the query still leaves me with the same problem."}, {"owner": {"reputation": 696, "user_id": 2472097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dc7528e5c08bdc18c80374187395bcdc?s=128&d=identicon&r=PG", "display_name": "kurgaan", "link": "https://stackoverflow.com/users/2472097/kurgaan"}, "reply_to_user": {"reputation": 1392, "user_id": 3617120, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/y3aLt.jpg?s=128&g=1", "display_name": "awh112", "link": "https://stackoverflow.com/users/3617120/awh112"}, "edited": false, "score": 0, "creation_date": 1487194406, "post_id": 42259767, "comment_id": 71678584, "body": "thanks @awh112, Fredy&#39;s response worked for me."}], "answers": [{"comments": [{"owner": {"reputation": 15798, "user_id": 220005, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6ac1b3b619949e4d1e397d522233e655?s=128&d=identicon&r=PG", "display_name": "jenson-button-event", "link": "https://stackoverflow.com/users/220005/jenson-button-event"}, "edited": false, "score": 1, "creation_date": 1487194261, "post_id": 42259871, "comment_id": 71678504, "body": "This is inefficient as you are returning the whole database of ItemsBuckets to code. The filter would be better at the database tier."}], "tags": [], "owner": {"reputation": 1392, "user_id": 3617120, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/y3aLt.jpg?s=128&g=1", "display_name": "awh112", "link": "https://stackoverflow.com/users/3617120/awh112"}, "is_accepted": false, "score": 0, "last_activity_date": 1487193127, "last_edit_date": 1487193127, "creation_date": 1487192140, "answer_id": 42259871, "question_id": 42259767, "link": "https://stackoverflow.com/questions/42259767/net-linq-query-joins/42259871#42259871", "title": ".net linq query joins", "body": "<p>You need to enumerate your results by taking your first query and calling <code>.ToList()</code>, then use your <code>Where()</code> clause on that result set.</p>\n\n<pre><code>var q = context.Items.Include(\"ItemsBuckets\").Include(\"ItemsBuckets.Buckets\").ToList();\nvar results = q.Where(n =&gt; n.ItemsBuckets.Buckets.Name.Contains(bucketname));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 696, "user_id": 2472097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dc7528e5c08bdc18c80374187395bcdc?s=128&d=identicon&r=PG", "display_name": "kurgaan", "link": "https://stackoverflow.com/users/2472097/kurgaan"}, "edited": false, "score": 0, "creation_date": 1487194283, "post_id": 42260342, "comment_id": 71678511, "body": "Thank you. That was the ticket."}], "tags": [], "owner": {"reputation": 2767, "user_id": 55154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fse7P.jpg?s=128&g=1", "display_name": "Fredy Treboux", "link": "https://stackoverflow.com/users/55154/fredy-treboux"}, "is_accepted": true, "score": 3, "last_activity_date": 1487193912, "creation_date": 1487193912, "answer_id": 42260342, "question_id": 42259767, "link": "https://stackoverflow.com/questions/42259767/net-linq-query-joins/42260342#42260342", "title": ".net linq query joins", "body": "<p>Have you tried the following?</p>\n\n<pre><code>var query = context.Items\n                   .Where(i =&gt; i.ItemsBuckets.Any(ib =&gt; ib.Bucket.Name.Contains(bucketname)));\n\nvar items = query.ToList();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15798, "user_id": 220005, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6ac1b3b619949e4d1e397d522233e655?s=128&d=identicon&r=PG", "display_name": "jenson-button-event", "link": "https://stackoverflow.com/users/220005/jenson-button-event"}, "is_accepted": false, "score": 0, "last_activity_date": 1487194109, "creation_date": 1487194109, "answer_id": 42260407, "question_id": 42259767, "link": "https://stackoverflow.com/questions/42259767/net-linq-query-joins/42260407#42260407", "title": ".net linq query joins", "body": "<p>Assuming you have a property <code>Buckets of ICollection&lt;ItemBucket&gt;</code> on <code>Item</code>:</p>\n\n<pre><code>var query = from item in context.Items\n           where item.Buckets.Any(b =&gt; b.BucketName == name)\n           select item;\n\nreturn query.ToList();\n</code></pre>\n"}], "owner": {"reputation": 696, "user_id": 2472097, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/dc7528e5c08bdc18c80374187395bcdc?s=128&d=identicon&r=PG", "display_name": "kurgaan", "link": "https://stackoverflow.com/users/2472097/kurgaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 42260342, "answer_count": 3, "score": 2, "last_activity_date": 1487208519, "creation_date": 1487191801, "last_edit_date": 1487208519, "question_id": 42259767, "link": "https://stackoverflow.com/questions/42259767/net-linq-query-joins", "title": ".net linq query joins", "body": "<p>I'm having some trouble with my \"where\" clause in a linq query.\nI have the following three tables. </p>\n\n<p>Items {ItemId,Name}</p>\n\n<p>Buckets {BucketId, Name}</p>\n\n<p>ItemsBuckets {Id, BucketId, ItemId}</p>\n\n<p>Items can exist in multiple buckets, which is why I have the ItemsBuckets Table. \nI want to find all the items that have a specific bucket with name containing bucketname. </p>\n\n<pre><code>System.Linq.IQueryable&lt;Item&gt; query = context.Items.Include(\"ItemsBuckets\")\n                     .Include(\"ItemsBuckets.Buckets\");\nquery = query.Where(n =&gt; n.ItemsBuckets.Buckets.Name.Contains(bucketname));\nObservableCollection&lt;Item&gt; items = new ObservableCollection&lt;Item&gt;(query.ToList());\n</code></pre>\n\n<p>my where clause does not work. I get the following error:</p>\n\n<pre><code>Error   CS1061  'ICollection&lt;ItemsBuckets&gt;' does not contain a definition for \n'Buckets' and no extension method 'Buckets' accepting a first argument of\n type ICollection&lt;ItemsBuckets&gt; could be found (are you missing a using \ndirective or an assembly reference?)    \n</code></pre>\n\n<p>I can not figure out a way to approach this. Any ideas? </p>\n"}, {"tags": ["c#", "entity-framework-6"], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 3333134, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/87fd8bf2cf386684a4736aa7284c5e03?s=128&d=identicon&r=PG&f=1", "display_name": "user3333134", "link": "https://stackoverflow.com/users/3333134/user3333134"}, "edited": false, "score": 0, "creation_date": 1487194618, "post_id": 42260128, "comment_id": 71678686, "body": "Yes very simple bit of a &quot;duh&quot; moment. Thanks for the help. Think the fact that you can&#39;t do something like &quot;range = new Range(tbl.end, tbl.start),&quot; was throwing me off a bit. Thanks again!"}], "tags": [], "owner": {"reputation": 12460, "user_id": 4864425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd9e4a4282276cbce5a5a6bf6964f37d?s=128&d=identicon&r=PG&f=1", "display_name": "Ruard van Elburg", "link": "https://stackoverflow.com/users/4864425/ruard-van-elburg"}, "is_accepted": true, "score": 1, "last_activity_date": 1487193075, "creation_date": 1487193075, "answer_id": 42260128, "question_id": 42259718, "link": "https://stackoverflow.com/questions/42259718/selecting-part-of-entity-into-custom-object-with-children-objects/42260128#42260128", "title": "Selecting part of entity into custom object with children objects", "body": "<p>You mean like this?</p>\n\n<pre><code>var query = from tbl in db.myTable\n            select new MyModel\n            {\n               id = tbl.id,\n               range = new Range\n               {\n                   start = tbl.start,\n                   end = tbl.end\n               }\n            }\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 3333134, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/87fd8bf2cf386684a4736aa7284c5e03?s=128&d=identicon&r=PG&f=1", "display_name": "user3333134", "link": "https://stackoverflow.com/users/3333134/user3333134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 42260128, "answer_count": 1, "score": 0, "last_activity_date": 1487193075, "creation_date": 1487191620, "question_id": 42259718, "link": "https://stackoverflow.com/questions/42259718/selecting-part-of-entity-into-custom-object-with-children-objects", "title": "Selecting part of entity into custom object with children objects", "body": "<p>I have a entity framework query like so - </p>\n\n<pre><code>var query = from tbl in db.myTable\n            select new MyModel\n            {\n               id = tbl.id,\n               start = tbl.start,\n               end = tbl.end\n            }\n</code></pre>\n\n<p>MyModel is the following -</p>\n\n<pre><code>public class MyModel\n{\n   public int id {get; set;}\n   public Range range  {get; set;} // contains start and end property\n}\n</code></pre>\n\n<p>Is there anyway inside the query select to map the properties of myTable into range.start and range.end?</p>\n\n<p>The only way i've found to get working is to add additional properties into the model like so - </p>\n\n<pre><code>public class MyModel\n{\n   public int id {get; set;}\n   public string _start {get; set;}\n   public string _end {get; set;}\n   public Range range {get; set;} // contains start and end property\n}\n</code></pre>\n\n<p>Then running some code after the query has completed that maps _start into range.start and _end into range.end.</p>\n\n<p>The problem with this is that I foresee needing to map start/end into many custom sub models from the entity. I would need to always import the function from a common file and remember to run it after the query ran. It would be much cleaner if it was possible to just map them directly in the select like -</p>\n\n<pre><code>var query = from tbl in db.myTable\n            select new MyModel\n            {\n               id = tbl.id,\n               range.start = tbl.start,\n               range.end = tbl.end\n            }\n</code></pre>\n\n<p>or </p>\n\n<pre><code>var query = from tbl in db.myTable\n            select new MyModel\n            {\n               id = tbl.id,\n               range = new Range(tbl.end, tbl.start),\n            }\n</code></pre>\n"}, {"tags": ["c#", "this"], "comments": [{"owner": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 2, "creation_date": 1487191612, "post_id": 42259667, "comment_id": 71677095, "body": "<code>this</code> refers to the object itself. eg: <code>myFoo.speakTo(. . .)</code> would have <code>this</code> equal to <code>myFoo</code>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 6614555, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/958abae13b26dbf013868696c4e12ed3?s=128&d=identicon&r=PG&f=1", "display_name": "NeoTrader", "link": "https://stackoverflow.com/users/6614555/neotrader"}, "edited": false, "score": 0, "creation_date": 1487192711, "post_id": 42259708, "comment_id": 71677691, "body": "The object &quot;speaker&quot; in your example is a reference variable from Class Speaker. What if I have more the one reference variable from class Speaker in the same class in which I&#39;m wrinting this, for example, object &quot;talker&quot;. If the &quot;this&quot; keyword refers simply to a Speaker class instance, regardless of what instance called SpeakTo(), how does the compiler know that it must pass &quot;speaker&quot; and not &quot;talker&quot; as the argument?"}, {"owner": {"reputation": 9397, "user_id": 2279448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e686e04e095735f571dff07ea9818a9?s=128&d=identicon&r=PG", "display_name": "Zoran Horvat", "link": "https://stackoverflow.com/users/2279448/zoran-horvat"}, "reply_to_user": {"reputation": 119, "user_id": 6614555, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/958abae13b26dbf013868696c4e12ed3?s=128&d=identicon&r=PG&f=1", "display_name": "NeoTrader", "link": "https://stackoverflow.com/users/6614555/neotrader"}, "edited": false, "score": 0, "creation_date": 1487192815, "post_id": 42259708, "comment_id": 71677744, "body": "<code>this</code> keyword always refers to an object of the class in which it is written. <code>this</code> in the method of <code>Speaker</code> is the object of class <code>Speaker</code>; <code>this</code> in the method of <code>Talker</code> is the object of class <code>Talker</code>, and so on."}], "tags": [], "owner": {"reputation": 9397, "user_id": 2279448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e686e04e095735f571dff07ea9818a9?s=128&d=identicon&r=PG", "display_name": "Zoran Horvat", "link": "https://stackoverflow.com/users/2279448/zoran-horvat"}, "is_accepted": false, "score": 4, "last_activity_date": 1487192134, "last_edit_date": 1487192134, "creation_date": 1487191597, "answer_id": 42259708, "question_id": 42259667, "link": "https://stackoverflow.com/questions/42259667/uses-of-this-keyword/42259708#42259708", "title": "Uses of &quot;this&quot; Keyword", "body": "<p>No... Actually, <code>this</code> in your context refers to the object on which <code>SpeakTo</code> is defined, not the object which calls it.</p>\n\n<p>Let's put it this way:</p>\n\n<ul>\n<li>Object <code>speaker</code> is of the class <code>Speaker</code> which defines the <code>SpeakTo</code>\nmethod,</li>\n<li>Object <code>caller</code> is calling the <code>speaker.SpeakTo()</code>, and</li>\n<li>Object <code>whoToTalkTo</code> is of the class which defines the <code>TellMe(string, Speaker)</code></li>\n</ul>\n\n<p>As you can see, <code>whoToTalkTo</code> is expecting the <code>Speaker</code> class instance. Then, the <code>speaker</code> object is precisely that, and it is free to pass <code>this</code> as the argument.</p>\n\n<p>Now we can construct a larger example in which these relations are becoming more obvious:</p>\n\n<pre><code>class Speaker\n{\n    public int Data { get; set; }\n\n    public void SpeakTo(Elephant whoToTalkTo, string message) \n    {\n        // Passing current instance of this class as the argument\n        whoToTalkTo.TellMe(message, this);\n    }\n}\n</code></pre>\n\n<p>This <code>Speaker</code> class contains a piece of state. Now I will use the <code>whoToTalkTo</code> object to change that state:</p>\n\n<pre><code>class Talker\n{\n    public void TellMe(string message, Speaker speaker)\n    {\n        speaker.Data = message.Length;\n    }\n}\n</code></pre>\n\n<p>This implementation is changing the state of one particular object which was passed to it.</p>\n\n<p>Now the ultimate caller comes to the picture, the one which actually selects the <code>Speaker</code> object which will be subjected to the <code>TellMe()</code> method:</p>\n\n<pre><code>class Caller\n{\n    public void DoWork()\n    {\n        Talker talker = new Talker();\n\n        Speaker one = new Speaker();\n        Speaker two = new Speaker();\n\n        // This sets one.Data to length of \"something\"\n        one.SpeakTo(talker, \"something\");\n\n        // This sets two.Data to length of \"else\"\n        two.SpeakTo(talker, \"else\");\n\n        Console.WriteLine(one.Data);\n        Console.WriteLine(two.Data);\n    }\n}\n</code></pre>\n\n<p>This code will print values 9 and 4, which indicates that the <code>whoToTalkTo</code> has actually been modifying the state of two distinct objects.</p>\n"}, {"tags": [], "owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "is_accepted": false, "score": 0, "last_activity_date": 1487191842, "creation_date": 1487191842, "answer_id": 42259779, "question_id": 42259667, "link": "https://stackoverflow.com/questions/42259667/uses-of-this-keyword/42259779#42259779", "title": "Uses of &quot;this&quot; Keyword", "body": "<p><code>this</code> refers to the current object of the class which has method <code>SpeakTo</code>. </p>\n\n<p>consider the following example:</p>\n\n<pre><code>public class A\n{\n      public void SpeakTo(Elephant whoToTalkTo, string message) {\n          whoToTalkTo.TellMe(message, this);\n       }\n}\n</code></pre>\n\n<p>Now if you instantiate an object of <code>A</code> and calls the method <code>SpeakTo</code> it will be like:</p>\n\n<pre><code>A obj = new A();\nobj.SpeakTo();\n</code></pre>\n\n<p>In the method <code>SpeakTo</code>, <code>this</code> refers to the current object, i.e. <code>obj</code>. </p>\n\n<p>The signature of method <code>TellMe</code> should look like:</p>\n\n<pre><code>public void TellMe(string message, A objOfA)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 6614555, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/958abae13b26dbf013868696c4e12ed3?s=128&d=identicon&r=PG&f=1", "display_name": "NeoTrader", "link": "https://stackoverflow.com/users/6614555/neotrader"}, "edited": false, "score": 0, "creation_date": 1487193525, "post_id": 42259873, "comment_id": 71678144, "body": "So, in other words, in &quot;bar.SpeakTo()&quot;, &quot;bar&quot; is only a reference to where the method should be located and used( &quot;bar&quot; is not calling anything) and &quot;this&quot; serves the purpose of passing &quot;bar&quot; itself as an argument. Is this correct?"}, {"owner": {"reputation": 142455, "user_id": 5133585, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/dfqcw.png?s=128&g=1", "display_name": "Sweeper", "link": "https://stackoverflow.com/users/5133585/sweeper"}, "reply_to_user": {"reputation": 119, "user_id": 6614555, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/958abae13b26dbf013868696c4e12ed3?s=128&d=identicon&r=PG&f=1", "display_name": "NeoTrader", "link": "https://stackoverflow.com/users/6614555/neotrader"}, "edited": false, "score": 0, "creation_date": 1487193598, "post_id": 42259873, "comment_id": 71678186, "body": "Yes @NeoTrader a <code>Foo</code> object called <code>foo</code> calls <code>SpeakTo()</code> <i>on</i> <code>bar</code>."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1487194854, "post_id": 42259873, "comment_id": 71678795, "body": "Not always right.  If I write a class <code>BarChild</code> that inherits from <code>Bar</code>, then <code>this</code> is actually a pointer to an instance of <code>BarChild</code> not of <code>Bar</code>.  That is how polymorphism works."}, {"owner": {"reputation": 142455, "user_id": 5133585, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/dfqcw.png?s=128&g=1", "display_name": "Sweeper", "link": "https://stackoverflow.com/users/5133585/sweeper"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1487194952, "post_id": 42259873, "comment_id": 71678853, "body": "@JohnWu &quot;Not always right&quot; which sentence do you mean? Most of the things I said here is in the OP&#39;s context, not general statements."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1487196396, "post_id": 42259873, "comment_id": 71679601, "body": "You&#39;re right Sweeper but I think you know what I&#39;m getting at.  Just thought the answer would not be complete without pointing out that <code>this</code> is not always a reference to the currently executing type."}], "tags": [], "owner": {"reputation": 142455, "user_id": 5133585, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/dfqcw.png?s=128&g=1", "display_name": "Sweeper", "link": "https://stackoverflow.com/users/5133585/sweeper"}, "is_accepted": true, "score": 2, "last_activity_date": 1487192149, "creation_date": 1487192149, "answer_id": 42259873, "question_id": 42259667, "link": "https://stackoverflow.com/questions/42259667/uses-of-this-keyword/42259873#42259873", "title": "Uses of &quot;this&quot; Keyword", "body": "<blockquote>\n  <p>In this method, is it safe to say that the \"this\" has the function of always refering to whatever object calls the method \"SpeakTo()\", regardless of which class the call is written in?</p>\n</blockquote>\n\n<p>Nope. <code>this</code> does <em>not</em> refer to the object that calls <code>SpeakTo</code>. It refers to the object on which <code>SpeakTo</code> is called.</p>\n\n<p>I will use some code to clarify this point</p>\n\n<pre><code>class Foo {\n    public static void Main(String[] args) { \n        var foo = new Foo();\n        foo.MyMethod();\n    }\n\n    public void MyMethod() {\n         var bar = new Bar();\n         bar.SpeakTo(anElephant, \"Hello\");\n     }\n}\n\nclass Bar {\n    public void SpeakTo(Elephant whoToTalkTo, string message) {\n       whoToTalkTo.TellMe(message, this);\n    }\n}\n</code></pre>\n\n<p>According to your statement, <code>this</code> refers to the <code>foo</code> variable that's created in the main method. This is <em>not</em> the case. <code>this</code> actually refers to <code>bar</code>. i.e. the object that's before the method name.</p>\n"}], "owner": {"reputation": 119, "user_id": 6614555, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/958abae13b26dbf013868696c4e12ed3?s=128&d=identicon&r=PG&f=1", "display_name": "NeoTrader", "link": "https://stackoverflow.com/users/6614555/neotrader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 42259873, "answer_count": 3, "score": 1, "last_activity_date": 1487196319, "creation_date": 1487191474, "last_edit_date": 1487196319, "question_id": 42259667, "link": "https://stackoverflow.com/questions/42259667/uses-of-this-keyword", "title": "Uses of &quot;this&quot; Keyword", "body": "<p>I'm studying the uses of <code>this</code> and I think I understand it, at least partially, like when to solve ambiguity and to call methods from the \"current\" class, but one example from the book I'm reading(Head First C#) is giving me a hard time:</p>\n\n<pre><code>public void SpeakTo(Elephant whoToTalkTo, string message) {\n    whoToTalkTo.TellMe(message, this);\n}\n</code></pre>\n\n<p>In this method, is it safe to say that the <code>this</code> has the function of always refering to whatever object calls the method <code>SpeakTo()</code>, regardless of which class the call is written in?</p>\n"}, {"tags": ["c#", "xpath"], "comments": [{"owner": {"reputation": 17034, "user_id": 858913, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b5015a60c08feee1d8116be3dd70878d?s=128&d=identicon&r=PG", "display_name": "eLRuLL", "link": "https://stackoverflow.com/users/858913/elrull"}, "edited": false, "score": 0, "creation_date": 1487198786, "post_id": 42259650, "comment_id": 71680731, "body": "that will return both <code>tr</code> and <code>a</code> if both exist"}, {"owner": {"reputation": 614, "user_id": 530516, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c486e4bc95cbf57f285ee9f5af7662c8?s=128&d=identicon&r=PG", "display_name": "CoderBrien", "link": "https://stackoverflow.com/users/530516/coderbrien"}, "reply_to_user": {"reputation": 17034, "user_id": 858913, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b5015a60c08feee1d8116be3dd70878d?s=128&d=identicon&r=PG", "display_name": "eLRuLL", "link": "https://stackoverflow.com/users/858913/elrull"}, "edited": false, "score": 0, "creation_date": 1487246513, "post_id": 42259650, "comment_id": 71702772, "body": "i removed my comment.  the code is self evident as to what it does."}], "owner": {"reputation": 614, "user_id": 530516, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c486e4bc95cbf57f285ee9f5af7662c8?s=128&d=identicon&r=PG", "display_name": "CoderBrien", "link": "https://stackoverflow.com/users/530516/coderbrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487246490, "creation_date": 1487191411, "last_edit_date": 1487246490, "question_id": 42259650, "link": "https://stackoverflow.com/questions/42259650/xpath-for-select-single-with-optional-child-c", "title": "xpath for select single with optional child (c#)", "body": "<p>is there a more concise/performant way to do the following with xpath 1.0?</p>\n\n<pre><code> XPathNavigator navigator = ...;\n var node = navigator.SelectSingleNode(\n                \"./table[1]/tr[1]/td[1] | ./table[1]/tr[1]/td[1]/a\"\n            );\n</code></pre>\n"}, {"tags": ["c#", "sql", "database", "datagridview", "datatable"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1487193468, "post_id": 42259646, "comment_id": 71678113, "body": "Are you reading a CSV file?  The first row will become the columns names and not be put into the 1st row."}, {"owner": {"reputation": 1570, "user_id": 5008193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iOKgE.jpg?s=128&g=1", "display_name": "Graffito", "link": "https://stackoverflow.com/users/5008193/graffito"}, "edited": false, "score": 0, "creation_date": 1487193955, "post_id": 42259646, "comment_id": 71678347, "body": "Does the first line of the csv contain the column names? Do you see these names in the column headers of the DataGridView?"}, {"owner": {"reputation": 57, "user_id": 7571239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZOIf.png?s=128&g=1", "display_name": "snikitin-de", "link": "https://stackoverflow.com/users/7571239/snikitin-de"}, "edited": false, "score": 0, "creation_date": 1487281977, "post_id": 42259646, "comment_id": 71727428, "body": "No, I read the SQL Server DB. Yes, I can see the headlines in a datagridview, well and without them there is no first line."}, {"owner": {"reputation": 57, "user_id": 7571239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZOIf.png?s=128&g=1", "display_name": "snikitin-de", "link": "https://stackoverflow.com/users/7571239/snikitin-de"}, "edited": false, "score": 0, "creation_date": 1487282357, "post_id": 42259646, "comment_id": 71727630, "body": "<a href=\"http://www.picshare.ru/uploads/170217/Cnfs5tp55i.png\" rel=\"nofollow noreferrer\">Screenshot DB and Datagridview</a> PS: Sorry for that there is not in English."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5280130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-tQpgiDPwyk8/AAAAAAAAAAI/AAAAAAAAAFw/eOM2gfDJt6Q/photo.jpg?sz=128", "display_name": "Kenion", "link": "https://stackoverflow.com/users/5280130/kenion"}, "reply_to_user": {"reputation": 57, "user_id": 7571239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZOIf.png?s=128&g=1", "display_name": "snikitin-de", "link": "https://stackoverflow.com/users/7571239/snikitin-de"}, "edited": false, "score": 0, "creation_date": 1487343697, "post_id": 42261702, "comment_id": 71756688, "body": "be a bit more accurate what did not work well? I tested this with a 5.000 rows and 20 colums database without any issue"}, {"owner": {"reputation": 57, "user_id": 7571239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZOIf.png?s=128&g=1", "display_name": "snikitin-de", "link": "https://stackoverflow.com/users/7571239/snikitin-de"}, "edited": false, "score": 0, "creation_date": 1487347982, "post_id": 42261702, "comment_id": 71759805, "body": "I realized what the problem is, I do not have the desired DataTable in line, although it is in the database. I checked in this way: <code>for (int curRow = 0; curRow &lt;dt.Rows.Count; curRow ++) \u00a0\u00a0\u00a0\u00a0for (int curCol = 0; curCol &lt;dt.Columns.Count; curCol ++) \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Console.WriteLine (dt.Rows [curRow] [curCol] .ToString () + &quot;\\ t&quot;);</code>"}, {"owner": {"reputation": 57, "user_id": 7571239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZOIf.png?s=128&g=1", "display_name": "snikitin-de", "link": "https://stackoverflow.com/users/7571239/snikitin-de"}, "edited": false, "score": 0, "creation_date": 1487348010, "post_id": 42261702, "comment_id": 71759827, "body": "But SqlDataReader Reader also checked here in this code and there it is necessary first line is:  <code>private void ReadSingleRow (IDataRecord record) \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 { \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 string dat = null;  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 for (int i = 0; i &lt;record.FieldCount; i ++) \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 { \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 dat + = record [i] + &quot;,&quot;; \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Console.WriteLine (dat); \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }</code>"}], "tags": [], "owner": {"reputation": 75, "user_id": 5280130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-tQpgiDPwyk8/AAAAAAAAAAI/AAAAAAAAAFw/eOM2gfDJt6Q/photo.jpg?sz=128", "display_name": "Kenion", "link": "https://stackoverflow.com/users/5280130/kenion"}, "is_accepted": false, "score": 0, "last_activity_date": 1487290627, "last_edit_date": 1487290627, "creation_date": 1487199532, "answer_id": 42261702, "question_id": 42259646, "link": "https://stackoverflow.com/questions/42259646/a-table-loaded-with-a-database-in-the-datagridview-does-not-display-the-first-li/42261702#42261702", "title": "A table loaded with a database in the datagridview does not display the first line", "body": "<p>Used following codesnippet and it worked flawless on my end</p>\n\n<pre><code>    private void Request(string request) {\n\n    var dt = new DataTable();\n\n    try {\n        MySqlCommand cmd = new MySqlCommand(request, connectionString);\n        MySqlDataReader reader = cmd.ExecuteReader();\n\n        while (reader.Read()) {\n            dt.Load(reader);\n            if (reader.IsClosed) break;\n        }\n        reader.Close();\n    } catch (MySql.Data.MySqlClient.MySqlException ex) {\n        Console.WriteLine(ex);\n    }\n    dataGridView1.DataSource = dt;\n}\n</code></pre>\n\n<p>try that, and if that wont work check your request String</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 7571239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZOIf.png?s=128&g=1", "display_name": "snikitin-de", "link": "https://stackoverflow.com/users/7571239/snikitin-de"}, "is_accepted": false, "score": 0, "last_activity_date": 1487357719, "creation_date": 1487357719, "answer_id": 42305432, "question_id": 42259646, "link": "https://stackoverflow.com/questions/42259646/a-table-loaded-with-a-database-in-the-datagridview-does-not-display-the-first-li/42305432#42305432", "title": "A table loaded with a database in the datagridview does not display the first line", "body": "<p>Everything is working. It was necessary to remove the cycle <code>reader.Read()</code>. Thanks for the help!</p>\n\n<pre><code>private void Request(string request)\n        {\n            try\n            {\n                SqlCommand command = new SqlCommand(request, connectionString);\n                command.ExecuteNonQuery();\n                SqlDataReader reader = command.ExecuteReader();\n\n                if (reader.HasRows == false)\n                {\n                     dataGridView1.Visible = false;\n                }\n                else\n                {\n                    dataGridView1.Visible = true;\n                    var dt = new DataTable();\n                    dt.Load(reader);\n\n                    dataGridView1.DataSource = dt;\n                }\n            }\n            catch (Exception e)\n            {\n                MessageBox.Show(e.Message.ToString(), e.Source.ToString());\n            }\n        }\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7571239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YZOIf.png?s=128&g=1", "display_name": "snikitin-de", "link": "https://stackoverflow.com/users/7571239/snikitin-de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487357719, "creation_date": 1487191388, "question_id": 42259646, "link": "https://stackoverflow.com/questions/42259646/a-table-loaded-with-a-database-in-the-datagridview-does-not-display-the-first-li", "title": "A table loaded with a database in the datagridview does not display the first line", "body": "<p>I load a table with a database in a DataGridView in this way. I have a datagridview displayed in all lines except the first. What is the problem?</p>\n\n<pre><code>            while (reader.Read())\n            {\n                if (reader.HasRows == false)\n                {\n                    dataGridView1.Visible = false;\n                }\n                else\n                {\n                    dataGridView1.Visible = true;\n                    DataTable dt = null;\n                    dt = new DataTable();\n                    dt.Load(reader);\n                    dataGridView1.DataSource = dt;\n\n                    if (reader.IsClosed == true)\n                    {\n                        break;\n                    }\n                }\n            }\n</code></pre>\n"}, {"tags": ["c#", "console-application", "oledb"], "comments": [{"owner": {"reputation": 46001, "user_id": 565968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/HumGf.png?s=128&g=1", "display_name": "frenchie", "link": "https://stackoverflow.com/users/565968/frenchie"}, "edited": false, "score": 0, "creation_date": 1487191487, "post_id": 42259610, "comment_id": 71677027, "body": "Just for style, I&#39;d breakdown your code so that each case calls a separate function, instead of having a lot of code in the same function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7217654"}, "reply_to_user": {"reputation": 46001, "user_id": 565968, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/HumGf.png?s=128&g=1", "display_name": "frenchie", "link": "https://stackoverflow.com/users/565968/frenchie"}, "edited": false, "score": 0, "creation_date": 1487191820, "post_id": 42259610, "comment_id": 71677206, "body": "Ok, will keep that in mind."}], "answers": [{"tags": [], "owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "is_accepted": true, "score": 1, "last_activity_date": 1487191424, "creation_date": 1487191424, "answer_id": 42259652, "question_id": 42259610, "link": "https://stackoverflow.com/questions/42259610/data-from-database-displays-multiple-times/42259652#42259652", "title": "Data from database displays multiple times", "body": "<p>The reason is that you are adding rows to the same <code>DataTable</code> again and again. You need to clear rows before each <code>select</code> statement.  Use <code>dt.Clear();</code></p>\n\n<pre><code>    con.Open();\n    OleDbDataReader dataReader = cmd.ExecuteReader();\n    dt.Clear();//HERE\n    while (dataReader.Read())\n    {\n        DataRow dr = dt.NewRow();\n        dr[\"ID\"] = dataReader[\"ID\"];\n        dr[\"Vards\"] = dataReader[\"Vards\"];\n        dr[\"Uzvards\"] = dataReader[\"Uzvards\"];\n        dt.Rows.Add(dr);\n    }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7217654"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 42259652, "answer_count": 1, "score": 0, "last_activity_date": 1487191424, "creation_date": 1487191235, "question_id": 42259610, "link": "https://stackoverflow.com/questions/42259610/data-from-database-displays-multiple-times", "title": "Data from database displays multiple times", "body": "<p>When im trying to view database data after updating something or deleting data, the program shows me that data multiple times. I dont know, it doesnt like refresh or what? i cant seem to find the problem, is it hidden somewhere in the output function?</p>\n\n<pre><code>namespace ConsoleApplication3\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            DataTable dt = new DataTable();\n            dt.Columns.Add(new DataColumn(\"ID\", typeof(int)));\n            dt.Columns.Add(new DataColumn(\"Vards\", typeof(string)));\n            dt.Columns.Add(new DataColumn(\"Uzvards\", typeof(string)));\n\n            string ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=dbs.accdb\";\n            OleDbConnection con = new OleDbConnection(ConnectionString);\n            int izvele;\n            do\n            {\n                Console.WriteLine(\"1 - Apskat\u012bt tabulas datus\");\n                Console.WriteLine(\"2 - Labot tabulas datus\");\n                Console.WriteLine(\"3 - Dz\u0113st tabulas datus\");\n                izvele = int.Parse(Console.ReadLine());\n                switch (izvele)\n                {\n                    case 1:\n                        OleDbCommand cmd = new OleDbCommand(\"SELECT * FROM PERSONA\", con);\n                        con.Open();\n                        OleDbDataReader dataReader = cmd.ExecuteReader();\n                        while (dataReader.Read())\n                        {\n                            DataRow dr = dt.NewRow();\n                            dr[\"ID\"] = dataReader[\"ID\"];\n                            dr[\"Vards\"] = dataReader[\"Vards\"];\n                            dr[\"Uzvards\"] = dataReader[\"Uzvards\"];\n                            dt.Rows.Add(dr);\n                        }\n                        con.Close();\n                        dt.AcceptChanges();\n                        PrintDataTable(dt);\n                        break;\n                    case 2:\n                        OleDbCommand upCmd = new OleDbCommand(\"UPDATE PERSONA SET Vards =?, Uzvards =? WHERE ID =? \", con);\n\n\n                        Console.Write(\"Ievadiet jauno v\u0101rdu: \");\n                        string jaunaisVards = Console.ReadLine();\n                        upCmd.Parameters.Add(new OleDbParameter(\"@Vards\", jaunaisVards));\n                        Console.Write(\"Ievadiet jauno uzv\u0101rdu: \");\n                        string jaunaisUzvards = Console.ReadLine();\n                        upCmd.Parameters.Add(new OleDbParameter(\"@Uzvards\", jaunaisUzvards));\n\n                        Console.Write(\"Kuru lauku v\u0113laties labot? \");\n                        int lauksID2 = int.Parse(Console.ReadLine());\n                        upCmd.Parameters.Add(new OleDbParameter(\"@ID\", lauksID2));\n                        Console.Write(\"Vai tie\u0161\u0101m v\u0113laties dz\u0113st \u0161o ierakstu?\");\n                        string atbilde2 = Console.ReadLine();\n\n                        if (atbilde2 == \"y\")\n                        {\n                            con.Open();\n                            upCmd.ExecuteNonQuery();\n                            con.Close();\n\n                        }\n                        else if (atbilde2 == \"n\")\n                        {\n                            Console.WriteLine(\"Ieraksts netika labots\");\n                            break;\n                        }\n\n\n\n                        break;\n\n                    case 3:\n                        OleDbCommand dCmd = new OleDbCommand(\"DELETE FROM PERSONA WHERE ID=?\", con);\n\n                        Console.Write(\"Kuru lauku v\u0113laties dz\u0113st? \");\n                        int lauksID = int.Parse(Console.ReadLine());\n                        dCmd.Parameters.Add(new OleDbParameter(\"@ID\", lauksID));\n\n                        Console.Write(\"Vai tie\u0161\u0101m v\u0113laties dz\u0113st \u0161o ierakstu?\");\n                        string atbilde = Console.ReadLine();\n                        if (atbilde == \"y\")\n                        {\n                            con.Open();\n                            dCmd.ExecuteNonQuery();\n                            con.Close();\n                        }\n                        else if (atbilde == \"n\")\n                        {\n                            Console.WriteLine(\"Ieraksts netika dz\u0113sts\");\n                            break;\n                        }\n\n                        break;\n\n                    default:\n                        break;\n                }\n\n            } while (izvele != 0);\n\n\n        }\n        static void PrintDataTable(DataTable dt)\n        {\n            foreach (DataColumn dc in dt.Columns)\n            {\n                Console.Write(dc.ColumnName + \"\\t\");\n            }\n            Console.WriteLine();\n            Console.WriteLine();\n            foreach (DataRow dr in dt.Rows)\n            {\n                for (int i = 0; i &lt; dr.ItemArray.Length; i++)\n                {\n                    Console.Write(dr[i] + \"\\t\");\n                }\n                Console.WriteLine();\n            }\n        }\n    }\n\n}\n</code></pre>\n\n<p>Im working with Access database and C# console application.\nIf there is some text that you need to understand then ask</p>\n"}, {"tags": ["c#", "xml", "xpath"], "comments": [{"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 0, "creation_date": 1487191512, "post_id": 42259600, "comment_id": 71677039, "body": "XPath filtering? <a href=\"https://msdn.microsoft.com/en-us/library/ms256086(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms256086(v=vs.110).aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "is_accepted": true, "score": 1, "last_activity_date": 1487193118, "creation_date": 1487193118, "answer_id": 42260144, "question_id": 42259600, "link": "https://stackoverflow.com/questions/42259600/loading-xmldocument-child-nodes-to-textboxes/42260144#42260144", "title": "Loading XMLDocument child nodes to textboxes?", "body": "<p>Given the sample you provided, something like this should work:</p>\n\n<pre><code>private static void LoadTextboxes()\n{\n    XmlDocument doc = new XmlDocument();\n    doc.Load(Application.StartupPath + @\"\\Saved.xml\");\n    txtFirstName.Text = doc.LastChild.SelectSingleNode(\"FirstName\").LastChild.Value; // get &lt;FirstName&gt;\n    txtLastName.Text = doc.LastChild.SelectSingleNode(\"LastName\").LastChild.Value; // get &lt;LastName&gt;   \n}\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 6759251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4516af29ac09405b280862ddaef86a48?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Weston", "link": "https://stackoverflow.com/users/6759251/michael-weston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 42260144, "answer_count": 1, "score": 0, "last_activity_date": 1487203740, "creation_date": 1487191203, "last_edit_date": 1487203740, "question_id": 42259600, "link": "https://stackoverflow.com/questions/42259600/loading-xmldocument-child-nodes-to-textboxes", "title": "Loading XMLDocument child nodes to textboxes?", "body": "<p>I want to load some XML child nodes into specific text boxes, but can only find examples of how to do it by creating an XMLNodeList of the XmlDocument child nodes, and iterating through them as a list and calling them by index. Is there a way to get specific child nodes in my XMLDocument by tag names?</p>\n\n<pre><code>//my xml file\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Textboxes&gt;\n    &lt;FirstName&gt;John&lt;/FirstName&gt;\n    &lt;LastName&gt;Smith&lt;/LastName&gt;\n&lt;/Textboxes&gt;\n\n    //c# method to load textboxes by child node names\n    private void LoadTextboxes()\n    {\n        XmlDocument doc = new XmlDocument();\n        doc.Load(Application.StartupPath + \"\\\\Saved.xml\");\n\n        txtFirstName.Text = doc.??? // get &lt;FirstName&gt;\n        txtLastName.Text = doc.??? // get &lt;LastName&gt;   \n    }\n</code></pre>\n"}, {"tags": ["c#", "wix", "custom-action"], "comments": [{"owner": {"reputation": 4192, "user_id": 5601267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FhwsUzLPxHs/AAAAAAAAAAI/AAAAAAAAADY/O6MbIjDJcYE/photo.jpg?sz=128", "display_name": "Brian Sutherland", "link": "https://stackoverflow.com/users/5601267/brian-sutherland"}, "edited": false, "score": 0, "creation_date": 1487193944, "post_id": 42259543, "comment_id": 71678342, "body": "I added an alternative option to my answer in case you read already it and didn&#39;t see the edit. The answer is kind of a mess sorry =]"}], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 6710253, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1d9bbff7be6bb8e577a34d24c12fd952?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6710253/bob"}, "edited": false, "score": 0, "creation_date": 1487255537, "post_id": 42259870, "comment_id": 71709811, "body": "This question actually stems from <a href=\"http://stackoverflow.com/questions/42256748/wix-removeregistrykey-element-not-behaving-as-advertised\">this</a> question.  What I originally planned to do was get the properties from UI and set the registry in the C# code itself.  However, I&#39;m unable to delete the registry that is created in the C# code during uninstallation (and I don&#39;t want to be the developer that leaves random crap all over the user&#39;s registry).  So I thought maybe I&#39;d set the registry back in WiX and just encrypt the properties in the Custom Action."}, {"owner": {"reputation": 217, "user_id": 6710253, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1d9bbff7be6bb8e577a34d24c12fd952?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6710253/bob"}, "edited": false, "score": 0, "creation_date": 1487255882, "post_id": 42259870, "comment_id": 71710063, "body": "With that said, the fact is I don&#39;t understand the sequencing of the installation process:  how to make some stuff happen before other stuff, etc.  Frankly, this ignorance makes your &quot;alternatively&quot; suggestion hard for me to parse, and your short explanation on the differences between immediate and deferred custom actions super-useful (thanks!).  So what I&#39;ll do is learn me some stuff, re-read your &quot;alternatively&quot; suggestion, and give it a shot."}, {"owner": {"reputation": 4192, "user_id": 5601267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FhwsUzLPxHs/AAAAAAAAAAI/AAAAAAAAADY/O6MbIjDJcYE/photo.jpg?sz=128", "display_name": "Brian Sutherland", "link": "https://stackoverflow.com/users/5601267/brian-sutherland"}, "reply_to_user": {"reputation": 217, "user_id": 6710253, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1d9bbff7be6bb8e577a34d24c12fd952?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6710253/bob"}, "edited": false, "score": 0, "creation_date": 1487258853, "post_id": 42259870, "comment_id": 71712403, "body": "@Bob A great tool you can use to understand the sequencing a bit more is Orca.exe from Microsoft. You can look at the InstallExecuteSequence table and order it by &quot;sequence&quot; and see the order all the action (custom and standard) will run. Immediate vs Deferred in the Execute sequence is a little weird because I <i>think</i> all the immediate ones run first then in the second pass the deferred ones run. That&#39;s why I put &quot;anywhere?&quot; as a valid sequencing since it should get run before any deferred actions anyways."}, {"owner": {"reputation": 4192, "user_id": 5601267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FhwsUzLPxHs/AAAAAAAAAAI/AAAAAAAAADY/O6MbIjDJcYE/photo.jpg?sz=128", "display_name": "Brian Sutherland", "link": "https://stackoverflow.com/users/5601267/brian-sutherland"}, "reply_to_user": {"reputation": 217, "user_id": 6710253, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1d9bbff7be6bb8e577a34d24c12fd952?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6710253/bob"}, "edited": false, "score": 0, "creation_date": 1487259057, "post_id": 42259870, "comment_id": 71712561, "body": "Also, you should be able to remove your created registry keys in a deferred custom action that is sequenced after &quot;RemoveRegistryValues&quot; and just make sure the condition is <code>NOT UPGRADINGPRODUCTCODE AND Remove~=&quot;ALL&quot;</code>"}, {"owner": {"reputation": 217, "user_id": 6710253, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1d9bbff7be6bb8e577a34d24c12fd952?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6710253/bob"}, "edited": false, "score": 0, "creation_date": 1487338937, "post_id": 42259870, "comment_id": 71753304, "body": "Let me ask you about your original suggestion.  What you&#39;re saying is that I might be able to do the encryption custom action in the InstallUISequence, right?  And then remove the key in the InstallExecuteSequence?  If that&#39;s the case, is the value     <code>EncodeAndSetValues</code> in the <code>Publish</code> element the Id of the Custom Action that would do the encoding?  Also, what does the &quot;1&quot; do in the <code>Publish</code> element?"}, {"owner": {"reputation": 4192, "user_id": 5601267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FhwsUzLPxHs/AAAAAAAAAAI/AAAAAAAAADY/O6MbIjDJcYE/photo.jpg?sz=128", "display_name": "Brian Sutherland", "link": "https://stackoverflow.com/users/5601267/brian-sutherland"}, "reply_to_user": {"reputation": 217, "user_id": 6710253, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1d9bbff7be6bb8e577a34d24c12fd952?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6710253/bob"}, "edited": false, "score": 0, "creation_date": 1487349076, "post_id": 42259870, "comment_id": 71760613, "body": "Yes the name of the custom action you want to run should be <code>Value</code> of the Publish event. The &quot;1&quot; is a conditional evaluation. Basically it means &quot;Always true&quot; so always do this when you click the button. <a href=\"https://www.firegiant.com/wix/tutorial/events-and-actions/control-your-controls/\" rel=\"nofollow noreferrer\">firegiant.com/wix/tutorial/events-and-actions/&hellip;</a> this may be quite useful for learning how do to actions from your UI. Should you handle incorrect values entered by the user? Blank values? Do you read these values  from the registry if they exist to remember what was entered before? Lots to consider."}], "tags": [], "owner": {"reputation": 4192, "user_id": 5601267, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FhwsUzLPxHs/AAAAAAAAAAI/AAAAAAAAADY/O6MbIjDJcYE/photo.jpg?sz=128", "display_name": "Brian Sutherland", "link": "https://stackoverflow.com/users/5601267/brian-sutherland"}, "is_accepted": false, "score": 0, "last_activity_date": 1487194398, "last_edit_date": 1495542299, "creation_date": 1487192139, "answer_id": 42259870, "question_id": 42259543, "link": "https://stackoverflow.com/questions/42259543/wix-how-to-import-export-data-into-c-custom-action/42259870#42259870", "title": "WiX how to import/export data into C# Custom Action?", "body": "<p>AFAIK you cannot alter property values once in the execute sequence. Someone can correct me if I'm wrong and that would be an alternative answer to your question.</p>\n\n<p>You should be able to encrypt the properties in the UI phase of the install. In your <code>immediate</code> custom action you can access the msi properties with <code>session[\"PROPERTYNAME\"]</code> as opposed to <code>session.CustomActionData[\"PROPERTYNAME\"]</code>. You can also set the properties: <code>session[\"PROPERTYNAME\"] = \"new value string\";</code>. </p>\n\n<p>Then on your Next/Install control on the page where the information is added you can put </p>\n\n<pre><code>&lt;Control Id=\"Install\" ...&gt;\n    &lt;Publish Event=\"DoAction\" Value=\"EncodeAndSetValuesAction\"&gt;1&lt;/Publish&gt;\n    ....\n&lt;/Control&gt;\n</code></pre>\n\n<p>If they are marked <code>Secure='yes'</code> and public (all caps name) then they should be usable in the execute phase of your installation with the encoded values.</p>\n\n<p>Do note that if you launch your custom action with a DoAction control event (clicking next on the page where the user enters the values) you won't be able to get logging information in the msi log. See <a href=\"https://stackoverflow.com/questions/3494101/wix-c-sharp-custom-action-logging-not-working\">here</a> for more info.</p>\n\n<p>Small edit: I was writing this answer when you edited the question which shows you already know how to get the properties and set them in an immediate action.</p>\n\n<p><strong>Alternatively</strong>, you may be able to just schedule an immediate custom action to encrypt and set the values in the InstallExecuteSequence before InstallInitialize (or before WriteRegistryValues or anywhere?) and it will set the properties before the elevated Server portion of the install starts. I think the InstallExecuteSequence happens in two parts. One where it does a pass figuring out values and which files to install making an install script for the elevated Server portion of the install where it actually copies the files around and writes registry keys ect. This part is still the client context where you can run immediate custom actions and read/set properties. Secondly it will start the Server portion of the install with set in stone properties and follow the execution script that was just created. </p>\n\n<p><HR/></p>\n\n<p>I decided to put a short simplified explanation about the differences between immediate and deferred custom actions here as well.</p>\n\n<p>There are basically two main differences between deferred and immediate custom action. Immediate custom actions can access the msi DB directly to read and/or modify properties but can't do anything that requires elevation unless the installer was run \"as administrator\" since it runs in the user's context.</p>\n\n<p>Deferred actions can only run in the execute sequence and can only read property values set explicitly through CustomActionData with the same name as the action but they always have elevated privileges. </p>\n"}], "owner": {"reputation": 217, "user_id": 6710253, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1d9bbff7be6bb8e577a34d24c12fd952?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6710253/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1320, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1487194398, "creation_date": 1487191021, "last_edit_date": 1487191877, "question_id": 42259543, "link": "https://stackoverflow.com/questions/42259543/wix-how-to-import-export-data-into-c-custom-action", "title": "WiX how to import/export data into C# Custom Action?", "body": "<p>I need to:</p>\n\n<ol>\n<li>get data from users (from a UI), and put that data into Properties</li>\n<li>import the Properties into some C# code using a Custom Action</li>\n<li>do some stuff to the Properties (encrypt the values), </li>\n<li>export the values <em>back</em> to WiX, where I will</li>\n<li>create a registry key and put the encrypted values into them</li>\n</ol>\n\n<p>I can accomplish everything on that list except for #4.  That is, I can't seem to import <strong><em>and</em></strong> export values into the C# code.  I think the problem is in the timing.</p>\n\n<p>Here's an example of a Custom Action that is used to import some properties into some C# code:</p>\n\n<pre><code>  &lt;Property Id=\"VALUE\" Value=\"value\"/&gt;\n  &lt;SetProperty Id=\"CustomAction_PassProperty\"\n               Value=\"VALUE=[VALUE]\"\n               Sequence=\"execute\"\n               Before=\"CustomAction_PassProperty\"/&gt; \n\n  &lt;Binary Id=\"Binary_PassProps\"\n          SourceFile=\"$(var.CreateRegistryKey.TargetDir)CreateRegistryKey.CA.dll\"/&gt;\n\n  &lt;!-- Note that 'Impersonate=\"no\"' elevates the privilege of the C# code, needed to create keys --&gt;\n  &lt;CustomAction Id=\"CustomAction_PassProperty\"\n                BinaryKey=\"Binary_PassProps\"\n                DllEntry=\"CreateKeys\"\n                Execute=\"deferred\"\n                Impersonate=\"no\"\n                Return=\"check\" \n                HideTarget=\"yes\"/&gt;\n\n  &lt;InstallExecuteSequence&gt;\n      &lt;Custom Action=\"CustomAction_PassProperty\"\n              After=\"InstallInitialize\"/&gt;\n  &lt;/InstallExecuteSequence&gt;\n</code></pre>\n\n<p>Notice that the action is done after <em>InstallInitialize</em>.</p>\n\n<p>Next, how to take the imported properties and convert them into variables in the C# code:</p>\n\n<pre><code>    [CustomAction]\n    public static ActionResult CreateKeys(Session session)\n    {\n        string value = session.CustomActionData[\"VALUE\"];\n        return ActionResult.Success;\n    }\n</code></pre>\n\n<p>Next, here's an example of how to export variables in C# code back into WiX, as properties:</p>\n\n<pre><code>&lt;Binary Id=\"Binary_CustomActionTemplate\" \n        SourceFile=\"$(var.CustomAction.TargetDir)CustomAction.CA.dll\"/&gt;\n\n&lt;CustomAction Id=\"CustomAction_CustomActionTemplate\" \n              BinaryKey=\"Binary_CustomActionTemplate\" \n              DllEntry=\"CustomActionTemplate\" \n              Execute=\"immediate\" \n              Return=\"check\"/&gt;\n\n&lt;InstallUISequence&gt;\n    &lt;Custom Action=\"CustomAction_CustomActionTemplate\" After=\"LaunchConditions\"/&gt;\n&lt;/InstallUISequence&gt;\n</code></pre>\n\n<p>And this time the action is done after <em>LaunchConditions</em>.</p>\n\n<p>Finally, how to create a Property, give it a value, and send it back to WiX in C#:</p>\n\n<pre><code>    [CustomAction]\n    public static ActionResult CreateKeys(Session session)\n    {\n        session[\"VALUE\"] = \"Hello, world.\";\n        return ActionResult.Success;\n    }\n</code></pre>\n\n<p>I think the problem lies in when -- that is, when during the installation sequence -- that I do both things (import and export), but I'm not sure.  That is, I need to import the data into the C# code, do stuff in the C# code, <strong><em>then</em></strong> export data from C# code.  <em>But how?!?</em> (<em>waves hands dramatically at sky</em>) </p>\n\n<p>To sum up:  how to import and export data into C# Custom Action in WiX (using the same C# code)?</p>\n"}, {"tags": ["c#", ".net", "thread-safety"], "comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 2, "creation_date": 1487191093, "post_id": 42259505, "comment_id": 71676822, "body": "I don&#39;t understand this version of your question. Singletons are not themselves inherently thread-safe. Only the <i>property</i> that returns the singleton instance is, using the normal, thread-safe patterns for singleton. The code above is neither a singleton (per our discussion in your previous question...there&#39;s nothing to stop someone from calling <code>new Logger()</code> directly), nor does it magically make the <code>Logger</code> class itself thread-safe (even though the <code>Log.Logger</code> property is)."}, {"owner": {"reputation": 32231, "user_id": 1033686, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/KsvGz.jpg?s=128&g=1", "display_name": "Matthew Layton", "link": "https://stackoverflow.com/users/1033686/matthew-layton"}, "edited": false, "score": 0, "creation_date": 1487191168, "post_id": 42259505, "comment_id": 71676871, "body": "Jon Skeet (StackOverflow&#39;s numero uno) has extensively covered the Singleton pattern, if this is any help? <a href=\"http://csharpindepth.com/Articles/General/Singleton.aspx\" rel=\"nofollow noreferrer\">csharpindepth.com/Articles/General/Singleton.aspx</a>"}, {"owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487192402, "post_id": 42259505, "comment_id": 71677511, "body": "@PeterDuniho They can call <code>new Logger()</code> even though it is <code>internal</code> and in an assembly they cannot modify?  I guess I don&#39;t understand <code>internal</code> then :("}, {"owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487192550, "post_id": 42259505, "comment_id": 71677584, "body": "@PeterDuniho - I am only looking for the <code>Log.Logger</code> to be thread safe.  As you said, I will have to (and plan on) dealing with the thread safety of the <code>Logger</code> class myself."}, {"owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "reply_to_user": {"reputation": 32231, "user_id": 1033686, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/KsvGz.jpg?s=128&g=1", "display_name": "Matthew Layton", "link": "https://stackoverflow.com/users/1033686/matthew-layton"}, "edited": false, "score": 0, "creation_date": 1487192642, "post_id": 42259505, "comment_id": 71677653, "body": "@series0ne -  Believe it or not, but I based this on that.  Here is the question that got me here: <a href=\"http://stackoverflow.com/questions/42258375/simpler-singleton-based-on-jon-skeets-singleton\" title=\"simpler singleton based on jon skeets singleton\">stackoverflow.com/questions/42258375/&hellip;</a>"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 2, "creation_date": 1487200192, "post_id": 42259505, "comment_id": 71681268, "body": "<i>&quot;They can call new Logger() even though it is internal&quot;</i> -- a true singleton, cannot be created by <i>any</i> other class, even those in the same assembly. Use of <code>internal</code> can give you some singleton-like protection against outside code, but it&#39;s not really making the type a singleton."}, {"owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487208290, "post_id": 42259505, "comment_id": 71683725, "body": "@PeterDuniho - fair enough.  I agree that in it does not fit the definition of a Singleton."}], "owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487190929, "creation_date": 1487190929, "question_id": 42259505, "link": "https://stackoverflow.com/questions/42259505/implementing-a-singleton-like-feature-using-internal", "title": "Implementing a &quot;Singleton&quot; like feature using internal", "body": "<p>I am creating a NuGet package for my company that will surface a logger for applications to use.</p>\n\n<p>I want my logger to function similar to a Singleton (only one instance and thread safe).</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>public sealed class Log\n{\n    public static ILogger Logger { get; } = new Logger();\n}\n\ninternal sealed class Logger: ILogger\n{\n     // Do Stuff Here\n}\n</code></pre>\n\n<p>The classes will be in my NuGet assembly, so the consumers will not be able to modify them.</p>\n\n<p><strong>So if someone calls <code>Log.Logger</code> is it thread safe?  And single instance?</strong></p>\n"}, {"tags": ["c#", ".net", "asp.net-mvc", "razor", "casting"], "comments": [{"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "edited": false, "score": 1, "creation_date": 1487191403, "post_id": 42259494, "comment_id": 71676988, "body": "try casting as bool.  @if((bool)Model.Point.Store.JsonDynamic.En.Motel.ParkingLot == True){...}"}], "answers": [{"comments": [{"owner": {"reputation": 709, "user_id": 3379586, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0b42bad0ce56a144a5b74a9278f8802b?s=128&d=identicon&r=PG&f=1", "display_name": "Tumen_t", "link": "https://stackoverflow.com/users/3379586/tumen-t"}, "edited": false, "score": 0, "creation_date": 1487191442, "post_id": 42259613, "comment_id": 71677009, "body": "Yeah, cast should fix it."}, {"owner": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "edited": false, "score": 0, "creation_date": 1487191587, "post_id": 42259613, "comment_id": 71677079, "body": "Hello. Thank you for the answer. That sounds like a solution. When I tried the to run the code, I got this error: <code>RazorEngine.Templating.TenokateCompilationException: Errors while compiling a Template. Please try the following to solve the situation: If the problem is about missing&#47;invalid references or multiple defines either try to load the missing references manually</code>"}, {"owner": {"reputation": 709, "user_id": 3379586, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0b42bad0ce56a144a5b74a9278f8802b?s=128&d=identicon&r=PG&f=1", "display_name": "Tumen_t", "link": "https://stackoverflow.com/users/3379586/tumen-t"}, "reply_to_user": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "edited": false, "score": 0, "creation_date": 1487192079, "post_id": 42259613, "comment_id": 71677338, "body": "Looks like this error is not related. Can you try again after closing Visual Studio and then loading all the references?"}, {"owner": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "edited": false, "score": 0, "creation_date": 1487192585, "post_id": 42259613, "comment_id": 71677608, "body": "Tried that now. When I delete that if statement, everything is running fine. I checked the JSON object, and that path is also correct."}, {"owner": {"reputation": 709, "user_id": 3379586, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0b42bad0ce56a144a5b74a9278f8802b?s=128&d=identicon&r=PG&f=1", "display_name": "Tumen_t", "link": "https://stackoverflow.com/users/3379586/tumen-t"}, "reply_to_user": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "edited": false, "score": 0, "creation_date": 1487192765, "post_id": 42259613, "comment_id": 71677722, "body": "Try without the <code>()</code>. <code>@if((bool)Model.Point.Store.JsonDynamic.En.Motel.ParkingLot == True)      {          &lt;span&gt;Possibility for parking&lt;&#47;span&gt;&lt;br&gt;      }</code>"}, {"owner": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "edited": false, "score": 0, "creation_date": 1487193182, "post_id": 42259613, "comment_id": 71677947, "body": "It is the same. There must be something else then. But I just tested the code again, and it is running fine, except the if statement."}, {"owner": {"reputation": 709, "user_id": 3379586, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0b42bad0ce56a144a5b74a9278f8802b?s=128&d=identicon&r=PG&f=1", "display_name": "Tumen_t", "link": "https://stackoverflow.com/users/3379586/tumen-t"}, "reply_to_user": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "edited": false, "score": 0, "creation_date": 1487193354, "post_id": 42259613, "comment_id": 71678050, "body": "How about just <code>@if(True) { &lt;span&gt;Possibility for parking&lt;&#47;span&gt;&lt;br&gt; }</code>? If this works, then something wrong with <code>Model.Point.Store.JsonDynamic.En.Motel.ParkingLot</code>."}, {"owner": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "edited": false, "score": 0, "creation_date": 1487193365, "post_id": 42259613, "comment_id": 71678060, "body": "Shoot. I found the error. I was missing an else statement afterwords :-)"}], "tags": [], "owner": {"reputation": 709, "user_id": 3379586, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0b42bad0ce56a144a5b74a9278f8802b?s=128&d=identicon&r=PG&f=1", "display_name": "Tumen_t", "link": "https://stackoverflow.com/users/3379586/tumen-t"}, "is_accepted": true, "score": 2, "last_activity_date": 1487191249, "creation_date": 1487191249, "answer_id": 42259613, "question_id": 42259494, "link": "https://stackoverflow.com/questions/42259494/if-statement-fails-when-true/42259613#42259613", "title": "if statement fails when true", "body": "<p>Try this</p>\n\n<pre><code>&lt;th class=\"small-12 large-6 columns last\"&gt;\n        &lt;table&gt;\n            &lt;tr&gt;\n                &lt;th width=\"300\"&gt;\n                    &lt;p class=\"text-left small-text-left\"&gt;\n                       @(if((bool)Model.Point.Store.JsonDynamic.En.Motel.ParkingLot == True){&lt;span&gt;Possibility for parking&lt;/span&gt;&lt;br&gt;})\n                    &lt;/p&gt;\n                &lt;/th&gt;\n                &lt;th class=\"expander\"&gt;&lt;/th&gt;\n            &lt;/tr&gt;\n        &lt;/table&gt;\n    &lt;/th&gt;\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 7519137, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a34d6db6cf708292cc25defddf930688?s=128&d=identicon&r=PG&f=1", "display_name": "Mimi", "link": "https://stackoverflow.com/users/7519137/mimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 42259613, "answer_count": 1, "score": 1, "last_activity_date": 1487198957, "creation_date": 1487190876, "last_edit_date": 1487198957, "question_id": 42259494, "link": "https://stackoverflow.com/questions/42259494/if-statement-fails-when-true", "title": "if statement fails when true", "body": "<p>This piece of code is failing when I build my project. THe if statement has to check if ParkingLot is true. I thought the way to do that was the following code:</p>\n\n<pre><code>    &lt;th class=\"small-12 large-6 columns last\"&gt;\n        &lt;table&gt;\n            &lt;tr&gt;\n                &lt;th width=\"300\"&gt;\n                    &lt;p class=\"text-left small-text-left\"&gt;\n                        @if(Model.Point.Store.JsonDynamic.En.Motel.ParkingLot == True)\n                        {\n                            &lt;span&gt;Possibility for parking&lt;/span&gt;&lt;br&gt;\n                        }\n                    &lt;/p&gt;\n                &lt;/th&gt;\n                &lt;th class=\"expander\"&gt;&lt;/th&gt;\n            &lt;/tr&gt;\n        &lt;/table&gt;\n    &lt;/th&gt;\n</code></pre>\n\n<p>But I get this error:</p>\n\n<blockquote>\n  <p>Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: Cannot\n  implicitly convert type ''Newtonsoft.Json.Linq.JValue'' to ''bool''.\n  An explicit conversion exists (are you missing a cast?)</p>\n</blockquote>\n\n<p>Can anybody see what I am doing wrong here?</p>\n"}, {"tags": ["c#", "xamarin", "linker"], "comments": [{"owner": {"reputation": 12591, "user_id": 1048571, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/CGpWF.png?s=128&g=1", "display_name": "Jon Douglas", "link": "https://stackoverflow.com/users/1048571/jon-douglas"}, "edited": false, "score": 0, "creation_date": 1487191742, "post_id": 42259479, "comment_id": 71677167, "body": "Have you tried to specify a custom link description? <a href=\"https://developer.xamarin.com/guides/cross-platform/advanced/custom_linking/\" rel=\"nofollow noreferrer\">developer.xamarin.com/guides/cross-platform/advanced/&hellip;</a>"}, {"owner": {"reputation": 26311, "user_id": 246568, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6a62c6e7acd47259151ba488eb6a17e3?s=128&d=identicon&r=PG", "display_name": "William Jockusch", "link": "https://stackoverflow.com/users/246568/william-jockusch"}, "reply_to_user": {"reputation": 12591, "user_id": 1048571, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/CGpWF.png?s=128&g=1", "display_name": "Jon Douglas", "link": "https://stackoverflow.com/users/1048571/jon-douglas"}, "edited": false, "score": 0, "creation_date": 1487191816, "post_id": 42259479, "comment_id": 71677204, "body": "No, I may have to go there, but I want to understand what is happening first."}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1487194360, "post_id": 42259479, "comment_id": 71678559, "body": "The linker is quite simple (and powerful) in design, I written custom steps to handle Json serialization, cross-assembly class/member removal, etc... Looking at the code and/or running it on test cases might help you: <a href=\"https://github.com/mono/linker/tree/master/linker\" rel=\"nofollow noreferrer\">github.com/mono/linker/tree/master/linker</a>"}], "answers": [{"tags": [], "owner": {"reputation": 26311, "user_id": 246568, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6a62c6e7acd47259151ba488eb6a17e3?s=128&d=identicon&r=PG", "display_name": "William Jockusch", "link": "https://stackoverflow.com/users/246568/william-jockusch"}, "is_accepted": false, "score": 0, "last_activity_date": 1487259621, "last_edit_date": 1487259621, "creation_date": 1487228142, "answer_id": 42266946, "question_id": 42259479, "link": "https://stackoverflow.com/questions/42259479/xamarin-linker-removing-all-constructors-but-preserving-instance-methods/42266946#42266946", "title": "Xamarin linker removing all constructors but preserving instance methods?", "body": "<p>At least in my case, calling any static method on a type leads to preservation of lots of instance members. I literally tried this:</p>\n\n<pre><code>public class MyType() {\n  public static bool DummyBool() {\n    return true;\n  }\n  // instance members here\n}\n</code></pre>\n\n<p>Once the type was getting removed by the linker, I put in a call to MyType.DummyBool(). This led to a lot of instance members being preserved.</p>\n\n<p>This may not be the case for everyone. But it was the case for me.</p>\n\n<p>Another insidious thing to watch out for is that if a static class has any properties that are initialized on startup, and the class as a whole is preserved, then those properties are preserved, even if they are never called:</p>\n\n<pre><code>public static class StaticClass {\n  public static Foo FooProperty {get;} = new Foo(); // if any code that is not removed calls StaticClass.SomeString, then Foo will be preserved.\n  public static string SomeString {\n    get {\n      return \"Hello\";\n    }\n  }\n}\n</code></pre>\n\n<p>I am also seeing at least one case where code in a class that is removed by the linker nonetheless causes another class not to be removed. I assume this is a bug; however, my example is rather involved, and my attempts to get a simple repro have failed.</p>\n"}, {"comments": [{"owner": {"reputation": 26311, "user_id": 246568, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6a62c6e7acd47259151ba488eb6a17e3?s=128&d=identicon&r=PG", "display_name": "William Jockusch", "link": "https://stackoverflow.com/users/246568/william-jockusch"}, "edited": false, "score": 0, "creation_date": 1487264827, "post_id": 42278569, "comment_id": 71717298, "body": "My problem is the opposite -- code I want to remove is being kept."}], "tags": [], "owner": {"reputation": 357, "user_id": 3798724, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8000b798e8a21cbe2507167003eea90d?s=128&d=identicon&r=PG", "display_name": "aufty", "link": "https://stackoverflow.com/users/3798724/aufty"}, "is_accepted": false, "score": 0, "last_activity_date": 1487260059, "creation_date": 1487260059, "answer_id": 42278569, "question_id": 42259479, "link": "https://stackoverflow.com/questions/42259479/xamarin-linker-removing-all-constructors-but-preserving-instance-methods/42278569#42278569", "title": "Xamarin linker removing all constructors but preserving instance methods?", "body": "<p>Have you tried using the Preserve attribute? The linker will not \"optimize\" code decorated with it:</p>\n\n<pre><code>[Xamarin.iOS.Foundation.Preserve]\n</code></pre>\n\n<p>For more information see the Xamarin documentation <a href=\"https://developer.xamarin.com/guides/ios/advanced_topics/linker/\" rel=\"nofollow noreferrer\">here</a> </p>\n"}], "owner": {"reputation": 26311, "user_id": 246568, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6a62c6e7acd47259151ba488eb6a17e3?s=128&d=identicon&r=PG", "display_name": "William Jockusch", "link": "https://stackoverflow.com/users/246568/william-jockusch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1487260059, "creation_date": 1487190812, "last_edit_date": 1487191170, "question_id": 42259479, "link": "https://stackoverflow.com/questions/42259479/xamarin-linker-removing-all-constructors-but-preserving-instance-methods", "title": "Xamarin linker removing all constructors but preserving instance methods?", "body": "<p>First, a general note, what Xamarin calls their \"linker\" is actually more of a \"dead code remover\". It is supposed to prevent uncallable code from making it into the compiled app.</p>\n\n<p>I have a type in my app. When I use reflection to get its constructors, I see zero constructors:</p>\n\n<pre><code>private static int GetConstructorCount(Type type) {\n  ConstructorInfo[] constructors = type.GetConstructors();\n  return constructors.Count();\n}\n</code></pre>\n\n<p>Yet when I use reflection to see its instance members, I see many:</p>\n\n<pre><code>private static void LogMemberInfo(Type type) {\n  int constructorCount = GetConstructorCount(type);\n  MyLoggingMethod(constructorCount, \"Constructors\");\n  MemberInfo[] members = type.GetMembers();\n  List&lt;string&gt; willLog = new List&lt;string&gt;();\n  foreach(MemberInfo member in members) {\n    if (member.DeclaringType == type) {\n      willLog.Add(member.Name);\n    } \n  }\n  willLog.Sort();\n  foreach (string str in willLog) {\n    MyLoggingMethod.LogLine(str);\n  }\n}\n</code></pre>\n\n<p>Output from the above is:</p>\n\n<pre><code>0 Constructors\nlots of surviving members, including instance members\n</code></pre>\n\n<p>This is a problem, because the type is a gateway to a whole lot of other types. I was hoping that by getting rid of all the constructors, all the instance members would disappear. They don't.</p>\n\n<p>Is this a bug in the linker? Or is there a reason why it might still not want to get rid of instance members?</p>\n\n<p>I do access members of the type via casting. Perhaps this is the problem?</p>\n\n<pre><code>public class MySuperclass {\n   public static MySuperclass Instance {get; set;}\n}\n\npublic MyClass: MySuperclass {\n  public static SomeMethod() {\n     MySuperclass object = MySuperclass.Instance;\n     MyClass castObject = object as MyClass; // castObject will always be null, as no constructors survived the linking process. But maybe the linker doesn't realize that?\n     if (castObject!=null) {\n        castObject.InstanceMethod();\n     }\n  }\n}\n</code></pre>\n\n<p>UPDATE: Getting rid of all the casts did not solve the problem. I am calling virtual members of superclass objects in lots of places; that's my next guess, but if that's the problem, fixing will be messy.</p>\n"}, {"tags": ["c#", "service", "windows-services"], "comments": [{"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 2, "creation_date": 1487190804, "post_id": 42259438, "comment_id": 71676642, "body": "What&#39;s adding rows to MyQueue? Can you not also have it alert your service?"}], "answers": [{"tags": [], "owner": {"reputation": 1271, "user_id": 5258504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc5ae8187e9453941ac7ea95a82d5fbf?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek Abo ELkheir", "link": "https://stackoverflow.com/users/5258504/tarek-abo-elkheir"}, "is_accepted": false, "score": 0, "last_activity_date": 1487191180, "creation_date": 1487191180, "answer_id": 42259589, "question_id": 42259438, "link": "https://stackoverflow.com/questions/42259438/high-cpu-when-windows-service-queue-is-stored-in-a-database/42259589#42259589", "title": "High CPU when Windows service queue is stored in a database", "body": "<p>You could use SqlTableDependency</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5243440, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E4rvCw4pgWQ/AAAAAAAAAAI/AAAAAAAAAPE/6q7-v2aKhKg/photo.jpg?sz=128", "display_name": "Muhammad Saqib", "link": "https://stackoverflow.com/users/5243440/muhammad-saqib"}, "is_accepted": false, "score": 0, "last_activity_date": 1487664217, "creation_date": 1487664217, "answer_id": 42361725, "question_id": 42259438, "link": "https://stackoverflow.com/questions/42259438/high-cpu-when-windows-service-queue-is-stored-in-a-database/42361725#42361725", "title": "High CPU when Windows service queue is stored in a database", "body": "<p>You can control the cpu usage by adding some sleep (as per work load) in the current thread when no data found in Queue.</p>\n\n<pre><code>while(true)\n {\n    // get the first row from MyQueue that is not yet marked\n    if(MyQueue.Count == 0)\n    {\n       System.Threading.Thread.Sleep(TimeSpan.FromMilliseconds(1000));\n          continue;\n    }\n\n     // complete the task from the row\n\n      // mark the row as completed\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 4029947, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u041e\u043b\u0435\u0433 \u0412\u043e\u043b\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/4029947/%d0%9e%d0%bb%d0%b5%d0%b3-%d0%92%d0%be%d0%bb%d0%ba%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1487664217, "creation_date": 1487190658, "last_edit_date": 1487207561, "question_id": 42259438, "link": "https://stackoverflow.com/questions/42259438/high-cpu-when-windows-service-queue-is-stored-in-a-database", "title": "High CPU when Windows service queue is stored in a database", "body": "<p>I have implemented a Windows service with a queue that is stored in a database table.</p>\n\n<p>I have a table called <code>MyQueue</code> and each row of this table specifies a task for the Windows Service. When the task is completed the row is marked with a special flag which means that this task has been completed.</p>\n\n<p>My Windows service works in the following way:</p>\n\n<pre><code>while(true)\n{\n     // get the first row from MyQueue that is not yet marked\n\n     // complete the task from the row\n\n     // mark the row as completed\n}\n</code></pre>\n\n<p>This design works, but as I use <code>while(true)</code> it continuously sends requests to the database to check if there are any new rows and this causes CPU usage to rise higher than 60%.</p>\n\n<p>Is there a more effective way to implement a queue stored in a database table?</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "asp.net-mvc-4", "asp.net-identity"], "comments": [{"owner": {"reputation": 4376, "user_id": 3380837, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/eN16u.png?s=128&g=1", "display_name": "kat1330", "link": "https://stackoverflow.com/users/3380837/kat1330"}, "edited": false, "score": 0, "creation_date": 1487190853, "post_id": 42259372, "comment_id": 71676665, "body": "What happened if you specifically query for the same user by his username instead using newly created <code>user</code>?"}, {"owner": {"reputation": 389, "user_id": 2758359, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d76bb18b109dfe5484c38fa23b7aca5f?s=128&d=identicon&r=PG&f=1", "display_name": "Teamol", "link": "https://stackoverflow.com/users/2758359/teamol"}, "reply_to_user": {"reputation": 4376, "user_id": 3380837, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/eN16u.png?s=128&g=1", "display_name": "kat1330", "link": "https://stackoverflow.com/users/3380837/kat1330"}, "edited": false, "score": 0, "creation_date": 1487191074, "post_id": 42259372, "comment_id": 71676810, "body": "I&#39;ve implemented that just now, this is happening uniquely so I cannot simulate it. Don&#39;t know, waiting for the log."}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 2758359, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d76bb18b109dfe5484c38fa23b7aca5f?s=128&d=identicon&r=PG&f=1", "display_name": "Teamol", "link": "https://stackoverflow.com/users/2758359/teamol"}, "edited": false, "score": 0, "creation_date": 1487192575, "post_id": 42259930, "comment_id": 71677600, "body": "Hi thank you for your answer. I understand that I can do workarround like so but I would like to understand how is that possible."}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "reply_to_user": {"reputation": 389, "user_id": 2758359, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d76bb18b109dfe5484c38fa23b7aca5f?s=128&d=identicon&r=PG&f=1", "display_name": "Teamol", "link": "https://stackoverflow.com/users/2758359/teamol"}, "edited": false, "score": 1, "creation_date": 1487193836, "post_id": 42259930, "comment_id": 71678290, "body": "@Teamol, At this stage in the life of that framework I can only assume that it was a bug in that version. Possible it could be associated with the async implementation. Would have to take a look at the source code for that version. Found an issue about create async calling in the wrong order <a href=\"https://aspnetidentity.codeplex.com/workitem/2518\" rel=\"nofollow noreferrer\">aspnetidentity.codeplex.com/workitem/2518</a>"}], "tags": [], "owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "is_accepted": false, "score": 1, "last_activity_date": 1487192695, "last_edit_date": 1487192695, "creation_date": 1487192355, "answer_id": 42259930, "question_id": 42259372, "link": "https://stackoverflow.com/questions/42259372/mvc-5-asp-net-identity-createasync-invalid-user-id/42259930#42259930", "title": "MVC 5 ASP.NET Identity - CreateAsync invalid user id", "body": "<p>I would suggest calling back the user by an identifier after create was successful to make sure the properties match up.</p>\n\n<pre><code>//...other code removed for brevity\n\nvar user = new User { UserName = model.Email, Email = model.Email, RegisterDate = DateTime.Now };\nvar result = await UserManager.CreateAsync(user, model.Password);\nif (result.Succeeded)\n{\n    //pick one\n    //user = await UserManager.FindById(user.Id);\n    //user = await UserManager.FindByName(user.UserName);\n    user = await UserManager.FindByEmailAsync(user.Email);\n\n    // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=320771\n    await SendConfirmationEmail(user);\n\n    return View(\"ConfirmationEmailSent\");\n}\nAddErrors(result);\n</code></pre>\n\n<p>//...other code removed for brevity</p>\n"}, {"tags": [], "owner": {"reputation": 4376, "user_id": 3380837, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/eN16u.png?s=128&g=1", "display_name": "kat1330", "link": "https://stackoverflow.com/users/3380837/kat1330"}, "is_accepted": false, "score": 0, "last_activity_date": 1487194660, "creation_date": 1487194660, "answer_id": 42260550, "question_id": 42259372, "link": "https://stackoverflow.com/questions/42259372/mvc-5-asp-net-identity-createasync-invalid-user-id/42260550#42260550", "title": "MVC 5 ASP.NET Identity - CreateAsync invalid user id", "body": "<p>I am also suspect that issue is related to <code>UserManager.CreateAsync()</code> method. You are using correctly. I will rather use manually generated user id instead generated by <code>UserManager</code>. </p>\n\n<p>In your case will be:</p>\n\n<pre><code>    var user = new User { UserName = model.Email, Email = model.Email, RegisterDate = DateTime.Now };\n    user.Id = Guid.NewGuid().ToString();\n    var result = await UserManager.CreateAsync(user, model.Password);\n    if (result.Succeeded)\n    {             \n         await SendConfirmationEmail(user);\n\n         return View(\"ConfirmationEmailSent\");\n    } \n</code></pre>\n"}], "owner": {"reputation": 389, "user_id": 2758359, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d76bb18b109dfe5484c38fa23b7aca5f?s=128&d=identicon&r=PG&f=1", "display_name": "Teamol", "link": "https://stackoverflow.com/users/2758359/teamol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1667, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1487194660, "creation_date": 1487190454, "last_edit_date": 1487190747, "question_id": 42259372, "link": "https://stackoverflow.com/questions/42259372/mvc-5-asp-net-identity-createasync-invalid-user-id", "title": "MVC 5 ASP.NET Identity - CreateAsync invalid user id", "body": "<p>I have two websites using one database, I use asp.net identity (2.2.1.40403) and I have a problem I can't understand. Now, this is a third time this happened and I have no idea where the problem can be.</p>\n\n<p>I have a register and send email method like this</p>\n\n<pre><code>[HttpPost]\n[AllowAnonymous]\n[ValidateAntiForgeryToken]\npublic async Task&lt;ActionResult&gt; Register(RegisterViewModel model)\n{\n    if (ModelState.IsValid)\n    {\n        var user = new User { UserName = model.Email, Email = model.Email, RegisterDate = DateTime.Now };\n        var result = await UserManager.CreateAsync(user, model.Password);\n        if (result.Succeeded)\n        {\n            //await SignInManager.SignInAsync(user, isPersistent: false, rememberBrowser: false);\n\n            // For more information on how to enable account confirmation and password reset please visit http://go.microsoft.com/fwlink/?LinkID=320771\n            await SendConfirmationEmail(user);\n\n            return View(\"ConfirmationEmailSent\");\n        }\n        AddErrors(result);\n    }\n\n    // If we got this far, something failed, redisplay form\n    return View(model);\n}\n\nprivate async Task SendConfirmationEmail(Dal.Models.User user)\n{\n    // Send an email with this link\n    string code = await UserManager.GenerateEmailConfirmationTokenAsync(user.Id);\n\n    var callbackUrl = Url.Action(\"ConfirmEmail\", \"Account\", new { userId = user.Id, code = code }, protocol: Request.Url.Scheme);\n    await UserManager.SendEmailAsync(user.Id, \"Potvrzen\u00ed Va\u0161eho \u00fa\u010dtu\", \"Pros\u00edm potvr\u010fte svou emailovou adresu kliknut\u00edm &lt;a href=\\\"\" + callbackUrl + \"\\\"&gt;zde&lt;/a&gt;.\");\n}\n</code></pre>\n\n<p>What happened is  that when user registered he received URL when userId was set to <code>3d847c51-7217-49fe-ae9d-d8e46e291559</code>, but in database the user was created with <code>95789d6e-b66e-4c9e-8ee4-fe384b82e838</code>. I don't understand how this can happen. By the way there is no user in database with Id <code>3d847c51-7217-49fe-ae9d-d8e46e291559</code>. Do you have any idea why and how this can happen?</p>\n"}, {"tags": ["c#", "xamarin.ios", "apple-push-notifications", "azure-mobile-services", "azure-notificationhub"], "comments": [{"owner": {"reputation": 6171, "user_id": 182371, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/MFcMS.jpg?s=128&g=1", "display_name": "Nikita G.", "link": "https://stackoverflow.com/users/182371/nikita-g"}, "edited": false, "score": 1, "creation_date": 1487192648, "post_id": 42259287, "comment_id": 71677659, "body": "Could you temporarily paste (here in the comments) your namespace name and time interval when this happened? I&#39;m on the product team, it will help investigate."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6190395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb4cb23663f7e8c602fd86db551496e?s=128&d=identicon&r=PG&f=1", "display_name": "Sohrab", "link": "https://stackoverflow.com/users/6190395/sohrab"}, "is_accepted": false, "score": 1, "last_activity_date": 1487205386, "creation_date": 1487205386, "answer_id": 42262732, "question_id": 42259287, "link": "https://stackoverflow.com/questions/42259287/send-push-notification-from-a-device-via-azure-notificationhub-rest-api/42262732#42262732", "title": "Send Push Notification from a device via Azure NotificationHub REST Api", "body": "<p>The Api Version 2014-09-01 is not correct. Please use 2016-07 as the Api version and you should be good. </p>\n\n<p>Thanks</p>\n\n<p>Sohrab</p>\n"}, {"tags": [], "owner": {"reputation": 1454, "user_id": 914405, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2cdc562712df2362811fa3702b67893?s=128&d=identicon&r=PG", "display_name": "Dmitry Samuylov", "link": "https://stackoverflow.com/users/914405/dmitry-samuylov"}, "is_accepted": true, "score": 0, "last_activity_date": 1487253800, "creation_date": 1487253800, "answer_id": 42276153, "question_id": 42259287, "link": "https://stackoverflow.com/questions/42259287/send-push-notification-from-a-device-via-azure-notificationhub-rest-api/42276153#42276153", "title": "Send Push Notification from a device via Azure NotificationHub REST Api", "body": "<p>I've figured out the issue(s):</p>\n\n<ol>\n<li>+1 to Sohrab for pointing out the Api Version, I updated it to <code>ApiVersion = \"?api-version=2016-07\";</code></li>\n<li>There was an error in the <strong>ServiceBusNotification-Apns-Expiry</strong> header value format, the date was not being correctly formatted to string. Corrected format string is this <code>ToString(\"yyyy-MM-ddTHH:mm:sszzz\")</code></li>\n</ol>\n"}], "owner": {"reputation": 1454, "user_id": 914405, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2cdc562712df2362811fa3702b67893?s=128&d=identicon&r=PG", "display_name": "Dmitry Samuylov", "link": "https://stackoverflow.com/users/914405/dmitry-samuylov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 1, "accepted_answer_id": 42276153, "answer_count": 2, "score": 2, "last_activity_date": 1530045114, "creation_date": 1487190160, "last_edit_date": 1530045114, "question_id": 42259287, "link": "https://stackoverflow.com/questions/42259287/send-push-notification-from-a-device-via-azure-notificationhub-rest-api", "title": "Send Push Notification from a device via Azure NotificationHub REST Api", "body": "<p>I am trying to send a push notification from an iOS device (iPhone) via Azure NotificationHub REST Api. I am attempting this from a Xamarin.iOS solution following the Azure documentation I found online.</p>\n\n<h3>Response returns following info:</h3>\n\n<p><code>Error: '50002: Provider Internal Error'\nStatus code: 500</code></p>\n\n<h3>Code used to invoke NotificationHub REST Api (from iOS client app):</h3>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var hubUtil = new NotificationHubUtility(\"Endpoint=sb://company-name.servicebus.windows.net/;SharedAccessKeyName=DefaultFullSharedAccessSignature;SharedAccessKey=00000000000000011111111111111122222222222222\");\nhubUtil.SendNotificationMessage(\"This is a TEST Notification!\").ConfigureAwait(false);\n\npublic class NotificationHubUtility\n{\n    public string Endpoint { get; private set; }\n    public string SasKeyName { get; private set; }\n    public string SasKeyValue { get; private set; }\n    public string HubName { get; private set; }\n    public string ApiVersion { get; private set; }\n\n    public NotificationHubUtility(string connectionString)\n    {\n        //Parse Connectionstring\n        string[] parts = connectionString.Split(new char[] {';'});\n        for (int i = 0; i &lt; parts.Length; i++)\n        {\n            if (parts[i].StartsWith(\"Endpoint\", StringComparison.CurrentCulture))\n                Endpoint = \"https\" + parts[i].Substring(11);\n            if (parts[i].StartsWith(\"SharedAccessKeyName\", StringComparison.CurrentCulture))\n                SasKeyName = parts[i].Substring(20);\n            if (parts[i].StartsWith(\"SharedAccessKey\", StringComparison.CurrentCulture))\n                SasKeyValue = parts[i].Substring(16);\n        }\n\n        HubName = \"my-hub\";\n        ApiVersion = \"?api-version=2014-09-01\";\n    }\n\n    public string GetSaSToken(string uri, int minUntilExpire)\n    {\n        string targetUri = Uri.EscapeDataString(uri.ToLower()).ToLower();\n\n        // Add an expiration in seconds to it.\n        long expiresOnDate = DateTime.Now.Ticks / TimeSpan.TicksPerMillisecond;\n        expiresOnDate += minUntilExpire * 60 * 1000;\n        long expires_seconds = expiresOnDate / 1000;\n        var toSign = targetUri + \"\\n\" + expires_seconds;\n\n        // Generate a HMAC-SHA256 hash or the uri and expiration using your secret key.\n        IMacAlgorithmProvider hasher = WinRTCrypto.MacAlgorithmProvider.OpenAlgorithm(MacAlgorithm.HmacSha256);\n        var messageBuffer = WinRTCrypto.CryptographicBuffer.ConvertStringToBinary(toSign, Encoding.UTF8);\n        var keyBuffer = WinRTCrypto.CryptographicBuffer.ConvertStringToBinary(SasKeyValue, Encoding.UTF8);\n        var hmacKey = hasher.CreateKey(keyBuffer);\n        var signedMessage = WinRTCrypto.CryptographicEngine.Sign(hmacKey, messageBuffer);\n\n        string signature = Uri.EscapeDataString(WinRTCrypto.CryptographicBuffer.EncodeToBase64String(signedMessage));\n\n        var token = \"SharedAccessSignature sig=\" + signature + \"&amp;se=\" + expires_seconds + \"&amp;skn=\" + SasKeyName + \"&amp;sr=\" + targetUri;\n\n        return token;\n    }\n\n    public async Task SendNotificationMessage(string message)\n    {\n        try\n        {\n            // basic http client (if needed)\n            var httpClient = new HttpClient();\n            httpClient.MaxResponseContentBufferSize = 1024000;\n\n            var notificationPayload = \"{\\\"aps\\\":{\\\"alert\\\":\\\"\" + message + \"\\\"}}\";\n            var notificationHubUrl = $\"{Endpoint}{HubName}/messages/{ApiVersion}\";\n            var authToken = GetSaSToken(notificationHubUrl, 10);\n\n            var request = new HttpRequestMessage(HttpMethod.Post, notificationHubUrl);\n            //request.Headers.Add(\"Content-Type\", \"application/json;charset=utf-8\");\n            request.Headers.Add(\"ServiceBusNotification-Format\", \"apple\");\n            request.Headers.Add(\"ServiceBusNotification-Apns-Expiry\", DateTime.UtcNow.AddYears(1).ToString(\"YYYY-MM-DDThh:mmTZD\"));\n            request.Headers.Add(\"Authorization\", authToken);\n            var requestBody = new StringContent(notificationPayload, Encoding.UTF8, \"application/json\");\n            request.Content = requestBody;\n\n            var response = await httpClient.SendAsync(request, HttpCompletionOption.ResponseContentRead);\n\n        }\n        catch (Exception ex)\n        {\n            Console.Error.WriteLine(@\"ERROR - Sending Notification {0}\", ex.Message);\n        }\n    }\n}\n</code></pre>\n\n<h3>Example of Connection String:</h3>\n\n<p><code>Endpoint=sb://company-name.servicebus.windows.net/;SharedAccessKeyName=DefaultFullSharedAccessSignature;SharedAccessKey=00000000000000011111111111111122222222222222</code></p>\n\n<h3>Environment and Assumptions:</h3>\n\n<ul>\n<li>Xamarin.iOS solution using C#</li>\n<li>Using <a href=\"https://www.nuget.org/packages/pclcrypto\" rel=\"nofollow noreferrer\">PCLCrypto</a> library for encryption</li>\n<li>I am attempting to recreate the solution demonstrated in an <a href=\"https://github.com/Azure/azure-notificationhubs-samples/blob/master/iOS/GetStartedNH/GetStarted/GetStarted/ViewController.m\" rel=\"nofollow noreferrer\">Example</a> in Azure examples github repo but using Xamarin.iOS</li>\n<li>The connection string is taken directly from Azure portal</li>\n<li>The code for generating SaS token is adapted from  <a href=\"https://msdn.microsoft.com/en-us/library/azure/dn495627.aspx\" rel=\"nofollow noreferrer\">Azure NotificationHub REST Api Documentation</a></li>\n<li>Notification hub works, I am able to send a test push notification through the hub UI and i see it come in on the device</li>\n</ul>\n\n<p>What am I missing here? I wasn't able to find much relevant documentation for this error online. Any help would be greatly appreciated.</p>\n\n<h3>Update with Fix:</h3>\n\n<p>The following 2 changes to the code above fixed the issue for me:</p>\n\n<p><strong>Changed</strong></p>\n\n<pre><code>ApiVersion = \"?api-version=2014-09-01\";\n</code></pre>\n\n<p>to </p>\n\n<pre><code>ApiVersion = \"?api-version=2016-07\";\n</code></pre>\n\n<p><strong>Changed</strong></p>\n\n<pre><code>request.Headers.Add(\"ServiceBusNotification-Apns-Expiry\", DateTime.UtcNow.AddYears(1).ToString(\"YYYY-MM-DDThh:mmTZD\"));\n</code></pre>\n\n<p>to</p>\n\n<pre><code>request.Headers.Add(\"ServiceBusNotification-Apns-Expiry\", DateTime.UtcNow.AddYears(1).ToString(\"yyyy-MM-ddTHH:mm:sszzz\"));\n</code></pre>\n"}, {"tags": ["c#", "cntk"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7571170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10210316416500795/picture?type=large", "display_name": "Sebastian Kochman", "link": "https://stackoverflow.com/users/7571170/sebastian-kochman"}, "edited": false, "score": 0, "creation_date": 1487200435, "post_id": 42261773, "comment_id": 71681339, "body": "Thanks. One-hot won&#39;t work in my case -- I&#39;m looking forward to the support for sequences of general sparse vectors!"}, {"owner": {"reputation": 299, "user_id": 394562, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd77b49a5e726cd7b6182c810e110b07?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/394562/dmitry"}, "edited": false, "score": 0, "creation_date": 1537019075, "post_id": 42261773, "comment_id": 91636344, "body": "Hi, is there any new ETA/roadmap on sparse batch variable creation support?"}], "tags": [], "owner": {"reputation": 521, "user_id": 7179348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61db8bb7852286e3b576b2be6d958311?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou Wang", "link": "https://stackoverflow.com/users/7179348/zhou-wang"}, "is_accepted": true, "score": 1, "last_activity_date": 1487199861, "creation_date": 1487199861, "answer_id": 42261773, "question_id": 42259285, "link": "https://stackoverflow.com/questions/42259285/cntk-c-library-2-0beta11-cntk-cpuonly-sequence-of-sparse-vectors/42261773#42261773", "title": "CNTK C# Library 2.0beta11 (CNTK.CPUOnly): sequence of sparse vectors", "body": "<p>Currently the C# API supports to create one-hot vector for sequence and/or batch. For example, to create a sequence using:</p>\n\n<pre><code>public static Value CreateSequence&lt;T&gt;(uint dimension, List&lt;uint&gt; sequence, bool seqStartFlag, DeviceDescriptor device, bool readOnly = false)\n</code></pre>\n\n<p>or create a batch of sequence: </p>\n\n<pre><code>public static Value CreateBatchOfSequences&lt;T&gt;(uint dimension, List&lt;List&lt;uint&gt;&gt; batchOfSequences, List&lt;bool&gt; seqStartFlags, DeviceDescriptor device, bool readOnly = false\n</code></pre>\n\n<p>The API description is <a href=\"https://github.com/Microsoft/CNTK/wiki/CNTK-Library-Managed-API\" rel=\"nofollow noreferrer\">here</a>, and the examples are <a href=\"https://github.com/Microsoft/CNTK/blob/master/Examples/Evaluation/CNTKLibraryEvalExamples.sln\" rel=\"nofollow noreferrer\">here</a>. \nSupport for general sparse format will be added in the next few weeks.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 49, "user_id": 7571170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10210316416500795/picture?type=large", "display_name": "Sebastian Kochman", "link": "https://stackoverflow.com/users/7571170/sebastian-kochman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 42261773, "answer_count": 1, "score": 1, "last_activity_date": 1487199861, "creation_date": 1487190142, "question_id": 42259285, "link": "https://stackoverflow.com/questions/42259285/cntk-c-library-2-0beta11-cntk-cpuonly-sequence-of-sparse-vectors", "title": "CNTK C# Library 2.0beta11 (CNTK.CPUOnly): sequence of sparse vectors", "body": "<p>Perhaps I'm missing something in the documentation, but how can I create an input which is a sequence of sparse vectors in the new CNTK.CPUOnly NuGet package in C#? (<a href=\"https://github.com/Microsoft/CNTK/wiki/CNTK-Library-Evaluation-Overview\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/CNTK/wiki/CNTK-Library-Evaluation-Overview</a>)</p>\n\n<p>All I see in the available API is support for sequence of dense vectors.</p>\n\n<p>I was able to do it using the EvalDLL API (from the Microsoft.Research.CNTK.CpuEval-mkl NuGet package), but I'm having some thread-safety issues, which prompted me to try out the newer API.</p>\n"}, {"tags": ["c#", "linq"], "comments": [{"owner": {"reputation": 35505, "user_id": 1394631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajAkr.jpg?s=128&g=1", "display_name": "octavioccl", "link": "https://stackoverflow.com/users/1394631/octavioccl"}, "edited": false, "score": 0, "creation_date": 1487190493, "post_id": 42259219, "comment_id": 71676483, "body": "Could you explain a little the logic here?"}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "edited": false, "score": 0, "creation_date": 1487190501, "post_id": 42259219, "comment_id": 71676486, "body": "Models would help."}, {"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "reply_to_user": {"reputation": 35505, "user_id": 1394631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajAkr.jpg?s=128&g=1", "display_name": "octavioccl", "link": "https://stackoverflow.com/users/1394631/octavioccl"}, "edited": false, "score": 0, "creation_date": 1487190793, "post_id": 42259219, "comment_id": 71676638, "body": "@octavioccl - With the first query I get a list of barcodes that match the criteria. In the second query I get entries based on the each barcode"}, {"owner": {"reputation": 358, "user_id": 3155785, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5af5ac37332ca605373fc9b8de11d64e?s=128&d=identicon&r=PG&f=1", "display_name": "let_the_coding_begin", "link": "https://stackoverflow.com/users/3155785/let-the-coding-begin"}, "edited": false, "score": 0, "creation_date": 1487193207, "post_id": 42259219, "comment_id": 71677962, "body": "You should make your code as easy to debug as possible. Having a long linq statement would make it very difficult to debug since when you have an error in one of those statements, the stack trace only shows you the first line of those linq chain (i.e it would say line 1 even though the problem occurred in line 4). I&#39;d suggest either having those condition checks in a select statement and having that select statement as a separate function or doing it one by one"}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487190953, "post_id": 42259388, "comment_id": 71676722, "body": "Could you explain a bit more on your answer?"}, {"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487191055, "post_id": 42259388, "comment_id": 71676796, "body": "I won&#39;t know the barcodes until I run the first query. So I don&#39;t think I can use <code>.Where(c =&gt; c.Barcode.Contains(barcode))</code> but I&#39;ll try it"}, {"owner": {"reputation": 2393, "user_id": 986846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55280bd5ca07d70702cc458f174ade6c?s=128&d=identicon&r=PG&f=1", "display_name": "Renats Stozkovs", "link": "https://stackoverflow.com/users/986846/renats-stozkovs"}, "reply_to_user": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487191238, "post_id": 42259388, "comment_id": 71676907, "body": "Do you have a sample SQL query? What you do is get all barcodes, then iterate through the barcodes that you just got and query the same table again? Why would you want to do that? At this point, barcodes don&#39;t even make any difference to you: what you get back you query again... with the same parameters. I simply take your query and do an in-line iteration on it."}, {"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487192890, "post_id": 42259388, "comment_id": 71677788, "body": "I have added a sample SQL query which I used for testing"}], "tags": [], "owner": {"reputation": 2393, "user_id": 986846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55280bd5ca07d70702cc458f174ade6c?s=128&d=identicon&r=PG&f=1", "display_name": "Renats Stozkovs", "link": "https://stackoverflow.com/users/986846/renats-stozkovs"}, "is_accepted": false, "score": 4, "last_activity_date": 1487190510, "creation_date": 1487190510, "answer_id": 42259388, "question_id": 42259219, "link": "https://stackoverflow.com/questions/42259219/easierbetter-way-to-write-linq-query/42259388#42259388", "title": "Easier(better) way to write LINQ query", "body": "<p>As far as I can tell, there is no need for a <code>JOIN</code> because you are querying the same table and you are not trying to do a recursive or cross-join query.</p>\n\n<p>Why do you query the same table with the same parameters? You get a <code>List</code> of entries back, then iterate through <code>Barcode</code> values and then go back again and query the same table with the same <code>Barcode</code> value.</p>\n\n<p>If you want to iterate in-line, the syntax is straight forward, but I am not sure if you understand what you are doing there.</p>\n\n<pre><code>dbo.OnDemand.Where(c =&gt; c.Barcode.Contains(barcode))\n    .Where(c =&gt; c.ODHisDate &gt;= start &amp;&amp; c.ODHisDate &lt;= end)\n    .OrderBy(c =&gt; c.ODHisDate)\n    .ForEach(c =&gt;\n        {\n            // do stuff\n        }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487193964, "post_id": 42259621, "comment_id": 71678354, "body": "yes you are right there are elements with the same barcode, I am trying to display information when reprinted barcodes are found. I also removed the <code>orderby</code> in the first query"}, {"owner": {"reputation": 35505, "user_id": 1394631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajAkr.jpg?s=128&g=1", "display_name": "octavioccl", "link": "https://stackoverflow.com/users/1394631/octavioccl"}, "reply_to_user": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487194824, "post_id": 42259621, "comment_id": 71678784, "body": "your query in your edit is different and simplifies the problem"}, {"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487195943, "post_id": 42259621, "comment_id": 71679367, "body": "I was using that query in the SQL server management studio for testing,  but I don&#39;t know how to write it in C#"}, {"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487197527, "post_id": 42259621, "comment_id": 71680176, "body": "No I haven&#39;t tried it yet. I&#39;ll try it when I get the chance and let you know the result"}, {"owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "edited": false, "score": 0, "creation_date": 1487212605, "post_id": 42259621, "comment_id": 71684840, "body": "I modified your updated query and now it works. Thanks for your help. Thanks to @bc004346 for suggested answer"}], "tags": [], "owner": {"reputation": 35505, "user_id": 1394631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajAkr.jpg?s=128&g=1", "display_name": "octavioccl", "link": "https://stackoverflow.com/users/1394631/octavioccl"}, "is_accepted": true, "score": 2, "last_activity_date": 1487195025, "last_edit_date": 1487195025, "creation_date": 1487191291, "answer_id": 42259621, "question_id": 42259219, "link": "https://stackoverflow.com/questions/42259219/easierbetter-way-to-write-linq-query/42259621#42259621", "title": "Easier(better) way to write LINQ query", "body": "<p>I guess you're doing this because there are elements with the same barcode. A solution could be:</p>\n\n<pre><code>var entries = dbo.OnDemand.Where(c =&gt; c.LOTNO == LotNo \n                                   &amp;&amp; c.ODHisDate &gt;= start &amp;&amp; c.ODHisDate &lt;= end \n                                   &amp;&amp; c.Activity.Contains(reprinted))\n                          .Select(c =&gt; c.Barcode);//Don't need to orderby here\n\n// You will get a IEnumerable&lt;List&lt;OnDemand&gt;&gt; as result of this query\nvar entries2 =entries.Select(barcode =&gt;  dbo.OnDemand.Where(c =&gt; c.Barcode.Contains(barcode) \n                                                              &amp;&amp; c.ODHisDate &gt;= start &amp;&amp; c.ODHisDate &lt;= end)\n                                                     .OrderBy(c =&gt; c.ODHisDate)\n                                                     .ToList());\n\nforeach (var list in entries2)\n{\n // do stuff\n}\n</code></pre>\n\n<p>Better Idea could be filter first by the common conditions, later group by barcode and then keep those groups who have an element that meets the second where conditions</p>\n\n<pre><code>var entries = dbo.OnDemand.Where(c.ODHisDate &gt;= start &amp;&amp; c.ODHisDate &lt;= end)\n                          .GroupBy(c=&gt;c.BarCode)\n                          .Where(g=&gt;g.Any(c=&gt;c.LOTNO == LotNo &amp;&amp; c.Activity.Contains(reprinted) ))\n                          .Select(g=&gt;g.OrderBy(c =&gt; c.ODHisDate).ToList()); \n</code></pre>\n\n<h2>Update</h2>\n\n<pre><code>var entries = dbo.OnDemand.Where(c.ODHisDate &gt;= start &amp;&amp; c.ODHisDate &lt;= end &amp;&amp; c.Activity.Contains(reprinted))\n                          .GroupBy(c=&gt;c.BarCode)\n                          .Where(g=&gt;g.Count()&gt;1)\n                          .Select(g=&gt;g.OrderBy(c =&gt; c.ODHisDate));\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 7303913, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh4.googleusercontent.com/-zJgh52_OcDA/AAAAAAAAAAI/AAAAAAAAAA0/wylVxhr184o/photo.jpg?sz=128", "display_name": "ghostwar 88", "link": "https://stackoverflow.com/users/7303913/ghostwar-88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 42259621, "answer_count": 2, "score": 3, "last_activity_date": 1487195025, "creation_date": 1487189938, "last_edit_date": 1487192740, "question_id": 42259219, "link": "https://stackoverflow.com/questions/42259219/easierbetter-way-to-write-linq-query", "title": "Easier(better) way to write LINQ query", "body": "<p>I have two <code>LINQ</code> queries, I use the results of the 1st <code>LINQ</code> query and use a foreach loop to iterate through each element found and use it in the 2nd <code>LINQ</code> query</p>\n\n<pre><code>var entries = dbo.OnDemand.Where(c =&gt; c.LOTNO == LotNo).Where(c =&gt; c.ODHisDate &gt;= start &amp;&amp; c.ODHisDate &lt;= end).Where(c =&gt; c.Activity.Contains(reprinted)).OrderBy(c =&gt; c.ODHisDate);\n\nforeach (var X in entries)\n{  \n    Barcodes.Add(X.Barcode);    // Barcodes is a List&lt;string&gt;\n}\n\nforeach (string barcode in Barcodes)\n{\n    var entries2 = dbo.OnDemand.Where(c =&gt; c.Barcode.Contains(barcode)).Where(c =&gt; c.ODHisDate &gt;= start &amp;&amp; c.ODHisDate &lt;= end).OrderBy(c =&gt; c.ODHisDate);\n\n    // Do stuff with entries2\n}\n</code></pre>\n\n<p>Is there a way I could execute this using a single query?</p>\n\n<p>I read around, and people use <code>JOIN</code> but I am not entirely sure how to use it.</p>\n\n<p>Some of the expressions are common for both queries (the selected date range, and the <code>ORDERBY</code> by date)</p>\n\n<p>Currently this way works but I think there is a better way of doing what I am trying to achieve. </p>\n\n<p>Any help would be appreciated. </p>\n\n<p><strong>EDIT 1:</strong></p>\n\n<p>Sample SQL query:</p>\n\n<pre><code>select * FROM [dbo].[OnDemand]\nwhere barcode in\n(\nSELECT [Barcode]      \n  FROM [dbo].[OnDemand]\n  group by barcode\n  having count(*) &gt; 1\n  )  \n and odhisdate between  '2017-01-11' and '2017-01-31' \n\n and Activity like '%reprinted%'\n\n  order by ODHisDate asc, ODHisTime asc\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "networking", "ado.net", "named-pipes"], "comments": [{"owner": {"reputation": 5662, "user_id": 51275, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/22e56480a5d5f76ee11abebe5dc8d5a6?s=128&d=identicon&r=PG", "display_name": "ccook", "link": "https://stackoverflow.com/users/51275/ccook"}, "edited": false, "score": 0, "creation_date": 1487518897, "post_id": 42259201, "comment_id": 71811069, "body": "Possibly relevant: <a href=\"http://dba.stackexchange.com/questions/24165/sql-server-should-we-use-tcp-or-named-pipes-or-use-the-default?noredirect=1#comment317809_24165\" title=\"sql server should we use tcp or named pipes or use the default\">dba.stackexchange.com/questions/24165/&hellip;</a>"}, {"owner": {"reputation": 5662, "user_id": 51275, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/22e56480a5d5f76ee11abebe5dc8d5a6?s=128&d=identicon&r=PG", "display_name": "ccook", "link": "https://stackoverflow.com/users/51275/ccook"}, "edited": false, "score": 0, "creation_date": 1487519122, "post_id": 42259201, "comment_id": 71811174, "body": "on the tcp vs named pipes lead, and article: <a href=\"http://devproconnections.com/database-development/sql-server-performance-tip-favoring-tcpip-over-named-pipes\" rel=\"nofollow noreferrer\">devproconnections.com/database-development/&hellip;</a>"}, {"owner": {"reputation": 5662, "user_id": 51275, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/22e56480a5d5f76ee11abebe5dc8d5a6?s=128&d=identicon&r=PG", "display_name": "ccook", "link": "https://stackoverflow.com/users/51275/ccook"}, "edited": false, "score": 0, "creation_date": 1487519208, "post_id": 42259201, "comment_id": 71811217, "body": "Another source backing up the tcp vs np lead: <a href=\"http://serverfault.com/questions/30955/sporatic-connection-issues-connecting-to-sql-2005-named-pipes-vs-tcp-ip-issue/31024#31024\" title=\"sporatic connection issues connecting to sql 2005 named pipes vs tcp ip issue\">serverfault.com/questions/30955/&hellip;</a> .  In particular &quot;forcing TCP/IP in the connection string did ultimately resolve the issue. Thanks. \u2013 BradC&quot;"}, {"owner": {"reputation": 5662, "user_id": 51275, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/22e56480a5d5f76ee11abebe5dc8d5a6?s=128&d=identicon&r=PG", "display_name": "ccook", "link": "https://stackoverflow.com/users/51275/ccook"}, "edited": false, "score": 0, "creation_date": 1488388195, "post_id": 42259201, "comment_id": 72211436, "body": "another, <a href=\"http://dba.stackexchange.com/questions/29106/named-pipes-connection-closed-when-subjected-to-load\" title=\"named pipes connection closed when subjected to load\">dba.stackexchange.com/questions/29106/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5662, "user_id": 51275, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/22e56480a5d5f76ee11abebe5dc8d5a6?s=128&d=identicon&r=PG", "display_name": "ccook", "link": "https://stackoverflow.com/users/51275/ccook"}, "is_accepted": true, "score": 4, "last_activity_date": 1488405438, "last_edit_date": 1492087363, "creation_date": 1488405438, "answer_id": 42542881, "question_id": 42259201, "link": "https://stackoverflow.com/questions/42259201/sql-server-network-path-not-found-randomly-and-infrequently-occurring-across-e/42542881#42542881", "title": "SQL Server &quot;Network Path Not Found&quot; Randomly and Infrequently Occurring across Environments", "body": "<p>The issue was with named pipes.  It <em>might</em> be expressed more within a VM (speculation from the links below).  Using TCP/IP by adding tcp: within the connection string and specifying the port resolved the issue.</p>\n\n<p>Some related cases:</p>\n\n<ol>\n<li><a href=\"https://dba.stackexchange.com/questions/24165/sql-server-should-we-use-tcp-or-named-pipes-or-use-the-default\">https://dba.stackexchange.com/questions/24165/sql-server-should-we-use-tcp-or-named-pipes-or-use-the-default</a></li>\n<li><a href=\"http://devproconnections.com/database-development/sql-server-performance-tip-favoring-tcpip-over-named-pipes\" rel=\"nofollow noreferrer\">http://devproconnections.com/database-development/sql-server-performance-tip-favoring-tcpip-over-named-pipes</a></li>\n<li><a href=\"https://serverfault.com/questions/30955/sporatic-connection-issues-connecting-to-sql-2005-named-pipes-vs-tcp-ip-issue/31024#31024\">https://serverfault.com/questions/30955/sporatic-connection-issues-connecting-to-sql-2005-named-pipes-vs-tcp-ip-issue/31024#31024</a></li>\n<li><a href=\"https://dba.stackexchange.com/questions/29106/named-pipes-connection-closed-when-subjected-to-load\">https://dba.stackexchange.com/questions/29106/named-pipes-connection-closed-when-subjected-to-load</a></li>\n</ol>\n\n<p>Conclusion, <strong>always</strong> use TCP/IP explicitly unless the SQL Server is on the same machine.  You can configure the SQL Server to not accept named pipes as well, but going forward I will just be adding it to my connection strings as well.</p>\n"}], "owner": {"reputation": 5662, "user_id": 51275, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/22e56480a5d5f76ee11abebe5dc8d5a6?s=128&d=identicon&r=PG", "display_name": "ccook", "link": "https://stackoverflow.com/users/51275/ccook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1765, "favorite_count": 0, "accepted_answer_id": 42542881, "answer_count": 1, "score": 3, "last_activity_date": 1488405438, "creation_date": 1487189889, "last_edit_date": 1495540432, "question_id": 42259201, "link": "https://stackoverflow.com/questions/42259201/sql-server-network-path-not-found-randomly-and-infrequently-occurring-across-e", "title": "SQL Server &quot;Network Path Not Found&quot; Randomly and Infrequently Occurring across Environments", "body": "<p>Similar (if not same question as) <a href=\"https://stackoverflow.com/questions/38696448/network-path-not-found-exception-encountered-randomly\">Network path not found exception encountered randomly</a>, but I have code to reproduce the issue so I want to ask again as it appears to be a real issue independent of hardware and can be reproduced.</p>\n\n<p>Here's the error:</p>\n\n<blockquote>\n  <p>provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) ---> System.ComponentModel.Win32Exception (0x80004005): The network path was not found\n     at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal&amp; connection)\n     at System.Data.ProviderBase.DbConnectionPool.WaitForPendingOpen()</p>\n</blockquote>\n\n<p>To reproduce this I created a console application that's run every minute (we also have a Dapper DAL test, hence the parameter):</p>\n\n<pre><code>internal class Program\n{\n    private static int _totalOpenConnections;\n    private static readonly Stopwatch Timer = new Stopwatch();\n    private static bool _hasError;\n\n    private static int Main(string[] args)\n    {\n        var list = Enumerable.Range(1, Settings.Default.TotalCommandsToExecute);\n\n        // simple ADO.NET test\n        if (args.Length &gt; 0 &amp;&amp; args[0].Equals(\"ado\", StringComparison.OrdinalIgnoreCase))\n        {\n            Console.WriteLine(\"Beginning ADO.NET Test...\");\n\n            Timer.Restart();\n\n            Parallel.ForEach(list, new ParallelOptions {MaxDegreeOfParallelism = Settings.Default.ConcurrentCount},\n                i =&gt; AsyncContext.Run(async () =&gt;\n                {\n                    try\n                    {\n                        PrintStatus(i);\n                        await TestADONet();\n                    }\n                    catch (Exception ex)\n                    {\n                        Console.WriteLine(ex.ToString());\n                        _hasError = true;\n                    }\n                }));\n\n            Timer.Stop();\n\n            Console.WriteLine($\"Completed ADO.NET Test in {Timer.ElapsedMilliseconds} ms\");\n        }\n\n        if (_hasError)\n            return 1;\n        return 0;\n    }\n\n    private static void PrintStatus(int index)\n    {\n        Console.WriteLine(\n            $\"Started: {index} of {Settings.Default.TotalCommandsToExecute}\\tCurrently Open: {_totalOpenConnections}\");\n    }\n\n    private static async Task TestADONet()\n    {\n        using (var conn = new SqlConnection(Settings.Default.TestConnection))\n        {\n            await conn.OpenAsync();\n            Interlocked.Increment(ref _totalOpenConnections);\n\n            var command = new SqlCommand(\"SELECT 1 Field1, 2 Field2, 3 Field3\", conn);\n            var reader = await command.ExecuteReaderAsync();\n            while (reader.Read())\n            {\n                var result = new TestEntity\n                {\n                    Field1 = reader.GetInt32(0),\n                    Field2 = reader.GetInt32(1),\n                    Field3 = reader.GetInt32(2)\n                };\n            }\n        }\n        Interlocked.Decrement(ref _totalOpenConnections);\n    }\n\n    public class TestEntity\n    {\n        public int Field1 { get; set; }\n\n        public int Field2 { get; set; }\n\n        public int Field3 { get; set; }\n    }\n}\n</code></pre>\n\n<p>The application settings ConcurrentCount = 100, and TotalCommandsToExecute = 200.  The idea is to hit the connection pool pretty hard with async commands in parallel.  </p>\n\n<p>This application reproduces it, however, it's also occurred in production in console applications, web applications (ASP.NET MVC, and ASP.NET WebForms).</p>\n\n<p>It also occurs rather randomly.  We've had Rackspace and some DBAs crawl through the environment on the issue to no avail, which led to this application - which reproduced it in the development environment.</p>\n\n<p>The connection string is rather bland, of the form \"Data Source=;Database=;User Id=;Password=\"</p>\n\n<p>SQL Server 2014, but this has occurred against two separate servers (dev/rackspace)</p>\n\n<p>The query in the test is intentionally benign </p>\n\n<p><code>\"SELECT 1 Field1, 2 Field2, 3 Field3\"</code></p>\n\n<p>The test does use Nito.AsyncEx, the only none System assembly in use here, to get async support.  Again the issue occurs in other applications not using this assembly, so I don't think it's an issue - let me know if not and I'll reproduce it another way.</p>\n\n<p>ANY ideas greatly appreciated!</p>\n"}, {"tags": ["c#", "asp.net", "wpf"], "comments": [{"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487189914, "post_id": 42259150, "comment_id": 71676191, "body": "Could you post a simplified version of the application code so others may help debug it?"}, {"owner": {"reputation": 66, "user_id": 6621645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cc3a07e916e4dd6aba1d8e6b57bb44?s=128&d=identicon&r=PG&f=1", "display_name": "RyanWilliamWest", "link": "https://stackoverflow.com/users/6621645/ryanwilliamwest"}, "reply_to_user": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487190490, "post_id": 42259150, "comment_id": 71676479, "body": "Hey Laylarenee, I just added some of the code above. I hope it clears some things up!"}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487190906, "post_id": 42259150, "comment_id": 71676697, "body": "Could you add the Click Handlers for each of the three buttons? You only need to include the bit that sets the text."}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 6621645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cc3a07e916e4dd6aba1d8e6b57bb44?s=128&d=identicon&r=PG&f=1", "display_name": "RyanWilliamWest", "link": "https://stackoverflow.com/users/6621645/ryanwilliamwest"}, "edited": false, "score": 0, "creation_date": 1487193534, "post_id": 42260156, "comment_id": 71678149, "body": "Thank you! Yeah the Click Handling actually ended up working for me I ended up doing something like this for each topic:    var tb = sender as TextBlock;              if (tb == null)             {                 textBlock.Text = &quot;Working on it&quot;;             }"}, {"owner": {"reputation": 246, "user_id": 3395290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e84823a29aa0029c9cf7fe719840b490?s=128&d=identicon&r=PG&f=1", "display_name": "biggi_", "link": "https://stackoverflow.com/users/3395290/biggi"}, "reply_to_user": {"reputation": 66, "user_id": 6621645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cc3a07e916e4dd6aba1d8e6b57bb44?s=128&d=identicon&r=PG&f=1", "display_name": "RyanWilliamWest", "link": "https://stackoverflow.com/users/6621645/ryanwilliamwest"}, "edited": false, "score": 0, "creation_date": 1487194139, "post_id": 42260156, "comment_id": 71678433, "body": "If this answered your question, you should mark it as complete."}], "tags": [], "owner": {"reputation": 246, "user_id": 3395290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e84823a29aa0029c9cf7fe719840b490?s=128&d=identicon&r=PG&f=1", "display_name": "biggi_", "link": "https://stackoverflow.com/users/3395290/biggi"}, "is_accepted": true, "score": 0, "last_activity_date": 1487193149, "creation_date": 1487193149, "answer_id": 42260156, "question_id": 42259150, "link": "https://stackoverflow.com/questions/42259150/wpf-updating-a-textblock-on-click/42260156#42260156", "title": "WPF Updating a TextBlock on Click", "body": "<p>What is sounds like you want is a text box to update depending on which button was clicked?  If that's the case, I would recommend the Click Handlers (like @laylarenee suggested) by doing something similar to this:</p>\n\n<pre><code>private bool btn1_Clicked = false;\n\nprivate void button1_Click(object sender, EventArgs e)\n{\n    btn1_Clicked = true;\n}\n</code></pre>\n\n<p>Repeat that for all 3 buttons (btn2_Clicked,btn3_Clicked).  If you want to put your logic in the button handler (like you have done above) then you can make another function called update_Text where you check those variables you set and update the text box:</p>\n\n<pre><code>if(btn1_Clicked == true)\n{\n   // put your textbox update in here\n}\n</code></pre>\n\n<p>This may be a bit of a longer way around, but would get the job done for sure. Just be sure you set the other button click variables back to false if another button is clicked to keep things clean.</p>\n"}], "owner": {"reputation": 66, "user_id": 6621645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1cc3a07e916e4dd6aba1d8e6b57bb44?s=128&d=identicon&r=PG&f=1", "display_name": "RyanWilliamWest", "link": "https://stackoverflow.com/users/6621645/ryanwilliamwest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 42260156, "answer_count": 1, "score": -1, "last_activity_date": 1487193149, "creation_date": 1487189679, "last_edit_date": 1487191514, "question_id": 42259150, "link": "https://stackoverflow.com/questions/42259150/wpf-updating-a-textblock-on-click", "title": "WPF Updating a TextBlock on Click", "body": "<p>I have 3 buttons right now which each one of them does a specific task. Either open a Webpage or an application on the desktop. However, I want a series of instructions to follow these buttons thus why I'm using a Textblock. When I click on the Button I want the instructions to reflect which button was pressed and have it constantly changed between the 3. How would this be done? </p>\n\n<pre><code>    protected void passButton_Click(object sender, RoutedEventArgs e)\n    {\n        // I want to be able to surround this is a try catch block statement\n        // because there is a \"Run as Admin\" A lot of users may say no and it will crash.\n        Process myProcess = new Process();\n        String pathWay = \"C:\\\\blah.txt\";\n\n        try\n        //Although we have a working enviornment here we still need to be able to run it as an administrator always\n        //This would eliminate the need of a \"Try/Catch\" statement.\n        {\n            myProcess.StartInfo.FileName = pathWay;\n            myProcess.StartInfo.UseShellExecute = true;\n            myProcess.StartInfo.Verb = \"runas\";\n            myProcess.Start();\n\n        }\n        //Fixed the bug where the app would crash when the user would enter \"No\" instead of \"yes\" the App would not launch in this case.\n        catch\n        {\n            Console.WriteLine(\"Enter so value here for logs later down the road if we run into the problem.\");\n        }\n\n       // Here is where I want to be able to change the value incase the user\n       // clicks another button as of right now the text block updates once\n       // the block is clicked with a simple \"Hello World\" but if I click of the value remains the same\n\n       textBlock.Text = \"Hello world\";\n</code></pre>\n"}, {"tags": ["c#", "wpf", "mvvm"], "comments": [{"owner": {"reputation": 13174, "user_id": 73804, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/lwHel.jpg?s=128&g=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/73804/patrick"}, "edited": false, "score": 0, "creation_date": 1487189765, "post_id": 42259124, "comment_id": 71676096, "body": "TabControl.Selected .DataContext as PaySlipModel ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 1, "creation_date": 1487190525, "post_id": 42259124, "comment_id": 71676499, "body": "ItemsControls have an ItemsSource and SelectedItem.  In a TabControl SelectedItem is the currently displayed tab.  Is that not enough to tell you which PayslipModel is being edited?"}, {"owner": {"reputation": 67, "user_id": 7391746, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/057a591f081c123562dc8b9c0b08e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "bruh1234", "link": "https://stackoverflow.com/users/7391746/bruh1234"}, "edited": false, "score": 0, "creation_date": 1487194987, "post_id": 42259124, "comment_id": 71678872, "body": "@Will, I was trying to implement saving through the ViewModel since I bind the button using a command. Does that mean for this particular case, it cannot be done through the ViewModel?"}, {"owner": {"reputation": 67, "user_id": 7391746, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/057a591f081c123562dc8b9c0b08e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "bruh1234", "link": "https://stackoverflow.com/users/7391746/bruh1234"}, "reply_to_user": {"reputation": 13174, "user_id": 73804, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/lwHel.jpg?s=128&g=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/73804/patrick"}, "edited": false, "score": 0, "creation_date": 1487195022, "post_id": 42259124, "comment_id": 71678893, "body": "@Patrick, same question ^"}, {"owner": {"reputation": 13174, "user_id": 73804, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/lwHel.jpg?s=128&g=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/73804/patrick"}, "edited": false, "score": 0, "creation_date": 1487195640, "post_id": 42259124, "comment_id": 71679208, "body": "@bruh1234 If I understand you, the button code behind doesn&#39;t have access to TabControl, therefore bind a property in the ViewModel to TabControl SelectedItem...., then in button codebehind look at said property."}, {"owner": {"reputation": 67, "user_id": 7391746, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/057a591f081c123562dc8b9c0b08e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "bruh1234", "link": "https://stackoverflow.com/users/7391746/bruh1234"}, "reply_to_user": {"reputation": 13174, "user_id": 73804, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/lwHel.jpg?s=128&g=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/73804/patrick"}, "edited": false, "score": 0, "creation_date": 1487201050, "post_id": 42259124, "comment_id": 71681568, "body": "@Patrick, that doesn&#39;t seem to be working either so I thought of moving the save button inside the view that has the tab content, so it can directly access the properties. It does disrupt the flow of the layout but it&#39;s something I can work with for now."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1487257045, "post_id": 42259124, "comment_id": 71710995, "body": "You can always pass in the object you wish to save via the CommandParameter.  You&#39;ll see patterns like <code>&lt;Button Content=&quot;{Binding Name, StringFormat=Save {0}}&quot; Command=&quot;{Binding Save, ElementName=MainWindow&quot; CommandParameter=&quot;{Binding}&quot; &#47;&gt;</code> where MainWindow is where the VM with the Save command lives, and the button is bound to the child VM."}], "answers": [{"tags": [], "owner": {"reputation": 3117, "user_id": 5615980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a3c026c1a72be812594861aeec8f56?s=128&d=identicon&r=PG&f=1", "display_name": "Ron", "link": "https://stackoverflow.com/users/5615980/ron"}, "is_accepted": false, "score": 1, "last_activity_date": 1487211292, "creation_date": 1487211292, "answer_id": 42263594, "question_id": 42259124, "link": "https://stackoverflow.com/questions/42259124/wpf-one-viewmodel-that-interacts-with-multiple-instances-of-a-model/42263594#42263594", "title": "wpf - One ViewModel that interacts with multiple instances of a Model", "body": "<p>This is a working example which shows one of the possiblities:</p>\n\n<p><strong>View</strong></p>\n\n<pre><code>    &lt;TabControl DataContext=\"{Binding}\" ItemsSource=\"{Binding Models}\"  &gt;\n        &lt;TabControl.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;TextBlock Text=\"{Binding Name}\" &gt; \n                &lt;/TextBlock&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/TabControl.ItemTemplate&gt;\n        &lt;TabControl.ContentTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;DockPanel&gt;\n                    &lt;Button DockPanel.Dock=\"Top\" Content=\"Click Me\" Command=\"{Binding DataContext.PCommand, \n                                                            RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=TabControl}}\"\n                            CommandParameter=\"{Binding Desc}\"/&gt;\n                    &lt;TextBlock Text=\"{Binding Desc}\" &gt;\n                    &lt;/TextBlock&gt;\n                &lt;/DockPanel&gt; \n            &lt;/DataTemplate&gt;\n        &lt;/TabControl.ContentTemplate&gt;\n    &lt;/TabControl&gt;\n</code></pre>\n\n<p><strong>Model View</strong></p>\n\n<pre><code>public class ModelView\n{\n    public ModelView()\n    {\n        _models = new ObservableCollection&lt;Model&gt;(); \n        _pCommand = new Command(DoParameterisedCommand);\n    }\n    ObservableCollection&lt;Model&gt; _models;\n    public ObservableCollection&lt;Model&gt; Models { get { return _models; } }\n\n    private void DoParameterisedCommand(object parameter)\n    {\n        MessageBox.Show(\"Parameterised Command; Parameter is '\" +\n                     parameter.ToString() + \"'.\");\n    }\n    Command _pCommand;\n    public Command PCommand\n    {\n        get { return _pCommand; }\n    }\n}\n</code></pre>\n\n<p><strong>Model</strong></p>\n\n<pre><code>public class Model : INotifyPropertyChanged\n{\n    string _desc;\n    public string Desc { get { return _desc; } set { _desc = value; RaisePropertyChanged(\"Desc\"); } }\n\n    string _name;\n    public string Name { get { return _name; } set { _name = value; RaisePropertyChanged(\"Name\"); } }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n    void RaisePropertyChanged(string propname)\n    {\n        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propname));\n    }\n}\n</code></pre>\n\n<p><strong>Command</strong></p>\n\n<pre><code>public class Command : ICommand\n{ \n    public Command(Action&lt;object&gt; parameterizedAction, bool canExecute = true)\n    {\n        _parameterizedAction = parameterizedAction;\n        _canExecute = canExecute;\n    }\n\n\n    Action&lt;object&gt; _parameterizedAction = null;\n    bool _canExecute = false;\n    public bool CanExecute\n    {\n        get { return _canExecute; }\n        set\n        {\n            if (_canExecute != value)\n            {\n                _canExecute = value;\n                CanExecuteChanged?.Invoke(this, EventArgs.Empty);\n            }\n        }\n    }\n    public event EventHandler CanExecuteChanged;\n    bool ICommand.CanExecute(object parameter)\n    {\n        return _canExecute;\n    }\n\n    void ICommand.Execute(object parameter)\n    {\n        this.DoExecute(parameter);\n    }\n    public virtual void DoExecute(object param)\n    { if (_parameterizedAction != null)\n            _parameterizedAction(param);\n        else\n            throw new Exception();\n    }\n\n\n}\n</code></pre>\n\n<p>Use this to initialize:</p>\n\n<pre><code>    public MainWindow()\n    {\n        InitializeComponent();\n        ModelView mv = new ModelView();\n        mv.Models.Add(new Model() { Name = \"a\", Desc = \"aaa\" });\n        mv.Models.Add(new Model() { Name = \"b\" , Desc = \"bbb\"});\n        mv.Models.Add(new Model() { Name = \"c\", Desc = \"cccc\" });\n        this.DataContext = mv; \n\n    }\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7391746, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/057a591f081c123562dc8b9c0b08e2e5?s=128&d=identicon&r=PG&f=1", "display_name": "bruh1234", "link": "https://stackoverflow.com/users/7391746/bruh1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1487211292, "creation_date": 1487189614, "question_id": 42259124, "link": "https://stackoverflow.com/questions/42259124/wpf-one-viewmodel-that-interacts-with-multiple-instances-of-a-model", "title": "wpf - One ViewModel that interacts with multiple instances of a Model", "body": "<p>I have a WorkspaceViewModel that handles addition and deletion of tab items dynamically through an ObservableCollection. Each time a tab is connected to a PayslipModel, all bindings work fine but one problem I am having is that;</p>\n\n<p>I have a save button in the UserControl who's DataContext is set to WorkspaceViewModel and I would like to save whatever info is being displayed in the selected tab. Now, each time a tab is added, a new instance of PayslipModel is created, which is exactly what I want because I don't want bindings to be shared for all tabs. However, I am unable to save what is being displayed since PayslipModel has multiple instances, therefore nothing is returned (temporarily using MessageBox to test if info is being retrieved) when I hit save.</p>\n\n<p>I created a diagram to better explain my situation:\n<a href=\"https://i.stack.imgur.com/ffrCf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ffrCf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is it possible to access the current instance when a tab is selected or cycle through all instances and do something like batch saving?</p>\n"}, {"tags": ["c#", "vsto", "outlook-addin", "mapi"], "answers": [{"comments": [{"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487190989, "post_id": 42259451, "comment_id": 71676745, "body": "Thank you, but when I access the GlobalAppointmentId property (placing a breakpoint that is hit when user accepts meeting request) it is actually a different, much longer string. This was the original cause of my question actually, we are trying to sync meetings created online and meetings created in outlook via a common ID."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487191168, "post_id": 42259451, "comment_id": 71676869, "body": "For example, the UID in the original invite is &quot;augkaa383mj7v641rdikluit70@google.com&quot; but the Global Appointment ID in the Outlook object is &quot;040000008200E00074C5B7101A82E008000000000000000000000000000&zwnj;&#8203;00000000000003200000&zwnj;&#8203;07643616C2D556964010&zwnj;&#8203;000006175676B6161333&zwnj;&#8203;8336D6A3776363431726&zwnj;&#8203;4696B6C7569743730406&zwnj;&#8203;76F6F676C652E636F6D0&zwnj;&#8203;0&quot;. Thanks again."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487192459, "post_id": 42259451, "comment_id": 71677537, "body": "Yes, I as I mentioned before, the UID iss embedded inside that binary property. You would need to parse it. Take a look at the data with OutlookSpy - click IMessage button, select the GlobalObjectId property, click the &quot;...&quot; button next t the Value property."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487192862, "post_id": 42259451, "comment_id": 71677775, "body": "Ok, I see, thank you! I have installed OutlookSpy and will try that now."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487193026, "post_id": 42259451, "comment_id": 71677858, "body": "It&#39;s there, thanks! Now to figure it out how to grab it in C#. . ."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487193468, "post_id": 42259451, "comment_id": 71678112, "body": "Don&#39;t forget to test your parser with an appointment produced in Outlook - GlobalAppointmentId  will not have the native UID."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487195717, "post_id": 42259451, "comment_id": 71679245, "body": "Thanks. I believe I am close here but struggling with the last bit. I have updated the question above with the code example and where I am stuck. I would be very grateful for any help."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487195832, "post_id": 42259451, "comment_id": 71679317, "body": "Why are you parsing the entry id? You need the global appointment id property."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487195894, "post_id": 42259451, "comment_id": 71679343, "body": "Yes, that was just an example. I don&#39;t know how to get the GAID."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487195942, "post_id": 42259451, "comment_id": 71679366, "body": "OutlookSpy will give you the DASL name of that property in the DASL edit both."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487195971, "post_id": 42259451, "comment_id": 71679377, "body": "Or you can just read the AppointmentItem.GlobalAppointmentId property."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487196042, "post_id": 42259451, "comment_id": 71679420, "body": "And you need to use PropertyAccessor.StringToBinary to convert from a hex string to an array."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487202789, "post_id": 42259451, "comment_id": 71682126, "body": "Thanks once again. I am still stumbling a bit but I want to spend some more time ensuring that I am not just making a silly mistake before asking another question."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487206338, "post_id": 42259451, "comment_id": 71683184, "body": "Dmitry, thanks again for your help. I have gotten closer. If I turn the Global Appointment ID hex string into an array of bytes, I can then get a string that contains the UID by using Encoding.UTF8.GetString(bytes). The only remaining problem is that the UID is tucked into the resulting unicode and I don&#39;t know how to consistently isolate it. Any ideas? Thanks so much for your help thus far."}, {"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487206366, "post_id": 42259451, "comment_id": 71683192, "body": "Here is the unicode I am getting: &quot;\\u0004\\0\\0\\0\ufffd\\0\ufffd\\0t\u0177\\u0010\\u001a\ufffd\ufffd\\b\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\&zwnj;&#8203;0\\0\\0\\0\\0\\0\\0\\0\\02\\0&zwnj;&#8203;\\0\\0vCal-Uid\\u0001\\0&zwnj;&#8203;\\0\\0bec7ig9javo9j8rd&zwnj;&#8203;kg3i8p59oc@google.co&zwnj;&#8203;m\\0&quot;"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1487217296, "post_id": 42259451, "comment_id": 71686209, "body": "Why are you using a Unicode string?  PropertyAccessor.StringToBinary will give you a byte array. You can then parse that array."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1487190708, "creation_date": 1487190708, "answer_id": 42259451, "question_id": 42259122, "link": "https://stackoverflow.com/questions/42259122/how-do-i-retrieve-a-uid-from-a-ics-file-being-accepted-in-an-outlook-add-in/42259451#42259451", "title": "How do I retrieve a UID from a ICS file being accepted in an Outlook add in?", "body": "<p>You can extract it from the AppointmentItem.GlobalAppointmentID property. Its format is documented at <a href=\"https://msdn.microsoft.com/en-us/library/ee157690(v=exchg.80).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ee157690(v=exchg.80).aspx</a>. If Data section starts with \"vCal-Uid\", the UID follows. </p>\n"}], "owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 952, "favorite_count": 0, "accepted_answer_id": 42259451, "answer_count": 1, "score": 1, "last_activity_date": 1487267285, "creation_date": 1487189612, "last_edit_date": 1592644375, "question_id": 42259122, "link": "https://stackoverflow.com/questions/42259122/how-do-i-retrieve-a-uid-from-a-ics-file-being-accepted-in-an-outlook-add-in", "title": "How do I retrieve a UID from a ICS file being accepted in an Outlook add in?", "body": "<p>Thanks for looking.</p>\n<p>I am developing an Outlook Add-in and have a need to access the UID value embedded in a .ics file when the user accepts it:</p>\n<p><a href=\"https://i.stack.imgur.com/AAbvv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AAbvv.png\" alt=\"enter image description here\" /></a></p>\n<p>If I view the raw data in the .ICS file, I can see that the UID is there:</p>\n<p><a href=\"https://i.stack.imgur.com/AAbvv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DEGDx.png\" alt=\"enter image description here\" /></a></p>\n<p>I would like to know what event fires (that I can attach to) when a user accepts the meeting and, once I have the outlook object that is being accepted, how do I retrieve the UID from it?</p>\n<h1>UPDATE:</h1>\n<p>Thanks to Dmitry Streblechenko's help I now understand that the Global Appointment Id is just an encoded version of the UID. His tool <a href=\"http://www.dimastr.com/outspy/home.htm\" rel=\"nofollow noreferrer\">OutlookSpy</a>was very useful in seeing this. That said, I am still stuck on the last part which is to convert the Global Appointment ID to the UID in C#. Google leads me to this example to convert the <code>EntryId</code> property, but I can't locate the proper schema or hex code to get the Global Appointment ID property and decoded value. Any suggestions on how to modify the code below for the Global Appointment ID would be appreciated:</p>\n<pre><code>var oPA = appt.PropertyAccessor;\n\n//Get EntryId Value\nvar entryIDProperty = &quot;http://schemas.microsoft.com/mapi/proptag/0x0FFF0102&quot;;\nvar entryId= oPA.BinaryToString(oPA.GetProperty(entryIDProperty));\n\n//Now how to get the Global Appointment ID??\nvar globalApptProperty = http://schemas.microsoft.com/mapi/proptag/0x????????&quot;;\nvar globalId= oPA.BinaryToString(oPA.GetProperty(globalApptProperty ));\n               \n</code></pre>\n<p>Thanks in advance.</p>\n<h1>A SOLUTION</h1>\n<p>I realize that this may not be the best way to accomplish the goal, but it works so I am posting in case it helps anyone else:</p>\n<pre><code>var item = Item as Outlook.MeetingItem;\nvar appt = item.GetAssociatedAppointment(false);              \nvar oPA = appt.PropertyAccessor;\n                \n//This parses the Global Appointment ID to a byte array. We need to retrieve    the &quot;UID&quot; from it (if available).\nbyte[] bytes = (byte[]) oPA.StringToBinary(appt.GlobalAppointmentID);\n\n//According to https://msdn.microsoft.com/en-us/library/ee157690(v=exchg.80).aspx we don't need first 40 bytes            \nif (bytes.Length&gt;=40)\n{                    \n   byte[] bytesThatContainData = new byte[bytes.Length - 40];\n   Array.Copy(bytes, 40, bytesThatContainData, 0, bytesThatContainData.Length);\n\n   //In some cases, there won't be a UID.\n   var test = Encoding.UTF8.GetString(bytesThatContainData, 0, bytesThatContainData.Length);\n\n   if (test.StartsWith(&quot;vCal-Uid&quot;))\n   {\n      //remove vCal-Uid from start string and special symbols\n      test = test.Replace(&quot;vCal-Uid&quot;, string.Empty);\n      test = test.Replace(&quot;\\u0001&quot;, string.Empty);\n      test = test.Replace(&quot;\\0&quot;, string.Empty);\n\n      //Here is the result\n      var uid = test;\n    }else{\n      // Bad format!!!\n    }\n }\n</code></pre>\n"}, {"tags": ["c#", ".net", "azure", "reflection", "azure-worker-roles"], "answers": [{"tags": [], "owner": {"reputation": 1803, "user_id": 4138626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1e2b3bd90af8405c5f090855527f4675?s=128&d=identicon&r=PG&f=1", "display_name": "RizJa", "link": "https://stackoverflow.com/users/4138626/rizja"}, "is_accepted": true, "score": 1, "last_activity_date": 1487231305, "creation_date": 1487231305, "answer_id": 42267859, "question_id": 42259037, "link": "https://stackoverflow.com/questions/42259037/azure-worker-role-throwing-system-io-filenotfoundexception/42267859#42267859", "title": "Azure worker role throwing System.IO.FileNotFoundException", "body": "<p>Figured it out... but not in the most graceful of ways.</p>\n\n<p>I went ahead and updated all DLLs from Nuget for the worker role and class library projects. Something in there fixed that problem (I know, bad right?) but then I was faced with another: </p>\n\n<blockquote>\n  <p>Application: WaWorkerHost.exe\n  Framework Version: v4.0.30319\n  Description: The process was terminated due to an unhandled exception.\n  Exception Info: System.TypeInitializationException\n  Stack:\n     at Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment.Initialize()\n     at Microsoft.WindowsAzure.ServiceRuntime.Implementation.Loader.RoleRuntimeBridge.Initialize(String[] args)\n     at Microsoft.WindowsAzure.ServiceRuntime.Implementation.Loader.RoleRuntimeBridge.Initialize(System.String[])\n     at Microsoft.WindowsAzure.Hosts.Worker.Loader.CreateConsoleRole(Microsoft.WindowsAzure.Hosts.Worker.Parameters)\n     at Microsoft.WindowsAzure.Hosts.Worker.Loader.Main(System.String[])</p>\n</blockquote>\n\n<p>To solve this, I eventually stumbled across <a href=\"https://disqus.com/home/discussion/thewindowsazureproductsite/en_us_develop_net_tutorials_multi_tier_web_site_1_overview/\" rel=\"nofollow noreferrer\">here</a>, which led me to <a href=\"https://blogs.msdn.microsoft.com/kwill/2013/10/03/troubleshooting-scenario-7-role-recycling/\" rel=\"nofollow noreferrer\">this</a>. I downloaded AzureTools on my Worker Role VM and attached a debugger to the recycling WaWorkerHost process. The following is a relevant excerpt from the aforementioned link:</p>\n\n<blockquote>\n  <p>AzureTools includes an option under the Utils tab to attach a debugger to the startup of a process.  Switch to the Utils tab, click Attach Debugger, select WaIISHost from the process list, then click Attach Debugger.  You will see WaIISHost show up in the Currently Monitoring list.  AzureTools will attach WinDBG (or whatever you specify in Debugger Location) to a monitored process the next time that process starts up.  Note that AzureTools will only attach the next instance of the target process that is started \u2013 if the process is currently running then AzureTools will ignore it.</p>\n</blockquote>\n\n<p>Debugging through this, I found out that I was missing the <code>type</code> attribute for my <code>filter</code> tag in the Worker Role's app.config file. Once I added that in as shown below, everything fell into place and the worker role deployed successfully.</p>\n\n<pre><code>&lt;system.diagnostics&gt;\n    &lt;trace&gt;\n      &lt;listeners&gt;\n        &lt;add type=\"Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=2.8.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" name=\"AzureDiagnostics\"&gt;\n          &lt;filter type=\"\" /&gt;\n        &lt;/add&gt;\n      &lt;/listeners&gt;\n    &lt;/trace&gt;\n  &lt;/system.diagnostics&gt;\n</code></pre>\n\n<p>Note that to resolve the first error, I could have also used AzureTools and debugged through that way. In most cases, I would consider that the advisable approach. It just so happens that I didn't find out about the utility until I was confronted with the second error and given that my application has not yet been productionized, I could afford to update my DLL references.</p>\n\n<p>Hope this helps someone else.</p>\n"}], "owner": {"reputation": 1803, "user_id": 4138626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1e2b3bd90af8405c5f090855527f4675?s=128&d=identicon&r=PG&f=1", "display_name": "RizJa", "link": "https://stackoverflow.com/users/4138626/rizja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 1, "accepted_answer_id": 42267859, "answer_count": 1, "score": 1, "last_activity_date": 1487231305, "creation_date": 1487189305, "question_id": 42259037, "link": "https://stackoverflow.com/questions/42259037/azure-worker-role-throwing-system-io-filenotfoundexception", "title": "Azure worker role throwing System.IO.FileNotFoundException", "body": "<p>I redeployed an operational Azure worker role with a few changes that involve referencing a new class library project I have set up and have begun to see the worker role endlessly reboot/recycle.</p>\n\n<p>The Event Viewer Application logs provide very little help as the error I receive is very generic.</p>\n\n<p>Source: .NET Runtime</p>\n\n<blockquote>\n  <p>Application: WaWorkerHost.exe\n  Framework Version: v4.0.30319\n  Description: The process was terminated due to an unhandled exception.\n  Exception Info: System.IO.FileNotFoundException\n  Stack:\n     at System.ModuleHandle.ResolveType(System.Reflection.RuntimeModule, Int32, IntPtr*, Int32, IntPtr*, Int32, System.Runtime.CompilerServices.ObjectHandleOnStack)\n     at System.ModuleHandle.ResolveType(System.Reflection.RuntimeModule, Int32, IntPtr*, Int32, IntPtr*, Int32, System.Runtime.CompilerServices.ObjectHandleOnStack)\n     at System.ModuleHandle.ResolveTypeHandleInternal(System.Reflection.RuntimeModule, Int32, System.RuntimeTypeHandle[], System.RuntimeTypeHandle[])\n     at System.ModuleHandle.ResolveTypeHandle(Int32, System.RuntimeTypeHandle[], System.RuntimeTypeHandle[])\n     at System.Reflection.RuntimeModule.ResolveType(Int32, System.Type[], System.Type[])\n     at System.Reflection.CustomAttribute.FilterCustomAttributeRecord(System.Reflection.CustomAttributeRecord, System.Reflection.MetadataImport, System.Reflection.Assembly ByRef, System.Reflection.RuntimeModule, System.Reflection.MetadataToken, System.RuntimeType, Boolean, System.Object[], System.Collections.IList, System.RuntimeType ByRef, System.IRuntimeMethodInfo ByRef, Boolean ByRef, Boolean ByRef)\n     at System.Reflection.CustomAttribute.GetCustomAttributes(System.Reflection.RuntimeModule, Int32, Int32, System.RuntimeType, Boolean, System.Collections.IList, Boolean)\n     at System.Reflection.CustomAttribute.GetCustomAttributes(System.Reflection.RuntimeAssembly, System.RuntimeType)\n     at Microsoft.WindowsAzure.Hosts.Worker.Loader.CreateConsoleRole(Microsoft.WindowsAzure.Hosts.Worker.Parameters)\n     at Microsoft.WindowsAzure.Hosts.Worker.Loader.Main(System.String[])</p>\n</blockquote>\n\n<p>Source: Application Error</p>\n\n<blockquote>\n  <p>Faulting application name: WaWorkerHost.exe, version: 2.7.1198.768, time stamp: 0x57159090\n  Faulting module name: KERNELBASE.dll, version: 6.3.9600.18340, time stamp: 0x57366075\n  Exception code: 0xe0434352\n  Fault offset: 0x0000000000008a5c\n  Faulting process id: 0xf20\n  Faulting application start time: 0x01d287c5480b416f\n  Faulting application path: E:\\base\\x64\\WaWorkerHost.exe\n  Faulting module path: D:\\Windows\\system32\\KERNELBASE.dll\n  Report Id: 85f9c3f7-f3b8-11e6-80c1-0004ff9da18e\n  Faulting package full name: \n  Faulting package-relative application ID: </p>\n</blockquote>\n\n<p>I've searched for this but haven't come across anyone receiving an error message as generic as this.</p>\n\n<p>My own logging doesn't provide much insight either. All I know is that the WorkerRole doesn't hit the OnStart method.</p>\n\n<p>Are there any other logs that could help narrow down the issue?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "wpf", "excel", "spreadsheetgear"], "comments": [{"owner": {"reputation": 133235, "user_id": 7252182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUgxG.png?s=128&g=1", "display_name": "mm8", "link": "https://stackoverflow.com/users/7252182/mm8"}, "edited": false, "score": 1, "creation_date": 1487190101, "post_id": 42259036, "comment_id": 71676294, "body": "What if you handle the CellEndEdit event instead of the CellBeginEdit event?: <a href=\"https://www.spreadsheetgear.com/support/help/spreadsheetgear.net.7.0/SpreadsheetGear2012.Windows.WPF~SpreadsheetGear.Windows.Controls.WorkbookView~CellEndEdit_EV.html\" rel=\"nofollow noreferrer\">spreadsheetgear.com/support/help/spreadsheetgear.net.7.0/&hellip;</a>"}, {"owner": {"reputation": 2515, "user_id": 233365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zpqdc.jpg?s=128&g=1", "display_name": "Tim Andersen", "link": "https://stackoverflow.com/users/233365/tim-andersen"}, "edited": false, "score": 0, "creation_date": 1487194508, "post_id": 42259036, "comment_id": 71678641, "body": "CellBeginEdit fires when you initially enter &quot;edit mode&quot; for a cell.  You would need to hook into the CellEndEdit(...) event and access the CellEndEditEventArgs.Entry property to get the user-entered value that was committed for the active cell.  That aside, you don&#39;t say what sort of &quot;calculation&quot; you are doing, but can you not just use a worksheet formula in &quot;Cell B&quot; (which presumably refers to Cell A), which would allow SpreadsheetGear to handle the calculation for you?"}], "owner": {"reputation": 1976, "user_id": 68717, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6b386e574a7c0f738bac4b0abb7a5705?s=128&d=identicon&r=PG", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/68717/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487189839, "creation_date": 1487189304, "last_edit_date": 1487189839, "question_id": 42259036, "link": "https://stackoverflow.com/questions/42259036/wpf-spreadsheetgear-app", "title": "WPF/SpreadsheetGear app", "body": "<p>I've a C#/WPF application in which I'm using WorkbookView control.I'm using Spreadsheetgear inside my app.</p>\n\n<p>I've cells A and B in my worksheet.On updating value in A, I need to do some calculations and update value in cell B.\nThe problem is that using the code below, I'm not getting the latest updated value of cell A.\nFor e.g.let's say the current value of A is 1.User changes its value to 2 and wbvOverride_CellBeginEdit method gets invoked.\nIn this method,am always getting value as 1 instead of the new value 2.</p>\n\n<p>What am I missing here please?</p>\n\n<p>Here's my code.</p>\n\n<p>Thanks.</p>\n\n<p>ViewModel:</p>\n\n<pre><code>public void wbvOverride_CellBeginEdit(object sender, SpreadsheetGear.Windows.Controls.CellBeginEditEventArgs e)\n{\n    SpreadsheetGear.Windows.Controls.WorkbookView sheet = sender as SpreadsheetGear.Windows.Controls.WorkbookView;\n    string tempValue = sheet.ActiveCell.Worksheet.Cells[2, 7].Value'\n}\n</code></pre>\n\n<p>XAML:</p>\n\n<pre><code>&lt;Controls:WorkbookView x:Name=\"wbvOverride\" HorizontalAlignment=\"Stretch\" Margin=\"1\" Grid.Row=\"2\" VerticalAlignment=\"Stretch\" ShowError=\"workbookView_ShowError\"  &gt;\n            &lt;i:Interaction.Triggers&gt;\n                &lt;i:EventTrigger EventName=\"CellBeginEdit\"&gt;\n                    &lt;ei:CallMethodAction MethodName=\"wbvOverride_CellBeginEdit\" TargetObject=\"{Binding}\" /&gt;\n                &lt;/i:EventTrigger&gt;        \n        &lt;/i:Interaction.Triggers&gt;\n&lt;/Controls:WorkbookView&gt;\n</code></pre>\n"}, {"tags": ["c#", "loops", "boolean", "try-catch", "do-while"], "answers": [{"tags": [], "owner": {"reputation": 3575, "user_id": 6081445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005fd098b0fa87b368915187a4e588fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Wallis", "link": "https://stackoverflow.com/users/6081445/kevin-wallis"}, "is_accepted": false, "score": 2, "last_activity_date": 1487190400, "last_edit_date": 1487190400, "creation_date": 1487189532, "answer_id": 42259104, "question_id": 42259030, "link": "https://stackoverflow.com/questions/42259030/do-while-wont-loop-with-boolean-test-c/42259104#42259104", "title": "Do while wont loop with boolean test C#", "body": "<p>i would change the <code>if</code>:</p>\n\n<pre><code>if (Length &lt;= 0) { \n    correctInput = false; //Changes correctInput to false if input is less than zero \n} \n</code></pre>\n\n<p>in <strong>C#</strong>, you could also use <code>TryParse</code>, so you do not need the <code>try catch</code>:</p>\n\n<pre><code>int value;\nif (!int.TryParse(rawInput, out value)) {\n    correctInput = false;\n}\n</code></pre>\n\n<p>And the same with your code:</p>\n\n<pre><code>correctInput = false;\ndo { \n    Console.WriteLine(\"Enter the Length: \");\n    rawInput = Console.ReadLine(); \n\n    int value;\n    if (int.TryParse(rawInput, out value) &amp;&amp; value &gt;= 0) {\n        correctInput = true;\n    } else {\n        Console.WriteLine(\"input must be an interger greater than zero.\"); \n    }\n } while (!correctInput);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 5591955, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dziag.jpg?s=128&g=1", "display_name": "DigitalDulphin", "link": "https://stackoverflow.com/users/5591955/digitaldulphin"}, "edited": false, "score": 0, "creation_date": 1487189673, "post_id": 42259129, "comment_id": 71676044, "body": "just saw that... :/"}], "tags": [], "owner": {"reputation": 1724, "user_id": 3241687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d947e2e67319fa6adcf088098adf3079?s=128&d=identicon&r=PG&f=1", "display_name": "horns", "link": "https://stackoverflow.com/users/3241687/horns"}, "is_accepted": true, "score": 1, "last_activity_date": 1487189618, "creation_date": 1487189618, "answer_id": 42259129, "question_id": 42259030, "link": "https://stackoverflow.com/questions/42259030/do-while-wont-loop-with-boolean-test-c/42259129#42259129", "title": "Do while wont loop with boolean test C#", "body": "<p>From your description, you want correctInput to be set to false if Length is <strong>less than</strong> zero, but your code sets it to <code>false</code> if it is <strong>greater than</strong> zero.</p>\n\n<pre><code>            if (Length &gt; 0)\n            {\n                correctInput = false;    //Changes correctInput to false if input is less than zero\n            }\n</code></pre>\n\n<p>It should be:</p>\n\n<pre><code>            if (Length &lt;= 0)\n            {\n                correctInput = false;    //Changes correctInput to false if input is less than zero\n            }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23000, "user_id": 1415614, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/F6BHs.jpg?s=128&g=1", "display_name": "RonC", "link": "https://stackoverflow.com/users/1415614/ronc"}, "is_accepted": false, "score": 0, "last_activity_date": 1487189764, "creation_date": 1487189764, "answer_id": 42259176, "question_id": 42259030, "link": "https://stackoverflow.com/questions/42259030/do-while-wont-loop-with-boolean-test-c/42259176#42259176", "title": "Do while wont loop with boolean test C#", "body": "<p>Based on your comment in this block, you have the wrong operator in the if block:</p>\n\n<pre><code>    if (Length &gt; 0)\n    {\n            correctInput = false;    //Changes correctInput to false if input is less than zero\n    }\n</code></pre>\n\n<p>If you want to change <code>correctInput</code> to false if input is less than 0 then it needs to be </p>\n\n<pre><code>if (Length &lt; 0)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7564947"}, "is_accepted": false, "score": 0, "last_activity_date": 1487189839, "creation_date": 1487189839, "answer_id": 42259193, "question_id": 42259030, "link": "https://stackoverflow.com/questions/42259030/do-while-wont-loop-with-boolean-test-c/42259193#42259193", "title": "Do while wont loop with boolean test C#", "body": "<p>Isn't the problem in this part of your loop?</p>\n\n<pre><code>if (Length &gt; 0)\n{\n    correctInput = false;    //Changes correctInput to false if input is less than zero\n}\n</code></pre>\n\n<p>Shouldn't that read like this instead?</p>\n\n<pre><code>if (Length &lt; 0) \n{\n    correctInput = false; \n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5591955, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dziag.jpg?s=128&g=1", "display_name": "DigitalDulphin", "link": "https://stackoverflow.com/users/5591955/digitaldulphin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 42259129, "answer_count": 4, "score": 0, "last_activity_date": 1487191448, "creation_date": 1487189282, "last_edit_date": 1487191448, "question_id": 42259030, "link": "https://stackoverflow.com/questions/42259030/do-while-wont-loop-with-boolean-test-c", "title": "Do while wont loop with boolean test C#", "body": "<p>My do while loop will not loop when bool correctInput gets changed to false. It is supposed to loop until the input is correctly entered from the use. Acceptable inputs are integers greater than zero. Anything that is an integer will throw the try catch and change correctInput boolean to false causing a loop. If the integer is not greater than zero than correctInput will be turned to false causing a loop. Only when the user enters correct input, the loop should exit. It currently is not looping when the input is incorrect.</p>\n\n<pre><code>  private static void InputMangementShapeSquare()\n    {\n        bool correctInput = true;\n        int Length = 0;\n        string rawInput;\n        do\n        {\n            correctInput = true;\n\n            Console.WriteLine(\"Enter the Length: \");\n            rawInput = Console.ReadLine();\n            try\n            {\n                Length = Int32.Parse(rawInput);\n                if (Length &gt; 0)\n                {\n                    correctInput = false;    //Changes correctInput to false if input is less than zero\n                }\n            }\n            catch (Exception exception)\n            {\n                correctInput = false; //Changes correctInput flag to false when rawinput failed to be converted to integer.\n                Console.WriteLine(\"input must be an interger greater than zero.\");                    \n            }\n\n        } while (correctInput == false);\n\n        Square square = new Square(Length);\n\n    }\n</code></pre>\n"}, {"tags": ["c#", ".net", "reflection", "exception-handling"], "answers": [{"comments": [{"owner": {"reputation": 1324, "user_id": 3606250, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xlRMn.jpg?s=128&g=1", "display_name": "drizin", "link": "https://stackoverflow.com/users/3606250/drizin"}, "edited": false, "score": 0, "creation_date": 1487189775, "post_id": 42259077, "comment_id": 71676101, "body": "Thanks, @stuartd. This is exactly what I was looking for. In case someone wants a brief summary <a href=\"http://stackoverflow.com/a/564697/3606250\">this answer</a> is also helpful."}], "tags": [], "owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "is_accepted": true, "score": 4, "last_activity_date": 1487189463, "creation_date": 1487189463, "answer_id": 42259077, "question_id": 42259007, "link": "https://stackoverflow.com/questions/42259007/catch-exceptions-handled-by-external-assembly/42259077#42259077", "title": "Catch Exceptions handled by External Assembly", "body": "<p>You can subscribe to the <a href=\"https://msdn.microsoft.com/en-us/library/system.appdomain.firstchanceexception.aspx\" rel=\"nofollow noreferrer\">AppDomain.FirstChanceException event</a> to get notified of exceptions:</p>\n\n<blockquote>\n  <p>This event is only a notification. Handling this event does not handle the exception or affect subsequent exception handling in any way. After the event has been raised and event handlers have been invoked, the common language runtime (CLR) begins to search for a handler for the exception. FirstChanceException provides the application domain with a first chance to examine any managed exception.</p>\n</blockquote>\n"}], "owner": {"reputation": 1324, "user_id": 3606250, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xlRMn.jpg?s=128&g=1", "display_name": "drizin", "link": "https://stackoverflow.com/users/3606250/drizin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 42259077, "answer_count": 1, "score": 2, "last_activity_date": 1487189463, "creation_date": 1487189196, "question_id": 42259007, "link": "https://stackoverflow.com/questions/42259007/catch-exceptions-handled-by-external-assembly", "title": "Catch Exceptions handled by External Assembly", "body": "<p>Is it possible to catch Exceptions that are handled by an external (legacy) Assembly?</p>\n\n<p>I don't think I can catch those exceptions since they are already handled, but similarly to Visual Studio \"break on all exceptions\" I thought that maybe I could at least get some notification about the exception.</p>\n\n<p>e.g.: MyProduct.exe calls Utils.dll and Utils.dll is swallowing all exceptions, and doesn't return any information if something wrong happened.</p>\n\n<p>PS: Modifying that external assembly is obviously an alternative, but it's very hard because it's actually spread across hundreds of customized copies</p>\n"}, {"tags": ["c#", "visual-studio", "visual-studio-2015"], "comments": [{"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487189637, "post_id": 42259005, "comment_id": 71676027, "body": "Was anything renamed, moved to another directory, or namespaces changed?"}, {"owner": {"reputation": 1, "user_id": 7571114, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607366089290988/picture?type=large", "display_name": "Umer Armughan Tauni", "link": "https://stackoverflow.com/users/7571114/umer-armughan-tauni"}, "reply_to_user": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487190281, "post_id": 42259005, "comment_id": 71676383, "body": "No i  did not changed anything , i just added publish tools from upgrade installation .."}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487190556, "post_id": 42259005, "comment_id": 71676514, "body": "In that case, I suspect the connection string was changed unintentionally. This error message is described in great detail here: <a href=\"http://stackoverflow.com/questions/689355/metadataexception-unable-to-load-the-specified-metadata-resource\" title=\"metadataexception unable to load the specified metadata resource\">stackoverflow.com/questions/689355/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7571114, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607366089290988/picture?type=large", "display_name": "Umer Armughan Tauni", "link": "https://stackoverflow.com/users/7571114/umer-armughan-tauni"}, "reply_to_user": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487203731, "post_id": 42259005, "comment_id": 71682412, "body": "i dont really dont understand what to do .."}, {"owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "edited": false, "score": 0, "creation_date": 1487248348, "post_id": 42259005, "comment_id": 71704122, "body": "Did you upgrade the project from a previous version of Visual Studio?"}], "owner": {"reputation": 1, "user_id": 7571114, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607366089290988/picture?type=large", "display_name": "Umer Armughan Tauni", "link": "https://stackoverflow.com/users/7571114/umer-armughan-tauni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1590, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487189692, "creation_date": 1487189192, "last_edit_date": 1487189692, "question_id": 42259005, "link": "https://stackoverflow.com/questions/42259005/an-unhandled-exception-of-type-system-data-entity-core-metadataexception-occurre", "title": "An unhandled exception of type System.Data.Entity.Core.MetadataException occurred in EntityFramework dll", "body": "<p><a href=\"https://i.stack.imgur.com/RLMGl.png\" rel=\"nofollow noreferrer\">Error Which i am facing , </a>\ni don't know what happened suddenly, everything was working fine, now its giving me this error !<br>\nAn unhandled exception of type 'System.Data.Entity.Core.MetadataException' occurred in EntityFramework.dll</p>\n\n<p>Additional information: Unable to load the specified metadata resource.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    EMSEntities dbobj = new EMSEntities();\n    int employeesearch = Convert.ToInt32(textBox11.Text);\n\n    int a = 0;\n\n    var result = dbobj.sp_Employee_search(employeesearch).ToList();\n\n    foreach (var r in result)\n    {\n        textBox1.Text = r.Emp_Name;\n        textBox2.Text = Convert.ToString(r.E_ID);\n        textBox3.Text = r.City;\n        textBox4.Text = r.Address;\n        textBox5.Text = r.Gender;\n        textBox6.Text = Convert.ToString(r.Salary);\n        textBox7.Text = Convert.ToString(r.D_ID);\n        textBox8.Text = Convert.ToString(r.DG_ID);\n        textBox9.Text = r.CNIC;\n        textBox10.Text = r.Contact;\n        textBox13.Text = Convert.ToString(r.DOJ);\n        textBox12.Text = r.Age; \n\n        label11.Text = r.E_ID.ToString();\n        a = r.E_ID;\n    }\n    if (a != 0)\n    {\n        MessageBox.Show(\"Employee Found\");\n    }\n    else\n    {\n        MessageBox.Show(\"Please Enter Valid ID!\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "xamarin.forms"], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 6121873, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cc13895806bdd5f2b5ec76b8b2d32835?s=128&d=identicon&r=PG&f=1", "display_name": "jo phul", "link": "https://stackoverflow.com/users/6121873/jo-phul"}, "edited": false, "score": 0, "creation_date": 1487281517, "post_id": 42268548, "comment_id": 71727210, "body": "Awesome!  Thank you."}, {"owner": {"reputation": 559, "user_id": 6121873, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cc13895806bdd5f2b5ec76b8b2d32835?s=128&d=identicon&r=PG&f=1", "display_name": "jo phul", "link": "https://stackoverflow.com/users/6121873/jo-phul"}, "edited": false, "score": 0, "creation_date": 1487350901, "post_id": 42268548, "comment_id": 71761883, "body": "This works well.  Quick question - is it generally advisable to create new views/viewmodels everytime when going to a page?  Or to create the view/viewmodel once, store it in a list, and re-use it."}, {"owner": {"reputation": 7308, "user_id": 405383, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e169f2f42a8369cfdae51218fbcceb33?s=128&d=identicon&r=PG", "display_name": "Hunt", "link": "https://stackoverflow.com/users/405383/hunt"}, "edited": false, "score": 0, "creation_date": 1519816315, "post_id": 42268548, "comment_id": 85060593, "body": "@Stephane what if VIewModel has a parameter constructor  , how to create VM in that case"}], "tags": [], "owner": {"reputation": 15380, "user_id": 1063783, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dae907d26dd200d065227e2a020bc999?s=128&d=identicon&r=PG", "display_name": "Stephane Delcroix", "link": "https://stackoverflow.com/users/1063783/stephane-delcroix"}, "is_accepted": true, "score": 1, "last_activity_date": 1487233703, "creation_date": 1487233703, "answer_id": 42268548, "question_id": 42258911, "link": "https://stackoverflow.com/questions/42258911/c-dynamically-generate-view-and-view-model-based-on-class-type/42268548#42268548", "title": "C# Dynamically generate view and view model based on class type", "body": "<p>quite easy...</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static View CreateView(Type vType, Type vmType)\n{\n    var view = (View)Activator.CreateInstance(vType);\n    view.BindingContext = Activator.CreateInstance(vmType);\n    return view;    \n}\n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 6121873, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cc13895806bdd5f2b5ec76b8b2d32835?s=128&d=identicon&r=PG&f=1", "display_name": "jo phul", "link": "https://stackoverflow.com/users/6121873/jo-phul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 767, "favorite_count": 0, "accepted_answer_id": 42268548, "answer_count": 1, "score": 3, "last_activity_date": 1487233703, "creation_date": 1487188803, "last_edit_date": 1487189767, "question_id": 42258911, "link": "https://stackoverflow.com/questions/42258911/c-dynamically-generate-view-and-view-model-based-on-class-type", "title": "C# Dynamically generate view and view model based on class type", "body": "<p>(Note: I am using Xamarin.Forms and the Rg.Plugins.Popup extension)</p>\n\n<p>Suppose I have the following views:</p>\n\n<pre><code>MyView1.xaml\nMyView2.xaml\nMyView3.xaml\n</code></pre>\n\n<p>And I have their corresponding view models:</p>\n\n<pre><code>MyViewModel1.cs\nMyViewModel2.cs\nMyViewModel3.cs\n</code></pre>\n\n<p>I'd like a method in my navigation controller to show the view based on the type.</p>\n\n<pre><code>NavigationController.ShowView(typeof(MyView1));\n</code></pre>\n\n<p>or maybe</p>\n\n<pre><code>NavigationController.ShowView(typeof(MyView1), typeof(MyViewModel1));\n</code></pre>\n\n<p>How could I implement this? </p>\n\n<p>Currently I am making a list:</p>\n\n<pre><code>{\n    List&lt;MyView&gt; viewList = new List&lt;MyView&gt;();\n\n    MyView1 view1 = new MyView1();\n    MyViewModel1 viewModel1 = new MyViewModel1();\n    view1.BindingContext = viewModel1;\n    viewList.Add(view1);\n    // etc ...\n}\n\nstatic public void ShowView(Type type) \n{\n    foreach (MyView v in viewList) \n    {\n        if (v.GetType() == type)\n        {\n            // code to show the view.\n        }\n    }\n}\n</code></pre>\n\n<p>The problem I am having is that after showing the view, when it is dismissed, it is setting itself to null.  So rather than pre-generate the views and storing them in a list, I'd like to generate new ones.</p>\n"}, {"tags": ["c#", "asp.net", "web", "user-controls"], "comments": [{"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1487192005, "post_id": 42258883, "comment_id": 71677291, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2650059/htmlencode-htmldecode\">HTMLencode HTMLdecode</a>"}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1487192035, "post_id": 42258883, "comment_id": 71677309, "body": "Search for <code>HTMLencode&#47;HTMLdecode</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7570924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a775f3bd94399eb7a21f2f0a9911f0?s=128&d=identicon&r=PG&f=1", "display_name": "MartyP", "link": "https://stackoverflow.com/users/7570924/martyp"}, "is_accepted": false, "score": 0, "last_activity_date": 1487262978, "creation_date": 1487262978, "answer_id": 42279732, "question_id": 42258883, "link": "https://stackoverflow.com/questions/42258883/asp-net-return-user-control-html-text-as-escaped/42279732#42279732", "title": "ASP.Net - Return user control html\\text as escaped", "body": "<p>Thank you to @VDWWD.  Server.HTMLencode helped but my answer was to move the extract of the control's HTML into the Render Event and then Encode it and then write it out during the render.  So the code in the Control look like this:</p>\n\n<pre><code>protected override void Render(HtmlTextWriter writer)\n{\n   TextWriter tw = new StringWriter();\n   HtmlTextWriter htw = new HtmlTextWriter(tw);\n   base.Render(htw);\n   string pageSource = tw.ToString();\n   //--- this is where I encode\\escape the returning HTML  ----\n   pageSource = Server.HtmlEncode(pageSource);\n   writer.Write(pageSource);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7570924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a775f3bd94399eb7a21f2f0a9911f0?s=128&d=identicon&r=PG&f=1", "display_name": "MartyP", "link": "https://stackoverflow.com/users/7570924/martyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487267834, "creation_date": 1487188693, "last_edit_date": 1487267834, "question_id": 42258883, "link": "https://stackoverflow.com/questions/42258883/asp-net-return-user-control-html-text-as-escaped", "title": "ASP.Net - Return user control html\\text as escaped", "body": "<p>[Resolved] - see below\nThis is a twist on the typical question of: 'How to Get the HTML of a User Control?'\nI know how to do this and I have been doing it for years but recently I became more knowledgeable about web security and I noticed that my string (aka Control HTML) is being return to the client as normal HTML and it is not encoded\\escaped.  I know that I can escape it once it gets to the browser using javascript but it would be more secure if it came from the server already escaped.</p>\n\n<p>Currently I am getting something back to the client like:</p>\n\n<pre><code>returnText = \"&lt;input id='myButton' text='whatever'&gt;\"\n</code></pre>\n\n<p>What I am looking for is:</p>\n\n<pre><code>returnText = \"&amp;lt;input%20id='myButton'%20text='whatever'&amp;gt;\"\n</code></pre>\n\n<p>(or something similar)</p>\n\n<p>The code I am using is very typical for these types of calls. My ASCX Response is coded as:</p>\n\n<pre><code>StringBuilder myStringBuilder = new StringBuilder();\nTextWriter myTextWriter = new StringWriter(myStringBuilder);\nHtmlTextWriter myWriter = new HtmlTextWriter(myTextWriter);\nviewControl.RenderControl(myWriter);\nstrControl = myTextWriter.ToString();\n</code></pre>\n\n<p>And I am calling my control on the server using the XMLHTTPRequest object:</p>\n\n<pre><code>function callServer(strPage,qryParms) {\nif (xmlHttp != null) { xmlHttp.abort(); }\nxmlHttp = null;\nvar retValue = \"\";\nxmlHttp = CreateHttpRequest();\nif (xmlHttp == null) {\n    alert(\"Your browser does not support Ajax HTTP Requests\");\n    return;\n}\nelse {\n    xmlHttp.open(\"POST\", strPage, false);\n    xmlHttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n    xmlHttp.onreadystatechange = function () \n        if (xmlHttp.readyState == 4 &amp;&amp; xmlHttp.status == 200) {\n            retValue = xmlHttp.responseText;\n        }\n    }\n    xmlHttp.send(qryParms);\n}\n// retValue = htmlEncode(retValue);  &lt;--- this is where I could convert it.\nreturn retValue;\n}\n</code></pre>\n\n<p>Can I somehow intercept the Response object during the Render process to escape the string before it comes back to the browser?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 5, "creation_date": 1487188639, "post_id": 42258838, "comment_id": 71675443, "body": "Did you try <code>this.Text?</code>"}, {"owner": {"reputation": 2762, "user_id": 1641867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/X2rrS.png?s=128&g=1", "display_name": "ventiseis", "link": "https://stackoverflow.com/users/1641867/ventiseis"}, "edited": false, "score": 0, "creation_date": 1487188740, "post_id": 42258838, "comment_id": 71675511, "body": "Please add some details to your question. Do you mean a form of another application or do you mean your own form?"}, {"owner": {"reputation": 708, "user_id": 5233569, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/713a4cfbb28c405c17d39a07635cb5f0?s=128&d=identicon&r=PG&f=1", "display_name": "UFC Insider", "link": "https://stackoverflow.com/users/5233569/ufc-insider"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1487188829, "post_id": 42258838, "comment_id": 71675554, "body": "@LarsTech That&#39;s what I wanted... Thanks"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7564947"}, "is_accepted": false, "score": 1, "last_activity_date": 1487189401, "last_edit_date": 1495541351, "creation_date": 1487189401, "answer_id": 42259063, "question_id": 42258838, "link": "https://stackoverflow.com/questions/42258838/how-can-i-get-the-window-title-of-the-current-application-form/42259063#42259063", "title": "How can I get the Window title of the current application/form?", "body": "<p>If you're using WinForms, see <a href=\"https://stackoverflow.com/questions/5104175/how-do-you-change-the-text-in-the-titlebar-in-windows-forms\">this answer</a>.</p>\n\n<p>If you're using WPF, see <a href=\"https://stackoverflow.com/questions/28437096/how-do-i-programmatically-change-the-title-in-a-wpf-window\">this answer</a>.</p>\n\n<p>Since you asked about C#, you're probably NOT using the Windows SDK. But if you are, then see <a href=\"https://code.msdn.microsoft.com/windowsapps/C-Getting-the-Windows-da1bd524\" rel=\"nofollow noreferrer\">this page</a>.</p>\n"}], "owner": {"reputation": 708, "user_id": 5233569, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/713a4cfbb28c405c17d39a07635cb5f0?s=128&d=identicon&r=PG&f=1", "display_name": "UFC Insider", "link": "https://stackoverflow.com/users/5233569/ufc-insider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1487189564, "answer_count": 1, "score": 0, "last_activity_date": 1487189401, "creation_date": 1487188559, "question_id": 42258838, "link": "https://stackoverflow.com/questions/42258838/how-can-i-get-the-window-title-of-the-current-application-form", "closed_reason": "Duplicate", "title": "How can I get the Window title of the current application/form?", "body": "<p>I have a windows application with only 1 form. Is there a way to retrieve the window title of this form (when it's running)?</p>\n"}, {"tags": ["c#", "constructor", "static", "extern", "language-specifications"], "comments": [{"owner": {"reputation": 219328, "user_id": 15498, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Wi4EN.png?s=128&g=1", "display_name": "Damien_The_Unbeliever", "link": "https://stackoverflow.com/users/15498/damien-the-unbeliever"}, "edited": false, "score": 0, "creation_date": 1487230083, "post_id": 42258830, "comment_id": 71691351, "body": "I think you&#39;ll find a very similar chunk of text in every subsection of section 10 from 10.6 (Methods) to 10.13 (Destructors). If nothing else, at least it&#39;s <i>consistent</i>."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 1, "creation_date": 1487246967, "post_id": 42258830, "comment_id": 71703130, "body": "The only thing <code>extern</code> does is set the RVA of the method to 0. The runtime is left to figure out the rest. See also <a href=\"http://stackoverflow.com/q/38015024/\">stackoverflow.com/q/38015024</a> . There&#39;s little reason for the language spec to forbid this since the work of the compiler is trivial (it would be more work to outlaw it). Furthermore, since constructors can&#39;t be marked <code>DllImport</code>, the only way to implement such methods is with <code>MethodImplOptions.InternalCall</code>, so the runtime is the only possible consumer, making it even less interesting to explicitly forbid it."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1487247145, "post_id": 42258830, "comment_id": 71703243, "body": "As to why they&#39;re not actually used, that goes in the realm of speculation, but if I was a CLR implementer, I&#39;d strongly prefer doing my static initialization in easy to predict spots, rather than relying on the rather arcane rules for initialization of static types. All of that code calls back into the runtime anyway, so it would do nothing but make my job harder."}, {"owner": {"reputation": 152, "user_id": 7208185, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/m3rqM.jpg?s=128&g=1", "display_name": "Hans", "link": "https://stackoverflow.com/users/7208185/hans"}, "edited": false, "score": 0, "creation_date": 1489054993, "post_id": 42258830, "comment_id": 72507750, "body": "This question looks <a href=\"http://stackoverflow.com/questions/2385589/purpose-of-c-sharp-constructor-extern-modifier\">http://stackoverflow.com/questions/2385589/purpose-of-c-shar&zwnj;&#8203;p-constructor-extern&zwnj;&#8203;-modifier</a>"}, {"owner": {"reputation": 381, "user_id": 4078356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cecfc3083cdb2c51d1238303bc29ef?s=128&d=identicon&r=PG", "display_name": "Andrew Karpov", "link": "https://stackoverflow.com/users/4078356/andrew-karpov"}, "reply_to_user": {"reputation": 25596, "user_id": 3140, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84dbc773c808111cc4ce138bff33f482?s=128&d=identicon&r=PG", "display_name": "Jacob Krall", "link": "https://stackoverflow.com/users/3140/jacob-krall"}, "edited": false, "score": 1, "creation_date": 1490106367, "post_id": 42258830, "comment_id": 72957082, "body": "@JacobKrall That&#39;s not a duplicate. The question you referred is about <i>extern</i> constructors. I explicitly mentioned that I&#39;m aware of their purpose. But my question is about <i>extern static</i> constructors. I haven&#39;t found <i>any</i> usage of them, that&#39;s why I asked the question."}, {"owner": {"reputation": 25596, "user_id": 3140, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/84dbc773c808111cc4ce138bff33f482?s=128&d=identicon&r=PG", "display_name": "Jacob Krall", "link": "https://stackoverflow.com/users/3140/jacob-krall"}, "edited": false, "score": 0, "creation_date": 1490106412, "post_id": 42258830, "comment_id": 72957119, "body": "@AndrewKarpov: retracted; sorry for the confusion!"}], "answers": [{"tags": [], "owner": {"reputation": 1260, "user_id": 435985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LR1h6.png?s=128&g=1", "display_name": "graumanoz", "link": "https://stackoverflow.com/users/435985/graumanoz"}, "is_accepted": false, "score": 1, "last_activity_date": 1490019579, "last_edit_date": 1592644375, "creation_date": 1490019579, "answer_id": 42906024, "question_id": 42258830, "link": "https://stackoverflow.com/questions/42258830/what-is-the-purpose-of-external-static-constructors-in-c/42906024#42906024", "title": "What is the purpose of external static constructors in C#?", "body": "<p>From MSDN:</p>\n<blockquote>\n<p>When a constructor declaration includes an extern modifier, the\nconstructor is said to be an external constructor. Because an external\nconstructor declaration provides no actual implementation, its\nconstructor-body consists of a semicolon.</p>\n<p>...</p>\n</blockquote>\n<p>It seems we can't think of a good reason of using this declaration and it sure correct.\nBut when you dig further you realize there's a whole world of dynamic assembling or - <strong>Code Generation.</strong></p>\n<p>If you were to develop a compiler for the .NET platform you'll probably need some trickery solutions as does the C# compiler use. I can realize that some core implementations uses extern constructor which is implemented somewhere else for good design reasons.</p>\n"}], "owner": {"reputation": 381, "user_id": 4078356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cecfc3083cdb2c51d1238303bc29ef?s=128&d=identicon&r=PG", "display_name": "Andrew Karpov", "link": "https://stackoverflow.com/users/4078356/andrew-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 3, "answer_count": 1, "score": 12, "last_activity_date": 1490105695, "creation_date": 1487188538, "last_edit_date": 1495540971, "question_id": 42258830, "link": "https://stackoverflow.com/questions/42258830/what-is-the-purpose-of-external-static-constructors-in-c", "title": "What is the purpose of external static constructors in C#?", "body": "<p>Accordingly to the section \"10.12 Static constructors\" of \"C# Language Specification. Version 5.0\" static constructor can be marked with \"extern\" modifier and in this case it's said to be an <em>external static constructor</em>.</p>\n\n<p>The ordinary (non-external) static constructors are well known. They are used to initialize static fields and properties.</p>\n\n<p>The external static methods are often used to call native functions via P/Invoke.</p>\n\n<p>And I'm also aware of quite esoteric <em>extern</em> constructors (see also <a href=\"https://stackoverflow.com/questions/2385589/purpose-of-c-sharp-constructor-extern-modifier\">this question</a>). For instance, <code>String</code> class has several such <a href=\"https://github.com/dotnet/coreclr/blob/505d2266d4d10229105408c6f803acb5a017b0fa/src/mscorlib/src/System/String.cs#L208\" rel=\"nofollow noreferrer\">declarations</a>, these constructors are implemented by the runtime.</p>\n\n<p>But are the any real usages of external static constructors? I've searched through the <a href=\"https://github.com/dotnet/coreclr\" rel=\"nofollow noreferrer\">coreclr repo</a> and found nothing. The language specification couldn't give a description to some construct that has never ever been used in the wild. Or could?</p>\n\n<p>My guess: C# has external static constructors just because CLR supports them (in principle).</p>\n"}, {"tags": ["c#", "arrays", "list"], "comments": [{"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 2, "creation_date": 1487188073, "post_id": 42258678, "comment_id": 71675125, "body": "<code>MyList = Myarray.ToList();</code>"}, {"owner": {"reputation": 1702, "user_id": 703161, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/21f3889b711ae6dd796913170199899e?s=128&d=identicon&r=PG", "display_name": "DogEatDog", "link": "https://stackoverflow.com/users/703161/dogeatdog"}, "edited": false, "score": 0, "creation_date": 1487188254, "post_id": 42258678, "comment_id": 71675218, "body": "You&#39;re <code>List</code>  needs to be the same type of the things you&#39;re putting into it. Try <code>&lt;string[]&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 54636, "user_id": 1336654, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b1fcddf43425d951bb5dafef53563d45?s=128&d=identicon&r=PG", "display_name": "Jeppe Stig Nielsen", "link": "https://stackoverflow.com/users/1336654/jeppe-stig-nielsen"}, "edited": false, "score": 0, "creation_date": 1487188272, "post_id": 42258742, "comment_id": 71675234, "body": "Is this .NET/BCL? <code>Arrays.asList</code> and <code>ArrayList&lt;string&gt;</code>?"}, {"owner": {"reputation": 119, "user_id": 7136882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa6af02ade32ca3f4a727a865d7f7d?s=128&d=identicon&r=PG&f=1", "display_name": "Two_Years_Experience", "link": "https://stackoverflow.com/users/7136882/two-years-experience"}, "reply_to_user": {"reputation": 54636, "user_id": 1336654, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b1fcddf43425d951bb5dafef53563d45?s=128&d=identicon&r=PG", "display_name": "Jeppe Stig Nielsen", "link": "https://stackoverflow.com/users/1336654/jeppe-stig-nielsen"}, "edited": false, "score": 0, "creation_date": 1487188492, "post_id": 42258742, "comment_id": 71675347, "body": "@JeppeStigNielsen I&#39;m new and I have only used javascript and BlueJ for my classes. I know what it is, and I believe its not BCL but its how I did it in one of my projects for class."}, {"owner": {"reputation": 119, "user_id": 7136882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa6af02ade32ca3f4a727a865d7f7d?s=128&d=identicon&r=PG&f=1", "display_name": "Two_Years_Experience", "link": "https://stackoverflow.com/users/7136882/two-years-experience"}, "reply_to_user": {"reputation": 54636, "user_id": 1336654, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b1fcddf43425d951bb5dafef53563d45?s=128&d=identicon&r=PG", "display_name": "Jeppe Stig Nielsen", "link": "https://stackoverflow.com/users/1336654/jeppe-stig-nielsen"}, "edited": false, "score": 0, "creation_date": 1487188938, "post_id": 42258742, "comment_id": 71675617, "body": "I am unsure if it is or if its FCL, but I don&#39;t have many years of experience so I don&#39;t know. I am also trying to learn about javascript and BlueJ while attempting to help people."}, {"owner": {"reputation": 54636, "user_id": 1336654, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b1fcddf43425d951bb5dafef53563d45?s=128&d=identicon&r=PG", "display_name": "Jeppe Stig Nielsen", "link": "https://stackoverflow.com/users/1336654/jeppe-stig-nielsen"}, "edited": false, "score": 0, "creation_date": 1487324096, "post_id": 42258742, "comment_id": 71743705, "body": "Since the asker had used the tag <code>[c#]</code>, I did not think JavaScript or BlueJ/Java was relevant to his question."}, {"owner": {"reputation": 119, "user_id": 7136882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa6af02ade32ca3f4a727a865d7f7d?s=128&d=identicon&r=PG&f=1", "display_name": "Two_Years_Experience", "link": "https://stackoverflow.com/users/7136882/two-years-experience"}, "reply_to_user": {"reputation": 54636, "user_id": 1336654, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b1fcddf43425d951bb5dafef53563d45?s=128&d=identicon&r=PG", "display_name": "Jeppe Stig Nielsen", "link": "https://stackoverflow.com/users/1336654/jeppe-stig-nielsen"}, "edited": false, "score": 0, "creation_date": 1487339079, "post_id": 42258742, "comment_id": 71753391, "body": "I what i mean by my last comment is while trying to learn javascript and bluej i&#39;m also on my spare time learning c#"}, {"owner": {"reputation": 119, "user_id": 7136882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa6af02ade32ca3f4a727a865d7f7d?s=128&d=identicon&r=PG&f=1", "display_name": "Two_Years_Experience", "link": "https://stackoverflow.com/users/7136882/two-years-experience"}, "reply_to_user": {"reputation": 54636, "user_id": 1336654, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b1fcddf43425d951bb5dafef53563d45?s=128&d=identicon&r=PG", "display_name": "Jeppe Stig Nielsen", "link": "https://stackoverflow.com/users/1336654/jeppe-stig-nielsen"}, "edited": false, "score": 0, "creation_date": 1487340650, "post_id": 42258742, "comment_id": 71754457, "body": "well actually I&#39;m trying to learn a lot of coding languages but mainly I deal with BlueJ and javascript"}], "tags": [], "owner": {"reputation": 119, "user_id": 7136882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02aa6af02ade32ca3f4a727a865d7f7d?s=128&d=identicon&r=PG&f=1", "display_name": "Two_Years_Experience", "link": "https://stackoverflow.com/users/7136882/two-years-experience"}, "is_accepted": true, "score": 0, "last_activity_date": 1487188178, "creation_date": 1487188178, "answer_id": 42258742, "question_id": 42258678, "link": "https://stackoverflow.com/questions/42258678/how-to-place-an-array-like-a-row-in-a-liststring/42258742#42258742", "title": "How to place an Array like a row in a List&lt;string&gt;", "body": "<pre><code>List&lt;String&gt; strings = Arrays.asList(new String[]{\"one\", \"two\", \"three\"});\n</code></pre>\n\n<p>This is a list view of the array, the list is partly unmodifiable, you can't add or delete elements. But the time complexity is O(1).</p>\n\n<p>If you want a modifiable a List:</p>\n\n<pre><code>List&lt;String&gt; strings = \n     new ArrayList&lt;String&gt;(Arrays.asList(new String[]{\"one\", \"two\", \"three\"}));\n</code></pre>\n\n<p>This will copy all elements from the source array into a new list (complexity: O(n))</p>\n"}], "owner": {"reputation": 43, "user_id": 7569210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002de45c398e2ce58093659b07411b05?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/7569210/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "closed_date": 1487188119, "accepted_answer_id": 42258742, "answer_count": 1, "score": 0, "last_activity_date": 1487189369, "creation_date": 1487187943, "last_edit_date": 1487189369, "question_id": 42258678, "link": "https://stackoverflow.com/questions/42258678/how-to-place-an-array-like-a-row-in-a-liststring", "closed_reason": "Duplicate", "title": "How to place an Array like a row in a List&lt;string&gt;", "body": "<p>How do I place an Array like a row in a List? </p>\n\n<p>For Example:</p>\n\n<pre><code> string[] Myarray = new string[] {\"A\",\"B\", \"C\"};\n List&lt;string&gt; MyList = new List&lt;string&gt;() { Myarray[0], Myarray[1], Myarray[2] };\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 2762, "user_id": 1641867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/X2rrS.png?s=128&g=1", "display_name": "ventiseis", "link": "https://stackoverflow.com/users/1641867/ventiseis"}, "edited": false, "score": 1, "creation_date": 1487188280, "post_id": 42258672, "comment_id": 71675240, "body": "Please can you clarify your question a little? Can you show some code? Do you mean a splash screen with <i>launcher</i>? What UI framework are you using (<code>WPF</code>, <code>WinForms</code> or something different)? Without further details, you question can&#39;t be answered..."}, {"owner": {"reputation": 49, "user_id": 3334475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e97c13a76d6c735d77ea0c19634395f5?s=128&d=identicon&r=PG&f=1", "display_name": "Gulumal", "link": "https://stackoverflow.com/users/3334475/gulumal"}, "reply_to_user": {"reputation": 2762, "user_id": 1641867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/X2rrS.png?s=128&g=1", "display_name": "ventiseis", "link": "https://stackoverflow.com/users/1641867/ventiseis"}, "edited": false, "score": 0, "creation_date": 1487968189, "post_id": 42258672, "comment_id": 72039004, "body": "sorry, the form is launched from another library which I don&#39;t have access to. However I worked on the actual form.."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 3334475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e97c13a76d6c735d77ea0c19634395f5?s=128&d=identicon&r=PG&f=1", "display_name": "Gulumal", "link": "https://stackoverflow.com/users/3334475/gulumal"}, "edited": false, "score": 0, "creation_date": 1487968303, "post_id": 42259762, "comment_id": 72039055, "body": "Appreciate your answer. The form launch is called from a library and it is outside of my area. That team took ownership of this issue. I forwarded your answer to them. Once again thanks for your input!"}], "tags": [], "owner": {"reputation": 3977, "user_id": 4009517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K0Fvo.png?s=128&g=1", "display_name": "Silas Reinagel", "link": "https://stackoverflow.com/users/4009517/silas-reinagel"}, "is_accepted": true, "score": 1, "last_activity_date": 1487192329, "last_edit_date": 1487192329, "creation_date": 1487191789, "answer_id": 42259762, "question_id": 42258672, "link": "https://stackoverflow.com/questions/42258672/modal-dialog-box-is-shown-below-the-launching-screen-in-windows-10/42259762#42259762", "title": "Modal Dialog box is shown below the launching screen in windows 10", "body": "<p>Use the MessageBox.Show overload that allows you to specific a parent window:\n<a href=\"https://msdn.microsoft.com/en-us/library/cked7698(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/cked7698(v=vs.110).aspx</a></p>\n\n<p>If you are using WPF/UWP, you can write something like this:</p>\n\n<pre><code>Application.Current.Dispatcher.Invoke(DispatcherPriority.Normal, \n    () =&gt; MessageBox.Show(Application.Current.MainWindow, msg));\n</code></pre>\n\n<p>An alternative way to hack the same functionality without a specific window is this:</p>\n\n<pre><code>Application.Current.Dispatcher.Invoke(DispatcherPriority.Normal, \n    () =&gt; MessageBox.Show(new Form { TopMost = true }, msg);\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3334475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e97c13a76d6c735d77ea0c19634395f5?s=128&d=identicon&r=PG&f=1", "display_name": "Gulumal", "link": "https://stackoverflow.com/users/3334475/gulumal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 1, "accepted_answer_id": 42259762, "answer_count": 1, "score": 0, "last_activity_date": 1487192329, "creation_date": 1487187920, "question_id": 42258672, "link": "https://stackoverflow.com/questions/42258672/modal-dialog-box-is-shown-below-the-launching-screen-in-windows-10", "title": "Modal Dialog box is shown below the launching screen in windows 10", "body": "<p>In one of our windows apps, a dialog box is launched using MessageBox.Show, which is working fine on win 7 and 8. But on Win 10, the popup is shown below the launcher. Any guess how to rectify this?</p>\n\n<p>thanks</p>\n"}, {"tags": ["c#", "asp.net", "sql-server"], "comments": [{"owner": {"reputation": 2710, "user_id": 7193132, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3aAPt.jpg?s=128&g=1", "display_name": "Masoud Andalibi", "link": "https://stackoverflow.com/users/7193132/masoud-andalibi"}, "edited": false, "score": 0, "creation_date": 1487189277, "post_id": 42258660, "comment_id": 71675823, "body": "why would you approach this like above?!"}, {"owner": {"reputation": 173, "user_id": 7044405, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f742859043d35ddb70d58dd4b5c0c582?s=128&d=identicon&r=PG&f=1", "display_name": "Navid", "link": "https://stackoverflow.com/users/7044405/navid"}, "reply_to_user": {"reputation": 2710, "user_id": 7193132, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3aAPt.jpg?s=128&g=1", "display_name": "Masoud Andalibi", "link": "https://stackoverflow.com/users/7193132/masoud-andalibi"}, "edited": false, "score": 0, "creation_date": 1487189399, "post_id": 42258660, "comment_id": 71675893, "body": "This approach increases the readability and in case you wanna change the connection string, you only need to do it once."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1487190487, "post_id": 42258660, "comment_id": 71676478, "body": "This is a very bad idea. You need to learn about <a href=\"https://msdn.microsoft.com/en-us/library/system.idisposable(v=vs.110).aspx\" rel=\"nofollow noreferrer\">IDisposable</a>, which SqlConnection implements."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1487196938, "post_id": 42258660, "comment_id": 71679866, "body": "I concur, this is a bad idea.  SQL connections are pooled for you automatically.  There is zero reason to do this."}, {"owner": {"reputation": 94, "user_id": 4216412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNXoi.jpg?s=128&g=1", "display_name": "williamscodes", "link": "https://stackoverflow.com/users/4216412/williamscodes"}, "edited": false, "score": 0, "creation_date": 1487217759, "post_id": 42258660, "comment_id": 71686329, "body": "In your current implementation you will need to explicitly close the connection and dispose of resources, such as SqlDataReader. I must concur with Mason and Amy utilizing IDisposible or utilizing the using statement which essentially implements a try finally block. This allows the system to manage and free those resources. Stated differently, it prevents forgotten resource management and cleanup."}], "owner": {"reputation": 173, "user_id": 7044405, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f742859043d35ddb70d58dd4b5c0c582?s=128&d=identicon&r=PG&f=1", "display_name": "Navid", "link": "https://stackoverflow.com/users/7044405/navid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487197730, "creation_date": 1487187890, "question_id": 42258660, "link": "https://stackoverflow.com/questions/42258660/asp-net-c-managing-connections-in-public-class", "title": "ASP.net C# : Managing connections in public class", "body": "<p>I am beginner in ASP.net. Trying to develop a class to manage  my sql connections. I have saved my connection string in my webconfig. \nThe only problem I face is with this class all my connections remain open.\nHow can I close a connection using constructors in my class?</p>\n\n<pre><code> public class DBSettings\n{\n    static string DBConn\n\n    {\n        get { return ConfigurationManager.ConnectionStrings[\"DBConnection\"].ConnectionString; }\n    }\n\n\n    public static SqlConnection sqlConn\n    {\n        get\n        {\n            SqlConnection Conn = new SqlConnection(DBConn);\n            Conn.Open();\n            return Conn;\n        }\n    }\n\n\n\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "http"], "answers": [{"comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 1, "creation_date": 1487190001, "post_id": 42258853, "comment_id": 71676235, "body": "Mixing ContinueWith and async/await leads to problems, just do <code>await Request.Content.ReadAsMultipartAsync(streamProvider);</code> and everything in the <code>.ContinueWith</code> would just go after the <code>await</code> like normal code."}, {"owner": {"reputation": 65, "user_id": 7500599, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91b6ba293278890bcef7a3ed335c7c92?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian18", "link": "https://stackoverflow.com/users/7500599/cristian18"}, "edited": false, "score": 0, "creation_date": 1487247180, "post_id": 42258853, "comment_id": 71703263, "body": "But I am using .NET 4.0, and cannot do this. I believe that is better use just return."}, {"owner": {"reputation": 1660, "user_id": 2329663, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/51c6ebd1d71376f03ce60859238088ec?s=128&d=identicon&r=PG", "display_name": "Lukas Kolletzki", "link": "https://stackoverflow.com/users/2329663/lukas-kolletzki"}, "edited": false, "score": 0, "creation_date": 1487248009, "post_id": 42258853, "comment_id": 71703874, "body": "If returning works for you, it&#39;s fine. Otherwise you can take a look at this package, it basically adds async/await support to .NET 4.0 www.nuget.org/packages/Microsoft.Bcl.Async"}], "tags": [], "owner": {"reputation": 1660, "user_id": 2329663, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/51c6ebd1d71376f03ce60859238088ec?s=128&d=identicon&r=PG", "display_name": "Lukas Kolletzki", "link": "https://stackoverflow.com/users/2329663/lukas-kolletzki"}, "is_accepted": true, "score": 0, "last_activity_date": 1487188601, "creation_date": 1487188601, "answer_id": 42258853, "question_id": 42258657, "link": "https://stackoverflow.com/questions/42258657/readasmultipartasync-not-works/42258853#42258853", "title": "ReadAsMultipartAsync not works", "body": "<p>In the first example, you are not processing the returned task from <code>ReadAsMultipartAsync</code>. The method immediately exits.</p>\n\n<p>In the second example, you give the task to the base class, which handles the task for you and waits for it's execution.</p>\n\n<p>If you do not want to return the task, e.g. if you want to do something after it finishes, you can mark your method as <code>async</code> and <code>await</code> the task like so:</p>\n\n<pre><code>[AcceptVerbs(\"POST\")]\npublic async Task AddFile()\n{\n    if (!Request.Content.IsMimeMultipartContent(\"form-data\"))\n    {\n        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);\n    }            \n\n    var streamProvider = new MultipartFormDataMemoryStreamProvider();\n    await Request.Content.ReadAsMultipartAsync(streamProvider).ContinueWith(t =&gt;\n    {\n        ....\n    });\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7500599, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/91b6ba293278890bcef7a3ed335c7c92?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian18", "link": "https://stackoverflow.com/users/7500599/cristian18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 42258853, "answer_count": 1, "score": 0, "last_activity_date": 1487188601, "creation_date": 1487187864, "question_id": 42258657, "link": "https://stackoverflow.com/questions/42258657/readasmultipartasync-not-works", "title": "ReadAsMultipartAsync not works", "body": "<p>I want know if anyone know because is happening this:</p>\n\n<p><em>This not works:</em></p>\n\n<pre><code>[AcceptVerbs(\"POST\")]\npublic void AddFile()\n{\n    if (!Request.Content.IsMimeMultipartContent(\"form-data\"))\n    {\n        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);\n    }            \n\n    var streamProvider = new MultipartFormDataMemoryStreamProvider();\n    Request.Content.ReadAsMultipartAsync(streamProvider).ContinueWith(t =&gt;\n    {\n        ....\n    });\n}\n</code></pre>\n\n<p><em>But this if it works(<strong>is the the correct solution?</strong>):</em></p>\n\n<pre><code>[AcceptVerbs(\"POST\")]\npublic Task AddFile()\n{\n    if (!Request.Content.IsMimeMultipartContent(\"form-data\"))\n    {\n        throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);\n    }            \n\n    var streamProvider = new MultipartFormDataMemoryStreamProvider();\n    return Request.Content.ReadAsMultipartAsync(streamProvider).ContinueWith(t =&gt;\n    {\n        ....\n    });\n}\n</code></pre>\n"}, {"tags": ["c#", "sdk", "netscaler"], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 4668193, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/37da9945602522cb1cd758354248afd9?s=128&d=identicon&r=PG&f=1", "display_name": "maltman", "link": "https://stackoverflow.com/users/4668193/maltman"}, "is_accepted": true, "score": 1, "last_activity_date": 1487190470, "creation_date": 1487190470, "answer_id": 42259378, "question_id": 42258609, "link": "https://stackoverflow.com/questions/42258609/netscaler-nitro-api-cannot-get-service-groups/42259378#42259378", "title": "Netscaler Nitro API cannot get Service Groups", "body": "<p>I figured it out.</p>\n\n<p>I defined my servicegroup before my foreach.</p>\n\n<pre><code>var serviceGroups = lbvserver_servicegroup_binding.get(session, vip.name);\n</code></pre>\n\n<p>Then added an if serviceGroups !=null</p>\n"}], "owner": {"reputation": 334, "user_id": 4668193, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/37da9945602522cb1cd758354248afd9?s=128&d=identicon&r=PG&f=1", "display_name": "maltman", "link": "https://stackoverflow.com/users/4668193/maltman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 42259378, "answer_count": 1, "score": 0, "last_activity_date": 1487190470, "creation_date": 1487187695, "question_id": 42258609, "link": "https://stackoverflow.com/questions/42258609/netscaler-nitro-api-cannot-get-service-groups", "title": "Netscaler Nitro API cannot get Service Groups", "body": "<p>I am trying to use the .NET API to disable servers in my Netscaler.  I am able to get a list of VIPs and get a list of servers associated with those VIPs.  However, some VIPs have service groups associated with them.  This is where I am running into an issue.  When I reach a VIP that has a service group, I get a null exception error.  I am not sure where the service group information is stored in the VIP.  Here is my code:</p>\n\n<pre><code>nitro_service session = new nitro_service(\"&lt;netscaler-IP&gt;\");\nsession.login(\"&lt;username&gt;\", \"&lt;password&gt;\");\n\nvar lbServers = lbvserver.get(session);\n\nforeach (var vip in lbServers)\n{\n    foreach (var service in lbvserver_servicegroup_binding.get(session, vip.name))\n    {\n        Console.WriteLine(vip.name);\n        Console.Write(service.servicegroupname);\n        Console.WriteLine(service.servicename);\n        Console.ReadLine();\n    }\n}\n</code></pre>\n\n<p>I have tried checking to see if servicegroupname is null but it is always null, regardless if there is a service group or server associated with the VIP.</p>\n\n<p>I have also tried to just get the service group without the VIP but lbvserver_servicegroup_binding only takes 2 arguments.</p>\n"}, {"tags": ["c#", "linq", "linq-to-sql", "linq-to-entities"], "comments": [{"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1487187713, "post_id": 42258543, "comment_id": 71674927, "body": "You simply forgot to add the join condition to <code>Any</code>: <code>&amp;&amp; x.LIST_NO == m.LIST_NO</code>"}, {"owner": {"reputation": 309, "user_id": 1497983, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8855beffa8b115f792121642178b01ac?s=128&d=identicon&r=PG", "display_name": "B Vidhya", "link": "https://stackoverflow.com/users/1497983/b-vidhya"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1487188117, "post_id": 42258543, "comment_id": 71675147, "body": "Could you plz provide me where to add that. I tried it throws error"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1487188208, "post_id": 42258543, "comment_id": 71675199, "body": "<code>query = query.Where(m =&gt; parts.Any(x =&gt; x.TAG == &quot;PART00213&quot; &amp;&amp;  x.STATUS == &quot;NEW&quot; &amp;&amp; x.LIST_NO == m.LIST_NO));</code>"}, {"owner": {"reputation": 309, "user_id": 1497983, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8855beffa8b115f792121642178b01ac?s=128&d=identicon&r=PG", "display_name": "B Vidhya", "link": "https://stackoverflow.com/users/1497983/b-vidhya"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1487189360, "post_id": 42258543, "comment_id": 71675868, "body": "Thanks, it worked!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7547416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f8499fa32ec605c8e73c21f0a44224?s=128&d=identicon&r=PG&f=1", "display_name": "SomeGuy1234", "link": "https://stackoverflow.com/users/7547416/someguy1234"}, "is_accepted": false, "score": 0, "last_activity_date": 1487188428, "creation_date": 1487188428, "answer_id": 42258804, "question_id": 42258543, "link": "https://stackoverflow.com/questions/42258543/compare-two-iqueryables-based-on-a-condition/42258804#42258804", "title": "Compare two Iqueryables based on a condition", "body": "<p>Try this:</p>\n\n<pre><code>IQueryable&lt;A_LIST&gt; query = ctx.getA();\nvar partsIds = ctx.getB().Where(s=&gt;s.TAG == \"PART00213\" &amp;&amp; s.STATUS == \"NEW\").Select(s=&gt;s.LIST_NO);\n\nquery = query.Where(q=&gt;partsIds.Contains(q.LIST_NO));\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 1497983, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8855beffa8b115f792121642178b01ac?s=128&d=identicon&r=PG", "display_name": "B Vidhya", "link": "https://stackoverflow.com/users/1497983/b-vidhya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487248553, "creation_date": 1487187479, "last_edit_date": 1487248553, "question_id": 42258543, "link": "https://stackoverflow.com/questions/42258543/compare-two-iqueryables-based-on-a-condition", "title": "Compare two Iqueryables based on a condition", "body": "<p>I have two IQueryables A and B. I need to select all the columns from A based on id available in A and B and also more conditions apply on B list. Here I don't need to do a select from B I only need to select from A but based on conditions that apply on B. I tried the below linq query but performance wise it takes atleast 18 sec to load the data which is too long. I'm trying to refactor the linq query but fails to do the filter. Below I've provided my code that was working but takes too long to load.</p>\n\n<pre><code>IQueryable&lt;A_LIST&gt; query = ctx.getA();\nIQueryable&lt;B_List&gt; parts = ctx.getB();\n\nquery = (from q in query\n         join s in parts\n         on q.LIST_NO equals s.LIST_NO\n         where s.TAG == \"PART00213\" &amp;&amp; s.STATUS == \"NEW\"\n         select q).Distinct();\n</code></pre>\n\n<p>Query that did not work</p>\n\n<pre><code>query = query.Where(m =&gt; parts.Any(x =&gt; x.TAG == \"PART00213\" &amp;&amp;        \n&amp;&amp; STATUS == \"NEW\"));\n</code></pre>\n"}, {"tags": ["c#", "wpf", "event-handling", "serial-port"], "comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1487188235, "post_id": 42258470, "comment_id": 71675214, "body": "Show us <code>Console.Write(testString);</code>"}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "reply_to_user": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1487188641, "post_id": 42258470, "comment_id": 71675445, "body": "First iteration is empty but then it looks normally, like <code>x1-1</code>, <code>x2-1</code>"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1487188718, "post_id": 42258470, "comment_id": 71675501, "body": "And if you put a breakpoint on your &#39;if&#39; statement, does teststring ever equal &quot;x1-1&#39;? If so, your UI thread is never getting a chance to redraw because you&#39;re doing a <code>while(true)</code>... you&#39;re hammering the CPU. Prove it to yourself -- open up task manager and see if a core spikes at 100%. Consider updating the UI on a timer that executes every 300-500ms. It&#39;ll give the UI thread a chance to do its work."}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "reply_to_user": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1487188941, "post_id": 42258470, "comment_id": 71675622, "body": "sometimes <code>x1-1</code>, sometimes <code>x2-1</code>. The buffer with data is like <code>x1-1 x1-1 x1-1 x1-1 x2-1</code> etc. There is no other options."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1487189008, "post_id": 42258470, "comment_id": 71675670, "body": "Yeah.. never use a while(true) loop on the UI thread. You&#39;re hanging it."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487191932, "post_id": 42258934, "comment_id": 71677259, "body": "There is problem with this part of code:             <code>if (testString == &quot;x1-1&quot;) EllipseBrush = Brushes.Blue;             else EllipseBrush = Brushes.Red;</code> because EllipseBrush can&#39;t be use in this place in this static context"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487193195, "post_id": 42258934, "comment_id": 71677954, "body": "You can remove <code>static</code> from the function. I have updated the answer. Also, I just wrote a test app and this works."}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487194040, "post_id": 42258934, "comment_id": 71678390, "body": "It&#39;s good to know. Well, so thanks. I will try to do it tommorow, I have to find information how to make what you wrote below the code, because it&#39;s not so obvious to me."}], "tags": [], "owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "is_accepted": true, "score": 1, "last_activity_date": 1487194352, "last_edit_date": 1487194352, "creation_date": 1487188919, "answer_id": 42258934, "question_id": 42258470, "link": "https://stackoverflow.com/questions/42258470/doing-something-while-receiving-data-from-serial-port-in-wpf/42258934#42258934", "title": "Doing something while receiving data from serial port in WPF", "body": "<p>I believe you are going about this the wrong way. Instead of constantly checking the value of <code>teststring</code> you need to just start the comm port listener and let it run in the background - as this will be on it's own thread. Then you need to create a Data Binding to the color. Whenever the comm port listener parses a string, it can automatically update the color.</p>\n\n<p>First, in the CommPort class:</p>\n\n<pre><code>class MyCommPort : INotifyPropertyChanged\n{\n    SerialPort serialPort = null;\n    public MyCommPort()\n    {\n        serialPort = new SerialPort(\"COM3\", 9600);\n        serialPort.DataReceived += new SerialDataReceivedEventHandler(DataReceivedHandler);\n        serialPort.Open();\n    }\n    ~MyCommPort()\n    {\n        serialPort.Close();\n    }\n\n    private void DataReceivedHandler(object sender, SerialDataReceivedEventArgs e)\n    {\n        SerialPort sp = (SerialPort)sender;\n        string testString = null;\n        string indata = sp.ReadLine();\n        if (indata.Length &gt;= 4)\n        {\n            testString = indata.Substring(0, 4);\n            // Update the value\n            if (testString == \"x1-1\") EllipseBrush = Brushes.Blue;\n            else EllipseBrush = Brushes.Red;\n        }\n        Console.Write(testString);\n    }\n\n    // Create a property that will be bound\n    private SolidColorBrush ellipseBrush = Brushes.Red;\n    public SolidColorBrush EllipseBrush\n    {\n        get { return ellipseBrush; }\n        set\n        {\n            ellipseBrush = value;\n            OnPropertyChanged(\"EllipseBrush\");\n        }\n    }\n\n    // Extend the INotifyPropertyChanged interface\n    public event PropertyChangedEventHandler PropertyChanged;\n    private void OnPropertyChanged(string propertyName)\n    {\n        if (PropertyChanged != null)\n        {\n            // Alert anyone bound to this that the value has changed\n            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n        }\n    }\n}\n</code></pre>\n\n<p>Then, set the Ellipse's DataContext to the CommPort class and bind the Ellipse's Fill property to EllipseBrush.\nNow all you have to do is start the Commport listener (<code>ReceiveData();</code>) and the color updates should happen automatically.</p>\n\n<p>For example: MainWindow.xaml</p>\n\n<pre><code>&lt;Window x:Class=\"delete_me.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n    &lt;Grid&gt;\n        &lt;Ellipse x:Name=\"ellipse\" Fill=\"{Binding Path=EllipseBrush}\" /&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>And the code behind: MainWindow.xaml.cs</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n        ellipse.DataContext = new MyCommPort();\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487190994, "post_id": 42259139, "comment_id": 71676750, "body": "What is difference between <code>EllipseBrush = Brushes.Blue;</code> and <code>x1.Fill = Brushes.Blue</code>? With <code>EllipseBrush = Brushes.Blue;</code> it can&#39;t be compile becouse missing declaration, with <code>x1.Fill = Brushes.Blue</code> it&#39;s still doesn&#39;t work."}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487191171, "post_id": 42259139, "comment_id": 71676877, "body": "But it still doesn&#39;t work. The bug has to be in other place."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487193089, "post_id": 42259139, "comment_id": 71677895, "body": "I&#39;ve edited the code in the Timer_Tick event. If you update it to what I have, and you breakpoint the code, and step into it, what do you see happen?"}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487193550, "post_id": 42259139, "comment_id": 71678161, "body": "Program can&#39;t stop there. It seems like it has never been used."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487194881, "post_id": 42259139, "comment_id": 71678814, "body": "Sounds like you were making edits while the program was running?"}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487195234, "post_id": 42259139, "comment_id": 71679000, "body": "No, I meant, that breakpoint in if statement in <code>MyTimer_Tick event</code> is not reachable."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487195319, "post_id": 42259139, "comment_id": 71679061, "body": "I&#39;m so sorry... I never had you start the timer."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487195553, "post_id": 42259139, "comment_id": 71679166, "body": "I added a line to start the timer. Sorry about that."}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487195855, "post_id": 42259139, "comment_id": 71679326, "body": "Hehe, I&#39;m sure it would make a problem but with that line it&#39;s still the same situation. Program can&#39;t stop in <code>MyTimer_Tick</code> function :("}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487196008, "post_id": 42259139, "comment_id": 71679397, "body": "You&#39;re saying that you never see the breakpoint hit at all, when you put the breakpoint on the &#39;if&#39; statement, right?"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487196094, "post_id": 42259139, "comment_id": 71679437, "body": "When the program is running, is the breakpoint a solid red dot, or an outline of a red circle?"}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487196266, "post_id": 42259139, "comment_id": 71679522, "body": "It&#39;s a solid red dot, I put it on if, and on else."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487197097, "post_id": 42259139, "comment_id": 71679955, "body": "I used the wrong Timespan constructor. Change it to (0,0,0,0,500) (just add one extra 0)."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487197132, "post_id": 42259139, "comment_id": 71679974, "body": "It would have eventually executed... after 500 seconds! :( Once again...sorry. Answer edited."}, {"owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487197417, "post_id": 42259139, "comment_id": 71680123, "body": "Yay, it works now. I am grateful for the help. You don&#39;t have to apologize :) I&#39;m glad it works :) :)"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "edited": false, "score": 0, "creation_date": 1487197471, "post_id": 42259139, "comment_id": 71680150, "body": "Wonderful -- for what it&#39;s worth, you should look into using the MVVM pattern with DataBinding. It makes WPF so much cleaner :)"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1487255343, "post_id": 42259139, "comment_id": 71709648, "body": "This a very poor design. The SerialPort class is event driven but you are using a timer to poll it. That doesn&#39;t make any sense. Think of it like this: your friend is coming over. Do you a) check the front door every 5 seconds to see if someone is there? Or b) go do other things and only go to the door when the bell rings?"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1487255785, "post_id": 42259139, "comment_id": 71709989, "body": "@johnny I assume you&#39;ve not experienced needing to debounce a device before. You claim poor design, but if we are going to use your analogy, then consider this: your friends are ringing the doorbell incessantly. You can a) get nothing done because you are answering the door constantly or b) only check periodically."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1487256485, "post_id": 42259139, "comment_id": 71710520, "body": "I have lots of experience with serial ports and have never needed to debounce any incoming data. Also, OP mentions no need for this. If a flood of repeated messages is an issue, you can still use an event-driven design. A simple check like <code>if (currentMsg == this.lastMsg) return;</code> in the event handler will discard repeated messages."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 0, "creation_date": 1487257007, "post_id": 42259139, "comment_id": 71710954, "body": "Your check fails for cases where multiple message types exist, and data is being streamed rapidly with frequent variations. Also, I do not see the OP mentioning &quot;no need for this&quot;."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1487258307, "post_id": 42259139, "comment_id": 71712008, "body": "The check can easily be expanded for different messages....Without more info about the speed and type of incoming data, we can only agree to disagree. There are cases where polling the port may be desired, but using <code>SerialDataReceivedEventHandler</code> callback doesn&#39;t make sense in that scenario."}], "tags": [], "owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "is_accepted": false, "score": 0, "last_activity_date": 1487197114, "last_edit_date": 1487197114, "creation_date": 1487189648, "answer_id": 42259139, "question_id": 42258470, "link": "https://stackoverflow.com/questions/42258470/doing-something-while-receiving-data-from-serial-port-in-wpf/42259139#42259139", "title": "Doing something while receiving data from serial port in WPF", "body": "<p>Don't hang the UI thread by having a <code>while(true)</code> inside of a button click event. Use a DispatchTimer to do work every 500s instead. </p>\n\n<pre><code>System.Windows.Threading.DispatcherTimer MyTimer = null;\nprivate void ReceiveData()\n{\n    MyTimer = new System.Windows.Threading.DispatcherTimer();\n    MyTimer.Interval = new TimeSpan(0, 0, 0, 0, 500);\n    MyTimer.Tick += MyTimer_Tick;\n    MyTimer.Start();\n    SerialPort serialPort = new SerialPort(\"COM1\", 9600);\n    serialPort.DataReceived += new \n             SerialDataReceivedEventHandler(DataReceivedHandler);\n    serialPort.Open();\n}\n\nprivate static void DataReceivedHandler(\n                object sender,\n                SerialDataReceivedEventArgs e)\n{\n    SerialPort sp = (SerialPort)sender;\n    string indata = sp.ReadExisting();\n    if (indata.Contains(\" \"))\n    {\n        testString = indata.Substring(0, 4);\n\n    }\n}\n\nprivate void button1_Click(object sender, RoutedEventArgs e)\n{\n    ReceiveData();\n}\n\nprivate void MyTimer_Tick(object sender, EventArgs e)\n{\n    if (testString == \"x1-1\")\n    {\n       x1.Fill = Brushes.Blue;\n    }\n    else \n    {\n       x1.Fill = Brushes.Red;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5180353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683dd57bfda8e3a085d004ccb6f41a14?s=128&d=identicon&r=PG&f=1", "display_name": "Vades", "link": "https://stackoverflow.com/users/5180353/vades"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1654, "favorite_count": 1, "accepted_answer_id": 42258934, "answer_count": 2, "score": 3, "last_activity_date": 1487197114, "creation_date": 1487187154, "last_edit_date": 1487188059, "question_id": 42258470, "link": "https://stackoverflow.com/questions/42258470/doing-something-while-receiving-data-from-serial-port-in-wpf", "title": "Doing something while receiving data from serial port in WPF", "body": "<p>I want to create program, that will color ellipse in any way depending on the received data in \"real time\". The data is like: <code>x1-1</code>, <code>x2-1</code> etc.</p>\n\n<p>I have strange problem, I can see while debugging that, color of filling ellipse should change, but it doesn't happen.</p>\n\n<p>Part of my code with receiving data:    </p>\n\n<pre><code> private void ReceiveData()\n            {\n                SerialPort serialPort = new SerialPort(\"COM1\", 9600);\n                serialPort.DataReceived += new SerialDataReceivedEventHandler(DataReceivedHandler);\n                serialPort.Open();\n            }\n\n private static void DataReceivedHandler(\n                object sender,\n                SerialDataReceivedEventArgs e)\n            {\n                SerialPort sp = (SerialPort)sender;\n                string indata = sp.ReadExisting();\n                if (indata.Contains(\" \"))\n                {\n                    testString = indata.Substring(0, 4);\n\n                }\n                Console.Write(indata);\n            }\n</code></pre>\n\n<p>I can see received data in console, even after click on button, that starts receiving data. The <code>testString</code> is to extract single <code>x1-1</code> from <code>indata</code>, that is still growing during receiving data. I know that it doesn't work like it should but it doesn't matter now.</p>\n\n<p>Code of action on button:</p>\n\n<pre><code> private void button1_Click(object sender, RoutedEventArgs e)\n        {\n            ReceiveData();\n            while (true)\n            {\n                if (testString == \"x1-1\") x1.Fill = Brushes.Blue;\n                else x1.Fill = Brushes.Red;\n            }\n        }\n</code></pre>\n\n<p><code>x1</code> is ellipse that I want to make red or blue. I can set the breakpoint in this function and I can see that it should change. I think the problem is, that program is waiting for close port and finish transmission, and then maybe it would change, but I need to have it in \"real time\". Anyone knows how to do it?</p>\n"}, {"tags": ["c#", ".net", "lambda", "closures"], "comments": [{"owner": {"reputation": 2454, "user_id": 2607840, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/odHBN.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/2607840/cameron"}, "edited": false, "score": 1, "creation_date": 1487187232, "post_id": 42258450, "comment_id": 71674666, "body": "FWIW, that code doesn&#39;t compile. <code>Any()</code> is an extension method off of <code>IEnumerable&lt;T&gt;</code> and is expecting a <code>Func&lt;T, bool&gt;</code> not <code>Action</code>."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 2454, "user_id": 2607840, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/odHBN.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/2607840/cameron"}, "edited": false, "score": 0, "creation_date": 1487187299, "post_id": 42258450, "comment_id": 71674707, "body": "@Cameron Unless they have their own <code>Console</code> class with their own <code>WriteLine</code> method that returns a boolean.  (And also their own <code>Any</code> extension method for <code>IList</code>, since the LINQ <code>Any</code> method doesn&#39;t take an <code>IList</code>)."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1487187336, "post_id": 42258450, "comment_id": 71674727, "body": "All local variables are stored on the execution stack."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1487187401, "post_id": 42258450, "comment_id": 71674755, "body": "@jdweng That&#39;s simply wrong, as is the case for the code shown here, and it even contains the quote form the language docs explaining where the local is stored (and how it couldn&#39;t be on the stack).  Closures couldn&#39;t possibly work if the variable needed to be stored on the stack, as the variable needs to exist after the method has completed, which can&#39;t happen if it&#39;s stored on the stack."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1487187668, "post_id": 42258450, "comment_id": 71674896, "body": "First, memory has to be some place and local variables are placed on stack.  Second i is not part of the lambda expression so the quote from the language doc doesn&#39;t apply."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1487188114, "post_id": 42258450, "comment_id": 71675143, "body": "@jdweng Yes, memory has to be in some place, but local variables are not necessarily placed on the stack. Sometimes they&#39;re stored in registers, sometimes they&#39;re hoisted to be fields of a compiler generated class, like here, or in cases of iterator blocks or <code>async</code> methods, and yes, <i>sometimes</i> they&#39;re on the stack.  As to this case, yes <code>i</code> is used in the lambda expression (and declared outside of it), so the quote from the language docs does apply."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1487193329, "post_id": 42258450, "comment_id": 71678035, "body": "You are not correct.  A lambda is  compiled method like every compiled method has a parameter list.  &#39;i&#39; is passed to the compiled code in the parameter list and is still a local variable.  When a local variable is a class object it is a local variable pointer to the class space and the pointer is on the stack.  Yes in some cases the compiler will store local variables in a register, but that is rare and only occurs over a few lines of source code."}], "answers": [{"tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": true, "score": 3, "last_activity_date": 1487187239, "creation_date": 1487187239, "answer_id": 42258488, "question_id": 42258450, "link": "https://stackoverflow.com/questions/42258450/when-a-variable-is-closed-twice-where-is-it-stored/42258488#42258488", "title": "When a variable is closed twice, where is it stored?", "body": "<p>There is only one closure class for that method, rather than one per anonymous method.  That <em>one</em> class will have two instance methods and a field.  The field will store the value of <code>i</code>, and the two methods will each correspond to your two anonymous methods.</p>\n"}], "owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 42258488, "answer_count": 1, "score": 4, "last_activity_date": 1487189348, "creation_date": 1487187073, "last_edit_date": 1487189348, "question_id": 42258450, "link": "https://stackoverflow.com/questions/42258450/when-a-variable-is-closed-twice-where-is-it-stored", "title": "When a variable is closed twice, where is it stored?", "body": "<p>I was reading with interesting this article called <a href=\"http://www.codethinked.com/c-closures-explained\" rel=\"nofollow noreferrer\">C# Closures Explained</a>, which states:</p>\n\n<blockquote>\n  <p>You see, the C# compiler detects when a delegate forms a closure which is passed out of the current scope and it promotes the delegate, and the associated local variables into a compiler generated class. This way, it simply needs a bit of compiler trickery to pass around an instance of the compiler generated class, so each time we invoke the delegate we are actually calling the method on this class.</p>\n</blockquote>\n\n<p>So essentially a closed variable is stored as a member variable of an anonymous class that also contains the delegate representing the lambda expression or other code that is closing over the variable.</p>\n\n<p>If that is the case, what happens when a method contains two different lambda expressions and both of them reference the same local variable?</p>\n\n<pre><code>void Test(IList list)\n{\n    int i = 0;\n\n    list.Any( a =&gt; { Console.WriteLine(\"Lambda one says: {0}\", i++); return true;} )\n        .Any( a =&gt; { Console.WriteLine(\"Lambda two says: {0}\", i++); return true;} );\n\n}\n</code></pre>\n\n<p>I'm pretty sure I know the behavior here.  My question is, where exactly is <code>i</code> stored?</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 15061, "user_id": 1287857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ENQC5.jpg?s=128&g=1", "display_name": "Akash KC", "link": "https://stackoverflow.com/users/1287857/akash-kc"}, "edited": false, "score": 1, "creation_date": 1487187558, "post_id": 42258440, "comment_id": 71674835, "body": "AFAIK, full file path can not passed from browser due to security reason. I am in confused, why do you want to get user&#39;s local file path?"}, {"owner": {"reputation": 103, "user_id": 4956826, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76e6eaf1d97ffd1f9f9a4cceafd2c5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4956826/will"}, "reply_to_user": {"reputation": 15061, "user_id": 1287857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ENQC5.jpg?s=128&g=1", "display_name": "Akash KC", "link": "https://stackoverflow.com/users/1287857/akash-kc"}, "edited": false, "score": 0, "creation_date": 1487187755, "post_id": 42258440, "comment_id": 71674946, "body": "So that the user can upload a pdf file to the database."}, {"owner": {"reputation": 15061, "user_id": 1287857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ENQC5.jpg?s=128&g=1", "display_name": "Akash KC", "link": "https://stackoverflow.com/users/1287857/akash-kc"}, "edited": false, "score": 0, "creation_date": 1487188824, "post_id": 42258440, "comment_id": 71675550, "body": "I&#39;ve posted an answer for uploading file in asp.net mvc"}, {"owner": {"reputation": 103, "user_id": 4956826, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76e6eaf1d97ffd1f9f9a4cceafd2c5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4956826/will"}, "reply_to_user": {"reputation": 15061, "user_id": 1287857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ENQC5.jpg?s=128&g=1", "display_name": "Akash KC", "link": "https://stackoverflow.com/users/1287857/akash-kc"}, "edited": false, "score": 0, "creation_date": 1487189547, "post_id": 42258440, "comment_id": 71675983, "body": "Thank you everybody for all the responses!  You&#39;ve all given some wonderful avenues to pursue, and I&#39;ll be accepting an answer within the next couple of hours after I see what works best!"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 7541104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccd594a52443200bccbe98f19e79429f?s=128&d=identicon&r=PG&f=1", "display_name": "CodeNinja", "link": "https://stackoverflow.com/users/7541104/codeninja"}, "is_accepted": false, "score": 0, "last_activity_date": 1487188054, "last_edit_date": 1495535375, "creation_date": 1487188054, "answer_id": 42258707, "question_id": 42258440, "link": "https://stackoverflow.com/questions/42258440/how-to-pass-a-user-selected-filepath-as-a-string/42258707#42258707", "title": "How to pass a user-selected filepath as a string", "body": "<p>You should be able to get the full path from openFileDialog object.FileName</p>\n\n<pre><code>OpenFileDialog object= new OpenFileDialog();\nstring fullPath = object.FileName;\n</code></pre>\n\n<p>Or </p>\n\n<p>You can also look into other options like using FolderBrowserDialog.</p>\n\n<p>Refer to <a href=\"https://stackoverflow.com/a/24450050/7541104\">this</a> example. </p>\n\n<p>I hope that helps!</p>\n"}, {"tags": [], "owner": {"reputation": 2959, "user_id": 819153, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a691c06e10ba780802b6df69be781637?s=128&d=identicon&r=PG", "display_name": "Zinov", "link": "https://stackoverflow.com/users/819153/zinov"}, "is_accepted": false, "score": 0, "last_activity_date": 1487188116, "creation_date": 1487188116, "answer_id": 42258725, "question_id": 42258440, "link": "https://stackoverflow.com/questions/42258440/how-to-pass-a-user-selected-filepath-as-a-string/42258725#42258725", "title": "How to pass a user-selected filepath as a string", "body": "<p>Your question is not clear, actually you posted the tag using asp.net mvc and you are using the OpenFileDialog? is this related with Windows Forms, or with a web application? If it is the latter check below</p>\n\n<p>Try to use an HttpPostedFileBase, from there you can get the path</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.web.httppostedfilebase.filename(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.web.httppostedfilebase.filename(v=vs.110).aspx</a></p>\n\n<pre><code>[HttpPost]\npublic ActionResult Upload(HttpPostedFileBase file)\n{...}\n</code></pre>\n\n<p>create the ModelBinder </p>\n\n<pre><code>public class HttpOdometerPostedFileBaseModelBinder : IModelBinder\n    {\n        public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)\n        {\n            if(controllerContext == null)\n                throw new ArgumentNullException(nameof(controllerContext));\n\n            if(bindingContext == null)\n                throw new ArgumentNullException(nameof(bindingContext));\n\n            HttpPostedFileBase theFile = controllerContext.HttpContext.Request.Files[bindingContext.ModelName];\n\n            return theFile;\n        }\n    }\n</code></pre>\n\n<p>and register it on the global.asax.cs</p>\n\n<pre><code>System.Web.Mvc.ModelBinders.Binders[typeof(HttpPostedFileBase)] = new HttpOdometerPostedFileBaseModelBinder();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15061, "user_id": 1287857, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ENQC5.jpg?s=128&g=1", "display_name": "Akash KC", "link": "https://stackoverflow.com/users/1287857/akash-kc"}, "is_accepted": false, "score": 0, "last_activity_date": 1487188337, "creation_date": 1487188337, "answer_id": 42258782, "question_id": 42258440, "link": "https://stackoverflow.com/questions/42258440/how-to-pass-a-user-selected-filepath-as-a-string/42258782#42258782", "title": "How to pass a user-selected filepath as a string", "body": "<p>I suspect by looking at your code, you are assuming getting file in web as similar to desktop version. In desktop version, you can get full path and read stream accordingly. But in web, browser will pass stream (for file type input) instead of passing filepath. So, you just need to have action which can catch your file stream.</p>\n\n<p>You can do with <a href=\"https://msdn.microsoft.com/en-us/library/system.web.httppostedfilebase%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">HttpPostedFileBase</a> and it'll gives you stream, filename and contentlength.</p>\n\n<p>You action method should be like this :</p>\n\n<pre><code>[HttpPost]  \npublic ActionResult MyUploadingAction(HttpPostedFileBase file)  \n{  \n    var filename = file.FileName; \n    // For reading stream\n    var reader = new BinaryReader(file.InputStream);\n    byte[] byteData= reader.ReadBytes(file.InputStream.Length);\n\n\n    return View();  \n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4956826, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76e6eaf1d97ffd1f9f9a4cceafd2c5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4956826/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1487188337, "creation_date": 1487187034, "question_id": 42258440, "link": "https://stackoverflow.com/questions/42258440/how-to-pass-a-user-selected-filepath-as-a-string", "title": "How to pass a user-selected filepath as a string", "body": "<p>So I have the following method that I cannot alter:</p>\n\n<pre><code>    public async Task&lt;User&gt; UploadSaa(string filepath, User user)\n    {\n\n        Assembly cesCommon = Assembly.GetExecutingAssembly();\n        byte[] saaBytes = null;\n        using (Stream saarStream = cesCommon.GetManifestResourceStream(name))\n        using (MemoryStream saaMemoryStream = new MemoryStream())\n        {\n            saaStream.CopyTo(saarMemoryStream);\n            saaBytes = saaMemoryStream.ToArray();\n            user.Saa = saaBytes;\n        }\n        user = await SaveNewUser(user);\n        return user;\n    }\n</code></pre>\n\n<p>In previous usages of it, filepath was passed directly to it in order to initialize the database for testing.  However, now I need to find a way to pass a variable string to UploadSaa(), b/c in production, the user will be selecting their own file from their own system, and I can't dictate the filepath to them.  I tried to use OpenFileDialog, but that returns a file, not a path</p>\n\n<p>My questions are: How can I modify the OpenFileDialog to accept a path to a file, which can then be passed to UploadSaa?  Is there a better option?  If I must modify UploadSaa, what should the changes be?</p>\n"}, {"tags": ["c#", "forms", "password-protection"], "comments": [{"owner": {"reputation": 3330, "user_id": 5507624, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Wz96B.jpg?s=128&g=1", "display_name": "Ian H.", "link": "https://stackoverflow.com/users/5507624/ian-h"}, "edited": false, "score": 0, "creation_date": 1487187085, "post_id": 42258429, "comment_id": 71674600, "body": "Are y&#243;u just stuck continuing? Or is there an error in the code?"}, {"owner": {"reputation": 91, "user_id": 7426954, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-O1gqohyIOMk/AAAAAAAAAAI/AAAAAAAAAyU/MjijkyBFHrE/photo.jpg?sz=128", "display_name": "Sharabeel Shah", "link": "https://stackoverflow.com/users/7426954/sharabeel-shah"}, "reply_to_user": {"reputation": 3330, "user_id": 5507624, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Wz96B.jpg?s=128&g=1", "display_name": "Ian H.", "link": "https://stackoverflow.com/users/5507624/ian-h"}, "edited": false, "score": 0, "creation_date": 1487189146, "post_id": 42258429, "comment_id": 71675750, "body": "@IanH. I&#39;m stuck and have no idea how to carry on so it&#39;s a global password authentication forms within the name space for other forms"}], "owner": {"reputation": 91, "user_id": 7426954, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-O1gqohyIOMk/AAAAAAAAAAI/AAAAAAAAAyU/MjijkyBFHrE/photo.jpg?sz=128", "display_name": "Sharabeel Shah", "link": "https://stackoverflow.com/users/7426954/sharabeel-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487186988, "creation_date": 1487186988, "question_id": 42258429, "link": "https://stackoverflow.com/questions/42258429/password-form-which-will-be-called-in-other-forms-to-authenticate-other-form-acc", "title": "password form which will be called in other forms to authenticate other form access in c#", "body": "<p>I previously made a string password which worked, however cannot be used in other forms to authenticate. So I created a local server database table which contained the password. Then I called this table and password into the GetPass form which is the form used to authenticate access to other forms. However, due to limited knowledge, I'm struggling to make this happen, any tips or examples will be much appreciated. ( within the code methods from the string password attempt are still visible)</p>\n\n<pre><code>namespace BooyaaBrowser\n{\n    public partial class GetPass : Form\n    {\n        SqlConnection con = new SqlConnection(@\"Data Source=(LocalDb)\\MSSQLLocalDB;Initial Catalog=BooyaaBrowser;Integrated Security=True\");\n\n        private TextBox PasstextBox;\n        private Button btn_confirm;\n        private Label EnterPass;\n        private string refPassword;\n\n\n\n        public GetPass(string Password)\n        {\n\n\n                InitializeComponent();\n                refPassword = Password;\n\n            } \n\n\n\n        private void btn_confirm_Click(object sender, EventArgs e)\n        {\n\n            try\n            {\n\n                   con.Open();\n                SqlCommand cmd = con.CreateCommand();\n                cmd.CommandType = CommandType.Text;\n                cmd.CommandText = \"select * from password where password =('\" + PasstextBox.Text + \"')\";\n                cmd.ExecuteNonQuery();\n\n                con.Close();\n\n            }\n            catch (Exception)\n            {\n\n            }\n           // string password = PasstextBox.Text;\n            //if (password.CompareTo(refPassword) == 0)\n           // {\n           //     this.DialogResult = DialogResult.OK;\n            }\n           // this.Close();\n</code></pre>\n"}, {"tags": ["c#", ".net", "singleton"], "comments": [{"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 3, "creation_date": 1487186932, "post_id": 42258375, "comment_id": 71674514, "body": "This is not Singleton implementation at all. What you created is just shared static variable of <b>another</b> type."}], "answers": [{"comments": [{"owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "edited": false, "score": 0, "creation_date": 1487187767, "post_id": 42258481, "comment_id": 71674954, "body": "I think what I am looking for is not a simple Singleton then.  I may have to post another question in a bit.  Thank you for the answer!"}, {"owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "edited": false, "score": 0, "creation_date": 1487190968, "post_id": 42258481, "comment_id": 71676733, "body": "Incase anyone is interested, I posted my follow up question to this one here: <a href=\"http://stackoverflow.com/q/42259505/16241\">stackoverflow.com/q/42259505/16241</a>"}], "tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": true, "score": 3, "last_activity_date": 1487187203, "creation_date": 1487187203, "answer_id": 42258481, "question_id": 42258375, "link": "https://stackoverflow.com/questions/42258375/simpler-singleton-based-on-jon-skeets-singleton/42258481#42258481", "title": "Simpler Singleton Based on Jon Skeet&#39;s Singleton", "body": "<blockquote>\n  <p>Do any of my steps make my class not a good Singleton implementation any more?</p>\n</blockquote>\n\n<p>Yes, they do.</p>\n\n<p>The behavior you removed in Step #1 is an implementation detail anyway. Removing the empty static constructor is fine; if you want to force lazy init, <code>Lazy&lt;T&gt;</code> is a better way anyway even if it has slightly more overhead.</p>\n\n<p>At Step #2, your object stopped being a singleton at all, because you no longer have control over how many instances of the object (<code>Logging</code>) are created.</p>\n\n<p>I'd say that not being a singleton at all qualifies as being \"not a good Singleton implementation\".</p>\n"}], "owner": {"reputation": 69684, "user_id": 16241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/de3fa0861da7fd9ae3abc120ff6d957f?s=128&d=identicon&r=PG", "display_name": "Vaccano", "link": "https://stackoverflow.com/users/16241/vaccano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 42258481, "answer_count": 1, "score": 4, "last_activity_date": 1487187203, "creation_date": 1487186777, "question_id": 42258375, "link": "https://stackoverflow.com/questions/42258375/simpler-singleton-based-on-jon-skeets-singleton", "title": "Simpler Singleton Based on Jon Skeet&#39;s Singleton", "body": "<p>I need a singleton in my code.  I read Jon Skeet's <a href=\"http://csharpindepth.com/Articles/General/Singleton.aspx\" rel=\"nofollow noreferrer\">page</a> on Singletons and selected this model (#4) based on his recommendation:</p>\n\n<pre><code>public sealed class Singleton\n{\n    private static readonly Singleton instance = new Singleton();\n\n    // Explicit static constructor to tell C# compiler\n    // not to mark type as beforefieldinit\n    static Singleton(){}\n\n    private Singleton(){}\n\n    public static Singleton Instance\n    {\n        get\n        {\n            return instance;\n        }\n    }\n}\n</code></pre>\n\n<p>I then went through a few steps to modify this to fit my scenario:</p>\n\n<p><strong>Step 1:</strong> I don't need a lazy implementation, so I took out the static constructor (as suggested by Jon at the end of his article):</p>\n\n<pre><code>public sealed class Singleton\n{\n    private static readonly Singleton instance = new Singleton();\n\n    private Singleton(){}\n\n    public static Singleton Instance\n    {\n        get\n        {\n            return instance;\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Step 2:</strong> I then swapped out the \"instance\" <code>Singleton</code> class with the <code>Logging</code> class I am working with :</p>\n\n<pre><code>public sealed class Singleton\n{\n    private static readonly Logging instance = new Logging();\n\n    private Singleton(){}\n\n    public static Logging Instance\n    {\n        get\n        {\n            return instance;\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Step 3:</strong> Resharper then told me that I should use an auto property for my \"Instance\" property:</p>\n\n<pre><code>public sealed class Singleton\n{\n    private Singleton(){}\n\n    public static Logging Instance { get; } = new Logging();\n}\n</code></pre>\n\n<p><strong>Step 4:</strong> Resharper then told me I should switch this to a static class:</p>\n\n<pre><code>public static class Singleton\n{\n    public static Logging Instance { get; } = new Logging();\n}\n</code></pre>\n\n<p>What I am left with is very different from the original. I know that it is very easy to get things wrong when setting up a thread safe Singleton.  </p>\n\n<p>So I wanted to ask: <strong>Do any of my steps make my class not a good Singleton implementation any more?</strong></p>\n"}, {"tags": ["c#", ".net", "entity-framework", "azure"], "comments": [{"owner": {"reputation": 23000, "user_id": 1415614, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/F6BHs.jpg?s=128&g=1", "display_name": "RonC", "link": "https://stackoverflow.com/users/1415614/ronc"}, "edited": false, "score": 1, "creation_date": 1487189975, "post_id": 42258356, "comment_id": 71676219, "body": "It&#39;s best to use the title to ask a question or at least to make a problem statement.  Using it to provide info about the general context of the issue without stating the issue or question makes it hard for others find the answer to solve their similar problem."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6225304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60ff667c9a3774ff0148cee188853452?s=128&d=identicon&r=PG&f=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/6225304/patrick"}, "edited": false, "score": 0, "creation_date": 1487190859, "post_id": 42258421, "comment_id": 71676668, "body": "Will it publish all the layers for suppose other than mvc layer if i right click on other layer application i don&#39;t see the publish option i have entity framework in the application and i don&#39;t know if my applicationpublished entity framework or not?"}, {"owner": {"reputation": 358, "user_id": 3155785, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5af5ac37332ca605373fc9b8de11d64e?s=128&d=identicon&r=PG&f=1", "display_name": "let_the_coding_begin", "link": "https://stackoverflow.com/users/3155785/let-the-coding-begin"}, "reply_to_user": {"reputation": 53, "user_id": 6225304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60ff667c9a3774ff0148cee188853452?s=128&d=identicon&r=PG&f=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/6225304/patrick"}, "edited": false, "score": 0, "creation_date": 1487191681, "post_id": 42258421, "comment_id": 71677131, "body": "@patrick If you are using Entity Framework you should have its dll referenced in the project anyways so it will be published. And also yes it compiles your project (and therefore all the dependencies such as the Business Logic Layer and Data Access Layer) and copies over the binaries."}], "tags": [], "owner": {"reputation": 358, "user_id": 3155785, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5af5ac37332ca605373fc9b8de11d64e?s=128&d=identicon&r=PG&f=1", "display_name": "let_the_coding_begin", "link": "https://stackoverflow.com/users/3155785/let-the-coding-begin"}, "is_accepted": true, "score": 2, "last_activity_date": 1487186954, "creation_date": 1487186954, "answer_id": 42258421, "question_id": 42258356, "link": "https://stackoverflow.com/questions/42258356/i-have-a-asp-net-mvc-application-divided-into-multiple-layers/42258421#42258421", "title": "I have a asp.net mvc application divided into multiple layers.", "body": "<p>You should be able to deploy directly into azure through Visual Studio. Right click on your project and Click on publish. You can find a more detailed tutorial on <a href=\"https://blogs.msdn.microsoft.com/uk_faculty_connection/2015/07/20/using-visual-studio-2015-and-deploying-your-first-web-app-to-your-free-azure-subscription/\" rel=\"nofollow noreferrer\">MSDN website</a></p>\n"}], "owner": {"reputation": 53, "user_id": 6225304, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60ff667c9a3774ff0148cee188853452?s=128&d=identicon&r=PG&f=1", "display_name": "patrick", "link": "https://stackoverflow.com/users/6225304/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 42258421, "answer_count": 1, "score": -3, "last_activity_date": 1487186954, "creation_date": 1487186671, "question_id": 42258356, "link": "https://stackoverflow.com/questions/42258356/i-have-a-asp-net-mvc-application-divided-into-multiple-layers", "title": "I have a asp.net mvc application divided into multiple layers.", "body": "<p>now how i can deploy the application into azure with different layers. I have a data access layer business logic layer and mvc application layer? </p>\n"}, {"tags": ["c#", "nlog"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5314244"}, "edited": false, "score": 0, "creation_date": 1487188187, "post_id": 42258394, "comment_id": 71675184, "body": "are you talking about this `Logger logger = LogManager.GetLogger(&quot;SomeNamespace.Component&quot;); logger.Debug(&quot;...&quot;) will write to file or u mean something else?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5314244"}, "edited": false, "score": 0, "creation_date": 1487188218, "post_id": 42258394, "comment_id": 71675207, "body": "it would be helpful if you come with small example for this <code>SomeNamespace.Component</code>"}, {"owner": {"reputation": 214980, "user_id": 470005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09536b39b586f3ae555f8ce20d5d8bd1?s=128&d=identicon&r=PG", "display_name": "Sergey Berezovskiy", "link": "https://stackoverflow.com/users/470005/sergey-berezovskiy"}, "edited": false, "score": 0, "creation_date": 1487192602, "post_id": 42258394, "comment_id": 71677619, "body": "@Tridip I mean if you have namespace <code>namespace SomeNamespace.Component.Foo { ... }</code> and you have class <code>Bar</code> declared in that namespace with loger (inside Bar) then logger name will be <code>SomeNamespace.Component.Foo.Bar</code> and it will match rule pattern"}], "tags": [], "owner": {"reputation": 214980, "user_id": 470005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09536b39b586f3ae555f8ce20d5d8bd1?s=128&d=identicon&r=PG", "display_name": "Sergey Berezovskiy", "link": "https://stackoverflow.com/users/470005/sergey-berezovskiy"}, "is_accepted": true, "score": 1, "last_activity_date": 1487187623, "last_edit_date": 1487187623, "creation_date": 1487186854, "answer_id": 42258394, "question_id": 42258351, "link": "https://stackoverflow.com/questions/42258351/c-regarding-nlog-settings-and-usage/42258394#42258394", "title": "C#: Regarding Nlog settings and usage", "body": "<blockquote>\n  <p>what does mean here SomeNamespace.Component.* ?</p>\n</blockquote>\n\n<p>It means that this rule will match any loggers which have name starting with <code>SomeNamespace.Component.</code>. Usually name of logger equals name of class where you are creating logger (but you also can provide custom logger name):</p>\n\n<pre><code>private static readonly Logger Logger = LogManager.GetCurrentClassLogger();\n</code></pre>\n\n<p>So rule configuration above will match following logger names:</p>\n\n<pre><code>SomeNamespace.Component.MyClass\nSomeNamespace.Component.Cool.Other.Namespace.YourClass\n// etc\n</code></pre>\n\n<p>I.e. any logger created in class from <code>SomeNamespace.Component.</code> namespace will match rule. No matter how many classes with loggers you have there.</p>\n\n<blockquote>\n  <p>what is minlevel=\"Info\" ?</p>\n</blockquote>\n\n<p>It's a minimal level of log messages which will be logged by logger.</p>\n\n<pre><code>Logger.Debug(\"This will not be logged\");\nLogger.Info(\"This will be logged\");\n</code></pre>\n\n<p>NLog supports following log levels (you can use any of them to control which messages will be logged):     </p>\n\n<ol>\n<li>Trace</li>\n<li>Debug</li>\n<li>Info</li>\n<li>Warn</li>\n<li>Error</li>\n<li>Fatal</li>\n</ol>\n\n<p>Check description of each level at <a href=\"https://github.com/NLog/NLog/wiki/Tutorial#log-levels\" rel=\"nofollow noreferrer\">NLog wiki</a>. Usually you should use min level <code>Info</code> which will log any error messages and some high-level details of what system is doing. For debugging purpose you can turn-on <code>Trace</code> or <code>Debug</code> level, but your log file can become huge very quickly. Performance also will hurt when you are writing lot of log messages.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5314244"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 42258394, "answer_count": 1, "score": 0, "last_activity_date": 1487187929, "creation_date": 1487186659, "last_edit_date": 1487187929, "question_id": 42258351, "link": "https://stackoverflow.com/questions/42258351/c-regarding-nlog-settings-and-usage", "title": "C#: Regarding Nlog settings and usage", "body": "<p>i am curious to use nlog. i did not use it previously. so i like to use it now in my project. i have a question.</p>\n\n<pre><code>&lt;rules&gt;\n    &lt;logger name=\"SomeNamespace.Component.*\" minlevel=\"Trace\" writeTo=\"logfile\" final=\"true\" /&gt;\n    &lt;logger name=\"*\" minlevel=\"Info\" writeTo=\"logfile\" /&gt;\n&lt;/rules&gt;\n</code></pre>\n\n<p>what does mean here SomeNamespace.Component.* ? show me the usage of this type of rule with sample code</p>\n\n<p>what is <code>minlevel=\"Info\"</code> ? what does mean <strong>minlevel</strong> here ?\nwhat other option can be set for <strong>minlevel</strong> ?</p>\n\n<p>thanks</p>\n"}, {"tags": ["c#", ".net", "datetime", "concurrency", "tearing"], "comments": [{"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1487187838, "post_id": 42258346, "comment_id": 71674994, "body": "probably the most definitive answer you can get: &quot;I don&#39;t think so.&quot;"}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 3, "creation_date": 1487188003, "post_id": 42258346, "comment_id": 71675077, "body": "@MikeNakis I also &quot;don&#39;t think so&quot; but <code>ConcurrentDictionary</code>&#39;s implementation doesn&#39;t treat <code>DateTime</code> as atomic, which makes me wonder: <a href=\"https://github.com/dotnet/corefx/blob/master/src/System.Collections.Concurrent/src/System/Collections/Concurrent/ConcurrentDictionary.cs#L87\" rel=\"nofollow noreferrer\">ConcurrentDictionary.IsValueWriteAtomic</a>"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 4, "creation_date": 1487188626, "post_id": 42258346, "comment_id": 71675432, "body": "@i3arnon: The code lists a bunch of integral types with a comment pointing to the CLI reference. The CLI reference only deals with sizes, not types, and I seriously doubt DateTime would ever use an explicitly misaligned field, so I think it&#39;s safe to conclude that <code>DateTime</code> is atomic."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 3, "creation_date": 1487191948, "post_id": 42258346, "comment_id": 71677266, "body": "This is quite strange.  The standard says that all modifications to values no larger than the native int size shall be atomic, and <code>DateTime</code> fits this category on a 64-bit system. However, <code>ConcurrentDictionary</code> appears to be much more conservative than the standard: it will not consider no-larger-than-native-int <code>struct</code>s as atomic, it will only consider built-in primitive data types as atomic.  Conventional wisdom says it is probably a flaw in <code>ConcurrentDictionary</code>, but note how I am writing a comment and not an answer! C-:="}, {"owner": {"reputation": 22993, "user_id": 1394393, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mSjIL.jpg?s=128&g=1", "display_name": "jpmc26", "link": "https://stackoverflow.com/users/1394393/jpmc26"}, "edited": false, "score": 2, "creation_date": 1487204346, "post_id": 42258346, "comment_id": 71682593, "body": "To me, the bigger question is, &quot;Why do you care?&quot; Why spend all this time trying to figure it out instead of just assuming it&#39;s <i>not</i> safe and writing your code under that assumption? I&#39;m not sure I&#39;d count on MS to follow the specification even if it does say it&#39;s safe. ;) So this feels like an XY-problem to me."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 22993, "user_id": 1394393, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mSjIL.jpg?s=128&g=1", "display_name": "jpmc26", "link": "https://stackoverflow.com/users/1394393/jpmc26"}, "edited": false, "score": 6, "creation_date": 1487210556, "post_id": 42258346, "comment_id": 71684302, "body": "@jpmc26 just setting a value instead of taking a lock is extremely beneficial in highly concurrent scenarios. I care because caring enables me to break bottlenecks and improve the performance of my product."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1487210742, "post_id": 42258346, "comment_id": 71684350, "body": "@HansPassant Why is that an issue? What does setting automatic layout cause?"}, {"owner": {"reputation": 11986, "user_id": 812837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l9uC.jpg?s=128&g=1", "display_name": "Clockwork-Muse", "link": "https://stackoverflow.com/users/812837/clockwork-muse"}, "edited": false, "score": 0, "creation_date": 1487216476, "post_id": 42258346, "comment_id": 71685956, "body": "@i3arnon - <a href=\"http://stackoverflow.com/questions/4132533/why-does-layoutkind-sequential-work-differently-if-a-struct-contains-a-datetime\">probably funny things like this</a>.  I don&#39;t know about other shenanigans.  Personally, I rather more dislike <code>DateTime</code> et al. and the shape of the API (which unfortunately works just well enough for the simple cases).  There&#39;s some random gotchas which make certain use cases impossible to solve natively."}, {"owner": {"reputation": 21007, "user_id": 276083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90e1eb7c2e486f1706a9d940372a2e69?s=128&d=identicon&r=PG", "display_name": "Eli Arbel", "link": "https://stackoverflow.com/users/276083/eli-arbel"}, "edited": false, "score": 1, "creation_date": 1487230108, "post_id": 42258346, "comment_id": 71691363, "body": "@i3arnon If in doubt, I&#39;d store the ticks in a <code>long</code> field, and wrap it in a <code>DateTime</code> property. Zero risk there."}, {"owner": {"reputation": 685, "user_id": 1698917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lxlbY.jpg?s=128&g=1", "display_name": "Lucas Teixeira", "link": "https://stackoverflow.com/users/1698917/lucas-teixeira"}, "edited": false, "score": 1, "creation_date": 1487248243, "post_id": 42258346, "comment_id": 71704044, "body": "I wrote a testable version of it <a href=\"https://gist.github.com/Flash3001/ec0da534167bd3cdb85bcfc12eff0838\" rel=\"nofollow noreferrer\">gist.github.com/Flash3001/ec0da534167bd3cdb85bcfc12eff0838</a>"}, {"owner": {"reputation": 1094, "user_id": 2080879, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nv7uW.jpg?s=128&g=1", "display_name": "Sql Surfer", "link": "https://stackoverflow.com/users/2080879/sql-surfer"}, "edited": false, "score": 0, "creation_date": 1487434270, "post_id": 42258346, "comment_id": 71788230, "body": "No, DateTime would not be atomic?  I would expect that since DateTime is a struct that struct rules apply.  The fact that its underlying value happens to use native word size is not relevant.  Except for when a stuct is allocated/\u201dcontructed\u201d shouldn\u2019t I assume it\u2019s subject to concurrency issues across fields?   Side Note: I find the built in .net Interlocked Class (System.Threading.Interlocked)  very useful in the real world where I know I am using Int64 on thousands of 32 bit runtimes that are on 32 bit kernels."}], "answers": [{"comments": [{"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 0, "creation_date": 1487194486, "post_id": 42259833, "comment_id": 71678630, "body": "But the question stands: Is <code>sizeof(IntPtr) == sizeof(DateTime)</code>? <code>DateTime</code> only contains a <code>ulong</code> but does that mean <code>sizeof(DateTime) == sizeof(ulong) == sizeof(IntPtr) == 8</code>?"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 0, "creation_date": 1487198893, "post_id": 42259833, "comment_id": 71680771, "body": "Yes, all 3 output 8 on a 64 bit environment, therfor are atomic according to the spec. In a 32 bit environment, <code>DateTime</code> and <code>ulong</code> return 8 but <code>IntPtr</code> returns 4 which violates the <code>sizeof(IntPtr) &gt;= sizeOf(DateTime)</code> rule so there for are not guaranteed atomic (which is what we expected to happen)"}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 0, "creation_date": 1487201382, "post_id": 42259833, "comment_id": 71681683, "body": "Wait, what do you mean all 3 output 8? How do you run <code>sizeof(DateTime)</code>? I can&#39;t compile that and get &quot;<code>DateTime</code> does not have a predefined size&quot;. You can use <code>Marshal.SizeOf</code> but that test the size when marshalling."}, {"owner": {"reputation": 22993, "user_id": 1394393, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mSjIL.jpg?s=128&g=1", "display_name": "jpmc26", "link": "https://stackoverflow.com/users/1394393/jpmc26"}, "edited": false, "score": 0, "creation_date": 1487204165, "post_id": 42259833, "comment_id": 71682537, "body": "<code>IsReadsAndWritesGuaranteedAtomic</code> --&gt; <code>AreReadsAndWritesGuaranteedAtomic</code>? or maybe <code>ReadsAndWritesAreGuaranteedAtomic</code> would be better."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 3, "creation_date": 1487205611, "post_id": 42259833, "comment_id": 71682976, "body": "@i3arnon <a href=\"https://gist.github.com/leftler/e45e6f68a0986408fad468080e7492f4\" rel=\"nofollow noreferrer\">here is the exact code I ran</a>, you just need to mark the assembly as unsafe in the project build settings, however I did update my example function at the end to use unsafe code instead of the marshal class because you did make a good point about the potential size difference."}, {"owner": {"reputation": 21007, "user_id": 276083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90e1eb7c2e486f1706a9d940372a2e69?s=128&d=identicon&r=PG", "display_name": "Eli Arbel", "link": "https://stackoverflow.com/users/276083/eli-arbel"}, "edited": false, "score": 1, "creation_date": 1487230386, "post_id": 42259833, "comment_id": 71691508, "body": "You can also use the NuGet package <code>System.Runtime.CompilerServices.Unsafe</code> and call <code>Unsafe.SizeOf&lt;T&gt;()</code> which works on any type. This library was written in IL and exposes some low-level functionality that&#39;s not available in C#."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 0, "creation_date": 1487345770, "post_id": 42259833, "comment_id": 71758251, "body": "@ScottChamberlain would you mind if I (or you) add that code to the answer? I think being able to run <code>sizeof(DateTime)</code> is the most definitive answer we&#39;ll get."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 0, "creation_date": 1487345789, "post_id": 42259833, "comment_id": 71758263, "body": "@i3arnon not at all, feel free."}, {"owner": {"reputation": 102569, "user_id": 400547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bece78258b3847bca4ab1ee92ad92b88?s=128&d=identicon&r=PG", "display_name": "Jon Hanna", "link": "https://stackoverflow.com/users/400547/jon-hanna"}, "edited": false, "score": 0, "creation_date": 1487690178, "post_id": 42259833, "comment_id": 71891739, "body": "The <code>AreReadsAndWritesAreGuaranteedAtomic</code> method here doesn&#39;t check that there is only one field (a <code>struct</code> with two <code>int</code> fields need not be written to as a single 64-bit write, but rather it contains two memory locations that can be written to as two writes that are individually atomic but not atomic as a pair) nor checks for the existence of <code>StructLayoutAttribute</code>."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 102569, "user_id": 400547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bece78258b3847bca4ab1ee92ad92b88?s=128&d=identicon&r=PG", "display_name": "Jon Hanna", "link": "https://stackoverflow.com/users/400547/jon-hanna"}, "edited": false, "score": 0, "creation_date": 1487694398, "post_id": 42259833, "comment_id": 71895016, "body": "@JonHanna <code>type.IsAutoLayout</code> does check for <code>StructLayoutAttribute</code>, it is a convenience property that does not require you to extract the attribute. However i will give you that the two int example will return a <code>sizeof(example) == 8</code> on a 64 bit machine and will not work. I have removed the function from the question."}, {"owner": {"reputation": 102569, "user_id": 400547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bece78258b3847bca4ab1ee92ad92b88?s=128&d=identicon&r=PG", "display_name": "Jon Hanna", "link": "https://stackoverflow.com/users/400547/jon-hanna"}, "edited": false, "score": 0, "creation_date": 1487695394, "post_id": 42259833, "comment_id": 71895744, "body": "Right you are on <code>IsAutoLayout</code> my eyes somehow skipped past that."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 102569, "user_id": 400547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bece78258b3847bca4ab1ee92ad92b88?s=128&d=identicon&r=PG", "display_name": "Jon Hanna", "link": "https://stackoverflow.com/users/400547/jon-hanna"}, "edited": false, "score": 0, "creation_date": 1487695475, "post_id": 42259833, "comment_id": 71895800, "body": "@JonHanna thinking about it more, I don&#39;t know how the CLR treats your two int situation, it may treat the struct as a single 8 byte object not two 4 byte objects when doing assignment so it may still be atomic. It is not clear based on the specification, I am still going to leave the function off but it might be worth testing."}], "tags": [], "owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "is_accepted": true, "score": 34, "last_activity_date": 1487694410, "last_edit_date": 1487694410, "creation_date": 1487191971, "answer_id": 42259833, "question_id": 42258346, "link": "https://stackoverflow.com/questions/42258346/can-datetime-tear-in-a-64-bit-environment/42259833#42259833", "title": "Can DateTime tear in a 64 bit environment?", "body": "<p>From the <a href=\"http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-335.pdf\" rel=\"noreferrer\">ECMA specification</a> section \"I.12.6.6 Atomic reads and writes\"</p>\n\n<blockquote>\n  <p>A conforming CLI shall guarantee that read and write access to properly aligned memory locations no larger than the native word size (the size of type <code>native int</code>) is atomic (see \u00a7I.12.6.2) when all the write accesses to a location are the same size. Atomic writes shall alter no bits other than those written. Unless explicit layout control (see Partition II (Controlling Instance Layout)) is used to alter the default behavior, data elements no larger than the natural word size (the size of a <code>native int</code>) shall be properly aligned. Object references shall be treated as though they are stored in the native word size.</p>\n</blockquote>\n\n<p>A <code>native int</code> is a <code>IntPtr</code> in C#. </p>\n\n<p>So long as <code>sizeof(IntPtr) &gt;= sizeof(DateTime)</code> is true for the runtime environment (aka: running as 64 bit), and they don't alter the internal structure to be explicit layout with misaligned bytes instead of the <code>[StructLayout(LayoutKind.Auto)]</code> it currently has, then reads and writes of a <code>DateTime</code> struct (or any other struct that follows those rules) are guaranteed to be atomic by the ECMA specification.</p>\n\n<p>You can verify that by running the following code in a 64-bit environment:</p>\n\n<pre><code>public unsafe static void Main()\n{\n    Console.WriteLine(sizeof(DateTime)); // Outputs 8\n    Console.WriteLine(sizeof(IntPtr)); // Outputs 8\n    Console.WriteLine(sizeof(ulong)); // Outputs 8\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2929, "user_id": 847438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd7f85d61f9ff2cd97aa352df467e512?s=128&d=identicon&r=PG", "display_name": "Immo Landwerth", "link": "https://stackoverflow.com/users/847438/immo-landwerth"}, "edited": false, "score": 5, "creation_date": 1487304069, "post_id": 42259851, "comment_id": 71734575, "body": "True in principle, but we often build types that provide stricter guarantees, so that&#39;s not answering the question."}], "tags": [], "owner": {"reputation": 457, "user_id": 2387098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ab554d1c68bb6730f880b7dd90320f?s=128&d=identicon&r=PG", "display_name": "OmariO", "link": "https://stackoverflow.com/users/2387098/omario"}, "is_accepted": false, "score": 1, "last_activity_date": 1487192061, "creation_date": 1487192061, "answer_id": 42259851, "question_id": 42258346, "link": "https://stackoverflow.com/questions/42258346/can-datetime-tear-in-a-64-bit-environment/42259851#42259851", "title": "Can DateTime tear in a 64 bit environment?", "body": "<p>From C# language specification.</p>\n\n<blockquote>\n  <p>5.5 Atomicity of variable references Reads and writes of the following data types are atomic: <strong>bool, char, byte, sbyte, short, ushort, uint,\n  int, float, and reference types</strong>. In addition, reads and writes of enum\n  types with an underlying type in the previous list are also atomic.\n  Reads and writes of other types, including <strong>long, ulong, double, and\n  decimal, as well as user-defined types, are not guaranteed</strong> to be\n  atomic. Aside from the library functions designed for that purpose,\n  there is no guarantee of atomic read-modify-write, such as in the case\n  of increment or decrement.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 685, "user_id": 1698917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lxlbY.jpg?s=128&g=1", "display_name": "Lucas Teixeira", "link": "https://stackoverflow.com/users/1698917/lucas-teixeira"}, "is_accepted": false, "score": 10, "last_activity_date": 1487341183, "last_edit_date": 1495542380, "creation_date": 1487340658, "answer_id": 42299999, "question_id": 42258346, "link": "https://stackoverflow.com/questions/42258346/can-datetime-tear-in-a-64-bit-environment/42299999#42299999", "title": "Can DateTime tear in a 64 bit environment?", "body": "<p>Running some tests and based on the <a href=\"https://stackoverflow.com/a/42259833/1698917\">above answer</a> it is pretty safe to say it is atomic today.</p>\n\n<p>I wrote a test to verify how many tears could be found during X iterations over N threads for Int64, DateTime and 3 custom structs of 128, 192 and 256 sizes - none with their StructLayout messed up.</p>\n\n<p>The test consists of:</p>\n\n<ol>\n<li>Adding a set of values to a array so they are known. </li>\n<li>Setting up one thread for each array position, this thread will assign the value from the array to a shared variable. </li>\n<li>Setting up the same number of threads (array.length) to read from this shared variable to a local.</li>\n<li>Check if this local is contained in the original array. </li>\n</ol>\n\n<p>The results are as follows in my machine (Core i7-4500U, Windows 10 x64, .NET 4.6, Release without debug, Platform target: x64 with code optimization):</p>\n\n<pre><code>-------------- Trying to Tear --------------\nRunning: 64bits\nMax Threads: 30\nMax Reruns: 10\nIterations per Thread: 20000\n--------------------------------------------\n----- Tears ------ | -------- Size ---------\n          0             Int64 (64bits)\n          0             DateTime (64bits)\n         23             Struct128 (128bits)\n         87             Struct192 (192bits)\n         43             Struct256 (256bits)\n----- Tears ------ | -------- Size ---------\n          0             Int64 (64bits)\n          0             DateTime (64bits)\n         44             Struct128 (128bits)\n         59             Struct192 (192bits)\n         52             Struct256 (256bits)\n----- Tears ------ | -------- Size ---------\n          0             Int64 (64bits)\n          0             DateTime (64bits)\n         26             Struct128 (128bits)\n         53             Struct192 (192bits)\n         45             Struct256 (256bits)\n----- Tears ------ | -------- Size ---------\n          0             Int64 (64bits)\n          0             DateTime (64bits)\n         46             Struct128 (128bits)\n         57             Struct192 (192bits)\n         56             Struct256 (256bits)\n------------------- End --------------------\n</code></pre>\n\n<p>The code for the test can be found here: <a href=\"https://gist.github.com/Flash3001/da5bd3ca800f674082dd8030ef70cf4e\" rel=\"nofollow noreferrer\">https://gist.github.com/Flash3001/da5bd3ca800f674082dd8030ef70cf4e</a></p>\n"}], "owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3018, "favorite_count": 13, "accepted_answer_id": 42259833, "answer_count": 3, "score": 53, "last_activity_date": 1487694410, "creation_date": 1487186640, "last_edit_date": 1487419505, "question_id": 42258346, "link": "https://stackoverflow.com/questions/42258346/can-datetime-tear-in-a-64-bit-environment", "title": "Can DateTime tear in a 64 bit environment?", "body": "<p>In C# setting a value to a variable is atomic as long as its size is at most <code>native int</code> (i.e. 4 bytes in a 32-bit runtime environment and 8 bytes on a 64-bit one).\nIn a 64-bit environment that includes all references types and most built-in value types (<code>byte</code>, <code>short</code>, <code>int</code>, <code>long</code>, etc.).</p>\n\n<p>Setting a bigger value isn't atomic and can cause tearing where only part of the memory is updated.</p>\n\n<p><code>DateTime</code> is a struct that includes only a single <code>ulong</code> field containing all its data (<code>Ticks</code> and the <code>DateTimeKind</code>) and <code>ulong</code> by itself is atomic in a 64-bit environment.</p>\n\n<p>Does that mean that <code>DateTime</code> is atomic as well? Or Can the following code lead to tearing at some point?</p>\n\n<pre><code>static DateTime _value;\nstatic void Main()\n{\n    for (int i = 0; i &lt; 10; i++)\n    {\n        new Thread(_ =&gt;\n        {\n            var random = new Random();\n            while (true)\n            {\n                _value = new DateTime((long)random.Next() &lt;&lt; 30 | (long)random.Next());\n            }\n        }).Start();\n    }\n\n    Console.ReadLine();\n}\n</code></pre>\n"}, {"tags": ["c#", "unit-testing", "nunit", "caliburn.micro", "rhino-mocks"], "comments": [{"owner": {"reputation": 9866, "user_id": 368552, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3672308feaff9d9167de4fcc7dc6d077?s=128&d=identicon&r=PG", "display_name": "Luke Hutton", "link": "https://stackoverflow.com/users/368552/luke-hutton"}, "edited": false, "score": 2, "creation_date": 1487187214, "post_id": 42258280, "comment_id": 71674658, "body": "Not possible to mock extension methods in Rhino, <a href=\"http://stackoverflow.com/a/5488700/368552\">stackoverflow.com/a/5488700/368552</a> You could wrap them in an interface however and mock the interface"}], "answers": [{"tags": [], "owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "is_accepted": true, "score": 2, "last_activity_date": 1487193280, "creation_date": 1487193280, "answer_id": 42260192, "question_id": 42258280, "link": "https://stackoverflow.com/questions/42258280/assertwascalled-when-there-is-a-this-parameter/42260192#42260192", "title": "AssertWasCalled when there is a &quot;this&quot; parameter", "body": "<p>According to framework documentation, <a href=\"http://caliburnmicro.com/documentation/event-aggregator\" rel=\"nofollow noreferrer\">The Event Aggregator</a> is defined as followed.</p>\n\n<pre><code>public interface IEventAggregator {\n    bool HandlerExistsFor(Type messageType);\n    void Subscribe(object subscriber);\n    void Unsubscribe(object subscriber);\n    void Publish(object message, Action&lt;Action&gt; marshal);\n}\n</code></pre>\n\n<p>As you already know, <code>PublishOnUIThread</code> is an <a href=\"https://github.com/Caliburn-Micro/Caliburn.Micro/blob/master/src/Caliburn.Micro/EventAggregatorExtensions.cs\" rel=\"nofollow noreferrer\">Event Aggregator Extension</a> method applied to the interface which calls the <code>void Publish(object message, Action&lt;Action&gt; marshal);</code> method.</p>\n\n<p>In this case you can assert that method (<code>IEventAggregator.Publish</code>) when trying to test publishing an event as you cannot mock the extension methods.</p>\n\n<pre><code>//assert\n_eventAggregator.AssertWasCalled(x =&gt; \nx.Publish(Arg&lt;object&gt;.Is.Anything, Arg&lt;Action&lt;Action&gt;&gt;.Is.Anything));\n</code></pre>\n"}], "owner": {"reputation": 628, "user_id": 4668963, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/546017ec07fcde1bff1e0b145dcc5439?s=128&d=identicon&r=PG&f=1", "display_name": "azulBonnet", "link": "https://stackoverflow.com/users/4668963/azulbonnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 42260192, "answer_count": 1, "score": 2, "last_activity_date": 1487193357, "creation_date": 1487186443, "last_edit_date": 1487193357, "question_id": 42258280, "link": "https://stackoverflow.com/questions/42258280/assertwascalled-when-there-is-a-this-parameter", "title": "AssertWasCalled when there is a &quot;this&quot; parameter", "body": "<p>I am trying to test that Caliburn.Micro method, <code>PublishOnUIThread()</code> is called:</p>\n\n<pre><code>public static class EventAggregatorExtensions\n{\n ...        \n      public static void PublishOnUIThread(this IEventAggregator eventAggregator, object message);\n ...\n}\n</code></pre>\n\n<p>I am trying to test like this: </p>\n\n<pre><code>//assert\n_eventAggregator.AssertWasCalled(x =&gt; \nx.PublishOnUIThread(Arg&lt;object&gt;\n.Is.Anything));\n</code></pre>\n\n<p>but get the error:</p>\n\n<blockquote>\n  <p>System.InvalidOperationException : When using <code>Arg&lt;T&gt;</code>, all arguments\n  must be defined using <code>Arg&lt;T&gt;.Is, Arg&lt;T&gt;.Text, Arg&lt;T&gt;.List, Arg&lt;T&gt;.Ref\n  or Arg&lt;T&gt;.Out</code>. 2 arguments expected, 1 have been defined.</p>\n</blockquote>\n\n<p>However, I cannot force the method to take 2 parameters. I'm new to testing so I'm not sure how to work around this. </p>\n"}, {"tags": ["c#", "design-patterns"], "comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487186782, "post_id": 42258214, "comment_id": 71674448, "body": "For discussion of pros/cons (which are mostly off-topic on Stack Overflow), see e.g. <a href=\"http://csharpindepth.com/Articles/General/Singleton.aspx\" rel=\"nofollow noreferrer\">csharpindepth.com/Articles/General/Singleton.aspx</a>"}, {"owner": {"reputation": 2212, "user_id": 7512358, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1492893ec3b80a28ba13603d8ad4c6?s=128&d=identicon&r=PG&f=1", "display_name": "Mhd", "link": "https://stackoverflow.com/users/7512358/mhd"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487187248, "post_id": 42258214, "comment_id": 71674674, "body": "I saw that article, but the above example was not mentioned"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487187401, "post_id": 42258214, "comment_id": 71674754, "body": "Your example is functionally identical to simply initializing the backing field directly, e.g. <code>static Singleton Instance { get; } = new Singleton();</code>, a variation that <i>is</i> discussed in the article. Of course, the code you posted is useless, because the <code>Instance</code> property is <code>private</code>, and so can only be called by the <code>Singleton</code> class itself (which has no constraints on how many instances of <code>Singleton</code> it can create...singletons are really only useful constructs for outside code)."}], "answers": [{"comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1487186736, "post_id": 42258264, "comment_id": 71674413, "body": "The singleton <i>initialization</i> the OP is asking about <i>is</i> thread-safe. Of course, whether the singleton <i>object</i> itself is thread-safe is a completely separate matter. Though, it&#39;d be very bad form to write a singleton object that isn&#39;t thread-safe in a context where thread-safety is in any way an issue, since by its very nature, a singleton is used repeatedly and potentially concurrently."}], "tags": [], "owner": {"reputation": 382, "user_id": 7237504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9e8c67f9280e6fbba087686c856fcb67?s=128&d=identicon&r=PG&f=1", "display_name": "Casey O&#39;Brien", "link": "https://stackoverflow.com/users/7237504/casey-obrien"}, "is_accepted": false, "score": 0, "last_activity_date": 1487186407, "creation_date": 1487186407, "answer_id": 42258264, "question_id": 42258214, "link": "https://stackoverflow.com/questions/42258214/singleton-create-instance-inside-static-constructor/42258264#42258264", "title": "Singleton: create instance inside static constructor", "body": "<p>No singletons are not thread safe, I would recommend reading <a href=\"https://msdn.microsoft.com/en-us/library/ff650316.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ff650316.aspx</a></p>\n"}], "owner": {"reputation": 2212, "user_id": 7512358, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/dd1492893ec3b80a28ba13603d8ad4c6?s=128&d=identicon&r=PG&f=1", "display_name": "Mhd", "link": "https://stackoverflow.com/users/7512358/mhd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "closed_date": 1487186638, "answer_count": 1, "score": -2, "last_activity_date": 1487186407, "creation_date": 1487186205, "question_id": 42258214, "link": "https://stackoverflow.com/questions/42258214/singleton-create-instance-inside-static-constructor", "closed_reason": "Duplicate", "title": "Singleton: create instance inside static constructor", "body": "<p>I was reading about Singleton design pattern when i come across this implementation:</p>\n\n<pre><code>public class Singleton\n{\n    private static Singleton Instance { get; private set; }\n\n    private Singleton()\n    {\n    }\n\n    static Singleton()\n    {\n        Instance = new Singleton();\n    }\n}\n</code></pre>\n\n<p>Is this singleton thread safe? What are pros and cons of such implementation?  </p>\n"}, {"tags": ["c#", "arrays"], "comments": [{"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "edited": false, "score": 0, "creation_date": 1487186394, "post_id": 42258197, "comment_id": 71674221, "body": "Your name variable is an int, and you convert the console input to integer, so that&#39;s why you can only put numbers in for the name.  You&#39;re also setting subtotal = &quot;X&quot; in the loop, so it will always be set to the last calculation.  You should use += for a running subtotal."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1487607607, "post_id": 42258197, "comment_id": 71850027, "body": "Where is <code>array</code> used?"}, {"owner": {"reputation": 45, "user_id": 7525162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42161dfe4b49b588eb20165656ef0158?s=128&d=identicon&r=PG&f=1", "display_name": "Shade", "link": "https://stackoverflow.com/users/7525162/shade"}, "edited": false, "score": 0, "creation_date": 1487608261, "post_id": 42258197, "comment_id": 71850376, "body": "I tried to use it right before the while loop, but I&#39;m pretty sure I did it wrong."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1487609243, "post_id": 42258197, "comment_id": 71850961, "body": "What I meant to ask is how is <code>array</code> supposed to be used? It is to store the quantities? And how is <code>name</code> to be used, given that it has dimensions completely different from <code>array</code> <i>and</i> from the counter 10."}, {"owner": {"reputation": 45, "user_id": 7525162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42161dfe4b49b588eb20165656ef0158?s=128&d=identicon&r=PG&f=1", "display_name": "Shade", "link": "https://stackoverflow.com/users/7525162/shade"}, "edited": false, "score": 0, "creation_date": 1487609811, "post_id": 42258197, "comment_id": 71851346, "body": "Array is supposed to be used to show all the information as in show the name of the item, the quantity, the price, and the subtotal. name is supposed to be used as the item of the receipt and when you are done can enter 0 to break."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1487610518, "post_id": 42258197, "comment_id": 71851818, "body": "But array is of type <code>int[]</code> an integer array can only hold integers, and not strings or decimals."}], "answers": [{"comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1487186521, "post_id": 42258244, "comment_id": 71674286, "body": "Also, <code>subtotal += price * quantity;</code>"}], "tags": [], "owner": {"reputation": 2321, "user_id": 2524586, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/189eb592a73415253a54c9aade6b7522?s=128&d=identicon&r=PG", "display_name": "Westerlund.io", "link": "https://stackoverflow.com/users/2524586/westerlund-io"}, "is_accepted": false, "score": 1, "last_activity_date": 1487186328, "creation_date": 1487186328, "answer_id": 42258244, "question_id": 42258197, "link": "https://stackoverflow.com/questions/42258197/2d-array-calculator-in-c/42258244#42258244", "title": "2d array calculator in C#", "body": "<p>You're trying to convert name to a number:</p>\n\n<pre><code>name = Convert.ToInt32(Console.ReadLine());\n            if (name == 0)\n                break;\n</code></pre>\n\n<p>Try removing \"Convert.ToInt\" like this:</p>\n\n<pre><code>name = Console.ReadLine();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 7525162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42161dfe4b49b588eb20165656ef0158?s=128&d=identicon&r=PG&f=1", "display_name": "Shade", "link": "https://stackoverflow.com/users/7525162/shade"}, "edited": false, "score": 0, "creation_date": 1487615523, "post_id": 42351194, "comment_id": 71854603, "body": "Ok I understand it a little better now. I was thinking of array as something completely different. I was thinking of it as a value type and not as a variable. Thank-you for the help."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": true, "score": -1, "last_activity_date": 1487613221, "last_edit_date": 1487613221, "creation_date": 1487612908, "answer_id": 42351194, "question_id": 42258197, "link": "https://stackoverflow.com/questions/42258197/2d-array-calculator-in-c/42351194#42351194", "title": "2d array calculator in C#", "body": "<p>Maybe this program will help you in learning <code>C#</code>. But you have to promise to try to understand how and why it works. Also, use the debugger to step in order to see how each statement affects the values stored in the variables.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        const int max_count = 10;\n\n        string[] name = new string[max_count];\n        int[] quantity = new int[max_count];\n        decimal[] price = new decimal[max_count];\n        decimal subtotal = 0;\n        int count = 0;\n        // Enter Values\n        for(int i = 0; i&lt;max_count; i++)\n        {\n            Console.Write(\"Item{0}\", i+1);\n            Console.Write(\"\\tEnter Item Name: \");\n            name[i]=Console.ReadLine();\n            if(name[i].Length==0)\n            {\n                break;\n            }\n            Console.Write(\"\\tEnter Price: \");\n            price[i]=decimal.Parse(Console.ReadLine());\n            Console.Write(\"\\tEnter Quantity: \");\n            quantity[i]=int.Parse(Console.ReadLine());\n            subtotal+=quantity[i]*price[i];\n            count+=1;\n        }\n        // Display Summary\n        Console.WriteLine(\"-------------------\");\n        Console.WriteLine(\"\\nNumber of Items:{0}\", count);\n        Console.WriteLine(\"Subtotal is {0}\", subtotal);\n        decimal  tax=subtotal*0.065M;\n        Console.WriteLine(\"Tax is {0}\", tax);\n        decimal total=tax+subtotal;\n        Console.WriteLine(\"Total is {0}\", total);\n        Console.WriteLine(\"Thanks for shopping! Please come again.\");\n        Console.Read();\n    }\n}\n</code></pre>\n\n<p>What you have here is a structure (the <code>Program</code>) of arrays. There are three arrays each storing a different <em>type</em> of value (string, int ,decimal). Later you should learn to make a single array of a structure, each containing multiple values.</p>\n\n<pre><code>public class Item\n{\n    public string name;\n    public decimal price;\n    public int quantity;\n}\n\n// Usage\nvar cart = new List&lt;Item&gt;();\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7525162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42161dfe4b49b588eb20165656ef0158?s=128&d=identicon&r=PG&f=1", "display_name": "Shade", "link": "https://stackoverflow.com/users/7525162/shade"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "closed_date": 1487632506, "accepted_answer_id": 42351194, "answer_count": 2, "score": -2, "last_activity_date": 1487613221, "creation_date": 1487186152, "last_edit_date": 1592644375, "question_id": 42258197, "link": "https://stackoverflow.com/questions/42258197/2d-array-calculator-in-c", "closed_reason": "Not suitable for this site", "title": "2d array calculator in C#", "body": "<p>I'm having a little trouble making a calculator. I can't seem to be able to enter the item name, only numbers. Also, it only takes the last price and quantity and multiplies them not the entirety. Update: I made the changes to the code about the subtotal and break,but it keeps telling me</p>\n<blockquote>\n<p>Error CS0029<br />\nCannot implicitly convert type 'string' to 'string[<em>,</em>]'</p>\n<p>Error CS0019<br />\nOperator '==' cannot be applied to operandstype'string[<em>,</em>]' and 'int'</p>\n</blockquote>\n<p>I can't seem to make it work or add a list to the end. Any help would be appreciated.</p>\n<pre><code>int[] array;\nstring[,] name = new string[100, 4];\ndecimal counter;\n\ndecimal price;\ndecimal subtotal;\ndecimal tax;\ndecimal total;\ndecimal quantity;\n\nsubtotal = 0;\ncounter = 0;\n\narray = new int[5];\nwhile (counter &lt;= 10)\n{\n    Console.Write(&quot;Item{0}&quot;, counter + 1);\n    Console.Write(&quot;        Enter item name: &quot;);\n    name = Console.ReadLine();\n    if (name == 0)\n        break;\n    Console.Write(&quot;        Enter price: &quot;);\n    price = Convert.ToDecimal(Console.ReadLine());\n    \n    \n    counter = counter + 1;\n    \n    Console.Write(&quot;        Enter quantity: &quot;);\n    quantity= Convert.ToInt32(Console.ReadLine());\n    subtotal += price * quantity;\n}\nConsole.WriteLine(&quot;-------------------&quot;);\nConsole.WriteLine(&quot;\\nNumber of Items:{0}&quot;, counter);\nConsole.WriteLine(&quot;Subtotal is {0}&quot;, subtotal);\ntax = subtotal * 0.065M;\nConsole.WriteLine(&quot;Tax is {0}&quot;, tax);\ntotal = tax + subtotal;\nConsole.WriteLine(&quot;Total is {0}&quot;, total);\nConsole.WriteLine(&quot;Thanks for shopping! Please come again.&quot;);\nConsole.Read();\n</code></pre>\n<p>I also know that I need to have <code>for ( int counter = 0; counter &lt; array.Length; counter++ )</code> in the code too, but it won't work. Thank-you for your time and help in advance.</p>\n"}, {"tags": ["c#", "xaml", "uwp", "textblock"], "answers": [{"comments": [{"owner": {"reputation": 927, "user_id": 5446838, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6a08a5068d837c268deab9b2512b1223?s=128&d=identicon&r=PG&f=1", "display_name": "John P.", "link": "https://stackoverflow.com/users/5446838/john-p"}, "edited": false, "score": 0, "creation_date": 1487188472, "post_id": 42258277, "comment_id": 71675339, "body": "Sorry, my fault for the tag. I think I will need to reset its content once selection changed or even better use a selectionchanged event instead of tapped. Thank you"}], "tags": [], "owner": {"reputation": 133235, "user_id": 7252182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUgxG.png?s=128&g=1", "display_name": "mm8", "link": "https://stackoverflow.com/users/7252182/mm8"}, "is_accepted": true, "score": 2, "last_activity_date": 1487186435, "creation_date": 1487186435, "answer_id": 42258277, "question_id": 42258169, "link": "https://stackoverflow.com/questions/42258169/set-textblocks-tooltip-content/42258277#42258277", "title": "Set TextBlock&#39;s ToolTip content", "body": "<p>Try this:</p>\n\n<pre><code>private void TextBlock_Tapped(object sender, TappedRoutedEventArgs e)\n{\n    var txt = sender as TextBlock;\n    ToolTip tt = ToolTipService.GetToolTip(txt) as ToolTip;\n    tt.Content = \"...\";\n}\n</code></pre>\n\n<p>And please tag your questions properly. UWP is not the same thing as WPF.</p>\n"}], "owner": {"reputation": 927, "user_id": 5446838, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6a08a5068d837c268deab9b2512b1223?s=128&d=identicon&r=PG&f=1", "display_name": "John P.", "link": "https://stackoverflow.com/users/5446838/john-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 761, "favorite_count": 0, "accepted_answer_id": 42258277, "answer_count": 1, "score": 0, "last_activity_date": 1487186910, "creation_date": 1487186060, "last_edit_date": 1487186910, "question_id": 42258169, "link": "https://stackoverflow.com/questions/42258169/set-textblocks-tooltip-content", "title": "Set TextBlock&#39;s ToolTip content", "body": "<p>I am trying to add a <code>ToolTip</code> on my <code>TextBlock</code>. After some research this is how I added it on <code>UWP</code></p>\n\n<p>xaml:</p>\n\n<pre><code>&lt;ListView x:Name=\"flyList\" BorderThickness=\"0\" ItemsSource=\"{Binding}\"&gt;\n    &lt;ListView.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Border BorderThickness=\"0,0,0,1\" BorderBrush=\"#FF7C7C7C\"&gt;\n                    &lt;TextBlock Text=\"{Binding}\" Tapped=\"TextBlock_Tapped\"&gt;\n                        &lt;ToolTipService.ToolTip&gt;\n                            &lt;ToolTip Name=\"tip1\" Content=\"Click to copy signal to clipboard.\"/&gt;\n                        &lt;/ToolTipService.ToolTip&gt;\n                    &lt;/TextBlock&gt;\n                &lt;/Border&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListView.ItemTemplate&gt;\n&lt;/ListView&gt;\n</code></pre>\n\n<p>How can I set the <code>ToolTip</code>'s content? Or better how can I even access it?\nI want to access it on <code>TextBlock</code>'s tapped event.</p>\n\n<pre><code>private void TextBlock_Tapped(object sender, TappedRoutedEventArgs e)\n{\n    /*\n    var send = sender as TextBlock;\n    var dataPackage = new DataPackage { RequestedOperation = DataPackageOperation.Copy };\n    dataPackage.SetText(send.Text);\n    Clipboard.SetContent(dataPackage);\n    */\n}\n</code></pre>\n"}, {"tags": ["c#", "sql", "asp.net", "list"], "comments": [{"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 1, "creation_date": 1487186693, "post_id": 42258164, "comment_id": 71674383, "body": "What is in the constructor of <code>CustomCohort</code>? Maybe there&#39;s something in there that causes the error."}, {"owner": {"reputation": 1702, "user_id": 703161, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/21f3889b711ae6dd796913170199899e?s=128&d=identicon&r=PG", "display_name": "DogEatDog", "link": "https://stackoverflow.com/users/703161/dogeatdog"}, "edited": false, "score": 0, "creation_date": 1487186957, "post_id": 42258164, "comment_id": 71674527, "body": "Please share the code snippet of <code>CustomCohort</code> as well as the full error digest"}, {"owner": {"reputation": 10220, "user_id": 70104, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/859c44ae8a94cf8def8a9728369fcd2e?s=128&d=identicon&r=PG", "display_name": "Chris Dunaway", "link": "https://stackoverflow.com/users/70104/chris-dunaway"}, "edited": false, "score": 0, "creation_date": 1487191662, "post_id": 42258164, "comment_id": 71677118, "body": "Post the rest of the exception, especially the entirety of the &quot;Additional information&quot;."}, {"owner": {"reputation": 860, "user_id": 5541055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/T7yrQ.png?s=128&g=1", "display_name": "Kay Lee", "link": "https://stackoverflow.com/users/5541055/kay-lee"}, "edited": false, "score": 0, "creation_date": 1487210684, "post_id": 42258164, "comment_id": 71684333, "body": "You need to show the code inside &#39;CustomCohort&#39; model class and the SQL code. Otherwise, nobody can help you."}, {"owner": {"reputation": 860, "user_id": 5541055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/T7yrQ.png?s=128&g=1", "display_name": "Kay Lee", "link": "https://stackoverflow.com/users/5541055/kay-lee"}, "edited": false, "score": 0, "creation_date": 1487289900, "post_id": 42258164, "comment_id": 71730597, "body": "It seems your CustomCohort class is created in wrong way. Kindly try to look at more examples..And your exception message is mentioning SQLException, therefore, you&#39;d better to show the SQL code and take care of it..Good Luck !"}], "owner": {"reputation": 13, "user_id": 7570170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16d837ae78bd13ab43f52e130b37ce50?s=128&d=identicon&r=PG&f=1", "display_name": "Sophie ", "link": "https://stackoverflow.com/users/7570170/sophie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 622, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1487617248, "creation_date": 1487186048, "last_edit_date": 1487617248, "question_id": 42258164, "link": "https://stackoverflow.com/questions/42258164/an-exception-of-type-system-data-sqlclient-sqlexception-occurred-in-system-dat", "title": "An exception of type &#39;System.Data.SqlClient.SqlException&#39; occurred in System.Data.dll but was not handled in user code when creating a List", "body": "<p>So when I'm trying to create A list :</p>\n\n<pre><code>List&lt;CustomCohort&gt; customCohorts = new List&lt;CustomCohort&gt;();\n</code></pre>\n\n<p>i'm always getting an error from this line of code. </p>\n\n<p>So the it's always throwing exception :</p>\n\n<blockquote>\n  <p>SqlExeception was unhandled by user code\n      An exception of type 'System.Data.SqlClient.SqlException' occurred in System.Data.dll but was not handled in user code\n      Additional information: the parameterized query '(@alias int)\n           select </p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/WQl8t.png\" rel=\"nofollow noreferrer\">exception detail click here</a></p>\n\n<p>And here is my code in the controller:</p>\n\n<pre><code>namespace webservices.Controllers\n{\n    public class CustomCohortController : Controller\n    {\n        private userInfoNewServiceIdentity Identity\n        {\n            get { return (userInfoNewServiceIdentity)Session[\"Identity\"]; }\n            set { Session[\"Identity\"] = value; }\n        }\n\n        private string DBCONN\n        {\n            get\n            {\n                if (System.Environment.GetEnvironmentVariable(\"TIER\") == \"prod\")\n                {\n                    return \"DBCONNPROD\";\n                }\n                else\n                {\n                    return \"DBCONNDEV\";\n                }\n            }\n        }\n</code></pre>\n\n<p>Here is the constructor of customcohort:</p>\n\n<pre><code>    public CustomCohort()\n    {\n        revisions = new List&lt;CustomCohortRevision&gt;();\n        selectedStudents = new List&lt;SelectListItem&gt;();\n        students = new List&lt;string&gt;();\n    }\n\n    public CustomCohort(int _id, string _name)\n    {\n        id = _id;\n        name = _name;\n        revisions = new List&lt;CustomCohortRevision&gt;();\n        selectedStudents = new List&lt;SelectListItem&gt;();\n        students = new List&lt;string&gt;();\n    }\n</code></pre>\n\n<p>Any possible reason of this ???</p>\n\n<p>Thank you so much!!!</p>\n"}, {"tags": ["c#", "oop", "interface", "abstract-class"], "comments": [{"owner": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "edited": false, "score": 0, "creation_date": 1487186197, "post_id": 42258154, "comment_id": 71674132, "body": "Could you add a more general method to the interface maybe <code>string speak()</code>.? Then whichever class implements it can have its own message."}, {"owner": {"reputation": 19, "user_id": 5289573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WtZfPdyI5s0/AAAAAAAAAAI/AAAAAAAAAA0/cgnFxJDX3IU/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/5289573/eric"}, "reply_to_user": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "edited": false, "score": 0, "creation_date": 1487186339, "post_id": 42258154, "comment_id": 71674199, "body": "What about class fish which can&#39;t speak at all?"}, {"owner": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "edited": false, "score": 0, "creation_date": 1487186370, "post_id": 42258154, "comment_id": 71674211, "body": "Then it can return an empty string. Or an indicator that there is no sound."}, {"owner": {"reputation": 89878, "user_id": 1945651, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/9J4D8.png?s=128&g=1", "display_name": "JLRishe", "link": "https://stackoverflow.com/users/1945651/jlrishe"}, "edited": false, "score": 0, "creation_date": 1487186600, "post_id": 42258154, "comment_id": 71674330, "body": "Or the animals that can speak could implement <code>ITalkingAnimal</code>."}, {"owner": {"reputation": 19, "user_id": 5289573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WtZfPdyI5s0/AAAAAAAAAAI/AAAAAAAAAA0/cgnFxJDX3IU/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/5289573/eric"}, "edited": false, "score": 0, "creation_date": 1487186939, "post_id": 42258154, "comment_id": 71674518, "body": "So from the comments it sounds like you are advocating to include all methods in a related interface and not leave any such as in the example?"}, {"owner": {"reputation": 2959, "user_id": 819153, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a691c06e10ba780802b6df69be781637?s=128&d=identicon&r=PG", "display_name": "Zinov", "link": "https://stackoverflow.com/users/819153/zinov"}, "edited": false, "score": 0, "creation_date": 1487187653, "post_id": 42258154, "comment_id": 71674887, "body": "try to use the &#39;as&#39; reserved key to treat the element as another cat as Cat"}, {"owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1487188144, "post_id": 42258154, "comment_id": 71675157, "body": "What about an interface like this: <code>IViralAnimalOnYouTube</code>"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 1341236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/773cfb261a8759701b60a864821fd97e?s=128&d=identicon&r=PG", "display_name": "Erick de Oliveira Santos", "link": "https://stackoverflow.com/users/1341236/erick-de-oliveira-santos"}, "is_accepted": false, "score": 0, "last_activity_date": 1487187021, "creation_date": 1487187021, "answer_id": 42258437, "question_id": 42258154, "link": "https://stackoverflow.com/questions/42258154/non-interface-methods/42258437#42258437", "title": "Non-Interface methods", "body": "<p>If you need to access the method it would be necessary to make an explicit cast.</p>\n\n<p>In this case it would be more interesting to leave your Meow() method more generic for other possible classes that could implement it:</p>\n\n<pre><code>public interface IAnimal\n{\n    void Eat();\n    void Speak();\n}\n\npublic class Cat : IAnimal\n{  \n    public void Eat() {  }\n\n    public string Speak()\n    {\n        return \"meow\";\n    }   \n}\n\npublic class Dog : IAnimal\n{  \n    public void Eat() {  }\n\n    public string Speak()\n    {\n        return \"au\";\n    }   \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 5289573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WtZfPdyI5s0/AAAAAAAAAAI/AAAAAAAAAA0/cgnFxJDX3IU/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/5289573/eric"}, "edited": false, "score": 0, "creation_date": 1487187691, "post_id": 42258525, "comment_id": 71674909, "body": "Is there a general rule of thumb on when to implement multiple interfaces vs chaining the interfaces?"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 19, "user_id": 5289573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WtZfPdyI5s0/AAAAAAAAAAI/AAAAAAAAAA0/cgnFxJDX3IU/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/5289573/eric"}, "edited": false, "score": 0, "creation_date": 1487187810, "post_id": 42258525, "comment_id": 71674976, "body": "Depends on how you plan on using it. For your example in your question you would use the interitance. If you had code like <code>IEnumerable&lt;string&gt; MakeThemSpeak(IEnumerable&lt;...&gt; obj)</code> you would likely use <code>ISpeakable</code> so if you had things that could speak but where not an animal it could use it (for example maybe you had a <code>IRobot</code> too)."}, {"owner": {"reputation": 19, "user_id": 5289573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WtZfPdyI5s0/AAAAAAAAAAI/AAAAAAAAAA0/cgnFxJDX3IU/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/5289573/eric"}, "edited": false, "score": 0, "creation_date": 1487188024, "post_id": 42258525, "comment_id": 71675094, "body": "Ok, and confirming then you&#39;re saying that all methods should be implemented from an interface somewhere?"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 19, "user_id": 5289573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WtZfPdyI5s0/AAAAAAAAAAI/AAAAAAAAAA0/cgnFxJDX3IU/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/5289573/eric"}, "edited": false, "score": 0, "creation_date": 1487188370, "post_id": 42258525, "comment_id": 71675297, "body": "You follow a pattern where it makes sense, some places it does not make sense. For example a DTO object that has properties and no methods does not make sense to have a interface for."}], "tags": [], "owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "is_accepted": true, "score": 0, "last_activity_date": 1487187704, "last_edit_date": 1487187704, "creation_date": 1487187391, "answer_id": 42258525, "question_id": 42258154, "link": "https://stackoverflow.com/questions/42258154/non-interface-methods/42258525#42258525", "title": "Non-Interface methods", "body": "<p>What you would do is you is have another interface that represent's speaking animals and either inherit from IAnimal or add it as a 2nd interface. Classes that have animals that speak implement the 2nd interface.</p>\n\n<p>with a inherited interface.</p>\n\n<pre><code>public interface IAnimal\n{\n    void Eat();\n}\n\npublic interface ISpeakingAnimal : IAnimal\n{\n    string Speak();\n}\n\npublic class Cat : ISpeakingAnimal \n{\n    public Cat()\n\n    public void Eat()\n    { \n         //Do something\n    }\n\n\n    public string Speak()\n    {\n        return \"meow\";\n    }\n}\n\npublic class Fish : IAnimal \n{\n    public Fish()\n\n    public void Eat()\n    { \n         //Do something\n    }\n}\n</code></pre>\n\n<p>With a 2nd decorator interface</p>\n\n<pre><code>public interface IAnimal\n{\n    void Eat();\n}\n\npublic interface ISpeakable\n{\n    string Speak();\n}\n\npublic class Cat : IAnimal, ISpeakable\n{\n    public Cat()\n\n    public void Eat()\n    { \n         //Do something\n    }\n\n    public string Speak()\n    {\n        return \"meow\";\n    }\n}\n\npublic class Fish : IAnimal \n{\n    public Fish()\n\n    public void Eat()\n    { \n         //Do something\n    }\n}\n</code></pre>\n\n<p>If you need the method not be <code>Speak()</code> but instead be <code>Meow()</code> you can use explicit interface implementations to expose the <code>Speak()</code> method only though that interface.</p>\n\n<pre><code>public class Cat : ISpeakingAnimal \n{\n    public Cat()\n\n    public void Eat()\n    { \n         //Do something\n    }\n\n\n    string ISpeakingAnimal.Speak()\n    {\n        return Meow();\n    }\n\n    public string Meow()\n    {\n        return \"meow\";\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 186, "user_id": 6552642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/llIOQ.png?s=128&g=1", "display_name": "Chrygore", "link": "https://stackoverflow.com/users/6552642/chrygore"}, "is_accepted": false, "score": 1, "last_activity_date": 1487188161, "creation_date": 1487188161, "answer_id": 42258738, "question_id": 42258154, "link": "https://stackoverflow.com/questions/42258154/non-interface-methods/42258738#42258738", "title": "Non-Interface methods", "body": "<p>The point of an interface is to define behavior common to classes that implement that interface. You are correct in noting that defining cat like so:</p>\n\n<pre><code>    IAnimal cat = new Cat();\n</code></pre>\n\n<p>leaves you unable to access methods in the Cat class that are not in IAnimal. So why is it encouraged to implement things in this way?</p>\n\n<p>The answer is simple: it makes it very easy to change the code later on. For example, if we have a Dog class that implements IAnimal, like so:</p>\n\n<pre><code>    public class Dog : IAnimal\n    {\n        // some methods\n    }\n</code></pre>\n\n<p>then we can very easily replace our Cat class with the Dog class, without having to change any other code. In other words, we can replace:</p>\n\n<pre><code>    IAnimal cat = new Cat();\n</code></pre>\n\n<p>with</p>\n\n<pre><code>    IAnimal dog = new Dog();\n</code></pre>\n\n<p>without having to change <strong>any</strong> other code in the entire program (besides the variable names). This is because defining Cat and Dog with respect to IAnimal forces them to only use methods found within IAnimal, though they may be implemented differently in Cat and Dog.</p>\n\n<p>Of course, if you want to use something specific only to Cat or Dog, you will have to define the class explicitly, as mentioned by @Erick in his answer, like so:</p>\n\n<pre><code>    Cat cat = new Cat();\n</code></pre>\n\n<p>In general, you should try to define as many common behaviors in the interface as possible, only explicitly casting to a certain class like Cat or Dog when absolutely necessary. This makes your code a lot more versatile and changeable.</p>\n"}, {"tags": [], "owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "is_accepted": false, "score": 0, "last_activity_date": 1487189613, "creation_date": 1487189613, "answer_id": 42259123, "question_id": 42258154, "link": "https://stackoverflow.com/questions/42258154/non-interface-methods/42259123#42259123", "title": "Non-Interface methods", "body": "<p>My two cents on this topic is that it's true that you need to depend on abstractions (i.e. <em>interfaces</em>) rather than implementations. </p>\n\n<p>BTW, doesn't this going too far? There's no need to define an interface for any class within your object model. Usually you define interfaces if you need to accept certain objects fulfilling a given contract.</p>\n\n<p>For example, I wouldn't define <code>IAnimal</code> or <code>ICat</code> interfaces. Probably I would define an abstract class <code>Animal</code> and just a concrete class <code>Cat</code>. </p>\n\n<p>If for some reason I need to accept living beings in some API that could <em>eat</em> I would define an interface like this:</p>\n\n<pre><code>public interface IFeedable\n{\n      void Feed(Food food);\n}\n</code></pre>\n\n<p>and if a living being can <em>talk</em>:</p>\n\n<pre><code>public interface ITalkative\n{\n     void Talk(Food food);\n}\n</code></pre>\n\n<p>Unless there's no feature/property/behavior that could be exclusive to animals, I would leave these interfaces <em>as is</em>.</p>\n\n<pre><code>public abstract class Animal : ITalkative, IFeedable\n{\n     public Animal(AudioPlayer audioPlayer)\n     {\n          AudioPlayer = audioPlayer;\n     }\n\n     private AudioPlayer AudioPlayer { get; }\n\n     public abstract void Feed(Food food);\n\n     public void Talk()\n     {\n           // Probably you would want to load an animal sound library\n           // here, and later pass the audio player with the sound library\n           // already loaded\n           OnTalk(AudioPlayer.LoadLibrary(\"animals\"));\n     }\n\n     protected abstract void OnTalk(AudioLibrary audioLibrary);\n}\n\npublic sealed class Cat : Animal\n{\n      public Cat(AudioPlayer audioPlayer) : base(audioPlayer) \n      {\n      }\n\n      public override void Feed(Food food)\n      {\n           if(food is Vegetable)\n           {\n                throw new NotSupportedException(\"MeeEEEEooW (=O \u00f2.\u00f3)=O!!\");\n           }\n           else if(food is Meat)\n           {\n               // Proceed to eat this meat!\n           }\n      }\n\n      protected override void OnTalk(AudioLibrary audioLibrary)\n      {\n            audioLibrary.Play(\"sweet-cat\");\n      }\n}\n</code></pre>\n\n<p>And if somewhere you need to make an object to talk:</p>\n\n<pre><code>ITalkative talkative = some as ITalkative;\n\nif(talkative != null)\n{\n    talkative.Talk();\n}\n</code></pre>\n\n<p>Or if you need to feed the object:</p>\n\n<pre><code>IFeedable feedable = some as IFeedable;\n\nif(feedable != null)\n{\n    feedable.Feed(new Vegetable());\n}\n</code></pre>\n\n<p>As you can see, you don't define interfaces for everything, but just for those things that you need to handle inside some API and you don't care who can do some actions and/or own some data, but you just care about the object can do or exposes certain behaviors and data respectively.</p>\n"}], "owner": {"reputation": 19, "user_id": 5289573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WtZfPdyI5s0/AAAAAAAAAAI/AAAAAAAAAA0/cgnFxJDX3IU/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/5289573/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 1, "closed_date": 1487191941, "accepted_answer_id": 42258525, "answer_count": 4, "score": 0, "last_activity_date": 1487189613, "creation_date": 1487186011, "question_id": 42258154, "link": "https://stackoverflow.com/questions/42258154/non-interface-methods", "closed_reason": "Needs more focus", "title": "Non-Interface methods", "body": "<p>I have been reading up on programing to interfaces rather than implementation. One area I am not properly understanding is how to deal with non-interface methods. For example an interface IAnimal and a Cat class that implements it. My examples are in C# but I think it should also apply to other languages.</p>\n\n<pre><code>public interface IAnimal\n{\n    void Eat();\n\n}\n\n    public class Cat : IAnimal\n    {\n\n    public Cat()\n\n    public void Eat()\n    { \n         //Do something\n    }\n\n\n    public string Meow()\n    {\n        return \"meow\";\n    }\n\n}\n</code></pre>\n\n<p>From what I've read it seems like I should be trying to work with the interface rather than the cat implementation such as,</p>\n\n<pre><code>Main()\n{\n    IAnimal cat = new Cat();\n}\n</code></pre>\n\n<p>But this leaves me without access to my meow method as it is not a part of the IAnimal interface. Should I be creating another interface ICat which implements IAnimals and have Cat implement it? And does this mean that all methods should be an implementation from an interface or abstract class? Or am I doing something else here wrong.</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c#", "xamarin", "xamarin.android", "xamarin.forms"], "comments": [{"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1487186994, "post_id": 42258108, "comment_id": 71674550, "body": "You would need to launch the MainLauncher Activity (the one that inits <code>Xamarin.Forms</code>) with some Intent extras, then pass those extras into the Form&#39;s Application and open the appropriate Form-based Page based upon that info."}, {"owner": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1487188179, "post_id": 42258108, "comment_id": 71675181, "body": "@SushiHangover thanks for the reply! can you please provide me a link or some example code  on how to do that?"}], "answers": [{"comments": [{"owner": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "edited": false, "score": 0, "creation_date": 1487256771, "post_id": 42259841, "comment_id": 71710756, "body": "thank you so much for the sample I tried your example and have run into a few issues first off when i click the math button it opens the forms part of the app but it opens the main home page not the math page heres a gitlist of the current code based on you example: <a href=\"https://gist.github.com/TeamBrainStorm/aaedf7a44440895960d23052d6de1b32\" rel=\"nofollow noreferrer\">gist.github.com/TeamBrainStorm/aaedf7a44440895960d23052d6de1&zwnj;&#8203;b32</a> can you please take  look and let me know what i&#39;m doing wrong? Thanks in advance :)"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "reply_to_user": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "edited": false, "score": 0, "creation_date": 1487257326, "post_id": 42259841, "comment_id": 71711224, "body": "@Phoneswapshop It <i>looks</i> right, place breakpoint on the line <code>LoadApplication(new App(page));</code> what is the value of the page variable? is it &quot;Math&quot;? or null?"}, {"owner": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "edited": false, "score": 0, "creation_date": 1487258032, "post_id": 42259841, "comment_id": 71711797, "body": "after placing a breakpoint on the LoadApplication(new App(page)); I found that  page variable is null how do I go about fixing that?please let me know and thank you for all the help so far! :)"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "reply_to_user": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "edited": false, "score": 0, "creation_date": 1487259619, "post_id": 42259841, "comment_id": 71712968, "body": "@Phoneswapshop That mean an extra can not be found that has the &quot;page&quot; key, Place a breakpoint on the line <code>intent.PutExtra(&quot;page&quot;, &quot;Math&quot;);</code> and on the <code>switch (pageName)</code> line and trace the results to ensure the page is being passed properly..."}, {"owner": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "edited": false, "score": 0, "creation_date": 1487259895, "post_id": 42259841, "comment_id": 71713215, "body": "i did as you said and the pageName value is null as well any tips on how to fix this? please let me know :)"}, {"owner": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "edited": false, "score": 0, "creation_date": 1487259991, "post_id": 42259841, "comment_id": 71713307, "body": "I just did a clean and uninstalled the app from my device and reinstalled and it works now! thank you so much for all your help!!"}, {"owner": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "edited": false, "score": 0, "creation_date": 1487260834, "post_id": 42259841, "comment_id": 71714105, "body": "i&#39;m starting to see what you meant about the Forms Page life-cycles going wanky any suggestions on how to go about fixing that?"}], "tags": [], "owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "is_accepted": true, "score": 1, "last_activity_date": 1487192018, "creation_date": 1487192018, "answer_id": 42259841, "question_id": 42258108, "link": "https://stackoverflow.com/questions/42258108/how-to-open-a-xamarin-forms-page-from-a-xamarin-droid-activity-from-a-onclick-li/42259841#42259841", "title": "How to open a Xamarin Forms page from a Xamarin Droid Activity from a onclick listener", "body": "<p>Here is a simple example...</p>\n\n<h3>A NON-Form's based Page Selection <code>Activity</code>:</h3>\n\n<p>User taps a button and we create an <code>Intent</code> to open the main Forms' based <code>Activity</code> and add a string <code>Extra</code> with the \"page\" that that user selected.</p>\n\n<pre><code>[Activity(Label = \"PageSelectionActivity\", Theme = \"@style/MyTheme\",  Name = \"com.sushhangover.openpage.PageSelectionActivity\")]\npublic class PageSelectionActivity : AppCompatActivity\n{\n    protected override void OnCreate(Bundle savedInstanceState)\n    {\n        base.OnCreate(savedInstanceState);\n        SetContentView(Resource.Layout.PageSelection);\n        Button button = FindViewById&lt;Button&gt;(Resource.Id.myButton);\n        button.Click += delegate \n        {\n            var intent = new Intent(ApplicationContext, typeof(MainActivity));\n            intent.PutExtra(\"page\", \"StackOverflowPage\");\n            StartActivity(intent);          \n        };\n    }\n}\n</code></pre>\n\n<h3>Modify your <code>MainActivity</code> to obtain the Extra (if any) and pass it to the App .actor:</h3>\n\n<pre><code>[Activity(Label = \"OpenPage.Droid\", Icon = \"@drawable/icon\", Theme = \"@style/MyTheme\", MainLauncher = true, ConfigurationChanges = ConfigChanges.ScreenSize | ConfigChanges.Orientation)]\npublic class MainActivity : global::Xamarin.Forms.Platform.Android.FormsAppCompatActivity\n{\n    protected override void OnCreate(Bundle savedInstanceState)\n    {\n        TabLayoutResource = Resource.Layout.Tabbar;\n        ToolbarResource = Resource.Layout.Toolbar;\n\n        base.OnCreate(savedInstanceState);\n\n        global::Xamarin.Forms.Forms.Init(this, savedInstanceState);\n\n        var page = Intent.GetStringExtra(\"page\");\n        LoadApplication(new App(page));\n    }\n}\n</code></pre>\n\n<h3>Modify the App default .actor to accept parameter and act upon it:</h3>\n\n<pre><code>public class App : Application\n{\n    public App(string pageName = \"SomeDefaultMainApplicationEntryPage\")\n    {\n        switch (pageName)\n        {\n            case \"StackOverflowPage\":\n                MainPage = new NavigationPage(new StackOverflowPage);\n                break;\n            default:\n                MainPage = new NavigationPage(new SomeDefaultMainApplicationEntryPage);\n                break;\n        }\n    }\n}\n</code></pre>\n\n<h3>Testing</h3>\n\n<p>You can open the page selection Activity using adb to launch it:</p>\n\n<pre><code>adb shell am start -n com.sushhangover.openpage/.PageSelectionActivity\n</code></pre>\n\n<p><strong>Note:</strong> You will need to handle the <code>Xamarin.Form</code> Page life-cycles as it can get messy depending upon if your <code>ToolBelt</code> Activity is opened while the user already has your app open and it is in the middle of some activity and you destroy their work by <em>re-starting</em> the app....</p>\n"}], "owner": {"reputation": 1229, "user_id": 4665575, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2313fa7c0af6890a8ab58a46df14662c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoneswapshop", "link": "https://stackoverflow.com/users/4665575/phoneswapshop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 1, "accepted_answer_id": 42259841, "answer_count": 1, "score": 0, "last_activity_date": 1561780322, "creation_date": 1487185863, "last_edit_date": 1561780322, "question_id": 42258108, "link": "https://stackoverflow.com/questions/42258108/how-to-open-a-xamarin-forms-page-from-a-xamarin-droid-activity-from-a-onclick-li", "title": "How to open a Xamarin Forms page from a Xamarin Droid Activity from a onclick listener", "body": "<p>I am working on adding an assist feature to my app that when the user holds down on the home button an android activity opens with cards that the user can click on that then opens the xamarin forms page in question for example when the math card is clicked the MathPage xamarin forms page opens here's my android layout code:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;RelativeLayout xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:id=\"@+id/activity_tools_home_view\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"&gt;\n    &lt;RelativeLayout\n        android:layout_width=\"wrap_content\"\n        android:layout_height=\"wrap_content\"\n        android:paddingTop=\"10dp\"\n        android:id=\"@+id/whole\"\n        tools:context=\"${relativePackage}.${activityClass}\"\n        tools:layout_editor_absoluteY=\"0dp\"\n        tools:layout_editor_absoluteX=\"0dp\"&gt;\n        &lt;LinearLayout\n            android:layout_width=\"wrap_content\"\n            android:id=\"@+id/scroll\"\n            android:layout_height=\"wrap_content\"&gt;\n            &lt;android.support.v7.widget.CardView\n                android:id=\"@+id/one\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"wrap_content\"\n                app:cardBackgroundColor=\"@color/cardsbg\"\n                app:cardElevation=\"3dp\"\n                android:clickable=\"false\"\n                tools:layout_conversion_absoluteX=\"16dp\"\n                tools:layout_conversion_absoluteY=\"8dp\"\n                tools:layout_conversion_absoluteWidth=\"379dp\"\n                tools:layout_conversion_absoluteHeight=\"540dp\"&gt;\n                &lt;RelativeLayout\n                    android:layout_width=\"match_parent\"\n                    android:layout_height=\"wrap_content\"&gt;\n                    &lt;android.support.v7.widget.CardView\n                        android:id=\"@+id/webcard\"\n                        android:layout_width=\"match_parent\"\n                        android:layout_height=\"wrap_content\"\n                        android:layout_marginBottom=\"4dp\"\n                        android:layout_marginRight=\"8dp\"\n                        android:layout_marginLeft=\"8dp\"\n                        android:layout_marginTop=\"8dp\"\n                        android:foreground=\"?android:attr/selectableItemBackground\"\n                        app:cardBackgroundColor=\"@color/card_background\"\n                        app:cardElevation=\"3dp\"\n                        android:clickable=\"true\"\n                        android:onClick=\"web\"&gt;\n                        &lt;RelativeLayout\n                            android:layout_width=\"match_parent\"\n                            android:layout_height=\"match_parent\"&gt;\n                            &lt;ImageView\n                                android:id=\"@+id/webicon\"\n                                android:layout_width=\"68dp\"\n                                android:layout_height=\"68dp\"\n                                android:layout_centerVertical=\"true\"\n                                android:padding=\"5dp\"\n                                android:src=\"@drawable/web\" /&gt;\n                            &lt;TextView\n                                android:id=\"@+id/web\"\n                                android:layout_width=\"wrap_content\"\n                                android:layout_height=\"wrap_content\"\n                                android:layout_centerVertical=\"true\"\n                                android:layout_toRightOf=\"@id/webicon\"\n                                android:text=\"Internet\"\n                                android:paddingLeft=\"8dp\"\n                                android:textColor=\"@color/cardText\"\n                                android:textSize=\"20sp\" /&gt;\n                        &lt;/RelativeLayout&gt;\n                    &lt;/android.support.v7.widget.CardView&gt;\n                    &lt;android.support.v7.widget.CardView\n                        android:id=\"@+id/mailcard\"\n                        android:layout_width=\"match_parent\"\n                        android:layout_height=\"wrap_content\"\n                        android:foreground=\"?android:attr/selectableItemBackground\"\n                        android:layout_marginBottom=\"4dp\"\n                        android:layout_marginRight=\"8dp\"\n                        android:layout_marginLeft=\"8dp\"\n                        android:layout_marginTop=\"4dp\"\n                        android:layout_below=\"@+id/webcard\"\n                        app:cardBackgroundColor=\"@color/card_background\"\n                        app:cardElevation=\"3dp\"\n                        android:clickable=\"true\"\n                        android:onClick=\"email\"&gt;\n                        &lt;RelativeLayout\n                            android:layout_width=\"match_parent\"\n                            android:layout_height=\"match_parent\"&gt;\n                            &lt;ImageView\n                                android:id=\"@+id/emailicon\"\n                                android:layout_width=\"68dp\"\n                                android:layout_height=\"68dp\"\n                                android:layout_centerVertical=\"true\"\n                                android:padding=\"5dp\"\n                                android:src=\"@drawable/email\" /&gt;\n                            &lt;TextView\n                                android:id=\"@+id/email\"\n                                android:layout_width=\"wrap_content\"\n                                android:layout_height=\"wrap_content\"\n                                android:paddingLeft=\"8dp\"\n                                android:layout_centerVertical=\"true\"\n                                android:layout_toRightOf=\"@id/emailicon\"\n                                android:text=\"Email\"\n                                android:textColor=\"@color/cardText\"\n                                android:textSize=\"20sp\" /&gt;\n                        &lt;/RelativeLayout&gt;\n                    &lt;/android.support.v7.widget.CardView&gt;\n                    &lt;android.support.v7.widget.CardView\n                        android:id=\"@+id/mathcard\"\n                        android:layout_width=\"match_parent\"\n                        android:layout_height=\"wrap_content\"\n                        android:foreground=\"?android:attr/selectableItemBackground\"\n                        android:layout_marginBottom=\"4dp\"\n                        android:layout_marginRight=\"8dp\"\n                        android:layout_marginLeft=\"8dp\"\n                        android:layout_marginTop=\"4dp\"\n                        android:layout_below=\"@+id/mailcard\"\n                        app:cardBackgroundColor=\"@color/card_background\"\n                        app:cardElevation=\"3dp\"\n                        android:clickable=\"true\"\n                        android:onClick=\"math\"&gt;\n                        &lt;RelativeLayout\n                            android:layout_width=\"match_parent\"\n                            android:layout_height=\"match_parent\"&gt;\n                            &lt;ImageView\n                                android:id=\"@+id/musicicon\"\n                                android:layout_width=\"68dp\"\n                                android:layout_height=\"68dp\"\n                                android:layout_centerVertical=\"true\"\n                                android:padding=\"5dp\"\n                                android:src=\"@drawable/math\" /&gt;\n                            &lt;TextView\n                                android:id=\"@+id/music\"\n                                android:layout_width=\"wrap_content\"\n                                android:layout_height=\"wrap_content\"\n                                android:layout_centerVertical=\"true\"\n                                android:layout_toRightOf=\"@id/musicicon\"\n                                android:text=\"Math\"\n                                android:paddingLeft=\"8dp\"\n                                android:textColor=\"@color/cardText\"\n                                android:textSize=\"20sp\" /&gt;\n                        &lt;/RelativeLayout&gt;\n                    &lt;/android.support.v7.widget.CardView&gt;\n                    &lt;android.support.v7.widget.CardView\n                        android:id=\"@+id/scicard\"\n                        android:layout_width=\"match_parent\"\n                        android:layout_height=\"wrap_content\"\n                        android:foreground=\"?android:attr/selectableItemBackground\"\n                        android:layout_marginBottom=\"8dp\"\n                        android:layout_marginRight=\"8dp\"\n                        android:layout_marginLeft=\"8dp\"\n                        android:layout_marginTop=\"4dp\"\n                        android:layout_below=\"@+id/mathcard\"\n                        app:cardBackgroundColor=\"@color/card_background\"\n                        app:cardElevation=\"3dp\"\n                        android:clickable=\"true\"\n                        android:onClick=\"science\"&gt;\n                        &lt;RelativeLayout\n                            android:layout_width=\"match_parent\"\n                            android:layout_height=\"match_parent\"&gt;\n                            &lt;ImageView\n                                android:id=\"@+id/playicon\"\n                                android:layout_width=\"68dp\"\n                                android:layout_height=\"68dp\"\n                                android:layout_centerVertical=\"true\"\n                                android:padding=\"8dp\"\n                                android:src=\"@drawable/sci\" /&gt;\n                            &lt;TextView\n                                android:id=\"@+id/play\"\n                                android:layout_width=\"match_parent\"\n                                android:layout_height=\"wrap_content\"\n                                android:layout_centerVertical=\"true\"\n                                android:paddingLeft=\"8dp\"\n                                android:layout_toRightOf=\"@+id/playicon\"\n                                android:text=\"Science\"\n                                android:textColor=\"@color/cardText\"\n                                android:textSize=\"20sp\" /&gt;\n                        &lt;/RelativeLayout&gt;\n                    &lt;/android.support.v7.widget.CardView&gt;\n                    &lt;android.support.v7.widget.CardView\n                        android:id=\"@+id/englishcard\"\n                        android:layout_width=\"match_parent\"\n                        android:layout_height=\"wrap_content\"\n                        android:foreground=\"?android:attr/selectableItemBackground\"\n                        android:layout_marginBottom=\"8dp\"\n                        android:layout_marginRight=\"8dp\"\n                        android:layout_marginLeft=\"8dp\"\n                        android:layout_marginTop=\"4dp\"\n                        android:layout_below=\"@+id/scicard\"\n                        app:cardBackgroundColor=\"@color/card_background\"\n                        app:cardElevation=\"3dp\"\n                        android:clickable=\"true\"\n                        android:onClick=\"english\"&gt;\n                        &lt;RelativeLayout\n                            android:layout_width=\"match_parent\"\n                            android:layout_height=\"match_parent\"&gt;\n                            &lt;ImageView\n                                android:id=\"@+id/playicon\"\n                                android:layout_width=\"68dp\"\n                                android:layout_height=\"68dp\"\n                                android:layout_centerVertical=\"true\"\n                                android:padding=\"8dp\"\n                                android:src=\"@drawable/handwrittin\" /&gt;\n                            &lt;TextView\n                                android:id=\"@+id/play\"\n                                android:layout_width=\"match_parent\"\n                                android:layout_height=\"wrap_content\"\n                                android:layout_centerVertical=\"true\"\n                                android:paddingLeft=\"8dp\"\n                                android:layout_toRightOf=\"@+id/playicon\"\n                                android:text=\"Handwriting\"\n                                android:textColor=\"@color/cardText\"\n                                android:textSize=\"20sp\" /&gt;\n                        &lt;/RelativeLayout&gt;\n                    &lt;/android.support.v7.widget.CardView&gt;\n                    &lt;android.support.v7.widget.CardView\n                        android:id=\"@+id/flashcard\"\n                        android:layout_width=\"match_parent\"\n                        android:layout_height=\"wrap_content\"\n                        android:foreground=\"?android:attr/selectableItemBackground\"\n                        android:layout_marginBottom=\"8dp\"\n                        android:layout_marginRight=\"8dp\"\n                        android:layout_marginLeft=\"8dp\"\n                        android:layout_marginTop=\"4dp\"\n                        android:layout_below=\"@+id/englishcard\"\n                        app:cardBackgroundColor=\"@color/card_background\"\n                        app:cardElevation=\"3dp\"\n                        android:clickable=\"true\"\n                        android:onClick=\"flashcard\"&gt;\n                        &lt;RelativeLayout\n                            android:layout_width=\"match_parent\"\n                            android:layout_height=\"match_parent\"&gt;\n                            &lt;ImageView\n                                android:id=\"@+id/playicon\"\n                                android:layout_width=\"68dp\"\n                                android:layout_height=\"68dp\"\n                                android:layout_centerVertical=\"true\"\n                                android:padding=\"8dp\"\n                                android:src=\"@drawable/flashcards\" /&gt;\n                            &lt;TextView\n                                android:id=\"@+id/play\"\n                                android:layout_width=\"match_parent\"\n                                android:layout_height=\"wrap_content\"\n                                android:layout_centerVertical=\"true\"\n                                android:paddingLeft=\"8dp\"\n                                android:layout_toRightOf=\"@+id/playicon\"\n                                android:text=\"Flashcards\"\n                                android:textColor=\"@color/cardText\"\n                                android:textSize=\"20sp\" /&gt;\n                        &lt;/RelativeLayout&gt;\n                    &lt;/android.support.v7.widget.CardView&gt;\n                    &lt;RelativeLayout\n                        android:id=\"@+id/bttom\"\n                        android:layout_width=\"match_parent\"\n                        android:layout_height=\"wrap_content\"\n                        android:layout_below=\"@id/flashcard\"\n                        android:paddingTop=\"8dp\"\n                        android:layout_marginBottom=\"8dp\"&gt;\n                        &lt;Button\n                            android:id=\"@+id/button_2\"\n                            android:onClick=\"cam\"\n                            android:foreground=\"?android:attr/selectableItemBackground\"\n                            android:layout_alignParentLeft=\"true\"\n                            android:layout_marginLeft=\"50dp\"\n                            android:layout_width=\"50dp\"\n                            android:layout_height=\"50dp\"\n                            android:background=\"@drawable/settings\" /&gt;\n                        &lt;Button\n                            android:id=\"@+id/button_1\"\n                            android:onClick=\"settings\"\n                            android:foreground=\"?android:attr/selectableItemBackground\"\n                            android:layout_alignParentRight=\"true\"\n                            android:layout_marginRight=\"50dp\"\n                            android:layout_width=\"50dp\"\n                            android:layout_height=\"50dp\"\n                            android:background=\"@drawable/settings\" /&gt;\n                    &lt;/RelativeLayout&gt;\n                &lt;/RelativeLayout&gt;\n            &lt;/android.support.v7.widget.CardView&gt;\n        &lt;/LinearLayout&gt;\n        &lt;Button\n            android:layout_width=\"72dp\"\n            android:layout_height=\"72dp\"\n            android:id=\"@+id/button_4\"\n            android:onClick=\"now\"\n            android:layout_marginTop=\"-42dp\"\n            android:layout_below=\"@+id/scroll\"\n            android:foreground=\"?android:attr/selectableItemBackground\"\n            android:clipToPadding=\"false\"\n            android:layout_centerHorizontal=\"true\"\n            android:background=\"@drawable/books\" /&gt;\n    &lt;/RelativeLayout&gt;\n&lt;/RelativeLayout&gt;\n</code></pre>\n\n<p>heres my code behind:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nusing Android.App;\nusing Android.Content;\nusing Android.Content.PM;\nusing Android.OS;\nusing Android.Runtime;\nusing Android.Views;\nusing Android.Widget;\nusing Xamarin.Forms.Platform.Android;\n\nnamespace AppName.Droid\n{\n[Activity(LaunchMode = LaunchMode.SingleInstance, Theme = \"@style/Theme.Transparent\")]\n    [IntentFilter(new[] { Intent.ActionAssist }, Categories = new[] { Intent.CategoryDefault })]    \n    public class ToolBelt : FormsApplicationActivity\n    {\n\n        Button mathbutton;\n\n        protected override void OnCreate(Bundle bundle)\n        {\n            base.OnCreate(bundle);\n\n            // Set our view from the \"main\" layout resource\n            SetContentView(Resource.Layout.ToolBelt);\n\n        }\n\n\n        //Code That Opens The Math  Part!\n\n        [Java.Interop.Export(\"math\")] // The value found in android:onClick attribute.\n        public void btnOneClick4(View v) // Does not need to match value in above attribute.\n        {\n\n            //code to open the MathPage Forms Page Goes here\n        }\n\n        //Code That Opens The Internet  App!\n\n        [Java.Interop.Export(\"web\")] // The value found in android:onClick attribute.\n        public void btnOneClick8(View v) // Does not need to match value in above attribute.\n        {\n            var uri = Android.Net.Uri.Parse(\"http://www.google.com\");\n            var intent = new Intent(Intent.ActionView, uri);\n            StartActivity(intent);\n        }\n\n\n\n        //Code That Opens The Gmail App!\n\n        [Java.Interop.Export(\"email\")] // The value found in android:onClick attribute.\n        public void btnOneClick3(View v) // Does not need to match value in above attribute.\n        {\n            var intent = PackageManager.GetLaunchIntentForPackage(\"com.google.android.gm\");\n            StartActivity(intent);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "amazon-web-services", "amazon-s3"], "owner": {"reputation": 11, "user_id": 7570823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c9efec8f9454d058579924dd24bd7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Mourao", "link": "https://stackoverflow.com/users/7570823/rafael-mourao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487186859, "creation_date": 1487185583, "last_edit_date": 1487186859, "question_id": 42258035, "link": "https://stackoverflow.com/questions/42258035/c-amazon-web-service-get-contents-from-an-external-bucket-with-paid-access", "title": "C# Amazon Web Service - Get contents from an external bucket with paid access", "body": "<p>I'm running a code that returns the following error:</p>\n\n<blockquote>\n  <p>Access Denied</p>\n</blockquote>\n\n<p>When I try to get content using the S3 Browser, it displays an alert that access is paid, and then I can access the content. How do I setup my request to accept paid access?</p>\n\n<pre><code>string accessKey = \"******\";\nstring secretKey = \"******\";\n\nAmazonS3Config config = new AmazonS3Config();\nconfig.ServiceURL = \"https://s3.amazonaws.com\";\n\nAmazonS3Client s3Client = new AmazonS3Client(accessKey, secretKey, config);\n\nListObjectsRequest request = new ListObjectsRequest();\nrequest.BucketName = \"******\";\n\nListObjectsResponse response = s3Client.ListObjects(request);\n</code></pre>\n\n<p>Alert form S3 Browser:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LEfab.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LEfab.png\" alt=\"Alert form S3 Browser\"></a></p>\n"}]