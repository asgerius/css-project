[{"tags": ["c#"], "answers": [{"tags": [], "owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "is_accepted": true, "score": 0, "last_activity_date": 1499905766, "creation_date": 1499905766, "answer_id": 45069610, "question_id": 45069353, "link": "https://stackoverflow.com/questions/45069353/how-to-set-time-between-calls/45069610#45069610", "title": "How to set time between calls", "body": "<p>You can create a class with a <code>ConcurrentQueue</code> to hold your parameters.</p>\n\n<p>When creating the class you can start a timer that fires every 2/6 seconds. </p>\n\n<p>The timer call back can check if there are any items in your queue and if so make your method call.</p>\n\n<p>Alternately you can add delegates to your queue and the timer can invoke the delegates.</p>\n"}], "owner": {"reputation": 1173, "user_id": 384936, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/5044d0567cc7ae2e52cbd511958e2c15?s=128&d=identicon&r=PG", "display_name": "junkone", "link": "https://stackoverflow.com/users/384936/junkone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 45069610, "answer_count": 1, "score": 0, "last_activity_date": 1499905766, "creation_date": 1499903995, "question_id": 45069353, "link": "https://stackoverflow.com/questions/45069353/how-to-set-time-between-calls", "title": "How to set time between calls", "body": "<p>IB has rules that I cannot run more than 6 of these calls in 2 seconds. I have been running into the pacing rules and need to find a work around. Can I save the method call(Historicaldata) as object and call it periodically?\nI do have multiple threads that call into this method and need to find a solution to pause between calls to ibClient.ClientSocket.reqHistoricalData for every 6 consecutive calls.</p>\n\n<pre><code>private void Historicaldata(int tickerId, Contract contract, string endDateTime,\n        string durationString, string barSizeSetting, string whatToShow, int useRTH, int formatDate, List&lt;TagValue&gt; chartOptions)\n    {\n        ibClient.ClientSocket.reqHistoricalData(tickerId, contract, endDateTime, durationString, barSizeSetting, whatToShow, useRTH, formatDate, null);\n    }\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "asp.net-mvc", "authentication", "asp.net-identity"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 8298821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689d23cfbe3412ae6c3893a34ac86b35?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8298821/robert"}, "edited": false, "score": 0, "creation_date": 1499918819, "post_id": 45070080, "comment_id": 77115107, "body": "Using FindByIdAsync does not solve the problem.  I&#39;m still getting the same error, UserId not found.  Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.   Exception Details: System.InvalidOperationException: UserId not found."}], "tags": [], "owner": {"reputation": 35, "user_id": 3448869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1bb730c4f49d95b34fd431284df5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Desmond", "link": "https://stackoverflow.com/users/3448869/desmond"}, "is_accepted": false, "score": 0, "last_activity_date": 1499909816, "creation_date": 1499909816, "answer_id": 45070080, "question_id": 45069351, "link": "https://stackoverflow.com/questions/45069351/using-aspnet-identity-with-existing-ms-sql-server-userid-not-found-error/45070080#45070080", "title": "Using aspnet Identity with existing MS SQL Server, UserId not found error", "body": "<p>If you have the userid change await UserManager.FindByNameAsync(id) ->  await UserManager.FindByIdAsync(Id)</p>\n\n<p>FindByNameAsync -> is finding for the matching username</p>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 8298821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689d23cfbe3412ae6c3893a34ac86b35?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8298821/robert"}, "edited": false, "score": 0, "creation_date": 1499918799, "post_id": 45070334, "comment_id": 77115103, "body": "Using FindByIdAsync does not solve the problem.  I&#39;m still getting the same error, UserId not found.  Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.   Exception Details: System.InvalidOperationException: UserId not found."}, {"owner": {"reputation": 31485, "user_id": 809357, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fe164036841e4bc8029ea2f842a5e5d7?s=128&d=identicon&r=PG", "display_name": "trailmax", "link": "https://stackoverflow.com/users/809357/trailmax"}, "reply_to_user": {"reputation": 123, "user_id": 8298821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689d23cfbe3412ae6c3893a34ac86b35?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8298821/robert"}, "edited": false, "score": 1, "creation_date": 1499939325, "post_id": 45070334, "comment_id": 77126551, "body": "@Robert is value of <code>UserId</code> null by any chance?"}, {"owner": {"reputation": 123, "user_id": 8298821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689d23cfbe3412ae6c3893a34ac86b35?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8298821/robert"}, "edited": false, "score": 0, "creation_date": 1499957039, "post_id": 45070334, "comment_id": 77140434, "body": "I can&#39;t find where the UserId is.  This article seems to be related however it doesn&#39;t appear to apply to me. <a href=\"https://stackoverflow.com/questions/34946575/createuseridenityasync-returns-userid-not-found-exception-for-custom-identityu\" title=\"createuseridenityasync returns userid not found exception for custom identityu\">stackoverflow.com/questions/34946575/&hellip;</a>  I don&#39;t have  UserId in my IdentityUser class."}], "tags": [], "owner": {"reputation": 1469, "user_id": 3397630, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001259654258/picture?type=large", "display_name": "Karthik Elumalai", "link": "https://stackoverflow.com/users/3397630/karthik-elumalai"}, "is_accepted": false, "score": 0, "last_activity_date": 1499911758, "creation_date": 1499911758, "answer_id": 45070334, "question_id": 45069351, "link": "https://stackoverflow.com/questions/45069351/using-aspnet-identity-with-existing-ms-sql-server-userid-not-found-error/45070334#45070334", "title": "Using aspnet Identity with existing MS SQL Server, UserId not found error", "body": "<p>Hi  you can use this method <a href=\"https://msdn.microsoft.com/en-us/library/dn497542(v=vs.108).aspx\" rel=\"nofollow noreferrer\">UserManager.FindByIdAsync Method</a>, it will Finds a user by ID.</p>\n\n<p>ex:</p>\n\n<pre><code> var user = await UserManager.FindByIdAsync(userid);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 8298821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689d23cfbe3412ae6c3893a34ac86b35?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8298821/robert"}, "is_accepted": true, "score": 1, "last_activity_date": 1499979501, "creation_date": 1499979501, "answer_id": 45090772, "question_id": 45069351, "link": "https://stackoverflow.com/questions/45069351/using-aspnet-identity-with-existing-ms-sql-server-userid-not-found-error/45090772#45090772", "title": "Using aspnet Identity with existing MS SQL Server, UserId not found error", "body": "<p>I removed </p>\n\n<pre><code>var userIdentity = await manager.CreateIdentityAsync(this, DefaultAuthenticationTypes.ApplicationCookie);\n</code></pre>\n\n<p>and replaced it with </p>\n\n<pre><code>    var userIdentity = new ClaimsIdentity(new[]\n        {\n                // adding following 2 claims for supporting default antiforgery provider\n                new Claim(ClaimTypes.NameIdentifier, this.UserName),\n                new Claim(\"http://schemas.microsoft.com/accesscontrolservice/2010/07/claims/identityprovider\", \"ASP.NET Identity\", \"http://www.w3.org/2001/XMLSchema#string\"),\n                new Claim(ClaimTypes.Name, this.UserName),\n                new Claim(\"AspNet.Identity.SecurityStamp\", this.SecurityStamp),\n                //new Claim(ClaimTypes.Role, AppRoleClaims.Client),\n                new Claim(ClaimTypes.Sid, this.Id.ToString())\n        },\n    DefaultAuthenticationTypes.ApplicationCookie);\n</code></pre>\n\n<p>I found this code at <a href=\"https://stackoverflow.com/questions/41851239/how-can-i-log-a-client-in-asp-net-mvc-with-no-user\">How can I log a Client in Asp.Net MVC with no user</a>. It appears to have solved the issue I was having.</p>\n"}], "owner": {"reputation": 123, "user_id": 8298821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/689d23cfbe3412ae6c3893a34ac86b35?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/8298821/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 45090772, "answer_count": 3, "score": 0, "last_activity_date": 1499979501, "creation_date": 1499903958, "question_id": 45069351, "link": "https://stackoverflow.com/questions/45069351/using-aspnet-identity-with-existing-ms-sql-server-userid-not-found-error", "title": "Using aspnet Identity with existing MS SQL Server, UserId not found error", "body": "<p>Hi I'm new to MVC having done web forms for several years. </p>\n\n<p>When users reach our site they are already authenticated by our organization's central authentication service.  We already have all users in our SQL Server database and just need to match their identity and assign the appropriate authorizations.  I customized <a href=\"https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/Readme.txt\" rel=\"nofollow noreferrer\">https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/Readme.txt</a> for use with our existing SQL Server. \nI'm getting a \"UserId not found\" error.\nHere is the stack trace:</p>\n\n<pre><code>[InvalidOperationException: UserId not found.]\n   Microsoft.AspNet.Identity.&lt;GetSecurityStampAsync&gt;d__42.MoveNext() +651\n   System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) +144\n   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) +84\n   System.Runtime.CompilerServices.TaskAwaiter`1.GetResult() +49\n   Microsoft.AspNet.Identity.CultureAwaiter`1.GetResult() +109\n   Microsoft.AspNet.Identity.&lt;CreateAsync&gt;d__0.MoveNext() +1350\n   System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) +144\n   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) +84\n   System.Runtime.CompilerServices.TaskAwaiter`1.GetResult() +49\n   Security.Models.&lt;GenerateUserIdentityAsync&gt;d__0.MoveNext() in T:\\Security\\Models\\IdentityModels.cs:16\n   System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) +144\n   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) +84\n   Microsoft.AspNet.Identity.Owin.&lt;SignInAsync&gt;d__2.MoveNext() +437\n   System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task) +144\n   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) +84\n   Security.Controllers.&lt;Login&gt;d__10.MoveNext() in T:\\Security\\Controllers\\AccountController.cs:77\n</code></pre>\n\n<p>Here is where the error occurs in IdentityModel.cs:   </p>\n\n<pre><code> public async Task&lt;ClaimsIdentity&gt; GenerateUserIdentityAsync(UserManager&lt;ApplicationUser&gt; manager)\n    {\n        var userIdentity = await manager.CreateIdentityAsync(this, DefaultAuthenticationTypes.ApplicationCookie);\n</code></pre>\n\n<p>Below is my AccountController.cs code based on:\n<a href=\"https://stackoverflow.com/questions/28110934/asp-net-mvc-identity-login-without-password\">ASP.NET MVC Identity login without password</a></p>\n\n<pre><code>    var user = await UserManager.FindByNameAsync(id);\n\n    var result = await UserManager.CreateAsync(user);\n    if (result.Succeeded)\n    {\n        await SignInManager.SignInAsync(user, isPersistent: true, rememberBrowser: true);\n    }\n</code></pre>\n"}, {"tags": ["c#"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8298921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca0b65172316cfa33cc0bdff4096ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Delmar O&#39;DOyle", "link": "https://stackoverflow.com/users/8298921/delmar-odoyle"}, "edited": false, "score": 0, "creation_date": 1499905002, "post_id": 45069463, "comment_id": 77112064, "body": "thanks that worked to to stop the timer at 10, i still need to tweak the power of the throw and all that just wanted to get it working first. For some reason player.transformer.rotation = Quaternion.identity doesn&#39;t work."}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "reply_to_user": {"reputation": 1, "user_id": 8298921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca0b65172316cfa33cc0bdff4096ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Delmar O&#39;DOyle", "link": "https://stackoverflow.com/users/8298921/delmar-odoyle"}, "edited": false, "score": 0, "creation_date": 1499905348, "post_id": 45069463, "comment_id": 77112145, "body": "sorry its &#39;player.transform.rotation = Quaternion.identity&#39;, i made a typing error :("}], "tags": [], "owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "is_accepted": false, "score": 0, "last_activity_date": 1499905363, "last_edit_date": 1499905363, "creation_date": 1499904668, "answer_id": 45069463, "question_id": 45069331, "link": "https://stackoverflow.com/questions/45069331/cant-get-my-player-to-rotate-back-to-0-0-0-when-respawning/45069463#45069463", "title": "Can&#39;t get my player to rotate back to 0,0,0 when respawning", "body": "<p>I think <code>player.transform.rotation = Quaternion.identity</code> should work.</p>\n\n<p>Let's take a look at that :</p>\n\n<pre><code>        if (Input.GetMouseButton (0)) {\n\n            if (powerTimer == 10) {\n                powerTimer = 10;\n\n            } else if (powerTimer &lt; 10) {\n                powerTimer = powerTimer + Time.deltaTime;\n                ballThrowingForce = ballThrowingForce + 2 * powerTimer;\n\n\n            }\n        }\n</code></pre>\n\n<p>This part is absurd :</p>\n\n<pre><code>if (powerTimer == 10) {\n    powerTimer = 10;\n}\n</code></pre>\n\n<p>Should be <code>powerTimer &gt;= 10</code>.</p>\n\n<p>And after, you execute <code>powerTimer += Time.deltaTime</code> which seems good, but <code>ballThrowingForce += 2 * powerTimer</code> is not what you want i think. Here ballThrowingForce is growing exponentially with powerTimer. Should perhaps be <code>ballThrowingForce += 2 * Time.deltaTime</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8298921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca0b65172316cfa33cc0bdff4096ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Delmar O&#39;DOyle", "link": "https://stackoverflow.com/users/8298921/delmar-odoyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499905363, "creation_date": 1499903848, "last_edit_date": 1499904001, "question_id": 45069331, "link": "https://stackoverflow.com/questions/45069331/cant-get-my-player-to-rotate-back-to-0-0-0-when-respawning", "title": "Can&#39;t get my player to rotate back to 0,0,0 when respawning", "body": "<p>I am making a basketball game where you shoot then the ball is positioned back into your hands after a timer runs out and you are sent back to your default position to shoot again. I can't get the player to rotate back to 0,0,0 though. any advice would be greatly appreciated.(This is my first game and i'm kinda winging it so i'm sure the rest of my code that works is still horrible, its a learning experience so any constructive criticism is welcome.)</p>\n\n<p>My code...</p>\n\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\npublic class Player : MonoBehaviour {\n\n    public Ball ball;\n    public GameObject playerCamera;\n\n\n    public float ballDistance = 2f;\n    public float ballThrowingForce = 5f;\n    public float powerTimer = 0f;\n\n    public bool holdingBall = true;\n\n    public Player player;\n\n    public float resetTimer = 5f;\n\n\n\n    // Use this for initialization\n    void Start () {\n        ball.GetComponent&lt;Rigidbody&gt; ().useGravity = false;\n\n    }\n\n    // Update is called once per frame\n    void Update ()\n    {\n        if (holdingBall) {\n            {\n                ball.transform.position = playerCamera.transform.position + playerCamera.transform.forward * ballDistance;\n\n            }\n            if (Input.GetMouseButton (0)) {\n\n                if (powerTimer == 10) {\n                    powerTimer = 10;\n\n                } else if (powerTimer &lt; 10) {\n                    powerTimer = powerTimer + Time.deltaTime;\n                    ballThrowingForce = ballThrowingForce + 2 * powerTimer;\n\n\n                }\n            }\n\n        }           \n\n\n        if (holdingBall) {\n            if (Input.GetMouseButtonUp (0)) {\n\n                holdingBall = false;\n                ball.GetComponent&lt;Rigidbody&gt; ().useGravity = true;\n                ball.GetComponent&lt;Rigidbody&gt; ().AddForce (playerCamera.transform.position + playerCamera.transform.forward * ballThrowingForce);\n\n            }       \n\n        }\n        if (player.holdingBall == false) {\n            resetTimer -= Time.deltaTime;\n            if (resetTimer &lt;= 0) {\n\n                player.transform.position = new Vector3 (-0.2427547f, 2.6f, -2.357f);\n                // player roation to 0,0,0 here\n\n                holdingBall = true;\n                ball.GetComponent&lt;Rigidbody&gt; ().useGravity = false;\n                powerTimer = 0;\n                ballThrowingForce = 400;\n                resetTimer = 5;\n\n            }       \n            if (Input.GetKeyDown (KeyCode.Return)) {\n                resetTimer = 0;\n\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sql", "performance", "tsql", "polling"], "comments": [{"owner": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "edited": false, "score": 0, "creation_date": 1499904217, "post_id": 45069312, "comment_id": 77111857, "body": "What kind of efficiency are you interested in?"}, {"owner": {"reputation": 1, "user_id": 8128622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9af63a2793c747edcb4e16e21d8528?s=128&d=identicon&r=PG&f=1", "display_name": "bluria", "link": "https://stackoverflow.com/users/8128622/bluria"}, "reply_to_user": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "edited": false, "score": 0, "creation_date": 1499904505, "post_id": 45069312, "comment_id": 77111947, "body": "Trying to see which will slow down the application the least. Not looking for which is more efficient in reporting changes quickly. I guess to elaborate further, I am storing my appSettings in a table instead of web.config. I want to be able to reflect changes to the table. Since the amount of data is small, I don&#39;t really have a preference for cache or static variable. My focus is more on which method of notification will have the highest toll on the application"}], "owner": {"reputation": 1, "user_id": 8128622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f9af63a2793c747edcb4e16e21d8528?s=128&d=identicon&r=PG&f=1", "display_name": "bluria", "link": "https://stackoverflow.com/users/8128622/bluria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499903694, "creation_date": 1499903694, "question_id": 45069312, "link": "https://stackoverflow.com/questions/45069312/sleeping-connections-vs-constant-polling-sql", "title": "sleeping connections vs constant polling SQL", "body": "<p>What has more of a toll on efficiency, a sleeping SQL connection or constant database polling? </p>\n\n<p>I'm trying to decide between using SqlDependency or SqlCacheDependency to monitor changes to our database. The SqlDependnecy creates a sleeping connection which I've read doesn't really create that much of a strain, but isn't it bad to leave an open connection? I've also read that SqlCacheDependency uses SqlDependency but you can specify polling time which makes me think it acts a bit differently.</p>\n\n<p>If polling is a better route, at what rate of polling does the effect become less efficient?</p>\n\n<p>Any thoughts would be much appreciated!</p>\n"}, {"tags": ["c#", ".net", "winforms", "draw"], "comments": [{"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1499903865, "post_id": 45069294, "comment_id": 77111762, "body": "You&#39;re not supposed to draw outside your view. If I&#39;m misunderstanding, you will have to <a href=\"https://stackoverflow.com/help/mcve\">post code</a> that shows your problem."}, {"owner": {"reputation": 1, "user_id": 8298917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da60f22519d437daa2c2f71c80f1ca4f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Rubinstein", "link": "https://stackoverflow.com/users/8298917/daniel-rubinstein"}, "reply_to_user": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1499904900, "post_id": 45069294, "comment_id": 77112042, "body": "I&#39;m not trying to draw outside of view. I&#39;m drawing onto the panel but then scrolling down, thus bringing the rectangle out of view. The problem is that when scrolling back up, the drawings dissapear"}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1499940407, "post_id": 45069294, "comment_id": 77127387, "body": "Show the drawing code! How can we help when we don&#39;t see what you are actually doing?? (I hope you are using the Paint event and not CreateGraphics !?!?)"}], "answers": [{"tags": [], "owner": {"reputation": 217, "user_id": 5097178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yjoO3.png?s=128&g=1", "display_name": "Bloopy", "link": "https://stackoverflow.com/users/5097178/bloopy"}, "is_accepted": false, "score": 0, "last_activity_date": 1499909212, "creation_date": 1499909212, "answer_id": 45069995, "question_id": 45069294, "link": "https://stackoverflow.com/questions/45069294/how-would-i-stop-panels-from-erasing-rectangles-ive-drawn-when-i-scroll-down/45069995#45069995", "title": "How would I stop panels from erasing rectangles I&#39;ve drawn when I scroll down?", "body": "<p>Funnily enough, the answer to your question about scrolling will actually solve the drawing problem. The solution is to add a 3rd panel with <code>AutoScroll</code> set to true. Then place your existing two panels inside that one. Don't dock them, but rather set them to their full size. The parent panel's scrollbar will scroll both and instruct them to repaint as needed.</p>\n\n<p>Also see <a href=\"https://stackoverflow.com/a/18718476/5097178\">this answer</a>. It's better to derive your own class from Panel and draw on that.</p>\n\n<p>For future reference, when you are drawing directly on an <code>AutoScroll</code> panel, use <code>TranslateTransform</code> to account for the scrolling. This solves the drawing issue for me:</p>\n\n<pre><code>private void Panel1_Paint(object sender, PaintEventArgs e) {\n    e.Graphics.TranslateTransform(panel1.AutoScrollPosition.X, panel1.AutoScrollPosition.Y);\n\n    // draw something...\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8298917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da60f22519d437daa2c2f71c80f1ca4f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Rubinstein", "link": "https://stackoverflow.com/users/8298917/daniel-rubinstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499909212, "creation_date": 1499903548, "question_id": 45069294, "link": "https://stackoverflow.com/questions/45069294/how-would-i-stop-panels-from-erasing-rectangles-ive-drawn-when-i-scroll-down", "title": "How would I stop panels from erasing rectangles I&#39;ve drawn when I scroll down?", "body": "<p>I'm coding a charting control in C# for the .net framework. I basically have a split panel where I write the names on one side and draw rectangles on the other for the actual graph portion of the control. However, I've realized that every time I scroll down, it erases the part of the rectangles that go out of the panel's view. How do I prevent this? </p>\n\n<p>Side question, how do I make the scroll bar for the second panel work for both. I'm fairly new to some of this stuff so I apologize if anything here is fairly elementary or already answered. Thanks for your time!</p>\n"}, {"tags": ["c#", "asp.net", "threadpool"], "comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499904566, "post_id": 45069269, "comment_id": 77111959, "body": "You would have to modify the DLL&#39;s IL to add the attribute, so that when the JITter compiles the code, it knows what to do. You&#39;re not going to be able to change the nature of the variable after the fact. <i>&quot;This library is unfortunately built to have only one client...i have many clients&quot;</i> -- there&#39;s your problem. Use a different library, or even re-implement the functionality yourself. The library you&#39;re using just wasn&#39;t build to support your scenario."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499904568, "post_id": 45069269, "comment_id": 77111960, "body": "If you really <i>must</i> use this library, one option might be to create an AppDomain for each client. This is <i>very</i> heavyweight though; it will only scale so far, and if &quot;many clients&quot; means 100 or more, I doubt it would work. You&#39;d probably start running into trouble at the dozen or two mark, I&#39;d guess."}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499904973, "post_id": 45069269, "comment_id": 77112057, "body": "Actually this library is about 1M lines and is professional (my job is to create a web interface for them). I already thought about AppDomains, and as you mentioned, impossible with the memory it needs after only 30 or 40 clients."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499905776, "post_id": 45069269, "comment_id": 77112244, "body": "<i>&quot;my job is to create a web interface for them&quot;</i> -- if they are your client, you should work with them to address the limitation. There&#39;s not enough context in your question to know what specifically needs to be changed, but they&#39;re the ones who painted you into the corner. They should help you get back out. Barring that, maybe instead of AppDomains, just run one process per client; in theory that should be <i>worse</i> than AppDomains, but you might avoid some marshaling overhead and Windows might do a better job of partitioning the work than .NET does. Just a thought, might not be worth anything."}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499906256, "post_id": 45069269, "comment_id": 77112350, "body": "It&#39;s not my client, i work in the company ! I know the code of this library, i can modify it. But putting a ThreadStatic on this field would be catastrophic since it is used in many threads through the code. And i don&#39;t want to change a so important field just for a web interface. I&#39;ll try the process separation."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499906555, "post_id": 45069269, "comment_id": 77112416, "body": "Sorry, I&#39;m confused. Your original question was <i>&quot;how to dynamically put a variable on ThreadStatic?&quot;</i>. I took that to mean you were unable to apply the attribute directly in code, but only because you did not have access to the code. Now, you seem to be saying you <i>do</i> have access to the code and can modify it, but don&#39;t want to because doing so would be &quot;catastrophic&quot;. If you believe it would be catastrophic to apply the attribute directly, why do you think it would help to do the same thing, only &quot;dynamically&quot;?"}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499907136, "post_id": 45069269, "comment_id": 77112561, "body": "You&#39;re right, the problem is a bit more precise. On my webapi, i want to use the code provided by my library (which probably use threads too), but with a Client dependant to the thread i use. I just want to &quot;trick&quot; the system to have &quot;multiple&quot; static variables, one per thread. Perhaps ThreadStatic is not the solution, because as you mentionned it impacts ALL the threads, including those in the library itself. I hope i&#39;m clear."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499907382, "post_id": 45069269, "comment_id": 77112603, "body": "Sounds like a pretty broad architectural problem that you and your coworkers are going to have to work out together. I doubt Stack Overflow is going to be able to help, not without a much more specific and detailed question, that includes a good <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and a clear description of all applicable constraints and requirements."}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499907738, "post_id": 45069269, "comment_id": 77112674, "body": "Post edited. The problem i have with my coworker is not very interesting here, no ? Just try to solve the problem, and if it&#39;s not enough explicit, tell me."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499906610, "post_id": 45069614, "comment_id": 77112432, "body": "Because my library don&#39;t use the method &quot;GetClient()&quot; you create, it uses &quot;Client&quot; everywhere, and Client is created somewhere at initialisation IN the library, so i can&#39;t (or exactly i don&#39;t want to) modify it."}, {"owner": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "reply_to_user": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499907038, "post_id": 45069614, "comment_id": 77112541, "body": "Ah. I understand now."}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499908166, "post_id": 45069614, "comment_id": 77112758, "body": "Haha that&#39;s not good enough ;) my requests are asking for large amounts of data treatment, which takes about 4 or 5 seconds. So imagine if i have 100 clients at the same time ... I&#39;ll take a look at the Reflection, seems interesting."}, {"owner": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "reply_to_user": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499908303, "post_id": 45069614, "comment_id": 77112793, "body": "1. Would you have 100 clients? 2. Can you queue?"}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499908501, "post_id": 45069614, "comment_id": 77112839, "body": "1. Definitely possible.    2. Queue ? I can, but it would lead to a long wait ..."}, {"owner": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "reply_to_user": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499908793, "post_id": 45069614, "comment_id": 77112911, "body": "What about: accept, queue, return, process in the background?"}, {"owner": {"reputation": 1859, "user_id": 911905, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7b449367f90af519434dcfeeed8127f?s=128&d=identicon&r=PG", "display_name": "Oleh Nechytailo", "link": "https://stackoverflow.com/users/911905/oleh-nechytailo"}, "reply_to_user": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499909058, "post_id": 45069614, "comment_id": 77112982, "body": "@FaZeGa my idea is to create a pool of workers - appdomains or separate processes, that will process the queue. That&#39;s how you&#39;ll avoid a heavy cost of creating new AppDomains/Processes, but also you&#39;ll get good enough relatively scalable parallel processing"}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "edited": false, "score": 0, "creation_date": 1499909150, "post_id": 45069614, "comment_id": 77113007, "body": "By return i assume wait for new requests ? Then when you got a new request, it means a new client and so you can&#39;t process anything since the &quot;Client&quot; variable is locked."}, {"owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "reply_to_user": {"reputation": 1859, "user_id": 911905, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f7b449367f90af519434dcfeeed8127f?s=128&d=identicon&r=PG", "display_name": "Oleh Nechytailo", "link": "https://stackoverflow.com/users/911905/oleh-nechytailo"}, "edited": false, "score": 0, "creation_date": 1499909298, "post_id": 45069614, "comment_id": 77113044, "body": "@OlehNechytailo actually a nice idea !"}], "tags": [], "owner": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "is_accepted": false, "score": 0, "last_activity_date": 1499908316, "last_edit_date": 1499908316, "creation_date": 1499905801, "answer_id": 45069614, "question_id": 45069269, "link": "https://stackoverflow.com/questions/45069269/use-dll-static-variable-in-different-threads/45069614#45069614", "title": "Use DLL static variable in different threads", "body": "<p>(Answer changed in the light of the first comment)</p>\n\n<p>I would just lock all access and do one thing at a time. </p>\n\n<p>If that's not good enough, I would argue it's good enough.</p>\n\n<p>Then I would see if I can queue the work. </p>\n\n<p>Then I would look into reflection <code>System.Reflection.LoadAssembly</code>, but after reading  <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/deployment/best-practices-for-assembly-loading\" rel=\"nofollow noreferrer\">Best Practices for Assembly Loading</a> (from 2017-03-30). :)</p>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "is_accepted": false, "score": 0, "last_activity_date": 1499966924, "creation_date": 1499966924, "answer_id": 45087392, "question_id": 45069269, "link": "https://stackoverflow.com/questions/45069269/use-dll-static-variable-in-different-threads/45087392#45087392", "title": "Use DLL static variable in different threads", "body": "<p>After hours of research i conclude that the only (and logical) way is to create AppDomains or separate processes.\nI'll perhaps follow the @OlehNechytailo suggestion.</p>\n"}], "owner": {"reputation": 197, "user_id": 7343478, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/i21Nk.jpg?s=128&g=1", "display_name": "fazega", "link": "https://stackoverflow.com/users/7343478/fazega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1499967017, "creation_date": 1499903393, "last_edit_date": 1499967017, "question_id": 45069269, "link": "https://stackoverflow.com/questions/45069269/use-dll-static-variable-in-different-threads", "title": "Use DLL static variable in different threads", "body": "<p>I have an ASP.Net WebAPI (MVC) served by IIS Express which uses an external dll library.\nThis library is unfortunately built to have only one client, this means it has a static variable \"Client\" it uses everywhere.</p>\n\n<p>So if i have many clients, for each request i have to switch this static variable to the client that did the request.\nThe problem is that this way, i need to \"lock\" the variable, and therefore not allow other clients to request.</p>\n\n<p>I don't know exactly the way IIS manages its threads with the thread pool, but i think it should be something like one thread per request. So putting this \"Client\" variable to ThreadStatic could do the job since its value would be different for each thread, but since \"Client\" is used in intern threads of the library, it should generate lot of bugs.</p>\n\n<p>To explain more precisely what i want, consider this situation :</p>\n\n<p>You have a piece of code like that, which represents my library :</p>\n\n<pre><code>class Client {\n     void doSomething() {}\n     void blabla() {}\n}\n\nstatic Client c;\n\n... Code here, probably involving c in threads ...\n\npublic void function() {\n     c.blabla();\n}\n</code></pre>\n\n<p>And in my application, i have multiple threads which want to call doSomething(), and function() at the same time. So they need to \"trick\" the compiler to create a local variable and put it in the 'c' variable.\nHope it helps.</p>\n"}, {"tags": ["c#", "entity-framework", "asp.net-core", "json.net", "entity-framework-core"], "comments": [{"owner": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 0, "creation_date": 1499909850, "post_id": 45069235, "comment_id": 77113174, "body": "its  State Management of the graphs, since it doesn&#39;t know how to handle the insertions of the Org(s), none of the Orgs actually get Id&#39;s till they are pushed to the database with a <code>SaveChanges()</code> which you never do in the first loop before jumping into the Portfolios, if there is an Id I would be surprised. Same thing with Portfolios to Projects I believe."}, {"owner": {"reputation": 3976, "user_id": 220255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f971b4f294f2a834a1cca619a4663376?s=128&d=identicon&r=PG", "display_name": "abolotnov", "link": "https://stackoverflow.com/users/220255/abolotnov"}, "reply_to_user": {"reputation": 3485, "user_id": 981141, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1658c2b271f57ce35dd4ecd917101573?s=128&d=identicon&r=PG", "display_name": "mvermef", "link": "https://stackoverflow.com/users/981141/mvermef"}, "edited": false, "score": 0, "creation_date": 1499910827, "post_id": 45069235, "comment_id": 77113402, "body": "I tried saving changes as soon as an object is added - no cure"}, {"owner": {"reputation": 21093, "user_id": 150342, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15059b386eb3a25b97852a9a6e2d20ac?s=128&d=identicon&r=PG", "display_name": "Colin", "link": "https://stackoverflow.com/users/150342/colin"}, "edited": false, "score": 0, "creation_date": 1499936325, "post_id": 45069235, "comment_id": 77124352, "body": "Why does Entity Framework Reinsert Existing Objects into My Database? <a href=\"http://msdn.microsoft.com/en-us/magazine/dn166926.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/magazine/dn166926.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3976, "user_id": 220255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f971b4f294f2a834a1cca619a4663376?s=128&d=identicon&r=PG", "display_name": "abolotnov", "link": "https://stackoverflow.com/users/220255/abolotnov"}, "is_accepted": true, "score": 2, "last_activity_date": 1499914071, "creation_date": 1499914071, "answer_id": 45070618, "question_id": 45069235, "link": "https://stackoverflow.com/questions/45069235/ef-core-i-end-up-with-duplicates-in-database-when-importing-records-with-json-n/45070618#45070618", "title": "EF Core: I end up with duplicates in database when importing records with json.net", "body": "<p>The problem has nothing to do with the EntityFramework or the Context or the Database. The problem is with how Newtonsoft JSON mapper works. Not that it's a problem but it's totally unexpected that while converting a portion of the JSON file <code>.ToObject&lt;T&gt;()</code>, it will create underlying objects <em>(I assume)</em> if their name conversions match relationship between object classes. It did so for <code>Portfolio</code> and <code>Project</code> but didn't do this for the <code>Users</code> collection since there is no relationship between the models. </p>\n\n<p>I wish it wasn't doing this so implicitly but it's what it is. I am sharing this just in case someone bumps into this trouble.</p>\n\n<p>The resulting code would need to look like this:</p>\n\n<pre><code>public void CreateOrgStructure(string path = \"/Test/TestData.json\"){\n        string DataFilePath = AppContext.BaseDirectory + path;\n        JObject json = JObject.Parse(File.ReadAllText(DataFilePath));\n        foreach (JToken OrgToken in json[\"Orgs\"])\n            {\n                Debug.WriteLine(\"Org \"+OrgToken[\"Name\"]);\n                Org o = OrgToken.ToObject&lt;Org&gt;();\n                _cont.Orgs.Add(o);\n                _cont.SaveChanges();\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 3976, "user_id": 220255, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f971b4f294f2a834a1cca619a4663376?s=128&d=identicon&r=PG", "display_name": "abolotnov", "link": "https://stackoverflow.com/users/220255/abolotnov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 45070618, "answer_count": 1, "score": 1, "last_activity_date": 1499914189, "creation_date": 1499903164, "last_edit_date": 1499914189, "question_id": 45069235, "link": "https://stackoverflow.com/questions/45069235/ef-core-i-end-up-with-duplicates-in-database-when-importing-records-with-json-n", "title": "EF Core: I end up with duplicates in database when importing records with json.net", "body": "<p>I will start with the code that causes trouble just in case there is something super obvious that I am missing:</p>\n\n<pre><code>foreach(JToken OrgToken in json[\"Orgs\"]) {\n    Debug.WriteLine(\"Org \" + OrgToken[\"Name\"]);\n    Org o = OrgToken.ToObject &lt; Org &gt; ();\n    _cont.Orgs.Add(o);\n    _influxClient.CreateDatabaseAsync(o.MetricDatabaseName);\n\n    foreach(JToken PortfolioToken in OrgToken[\"Portfolios\"]) {\n        Debug.WriteLine(\"Portfolio \" + PortfolioToken[\"Name\"]);\n        Portfolio p = PortfolioToken.ToObject &lt; Portfolio &gt; ();\n        p.OrganizationId = o.Id;\n        _cont.Portfolios.Add(p);\n\n        foreach(JObject ProjectToken in PortfolioToken[\"Projects\"]) {\n            Debug.WriteLine(\"Project \" + ProjectToken[\"Name\"]);\n            Project prj = ProjectToken.ToObject &lt; Project &gt; ();\n            prj.PortfolioId = p.Id;\n            _cont.Projects.Add(prj);\n            _cont.SaveChanges();\n        }\n    }\n}\n_cont.SaveChanges();\n</code></pre>\n\n<p>This code will load a hierarchy of related objects (Org->Portfolio->Project) from a JSON file:</p>\n\n<pre><code>{\n  \"Orgs\": [\n    {\n      \"Name\": \"StrongSoft\",\n      \"Users\": [\n        {\n          \"email\": \"StrongSoftAdmin@clevereer.com\",\n          \"password\": \"password\",\n          \"IsOrgAdmin\": true\n        },\n        {\n          \"email\": \"StrongSoftReadOnly@clevereer.com\",\n          \"password\": \"password\",\n          \"IsOrgAdmin\": false\n        }\n      ],\n      \"Portfolios\": [\n        {\n          \"Name\": \"Financial\",\n          \"Projects\": [\n            { \"Name\": \"Derivatives Trading\" },\n            { \"Name\": \"Fixed Income\" },\n            { \"Name\": \"Fix Market Connector\" }\n          ]\n        },\n        {\n          \"Name\": \"Machinery\",\n          \"Projects\": [\n            { \"Name\": \"Hard Metal Stuff\" },\n            { \"Name\": \"Health Management Framework\" },\n            { \"Name\": \"Look and Poock\" }\n          ]\n        },\n        {\n          \"Name\": \"Lab\",\n          \"Projects\": [\n            { \"Name\": \"!@#$%^&amp;*()_+++++++++w+\" },\n            { \"Name\": \"\u041a\u0430\u043a\u043e\u0435-\u0442\u043e \u0441\u0442\u0440\u0430\u043d\u043d\u043e\u0435 \u0438\u043c\u044f, \u044d\u0442\u043e \u043a\u0430\u043f\u0435\u0446\" },\n            { \"Name\": \"\" }\n          ]\n        }\n      ]\n    },\n    {\n      \"Name\": \"Clevereer\",\n      \"Users\": [\n        {\n          \"email\": \"ClevereerAdmin@clevereer.com\",\n          \"password\": \"password\",\n          \"IsOrgAdmin\": true\n        },\n        {\n          \"email\": \"ClevereerReadOnly@clevereer.com\",\n          \"password\": \"password\",\n          \"IsOrgAdmin\": false\n        }\n      ],\n      \"Portfolios\": [\n        {\n          \"Name\": \"Prospects\",\n          \"Projects\": [\n            { \"Name\": \"AI Assisted Surveillance\" },\n            { \"Name\": \"Metrics Keeper\" }\n          ]\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>The problem is that when this runs, I end up having 2 duplicates for each of the <code>Portfolio</code> objects and 3 duplicates for each of the <code>Project</code>. <code>Org</code> comes with no duplicates.</p>\n\n<p>I have made sure that the loops make proper number of \"stops\" and the objects are only attempted to be created once (hence the <code>Debug.WriteLine()</code>):</p>\n\n<pre><code>Org StrongSoft\nPortfolio Financial\nProject Derivatives Trading\nProject Fixed Income\nProject Fix Market Connector\nPortfolio Machinery\nProject Hard Metal Stuff\nProject Health Management Framework\nProject Look and Poock\nPortfolio Lab\nProject !@#$%^&amp;*()_+++++++++w+\nProject \u041a\u0430\u043a\u043e\u0435-\u0442\u043e \u0441\u0442\u0440\u0430\u043d\u043d\u043e\u0435 \u0438\u043c\u044f, \u044d\u0442\u043e \u043a\u0430\u043f\u0435\u0446\nProject \nOrg Clevereer\nPortfolio Prospects\nProject AI Assisted Surveillance\nProject Metrics Keeper\n</code></pre>\n\n<p>I tried <code>SaveChanges()</code> and <code>Attach()</code> routines</p>\n\n<p>I tried altering <code>EntityState</code> of added objects so that EF does not assume they are changed and tries to re-create them</p>\n\n<p>Nothing is working out for me.</p>\n\n<p>I suspect the roots of the problem are in the relationships but I only refer/set to the <code>Id</code> fields (this does not seem to trigger population of the <code>Navigation Property</code> of the related model - why is this causing a problem?) What I don't know if I am not saving the objects correctly or it's the entities design that isn't right. When I save entities (including defining their relationships) via controllers the duplication does not occur.</p>\n\n<p>The entities and their relationships are fairly straightforward:</p>\n\n<pre><code>public class Org : BaseEntity, IEntityBase\n    {\n        public string Name { get; set; }\n        public List&lt;Portfolio&gt; Portfolios { get; set; }\n\n    }\n\npublic class Portfolio : BaseEntity, IEntityBase\n    {\n        public string Name { get; set; }\n\n        public int OrganizationId { get; set; }\n        [ForeignKey(\"OrganizationId\")]\n        public virtual Org Organization { get; set; }\n\n        public bool IsPrivate { get; set; }\n        public List&lt;Project&gt; Projects {get;set;}\n    }\n}\n\npublic class Project : BaseEntity, IEntityBase\n    {\n        public string Name { get; set; }\n        public int PortfolioId { get; set; }\n        [ForeignKey(\"PortfolioId\")]\n        public Portfolio Portfolio { get; set; }\n    }\n</code></pre>\n\n<p><strong>Update:</strong> I tried various things to get this fixed, including:</p>\n\n<p>calling <code>_cont.SaveChanges()</code> every time an object is added to dbSet:</p>\n\n<pre><code>Org o = OrgToken.ToObject&lt;Org&gt;();\n_cont.Orgs.Add(o);\n_cont.SaveChanges();\n</code></pre>\n\n<p>Retrieving a saved object from the database to create the relationship:</p>\n\n<pre><code>Portfolio p = PortfolioToken.ToObject&lt;Portfolio&gt;();\np.OrganizationId = _cont.Orgs.Find(o.Id).Id;\n_cont.Portfolios.Add(p);\n_cont.SaveChanges();\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Portfolio p = PortfolioToken.ToObject&lt;Portfolio&gt;();\np.Organization = _cont.Orgs.Find(o.Id);\n_cont.Portfolios.Add(p);\n_cont.SaveChanges(); \n</code></pre>\n\n<p>or</p>\n\n<pre><code>Portfolio p = PortfolioToken.ToObject&lt;Portfolio&gt;();\np.Organization = _cont.Find&lt;Org&gt;(p.id);\n_cont.Portfolios.Add(p);\n_cont.SaveChanges();\n</code></pre>\n\n<p>My Context is nothing fancy, I don't think there is anything that could impact it:</p>\n\n<pre><code>public class CoreContext : DbContext\n{\n    public DbSet&lt;Org&gt; Orgs { get; set; }\n    public DbSet&lt;Portfolio&gt; Portfolios { get; set; }\n    public DbSet&lt;Project&gt; Projects { get; set; }\n    public DbSet&lt;Metric&gt; Metrics { get; set; }\n    public DbSet&lt;OrgAccess&gt; OrgAccess { get; set; }\n\n    public CoreContext(DbContextOptions&lt;CoreContext&gt; options) : base(options) { } \n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n        {\n            foreach (var relationship in modelBuilder.Model.GetEntityTypes().SelectMany(e =&gt; e.GetForeignKeys()))\n            {\n                relationship.DeleteBehavior = DeleteBehavior.Restrict;\n            }\n\n            modelBuilder.Entity&lt;Org&gt;().ToTable(\"Org\").HasIndex(c=&gt;c.Name).IsUnique();\n            modelBuilder.Entity&lt;Portfolio&gt;().ToTable(\"Portfolio\").HasOne(a =&gt; a.Organization);\n            modelBuilder.Entity&lt;Project&gt;().ToTable(\"Project\");\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "validation", "jwt", "openid", "ihttpmodule"], "owner": {"reputation": 1982, "user_id": 975897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f441258d3a74340373e351d210579e03?s=128&d=identicon&r=PG", "display_name": "doublehelix", "link": "https://stackoverflow.com/users/975897/doublehelix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499913161, "creation_date": 1499903132, "last_edit_date": 1499913161, "question_id": 45069232, "link": "https://stackoverflow.com/questions/45069232/oauth2-without-mvc-asp-net-in-a-class-ihttpmodule", "title": "OAuth2 without MVC/ASP.NET in a class (IHttpModule)", "body": "<p>I'm trying to implement an OAuth2 validation module in .net 4.5.</p>\n\n<p>We have an application that is receiving an access token from another website.</p>\n\n<p>We need to validate this token and map the corresponding user (from claim information) to an internal user in our own system, then create the access cookies for our own system as if the user is already logged in.</p>\n\n<p>We are NOT using ASP.NET, MVC, WebForms or anything else that allows us to use the IAppBuilder required by OpenIdConnect. We are simply implementing an IHttpModule (IIS Plugin) which will do the validation and pre-authentication manually.</p>\n\n<p>I've tried System.IdentityModel.Tokens.Jwt (etc), but all examples on validating access tokens I can find (anywhere) all point to using openIdConnect which requires the MVC model (and the IAppBuilder).</p>\n\n<p>We have the configuration document (<a href=\"https://.../.well-known/openid-configuration\" rel=\"nofollow noreferrer\">https://.../.well-known/openid-configuration</a>) and the keys etc. but no idea how to call the functionality manually to validate the access-token we are given.</p>\n\n<p>I have the access-token in a string. How do I do the validation from scratch?</p>\n\n<p>Any examples, or even links would be helpful.</p>\n\n<p>I'm currently attempting to use the nuget package \"IdentityModel.WPF\" but am still rather stuck.</p>\n"}, {"tags": ["c#", "python", "json", "parsing", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4771750, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/793456644042544/picture?type=large", "display_name": "Houssem Chlegou", "link": "https://stackoverflow.com/users/4771750/houssem-chlegou"}, "edited": false, "score": 0, "creation_date": 1499906510, "post_id": 45069465, "comment_id": 77112405, "body": "hi, thanks for the reply, i liked your idea, i will try first implementing it. what i want is a code written in c# that do the same like my Python code."}], "tags": [], "owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "is_accepted": false, "score": 0, "last_activity_date": 1499904675, "creation_date": 1499904675, "answer_id": 45069465, "question_id": 45069225, "link": "https://stackoverflow.com/questions/45069225/port-python-docx-function-to-c/45069465#45069465", "title": "Port Python-DocX function to C#", "body": "<p>There is no Python to C# conversion service that I know of.</p>\n\n<p>You can however run <a href=\"https://blogs.msdn.microsoft.com/charlie/2009/10/25/running-ironpython-scripts-from-a-c-4-0-program/\" rel=\"nofollow noreferrer\">Python</a> from within your .Net App.</p>\n\n<p>Using IronPython you can actually integrate .Net Code into your Python script and for example set a string property from you Python script.</p>\n\n<p>Alternately, you can just run your Python script from C# and get the result of the python function.</p>\n\n<p>You can try something like this:</p>\n\n<pre><code>static void Main()\n{\n    var ipy = Python.CreateRuntime();\n    dynamic parser = ipy.UseFile(\"WordParser.py\");\n    string docPath = \"C:\\\\SomeFolder\\\\SomeWord.Docx\";\n    var result = parser.parseDocX(docPath,\"somesection);\n}\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 4771750, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/793456644042544/picture?type=large", "display_name": "Houssem Chlegou", "link": "https://stackoverflow.com/users/4771750/houssem-chlegou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499904675, "creation_date": 1499903098, "question_id": 45069225, "link": "https://stackoverflow.com/questions/45069225/port-python-docx-function-to-c", "title": "Port Python-DocX function to C#", "body": "<p>I have a Python function, to take a MSWord document as an input, as well as a section heading/number, and return the table from that section as a JSON object.</p>\n\n<p>Need to convert this python function over to C#, and use the Aspose.Words for .NET library.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>    from __future__ import (\n    absolute_import, division, print_function, unicode_literals\n)\n\nimport json\nfrom docx import Document\nfrom docx.document import Document as _Document\nfrom docx.oxml.text.paragraph import CT_P\nfrom docx.oxml.text.run import CT_R\nfrom docx.oxml.table import CT_Tbl\nfrom docx.table import _Cell, Table\nfrom docx.text.paragraph import Paragraph\nfrom docx.text.run import Run\n#import datetime\nimport sys, traceback\nimport win_unicode_console\nfrom colorama import init\nfrom colorama import Fore, Back, Style\n\n\n#outputFile = open('Document-ToJSON.csv', 'w', newline='\\n')\n#outputWriter = csv.writer(outputFile)\n\ngblDocTree = []\ngblDocListNumber = []\ngblRowCols = {}\n\n\ndef init_myGlobals():\n    #Reinitialize Global Variables\n    #init()\n    win_unicode_console.enable()\n    init()\n    global gblDocTree\n    gblDocTree = []\n    global gblDocListNumber\n    gblDocListNumber = []\n    global gblRowCols\n    gblRowCols = {}\n    return\n\nclass tblparam():\n    def __init__(self,param):\n        self.param = param\n\ndef get_num(x):\n    return int(''.join(ele for ele in x if ele.isdigit()))\n\ndef add_RowCol(rowNumber, rowList):\n    global gblRowCols\n    gblRowCols[rowNumber] = rowList\n    return\n\ndef add_to_sectionnumber(myLocation):\n    global gblDocListNumber\n    myInt = myLocation - 1\n\n    if myLocation &gt; len(gblDocListNumber) or len(gblDocListNumber) == 0:\n        #initializing\n        gblDocListNumber.append(1)\n    elif len(gblDocListNumber) == myLocation:\n        #if total array len is equal to current heading depth\n        #do this\n        gblDocListNumber[myInt] = gblDocListNumber[myInt] + 1\n    #elif myLocation == 1:\n    #   del gblDocListNumber[0:]\n    #   gblDocListNumber[0] = gblDocListNumber[0] + 1\n    elif len(gblDocListNumber) &gt; myLocation:\n        #x = len(gblDocListNumber) - myLocation\n        #print(\"myLocation:{0}, myListCount:{1}\".format(myLocation, len(gblDocListNumber)))\n        #Eliminate everything from\n        del gblDocListNumber[myLocation:]\n        gblDocListNumber[myLocation - 1] = gblDocListNumber[myLocation - 1] + 1\n    return\n\ndef add_to_hierarchy(myHeading, myLocation):\n    #Create a String Array holding the Paragraph\n    #Names, and appending them to previous levels\n    #Heading1 &gt; SubHeading2 &gt; SubHeading3\n    global gblDocTree\n    myInt = myLocation - 1\n    if myLocation &gt; len(gblDocTree) or len(gblDocTree) == 0:\n        gblDocTree.append(myHeading)\n    elif len(gblDocTree) == myLocation:\n        gblDocTree[myInt] = myHeading\n    elif myLocation == 1:\n        del gblDocTree[:]\n        gblDocTree.append(myHeading)\n    elif len(gblDocTree) &gt; myLocation:\n        x = len(gblDocTree) - myLocation\n        #print(\"i'm going to remove -{0}\".format(x))\n        del gblDocTree[myLocation - 1:]\n        gblDocTree.append(myHeading)\n    return\n\ndef iter_block_items(parent):\n    #\"\"\"\n    #Generate a reference to each paragraph and table child within *parent*,\n    #in document order. Each returned value is an instance of either Table or\n    #Paragraph. *parent* would most commonly be a reference to a main\n    #Document object, but also works for a _Cell object, which itself can\n    #contain paragraphs and tables.\n    #\"\"\"\n    if isinstance(parent, _Document):\n        parent_elm = parent.element.body\n        #print(parent_elm.xml)\n    elif isinstance(parent, _Cell):\n        parent_elm = parent._tc\n    else:\n        raise ValueError(\"something's not right\")\n\n    for child in parent_elm.iterchildren():\n        if isinstance(child, CT_P):\n            yield Paragraph(child, parent)\n        elif isinstance(child, CT_Tbl):\n            yield Table(child, parent)\n        #elif isinstance(child, CT_R):\n        #   yield Run(child, parent)\n\ndef parseDocX(mydocumentfullpath, startSection):\n\n    init_myGlobals()    #Initialize \n\n    #Setup variables#\n    myDoc = mydocumentfullpath\n#   f = open(outputCSVPath, 'w', newline='')    #Python 3, newline='' eliminates extra newlines' in output\n    startSectSet = True\n    try:\n\n        document = Document(myDoc)\n        prvHeader = ''\n        headerLst = ['Heading 1',\n                        'Heading 2', 'Heading 3', 'Heading 4',\n                        'Heading 5', 'Heading 6', 'Heading 7',\n                        'Heading 8', 'Heading 9',\n                        'Egemin1', 'Egemin2', 'Egemin3', 'Egemin4',\n                        'Egemin5', 'Egemin6', 'Egemin7', 'Egemin8',\n                        'Egemin9', 'Egemin10', 'Egemin11', 'Egemin12']\n        valNext = False\n        prvIntHeadLv = 0\n        curHeadIntLv = 0\n        curHeadNm = ''\n        curListNm = ''\n        myIntValName = ''\n        myPropCnt = 0\n        sectionJSON = {}\n        paraText = ''\n\n        for block in iter_block_items(document):\n            #print(block.text if isinstance(block, Paragraph) else '&lt;table&gt;')\n            #print('************************')\n            #print('NEW LOOP')\n            if isinstance(block, Paragraph):\n                #print('In Paragraph')\n                #for myRun in block.runs:\n                #   print('Got Runs ?')\n                #   print('Run Text :: {0}'.format(myRun.text))\n                    #print('Style :: {0}'.format(myRun.style.name))\n                #print(block.runs.text)\n                #print(block.text)\n                #print(block.style.name)\n                if block.style.name in headerLst:\n\n                    #New Document Header, so new Section\n                    sectionJSON = {}    #Reset\n                    paraText = ''\n\n                    #Paragraphs contain all doc information.\n                    #Using the above array, we're checking for the most commonly used\n                    #Section/Paragrah Headers\n                    #So we can differentiate what data we are actually processing\n                    curHeadIntLv = get_num(block.style.name)    \n                    add_to_hierarchy(block.text.strip().lower(), curHeadIntLv)\n\n#BOUTIFY CODE\n\n                    if len(block.text.strip().lower())&gt;0:\n                        add_to_sectionnumber(curHeadIntLv)\n                    curListNm = '.'.join(map(str, gblDocListNumber))\n                    curHeadNm = \"%s %s\" % (curListNm, block.text.strip())\n\n                    #Check if Current Section is greater than required Start\n                    if(startSectSet and curListNm!=''):\n                        sectionHeading = curHeadNm.lstrip().split(\" \")[0]   #Use Full Paragraph Header String, to ID true section number\n                        curListTuple = tuple([int(x) for x in sectionHeading.split('.')])\n                        reqStartTuple = tuple([int(x) for x in startSection.split('.')])\n                        if (curListTuple &lt; reqStartTuple):\n                            continue    #Skip iteration\n                        elif (curListTuple &gt; reqStartTuple):\n                            break   #Exit\n\n                    if curHeadIntLv == 1 or prvIntHeadLv == 0:\n                        #curHeadNm = block.text.strip().lower()\n                        prvIntHeadLv = curHeadIntLv\n\n                    elif curHeadIntLv == prvIntHeadLv:\n                        prvIntHeadLv = curHeadIntLv\n                        continue\n\n                    elif curHeadIntLv &gt; prvIntHeadLv:\n                        prvIntHeadLv = curHeadIntLv\n                        continue\n\n                    else:\n                        #curHeadNm = block.text.strip().lower()\n                        prvIntHeadLv = curHeadIntLv\n                        continue\n                else:\n                    curParaText = block.text.strip().lower()\n                    paraText += block.text.strip().lower().replace(\"'\", \"''\")\n\n            elif isinstance(block, Table):  #process table rows, for interesting data\n\n            #Check if Current Section is greater than required Start\n                if(startSectSet and curListNm!=''):\n                    sectionHeading = curHeadNm.lstrip().split(\" \")[0]   #Use Full Paragraph Header String, to ID true section number\n                    curListTuple = tuple([int(x) for x in sectionHeading.split('.')])\n                    reqStartTuple = tuple([int(x) for x in startSection.split('.')])\n                    if (curListTuple &lt; reqStartTuple):\n                        continue    #Skip iteration\n                    elif (curListTuple &gt; reqStartTuple):\n                        break   #exit\n                else:\n                    continue        \n                #Assuming if @ table, then paragraph Text is all captured\n                #sectionJSON.update({\"ParagraphText\":paraText})\n\n                i = 0\n\n                if curHeadNm!='':\n                    #print(\"Good Heading\")\n                    #Try and get the Heading Number\n                    sectionHeading = curHeadNm.lstrip().split(\" \")[0]\n                    #print(\"Section Check ; {0}\".format(sectionHeading))\n                else:\n                    #print(\"Empty Heading\")\n                    continue\n\n                rowsArray = []\n                headerArray = []\n                #Process Table, row by row\n                for row in block.rows:\n                    #print('Processing section {0}'.format(sectionHeading))\n                    i += 1\n                    myCell = 0\n                    JSONrow = {}\n                    rstList = []\n                    rowStringify = []\n                    if i==1:\n                        for row_cell in row.cells:\n                            headerArray.append(row_cell.text.strip().lower().replace(\"'\", \"''\"))\n                            continue #Start proper table loop\n                    else:\n#                   for row_cell in row.cells:\n#                       rstList.append(row_cell.text.strip().lower().replace(\"'\", \"''\"))\n                        for x in range(len(headerArray)):\n                            #print('Iteration {0}'.format(x))\n                            #print(row.cells[x].text.strip().lower())\n                            rowStringify.append(\"\\\"\" + headerArray[x] + \"\\\"\" + \":\" + \"\\\"\" + row.cells[x].text.strip().lower().replace(\"'\", \"''\") + \"\\\"\")\n                        #Create JSON object, with Array of Columns as Value\n                        myStr = (\"{\" + (','.join(map(str, rowStringify))) + \"}\")\n                        print(u\"{}\".format(myStr))\n                        #JSONrow = json.loads(myStr.replace('\\r', '\\\\r').replace('\\n', '\\\\n'))\n                        JSONrow = json.loads(u\"{}\".format(myStr))\n                        rowsArray.append(JSONrow)   #Now, add JSONrow back to array object\n\n                sectionJSON.update({\"Rows\":rowsArray})\n                break   #end now, after fully processing table\n                #print(json.dumps(sectionJSON, indent=4, sort_keys=True))\n\n                #writer = csv.writer(f, delimiter=',')\n                #writer.writerow([sectionHeading, json.dumps(sectionJSON)])\n                #now, back to start\n\n    except IOError as e:\n        print ('I/O error({0}): {1}'.format(e.errno, e.strerror))\n#       traceback.print_exc()\n        #return 1\n    except ValueError:\n        print ('Could not convert data to an integer. {0} :: {1}'.format(sys.exc_info()[0], sys.exc_info()[1]))\n#       traceback.print_exc()\n        #return 1\n    except :\n        print ('Unexpected error: {0} :: {1}'.format(sys.exc_info()[0], sys.exc_info()[1]))\n        traceback.print_exc()\n        #return 1\n    finally:\n        #f.close()\n        win_unicode_console.disable()\n        return json.dumps(sectionJSON,sort_keys=True)\n#       globals().clear()\n        #return 0\n\n#if __name__=='__main__':\n#   sys.exit(main(sys.argv[1], sys.argv[2]))\n</code></pre>\n\n<p>Link to Python Function in pastebin if needed : <a href=\"https://pastebin.com/vrHkk9s0\" rel=\"nofollow noreferrer\">https://pastebin.com/vrHkk9s0</a></p>\n"}, {"tags": ["c#", "asp.net-web-api2"], "answers": [{"comments": [{"owner": {"reputation": 2789, "user_id": 3003119, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/699d1b9d00561bf0dcf5b2a7a24f171e?s=128&d=identicon&r=PG", "display_name": "Stefan Zvonar", "link": "https://stackoverflow.com/users/3003119/stefan-zvonar"}, "edited": false, "score": 0, "creation_date": 1500424953, "post_id": 45069262, "comment_id": 77326863, "body": "Thanks - will use this now to try and glean further information as to why it might not be forwarding.  Will see how it goes and update findings."}], "tags": [], "owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "is_accepted": false, "score": 0, "last_activity_date": 1539155444, "last_edit_date": 1539155444, "creation_date": 1499903323, "answer_id": 45069262, "question_id": 45069188, "link": "https://stackoverflow.com/questions/45069188/httpclient-sendasync-cannot-access-a-disposed-object-responseheadersread/45069262#45069262", "title": "HttpClient SendAsync Cannot access a disposed object ResponseHeadersRead", "body": "<p>Odds are there is an error code being set by the server.</p>\n\n<p>Follow your code with a <code>response.EnsureSuccessStatusCode();</code> that is wrapped in a Try Catch block:</p>\n\n<pre><code>try\n{\n    var request = BuildRelayHttpRequest(Request);\n    await client.SendAsync(request, HttpCompletionOption.ResponseHeadersRead);\n    response.EnsureSuccessStatusCode();\n    // Handle success\n}\ncatch (HttpRequestException)\n{\n    // Handle failure\n}   \n</code></pre>\n"}], "owner": {"reputation": 2789, "user_id": 3003119, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/699d1b9d00561bf0dcf5b2a7a24f171e?s=128&d=identicon&r=PG", "display_name": "Stefan Zvonar", "link": "https://stackoverflow.com/users/3003119/stefan-zvonar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2217, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1539155444, "creation_date": 1499902873, "question_id": 45069188, "link": "https://stackoverflow.com/questions/45069188/httpclient-sendasync-cannot-access-a-disposed-object-responseheadersread", "title": "HttpClient SendAsync Cannot access a disposed object ResponseHeadersRead", "body": "<p>I am looking into an issue with some legacy code which is relaying a Http Request to another URL.  It is an API Controller that reads the request and forwards it to another address asynchronously.  </p>\n\n<p>Very rarely, it throws a \"Cannot access a disposed object\" exception - full stack trace shown later in this question.  It seems to be on the line where the HttpClient is calling the SendAsync method.  I think it might be the ResponseHeadersRead option - I suspect it is happening when a large packet is being sent and it gets closed because it has just read the header and quit.  Just thought I'd sanity check this with you all, for your thoughts.  I'll change the option to be ResponseContentsRead option and see how that goes (but it can take a long time for the error to surface).</p>\n\n<p>Here is the code:</p>\n\n<pre><code>        using (var client = new HttpClient())\n        {\n            var request = BuildRelayHttpRequest(Request);\n            await client.SendAsync(request, HttpCompletionOption.ResponseHeadersRead);\n        }\n\n\n        private static HttpRequestMessage BuildRelayHttpRequest(HttpRequestMessage incomingRequest)\n        {\n            var forwardToUrl = new Uri(ConfigurationManager.AppSettings[\"ForwardFeedURL\"]);\n            var relayRequest = new HttpRequestMessage(incomingRequest.Method, forwardToUrl);\n            if (incomingRequest.Method != HttpMethod.Get &amp;&amp; incomingRequest.Content != null)\n            {\n                relayRequest.Content = incomingRequest.Content;\n            }\n\n            //Copies contents\n            relayRequest.Content = incomingRequest.Content;\n            return relayRequest;\n        }\n</code></pre>\n\n<p>And here is the exception:</p>\n\n<pre><code>System.ObjectDisposedException: Cannot access a disposed object.\nObject name: 'System.Web.Http.WebHost.HttpControllerHandler+LazyStreamContent'.\n   at System.Net.Http.HttpContent.CheckDisposed()\n   at System.Net.Http.HttpContent.CopyToAsync(Stream stream, TransportContext context)\n   at System.Net.Http.HttpClientHandler.GetRequestStreamCallback(IAsyncResult ar)\n--- End of stack trace from previous location where exception was thrown ---\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\n   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()\n   at CHO.Web.Services.ETrains.Controllers.ETrainsApiController.&lt;CopyandForwardFeedAsyn&gt;d__18.MoveNext() in \\Controllers\\MyAPIController.cs:line 289\n</code></pre>\n\n<p>Note, line 289 is the \"await client.SendAsync\" line of code</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1499902932, "post_id": 45069158, "comment_id": 77111537, "body": "Take a folder name from the array, do whatever <i>checking the names</i> means, and then move the directory if it&#39;s appropriate to do so. Repeat with the next folder name from the array until you&#39;ve done them all. What specific problem are you having? Please post the code that shows your efforts, explain the <i>specific problem</i> you&#39;ve encountered, and ask a more realistic question than <i>How can this be done?</i>."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1499906500, "post_id": 45069158, "comment_id": 77112403, "body": "What do you mean by <i>&quot;checking the names&quot;</i>? How are you defining the destination directory? Are you trying to preserve some part of the original path? Some sample input and expected output would be very useful, along with the relevant code you have so far."}, {"owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "edited": false, "score": 0, "creation_date": 1499910214, "post_id": 45069158, "comment_id": 77113257, "body": "Hi @CSharpDude. I see you are new to StackOverflow. Please take a minute to read <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> to learn how to properly ask questions in the future. Also read <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> to learn what to do when someone answers your question."}, {"owner": {"reputation": 15, "user_id": 4848568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317faf519d0d1d24b20601dc37bc66b2?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpDude", "link": "https://stackoverflow.com/users/4848568/csharpdude"}, "edited": false, "score": 0, "creation_date": 1499949235, "post_id": 45069158, "comment_id": 77133900, "body": "That&#39;s seems to work Alexander! The only thing is that it seems to skip any folders that have spaces (i.e: new folder) . Is there a way I can catch those also?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4848568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317faf519d0d1d24b20601dc37bc66b2?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpDude", "link": "https://stackoverflow.com/users/4848568/csharpdude"}, "edited": false, "score": 0, "creation_date": 1499906819, "post_id": 45069339, "comment_id": 77112487, "body": "After stepping away from it and thinking it out some more I thought I could accomplish this with a foreach loop. It seems to iterate through now but it&#39;s not selecting the names in my text file. Here&#39;s what I got so far.."}, {"owner": {"reputation": 15, "user_id": 4848568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317faf519d0d1d24b20601dc37bc66b2?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpDude", "link": "https://stackoverflow.com/users/4848568/csharpdude"}, "edited": false, "score": 0, "creation_date": 1499906942, "post_id": 45069339, "comment_id": 77112515, "body": "string sourceDirectory = @&quot;C:\\Users\\Steve\\Documents\\old folder&quot;; string destinationDirectory = @&quot;C:\\Users\\Steve\\Documents\\new folder&quot;;              try             {                 string[] file = File.ReadAllLines(@&quot;C:\\Users\\Steve\\Documents\\Visual Studio 2015\\Projects\\FileCopier\\FileCopier\\File.txt&quot;);                                  foreach(string folder in file)                 {                     Directory.Move(sourceDirectory, destinationDirectory);                 }"}, {"owner": {"reputation": 15, "user_id": 4848568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317faf519d0d1d24b20601dc37bc66b2?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpDude", "link": "https://stackoverflow.com/users/4848568/csharpdude"}, "edited": false, "score": 0, "creation_date": 1499907110, "post_id": 45069339, "comment_id": 77112557, "body": "Hmm, how can I keep my formatting when posting here?"}, {"owner": {"reputation": 15, "user_id": 4848568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317faf519d0d1d24b20601dc37bc66b2?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpDude", "link": "https://stackoverflow.com/users/4848568/csharpdude"}, "edited": false, "score": 0, "creation_date": 1499908252, "post_id": 45069339, "comment_id": 77112787, "body": "It doesn&#39;t seem to be picking just the names in the text file and moving only them."}, {"owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "reply_to_user": {"reputation": 15, "user_id": 4848568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317faf519d0d1d24b20601dc37bc66b2?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpDude", "link": "https://stackoverflow.com/users/4848568/csharpdude"}, "edited": false, "score": 0, "creation_date": 1499908599, "post_id": 45069339, "comment_id": 77112866, "body": "did you use the code I posted? You code is moving only your sourceDirectoy and Destination directory? You are not passing the <code>folder</code> variable to <code>Directory.Move</code>"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1499909497, "post_id": 45069339, "comment_id": 77113084, "body": "How about not answering until the poster edits the question, so that it has some value to future readers that isn&#39;t buried in this private discussion the two of you are having in comments?"}, {"owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1499910102, "post_id": 45069339, "comment_id": 77113230, "body": "@KenWhite you are right. I have edited the question to make it more valuable to future readers."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1499910302, "post_id": 45069339, "comment_id": 77113287, "body": "What would have been proper is not to have answered the question until the poster did so. It encourages them to learn more suitable habits in the future. Answering bad questions rewards the lack of effort to provide the details in the question and encourages the poster to do so again in the future because they know they&#39;ll get help anyway."}], "tags": [], "owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "is_accepted": false, "score": -1, "last_activity_date": 1499910356, "last_edit_date": 1499910356, "creation_date": 1499903890, "answer_id": 45069339, "question_id": 45069158, "link": "https://stackoverflow.com/questions/45069158/moving-folders-using-c/45069339#45069339", "title": "Moving folders using c#", "body": "<p>You are read the values into an array and performing a loop with them but you are using the values when you call  <code>Directory.Move</code></p>\n\n<p>You need to combined the directory names with those in your array.</p>\n\n<p>When working with files and folders the best way to combine strings is using <code>System.IO.Path.Combine</code></p>\n\n<p>Using your problem code:</p>\n\n<pre><code>string sourceDirectory = @\"C:\\Users\\Steve\\Documents\\old folder\";\nstring destinationDirectory = @\"C:\\Users\\Steve\\Documents\\new folder\"; \ntry \n{ \n    string[] file = File.ReadAllLines(@\"C:\\Users\\Steve\\Documents\\Visual Studio 2015\\Projects\\FileCopier\\FileCopier\\File.txt\"); \n    foreach(string folder in file) { \n         Directory.Move(Path.Combine(sourceDirectory, folder), Path.Combine(destinationDirectory, folder)); } \n    }\n}\ncatch (Exception ex) {Console.WriteLine(Ex.ToString()); }\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4848568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/317faf519d0d1d24b20601dc37bc66b2?s=128&d=identicon&r=PG&f=1", "display_name": "CSharpDude", "link": "https://stackoverflow.com/users/4848568/csharpdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1499910356, "creation_date": 1499902687, "last_edit_date": 1499910034, "question_id": 45069158, "link": "https://stackoverflow.com/questions/45069158/moving-folders-using-c", "title": "Moving folders using c#", "body": "<p>I'm trying to write a program to move folders to a new location.  That's easy enough using <code>Directory.move()</code>.</p>\n\n<p>The problem I'm having is that I only want to move folder names that are read in from a text file.  I have it to the point where I can move the folders, I've read in the folder names into an array. </p>\n\n<p>I just can't seem to come up with the logic for checking the names from that array then moving them.  How could this be done? </p>\n\n<p>I have this code:</p>\n\n<pre><code>string sourceDirectory = @\"C:\\Users\\Steve\\Documents\\old folder\";\nstring destinationDirectory = @\"C:\\Users\\Steve\\Documents\\new folder\";\ntry \n{\n    string[] file = File.ReadAllLines(@\"C:\\Users\\Steve\\Documents\\Visual Studio 2015\\Projects\\FileCopier\\FileCopier\\File.txt\"); \n    foreach(string folder in file) \n    { \n        Directory.Move(sourceDirectory, destinationDirectory); \n    }\n}\n</code></pre>\n\n<p>It doesn't seem to be picking just the names in the text file and moving only them. </p>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1499902766, "post_id": 45069111, "comment_id": 77111498, "body": "Your code does not check the return value of <code>GetDpiForMonitor</code>. The documentation states it can return <code>E_INVALIDARG</code>  and as they&#39;re <code>out</code> parameters then their values is meaningless in an error condition, which explains the <code>255</code> value you&#39;re seeing."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1499902858, "post_id": 45069111, "comment_id": 77111520, "body": "Calling <code>GetDpiForMonitor</code> from within a WPF process might not work as-intended because the function behaves differently depending on the &quot;awareness&quot;-level of the calling process (and WPF likes to interfere with this... especially if your users are on an older .NET Framework version). You should call this indirectly from a helper process which does not create a window and is declared with the latest Windows application-manifest."}, {"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1499903291, "post_id": 45069111, "comment_id": 77111627, "body": "@Dai, good thought, I checked and GetDpiForMonitor is returning 0.  This code uses the 4.5.2 framework."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1499904547, "post_id": 45069111, "comment_id": 77111958, "body": "Please post your P/Invoke declaration of <code>GetDpiForMonitor</code> and other imported functions, and when posting code please specify full type names instead of <code>var</code> (we can&#39;t mouse-over identifiers to see their type in a browser)."}, {"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1499995536, "post_id": 45069111, "comment_id": 77159069, "body": "I updated the code to show the imports."}], "answers": [{"comments": [{"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "edited": false, "score": 0, "creation_date": 1499995450, "post_id": 45081797, "comment_id": 77159050, "body": "Thanks, I gave VisualTreeHelper.GetDpi a try, but it returned 240x240 which is the same as GetDpiForMonitor with a monitor type of MDT_EFFECTIVE_DPI  (0)."}, {"owner": {"reputation": 133235, "user_id": 7252182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUgxG.png?s=128&g=1", "display_name": "mm8", "link": "https://stackoverflow.com/users/7252182/mm8"}, "reply_to_user": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "edited": false, "score": 0, "creation_date": 1500016535, "post_id": 45081797, "comment_id": 77165822, "body": "Did you enable per monitor DPI for your application in the application manifest file and turned on the WPF feature in your App.Config?"}, {"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "edited": false, "score": 0, "creation_date": 1500148802, "post_id": 45081797, "comment_id": 77215327, "body": "I did the first (app.manifest), but since I was targeting the 4.6.2 framework I didn&#39;t change the app.config."}], "tags": [], "owner": {"reputation": 133235, "user_id": 7252182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUgxG.png?s=128&g=1", "display_name": "mm8", "link": "https://stackoverflow.com/users/7252182/mm8"}, "is_accepted": false, "score": 0, "last_activity_date": 1499951867, "creation_date": 1499951867, "answer_id": 45081797, "question_id": 45069111, "link": "https://stackoverflow.com/questions/45069111/accurately-determine-dpi-in-windows-10/45081797#45081797", "title": "Accurately determine DPI in Windows (10)", "body": "<p>WPF has per-monitor DPI support since .NET Framework 4.6.2. There is more information and an example available at GitHub: <a href=\"http://github.com/Microsoft/WPF-Samples/tree/master/PerMonitorDPI\" rel=\"nofollow noreferrer\">http://github.com/Microsoft/WPF-Samples/tree/master/PerMonitorDPI</a>. </p>\n\n<p>You may also want to check out the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.media.visualtreehelper.getdpi%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">VisualTreeHelper.GetDpi</a> method.</p>\n"}], "owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1080, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1500153970, "creation_date": 1499902416, "last_edit_date": 1500153970, "question_id": 45069111, "link": "https://stackoverflow.com/questions/45069111/accurately-determine-dpi-in-windows-10", "title": "Accurately determine DPI in Windows (10)", "body": "<p>I have code that I believe is (technically) correct for getting the DPI of a monitor in Windows 10.</p>\n\n<pre><code>[DllImport(\"shcore.dll\")]\nstatic extern UInt32 GetDpiForMonitor(IntPtr hmonitor,\n                                      int dpiType,\n                                      out UInt32 dpiX,\n                                      out UInt32 dpiY);\n\n[DllImport(\"user32.dll\")]\nstatic extern IntPtr MonitorFromWindow(IntPtr hwnd, UInt32 dwFlags);\n...\nvar whdl = Process.GetCurrentProcess().MainWindowHandle;\nvar mhdl = MonitorFromWindow(whdl, 0);\n\nGetDpiForMonitor(mhdl, 2, out DpiX, out DpiY); // 255, 256\n\nvar ct = PresentationSource.FromVisual(MainImage).CompositionTarget;\nvar scaleX = ct.TransformToDevice.M11;\nvar scaleY = ct.TransformToDevice.M22;\n\nvar pixelWidth = (int)(GridImage.ActualWidth * DpiX / 96.0);\nvar pixelHeight = (int)(GridImage.ActualHeight * DpiY / 96.0);\n\nwriteableBitmap = new WriteableBitmap(pixelWidth, \n                                      pixelHeight,\n                                      DpiX,\n                                      DpiY,\n                                      System.Windows.Media.PixelFormats.Bgr32,\n                                      null);\n</code></pre>\n\n<p>I tested this with a 17\" (laptop) 4K panel (3840x2160 with 250% scaling).  I used a simple WPF grid control which contains an Image control.  The DPI that comes from <code>GetDpiForMonitor</code> is (X:Y) 255:256.  The problem is that this isn't accurate.  When I draw a simple grid (lines DPI apart) the squares are not 1\", they are 17 (raw) pixels short.  The <code>WriteableBitmap</code> is inside a WPF Image control and that control has <code>Stretch=\"None\"</code>.</p>\n\n<p>Anyone know why these values are inaccurate or how to get accurate values. Is there a way to get a monitor's resolution and dimensions (so I could calculate the DPI)?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Well this question has been down voted and I still don't have an answer, but I find this little puzzle both interesting and irritating (\"interating\", \"irriresting\").  Anyway, here's some additional info sent into the future for anyone that runs across it.  </p>\n\n<p>First this is a HP Envy 4K laptop (W2K87UA#ABA) running Windows 10 Pro Build 15063.483.  Using the GetDevCaps I queried for the system monitor dimensions</p>\n\n<pre><code>[DllImport(\"gdi32.dll\")]\nstatic extern int GetDeviceCaps(IntPtr hdc, int nIndex);\n\nprivate const int HORZSIZE = 4;\nprivate const int VERTSIZE = 6;\nprivate const double MM_TO_INCH_CONVERSION_FACTOR = 25.4;\n...\nvar hDC = System.Drawing.Graphics.FromHwnd(whdl).GetHdc();\nint horizontalSizeInMilliMeters = GetDeviceCaps(hDC, HORZSIZE);\ndouble horizontalSizeInInches = horizontalSizeInMilliMeters / MM_TO_INCH_CONVERSION_FACTOR;\nint vertivalSizeInMilliMeters = GetDeviceCaps(hDC, VERTSIZE);\ndouble verticalSizeInInches = vertivalSizeInMilliMeters / MM_TO_INCH_CONVERSION_FACTOR;\n</code></pre>\n\n<p>This returns the following:</p>\n\n<pre><code>horizontalSizeInMilliMeters: 382\nhorizontalSizeInInches: 15.039370078740159\nMeasured by hand: 15 1/32 \"      15.0625\"   382.6 mm\n\nvertivalSizeInMilliMeters: 214\nverticalSizeInInches: 8.4251968503937018\nMeasured by hand:  8 15/32\"       8.46875   215.1 mm\n</code></pre>\n\n<p>This all works out to be an X dpi of 255.329842931937 and a Y dpi of \n256.373831775701, or approximately (255, 256) which is exactly what the GetDpiForMonitor returns.</p>\n\n<p>Using a WriteableBitmap I draw a grid on the screen using the following code:</p>\n\n<pre><code>color = Colors.White;\nint color_data = (color.R &lt;&lt; 16)\n               | (color.G &lt;&lt; 8)\n               | color.B;\ndpiy = (int) DpiY;\nfor (var y = 0; y &lt; height; y += dpiy) {\n    for (var x = 0; x &lt; width; x++) {\n        var p = BackBuffer + (y * Stride) + (x * 4);\n        unsafe {\n            *((int*)p) = color_data;\n            }\n        }\n    }\ndpix = (int) DpiX;\nfor (var x = 0; x &lt; width; x += dpix) {\n    for (var y = 0; y &lt; height; y++) {\n        var p = BackBuffer + (y * Stride) + (x * 4);\n        unsafe {\n            *((int*)p) = color_data;\n            }\n        }\n    }\n</code></pre>\n\n<p>When I measure the grid lines I find that I need to add about 17 pixels both ways to get a 1\" unit square.  If my \"real\" DPI were 272 (255 + 17) then the actual width of my screen would be 14.1176470588235\" (3840/272).</p>\n\n<p>Out of curiosity I opened Word 2016 set the scale to 100% and measured the Word \"ruler\" tool.  It too is off ~15/16\" instead of 1\", I have to scale to between 105% and 106% in order to get a \"true\" inch.  So whatever the issue is it also effects MS written apps.   </p>\n"}, {"tags": ["c#", "android", "xamarin"], "comments": [{"owner": {"reputation": 2444, "user_id": 1733406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oVygi.jpg?s=128&g=1", "display_name": "Jesus Angulo", "link": "https://stackoverflow.com/users/1733406/jesus-angulo"}, "edited": false, "score": 0, "creation_date": 1499904854, "post_id": 45069092, "comment_id": 77112029, "body": "Have you tried using Task&#39;s from the .NET world?"}, {"owner": {"reputation": 21, "user_id": 3745623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c83ed2b664759f03b2e1e835720d976?s=128&d=identicon&r=PG&f=1", "display_name": "jamesg76", "link": "https://stackoverflow.com/users/3745623/jamesg76"}, "reply_to_user": {"reputation": 2444, "user_id": 1733406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oVygi.jpg?s=128&g=1", "display_name": "Jesus Angulo", "link": "https://stackoverflow.com/users/1733406/jesus-angulo"}, "edited": false, "score": 0, "creation_date": 1499907799, "post_id": 45069092, "comment_id": 77112686, "body": "I&#39;m sorry I&#39;m a noob, can you be more specific please? You mean for creating the background thread?"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1499909166, "post_id": 45069092, "comment_id": 77113014, "body": "Instead of polling <code>IsSpeaking</code>, use the <code>UtteranceProgressListener</code> and implement its <code>OnDone</code> callback to determine when the speech is done and thus start a 4 second timer with a callback to start the next text to speech item."}, {"owner": {"reputation": 21, "user_id": 3745623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c83ed2b664759f03b2e1e835720d976?s=128&d=identicon&r=PG&f=1", "display_name": "jamesg76", "link": "https://stackoverflow.com/users/3745623/jamesg76"}, "edited": false, "score": 0, "creation_date": 1499914583, "post_id": 45069092, "comment_id": 77114222, "body": "I used UtteranceProgressListener in that fashion before, it had the same issue, the wait time increased from 4 seconds to around 30."}], "owner": {"reputation": 21, "user_id": 3745623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c83ed2b664759f03b2e1e835720d976?s=128&d=identicon&r=PG&f=1", "display_name": "jamesg76", "link": "https://stackoverflow.com/users/3745623/jamesg76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499902306, "creation_date": 1499902306, "question_id": 45069092, "link": "https://stackoverflow.com/questions/45069092/android-xamarin-c-how-to-prevent-cpu-from-slowing-down", "title": "Android Xamarin C# - how to prevent CPU from slowing down", "body": "<p>I am using text to speech to do foreign language lessons. My app says an english word, waits 4 seconds, then says a foreign word, waits 4 seconds and repeats the process. I find that after about 300 words, the wait between words goes from 4 seconds to 15 or more seconds. This is very frustrating, I have tried using PowerManager to keep the cpu on, is there any other way to prevent this?</p>\n\n<p>Here is some of the code:</p>\n\n<pre><code>protected override void OnCreate(Bundle bundle)\n    {\n        base.OnCreate(bundle);\n        audioManager = (AudioManager)GetSystemService(AudioService);\n        SetContentView(Resource.Layout.Main);\n        Button button = FindViewById&lt;Button&gt;(Resource.Id.MyButton);\n        Button button2 = FindViewById&lt;Button&gt;(Resource.Id.button1);\n        Button button3 = FindViewById&lt;Button&gt;(Resource.Id.button2);\n        SpeechText = new TextToSpeech(this, this);\n        SpeechText.SetSpeechRate(0.7f);\n        //...\n        button3.Click += delegate { StartLessons(); };\n        PowerManager pm = (PowerManager)GetSystemService(Context.PowerService);\n        mWakeLock = pm.NewWakeLock(WakeLockFlags.Partial, \"PartialWakeLockTag\");\n\n    }\npublic void StartLessons()\n    {\n        if (ThreadStarted == true)\n        {\n            TV.Text = \"Lessons already started.\";\n            return;\n        }\n        StopBH();\n        var focusResult = audioManager.RequestAudioFocus(this, Stream.Music, AudioFocus.Gain);\n        if (focusResult != AudioFocusRequest.Granted)\n        {\n            TV.Text = \"Audio Focus not granted.\";\n            return;\n        }            \n        StopLessons = false;            \n        lessoncount = 0;\n        ThreadPool.QueueUserWorkItem(o =&gt; sl.SpeakLessonsBackground());\n        TV.Text = \"Lessons Started.\";\n    }\n    class SL\n    {\n        public async void SpeakLessonsBackground()\n        {\n            if (mWakeLock.IsHeld == false)\n            {\n                mWakeLock.Acquire();                    \n            }\n            int r;\n            string first, second, term;\n            while (StopLessons == false)\n            {\n                ThreadStarted = true;\n                r = sentence_generator.RandomNumber.Rand4(CleanRosetta.Count());                    \n                term = CleanRosetta[r];\n                first = term.Substring(term.IndexOf('*') + 2);\n                second = term.Substring(0, term.IndexOf('*') - 1);                                      \n                wordcount++;\n                if (wordcount &gt; 10)\n                {\n                    wordcount = 0;\n                    RandomizeCleanRosetta();\n                }\n                SpeechText.Speak(first, QueueMode.Flush, null, \"LessonUtterance\");\n                while (SpeechText.IsSpeaking != true)\n                {\n                    await Task.Delay(25);\n                    if (StopLessons == true)\n                    {\n                        EndSL();\n                        return;\n                    }\n                }\n                while (SpeechText.IsSpeaking == true)\n                {\n                    await Task.Delay(25);\n                    if (StopLessons == true)\n                    {\n                        EndSL();\n                        return;\n                    }\n                }                    \n                var dt = DateTime.Now;\n                dt = dt.AddSeconds(4);\n                while (DateTime.Now &lt; dt)\n                {                        \n                    await Task.Delay(25);\n                    if (StopLessons == true)\n                    {\n                        EndSL();\n                        return;\n                    }\n                }\n                SpeechText.Speak(second, QueueMode.Flush, null, \"LessonUtteranceEnd\");\n                while (SpeechText.IsSpeaking != true)\n                {\n                    await Task.Delay(25);\n                    if (StopLessons == true)\n                    {\n                        EndSL();\n                        return;\n                    }\n                }\n                while (SpeechText.IsSpeaking == true)\n                {\n                    await Task.Delay(25);\n                    if (StopLessons == true)\n                    {\n                        EndSL();\n                        return;\n                    }\n                }                    \n                dt = DateTime.Now;\n                dt = dt.AddSeconds(4);\n                while (DateTime.Now &lt; dt)\n                {                        \n                    await Task.Delay(25);\n                    if (StopLessons == true)\n                    {\n                        EndSL();\n                        return;\n                    }\n                }\n                lessoncount++;                    \n            }\n            EndSL();\n        }\n    }\n\n    public static void EndSL()\n    {\n        StopLessons = false;\n        ThreadStarted = false;\n        if (mWakeLock.IsHeld == true)\n        {\n            mWakeLock.Release();                \n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "visual-studio", "azure", "asp.net-web-api", "azure-service-fabric"], "comments": [{"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1499902284, "post_id": 45069049, "comment_id": 77111377, "body": "How you can/should version services at runtime and how you choose to version them in your source control are completely orthogonal issues. The latter is almost uninteresting compared to the former. How are you keeping track of different versions of your software <i>now</i>, and why should Azure services be any different with regards to that?"}, {"owner": {"reputation": 50682, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=128&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1499904986, "post_id": 45069049, "comment_id": 77112060, "body": "this is a completely new implementation. we&#39;re converting from monolithic architecture, where there was only 1 version of the code in production"}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1499931421, "post_id": 45069049, "comment_id": 77121003, "body": "Yeah, but even your monolithic architecture was checked into source control with a versioning policy, right? If not, pick any article on how to track versions in TFS (can be done with labels, can be done with branches) and implement it. There&#39;s nothing microservice-specific about that. As long as you have the ability to check out version N - 1 of your software and build it, you&#39;re good."}], "answers": [{"tags": [], "owner": {"reputation": 17834, "user_id": 445303, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2807e279ada3bb19bad41a54af66114d?s=128&d=identicon&r=PG", "display_name": "The Muffin Man", "link": "https://stackoverflow.com/users/445303/the-muffin-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1500357805, "last_edit_date": 1500357805, "creation_date": 1500356772, "answer_id": 45158452, "question_id": 45069049, "link": "https://stackoverflow.com/questions/45069049/how-to-keep-track-of-multiple-versions-of-assemblies/45158452#45158452", "title": "How to keep track of multiple versions of assemblies?", "body": "<p>I think trying to keep track of different versions of microservices will end up being frustratingly difficult to do and prone to error.</p>\n\n<p>I would suggest that you modify your approach and deal with your specific concerns in different ways. Possibly expose all of your microservices through a web api, and version the controllers. </p>\n\n<p>In my microservice implementations I do not allow microservices to talk to each other. Instead, I use service bus queues and topics to accomplish cross service communication. In this way you don't have the maintenance and planning overhead of making sure your system doesn't get too coupled, and actually by doing what you're doing you are creating a monolith in my opinion. A microservice should be fully encapsulated and function with the inputs it is given. An email notification service should not be calling out to a user service to get additional user data to craft a custom email. It should either be given that on demand from whatever invoked the notification, or it should be storing that metadata via a subscription to a service bus queue/topic. You will find that you are storing duplicate data throughout your system, but that is okay to achieve the decoupled pattern.</p>\n\n<p>I think some things you can do to alleviate your issues is create unit tests for every public function in your microservice, and leverage a test environment to test before deploying to production. If you do find a problem in production you simply either roll the service back or fix it.</p>\n\n<p>Here's the types of tests I write for all my methods:</p>\n\n<p>Example function: AddOrUpdateUser</p>\n\n<p>Test: Add works<br>\nTest: Update works<br>\nTest: function fails if required fields were null<br>\nTest: function fails if username is shorter than X<br>\netc..</p>\n\n<p>Doing this takes time, but in my experience I have had very very little bugs in production and the ones I had were minor.</p>\n\n<p>Really, testing like this should be done in every app, but doing it in a monolith is just significantly harder. Using microservices you can obtain super high function reliability easily.</p>\n"}], "owner": {"reputation": 50682, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=128&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 45158452, "answer_count": 1, "score": 2, "last_activity_date": 1500357805, "creation_date": 1499901967, "question_id": 45069049, "link": "https://stackoverflow.com/questions/45069049/how-to-keep-track-of-multiple-versions-of-assemblies", "title": "How to keep track of multiple versions of assemblies?", "body": "<p>We're deploying microservices to azure service fabric. </p>\n\n<p><strong>How do we keep track of multiple versions of our services?</strong></p>\n\n<p>How we will allow multiple versions of the services in production:</p>\n\n<ol>\n<li>consumer is issued a token</li>\n<li>that token would be sent to the microservice in the header</li>\n<li>gateway will receive the request and redirect to the version of the microservice that corresponds to the token in the headers</li>\n</ol>\n\n<p>Another words, multiple consumers will be able to hit an endpoint:<code>\u2026./api/accounts(12343)</code>, but will be routed to a different version of the microservice depending on their header token. </p>\n\n<p>Do we create separate TFS branches for every version of the microservice? Do we simply create a nuget package repository?</p>\n\n<p><strong>How do we keep track of multiple versions of our services?</strong></p>\n\n<p>Why would we want to keep track of multiple versions?</p>\n\n<ol>\n<li>Perhaps we may want to revert to an older version. \n\n<ol start=\"2\">\n<li>Maybe we would need to implement a fix for a client in their specific version.</li>\n<li>Maybe we would need a different version of a service because we discovered that there's tight coupling with a different service. </li>\n</ol></li>\n</ol>\n"}, {"tags": ["c#", "asp.net", "migration", ".net-core", "ubuntu-16.04"], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 4511872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5eeef81d2a0532bd858d65eaa6563540?s=128&d=identicon&r=PG&f=1", "display_name": "lightup", "link": "https://stackoverflow.com/users/4511872/lightup"}, "is_accepted": false, "score": 1, "last_activity_date": 1499903460, "last_edit_date": 1499903460, "creation_date": 1499902430, "answer_id": 45069114, "question_id": 45068993, "link": "https://stackoverflow.com/questions/45068993/how-to-migrate-from-netcoreapp1-0-to-netcoreapp1-1-in-ubuntu-16-04/45069114#45069114", "title": "How to Migrate from netcoreapp1.0 to netcoreapp1.1 in ubuntu 16.04", "body": "<p>Yeah I have solved it\nAfter running</p>\n\n<pre><code>dotnet migrate\n</code></pre>\n\n<p>Run</p>\n\n<pre><code>dotnet restore\n</code></pre>\n\n<p>Oh I almost forgot</p>\n\n<h1>Edit the webprojectfile.csproj file</h1>\n\n<p>That is instead of</p>\n\n<pre><code>    &lt;Project Sdk=\"Microsoft.NET.Sdk.Web\"&gt;\n\n  &lt;PropertyGroup&gt;\n    &lt;TargetFramework&gt;netcoreapp1.0&lt;/TargetFramework&gt;\n    &lt;DebugType&gt;portable&lt;/DebugType&gt;\n    &lt;PreserveCompilationContext&gt;true&lt;/PreserveCompilationContext&gt;\n    &lt;AssemblyName&gt;webproj&lt;/AssemblyName&gt;\n    &lt;OutputType&gt;Exe&lt;/OutputType&gt;\n    &lt;PackageId&gt;webproj&lt;/PackageId&gt;\n    &lt;UserSecretsId&gt;aspnet-WebApplication-0799fe3e-6eaf-4c5f-b40e-7c6bfd5dfa9a&lt;/UserSecretsId&gt;\n    &lt;RuntimeFrameworkVersion&gt;1.0.4&lt;/RuntimeFrameworkVersion&gt;\n    &lt;PackageTargetFallback&gt;$(PackageTargetFallback);dotnet5.6;dnxcore50;portable-net45+win8&lt;/PackageTargetFallback&gt;\n  &lt;/PropertyGroup&gt;\n\n  &lt;ItemGroup&gt;\n    &lt;None Update=\"wwwroot\\**\\*;Views\\**\\*\"&gt;\n      &lt;CopyToPublishDirectory&gt;PreserveNewest&lt;/CopyToPublishDirectory&gt;\n    &lt;/None&gt;\n  &lt;/ItemGroup&gt;\n</code></pre>\n\n<p>Update the file to reflect the netcore latest version\nas shown below </p>\n\n<pre><code>&lt;Project Sdk=\"Microsoft.NET.Sdk.Web\"&gt;\n\n  &lt;PropertyGroup&gt;\n    &lt;TargetFramework&gt;netcoreapp1.1&lt;/TargetFramework&gt;\n    &lt;DebugType&gt;portable&lt;/DebugType&gt;\n    &lt;PreserveCompilationContext&gt;true&lt;/PreserveCompilationContext&gt;\n    &lt;AssemblyName&gt;webproj&lt;/AssemblyName&gt;\n    &lt;OutputType&gt;Exe&lt;/OutputType&gt;\n    &lt;PackageId&gt;webproj&lt;/PackageId&gt;\n    &lt;UserSecretsId&gt;aspnet-WebApplication-0799fe3e-6eaf-4c5f-b40e-7c6bfd5dfa9a&lt;/UserSecretsId&gt;\n    &lt;RuntimeFrameworkVersion&gt;1.1.0&lt;/RuntimeFrameworkVersion&gt;\n    &lt;PackageTargetFallback&gt;$(PackageTargetFallback);dotnet5.6;dnxcore50;portable-net45+win8&lt;/PackageTargetFallback&gt;\n  &lt;/PropertyGroup&gt;\n\n  &lt;ItemGroup&gt;\n    &lt;None Update=\"wwwroot\\**\\*;Views\\**\\*\"&gt;\n      &lt;CopyToPublishDirectory&gt;PreserveNewest&lt;/CopyToPublishDirectory&gt;\n    &lt;/None&gt;\n  &lt;/ItemGroup&gt;\n</code></pre>\n\n<p>which is to change this line</p>\n\n<pre><code>&lt;TargetFramework&gt;netcoreapp1.0&lt;/TargetFramework&gt;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>&lt;TargetFramework&gt;netcoreapp1.1&lt;/TargetFramework&gt;\n</code></pre>\n\n<p>and </p>\n\n<pre><code>&lt;RuntimeFrameworkVersion&gt;1.0.4&lt;/RuntimeFrameworkVersion&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>&lt;RuntimeFrameworkVersion&gt;1.1.0&lt;/RuntimeFrameworkVersion&gt;\n</code></pre>\n\n<h1>Edit: Please DO Not eliminate or rename the</h1>\n\n<p>\"appsettings.json\" file</p>\n\n<h1>Leave the appsettings.json as it acts as environment file settings or .env in PHP. :)</h1>\n\n<p>Also in the Startup.cs file </p>\n\n<pre><code>if (env.IsDevelopment())\n            {\n                // comment this line \n                // builder.AddUserSecrets();\n                // Use this instead   \n               builder.AddUserSecrets(\"myusersecretAddUserSecrets\"); // where myusersecretAddUserSecrets is your secret key or ID \n            }\n</code></pre>\n\n<p>Then you can now rerun the following</p>\n\n<pre><code>dotnet restore\n</code></pre>\n\n<p>then </p>\n\n<pre><code>dotnet build\n</code></pre>\n\n<p>then </p>\n\n<pre><code>dotnet run\n</code></pre>\n\n<p>Your Application Should Be Running without errors By NOW!! Hopefully. :)</p>\n"}], "owner": {"reputation": 526, "user_id": 4511872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/5eeef81d2a0532bd858d65eaa6563540?s=128&d=identicon&r=PG&f=1", "display_name": "lightup", "link": "https://stackoverflow.com/users/4511872/lightup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499903460, "creation_date": 1499901518, "question_id": 45068993, "link": "https://stackoverflow.com/questions/45068993/how-to-migrate-from-netcoreapp1-0-to-netcoreapp1-1-in-ubuntu-16-04", "title": "How to Migrate from netcoreapp1.0 to netcoreapp1.1 in ubuntu 16.04", "body": "<p>I just upgraded to .NET Core 1.1  from .Net Core 1.0\nI already have projects using .Net Core 1.0\nHow do I successfully migrate. \nbecause I have tried using</p>\n\n<pre><code>dotnet migrate\n</code></pre>\n\n<p>to migrate it was successfull but when I tried running</p>\n\n<pre><code>dotnet restore\n</code></pre>\n\n<p>I had a long verbose of errors being displayed as shown below</p>\n\n<pre><code>1.0.0/microsoft.visualstudio.web.codegenerators.mvc.1.0.0.nupkg'.                                                                                                  [1320/1825]\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.entityframeworkcore.relational/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.hosting/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.mvc.viewfeatures/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Failed to download package 'Microsoft.AspNetCore.Mvc.ApiExplorer.1.0.3' from 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.mvc.apiexplorer/1.0.3/microsoft.as\npnetcore.mvc.apiexplorer.1.0.3.nupkg'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Failed to download package 'Microsoft.AspNetCore.Identity.EntityFrameworkCore.1.0.2' from 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.identity.entityframew\norkcore/1.0.2/microsoft.aspnetcore.identity.entityframeworkcore.1.0.2.nupkg'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Failed to download package 'Microsoft.AspNetCore.Hosting.Abstractions.1.0.2' from 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.hosting.abstractions/1.0.2/mi\ncrosoft.aspnetcore.hosting.abstractions.1.0.2.nupkg'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.mvc.formatters.json/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.mvc.localization/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Failed to download package 'Microsoft.VisualStudio.Web.CodeGeneration.Tools.1.0.0' from 'https://api.nuget.org/v3-flatcontainer/microsoft.visualstudio.web.codegeneration.to\nols/1.0.0/microsoft.visualstudio.web.codegeneration.tools.1.0.0.nupkg'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.mvc.taghelpers/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.entityframeworkcore.design/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.http.extensions/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n  Retrying 'FindPackagesByIdAsync' for source 'https://api.nuget.org/v3-flatcontainer/microsoft.aspnetcore.httpoverrides/index.json'.\n  An error occurred while sending the request.\n    Couldn't resolve host name\n[0] 0:[tmux]*Z                                                                                                                               \n</code></pre>\n\n<p>What Do I do?</p>\n"}, {"tags": ["c#", "do-while"], "comments": [{"owner": {"reputation": 1, "user_id": 8298780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c699a89d03203b6da72876504e89b5?s=128&d=identicon&r=PG&f=1", "display_name": "Kittyer", "link": "https://stackoverflow.com/users/8298780/kittyer"}, "edited": false, "score": 0, "creation_date": 1499901890, "post_id": 45068983, "comment_id": 77111276, "body": "I would like to add when I tried without the do-while loop, I had the  DateTime today = DateTime.Today; inside of the if-statement"}], "answers": [{"tags": [], "owner": {"reputation": 4515, "user_id": 444634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57f168007d2fdd78356bc8eb6cc0c776?s=128&d=identicon&r=PG", "display_name": "Ivan Feri\u0107", "link": "https://stackoverflow.com/users/444634/ivan-feri%c4%87"}, "is_accepted": false, "score": 0, "last_activity_date": 1499928108, "last_edit_date": 1499928108, "creation_date": 1499902430, "answer_id": 45069113, "question_id": 45068983, "link": "https://stackoverflow.com/questions/45068983/getting-the-added-or-subtracted-value-results-in-an-un-representable-datetime-ex/45069113#45069113", "title": "Getting The added or subtracted value results in an un-representable DateTime Exception", "body": "<p>So here's a little analysis of your code.</p>\n\n<p>In short - your do-while list will never end looping and in all but one scenario you'll either hit a minimum or maximum <code>DateTime</code> value upon which you'll get the exception.</p>\n\n<p>The long version - your do-while list has 2 parts - one in <code>if</code> and one in <code>else</code> block. Since the condition is <code>years / planetyeardata[0] &gt; 1</code> and nothing in your loop is changing <code>years</code> or <code>planetyeardata</code>, this condition could be considered a constant. So basically, your do-while loop will either always go to <code>if</code> block or always to <code>else</code> block.</p>\n\n<p>If it's entering an <code>if</code> block, the expression <code>answer = today.AddDays(87.97 * (1 - (days / 87.97 - (days / 87.97))));</code> will always make <code>answer = today.AddDays(87.97)</code>, the reason being that <code>(days / 87.97 - (days / 87.97))</code> is always 0. Immediatelly after, you're setting <code>today = answer</code>. Since you're always setting <code>today</code> to be equal to <code>answer</code>, you'll never break <code>while (today &lt;= answer)</code> condition. On the other hand your dates will always increase by 87.97 days and will at some time be greater than <code>DateTime.MaxValue</code> which will throw an exception.</p>\n\n<p>If it's entering an <code>else</code> block, you have an expression <code>answer = today.AddDays(87.97 * (1 - days / 87.97));</code>. Depending on <code>days</code> value, you have 3 possible outcomes:</p>\n\n<ol>\n<li><code>days &lt; 87.97</code> - in this case <code>(1 - days / 87.97)</code> will always be greater than zero because of which your dates will gradually increase until you get to <code>DateTime.MaxValue</code> which will throw an exception</li>\n<li><code>days == 87.97</code> - in this case <code>(1 - days / 87.97)</code> will always be equal to zero because of which your dates will never change and never leave the do-while block</li>\n<li><code>days &gt; 87.97</code> - in this case <code>(1 - days / 87.97)</code> will always be less than zero because of which your date will gradually decrease until you get to <code>DateTime.MinValue</code> which will throw an exception</li>\n</ol>\n\n<p>Since you're immediately after setting <code>today = answer</code>, you'll never break <code>while (today &lt;= answer)</code> condition and your loop will never stop until you get the exception.</p>\n\n<p>So, generally, your <code>while</code> condition is always fulfilled and the code inside the block will always get out of bounds of available <code>DateTime</code> values with one possible outcome (<code>days == 87.97</code> in <code>else</code> block) where your dates will always remain the same and never leave the do-while block.</p>\n"}, {"tags": [], "owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "is_accepted": false, "score": 0, "last_activity_date": 1499902770, "last_edit_date": 1499902770, "creation_date": 1499902447, "answer_id": 45069121, "question_id": 45068983, "link": "https://stackoverflow.com/questions/45068983/getting-the-added-or-subtracted-value-results-in-an-un-representable-datetime-ex/45069121#45069121", "title": "Getting The added or subtracted value results in an un-representable DateTime Exception", "body": "<p>The DateTime Structure has a Minimum value of 1/1/0001 and a maximum value of 12/31/9999</p>\n\n<p>The code in your loop is attempting to add a number of days that is making <code>today</code> go outside of this range. </p>\n\n<p>You can check for the overflow and handle the exception accordingly:</p>\n\n<pre><code>DateTime answer;\nDateTime today = DateTime.Today;\ndo\n{\n\n    if (years / planetyeardata[0] &gt; 1)\n    {\n\n\n\n        var daysToAdd = (1 - (days / 87.97 - (days / 87.97)));\n        if (daysToAdd &gt; 0 &amp;&amp; DateTime.MaxValue.Subtract(today).TotalDays &gt; daysToAdd)\n            throw new Exception(string.Format(\"Can't add {0} days to {1}\", daysToAdd, today));\n        if (daysToAdd &lt; 0 &amp;&amp; today.Subtract(DateTime.MinValue).TotalDays &gt; daysToAdd)\n            throw new Exception(string.Format(\"Can't add {0} days to {1}\", daysToAdd, today));\n\n        answer = today.AddDays(87.97 *daysToAdd );\n        mnbd.Text = answer.ToString();\n        today = answer;\n    }\n    else\n    {\n        var daysToAdd = (1 - (days / 87.97 - (days / 87.97)));\n        if (daysToAdd &gt; 0 &amp;&amp; DateTime.MaxValue.Subtract(today).TotalDays &gt; daysToAdd)\n            throw new Exception(string.Format(\"Can't add {0} days to {1}\", daysToAdd, today));\n        if (daysToAdd &lt; 0 &amp;&amp; today.Subtract(DateTime.MinValue).TotalDays&gt; daysToAdd)\n            throw new Exception(string.Format(\"Can't add {0} days to {1}\", daysToAdd, today));\n\n        answer = today.AddDays(87.97 * (1 - days / 87.97));    // + (224.7 * (1 - days / 224.7) * 24 * 3600 * 1000));\n\n        today = answer;\n        mnbd.Text = answer.ToString();\n\n    }\n} while (today &lt;= answer);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8298780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c699a89d03203b6da72876504e89b5?s=128&d=identicon&r=PG&f=1", "display_name": "Kittyer", "link": "https://stackoverflow.com/users/8298780/kittyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2370, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1499928108, "creation_date": 1499901463, "question_id": 45068983, "link": "https://stackoverflow.com/questions/45068983/getting-the-added-or-subtracted-value-results-in-an-un-representable-datetime-ex", "title": "Getting The added or subtracted value results in an un-representable DateTime Exception", "body": "<p>This is part of my code:</p>\n\n<pre><code>DateTime answer;\n\nDateTime today = DateTime.Today;\n    do {\n\n        if (years / planetyeardata[0] &gt; 1)\n        {\n\n\n            answer = today.AddDays(87.97 * (1 - (days / 87.97 - (days / 87.97))));\n            mnbd.Text = answer.ToString();\n            today = answer;\n        }\n        else\n        {\n\n            answer = today.AddDays(87.97 * (1 - days / 87.97));    // + (224.7 * (1 - days / 224.7) * 24 * 3600 * 1000));\n\n            today = answer;\n            mnbd.Text = answer.ToString();\n\n        }\n    } while (today &lt;= answer);\n</code></pre>\n\n<p>When I don't have the do-while statement around the if-statement, the bit of code to work out \"answer\" is working fine. But with the do-while I am getting this error.</p>\n\n<p>I basically want to keep performing the calculation for \"answer\" until its value is higher than current date.</p>\n"}, {"tags": ["c#", "botframework"], "answers": [{"comments": [{"owner": {"reputation": 12807, "user_id": 3136339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CyHpv.jpg?s=128&g=1", "display_name": "Nicolas R", "link": "https://stackoverflow.com/users/3136339/nicolas-r"}, "edited": false, "score": 0, "creation_date": 1513592965, "post_id": 45076709, "comment_id": 82697844, "body": "If that reply was helpful, please don&#39;t forget to accept it, thanks"}], "tags": [], "owner": {"reputation": 12807, "user_id": 3136339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CyHpv.jpg?s=128&g=1", "display_name": "Nicolas R", "link": "https://stackoverflow.com/users/3136339/nicolas-r"}, "is_accepted": false, "score": 5, "last_activity_date": 1499938348, "creation_date": 1499938348, "answer_id": 45076709, "question_id": 45068972, "link": "https://stackoverflow.com/questions/45068972/error-handling-in-bot-framework-dialogs/45076709#45076709", "title": "Error handling in Bot Framework dialogs", "body": "<p>You are right about the fact that you can use <code>ExceptionFilter</code>.</p>\n\n<p>You just have to do the following:</p>\n\n<p><strong>Create your ExceptionFilter</strong> class, for example to force the tracking of the exception in Application Insights (or in your case handle specific exception types):</p>\n\n<pre><code>using Microsoft.ApplicationInsights;\nusing System.Net.Http;\nusing System.Web.Http.Filters;\n\nnamespace BotDemo.App_Start\n{\n    public class ExceptionFilter : ExceptionFilterAttribute\n    {\n        public override void OnException(HttpActionExecutedContext ctx)\n        {\n            HandleError(ctx);\n        }\n\n        private static void HandleError(HttpActionExecutedContext ctx)\n        {\n            ctx.Response = new HttpResponseMessage(System.Net.HttpStatusCode.InternalServerError)\n            {\n                Content = new StringContent(ctx.Exception.Message)\n            };\n\n            var client = new TelemetryClient();\n            client.TrackException(ctx.Exception);\n        }\n    }\n}\n</code></pre>\n\n<p>Don't forget to <strong>define your exception filter</strong> in your <code>Application_Start()</code>:</p>\n\n<pre><code>public class WebApiApplication : System.Web.HttpApplication\n{\n    protected void Application_Start()\n    {\n        GlobalConfiguration.Configuration.Filters.Add(new ExceptionFilter());\n         ...\n</code></pre>\n\n<p>That's it.</p>\n\n<p>In fact Bot Framework template is using ASP.Net, so you have all the normal features.</p>\n"}], "owner": {"reputation": 11, "user_id": 8298774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e6815066a3151fa847ac699e1e3a74d?s=128&d=identicon&r=PG&f=1", "display_name": "mircon", "link": "https://stackoverflow.com/users/8298774/mircon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499948122, "creation_date": 1499901390, "question_id": 45068972, "link": "https://stackoverflow.com/questions/45068972/error-handling-in-bot-framework-dialogs", "title": "Error handling in Bot Framework dialogs", "body": "<p>How can I catch all exceptions in dialogs? Is there something like ASP.NET Exception Filter?\nI want to send different messages to user depending on exception type.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c#", "google-maps", "console-application"], "comments": [{"owner": {"reputation": 5133, "user_id": 154762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d07d8564c1726ca28a6b99e560f0ec7?s=128&d=identicon&r=PG", "display_name": "solarc", "link": "https://stackoverflow.com/users/154762/solarc"}, "edited": false, "score": 1, "creation_date": 1499903158, "post_id": 45068920, "comment_id": 77111598, "body": "One way would be to use the Google API itself to give you this information. Otherwise you would need to store a big list of addresses in a database and use a search engine to find the words. You can look into ElasticSearch for that."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 1, "creation_date": 1499904305, "post_id": 45068920, "comment_id": 77111886, "body": "Google the term &quot;Address normalization&quot;, that is the process you are trying to do."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8200940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0440014b8eacbe6dc978d4c448cf5a18?s=128&d=identicon&r=PG&f=1", "display_name": "Jbbanuelos", "link": "https://stackoverflow.com/users/8200940/jbbanuelos"}, "edited": false, "score": 0, "creation_date": 1499954052, "post_id": 45069865, "comment_id": 77137992, "body": "Wow, Rufus L! This is perfect! I&#39;ve essentially learned how to read a few different coding languages, but haven&#39;t quite figured out how you magicians write this stuff! I really appreciate the help!"}], "tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": true, "score": 0, "last_activity_date": 1499911133, "last_edit_date": 1499911133, "creation_date": 1499908159, "answer_id": 45069865, "question_id": 45068920, "link": "https://stackoverflow.com/questions/45068920/console-application-that-validates-address/45069865#45069865", "title": "Console application that validates address", "body": "<p>One way to do it would be to use Googles geocode API. You can pass it a partial address and it will do it's best to return the normalized address for you. If the address isn't very specific, you will get back more than one.</p>\n\n<p>Here's a code example for calling the API and parsing the results:</p>\n\n<pre><code>private static List&lt;string&gt; GetNormalizedAddresses(string address)\n{\n    // Generate request Uri\n    var baseUrl = \"http://maps.googleapis.com/maps/api/geocode/xml\";\n    var requestUri = $\"{baseUrl}?address={Uri.EscapeDataString(address)}&amp;sensor=false\";\n\n    // Get response\n    var request = WebRequest.Create(requestUri);\n    var response = request.GetResponse();\n    var xDoc = XDocument.Load(response.GetResponseStream());\n    var results = xDoc.Element(\"GeocodeResponse\")?.Elements(\"result\").ToList();\n\n    var normalizedAddresses = new List&lt;string&gt;();\n\n    // Populate results\n    if (results != null)\n    {\n        normalizedAddresses.AddRange(results\n            .Select(result =&gt; result.Element(\"formatted_address\")?.Value)\n            .Where(formattedAddress =&gt; !string.IsNullOrWhiteSpace(formattedAddress)));\n    }\n\n    return normalizedAddresses;\n}\n</code></pre>\n\n<p>Then, you could call it like so:</p>\n\n<pre><code>while(true)\n{\n    Console.Write(\"Enter a partial address: \");\n    var partialAddress = Console.ReadLine();\n    Console.WriteLine(new string ('-', 25 + partialAddress.Length));\n\n    var normalizedAddress = GetNormalizedAddresses(partialAddress);\n\n    if (!normalizedAddress.Any())\n    {\n        Console.WriteLine(\"Sorry, couldn't find anything.\");\n    }\n    else\n    {\n        Console.WriteLine(\"That address normalizes to:\");\n        Console.WriteLine($\" - {string.Join($\"\\n - \", normalizedAddress)}\");\n    }\n\n    Console.WriteLine(\"\\n\");        \n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/KvhiL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KvhiL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 8200940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0440014b8eacbe6dc978d4c448cf5a18?s=128&d=identicon&r=PG&f=1", "display_name": "Jbbanuelos", "link": "https://stackoverflow.com/users/8200940/jbbanuelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "closed_date": 1499908781, "accepted_answer_id": 45069865, "answer_count": 1, "score": -4, "last_activity_date": 1499911133, "creation_date": 1499901049, "last_edit_date": 1499903159, "question_id": 45068920, "link": "https://stackoverflow.com/questions/45068920/console-application-that-validates-address", "closed_reason": "Needs more focus", "title": "Console application that validates address", "body": "<p>So I'm trying to figure out how to build a Console Application in C# that essentially mimics google maps. I need to be able to enter an address (even if I abbreviate a word. EX: Silverbell Dr) and output the correct spelling (Silverbell Drive).</p>\n\n<p>The goal here is to be able to enter an address in the search, even if the address spelling is incorrect, and output a value that is close enough to the user input that it won't send back a null value.</p>\n\n<p>If anyone has anything that is similar to this, I would greatly appreciate the help! </p>\n\n<p><em>Boss gave me this assignment knowing that I hardly have a base knowledge on the subject</em></p>\n"}, {"tags": ["c#", "postgresql"], "comments": [{"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1499900458, "post_id": 45068696, "comment_id": 77110886, "body": "Could be that you are missing a <code>using</code> statement which would allow for the use of the extension method"}, {"owner": {"reputation": 342, "user_id": 6859601, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10207819387988049/picture?type=large", "display_name": "Jonathan Burgos Gio", "link": "https://stackoverflow.com/users/6859601/jonathan-burgos-gio"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 2, "creation_date": 1499902200, "post_id": 45068696, "comment_id": 77111358, "body": "I reference with using Microsoft.EntityFrameworkCore and continue the same error."}], "answers": [{"comments": [{"owner": {"reputation": 11614, "user_id": 8360, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/76aded745756cf6acb663021de4c93fc?s=128&d=identicon&r=PG", "display_name": "Zachary Yates", "link": "https://stackoverflow.com/users/8360/zachary-yates"}, "edited": false, "score": 0, "creation_date": 1541721342, "post_id": 45712907, "comment_id": 93323490, "body": "Dang. It shouldn&#39;t be so hard to find the namespace of an extension method. Thanks"}], "tags": [], "owner": {"reputation": 31, "user_id": 2612935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f859a280fc592f8dba6fb609f8c0d1?s=128&d=identicon&r=PG", "display_name": "user2612935", "link": "https://stackoverflow.com/users/2612935/user2612935"}, "is_accepted": false, "score": 3, "last_activity_date": 1502884558, "creation_date": 1502884558, "answer_id": 45712907, "question_id": 45068696, "link": "https://stackoverflow.com/questions/45068696/usenpgsql-not-available-in-iservicecollection-in-net-core/45712907#45712907", "title": "UseNpgsql not available in IServiceCollection in .NET Core", "body": "<p>I had the same issue. I resolved it by adding</p>\n\n<pre><code>using Microsoft.EntityFrameworkCore;\n</code></pre>\n"}], "owner": {"reputation": 342, "user_id": 6859601, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10207819387988049/picture?type=large", "display_name": "Jonathan Burgos Gio", "link": "https://stackoverflow.com/users/6859601/jonathan-burgos-gio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3004, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1550237718, "creation_date": 1499899548, "question_id": 45068696, "link": "https://stackoverflow.com/questions/45068696/usenpgsql-not-available-in-iservicecollection-in-net-core", "title": "UseNpgsql not available in IServiceCollection in .NET Core", "body": "<p>I have .NET Core project in Visual Studio 2017. I am trying to add (Postgresql) database connection. Here is a code:</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n     services.AddMvc();\n\n     services.AddDbContext&lt;ConexionWebApi&gt;(options =&gt; {\n     options.UseNpgsql(\"ConnectionString\", b =&gt; b.MigrationsAssembly(\"WebAPISample\"));\n     });\n\n}\n</code></pre>\n\n<p>But useNpgsql generates the following error:</p>\n\n<blockquote>\n  <p>'DbContextOptionsBuilder' does not contain a definition for 'UseNpgsql' and no extension method 'UseNpgsl' accepting a first argument of type 'DbContextOptionsBuilder' could be found (are you missing a using directive or an assembly refence?)</p>\n</blockquote>\n\n<p>I installed the followings NuGet packages:</p>\n\n<pre><code>Microsoft.EntityFrameworkCore.Tools,    \nNpgsql.EntityFrameworkCore.PostgreSQL,  \nNpgsql.EntityFrameworkCore.PostgreSQL.Design.\n</code></pre>\n\n<p>Should I install some other library?</p>\n"}, {"tags": ["c#", "json", "visual-studio", "object"], "comments": [{"owner": {"reputation": 11416, "user_id": 2455494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/OZBRx.jpg?s=128&g=1", "display_name": "Stewart_R", "link": "https://stackoverflow.com/users/2455494/stewart-r"}, "edited": false, "score": 0, "creation_date": 1499899539, "post_id": 45068676, "comment_id": 77110615, "body": "are you doing a POST in postman and a GET above?"}, {"owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "edited": false, "score": 0, "creation_date": 1499900130, "post_id": 45068676, "comment_id": 77110794, "body": "You need to explain what issues exactly you are having. Directly browsing to your url performs a redirect. We can&#39;t help if we don&#39;t know what parameters you are setting in POSTMAN to make this work correctly"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1499900165, "post_id": 45068676, "comment_id": 77110805, "body": "<code>But in visual studio it dose not work.</code> does not explain what the problem is. It could be anything. Did you get an error, a status code, anything. what does <code>it does not work</code> mean"}, {"owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "edited": false, "score": 0, "creation_date": 1499900424, "post_id": 45068676, "comment_id": 77110878, "body": "Yep, I am getting a 302 redirect performing a get and a 403 error performing a post."}, {"owner": {"reputation": 123, "user_id": 5844648, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2832978772d4b3d816d5a02db3eaaba7?s=128&d=identicon&r=PG", "display_name": "Fattaneh", "link": "https://stackoverflow.com/users/5844648/fattaneh"}, "edited": false, "score": 0, "creation_date": 1499901143, "post_id": 45068676, "comment_id": 77111069, "body": "I use GET in Postman with these <a href=\"https://www.bookstone.com/api/rest/bookshop/gettotal?products=[\" rel=\"nofollow noreferrer\">bookstone.com/api/rest/bookshop/gettotal?products=[</a>{\\&quot;PRICE\\&zwnj;&#8203;&quot;:39.95,\\&quot;RECIPIENT\\&zwnj;&#8203;&quot;:{\\&quot;ZIPCODE\\&quot;:\\&quot;117&zwnj;&#8203;79\\&quot;},\\&quot;CODE\\&quot;:\\&quot;F1-&zwnj;&#8203;509\\&quot;}] . The parameters are  objects Recipient and products . I am asking ,what is the format for passing  parameters in visual studio when the parameter is a object."}], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 5844648, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2832978772d4b3d816d5a02db3eaaba7?s=128&d=identicon&r=PG", "display_name": "Fattaneh", "link": "https://stackoverflow.com/users/5844648/fattaneh"}, "is_accepted": true, "score": 1, "last_activity_date": 1500100951, "creation_date": 1500100951, "answer_id": 45115313, "question_id": 45068676, "link": "https://stackoverflow.com/questions/45068676/how-to-pass-object-parameter-in-http-get-request-in-visual-studio/45115313#45115313", "title": "How to Pass Object Parameter in http Get Request in visual studio", "body": "<p>Fortunately I found the solution for converting array parameter to query parameter in URL.</p>\n\n<pre><code>[{\"PRICE\":98.5,\"RECIPIENT\":{\"ZIPCODE\":\"12345\"},\"CODE\":\"abc\"}]\n var queryString = JsonConvert.SerializeObject(object);\n  //convert to &amp;\n //%5b%7b%22PRICE%22%3a39.95%2c%22RECIPIENT%22%3a%7b%22ZIPCODE%22%3a%2211779%2     2%7d%2c%22CODE%22%3a%22F1-509%22%7d%5d\n  var uri = WebUtility.UrlEncode(queryString);\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 5844648, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/2832978772d4b3d816d5a02db3eaaba7?s=128&d=identicon&r=PG", "display_name": "Fattaneh", "link": "https://stackoverflow.com/users/5844648/fattaneh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7088, "favorite_count": 1, "accepted_answer_id": 45115313, "answer_count": 1, "score": 3, "last_activity_date": 1500100951, "creation_date": 1499899440, "question_id": 45068676, "link": "https://stackoverflow.com/questions/45068676/how-to-pass-object-parameter-in-http-get-request-in-visual-studio", "title": "How to Pass Object Parameter in http Get Request in visual studio", "body": "<p>I have this <code>https://www.bookstone.com/api/rest/bookshop/gettotal?products=[{\\\"PRICE\\\":39.95,\\\"RECIPIENT\\\":{\\\"ZIPCODE\\\":\\\"11779\\\"},\\\"CODE\\\":\\\"F1-509\\\"}]\n</code> \nThis https works fine in Postman and I get the result.</p>\n\n<pre><code>{\n\"SERVICECHARGE\": 14.99,\n\"SUBTOTAL\": 39.95,\n\"TAX\": 0,\n\"ORDERTOTAL\": 54.94,\n\"ORDERNO\": 0,\n}\n</code></pre>\n\n<p>But in visual studio it dose not work.</p>\n\n<pre><code>var url = \"https://www.bookstone.com/api/rest/bookshop/gettotal?products=[{\\\"PRICE\\\":39.95,\\\"RECIPIENT\\\":{\\\"ZIPCODE\\\":\\\"11779\\\"},\\\"CODE\\\":\\\"F1-509\\\"}]\";\n\nvar response = await client.GetAsync(url);\n</code></pre>\n\n<p>Any ideas please? </p>\n"}, {"tags": ["c#", "asp.net-mvc", "routing"], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 8248936, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/gHOAH.jpg?s=128&g=1", "display_name": "Jan Pawe\u0142 Niepsuj", "link": "https://stackoverflow.com/users/8248936/jan-pawe%c5%82-niepsuj"}, "is_accepted": true, "score": 0, "last_activity_date": 1499899467, "creation_date": 1499899467, "answer_id": 45068680, "question_id": 45068658, "link": "https://stackoverflow.com/questions/45068658/html-actionlink-passing-css-class-and-id-at-the-same-time/45068680#45068680", "title": "Html. ActionLink: Passing CSS class and Id at the same time", "body": "<p>So, I tried this to make it work</p>\n\n<pre><code> &lt;td&gt;@Html.ActionLink(\"Sprawd\u017a\",\"Details\",\"Home\", new { @item.Id }, new {@class = \"btn btn-info\" })&lt;/td&gt;\n</code></pre>\n\n<p>Created two annonymous classes, the first one passing Id, and second one passing the class. I leave the topic, maybe someone will find this helpful :) </p>\n"}, {"tags": [], "owner": {"reputation": 6781, "user_id": 6542896, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/AXVK0.jpg?s=128&g=1", "display_name": "Willy David Jr", "link": "https://stackoverflow.com/users/6542896/willy-david-jr"}, "is_accepted": false, "score": 0, "last_activity_date": 1499926296, "creation_date": 1499926296, "answer_id": 45072670, "question_id": 45068658, "link": "https://stackoverflow.com/questions/45068658/html-actionlink-passing-css-class-and-id-at-the-same-time/45072670#45072670", "title": "Html. ActionLink: Passing CSS class and Id at the same time", "body": "<p>It will not work since on the 4th parameter, ActionLink is looking for <strong>object RouteValues</strong> which basically means that this values will be pass on your Controller. The next parameter (5th) are the <strong>object HTMLAttributes</strong> which will be the HTML attributes for your link element:</p>\n\n<pre><code>public static MvcHtmlString ActionLink(\nthis HtmlHelper htmlHelper,\nstring linkText,\nstring actionName,\nstring controllerName,\nobject routeValues, -- for passing values on your controller\nobject htmlAttributes -- for html attributes like css, etc.\n)\n</code></pre>\n\n<p>So you need to change it to:</p>\n\n<pre><code>&lt;td&gt;@Html.ActionLink(\"Sprawd\u017a\",\"Details\",\"Home\", new { intID = @Model.YourPropertyIdName }, new { @Id = Model.YourPropertyIdName, @class = \"btn btn-info\" })&lt;/td&gt; \n</code></pre>\n\n<p>On your controller, it should match the property name on the parameter name. </p>\n\n<p><strong>As you notice, I am passing intID on my ActionLink, so it should match on your controller as well</strong>:</p>\n\n<pre><code>public ActionResult Details(int intID = 0)\n{\n  //TODO:\n}\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8248936, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/gHOAH.jpg?s=128&g=1", "display_name": "Jan Pawe\u0142 Niepsuj", "link": "https://stackoverflow.com/users/8248936/jan-pawe%c5%82-niepsuj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "closed_date": 1499932890, "accepted_answer_id": 45068680, "answer_count": 2, "score": -1, "last_activity_date": 1499926296, "creation_date": 1499899302, "question_id": 45068658, "link": "https://stackoverflow.com/questions/45068658/html-actionlink-passing-css-class-and-id-at-the-same-time", "closed_reason": "Not suitable for this site", "title": "Html. ActionLink: Passing CSS class and Id at the same time", "body": "<p>So, this is how I tried to do it. </p>\n\n<pre><code>&lt;td&gt;@Html.ActionLink(\"Sprawd\u017a\",\"Details\",\"Home\",null,  new { @item.Id, @class = \"btn btn-info\" })&lt;/td&gt; \n</code></pre>\n\n<p>But when I do so, I get Argument exception, because <strong>ActionLink</strong> Is not passing the Id. When I switch places of <strong>null</strong> value and annonymous class, the code works, but class is not applied. Help will be appreciated.</p>\n"}, {"tags": ["c#", "wcf", "iis", "web", "was"], "owner": {"reputation": 227, "user_id": 4379552, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3bd69c0ecb1bd81677690aba73c8373?s=128&d=identicon&r=PG&f=1", "display_name": "Mini", "link": "https://stackoverflow.com/users/4379552/mini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1500046008, "creation_date": 1499898981, "last_edit_date": 1500046008, "question_id": 45068608, "link": "https://stackoverflow.com/questions/45068608/problems-with-hosting-wcf-service-on-iis-using-was-for-nettcp-bindings", "title": "Problems with Hosting WCF service on IIS (Using WAS) for netTCP bindings?", "body": "<p>I created a simple WCF service and hosted it in IIS by creating a new website. In Web.config file,I am providing bindings for http and net tcp. \nI created a console client and adding service reference. It generates two binding in client config - for http and for tcp. When I try to invoke the service using tcp, I get this error -</p>\n\n<p><strong>An unhandled exception of type 'System.ServiceModel.EndpointNotFoundException' occurred in mscorlib.dll\nAdditional information: There was no endpoint listening at net.tcp://computername/Service.svc that could accept the message. This is often caused by an incorrect address or SOAP action.</strong> </p>\n\n<p>when I run using Http endpoint , it works fine. \nNote -\nI am using Windows 10 OS, IIS 10.0 and WPAS\\WAS (Windows Process Activation Service) are installed. I already enabled\\checked HTTP Activation, TCP Activation in .Net framework in Windows features. And modified IIS server settings to include net tcp. Please check it in attached image.\n <a href=\"https://i.stack.imgur.com/qk4ni.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qk4ni.png\" alt=\"enter image description here\"></a></p>\n\n<p>My website Web.config file looks like</p>\n\n<pre><code> &lt;system.serviceModel&gt;\n&lt;bindings&gt;\n  &lt;netTcpBinding&gt;\n    &lt;binding name=\"NewBinding0\" portSharingEnabled=\"true\"&gt;\n      &lt;security mode=\"None\"  /&gt;\n    &lt;/binding&gt;\n  &lt;/netTcpBinding&gt;\n&lt;/bindings&gt;\n&lt;services&gt;\n  &lt;service behaviorConfiguration=\"My\" name=\"WCFServiceOM.Service1\"&gt; &lt;!--  the service name must match the configuration name for the service implementation. --&gt;\n    &lt;endpoint address=\"\" binding=\"basicHttpBinding\" contract=\"WCFServiceOM.IService1\"/&gt;\n    &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\"/&gt;\n    &lt;endpoint  binding=\"netTcpBinding\" bindingConfiguration=\"NewBinding0\" contract=\"WCFServiceOM.IService1\" /&gt;\n    &lt;endpoint address=\"mexOM\" binding=\"mexTcpBinding\" contract=\"IMetadataExchange\"/&gt;\n    &lt;host&gt;\n      &lt;baseAddresses&gt;\n        &lt;add baseAddress=\"net.tcp://localhost:8087/Service1\" /&gt;\n        &lt;add baseAddress=\"http://localhost:7777/Service1\"/&gt;\n      &lt;/baseAddresses&gt;\n    &lt;/host&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n&lt;behaviors&gt;\n  &lt;endpointBehaviors&gt;\n    &lt;behavior name=\"webBehanior\"&gt;\n      &lt;webHttp/&gt;\n    &lt;/behavior&gt;\n  &lt;/endpointBehaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"My\"&gt;\n      &lt;!-- To avoid disclosing metadata information, set the values below to false before deployment --&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" httpsGetEnabled=\"true\"/&gt;\n      &lt;!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information --&gt;\n      &lt;serviceDebug includeExceptionDetailInFaults=\"true\"/&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n</code></pre>\n\n<p>And my client App.Config look like </p>\n\n<pre><code>&lt;configuration&gt;\n&lt;startup&gt; \n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.6\" /&gt;\n&lt;/startup&gt;\n&lt;system.serviceModel&gt;      \n    &lt;bindings&gt;\n        &lt;basicHttpBinding&gt;\n            &lt;binding name=\"BasicHttpBinding_IService1\" /&gt;\n        &lt;/basicHttpBinding&gt;\n        &lt;netTcpBinding&gt;\n            &lt;binding name=\"NetTcpBinding_IService1\"&gt;\n                &lt;security mode=\"None\" /&gt;\n            &lt;/binding&gt;\n        &lt;/netTcpBinding&gt;\n    &lt;/bindings&gt;\n    &lt;client&gt;\n        &lt;endpoint address=\"http://computername:7777/Service.svc\"\n            binding=\"basicHttpBinding\" bindingConfiguration=\"BasicHttpBinding_IService1\"\n            contract=\"ServiceReference1.IService1\" name=\"BasicHttpBinding_IService1\" /&gt;\n        &lt;endpoint address=\"net.tcp://computername/Service.svc\" binding=\"netTcpBinding\"\n            bindingConfiguration=\"NetTcpBinding_IService1\" contract=\"ServiceReference1.IService1\"\n            name=\"NetTcpBinding_IService1\" /&gt;\n    &lt;/client&gt;\n&lt;/system.serviceModel&gt;\n</code></pre>\n\n<p></p>\n"}, {"tags": ["c#", "asp.net", ".net", "rest", "odata"], "owner": {"reputation": 11, "user_id": 8298597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85593b85ed496684d14535c27ab80a10?s=128&d=identicon&r=PG&f=1", "display_name": "Vijaray", "link": "https://stackoverflow.com/users/8298597/vijaray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499924630, "creation_date": 1499898741, "last_edit_date": 1499924630, "question_id": 45068569, "link": "https://stackoverflow.com/questions/45068569/odata-expand-collection-of-a-null-object", "title": "Odata $expand collection of a null object", "body": "<p>I have a strange bug with odata <code>$expand</code>. If I expand the collection of a null object I am getting an error </p>\n\n<blockquote>\n  <p>\"Value cannot be null\"</p>\n</blockquote>\n\n<p>This is my query : <br></p>\n\n<pre><code>GET  localhost/OData/Location(10)/?$expand=position($expand=area($expand=points))\n</code></pre>\n\n<p>This query generates the error</p>\n\n<blockquote>\n  <p>\"Value cannot be null\"</p>\n</blockquote>\n\n<p>Shouldn't expand stop to the first null object ?\nHere area is null.</p>\n\n<p>My classes are like that : </p>\n\n<pre><code>Location \n    - Position \n        - Area \n            - Anchor\n            - ICollection&lt;Points&gt;\n\nLocation\n{\n    public Position position { get; set; }\n}\n\nPosition\n{\n    public Area area { get; set; }\n}\n\nArea\n{\n    public Anchor anchor  { get; set; }\n    public ICollection&lt;Points&gt; points { get; set; }\n}\n</code></pre>\n\n<p>For this location <code>ID=10</code> in my database, the location is not null, position IS NOT NULL but area IS NULL.\nThat is why my query :</p>\n\n<pre><code>localhost/OData/Location(10)?$expand=position($expand=area($expand=points))\n</code></pre>\n\n<p>will generate that error. <br>\nBut it seems that there is a problem only when you expand a collection of a null object because if I expand Anchor object : </p>\n\n<pre><code>GET localhost/OData/Location(10)/?$expand=position($expand=area($expand=anchor)) \n</code></pre>\n\n<p>then the location is expanded correctly and the expand stops at Area - so in json I get \"area\":null, no error, but expanding points collection crashes.</p>\n\n<p>And the requirements from our front end team are to get the object fully expanded, so they will send a query with all sub-objects and sub-collections expanded. <br>\nAnyone knows why <code>$expand</code> does not stop also for collections ?</p>\n"}, {"tags": ["c#", "multithreading", "list"], "comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499899551, "post_id": 45068553, "comment_id": 77110623, "body": "We already have lots of Q&amp;A on Stack Overflow addressing the exception you&#39;re seeing. Note that this really has nothing to do with the multi-threading aspect, except inasmuch as you could take a lock for the entire duration of the enumeration, and also take the same lock while trying to modify the list, to ensure mutual exclusion. If you are implementing producer/consumer and you want to enumerate the list all at once, you should just copy the list and then clear the original. Better approaches involve using <code>Queue&lt;T&gt;</code> or <code>BlockingCollection&lt;T&gt;</code> (which has synchronization built-in)."}, {"owner": {"reputation": 1, "user_id": 8298681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0915486ec053a449d00b49d90cdae8c1?s=128&d=identicon&r=PG&f=1", "display_name": "hearme", "link": "https://stackoverflow.com/users/8298681/hearme"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499899863, "post_id": 45068553, "comment_id": 77110705, "body": "Can you provide another article to assist, the above explanation didn&#39;t explain it in enough detail for myself :/"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499901003, "post_id": 45068553, "comment_id": 77111020, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/b0yss765(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><i>&quot;If changes are made to the collection, such as adding, modifying, or deleting elements, the enumerator is irrecoverably invalidated and its behavior is undefined.&quot;</i></a>  I don&#39;t if that would actually help you that much either, if the discussion already referenced did not. I recommend you copy and paste the error message text into the Stack Overflow search or your favorite web search."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1499901006, "post_id": 45068553, "comment_id": 77111023, "body": "The bottom line is you aren&#39;t allowed to modify a collection while using an enumerator for that collection. How to fix it depends entirely on what your exact code looks like, which you haven&#39;t shared. If after reviewing the available information you still can&#39;t figure it out, post a new question but this time make sure you include a good <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, along with an explanation of what you&#39;ve done so far to try to solve the problem and what <i>specifically</i> you&#39;re still having trouble with."}], "owner": {"reputation": 1, "user_id": 8298681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0915486ec053a449d00b49d90cdae8c1?s=128&d=identicon&r=PG&f=1", "display_name": "hearme", "link": "https://stackoverflow.com/users/8298681/hearme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1499899380, "answer_count": 0, "score": 0, "last_activity_date": 1499899392, "creation_date": 1499898634, "question_id": 45068553, "link": "https://stackoverflow.com/questions/45068553/how-to-edit-list-that-could-be-modified-in-another-thread-locking-multithread", "closed_reason": "Duplicate", "title": "How to edit List that could be modified in another thread. Locking / Multithreading", "body": "<p>I have two static procedures in one class that are called at various points during real time.</p>\n\n<p>Both procedures access the same list. One adds to the list, the other removes items from the list.</p>\n\n<p>The problem is that they are both conflicting with each other and I repeatedly receive the message:</p>\n\n<pre><code>\"Collection was modified; enumeration operation may not execute\"\n</code></pre>\n\n<p>Forgive my ignorance. But I believe I need to lock the collection somehow, whilst one task is working on it. But I also want the other process to immediate take over once the other task has finished.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c#", "html", "css", "asp.net", "gridview"], "comments": [{"owner": {"reputation": 2655, "user_id": 1677285, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1utos.png?s=128&g=1", "display_name": "realbart", "link": "https://stackoverflow.com/users/1677285/realbart"}, "edited": false, "score": 0, "creation_date": 1499898309, "post_id": 45068444, "comment_id": 77110220, "body": "What does the generated html look like?"}, {"owner": {"reputation": 99, "user_id": 8298635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1a620713fba6e861526555a5afb9e76?s=128&d=identicon&r=PG&f=1", "display_name": "The Novice Programmer", "link": "https://stackoverflow.com/users/8298635/the-novice-programmer"}, "reply_to_user": {"reputation": 2655, "user_id": 1677285, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1utos.png?s=128&g=1", "display_name": "realbart", "link": "https://stackoverflow.com/users/1677285/realbart"}, "edited": false, "score": 0, "creation_date": 1499898421, "post_id": 45068444, "comment_id": 77110244, "body": "I have attached the image on the top. I dont know why its not showing inline. Its an hyperlink saying &quot;This is an Asp Gridview with css for rounding corners&quot; @realbart"}, {"owner": {"reputation": 2655, "user_id": 1677285, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1utos.png?s=128&g=1", "display_name": "realbart", "link": "https://stackoverflow.com/users/1677285/realbart"}, "edited": false, "score": 0, "creation_date": 1499898502, "post_id": 45068444, "comment_id": 77110277, "body": "I saw the image, but I don&#39;t remember what html is generated by an asp.net gridview. You should look at the generated html in a browser, and use that for styling. Try display:inline-block"}, {"owner": {"reputation": 99, "user_id": 8298635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1a620713fba6e861526555a5afb9e76?s=128&d=identicon&r=PG&f=1", "display_name": "The Novice Programmer", "link": "https://stackoverflow.com/users/8298635/the-novice-programmer"}, "reply_to_user": {"reputation": 2655, "user_id": 1677285, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1utos.png?s=128&g=1", "display_name": "realbart", "link": "https://stackoverflow.com/users/1677285/realbart"}, "edited": false, "score": 0, "creation_date": 1499898575, "post_id": 45068444, "comment_id": 77110306, "body": "@realbart <a href=\"https://snag.gy/bHyxo.jpg\" rel=\"nofollow noreferrer\">snag.gy/bHyxo.jpg</a> If this helps you."}, {"owner": {"reputation": 2655, "user_id": 1677285, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1utos.png?s=128&g=1", "display_name": "realbart", "link": "https://stackoverflow.com/users/1677285/realbart"}, "edited": false, "score": 0, "creation_date": 1499899359, "post_id": 45068444, "comment_id": 77110569, "body": "If you do &quot;view source&quot; in your browser, what do you see then?"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 8298635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1a620713fba6e861526555a5afb9e76?s=128&d=identicon&r=PG&f=1", "display_name": "The Novice Programmer", "link": "https://stackoverflow.com/users/8298635/the-novice-programmer"}, "edited": false, "score": 0, "creation_date": 1499901261, "post_id": 45068656, "comment_id": 77111097, "body": "Its working bro Thanks, I just had to clear my cache. Thanks a lot appreciate your help man."}, {"owner": {"reputation": 99, "user_id": 8298635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1a620713fba6e861526555a5afb9e76?s=128&d=identicon&r=PG&f=1", "display_name": "The Novice Programmer", "link": "https://stackoverflow.com/users/8298635/the-novice-programmer"}, "edited": false, "score": 0, "creation_date": 1499901792, "post_id": 45068656, "comment_id": 77111244, "body": "If i set the &lt;asp:gridview&gt; Width in percentage it still works but if I set it to certain pixels it works fine. Any solution for that?"}], "tags": [], "owner": {"reputation": 2655, "user_id": 1677285, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1utos.png?s=128&g=1", "display_name": "realbart", "link": "https://stackoverflow.com/users/1677285/realbart"}, "is_accepted": true, "score": 1, "last_activity_date": 1499899639, "last_edit_date": 1499899639, "creation_date": 1499899295, "answer_id": 45068656, "question_id": 45068444, "link": "https://stackoverflow.com/questions/45068444/asp-gridview-css-border-goes-out-of-scope/45068656#45068656", "title": "asp gridview css border goes out of scope", "body": "<p>I think the grid is rendered like this:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div class=\"Grid\" id=\"XXXX_gv1\"&gt;\n&lt;table&gt;\n&lt;tr&gt;&lt;th&gt;column 1&lt;/th&gt;&lt;th&gt;column 2&lt;/th&gt;&lt;th&gt;column 3&lt;/th&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt;value 1&lt;/td&gt;&lt;td&gt;value 2&lt;/td&gt;&lt;td&gt;value 3&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt;value 1&lt;/td&gt;&lt;td&gt;value 2&lt;/td&gt;&lt;td&gt;value 3&lt;/td&gt;&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/div&gt;\n</code></pre>\n\n\n\n<p>so you could then style it:</p>\n\n<pre><code>.Grid {\n    display:inline-block; /* trick to not take 100%. */\n    /* alternatively: you could border .Grid&gt;table */\n    border-radius:8px;\n}\n\n.Grid&gt;table&gt;tbody&gt;tr:first-row {\n  /* special stuff for the first row here */\n}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8298635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1a620713fba6e861526555a5afb9e76?s=128&d=identicon&r=PG&f=1", "display_name": "The Novice Programmer", "link": "https://stackoverflow.com/users/8298635/the-novice-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 45068656, "answer_count": 1, "score": 2, "last_activity_date": 1501110205, "creation_date": 1499898121, "last_edit_date": 1501110205, "question_id": 45068444, "link": "https://stackoverflow.com/questions/45068444/asp-gridview-css-border-goes-out-of-scope", "title": "asp gridview css border goes out of scope", "body": "<p>The below is the css and asp code for the gridview.\nThe border are spreading out then expected. \nI tried setting <strong>Width=100%</strong> which worked, but I want the border to follow the size of grid instead spreading the grid view to occupy space unnecessarily.</p>\n\n<p>This is an Asp Gridview with css for rounding corners</p>\n\n<p>CSS: </p>\n\n<pre><code>    .rounded-corners {\n        border: 1px solid #565656;\n        -webkit-border-radius: 8px;\n        -moz-border-radius: 8px;\n        border-radius: 8px;\n        overflow: hidden;\n}\n\n\n    .Grid td, .Grid th {\n        border: 1px solid #565656;\n        text-align: center; \n        padding-top: 3.5px;\n        padding-bottom: 3.5px;\n        font-size: medium;\n        font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande',     'Lucida Sans', Arial, sans-serif;\n    }\n</code></pre>\n\n<p>Source Code:</p>\n\n<pre><code>&lt;div class=\"rounded-corners\"&gt;\n&lt;div&gt;\n&lt;table class=\"Grid\" cellspacing=\"0\" rules=\"all\" border=\"1\" style=\"border-collapse:collapse;\"&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;th&gt;Description&lt;/th&gt;\n&lt;th&gt;Time&lt;/th&gt;\n&lt;th&gt;Time&lt;/th&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;abc&lt;/td&gt;\n&lt;td&gt;07:30&lt;/td&gt;\n&lt;td&gt;07:30&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;def&lt;/td&gt;\n&lt;td&gt;07:30&lt;/td&gt;\n&lt;td&gt;07:30&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td&gt;ghi&lt;/td&gt;\n&lt;td&gt;07:30&lt;/td&gt;\n&lt;td&gt;07:30&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "asp.net-identity"], "comments": [{"owner": {"reputation": 3824, "user_id": 629521, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/0tVno.jpg?s=128&g=1", "display_name": "solidau", "link": "https://stackoverflow.com/users/629521/solidau"}, "edited": false, "score": 0, "creation_date": 1499903147, "post_id": 45068371, "comment_id": 77111593, "body": "are you using the HTML helpers to create the link?"}, {"owner": {"reputation": 118, "user_id": 3682630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TBnNg.png?s=128&g=1", "display_name": "Propagating", "link": "https://stackoverflow.com/users/3682630/propagating"}, "reply_to_user": {"reputation": 3824, "user_id": 629521, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/0tVno.jpg?s=128&g=1", "display_name": "solidau", "link": "https://stackoverflow.com/users/629521/solidau"}, "edited": false, "score": 0, "creation_date": 1499968376, "post_id": 45068371, "comment_id": 77148004, "body": "Nope. What you see is the only bit of code involved minus a timeout for the cookie being set. Once that timeout occurs it&#39;ll send you back to the  full <code>&#47;Controller&#47;Id&#47;Account&#47;Login</code> path instead of using the root path for the site."}], "owner": {"reputation": 118, "user_id": 3682630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TBnNg.png?s=128&g=1", "display_name": "Propagating", "link": "https://stackoverflow.com/users/3682630/propagating"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499897712, "creation_date": 1499897712, "question_id": 45068371, "link": "https://stackoverflow.com/questions/45068371/make-asp-net-mvc-5-login-path-controller-agnostic", "title": "Make ASP.NET MVC 5 Login Path Controller Agnostic", "body": "<p>Currently, we have a few areas set up in our project. We want the Login Path to be set to the default <code>/Account/Login</code> action, but while inside of an Area the login path will be:</p>\n\n<pre><code>/Controller/Id/Account/Login\n</code></pre>\n\n<p>To be clear, this is NOT asking for a unique login path for every controller/area. Regardless of area/controller it should route to <code>/Account/Login</code>, with no preceding controller or area.</p>\n\n<p>Current app.UseCookieAuthentication code:</p>\n\n<pre><code>`AuthenticationType = DefaultAuthenticationTypes.ApplicationCookie,\nLoginPath = new PathString(\"/Account/Login\"),\nProvider = new CookieAuthenticationProvider`\n</code></pre>\n"}, {"tags": ["c#", "class", "null"], "comments": [{"owner": {"reputation": 14963, "user_id": 834261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vxyWz.png?s=128&g=1", "display_name": "hatchet - done with SOverflow", "link": "https://stackoverflow.com/users/834261/hatchet-done-with-soverflow"}, "edited": false, "score": 2, "creation_date": 1499897458, "post_id": 45068206, "comment_id": 77109931, "body": "It&#39;s confusing that you have a member variable called dtCustomers2, <b>and</b> a local variable also called dtCustomers2 in getCustomerTable."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1499897854, "post_id": 45068206, "comment_id": 77110082, "body": "Please read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> guidance and <a href=\"https://stackoverflow.com/posts/45068206/edit\">edit</a> post to provide minimal sample... (Also I&#39;m afraid you&#39;ll lose reason to ask question on SO when you do that... may not be too bad as post in current form likely collect downvotes in addition to close votes for &quot;no MCVE&quot;)"}, {"owner": {"reputation": 11, "user_id": 8297280, "user_type": "registered", "profile_image": "https://graph.facebook.com/1662748253735440/picture?type=large", "display_name": "Georapella", "link": "https://stackoverflow.com/users/8297280/georapella"}, "edited": false, "score": 0, "creation_date": 1499898448, "post_id": 45068206, "comment_id": 77110259, "body": "That was just a mistake from when I was trying to move the code - it shouldn&#39;t be there. dtCustomers2 isn&#39;t the problem, though. As far as those guidelines, M: I did restart from scratch and rebuilt this in a new program. C: It is complete... that&#39;s all there is in the second program. V: I&#39;m not just saying &quot;it doesn&#39;t work.&quot; I&#39;m asking if anyone can see what is going wrong with populateCustomersTable. As I have made this code in a brand new app and the problem happens again for me, it &quot;Ensure[s] that the example actually reproduces the problem!&quot;"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 1, "creation_date": 1499898560, "post_id": 45068206, "comment_id": 77110301, "body": "Based on the code you posted, you should be getting warnings for both <code>dtCustomers1</code> and <code>dtCustomers2</code>. The first, the warning you&#39;re getting (i.e. will always have the value <code>null</code>), the second, a warning that the field is never used. The code you posted can work with <code>dtCustomers2</code>, because it never tries to use that field. If that difference is not relevant to your question, you need to provide a good <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that shows <i>exactly</i> what&#39;s going on. There&#39;s too much ambiguity here at the moment."}, {"owner": {"reputation": 11, "user_id": 8297280, "user_type": "registered", "profile_image": "https://graph.facebook.com/1662748253735440/picture?type=large", "display_name": "Georapella", "link": "https://stackoverflow.com/users/8297280/georapella"}, "edited": false, "score": 0, "creation_date": 1499899020, "post_id": 45068206, "comment_id": 77110441, "body": "Ambiguity? What can I do to make it less ambiguous? And isn&#39;t the field being used? The table is being filled in both cases."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 1, "creation_date": 1499901228, "post_id": 45068206, "comment_id": 77111091, "body": "<i>&quot;What can I do to make it less ambiguous?&quot;</i> -- the answer to that question can be found in the article <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, which I provided the link for in my previous comment. See also <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> for more advice on how to present your question in a clear, answerable way. <i>&quot;isn&#39;t the field being used?&quot;</i> -- no, it&#39;s not. The only identifier <code>dtCustomers2</code> which you actually use is that of a local variable that <i>hides</i> the field having the same name. The field having that name is never used."}], "owner": {"reputation": 11, "user_id": 8297280, "user_type": "registered", "profile_image": "https://graph.facebook.com/1662748253735440/picture?type=large", "display_name": "Georapella", "link": "https://stackoverflow.com/users/8297280/georapella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499900109, "creation_date": 1499896866, "last_edit_date": 1499900109, "question_id": 45068206, "link": "https://stackoverflow.com/questions/45068206/is-null-and-never-assigned-to-but-it-looks-like-it-does-get-assigned", "title": "...Is null and never assigned to, but it looks like it does get assigned?", "body": "<p>I am trying to populate a DataGridView (datagridviewCustomers) with a table from SQL. Below is my code from the form with the DataGridView, and beneath that is a class that connects to the database (SqlHelper.cs) and has other functions that I use throughout my program so I don't have to keep re-writing the code on each form.</p>\n\n<p>My DataTable that gets data from SQL is called dtCustomers1 and is used as the datasource for my DataGridView. MS Visual Studio tells me that dtCustomers1 is \"never assigned to, and will always have its default value null.\"</p>\n\n<p>dtCustomers2, however, does not show this error and works properly, filling the DataGridView. dtCustomers2 is another DataTable that functions just like dtCustomers1, although it does not use the SqlHelper.cs class. </p>\n\n<p>I created dtCustomers2 to try the code from SqlHelper.cs on the form to see if there was something wrong with the SqlHelper.cs code, but it seems to be working fine when it's on the same form... </p>\n\n<p>Can any one see why this is happening? What am I missing in the code for dtCustomers1 / populateCustomersTable() that is causing this value to be never assigned??</p>\n\n<pre><code>namespace X.FormName\n{\n    sqlDBConnect con; //see sqlHelper.cs below for this class\n    DataTable dtCustomers1;\n\n    public FormName()\n    {\n        InitializeComponent();\n\n        populateCustomerTable(); //uses code from sqlHelper.cs \n        getCustomerTable(); //uses only the code from this form\n    }\n\n    //using sqlHelper.cs and dtCustomers1\n    private void populateCustomerTable()\n    {\n        con = new sqlDBConnect();\n        con.sqlQuery\n            (\n                \"SELECT * FROM dbo.customer\"\n            );\n        con.fetchDT(dtCustomers1);\n        datagridviewCustomers.DataSource = dtCustomers1;\n    }\n\n    // using only code shown below and dtCustomers2\n    private void getCustomerTable()\n    {\n        SqlConnection con = new SqlConnection(@\"DATA CONNECTION STRING\");\n\n        DataTable dtCustomers2 = new DataTable();\n        SqlDataAdapter sda = new SqlDataAdapter(\"SELECT * FROM dbo.customer\", con);\n        sda.Fill(dtCustomers2);\n        tableCustomers.DataSource = dtCustomers2;\n\n        con.Close();\n    }\n}\n</code></pre>\n\n<p>Below is sqlHelper.cs</p>\n\n<pre><code>namespace X\n{\n    public class sqlDBConnect\n    {\n        private SqlConnection _con;\n        public SqlCommand cmd;\n        private SqlDataAdapter _sda;\n\n        public sqlDBConnect()\n        {\n            _con = new SqlConnection(@\"DATA CONNECTION STRING\");\n            _con.Open();\n        }\n\n        public void sqlQuery(string queryText)\n        {\n            cmd = new SqlCommand(queryText, _con);\n        }\n\n        public void fetchDT(DataTable currentDataTable)\n        {\n            _sda = new SqlDataAdapter(cmd);\n            currentDataTable = new DataTable();\n            _sda.Fill(currentDataTable);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "entity"], "answers": [{"comments": [{"owner": {"reputation": 1039, "user_id": 411094, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/fcc7dd8521bbc1e370b3d001b728945d?s=128&d=identicon&r=PG", "display_name": "josh", "link": "https://stackoverflow.com/users/411094/josh"}, "edited": false, "score": 0, "creation_date": 1499897890, "post_id": 45068305, "comment_id": 77110093, "body": "already tried this, List&lt;T&gt; doesnt inherit from IQueryable.  unless you can suggest something to use besides List"}, {"owner": {"reputation": 1153, "user_id": 2383688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U9cAf.jpg?s=128&g=1", "display_name": "ali", "link": "https://stackoverflow.com/users/2383688/ali"}, "reply_to_user": {"reputation": 1039, "user_id": 411094, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/fcc7dd8521bbc1e370b3d001b728945d?s=128&d=identicon&r=PG", "display_name": "josh", "link": "https://stackoverflow.com/users/411094/josh"}, "edited": false, "score": 0, "creation_date": 1499898461, "post_id": 45068305, "comment_id": 77110264, "body": "You can use IQueryable&lt;Request&gt; i = _db.Request.AsQueryable(); to get querable object."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1499899498, "post_id": 45068305, "comment_id": 77110608, "body": "DbContext implements both interfaces, but apparently the two Where implementations (of each interface) are not calling the same code. Rather than swapping List&lt;T&gt; for something more complicated just so you can match IQueryable Linq behavior, I suggest separating how data is loaded versus how its filtered. Why not just call <code>BusinessLogic.Requests = _db.Requests.Where(r =&gt; r.StatusId == Constants.STATUS_NOT_PROCESSED_ID).ToList()</code>? It appears that apiprocessor has alternative ways of getting the list of entities, so you still want to filter on that list? Why not also pre-filter it separately?"}, {"owner": {"reputation": 1039, "user_id": 411094, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/fcc7dd8521bbc1e370b3d001b728945d?s=128&d=identicon&r=PG", "display_name": "josh", "link": "https://stackoverflow.com/users/411094/josh"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1499901457, "post_id": 45068305, "comment_id": 77111143, "body": "@CPerkins hmm the pre-filtering sounds like an interesting idea.  ill try that out as i wait for more answers"}], "tags": [], "owner": {"reputation": 1153, "user_id": 2383688, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U9cAf.jpg?s=128&g=1", "display_name": "ali", "link": "https://stackoverflow.com/users/2383688/ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1499899674, "last_edit_date": 1499899674, "creation_date": 1499897382, "answer_id": 45068305, "question_id": 45068188, "link": "https://stackoverflow.com/questions/45068188/how-to-design-a-common-class-to-accept-a-list-and-dbset/45068305#45068305", "title": "How to design a common class to accept a list and dbset", "body": "<p>Try using </p>\n\n<pre><code>IQuerable&lt;Request&gt; Requests\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>IEnumerable&lt;Request&gt; Requests\n</code></pre>\n\n<p>Update:\nYou can use a repository pattern. I use <a href=\"https://genericunitofworkandrepositories.codeplex.com/documentation\" rel=\"nofollow noreferrer\">this</a> pattern which is very lightweight and extendable.</p>\n"}, {"comments": [{"owner": {"reputation": 1039, "user_id": 411094, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/fcc7dd8521bbc1e370b3d001b728945d?s=128&d=identicon&r=PG", "display_name": "josh", "link": "https://stackoverflow.com/users/411094/josh"}, "edited": false, "score": 0, "creation_date": 1499964656, "post_id": 45068689, "comment_id": 77145823, "body": "edited the main post since you are the second person to mention IQueryable.  IQueryable is not an option because List does not inherit from it which is what the api processor uses. However, using a List in the api processor is not mandatory"}, {"owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "reply_to_user": {"reputation": 1039, "user_id": 411094, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/fcc7dd8521bbc1e370b3d001b728945d?s=128&d=identicon&r=PG", "display_name": "josh", "link": "https://stackoverflow.com/users/411094/josh"}, "edited": false, "score": 0, "creation_date": 1499965502, "post_id": 45068689, "comment_id": 77146310, "body": "<code>DbSet</code> has AsQueryable extension method. You can use as <code>_db.Requests.AsQueryable()</code>. By the way, are you trying to implement <b><i>Repository Pattern</i></b>?"}], "tags": [], "owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "is_accepted": false, "score": 0, "last_activity_date": 1499899498, "creation_date": 1499899498, "answer_id": 45068689, "question_id": 45068188, "link": "https://stackoverflow.com/questions/45068188/how-to-design-a-common-class-to-accept-a-list-and-dbset/45068689#45068689", "title": "How to design a common class to accept a list and dbset", "body": "<p>You could use <code>IQuerable&lt;Request&gt;</code> instead of <code>IEnumerable&lt;Request&gt;</code>. </p>\n\n<p>However, it is not common to have a separate <code>BusinessLogic</code> class just to maintain <code>IQuerable&lt;Request&gt;</code>. </p>\n\n<p>Those whoever needs the data could have called straight to <code>_db.Requests</code>.</p>\n\n<pre><code>var result = _db.Requests\n   .Where(r =&gt; r.StatusId == Constants.STATUS_NOT_PROCESSED_ID)\n   .ToList()\n</code></pre>\n\n<p>Or, you could just create a repository layer like <a href=\"https://github.com/WinLwinOoNet/AspNetCoreActiveDirectoryStarterKit/blob/master/src/Libraries/Asp.Repositories/Users/UserRepository.cs\" rel=\"nofollow noreferrer\">this</a> to keep all logic.</p>\n\n<p>If you do not like neither of above approach, you can use <strong><em><a href=\"http://enterprisecraftsmanship.com/2016/02/08/specification-pattern-c-implementation/\" rel=\"nofollow noreferrer\">Specification pattern</a></em></strong>.</p>\n"}], "owner": {"reputation": 1039, "user_id": 411094, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/fcc7dd8521bbc1e370b3d001b728945d?s=128&d=identicon&r=PG", "display_name": "josh", "link": "https://stackoverflow.com/users/411094/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499899822, "creation_date": 1499896746, "last_edit_date": 1499899822, "question_id": 45068188, "link": "https://stackoverflow.com/questions/45068188/how-to-design-a-common-class-to-accept-a-list-and-dbset", "title": "How to design a common class to accept a list and dbset", "body": "<p>I have some business logic that is used by both an api and a job manager which uses a database to store data.  simplified like this:.</p>\n\n<pre><code>class BusinessLogic \n{\n    public IEnumerable&lt;Request&gt; Requests {get;set;}\n\n    public List&lt;Requests&gt; GetData()\n    {\n         return Requests.Where(r =&gt; r.StatusId == Constants.STATUS_NOT_PROCESSED_ID).ToList();\n    }\n}\n\nclass apiprocessor\n{\n    public void Process()\n    {\n        var requests = new List&lt;Request&gt;();\n\n        BusinessLogic.Requests = requests;\n        BusinessLogic.GetData();\n    }\n}\n\nclass dbprocessor\n{\n    private DbContext _db;\n\n    public void Process()\n    {\n        //this sends the where clause to the db\n        //var requests = _db.Requests.Where(r =&gt; r.StatusId == Constants.STATUS_NOT_PROCESSED_ID).ToList();\n\n        BusinessLogic.Requests = _db.Requests;  //type DbSet&lt;Request&gt; Requests\n        //this one doesnt\n        BusinessLogic.GetData();\n    }\n}\n</code></pre>\n\n<p>functionally this works but there is a problem.</p>\n\n<p>if i try and get the data using the dbcontext in the db processor the resulting query that the mysql server receives is:</p>\n\n<pre><code>SELECT\n`Extent1`.`RequestID`, \n`Extent1`.`RequestType`, \n`Extent1`.`StatusId`\nFROM `Requests` AS `Extent1`\n WHERE (0 = `Extent1`.`StatusId`)\n</code></pre>\n\n<p>(notice the WHERE clause)</p>\n\n<p>when the same code is run in the BusinessLogic class above, the resulting query is:</p>\n\n<pre><code>SELECT\n`Extent1`.`RequestID`, \n`Extent1`.`RequestType`, \n`Extent1`.`StatusId`\nFROM `Requests` AS `Extent1`\n</code></pre>\n\n<p>the Where clause is missing which means that the entire table is being retrieved and then the where clause is being applied to the data in memory</p>\n\n<p>is there anyway to design the common class so that when it gets called with a dbset it sends the where clause to the db? </p>\n\n<p>EDIT: To be clear, IQueryable is not an option because List does not inherit from it which is what the api processor uses.  However, using a List in the api processor is not mandatory</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "winforms", "visual-studio"], "comments": [{"owner": {"reputation": 338, "user_id": 1455124, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/515b4fc4bf3b96e3a9196d234b4bc4b4?s=128&d=identicon&r=PG", "display_name": "Phil Boyd", "link": "https://stackoverflow.com/users/1455124/phil-boyd"}, "edited": false, "score": 0, "creation_date": 1499897003, "post_id": 45068180, "comment_id": 77109764, "body": "Can you update the project to use the most recent version?"}, {"owner": {"reputation": 1, "user_id": 8291684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjzJH.png?s=128&g=1", "display_name": "OPV", "link": "https://stackoverflow.com/users/8291684/opv"}, "reply_to_user": {"reputation": 338, "user_id": 1455124, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/515b4fc4bf3b96e3a9196d234b4bc4b4?s=128&d=identicon&r=PG", "display_name": "Phil Boyd", "link": "https://stackoverflow.com/users/1455124/phil-boyd"}, "edited": false, "score": 0, "creation_date": 1499897295, "post_id": 45068180, "comment_id": 77109864, "body": "How to do that? I have dependencies from Nuget"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 1, "creation_date": 1499904028, "post_id": 45068180, "comment_id": 77111807, "body": ".NET Framwork versioning is complicated, but if you get that error message, it should mean your current installed version (4.6.2) is completely compatible with the version you tried to install. (There are very minor regressions, but they are hard to encounter.) When you say &quot;does not launch&quot;, what exactly happens?"}], "answers": [{"tags": [], "owner": {"reputation": 19413, "user_id": 581076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/KQGy0.png?s=128&g=1", "display_name": "tymtam", "link": "https://stackoverflow.com/users/581076/tymtam"}, "is_accepted": true, "score": 1, "last_activity_date": 1499906572, "creation_date": 1499906572, "answer_id": 45069687, "question_id": 45068180, "link": "https://stackoverflow.com/questions/45068180/how-to-build-project-with-previous-net-framework/45069687#45069687", "title": "How to build project with previous .NET Framework?", "body": "<p>When creating a project you can specify target framework </p>\n\n<p><a href=\"https://i.stack.imgur.com/z8Zrv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z8Zrv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8291684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GjzJH.png?s=128&g=1", "display_name": "OPV", "link": "https://stackoverflow.com/users/8291684/opv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 45069687, "answer_count": 1, "score": -2, "last_activity_date": 1499939408, "creation_date": 1499896724, "last_edit_date": 1499939408, "question_id": 45068180, "link": "https://stackoverflow.com/questions/45068180/how-to-build-project-with-previous-net-framework", "title": "How to build project with previous .NET Framework?", "body": "<p>I wrote a project using .NET Framework 4.6.2. After reinstalling OS Windows and installing the new Visual Studio IDE the project does not launch.</p>\n\n<p>It requires the previous framework, because the current is newest. I tried to change .NET framework in properties of solution. But there is only current version. Then I tried to install required version of framework, it invoke an error like as: you have already installed Framework the latest version.</p>\n\n<p>So, I am in deadlock. How to build project?</p>\n\n<p>I get this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dkw1i.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c#", ".net", "excel", "drop-down-menu", "npoi"], "answers": [{"tags": [], "owner": {"reputation": 1516, "user_id": 7008922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31894ac31a131f455a99f91abb285c2c?s=128&d=identicon&r=PG", "display_name": "kumar chandraketu", "link": "https://stackoverflow.com/users/7008922/kumar-chandraketu"}, "is_accepted": false, "score": 0, "last_activity_date": 1506059831, "last_edit_date": 1506059831, "creation_date": 1500412696, "answer_id": 45177282, "question_id": 45068053, "link": "https://stackoverflow.com/questions/45068053/c-excel-drop-down-list/45177282#45177282", "title": "C# Excel Drop Down List", "body": "<p>your issue seems to be very similar to <a href=\"https://stackoverflow.com/questions/17210373/how-to-set-validation-for-a-cell-in-excel-created-using-npoi/45176085#45176085\">this</a> problem about data validation and data constraint.</p>\n\n<pre><code>XSSFDataValidation dataValidation = null;\nXSSFDataValidationConstraint dvConstraint = null;\nXSSFDataValidationHelper validationHelper = null;\n\nint DVRowLimit = (Int16.MaxValue);\nXSSFCellStyle numberCellStyle = (XSSFCellStyle)workbook.CreateCellStyle();\nXSSFDataFormat numberDataFormat = (XSSFDataFormat)workbook.CreateDataFormat();\nnumberCellStyle.SetDataFormat(numberDataFormat.GetFormat(\"#,###,###\"));\n\n\nCellRangeAddressList cellRangeFieldsType1 = new CellRangeAddressList(1, DVRowLimit, headerCount, headerCount);\ndvConstraint = (XSSFDataValidationConstraint)validationHelper.CreateintConstraint(OperatorType.BETWEEN, \"0\", Int64.MaxValue.ToString());\ndataValidation = (XSSFDataValidation)validationHelper.CreateValidation(dvConstraint, cellRangeFieldsType1);\ndataValidation.ShowErrorBox = true;\ndataValidation.SuppressDropDownArrow = true;\ndataValidation.ErrorStyle = 0;\ndataValidation.CreateErrorBox(\"InvalidValue\", \"Number Should be a integer.\");\ndataValidation.ShowErrorBox = true;\ndataValidation.CreatePromptBox(\"Number Data Validation\", \"Enter Number.\");\ndataValidation.ShowPromptBox = true;\nsheet.AddValidationData(dataValidation);\nsheet.SetDefaultColumnStyle(column, numberCellStyle);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6297912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d3a7619caece76117656f373baf203?s=128&d=identicon&r=PG&f=1", "display_name": "HJB77", "link": "https://stackoverflow.com/users/6297912/hjb77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 981, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506059831, "creation_date": 1499896097, "last_edit_date": 1499897170, "question_id": 45068053, "link": "https://stackoverflow.com/questions/45068053/c-excel-drop-down-list", "title": "C# Excel Drop Down List", "body": "<p>I am trying to create a drop list, haven't had any luck finding similar sample code or documentation to follow so I'm flying solo</p>\n\n<p>When I run this sample code I created</p>\n\n<pre><code>static void Main(string[] args)\n    {\n\n        using (FileStream filename = new FileStream(@\"INSERTYOUROWNPATH.xlsx\", FileMode.Create))\n        {\n\n            var workbook = new XSSFWorkbook();\n\n            XSSFSheet xsheet = (XSSFSheet)workbook.CreateSheet(\"Validation\");\n\n            CT_DataValidation valid = new CT_DataValidation();\n            valid.showDropDown = true;\n            valid.allowBlank = true;\n\n            var constraint = new XSSFDataValidationConstraint(new string[] { \"0064\", \"0061\" }); //to be used in list\n            var range = new CellRangeAddressList(11, 14, 13, 13);    //apply to row 12:14 starting at column N finishing at column N\n            var addingconstraint = new XSSFDataValidation(constraint, range, valid);\n\n            addingconstraint.EmptyCellAllowed = true;\n            addingconstraint.SuppressDropDownArrow = false;\n            xsheet.AddValidationData(addingconstraint);\n\n            workbook.Write(filename);\n\n        }\n    }\n</code></pre>\n\n<p>I get the following errors when I open the spreadsheet:</p>\n\n<blockquote>\n  <p>\"We found a problem with some content in \"Validations.xlsx\" do you\n  want use to try to recover as much as we can? If you trust the source\n  of this workbook, click Yes\"</p>\n</blockquote>\n\n<p>Then I get the following repair message:</p>\n\n<blockquote>\n  <p>\"Repaired Part: /xl/worksheets/sheet1.xml part with XML error. Load\n  error. Line 1 column 684\"</p>\n</blockquote>\n\n<p>Could I please get some insight in to where this is failing?</p>\n"}, {"tags": ["c#", "botframework"], "comments": [{"owner": {"reputation": 1826, "user_id": 3078539, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/z8LeR.jpg?s=128&g=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/3078539/artem"}, "edited": false, "score": 0, "creation_date": 1499939425, "post_id": 45068035, "comment_id": 77126626, "body": "please have a look at <a href=\"https://stackoverflow.com/questions/42749982/initiate-a-message-from-bot-to-user-on-botframework\" title=\"initiate a message from bot to user on botframework\">stackoverflow.com/questions/42749982/&hellip;</a>"}, {"owner": {"reputation": 339, "user_id": 976866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afeb0bc1450aa0fb74c3c6406868ae47?s=128&d=identicon&r=PG", "display_name": "usefulcat", "link": "https://stackoverflow.com/users/976866/usefulcat"}, "reply_to_user": {"reputation": 1826, "user_id": 3078539, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/z8LeR.jpg?s=128&g=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/3078539/artem"}, "edited": false, "score": 0, "creation_date": 1499977334, "post_id": 45068035, "comment_id": 77152956, "body": "Thank you that&#39;s interesting. The accepted answer below precisely answers my question though"}], "answers": [{"tags": [], "owner": {"reputation": 12807, "user_id": 3136339, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CyHpv.jpg?s=128&g=1", "display_name": "Nicolas R", "link": "https://stackoverflow.com/users/3136339/nicolas-r"}, "is_accepted": true, "score": 1, "last_activity_date": 1499986535, "last_edit_date": 1499986535, "creation_date": 1499939328, "answer_id": 45077097, "question_id": 45068035, "link": "https://stackoverflow.com/questions/45068035/bot-framework-bot-initiates-the-conversation-on-skype/45077097#45077097", "title": "Bot Framework - Bot initiates the conversation on Skype", "body": "<p>Skype is throwing different ActivityTypes given the situation:</p>\n\n<ul>\n<li><p>You will get a <code>contactRelationUpdate</code> after adding the bot in your contacts. Then we you start talking to the bot, there is no special Activity</p></li>\n<li><p>When you start a conversation group with the bot included, you will get <code>conversationUpdate</code></p></li>\n</ul>\n\n<p>So if you want to welcome your user, you should add the <code>contactRelationUpdate</code> activity type in your test, like:</p>\n\n<pre><code>private async Task HandleSystemMessage(Activity message)\n{\n    if (message.Type == ActivityTypes.ConversationUpdate || message.Type == ActivityTypes.ContactRelationUpdate)\n    {\n        var reply = message.CreateReply(\"Hello World!\");\n\n        var connector = new ConnectorClient(new Uri(message.ServiceUrl));\n\n        await connector.Conversations.SendToConversationAsync(reply);\n    }\n}\n</code></pre>\n\n<p>Extract of the content of the message you receive when adding the bot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rFj88.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rFj88.png\" alt=\"Skype contact added sample\"></a></p>\n\n<p>Here <code>From</code> is my user and <code>Recipient</code> is bot. You can see that the <code>Action</code> value is <code>add</code></p>\n"}], "owner": {"reputation": 339, "user_id": 976866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afeb0bc1450aa0fb74c3c6406868ae47?s=128&d=identicon&r=PG", "display_name": "usefulcat", "link": "https://stackoverflow.com/users/976866/usefulcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 45077097, "answer_count": 1, "score": 0, "last_activity_date": 1499986535, "creation_date": 1499895990, "question_id": 45068035, "link": "https://stackoverflow.com/questions/45068035/bot-framework-bot-initiates-the-conversation-on-skype", "title": "Bot Framework - Bot initiates the conversation on Skype", "body": "<p>I want my bot to display an introductory message when a user begins a new conversation. I've seen this working with bots in Skype where the bot sends a message before the user types anything.</p>\n\n<p>I have got this working using the Bot Framework Channel Emulator with this code in the MessagesController class:</p>\n\n<pre><code>    public async Task&lt;HttpResponseMessage&gt; Post([FromBody]Activity activity)\n    {\n        if (activity.Type == ActivityTypes.Message)\n        {\n            await Conversation.SendAsync(activity, () =&gt; new Dialogs.RootDialog());\n        }\n        else\n        {\n            await this.HandleSystemMessage(activity);\n        }\n        var response = Request.CreateResponse(HttpStatusCode.OK);\n        return response;\n    }\n\n    private async Task HandleSystemMessage(Activity message)\n    {\n        if (message.Type == ActivityTypes.ConversationUpdate)\n        {\n            var reply = message.CreateReply(\"Hello World!\");\n\n            var connector = new ConnectorClient(new Uri(message.ServiceUrl));\n\n            await connector.Conversations.SendToConversationAsync(reply);\n        }\n    }\n</code></pre>\n\n<p>This displays 'Hello World!' at the beginning of a new conversation. No input required. However on Skype this introductory message does not appear. What I am misunderstanding here? I know it is possible.</p>\n"}, {"tags": ["c#", "c#-4.0", "cmd"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1499896683, "post_id": 45067985, "comment_id": 77109627, "body": "So you are not going to include PsExec.exe with your program? What if they don&#39;t have it?"}, {"owner": {"reputation": 135, "user_id": 6952479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/85dcc0ba009291ce213d8fd191d53626?s=128&d=identicon&r=PG&f=1", "display_name": "FunCoder", "link": "https://stackoverflow.com/users/6952479/funcoder"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1499897107, "post_id": 45067985, "comment_id": 77109801, "body": "Yes I have the program PsExec added to my program, I want to use it without adding the whole directory path to use it. then I will make a installer program to my project so that file will always be within the project."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 6952479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/85dcc0ba009291ce213d8fd191d53626?s=128&d=identicon&r=PG&f=1", "display_name": "FunCoder", "link": "https://stackoverflow.com/users/6952479/funcoder"}, "edited": false, "score": 0, "creation_date": 1499920114, "post_id": 45068464, "comment_id": 77115453, "body": "Hello Rufus, thanks for that, but now I am getting the following error"}, {"owner": {"reputation": 135, "user_id": 6952479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/85dcc0ba009291ce213d8fd191d53626?s=128&d=identicon&r=PG&f=1", "display_name": "FunCoder", "link": "https://stackoverflow.com/users/6952479/funcoder"}, "edited": false, "score": 0, "creation_date": 1499920289, "post_id": 45068464, "comment_id": 77115512, "body": "C:\\users\\aluna\\Documents\\Visual is not recognized as an internal or external command. Operable program or batch file. I added the string leMars21StArguments to my p.StartInfo = leMars21StArguments; and for some reason is giving me that error I added above. can you tell me what could be error. I am also doing a c# windows application form application not a c# console project."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "reply_to_user": {"reputation": 135, "user_id": 6952479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/85dcc0ba009291ce213d8fd191d53626?s=128&d=identicon&r=PG&f=1", "display_name": "FunCoder", "link": "https://stackoverflow.com/users/6952479/funcoder"}, "edited": false, "score": 0, "creation_date": 1499957576, "post_id": 45068464, "comment_id": 77140879, "body": "That error is due to the fact that there are spaces in the file path, so the full path is not being read as a single argument. We need to enclose the full path and file name in quotes, so it&#39;s treated as one argument. I added a quote before the path using the <code>\\ </code> escape character (<code>&quot;&#47;C \\&quot;&quot;  + psExePath ...</code>). For the quote at the end of the string, I used a double-quote (<code>... psExePath + &quot;&quot;&quot; -i ...&quot;</code>) since that string is prefixed with the <code>@</code> sign, which disables the escape character. I updated the output so you can see that the path is now quoted."}, {"owner": {"reputation": 135, "user_id": 6952479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/85dcc0ba009291ce213d8fd191d53626?s=128&d=identicon&r=PG&f=1", "display_name": "FunCoder", "link": "https://stackoverflow.com/users/6952479/funcoder"}, "edited": false, "score": 0, "creation_date": 1499958112, "post_id": 45068464, "comment_id": 77141343, "body": "Hello Rufus, I made the changes as you explained and you are correct that fixed the issues, thanks bro, you are a coding genius. I learned a lot from this thanks again man."}], "tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": true, "score": 0, "last_activity_date": 1499957235, "last_edit_date": 1499957235, "creation_date": 1499898217, "answer_id": 45068464, "question_id": 45067985, "link": "https://stackoverflow.com/questions/45067985/run-the-psexec-without-knowing-the-full-path-in-c-windows-application-form/45068464#45068464", "title": "Run the PsExec without knowing the full path in C# Windows application Form", "body": "<p>If you add it to your program, then you can just reference the location relative to your .exe where you place it.</p>\n\n<p>For example, if you add a new folder called \"Tools\" to your project, and then add psexec.exe there, and set it to \"Copy if newer\" (or \"Copy always\"):</p>\n\n<p><a href=\"https://i.stack.imgur.com/Sx8rk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sx8rk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you can always get the path to it by grabbing the directory that your .exe is in and navigating to the \"Tools\" folder (note that you will need a reference to <code>System.Reflection</code> to use <code>Assembly.GetExecutingAssembly</code>):</p>\n\n<pre><code>var thisExeDirectory = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);\nvar psExecPath = Path.Combine(thisExeDirectory, \"Tools\", \"psexec.exe\");\n</code></pre>\n\n<p>As an example:</p>\n\n<pre><code>var userInfo = new UserInfo {Password = \"LetMeIn\", Username = \"rufusl\"};\nvar thisExeDirectory = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);\nvar psExePath = Path.Combine(thisExeDirectory, \"Tools\", \"psexec.exe\");\n\nvar leMars21StArguments =\n    \"/C \\\"\" + psExePath + @\"\"\" -i \\\\VML-2012-QBOOK2 -u mydomain\\\" + userInfo.Username +\n    \" -p \" + userInfo.Password + @\" -d C:\\batch\\myfile.bat\";\n\nConsole.WriteLine(leMars21StArguments);\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/6wX1K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6wX1K.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 135, "user_id": 6952479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/85dcc0ba009291ce213d8fd191d53626?s=128&d=identicon&r=PG&f=1", "display_name": "FunCoder", "link": "https://stackoverflow.com/users/6952479/funcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 45068464, "answer_count": 1, "score": 0, "last_activity_date": 1499957235, "creation_date": 1499895793, "last_edit_date": 1499899059, "question_id": 45067985, "link": "https://stackoverflow.com/questions/45067985/run-the-psexec-without-knowing-the-full-path-in-c-windows-application-form", "title": "Run the PsExec without knowing the full path in C# Windows application Form", "body": "<p>I need help with my application, I created an application that when they hit the update button will execute some PsExec file to remotetly run some functions. the problem comes that works good in my machine locally but my application will be shared to a lot of users. and I don't want to install to all users the PsExec file to their computers, I just want my program to be installed in their computers and just run the program without any issues.</p>\n\n<p>My code works all the application I just need to add that piece of code that will make the program call the PsExec without knowing the whole Path, right now I installed the PsExec file to my Debug folder, which is the folder that is in my project.</p>\n\n<p>So instead of using the whole PsExec path that is on my directory i will like to use the one of my project </p>\n\n<p>I don't want to use this</p>\n\n<pre><code>string leMars21StArguments = @\"/C C:\\PowerShellRemotly\\PsExec.exe \" + \n    @\"-i \\\\VML-2012-QBOOK2 -u mydomain\\\" + userInfo.Username + \" -p \" + \n    userInfo.Password + \" -d C:\\\\batch\\\\myfile.bat\";\n</code></pre>\n\n<p>I would like something like this where the debug folder of the project, but it doesn't work. is there another to do this?</p>\n\n<pre><code>string leMars21StArguments = @\"/C Debug\\PsExec.exe \" + \n    @\"-i \\\\VML-2012-QBOOK2 -u mydomain\\\" + userInfo.Username + \" -p \" + \n    userInfo.Password + \" -d C:\\\\batch\\\\myfile.bat\";\n</code></pre>\n\n<p>Here's the full code:</p>\n\n<pre><code>Process p = new Process();                    \n\n//assigned from the form txtboxes to the UserInformation class \nuserInfo.Username = txt_Username.Text;\nuserInfo.Password = txt_Password.Text;\n\n//string variabes for the cmd arguments\nstring leMars21StArguments = @\"/C C:\\PowerShellRemotly\\PsExec.exe -i \" + \n    @\"\\\\VML-2012-QBOOK2 -u mydomain\\\" + userInfo.Username + \" -p \" + \n    userInfo.Password + \" -d C:\\\\batch\\\\myfile.bat\";\n\nif (userInfo.Username == string.Empty)\n{\n    MessageBox.Show(\"Username cannot be null, please try again\");\n}\n\nif (userInfo.Password == string.Empty)\n{\n    MessageBox.Show(\"Password cannot be null, please try again\");\n}\n\nif (cmb_DatabaseSelection.SelectedItem == \"location\")\n{\n    p.StartInfo.FileName = \"cmd.exe\";\n    p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;\n    p.StartInfo.CreateNoWindow = true;\n    p.StartInfo.Arguments = leMars21StArguments;\n    p.StartInfo.RedirectStandardOutput = true;\n    p.StartInfo.UseShellExecute = false;\n    p.StartInfo.RedirectStandardError = true;\n\n    p.Start();\n    string output = p.StandardOutput.ReadToEnd();\n    string errOutput = p.StandardError.ReadToEnd();\n    p.Close();\n\n    MessageBox.Show(errOutput);\n}\n</code></pre>\n"}, {"tags": ["c#", "list", "linq"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499895851, "post_id": 45067982, "comment_id": 77109326, "body": "Should these start with the same items?"}, {"owner": {"reputation": 6472, "user_id": 2321042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea2250b729654f9c6a61d9b1c43e545?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2321042/andrew"}, "edited": false, "score": 0, "creation_date": 1499896239, "post_id": 45067982, "comment_id": 77109467, "body": "In sequential order or in the same order? For example, should <code>(1, 4, 3), (2, 1, 4, 3, 5)</code> be true?"}, {"owner": {"reputation": 35, "user_id": 2311337, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/81d6ea698a49f34c13ca3a6a82b63324?s=128&d=identicon&r=PG", "display_name": "NioZero", "link": "https://stackoverflow.com/users/2311337/niozero"}, "edited": false, "score": 0, "creation_date": 1499896760, "post_id": 45067982, "comment_id": 77109658, "body": "Thanks, i was searching and i didn&#39;t found anything..."}, {"owner": {"reputation": 6472, "user_id": 2321042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea2250b729654f9c6a61d9b1c43e545?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2321042/andrew"}, "edited": false, "score": 0, "creation_date": 1499896889, "post_id": 45067982, "comment_id": 77109716, "body": "I came with with a simpler solution which can be of use for you: <a href=\"https://stackoverflow.com/a/45068175/2321042\">stackoverflow.com/a/45068175/2321042</a> You may want to swap the parameters to match your example."}, {"owner": {"reputation": 6472, "user_id": 2321042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ea2250b729654f9c6a61d9b1c43e545?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2321042/andrew"}, "edited": false, "score": 0, "creation_date": 1499897323, "post_id": 45067982, "comment_id": 77109871, "body": "I changed that answer to use generics, but you can just stick to the simpler <code>int</code> version which is in the history. Also remove the <code>this</code> and make it private if you just want a simple local method."}], "owner": {"reputation": 35, "user_id": 2311337, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/81d6ea698a49f34c13ca3a6a82b63324?s=128&d=identicon&r=PG", "display_name": "NioZero", "link": "https://stackoverflow.com/users/2311337/niozero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1499896241, "answer_count": 0, "score": 0, "last_activity_date": 1499896029, "creation_date": 1499895789, "question_id": 45067982, "link": "https://stackoverflow.com/questions/45067982/check-if-a-list-has-all-elements-in-sequential-order", "closed_reason": "Duplicate", "title": "Check if a List has all elements in sequential order", "body": "<p>I want a method that can check if all elements from one list are in another list but in sequential order.</p>\n\n<p>Example</p>\n\n<pre><code>List&lt;int&gt; list1 = new List&lt;int&gt;{ 1, 3, 4 };\nList&lt;int&gt; list2 = new List&lt;int&gt;{ 1, 2, 3 };\nList&lt;int&gt; list3 = new List&lt;int&gt;{ 1, 2, 3, 4, 5 };\n\nif(IsInSequential(list1, list3)) // should return false\n{\n    // stuff...\n}\n\nif(IsInSequential(list2, list3)) // should return true\n{\n    // stuff...\n}\n\nif(IsInSequential(list3, list2)) // should return false\n{\n    // stuff...\n}\n\nbool IsInSequential(List&lt;int&gt; list1, List&lt;int&gt; list2)\n{\n    // ???\n}\n</code></pre>\n\n<p>I was trying to use methods like <code>Intersect</code>, <code>Select</code>, <code>Any</code> and other stuff but it was getting too complicated and i don't know if exists a more efficient way.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "design-patterns", "dependency-injection"], "comments": [{"owner": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "edited": false, "score": 0, "creation_date": 1499895874, "post_id": 45067958, "comment_id": 77109338, "body": "In regards to the third approach one question that pops in my head right away is how do I <code>unit</code> test &quot;GetMovies&quot;"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499895952, "post_id": 45067958, "comment_id": 77109358, "body": "Why would you even care to check if _userService/_movieService are null? You never use them twice"}, {"owner": {"reputation": 5308, "user_id": 2371128, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/OUH5w.png?s=128&g=1", "display_name": "Bagzli", "link": "https://stackoverflow.com/users/2371128/bagzli"}, "reply_to_user": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "edited": false, "score": 0, "creation_date": 1499895958, "post_id": 45067958, "comment_id": 77109360, "body": "@Jaya I think I see your point, you are asking me how to be able to pass a fake DbContext vs a real one."}, {"owner": {"reputation": 5308, "user_id": 2371128, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/OUH5w.png?s=128&g=1", "display_name": "Bagzli", "link": "https://stackoverflow.com/users/2371128/bagzli"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499896066, "post_id": 45067958, "comment_id": 77109403, "body": "@CamiloTerevinto Completely beside the point and out of scope for the question. It&#39;s just a sample code."}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499896134, "post_id": 45067958, "comment_id": 77109430, "body": "Without the constructor of both MovieService and UserService, we can&#39;t answer this. Why is it that they are so expensive to instantiate that you don&#39;t want to do it when not needed?"}, {"owner": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "edited": false, "score": 0, "creation_date": 1499896139, "post_id": 45067958, "comment_id": 77109432, "body": "@here why the downvote. @Bojan : right, fake anything in this case a <code>Mocked&lt;IUserService&gt;</code> and <code>Mocked&lt;IMovieService&gt;</code> basically to test various scenarios : like how do you test return type/result , how do you test any forked logic inside the <code>GetMovies</code> if any based on the obtained result etc (just making up these scenarios)"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499896252, "post_id": 45067958, "comment_id": 77109472, "body": "By the way, if you need to resolve the dependency yourself (third case), you also lost DI"}, {"owner": {"reputation": 5308, "user_id": 2371128, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/OUH5w.png?s=128&g=1", "display_name": "Bagzli", "link": "https://stackoverflow.com/users/2371128/bagzli"}, "reply_to_user": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "edited": false, "score": 1, "creation_date": 1499896259, "post_id": 45067958, "comment_id": 77109475, "body": "@Jaya I could also inject into my unit tests to ensure testing is possible. Never really done that, but now I am wondering if it is such bad idea?"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 1, "creation_date": 1499896841, "post_id": 45067958, "comment_id": 77109697, "body": "@Bojan came across this article the other day that you may find interesting <a href=\"https://rehansaeed.com/asp-net-core-lazy-command-pattern/\" rel=\"nofollow noreferrer\">rehansaeed.com/asp-net-core-lazy-command-pattern</a>"}, {"owner": {"reputation": 5308, "user_id": 2371128, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/OUH5w.png?s=128&g=1", "display_name": "Bagzli", "link": "https://stackoverflow.com/users/2371128/bagzli"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1499897576, "post_id": 45067958, "comment_id": 77109976, "body": "@Nkosi that was a good read. Thank you. Its what Yacoub Massad suggested just more in depth."}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1499897697, "post_id": 45067958, "comment_id": 77110021, "body": "@Bojan as soon as I saw your question it reminded me about that article. Yes Yacoub&#39;s answers landed relatively close to what was done in the article."}], "answers": [{"comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499896489, "post_id": 45068102, "comment_id": 77109555, "body": "I&#39;m not completely sure the last part applies here (the composition root part) since it seems to be an ASP.NET Core DI (i.e you don&#39;t instantiate the Controller). But I also asked about the performance problem of instantiating the services"}, {"owner": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499896604, "post_id": 45068102, "comment_id": 77109600, "body": "@CamiloTerevinto: not only it doesn&#39;t apply here but also it wouldn&#39;t apply to original mvc as well. You don&#39;t instantiate controllers by your own there also."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1499896754, "post_id": 45068102, "comment_id": 77109653, "body": "@WiktorZychla, in ASP.NET MVC, you can create a custom <code>IControllerFactory</code>, this is how you do <a href=\"http://blog.ploeh.dk/2014/06/10/pure-di/\" rel=\"nofollow noreferrer\">Pure DI</a>"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499896803, "post_id": 45068102, "comment_id": 77109675, "body": "@CamiloTerevinto, I remember there is a way to use Pure DI in ASP.NET Core too."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499896912, "post_id": 45068102, "comment_id": 77109725, "body": "@CamiloTerevinto, you can do it probably by implementing <code>IControllerActivator</code>, <code>IViewComponentActivator</code> and <code>ITagHelperActivator</code>"}, {"owner": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 2, "creation_date": 1499896936, "post_id": 45068102, "comment_id": 77109736, "body": "@YacoubMassad: you could but you don&#39;t really need it, only the last part of your answer is unnecessary, the rest is ok. You just inject lazies and that&#39;s all. I won&#39;t even bother finishing my own answer here as yours covers the issue."}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499897021, "post_id": 45068102, "comment_id": 77109769, "body": "I&#39;d think that&#39;s too much trouble for no real benefit, but I might be missing something."}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "reply_to_user": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1499897068, "post_id": 45068102, "comment_id": 77109783, "body": "@WiktorZychla I&#39;d say the real answer is to check the services initialization code, since even implementing this lazy-ness won&#39;t help a lot"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1499897071, "post_id": 45068102, "comment_id": 77109787, "body": "@WiktorZychla, I use Pure DI for a reason, see this article for more details: <a href=\"http://www.dotnetcurry.com/patterns-practices/1285/clean-composition-roots-dependency-injection\" rel=\"nofollow noreferrer\">dotnetcurry.com/patterns-practices/1285/&hellip;</a>"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1499897216, "post_id": 45068102, "comment_id": 77109831, "body": "In another article <a href=\"http://criticalsoftwareblog.com/index.php/2015/08/23/why-di-containers-fail-with-complex-object-graphs/\" rel=\"nofollow noreferrer\">here</a>, I describe some problems of using DI containers."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499897262, "post_id": 45068102, "comment_id": 77109844, "body": "@CamiloTerevinto, see the articles I send in the comments for the reason why I use Pure DI."}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1499897383, "post_id": 45068102, "comment_id": 77109891, "body": "@YacoubMassad what do you think about this article I came across the other day <a href=\"https://rehansaeed.com/asp-net-core-lazy-command-pattern/\" rel=\"nofollow noreferrer\">rehansaeed.com/asp-net-core-lazy-command-pattern</a>"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1499898133, "post_id": 45068102, "comment_id": 77110176, "body": "@Nkosi, I think it is a good article. I only use ASP.NET lightly. But more and more I think that concept of a controller should be removed. As this article shows, the only role of the controller is to enable routing to some command/query handler. I bet someone can create a library that enables developers to route to command/query handlers directly."}, {"owner": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1499924911, "post_id": 45068102, "comment_id": 77117153, "body": "@YacoubMassad: remember that controllers have access to all the infrastructure info (http context, route datas etc) while handlers barely do so, they onoy implement specific logic. When there are no controllers how would you glue the http context stuff directly to handlers? Even if technically possible, that doesn&#39;t sound right from the OO perspective."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1499933934, "post_id": 45068102, "comment_id": 77122703, "body": "@WiktorZychla, you can access such infrastructure info via dependencies. Regarding OO, no one really knows what OO is really about. I have seen very different opinions of what OO is about. Is it about data encapsulation? or polymorphism? Or about modeling real-world things? etc."}, {"owner": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1499934685, "post_id": 45068102, "comment_id": 77123220, "body": "@YacoubMassad: following SOLID/GRASP for example. Injecting infrastructure-specific dependencies to service classes sounds wrong, services should be infrastructure-agnostic otherwise you break the SRP. Anyway, this &quot;someone&quot; to provide a different approach could be you, make a proof-of-concept of a small framework and let people comment it. You even got your first feedback, from me, without even writing a single line of code ;) Regards."}], "tags": [], "owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "is_accepted": true, "score": 4, "last_activity_date": 1499896347, "creation_date": 1499896347, "answer_id": 45068102, "question_id": 45067958, "link": "https://stackoverflow.com/questions/45067958/is-using-dependency-resolver-a-bad-practice/45068102#45068102", "title": "Is using Dependency Resolver a bad practice?", "body": "<p>Using the dependency resolver this way means that you are using <a href=\"http://criticalsoftwareblog.com/index.php/2015/10/25/object-composability-another-reason-why-the-service-locator-is-an-anti-pattern/\" rel=\"nofollow noreferrer\">the service locator anti-pattern</a>.</p>\n\n<p>Is there any reason why you think that creating <code>MovieService</code> and <code>UserService</code> will have performance issues? Are you doing something significant in the constructor of these classes? If so, then you probably shouldn't. In the constructor you should almost always just accept the dependencies and store them in private fields.</p>\n\n<p>If for some reason, you still want lazy loading, then you can create something like this:</p>\n\n<pre><code>public class LazyMovieService : IMovieService\n{\n    private readonly Lazy&lt;IMovieService&gt; lazyInstance;\n\n    public LazyMovieService(Func&lt;IMovieService&gt; instanceFactory)\n    {\n        lazyInstance = new Lazy&lt;IMovieService&gt;(instanceFactory);\n    }\n    public string[] GetMovies()\n    {\n        return lazyInstance.Value.GetMovies();\n    }\n}\n</code></pre>\n\n<p>This class allows you to use the first code example in your code while still being able to lazily load your services.</p>\n\n<p>In the <a href=\"http://blog.ploeh.dk/2011/07/28/CompositionRoot/\" rel=\"nofollow noreferrer\">Composition Root</a>, you would simply do something like:</p>\n\n<pre><code>var controller =\n    new MovieController(\n        new LazyMovieService(() =&gt; new MyOriginalMovieService(...)),\n        ...);\n</code></pre>\n"}], "owner": {"reputation": 5308, "user_id": 2371128, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/OUH5w.png?s=128&g=1", "display_name": "Bagzli", "link": "https://stackoverflow.com/users/2371128/bagzli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1031, "favorite_count": 0, "accepted_answer_id": 45068102, "answer_count": 1, "score": 1, "last_activity_date": 1499896574, "creation_date": 1499895667, "last_edit_date": 1499896574, "question_id": 45067958, "link": "https://stackoverflow.com/questions/45067958/is-using-dependency-resolver-a-bad-practice", "title": "Is using Dependency Resolver a bad practice?", "body": "<p>I am going to make up an example here just to get my point across. Please consider the following class:</p>\n\n<pre><code>public class MovieController : Controller\n{\n    private readonly IMovieService _movieService;\n    private readonly IUserService _userService;\n\n    public MovieController(IMovieService movieService, IUserService userService)\n    {\n        _movieService = movieService;\n        _userService = userService;\n    }\n\n    public ViewModel GetMovies()\n    {\n        return View(\"Movies\", _movieService.GetMovies());\n    }\n\n    public ViewModel GetAuthors()\n    {\n        return View(\"Authors\", _userService.GetAuthors());\n    }\n}\n</code></pre>\n\n<p>With the example above, whenever the MovieController is created, it will create both services. Each service will require its services and repositories in the constructor. So, in reality, I may be creating some classes each time MovieController is called. For this reason, I want to implement Lazy loading as I believe it will improve performance. For this reason, please consider the next class:</p>\n\n<pre><code>public class MovieController : Controller\n{\n    private readonly IMovieService _movieService;\n    private readonly IUserService _userService;\n\n    private MovieService \n    {\n        get \n        {\n            if (_movieService == null) _movieService = new MovieService();\n            return _movieService;\n        }\n    }\n\n    private UserService \n    {\n        get \n        {\n            if (_userService == null) _userService = new UserService();\n            return _userService;\n        }\n    }\n\n    public MovieController() { }\n\n    public ViewModel GetMovies()\n    {\n        return View(\"Movies\", MovieService.GetMovies());\n    }\n\n    public ViewModel GetAuthors()\n    {\n        return View(\"Authors\", UserService.GetAuthors());\n    }\n}\n</code></pre>\n\n<p>The problem with the above example is that I lost DI. Now I understand the benefit of DI, and I very much want to keep it, and as such, I came up with the following example:</p>\n\n<pre><code>public class MovieController : Controller\n{\n    private readonly IMovieService _movieService;\n    private readonly IUserService _userService;\n\n    private MovieService \n    {\n        get \n        {\n            if (_movieService == null) _movieService = DependencyResolver.Current.GetService(typeof(IMovieService));\n            return _movieService;\n        }\n    }\n\n    private UserService \n    {\n        get \n        {\n            if (_userService == null) _userService = DependencyResolver.Current.GetService(typeof(IUserService));\n            return _userService;\n        }\n    }\n\n    public MovieController() { }\n\n    public ViewModel GetMovies()\n    {\n        return View(\"Movies\", MovieService.GetMovies());\n    }\n\n    public ViewModel GetAuthors()\n    {\n        return View(\"Authors\", UserService.GetAuthors());\n    }\n}\n</code></pre>\n\n<p>Is my third example in this question a bad practice? If so, why? Am I losing on performance by doing this or is there another reason why this would be considered bad practice?</p>\n"}, {"tags": ["c#", "unity3d", "game-engine"], "comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1499906205, "post_id": 45067912, "comment_id": 77112337, "body": "Both answers are wrong. Do not use the <code>new</code> keyword to create instance  of script that inherits from <code>MonoBehaviour</code>. See <a href=\"https://stackoverflow.com/a/37399263/3785314\">this</a> for more information."}], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 7310542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8015333047ac9e933587a9e1db17511d?s=128&d=identicon&r=PG&f=1", "display_name": "Eliuber", "link": "https://stackoverflow.com/users/7310542/eliuber"}, "is_accepted": true, "score": 0, "last_activity_date": 1499896102, "last_edit_date": 1499896102, "creation_date": 1499895793, "answer_id": 45067984, "question_id": 45067912, "link": "https://stackoverflow.com/questions/45067912/using-static-variable-in-different-class-in-unity/45067984#45067984", "title": "Using static variable in different class in Unity", "body": "<p>You can get the value of a static variable with class.property</p>\n\n<pre><code>public class ScoreText : MonoBehaviour {\n\n    int sc =0 ;\n\n    void Update () {\n        sc = Score.score;\n    }\n}\n</code></pre>\n\n<p>And change private static int score; for public static int score;</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8298523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e1cbcbb6a146ac995fab157cccffab?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8298523/john"}, "edited": false, "score": 0, "creation_date": 1499896226, "post_id": 45068018, "comment_id": 77109462, "body": "Thank you for your answer"}], "tags": [], "owner": {"reputation": 3164, "user_id": 5056173, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/99dc39f718c2d6e8a5f0a300e0b3c482?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Stayns", "link": "https://stackoverflow.com/users/5056173/sean-stayns"}, "is_accepted": false, "score": 0, "last_activity_date": 1499895946, "creation_date": 1499895946, "answer_id": 45068018, "question_id": 45067912, "link": "https://stackoverflow.com/questions/45067912/using-static-variable-in-different-class-in-unity/45068018#45068018", "title": "Using static variable in different class in Unity", "body": "<p>Change <code>private static int score;</code> to <code>public static int score;</code> and call it like this: <code>Score.score = 5;</code> </p>\n\n<p>If you want to use it as property, you can do the following:</p>\n\n<pre><code>private static int _score;\n\npublic int score {\n   get{return _score;} \n   set{_score = value;}\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8298523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e1cbcbb6a146ac995fab157cccffab?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8298523/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 45067984, "answer_count": 2, "score": 0, "last_activity_date": 1499896102, "creation_date": 1499895475, "question_id": 45067912, "link": "https://stackoverflow.com/questions/45067912/using-static-variable-in-different-class-in-unity", "title": "Using static variable in different class in Unity", "body": "<p>I have the following code</p>\n\n<pre><code>public class Score : MonoBehaviour {\n\n    private static int score;\n    public int sc;\n\n    void OnTriggerEnter2D(Collider2D col) {\n        if (col.tag == \"Ball\") {\n            score++;\n            sc = score;\n        }\n    }\n</code></pre>\n\n<p>and this is the class I'm using to get the score from the class above</p>\n\n<pre><code>public class ScoreText : MonoBehaviour {\n\n    Score s = new Score();\n    int sc;\n\n    void Update () {\n        sc = s.sc;\n    }\n}\n</code></pre>\n\n<p>But for some reason, my sc variable in the class ScoreText is always 0. How can I fix that?</p>\n"}, {"tags": ["c#", ".net", "wcf", "service", "wcfserviceclient"], "comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1499929007, "post_id": 45067888, "comment_id": 77119372, "body": "Is the method you&#39;re trying to call via the test client implemented in the service?"}], "answers": [{"comments": [{"owner": {"reputation": 6451, "user_id": 1236694, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/77f6b46fe521c6807aefe4a2c33c2320?s=128&d=identicon&r=PG", "display_name": "BaltoStar", "link": "https://stackoverflow.com/users/1236694/baltostar"}, "edited": false, "score": 0, "creation_date": 1499896967, "post_id": 45068079, "comment_id": 77109749, "body": "sorry to be dense but how am i using port sharing ?  also the overload you provide for ServiceHost doesn&#39;t seem to exist.  all i have is an overload with URI as the 2nd arg"}, {"owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "reply_to_user": {"reputation": 6451, "user_id": 1236694, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/77f6b46fe521c6807aefe4a2c33c2320?s=128&d=identicon&r=PG", "display_name": "BaltoStar", "link": "https://stackoverflow.com/users/1236694/baltostar"}, "edited": false, "score": 0, "creation_date": 1499898227, "post_id": 45068079, "comment_id": 77110204, "body": "What version of .net are you using? <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/how-to-configure-a-wcf-service-to-use-port-sharing\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/wcf/feature-detail&zwnj;&#8203;s/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5910, "user_id": 624988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/868279d15f1f45fd1615508c3df87c2f?s=128&d=identicon&r=PG", "display_name": "Alexander Higgins", "link": "https://stackoverflow.com/users/624988/alexander-higgins"}, "is_accepted": false, "score": 0, "last_activity_date": 1499896218, "creation_date": 1499896218, "answer_id": 45068079, "question_id": 45067888, "link": "https://stackoverflow.com/questions/45067888/wcf-service-config-address/45068079#45068079", "title": "WCF Service : config address", "body": "<p>When using Port sharing, you need to pass a <code>NetTcpBinding</code> with <code>PortSharingEnabled</code> set to <code>true</code> to the constructor:</p>\n\n<pre><code>portsharingBinding = new NetTcpBinding();\nportsharingBinding.PortSharingEnabled = true;\n\nvar host = new ServiceHost(typeof(MyService), portsharingBinding, new Uri(\"net.tcp://localhost:9999/MyService\"));\nhost.Open();\n</code></pre>\n\n<p>Also, your have you made sure that your service implements an interface with the a <code>ServiceContract</code></p>\n\n<pre><code>[ServiceContract]\ninterface IMyService \n{\n    //Define the contract operations.  \n}\n\nclass MyService : IMyService \n{  \n    //Implement the IMyService operations. \n}\n</code></pre>\n\n<p>Also make sure the contract in your config  <code>MyService.Contracts.Interfaces.IMy</code> matches that interface  exactly. This is case sensitive.</p>\n"}], "owner": {"reputation": 6451, "user_id": 1236694, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/77f6b46fe521c6807aefe4a2c33c2320?s=128&d=identicon&r=PG", "display_name": "BaltoStar", "link": "https://stackoverflow.com/users/1236694/baltostar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 682, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499896218, "creation_date": 1499895328, "question_id": 45067888, "link": "https://stackoverflow.com/questions/45067888/wcf-service-config-address", "title": "WCF Service : config address", "body": "<p>In my WCF Service <code>App.config</code> I have : </p>\n\n<pre><code>&lt;services&gt;\n  &lt;service behaviorConfiguration=\"MyServiceWcfBehavior\" name=\"MyService\"&gt;\n    &lt;clear /&gt;\n    &lt;endpoint address=\"net.tcp://localhost:9999/MyService\" binding=\"customBinding\" bindingConfiguration=\"MyServiceTcpBinding\" name=\"MyServiceWcfTcpEndpoint\" contract=\"MyService.Contracts.Interfaces.IMy\" /&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n</code></pre>\n\n<p>And in my test-client <code>App.config</code> I have : </p>\n\n<pre><code>&lt;client&gt;\n  &lt;endpoint address=\"net.tcp://localhost:9999/MyService\" behaviorConfiguration=\"MyServiceEndpointBehavior\" binding=\"customBinding\" bindingConfiguration=\"MyServiceCustomTcpBinding\" contract=\"MyService.Contracts.Interfaces.IMy\" name=\"MyServiceWcfTcpEndpoint\" /&gt;\n&lt;/client&gt;\n</code></pre>\n\n<p>Then I instantiate my <code>ServiceHost</code> like this : </p>\n\n<pre><code>var host = new ServiceHost(typeof(MyService),new Uri(net.tcp://localhost:9999/MyService));\nhost.Open();\n</code></pre>\n\n<p>But on running my service and then testing with my client ( calling channel endpoint defined in my service ) I get runtime exception : </p>\n\n<blockquote>\n  <p>System.ServiceModel.FaultException`1 was unhandled\n  Action=<a href=\"http://schemas.microsoft.com/net/2005/12/windowscommunicationfoundation/dispatcher/fault\" rel=\"nofollow noreferrer\">http://schemas.microsoft.com/net/2005/12/windowscommunicationfoundation/dispatcher/fault</a>\n        HResult=-2146233087\n        Message=The method or operation is not implemented.\n        Source=mscorlib\n        StackTrace:\n          Server stack trace: \n             at System.ServiceModel.Channels.ServiceChannel.ThrowIfFaultUnderstood(Message\n  reply, MessageFault fault, String action, MessageVersion version,\n  FaultConverter faultConverter)\n             at System.ServiceModel.Channels.ServiceChannel.HandleReply(ProxyOperationRuntime\n  operation, ProxyRpc&amp; rpc)\n             at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins,\n  Object[] outs, TimeSpan timeout)\n             at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage\n  methodCall, ProxyOperationRuntime operation)\n             at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage\n  message)\n          Exception rethrown at [0]: \n             at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage\n  reqMsg, IMessage retMsg)\n             at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp;\n  msgData, Int32 type)</p>\n</blockquote>\n"}, {"tags": ["c#", ".net", "azure", "bots", "botframework"], "comments": [{"owner": {"reputation": 14579, "user_id": 90081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061363ce8de1f79af81d2766c75fe4d6?s=128&d=identicon&r=PG", "display_name": "Ezequiel Jadib", "link": "https://stackoverflow.com/users/90081/ezequiel-jadib"}, "edited": false, "score": 0, "creation_date": 1499896069, "post_id": 45067862, "comment_id": 77109404, "body": "So, what you want to do is have users talk to your bot and at some point ask them to authenticate against X provider? What language are u using?"}, {"owner": {"reputation": 822, "user_id": 5965537, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/be4da9013bd5e509538dea3d5ea751e4?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/5965537/megan"}, "reply_to_user": {"reputation": 14579, "user_id": 90081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061363ce8de1f79af81d2766c75fe4d6?s=128&d=identicon&r=PG", "display_name": "Ezequiel Jadib", "link": "https://stackoverflow.com/users/90081/ezequiel-jadib"}, "edited": false, "score": 0, "creation_date": 1499896628, "post_id": 45067862, "comment_id": 77109605, "body": "I would like to ask them to authenticate against MSFT at the beginning of  a conversation only. I am using c#"}, {"owner": {"reputation": 14579, "user_id": 90081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061363ce8de1f79af81d2766c75fe4d6?s=128&d=identicon&r=PG", "display_name": "Ezequiel Jadib", "link": "https://stackoverflow.com/users/90081/ezequiel-jadib"}, "edited": false, "score": 0, "creation_date": 1499896729, "post_id": 45067862, "comment_id": 77109641, "body": "Yes, you don&#39;t need to secure the app service. All need to be handled via code in your bot. I will close the question as a duplicate and point you to the previous questions where this was discussed."}, {"owner": {"reputation": 14579, "user_id": 90081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061363ce8de1f79af81d2766c75fe4d6?s=128&d=identicon&r=PG", "display_name": "Ezequiel Jadib", "link": "https://stackoverflow.com/users/90081/ezequiel-jadib"}, "edited": false, "score": 0, "creation_date": 1499896805, "post_id": 45067862, "comment_id": 77109676, "body": "And basically any other thread from <a href=\"https://stackoverflow.com/search?q=%5Bbotframework%5D+authbot\">here</a> discussed this scenario."}, {"owner": {"reputation": 22308, "user_id": 7005159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550c3427cedf0d13b6d2b03bf25a793f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Sun - MSFT", "link": "https://stackoverflow.com/users/7005159/tom-sun-msft"}, "edited": false, "score": 0, "creation_date": 1500025131, "post_id": 45067862, "comment_id": 77170724, "body": "It may be the same with WebApi. We may could get more detail steps from the <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-devquickstarts-webapi-dotnet\" rel=\"nofollow noreferrer\">azure official document</a>."}], "owner": {"reputation": 822, "user_id": 5965537, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/be4da9013bd5e509538dea3d5ea751e4?s=128&d=identicon&r=PG&f=1", "display_name": "Megan", "link": "https://stackoverflow.com/users/5965537/megan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "closed_date": 1500397338, "answer_count": 0, "score": 1, "last_activity_date": 1499896667, "creation_date": 1499895170, "last_edit_date": 1499896667, "question_id": 45067862, "link": "https://stackoverflow.com/questions/45067862/how-to-create-bot-authentication", "closed_reason": "Duplicate", "title": "How to create Bot Authentication?", "body": "<p>I've created a bot that I want to secure. I discovered the option to add Authentication to my bot's app service on Azure:</p>\n\n<p><img src=\"https://i.stack.imgur.com/vfDy8.png\" alt=\"Azure Authentication Settings Picture\"></p>\n\n<p>I set up a Microsoft Authentication feature that seems to work, but what do I need to add to my bot's code to get a user to login/ to authenticate someone. Could you provide a step-by-step solution, I am very new to this. I am using the .NET framework (c#).</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["c#", "c++", "arrays", "pointers", "dll"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1499894749, "post_id": 45067630, "comment_id": 77108839, "body": "I the function using Windows Parameters list or C language parameter list?  I would be using IntPtr in c# for pointers.  IntPtr are 4 bytes which is equivalent to a c# Int to the code may look like it is working.  I would also make the return parameter an uint not an int to be the same as as the dll."}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 8298327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32be090482d5af7292aaf5e3a3a84584?s=128&d=identicon&r=PG&f=1", "display_name": "bricx", "link": "https://stackoverflow.com/users/8298327/bricx"}, "is_accepted": true, "score": 0, "last_activity_date": 1499902219, "creation_date": 1499902219, "answer_id": 45069074, "question_id": 45067630, "link": "https://stackoverflow.com/questions/45067630/c-call-to-c-dll-function-that-requires-an-array-of-doubles-and-a-struct-as-in/45069074#45069074", "title": "C# call to C++ DLL function that requires an array of doubles and a struct as input", "body": "<p>Yes, as jdweng suggested, the solution is to use a IntPtr for dMemDouble in C#.\n as follows:</p>\n\n<pre><code>[DllImport(\"plsiqp32.dll\", EntryPoint = \"LoadMemDouble\", SetLastError = true, CharSet = CharSet.None)]\npublic static extern uint dLoadMemDouble(int handleCal, IntPtr dYvalues, ref DoubleHeader Header); \n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>IntPtr p = Marshal.AllocCoTaskMem(sizeof(double) * myYvalues.Length);\n            Marshal.Copy(myYvalues, 0, p, myYvalues.Length);\n\nloadFromMemory = dLoadMemDouble(handleCal, p, ref myHeader);\n\nMarshal.FreeHGlobal(p);\n</code></pre>\n\n<p>Now that works nicely.\nThanks!</p>\n"}], "owner": {"reputation": 317, "user_id": 8298327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32be090482d5af7292aaf5e3a3a84584?s=128&d=identicon&r=PG&f=1", "display_name": "bricx", "link": "https://stackoverflow.com/users/8298327/bricx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "accepted_answer_id": 45069074, "answer_count": 1, "score": 0, "last_activity_date": 1499902242, "creation_date": 1499894082, "last_edit_date": 1499902242, "question_id": 45067630, "link": "https://stackoverflow.com/questions/45067630/c-call-to-c-dll-function-that-requires-an-array-of-doubles-and-a-struct-as-in", "title": "C# call to C++ DLL function that requires an array of doubles and a struct as input", "body": "<p>I need to call the following function from an old C++ DLL in my C# code. I can't edit the C++ code and this is all the info I have about that function:</p>\n\n<blockquote>\n  <p>LoadMemDouble:        </p>\n  \n  <hr>\n  \n  <p>Function:  uint PASCAL LoadMemDoubleAB(void far* lpobj,double far* lpy,TARHDR far* lptar)</p>\n  \n  <p>Purpose:   Load data into DLL from a passed structure of 64-bit \n    floats. IMPORTANT - any passed arrays, data structures, etc. must be \n    global as the DLL just maintains a pointer back to the array / structure.</p>\n  \n  <p>Arguments:   </p>\n  \n  <ul>\n  <li><p>lpobj = Far pointer of prediction data structure;</p></li>\n  <li><p>lpy = Pointer of double type y value;       </p></li>\n  <li><p>lptar = Pointer of data header. Note TARHDR was defined as:</p></li>\n  </ul>\n</blockquote>\n\n<pre><code>typedef struct  {  dword   tarnpts;        //total number of data\n                   double  tarffp;         //x value of first y data    \n                   double  tarflp;         //x value of last y data\n                   char    tarxtype;       //data type of x value \n                   char    tarytype;       //data type of y value \n                   uint    tarx;           //1=has x value 0=only y trace \n}TARHDR;\n</code></pre>\n\n<blockquote>\n  <p>!!tarx field must be set to zero;</p>\n  \n  <p>Returns:   0 or error code.</p>\n</blockquote>\n\n<p>I imported the DLL in C# as follows:</p>\n\n<pre><code>[DllImport(\"plsiqp32.dll\", EntryPoint = \"LoadMemDouble\", SetLastError = true, CharSet = CharSet.None)]\npublic static extern int dLoadMemDouble(int handleCal, ref double dYvalues, ref DoubleHeader Header);\n</code></pre>\n\n<p>I built my structure in C# as follows:</p>\n\n<pre><code>public struct DoubleHeader\n        {\n            public int npts { get; set; }    \n            public double FFP { get; set; }  \n            public double FLP { get; set; }  \n            public byte Xtype { get; set; }   \n            public byte YType { get; set; }   \n            public int Xtra { get; set; }    //this must be 0.\n        }\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code> public DoubleHeader myHeader;\n public double[] myYvalues;\n\n myHeader = new DoubleHeader();\n\n myHeader.npts = npts;\n myHeader.FFP = FFP;\n myHeader.FLP = FLP;\n myHeader.XType= Xtype;\n myHeader.YType = Ytype;\n myHeader.Xtra = 0;\n\n myYvalues = dYvalues;\n\n int loadFromMemory;\n\n loadFromMemory = dLoadMemDouble(handleCal, ref myYvalues[0], ref myHeader);\n</code></pre>\n\n<p>I have no error message of any kind but it doesn't seems that this is working properly. I am suspecting there is an error in the way I am passing the double array and/or the structure. I am quite new to C# as well and I am stuck on this problem.</p>\n\n<p>Only info I could find about this is in German here: <a href=\"http://microsoft.public.de.german.entwickler.dotnet.csharp.narkive.com/g9rTQP1U/c-dll-in-c-nutzen#post9\" rel=\"nofollow noreferrer\">http://microsoft.public.de.german.entwickler.dotnet.csharp.narkive.com/g9rTQP1U/c-dll-in-c-nutzen#post9</a>\nand its dated from 14 years ago... that's a really old DLL.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["c#", "linq", "entity-framework-core"], "comments": [{"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1499894217, "post_id": 45067597, "comment_id": 77108585, "body": "<code>.AsEnumerabe()</code> do you mean AsEnumerable()`"}, {"owner": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "edited": false, "score": 0, "creation_date": 1499894319, "post_id": 45067597, "comment_id": 77108642, "body": "please see EDIT"}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 1, "creation_date": 1499894512, "post_id": 45067597, "comment_id": 77108717, "body": "What are you even trying to do that makes no sense, do you want to check if the list contains something or do you want the full list"}, {"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1499895069, "post_id": 45067597, "comment_id": 77108999, "body": "Implementing <code>IEquatable</code> in mutable reference types but not overriding <code>Object.Equals</code> is like <a href=\"https://stackoverflow.com/questions/3191969/\">playing Russian Roulette with 5 chambers loaded</a>."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499901800, "post_id": 45067597, "comment_id": 77111245, "body": "@PaoloGo - Could you please add enough code to your question so that I can copy, paste, and run you code that would be excellent? I think I have the answer for you but I want to test it first. I&#39;m looking for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499910984, "post_id": 45067597, "comment_id": 77113437, "body": "@Enigmativity please see edited post."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499912822, "post_id": 45067597, "comment_id": 77113852, "body": "@PaoloGo - I can&#39;t run a SQLite connection. I need to run your code. Can you remove the SQLite code and make it runable - just <code>new</code> up some of the variables and then show the issue you&#39;re having?"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1499913335, "post_id": 45067597, "comment_id": 77113966, "body": "@PaoloGo - Forget that. Johnny 5 has the correct answer."}], "answers": [{"comments": [{"owner": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "edited": false, "score": 0, "creation_date": 1499894869, "post_id": 45067748, "comment_id": 77108898, "body": "I updated my question to show that I&#39;m trying to make a method AddIfNotExists. a"}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "reply_to_user": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "edited": false, "score": 0, "creation_date": 1499896570, "post_id": 45067748, "comment_id": 77109588, "body": "@PaoloGo did this work? If so can you mark as correct"}], "tags": [], "owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "is_accepted": false, "score": 2, "last_activity_date": 1499895411, "last_edit_date": 1499895411, "creation_date": 1499894647, "answer_id": 45067748, "question_id": 45067597, "link": "https://stackoverflow.com/questions/45067597/ef-core-include-contains-null-reference-exception/45067748#45067748", "title": "ef core .Include().Contains() null reference exception", "body": "<p>The difference is one is an entityframe work call the other is linq to objects\nEntity Framework Does not understand contains for a CLR Object</p>\n\n<pre><code>public void AddIfNotExists(Model1 model1)\n{\n\n    //No Need for the include this is executed in sql,  assuming the model 2 \n    //property has already been included in your model1 this should work fine\n    if(false == _context.Model1.Any(x =&gt; x.Name1 == model1.Name1 \n                        &amp;&amp; x.Model2.Name2 == model1.Model2.Name2))\n    {\n        _context.Model1.Add(model1);\n    }\n}\n</code></pre>\n\n<p>I made this based off of your logic, but chances are you really just want to check if model1.id is the the model1 set.  But I have no Idea what your architecture is doing so this is what you probably want</p>\n"}], "owner": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1499910844, "creation_date": 1499893936, "last_edit_date": 1499910844, "question_id": 45067597, "link": "https://stackoverflow.com/questions/45067597/ef-core-include-contains-null-reference-exception", "title": "ef core .Include().Contains() null reference exception", "body": "<p>I have my models setup like this...</p>\n\n<pre><code>public class Model1 : IEquatable&lt;Model1&gt;\n{\n    public int Model1Id { get; set; }\n    public string Name1 { get; set; }\n    public Model2 Model2 { get; set; }\n    public int Model2Id { get; set; }\n\n    public bool Equals(Model1 other)\n    {\n        return this.Model2.Equals(other.Model2)\n            &amp;&amp; this.Name1 == other.Name1;\n    }\n}\n\npublic class Model2 : IEquatable&lt;Model2&gt;\n{\n    public int Model2Id { get; set; }\n    public string Name2 { get; set; }\n\n    public bool Equals(Model2 other)\n    {\n        return this.Name2 == other.Name2;\n    }\n}\n\npublic class ModelContext : DbContext\n{\n    public DbSet&lt;Model1&gt; Model1 { get; set; }\n    public DbSet&lt;Model2&gt; Model2 { get; set; }\n    public ModelContext(DbContextOptions&lt;ModelContext&gt; options) : base(options) { }\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity&lt;Model1&gt;(b =&gt;\n        {\n            b.HasOne(m1 =&gt; m1.Model2).WithMany().HasForeignKey(m1 =&gt; m1.Model2Id);\n        });\n    }\n}\n</code></pre>\n\n<p>then I get a null reference exception when I do this...</p>\n\n<pre><code>static void Main(string[] args)\n{\n    var myModel1 = new Model1\n    {\n        Name1 = \"myName1\",\n        Model2 = new Model2\n        {\n            Name2 = \"myName2\"\n        }\n    };\n    var connection = new SqliteConnection(\"DataSource=:memory:\");\n    connection.Open();\n    try\n    {\n        var options = new DbContextOptionsBuilder&lt;ModelContext&gt;()\n            .UseSqlite(connection)\n            .Options;\n\n        //create database\n        using(var ctx = new ModelContext(options))\n        {\n            ctx.Database.EnsureCreated();\n        }\n\n        //add model objects\n        using (var ctx = new ModelContext(options))\n        {\n            ctx.Database.EnsureCreated();\n            ctx.Model1.Add(myModel1);\n            ctx.SaveChanges();\n        }\n\n        //check if exists\n        using(var ctx = new ModelContext(options))\n        {\n            //exception here\n            bool isExists = ctx.Model1.Include(m1 =&gt; m1.Model2).Contains(myModel1); \n            Console.WriteLine(isExists);\n        }\n    }\n    finally\n    {\n        connection.Close();\n    }\n\n    Console.ReadKey();\n}\n</code></pre>\n\n<p>I'm expeting the <code>Model2</code> instance of my <code>m1</code> to be populated when I call the <code>Include</code> but it is still <code>null</code>.</p>\n\n<p>but If I add AsEnumerable() to my query like..</p>\n\n<pre><code>ctx.Model1.Include(m1 =&gt; m1.Model2).AsEnumerable().Contains(model1);\n</code></pre>\n\n<p>then everything works fine.</p>\n\n<p>EDIT:</p>\n\n<p>my question is... why do I need to call AsEnumerable()? I was expecting it to work without calling AsEnumerable()..</p>\n"}, {"tags": ["c#", "selenium-webdriver", "visual-studio-2015", "mstest", "specflow"], "comments": [{"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 1, "creation_date": 1499901060, "post_id": 45067512, "comment_id": 77111040, "body": "See: <a href=\"https://meta.stackoverflow.com/questions/253069/whats-the-appropriate-new-current-close-reason-for-how-do-i-do-x\">How do I do X?</a> The expectation on SO is that the user asking a question not only does research to answer their own question but also shares that research, code attempts, and results. This demonstrates that you\u2019ve taken the time to try to help yourself, it saves us from reiterating obvious answers, and most of all it helps you get a more specific and relevant answer! See also: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 551, "user_id": 844645, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95e55b1155026924f3f1263595e53ef8?s=128&d=identicon&r=PG", "display_name": "TangibleDream", "link": "https://stackoverflow.com/users/844645/tangibledream"}, "edited": false, "score": 0, "creation_date": 1499956121, "post_id": 45067512, "comment_id": 77139689, "body": "I amended my question to cover your requests.  If you need anymore information, I&#39;d be happy to supply it."}], "answers": [{"tags": [], "owner": {"reputation": 551, "user_id": 844645, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95e55b1155026924f3f1263595e53ef8?s=128&d=identicon&r=PG", "display_name": "TangibleDream", "link": "https://stackoverflow.com/users/844645/tangibledream"}, "is_accepted": true, "score": 2, "last_activity_date": 1499972650, "last_edit_date": 1499972650, "creation_date": 1499966601, "answer_id": 45087295, "question_id": 45067512, "link": "https://stackoverflow.com/questions/45067512/what-is-the-best-way-to-create-an-html-test-report-using-specflow/45087295#45087295", "title": "What is the best way to create an html test report using SpecFlow?", "body": "<p>So for those who employ SpecFlow and Selenium to test their web based application and want the report formatted in an HTML format</p>\n\n<ol>\n<li>Navigate to ..\\Projects[project name]..\\bin\\Debug</li>\n<li><p>run MSTEST to generate a .trx file</p>\n\n<p><code>mstest /testcontainer:[projectname].dll /ResultsFile:TestResult.trx</code></p></li>\n<li><p>lastly from ..[project name]\\packages\\SpecFlow.[version number]\\tools,  run the SpecFlow command line tool to grab the .trx file and generate the report.</p>\n\n<p><code>specflow.exe mstestexecutionreport \"C:\\Users\\blah\\Documents\\Visual Studio 2015\\Projects\\MyProject\\MyProject\\MyProject.csproj\" /out:MyResult.html /testresult:TestResult.trx</code></p></li>\n<li><p>View file and celebrate</p></li>\n</ol>\n"}], "owner": {"reputation": 551, "user_id": 844645, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95e55b1155026924f3f1263595e53ef8?s=128&d=identicon&r=PG", "display_name": "TangibleDream", "link": "https://stackoverflow.com/users/844645/tangibledream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4194, "favorite_count": 1, "accepted_answer_id": 45087295, "answer_count": 1, "score": -2, "last_activity_date": 1499972650, "creation_date": 1499893561, "last_edit_date": 1499956187, "question_id": 45067512, "link": "https://stackoverflow.com/questions/45067512/what-is-the-best-way-to-create-an-html-test-report-using-specflow", "title": "What is the best way to create an html test report using SpecFlow?", "body": "<p>I am running tdd reports in Visual Studio 2015. </p>\n\n<p>From what I have read I should be able to generate an html report with the specflow command line tool</p>\n\n<pre><code>specflow.exe mstestexecutionreport \"Visual Studio 2015\\Projects\\blahSpec.csproj\" /out:MyResult.html\n</code></pre>\n\n<p>This in turn complains that it cannot find a .trx type file.</p>\n\n<pre><code>NConsoler.NConsolerException: Could not find file 'C:\\Visual Studio \n2015\\Projects\\blahSpec\\packages\\SpecFlow.2.2.0\\tools\\TestResult.trx'. \n</code></pre>\n\n<p>This led me to believe that I need to set MsTest to generate a .trx file when I run the tests.  The documentation I read was not specific to what I wanted to test (<a href=\"https://social.msdn.microsoft.com/Forums/azure/en-US/7577a33c-84bc-4144-b45f-76c8e03b0a8e/create-a-trx-file-whenever-any-tests-are-executed-from-test-explorer?forum=vsunittest\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/azure/en-US/7577a33c-84bc-4144-b45f-76c8e03b0a8e/create-a-trx-file-whenever-any-tests-are-executed-from-test-explorer?forum=vsunittest</a>) \nIt spoke of a settings file that I could not find, and I couldn't find any info on how to create one.</p>\n\n<p>This foray in to the tall weeds made me feel that I was going about it the wrong way, and should get help here.</p>\n\n<p>Meanwhile in Ruby...</p>\n\n<p>SpecFlow's ruby equivalent: Cucumber, has a format flag that allows users to generate output into a nice HTML format that can be presented to higher ups.</p>\n\n<pre><code>cucumber --format html -o blah.html\n</code></pre>\n\n<p>What is the best way to do this in VS2015?  Am I close or am I going about it the wrong way?</p>\n\n<p>I am using\nSpecflow and Selenium Webdriver</p>\n"}, {"tags": ["c#", "reflection", "lambda", "expression"], "comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 2, "creation_date": 1499894770, "post_id": 45067471, "comment_id": 77108854, "body": "Is the property type actually <code>object</code>? Also, if you have a <code>PropertyInfo</code> object already, why not just call <code>PropertyInfo.GetValue()</code> instead of trying to invoke the getter method? Also, what&#39;s the point of using reflection here? Without a good <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> it&#39;s hard to see what you&#39;re really trying to achieve and what specific difficulty you&#39;re having."}, {"owner": {"reputation": 636, "user_id": 2878467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c2ccf0dc3fcdef30dc48360b5fe17c?s=128&d=identicon&r=PG", "display_name": "Eug&#232;ne", "link": "https://stackoverflow.com/users/2878467/eug%c3%a8ne"}, "edited": false, "score": 0, "creation_date": 1499894902, "post_id": 45067471, "comment_id": 77108914, "body": "I share Peter&#39;s concerns, but hope this similar question and answer here: <a href=\"https://stackoverflow.com/questions/41244/dynamic-linq-orderby-on-ienumerablet\" title=\"dynamic linq orderby on ienumerablet\">stackoverflow.com/questions/41244/&hellip;</a> can help you."}], "answers": [{"tags": [], "owner": {"reputation": 2633, "user_id": 5359302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4edae8a9b44323b8b6908d4b0d410730?s=128&d=identicon&r=PG&f=1", "display_name": "George Alexandria", "link": "https://stackoverflow.com/users/5359302/george-alexandria"}, "is_accepted": false, "score": 5, "last_activity_date": 1499895317, "last_edit_date": 1499895317, "creation_date": 1499894991, "answer_id": 45067833, "question_id": 45067471, "link": "https://stackoverflow.com/questions/45067471/create-expressionfunct-object-from-a-given-type/45067833#45067833", "title": "Create Expression&lt;Func&lt;T, object&gt;&gt; from a given Type", "body": "<p>Just try something looks like this:</p>\n\n<pre><code>    public static Expression&lt;Func&lt;T, P&gt;&gt; GetGetter&lt;T, P&gt;(string propName)\n    {\n        var parameter = Expression.Parameter(typeof(T));\n        var property = Expression.Property(parameter, propName);\n        return Expression.Lambda&lt;Func&lt;T, P&gt;&gt;(property, parameter);\n    }\n\n    public static Expression&lt;Func&lt;T, P&gt;&gt; GetGetter&lt;T, P&gt;(PropertyInfo propInfo)\n    {\n        var parameter = Expression.Parameter(typeof(T));\n        var property = Expression.Property(parameter, propInfo);\n        return Expression.Lambda&lt;Func&lt;T, P&gt;&gt;(property, parameter);\n    }\n</code></pre>\n\n<p>It's example of usages:</p>\n\n<pre><code>    private class TestCalss\n    {\n        public int Id { get; set; }\n    }\n\n    private static void Main(string[] args)\n    {\n        var getter = GetGetter&lt;TestCalss, int&gt;(typeof(TestCalss).GetProperty(\"Id\")).Compile();\n        Console.WriteLine(getter(new TestCalss { Id = 16 }));\n    }\n</code></pre>\n"}], "owner": {"reputation": 1099, "user_id": 3832895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Mtp6d.jpg?s=128&g=1", "display_name": "thisextendsthat", "link": "https://stackoverflow.com/users/3832895/thisextendsthat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1208, "favorite_count": 2, "answer_count": 1, "score": -1, "last_activity_date": 1499895317, "creation_date": 1499893394, "question_id": 45067471, "link": "https://stackoverflow.com/questions/45067471/create-expressionfunct-object-from-a-given-type", "title": "Create Expression&lt;Func&lt;T, object&gt;&gt; from a given Type", "body": "<p>I am looking to use CsvHelper dynamically by building up Expressions in code which represent property member access for a given type.</p>\n\n<p>The method I am trying to pass these expressions to has the following signature:</p>\n\n<pre><code>    public virtual CsvPropertyMap&lt;TClass, TProperty&gt; Map&lt;TProperty&gt;( Expression&lt;Func&lt;TClass, TProperty&gt;&gt; expression )\n    {\n        //\n    }\n</code></pre>\n\n<p>So you would normally call it, for any given type you want to map, like this (for a type with a property called 'stringProperty'):</p>\n\n<pre><code>mapper.Map(x =&gt; x.StringProperty);\n</code></pre>\n\n<p>Passing in a lambda which is converted internally into an <code>Expression&lt;Func&lt;T, object&gt;&gt;</code></p>\n\n<p>I have tried to create this expression in code, using Expressions. At compile time it all works fine (in that it returns an <code>Expression&lt;Func&lt;TModel, object&gt;&gt;</code>), but at runtime I get an exception 'not a member access'. Here is the code which takes a PropertyInfo object representing the property I want to map:</p>\n\n<pre><code>    private Expression&lt;Func&lt;TModel, object&gt;&gt; CreateGetterExpression( PropertyInfo propertyInfo )\n    {\n        var getter = propertyInfo.GetGetMethod();\n\n        Expression&lt;Func&lt;TModel, object&gt;&gt; expression = m =&gt; getter.Invoke( m, new object[] { } );\n        return expression;\n    }\n</code></pre>\n\n<p>Basically, how do I build that Expression up properly in code?</p>\n"}, {"tags": ["c#", "skype-for-business", "ivr", "ucma"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "edited": false, "score": 0, "creation_date": 1499972426, "post_id": 45088603, "comment_id": 77150434, "body": "You are right, in the process of trying to figure out how to route calls from my Skype for Business server to my UCMA application I confused myself. So thank you for clearing that up. To answering my main question, Yes I mean calling my UCMA application On-Prem. I have already set up the CsTrustedApplicationEndpoint and CsTrustedApplicationPool. I&#39;m confused on where I go from to here to be able to pick up my cellphone, call a phone number, and talk to my UCMA application."}, {"owner": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "edited": false, "score": 0, "creation_date": 1499972838, "post_id": 45088603, "comment_id": 77150679, "body": "I think you&#39;re second bold point answer is what I&#39;m thinking. Looking into PSTN calling."}, {"owner": {"reputation": 12010, "user_id": 23235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281820b28d03f98e85bb3d901ae3f39?s=128&d=identicon&r=PG", "display_name": "Shane Powell", "link": "https://stackoverflow.com/users/23235/shane-powell"}, "reply_to_user": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "edited": false, "score": 0, "creation_date": 1499973055, "post_id": 45088603, "comment_id": 77150790, "body": "I would be nice if you upvoted and accepted by answer :)"}, {"owner": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "edited": false, "score": 0, "creation_date": 1499973269, "post_id": 45088603, "comment_id": 77150915, "body": "Won&#39;t let me upvote, not enough rep but I accepted your answer. Thank you! Another quick question googling PTSN calling it says &quot;PSTN calling provides the people in your business with a primary phone number, and lets them make and receive phone calls outside of your organization.&quot; Is this still the route to go when the plan is for people who are calling in to this number to not have assigned numbers? The idea is they&#39;re total strangers."}, {"owner": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "edited": false, "score": 0, "creation_date": 1500044699, "post_id": 45088603, "comment_id": 77183601, "body": "Do you recommend I use Enterprise Voice or Conferencing? The goal is to be able to call the phone number anonymously and get to our UCMA application without being a SkB user. @shane-powell"}, {"owner": {"reputation": 12010, "user_id": 23235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281820b28d03f98e85bb3d901ae3f39?s=128&d=identicon&r=PG", "display_name": "Shane Powell", "link": "https://stackoverflow.com/users/23235/shane-powell"}, "reply_to_user": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "edited": false, "score": 0, "creation_date": 1500056153, "post_id": 45088603, "comment_id": 77190094, "body": "If you want external phones calls coming into SfB then you best to go with a pstn setup."}, {"owner": {"reputation": 12010, "user_id": 23235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281820b28d03f98e85bb3d901ae3f39?s=128&d=identicon&r=PG", "display_name": "Shane Powell", "link": "https://stackoverflow.com/users/23235/shane-powell"}, "reply_to_user": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "edited": false, "score": 0, "creation_date": 1500056687, "post_id": 45088603, "comment_id": 77190354, "body": "Enterprise voice / conferencing is a end user licensing (CAL) question that only applies to SfB clients (basically UserEndpionts only).  UCMA trusted application endpoints don&#39;t need licensing.  You really should be talking to someone at Microsoft to confirm what you are required to license for your setup.  I <i>think</i> it&#39;s nothing if you have no CAL&#39;s and your server setup is only standard edition setup."}], "tags": [], "owner": {"reputation": 12010, "user_id": 23235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281820b28d03f98e85bb3d901ae3f39?s=128&d=identicon&r=PG", "display_name": "Shane Powell", "link": "https://stackoverflow.com/users/23235/shane-powell"}, "is_accepted": true, "score": 0, "last_activity_date": 1499971067, "creation_date": 1499971067, "answer_id": 45088603, "question_id": 45067433, "link": "https://stackoverflow.com/questions/45067433/how-to-configure-a-skype-for-business-server-to-receive-phone-calls-and-notify-t/45088603#45088603", "title": "How to configure a Skype For Business Server to receive phone calls and notify the UCMA application", "body": "<p>I think you are getting confused here.</p>\n\n<p>First off you need to understand some things:</p>\n\n<ol>\n<li>UCMA only works in on-prem SfB installations.</li>\n<li>UCMA does not work in Office 365 (SfB online).</li>\n<li>Skype for Business Application SDK (Trusted Application API) only works in Office 365 (SfB online).</li>\n<li>Skype for Business Application SDK (Trusted Application API) does not work with On-Prem SfB.</li>\n<li>Skype for Business Application SDK is Microsoft's replacement for UCMA when developing for Office 365.</li>\n<li>Skype for Business Application SDK is both more than and also doesn't have all the features of UCMA currently.  So you can do a lot more with UCMA than with Skype for Business Application SDK.</li>\n</ol>\n\n<p>OK now to your question.  </p>\n\n<p><strong>Do you mean generally calling your UCMA application On-Prem?</strong></p>\n\n<p>In this case you need to setup a On-Prem Trusted Application Endpoint using <a href=\"https://technet.microsoft.com/en-us/library/gg398509.aspx\" rel=\"nofollow noreferrer\">Create-CsTrustedApplicationEndpoint</a>.  You can read about Application Endpoints <a href=\"https://msdn.microsoft.com/en-us/library/office/hh347385(v=office.14).aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><strong>Do you mean PSTN calling your UCMA application On-Prem?</strong></p>\n\n<p>In this case you setup a Application Endpoint above and supply a valid DDI in the LineURI parameter.  This is assuming you have PSTN access setup with valid incoming DDI's.\ne.g.\nCreate-CsTrustedApplicationEndpoint ... -LineUri \"tel:+14255551212\"\nor\nSet-CsTrustedApplicationEndpoint ... -LineUri \"tel:+14255551212\"</p>\n\n<p><strong>Do you mean calling your UCMA endpoint from Office 365?</strong></p>\n\n<p>This requires a federation connection setup between your Office 365 account and your On-Prem account.  Read <a href=\"http://blog.greenl.ee/2015/01/15/ucma-office-365/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://blog.greenl.ee/2016/11/12/ucma-office-365-updates/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://technet.microsoft.com/en-us/library/jj205126.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p><strong>Do you mean only running in Office 365?</strong></p>\n\n<p>You don't want a UCMA application then, you want to develop a Skype for Business Application SDK application.  Although you may find it very limited currently to specific scenarios that Microsoft have allowed as it's being developed.</p>\n"}], "owner": {"reputation": 3, "user_id": 8298261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/594ed22fcc1493a25259e94d941e9205?s=128&d=identicon&r=PG&f=1", "display_name": "user8298261", "link": "https://stackoverflow.com/users/8298261/user8298261"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 45088603, "answer_count": 1, "score": 0, "last_activity_date": 1500049122, "creation_date": 1499893235, "last_edit_date": 1500049122, "question_id": 45067433, "link": "https://stackoverflow.com/questions/45067433/how-to-configure-a-skype-for-business-server-to-receive-phone-calls-and-notify-t", "title": "How to configure a Skype For Business Server to receive phone calls and notify the UCMA application", "body": "<p>I have pretty much finished my UCMA application which is designed to be a simple IVR. An <strong>unknown</strong> user calls a phone number remotely, from their cellphone, the IVR picks up the call, listens and responds to the user's voice and dmtf tones until they hang up. </p>\n\n<p>Up to this point I have been testing the service as I go using xLite on my local machine. It works as intended and now I am working to deploy the application on a server so I can call in using my cell phone to test the application....</p>\n\n<p>What I have:</p>\n\n<p><em>I have successfully created a Skype For Business Server 2015 along with a trusted application pool running on a standalone server. The mediation server is collocated on the frontendpool(the server running skype for bussiness). And I have a PTSN gateway on another server. I have a PBX and PTSN license along with a PTSN phone number.</em></p>\n\n<p>To Clarify</p>\n\n<ul>\n<li>I have a dedicated trusted application pool(standalone), and trusted application</li>\n<li>My UCMA application is manually provisioned using application endpoints.</li>\n<li>The servers are all Windows 2012 R2 AWS instances being connected to via remote desktop. I have full control over all of them.</li>\n<li>The Skype For Business Server is on-prem.</li>\n<li>I am using UCMA 5.0 </li>\n<li>The person dialing their cellphone to reach the UCMA application won't be a SkB user, essentialy a randomly stranger. </li>\n</ul>\n\n<p>I feel like I have all the necessary components set up but I'm not sure how to connect everything together so that I can pickup my cellphone and dial into my UCMA application.</p>\n\n<p>Should I be using conferencing or Enterprise Voice? \nHow do I go about setting up the phone number so that when its called it goes to the Skype for business server which then sends it to my ucma application?</p>\n"}, {"tags": ["c#", "filestream"], "comments": [{"owner": {"reputation": 143, "user_id": 3174890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88bd4fee2cafebf18c629218ff4c12a7?s=128&d=identicon&r=PG&f=1", "display_name": "Jaky71", "link": "https://stackoverflow.com/users/3174890/jaky71"}, "edited": false, "score": 0, "creation_date": 1499893806, "post_id": 45067284, "comment_id": 77108381, "body": "Did you checked permissions? If not, you should give permissions for that directory."}, {"owner": {"reputation": 1, "user_id": 8298320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d00edde33c141a133ad419f5cd8de9c3?s=128&d=identicon&r=PG&f=1", "display_name": "nexusquasar", "link": "https://stackoverflow.com/users/8298320/nexusquasar"}, "reply_to_user": {"reputation": 143, "user_id": 3174890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88bd4fee2cafebf18c629218ff4c12a7?s=128&d=identicon&r=PG&f=1", "display_name": "Jaky71", "link": "https://stackoverflow.com/users/3174890/jaky71"}, "edited": false, "score": 0, "creation_date": 1499894133, "post_id": 45067284, "comment_id": 77108532, "body": "How? In Web.Config?"}, {"owner": {"reputation": 143, "user_id": 3174890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88bd4fee2cafebf18c629218ff4c12a7?s=128&d=identicon&r=PG&f=1", "display_name": "Jaky71", "link": "https://stackoverflow.com/users/3174890/jaky71"}, "edited": false, "score": 0, "creation_date": 1499894602, "post_id": 45067284, "comment_id": 77108767, "body": "If you are working on web applicantion, you should give permission to IIS_IUSRS (for IIS) for file CRUD operations."}, {"owner": {"reputation": 143, "user_id": 3174890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88bd4fee2cafebf18c629218ff4c12a7?s=128&d=identicon&r=PG&f=1", "display_name": "Jaky71", "link": "https://stackoverflow.com/users/3174890/jaky71"}, "edited": false, "score": 0, "creation_date": 1499894737, "post_id": 45067284, "comment_id": 77108832, "body": "You can do it with using windows file explorer. Right click to folder -&gt; Properties -&gt; Security -&gt; Edit -&gt; Add -&gt; Advance -&gt; Find -&gt; double click IIS_IUSRS and continue."}, {"owner": {"reputation": 1, "user_id": 8298320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d00edde33c141a133ad419f5cd8de9c3?s=128&d=identicon&r=PG&f=1", "display_name": "nexusquasar", "link": "https://stackoverflow.com/users/8298320/nexusquasar"}, "reply_to_user": {"reputation": 143, "user_id": 3174890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88bd4fee2cafebf18c629218ff4c12a7?s=128&d=identicon&r=PG&f=1", "display_name": "Jaky71", "link": "https://stackoverflow.com/users/3174890/jaky71"}, "edited": false, "score": 0, "creation_date": 1499895319, "post_id": 45067284, "comment_id": 77109116, "body": "Nothing happened after adding IIS_IURS. Just working in IIS Express."}], "owner": {"reputation": 1, "user_id": 8298320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d00edde33c141a133ad419f5cd8de9c3?s=128&d=identicon&r=PG&f=1", "display_name": "nexusquasar", "link": "https://stackoverflow.com/users/8298320/nexusquasar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499892586, "creation_date": 1499892586, "question_id": 45067284, "link": "https://stackoverflow.com/questions/45067284/add-image-using-filestream-and-fileupload", "title": "Add Image using FileStream and FileUpload", "body": "<p>I am trying to upload an image file to Server.MapPath(\"~/Pictures\").  I believe The FileUpload has worked, I believe.  The FileStream has not put the image selected to \"Pictures/\".</p>\n\n<pre><code>        if (FileUpload1.HasFile)\n        {\n            string imagename = System.IO.Path.GetFileName(FileUpload1.FileName);\n            string ext = System.IO.Path.GetExtension(FileUpload1.FileName);\n            string imagefile = Server.MapPath(\"Pictures/\" + imagename + ext);\n            byte[] Image = null;\n            if (ext == \".jpg\" | ext == \".gif\" | ext == \".png\" | ext == \".bmp\")\n            {\n                Image = new byte[FileUpload1.PostedFile.ContentLength];\n                HttpPostedFile UploadedImage = FileUpload1.PostedFile;\n                UploadedImage.InputStream.Read(Image, 0, (int)FileUpload1.PostedFile.ContentLength);\n                int numBytesToRead = Image.Length;\n                try\n                {\n                    using (FileStream fsNew = new FileStream(imagefile, FileMode.Create, FileAccess.Write))\n                    {\n                        fsNew.Write(Image, 0, numBytesToRead);\n                    }\n                }\n                catch (FileNotFoundException ioEx)\n                {\n                    Label100.Text = \"Filestream Add Pictures: \" + ioEx.ToString();\n                }\n            }\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "entity-framework", "linq", "lambda"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1499892645, "post_id": 45067260, "comment_id": 77107802, "body": "You might have to @using Your.Property.Types.Namespace in order for it to work?"}, {"owner": {"reputation": 9815, "user_id": 84395, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a33e112a880f4dcb3644113d26e00f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cloud SME", "link": "https://stackoverflow.com/users/84395/cloud-sme"}, "edited": false, "score": 0, "creation_date": 1499894394, "post_id": 45067260, "comment_id": 77108674, "body": "To add to @SimonRowe&#39;s answer, this would probably work, but doubt it is what you want <code>@Html.EditorFor(model =&gt; model.Policies.First().Property, new { htmlAttributes = new { @class = &quot;form-control&quot; } })</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "edited": false, "score": 0, "creation_date": 1499961210, "post_id": 45067379, "comment_id": 77143659, "body": "Thanks @SimonRowe. In the blog post Rachel Appel has a Customer entity and a States dictionary entity with the ViewModel. Her code lets her access all the properties from Customer as well as the States dictionary via syntax such as <code>@Html.EditorFor(model =&gt; model.Customer.FirstName)</code> and <code>@Html.ValidationMessageFor(model =&gt; model.Customer.State)</code>. I had the  idea that I could adapt what she did to multiple full entities. I did try editing the ViewModel to use single instances of the full entities, but I could only access each entity and not its properties (same as before the edits)."}, {"owner": {"reputation": 11, "user_id": 7272068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b441b124f519ad66d6887af0af74122?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Rowe", "link": "https://stackoverflow.com/users/7272068/simon-rowe"}, "reply_to_user": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "edited": false, "score": 0, "creation_date": 1500051984, "post_id": 45067379, "comment_id": 77187888, "body": "It might help if we knew what you were trying to achieve. Yes her model has those two items but they are all singular to the view model for each view model there is one customer and one state.  With your example there are many policies and many trusts. This is fine for viewing data a standard Index view will show you ow to do a displayfor for each of those fields but you are suggesting you want to have an editor for each field of each entity in the collection and razor can&#39;t understand how to interpret that.  Perhaps a mock up of what you want to achieve would help us help you."}, {"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "edited": false, "score": 0, "creation_date": 1500059429, "post_id": 45067379, "comment_id": 77191673, "body": "I was hoping that I could make a ViewModel with several entities. And access the properties in the entities within the associated View by using a <code>model.entity.property</code> syntax as I need to mix multiple fields from multiple entities within Create and Edit Views. Now this syntax may not be possible using multiple multi-property entities, and if it&#39;s not, I&#39;d be interested in hearing what the acceptable options are. In a perfect world I would probably  normalize or even re-architect the db, but that is not an option."}], "tags": [], "owner": {"reputation": 11, "user_id": 7272068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b441b124f519ad66d6887af0af74122?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Rowe", "link": "https://stackoverflow.com/users/7272068/simon-rowe"}, "is_accepted": false, "score": 0, "last_activity_date": 1499893019, "creation_date": 1499893019, "answer_id": 45067379, "question_id": 45067260, "link": "https://stackoverflow.com/questions/45067260/access-entity-framework-viewmodel-properties-in-view-using-lambda-expressions/45067379#45067379", "title": "Access Entity Framework ViewModel properties in View using Lambda Expressions", "body": "<p>I only had a quick scan of the blog but the most obvious difference is the example in the blog has a single instance of Customer in the ViewModel but your example above includes two ICollections.</p>\n\n<p>As a consequence Razor is trying to find an editor not for one Policy.Property but for a whole collection of them, and by the looks of things failing.  </p>\n\n<p>Try the same logic but with a single instance of Policy and Trust in your ViewModel and you should get a rendered view.</p>\n\n<p>If you need to have the ability to edit collections you will need to do some googling.  You should find examples on SO to help you out.</p>\n"}, {"comments": [{"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "edited": false, "score": 0, "creation_date": 1499960059, "post_id": 45068654, "comment_id": 77142845, "body": "Thanks @StevePy. This makes a lot of sense. In my case, however, I need to use all the columns in the Policies entity, of which there are many, and four from Companies.  My knowledge of creating manual POCOs in an EF database first app is limited, but it seems on first glance to be a lot of overhead. I was seduced by the blog I linked to as I thought this may be a good way to easily access a lot of properties within the View from the auto-generated entities. In any case, I will now study up on creating POCOs and see if this is a way forward for me."}, {"owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "edited": false, "score": 0, "creation_date": 1500475721, "post_id": 45068654, "comment_id": 77355404, "body": "Thanks again for the considered and thoughtful response @StevePy. Lightweight POCOs were definitely the way to go. The code is much more maintainable and all functional logic is in the controller (so good separation of concerns). This was a great learning journey on MVC and EF for me and a good reminder that reliance on the ORM (or any framework for that matter) is not a replacement for good architecture within the application. I very much appreciate your guidance towards the better path."}], "tags": [], "owner": {"reputation": 14993, "user_id": 423497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c411e966f549fa07b3d7fb142ba733?s=128&d=identicon&r=PG", "display_name": "Steve Py", "link": "https://stackoverflow.com/users/423497/steve-py"}, "is_accepted": true, "score": 1, "last_activity_date": 1499899264, "creation_date": 1499899264, "answer_id": 45068654, "question_id": 45067260, "link": "https://stackoverflow.com/questions/45067260/access-entity-framework-viewmodel-properties-in-view-using-lambda-expressions/45068654#45068654", "title": "Access Entity Framework ViewModel properties in View using Lambda Expressions", "body": "<p>I'd avoid embedding EF entities in your ViewModels. As per points:</p>\n\n<ul>\n<li>Put only data that you\u2019ll render in the ViewModel.</li>\n<li>The view should direct the properties of the ViewModel, this way it fits better for rendering and maintenance. </li>\n</ul>\n\n<p>Relational data is fine, but unless you need \"everything\" that constitutes a related entity, you're much better off simplifying the data as POCOs. Passing entity references around generally leads to pain. Lazy loading out of the dbContext Scope, or the expense of eager-loading \"everything\" in case it might be needed down the road, re-associating entities to dbContexts on submit.. More mess than it's worth.</p>\n\n<p>For instance, given a view model where I want a list of things like Policies and Trusts(Companies) if I only care about the FK and a pretty name, my ViewModel is going to contain a <code>List&lt;PolicySummary&gt;</code> and <code>List&lt;CompanySummary&gt;</code> where PolicySummary is a POCO containing the PolicyId and DisplayName. CompanySummary might have CompanyId, CompanyName, and Address. (as a formatted mailing address block)  These POCOs are lightweight, and can most often be saturated in a simple .Select() statement. On the round trip you have the IDs to retrieve from the relevant dbContext to associate in your operation.</p>\n"}], "owner": {"reputation": 2736, "user_id": 752832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6fd3bf2f524a9503de9a168d26ed50b8?s=128&d=identicon&r=PG", "display_name": "joeschwa", "link": "https://stackoverflow.com/users/752832/joeschwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 45068654, "answer_count": 2, "score": 0, "last_activity_date": 1499899264, "creation_date": 1499892484, "question_id": 45067260, "link": "https://stackoverflow.com/questions/45067260/access-entity-framework-viewmodel-properties-in-view-using-lambda-expressions", "title": "Access Entity Framework ViewModel properties in View using Lambda Expressions", "body": "<p>I was intrigued by this <a href=\"http://rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp-net-mvc-applications/\" rel=\"nofollow noreferrer\">Rachel Appel blog</a> post that has a View that references a ViewModel, and within the View is able to access the properties across the ViewModel's multiple entities using Lambda expressions with this syntax:</p>\n\n<p><code>@Html.EditorFor(model =&gt; model.ViewModelEntityName.Property)</code></p>\n\n<p>I was able to access the individual ViewModel entities, but not the properties of those entities. Here is my code:</p>\n\n<p><strong>ViewModel</strong></p>\n\n<pre><code>public class PoliciesTrustsViewModel\n{\n    public ICollection&lt;Insurance&gt; Policies { get; set; } //model in partial class generated by EF database first      \n    public ICollection&lt;Companies&gt; Trusts { get; set; } //model in partial class generated by EF database first\n\n    public PoliciesTrustsViewModel(ICollection&lt;Insurance&gt; policies, ICollection&lt;Companies&gt; trusts)\n    {\n        Policies = policies;\n\n        Trusts = trusts;\n    }\n</code></pre>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>public ActionResult Create()\n{\n        ICollection&lt;Insurance&gt; policies = db.Insurance.ToList();\n        ICollection&lt;Companies&gt; trusts = db.Companies.ToList();\n\n        var myViewModel = new ViewModels.PoliciesTrustsViewModel(policies, trusts);\n\n        return View(myViewModel);\n}\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<p>I set the model reference to the ViewModel:</p>\n\n<p><code>@model IEnumerable&lt;TrustsInsurance.ViewModels.PoliciesTrustsViewModel&gt;</code></p>\n\n<p>Lambda expressions will accept the entity name but will not allow the properties within an individual entity. So</p>\n\n<p><code>@Html.EditorFor(model =&gt; model.Policies, new { htmlAttributes = new { @class = \"form-control\" } })</code></p>\n\n<p>is allowable, but </p>\n\n<p><code>@Html.EditorFor(model =&gt; model.Policies.Property, new { htmlAttributes = new { @class = \"form-control\" } })</code></p>\n\n<p>yields a \"does not contain a definition\" error. I tried using a <code>@foreach (var item in Model)</code> loop in razor as well as a number of different casts, but no sale. So how can one access properties across multiple models using lambda expressions? Any nudge in the right direction would be greatly appreciated.</p>\n"}, {"tags": ["c#", ".net", "azure", ".net-core", "azureservicebus"], "comments": [{"owner": {"reputation": 15210, "user_id": 1364771, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wI3aU.jpg?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/1364771/jesse-carter"}, "edited": false, "score": 0, "creation_date": 1499892481, "post_id": 45067209, "comment_id": 77107723, "body": "Can you add the handler code for the console app? How are you attempting to read the message?"}, {"owner": {"reputation": 9815, "user_id": 84395, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5a33e112a880f4dcb3644113d26e00f6?s=128&d=identicon&r=PG&f=1", "display_name": "Cloud SME", "link": "https://stackoverflow.com/users/84395/cloud-sme"}, "edited": false, "score": 0, "creation_date": 1499893179, "post_id": 45067209, "comment_id": 77108079, "body": "Looks like the issue might be with the .NET serializer, can you try to use JSON serialization?"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1499894077, "post_id": 45067209, "comment_id": 77108505, "body": "You send the queue raw bytes but expect to receive a string on the other side. Part of the message meta-information is the content type, I think it does not know what to do with the byte-&gt;string conversion because it does not know what kind of byte[] you sent."}, {"owner": {"reputation": 389, "user_id": 7259639, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b98b021fe27a1243dce14458a0ec1816?s=128&d=identicon&r=PG&f=1", "display_name": "ddcc3432", "link": "https://stackoverflow.com/users/7259639/ddcc3432"}, "edited": false, "score": 0, "creation_date": 1499894758, "post_id": 45067209, "comment_id": 77108843, "body": "I tried setting the ContentType to &#39;base64Binary&#39; or a serializable object that I shared between the project, neither worked."}], "answers": [{"tags": [], "owner": {"reputation": 16914, "user_id": 59563, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0470d91615bbd75e864b509a4bc5e395?s=128&d=identicon&r=PG", "display_name": "Sean Feldman", "link": "https://stackoverflow.com/users/59563/sean-feldman"}, "is_accepted": false, "score": 0, "last_activity_date": 1499902533, "creation_date": 1499902533, "answer_id": 45069133, "question_id": 45067209, "link": "https://stackoverflow.com/questions/45067209/send-a-message-on-azure-servicebus-from-net-core-sender-to-a-net-4-6-handler/45069133#45069133", "title": "Send a message on Azure ServiceBus from .NET Core sender to a .NET 4.6 handler", "body": "<p>Sounds like an <a href=\"https://github.com/Azure/azure-service-bus-dotnet/issues/114\" rel=\"nofollow noreferrer\">interoperability issue</a> </p>\n\n<p>The fix was merged into <code>dev</code> branch, but hasn't gone out yet. Scheduled for <a href=\"https://github.com/Azure/azure-service-bus-dotnet/pull/207\" rel=\"nofollow noreferrer\"><code>0.0.7-preview</code> milestone`</a>. You can track it under the GitHub repo.</p>\n"}, {"comments": [{"owner": {"reputation": 389, "user_id": 7259639, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b98b021fe27a1243dce14458a0ec1816?s=128&d=identicon&r=PG&f=1", "display_name": "ddcc3432", "link": "https://stackoverflow.com/users/7259639/ddcc3432"}, "edited": false, "score": 0, "creation_date": 1499905677, "post_id": 45069423, "comment_id": 77112224, "body": "The BrokeredMessage with ContentType &#39;null&#39; failed to deserialize to a string with the message: &#39;Expecting element &#39;string&#39; from namespace &#39;<a href=\"http://schemas.microsoft.com/2003/10/Serialization/\" rel=\"nofollow noreferrer\">schemas.microsoft.com/2003/10/Serialization</a>&#39;.. Encountered &#39;Element&#39;  with name &#39;base64Binary&#39;, namespace &#39;<a href=\"http://schemas.microsoft.com/2003/10/Serialization/\" rel=\"nofollow noreferrer\">schemas.microsoft.com/2003/10/Serialization</a>&#39;. &#39;"}, {"owner": {"reputation": 389, "user_id": 7259639, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b98b021fe27a1243dce14458a0ec1816?s=128&d=identicon&r=PG&f=1", "display_name": "ddcc3432", "link": "https://stackoverflow.com/users/7259639/ddcc3432"}, "edited": false, "score": 0, "creation_date": 1499905723, "post_id": 45069423, "comment_id": 77112238, "body": "I tried your sample. I think the .NET 4.6 receiver needs to know the ContentType to deserialize it."}, {"owner": {"reputation": 1154, "user_id": 1773900, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e702a3fc42f59c88f3377b199409a731?s=128&d=identicon&r=PG", "display_name": "lohiarahul", "link": "https://stackoverflow.com/users/1773900/lohiarahul"}, "edited": false, "score": 0, "creation_date": 1511328524, "post_id": 45069423, "comment_id": 81809268, "body": "<a href=\"https://stackoverflow.com/questions/47427361/azure-service-bus-read-messages-sent-by-net-core-2-with-brokeredmessage-getbo\" title=\"azure service bus read messages sent by net core 2 with brokeredmessage getbo\">stackoverflow.com/questions/47427361/&hellip;</a>"}, {"owner": {"reputation": 2099, "user_id": 2362852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ae010f56663ea9a4e903e9580773a7?s=128&d=identicon&r=PG", "display_name": "Fred Johnson", "link": "https://stackoverflow.com/users/2362852/fred-johnson"}, "edited": false, "score": 0, "creation_date": 1524042092, "post_id": 45069423, "comment_id": 86806182, "body": "does this work with broker properties also set? I tried setting the same user properties in net core to no avail"}], "tags": [], "owner": {"reputation": 10677, "user_id": 122195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65228e5118999b6712f54a7076e15776?s=128&d=identicon&r=PG", "display_name": "thepirat000", "link": "https://stackoverflow.com/users/122195/thepirat000"}, "is_accepted": true, "score": 3, "last_activity_date": 1499905479, "last_edit_date": 1499905479, "creation_date": 1499904363, "answer_id": 45069423, "question_id": 45067209, "link": "https://stackoverflow.com/questions/45067209/send-a-message-on-azure-servicebus-from-net-core-sender-to-a-net-4-6-handler/45069423#45069423", "title": "Send a message on Azure ServiceBus from .NET Core sender to a .NET 4.6 handler", "body": "<p>I guess the problem is because the .NET Core is publishing the message serialized as <strong>JSON</strong> to the topic but the NET 4.6 code is trying to deserialize that message from the subscription with the <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/data-contract-serializer\" rel=\"nofollow noreferrer\">DataContract Serializer</a> (XML?), as far as I know that's the default deserialization method for the full .Net framework library.</p>\n\n<p>If that's the case and you cannot modify the receiving code, you will need to <strong>serialize</strong> the message with <code>DataContractSerializer</code> on .Net Core: </p>\n\n<pre><code>var ser = new System.Runtime.Serialization.DataContractSerializer(typeof(string));\nvar ms = new MemoryStream();\nser.WriteObject(ms, \"hello world\");\nvar msg = new Message(ms.ToArray());\n</code></pre>\n\n<p>You'll need the nuget package <code>System.Runtime.Serialization.Xml</code></p>\n"}], "owner": {"reputation": 389, "user_id": 7259639, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b98b021fe27a1243dce14458a0ec1816?s=128&d=identicon&r=PG&f=1", "display_name": "ddcc3432", "link": "https://stackoverflow.com/users/7259639/ddcc3432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2286, "favorite_count": 1, "accepted_answer_id": 45069423, "answer_count": 2, "score": 2, "last_activity_date": 1499905479, "creation_date": 1499892282, "last_edit_date": 1499892877, "question_id": 45067209, "link": "https://stackoverflow.com/questions/45067209/send-a-message-on-azure-servicebus-from-net-core-sender-to-a-net-4-6-handler", "title": "Send a message on Azure ServiceBus from .NET Core sender to a .NET 4.6 handler", "body": "<p>I want to send a message over Azure Service Bus from a .NET Core console app and receive it with in a .NET 4.6 console app. In .NET Core I'm using Azure's new service bus client for the sender which is not yet intended for production (according to their readme).</p>\n\n<p><a href=\"https://github.com/Azure/azure-service-bus-dotnet\" rel=\"nofollow noreferrer\">https://github.com/Azure/azure-service-bus-dotnet</a></p>\n\n<p>I can send from .NET Core and receive with .NET Core easily enough using the samples. However when the .NET 4.6 app subscribes to the Topic and receives the same message the .NET 4.6 app throws this exception:</p>\n\n<pre><code>Microsoft.Azure.WebJobs.Host.FunctionInvocationException: \nException while executing function: Functions.ProcessEvent\nSystem.InvalidOperationException: Exception binding parameter 'message' \nThe BrokeredMessage with ContentType 'string' failed to \ndeserialize to a string with the message: \n'Expecting element 'string' from namespace \n'http://schemas.microsoft.com/2003/10/Serialization/'.. \nEncountered 'Element'  with name 'base64Binary', namespace \nhttp://schemas.microsoft.com/2003/10/Serialization/'. ' ---&gt; \nSystem.Runtime.Serialization.SerializationException: Expecting element\n'string' from namespace \nhttp://schemas.microsoft.com/2003/10/Serialization/'.. Encountered 'Element'\nwith name 'base64Binary', namespace \n'http://schemas.microsoft.com/2003/10/Serialization/'. \n\n\nSystem.Runtime.Serialization.DataContractSerializer.InternalReadObject\n(XmlReaderDelegator xmlReader, Boolean verifyObjectName, \nDataContractResolver dataContractResolver) at \n System.Runtime.Serialization.XmlObjectSerializer.\nReadObjectHandleExceptions(XmlReaderDelegator reader, \nBoolean verifyObjectName, DataContractResolver dataContractResolver)\n</code></pre>\n\n<p>My .NET Core sender code is:</p>\n\n<pre><code>using Microsoft.Azure.ServiceBus;\n\nvar topicClient = new TopicClient(ServiceBusConnectionString, \"topic1\");\nvar msg = new Message(Encoding.UTF8.GetBytes(\"Hello world\"));\ntopicClient.SendAsync(msg).Wait();\n</code></pre>\n\n<p>My .NET 4.6 receiver code is:</p>\n\n<pre><code>    using Microsoft.Azure.WebJobs;\n\n    static void Main()\n    {\n        var config = new JobHostConfiguration();\n        config.UseTimers();\n        config.UseServiceBus();\n        var host = new JobHost(config);\n        host.RunAndBlock();\n    }\n\n    public void ProcessEvent([ServiceBusTrigger(\"topic1\", \"the-same-endpoint-as-connection-string\")] string message, TextWriter logger)\n    {\n        Console.Writeline(message);\n    }\n</code></pre>\n\n<p>Note I can't change the receiver as it's a legacy system.</p>\n"}, {"tags": ["c#", "switch-statement", "string-formatting"], "answers": [{"comments": [{"owner": {"reputation": 2410, "user_id": 8217112, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FB7l5icjoDo/AAAAAAAAAAI/AAAAAAAACPA/jgQiuzBBY3c/photo.jpg?sz=128", "display_name": "noah", "link": "https://stackoverflow.com/users/8217112/noah"}, "edited": false, "score": 1, "creation_date": 1499893634, "post_id": 45067432, "comment_id": 77108299, "body": "Yeah, fairly new to c#. I didn&#39;t even think to just put a simple statement for each day that would end up as true. Seems so obvious now to do it your way instead of trying to get Weekly____ to work."}, {"owner": {"reputation": 2720, "user_id": 773208, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/956ee7ed8db73810b70d7420c70acf5b?s=128&d=identicon&r=PG", "display_name": "simonlchilds", "link": "https://stackoverflow.com/users/773208/simonlchilds"}, "reply_to_user": {"reputation": 2410, "user_id": 8217112, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FB7l5icjoDo/AAAAAAAAAAI/AAAAAAAACPA/jgQiuzBBY3c/photo.jpg?sz=128", "display_name": "noah", "link": "https://stackoverflow.com/users/8217112/noah"}, "edited": false, "score": 0, "creation_date": 1499893797, "post_id": 45067432, "comment_id": 77108378, "body": "It&#39;s ok, we all need to start somewhere :) I find that keeping things simple often makes things easier."}], "tags": [], "owner": {"reputation": 2720, "user_id": 773208, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/956ee7ed8db73810b70d7420c70acf5b?s=128&d=identicon&r=PG", "display_name": "simonlchilds", "link": "https://stackoverflow.com/users/773208/simonlchilds"}, "is_accepted": true, "score": 2, "last_activity_date": 1499893667, "last_edit_date": 1499893667, "creation_date": 1499893232, "answer_id": 45067432, "question_id": 45067140, "link": "https://stackoverflow.com/questions/45067140/how-to-do-a-switch-case-or-string-format-within-an-expression-block/45067432#45067432", "title": "How to do a switch case or string format within an expression block", "body": "<p>I'm guessing you're fairly new to C#? </p>\n\n<p>What you need to do is something like this</p>\n\n<pre><code>var my = new MyModel\n{\n    Recurrence = new RecurrenceModel\n    {\n        WeeklyMonday = DateTime.Today.DayOfWeek == DayOfWeek.Monday\n    }\n};\n</code></pre>\n\n<p>In both of your attempts, you're not actually assigning the value to the property. Your code will not compile because it's not valid C#. You don't need a switch or a string.Format to achieve what you're after. </p>\n\n<p>In my example, I'm assigning the result of <code>DateTime.Today.DayOfWeek == DayOfWeek.Monday</code> to the <code>WeeklyMonday</code> property on your model class </p>\n"}, {"comments": [{"owner": {"reputation": 2720, "user_id": 773208, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/956ee7ed8db73810b70d7420c70acf5b?s=128&d=identicon&r=PG", "display_name": "simonlchilds", "link": "https://stackoverflow.com/users/773208/simonlchilds"}, "edited": false, "score": 0, "creation_date": 1499894214, "post_id": 45067519, "comment_id": 77108582, "body": "I was going to suggest adding the logic to the constructor, but I&#39;m on my phone and didn&#39;t want to type all that out! :D"}, {"owner": {"reputation": 2410, "user_id": 8217112, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FB7l5icjoDo/AAAAAAAAAAI/AAAAAAAACPA/jgQiuzBBY3c/photo.jpg?sz=128", "display_name": "noah", "link": "https://stackoverflow.com/users/8217112/noah"}, "edited": false, "score": 0, "creation_date": 1499895160, "post_id": 45067519, "comment_id": 77109056, "body": "While adding it in the way @Jun Kang did is very elegant, it won&#39;t work for my purposes. This isn&#39;t the only time/way RecurrenceModel is used so it can&#39;t be done with the constructor."}], "tags": [], "owner": {"reputation": 1129, "user_id": 8062101, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/958686dc0efdc797db259f8a384bbac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Kang", "link": "https://stackoverflow.com/users/8062101/jun-kang"}, "is_accepted": false, "score": 1, "last_activity_date": 1499893586, "creation_date": 1499893586, "answer_id": 45067519, "question_id": 45067140, "link": "https://stackoverflow.com/questions/45067140/how-to-do-a-switch-case-or-string-format-within-an-expression-block/45067519#45067519", "title": "How to do a switch case or string format within an expression block", "body": "<p>simonlchilds is right. The best way to do this is within the constructor of the class, evaluating the value of the current day to set which property to true. </p>\n\n<p>I personally would do something like this.</p>\n\n<pre><code>class RecurrenceModel\n{\n    public RecurrenceModel()\n    {\n        GetType().GetProperty(\"Weekly\" + DateTime.Today.DayOfWeek).SetValue(this, true);\n    }\n\n    public bool WeeklyMonday { get; set; }\n    public bool WeeklyTuesday { get; set; }\n    public bool WeeklyWednesday { get; set; }\n    public bool WeeklyThursday { get; set; }\n    public bool WeeklyFriday { get; set; }\n    public bool WeeklySaturday { get; set; }\n    public bool WeeklySunday { get; set; }\n}\n</code></pre>\n\n<p>That way, whenever this class is instantiated, it will automatically set whichever the day is to true and this is all you would need to do.</p>\n\n<pre><code>var my = new MyModel\n{\n    Recurrence = new RecurrenceModel()\n};\n</code></pre>\n"}], "owner": {"reputation": 2410, "user_id": 8217112, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FB7l5icjoDo/AAAAAAAAAAI/AAAAAAAACPA/jgQiuzBBY3c/photo.jpg?sz=128", "display_name": "noah", "link": "https://stackoverflow.com/users/8217112/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 45067432, "answer_count": 2, "score": -1, "last_activity_date": 1499893667, "creation_date": 1499892087, "question_id": 45067140, "link": "https://stackoverflow.com/questions/45067140/how-to-do-a-switch-case-or-string-format-within-an-expression-block", "title": "How to do a switch case or string format within an expression block", "body": "<p>How can I implement a switch case (or similar effect) in an expression body? I am creating a Model object (lets call it MyModel) and one of the fields is a recurrence field. The recurrence is based on the current day of the week (Monday's example is below). Basically I want to set the Weekly____ to be true. I was also thinking that potentially String.Format() would have something to support this, but I couldn't get it to work.</p>\n\n<pre><code>var my = new MyModel\n{\n    Recurrence = new RecurrenceModel\n    {\n        WeeklyMonday = true //what it would be on a Monday\n    }\n};\n</code></pre>\n\n<p>My attempt with switch case</p>\n\n<pre><code>var my = new MyModel\n{\n    switch(DateTime.Today.DayOfWeek.ToString())\n        case \"Monday\":\n            Recurrence = new RecurrenceModel\n            {\n                WeeklyMonday = true\n            }\n            break;\n        default:\n            break;\n};\n</code></pre>\n\n<p>My attempt with String.Format()</p>\n\n<pre><code>var my = new MyModel\n{\n    Recurrence = new RecurrenceModel\n    {\n        String.Format(\"Weekly{0}\", DateTime.Today.DayOfWeek.ToString()) = true\n    }\n};\n</code></pre>\n"}, {"tags": ["c#", "entity-framework"], "answers": [{"comments": [{"owner": {"reputation": 419, "user_id": 3880331, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/T5PSi.jpg?s=128&g=1", "display_name": "Rubens Mussi Cury", "link": "https://stackoverflow.com/users/3880331/rubens-mussi-cury"}, "edited": false, "score": 0, "creation_date": 1499920525, "post_id": 45070650, "comment_id": 77115566, "body": "Calling DetectChanges() I got the same issue. Indeed, ChangeTracker is tracking the changes as expected. Debugging my code I noticed my entity is losing all collections properties relations count right after the execution of <code>db.SampleEntity.Remove(db.SampleEntity.Find(1234)</code> even before entering in <code>public override int SaveChanges() { }</code>. What I&#39;m doing wrong?"}, {"owner": {"reputation": 22598, "user_id": 2910943, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/YaPew.jpg?s=128&g=1", "display_name": "Backs", "link": "https://stackoverflow.com/users/2910943/backs"}, "reply_to_user": {"reputation": 419, "user_id": 3880331, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/T5PSi.jpg?s=128&g=1", "display_name": "Rubens Mussi Cury", "link": "https://stackoverflow.com/users/3880331/rubens-mussi-cury"}, "edited": false, "score": 0, "creation_date": 1499920763, "post_id": 45070650, "comment_id": 77115624, "body": "@RubensMussiCury this is how EF works. After removing entity it will drop all relations with child/parent entities"}, {"owner": {"reputation": 419, "user_id": 3880331, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/T5PSi.jpg?s=128&g=1", "display_name": "Rubens Mussi Cury", "link": "https://stackoverflow.com/users/3880331/rubens-mussi-cury"}, "edited": false, "score": 0, "creation_date": 1499921050, "post_id": 45070650, "comment_id": 77115699, "body": "would you please have any suggestion in order to keep these relations when I set to delete/remove my entity?"}, {"owner": {"reputation": 22598, "user_id": 2910943, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/YaPew.jpg?s=128&g=1", "display_name": "Backs", "link": "https://stackoverflow.com/users/2910943/backs"}, "reply_to_user": {"reputation": 419, "user_id": 3880331, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/T5PSi.jpg?s=128&g=1", "display_name": "Rubens Mussi Cury", "link": "https://stackoverflow.com/users/3880331/rubens-mussi-cury"}, "edited": false, "score": 0, "creation_date": 1499930063, "post_id": 45070650, "comment_id": 77120065, "body": "@RubensMussiCury you can save property value to some field before delete operation, and then extract it: <a href=\"https://gist.github.com/Backs/47284b79c724d182d8c560c76ec49df5\" rel=\"nofollow noreferrer\">gist.github.com/Backs/47284b79c724d182d8c560c76ec49df5</a>"}, {"owner": {"reputation": 419, "user_id": 3880331, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/T5PSi.jpg?s=128&g=1", "display_name": "Rubens Mussi Cury", "link": "https://stackoverflow.com/users/3880331/rubens-mussi-cury"}, "edited": false, "score": 0, "creation_date": 1499966094, "post_id": 45070650, "comment_id": 77146654, "body": "sounds a good approach... how do you consider about creating a basic EF repository for this purpose? Also, would you please edit your answer or just answer again my question to get an answered mark..."}, {"owner": {"reputation": 22598, "user_id": 2910943, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/YaPew.jpg?s=128&g=1", "display_name": "Backs", "link": "https://stackoverflow.com/users/2910943/backs"}, "reply_to_user": {"reputation": 419, "user_id": 3880331, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/T5PSi.jpg?s=128&g=1", "display_name": "Rubens Mussi Cury", "link": "https://stackoverflow.com/users/3880331/rubens-mussi-cury"}, "edited": false, "score": 0, "creation_date": 1500100466, "post_id": 45070650, "comment_id": 77201691, "body": "@RubensMussiCury added example to answer"}], "tags": [], "owner": {"reputation": 22598, "user_id": 2910943, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/YaPew.jpg?s=128&g=1", "display_name": "Backs", "link": "https://stackoverflow.com/users/2910943/backs"}, "is_accepted": true, "score": 0, "last_activity_date": 1500100456, "last_edit_date": 1500100456, "creation_date": 1499914352, "answer_id": 45070650, "question_id": 45067138, "link": "https://stackoverflow.com/questions/45067138/ef-changetracker-entity-collections-count-always-0/45070650#45070650", "title": "EF ChangeTracker entity collections count always 0", "body": "<p>Call DetectChanges before:</p>\n\n<pre><code>public override int SaveChanges()\n{\n    ChangeTracker.DetectChanges();\n    //...\n    return base.SaveChanges();\n}\n</code></pre>\n\n<p>Otherwise, changes will be detected only in <code>base.SaveChanges()</code> method.</p>\n\n<p>EF will drop all references to related objects for deleted entites. If you need to save this relations, you can save them in local field:</p>\n\n<pre><code>class UnitCompany\n{\n    private SampleEntity _entity;\n    private SampleEntity _prevEntity;\n\n    publc SampleEntity Entity\n    {\n        get { return _entity; }\n        set \n        { \n            if (value != null)\n            {\n                _prevEntity = value;\n            }\n            _entity = value;\n        }\n    }\n}\n</code></pre>\n\n<p><code>_prevEntity</code> keeps link to related object and you can get it in <code>SaveChanges</code></p>\n"}], "owner": {"reputation": 419, "user_id": 3880331, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/T5PSi.jpg?s=128&g=1", "display_name": "Rubens Mussi Cury", "link": "https://stackoverflow.com/users/3880331/rubens-mussi-cury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 45070650, "answer_count": 1, "score": 0, "last_activity_date": 1500100456, "creation_date": 1499892081, "question_id": 45067138, "link": "https://stackoverflow.com/questions/45067138/ef-changetracker-entity-collections-count-always-0", "title": "EF ChangeTracker entity collections count always 0", "body": "<p>In order to execute some actions for all entities deletions I'm trying to handle it like this:</p>\n\n<pre><code>public override int SaveChanges()\n{\n    var deletedEntities = ChangeTracker.Entries()\n        .Where(p =&gt; p.State == EntityState.Deleted).ToList();\n\n    foreach (var deletedEntity in deletedEntities)\n    {\n        //((SampleEntity)deletedEntity.Entity).SuperCollection.Count();\n    }\n\n    return base.SaveChanges();\n}\n</code></pre>\n\n<p>I need to handle some entity collections during the deletion process based on the entity collection properties count, but it always returns 0, even when the collection has many items.</p>\n\n<pre><code>((SampleEntity)deletedEntity.Entity).SuperCollection.Count();\n</code></pre>\n\n<p><strong>Any idea why my collections are always 0 at this point?</strong></p>\n\n<p>My models are properly lazy loading coded as following and my collections works very well out of the SaveChanges()</p>\n\n<pre><code>public partial class SampleEntity\n{\n    public int MyId { get; set; }\n    public string Description { get; set; }\n\n    public SampleEntity()\n    {\n        this.SuperCollection = new HashSet&lt;UnitCompany&gt;();\n    }\n\n    public virtual ICollection&lt;AnyOtherEntity&gt; SuperCollection { get; set; }\n}\n</code></pre>\n\n<p>Best regards</p>\n"}, {"tags": ["c#", "visual-studio", "vsto", "outlook-addin"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1499892287, "post_id": 45067133, "comment_id": 77107633, "body": "<code>item.Attachments[j]</code> smells like it&#39;s going to be of type Attachment.  It probably has a bunch of properties and stuff.  Have you looked at the properties and seen what they are when the Attachment is truly an attachment and when it&#39;s embedded?"}, {"owner": {"reputation": 1, "user_id": 8298238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b08328a2f5e5d4626b0ceb0a0b173b7?s=128&d=identicon&r=PG&f=1", "display_name": "Bhargavi", "link": "https://stackoverflow.com/users/8298238/bhargavi"}, "edited": false, "score": 0, "creation_date": 1499958392, "post_id": 45067133, "comment_id": 77141542, "body": "Thanks Will. I will check on it"}], "owner": {"reputation": 1, "user_id": 8298238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b08328a2f5e5d4626b0ceb0a0b173b7?s=128&d=identicon&r=PG&f=1", "display_name": "Bhargavi", "link": "https://stackoverflow.com/users/8298238/bhargavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499896530, "creation_date": 1499892065, "last_edit_date": 1499896530, "question_id": 45067133, "link": "https://stackoverflow.com/questions/45067133/vsto-2010-outlook-addin-exclude-embedded-object", "title": "VSTO 2010 Outlook Addin -Exclude Embedded Object", "body": "<p>I am developing a outlook 2010 add-in with c# .net  using Visual Studio 2015.</p>\n\n<p>When i click on the button (add-in) in the reading pane of an email, I need to save only the attachments excluding the embedded objects of that particular email.</p>\n\n<pre><code>if (item.Attachments.Count &gt; 0)\n{\n    for (int j = 1; j &lt;= item.Attachments.Count; j++)\n    {\n        item.Attachments[j].SaveAsFile(item.Attachments[j].FileName);\n    }\n}\n</code></pre>\n\n<p>But my current code copies both the attachments and embedded objects, I only want to save the attachments (not the embedded objects)</p>\n\n<p>Could anyone please help me on this?</p>\n"}, {"tags": ["c#", "wpf", "expander"], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 4587181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gOWEK.png?s=128&g=1", "display_name": "FatalJam&#242;n", "link": "https://stackoverflow.com/users/4587181/fataljam%c3%b2n"}, "is_accepted": false, "score": 0, "last_activity_date": 1499926633, "creation_date": 1499926633, "answer_id": 45072762, "question_id": 45067112, "link": "https://stackoverflow.com/questions/45067112/ability-to-select-anywhere-on-expander-to-expand/45072762#45072762", "title": "Ability to Select Anywhere on Expander to Expand", "body": "<p>Have a look at the <strong>controltemplate</strong> perhaps? You could also use a click event and see if the mouse is on the header part and make it a reusable <strong>Behavior</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 8207091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a32e0f9fa1f0160e473cef0fd4bddc3?s=128&d=identicon&r=PG&f=1", "display_name": "John Smitty", "link": "https://stackoverflow.com/users/8207091/john-smitty"}, "is_accepted": true, "score": 0, "last_activity_date": 1500297985, "creation_date": 1500297985, "answer_id": 45145555, "question_id": 45067112, "link": "https://stackoverflow.com/questions/45067112/ability-to-select-anywhere-on-expander-to-expand/45145555#45145555", "title": "Ability to Select Anywhere on Expander to Expand", "body": "<p>The problem was that the width of the expander was not set, so it was auto.  Therefore it worked when it was closing because the width, when opened, is set to the entire expander.  However, it didn't work while collapsed because when collapsed, the expander width is only set to as far as the header goes. Thus, I changed the width to a fixed value and it allowed me to press anywhere on the top part of the expander to open and close it.</p>\n"}], "owner": {"reputation": 27, "user_id": 8207091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a32e0f9fa1f0160e473cef0fd4bddc3?s=128&d=identicon&r=PG&f=1", "display_name": "John Smitty", "link": "https://stackoverflow.com/users/8207091/john-smitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 45145555, "answer_count": 2, "score": 0, "last_activity_date": 1500297985, "creation_date": 1499891988, "last_edit_date": 1499926880, "question_id": 45067112, "link": "https://stackoverflow.com/questions/45067112/ability-to-select-anywhere-on-expander-to-expand", "title": "Ability to Select Anywhere on Expander to Expand", "body": "<p>I am working in WPF C# and noticed that my expander will expand and collapse when when I click on the button or header (words) of the expander but will not expand when I click on the part of the expander beside the header. </p>\n\n<p>The weird part is that it will collapse the expander when clicking on the same spot beside the expander. </p>\n\n<p>So does anyone know how to allow the entire expander to be clicked on to expand and collapse it?  </p>\n\n<p>Any help is greatly appreciated!</p>\n\n<pre><code>&lt;Expander ExpandDirection=\"Down\" Width=\"Auto\" Padding=\"4\" Expanded=\"Expander_Expanded\"&gt;\n    &lt;Expander.Style&gt;\n        &lt;Style TargetType=\"Expander\"&gt;\n            &lt;!--&lt;Setter Property=\"IsExpanded\" Value=\"{Binding XPath=@Name, Converter={StaticResource ExpandConverter}}\"  /&gt;--&gt;\n            &lt;Setter Property=\"IsExpanded\" Value=\"{Binding XPath=@Expand}\" /&gt;\n            &lt;Setter Property=\"Header\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;MultiBinding Converter=\"{StaticResource NameConverter}\"&gt;\n                        &lt;Binding XPath=\"@Name\" /&gt;\n                    &lt;/MultiBinding&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n\n            &lt;Setter Property=\"FontWeight\" Value=\"Bold\" /&gt;\n\n            &lt;Style.Triggers&gt;\n                &lt;DataTrigger Binding=\"{Binding IsExpanded,RelativeSource={RelativeSource Self}}\" Value=\"True\"&gt;\n                &lt;/DataTrigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n    &lt;/Expander.Style&gt;\n    &lt;ListBox Name=\"itemsList\"\n        ItemsSource=\"{Binding XPath=UpgradeAction}\"\n        ItemTemplate=\"{StaticResource dtListItemTemplate}\"\n        SelectionChanged=\"listItems_SelectionChanged\"\n        Style=\"{StaticResource styleListBoxUpgradeAction}\"\n        ItemContainerStyle=\"{StaticResource styleListBoxItemUpgradeAction}\"\n        MouseDoubleClick=\"itemsList_MouseDoubleClick\"&gt;\n    &lt;/ListBox&gt;\n&lt;/Expander&gt;\n</code></pre>\n"}, {"tags": ["c#", "sql-server-2008", "asp.net-mvc-5", "entity-framework-5"], "owner": {"reputation": 694, "user_id": 6220698, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/59634a20e777898d4f36185ee2ee3be4?s=128&d=identicon&r=PG&f=1", "display_name": "whisk", "link": "https://stackoverflow.com/users/6220698/whisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1499951400, "creation_date": 1499891870, "last_edit_date": 1499951400, "question_id": 45067084, "link": "https://stackoverflow.com/questions/45067084/how-do-i-setup-asp-net-identity-to-use-my-own-connection-string-i-have-two-diff", "title": "How do I setup ASP.NET Identity to use my own connection string? I have two different options", "body": "<p>I am doing a project in MVC5 EF 5 and have read a million tutorials and have come to a sudden wall. </p>\n\n<p>I have my connection string that allows me to use Database fist when using  Identity, and when I have to make a scaffolded Item that allows me to do CRUD, I have to switch it back to the auto created connection string. </p>\n\n<p>So my question is, what can i do to get just one string to work, i cant find any documentation on what MVC5/EF is looking for when the connString is called.</p>\n\n<p>here are the two string. </p>\n\n<pre><code>&lt;!--&lt;add name=\"TextronEntities\" connectionString=\"Data Source=LEMN-476W-IT; initial catalog=Textron; integrated security=True;\" providerName=\"System.Data.SqlClient\" /&gt;--&gt;\n&lt;add name=\"TextronEntities\" connectionString=\"metadata=res://*/Models.TextronDBConnection.csdl|res://*/Models.TextronDBConnection.ssdl|res://*/Models.TextronDBConnection.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;data source=LEMN-476W-IT;initial catalog=Textron;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework&amp;quot;\" providerName=\"System.Data.EntityClient\" /&gt;\n</code></pre>\n\n<p>the top one is the one that lets me log in and register new users, where the bottom one is the one that lets me do CRUD. </p>\n\n<p>I comment one out to login and the other to use CRUD testing.</p>\n\n<p>This inst a production project but might soon be and i would like to understand everything to the best of my knowledge. </p>\n"}, {"tags": ["c#", "wpf", "listbox"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1499901691, "post_id": 45066991, "comment_id": 77111215, "body": "Are you open to using a <code>ListView</code>? It&#39;s easier to work with for changing the color."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1499903487, "post_id": 45066991, "comment_id": 77111671, "body": "Do you have draw mode set to <code>OwnerDrawnFixed</code>?"}, {"owner": {"reputation": 1472, "user_id": 2975589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yNmWF.png?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2975589/maxim"}, "edited": false, "score": 0, "creation_date": 1499914987, "post_id": 45066991, "comment_id": 77114309, "body": "You <b>must</b> get familiar with MVVM. Using it your task will be solved for couple of minutes. 1) do ping in view-model; 2) every pinged item should has its view-model (for example, <code>ItemVM</code>) with <code>PingOk</code> property showing whether ping was succesfull or not; 3) bind <code>ItemsSource</code> of the <code>ListBox</code> to collection of <code>ItemVM</code>; 4) set trigger in XAML for <code>ListBoxItem</code> changing <code>Foreground</code> depending on value of the <code>PingOk</code> property. And <code>ListBox</code> is much more useful for your task than <code>ListView</code> so stick with this items control."}], "answers": [{"tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1499902469, "creation_date": 1499902469, "answer_id": 45069124, "question_id": 45066991, "link": "https://stackoverflow.com/questions/45066991/how-to-add-listbox-items-with-specific-text-color/45069124#45069124", "title": "How to add listbox items with specific text color?", "body": "<p>If you're open to using a <code>ListView</code> control, it's pretty easy. First, set the view to <code>List</code>:</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n{\n    listView1.View = View.List;\n}\n</code></pre>\n\n<p>Then, you can create a generic function that will add a colored item to a <code>ListView</code>. Basically all this does is add the item first, then use it's index (which will be the last one, or <code>Count - 1</code>) to change the forecolor:</p>\n\n<pre><code>private static void AddColoredItemToListView(ListView listView, string item, Color color)\n{\n    listView.Items.Add(item);\n    listView.Items[listView.Items.Count - 1].ForeColor = color;\n}\n</code></pre>\n\n<p>Since you didn't include a <code>Ping</code> method, I'll include a simple one here:</p>\n\n<pre><code>public static bool PingServer(string serverName)\n{\n    try { return new Ping().Send(serverName)?.Status == IPStatus.Success; }\n    catch { return false; }\n}\n</code></pre>\n\n<p>Now, to call the method, all we do is read our servers file, and ping each server. If the call to <code>PingServer</code> returns true, we set a color variable to <code>Green</code>, otherwise we set it to <code>Red</code>, and then we call the method we created above:</p>\n\n<pre><code>private void browsebutton_Click(object sender, EventArgs e)\n{\n    var serversFile = @\"f:\\public\\temp\\servers.txt\";\n\n    var servers = File.ReadAllLines(serversFile)\n        .Where(l =&gt; !string.IsNullOrWhiteSpace(l))\n        .Select(l =&gt; l.Replace(\" \", \"\"));\n\n    foreach (var server in servers)\n    {\n        var color = PingServer(server)\n            ? Color.Green\n            : Color.Red;\n\n        AddColoredItemToListView(listView1, server, color);\n    }\n}\n</code></pre>\n\n<p><strong>Sample Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/S5R4j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S5R4j.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or, if you prefer, you could change the <code>BackColor</code> instead:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GOTYU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GOTYU.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 8297455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f0c6cb826c54c28aad19450a98c5c4?s=128&d=identicon&r=PG&f=1", "display_name": "S. Hurley", "link": "https://stackoverflow.com/users/8297455/s-hurley"}, "edited": false, "score": 0, "creation_date": 1499961965, "post_id": 45069356, "comment_id": 77144228, "body": "Worked great, I think the main issue was in my DrawItem method, which was fixed by casting to the ColoredItem Class.  Also, the way you wrote the code was much simpler and more eloquent. The only thing I have to figure out now is how to get the results to show quicker. (It waits until all items are ping&#39;d before drawing)"}], "tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1499904004, "creation_date": 1499904004, "answer_id": 45069356, "question_id": 45066991, "link": "https://stackoverflow.com/questions/45066991/how-to-add-listbox-items-with-specific-text-color/45069356#45069356", "title": "How to add listbox items with specific text color?", "body": "<p>I played around with it a little, and discovered how we can do the same thing with a <code>ListBox</code>. The trick is to add an item that stores both the color and the text. You were doing that with a struct, I am using a class:</p>\n\n<pre><code>class ColoredItem\n{\n    public string Text;\n    public Color Color;\n};\n</code></pre>\n\n<p>Now, we can create the colored item in much the same was as in my other answer, where we ping the server and set the color to <code>Green</code> if the ping was successful, otherwise set it to <code>Red</code>. And we set the <code>Text</code> property to the <code>server</code> name. Note that we just call <code>listBox1.Add(item)</code> directly now, since we are relying on our custom draw method to change the color:</p>\n\n<pre><code>public static bool PingServer(string serverName)\n{\n    try { return new Ping().Send(serverName)?.Status == IPStatus.Success; }\n    catch { return false; }\n}\n\nprivate void browsebutton_Click(object sender, EventArgs e)\n{\n    var serversFile = @\"f:\\public\\temp\\servers.txt\";\n\n    var servers = File.ReadAllLines(serversFile)\n        .Where(l =&gt; !string.IsNullOrWhiteSpace(l))\n        .Select(l =&gt; l.Replace(\" \", \"\"));\n\n    foreach (var server in servers)\n    {\n        var color = PingServer(server)\n            ? Color.Green\n            : Color.Red;\n\n        ColoredItem coloredItem = new ColoredItem {Color = color, Text = server};\n\n        listBox.Items.Add(coloredItem);\n    }\n}\n</code></pre>\n\n<p>Now, in our <code>DrawItem</code> method, we try to cast the item to an instance of our <code>ColoredItem</code> class. Note that the <code>DrawItemEventArgs</code> contains the <code>Index</code> of the item we're adding. When we call the <code>DrawString</code> method, we can now use our <code>item.Text</code> for the server name, and <code>item.Color</code> for the brush color:</p>\n\n<pre><code>private void listBox1_DrawItem(object sender, DrawItemEventArgs e)\n{\n    var item = listBox1.Items[e.Index] as ColoredItem;\n\n    if (item != null)\n    {\n        e.Graphics.DrawString(\n            item.Text, \n            e.Font, \n            new SolidBrush(item.Color), \n            e.Bounds);\n    }\n}\n</code></pre>\n\n<p>The only other thing we need to ensure is that the <code>DrawMode</code> for the <code>ListBox</code> is set to <code>OwnerDrawFixed</code>, so our custom draw code gets called:</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n{\n    listBox1.DrawMode = DrawMode.OwnerDrawFixed;\n}\n</code></pre>\n\n<p><strong>Sample Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/fZ2Oa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fZ2Oa.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 65, "user_id": 8297455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f0c6cb826c54c28aad19450a98c5c4?s=128&d=identicon&r=PG&f=1", "display_name": "S. Hurley", "link": "https://stackoverflow.com/users/8297455/s-hurley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3415, "favorite_count": 0, "accepted_answer_id": 45069356, "answer_count": 2, "score": 0, "last_activity_date": 1499904004, "creation_date": 1499891505, "question_id": 45066991, "link": "https://stackoverflow.com/questions/45066991/how-to-add-listbox-items-with-specific-text-color", "title": "How to add listbox items with specific text color?", "body": "<p>I am trying to add a list of computers to a listbox from a text file, and based off whether or not a ping succeeds on the computer it should color it green for success or red for failure. The problem is that it uses the last color from the last computer on all items. I believe this is because Drawitem event isnt raised until after the for loop has completed, but I can't think of a way around this. Any help is appreciated. (reduced code for ping)</p>\n\n<pre><code>    private logitem linez;\n\n    struct logitem\n    {\n        public string text;\n        public Brush color;\n    };\nprivate void browsebutton_Click(object sender, EventArgs e)\n    {\nstring textfile = ofd.FileName;\n            if (textfile != \"\")\n            {\n                string[] lines = System.IO.File.ReadAllLines(@textfile);\n                foreach (string line in lines)\n                {\n                    if (line != \"\")\n                    {\n                        string liner;\n                        liner = line.Replace(\" \", \"\");\n                        if (ping successfull)\n                        {\n                        listBoxAddGreen();\n                        }\n                        else (ping fails)\n                        {\n                         listBoxAddRed();\n                         }\n                    }\n                    changeCount();\n\n                }\n}\n       public void listBoxAddGreen ()\n    {\n        linez.color = Brushes.Green;\n        listBox1.Items.Add(linez.text);\n    }\n                  public void listBoxAddRed ()\n    {\n        linez.color = Brushes.Red;\n        listBox1.Items.Add(linez.text);\n    }\n\n        private void listBox1_DrawItem(object sender,\nSystem.Windows.Forms.DrawItemEventArgs e)\n    {\n        e.DrawBackground();\n        Brush myBrush = linez.color;\n        e.Graphics.DrawString(listBox1.Items[e.Index].ToString(),\n            e.Font, myBrush, e.Bounds, StringFormat.GenericDefault);\n        e.DrawFocusRectangle();\n    }\n</code></pre>\n"}, {"tags": ["c#", "visual-studio", "tfs"], "answers": [{"tags": [], "owner": {"reputation": 582, "user_id": 5422113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCgRH.jpg?s=128&g=1", "display_name": "Niel Zeeman", "link": "https://stackoverflow.com/users/5422113/niel-zeeman"}, "is_accepted": false, "score": 2, "last_activity_date": 1499927392, "creation_date": 1499927392, "answer_id": 45072955, "question_id": 45066971, "link": "https://stackoverflow.com/questions/45066971/how-to-check-in-or-upload-again-a-solution-that-i-have-on-my-local-drive-and-m/45072955#45072955", "title": "How to check in (or upload) again a solution that i have on my local drive and manually deleted from TFS?", "body": "<p>Assuming you are using TFVC;</p>\n\n<p>You need to sync (get latest) your local workplace with the server to see any further changes.</p>\n\n<p>If you want to simply \"restore\" the solution, you can do an \"undelete\" through the source control explorer.</p>\n\n<p>If do not want to revert your delete, you can get latest (which will remove any unchanged files) and then copy the \"new\" files over the same location. You will probably still have to and \"Add Files\" in the source explorer to re-pend them with TFS and then check them in.</p>\n\n<p>In either case, make a backup of the files you are wanting to retain.</p>\n"}, {"comments": [{"owner": {"reputation": 24666, "user_id": 7466674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d846790948d5cc43593fc778116f40d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Li-MSFT", "link": "https://stackoverflow.com/users/7466674/andy-li-msft"}, "edited": false, "score": 0, "creation_date": 1501750407, "post_id": 45076810, "comment_id": 77919081, "body": "@Emiliano Rodriguez Have you resolved your issue by above workaround? any update for this?"}], "tags": [], "owner": {"reputation": 24666, "user_id": 7466674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d846790948d5cc43593fc778116f40d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Li-MSFT", "link": "https://stackoverflow.com/users/7466674/andy-li-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1499938575, "creation_date": 1499938575, "answer_id": 45076810, "question_id": 45066971, "link": "https://stackoverflow.com/questions/45066971/how-to-check-in-or-upload-again-a-solution-that-i-have-on-my-local-drive-and-m/45076810#45076810", "title": "How to check in (or upload) again a solution that i have on my local drive and manually deleted from TFS?", "body": "<p>The simplest way is creating a branch from a Workspace Version, then check in the branch.</p>\n\n<p>Please follow below steps to do that: (Backup the original project first)</p>\n\n<ol>\n<li>Right click the project directory in <strong>Source Control Explorer >\nBranching and Merging > Branch</strong></li>\n<li>Select <strong>Workspace Version</strong> for Branch from version By, then click\n<strong>OK</strong>.</li>\n<li>Check in the new created branch</li>\n<li>Right click the <strong>Team Project name</strong> in Source Control Explorer and\n<strong>Get Latest Version</strong> to sync delete the original branch (Backup it first).</li>\n<li>Rename the new created branch to original one if needed.</li>\n<li>Check in the changes</li>\n<li>Check the remote server in page site, the project files/code will come\nback.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/B6jUL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B6jUL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 281, "user_id": 4808318, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/10153261795403656/picture?type=large", "display_name": "Emiliano Rodriguez", "link": "https://stackoverflow.com/users/4808318/emiliano-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499938575, "creation_date": 1499891426, "question_id": 45066971, "link": "https://stackoverflow.com/questions/45066971/how-to-check-in-or-upload-again-a-solution-that-i-have-on-my-local-drive-and-m", "title": "How to check in (or upload) again a solution that i have on my local drive and manually deleted from TFS?", "body": "<p>I'm using VS2017 and i have a solution on my local drive. </p>\n\n<p>I had the same solution on my TFS as well, but i deleted it from the repository page manually.</p>\n\n<p>Now if i want to check in the solution again i get a 'no pending changes' message, even if the TFS folder is empty. </p>\n\n<p>I tried a few things but nothing seems to work.</p>\n\n<p>I just don't know how to put these files on my TFS again and i can't find the help i need anywhere. Sorry if it's a duplicated question, i just can't find the answer to this.</p>\n"}, {"tags": ["c#", "xamarin", "mvvm", "xamarin.forms"], "comments": [{"owner": {"reputation": 191, "user_id": 1283214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd1282bb9ade94a96b516c86585add3?s=128&d=identicon&r=PG", "display_name": "oarrivi", "link": "https://stackoverflow.com/users/1283214/oarrivi"}, "edited": false, "score": 0, "creation_date": 1499892781, "post_id": 45066956, "comment_id": 77107867, "body": "I think you&#39;re using messages because you need to perform navigation from views."}, {"owner": {"reputation": 1587, "user_id": 1636492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d6d0ccf8f18fabe4e9963d504197cfc5?s=128&d=identicon&r=PG", "display_name": "hugo", "link": "https://stackoverflow.com/users/1636492/hugo"}, "edited": false, "score": 1, "creation_date": 1499893214, "post_id": 45066956, "comment_id": 77108100, "body": "Navigation needs to be initiated from Viewmodel"}, {"owner": {"reputation": 2246, "user_id": 598070, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3122149fc9c817896970d8ed45f1f1e3?s=128&d=identicon&r=PG", "display_name": "Mr_LinDowsMac", "link": "https://stackoverflow.com/users/598070/mr-lindowsmac"}, "reply_to_user": {"reputation": 191, "user_id": 1283214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd1282bb9ade94a96b516c86585add3?s=128&d=identicon&r=PG", "display_name": "oarrivi", "link": "https://stackoverflow.com/users/1283214/oarrivi"}, "edited": false, "score": 0, "creation_date": 1499893463, "post_id": 45066956, "comment_id": 77108223, "body": "@oarrivi Not only that, I also need additional information containted in the ViewModel, as an edit or a new Negotiator."}, {"owner": {"reputation": 2246, "user_id": 598070, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3122149fc9c817896970d8ed45f1f1e3?s=128&d=identicon&r=PG", "display_name": "Mr_LinDowsMac", "link": "https://stackoverflow.com/users/598070/mr-lindowsmac"}, "reply_to_user": {"reputation": 191, "user_id": 1283214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd1282bb9ade94a96b516c86585add3?s=128&d=identicon&r=PG", "display_name": "oarrivi", "link": "https://stackoverflow.com/users/1283214/oarrivi"}, "edited": false, "score": 0, "creation_date": 1499893767, "post_id": 45066956, "comment_id": 77108364, "body": "@oarrivi My code was with Navigation initiated in the Viewmodel, but changed it to this current example because I wasn&#39;t sure about it was a good practice. So, it is then?"}, {"owner": {"reputation": 191, "user_id": 1283214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd1282bb9ade94a96b516c86585add3?s=128&d=identicon&r=PG", "display_name": "oarrivi", "link": "https://stackoverflow.com/users/1283214/oarrivi"}, "edited": false, "score": 0, "creation_date": 1499894027, "post_id": 45066956, "comment_id": 77108473, "body": "I meant, navigation must be carried out by View Models. If you&#39;re wondering how a view model can access Navigation class, the answer is, they can&#39;t.  View Models manage navigation through a INavigationService which will be implemented by a view in charge of navigation. There are many NavigationService implementations in blogs and frameworks. All of them very similar. For example an implementation used in MVVM Light. Actually it is not part of this library, but the interface and its implementation is simple: <a href=\"http://www.mvvmlight.net/doc/nav1.cshtml\" rel=\"nofollow noreferrer\">mvvmlight.net/doc/nav1.cshtml</a>"}, {"owner": {"reputation": 191, "user_id": 1283214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd1282bb9ade94a96b516c86585add3?s=128&d=identicon&r=PG", "display_name": "oarrivi", "link": "https://stackoverflow.com/users/1283214/oarrivi"}, "edited": false, "score": 0, "creation_date": 1499894292, "post_id": 45066956, "comment_id": 77108630, "body": "@Mr_LinDowsMac, there is no problem using messages. But I believe message make code more complicated to read and maintain since is not easy to find out who and where is subscribing a message."}, {"owner": {"reputation": 2246, "user_id": 598070, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3122149fc9c817896970d8ed45f1f1e3?s=128&d=identicon&r=PG", "display_name": "Mr_LinDowsMac", "link": "https://stackoverflow.com/users/598070/mr-lindowsmac"}, "reply_to_user": {"reputation": 191, "user_id": 1283214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd1282bb9ade94a96b516c86585add3?s=128&d=identicon&r=PG", "display_name": "oarrivi", "link": "https://stackoverflow.com/users/1283214/oarrivi"}, "edited": false, "score": 0, "creation_date": 1499894980, "post_id": 45066956, "comment_id": 77108956, "body": "@oarrivi Fair. The only reason why I used Messages is because I can&#39;t implement a MVVM library at this point.   So, considering that I&#39;m not using a INavigationService, is it better (or less messy) to use <code>Navigation.Pushasync()</code> from viewmodel, or from the callback method after received message in the view?"}, {"owner": {"reputation": 191, "user_id": 1283214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd1282bb9ade94a96b516c86585add3?s=128&d=identicon&r=PG", "display_name": "oarrivi", "link": "https://stackoverflow.com/users/1283214/oarrivi"}, "edited": false, "score": 0, "creation_date": 1499945247, "post_id": 45066956, "comment_id": 77130781, "body": "INavigationService is not part of any library nor framework. You can implement it as suggested in link above."}], "owner": {"reputation": 2246, "user_id": 598070, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3122149fc9c817896970d8ed45f1f1e3?s=128&d=identicon&r=PG", "display_name": "Mr_LinDowsMac", "link": "https://stackoverflow.com/users/598070/mr-lindowsmac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1259, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499891964, "creation_date": 1499891343, "last_edit_date": 1499891964, "question_id": 45066956, "link": "https://stackoverflow.com/questions/45066956/using-messagingcenter-for-communicating-between-viewmodels-to-views-and-navigati", "title": "Using MessagingCenter for communicating between ViewModels to Views and Navigation", "body": "<p>In a XAML Page (A View), I have a bunch of controls like Pickers that are binded to a ViewModel, called \"NegotiationVM\"</p>\n\n<p>For example, I have a Picker binded to one of those properties \"NegotiatorSelected\" which returns an object \"Negotiator\". \nMy corcern is about a pair of buttons beside of that negotiator picker, are not binded to that Negotiation ViewModel or any Command, those buttons are for Adding or Editing a Negotiator. Since I'm trying to follow MVVM pattern (with no framework yet...) I would like to know what is the best practice here.</p>\n\n<p>My approach is in the First ViewModel create Commands that calls methods that send an instance of the child ViewModel to the View, so when this receive it, then navigates to the child View.</p>\n\n<pre><code>public class NegotiationVM: INotifyPropertyChanged{\n\n  public NegotiationVM{\n    AddNegotiatorCommand = new Command(AddNegotiator,()=&gt; !IsBusy);\n  }\n...\n  public void AddNegotiator(){\n    negotiatorvm = new NegotiatiorVM(_client)\n    MessagingCenter.Send&lt;NegotiationVM,NegotiatorVM&gt;(this,\"NegotiatiorVM\",negotiatiorvm)\n  }\n  public void EditNegotiator(){\n    negotiatorvm = new NegotiatiorVM(_client,_negotiatior)\n    MessagingCenter.Send&lt;NegotiationVM,NegotiatorVM&gt;(this,\"NegotiatiorVM\",negotiatiorvm)\n  }\n}\n</code></pre>\n\n<p>So in NegotiationView I do this:</p>\n\n<pre><code>&lt;!-- More controls binded to NegotiationVM --&gt;\n...\n&lt;!--  --&gt;\n&lt;Picker x:Name=\"pickerNegotiator\" Title=\"Select...\" ItemsSource=\"{Binding Negotiatorsofthisnegotiation}\" SelectedItem=\"{Binding SelectedNegotiator}\" /&gt;\n &lt;Button x:Name=\"btnAddNegotiator\" Text=\"\u2795\" BackgroundColor=\"#3276b1\"  TextColor=\"White\" HorizontalOptions=\"End\" WidthRequest=\"35\" Command=\"{Binding AddNegotiatorCommand}\" /&gt;\n&lt;Button x:Name=\"btnEditNegotiator\" Text=\"\ud83d\udcdd\" BackgroundColor=\"#3276b1\"  TextColor=\"White\" HorizontalOptions=\"End\" WidthRequest=\"35\"  Command=\"{Binding EditNegotiatorCommand}\" /&gt;\n&lt;!-- ... --&gt;             \n</code></pre>\n\n<p>and in code-behind:</p>\n\n<pre><code>...\npublic NegotiationView(){\n   negotiationvm = new NegotiationVM();\n   this.BindingContext = negotiationvm;\n   MessagingCenter.Subscribe&lt;NegotiationVM,NegociatorVM&gt;(this,\"NegotiatorVM\",AddEditNegotiator);\n}\n...\nvoid AddEditNegotiator(NegotiationVM arg1, NegotiatorVM vm)\n        {\n            NegotiatorPage negotiatorPage = new NegotiatorPage()\n            {\n                BindingContext = vm\n            };\n            Navigation.PushAsync(negotiatorPage);\n        }\n</code></pre>\n\n<p>So using MessagingCenter to communicate a ViewModel to a View in order to bind it to a child view and then Navigate to its view, is this a good practice considering that I'm not using any MVVM framework? Is this approach is making ViewModel from View decoupled enough? I read some comments that using MessagingCenter is not a good idea.</p>\n"}, {"tags": ["c#", "json", "json.net"], "answers": [{"comments": [{"owner": {"reputation": 2184, "user_id": 1711287, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/26fbb31363d43b10039d140b41e6fc57?s=128&d=identicon&r=PG", "display_name": "InTheWorldOfCodingApplications", "link": "https://stackoverflow.com/users/1711287/intheworldofcodingapplications"}, "edited": false, "score": 0, "creation_date": 1499891855, "post_id": 45066978, "comment_id": 77107436, "body": "Fantastic. Many thanks. I will mark it as answer as soon as SO let me do this. Thanks"}, {"owner": {"reputation": 15210, "user_id": 1364771, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wI3aU.jpg?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/1364771/jesse-carter"}, "reply_to_user": {"reputation": 2184, "user_id": 1711287, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/26fbb31363d43b10039d140b41e6fc57?s=128&d=identicon&r=PG", "display_name": "InTheWorldOfCodingApplications", "link": "https://stackoverflow.com/users/1711287/intheworldofcodingapplications"}, "edited": false, "score": 0, "creation_date": 1499891912, "post_id": 45066978, "comment_id": 77107468, "body": "np, glad that it helped :)"}], "tags": [], "owner": {"reputation": 15210, "user_id": 1364771, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wI3aU.jpg?s=128&g=1", "display_name": "Jesse Carter", "link": "https://stackoverflow.com/users/1364771/jesse-carter"}, "is_accepted": false, "score": 5, "last_activity_date": 1499891883, "last_edit_date": 1499891883, "creation_date": 1499891469, "answer_id": 45066978, "question_id": 45066930, "link": "https://stackoverflow.com/questions/45066930/deserialize-json-into-c-collection/45066978#45066978", "title": "Deserialize Json into C# Collection", "body": "<p>The JSON you've shown is an Object with a Property called Houses that contains your array. Note how the outer Json is surrounded by <code>{ }</code> and not <code>[ ]</code> which is why you're seeing that error. You'll need to select only the value of that property if you want to deserialize to a list of House. You can do that using JObject and then selecting the Houses property specifically.</p>\n\n<pre><code>var jobj = JObject.Parse(jSon);\nvar houses = JsonConvert.DeserializeObject&lt;List&lt;House&gt;&gt;(jobj[\"Houses\"].ToString());\n</code></pre>\n\n<p>Alternatively you could do:</p>\n\n<pre><code>var houses = JObject.Parse(jSon)[\"Houses\"].ToObject&lt;List&lt;House&gt;&gt;();\n</code></pre>\n\n<p>If you want to be able to map it in one step without using JObject you'd have to have another class that wraps your House list and maps directly to the JSON you've shown.</p>\n\n<pre><code>public class HouseList\n{\n    public List&lt;House&gt; Houses {get; set;}\n}\n</code></pre>\n\n<p>Given this object you'd be able to do</p>\n\n<pre><code>var houses = JsonConvert.DeserializeObject&lt;HouseList&gt;(jSon).Houses;\n</code></pre>\n"}], "owner": {"reputation": 2184, "user_id": 1711287, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/26fbb31363d43b10039d140b41e6fc57?s=128&d=identicon&r=PG", "display_name": "InTheWorldOfCodingApplications", "link": "https://stackoverflow.com/users/1711287/intheworldofcodingapplications"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3207, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499891883, "creation_date": 1499891259, "last_edit_date": 1499891624, "question_id": 45066930, "link": "https://stackoverflow.com/questions/45066930/deserialize-json-into-c-collection", "title": "Deserialize Json into C# Collection", "body": "<p>I want to deserialize json into collection of C# objects but getting following error:</p>\n\n<blockquote>\n  <p>{\"Cannot deserialize the current JSON object (e.g. {\\\"name\\\":\\\"value\\\"}) into type 'System.Collections.Generic.List`1 because the type requires a JSON array (e.g. [1,2,3]) to deserialize correctly.\\r\\nTo fix this error either change the JSON to a JSON array (e.g. [1,2,3]) or change the deserialized type so that it is a normal .NET type (e.g. not a primitive type like integer, not a collection type like an array or List) that can be deserialized from a JSON object. JsonObjectAttribute can also be added to the type to force it to deserialize from a JSON object.\\r\\nPath 'organizations', line 1, position 17.\"}</p>\n</blockquote>\n\n<p><strong>Code:</strong></p>\n\n<pre><code> var jSon = \"{\\\"Houses\\\":[{\\\"id\\\":\\\"123\\\",\\\"doorNumber\\\":22},\n                          {\\\"id\\\":\\\"456\\\",\\\"deniNumber\\\":99}\n            ]}\";\n        var temp = JsonConvert.DeserializeObject&lt;List&lt;House&gt;&gt;(jSon);\n    }\n\n\npublic class House\n{\n    public int Id { get; set; }\n\n    public int DoorNumber { get; set; }\n}\n</code></pre>\n"}, {"tags": ["c#", "android", "xamarin"], "comments": [{"owner": {"reputation": 937, "user_id": 5245420, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/10153152386520292/picture?type=large", "display_name": "Timothy James", "link": "https://stackoverflow.com/users/5245420/timothy-james"}, "edited": false, "score": 0, "creation_date": 1499896101, "post_id": 45066902, "comment_id": 77109416, "body": "Does this match your problems? <a href=\"https://stackoverflow.com/questions/31882051/numberpicker-showing-wrong-value-after-setvalue?rq=1\" title=\"numberpicker showing wrong value after setvalue\">stackoverflow.com/questions/31882051/&hellip;</a>"}, {"owner": {"reputation": 8446, "user_id": 7718924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQFOf.jpg?s=128&g=1", "display_name": "Eren Shen", "link": "https://stackoverflow.com/users/7718924/eren-shen"}, "edited": false, "score": 0, "creation_date": 1499920271, "post_id": 45066902, "comment_id": 77115509, "body": "Could you please post your complete code ?"}, {"owner": {"reputation": 21, "user_id": 8297711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfd7e1cef78641a696bce2c60294142?s=128&d=identicon&r=PG&f=1", "display_name": "Hoshisato", "link": "https://stackoverflow.com/users/8297711/hoshisato"}, "edited": false, "score": 0, "creation_date": 1499924490, "post_id": 45066902, "comment_id": 77116973, "body": "I&#39;ve added the complete code, note that this occurs in the OnCreateDialog, no manual data in inputted."}, {"owner": {"reputation": 21, "user_id": 8297711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfd7e1cef78641a696bce2c60294142?s=128&d=identicon&r=PG&f=1", "display_name": "Hoshisato", "link": "https://stackoverflow.com/users/8297711/hoshisato"}, "edited": false, "score": 0, "creation_date": 1499924976, "post_id": 45066902, "comment_id": 77117173, "body": "Timothy, the issue description is similar, the suggested solution doesn&#39;t seem to be applicable in my case as I do not use an ontouch handler"}, {"owner": {"reputation": 8446, "user_id": 7718924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQFOf.jpg?s=128&g=1", "display_name": "Eren Shen", "link": "https://stackoverflow.com/users/7718924/eren-shen"}, "edited": false, "score": 0, "creation_date": 1499928457, "post_id": 45066902, "comment_id": 77119048, "body": "Please post your <code>ReciprocityAdapter</code>&#39;s code, when I dont use it all works fine."}, {"owner": {"reputation": 21, "user_id": 8297711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfd7e1cef78641a696bce2c60294142?s=128&d=identicon&r=PG&f=1", "display_name": "Hoshisato", "link": "https://stackoverflow.com/users/8297711/hoshisato"}, "reply_to_user": {"reputation": 8446, "user_id": 7718924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQFOf.jpg?s=128&g=1", "display_name": "Eren Shen", "link": "https://stackoverflow.com/users/7718924/eren-shen"}, "edited": false, "score": 0, "creation_date": 1499967249, "post_id": 45066902, "comment_id": 77147324, "body": "@york-shen I added the adapter code, I use it for a cardview in a RecyclerView; in the dialog I use it to fetch the data I want to change."}, {"owner": {"reputation": 8446, "user_id": 7718924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQFOf.jpg?s=128&g=1", "display_name": "Eren Shen", "link": "https://stackoverflow.com/users/7718924/eren-shen"}, "edited": false, "score": 0, "creation_date": 1499994605, "post_id": 45066902, "comment_id": 77158876, "body": "I cant reproduce your problem, could you please share a simple demo to reproduce this problem?"}, {"owner": {"reputation": 21, "user_id": 8297711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfd7e1cef78641a696bce2c60294142?s=128&d=identicon&r=PG&f=1", "display_name": "Hoshisato", "link": "https://stackoverflow.com/users/8297711/hoshisato"}, "edited": false, "score": 0, "creation_date": 1500011609, "post_id": 45066902, "comment_id": 77163405, "body": "Here is a short video that I just recorded on my Android (7.0) phone that shows the issue: <a href=\"https://youtu.be/f9JQ6yaMMt4\" rel=\"nofollow noreferrer\">youtu.be/f9JQ6yaMMt4</a>"}, {"owner": {"reputation": 8446, "user_id": 7718924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQFOf.jpg?s=128&g=1", "display_name": "Eren Shen", "link": "https://stackoverflow.com/users/7718924/eren-shen"}, "edited": false, "score": 0, "creation_date": 1500538098, "post_id": 45066902, "comment_id": 77383820, "body": "It&#39;s a little difficult to reproduce your problem, would you mind sharing your basic demo? to make sure we are verifying the exact same thing you are using."}], "owner": {"reputation": 21, "user_id": 8297711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfd7e1cef78641a696bce2c60294142?s=128&d=identicon&r=PG&f=1", "display_name": "Hoshisato", "link": "https://stackoverflow.com/users/8297711/hoshisato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1499966990, "creation_date": 1499891138, "last_edit_date": 1499966990, "question_id": 45066902, "link": "https://stackoverflow.com/questions/45066902/numberpicker-displaying-incorrect-value", "title": "NumberPicker displaying incorrect value", "body": "<p>I have an issue with the NumberPicker with custom values. When opening the dialog, I fetch the value to display in the NumberPicker by finding its index in the array of custom values and setting the Value of the NumberPicker to this index. Tracing shows that the correct index is found and set in NumberPicker.Value; however, the NumberPicker shows the value of a different index. </p>\n\n<p>In the attached image, I have a value of 1/4 but it shows as 1/45. If I select a value of 1/6, it will show as 1/60. A value of 1, shows up as 1/1000. \nIf I select it, the correct index is held in the NumberPicker.Value so I get the desired value back, it is just that the display is confused and seems to pick something closely matching the desired value (1/45 for 1/4, 1/60 for 1/6, etc.) and ignoring the index in the array that I set. \nIf I select a value of 2, 3, etc. the correct value shows in the NumberPicker. </p>\n\n<p>Below is the the relevant code, the issue is both in simulator and on a real Android device. </p>\n\n<pre><code>public class MeasuredExposureDialog : Android.Support.V4.App.DialogFragment\n{\nprivate ReciprocityAdapter _mAdapter = null;\n\nprivate string[] shutterSpeeds = { \"1/1000\", \"1/750\", \"1/500\", \"1/350\", \"1/180\", \"1/125\", \"1/90\", \"1/60\", \"1/45\", \"1/30\", \"1/20\", \"1/15\", \"1/10\", \"1/8\", \"1/6\", **\"1/4\"**, \"1/3\", \"1/2\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"\n    , \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"17\", \"18\", \"19\", \"20\", \"21\", \"22\", \"23\", \"24\", \"25\", \"26\", \"27\", \"28\", \"29\", \"30\", \"31\", \"32\", \"33\", \"34\", \"35\", \"36\", \"37\", \"38\", \"39\", \"40\"\n    , \"41\", \"42\", \"43\", \"44\", \"45\", \"46\", \"47\", \"48\", \"49\", \"50\", \"51\", \"52\", \"53\", \"54\", \"55\", \"56\", \"57\", \"58\", \"59\", \"60\", \"61\", \"62\", \"63\", \"64\", \"65\", \"66\", \"67\", \"68\", \"69\", \"70\"\n    , \"71\", \"72\", \"73\", \"74\", \"75\", \"76\", \"77\", \"78\", \"79\", \"80\", \"81\", \"82\", \"83\", \"84\", \"85\", \"86\", \"87\", \"88\", \"89\", \"90\", \"91\", \"92\", \"93\", \"94\", \"95\", \"96\", \"97\", \"98\", \"99\", \"100\"\n    , \"101\", \"102\", \"103\", \"104\", \"105\", \"106\", \"107\", \"108\", \"109\", \"110\", \"111\", \"112\", \"113\", \"114\", \"115\", \"116\", \"117\", \"118\", \"119\", \"120\", \"121\", \"122\", \"123\", \"124\", \"125\", \"126\", \"127\", \"128\", \"129\", \"130\"\n    , \"131\", \"132\", \"133\", \"134\", \"135\", \"136\", \"137\", \"138\", \"139\", \"140\", \"141\", \"142\", \"143\", \"144\", \"145\", \"146\", \"147\", \"148\", \"149\", \"150\", \"151\", \"152\", \"153\", \"154\", \"155\", \"156\", \"157\", \"158\", \"159\", \"160\"\n    , \"161\", \"162\", \"163\", \"164\", \"165\", \"166\", \"167\", \"168\", \"169\", \"170\", \"171\", \"172\", \"173\", \"174\", \"175\", \"176\", \"177\", \"178\", \"179\", \"180\", \"181\", \"182\", \"183\", \"184\", \"185\", \"186\", \"187\", \"188\", \"189\", \"190\"\n    , \"191\", \"192\", \"193\", \"194\", \"195\", \"196\", \"197\", \"198\", \"199\", \"200\", \"201\", \"202\", \"203\", \"204\", \"205\", \"206\", \"207\", \"208\", \"209\", \"210\", \"211\", \"212\", \"213\", \"214\", \"215\", \"216\", \"217\", \"218\", \"219\", \"220\"\n};\n\npublic static MeasuredExposureDialog NewInstance(Bundle bundle)\n{\n    MeasuredExposureDialog fragment = new MeasuredExposureDialog();\n    fragment.Arguments = bundle;\n    return fragment;\n}\n\npublic ReciprocityAdapter Adapter\n{\n    set{ _mAdapter = value; }\n}\n\npublic override Dialog OnCreateDialog(Bundle savedInstanceState)\n    {\n        AlertDialog.Builder builder = new AlertDialog.Builder(Activity);\n        // Get the layout inflater\n        LayoutInflater inflater = Activity.LayoutInflater;\n\n        // Inflate and set the layout for the dialog\n        // Pass null as the parent view because its going in the dialog layout\n        View view = inflater.Inflate(Resource.Layout.numberpicker, null);\n        builder.SetView(view);\n        builder.SetTitle(\"Measured exposure\");\n\n        NumberPicker numberPicker = view.FindViewById&lt;NumberPicker&gt;(Resource.Id.numberPicker);\n        numberPicker.MaxValue = shutterSpeeds.Length - 1;\n        numberPicker.MinValue = 0;\n        numberPicker.SetDisplayedValues(shutterSpeeds);\n        numberPicker.WrapSelectorWheel = true;\n\n        string value = _mAdapter.GetEntrySetting(4);\n\n        Log.Info(\"myapp\", \"Setting stored value: \" + value);\n\n        for (int i = 0; i &lt; shutterSpeeds.Length; i++)\n        {\n            if (shutterSpeeds[i] == value)\n            {\n                numberPicker.Value = i;\n                Log.Info(\"myapp\", \"Setting value to index: \" + i);\n                break;\n            }\n        }\n\n        //numberPicker.ClearFocus();\n\n        // Add action buttons\n        builder.SetPositiveButton(\"Select\", (senderAlert, args) = &gt;\n        {\n            _mAdapter.SetEntry(4, shutterSpeeds[numberPicker.Value]);\n            _mAdapter.NotifyDataSetChanged();\n        });\n\n        builder.SetNegativeButton(\"Cancel\", (senderAlert, args) = &gt;\n        {\n        });\n\n        return builder.Create();\n    }\n}\n</code></pre>\n\n<p>The adapter code:</p>\n\n<pre><code>using Android.Content;\nusing Android.Graphics;\nusing Android.Support.V7.Widget;\nusing Android.Views;\nusing Android.Widget;\nusing System;\nusing System.Collections.Generic;\n\nnamespace Reciprocity.Fragments\n{\npublic class ReciprocityAdapter : RecyclerView.Adapter\n{\n    private View _itemView = null;\n    private List&lt;Entry&gt; _entryList;\n\n    public string GetEntrySetting(int position)\n    {\n        return _entryList[position].setting;\n    }\n\n    public void StoreEnvironment()\n    {\n        //store\n        var prefs = Android.App.Application.Context.GetSharedPreferences(\"Reciprocity2\", FileCreationMode.Private);\n        var prefEditor = prefs.Edit();\n\n        if (_entryList[0].setting != \"Tap to select a film\")\n            prefEditor.PutString(\"selectedFilm\", _entryList[0].setting);\n\n        prefEditor.PutString(\"measuredSeconds\", _entryList[4].setting);\n\n        prefEditor.PutBoolean(\"useBGR\", true);\n\n        prefEditor.PutString(\"filterFactor\", _entryList[1].setting);\n        prefEditor.PutString(\"lensExtension\", _entryList[3].setting);\n        prefEditor.PutString(\"focalLength\", _entryList[2].setting);\n\n        prefEditor.Commit();\n    }\n\n    public void RestoreEnvironment()\n    {\n        var prefs = Android.App.Application.Context.GetSharedPreferences(\"Reciprocity2\", FileCreationMode.Private);\n        var selectedFilm = prefs.GetString(\"selectedFilm\", null);\n\n        if (selectedFilm != null)\n        {\n            _entryList[0].setting = selectedFilm;\n        }\n\n        _entryList[4].setting = prefs.GetString(\"measuredSeconds\", \"Tap to select\");\n        _entryList[1].setting = prefs.GetString(\"filterFactor\", \"Tap to select\");\n        _entryList[3].setting = prefs.GetString(\"lensExtension\", \"Tap to select\");\n        _entryList[2].setting = prefs.GetString(\"focalLength\", \"Tap to select\");\n    }\n\n    public ReciprocityAdapter(List&lt;Entry&gt; entries)\n    {\n        _entryList = entries;\n    }\n\n    public override RecyclerView.ViewHolder OnCreateViewHolder(ViewGroup parent, int viewType)\n    {\n        // Inflate the CardView for the photo:\n        _itemView = LayoutInflater.From(parent.Context).Inflate(Resource.Layout.cardview, parent, false);\n\n        // Create a ViewHolder to hold view references inside the CardView:\n        ReciprocityViewHolder vh = new ReciprocityViewHolder(_itemView, OnClick);\n\n        return vh;\n    }\n\n    public override void OnBindViewHolder(RecyclerView.ViewHolder holder, int position)\n    {\n        ReciprocityViewHolder vh = holder as ReciprocityViewHolder;\n\n        vh.category.Text = _entryList[position].category;\n        vh.setting.Text = _entryList[position].setting;\n\n        vh.image.SetImageResource(_entryList[position].colorbar);\n        vh.image.SetAdjustViewBounds(true);\n\n        CardView cv = vh.ItemView.FindViewById&lt;CardView&gt;(Resource.Id.cv);\n        cv.SetCardBackgroundColor((position == 5) ? Color.Yellow : Color.White);\n    }\n\n    private void OnClick(int position)\n    {\n        if (ItemClick != null)\n            ItemClick(this, position);\n    }\n\n    public override int ItemCount\n    {\n        get\n        {\n            return _entryList.Count;\n        }\n    }\n\n    public event EventHandler&lt;int&gt; ItemClick;\n}\n\npublic class ReciprocityViewHolder : RecyclerView.ViewHolder\n{\n    public ImageView image { get; private set; }\n    public TextView category { get; private set; }\n    public TextView setting { get; private set; }\n\n    public ReciprocityViewHolder(View itemView, Action&lt;int&gt; listener)\n        : base(itemView)\n    {\n        image = itemView.FindViewById&lt;ImageView&gt;(Resource.Id.colorBar);\n        setting = itemView.FindViewById&lt;TextView&gt;(Resource.Id.reciprocitySetting);\n        category = itemView.FindViewById&lt;TextView&gt;(Resource.Id.reciprocityCategory);\n\n        itemView.Click += (sender, e) =&gt; listener(base.AdapterPosition);\n    }\n}\n</code></pre>\n\n<p>The XML:\n</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:padding=\"16dp\"&gt;\n    &lt;Space\n        android:layout_width=\"1dp\"\n        android:layout_height=\"10dp\" /&gt;\n    &lt;NumberPicker\n        android:id=\"@+id/numberPicker\"\n        android:textAppearance=\"?android:attr/textAppearanceMedium\"\n        android:layout_height=\"wrap_content\"\n        android:layout_width=\"wrap_content\"\n        android:layout_gravity=\"top|center_horizontal\"\n        android:descendantFocusability=\"blocksDescendants\"\n        android:gravity=\"center\" /&gt;\n    &lt;Space\n        android:layout_width=\"1dp\"\n        android:layout_height=\"15dp\" /&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n\n<p>The output is the following:</p>\n\n<pre><code>Setting stored value: 1/4\nSetting value to index: 15\n</code></pre>\n\n<p>The way it shows up in the dialog:</p>\n\n<p><img src=\"https://i.stack.imgur.com/KiBcl.png\" alt=\"screen\"></p>\n\n<p>Any idea what is going on?</p>\n"}, {"tags": ["javascript", "c#", "jquery", "asp.net"], "answers": [{"comments": [{"owner": {"reputation": 2347, "user_id": 2564920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ae813d9d045bf8ec50264f8be7b026?s=128&d=identicon&r=PG", "display_name": "Alan Tsai", "link": "https://stackoverflow.com/users/2564920/alan-tsai"}, "reply_to_user": {"reputation": 41, "user_id": 3147594, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/7a0ae23ca71574a98cf3e0ab5ffb9172?s=128&d=identicon&r=PG&f=1", "display_name": "user3147594", "link": "https://stackoverflow.com/users/3147594/user3147594"}, "edited": false, "score": 0, "creation_date": 1499999601, "post_id": 45072729, "comment_id": 77160031, "body": "@user3147594 glad you got it sorted.  Kindly reminder if it solved your answer please mark as answer so that future reader can see it clearly."}], "tags": [], "owner": {"reputation": 2347, "user_id": 2564920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ae813d9d045bf8ec50264f8be7b026?s=128&d=identicon&r=PG", "display_name": "Alan Tsai", "link": "https://stackoverflow.com/users/2564920/alan-tsai"}, "is_accepted": false, "score": 0, "last_activity_date": 1499926514, "creation_date": 1499926514, "answer_id": 45072729, "question_id": 45066895, "link": "https://stackoverflow.com/questions/45066895/javascript-issue-unable-to-postback-on-save-button-click-in-asp-net/45072729#45072729", "title": "Javascript issue: Unable to postback on save button click in ASP.NET", "body": "<p>It seems like a common issue with the validator.</p>\n\n<p>The validator error is suppose to clear out when lose focus to the textbox</p>\n\n<p>however, apparently if your validator <code>Display</code> is set to <code>Dynamic</code>, when the error message appear, it will cause the triggering clearing the validator error to fail.</p>\n\n<p>hence the clicking twice (first click trigger clear error which should have been trigger earlier but failed, second trigger actual form post)</p>\n\n<p>solution is to change your RequiredFieldValidator <code>Display</code> to <code>Static</code></p>\n\n<p>more info checkout </p>\n\n<p><a href=\"https://stackoverflow.com/questions/11121725/requiredfieldvalidator-have-to-click-twice\">RequiredFieldValidator have to click twice</a><br>\n<a href=\"https://stackoverflow.com/questions/7086471/requiredfieldvalidator-requires-user-to-click-twice\">RequiredFieldValidator requires user to click twice</a></p>\n"}], "owner": {"reputation": 41, "user_id": 3147594, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/7a0ae23ca71574a98cf3e0ab5ffb9172?s=128&d=identicon&r=PG&f=1", "display_name": "user3147594", "link": "https://stackoverflow.com/users/3147594/user3147594"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499926514, "creation_date": 1499891101, "last_edit_date": 1499893012, "question_id": 45066895, "link": "https://stackoverflow.com/questions/45066895/javascript-issue-unable-to-postback-on-save-button-click-in-asp-net", "title": "Javascript issue: Unable to postback on save button click in ASP.NET", "body": "<p>I have a textbox and save button on a pop-up, the textbox has a required field validator. I have a scenario, if the user accidentally forgets to enter data in the textbox and click save the required field validator kicks in, which is expected. But, now if the user enters data in the textbox and clicks on 'save', the record doesn't get saved on the first click instead it needs an additional click. I know the reason for this: it is not doing a postback when the button is clicked for first time, but for the second time it does and saves the data. </p>\n\n<p>Does anyone know the workaround for this? The end user is getting annoyed by that additional click. Please note there is no javascript function associated with it. It is autogenerated javascript from the browser.</p>\n\n<p>Code:</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n                                &lt;div class=\"col-md-12\"&gt;\n                                    &lt;div class=\"form-group\"&gt;\n                                        &lt;asp:Label runat=\"server\" Text=\"\" AssociatedControlID=\"txtTitle\"&gt;\n                                                    Title&lt;span class=\"text-danger\"&gt;*&lt;/span&gt;\n                                        &lt;/asp:Label&gt;\n                                        &lt;asp:TextBox runat=\"server\" CssClass=\"form-control\" ID=\"txtTitle\" &gt;\n                                        &lt;/asp:TextBox&gt;\n                                        &lt;asp:RequiredFieldValidator runat=\"server\" ControlToValidate=\"txtTitle\" Display=\"Dynamic\" ErrorMessage=\"Required\" ValidationGroup=\"questionTitle\" CssClass=\"text-danger\"&gt;\n                                        &lt;/asp:RequiredFieldValidator&gt;                \n                                    &lt;/div&gt;\n                                &lt;/div&gt;\n                            &lt;/div&gt;\n</code></pre>\n\n<p>Save button:</p>\n\n<pre><code> &lt;div class=\"row\"&gt;\n\n\n&lt;div class=\"col-md-3 col-md-offset-9\"&gt;\n                                &lt;asp:LinkButton runat=\"server\" ID=\"lnkSave\" CssClass=\"btn btn-lg btn-block btn-success btn-lg\" role=\"button\" ValidationGroup=\"questionTitle\" OnClick=\"lnkSave_Click\"&gt;\n                            &lt;i class=\"fa fa-floppy-o\"&gt;&lt;/i&gt;&amp;nbsp;Save\n                                &lt;/asp:LinkButton&gt;\n                            &lt;/div&gt;\n                        &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml"], "answers": [{"tags": [], "owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "is_accepted": true, "score": 0, "last_activity_date": 1499890904, "creation_date": 1499890904, "answer_id": 45066847, "question_id": 45066819, "link": "https://stackoverflow.com/questions/45066819/datatemplate-binding-to-multiple-object-properties/45066847#45066847", "title": "DataTemplate Binding to multiple object properties", "body": "<pre><code>b.Content = myTableItem;\n</code></pre>\n\n<p>It's the <code>ContentTemplate</code>.  It's a template for the <code>Content</code>. </p>\n"}], "owner": {"reputation": 879, "user_id": 935836, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/04682003f2a172b41429eb9a24636de5?s=128&d=identicon&r=PG", "display_name": "davor", "link": "https://stackoverflow.com/users/935836/davor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 45066847, "answer_count": 1, "score": 1, "last_activity_date": 1499890935, "creation_date": 1499890803, "last_edit_date": 1499890935, "question_id": 45066819, "link": "https://stackoverflow.com/questions/45066819/datatemplate-binding-to-multiple-object-properties", "title": "DataTemplate Binding to multiple object properties", "body": "<p>I'm using button styling, with data template, and having problem with showing text (Name and Number properties of my Table objects).</p>\n\n<p>This is xaml:</p>\n\n<pre><code>&lt;Style x:Key=\"btnTable\" TargetType=\"{x:Type Button}\" &gt;\n        &lt;Setter Property=\"Background\" Value=\"Transparent\" /&gt;\n        &lt;Setter Property=\"ContentTemplate\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;DataTemplate DataType=\"{x:Type my:Tables}\"&gt;\n                    &lt;Grid&gt;\n                        &lt;Image VerticalAlignment=\"Center\" Source=\"/Images/Ico/table-40x40.png\" /&gt;\n                        &lt;TextBlock Text=\"{Binding Path=Naziv}\" /&gt;\n                        &lt;Ellipse Canvas.Top=\"30\" Canvas.Left=\"30\" Fill=\"#FF6A4E8C\" /&gt;\n                        &lt;TextBlock Text=\"{Binding Number}\" /&gt;\n                    &lt;/Grid&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p>Then, in .cs I create buttons like this:</p>\n\n<pre><code>    Button b = new Button();\n    Style myStyle = (Style)Resources[\"btnTable\"];\n    b.Style = myStyle;\n    b.DataContext = myTableItem;\n</code></pre>\n\n<p>If I test buttons click event, it has in DataContext property valid Table object.</p>\n\n<p>I have tried replacing Binding Path width Binding Path=DataContext.Name, adding RelativeSource=Self, but nothing helps.</p>\n\n<p>Additionally, I tried creating buttons using ItemsControl, but have the same issue.</p>\n"}, {"tags": ["c#", "visual-studio", "debugging", "silverlight"], "answers": [{"comments": [{"owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "edited": false, "score": 0, "creation_date": 1499967378, "post_id": 45071521, "comment_id": 77147398, "body": "Thanks @pawellukasik!"}], "tags": [], "owner": {"reputation": 3177, "user_id": 4832634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153157104716597/picture?type=large", "display_name": "Pawe\u0142 \u0141ukasik", "link": "https://stackoverflow.com/users/4832634/pawe%c5%82-%c5%81ukasik"}, "is_accepted": true, "score": 2, "last_activity_date": 1499920796, "creation_date": 1499920796, "answer_id": 45071521, "question_id": 45066817, "link": "https://stackoverflow.com/questions/45066817/in-visual-studio-2015-how-do-i-determine-what-object-caused-a-null-exception/45071521#45071521", "title": "In Visual Studio 2015+, how do I determine what object caused a null exception?", "body": "<p>What you can do is to turn on the setting that Visual Studio will break when <code>NullReferenceException</code> is thrown and not only when it's unhandled. </p>\n\n<p>To do that, go to <code>Debug-&gt;Windows-&gt;Exception settings</code> window, filter for <code>NullReferenceException</code> and tick the checkbox for in the <code>Common Language Runtime Exceptions</code> section.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ink10.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ink10.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 20718, "user_id": 856790, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Jlqsh.jpg?s=128&g=1", "display_name": "Matt Cashatt", "link": "https://stackoverflow.com/users/856790/matt-cashatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 45071521, "answer_count": 1, "score": 2, "last_activity_date": 1499920796, "creation_date": 1499890797, "question_id": 45066817, "link": "https://stackoverflow.com/questions/45066817/in-visual-studio-2015-how-do-i-determine-what-object-caused-a-null-exception", "title": "In Visual Studio 2015+, how do I determine what object caused a null exception?", "body": "<p>Thanks for looking. I am debugging a Silverlight project and and it is throwing a null exception that is reported to the DOM. Unfortunately, I have no idea where in the codebase that the exception is being thrown. </p>\n\n<p>I can catch the exception in the class file to view more details about it, but it still isn't clear where about what value is null or where it is.</p>\n\n<p>How do I determine the object and location of the object that is causing the null exception?</p>\n\n<p>Here is the error message that Silverlight returns to the DOM for those that are interested:</p>\n\n<blockquote>\n  <p>Error: Unhandled Error in Silverlight Application  Code: 4004<br>\n  Category: ManagedRuntimeError        Message:\n  System.ArgumentNullException: Value cannot be null. Parameter name:\n  source    at\n  System.Runtime.CompilerServices.AsyncServices.b__0(Object\n  state)</p>\n</blockquote>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "unity-container", "prism-6"], "comments": [{"owner": {"reputation": 8732, "user_id": 1874522, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1BXUD.png?s=128&g=1", "display_name": "peinearydevelopment", "link": "https://stackoverflow.com/users/1874522/peinearydevelopment"}, "edited": false, "score": 1, "creation_date": 1499894619, "post_id": 45066808, "comment_id": 77108779, "body": "From the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.practices.unity.unitycontainerextensions.registertype(v=pandp.51).aspx\" rel=\"nofollow noreferrer\">documentation</a> it would seem as though in the one that is working you are telling the container the from and to type, but in the one that isn&#39;t working, you are only providing the to type. I would guess that <code>_unityContainer.RegisterType&lt;Object, AppContainer&gt;(InstanceNames.AppContainer);</code> would also work."}, {"owner": {"reputation": 844, "user_id": 1871495, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dbebc43ddbac000aaa0114c17506cc57?s=128&d=identicon&r=PG", "display_name": "Moe45673", "link": "https://stackoverflow.com/users/1871495/moe45673"}, "reply_to_user": {"reputation": 8732, "user_id": 1874522, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1BXUD.png?s=128&g=1", "display_name": "peinearydevelopment", "link": "https://stackoverflow.com/users/1874522/peinearydevelopment"}, "edited": false, "score": 0, "creation_date": 1499895588, "post_id": 45066808, "comment_id": 77109226, "body": "@peinearydevelopment Thanks! That actually works. So it&#39;s the From -&gt; To snip that was the problem. Now I just need to refresh my memory on why the From parameter is important :p"}, {"owner": {"reputation": 22227, "user_id": 114664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a8N3P.jpg?s=128&g=1", "display_name": "Randy supports Monica", "link": "https://stackoverflow.com/users/114664/randy-supports-monica"}, "edited": false, "score": 1, "creation_date": 1499929554, "post_id": 45066808, "comment_id": 77119713, "body": "<code>IUnityContainer.RegisterType</code> is implemented via the <code>UnityContainerExtensions.RegisterType</code> method so they are functionally equivalent.  You could also do something like <code>_unityContainer.RegisterType(typeof(Object), typeof(AppContainer), InstanceNames.AppContainer);</code>"}], "owner": {"reputation": 844, "user_id": 1871495, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dbebc43ddbac000aaa0114c17506cc57?s=128&d=identicon&r=PG", "display_name": "Moe45673", "link": "https://stackoverflow.com/users/1871495/moe45673"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499890767, "creation_date": 1499890767, "question_id": 45066808, "link": "https://stackoverflow.com/questions/45066808/difference-between-iunitycontainer-registertype-and-unitycontainerextensions-r", "title": "Difference between IUnityContainer.RegisterType() and UnityContainerExtensions.RegisterType()?", "body": "<p>I am running a WPF Application using Prism and Unity for DI. I have a Shell: MainWindow.xaml, A Container: AppContainer.xaml, and the startup view: StartupView.xaml.</p>\n\n<p>MainWindow.xaml</p>\n\n<pre><code>&lt;Window x:Class=\"App.Views.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:prism=\"http://prismlibrary.com/\"\n...\n...\n...\n&gt;\n\n    &lt;Grid Background=\"Transparent\"&gt;\n\n        &lt;ContentControl x:Name=\"ContainerRegion\"\n                               prism:RegionManager.RegionName=\"ContainerRegion\"/&gt;\n\n    &lt;/Grid&gt;\n\n&lt;/Window&gt;\n</code></pre>\n\n<p>AppContainer.xaml</p>\n\n<pre><code>&lt;UserControl x:Class=\"App.Views.AppContainer\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:prism=\"http://prismlibrary.com/\"\n             prism:ViewModelLocator.AutoWireViewModel=\"True\"\n...\n...\n...\n&gt;\n\n    &lt;Grid&gt;\n        &lt;ContentControl x:Name=\"MainViewRegion\"\n                               prism:RegionManager.RegionName=\"MainViewRegion\" /&gt;\n\n\n\n    &lt;/Grid&gt;\n\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>The StartupView.xaml code is not relevant.</p>\n\n<p>I instantiate the shell in the bootstrapper. I added an AppContainerModule. Here is the initialize():</p>\n\n<pre><code>public override void Initialize()\n        {\n\n            UnityContainerExtensions.RegisterType(_unityContainer, typeof(Object), typeof(AppContainer), InstanceNames.AppContainer); //InstanceNames is a static class of \"magic\" strings\n\n            IRegion mviewRegion = _regionManager.Regions[RegionNames.ContainerRegion]; //ContainerRegion is the Region declared in MainWindow.xaml\n\n            if (mviewRegion == null) return;\n\n\n            _regionManager.RequestNavigate(RegionNames.ContainerRegion, new Uri(InstanceNames.AppContainer, UriKind.Relative));\n\n    }\n</code></pre>\n\n<p>Here is my StartupViewModule.Initialize()</p>\n\n<pre><code>public override void Initialize()\n        {\n\n            UnityContainerExtensions.RegisterType(_unityContainer, typeof(object), typeof(StartupView), InstanceNames.StartupView);\n\n\n\n            IRegion mviewRegion = _regionManager.Regions[RegionNames.MainViewRegion]; //MainViewRegion is declared in AppContainer.xaml\n\n            if (mviewRegion == null) return;\n\n\n            _regionManager.RequestNavigate(RegionNames.MainViewRegion, new Uri(InstanceNames.StartupView, UriKind.Relative));\n\n        }\n</code></pre>\n\n<p>In a small diagram:</p>\n\n<pre><code>MainWindow.xaml -&gt; [ContainerRegion]\n                           |\n                           |\n                           \\/\n                    AppContainer.xaml -&gt; [MainViewRegion]\n                                                |\n                                                |\n                                                \\/\n                                          StartupView.xaml\n</code></pre>\n\n<p>I used the [ModuleDependency] Attributes to ensure that StartupView is Initialized after AppContainer. </p>\n\n<p>The above code works, btw!</p>\n\n<p>My question is regarding the prior code I had before stumbling upon this solution. I was getting a crash upon launch with the error that prism could not find the MainViewRegion when StartupView was trying to inject itself (during StartupViewModule.Initialize() ). Changing the code to the above worked. What didn't work was the following in <strong>AppContainerModule</strong></p>\n\n<pre><code>_unityContainer.RegisterType&lt;AppContainer&gt;(InstanceNames.AppContainer);\n</code></pre>\n\n<p>Again, what did work was this: </p>\n\n<pre><code>UnityContainerExtensions.RegisterType(_unityContainer, typeof(Object), typeof(AppContainer), InstanceNames.AppContainer); \n</code></pre>\n\n<p>So my question is, why?</p>\n"}, {"tags": ["c#", "elasticsearch", "bulk-load"], "comments": [{"owner": {"reputation": 1644, "user_id": 1943682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc020bfb9a4ea293faf8753c9c116ed?s=128&d=identicon&r=PG", "display_name": "alr", "link": "https://stackoverflow.com/users/1943682/alr"}, "edited": false, "score": 0, "creation_date": 1499895631, "post_id": 45066769, "comment_id": 77109240, "body": "please share more information from the server side. What does crashing mean? Is hte process vanishing? Is the server still responding but just slow? Do you find anything in the log files on the Elasticsearch side?"}, {"owner": {"reputation": 131, "user_id": 6376244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a21f488d85daa19ee5a343e8b880ec28?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6376244/paul"}, "reply_to_user": {"reputation": 1644, "user_id": 1943682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc020bfb9a4ea293faf8753c9c116ed?s=128&d=identicon&r=PG", "display_name": "alr", "link": "https://stackoverflow.com/users/1943682/alr"}, "edited": false, "score": 0, "creation_date": 1499961658, "post_id": 45066769, "comment_id": 77144014, "body": "Added requested information"}, {"owner": {"reputation": 131, "user_id": 6376244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a21f488d85daa19ee5a343e8b880ec28?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6376244/paul"}, "reply_to_user": {"reputation": 1644, "user_id": 1943682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc020bfb9a4ea293faf8753c9c116ed?s=128&d=identicon&r=PG", "display_name": "alr", "link": "https://stackoverflow.com/users/1943682/alr"}, "edited": false, "score": 0, "creation_date": 1500387015, "post_id": 45066769, "comment_id": 77306452, "body": "So I guess no one even has a suggestion?  I am new at using elastic, but I am not impressed with it&#39;s performance, documentation, or usage.  If anyone reads, I would not recommend this product."}, {"owner": {"reputation": 1644, "user_id": 1943682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc020bfb9a4ea293faf8753c9c116ed?s=128&d=identicon&r=PG", "display_name": "alr", "link": "https://stackoverflow.com/users/1943682/alr"}, "edited": false, "score": 0, "creation_date": 1500447596, "post_id": 45066769, "comment_id": 77334126, "body": "the information is still not sufficient. There are no full stack traces for example. My assumption is, that you are trying to load many bulk requests (or big bulk requests) in parallel with not enough heap, but that is hard to tell, is we dont know the size of the whole bulk request."}], "owner": {"reputation": 131, "user_id": 6376244, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a21f488d85daa19ee5a343e8b880ec28?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6376244/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499959701, "creation_date": 1499890611, "last_edit_date": 1499959701, "question_id": 45066769, "link": "https://stackoverflow.com/questions/45066769/elastic-search-5-3-crashes-when-bulk-loading-data-c", "title": "Elastic Search 5.3 crashes when bulk loading data C#", "body": "<p>I have been bulk loading data into a development elastic search server for a awhile. I am using C# to program with and the elastic search server is running on a Windows 2012 R2 Server.  The elastic search server consistently goes down during the bulk load process  I am the only one attaching to the server, so it is not an issue of two people trying to access or insert the same data.  I do not know why this is happening and can't seem to google something that would apply to my situation.  By crashing I mean the service stops(errors out) and restarts.</p>\n\n<p>Here is the code I am using. (I originally had it set too 1000 but reduced because it wouldn't load at all)</p>\n\n<pre><code>        var waitHandle = new System.Threading.CountdownEvent(1);\n        var response = _client.BulkAll(employees, b =&gt; b.Index(indexName)\n            .BackOffRetries(3)\n            .BackOffTime(\"30s\")\n            .RefreshOnCompleted(true)\n            .MaxDegreeOfParallelism(4)\n            .Size(100)\n        );\n\n        response.Subscribe(new BulkAllObserver(\n            onNext: (b) =&gt; { RaiseMessageEvent(\".\"); },\n            onError: (e) =&gt; {  throw e;  },\n            onCompleted: () =&gt; waitHandle.Signal()\n        ));\n</code></pre>\n\n<p>Windows Event Viewer (Error): </p>\n\n<pre><code>        The Elasticsearch 5.3.0 (elasticsearch-service-x64) service\n        terminated unexpectedly.  It has done this 1 time(s).  The\n        following corrective action will be taken in 60000 \n        milliseconds: Restart the service.\n</code></pre>\n\n<p>Elastic Search Server Log:</p>\n\n<pre><code>[2017-07-13T11:06:58,068][ERROR][o.e.t.n.Netty4Utils] \nfatal error on the network layer\nat org.elasticsearch.transport.netty4.Netty4Utils.maybeDie\n(Netty4Utils.java:140)....\n\n[2017-07-13T11:06:59,943][WARN ][o.e.m.j.JvmGcMonitorService] \n[lm52Lqe] [gc][5070] overhead, spent [1.8s] collecting in the \nlast [1.8s]...\n\n[2017-07-13T11:07:00,052][WARN ][o.e.h.n.Netty4HttpServerTransport]\n[lm52Lqe] caught exception while handling client http traffic, \nclosing connection [id: 0x14bf2d5c, L:/192.168.2.75:9200 - \nR:/10.2.0.70:59266]\njava.lang.OutOfMemoryError: Java heap space...\n\n[2017-07-13T11:06:58,079][ERROR]\n[o.e.b.ElasticsearchUncaughtExceptionHandler] \n[] fatal error in thread [Thread-62], exiting\njava.lang.OutOfMemoryError: Java heap space ...\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "file-upload"], "comments": [{"owner": {"reputation": 9116, "user_id": 813523, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/80566534177eef1ed8ef0931ca52fc4b?s=128&d=identicon&r=PG", "display_name": "Scott Selby", "link": "https://stackoverflow.com/users/813523/scott-selby"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1499890406, "post_id": 45066700, "comment_id": 77106747, "body": "@maccettura - you are wrong , it always goes by name"}, {"owner": {"reputation": 99, "user_id": 3169071, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/47b22574c21a2b9719019204db5d5a19?s=128&d=identicon&r=PG&f=1", "display_name": "Waheed Asghar", "link": "https://stackoverflow.com/users/3169071/waheed-asghar"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 1, "creation_date": 1499890452, "post_id": 45066700, "comment_id": 77106769, "body": "@maccettura  I am sure it goes by name .. I tried with Id as well just to be sure didn&#39;t help ."}, {"owner": {"reputation": 9116, "user_id": 813523, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/80566534177eef1ed8ef0931ca52fc4b?s=128&d=identicon&r=PG", "display_name": "Scott Selby", "link": "https://stackoverflow.com/users/813523/scott-selby"}, "edited": false, "score": 1, "creation_date": 1499890639, "post_id": 45066700, "comment_id": 77106851, "body": "<a href=\"https://stackoverflow.com/questions/22623947/asp-net-mvc-5-image-upload-to-folder\" title=\"asp net mvc 5 image upload to folder\">stackoverflow.com/questions/22623947/&hellip;</a>"}, {"owner": {"reputation": 99, "user_id": 3169071, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/47b22574c21a2b9719019204db5d5a19?s=128&d=identicon&r=PG&f=1", "display_name": "Waheed Asghar", "link": "https://stackoverflow.com/users/3169071/waheed-asghar"}, "reply_to_user": {"reputation": 9116, "user_id": 813523, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/80566534177eef1ed8ef0931ca52fc4b?s=128&d=identicon&r=PG", "display_name": "Scott Selby", "link": "https://stackoverflow.com/users/813523/scott-selby"}, "edited": false, "score": 0, "creation_date": 1499890862, "post_id": 45066700, "comment_id": 77106952, "body": "@ScottSelby I believe I have not missed anything explained in that link. If you can see any please let me know."}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1499891093, "post_id": 45066700, "comment_id": 77107055, "body": "Side note, you should post code and not pictures of code.  This does nothing to help future users that have similar problems."}, {"owner": {"reputation": 99, "user_id": 3169071, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/47b22574c21a2b9719019204db5d5a19?s=128&d=identicon&r=PG&f=1", "display_name": "Waheed Asghar", "link": "https://stackoverflow.com/users/3169071/waheed-asghar"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1499891479, "post_id": 45066700, "comment_id": 77107258, "body": "@maccettura that qualifies for down vote"}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1499892242, "post_id": 45066700, "comment_id": 77107617, "body": "Yeah, your question is not formatted correctly so I downvoted.  Post your code and I&#39;ll undo"}, {"owner": {"reputation": 99, "user_id": 3169071, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/47b22574c21a2b9719019204db5d5a19?s=128&d=identicon&r=PG&f=1", "display_name": "Waheed Asghar", "link": "https://stackoverflow.com/users/3169071/waheed-asghar"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1499892585, "post_id": 45066700, "comment_id": 77107767, "body": "@maccettura Done."}], "answers": [{"tags": [], "owner": {"reputation": 1469, "user_id": 3397630, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001259654258/picture?type=large", "display_name": "Karthik Elumalai", "link": "https://stackoverflow.com/users/3397630/karthik-elumalai"}, "is_accepted": false, "score": 0, "last_activity_date": 1499913323, "creation_date": 1499913323, "answer_id": 45070529, "question_id": 45066700, "link": "https://stackoverflow.com/questions/45066700/mvc-file-is-not-being-posted-back/45070529#45070529", "title": "MVC File is not being Posted back", "body": "<p>Its seems your code is correct, anyway try this way in the controller. It might helpful for you:</p>\n\n<pre><code> public ActionResult EditProfile(Contact model, string currentPassword, string CurrentPasswordQ, string newPassword, string loginPwd, string currentPinQ, string newPin, int? selectedQuestion, string answer, bool pwdChange = false, bool questionChange = false, bool pinChange = false)\n    {\n\nif (Request.Files != null &amp;&amp; Request.Files.Count &gt; 0)\n{\n    HttpPostedFileBase file = Request.Files[0];\n    if (file != null &amp;&amp; file.ContentLength &gt; 0)\n    {\n             //other logic\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>Source: <a href=\"https://stackoverflow.com/a/32219011/3397630\">https://stackoverflow.com/a/32219011/3397630</a></p>\n"}, {"tags": [], "owner": {"reputation": 408, "user_id": 3488758, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/ACHpv.jpg?s=128&g=1", "display_name": "Shahzad Khan", "link": "https://stackoverflow.com/users/3488758/shahzad-khan"}, "is_accepted": false, "score": 0, "last_activity_date": 1499925653, "creation_date": 1499925653, "answer_id": 45072511, "question_id": 45066700, "link": "https://stackoverflow.com/questions/45066700/mvc-file-is-not-being-posted-back/45072511#45072511", "title": "MVC File is not being Posted back", "body": "<p>Please follow the below steps.</p>\n\n<p>Step :- 1</p>\n\n<pre><code>@using (Html.BeginForm(\"FileUpload\", \"Home\", FormMethod.Post, \n                            new { enctype = \"multipart/form-data\" }))\n{  \n    &lt;label for=\"file\"&gt;Upload Image:&lt;/label&gt; \n    &lt;input type=\"file\" name=\"file\" id=\"file\" style=\"width: 100%;\" /&gt; \n    &lt;input type=\"submit\" value=\"Upload\" class=\"submit\" /&gt; \n}\n</code></pre>\n\n<p>Step :- 2</p>\n\n<pre><code> public ActionResult FileUpload(HttpPostedFileBase file)\n    {\n        if (file != null)\n        {\n            string pic = System.IO.Path.GetFileName(file.FileName);\n            string path = System.IO.Path.Combine(\n                                   Server.MapPath(\"~/images/profile\"), pic); \n            // file is uploaded\n            file.SaveAs(path);\n\n            // save the image path path to the database or you can send image \n            // directly to database\n            // in-case if you want to store byte[] ie. for DB\n            using (MemoryStream ms = new MemoryStream()) \n            {\n                 file.InputStream.CopyTo(ms);\n                 byte[] array = ms.GetBuffer();\n            }\n\n        }\n    // after successfully uploading redirect the user\n    return RedirectToAction(\"actionname\", \"controller name\");\n}\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 3169071, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/47b22574c21a2b9719019204db5d5a19?s=128&d=identicon&r=PG&f=1", "display_name": "Waheed Asghar", "link": "https://stackoverflow.com/users/3169071/waheed-asghar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1499925653, "creation_date": 1499890280, "last_edit_date": 1499892481, "question_id": 45066700, "link": "https://stackoverflow.com/questions/45066700/mvc-file-is-not-being-posted-back", "title": "MVC File is not being Posted back", "body": "<p>HTTPPostedFileBase is always null in the controller. Please review and let me know where am I wrong.</p>\n\n<p>Controller Post method</p>\n\n<pre><code> public ActionResult EditProfile(Contact model, HttpPostedFileBase picture, string currentPassword, string CurrentPasswordQ, string newPassword, string loginPwd, string currentPinQ, string newPin, int? selectedQuestion, string answer, bool pwdChange = false, bool questionChange = false, bool pinChange = false)\n    {\n</code></pre>\n\n<p>My Form Header</p>\n\n<pre><code>@using (Html.BeginForm(\"EditProfile\", \"CompanyAdmin\", FormMethod.Post, new { enctype = \"multipart/form-data\", @data_ajax = \"false\" }))\n</code></pre>\n\n<p>{</p>\n\n<p>And my file Input </p>\n\n<pre><code> &lt;tr&gt;\n                                                &lt;td class=\"label_form_div\"&gt;\n                                                    &lt;label&gt;Profile Picture&lt;/label&gt;\n                                                &lt;/td&gt;\n                                                &lt;td&gt;\n                                                    &lt;input type=\"file\" name=\"picture\" /&gt;\n                                                &lt;/td&gt;\n                                            &lt;/tr&gt;\n</code></pre>\n\n<p>Please review and see if you can find what is wrong with this.\nThanks </p>\n"}, {"tags": ["c#", "unity3d", "textures", "sprite"], "comments": [{"owner": {"reputation": 8919, "user_id": 1159604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZNjba.png?s=128&g=1", "display_name": "Foggzie", "link": "https://stackoverflow.com/users/1159604/foggzie"}, "edited": false, "score": 1, "creation_date": 1499897385, "post_id": 45066669, "comment_id": 77109893, "body": "Have you tried calling <code>Texture2D.Apply()</code> after your for loop?  <a href=\"https://docs.unity3d.com/ScriptReference/Texture2D.Apply.html\" rel=\"nofollow noreferrer\">Texture2D.Apply</a>"}, {"owner": {"reputation": 8919, "user_id": 1159604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZNjba.png?s=128&g=1", "display_name": "Foggzie", "link": "https://stackoverflow.com/users/1159604/foggzie"}, "edited": false, "score": 1, "creation_date": 1499897537, "post_id": 45066669, "comment_id": 77109964, "body": "Also, look into <code>GetPixels()</code> and <code>SetPixels()</code>.  They accept an <code>x</code>, <code>y</code>, <code>width</code>, and <code>height</code> and will transfer the color data without the need for a loop."}, {"owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "reply_to_user": {"reputation": 8919, "user_id": 1159604, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZNjba.png?s=128&g=1", "display_name": "Foggzie", "link": "https://stackoverflow.com/users/1159604/foggzie"}, "edited": false, "score": 0, "creation_date": 1499899186, "post_id": 45066669, "comment_id": 77110494, "body": "Thanks for the help. Tomorrow morning I start by checking this out, I haven&#39;t tried any of those."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 1, "creation_date": 1499961054, "post_id": 45066669, "comment_id": 77143554, "body": "Have you considered using an external editor?"}, {"owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1499961768, "post_id": 45066669, "comment_id": 77144099, "body": "@Draco18s If I get you, you mean I should edit those images outside Unity and reimport?"}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 1, "creation_date": 1499961914, "post_id": 45066669, "comment_id": 77144200, "body": "@agiro Yes. If you right click on the existing file, show in explorer, it&#39;ll pop up a file browser window to the asset directly. You can just edit the texture there as you would any other file."}, {"owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "edited": false, "score": 0, "creation_date": 1499962055, "post_id": 45066669, "comment_id": 77144298, "body": "That would be viable but I got to know this compression way too late, so I have tons of textures in place. Hand-editing all of them would be a loss on the long run, not to mention this &quot;tool&quot;-ish I build now (alongside my sprite-to-mesh replacer) can be reused in other projects."}, {"owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 1, "creation_date": 1499971183, "post_id": 45066669, "comment_id": 77149691, "body": "@Draco18s well after swapping my &quot;hole-less&quot; sprites with unlit meshes, I have few sprites left. Those are easily edited by hand and I plan to do so. Couple of days into coding and I forgot about the easiest solution :D thanks for pointing it out."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1499971694, "post_id": 45066669, "comment_id": 77149967, "body": "Hundreds of files would indeed be a pain to hand-edit. I&#39;d pull out tools like Workspace Macro or GIMP filter scripts before writing a Unity script to do it. Glad you got things solved though."}], "answers": [{"comments": [{"owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "edited": false, "score": 1, "creation_date": 1499933243, "post_id": 45069641, "comment_id": 77122223, "body": "Thanks for the reply.  The first solution does indeed create a sprite but it&#39;s all transparent :/  The second does that too :D Now, using my old solution with the <code>Apply</code> method it works fine. All the problem is that though I get a sprite as an asset, I can&#39;t modify texture type, the sprite mode, so no import settings where I could enforce the use of DTX5. How to save it so I can modify those?"}, {"owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "edited": false, "score": 0, "creation_date": 1499966630, "post_id": 45069641, "comment_id": 77146982, "body": "All in all you answered my question perfectly. For runtime performance I can save at least 10% on file size without any noticable quality change according to the Profiler. Thanks for your help!"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "edited": false, "score": 1, "creation_date": 1499967004, "post_id": 45069641, "comment_id": 77147194, "body": "No problem. There is also <code>TextureFormat.DXT5</code>. You can use that instead of <code>TextureFormat.RGBA32</code>. Having really tried it though."}, {"owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "edited": false, "score": 0, "creation_date": 1499969301, "post_id": 45069641, "comment_id": 77148548, "body": "I used that <i>after</i> creating the new texture and applied again. Hopefully that way it works too"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "edited": false, "score": 1, "creation_date": 1499970309, "post_id": 45069641, "comment_id": 77149121, "body": "That looks fine."}], "tags": [], "owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "is_accepted": true, "score": 2, "last_activity_date": 1499906085, "creation_date": 1499906085, "answer_id": 45069641, "question_id": 45066669, "link": "https://stackoverflow.com/questions/45066669/resizing-a-sprite-by-adding-transparent-pixels/45069641#45069641", "title": "Resizing a sprite by adding transparent pixels", "body": "<p>You really don't need all these code.<code>Texture2D</code> has a resize function so just pull the <code>Texture2D</code> from the Sprite then call the re-szie function to re-size it. That's it.</p>\n\n<p>Something like this:</p>\n\n<pre><code>public void Resize(Sprite sprite)\n{\n    Texture2D tex = sprite.texture;\n\n    tex.Resize(100, 100, TextureFormat.RGBA32, false);\n\n    Sprite n_spr = Sprite.Create(tex,\n        new Rect(0, 0, tex.width, tex.height),\n        new Vector2(0.5f, 0.5f), 100.0f);\n\n    AssetSaver.CreateAsset(n_spr, sprite.name + \"_dtx5\");\n}\n</code></pre>\n\n<hr>\n\n<p>As for you original problem, that's because you did not call the <a href=\"https://docs.unity3d.com/ScriptReference/Texture2D.Apply.html\" rel=\"nofollow noreferrer\"><code>Apply</code></a> function. Each time you modify the pixels, you are supposed to call the <a href=\"https://docs.unity3d.com/ScriptReference/Texture2D.Apply.html\" rel=\"nofollow noreferrer\"><code>Apply</code></a>  function. Finally, always use <code>GetPixels32</code> not <code>GetPixel</code> or <code>GetPixels</code>. The reason is because <code>GetPixels32</code> is extremely faster than the rest of the function.</p>\n\n<pre><code>public void Resize(Sprite sprite)\n{\n    int _hei, _wid;\n    //getting the closest higher values that are a multiple of 4. \n    for (_hei = sprite.texture.height; _hei % 4 != 0; _hei++) ;\n    for (_wid = sprite.texture.width; _wid % 4 != 0; _wid++) ;\n    //creating the new texture. \n    Texture2D tex = new Texture2D(_wid, _hei, TextureFormat.RGBA32, false);\n    //tex.alphaIsTransparency = true;\n    //tex.EncodeToPNG();\n\n    //giving the new texture the \"improper\" ratio sprite texture's pixel info\n    //pixel by pixel.\n\n    Color32[] color = sprite.texture.GetPixels32();\n\n    tex.SetPixels32(color);\n\n    tex.Apply();\n\n    //saving the asset. the save works, was used for both meshes as well as textures. \n    Sprite n_spr = Sprite.Create(tex,\n        new Rect(0, 0, tex.width, tex.height),\n        new Vector2(0.5f, 0.5f), 100.0f);\n    AssetSaver.CreateAsset(n_spr, sprite.name + \"_dtx5\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1780, "user_id": 6207726, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/0d51ccc19dbf7826e4c56991e6a68509?s=128&d=identicon&r=PG&f=1", "display_name": "agiro", "link": "https://stackoverflow.com/users/6207726/agiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "accepted_answer_id": 45069641, "answer_count": 1, "score": 1, "last_activity_date": 1499906085, "creation_date": 1499890142, "last_edit_date": 1499891405, "question_id": 45066669, "link": "https://stackoverflow.com/questions/45066669/resizing-a-sprite-by-adding-transparent-pixels", "title": "Resizing a sprite by adding transparent pixels", "body": "<p>The reason I wish to do so is that Unity has a nice DTX5 format that reduces the file size by a lot. But to get that, I need a sprite that's size is - both for height and width - a multiple of 4. \nSo I thought I create a new texture with the desired size, load its pixels with the original's pixels and make a sprite out of it that I save as an <code>asset</code>. \nThe issue is that while saving the <strong>texture</strong> works, I get the same texture with the proper sizes, saving the <strong>sprite</strong> doesn't work. It spits out something, but that isn't even close to what I need. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class ResizeSprites\n{\n    public void Resize(Sprite sprite)\n    {\n        int _hei, _wid;\n        //getting the closest higher values that are a multiple of 4. \n        for (_hei = sprite.texture.height; _hei % 4 != 0; _hei++) ;\n        for (_wid = sprite.texture.width; _wid % 4 != 0; _wid++) ;\n        //creating the new texture. \n        Texture2D tex = new Texture2D(_wid, _hei,TextureFormat.RGBA32,false);\n        //tex.alphaIsTransparency = true;\n        //tex.EncodeToPNG();\n\n       //giving the new texture the \"improper\" ratio sprite texture's pixel info\n        //pixel by pixel.\n        for (int wid = 0; wid &lt; sprite.texture.width; wid++)\n        {\n            for (int hei = 0; hei &lt; sprite.texture.height; hei++)\n            {\n                tex.SetPixel(wid, hei, sprite.texture.GetPixel(wid, hei));\n            }\n        }\n        //saving the asset. the save works, was used for both meshes as well as textures. \n        Sprite n_spr = Sprite.Create(tex,\n            new Rect(0, 0, tex.width, tex.height),\n            new Vector2(0.5f, 0.5f), 100.0f);\n        AssetSaver.CreateAsset(n_spr, sprite.name + \"_dtx5\");\n    }\n\n}\n</code></pre>\n\n<p>And here are my results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1EnMH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1EnMH.jpg\" alt=\"original sprite\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/47XmT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/47XmT.jpg\" alt=\"the sad outcome\"></a></p>\n\n<p>The first one is the original sprite, and the second is what I was given. </p>\n\n<p><strong>Edit:</strong> Even if I don't save my creation, just instantiate it as a <code>GameObject</code>, the result is still the same ugly one. </p>\n"}, {"tags": ["c#", "asp.net", "rabbitmq", "masstransit"], "answers": [{"tags": [], "owner": {"reputation": 561, "user_id": 2912563, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0be41b108f1970631eff02915f12e636?s=128&d=identicon&r=PG", "display_name": "Douglas Franco", "link": "https://stackoverflow.com/users/2912563/douglas-franco"}, "is_accepted": false, "score": 0, "last_activity_date": 1499890715, "creation_date": 1499890715, "answer_id": 45066792, "question_id": 45066663, "link": "https://stackoverflow.com/questions/45066663/masstransit-not-creating-error-queue/45066792#45066792", "title": "MassTransit not creating _error queue", "body": "<p>The error queue is created only when all attempts is fails.</p>\n"}], "owner": {"reputation": 561, "user_id": 2912563, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0be41b108f1970631eff02915f12e636?s=128&d=identicon&r=PG", "display_name": "Douglas Franco", "link": "https://stackoverflow.com/users/2912563/douglas-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499890715, "creation_date": 1499890121, "question_id": 45066663, "link": "https://stackoverflow.com/questions/45066663/masstransit-not-creating-error-queue", "title": "MassTransit not creating _error queue", "body": "<p>I have two Consumers:</p>\n\n<pre><code>public class SendEmailConsumer : ConsumerBase, IConsumer&lt;ISendEmail&gt;\n    {    \n        public Task Consume(ConsumeContext&lt;ISendEmail&gt; context)\n        {\n            throw new Exception(\"aaa\");\n        }\n    }\n\n\n\n\npublic class IntegrateNewCostCenterConsumer: ConsumerBase, IConsumer&lt;IIntegrateCostCenter&gt;\n        {    \n            public Task Consume(ConsumeContext&lt;ISendEmail&gt; context)\n            {\n                throw new Exception(\"aaa\");\n            }\n        }\n</code></pre>\n\n<p>both with the same configuration:</p>\n\n<pre><code>cfg.ReceiveEndpoint(host, MessageHandlerConstants.IntegrateCostCenter, e =&gt;\n            {\n                // doc http://masstransit-project.com/MassTransit/advanced/middleware/circuit-breaker.html\n                e.UseCircuitBreaker(cb =&gt;\n                {\n                    cb.TripThreshold = 15;\n                    cb.ResetInterval = TimeSpan.FromMinutes(5);\n                    cb.TrackingPeriod = TimeSpan.FromMinutes(1);\n                    cb.ActiveThreshold = 10;\n                });\n\n                e.UseRetry(r =&gt; r.Interval(5, new TimeSpan(0, 0, 10)));\n                e.Consumer&lt;IntegrateNewCostCenterConsumer&gt;();\n            });\n\n\ncfg.ReceiveEndpoint(host, MessageHandlerConstants.SendEmail, e =&gt;\n            {\n                // doc http://masstransit-project.com/MassTransit/advanced/middleware/circuit-breaker.html\n                e.UseCircuitBreaker(cb =&gt;\n                {\n                    cb.TripThreshold = 15;\n                    cb.ResetInterval = TimeSpan.FromMinutes(5);\n                    cb.TrackingPeriod = TimeSpan.FromMinutes(1);\n                    cb.ActiveThreshold = 10;\n                });\n\n                e.UseRetry(r =&gt; r.Interval(10, new TimeSpan(0, 0, 60)));\n                e.Consumer&lt;SendEmailConsumer&gt;();\n            });\n</code></pre>\n\n<p>The problem is only IntegrateCostCenter has _error queue created sucessfuly for the exception. Both are handled normally. What i'm doing wrong?</p>\n\n<p><a href=\"https://i.stack.imgur.com/H5IzX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H5IzX.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "virtual-memory"], "comments": [{"owner": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1499899138, "post_id": 45066651, "comment_id": 77110481, "body": "You can use WMI for this. An example how to do it is <a href=\"https://stackoverflow.com/questions/6944779/determine-operating-system-and-processor-type-in-c-sharp\" title=\"determine operating system and processor type in c sharp\">stackoverflow.com/questions/6944779/&hellip;</a>, but in your case instead of the table Win32_OperatingSystem you should use Win32_Process (<a href=\"https://msdn.microsoft.com/en-us/library/aa394372(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa394372(v=vs.85).aspx</a>). I suppose $&quot;SELECT PageFileUsage FROM Win32_Process WHERE ProcessId={Process.GetCurrentProcess().Id}&quot; should work."}, {"owner": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1499900587, "post_id": 45066651, "comment_id": 77110926, "body": "Maybe Win32_PageFileUsage (<a href=\"https://msdn.microsoft.com/en-us/library/aa394246(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa394246(v=vs.85).aspx</a>) is also of use for you. Regarding your PS: no that shouldn&#39;t happen. How exactly are you writing arrays to a file, as FileStream only supports byte arrays?"}, {"owner": {"reputation": 1, "user_id": 5880068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e85a6ed47a326f71111b6e84754e1de4?s=128&d=identicon&r=PG&f=1", "display_name": "MyAccount", "link": "https://stackoverflow.com/users/5880068/myaccount"}, "reply_to_user": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1499947720, "post_id": 45066651, "comment_id": 77132567, "body": "I am writing a byte array.  And what&#39;s with the select statement?  I&#39;m not using a database, just C#.  Is that that Linq stuff or something similar?  Oh, and do I need to include any DLL for any of this stuff?  I&#39;d prefer not to so I can keep my program simpler for distribution, but I&#39;ll use a DLL if I must, but I would need to know which one.  Thanks."}, {"owner": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1499968804, "post_id": 45066651, "comment_id": 77148262, "body": "It could be that you would need to add System.Management.dll to your project references, but I don&#39;t think you need to distribute it as it&#39;s part of the .NET framework. Regarding the select, Microsoft just choose to use a SQL like syntax to query system information using WMI, their is no database involved."}, {"owner": {"reputation": 1, "user_id": 5880068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e85a6ed47a326f71111b6e84754e1de4?s=128&d=identicon&r=PG&f=1", "display_name": "MyAccount", "link": "https://stackoverflow.com/users/5880068/myaccount"}, "reply_to_user": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1499982884, "post_id": 45066651, "comment_id": 77155596, "body": "Well I looked at the example you gave and some stuff I found on MSDN, but it all seemed to do pretty much the same thing as the functions that I mentioned earlier which weren&#39;t doing what I need.  That is, unless there&#39;s a function I missed or something.  Do you know of a specific one that will tell me anything about page file usage, either globally for the computer or just for the process?  The problem with the string indexer they use is that there&#39;s no autocomplete and probably little if any documentation for the specific strings!  But if you could tell me the name of the right one, thanks!"}, {"owner": {"reputation": 1, "user_id": 5880068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e85a6ed47a326f71111b6e84754e1de4?s=128&d=identicon&r=PG&f=1", "display_name": "MyAccount", "link": "https://stackoverflow.com/users/5880068/myaccount"}, "reply_to_user": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1499983312, "post_id": 45066651, "comment_id": 77155811, "body": "Sorry I looked at some stuff and decided to rephrase but it wouldn&#39;t let me edit again:  I looked at your example and MSDN, but it all seemed to do the same thing as the functions that I mentioned earlier which weren&#39;t what I need, unless there&#39;s a function I missed.  Do you know of one that will tell me anything about page file usage, either globally for the computer or just for the process?  The problem with the string indexer they use is that there&#39;s no autocomplete and the documentation doesn&#39;t mention all the specific strings!  But if you could tell me the name of the right one, thanks!"}], "owner": {"reputation": 1, "user_id": 5880068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e85a6ed47a326f71111b6e84754e1de4?s=128&d=identicon&r=PG&f=1", "display_name": "MyAccount", "link": "https://stackoverflow.com/users/5880068/myaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499890054, "creation_date": 1499890054, "question_id": 45066651, "link": "https://stackoverflow.com/questions/45066651/testing-for-virtual-memory-paging-file", "title": "Testing for virtual memory paging file", "body": "<p>I'm having a REALLY tough time with something.  I'm using C#, and I want to be able to check whether the virtual memory paging file is currently enabled (or has a maximum size greater than 0, whichever is easier to test).</p>\n\n<p>I haven't found any way to do it (if there is one, <em>please</em> tell me!), but I thought I might be able to indirectly accomplish my goal by just checking either how much memory in the paging file my program/process is using or even how much it's <em>allowed</em> to use.</p>\n\n<p>So I was using the Process.PagedMemorySize64 and Process.PagedSystemMemorySize64 functions, but they return a positive number even when I have the paging file disabled!  I was told elsewhere that those functions will tell me information about physical memory if a paging file is unavailable.  Well great, because that doesn't help me.</p>\n\n<p>So if anyone knows how to actually get any information about how much memory the current process or whole computer is either using or allowed to use within a paging file, I'd appreciate it!</p>\n\n<p>P.S.: As a related question, does anyone ever get an OutOfMemoryException while trying to write an array into a FileStream in a loop?  I mean I'm not actually <em>allocating</em> any memory at that time, and it only happens when I try to write huge files - the small ones write just fine.</p>\n"}, {"tags": ["c#", "razor", "asp.net-core", "rest-client"], "comments": [{"owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "edited": false, "score": 0, "creation_date": 1499891814, "post_id": 45066586, "comment_id": 77107425, "body": "Both methods cannot be inside HomeController, as they both have same method signature. Anyhow, if you type in <code>http:&#47;&#47;localhost:xxx&#47;api&#47;GetImage</code> inside browser, does it show anything?"}, {"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "reply_to_user": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "edited": false, "score": 0, "creation_date": 1499892087, "post_id": 45066586, "comment_id": 77107555, "body": "@Win Yes, the image shows. I&#39;ve also went ahead and tried moving one of the methods to a different Controller - same difference."}, {"owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "edited": false, "score": 0, "creation_date": 1499892422, "post_id": 45066586, "comment_id": 77107682, "body": "Is your client side AngularJS?"}, {"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "reply_to_user": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "edited": false, "score": 0, "creation_date": 1499892598, "post_id": 45066586, "comment_id": 77107777, "body": "@Win AngularJS - yes. (I know it&#39;s frowned upon, but also using jQuery alongside) hence the inner <code>$(#img1)...</code> call in the client-side <code>$http.get</code> call"}], "answers": [{"comments": [{"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499894070, "post_id": 45067443, "comment_id": 77108498, "body": "Here&#39;s a question - if I merely change the <code>return</code> statement to <code>return &quot;data:image&#47;png;base64,&quot; + Convert.ToBase64String(response);</code> I get an error that <code>response</code> cannot convert from <code>RestSharp.RestResponse</code> to <code>byte[]</code>"}, {"owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "reply_to_user": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499894440, "post_id": 45067443, "comment_id": 77108689, "body": "You will need to provide byte array in order to convert base64 encoding string."}, {"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499894496, "post_id": 45067443, "comment_id": 77108710, "body": "Could you show me an example based on my current code? I&#39;m not sure what you mean."}, {"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499894886, "post_id": 45067443, "comment_id": 77108906, "body": "Trying your above suggestion gives me the error - <code>Cannot implicitly convert type &#39;string&#39; to &#39;Microsoft.AspNetCore.Mvc.ActionResult&#39;</code>"}, {"owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "reply_to_user": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499894948, "post_id": 45067443, "comment_id": 77108938, "body": "You will need use <code>public async Task&lt;string&gt;</code> instead of <code>public async Task&lt;ActionResult&gt;</code>."}, {"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499895125, "post_id": 45067443, "comment_id": 77109037, "body": "I have tried that just now - I get no image string back, the response from that method is showing <code>data:image&#47;png;base64,</code> and that&#39;s it."}, {"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499956935, "post_id": 45067443, "comment_id": 77140330, "body": "In ASP.Net Core, <code>DownloadData</code> throws an error because <code>RestClient</code> does not contain a definition for <code>DownloadData</code> - can you either revise your answer or delete it?"}, {"owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "reply_to_user": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 1, "creation_date": 1499967271, "post_id": 45067443, "comment_id": 77147336, "body": "Sorry, the previous RestSharp code was ASP.NET MVC. I forget that you are using ASP.NET Core. I updated the answer with working code which I tested."}, {"owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "edited": false, "score": 0, "creation_date": 1499972627, "post_id": 45067443, "comment_id": 77150549, "body": "I could not love you more right now Win, this is awesome - and it really helped me out quite a lot."}], "tags": [], "owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "is_accepted": true, "score": 1, "last_activity_date": 1499967149, "last_edit_date": 1499967149, "creation_date": 1499893275, "answer_id": 45067443, "question_id": 45066586, "link": "https://stackoverflow.com/questions/45066586/how-to-set-returned-image-data-as-ng-src-of-image-in-angularjs/45067443#45067443", "title": "How to set returned Image Data as ng-src of image in AngularJS", "body": "<p>You need few things. First, you should not access DOM directly inside Angular Controller. </p>\n\n<pre><code>&lt;script src=\"http://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular.js\"&gt;&lt;/script&gt;\n&lt;script src=\"http://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular-animate.js\"&gt;&lt;/script&gt;\n&lt;script src=\"http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-1.3.2.js\"&gt;&lt;/script&gt;\n&lt;div ng-app=\"app\"&gt;\n    &lt;my-content&gt;&lt;/my-content&gt;\n&lt;/div&gt;\n&lt;script type=\"text/javascript\"&gt;\n    angular.module('app', []);\n\n    angular.module('app')\n        .component('myContent', {\n            template: '&lt;h1&gt;{{$ctrl.title}}&lt;/h1&gt;&lt;img src=\"{{$ctrl.imageSrc}}\" /&gt;',\n            controller: function ($http) {\n                var self = this;\n                self.title = \"Title\";\n                // Just to verify image work\n                //self.imageSrc = \"https://i.stack.imgur.com/hM8Ah.jpg?s=48&amp;g=1\";\n                $http.get('/Home/ImageFromPath').then(function (response) {\n                    console.log(response.data);\n                    self.imageSrc = response.data;\n                });\n            }\n        });\n&lt;/script&gt;\n</code></pre>\n\n<p>Second, you will need to return based64 encoded string.</p>\n\n<pre><code>using System;\nusing System.Threading.Tasks;\nusing Microsoft.AspNetCore.Mvc;\nusing RestSharp;\n\nnamespace DemoWebCore.Controllers\n{\n    public class HomeController : Controller\n    {\n        public async Task&lt;IActionResult&gt; ImageFromPath()\n        {\n            RestClient client = new RestClient(\"https://i.stack.imgur.com/hM8Ah.jpg?s=48&amp;g=1\");\n            RestRequest request = new RestRequest(Method.GET);\n            request.AddHeader(\"cache-control\", \"no-cache\");\n            request.AddHeader(\"authorization\", \"Basic aYu7GI\");\n            TaskCompletionSource&lt;IRestResponse&gt; taskCompletion = new TaskCompletionSource&lt;IRestResponse&gt;();\n            RestRequestAsyncHandle handle = client.ExecuteAsync(request, r =&gt; taskCompletion.SetResult(r));\n            RestResponse response = (RestResponse)await taskCompletion.Task;\n            return Ok(\"data:image/png;base64,\" + Convert.ToBase64String(response.RawBytes));\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14061322, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9c5bb09cba18fe5d0df1053ae73f329a?s=128&d=identicon&r=PG", "display_name": "user14061322", "link": "https://stackoverflow.com/users/14061322/user14061322"}, "is_accepted": false, "score": 0, "last_activity_date": 1596730795, "last_edit_date": 1596730795, "creation_date": 1596729605, "answer_id": 63287520, "question_id": 45066586, "link": "https://stackoverflow.com/questions/45066586/how-to-set-returned-image-data-as-ng-src-of-image-in-angularjs/63287520#63287520", "title": "How to set returned Image Data as ng-src of image in AngularJS", "body": "<p>For this fix I have used:</p>\n<pre><code>Request.CreateResponse(HttpStatusCode.OK, &quot;data:image/png;base64,&quot; + Convert.ToBase64String(response.GetBuffer()))\n</code></pre>\n"}], "owner": {"reputation": 2453, "user_id": 3792634, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/100006685389126/picture?type=large", "display_name": "LatentDenis", "link": "https://stackoverflow.com/users/3792634/latentdenis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "accepted_answer_id": 45067443, "answer_count": 2, "score": 1, "last_activity_date": 1596730795, "creation_date": 1499889841, "last_edit_date": 1499958303, "question_id": 45066586, "link": "https://stackoverflow.com/questions/45066586/how-to-set-returned-image-data-as-ng-src-of-image-in-angularjs", "title": "How to set returned Image Data as ng-src of image in AngularJS", "body": "<p>I've got two ASP.Net Core methods at the moment - one tied to an API call, and one tied to a client-side Razor helper.</p>\n\n<p>They're both located in my <code>HomeController.cs</code>.</p>\n\n<p><strong>API:</strong></p>\n\n<p>Here's the API call:</p>\n\n<pre><code>[HttpGet(\"api/GetImage\")]\npublic async Task&lt;ActionResult&gt; ImageFromPath()\n{\n    RestClient client = new RestClient(\"http://IPADDRESS/cgi-bin/snapshot.cgi?channel=0\");\n    RestRequest request = new RestRequest(Method.GET);\n    request.AddHeader(\"cache-control\", \"no-cache\");\n    request.AddHeader(\"authorization\", \"Basic aYu7GI\");\n    TaskCompletionSource&lt;IRestResponse&gt; taskCompletion = new TaskCompletionSource&lt;IRestResponse&gt;();\n\n    RestRequestAsyncHandle handle = client.ExecuteAsync(request, r =&gt; taskCompletion.SetResult(r));\n    RestResponse response = (RestResponse)(await taskCompletion.Task);\n\n    return File(response.RawBytes, \"image/png\");\n}\n</code></pre>\n\n<p><strong>Razor:</strong></p>\n\n<p>Here's the Razor helper:</p>\n\n<pre><code>public async Task&lt;ActionResult&gt; ImageFromPath()\n{\n    RestClient client = new RestClient(\"http://IPADDRESS/cgi-bin/snapshot.cgi?channel=0\");\n    RestRequest request = new RestRequest(Method.GET);\n    request.AddHeader(\"cache-control\", \"no-cache\");\n    request.AddHeader(\"authorization\", \"Basic aYu7GI\");\n    TaskCompletionSource&lt;IRestResponse&gt; taskCompletion = new TaskCompletionSource&lt;IRestResponse&gt;();\n\n    RestRequestAsyncHandle handle = client.ExecuteAsync(request, r =&gt; taskCompletion.SetResult(r));\n    RestResponse response = (RestResponse)(await taskCompletion.Task);\n\n    return File(response.RawBytes, \"image/png\");\n}\n</code></pre>\n\n<p>As you can see, the method bodies above are <strong>exactly the same</strong>. One simply has the <code>HttpGet</code> annotation.</p>\n\n<hr>\n\n<p>Yet, when paired with their client-side handlers, they produce different results.</p>\n\n<p><strong>API:</strong></p>\n\n<p>Client-side handler for API call:</p>\n\n<pre><code>&lt;img ng-src=\"{{imageSrc}}\"&gt;\n\n$http.get('/api/GetImage', { headers: { 'Accept': 'image/webp,image/apng,image/*,*/*;q=0.8' } }).then(function (response) {\n    $scope.imageSrc = response.data;\n});\n</code></pre>\n\n<p><strong>Razor:</strong></p>\n\n<p>Client-side handler for Razor helper:</p>\n\n<pre><code>&lt;img src=\"@Url.Action(\"ImageFromPath\")\" id=\"img2\" /&gt;\n</code></pre>\n\n<hr>\n\n<p>Here's where the results show:</p>\n\n<p><strong>API:</strong></p>\n\n<p>Here's the API call <code>preview</code> in Network tab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0Hjrj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Hjrj.jpg\" alt=\"api-preview\"></a></p>\n\n<p><strong>Razor:</strong></p>\n\n<p>Here's the Razor Helper call <code>preview</code> in Network tab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M70uy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M70uy.jpg\" alt=\"razor-preview\"></a></p>\n\n<p><strong>API:</strong></p>\n\n<p>Here's the API call <code>headers</code> in Network tab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RWBnv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RWBnv.jpg\" alt=\"api-headers\"></a></p>\n\n<p><strong>Razor:</strong></p>\n\n<p>Here's the Razor Helper call <code>headers</code> in Network tab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/OioyA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OioyA.jpg\" alt=\"razor-headers\"></a></p>\n\n<p><strong>API:</strong></p>\n\n<hr>\n\n<p>Why does the Razor helper actually produce/return an image, yet the API call doesn't? How could I make the API call return an image just like the Razor helper does?</p>\n"}, {"tags": ["c#", "sql-server", "entity-framework", "stored-procedures", "output-parameter"], "comments": [{"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1499891564, "post_id": 45066451, "comment_id": 77107307, "body": "Side note: you should <b>not</b> use the <code>sp_</code> prefix for your stored procedures. Microsoft has <a href=\"http://msdn.microsoft.com/en-us/library/ms190669%28v=sql.105%29.aspx\" rel=\"nofollow noreferrer\">reserved that prefix for its own use (see <i>Naming Stored Procedures</i>)</a>, and you do run the risk of a name clash sometime in the future. <a href=\"http://www.sqlperformance.com/2012/10/t-sql-queries/sp_prefix\" rel=\"nofollow noreferrer\">It&#39;s also bad for your stored procedure performance</a>. It&#39;s best to just simply avoid <code>sp_</code> and use something else as a prefix - or no prefix at all!"}, {"owner": {"reputation": 432, "user_id": 8297552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/412A6.jpg?s=128&g=1", "display_name": "\u0141ukasz Sypniewski", "link": "https://stackoverflow.com/users/8297552/%c5%81ukasz-sypniewski"}, "reply_to_user": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 0, "creation_date": 1499892336, "post_id": 45066451, "comment_id": 77107652, "body": "Didn&#39;t know that, I&#39;ll keep this in mind, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 8297552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/412A6.jpg?s=128&g=1", "display_name": "\u0141ukasz Sypniewski", "link": "https://stackoverflow.com/users/8297552/%c5%81ukasz-sypniewski"}, "edited": false, "score": 0, "creation_date": 1499892241, "post_id": 45066767, "comment_id": 77107614, "body": "Actually <code>select count(*) into @counter_number from RawData</code> didn&#39;t work (incorrect syntax), but it gave me a hint how to solve this: <code>select  @count_number = count(*) from RawData</code>. Thanks a lot!"}, {"owner": {"reputation": 2102, "user_id": 2105488, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f7ccc91924384abad653e30c1938bed4?s=128&d=identicon&r=PG", "display_name": "Allen King", "link": "https://stackoverflow.com/users/2105488/allen-king"}, "reply_to_user": {"reputation": 432, "user_id": 8297552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/412A6.jpg?s=128&g=1", "display_name": "\u0141ukasz Sypniewski", "link": "https://stackoverflow.com/users/8297552/%c5%81ukasz-sypniewski"}, "edited": false, "score": 0, "creation_date": 1499892377, "post_id": 45066767, "comment_id": 77107664, "body": "@Sypcio thanks. Yes I guess its b/c I use too much MySQL :-). Fixed my answer."}], "tags": [], "owner": {"reputation": 2102, "user_id": 2105488, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f7ccc91924384abad653e30c1938bed4?s=128&d=identicon&r=PG", "display_name": "Allen King", "link": "https://stackoverflow.com/users/2105488/allen-king"}, "is_accepted": true, "score": 1, "last_activity_date": 1499892348, "last_edit_date": 1499892348, "creation_date": 1499890609, "answer_id": 45066767, "question_id": 45066451, "link": "https://stackoverflow.com/questions/45066451/c-sql-server-stored-procedures-cant-get-output-parameter-value-return-val/45066767#45066767", "title": "C# &amp; SQL Server stored procedures - can&#39;t get output parameter value, return value works", "body": "<p>Not sure if you can assign count(*) to a parameter. It only works in the sql statement.</p>\n\n<p>Perhaps try this</p>\n\n<pre><code>Create procedure sp_CountEachNumberOccurencesOutput\n    @number tinyint, @count_number int output\n    As\n    SET NOCOUNT ON\n    select @counter_number=count(*)  from RawData\n                where Number1 = @number or Number2 = @number  or Number3 = @number\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 432, "user_id": 8297552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/412A6.jpg?s=128&g=1", "display_name": "\u0141ukasz Sypniewski", "link": "https://stackoverflow.com/users/8297552/%c5%81ukasz-sypniewski"}, "edited": false, "score": 0, "creation_date": 1499971387, "post_id": 45067424, "comment_id": 77149797, "body": "Thanks, I found it useful!"}, {"owner": {"reputation": 108, "user_id": 4121893, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029488766/picture?type=large", "display_name": "Adrian Di Ruggiero", "link": "https://stackoverflow.com/users/4121893/adrian-di-ruggiero"}, "reply_to_user": {"reputation": 432, "user_id": 8297552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/412A6.jpg?s=128&g=1", "display_name": "\u0141ukasz Sypniewski", "link": "https://stackoverflow.com/users/8297552/%c5%81ukasz-sypniewski"}, "edited": false, "score": 0, "creation_date": 1499982150, "post_id": 45067424, "comment_id": 77155279, "body": "Hi Sypcio, if you don&#39;t mind (and if you are able to do it), could you please mark my answer as &quot;useful&quot; (the &quot;Up&quot; arrow at the top). Thanks!"}], "tags": [], "owner": {"reputation": 108, "user_id": 4121893, "user_type": "registered", "profile_image": "https://graph.facebook.com/1029488766/picture?type=large", "display_name": "Adrian Di Ruggiero", "link": "https://stackoverflow.com/users/4121893/adrian-di-ruggiero"}, "is_accepted": false, "score": 1, "last_activity_date": 1499893194, "creation_date": 1499893194, "answer_id": 45067424, "question_id": 45066451, "link": "https://stackoverflow.com/questions/45066451/c-sql-server-stored-procedures-cant-get-output-parameter-value-return-val/45067424#45067424", "title": "C# &amp; SQL Server stored procedures - can&#39;t get output parameter value, return value works", "body": "<p>I used to perform this task as following:</p>\n\n<pre><code>public Int32 ExecuteGenericSP(string spName, out int errNum, out string errMsg, params object[] lstParams)\n{\n    Int32 returnValue;\n    /* Aqui */\n    SqlDatabase _sqlDatabase = new SqlDatabase(getConnectionString());\n    using (DbConnection con = _sqlDatabase.CreateConnection())\n    {\n        DbCommand cmd = _sqlDatabase.GetStoredProcCommand(spName);\n        _sqlDatabase.DiscoverParameters(cmd);\n        int n = 3;\n\n        errNum = 0;\n        errMsg = \"\";\n        cmd.Parameters[\"@RETURN_VALUE\"].Value = 0;\n\n        cmd.Parameters[\"@errNum\"].Value = 0;\n        cmd.Parameters[\"@errDes\"].Value = \"\";\n\n        foreach (object o in lstParams)\n        {\n            if (cmd.Parameters[n].DbType.ToString() == \"DateTime\")\n                cmd.Parameters[n].Value = Convert.ToDateTime(o);\n            else\n                cmd.Parameters[n].Value = o.ToString();\n            n++;\n        }\n\n        returnValue = _sqlDatabase.ExecuteNonQuery(cmd);\n\n        errNum = Convert.ToInt16(_sqlDatabase.GetParameterValue(cmd, \"errNum\"));\n        errMsg = _sqlDatabase.GetParameterValue(cmd, \"errDes\").ToString();\n    }\n    return returnValue;\n}\n</code></pre>\n\n<p>And for instance, this is a sample of a SP:</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[AUD_Insertar]\n    @errNum smallint OUTPUT,\n    @errDes varchar(50) OUTPUT,\n    @id smallint,    \n    @message varchar(MAX),\n    @type char(1),\n    @userId varchar(20),\n    @modulo char(1)\nAS\nBEGIN\n    -- SET NOCOUNT ON added to prevent extra result sets from\n    -- interfering with SELECT statements.\n    SET NOCOUNT ON;\n\n    SET @errNum = 0;\n    SET @errDes = '';\n\n    INSERT INTO log(message, type, userId, modulo) VALUES (@message, @type, @userId, @modulo)\n    IF (@@ROWCOUNT = 0)\n    BEGIN\n        SET @errNum = 1;\n        SET @errDes = 'Error while inserting';\n    END\nEND\n</code></pre>\n\n<p>I hope this can help you.\nRegards,</p>\n\n<p>Adrian</p>\n"}], "owner": {"reputation": 432, "user_id": 8297552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/412A6.jpg?s=128&g=1", "display_name": "\u0141ukasz Sypniewski", "link": "https://stackoverflow.com/users/8297552/%c5%81ukasz-sypniewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 45066767, "answer_count": 2, "score": 0, "last_activity_date": 1499893194, "creation_date": 1499889333, "last_edit_date": 1499891553, "question_id": 45066451, "link": "https://stackoverflow.com/questions/45066451/c-sql-server-stored-procedures-cant-get-output-parameter-value-return-val", "title": "C# &amp; SQL Server stored procedures - can&#39;t get output parameter value, return value works", "body": "<p>I would like to get a value of an output parameter of a stored procedure, but I'm getting <strong>+1</strong> all the time. When obtaining a value by return everything's ok. </p>\n\n<p>I managed to obtain a value of the output parameter using Entity Framework, however, it works really slowly. I'm attaching my stored procedure and C# code used to get the values from the stored procedures.</p>\n\n<p>Stored procedure with an output parameter works fine in SQL Server.</p>\n\n<p>Does someone have any idea why my code doesn't work? </p>\n\n<p>Thanks for your help in advance. </p>\n\n<p>Stored procedure:</p>\n\n<pre><code>Create procedure sp_CountEachNumberOccurencesOutput\n    @number tinyint, \n    @count_number int output\nAs\n    SET NOCOUNT ON\n\n    select count(*) \n    from RawData\n    where Number1 = @number or Number2 = @number or Number3 = @number\n\n    select @count_number = count(*)\n</code></pre>\n\n<p>C# code for stored procedure with and output parameter which uses Entity Framework and works, but it's slow:</p>\n\n<pre><code>using (SqlConnection cn = new SqlConnection(cnStr))\n{\n    cn.Open();\n\n    using (SqlCommand cmd = new SqlCommand(\"sp_CountEachNumberOccurencesOutput\", cn))\n    {\n        var outParam = new SqlParameter();\n        int outputValue = 0;\n        outParam.SqlDbType = SqlDbType.Int;\n        outParam.Direction = ParameterDirection.Output;\n\n        DbContext dbContext = new DbContext(this.connectionString);\n\n        var data = dbContext.Database.SqlQuery&lt;int&gt;(\"sp_CountEachNumberOccurencesOutput @number, @count_number OUT\",\n                   new SqlParameter(\"number\", parameter),\n                   new SqlParameter(\"count_number\", outputValue),\n                   outParam);\n\n        outputValue = data.ToList()[0];\n\n        return outputValue;\n    }\n}\n</code></pre>\n\n<p>C# code for stored procedure with and output parameter which doesn't work:</p>\n\n<pre><code>using (SqlConnection cn = new SqlConnection(cnStr))\n{\n    cn.Open();\n\n    using (SqlCommand cmd = new SqlCommand(\"sp_CountEachNumberOccurencesOutput\", cn))\n    {\n        cmd.CommandType = CommandType.StoredProcedure;\n\n        SqlParameter param = cmd.Parameters.Add(\"@number\", SqlDbType.Int);\n        param.Direction = ParameterDirection.Input;\n        param.Value = parameter;\n\n        SqlParameter outputParameter = cmd.Parameters.Add(\"@count_number\", SqlDbType.Int);\n        outputParameter.Direction = ParameterDirection.Output;\n        outputParameter.Value = 0;                   \n\n        cmd.ExecuteNonQuery();\n\n        cn.Close();\n\n        int OutputValue = (int)cmd.Parameters[\"@count_number\"].Value;\n\n        return OutputValue;\n    }\n}\n</code></pre>\n\n<p>This code gets return value and works:</p>\n\n<pre><code>using (SqlConnection cn = new SqlConnection(cnStr))\n{\n    cn.Open();\n\n    using (SqlCommand cmd = new SqlCommand(\"sp_CountEachNumberOccurencesReturn\", cn))\n    {\n        cmd.CommandType = CommandType.StoredProcedure;\n\n        SqlParameter param = cmd.Parameters.Add(\"@number\", SqlDbType.Int);\n        param.Direction = ParameterDirection.Input;\n        param.Value = parameter;\n\n        SqlParameter returnValue = new SqlParameter();\n        returnValue.Direction = ParameterDirection.ReturnValue;\n        cmd.Parameters.Add(returnValue);\n\n        return Convert.ToInt32(cmd.ExecuteScalar());\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-web-api", "owin"], "owner": {"reputation": 670, "user_id": 6093407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ecf1d2e358b61de770566922792ed2e?s=128&d=identicon&r=PG&f=1", "display_name": "Mari Faleiros", "link": "https://stackoverflow.com/users/6093407/mari-faleiros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1500578189, "creation_date": 1499889263, "last_edit_date": 1500578189, "question_id": 45066431, "link": "https://stackoverflow.com/questions/45066431/route-with-parameter-in-asp-net-web-api-using-owin-oauthauthorization", "title": "Route with parameter in ASP.NET Web API using OWIN OAuthAuthorization", "body": "<p>I'm trying to use a route like \"/api/{culture}/token\" for my OAuth authorization process at my Web API but I'm not succeeding on it.</p>\n\n<pre><code> var options = new OAuthAuthorizationServerOptions()\n        {\n            AllowInsecureHttp = true,\n            TokenEndpointPath = new PathString(\"/api/{culture}/token\"),\n            AccessTokenExpireTimeSpan = TimeSpan.FromDays(1),\n            Provider = new SimpleAuthorizationServerProvider()\n        };\n</code></pre>\n\n<p>I have seen how to access query string parameters as explained <a href=\"https://stackoverflow.com/questions/31442364/owin-oauth-send-additional-parameters\">here</a> but it would be better to call this route as, say, api/en-US/token instead of api/token/?auth_parameters&amp;culture=en-US</p>\n"}, {"tags": ["c#", "sql", "web", "asp.net-core", "queue"], "comments": [{"owner": {"reputation": 1414, "user_id": 4828786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c8d5c626ee16240cbb7b21cb1782fa9?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4828786/kevin"}, "edited": false, "score": 0, "creation_date": 1499890356, "post_id": 45066360, "comment_id": 77106717, "body": "I could have what you are saying all wrong (wouldn&#39;t be the first time I&#39;ve misread a question) but, &quot;fresh data&quot; is a point-in-time thing. You can only furnish the data that you have in the db at any given point in time. If you have pending transactions that will alter the data once processed, you can only provide that altered data after the processing occurs. So, technically, &quot;fresh data&quot; is whatever is currently in your db when the call for data comes in. And, don&#39;t quote me on this because I&#39;m certainly no expert on Nodejs, but I think Nodejs is server side not client side (front end)."}, {"owner": {"reputation": 1, "user_id": 6434897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808fe807c804268b5890a24256d98f1a?s=128&d=identicon&r=PG&f=1", "display_name": "TheMrone", "link": "https://stackoverflow.com/users/6434897/themrone"}, "reply_to_user": {"reputation": 1414, "user_id": 4828786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c8d5c626ee16240cbb7b21cb1782fa9?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4828786/kevin"}, "edited": false, "score": 0, "creation_date": 1499966436, "post_id": 45066360, "comment_id": 77146859, "body": "@Kevin Yes, I know this but how could we do this? An idea?"}, {"owner": {"reputation": 1, "user_id": 6434897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808fe807c804268b5890a24256d98f1a?s=128&d=identicon&r=PG&f=1", "display_name": "TheMrone", "link": "https://stackoverflow.com/users/6434897/themrone"}, "reply_to_user": {"reputation": 1414, "user_id": 4828786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c8d5c626ee16240cbb7b21cb1782fa9?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/4828786/kevin"}, "edited": false, "score": 0, "creation_date": 1499966452, "post_id": 45066360, "comment_id": 77146871, "body": "@Kevin With NodeJs I mean it provides the compiled react stuff. :)"}], "owner": {"reputation": 1, "user_id": 6434897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808fe807c804268b5890a24256d98f1a?s=128&d=identicon&r=PG&f=1", "display_name": "TheMrone", "link": "https://stackoverflow.com/users/6434897/themrone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499888917, "creation_date": 1499888917, "question_id": 45066360, "link": "https://stackoverflow.com/questions/45066360/how-to-handle-huge-amount-of-events-for-a-real-time-application", "title": "How to handle huge amount of events for a real time application?", "body": "<p>I couldn't find a good title for this question. Sorry for that. I try to explain it with an example. We are thinking about this a long time now, but we are not sure how to do it.</p>\n\n<p>I am developing with some friends a web application where users can execute actions and they will take place sometime in the future. Our goal is it, to always provide 100% fresh data over our api. Our idea was to build our application in 3 parts. The Api (for the actions), the frontend (maybe nodejs, only showing information) and workers (n amount, scaleable / probably C# .NET Core application).</p>\n\n<p>Example:\nUser1 executes Action 'A' over the API => server calculates execute time, it should be executed at 14:00 o'clock.</p>\n\n<p>We have now the following problem. What if 10000 users execute 200 actions that should take place on 14:00 o'clock? (Some events have dependencies on each other, the reason why async gets difficult). Of course the workers can handle the events, but how do we ensure that a request over the API all the time has fresh data?</p>\n\n<p>I got the idea that the users send requests to the api and get a OK + a event id back. The Api handles the request and sends an result response over a websocket connection back to the user. But how do we ensure that it won't take longer than a usual api call. It has to be real time for the users, so it has to be scaleable.</p>\n\n<p>We had a look into RabbitMQ for example, but this can't fit our criteria because we have to ensure that NO data gets lost or stuck.\n(P.s. We know that we have to provide a solid database structure for this amount of events => we created a big mysql cluster for this)</p>\n\n<p>I hope someone finds a way to give some ideas.\nFeel free to ask questions if it helps you to answer my question. :)</p>\n\n<p>Greets,\nTheMrone</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "oracle"], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 5552027, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/f287e6d3d46a7760def047d3e0e0573e?s=128&d=identicon&r=PG&f=1", "display_name": "d ei", "link": "https://stackoverflow.com/users/5552027/d-ei"}, "is_accepted": false, "score": 1, "last_activity_date": 1499892685, "creation_date": 1499892685, "answer_id": 45067308, "question_id": 45066325, "link": "https://stackoverflow.com/questions/45066325/asp-net-mvc-5-ef-6-sln-works-in-visual-studio-2015-fails-in-vs-2017/45067308#45067308", "title": "ASP.Net MVC-5/EF-6 sln works in Visual Studio 2015, fails in VS 2017", "body": "<p>I solved this problem by installing the Oracle Developer Tools for Visual Studio 2017. </p>\n"}, {"tags": [], "owner": {"reputation": 2507, "user_id": 8063048, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/aplSW.jpg?s=128&g=1", "display_name": "Hong Van Vit", "link": "https://stackoverflow.com/users/8063048/hong-van-vit"}, "is_accepted": true, "score": 1, "last_activity_date": 1500614210, "creation_date": 1500614210, "answer_id": 45229482, "question_id": 45066325, "link": "https://stackoverflow.com/questions/45066325/asp-net-mvc-5-ef-6-sln-works-in-visual-studio-2015-fails-in-vs-2017/45229482#45229482", "title": "ASP.Net MVC-5/EF-6 sln works in Visual Studio 2015, fails in VS 2017", "body": "<p>You need to install \nOracle Developer Tools for Visual Studio 2017.\nLink download here:\n<a href=\"http://www.oracle.com/technetwork/topics/dotnet/downloads/odacmsidownloadvs2017-3806459.html\" rel=\"nofollow noreferrer\">http://www.oracle.com/technetwork/topics/dotnet/downloads/odacmsidownloadvs2017-3806459.html</a></p>\n"}], "owner": {"reputation": 387, "user_id": 5552027, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/f287e6d3d46a7760def047d3e0e0573e?s=128&d=identicon&r=PG&f=1", "display_name": "d ei", "link": "https://stackoverflow.com/users/5552027/d-ei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 45229482, "answer_count": 2, "score": 0, "last_activity_date": 1500614210, "creation_date": 1499888777, "question_id": 45066325, "link": "https://stackoverflow.com/questions/45066325/asp-net-mvc-5-ef-6-sln-works-in-visual-studio-2015-fails-in-vs-2017", "title": "ASP.Net MVC-5/EF-6 sln works in Visual Studio 2015, fails in VS 2017", "body": "<p>I have an MVC-5/EF-6 ASP.Net project/sln that builds without error and runs correctly in Visual Studio 2015. When I build the solution in Visual Studio 2017, I get the following error message:</p>\n\n<p>Error 175: The ADO.NET provider with invariant name 'Oracle.ManagedDataAccess.Client' is either not registered in the machine or application config file, or could not be loaded. See the inner exception for details.\nNissan  D:\\home\\Nissan\\Website\\Nissan\\EnitityModel\\Nissan.edmx</p>\n\n<p>Also, the project fails to run, and the edmx viewer cannot open.\nFrom NuGet, the project uses (among other things):\n    Package                              Installed Version   Latest Version\n   EntityFramework                          v6.2.0-beta1      v6.2.0-beta1\n   Oracle.ManagedDataAccess                 v12.1.24160719    v12.2.2.1100\n   Oracle.ManagedDataAccess.EntityFramework v12.1.2400        v12.2.2.1100</p>\n\n<p>All NuGet packages are up-to-date except the 2 Oracle.ManagedDataAccess packages. If I update them, project still builds and runs using VS 2015, but I can no longer view the edmx file (\"Cannot load Nissan.edmx: Exception has been thrown...\"). Any idea what is keeping my project from building in VS 2017?</p>\n"}, {"tags": ["c#", "azure", "visual-studio-2017", "azure-functions"], "comments": [{"owner": {"reputation": 13531, "user_id": 1384539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zpNUp.jpg?s=128&g=1", "display_name": "Thiago Custodio", "link": "https://stackoverflow.com/users/1384539/thiago-custodio"}, "edited": false, "score": 1, "creation_date": 1499896666, "post_id": 45066280, "comment_id": 77109623, "body": "Are you running VS with administrative priviledge?"}, {"owner": {"reputation": 896, "user_id": 895305, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bd1307115f2e5f5504b982265bae0c9?s=128&d=identicon&r=PG", "display_name": "bc3tech", "link": "https://stackoverflow.com/users/895305/bc3tech"}, "reply_to_user": {"reputation": 13531, "user_id": 1384539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zpNUp.jpg?s=128&g=1", "display_name": "Thiago Custodio", "link": "https://stackoverflow.com/users/1384539/thiago-custodio"}, "edited": false, "score": 0, "creation_date": 1500049491, "post_id": 45066280, "comment_id": 77186470, "body": "I wasn&#39;t, no, and turns out I don&#39;t need to. It just started working. &#175;\\_(\u30c4)_/&#175;"}], "answers": [{"tags": [], "owner": {"reputation": 896, "user_id": 895305, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bd1307115f2e5f5504b982265bae0c9?s=128&d=identicon&r=PG", "display_name": "bc3tech", "link": "https://stackoverflow.com/users/895305/bc3tech"}, "is_accepted": false, "score": 0, "last_activity_date": 1500049458, "creation_date": 1500049458, "answer_id": 45107648, "question_id": 45066280, "link": "https://stackoverflow.com/questions/45066280/how-do-i-debug-an-azure-function-locally-with-visual-studio/45107648#45107648", "title": "How do I debug an Azure Function locally with Visual Studio?", "body": "<p>After a reboot of my machine and no other changes, F5 in an Azure Functions app is working successfully.</p>\n\n<p>Would be nice if anybody could help get to the bottom of what would have been causing this error, though.</p>\n"}], "owner": {"reputation": 896, "user_id": 895305, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bd1307115f2e5f5504b982265bae0c9?s=128&d=identicon&r=PG", "display_name": "bc3tech", "link": "https://stackoverflow.com/users/895305/bc3tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 840, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505287358, "creation_date": 1499888628, "last_edit_date": 1505287358, "question_id": 45066280, "link": "https://stackoverflow.com/questions/45066280/how-do-i-debug-an-azure-function-locally-with-visual-studio", "title": "How do I debug an Azure Function locally with Visual Studio?", "body": "<p>I've got a C# TimerTrigger Azure Function but cannot F5 in to it and hit a breakpoint. Every time I try I'm met with:</p>\n\n<pre><code>[7/12/2017 7:39:52 PM] Job host started\nError: listen EACCES 0.0.0.0:5858\n    at Object.exports._errnoException (util.js:1026:11)\n    at exports._exceptionWithHostPort (util.js:1049:20)\n    at Agent.Server._listen2 (net.js:1240:19)\n    at listen (net.js:1289:10)\n    at net.js:1399:9\n    at _combinedTickCallback (internal/process/next_tick.js:77:11)\n    at process._tickCallback (internal/process/next_tick.js:98:9)\n</code></pre>\n\n<p>Which looks an awfully lot like a firewall exception. I've allowed func.exe thru, as well as the offending (or so it seems) port 5858 but neither have helped.</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-core", "asp.net-core-mvc", "automapper"], "answers": [{"tags": [], "owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "is_accepted": false, "score": 1, "last_activity_date": 1499888662, "creation_date": 1499888662, "answer_id": 45066288, "question_id": 45066200, "link": "https://stackoverflow.com/questions/45066200/telling-automapper-to-convert-from-objectlist-property-to-list-of-just-the-ids/45066288#45066288", "title": "Telling AutoMapper to convert from ObjectList property to list of just the Ids", "body": "<p>Was able to achieve this with the following:</p>\n\n<pre><code>CreateMap&lt;User, UserViewModel&gt;()\n            .ForMember(vm =&gt; vm.RoleIds, opt =&gt; opt.MapFrom(u =&gt; u.Roles.Select(r =&gt; r.Id)));\n</code></pre>\n"}], "owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499888662, "creation_date": 1499888272, "question_id": 45066200, "link": "https://stackoverflow.com/questions/45066200/telling-automapper-to-convert-from-objectlist-property-to-list-of-just-the-ids", "title": "Telling AutoMapper to convert from ObjectList property to list of just the Ids", "body": "<p>I have a GetUserById function that returns a User. The User has a Roles property which is an object list of Roles.<br>\n<strong>Role class looks like this:</strong></p>\n\n<pre><code>public int Id { get; set; }\npublic int Name { get; set; }\n</code></pre>\n\n<p>In my MVC UI I have a UserViewModel that has a property List RoleIds since all the view needs to now about is the Role Ids to select the appropriate values in my MultiSelect.</p>\n\n<p>When I use AutoMapper to convert from User to UserViewModel how can I specify that I want to take all of the Ids from User.Roles and put them in UserViewModel.RoleIds in the mapping settings.</p>\n"}, {"tags": ["c#", "winforms", "mschart"], "comments": [{"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1499889471, "post_id": 45066171, "comment_id": 77106279, "body": "Fastline doesn&#39;t support all features; does the problem persist when changing to Line?"}, {"owner": {"reputation": 861, "user_id": 7370267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8185844a6bdcb5d266a112d612a14db3?s=128&d=identicon&r=PG&f=1", "display_name": "pitersmx", "link": "https://stackoverflow.com/users/7370267/pitersmx"}, "reply_to_user": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1499891066, "post_id": 45066171, "comment_id": 77107043, "body": "Well, when I changed it to <code>Line</code> everything works AS EXPECTED - Thanks TaW, but the rendering of the chart is much slower. I have charts with 30k points so when zoomed it slows down quite too much. Anyone knows how to make it more smooth?"}, {"owner": {"reputation": 861, "user_id": 7370267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8185844a6bdcb5d266a112d612a14db3?s=128&d=identicon&r=PG&f=1", "display_name": "pitersmx", "link": "https://stackoverflow.com/users/7370267/pitersmx"}, "reply_to_user": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 1, "creation_date": 1499891536, "post_id": 45066171, "comment_id": 77107289, "body": "@TaW Can you post your comment as an answer? Actually it solves the problem. It might be useful to the others."}], "answers": [{"tags": [], "owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "is_accepted": true, "score": 2, "last_activity_date": 1499893923, "last_edit_date": 1499893923, "creation_date": 1499893345, "answer_id": 45067459, "question_id": 45066171, "link": "https://stackoverflow.com/questions/45066171/incorrect-empty-datapoints-display-in-a-fastline-chart/45067459#45067459", "title": "Incorrect empty datapoints display in a fastline chart", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/dd489249.aspx\" rel=\"nofollow noreferrer\"><code>ChartType.FastLine</code></a> is much faster the the simple <code>Line</code> chart but to be so fast it makes several simplifications in rendering, which means that not all chart features are supported:</p>\n\n<blockquote>\n  <p>The FastLine chart type is a variation of the Line chart that\n  significantly reduces the drawing time of a series that contains a\n  very large number of data points. Use this chart in situations where\n  very large data sets are used and rendering speed is critical.</p>\n  \n  <p>Some charting features are omitted from the FastLine chart to improve\n  performance. The features omitted include control of point level\n  visual attributes, markers, data point labels, and shadows.</p>\n</blockquote>\n\n<p>Unfortunately <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.datavisualization.charting.series.emptypointstyle(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>EmptyPointStyle</code></a> is such a '<em>point level visual attribute</em>'.</p>\n\n<p>So you will need to <strong>decide</strong> which is more important: The raw speed or the direct and plausible treatment of empty <code>DataPoints</code>.</p>\n\n<p>(I have a hunch that you'll go for your 'dummy solution', which imo is a 1st class workaround ;-)</p>\n"}], "owner": {"reputation": 861, "user_id": 7370267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8185844a6bdcb5d266a112d612a14db3?s=128&d=identicon&r=PG&f=1", "display_name": "pitersmx", "link": "https://stackoverflow.com/users/7370267/pitersmx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "accepted_answer_id": 45067459, "answer_count": 1, "score": 2, "last_activity_date": 1499893979, "creation_date": 1499888168, "last_edit_date": 1499893979, "question_id": 45066171, "link": "https://stackoverflow.com/questions/45066171/incorrect-empty-datapoints-display-in-a-fastline-chart", "title": "Incorrect empty datapoints display in a fastline chart", "body": "<p>I have a fast-line chart series where on X I have <code>DateTime</code> and on Y <code>double</code> values - series is added to the chart with such method:</p>\n\n<pre><code>public virtual bool AddOrUpdateSeries(int caIndex, Series newSeries, bool visibleInLegend)\n{\n    var chartArea = GetChartArea(caIndex);\n\n    if (chartArea == null) return false;\n\n    var existingSeries = _chart.Series.FirstOrDefault(s =&gt; s.Name == newSeries.Name);\n\n    if (existingSeries != null)\n    {\n        existingSeries.Points.Clear();\n        AddPoints(newSeries.Points, existingSeries);\n    }\n    else\n    {\n        newSeries.ChartArea = chartArea.Name;\n        newSeries.Legend = chartArea.Name;\n        newSeries.IsVisibleInLegend = visibleInLegend;\n        newSeries.BorderWidth = 2;\n        newSeries.EmptyPointStyle = new DataPointCustomProperties { Color = Color.Red };\n\n        _chart.Series.Add(newSeries);\n    }\n\n    return true;\n}\n</code></pre>\n\n<p>As you can see, I am setting the style for empty point to be shown in red.</p>\n\n<p>The first points that are added to the series are as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/d1kjA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d1kjA.png\" alt=\"enter image description here\"></a></p>\n\n<p>So as you can see, first two points have the same Y value, but in addition -\n first one has <code>IsEmpty</code> flag set.</p>\n\n<p>Empty point is added to the series with such piece of code:</p>\n\n<pre><code> series.Points.Add(new DataPoint\n {\n    XValue = _beginOADate, \n    YValues = new[] { firstDbPoint.Y }, \n    IsEmpty = true\n });\n</code></pre>\n\n<p>where <code>_beginOADate</code> is double OADate value = <code>42563</code> = <code>12/07/2016 00:00 as DateTime</code>.</p>\n\n<p>The second point's <code>DateTime</code> is <code>15/08/2016 22:20</code></p>\n\n<p>When chart is displayed with the beginning of the X axis, everything looks ok as on the picture below - empty datapoint starts at 12/07/2016 and lasts until 15/08/2016. \n<a href=\"https://i.stack.imgur.com/qwjLm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qwjLm.png\" alt=\"enter image description here\"></a></p>\n\n<p>But, when I scroll one position on X, the empty datapoint's red line is not being displayed - instead, whole visible part of empty datapoint's line is displayed as it is non-empty:</p>\n\n<p><a href=\"https://i.stack.imgur.com/giDuM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/giDuM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Anybody knows how to fix this behaviour so that the whole line starting from Empty datapoint until first non-empty datapoint would always be shown in red?</p>\n\n<p>Of course the dummy solution would be to add one more extra empty datapoint very close to the first non-empty point, but I don't like that solution.</p>\n"}, {"tags": ["c#", ".net", "sql-server", "sqlclr"], "comments": [{"owner": {"reputation": 41249, "user_id": 577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYyIG.jpg?s=128&g=1", "display_name": "Solomon Rutzky", "link": "https://stackoverflow.com/users/577765/solomon-rutzky"}, "edited": false, "score": 0, "creation_date": 1499890424, "post_id": 45066148, "comment_id": 77106758, "body": "In addition to the suggestions noted in @Matt&#39;s answer, you should also consider the following: remove <code>TableDefinition=&quot;localtime datetime2&quot;,</code> from the attribute; use <code>SqlString</code> instead of <code>string</code> for <code>timezoneid</code> (which will require changing <code>timezoneid</code> in the <code>return</code> to be <code>timezoneid.Value</code>); and change <code>@timezoneid</code> from <code>NVARCHAR(MAX) </code>to NVARCHAR(50) or whatever size makes sense that is not <code>MAX</code>. Also, please be aware that the <code>TimeZoneInfo</code> class has a memory leak, which is why it requires the Assembly to be marked as <code>UNSAFE</code>."}, {"owner": {"reputation": 41249, "user_id": 577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYyIG.jpg?s=128&g=1", "display_name": "Solomon Rutzky", "link": "https://stackoverflow.com/users/577765/solomon-rutzky"}, "edited": false, "score": 0, "creation_date": 1499891261, "post_id": 45066148, "comment_id": 77107147, "body": "For more information about working with SQLCLR in general, please see the series I am writing on this topic on SQL Server Central: <a href=\"http://www.sqlservercentral.com/stairway/105855/\" rel=\"nofollow noreferrer\">Stairway To SQLCLR</a> (free registration is required to read their content, but it&#39;s worth it)."}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "reply_to_user": {"reputation": 41249, "user_id": 577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYyIG.jpg?s=128&g=1", "display_name": "Solomon Rutzky", "link": "https://stackoverflow.com/users/577765/solomon-rutzky"}, "edited": false, "score": 0, "creation_date": 1499893599, "post_id": 45066148, "comment_id": 77108286, "body": "@srutzky - <a href=\"https://msdn.microsoft.com/en-us/library/system.security.permissions.hostprotectionattribute.mayleakonabort.aspx\" rel=\"nofollow noreferrer\"><code>HostProtectionAttribute.MayLeakOnAbort</code></a> does not mean &quot;has a memory leak&quot;."}, {"owner": {"reputation": 41249, "user_id": 577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYyIG.jpg?s=128&g=1", "display_name": "Solomon Rutzky", "link": "https://stackoverflow.com/users/577765/solomon-rutzky"}, "reply_to_user": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1499895500, "post_id": 45066148, "comment_id": 77109198, "body": "@MattJohnson Thanks for that link. So just means &quot;<i>can</i> leak, <i>if</i> aborted&quot;, right? As in, won&#39;t leak if allowed to complete successfully?"}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1499898026, "post_id": 45066148, "comment_id": 77110142, "body": "Right.  It&#39;s a highly unlikely event.  One could even argue that the attribute isn&#39;t necessary on this particular class, though there&#39;s not much can be done about that now."}, {"owner": {"reputation": 41249, "user_id": 577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYyIG.jpg?s=128&g=1", "display_name": "Solomon Rutzky", "link": "https://stackoverflow.com/users/577765/solomon-rutzky"}, "reply_to_user": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1499960974, "post_id": 45066148, "comment_id": 77143481, "body": "@MattJohnson Thanks for confirming that. I do recall a question on SQL Server Central from a few years ago in which someone was experiencing a memory leak using <code>TimeZoneInfo</code> and doing bulk updates. Of course, I didn&#39;t get a chance to fully investigate to see if calling <code>GC</code> would fix it or if it ever corrected itself over a long-enough period of time. It&#39;s possible the O.P. there was just impatient ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 5710, "user_id": 85661, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2dbf658a6000684870711ebf974eaae8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Is Fiddling By Firelight", "link": "https://stackoverflow.com/users/85661/dan-is-fiddling-by-firelight"}, "edited": false, "score": 0, "creation_date": 1499890423, "post_id": 45066617, "comment_id": 77106756, "body": "I need to get the existing site running (all I got was a snapshot of code apparently copied off the web server and a DB dump, no documentation at all) before I can think about starting to apply a dozen+ years of skipped code modernization to it.  Would what I currently have have worked with an older pairing of .net/sql server; or do I need to climb even deeper into the rabbit hole trying to figure out what&#39;s going on."}, {"owner": {"reputation": 41249, "user_id": 577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYyIG.jpg?s=128&g=1", "display_name": "Solomon Rutzky", "link": "https://stackoverflow.com/users/577765/solomon-rutzky"}, "reply_to_user": {"reputation": 5710, "user_id": 85661, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2dbf658a6000684870711ebf974eaae8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Is Fiddling By Firelight", "link": "https://stackoverflow.com/users/85661/dan-is-fiddling-by-firelight"}, "edited": false, "score": 0, "creation_date": 1499890567, "post_id": 45066617, "comment_id": 77106825, "body": "@DanNeely There is no way that the code you posted in the question ever would have worked. The only way to return a table is if the return type in .NET is <code>IEnumerable</code>. And I don&#39;t think you can pass back a table without having a FillRowMethod noted in the <code>SqlFunction</code> attribute. This is all in addtion to the two items mentioned by Matt in this answer (which is entirely correct, btw, so +1 there)."}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1499890617, "post_id": 45066617, "comment_id": 77106842, "body": "Right.  It wouldn&#39;t have worked, because the .net code returns a single value, and your SQL wrapper expects a table.  Scalar-valued functions are different than table-valued functions.  <a href=\"https://docs.microsoft.com/en-us/sql/relational-databases/clr-integration-database-objects-user-defined-functions/clr-user-defined-functions\" rel=\"nofollow noreferrer\">Read here</a>."}, {"owner": {"reputation": 5710, "user_id": 85661, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2dbf658a6000684870711ebf974eaae8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Is Fiddling By Firelight", "link": "https://stackoverflow.com/users/85661/dan-is-fiddling-by-firelight"}, "edited": false, "score": 0, "creation_date": 1499891584, "post_id": 45066617, "comment_id": 77107316, "body": "ok.  I have a backup of the existing sites production database. Is there a way to view whatever was published to that so I can make sure whatever fix I do with the C# corresponds to whatever the previous dev actually managed to get into the system somehow?"}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1499892150, "post_id": 45066617, "comment_id": 77107583, "body": "Yes, but that&#39;s a different question.  Please give it a try and normal research first, and if you get stuck on that, then ask about that in a new question.  Remember, the primary goal of StackOverflow is to create question/answer pairs that are valuable to a large audience, not just to assist with your particular issue.  Thanks."}, {"owner": {"reputation": 41249, "user_id": 577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYyIG.jpg?s=128&g=1", "display_name": "Solomon Rutzky", "link": "https://stackoverflow.com/users/577765/solomon-rutzky"}, "reply_to_user": {"reputation": 5710, "user_id": 85661, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2dbf658a6000684870711ebf974eaae8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Is Fiddling By Firelight", "link": "https://stackoverflow.com/users/85661/dan-is-fiddling-by-firelight"}, "edited": false, "score": 0, "creation_date": 1499893764, "post_id": 45066617, "comment_id": 77108362, "body": "@DanNeely If this is presently working in Production, then at the very least you can script out the <code>CREATE FUNCTION</code> statement in SQL Server Management Studio (SSMS). That should get you started :)."}, {"owner": {"reputation": 5710, "user_id": 85661, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2dbf658a6000684870711ebf974eaae8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Is Fiddling By Firelight", "link": "https://stackoverflow.com/users/85661/dan-is-fiddling-by-firelight"}, "edited": false, "score": 1, "creation_date": 1499955889, "post_id": 45066617, "comment_id": 77139518, "body": "Followup posted:  <a href=\"https://stackoverflow.com/questions/45083492/how-can-i-get-the-definition-of-a-sql-clr-function-from-the-database\" title=\"how can i get the definition of a sql clr function from the database\">stackoverflow.com/questions/45083492/&hellip;</a>"}], "tags": [], "owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "is_accepted": true, "score": 3, "last_activity_date": 1499889938, "creation_date": 1499889938, "answer_id": 45066617, "question_id": 45066148, "link": "https://stackoverflow.com/questions/45066148/datetime-type-mismatch-trying-to-publish-a-sql-clr-database/45066617#45066617", "title": "Datetime type mismatch trying to publish a SQL CLR database", "body": "<p>The SQL function doesn't match the .NET method signature.  To make it match:</p>\n\n<ol>\n<li><p>Change your the type of <code>@utctime</code> to <code>DATETIME2</code> instead of <code>DATETIME</code> in the function definition.</p></li>\n<li><p>Change the return type to just <code>RETURNS DATETIME2</code> instead of returning a table with a nullable datetime2 column.</p></li>\n</ol>\n\n<p>Also, note that if you are on SQL 2016 or later, or on Azure SQL DB, you don't need this function, as you can now use <code>AT TIME ZONE</code> instead.</p>\n"}], "owner": {"reputation": 5710, "user_id": 85661, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/2dbf658a6000684870711ebf974eaae8?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Is Fiddling By Firelight", "link": "https://stackoverflow.com/users/85661/dan-is-fiddling-by-firelight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "accepted_answer_id": 45066617, "answer_count": 1, "score": 3, "last_activity_date": 1499959686, "creation_date": 1499888070, "last_edit_date": 1499959686, "question_id": 45066148, "link": "https://stackoverflow.com/questions/45066148/datetime-type-mismatch-trying-to-publish-a-sql-clr-database", "title": "Datetime type mismatch trying to publish a SQL CLR database", "body": "<p>I'm trying to stand up an old solution that's publishing a number of .net functions to a SQL Server database. But the attempt to publish to a new database is failing on a function that manipulates dates.  </p>\n\n<p>The function that's failing is:</p>\n\n<pre><code>[SqlFunction(TableDefinition=\"localtime datetime2\", IsDeterministic=true, IsPrecise=true,\n             DataAccess=DataAccessKind.None,\n             SystemDataAccess=SystemDataAccessKind.None)]\npublic static DateTime ConvertFromUTC(DateTime utctime, string timezoneid)\n{\n    if (utctime.Kind == DateTimeKind.Unspecified)\n        utctime = DateTime.SpecifyKind( utctime, DateTimeKind.Utc );\n\n    utctime = utctime.ToUniversalTime();\n\n    return TimeZoneInfo.ConvertTimeBySystemTimeZoneId( utctime, timezoneid );\n}\n</code></pre>\n\n<p>The error message I get when attempting to publish is:</p>\n\n<blockquote>\n  <p>Creating [dbo].[ConvertFromUTC]...</p>\n  \n  <p>(268,1): SQL72014: .Net SqlClient Data Provider:    </p>\n  \n  <p>Msg 6551, Level 16, State 2, Procedure ConvertFromUTC, Line 1<br>\n  CREATE FUNCTION for \"ConvertFromUTC\" failed because T-SQL and CLR types for return value do not match.</p>\n  \n  <p>(268,0): SQL72045: Script execution error</p>\n</blockquote>\n\n<p>SQL generated from the .net in an attempt to add the function:</p>\n\n<pre><code>CREATE FUNCTION [dbo].[ConvertFromUTC]\n    (@utctime DATETIME, @timezoneid NVARCHAR (MAX))\nRETURNS TABLE ([localtime] DATETIME2 (7) NULL)\nAS EXTERNAL NAME [database].[IntelligentTutor.Database.Functions].[ConvertFromUTC]\n</code></pre>\n\n<p>SQL definition for the version of the function in the existing database (which confirms that @MattJohnson was right about how it needs fixed):</p>\n\n<pre><code>CREATE FUNCTION [dbo].[ConvertFromUTC]\n    (@utctime [datetime], @timezoneid [nvarchar](4000))\nRETURNS [datetime] WITH EXECUTE AS CALLER\nAS EXTERNAL NAME [database].[IntelligentTutor.Database.Functions].[ConvertFromUTC]\n</code></pre>\n"}, {"tags": ["c#", "com+"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1499887930, "post_id": 45066098, "comment_id": 77105508, "body": "is there any InnerException?"}, {"owner": {"reputation": 189, "user_id": 1542925, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7da614c53a3ec354d0ccfc23e681843a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1542925/michael"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1499888072, "post_id": 45066098, "comment_id": 77105582, "body": "Unfortunately not."}], "owner": {"reputation": 189, "user_id": 1542925, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7da614c53a3ec354d0ccfc23e681843a?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1542925/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499887957, "creation_date": 1499887864, "last_edit_date": 1499887957, "question_id": 45066098, "link": "https://stackoverflow.com/questions/45066098/com-c-heavy-load", "title": "COM C# heavy load", "body": "<p>I'm using a central COM+ component that invoking other C# classes via the following code:</p>\n\n<pre><code>var comType = Type.GetTypeFromProgID(\"NameSpace.Class1\");\nAssembly assembly = Assembly.LoadFrom(\"Class1.dll\");\nvar abc = Activator.CreateInstance(comType);\n</code></pre>\n\n<p>Normally this peace of code is working fine. When simulate a heavy load on this central COM+ component the Activator can't create any instance. The class1 is not in the same folder as the central COM+ component.</p>\n\n<p>I get the following exception:</p>\n\n<pre><code>System.Runtime.Remoting.RemotingException: Cannot load type 'NameSpace, Class1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=95a767s6d7'.\n  at System.Runtime.Remoting.RemotingServices.GetOrCreateProxy(Identity idObj, Object proxy, Boolean fRefine)\n  at System.Runtime.Remoting.RemotingServices.InternalUnmarshal(ObjRef objectRef, Object proxy, Boolean fRefine)\n  at System.EnterpriseServices.ServicedComponentProxyAttribute.CreateInstance(Type serverType)\n  at System.Runtime.Remoting.Activation.ActivationServices.IsCurrentContextOK(RuntimeType serverType, Object[] props, Boolean bNewObj)\n  at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean&amp; canBeCached, RuntimeMethodHandleInternal&amp; ctor, Boolean&amp; bNeedSecurityCheck)\n  at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark&amp; stackMark)\n  at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark&amp; stackMark)\n  at System.Activator.CreateInstance(Type type, Boolean nonPublic)\n  at System.Activator.CreateInstance(Type type)\n  at Dummy.CreateBusinessLayerInstance(Type businessLayerType, Boolean remoteObject) \n</code></pre>\n\n<p>Any ideas to solve the problem? When I create the instance via DCOM everything is fine.</p>\n"}, {"tags": ["c#", "mongodb", "linq"], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1499889423, "post_id": 45066152, "comment_id": 77106254, "body": "Not working. Yours cannot even pass the compiling. By the way, the object class actually has lots of other fields, for simplicity, I just listed 3 fields here. For your query, do you mean Where(x=&gt;x.Status == true) ."}, {"owner": {"reputation": 447, "user_id": 4974596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191f476f38402dc0aa86c9871dbf2978?s=128&d=identicon&r=PG&f=1", "display_name": "kots", "link": "https://stackoverflow.com/users/4974596/kots"}, "reply_to_user": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1499891559, "post_id": 45066152, "comment_id": 77107304, "body": "Try it again. I updated my original post and tested it to be working. Both Where(x=&gt;x.Status == true) and Where(x=&gt;x.Status) is the same. Your Form class should have the Status as bool data type (not boolean)."}, {"owner": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1499950540, "post_id": 45066152, "comment_id": 77135033, "body": "I am getting the error &quot;An exception of type &#39;System.NotSupportedException&#39; occurred in MongoDB.Driver.dll but was not handled in user code  Additional information: The method OrderByDescending is not supported in the expression tree: {document}.OrderByDescending(c =&gt; c.Version).&quot;"}], "tags": [], "owner": {"reputation": 447, "user_id": 4974596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191f476f38402dc0aa86c9871dbf2978?s=128&d=identicon&r=PG&f=1", "display_name": "kots", "link": "https://stackoverflow.com/users/4974596/kots"}, "is_accepted": false, "score": 2, "last_activity_date": 1499891517, "last_edit_date": 1499891517, "creation_date": 1499888084, "answer_id": 45066152, "question_id": 45065989, "link": "https://stackoverflow.com/questions/45065989/c-query-mongodb-using-groupby/45066152#45066152", "title": "C# query MongoDB using GroupBy", "body": "<p>Updated my syntax and tested to be working.</p>\n\n<pre><code>this.Where(x =&gt; x.Status)\n            .GroupBy(item =&gt; new { item.FormId, item.Status })\n            .Select(x =&gt;\n                new Form\n                {\n                    FormId = x.First().FormId,\n                    Status = x.First().Status,\n                    Version = x.OrderByDescending(c =&gt; c.Version).First().Version\n                }\n            ).ToList();\n</code></pre>\n\n<p>Output:\n[{\"FormId\":\"1\",\"Status\":true,\"Version\":2},{\"FormId\":\"2\",\"Status\":true,\"Version\":2}]</p>\n\n<p>Actual Code used to test:</p>\n\n<pre><code>        var _json =\n            \"[{  \\\"FormId\\\":\\\"1\\\",  \\\"Status\\\":true,  \\\"Version\\\":1},{  \\\"FormId\\\":\\\"1\\\",  \\\"Status\\\":true,  \\\"Version\\\":2},{  \\\"FormId\\\":\\\"2\\\",  \\\"Status\\\":true,  \\\"Version\\\":1},{  \\\"FormId\\\":\\\"2\\\",  \\\"Status\\\":true,  \\\"Version\\\":2},{  \\\"FormId\\\":\\\"2\\\",  \\\"Status\\\":false,  \\\"Version\\\":1}]\";\n        var js = new JavaScriptSerializer();\n        List&lt;Form&gt; resultList = js.Deserialize&lt;List&lt;Form&gt;&gt;(_json);\n        var groupedResult = resultList.Where(x =&gt; x.Status).GroupBy(item =&gt; new { item.FormId, item.Status })\n            .Select(x =&gt;\n                new Form\n                {\n                    FormId = x.First().FormId,\n                    Status = x.First().Status,\n                    Version = x.OrderByDescending(c =&gt; c.Version).First().Version\n                }\n            ).ToList();\n        var output = js.Serialize(groupedResult);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1499959644, "post_id": 45072852, "comment_id": 77142546, "body": "What I want is a list of forms that the form is published(status is true) and the version is largest of that form."}, {"owner": {"reputation": 33, "user_id": 5088801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/khRXm.png?s=128&g=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/5088801/nik"}, "reply_to_user": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1500007254, "post_id": 45072852, "comment_id": 77161884, "body": "Okay so List of Form having all Status == true is the first requirement and then from the first requirement you want one object with the largest Version number ?"}, {"owner": {"reputation": 33, "user_id": 5088801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/khRXm.png?s=128&g=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/5088801/nik"}, "reply_to_user": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1500007498, "post_id": 45072852, "comment_id": 77161948, "body": "@user3293338 my given answer is correct . as you said you want List of data where Status == true &amp;&amp; FormId == 1 this will return :  &#39;{   &quot;FormId&quot;:&quot;1&quot;,   &quot;Status&quot;:true,   &quot;Version&quot;:1 }; {   &quot;FormId&quot;:&quot;1&quot;,   &quot;Status&quot;:true,   &quot;Version&quot;:2 };&#39;  and after that OrderByDescending(x =&gt; x.Version).First() wiill return : {   &quot;FormId&quot;:&quot;1&quot;,   &quot;Status&quot;:true,   &quot;Version&quot;:2 }"}, {"owner": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1500038967, "post_id": 45072852, "comment_id": 77179508, "body": "The result I want is {   &quot;FormId&quot;:&quot;1&quot;,   &quot;Status&quot;:true,   &quot;Version&quot;:2 }  and {   &quot;FormId&quot;:&quot;2&quot;,   &quot;Status&quot;:true,   &quot;Version&quot;:2 } . You can check my questions again..."}, {"owner": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1500387572, "post_id": 45072852, "comment_id": 77306864, "body": "If you are using Where(x =&gt; x.Status == true &amp;&amp; x.FormId == 1), how can you get a list of other FormId... I am not querying for a specific FormId, I want all the different FormId that with the highest version value..."}, {"owner": {"reputation": 33, "user_id": 5088801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/khRXm.png?s=128&g=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/5088801/nik"}, "reply_to_user": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "edited": false, "score": 0, "creation_date": 1500439807, "post_id": 45072852, "comment_id": 77330450, "body": "Remove &quot; &amp;&amp; x.FormId == 1&quot; from Where(x =&gt; x.Status == true &amp;&amp; x.FormId == 1)"}], "tags": [], "owner": {"reputation": 33, "user_id": 5088801, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/khRXm.png?s=128&g=1", "display_name": "Nik", "link": "https://stackoverflow.com/users/5088801/nik"}, "is_accepted": false, "score": 0, "last_activity_date": 1500439837, "last_edit_date": 1500439837, "creation_date": 1499926995, "answer_id": 45072852, "question_id": 45065989, "link": "https://stackoverflow.com/questions/45065989/c-query-mongodb-using-groupby/45072852#45072852", "title": "C# query MongoDB using GroupBy", "body": "<pre><code> public List&lt;Form&gt; GetFromDetails()\n{\n    var DB = new Database();\n    var collection = DB.GetCollection&lt;Form&gt;();\n\n    var query = new QueryBuilder&lt;Form&gt;();\n    var queryLst = new List&lt;IMongoQuery&gt;();\n    // {\n    //  \"FormId\":\"1\",\n    //  \"Status\":true,\n    //  \"Version\":1\n    //};\n    //{\n    //  \"FormId\":\"1\",\n    //  \"Status\":true,\n    //  \"Version\":2\n    //};\n    List&lt;Form&gt; finalResult = new List&lt;Form&gt;();\n\n\n    finalResult = collection.FindAll().Where(x =&gt; x.Status == true).ToList(); // pasing id 1\n    // {\n    //  \"FormId\":\"1\",\n    //  \"Status\":true,\n    //  \"Version\":1\n    //};\n    //{\n    //  \"FormId\":\"1\",\n    //  \"Status\":true,\n    //  \"Version\":2\n    //};\n    var finalResults = finalResult.Select(n =&gt; new Form\n    {\n        FormId = n.FormId,\n        Status = n.Status,\n        Version = finalResult.OrderByDescending(v =&gt; v.Version).First().Version\n    });\n    // {\n    //  \"FormId\":\"1\",\n    //  \"Status\":true,\n    //  \"Version\":2\n    //};\n    //{\n    //  \"FormId\":\"1\",\n    //  \"Status\":true,\n    //  \"Version\":2\n    //};\n    DB.Dispose();\n    return finalResult;\n}\n</code></pre>\n\n<p>Above Method will help and i'm done because i  myself made a demo its working</p>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 1420775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79973053533209d92184c65753a6c27?s=128&d=identicon&r=PG", "display_name": "Glaudson Silva", "link": "https://stackoverflow.com/users/1420775/glaudson-silva"}, "is_accepted": false, "score": 0, "last_activity_date": 1579693609, "creation_date": 1579693609, "answer_id": 59859089, "question_id": 45065989, "link": "https://stackoverflow.com/questions/45065989/c-query-mongodb-using-groupby/59859089#59859089", "title": "C# query MongoDB using GroupBy", "body": "<p>It didn't work for me, but I could make it by using Sort before Group. </p>\n\n<pre><code>return _context.Products\n                .Aggregate() \n                .Sort(Builders&lt;Product&gt;.Sort.Descending(\"InsertedDate\"))\n                .Group(x =&gt; x.Code, g =&gt; new {Code = g.Key, LastInsertedDate =  g.First().InsertedDate })\n                .ToList();\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 3293338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8270a0958a9d61eb1f68d7b5092c9de?s=128&d=identicon&r=PG&f=1", "display_name": "user3293338", "link": "https://stackoverflow.com/users/3293338/user3293338"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1766, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1579693609, "creation_date": 1499887445, "last_edit_date": 1500053741, "question_id": 45065989, "link": "https://stackoverflow.com/questions/45065989/c-query-mongodb-using-groupby", "title": "C# query MongoDB using GroupBy", "body": "<p>I have a mongodb object as following:</p>\n\n<pre><code>public class Form\n{\n    public string FormId { get; set; } \n    public boolean Status { get; set; } //Published or Draft\n    public int Version { get; set; } //The version of the same forms.\n}\n</code></pre>\n\n<p>For the same FormId, there could be different version number and different Status. Some example data such as:</p>\n\n<pre><code>{\n  \"FormId\":\"1\",\n  \"Status\":true,\n  \"Version\":1\n};\n{\n  \"FormId\":\"1\",\n  \"Status\":true,\n  \"Version\":2\n};\n{\n  \"FormId\":\"2\",\n  \"Status\":true,\n  \"Version\":1\n};\n{\n  \"FormId\":\"2\",\n  \"Status\":true,\n  \"Version\":2\n};\n{\n  \"FormId\":\"2\",\n  \"Status\":false,\n  \"Version\":1\n}\n</code></pre>\n\n<p>Now I want to get a list of forms that for the same FormId, the Status is true and the version number is the largest. So the query result should be:</p>\n\n<pre><code>{\n  \"FormId\":\"1\",\n  \"Status\":true,\n  \"Version\":2\n} \n</code></pre>\n\n<p>and </p>\n\n<pre><code>{\n  \"FormId\":\"2\",\n  \"Status\":true,\n  \"Version\":2\n}\n</code></pre>\n\n<p>I tried to write the query in C# using Lambda expression:</p>\n\n\n\n<pre><code>this.AsQueryable&lt;Form&gt;().Where(p=&gt;p.Status == true)\n            .GroupBy(item=&gt;item.FormId)\n            .Select(t=&gt;t.OrderByDescending(c =&gt; c.Version).FirstOrDefault()).ToList();\n</code></pre>\n\n<p>But I got error: </p>\n\n<blockquote>\n  <p>Additional information: FirstOrDefault of type System.Linq.Enumerable is not supported in the expression tree {document}.OrderByDescending(c => c.Version).FirstOrDefault().</p>\n</blockquote>\n\n<p>Does anyone know what is wrong with my code? By the way, how can I know what is supported or not supported in the expression tree?</p>\n\n<p><strong>I found out that if I write the query as following it works, but I believe this is not a good approach.</strong> </p>\n\n<pre><code>return this.AsQueryable&lt;FormTemplateEntity&gt;().Where(p=&gt;p.Status == true).ToList()\n            .GroupBy(item =&gt; item.FormId).ToList()\n            .Select(t =&gt; t.OrderByDescending(c =&gt; c.Version).FirstOrDefault()).ToList();\n</code></pre>\n"}, {"tags": ["c#", "ruby", "xamarin.forms", "ui-testing", "calabash-android"], "answers": [{"tags": [], "owner": {"reputation": 6630, "user_id": 3453898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MjQi5.png?s=128&g=1", "display_name": "pixel", "link": "https://stackoverflow.com/users/3453898/pixel"}, "is_accepted": false, "score": 0, "last_activity_date": 1499965668, "creation_date": 1499965668, "answer_id": 45087070, "question_id": 45065970, "link": "https://stackoverflow.com/questions/45065970/calabash-android-ui-test-detect-if-xamarin-forms-entry-field-has-focus/45087070#45087070", "title": "Calabash-android UI test - Detect if Xamarin.Forms Entry field has focus", "body": "<p>Figured this out.  Not exactly detecting field got focus but detecting that the keyboard is displayed which was my original question.</p>\n\n<p>When field is focused, keyboard is displayed and that is what I wanted to test in my Calabash test.</p>\n\n<p>So, going to Calabash API for Android <a href=\"http://calabashapi.xamarin.com/android/\" rel=\"nofollow noreferrer\">http://calabashapi.xamarin.com/android/</a>, I see TextHelpers contains keyboard_visible? which can be called from ruby definitions to check for keyboard visibility.</p>\n"}], "owner": {"reputation": 6630, "user_id": 3453898, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MjQi5.png?s=128&g=1", "display_name": "pixel", "link": "https://stackoverflow.com/users/3453898/pixel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499965668, "creation_date": 1499887376, "last_edit_date": 1499894497, "question_id": 45065970, "link": "https://stackoverflow.com/questions/45065970/calabash-android-ui-test-detect-if-xamarin-forms-entry-field-has-focus", "title": "Calabash-android UI test - Detect if Xamarin.Forms Entry field has focus", "body": "<p>My code will focus on Xamarin.Forms Entry field when its ContentView is displayed.  This will then automatically focus on an Xamarin.Forms Entry field on an Android device.</p>\n\n<p>Now, I would like to write a UI test to confirm that the field has been auto focused.</p>\n\n<p>How can I detect that an field has been autofocused in a Calabash/ruby test?</p>\n"}, {"tags": ["c#", "xamarin", "xamarin.forms"], "comments": [{"owner": {"reputation": 4560, "user_id": 8093394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-rAl_keJkKAM/AAAAAAAAAAI/AAAAAAAAl0o/Y2pvHWTFzBM/photo.jpg?sz=128", "display_name": "Diego Rafael Souza", "link": "https://stackoverflow.com/users/8093394/diego-rafael-souza"}, "edited": false, "score": 0, "creation_date": 1499888624, "post_id": 45065957, "comment_id": 77105835, "body": "What&#39;s the dimensions (width and height in pixels) of your images?"}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1499889068, "post_id": 45065957, "comment_id": 77106076, "body": "What is the exact exception?"}, {"owner": {"reputation": 937, "user_id": 5245420, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/10153152386520292/picture?type=large", "display_name": "Timothy James", "link": "https://stackoverflow.com/users/5245420/timothy-james"}, "edited": false, "score": 0, "creation_date": 1499896303, "post_id": 45065957, "comment_id": 77109499, "body": "Is Build Action set to <code>AndroidResource</code>?"}, {"owner": {"reputation": 276, "user_id": 4597704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1dPrX.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4597704/joe"}, "edited": false, "score": 0, "creation_date": 1499975140, "post_id": 45065957, "comment_id": 77151847, "body": "Where does is Relative Layout used? I see you using RelativeLayout Height and Width Constraints, but I don&#39;t see a <code>&lt;RealtiveLayout&gt;</code> anywhere in your markup"}], "answers": [{"comments": [{"owner": {"reputation": 276, "user_id": 4597704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1dPrX.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4597704/joe"}, "edited": false, "score": 0, "creation_date": 1499975303, "post_id": 45073592, "comment_id": 77151942, "body": "Looks like they use .jpg in the developer docs, but I haven&#39;t tested myself: <a href=\"https://developer.xamarin.com/guides/xamarin-forms/user-interface/images/\" rel=\"nofollow noreferrer\">developer.xamarin.com/guides/xamarin-forms/user-interface/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1301, "user_id": 8066583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbqOV.jpg?s=128&g=1", "display_name": "Venkata Swamy Balaraju", "link": "https://stackoverflow.com/users/8066583/venkata-swamy-balaraju"}, "is_accepted": true, "score": 1, "last_activity_date": 1499929409, "creation_date": 1499929409, "answer_id": 45073592, "question_id": 45065957, "link": "https://stackoverflow.com/questions/45065957/adding-an-image-to-xamarin-forms/45073592#45073592", "title": "Adding an Image to Xamarin forms", "body": "<p>Check your image name once logo_ComplexInstructions.jpg is it correct or not</p>\n\n<p>And </p>\n\n<p>I thought <strong>.jpg</strong> images don't support Xamarin.Forms(I don't know exatactly)</p>\n\n<p>Follow below links</p>\n\n<p><a href=\"https://developer.xamarin.com/api/type/System.Drawing.Imaging.ImageFormat/\" rel=\"nofollow noreferrer\">https://developer.xamarin.com/api/type/System.Drawing.Imaging.ImageFormat/</a></p>\n"}], "owner": {"reputation": 51, "user_id": 8127776, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/813b6437b1ca15823155cbc098e68d0d?s=128&d=identicon&r=PG&f=1", "display_name": "djklasj dsajdkla", "link": "https://stackoverflow.com/users/8127776/djklasj-dsajdkla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 45073592, "answer_count": 1, "score": 1, "last_activity_date": 1499929409, "creation_date": 1499887338, "question_id": 45065957, "link": "https://stackoverflow.com/questions/45065957/adding-an-image-to-xamarin-forms", "title": "Adding an Image to Xamarin forms", "body": "<p>still new in Xamarin forms I am trying to add an Image.</p>\n\n<p>I opened a new PCL project have a login form and a main page.</p>\n\n<p>I want to add to the main page the 2 images however one the image cause the project to crash and called an unhandeled exception.</p>\n\n<p>the is in the project. and add it also to the drawable libery of the Android project.</p>\n\n<p>hope to get help thanks.</p>\n\n<p>attaching my XAML the secound image called tmpImage is doing the issue:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;ContentPage xmlns=\"http://xamarin.com/schemas/2014/forms\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"\n         xmlns:local=\"clr-namespace:ComplexInstruction\"\n         x:Class=\"ComplexInstruction.MainPage\"&gt;\n\n&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"0,1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"0.1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"0.1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"0.1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"0.1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"0.1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"1*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"0.1*\"&gt;&lt;/RowDefinition&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"0.1*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"0.1*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"0.1*\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n\n\n    &lt;Image Aspect=\"Fill\" Source=\"logo_ComplexInstructions.jpg\" \n        RelativeLayout.WidthConstraint=\n          \"{ConstraintExpression Type=RelativeToParent, Property=Width}\"\n        RelativeLayout.HeightConstraint=\n          \"{ConstraintExpression Type=RelativeToParent, Property=Height}\" Opacity=\"0.3\" Grid.ColumnSpan=\"5\" Grid.Row=\"0\" Grid.RowSpan=\"2\" /&gt;\n\n\n\n\n       &lt;Image x:Name=\"tmpImage\" Aspect=\"Fill\" Source=\"SHA_6620.jpg\"\n        RelativeLayout.WidthConstraint=\n          \"{ConstraintExpression Type=RelativeToParent, Property=Width}\"\n        RelativeLayout.HeightConstraint=\n          \"{ConstraintExpression Type=RelativeToParent, Property=Height}\" \n Grid.ColumnSpan=\"5\" Grid.Row=\"3\" Grid.RowSpan=\"8\" /&gt;\n\n&lt;/Grid&gt;\n\n\n&lt;/ContentPage&gt;\n</code></pre>\n"}, {"tags": ["c#", "outlook"], "comments": [{"owner": {"reputation": 3806, "user_id": 7675833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBkWl.jpg?s=128&g=1", "display_name": "Travis Acton", "link": "https://stackoverflow.com/users/7675833/travis-acton"}, "edited": false, "score": 0, "creation_date": 1499890470, "post_id": 45065937, "comment_id": 77106781, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12423425/how-to-get-outlook-contact-groups-using-mapi\">How to get Outlook contact groups using MAPI?</a>"}, {"owner": {"reputation": 1, "user_id": 8297649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58016e33c66ceb0f4271950cba22c?s=128&d=identicon&r=PG&f=1", "display_name": "Just Testing", "link": "https://stackoverflow.com/users/8297649/just-testing"}, "reply_to_user": {"reputation": 3806, "user_id": 7675833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LBkWl.jpg?s=128&g=1", "display_name": "Travis Acton", "link": "https://stackoverflow.com/users/7675833/travis-acton"}, "edited": false, "score": 0, "creation_date": 1499894563, "post_id": 45065937, "comment_id": 77108741, "body": "I did not pay much attention to that piece of code because Contact Groups are not Distribution List Items, &lt;DistListItem&gt;, and folder.Items was throwing an error.  <code>foreach (var curr in folder.Items.OfType&lt;DistListItem&gt;())</code>  Since you brought it to my attention I dug a little deeper. I reluctantly followed VS suggested and added  <code>using System.Linq;</code>   and that worked. It returns a little more than I need but I can easily filter out the extra data. Thank you very much!"}], "owner": {"reputation": 1, "user_id": 8297649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a58016e33c66ceb0f4271950cba22c?s=128&d=identicon&r=PG&f=1", "display_name": "Just Testing", "link": "https://stackoverflow.com/users/8297649/just-testing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499887275, "creation_date": 1499887275, "question_id": 45065937, "link": "https://stackoverflow.com/questions/45065937/retrieve-contacts-from-outlook-contact-group-not-contact-list-using-c", "title": "Retrieve contacts from Outlook Contact Group not Contact List using C#", "body": "<p>I need to retrieve the email addresses from a user specified Outlook 2013 Contact Group. This VBA code I found elsewhere works perfectly but I need to convert it to C#. All of the C# examples I\u2019ve found pull the addresses from the Contact List instead of the user created Contact Group. Any help will be appreciated.  </p>\n\n<pre><code>    Public Function GetContactGroupAddresses()\n        Dim I As Integer\n        Dim AddressList As String\n        Dim Group As String\n        Dim olApp As Outlook.Application\n        Dim myNamespace As Object\n        Dim myFolder As Object\n        Dim myItem As Object\n        Dim WordApp As Object\n\n        AddressList = \" \"\n        Group = \"EmailTest\"\n\n        Set olApp = New Outlook.Application\n        With olApp\n            Set myNamespace = .GetNamespace(\"MAPI\")\n            Set myFolder = myNamespace.GetDefaultFolder(olFolderContacts)\n            Set myItem = myFolder.Items(Group)\n            For I = 1 To myItem.MemberCount\n                    AddressList = AddressList &amp; myItem.GetMember(I).Address\n        End With\n\n\n        GetContactGroupAddresses = AddressList \n\n    End Function\n</code></pre>\n"}, {"tags": ["c#", ".net", ".net-core", "google-cloud-ml-engine"], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 1399222, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/3eaecaf22a77e4389a2aa095cd164fdf?s=128&d=identicon&r=PG", "display_name": "rhaertel80", "link": "https://stackoverflow.com/users/1399222/rhaertel80"}, "edited": false, "score": 1, "creation_date": 1499888121, "post_id": 45065843, "comment_id": 77105603, "body": "You&#39;re correct -- you need to send the raw request. In your example <code>toSend</code> is unbound, so I&#39;m assuming there&#39;s a bug in the code as presented?"}, {"owner": {"reputation": 511, "user_id": 2589312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/120402887/picture?type=large", "display_name": "Tyler Findlay", "link": "https://stackoverflow.com/users/2589312/tyler-findlay"}, "reply_to_user": {"reputation": 7854, "user_id": 1399222, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/3eaecaf22a77e4389a2aa095cd164fdf?s=128&d=identicon&r=PG", "display_name": "rhaertel80", "link": "https://stackoverflow.com/users/1399222/rhaertel80"}, "edited": false, "score": 0, "creation_date": 1499889037, "post_id": 45065843, "comment_id": 77106058, "body": "You&#39;re correct! I tried to clean it up for StackOverflow and didn&#39;t recompile. Thanks @rhaertel80"}], "tags": [], "owner": {"reputation": 511, "user_id": 2589312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/120402887/picture?type=large", "display_name": "Tyler Findlay", "link": "https://stackoverflow.com/users/2589312/tyler-findlay"}, "is_accepted": true, "score": 3, "last_activity_date": 1499889014, "last_edit_date": 1499889014, "creation_date": 1499886923, "answer_id": 45065843, "question_id": 45065842, "link": "https://stackoverflow.com/questions/45065842/net-core-googlecloudmlv1predictrequest-execture-method-returns-null-response/45065843#45065843", "title": ".NET-Core GoogleCloudMlV1PredictRequest Execture Method Returns null Response", "body": "<p>After checking the Google API and seeing requests coming through, I thought something might be wrong with the library. I've posted details on my own blog here: <a href=\"http://tylerfindlay.com/net-core-googlecloudmlv1predictrequest-execture-method-returns-null-response/\" rel=\"nofollow noreferrer\">.NET-Core GoogleCloudMlV1PredictRequest Execture Method Returns null Response</a></p>\n\n<p>What's happening is the GoogleApiHttpBody doesn't serialize the \"instances\" object where the :predict endpoint is expecting it. I figured that out when I read the stream and saw this response:</p>\n\n<pre><code>{\"error\": \"&lt;strong&gt;Missing \\\"instances\\\" field in request body&lt;/strong&gt;: {\\\"httpBody\\\":{\\\"data\\\":\\\"{\\\\\\\"instances\\\\\\\":[{\\\\\\\"age\\\\\\\":25,\\\\\\\"workclass\\\\\\\":\\\\\\\" Private\\\\\\\",\\\\\\\"education\\\\\\\":\\\\\\\" 11th\\\\\\\",\\\\\\\"education_num\\\\\\\":7,\\\\\\\"marital_status\\\\\\\":\\\\\\\" Never - married\\\\\\\",\\\\\\\"occupation\\\\\\\":\\\\\\\" Machine - op - inspct\\\\\\\",\\\\\\\"relationship\\\\\\\":\\\\\\\" Own - child\\\\\\\",\\\\\\\"race\\\\\\\":\\\\\\\" Black\\\\\\\",\\\\\\\"gender\\\\\\\":\\\\\\\" Male\\\\\\\",\\\\\\\"capital_gain\\\\\\\":0,\\\\\\\"capital_loss\\\\\\\":0,\\\\\\\"hours_per_week\\\\\\\":40,\\\\\\\"native_country\\\\\\\":\\\\\\\" United - States\\\\\\\"}]}\\\"}}\"}\n</code></pre>\n\n<p>So, I simple changed my code as follows, and now I get the predict result back correctly</p>\n\n<pre><code>string credPath = @\".\\appkey.json\";\nvar json = File.ReadAllText(credPath);\nPersonalServiceAccountCred cr = JsonConvert.DeserializeObject(json);\n\n// Create an explicit ServiceAccountCredential credential\nvar xCred = new ServiceAccountCredential(new ServiceAccountCredential.Initializer(cr.ClientEmail) {\n    Scopes = new [] {\n        CloudMachineLearningEngineService.Scope.CloudPlatform\n    }\n}.FromPrivateKey(cr.PrivateKey));\n\nvar service = new CloudMachineLearningEngineService(new BaseClientService.Initializer {\n    HttpClientInitializer = xCred\n});\n\nProjectsResource.PredictRequest req = new ProjectsResource.PredictRequest(service, new GoogleCloudMlV1PredictRequest(), \"projects/{project-name}/models/census/versions/v1\");\n\nstring requestPath = req.Service.BaseUri + \nCloudMachineLearningEngineService.Version + \"/\" + req.Name + \":\" + req.MethodName;\nTask result = service.HttpClient.PostAsync(requestPath, new StringContent(\"{\\\"instances\\\": [{\\\"age\\\": 25, \\\"workclass\\\": \\\" Private\\\", \\\"education\\\": \\\" 11th\\\", \\\"education_num\\\": 7, \\\"marital_status\\\": \\\" Never - married\\\", \\\"occupation\\\": \\\" Machine - op - inspct\\\", \\\"relationship\\\": \\\" Own - child\\\", \\\"race\\\": \\\" Black\\\", \\\"gender\\\": \\\" Male\\\", \\\"capital_gain\\\": 0, \\\"capital_loss\\\": 0, \\\"hours_per_week\\\": 40, \\\"native_country\\\": \\\" United - States\\\"}]}\"));\nTask.WaitAll(result);\n\nHttpResponseMessage responseMessage = result.Result;\n\nTask responseStreamTask = responseMessage.Content.ReadAsStringAsync();\nTask.WaitAll(responseStreamTask);\n\nstring responseText = responseStreamTask.Result;\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 2589312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/120402887/picture?type=large", "display_name": "Tyler Findlay", "link": "https://stackoverflow.com/users/2589312/tyler-findlay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 45065843, "answer_count": 1, "score": 1, "last_activity_date": 1499889014, "creation_date": 1499886923, "question_id": 45065842, "link": "https://stackoverflow.com/questions/45065842/net-core-googlecloudmlv1predictrequest-execture-method-returns-null-response", "title": ".NET-Core GoogleCloudMlV1PredictRequest Execture Method Returns null Response", "body": "<p>In .NET-Core C#, I am using Googles ml API for interacting with the engine. The code I have for my predict method is here</p>\n\n<pre><code>string credPath = @\".\\appkey.json\";\nvar json = File.ReadAllText(credPath);\nPersonalServiceAccountCred cr = JsonConvert.DeserializeObject(json);\n\n// Create an explicit ServiceAccountCredential credential\nvar xCred = new ServiceAccountCredential(new \nServiceAccountCredential.Initializer(cr.ClientEmail)\n{\n    Scopes = new [] {\n        CloudMachineLearningEngineService.Scope.CloudPlatform\n    }\n}.FromPrivateKey(cr.PrivateKey));\n\nvar service = new CloudMachineLearningEngineService(new BaseClientService.Initializer {\n    HttpClientInitializer = xCred\n});\n\nProjectsResource.PredictRequest req = new ProjectsResource.PredictRequest(service, new GoogleCloudMlV1PredictRequest {\n    HttpBody = new GoogleApiHttpBody {\n        Data = \"{\\\"instances\\\": [{\\\"age\\\": 25, \\\"workclass\\\": \\\" Private\\\", \\\"education\\\": \\\" 11th\\\", \\\"education_num\\\": 7, \\\"marital_status\\\": \\\" Never - married\\\", \\\"occupation\\\": \\\" Machine - op - inspct\\\", \\\"relationship\\\": \\\" Own - child\\\", \\\"race\\\": \\\" Black\\\", \\\"gender\\\": \\\" Male\\\", \\\"capital_gain\\\": 0, \\\"capital_loss\\\": 0, \\\"hours_per_week\\\": 40, \\\"native_country\\\": \\\" United - States\\\"}]}\"\n}, \"projects/{project_name}/models/census/versions/v1\");\n\nGoogleApiHttpBody body = req.Execute();\n</code></pre>\n\n<p>However, I'm getting this response back on the GoogleApiHttpBody object:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sBQeJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sBQeJ.png\" alt=\"All null fields in GoogleApiHttpBody response object\"></a></p>\n\n<p>Does someone know what is going on?</p>\n"}, {"tags": ["c#", "mysql", "decimal"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1499887395, "post_id": 45065813, "comment_id": 77105224, "body": "Not sure if this is the problem, but there are cases where <a href=\"https://blogs.msmvps.com/jcoehoorn/blog/2014/05/12/can-we-stop-using-addwithvalue-already/\" rel=\"nofollow noreferrer\"><code>AddWithValue</code> picks the wrong type</a>"}, {"owner": {"reputation": 21714, "user_id": 847200, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac14814bcfc842f847af55f9b3ad55b5?s=128&d=identicon&r=PG", "display_name": "Arsen Zahray", "link": "https://stackoverflow.com/users/847200/arsen-zahray"}, "reply_to_user": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1499887444, "post_id": 45065813, "comment_id": 77105259, "body": "checked for that, and no; anyway,Rahul has the right answer, I didn&#39;t define how many decimals behind comma to use so mysql defaulted on 0"}, {"owner": {"reputation": 611, "user_id": 7127984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4393e02146d4a9d525aee3526d83ae7b?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj-kr", "link": "https://stackoverflow.com/users/7127984/manoj-kr"}, "edited": false, "score": 0, "creation_date": 1499887620, "post_id": 45065813, "comment_id": 77105348, "body": "You does not seems to follow proper definition for decimal type field. <a href=\"https://dev.mysql.com/doc/refman/5.7/en/precision-math-decimal-characteristics.html\" rel=\"nofollow noreferrer\">dev.mysql.com/doc/refman/5.7/en/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 71114, "user_id": 567435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zYyZz.jpg?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/567435/rahul"}, "is_accepted": true, "score": 3, "last_activity_date": 1499887161, "creation_date": 1499887161, "answer_id": 45065901, "question_id": 45065813, "link": "https://stackoverflow.com/questions/45065813/how-to-insert-decimal-into-mysql-database/45065901#45065901", "title": "How to insert decimal into mysql database?", "body": "<p>Umm, you forgot to define the size of the decimal column in form of <code>DECIMAL(M,D)</code>. So your column definition should be below which means total 30 digits long number which will have maximum 15 digits after decimal point</p>\n\n<pre><code>`amount` DECIMAL(30,15) NOT NULL,\n</code></pre>\n"}], "owner": {"reputation": 21714, "user_id": 847200, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ac14814bcfc842f847af55f9b3ad55b5?s=128&d=identicon&r=PG", "display_name": "Arsen Zahray", "link": "https://stackoverflow.com/users/847200/arsen-zahray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 45065901, "answer_count": 1, "score": 0, "last_activity_date": 1499887355, "creation_date": 1499886806, "last_edit_date": 1499887355, "question_id": 45065813, "link": "https://stackoverflow.com/questions/45065813/how-to-insert-decimal-into-mysql-database", "title": "How to insert decimal into mysql database?", "body": "<p>I have a curious issue getting my decimal values into mysql database.</p>\n\n<p>I have a table, with <code>amount</code> column marked as <code>decimal</code></p>\n\n<p>The column declaration looks something like this:</p>\n\n<pre><code>`amount` DECIMAL NOT NULL,\n</code></pre>\n\n<p>In my code, I'm trying to insert a row into that database using following</p>\n\n<pre><code>decimal amount=0.9902888269673553777395003M;\n\ncommand.CommandText=\"insert into `mytable` (..., `amount`, ....) values (....,@amount,...)\";\ncommand.Parameters.AddWithValue(\"@amount\", amount);\n</code></pre>\n\n<p>After I execute the command, the row gets inserted into the database, but the amount is always 0, no matter what I do.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c#", "wpf", "mvvm", "autofac"], "comments": [{"owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "edited": false, "score": 0, "creation_date": 1499890050, "post_id": 45065725, "comment_id": 77106577, "body": "Your code looks right. Could you include the stack trace of the exception ?"}, {"owner": {"reputation": 143, "user_id": 1021133, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0adf7f8c69db7c02bb0d7d835c1df2d9?s=128&d=identicon&r=PG", "display_name": "IgorMF", "link": "https://stackoverflow.com/users/1021133/igormf"}, "reply_to_user": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "edited": false, "score": 0, "creation_date": 1499894799, "post_id": 45065725, "comment_id": 77108860, "body": "@CyrilDurand thank you for your time. i&#39;ve edited my question since I wanted to property inject. Normal constructor injection is working fine!"}, {"owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "edited": false, "score": 0, "creation_date": 1499894889, "post_id": 45065725, "comment_id": 77108910, "body": "<code>[External Code]</code> is the interesting part :) Could you right click on it and &quot;show External Code&quot; then edit the post :)"}, {"owner": {"reputation": 143, "user_id": 1021133, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0adf7f8c69db7c02bb0d7d835c1df2d9?s=128&d=identicon&r=PG", "display_name": "IgorMF", "link": "https://stackoverflow.com/users/1021133/igormf"}, "reply_to_user": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "edited": false, "score": 0, "creation_date": 1499973511, "post_id": 45065725, "comment_id": 77151027, "body": "@CyrilDurand sorry I just realized i could do that, d&#39;uh! edited again"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 1021133, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0adf7f8c69db7c02bb0d7d835c1df2d9?s=128&d=identicon&r=PG", "display_name": "IgorMF", "link": "https://stackoverflow.com/users/1021133/igormf"}, "edited": false, "score": 0, "creation_date": 1500216416, "post_id": 45108374, "comment_id": 77229231, "body": "That&#39;s exactly what I was looking for. Thanks"}], "tags": [], "owner": {"reputation": 2999, "user_id": 2310124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16be4605fbf66cd62ebf3927919c974?s=128&d=identicon&r=PG", "display_name": "tdragon", "link": "https://stackoverflow.com/users/2310124/tdragon"}, "is_accepted": true, "score": 2, "last_activity_date": 1500052170, "creation_date": 1500052170, "answer_id": 45108374, "question_id": 45065725, "link": "https://stackoverflow.com/questions/45065725/autofac-property-injection-in-already-registered-service/45108374#45108374", "title": "Autofac Property Injection in already registered service", "body": "<p>Property Injection does not work out-of-the-box, you need to set up class you want to use property injection in, so</p>\n\n<pre><code>builder.RegisterType&lt;MyGlobalService&gt;().As&lt;IGlobalService&gt;().PropertiesAutowired().SingleInstance();\n</code></pre>\n\n<p>should do the trick. Or you could do this manually using <code>OnActivating</code> lifetime event.</p>\n"}], "owner": {"reputation": 143, "user_id": 1021133, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0adf7f8c69db7c02bb0d7d835c1df2d9?s=128&d=identicon&r=PG", "display_name": "IgorMF", "link": "https://stackoverflow.com/users/1021133/igormf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 45108374, "answer_count": 1, "score": 0, "last_activity_date": 1500215570, "creation_date": 1499886480, "last_edit_date": 1500215570, "question_id": 45065725, "link": "https://stackoverflow.com/questions/45065725/autofac-property-injection-in-already-registered-service", "title": "Autofac Property Injection in already registered service", "body": "<p>I'm using Autofac to DI and MVVM. I have a global service registered as such:</p>\n\n<pre><code>builder.RegisterType&lt;MyGlobalService&gt;().As&lt;IGlobalService&gt;().SingleInstance();\n</code></pre>\n\n<p>I'm also using <a href=\"https://github.com/ziyasal/Autofac.Extras.NLog\" rel=\"nofollow noreferrer\">Autofac.Extras.NLog</a> implementation for obvious logging purposes:</p>\n\n<pre><code>builder.RegisterModule&lt;NLogModule&gt;();\n</code></pre>\n\n<p>this way I can get the instance of that service and logger in any of my ViewModels:</p>\n\n<pre><code>namespace MyNameSpace.ViewModels\n{\n    class MyViewModel : BindableBase\n    {\n        readonly IGlobalService _globalService;\n        readonly ILogger _logger;\n\n        public MyViewModel (IGlobalService globalService, ILogger logger)\n        {\n            _globalService = globalService;\n            _logger = logger;\n\n}}}(...)\n</code></pre>\n\n<p>It works great.\nNow I <em>also</em> want logging support inside MyGlobalService. But this time, I would like to use Property Injection, instead of Constructor Injection.</p>\n\n<p>Question is: should I register such a rule differently?</p>\n\n<p>Example usage:</p>\n\n<pre><code>namespace MyNameSpace.GlobalServices\n{\n    class MyGlobalService : IGlobalService\n    {\n        public ILogger Logger { get; set; }\n\n        public MyGlobalService ()\n        {               \n            Logger.Debug(\"My Service Starting...\") \n            // no DI happening, getting exception because \"Logger\" is null\n\n}}}(...)\n</code></pre>\n\n<p>Edit: Answered below.</p>\n"}, {"tags": ["c#", "linq", "asynchronous", "async-await"], "comments": [{"owner": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 1, "creation_date": 1499886700, "post_id": 45065694, "comment_id": 77104857, "body": "First, never use new Task \u2013 instead use Task.Run for to wrap CPU-bound operations. Second you need to define tasks as IEnumerable&lt;Task&lt;ItemViewModel&gt;&gt;, i.e. provide the type the tasks will return."}], "answers": [{"comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499886947, "post_id": 45065764, "comment_id": 77104983, "body": "It was pretty fun to see all the updates in real time. Excellent answer"}, {"owner": {"reputation": 23035, "user_id": 401828, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ea104f2947e580667d15b7403829b1ec?s=128&d=identicon&r=PG", "display_name": "heltonbiker", "link": "https://stackoverflow.com/users/401828/heltonbiker"}, "edited": false, "score": 0, "creation_date": 1499887279, "post_id": 45065764, "comment_id": 77105172, "body": "Thanks a lot! I just changed <code>new Task</code> to <code>Task.Run()</code> and everything worked. By the way, I am reading content from files and populating an ObservableCollection displayed with a ListBox. But there is still one thing: it looks like the tasks are running asynchronously one after the other. I changed the <code>foreach</code> to <code>Parallel.foreach</code> and it got worse: UI is updated only after <i>all</i> the tasks run to completion. What can I do to fire every task at the same time so that I get the minimum total elapsed time between operation start and last task completed?"}, {"owner": {"reputation": 23035, "user_id": 401828, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ea104f2947e580667d15b7403829b1ec?s=128&d=identicon&r=PG", "display_name": "heltonbiker", "link": "https://stackoverflow.com/users/401828/heltonbiker"}, "edited": false, "score": 0, "creation_date": 1499887570, "post_id": 45065764, "comment_id": 77105316, "body": "Ok, regarding my previous comment, looks like the <code>AsParallel</code> alternative you provided works. Still, it feels like tasks get completed &quot;in batches&quot;, I believe this is because task duration is very similar, and cores are assigned work all at once per batch. Does it make sense?"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "reply_to_user": {"reputation": 23035, "user_id": 401828, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ea104f2947e580667d15b7403829b1ec?s=128&d=identicon&r=PG", "display_name": "heltonbiker", "link": "https://stackoverflow.com/users/401828/heltonbiker"}, "edited": false, "score": 1, "creation_date": 1499890915, "post_id": 45065764, "comment_id": 77106973, "body": "@heltonbiker: If you want to process items as they complete, you should call <code>DoSomething</code> from within the <code>Task.Run</code>: <code>Select(dir =&gt; Task.Run(() =&gt; DoSomething(new ItemViewModel(new ItemSerializer().Deserialize(dir))))</code>. Note that <code>DoSomething</code> will be called in parallel, and it&#39;s up to you to update the ObservableCollection appropriately. This approach is simpler if you make it all truly async as per the last example."}, {"owner": {"reputation": 1776, "user_id": 2289430, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oEWpq.jpg?s=128&g=1", "display_name": "ibubi", "link": "https://stackoverflow.com/users/2289430/ibubi"}, "edited": false, "score": 0, "creation_date": 1499952179, "post_id": 45065764, "comment_id": 77136501, "body": "@StephenCleary  On the second sample, when using <code>AsParallel</code> it should be blocking the thread before the iteration on <code>vms</code>, right?"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "reply_to_user": {"reputation": 1776, "user_id": 2289430, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oEWpq.jpg?s=128&g=1", "display_name": "ibubi", "link": "https://stackoverflow.com/users/2289430/ibubi"}, "edited": false, "score": 1, "creation_date": 1499952256, "post_id": 45065764, "comment_id": 77136566, "body": "@ibubi: Yes; when the code hits the <code>ToList</code>, it will wait for all the parallel operations to complete."}], "tags": [], "owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "is_accepted": true, "score": 9, "last_activity_date": 1499886867, "last_edit_date": 1499886867, "creation_date": 1499886634, "answer_id": 45065764, "question_id": 45065694, "link": "https://stackoverflow.com/questions/45065694/creating-awaitable-tasks-using-linq/45065764#45065764", "title": "Creating awaitable tasks using LINQ", "body": "<p>You shouldn't ever use the <code>Task</code> constructor.</p>\n\n<p>Since you're calling synchronous code (<code>Deserialize</code>), you could use <code>Task.Run</code>:</p>\n\n<pre><code>async Task LoadItems()\n{\n  var tasks = Directory.GetDirectories(somePath)\n      .Select(dir =&gt; Task.Run(() =&gt;\n           new ItemViewModel(new ItemSerializer().Deserialize(dir))));\n\n  foreach (var task in tasks)\n  {\n    var result = await task;\n    DoSomething(result);\n  }\n}\n</code></pre>\n\n<p>Alternatively, you could use <code>Parallel</code> or Parallel LINQ:</p>\n\n<pre><code>void LoadItems()\n{\n  var vms = Directory.GetDirectories(somePath)\n      .AsParallel().Select(dir =&gt;\n           new ItemViewModel(new ItemSerializer().Deserialize(dir)))\n      .ToList();\n\n  foreach (var vm in vms)\n  {\n    DoSomething(vm);\n  }\n}\n</code></pre>\n\n<p>Or, if you make <code>Deserialize</code> a truly <code>async</code> method, then you can make it all asynchronous:</p>\n\n<pre><code>async Task LoadItems()\n{\n  var tasks = Directory.GetDirectories(somePath)\n      .Select(async dir =&gt; \n           new ItemViewModel(await new ItemSerializer().DeserializeAsync(dir))));\n\n  foreach (var task in tasks)\n  {\n    var result = await task;\n    DoSomething(result);\n  }\n}\n</code></pre>\n\n<p>Also, I recommend that you do not use fire-and-forget in your constructor. <a href=\"http://blog.stephencleary.com/2013/01/async-oop-2-constructors.html\" rel=\"noreferrer\">There are better patterns for asynchronous constructors</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 23035, "user_id": 401828, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ea104f2947e580667d15b7403829b1ec?s=128&d=identicon&r=PG", "display_name": "heltonbiker", "link": "https://stackoverflow.com/users/401828/heltonbiker"}, "edited": false, "score": 0, "creation_date": 1499889327, "post_id": 45066352, "comment_id": 77106206, "body": "That&#39;s an interesting solution too. I found it particularly clean and I am planning to try it as soon as I have some opportunity. Thank you very much!"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 2, "creation_date": 1499953347, "post_id": 45066352, "comment_id": 77137440, "body": "You should refactor this to <a href=\"http://blog.stephencleary.com/2013/10/continuewith-is-dangerous-too.html\" rel=\"nofollow noreferrer\">use <code>await</code> instead of <code>ContinueWith</code></a>. <code>ContinueWith</code> is a low-level, dangerous API."}], "tags": [], "owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "is_accepted": false, "score": 2, "last_activity_date": 1499888886, "creation_date": 1499888886, "answer_id": 45066352, "question_id": 45065694, "link": "https://stackoverflow.com/questions/45065694/creating-awaitable-tasks-using-linq/45066352#45066352", "title": "Creating awaitable tasks using LINQ", "body": "<p>I know the question has been answered, but you can always do this too:</p>\n\n<pre><code> var serializer = new ItemSerializer();\n var directories = Directory.GetDirectories(somePath);\n foreach (string directory in directories)\n {\n      await Task.Run(() =&gt; serializer.Deserialize(directory))\n      .ContinueWith(priorTask =&gt; DoSomething(priorTask.Result));                \n }\n</code></pre>\n\n<p>Notice I pulled out the serializer instantiation (assuming there are no side effects).</p>\n"}], "owner": {"reputation": 23035, "user_id": 401828, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ea104f2947e580667d15b7403829b1ec?s=128&d=identicon&r=PG", "display_name": "heltonbiker", "link": "https://stackoverflow.com/users/401828/heltonbiker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 0, "accepted_answer_id": 45065764, "answer_count": 2, "score": 1, "last_activity_date": 1499888886, "creation_date": 1499886354, "question_id": 45065694, "link": "https://stackoverflow.com/questions/45065694/creating-awaitable-tasks-using-linq", "title": "Creating awaitable tasks using LINQ", "body": "<p>I want to create a collection of awaitable tasks, so that I can start them together and asynchronously process the result from each one as they complete.</p>\n\n<p>I have this code, and a compilation error:</p>\n\n<p><code>&gt; cannot assign void to an implicitly-typed variable</code></p>\n\n<p>If I understand well, the tasks return by <code>Select</code> don't have a return type, even though the delegate passed returns <code>ColetaIsisViewModel</code>, I would think:</p>\n\n<pre><code>public MainViewModel()\n{\n    Task.Run(LoadItems);\n}\n\nasync Task LoadItems()\n{\n    IEnumerable&lt;Task&gt; tasks = Directory.GetDirectories(somePath)\n                            .Select(dir =&gt; new Task(() =&gt;\n                                new ItemViewModel(new ItemSerializer().Deserialize(dir))));\n\n    foreach (var task in tasks)\n    {\n        var result = await task;  // &lt;-- here I get the compilation error\n        DoSomething(result);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "out", "c#-7.0"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1499895718, "post_id": 45067837, "comment_id": 77109272, "body": "From the language perspective, the translation seems fairly straightforward: the equivalent of <code>from item in pd.PayDays.AsParallel() let resultHolder = new DisplayClass() where DateTime.TryParse(item, out resultHolder.result) ? ... : ... select item;</code>, with the same type of generated <code>DisplayClass</code> classes that already get generated for other reasons. Can you give an example where this simple approach wouldn&#39;t work or would behave in unexpected ways?"}], "tags": [], "owner": {"reputation": 213217, "user_id": 41071, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ec0f5be7749c8cc8ccda4a809103f36?s=128&d=identicon&r=PG", "display_name": "svick", "link": "https://stackoverflow.com/users/41071/svick"}, "is_accepted": false, "score": 0, "last_activity_date": 1499895478, "last_edit_date": 1499895478, "creation_date": 1499895002, "answer_id": 45067837, "question_id": 45065688, "link": "https://stackoverflow.com/questions/45065688/c-7-out-variable-and-pattern-variable-declarations-are-not-allowed-within-a-que/45067837#45067837", "title": "C# 7 Out variable and pattern variable declarations are not allowed within a query clause", "body": "<p>The problem is that the translation you showed works fine for normal LINQ to objects, but would be problematic for other providers, like PLINQ or Entity Framework.</p>\n\n<p>For example, consider the translation you proposed for your query modified to use PLINQ:</p>\n\n<pre><code>DateTime result;\nvar rm = from item in pd.PayDays.AsParallel()\n         where DateTime.TryParse(item, out result) ? (result.Subtract(DateTime.Now).Days &gt;= 0 ? true : false) : false\n         select item;\nvar list = rm.ToList();\n</code></pre>\n\n<p>This code is not thread-safe, because multiple threads share a single <code>result</code> variable and you're likely going to get incorrect results, because they will try to use it at the same time.</p>\n\n<p>There are ways to correctly translate such queries, at least in some cases, but they're not trivial, so <code>out</code> variables are simply not allowed in LINQ query syntax. Though <a href=\"https://github.com/dotnet/csharplang/issues/159\" rel=\"nofollow noreferrer\">there is a proposal to allow them in a future version of C#</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3585, "user_id": 172315, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/Marnt.jpg?s=128&g=1", "display_name": "Julien Couvreur", "link": "https://stackoverflow.com/users/172315/julien-couvreur"}, "is_accepted": true, "score": 8, "last_activity_date": 1499911318, "last_edit_date": 1499911318, "creation_date": 1499897695, "answer_id": 45068368, "question_id": 45065688, "link": "https://stackoverflow.com/questions/45065688/c-7-out-variable-and-pattern-variable-declarations-are-not-allowed-within-a-que/45068368#45068368", "title": "C# 7 Out variable and pattern variable declarations are not allowed within a query clause", "body": "<p>Here are the <a href=\"https://github.com/dotnet/csharplang/blob/master/meetings/2016/LDM-2016-12-07-14.md#expression-variables-in-query-expressions\" rel=\"noreferrer\">relevant LDM notes</a>.</p>\n\n<p>The conclusion:</p>\n\n<blockquote>\n  <p>We won't have time to do this feature in C# 7.0. If we want to leave ourselves room to do it in the future, we need to make sure that we don't allow expression variables in query clauses to mean something else today, that would contradict such a future.</p>\n  \n  <p>The current semantics is that expression variables in query clauses\n  are scoped to only the query clause. That means two subsequent query\n  clauses can use the same name in expression variables, for instance.\n  That is inconsistent with a future that allows those variables to\n  share a scope across query clause boundaries.</p>\n  \n  <p>Thus, if we want to allow this in the future we have to put in some\n  restrictions in C# 7.0 to protect the design space. We have a couple\n  of options:</p>\n  \n  <ul>\n  <li>Disallow expression variables altogether in query clauses</li>\n  <li>Require that\n  all expression variables in a given query expression have different\n  names</li>\n  </ul>\n  \n  <p>The former is a big hammer, but the latter requires a lot of\n  work to get right - and seems at risk for not blocking off everything\n  well enough.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>We will neither do expression variables nor deconstruction in C# 7.0, but would like to do them in the future. In order to protect our ability to do this, we will completely disallow expression variables inside query clauses, even though this is quite a big hammer.</p>\n</blockquote>\n"}], "owner": {"reputation": 319, "user_id": 180714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KvPie.png?s=128&g=1", "display_name": "Murat Kazanova", "link": "https://stackoverflow.com/users/180714/murat-kazanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "accepted_answer_id": 45068368, "answer_count": 2, "score": 3, "last_activity_date": 1499911318, "creation_date": 1499886323, "last_edit_date": 1499894610, "question_id": 45065688, "link": "https://stackoverflow.com/questions/45065688/c-7-out-variable-and-pattern-variable-declarations-are-not-allowed-within-a-que", "title": "C# 7 Out variable and pattern variable declarations are not allowed within a query clause", "body": "<p>Why out variables are not allowed in query clause?</p>\n\n<p>If I use out variables here it fails:</p>\n\n<pre><code>string json = \"{'PayDays':['2017-07-07','2017-07-21','2017-08-04','2017-08-18']}\";\nvar pd = JsonConvert.DeserializeObject&lt;Accounting&gt;(json);\n\nvar rm = from item in pd.PayDays\n     where (DateTime.TryParse(item, out DateTime dateresult)) ?\n    dateresult.Subtract(DateTime.Now).Days &gt;= 0 ? true : false : false      \n    select item;\nrm.Dump();\n</code></pre>\n\n<p>But old way works:</p>\n\n<pre><code>DateTime result;\nvar rm = from item in pd.PayDays\n         where DateTime.TryParse(item, out result) ? (result.Subtract(DateTime.Now).Days &gt;= 0 ? true : false) : false\n         select item;\nrm.Dump();\n</code></pre>\n"}, {"tags": ["c#", "unity3d", "uwp", "media", "capture"], "owner": {"reputation": 53, "user_id": 8209490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d37df176f2f82b1ccc63ff454188f0c9?s=128&d=identicon&r=PG&f=1", "display_name": "delilah", "link": "https://stackoverflow.com/users/8209490/delilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1499886031, "creation_date": 1499886031, "question_id": 45065616, "link": "https://stackoverflow.com/questions/45065616/how-to-access-camera-preview-frames-with-mediacapture-class-in-unity", "title": "How to access camera preview frames with MediaCapture class in Unity?", "body": "<p>I am trying to access camera preview frames of Hololens in a script of a Unity application, but I have some problems. I want to access the camera preview with MediaCapture class. I know that it is posible in a UWP application but I want to do it in Unity. \nIn the UWP application need to create a CaptureElement in the XAML page and after that to set the source of this element, like that:</p>\n\n<pre><code>captureElement.source = mediaCapture;\nmediaCapture.StartPreviewAsync();\n</code></pre>\n\n<p>But in a Unity application I don't know how to create a CaptureElement or if it is possible.\nHow can I access the preview in this case? Or how to create a CaptureElement in Unity? Do you have any ideas?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", "visual-studio", "datatable", "visual-studio-2017"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 2, "creation_date": 1499886134, "post_id": 45065598, "comment_id": 77104586, "body": "Well, you are <b>creating</b> the datatable, you are not <b>showing</b> it anywhere. You need a UI: WinForms, WPF, etc"}, {"owner": {"reputation": 21, "user_id": 8271128, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9733a68637721f16cec89000d8a397cf?s=128&d=identicon&r=PG&f=1", "display_name": "Khila", "link": "https://stackoverflow.com/users/8271128/khila"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499886255, "post_id": 45065598, "comment_id": 77104655, "body": "Thought it was something stupid like that. As I&#39;m unsure about c# syntax, what is a good way to display it? @CamiloTerevinto"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499886303, "post_id": 45065598, "comment_id": 77104682, "body": "See <a href=\"https://www.dotnetperls.com/datagridview\" rel=\"nofollow noreferrer\">here</a>, you already solved the hard part. By the way, you don&#39;t need to set <code>ReadOnly = false</code> (default) nor <code>Unique = false</code> (default) and you can use <code>DataType = typeof(string)</code> as shortcut"}, {"owner": {"reputation": 476, "user_id": 3781235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KyK9q.jpg?s=128&g=1", "display_name": "aguertin", "link": "https://stackoverflow.com/users/3781235/aguertin"}, "edited": false, "score": 0, "creation_date": 1499886426, "post_id": 45065598, "comment_id": 77104736, "body": "This code is for the back end not the front end."}], "answers": [{"tags": [], "owner": {"reputation": 2713, "user_id": 6611487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/m9imL.jpg?s=128&g=1", "display_name": "boop_the_snoot", "link": "https://stackoverflow.com/users/6611487/boop-the-snoot"}, "is_accepted": true, "score": 1, "last_activity_date": 1499887518, "last_edit_date": 1499887518, "creation_date": 1499886389, "answer_id": 45065702, "question_id": 45065598, "link": "https://stackoverflow.com/questions/45065598/creating-a-datatable-using-visual-studio/45065702#45065702", "title": "Creating a datatable using visual studio", "body": "<p>You created a datatable which is not visible at UI front. If you are using winforms add a DataGridView to the main form and set its source to this datatable. Then you will have a UI for your datatable. \nYou can drag-n-drop a DataGridView from Visual Studio Designer(suppose you name it 'mydatagridview'), then from code behind you can use</p>\n\n<pre><code>mydatagridview.DataSource = clientTable; \n</code></pre>\n\n<p>The columns you created will be reflected in the DataGridView. </p>\n"}], "owner": {"reputation": 21, "user_id": 8271128, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9733a68637721f16cec89000d8a397cf?s=128&d=identicon&r=PG&f=1", "display_name": "Khila", "link": "https://stackoverflow.com/users/8271128/khila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 0, "accepted_answer_id": 45065702, "answer_count": 1, "score": 0, "last_activity_date": 1499887518, "creation_date": 1499885953, "question_id": 45065598, "link": "https://stackoverflow.com/questions/45065598/creating-a-datatable-using-visual-studio", "title": "Creating a datatable using visual studio", "body": "<p>I am a C# noob so if I am doing something idiotic please let me know (this is my first time using it).</p>\n\n<p>I am using visual studio 2017 to create a very simplistic front end for my companies database which previously was only held over many excel files. I am however having an issue creating a data table, what I have right now is:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace ClientEmployer_FE\n{\n    public partial class Form1 : Form\n    {\n        private System.Data.DataSet dtSet;\n\n        public Form1()\n        {\n            InitializeComponent();\n            CreateTable();\n        }\n\n        private void CreateTable()\n        {\n            System.Data.DataTable clientTable = new DataTable(\"clientTable\");\n            DataColumn dtCol;\n            DataRow myDataRow;\n\n            //First Name Column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"firstName\";\n            dtCol.Caption = \"First Name\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //Last Name Column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"lastName\";\n            dtCol.Caption = \"Last Name\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //Disability Column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"disability\";\n            dtCol.Caption = \"Disability\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //Skills Column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"skills\";\n            dtCol.Caption = \"Relevant Skills\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //Goals Column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"goals\";\n            dtCol.Caption = \"Job Goals\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //PT/FT column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"ptOrft\";\n            dtCol.Caption = \"PT/FT\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //availibility column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"avail\";\n            dtCol.Caption = \"Shift Availibility\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //location column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"location\";\n            dtCol.Caption = \"Job Location\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //transport column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"transport\";\n            dtCol.Caption = \"Transportation\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //accommodations column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"accom\";\n            dtCol.Caption = \"Accommodations\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //bilingual column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"biling\";\n            dtCol.Caption = \"Bilingual\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //OPP column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"opp\";\n            dtCol.Caption = \"OPP Eligable\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //JD supports column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"jdSupp\";\n            dtCol.Caption = \"JD Supports\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            //Notes column\n            dtCol = new DataColumn();\n            dtCol.DataType = System.Type.GetType(\"System.String\");\n            dtCol.ColumnName = \"notes\";\n            dtCol.Caption = \"Notes\";\n            dtCol.ReadOnly = false;\n            dtCol.Unique = false;\n            clientTable.Columns.Add(dtCol);\n\n            dtSet = new DataSet(\"Clients\");\n            dtSet.Tables.Add(clientTable);\n\n            //test row\n            myDataRow = clientTable.NewRow();\n            myDataRow[\"firstName\"] = \"John\";\n            myDataRow[\"lastName\"] = \"Snow\";\n            myDataRow[\"disability\"] = \"ASD\";\n            myDataRow[\"skills\"] = \"tactical thinking\";\n            myDataRow[\"goals\"] = \"office\";\n            myDataRow[\"ptOrft\"] = \"FT\";\n            myDataRow[\"avail\"] = \"always\";\n            myDataRow[\"location\"] = \"foo\";\n            myDataRow[\"transport\"] = \"car\";\n            myDataRow[\"accom\"] = \"N/A\";\n            myDataRow[\"biling\"] = \"yes\";\n            myDataRow[\"opp\"] = \"no\";\n            myDataRow[\"jdSupp\"] = \"no\";\n            myDataRow[\"notes\"] = \"is awesome\";\n            clientTable.Rows.Add(myDataRow);\n\n\n        }\n\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n\n        }\n    }\n}\n</code></pre>\n\n<p>Right now when I navigate over to the page when this code is on I'm only greeted by a blank form. Is there a piece of code I'm missing to actually draw the table? The visual studio debugger isn't picking anything up so I know it's not just a syntax error.</p>\n"}, {"tags": ["c#", "if-statement", "exception"], "comments": [{"owner": {"reputation": 7442, "user_id": 3745896, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ptFQe.jpg?s=128&g=1", "display_name": "River", "link": "https://stackoverflow.com/users/3745896/river"}, "edited": false, "score": 1, "creation_date": 1499886200, "post_id": 45065595, "comment_id": 77104616, "body": "Is this Java or C#? I assumed C# as that&#39;s in the title"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1499886373, "post_id": 45065595, "comment_id": 77104714, "body": "well you dont need the word &#39;else&#39; - so that shortens it a bit"}, {"owner": {"reputation": 2823, "user_id": 6202039, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8cVei5pidZQ/AAAAAAAAAAI/AAAAAAAAAJo/ShhF34Rlg2s/photo.jpg?sz=128", "display_name": "Jay Patel", "link": "https://stackoverflow.com/users/6202039/jay-patel"}, "edited": false, "score": 1, "creation_date": 1499886387, "post_id": 45065595, "comment_id": 77104722, "body": "Put the brackets {} in if else statements and check"}, {"owner": {"reputation": 1310, "user_id": 4790918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCGCh.jpg?s=128&g=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/4790918/vladimir"}, "edited": false, "score": 1, "creation_date": 1499886448, "post_id": 45065595, "comment_id": 77104745, "body": "first it`s really good idea to store &quot;HUB&quot; as a const string for a start."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 1, "creation_date": 1499886461, "post_id": 45065595, "comment_id": 77104748, "body": "If you put your second condition first, you can remove the &quot;HUB&quot; checks from the first one."}, {"owner": {"reputation": 17, "user_id": 8297854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc49e78e41b19dde143da1bd4d66eb20?s=128&d=identicon&r=PG&f=1", "display_name": "NoobishCoder", "link": "https://stackoverflow.com/users/8297854/noobishcoder"}, "edited": false, "score": 0, "creation_date": 1499886702, "post_id": 45065595, "comment_id": 77104859, "body": "Awesome Rufus, you are one hundred percent right! That only makes it a little bit shorter though, I need to add another four values. Let&#39;s say = level1, level2, level3, level4 (simplified of course)"}, {"owner": {"reputation": 20833, "user_id": 123487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8c7167d4a3b6c6bfe8ddd7977e343b?s=128&d=identicon&r=PG", "display_name": "Deltics", "link": "https://stackoverflow.com/users/123487/deltics"}, "edited": false, "score": 0, "creation_date": 1499886729, "post_id": 45065595, "comment_id": 77104871, "body": "@Noobish - I hope you don&#39;t mind, I changed the title of your question as I think the original wording gave the impression that your problem revolved specifically around language constructs of if-else and try-catch (exceptions).  Your goal - an efficient solution to your comparison problem - will almost certainly be accomplished without using if-else at all, but collections of some sort (arrays, sets, lists etc) so by summarising that problem rather than describing your current approach, hopefully people with an insight into such algorithms may be drawn to help."}, {"owner": {"reputation": 7442, "user_id": 3745896, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ptFQe.jpg?s=128&g=1", "display_name": "River", "link": "https://stackoverflow.com/users/3745896/river"}, "edited": false, "score": 0, "creation_date": 1499886768, "post_id": 45065595, "comment_id": 77104895, "body": "@NoobishCoder is there a third option besides <code>true</code> and <code>false</code>? Otherwise one of these should just be an <code>else</code>"}, {"owner": {"reputation": 17, "user_id": 8297854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc49e78e41b19dde143da1bd4d66eb20?s=128&d=identicon&r=PG&f=1", "display_name": "NoobishCoder", "link": "https://stackoverflow.com/users/8297854/noobishcoder"}, "reply_to_user": {"reputation": 20833, "user_id": 123487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8c7167d4a3b6c6bfe8ddd7977e343b?s=128&d=identicon&r=PG", "display_name": "Deltics", "link": "https://stackoverflow.com/users/123487/deltics"}, "edited": false, "score": 0, "creation_date": 1499887025, "post_id": 45065595, "comment_id": 77105030, "body": "@Deltics thank you, how would I go on about doing this with lists/sets? Like I said I&#39;m a complete noob."}, {"owner": {"reputation": 17, "user_id": 8297854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc49e78e41b19dde143da1bd4d66eb20?s=128&d=identicon&r=PG&f=1", "display_name": "NoobishCoder", "link": "https://stackoverflow.com/users/8297854/noobishcoder"}, "reply_to_user": {"reputation": 7442, "user_id": 3745896, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ptFQe.jpg?s=128&g=1", "display_name": "River", "link": "https://stackoverflow.com/users/3745896/river"}, "edited": false, "score": 0, "creation_date": 1499887041, "post_id": 45065595, "comment_id": 77105039, "body": "@River there is not, no."}, {"owner": {"reputation": 7442, "user_id": 3745896, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ptFQe.jpg?s=128&g=1", "display_name": "River", "link": "https://stackoverflow.com/users/3745896/river"}, "edited": false, "score": 0, "creation_date": 1499887111, "post_id": 45065595, "comment_id": 77105072, "body": "@NoobishCoder so why not test for any equal to <code>&quot;HUB&quot;</code> and otherwise <code>return true</code>?"}, {"owner": {"reputation": 42640, "user_id": 1553851, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ad333c218c8f2fb917cf506919fc95f4?s=128&d=identicon&r=PG", "display_name": "shmosel", "link": "https://stackoverflow.com/users/1553851/shmosel"}, "edited": false, "score": 0, "creation_date": 1499892791, "post_id": 45065595, "comment_id": 77107875, "body": "It might help if you described the actual reasoning behind your code."}, {"owner": {"reputation": 7442, "user_id": 3745896, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ptFQe.jpg?s=128&g=1", "display_name": "River", "link": "https://stackoverflow.com/users/3745896/river"}, "edited": false, "score": 0, "creation_date": 1500320566, "post_id": 45065595, "comment_id": 77273745, "body": "@NoobishCoder also look here <a href=\"https://stackoverflow.com/q/22501230/3745896\">stackoverflow.com/q/22501230/3745896</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1499887698, "creation_date": 1499887698, "answer_id": 45066050, "question_id": 45065595, "link": "https://stackoverflow.com/questions/45065595/how-can-i-efficiently-compare-two-sets-of-strings-in-c/45066050#45066050", "title": "How can I efficiently compare two sets of strings in C#?", "body": "<p>One possibility might be to push part of this detection functionality into your class, which should simplify the code you're currently writing, and potentially reduce other code if it's reused somewhere else:</p>\n\n<pre><code>class Item\n{\n    public const string Hub = \"HUB\";\n    public string LevelFirst { get; set; }\n    public string LevelSecond { get; set; }\n\n    public bool HasCommonLevelWith(Item other)\n    {\n        if (other == null || ContainsAHub() || other.ContainsAHub())\n        {\n            return false;\n        }\n\n        return\n            LevelFirst.Equals(other.LevelFirst, StringComparison.OrdinalIgnoreCase) ||\n            LevelSecond.Equals(other.LevelSecond, StringComparison.OrdinalIgnoreCase);\n    }\n\n    public bool ContainsAHub()\n    {\n        return LevelFirst.Equals(Hub, StringComparison.OrdinalIgnoreCase) ||\n               LevelSecond.Equals(Hub, StringComparison.OrdinalIgnoreCase);\n    }\n}\n</code></pre>\n\n<p>Then the code you wrote earlier would simply look like:</p>\n\n<pre><code>return current.HasCommonLevelWith(old);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20833, "user_id": 123487, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8c7167d4a3b6c6bfe8ddd7977e343b?s=128&d=identicon&r=PG", "display_name": "Deltics", "link": "https://stackoverflow.com/users/123487/deltics"}, "is_accepted": false, "score": 0, "last_activity_date": 1499888415, "last_edit_date": 1499888415, "creation_date": 1499887883, "answer_id": 45066100, "question_id": 45065595, "link": "https://stackoverflow.com/questions/45065595/how-can-i-efficiently-compare-two-sets-of-strings-in-c/45066100#45066100", "title": "How can I efficiently compare two sets of strings in C#?", "body": "<p>Here is an approach you can use that uses a collection of a simple data structure to hold your <strong>Old</strong> and <strong>Current</strong> level values:</p>\n\n<pre><code>class Level\n{\n    public string Current { get; set; }\n    public string Old { get; set; }\n}\n\nclass Program\n{\n\n    static bool CompareLevels(ICollection&lt;Level&gt; levels)\n    {\n        foreach (var item in levels)\n        {\n            // Either of any level is HUB =&gt; false\n            if ((item.Current == \"HUB\") || (item.Old == \"HUB\"))\n                return false;\n\n            // Any Old level == any Current level =&gt; false\n            if (levels.Any(level =&gt; level.Old == item.Current))\n                return false;\n        }\n\n        // All levels met the criteria (no exceptions/failures)\n        return true;\n    }\n\n\n    // A simple console program to exercise the above function:\n\n    static void Main(string[] args)\n    {\n        // Should return false if any Old or Current levels are HUB\n        var levels = new List&lt;Level&gt;\n        {\n            new Level { Current = \"HUB\", Old = \"ABCDEF\" },\n            new Level { Current = \"DEFGHI\", Old = \"HUB\" }\n        };\n        Console.WriteLine(CompareLevels(levels));\n\n        // Should return true if all Old levels != any Current level and none are \"HUB\"\n        levels = new List&lt;Level&gt;\n        {\n            new Level { Current = \"ABC123\", Old = \"ABCDEF\" },\n            new Level { Current = \"DEFGHI\", Old = \"DEF456\" }\n        };\n        Console.WriteLine(CompareLevels(levels));\n\n        // Should return false if any Old level == any Current level\n        levels = new List&lt;Level&gt;\n        {\n            new Level { Current = \"ABC123\", Old = \"ABCDEF\" },\n            new Level { Current = \"DEFGHI\", Old = \"ABC123\" }\n        };\n        Console.WriteLine(CompareLevels(levels));\n\n        Console.ReadLine();\n    }\n}\n</code></pre>\n\n<p>The iteration of the collection of levels will terminate at the first failure condition so will not wastefully iterate over the whole collection.  The only condition under which the collection is completely enumerated is when there are no failures.</p>\n\n<p>This may not be the most efficient but optimizations here will be vanishingly small for the numbers of levels you indicate are involved.  It also requires that you initialise a collection to hold the levels to be compared.</p>\n\n<p>It does however have the advantage of accommodating any number of \"levels\" and (imho) making the comparison criteria very clear and easily understood.</p>\n\n<p><strong>NOTE:</strong> In C# there is no problem using <code>==</code> to compare string values, other than when needing to take into account culture and case variations etc. <code>==</code> for strings <em>will</em> compare the value of the strings involved.</p>\n"}], "owner": {"reputation": 17, "user_id": 8297854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc49e78e41b19dde143da1bd4d66eb20?s=128&d=identicon&r=PG&f=1", "display_name": "NoobishCoder", "link": "https://stackoverflow.com/users/8297854/noobishcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1499888415, "creation_date": 1499885933, "last_edit_date": 1499886411, "question_id": 45065595, "link": "https://stackoverflow.com/questions/45065595/how-can-i-efficiently-compare-two-sets-of-strings-in-c", "title": "How can I efficiently compare two sets of strings in C#?", "body": "<p>i have two variables (well basically four => old/current for each one).\nall of them can be \"ABCDXFG\" or \":ABCDXFG\" (basically level names) and also \"hub\".</p>\n\n<p>I have an if else statement to return true if Level names do not equal, but I need exceptions for the hub (it's really long even now) plus another 4 levels!!!</p>\n\n<pre><code>if (current.LevelSecond != old.LevelSecond &amp;&amp; \n    current.LevelSecond != old.LevelFirst &amp;&amp; \n    current.LevelFirst != \"HUB\" &amp;&amp; \n    old.LevelFirst != \"HUB\" &amp;&amp; \n    current.LevelSecond != \"HUB\" &amp;&amp; \n    old.LevelSecond != \"HUB\")\n        return true;\n\nelse if (current.LevelFirst == \"HUB\" || \n         old.LevelFirst == \"HUB\" || \n         current.LevelSecond == \"HUB\" || \n         old.LevelSecond == \"HUB\")\n            return false;\n</code></pre>\n\n<p>this looks and is absolutely disgusting, and since I have zero experience I don't know how to make this as efficient as possible. If I add those 4 levels the length of the statement is gonna quadruple...</p>\n\n<p>Please help! :(</p>\n"}, {"tags": ["c#", ".net", "mef"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499886501, "post_id": 45065582, "comment_id": 77104766, "body": "Not really a solution, but what if you marked the constructor as <code>[Obsolete]</code> and made FxCop/StyleCop (not remember which) throw compilation error on usage of <code>Obsolete</code> fields/methods?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1499887165, "post_id": 45065582, "comment_id": 77105108, "body": "Why intentionally cripple your code though?"}], "answers": [{"comments": [{"owner": {"reputation": 15861, "user_id": 509600, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b28cfca4046ffeb1503a27b18a6acfb3?s=128&d=identicon&r=PG", "display_name": "katit", "link": "https://stackoverflow.com/users/509600/katit"}, "edited": false, "score": 0, "creation_date": 1499893961, "post_id": 45067228, "comment_id": 77108446, "body": "Great! Just need to make sure default constructor not used, <code>private TwoWayMessageHubService()  {   }</code> and then it&#39;s all as it should be"}], "tags": [], "owner": {"reputation": 2306, "user_id": 4430204, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ec62a73156d45585e587c05f9ecd062?s=128&d=identicon&r=PG", "display_name": "taquion", "link": "https://stackoverflow.com/users/4430204/taquion"}, "is_accepted": true, "score": 1, "last_activity_date": 1499892344, "creation_date": 1499892344, "answer_id": 45067228, "question_id": 45065582, "link": "https://stackoverflow.com/questions/45065582/mef-prevent-class-from-being-manually-instatiated/45067228#45067228", "title": "MEF prevent class from being manually instatiated", "body": "<p>In fact this is possible. Just have to apply <strong>[Import]</strong> attribute to your constructor's parameters and make your constructor private. I have made the following sample based on your code, it works and you can test it.</p>\n\n<p>First, the <strong>TwoMessageHubService</strong> with the changes I mentioned:</p>\n\n<pre><code>[Export]\n    [PartCreationPolicy(CreationPolicy.Shared)]\n    public class TwoWayMessageHubService\n    {\n        [ImportingConstructor]\n        private TwoWayMessageHubService([Import]ILogger logger) { }\n    }\n</code></pre>\n\n<p>Notice that the constructor is <strong>private</strong></p>\n\n<p>Then a class that must be composed with an instance of TwoWayMessageHubService:</p>\n\n<pre><code>public class Implementer\n    {\n        [Import]\n        public TwoWayMessageHubService MHS { get; set; }\n    }\n</code></pre>\n\n<p>The Logger decorated with <strong>Export</strong></p>\n\n<pre><code>   public interface ILogger { }\n\n    [Export(typeof(ILogger))]\n    public class Logger : ILogger { }\n</code></pre>\n\n<p>And Main:</p>\n\n<pre><code>var catalog = new AssemblyCatalog(Assembly.GetExecutingAssembly());\n            var container = new CompositionContainer(catalog);\n\n            var implementer = new Implementer();\n            container.ComposeParts(implementer);\n            //var IdoNotCompile = new TwoWayMessageHubService(new Logger());\n\n            Console.ReadLine();\n</code></pre>\n\n<p>If you uncomment the comment (lol) then you will notice that it does not compile.</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 15861, "user_id": 509600, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b28cfca4046ffeb1503a27b18a6acfb3?s=128&d=identicon&r=PG", "display_name": "katit", "link": "https://stackoverflow.com/users/509600/katit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 45067228, "answer_count": 1, "score": 2, "last_activity_date": 1499892344, "creation_date": 1499885888, "question_id": 45065582, "link": "https://stackoverflow.com/questions/45065582/mef-prevent-class-from-being-manually-instatiated", "title": "MEF prevent class from being manually instatiated", "body": "<p>I wonder if I can somehow prevent class from being manually created? I want to make sure it is only imported.</p>\n\n<pre><code>[Export]\n[PartCreationPolicy(CreationPolicy.Shared)]\npublic class TwoWayMessageHubService\n{\n    [ImportingConstructor]\n    public TwoWayMessageHubService(ILoggerService loggerService)\n    {\n    }\n}\n</code></pre>\n\n<p>So, I want to make sure this works:</p>\n\n<pre><code>[Import]\npublic TwoWayMessageHubService MHS {get; set;)\n</code></pre>\n\n<p>And make sure this doesn't:</p>\n\n<pre><code>var MHS = new TwoWayMessageHubService(logger);\n</code></pre>\n"}, {"tags": ["c#", "wpf", "windows"], "answers": [{"tags": [], "owner": {"reputation": 2459, "user_id": 37660, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dc7f972d568a9144583da8c53b8c7a91?s=128&d=identicon&r=PG", "display_name": "avenmore", "link": "https://stackoverflow.com/users/37660/avenmore"}, "is_accepted": true, "score": 2, "last_activity_date": 1499962892, "creation_date": 1499962892, "answer_id": 45086248, "question_id": 45065505, "link": "https://stackoverflow.com/questions/45065505/windows-explorer-not-showing-folders-files-created-in-wpf-app/45086248#45086248", "title": "Windows Explorer Not Showing Folders / Files Created in WPF App", "body": "<p>Perhaps you have created the folders/files in a security-restricted folder and are not running your WPF app as Administrator, in which case the physical files are located in <code>C:\\Users\\&lt;user&gt;\\AppData\\Local\\VirtualStore</code>.</p>\n"}], "owner": {"reputation": 198, "user_id": 5186582, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/C2ruc.png?s=128&g=1", "display_name": "Joeb Rogers", "link": "https://stackoverflow.com/users/5186582/joeb-rogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 45086248, "answer_count": 1, "score": -1, "last_activity_date": 1499962892, "creation_date": 1499885617, "question_id": 45065505, "link": "https://stackoverflow.com/questions/45065505/windows-explorer-not-showing-folders-files-created-in-wpf-app", "title": "Windows Explorer Not Showing Folders / Files Created in WPF App", "body": "<p>So, I made a small WPF app that allows you to template folder/file structures and save/load them. </p>\n\n<p>When the app is initially installed, it has a Template folder in the root installation folder. I started out saving and loading templates to it (using SaveFileDialog and OpenFileDialog, then writing/parsing to/from xml). This worked fine.</p>\n\n<p>I then wanted to test out what directory would first be opened through those buttons if I were to delete that folder (since even on a fresh install it went to the last opened directory, which I wanted to sort out). However, after deleting the folder, it still appeared in the file dialogs. I could create new folders within the file dialogs, and even still parse the xml files that aren't there anymore. So now, within the application I can see a Templates folder, load an XML from scratch and save XML files to it, and the app works perfectly. If I go to that directory in Windows Explorer, the Templates directory isn't there, nor are any of the files that I'm able to open (I've also tried using the search box and F5, doesn't show).</p>\n\n<p>Any idea what could be causing this bug?</p>\n\n<p>Here is the basic code I'm doing to save/load these files:</p>\n\n<pre><code>private void LoadTemplate ( object sender , RoutedEventArgs e )\n    {\n        OpenFileDialog dialog = new OpenFileDialog ();\n\n        dialog.Filter = \"xml files |*.xml\";\n        dialog.FilterIndex = 2;\n\n        if ( dialog.ShowDialog () == System.Windows.Forms.DialogResult.OK )\n        {\n            string path = dialog.FileName;\n\n            XmlDocument doc = new XmlDocument ();\n            doc.Load ( path );\n\n            if ( doc.DocumentElement != null )\n            {\n                XmlNodeList nodes = doc.DocumentElement.SelectNodes ( \"Folders\" ) [ 0 ].ChildNodes;\n                List &lt; Folder &gt; _folders = new List &lt; Folder &gt; ();\n                int currentLevel = 0;\n\n                foreach ( XmlNode node in nodes )\n                {\n                    addItemToList ( ref _folders , node , currentLevel );\n                }\n\n                folders = _folders;\n                DeployHierarchy.ItemsSource = folders;\n                DeployHierarchy.Items.Refresh ();\n            }\n        }\n    }\n\nprivate void SaveTemplate(object sender, RoutedEventArgs e)\n    {\n        SaveFileDialog savefile1 = new SaveFileDialog();\n\n        savefile1.Filter = \"xml files |*.xml\";\n        savefile1.FilterIndex = 2;\n\n        if (savefile1.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n        {\n            XmlDocument doc = new XmlDocument ();\n            XmlElement root = doc.CreateElement ( \"Root\" );\n            XmlElement currentEl = ( XmlElement ) root.AppendChild ( doc.CreateElement ( \"Folders\" ) );\n            doc.AppendChild ( root );\n\n            for (int i = 0; i &lt; folders.Count; i++)\n            {\n                addElement( ref doc , ref currentEl, ref i, ref currentEl);\n            }\n\n            doc.Save ( savefile1.FileName );\n        }\n\n    }\n</code></pre>\n"}, {"tags": ["c#", "azure-powershell"], "comments": [{"owner": {"reputation": 108, "user_id": 3438194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2e23c82bd095e743f6b1eac496fbaa28?s=128&d=identicon&r=PG&f=1", "display_name": "Dimas", "link": "https://stackoverflow.com/users/3438194/dimas"}, "edited": false, "score": 0, "creation_date": 1499888396, "post_id": 45065483, "comment_id": 77105719, "body": "If instead of <code>Get-AzureRMVm</code> I run <code>Get-AzureRMSubscription</code>, I receive the proper output. I am completely lost."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8069157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c03942f11e18978ad17b1d8934774a8?s=128&d=identicon&r=PG&f=1", "display_name": "xenon8", "link": "https://stackoverflow.com/users/8069157/xenon8"}, "is_accepted": false, "score": 0, "last_activity_date": 1500042761, "last_edit_date": 1500042761, "creation_date": 1500037451, "answer_id": 45103770, "question_id": 45065483, "link": "https://stackoverflow.com/questions/45065483/method-not-implemented-error-when-running-azure-script-from-c/45103770#45103770", "title": "&quot;Method not implemented&quot; error when running Azure script from c#", "body": "<p>i have a similar issue with this part of our code, it was working earlier this week but has started failing. I think it might be related to the PowerShell being upgraded in Azure: <a href=\"https://github.com/Azure/azure-powershell/releases/tag/v4.2.0-July2017\" rel=\"nofollow noreferrer\">https://github.com/Azure/azure-powershell/releases/tag/v4.2.0-July2017</a></p>\n\n<p>Given that your code has stopped working, could it be related?</p>\n\n<p>Update: This fixed the issue for us: <a href=\"https://feedback.azure.com/forums/246290-automation/suggestions/16590229-get-azurermvm-failing-in-azure-automation\" rel=\"nofollow noreferrer\">https://feedback.azure.com/forums/246290-automation/suggestions/16590229-get-azurermvm-failing-in-azure-automation</a></p>\n"}], "owner": {"reputation": 108, "user_id": 3438194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2e23c82bd095e743f6b1eac496fbaa28?s=128&d=identicon&r=PG&f=1", "display_name": "Dimas", "link": "https://stackoverflow.com/users/3438194/dimas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1500042761, "creation_date": 1499885526, "question_id": 45065483, "link": "https://stackoverflow.com/questions/45065483/method-not-implemented-error-when-running-azure-script-from-c", "title": "&quot;Method not implemented&quot; error when running Azure script from c#", "body": "<p>I am trying to create a website to run scripts. I am retaking this, I had been working on this some 3 weeks ago and I was able to run a script and retrieve the result. Now I'm getting this \"method not implemented\" error, there were no changes to the code...</p>\n\n<pre><code>    public partial class SiteMaster : MasterPage\n{\n    public static Runspace runspace = RunspaceFactory.CreateRunspace();\n    public static Command login = new Command(\"select-azurermprofile\");\n\n    public static Collection&lt;PSObject&gt; UpdateVMsList()\n    {\n        ArrayList resourceGroups = GetRGs();\n        string rgsForPS = FormatRGs(resourceGroups);\n\n        PowerShell ps = PowerShell.Create();\n\n        string scr = @\"C:\\Users\\dimas\\Source\\Repos\\runPSsite\\slnSite\\slnSite\\PS\\Get-AzureRMVMParallel.ps1 -ResourceGroupNames \" +\n            rgsForPS + \"; $error;\";\n\n\n        ps.Runspace = Runspace.DefaultRunspace;\n        Collection&lt;PSObject&gt; res = ps.Invoke();\n\n        // here goes the treatment of my res variable\n    }\n}\n</code></pre>\n\n<p>I'm using the master page, which is loaded first. I placed a breakpoint in the last line of the code, and <code>res</code> contains this:</p>\n\n<pre><code>{Microsoft.Azure.Commands.Profile.Models.PSAzureContext}\n{Method 'AuthenticateAsync' in type 'Microsoft.Azure.Commands.Common.Authentication.KeyStoreApplicationCredentialProvider' from assembly 'Microsoft.Azure.Commands.Common.Authentication, Version=2.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' does not have an implementation.}\n</code></pre>\n\n<p>The first line is expected, I'm running my own login script that uses a profile created with <code>Save-AzureRMProfile</code> cmdlet.</p>\n\n<p>The second line happens when I run my script <code>Get-AzureRMVMParallel.ps1</code>, but the same happens if instead I run <code>Get-AzureRMVM</code> with a valid ResourceGroup parameter.</p>\n\n<p>If I open PowerShell ISE, run AzureLogin.ps1 and then call get-azurermvmparallel with the same parameters, it works.</p>\n\n<p>Thank you for taking the time to read, I'll appreciate any help.</p>\n\n<p>Dimas</p>\n"}, {"tags": ["c#", "asp.net", "json", "asp.net-web-api"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8115978"}, "edited": false, "score": 1, "creation_date": 1499886058, "post_id": 45065512, "comment_id": 77104538, "body": "Thank you! Getting an exception for a null value when deserializing the json now"}], "tags": [], "owner": {"reputation": 2185, "user_id": 2661801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mp7cr.jpg?s=128&g=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/2661801/carlos-rodriguez"}, "is_accepted": true, "score": 1, "last_activity_date": 1499886200, "last_edit_date": 1499886200, "creation_date": 1499885643, "answer_id": 45065512, "question_id": 45065430, "link": "https://stackoverflow.com/questions/45065430/asp-net-webhook-receiver/45065512#45065512", "title": "ASP .NET Webhook Receiver", "body": "<p>If you're really using Web API (and not MVC), your controller should be a subclass of ApiController (not Controller).</p>\n\n<p>Update: So, you really don't need to handle the deserializing of JSON yourself. Web API will do that for you. Your \"request\" parameter shouldn't be of type \"string\", it should actually be of the type that you're trying to deserialize to</p>\n\n<pre><code>[HttpPost]\npublic void PostObject([FromBody]testobject request)\n{\n\n    // Your request object should be deserialized already.\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8115978"}, "edited": false, "score": 0, "creation_date": 1499886023, "post_id": 45065551, "comment_id": 77104518, "body": "Thank you. It&#39;s now giving me an exception in the handler for &quot;var newData = JsonConvert.DeserializeObject&lt;testobject&gt;(s);&quot; saying that the value cannot be null. I am including an id and name in the post request from Postman though"}, {"owner": {"reputation": 447, "user_id": 4974596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191f476f38402dc0aa86c9871dbf2978?s=128&d=identicon&r=PG&f=1", "display_name": "kots", "link": "https://stackoverflow.com/users/4974596/kots"}, "edited": false, "score": 0, "creation_date": 1499886257, "post_id": 45065551, "comment_id": 77104657, "body": "Can you include the raw data with the Form POST? It should be similar to this format: {&quot;request&quot;: {&quot;id&quot;: &quot;1&quot;, &quot;name&quot;: &quot;john smith&quot;}} Otherwise, you will get null in your request parameter and will get the error you just described."}], "tags": [], "owner": {"reputation": 447, "user_id": 4974596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/191f476f38402dc0aa86c9871dbf2978?s=128&d=identicon&r=PG&f=1", "display_name": "kots", "link": "https://stackoverflow.com/users/4974596/kots"}, "is_accepted": false, "score": 0, "last_activity_date": 1499885761, "creation_date": 1499885761, "answer_id": 45065551, "question_id": 45065430, "link": "https://stackoverflow.com/questions/45065430/asp-net-webhook-receiver/45065551#45065551", "title": "ASP .NET Webhook Receiver", "body": "<p>Take out the API in your URL and try <a href=\"http://localhost:xxxx/Postman\" rel=\"nofollow noreferrer\">http://localhost:xxxx/Postman</a>. Your controller PostmanController is not a Web API (derived from Controller not ApiController class) so routing template of /api/{controller}/{id} is not correct in this case.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8115978"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6885, "favorite_count": 0, "accepted_answer_id": 45065512, "answer_count": 2, "score": 2, "last_activity_date": 1499886200, "creation_date": 1499885281, "question_id": 45065430, "link": "https://stackoverflow.com/questions/45065430/asp-net-webhook-receiver", "title": "ASP .NET Webhook Receiver", "body": "<p>I am trying to create a web app that will receive HTTP Posts containing json. All I want to do for now is show that I can receive the requests. I started by creating an ASP .NET web app with Web API template. I added a controller to receive the posts:</p>\n\n<pre><code>  public class PostmanController : Controller\n{\n\n    [System.Web.Mvc.HttpPost]\n    public void Index([FromBody] string request)\n    {\n\n        // Create handler class object\n        PostmanHandler test = new PostmanHandler();\n\n        // Pass request to the convertjsontoobject method\n        test.ConvertJsonToObject(request);\n\n    }\n}\n</code></pre>\n\n<p>As you can see here, I also created a handler in the Models folder:</p>\n\n<pre><code>public class PostmanHandler\n{\n public void ConvertJsonToObject(string s)\n    {\n        // Deserialize JSON\n        var newData = JsonConvert.DeserializeObject&lt;testobject&gt;(s);\n    }\n}\n</code></pre>\n\n<p>Which converts the JSON into a class I made:</p>\n\n<pre><code>public class testobject\n{\n    public int id { get; set; }\n    public string name { get; set; }\n}\n</code></pre>\n\n<p>I am trying to test this out to see if it works but I get a 404 response from Postman when I send a POST request. I am sending it to <a href=\"http://localhost:xxxx/api/Postman\" rel=\"nofollow noreferrer\">http://localhost:xxxx/api/Postman</a> which I thought follows the routing in the WebApiConfig file that states: routeTemplate: \"api/{controller}/{id}\"</p>\n\n<p>Am I leaving out some sort of routing? </p>\n"}, {"tags": ["c#", "stored-procedures", "parameters", "binding", "tableadapter"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4314825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09b5a43b4b3fb357f0937cb12b206193?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba D", "link": "https://stackoverflow.com/users/4314825/kuba-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1554470734, "last_edit_date": 1554470734, "creation_date": 1554440820, "answer_id": 55528564, "question_id": 45065378, "link": "https://stackoverflow.com/questions/45065378/how-to-add-an-additional-procedure-parameter-to-a-c-tableadapter-update-method/55528564#55528564", "title": "How to add an additional procedure parameter to a c# tableadapter update method?", "body": "<p>The following VB code works for me:</p>\n\n<pre><code>Me.MyTabTableAdapter.Adapter.InsertCommand.Parameters.AddWithValue(\"@IntParam\", 5)\nMe.MyTabTableAdapter.Adapter.InsertCommand.Parameters.Add(\"@TabParam\", SqlDbType.Structured).Value = tempDataTable   \nMe.MyTabTableAdapter.Update(MyDataSet.MyTab)\n</code></pre>\n\n<p><code>MyTabTableAdapter</code> is a table adapter corresponding to <code>MyDataSet.MyTab</code> table. </p>\n\n<p>Param <code>@TabParam</code> is a param of user table type. I was able to create a <code>DataTable</code> in my code on a fly and pass it to the server side. Column order of <code>tempDataTable</code> must exactly match those defined in the user table type.</p>\n\n<p>NB my first attempt was to use the \"synthetic\" column to the dataset as you have suggested. It has not worked. It is not possible to bind such column to the stored procedure param.</p>\n\n<p><strong>UPDATE</strong>\nThe above code works but.... just once.\nI have not taken into account that every save attempt will add another param with the same name which causes crash.\nAt the moment I believe that best approach is to add the proper param to <code>MyTabTableAdapter</code> with mouse in MyDataSet.xsd design mode and simply set:</p>\n\n<pre><code>Me.MyTabTableAdapter.Adapter.InsertCommand.Parameters(\"@TabParam\").Value = tempDataTable   \n</code></pre>\n\n<p>This is VB code so () meains indexing :).</p>\n"}], "owner": {"reputation": 21, "user_id": 8190800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa58b6277df798a49bdb89bd3b63f2a8?s=128&d=identicon&r=PG&f=1", "display_name": "Mark M", "link": "https://stackoverflow.com/users/8190800/mark-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 442, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1554470734, "creation_date": 1499885091, "last_edit_date": 1499890618, "question_id": 45065378, "link": "https://stackoverflow.com/questions/45065378/how-to-add-an-additional-procedure-parameter-to-a-c-tableadapter-update-method", "title": "How to add an additional procedure parameter to a c# tableadapter update method?", "body": "<p>I have a Winforms app in C# that uses a dataset's tableadapter fill and update methods to call stored procedures in the SQL Server database. This is working fine. All parameters to the update stored procedure are mapped to existing columns in the datatable.</p>\n\n<p>Now I want to add an additional parameter to the update stored procedure and method. But this column is not sourced from the datatable, but is sourced from another control on the form. It's a simple date that is picked from a calendar just once, and is not set row by row in the grid.  </p>\n\n<p>So I added a new parameter to the stored procedure, but without mapping it to a column in the dataset. When I did this, and reconfigured the tableadapter, I got the error: </p>\n\n<blockquote>\n  <p>Some parameter bindings are missing. Values from the DataSet will not be used for those parameters.</p>\n</blockquote>\n\n<p>I would hope and expect that the tableadapter update method would then be able to accept in this additional parameter as a method argument, but it doesn't.</p>\n\n<p>How should I approach this?  Is there a way to override the update method to provide this value?  Or should I add a \"synthetic\" column to the dataset, which gets set for each row (with the one value) at update time?</p>\n\n<p>Any advice would be greatly appreciated. Thanks!</p>\n"}, {"tags": ["c#", "asp.net", "ajax", "iis", "asp.net-ajax"], "comments": [{"owner": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 0, "creation_date": 1499885569, "post_id": 45065361, "comment_id": 77104272, "body": "How is your dictionary being stored?  In a Session variable?  In an Application variable?  In a variable on the page?"}, {"owner": {"reputation": 1280, "user_id": 1786791, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a1d0832b721c20bb00e3bc879a004537?s=128&d=identicon&r=PG", "display_name": "VikkyB", "link": "https://stackoverflow.com/users/1786791/vikkyb"}, "reply_to_user": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 0, "creation_date": 1499886040, "post_id": 45065361, "comment_id": 77104526, "body": "Updated the question."}, {"owner": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 0, "creation_date": 1499886659, "post_id": 45065361, "comment_id": 77104836, "body": "So let me understand your problem.  You have an aspx page that a user is looking at.  Then, the app pool times out while they are looking at the page and some or all of information in the code behind gets destroyed?  If the app pool is timing out so fast then you should increase it.If the user is sitting on the page for hours without doing anything then that&#39;s a different issue."}, {"owner": {"reputation": 1280, "user_id": 1786791, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a1d0832b721c20bb00e3bc879a004537?s=128&d=identicon&r=PG", "display_name": "VikkyB", "link": "https://stackoverflow.com/users/1786791/vikkyb"}, "reply_to_user": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 0, "creation_date": 1499889274, "post_id": 45065361, "comment_id": 77106181, "body": "I can increase the timeout but that&#39;s not a preferred solution. Would there be any way I could determine in the code behind that the app pool has timed out? Or that my information in code behind has been destroyed by the app pool?"}, {"owner": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 0, "creation_date": 1500388450, "post_id": 45065361, "comment_id": 77307623, "body": "Why don&#39;t you simply check if _dbList is null and if it is then repopulate it?"}], "owner": {"reputation": 1280, "user_id": 1786791, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a1d0832b721c20bb00e3bc879a004537?s=128&d=identicon&r=PG", "display_name": "VikkyB", "link": "https://stackoverflow.com/users/1786791/vikkyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1499886027, "creation_date": 1499885015, "last_edit_date": 1499886027, "question_id": 45065361, "link": "https://stackoverflow.com/questions/45065361/app-pool-timeout-destroys-asp-net-code-behind-properties", "title": "App Pool Timeout Destroys ASP.NET code behind properties", "body": "<p>I am maintaining some data in form of a dictionary as an ASP.NET code behind property. When the App Pool timeout is reached, dictionary with data is destroyed (surprisingly other string properties are not).</p>\n\n<p>I am using PageMethods (works like AJAX) to load part of the data from my dictionary as per the request by Javascript.</p>\n\n<p>I need to detect when the App Pool has timed out in my code behind, so that I could probably refresh the page.  </p>\n\n<p>Dictionary is being stored in an object wrapper as:</p>\n\n<blockquote>\n  <p>public partial class SourceWorkqueue : System.Web.UI.Page<br>\n  {<br>\n  internal static ObjectType _dbList;</p>\n</blockquote>\n"}, {"tags": ["c#", "asp.net", "angularjs", "enums"], "comments": [{"owner": {"reputation": 1054, "user_id": 2146761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d3bc29238e60d795bd6644a548358d?s=128&d=identicon&r=PG", "display_name": "chris-crush-code", "link": "https://stackoverflow.com/users/2146761/chris-crush-code"}, "edited": false, "score": 0, "creation_date": 1499887685, "post_id": 45065312, "comment_id": 77105390, "body": "Did you try casting it as shown in this: <a href=\"https://stackoverflow.com/questions/29482/cast-int-to-enum-in-c-sharp\" title=\"cast int to enum in c sharp\">stackoverflow.com/questions/29482/cast-int-to-enum-in-c-shar&zwnj;&#8203;p</a>"}], "owner": {"reputation": 103, "user_id": 4956826, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/76e6eaf1d97ffd1f9f9a4cceafd2c5e8?s=128&d=identicon&r=PG&f=1", "display_name": "Will", "link": "https://stackoverflow.com/users/4956826/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499884849, "creation_date": 1499884849, "question_id": 45065312, "link": "https://stackoverflow.com/questions/45065312/dropdownlist-wipes-out-after-save", "title": "DropDownList wipes out after save", "body": "<p>I have coded the following EnumDropDownList:</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n     @Html.LabelFor(model =&gt; model.SecurityClearance, htmlAttributes: new { @class = \"control-label col-md-2 required-label\" })\n           &lt;div class=\"col-md-10\"&gt;\n                @Html.EnumDropDownListFor(model =&gt; model.SecurityClearance, new { @class = \"form-control\", data_ng_model = \"model.user.SecurityClearance\", required = \"required\"})\n                @Html.ValidationMessageFor(model =&gt; model.SecurityClearance, \"\", new { @class = \"text-danger\" })\n           &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Which is populated by the following enum:</p>\n\n<pre><code>public enum SecurityClearance\n{\n    NONE = 0,\n    INTERIM = 1,\n    CONFIDENTIAL = 2,\n    SECRET = 3,\n    TOPSECRET = 4,\n    TOPSECRETSCI = 5\n}\n</code></pre>\n\n<p>Everything works fine, to a point.  The list will populate properly, I can select a value, and that value saves to the database.  The problems begin after the Save(). After every Save(), the current value in the dropdown list wipes itself.  The database still has a right value, but it won't display in the view.  Eventually, I added this to view:</p>\n\n<pre><code>{{model.user.SecurityClearance}}\n</code></pre>\n\n<p>This line of code evaluates to an integer corresponding to the index of the chosen enum.  Even after the dropdown list 'wipes', the Angular expression will continue to evaluate to the proper index.  </p>\n\n<p>I am assuming that my problem is that the database is returning the integer after every save.  This makes sense since the database is storing the index as an integer and not the word itself.</p>\n\n<p>My question is: Am I correct in this assumption?  And if so, how do I convert the index back to the proper word?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1499885256, "post_id": 45065293, "comment_id": 77104093, "body": "Does the order of the output matter?"}, {"owner": {"reputation": 43, "user_id": 8239083, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1348087235304572/picture?type=large", "display_name": "Adnan Haider", "link": "https://stackoverflow.com/users/8239083/adnan-haider"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1499922344, "post_id": 45065293, "comment_id": 77116151, "body": "no order doesn&#39;t matter but each line should be unique"}], "answers": [{"tags": [], "owner": {"reputation": 8015, "user_id": 2278086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/10043ce18f5e3f4231fc9a45c5515752?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/2278086/mark"}, "is_accepted": false, "score": 0, "last_activity_date": 1499885556, "creation_date": 1499885556, "answer_id": 45065493, "question_id": 45065293, "link": "https://stackoverflow.com/questions/45065293/how-do-i-can-delete-a-matching-line-from-a-file-in-c/45065493#45065493", "title": "How do i can delete a matching line from a file in c#", "body": "<p>You could just use the LINQ <a href=\"https://msdn.microsoft.com/en-us/library/bb348436(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>Distinct</code></a> function:</p>\n\n<pre><code>var filename = @\"C:\\Users\\Adnan Haider\\Desktop\\line.txt\";\nFile.WriteAllLines(filename, File.ReadAllLines(filename).Distinct());\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "is_accepted": false, "score": 0, "last_activity_date": 1499886199, "last_edit_date": 1499886199, "creation_date": 1499885613, "answer_id": 45065504, "question_id": 45065293, "link": "https://stackoverflow.com/questions/45065293/how-do-i-can-delete-a-matching-line-from-a-file-in-c/45065504#45065504", "title": "How do i can delete a matching line from a file in c#", "body": "<p>You can use LINQ <code>Distinct()</code>;</p>\n\n<pre><code>string[] outfiles = File.ReadAllLines(@\"C:\\Users\\AdnanHaider\\Desktop\\line.txt\");\n\nvar filteredLines = outfiles.Distinct();\n\nFile.WriteAllLines(@\"C:\\Users\\Adnan Haider\\Desktop\\line.txt\", filteredLines );\n</code></pre>\n\n<p>I made a fiddle <a href=\"https://dotnetfiddle.net/HjWBpc\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 43, "user_id": 8239083, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/1348087235304572/picture?type=large", "display_name": "Adnan Haider", "link": "https://stackoverflow.com/users/8239083/adnan-haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1499886199, "creation_date": 1499884776, "last_edit_date": 1499885688, "question_id": 45065293, "link": "https://stackoverflow.com/questions/45065293/how-do-i-can-delete-a-matching-line-from-a-file-in-c", "title": "How do i can delete a matching line from a file in c#", "body": "<p>i have a condition that each line in a should be unique i am writing output of a file to another file and before writing output i have to check whether the line already exists in file if so then i have to skip that line to avoid multiple entry</p>\n\n<pre><code>string[] outfiles = File.ReadAllLines(@\"C:\\Users\\AdnanHaider\\Desktop\\line.txt\");\nforeach (string repeat in outfiles)\n{\n    if (repeat.Contains(data))\n    {         \n    }\n    else \n    {\n        File.WriteAllLines(@\"C:\\Users\\Adnan Haider\\Desktop\\line.txt\",lineData);             \n    } \n}\n</code></pre>\n\n<p>here data is the output of first file and outfile is the in which data is to be written and to be checked if data exists in outfiles or not if yes then delete that data continue further</p>\n"}, {"tags": ["c#", "reflection", ".net-3.5"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 2, "creation_date": 1499884803, "post_id": 45065282, "comment_id": 77103834, "body": "Are you sure you have the <code>PropertyInfo</code> from the base class? That ought to work."}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1499885242, "post_id": 45065282, "comment_id": 77104083, "body": "@SLaks The PropertyInfo is obtained using <code>interfaceType.GetProperty(validationAttribute.AssociatedProp&zwnj;&#8203;ertyName)</code>. I think that should point to the base <code>PropertyInfo</code> since it&#39;s only the base class interface that contains the attribute? The <code>ChildClass</code> has it&#39;s own interface that overwrites using the <code>new</code> keyword as well : <code>new string Id { get; set; }</code>. If I check the <code>propertyInfo.DeclaringType</code> and <code>propertyInfo.ReflectedType</code> it tells me it&#39;s the <code>BaseClass</code> interface."}, {"owner": {"reputation": 58863, "user_id": 1875256, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/no10d.jpg?s=128&g=1", "display_name": "Ehsan Sajjad", "link": "https://stackoverflow.com/users/1875256/ehsan-sajjad"}, "edited": false, "score": 0, "creation_date": 1499886990, "post_id": 45065282, "comment_id": 77105006, "body": "how are you extracting the <code>PropertyInfo</code> ?"}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 58863, "user_id": 1875256, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/no10d.jpg?s=128&g=1", "display_name": "Ehsan Sajjad", "link": "https://stackoverflow.com/users/1875256/ehsan-sajjad"}, "edited": false, "score": 0, "creation_date": 1499887125, "post_id": 45065282, "comment_id": 77105083, "body": "@EhsanSajjad I&#39;ve edited my question with some code that can be pasted into a command prompt window to see what I am getting vs what I am expecting."}, {"owner": {"reputation": 58863, "user_id": 1875256, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/no10d.jpg?s=128&g=1", "display_name": "Ehsan Sajjad", "link": "https://stackoverflow.com/users/1875256/ehsan-sajjad"}, "edited": false, "score": 0, "creation_date": 1499887492, "post_id": 45065282, "comment_id": 77105280, "body": "what i think you cannot as you are calling via interface type and <code>new</code> will cause the property of child class to be hidden, may be possible but not in my knowledge"}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 58863, "user_id": 1875256, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/no10d.jpg?s=128&g=1", "display_name": "Ehsan Sajjad", "link": "https://stackoverflow.com/users/1875256/ehsan-sajjad"}, "edited": false, "score": 0, "creation_date": 1499887628, "post_id": 45065282, "comment_id": 77105355, "body": "@EhsanSajjad That could very well be my answer. I am trying now to figure out a way to get the <code>BaseClass.Id</code> now without hardcoding any types, but I may have to accept that it is not possible and implement a different solution. I was hoping someone on SO might know the answer to this question to save me a lot of trial and error :)"}, {"owner": {"reputation": 58863, "user_id": 1875256, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/no10d.jpg?s=128&g=1", "display_name": "Ehsan Sajjad", "link": "https://stackoverflow.com/users/1875256/ehsan-sajjad"}, "edited": false, "score": 0, "creation_date": 1499887931, "post_id": 45065282, "comment_id": 77105510, "body": "Yeah i also hope someone more knowledgeable than us may comeup with some solution, let&#39;s see :)"}, {"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 1, "creation_date": 1499888052, "post_id": 45065282, "comment_id": 77105569, "body": "@Rachel: You need to get the <code>PropertyInfo</code> from the actual base type you want it for; interfaces always bind to the most-derived class."}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1499888375, "post_id": 45065282, "comment_id": 77105705, "body": "@SLaks Thank you, that makes sense. I think the answer to my question then is based on my code, I cannot. At least, not unless I want to start messing with the validation code framework built for this application to get PropertyInfo from the class rather than the interface (which I do not). I&#39;ll have to come up with a different solution for this :)"}, {"owner": {"reputation": 33816, "user_id": 9664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/34d380684d276ce51be4e13fecca03cd?s=128&d=identicon&r=PG", "display_name": "Metro Smurf", "link": "https://stackoverflow.com/users/9664/metro-smurf"}, "edited": false, "score": 0, "creation_date": 1499888955, "post_id": 45065282, "comment_id": 77106004, "body": "@Rachel, make the base class property a virtual property and it should correctly resolve the attribute with the current code interrogating the interface (I haven&#39;t tested); assuming the derived class overrides, not hides."}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 33816, "user_id": 9664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/34d380684d276ce51be4e13fecca03cd?s=128&d=identicon&r=PG", "display_name": "Metro Smurf", "link": "https://stackoverflow.com/users/9664/metro-smurf"}, "edited": false, "score": 0, "creation_date": 1499889162, "post_id": 45065282, "comment_id": 77106125, "body": "@MetroSmurf How would that help? The attribute is on the interface definition, so I don&#39;t think it would matter how it is implemented. I did test though, and it does not work. I still receive the <code>ChildClass.Id</code> rather then the <code>BaseClass.Id</code>"}, {"owner": {"reputation": 33816, "user_id": 9664, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/34d380684d276ce51be4e13fecca03cd?s=128&d=identicon&r=PG", "display_name": "Metro Smurf", "link": "https://stackoverflow.com/users/9664/metro-smurf"}, "edited": false, "score": 0, "creation_date": 1499889552, "post_id": 45065282, "comment_id": 77106314, "body": "I should read the code sample; didn&#39;t realize the 2 interfaces both had the same property. I was thinking the derived class would pick up the base class&#39; interface and the overriden property would be returned, but that wouldn&#39;t work either since you need the base class attribute. Delete any thought of this :)"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499890404, "post_id": 45065282, "comment_id": 77106746, "body": "This code is super confusing. Sometimes <code>IBaseClass</code> is an interface, sometimes it is a class. If it is a class, then why does it begin with <code>I</code>? If it is an interface, then why does it end with <code>Class</code>?  Try to make your code <i>easy for the reader to understand</i>, because then we&#39;ll spend time thinking about your problem, and not on trying to figure out what is a class, what is an interface, and what is a typo."}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499969799, "post_id": 45065282, "comment_id": 77148831, "body": "@EricLippert I&#39;m sorry for the confusing code, I tried to extract the relevant bits of code from the custom library I&#39;m working with into a sample project that reproduced my scenario without altering any of the code. I&#39;ve updated my question with a better code sample demonstrating what I am getting vs what I am looking for."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499971589, "post_id": 45065282, "comment_id": 77149915, "body": "Now your comments don&#39;t match your code. The comment says &quot;PropertyInfo is for BaseClass.Id&quot; -- absolutely it is not. It is for IBaseClass.Id.  <b>We can&#39;t make heads or tails of this question because it is so confusingly written</b>. It&#39;s impossible to know whether you&#39;ve simply made a typo, or you&#39;re confused about which property info you&#39;re looking at, or what.  Ask a much more clear question. Stop naming things all the same."}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499971702, "post_id": 45065282, "comment_id": 77149976, "body": "@EricLippert I&#39;m not sure I understand what you mean. If I look at <code>p.ReflectedType</code> and <code>p.DefinedType</code> where the breakpoint is set, it shows the PropertyInfo is for <code>IBaseClass</code>, so I would expect it to return me <code>IBaseClass.Id</code>. Would it help if I made a new question for it and deleted this one with it&#39;s outdated comments?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499971886, "post_id": 45065282, "comment_id": 77150082, "body": "When you ask someone &quot;where&#39;s the bug in my code?&quot; and your code has comments that contain falsehoods, my conclusion is that the bug is <i>the author&#39;s false beliefs about their code</i>, and that the code is probably fine. Help us help you."}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499971985, "post_id": 45065282, "comment_id": 77150147, "body": "@EricLippert I&#39;m sorry, I&#39;m not understanding what falsehoods are in my code comments. I&#39;ve updated to try and clarify what I am referring to. Is there a chat room I can find you in to discuss this?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499972139, "post_id": 45065282, "comment_id": 77150241, "body": "Let&#39;s take a step back.  Suppose in your inner loop you instead had <code>object val = ((IBaseClass)c).Id;</code>  Tell me <b>what value do you believe val should have</b>?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499972230, "post_id": 45065282, "comment_id": 77150298, "body": "Because I think your fundamental problem is that you don&#39;t understand how interface implementation works in C#.  All this stuff with reflection and attributes and whatnot is just red herrings.  <code>((IBaseClass)c).Id</code> is <code>&quot;B&quot;</code>, not <code>null</code>, and that&#39;s what you should get regardless of whether you use reflection or not."}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1499972513, "post_id": 45065282, "comment_id": 77150490, "body": "@EricLippert I think I understand. I had been casting to the base class instead of the interface for testing, and <code>((BaseClass)c).Id</code> returns <code>null</code>. If I cast to the interface instead using  <code>((IBaseClass)c).Id</code>, it returns me &quot;B&quot;. The core of my question is I wanted a generic way to retrieve <code>((BaseClass)c).Id</code> (which is null in this case) because the PropertyInfo was for <code>IBaseClass</code>. That is not going to happen though, as <code>IBaseClass</code> is also implemented by <code>IChildClass</code>. It is not specific to <code>BaseClass</code>. I&#39;m sorry, I think I&#39;ve been staring at this too long on too little sleep :("}], "answers": [{"comments": [{"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "edited": false, "score": 1, "creation_date": 1499969732, "post_id": 45072204, "comment_id": 77148786, "body": "I&#39;m sorry for the confusion, I have edited my question with what I hope is a better code sample and summary. I know there is coding that isn&#39;t optimized, however I did my best to extract the code from the huge application into a small sample project without changing any of the code, and as a result some code isn&#39;t optimal."}], "tags": [], "owner": {"reputation": 63, "user_id": 3555546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rEBOP.jpg?s=128&g=1", "display_name": "Vincent Shen", "link": "https://stackoverflow.com/users/3555546/vincent-shen"}, "is_accepted": false, "score": 0, "last_activity_date": 1499924302, "creation_date": 1499924302, "answer_id": 45072204, "question_id": 45065282, "link": "https://stackoverflow.com/questions/45065282/can-i-use-reflection-to-get-the-base-property-that-has-been-overridden-via-the-n/45072204#45072204", "title": "Can I use reflection to get the base property that has been overridden via the new keyword?", "body": "<p>Actually I don't excately understand your question.\nJust tried with your code in a console application, and I got the \"val\" equals \"B\" (which is BaseClass.Id).</p>\n\n<p>The result should be BaseClass.Id in this case. The names you given \"Id\" are confusing here. If you use different name in ChildClass, you will see everything works with no doubt. I want to list some points here:</p>\n\n<ul>\n<li>The \"Id\" property has not been <strong>overriden</strong>, but <strong>overloaded</strong>. </li>\n<li>BaseClass.Id inherits IBaseClass.Id, whereas ChildClass.Id inherits IChildClass.Id. In addition, they actually have no relationship at all.</li>\n<li>If you want to do GetInterfaces, simply use <code>c.GetType().GetInterfaces()</code></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "edited": false, "score": 1, "creation_date": 1499972885, "post_id": 45089067, "comment_id": 77150711, "body": "Thank you for explaining things in such a clear and easy to understand way! Its not the first time your answers on SO have helped me, and I doubt it will be the last :) Your simplified code sample makes the problem perfectly clear to me, and I will have to work on an alternate solution to my issue."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "edited": false, "score": 1, "creation_date": 1499973402, "post_id": 45089067, "comment_id": 77150973, "body": "@Rachel: You&#39;re welcome. See my follow-up edits, and see if you can predict the behaviour of the program. You might also want to do a web search on &quot;C# interface re-implementation&quot;. This is a subtle and often misunderstood rule!"}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "edited": false, "score": 1, "creation_date": 1499975064, "post_id": 45089067, "comment_id": 77151815, "body": "Interesting follow-up edit. The results surprised me at first, but it makes sense when I think about it. When doing something like <code>((IC)d2).P</code>, it seems to first check if the object inherits from IC, and if not it goes to the base object and checks there. So when <code>d2</code> inherits from <code>IC</code>, it can just use d2.P. But when <code>d1</code> does not inherit directly from IC, it looks at base class of C which does inherit from IC, so it casts it as C to get IC.P value."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "edited": false, "score": 4, "creation_date": 1499989628, "post_id": 45089067, "comment_id": 77157723, "body": "@Rachel: That&#39;s good reasoning, but there is a more subtle point. Suppose you had <code>class D : C, IC</code> and <code>C</code> did <i>not</i> implement <code>IC</code>. You would expect <code>IC.P</code> in <code>D</code> to refer to <code>D.P</code> of course.  Now suppose you edit <code>C</code> to implement <code>IC</code>. Would you expect the change to the <i>base class</i> to change the binding of interface methods in a <i>derived class</i>? That would be a very strange breaking change; this is a version of the <i>brittle base class</i> problem. Many seemingly-unusual design choices in C# are there to mitigate brittle base class failures."}], "tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": true, "score": 6, "last_activity_date": 1499973323, "last_edit_date": 1499973323, "creation_date": 1499972580, "answer_id": 45089067, "question_id": 45065282, "link": "https://stackoverflow.com/questions/45065282/can-i-use-reflection-to-get-the-base-property-that-has-been-overridden-via-the-n/45089067#45089067", "title": "Can I use reflection to get the base property that has been overridden via the new keyword?", "body": "<p>All this stuff with reflection and attributes and whatnot is red herrings. The fundamental problem is that you've got some false beliefs about how interfaces work. Let me greatly simplify your program:</p>\n\n<pre><code>using System;\npublic interface IBaseClass\n{\n    string Id { get; set; }\n}\npublic interface IChildClass : IBaseClass\n{\n    new string Id { get; set; }\n}\npublic class BaseClass : IBaseClass\n{\n    public string Id { get; set; }\n}\npublic class ChildClass : BaseClass, IChildClass\n{\n    public new string Id { get; set; }\n}\npublic class Program\n{\n    static public void Main(string[] args)\n    {\n        ChildClass c = new ChildClass();\n        ((BaseClass)c).Id = \"Base\";\n        c.Id = \"Child\";\n        Console.WriteLine( ((BaseClass)c).Id);    // Base\n        Console.WriteLine( ((ChildClass)c).Id);   // Child\n        Console.WriteLine( ((IBaseClass)c).Id);   // Child !!!\n        Console.WriteLine( ((IChildClass)c).Id);  // Child\n    }\n}\n</code></pre>\n\n<p>Your problem is that you believe the third line should say <code>Base</code>, but this is wrong. It should say <code>Child</code>.</p>\n\n<p>When you say <code>class ChildClass : BaseClass, IChildClass</code> you are saying <strong>please find me the best possible bindings of properties of <code>ChildClass</code> to the required members of <code>IChildClass</code>.</strong> What does <code>IChildClass</code> require? It requires <strong>two string properties both called Id</strong>. The best possible binding for both is <code>ChildClass.Id</code>.</p>\n\n<p>So when you have a property info in hand for <code>IBaseClass.Id</code> and ask for the value, you get <code>Child</code>, because <em>in <code>ChildClass</code></em>, that's the best possible binding.</p>\n\n<p>Now let's make it more interesting.</p>\n\n<pre><code>using System;\npublic interface IB\n{\n    string P { get; }\n}\npublic interface IC : IB\n{\n    new string P { get;}\n}\npublic class B : IB\n{\n    public string P =&gt; \"B\";\n}\npublic class C : B, IC\n{\n    public new string P =&gt; \"C\";\n}\npublic class D1 : C  // NO IC\n{\n    public new string P =&gt; \"D1\";\n}\npublic class D2 : C, IC // YES IC\n{\n    public new string P =&gt; \"D2\";\n}\npublic class Program\n{\n    static public void Main(string[] args)\n    {\n        var d1 = new D1();\n        var d2 = new D2();\n        Console.WriteLine(((B)d1).P);\n        Console.WriteLine(((C)d1).P);\n        Console.WriteLine(((IB)d1).P);\n        Console.WriteLine(((IC)d1).P);\n        Console.WriteLine(((D1)d1).P);\n        Console.WriteLine(((B)d2).P);\n        Console.WriteLine(((C)d2).P);\n        Console.WriteLine(((IB)d2).P);\n        Console.WriteLine(((IC)d2).P);\n        Console.WriteLine(((D2)d2).P);\n    }\n}\n</code></pre>\n\n<p>Can you predict the behaviour of this program?  </p>\n\n<p>This is one of the most subtle rules of C#:  <strong>when you explicitly put an interface in the class declaration, EVERY member of that interface is re-bound to the best value.</strong></p>\n"}], "owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 4, "accepted_answer_id": 45089067, "answer_count": 2, "score": 3, "last_activity_date": 1499973323, "creation_date": 1499884723, "last_edit_date": 1499971815, "question_id": 45065282, "link": "https://stackoverflow.com/questions/45065282/can-i-use-reflection-to-get-the-base-property-that-has-been-overridden-via-the-n", "title": "Can I use reflection to get the base property that has been overridden via the new keyword?", "body": "<p>I'm working with some code which uses custom attributes for validation. I am trying to overwrite a validated property from the base class in a child class so it uses the same name for binding purposes in our generic controls, but doesn't have the validation attribute.</p>\n\n<pre><code>public interface IBaseClass\n{\n    [TestAttribute]\n    string Id { get; set; }\n}\n\npublic interface IChildClass : IBaseClass\n{\n    new string Id { get; set; }\n}\n\npublic class BaseClass : IBaseClass\n{\n    public string Id { get; set; }\n}\n\npublic class ChildClass : BaseClass, IChildClass\n{\n    public new string Id { get; set; }\n}\n</code></pre>\n\n<p>My problem is that when our validation framework uses reflection to get the value, it is returning the child value instead of the base value.</p>\n\n<p>For example, </p>\n\n<ul>\n<li>BaseClass.Id = null</li>\n<li>ChildClass.Id = \"B\"</li>\n</ul>\n\n<p>Using the <code>PropertyInfo</code> for <code>BaseClass.Id</code>, I receive the value from <code>ChildClass.Id</code>.</p>\n\n<p>Is it possible to use reflection to get <code>BaseClass.Id</code> rather than <code>ChildClass.Id</code> when looking at an object of type <code>ChildClass</code>?</p>\n\n<p>Here's some sample code you can paste into a command line app to see what I am trying to do. I added comments with what I get vs what is Expected.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        Console.WriteLine(\"Starting\");\n\n        ChildClass c = new ChildClass();\n        c.Id = \"B\";\n\n        foreach (Type interfaceType in GetInterfaces&lt;IChildClass&gt;())\n        {\n            foreach (PropertyInfo p in interfaceType.GetProperties())\n            {\n                Attribute[] attribs = Attribute.GetCustomAttributes(p, typeof(TestAttribute));\n                foreach (TestAttribute v in attribs)\n                {\n                    if (v != null)\n                    {\n                        object val = p.GetValue(c, new object[0]);\n\n                        // Put breakpoint here\n                        v.Validate(val);\n\n                        // p.ReflectedType is IBaseClass, so I would expect\n                        // val to be BaseClass.Id (null), however it is instead\n                        // returning me ChildClass.Id (\"B\")\n\n                        // Can I use reflection to get BaseClass.Id here,\n                        // without hardcoding any types?\n\n                    }\n                }\n            }\n        }\n\n\n        Console.ReadLine();\n    }\n\n    private static IList&lt;Type&gt; GetInterfaces&lt;B&gt;()\n    {\n        List&lt;Type&gt; interfaces = new List&lt;Type&gt;();\n        interfaces.Add(typeof(B));\n\n        Type[] values = typeof(B).GetInterfaces();\n\n        foreach (Type t in values)\n        {\n            interfaces.Add(t);\n        }\n\n        return interfaces;\n    }\n}\n\n\npublic interface IBaseClass\n{\n    [TestAttribute]\n    string Id { get; set; }\n}\n\n// for sample purposes, removing inheritance from IBaseClass here\n// gets me the desired result, however this is not an option in \n// the application I am working on. This base interface must remain on the \n// child interface\npublic interface IChildClass : IBaseClass\n{\n    new string Id { get; set; }\n}\n\npublic class BaseClass : IBaseClass\n{\n    public string Id { get; set; }\n}\n\npublic class ChildClass : BaseClass, IChildClass\n{\n    public new string Id { get; set; }\n}\n\npublic class TestAttribute : Attribute\n{\n    public TestAttribute() { }\n\n    public void Validate(object value)\n    {\n        if (value == null)\n            return;\n    }\n}\n</code></pre>\n\n<p>Note : Question has gone through a couple of iterations as I've tried to sort through the code framework I'm working on, and reproduce a simple example of what I am trying to do. I think I finally have a good working code sample showing what I get vs what I want.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "architecture", "onion-architecture"], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "edited": false, "score": 0, "creation_date": 1499885177, "post_id": 45065322, "comment_id": 77104055, "body": "But isnt the core layer suppose to be logicless? I might be wrong @_ @"}], "tags": [], "owner": {"reputation": 46, "user_id": 7422627, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wEs4r7Hz8sw/AAAAAAAAAAI/AAAAAAAAA-Y/B4qS23pswwc/photo.jpg?sz=128", "display_name": "Laurent Morissette", "link": "https://stackoverflow.com/users/7422627/laurent-morissette"}, "is_accepted": false, "score": 0, "last_activity_date": 1499884865, "creation_date": 1499884865, "answer_id": 45065322, "question_id": 45065261, "link": "https://stackoverflow.com/questions/45065261/where-do-i-keep-logic-for-file-upload-and-calculations-in-onion-architecture/45065322#45065322", "title": "Where do I keep logic for file upload and calculations in onion architecture?", "body": "<p>I'd piut it in app.core if this feature  is shared between layer </p>\n"}, {"comments": [{"owner": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "edited": false, "score": 0, "creation_date": 1499888398, "post_id": 45065579, "comment_id": 77105720, "body": "so do you think it is a good idea to make something like IPhotoSaverService and make a repository in app.core like IPhotoSaverRepository that instead of lets says makes a database calls it saves images to directory?"}, {"owner": {"reputation": 2185, "user_id": 2661801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mp7cr.jpg?s=128&g=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/2661801/carlos-rodriguez"}, "reply_to_user": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "edited": false, "score": 0, "creation_date": 1499888482, "post_id": 45065579, "comment_id": 77105761, "body": "To be clear, the interfaces should be in core. The actual implementations shouldn&#39;t"}, {"owner": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "edited": false, "score": 0, "creation_date": 1499891144, "post_id": 45065579, "comment_id": 77107079, "body": "Yeah, all of my implementations are for core interface are placed in infrastructure layer. So, saving files in PhotoSaverRepository is a good idea? Thanks for helping anyway @_ @"}, {"owner": {"reputation": 2185, "user_id": 2661801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mp7cr.jpg?s=128&g=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/2661801/carlos-rodriguez"}, "reply_to_user": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "edited": false, "score": 0, "creation_date": 1499891378, "post_id": 45065579, "comment_id": 77107206, "body": "Yeah, that makes sense to me, assuming that the PhotoSaverRepository is a class in your infrastructure layer, and it&#39;s implementing the IPhotoSaverRepository interface which was defined in your core library."}, {"owner": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "edited": false, "score": 1, "creation_date": 1499891664, "post_id": 45065579, "comment_id": 77107350, "body": "Yeah, that is how I had it until now. Just like all operations were based on those basic add/delete/remove/get and then when I found out about implementing file upload, I was like &quot;Where the hell am I suppose to do that?&quot;"}, {"owner": {"reputation": 2185, "user_id": 2661801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mp7cr.jpg?s=128&g=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/2661801/carlos-rodriguez"}, "reply_to_user": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "edited": false, "score": 0, "creation_date": 1499891885, "post_id": 45065579, "comment_id": 77107459, "body": "Ah I see. So ideally, your core app uses IPhotoSaverRepository. It doesn&#39;t care about the specifics about how the photos are saved. The actual implementation details are left to your infrastructure layer. It&#39;s a good practice because, let&#39;s say you have a LocalPhotoSaverRepository which just saves your photos locally. Later on, you want to move your photos to the cloud. You can then just make a CloudPhotoSaverRepository that also implements the same interface, and your domain (core) wouldn&#39;t ever know the difference."}], "tags": [], "owner": {"reputation": 2185, "user_id": 2661801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mp7cr.jpg?s=128&g=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/2661801/carlos-rodriguez"}, "is_accepted": true, "score": 4, "last_activity_date": 1499885871, "creation_date": 1499885871, "answer_id": 45065579, "question_id": 45065261, "link": "https://stackoverflow.com/questions/45065261/where-do-i-keep-logic-for-file-upload-and-calculations-in-onion-architecture/45065579#45065579", "title": "Where do I keep logic for file upload and calculations in onion architecture?", "body": "<p>Your domain (or core) doesn't have to be logicless. In fact, I'd say that your business logic SHOULD be in your domain, as your business logic is the core of your application. It's what actually gives your business value. I'd put that logic there. While you're writing that logic, you might notice that you'll need to certain infrastructure calls to save to a file system or send emails. You then just add the interfaces to your core, and assume that it'd be implemented (and injected in) by an outer layer.  </p>\n"}], "owner": {"reputation": 365, "user_id": 7366897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/453a31cb750f642ea931b8f8d3e50a66?s=128&d=identicon&r=PG&f=1", "display_name": "bunakawaka", "link": "https://stackoverflow.com/users/7366897/bunakawaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 1, "accepted_answer_id": 45065579, "answer_count": 2, "score": 3, "last_activity_date": 1499885871, "creation_date": 1499884628, "question_id": 45065261, "link": "https://stackoverflow.com/questions/45065261/where-do-i-keep-logic-for-file-upload-and-calculations-in-onion-architecture", "title": "Where do I keep logic for file upload and calculations in onion architecture?", "body": "<p>So.. I was working lately with onion architecture and also been reading quite a lot about it, the only thing that most of blog posts/guide/etc. did not explained is, where do I keep logic like upload of image or some calculations?</p>\n\n<p>Right now I got something like this</p>\n\n<p>-<code>app.core</code> &lt;-- keeps the domain models and interfaces for repository with simple add,update,remove, get, getAll things</p>\n\n<p>-<code>app.infrastructure</code> &lt;-- implements my <code>app.core</code> repository and also has services, contains the IoC modules and mappersettings</p>\n\n<p>-<code>app.application</code> &lt;- it just all about users that makes request to the controllers and the controllers calling the services from <code>app.infrastructure</code> and gets back DTO models</p>\n\n<p>So.. where do I put those two things? Because I feel like all onion does is is add,update,remove,get,getAll</p>\n\n<p>Where do I keep more complex code.. like file uploading? halp</p>\n"}, {"tags": ["c#", "wcf"], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 3043131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41dc6b9355f805a977a6eb6174086f27?s=128&d=identicon&r=PG&f=1", "display_name": "Roath So", "link": "https://stackoverflow.com/users/3043131/roath-so"}, "is_accepted": true, "score": 0, "last_activity_date": 1499886173, "last_edit_date": 1499886173, "creation_date": 1499885686, "answer_id": 45065524, "question_id": 45065249, "link": "https://stackoverflow.com/questions/45065249/show-the-list-of-exceptions-that-are-thrown-by-service-method/45065524#45065524", "title": "Show the list of exceptions that are thrown by service method", "body": "<p>In web.config, there is a behavior tag. Place the following config.</p>\n\n<pre><code>&lt;behavior&gt;\n&lt;serviceDebug includeExceptionDetailInFaults=\"true\" /&gt;&lt;/behavior&gt;\n</code></pre>\n\n<p>If you want to trace all service calls, you can paste the following to your config file of your wcf. initializeData is the location the log file be written to. You need to use the <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wcf/service-trace-viewer-tool-svctraceviewer-exe\" rel=\"nofollow noreferrer\">service trace viewer tool</a> to view the log.</p>\n\n<pre><code>&lt;system.diagnostics&gt;\n&lt;sources&gt;\n  &lt;source name=\"System.ServiceModel\" switchValue=\"Warning\" propagateActivity=\"true\"&gt;\n    &lt;listeners&gt;\n      &lt;add name=\"xml\" /&gt;\n    &lt;/listeners&gt;\n  &lt;/source&gt;\n  &lt;source name=\"myUserTraceSource\" switchValue=\"Warning, ActivityTracing\"&gt;\n    &lt;listeners&gt;\n      &lt;add name=\"xml\" /&gt;\n    &lt;/listeners&gt;\n  &lt;/source&gt;\n&lt;/sources&gt;\n&lt;sharedListeners&gt;\n  &lt;add name=\"xml\" type=\"System.Diagnostics.XmlWriterTraceListener\" initializeData=\"C:\\logs\\Traces.svclog\" /&gt;\n&lt;/sharedListeners&gt;\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 1215, "user_id": 3205479, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3fe387946a5449c6cff2c78549c8cecc?s=128&d=identicon&r=PG&f=1", "display_name": "user3205479", "link": "https://stackoverflow.com/users/3205479/user3205479"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 45065524, "answer_count": 1, "score": 0, "last_activity_date": 1499886173, "creation_date": 1499884559, "question_id": 45065249, "link": "https://stackoverflow.com/questions/45065249/show-the-list-of-exceptions-that-are-thrown-by-service-method", "title": "Show the list of exceptions that are thrown by service method", "body": "<p>How to check the exceptions that are possibly thrown by a service method? Consider the following program</p>\n\n<pre><code>[ServiceContract]\npublic interface IApple{\n    [FaultContract(typeof(DivideByZeroException))]\n    [OperationContract]\n    int set(bool val);\n}\npublic class Apple : IApple{\n    public int set(bool val)\n    {\n        throw new FaultException&lt;DivideByZeroException&gt;(new DivideByZeroException());\n    }\n}\n\nClient.cs\n----------\nMain(){\n   AppleClient a = new AppleClient();\n   try{\n      // will throw exception\n      a.set();\n   }\n   // How do I know that this method will throw the following exception?\n   catch(FaultException&lt;DivideByZeroException&gt; ex){}\n</code></pre>\n\n<p>Is it possible to know what exceptions can be thrown by a service method, so that we can catch those exceptions? Looking at WSDL file I was able to understand the exceptions thrown by a method but is there any easier way to list the methods and exceptions that can be thrown by a method? Any help is greatly appreciated.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "visual-studio-2015", "visual-studio-2017", "roslyn"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499884632, "post_id": 45065206, "comment_id": 77103745, "body": "There&#39;s probably a process running that has those files locked. Check the Task Manager to see if you can kill them. Also, unless you actually use VB, you can remove the <code>language=&quot;vb...</code> line"}, {"owner": {"reputation": 2953, "user_id": 3769368, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3301727987157807f500ece485c1446d?s=128&d=identicon&r=PG&f=1", "display_name": "Rajmond Burgaj", "link": "https://stackoverflow.com/users/3769368/rajmond-burgaj"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499884700, "post_id": 45065206, "comment_id": 77103787, "body": "@CamiloTerevinto I culd notice a process using VBCSCompiler which I ended as a task but again does not work. I tried to end some other tasks I could think about using those files but no success"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499884886, "post_id": 45065206, "comment_id": 77103883, "body": "What happens if you re-download the NuGet package? (maybe update it?)"}, {"owner": {"reputation": 2953, "user_id": 3769368, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3301727987157807f500ece485c1446d?s=128&d=identicon&r=PG&f=1", "display_name": "Rajmond Burgaj", "link": "https://stackoverflow.com/users/3769368/rajmond-burgaj"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1499884999, "post_id": 45065206, "comment_id": 77103950, "body": "I am not sure for that because I have not tried to re-download them and even if I try it will take some time from next occurrence but I think I will try it as an alternative"}, {"owner": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 3, "creation_date": 1499885965, "post_id": 45065206, "comment_id": 77104492, "body": "Since a recent update of VS 2017, me and my co-workers are getting this issue, too. The pragmatic solution in my case was to simply kill the sitll running process &quot;VBCSCompiler&quot; manually via Task Manager."}, {"owner": {"reputation": 642, "user_id": 3239305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CfpCp.png?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/3239305/ajay"}, "edited": false, "score": 0, "creation_date": 1499950412, "post_id": 45065206, "comment_id": 77134917, "body": "May be this stackoverflow post <a href=\"https://stackoverflow.com/a/32295103/3239305\">stackoverflow.com/a/32295103/3239305</a> will help you"}, {"owner": {"reputation": 2309, "user_id": 292060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9041a387a69294f1207515740af8ad64?s=128&d=identicon&r=PG", "display_name": "goodeye", "link": "https://stackoverflow.com/users/292060/goodeye"}, "edited": false, "score": 0, "creation_date": 1530307936, "post_id": 45065206, "comment_id": 89206368, "body": "See also related <a href=\"https://stackoverflow.com/q/44682281/292060\">stackoverflow.com/q/44682281/292060</a>, especially killing tasks without having to close VS."}], "answers": [{"comments": [{"owner": {"reputation": 6027, "user_id": 375958, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jVReq.jpg?s=128&g=1", "display_name": "Jalal", "link": "https://stackoverflow.com/users/375958/jalal"}, "edited": false, "score": 0, "creation_date": 1521144958, "post_id": 45292947, "comment_id": 85619029, "body": "Just run <code>update-package</code> for <code>Microsoft.CodeDom.Providers.DotNetCompilerPlatform</code> and <code>Microsoft.Net.Compilers</code> in nuget console."}], "tags": [], "owner": {"reputation": 111, "user_id": 8360860, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/70fbbbe57a9f18f3f5039a6aadc56def?s=128&d=identicon&r=PG", "display_name": "tnapster", "link": "https://stackoverflow.com/users/8360860/tnapster"}, "is_accepted": false, "score": 11, "last_activity_date": 1500949901, "creation_date": 1500949901, "answer_id": 45292947, "question_id": 45065206, "link": "https://stackoverflow.com/questions/45065206/can-not-delete-bin-roslyn-vbcscompiler-exe-access-is-denied/45292947#45292947", "title": "Can not delete \\bin\\roslyn\\VBCSCompiler.exe - Access is denied", "body": "<p>In the 'Manage NuGET Packages' window I downgraded Microsoft.Net.Compilers to 2.3.0 (from 2.3.1) and also downgraded Microsoft.CodeDom.Providers.DotNetCompilerPlatform to 1.0.4 (from 1.0.5) and the Roslyn directory/files were no longer marked as readonly and no longer locked by the exe.</p>\n"}, {"comments": [{"owner": {"reputation": 2953, "user_id": 3769368, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3301727987157807f500ece485c1446d?s=128&d=identicon&r=PG&f=1", "display_name": "Rajmond Burgaj", "link": "https://stackoverflow.com/users/3769368/rajmond-burgaj"}, "edited": false, "score": 1, "creation_date": 1504059300, "post_id": 45327611, "comment_id": 78860335, "body": "Sometimes it works and sometimes it doesnt but I will accept this as the best answer since I could not find any better answer than this one. Thanks :)"}, {"owner": {"reputation": 909, "user_id": 1560325, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/bd61773d0998cb6626eddb49ca524bbb?s=128&d=identicon&r=PG", "display_name": "HumbleBeginnings", "link": "https://stackoverflow.com/users/1560325/humblebeginnings"}, "edited": false, "score": 2, "creation_date": 1506536562, "post_id": 45327611, "comment_id": 79864975, "body": "Per the link above on 09.27.2017 there is a fix slated for release in VS2017 V15.2."}, {"owner": {"reputation": 511, "user_id": 2343086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ca66d31bfccd0ac4e6910c999bd5ce6d?s=128&d=identicon&r=PG", "display_name": "abdul qayyum", "link": "https://stackoverflow.com/users/2343086/abdul-qayyum"}, "edited": false, "score": 3, "creation_date": 1567615447, "post_id": 45327611, "comment_id": 102018585, "body": "VS 2019 latest version and still this answer solved my problem"}], "tags": [], "owner": {"reputation": 1383, "user_id": 6920109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/039c57845ad26a7c8ebc1b845a449818?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6920109/alex"}, "is_accepted": true, "score": 121, "last_activity_date": 1501073610, "creation_date": 1501073610, "answer_id": 45327611, "question_id": 45065206, "link": "https://stackoverflow.com/questions/45065206/can-not-delete-bin-roslyn-vbcscompiler-exe-access-is-denied/45327611#45327611", "title": "Can not delete \\bin\\roslyn\\VBCSCompiler.exe - Access is denied", "body": "<p>Same problem here - solution for me was closing VS, open task manager and end all instances of VBCSCompiler.exe as mentionend here: <a href=\"https://developercommunity.visualstudio.com/content/problem/71302/binroslyn-files-locked-during-build.html\" rel=\"noreferrer\">https://developercommunity.visualstudio.com/content/problem/71302/binroslyn-files-locked-during-build.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3560739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ffd912bb2940e735996311987635d2e?s=128&d=identicon&r=PG&f=1", "display_name": "EverLearning", "link": "https://stackoverflow.com/users/3560739/everlearning"}, "is_accepted": false, "score": 0, "last_activity_date": 1502284621, "creation_date": 1502284621, "answer_id": 45591811, "question_id": 45065206, "link": "https://stackoverflow.com/questions/45065206/can-not-delete-bin-roslyn-vbcscompiler-exe-access-is-denied/45591811#45591811", "title": "Can not delete \\bin\\roslyn\\VBCSCompiler.exe - Access is denied", "body": "<p>I have killed the process in task manager and rebuilt the solution which gets me back on track, but I have found that frequently building the entire solution before debugging has stopped it all together. I am currently working on an n-tier application and I was encountering this numerous times a day and I haven't had the issue since I made sure to build the application after any changes and especially before debugging. Though, I don't get why this would work since the VS builds the solution before debugging but it has done the trick for me.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10093752, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ad4c872f112ffa006785d7a3678d42ac?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/10093752/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1531830810, "creation_date": 1531830810, "answer_id": 51381530, "question_id": 45065206, "link": "https://stackoverflow.com/questions/45065206/can-not-delete-bin-roslyn-vbcscompiler-exe-access-is-denied/51381530#51381530", "title": "Can not delete \\bin\\roslyn\\VBCSCompiler.exe - Access is denied", "body": "<p>I accidentally found this in Task Manager: </p>\n\n<blockquote>\n  <p>Windows Explorer > (expand Windows Explorer) > Roslyn\n  Right-click Roslyn and select End Task</p>\n</blockquote>\n\n<p>Note: Even closing all Windows Explorer windows will not stop Roslyn. You must do this in Task Manager.</p>\n"}, {"tags": [], "owner": {"reputation": 468, "user_id": 2275336, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/921ac3e7886086e7eb0cbe09ed4a6218?s=128&d=identicon&r=PG", "display_name": "dawncode", "link": "https://stackoverflow.com/users/2275336/dawncode"}, "is_accepted": false, "score": 0, "last_activity_date": 1535812530, "creation_date": 1535812530, "answer_id": 52129114, "question_id": 45065206, "link": "https://stackoverflow.com/questions/45065206/can-not-delete-bin-roslyn-vbcscompiler-exe-access-is-denied/52129114#52129114", "title": "Can not delete \\bin\\roslyn\\VBCSCompiler.exe - Access is denied", "body": "<p>I killed the visual studio instance from Task manager then it got deleted.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 13152161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gg1WUA5QbfN53fp2wT9bnd2cAjteC5tg1QeuollWg=k-s128", "display_name": "Sanjeev Jyothikrishnan", "link": "https://stackoverflow.com/users/13152161/sanjeev-jyothikrishnan"}, "is_accepted": false, "score": 2, "last_activity_date": 1585564563, "creation_date": 1585564563, "answer_id": 60928683, "question_id": 45065206, "link": "https://stackoverflow.com/questions/45065206/can-not-delete-bin-roslyn-vbcscompiler-exe-access-is-denied/60928683#60928683", "title": "Can not delete \\bin\\roslyn\\VBCSCompiler.exe - Access is denied", "body": "<p>Goto <strong>Taskmanager</strong> --> under process tab ---> find <strong>VBCSCompiler.exe</strong> and <strong>end this task</strong>. then try to delete the folder</p>\n"}], "owner": {"reputation": 2953, "user_id": 3769368, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3301727987157807f500ece485c1446d?s=128&d=identicon&r=PG&f=1", "display_name": "Rajmond Burgaj", "link": "https://stackoverflow.com/users/3769368/rajmond-burgaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23989, "favorite_count": 12, "accepted_answer_id": 45327611, "answer_count": 6, "score": 68, "last_activity_date": 1585564563, "creation_date": 1499884387, "last_edit_date": 1499885487, "question_id": 45065206, "link": "https://stackoverflow.com/questions/45065206/can-not-delete-bin-roslyn-vbcscompiler-exe-access-is-denied", "title": "Can not delete \\bin\\roslyn\\VBCSCompiler.exe - Access is denied", "body": "<p>I am facing a strange issue from roslyn compiler. Sometimes when I build the solution I face a strange issue in error list which does not let me build the solution. Here is the error:</p>\n\n<blockquote>\n  <p>Severity   Code    Description Project File    Line    Suppression State\n  Error       Unable to copy file \"D:\\Sealogical New Website\\SealogicalWebsite\\packages\\Microsoft.Net.Compilers.1.0.0\\tools\\csc.exe\" to \"bin\\roslyn\\csc.exe\". Access to the path 'bin\\roslyn\\csc.exe' is denied.  SealogicalWebsite           </p>\n  \n  <p>Severity   Code    Description Project File    Line    Suppression State\n  Error       Unable to copy file \"D:\\Sealogical New Website\\SealogicalWebsite\\packages\\Microsoft.Net.Compilers.1.0.0\\tools\\VBCSCompiler.exe\" to \"bin\\roslyn\\VBCSCompiler.exe\". Access to the path 'bin\\roslyn\\VBCSCompiler.exe' is denied.   SealogicalWebsite   </p>\n</blockquote>\n\n<ol>\n<li><p>I try to clean the solution and rebuild it but does not work again.</p></li>\n<li><p>Tried to delete files manually but again shows an error pointing out\nI do not have right permissions to do this:</p></li>\n<li><p>Tried deleting from <code>CMD</code> but again shows the same error:</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/XUcwF.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/XUcwF.png\" alt=\"Image when trying to delete files manually\"></a></p>\n\n<p>The only way to delete roslyn generated files is by restarting the PC and when restarted I can delete them manually without a problem.</p>\n\n<p>I am administrator in my PC so there is no problem with that I guess.</p>\n\n<p>This problem seems to happen in Visual Studi0 2015 and Visual Studio 2017.</p>\n\n<p>I dont like restarting the PC 4-5 times a day or more thats why I am asking here.</p>\n\n<p>Some other details:</p>\n\n<ul>\n<li><p>I am the one who created this project so theoretically it should not\nbe a problem to do this action.</p></li>\n<li><p>When the project first created I did run the Visual Studion in\nAdministrator Mode as I am doing now.</p></li>\n<li>I am using ASP.MVC 5 template in my project.</li>\n<li>Files which do not get deleted are <code>bin/roslyn/csc</code> and <code>bin/roslyn/VBCSCompiler</code>.</li>\n</ul>\n\n<p>I could find a solution to remove this part from web.config so it does not generate those files:</p>\n\n<pre><code>&lt;compilers&gt;\n  &lt;compiler language=\"c#;cs;csharp\" extension=\".cs\" type=\"Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" warningLevel=\"4\" compilerOptions=\"/langversion:6 /nowarn:1659;1699;1701\" /&gt;\n  &lt;compiler language=\"vb;vbs;visualbasic;vbscript\" extension=\".vb\" type=\"Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\" warningLevel=\"4\" compilerOptions=\"/langversion:14 /nowarn:41008 /define:_MYTYPE=\\&amp;quot;Web\\&amp;quot; /optionInfer+\" /&gt;\n&lt;/compilers&gt;\n</code></pre>\n\n<p>But this solution would cause problem with new c# 6 features so I can not remove this section.....</p>\n\n<p>Furthermore I tried this command in CMD to see if there is a process locking this file but anyway it did not show me any process at all:</p>\n\n<pre><code>C:\\WINDOWS\\system32&gt;tasklist /m D:\\SealogicalNewWebsite\\SealogicalWebsite\\SealogicalWebsite\\bin\\roslyn\\csc.exe\nINFO: No tasks are running which match the specified criteria.\n</code></pre>\n\n<p>Does anybody knows a way how to handle this strange issue ?</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "linq", "csv"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1499884651, "post_id": 45065148, "comment_id": 77103757, "body": "<code>StreamWriter.ToString()</code> doesn&#39;t return to you the contents of the stream."}, {"owner": {"reputation": 11, "user_id": 8196038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/K4cIn.jpg?s=128&g=1", "display_name": "Lynxx", "link": "https://stackoverflow.com/users/8196038/lynxx"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1499885095, "post_id": 45065148, "comment_id": 77104007, "body": "ok, is there a difference in StreamWriter and StringWriter? Also, how does one get the contents to the file? these were the only examples I came across, and it did work once."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1499885122, "post_id": 45065148, "comment_id": 77104024, "body": "Yes there&#39;s a difference.  Read the documentation on each."}], "answers": [{"tags": [], "owner": {"reputation": 180, "user_id": 7888031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89cb7c4dbda6afe637b66ab0505be552?s=128&d=identicon&r=PG&f=1", "display_name": "Mukesh Chudasama", "link": "https://stackoverflow.com/users/7888031/mukesh-chudasama"}, "is_accepted": false, "score": 0, "last_activity_date": 1500023437, "creation_date": 1500023437, "answer_id": 45099054, "question_id": 45065148, "link": "https://stackoverflow.com/questions/45065148/blank-csv-file-with-linq-asp-net-mvc/45099054#45099054", "title": "Blank csv file with Linq/ASP.Net/MVC", "body": "<p>Better to use optimized class for export like one \n<a href=\"https://github.com/jitbit/CsvExport\" rel=\"nofollow noreferrer\">https://github.com/jitbit/CsvExport</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8196038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/K4cIn.jpg?s=128&g=1", "display_name": "Lynxx", "link": "https://stackoverflow.com/users/8196038/lynxx"}, "is_accepted": false, "score": 0, "last_activity_date": 1500061677, "creation_date": 1500061677, "answer_id": 45110593, "question_id": 45065148, "link": "https://stackoverflow.com/questions/45065148/blank-csv-file-with-linq-asp-net-mvc/45110593#45110593", "title": "Blank csv file with Linq/ASP.Net/MVC", "body": "<p>Yeah i probably should have used something like that @Mukesh Chudasama. \nThis is what I ended up with after messing around and reading some docs. Works great. </p>\n\n<pre><code>        public void ExportToCsv()\n    {\n\n        DateTime newDate = DateTime.Now.AddMonths(-6);\n\n        MemoryStream ms = new MemoryStream();\n        TextWriter tw = new StreamWriter(ms);\n\n        tw.WriteLine(\"Name,SS#,Application Date,Company,Job Code,Job Applied For,2nd Choice,3rd Choice,EEO Job Group,Gender,EEO Applicant,Veteran Status,Interview Date Personnel,Interview Date Manager,Reference Date,Physical Date,Disposition,Comments,Job Fair Location\");\n\n        var q = _db.applicants.Where(n =&gt; n.date_applied &gt; newDate &amp;&amp; n != null).ToList();\n\n        foreach (var item in q)\n        {\n\n           string itemString = string.Format(\"{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14},{15},{16},{17},{18}\",\n\n                            item.last_name + \"_\" + item.first_name,\n                            item.idnumber,\n                            String.Format(\"{0:MM/dd/yyyy}\", item.date_applied),\n                            item.referral,\n                            \"\",\n                            item.job_applied,\n                            \"Any\",\n                            \"Any\",\n                            \"job Group Test\",\n                            item.gender,\n                            item.race,\n                            item.veteran_status,\n                            item.interview_date,\n                            item.interview_manager,\n                            item.reference_date,\n                            item.physical_date,\n                            item.disposition,\n                            item.comments,\n                            item.job_fair_location\n                            );\n\n            tw.WriteLine(itemString);\n\n        }\n\n\n        tw.Flush();\n        byte[] bytes = ms.ToArray();\n        ms.Close();\n\n        Response.Clear();\n        Response.ContentType = \"text/csv\";\n        Response.AddHeader(\"content-disposition\", \"attachment;filename=AAInfo.csv\");\n        Response.BinaryWrite(bytes);\n        Response.End();\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8196038, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/K4cIn.jpg?s=128&g=1", "display_name": "Lynxx", "link": "https://stackoverflow.com/users/8196038/lynxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500061677, "creation_date": 1499884216, "last_edit_date": 1499973829, "question_id": 45065148, "link": "https://stackoverflow.com/questions/45065148/blank-csv-file-with-linq-asp-net-mvc", "title": "Blank csv file with Linq/ASP.Net/MVC", "body": "<p>Afternoon, all!</p>\n\n<p>Having a bit of a problem getting my StringWriter to produce a CSV with data in it. I made some changes and added several of the entries from the database per the client. I got the file to create once before I made these changes. There is information in the database to grab. This is probably just my lack of understanding of the StringWriter and how it works. </p>\n\n<pre><code>    public void ExportToCsv()\n    {\n\n        DateTime newDate = DateTime.Now.AddMonths(-6);\n\n        StringWriter sw = new StringWriter();\n\n        sw.WriteLine(\"Name,SS#,Application Date,Company,Job Code,Job Applied For,2nd Choice,3rd Choice,EEO Job Group,Gender,EEO Applicant,Veteran Status,Interview Date Personnel,Interview Date Manager,Reference Date,Physical Date,Disposition,Comments,Job Fair Location\");\n\n        Response.ClearContent();\n        Response.AddHeader(\"content-disposition\", \"attachment;filename=ExportedAAInfo.csv\");\n        Response.ContentType = \"text/csv\";\n\n        var q = _db.applicants.Where(n =&gt; n.date_applied &gt; newDate &amp;&amp; n != null);\n\n        foreach (var item in q)\n        {\n\n            string jobGroup = \"Test Job\";\n\n            sw.WriteLine(string.Format(\"{0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14},{15},{16},{17},{18}\",\n\n                            item.last_name + \",\" + item.first_name,\n                            item.idnumber,\n                            String.Format(\"{0:MM/dd/yyyy}\", item.date_applied),\n                            item.referral,\n                            \"\",\n                            item.job_applied,\n                            \"Any\",\n                            \"Any\",\n                            jobGroup,\n                            item.gender,\n                            item.race,\n                            item.veteran_status,\n                            item.interview_date,\n                            item.interview_manager,\n                            item.reference_date,\n                            item.physical_date,\n                            item.disposition,\n                            item.comments,\n                            item.job_fair_location\n                            ));\n        }\n\n        Response.Write(sw.ToString());\n        Response.Flush();\n        Response.Close();\n    }\n</code></pre>\n\n<p>I am properly getting the file download, just nothing in it. Not even the manual WriteLine with the column headers in it. Any points you can see to point me in the right direction would be greatly appreciated!</p>\n\n<p>EDIT:</p>\n\n<p>I have simply narrowed everything down to just trying to print a string into the Response. I am using this little method.</p>\n\n<pre><code>        public void ExportToCsv()\n    {\n\n        string sw = \"Hello, World!\";\n        Response.Clear();\n        Response.ContentType = \"text/plain\";\n        Response.AddHeader(\"content-disposition\", \"attachment;filename=ExportedAAInfo.txt\");\n        Response.Write(sw.ToString());\n        Response.End();\n\n    }\n</code></pre>\n\n<p>Ignore the name of the method, its just testing at this point. I am still getting the file download, just nothing printed in the file. </p>\n\n<p>I am wondering if there is a certain way in which you must call the method for the response to pick it up? \nAt the moment i am just using</p>\n\n<pre><code>@Html.Action(\"ExportToCsv\")\n</code></pre>\n\n<p>as the href on my button to download. Are there any server settings or anything that I need to look into to keep this from happening? Kinda at a loss as I cant get this simplified method to work either. </p>\n"}, {"tags": ["c#", "c++", "windows", "filesystemwatcher", "wdk"], "comments": [{"owner": {"reputation": 8856, "user_id": 4442671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-nSzcZygTwLs/AAAAAAAAAAI/AAAAAAAAADA/virGKG3deIo/photo.jpg?sz=128", "display_name": "Frank", "link": "https://stackoverflow.com/users/4442671/frank"}, "edited": false, "score": 0, "creation_date": 1499885130, "post_id": 45065028, "comment_id": 77104028, "body": "I guess you could use dll injection, and monitor calls to <code>fclose()</code>. But if it&#39;s your own process, what&#39;s preventing you from outputing file completions events to stdout?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1499885184, "post_id": 45065028, "comment_id": 77104059, "body": "I know of no way to do this in the win32 API. Sysinternals has a few neat tools that let you snoop who has what handles are open, so it&#39;s possible  to poll whether the the file handle is still open. The thing is I think you&#39;ll have to dive into the barely documented space below win32 to do it. But if the file has been opened with exclusive access you could poll the file, periodically trying to open it. If the other process still has the file locked, it won&#39;t open."}], "answers": [{"tags": [], "owner": {"reputation": 658, "user_id": 8089332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df1a20c63e0888ffcb2569928c15e97e?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/8089332/vlad"}, "is_accepted": false, "score": 0, "last_activity_date": 1529472169, "last_edit_date": 1529472169, "creation_date": 1499927153, "answer_id": 45072892, "question_id": 45065028, "link": "https://stackoverflow.com/questions/45065028/howto-monitoring-file-access-by-another-process-in-windows/45072892#45072892", "title": "HOWTO: Monitoring file access by another process in Windows?", "body": "<p>What you might be interested in is sys internals procmon tool. Among other functionality it monitors file access giving you a lot of details.\nUnfortunately sources are not available but here's <a href=\"https://forum.sysinternals.com/topic8038_page1.html\" rel=\"nofollow noreferrer\">a thread about previous version</a> (filemon) started by somebody with an issue similar to yours.</p>\n\n<p>Also you may want to look into <a href=\"http://yaprocmon.sourceforge.net/\" rel=\"nofollow noreferrer\">open source alternative</a>, it may have the code you are looking for.</p>\n\n<p>Alternatively you can <a href=\"https://blogs.msdn.microsoft.com/carloc/2008/10/31/how-to-automate-process-monitor/\" rel=\"nofollow noreferrer\">use ProcMon as a monitor tool</a> and parse its output. Using built in filter functionality you'll be able to limit your log file entries to specific folder and type/data of file access event.</p>\n\n<hr>\n\n<p>[<strong>Update</strong>]</p>\n\n<p>Recently I had a chance to revisit this issue for one of my projects, what I found is that call </p>\n\n<pre><code>File.Open(filePath, FileMode.Open, FileAccess.Read, FileShare.None)\n</code></pre>\n\n<p>will throw IOException if file is still used by another process. </p>\n\n<p>So what you can do is after you get Created notification from FileSystemWatcher call File.Open every couple of seconds, once you stop getting exception you know that another process is done with the file.</p>\n"}], "owner": {"reputation": 1125, "user_id": 442806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2947e508ad7300f7005464056458762d?s=128&d=identicon&r=PG", "display_name": "Sam Carleton", "link": "https://stackoverflow.com/users/442806/sam-carleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 817, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1529472169, "creation_date": 1499883794, "last_edit_date": 1499893203, "question_id": 45065028, "link": "https://stackoverflow.com/questions/45065028/howto-monitoring-file-access-by-another-process-in-windows", "title": "HOWTO: Monitoring file access by another process in Windows?", "body": "<p>I am working on a program that processes image files.  The problem I am running into is some of the images are very large and I don't know when the copy process is done.  Right now the code is written in C# and is using the FileSystemWatcher class to monitor the files.  The only problem is there is no event for when another process is DONE with the file.  </p>\n\n<p>The current logic is to watch for created and changed events and than wait 5 seconds in hopes that by that point in time the copy process is done.  While this works on my development machine, unfortunately customers report issues with the whole process. </p>\n\n<p>Years ago when I wrote this code I did see that at a lower level, I think it was part of the DDK SDK or something, it is possible to find out a lot more information about how another program is accessing a file.</p>\n\n<p>Can anyone speak into this and point me in the right direction?  I do expect it to be C++ code, not C# code.</p>\n\n<hr>\n\n<p>To answer some questions below: </p>\n\n<p>The issue is that OTHER processes are copy images into directories that my program is monitoring.  Once the images are fully copied my program needs to start processing the images as soon as possible.  The issue is that many images, at times hundreds of images, will be copied at one time. Since each image needs to be processed as fast as possible, the system needs to know as soon as possible that the image is fully copied and can be processed.</p>\n\n<p>I am fully aware there is NO way to do what I want to do via the WinSDK, but I am 99.9% sure it IS possible via the WinDDK, maybe I have the name wrong, I Googled that and got \"Windows Driver Kit (WDK)\".  I am pretty sure the way SysInternals pulls off all their cool tricks is by using WDK level functions.</p>\n"}]