[{"tags": ["c#", "selenium", "internet-explorer", "tfs"], "answers": [{"comments": [{"owner": {"reputation": 289, "user_id": 2668680, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/97936b4bcff6da549373b7dfc7f16b33?s=128&d=identicon&r=PG", "display_name": "5earch", "link": "https://stackoverflow.com/users/2668680/5earch"}, "edited": false, "score": 0, "creation_date": 1521122978, "post_id": 49293886, "comment_id": 85605063, "body": "Hi, thanks for your answer. I of course saw the error message, but that doesn&#39;t explain to me why it would behave differently on two machines with the exact same setup. Both Windows 10 with IE11 (exact same version). It works on my local machine but not on the build machine. I give the delay a try but that just seems a little messy to me. But I&#39;m also new to selenium so maybe that&#39;s just how it&#39;s done then. Thanks, I&#39;ll let you know the outcome."}, {"owner": {"reputation": 289, "user_id": 2668680, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/97936b4bcff6da549373b7dfc7f16b33?s=128&d=identicon&r=PG", "display_name": "5earch", "link": "https://stackoverflow.com/users/2668680/5earch"}, "edited": false, "score": 0, "creation_date": 1521124231, "post_id": 49293886, "comment_id": 85606025, "body": "I have edited my initial post. The behavior just seems completely different. As soon as the browser instance is fired up it seems to lose focus."}, {"owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "reply_to_user": {"reputation": 289, "user_id": 2668680, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/97936b4bcff6da549373b7dfc7f16b33?s=128&d=identicon&r=PG", "display_name": "5earch", "link": "https://stackoverflow.com/users/2668680/5earch"}, "edited": false, "score": 0, "creation_date": 1521124456, "post_id": 49293886, "comment_id": 85606161, "body": "Of-coarse there seems to be something else wrong happening in your script as per the log <code>OpenQA.Selenium.WebDriverTimeoutException: Timed out after 30 seconds ---&gt; OpenQA.Selenium.NoSuchWindowException: Currently focused window has been closed.</code> which you need to debug next."}, {"owner": {"reputation": 289, "user_id": 2668680, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/97936b4bcff6da549373b7dfc7f16b33?s=128&d=identicon&r=PG", "display_name": "5earch", "link": "https://stackoverflow.com/users/2668680/5earch"}, "edited": false, "score": 0, "creation_date": 1521125056, "post_id": 49293886, "comment_id": 85606629, "body": "Thank you, I do understand how stackoverflow works. However your answer did not solve my problem. The test still does not run through, now I&#39;m just getting a different exception which the cause for it is probably in both cases the same. The browser window opens and then loses focus why it can&#39;t find the input field. What I&#39;m trying to solve is WHY that happens, and that&#39;s probably related to the agent running the test."}, {"owner": {"reputation": 24666, "user_id": 7466674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d846790948d5cc43593fc778116f40d?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Li-MSFT", "link": "https://stackoverflow.com/users/7466674/andy-li-msft"}, "reply_to_user": {"reputation": 289, "user_id": 2668680, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/97936b4bcff6da549373b7dfc7f16b33?s=128&d=identicon&r=PG", "display_name": "5earch", "link": "https://stackoverflow.com/users/2668680/5earch"}, "edited": false, "score": 0, "creation_date": 1521451326, "post_id": 49293886, "comment_id": 85718889, "body": "@5earch Just try to create a new WebDriverWait, refer to this thread for details: <a href=\"https://stackoverflow.com/questions/47102759/openqa-selenium-webdrivertimeoutexception-timed-out-after-40-seconds\" title=\"openqa selenium webdrivertimeoutexception timed out after 40 seconds\">stackoverflow.com/questions/47102759/&hellip;</a>"}], "tags": [], "owner": {"reputation": 116545, "user_id": 7429447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5a25589e600c8ae89717c14e51a6754b?s=128&d=identicon&r=PG&f=1", "display_name": "DebanjanB", "link": "https://stackoverflow.com/users/7429447/debanjanb"}, "is_accepted": false, "score": 0, "last_activity_date": 1521099565, "creation_date": 1521099565, "answer_id": 49293886, "question_id": 49289383, "link": "https://stackoverflow.com/questions/49289383/selenium-test-fails-to-run-with-ie11-on-build-machine-running-tfs-2018-build-age/49293886#49293886", "title": "Selenium test fails to run with IE11 on build machine running TFS 2018 build agent", "body": "<p>The error says it all :</p>\n\n<pre><code>2018-03-14T20:53:54.8474473Z  Test method Web.Tests.MySeleniumTests.TheBingSearchTest threw exception: \n2018-03-14T20:53:54.8474473Z OpenQA.Selenium.NoSuchElementException: Unable to find element with css selector == #sb_form_q\n</code></pre>\n\n<p>It is clear from the error stack trace that the <em>driver</em> is unable to locate the element identified as :</p>\n\n<pre><code>driver.FindElement(By.Id(\"sb_form_q\"))\n</code></pre>\n\n<p>As you mentioned, <em>test runs on your local machine with IE, Chrome and Firefox. Chrome and Firefox also work on the build machine, just IE  can't get to work</em> may happen as different <em>Web Browsers</em> renders the <em>HTML DOM</em> differently.</p>\n\n<h2>Solution</h2>\n\n<p>A solution would be to induce <a href=\"https://seleniumhq.github.io/selenium/docs/api/dotnet/html/T_OpenQA_Selenium_Support_UI_WebDriverWait.htm\" rel=\"nofollow noreferrer\">WebDriverWait</a> with <a href=\"https://seleniumhq.github.io/selenium/docs/api/dotnet/html/T_OpenQA_Selenium_Support_UI_ExpectedConditions.htm\" rel=\"nofollow noreferrer\">ExpectedConditions</a> clause <a href=\"https://seleniumhq.github.io/selenium/docs/api/dotnet/html/M_OpenQA_Selenium_Support_UI_ExpectedConditions_ElementToBeClickable.htm\" rel=\"nofollow noreferrer\">ElementToBeClickable</a> as follows :</p>\n\n<pre><code>wait = new WebDriverWait(driver, TimeSpan.FromSeconds(30));\nwait.Until(ExpectedConditions.ElementToBeClickable(By.Id(\"sb_form_q\"))).SendKeys(\"VSTS\");\n</code></pre>\n"}], "owner": {"reputation": 289, "user_id": 2668680, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/97936b4bcff6da549373b7dfc7f16b33?s=128&d=identicon&r=PG", "display_name": "5earch", "link": "https://stackoverflow.com/users/2668680/5earch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 635, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521124122, "creation_date": 1521071255, "last_edit_date": 1521124122, "question_id": 49289383, "link": "https://stackoverflow.com/questions/49289383/selenium-test-fails-to-run-with-ie11-on-build-machine-running-tfs-2018-build-age", "title": "Selenium test fails to run with IE11 on build machine running TFS 2018 build agent", "body": "<p>I've been trying for a while now to get selenium tests working with IE 11 on our build machine. Our build machine runs Windows 10 with IE11 and we use TFS 2018. The build agent is configured to run interactively with auto-logon. My test runs on my local machine with IE, Chrome and Firefox. Chrome and Firefox also work on the build machine, just IE I can't get to work. I've added the registry entries and checked all other settings according to the following documentation:</p>\n\n<p><a href=\"https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver\" rel=\"nofollow noreferrer\">https://github.com/SeleniumHQ/selenium/wiki/InternetExplorerDriver</a></p>\n\n<p>The test I'm running is just a basic sample.</p>\n\n<pre><code>[TestClass]\npublic class MySeleniumTests\n{\n    private TestContext testContextInstance;\n    private IWebDriver driver;\n    private string appURL;\n\n    public MySeleniumTests()\n    {\n    }\n\n    [TestMethod]\n    [TestCategory(\"Chrome\")]\n    public void TheBingSearchTest()\n    {\n        driver.Navigate().GoToUrl(appURL);\n        driver.FindElement(By.Id(\"sb_form_q\")).SendKeys(\"VSTS\");\n        driver.FindElement(By.Id(\"sb_form_go\")).Click();\n        driver.FindElement(By.XPath(\"(//ol[@id='b_results']/li/h2/a/strong)[3]\")).Click();\n        Assert.IsTrue(driver.Title.Contains(\"VSTS\"), \"Verified title of the page\");\n    }\n\n    /// &lt;summary&gt;\n    ///Gets or sets the test context which provides\n    ///information about and functionality for the current test run.\n    ///&lt;/summary&gt;\n    public TestContext TestContext\n    {\n        get\n        {\n            return testContextInstance;\n        }\n        set\n        {\n            testContextInstance = value;\n        }\n    }\n\n    [TestInitialize()]\n    public void SetupTest()\n    {\n        appURL = \"http://www.bing.com/\";\n\n        string browser = TestContext.Properties[\"browser\"].ToString();\n        switch (browser)\n        {\n            case \"Chrome\":\n                driver = new ChromeDriver();\n                break;\n            case \"Firefox\":\n                driver = new FirefoxDriver();\n                break;\n            case \"IE\":\n                driver = new InternetExplorerDriver();\n                break;\n            default:\n                driver = new ChromeDriver();\n                break;\n        }\n\n    }\n\n    [TestCleanup()]\n    public void MyTestCleanup()\n    {\n        driver.Quit();\n    }\n}\n</code></pre>\n\n<p>The browser instance starts every time with the correct website but then fails to continue with the following error:</p>\n\n<pre><code>2018-03-14T20:53:53.1180620Z Started InternetExplorerDriver server (32-bit)\n2018-03-14T20:53:53.1180620Z 3.11.0.0\n2018-03-14T20:53:53.1180620Z Listening on port 53215\n2018-03-14T20:53:53.1180620Z Only local connections are allowed\n2018-03-14T20:53:54.8474473Z Failed   TheBingSearchTest\n2018-03-14T20:53:54.8474473Z Error Message:\n2018-03-14T20:53:54.8474473Z  Test method Web.Tests.MySeleniumTests.TheBingSearchTest threw exception: \n2018-03-14T20:53:54.8474473Z OpenQA.Selenium.NoSuchElementException: Unable to find element with css selector == #sb_form_q\n2018-03-14T20:53:54.8474473Z Stack Trace:\n2018-03-14T20:53:54.8474473Z     at OpenQA.Selenium.Remote.RemoteWebDriver.UnpackAndThrowOnError(Response errorResponse)\n2018-03-14T20:53:54.8474473Z    at OpenQA.Selenium.Remote.RemoteWebDriver.Execute(String driverCommandToExecute, Dictionary`2 parameters)\n2018-03-14T20:53:54.8474473Z    at OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(String mechanism, String value)\n2018-03-14T20:53:54.8474473Z    at OpenQA.Selenium.Remote.RemoteWebDriver.FindElementById(String id)\n2018-03-14T20:53:54.8474473Z    at OpenQA.Selenium.By.&lt;&gt;c__DisplayClass16_0.&lt;Id&gt;b__0(ISearchContext context)\n2018-03-14T20:53:54.8474473Z    at OpenQA.Selenium.By.FindElement(ISearchContext context)\n2018-03-14T20:53:54.8474473Z    at OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(By by)\n2018-03-14T20:53:54.8474473Z    at Web.Tests.MySeleniumTests.TheBingSearchTest() in E:\\BuildAgents\\BuildAgent1\\_work\\16\\s\\Web.Tests\\SeleniumBingTest.cs:line 29\n2018-03-14T20:53:54.8474473Z\n</code></pre>\n\n<p>I've been checking everything multiple times now and been also trying different things but I'm not making any progress. Has anyone else been having similar issues?</p>\n\n<p>--- edit 03/15 ---</p>\n\n<p>After adding the delay as suggested by DebanjanB I'm getting now the following exception. It says the window was closed but it is actually still open. The behavior is so weird. I believe I'm missing some infrastructure config, something related to the TFS test agent running the test, but I can't figure out what it could be.</p>\n\n<pre><code>2018-03-15T14:20:21.5983187Z Starting test execution, please wait...\n2018-03-15T14:20:22.5350340Z Started InternetExplorerDriver server (32-bit)\n2018-03-15T14:20:22.5350340Z 3.9.0.0\n2018-03-15T14:20:22.5350340Z Listening on port 63267\n2018-03-15T14:20:22.5350340Z Only local connections are allowed\n2018-03-15T14:20:23.2691823Z Skipped  LoginFirstTimeTest\n2018-03-15T14:20:54.6453061Z Failed   TheBingSearchTest\n2018-03-15T14:20:54.6453061Z Error Message:\n2018-03-15T14:20:54.6453061Z  Test method Web.Tests.MySeleniumTests.TheBingSearchTest threw exception: \n2018-03-15T14:20:54.6453061Z OpenQA.Selenium.WebDriverTimeoutException: Timed out after 30 seconds ---&gt; OpenQA.Selenium.NoSuchWindowException: Currently focused window has been closed.\n2018-03-15T14:20:54.6453061Z Stack Trace:\n2018-03-15T14:20:54.6453061Z     at OpenQA.Selenium.Remote.RemoteWebDriver.UnpackAndThrowOnError(Response errorResponse)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.Remote.RemoteWebDriver.Execute(String driverCommandToExecute, Dictionary`2 parameters)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(String mechanism, String value)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.Remote.RemoteWebDriver.FindElementById(String id)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.By.&lt;&gt;c__DisplayClass16_0.&lt;Id&gt;b__0(ISearchContext context)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.By.FindElement(ISearchContext context)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.Remote.RemoteWebDriver.FindElement(By by)\n2018-03-15T14:20:54.6453061Z    at SeleniumExtras.WaitHelpers.ExpectedConditions.&lt;&gt;c__DisplayClass19_0.&lt;ElementToBeClickable&gt;b__0(IWebDriver driver)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.Support.UI.DefaultWait`1.Until[TResult](Func`2 condition)\n2018-03-15T14:20:54.6453061Z --- End of inner exception stack trace ---\n2018-03-15T14:20:54.6453061Z     at OpenQA.Selenium.Support.UI.DefaultWait`1.ThrowTimeoutException(String exceptionMessage, Exception lastException)\n2018-03-15T14:20:54.6453061Z    at OpenQA.Selenium.Support.UI.DefaultWait`1.Until[TResult](Func`2 condition)\n2018-03-15T14:20:54.6453061Z    at Web.Tests.MySeleniumTests.TheBingSearchTest() in E:\\BuildAgents\\BuildAgent1\\_work\\16\\s\\Web.Tests\\SeleniumBingTest.cs:line 31\n2018-03-15T14:20:54.6453061Z \n</code></pre>\n"}, {"tags": ["c#", "model-view-controller", "asp.net-core", "entity-framework-core"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 8191697, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a75518d494db4c1e40a2955464609172?s=128&d=identicon&r=PG&f=1", "display_name": "WhatAmIDoing", "link": "https://stackoverflow.com/users/8191697/whatamidoing"}, "edited": false, "score": 0, "creation_date": 1521072596, "post_id": 49289511, "comment_id": 85582308, "body": "PrepareData function inside InitializeTest class invokes it, this was the best solution I could come up with to populate the database. Sadly this also means that I have to invoke the function every time the controller is used."}, {"owner": {"reputation": 677, "user_id": 3927981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1IK7F.jpg?s=128&g=1", "display_name": "Oleksandr Nahirniak", "link": "https://stackoverflow.com/users/3927981/oleksandr-nahirniak"}, "reply_to_user": {"reputation": 91, "user_id": 8191697, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a75518d494db4c1e40a2955464609172?s=128&d=identicon&r=PG&f=1", "display_name": "WhatAmIDoing", "link": "https://stackoverflow.com/users/8191697/whatamidoing"}, "edited": false, "score": 0, "creation_date": 1521073425, "post_id": 49289511, "comment_id": 85582495, "body": "@WhatAmIDoing 1. You should use this extension in Startup class, in ConfigureServices method 2. You should populate database on startup, not on LoginConfirmed action execution, because each execution is adding duplicated data 3. Inject TempDb via constructor, because you have 2 instances of TempDb and I am not sure that both of them work with InMemoryDb"}, {"owner": {"reputation": 91, "user_id": 8191697, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a75518d494db4c1e40a2955464609172?s=128&d=identicon&r=PG&f=1", "display_name": "WhatAmIDoing", "link": "https://stackoverflow.com/users/8191697/whatamidoing"}, "edited": false, "score": 0, "creation_date": 1521073647, "post_id": 49289511, "comment_id": 85582543, "body": "So I move the prepare data function to the constructor of TempDB class?"}, {"owner": {"reputation": 677, "user_id": 3927981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1IK7F.jpg?s=128&g=1", "display_name": "Oleksandr Nahirniak", "link": "https://stackoverflow.com/users/3927981/oleksandr-nahirniak"}, "reply_to_user": {"reputation": 91, "user_id": 8191697, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a75518d494db4c1e40a2955464609172?s=128&d=identicon&r=PG&f=1", "display_name": "WhatAmIDoing", "link": "https://stackoverflow.com/users/8191697/whatamidoing"}, "edited": false, "score": 0, "creation_date": 1521074071, "post_id": 49289511, "comment_id": 85582648, "body": "You should move prepare data functionality to the point of start your application, you should seed data (seed test data) only once, for more details look up here <a href=\"https://garywoodfine.com/how-to-seed-your-ef-core-database/\" rel=\"nofollow noreferrer\">garywoodfine.com/how-to-seed-your-ef-core-database</a>"}, {"owner": {"reputation": 677, "user_id": 3927981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1IK7F.jpg?s=128&g=1", "display_name": "Oleksandr Nahirniak", "link": "https://stackoverflow.com/users/3927981/oleksandr-nahirniak"}, "reply_to_user": {"reputation": 91, "user_id": 8191697, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a75518d494db4c1e40a2955464609172?s=128&d=identicon&r=PG&f=1", "display_name": "WhatAmIDoing", "link": "https://stackoverflow.com/users/8191697/whatamidoing"}, "edited": false, "score": 0, "creation_date": 1521074361, "post_id": 49289511, "comment_id": 85582718, "body": "@WhatAmIDoing Or more easier way here: <a href=\"https://forums.asp.net/t/2122687.aspx?How+to+Seed+Data+in+Core+\" rel=\"nofollow noreferrer\">forums.asp.net/t/2122687.aspx?How+to+Seed+Data+in+Core+</a>"}], "tags": [], "owner": {"reputation": 677, "user_id": 3927981, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1IK7F.jpg?s=128&g=1", "display_name": "Oleksandr Nahirniak", "link": "https://stackoverflow.com/users/3927981/oleksandr-nahirniak"}, "is_accepted": false, "score": 0, "last_activity_date": 1521072152, "creation_date": 1521072152, "answer_id": 49289511, "question_id": 49289371, "link": "https://stackoverflow.com/questions/49289371/inmemory-rows-getting-duplicated-while-adding-them-to-viewmodel-lists/49289511#49289511", "title": "InMemory rows getting duplicated while adding them to ViewModel Lists", "body": "<p>Are you sure that you use InMemory database? </p>\n\n<p>I don't see usage of InMemory extension. </p>\n\n<p>You should use extension in ConfigureServices, like</p>\n\n<pre><code>services.AddDbContext&lt;YourContext&gt;(options =&gt; options.UseInMemoryDatabase(\"SimpleDbName\"));\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 8191697, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a75518d494db4c1e40a2955464609172?s=128&d=identicon&r=PG&f=1", "display_name": "WhatAmIDoing", "link": "https://stackoverflow.com/users/8191697/whatamidoing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521072152, "creation_date": 1521071161, "question_id": 49289371, "link": "https://stackoverflow.com/questions/49289371/inmemory-rows-getting-duplicated-while-adding-them-to-viewmodel-lists", "title": "InMemory rows getting duplicated while adding them to ViewModel Lists", "body": "<p>I'm having issues with my context class that inherited Dbcontext. When I'm trying to pass objects from the Dbset to a List in a ViewModel, those objects are for some reason getting duplicated inside the Dbset inside the context class. Here's some of the code:</p>\n\n<p><strong>FIRST ACTION</strong></p>\n\n<pre><code>public ActionResult LoginConfirmed(int id)\n        {\n            UserHomeVM Model = new UserHomeVM();\n            data = new TempDB();\n            InitializeTestData a = new InitializeTestData();\n            data = a.PrepareData(data);\n            Model.Blogs = new List&lt;Blogs&gt;();\n            Model.Users = new List&lt;Users&gt;();\n            Model.Users = data.Users\n                .Where(b =&gt; b.Id != id)\n                .ToList();\n            foreach (Blogs b in data.Blogs)\n            {\n                if (b.UserID != id)\n                {\n                    Model.Blogs.Add(b);\n                }\n            }\n            return View(\"Home\", Model);\n        }\n</code></pre>\n\n<p><strong>TempDB class</strong></p>\n\n<pre><code>using Microsoft.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore.Infrastructure;\nusing System;\nusing infinitymesh_test.DAL.Models;\n\nnamespace infinitymesh_test.DAL.Models\n{\n    public class TempDB : DbContext\n    {\n        public TempDB()\n        { }\n\n        public TempDB(DbContextOptions&lt;TempDB&gt; options)\n            : base(options)\n        { }\n\n        public DbSet&lt;Blogs&gt; Blogs { get; set; }\n        public DbSet&lt;Users&gt; Users { get; set; }\n\n        protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n        {\n            if (!optionsBuilder.IsConfigured)\n            {\n                optionsBuilder.UseSqlServer(@\"Server=(localdb)\\mssqllocaldb;Database=EFProviders.InMemory;Trusted_Connection=True;ConnectRetryCount=0\");\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><strong>initialize test data class</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Data;\nusing Microsoft.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore.Infrastructure;\nusing System.Data.Common;\n\nnamespace infinitymesh_test.DAL.Models\n{\n    public class InitializeTestData\n    {\n        public TempDB PrepareData(TempDB model)\n        {\n\n                  var options = new DbContextOptionsBuilder&lt;TempDB&gt;()\n              .UseInMemoryDatabase(databaseName: \"Add_writes_to_database\")\n                 .Options;\n                model = new TempDB(options);\n                var service = new BlogService(model);\n                Users a;\n                a = new Users(\"Tim Johnson\", 19, \"tim@domain.com\", \"tim567\", \"12345\");\n                service.AddUser(a);\n\n                DateTime q = new DateTime(2018, 1, 12, 18, 15, 33);\n                Blogs M = new Blogs(\"Title1\", \"Summary123\", \"Content1234\", q, 1);\n                service.AddBlogs(M);\n            return model;\n        }\n\n\n\n    }\n}\n</code></pre>\n\n<p>There's plenty of more Users and Blogs I've added manually, removed those to save you the trouble of scrolling.</p>\n\n<p><strong>ViewModel</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing infinitymesh_test.DAL.Models;\n\nnamespace infinitymesh_test.DAL.ViewModels\n    {\n    public class UserHomeVM\n        {\n            public Users User;\n            public List&lt;Users&gt; Users;\n            public List&lt;Blogs&gt; Blogs;\n\n        }\n    }\n</code></pre>\n\n<p>Basically, when the LoginConfirmed action gets going, after PrepareData function is ran, data has 14 users. After I do the toList() method below to insert all users who don't have that Id into the ViewModel's, the data's users get duplicated, and those duplicates get added to the viewmodel at the same time.\nI'm really unfamiliar with InMemory and I'm not allowed to use a real database, so any suggestions would be very welcome.</p>\n\n<p>EDIT: here's the service class as well</p>\n\n<p><strong>SERVICE CLASS</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing infinitymesh_test.DAL.Models;\n\nnamespace infinitymesh_test.DAL.Models\n{\n    public class BlogService\n    {\n        private TempDB _context;\n\n        public BlogService(TempDB context)\n        {\n            _context = context;\n        }\n\n        public void AddBlogs(string Title, string Summary, string Content, DateTime PublishedDateTime, int UserID)\n        {\n            Blogs newBlog = new Blogs();\n            newBlog.Title = Title;\n            newBlog.Summary = Summary;\n            newBlog.Content = Content;\n            newBlog.PublishedDateTime = PublishedDateTime;\n            newBlog.UserID = UserID;\n            _context.Blogs.Add(newBlog);\n            _context.SaveChanges();\n        }\n\n        public void AddBlogs(Blogs b)\n        {\n            _context.Blogs.Add(b);\n            _context.SaveChanges();\n        }\n\n        public List&lt;Blogs&gt; FindBlogs(int userId)\n        {\n            return _context.Blogs\n                .Where(b =&gt; b.UserID == userId)\n                .OrderBy(b =&gt; b.PublishedDateTime)\n                .ToList();\n        }\n\n        public void AddUser(Users u)\n        {\n            _context.Add(u);\n            _context.SaveChanges();\n        }\n\n        public void AddUser(string Name, int Age, string Username, string Email, string Password)\n        {\n            Users newUser = new Users();\n            newUser.Name = Name;\n            newUser.Age = Age;\n            newUser.Email = Email;\n            newUser.Password = Password;\n            newUser.Username = Username;\n            _context.Add(newUser);\n            _context.SaveChanges();\n        }\n\n        public Users FindUser(int userId)\n        {\n            return _context.Users\n                .Where(b =&gt; b.Id != userId)\n                .FirstOrDefault();\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "unity3d", "uwp", "hololens"], "comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1521088858, "post_id": 49289306, "comment_id": 85586057, "body": "Is there a problem with your code?"}, {"owner": {"reputation": 1, "user_id": 1784288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bec0a2cef0bc37545abadefdf61f233?s=128&d=identicon&r=PG", "display_name": "justinterviewedbrother", "link": "https://stackoverflow.com/users/1784288/justinterviewedbrother"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1521132086, "post_id": 49289306, "comment_id": 85611800, "body": "I keep getting a &#39;Exception thrown: &#39;System.ArgumentException&#39; in System.Net.Http.dll&#39; - even when I comment out the response block it crashes, so it seems that the problem is coming from await client.getAsync(link)"}], "answers": [{"comments": [{"owner": {"reputation": 783, "user_id": 1596457, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d0b1231423a939055e26e57a23dc5ec?s=128&d=identicon&r=PG", "display_name": "sGambolati", "link": "https://stackoverflow.com/users/1596457/sgambolati"}, "reply_to_user": {"reputation": 1, "user_id": 1784288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bec0a2cef0bc37545abadefdf61f233?s=128&d=identicon&r=PG", "display_name": "justinterviewedbrother", "link": "https://stackoverflow.com/users/1784288/justinterviewedbrother"}, "edited": false, "score": 0, "creation_date": 1522260107, "post_id": 49363367, "comment_id": 86089841, "body": "Sorry, I think that you made it in Unity because you added that tag."}], "tags": [], "owner": {"reputation": 783, "user_id": 1596457, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d0b1231423a939055e26e57a23dc5ec?s=128&d=identicon&r=PG", "display_name": "sGambolati", "link": "https://stackoverflow.com/users/1596457/sgambolati"}, "is_accepted": false, "score": 1, "last_activity_date": 1521463621, "creation_date": 1521463621, "answer_id": 49363367, "question_id": 49289306, "link": "https://stackoverflow.com/questions/49289306/how-to-save-uri-to-file/49363367#49363367", "title": "How to save URI to file", "body": "<p>In Unity, you don't have access to HttpClient. You can change to use the <a href=\"https://docs.unity3d.com/ScriptReference/WWW.html\" rel=\"nofollow noreferrer\">WWW</a> class.\nRemember to check the <code>Internet Client</code> Capability.</p>\n"}], "owner": {"reputation": 1, "user_id": 1784288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bec0a2cef0bc37545abadefdf61f233?s=128&d=identicon&r=PG", "display_name": "justinterviewedbrother", "link": "https://stackoverflow.com/users/1784288/justinterviewedbrother"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521463621, "creation_date": 1521070722, "question_id": 49289306, "link": "https://stackoverflow.com/questions/49289306/how-to-save-uri-to-file", "title": "How to save URI to file", "body": "<p>I am trying to stream MRC video from the Hololens to my PC; there is a <a href=\"https://github.com/Microsoft/MixedRealityCompanionKit/blob/master/MixedRemoteViewCompositor/Samples/LowLatencyMRC/UWP/Viewer/Playback.xaml.cs\" rel=\"nofollow noreferrer\">repo that does this</a>, but plays the URI to a Media Player, and I'm trying to get it saved to a file. How can I do this? I've already tried using  HttpClient, but the app seems to crash when I send a request to the URI. In the link that I attached, there is a StartPlayback() method that sets the source property of the Media Player to the URI, and it seems to work fine. I tried to modify it in the below way:</p>\n\n<pre><code>private async void StartPlayback()\n    {\n        Uri link = new Uri(string.Format(\"mrvc://{0}:{1}\", this.txAddress.Text, this.txPort.Text));\n        this.videoPlayer.Source = link;\n        using (var client = new HttpClient())\n        using (var response = await client.GetAsync(link))\n        {\n            // make sure our request was successful\n            response.EnsureSuccessStatusCode();\n\n            // read the filename from the Content-Disposition header\n            var filename = response.Content.Headers.ContentDisposition.FileName;\n\n            // read the downloaded file data\n            var stream = await response.Content.ReadAsStreamAsync();\n\n            // Where you want the file to be saved\n            var destinationFile = Path.Combine(\"C:\\\\Users\\\\orsteam\\\\Documents\", filename);\n\n            // write the steam content into a file\n            using (var fileStream = File.Create(destinationFile))\n            {\n                stream.CopyTo(fileStream);\n            }\n        }\n        this.bnStart.IsEnabled = false;\n        this.bnStop.IsEnabled = true;\n    }\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", "visual-studio", "visual-studio-2017", "visual-studio-extensions"], "comments": [{"owner": {"reputation": 5606, "user_id": 6601554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d8e70907365c8fce9135ffe1e5868f?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Zhai-MSFT", "link": "https://stackoverflow.com/users/6601554/jack-zhai-msft"}, "edited": false, "score": 0, "creation_date": 1521530377, "post_id": 49289276, "comment_id": 85757313, "body": "Any update about this issue? angry somoan."}], "answers": [{"tags": [], "owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "is_accepted": true, "score": 1, "last_activity_date": 1521240211, "last_edit_date": 1521240211, "creation_date": 1521072585, "answer_id": 49289574, "question_id": 49289276, "link": "https://stackoverflow.com/questions/49289276/is-it-possible-to-let-visual-studio-extension-access-the-objects-of-opened-solut/49289574#49289574", "title": "Is it possible to let visual studio extension access the objects of opened solution?", "body": "<blockquote>\n  <p>Is it possible for extension to access/get the objects of that solution/project?</p>\n</blockquote>\n\n<p>Yes!  You have a few choices.</p>\n\n<h2>1. Managed Package Framework</h2>\n\n<p>The name is misleading but this originally Microsoft Codeplex project (now <a href=\"https://www.nuget.org/packages/Microsoft.VisualStudio.Project.10.0/1.0.0-alpha005\" rel=\"nofollow noreferrer\">available on NuGet</a>) allows you to create something as simple as a:</p>\n\n<ul>\n<li>menu items; toolbar buttons; windows and panes </li>\n</ul>\n\n<p>...or something mind-blowingly sophisticated as:</p>\n\n<ul>\n<li>something akin to ReSharper or</li>\n<li>even creating your own language</li>\n</ul>\n\n<p>Documentation is terrible.  Your best bet is to look at the Microsoft source code for the Python MPF example.</p>\n\n<p>MPF will let you iterate everything the VS solution in a nice object hierarchy in <strong>realtime</strong> as you type or stare at your code.</p>\n\n<h2>2. T4 Templates</h2>\n\n<p>You don't even need to leave your current code.  T4 templates inside a VS project can interrogate items in your solution <strong>at compile time</strong> only.  </p>\n\n<p>T4 templates resemble Razor syntax in the way code snippets is interleaved with template content.  In fact T4 is used in ASP.NET MVC Razor without peeps knowing.  You could be up and running with T4 syntax way before MPF due to the latter's steep learning curve.</p>\n\n<p>The unfortunate thing though is that T4 is geared up to perform code generation so that's kinda a downer if all you want to do is enumerate items.</p>\n"}], "owner": {"reputation": 461, "user_id": 6466848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/641805695972642/picture?type=large", "display_name": "angry somoan", "link": "https://stackoverflow.com/users/6466848/angry-somoan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49289574, "answer_count": 1, "score": 1, "last_activity_date": 1521240211, "creation_date": 1521070536, "last_edit_date": 1521072437, "question_id": 49289276, "link": "https://stackoverflow.com/questions/49289276/is-it-possible-to-let-visual-studio-extension-access-the-objects-of-opened-solut", "title": "Is it possible to let visual studio extension access the objects of opened solution?", "body": "<p>I want to make an extension, which will iterate through WPF or Windows Forms Controls (or any object) of actually opened project. Is it possible for extension to access/get the objects of that solution/project?</p>\n"}, {"tags": ["c#", "android", "sharedpreferences"], "comments": [{"owner": {"reputation": 1390, "user_id": 5008350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a4e1be55c07c7fa36359fd5cebca882?s=128&d=identicon&r=PG&f=1", "display_name": "I am a Student", "link": "https://stackoverflow.com/users/5008350/i-am-a-student"}, "edited": false, "score": 0, "creation_date": 1521076204, "post_id": 49289119, "comment_id": 85583164, "body": "sharedpreferences will be Store Permanently and its data inside it will not be changed Unless you have specifically Change it.  So i assume everytime you open you apps you will read the sharedpreference data to load the login details,   - make sure you clear/destroy your sharepreference whenever you close apps or log out.  - make sure you change the sharepreference data whenever you login with a new login account."}, {"owner": {"reputation": 1390, "user_id": 5008350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a4e1be55c07c7fa36359fd5cebca882?s=128&d=identicon&r=PG&f=1", "display_name": "I am a Student", "link": "https://stackoverflow.com/users/5008350/i-am-a-student"}, "edited": false, "score": 0, "creation_date": 1521077286, "post_id": 49289119, "comment_id": 85583392, "body": "another tips for you to debugging is, use Toast to display the sharepreference data, to check if the Data in the Preference store the value that you expecting."}, {"owner": {"reputation": 23, "user_id": 9485336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bdf277db207eb9d49646b7677e81a?s=128&d=identicon&r=PG&f=1", "display_name": "A. Mulhall", "link": "https://stackoverflow.com/users/9485336/a-mulhall"}, "reply_to_user": {"reputation": 1390, "user_id": 5008350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a4e1be55c07c7fa36359fd5cebca882?s=128&d=identicon&r=PG&f=1", "display_name": "I am a Student", "link": "https://stackoverflow.com/users/5008350/i-am-a-student"}, "edited": false, "score": 0, "creation_date": 1521080255, "post_id": 49289119, "comment_id": 85584106, "body": "On my mainprofile page, I have a logout button where I have editor.clear, is that not how you wipe sharedpreferences?"}, {"owner": {"reputation": 1390, "user_id": 5008350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a4e1be55c07c7fa36359fd5cebca882?s=128&d=identicon&r=PG&f=1", "display_name": "I am a Student", "link": "https://stackoverflow.com/users/5008350/i-am-a-student"}, "edited": false, "score": 0, "creation_date": 1521080926, "post_id": 49289119, "comment_id": 85584275, "body": "Are you using Android Studio and Code in Android Java?"}, {"owner": {"reputation": 1390, "user_id": 5008350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a4e1be55c07c7fa36359fd5cebca882?s=128&d=identicon&r=PG&f=1", "display_name": "I am a Student", "link": "https://stackoverflow.com/users/5008350/i-am-a-student"}, "edited": false, "score": 0, "creation_date": 1521081052, "post_id": 49289119, "comment_id": 85584293, "body": "I think what you doing is correct, I develop in Android Java, the Syntax is use is in small case, clear() / commit() instead of Clear() / Commit(). You can also try use Apply() instead of Commit()."}, {"owner": {"reputation": 23, "user_id": 9485336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bdf277db207eb9d49646b7677e81a?s=128&d=identicon&r=PG&f=1", "display_name": "A. Mulhall", "link": "https://stackoverflow.com/users/9485336/a-mulhall"}, "reply_to_user": {"reputation": 1390, "user_id": 5008350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1a4e1be55c07c7fa36359fd5cebca882?s=128&d=identicon&r=PG&f=1", "display_name": "I am a Student", "link": "https://stackoverflow.com/users/5008350/i-am-a-student"}, "edited": false, "score": 0, "creation_date": 1521102143, "post_id": 49289119, "comment_id": 85591090, "body": "I&#39;m using visual studio C#"}], "owner": {"reputation": 23, "user_id": 9485336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0bdf277db207eb9d49646b7677e81a?s=128&d=identicon&r=PG&f=1", "display_name": "A. Mulhall", "link": "https://stackoverflow.com/users/9485336/a-mulhall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521123571, "creation_date": 1521069533, "last_edit_date": 1521123571, "question_id": 49289119, "link": "https://stackoverflow.com/questions/49289119/whatever-user-i-login-with-details-are-always-the-same", "title": "Whatever user I login with, details are always the same", "body": "<p>Edit 1: Basically sharedpreferences aren't being cleared.</p>\n\n<p>In my app, no matter what account I login with, it'll always show the details of the first account that signed up in my database.</p>\n\n<p>E.g. I created an account called \"Joe\" and filled in the details, every other account that signs in, the details are the same as \"Joe\" but in the database the details are different.</p>\n\n<p>I'm making this in C# Xamarin with an azure database.</p>\n\n<p>I think it's something to do with sharedpreferences but I can't see the problem as I'm only new to it.</p>\n\n<p>Here's the login and main profile where I most likely made the error:</p>\n\n<p>Login:</p>\n\n<pre><code>    static ISharedPreferences pref = Application.Context.GetSharedPreferences(\"UserInfo\", FileCreationMode.Private);\n    ISharedPreferencesEditor edit = pref.Edit();\n\n    protected override void OnCreate(Bundle savedInstanceState)\n    {\n        // Set our view from the \"sign in\" layout resource\n        base.OnCreate(savedInstanceState);\n        SetContentView(Resource.Layout.Dialog_Sign_In);\n        EditText username = (EditText)FindViewById(Resource.Id.txtUsername);\n        EditText password = (EditText)FindViewById(Resource.Id.txtPassword);\n        username.Text = pref.GetString(\"UserName\", \"\");\n        password.Text = pref.GetString(\"Password\", \"\");\n        var login = FindViewById(Resource.Id.btnDialogSignin);\n        login.Click += TryLoginAsync;\n    }\n\n    private async void TryLoginAsync(object sender, EventArgs e)\n    {\n        EditText txtUsername = (EditText)FindViewById(Resource.Id.txtUsername);\n        EditText txtPassword = (EditText)FindViewById(Resource.Id.txtPassword);\n        string user = txtUsername.Text.Trim();\n        string zPassword = txtPassword.Text;\n\n        if (!await DBHelper.DoesUserExist(user))\n        {\n            Toast.MakeText(this, \"Invalid Login\", ToastLength.Short).Show();\n        }\n        else\n        {\n            users u = await DBHelper.GetUser(user);\n            if (PasswordStorage.VerifyPassword(zPassword, u.password))\n            {\n                ISharedPreferences pref = GetSharedPreferences(\"Login\", FileCreationMode.Private);\n                ISharedPreferencesEditor edit = pref.Edit();\n                edit.Clear();\n                edit.PutString(\"Username\", u.username);\n                edit.PutString(\"Password\", u.password);\n                edit.PutString(\"UserID\", u.ID);\n                edit.PutString(\"UserName\", u.username);\n                edit.PutString(\"LoggedIn\", \"true\");\n                edit.PutString(\"Password\", u.password);\n                edit.Commit();\n                Toast.MakeText(ApplicationContext, \"Success\", ToastLength.Short).Show();\n                if (await DBHelper.IsUserProfileCreated(u.ID))\n                {\n                    //go to main menu\n                    Toast.MakeText(this, \"Logged In and user made\", ToastLength.Short).Show();\n                    StartActivity(typeof(SetUpProfile));\n                }\n                else\n                {\n                    Toast.MakeText(this, \"Welcome to your Profile\", ToastLength.Short).Show();\n                    StartActivity(typeof(MainProfile));\n                }\n            }\n            else\n            {\n                Toast.MakeText(this, \"Invalid Login\", ToastLength.Short).Show();\n            }\n        }\n    }\n</code></pre>\n\n<p>MainProfile:</p>\n\n<pre><code>    public static MobileServiceClient Client =\n    new MobileServiceClient(\"https://appname.azurewebsites.net\");\n\n    protected async override void OnCreate(Bundle savedInstanceState)\n    {\n        base.OnCreate(savedInstanceState);\n        SetContentView(Resource.Layout.Main_Profile);\n        ISharedPreferences pref = Application.Context.GetSharedPreferences(\"UserInfo\", FileCreationMode.Private);\n\n        String maUsername = pref.GetString(\"Username\", null);\n        String maPassword = pref.GetString(\"Password\", null);\n        var logout = FindViewById(Resource.Id.btnLogout);\n\n        CurrentPlatform.Init();\n        List&lt;UserProf&gt; ls = await Client.GetTable&lt;UserProf&gt;().ToListAsync();\n        UserProf mProf = ls.Where(x =&gt; x.Username == maPassword).FirstOrDefault();\n        //UserProf prof = await Client.GetTable&lt;UserProf&gt;().Where(u =&gt; u.Username == username ).ToListAsync();\n        TextView textName = (TextView)FindViewById(Resource.Id.textName);\n        textName.Text = mProf.Firstname;\n        TextView textProfession = (TextView)FindViewById(Resource.Id.textProfession);\n        textProfession.Text = mProf.Profession;\n        logout.Click += LogoutProcess;\n        //Toast.MakeText(this, \"Hello \" + mProf.Firstname + \" or \" + username, ToastLength.Short).Show();\n    }\n\n    private void LogoutProcess(object sender, EventArgs e)\n    {\n        ISharedPreferences prefs = Application.Context.GetSharedPreferences(\"Login\", FileCreationMode.Private);\n        ISharedPreferencesEditor editor = prefs.Edit();\n        editor.Clear();\n        editor.Commit();\n        Toast.MakeText(this, \"Logged Out\", ToastLength.Short).Show();\n        StartActivity(typeof(MainActivity));\n    }\n}\n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["c#", "asp.net", ".net", "asp.net-mvc-4", "ftp-server"], "comments": [{"owner": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 0, "creation_date": 1521068840, "post_id": 49289013, "comment_id": 85581191, "body": "You will have to issue  the <code>LS</code> or <code>DIR</code> command to get a listing of the files. Capture that output and increment a counter."}, {"owner": {"reputation": 157, "user_id": 3990480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d8b198cdd210ee8c13cd5add3c5d7c8?s=128&d=identicon&r=PG&f=1", "display_name": "ZMAX", "link": "https://stackoverflow.com/users/3990480/zmax"}, "reply_to_user": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 0, "creation_date": 1521069034, "post_id": 49289013, "comment_id": 85581257, "body": "@Squashman thanks for reply . I want C# code to count files into ftp folder"}, {"owner": {"reputation": 1331, "user_id": 2461203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KWGj5.gif?s=128&g=1", "display_name": "ragerory", "link": "https://stackoverflow.com/users/2461203/ragerory"}, "edited": false, "score": 0, "creation_date": 1521069073, "post_id": 49289013, "comment_id": 85581268, "body": "<a href=\"https://stackoverflow.com/questions/3298922/how-to-list-directory-contents-with-ftp-in-c\" title=\"how to list directory contents with ftp in c\">stackoverflow.com/questions/3298922/&hellip;</a>"}, {"owner": {"reputation": 1331, "user_id": 2461203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KWGj5.gif?s=128&g=1", "display_name": "ragerory", "link": "https://stackoverflow.com/users/2461203/ragerory"}, "edited": false, "score": 2, "creation_date": 1521069152, "post_id": 49289013, "comment_id": 85581293, "body": "Would be helpful to provide code you tried, rather than just asking for code. This is a fairly simple problem that has been solved many times and there are examples all over the web."}, {"owner": {"reputation": 1331, "user_id": 2461203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KWGj5.gif?s=128&g=1", "display_name": "ragerory", "link": "https://stackoverflow.com/users/2461203/ragerory"}, "edited": false, "score": 1, "creation_date": 1521069508, "post_id": 49289013, "comment_id": 85581406, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3298922/how-to-list-directory-contents-with-ftp-in-c\">How to List Directory Contents with FTP in C#?</a>"}, {"owner": {"reputation": 157, "user_id": 3990480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d8b198cdd210ee8c13cd5add3c5d7c8?s=128&d=identicon&r=PG&f=1", "display_name": "ZMAX", "link": "https://stackoverflow.com/users/3990480/zmax"}, "edited": false, "score": 0, "creation_date": 1521070170, "post_id": 49289013, "comment_id": 85581608, "body": "my question is not same as how to list directory contents. there are some xml files into a ftp directory. I want to count the files i.e how many files are present into that directory . i searched stackoverflow and didnt find solution that&#39;s why i&#39;m asking"}, {"owner": {"reputation": 1331, "user_id": 2461203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KWGj5.gif?s=128&g=1", "display_name": "ragerory", "link": "https://stackoverflow.com/users/2461203/ragerory"}, "edited": false, "score": 0, "creation_date": 1521070295, "post_id": 49289013, "comment_id": 85581648, "body": "@SudiptaSaha if you&#39;re looking for the count of files, you can get that directly from the list of the Directory&#39;s contents. What part are you missing? You&#39;re also not telling us where your error is or what you&#39;re seeing. You just posted some code and said it doesn&#39;t work. Be specific. We&#39;re here to help, not do your work for you."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1521070935, "post_id": 49289013, "comment_id": 85581825, "body": "The results from ftp directory is a string with &#39;\\n&#39; at end of each line.  So you can put results into a StringReader() and then read one line at a time to process results.  StringReader files = new StringReader(response.text)"}, {"owner": {"reputation": 1331, "user_id": 2461203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KWGj5.gif?s=128&g=1", "display_name": "ragerory", "link": "https://stackoverflow.com/users/2461203/ragerory"}, "edited": false, "score": 0, "creation_date": 1521120239, "post_id": 49289013, "comment_id": 85602896, "body": "@SudiptaSaha What do you mean by &quot;it doesn&#39;t work&quot;? What error are you receiving? What are the contents of those variables? What does the contents of your directory look like?"}], "owner": {"reputation": 157, "user_id": 3990480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d8b198cdd210ee8c13cd5add3c5d7c8?s=128&d=identicon&r=PG&f=1", "display_name": "ZMAX", "link": "https://stackoverflow.com/users/3990480/zmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 651, "favorite_count": 3, "answer_count": 0, "score": 2, "last_activity_date": 1521069903, "creation_date": 1521068688, "last_edit_date": 1521069903, "question_id": 49289013, "link": "https://stackoverflow.com/questions/49289013/how-to-count-files-in-a-folder-in-ftp-server-using-c", "title": "how to count files in a folder in ftp server using C#", "body": "<p>I have folder name XYZ into ftp server [<a href=\"ftp://ftp00.abcd.net]\" rel=\"nofollow noreferrer\">ftp://ftp00.abcd.net]</a> . I have some xml files into XYZ folder like Lggggg.XML .I want to download multiple files with same name like Lgggg.XML. Now I can download only file that's why I want to know count of files [Lgggg.XML] then I will run download file code within for loop. I want to count those xml files which exists into <a href=\"ftp://ftp00.abcd.net/XYZ\" rel=\"nofollow noreferrer\">ftp://ftp00.abcd.net/XYZ</a> . I searched through net but I didn't find proper solution . Any information regarding this will be helpful . Please help .</p>\n\n<p><strong>EDIT</strong>\nMy C# code</p>\n\n<pre><code>      FtpWebRequest ftpwebrequest = (FtpWebRequest)WebRequest.Create(\"ftp://ftp00.abcd.net/XYZ\"); \n      ftpwebrequest.Credentials = new NetworkCredential(\"username\", \"pwd\");\n      ftpwebrequest.Method = WebRequestMethods.Ftp.ListDirectory;\n      FtpWebResponse response = (FtpWebResponse)ftpwebrequest.GetResponse();\n\n      Console.WriteLine(\"user looged in\");\n\n      Stream responseStream = response.GetResponseStream();\n      StreamReader reader = new StreamReader(responseStream);\n      Console.WriteLine(reader.ReadToEnd());\n\n      Console.WriteLine(\"Directory List Complete, status {0}\", response.StatusDescription);\n      var list = Directory.GetFiles(\"vit-gent-maid\", \"*.XML\");  \n     int count = list.Length;\n\n     Console.WriteLine(\"count :\" + count);\n     using (WebClient ftpClient = new WebClient())\n     {\n        ftpClient.Credentials = new System.Net.NetworkCredential(\"username\", \"pwd\");\n        ftpClient.DownloadFile(\"ftp://ftp00.abcd.net/XYZ/Lggggg.XML\", @\"C:\\\\Temp\\XML\\Lggggg.XML\");\n        Console.WriteLine(\"file transfer successful\");\n     }\n        Console.ReadLine();\n\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine(ex.ToString());\n            Console.ReadLine();\n\n        }\n</code></pre>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 2213, "user_id": 304326, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/89e7f6dfa7ee2ed59af1a1ee2c6dfd1f?s=128&d=identicon&r=PG", "display_name": "Dave M", "link": "https://stackoverflow.com/users/304326/dave-m"}, "edited": false, "score": 0, "creation_date": 1521070413, "post_id": 49289012, "comment_id": 85581678, "body": "If you have Windows 10 TH2 or later you can just use standard ANSI escape codes: <a href=\"https://stackoverflow.com/questions/4842424/list-of-ansi-color-escape-sequences\" title=\"list of ansi color escape sequences\">stackoverflow.com/questions/4842424/&hellip;</a>"}, {"owner": {"reputation": 2213, "user_id": 304326, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/89e7f6dfa7ee2ed59af1a1ee2c6dfd1f?s=128&d=identicon&r=PG", "display_name": "Dave M", "link": "https://stackoverflow.com/users/304326/dave-m"}, "edited": false, "score": 0, "creation_date": 1521070576, "post_id": 49289012, "comment_id": 85581725, "body": "Actually reading your question more carefully, not sure if that will work for popup colors"}, {"owner": {"reputation": 16278, "user_id": 397817, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nnDMu.jpg?s=128&g=1", "display_name": "Stephen Kennedy", "link": "https://stackoverflow.com/users/397817/stephen-kennedy"}, "edited": false, "score": 0, "creation_date": 1521071423, "post_id": 49289012, "comment_id": 85581961, "body": "Possible undocumented Win API <a href=\"http://www.catch22.net/sites/default/source/files/setconsoleinfo.c\" rel=\"nofollow noreferrer\">catch22.net/sites/default/source/files/setconsoleinfo.c</a>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521073434, "post_id": 49289012, "comment_id": 85582498, "body": "Google &quot;c# setconsolescreenbufferinfoex&quot; for hits.  <a href=\"https://stackoverflow.com/a/3219873/17034\">This is one of them</a>."}, {"owner": {"reputation": 40308, "user_id": 7122, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/31fdbe39c7657652fb5f34cdef2c78c9?s=128&d=identicon&r=PG", "display_name": "David Arno", "link": "https://stackoverflow.com/users/7122/david-arno"}, "edited": false, "score": 0, "creation_date": 1521126040, "post_id": 49289012, "comment_id": 85607447, "body": "Thanks for your feedback, all. It had indeed been staring me in the face re <code>SetConsoleScreenBufferInfoEx()</code> and I&#39;d completely missed it."}], "owner": {"reputation": 40308, "user_id": 7122, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/31fdbe39c7657652fb5f34cdef2c78c9?s=128&d=identicon&r=PG", "display_name": "David Arno", "link": "https://stackoverflow.com/users/7122/david-arno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521068668, "creation_date": 1521068668, "question_id": 49289012, "link": "https://stackoverflow.com/questions/49289012/how-to-programmatically-change-the-popup-colors-for-the-current-instance-of-a-wi", "title": "How to programmatically change the popup colors for the current instance of a windows console?", "body": "<p>In .NET, I can use the <code>Console</code> class to change the color index (effectively 0-15) for the foreground and background colors of the console via <code>Console.BackGroundColor</code> and <code>Console.ForegroundColor</code> respectively. Both of these properties then use the Win32 <code>SetConsoleTextAttribute</code> function to affect the change.</p>\n\n<p>I can also use the <code>ScreenColors</code> and <code>PopupColors</code> keys in the registry, beneath <code>HKEY_CURRENT_USER\\Console</code> to change the background and foreground indexes for both the normal and popup foreground and background colors for the default console properties.</p>\n\n<p>What I can't find is any means of changing the popup color indexes for the current console, either in the <code>Console</code> .NET class, nor in the Win32 console APIs.</p>\n\n<p>Does such an API exist, and if so, which one is it?</p>\n"}, {"tags": ["c#", "sql", "sql-server"], "comments": [{"owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "edited": false, "score": 0, "creation_date": 1521068754, "post_id": 49288972, "comment_id": 85581167, "body": "If it returns multiple rows, which one would you want doing the update?  That&#39;s a business logic question, and there&#39;s not enough information in this question for someone to answer it."}, {"owner": {"reputation": 1, "user_id": 9494261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXJMOm9ccfY/AAAAAAAAAAI/AAAAAAAAAiU/dzhzejrauMM/photo.jpg?sz=128", "display_name": "Mahamane Sani Ibrahim  ", "link": "https://stackoverflow.com/users/9494261/mahamane-sani-ibrahim"}, "reply_to_user": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "edited": false, "score": 0, "creation_date": 1521069411, "post_id": 49288972, "comment_id": 85581370, "body": "Thanks, let&#39;s say that every row return by the subquery should be updated using the formula  *lq.AMOUNT = lq.AMOUNT + ( st.QUANTITY % @num) * @rompu *"}], "answers": [{"tags": [], "owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "is_accepted": false, "score": 0, "last_activity_date": 1521070076, "creation_date": 1521070076, "answer_id": 49289190, "question_id": 49288972, "link": "https://stackoverflow.com/questions/49288972/how-to-update-a-table-using-a-subquery-that-returns-multiple-rows-in-sql-server/49289190#49289190", "title": "How to update a table using a subquery that returns multiple rows in SQL Server?", "body": "<p>So the primary key on your lq table can be pk.  Then the SQL for updating lq.AMOUNT with this logic is:</p>\n\n<pre><code>UPDATE\n    lq \nSET\n    lq.AMOUNT = sq.newvalue\nFROM\n    (\n    SELECT \n        lq.AMOUNT + ( st.QUANTITY % @num) * @rompu AS newvalue,\n        lq.pk\n    FROM\n        LIQUIDITYACCOUNT lq\n    INNER JOIN\n        STOCKACCOUNT st \n    ON\n        lq.CLIENT_ID = st.CLIENT_ID\n    AND\n        st.TITRE_ID = @id_titre\n    AND\n        st.QUANTITY &gt; 0\n    ) AS sq\nWHERE\n    lq.pk = sq.pk\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "reply_to_user": {"reputation": 1, "user_id": 9494261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXJMOm9ccfY/AAAAAAAAAAI/AAAAAAAAAiU/dzhzejrauMM/photo.jpg?sz=128", "display_name": "Mahamane Sani Ibrahim  ", "link": "https://stackoverflow.com/users/9494261/mahamane-sani-ibrahim"}, "edited": false, "score": 0, "creation_date": 1521119449, "post_id": 49289688, "comment_id": 85602314, "body": "@MahamaneSaniIbrahim I am sorry but not working does not give my much to go on."}, {"owner": {"reputation": 1, "user_id": 9494261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXJMOm9ccfY/AAAAAAAAAAI/AAAAAAAAAiU/dzhzejrauMM/photo.jpg?sz=128", "display_name": "Mahamane Sani Ibrahim  ", "link": "https://stackoverflow.com/users/9494261/mahamane-sani-ibrahim"}, "edited": false, "score": 0, "creation_date": 1521142206, "post_id": 49289688, "comment_id": 85617557, "body": "Is it possible to perform it using &#39;while&#39;  loop  ?"}, {"owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "reply_to_user": {"reputation": 1, "user_id": 9494261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXJMOm9ccfY/AAAAAAAAAAI/AAAAAAAAAiU/dzhzejrauMM/photo.jpg?sz=128", "display_name": "Mahamane Sani Ibrahim  ", "link": "https://stackoverflow.com/users/9494261/mahamane-sani-ibrahim"}, "edited": false, "score": 0, "creation_date": 1521142588, "post_id": 49289688, "comment_id": 85617745, "body": "@MahamaneSaniIbrahim Not buying my update is throwing that error.  Good luck."}], "tags": [], "owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "is_accepted": false, "score": 1, "last_activity_date": 1521119421, "last_edit_date": 1521119421, "creation_date": 1521073330, "answer_id": 49289688, "question_id": 49288972, "link": "https://stackoverflow.com/questions/49288972/how-to-update-a-table-using-a-subquery-that-returns-multiple-rows-in-sql-server/49289688#49289688", "title": "How to update a table using a subquery that returns multiple rows in SQL Server?", "body": "<p>Purpose of the update seems odd but here it is    </p>\n\n<pre><code>update lq \n   set lq.AMOUNT = lq.AMOUNT + stt.qty * @rompu  \n  from LIQUIDITYACCOUNT lq\n  join ( select st.CLIENT_ID, sum(st.QUANTITY % @num) as qty\n           from STOCKACCOUNT st \n          where st.TITRE_ID = @id_titre \n            and st.QUANTITY &gt; 0 \n           group \n              by st.CLIENT_ID \n       ) stt\n     on stt.CLIENT_ID = lq.CLIENT_ID\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9494261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXJMOm9ccfY/AAAAAAAAAAI/AAAAAAAAAiU/dzhzejrauMM/photo.jpg?sz=128", "display_name": "Mahamane Sani Ibrahim  ", "link": "https://stackoverflow.com/users/9494261/mahamane-sani-ibrahim"}, "is_accepted": false, "score": 0, "last_activity_date": 1521148682, "creation_date": 1521148682, "answer_id": 49309395, "question_id": 49288972, "link": "https://stackoverflow.com/questions/49288972/how-to-update-a-table-using-a-subquery-that-returns-multiple-rows-in-sql-server/49309395#49309395", "title": "How to update a table using a subquery that returns multiple rows in SQL Server?", "body": "<p><a href=\"https://stackoverflow.com/users/3097559/tysonwright\">@tysonwright</a>, <a href=\"https://stackoverflow.com/users/607314/paparazzo\">@paparazzo</a> and <a href=\"https://stackoverflow.com/users/159145/dai\">@Dai</a> thank you so much indeed. I have found a solution using <code>cursor</code> and <code>while</code> loop. Below is the code.</p>\n\n<pre><code>declare @id_client as varchar(50)\ndeclare @amount as money\n\ndeclare liq_cursor cursor for\n\nSELECT \n    lq.AMOUNT + ( st.QUANTITY % @num) * @rompu AS newvalue,\n    lq.CLIENT_ID\nFROM\n    LIQUIDITYACCOUNT lq\nINNER JOIN\n    STOCKACCOUNT st \nON\n    lq.CLIENT_ID = st.CLIENT_ID\nAND\n    st.TITRE_ID = @id_titre\nAND\n    st.QUANTITY &gt; 0\n\n\n\nOPEN liq_cursor\n    FETCH NEXT  FROM liq_cursor  into @amount,@id_client\n ---\n\n WHILE @@FETCH_STATUS=0\n BEGIN\n        update LIQUIDITYACCOUNT set AMOUNT=@amount,\n                                    DATEMODIF=GETDATE()\n        where CLIENT_ID=@id_client\n        FETCH NEXT  FROM liq_cursor  into @amount,@id_client\n END\n\n close liq_cursor\n deallocate liq_cursor\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9494261, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DXJMOm9ccfY/AAAAAAAAAAI/AAAAAAAAAiU/dzhzejrauMM/photo.jpg?sz=128", "display_name": "Mahamane Sani Ibrahim  ", "link": "https://stackoverflow.com/users/9494261/mahamane-sani-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1521148682, "creation_date": 1521068413, "last_edit_date": 1521068569, "question_id": 49288972, "link": "https://stackoverflow.com/questions/49288972/how-to-update-a-table-using-a-subquery-that-returns-multiple-rows-in-sql-server", "title": "How to update a table using a subquery that returns multiple rows in SQL Server?", "body": "<p>I'm trying to update the Table <code>LIQUIDITYACCOUNT</code> using the field <code>QUANTITY</code> which belongs to the table <code>STOCKACCOUNT</code>. Both tables have foreign key CLIENT_ID.   </p>\n\n<pre><code>update\n    lq \nset\n    lq.AMOUNT = lq.AMOUNT + ( st.QUANTITY % @num) * @rompu \nfrom\n    LIQUIDITYACCOUNT lq\n    inner join STOCKACCOUNT st on\n        lq.CLIENT_ID = st.CLIENT_ID\n        and\n        st.TITRE_ID = @id_titre\n        and\n        st.QUANTITY &gt; 0\n</code></pre>\n\n<p>The table <code>STOCKACCOUNT</code> contains informations about <code>STOCKS</code> hold by a customer while the table <code>LIQUIDITYACCOUNT</code> contains information about cash money.\nIf the result of the subquery contains one row, it work. But it doesn't for multiple rows. And in this generally the case in my project since any customer can hold many shares of different stocks. </p>\n\n<p>How can I make it work when the subquery returns multiple rows. </p>\n"}, {"tags": ["c#", ".net", "config", ".net-assembly", "assembly-loading"], "answers": [{"tags": [], "owner": {"reputation": 4443, "user_id": 1237135, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/HXf7n.jpg?s=128&g=1", "display_name": "Jim W says reinstate Monica", "link": "https://stackoverflow.com/users/1237135/jim-w-says-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1521075395, "creation_date": 1521075395, "answer_id": 49289933, "question_id": 49288920, "link": "https://stackoverflow.com/questions/49288920/net-use-application-config-file-to-load-an-assembly-that-is-referenced-by-anoth/49289933#49289933", "title": ".NET use application config file to load an assembly that is referenced by another assembly", "body": "<p>You might hope this would be possible with the probing element in the app.config (see <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/probing-element\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/configure-apps/file-schema/runtime/probing-element</a>)</p>\n\n<pre><code>&lt;configuration&gt;  \n   &lt;runtime&gt;  \n      &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;  \n        &lt;probing privatePath=\"../C/\"/&gt;  \n       &lt;dependentAssembly&gt;  \n         &lt;assemblyIdentity name=\"DynAssem\"  \n                           publicKeyToken=\"xxxxx\"  \n                           culture=\"neutral\" /&gt;  \n         &lt;codeBase version=\"0.0.0.0\" href=\"../C/DynAssem.dll\"/&gt;  \n       &lt;/dependentAssembly&gt;        \n      &lt;/assemblyBinding&gt;  \n   &lt;/runtime&gt;  \n&lt;/configuration&gt;\n</code></pre>\n\n<p>but it appears (at least according to <a href=\"https://stackoverflow.com/questions/31556078/probing-the-assembly-from-parent-directory-of-the-exe\">Probing the assembly from parent directory of the exe</a>) that it's not possible to probe in folders higher in your folder hierarchy.</p>\n\n<p>EDIT:</p>\n\n<p>As described here (<a href=\"https://blogs.msdn.microsoft.com/suzcook/2003/05/29/choosing-a-binding-context/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/suzcook/2003/05/29/choosing-a-binding-context/</a>) you can use LoadFrom to load assemblies from any path you like, I haven't tried it but that could be your solution.</p>\n"}], "owner": {"reputation": 1142, "user_id": 359353, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7ea5964814a6d0e134998c924e7b547e?s=128&d=identicon&r=PG", "display_name": "Dula", "link": "https://stackoverflow.com/users/359353/dula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 804, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521075395, "creation_date": 1521068129, "question_id": 49288920, "link": "https://stackoverflow.com/questions/49288920/net-use-application-config-file-to-load-an-assembly-that-is-referenced-by-anoth", "title": ".NET use application config file to load an assembly that is referenced by another assembly", "body": "<p>My native program is temp/A/prog.exe. I am loading a .Net assembly using Assembly::Load() in C++/CLI at temp/B/LoadAssem.dll. But assem.dll references dynAssem.dll located in temp/C. I have written the config file as follows:</p>\n\n<pre><code>&lt;configuration&gt;  \n   &lt;runtime&gt;  \n      &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;  \n       &lt;dependentAssembly&gt;  \n         &lt;assemblyIdentity name=\"DynAssem\"  \n                           publicKeyToken=\"xxxxx\"  \n                           culture=\"neutral\" /&gt;  \n         &lt;codeBase version=\"0.0.0.0\" href=\"../C/DynAssem.dll\"/&gt;  \n       &lt;/dependentAssembly&gt;        \n      &lt;/assemblyBinding&gt;  \n   &lt;/runtime&gt;  \n&lt;/configuration&gt;\n</code></pre>\n\n<p>But the bind fails with fusion output as follows:</p>\n\n<pre><code>=== Pre-bind state information ===\nLOG: DisplayName = dynAssem\n (Partial)\nWRN: Partial binding information was supplied for an assembly:\nWRN: Assembly Name: dynAssem | Domain ID: 1\nWRN: A partial bind occurs when only part of the assembly display name is provided.\nWRN: This might result in the binder loading an incorrect assembly.\nWRN: It is recommended to provide a fully specified textual identity for the assembly,\nWRN: that consists of the simple name, version, culture, and public key token.\nWRN: See whitepaper http://go.microsoft.com/fwlink/?LinkId=109270 for more information and common solutions to this issue.\nLOG: Appbase = file:///c:/temp/A/\nLOG: Initial PrivatePath = NULL\nLOG: Dynamic Base = NULL\nLOG: Cache Base = NULL\nLOG: AppName = prog.exe\nCalling assembly : XXX, Version=0.0.0.0, Culture=neutral, PublicKeyToken=XXX.\n===\nLOG: This bind starts in default load context.\nLOG: Using application configuration file: c:\\temp\\A\\prog.exe.Config\nLOG: Using host configuration file: \nLOG: Using machine configuration file from C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\config\\machine.config.\nLOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).\nLOG: Attempting download of new URL file:///c:/temp/A/dynAssem.DLL.\nLOG: Attempting download of new URL file:///c:/temp/A/dynAssem/dynAssem.DLL.\nLOG: Attempting download of new URL file:///c:/temp/A/dynAssem.EXE.\nLOG: Attempting download of new URL file:///c:/temp/A/dynAssem/dynAssem.EXE.\nLOG: All probing URLs attempted and failed.\n</code></pre>\n\n<p>I understand this directory layout is not the preferred layout for .NET. However, I need to support multiple other languages, therefore the directory structure and assembly locations cannot be changed.</p>\n"}, {"tags": ["c#", "outlook"], "comments": [{"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521068295, "post_id": 49288723, "comment_id": 85581046, "body": "You need to be much more clear as the problem you are facing. I can see you are creating an iCalendar format feed, but you seem to be asking &quot;how do I know if the user accepts the invitation&quot; ?"}, {"owner": {"reputation": 1, "user_id": 7687186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d21ff8650a0f35868a1325301cb1f8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Fernandes", "link": "https://stackoverflow.com/users/7687186/daniel-fernandes"}, "reply_to_user": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521108116, "post_id": 49288723, "comment_id": 85594810, "body": "yes. That&#39;s my problem. I need to know if user accept or reject"}, {"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 1, "creation_date": 1521143551, "post_id": 49288723, "comment_id": 85618249, "body": "You can&#39;t. The user might mail you baco n hte Organizer mail address, but they might not. If they did it would generate a structured email back to the organizer which youd have to read from that mail box."}], "owner": {"reputation": 1, "user_id": 7687186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d21ff8650a0f35868a1325301cb1f8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Fernandes", "link": "https://stackoverflow.com/users/7687186/daniel-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521082941, "creation_date": 1521066932, "last_edit_date": 1521082941, "question_id": 49288723, "link": "https://stackoverflow.com/questions/49288723/how-to-send-a-ics-and-know-by-callback-answer-in-c", "title": "How to send a ics and know by callback answer in c#?", "body": "<p>For now I have this part, but I don't know which option the user selected.</p>\n\n<pre><code>StringBuilder str = new StringBuilder();\nstr.AppendLine(\"BEGIN:VCALENDAR\");\nstr.AppendLine(\"PRODID:-//ABC Company//Outlook MIMEDIR//EN\");\nstr.AppendLine(\"VERSION:2.0\");\nstr.AppendLine(\"METHOD:REQUEST\");\n\nstr.AppendLine(\"BEGIN:VEVENT\");\n\nstr.AppendLine(string.Format(\"DTSTART:{0:yyyyMMddTHHmmssZ}\", startTime1));\nstr.AppendLine(string.Format(\"DTSTAMP:{0:yyyyMMddTHHmmssZ}\", DateTime.UtcNow));\nstr.AppendLine(string.Format(\"DTEND:{0:yyyyMMddTHHmmssZ}\", endTime1));\nstr.AppendLine(string.Format(\"LOCATION: {0}\", \"Location\"));\n\nstr.AppendLine(string.Format(\"UID:{0}\", Guid.NewGuid()));\nstr.AppendLine(string.Format(\"DESCRIPTION:{0}\", mail.Body));\nstr.AppendLine(string.Format(\"X-ALT-DESC;FMTTYPE=text/html:{0}\", mail.Body));\nstr.AppendLine(string.Format(\"SUMMARY:{0}\", mail.Subject));\n\nstr.AppendLine(\"STATUS:CONFIRMED\");\nstr.AppendLine(\"BEGIN:VALARM\");\nstr.AppendLine(\"TRIGGER:-PT15M\");\nstr.AppendLine(\"ACTION:Accept\");\nstr.AppendLine(\"DESCRIPTION:Reminder\");\nstr.AppendLine(\"X-MICROSOFT-CDO-BUSYSTATUS:BUSY\");\nstr.AppendLine(\"END:VALARM\");\nstr.AppendLine(\"END:VEVENT\");\n\nstr.AppendLine(string.Format(\"ORGANIZER:MAILTO:{0}\", mail.From.Address));\nstr.AppendLine(string.Format(\"ATTENDEE;CN=\\\"{0}\\\";RSVP=TRUE:mailto:{1}\", mail.To[0].DisplayName, mail.To[0].Address));\n\nstr.AppendLine(\"END:VCALENDAR\");\nSystem.Net.Mime.ContentType ct = new System.Net.Mime.ContentType(\"text/calendar\");\nct.Parameters.Add(\"method\", \"REQUEST\");\nct.Parameters.Add(\"name\", \"meeting.ics\");\nAlternateView avCal = AlternateView.CreateAlternateViewFromString(str.ToString(), ct);\nmail.AlternateViews.Add(avCal);\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "oauth", "oauth-2.0"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521067010, "post_id": 49288710, "comment_id": 85580592, "body": "That&#39;s not a valid JWT, that&#39;s for sure. I&#39;d say that&#39;s a completely custom token"}, {"owner": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521067014, "post_id": 49288710, "comment_id": 85580593, "body": "why do you think its not JWT?"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "reply_to_user": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 2, "creation_date": 1521067061, "post_id": 49288710, "comment_id": 85580614, "body": "@Coding <code>userName</code>, <code>.issued</code> and <code>.expires</code> are not valid JWT fields. See <a href=\"https://jwt.io/\" rel=\"nofollow noreferrer\">here</a> for basic information"}, {"owner": {"reputation": 19863, "user_id": 122507, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lGirc.jpg?s=128&g=1", "display_name": "Stilgar", "link": "https://stackoverflow.com/users/122507/stilgar"}, "reply_to_user": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521067215, "post_id": 49288710, "comment_id": 85580683, "body": "@Coding JWT has 3 parts separated by . and can&#39;t have characters like _ because it is base64 encoding. It may however be an encrypted JWT token as the code seems to use something called dataprotector that probably encrypts the ticket."}, {"owner": {"reputation": 19863, "user_id": 122507, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lGirc.jpg?s=128&g=1", "display_name": "Stilgar", "link": "https://stackoverflow.com/users/122507/stilgar"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521067450, "post_id": 49288710, "comment_id": 85580759, "body": "@CamiloTerevinto that can very well be the case. If this is a non-standard token I guess I will just replace it with a JWT token. However I want to learn the pros and cons if it is possible and why MS went with a non-standard token."}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521067702, "post_id": 49288710, "comment_id": 85580855, "body": "Not sure if I should post this as an answer: the RFC7519 (the JWT standard) is from May 2015, the post is from June 2014 so the package is at least from that date, so that&#39;s why it doesn&#39;t use the standard. Notice that there are newer ways to generate JWTs in Web API 2 from other Microsoft packages"}, {"owner": {"reputation": 19863, "user_id": 122507, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lGirc.jpg?s=128&g=1", "display_name": "Stilgar", "link": "https://stackoverflow.com/users/122507/stilgar"}, "edited": false, "score": 0, "creation_date": 1521067861, "post_id": 49288710, "comment_id": 85580913, "body": "One thing that worries me a bit is that the old token seems to be encrypted while JWT is not. I am not going to put anything sensitive in the token but I&#39;d like to be on the safe side in case some other devs comes along later and adds a claim that should not be known to others but the server"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521067991, "post_id": 49288710, "comment_id": 85580957, "body": "Not really, see <a href=\"https://stackoverflow.com/questions/34235875/should-jwt-web-token-be-encrypted\">this post</a>"}, {"owner": {"reputation": 19863, "user_id": 122507, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lGirc.jpg?s=128&g=1", "display_name": "Stilgar", "link": "https://stackoverflow.com/users/122507/stilgar"}, "edited": false, "score": 0, "creation_date": 1521068173, "post_id": 49288710, "comment_id": 85581012, "body": "Thanks, I will try to use this encrypted version. I still want to know about the current token though so I&#39;ll leave the question :)"}, {"owner": {"reputation": 3947, "user_id": 352051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eafc7eefe70a992d24a65ee50d813e71?s=128&d=identicon&r=PG", "display_name": "iandayman", "link": "https://stackoverflow.com/users/352051/iandayman"}, "edited": false, "score": 2, "creation_date": 1521069616, "post_id": 49288710, "comment_id": 85581442, "body": "have a look at <a href=\"https://stackoverflow.com/questions/26766530/how-to-unencrypt-web-api-2-jwt-tokens\">this post</a> for more info on the token format."}], "owner": {"reputation": 19863, "user_id": 122507, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lGirc.jpg?s=128&g=1", "display_name": "Stilgar", "link": "https://stackoverflow.com/users/122507/stilgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521066901, "creation_date": 1521066901, "question_id": 49288710, "link": "https://stackoverflow.com/questions/49288710/what-kind-of-bearer-authentication-token-is-this", "title": "What kind of bearer authentication token is this?", "body": "<p>So I implemented some bearer token authentication using <a href=\"http://bitoftech.net/2014/06/01/token-based-authentication-asp-net-web-api-2-owin-asp-net-identity/\" rel=\"nofollow noreferrer\">this guide</a>. It uses <a href=\"https://www.nuget.org/packages/Microsoft.Owin.Security.OAuth/4.0.0/\" rel=\"nofollow noreferrer\">OWIN-based OAuth library</a> provided by Microsoft to generate the tokens. I can't figure out what token this generates. I am asking because I am trying to migrate this to ASP.NET Core but all the articles out there are about JWT token (Yes, I do know that the JWT token can be used as bearer token with OAuth2) and this clearly is not a JWT token. The response looks like this:</p>\n\n<pre><code>{\n    \"access_token\": \"NXNps5iEafO6v2QMGOpXCGXBNVQw1DQTr9nV9JgG1XIRxEG9_3eliy4MQ3a050GKDQEBuQ_Y1vW-vEkPKx5MWlwEvpdxmWMnlxn-P2nq0gvl7oD2seiY69Yyab3uL3ZlppyI_A-PbQG-BSNJQKcbvoVBzejtXsrs3ADuvNi0EjYf3T12hpdiDzyPoAE1XDF44AL6hxFmUdJJ56pshUkPVlJUM851gfFIVvL5mf1yebWDo5gkdt9YhT1H32vD7KvgXHMMtYkxvT4lW6vXwyusKlH_MzZzHL1KlystJayc9QL-PDsLBGSfqPTQmOSw_vRaezHjMj4dSkCqrT4_RLoeeUsuSk5Q5mHGGYuJwPEPWJ5qXBjZT4U9RtjTB-EEyqINZGC_IxpM40qJPbBi2zvUsbafUroGx-tG2BNLtnvKnrqfZScLDsi7bd85Oc1S5kPuPf5LFtKr3f_ePRE0sGddvxCHcYUR_cn0zJSg1EDARXGM61ApgERTAQyy1oPeu-PgPSqqoGUvZ1-X26bQ2QarSQ3UMdAcO2eIuICM-XiVjb5lNo5FB21ZeTdYIi25WasqNJxQfIfEHqfTcdD5y7YsZA\",\n    \"token_type\": \"bearer\",\n    \"expires_in\": 31535999,\n    \"userName\": \"emailuserasusername@outlook.com\",\n    \".issued\": \"Wed, 14 Mar 2018 22:26:59 GMT\",\n    \".expires\": \"Thu, 14 Mar 2019 22:26:59 GMT\"\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "lambda", "dispatcher"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 1, "creation_date": 1521068098, "post_id": 49288704, "comment_id": 85580985, "body": "The lambda expression does not capture the value of the variable <code>i</code>. Rather, it captures the variable itself (so to speak). When the lambda expression is eventually executed through the dispatcher, the for-loop has already been finished, with <code>i</code> having the value <code>2</code>. That&#39;s the value SelectedObjectsChanged is being called with (it actually is being called twice, both with an argument of 2)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 1, "creation_date": 1521068200, "post_id": 49288704, "comment_id": 85581017, "body": "Solution: Create a variable inside the for-loop and assign it the current value of <code>i</code>. Then use that variable instead of <code>i</code> inside the lambda expression (this works as the lambda is also local to the for-loop body scope; i.e. with each iteration of the for-loop, a new capture will be created)"}, {"owner": {"reputation": 6200, "user_id": 218640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b46c5c5c70b433012c437578243bf289?s=128&d=identicon&r=PG", "display_name": "char m", "link": "https://stackoverflow.com/users/218640/char-m"}, "edited": false, "score": 0, "creation_date": 1521100406, "post_id": 49288704, "comment_id": 85590318, "body": "thanks @elgonzo! calling once instead of twice problem was kind of unrelated so introducing new variable solved my issue."}], "answers": [{"comments": [{"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 1, "creation_date": 1521068439, "post_id": 49288949, "comment_id": 85581095, "body": "This is the correct solution but because all delegate style code blocks in .net have the same scenario. If you are passing an iterated variable, it does not get evaluated until the code block is executed. You think it gets evaluated when you create the code block, but its a misreading of the code."}, {"owner": {"reputation": 6200, "user_id": 218640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b46c5c5c70b433012c437578243bf289?s=128&d=identicon&r=PG", "display_name": "char m", "link": "https://stackoverflow.com/users/218640/char-m"}, "reply_to_user": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 1, "creation_date": 1521100299, "post_id": 49288949, "comment_id": 85590274, "body": "Thanks for your answer. Parameter is correct now and I found out the reason for &quot;calling once instead of twice&quot;. +1 for @PhillipH for helpdul comment."}], "tags": [], "owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "is_accepted": true, "score": 2, "last_activity_date": 1521069074, "last_edit_date": 1521069074, "creation_date": 1521068271, "answer_id": 49288949, "question_id": 49288704, "link": "https://stackoverflow.com/questions/49288704/how-can-i-dispatch-same-method-to-be-called-multiple-times-and-give-call-order-n/49288949#49288949", "title": "How can I dispatch same method to be called multiple times and give call order number as parameter in WPF app?", "body": "<p>By the time SelectedObjectsChanged executes the value has changed</p>\n\n<pre><code>var index = i;                    \nApp.Current.Dispatcher.BeginInvoke(DispatcherPriority.ApplicationIdle, (Action)(() =&gt; \n               {\n                   vm.SelectedObjectsChanged(index);\n               }));\n</code></pre>\n\n<p><strong>Helpful comment by PhillipH</strong></p>\n\n<blockquote>\n  <p>All delegate style code blocks in .net have the same scenario. If you\n  are passing an iterated variable, it does not get evaluated until the\n  code block is executed. You think it gets evaluated when you create\n  the code block, but its a misreading of the code</p>\n</blockquote>\n"}], "owner": {"reputation": 6200, "user_id": 218640, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b46c5c5c70b433012c437578243bf289?s=128&d=identicon&r=PG", "display_name": "char m", "link": "https://stackoverflow.com/users/218640/char-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 49288949, "answer_count": 1, "score": 1, "last_activity_date": 1521069074, "creation_date": 1521066865, "last_edit_date": 1521067718, "question_id": 49288704, "link": "https://stackoverflow.com/questions/49288704/how-can-i-dispatch-same-method-to-be-called-multiple-times-and-give-call-order-n", "title": "How can I dispatch same method to be called multiple times and give call order number as parameter in WPF app?", "body": "<p>I needed to dispatch a method for each view model only once and all worked nice. Now I need to dispatch SelectedObjectsChanged-call for one of the view models (ObjectViewModel below) 2 times so I introduced property NumberOfCalls and parameter for both methods. However SelectedObjectsChanged is called only once and the value for parameter callNumber is wrong (2) while I thought it would be 0 first time and 1 second time. How this should be done correctly?</p>\n\n<pre><code>interface ISelectedObjectDependent\n{\n    void SelectedObjectsChanged(int callNumber);\n    int NumberOfCalls { get; }\n    int ExecutionOrder { get; }\n    bool NeedsRefresh(int callNumber);\n}\n\npublic class SelectedObjects\n{\n    private List&lt;ISelectedObjectDependent&gt; _viewModels; \n    public void ObjectSelectionChanged(object sender, EventArgs e)\n    {\n        foreach (var vm in _viewModels)\n        {\n            for (int i = 0; i &lt; vm.NumberOfCalls; i++)\n            {\n                if (vm.NeedsRefresh(i))\n                {\n                    App.Current.Dispatcher.BeginInvoke(DispatcherPriority.ApplicationIdle, \n                        (Action)(() =&gt; \n                   {\n                       vm.SelectedObjectsChanged(i);\n                   }));\n                }\n            }\n        }\n    }\n}\n\npublic class ObjectViewModel : ViewModel, ISelectedObjectDependent\n{\n    public int NumberOfCalls { get { return 2; } }\n\n    public int ExecutionOrder { get { return 1;} }\n\n    public bool NeedsRefresh(int callNumber)\n    {\n        return true;\n    }\n\n    public void SelectedObjectsChanged(int callNumber)\n    {\n         if (callNumber == 0)\n         {\n            if (IsObjectInfoVisible &amp;&amp; IsObjectInformationExpanded)\n                RefreshObjectInfo(false);\n         }\n         else\n         {\n             if (IsObjectInfoVisible &amp;&amp; IsObjectInformationExpanded)\n                 ObjectProperties.Instance.UpdateRemainingAttributes();\n         }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "pdf", "pdfsharp"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1521111898, "post_id": 49288621, "comment_id": 85597324, "body": "How <i>do</i> you &quot;handle top/bottom&quot;, then? Why does it not work for left/right as well?"}, {"owner": {"reputation": 648, "user_id": 1710496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J0JbW.gif?s=128&g=1", "display_name": "PetLahev", "link": "https://stackoverflow.com/users/1710496/petlahev"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1521112255, "post_id": 49288621, "comment_id": 85597528, "body": "I almost  hardcoded it. The charts I&#39;m working with are pretty standard in term of height but the width vary. Depends of many parameters like if it has two axis, the number format, the size of font, if the user changes the plot area manually by dragging it by mouse etc. I&#39;m just hoping the PdfSharp has similar functionality like Aspose.PDF which is working pretty fine in the trial version I could test"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1521113066, "post_id": 49288621, "comment_id": 85598101, "body": "FYI: Inspecting the file with Acrobat, I see that there is an amount of unused space around the figure (which, I presume, can trivially be cropped), but there is also a clipping mask that expands beyond your free-hand rectangle. Technically, that mask &quot;is&quot; the limit of what you can reasonably crop automatically. To go beyond that, you&#39;d need a per-object test. (Not that I know how to crop to that mask to begin with.)"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1521113197, "post_id": 49288621, "comment_id": 85598191, "body": "Ah \u2013 you can use that other library and see if it does accurately calculate the actual visible objects&#39; boundaries, or stops at that wider clipping mask. Run it and check if the resulting bounding box is very close to the visible items. That&#39;ll give you something to aim for."}, {"owner": {"reputation": 648, "user_id": 1710496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J0JbW.gif?s=128&g=1", "display_name": "PetLahev", "link": "https://stackoverflow.com/users/1710496/petlahev"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1521114254, "post_id": 49288621, "comment_id": 85598872, "body": "@usr2564301 When you are saying &quot;Inspecting the file&quot; how did you find out? I was trying one tool which name I don&#39;t remember now, something O2 I think, and now I&#39;m checking via &#39;CosEdit&#39; but for me all the information I can see there is just one big mystery."}], "owner": {"reputation": 648, "user_id": 1710496, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J0JbW.gif?s=128&g=1", "display_name": "PetLahev", "link": "https://stackoverflow.com/users/1710496/petlahev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 656, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521066458, "creation_date": 1521066458, "question_id": 49288621, "link": "https://stackoverflow.com/questions/49288621/get-size-of-a-object-from-a-pdf-file", "title": "Get size of a object from a PDF file", "body": "<p>I need to save a chart from Microsoft Excel as a PDF file. (Save As -> File Type: PDF) This will produce a sigle page PDF file where the chart is always located in the middle and also the chart is scaled to fit the page width.</p>\n\n<p>The result is fine but the chart can get lots of extra white space around it that I'd like to get rid of. I'm using <strong>PdfSharp</strong> to manipulate with the PDF file but I'm unable to find the chart (object) inside the PDF and <strong>calculate the actual size</strong>. </p>\n\n<p>I know that Aspose.PDF library has a function for it - <a href=\"https://apireference.aspose.com/net/pdf/aspose.pdf/page/methods/calculatecontentbbox\" rel=\"nofollow noreferrer\" title=\"CalculateContentBBox\">CalculateContentBBox</a> but I cannot use the library in my project.</p>\n\n<p>Is there anyway how to get the same or similar via PdfSharp?\nI believe the chart is stored as <pre>'/Contents'</pre> in the internal structure</p>\n\n<p>Here is what I have tried so far (An example PDF file is included on GitHub)\nThanks</p>\n\n<p><a href=\"https://github.com/PetLahev/PdfSharpQuestion\" rel=\"nofollow noreferrer\">https://github.com/PetLahev/PdfSharpQuestion</a></p>\n\n<pre><code>using System;\nusing System.Reflection;\nusing System.IO;\nusing PdfSharp.Pdf;\nusing PdfSharp.Pdf.IO;\nusing PdfSharp.Pdf.Advanced;\n\nnamespace PDFSharpProject\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Console.WriteLine(\"Provide path to a PDF file (or just hit enter to get the default)\");\n            string path = Console.ReadLine();\n            if (string.IsNullOrWhiteSpace(path))\n            {\n                path = Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), \"TestPDF.pdf\");\n            }\n\n            if (string.IsNullOrWhiteSpace(path)) return;\n            TryToFindObject(path);\n        }\n\n        private static void TryToFindObject(string pdfPath)\n        {\n            PdfDocument pdf = PdfReader.Open(pdfPath);\n            PdfPage page = pdf.Pages[0];\n            PdfDictionary contents = page.Elements.GetDictionary(\"/Contents\");\n            if (contents == null) return;\n\n            var items = contents.Elements.Values;\n            Console.WriteLine(\"Here I don't know what to do\");\n\n        }\n    }\n}\n</code></pre>\n\n<p>So I'd like to get the content in the red 'rectangle' (<em>of course this should be real rectangle</em>). Mainly I need to get rid of the left/right white space. I can handle top/bottom\n<a href=\"https://i.stack.imgur.com/f8W38.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f8W38.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "string", "char", "operands"], "comments": [{"owner": {"reputation": 49855, "user_id": 5862071, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/II4q8.jpg?s=128&g=1", "display_name": "Ousmane D.", "link": "https://stackoverflow.com/users/5862071/ousmane-d"}, "edited": false, "score": 1, "creation_date": 1521066527, "post_id": 49288585, "comment_id": 85580411, "body": "You can use <code>Console.ReadKey().KeyChar</code> instead of <code>Console.ReadLine()</code> since you want only a single character from the user."}, {"owner": {"reputation": 13909, "user_id": 162699, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/11d701f4f186f539521cde8050d0b341?s=128&d=identicon&r=PG", "display_name": "Gusman", "link": "https://stackoverflow.com/users/162699/gusman"}, "edited": false, "score": 0, "creation_date": 1521066699, "post_id": 49288585, "comment_id": 85580471, "body": "<code>if(userInputGuess[0] == letter)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "is_accepted": true, "score": 6, "last_activity_date": 1521066858, "last_edit_date": 1521066858, "creation_date": 1521066557, "answer_id": 49288639, "question_id": 49288585, "link": "https://stackoverflow.com/questions/49288585/comparing-a-string-and-a-char-c/49288639#49288639", "title": "Comparing a string and a char c#", "body": "<p>Instead of using <code>Console.ReadLine</code> which reads an entire line, use <code>Console.ReadKey</code>:</p>\n\n<blockquote>\n  <p>Obtains the next character or function key pressed by the user.<br>\n  The pressed key is displayed in the console window.</p>\n</blockquote>\n\n<pre><code>char userInputGuess;\n...\nConsole.WriteLine(\"Please guess a letter\");\nuserInputGuess = Console.ReadKey().KeyChar;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 1, "creation_date": 1521067257, "post_id": 49288744, "comment_id": 85580694, "body": "Two things here: <code>userInputGuess[0]</code> would throw an IndexOutOfRangeException if the user just pressed enter (generating an empty string); and <code>userInputGuess</code> would have to be declared as <code>char</code> for the second approach to work"}, {"owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521067345, "post_id": 49288744, "comment_id": 85580729, "body": "Agreed. I missed that for the char declaration."}], "tags": [], "owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "is_accepted": false, "score": 0, "last_activity_date": 1521067419, "last_edit_date": 1521067419, "creation_date": 1521067085, "answer_id": 49288744, "question_id": 49288585, "link": "https://stackoverflow.com/questions/49288585/comparing-a-string-and-a-char-c/49288744#49288744", "title": "Comparing a string and a char c#", "body": "<p>The return type of <code>Console.ReadLine()</code> is a string. By this your <code>userInputGuess</code> is of type string, and this is why you receive the error. With slight modification your code can work. Instead of:</p>\n\n<pre><code>if(userInputGuess == letter)\n</code></pre>\n\n<p>use:</p>\n\n<pre><code>if(userInputGuess[0] == letter)\n</code></pre>\n\n<p>This will read the first letter of your line. But as you may guess, this is not the best solution in this case.</p>\n\n<p>The better approach would be to read only one letter from the console. Like this:</p>\n\n<pre><code>var userInputGuess = Console.ReadKey().KeyChar; (and get rid of the previous declaration)\n</code></pre>\n\n<p>The result of this is of type char, and you won't have a problem in the comparison.</p>\n"}], "owner": {"reputation": 13, "user_id": 9457743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94d92e6ed5367c8bc5b0401e37aa61e2?s=128&d=identicon&r=PG&f=1", "display_name": "estevaano", "link": "https://stackoverflow.com/users/9457743/estevaano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 0, "accepted_answer_id": 49288639, "answer_count": 2, "score": 1, "last_activity_date": 1521067419, "creation_date": 1521066262, "question_id": 49288585, "link": "https://stackoverflow.com/questions/49288585/comparing-a-string-and-a-char-c", "title": "Comparing a string and a char c#", "body": "<p>I am working on a console Hangman game in c#. I am trying to compare user inputted letter against the letters in the random word I have generated. Error i get is \"Operator \"==\" cannot be applied to operands of type \"string\" and \"char\". What other ways could I go about doing this? Ive googled a lot but I haven't found any ideas.  </p>\n\n<pre><code>public static void LetterChecker(string word)\n    {\n        int userGuesses = 6;\n        string userInputGuess;\n\n        while(userGuesses &gt; 0)\n        {\n            Console.WriteLine(\"Please guess a letter\");\n            userInputGuess = Console.ReadLine();\n            foreach(var letter in word)\n            {\n                if(userInputGuess == letter)\n                {\n                    Console.WriteLine(\"this letter is in word, guess again\");\n                }\n                else\n                {\n                    Console.WriteLine(\"Incorrect guess\");\n                    userGuesses--;\n                }\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "cultureinfo"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1521071315, "post_id": 49288567, "comment_id": 85581928, "body": "It looks like somebody is trying to take a DateTime and parsing as if it is a string to get another DateTime.  If you already have a DateTime it is in a generic format that doesn&#39;t require a culture.  The DateTime is stored in a computer in UTF as a number.  The number when converted to a string uses a the default the PC timezone and culture to display the datetime.  Also when using Datetime.Parse() it is converted from string to DateTime using as default the culture and timezone of the PC.  Once in DateTime format no further conversion is required."}, {"owner": {"reputation": 942, "user_id": 2632046, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/grJNW.gif?s=128&g=1", "display_name": "dylanT", "link": "https://stackoverflow.com/users/2632046/dylant"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1521072653, "post_id": 49288567, "comment_id": 85582323, "body": "@jdweng this is not date time related. There are no dates or times in the code sample. This code is taking an expression that is a string (e.g. &quot;1.1&gt;2&quot; and evaluating it as a boolean (is it true or false.)"}], "owner": {"reputation": 942, "user_id": 2632046, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/grJNW.gif?s=128&g=1", "display_name": "dylanT", "link": "https://stackoverflow.com/users/2632046/dylant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521072866, "creation_date": 1521066212, "last_edit_date": 1521072866, "question_id": 49288567, "link": "https://stackoverflow.com/questions/49288567/how-to-deal-with-expressions-from-another-culture-using-datatable-datacolumn", "title": "How to deal with expressions from another culture using Datatable/Datacolumn", "body": "<p>I have some code in my codebase that evaluates an expression that gets passed to it using the <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/dataset-datatable-dataview/creating-expression-columns\" rel=\"nofollow noreferrer\">Datatable method</a> because [insert historical reasons here]. A short version of the method is below.</p>\n\n<p>When my application is running in a non US/AU/UK locale like Spain where periods are swapped for commas in floating point numbers, the code doesn't work.</p>\n\n<p>Is there a way I can make the Datatable method more culture-aware? Or am I stuck with parsing my data into invariantcultures before things get that far?</p>\n\n<pre><code>    void Main()\n    {\n        // This works\n        CompareInACulture(\"en-US\"); // US English\n\n        // This doesn't\n        CompareInACulture(\"es-ES\"); // Spanish\n\n    }\n\n    // This is testing code for the purposes of exploring the issue\n    // With this code I am comparing the value 1.1 with 1 and seeing if the first value is larger\n    // than the second. The code fails when in Spanish locale.\n    public void CompareInACulture(string cultureCode)\n    {\n        var value1 = 1.1;\n        var value2 = 1;\n\n        Thread.CurrentThread.CurrentCulture = new CultureInfo(cultureCode);\n        Thread.CurrentThread.CurrentUICulture = new CultureInfo(cultureCode);\n\n        var compareString = value1.ToString() + \"&gt;\" + value2.ToString();\n\n        // My current approach is to use an invariantCulture here, but I'm not satisfied it is the best approach\n        // var compareString = value1.ToString(CultureInfo.InvariantCulture) + \"&gt;\" + value2.ToString(CultureInfo.InvariantCulture);\n        // I'd rather do something with the ExpressionEval class to let it know that the string it is workign with is from another culture.\n\n        Console.WriteLine($\"Now comparing {compareString}\");\n\n        var evaluator = new ExpressionEval();\n        var result1 = evaluator.Evaluate(compareString, out var passOrFail);\n        Console.WriteLine($\"Evaluate returned {result1} and passOrFail is {passOrFail}.\");\n    }\n\n    // This is a simplified version of the class that's doing the actual job. I can tweak this, but not radically change it.\n    public class ExpressionEval\n    {\n        string _lastErrorText = \"\";\n        public string LastErrorText =&gt; _lastErrorText;\n\n        public bool Evaluate(string psExpression, out bool pbResult)\n        {\n            pbResult = false;\n\n            try\n            {\n                var loDataTable = new DataTable();\n                var loDataColumn = new DataColumn(\"Eval\", typeof(bool), psExpression);\n                loDataTable.Columns.Add(loDataColumn);\n                loDataTable.Rows.Add(0);\n                pbResult = (bool)(loDataTable.Rows[0][\"Eval\"]);\n                return true;\n            }\n            catch (Exception ex)\n            {\n                // do stuff\n                Console.WriteLine(ex.Message);\n                return false;\n            }\n        }\n    }\n</code></pre>\n\n<p>I was hopeful that the DataTable.locale would assist, but setting it doesn't seem to achieve anything. The remarks at <a href=\"https://msdn.microsoft.com/en-us/library/system.data.datatable.locale(v=vs.110).aspx\" rel=\"nofollow noreferrer\">this Microsoft site</a> say in part \"In columns that contain expressions, the InvariantCulture is used. The CurrentCulture is ignored.\"</p>\n"}, {"tags": ["c#", "winapi", "pinvoke"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1521066307, "post_id": 49288552, "comment_id": 85580329, "body": "It\u2019s 2 16 bit values in a single 32 bit one."}], "answers": [{"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1521067115, "post_id": 49288716, "comment_id": 85580630, "body": "LPARAM is pointer sized. So it&#39;s an IntPtr not a uint. We&#39;ll, could be UIntPtr depending on how the pinvoke is declared but question says IntPtr."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1521067169, "post_id": 49288716, "comment_id": 85580658, "body": "@DavidHeffernan Does not matter, coordinates in messages are never &gt; 32-bit."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1521067705, "post_id": 49288716, "comment_id": 85580856, "body": "I know. But the asker starts with an IntPtr. And not a uint. So they need to get from one to the other."}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": false, "score": 0, "last_activity_date": 1521067771, "last_edit_date": 1521067771, "creation_date": 1521066917, "answer_id": 49288716, "question_id": 49288552, "link": "https://stackoverflow.com/questions/49288552/how-do-i-read-the-win32-wm-move-lparam-x-y-coordinates-in-c/49288716#49288716", "title": "How do I read the Win32 WM_MOVE lParam x,y coordinates in C#?", "body": "<p>Coordinates in Windows messages are often two signed 16-bit numbers packed into a 32-bit number.</p>\n\n<p>Ideally you should extract these as signed numbers emulating the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632654(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>GET_X_LPARAM</code></a>/<code>GET_Y_LPARAM</code> macros:</p>\n\n<pre><code>IntPtr lparam = (IntPtr) 0xfffeffff; // -1 x -2 example coordinate\nuint lparam32 = (uint) lparam.ToInt64(); // We want the bottom unsigned 32-bits\nshort x = (short) (((uint)lparam32) &amp; 0xffff);\nshort y = (short) ((((uint)lparam32) &gt;&gt; 16) &amp; 0xffff);  \n\nConsole.WriteLine(string.Format(\"coordinates: {0} x {1}\", x, y));\n</code></pre>\n\n<p>In the case of <code>WM_MOVE</code> you could also extract them as unsigned numbers (<code>ushort</code>) since the client area will never be negative.</p>\n"}, {"tags": [], "owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "is_accepted": false, "score": 1, "last_activity_date": 1521068337, "creation_date": 1521068337, "answer_id": 49288958, "question_id": 49288552, "link": "https://stackoverflow.com/questions/49288552/how-do-i-read-the-win32-wm-move-lparam-x-y-coordinates-in-c/49288958#49288958", "title": "How do I read the Win32 WM_MOVE lParam x,y coordinates in C#?", "body": "<p>.NET Reference source is a gold mine. In an internal <a href=\"https://referencesource.microsoft.com/#System.Windows.Forms/winforms/Managed/System/WinForms/NativeMethods.cs,e1ab28ba69954959,references\" rel=\"nofollow noreferrer\">System.Windows.Forms.NativeMethods+Util class</a> you will find these helpers, that talk the same as WM_MOVE documentation (high-order word = HIWORD, low-order word = LOWORD, etc.)</p>\n\n<pre><code>public static int MAKELONG(int low, int high) {\n    return (high &lt;&lt; 16) | (low &amp; 0xffff);\n}\n\npublic static IntPtr MAKELPARAM(int low, int high) {\n    return (IntPtr) ((high &lt;&lt; 16) | (low &amp; 0xffff));\n}\n\npublic static int HIWORD(int n) {\n    return (n &gt;&gt; 16) &amp; 0xffff;\n}\n\npublic static int HIWORD(IntPtr n) {\n    return HIWORD( unchecked((int)(long)n) );\n}\n\npublic static int LOWORD(int n) {\n    return n &amp; 0xffff;\n}\n\npublic static int LOWORD(IntPtr n) {\n    return LOWORD( unchecked((int)(long)n) );\n}\n\npublic static int SignedHIWORD(IntPtr n) {\n    return SignedHIWORD( unchecked((int)(long)n) );\n}\n\npublic static int SignedLOWORD(IntPtr n) {\n    return SignedLOWORD( unchecked((int)(long)n) );\n}\n\npublic static int SignedHIWORD(int n) {\n    int i = (int)(short)((n &gt;&gt; 16) &amp; 0xffff);\n    return i;\n}\n\npublic static int SignedLOWORD(int n) {\n    int i = (int)(short)(n &amp; 0xFFFF);\n    return i;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1521085145, "last_edit_date": 1521085145, "creation_date": 1521082162, "answer_id": 49290781, "question_id": 49288552, "link": "https://stackoverflow.com/questions/49288552/how-do-i-read-the-win32-wm-move-lparam-x-y-coordinates-in-c/49290781#49290781", "title": "How do I read the Win32 WM_MOVE lParam x,y coordinates in C#?", "body": "<p>In addition to what Simon Mourier already posted (which covers a number of standard macros), this method returns a <code>Point()</code> from a <code>message.LParam</code>.<br></p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms645616(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MSDN suggests</a> to use the <code>GET_X_LPARAM</code> and <code>GET_Y_LPARAM</code> macros\n  (defined in <code>WindowsX.h</code>) to extract the coordinates, warning against\n  the possible wrong results returned by the <code>LOWORD</code> and <code>HIWORD</code>\n  macros (defined in <code>WinDef.h</code>), because those return unsigned\n  integers.<br> These are the definitions of the suggested macros:<br></p>\n</blockquote>\n\n<pre><code>#define GET_X_LPARAM(lp)    ((int)(short)LOWORD(lp))\n#define GET_Y_LPARAM(lp)    ((int)(short)HIWORD(lp))\n</code></pre>\n\n<p>What's important is that these values must be signed, since secondary monitors return negative values as coordinates.<br></p>\n\n<pre><code>public static Point PointFromLParam(IntPtr lParam)\n{\n    return new Point((int)(lParam) &amp; 0xFFFF, ((int)(lParam) &gt;&gt; 16) &amp; 0xFFFF);\n}\n</code></pre>\n"}], "owner": {"reputation": 1391, "user_id": 33764, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91c8492f6b8a4ef45310a4d63c54ae7a?s=128&d=identicon&r=PG", "display_name": "NabilS", "link": "https://stackoverflow.com/users/33764/nabils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1521085145, "creation_date": 1521066133, "question_id": 49288552, "link": "https://stackoverflow.com/questions/49288552/how-do-i-read-the-win32-wm-move-lparam-x-y-coordinates-in-c", "title": "How do I read the Win32 WM_MOVE lParam x,y coordinates in C#?", "body": "<p>I am trying to read the lParam x and y coordinates from WM_MOVE win32 message and getting strange values. I need to extract them from the lParam IntPtr somehow.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms632631(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms632631(v=vs.85).aspx</a></p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "linq", "removeall"], "comments": [{"owner": {"reputation": 4723, "user_id": 3061857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/m8l4z.jpg?s=128&g=1", "display_name": "nbokmans", "link": "https://stackoverflow.com/users/3061857/nbokmans"}, "edited": false, "score": 0, "creation_date": 1521066093, "post_id": 49288496, "comment_id": 85580244, "body": "Why can <code>Contains</code> not be used?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1521066102, "post_id": 49288496, "comment_id": 85580250, "body": "I don&#39;t really know what you are trying to achieve, but here is a (simple) suggestion: Put any values (strings?) you get from the listbox(es) into a <code>HashSet</code> (or a similar type of collection that allows quick lookups). Then you can do something like <code>MyList.RemoveAll(x =&gt; !mysHashSet.Contains(x.Letter));</code>"}, {"owner": {"reputation": 41, "user_id": 8508333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c161a37550104dfd576f64ea5eb85eed?s=128&d=identicon&r=PG&f=1", "display_name": "dbay", "link": "https://stackoverflow.com/users/8508333/dbay"}, "reply_to_user": {"reputation": 4723, "user_id": 3061857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/m8l4z.jpg?s=128&g=1", "display_name": "nbokmans", "link": "https://stackoverflow.com/users/3061857/nbokmans"}, "edited": false, "score": 0, "creation_date": 1521116069, "post_id": 49288496, "comment_id": 85599989, "body": "@nbokmans - I can not use &quot;Contains&quot; because it does what it means. If I have a list that is made up of: &quot;A&quot;, &quot;AA&quot;, &quot;AAA&quot;, &quot;AAAA&quot; and I only want to remove &quot;A&quot;, &quot;Contains&quot; will remove all of them. That is not what I am trying to do."}], "answers": [{"tags": [], "owner": {"reputation": 60839, "user_id": 301857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4KmT.jpg?s=128&g=1", "display_name": "Grant Winney", "link": "https://stackoverflow.com/users/301857/grant-winney"}, "is_accepted": false, "score": 3, "last_activity_date": 1521066126, "creation_date": 1521066126, "answer_id": 49288549, "question_id": 49288496, "link": "https://stackoverflow.com/questions/49288496/c-linq-removeall-with-dynamic-or-statement/49288549#49288549", "title": "C# Linq RemoveAll with dynamic OR statement", "body": "<p>You're trying to make sure that nothing in that list is equal to <code>x.Letter</code>, so I'd construct the list of values you'd like to remove first, then use that.</p>\n\n<p>I don't know what your <code>ListBox</code> looks like, but let's assume you can get the list of strings out of it like this:</p>\n\n<pre><code>List&lt;string&gt; stuffToRemove = myListBox.Items.Select(x =&gt; x.Value).ToList();\n</code></pre>\n\n<p>You should just be able to use that list of strings in your LINQ statement:</p>\n\n<pre><code>MyList.RemoveAll(x =&gt; stuffToRemove.Contains(x.Letter));\n</code></pre>\n\n<hr>\n\n<p>If you actually intended to <em>keep</em> the stuff in the <code>ListBox</code>, then adjust it accordingly:</p>\n\n<pre><code>List&lt;string&gt; stuffToKeep = myListBox.Items.Select(x =&gt; x.Value).ToList();\n\nMyList.RemoveAll(x =&gt; !stuffToKeep.Contains(x.Letter));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 8508333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c161a37550104dfd576f64ea5eb85eed?s=128&d=identicon&r=PG&f=1", "display_name": "dbay", "link": "https://stackoverflow.com/users/8508333/dbay"}, "edited": false, "score": 1, "creation_date": 1521116358, "post_id": 49288566, "comment_id": 85600193, "body": "So far with the short tests i have done, this is working exactly the way I need it to. Thank you."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1521066209, "creation_date": 1521066209, "answer_id": 49288566, "question_id": 49288496, "link": "https://stackoverflow.com/questions/49288496/c-linq-removeall-with-dynamic-or-statement/49288566#49288566", "title": "C# Linq RemoveAll with dynamic OR statement", "body": "<p>You do not need to make it dynamic, because the structure of your condition is very regular: you check containment against all items. Hence you can do it like this:</p>\n\n<pre><code>var check = new List&lt;string&gt;(itemsFromListBox);\nMyList.RemoveAll(x =&gt; check.All(s =&gt; x.Letter != s));\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8508333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c161a37550104dfd576f64ea5eb85eed?s=128&d=identicon&r=PG&f=1", "display_name": "dbay", "link": "https://stackoverflow.com/users/8508333/dbay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 49288566, "answer_count": 2, "score": 1, "last_activity_date": 1521066209, "creation_date": 1521065823, "question_id": 49288496, "link": "https://stackoverflow.com/questions/49288496/c-linq-removeall-with-dynamic-or-statement", "title": "C# Linq RemoveAll with dynamic OR statement", "body": "<p>I need to know if there is a way to create this part dynamically. Or, is it even possible? Using \"Contians\" will not work in this situation.</p>\n\n<pre><code>(x.Letter!= \"a\") &amp;&amp; (x.Letter!= \"b\") &amp;&amp; (x.Letter!= \"e\")\n</code></pre>\n\n<p>The \"a\", \"b\", \"c\" will be generated out of a ListBox using a for loop. There can be any number of items in the list box. That is why this must be dynamic.</p>\n\n<pre><code>MyList.RemoveAll(x =&gt; (x.Letter != \"a\") &amp;&amp; (x.Letter!= \"b\") &amp;&amp; (x.Letter!= \"e\"));\n</code></pre>\n"}, {"tags": ["c#", "unity3d", "2d", "shader", "light"], "comments": [{"owner": {"reputation": 889, "user_id": 7960813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kdAbt.png?s=128&g=1", "display_name": "Bejasc", "link": "https://stackoverflow.com/users/7960813/bejasc"}, "edited": false, "score": 1, "creation_date": 1521067189, "post_id": 49288411, "comment_id": 85580667, "body": "Very well written question, but I feel it might be more appropriate for gamedev.stackexchange rather than Stack Overflow"}, {"owner": {"reputation": 7673, "user_id": 6086226, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/fQU1t.jpg?s=128&g=1", "display_name": "Derk Jan Speelman", "link": "https://stackoverflow.com/users/6086226/derk-jan-speelman"}, "reply_to_user": {"reputation": 889, "user_id": 7960813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kdAbt.png?s=128&g=1", "display_name": "Bejasc", "link": "https://stackoverflow.com/users/7960813/bejasc"}, "edited": false, "score": 0, "creation_date": 1521067279, "post_id": 49288411, "comment_id": 85580704, "body": "@Bejasc I was asking that question myself. And I feel stackoverflow has a allround programmer community that might be able to solve this question. I will probably post it on the Unity forum as well and provide my question with a link."}, {"owner": {"reputation": 1109, "user_id": 3064164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DjCnH.png?s=128&g=1", "display_name": "DMGregory", "link": "https://stackoverflow.com/users/3064164/dmgregory"}, "edited": false, "score": 1, "creation_date": 1521117209, "post_id": 49288411, "comment_id": 85600807, "body": "Note that cross-posting is discouraged on StackExchange sites. I agree with Bejasc that this question will likely get better answers on GameDev.StackExchange, but I&#39;ll have to close it there if you keep this version up."}, {"owner": {"reputation": 7673, "user_id": 6086226, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/fQU1t.jpg?s=128&g=1", "display_name": "Derk Jan Speelman", "link": "https://stackoverflow.com/users/6086226/derk-jan-speelman"}, "reply_to_user": {"reputation": 1109, "user_id": 3064164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DjCnH.png?s=128&g=1", "display_name": "DMGregory", "link": "https://stackoverflow.com/users/3064164/dmgregory"}, "edited": false, "score": 0, "creation_date": 1521120194, "post_id": 49288411, "comment_id": 85602868, "body": "@DMGregory you think it will get a better answer faster at gamedev?"}, {"owner": {"reputation": 1109, "user_id": 3064164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DjCnH.png?s=128&g=1", "display_name": "DMGregory", "link": "https://stackoverflow.com/users/3064164/dmgregory"}, "edited": false, "score": 0, "creation_date": 1521120767, "post_id": 49288411, "comment_id": 85603297, "body": "Faster, hard to say. It depends on our traffic volume and folks&#39; free time."}, {"owner": {"reputation": 7673, "user_id": 6086226, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/fQU1t.jpg?s=128&g=1", "display_name": "Derk Jan Speelman", "link": "https://stackoverflow.com/users/6086226/derk-jan-speelman"}, "reply_to_user": {"reputation": 1109, "user_id": 3064164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DjCnH.png?s=128&g=1", "display_name": "DMGregory", "link": "https://stackoverflow.com/users/3064164/dmgregory"}, "edited": false, "score": 0, "creation_date": 1521125828, "post_id": 49288411, "comment_id": 85607274, "body": "@DMGregory I&#39;d simply love to see this question answered. Rather close the gamedev post if you really have to."}, {"owner": {"reputation": 1109, "user_id": 3064164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DjCnH.png?s=128&g=1", "display_name": "DMGregory", "link": "https://stackoverflow.com/users/3064164/dmgregory"}, "edited": false, "score": 0, "creation_date": 1521125984, "post_id": 49288411, "comment_id": 85607395, "body": "Unfortunately I can&#39;t keep both open, so if you don&#39;t agree that this belongs better on GameDev then I&#39;ll have to close it there. Please ping me if you decide to close this one instead and I&#39;ll re-open it."}, {"owner": {"reputation": 7673, "user_id": 6086226, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/fQU1t.jpg?s=128&g=1", "display_name": "Derk Jan Speelman", "link": "https://stackoverflow.com/users/6086226/derk-jan-speelman"}, "reply_to_user": {"reputation": 1109, "user_id": 3064164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DjCnH.png?s=128&g=1", "display_name": "DMGregory", "link": "https://stackoverflow.com/users/3064164/dmgregory"}, "edited": false, "score": 0, "creation_date": 1521127832, "post_id": 49288411, "comment_id": 85608814, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/166901/discussion-between-derk-jan-speelman-and-dmgregory\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7673, "user_id": 6086226, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/fQU1t.jpg?s=128&g=1", "display_name": "Derk Jan Speelman", "link": "https://stackoverflow.com/users/6086226/derk-jan-speelman"}, "is_accepted": false, "score": 0, "last_activity_date": 1565858858, "last_edit_date": 1565858858, "creation_date": 1521233496, "answer_id": 49329323, "question_id": 49288411, "link": "https://stackoverflow.com/questions/49288411/unity-2d-shader-lighting-like-terraria-or-starbound/49329323#49329323", "title": "Unity - 2D shader / lighting like Terraria or Starbound", "body": "<p>Apparently, there are several packages on <a href=\"https://assetstore.unity.com/\" rel=\"nofollow noreferrer\">the Unity Asset Store</a>. Search for \"2d lighting\" or \"2d shader\". You can easily import the source code of these packages and test it in Unity yourself. If you like a package after testing, you can use it.</p>\n\n<p>I highly advise you not to import it directly into an existing project. For your own sake, test it in a test environment (or a copy of your project) before including it into your project.</p>\n"}, {"tags": [], "owner": {"reputation": 1982, "user_id": 8656972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e388e194d9c01ba593fafed7ff05300a?s=128&d=identicon&r=PG", "display_name": "Jack Mariani", "link": "https://stackoverflow.com/users/8656972/jack-mariani"}, "is_accepted": true, "score": 2, "last_activity_date": 1562828090, "creation_date": 1562828090, "answer_id": 56983287, "question_id": 49288411, "link": "https://stackoverflow.com/questions/49288411/unity-2d-shader-lighting-like-terraria-or-starbound/56983287#56983287", "title": "Unity - 2D shader / lighting like Terraria or Starbound", "body": "<p>I can mention 2 main elements about 2d Dynamic Lighting for unity.</p>\n\n<ol>\n<li>One of the main asset used for 2d lighting in unity essentials is <a href=\"https://assetstore.unity.com/packages/tools/particles-effects/2ddl-pro-2d-dynamic-lights-and-shadows-25933\" rel=\"nofollow noreferrer\">DDL light</a>, with an official tutorial <a href=\"https://learn.unity.com/tutorial/recorded-video-session-2d-essentials-pack\" rel=\"nofollow noreferrer\">here</a>.</li>\n<li>Most importantly Unity itself is working on a Dynamic lighting system, currently in beta (for 2019.2). Unity introduced the package Lightweight RP for 2d lights <a href=\"https://forum.unity.com/threads/experimental-2d-lights-and-shader-graph-support-in-lwrp.683623/\" rel=\"nofollow noreferrer\">here</a> and there's a tutorial <a href=\"https://www.youtube.com/watch?v=nkgGyO9VG54\" rel=\"nofollow noreferrer\">here</a>.</li>\n</ol>\n"}], "owner": {"reputation": 7673, "user_id": 6086226, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/fQU1t.jpg?s=128&g=1", "display_name": "Derk Jan Speelman", "link": "https://stackoverflow.com/users/6086226/derk-jan-speelman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3922, "favorite_count": 2, "accepted_answer_id": 56983287, "answer_count": 2, "score": 8, "last_activity_date": 1565867316, "creation_date": 1521065356, "last_edit_date": 1565867316, "question_id": 49288411, "link": "https://stackoverflow.com/questions/49288411/unity-2d-shader-lighting-like-terraria-or-starbound", "title": "Unity - 2D shader / lighting like Terraria or Starbound", "body": "<p>I have a map with a lot of sprites. I could add a material to the sprite with diffuse shading and than add lots of lights. But that won't give me the result I want. And is performance heavy.</p>\n\n<hr>\n\n<h2>Examples</h2>\n\n<p>In the first image you can see that light is generated by torches. It's expanding its light at its best through 'open spaces' and it is stopped by blocks fairly quickly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8Sm4g.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Sm4g.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Here is a great example of the top layer. We can see some kind of 2D directional light? Please note that the lighting inside the house is generated by torches again. The cave on the right side shows a better example of how light is handled. Also, note the hole in the background, this is generating some extra light into the cave. As if the light is really shining through the background there.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ibtqE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ibtqE.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2>What I have</h2>\n\n<p>You can clearly see the issue here. Lights increase their intensity. And light creates a squared edge around some of the tiles for some reason. Also, lots of lights will cause performance issues very quickly.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OZWtH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OZWtH.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2>Raycasting?</h2>\n\n<p>I read that you can somehow use raycasting? To target 'open space' or something? I have no experience with shaders or with lighting in games at all. I'd love a well-explained answer with how to achieve this Terraria/Starbound lighting effect. This does not mean I'm saying that raycasting is the solution.</p>\n\n<hr>\n\n<h2>Minecraft</h2>\n\n<p>In Minecraft, light can travel for a certain amount of air blocks. It gradually fades to completely dark. In the Graphic settings you can enable <code>Smooth Lightning</code>, which will (obviously) smooth the lightning on the blocks.</p>\n\n<p>I guess this is done with shaders, but I'm not sure. My guess is that this is performance heavy. But I'm thinking about air blocks (which are gameobjects) and maybe I have the wrong logic.</p>\n\n<hr>\n\n<p><strong>Note:</strong> I love a helpful answer, but please provide a link with a detailed explanation. Or provide an explanation with source code or links to the Unity docs in your answer. I wouldn't like to see theories worked out or something. I'd love to get an answer on how to implement this kind of lighting in Unity.</p>\n\n<p>I'd also like to know if it's possible to <em>NOT</em> use a package from the Unity Marketplace.</p>\n\n<hr>\n\n<h2>Similar, but no good</h2>\n\n<p>Take a look at similar posts with links to articles that cover the basics of raycasting. But no explanation on how to implement this in Unity and not the Terraria/Starbound effect I'd like to achieve:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/41443130/make-pixel-lighting-like-terraria-and-starbound\">Make pixel lighting like terraria and starbound</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/31736654/how-to-achieve-terraria-starbound-2d-lighting\">How to achieve Terraria/Starbound 2d lighting?</a></p>\n\n<hr>\n\n<h2>Video impression</h2>\n\n<p>For example, take a look at this video for a really good impression on how 2d light works in Starbound:</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=F5d-USf69SU\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=F5d-USf69SU</a></p>\n\n<p>I know this is a bit more advanced, but also the point light generated by the player's flash light is stopped by blocks and let through by the open spaces.</p>\n\n<hr>\n\n<h2>Other help forums</h2>\n\n<p>Also posted by me.</p>\n\n<p><strong>Gamedev Exchange:</strong> <a href=\"https://gamedev.stackexchange.com/questions/155440/unity-2d-shader-lighting-like-terraria-or-starbound\">https://gamedev.stackexchange.com/questions/155440/unity-2d-shader-lighting-like-terraria-or-starbound</a></p>\n\n<p><strong>Unity Forum:</strong> <a href=\"https://answers.unity.com/questions/1480518/2d-shader-lighting-like-terraria-or-starbound.html\" rel=\"nofollow noreferrer\">https://answers.unity.com/questions/1480518/2d-shader-lighting-like-terraria-or-starbound.html</a></p>\n\n<hr>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1521102118, "post_id": 49288360, "comment_id": 85591072, "body": "The data binding error message is not related to your ServerStatus binding. Do you at least see an initial &quot;false&quot; in the server_status Label?"}, {"owner": {"reputation": 3, "user_id": 9273589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bbe7a216cda09d7b87413e68aefe82e?s=128&d=identicon&r=PG&f=1", "display_name": "Frazer", "link": "https://stackoverflow.com/users/9273589/frazer"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1521119954, "post_id": 49288360, "comment_id": 85602677, "body": "Yeah, false will show when the program first loads."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9273589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bbe7a216cda09d7b87413e68aefe82e?s=128&d=identicon&r=PG&f=1", "display_name": "Frazer", "link": "https://stackoverflow.com/users/9273589/frazer"}, "edited": false, "score": 0, "creation_date": 1521121138, "post_id": 49300693, "comment_id": 85603600, "body": "Thank you, works now. Don&#39;t know how I managed to overlook such a silly mistake."}], "tags": [], "owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1521120425, "creation_date": 1521120425, "answer_id": 49300693, "question_id": 49288360, "link": "https://stackoverflow.com/questions/49288360/binding-a-static-objects-property-which-is-changed-by-a-separate-thread-to-a-lab/49300693#49300693", "title": "Binding a static objects property which is changed by a separate thread to a label in WPF", "body": "<p>You are missing the <code>event</code> keyword in the StaticPropertyChanged event declaration.</p>\n\n<p>It should be</p>\n\n<pre><code>public static event EventHandler&lt;PropertyChangedEventArgs&gt; StaticPropertyChanged;\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>public static EventHandler&lt;PropertyChangedEventArgs&gt; StaticPropertyChanged;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9273589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bbe7a216cda09d7b87413e68aefe82e?s=128&d=identicon&r=PG&f=1", "display_name": "Frazer", "link": "https://stackoverflow.com/users/9273589/frazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 49300693, "answer_count": 1, "score": 0, "last_activity_date": 1521120425, "creation_date": 1521065034, "question_id": 49288360, "link": "https://stackoverflow.com/questions/49288360/binding-a-static-objects-property-which-is-changed-by-a-separate-thread-to-a-lab", "title": "Binding a static objects property which is changed by a separate thread to a label in WPF", "body": "<p>I'm currently trying to update a label in a WPF project to display the status of a TCP server. The text box will bind to the property on startup and correctly show in the label, however i'm struggling to find a way to notify that the property has changed from another thread and update the label.   </p>\n\n<pre><code>private void startServerMultiThread() \n    {\n        try\n        {\n            Thread t = new Thread(() =&gt; MultiThreadedListener.startListening());\n            t.Start();\n        }\n        catch (Exception e)\n        {\n            showErrors(e);\n        }\n    }\n</code></pre>\n\n<p>Within MultiThreadedListener.startListening(), Status.ServerStatus is set to true after starting a new TCP listener.</p>\n\n<pre><code>public class Status\n{\n    public static EventHandler&lt;PropertyChangedEventArgs&gt; StaticPropertyChanged;\n\n    private static bool _ServerStatus = false;\n    public static bool ServerStatus\n    {\n        get { return _ServerStatus; }\n\n        set\n        {\n            if (value != _ServerStatus)\n            {\n                _ServerStatus = value;\n\n                NotifyStaticPropertyChanged(\"ServerStatus\");\n            }\n        }\n    }\n    private static void NotifyStaticPropertyChanged(string propertyName)\n    {\n        if (StaticPropertyChanged != null)\n            StaticPropertyChanged(null, new PropertyChangedEventArgs(propertyName));\n    }\n}\n</code></pre>\n\n<p>I've stepped through and found that my EventHandler is always null when ServerStatus is updated and also receiving a binding error:</p>\n\n<pre><code>System.Windows.Data Information: 10 : Cannot retrieve value using the binding and no valid fallback value exists; using default instead. BindingExpression:Path=TabStripPlacement; DataItem=null; target element is 'TabItem' (Name='serverMainTab'); target property is 'NoTarget' (type 'Object')\n</code></pre>\n\n<p>My XAML for the label:</p>\n\n<pre><code>&lt;Window x:Class=\"serverGUI.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    xmlns:local=\"clr-namespace:serverGUI\"\n    xmlns:server=\"clr-namespace:server;assembly=server\"\n\n    Title=\"MainWindow\" Height=\"386\" Width=\"418\"&gt;\n&lt;Grid&gt;\n    &lt;TabControl x:Name=\"serverTabControl\"&gt;\n        &lt;TabItem x:Name=\"serverMainTab\" Header=\"Server\"  Margin=\"-2,-2,2,0\"&gt;\n            &lt;Grid&gt;\n                &lt;!-- SERVER STATUS --&gt;\n                &lt;Label Content=\"Status:\" Margin=\"10,10,0,0\" Grid.Row=\"1\" VerticalAlignment=\"Top\" Height=\"26\" HorizontalAlignment=\"Left\" Width=\"94\"/&gt;\n                &lt;Label x:Name=\"server_status\" Content=\"{Binding Path=(server:Status.ServerStatus)}\" Grid.Column=\"1\" HorizontalAlignment=\"Left\" Height=\"23\" Margin=\"10,14,0,0\" Grid.Row=\"1\" VerticalAlignment=\"Top\" Width=\"155\" Grid.RowSpan=\"2\"/&gt;\n            &lt;/Grid&gt;\n    &lt;/TabControl&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>How would I go about making sure the WPF application is listening for events on alternate threads? is this even the correct approach to this problem or do I need to look at an alternative way? Thanks for any help.</p>\n"}, {"tags": ["c#", "sql-server", "ssis"], "comments": [{"owner": {"reputation": 54384, "user_id": 181965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87b30982fd95ba3e646522b1ced1f8cb?s=128&d=identicon&r=PG", "display_name": "billinkc", "link": "https://stackoverflow.com/users/181965/billinkc"}, "edited": false, "score": 0, "creation_date": 1521080607, "post_id": 49288322, "comment_id": 85584198, "body": "So you&#39;re going to have a list of work to be done and the above code approximately dequeues an item and assigns it out to local variables. Could you show an prototype of what you think your Control Flow task will look like? Are you open to other approaches for solving this pattern (assuming I understand it well enough)"}], "answers": [{"comments": [{"owner": {"reputation": 2773, "user_id": 3220769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/36f8c4918c0be6de21e7f0f9c5a67068?s=128&d=identicon&r=PG&f=1", "display_name": "TomNash", "link": "https://stackoverflow.com/users/3220769/tomnash"}, "edited": false, "score": 0, "creation_date": 1521122058, "post_id": 49295120, "comment_id": 85604362, "body": "This works. I also found doing a <code>Data Flow Task</code> and using a <code>Script Component</code> as a destination will work as well."}], "tags": [], "owner": {"reputation": 4746, "user_id": 1010622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f2ece15235dbd01bf59af763ad8706?s=128&d=identicon&r=PG", "display_name": "Ferdipux", "link": "https://stackoverflow.com/users/1010622/ferdipux"}, "is_accepted": true, "score": 1, "last_activity_date": 1521104457, "creation_date": 1521104457, "answer_id": 49295120, "question_id": 49288322, "link": "https://stackoverflow.com/questions/49288322/convert-oledb-rowset-to-queue-object-in-order-to-multithread-and-lock/49295120#49295120", "title": "Convert OLEDB Rowset to Queue object in order to multithread and lock", "body": "<p><strong>Execute SQL Query</strong> stores full result set as OleDB Recordset. You cannot cast it to a <em>Queue</em> of strings, even if OleDB recordset contains only one column. So, you have to process OleDB object inside <strong>Script Task</strong>, filling in your Queue.<br>\nThe following code sample fragment can process OleDB Object variable</p>\n\n<pre><code>using System.Data.OleDb;\n\nDataTable dt = new DataTable();\nOleDbDataAdapter adapter = new OleDbDataAdapter();\nadapter.Fill(dt, Dts.Variables[\"User::CoreTables\"].Value);\n\nforeach (DataRow row in dt.Rows)\n{\n    //process datatable row here\n}\n</code></pre>\n"}], "owner": {"reputation": 2773, "user_id": 3220769, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/36f8c4918c0be6de21e7f0f9c5a67068?s=128&d=identicon&r=PG&f=1", "display_name": "TomNash", "link": "https://stackoverflow.com/users/3220769/tomnash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 49295120, "answer_count": 1, "score": 0, "last_activity_date": 1521104457, "creation_date": 1521064884, "question_id": 49288322, "link": "https://stackoverflow.com/questions/49288322/convert-oledb-rowset-to-queue-object-in-order-to-multithread-and-lock", "title": "Convert OLEDB Rowset to Queue object in order to multithread and lock", "body": "<p>I have an <code>Execute SQL Task</code> that returns a table of data using <code>Full Result Set</code> used to drive other child processes in parallel. The problem is needing locks on the <code>Object</code> so each is processed only once. How can I access the <code>Object</code> variable in a C# Script Task and convert into a Queue datatype in order to lock?</p>\n\n<p>The <code>Execute SQL Task</code> stores the results in <code>User::CoreTables</code>, then I want to get the value in the first row each time:</p>\n\n<pre><code>// The line that fails to do the conversion, not sure how to do this\nSystem.Collections.Generic.Queue&lt;string&gt; tablesQueue = (System.Collections.Generic.Queue&lt;string&gt;)Dts.Variables[\"User::CoreTables\"].Value;\n\nlock (tablesQueue)\n{\n    //If number of rows in queue is greater than 0 then dequeue row for processing\n    //and set DoWork to true. Otherwise set DoWork to false as there is nothing to process\n    if (tablesQueue.Count &gt; 0)\n    {\n        Dts.Variables[\"User::TableToProcess\"].Value = tablesQueue.Dequeue();\n        Dts.Variables[\"User::DoWork\"].Value = true;\n    }\n    else\n    {\n        Dts.Variables[\"User::DoWork\"].Value = false;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "performance", "entity-framework", "linq"], "comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1521064894, "post_id": 49288265, "comment_id": 85579714, "body": "It isn&#39;t clear to me what you want to sort by? What order do you want it in?"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1521065023, "post_id": 49288265, "comment_id": 85579778, "body": "If you have a <code>List&lt;Record&gt; records</code> variable, you can just do something like: <code>var sortedRecords = records.OrderBy(r =&gt; r.ID);</code> But it&#39;s not clear what you want exactly."}, {"owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521065083, "post_id": 49288265, "comment_id": 85579812, "body": "My apologies, I&#39;m trying sort by the order that would be created when iterating a building the list.  For instance, the record with ChildID = null, is the last one in the list, since it does not have a child.  I&#39;ll start with that record, then get the next one above it that references the previous as its ChildID."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1521065274, "post_id": 49288265, "comment_id": 85579907, "body": "Please update the question with what you are trying to do since not everyone will see your comment. What <i>exactly</i> are you sorting? Do you have a <code>List&lt;Record&gt;</code> or just a single <code>Record</code> that has linked children? What if two records have the same <code>ChildId</code>?"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1521065566, "post_id": 49288265, "comment_id": 85580026, "body": "What do you mean by <i>&quot;the record with ChildID == null&quot;</i>? GUIDs (and ints) are struct types and cannot be <code>null</code>."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1521066431, "post_id": 49288265, "comment_id": 85580379, "body": "Do you want to try to do this on the SQL server? If you are querying the database and get partial results, could you have fractional portions of the linked list?"}, {"owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521067243, "post_id": 49288265, "comment_id": 85580691, "body": "I&#39;d like to do it within the code but I&#39;m not opposed to doing it in SQL."}], "answers": [{"comments": [{"owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521067709, "post_id": 49288697, "comment_id": 85580858, "body": "While this may not be exactly what I was looking for, I may be able to leverage this and make it work.  Thanks! I&#39;ll give it a shot in a bit and let you know how it ends up!"}, {"owner": {"reputation": 14930, "user_id": 395718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1323cdc2a70698b5275082bf6e61184?s=128&d=identicon&r=PG", "display_name": "Dialecticus", "link": "https://stackoverflow.com/users/395718/dialecticus"}, "edited": false, "score": 0, "creation_date": 1521071391, "post_id": 49288697, "comment_id": 85581952, "body": "If list is really big then using temporary <code>Dictionary&lt;int, Record&gt;</code> could speed up the chaining."}], "tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": false, "score": 2, "last_activity_date": 1521066825, "creation_date": 1521066825, "answer_id": 49288697, "question_id": 49288265, "link": "https://stackoverflow.com/questions/49288265/custom-orderby-in-linq-with-singly-linked-entity-list/49288697#49288697", "title": "Custom OrderBy in Linq with singly linked entity list", "body": "<p>One way to do it would be to write a method that will return a list in sorted order. You would first find the record with <code>ChildId == null</code>, add it to the results list, and then continue to search for items where <code>item.ChildId == previousItem.Id</code>, and then insert them at the beginning of the list:</p>\n\n<pre><code>private static IEnumerable&lt;Record&gt; OrderRecords(IReadOnlyCollection&lt;Record&gt; records)\n{\n    // \"Exit fast\" checks\n    if (records == null) return null;\n    if (records.Count &lt; 2) return records.ToList();\n\n    // Get last record and add it to our results\n    Record currentRecord = records.Single(r =&gt; r.ChildID == null);\n    var results = new List&lt;Record&gt; {currentRecord};\n\n    // Keep getting the parent reference to the previous record \n    // and insert it at the beginning of the results list\n    while ((currentRecord = records.SingleOrDefault(r =&gt; \n        r.ChildID == currentRecord.ID)) != null)\n    {\n        results.Insert(0, currentRecord);\n    }\n\n    return results;\n}\n</code></pre>\n\n<p>In use, this would look something like:</p>\n\n<pre><code>private static void Main()\n{\n    var records = new List&lt;Record&gt;\n    {\n        new Record {ID = 3, Name = \"Apple\", ChildID = 6},\n        new Record {ID = 54, Name = \"Orange\", ChildID = 3},\n        new Record {ID = 6, Name = \"Banana\", ChildID = null}\n    };\n\n    var sortedRecords = OrderRecords(records);\n\n    Console.WriteLine(string.Join(\", \", sortedRecords.Select(r =&gt; r.Name)));\n\n    Console.Write(\"\\nPress any key to exit...\");\n    Console.ReadKey();\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Qd1QI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qd1QI.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521069365, "post_id": 49288942, "comment_id": 85581358, "body": "I think this is exactly what I was looking for.  Thank you! I&#39;ll test it out in a bit and let you know how it goes."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521070873, "post_id": 49288942, "comment_id": 85581809, "body": "@jgabb I added a more efficient version. I don&#39;t particularly like its inelegance versus recursion, but couldn&#39;t come up with a better way to be efficient."}, {"owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521072368, "post_id": 49288942, "comment_id": 85582232, "body": "I like it.  It looks like its going to be exactly what I need."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521072594, "post_id": 49288942, "comment_id": 85582307, "body": "Some testing shows with 100,000 records recursion doesn&#39;t blow up but is only about 7% faster, so I think this is good. It is also at least 9 times faster than the previous answer."}, {"owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521084905, "post_id": 49288942, "comment_id": 85585105, "body": "So this cache&#39;s it, right? I&#39;ve noticed when I go and resort the order of records, it keeps the previous sort order."}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1521086461, "post_id": 49288942, "comment_id": 85585427, "body": "@NetMage You seriously? This is extremely inefficient. And static <code>Dictionary</code> inside the class - how about multi threading or second time run."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1521136017, "post_id": 49288942, "comment_id": 85614307, "body": "@IvanStoev suggest how to multi-thread depth in a singly linked list? And using persistent storage is a trade-off at well that depends on factors we don&#39;t know, but it can be more inefficient or expensive."}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1521137236, "post_id": 49288942, "comment_id": 85614995, "body": "I meant the whole idea to build &quot;depth&quot; of a linked list element and then order by it is weird. The effort to build the depth (wtf is this - index of the element in the linked list?) is much bigger than creating the linked list. For 100K records your &quot;optimized&quot; algorithm runs in about a minute, while mine (thread safe stateless) runs in milliseconds. And for 1M records your never ends :)"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1521139611, "post_id": 49288942, "comment_id": 85616227, "body": "@IvanStoev It seems like your comment is more aimed at the original question in that case, so it doesn&#39;t seem relevant."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1521160586, "post_id": 49288942, "comment_id": 85624865, "body": "@IvanStoev Interestingly, adding a <code>recordByNextId</code> (parent?) <code>Dictionary</code> to my code speeds it up to 3x slower than yours, but that would read the entire table which may not be needed. It will complete with 1M records, just takes a while :)"}], "tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": true, "score": 1, "last_activity_date": 1521070830, "last_edit_date": 1521070830, "creation_date": 1521068251, "answer_id": 49288942, "question_id": 49288265, "link": "https://stackoverflow.com/questions/49288265/custom-orderby-in-linq-with-singly-linked-entity-list/49288942#49288942", "title": "Custom OrderBy in Linq with singly linked entity list", "body": "<p>Given that the record ID order is random, and assuming that the <code>List</code> you are ordering is complete, or that you won't run out of memory/time if you have to scan the entire table to order the list, I think the best you can do is compute the depth for a <code>Record</code> and cache the results:</p>\n\n<p>I am using the <code>List</code> as the table, but you could use the table instead if the list you want to order is incomplete:</p>\n\n<pre><code>public partial class Record {\n    static Dictionary&lt;int, int&gt; depth = new Dictionary&lt;int, int&gt;();\n    public int Depth(List&lt;Record&gt; dbTable) {\n        int ans = 0;\n\n        var working = new Queue&lt;int&gt;();\n        var cur = this;\n        do {\n            if (depth.TryGetValue(cur.ID, out var curDepth)) {\n                ans += curDepth;\n                break;\n            }\n            else {\n                working.Enqueue(cur.ID);\n                cur = dbTable.FirstOrDefault(r =&gt; r.ChildID == cur.ID);\n                if (cur != null)\n                    ++ans;\n            }\n        } while (cur != null);\n\n        var workAns = ans;\n        while (working.Count &gt; 0) {\n            var workingID = working.Dequeue();\n            depth.Add(workingID, workAns);\n            --workAns;\n        }\n\n        return ans;\n    }\n}\n</code></pre>\n\n<p><strong>Update:</strong> I re-wrote the code to use a specific queue; my first version was recursive and that was straightforward but risked overflowing the stack and my second version didn't cache the intermediate results when following the linked list which wasn't very efficient. Using a queue of the intermediate IDs ensures I only follow a particular chain depth once.</p>\n\n<p>Now that you have a <code>Depth</code> method, sorting is easy:</p>\n\n<pre><code>var ans = work.OrderBy(w =&gt; w.Depth(work));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521090140, "post_id": 49291340, "comment_id": 85586450, "body": "How would i use this in a linq query?"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "reply_to_user": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "edited": false, "score": 0, "creation_date": 1521098636, "post_id": 49291340, "comment_id": 85589552, "body": "Well, like any custom method.  You can even put it in a public static class, change the signature to <code>public static Record[] Ordered(this IEnumerable&lt;Record&gt; records)</code>, in other words, turn it to custom extension method. Then you can use like any LINQ to Objects method, e.g. (following the style of other answer) <code>var ans = work.Ordered();</code>. The main focus here is the performance - for 100,000 records this executes in milliseconds."}, {"owner": {"reputation": 14930, "user_id": 395718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1323cdc2a70698b5275082bf6e61184?s=128&d=identicon&r=PG", "display_name": "Dialecticus", "link": "https://stackoverflow.com/users/395718/dialecticus"}, "edited": false, "score": 0, "creation_date": 1521108699, "post_id": 49291340, "comment_id": 85595186, "body": "Another way to handle null key is to <i>not</i> put it in dictionary and just save it on the side."}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "reply_to_user": {"reputation": 14930, "user_id": 395718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f1323cdc2a70698b5275082bf6e61184?s=128&d=identicon&r=PG", "display_name": "Dialecticus", "link": "https://stackoverflow.com/users/395718/dialecticus"}, "edited": false, "score": 0, "creation_date": 1521109429, "post_id": 49291340, "comment_id": 85595656, "body": "@Dialecticus Sure, but that adds complexity to the code which I think is not worth. Another way is to eliminate the nullable by using the <code>default</code> (<code>0</code>, <code>Guid.Empty</code> etc) as <code>null</code> substitute if it&#39;s not allowed in the keys. And finally, in my projects I use custom <code>Dictionary</code> implementation which has no such limitations :) Interestingly, <code>Lookup</code> has no such requirement either."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1521139924, "post_id": 49291340, "comment_id": 85616376, "body": "While very fast, this doesn&#39;t seem to handle partial <code>List</code>s from a larger database. I also wonder how optimal it is with a database in general. I also get a type conflict on <code>class ValueWrapper</code> and <code>struct ValueWrapper&lt;T&gt;</code> but that might be my environment."}], "tags": [], "owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "is_accepted": false, "score": 1, "last_activity_date": 1521086321, "creation_date": 1521086321, "answer_id": 49291340, "question_id": 49288265, "link": "https://stackoverflow.com/questions/49288265/custom-orderby-in-linq-with-singly-linked-entity-list/49291340#49291340", "title": "Custom OrderBy in Linq with singly linked entity list", "body": "<p>The best algorithm for this task is to prepare a fast lookup data structure (like <code>Dictionary</code>) of <code>Record</code> by <code>ChildID</code>. Then the ordered result can be produced backwards starting with <code>ChildID = null</code> and using the record <code>ID</code> to find the previous record.</p>\n\n<p>Since the hash lookup time complexity is O(1), the time complexity of the algorithm is linear O(N) - the fastest possible.</p>\n\n<p>Here is the implementation:</p>\n\n<pre><code>static Record[] Ordered(IEnumerable&lt;Record&gt; records)\n{\n    var recordByNextId = records.ToDictionary(e =&gt; e.ChildID.Wrap());\n    var result = new Record[recordByNextId.Count];\n    int? nextId = null;\n    for (int i = result.Length - 1; i &gt;=0; i--)\n        nextId = (result[i] = recordByNextId[nextId]).ID;\n    return result;\n}\n</code></pre>\n\n<p>The explanation of <code>e.ChildID.Wrap()</code> custom extension method. I wish I can use simply <code>e.ChildID</code>, but the BCL <code>Dictionary</code> class throws annoying exception for <code>null</code> key. To overcome that limitation in general, I use a simple wrapper <code>struct</code> and \"fluent\" helper:</p>\n\n<pre><code>public struct ValueWrapper&lt;T&gt; : IEquatable&lt;ValueWrapper&lt;T&gt;&gt;\n{\n    public readonly T Value;\n    public ValueWrapper(T value) =&gt; Value = value;\n    public bool Equals(ValueWrapper&lt;T&gt; other) =&gt; EqualityComparer&lt;T&gt;.Default.Equals(Value, other.Value);\n    public override bool Equals(object obj) =&gt; obj is ValueWrapper&lt;T&gt; other &amp;&amp; Equals(other);\n    public override int GetHashCode() =&gt; EqualityComparer&lt;T&gt;.Default.GetHashCode(Value);\n    public static implicit operator ValueWrapper&lt;T&gt;(T x) =&gt; new ValueWrapper&lt;T&gt;(x);\n    public static implicit operator T(ValueWrapper&lt;T&gt; x) =&gt; x.Value;\n}\n\npublic static class ValueWrapper\n{\n    public static ValueWrapper&lt;T&gt; Wrap&lt;T&gt;(this T value) =&gt; new ValueWrapper&lt;T&gt;(value);\n}\n</code></pre>\n"}], "owner": {"reputation": 508, "user_id": 4139940, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/G5us7.jpg?s=128&g=1", "display_name": "jgabb", "link": "https://stackoverflow.com/users/4139940/jgabb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 49288942, "answer_count": 3, "score": 1, "last_activity_date": 1521086321, "creation_date": 1521064644, "last_edit_date": 1521065667, "question_id": 49288265, "link": "https://stackoverflow.com/questions/49288265/custom-orderby-in-linq-with-singly-linked-entity-list", "title": "Custom OrderBy in Linq with singly linked entity list", "body": "<p>I'm trying to come up with an efficient solution to be able to query the entity list and order it correctly. I have created a singly linked list type structure in SQL DB schema.  I am using GUID as my IDs but for simplicity, I'll use int here.  I could solve this problem easily by having a SortOrder column on the DB but because of other requirements, this is how I have to implement this table.  </p>\n\n<p>I have a table structure that looks like the following entity model:</p>\n\n<pre><code>public class Record\n{\n    public int ID;\n    public string Name;\n    public int? ChildID;  //References the next record\n}\n</code></pre>\n\n<p>My initial thought is to create a partial class like the following:</p>\n\n<pre><code>public partial class Record\n{\n    public int SortOrder\n    {\n        get\n        {\n           //query table and loop through the entire list building it from\n           //the bottom and keeping count of the integer sort order and return \n           //the one specific to this record\n        }\n    }\n}\n</code></pre>\n\n<p>However, this seems very inefficient to have to query the entire list every time and iterate through to find the SortOrder.  Is there anything else I can leverage  like a custom OrderBy function or anything?  I'm trying sort by the order that would be created when iterating a building the list. For instance, the record with ChildID = null, is the last one in the list, since it does not have a child. I'll start with that record, then get the next one above it that references the previous as its ChildID and go until there is no more in the list that has a reference to ID, which should be when the list is complete and ordered correctly. No two records have the same ChildID.</p>\n\n<p>If I had the following 3 records in a list,</p>\n\n<pre><code>ID = 3,  Name = \"Apple\",  ChildID = 6,\nID = 54, Name = \"Orange\", ChildID = 3,\nID = 6,  Name = \"Banana\", ChildID = null\n</code></pre>\n\n<p>Then I would expect to get Orange, Apple, Banana, in that order.</p>\n"}, {"tags": ["c#", "xamarin.forms"], "comments": [{"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1521065205, "post_id": 49288233, "comment_id": 85579872, "body": "What happens when you try it?"}, {"owner": {"reputation": 308, "user_id": 9241603, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WbMseI3QtrY/AAAAAAAAAAI/AAAAAAAABCM/alNAxkNqADw/photo.jpg?sz=128", "display_name": "Dreyser Eguia", "link": "https://stackoverflow.com/users/9241603/dreyser-eguia"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1521065723, "post_id": 49288233, "comment_id": 85580101, "body": "I get an exception:  Unhandled Exception: System.ArgumentException: Object of type &#39;System.String&#39; cannot be converted to type &#39;Xamarin.Forms.View&#39;."}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 1, "creation_date": 1521065953, "post_id": 49288233, "comment_id": 85580192, "body": "What value are you trying to bind?  Are you sure it&#39;s not a problem with your XAML?"}, {"owner": {"reputation": 308, "user_id": 9241603, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WbMseI3QtrY/AAAAAAAAAAI/AAAAAAAABCM/alNAxkNqADw/photo.jpg?sz=128", "display_name": "Dreyser Eguia", "link": "https://stackoverflow.com/users/9241603/dreyser-eguia"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1521066207, "post_id": 49288233, "comment_id": 85580283, "body": "I think so, I replaced that boxview line with a simple label just to show the value of that binded property &quot;PctLocal&quot; and it&#180;s displayed correctly. So the rest of xaml code works, except for that particular line."}, {"owner": {"reputation": 2657, "user_id": 510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f19cf44ce7875a3a44a01a4bb0b3c725?s=128&d=identicon&r=PG", "display_name": "Mikolaj Kieres", "link": "https://stackoverflow.com/users/510627/mikolaj-kieres"}, "edited": false, "score": 1, "creation_date": 1521066907, "post_id": 49288233, "comment_id": 85580551, "body": "I&#39;m not perfectly sure about this, but your problem might be related to the fact that you&#39;re trying to bind a string to a property of type double (<a href=\"https://developer.xamarin.com/api/property/Xamarin.Forms.VisualElement.HeightRequest/\" rel=\"nofollow noreferrer\">HeightRequest docs</a>). Try binding a double"}, {"owner": {"reputation": 308, "user_id": 9241603, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WbMseI3QtrY/AAAAAAAAAAI/AAAAAAAABCM/alNAxkNqADw/photo.jpg?sz=128", "display_name": "Dreyser Eguia", "link": "https://stackoverflow.com/users/9241603/dreyser-eguia"}, "edited": false, "score": 0, "creation_date": 1521067069, "post_id": 49288233, "comment_id": 85580617, "body": "Just did another test, replacing binding by a static height value and get the same error, seems that you are right issue is somewhere else"}, {"owner": {"reputation": 2238, "user_id": 9531816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67595c1074f912c1f36486d9d7e5ea5d?s=128&d=identicon&r=PG&f=1", "display_name": "Yang You", "link": "https://stackoverflow.com/users/9531816/yang-you"}, "edited": false, "score": 0, "creation_date": 1521110538, "post_id": 49288233, "comment_id": 85596442, "body": "one of debugging tips is to comment some code section and see if the error still happens. If the error is still there, comment other part of code section."}, {"owner": {"reputation": 524, "user_id": 9300678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7GCGZ.jpg?s=128&g=1", "display_name": "Stemado", "link": "https://stackoverflow.com/users/9300678/stemado"}, "edited": false, "score": 1, "creation_date": 1550778988, "post_id": 49288233, "comment_id": 96406841, "body": "Is the issue your semi-colon at the end of your BoxView, or just a typo?  <code>...WidthRequest=&quot;15&quot;&#47;&gt;;</code>"}], "owner": {"reputation": 308, "user_id": 9241603, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WbMseI3QtrY/AAAAAAAAAAI/AAAAAAAABCM/alNAxkNqADw/photo.jpg?sz=128", "display_name": "Dreyser Eguia", "link": "https://stackoverflow.com/users/9241603/dreyser-eguia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 318, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1521064477, "creation_date": 1521064477, "question_id": 49288233, "link": "https://stackoverflow.com/questions/49288233/how-can-i-bind-boxview-height-in-xamarin-forms", "title": "How can I bind boxview height in xamarin forms?", "body": "<p>I\u00b4m trying to draw something like a small bar chart using boxview control inside a listview (template with columns). So in one column of each item I want to draw the boxview with variable height (depending on a variable value)</p>\n\n<p>Something like this:</p>\n\n<pre><code>&lt;ListView x:Name=\"lstView\" RowHeight=\"75\"&gt;\n                      &lt;ListView.ItemTemplate&gt;\n                              &lt;DataTemplate&gt;\n\n                                 &lt;ViewCell &gt;\n                                    &lt;Grid RowSpacing=\"0\"&gt;\n                                        &lt;Grid.RowDefinitions&gt;\n                                            &lt;RowDefinition Height=\"*\" /&gt;\n                                            &lt;RowDefinition Height=\"*\" /&gt;\n                                        &lt;/Grid.RowDefinitions&gt;\n                                        &lt;Grid.ColumnDefinitions&gt;\n                                            &lt;ColumnDefinition Width=\"*\"/&gt;\n                                            &lt;ColumnDefinition Width=\"*\"/&gt;\n                                            &lt;ColumnDefinition Width=\"*\"/&gt;\n                                            &lt;ColumnDefinition Width=\"*\"/&gt;\n                                            &lt;ColumnDefinition Width=\"*\" /&gt;\n                                            &lt;ColumnDefinition Width=\"*\" /&gt;\n                                         &lt;/Grid.ColumnDefinitions&gt;\n\n                                            &lt;Label Text=\"{Binding Local}\"  VerticalTextAlignment=\"End\" HorizontalTextAlignment=\"Center\" Grid.Row=\"0\" Grid.Column=\"1\" FontSize=\"10\" TextColor=\"Navy\" /&gt;\n                                            &lt;Label Text=\"Empate\" Grid.Row=\"0\" VerticalTextAlignment=\"End\" HorizontalTextAlignment=\"Center\" Grid.Column=\"3\"  FontSize=\"10\" TextColor=\"Navy\"/&gt;\n                                            &lt;Label Text=\"{Binding Visitante}\" VerticalTextAlignment=\"End\" HorizontalTextAlignment=\"Center\" Grid.Row=\"0\" Grid.Column=\"5\" FontSize=\"10\" TextColor=\"Navy\"/&gt;\n                                            **&lt;BoxView Grid.Row=\"0\" Grid.Column=\"5\" HeightRequest=\"{Binding PctLocal}\" WidthRequest=\"15\"/&gt;;**\n                                            &lt;Label Text=\"{Binding PctEmpate}\" VerticalTextAlignment=\"End\" HorizontalTextAlignment=\"Center\"   Grid.Row=\"0\" Grid.Column=\"2\" FontSize=\"10\" /&gt;\n                                            &lt;Label Text=\"{Binding PctVisitante}\" VerticalTextAlignment=\"End\" HorizontalTextAlignment=\"Center\"   Grid.Row=\"0\" Grid.Column=\"4\" FontSize=\"10\" /&gt;\n                                            &lt;Label Text=\"{Binding LocalSupporters}\" VerticalTextAlignment=\"Center\" HorizontalTextAlignment=\"Center\" Grid.ColumnSpan=\"2\"  Grid.Row=\"1\" Grid.Column=\"0\" FontSize=\"10\" /&gt;\n                                            &lt;Label Text=\"{Binding DrawSupporters}\" VerticalTextAlignment=\"Center\" HorizontalTextAlignment=\"Center\"  Grid.Row=\"1\" Grid.Column=\"2\" Grid.ColumnSpan=\"2\" FontSize=\"10\" /&gt;\n                                            &lt;Label Text=\"{Binding AwaySupporters}\" VerticalTextAlignment=\"Center\" HorizontalTextAlignment=\"Center\" Grid.Row=\"1\" Grid.Column=\"4\" Grid.ColumnSpan=\"2\" FontSize=\"10\" /&gt;\n                                    &lt;/Grid&gt;\n                                &lt;/ViewCell&gt;\n                              &lt;/DataTemplate&gt;\n                        &lt;/ListView.ItemTemplate&gt;\n                &lt;/ListView&gt;\n</code></pre>\n\n<p>How can I achieve that?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "razor"], "comments": [{"owner": {"reputation": 628, "user_id": 2376693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bff07bc24ec76aaaaa6e2a2bb56a576e?s=128&d=identicon&r=PG", "display_name": "EnvelopedDevil", "link": "https://stackoverflow.com/users/2376693/envelopeddevil"}, "edited": false, "score": 0, "creation_date": 1521064533, "post_id": 49288193, "comment_id": 85579564, "body": "I am pretty new to the whole ASP.NET thing. the project is made from the Web Application template"}, {"owner": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521064679, "post_id": 49288193, "comment_id": 85579629, "body": "Where is your razor page c# code? are your rendering the view?"}, {"owner": {"reputation": 628, "user_id": 2376693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bff07bc24ec76aaaaa6e2a2bb56a576e?s=128&d=identicon&r=PG", "display_name": "EnvelopedDevil", "link": "https://stackoverflow.com/users/2376693/envelopeddevil"}, "reply_to_user": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521064798, "post_id": 49288193, "comment_id": 85579677, "body": "the file is a .cshtml file so it the HTML file is backed by a .cs file. The view is rendered and it gets the values from the collection properly"}, {"owner": {"reputation": 628, "user_id": 2376693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bff07bc24ec76aaaaa6e2a2bb56a576e?s=128&d=identicon&r=PG", "display_name": "EnvelopedDevil", "link": "https://stackoverflow.com/users/2376693/envelopeddevil"}, "reply_to_user": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521064895, "post_id": 49288193, "comment_id": 85579715, "body": "@Coding I added the whole cshtml file as is in VS if it helps"}, {"owner": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521064991, "post_id": 49288193, "comment_id": 85579761, "body": "please paste you code behind for the view, since you should create you actions there"}, {"owner": {"reputation": 628, "user_id": 2376693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bff07bc24ec76aaaaa6e2a2bb56a576e?s=128&d=identicon&r=PG", "display_name": "EnvelopedDevil", "link": "https://stackoverflow.com/users/2376693/envelopeddevil"}, "reply_to_user": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521065188, "post_id": 49288193, "comment_id": 85579866, "body": "@Coding those are the two parts of the cshtml file"}, {"owner": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521066941, "post_id": 49288193, "comment_id": 85580562, "body": "Well there are lot of things. You need to add a form to your view and submit button. Then, create an action in your code behind that expects the parameter you want to pass. you need to ask more specific things, so people can help you"}, {"owner": {"reputation": 628, "user_id": 2376693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bff07bc24ec76aaaaa6e2a2bb56a576e?s=128&d=identicon&r=PG", "display_name": "EnvelopedDevil", "link": "https://stackoverflow.com/users/2376693/envelopeddevil"}, "reply_to_user": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 0, "creation_date": 1521067182, "post_id": 49288193, "comment_id": 85580663, "body": "well my idea was to just get it on selection change if possible"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 3650894, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eh5Qc.png?s=128&g=1", "display_name": "max_dev", "link": "https://stackoverflow.com/users/3650894/max-dev"}, "is_accepted": true, "score": 1, "last_activity_date": 1521077833, "creation_date": 1521077833, "answer_id": 49290236, "question_id": 49288193, "link": "https://stackoverflow.com/questions/49288193/get-selected-value-from-html-control/49290236#49290236", "title": "Get selected value from HTML control", "body": "<p>you can use Javascript/Jquery and add an onchange event listener that can make a Ajax call and pass it's value to the controller. similar to the code below: </p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n// assuming you're using jQuery\n$(\"#selectedCity\").change( function (event) {\n    $.ajax({\n        url: \"Controller/PostDropdown/\",\n        data: { id = $(this).val() },\n        type: \"POST\",\n        dataType: \"html\",\n        success: function (data, textStatus, XMLHttpRequest) {\n             // do something \n        }\n    });\n});\n</code></pre>\n\n<p></p>\n"}, {"tags": [], "owner": {"reputation": 891, "user_id": 2971851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8L3Hr.jpg?s=128&g=1", "display_name": "Steven Chou", "link": "https://stackoverflow.com/users/2971851/steven-chou"}, "is_accepted": false, "score": 1, "last_activity_date": 1521081413, "creation_date": 1521081413, "answer_id": 49290695, "question_id": 49288193, "link": "https://stackoverflow.com/questions/49288193/get-selected-value-from-html-control/49290695#49290695", "title": "Get selected value from HTML control", "body": "<p>You should wrap select with form. When form was submitted, it will call your controller.</p>\n\n<p>see this\uff1a\n<a href=\"https://stackoverflow.com/questions/14124324/submitting-form-and-pass-data-to-controller-method-of-type-filestreamresult\">Submitting form and pass data to controller method of type FileStreamResult</a></p>\n"}], "owner": {"reputation": 628, "user_id": 2376693, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bff07bc24ec76aaaaa6e2a2bb56a576e?s=128&d=identicon&r=PG", "display_name": "EnvelopedDevil", "link": "https://stackoverflow.com/users/2376693/envelopeddevil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 49290236, "answer_count": 2, "score": 0, "last_activity_date": 1521081413, "creation_date": 1521064298, "last_edit_date": 1521065171, "question_id": 49288193, "link": "https://stackoverflow.com/questions/49288193/get-selected-value-from-html-control", "title": "Get selected value from HTML control", "body": "<p>I am new to the web side of things and I am currently struggling with Razor Pages. Can someone explain the ways I can get a value from  control in this case.</p>\n\n<p>How can I extract the content of the selected  and pass it to a variable to the code behind;</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>@page\r\n@model ViewToVM.Pages.IndexModel\r\n@{\r\n    ViewData[\"Title\"] = \"Index\";\r\n}\r\n\r\n&lt;h2&gt;Index&lt;/h2&gt;\r\n&lt;section id=\"cityList\"&gt;\r\n\t&lt;select id=\"selectedCity\"&gt;\r\n\t\t@using Model;\r\n\t\t@foreach(City city in Model.Cities)\r\n\t\t{\r\n\t\t\t&lt;option&gt;@city.SelectedCity&lt;/option&gt;\r\n\t\t}\r\n\t&lt;/select&gt;\r\n&lt;/section&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>with this code behind</p>\n\n<pre><code>using Microsoft.AspNetCore.Mvc.RazorPages;\nusing System.Collections.Generic;\nusing ViewToVM.Model;\n\nnamespace ViewToVM.Pages\n{\n    public class IndexModel : PageModel\n    {\n        public List&lt;City&gt; Cities = new List&lt;City&gt;()\n        {\n            new City(\"Sofia\"),\n            new City(\"Plovdiv\"),\n            new City(\"Velingrad\")\n        };\n        public string selectedCities = string.Empty;\n\n        public void OnGet()\n        {\n\n        }\n    }\n}\n</code></pre>\n\n<p>The City class just contains a single string for demo purposes. I know this is probably a pretty bad way to do the code behind but It help me illustrate the problem better. </p>\n"}, {"tags": ["c#", "xamarin", "xamarin.ios", "multipeer-connectivity"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 1, "creation_date": 1521064285, "post_id": 49288121, "comment_id": 85579483, "body": "So... are we supposed to go through the entire codebase to see what&#39;s different between one version and the other? Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 54272, "user_id": 328397, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9cc3e3bb2ff2ef30810be80ca741de70?s=128&d=identicon&r=PG", "display_name": "halfbit", "link": "https://stackoverflow.com/users/328397/halfbit"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521064418, "post_id": 49288121, "comment_id": 85579523, "body": "@CamiloTerevinto the linked, working <code>code only approach</code> is a minimal complete verifiable example (right?).  My attempt to simply port the server which is failing. I&#39;m hoping for some way to get more understanding of the iOS output."}, {"owner": {"reputation": 54272, "user_id": 328397, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9cc3e3bb2ff2ef30810be80ca741de70?s=128&d=identicon&r=PG", "display_name": "halfbit", "link": "https://stackoverflow.com/users/328397/halfbit"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521064534, "post_id": 49288121, "comment_id": 85579565, "body": "@CamiloTerevinto Since this requires two nodes (server and client), how else would you suggest I create such an example?"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1521064880, "post_id": 49288121, "comment_id": 85579707, "body": "Either post the C# Exception/Stacktrace or symbolize the native iOS crash using the msym from the build."}, {"owner": {"reputation": 54272, "user_id": 328397, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9cc3e3bb2ff2ef30810be80ca741de70?s=128&d=identicon&r=PG", "display_name": "halfbit", "link": "https://stackoverflow.com/users/328397/halfbit"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1521065820, "post_id": 49288121, "comment_id": 85580139, "body": "@SushiHangover I think I did post the C# exception from the first revision of the question through the current one. If more work is needed I&#39;ll do it. Not sure how to msym the iOS crash"}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 1373109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409a4ef6ee47b451cdd4de4adce99d3e?s=128&d=identicon&r=PG", "display_name": "Shamps", "link": "https://stackoverflow.com/users/1373109/shamps"}, "is_accepted": false, "score": 2, "last_activity_date": 1521791761, "creation_date": 1521791761, "answer_id": 49444841, "question_id": 49288121, "link": "https://stackoverflow.com/questions/49288121/xamarin-libmonosgen-2-0-dylib-required-code-signature-missing-on-mcnearbyservi/49444841#49444841", "title": "Xamarin: libmonosgen-2.0.dylib: required code signature missing on MCNearbyServiceAdvertiser", "body": "<p>In a similar situation, I've found that deleting the output folders and cleaning before building again fixes this issue.</p>\n\n<p>Right click on the Solution and select \"Delete Output Folder\" </p>\n"}], "owner": {"reputation": 54272, "user_id": 328397, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9cc3e3bb2ff2ef30810be80ca741de70?s=128&d=identicon&r=PG", "display_name": "halfbit", "link": "https://stackoverflow.com/users/328397/halfbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521791761, "creation_date": 1521063916, "last_edit_date": 1521117701, "question_id": 49288121, "link": "https://stackoverflow.com/questions/49288121/xamarin-libmonosgen-2-0-dylib-required-code-signature-missing-on-mcnearbyservi", "title": "Xamarin: libmonosgen-2.0.dylib: required code signature missing on MCNearbyServiceAdvertiser", "body": "<p>I'm using MultiPeer framework from <a href=\"https://github.com/lobrien/MultipeerConnectivity/blob/74d7bebbae91c88a1fd5f0614a6ef31cc6c6c8b6/Program.cs\" rel=\"nofollow noreferrer\">a working code-only approach</a> and moving it <a href=\"https://github.com/makerofthings7/XamarinMPBug\" rel=\"nofollow noreferrer\">into a MVVM structure</a> and am getting the exception below. </p>\n\n<p>I'm using Mac OS High Sierra on two different computers, each with an iPhone <a href=\"https://github.com/makerofthings7/XamarinMPBug\" rel=\"nofollow noreferrer\">running my MVVM instance.</a>  </p>\n\n<p>I have closely inspected the code-only approach, and am even using properties (not fields), within in an instance.  This seems like a Xamarin binding or linker issue.</p>\n\n<p><strong>NearbyDevicesViewController.cs/MCNearbyServiceAdvertiser - BROKEN</strong></p>\n\n<pre><code>public partial class NearbyDevicesViewController : UITableViewController\n{\n    public string myPhoneName { get; set; }\n    public  MCPeerID myPeerID { get; set; }\n    public const string SERVICE_STRING = \"AELP\";\n    public MCSession Session { get; set; }\n\n    List&lt;PeerMonitorStatus&gt; CachedPeerStatus = new List&lt;PeerMonitorStatus&gt;();\n\n    public NearbyDevicesViewController (IntPtr handle) : base (handle)\n    {\n        myPhoneName = \"A\" + UIKit.UIDevice.CurrentDevice.Name; // Adding A prefix incase numeric isn't allowed (it's a problem in Windows NETBIOS... so maybe also here?)\n        MyPhoneStatus.MyPeerID =  myPhoneName;\n        myPeerID = new MCPeerID(myPhoneName);\n\n        Session = new MCSession(myPeerID);\n        Session.Delegate = new ChatSessionDelegate(Session);\n        //--------------------------------Advertiser----------------------------------------------------\n        var emptyDict = new NSDictionary();\n        AppDelegate.advertiser = new MCNearbyServiceAdvertiser(myPeerID, emptyDict, SERVICE_STRING);\n        AppDelegate.advertiser.Delegate = new MyNearbyAdvertiserDelegate(this);\n\n        System.Diagnostics.Debug.WriteLine(\"Starting advertising...\");\n        AppDelegate.advertiser.StartAdvertisingPeer();\n        MyPhoneStatus.IsAdvertising = true;\n\n        ////--------------------------------Browser------------------------------------------------------\n        //AppDelegate.browser = new MCNearbyServiceBrowser(myPeerID, SERVICE_STRING);\n        //AppDelegate.browser.Delegate = new MyBrowserDelegate(myPeerID, Session);\n\n        //System.Diagnostics.Debug.WriteLine(\"Starting browsing...\");\n        //AppDelegate.browser.StartBrowsingForPeers();\n        //MyPhoneStatus.IsBrowsing = true;\n\n        CachedPeerStatus.AddRange(AppDelegate.PeerHistoryMonitor.Values);\n    }\n\n    public override nint RowsInSection(UITableView tableView, nint section)\n    {\n        return CachedPeerStatus.Count;\n    }\n\n    public override UITableViewCell GetCell(UITableView tableView, NSIndexPath indexPath)\n    {\n        UITableViewCell cell = new UITableViewCell(CGRect.Empty);\n        var item = CachedPeerStatus[indexPath.Row];\n\n        cell.TextLabel.Text = item.DisplayText;\n        return cell;\n    }\n}\n</code></pre>\n\n<p><strong>AdvertiserController/MCNearbyServiceAdvertiser - WORKING</strong></p>\n\n<pre><code>public class AdvertiserController : DiscoveryViewController\n{\n    MCNearbyServiceAdvertiser advertiser;\n\n    public AdvertiserController(string peerID) : base(peerID)\n    {\n    }\n\n    public override void DidReceiveMemoryWarning()\n    {\n        // Releases the view if it doesn't have a superview.\n        base.DidReceiveMemoryWarning();\n\n        // Release any cached data, images, etc that aren't in use.\n    }\n\n    public override void ViewDidLoad()\n    {\n        base.ViewDidLoad();\n\n        View = new DiscoveryView(\"Advertiser\", this);\n        var emptyDict = new NSDictionary();\n        Status(\"Starting advertising...\");\n\n        advertiser = new MCNearbyServiceAdvertiser(PeerID, emptyDict, SERVICE_STRING);\n        advertiser.Delegate = new MyNearbyAdvertiserDelegate(this);\n        advertiser.StartAdvertisingPeer();\n    }\n}\n</code></pre>\n\n<p><strong>MyNearbyAdvertiserDelegate.cs - BROKEN</strong></p>\n\n<pre><code>public  class MyNearbyAdvertiserDelegate : MCNearbyServiceAdvertiserDelegate\n{\n    MCSession session;\n\n    public MyNearbyAdvertiserDelegate(NearbyDevicesViewController session)\n    {\n        this.session = session.Session;\n    }\n\n    public override void DidReceiveInvitationFromPeer(MCNearbyServiceAdvertiser advertiser, MCPeerID peerID, NSData context, MCNearbyServiceAdvertiserInvitationHandler invitationHandler)\n    {\n        System.Diagnostics.Debug.WriteLine(\"Advertiser [\" + session.MyPeerID.GetNativeHash() + \"] will accept invite from \" + peerID.DisplayName + \" [\" + peerID.GetNativeHash() + \"]\");\n\n        MyPhoneStatus.LastInvitation = DateTime.UtcNow;\n\n        MyPhoneStatus.ConnectedPeers.Clear();\n        MyPhoneStatus.ConnectedPeers.AddRange(session.ConnectedPeers);\n\n        invitationHandler(true, session); \n    }\n}\n</code></pre>\n\n<p><strong>MyNearbyAdvertiserDelegate - WORKING</strong></p>\n\n<pre><code>class MyNearbyAdvertiserDelegate : MCNearbyServiceAdvertiserDelegate\n{\n    AdvertiserController parent;\n\n    public MyNearbyAdvertiserDelegate(AdvertiserController parent)\n    {\n        this.parent = parent;\n    }\n\n    public override void DidReceiveInvitationFromPeer(MCNearbyServiceAdvertiser advertiser, MCPeerID peerID, NSData context, MCNearbyServiceAdvertiserInvitationHandler invitationHandler)\n    {\n        parent.Status(\"Received Invite\");\n        invitationHandler(true, parent.Session);\n    }\n}\n</code></pre>\n\n<p><strong>Testing Environment</strong></p>\n\n<p>I have two Mac+iPhone hardware combinations.  The problem occurs regardless of which machine is the advertiser.  Manual configuration within <code>NearbyDevicesViewController</code> is needed to alter if the code is running as a server or a browser. </p>\n\n<p>When the server gets an invite via <code>MCNearbyServiceAdvertiserDelegate</code>, the advertiser crashes with the exception below </p>\n\n<p><strong>Visual Studio output</strong></p>\n\n<pre><code>Launched application 'net.agent7.AELP-MP' on '73' with pid 677\nLoaded assembly: /private/var/containers/Bundle/Application/D2774A07-619E-44C5-9137-526686F6769C/AELPMP.app/Xamarin.iOS.dll [External]\nThread started:  #2\nLoaded assembly: /private/var/containers/Bundle/Application/D2774A07-619E-44C5-9137-526686F6769C/AELPMP.app/System.dll [External]\nLoaded assembly: /private/var/containers/Bundle/Application/D2774A07-619E-44C5-9137-526686F6769C/AELPMP.app/AELPMP.exe\nResolved pending breakpoint at 'ChatSessionDelegate.cs:18,1' to void AELPMP.ChatSessionDelegate.DidChangeState (MultipeerConnectivity.MCSession session, MultipeerConnectivity.MCPeerID peerID, MultipeerConnectivity.MCSessionState state) [0x00001].\nResolved pending breakpoint at 'ChatSessionDelegate.cs:25,46' to void AELPMP.ChatSessionDelegate.DidChangeState (MultipeerConnectivity.MCSession session, MultipeerConnectivity.MCPeerID peerID, MultipeerConnectivity.MCSessionState state) [0x00069].\nResolved pending breakpoint at 'MyNearbyAdvertiserDelegate.cs:18,1' to void AELPMP.MyNearbyAdvertiserDelegate.DidReceiveInvitationFromPeer (MultipeerConnectivity.MCNearbyServiceAdvertiser advertiser, MultipeerConnectivity.MCPeerID peerID, Foundation.NSData context, MultipeerConnectivity.MCNearbyServiceAdvertiserInvitationHandler invitationHandler) [0x00000].\nResolved pending breakpoint at 'MyNearbyAdvertiserDelegate.cs:14,1' to void AELPMP.MyNearbyAdvertiserDelegate..ctor (AELPMP.NearbyDevicesViewController session) [0x00008].\nStarting advertising...\n2018-03-14 17:14:35.852 AELPMP[677:249758] critical: Stacktrace:\n\n2018-03-14 17:14:35.852 AELPMP[677:249758] critical:   at &lt;unknown&gt; &lt;0xffffffff&gt;\n2018-03-14 17:14:35.853 AELPMP[677:249758] critical:   at (wrapper managed-to-native) UIKit.UIApplication.UIApplicationMain (int,string[],intptr,intptr) &lt;0x00007&gt;\n2018-03-14 17:14:35.854 AELPMP[677:249758] critical:   at UIKit.UIApplication.Main (string[],intptr,intptr) [0x00005] in /Library/Frameworks/Xamarin.iOS.framework/Versions/11.10.0.15/src/Xamarin.iOS/UIKit/UIApplication.cs:79\n2018-03-14 17:14:35.855 AELPMP[677:249758] critical:   at UIKit.UIApplication.Main (string[],string,string) [0x0002c] in /Library/Frameworks/Xamarin.iOS.framework/Versions/11.10.0.15/src/Xamarin.iOS/UIKit/UIApplication.cs:63\n2018-03-14 17:14:35.855 AELPMP[677:249758] critical:   at AELPMP.Application.Main (string[]) [0x00001] in /Users/lamont/Downloads/AELPMP/Main.cs:12\n2018-03-14 17:14:35.856 AELPMP[677:249758] critical:   at (wrapper runtime-invoke) object.runtime_invoke_dynamic (intptr,intptr,intptr,intptr) [0x0001e] in &lt;0a8ff55fca4d4370bf8503724a39a15f#C25D3657-4A8E-C9A0-B325-6976392E2CBB&gt;:0\n2018-03-14 17:14:35.857 AELPMP[677:249758] critical: \nNative stacktrace:\n\n2018-03-14 17:14:35.891 AELPMP[677:249758] critical:    0   libmonosgen-2.0.dylib               0x0000000101200664 mono_handle_native_crash + 224\n2018-03-14 17:14:35.892 AELPMP[677:249758] critical:    1   libmonosgen-2.0.dylib               0x000000010120d394 mono_sigsegv_signal_handler + 316\n2018-03-14 17:14:35.892 AELPMP[677:249758] critical:    2   libsystem_platform.dylib            0x0000000185d73b50 _sigtramp + 52\n2018-03-14 17:14:35.892 AELPMP[677:249758] critical:    3   libxamarin-debug.dylib              0x0000000101519f94 xamarin_get_block_wrapper_creator + 52\n2018-03-14 17:14:35.892 AELPMP[677:249758] critical:    4   libxamarin-debug.dylib              0x000000010151dbd8 _ZL32get_method_block_wrapper_creatorP11_MonoMethodiPj + 260\n2018-03-14 17:14:35.892 AELPMP[677:249758] critical:    5   libxamarin-debug.dylib              0x000000010151da04 xamarin_get_delegate_for_block_parameter + 64\n2018-03-14 17:14:35.893 AELPMP[677:249758] critical:    6   AELPMP                              0x0000000100ba55f0 _ZL30native_to_managed_trampoline_8P11objc_objectP13objc_selectorPP11_MonoMethodP25MCNearbyServiceAdvertiserP8MCPeerIDP6NSDataS0_j + 848\n2018-03-14 17:14:35.893 AELPMP[677:249758] critical:    7   AELPMP                              0x0000000100ba5294 -[AELPMP_MyNearbyAdvertiserDelegate advertiser:didReceiveInvitationFromPeer:withContext:invitationHandler:] + 80\n2018-03-14 17:14:35.893 AELPMP[677:249758] critical:    8   MultipeerConnectivity               0x00000001a2080934 &lt;redacted&gt; + 180\n2018-03-14 17:14:35.893 AELPMP[677:249758] critical:    9   libdispatch.dylib                   0x0000000185acea54 &lt;redacted&gt; + 24\n2018-03-14 17:14:35.893 AELPMP[677:249758] critical:    10  libdispatch.dylib                   0x0000000185acea14 &lt;redacted&gt; + 16\n2018-03-14 17:14:35.894 AELPMP[677:249758] critical:    11  libdispatch.dylib                   0x0000000185adb698 &lt;redacted&gt; + 1016\n2018-03-14 17:14:35.894 AELPMP[677:249758] critical:    12  CoreFoundation                      0x00000001860f7344 &lt;redacted&gt; + 12\n2018-03-14 17:14:35.894 AELPMP[677:249758] critical:    13  CoreFoundation                      0x00000001860f4f20 &lt;redacted&gt; + 2012\n2018-03-14 17:14:35.894 AELPMP[677:249758] critical:    14  CoreFoundation                      0x0000000186014c58 CFRunLoopRunSpecific + 436\n2018-03-14 17:14:35.895 AELPMP[677:249758] critical:    15  GraphicsServices                    0x0000000187ec0f84 GSEventRunModal + 100\n2018-03-14 17:14:35.895 AELPMP[677:249758] critical:    16  UIKit                               0x000000018f76d5c4 UIApplicationMain + 236\n2018-03-14 17:14:35.895 AELPMP[677:249758] critical:    17  libXamarin.iOS.dll.dylib            0x000000010112fce0 wrapper_managed_to_native_UIKit_UIApplication_UIApplicationMain_int_string___intptr_intptr + 368\n2018-03-14 17:14:35.895 AELPMP[677:249758] critical:    18  libXamarin.iOS.dll.dylib            0x000000010111a1bc UIKit_UIApplication_Main_string___intptr_intptr + 44\n2018-03-14 17:14:35.896 AELPMP[677:249758] critical:    19  libXamarin.iOS.dll.dylib            0x000000010111a17c UIKit_UIApplication_Main_string___string_string + 172\n2018-03-14 17:14:35.896 AELPMP[677:249758] critical:    20  libAELPMP.exe.dylib                 0x0000000100bcbf80 AELPMP_Application_Main_string__ + 128\n2018-03-14 17:14:35.896 AELPMP[677:249758] critical:    21  libmscorlib.dll.dylib               0x0000000100dcb8e8 wrapper_runtime_invoke_object_runtime_invoke_dynamic_intptr_intptr_intptr_intptr + 248\n2018-03-14 17:14:35.896 AELPMP[677:249758] critical:    22  libmonosgen-2.0.dylib               0x00000001012104e0 mono_jit_runtime_invoke + 968\n2018-03-14 17:14:35.897 AELPMP[677:249758] critical:    23  libmonosgen-2.0.dylib               0x0000000101290620 do_runtime_invoke + 112\n2018-03-14 17:14:35.897 AELPMP[677:249758] critical:    24  libmonosgen-2.0.dylib               0x00000001012939b0 do_exec_main_checked + 144\n2018-03-14 17:14:35.897 AELPMP[677:249758] critical:    25  libmonosgen-2.0.dylib               0x00000001011f2274 mono_jit_exec + 268\n2018-03-14 17:14:35.897 AELPMP[677:249758] critical:    26  libxamarin-debug.dylib              0x000000010152ccd0 xamarin_main + 2220\n2018-03-14 17:14:35.897 AELPMP[677:249758] critical:    27  AELPMP                              0x0000000100ba9958 main + 96\n2018-03-14 17:14:35.898 AELPMP[677:249758] critical:    28  libdyld.dylib                       0x0000000185b3456c &lt;redacted&gt; + 4\n2018-03-14 17:14:35.898 AELPMP[677:249758] critical: \n=================================================================\nGot a SIGSEGV while executing native code. This usually indicates\na fatal error in the mono runtime or one of the native libraries \nused by your application.\n=================================================================\n</code></pre>\n\n<p><strong>XCode output</strong>\nThis is the output when I connect via Xcode and look at the device logs</p>\n\n<pre><code>Incident Identifier: 791E1B33-A22E-4684-8ADF-0E4F601E01FC\nCrashReporter Key:   8168b2a05f10e5f21da37250e7a61b844de00385\nHardware Model:      iPhone9,1\nProcess:             AELPMP [263]\nPath:                /private/var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/AELPMP\nIdentifier:          net.agent7.AELP-MP\nVersion:             1.0 (1.0)\nCode Type:           ARM-64 (Native)\nRole:                Foreground\nParent Process:      launchd [1]\nCoalition:           net.agent7.AELP-MP [413]\n\n\nDate/Time:           2018-03-13 20:17:17.5692 -0400\nLaunch Time:         2018-03-13 20:17:17.4649 -0400\nOS Version:          iPhone OS 11.2.6 (15D100)\nBaseband Version:    3.42.00\nReport Version:      104\n\nException Type:  EXC_CRASH (SIGABRT)\nException Codes: 0x0000000000000000, 0x0000000000000000\nException Note:  EXC_CORPSE_NOTIFY\nTermination Description: DYLD, Library not loaded: @rpath/libmonosgen-2.0.dylib | Referenced from: /var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/AELPMP | Reason: no suitable image found.  Did find: | /private/var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/libmonosgen-2.0.dylib: required code signature missing for '/private/var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/libmonosgen-2.0.dylib' | \nTriggered by Thread:  0\n\nFiltered syslog:\nNone found\n\nThread 0 Crashed:\n0   dyld                            0x000000010066ef48 __abort_with_payload + 8\n1   dyld                            0x000000010066e71c abort_with_payload_wrapper_internal + 100\n2   dyld                            0x000000010066e748 fcntl + 0\n3   dyld                            0x0000000100644498 dyld::fastBindLazySymbol+ 17560 (ImageLoader**, unsigned long) + 0\n4   dyld                            0x0000000100647714 dyld::_main+ 30484 (macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) + 7376\n5   dyld                            0x000000010064121c _dyld_start + 68\n\nThread 0 crashed with ARM Thread State (64-bit):\n    x0: 0x0000000000000006   x1: 0x0000000000000005   x2: 0x000000016f92e4b0   x3: 0x000000000000008b\n    x4: 0x000000016f92e0b0   x5: 0x0000000000000000   x6: 0x0000000000000000   x7: 0x00000000000002e0\n    x8: 0x0000000000000020   x9: 0x0000000000000009  x10: 0x67736f6e6f6d6269  x11: 0x642e302e322d6e65\n   x12: 0x2f7070612e504d50  x13: 0x736f6e6f6d62696c  x14: 0x2e302e322d6e6567  x15: 0x000a2762696c7964\n   x16: 0x0000000000000209  x17: 0x000000008000001f  x18: 0xfffffff00f0dd260  x19: 0x0000000000000000\n   x20: 0x000000016f92e0b0  x21: 0x000000000000008b  x22: 0x000000016f92e4b0  x23: 0x0000000000000005\n   x24: 0x0000000000000006  x25: 0x00000001004d0000  x26: 0x0000000100682000  x27: 0x0000000100681f88\n   x28: 0x000000016f92fab0   fp: 0x000000016f92e080   lr: 0x000000010066e71c\n    sp: 0x000000016f92e040   pc: 0x000000010066ef48 cpsr: 0x00000000\n\nBinary Images:\n0x1004d0000 - 0x1004dffff AELPMP arm64  &lt;cf358776c3b038b6b2ba40f0fce56323&gt; /var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/AELPMP\n0x100500000 - 0x10050ffff libAELPMP.exe.dylib arm64  &lt;125e771584d2332084c3901961cd3b59&gt; /var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/libAELPMP.exe.dylib\n0x100524000 - 0x10052bfff libSystem.dll.dylib arm64  &lt;e2f273739ebe391f961f97cb8573fdde&gt; /var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/libSystem.dll.dylib\n0x100640000 - 0x10067ffff dyld arm64  &lt;477a8a1f098b3a80860d656a3f4918ea&gt; /usr/lib/dyld\n0x1006dc000 - 0x100857fff libmscorlib.dll.dylib arm64  &lt;141d1723f765324bb687d89b93133a2b&gt; /var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/libmscorlib.dll.dylib\n0x100b38000 - 0x100b9bfff libXamarin.iOS.dll.dylib arm64  &lt;c208d3645de53ba59a7ff7179ff584bb&gt; /var/containers/Bundle/Application/99083856-91ED-46FF-A844-2E30F49014FF/AELPMP.app/libXamarin.iOS.dll.dylib\n\nEOF\n</code></pre>\n"}, {"tags": ["c#", "linq", "join", "sql-to-linq-conversion"], "comments": [{"owner": {"reputation": 77, "user_id": 8598099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fa01096aa106c9ddb2dcea1d29192417?s=128&d=identicon&r=PG&f=1", "display_name": "wibby35", "link": "https://stackoverflow.com/users/8598099/wibby35"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521080389, "post_id": 49287966, "comment_id": 85584149, "body": "Yeah I think so! I have yet to implement it yet because I&#39;m away from my laptop, but upon reading through the answers make sense. I will be sure to test tomorrow and select the best answer. Thanks guys!"}], "answers": [{"comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1521064722, "post_id": 49288156, "comment_id": 85579649, "body": "I don&#39;t see how <code>tc.PostageCode</code> affects the <code>OUTER JOIN</code> of <code>TableB</code>, though your conclusion is correct. Also, if you do <code>into queryDetails</code> you can&#39;t reference <code>s</code> after that (it won&#39;t compile)."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1521066373, "post_id": 49288156, "comment_id": 85580351, "body": "If you removed the <code>WHERE</code> clause in the SQL, the <code>JOIN</code> between <code>TableA</code> and <code>TableB</code> is still <i>effectively</i> an <code>INNER JOIN</code> because there is an <code>INNER JOIN</code> between <code>TableB</code> and <code>TableC</code> - the <code>WHERE</code> clause has nothing to do with it."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1521069464, "post_id": 49288156, "comment_id": 85581394, "body": "That is true @NetMage, and certainly a valid way to look at it. Here is another way. Let&#39;s say the query was <code>SELECT * FROM DatabaseA.SchemaA.TableA ta     LEFT OUTER JOIN DatabaseA.SchemaA.TableB tb     ON tb.ShipId = ta.ShipId     LEFT OUTER JOIN DatabaseA.SchemaA.TableC tc     ON tc.PostageId= tb.PostageId WHERE tc.PostageCode = &#39;Package&#39;       AND ta.MailId = &#39;Specification&#39;</code> instead. In that case, both <code>LEFT OUTER JOIN</code>s are effectively INNER due to the WHERE clause. That is what I was trying to teach the OP."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1521070960, "post_id": 49288156, "comment_id": 85581835, "body": "That is true, but not the query :)"}], "tags": [], "owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "is_accepted": true, "score": 1, "last_activity_date": 1521072955, "last_edit_date": 1521072955, "creation_date": 1521064092, "answer_id": 49288156, "question_id": 49287966, "link": "https://stackoverflow.com/questions/49287966/sql-to-linq-left-join-before-inner-join/49288156#49288156", "title": "SQL to LINQ - Left Join Before Inner Join", "body": "<p>Use:</p>\n\n<pre><code>var query = from m in tableA\njoin s in tableB on m.ShipId equals s.ShipId\njoin p in tableC on s.PostageId equals p.PostageId\nwhere m.MailId == \"Specification\" &amp;&amp; p.PostageCode == \"Package\"\nselect m.MailId;\n</code></pre>\n\n<p>Your query uses a <code>LEFT OUTER JOIN</code> but it doesn't need it.</p>\n\n<p>It will, in practice, function as an <code>INNER JOIN</code> due to your <code>tc.PostageCode = 'Package'</code> clause. <em>If you compare to a column value in a table in a <code>WHERE</code> clause (and there are no <code>OR</code> clauses and you aren't comparing to <code>NULL</code>) then effectively <strong>all</strong> joins to get to that table will be treated as <code>INNER</code>).</em></p>\n\n<p>That clause will <strong>never</strong> be true if <code>TableB</code> is <code>null</code> (which is why you use <code>LEFT OUTER JOIN</code> vs <code>INNER JOIN</code>) - so you should just use an <code>INNER JOIN</code> to make the problem simpler.</p>\n"}, {"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 2, "last_activity_date": 1522968010, "last_edit_date": 1522968010, "creation_date": 1521064583, "answer_id": 49288256, "question_id": 49287966, "link": "https://stackoverflow.com/questions/49287966/sql-to-linq-left-join-before-inner-join/49288256#49288256", "title": "SQL to LINQ - Left Join Before Inner Join", "body": "<p>From my <a href=\"https://stackoverflow.com/a/49245786/2557128\">SQL conversion recipe</a>:</p>\n\n<ol>\n<li><code>JOIN</code> conditions that aren't all equality tests with <code>AND</code> must be handled using <code>where</code> clauses outside the join, or with cross product (<code>from</code> ... <code>from</code> ...) and then <code>where</code></li>\n<li><code>JOIN</code> conditions that are multiple <code>AND</code>ed equality tests between the two tables should be translated into anonymous objects</li>\n<li><code>LEFT JOIN</code> is simulated by using <code>into</code> <em>joinvariable</em> and doing another from <code>from</code> the <em>joinvariable</em> followed by <code>.DefaultIfEmpty()</code>.</li>\n</ol>\n\n<p>The order of <code>JOIN</code> clauses doesn't change how you translate them:</p>\n\n<pre><code>var ans = from ta in TableA\n          join tb in TableB on ta.ShipId equals tb.ShipId into tbj\n          from tb in tbj.DefaultIfEmpty()\n          join tc in TableC on tb.PostageId equals tc.PostageId\n          where tc.PostageCode == \"Package\" &amp;&amp; ta.MailId == \"Specification\"\n          select new { ta, tb, tc };\n</code></pre>\n\n<p>However, because the <code>LEFT JOIN</code> is executed before the <code>INNER JOIN</code> and then the <code>NULL</code> <code>PostageId</code>s in <code>TableB</code> for unmatched rows will never match any row in <code>TableC</code>, it becomes equivalent to an <code>INNER JOIN</code> as well, which translates as:</p>\n\n<pre><code>var ans2 = from ta in tableA\n           join tb in tableB on ta.ShipId equals tb.ShipId\n           join tc in tableC on tb.PostageId equals tc.PostageId\n           where tc.PostageCode == \"Package\" &amp;&amp; ta.MailId == \"Specification\"\n           select new { ta, tb, tc };\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8598099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fa01096aa106c9ddb2dcea1d29192417?s=128&d=identicon&r=PG&f=1", "display_name": "wibby35", "link": "https://stackoverflow.com/users/8598099/wibby35"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 49288156, "answer_count": 2, "score": 1, "last_activity_date": 1522968010, "creation_date": 1521063175, "question_id": 49287966, "link": "https://stackoverflow.com/questions/49287966/sql-to-linq-left-join-before-inner-join", "title": "SQL to LINQ - Left Join Before Inner Join", "body": "<p>So I have a SQL query that I would like to convert to LINQ.</p>\n\n<p>Here is said query:</p>\n\n<pre><code>SELECT *\nFROM DatabaseA.SchemaA.TableA ta\n    LEFT OUTER JOIN DatabaseA.SchemaA.TableB tb\n    ON tb.ShipId = ta.ShipId\n    INNER JOIN DatabaseA.SchemaA.TableC tc\n    ON tc.PostageId= tb.PostageId\nWHERE tc.PostageCode = 'Package'\n      AND ta.MailId = 'Specification'\n</code></pre>\n\n<p>The problem I am struggling with is I cannot seem to figure out how to do a left join in LINQ before an inner join, since doing a left join in LINQ is not as clear to me at least.</p>\n\n<p>I have found numerous examples of a LINQ inner join and then a left join, but not left join and then inner join.</p>\n\n<p>If it helps, here is the LINQ query I have been playing around with:</p>\n\n<pre><code>var query = from m in tableA\njoin s in tableB on m.ShipId equals s.ShipId into queryDetails\nfrom qd in queryDetails.DefaultIfEmpty()\njoin p in tableC on qd.PostageId equals p.PostageId\nwhere m.MailId == \"Specification\" &amp;&amp; p.PostageCode == \"Package\"\nselect m.MailId;\n</code></pre>\n\n<p>I have tried this a few different ways but I keep getting an \"Object reference not set to an instance of an object\" error on qd.PostageId.</p>\n\n<p>LINQ is very new to me and I love learning it, so any help on this would be much appreciated. Thanks! </p>\n"}, {"tags": ["c#", "permissions", "mutex"], "comments": [{"owner": {"reputation": 2537, "user_id": 44873, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i5OJL.jpg?s=128&g=1", "display_name": "Jayden", "link": "https://stackoverflow.com/users/44873/jayden"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521064179, "post_id": 49287954, "comment_id": 85579437, "body": "@mjwills; happy to put code here; but it would replicate exactly the linked to answer; seems like duplication to me ; but happy for guidance."}, {"owner": {"reputation": 2537, "user_id": 44873, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i5OJL.jpg?s=128&g=1", "display_name": "Jayden", "link": "https://stackoverflow.com/users/44873/jayden"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521064634, "post_id": 49287954, "comment_id": 85579606, "body": "@mjwills; okay, fair enough - will edit with code. Cheers."}], "answers": [{"tags": [], "owner": {"reputation": 3361, "user_id": 25781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d724658644edd53f1bab758248de5200?s=128&d=identicon&r=PG", "display_name": "sthiers", "link": "https://stackoverflow.com/users/25781/sthiers"}, "is_accepted": false, "score": 0, "last_activity_date": 1594297886, "creation_date": 1594297886, "answer_id": 62814868, "question_id": 49287954, "link": "https://stackoverflow.com/questions/49287954/mutex-system-unauthorizedaccessexception-when-not-running-as-administrator/62814868#62814868", "title": "Mutex System.UnauthorizedAccessException when not running as Administrator", "body": "<p>Could that be that you do not run on Windows server? In the documention for .NET 4.7.2 it says that mutexes starting with &quot;Global&quot; are available on &quot;On a server that is running Terminal Services&quot;.</p>\n"}], "owner": {"reputation": 2537, "user_id": 44873, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/i5OJL.jpg?s=128&g=1", "display_name": "Jayden", "link": "https://stackoverflow.com/users/44873/jayden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 463, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594297886, "creation_date": 1521063115, "last_edit_date": 1521065024, "question_id": 49287954, "link": "https://stackoverflow.com/questions/49287954/mutex-system-unauthorizedaccessexception-when-not-running-as-administrator", "title": "Mutex System.UnauthorizedAccessException when not running as Administrator", "body": "<p>C#, .NET 4.5</p>\n\n<p>I have two processes accessing a shared resource, but despite creating a Global Mutex with the <a href=\"https://stackoverflow.com/a/19717341/44873\">approach suggested here</a>; which should be accessible by Everyone, I am still getting a System.UnauthorizedAccessException.</p>\n\n<p>I can resolve the situation by running the problematic process with elevated Administrator privileges. This suggests to me that the first locking process is not creating the Mutex with the correct AccessRule and associated SecurityIdentifier - but it appears to be - it uses the same code as above.</p>\n\n<pre><code>public class MutexLocker: IDisposable\n{\n    private Mutex _mutex;\n\n    public MutexLocker ( string id )\n    {\n        bool createdNew;\n        MutexSecurity mutexSecurity = new MutexSecurity();\n        mutexSecurity.AddAccessRule(new MutexAccessRule(new SecurityIdentifier(WellKnownSidType.WorldSid, null), \n                                                        MutexRights.Synchronize | MutexRights.Modify, AccessControlType.Allow));\n\n        try\n        {\n            // attempt to create the mutex, with the desired DACL..\n            _mutex = new Mutex(false, id, out createdNew, mutexSecurity);\n        }\n        catch (WaitHandleCannotBeOpenedException)\n        {\n            // the mutex cannot be opened, probably because a Win32 object of a different\n            // type with the same name already exists.\n            throw;\n        }\n        catch (UnauthorizedAccessException)\n        {\n            // the mutex exists, but the current process or thread token does not\n            // have permission to open the mutex with SYNCHRONIZE | MUTEX_MODIFY rights.\n            throw;\n        }\n    }\n\n    public void Dispose ()\n    {\n        if (_mutex != null)\n        {\n            _mutex.ReleaseMutex();\n            _mutex.Dispose();\n        }\n\n        _mutex = null;\n    }\n}\n</code></pre>\n\n<p>I can confirm that I'm using the constructor for the Mutex which passes the AccessRule within it to avoid any race conditions.</p>\n\n<p>I have also tried setting the MutexAccessRule to use MutexRights.FullControl with no change in behaviour.</p>\n\n<p>EDIT: additional code tried\nI have also tried this different implementation with the same behaviour:</p>\n\n<pre><code>var appGuid = \"{6D7C8B75-01FC-471E-B5DE-97FAAE5D8BE7}\";\nstring mutexId = string.Format( \"Global\\\\{{{0}}}\", appGuid );\n\n// Need a place to store a return value in Mutex() constructor call\nbool createdNew;\n\n// edited by Jeremy Wiebe to add example of setting up security for multi-user usage\n// edited by 'Marc' to work also on localized systems (don't use just \"Everyone\") \nvar allowEveryoneRule =\n    new MutexAccessRule( new SecurityIdentifier( WellKnownSidType.WorldSid\n                                               , null)\n                       , MutexRights.FullControl\n                       , AccessControlType.Allow\n                       );\nvar securitySettings = new MutexSecurity();\nsecuritySettings.AddAccessRule(allowEveryoneRule);\n\n   // edited by MasonGZhwiti to prevent race condition on security settings via VanNguyen\nusing (var mutex = new Mutex(false, mutexId, out createdNew, securitySettings))\n{\n    // edited by acidzombie24\n    var hasHandle = false;\n    try\n    {\n        try\n        {\n            // note, you may want to time out here instead of waiting forever\n            // edited by acidzombie24\n            // mutex.WaitOne(Timeout.Infinite, false);\n            hasHandle = mutex.WaitOne(5000, false);\n            if (hasHandle == false)\n                throw new TimeoutException(\"Timeout waiting for exclusive access\");\n        }\n        catch (AbandonedMutexException)\n        {\n            // Log the fact that the mutex was abandoned in another process,\n            // it will still get acquired\n            hasHandle = true;\n        }\n\n        // Perform your work here.\n    }\n    finally\n    {\n        // edited by acidzombie24, added if statement\n        if(hasHandle)\n            mutex.ReleaseMutex();\n    }\n}\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c#", "msbuild", "nuget", "azure-devops"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521062943, "post_id": 49287852, "comment_id": 85578906, "body": "Well, do you gave a &quot;Added package ... AngleSharp ... &quot; in the NuGet output? It&#39;s none of the 3 lines you posted"}, {"owner": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 1, "creation_date": 1521063584, "post_id": 49287852, "comment_id": 85579197, "body": "Looks like your packages.config doesn&#39;t reference <code>AngleSharp</code>."}, {"owner": {"reputation": 32525, "user_id": 6936103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/860fa18931fc7f7f6aa5908fce669304?s=128&d=identicon&r=PG&f=1", "display_name": "Marina Liu", "link": "https://stackoverflow.com/users/6936103/marina-liu"}, "edited": false, "score": 0, "creation_date": 1521083942, "post_id": 49287852, "comment_id": 85584866, "body": "Can you show the content of <code>myproject.csproj</code> here?"}, {"owner": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "edited": false, "score": 0, "creation_date": 1521103516, "post_id": 49287852, "comment_id": 85591823, "body": "AngleSharp is only ONE example. I have this issue with EVERY package: Downloaded by Nuget, but not found by MSBuild"}, {"owner": {"reputation": 8000, "user_id": 637493, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/746879c416a97cd2b6237c5866ce2dbf?s=128&d=identicon&r=PG", "display_name": "cpoDesign", "link": "https://stackoverflow.com/users/637493/cpodesign"}, "edited": false, "score": 0, "creation_date": 1521109111, "post_id": 49287852, "comment_id": 85595440, "body": "It looks like you are pointing with your references to different location. Check if you paths to nuget packages are relative."}, {"owner": {"reputation": 30946, "user_id": 6587650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bjWRF.jpg?s=128&g=1", "display_name": "starian chen-MSFT", "link": "https://stackoverflow.com/users/6587650/starian-chen-msft"}, "edited": false, "score": 0, "creation_date": 1521448870, "post_id": 49287852, "comment_id": 85717372, "body": "Try to clear Destination directory box of NuGet task, and specify solution file in Solution box of NuGet task, then try again."}, {"owner": {"reputation": 1909, "user_id": 9295669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bHE46.png?s=128&g=1", "display_name": "Rodrigo Werlang", "link": "https://stackoverflow.com/users/9295669/rodrigo-werlang"}, "edited": false, "score": 1, "creation_date": 1521499833, "post_id": 49287852, "comment_id": 85748562, "body": "I believe you should have a solution file. Try to add one and then change your build to reference that solution. You also appear to use a default configuration for everything, so there is no need to define all that configuration for you nuget restore task. I would remove it and add the original task back after adding a solution to build."}, {"owner": {"reputation": 32525, "user_id": 6936103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/860fa18931fc7f7f6aa5908fce669304?s=128&d=identicon&r=PG&f=1", "display_name": "Marina Liu", "link": "https://stackoverflow.com/users/6936103/marina-liu"}, "edited": false, "score": 0, "creation_date": 1521700078, "post_id": 49287852, "comment_id": 85844659, "body": "@OleAlbers What if you use MSBuild task (<a href=\"https://docs.microsoft.com/en-us/vsts/build-release/tasks/build/msbuild?view=vsts\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/vsts/build-release/tasks/build/&hellip;</a>) instead of VS build task to build?"}, {"owner": {"reputation": 1230, "user_id": 4919526, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c0025a679c1156b1e5dab4f6d7dee69?s=128&d=identicon&r=PG", "display_name": "mu88", "link": "https://stackoverflow.com/users/4919526/mu88"}, "edited": false, "score": 0, "creation_date": 1521703430, "post_id": 49287852, "comment_id": 85846170, "body": "Does the problem also occur when you clone the Git repo to your local machine into a completely new directory and try to build? Furthermore, I&#39;d create a dedicated build job in Visual Studio online including <code>git clone</code>, <code>nuget restore D:\\a\\1\\s\\AweCsomeO365\\packages.config</code> and <code>msbuild D:\\a\\1\\s\\AweCsomeO365\\AweCsomeO365.csproj &#47;t:Rebuild &#47;p:Configuration=Release;Platform=&quot;AnyCPU&quot;</code>. See if this runs and then continue adding your other parameters."}, {"owner": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "edited": false, "score": 0, "creation_date": 1521707646, "post_id": 49287852, "comment_id": 85848602, "body": "It works on the standard VS-Build"}], "answers": [{"comments": [{"owner": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "edited": false, "score": 0, "creation_date": 1521621930, "post_id": 49397851, "comment_id": 85804515, "body": "I added this parameter because without it, it looked at a completely different location (D:\\a\\1\\s&#41; (s instead of a). So removing this parameter does not work"}, {"owner": {"reputation": 963, "user_id": 892723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a36f17f86bd7b44060a154928380438?s=128&d=identicon&r=PG", "display_name": "jcwmoore", "link": "https://stackoverflow.com/users/892723/jcwmoore"}, "reply_to_user": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "edited": false, "score": 0, "creation_date": 1521774203, "post_id": 49397851, "comment_id": 85885327, "body": "I noticed something else to look into, answer updated."}], "tags": [], "owner": {"reputation": 963, "user_id": 892723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a36f17f86bd7b44060a154928380438?s=128&d=identicon&r=PG", "display_name": "jcwmoore", "link": "https://stackoverflow.com/users/892723/jcwmoore"}, "is_accepted": false, "score": 1, "last_activity_date": 1521774157, "last_edit_date": 1521774157, "creation_date": 1521604135, "answer_id": 49397851, "question_id": 49287852, "link": "https://stackoverflow.com/questions/49287852/msbuild-does-not-find-restored-nuget-packages-on-visual-studio-online/49397851#49397851", "title": "MsBuild does not find restored NuGet-Packages on Visual Studio Online", "body": "<p>I believe that your MSBuild \"ReferencePath\" parameter is not correct.  you are telling MS Build that all your references (nuget packages and their dlls included) are going to be located at \"D:\\a\\1\\a\\packages\" but that is not where nuget will download and store the packages and dlls.  Nuget will download and extract files into D:\\a\\1\\a\\packages\\{packageName}\\{version}\\lib\\{environment}\\package.dll.  I think you need to remove that last parameter (ReferencePath) from your MSBuild arguments.</p>\n\n<p>I also noticed that your PackageLocation parameter is not the same as the destination for the NuGet restore task, do you need to add the \"\\packages\" to that parameter like the destination in the restore task?</p>\n"}, {"comments": [{"owner": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "edited": false, "score": 0, "creation_date": 1521794681, "post_id": 49438009, "comment_id": 85892566, "body": "That changes the nuget package location to &quot;D:\\a\\1\\s\\packages&quot; instead of &quot;D:\\a\\1\\a\\packages&quot; but still no success with nuget"}, {"owner": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "edited": false, "score": 0, "creation_date": 1521795097, "post_id": 49438009, "comment_id": 85892800, "body": "(Sorry: &quot;No success with MSBUILD&quot; was what I meant)"}, {"owner": {"reputation": 79, "user_id": 2115826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b995e0cf0a777a8ba38ba228ecc42cfe?s=128&d=identicon&r=PG", "display_name": "Shawn Miller", "link": "https://stackoverflow.com/users/2115826/shawn-miller"}, "reply_to_user": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "edited": false, "score": 0, "creation_date": 1521814604, "post_id": 49438009, "comment_id": 85905794, "body": "It may be looking for $(Build.SourcesDirectory)\\AweCsome365Test\\packages. I&#39;m pretty sure if you aren&#39;t passing parameters to MSBUILD, the default path it looks in is somewhere in that \\s\\ path."}], "tags": [], "owner": {"reputation": 79, "user_id": 2115826, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b995e0cf0a777a8ba38ba228ecc42cfe?s=128&d=identicon&r=PG", "display_name": "Shawn Miller", "link": "https://stackoverflow.com/users/2115826/shawn-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1521750987, "creation_date": 1521750987, "answer_id": 49438009, "question_id": 49287852, "link": "https://stackoverflow.com/questions/49287852/msbuild-does-not-find-restored-nuget-packages-on-visual-studio-online/49438009#49438009", "title": "MsBuild does not find restored NuGet-Packages on Visual Studio Online", "body": "<p>Change the nuget restore destination directory to $(Build.SourcesDirectory)\\packages and remove the msbuild ReferencePath parameter.</p>\n"}, {"tags": [], "owner": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "is_accepted": true, "score": 3, "last_activity_date": 1521797419, "creation_date": 1521797419, "answer_id": 49446304, "question_id": 49287852, "link": "https://stackoverflow.com/questions/49287852/msbuild-does-not-find-restored-nuget-packages-on-visual-studio-online/49446304#49446304", "title": "MsBuild does not find restored NuGet-Packages on Visual Studio Online", "body": "<p>The issue was that inside the project there was a hintpath for the packages directing to a location that was not within the GIT-Repository (and shouldn't):</p>\n\n<pre><code>  &lt;Reference Include=\"AngleSharp, Version=0.9.9.0, Culture=neutral, PublicKeyToken=e83494dcdc6d31ea, processorArchitecture=MSIL\"&gt;\n      &lt;HintPath&gt;..\\..\\AweCsome365Test\\packages\\AngleSharp.0.9.9\\lib\\net45\\AngleSharp.dll&lt;/HintPath&gt;\n    &lt;/Reference&gt;\n</code></pre>\n\n<p>My original approach was to define a target directory to NuGet and a Source Directory for MSBuild to use <em>another</em> location to the packages that both understand.</p>\n\n<p>The issue though (as far as I understand) is, that NuGet always creates a subfolder-structure <code>\"./packages/{PackagesName}/lib/net45/{file}\"</code> and MSBuild does not look recursivly when setting <code>\"./packages\"</code> as source path.</p>\n\n<p><em>The above is just an explanation for the future guy running into the same problem</em></p>\n\n<p>So my solution was to mimic the local behavior for nuget and changing the output directory to match the HintPath (even if there is no \"AweCsome365Test\")-directory in the repository:\n<a href=\"https://i.stack.imgur.com/FbKLZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FbKLZ.png\" alt=\"Nuget Destination directory setting\"></a></p>\n\n<p><em>(I will leave this question open as this solution smells fishy. If anyone has a better solution that allows to chain nuget and msbuild without using the HintPath I am happily willing to spend my bounty on it)</em></p>\n"}, {"tags": [], "owner": {"reputation": 987, "user_id": 847721, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/50d415d649bf58efb9aed772271a68a4?s=128&d=identicon&r=PG", "display_name": "tobriand", "link": "https://stackoverflow.com/users/847721/tobriand"}, "is_accepted": false, "score": 0, "last_activity_date": 1602604526, "last_edit_date": 1602604526, "creation_date": 1602594486, "answer_id": 64335951, "question_id": 49287852, "link": "https://stackoverflow.com/questions/49287852/msbuild-does-not-find-restored-nuget-packages-on-visual-studio-online/64335951#64335951", "title": "MsBuild does not find restored NuGet-Packages on Visual Studio Online", "body": "<p>The answers here are largely right. However it's worth noting another cause that can result in this behaviour. My toolchain was using Azure DevOps which is basically the same as Visual Studio Online, just a few years later.</p>\n<p>Cause:</p>\n<ul>\n<li>Reference your project from a different solution (cross-repo), for instance for debugging purposes</li>\n<li>Update NuGet references in the problematic project from the external place you referenced it from</li>\n</ul>\n<p>What this does is make use of the <strong>solution</strong> location for packages when the package gets installed.</p>\n<p>For .Net core/standard projects, using Update-Package -reinstall appears to fix things. However, for .Net Framework projects, even though <code>packages.json</code> may get rebuilt, the <code>&lt;HintPath /&gt;</code> node in the <code>.csproj</code> gets left as is - with a reference to a packages folder that Azure will never create.</p>\n<p>Simple fix:</p>\n<ol>\n<li>Right click on the offending solutions locally, and choose <em>Unload</em></li>\n<li>Right click on the unloaded project, choose <em>edit .csproj</em></li>\n<li>Find any hintpaths that look like <code>../../OtherRepo/packages</code> (the slash in use may vary), and change them to <code>../packages</code></li>\n<li>Confirm the solution does build locally still</li>\n<li>Push the changes to Azure, and cross your fingers</li>\n</ol>\n<p>This approach will fix the issue caused by consolidating / updating packages from the wrong place rather than requiring a change to the build pipeline to spoof that location (which in may case, wasn't working very well either).</p>\n"}], "owner": {"reputation": 7605, "user_id": 680026, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/IZToj.png?s=128&g=1", "display_name": "Ole Albers", "link": "https://stackoverflow.com/users/680026/ole-albers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5819, "favorite_count": 2, "accepted_answer_id": 49446304, "answer_count": 4, "score": 4, "last_activity_date": 1602604526, "creation_date": 1521062680, "last_edit_date": 1521453374, "question_id": 49287852, "link": "https://stackoverflow.com/questions/49287852/msbuild-does-not-find-restored-nuget-packages-on-visual-studio-online", "title": "MsBuild does not find restored NuGet-Packages on Visual Studio Online", "body": "<p>I try to build a solution stored in an external GIT-Repository on Visual Studio Online.</p>\n\n<p>It has the following steps:</p>\n\n<blockquote>\n  <p>1: Git Restore - Works</p>\n  \n  <p>2: NuGet Restore - Works</p>\n  \n  <p>3: Build - Does NOT work</p>\n</blockquote>\n\n<p>My first guess when looking at the logs is that MsBuild is not looking for the Packages where NuGet had stored them.\nSome Lines from NuGet Restore:</p>\n\n<pre><code>2018-03-14T21:10:11.0352862Z Completed installation of AngleSharp 0.9.9\n2018-03-14T21:10:11.0353230Z Adding package 'AngleSharp.0.9.9' to folder 'D:\\a\\1\\s\\packages'\n2018-03-14T21:10:11.0353563Z Added package 'AngleSharp.0.9.9' to folder 'D:\\a\\1\\s\\packages'\n2018-03-14T21:10:11.0354972Z Added package 'AngleSharp.0.9.9' to folder 'D:\\a\\1\\s\\packages' from source 'https://api.nuget.org/v3/index.json' 'Microsoft.SharePointOnline.CSOM.16.1.7317.1200' to folder 'D:\\a\\1\\s\\packages' \n</code></pre>\n\n<p>Some lines from MsBuild:</p>\n\n<pre><code>018-03-14T21:10:21.2105399Z PrepareForBuild:\n2018-03-14T21:10:21.2105793Z   Creating directory \"bin\\Release\\\".\n2018-03-14T21:10:21.2424947Z   Creating directory \"obj\\Release\\\".\n2018-03-14T21:10:30.3569560Z ResolveAssemblyReferences:\n2018-03-14T21:10:30.3570425Z   Primary reference \"AngleSharp, Version=0.9.9.0, Culture=neutral, PublicKeyToken=e83494dcdc6d31ea, processorArchitecture=MSIL\".\n2018-03-14T21:10:30.3670272Z ##[warning]C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets(2041,5): Warning MSB3245: Could not resolve this reference. Could not locate the assembly \"AngleSharp, Version=0.9.9.0, Culture=neutral, PublicKeyToken=e83494dcdc6d31ea, processorArchitecture=MSIL\". Check to make sure the assembly exists on disk. If this reference is required by your code, you may get compilation errors.\n</code></pre>\n\n<p>My solution/packages structure is:</p>\n\n<pre><code>....\\mysolution\\myproject\\myproject.csproj\n....\\mysolution\\myproject\\packages.config\n</code></pre>\n\n<p>Current Config:\n<a href=\"https://i.stack.imgur.com/xNl45.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xNl45.png\" alt=\"NUGET\"></a>\n<a href=\"https://i.stack.imgur.com/d0nnP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d0nnP.png\" alt=\"enter image description here\"></a>\nSo how can I change the Nuget and/or msbuild-behavior to make this work?</p>\n\n<p><em>(Update)</em>: To clear this up: I have this problem with <strong>every</strong> package. They all are in the packages.config, each one is downloaded from Nuget, but each one also isn't found from MsBuild</p>\n\n<p><em>(Update2)</em> The Commands generated are currently the following:\nNUGET:</p>\n\n<pre><code>D:\\a\\_tool\\NuGet\\4.4.1\\x64\\nuget.exe restore D:\\a\\1\\s\\AweCsomeO365\\packages.config -PackagesDirectory D:\\a\\1\\a\\packages -Verbosity Detailed -NonInteractive -ConfigFile D:\\a\\1\\Nuget\\tempNuGet_22.config\n</code></pre>\n\n<p>MSBUILD:</p>\n\n<pre><code>C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Enterprise\\MSBuild\\15.0\\Bin\\msbuild.exe\" \"D:\\a\\1\\s\\AweCsomeO365\\AweCsomeO365.csproj\" /nologo /nr:false /dl:CentralLogger,\"D:\\a\\_tasks\\VSBuild_(GUID)\\1.126.0\\ps_modules\\MSBuildHelpers\\Microsoft.TeamFoundation.DistributedTask.MSBuild.Logger.dll\";\"RootDetailId=(GUID)|SolutionDir=D:\\a\\1\\s\\AweCsomeO365\"*ForwardingLogger,\"D:\\a\\_tasks\\VSBuild_(GUID)\\1.126.0\\ps_modules\\MSBuildHelpers\\Microsoft.TeamFoundation.DistributedTask.MSBuild.Logger.dll\" /p:DeployOnBuild=true /p:WebPublishMethod=Package /p:PackageAsSingleFile=true /p:SkipInvalidConfigurations=true /p:PackageLocation=D:\\a\\1\\a /p:ReferencePath=D:\\a\\1\\a\\packages /p:platform=\"anyCPU\" /p:configuration=\"Release\" /p:VisualStudioVersion=\"15.0\" /p:_MSDeployUserAgent=\"VSTS_(GUID)_build_4_22\n</code></pre>\n\n<p>I replaced the GUIDs; tempNuGetConfig is something that seems to be generated by VSTS dynamically</p>\n\n<p>Still. even if the log states that nuget stores the packages</p>\n\n<pre><code>Added package 'AngleSharp.0.9.9' to folder 'D:\\a\\1\\a\\packages'\n</code></pre>\n\n<p>MsBuild does not seem to find them there:</p>\n\n<pre><code> For SearchPath \"D:\\a\\1\\a\\packages\".\n2018-03-16T13:57:42.4625155Z           Considered \"D:\\a\\1\\a\\packages\\AngleSharp.winmd\", but it didn't exist.\n2018-03-16T13:57:42.4625456Z           Considered \"D:\\a\\1\\a\\packages\\AngleSharp.dll\", but it didn't exist.\n2018-03-16T13:57:42.4625730Z           Considered \"D:\\a\\1\\a\\packages\\AngleSharp.exe\", but it didn't exist.\n</code></pre>\n\n<p>VSTS-Configurationvalues:</p>\n\n<p>MsBuild: <code>/p:ReferencePath=$(Build.StagingDirectory)\\packages</code></p>\n\n<p>Nuget-DestiantionDirectory: <code>$(Build.StagingDirectory)\\packages</code></p>\n\n<p>(update3): I have <strong>no</strong> solution file, but only a csproj-file in that repository</p>\n"}, {"tags": ["c#", "deserialization", "xml-serialization"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1521063273, "post_id": 49287835, "comment_id": 85579050, "body": "I spot three things: First, the setter of the <code>list</code> property in your <code>costumerManager</code> does not make any sense, considering <code>listtemp.Clear();</code> is the first thing you do in the getter. The whole thing with <code>listtemp</code> does not make any lick of sense to me, to be honest. Second, the <code>costumerManager</code> class uses a <code>Costumer</code> class. Perhaps the deserializition fails with this class (or perhaps not. I cannot tell as i know nothing about that class). And lastly (and most unimportantly), you misspelled the word &quot;customer&quot;. A costumer is someone dealing with costumes :-)"}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1521064749, "post_id": 49287835, "comment_id": 85579656, "body": "<b>TYPO alert</b>: it&#39;s a <b>Customer</b> (and thus a <code>CustomerManager</code>)  - not a &quot;costumer&quot; - you consistently misspelled that word"}, {"owner": {"reputation": 3, "user_id": 9493922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "as asdad", "link": "https://stackoverflow.com/users/9493922/as-asdad"}, "edited": false, "score": 0, "creation_date": 1521065961, "post_id": 49287835, "comment_id": 85580196, "body": "ok sry for the misspell"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 9493922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "as asdad", "link": "https://stackoverflow.com/users/9493922/as-asdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1521067336, "creation_date": 1521067336, "answer_id": 49288785, "question_id": 49287835, "link": "https://stackoverflow.com/questions/49287835/deserialize-fails-even-under-using-same-type-as-to-serialize-time-and-valid-look/49288785#49288785", "title": "Deserialize fails even under using same type as to serialize time and valid looking xml", "body": "<p>ok the clear was it  in combination with  and exit chek solved the problem  even though i do not check the cause it.  thx marc for pointing t out that s was a bit senseless </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Xml;\nusing System.Xml.Schema;\nusing System.Xml.Serialization;\n//using Projektverwaltung.Interfaces;\n\nnamespace Projektverwaltung.Klassen\n{\n    [Serializable()]\n    public class CustomerManager//: IXmlSerializable\n    {\n        public CustomerManager()\n        {\n\n        }\n        [XmlIgnore]\n        EventHandler m_EditHandle = new EventHandler(DefaultHandle);\n        [XmlIgnore] Dictionary&lt;int, Customer&gt; m_CostumerList = new Dictionary&lt;int, Customer&gt;();\n\n        [XmlIgnore] public Dictionary&lt;int, Customer&gt; CostumerList { get { return m_CostumerList; } set { m_CostumerList = value; } }\n\n\n       [XmlArray(ElementName = \"CostumerList\",IsNullable =true)]\n        List&lt;Customer&gt; listtemp = new List&lt;Customer&gt;();\n        public List&lt;Customer&gt; list\n        {\n            get\n            {\n\n                try\n                {\n\n                    foreach (var item in CostumerList.Values)\n                    {\n                        if (!listtemp.Exists(match=&gt;match.ID==item.ID))\n                        {\n                            listtemp.Add(item);\n                        }\n\n                    }\n                }\n                catch (Exception ex)\n                {\n\n                    Program.Log(ex);\n                }\n\n\n                return listtemp;\n            }\n            set\n            {\n\n            }\n        }               \n\n\n        private static void DefaultHandle(object sender, EventArgs e) { }\n\n\n\n\n        [XmlIgnore] public EventHandler EditCostumerEvent { get { return m_EditHandle; } set { m_EditHandle = value; } }\n\n\n        public int IncrementID()\n        {\n            int defaultindex = 0;\n            try\n            {\n\n                foreach (var item in CostumerList.Keys)\n                {\n                    defaultindex = defaultindex &lt; item ? item : defaultindex;\n                }\n\n            }\n            catch (Exception ex)\n            {\n                Program.Log(ex);\n            }\n            return defaultindex + 1;\n        }\n\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9493922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "as asdad", "link": "https://stackoverflow.com/users/9493922/as-asdad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521067560, "creation_date": 1521062595, "last_edit_date": 1521067560, "question_id": 49287835, "link": "https://stackoverflow.com/questions/49287835/deserialize-fails-even-under-using-same-type-as-to-serialize-time-and-valid-look", "title": "Deserialize fails even under using same type as to serialize time and valid looking xml", "body": "<p>Would be great if somebody could point out what is different between my customermanager and my employee manager which prevents the customer to get deserialized properly.</p>\n\n<p>I create this xml with my program with the serializer with this call:</p>\n\n<pre><code>XmlSerializer bf = new XmlSerializer(typeof(ProjectConfiguration));\n\n&lt;?xml version=\"1.0\"?&gt;\n&lt;ProjectConfiguration xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"&gt;\n  &lt;Title /&gt;\n  &lt;UtcLastEdited&gt;0001-01-01T00:00:00&lt;/UtcLastEdited&gt;\n  &lt;UtcLastChange&gt;0001-01-01T00:00:00&lt;/UtcLastChange&gt;\n  &lt;customerManager&gt;\n    &lt;list&gt;\n      &lt;Customer&gt;\n        &lt;Firstname&gt;Hans &lt;/Firstname&gt;\n        &lt;LastName&gt;meser&lt;/LastName&gt;\n        &lt;ID&gt;1&lt;/ID&gt;\n        &lt;Contry&gt;deutschland&lt;/Contry&gt;\n        &lt;Town&gt;berlin&lt;/Town&gt;\n        &lt;Street&gt;poststra\u00dfe 2&lt;/Street&gt;\n      &lt;/Customer&gt;\n    &lt;/list&gt;\n  &lt;/customerManager&gt;\n  &lt;employeeManager&gt;\n    &lt;list&gt;\n      &lt;Employee&gt;\n        &lt;Firstname&gt;hans &lt;/Firstname&gt;\n        &lt;LastName&gt;Meyer&lt;/LastName&gt;\n        &lt;ID&gt;1&lt;/ID&gt;\n        &lt;Contry&gt;Deutschland&lt;/Contry&gt;\n        &lt;Town&gt;Hamburg&lt;/Town&gt;\n        &lt;Street&gt;Bahofstra\u00dfe 4&lt;/Street&gt;\n      &lt;/Employee&gt;\n    &lt;/list&gt;\n  &lt;/employeeManager&gt;\n  &lt;Projects&gt;\n    &lt;Project&gt;\n      &lt;ID&gt;1&lt;/ID&gt;\n      &lt;Title&gt;NewProjekt&lt;/Title&gt;\n      &lt;StartDate&gt;2018-03-14T21:49:58.5540372+01:00&lt;/StartDate&gt;\n      &lt;Enddate&gt;2018-03-29T21:49:58&lt;/Enddate&gt;\n      &lt;ListOfProjectActions&gt;\n        &lt;ProjectAction&gt;\n          &lt;Title&gt;Implemtierung&lt;/Title&gt;\n          &lt;Day&gt;2&lt;/Day&gt;\n          &lt;AsstimatedTime /&gt;\n          &lt;Employee&gt;1&lt;/Employee&gt;\n          &lt;Projektwork&gt;Implementierung&lt;/Projektwork&gt;\n          &lt;ID&gt;0&lt;/ID&gt;\n        &lt;/ProjectAction&gt;\n      &lt;/ListOfProjectActions&gt;\n      &lt;Description&gt;aweeqweqe&lt;/Description&gt;\n      &lt;EmployeeToProject&gt;\n        &lt;int&gt;1&lt;/int&gt;\n      &lt;/EmployeeToProject&gt;\n      &lt;Customer&gt;0&lt;/Customer&gt;\n      &lt;ProjektLeader&gt;0&lt;/ProjektLeader&gt;\n    &lt;/Project&gt;\n  &lt;/Projects&gt;\n&lt;/ProjectConfiguration&gt;\n</code></pre>\n\n<p>but when I deserialize with the same type</p>\n\n<pre><code>XmlSerializer bf = new XmlSerializer(typeof(ProjectConfiguration));\nProjectConfiguration obj = bf.Deserialize(file) as ProjectConfiguration;\n</code></pre>\n\n<p>it somehow fails to create a valid <code>CustomerManager</code> even though it works well with the <code>Employeemanager</code>  with are pretty much same build up</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Xml.Serialization;\n//using Projektverwaltung.Interfaces;\n\nnamespace Projektverwaltung.Klassen\n{\n    [Serializable()]\n    public class CustomerManager\n    {\n        public CustomerManager()\n        {\n        }\n\n        [XmlIgnore]\n        EventHandler m_EditHandle = new EventHandler(DefaultHandle);\n        [XmlIgnore] \n        Dictionary&lt;int, Customer&gt; m_CustomerList = new       Dictionary&lt;int, Customer&gt;();\n\n        [XmlIgnore] \n        public Dictionary&lt;int, Customer&gt; CustomerList { get { return m_CustomerList; } set { m_CustomerList = value; } }\n\n        List&lt;Customer&gt; listtemp = new List&lt;Customer&gt;();\n\n        public List&lt;Customer&gt; list\n        {\n            get\n            {\n                try\n                {\n                    listtemp.Clear();\n                    foreach (var item in CustomerList.Values)\n                    {\n                        listtemp.Add(item);\n                    }\n                }\n                catch (Exception ex)\n                {\n                    Program.Log(ex);\n                }\n\n                return listtemp;\n            }\n            set\n            {\n                listtemp = value;\n            }\n        }               \n\n        private static void DefaultHandle(object sender, EventArgs e) { }\n\n        [XmlIgnore] \n        public EventHandler EditCostumerEvent { get { return m_EditHandle; } set { m_EditHandle = value; } }\n\n        public int IncrementID()\n        {\n            int defaultindex = 0;\n\n            try\n            {\n                foreach (var item in CostumerList.Keys)\n                {\n                    defaultindex = defaultindex &lt; item ? item : defaultindex;\n                }\n            }\n            catch (Exception ex)\n            {\n                Program.Log(ex);\n            }\n            return defaultindex + 1;\n        }\n    }\n}\n</code></pre>\n\n<p>but the  employeemanager is pretty much the same </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Xml.Serialization;\n// using Projektverwaltung.Interfaces;\nnamespace Projektverwaltung.Klassen\n{\n    [Serializable()]\n    public class EmployeeManager// : IEmployeeManager\n    {\n        [XmlIgnore]\n        EventHandler m_DeleteHandle = new EventHandler(DefaultHandle);\n        [XmlIgnore]\n        EventHandler m_EditHandle = new EventHandler(DefaultHandle);\n        [XmlIgnore]\n        Dictionary&lt;int, Employee&gt; m_EmployeeList = new Dictionary&lt;int, Employee&gt;();\n\n        List&lt;int&gt; m_usedIds = new List&lt;int&gt;();\n\n        private static void DefaultHandle(object sender, EventArgs e) { }\n        [XmlIgnore]\n        public Dictionary&lt;int, Employee&gt; ListofIEmployee { get { return m_EmployeeList; }set { m_EmployeeList = value; } }\n        [XmlIgnore]\n        public EventHandler DeleteOfEmployee { get { return m_DeleteHandle; } set { m_DeleteHandle = value; } }\n        [XmlIgnore]\n        public EventHandler EditOfEmployee { get { return m_EditHandle; } set { m_EditHandle = value; } }\n        public EmployeeManager()\n        {\n\n        }\n        public int IncrementID()\n        {\n            int defaultindex = 0;\n            try\n            {\n                foreach (var item in ListofIEmployee.Keys)\n                {\n                    defaultindex = defaultindex &lt; item ? item : defaultindex;\n                }\n                foreach (var item in m_usedIds)\n                {\n                    defaultindex = defaultindex &lt; item ? item : defaultindex;\n                }\n\n            }\n            catch (Exception ex)\n            {\n                Program.Log(ex);\n            }\n\n\n            return defaultindex + 1;\n        }\n\n        public void DeleteEmployee(Employee employee)\n        {\n            try\n            {\n                if (ListofIEmployee.Remove(employee.ID))\n                {\n                    m_usedIds.Add(employee.ID);\n                    DeleteOfEmployee.Invoke(employee, new EventArgs());\n                }\n                else\n                {\n                    // could not delete employeee\n                }\n            }\n            catch (Exception ex )\n            {\n                Program.Log(ex);\n            }\n\n\n        }\n\n        public void EditEmployee(Employee employee)\n        {\n            try\n            {\n                m_EditHandle.Invoke(employee, new EventArgs());\n            }\n            catch (Exception ex)\n            {\n                Program.Log(ex);\n            }\n\n        }\n\n        List&lt;Employee&gt; listtemp = new List&lt;Employee&gt;();\n        public List&lt;Employee&gt; list\n        {\n            get\n            {\n                try\n                {\n                    foreach (var item in ListofIEmployee.Values)\n                    {\n                        listtemp.Add(item);\n                    }\n                }\n                catch (Exception ex)\n                {\n                    Program.Log(ex);\n\n                }\n                return listtemp;\n            }\n            set\n            {\n                listtemp = value;\n            }\n        }\n\n    }\n}\n</code></pre>\n\n<p>here the class with are the type who requested to deserialize</p>\n\n<pre><code>    using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n//using Projektverwaltung.Interfaces;\nusing System.Windows.Forms;\n\n\nnamespace Projektverwaltung.Klassen\n{\n    [Serializable()]\n    public class ProjectConfiguration //: ProjectConfiguration\n    {\n\n        List&lt;Project&gt; m_list;\n        CostumerManager m_costumerManager;\n        EmployeeManager m_employeeManager;\n        public string Title { get; set;}\n        public DateTime UtcLastEdited { get ; set ;}\n        public DateTime UtcLastChange { get ; set ;}\n\n        public ProjectConfiguration (List&lt;Project&gt; list,CostumerManager costumerManger,EmployeeManager employeeManagercar ,string strTitle,IWin32Window owner)\n        {\n            Title = strTitle;\n            m_list = list;\n            costumerManager = costumerManger;\n            employeeManager = employeeManagercar;\n        }\n\n        public ProjectConfiguration()\n        {\n\n        }\n\n        public CostumerManager costumerManager\n        {\n            get\n            {\n               return  m_costumerManager;\n            }\n            set\n            {\n                m_costumerManager = value;\n            }\n        }\n\n        public EmployeeManager employeeManager\n        {\n            get\n            {\n                return m_employeeManager;\n            }\n            set\n            {\n                m_employeeManager = value;\n            }\n        }\n\n        public List&lt;Project&gt; Projects { get { return m_list; }set { m_list = value; } }\n    }\n}\n</code></pre>\n\n<p><strong>Edit</strong>  with edited name </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n//using Projektverwaltung.Interfaces;\n\nnamespace Projektverwaltung.Klassen\n{\n    [Serializable()]\n   public class Customer //: ICostumer\n    {\n        string m_strFirstName = string.Empty;\n        string m_strLastName = string.Empty;\n        string m_strContry = string.Empty;\n        string m_strStreet = string.Empty;\n        string m_strTown = string.Empty;\n        int m_nId = 0;\n        public Customer()\n        {\n\n        }\n        public string Firstname { get {return m_strFirstName;} set { m_strFirstName = value; }}\n        public string LastName { get {return m_strLastName;} set { m_strLastName=value; }}\n        public int ID { get {return m_nId;} set {m_nId=value; }}\n        public string Contry { get { return m_strContry;} set {m_strContry = value; }}\n        public string Town { get {return  m_strTown;} set {m_strTown=value;} }\n        public string Street { get {return m_strStreet;} set {m_strStreet=value; }}\n        public string CombindedName { get{return string.Format(\"Kunde: {0} {1}\", LastName, Firstname); } }\n    }\n}\n</code></pre>\n\n<p>i tried  to make a list since the diconarys do not serialize well the temp list is just a list  that gets emptyed on each save so multiply saves make not redunant costumers on load the list get writed to the dictonarys with the id as key    </p>\n"}, {"tags": ["c#", "winforms", "datagridview"], "comments": [{"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1521063068, "post_id": 49287825, "comment_id": 85578959, "body": "Don&#39;t create a new dataset every time, just add to one you keep in memory."}], "answers": [{"tags": [], "owner": {"reputation": 104, "user_id": 6910695, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e8deb11a8c3254c1342a056e9bca5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Lukaszewski", "link": "https://stackoverflow.com/users/6910695/matthew-lukaszewski"}, "is_accepted": false, "score": 0, "last_activity_date": 1521062832, "creation_date": 1521062832, "answer_id": 49287889, "question_id": 49287825, "link": "https://stackoverflow.com/questions/49287825/windows-forms-populate-existing-datagridview-with-new-data-without-erasing-exi/49287889#49287889", "title": "Windows Forms - Populate existing datagridview with new data without erasing existing", "body": "<p>You could add more columns to your dataset and then call this.dataGridView1.DataSource = dataset.Tables[0].DefaultView; again.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 7787035, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10208685666115192/picture?type=large", "display_name": "Dor Lugasi", "link": "https://stackoverflow.com/users/7787035/dor-lugasi"}, "is_accepted": false, "score": 1, "last_activity_date": 1521063911, "creation_date": 1521063911, "answer_id": 49288120, "question_id": 49287825, "link": "https://stackoverflow.com/questions/49287825/windows-forms-populate-existing-datagridview-with-new-data-without-erasing-exi/49288120#49288120", "title": "Windows Forms - Populate existing datagridview with new data without erasing existing", "body": "<p>each time you try do this you use the same dataset , and create a new on the previous. that's why the data is overwritten </p>\n\n<p>save the contents of what you want to add to the datagridview data source into a data table, and then merge them together into datagridview datasource</p>\n\n<pre><code>DataTable dt2 = new DataTable(); \n\n// fill your table \n\n(dataGridView1.DataSource as DataTable).Merge(dt2);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9493905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e8cdad677d97112472f0cf32b8c341c?s=128&d=identicon&r=PG&f=1", "display_name": "Storme96", "link": "https://stackoverflow.com/users/9493905/storme96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521063911, "creation_date": 1521062562, "question_id": 49287825, "link": "https://stackoverflow.com/questions/49287825/windows-forms-populate-existing-datagridview-with-new-data-without-erasing-exi", "title": "Windows Forms - Populate existing datagridview with new data without erasing existing", "body": "<p>I have a piece of code below which on the click of a button will promt the user to select a .csv file from their storeage. After this the file will populate the the datagridview with its contents.   </p>\n\n<pre><code>     public void button1_Click(object sender, EventArgs e)\n        {\n            string delimiter = \",\";\n            string tablename = \"AudioTable\";\n            DataSet dataset = new DataSet();\n\n            OpenFileDialog openFileDialog1 = new OpenFileDialog();\n            openFileDialog1.Filter = \"CSV Files (*.csv)|*.csv|All Files (*.*)|*.*\";\n            openFileDialog1.FilterIndex = 1;\n\n\n            if (openFileDialog1.ShowDialog() == DialogResult.OK)\n            {\n                if (MessageBox.Show(\"Are you sure you want to import the data from \\n \" + openFileDialog1.FileName + \"?\", \"Are you sure?\", MessageBoxButtons.YesNo) == DialogResult.Yes)\n                {\n                    string filename = openFileDialog1.FileName;\n                    StreamReader sr = new StreamReader(filename);\n                    string csv = File.ReadAllText(openFileDialog1.FileName);\n                    dataset.Tables.Add(tablename);\n                    dataset.Tables[tablename].Columns.Add(\"QID\");\n                    dataset.Tables[tablename].Columns.Add(\"Text\");\n;\n\n                    string allData = sr.ReadToEnd();\n                    string[] rows = allData.Split(\"\\r\".ToCharArray());\n\n                    foreach (string r in rows)\n                    {\n                        string[] items = r.Split(delimiter.ToCharArray());\n                        dataset.Tables[tablename].Rows.Add(items);\n                    }\n                    this.dataGridView1.DataSource = dataset.Tables[0].DefaultView;\n                    MessageBox.Show(filename + \" was successfully imported.\", \"Successful\", MessageBoxButtons.OK);\n                }\n\n            }\n        }\n</code></pre>\n\n<p>This code runs fine by consistantly displaying the data within the datagridview however, When you attempt to upload a second different .csv this files data will overwrite the existing data from the 1st .csv. Is there any possible way to change this so that instead of overwriting the existing data within the datagridview it will just append it into new rows below the existing data. To try and make it abit clearer, The first time user uploads a .csv there is no existing data within the datagridview so it loads fine but if that same user wants to upload second .csv after the first thats when the existing data from the 1st .csv will be overwritten. I have searched about and seen a few issues similar to this relating to datatables in web based solutions however was unsure how translate there to suit my own.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "signalr"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 3, "creation_date": 1521062057, "post_id": 49287700, "comment_id": 85578468, "body": "What happens when you run your code?"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1521066291, "post_id": 49287700, "comment_id": 85580318, "body": "Please learn first how to consume async API in WPF/WinForms. You are supposed to call such in the form load event, and mark the event handler as <code>async</code> (so that you can await on the API). Your current code looks dangerous (I don&#39;t think the constructor exits), so not surprised if it does not work."}], "answers": [{"tags": [], "owner": {"reputation": 5782, "user_id": 974840, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d82b040a8eaa6e75ff19ebd10cde338f?s=128&d=identicon&r=PG", "display_name": "Tsukasa", "link": "https://stackoverflow.com/users/974840/tsukasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1521068957, "creation_date": 1521068957, "answer_id": 49289052, "question_id": 49287700, "link": "https://stackoverflow.com/questions/49287700/signalr-desktop-client-not-recieving-data-send-from-server/49289052#49289052", "title": "SignalR Desktop Client not recieving data send from server", "body": "<p>Well despite the down votes. I have it working.</p>\n\n<p>I turned on SignalR logging in the WPF application and found the following line to be the issue:</p>\n\n<pre><code> hubProxy.On&lt;List&lt;MetricAlert&gt;&gt;(\"refreshData\", (data) =&gt; ProcessData(data));\n</code></pre>\n\n<p>In the error logs it shows it trying to convert a string to the object. I needed to except it as a string and the deserialize the json into the object.</p>\n"}], "owner": {"reputation": 5782, "user_id": 974840, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d82b040a8eaa6e75ff19ebd10cde338f?s=128&d=identicon&r=PG", "display_name": "Tsukasa", "link": "https://stackoverflow.com/users/974840/tsukasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1521068957, "creation_date": 1521061899, "question_id": 49287700, "link": "https://stackoverflow.com/questions/49287700/signalr-desktop-client-not-recieving-data-send-from-server", "title": "SignalR Desktop Client not recieving data send from server", "body": "<p>MVC5 application using SignalR that sends messages to web clients without an issue.</p>\n\n<p>I now need these messages to also be broadcasted to a desktop application.\nHere is what I'm currently trying from the WPF app.</p>\n\n<pre><code>private HubConnection hubConnection = null;\nprivate IHubProxy hubProxy = null;\n\npublic MainWindow()\n{\n    InitializeComponent();\n\n    try\n    {\n        hubConnection = new HubConnection(\"https://noccommand/signalr\", useDefaultUrl: false);\n\n        hubProxy = hubConnection.CreateHubProxy(\"DashboardHub\");\n\n        hubProxy.On&lt;List&lt;MetricAlert&gt;&gt;(\"refreshData\", (data) =&gt; ProcessData(data));\n        hubConnection.Credentials = CredentialCache.DefaultNetworkCredentials;\n        hubConnection.Start().Wait();\n\n        //Shows connected\n        MessageBoxResult result = MessageBox.Show(hubConnection.State.ToString(), \"SignalR\", MessageBoxButton.OK, MessageBoxImage.Information);\n    }\n    catch (Exception ex)\n    {\n    }\n}\n\n\npublic void ProcessData(List&lt;MetricAlert&gt; data)\n{\n    MessageBoxResult result = MessageBox.Show(\"WE GOT DATA!\", \"SignalR\", MessageBoxButton.OK, MessageBoxImage.Information);\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c#", "xamarin.ios", "visual-studio-2017", "application-loader"], "comments": [{"owner": {"reputation": 8901, "user_id": 8187800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D3h95.jpg?s=128&g=1", "display_name": "ColeX - MSFT", "link": "https://stackoverflow.com/users/8187800/colex-msft"}, "edited": false, "score": 0, "creation_date": 1521102382, "post_id": 49287652, "comment_id": 85591204, "body": "<a href=\"https://forums.xamarin.com/discussion/107175/missing-asset-catalog-your-app-is-missing-the-asset-catalog-file-in\" rel=\"nofollow noreferrer\">forums.xamarin.com/discussion/107175/&hellip;</a>   is this question you post?"}, {"owner": {"reputation": 173, "user_id": 6783087, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/bace4ef43fd1730c9a38dffb9984cbca?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas challa", "link": "https://stackoverflow.com/users/6783087/srinivas-challa"}, "reply_to_user": {"reputation": 8901, "user_id": 8187800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D3h95.jpg?s=128&g=1", "display_name": "ColeX - MSFT", "link": "https://stackoverflow.com/users/8187800/colex-msft"}, "edited": false, "score": 0, "creation_date": 1521116050, "post_id": 49287652, "comment_id": 85599976, "body": "Not Exactly, i am trying to upload my IPA file to iTunes, But facing Asset catalog is missing issue"}, {"owner": {"reputation": 173, "user_id": 6783087, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/bace4ef43fd1730c9a38dffb9984cbca?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas challa", "link": "https://stackoverflow.com/users/6783087/srinivas-challa"}, "reply_to_user": {"reputation": 8901, "user_id": 8187800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D3h95.jpg?s=128&g=1", "display_name": "ColeX - MSFT", "link": "https://stackoverflow.com/users/8187800/colex-msft"}, "edited": false, "score": 0, "creation_date": 1521116160, "post_id": 49287652, "comment_id": 85600053, "body": "The IPA file which we generated with Ad-Hoc profile which is working fine with Devices, But the IPA file with is generated with Distribution profile facing issue"}, {"owner": {"reputation": 410, "user_id": 2014592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b7027ed19a061d45d1192553b0a450?s=128&d=identicon&r=PG", "display_name": "Vincent Dondain", "link": "https://stackoverflow.com/users/2014592/vincent-dondain"}, "edited": false, "score": 0, "creation_date": 1533146400, "post_id": 49287652, "comment_id": 90243533, "body": "Hi, for issues like this it&#39;s good to report them directly within the IDE (this is where the Xamarin team is tracking issues). Simply use Help &gt; Send Feedback &gt; Report a Problem to file your issue."}, {"owner": {"reputation": 410, "user_id": 2014592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b7027ed19a061d45d1192553b0a450?s=128&d=identicon&r=PG", "display_name": "Vincent Dondain", "link": "https://stackoverflow.com/users/2014592/vincent-dondain"}, "edited": false, "score": 0, "creation_date": 1533146567, "post_id": 49287652, "comment_id": 90243629, "body": "Otherwise a test case of you project would help. The questions that come into my mind are: Does your Info.plist use the Asset.xcasset for app icons? If you double click on the Asset Catalogs do you see your assets? What about the csproj can you gist it (does it include the app icons assets)? Are there physical assets in you xcassets folder?"}], "owner": {"reputation": 173, "user_id": 6783087, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/bace4ef43fd1730c9a38dffb9984cbca?s=128&d=identicon&r=PG&f=1", "display_name": "srinivas challa", "link": "https://stackoverflow.com/users/6783087/srinivas-challa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533145892, "creation_date": 1521061649, "last_edit_date": 1521115961, "question_id": 49287652, "link": "https://stackoverflow.com/questions/49287652/missing-asset-catalog-your-app-is-missing-the-asset-catalog-file-with-applicat", "title": "Missing Asset Catalog - Your app is missing the asset catalog file with Application Loader", "body": "<p>I am using visual studio 2017 on windows. I am getting the above error using the Application Loader when uploading the .IPA file. I have the Asset Catalogs file in the root of my IOS project. There is nothing showing in Assets. we added all App icons to solution. Does anyone have any insight into why I am my asset catalog is missing or steps I can do to ensure it is included.<a href=\"https://i.stack.imgur.com/1vQ3u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1vQ3u.png\" alt=\"enter image description here\"></a></p>\n\n<p>thanks</p>\n"}, {"tags": ["c#", "entity-framework"], "comments": [{"owner": {"reputation": 6492, "user_id": 1682401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/186d34c49dcbf2300c4d7a9a6e7eef2a?s=128&d=identicon&r=PG", "display_name": "Hussein Salman", "link": "https://stackoverflow.com/users/1682401/hussein-salman"}, "edited": false, "score": 2, "creation_date": 1521061679, "post_id": 49287648, "comment_id": 85578288, "body": "what is the error?"}, {"owner": {"reputation": 50118, "user_id": 913124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20dGq.jpg?s=128&g=1", "display_name": "Christos", "link": "https://stackoverflow.com/users/913124/christos"}, "edited": false, "score": 1, "creation_date": 1521061694, "post_id": 49287648, "comment_id": 85578300, "body": "You mentioned that an error is thrown. Could you please post also the error ? Thanks"}, {"owner": {"reputation": 95, "user_id": 4888993, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153202717686023/picture?type=large", "display_name": "Giovanni Rivas", "link": "https://stackoverflow.com/users/4888993/giovanni-rivas"}, "edited": false, "score": 0, "creation_date": 1521062094, "post_id": 49287648, "comment_id": 85578484, "body": "The error says that for example: i.p doesn&#39;t contains definition for i.l"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521064338, "post_id": 49287648, "comment_id": 85579502, "body": "Please update your post with the error."}], "answers": [{"tags": [], "owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "is_accepted": false, "score": 1, "last_activity_date": 1521062015, "creation_date": 1521062015, "answer_id": 49287717, "question_id": 49287648, "link": "https://stackoverflow.com/questions/49287648/select-a-specific-column-with-multiple-includes-in-entity-framework/49287717#49287717", "title": "Select a specific column with multiple includes in Entity Framework", "body": "<p>That's not possible with Entity Framework. You either include the entire table (with <code>Include</code>, as you are doing) or you don't include it at all.<br>\nIf you want to load only specific columns, you can do this, but see how it's a manual process:</p>\n\n<pre><code>Context\n    .Select(i =&gt; new YourType\n    {\n        c = i.l,\n        l = i.l,\n        x = new X \n        {\n            a = i.x.a // only the properties you want here\n        }\n        ...\n    });\n</code></pre>\n\n<p>The moment you use <code>Select</code>, <code>Include</code> is completely ignored, so you cannot use both.</p>\n"}], "owner": {"reputation": 95, "user_id": 4888993, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153202717686023/picture?type=large", "display_name": "Giovanni Rivas", "link": "https://stackoverflow.com/users/4888993/giovanni-rivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1521062092, "creation_date": 1521061630, "last_edit_date": 1521062087, "question_id": 49287648, "link": "https://stackoverflow.com/questions/49287648/select-a-specific-column-with-multiple-includes-in-entity-framework", "title": "Select a specific column with multiple includes in Entity Framework", "body": "<p>I'm trying to get specific columns from a context with several includes, but when I try: </p>\n\n<pre><code>Context.Include(i =&gt; i.c)\n       .Include(i =&gt; i.l).Select(s=&gt; new LocationCatalog { Name  = s.Name})\n       .Include(i =&gt; i.p)\n       .Include(i =&gt; i.li)\n       .Include(i =&gt; i.pcl)\n</code></pre>\n\n<p>VS throws an error after the select.</p>\n\n<p>How can I achieve this? I want to specify the columns for each include.</p>\n\n<p>The error says that for example: i.p doesn't contains definition for i.l</p>\n"}, {"tags": ["c#", "razor"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 1, "creation_date": 1521061452, "post_id": 49287565, "comment_id": 85578176, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You didn&#39;t post how you are saving to/retrieving from the database"}, {"owner": {"reputation": 247, "user_id": 9419790, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/oTjJc.jpg?s=128&g=1", "display_name": "Chloe Finn", "link": "https://stackoverflow.com/users/9419790/chloe-finn"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521061614, "post_id": 49287565, "comment_id": 85578254, "body": "@mjwills my bad, just updated the question"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521061711, "post_id": 49287565, "comment_id": 85578308, "body": "In the <code>Edit</code> method you need to get the existing entry out of the database and alter it. Otherwise <b>any</b> property that isn&#39;t passed as part of the request will be lost (including the image)."}], "answers": [{"tags": [], "owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "is_accepted": true, "score": 2, "last_activity_date": 1521065886, "creation_date": 1521065886, "answer_id": 49288508, "question_id": 49287565, "link": "https://stackoverflow.com/questions/49287565/how-to-only-save-certain-values-in-edit-razor-page/49288508#49288508", "title": "How to only save certain values in edit razor page", "body": "<pre><code>[HttpPost]\n[ValidateAntiForgeryToken]\npublic ActionResult Edit([Bind(Include = \"InvoiceId,Company,Description,Amount,ChurchId\")] Invoice invoice)\n{\n    if (ModelState.IsValid)\n    {\n        Invoice oldInvoice = db.Invoices.Find(id);\n        oldInvoice.Amount = invoice.Amount;\n        // repeated for all of the properties (but not the image)\n\n        db.SaveChanges();\n        return RedirectToAction(\"Index\");\n    }\n    ViewBag.ChurchId = new SelectList(db.Churches, \"ChurchId\", \"Name\", invoice.ChurchId);\n    return View(invoice);\n}\n</code></pre>\n\n<p>The key is to use <code>db.Invoices.Find</code> to get the existing item out of the database. That way existing properties (like the image) won't be lost.</p>\n"}], "owner": {"reputation": 247, "user_id": 9419790, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/oTjJc.jpg?s=128&g=1", "display_name": "Chloe Finn", "link": "https://stackoverflow.com/users/9419790/chloe-finn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 49288508, "answer_count": 1, "score": 0, "last_activity_date": 1521106643, "creation_date": 1521061290, "last_edit_date": 1521106643, "question_id": 49287565, "link": "https://stackoverflow.com/questions/49287565/how-to-only-save-certain-values-in-edit-razor-page", "title": "How to only save certain values in edit razor page", "body": "<p>I currently have an edit page where I have an invoice. It is a picture saved as a binary value.</p>\n\n<p>When I want to edit an invoice, I want the picture to stay the same but when I press save, it gets rid of the image and updates the row to null.</p>\n\n<p>Would it possibly have something to do with my Edit Method?</p>\n\n<p>Here is part of my razor page:</p>\n\n<pre><code>@{\n    ViewBag.Title = \"Edit\";\n    if (Model.PictureOfInvoice != null)\n    {\n        var base64 = Convert.ToBase64String(Model.PictureOfInvoice);\n        var imgsrc = string.Format(\"data:image/jpg;base64,{0}\", base64);\n        &lt;img src=\"@imgsrc\" style=\"max-width:500px;max-height:500px\" align=\"right\" /&gt;\n    }\n}\n\n&lt;h2&gt;Details of Invoice&lt;/h2&gt;\n\n@using (Html.BeginForm())\n{\n    @Html.AntiForgeryToken()\n\n    &lt;div class=\"form-horizontal\"&gt;\n        &lt;h4&gt;Invoice&lt;/h4&gt;\n        &lt;hr /&gt;\n        @Html.ValidationSummary(true, \"\", new { @class = \"text-danger\" })\n        @Html.HiddenFor(model =&gt; model.InvoiceId)\n</code></pre>\n\n<p>Is there any way for this not to be updated?</p>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>public ActionResult Edit(int? id)\n{\n    if (id == null)\n    {\n        return new HttpStatusCodeResult(HttpStatusCode.BadRequest);\n    }\n\n    Invoice invoice = db.Invoices.Find(id);\n    if (invoice == null)\n    {\n        return HttpNotFound();\n    }\n\n    ViewBag.ChurchId = new SelectList(db.Churches, \"ChurchId\", \"Name\", invoice.ChurchId);\n    return View(invoice);\n}\n\n[HttpPost]\n[ValidateAntiForgeryToken]\npublic ActionResult Edit([Bind(Include = \"InvoiceId,Company,Description,Amount,ChurchId\")] Invoice invoice)\n{\n    if (ModelState.IsValid)\n    {\n        db.Entry(invoice).State = EntityState.Modified;\n        db.SaveChanges();\n        return RedirectToAction(\"Index\");\n    }\n\n    ViewBag.ChurchId = new SelectList(db.Churches, \"ChurchId\", \"Name\", invoice.ChurchId);\n    return View(invoice);\n}\n</code></pre>\n\n<p>My Model:</p>\n\n<pre><code>public class Invoice\n{\n    [Key]\n    public int InvoiceId { get; set; }\n\n    public string Company { get; set; }\n\n    public string Description { get; set; }\n\n    public decimal Amount { get; set; }\n\n    public byte[] PictureOfInvoice { get; set; }\n\n    public string ImageFileName { get; set; }\n\n    [ForeignKey(\"Church\")]\n    public int ChurchId { get; set; }\n\n    public virtual Church Church { get; set; }\n\n    public virtual Administration Admins { get; set; }\n}\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 6, "creation_date": 1521060291, "post_id": 49287288, "comment_id": 85577661, "body": "Add  Console.ReadLine(); at the end of the code. See <a href=\"https://stackoverflow.com/questions/8868338/why-is-the-console-window-closing-immediately-without-displaying-my-output\" title=\"why is the console window closing immediately without displaying my output\">stackoverflow.com/questions/8868338/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9493777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576059322508517/picture?type=large", "display_name": "Yuval Dahan", "link": "https://stackoverflow.com/users/9493777/yuval-dahan"}, "reply_to_user": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1521060766, "post_id": 49287288, "comment_id": 85577860, "body": "maybe its not the way to make the code exe file i dont know. if there is any way to make my code exe i woud like  to hear about it.by the way i try to add console.readline at the end but its still closing me the window after i insert the data to my variables"}, {"owner": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1521060949, "post_id": 49287288, "comment_id": 85577936, "body": "Don&#39;t understand the question, sorry..."}, {"owner": {"reputation": 1, "user_id": 9493777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576059322508517/picture?type=large", "display_name": "Yuval Dahan", "link": "https://stackoverflow.com/users/9493777/yuval-dahan"}, "reply_to_user": {"reputation": 2147, "user_id": 4180382, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/AFiNM.jpg?s=128&g=1", "display_name": "Ole EH Dufour", "link": "https://stackoverflow.com/users/4180382/ole-eh-dufour"}, "edited": false, "score": 0, "creation_date": 1521061173, "post_id": 49287288, "comment_id": 85578040, "body": "never mind its work thank you !!!!"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1521061334, "post_id": 49287288, "comment_id": 85578118, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8868338/why-is-the-console-window-closing-immediately-without-displaying-my-output\">Why is the console window closing immediately without displaying my output?</a>"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1521068582, "post_id": 49287288, "comment_id": 85581128, "body": "&quot;so people do not know what the code behind the .exe file is&quot;??? Are you sure you are talking about C# which can be easily decompiled from exe?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9493777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576059322508517/picture?type=large", "display_name": "Yuval Dahan", "link": "https://stackoverflow.com/users/9493777/yuval-dahan"}, "edited": false, "score": 0, "creation_date": 1521061297, "post_id": 49287529, "comment_id": 85578097, "body": "its working thank you !!"}], "tags": [], "owner": {"reputation": 875, "user_id": 8269074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3QC7b.jpg?s=128&g=1", "display_name": "Vulpex", "link": "https://stackoverflow.com/users/8269074/vulpex"}, "is_accepted": false, "score": 2, "last_activity_date": 1521061169, "creation_date": 1521061169, "answer_id": 49287529, "question_id": 49287288, "link": "https://stackoverflow.com/questions/49287288/convert-code-in-c-to-exe-file/49287529#49287529", "title": "Convert code in c# to exe file", "body": "<p>When compiling your Code within Visual Studio, it will automatically generate a fully functional .exe file.</p>\n\n<p>The problem you're having is that the program is done doing his job and closes itself. You have to prevent it from closing itself. You can do that by adding a simple <code>Console.ReadLine();</code> at the end of your code.</p>\n\n<p>For Example: </p>\n\n<pre><code>using System;\n\npublic class Program\n{\n    public static void Main()\n    {\n        Console.WriteLine(\"Hello World\");\n        Console.ReadLine();\n    }\n}\n</code></pre>\n\n<p>That way the console will wait for any input before it continues to do it's work.</p>\n"}], "owner": {"reputation": 1, "user_id": 9493777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1576059322508517/picture?type=large", "display_name": "Yuval Dahan", "link": "https://stackoverflow.com/users/9493777/yuval-dahan"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2554, "favorite_count": 0, "closed_date": 1521061334, "answer_count": 1, "score": -3, "last_activity_date": 1521061169, "creation_date": 1521060158, "last_edit_date": 1521060391, "question_id": 49287288, "link": "https://stackoverflow.com/questions/49287288/convert-code-in-c-to-exe-file", "closed_reason": "Not suitable for this site", "title": "Convert code in c# to exe file", "body": "<p>I want to  convert my code to an exe file .The bin folder has an exe file of my code , but when I run this exe file after I enter the data the window closes me without printing me the results.\nWhen I run the code in visual studio it run successfully.\nI want my code to become an .exe file so people do not know what the code behind the .exe file is<a href=\"https://i.stack.imgur.com/EsPir.png\" rel=\"nofollow noreferrer\">This is the exe file on the bin folder</a></p>\n"}, {"tags": ["c#", "jquery", ".net", "ajax"], "comments": [{"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1521060208, "post_id": 49287231, "comment_id": 85577635, "body": "Maybe with something like <code>@Html.RadioButtonFor(model =&gt; model.SelectedAnswerID, Model.Questions[i].Answer[j].ID, new { @id = Model.Questions[i].Answer[j].ID})</code>"}, {"owner": {"reputation": 3, "user_id": 9493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbaea444a9bb6b2ab1cdfcbb50b1bcb9?s=128&d=identicon&r=PG&f=1", "display_name": "cnib", "link": "https://stackoverflow.com/users/9493746/cnib"}, "edited": false, "score": 0, "creation_date": 1521060457, "post_id": 49287231, "comment_id": 85577726, "body": "The value of respVM.SelectedAnswerID gets passed in from the radiobuttonlist on submit. The value of qid is then calculated based off that value to get the correct questionid for that answer. The value of respVM.TestName gets passed from the hiddenfield which gets it&#39;s value from the viewmodel. The viewmodel combines test, question, and answer models."}, {"owner": {"reputation": 1476, "user_id": 9405863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40cdcd740f2f6f607a21a66697131155?s=128&d=identicon&r=PG&f=1", "display_name": "user9405863", "link": "https://stackoverflow.com/users/9405863/user9405863"}, "edited": false, "score": 0, "creation_date": 1521060502, "post_id": 49287231, "comment_id": 85577751, "body": "it seems your posted data contains all the answers instead of posting single question and answer"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbaea444a9bb6b2ab1cdfcbb50b1bcb9?s=128&d=identicon&r=PG&f=1", "display_name": "cnib", "link": "https://stackoverflow.com/users/9493746/cnib"}, "edited": false, "score": 0, "creation_date": 1521061088, "post_id": 49287381, "comment_id": 85577994, "body": "Thank you so much! This is exactly what I needed, it&#39;s working perfectly now. And I really appreciate the explanation, I am still trying to learn how to use jquery/ajax so that helps me immensely moving forward to understand."}], "tags": [], "owner": {"reputation": 1143, "user_id": 8759952, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7d8e784fa5cd3e5a2dfe13b405fc1de1?s=128&d=identicon&r=PG&f=1", "display_name": "Liora Haydont", "link": "https://stackoverflow.com/users/8759952/liora-haydont"}, "is_accepted": true, "score": 0, "last_activity_date": 1521060541, "creation_date": 1521060541, "answer_id": 49287381, "question_id": 49287231, "link": "https://stackoverflow.com/questions/49287231/net-mvc-core-handling-form-inside-for-loop-with-jquery-ajax-only-returning-fi/49287381#49287381", "title": ".NET MVC Core handling form inside for loop with jquery/ajax - only returning first selection", "body": "<p>When you do this:</p>\n\n<pre><code>$('#myForm').serialize(),\n</code></pre>\n\n<p>You serialize the 1st object with an <code>id=\"myForm\"</code></p>\n\n<p>In your loop, you give all your forms the same id, so that's why it returns the 1st form everytime</p>\n\n<pre><code>&lt;form asp-action=\"Save\" id=\"myForm\"&gt;\n</code></pre>\n\n<p>Instead of giving them and id, you should give them a class, and then refer to them from the clicked button. Something like that :</p>\n\n<pre><code>&lt;form asp-action=\"Save\" class=\"myForm\"&gt;\n$(this).closest('.myForm').serialize()\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9493746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbaea444a9bb6b2ab1cdfcbb50b1bcb9?s=128&d=identicon&r=PG&f=1", "display_name": "cnib", "link": "https://stackoverflow.com/users/9493746/cnib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 49287381, "answer_count": 1, "score": 0, "last_activity_date": 1521060541, "creation_date": 1521059916, "question_id": 49287231, "link": "https://stackoverflow.com/questions/49287231/net-mvc-core-handling-form-inside-for-loop-with-jquery-ajax-only-returning-fi", "title": ".NET MVC Core handling form inside for loop with jquery/ajax - only returning first selection", "body": "<p>I might be close, but can't seem to figure out what is missing in this case. I have a view that creates a form inside the questions for loop, and then the only field that has to be selected is from the radio button list generated by the answers for loop.</p>\n\n<p>I am using jquery/ajax to post so that the page doesn't redirect on every submit. My code is working in that every time I click the saveLink button it creates a new record in the database. The problem is that when I select an answer for the first question, it saves the selectedquestionid and selectedanswerid of that question and answer, but when I move to the next question and select an answer, it saves the ids from the first question and answer again.</p>\n\n<p>I need it to save the correct ids. Can anyone point me in the right direction?</p>\n\n<p>View (simplified for brevity)</p>\n\n<pre><code>@for int(i = 0; i &lt; Model.Questions.Count; i++)\n{\n   &lt;form asp-action=\"Save\" id=\"myForm\"&gt;\n      &lt;div class=\"form-group\"&gt;\n          @Html.HiddenFor(model =&gt; model.TestName)\n          @Html.HiddenFor(model =&gt; model.SelectedQuestionID, Model.Questions[i].ID)\n\n          @Html.DisplayFor(model =&gt; model.Questions[i].QuestionText)\n          @for (int j = 0; j &lt; Model.Questions[i].Answers.Count; j++)\n          {\n               &lt;div&gt;\n                   @Html.RadioButtonFor(model =&gt; model.SelectedAnswerID, Model.Questions[i].Answer[j].ID)@Html.Label(\"\", Model.Questions[i].Answers[j].AnswerText)\n               &lt;/div&gt;\n          }\n      &lt;/div&gt;\n\n      &lt;div class=\"form-group\"&gt;\n          &lt;input type=\"button\" class=\"saveLink\" value=\"Save\" /&gt;\n      &lt;/div&gt;\n   &lt;/form&gt;\n}\n\n&lt;script type=\"text/javascript\"&gt;\n    $('.saveLink').click(function(e){\n        e.preventDefault;\n\n        $.ajax({\n            url:$(this).attr(\"href\"),\n            type:'POST',\n            data:$('#myForm').serialize(),\n            success:function(){\n                alert(\"Saved\");\n            }\n        });\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>Controller method</p>\n\n<pre><code>[HttpPost]\npublic void Save(RespVM respVM)\n{\n   if (ModelState.IsValid)\n   {\n      var qid = _context.Answer.Where(a =&gt; a.ID == respVM.SelectedAnswerID).Select(a =&gt; a.QuestionID).FirstOrDefault();\n\n      var RespModel = new Resp\n      {\n          SelectedQuestionID = qid,\n          SelectedAnswerID = respVM.SelectedAnswerID,\n          TestName = respVM.TestName,\n      }\n\n      _context.Add(RespModel);\n      _context.SaveChanges();\n   }\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "azure"], "comments": [{"owner": {"reputation": 36989, "user_id": 3850405, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b2b9eece8c493ba7ddcff82f845ff2af?s=128&d=identicon&r=PG&f=1", "display_name": "Ogglas", "link": "https://stackoverflow.com/users/3850405/ogglas"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521059855, "post_id": 49287176, "comment_id": 85577481, "body": "@mjwills West Europe - I could create the server there on this subscription without a problem."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521059885, "post_id": 49287176, "comment_id": 85577491, "body": "Does <a href=\"https://sitecore.stackexchange.com/questions/9075/when-attempting-to-deploy-i-get-restricted-from-provisioning-in-this-region\" title=\"when attempting to deploy i get restricted from provisioning in this region\">sitecore.stackexchange.com/questions/9075/&hellip;</a> help? If it doesn&#39;t you likely need to contact Support like the exception says."}, {"owner": {"reputation": 36989, "user_id": 3850405, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b2b9eece8c493ba7ddcff82f845ff2af?s=128&d=identicon&r=PG&f=1", "display_name": "Ogglas", "link": "https://stackoverflow.com/users/3850405/ogglas"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521060052, "post_id": 49287176, "comment_id": 85577567, "body": "@mjwills - Unfortunately not. I&#39;m using <code>Visual Studio Enterprise Subscription</code> and <code>West Europe</code> is covered. I could also create the server in the first place through their portal."}], "answers": [{"tags": [], "owner": {"reputation": 36989, "user_id": 3850405, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b2b9eece8c493ba7ddcff82f845ff2af?s=128&d=identicon&r=PG&f=1", "display_name": "Ogglas", "link": "https://stackoverflow.com/users/3850405/ogglas"}, "is_accepted": true, "score": 0, "last_activity_date": 1521060697, "creation_date": 1521060697, "answer_id": 49287420, "question_id": 49287176, "link": "https://stackoverflow.com/questions/49287176/azure-msg-45122-subscriptions-are-restricted-from-provisioning-in-this-reg/49287420#49287420", "title": "Azure -&gt; Msg 45122 -&gt; Subscriptions are restricted from provisioning in this region. Please choose a different region", "body": "<p>I cant say why this happened. I logged into the Portal and tried to create a database through their website but I got a deploy failed notification almost instantly. This was for an S0 database as well. I then tried to create an S1 database and out of the blue it started working. I then deleted this database and tried to create an S0 again. Now it worked. </p>\n\n<p>This was the first SQL Database I tried to create on this subscription and perhaps some flag was not set yet. Just glad it started working by itself and no support request was needed.</p>\n"}], "owner": {"reputation": 36989, "user_id": 3850405, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b2b9eece8c493ba7ddcff82f845ff2af?s=128&d=identicon&r=PG&f=1", "display_name": "Ogglas", "link": "https://stackoverflow.com/users/3850405/ogglas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "accepted_answer_id": 49287420, "answer_count": 1, "score": 0, "last_activity_date": 1521060697, "creation_date": 1521059666, "question_id": 49287176, "link": "https://stackoverflow.com/questions/49287176/azure-msg-45122-subscriptions-are-restricted-from-provisioning-in-this-reg", "title": "Azure -&gt; Msg 45122 -&gt; Subscriptions are restricted from provisioning in this region. Please choose a different region", "body": "<p>I got a weird error today. When I try to deploy a database to an existing Azure SQL server I get the following error in Microsoft SQL Server Management Studio:</p>\n\n<blockquote>\n  <p>Could not import package. Warning SQL0: A project which specifies SQL\n  Server 2016 as the target platform may experience compatibility issues\n  with Microsoft Azure SQL Database v12. Error SQL72014: .Net SqlClient\n  Data Provider: Msg 45122, Level 16, State 1, Line 1 'Subscriptions are\n  restricted from provisioning in this region. Please choose a different\n  region. For exceptions to this rule please contact Microsoft Support.'\n  Error SQL72045: Script execution error.  The executed script: CREATE\n  DATABASE [$(DatabaseName)] COLLATE SQL_Latin1_General_CP1_CI_AS\n      (EDITION = 'Standard', SERVICE_OBJECTIVE = 'S0', MAXSIZE = 250 GB)  (Microsoft.SqlServer.Dac)</p>\n</blockquote>\n\n<p>Why is this? I could create the Sql Server in region <code>West Europe</code> without a problem. I'm using the <code>Visual Studio Enterprise \u2013 MPN</code> subscription in this case. </p>\n\n<p><a href=\"https://i.stack.imgur.com/oLn7c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oLn7c.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "linq"], "comments": [{"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1521060402, "post_id": 49287173, "comment_id": 85577705, "body": "You have made a good start here, but if you improve your existing program you will find it easier to modify it to do what you want.  You are using lists, but lists are not the best data structure to solve the problem you have. Do you know what a <code>Dictionary</code> is?  Can you make a program that maintains a <code>Dictionary&lt;int, int&gt;</code> where the key is the unique number, and the value is the count of the number of times the unique number appears?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1521060567, "post_id": 49287173, "comment_id": 85577782, "body": "You can also improve your program by breaking up your <code>Main</code> method into many smaller methods.  For example, it would be better to say <code>var generated = GenerateList();</code> and then make a method <code>private static List&lt;int&gt; GenerateList() { var random = new Random(); var generated = new List&lt;int&gt;(); for ( ... ) { ... } return generated; }</code> because (1) that makes your <code>Main</code> easier to understand, and (2) it lets you improve <code>GenerateList</code> later. Break up your <code>Main</code> into many smaller methods, each of which does one thing <i>extremely well</i>."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 1, "creation_date": 1521061380, "post_id": 49287173, "comment_id": 85578142, "body": "@mjwills: That&#39;s a good point -- which speaks to my larger point.  <b>By isolating implementation decisions into methods we can then attempt to improve those methods independently</b>. Upon code reviewing we might note that multiple calls in close succession could generate the same list, and then consider different ways to mitigate the problem. &quot;Make the <code>Random</code> static&quot; would be one, but there are many possible solutions."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9493757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462654297190525/picture?type=large", "display_name": "Mateusz Dolasi\u0144ski", "link": "https://stackoverflow.com/users/9493757/mateusz-dolasi%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1521217323, "post_id": 49288036, "comment_id": 85652161, "body": "Your first proposition seems the most suitable for me. Thanks for this, I must admit that i have no idea I can use Dictionary for this but as I mentioned - I&#39;m new in programming and I have a lot to lern."}], "tags": [], "owner": {"reputation": 26, "user_id": 1695966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e99b87a87ddbeb0482f8129b49bbe8d1?s=128&d=identicon&r=PG", "display_name": "Benj", "link": "https://stackoverflow.com/users/1695966/benj"}, "is_accepted": true, "score": 0, "last_activity_date": 1521063526, "creation_date": 1521063526, "answer_id": 49288036, "question_id": 49287173, "link": "https://stackoverflow.com/questions/49287173/finding-item-with-specific-value-moving-and-deleting-it-c-linq/49288036#49288036", "title": "Finding Item with specific value, moving and deleting it. c#,linq", "body": "<p>LINQ has many operations that can help solve this problem using only a single collection. The following example starts with a <code>List&lt;int&gt;</code> of generated values, calculates how many times each unique number appears, and then takes the 5 values with the most appearances. Note that the original list is actually unaffected. By design, LINQ does not modify the original collection, instead returning new collections that can be enumerated.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace Example\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            var generated = GenerateList();\n\n            var uniqueItems = generated\n                // Groups each number by the given key (itself). Each group will contain one distinct number\n                .GroupBy(x =&gt; x)\n                // Creates key/value pairs. The key is the unique number. The value is the number of appearances\n                .ToDictionary(group =&gt; group.Key, group =&gt; group.Count());\n\n            Console.WriteLine(\"Number of generated items: \" + generated.Count);\n            Console.WriteLine(\"Unique items number: \" + uniqueItems.Count);\n            foreach (var item in uniqueItems)\n            {\n                Console.WriteLine($\"{item.Key} = {item.Value}\");\n            }\n\n            var highestFive = uniqueItems\n                // Sort the items by their appearances (highest first)\n                .OrderByDescending(item =&gt; item.Value)\n                // Only keep the first 5 items\n                .Take(5);\n\n            Console.WriteLine(\"Numbers with the highest 5 occurrences\");\n            foreach (var item in highestFive)\n            {\n                Console.WriteLine(item.Key);\n            }\n\n            /* Output:\n             * Number of generated items: 20\n             * Unique items number: 6\n             * 10 = 2\n             * 25 = 3\n             * 30 = 5\n             * 45 = 4\n             * 5 = 5\n             * 15 = 1\n             * Numbers with the highest 5 occurrences\n             * 30\n             * 5\n             * 45\n             * 25\n             * 10\n             */\n        }\n\n        private static List&lt;int&gt; GenerateList()\n        {\n            // For simplicity, using known variables\n            // This function could generate any type of list you want\n            return new List&lt;int&gt;\n            {\n                10, 25, 30, 45, 30, 45, 25, 30, 25, 30, 5, 5, 15, 30, 45, 10, 45, 5, 5, 5\n            };\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>An alternative method would be to calculate the frequency of each number as they are generated using a <code>Dictionary&lt;int, int&gt;</code>, as <a href=\"https://stackoverflow.com/users/88656/eric-lippert\">Eric Lippert</a> has already suggested. The following example uses a Dictionary and therefore doesn't need to perform the <code>GroupBy</code> operation of the previous example.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace Example\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            var generated = 0;\n            var random = new Random();\n            var items = new Dictionary&lt;int, int&gt;();\n\n            for (int i = 0; i &lt; 2400; i++)\n            {\n                var number = random.Next(1, 50);\n                generated++; // Keep track of how many have been generated\n\n                if (items.ContainsKey(number))\n                {\n                    // If the number is not unique, increase its appearances by 1\n                    items[number]++;\n                }\n                else\n                {\n                    // If the number is unique, set its appearances to 1\n                    items.Add(number, 1);\n                }\n            }\n\n            Console.WriteLine(\"Number of generated items: \" + generated);\n            Console.WriteLine(\"Unique items number: \" + items.Count);\n            foreach (var item in items)\n            {\n                Console.WriteLine($\"{item.Key} = {item.Value}\");\n            }\n\n            var highestFive = items\n                // Sort the items by their appearances (highest first)\n                .OrderByDescending(item =&gt; item.Value)\n                // Only keep the first 5 items\n                .Take(5);\n\n            Console.WriteLine(\"Numbers with the highest 5 occurrences\");\n            foreach (var item in highestFive)\n            {\n                Console.WriteLine(item.Key);\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9493757, "user_type": "registered", "profile_image": "https://graph.facebook.com/1462654297190525/picture?type=large", "display_name": "Mateusz Dolasi\u0144ski", "link": "https://stackoverflow.com/users/9493757/mateusz-dolasi%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 49288036, "answer_count": 1, "score": 0, "last_activity_date": 1521213358, "creation_date": 1521059658, "last_edit_date": 1521064474, "question_id": 49287173, "link": "https://stackoverflow.com/questions/49287173/finding-item-with-specific-value-moving-and-deleting-it-c-linq", "title": "Finding Item with specific value, moving and deleting it. c#,linq", "body": "<p>This program should generate numbers, then choose unique numbers and count how many times this number appears during generation - it is working for now.</p>\n\n<p>Now I need to choose eg.5 Items with highest item.value and display them like:</p>\n\n<p>name(just unique number) = value(number of apperances)</p>\n\n<p>5 = 40</p>\n\n<p>6 = 70\n...</p>\n\n<p>For now I only find Item with highest value.\nAny tips how can I choose Item with highest value I've found, move it to another list, delete it from original list and then display all Items with highest values?</p>\n\n<p>It's my first post since I've just started to learn programming so sorry for mistakes.   </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace Lotto_2._0\n{\n    class Program\n    {\n        static void Main()\n        {\n            var generated = new List&lt;int&gt;();\n            var random = new Random();\n            var uniques = new List&lt;int&gt;();\n            var itemList = new List&lt;Item&gt;();\n            var maxValueList = new List&lt;int&gt;();\n\n            // Random numbers generating (from 1 to 49)\n            for (int i = 0; i &lt; 2400; i++)\n            {\n                var number = random.Next(1, 50);\n                generated.Add(number);\n            }\n\n            // Unique numbers selecting\n            foreach (var number in generated)\n            {\n                if (!uniques.Contains(number)) uniques.Add(number);\n            }\n\n            Console.WriteLine(\"Number of generated items: \" + generated.Count);\n            Console.WriteLine(\"Unique items number: \" + uniques.Count);\n\n            // Unique number repeating count\n            foreach (var unique in uniques)\n            {\n                var countedUniques = 0;\n                foreach (var number in generated)\n                {\n                    if (unique == number)\n                        countedUniques ++;\n                }\n                // Save to itemList\n                var item = new Item(unique,countedUniques);\n                itemList.Add(item);\n            }\n\n            var editedItemList = itemList;\n            foreach (var item in itemList)\n                Console.WriteLine($\"{item.Name} = {item.Value}\");\n\n            // Searching max value item\n            var maxValue = editedItemList.Max( x =&gt; x.Value);\n            maxValueList.Add(maxValue);\n            Console.WriteLine(maxValue);\n        }\n    }\n\n    public class Item\n    {\n        public int Name { get; protected set; }\n        public int Value { get; protected set; }\n\n        public Item(int name, int value)\n        {\n            Name = name;\n            Value = value;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "xml", "deserialization", "xmlserializer", "xml-deserialization"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 2147919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9a10ede77ae231e4f2c00082e2ef80c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/2147919/kal"}, "edited": false, "score": 0, "creation_date": 1521061726, "post_id": 49287244, "comment_id": 85578314, "body": "Thank you for the reply, Marc! Your &quot;evil shadowing&quot; solution does indeed work. Would you by any chance think of a single-property solution? (without the EvilUrmDevices reflected in the Accounts object)"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 99, "user_id": 2147919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9a10ede77ae231e4f2c00082e2ef80c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/2147919/kal"}, "edited": false, "score": 0, "creation_date": 1521066748, "post_id": 49287244, "comment_id": 85580494, "body": "@Kalnius if I could think of one, I would have posted it"}, {"owner": {"reputation": 99, "user_id": 2147919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9a10ede77ae231e4f2c00082e2ef80c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/2147919/kal"}, "edited": false, "score": 0, "creation_date": 1521066811, "post_id": 49287244, "comment_id": 85580521, "body": "Makes sense. Silly [desperate] question."}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": true, "score": 1, "last_activity_date": 1521059959, "creation_date": 1521059959, "answer_id": 49287244, "question_id": 49287153, "link": "https://stackoverflow.com/questions/49287153/xml-deserialization-of-a-list-in-an-optional-element/49287244#49287244", "title": "XML Deserialization of a List in an optional Element", "body": "<p>A really nasty hack might be:</p>\n\n<pre><code>[XmlRoot(\"Account\")]\npublic class Account\n{\n    [XmlArray(\"UrmDevices\", IsNullable = true)]\n    [XmlArrayItem(\"UrmDevice\")]\n    public List&lt;UrmDevice&gt; UrmDevices { get; set; }\n\n    [XmlElement(\"UrmDevice\")] // shadow UrmDevices with different layout\n    public List&lt;UrmDevice&gt; EvilUrmDevices {\n        get { return UrmDevices; }\n        set { UrmDevices = value; }\n    }\n\n    // disable serialize of one of the two\n    public bool ShouldSerializeEvilUrmDevices() { return false; }\n\n    [XmlAttribute]\n    public string Id { get; set; }\n}\n</code></pre>\n\n<p>completely untested, and... shudder.</p>\n"}], "owner": {"reputation": 99, "user_id": 2147919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9a10ede77ae231e4f2c00082e2ef80c?s=128&d=identicon&r=PG&f=1", "display_name": "Kal", "link": "https://stackoverflow.com/users/2147919/kal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 49287244, "answer_count": 1, "score": 1, "last_activity_date": 1521059959, "creation_date": 1521059596, "question_id": 49287153, "link": "https://stackoverflow.com/questions/49287153/xml-deserialization-of-a-list-in-an-optional-element", "title": "XML Deserialization of a List in an optional Element", "body": "<p>I have two possible xmls to deserialize.</p>\n\n<p>Without the <code>&lt;UrmDevices&gt;</code> node:</p>\n\n<pre><code>&lt;Account Id=\"1514478\"&gt;\n   &lt;UrmDevice Id=\"66e24068-4ef4-4f7e-a675-a67bb8497611\" FriendlyName=\"Device1\" RegisteredTime=\"2018-03-13T07:54:03Z\" LastUsed=\"2018-03-13T07:54:03Z\" DeviceType=\"\"/&gt;\n   &lt;UrmDevice Id=\"9ead24cf-978c-4bbf-bd87-4e5d08c9c0d0\" FriendlyName=\"Device2\" RegisteredTime=\"2018-03-13T07:54:02Z\" LastUsed=\"2018-03-13T07:54:02Z\" DeviceType=\"\"/&gt;\n&lt;/Account&gt;\n</code></pre>\n\n<p>With the <code>&lt;UrmDevices&gt;</code> node:</p>\n\n<pre><code>&lt;Account Id=\"1514478\"&gt;\n   &lt;UrmDevices&gt;\n      &lt;UrmDevice Id=\"66e24068-4ef4-4f7e-a675-a67bb8497611\" FriendlyName=\"Device1\" RegisteredTime=\"2018-03-13T07:54:03Z\" LastUsed=\"2018-03-13T07:54:03Z\" DeviceType=\"\"/&gt;\n      &lt;UrmDevice Id=\"9ead24cf-978c-4bbf-bd87-4e5d08c9c0d0\" FriendlyName=\"Device2\" RegisteredTime=\"2018-03-13T07:54:02Z\" LastUsed=\"2018-03-13T07:54:02Z\" DeviceType=\"\"/&gt;\n   &lt;/UrmDevices&gt;\n&lt;/Account&gt;\n</code></pre>\n\n<p>Class currently looks like this:</p>\n\n<pre><code>[XmlType(AnonymousType = true)]\n[XmlRoot(\"Account\")]\npublic class Account\n{\n    [XmlArray(\"UrmDevices\", IsNullable = true)]\n    [XmlArrayItem(\"UrmDevice\")]\n    public List&lt;UrmDevice&gt; UrmDevices { get; set; }\n\n    [XmlAttribute]\n    public string Id { get; set; }\n}\n</code></pre>\n\n<p>I would like the <code>&lt;UrmDevices&gt;</code> to be ignored so the object would be Account.UrmDevices regardless of the <code>&lt;UrmDevices&gt;</code> existance.</p>\n\n<p>So far I have tried IsNullable attributes (as shown in the code above), <a href=\"https://stackoverflow.com/questions/6927452/xml-deserialization-deserialize-missing-element-into-null-property-value\">this</a>, which is not actually a solution... Any thoughts appreciated.</p>\n"}, {"tags": ["c#", "windows", "uwp", "serial-port"], "comments": [{"owner": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 1, "creation_date": 1521059865, "post_id": 49287119, "comment_id": 85577484, "body": "How did you set <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.storage.streams.datareader#Windows_Storage_Streams_DataReader_InputStreamOptions\" rel=\"nofollow noreferrer\">InputStreamOptions</a>? The size of the buffer shouldn&#39;t really matter (you just read it in a loop). Also note you can use .NET Stream APIs if you prefer."}, {"owner": {"reputation": 384, "user_id": 8055386, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d491a53fa8be8634844713275c34df89?s=128&d=identicon&r=PG&f=1", "display_name": "Shocky2", "link": "https://stackoverflow.com/users/8055386/shocky2"}, "reply_to_user": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 0, "creation_date": 1521060569, "post_id": 49287119, "comment_id": 85577783, "body": "@PeterTorr-MSFT Cloud the loop be executed in a separate thread? Could you show me an example? I didn&#39;t set the InputStreamOptions in any way explicitly."}, {"owner": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 0, "creation_date": 1521061061, "post_id": 49287119, "comment_id": 85577980, "body": "Does <a href=\"https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/SerialArduino\" rel=\"nofollow noreferrer\">the official Serial sample</a> help?"}, {"owner": {"reputation": 384, "user_id": 8055386, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d491a53fa8be8634844713275c34df89?s=128&d=identicon&r=PG&f=1", "display_name": "Shocky2", "link": "https://stackoverflow.com/users/8055386/shocky2"}, "reply_to_user": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 0, "creation_date": 1521061917, "post_id": 49287119, "comment_id": 85578405, "body": "@PeterTorr-MSFT Thank you for googling it for me. I&#39;ve found a similar official project and done everything, just not the cancellation token and lock things. I doubt that the problem lies there, but I will try it."}, {"owner": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 2, "creation_date": 1521062058, "post_id": 49287119, "comment_id": 85578469, "body": "I use Bing :-) but cancellation is not required. If you still have problems you will need to post a minimal reproduction. And it might be hard to help since it requires specific hardware."}, {"owner": {"reputation": 384, "user_id": 8055386, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d491a53fa8be8634844713275c34df89?s=128&d=identicon&r=PG&f=1", "display_name": "Shocky2", "link": "https://stackoverflow.com/users/8055386/shocky2"}, "reply_to_user": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 0, "creation_date": 1521069872, "post_id": 49287119, "comment_id": 85581514, "body": "@PeterTorr-MSFT That is cool too :) I didn&#39;t solve the problem, but I will try something else tomorrow... What do you mean by &quot;minimal reproduction&quot;?"}, {"owner": {"reputation": 384, "user_id": 8055386, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d491a53fa8be8634844713275c34df89?s=128&d=identicon&r=PG&f=1", "display_name": "Shocky2", "link": "https://stackoverflow.com/users/8055386/shocky2"}, "reply_to_user": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 0, "creation_date": 1521098530, "post_id": 49287119, "comment_id": 85589505, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/166871/discussion-between-shocky2-and-peter-torr-msft\">continue this discussion in chat</a>."}, {"owner": {"reputation": 174, "user_id": 4292508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I3eSk2G8HUI/AAAAAAAAAAI/AAAAAAAAAPw/F5uIPQBrQig/photo.jpg?sz=128", "display_name": "Filipe Madureira", "link": "https://stackoverflow.com/users/4292508/filipe-madureira"}, "edited": false, "score": 0, "creation_date": 1576496507, "post_id": 49287119, "comment_id": 104906419, "body": "Sigh, I wish the discussion didn&#39;t continue in chat."}, {"owner": {"reputation": 384, "user_id": 8055386, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d491a53fa8be8634844713275c34df89?s=128&d=identicon&r=PG&f=1", "display_name": "Shocky2", "link": "https://stackoverflow.com/users/8055386/shocky2"}, "reply_to_user": {"reputation": 174, "user_id": 4292508, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-I3eSk2G8HUI/AAAAAAAAAAI/AAAAAAAAAPw/F5uIPQBrQig/photo.jpg?sz=128", "display_name": "Filipe Madureira", "link": "https://stackoverflow.com/users/4292508/filipe-madureira"}, "edited": false, "score": 0, "creation_date": 1576853228, "post_id": 49287119, "comment_id": 105040298, "body": "@FilipeMadureira Sadly, the problem wasn&#39;t solved back then. We solved the problem by writing another application that used .NET Framework which communicated with our .NET Core application through a web socket."}], "owner": {"reputation": 384, "user_id": 8055386, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d491a53fa8be8634844713275c34df89?s=128&d=identicon&r=PG&f=1", "display_name": "Shocky2", "link": "https://stackoverflow.com/users/8055386/shocky2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1516, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1567175532, "creation_date": 1521059404, "last_edit_date": 1567175532, "question_id": 49287119, "link": "https://stackoverflow.com/questions/49287119/reading-from-a-serial-port-in-uwp", "title": "Reading from a serial port in UWP", "body": "<p>Using <code>Windows.Devices.SerialCommunication</code>, how could I read data from a serial port? </p>\n\n<p>I initialize the <code>SerialDevice</code> class, instantiate <code>DataReader</code> and <code>DataWriter</code> classes using the adequate streams of the device. I can write to the device (device does what it is intended) as </p>\n\n<pre><code>        byte[] vs = {'b','t'};\n        _dataWriter.WriteBytes(vs);\n        await _dataWriter.StoreAsync();\n</code></pre>\n\n<p>But I can't read the response of the device. The device definitely responds, it is specified in the device protocol (<code>CashCode</code> protocol). I communicated with the device using a.NET Framework app perfectly. </p>\n\n<p>I try to read in multiple ways, for instance I tried this: </p>\n\n<pre><code>            uint i = await _dataReader.LoadAsync(BufferSize);\n            if (i &gt; 0)\n                await _dataReader.LoadAsync(i);\n            _dataReader.ReadBytes(res);\n</code></pre>\n\n<p>The problem is also that I don't know the exact <code>BufferSize</code>. This never reads anything. </p>\n\n<p>I am making a <code>UWP</code> (, it has to be) app. I made a .NET framework app which works as intended, but it turns out that I can't use it in this project. The serial device is <code>Suzo Happ Bill-to-Bill unit</code>. Maybe this issue is connected with <a href=\"https://stackoverflow.com/questions/49256707/problems-with-serial-device-communication-in-uwp\">this one</a>.</p>\n"}, {"tags": ["c#", "visual-studio", "api", "asp.net-core", "identityserver4"], "answers": [{"comments": [{"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1521059720, "post_id": 49287162, "comment_id": 85577421, "body": "Please discuss the advantage of using a token server, and not what it doesn&#39;t do"}, {"owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "reply_to_user": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 2, "creation_date": 1521059918, "post_id": 49287162, "comment_id": 85577509, "body": "I&#39;m missing your point - It is obvious that he has already chosen the technologies, and is just asking what are the disadvantages of running the server and the API in the same project. And this is what I&#39;m answering."}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1521060229, "post_id": 49287162, "comment_id": 85577641, "body": "OP &quot;In (almost) all the examples found of IdentityServer4 the IdentityServer host and API&#39;s are separate projects, what are the advantages of hosting the two as separate projects.&quot; -&gt; Why should my token server be seperate from my application"}, {"owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "reply_to_user": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 2, "creation_date": 1521060622, "post_id": 49287162, "comment_id": 85577805, "body": "Well, I&#39;ve also answered this - Single responsibility. The token server&#39;s job is to issue and validate tokens. Its not his job to deal with user CRUD operations."}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1521062290, "post_id": 49287162, "comment_id": 85578591, "body": "That&#39;s a bit terse, but this question is a bit vague so I&#39;ll give you the upvote"}, {"owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "edited": false, "score": 0, "creation_date": 1521062650, "post_id": 49287162, "comment_id": 85578773, "body": "@m3n7alsnak3 Thanks for clearing it up! The only thing i&#39;m still confused about is then why the asp.net identity part, which (if I am not wrong) is also a part of Database information (user data like usernames and passwords) is implemented in the IndetiyServer host while the User part is done, or should be done, in the API?"}, {"owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "edited": false, "score": 0, "creation_date": 1521062835, "post_id": 49287162, "comment_id": 85578867, "body": "Identity server is reading from the database, to validate the user info, so that it can do his job - authenticate or not"}, {"owner": {"reputation": 1681, "user_id": 4422118, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/40bf6bb2b82a5f6c265fb32f2433f36d?s=128&d=identicon&r=PG&f=1", "display_name": "JakeJ", "link": "https://stackoverflow.com/users/4422118/jakej"}, "edited": false, "score": 0, "creation_date": 1521149899, "post_id": 49287162, "comment_id": 85621338, "body": "If you look up authentication versus authorization, as well as look up Dominick Baier&#39;s remarks on the subject, that will clear things up a bit."}, {"owner": {"reputation": 414, "user_id": 2065733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBGC0.jpg?s=128&g=1", "display_name": "Harutyun Imirzyan", "link": "https://stackoverflow.com/users/2065733/harutyun-imirzyan"}, "edited": false, "score": 0, "creation_date": 1552343139, "post_id": 49287162, "comment_id": 96965343, "body": "@m3n7alsnak3 You say &quot;Identity Server should not authenticate its own API against himself.&quot;. So it isn&#39;t clear to me what do you suggest. How to authenticate the API?"}, {"owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "edited": false, "score": 2, "creation_date": 1552345536, "post_id": 49287162, "comment_id": 96966007, "body": "I suggest that you have 2 different projects. And the API, responsible for the CRUD operations over the users, should not be part of the Identity Server project, because it&#39;s not it&#39;s responsibility. The token server only authenticates (issues a token based on some credentials) and that&#39;s it. All other operations over these users, should be done separately and not as part of the token server."}, {"owner": {"reputation": 414, "user_id": 2065733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBGC0.jpg?s=128&g=1", "display_name": "Harutyun Imirzyan", "link": "https://stackoverflow.com/users/2065733/harutyun-imirzyan"}, "edited": false, "score": 0, "creation_date": 1552373427, "post_id": 49287162, "comment_id": 96972855, "body": "@m3n7alsnak3 oh, I had misunderstood you. So we can have a separate API for user management stuff and we can authenticate to that api via identity server"}, {"owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "reply_to_user": {"reputation": 414, "user_id": 2065733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBGC0.jpg?s=128&g=1", "display_name": "Harutyun Imirzyan", "link": "https://stackoverflow.com/users/2065733/harutyun-imirzyan"}, "edited": false, "score": 2, "creation_date": 1552402248, "post_id": 49287162, "comment_id": 96990216, "body": "@HarutyunImirzyan - Yes, this is exactly what I wanted to say."}], "tags": [], "owner": {"reputation": 2563, "user_id": 6462951, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KE4W2.jpg?s=128&g=1", "display_name": "m3n7alsnak3", "link": "https://stackoverflow.com/users/6462951/m3n7alsnak3"}, "is_accepted": true, "score": 7, "last_activity_date": 1521059617, "creation_date": 1521059617, "answer_id": 49287162, "question_id": 49286951, "link": "https://stackoverflow.com/questions/49286951/what-are-the-advantages-of-hosting-your-apis-and-identityserver4-host-separate/49287162#49287162", "title": "What are the advantages of hosting your API(s) and IdentityServer4 host separately (C#, .NET CORE)?", "body": "<p>I would say Single Responsibility.</p>\n\n<p>Treat it like this - Identity Server is a framework, that provides you the authentication against your clients/API's. That's it! (of course this is all done based on your rules, policies etc).</p>\n\n<p>It is not Identity Servers' purpose to add/edit/delete users from your database. It is not Identity Servers' purpose to give roles to this users.\nAnd most important - it is not Identity Servers' purpose to authorize this users.</p>\n\n<p>All these must be done in your clients/api's. </p>\n\n<p>In your case - you need a separate API that will take care for the users (and other data that you need), but I guess that you want this API to be protected by Identity Server. </p>\n\n<p>This is where the separation comes and should be kept - Identity Server should not authenticate its own API against himself.</p>\n\n<p>There is a reason that all the examples, articles and etc are with separated projects.</p>\n\n<p>PS: Of course there are some examples of achieving this (<a href=\"https://damienbod.com/2016/10/01/identityserver4-webapi-and-angular2-in-a-single-asp-net-core-project/\" rel=\"noreferrer\">damienbod's one</a> is good).</p>\n"}], "owner": {"reputation": 1849, "user_id": 3242154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c368f3140571a8d9a652dcf4607d549?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/3242154/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2564, "favorite_count": 5, "closed_date": 1521062398, "accepted_answer_id": 49287162, "answer_count": 1, "score": 5, "last_activity_date": 1521059617, "creation_date": 1521058674, "question_id": 49286951, "link": "https://stackoverflow.com/questions/49286951/what-are-the-advantages-of-hosting-your-apis-and-identityserver4-host-separate", "closed_reason": "Opinion-based", "title": "What are the advantages of hosting your API(s) and IdentityServer4 host separately (C#, .NET CORE)?", "body": "<p>Perhaps the question I am about to ask is very obvious and simple, but as a beginner in IdentityServer4 and more or less in oAuth2, OpenID and API's in general, I find it quite hard to understand.</p>\n\n<p>Our company's goal is to move to a more secure application building way (Visual Studio 2017, C#, .NET Core 2) using Authentication and Authorization. After some days of research I ended up with using IdentityServer4 (also because the documentation is really great). </p>\n\n<p>After following the IdentityServer Documentation (<a href=\"https://media.readthedocs.org/pdf/identityserver4/release/identityserver4.pdf\" rel=\"noreferrer\">https://media.readthedocs.org/pdf/identityserver4/release/identityserver4.pdf</a>) up till chapter 7, I have one remaining. </p>\n\n<p>I am trying to build a MVC application (web) with an API backend for retrieving / inserting the data so that I can later use the API for other applications, like a SPA / Xamarin application. For the IdentityServer host I went for IdentityServer with asp.net identity. I got it running and it all works great, however the following question remains: </p>\n\n<p>What are the disadvantages of hosting my API, in which I want to handle Database operations, together with the IdentityServer host? \nIt doesn't seem logical to me to have so many different projects while (so far as I can tell) these 2 (the API and IdentityServer host) can be joined together perfectly fine. </p>\n\n<p>In (almost) all the examples found of IdentityServer4 the IdentityServer host and API's are separate projects, what are the advantages of hosting the two as separate projects. </p>\n"}, {"tags": ["c#", "asp.net-web-api", "asp.net-web-api-routing"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3749344, "user_type": "registered", "profile_image": "https://graph.facebook.com/656240892/picture?type=large", "display_name": "bravelad", "link": "https://stackoverflow.com/users/3749344/bravelad"}, "edited": false, "score": 0, "creation_date": 1521065719, "post_id": 49287936, "comment_id": 85580098, "body": "Thank you for the suggestion, unfortunately that did not do the trick.  Ideally, I would like there to only be the single post method available for this service, but  if I isolate it to a single post route, I get the 405.  It&#39;s a common suggestion that works in some cases, but not for mine."}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "reply_to_user": {"reputation": 23, "user_id": 3749344, "user_type": "registered", "profile_image": "https://graph.facebook.com/656240892/picture?type=large", "display_name": "bravelad", "link": "https://stackoverflow.com/users/3749344/bravelad"}, "edited": false, "score": 0, "creation_date": 1521066485, "post_id": 49287936, "comment_id": 85580397, "body": "@bravelad figured it out. You were setting up the wrong route collection."}], "tags": [], "owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "is_accepted": false, "score": 0, "last_activity_date": 1521066461, "last_edit_date": 1521066461, "creation_date": 1521063038, "answer_id": 49287936, "question_id": 49286946, "link": "https://stackoverflow.com/questions/49286946/routes-and-the-dreaded-405/49287936#49287936", "title": "Routes and the dreaded 405", "body": "<p>You mentioned <code>RouteConfig</code> File. This is used for configuring the MVC routes not Web API routes.</p>\n\n<p>So it would appear you are configuring the wrong file which would explain why the <code>api/...</code> path works as it is probably mapping to the default configuration in <code>WebApiConfig.Register</code>, which would look like</p>\n\n<pre><code>public static class WebApiConfig {\n    public static void Register(HttpConfiguration config) {\n        // Convention-based routing.\n        config.Routes.MapHttpRoute(\n            name: \"DefaultApi\",\n            routeTemplate: \"api/{controller}/{id}\",\n            defaults: new { id = RouteParameter.Optional }\n        );\n    }\n}\n</code></pre>\n\n<p>You would need to update that file with the other desired route</p>\n\n<pre><code>public static class WebApiConfig {\n    public static void Register(HttpConfiguration config) {\n        // Convention-based routing.\n        config.Routes.MapHttpRoute(\n            name: \"app-events\",\n            routeTemplate: \"events\",\n            defaults: new { controller = \"Events\" },\n            handler: new GZipToJsonHandler(GlobalConfiguration.Configuration),\n            constraints: null\n        );\n\n        config.Routes.MapHttpRoute(\n            name: \"DefaultApi\",\n            routeTemplate: \"api/{controller}/{id}\",\n            defaults: new { id = RouteParameter.Optional }\n        );\n    }\n}\n</code></pre>\n\n<p>Web API routes are usually registered before MVC routes which explains why it was not working with your original configuration.</p>\n\n<p>You should also adorn the action with the respective <code>Http{Verb}</code> attribute. </p>\n\n<p>In this case <code>HttpPost</code> so that the route table knows how to handle POST requests that match the route template.</p>\n\n<pre><code>[HttpPost]\npublic async Task&lt;IHttpActionResult&gt; Post() {\n    var requestMessage = this.Request;\n\n    // async doing fun stuff here\u2026.\n\n   return OK();\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3749344, "user_type": "registered", "profile_image": "https://graph.facebook.com/656240892/picture?type=large", "display_name": "bravelad", "link": "https://stackoverflow.com/users/3749344/bravelad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521066461, "creation_date": 1521058660, "last_edit_date": 1521063122, "question_id": 49286946, "link": "https://stackoverflow.com/questions/49286946/routes-and-the-dreaded-405", "title": "Routes and the dreaded 405", "body": "<p>I've got a simple web API that registers on one route. At the moment I've got two because only one of them does what I need.</p>\n\n<p>My application only has one controller and one Post method in that Controller. I've registered a single Route which always returns a <code>405 (method not allowed)</code></p>\n\n<p>The two routes are configured in the RouteConfig.cs:</p>\n\n<pre><code>routes.MapHttpRoute(\n    name: \"app-events\",\n    routeTemplate: \"events\",\n    defaults: new { controller = \"Events\" },\n    handler: new GZipToJsonHandler(GlobalConfiguration.Configuration),\n    constraints: null\n);\n\nroutes.MapHttpRoute(\n    name: \"DefaultApi\",\n    routeTemplate: \"api/{controller}/{id}\",\n    defaults: new { id = RouteParameter.Optional }\n);\n</code></pre>\n\n<p>The Controller method is essentially this...</p>\n\n<pre><code>public class EventsController : ApiController\n{\n    public EventsController()\n    {\n        _sender = new EventHubSender();\n    }\n\n    public async Task&lt;HttpResponseMessage&gt; Post(HttpRequestMessage requestMessage)\n    {\n        // doing fun stuff here\u2026\n\n       return new HttpResponseMessage(HttpStatusCode.OK);\n    }\n}\n</code></pre>\n\n<p>If I only configure the first route and post a request to <em><code>http://devbox/events</code></em> I will get a 405. However, if I add the second, default, route, and post to <em><code>http://devbox/api/events</code></em> I get back my expected <code>201</code>.</p>\n\n<p>With both routes configured at the same time, the same pattern, the route explicitly bound to the Controller receives a post request and fails with a 405, but the other URL will work.</p>\n\n<p>I've spent a long time looking around before conceding to ask the question. Most things I read have a lot to do with Webdav and I think I've followed every one of them to fix the issue. I am not very experienced with this stack, so nothing is very obvious to me.</p>\n"}, {"tags": ["c#", "unity3d", "game-engine"], "comments": [{"owner": {"reputation": 1721, "user_id": 7866667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1aef319171c09316b0cc570c8e1c4302?s=128&d=identicon&r=PG", "display_name": "j4nw", "link": "https://stackoverflow.com/users/7866667/j4nw"}, "edited": false, "score": 0, "creation_date": 1521058837, "post_id": 49286887, "comment_id": 85576995, "body": "Did you try to debug the code at all, e.g. by printing the actual values with <code>Debug.Log</code> or showing them on screen, and try to understand the issue based on that? The code you provided is malformed, by the way."}, {"owner": {"reputation": 950, "user_id": 977046, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8oeOa.jpg?s=128&g=1", "display_name": "Rick Riensche", "link": "https://stackoverflow.com/users/977046/rick-riensche"}, "edited": false, "score": 0, "creation_date": 1521058994, "post_id": 49286887, "comment_id": 85577084, "body": "It looks an awful lot like there are some typos in your sample code (gravityTime.deltaTime? velocityTime.deltaTime?).  Beyond that, I would recommend looking at the units you are using.. Is moveSpeed  &quot;world units per second if the user fully presses this input axis?&quot; (judging by your code, it should be)."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 1, "creation_date": 1521061301, "post_id": 49286887, "comment_id": 85578099, "body": "If <code>velocityTime.deltaTime</code> is supposed to be <code>velocity * Time.deltaTime</code>, then why are you multiplying <code>velocty.x</code> by <code>detaTime</code> twice? Plus, your <code>input.y</code> is not used at all."}], "answers": [{"tags": [], "owner": {"reputation": 302, "user_id": 6811345, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7ef9738cfd6cd4f5be04fa7e00b4885?s=128&d=identicon&r=PG&f=1", "display_name": "Tanner H.", "link": "https://stackoverflow.com/users/6811345/tanner-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1521090915, "creation_date": 1521090915, "answer_id": 49292049, "question_id": 49286887, "link": "https://stackoverflow.com/questions/49286887/time-deltatime-and-axis-input/49292049#49292049", "title": "Time.deltaTime and Axis Input", "body": "<p>You can achieve movement with simpler (but a larger quantity of) code.</p>\n\n<pre><code>if (Input.GetKey(KeyCode.W))\n{\n        gameObject.transform.Translate(Vector3.forward * moveSpeed * Time.deltaTime);\n}\n</code></pre>\n\n<p>Simply repeat this for each direction and it will work.</p>\n"}], "owner": {"reputation": 21, "user_id": 9493816, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MVg1T.jpg?s=128&g=1", "display_name": "ubernoober", "link": "https://stackoverflow.com/users/9493816/ubernoober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521090915, "creation_date": 1521058417, "last_edit_date": 1521058678, "question_id": 49286887, "link": "https://stackoverflow.com/questions/49286887/time-deltatime-and-axis-input", "title": "Time.deltaTime and Axis Input", "body": "<p>I have a simple question. Say I want to move my character by translating it with a Vector2 velocity varibale which is going to get it's values from Input.GetAxis. When I write code as this:</p>\n\n<pre><code>Vector2 input=new Vector2(Input.GexAxis(\"Horizontal\"), Input.GetAxis(\"Vertical\")); \n\nvelocity.x=input.x* Time.deltaTime * moveSpeed; \nvelocity.y+=gravityTime.deltaTime; \ntransform.Translate(velocityTime.deltaTime);\n</code></pre>\n\n<p>I get a weird error in which my character barely moves at all (it moves but very slowly and it stutters a lot). However, upon removing Time.deltaTime from velocity.x I get it to work normally. I know what Time.deltaTime is and what it is used for however I am not sure why I cannot use it with input.x but can use it with gravity?</p>\n\n<p>btw moveSpeed and gravity are just float variables with publicly assigned values.</p>\n"}, {"tags": ["c#", "asp.net", "sql-server", "webforms"], "comments": [{"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1521058578, "post_id": 49286841, "comment_id": 85576864, "body": "It is the ViewState that keeps the items in the DDL, not the adapter. I&#39;m not sure what you mean by &quot;since deleted&quot;. But after you delete somehting you have to rebind the new data to the DDL."}, {"owner": {"reputation": 25, "user_id": 9420741, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4d3520743e51ca62ebdb68304eb5563c?s=128&d=identicon&r=PG&f=1", "display_name": "Markk", "link": "https://stackoverflow.com/users/9420741/markk"}, "reply_to_user": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1521058786, "post_id": 49286841, "comment_id": 85576963, "body": "By &#39;since been deleted&#39; I mean the admin has deleted the data on the admin side of the application manually and its no longer present in the database. Edited above also"}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1521058844, "post_id": 49286841, "comment_id": 85576999, "body": "Then make sure that after the code that deletes something that <code>BindDropDownList</code> is also executed."}, {"owner": {"reputation": 25, "user_id": 9420741, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4d3520743e51ca62ebdb68304eb5563c?s=128&d=identicon&r=PG&f=1", "display_name": "Markk", "link": "https://stackoverflow.com/users/9420741/markk"}, "reply_to_user": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1521061951, "post_id": 49286841, "comment_id": 85578415, "body": "Found the issue, I (stupidly) had old values in the second table which were once a foreign key to the records that the admin deleted and so were populating the first dropdown. Thanks for the help @VDWWD"}], "owner": {"reputation": 25, "user_id": 9420741, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/4d3520743e51ca62ebdb68304eb5563c?s=128&d=identicon&r=PG&f=1", "display_name": "Markk", "link": "https://stackoverflow.com/users/9420741/markk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521059815, "creation_date": 1521058212, "last_edit_date": 1521059815, "question_id": 49286841, "link": "https://stackoverflow.com/questions/49286841/clearing-data-in-sqldataadapter", "title": "Clearing data in SqlDataAdapter", "body": "<p>I'm using SQLDataAdapter to populate data from my SQL server database in 2 DropDownLists. Depending on what is selected in the first dropdown, the corresponding data is populated in the second. It works fine but data that has since been deleted by the admin on their side of the application and is no longer in the database is still showing up in the dropdowns. </p>\n\n<p>Is there a way in which I can reset or clear what is already in the DataAdapter, refresh it and then show only the current data?</p>\n\n<p>If it helps here is how I have the data binding to the dropdowns. Firstly a  general method which is called on page load to populate the first dropdown, and again in the _SelectedIndexChanged of the first dropdown to bind the relevant data to the second. </p>\n\n<pre class=\"lang-html prettyprint-override\"><code> if (!IsPostBack)\n        {\n            DataBind();\n            string query = \"select Distinct ClubID, ClubName from Pitch\";\n            BindDropDownList(DDLClub, query, \"ClubName\", \"ClubID\", \"Select Club\");\n            DDLPitches.Enabled = false;\n            DDLPitches.Items.Insert(0, new ListItem(\"Select Pitch\", \"0\"));\n        }\n</code></pre>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code> private void BindDropDownList(DropDownList DDL, string query, string text, string value, string defaultText)\n    {\n        string ConnString = ConfigurationManager.ConnectionStrings[\"ConnString\"].ConnectionString;\n        SqlCommand cmd = new SqlCommand(query);\n        using (SqlConnection con = new SqlConnection(ConnString))\n        {\n            using (SqlDataAdapter sda = new SqlDataAdapter())\n            {\n                cmd.Connection = con;\n                con.Open();\n                DDL.DataSource = cmd.ExecuteReader();\n                DDL.DataTextField = text;\n                DDL.DataValueField = value;\n                DDL.DataBind();\n                sda.Dispose();\n                con.Close();\n            }\n        }\n        DDL.Items.Insert(0, new ListItem(defaultText, \"0\"));\n    }\n</code></pre>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code> protected void DDLClub_SelectedIndexChanged(object sender, EventArgs e)\n    {\n        DDLPitches.Enabled = false;\n        DDLPitches.Items.Clear();\n        DDLPitches.Items.Insert(0, new ListItem(\"Select Pitch\", \"0\"));\n        int ClubID = int.Parse(DDLClub.SelectedItem.Value);\n        if (ClubID &gt; 0)\n        {\n            string query = string.Format(\"select PitchID, ClubID, ClubName, PitchName from Pitch where ClubID = {0}\", ClubID);\n            BindDropDownList(DDLPitches, query, \"PitchName\", \"PitchID\", \"Select Pitch\");\n            DDLPitches.Enabled = true;\n        }\n    }\n</code></pre>\n\n\n"}, {"tags": ["c#", "wpf", "xaml", "webbrowser-control"], "comments": [{"owner": {"reputation": 792, "user_id": 4783560, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7AGPX.jpg?s=128&g=1", "display_name": "DogeAmazed", "link": "https://stackoverflow.com/users/4783560/dogeamazed"}, "edited": false, "score": 0, "creation_date": 1521059023, "post_id": 49286809, "comment_id": 85577105, "body": "That looks like two problems. If you hover over the red underlined line you see the other problems."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9482015, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Damian", "link": "https://stackoverflow.com/users/9482015/damian"}, "edited": false, "score": 0, "creation_date": 1521058774, "post_id": 49286921, "comment_id": 85576953, "body": "I&#39;m blind... Thank you so much. You are Star! I will accept the answer in 3 min as I&#39;m not allowed yet."}], "tags": [], "owner": {"reputation": 8411, "user_id": 359157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gQiBp.png?s=128&g=1", "display_name": "TyCobb", "link": "https://stackoverflow.com/users/359157/tycobb"}, "is_accepted": true, "score": 2, "last_activity_date": 1521058555, "creation_date": 1521058555, "answer_id": 49286921, "question_id": 49286809, "link": "https://stackoverflow.com/questions/49286809/wpf-webbrowser-no-overload-matches-delegate/49286921#49286921", "title": "WPF / WebBrowser - No overload matches delegate", "body": "<p>Your event handler is defined wrong.</p>\n\n<p>Looking at <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.navigation.loadcompletedeventhandler(v=vs.110).aspx\" rel=\"nofollow noreferrer\">MSDN LoadCompletedEventHandler</a> which is what the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.loadcompleted(v=vs.110).aspx\" rel=\"nofollow noreferrer\">WebBrowser Control's LoadCompleted</a> event uses, you need to use <code>NavigationEventArgs</code>.</p>\n\n<pre><code>public void Browser_LoadCompleted(object sender, NavigationEventArgs e)\n{\n    ...\n}\n</code></pre>\n\n<p>Regarding your redline about <code>StringBuilder</code>, I implore you to actually look at the error, look at the <a href=\"https://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx\" rel=\"nofollow noreferrer\">constructor options</a>, and verify what you are passing in.</p>\n"}], "owner": {"reputation": 155, "user_id": 9482015, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Damian", "link": "https://stackoverflow.com/users/9482015/damian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 49286921, "answer_count": 1, "score": 1, "last_activity_date": 1521058555, "creation_date": 1521058101, "question_id": 49286809, "link": "https://stackoverflow.com/questions/49286809/wpf-webbrowser-no-overload-matches-delegate", "title": "WPF / WebBrowser - No overload matches delegate", "body": "<p>I'm trying to highlight some text in webbrowser (WPF). Unfortunately I can't get rid of the following error :</p>\n\n<p><strong>No overload for 'Browser_LoadCompleted' matches delegate 'LoadCompletedEventHandler'</strong></p>\n\n<p>This line is red underlined -> <strong>StringBuilder html = new StringBuilder(doc2.body.outerHTML);</strong></p>\n\n<p>I appreciate any help. Thank you.</p>\n\n<pre><code>using mshtml;\nusing System;\nusing System.Text;\nusing System.Windows.Controls;\nusing System.Windows.Navigation;\n\nnamespace LSS_doc.Views\n{\n    /// &lt;summary&gt;\n    /// Interaction logic for ViewTabView.xaml\n    /// &lt;/summary&gt;\n    public partial class ViewTabView : UserControl\n    {\n\n        public ViewTabView()\n        {\n            InitializeComponent();\n            WebBrowser browser = new WebBrowser();\n            browser.LoadCompleted += Browser_LoadCompleted;\n        }\n\n\n        public void Browser_LoadCompleted(object sender, LoadCompletedEventHandler e)\n        {\n            IHTMLDocument2 doc2 = browser.Document as IHTMLDocument2;\n            StringBuilder html = new StringBuilder(doc2.body.outerHTML);\n\n            var words = new[] { \"word\", \"word2\" };\n            foreach (String key in words)\n            {\n                String substitution = \"&lt;span style='background-color: rgb(255, 255, 0);'&gt;\" + key + \"&lt;/span&gt;\";\n                html.Replace(key, substitution);\n            }\n\n            doc2.body.innerHTML = html.ToString();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "entity-framework", "ef-code-first", "dbcontext"], "comments": [{"owner": {"reputation": 2619, "user_id": 8330148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeOB2.jpg?s=128&g=1", "display_name": "ChW", "link": "https://stackoverflow.com/users/8330148/chw"}, "edited": false, "score": 0, "creation_date": 1521123207, "post_id": 49286729, "comment_id": 85605240, "body": "Why is it necessary to use the context from a property? Just instantiate it in constructor or my favorite approach, inject it into the constructor with DI and configure the needed life time previously. For me your class seems to be more complex than needed."}, {"owner": {"reputation": 1, "user_id": 3320812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b8de73458f10bcfc59fa310049f4dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3320812", "link": "https://stackoverflow.com/users/3320812/user3320812"}, "reply_to_user": {"reputation": 2619, "user_id": 8330148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EeOB2.jpg?s=128&g=1", "display_name": "ChW", "link": "https://stackoverflow.com/users/8330148/chw"}, "edited": false, "score": 0, "creation_date": 1521126568, "post_id": 49286729, "comment_id": 85607851, "body": "It is not necessary to instantiate the context in the property. But that is how it was done and it was cause of occasional errors.  We have added the constructor, instantiated the context in the constructor and all the errors are gone.  Need to understand as to why instantiating in the constructor works better."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1521129020, "post_id": 49286729, "comment_id": 85609726, "body": "All these exceptions are a tell-tale of multi-threading issues. I bet that multiple threads have access to one <code>MyContext</code> instance."}, {"owner": {"reputation": 1, "user_id": 3320812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b8de73458f10bcfc59fa310049f4dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3320812", "link": "https://stackoverflow.com/users/3320812/user3320812"}, "edited": false, "score": 0, "creation_date": 1521130101, "post_id": 49286729, "comment_id": 85610483, "body": "That is right, we understand that.  But what I am trying to understand is how is that adding the same block of code to the constructor solved the issue with the context getting shared."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1521146994, "post_id": 49286729, "comment_id": 85620053, "body": "Impossible to tell, not seeing how <code>MyContext</code> is used. Probably the timing of the (EF) context creation is subtly different. But the real issue here is multi-thread access to a (by definition) not thread-safe EF context. You <i>have</i> to fix that."}], "owner": {"reputation": 1, "user_id": 3320812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b8de73458f10bcfc59fa310049f4dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3320812", "link": "https://stackoverflow.com/users/3320812/user3320812"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521124329, "creation_date": 1521057711, "last_edit_date": 1521124329, "question_id": 49286729, "link": "https://stackoverflow.com/questions/49286729/entity-framework-code-first-context-errors-when-not-using-a-constructor", "title": "Entity Framework. Code First. context errors when not using a constructor", "body": "<p>I am new to Entity Framework. \nWorking on an existing application that uses the <em>repository pattern</em>.\nWhen the context was created in the get property (no constructor) we got sporadic errors relating to the <code>DbContext</code> in production and in load test \nwhile it worked fine in local.\nThe issues got resolved when we added a constructor to the context class and initialized the context in the constructor. \nIt does the same thing as the getter. \nUnsure has to how that solved the problem.\nAnyone has an idea as to what is the difference between creating the context in the constructor vs getter that solved these issues.\nI have searched the web high and low.</p>\n\n<p>Below are the errors we encountered:</p>\n\n<ol>\n<li>The connection was not closed. The connection's current state is connecting.</li>\n<li>Not allowed to change the <code>ConnectionString</code> property. The connection's current state is closed.</li>\n<li><code>System.NullReferenceException: Object reference not set to an instance of an object.</code> (the object here is the context).</li>\n<li>further exception: <code>The context cannot be created while the model is being created. This exception may be thrown if the context is used inside the OnModelCreating method or if the same context instance is accessed by multiple threads concurrently. Note that instance members of Dbcontext and related classes are not guaranteed to be thread safe.</code></li>\n</ol>\n\n<p>Below is the code:</p>\n\n<p><strong>EF DbContext</strong></p>\n\n<pre><code>public partial class EFContext : DbContext, IContext\n{\n    public EFContext(): base(\"ConnectionStringName\")\n    {\n    }\n\n    public IDbSet&lt;TEntity&gt; entityname { get; set; }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        base.OnModelCreating(modelBuilder);\n\n        //entity classes configuration\n        ConfigureEntity(modelBuilder);\n    }\n}\n</code></pre>\n\n<p><strong>MyContext</strong></p>\n\n<pre><code>public partial class MyContext :  IContext, IDisposable\n{\n    #region Private Members\n\n    private bool _disposed;\n    private EFContext efContext = null;\n\n\n    public MyContext () //Constructor\n    {\n        if (HttpContext.Current != null)\n        {\n            string entityKey = \"_\" + HttpContext.Current.GetHashCode().ToString(\"x\");\n\n            if (!HttpContext.Current.Items.Contains(entityKey))\n            {\n                efContext = new EFContext();\n                HttpContext.Current.Items.Add(entityKey, efContext);\n            }\n        }\n        else\n        {\n            efContext = new EFContext();\n        }\n    }\n\n    private EFContext Entities\n    {\n        get\n        {\n            if (HttpContext.Current != null)\n            {\n                string entityKey = \"_\" + HttpContext.Current.GetHashCode().ToString(\"x\");\n\n                if (!HttpContext.Current.Items.Contains(entityKey))\n                {\n                    efContext = new EFContext();\n                    HttpContext.Current.Items.Add(entityKey, efContext);\n                }\n                return (EFContext)HttpContext.Current.Items[entityKey];\n            }\n            else\n            {\n                efContext = new EFContext();\n                return efContext;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c#", ".net", "unity3d", "mono"], "comments": [{"owner": {"reputation": 302, "user_id": 6811345, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7ef9738cfd6cd4f5be04fa7e00b4885?s=128&d=identicon&r=PG&f=1", "display_name": "Tanner H.", "link": "https://stackoverflow.com/users/6811345/tanner-h"}, "edited": false, "score": 0, "creation_date": 1521091037, "post_id": 49286665, "comment_id": 85586671, "body": "With a question like this you kind of need to show the source code and where it is throwing the error. With that being said, error 1 is telling you that the folder /Shaders/Water doesn&#39;t exist in the current context. Is that folder in the right place?"}, {"owner": {"reputation": 1074, "user_id": 9258246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EaISP.png?s=128&g=1", "display_name": "TJ Wolschon", "link": "https://stackoverflow.com/users/9258246/tj-wolschon"}, "reply_to_user": {"reputation": 302, "user_id": 6811345, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7ef9738cfd6cd4f5be04fa7e00b4885?s=128&d=identicon&r=PG&f=1", "display_name": "Tanner H.", "link": "https://stackoverflow.com/users/6811345/tanner-h"}, "edited": false, "score": 0, "creation_date": 1521124914, "post_id": 49286665, "comment_id": 85606530, "body": "@TannerH agreed, we don&#39;t have nearly enough information to help with this one."}, {"owner": {"reputation": 3, "user_id": 9493341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c030c9fdf0f4bfa82073448b831aec1?s=128&d=identicon&r=PG&f=1", "display_name": "HawkSP", "link": "https://stackoverflow.com/users/9493341/hawksp"}, "edited": false, "score": 0, "creation_date": 1521143655, "post_id": 49286665, "comment_id": 85618318, "body": "I think I fixed it by deleting the assets: UBER and Ultimate Water System."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8730201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99112f520ffc5625cf1900f218ab5706?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8730201/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1567050920, "last_edit_date": 1567050920, "creation_date": 1567046150, "answer_id": 57702241, "question_id": 49286665, "link": "https://stackoverflow.com/questions/49286665/unity-building-failed-unityengine-guiutilityprocesseventint32-intptr/57702241#57702241", "title": "Unity Building &quot;failed&quot;: UnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)", "body": "<p>Changing the Build System from Gradle to Internal fixed the problem for me. See the snapshot below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9Yneb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Yneb.png\" alt=\"snapshot of the Build Setting\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13084163, "user_type": "registered", "profile_image": "https://graph.facebook.com/2632026270248397/picture?type=large", "display_name": "Viktor Surzhko", "link": "https://stackoverflow.com/users/13084163/viktor-surzhko"}, "is_accepted": false, "score": 0, "last_activity_date": 1584556775, "creation_date": 1584556775, "answer_id": 60745639, "question_id": 49286665, "link": "https://stackoverflow.com/questions/49286665/unity-building-failed-unityengine-guiutilityprocesseventint32-intptr/60745639#60745639", "title": "Unity Building &quot;failed&quot;: UnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)", "body": "<p>In my case, there was a problem with the Unity Monetization plugin, I reinstalled it and now everything works</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14915194, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-y4S-Zp2DBlw/AAAAAAAAAAI/AAAAAAAAAF4/AMZuuck4S_jMgruMlwDLiAyIWtIj5cIycA/s96-c/photo.jpg?sz=128", "display_name": "\u0130lker G&#252;len", "link": "https://stackoverflow.com/users/14915194/%c4%b0lker-g%c3%bclen"}, "is_accepted": false, "score": 0, "last_activity_date": 1609355709, "creation_date": 1609355709, "answer_id": 65512398, "question_id": 49286665, "link": "https://stackoverflow.com/questions/49286665/unity-building-failed-unityengine-guiutilityprocesseventint32-intptr/65512398#65512398", "title": "Unity Building &quot;failed&quot;: UnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)", "body": "<p>finally i find it solition just follow steps.</p>\n<ol>\n<li>open unity hub</li>\n<li>go to installs</li>\n<li>find your on work unity version</li>\n<li>click add modules</li>\n<li>end add Windows Build Support (IL2CCP)</li>\n<li>end build again</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 9493341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c030c9fdf0f4bfa82073448b831aec1?s=128&d=identicon&r=PG&f=1", "display_name": "HawkSP", "link": "https://stackoverflow.com/users/9493341/hawksp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 14958, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1612069250, "creation_date": 1521057502, "last_edit_date": 1521059598, "question_id": 49286665, "link": "https://stackoverflow.com/questions/49286665/unity-building-failed-unityengine-guiutilityprocesseventint32-intptr", "title": "Unity Building &quot;failed&quot;: UnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)", "body": "<p>Basically I am building my project in random locations and the project folder and nothing is working so I was wondering if it was something else. I am getting these errors: </p>\n\n<pre><code>Error 1: Error building Player: DirectoryNotFoundException: Directory '/Shaders/Water' not found.\n\nError 2: Build completed with a result of 'Failed'\nUnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)\n\nError 3: UnityEditor.BuildPlayerWindow+BuildMethodException: 2 errors\n  at UnityEditor.BuildPlayerWindow+DefaultBuildMethods.BuildPlayer (BuildPlayerOptions options) [0x0020e] in C:\\buildslave\\unity\\build\\Editor\\Mono\\BuildPlayerWindowBuildMethods.cs:181 \n  at UnityEditor.BuildPlayerWindow.CallBuildMethods (Boolean askForBuildLocation, BuildOptions defaultBuildOptions) [0x00065] in C:\\buildslave\\unity\\build\\Editor\\Mono\\BuildPlayerWindowBuildMethods.cs:88 \nUnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)\n\nError 4: DirectoryNotFoundException: Directory '/Shaders/Water' not found.\nSystem.IO.Directory.GetFileSystemEntries (System.String path, System.String searchPattern, FileAttributes mask, FileAttributes attrs) (at /Users/builduser/buildslave/mono/build/mcs/class/corlib/System.IO/Directory.cs:514)\nSystem.IO.Directory.GetFiles (System.String path, System.String searchPattern) (at /Users/builduser/buildslave/mono/build/mcs/class/corlib/System.IO/Directory.cs:308)\nSystem.IO.Directory.GetFiles (System.String path) (at /Users/builduser/buildslave/mono/build/mcs/class/corlib/System.IO/Directory.cs:303)\nUltimateWater.Editors.EditorShaderCollectionBuilder.CleanUpUnusedShaders () (at Assets/Ultimate Water System v1.0.0/Scripts/Editor/EditorShaderCollectionBuilder.cs:54)\nUltimateWater.Editors.WaterShadersCleanupTask.OnWillSaveAssets (System.String[] paths) (at Assets/Ultimate Water System v1.0.0/Scripts/Editor/EditorShaderCollectionBuilder.cs:140)\nSystem.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) (at /Users/builduser/buildslave/mono/build/mcs/class/corlib/System.Reflection/MonoMethod.cs:222)\nRethrow as TargetInvocationException: Exception has been thrown by the target of an invocation.\nSystem.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) (at /Users/builduser/buildslave/mono/build/mcs/class/corlib/System.Reflection/MonoMethod.cs:232)\nSystem.Reflection.MethodBase.Invoke (System.Object obj, System.Object[] parameters) (at /Users/builduser/buildslave/mono/build/mcs/class/corlib/System.Reflection/MethodBase.cs:115)\nUnityEditor.AssetModificationProcessorInternal.OnWillSaveAssets (System.String[] assets, System.String[]&amp; assetsThatShouldBeSaved, System.String[]&amp; assetsThatShouldBeReverted, Int32 explicitlySaveAsset) (at C:/buildslave/unity/build/Editor/Mono/AssetModificationProcessor.cs:147)\nUnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)\n</code></pre>\n\n<p>Can anyone make any sense of what needs to be done thanks.</p>\n\n<p>The project inst building</p>\n"}, {"tags": ["c#", "asp.net-web-api2", "inversion-of-control", "ninject", "log4net"], "comments": [{"owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 1, "creation_date": 1521058484, "post_id": 49286628, "comment_id": 85576822, "body": "See <a href=\"https://stackoverflow.com/a/28365933\">Constructor Dependency Injection WebApi Attributes</a>."}, {"owner": {"reputation": 13929, "user_id": 1236044, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/I4JH8.jpg?s=128&g=1", "display_name": "jbl", "link": "https://stackoverflow.com/users/1236044/jbl"}, "edited": false, "score": 0, "creation_date": 1521109840, "post_id": 49286628, "comment_id": 85595939, "body": "This should help as to how to setup a filterprovider for ninject linked to an attribute put on an action <a href=\"https://stackoverflow.com/a/48647030/1236044\">stackoverflow.com/a/48647030/1236044</a>"}], "owner": {"reputation": 129, "user_id": 1387579, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c05dbb06021e75ff7bde40df8da87fc3?s=128&d=identicon&r=PG", "display_name": "Subrato M", "link": "https://stackoverflow.com/users/1387579/subrato-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521057325, "creation_date": 1521057325, "question_id": 49286628, "link": "https://stackoverflow.com/questions/49286628/how-do-i-setup-ninject-to-work-with-log4net", "title": "How do I setup Ninject to work with log4net?", "body": "<p>I have some basic Web API code that uses Ninject. Till now I wasn't really logging anything but just sending BadRequest object in case something is wrong. With that code working fine, I want to add some logging (could be just info, errors or debug if need be) and I was using this article as my guideline. <a href=\"http://devthings.com.ua/logging-in-asp-net-web-api-using-log4net-and-elasticsearch/\" rel=\"nofollow noreferrer\">http://devthings.com.ua/logging-in-asp-net-web-api-using-log4net-and-elasticsearch/</a> This article uses Unity framework and uses MVC rather than API code so I am unable to translate that code into Ninject properly. I don't understand step # 4 where he is setting up UnityFilterProvider, what exactly does Unity do here? Whats the equivalent in Ninject?</p>\n"}, {"tags": ["c#", "asp.net", ".net", "excel", "asp.net-web-api"], "comments": [{"owner": {"reputation": 1484, "user_id": 1626767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/P5KrX.jpg?s=128&g=1", "display_name": "OpMt", "link": "https://stackoverflow.com/users/1626767/opmt"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521061317, "post_id": 49286623, "comment_id": 85578110, "body": "It just stores Constants for others to use. I have also defined generic functions in another library but have not used or added the reference to it yet as I want to get this basic version working with just constants."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521061347, "post_id": 49286623, "comment_id": 85578124, "body": "If you remove the reference / project does it start working again?"}, {"owner": {"reputation": 1484, "user_id": 1626767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/P5KrX.jpg?s=128&g=1", "display_name": "OpMt", "link": "https://stackoverflow.com/users/1626767/opmt"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521061439, "post_id": 49286623, "comment_id": 85578167, "body": "Yup it works fine and returns the excel file for me to open on the browser. It&#39;s very strange, if I re-add the reference it returns me that JSON above."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521061577, "post_id": 49286623, "comment_id": 85578234, "body": "Can you please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>? It seems very likely to me that your new project is doing something to alter the nature of your payloads."}, {"owner": {"reputation": 1484, "user_id": 1626767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/P5KrX.jpg?s=128&g=1", "display_name": "OpMt", "link": "https://stackoverflow.com/users/1626767/opmt"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521061879, "post_id": 49286623, "comment_id": 85578387, "body": "Sure working on it now will link it once done."}, {"owner": {"reputation": 1484, "user_id": 1626767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/P5KrX.jpg?s=128&g=1", "display_name": "OpMt", "link": "https://stackoverflow.com/users/1626767/opmt"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1521079919, "post_id": 49286623, "comment_id": 85584010, "body": "@mjwills figured out how to resolve this issue. Posted answer below. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1484, "user_id": 1626767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/P5KrX.jpg?s=128&g=1", "display_name": "OpMt", "link": "https://stackoverflow.com/users/1626767/opmt"}, "is_accepted": true, "score": 2, "last_activity_date": 1521079882, "creation_date": 1521079882, "answer_id": 49290484, "question_id": 49286623, "link": "https://stackoverflow.com/questions/49286623/excel-file-stops-returning-correctly-from-httpresponsemessage-after-adding-custo/49290484#49290484", "title": "Excel File stops returning correctly from HttpResponseMessage after adding custom library reference", "body": "<p>Found out what was causing the issue. Very subtle to catch.</p>\n\n<p><strong>TLDR:</strong> Re-create your class libraries to be of type \"Class Library (<strong>.NET Framework</strong>)\"</p>\n\n<p>The custom common libraries that were created were of type \"Class Library (<strong>.NET Standard</strong>)\". For some reason creating a class library in this format then adding it as a reference causes the HTTP response to come back in a bad state.</p>\n\n<p>I re-created the class libraries to be of type \"Class Library (<strong>.NET Framework</strong>)\" and it worked correctly and the response returned the excel file I created.</p>\n"}], "owner": {"reputation": 1484, "user_id": 1626767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/P5KrX.jpg?s=128&g=1", "display_name": "OpMt", "link": "https://stackoverflow.com/users/1626767/opmt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 49290484, "answer_count": 1, "score": 1, "last_activity_date": 1521079882, "creation_date": 1521057313, "last_edit_date": 1521057729, "question_id": 49286623, "link": "https://stackoverflow.com/questions/49286623/excel-file-stops-returning-correctly-from-httpresponsemessage-after-adding-custo", "title": "Excel File stops returning correctly from HttpResponseMessage after adding custom library reference", "body": "<p>I am working on an ASP.NET Web Application(.NET Framework). I wrote the program below to return an excel file as the response which works.</p>\n\n<p>I have also defined a custom common class library(for me and others to use) that can be added as a reference to this project in the same solution. However as soon as I add it as a reference to the project, when I call my http endpoint inside my controller, it stops returning the excel file and instead returns this JSON in the browser:</p>\n\n<pre><code>{  \n\u00a0\u00a0\u00a0\"Version\":{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Major\":1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Minor\":1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Build\":-1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Revision\":-1\n\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\"Content\":{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Headers\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"Content-Disposition\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"attachment;\u00a0filename=ExcelFileName.xlsx\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"Content-Type\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"application/xlsx\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\"StatusCode\":200,\n\u00a0\u00a0\u00a0\"ReasonPhrase\":\"OK\",\n\u00a0\u00a0\u00a0\"Headers\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"Pragma\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"no-cache\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"Cache-Control\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"no-cache\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"Date\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Wed,\u00a014\u00a0Mar\u00a02018\u00a018:20:52\u00a0GMT\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"Set-Cookie\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ARRAffinity=123456;Path=/;HttpOnly;Domain=helperapp.azurewebsites.net\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"Server\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ServerName/1.0\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"X-AspNet-Version\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"4.0.30319\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Key\":\"X-Powered-By\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Value\":[  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"ASP.NET\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0],\n\u00a0\u00a0\u00a0\"RequestMessage\":{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Version\":{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Major\":1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Minor\":1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Build\":-1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"_Revision\":-1\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Content\":null,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Method\":{  \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Method\":\"GET\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"RequestUri\":\"https://helperapp.azurewebsites.net/hlper/Get?id=123\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Headers\":[  \n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0],\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"Properties\":{  \n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\"IsSuccessStatusCode\":true\n}\n</code></pre>\n\n<p>My code is setup like below which returns the excel file fine, but not when I add the custom reference to the project:</p>\n\n<pre><code>[System.Web.Http.HttpGet, Route(\"api/ReturnExcelFile\")]\npublic async Task&lt;HttpResponseMessage&gt; ReturnExcelFile(Guid id)\n{        \n    HttpClient client = new HttpClient();\n    HttpResponseMessage response = await client.GetAsync(request_uri);\n\n    byte[] fileBytes = File.ReadAllBytes(excel_file_path);\n    MemoryStream fileStream = new MemoryStream(fileBytes);\n    response.Content = new StreamContent(fileStream);\n\n    var responseHeader = response.Content.Headers;\n    responseHeader.ContentDisposition = new System.Net.Http.Headers.ContentDispositionHeaderValue(\"attachment\");\n    responseHeader.ContentDisposition.FileName = ExcelFileName.xlsx;\n    responseHeader.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(\"application/xlsx\");\n\n    return response;\n}\n</code></pre>\n\n<p>I have seen many posts <a href=\"https://stackoverflow.com/questions/45062814/get-excel-file-from-httpresponsemessage\">like this</a> and <a href=\"https://stackoverflow.com/questions/34853072/how-to-return-file-from-asp-net-5-web-api\">this</a> but their solutions do not work.</p>\n\n<p>What is causing this and how can I resolve this issue?</p>\n"}, {"tags": ["c#", "import", "octopus-deploy"], "comments": [{"owner": {"reputation": 34841, "user_id": 4490, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c1321ea45da2cdf116e0f0f048e2ad62?s=128&d=identicon&r=PG", "display_name": "benPearce", "link": "https://stackoverflow.com/users/4490/benpearce"}, "edited": false, "score": 0, "creation_date": 1521177400, "post_id": 49286481, "comment_id": 85628757, "body": "Are you able to show the contents of the method <code>generateVariableResource</code>"}, {"owner": {"reputation": 1617, "user_id": 1069456, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b0bdc006e2e28c793003695047bed872?s=128&d=identicon&r=PG", "display_name": "Chaka", "link": "https://stackoverflow.com/users/1069456/chaka"}, "reply_to_user": {"reputation": 34841, "user_id": 4490, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c1321ea45da2cdf116e0f0f048e2ad62?s=128&d=identicon&r=PG", "display_name": "benPearce", "link": "https://stackoverflow.com/users/4490/benpearce"}, "edited": false, "score": 0, "creation_date": 1521723807, "post_id": 49286481, "comment_id": 85860085, "body": "Apologies added the code"}, {"owner": {"reputation": 1617, "user_id": 1069456, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b0bdc006e2e28c793003695047bed872?s=128&d=identicon&r=PG", "display_name": "Chaka", "link": "https://stackoverflow.com/users/1069456/chaka"}, "reply_to_user": {"reputation": 34841, "user_id": 4490, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c1321ea45da2cdf116e0f0f048e2ad62?s=128&d=identicon&r=PG", "display_name": "benPearce", "link": "https://stackoverflow.com/users/4490/benpearce"}, "edited": false, "score": 0, "creation_date": 1521723861, "post_id": 49286481, "comment_id": 85860115, "body": "My issue is when I try to add variables and if mandatory values are not included it will error out. No way to track down what is mandatory?"}], "owner": {"reputation": 1617, "user_id": 1069456, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b0bdc006e2e28c793003695047bed872?s=128&d=identicon&r=PG", "display_name": "Chaka", "link": "https://stackoverflow.com/users/1069456/chaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521723795, "creation_date": 1521056661, "last_edit_date": 1521723795, "question_id": 49286481, "link": "https://stackoverflow.com/questions/49286481/importing-variables-into-octopus-deploy-from-excel-output", "title": "Importing variables into Octopus Deploy from excel output", "body": "<p>I am trying to import project values from an excel file into Octopus Deploy using C#.\nHere's the format: </p>\n\n<p><strong>Project Name | Server | Variable (Name) | Variable (Value)</strong></p>\n\n<pre><code>APP1,WEB-SBX-WWW3,Configuration Data,vNext\\DeployConfiguration.ps1\nAPP1,WEB-SBX-WWW3,Configuration Document,vNext\\Deploy.ps1\nAPP1,WEB-SBX-WWW3,OutPut,DSC_OutPut\nAPP1,WEB-SBX-WWW3,INSTALLIIS,Present\n</code></pre>\n\n<p>Code for reading excel:</p>\n\n<pre><code>using(FileStream fs = File.OpenRead(CSVLocation)) {\n  using(StreamReader reader = new StreamReader(fs)) {\n   while (!reader.EndOfStream) {\n    string line = reader.ReadLine();\n    string[] values = line.Split(new char[] {\n     ','\n    });\n    if (!appList.ContainsKey(values[0])) {\n     appList.Add(values[0], values[0]);\n    }\n    list.Add(new Tuple &lt; string, VariableResource &gt; (values[0], Program.generateVariableResource(values[2], values[3], values[1])));\n   }\n  }\n}\n</code></pre>\n\n<p>Code for creating the variable list to add:</p>\n\n<pre><code>foreach(KeyValuePair &lt; string, string &gt; str in appList) {\n Program.project = Program._repository.Projects.FindOne((ProjectResource p) =&gt; p.Name == str.Key, null, null);\n Program.projectSets = Program._repository.VariableSets.Get(Program.project.VariableSetId);\n List &lt; VariableResource &gt; variableResourceList = new List &lt; VariableResource &gt; ();\n foreach(Tuple &lt; string, VariableResource &gt; item in list) {\n  if (item.Item1 == str.Key) {\n   variableResourceList.Add(item.Item2);\n  }\n }\n\n Program.addVariablesToOctopus(variableResourceList);\n Console.WriteLine(string.Format(\"Added variables to Octopus for:{0}\", str.Key));\n}\n</code></pre>\n\n<p>Code to add list to Octopus -- I keep getting null error, <strong>I can't figure out what is being sent (or not being sent) that cause the error?</strong>:</p>\n\n<pre><code>public static void addVariablesToOctopus(List &lt; VariableResource &gt; variableResourceList) {\n Program.projectSets.Variables = (IList &lt; VariableResource &gt; ) variableResourceList;\n Program._repository.VariableSets.Modify(Program.projectSets);\n}\n</code></pre>\n\n<p><strong>Errors out here:</strong> Program._repository.VariableSets.Modify(Program.projectSets)</p>\n\n<pre><code>public static VariableResource generateVariableResource(string name, string value, string machineName)\n        {\n            VariableResource variableResource = new VariableResource();\n            variableResource.Name = name;\n            variableResource.Value = value;\n            ScopeSpecification scopeSpecification1 = new ScopeSpecification();\n            scopeSpecification1.Add(ScopeField.Machine, new ScopeValue(Program.GetMachineId(machineName)));\n            ScopeSpecification scopeSpecification2 = scopeSpecification1;\n            variableResource.Scope = scopeSpecification2;\n            return variableResource;\n        }\n</code></pre>\n"}, {"tags": ["c#", "xamarin.forms", "async-await"], "comments": [{"owner": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521060736, "post_id": 49286406, "comment_id": 85577852, "body": "So accepted answer from duplicate question doesn&#39;t work?"}, {"owner": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 0, "creation_date": 1521060809, "post_id": 49286406, "comment_id": 85577879, "body": "No, it did not work in my case as I need to return the result of the dialog"}], "answers": [{"comments": [{"owner": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 0, "creation_date": 1521059522, "post_id": 49286995, "comment_id": 85577327, "body": "Thank you for your answer but it did not work. The execution continues and the method returns &quot;true&quot; before the alert dialog is shown. What is needed here await execution logic until there is a response from the dialog"}, {"owner": {"reputation": 4560, "user_id": 8093394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-rAl_keJkKAM/AAAAAAAAAAI/AAAAAAAAl0o/Y2pvHWTFzBM/photo.jpg?sz=128", "display_name": "Diego Rafael Souza", "link": "https://stackoverflow.com/users/8093394/diego-rafael-souza"}, "reply_to_user": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 0, "creation_date": 1521060186, "post_id": 49286995, "comment_id": 85577626, "body": "I&#39;m sorry, I couldn&#39;t understand you. That was the goal of this code: to ignore the &#39;BackButtonPressed&#39; event and wait for user confirmation. The method override would indeed end its execution. Where is in your code the &#39;logic&#39; that must be executed?"}, {"owner": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 0, "creation_date": 1521060484, "post_id": 49286995, "comment_id": 85577736, "body": "That is quite alright. I probably did not explain it very well. Anyway, that &quot;logic&quot; is not implemented in this test project but eventually will check if the user has made any changes to the data displayed on the screen. If true the dialog must be shown OnBackButtonPressed :)"}, {"owner": {"reputation": 4560, "user_id": 8093394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-rAl_keJkKAM/AAAAAAAAAAI/AAAAAAAAl0o/Y2pvHWTFzBM/photo.jpg?sz=128", "display_name": "Diego Rafael Souza", "link": "https://stackoverflow.com/users/8093394/diego-rafael-souza"}, "reply_to_user": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 1, "creation_date": 1521060648, "post_id": 49286995, "comment_id": 85577819, "body": "So the <code>Condition</code> in your code is not supposed to be a property, but a method with that logic, is it right?"}, {"owner": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 0, "creation_date": 1521060727, "post_id": 49286995, "comment_id": 85577847, "body": "Yes, that would be right."}, {"owner": {"reputation": 4560, "user_id": 8093394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-rAl_keJkKAM/AAAAAAAAAAI/AAAAAAAAl0o/Y2pvHWTFzBM/photo.jpg?sz=128", "display_name": "Diego Rafael Souza", "link": "https://stackoverflow.com/users/8093394/diego-rafael-souza"}, "reply_to_user": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 0, "creation_date": 1521061168, "post_id": 49286995, "comment_id": 85578036, "body": "I&#39;m unable to realize what&#39;s the matter of the issue. I&#39;ll wait for an edition on your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and then I&#39;ll check again if I can help =). Good luck."}, {"owner": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "edited": false, "score": 1, "creation_date": 1521065240, "post_id": 49286995, "comment_id": 85579892, "body": "I changed the question&#39;s content. Hopefully now it makes more sense :)"}], "tags": [], "owner": {"reputation": 4560, "user_id": 8093394, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-rAl_keJkKAM/AAAAAAAAAAI/AAAAAAAAl0o/Y2pvHWTFzBM/photo.jpg?sz=128", "display_name": "Diego Rafael Souza", "link": "https://stackoverflow.com/users/8093394/diego-rafael-souza"}, "is_accepted": false, "score": -1, "last_activity_date": 1521059254, "last_edit_date": 1521059254, "creation_date": 1521058859, "answer_id": 49286995, "question_id": 49286406, "link": "https://stackoverflow.com/questions/49286406/await-a-task-in-onbackbuttonpressed-and-use-its-result-to-return-in-the-method/49286995#49286995", "title": "Await a task in OnBackButtonPressed and use its result to return in the method?", "body": "<p>Try this:</p>\n\n<ol>\n<li>On your override, return <code>true</code> always;</li>\n<li>Call the <code>base.OnBackButtonPressed</code> after a positive answer.</li>\n</ol>\n\n<p>This way:</p>\n\n<pre><code>protected override bool OnBackButtonPressed()\n{\n    if (_vm.Condition) return base.OnBackButtonPressed();\n\n    DisplayAlert(\"Title\", \"Are you sure you want to leave the screen?\", \"Yes\", \"No\")\n        .ContinueWith(answer =&gt; \n        {\n            if(answer.Result)\n                base.OnBackButtonPressed(); // I'm not sure, but maybe you should wrap it on a 'BeginInvokeOnMainThread'\n        });\n\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 9802, "user_id": 3398554, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/lp5n3.png?s=128&g=1", "display_name": "Georgi Koemdzhiev", "link": "https://stackoverflow.com/users/3398554/georgi-koemdzhiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1461, "favorite_count": 0, "closed_date": 1521061408, "answer_count": 1, "score": 0, "last_activity_date": 1521065149, "creation_date": 1521056375, "last_edit_date": 1521065149, "question_id": 49286406, "link": "https://stackoverflow.com/questions/49286406/await-a-task-in-onbackbuttonpressed-and-use-its-result-to-return-in-the-method", "closed_reason": "Duplicate", "title": "Await a task in OnBackButtonPressed and use its result to return in the method?", "body": "<p>I am trying to show a dialog to the user when leaving a screen if there any any changes made in the screen (for example Settings screen). However. the DisplayAlert method requires awaiting in order to get the result which I need to use as a return value in the OnBackButtonPressed. I need to await the result of the dialog and then execute the rest of the OnBackButtonPressed method.</p>\n\n<p>The code that I am trying to eventually execute should be similar to the code below:</p>\n\n<pre><code>public partial class MainPage : ContentPage\n{\n    private TestViewModel _vm;\n\n    public MainPage()\n    {\n        InitializeComponent();\n        _vm = new TestViewModel();\n        BindingContext = _vm;\n    }\n\n    protected override bool OnBackButtonPressed()\n    {\n        if (_vm.IsUnchanged) return base.OnBackButtonPressed();\n\n        var result = await DisplayAlert(\"Title\", \"Are you sure you want to leave the screen with unsave changes?\", \"Yes\", \"No\");\n\n        // returning false will exit the screen\n        return !result;\n    }\n}\n\npublic class TestViewModel\n{\n    // this condition logic will evaluate if the user has made any changes to this screen and not saved them by pressing a \"Save\" button\n\n    public bool IsUnchanged{ get; set; }\n\n    public TestViewModel()\n    {\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "character-encoding", "asp.net-web-api2", "odata"], "comments": [{"owner": {"reputation": 34594, "user_id": 446279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37a20faec161bcc7485b3c292a2f931e?s=128&d=identicon&r=PG", "display_name": "vc 74", "link": "https://stackoverflow.com/users/446279/vc-74"}, "edited": false, "score": 1, "creation_date": 1521056403, "post_id": 49286372, "comment_id": 85575621, "body": "Try  <code>eq &quot;test&#39;&#39;20001&quot;</code>"}, {"owner": {"reputation": 1301, "user_id": 5796045, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6bbd7afe477d7e17ada9cd6f36e1f150?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaDeveloper", "link": "https://stackoverflow.com/users/5796045/ninjadeveloper"}, "reply_to_user": {"reputation": 34594, "user_id": 446279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37a20faec161bcc7485b3c292a2f931e?s=128&d=identicon&r=PG", "display_name": "vc 74", "link": "https://stackoverflow.com/users/446279/vc-74"}, "edited": false, "score": 0, "creation_date": 1521056500, "post_id": 49286372, "comment_id": 85575671, "body": "that can fix it but how I sanitize the &#39; to &#39;&#39; in code using javascript"}, {"owner": {"reputation": 34594, "user_id": 446279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37a20faec161bcc7485b3c292a2f931e?s=128&d=identicon&r=PG", "display_name": "vc 74", "link": "https://stackoverflow.com/users/446279/vc-74"}, "edited": false, "score": 1, "creation_date": 1521057200, "post_id": 49286372, "comment_id": 85576069, "body": "like this <code>var Url = &quot;http:&#47;&#47;localhost.com&#47;Clients?$filter=FirstName eq \\&quot;test\\&#39;20001\\&quot; and LastName eq \\&#39;test20001\\&#39;&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1301, "user_id": 5796045, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6bbd7afe477d7e17ada9cd6f36e1f150?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaDeveloper", "link": "https://stackoverflow.com/users/5796045/ninjadeveloper"}, "is_accepted": true, "score": 1, "last_activity_date": 1521486557, "creation_date": 1521486557, "answer_id": 49370629, "question_id": 49286372, "link": "https://stackoverflow.com/questions/49286372/how-to-allow-character-in-odata-endpoint-url/49370629#49370629", "title": "how to allow &#39; character in OData endpoint URL", "body": "<p>this how I fix it </p>\n\n<pre><code>var filter = '$filter=FirstName eq \\'' + escapeString(self.selectedClient().FirstName())\n                function escapeString(string) {\n                    string = string.replace(/'/g, '\\'\\'');\n                    string = string.replace(/&amp;/g, '%26');\n                    return string;\n                }\n</code></pre>\n"}], "owner": {"reputation": 1301, "user_id": 5796045, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6bbd7afe477d7e17ada9cd6f36e1f150?s=128&d=identicon&r=PG&f=1", "display_name": "NinjaDeveloper", "link": "https://stackoverflow.com/users/5796045/ninjadeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 49370629, "answer_count": 1, "score": 0, "last_activity_date": 1521486557, "creation_date": 1521056238, "question_id": 49286372, "link": "https://stackoverflow.com/questions/49286372/how-to-allow-character-in-odata-endpoint-url", "title": "how to allow &#39; character in OData endpoint URL", "body": "<p>I have OData endpoint to do filter for the client first and last name if the entity exists. the problem happens when the user use ' character inside the name string and that will break OData URI parser \nmy test string will be </p>\n\n<blockquote>\n  <p><a href=\"http://localhost.com/Clients\" rel=\"nofollow noreferrer\">http://localhost.com/Clients</a>?$filter=FirstName eq 'test'20001' and\n  LastName eq 'test20001'</p>\n</blockquote>\n\n<p>my stack trace  </p>\n\n<pre><code>{\n    \"error\": {\n        \"code\": \"\",\n        \"message\": \"The query specified in the URI is not valid. There is an unterminated string literal at position 23 in 'FirstName eq 'test20001'.\",\n        \"innererror\": {\n            \"message\": \"There is an unterminated string literal at position 23 in 'FirstName eq 'test20001'.\",\n            \"type\": \"Microsoft.OData.ODataException\",\n            \"stacktrace\": \"   at Microsoft.OData.UriParser.ExpressionLexer.NextToken()\\r\\n   at Microsoft.OData.UriParser.UriQueryExpressionParser.ParseComparison()\\r\\n   at Microsoft.OData.UriParser.UriQueryExpressionParser.ParseLogicalAnd()\\r\\n   at Microsoft.OData.UriParser.UriQueryExpressionParser.ParseLogicalOr()\\r\\n   at Microsoft.OData.UriParser.UriQueryExpressionParser.ParseExpression()\\r\\n   at Microsoft.OData.UriParser.UriQueryExpressionParser.ParseExpressionText(String expressionText)\\r\\n   at Microsoft.OData.UriParser.ODataQueryOptionParser.ParseFilterImplementation(String filter, ODataUriParserConfiguration configuration, ODataPathInfo odataPathInfo)\\r\\n   at Microsoft.OData.UriParser.ODataQueryOptionParser.ParseFilter()\\r\\n   at System.Web.OData.Query.FilterQueryOption.get_FilterClause()\\r\\n   at System.Web.OData.Query.Validators.FilterQueryValidator.Validate(FilterQueryOption filterQueryOption, ODataValidationSettings settings)\\r\\n   at System.Web.OData.Query.FilterQueryOption.Validate(ODataValidationSettings validationSettings)\\r\\n   at System.Web.OData.Query.Validators.ODataQueryValidator.Validate(ODataQueryOptions options, ODataValidationSettings validationSettings)\\r\\n   at System.Web.OData.Query.ODataQueryOptions.Validate(ODataValidationSettings validationSettings)\\r\\n   at System.Web.OData.EnableQueryAttribute.ValidateQuery(HttpRequestMessage request, ODataQueryOptions queryOptions)\\r\\n   at System.Web.OData.EnableQueryAttribute.ExecuteQuery(Object response, HttpRequestMessage request, HttpActionDescriptor actionDescriptor, ODataQueryContext queryContext)\\r\\n   at System.Web.OData.EnableQueryAttribute.OnActionExecuted(HttpActionExecutedContext actionExecutedContext)\"\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "storyboard", "code-behind"], "comments": [{"owner": {"reputation": 2124, "user_id": 988127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ccace48aadfe07afe2687c3c64e01b8?s=128&d=identicon&r=PG", "display_name": "Joel Bourbonnais", "link": "https://stackoverflow.com/users/988127/joel-bourbonnais"}, "edited": false, "score": 0, "creation_date": 1521056697, "post_id": 49286337, "comment_id": 85575770, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15900627/creating-storyboard-in-code-behind-in-wpf\">Creating Storyboard in code behind in WPF</a>"}, {"owner": {"reputation": 11, "user_id": 8417325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e752f4c0b786ea5dcbf398bde467926b?s=128&d=identicon&r=PG&f=1", "display_name": "frhiso", "link": "https://stackoverflow.com/users/8417325/frhiso"}, "reply_to_user": {"reputation": 2124, "user_id": 988127, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4ccace48aadfe07afe2687c3c64e01b8?s=128&d=identicon&r=PG", "display_name": "Joel Bourbonnais", "link": "https://stackoverflow.com/users/988127/joel-bourbonnais"}, "edited": false, "score": 0, "creation_date": 1521058577, "post_id": 49286337, "comment_id": 85576863, "body": "Hello KOTIX, thank you for your quick reaction. To my understanding the differentiator is the aspect of using a variable in the PropertyPath, which is what i am predominantly interested in. Implementing a storyboard based animation from code behind in general is not an issue for me, that is well discussed in other posts indeed. I just add this to make my emphasis on the variable aspect more clear."}, {"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1521059219, "post_id": 49286337, "comment_id": 85577192, "body": "The parentheses matter. It&#39;s all explained in <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/propertypath-xaml-syntax\" rel=\"nofollow noreferrer\">PropertyPath XAML Syntax</a>, section <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/propertypath-xaml-syntax#propertypath-for-animation-targets\" rel=\"nofollow noreferrer\">PropertyPath for Animation Targets</a>. The version without parentheses assumes that there is a Rectangle property holding an object with a Width property, which you don&#39;t have. You could simply write <code>new PropertyPath(&quot;Width&quot;)</code>"}, {"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1521059533, "post_id": 49286337, "comment_id": 85577332, "body": "Even simpler: <code>target.BeginAnimation(UIElement.WidthProperty, doubleAni)</code>. Note that you don&#39;t need a Storyboard at all."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8417325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e752f4c0b786ea5dcbf398bde467926b?s=128&d=identicon&r=PG&f=1", "display_name": "frhiso", "link": "https://stackoverflow.com/users/8417325/frhiso"}, "is_accepted": false, "score": 1, "last_activity_date": 1521134781, "creation_date": 1521134781, "answer_id": 49305691, "question_id": 49286337, "link": "https://stackoverflow.com/questions/49286337/set-storyboard-settargetproperty-in-code-behind/49305691#49305691", "title": "Set Storyboard.SetTargetProperty in code-behind", "body": "<p>@ Clemens: perfect, that solves my problem and is the answer from my perspective.</p>\n\n<p>I looked for options to mark a comment as answer, but obviously there is a reason (<a href=\"https://meta.stackexchange.com/questions/1555/mark-a-comment-as-answer-to-a-question\">Mark a comment as answer to a question</a>) not to have it.\nIf the moderator would have options to mark Clemens comment as answer and agrees, i'd feel this would be the right way to have it.</p>\n\n<p>For the time being a recapitulation of what i believe to have learned from Clemens' comment:</p>\n\n<p>Syntax that works:</p>\n\n<pre><code>myPropertyPath = new PropertyPath(\"(Rectangle.Width)\");\nstring _mypropertypathvariablestring = \"(Rectangle.Width)\"; \nstring _mypropertypathvariablestring = \"Width\";\n</code></pre>\n\n<p>Syntax that fails:</p>\n\n<pre><code>myPropertyPath = new PropertyPath(\"Rectangle.Width\");\nstring _mypropertypathvariablestring = \"Rectangle.Width\";\n</code></pre>\n\n<p>I.o.w.: whenever the type is to be specified in a PropertyPath, it demands to use parentheses in order to indicate a \"partial qualification\" and that type to be within the default XML namespace, as a shape like Rectangle does.\nIn all other cases just the property itself is sufficient.</p>\n\n<p>Since i attempt to implement a pure CodeBehind solution, i didn't consider \"<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/propertypath-xaml-syntax#propertypath-for-animation-targets\" rel=\"nofollow noreferrer\">PropertyPath XAML Syntax</a>\", and sticked with \"<a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.propertypath?view=netframework-4.7.1\" rel=\"nofollow noreferrer\">PropertyPath Class</a>\", which is more concise and does not involve the \"paranthesis\" syntax.</p>\n\n<p>But my initial fault was the misconception, that the PropertyPath would have to include the object the property(chain) gets attached to, fueled by the working syntax option</p>\n\n<pre><code>myPropertyPath = new PropertyPath(\"(Rectangle.Width)\");\n</code></pre>\n\n<p>which i found by trial and error, without the understanding of the meaning of parentheses.</p>\n\n<p>Thank you also for pointing out the option to implement the animation without using a storyboard and proposing the better implementation option via BeginAnimation.</p>\n\n<p>Thanks again!</p>\n"}], "owner": {"reputation": 11, "user_id": 8417325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e752f4c0b786ea5dcbf398bde467926b?s=128&d=identicon&r=PG&f=1", "display_name": "frhiso", "link": "https://stackoverflow.com/users/8417325/frhiso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521134781, "creation_date": 1521056076, "last_edit_date": 1521058173, "question_id": 49286337, "link": "https://stackoverflow.com/questions/49286337/set-storyboard-settargetproperty-in-code-behind", "title": "Set Storyboard.SetTargetProperty in code-behind", "body": "<p>I have a problem which is certainly very trivial, but i am a beginner in coding C# and i simply can't understand why the code fails.</p>\n\n<p>I want to animate shapes and have the option to pass in the property as a parameter.\nI.o.w.: i want to specify an animation property (path) using a variable.</p>\n\n<p>This leads me to try the following:</p>\n\n<pre><code>public static class HelperExtension\n{\n    public static void Animate(this UIElement target, string propertyToAnimate, double? from, double to, int duration = 3000, int startTime = 0)\n    {\n        var doubleAni = new DoubleAnimation\n        {\n            To = to,\n            From = from,\n            Duration = TimeSpan.FromMilliseconds(duration)\n        };\n\n        Storyboard.SetTarget(doubleAni, target);\n        PropertyPath myPropertyPath; \n\n        // option 1: fails:\n        string _mypropertypathvariablestring = \"Rectangle.Width\";\n        myPropertyPath = new PropertyPath(_mypropertypathvariablestring); \n\n        // option 2: succeeds:\n        myPropertyPath = new PropertyPath(\"(Rectangle.Width)\");         \n\n        Storyboard.SetTargetProperty(doubleAni, myPropertyPath);\n\n\n        var sb = new Storyboard\n        {\n            BeginTime = TimeSpan.FromMilliseconds(startTime)\n        };\n\n        sb.Children.Add(doubleAni);\n        sb.Begin();\n    }\n}\n</code></pre>\n\n<p>The compilation succeeds, but execution throws exception with the message:</p>\n\n<blockquote>\n  <p>System.InvalidOperationException: Cannot resolve all property\n  references in the property path '\"Rectangle.Width\"'</p>\n</blockquote>\n\n<p>at</p>\n\n<pre><code>sb.Begin();\n</code></pre>\n\n<p>I don't understand how option 1 and 2 differ (which are meant to be implemented not at the same time).</p>\n\n<p>Could someone help by telling me what i misunderstand? Most likely s.th. on the conceptual level</p>\n\n<p>And maybe providing a hint how to best use variables in <code>new PropertyPath()</code>?</p>\n"}, {"tags": ["c#", "excel", "automation", "vba"], "comments": [{"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521057393, "post_id": 49286336, "comment_id": 85576184, "body": "What is the value of test.VBE.CommandBars.FindControl(Id: 578) ?"}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521059017, "post_id": 49286336, "comment_id": 85577100, "body": "I changed the code a bit : the new problematic line <code>Microsoft.Office.Core.CommandBars listCommandBars = test.VBE.CommandBars;</code> already triggers the <code>{&quot;Error loading type library&#47;DLL. (Exception from HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY))&quot;}</code> exception."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521059661, "post_id": 49286336, "comment_id": 85577396, "body": "Whereas an <code>oXL.VBE.CommandBars.FindControl(MsoControlType.msoControlBut&zwnj;&#8203;ton, Id: 587).Execute();</code> triggers an <code>Exception thrown at 0x77E6ED6D (ntdll.dll) in XlamAutomation.exe: 0xC0000005: Access violation writing location 0x00000000.</code>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521060437, "post_id": 49286336, "comment_id": 85577718, "body": "What you are trying to do can generally only work from code that runs <i>inside</i> the Office app.  Like VBA does.  But not from an external C# program, the exception is trying to tell you that it does not know how the marshal the call from one process to another.  Something that is hard to do, it needs a type library to pull it off and there isn&#39;t one available.  You can write an Office add-in in C#, then it runs inside."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521061984, "post_id": 49286336, "comment_id": 85578430, "body": "@HansPassant Thank you. To be precise, I am generating an xlam file with c#, adding modules to it from .bas files in a folder, and after all of that, I simply want to compile the vba code and save it. I understand your point, but why I can I run macros in the xlam from the c# wherease I can&#39;t compile the code itself from the c# ? What is different between running macros from outside and compiling from outside ?"}, {"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1521067112, "post_id": 49286336, "comment_id": 85580629, "body": "Because when you run them from outside you are asking Excel to load and compile them on your behalf. You are trying to invert that process."}, {"owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "edited": false, "score": 0, "creation_date": 1521195181, "post_id": 49286336, "comment_id": 85637321, "body": "Ok, I am now executing the code from an excel addin, and the same code throws <code>{&quot;Error HRESULT E_FAIL has been returned from a call to a COM component.&quot;} commandbar find control</code> at me. Maybe I should somehow enable the command bar control before doing an execute, but how ?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1527096658, "post_id": 49286336, "comment_id": 88001343, "body": "I have never heard of compiling VBA code, but see the link below for an idea of how to run an Excel Macro from C#.  <a href=\"https://stackoverflow.com/questions/31200130/run-vba-macro-in-excel-sheet-using-external-c-sharp-console-application?rq=1\" title=\"run vba macro in excel sheet using external c sharp console application\">stackoverflow.com/questions/31200130/&hellip;</a>"}], "owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521059246, "creation_date": 1521056072, "last_edit_date": 1531164843, "question_id": 49286336, "link": "https://stackoverflow.com/questions/49286336/programatically-compiling-vba-modules-with-c", "title": "Programatically compiling VBA modules with c#", "body": "<p>I have the following code</p>\n\n<pre><code>Microsoft.Office.Interop.Excel.Application oXL = new Microsoft.Office.Interop.Excel.Application();\nWorkbook oWB = oXL.Workbooks.Open(solutionDirectory);\n</code></pre>\n\n<p>where <code>string solutionDirectory</code> contains the path to an Excel <strong>xlam</strong> file. It is and Excel Macro-Enabled Add-In file that is used to add new functions to Excel : if you open it with Excel, you won't have a spreadsheet, but only VBA code. When modified in VBA, this code can be compiled via VBA.</p>\n\n<p>I try to trigger programmatically this compilation with <code>c#</code> :</p>\n\n<pre><code>VBComponents = oWB.VBProject.VBComponents;\nforeach (var module in VBComponents)\n{\n    var test = module as VBComponent;\n    if (test.Type == vbext_ComponentType.vbext_ct_StdModule || test.Type == vbext_ComponentType.vbext_ct_ClassModule)\n    {\n        Microsoft.Office.Core.CommandBars listCommandBars = test.VBE.CommandBars; // first problematic line\n        listCommandBars.FindControl(Id: 578).Execute(); // problematic line\n    }\n}\n</code></pre>\n\n<p>I found inspiration for the \"problematic line\" here :</p>\n\n<p><a href=\"https://www.experts-exchange.com/questions/26424766/Programmatically-check-VBA-compiles-as-part-of-release-procedure.html\" rel=\"nofollow noreferrer\">https://www.experts-exchange.com/questions/26424766/Programmatically-check-VBA-compiles-as-part-of-release-procedure.html</a></p>\n\n<p>and tried to adapt, without success : the problematic line triggers a :</p>\n\n<pre><code>{\"Error loading type library/DLL. (Exception from HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY))\"}\n</code></pre>\n\n<p>I am wrong on the way to do the compilation, or is the problem of a different nature ? What's the way to achieve programatic compilation of VBA modules with <code>c#</code> ?</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-web-api"], "comments": [{"owner": {"reputation": 7052, "user_id": 2084315, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/650350a4564c8b0eaeddbe972a48f076?s=128&d=identicon&r=PG&f=1", "display_name": "ps2goat", "link": "https://stackoverflow.com/users/2084315/ps2goat"}, "edited": false, "score": 0, "creation_date": 1521056943, "post_id": 49286209, "comment_id": 85575916, "body": "WebForms binding is similar to MVC binding.  Have the parameter name match your data, e.g., call the dictionary <code>s</code> instead of <code>d</code>, because the binder matches on parameter/property name.  Arrays are the same: if you want a string array called &#39;myStrings&#39;, your parameter and querystring values should all be named the same. The binder will put those querystring values into the parameter."}, {"owner": {"reputation": 7052, "user_id": 2084315, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/650350a4564c8b0eaeddbe972a48f076?s=128&d=identicon&r=PG&f=1", "display_name": "ps2goat", "link": "https://stackoverflow.com/users/2084315/ps2goat"}, "edited": false, "score": 1, "creation_date": 1521057089, "post_id": 49286209, "comment_id": 85576002, "body": "Unless a valid, WebAPI-centric duplicate question is provided, this should be reopened. (I&#39;m sure there is one, but the current one does not seem valid.)"}], "owner": {"reputation": 458, "user_id": 3663288, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97fa500575a2304ed3adc898e208263e?s=128&d=identicon&r=PG", "display_name": "Pedro Henrique", "link": "https://stackoverflow.com/users/3663288/pedro-henrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1521129734, "creation_date": 1521055634, "last_edit_date": 1521056321, "question_id": 49286209, "link": "https://stackoverflow.com/questions/49286209/does-asp-net-have-a-dictionary-url-notation", "title": "Does ASP.NET have a dictionary URL notation?", "body": "<p>In an ASP.NET WebApi, you can do the following:</p>\n\n<pre><code>public class Something { \n    public int Foo;\n    public string Bar;\n}\n\npublic class SomethingController : ApiController {\n    public string Get(Something s) {\n        return \"whatever\";\n    }\n}\n</code></pre>\n\n<p>The URL to that will be:</p>\n\n<pre><code>\"http://myapi/Something?s.Foo=123&amp;s.Bar=abc\"\n</code></pre>\n\n<p>Note the: <strong>s.Foo=</strong> and <strong>s.Bar=</strong> notation.</p>\n\n<p>It is also possible to pass arrays in a URL like this:</p>\n\n<pre><code>\"http://...?array=1&amp;array=2&amp;array=3\"\n</code></pre>\n\n<p>Is there any notation for dictionaries? One like this for example:</p>\n\n<pre><code>public string Get(Dictionary&lt;string, string&gt; d)\n</code></pre>\n\n<p>Also, what are the other possibilities for data structures in an ASP.NET URL?</p>\n\n<p>I can't find any documentation to that.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The duplicate has nothing to do with what I asked.</p>\n"}, {"tags": ["c#", "reference", "nullable"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1521055379, "post_id": 49286089, "comment_id": 85575041, "body": "<code>null</code> nullable values are boxed to null references."}, {"owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1521055493, "post_id": 49286089, "comment_id": 85575107, "body": "Well hold on, if we&#39;re boxed to an <code>Object</code> then sure, I get how you can be a <code>null</code> reference but how on earth then can you <code>x.HasValue</code> on a <code>null</code>? Unless the compiler is doing some really crazy stuff with what it emits I don&#39;t get it. And if it does do crazy stuff, then what exactly does it do? Do we have an authoritative source on this?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 3, "creation_date": 1521055577, "post_id": 49286089, "comment_id": 85575148, "body": "<code>Nullable&lt;T&gt;</code> is a struct, and <code>x.HasValue</code> doesn&#39;t involve boxing and just accesses the <code>HasValue</code> field directly. When calling <code>object.ReferenceEquals</code>, <code>x</code> is boxed since both parameters are <code>object</code> which is a reference type."}, {"owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1521055774, "post_id": 49286089, "comment_id": 85575271, "body": "Interesting, so if I might restate what you are saying @Lee, is it that <code>bool?</code> doesn&#39;t actually inherit <code>Object</code> (in the same way that <code>bool</code> does not), so when you pass that into <code>ReferenceEquals</code> (which takes <code>object</code>) the compiler produces a boxed version with something like <code>(object)x</code>? And if that&#39;s the case, is there then an explicit conversion of booleans to objects that will produce <code>null</code>?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1521055960, "post_id": 49286089, "comment_id": 85575386, "body": "Both <code>bool</code> and <code>bool?</code> are structs but they do inherit from <code>object</code>. Assigning a struct to a variable of type <code>object</code> causes boxing - <code>bool</code> gets boxed to a non-null value containing the bool. <code>bool?</code> values get boxed to <code>null</code> if <code>HasValue</code> is false or a boxed <code>bool</code> if <code>HasValue</code> is <code>true</code>. See section 4.3.1 &#39;boxing conversions` of the specification for the details."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1521057838, "post_id": 49286089, "comment_id": 85576443, "body": "@GeorgeMauer: The source of your confusion is a lack of clarity on what &quot;inherits from&quot; means.  <b>Inherits from means that some members of the base type are also members of the derived type</b>.  That is <b>all</b> that it means.  <code>Object</code> has a method <code>ToString</code>.  It is an inheritable member. Therefore any type that inherits from <code>Object</code> also has a member <code>ToString</code>.  Inheritance also implies a convertibility relationship, but <b>that convertibility relationship need not be representation preserving</b>.  Indeed, any boxing conversion is not representation preserving."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1521057963, "post_id": 49286089, "comment_id": 85576519, "body": "So let&#39;s sum up.  We have a <code>struct Nullable&lt;T&gt; { T value; bool hasValue; }</code> and some public helper functions that I&#39;m sure you can see how they work. It&#39;s just a perfectly ordinary struct.  An <code>int?</code> is literally nothing more than either a pair of some integer and true, or zero and false.  The latter we call &quot;null&quot;."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1521058041, "post_id": 49286089, "comment_id": 85576569, "body": "@EricLippert Doesn&#39;t it mean that <i>all</i> of the members of the base type are members of the derived type, not (just) that some of the members of the base type are members of the derived type.  Are there any non-inheritable members in C#?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1521058058, "post_id": 49286089, "comment_id": 85576576, "body": "Then we have compiler magic.  <code>T?</code> is a synonym for <code>Nullable&lt;T&gt;</code>.  <code>x != null</code> is a synonym for <code>x.HasValue</code>.  <code>x + 1</code> is a synonym for <code>x.HasValue ? new Nullable&lt;int&gt;(x.Value + 1) : new Nullable&lt;int&gt;()</code>  And so on.  See my blog series on how nullable arithmetic is optimized if you want the details of that compiler magic."}, {"owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "edited": false, "score": 0, "creation_date": 1521058108, "post_id": 49286089, "comment_id": 85576599, "body": "Thanks Eric, authoritative as always. So can you confirm my understanding that what happens when you do <code>ReferenceEquals</code> is that the <code>Nullable&lt;T&gt;</code> is boxed to an <code>Object</code> which <i>can</i> be a null reference?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1521058148, "post_id": 49286089, "comment_id": 85576629, "body": "@Servy: constructors and destructors are members but are not heritable. <i>Private</i> members <i>are</i> heritable, which many people forget. The reason you (normally) can&#39;t call a private member from a derived class is because that private member is not <i>accessible</i> from the derived class, not because it was not inherited."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1521058196, "post_id": 49286089, "comment_id": 85576654, "body": "Finally we have runtime magic.  <code>Nullable&lt;T&gt;</code> is the only value type which (1) does not meet the <code>where T : struct</code> constraint on a generic, and (2) which is boxed to either a normal boxed <code>T</code>, or a null reference."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1521058320, "post_id": 49286089, "comment_id": 85576741, "body": "So yes, <code>ReferenceEquals()</code> takes two <code>object</code> arguments and therefore they are boxed.  Now, exercise: what happens when you call <code>x.ToString()</code> on an <code>int?</code> vs what happens when you call <code>x.GetType()</code>?  Can you predict the behaviour?  Can you explain the behaviour that you observe?"}, {"owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "edited": false, "score": 0, "creation_date": 1521058439, "post_id": 49286089, "comment_id": 85576798, "body": "Woah....<code>GetType</code> throws a NullRef but <code>ToString</code> works? We are getting wild here..."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1521058472, "post_id": 49286089, "comment_id": 85576815, "body": "Yep. Now figure out why."}, {"owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "edited": false, "score": 0, "creation_date": 1521058651, "post_id": 49286089, "comment_id": 85576897, "body": "(Creates another SO and @s Eric). No ok, I thing I see. <code>ToString</code> is implemented directly on <code>Nullable&lt;&gt;</code> which is not a null reference so yay, it works. But <code>GetType</code> is on <code>Object</code> so it gets boxed and you get <code>null</code> resulting in an exception"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 4, "creation_date": 1521058849, "post_id": 49286089, "comment_id": 85577000, "body": "Correct. More specifically: <code>ToString()</code> is a <i>virtual method on <code>object</code> which is overridden by <code>Nullable&lt;T&gt;</code></i>.  So when you call <code>x.ToString()</code> you can think about that as being actually realized as <code>Nullable&lt;int&gt;.ToString(ref x)</code>, where the parameter is the &quot;this&quot; that is given to <code>ToString</code>, and therefore the implementation of <code>ToString</code> operates on the <i>not boxed</i> value.  But <code>GetType</code> is <i>not virtual</i>, and therefore you can think of this as  <code>object.GetType((object)x)</code>, because again, we need a <code>this</code> that is <code>object</code>.  So there&#39;s boxing, and hey, it boxes to null!"}], "owner": {"reputation": 102855, "user_id": 5056, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/315b95cdcac83705c10ea14e239aeaf5?s=128&d=identicon&r=PG", "display_name": "George Mauer", "link": "https://stackoverflow.com/users/5056/george-mauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "closed_date": 1521055946, "answer_count": 0, "score": 2, "last_activity_date": 1521055954, "creation_date": 1521055176, "last_edit_date": 1521055538, "question_id": 49286089, "link": "https://stackoverflow.com/questions/49286089/why-is-object-referenceequalsnull-of-a-nullable-primitive-true", "closed_reason": "Duplicate", "title": "Why is Object.ReferenceEquals(null of a nullable primitive) true?", "body": "<p>So we can have nullable primitive types</p>\n\n<pre><code>bool? x = null;\n</code></pre>\n\n<p>Which is great. But my understanding has always been that it's not actually a <code>null</code> <em>reference</em> since</p>\n\n<pre><code>x.HasValue; //false\n</code></pre>\n\n<p>is possible.</p>\n\n<p>I had always assumed that nullables were classes or structures with operator and <code>Equals</code> overloading implemented but today I checked</p>\n\n<pre><code>Object.ReferenceEquals(null, x); //true\n</code></pre>\n\n<p>And I have no clue how <em>that</em> can be.</p>\n\n<p>How can it at the same time be a reference that points to <code>null</code> <em>and</em> have non-extension properties on it that are invokable?!</p>\n\n<p>If this is a compiler trick, does anyone know documentation on what exactly it does?</p>\n"}, {"tags": ["c#", "optimization", "datatable", "spreadsheetgear"], "comments": [{"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521055375, "post_id": 49286077, "comment_id": 85575040, "body": "It would be helpful still if you posted a section of the relevant code which you have identified as the portion which is slow. Also what is slow? The SpreadsheetGear conversion of the excel to datatable? or the Iterating of the datatable?"}, {"owner": {"reputation": 173, "user_id": 2573416, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/726578f24c78063724e61ad22e0d6730?s=128&d=identicon&r=PG", "display_name": "MJR", "link": "https://stackoverflow.com/users/2573416/mjr"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521055707, "post_id": 49286077, "comment_id": 85575224, "body": "The uploading and conversion are fine. It&#39;s the iterating of the datatable that&#39;s slow. I started processing a file about twenty minutes ago, and it&#39;s not finished yet. Granted, it&#39;s through Visual Studio, but still, that seems like a LONG time to process 11,500 rows in a DataTable."}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521055792, "post_id": 49286077, "comment_id": 85575285, "body": "what are you doing inside the iterations? It should take next to no time at all to just iterate the rows."}, {"owner": {"reputation": 173, "user_id": 2573416, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/726578f24c78063724e61ad22e0d6730?s=128&d=identicon&r=PG", "display_name": "MJR", "link": "https://stackoverflow.com/users/2573416/mjr"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521055991, "post_id": 49286077, "comment_id": 85575406, "body": "It&#39;s checking to see if certain cells are empty/null. It also gets current info from our DB, checks that object for null, does a DB update if not. It also checks for valid item numbers and valid items. If the product is valid, it checks a value and if true it does a little more processing with a nested loop, then looks up some stuff in the DB. Otherwise, it sets up a &quot;controller&quot;, and processes some stuff that way. Then it gets products, and checks against them. And does more processing. Still doesn&#39;t seem like it should do 37 per second. That still seems slow."}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521056232, "post_id": 49286077, "comment_id": 85575531, "body": "Sounds like you are hitting your DB quite a bit in your loop, couldn&#39;t you just do a SELECT of all relevant items in the other DB tables into new DataTable objects and use those for comparisons and such in your loop so you can reduce the load on the server? Also, have you stepped through one of these iterations and made note of which pieces of the code are taking a long time to execute?"}, {"owner": {"reputation": 173, "user_id": 2573416, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/726578f24c78063724e61ad22e0d6730?s=128&d=identicon&r=PG", "display_name": "MJR", "link": "https://stackoverflow.com/users/2573416/mjr"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521056415, "post_id": 49286077, "comment_id": 85575624, "body": "Stepping through it is my next step, but the last time I did, nothing really jumped out at me."}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521056538, "post_id": 49286077, "comment_id": 85575689, "body": "Also, do you have any of this wrapped in a try-catch? Any chance you are getting an exception in there?"}, {"owner": {"reputation": 173, "user_id": 2573416, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/726578f24c78063724e61ad22e0d6730?s=128&d=identicon&r=PG", "display_name": "MJR", "link": "https://stackoverflow.com/users/2573416/mjr"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521056721, "post_id": 49286077, "comment_id": 85575789, "body": "Yes, the calling method has a try/catch. The method that processes the file is within the try/catch, so it should catch any exceptions. I tried using the Parallel.For() iterator also, but that kept giving me a null reference error in one of my other methods."}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521056966, "post_id": 49286077, "comment_id": 85575928, "body": "Well, without any of your code to go on, that&#39;s the best I can offer. I&#39;d recommend seeing about doing one select for any table data you need and storing that in datatable obects so you don&#39;t have to continually query the DB, that could be part of the problem right there and also the step through should help uncover the long running pieces of the code."}, {"owner": {"reputation": 173, "user_id": 2573416, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/726578f24c78063724e61ad22e0d6730?s=128&d=identicon&r=PG", "display_name": "MJR", "link": "https://stackoverflow.com/users/2573416/mjr"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521057094, "post_id": 49286077, "comment_id": 85576004, "body": "Thanks, Ryan! I&#39;ll see what I can come up with."}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521057152, "post_id": 49286077, "comment_id": 85576040, "body": "cool. Let me know how it goes, if I can help in some way, I will."}, {"owner": {"reputation": 453, "user_id": 1858134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11db9fb87e310515dd6a3092effeb462?s=128&d=identicon&r=PG", "display_name": "Xcheque", "link": "https://stackoverflow.com/users/1858134/xcheque"}, "edited": false, "score": 0, "creation_date": 1521095532, "post_id": 49286077, "comment_id": 85588241, "body": "We have done a lot of work with big spreadsheets and spreadsheetgear. The rate limiting step has always been the load time. 1 - 2MB load reasonably efficiently and anything up to 5MB is manageable. After that the load time starts to get a too long."}, {"owner": {"reputation": 453, "user_id": 1858134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11db9fb87e310515dd6a3092effeb462?s=128&d=identicon&r=PG", "display_name": "Xcheque", "link": "https://stackoverflow.com/users/1858134/xcheque"}, "edited": false, "score": 0, "creation_date": 1521096205, "post_id": 49286077, "comment_id": 85588514, "body": "In memory the SSgear operations are very quick. Are you opening and closing the spreadsheet inside an iteration?  That might be because the interaction is via a subroutine where the spreadsheet is opened and then disposed before returning. The other comment I would make is that it is much faster to copy the data to a DataTable, work with that and then paste it back to the spreadsheet when done."}, {"owner": {"reputation": 173, "user_id": 2573416, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/726578f24c78063724e61ad22e0d6730?s=128&d=identicon&r=PG", "display_name": "MJR", "link": "https://stackoverflow.com/users/2573416/mjr"}, "edited": false, "score": 0, "creation_date": 1521118582, "post_id": 49286077, "comment_id": 85601740, "body": "It&#39;s not a matter of loading the data. That happens quickly even with the 4MB file. The problem is processing it and saving it to our DB. Iterating over the collection."}], "owner": {"reputation": 173, "user_id": 2573416, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/726578f24c78063724e61ad22e0d6730?s=128&d=identicon&r=PG", "display_name": "MJR", "link": "https://stackoverflow.com/users/2573416/mjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521055129, "creation_date": 1521055129, "question_id": 49286077, "link": "https://stackoverflow.com/questions/49286077/need-to-speed-up-processing-a-spreadsheetgear-iworksheet", "title": "Need to speed up processing a SpreadsheetGear IWorksheet", "body": "<p>Ok, I have a spreadsheet with 11,500 rows, and 12 columns. It uploads fine, but processing it takes forever. We're using SpreadsheetGear, and what I'm doing right now is putting the data into a DataTable, and iterating over it. With a 300 row file, it takes approximately 8 seconds. This is approximately 37.5 rows per second, which seems incredibly slow. I <em>think</em> the problem is the conditionals or newing up a few of the classes within the processing method, because I switched to a string array and didn't really notice a performance difference. It may also be the method calls within the method.</p>\n\n<p>I tried using Interop, and that didn't work. It was giving me an error that the Excel component of Interop wasn't registered on my machine. And since this will be on our web server, I don't want to add additional components to the server.</p>\n\n<p>Ideally, they'd like to be able to process a 4 MB file (the 11,500 rows is just under this) in under 30 seconds, so I'm wondering if there's a tool or NuGet package I could use to quickly process this file. We have a piece of software that times out after 30 seconds, so the end user is getting an error message.</p>\n\n<p>I haven't ruled out the conditionals being the problem, but I don't think that's really the issue. I'm just trying to figure out how to process this quickly.</p>\n\n<p>I would post the code, but it's a LOT of code to post, and I think it's proprietary, and I didn't write it, I'm just editing it.</p>\n"}, {"tags": ["c#", "sql", "sql-server", "linq", "select"], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1521055454, "creation_date": 1521055454, "answer_id": 49286155, "question_id": 49286064, "link": "https://stackoverflow.com/questions/49286064/linq-select-first-item-from-table-a-that-has-corresponding-id-in-linking-table/49286155#49286155", "title": "LINQ: Select First Item from Table A that has corresponding ID in linking table that connects to Table B", "body": "<p>You can do it like this:</p>\n\n<pre><code>var inspirationPhotos = db.Inspirations.Select(i =&gt; new {\n    Inspiration = i\n,   Photo = db.Photos.FirstOrDefault(p =&gt;\n        db.InspirationPhotos.Any(ip =&gt;\n            ip.PhotoId == p.Id &amp;&amp; ip.InspirationId == i.Id\n        )\n    )\n}).\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8807296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57dae34f585e038ff333ccc79e827b25?s=128&d=identicon&r=PG&f=1", "display_name": "Mary Frey", "link": "https://stackoverflow.com/users/8807296/mary-frey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524210130, "creation_date": 1521055092, "last_edit_date": 1521055122, "question_id": 49286064, "link": "https://stackoverflow.com/questions/49286064/linq-select-first-item-from-table-a-that-has-corresponding-id-in-linking-table", "title": "LINQ: Select First Item from Table A that has corresponding ID in linking table that connects to Table B", "body": "<p>I currently have an 'Inspirations' table with ID, Name, and Description, a 'Photos' table with ID, Name, and Description, and a linking table InspirationPhotos that just has the foreign keys of PhotoID and InspirationID. I want to select the first photo that is associated with each InspirationID. I know that I will likely need to loop through the Photos table and then select FirstOrDefault. </p>\n\n<p>I think I will need something like</p>\n\n<pre><code>foreach (var inspiration in Inspirations)\n{\n    inspiration.Photos.Where(x=&gt;x.PhotoId == ?)\n}\n</code></pre>\n\n<p>Maybe I should add a primary key to the linking table? \nThanks in advance</p>\n"}, {"tags": ["c#", "pdf", "ocr"], "answers": [{"tags": [], "owner": {"reputation": 2640, "user_id": 1625547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c0e98ce506b3bf3d9ef8caaa4f76716?s=128&d=identicon&r=PG", "display_name": "LEADTOOLS Support", "link": "https://stackoverflow.com/users/1625547/leadtools-support"}, "is_accepted": true, "score": 1, "last_activity_date": 1523070244, "creation_date": 1523070244, "answer_id": 49703428, "question_id": 49286029, "link": "https://stackoverflow.com/questions/49286029/issues-when-trying-to-ocr-pdfs-using-net-c/49703428#49703428", "title": "Issues when trying to OCR PDFs using .NET/C#", "body": "<ol>\n<li>If the PDF page contains an image without text, the only way to get text from it is to use OCR. Both Adobe Acrobat DC and some earlier versions of Acrobat have OCR features, but as far as I know, you can only OCR one or more pages, not a small selection.<br>\nThis means if you have an image and Acrobat allows you to select text off of it without explicitly running OCR, most probably the file already contains image-over-text or hidden text over the image. If the text is garbled when you copy and paste it, it's probably how it was stored when it was OCR'd and saved. This could have happened because the text quality was not good enough for OCR, or the software used to perform OCR was of low quality and got the characters incorrectly.</li>\n<li><p>If you try to OCR and get \"page contains renderable text\" error, this means the file already contains text. Again, the text could be hidden, but it's there. The following article explains more about this:<br>\n<a href=\"https://helpx.adobe.com/acrobat/kb/error-could-perform-recognition-acrobat.html\" rel=\"nofollow noreferrer\">https://helpx.adobe.com/acrobat/kb/error-could-perform-recognition-acrobat.html</a></p></li>\n<li><p>There are several SDKs that support opening and OCRing PDF files using C#. This area of StackOverflow is not the place to ask for recommendations. Please try <a href=\"https://softwarerecs.stackexchange.com/\">https://softwarerecs.stackexchange.com/</a> instead.</p></li>\n</ol>\n"}], "owner": {"reputation": 617, "user_id": 8440715, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68ec33e661160ab08a096777d1e8e5f8?s=128&d=identicon&r=PG&f=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/8440715/mikhail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 49703428, "answer_count": 1, "score": -2, "last_activity_date": 1523070244, "creation_date": 1521054977, "question_id": 49286029, "link": "https://stackoverflow.com/questions/49286029/issues-when-trying-to-ocr-pdfs-using-net-c", "title": "Issues when trying to OCR PDFs using .NET/C#", "body": "<ol>\n<li><p>Old versions of Adobe PDF used to distinguish Searchable PDF/Image PDF in one particular way.  In Searchable PDF, you can select the text and image only pdf when you try to select a gray text box will come (no text selected).  This was the thumb rule earlier.  But now with Adobe DC, this has changed.  Adobe DC, allows you to select the text even for image pdf/s (non-searchable pdf\u2019s).  But if you try to copy and paste, it does not paste what you copied, you get some special characters.  Any idea why Adobe DC does it?  What is the thumb rule now to find out what is searchable pdf and what is image pdf (non-ocr pdf)?</p></li>\n<li><p>Some of non-OCR pdf documents, when try to do OCR, are getting \u201crenderable text\u201d error and OCR is failed for those page.  What is the best way to eliminate this \u201cThis page contains renderable text\u201d error and what is the best way to OCR such pages.</p></li>\n<li><p>How to programmatically OCR pdf document in C#?  If this takes more time, what are the ways to handle session timeouts?  Anyway to do OCR in the back-ground and send to the user at the end (idea is to not holding the user in the front-end and still some way to deliver the created file to the submitter once the process is done).</p></li>\n</ol>\n"}, {"tags": ["c#", "azure", "azure-eventhub", "event-processor-host"], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 4689483, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/151bc535ca1581cb451eb4df1672b018?s=128&d=identicon&r=PG", "display_name": "JTaub", "link": "https://stackoverflow.com/users/4689483/jtaub"}, "is_accepted": true, "score": 3, "last_activity_date": 1521142294, "creation_date": 1521142294, "answer_id": 49307809, "question_id": 49285997, "link": "https://stackoverflow.com/questions/49285997/should-we-use-the-microsoft-azure-eventhubs-processor-library-with-net-framewor/49307809#49307809", "title": "Should we use the Microsoft.Azure.EventHubs.Processor library with .NET framework", "body": "<p>I may be partial in my answer, but I would prefer the newer <code>Microsoft.Azure.EventHubs</code> library. This is for the following reasons:</p>\n\n<ul>\n<li>It is open source. You can see the roadmap, current issues, file your own issues, and in case you need it, you have access to the code with an MIT license.</li>\n<li>It uses .NET Standard. In case your solution ever changes to .NET Core, or any of the other .NET runtimes, you can continue to use your Event Hubs code.</li>\n<li>This is the library that Microsoft will be emphasizing in the future. While that is my assumption, here's why I think that:\n\n<ul>\n<li>The docs.microsoft.com getting started examples use the new library. <a href=\"https://docs.microsoft.com/azure/event-hubs/event-hubs-dotnet-standard-getstarted-send\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/azure/event-hubs/event-hubs-dotnet-standard-getstarted-send</a></li>\n<li>Microsoft has seen the benefits of open source development, and nearly all of their Azure libraries are being open sourced. i.e. Service Fabric just went open source as well: <a href=\"https://blogs.msdn.microsoft.com/azureservicefabric/2018/03/14/service-fabric-is-going-open-source/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/azureservicefabric/2018/03/14/service-fabric-is-going-open-source/</a> </li>\n<li>The newer library was createdd with the intent to replace the older library. While Microsoft is very good at supporting old / legagcy libraries, the ultimate intent was to replace the older library. <a href=\"https://azure.microsoft.com/blog/event-hubs-dotnet-standard-client-reaches-ga/\" rel=\"nofollow noreferrer\">https://azure.microsoft.com/blog/event-hubs-dotnet-standard-client-reaches-ga/</a></li>\n</ul></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2173, "user_id": 159548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe5310c4d5a64a88aeeb83676b28a81?s=128&d=identicon&r=PG", "display_name": "Jesse Squire", "link": "https://stackoverflow.com/users/159548/jesse-squire"}, "is_accepted": false, "score": 0, "last_activity_date": 1608652673, "creation_date": 1608652673, "answer_id": 65411838, "question_id": 49285997, "link": "https://stackoverflow.com/questions/49285997/should-we-use-the-microsoft-azure-eventhubs-processor-library-with-net-framewor/65411838#65411838", "title": "Should we use the Microsoft.Azure.EventHubs.Processor library with .NET framework", "body": "<p>Adding a bit of context to modernize this guidance, since Microsoft has since launched a new initiative around the Azure SDKs, which includes a new Event Hubs client library.  For new development, we recommend using the <code>Azure.Messaging.EventHubs</code> family of packages and the <code>Azure.[[ AREA ]].[[ SERVICE ]]</code> packages for working with other Azure services.</p>\n<p><a href=\"https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/eventhub/Azure.Messaging.EventHubs/README.md\" rel=\"nofollow noreferrer\">Azure.Messaging.EventHubs</a> is the current generation Event Hubs client library and will be the focal point of development, with improvements and new features being released on a regular cadence.  It supports the <code>netstandard2.0</code> platform, allowing it to be used with a wide range of host environments which include .NET 5, .NET Core, and the full .NET Framework.  The library retains high-level feature parity with the previous generation, <code>Microsoft.Azure.EventHubs</code>, but with but with a more discrete client hierarchy and improved API.</p>\n<p>The <code>Azure.Messaging.EventHubs</code> library is part of the initiative to improve the development experience across Azure services.  To this end, it follows a set of uniform <a href=\"https://azure.github.io/azure-sdk/general_introduction.html\" rel=\"nofollow noreferrer\">design guidelines</a> intended to drive a consistent experience across development languages and employ established API patterns for all Azure services.  The library also follows a set of <a href=\"https://azure.github.io/azure-sdk/dotnet_introduction.html\" rel=\"nofollow noreferrer\">.NET-specific guidelines</a> to ensure that the .NET SDK has a natural and idiomatic feel that mirrors that of the .NET base class libraries.</p>\n<p>The <code>Azure.Messaging.EventHubs</code> library also provides the ability to share in some of the cross-service improvements made to the Azure development experience, such as a unified diagnostics pipeline offering a common view of the activities across each of the client libraries.  Another key improvement is a streamlined and simplified experience for authentication using the new <a href=\"https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/identity/Azure.Identity/README.md\" rel=\"nofollow noreferrer\">Azure.Identity</a> library to share credentials between the clients for different Azure services.</p>\n<p>While we believe that there is significant benefit to adopting the modern version of the Event Hubs client library, it is important to be aware that the legacy versions have not been officially deprecated. They will continue to be supported with security and bug fixes. However, new features are unlikely to be added and there is no guarantee of feature parity between the modern and legacy versions going forward.</p>\n<p>More information on the <code>Azure.Messaging.EventHubs</code> library is available in its <a href=\"https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/eventhub/Azure.Messaging.EventHubs/README.md\" rel=\"nofollow noreferrer\">README</a> and [Samples)[https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/eventhub/Azure.Messaging.EventHubs/samples).  There is also a <a href=\"https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/eventhub/Azure.Messaging.EventHubs/MigrationGuide.md\" rel=\"nofollow noreferrer\">Migration Guide</a> available to assist with upgrading from the legacy versions.</p>\n"}], "owner": {"reputation": 53, "user_id": 9493182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f0O89.png?s=128&g=1", "display_name": "Francis MC", "link": "https://stackoverflow.com/users/9493182/francis-mc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 49307809, "answer_count": 2, "score": 5, "last_activity_date": 1608652673, "creation_date": 1521054864, "question_id": 49285997, "link": "https://stackoverflow.com/questions/49285997/should-we-use-the-microsoft-azure-eventhubs-processor-library-with-net-framewor", "title": "Should we use the Microsoft.Azure.EventHubs.Processor library with .NET framework", "body": "<p><strong>Context</strong></p>\n\n<p>We're currently using <a href=\"https://www.nuget.org/packages/Microsoft.Azure.ServiceBus.EventProcessorHost/\" rel=\"noreferrer\">Microsoft.Azure.ServiceBus.EventProcessorHost</a> for data ingestion from an Azure Event-Hub.  We run on <strong>.NET framework</strong>, not <strong>.NET Core</strong>.</p>\n\n<p>This Microsoft <a href=\"https://azure.microsoft.com/en-us/blog/event-hubs-dotnet-standard-client-reaches-ga/\" rel=\"noreferrer\">announcement</a> (published Feb 2, 2017) suggests the newer <a href=\"https://www.nuget.org/packages/Microsoft.Azure.EventHubs.Processor\" rel=\"noreferrer\">Microsoft.Azure.EventHubs.Processor</a> is the way to go in the future, regardless of the .NET runtime you use, as they will maintain a single code base.</p>\n\n<p>Meanwhile, the official Microsoft <a href=\"https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-samples\" rel=\"noreferrer\">Event-Hub samples</a> updated recently still suggest the older library (Microsoft.Azure.ServiceBus.EventProcessorHost) for the .NET framework.</p>\n\n<p>Both libraries have been updated and evolved since the announcement.</p>\n\n<p><strong>Question</strong> </p>\n\n<p>Since we're on <strong>.NET framework</strong>, which library should we use going forward?  </p>\n\n<p>Should we migrate to the newer <strong>Microsoft.Azure.EventHubs.Processor</strong>, in order to benefit from the latest development, improvements and bug fixes?  Or is the old one kept up to speed?</p>\n\n<p>The question is relevant to newcomers as well, which library should they pick to get started with Azure Event-Hubs.</p>\n"}, {"tags": ["c#", "obfuscation", "confuserex"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 2, "creation_date": 1521054877, "post_id": 49285925, "comment_id": 85574786, "body": "Every single method remains unaltered?  Are they all public methods?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9493545"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1521057493, "post_id": 49285925, "comment_id": 85576252, "body": "@Plutonix yes, check my update for an example"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1521057604, "post_id": 49285925, "comment_id": 85576304, "body": "Think for a moment.  If <code>Example</code> got changed to <code>aai()</code> how well would it work with the app that calls it?  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">tour</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9493545"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1521057968, "post_id": 49285925, "comment_id": 85576523, "body": "@Plutonix okay, so you have implicited suggested to me to use the Packer? I used it in the past and performance of the app is slow when I start the application, that&#39;s why I want obfuscate the dll without include it in the exe"}], "owner": {"user_type": "does_not_exist", "display_name": "user9493545"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521057482, "creation_date": 1521054623, "last_edit_date": 1521057482, "question_id": 49285925, "link": "https://stackoverflow.com/questions/49285925/cannot-obfuscate-dll", "title": "Cannot obfuscate dll", "body": "<p>I'm using Confuserex for obfuscate a <code>dll</code>, I compiled it using visual studio, then I opened ConfuserEx GUI, dropped the <code>dll</code> on the project tab, and then in the settings tab I added a new rule with the maximum preset. </p>\n\n<p>After that, I click on \"Protect\" button available on the protect tab, and when I open the \"obfuscated\" <code>dll</code> with dotpeek a disassmbler software provided by intellij I can read all the method and class as the <code>dll</code> is never obfuscated.</p>\n\n<p>This does not happen with <code>.exe</code> only with <code>dll</code>, what I'm doing wrong?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>example structure:</p>\n\n<pre><code>namespace Test\n{\n    public class Foo&lt;T&gt; : ViewModel\n    {\n\n        public Example() { }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "servicestack", "servicestack-text"], "comments": [{"owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "edited": false, "score": 0, "creation_date": 1521056999, "post_id": 49285892, "comment_id": 85575950, "body": "Data Tables aren&#39;t supported in ServiceStack Serializers and <a href=\"https://stackoverflow.com/a/48880354/85785\">DTOs should also not have implementation logic</a>. I&#39;d recommend decoupling the impl from the DTO you&#39;re trying to serialize and update your answer with an dep and impl-free DTO (e.g. with no DatatTable class references) which doesn&#39;t serialize properly in ASP.NET Core DTO as it&#39;s impossible to reproduce without a stand-alone repro."}, {"owner": {"reputation": 47, "user_id": 2036970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvGjh.jpg?s=128&g=1", "display_name": "Suresh Balasubramanian", "link": "https://stackoverflow.com/users/2036970/suresh-balasubramanian"}, "reply_to_user": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "edited": false, "score": 0, "creation_date": 1521057675, "post_id": 49285892, "comment_id": 85576337, "body": "Thanks @mythz. I get your point. But these are not C# DataTables but custom ones,not derived/inherited. Design-wise it is similar to DataTable, but a lot lighter and simpler. And these were getting deserialized properly pre-.NET Core 2.0."}, {"owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "edited": false, "score": 0, "creation_date": 1521058178, "post_id": 49285892, "comment_id": 85576641, "body": "As per my previous comment + link, these aren&#39;t DTOs which should not contain any impl logic. My recommendation is to first decouple the DTO you&#39;re trying to serialize from the impl that&#39;s populating them. The update your question with an populated DTO which fails to serialize in a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> as no-one will be able to repro the issue using the partial dependency-encumbered example provided."}, {"owner": {"reputation": 47, "user_id": 2036970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvGjh.jpg?s=128&g=1", "display_name": "Suresh Balasubramanian", "link": "https://stackoverflow.com/users/2036970/suresh-balasubramanian"}, "reply_to_user": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "edited": false, "score": 0, "creation_date": 1521519543, "post_id": 49285892, "comment_id": 85753500, "body": "@mythz. This got resolved. It was a mistake from our side. We somehow missed noticing a non-public constructor. Thanks a lot!"}], "owner": {"reputation": 47, "user_id": 2036970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QvGjh.jpg?s=128&g=1", "display_name": "Suresh Balasubramanian", "link": "https://stackoverflow.com/users/2036970/suresh-balasubramanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521054467, "creation_date": 1521054467, "question_id": 49285892, "link": "https://stackoverflow.com/questions/49285892/servicestack-json-deserialization-complex-poco-returning-null-in-net-core-2", "title": "ServiceStack JSON deserialization - complex POCO - returning null in .NET Core 2.0", "body": "<p>We are using ServiceStack.NET as our web services layer. Earlier to .NET Core 2.0 version of ServiceStack (v5.0.2), the below complex POCO was being deserialized correctly by JsonServiceClient (from C# of course). Now we are getting null.</p>\n\n<p>From Browser/Ajax call, it is all working fine. Only the JsonServiceClient has the problem.</p>\n\n<p>We tried ProtobufServiceClient, we are getting </p>\n\n<blockquote>\n  <p>Nested or jagged lists and arrays are not supported</p>\n</blockquote>\n\n<p>We understand that we may have to hack the classes a bit to get it to work for protobuf, but json was working fine pre-.NET Core 2.0.</p>\n\n<p>Need help.</p>\n\n<pre><code>[ProtoBuf.ProtoContract]\npublic class EbDataRow : List&lt;object&gt;\n{\n    internal RowColletion Rows { get; set; }\n\n    internal EbDataRow() { }\n\n    internal EbDataRow(int size) : base(size)\n    {\n        for (int i = 0; i &lt; size; i++)\n            base.Add(null);\n    }\n\n    new public void Add(object o)\n    {\n        base.Add(o);\n    }\n\n    new public object this[int index]\n    {\n        get\n        {\n            if (index &gt; -1)\n            {\n                if (base[index] == DBNull.Value)\n                {\n                    if ((int)this.Rows.Table.Columns[index].Type == EbDbTypes.String)\n                        return string.Empty;\n                    else if ((int)this.Rows.Table.Columns[index].Type == EbDbTypes.Int32)\n                        return 0;\n                    else if ((int)this.Rows.Table.Columns[index].Type == EbDbTypes.Int64)\n                        return 0;\n                    else if ((int)this.Rows.Table.Columns[index].Type == EbDbTypes.Boolean)\n                        return false;\n                    else if ((int)this.Rows.Table.Columns[index].Type == EbDbTypes.Decimal)\n                        return 0;\n                    else if ((int)this.Rows.Table.Columns[index].Type == EbDbTypes.Date)\n                        return DateTime.MinValue;\n                }\n                else\n                    return base[index];\n            }\n            else\n                return null;\n            return (index &gt; -1) ? (base[index]) : null;\n        }\n        set\n        {\n            if (index &gt; -1)\n                base[index] = value;\n        }\n    }\n\n    public object this[string columnname]\n    {\n        get { return this[this.Rows.Table.Columns[columnname].ColumnIndex]; }\n        set { this[this.Rows.Table.Columns[columnname].ColumnIndex] = value; }\n    }\n}\n\n[ProtoBuf.ProtoContract]\npublic class RowColletion : List&lt;EbDataRow&gt;\n{\n    public EbDataTable Table { get; private set; }\n\n    [OnDeserialized]\n    public void OnDeserializedMethod(StreamingContext context)\n    {\n        foreach (EbDataRow dr in this)\n            dr.Rows = this;\n    }\n\n    public RowColletion() { }\n\n    public RowColletion(EbDataTable table)\n    {\n        this.Table = table;\n    }\n\n    new public void Add(EbDataRow dr)\n    {\n        dr.Rows = this;\n        base.Add(dr);\n    }\n\n    public void Remove(int index)\n    {\n        base.RemoveAt(index);\n    }\n\n    new public void Remove(EbDataRow row)\n    {\n        base.Remove(row);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 6326, "user_id": 1876572, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/DRVDE.jpg?s=128&g=1", "display_name": "Eldho", "link": "https://stackoverflow.com/users/1876572/eldho"}, "edited": false, "score": 0, "creation_date": 1521055946, "post_id": 49285884, "comment_id": 85575378, "body": "I don&#39;t think you can directly call a event from trigger. prefer bindings and trigger for use case if possible."}], "answers": [{"tags": [], "owner": {"reputation": 858, "user_id": 6081674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nWln4.png?s=128&g=1", "display_name": "WPInfo", "link": "https://stackoverflow.com/users/6081674/wpinfo"}, "is_accepted": false, "score": 0, "last_activity_date": 1521105167, "last_edit_date": 1592644375, "creation_date": 1521105167, "answer_id": 49295343, "question_id": 49285884, "link": "https://stackoverflow.com/questions/49285884/invoking-method-from-within-a-trigger/49295343#49295343", "title": "Invoking method from within a trigger", "body": "<p>You can use behavior instead of property trigger.</p>\n<p>Firstly, add the following two assemblies references to your project:</p>\n<blockquote>\n<p>System.Windows.Interactivity.dll</p>\n<p>Microsoft.Expression.Interactions.dll</p>\n</blockquote>\n<p>Then add the following namespaces in your xaml file:</p>\n<pre><code>xmlns:ei=&quot;http://schemas.microsoft.com/expression/2010/interactions&quot;\nxmlns:i=&quot;http://schemas.microsoft.com/expression/2010/interactivity&quot;\n</code></pre>\n<p>Then add the following xaml code to the target element:</p>\n<pre><code>&lt;Window ...&gt;\n    &lt;i:Interaction.Triggers&gt;\n        &lt;ei:DataTrigger Binding=&quot;{Binding Path=(helpers:MyHelper.IsMouseLeftButtonDown)}&quot; Value=&quot;True&quot;&gt;\n            &lt;ei:CallMethodAction MethodName=&quot;Test_MouseDown&quot; TargetObject=&quot;{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}}&quot; /&gt;\n        &lt;/ei:DataTrigger&gt;\n    &lt;/i:Interaction.Triggers&gt;\n&lt;/Window&gt;\n</code></pre>\n<p>In the window.xaml.cs, you should provide a method named <code>Test_MouseDown</code> like this:</p>\n<pre><code>    public void Test_MouseDown()\n    {\n        // your logic here\n    }\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7822963, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0e435461cf0468b25d8eb48ee0c02a19?s=128&d=identicon&r=PG&f=1", "display_name": "Manish K", "link": "https://stackoverflow.com/users/7822963/manish-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521105167, "creation_date": 1521054443, "question_id": 49285884, "link": "https://stackoverflow.com/questions/49285884/invoking-method-from-within-a-trigger", "title": "Invoking method from within a trigger", "body": "<p>I've a following trigger defined in the xaml.How do I programmatically invoke Test_MouseDown from within this Trigger please?</p>\n\n<p>Thanks for your help.</p>\n\n<p>MyWindow.xaml</p>\n\n<pre><code>&lt;Style.Triggers&gt;\n                    &lt;Trigger Property=\"helpers:MyHelper.IsMouseLeftButtonDown\" Value=\"True\"&gt;\n                        &lt;!--Call some method present in the xaml.cs file--&gt;\n                    &lt;/Trigger&gt;\n                &lt;/Style.Triggers&gt;\n</code></pre>\n\n<p>MyWindow.xaml.cs</p>\n\n<pre><code>private void Test_MouseDown(object sender, MouseButtonEventArgs e)\n{\n\n}\n</code></pre>\n"}, {"tags": ["c#", "linq", "linqpad"], "comments": [{"owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "edited": false, "score": 1, "creation_date": 1521054617, "post_id": 49285868, "comment_id": 85574656, "body": "It seems that the query version is getting executed out of order if that is the case."}, {"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 1, "creation_date": 1521056324, "post_id": 49285868, "comment_id": 85575573, "body": "Maybe the fluent syntax is smart enough to ignore the useless <code>.Select(breedname =&gt; breedname)</code>. It serves no purpose and, while it works for your contrived example, no one would do that in practice."}, {"owner": {"reputation": 14292, "user_id": 2820, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/631713865b68894b6bf525e16d817f58?s=128&d=identicon&r=PG", "display_name": "Onorio Catenacci", "link": "https://stackoverflow.com/users/2820/onorio-catenacci"}, "reply_to_user": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1521057262, "post_id": 49285868, "comment_id": 85576116, "body": "@itsme86 Good point; turns out if I remove the unneeded <code>.Select</code> from the fluent then they both work the same."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1521124081, "post_id": 49285868, "comment_id": 85605909, "body": "@itsme86: You are correct. The compiler removes the trivial select <i>unless doing so would return the original collection</i>. That is to say, <code>from x in y select x</code> is not optimized to <code>y</code>.  It&#39;s generated as <code>y.Select(x=&gt;x)</code>.  If someone is doing <code>return from x in y select x;</code> it&#39;s probably because they want a read-only view of collection <code>y</code>."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1521124205, "post_id": 49285868, "comment_id": 85606002, "body": "See <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2008/05/12/trivial-projections-are-usually-optimized-away/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/ericlippert/2008/05/12/&hellip;</a> for more details on this feature."}, {"owner": {"reputation": 14292, "user_id": 2820, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/631713865b68894b6bf525e16d817f58?s=128&d=identicon&r=PG", "display_name": "Onorio Catenacci", "link": "https://stackoverflow.com/users/2820/onorio-catenacci"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1521127554, "post_id": 49285868, "comment_id": 85608609, "body": "That&#39;s a very interesting (and good) thing to know about that detail of what happens under the hood @EricLippert"}], "answers": [{"tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": true, "score": 2, "last_activity_date": 1521123155, "creation_date": 1521123155, "answer_id": 49301737, "question_id": 49285868, "link": "https://stackoverflow.com/questions/49285868/why-do-i-get-a-different-output-from-analogous-linq-queries/49301737#49301737", "title": "Why do I get a different output from analogous Linq queries?", "body": "<p>In query syntax the transformation is such that when you have a trivial projection (projecting an item to itself) it <em>only</em> generates a <code>Select</code> call when that trivial projection is the <em>only</em> operation in the query.  Since your query contains other operations, the <code>Select</code> is elided entirely, for performance reasons.</p>\n\n<p>A proper translation of that query syntax query into method syntax would skip the <code>Select</code>.  The way to replicate the behavior using query syntax would require something like a second query, to do the trivial projection.</p>\n"}], "owner": {"reputation": 14292, "user_id": 2820, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/631713865b68894b6bf525e16d817f58?s=128&d=identicon&r=PG", "display_name": "Onorio Catenacci", "link": "https://stackoverflow.com/users/2820/onorio-catenacci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 49301737, "answer_count": 1, "score": 2, "last_activity_date": 1521123155, "creation_date": 1521054365, "last_edit_date": 1521122525, "question_id": 49285868, "link": "https://stackoverflow.com/questions/49285868/why-do-i-get-a-different-output-from-analogous-linq-queries", "title": "Why do I get a different output from analogous Linq queries?", "body": "<p>I am trying the following code in LinqPad 5 (specifically 5.26.01)</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>     IEnumerable&lt;string&gt; breeds = new List&lt;string&gt;{\n        \"Fantail\",\n        \"Lahore\",\n        \"Bokhara Trumpeter\",\n        \"Rhine Ringbeater\",\n        \"Birmingham Roller\",\n        \"Pomeranian Pouter\",\n        \"Racing Homer\",\n        \"Archangel\"};\n\n    IEnumerable&lt;string&gt; GetAllBreedsContainingLetter_Fluent(IEnumerable&lt;string&gt; breedlist, string letter)\n    {\n        return breedlist\n            .Where(breedname =&gt; breedname.Contains(letter.ToUpperInvariant()) || breedname.Contains(letter.ToLowerInvariant()))\n            .OrderByDescending(breedname =&gt; breedname)\n            .Select(breedname =&gt; breedname);\n    }\n\n    IEnumerable&lt;string&gt; GetAllBreedsContainingLetter_Query(IEnumerable&lt;string&gt; breedlist, string letter)\n    {\n        return breedlist = from b in breedlist\n                            where (b.Contains(letter.ToUpperInvariant()) || b.Contains(letter.ToLowerInvariant()))\n                            orderby b descending\n                            select b;\n    }\n\n    var breedsFluent = GetAllBreedsContainingLetter_Fluent(breeds, \"R\");\n    breedsFluent.Dump();\n\n    var breedsQuery = GetAllBreedsContainingLetter_Query(breeds, \"R\");\n    breedsQuery.Dump();\n</code></pre>\n\n<p>I think the two functions should be analogous but I noticed something odd about the output in Linqpad.  The first <code>.Dump()</code> is identified as an <code>IEnumerable&lt;String&gt;</code>; the second <code>.Dump()</code> identifies as a <code>IOrderedEnumerable&lt;String&gt;</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/QTBNt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QTBNt.png\" alt=\"LinqPadOutput\"></a></p>\n\n<p>Is this something about the queries I'm running or is it an artifact of Linqpad?  I haven't found anything from Googling. </p>\n"}, {"tags": ["c#", ".net-core"], "comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521054197, "post_id": 49285794, "comment_id": 85574444, "body": "This seems far too broad to be able to answer"}, {"owner": {"reputation": 1141, "user_id": 2023218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09f8323c3df64e6649c9ba9c98287dd?s=128&d=identicon&r=PG", "display_name": "idream1nC0de", "link": "https://stackoverflow.com/users/2023218/idream1nc0de"}, "edited": false, "score": 0, "creation_date": 1521054251, "post_id": 49285794, "comment_id": 85574474, "body": "Where is the rest of the code? There&#39;s not enough here to go on."}, {"owner": {"reputation": 58616, "user_id": 20126, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/22fc146c1512cdb4d381222dcbc8b9f8?s=128&d=identicon&r=PG", "display_name": "Amr Elgarhy", "link": "https://stackoverflow.com/users/20126/amr-elgarhy"}, "edited": false, "score": 0, "creation_date": 1521054318, "post_id": 49285794, "comment_id": 85574512, "body": "I think he is asking here about different ideas not the code to do it"}, {"owner": {"reputation": 34608, "user_id": 84206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144fd462785db33cf6665cafd54101c7?s=128&d=identicon&r=PG", "display_name": "AaronLS", "link": "https://stackoverflow.com/users/84206/aaronls"}, "edited": false, "score": 0, "creation_date": 1521054529, "post_id": 49285794, "comment_id": 85574621, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26038856/how-to-return-a-file-filecontentresult-in-asp-net-webapi\">How to return a file (FileContentResult) in ASP.NET WebAPI</a>"}, {"owner": {"reputation": 34608, "user_id": 84206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144fd462785db33cf6665cafd54101c7?s=128&d=identicon&r=PG", "display_name": "AaronLS", "link": "https://stackoverflow.com/users/84206/aaronls"}, "edited": false, "score": 1, "creation_date": 1521054817, "post_id": 49285794, "comment_id": 85574752, "body": "You can return streams as content. So you need to use a method that writes the zip to a stream and uses that stream as the content stream. So it can stream to the response as the zip is created, here&#39;s an answer specific to returning zips pushed over a stream: <a href=\"https://stackoverflow.com/a/29776084/84206\">stackoverflow.com/a/29776084/84206</a>"}, {"owner": {"reputation": 1248, "user_id": 3715648, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/127fb47b5b0b348ba8c4098e939f2c16?s=128&d=identicon&r=PG&f=1", "display_name": "user3715648", "link": "https://stackoverflow.com/users/3715648/user3715648"}, "reply_to_user": {"reputation": 34608, "user_id": 84206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144fd462785db33cf6665cafd54101c7?s=128&d=identicon&r=PG", "display_name": "AaronLS", "link": "https://stackoverflow.com/users/84206/aaronls"}, "edited": false, "score": 0, "creation_date": 1521054868, "post_id": 49285794, "comment_id": 85574784, "body": "@AaronLS It looks like that uses a memory stream though. Won&#39;t this end up causing my service to consume a lot of memory for large files?"}, {"owner": {"reputation": 34608, "user_id": 84206, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144fd462785db33cf6665cafd54101c7?s=128&d=identicon&r=PG", "display_name": "AaronLS", "link": "https://stackoverflow.com/users/84206/aaronls"}, "edited": false, "score": 0, "creation_date": 1521054961, "post_id": 49285794, "comment_id": 85574822, "body": "@user3715648 You can wire it up to a different type of stream such as compression stream though, not just memory stream, and push only as content is generated so you are never hving more than the bfufer size in memory.  I updated with a better example: <a href=\"https://stackoverflow.com/a/29776084/84206\">stackoverflow.com/a/29776084/84206</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1248, "user_id": 3715648, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/127fb47b5b0b348ba8c4098e939f2c16?s=128&d=identicon&r=PG&f=1", "display_name": "user3715648", "link": "https://stackoverflow.com/users/3715648/user3715648"}, "edited": false, "score": 0, "creation_date": 1521054552, "post_id": 49285881, "comment_id": 85574632, "body": "Your example is storing the files on disk though right? How would this work as a http response?"}, {"owner": {"reputation": 1161, "user_id": 796656, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/85468d0ffa46a5d461c1d980abb1ba46?s=128&d=identicon&r=PG", "display_name": "James Becwar", "link": "https://stackoverflow.com/users/796656/james-becwar"}, "reply_to_user": {"reputation": 1248, "user_id": 3715648, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/127fb47b5b0b348ba8c4098e939f2c16?s=128&d=identicon&r=PG&f=1", "display_name": "user3715648", "link": "https://stackoverflow.com/users/3715648/user3715648"}, "edited": false, "score": 0, "creation_date": 1521063863, "post_id": 49285881, "comment_id": 85579320, "body": "write the GZipStream compressionStream to the response stream instead of  the file stream in the example.  Its like when you pipe the output of tar over scp to avoid storing the file locally."}], "tags": [], "owner": {"reputation": 1161, "user_id": 796656, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/85468d0ffa46a5d461c1d980abb1ba46?s=128&d=identicon&r=PG", "display_name": "James Becwar", "link": "https://stackoverflow.com/users/796656/james-becwar"}, "is_accepted": false, "score": 0, "last_activity_date": 1521054433, "creation_date": 1521054433, "answer_id": 49285881, "question_id": 49285794, "link": "https://stackoverflow.com/questions/49285794/how-can-i-return-a-collection-of-large-files-without-putting-them-in-memory/49285881#49285881", "title": "How can I return a collection of large files without putting them in memory?", "body": "<p>You could try using a gzipsteam, which avoids loading the files in memory.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream(v=vs.110).aspx</a></p>\n\n<p>Here is the example from the page:</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.IO.Compression;\n\nnamespace zip\n{\n    public class Program\n    {\n        private static string directoryPath = @\"c:\\temp\";\n        public static void Main()\n        {\n            DirectoryInfo directorySelected = new DirectoryInfo(directoryPath);\n            Compress(directorySelected);\n\n            foreach (FileInfo fileToDecompress in directorySelected.GetFiles(\"*.gz\"))\n            {\n                Decompress(fileToDecompress);\n            }\n        }\n\n        public static void Compress(DirectoryInfo directorySelected)\n        {\n            foreach (FileInfo fileToCompress in directorySelected.GetFiles())\n            {\n                using (FileStream originalFileStream = fileToCompress.OpenRead())\n                {\n                    if ((File.GetAttributes(fileToCompress.FullName) &amp; \n                    FileAttributes.Hidden) != FileAttributes.Hidden &amp; fileToCompress.Extension != \".gz\")\n                    {\n                        using (FileStream compressedFileStream = File.Create(fileToCompress.FullName + \".gz\"))\n                        {\n                            using (GZipStream compressionStream = new GZipStream(compressedFileStream, \n                            CompressionMode.Compress))\n                            {\n                                originalFileStream.CopyTo(compressionStream);\n\n                            }\n                        }\n                        FileInfo info = new FileInfo(directoryPath + \"\\\\\" + fileToCompress.Name + \".gz\");\n                        Console.WriteLine(\"Compressed {0} from {1} to {2} bytes.\",\n                        fileToCompress.Name, fileToCompress.Length.ToString(), info.Length.ToString());\n                    }\n\n                }\n            }\n        }\n\n        public static void Decompress(FileInfo fileToDecompress)\n        {\n            using (FileStream originalFileStream = fileToDecompress.OpenRead())\n            {\n                string currentFileName = fileToDecompress.FullName;\n                string newFileName = currentFileName.Remove(currentFileName.Length - fileToDecompress.Extension.Length);\n\n                using (FileStream decompressedFileStream = File.Create(newFileName))\n                {\n                    using (GZipStream decompressionStream = new GZipStream(originalFileStream, CompressionMode.Decompress))\n                    {\n                        decompressionStream.CopyTo(decompressedFileStream);\n                        Console.WriteLine(\"Decompressed: {0}\", fileToDecompress.Name);\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1248, "user_id": 3715648, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/127fb47b5b0b348ba8c4098e939f2c16?s=128&d=identicon&r=PG&f=1", "display_name": "user3715648", "link": "https://stackoverflow.com/users/3715648/user3715648"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521054433, "creation_date": 1521054044, "last_edit_date": 1521054133, "question_id": 49285794, "link": "https://stackoverflow.com/questions/49285794/how-can-i-return-a-collection-of-large-files-without-putting-them-in-memory", "title": "How can I return a collection of large files without putting them in memory?", "body": "<p>I need to write an API that retrieves a collection of file streams and then returns the files. These files can get large (~1GB). I need this to be as quick as possible, but this service can't consume too much memory. </p>\n\n<p>In the past when I've had to do something like this, the files weren't large, so I just created a ZIP in memory and returned that. I'm not able to do that this time due to the memory constraint. From what I can tell, multipart responses don't exist, so I can't do that either. What options do I have? Is there some way I can stream zip back as a response?</p>\n\n<pre><code>public async Task GetFiles(string someId)\n{\n    List&lt;Stream&gt; streamList = GetStreams(someId);\n    using (ZipArchive archive = new ZipArchive(responseStream /* ?? */, ZipArchiveMode.Create, true))\n    {\n        ...\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "io"], "comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521053821, "post_id": 49285714, "comment_id": 85574262, "body": "Is your file supposed to be a rolling log, or is it literally just a file with one number on it?"}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521053885, "post_id": 49285714, "comment_id": 85574289, "body": "@maccettura Just a stupid file with 1 number on it...for debugging purposes. I was trying to fix some other (totally unrelated issue)."}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521053986, "post_id": 49285714, "comment_id": 85574338, "body": "I feel like it would be easier to just use <code>var input = File.ReadAllText(&quot;some&#47;path&quot;);</code>  Then <code>int.TryParse()</code>, then write the int back with <code>File.WriteAllText()</code>"}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521054043, "post_id": 49285714, "comment_id": 85574367, "body": "@maccettura Maybe. But I still want to know why this is happening."}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521054150, "post_id": 49285714, "comment_id": 85574423, "body": "What I am trying to say is that your exception could potentially be avoided by not handling the streamreaders yourself and using the preferred <code>File.Etc</code> methods."}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521054316, "post_id": 49285714, "comment_id": 85574510, "body": "@maccettura I understand what you are saying. But what if I had to use the approach in my question (it is a valid approach--unless someone can tell me otherwise), why am I getting an exception. Sure I can use <code>File</code> but I still am curious to know why this exception."}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521054934, "post_id": 49285714, "comment_id": 85574809, "body": "@maccettura even <code>File</code> does not work. Just an FYI..."}, {"owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 0, "creation_date": 1521057114, "post_id": 49285714, "comment_id": 85576015, "body": "<i>There are no threads. Just HTTP GET (regular and via AJAX).</i> - Actually web apps always can have multiple threads if you send requests at the same time (which AJAX can do). It would be helpful if you would provide a sample of the AJAX request so this can be replicated."}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 0, "creation_date": 1521057461, "post_id": 49285714, "comment_id": 85576234, "body": "@NightOwl888 each ajax will have a dedicated thread and they will not affect each other. The same as a regular request. Am I wrong?"}, {"owner": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521057552, "post_id": 49285714, "comment_id": 85576280, "body": "But if you are making multiple requests (since you use load test) - multiple threads will try to read/write the same file at the same time, so exception is not surprising?"}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521057747, "post_id": 49285714, "comment_id": 85576383, "body": "@Evk but the load test will go through the asp.net pipeline and a dedicated thread from the pool will serve it. Things are not shared between requests unless they are static. If this is not the case, then this is &quot;news&quot; to me."}, {"owner": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521057881, "post_id": 49285714, "comment_id": 85576471, "body": "But file is on your filesystem, it&#39;s shared resource, so I don&#39;t see how what you said changes anything. Each request is on dedicated thread, and from that threads they all read/write the same file (I don&#39;t mean same FileStream instance or something - same file on your drive)."}, {"owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 0, "creation_date": 1521057980, "post_id": 49285714, "comment_id": 85576528, "body": "Separate requests are handled on separate threads. When those threads all hit the code the tries to read/write the file at the same time you will have file locking conflicts. File locking is not trivial to implement. Have a look at <a href=\"https://stackoverflow.com/questions/430879/file-locking-read-write-in-asp-net-application\">File Locking (Read/Write) in ASP.NET Application</a> for some ideas."}, {"owner": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521058134, "post_id": 49285714, "comment_id": 85576621, "body": "Maybe &quot;is being used by another process&quot; message confusing you. If so - you should know the same message is produced when you try to access file used by another thread in the same process too."}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521058425, "post_id": 49285714, "comment_id": 85576791, "body": "@Evk Thanks but no that is not confusing to me and I am pretty clear on what the error means. I think NightOwl888 may have a point but this is very, very strange if he is right. ASP.NET does not share anything between requests or else every single class would need to be threadsafe. This means everything I have ever known about web apps goes to s**t."}, {"owner": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521058773, "post_id": 49285714, "comment_id": 85576952, "body": "Your understanding is fine in general, but filesystem is out of control for asp.net, it&#39;s managed by OS. There is just no way it can somehow automatically resolve this problem for you. Request A opens file for exlusive writing, OS puts a lock on it. Request B wants to open for reading - OS rejects. There is nothing asp.net can do with that. Only you can resolve it by managing how you open that file and when."}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "reply_to_user": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521059653, "post_id": 49285714, "comment_id": 85577394, "body": "@Evk Not arguing but I need to understand this. But that means other code within that class would also need to be threadsafe. Which means all classes within asp.net need to be threadsafe. Also please see <a href=\"https://blogs.msdn.microsoft.com/benchr/2008/09/03/does-asp-net-magically-handle-thread-safety-for-you/\" rel=\"nofollow noreferrer\">this</a> which I mentioned earlier: static things are not threadsafe."}, {"owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 0, "creation_date": 1521086393, "post_id": 49285714, "comment_id": 85585415, "body": "@CodingYoshi - Thread safety is a different issue. Opening a separate instance of a class on a different thread is guaranteed to be thread safe. You only have to worry about thread safety when you make a singleton class. The thing is that <i>files</i> are <i>single</i> resources so sharing them between parallel web server requests means you need to have a thread-safe file locking strategy. One way to do that is to make a singleton file manager class that ensures only one write thread can enter at a time, but you will have contention between requests which will not scale well."}, {"owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 0, "creation_date": 1521087160, "post_id": 49285714, "comment_id": 85585619, "body": "@CodingYoshi - A more scaleable approach is to use a queue to eliminate the contention between requests. It really all depends on what your goal is. The approach to use heavily depends on <i>how much</i> contention there will be on the file, which isn&#39;t clear from your question.  If you just want to learn how to implement this, that is one thing, but most developers under time constraints would just go for a tried and true NoSQL or SQL database which has already worked out a file locking strategy than to roll their own which is not trivial to implement or debug."}], "answers": [{"comments": [{"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "edited": false, "score": 0, "creation_date": 1521056069, "post_id": 49286179, "comment_id": 85575448, "body": "From MSDN about Peak&#39;s return: <code>An integer representing the next character to be read, or -1 if there are no characters to be read or if the stream does not support seeking.</code> So if there are no characters, I will keep reading forever. And what about writing?"}, {"owner": {"reputation": 99, "user_id": 8785948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87560cce47aea24eb372bff0e386be07?s=128&d=identicon&r=PG&f=1", "display_name": "TSmith", "link": "https://stackoverflow.com/users/8785948/tsmith"}, "reply_to_user": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "edited": false, "score": 0, "creation_date": 1521056968, "post_id": 49286179, "comment_id": 85575933, "body": "It&#39;s within a while loop... if a -1 comes back (there are no characters to be read) it will stop... it performs what is within the while loop otherwise and ReadLine() moves it to the next line. I&#39;m confused by your comment, please test it out."}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "edited": false, "score": 0, "creation_date": 1521057208, "post_id": 49286179, "comment_id": 85576074, "body": "Ok fair. However, the exception will be thrown at this line <code>using(var reader = new StreamReader(path))</code>, it will not even reach the <code>while</code>. Plus if it cannot <code>Peek</code> then it will skip and I will miss that read and my <code>total</code> will be off."}], "tags": [], "owner": {"reputation": 99, "user_id": 8785948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87560cce47aea24eb372bff0e386be07?s=128&d=identicon&r=PG&f=1", "display_name": "TSmith", "link": "https://stackoverflow.com/users/8785948/tsmith"}, "is_accepted": false, "score": 0, "last_activity_date": 1521057047, "last_edit_date": 1521057047, "creation_date": 1521055543, "answer_id": 49286179, "question_id": 49285714, "link": "https://stackoverflow.com/questions/49285714/streamwriter-reader-reading-and-then-immediately-writing-causes-exception/49286179#49286179", "title": "StreamWriter/Reader reading and then immediately writing causes exception", "body": "<p>I've run into this problem and I solved it by adding a while loop. </p>\n\n<p>Try doing this and see if it solves your problem.</p>\n\n<pre><code>using (var reader = new StreamReader(path))\n{\n    while (reader.Peek() &gt; -1) \n    {\n        var total = reader.ReadLine();\n        newTotal = int.Parse(total) + 1;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521094312, "post_id": 49287896, "comment_id": 85587723, "body": "You just don&#39;t refresh browser fast enough, so requests come one after another. In real usage - many people will visit site and of course their requests will be processed in parallel, just like in load test. It&#39;s <i>load</i> test all - simulates just that."}], "tags": [], "owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1521062858, "creation_date": 1521062858, "answer_id": 49287896, "question_id": 49285714, "link": "https://stackoverflow.com/questions/49285714/streamwriter-reader-reading-and-then-immediately-writing-causes-exception/49287896#49287896", "title": "StreamWriter/Reader reading and then immediately writing causes exception", "body": "<p>The issue is NOT because of:</p>\n\n<ol>\n<li>GC not deallocating and the code reaching writing before <code>reader</code> is collected. I tested the exact code with a console application and the issue cannot be replicated.</li>\n<li>This is not due to threading (<strong>except for one caveat</strong>) because I am not creating any threads. Within ASP.NET each request gets assigned a thread from the pool and an instance of the class with be created for each thread<sup>1</sup>. If there are class level things (<code>static</code>), then they obviously will not be threadsafe. They will be shared. But this code is not within a static context.</li>\n</ol>\n\n<p><strong>Here is the caveat:</strong></p>\n\n<p>When using a browser, this issue was never replicated. I also did something simple like this:</p>\n\n<pre><code>protected override void Initialize(RequestContext requestContext)\n{\n     System.IO.File.AppendAllText(tPath, \"Thread enter and ID is: \" + \n         System.Threading.Thread.CurrentThread.ManagedThreadId + Environment.NewLine);\n     // Placed all code here\n     System.IO.File.AppendAllText(tPath, \"Thread exit and ID is: \" + \n         System.Threading.Thread.CurrentThread.ManagedThreadId + Environment.NewLine);\n}\n</code></pre>\n\n<p>Now with the above code, when the requests are made through a browser, as expected, the contents of the file are as shown below. Notice every entry is <strong>synchronous</strong>:</p>\n\n<pre><code>Thread enter and ID is: 35\nThread exit and ID is: 35\nThread enter and ID is: 11\nThread exit and ID is: 11\nThread enter and ID is: 29\nThread exit and ID is: 29\nThread enter and ID is: 36\nThread exit and ID is: 36\nThread enter and ID is: 27\nThread exit and ID is: 27\nThread enter and ID is: 11\nThread exit and ID is: 11\nThread enter and ID is: 29\nThread exit and ID is: 29\nThread enter and ID is: 8\nThread exit and ID is: 8\nThread enter and ID is: 11\nThread exit and ID is: 11\nThread enter and ID is: 36\nThread exit and ID is: 36\n...\n</code></pre>\n\n<p>But during Visual Studio load testing, the contents are like this and the entry into the method is <strong>not synchronous</strong>:</p>\n\n<pre><code>Thread enter and ID is: 12\nThread exit and ID is: 12\nThread enter and ID is: 29\nThread enter and ID is: 49\nThread enter and ID is: 51\nThread exit and ID is: 29\nThread exit and ID is: 51\nThread enter and ID is: 48\nThread exit and ID is: 48\nThread enter and ID is: 57\nThread exit and ID is: 57\nThread enter and ID is: 17\nThread exit and ID is: 17\nThread enter and ID is: 55\nThread exit and ID is: 55\nThread enter and ID is: 42\nThread exit and ID is: 42\nThread enter and ID is: 47\nThread enter and ID is: 55\n...\n</code></pre>\n\n<p><strong>Conclusion</strong></p>\n\n<p>In conclusion, when doing a load test with Visual Studio, the call behavior is not the exact same as it would be from a browser. For some reason, each thread is not given its own instance of the class. I have no idea why but if someone does, please chime in. I think this is bullcrap if you ask me: <em>How can I do a load test if it is doing something which is totally against the ASP.NET architecture?</em></p>\n\n<p><sub>1. <a href=\"https://blogs.msdn.microsoft.com/benchr/2008/09/03/does-asp-net-magically-handle-thread-safety-for-you/\" rel=\"nofollow noreferrer\">Thread safety ASP.NET</a></sub></p>\n"}], "owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1521062858, "creation_date": 1521053730, "last_edit_date": 1521061339, "question_id": 49285714, "link": "https://stackoverflow.com/questions/49285714/streamwriter-reader-reading-and-then-immediately-writing-causes-exception", "title": "StreamWriter/Reader reading and then immediately writing causes exception", "body": "<p>I need to read a number from a file and then increment the number and update the same file just for debugging purposes. I wrote this code and to my surprise it throws an exception (it is just for debugging but nonetheless I would like to get to the bottom of this):</p>\n\n<blockquote>\n  <p>The process cannot access the file '' because it is being used by another process.</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre><code>string path = Server.MapPath(\"~/Log.txt\");\n\nint newTotal = 0;\n\nusing (var reader = new StreamReader(path))\n{\n    var total = reader.ReadLine();\n\n    if (total != null)\n    {\n        newTotal = int.Parse(total) + 1;\n    }\n}\n\nusing (var writer = new StreamWriter(path, false))\n{\n    // I added AutoFlush because I read somewhere on SO \n    // this will write to disk immediately\n    writer.AutoFlush = true; \n    writer.Write(newTotal);\n}\n</code></pre>\n\n<p>Then I wanted to narrow the issue down to either reading or writing, so I did this:</p>\n\n<pre><code>string path = Server.MapPath(\"~/Log.txt\");\n\nint newTotal = 0;\n\ntry\n{\n    using (var reader = new StreamReader(path))\n    {\n        var total = reader.ReadLine();\n\n        if (total != null)\n        {\n            newTotal = int.Parse(total) + 1;\n        }\n    }\n}\ncatch (Exception)\n{\n    throw new System.Web.HttpException(\"During reading...\");\n}\n\ntry\n{\n    using (var writer = new StreamWriter(path, false))\n    {\n        writer.AutoFlush = true;\n        writer.Write(newTotal);\n    }\n}\ncatch (Exception)\n{\n    throw new System.Web.HttpException(\"During writing...\");\n}\n</code></pre>\n\n<p>I am getting this so this tells me it happens during both but randomly:</p>\n\n<pre><code>During reading...\nDuring writing...\nDuring reading...\nDuring writing...\nDuring reading...\nDuring reading...\nDuring writing...\nDuring writing...\nDuring writing...\nDuring writing...\nDuring writing...\nDuring reading...\nDuring reading...\nDuring reading...\n</code></pre>\n\n<p>Just a note that this code is in the <code>Controller</code> of an MVC app within this method:</p>\n\n<pre><code>protected override void Initialize(RequestContext requestContext)\n{\n    base.Initialize(requestContext);\n    // Code is here\n}\n</code></pre>\n\n<p>I used <em>Process Explorer</em> and nothing else is using the file.</p>\n\n<p><strong>Question</strong>: I am disposing things here so why the exception? </p>\n\n<p>At first I thought perhaps there is a delay in disposing the <code>reader</code> but in that case all exceptions should be about <code>reader</code> but this is not the case. Also, below will also give the same exception:</p>\n\n<pre><code>this.path = Server.MapPath(\"~/Log.txt\");\n\nvar total = System.IO.File.ReadAllText(this.path);\nint newTotal = 0;\n\nif (total != null)\n{\n    newTotal = int.Parse(total) + 1;\n}\n\nSystem.IO.File.WriteAllText(this.path, newTotal.ToString());\n</code></pre>\n\n<p>There are no threads. Just HTTP GET (regular and via AJAX).</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>This happens during load testing using Visual Studio 2015.</p>\n"}, {"tags": ["c#", "object", "reflection", "properties", "comparison"], "comments": [{"owner": {"reputation": 411, "user_id": 6835862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UhjggAjFsDI/AAAAAAAAAAI/AAAAAAAAAmE/HkXWNlp-k3c/photo.jpg?sz=128", "display_name": "elhs16", "link": "https://stackoverflow.com/users/6835862/elhs16"}, "edited": false, "score": 0, "creation_date": 1521053733, "post_id": 49285642, "comment_id": 85574228, "body": "It may help if we could see from the declaration of each instance through to the currently included code.  From what we can see, the two integer values could actually be different, causing the check to fail.  Also, try putting a break point on the line &quot;if ( vinst != vref) {&quot; and check the values and types of vinst and vref"}, {"owner": {"reputation": 2484, "user_id": 4771606, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/J5l4l.png?s=128&g=1", "display_name": "Lucian Bumb", "link": "https://stackoverflow.com/users/4771606/lucian-bumb"}, "edited": false, "score": 0, "creation_date": 1521055071, "post_id": 49285642, "comment_id": 85574876, "body": "you need to cast <code>.ToString()</code> on <code>vinst</code> and <code>vref</code>, in order to compare strings not objects"}], "answers": [{"tags": [], "owner": {"reputation": 919, "user_id": 2088245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTsG0.jpg?s=128&g=1", "display_name": "Kevbo", "link": "https://stackoverflow.com/users/2088245/kevbo"}, "is_accepted": true, "score": 1, "last_activity_date": 1521053900, "creation_date": 1521053900, "answer_id": 49285755, "question_id": 49285642, "link": "https://stackoverflow.com/questions/49285642/comparing-propertyinfo-getvalue-result-when-the-propertyinfo-gettype-is-not-stri/49285755#49285755", "title": "Comparing PropertyInfo.GetValue result when the PropertyInfo.GetType is not string", "body": "<p>i would change your comparison part so its not using != but rather the equals function because the getvalue returns an object and not a specific value</p>\n\n<pre><code>if (!vinst.equals(vref))\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 2653720, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/21f3af91c6025d95d4707da69a50332a?s=128&d=identicon&r=PG", "display_name": "marcelo", "link": "https://stackoverflow.com/users/2653720/marcelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49285755, "answer_count": 1, "score": -1, "last_activity_date": 1521053900, "creation_date": 1521053488, "question_id": 49285642, "link": "https://stackoverflow.com/questions/49285642/comparing-propertyinfo-getvalue-result-when-the-propertyinfo-gettype-is-not-stri", "title": "Comparing PropertyInfo.GetValue result when the PropertyInfo.GetType is not string", "body": "<p>I\u00b4m comparing some properties values from two instances of the same class.</p>\n\n<pre><code>var vinst = prop.GetValue(workinginstance, null);\nvar vref = prop.GetValue(reference, null );\nif ( vinst != vref) {\n            info = info + String.Format( \"{0} differ\", prop.Name );\n            valid = false;\n}\n</code></pre>\n\n<p>My test class have two string props and one int.\nWhen I compare the string values, because the string\u00b4s immutability, the results are fine: is the strings differ, the equality fails,if they are the same, equality test is true.\nBut when the code compare the two int properties, the result is always false. It seems to me that I need some form of casting to the PropertyInfo.GetType(), but don\u00b4t know how to do it.\nAny help will be appreciated.</p>\n"}, {"tags": ["c#", "asp.net-web-api", "dependency-injection", "asp.net-web-api2", "ninject.web.mvc"], "comments": [{"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1521053627, "post_id": 49285608, "comment_id": 85574156, "body": "Did you setup the <code>DependencyResolver</code> correctly for Web API?. Also it is advised to do injection via constructor."}, {"owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1521053718, "post_id": 49285608, "comment_id": 85574216, "body": "Is it mandatory for ninject.mvc5?"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521053909, "post_id": 49285608, "comment_id": 85574306, "body": "Where are your bindings?"}, {"owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "edited": false, "score": 0, "creation_date": 1521054519, "post_id": 49285608, "comment_id": 85574617, "body": "My bindings are in MVC Project. Below code I added in Global.asax.cs      <code>protected override IKernel CreateKernel()         {             var kernal = new StandardKernel();             &#47;&#47;Added here required assemblies.             return kernal;         }</code> Also added DependencyMapper class"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521054690, "post_id": 49285608, "comment_id": 85574694, "body": "What I mean is, post your bindings so we can see. We need information in order to help you."}, {"owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "reply_to_user": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521054903, "post_id": 49285608, "comment_id": 85574796, "body": "@JuanR <code>public class DependencyMapper : NinjectModule     {         public override void Load()         {             this.Bind&lt;IStage&gt;().To&lt;Stage&gt;();         }     }</code>"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521055027, "post_id": 49285608, "comment_id": 85574845, "body": "Please post code within the question, not as a comment. I added it for you."}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521055065, "post_id": 49285608, "comment_id": 85574873, "body": "How are you loading this module into the kernel?"}, {"owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "reply_to_user": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521055836, "post_id": 49285608, "comment_id": 85575314, "body": "@JuanR I posted all my code changes. NinjectModule was automatically invoked by kernel.Load() method."}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521055864, "post_id": 49285608, "comment_id": 85575331, "body": "Got it. Thank you. Have you checked the <code>DependencyResolver.Current</code> property? What type of object is it set to?"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 1, "creation_date": 1521056217, "post_id": 49285608, "comment_id": 85575522, "body": "The first thing I asked about was  the <code>DependencyResolver</code>, which is what the framework uses for injection. If that is not configured correctly then you would experience the issues you are currently getting. Obviously the one for MVC is working. Show the web api config."}, {"owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "reply_to_user": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521056622, "post_id": 49285608, "comment_id": 85575732, "body": "@JuanR Sorry, I dont know whether I interpreted your question correctly. I have not used DependencyResolver in my code. Where can I  check this property?"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1521056739, "post_id": 49285608, "comment_id": 85575801, "body": "It was @Nkosi that first asked about it. You can find it here:  <code>System.Web.Mvc.DependencyResolver.Current</code>. It&#39;s a static class used by the Mvc infrastructure. Let us know what type of object it is set to."}, {"owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "reply_to_user": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521057917, "post_id": 49285608, "comment_id": 85576491, "body": "Thanks @JuanR and Nkosi. I checked &quot;Current&quot; object&#39;s type which is of &quot;Ninject.Web.Mvc.NinjectDependencyResolver&quot; in both MVC and Class Library."}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1521058317, "post_id": 49285608, "comment_id": 85576737, "body": "That means the resolver is set correctly. It sounds like your module is not being loaded. You can verify this by performing the binding when creating the kernel: <code>kernel.Bind&lt;IStage&gt;().To&lt;Stage&gt;();</code>. If this makes the program work, you will know it&#39;s the module that is not loaded for some reason. Which library does <code>DependencyMapper</code> belong to?"}], "answers": [{"tags": [], "owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "is_accepted": false, "score": 0, "last_activity_date": 1521058564, "creation_date": 1521058564, "answer_id": 49286924, "question_id": 49285608, "link": "https://stackoverflow.com/questions/49285608/ninject-setter-injection-in-attribute-routing-web-api/49286924#49286924", "title": "ninject setter injection in attribute routing Web API", "body": "<p>I suspect your <code>DependencyMapper</code>class is not being loaded.</p>\n\n<p>From the documentation concerning the overload you are using to load assemblies:</p>\n\n<pre><code>public static Assembly Load(string assemblyString)\n</code></pre>\n\n<blockquote>\n  <p>assemblyString \n  Type: System.String \n  The long form of the assembly name.</p>\n</blockquote>\n\n<p>For instance: </p>\n\n<pre><code>string longName = \"system, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\";\n</code></pre>\n\n<p>Make sure to provide the long names when loading assemblies for the kernel.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "is_accepted": false, "score": 0, "last_activity_date": 1521128932, "creation_date": 1521128932, "answer_id": 49303828, "question_id": 49285608, "link": "https://stackoverflow.com/questions/49285608/ninject-setter-injection-in-attribute-routing-web-api/49303828#49303828", "title": "ninject setter injection in attribute routing Web API", "body": "<p>Thanks @JuanR and @NKosi.</p>\n\n<p>Finally, I got solution. Since the project solution contains MVC and Web API both, we have to set DependencyResolver of both types - <code>System.Web.Http.Dependencies.IDependencyResolver, System.Web.Mvc.IDependencyResolver</code>. Below link is the one helped to solve it.</p>\n\n<p><a href=\"http://blog.developers.ba/simple-way-share-container-mvc-web-api/\" rel=\"nofollow noreferrer\">http://blog.developers.ba/simple-way-share-container-mvc-web-api/</a></p>\n"}], "owner": {"reputation": 31, "user_id": 1412321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10f01d880137cf7314f0f0bd92daa45?s=128&d=identicon&r=PG", "display_name": "Manik_trs", "link": "https://stackoverflow.com/users/1412321/manik-trs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1521128932, "creation_date": 1521053372, "last_edit_date": 1521055497, "question_id": 49285608, "link": "https://stackoverflow.com/questions/49285608/ninject-setter-injection-in-attribute-routing-web-api", "title": "ninject setter injection in attribute routing Web API", "body": "<p>I am trying ninject.mvc5 to do DI on Web API application.</p>\n\n<p>I added ninject and ninject.mvc5 in my main MVC project. I added one class library for Web API controllers and using attribute routing. I was trying to inject an object using Setter Injection on both MVC project and class library. Object properly injected in MVC project whereas it's null in class library.</p>\n\n<p>Below code block is from MVC application where Stage contains correct object.</p>\n\n<pre><code>public class HomeController : Controller\n{\n    [Inject]\n    public IStage Stage { get; set; }\n}\n</code></pre>\n\n<p>Below code is from class library where its failing.</p>\n\n<pre><code>public class UserController : ApiController\n{\n    [Inject]\n    public IStage Stage { get; set; }\n}\n</code></pre>\n\n<p>Here are the bindings:</p>\n\n<pre><code>public class WebApiApplication : Ninject.Web.Common.WebHost.NinjectHttpApplication\n{\n    protected override void OnApplicationStarted()\n    {\n        base.OnApplicationStarted();\n        AreaRegistration.RegisterAllAreas();\n        GlobalConfiguration.Configure(WebApiConfig.Register);\n        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);\n        RouteConfig.RegisterRoutes(RouteTable.Routes);\n        BundleConfig.RegisterBundles(BundleTable.Bundles);\n        //RegisterDependencies();\n    }\n\n    protected override IKernel CreateKernel()\n    {\n        var kernal = new StandardKernel();\n        kernal.Load(Assembly.GetExecutingAssembly(), \n            Assembly.Load(\"UserLibrary\"), \n            Assembly.Load(\"StageContracts\"), \n            Assembly.Load(\"StageLibrary\"));\n        return kernal;\n    }\n}\n\npublic class DependencyMapper : NinjectModule \n{ \n    public override void Load() \n    { \n        this.Bind&lt;IStage&gt;().To&lt;Stage&gt;(); \n    } \n}\n</code></pre>\n\n<p>Not sure what am I missing here. Any help would be much appreciated.</p>\n"}, {"tags": ["c#", "docker", "asp.net-core"], "owner": {"reputation": 21, "user_id": 9493353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e549a0363f88f7d7026ba89009291e9a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephLamar", "link": "https://stackoverflow.com/users/9493353/josephlamar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 632, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1548349459, "creation_date": 1521053298, "last_edit_date": 1521054078, "question_id": 49285583, "link": "https://stackoverflow.com/questions/49285583/unable-to-connect-to-any-of-the-specified-mysql-hosts-in-docker", "title": "Unable to connect to any of the specified MySQL hosts in docker", "body": "<p>i'm running my asp.net core application through systemd and nginx on linux and it works fine. I have tried to run it through a docker container but i'm getting an error when i use docker run -p 5000:5000 name-of-repo : <code>Application startup exception: MySql.Data.MySqlClient.MySqlException (0x80004005): Unable to connect to any of the specified MySQL hosts.</code></p>\n\n<p>which is weird because running through systemd or dotnet run doesnt give this error and the application works just fine. Am i missing some configuration in docker or something?</p>\n\n<p>here is my dockerfile:</p>\n\n<pre><code>FROM microsoft/dotnet:latest\nCOPY . /app\nWORKDIR /app\n\nRUN dotnet restore\nRUN dotnet build\n\nEXPOSE 5000/tcp\nENV ASPNETCORE_URLS http://*:5000\nENV ASPNETCORE_ENVIRONMENT docker\n\nENTRYPOINT dotnet run\n</code></pre>\n"}, {"tags": ["c#", "xamarin", "reactiveui"], "comments": [{"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 3, "creation_date": 1521054376, "post_id": 49285579, "comment_id": 85574547, "body": "provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that can be used to reproduce the problem. You are more likely to get help that way."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3170849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ydBk.jpg?s=128&g=1", "display_name": "nikschilli", "link": "https://stackoverflow.com/users/3170849/nikschilli"}, "edited": false, "score": 1, "creation_date": 1521471043, "post_id": 49302708, "comment_id": 85732130, "body": "You are indeed correct, we are heavily relying on the service locator antipattern. Due to the structure of our classes we are unable/unwilling to inject as many dependenices as some classes have. To resolve this we are switching to a factory backed provider class which gives us the wired up viewmodels. We started however by injecting the service locator per constructor. This allowed us to decouple the dependencies from the static variable, thus allowing us to execute tests in parallel. Even though this hides the classes dependencies, this is a step forward in the right direction!"}], "tags": [], "owner": {"reputation": 27758, "user_id": 717732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YCxg1.png?s=128&g=1", "display_name": "quetzalcoatl", "link": "https://stackoverflow.com/users/717732/quetzalcoatl"}, "is_accepted": true, "score": 3, "last_activity_date": 1597394548, "last_edit_date": 1597394548, "creation_date": 1521125726, "answer_id": 49302708, "question_id": 49285579, "link": "https://stackoverflow.com/questions/49285579/run-unit-tests-in-parallel-for-code-using-splat/49302708#49302708", "title": "Run unit tests in parallel for code using Splat", "body": "<p><em>Disclaimer: I have no idea what SPLAT is. All what I wrote is a generic knowledge on C#, DI, multithreading, testing, and common pitfalls. There is a slight chance that SPLAT solves it in some brillant way. Non-zero chance. Closer to zero.</em></p>\n<hr />\n<p>I guess you are using DI in Service Locator (anti)pattern. I guess that your <code>Locator.CurrentMutable.xxx</code> is a globally-static handy thingie that you can access anywhere and ask it for anything. So, it's screwed up for multithreading*) and/or testing. Period.</p>\n<p>Quoting from <a href=\"https://github.com/reactiveui/splat#service-location\" rel=\"nofollow noreferrer\">https://github.com/reactiveui/splat#service-location</a>:</p>\n<blockquote>\n<p>Locator.Current is a static variable that can be set on startup, to\nadapt Splat to other DI/IoC frameworks. This is usually a bad idea.</p>\n</blockquote>\n<p>So, well, yeah, it's static. Not good.</p>\n<p>When you run multiple tests in parallel, they all try to register their own mocks for the same service, and <strong>they are bound to intersect</strong>. If your DI thingie were reasonable, it would throw an exception. Seems it is not, so probably last registration wins, so test A gets a mock registered by test B. This screws up the Verify, since test A reads from mock B and that mock recorded operations from test B not A, so Verify from A fails.</p>\n<p>That is correct behavior.</p>\n<p>The error is in your test setup, test running, or, in your DI architecture.</p>\n<p>If you insist on using service-locator pattern, at least make it nonstatic. Each test must have its own resolution context. If they are shared, test will intersect and fail.</p>\n<p>Easiest solution is drop service-locator pattern. Obviously it's not possible since you tell us you have a large code base.</p>\n<p>Another option is to de-staticize the locator. Try to make it so that it can be &quot;contextual&quot;, so that every test will have its own <strong>separate instance</strong> of the service provider/locator. This will solve the problem, as registrations will happen on different instances and will not intersect and overwrite.</p>\n<p>If your tests are plain and internally single-threaded, you can achieve that by making the <code>Locator.CurrentMutable</code> or the <code>Locator</code> <strong>thread-static</strong> or anything like that, like 'async context' or anything you consider better. But you should do it only in <strong>tests</strong>, as making it thread static in real application will probably break it, since your app was not designed with that in mind.</p>\n<p>Finally, instead of playing with the code, or test code, or service provider lifetime, you can try adapting how the tests are run. If <code>Locator.CurrentMutable</code> is globally static and has to stay like that, then...</p>\n<p>...then your tests <strong>cannot be ran in parallel in the same process</strong> (because they will intersect)...</p>\n<p>...but that does not prevent you from running them in <strong>separate processes</strong>.</p>\n<p>Get the docs, check out source code, and write yourself a brand new runner for xUnit, that will:</p>\n<ul>\n<li>take the tests to run</li>\n<li>create 5-10-20-100 worker processess (configurable?)</li>\n<li>distribute tests to run over worker processes</li>\n<li>each worker process gets his part of the tests</li>\n<li>each worker process <strong>runs his tests one by one, not in parallel</strong></li>\n</ul>\n<p>Instead of pre-distributing, you can pool&amp;dequeue them, to make sure that there won't be a case where one process lingers with his 99 tests left because one test took longer, etc. Up to you. The most important thing is, do not parallelize them in-single-process, if your service-locator is global and if you register mocks in it on a per-test basis.</p>\n<p>*) yes, I know mutex/etc. But it still is screwed unless it is immutable from the consumer's viewpoint, and here it apparently it is not immutable.</p>\n"}], "owner": {"reputation": 51, "user_id": 3170849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ydBk.jpg?s=128&g=1", "display_name": "nikschilli", "link": "https://stackoverflow.com/users/3170849/nikschilli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 1, "accepted_answer_id": 49302708, "answer_count": 1, "score": 2, "last_activity_date": 1597394548, "creation_date": 1521053292, "last_edit_date": 1521124505, "question_id": 49285579, "link": "https://stackoverflow.com/questions/49285579/run-unit-tests-in-parallel-for-code-using-splat", "title": "Run unit tests in parallel for code using Splat", "body": "<p>We develop mobile apps using ReactiveUI, and thus use Splat as a Dependency injection framework. When running our unit tests we decided to let them run in parallel to increase feedback speed in the IDE. We noticed that certain tests failed because our SUT used Splat and thus we used splat to inject mocks in the tests. I am sure this has happened to other teams using Splat, so I would want to know if there is a built-in way to circumvent this obstacle.</p>\n\n<pre><code>public interface IDependency\n{\n    void Invoke();\n}\n\npublic class SUT1\n{\n    private IDependency dependency;\n    public SUT1()\n    {\n        dependency = Locator.CurrentMutable.GetService&lt;IDependency&gt;();      \n    }\n    public void TestThis()\n    {\n        dependency.Invoke();\n    }\n}\n\npublic class SUT2\n{\n   private IDependency dependency;\n    public SUT2()\n    {\n        dependency = Locator.CurrentMutable.GetService&lt;IDependency&gt;();      \n    }\n    public void TestThisToo()\n    {\n         dependency.Invoke();\n    }\n}\n\npublic class SUT1_Test()\n{\n    [Fact]\n    public void TestSUT1()\n    {\n        var dependencyMock = new Mock&lt;IDependency&gt;();\n        Locator.CurrentMutable.Register(() =&gt; dependencyMock.Object, typeof(IDependency));\n        var sut = new SUT1();\n        sut.TestThis();\n        dependencyMock.Verify(x =&gt; x.Invoke(), Times.Once);\n    }\n}\n\npublic class SUT2_Test()\n{\n    [Fact]\n    public void TestSUT2()\n    {\n        var dependencyMock = new Mock&lt;IDependency&gt;();\n        Locator.CurrentMutable.Register(() =&gt; dependencyMock.Object, typeof(IDependency));\n        var sut = new SUT2();\n        sut.TestThisToo();\n        dependencyMock.Verify(x =&gt; x.Invoke(), Times.Once);\n    }\n}\n</code></pre>\n\n<p>If the tests are run in a manner where a new mock is injected before the function is called the verification of invocation will be all kinds of messed up. Disabling parallelization enables us to get correct results everytime, at the expense of time used to run the tests in a sequential order.</p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 4, "creation_date": 1521053597, "post_id": 49285567, "comment_id": 85574139, "body": "Where&#39;s the <code>do</code>-<code>while</code> loop?"}, {"owner": {"reputation": 15414, "user_id": 374310, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ead2328017843c0daade8cd198ddf83b?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/374310/igor"}, "edited": false, "score": 0, "creation_date": 1521054103, "post_id": 49285567, "comment_id": 85574401, "body": "&quot;an extra curly brace&quot; has never hurt anybody"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1521054738, "post_id": 49285567, "comment_id": 85574711, "body": "Please don&#39;t ask questions about code that doesn&#39;t exist.  How on earth should we know what typo you&#39;ve made on a page you haven&#39;t shown us?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1521055002, "post_id": 49285567, "comment_id": 85574837, "body": "You will find it easier to get your code correct when you break it up into smaller methods.  Write a helper method: <code>bool ValidateText(string s) =&gt; Request[s].ToString().Trim() != &quot;&quot;</code> and write another helper method <code>void ReportError(Control c, string s) { lblError.Text = s; c.BackColor = Yellow; }</code>  And now your logic is much easier to read:  <code>if (!ValidateText(&quot;txtFirstName&quot;)) ReportError(txtFirstName, &quot;ERROR&quot;);</code>"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1521055115, "post_id": 49285567, "comment_id": 85574898, "body": "That said, I don&#39;t understand the question in the first place. Why would you be putting a loop into a server page? Handle the request, serve the result, done.  No loop required."}], "answers": [{"tags": [], "owner": {"reputation": 120, "user_id": 7643427, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ef0fa147706d720694fd6fba96fbb3d?s=128&d=identicon&r=PG&f=1", "display_name": "joseph.c", "link": "https://stackoverflow.com/users/7643427/joseph-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1521067463, "creation_date": 1521067463, "answer_id": 49288811, "question_id": 49285567, "link": "https://stackoverflow.com/questions/49285567/a-do-while-loop-to-validate-textboxes-in-c-is-causing-extra-curly-braces-or-inf/49288811#49288811", "title": "A do while loop to validate textboxes in C# is causing extra curly braces or infinite loop", "body": "<p>Personally I would add a return in every check, which should shorten the validation process. Also you should not be using a do-while or while loop since you want the user to be able to fix the error, from what I understand how you setting up the do-while or while loop will only cause an infinite loop. You should set it up this way.</p>\n\n<pre><code>protected void someBtn_Click(object o, eventags e)\n{\n    if (Request[\"txtFirstName\"].ToString().Trim() == \"\")\n    {\n        txtFirstName.BackColor = System.Drawing.Color.Yellow;\n        lblError.Text = \"ERROR\";\n        return;\n    }\n    ....repeat this for all check\n\n    //If everything checks off \n    Session[\"txtFirstName\"] = txtFirstName.Text;\n    Session[\"txtLastName\"] = txtLastName.Text;\n    Session[\"txtPayRate\"] = txtPayRate.Text;\n    Session[\"txtStartDate\"] = txtStartDate.Text;\n    Session[\"txtEndDate\"] = txtEndDate.Text;\n\n    ....and whatever is left to do\n}\n</code></pre>\n\n<p>If you want to highlight all textbox with errors first, add a bool hasError = false at the beginning, change all return to hasError = true, and do a final check before the last step</p>\n\n<pre><code>if(hasError)\n    return;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9493380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6654fe7e6ceb34d60c36fb0649913b1?s=128&d=identicon&r=PG&f=1", "display_name": "chrismcg10", "link": "https://stackoverflow.com/users/9493380/chrismcg10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1521070584, "accepted_answer_id": 49288811, "answer_count": 1, "score": -3, "last_activity_date": 1521067463, "creation_date": 1521053253, "last_edit_date": 1521056262, "question_id": 49285567, "link": "https://stackoverflow.com/questions/49285567/a-do-while-loop-to-validate-textboxes-in-c-is-causing-extra-curly-braces-or-inf", "closed_reason": "Not suitable for this site", "title": "A do while loop to validate textboxes in C# is causing extra curly braces or infinite loop", "body": "<p>I am trying to validate information in textboxes using C# &amp; ASP.NET.</p>\n\n<p>The information is being validated, however will no longer validate after I go through the list of text boxes. I tried to loop until all information is filled but it either causes infinite loop or an extra curly brace.</p>\n\n<p>Here is a snippet of the code</p>\n\n<pre><code>if (Request[\"txtFirstName\"].ToString().Trim() == \"\")\n{\n    txtFirstName.BackColor = System.Drawing.Color.Yellow;\n    lblError.Text = \"ERROR\";\n}\n\nif (Request[\"txtLastName\"].ToString().Trim() == \"\")\n{\n    txtLastName.BackColor = System.Drawing.Color.Yellow;\n    lblError.Text = \"ERROR\";\n}\netc...  \n\nelse\n{\n    Session[\"txtFirstName\"] = txtFirstName.Text;\n    Session[\"txtLastName\"] = txtLastName.Text;\n    Session[\"txtPayRate\"] = txtPayRate.Text;\n    Session[\"txtStartDate\"] = txtStartDate.Text;\n    Session[\"txtEndDate\"] = txtEndDate.Text;\n\n    DateTime txtStart = DateTime.Parse(txtStartDate.Text);\n    DateTime endDate = DateTime.Parse(txtEndDate.Text);\n\n    DateTime.Compare(txtStart, endDate);\n\n    if (txtStart &gt; endDate)\n    {\n        lblError.Text = \"start is greater then end\";\n        txtStartDate.BackColor = System.Drawing.Color.Yellow;\n        txtEndDate.BackColor = System.Drawing.Color.Yellow;\n    }\n}\n</code></pre>\n\n<p>No matter where I put the loop either do while or while loop it is not working? Can anyone suggest some tips? Thanks</p>\n"}, {"tags": ["c#", "unity3d", "unet"], "comments": [{"owner": {"reputation": 3967, "user_id": 8949476, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54d34b1abb6c973aa0be45f5e953b405?s=128&d=identicon&r=PG&f=1", "display_name": "Aousaf rashid", "link": "https://stackoverflow.com/users/8949476/aousaf-rashid"}, "edited": false, "score": 0, "creation_date": 1521053288, "post_id": 49285521, "comment_id": 85573952, "body": "Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">tour</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 9493422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8843a513b9b8e0f8b21a807e586fce20?s=128&d=identicon&r=PG&f=1", "display_name": "Joand1993", "link": "https://stackoverflow.com/users/9493422/joand1993"}, "is_accepted": true, "score": 1, "last_activity_date": 1521053309, "creation_date": 1521053309, "answer_id": 49285588, "question_id": 49285521, "link": "https://stackoverflow.com/questions/49285521/pre-existing-network-identity-in-scene-crashing-clients-joining-the-host/49285588#49285588", "title": "Pre-existing network identity in scene crashing clients joining the host", "body": "<p>I had this exact problem. I put a offline scene and an online scene in my network manager gameobject. Then let the server change scenes itself.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 8636238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f61458def2873e3a43845edeefa5a02?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Sirois", "link": "https://stackoverflow.com/users/8636238/alex-sirois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 49285588, "answer_count": 1, "score": -3, "last_activity_date": 1521054745, "creation_date": 1521053054, "last_edit_date": 1521054745, "question_id": 49285521, "link": "https://stackoverflow.com/questions/49285521/pre-existing-network-identity-in-scene-crashing-clients-joining-the-host", "title": "Pre-existing network identity in scene crashing clients joining the host", "body": "<p>I have a problem in my unity project where I try to host a network game on my host and the game crashes for the clients joining. I think it has something to do with the network identity in the scene. I connect to the server in a scene and then switch to the game scene. On the host it works fine, but then on the client my gameobject with a network identity is disabled and it bugs out.</p>\n\n<p>Any idea how to fix?</p>\n"}, {"tags": ["c#", ".net", "winforms", "visual-studio"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1521053419, "post_id": 49285494, "comment_id": 85574031, "body": "Only classes with a static Main() method show up in that combobox.  Consider modifying your existing Program class, edit Main() the way you want it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8996397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K3PhPEn4PLU/AAAAAAAAAAI/AAAAAAAABv8/JoYkyIXd8qs/photo.jpg?sz=128", "display_name": "Shafiq Ahamed", "link": "https://stackoverflow.com/users/8996397/shafiq-ahamed"}, "edited": false, "score": 0, "creation_date": 1521082065, "post_id": 49287810, "comment_id": 85584494, "body": "thank you now its working after changing the Application.Run(new DesiredForm()) from program.cs"}], "tags": [], "owner": {"reputation": 95, "user_id": 7787035, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10208685666115192/picture?type=large", "display_name": "Dor Lugasi", "link": "https://stackoverflow.com/users/7787035/dor-lugasi"}, "is_accepted": false, "score": 1, "last_activity_date": 1521062458, "creation_date": 1521062458, "answer_id": 49287810, "question_id": 49285494, "link": "https://stackoverflow.com/questions/49285494/how-particular-windows-form-set-as-start-up-project-in-visual-studio-2013/49287810#49287810", "title": "How particular windows form set as start up project in visual studio 2013?", "body": "<p>if i understood correctly you have several forms and you are trying to set a specific one as the very first? </p>\n\n<p>you should set a new instance of your DesiredForm in your Program.cs</p>\n\n<pre><code> static class Program\n{\n    /// &lt;summary&gt;\n    /// The main entry point for the application.\n    /// &lt;/summary&gt;\n    [STAThread]\n    static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n        Application.Run(new DesiredForm()); // &lt;---\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8996397, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-K3PhPEn4PLU/AAAAAAAAAAI/AAAAAAAABv8/JoYkyIXd8qs/photo.jpg?sz=128", "display_name": "Shafiq Ahamed", "link": "https://stackoverflow.com/users/8996397/shafiq-ahamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1540031006, "creation_date": 1521052966, "last_edit_date": 1540031006, "question_id": 49285494, "link": "https://stackoverflow.com/questions/49285494/how-particular-windows-form-set-as-start-up-project-in-visual-studio-2013", "title": "How particular windows form set as start up project in visual studio 2013?", "body": "<p>I want to set particular windows form as start up project in visual studio 2013. And I completed multiple form designing but I can't link one form to another.How to execute one by one form.</p>\n\n<p><a href=\"https://i.stack.imgur.com/CPfuI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CPfuI.png\" alt=\"Project settings\"></a></p>\n\n<p>How do I change setting in project properties?</p>\n"}, {"tags": ["c#", "winforms", "datagridview", "filtering", "dataview"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 9052041, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b9bZVwl50o0/AAAAAAAAAAI/AAAAAAAAT6k/g2KS4lggz0E/photo.jpg?sz=128", "display_name": "\u0422\u0438\u0433\u0440\u0430\u043d \u041c\u0430\u0440\u0442\u0438\u0440\u043e\u0441\u044f\u043d", "link": "https://stackoverflow.com/users/9052041/%d0%a2%d0%b8%d0%b3%d1%80%d0%b0%d0%bd-%d0%9c%d0%b0%d1%80%d1%82%d0%b8%d1%80%d0%be%d1%81%d1%8f%d0%bd"}, "is_accepted": true, "score": 2, "last_activity_date": 1521108049, "last_edit_date": 1521108049, "creation_date": 1521061098, "answer_id": 49287512, "question_id": 49285483, "link": "https://stackoverflow.com/questions/49285483/filtering-datagridview-if-datasorce-is-bindinglist-that-implements-ibindinglist/49287512#49287512", "title": "filtering datagridview if DataSorce is BindingList, that implements IBindingListView", "body": "<blockquote>\n  <p>Solved</p>\n</blockquote>\n\n<pre><code>private void PopulateCombobox(object column)\n{\n    comboBox1.DataSource = null;\n    BindingSource data = dataGridView.DataSource as BindingSource;\n    DataGridViewColumn col = column as DataGridViewColumn;\n    ArrayList list = new ArrayList(data.Count);\n\n    // Retrieve each value and add it to the ArrayList if it isn't\n    // already present. \n    foreach (Object item in data)\n    {\n        Object value = null;\n\n        PropertyInfo[] properties = item.GetType().GetProperties(\n            BindingFlags.Public | BindingFlags.Instance);\n        foreach (PropertyInfo property in properties)\n        {\n            if (String.Compare(col.DataPropertyName,\n                    property.Name, true /*case insensitive*/,\n                    System.Globalization.CultureInfo.InvariantCulture) == 0)\n            {\n                value = property.GetValue(item, null /*property index*/);\n                break;\n            }\n            else if(property.PropertyType==typeof(Address)|| property.PropertyType == typeof(Contact) /*||property.PropertyType==typeof(Geo)*/)\n            {\n                string propname = col.DataPropertyName.Substring(col.DataPropertyName.IndexOf('.') + 1);\n                if (string.Compare(col.DataPropertyName, property.Name + '.' + propname, true,\n                        System.Globalization.CultureInfo.InvariantCulture) == 0)\n                {\n                    object obj = property.GetValue(item, null);\n                    Type propType = obj.GetType();\n                    PropertyInfo pinf = propType.GetProperty(propname);\n                    value = pinf.GetValue(obj, null) == null\n                        ? string.Empty\n                        : pinf.GetValue(obj, null).ToString();\n                }\n            }\n        }\n\n        // Skip empty values, but note that they are present. \n        if (value == null || value == DBNull.Value)\n        {\n\n            continue;\n        }\n\n        // Add values to the ArrayList if they are not already there.\n        if (!list.Contains(value))\n        {\n            list.Add(value);\n        }\n    }\n    comboBox1.DataSource = list;\n}\n</code></pre>\n\n<p>Simply if we have '.'(dot) DataPropertyName when we are going to chek maybe right part of Name will suit us(or satisfy).</p>\n"}], "owner": {"reputation": 79, "user_id": 9052041, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-b9bZVwl50o0/AAAAAAAAAAI/AAAAAAAAT6k/g2KS4lggz0E/photo.jpg?sz=128", "display_name": "\u0422\u0438\u0433\u0440\u0430\u043d \u041c\u0430\u0440\u0442\u0438\u0440\u043e\u0441\u044f\u043d", "link": "https://stackoverflow.com/users/9052041/%d0%a2%d0%b8%d0%b3%d1%80%d0%b0%d0%bd-%d0%9c%d0%b0%d1%80%d1%82%d0%b8%d1%80%d0%be%d1%81%d1%8f%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 1, "accepted_answer_id": 49287512, "answer_count": 1, "score": 2, "last_activity_date": 1521108049, "creation_date": 1521052932, "last_edit_date": 1521107339, "question_id": 49285483, "link": "https://stackoverflow.com/questions/49285483/filtering-datagridview-if-datasorce-is-bindinglist-that-implements-ibindinglist", "title": "filtering datagridview if DataSorce is BindingList, that implements IBindingListView", "body": "<blockquote>\n  <p>Problem: store non-simple class property values.</p>\n</blockquote>\n\n<p>I have <code>BindingListView&lt;Hotel&gt;</code> and this is DataSorce of my datagridview.\nI would like to notice that Hotel class looks like this.</p>\n\n<pre><code>public class Hotel\n{\n    private Address address;\n\n    private Address legalAddress;\n\n    private Contact contacts;\n\n    public Hotel()\n    {\n        address= new Address(String.Empty);\n        legalAddress= new Address(String.Empty);\n        contacts= new Contact(string.Empty,string.Empty,string.Empty,string.Empty);\n        geo= new Geo(string.Empty);\n    }\n\n    public Contact Contacts\n    {\n        get { return contacts; }\n        set { contacts = value; }\n    }\n\n    public Address Address\n    {\n        get { return address; }\n        set { address = value; }\n    }\n\n\n    public Address LegalAddress\n    {\n        get { return legalAddress; }\n        set { legalAddress = value; }\n    }\n\n    public string FullName { get;  set; }\n\n    public string AdmArea { get;  set; }\n}\n</code></pre>\n\n<p>and now about <code>Address</code></p>\n\n<pre><code>public class Address\n{\n    private string fullAddress;\n    private int index;\n\n\n    public Address(string str)\n    {\n        fullAddress = string.IsNullOrWhiteSpace(str) ? null : str;\n    }\n\n    public string FullAddress\n    {\n        get { return fullAddress; }\n        set\n        {\n           fullAddress= string.IsNullOrWhiteSpace(value) ? null : value;\n        }\n    }\n\n    public string Index {\n        get { return index.ToString(); }\n    }\n}\n</code></pre>\n\n<p>So as you can see <code>Adress</code> and <code>Contacts</code> aren't simple Types\nI populate data to datagridview using reflection.</p>\n\n<p>Datagridview take data fromm this options:</p>\n\n<pre><code>//\n// District\n// \nthis.District.DataPropertyName = \"District\";\nthis.District.HeaderText = \"District\";\nthis.District.Name = \"District\";\n// \n// Address\n// \nthis.Address.DataPropertyName = \"Address.FullAddress\";\nthis.Address.HeaderText = \"Address\";\nthis.Address.Name = \"Address\";\n// \n// LegalAddress\n// \nthis.LegalAddress.DataPropertyName = \"LegalAddress.FullAddress\";\nthis.LegalAddress.HeaderText = \"LegalAddress\";\nthis.LegalAddress.Name = \"LegalAddress\";\n</code></pre>\n\n<p>Now I want allow user to filter data in datagridview</p>\n\n<p>So I want to do something like this:<a href=\"https://i.stack.imgur.com/KJXr2.png\" rel=\"nofollow noreferrer\">thing that I want to reach</a></p>\n\n<p>Main idea - in list box i store every column of datagridview and in combobox I show every unique value if cells in this column(selecter in listbox)</p>\n\n<p>As you can see with simple data like <code>Id</code> there is no problem.\nHowever, when I click on LegalAddress, for example, it couldn't find values of this column.</p>\n\n<p>Moreover, I want allow user to filter data by property <code>Index</code> of Address, but i don't even know how.</p>\n\n<blockquote>\n  <p>So. Could you help me to get data for non-simple types.\n  Here code how i store data to combobox:</p>\n</blockquote>\n\n<pre><code>private void PopulateCombobox(object column)\n{\n    comboBox1.DataSource = null;\n    BindingSource data = dataGridView.DataSource as BindingSource;\n    DataGridViewColumn col = column as DataGridViewColumn;\n    ArrayList list = new ArrayList(data.Count);\n\n    // Retrieve each value and add it to the ArrayList if it isn't\n    // already present. \n    foreach (Object item in data)\n    {\n        Object value = null;\n\n        ICustomTypeDescriptor ictd = item as ICustomTypeDescriptor;\n        if (ictd != null)\n        {\n            PropertyDescriptorCollection properties = ictd.GetProperties();\n            foreach (PropertyDescriptor property in properties)\n            {\n                if (String.Compare(col.DataPropertyName,\n                        property.Name, true /*case insensitive*/,\n                        System.Globalization.CultureInfo.InvariantCulture) == 0)\n                {\n                    value = property.GetValue(item);\n                    break;\n                }\n            }\n        }\n        else\n        {\n            PropertyInfo[] properties = item.GetType().GetProperties(\n                BindingFlags.Public | BindingFlags.Instance);\n            foreach (PropertyInfo property in properties)\n            {\n                if (String.Compare(col.DataPropertyName,\n                        property.Name, true /*case insensitive*/,\n                        System.Globalization.CultureInfo.InvariantCulture) == 0)\n                {\n                    value = property.GetValue(item, null /*property index*/);\n                    break;\n                }\n            }\n        }\n\n        // Skip empty values, but note that they are present. \n        if (value == null || value == DBNull.Value)\n        {\n\n            continue;\n        }\n\n        // Add values to the ArrayList if they are not already there.\n        if (!list.Contains(value))\n        {\n            list.Add(value);\n        }\n    }\n    comboBox1.DataSource = list;\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "dynamic", "ironpython"], "comments": [{"owner": {"reputation": 15, "user_id": 6077907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fe88232689f106d3557248b72abb6b?s=128&d=identicon&r=PG&f=1", "display_name": "rr0711", "link": "https://stackoverflow.com/users/6077907/rr0711"}, "edited": false, "score": 0, "creation_date": 1521055192, "post_id": 49285408, "comment_id": 85574943, "body": "Thanks for the responses. Looks like I need to research and learn up on MVVM in order to do this."}], "answers": [{"tags": [], "owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "is_accepted": true, "score": 0, "last_activity_date": 1521053806, "creation_date": 1521053806, "answer_id": 49285737, "question_id": 49285408, "link": "https://stackoverflow.com/questions/49285408/wpf-how-to-dynamically-create-controls-and-edit-controls-in-code/49285737#49285737", "title": "WPF: How to dynamically create controls and edit controls in code", "body": "<p>WPF/UWP and XAML are designed with the MVVM pattern in mind. While you can use other approaches, doing so will miss about 90% of it's power and run into issues at every other corner.</p>\n\n<p>In MVVM this would be simply a mater of Exposing a Collection and having a Tempalte targetting that type. ListBoxes might even have a custom Template system, but using ListBoxes might no longer be nessesary - any container can expose a Collection.</p>\n\n<p>If you plan on learning MVVM, mid to longertem you should learn MVVM. I wrote a <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/b1a8bf14-4acd-4d77-9df8-bdb95b02dbe2/lets-talk-about-mvvm?forum=wpf\" rel=\"nofollow noreferrer\">short intro a few years back</a>, that should help you going. Help for people not following MVVM is parse on the Forum.</p>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 8715470, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dlyj0.jpg?s=128&g=1", "display_name": "Zarenor", "link": "https://stackoverflow.com/users/8715470/zarenor"}, "is_accepted": false, "score": 0, "last_activity_date": 1521053914, "creation_date": 1521053914, "answer_id": 49285758, "question_id": 49285408, "link": "https://stackoverflow.com/questions/49285408/wpf-how-to-dynamically-create-controls-and-edit-controls-in-code/49285758#49285758", "title": "WPF: How to dynamically create controls and edit controls in code", "body": "<p>In general, it's a violation of the MVVM principles WPF is built around to build a UI in this way. Instead, consider a solution similar to the one proposed in the answers to <a href=\"https://stackoverflow.com/questions/5650812/how-do-i-bind-a-tabcontrol-to-a-collection-of-viewmodels\">this question</a>. They do a good job of explaining both what to do, and <em>why</em> we do it this way.</p>\n"}], "owner": {"reputation": 15, "user_id": 6077907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47fe88232689f106d3557248b72abb6b?s=128&d=identicon&r=PG&f=1", "display_name": "rr0711", "link": "https://stackoverflow.com/users/6077907/rr0711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "accepted_answer_id": 49285737, "answer_count": 2, "score": 0, "last_activity_date": 1521053914, "creation_date": 1521052669, "question_id": 49285408, "link": "https://stackoverflow.com/questions/49285408/wpf-how-to-dynamically-create-controls-and-edit-controls-in-code", "title": "WPF: How to dynamically create controls and edit controls in code", "body": "<p>I have a xaml which contains a tab control (Name=\"MyTabControl\"). I'm a beginner with wpf and in code and I want to dynamically add tab items that I then add a list box to each created tab item. Below is the code I have so far.</p>\n\n<pre><code>ListBox listbox = new ListBox()\nTabItem tab = new TabItem()\ntab.AddChild(listbox)\n\nMyTabControl.Add(tab)\n</code></pre>\n\n<p>My issue is that I can't figure out how dynamically create new tabs that also would add a list box to each new tab and the new tabs then added to MyTabControl.\nThen, I would want to be able to access each list box control, individually, in each tab to edit the list box content.</p>\n\n<p>How is this done in code? How can i access the created list box controls to edit them?</p>\n"}, {"tags": ["c#", "visual-studio-2015"], "comments": [{"owner": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "edited": false, "score": 0, "creation_date": 1521052459, "post_id": 49285290, "comment_id": 85573480, "body": "you can take datasoruce and do it"}, {"owner": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "edited": false, "score": 0, "creation_date": 1521052544, "post_id": 49285290, "comment_id": 85573541, "body": "let me know what is datasoruce for your combo box ??, some code will be helpful"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9490735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQYebmMANBY/AAAAAAAAAAI/AAAAAAAAAAo/I_J1LvNOx3g/photo.jpg?sz=128", "display_name": "Abhishek Modak", "link": "https://stackoverflow.com/users/9490735/abhishek-modak"}, "edited": false, "score": 0, "creation_date": 1521163785, "post_id": 49285457, "comment_id": 85625528, "body": "The data source for my combo box is a database which stores information about paired Bluetooth devices. I am only extracting the device name and displaying it in the combo box as a list"}, {"owner": {"reputation": 394, "user_id": 6788920, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207045659435349/picture?type=large", "display_name": "Phil N DeBlanc", "link": "https://stackoverflow.com/users/6788920/phil-n-deblanc"}, "reply_to_user": {"reputation": 1, "user_id": 9490735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQYebmMANBY/AAAAAAAAAAI/AAAAAAAAAAo/I_J1LvNOx3g/photo.jpg?sz=128", "display_name": "Abhishek Modak", "link": "https://stackoverflow.com/users/9490735/abhishek-modak"}, "edited": false, "score": 0, "creation_date": 1521210785, "post_id": 49285457, "comment_id": 85647690, "body": "I changed the name of the list to make it more understandable."}], "tags": [], "owner": {"reputation": 394, "user_id": 6788920, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207045659435349/picture?type=large", "display_name": "Phil N DeBlanc", "link": "https://stackoverflow.com/users/6788920/phil-n-deblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1521210761, "last_edit_date": 1521210761, "creation_date": 1521052850, "answer_id": 49285457, "question_id": 49285290, "link": "https://stackoverflow.com/questions/49285290/how-to-compare-items-stored-in-a-combo-box-or-drop-down-list-and-a-list-in-visua/49285457#49285457", "title": "How to compare items stored in a combo box or drop down list and a list in visual studio?", "body": "<p>In C#, it would be something like this:</p>\n\n<pre><code>if (myAvailablePairedBTDevicesList.Contains(myComboBox.SelectedItem.ToString())\n    return true;\n</code></pre>\n\n<p>Assuming that both the list and the ComboBox are string types.</p>\n"}], "owner": {"reputation": 1, "user_id": 9490735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yQYebmMANBY/AAAAAAAAAAI/AAAAAAAAAAo/I_J1LvNOx3g/photo.jpg?sz=128", "display_name": "Abhishek Modak", "link": "https://stackoverflow.com/users/9490735/abhishek-modak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521210761, "creation_date": 1521052322, "question_id": 49285290, "link": "https://stackoverflow.com/questions/49285290/how-to-compare-items-stored-in-a-combo-box-or-drop-down-list-and-a-list-in-visua", "title": "How to compare items stored in a combo box or drop down list and a list in visual studio?", "body": "<p>I have created a combo box that stores names of Bluetooth devices and a list that stores names of available paired Bluetooth devices. Now I want to compare an item from combo box to all items stored in the list . Can anyone help me by specifying how can I do it programmatically?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1, "user_id": 2615257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814579d82d3bf040f3f07b82c1f20fd?s=128&d=identicon&r=PG", "display_name": "user2615257", "link": "https://stackoverflow.com/users/2615257/user2615257"}, "edited": false, "score": 0, "creation_date": 1521051910, "post_id": 49285149, "comment_id": 85573191, "body": "I am using the most current version of xamarin on both MAc and PC"}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521052060, "post_id": 49285149, "comment_id": 85573263, "body": "If this is your actual code:  System.Net.Http.HttpResponseMessage  respons<code>enter code here</code>e = await client.GetAsync(RestUrl); remove the &#39;enter code here&#39;"}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1521052182, "post_id": 49285149, "comment_id": 85573336, "body": "Please edit the question to include the full exception detail."}, {"owner": {"reputation": 1, "user_id": 2615257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814579d82d3bf040f3f07b82c1f20fd?s=128&d=identicon&r=PG", "display_name": "user2615257", "link": "https://stackoverflow.com/users/2615257/user2615257"}, "edited": false, "score": 0, "creation_date": 1521066357, "post_id": 49285149, "comment_id": 85580349, "body": "The full exception is: System.TypeLoadException: Failure has occurred while loading a type.I believe it&#39;s because of the Newtonsoft.Json dll that I&#39;m using."}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1521075419, "post_id": 49285149, "comment_id": 85582991, "body": "There will be much more detail than that."}], "owner": {"reputation": 1, "user_id": 2615257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814579d82d3bf040f3f07b82c1f20fd?s=128&d=identicon&r=PG", "display_name": "user2615257", "link": "https://stackoverflow.com/users/2615257/user2615257"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521052118, "creation_date": 1521051831, "last_edit_date": 1521052118, "question_id": 49285149, "link": "https://stackoverflow.com/questions/49285149/i-am-calling-a-restful-web-service-and-get-this-error-message-system-typeloadex", "title": "I am calling a restful web service and get this error message: System.TypeLoadException: Failure has occurred while loading a type", "body": "<p>I am calling a restful web service from ios application (ipad) and get this error message: System.TypeLoadException: Failure has occurred while loading a type. When it reached this line: System.Net.Http.HttpResponseMessage  response = await client.GetAsync(RestUrl). </p>\n\n<p>Here's the code:</p>\n\n<pre><code>public async Task&lt;DataTable&gt; GetSSRListAsync() \n{\n    DataTable dt = new DataTable();\n    var RestUrl = \"http://10.50.42.51:2018/SiteSafetyService.svc/GetSSRList\";\n    //var uri = new Uri(string.Format(Constants.RestUrl, string.Empty));\n    System.Net.Http.HttpResponseMessage  response = await client.GetAsync(RestUrl);\n\n    if (response.IsSuccessStatusCode)\n    {\n        var content = await response.Content.ReadAsStringAsync();\n        dt = Newtonsoft.Json.JsonConvert.DeserializeObject&lt;DataTable&gt;(content);\n    }\n    return dt;\n}\n</code></pre>\n"}, {"tags": ["c#", "xml", "windows", "readxml", "writexml"], "comments": [{"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521051927, "post_id": 49285117, "comment_id": 85573195, "body": "Something is already accessing the xml file, so that is why it&#39;s throwing that error."}, {"owner": {"reputation": 13, "user_id": 7389172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/393a62bf833d34a87c8b77a8e0cb6226?s=128&d=identicon&r=PG", "display_name": "The57thGamer", "link": "https://stackoverflow.com/users/7389172/the57thgamer"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521053943, "post_id": 49285117, "comment_id": 85574320, "body": "@RyanWilson That&#39;s what I figured. So I&#39;m assuming that my code is fine, some other application is using it. If that&#39;s the cause any tips on finding out what is accessing it?"}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521054040, "post_id": 49285117, "comment_id": 85574366, "body": "possible problem here:                                                                 dt.WriteXml(Filelocation, XmlWriteMode.WriteSchema);             FileInfo xm = new FileInfo(Filelocation);             xm.Attributes = FileAttributes.Hidden;                                                   you are trying to use FileInfo on the same file right after calling dt.WriteXML which is using the same file. Just a guess..."}, {"owner": {"reputation": 13, "user_id": 7389172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/393a62bf833d34a87c8b77a8e0cb6226?s=128&d=identicon&r=PG", "display_name": "The57thGamer", "link": "https://stackoverflow.com/users/7389172/the57thgamer"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521058609, "post_id": 49285117, "comment_id": 85576880, "body": "@RyanWilson Yes. I had that in there so the file can be set to hidden so the users won&#39;t accidentally delete it. I&#39;ll see if that changes anything if I remove that bit of code."}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521058753, "post_id": 49285117, "comment_id": 85576947, "body": "Ok. Like I said that was just a guess from looking at your example code."}, {"owner": {"reputation": 13, "user_id": 7389172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/393a62bf833d34a87c8b77a8e0cb6226?s=128&d=identicon&r=PG", "display_name": "The57thGamer", "link": "https://stackoverflow.com/users/7389172/the57thgamer"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521059399, "post_id": 49285117, "comment_id": 85577286, "body": "@RyanWilson Well this is interesting. After deleting the previous xml file and let the program write new one after deleting the attributes bit of the code, it&#39;s not sprouting an error. Maybe something in the FileInfo was messing with it? Either way, I think I might just have the xml be saved in a different folder like the appdata folder or similar. Not sure if that&#39;ll actually stop the error, but it&#39;s a start."}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1521115243, "post_id": 49285117, "comment_id": 85599508, "body": "Well I&#39;m glad you have made some head way. If there is anything else I can do to help, just shoot me a message."}], "owner": {"reputation": 13, "user_id": 7389172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/393a62bf833d34a87c8b77a8e0cb6226?s=128&d=identicon&r=PG", "display_name": "The57thGamer", "link": "https://stackoverflow.com/users/7389172/the57thgamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521051704, "creation_date": 1521051704, "question_id": 49285117, "link": "https://stackoverflow.com/questions/49285117/issues-on-saving-xml-file-after-loading-it-on-application-startup", "title": "Issues on saving XML file after loading it on application startup", "body": "<p>I have a tracking program that saves a hidden XML file during a save or auto save in case the user accidentally closes the program and needs to load it back up. It is imported into a dataset and data table.</p>\n\n<p>Here's the code for the WriteXML and ReadXML:</p>\n\n<p>WriteXML:</p>\n\n<pre><code> private void SaveloadFile()\n    {\n        string Timefor = Properties.Settings.Default.DateFormat;\n        System.Data.DataTable dt = (System.Data.DataTable)dataGridView1.DataSource;\n        string Filelocation = Properties.Settings.Default.SaveLocation.ToString() + \"_\" + System.DateTime.Today.ToString(Timefor) + \".xml\";\n        try\n        {\n            dt.WriteXml(Filelocation, XmlWriteMode.WriteSchema);\n            FileInfo xm = new FileInfo(Filelocation);\n            xm.Attributes = FileAttributes.Hidden;\n\n\n        }\n        catch(System.Exception err)\n        {\n            MessageBox.Show(\"Ah poop, Something went wrong\\n\" + err, \"Oh poop\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n        }\n    }\n</code></pre>\n\n<p>ReadXML:</p>\n\n<pre><code>        public void ReadXML(string Filepath)\n    {\n        try\n        {\n            dt.ReadXml(Filepath);\n            ds.Tables.Add(dt);\n\n            dataGridView1.DataSource = ds.Tables[0];\n\n        }\n        catch (System.Exception err)\n        {\n            MessageBox.Show(\"Ah poop, Something went wrong\\n\" + err, \"Oh poop\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n            CreateDataBase();\n        }\n    }\n</code></pre>\n\n<p>And it seems to work. Although after opening the application and trying to save current work, <a href=\"https://i.stack.imgur.com/GGX7I.png\" rel=\"nofollow noreferrer\">I get this.</a></p>\n\n<p>This only happens when I load the program and try to save.</p>\n\n<p>I've looked into the code and I think I boiled it down to the readxml not letting go after reading. Though I have some suspicions that the writexml isn't working right ether. </p>\n\n<p>I've looked around and I can't seem to find a solution to this bug. </p>\n\n<p>If anyone can tell me what's wrong with the code that'll be great!</p>\n"}, {"tags": ["c#", "json", "unity3d"], "comments": [{"owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 2, "creation_date": 1521051829, "post_id": 49285049, "comment_id": 85573144, "body": "you should take a look at brandonscript answer on <a href=\"https://stackoverflow.com/a/21121267/2748412\">this question</a> it explains alot."}, {"owner": {"reputation": 2488, "user_id": 7764329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0dbb5b33bbcd830553cc0b7b050abc8c?s=128&d=identicon&r=PG&f=1", "display_name": "Question3r", "link": "https://stackoverflow.com/users/7764329/question3r"}, "reply_to_user": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1521051947, "post_id": 49285049, "comment_id": 85573206, "body": "should this question get closed?"}, {"owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1521052494, "post_id": 49285049, "comment_id": 85573499, "body": "yes, it is a duplicate. As a note, you should maybe rethink the way you save things, you can avoid having this saved as null by making <code>personalBest</code> getting the value from an external list containing the id and time"}], "answers": [{"tags": [], "owner": {"reputation": 1074, "user_id": 9258246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EaISP.png?s=128&g=1", "display_name": "TJ Wolschon", "link": "https://stackoverflow.com/users/9258246/tj-wolschon"}, "is_accepted": true, "score": 2, "last_activity_date": 1521052872, "last_edit_date": 1521052872, "creation_date": 1521051613, "answer_id": 49285094, "question_id": 49285049, "link": "https://stackoverflow.com/questions/49285049/save-and-load-nullable-strings-in-json-files/49285094#49285094", "title": "save and load nullable strings in JSON files", "body": "<p>So in C# <code>string</code> is already a nullable type. You should be fine just using a normal <code>string</code> in place of <code>string?</code>. This means you can just set it to null by doing the following:</p>\n\n<pre><code>string myString = null;\n</code></pre>\n\n<p>If I'm completely misunderstanding your question, please let me know.</p>\n\n<p>For saving null in JSON, <a href=\"https://stackoverflow.com/a/21121267/2748412\">check here</a></p>\n"}, {"tags": [], "owner": {"reputation": 3673, "user_id": 7256853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7H077BfRVB0/AAAAAAAAAAI/AAAAAAAAAEA/3S1Dq2-H8GE/photo.jpg?sz=128", "display_name": "Galandil", "link": "https://stackoverflow.com/users/7256853/galandil"}, "is_accepted": false, "score": 1, "last_activity_date": 1521052692, "creation_date": 1521052692, "answer_id": 49285415, "question_id": 49285049, "link": "https://stackoverflow.com/questions/49285049/save-and-load-nullable-strings-in-json-files/49285415#49285415", "title": "save and load nullable strings in JSON files", "body": "<p>An important thing to understand regarding the <code>string</code> type is this:</p>\n\n<blockquote>\n  <p><code>string</code> is a reference type, thus nullable, and when a <code>string</code> field\n  is declared but not initialized it will have its value set to <code>\"\"</code> and\n  not <code>null</code>.</p>\n</blockquote>\n\n<p>I.e.:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public string myString;\nif (myString != null) {\n    Debug.Log(\"String is not null\");\n}\n</code></pre>\n\n<p>will print <code>String is not null</code> in the console.</p>\n\n<p>This is what throws some people off, since usually reference types when declared but not yet initialized have their value set to <code>null</code> by default.</p>\n\n<p>However, if you declare the variable with an autoproperty instead of a field, then it will behave as any other reference type, i.e. <code>null</code> by default.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public string myString {get;set;}\nif (myString == null) {\n    Debug.Log(\"String is null\");\n}\n</code></pre>\n\n<p>will print <code>String is null</code> in the console.</p>\n"}], "owner": {"reputation": 2488, "user_id": 7764329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0dbb5b33bbcd830553cc0b7b050abc8c?s=128&d=identicon&r=PG&f=1", "display_name": "Question3r", "link": "https://stackoverflow.com/users/7764329/question3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 49285094, "answer_count": 2, "score": 0, "last_activity_date": 1521052872, "creation_date": 1521051453, "question_id": 49285049, "link": "https://stackoverflow.com/questions/49285049/save-and-load-nullable-strings-in-json-files", "title": "save and load nullable strings in JSON files", "body": "<p>for my Unity game I created a JSON file that holds the speedrun times. The saved times are Timespan strings. When loading the data I parse the strings to Timespan values. When saving the time I save the Timespan as a string to the file.</p>\n\n<p>Example level in the JSON file:</p>\n\n<pre><code>{\n  \"id\": 1,\n  \"personalBest\": \"00:00:00.0001336\",\n  \"perfectTime\": \"00:00:00.0001335\",\n}\n</code></pre>\n\n<p>If a level is not passed yet I want the personalBest property having the value <code>null</code> instead of something like this</p>\n\n<p><strong>00:00:00.0000000</strong> </p>\n\n<p>or </p>\n\n<p><strong>99:99:99.9999999</strong></p>\n\n<p>In my serializable class I currently have this code</p>\n\n<pre><code>[Serializable]\npublic class Level\n{\n    public int id;\n    public string? personalBest; // this value could be null\n    public string perfectTime;\n}\n</code></pre>\n\n<p>But I get this error</p>\n\n<blockquote>\n  <p><strong>CS0453</strong> The type 'string' must be a non-nullable type in order to use\n  it as parameter T in the generic type or method 'System.Nullable'</p>\n</blockquote>\n\n<p>Is a workaround possible?</p>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 649, "user_id": 573075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/951e518663b261e3a849eebbeecc71a4?s=128&d=identicon&r=PG", "display_name": "CynicalSection", "link": "https://stackoverflow.com/users/573075/cynicalsection"}, "edited": false, "score": 1, "creation_date": 1521052443, "post_id": 49285040, "comment_id": 85573468, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1426050/how-to-display-default-text-select-team-in-combo-box-on-pageload-in-wpf\">How to display default text &quot;--Select Team --&quot; in combo box on pageload in WPF?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 1256136, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e5f996ed228e7ae4d85f7c6fed371683?s=128&d=identicon&r=PG", "display_name": "Pierce", "link": "https://stackoverflow.com/users/1256136/pierce"}, "is_accepted": false, "score": 0, "last_activity_date": 1521056945, "creation_date": 1521056945, "answer_id": 49286549, "question_id": 49285040, "link": "https://stackoverflow.com/questions/49285040/wpf-combobox-binding-placeholder-item/49286549#49286549", "title": "WPF combobox binding placeholder item", "body": "<p>Add the following to your XAML</p>\n\n<pre><code>IsEditable=\"True\"\nText=\"Add New\"\n</code></pre>\n\n<p><strong>Caution</strong>:  If the user selects one of the bound values, they cannot \"go back\" and select \"Add New\" as it will no longer appear.  Also, now that the control is editable, you will need to validate the content before you do any processing to avoid potential errors introduced by the user entering a bad value.</p>\n"}, {"tags": [], "owner": {"reputation": 406, "user_id": 5188233, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i0PuL.jpg?s=128&g=1", "display_name": "DTeuchert", "link": "https://stackoverflow.com/users/5188233/dteuchert"}, "is_accepted": false, "score": -1, "last_activity_date": 1521097270, "creation_date": 1521097270, "answer_id": 49293330, "question_id": 49285040, "link": "https://stackoverflow.com/questions/49285040/wpf-combobox-binding-placeholder-item/49293330#49293330", "title": "WPF combobox binding placeholder item", "body": "<p>HappyNomad gives in <a href=\"https://stackoverflow.com/a/4053371/5188233\">https://stackoverflow.com/a/4053371/5188233</a> a xaml-only solution by modifying the <code>Combobox.Template</code>. In this proposal you don't need to manipulate your sourcelist with fake items and keep them clean.</p>\n\n<pre><code>&lt;ComboBox ItemsSource=\"{Binding MyList}\" ... &gt;\n    &lt;ComboBox.Template&gt;\n        &lt;ControlTemplate TargetType=\"ComboBox\"&gt;\n            &lt;Grid&gt;\n                &lt;ComboBox x:Name=\"cbItems\" \n                    DataContext=\"{Binding RelativeSource={RelativeSource TemplatedParent}}\" \n                    ItemsSource=\"{Binding ItemsSource, RelativeSource={RelativeSource TemplatedParent}}\"\n                    SelectedValue =\"{Binding SelectedValue, RelativeSource={RelativeSource TemplatedParent}}\" \n                    /&gt;\n                &lt;TextBlock x:Name=\"tbItem\" Text=\"Add New\" IsHitTestVisible=\"False\" Visibility=\"Hidden\"/&gt;\n            &lt;/Grid&gt;\n            &lt;ControlTemplate.Triggers&gt;\n                &lt;Trigger SourceName=\"cbItems\" Property=\"SelectedItem\" Value=\"{x:Null}\"&gt;\n                    &lt;Setter TargetName=\"tbItem\" Property=\"Visibility\" Value=\"Visible\"/&gt;\n                &lt;/Trigger&gt;\n            &lt;/ControlTemplate.Triggers&gt;\n        &lt;/ControlTemplate&gt;\n    &lt;/ComboBox.Template&gt;\n&lt;/ComboBox&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9492699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f5e374ebab16bc0fde231e6b5d303fa?s=128&d=identicon&r=PG&f=1", "display_name": "brunelleschi", "link": "https://stackoverflow.com/users/9492699/brunelleschi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1133, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521097270, "creation_date": 1521051428, "question_id": 49285040, "link": "https://stackoverflow.com/questions/49285040/wpf-combobox-binding-placeholder-item", "title": "WPF combobox binding placeholder item", "body": "<p>I'm trying to add a \"fake\" item to my source list binded to a combobox.</p>\n\n<pre><code>&lt;Window ...\n        DataContext=\"{Binding Source={x:Static local:Singleton.Instance}}\"&gt;\n    ...\n        &lt;ComboBox ItemsSource=\"{Binding MyList}\"&gt;\n</code></pre>\n\n<p>--</p>\n\n<pre><code>public List&lt;Object&gt; MyList{ get; private set; }\n</code></pre>\n\n<p>I want to have a \"Add New\" as a combobox item that do not belong to MyList,\nsince I need to have only proper objects inside it.\nIf I try to add it programmatically an exception is raised since the source cannot be edit in such a way.</p>\n"}, {"tags": ["c#", ".net", "vb.net", "ms-access", "oledb"], "answers": [{"comments": [{"owner": {"reputation": 2847, "user_id": 1884992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d911a8edcdc81a0dee5ea7a677b8f4b?s=128&d=identicon&r=PG", "display_name": "Ciar&#225;n", "link": "https://stackoverflow.com/users/1884992/ciar%c3%a1n"}, "edited": false, "score": 1, "creation_date": 1521067093, "post_id": 49285444, "comment_id": 85580626, "body": "This is not correct"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1521075435, "post_id": 49285444, "comment_id": 85582999, "body": "This is <i>mostly</i> incorrect as all the dupe links indicate.  MS-Access does provide UI for administering, but that is not what the question asks and you dont often allow end users to fiddle with the app&#39;s data store, structure etc.  It <b>does not</b> supply the DLLs for connecting, that is all contained in NET.  However you sometimes have to install an Access Redistributable depending on the bitness of the OS versus your app."}], "tags": [], "owner": {"reputation": 104, "user_id": 6910695, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2e8deb11a8c3254c1342a056e9bca5fc?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Lukaszewski", "link": "https://stackoverflow.com/users/6910695/matthew-lukaszewski"}, "is_accepted": true, "score": 1, "last_activity_date": 1521143572, "last_edit_date": 1521143572, "creation_date": 1521052815, "answer_id": 49285444, "question_id": 49284987, "link": "https://stackoverflow.com/questions/49284987/portable-access-database-provider-for-net-connection/49285444#49285444", "title": "Portable Access Database Provider for .NET connection", "body": "<p>I have revised my previous answer as I now realise that it was incorrect and I apologise for that. It was my experience that it was impossible to access a .accdb database without MS Access installed.  Now I realise that if you have the access database engine installed than yes you can. However if this is not installed than no you can not have a working application that needs to interact with that type of database.</p>\n"}], "owner": {"reputation": 2024, "user_id": 3718031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/wfBC6.jpg?s=128&g=1", "display_name": "VBobCat", "link": "https://stackoverflow.com/users/3718031/vbobcat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "closed_date": 1521053578, "accepted_answer_id": 49285444, "answer_count": 1, "score": -1, "last_activity_date": 1521143572, "creation_date": 1521051204, "last_edit_date": 1521056445, "question_id": 49284987, "link": "https://stackoverflow.com/questions/49284987/portable-access-database-provider-for-net-connection", "closed_reason": "Duplicate", "title": "Portable Access Database Provider for .NET connection", "body": "<p>Is it possible to connect to an Access Database (*.accdb) from within .NET application without having MS Access (not even redistributable engine) installed, but just packing ACEOLEDB.dll along application files?</p>\n"}, {"tags": ["c#", "arrays", "sql-server", "executenonquery"], "comments": [{"owner": {"reputation": 411, "user_id": 6835862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UhjggAjFsDI/AAAAAAAAAAI/AAAAAAAAAmE/HkXWNlp-k3c/photo.jpg?sz=128", "display_name": "elhs16", "link": "https://stackoverflow.com/users/6835862/elhs16"}, "edited": false, "score": 2, "creation_date": 1521051250, "post_id": 49284973, "comment_id": 85572848, "body": "Try making the primary key auto increment, you wont have to worry about adding them or duplicate keys anymore as the next number will be used automatically"}, {"owner": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "edited": false, "score": 2, "creation_date": 1521051415, "post_id": 49284973, "comment_id": 85572932, "body": "you are using y and doing i++, how that is going to work, or its typo....i think it should be y++"}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "reply_to_user": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "edited": false, "score": 0, "creation_date": 1521051508, "post_id": 49284973, "comment_id": 85572973, "body": "@PranayRana has nailed it. You&#39;re not incrementing the right variable, so you are adding the same record in the array a second time, necessarily causing the index violation - and at precisely the location that would cause the error with the value you are observing. Great catch, pranay!"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9159074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/16d1a48611019a91202c77f2f0c64f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Bleari", "link": "https://stackoverflow.com/users/9159074/bleari"}, "edited": false, "score": 0, "creation_date": 1521052075, "post_id": 49285098, "comment_id": 85573272, "body": "Have to wait a couple of minutes then of course if will!"}, {"owner": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "reply_to_user": {"reputation": 113, "user_id": 9159074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/16d1a48611019a91202c77f2f0c64f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Bleari", "link": "https://stackoverflow.com/users/9159074/bleari"}, "edited": false, "score": 0, "creation_date": 1521052348, "post_id": 49285098, "comment_id": 85573423, "body": "@Bleari - i know my bad"}], "tags": [], "owner": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "is_accepted": true, "score": 2, "last_activity_date": 1521052182, "last_edit_date": 1521052182, "creation_date": 1521051628, "answer_id": 49285098, "question_id": 49284973, "link": "https://stackoverflow.com/questions/49284973/sql-error-when-adding-primary-key/49285098#49285098", "title": "SQL Error when adding primary key", "body": "<p>In your code you need to increment value of <code>y</code> not <code>i</code>, as you are using <code>y</code> as index value.</p>\n\n<p>I suggest you make use of <code>for</code> loop will reduce complexity of your code </p>\n\n<pre><code>for(int i=0;i&lt;=5;i++) {\n if(string.IsNullOrWhiteSpace(ArrayCourseName[i] ))\n   break;\n ///rest of the code\n using (SqlConnection connection3 = new SqlConnection(conString3))\n {\n    connection3.Open();\n    // code for sql non execute \n }\n}\n</code></pre>\n\n<p>i suggest you make use of <code>using</code> connection and create connection object every time , because connection pooling will take care of pooling connection object every time. </p>\n\n<p>Ref : <a href=\"https://stackoverflow.com/questions/5981376/is-it-better-to-execute-many-sql-commands-with-one-connection-or-reconnect-ever\">Is it better to execute many sql commands with one connection, or reconnect every time?</a></p>\n"}], "owner": {"reputation": 113, "user_id": 9159074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/16d1a48611019a91202c77f2f0c64f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Bleari", "link": "https://stackoverflow.com/users/9159074/bleari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 49285098, "answer_count": 1, "score": 1, "last_activity_date": 1521055897, "creation_date": 1521051138, "last_edit_date": 1521055897, "question_id": 49284973, "link": "https://stackoverflow.com/questions/49284973/sql-error-when-adding-primary-key", "title": "SQL Error when adding primary key", "body": "<p>When I attempt to add a new record and hence add a primary key, I get an error: </p>\n\n<blockquote>\n  <p>System.Data.SqlClient.SqlException occurred<br>\n  HResult=0x80131904<br>\n  Message=Violation of PRIMARY KEY constraint 'PK__Stock__BEAEB27A2652D17F'. Cannot insert duplicate key in object 'dbo.Stock'. The duplicate key value is (39).</p>\n</blockquote>\n\n<p>I am sure that the total number of records currently is 38. The primary keys are added from an array which all have numbers from 39-44.</p>\n\n<p>I have attached the code below:</p>\n\n<pre><code>int y = 0;\n\nSqlCommand orderCommand3 = new SqlCommand();\n\nstring conString3 = Properties.Settings.Default.DatabaseEventsUnlimitedConnectionString;\n\nusing (SqlConnection connection3 = new SqlConnection(conString3))\n{\n    connection3.Open();\n\n    while (ArrayCourseName[y] != \"\" &amp;&amp; y &lt;=5)\n    {\n        SqlCommand commandEvent = new SqlCommand(\"INSERT INTO STOCK (IngredientID, IngredientName, StorageType, QuantityInStock, MinimumRequired) VALUES (@p1, @p2, @p3, @p4, @p5)\", connection3);\n\n        commandEvent.Parameters.AddWithValue(\"@p1\", ArrayIngredientID[y]);\n        commandEvent.Parameters.AddWithValue(\"@p2\", ArrayCourseName[y]);\n        commandEvent.Parameters.AddWithValue(\"@p3\", ArrayStorage[y]);\n        commandEvent.Parameters.AddWithValue(\"@p4\", ArrayQuantity[y]);\n        commandEvent.Parameters.AddWithValue(\"@p5\", ArrayMinimum[y]);\n\n        int m = commandEvent.ExecuteNonQuery();\n\n        if (m != 1)\n        {\n            throw new Exception(\"Too many records changed\");\n        }\n\n        i++;\n    }\n\n    connection3.Close();\n}\n</code></pre>\n"}, {"tags": ["c#", "obfuscation", "confuserex"], "comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521051124, "post_id": 49284909, "comment_id": 85572772, "body": "<a href=\"https://github.com/yck1509/ConfuserEx/issues/624\" rel=\"nofollow noreferrer\">github.com/yck1509/ConfuserEx/issues/624</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9493290"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1521051450, "post_id": 49284909, "comment_id": 85572944, "body": "@maccettura in my case even disabling the windows defender real time protection run fast, so the issue maybe is not related to the watermark"}, {"owner": {"reputation": 503, "user_id": 1791406, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cd8f3df91fa34a349c0cbd0743d2bfa4?s=128&d=identicon&r=PG", "display_name": "Zeeshanef", "link": "https://stackoverflow.com/users/1791406/zeeshanef"}, "edited": false, "score": 0, "creation_date": 1610872122, "post_id": 49284909, "comment_id": 116264911, "body": "@user9493290 I am sure your issue was not related to Windows Defender. Did you ever resolved the issue? As I am facing same issue."}], "owner": {"user_type": "does_not_exist", "display_name": "user9493290"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521050921, "creation_date": 1521050921, "question_id": 49284909, "link": "https://stackoverflow.com/questions/49284909/obfuscated-application-run-slow", "title": "Obfuscated application run slow", "body": "<p>I'm using ConfuserEX for obfuscate my application. Actually I'm using the maximum preset and the compress functionality to add 4 dlls to my exe.\nWhen I start the app without obfuscation run very fast, but after the obfuscation the start is very slow.\nWhy happen this? How can I fix this?</p>\n"}, {"tags": ["c#", "asp.net", "gridview"], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521249257, "post_id": 49288310, "comment_id": 85665078, "body": "Thanks. :) Unfortunately, the code change didn&#39;t work, and the link you provided has the following instruction &quot;If you are binding your gridview on page load then you must have to put check on page post back. So if page is not post back then bind grid only. That may be the case as well. &quot; --- I don&#39;t know how to do that when the gridview is bound to an sqldatasource control within the aspx page itself, not in the PageLoad code. Any instructions?"}, {"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521488365, "post_id": 49288310, "comment_id": 85743113, "body": "I&#39;ve added the Page_Load code. I&#39;ve tried updating the code rows to use (Gridview)sender, but it hasn&#39;t made a difference. Any other suggestions?"}, {"owner": {"reputation": 90, "user_id": 8677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qvx4f.jpg?s=128&g=1", "display_name": "erickpa", "link": "https://stackoverflow.com/users/8677510/erickpa"}, "reply_to_user": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521551758, "post_id": 49288310, "comment_id": 85771250, "body": "Sorry for the delay, I&#39;m trying to do some testing to reproduce the problem. I think the problem is in one of two methods: CreateChildControls or EnsureChildControls."}, {"owner": {"reputation": 90, "user_id": 8677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qvx4f.jpg?s=128&g=1", "display_name": "erickpa", "link": "https://stackoverflow.com/users/8677510/erickpa"}, "reply_to_user": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521568995, "post_id": 49288310, "comment_id": 85783979, "body": "Try to add &quot;gvPhones.DataBind();&quot; inside the (!IsPostBack) block."}, {"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521572261, "post_id": 49288310, "comment_id": 85785878, "body": "Many thanks for your help. :) Re: your second comment: that&#39;s where it was originally (just before the &quot;gvPhones.Sort&quot; line), but I moved it yesterday because I thought it might help (didn&#39;t make a difference). Q: some of the stuff in the Sort command is outdated... could that be related?"}, {"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521573251, "post_id": 49288310, "comment_id": 85786404, "body": "Update: I&#39;ve put the &quot;gvPhones.DataBind();&quot; command back where it used to be, and also commented out the &quot;gvPhones.Sort&quot; command. No change."}, {"owner": {"reputation": 90, "user_id": 8677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qvx4f.jpg?s=128&g=1", "display_name": "erickpa", "link": "https://stackoverflow.com/users/8677510/erickpa"}, "reply_to_user": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521665175, "post_id": 49288310, "comment_id": 85834213, "body": "Hi, try following the suggested step-by-step on this link to use the gridview footer to insert the records: <a href=\"http://www.dotnetfunda.com/articles/show/2741/working-with-footer-template-in-gridview\" rel=\"nofollow noreferrer\">dotnetfunda.com/articles/show/2741/&hellip;</a>"}, {"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521736826, "post_id": 49288310, "comment_id": 85869912, "body": "Thanks again. :) Ok, I&#39;ve rewritten the code to use a standard gridview and a datasource that&#39;s set in the cs page, as it&#39;s done in those instructions. The result is that the add functionality now works, but the edit/update/delete/cancel functionalities are now completely broken. I&#39;d really like to keep using the gridviewextended class instead, as it simplifies the code a great deal, and I&#39;m hoping maybe this news helps with troubleshooting?"}, {"owner": {"reputation": 90, "user_id": 8677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qvx4f.jpg?s=128&g=1", "display_name": "erickpa", "link": "https://stackoverflow.com/users/8677510/erickpa"}, "reply_to_user": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1521825777, "post_id": 49288310, "comment_id": 85913329, "body": "I think I&#39;ve found a solution.  Remove your &quot;public override GridViewRow FooterRow&quot; in GridViewExtended.cs  Leave only the &quot;private GridViewRow _footerRow;&quot;  I did a test here simulating the gridview with its extension and it worked correctly."}, {"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1522194447, "post_id": 49288310, "comment_id": 86053969, "body": "Sorry about the delay in responding. Thanks for this. It worked... almost. Basically, it reversed the problem. Now the error doesn&#39;t happen if there are existing rows in the Gridview, but it does happen if this is the first row to be added (the entire point of GridViewExtended is to allow adding via the footer row even when there are no existing rows). I&#39;m beginning to think the best option is to scrap the existing class and make one that just hides a row that I manually create via UNION SELECT, so there&#39;s just always at least one row."}, {"owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1522259056, "post_id": 49288310, "comment_id": 86089236, "body": "Thank you for all of your help. Sorry I didn&#39;t upvote you before (I have now :) ). FYI, I&#39;ve decided that maybe it&#39;s better to go with the &quot;always have at least one row in the gridview and then just hide the extra row&quot; route, to make sure there&#39;s always a footer row, and scrap this entire class. I would still like to have a class that does the hiding automatically, and I&#39;ve asked that question here: <a href=\"https://stackoverflow.com/questions/49524212/c-sharp-gridview-want-to-create-an-extended-gridview-class-that-automatically-h\" title=\"c sharp gridview want to create an extended gridview class that automatically h\">stackoverflow.com/questions/49524212/&hellip;</a>"}, {"owner": {"reputation": 90, "user_id": 8677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qvx4f.jpg?s=128&g=1", "display_name": "erickpa", "link": "https://stackoverflow.com/users/8677510/erickpa"}, "reply_to_user": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1522263279, "post_id": 49288310, "comment_id": 86091709, "body": "I appreciate it :). I&#39;ll try to help you with this problem."}, {"owner": {"reputation": 90, "user_id": 8677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qvx4f.jpg?s=128&g=1", "display_name": "erickpa", "link": "https://stackoverflow.com/users/8677510/erickpa"}, "reply_to_user": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "edited": false, "score": 0, "creation_date": 1522270175, "post_id": 49288310, "comment_id": 86095518, "body": "I made some changes in the code and it now ran in both scenarios. I updated my answer with the changes, please do a test and check if it is working now."}], "tags": [], "owner": {"reputation": 90, "user_id": 8677510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qvx4f.jpg?s=128&g=1", "display_name": "erickpa", "link": "https://stackoverflow.com/users/8677510/erickpa"}, "is_accepted": false, "score": 1, "last_activity_date": 1522270151, "last_edit_date": 1522270151, "creation_date": 1521064827, "answer_id": 49288310, "question_id": 49284797, "link": "https://stackoverflow.com/questions/49284797/bizarre-issue-with-customized-gridview-control/49288310#49288310", "title": "Bizarre issue with customized gridview control", "body": "<p>Try using the sender in your code as below:</p>\n\n<p>Replace this line:</p>\n\n<pre><code>DropDownList PhoneTypeID = (DropDownList)gvPhones.FooterRow.FindControl(\"cboPhoneTypeID\");\n</code></pre>\n\n<p>For this:</p>\n\n<pre><code>DropDownList PhoneTypeID = (DropDownList)((GridView)sender).FooterRow.FindControl(\"cboPhoneTypeID\");\n</code></pre>\n\n<p>Also, check the page load if the problem is not with the postback.</p>\n\n<p>My answer is based on this question:\n<a href=\"https://stackoverflow.com/questions/33029737/unable-to-get-gridview-footer-values-in-rowcommand\">Unable to get gridview footer values in RowCommand</a></p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Change your GridViewExtended class,</p>\n\n<p><strong>ShowFooterWhenEmpty property:</strong></p>\n\n<pre><code>    [Category(\"Behavior\")]\n    [Themeable(true)]\n    [Bindable(BindableSupport.No)]\n    public bool ShowFooterWhenEmpty\n    {\n        get\n        {\n            if (this.ViewState[\"ShowFooterWhenEmpty\"] == null)\n            {\n                this.ViewState[\"ShowFooterWhenEmpty\"] = false;\n            }\n\n            return (bool)this.ViewState[\"ShowFooterWhenEmpty\"];\n        }\n        set\n        {\n            this.ViewState[\"ShowFooterWhenEmpty\"] = value;\n        }\n    }\n</code></pre>\n\n<p><strong>GridViewRow</strong>:</p>\n\n<pre><code>    private GridViewRow _footerRow;\n    public override GridViewRow FooterRow\n    {\n        get\n        {\n            GridViewRow f = base.FooterRow;\n            if (f != null)\n                return f;\n            else\n                return _footerRow;\n        }\n    }\n</code></pre>\n\n<p>I based my changes on this link:\n<a href=\"https://stackoverflow.com/questions/994895/always-show-footertemplate-even-no-data/10891744#10891744\">Always show FooterTemplate, even no data</a></p>\n"}, {"tags": [], "owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "is_accepted": true, "score": 0, "last_activity_date": 1522862665, "creation_date": 1522862665, "answer_id": 49656946, "question_id": 49284797, "link": "https://stackoverflow.com/questions/49284797/bizarre-issue-with-customized-gridview-control/49656946#49656946", "title": "Bizarre issue with customized gridview control", "body": "<p>I wound up scrapping this entire class. Instead, I made regular asp:gridviews that are based on datasources that have union selects with one row with -1 in the key column (since all of my tables have single autoincrement PKs, no row will legitimately have -1 in the key column), and then put the following in RowDataBound:</p>\n\n<pre><code>if (e.Row.RowType == DataControlRowType.DataRow)\n{\n    DataRowView rowView = (DataRowView)e.Row.DataItem;\n    string sKeyName = gvPhones.DataKeyNames[0].ToString();\n    if ((rowView[sKeyName].ToString() == \"-1\"))\n        e.Row.Visible = false;\n    else\n        e.Row.Visible = true;\n    rowView = null;\n}\n</code></pre>\n\n<p>This hides any row with -1 in the key column. So there's always at least one row in the gridview (even if that one row is hidden), and the footer row always shows.</p>\n"}], "owner": {"reputation": 421, "user_id": 9493203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6FCFL.jpg?s=128&g=1", "display_name": "Katerine459", "link": "https://stackoverflow.com/users/9493203/katerine459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 49656946, "answer_count": 2, "score": 1, "last_activity_date": 1522862665, "creation_date": 1521050533, "last_edit_date": 1521491642, "question_id": 49284797, "link": "https://stackoverflow.com/questions/49284797/bizarre-issue-with-customized-gridview-control", "title": "Bizarre issue with customized gridview control", "body": "<p>I have what may be a rather complicated issue. I have an extended gridview control that I swear used to work all the time, but I went away for a while, came back, and it doesn't work anymore (I'm the sole programmer).</p>\n\n<p>The extended gridview is designed so that it always shows a footer row (for inserting new rows). It loads and displays existing data correctly. If there are no rows, then adding the data works fine. But if I'm adding a new row to a gridview that already has existing rows, I get an issue where gvPhones.FooterRow is null, so it can't find the control I'm referencing.</p>\n\n<p>Here's the extended gridview class (gotten from a stackoverflow page):</p>\n\n<pre><code>using System.Linq;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.ComponentModel;\n\n//https://stackoverflow.com/questions/994895/always-show-footertemplate-even-no-data/10891744#10891744\nnamespace WebForms.LocalCodeLibrary.Controls\n{\n//modified from https://stackoverflow.com/questions/3437581/show-gridview-footer-on-empty-grid\npublic class GridViewExtended : GridView\n{\n\n    private GridViewRow _footerRow;\n    [DefaultValue(false), Category(\"Appearance\"), Description(\"Include the footer when the table is empty\")]\n    public bool ShowFooterWhenEmpty { get; set; }\n\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden), Browsable(false)]\n    public override GridViewRow FooterRow\n    {\n        get\n        {\n            if ((this._footerRow == null))\n            {\n                this.EnsureChildControls();\n            }\n            return this._footerRow;\n        }\n    }\n\n    protected override int CreateChildControls(System.Collections.IEnumerable dataSource, bool dataBinding)\n    {\n        //creates all the rows that would normally be created when instantiating the grid\n        int returnVal = base.CreateChildControls(dataSource, dataBinding);\n        //if no rows were created (i.e. returnVal == 0), and we need to show the footer row, then we need to create and bind the footer row.\n        if (returnVal == 0 &amp;&amp; this.ShowFooterWhenEmpty)\n        {\n            Table table = this.Controls.OfType&lt;Table&gt;().First&lt;Table&gt;();\n            DataControlField[] dcf = new DataControlField[this.Columns.Count];\n            this.Columns.CopyTo(dcf, 0);\n            //creates the footer row\n            this._footerRow = this.CreateRow(-1, -1, DataControlRowType.Footer, DataControlRowState.Normal, dataBinding, null, dcf, table.Rows, null);\n            if (!this.ShowFooter)\n            {\n                _footerRow.Visible = false;\n            }\n        }\n        return returnVal;\n    }\n\n    private GridViewRow CreateRow(int rowIndex, int dataSourceIndex, DataControlRowType rowType, DataControlRowState rowState, bool dataBind, object dataItem, DataControlField[] fields, TableRowCollection rows, PagedDataSource pagedDataSource)\n    {\n        GridViewRow row = this.CreateRow(rowIndex, dataSourceIndex, rowType, rowState);\n        GridViewRowEventArgs e = new GridViewRowEventArgs(row);\n        if ((rowType != DataControlRowType.Pager))\n        {\n            this.InitializeRow(row, fields);\n        }\n        else\n        {\n            this.InitializePager(row, fields.Length, pagedDataSource);\n        }\n        //if the row has data, sets the data item\n        if (dataBind)\n        {\n            row.DataItem = dataItem;\n        }\n        //Raises the RowCreated event\n        this.OnRowCreated(e);\n        //adds the row to the gridview's row collection\n        rows.Add(row);\n        //explicitly binds the data item to the row, including the footer row and raises the RowDataBound event.\n        if (dataBind)\n        {\n            row.DataBind();\n            this.OnRowDataBound(e);\n            row.DataItem = null;\n        }\n        return row;\n    }\n\n}\n\n}\n</code></pre>\n\n<p>Here's the relevant stuff in the ASPX page:</p>\n\n<pre><code>&lt;%@ Page Title=\"\" Language=\"C#\" MasterPageFile=\"~/Site.Master\" AutoEventWireup=\"true\" CodeBehind=\"ContactEdit.aspx.cs\" Inherits=\"WebForms.Directory.ContactEdit\" %&gt;\n&lt;%@ Register TagPrefix=\"gcctl\" Namespace=\"WebForms.LocalCodeLibrary.Controls\" Assembly=\"WebForms\" %&gt;\n&lt;asp:Content ID=\"Content1\" ContentPlaceHolderID=\"Head\" runat=\"server\"&gt;\n    &lt;style&gt;\n    &lt;/style&gt;\n&lt;/asp:Content&gt;\n&lt;asp:Content ID=\"Content2\" ContentPlaceHolderID=\"MainContent\" runat=\"server\"&gt;\n&lt;div id=\"bodycontent\" class=\"body-content\"&gt;\n    &lt;h2&gt;&lt;asp:Literal ID=\"formheader\" runat=\"server\" /&gt;&lt;/h2&gt;\n\n    &lt;!-- Start: Main Customer section --&gt;\n    &lt;asp:Panel ID=\"mainformcontent\" runat=\"server\" CssClass=\"formsection\"&gt;\n        &lt;section id=\"mainform\" class=\"simplelayoutform\"&gt;\n            &lt;asp:TextBox id=\"customerid\" type=\"hidden\" runat=\"server\" /&gt;\n            &lt;asp:TextBox id=\"contactid\" type=\"hidden\" runat=\"server\" /&gt;\n        &lt;/section&gt;\n    &lt;/asp:Panel&gt;\n    &lt;!-- End: Main Customer section --&gt;\n\n    &lt;!-- Start: Phones section --&gt;\n    &lt;asp:SqlDataSource ID=\"gvPhonesDataSource\" runat=\"server\" OnInserted=\"gvPhonesDataSource_Inserted\"\n        ConnectionString=\"&lt;%$ ConnectionStrings:ConnString %&gt;\" \n        SelectCommand=\"SELECT p.[CustomerPhoneID]\n                    ,p.[CustomerID]\n                    ,LTRIM(COALESCE(cc.FirstName,'') + ' ' + COALESCE(cc.LastName,'')) AS ContactFullName\n                    ,p.CustomerContactID\n                    ,p.PhoneTypeID\n                    ,lp.PhoneType\n                    ,p.[PhoneNumber]\n                    ,p.[Extension]\n                    ,p.[FormattedPhone]\n                    ,p.[IsActive]\n                    ,CASE WHEN p.LocationID IS NULL THEN CASE WHEN p.CustomerContactID IS NULL THEN 0 ELSE 1 END ELSE 2 END AS SortOrder\n                FROM [dbo].[Phones] p\n                LEFT JOIN dbo.Contacts cc ON p.CustomerContactID = cc.CustomerContactID\n                LEFT JOIN list.PhoneTypes lp ON p.PhoneTypeID = lp.PhoneTypeID\n                WHERE p.CustomerContactID = @CustomerContactID\"\n        DeleteCommand=\"DELETE FROM [dbo].[Phones] WHERE [CustomerPhoneID] = @CustomerPhoneID\" \n        InsertCommand=\"INSERT INTO [dbo].[Phones] ([CustomerID]\n                    , [CustomerContactID]\n                    , [PhoneNumber]\n                    , [Extension]\n                    , [PhoneTypeID]\n                    , LastModifiedByStaffID) \n                VALUES (@CustomerID\n                    , @CustomerContactID\n                    , CASE WHEN COALESCE(@FormattedPhone, '')='' THEN NULL ELSE LTRIM(RTRIM(LEFT(dbo.RemoveNonNumeric(@FormattedPhone),10))) END\n                    , CASE WHEN COALESCE(@FormattedPhone, '')='' THEN NULL ELSE CASE WHEN LTRIM(RTRIM(SUBSTRING(dbo.RemoveNonNumeric(@FormattedPhone),11,1000))) = '' THEN NULL ELSE LTRIM(RTRIM(SUBSTRING(dbo.RemoveNonNumeric(@FormattedPhone),11,1000))) END END\n                    , @PhoneTypeID\n                    , @StaffID)\" \n        UpdateCommand=\"UPDATE [dbo].[CustomerPhones] \n                    SET [CustomerContactID] = @CustomerContactID\n                    , [PhoneNumber] = CASE WHEN COALESCE(@FormattedPhone, '')='' THEN NULL ELSE LTRIM(RTRIM(LEFT(dbo.RemoveNonNumeric(@FormattedPhone),10))) END\n                    , [Extension] = CASE WHEN COALESCE(@FormattedPhone, '')='' THEN NULL ELSE CASE WHEN LTRIM(RTRIM(SUBSTRING(dbo.RemoveNonNumeric(@FormattedPhone),11,1000))) = '' THEN NULL ELSE LTRIM(RTRIM(SUBSTRING(dbo.RemoveNonNumeric(@FormattedPhone),11,1000))) END END\n                    , [PhoneTypeID] = @PhoneTypeID\n                    , [IsActive] = @IsActive\n                    , [DateModified] = getdate()\n                    , [LastModifiedByStaffID] = @StaffID\n                WHERE [CustomerPhoneID] = @CustomerPhoneID\"&gt;\n        &lt;SelectParameters&gt;\n            &lt;asp:ControlParameter Name=\"CustomerContactID\" Type=\"Int32\" ControlID=\"contactid\" PropertyName=\"Text\" /&gt;\n        &lt;/SelectParameters&gt;\n        &lt;DeleteParameters&gt;\n            &lt;asp:Parameter Name=\"CustomerPhoneID\" Type=\"Int32\" /&gt;\n        &lt;/DeleteParameters&gt;\n        &lt;UpdateParameters&gt;\n            &lt;asp:ControlParameter Name=\"CustomerContactID\" Type=\"Int32\" ControlID=\"contactid\" PropertyName=\"Text\" /&gt;\n            &lt;asp:Parameter Name=\"FormattedPhone\" Type=\"String\" /&gt;\n            &lt;asp:Parameter Name=\"PhoneTypeID\" Type=\"Int32\" /&gt;\n            &lt;asp:Parameter Name=\"IsActive\" Type=\"Boolean\" /&gt;\n            &lt;asp:SessionParameter Name=\"StaffID\" Type=\"Int32\" SessionField=\"StaffID\" /&gt;\n            &lt;asp:Parameter Name=\"CustomerPhoneID\" Type=\"Int32\" /&gt;\n        &lt;/UpdateParameters&gt;\n        &lt;InsertParameters&gt;\n            &lt;asp:ControlParameter Name=\"CustomerID\" Type=\"Int32\" ControlID=\"customerid\" PropertyName=\"Text\" /&gt;\n            &lt;asp:ControlParameter Name=\"CustomerContactID\" Type=\"Int32\" ControlID=\"contactid\" PropertyName=\"Text\" /&gt;\n            &lt;asp:Parameter Name=\"PhoneTypeID\" Type=\"Int32\" /&gt;\n            &lt;asp:Parameter Name=\"FormattedPhone\" Type=\"String\" /&gt;\n            &lt;asp:SessionParameter Name=\"StaffID\" Type=\"Int32\" SessionField=\"StaffID\" /&gt;\n        &lt;/InsertParameters&gt;\n    &lt;/asp:SqlDataSource&gt;\n\n    &lt;asp:Panel ID=\"phonesformcontent\" runat=\"server\" CssClass=\"formsection separate\"&gt;\n        &lt;section id=\"phonesform\" class=\"simplelayoutform\"&gt;\n            &lt;h3&gt;All Phones&lt;/h3&gt;\n            &lt;gcctl:MyCheckBox ID=\"chkPhoneShowInactive\" Text=\"Show Inactive?\" Checked=\"false\" AutoPostBack=\"true\" OnCheckedChanged=\"chkPhoneShowInactive_CheckedChanged\" runat=\"server\" /&gt;\n            &lt;asp:label id=\"lblPhoneMessage\" CssClass=\"responsemsg\" runat=\"server\" enableviewstate=\"False\" /&gt;\n            &lt;gcctl:gridviewextended ID=\"gvPhones\" runat=\"server\" DataSourceID=\"gvPhonesDataSource\"\n                AutoGenerateColumns=\"False\" DataKeyNames=\"CustomerPhoneID\" EmptyDataText=\"No phones on record.\"\n                CssClass=\"searchresultsgrid\" ShowFooter=\"True\" OnRowCommand=\"gvPhones_RowCommand\" AllowSorting=\"True\"\n                ShowFooterWhenEmpty=\"true\" OnRowDataBound=\"gvPhones_RowDataBound\"&gt;\n                &lt;Columns&gt;\n                    &lt;asp:BoundField DataField=\"CustomerPhoneID\" InsertVisible=\"false\" ReadOnly=\"true\" Visible=\"False\" /&gt;\n\n                    &lt;asp:TemplateField HeaderText=\"Phone Type\" SortExpression=\"PhoneType\"&gt;\n                        &lt;FooterTemplate&gt;\n                            &lt;asp:DropDownList ID=\"cboPhoneTypeID\" runat=\"server\"\n                                DataSourceID=\"DataSourcePhoneTypes\" DataTextField=\"PhoneType\" DataValueField=\"PhoneTypeID\"\n                                SelectedValue='&lt;%# Bind(\"PhoneTypeID\") %&gt;'&gt;\n                            &lt;/asp:DropDownList&gt;\n                        &lt;/FooterTemplate&gt;\n                        &lt;EditItemTemplate&gt;\n                            &lt;asp:DropDownList ID=\"cboPhoneTypeID\" runat=\"server\"\n                                DataSourceID=\"DataSourcePhoneTypes\" DataTextField=\"PhoneType\" DataValueField=\"PhoneTypeID\"\n                                SelectedValue='&lt;%# Bind(\"PhoneTypeID\") %&gt;'&gt;\n                            &lt;/asp:DropDownList&gt;\n                        &lt;/EditItemTemplate&gt;\n                        &lt;ItemTemplate&gt;\n                            &lt;asp:Label ID=\"lblPhoneTypeID\" runat=\"server\" Text='&lt;%# Bind(\"PhoneType\") %&gt;'&gt;&lt;/asp:Label&gt;\n                        &lt;/ItemTemplate&gt;\n                    &lt;/asp:TemplateField&gt;\n                    &lt;asp:TemplateField HeaderText=\"Phone\" SortExpression=\"PhoneNumber\"&gt;\n                        &lt;FooterTemplate&gt;\n                            &lt;asp:TextBox runat=\"server\" Text='&lt;%# Bind(\"FormattedPhone\") %&gt;' ID=\"txtPhone\"&gt;&lt;/asp:TextBox&gt;\n                        &lt;/FooterTemplate&gt;\n                        &lt;EditItemTemplate&gt;\n                            &lt;asp:TextBox runat=\"server\" Text='&lt;%# Bind(\"FormattedPhone\") %&gt;' ID=\"txtPhone\"&gt;&lt;/asp:TextBox&gt;\n                        &lt;/EditItemTemplate&gt;\n                        &lt;ItemTemplate&gt;\n                            &lt;asp:Label runat=\"server\" Text='&lt;%# Bind(\"FormattedPhone\") %&gt;' ID=\"lblPhone\"&gt;&lt;/asp:Label&gt;\n                        &lt;/ItemTemplate&gt;\n                    &lt;/asp:TemplateField&gt;\n                    &lt;asp:TemplateField HeaderText=\"Active?\" SortExpression=\"IsActive\"&gt;\n                        &lt;FooterTemplate&gt;\n                            &lt;asp:CheckBox runat=\"server\" Checked='&lt;%# Bind(\"IsActive\") %&gt;' ID=\"chkPhoneIsActive\"&gt;&lt;/asp:CheckBox&gt;\n                        &lt;/FooterTemplate&gt;\n                        &lt;EditItemTemplate&gt;\n                            &lt;asp:CheckBox runat=\"server\" Checked='&lt;%# Bind(\"IsActive\") %&gt;' ID=\"chkPhoneIsActive\"&gt;&lt;/asp:CheckBox&gt;\n                        &lt;/EditItemTemplate&gt;\n                        &lt;ItemTemplate&gt;\n                            &lt;asp:Label runat=\"server\" Text='&lt;%# Bind(\"IsActive\") %&gt;' ID=\"lblPhoneIsActive\"&gt;&lt;/asp:Label&gt;\n                        &lt;/ItemTemplate&gt;\n                    &lt;/asp:TemplateField&gt;\n\n                    &lt;asp:TemplateField ShowHeader=\"False\"&gt;\n                        &lt;EditItemTemplate&gt;\n                            &lt;asp:LinkButton runat=\"server\" Text=\"Update\" CommandName=\"Update\" CausesValidation=\"True\" ID=\"PhoneUpdate\"&gt;&lt;/asp:LinkButton&gt;&amp;nbsp;&lt;asp:LinkButton runat=\"server\" Text=\"Cancel\" CommandName=\"Cancel\" CausesValidation=\"False\" ID=\"PhoneEditCancel\"&gt;&lt;/asp:LinkButton&gt;\n                        &lt;/EditItemTemplate&gt;\n                        &lt;ItemTemplate&gt;\n                            &lt;asp:LinkButton runat=\"server\" Text=\"Edit\" CommandName=\"Edit\" CausesValidation=\"False\" ID=\"PhoneEdit\"&gt;&lt;/asp:LinkButton&gt;&amp;nbsp;&lt;asp:LinkButton runat=\"server\" Text=\"Delete\" CommandName=\"Delete\" CausesValidation=\"False\" ID=\"PhoneDelete\"&gt;&lt;/asp:LinkButton&gt;\n                        &lt;/ItemTemplate&gt;\n                        &lt;FooterTemplate&gt;\n                            &lt;asp:LinkButton runat=\"server\" Text=\"Save New Phone\" CommandName=\"FooterInsert\" CausesValidation=\"True\" ID=\"PhoneInsert\"&gt;&lt;/asp:LinkButton&gt;\n                        &lt;/FooterTemplate&gt;\n                    &lt;/asp:TemplateField&gt;\n                &lt;/Columns&gt;\n            &lt;/gcctl:gridviewextended&gt;\n            &lt;div id=\"phonenotes\" class=\"tip\"&gt;\n                &lt;div&gt;NUMBERS ONLY - NO LETTER CODES IN THE PHONE FIELD!&lt;/div&gt;\n                &lt;div&gt;Be sure to always enter the area code, especially if you're also adding an extension.&lt;/div&gt;\n                &lt;div&gt;Note that only numbers will stay in the \"Phone\" field. Anything else you enter will disappear once it goes behind the scenes. The first 10 digits will become the phone number, and any remaining digits will become the extension.&lt;/div&gt; \n            &lt;/div&gt;\n        &lt;/section&gt;\n    &lt;/asp:Panel&gt;\n    &lt;!-- End: Phones section --&gt;\n\n    &lt;div id=\"responsetextdiv\" class=\"error\"&gt;&lt;asp:Literal ID=\"responsetext\" runat=\"server\"&gt;&lt;/asp:Literal&gt;&lt;/div&gt;\n\n&lt;/div&gt;\n\n&lt;asp:XmlDataSource ID=\"DataSourcePhoneTypes\" runat=\"server\" DataFile=\"~/XML/PhoneTypes.xml\" EnableCaching=\"true\"&gt;\n&lt;/asp:XmlDataSource&gt;\n\n&lt;/asp:Content&gt;\n</code></pre>\n\n<p>Here's the code where I get the error:</p>\n\n<pre><code>protected void gvPhones_RowCommand(object sender, GridViewCommandEventArgs e)\n{\n    // Insert data if the CommandName == \"Insert\" \n    // and the validation controls indicate valid data...\n    if (e.CommandName == \"FooterInsert\" &amp;&amp; Page.IsValid)\n    {\n//ERROR HAPPENS ON THE FOLLOWING LINE:\n        DropDownList PhoneTypeID = (DropDownList)gvPhones.FooterRow.FindControl(\"cboPhoneTypeID\");\n        TextBox FormattedPhone = (TextBox)gvPhones.FooterRow.FindControl(\"txtPhone\");\n\n        gvPhonesDataSource.InsertParameters[\"PhoneTypeID\"].DefaultValue = PhoneTypeID.SelectedValue.ToString();\n\n        string sFormattedPhone = null;\n        if (!string.IsNullOrEmpty(FormattedPhone.Text))\n            sFormattedPhone = FormattedPhone.Text;\n        gvPhonesDataSource.InsertParameters[\"FormattedPhone\"].DefaultValue = sFormattedPhone;\n\n        gvPhonesDataSource.InsertParameters[\"CustomerID\"].DefaultValue = customerid.Text.ToString();\n       gvPhonesDataSource.InsertParameters[\"CustomerContactID\"].DefaultValue = contactid.Text.ToString();\n        gvPhonesDataSource.InsertParameters[\"StaffID\"].DefaultValue = System.Web.HttpContext.Current.Session[\"StaffID\"].ToString();\n\n        // Insert new record\n        gvPhonesDataSource.Insert();\n    }\n}\n</code></pre>\n\n<p>The full error I get is:</p>\n\n<hr>\n\n<pre><code>Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.\n\nSource Error: \n\n\nLine 276:            if (e.CommandName == \"FooterInsert\" &amp;&amp; Page.IsValid)\nLine 277:            {\nLine 278:                DropDownList PhoneTypeID = (DropDownList)gvPhones.FooterRow.FindControl(\"cboPhoneTypeID\");\nLine 279:                TextBox FormattedPhone = (TextBox)gvPhones.FooterRow.FindControl(\"txtPhone\");\nLine 280:\n\nSource File: &lt;snip&gt;    Line: 278 \n\nStack Trace: \n\n\n[NullReferenceException: Object reference not set to an instance of an object.]\n   GCWebForms.Directory.ContactEdit.gvPhones_RowCommand(Object sender, GridViewCommandEventArgs e) in &lt;snip&gt;ContactEdit.aspx.cs:278\n   System.Web.UI.WebControls.GridView.OnRowCommand(GridViewCommandEventArgs e) +137\n   System.Web.UI.WebControls.GridView.HandleEvent(EventArgs e, Boolean causesValidation, String validationGroup) +95\n   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +49\n   System.Web.UI.WebControls.GridViewRow.OnBubbleEvent(Object source, EventArgs e) +146\n   System.Web.UI.Control.RaiseBubbleEvent(Object source, EventArgs args) +49\n   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +5450\n</code></pre>\n\n<hr>\n\n<p>When stepping through (when trying to add a new row to a gridview that already has data in it), I found that gvPhones.FooterRow says that it's null. Again, this only happens if there is data in gvPhones. If the datatable is empty, then the footerrow insert code works without a hitch.</p>\n\n<p>Any help would be greatly appreciated! :-)</p>\n\n<p>EDIT: adding the relevant code behind Page_Load. I just added the DataBind() statement, but it didn't make a difference.</p>\n\n<pre><code>    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n        {\n            bool bolNewRec = (this.iContactID == null);\n            phonesformcontent.Visible = (!bolNewRec);\n\n            if (bolNewRec)\n            { //snipping unrelated code\n            }\n            else\n            {\n                //snipping code that loads the data into the page\n                gvPhones.Sort(\"SortOrder, PhoneType\", SortDirection.Ascending);\n            }\n        }\n\n        if (phonesformcontent.Visible)\n            gvPhones.DataBind();\n    }\n</code></pre>\n\n<p>...and, just in case, here's RowDataBound:</p>\n\n<pre><code>    protected void gvPhones_RowDataBound(object sender, GridViewRowEventArgs e)\n    {\n        if (e.Row.RowType == DataControlRowType.DataRow)\n        {\n            DataRowView rowView = (DataRowView)e.Row.DataItem;\n            bool bolShowInactive = chkPhoneShowInactive.Checked;\n            if (!bolShowInactive &amp;&amp; (Convert.ToBoolean(rowView[\"IsActive\"]) == false))\n                e.Row.Visible = false;\n            else\n                e.Row.Visible = true;\n            rowView = null;\n        }\n\n        if (e.Row.RowType == DataControlRowType.Footer)\n        {\n            CheckBox chkIsActive = (CheckBox)e.Row.FindControl(\"chkPhoneIsActive\");\n            chkIsActive.Checked = true;\n            chkIsActive = null;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", ".net", "null", "discord", "discord.net"], "comments": [{"owner": {"reputation": 2992, "user_id": 7401159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bJEJG.png?s=128&g=1", "display_name": "Wright", "link": "https://stackoverflow.com/users/7401159/wright"}, "edited": false, "score": 0, "creation_date": 1521061986, "post_id": 49284747, "comment_id": 85578433, "body": "How is it returning null? What are you doing to check?"}], "answers": [{"comments": [{"owner": {"reputation": 38, "user_id": 8528274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KbqGpk5NQ5Q/AAAAAAAAAAI/AAAAAAAAACc/apAQs3Gxsu0/photo.jpg?sz=128", "display_name": "Petr Kot&#225;b", "link": "https://stackoverflow.com/users/8528274/petr-kot%c3%a1b"}, "edited": false, "score": 0, "creation_date": 1521109468, "post_id": 49288357, "comment_id": 85595693, "body": "Thanks you a lot its works for me :D. But I dont understand what is the diference between the client.Ready and client.Connected :/"}, {"owner": {"reputation": 3295, "user_id": 7421086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pLCBS.png?s=128&g=1", "display_name": "Kaynn", "link": "https://stackoverflow.com/users/7421086/kaynn"}, "reply_to_user": {"reputation": 38, "user_id": 8528274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KbqGpk5NQ5Q/AAAAAAAAAAI/AAAAAAAAACc/apAQs3Gxsu0/photo.jpg?sz=128", "display_name": "Petr Kot&#225;b", "link": "https://stackoverflow.com/users/8528274/petr-kot%c3%a1b"}, "edited": false, "score": 0, "creation_date": 1521120042, "post_id": 49288357, "comment_id": 85602745, "body": "@PetrKot&#225;b I am not really clear myself, so someone can correct me if I am wrong. Basically the client a <code>Connected</code>, <code>LoggedIn</code> and <code>Ready</code> eventhandler state for us to use. And whenever you run the client, it goes from <code>Connected</code>, to <code>LoggedIn</code>, finally with <code>Ready</code> state. I am guessing that <code>Connected</code> state refers to when the client manages to establish a connection to Discord, but have not logged in yet. And the <code>ready</code> state refers to the client having successfully loaded all it&#39;s own client-user contents after logged in."}], "tags": [], "owner": {"reputation": 3295, "user_id": 7421086, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pLCBS.png?s=128&g=1", "display_name": "Kaynn", "link": "https://stackoverflow.com/users/7421086/kaynn"}, "is_accepted": true, "score": 2, "last_activity_date": 1521065027, "creation_date": 1521065027, "answer_id": 49288357, "question_id": 49284747, "link": "https://stackoverflow.com/questions/49284747/client-getchannelchannelid-return-null/49288357#49288357", "title": "client.GetChannel(%channelID%) return null", "body": "<p>Use <code>Client.Ready</code> event Handler instead, and make sure that the bot is indeed in that specific channel, and it should work this time.</p>\n\n<p>So it would look like this:</p>\n\n<pre><code>public async Task StartAsync()\n{\n    await Client.StartAsync();\n    Client.MessageReceived += Client_MessageReceived;\n    Client.Ready += Client_Ready;\n    Logger.WriteLog(\"Bot started\");\n    await Task.Delay(-1);\n}\n\nprivate async Task Client_Ready()\n{\n    var channel = Client.GetChannel(414543303187496962);\n}\n</code></pre>\n"}], "owner": {"reputation": 38, "user_id": 8528274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KbqGpk5NQ5Q/AAAAAAAAAAI/AAAAAAAAACc/apAQs3Gxsu0/photo.jpg?sz=128", "display_name": "Petr Kot&#225;b", "link": "https://stackoverflow.com/users/8528274/petr-kot%c3%a1b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "accepted_answer_id": 49288357, "answer_count": 1, "score": 1, "last_activity_date": 1521065027, "creation_date": 1521050370, "last_edit_date": 1521051171, "question_id": 49284747, "link": "https://stackoverflow.com/questions/49284747/client-getchannelchannelid-return-null", "title": "client.GetChannel(%channelID%) return null", "body": "<blockquote>\n  <p>Im creting discord bot via discord.Net v 1.0.2 </p>\n</blockquote>\n\n<p>And  I want to get specific channel from my server Im trying to get that channel via <strong><code>Client.GetChannel(%channelID%)</code></strong> (Client is property of type DiscordSocketClient in my bot class) but that method return me only null and I just cant figure out why. I searched on lots of similiar post on internet but nothing work. There is start method of my bot and method where Im trying to get channel:</p>\n\n<pre><code>public async Task StartAsync()\n{\n    await Client.StartAsync();\n    Client.MessageReceived += Client_MessageReceived;\n    Client.Connected += Client_Connected;\n    Logger.WriteLog(\"Bot started\");\n    await Task.Delay(-1);\n}\n\nprivate async Task Client_Connected()\n{\n    var channel = Client.GetChannel(414543303187496962);\n}\n</code></pre>\n"}, {"tags": ["c#", "smtp", "smtpclient"], "comments": [{"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1521051417, "post_id": 49284716, "comment_id": 85572935, "body": "No. Retry would have to be implemented in your application."}, {"owner": {"reputation": 84066, "user_id": 5311735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rhPk.jpg?s=128&g=1", "display_name": "Evk", "link": "https://stackoverflow.com/users/5311735/evk"}, "edited": false, "score": 0, "creation_date": 1521060161, "post_id": 49284716, "comment_id": 85577612, "body": "SmtpClient itself does not retry, but relay smtp server you are sending it to (to which you provide credentials) will retry if necessary."}], "owner": {"reputation": 355, "user_id": 7698804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/849085425229424/picture?type=large", "display_name": "Matthew Stott", "link": "https://stackoverflow.com/users/7698804/matthew-stott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521051865, "creation_date": 1521050272, "last_edit_date": 1521051865, "question_id": 49284716, "link": "https://stackoverflow.com/questions/49284716/c-smtp-does-it-retry", "title": "C# smtp - does it retry", "body": "<p>My question is, when using C# and using a smtp client to send email, does the smtp class retry deferred emails?</p>\n\n<p>I know Outlook / Gmail etc will retry emails if they defer or can't send straight away.</p>\n\n<p>If you just write some C# code and use the smtp client to send email does it perform retries as gmail etc does?</p>\n\n<p>I will be using the smtp client and passing in an external smtp authentication details. E.g. Duo circle </p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 3454, "user_id": 6485082, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3c127a713f55a0f952b1b7941f25ace8?s=128&d=identicon&r=PG&f=1", "display_name": "FCin", "link": "https://stackoverflow.com/users/6485082/fcin"}, "edited": false, "score": 0, "creation_date": 1521050230, "post_id": 49284638, "comment_id": 85572211, "body": "It would make more sense if you wrote that you have intel processor with 2 cores and 4 threads."}, {"owner": {"reputation": 8411, "user_id": 359157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gQiBp.png?s=128&g=1", "display_name": "TyCobb", "link": "https://stackoverflow.com/users/359157/tycobb"}, "edited": false, "score": 0, "creation_date": 1521050300, "post_id": 49284638, "comment_id": 85572247, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8998895/how-to-determine-which-cpu-a-thread-runs-on\">How to determine which CPU a thread runs on?</a>"}, {"owner": {"reputation": 8411, "user_id": 359157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gQiBp.png?s=128&g=1", "display_name": "TyCobb", "link": "https://stackoverflow.com/users/359157/tycobb"}, "edited": false, "score": 2, "creation_date": 1521050317, "post_id": 49284638, "comment_id": 85572260, "body": "Threads move unless you specifically set the affinity."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1521050781, "post_id": 49284638, "comment_id": 85572569, "body": "It is in the ProcessInfo structure.  See Pinvoke : <a href=\"https://www.pinvoke.net/default.aspx/coredll.ProcessInfo\" rel=\"nofollow noreferrer\">pinvoke.net/default.aspx/coredll.ProcessInfo</a>  Aslo see msdn : <a href=\"https://msdn.microsoft.com/en-us/library/system.web.processinfo(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1511, "user_id": 2739697, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/sHtAv.jpg?s=128&g=1", "display_name": "Jophy job", "link": "https://stackoverflow.com/users/2739697/jophy-job"}, "edited": false, "score": 0, "creation_date": 1521051673, "post_id": 49284774, "comment_id": 85573072, "body": "then use WMI to get details about core link : <a href=\"https://code.msdn.microsoft.com/windowsdesktop/CCS-LABS-WMI-Getting-c0403bd9\" rel=\"nofollow noreferrer\">code.msdn.microsoft.com/windowsdesktop/&hellip;</a>"}, {"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 0, "creation_date": 1521055475, "post_id": 49284774, "comment_id": 85575099, "body": "Seems to work for me. Note: <code>using System.Security;</code> and <code>using System.Runtime.InteropServices;</code> (and <code>using System.Threading;</code>)"}], "tags": [], "owner": {"reputation": 1511, "user_id": 2739697, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/sHtAv.jpg?s=128&g=1", "display_name": "Jophy job", "link": "https://stackoverflow.com/users/2739697/jophy-job"}, "is_accepted": false, "score": 2, "last_activity_date": 1521051029, "last_edit_date": 1521051029, "creation_date": 1521050456, "answer_id": 49284774, "question_id": 49284638, "link": "https://stackoverflow.com/questions/49284638/how-to-get-the-core-processor-id-of-executing-thread/49284774#49284774", "title": "How to get the core/processor id of executing thread?", "body": "<p>You can use GetCurrentProcessorNumber </p>\n\n<pre><code>[DllImport(\"Kernel32.dll\"), SuppressUnmanagedCodeSecurity]\npublic static extern int GetCurrentProcessorNumber();\n\nstatic void Main(string[] args)\n{\n    Parallel.For (0, 10 , state =&gt; Console.WriteLine(\"Thread Id = {0}, CoreId = {1}\",\n        Thread.CurrentThread.ManagedThreadId,\n        GetCurrentProcessorNumber()));\n    Console.ReadKey();\n}\n</code></pre>\n\n<p><a href=\"http://blogs.microsoft.co.il/bnaya/2011/01/28/how-to-find-which-core-your-thread-is-scheduled-on/\" rel=\"nofollow noreferrer\">how-to-find-which-core-your-thread-is-scheduled-on</a></p>\n"}], "owner": {"reputation": 49, "user_id": 7976722, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/543626c2608f3db29065526b0977f358?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Portyu", "link": "https://stackoverflow.com/users/7976722/mike-portyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521051029, "creation_date": 1521050010, "last_edit_date": 1521050544, "question_id": 49284638, "link": "https://stackoverflow.com/questions/49284638/how-to-get-the-core-processor-id-of-executing-thread", "title": "How to get the core/processor id of executing thread?", "body": "<p>For example, my laptop has Intel with 2 cores and 4 logical processors.\nWhen I use the code to print info about executing thread(s), I would like \nto print the id of core or logical processor executing the thread. How to do it in C#</p>\n\n<p>This is not a question how to get static info but dynamic info for an executing thread. As an example, this is what I use to get static info</p>\n\n<pre><code> ManagementClass mc = new ManagementClass(\"win32_processor\");\n ManagementObjectCollection mColl = mc.GetInstances();\n foreach (ManagementObject mObj in mColl)\n {\n     PropertyDataCollection pDC = mObj.Properties;\n     foreach (PropertyData pd in pDC)\n        Console.WriteLine(\"  {0} - {1}\", pd.Name, pd.Value);\n }\n</code></pre>\n\n<p>// Partial output</p>\n\n<pre><code>Caption - Intel64 Family 6 Model 78 Stepping 3\nDescription - Intel64 Family 6 Model 78 Stepping 3\nDeviceID - CPU0\nName - Intel(R) Core(TM) i3 - 6006U CPU @ 2.00GHz\nNumberOfCores - 2\nNumberOfEnabledCore - 2\nNumberOfLogicalProcessors - 4\nSocketDesignation - U3E1\nThreadCount - 4   // probably threads of hyper-threading, not process threads\n</code></pre>\n"}, {"tags": ["c#", "rabbitmq", "reactive-programming", "system.reactive", "easynetq"], "answers": [{"tags": [], "owner": {"reputation": 12904, "user_id": 415661, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8faea52abcef0df40f92cb1f115d0e62?s=128&d=identicon&r=PG", "display_name": "Shlomo", "link": "https://stackoverflow.com/users/415661/shlomo"}, "is_accepted": true, "score": 2, "last_activity_date": 1521064091, "creation_date": 1521064091, "answer_id": 49288155, "question_id": 49284634, "link": "https://stackoverflow.com/questions/49284634/turning-a-easynetq-subscriber-into-an-observable/49288155#49288155", "title": "Turning a EasynetQ subscriber into an observable", "body": "<p>Does this work?</p>\n\n<pre><code>var observable = Observable.Create&lt;MyMessage&gt;(o =&gt; \n    bus.Subscribe&lt;MyMessage&gt;(\"my_subscription_id\", msg =&gt; o.OnNext(msg))\n);\n</code></pre>\n\n<p>I don't have a problem with the way <code>Subject</code> is used in the referenced code: If <code>Subject</code> is a private (ideally read-only) field, only exposed as an <code>IObservable</code> then its impact is contained. However there's other problems with the code at that referenced link:</p>\n\n<ul>\n<li><p>If there's multiple <code>.Connect()</code> calls, then there will be multiple subscriptions, only one of which will be disposed. This could lead to leaks (don't know how EasyNetQ subscriptions are implemented).</p></li>\n<li><p>Best not to implement <code>IObservable</code> (or <code>IConnectableObservable</code>), because it's easy to make mistakes like the above.</p></li>\n</ul>\n"}], "owner": {"reputation": 633, "user_id": 1886661, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/e24931e1dd5980a29c2df12214a93b63?s=128&d=identicon&r=PG", "display_name": "carstenj", "link": "https://stackoverflow.com/users/1886661/carstenj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 49288155, "answer_count": 1, "score": 1, "last_activity_date": 1521064091, "creation_date": 1521049998, "question_id": 49284634, "link": "https://stackoverflow.com/questions/49284634/turning-a-easynetq-subscriber-into-an-observable", "title": "Turning a EasynetQ subscriber into an observable", "body": "<p>I am using EasyNetQ as client library when using RabbitMQ. To create a subscriber one do like</p>\n\n<pre><code>bus.Subscribe&lt;MyMessage&gt;(\"my_subscription_id\", msg =&gt; Console.WriteLine(msg.Text));\n</code></pre>\n\n<p>When an instance of MyMessage is published, EasyNetQ will call the delegate and print the message\u2019s Text property to the console.</p>\n\n<p>How do I turn this into an observable sequence? I have been looking at the <code>Observable.Create</code> and <code>Observable.Generate</code> methods but I cannot figure out how to bridge a RabbitMQ consumer and an observable sequence.</p>\n\n<p>The <code>Subscribe</code> method returns an <code>IDisposable</code> so a solution should respect this such that the resource can be properly disposed. </p>\n\n<p>I have noticed this <a href=\"https://github.com/mauriciogentile/EasyNetQ.Rx/blob/master/Source/EasyNetQ.Rx/ObservableBus.cs\" rel=\"nofollow noreferrer\">solution</a> but most people seem to advice against using <code>Subject</code> so I would like to find another solution.</p>\n\n<p>Any hints or ideas are most welcome.</p>\n"}, {"tags": ["c#", "amazon-web-services", "elasticsearch", "logging", "nlog"], "comments": [{"owner": {"reputation": 36381, "user_id": 42126, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17fa4a777eb1dddf1a2c8a81a266b1e8?s=128&d=identicon&r=PG", "display_name": "kdgregory", "link": "https://stackoverflow.com/users/42126/kdgregory"}, "edited": false, "score": 0, "creation_date": 1521051684, "post_id": 49284580, "comment_id": 85573078, "body": "Your title implies that it doesn&#39;t work. What happens?"}], "answers": [{"tags": [], "owner": {"reputation": 11822, "user_id": 193178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUlHJ.png?s=128&g=1", "display_name": "Rolf Kristensen", "link": "https://stackoverflow.com/users/193178/rolf-kristensen"}, "is_accepted": false, "score": 1, "last_activity_date": 1521053349, "creation_date": 1521053349, "answer_id": 49285595, "question_id": 49284580, "link": "https://stackoverflow.com/questions/49284580/how-can-i-log-to-amazon-elasticsearch-with-nlog/49285595#49285595", "title": "How can I log to Amazon ElasticSearch with NLog?", "body": "<p>You need to put a wrapper around <code>ElasticSearchTarget</code> because of the following bug:</p>\n\n<p><a href=\"https://github.com/ReactiveMarkets/NLog.Targets.ElasticSearch/issues/53\" rel=\"nofollow noreferrer\">https://github.com/ReactiveMarkets/NLog.Targets.ElasticSearch/issues/53</a></p>\n\n<pre><code>var awsTaget = new ElasticSearchTarget();\nvar awsTargetAsync = new AsyncTargetWrapper(awsTaget) { OverflowAction=AsyncTargetWrapperOverflowAction.Block, BatchSize=10, TimeToSleepBetweenBatches = 0 };\n\n// Step 4. Define rules\nvar rule3 = new LoggingRule(\"*\", LogLevel.Debug, awsTargetAsync);\n</code></pre>\n"}], "owner": {"reputation": 448, "user_id": 3840386, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/782beed1e4196faf51c8841252bbb481?s=128&d=identicon&r=PG", "display_name": "gjfonte", "link": "https://stackoverflow.com/users/3840386/gjfonte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521053349, "creation_date": 1521049774, "question_id": 49284580, "link": "https://stackoverflow.com/questions/49284580/how-can-i-log-to-amazon-elasticsearch-with-nlog", "title": "How can I log to Amazon ElasticSearch with NLog?", "body": "<p>I am trying to get NLog working with Amazon ElasticSearch.</p>\n\n<p>This is what I got at the moment:</p>\n\n<pre><code>// Step 1. Create configuration object \nvar config = new LoggingConfiguration();\n\n// Step 2. Create targets and add them to the configuration \nvar awsTaget = new ElasticSearchTarget();\nconfig.AddTarget(\"aws\", awsTaget);\n\n// Step 3. Set target properties \nawsTaget.Uri = \"https://amazonendpoint.com\";\nawsTaget.Index = \"myindex\" + DateTime.Now.ToString(\"yyyy-MM-dd\");\nawsTaget.DocumentType = \"logevent\";\nawsTaget.Layout = \"${message}\";\n\n// Step 4. Define rules\nvar rule3 = new LoggingRule(\"*\", LogLevel.Debug, awsTaget);\nconfig.LoggingRules.Add(rule3);    \n\n// Step 5. Activate the configuration\nLogManager.Configuration = config;\n\n// log\nvar _logger = LogManager.GetLogger(\"Example\");\nlogger.Debug(\"debug log message\");\n</code></pre>\n\n<p>I am using NLog and NLog.Targets.ElasticSearch. Is that the right packages?</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1521049738, "post_id": 49284526, "comment_id": 85571920, "body": "Are both of these scripts on the same GameObject?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9178201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-htXEiPWDxyw/AAAAAAAAAAI/AAAAAAAAAEk/Z2UHV8pZYf8/photo.jpg?sz=128", "display_name": "Sam Crerar", "link": "https://stackoverflow.com/users/9178201/sam-crerar"}, "edited": false, "score": 0, "creation_date": 1521050405, "post_id": 49284601, "comment_id": 85572314, "body": "thank you but I need them to be on separate objects because one needs to affect the text and one needs to be attached to the player as they will be the one entering the collider"}, {"owner": {"reputation": 31, "user_id": 9006476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0433540f1ae2fafd3cda4d162cf220e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander M.", "link": "https://stackoverflow.com/users/9006476/alexander-m"}, "reply_to_user": {"reputation": 1, "user_id": 9178201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-htXEiPWDxyw/AAAAAAAAAAI/AAAAAAAAAEk/Z2UHV8pZYf8/photo.jpg?sz=128", "display_name": "Sam Crerar", "link": "https://stackoverflow.com/users/9178201/sam-crerar"}, "edited": false, "score": 0, "creation_date": 1521050463, "post_id": 49284601, "comment_id": 85572366, "body": "I just updated my answer for that purpose."}, {"owner": {"reputation": 3330, "user_id": 5507624, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/Wz96B.jpg?s=128&g=1", "display_name": "Ian H.", "link": "https://stackoverflow.com/users/5507624/ian-h"}, "edited": false, "score": 0, "creation_date": 1521050525, "post_id": 49284601, "comment_id": 85572412, "body": "This is a bad implementation, in both performance and code structure. <code>FindObjectOfType</code> only works well if you have only one object that contains the script which may not be the case. Consider rathing using a <code>public Changetext changetext;</code>, in order to be able to assign it in the inspector. Additionally, if you want to use <code>FindObjectOfType</code>, just store the variable immediatly as a <code>Changetext</code>, don&#39;t bother calling <code>GetComponent</code>."}, {"owner": {"reputation": 1, "user_id": 9178201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-htXEiPWDxyw/AAAAAAAAAAI/AAAAAAAAAEk/Z2UHV8pZYf8/photo.jpg?sz=128", "display_name": "Sam Crerar", "link": "https://stackoverflow.com/users/9178201/sam-crerar"}, "edited": false, "score": 0, "creation_date": 1521050932, "post_id": 49284601, "comment_id": 85572655, "body": "@Alexander I tried using your code you suggested but it gives me an error saying &quot;Cannot implicitly convert type &#39;Changetext&#39; to &#39;UnityEngine.GameObject&#39;"}, {"owner": {"reputation": 31, "user_id": 9006476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0433540f1ae2fafd3cda4d162cf220e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander M.", "link": "https://stackoverflow.com/users/9006476/alexander-m"}, "reply_to_user": {"reputation": 1, "user_id": 9178201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-htXEiPWDxyw/AAAAAAAAAAI/AAAAAAAAAEk/Z2UHV8pZYf8/photo.jpg?sz=128", "display_name": "Sam Crerar", "link": "https://stackoverflow.com/users/9178201/sam-crerar"}, "edited": false, "score": 0, "creation_date": 1521051786, "post_id": 49284601, "comment_id": 85573124, "body": "@SamCrerar try <code>changetext = FindObjectOfType&lt;Changetext&gt;().gameObject;</code> instead, but like Ian already stated, my version might not be the best solution in terms of performance."}], "tags": [], "owner": {"reputation": 31, "user_id": 9006476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0433540f1ae2fafd3cda4d162cf220e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander M.", "link": "https://stackoverflow.com/users/9006476/alexander-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1521052235, "last_edit_date": 1521052235, "creation_date": 1521049835, "answer_id": 49284601, "question_id": 49284526, "link": "https://stackoverflow.com/questions/49284526/unable-to-link-two-scripts-together-in-unity/49284601#49284601", "title": "Unable to link two scripts together in unity", "body": "<p>First of all: you don't have to include <code>UnityEngine.UI</code> in your second script.</p>\n\n<p>It seems like your scripts are not attached to the same gameobject, which is essential for <code>GetComponent</code> in this case.</p>\n\n<p>If your scripts shouldn't be on the same gameobject, you can just make a reference to your changetext, like</p>\n\n<pre><code> private GameObject changetext;\n\nvoid Start()\n{\n  changetext = FindObjectOfType&lt;Changetext&gt;().gameObject;\n}\n</code></pre>\n\n<p>And then call it with</p>\n\n<pre><code>changetext.GetComponent&lt;Changetext&gt;().enabled = true;\n</code></pre>\n\n<p>Note: this only works if you only have one <code>Changetext</code> in your scene.\nThe version without declaring a gameobject should be the following:</p>\n\n<pre><code> private Changetext changetext;\n\nvoid Start()\n{\n  changetext = FindObjectOfType&lt;Changetext&gt;().gameObject.GetComponent&lt;Changetext&gt;();\n}\n</code></pre>\n\n<p>And then call it with</p>\n\n<pre><code>changetext.enabled = true;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3673, "user_id": 7256853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7H077BfRVB0/AAAAAAAAAAI/AAAAAAAAAEA/3S1Dq2-H8GE/photo.jpg?sz=128", "display_name": "Galandil", "link": "https://stackoverflow.com/users/7256853/galandil"}, "edited": false, "score": 0, "creation_date": 1521051629, "post_id": 49284935, "comment_id": 85573043, "body": "There&#39;s another possibility: he didn&#39;t feed a <code>Text</code> type reference to the <code>countdownText</code> field, which could cause the NullReference exception."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "reply_to_user": {"reputation": 3673, "user_id": 7256853, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7H077BfRVB0/AAAAAAAAAAI/AAAAAAAAAEA/3S1Dq2-H8GE/photo.jpg?sz=128", "display_name": "Galandil", "link": "https://stackoverflow.com/users/7256853/galandil"}, "edited": false, "score": 0, "creation_date": 1521052478, "post_id": 49284935, "comment_id": 85573487, "body": "@Galandil That is also true. Though comments have indicated that the asker <i><code>need[s the two scripts] to be on separate objects</code></i>, so that was indeed a problem that GetComponent the way he was using it was failing in that manner."}], "tags": [], "owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "is_accepted": false, "score": 2, "last_activity_date": 1521050998, "creation_date": 1521050998, "answer_id": 49284935, "question_id": 49284526, "link": "https://stackoverflow.com/questions/49284526/unable-to-link-two-scripts-together-in-unity/49284935#49284935", "title": "Unable to link two scripts together in unity", "body": "<p>As Alexander M. said in his answer, your code only works if both scripts are attached to the same object.</p>\n\n<p>His answer suggests one method of acquiring that reference, but it is performance intensive and only works if there's exactly 1 copy of that script in the entire scene (two copies will have deterministic, but possibly undesired, behavior).</p>\n\n<p>You probably want something like this:</p>\n\n<pre><code>public class TRigger : MonoBehaviour\n{\n    void OnTriggerEnter(Collider other)\n    {\n        other.GetComponent&lt;Changetext&gt;().enabled = true;\n    }\n\n    void OnTriggerExit(Collider other)\n    {\n        other.GetComponent&lt;Changetext&gt;().enabled = false;\n    }\n}\n</code></pre>\n\n<p>Note the added parameter to <code>OnTriggerEnter</code> and <code>OnTriggerExit</code> (renamed from <code>OnTriggerLeave</code>): These are neccessary otherwise you have functions which will never be called because they are not in the <a href=\"https://docs.unity3d.com/ScriptReference/MonoBehaviour.html\" rel=\"nofollow noreferrer\">MonoBehaviour script reference</a>.</p>\n\n<p>The above code will find the <code>Changetext</code> <em>on the object that touched the trigger volume.</em> If this is not where the script is located, you will need other methods to get a reference, such as manually assigning it to a field or using <a href=\"https://docs.unity3d.com/ScriptReference/GameObject.Find.html\" rel=\"nofollow noreferrer\"><code>GameObject.Find()</code></a>, which should only be done in <code>Start()</code> or <code>Awake()</code> or similar and the result cached in a class property.</p>\n"}, {"tags": [], "owner": {"reputation": 455, "user_id": 8942505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v7V96.jpg?s=128&g=1", "display_name": "ToneCrate", "link": "https://stackoverflow.com/users/8942505/tonecrate"}, "is_accepted": false, "score": 0, "last_activity_date": 1552257569, "last_edit_date": 1552257569, "creation_date": 1521061545, "answer_id": 49287624, "question_id": 49284526, "link": "https://stackoverflow.com/questions/49284526/unable-to-link-two-scripts-together-in-unity/49287624#49287624", "title": "Unable to link two scripts together in unity", "body": "<p>Since you said you need these scripts to be on separate objects, you should also do proper separation of concerns here. Key aspects:</p>\n\n<p>Your Text object should have a ChangeTextScript on it. Its only concern is to start updating text when told so from another script. That's why it needs a public method called <strong>StartChangingText</strong> that can be called from outside and possibly a <strong>ResetText</strong> method to be called once player exits the trigger area in case you wish to display a \"Player left the trigger area\" message or something similar.</p>\n\n<p>Your player object should have a TriggerScript on it. Once player enters the trigger area, this script should just call <strong>StartChangingText</strong> mentioned above. When player leaves the trigger area, it could call <strong>ResetText</strong>.</p>\n\n<p>To implement this, first rename your Text object in the hierarchy to \"CountdownText\" in order for TriggerScript on the player object to find it by name, which is a safer method of referencing objects than drag and dropping objects to inspector fields. Then add a new component to the player object and name it ChangeTextScript. Paste this updated version of your code into it:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.UI;\n\npublic class ChangeTextScript : MonoBehaviour {\n    public float timeLeft = 5f;\n    private Text countdownText; //you can also set Text to public and\n                                // drag the Text object into the inspector field,\n                                // but it's prone to initialization errors when \n                                // switching scenes or not saving your project\n\n    bool shouldBeChangingText = false;\n\n    void Start() {\n        countdownText = GetComponent&lt;Text&gt;();\n    }\n\n    public void StartChangingText() {\n        shouldBeChangingText = true;\n    }\n\n    public void ResetText() {\n        shouldBeChangingText = false;\n        countdownText.text = \"Player left the area\";\n        timeLeft = 5f;\n    }\n\n    void Update()\n    {\n        if (shouldBeChangingText) {\n            timeLeft -= Time.deltaTime;\n            countdownText.text = (\"Time Left = \" + timeLeft);\n\n            if (timeLeft &lt;= 0)\n            {\n                shouldBeChangingText = false;\n                countdownText.text = \"You got the cash\";\n                timeLeft = 5f;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Then, add a new component to the player object, name it TriggerScript and paste this updated code into it:</p>\n\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class TriggerScript : MonoBehaviour {\n    private ChangeTextScript changeTextScript;\n\n    void Start() {\n        changeTextScript = GameObject.Find(\"CountdownText\").GetComponent&lt;ChangeTextScript&gt;();\n    }\n\n    void OnTriggerEnter()\n    { \n        changeTextScript.StartChangingText();\n    }\n\n    void OnTriggerExit()\n    {\n        changeTextScript.ResetText();\n    }\n}\n</code></pre>\n\n<p>Note, when the timer runs out, we tell our script it should stop updating text, but we reset the timer so it can be started again, no need to enable and disable the script when you wish to run it again. </p>\n\n<p>Also, in your original script, setting <strong>gameObject.enabled</strong> to true/false is deprecated in favor of <strong>gameObject.SetActive(bool value)</strong>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9178201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-htXEiPWDxyw/AAAAAAAAAAI/AAAAAAAAAEk/Z2UHV8pZYf8/photo.jpg?sz=128", "display_name": "Sam Crerar", "link": "https://stackoverflow.com/users/9178201/sam-crerar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1181, "favorite_count": 0, "closed_date": 1521400607, "answer_count": 3, "score": -1, "last_activity_date": 1552257569, "creation_date": 1521049606, "last_edit_date": 1521407287, "question_id": 49284526, "link": "https://stackoverflow.com/questions/49284526/unable-to-link-two-scripts-together-in-unity", "closed_reason": "Needs details or clarity", "title": "Unable to link two scripts together in unity", "body": "<p>I have created two scripts in a unity game I am developing. The first is a script called Changetext (See below) and this seems to work fine, however, I would like it to only run when a player enters a set area in the game world so I created a second script called TRigger (See below)  which I tried to use to create a way in which whenever the player enters a trigger collider it calls this script making but whenever I try this unity just errors saying \"NullReferenceException: Object reference not set to an instance of an object\"</p>\n\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.UI;\n\npublic class Changetext : MonoBehaviour {\npublic float timeLeft = 5;\npublic Text countdownText;\nvoid Update()\n{\n    timeLeft -= Time.deltaTime;\n     countdownText.text = (\"Time Left = \" + timeLeft);\n\n    if (timeLeft &lt;= 0)\n    {\n        countdownText.text = \"You got the cash\";\n    }\n}\n\n}\n\n\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.UI;\n\n public class TRigger : MonoBehaviour\n { \n void Start()\n{\n    GetComponent&lt;Changetext&gt;().enabled = false;\n}\nvoid OnTriggerEnter()\n{\n    GetComponent&lt;Changetext&gt;().enabled = true;\n}\n\nvoid OnTriggerLeave()\n{\n    GetComponent&lt;Changetext&gt;().enabled = false;\n}\n\n\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "entity-framework"], "comments": [{"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1521049531, "post_id": 49284449, "comment_id": 85571795, "body": "Did you Google your error message?"}, {"owner": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "edited": false, "score": 0, "creation_date": 1521050171, "post_id": 49284449, "comment_id": 85572175, "body": "You mention <code>L_Colaboradores</code> but nowhere in your code can we see that."}, {"owner": {"reputation": 195, "user_id": 4790786, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f1e846e10d500e17c8456c2dd6d2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4790786/kunal"}, "reply_to_user": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1521051051, "post_id": 49284449, "comment_id": 85572721, "body": "@Crowcoder I did a lot actually i tried all first 5 pages of google..."}, {"owner": {"reputation": 195, "user_id": 4790786, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f1e846e10d500e17c8456c2dd6d2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4790786/kunal"}, "reply_to_user": {"reputation": 21683, "user_id": 4228458, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/fj2C5.jpg?s=128&g=1", "display_name": "CodingYoshi", "link": "https://stackoverflow.com/users/4228458/codingyoshi"}, "edited": false, "score": 0, "creation_date": 1521051102, "post_id": 49284449, "comment_id": 85572755, "body": "@CodingYoshi I edited my code on bd context thanks for pointing me out"}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 1, "creation_date": 1521051506, "post_id": 49284449, "comment_id": 85572970, "body": "That can&#39;t be all of your DbSets. Where is type <code>PM</code> defined?"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 1, "creation_date": 1521052924, "post_id": 49284449, "comment_id": 85573754, "body": "The exception is telling you that your <code>DbContext</code> contains property <code>public DbSet&lt;L_Colaborador&gt; L_ColaboradorPais { get; set; }</code>. The type of the property should be changed to <code>DbSet&lt;L_ColaboradorPais&gt;</code>."}, {"owner": {"reputation": 195, "user_id": 4790786, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f1e846e10d500e17c8456c2dd6d2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4790786/kunal"}, "reply_to_user": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1521053587, "post_id": 49284449, "comment_id": 85574134, "body": "@Crowcoder Sorry PM was a typing mistake"}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 1, "creation_date": 1521053696, "post_id": 49284449, "comment_id": 85574200, "body": "Do you see how you have two DbSets of the same type? You can only have one even if you name them differently."}, {"owner": {"reputation": 195, "user_id": 4790786, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f1e846e10d500e17c8456c2dd6d2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4790786/kunal"}, "reply_to_user": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1521053875, "post_id": 49284449, "comment_id": 85574285, "body": "@Crowcoder Thats excatly the problem thank you very much! If you add as an answer i will gladdly accept thanks"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 3672506, "user_type": "registered", "profile_image": "https://graph.facebook.com/704642656/picture?type=large", "display_name": "Mocolicious", "link": "https://stackoverflow.com/users/3672506/mocolicious"}, "is_accepted": true, "score": 2, "last_activity_date": 1521057963, "creation_date": 1521057963, "answer_id": 49286781, "question_id": 49284449, "link": "https://stackoverflow.com/questions/49284449/entity-framework-multiple-object-sets-per-type-are-not-supported/49286781#49286781", "title": "Entity Framework &quot;Multiple object sets per type are not supported. &quot;", "body": "<p>You're telling EF to create the model object <code>L_Colaborador</code> twice in your DBContext.  I think what you mean to do is this:</p>\n\n<pre><code>public DbSet&lt;L_Colaborador&gt; L_Colaboradores { get; set; }\npublic DbSet&lt;L_ColaboradorPais&gt; L_ColaboradorPais { get; set; }\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 4790786, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f1e846e10d500e17c8456c2dd6d2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "Kunal", "link": "https://stackoverflow.com/users/4790786/kunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 49286781, "answer_count": 1, "score": 0, "last_activity_date": 1521057963, "creation_date": 1521049366, "last_edit_date": 1521053501, "question_id": 49284449, "link": "https://stackoverflow.com/questions/49284449/entity-framework-multiple-object-sets-per-type-are-not-supported", "title": "Entity Framework &quot;Multiple object sets per type are not supported. &quot;", "body": "<p>I am trying to create a parent child relationship Model of the same object type.\nExactly like the one over here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5559043/entity-framework-code-first-two-foreign-keys-from-same-table\">Entity Framework Code First - two Foreign Keys from same table</a></p>\n\n<p>I tried all the things mentioned but migrations always gives me the error above.</p>\n\n<p>Here are my models:\nMain Entity: </p>\n\n<pre><code>public class L_Colaborador\n{\n    [Key]\n    public int Id { get; set; }\n    public String Nome { get; set; }\n\n    [JsonIgnore]\n    public virtual List&lt;L_ColaboradorPais&gt; L_ColaboradorPais { get; set; }\n\n    [JsonIgnore]\n    public virtual List&lt;L_ColaboradorPais&gt; L_ColaboradorFilhos { get; set; }\n}\n</code></pre>\n\n<p>RelationShip Entity with Parent/ Child foreign keys:</p>\n\n<pre><code>public class L_ColaboradorPais\n{\n    [Key]\n    public int Id { get; set; }\n\n    public int PaiId { get; set; }\n    public int FilhoId { get; set; }\n\n\n    public virtual L_Colaborador Pai { get; set; }\n    public virtual L_Colaborador Filho { get; set; }\n}\n</code></pre>\n\n<p>And here is my DBContext:</p>\n\n<pre><code>public DbSet&lt;L_Colaborador&gt; L_Colaboradores { get; set; }\npublic DbSet&lt;L_Colaborador&gt; L_ColaboradorPais { get; set; }\nprotected override void OnModelCreating(DbModelBuilder modelBuilder)\n{\n\n\n   modelBuilder.Ignore&lt;V_HorasSum&gt;();\n    modelBuilder.Conventions.Remove&lt;OneToManyCascadeDeleteConvention&gt;();\n\n    modelBuilder.Entity&lt;L_ColaboradorPais&gt;()\n            .HasRequired(m =&gt; m.Pai)\n            .WithMany(t =&gt; t.L_ColaboradorFilhos)\n            .HasForeignKey(m =&gt; m.PaiId)\n            .WillCascadeOnDelete(false);\n\n    modelBuilder.Entity&lt;L_ColaboradorPais&gt;()\n                .HasRequired(m =&gt; m.Filho)\n                .WithMany(t =&gt; t.L_ColaboradorPais)\n                .HasForeignKey(m =&gt; m.FilhoId)\n                .WillCascadeOnDelete(false);\n\n\n    //base.OnModelCreating(modelBuilder);\n}\n</code></pre>\n\n<p>Can't really figure out why am I getting this error:</p>\n\n<blockquote>\n  <p>Multiple object sets per type are not supported. The object sets 'L_Colaboradores' and 'L_ColaboradorPais' can both contain instances of type 'TimeProject.Models.L_Colaborador'. </p>\n</blockquote>\n\n<p>And I have also tried using ForeignKey annotation</p>\n"}, {"tags": ["c#", "wmi", "win32-process"], "comments": [{"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521048967, "post_id": 49284274, "comment_id": 85571440, "body": "Can you show an example of the value of <code>programArgs</code>?"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521049027, "post_id": 49284274, "comment_id": 85571477, "body": ".. surprised you can run notepad as <i>&quot;For security reasons the Win32_Process.Create method cannot be used to start an interactive process remotely.&quot;</i>"}, {"owner": {"reputation": 21, "user_id": 8544935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b2ee4350ef3700051c56f5fe072e52?s=128&d=identicon&r=PG&f=1", "display_name": "Deeeyewhy", "link": "https://stackoverflow.com/users/8544935/deeeyewhy"}, "reply_to_user": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521049502, "post_id": 49284274, "comment_id": 85571774, "body": "Notepad didn&#39;t start interactively I don&#39;t need it to as my program should run in the background only."}, {"owner": {"reputation": 21, "user_id": 8544935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b2ee4350ef3700051c56f5fe072e52?s=128&d=identicon&r=PG&f=1", "display_name": "Deeeyewhy", "link": "https://stackoverflow.com/users/8544935/deeeyewhy"}, "reply_to_user": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521051141, "post_id": 49284274, "comment_id": 85572781, "body": "I added the args array to the example. Thanks"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521051254, "post_id": 49284274, "comment_id": 85572850, "body": "Are you sure you&#39;ve got the escaping right on the share name? Shouldn&#39;t it be <code>&quot;\\\\\\\\server1\\\\db$&quot;</code>?"}, {"owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521051329, "post_id": 49284274, "comment_id": 85572893, "body": "Also you&#39;re getting double quotes round the date - with the change above it looks like <code>C:\\Report\\Report.exe &quot;Share&quot; &quot;tiny 3&quot; No Yes No No Yes &quot;&quot;3&#47;13&#47;2018 11:51:00 AM&quot;&quot; mainTable \\\\server1\\db$</code>"}, {"owner": {"reputation": 21, "user_id": 8544935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b2ee4350ef3700051c56f5fe072e52?s=128&d=identicon&r=PG&f=1", "display_name": "Deeeyewhy", "link": "https://stackoverflow.com/users/8544935/deeeyewhy"}, "reply_to_user": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521052598, "post_id": 49284274, "comment_id": 85573571, "body": "Sorry I copied and pasted I forgot the &quot;@&quot; before the last argument. I added it in. Still an issue though. The raw command line to my program is below.  report.exe &quot;share&quot; tiny3 No Yes No No Yes &quot;3/13/2018 11:51:00 AM&quot; mainTable \\\\server1\\db$"}, {"owner": {"reputation": 21, "user_id": 8544935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b2ee4350ef3700051c56f5fe072e52?s=128&d=identicon&r=PG&f=1", "display_name": "Deeeyewhy", "link": "https://stackoverflow.com/users/8544935/deeeyewhy"}, "reply_to_user": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "edited": false, "score": 0, "creation_date": 1521079390, "post_id": 49284274, "comment_id": 85583884, "body": "ok so I was able to get the program to run on the remote system. and it is running as the correct user. I have a new issue, but I will create anew question for that. Thanks"}], "owner": {"reputation": 21, "user_id": 8544935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29b2ee4350ef3700051c56f5fe072e52?s=128&d=identicon&r=PG&f=1", "display_name": "Deeeyewhy", "link": "https://stackoverflow.com/users/8544935/deeeyewhy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521052554, "creation_date": 1521048734, "last_edit_date": 1521052554, "question_id": 49284274, "link": "https://stackoverflow.com/questions/49284274/issue-executing-remote-program-using-wmi-win32-process", "title": "Issue executing remote program using WMI Win32_Process", "body": "<p>I do not receive any errors, the program simply does not execute remotely and I am looking for ideas as to why that may be occurring. The program runs fine locally when I run it from the remote computer using command prompt. The program itself takes 10 arguments, hence args[0] through [9] below. Any suggestions are appreciated.</p>\n\n<p>NOTE: I tested this code using notepad and it worked fine, so it seems to be related to how I am calling my program with arguments (as notepad has no arguments).</p>\n\n<p>Thanks</p>\n\n<pre><code>String programArgs = @\"C:\\Report\\Report.exe \" + \"\\\"\" + args[0] + \"\\\"\" + \" \" + args[1] \n      + \" \" + args[2] + \" \" + args[3] + \" \" + args[4] + \" \" + args[5] + \" \" + args[6] \n      + \" \" + \"\\\"\" + args[7] + \"\\\"\" + \" \" + args[8] + \" \" + args[9];\n\nobject[] theProcessToRun = { programArgs, @\"C:\\Report\" };\n\nManagementScope wmiScope = new ManagementScope(@\"\\\\\" + hostname + @\"\\root\\cimv2\");\nwmiScope.Options.Impersonation = ImpersonationLevel.Impersonate;\nwmiScope.Connect();\nusing (ManagementClass managementClass = new ManagementClass(wmiScope, \n                           new ManagementPath(\"Win32_Process\"), new ObjectGetOptions()))\n{\n    managementClass.InvokeMethod(\"Create\", theProcessToRun);\n}\n</code></pre>\n"}, {"tags": ["c#", "razor", "asp.net-core", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 2, "creation_date": 1521049257, "post_id": 49284222, "comment_id": 85571621, "body": "How is that form populating the model? There are no input fields. What fields are the form suppose to populate?"}, {"owner": {"reputation": 79, "user_id": 3465224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9a326883f9e426bd880d7d9811d8242?s=128&d=identicon&r=PG&f=1", "display_name": "Zarch", "link": "https://stackoverflow.com/users/3465224/zarch"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1521050912, "post_id": 49284222, "comment_id": 85572644, "body": "I&#39;m using the form as a work around to send the model to the controller when the button is clicked. Could that be my problem?"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 1, "creation_date": 1521051221, "post_id": 49284222, "comment_id": 85572833, "body": "But there is nothing to send. That form only has a submit button. It is not sending any data as there are no input fields to represent the data to be sent. If it sends nothing then the action will get a null value."}, {"owner": {"reputation": 79, "user_id": 3465224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9a326883f9e426bd880d7d9811d8242?s=128&d=identicon&r=PG&f=1", "display_name": "Zarch", "link": "https://stackoverflow.com/users/3465224/zarch"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1521051927, "post_id": 49284222, "comment_id": 85573197, "body": "That makes sense. I&#39;ve added hidden inputs now to pass the properties. Thank you. If you don&#39;t mind me asking, is using the form to pass a model to a controller best practice?"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 1, "creation_date": 1521051989, "post_id": 49284222, "comment_id": 85573228, "body": "It is usually how they get submitted to the contoller."}, {"owner": {"reputation": 79, "user_id": 3465224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9a326883f9e426bd880d7d9811d8242?s=128&d=identicon&r=PG&f=1", "display_name": "Zarch", "link": "https://stackoverflow.com/users/3465224/zarch"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1521052390, "post_id": 49284222, "comment_id": 85573442, "body": "Cool. Thanks for the help."}], "answers": [{"tags": [], "owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "is_accepted": true, "score": 1, "last_activity_date": 1521052397, "creation_date": 1521052397, "answer_id": 49285319, "question_id": 49284222, "link": "https://stackoverflow.com/questions/49284222/net-core-mvc-form-passing-model-with-null-properties/49285319#49285319", "title": ".NET Core MVC form passing model with null properties", "body": "<p>No data is being submitted to the controller.</p>\n\n<p>That form only has a submit button. </p>\n\n<p>It is not sending any data as there are no input fields to represent the model to be sent. </p>\n\n<p>If it sends nothing then the action will get a null value.</p>\n\n<p>Ensure that there are values to be sent that match the properties on the model to be sent.</p>\n\n<pre><code>&lt;form asp-action=\"CreateCharacter\" asp-controller=\"Character\" data-ajax=\"true\" \n        data-ajax-mode=\"replace\" data-ajax-update=\"#character-container\"&gt;\n\n    &lt;input type=\"hidden\" name=\"propertyName\" value=\"propertyValue\"&gt;\n\n    &lt;!--\n    &lt;input ... /&gt;\n    &lt;input ... /&gt;\n    &lt;input ... /&gt;\n    --&gt;     \n\n    &lt;button class=\"btn btn-default\" type=\"submit\"&gt;Create Chracter&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 3465224, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a9a326883f9e426bd880d7d9811d8242?s=128&d=identicon&r=PG&f=1", "display_name": "Zarch", "link": "https://stackoverflow.com/users/3465224/zarch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2009, "favorite_count": 0, "accepted_answer_id": 49285319, "answer_count": 1, "score": 1, "last_activity_date": 1521070797, "creation_date": 1521048580, "last_edit_date": 1521070797, "question_id": 49284222, "link": "https://stackoverflow.com/questions/49284222/net-core-mvc-form-passing-model-with-null-properties", "title": ".NET Core MVC form passing model with null properties", "body": "<p>I have a form that is suppose to pass my <code>Encounter</code> model to my <code>CharacterController</code>'s <code>CreateCharacter</code> action method. </p>\n\n<p>Here is the form:</p>\n\n<pre><code>&lt;form asp-action=\"CreateCharacter\" asp-controller=\"Character\" data-ajax=\"true\" data-ajax-mode=\"replace\" data-ajax-update=\"#character-container\"&gt;\n    &lt;button class=\"btn btn-default\" type=\"submit\"&gt;Create Chracter&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Here's the controller method:</p>\n\n<pre><code>public ActionResult CreateCharacter(Encounter encounter)\n{\n    Character character = new Character { Encounter = encounter };\n    return PartialView(\"Add\", character);\n}\n</code></pre>\n\n<p>All the properties of <code>encounter</code> are null when they shouldn't be. To clarify, <code>Encounter</code> is the model for the view that the form is in. Within this view, I use the <code>Name</code> property of <code>Encounter</code> and it works fine. When I pass the model to my controller, however, the <code>Name</code> property is now null.</p>\n\n<p>I'm confused why this is happening because I have a very similar form elsewhere that passes a model fine.</p>\n"}, {"tags": ["c#", "opengl", "3d", "opentk"], "comments": [{"owner": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1521049359, "post_id": 49284207, "comment_id": 85571683, "body": "What about the Scene Manager receiving the event and asking the Render Manager to do the render?"}, {"owner": {"reputation": 3, "user_id": 9493044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158f717dd9a82c66a023d3f8b6fe06d8?s=128&d=identicon&r=PG&f=1", "display_name": "geminius", "link": "https://stackoverflow.com/users/9493044/geminius"}, "reply_to_user": {"reputation": 6058, "user_id": 3871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbe44ff5c56628e85683c8918602c96?s=128&d=identicon&r=PG&f=1", "display_name": "Ripi2", "link": "https://stackoverflow.com/users/3871028/ripi2"}, "edited": false, "score": 0, "creation_date": 1521051099, "post_id": 49284207, "comment_id": 85572752, "body": "That was my First thought. But the Event is OpenTK specific and i don&#39;t want anything OpenTK specific Code outside the OpenGLVideoDriver class."}], "owner": {"reputation": 3, "user_id": 9493044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158f717dd9a82c66a023d3f8b6fe06d8?s=128&d=identicon&r=PG&f=1", "display_name": "geminius", "link": "https://stackoverflow.com/users/9493044/geminius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521049548, "creation_date": 1521048524, "last_edit_date": 1521049548, "question_id": 49284207, "link": "https://stackoverflow.com/questions/49284207/architectural-dilemma-with-onupdateframe-on-opentk", "title": "Architectural Dilemma with OnUpdateFrame on OpenTK", "body": "<p>I'm writing a small 3d Engine using .NET Core and OpenTK.</p>\n\n<p>For compatibiliy reasons i want to abstract the renderer in a class called <code>VideoDriver</code>, so for example i could implement Vulkan support later on. Currently there is a derived class called <code>OpenGLVideoDriver</code> wich does all the rendering. Subscribing the Event <code>OnRenderFrame()</code> is okay, since this belongs to the renderer. But subscribing the <code>OnUpdateFrame</code> event belongs to the Scene Manager, and has nothing to do with the renderer. Any Idea how i can implement the Event Handler without breaking the architecture? No class except the <code>OpenGLVideoDriver</code> class should know something about OpenTK.</p>\n"}, {"tags": ["c#", "wpf", "mvvm"], "comments": [{"owner": {"reputation": 1402, "user_id": 5418754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AC4ZL.jpg?s=128&g=1", "display_name": "Alexey Klipilin", "link": "https://stackoverflow.com/users/5418754/alexey-klipilin"}, "edited": false, "score": 0, "creation_date": 1521048414, "post_id": 49284064, "comment_id": 85571059, "body": "Binding DataContext from XAML? <a href=\"https://stackoverflow.com/questions/23713898/setting-datacontext-in-xaml-in-wpf\" title=\"setting datacontext in xaml in wpf\">stackoverflow.com/questions/23713898/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 958, "user_id": 986399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Jg2tX.jpg?s=128&g=1", "display_name": "Khoa Nguyen", "link": "https://stackoverflow.com/users/986399/khoa-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1521049802, "last_edit_date": 1521049802, "creation_date": 1521049368, "answer_id": 49284450, "question_id": 49284064, "link": "https://stackoverflow.com/questions/49284064/bind-object-of-collection-to-a-button-in-xaml-without-using-code-behind/49284450#49284450", "title": "Bind object of collection to a button in xaml without using code behind", "body": "<p>There's a way which is exposing an ICommand in ViewModel named MoveNext</p>\n\n<p>The ICommand interface is here <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.input.icommand(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.windows.input.icommand(v=vs.110).aspx</a> </p>\n\n<pre><code>class MoveNextCommand : ICommand \n{\n    ...... &lt;Your implementation&gt;\n}\n\npublic class TestViewModel \n{\n    ...\n    private ICommand _moveNextCmd;\n    public ICommand MoveNextCmd \n    {\n        get { return _moveNextCmd ?? (_moveNextCmd = new MoveNextCommand()); }\n    }\n    ...\n}\n</code></pre>\n\n<p>In XAML</p>\n\n<pre><code>&lt;Button FontWeight=\"Bold\" x:Name=\"nextButton\" Content=\"Next Question\" Grid.Column=\"2\" Grid.Row=\"5\" Command={Binding MoveNextCmd} /&gt;\n</code></pre>\n\n<p>The command's logic is just changing the CurrentQuestion of the ViewModel.</p>\n\n<p>The important thing here is that your ViewModel must implement INotifyPropertyChanged interface and setter of the properties must call OnPropertyChanged, otherwise you won't see any update when changing the property's value.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8987121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab187723f50b7586c8460b83cad44aaa?s=128&d=identicon&r=PG&f=1", "display_name": "StefanC", "link": "https://stackoverflow.com/users/8987121/stefanc"}, "edited": false, "score": 0, "creation_date": 1521110840, "post_id": 49284482, "comment_id": 85596642, "body": "Hello Pierce. Thank you for your reply, I have one question though what should &quot;_command&quot; be ? It says that it is out of context."}], "tags": [], "owner": {"reputation": 143, "user_id": 1256136, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e5f996ed228e7ae4d85f7c6fed371683?s=128&d=identicon&r=PG", "display_name": "Pierce", "link": "https://stackoverflow.com/users/1256136/pierce"}, "is_accepted": false, "score": 0, "last_activity_date": 1521049463, "creation_date": 1521049463, "answer_id": 49284482, "question_id": 49284064, "link": "https://stackoverflow.com/questions/49284064/bind-object-of-collection-to-a-button-in-xaml-without-using-code-behind/49284482#49284482", "title": "Bind object of collection to a button in xaml without using code behind", "body": "<p>If you want to avoid using the code behind and implement MVVM for this, you will need to implement ICommand.</p>\n\n<p>Put this in your <strong>ViewModel</strong>:</p>\n\n<pre><code>public ICommand ExecuteCommand\n    {\n        get\n        {\n            if (_command == null)\n            {\n                _command = new RelayCommand(param =&gt; this.NextQuestion());\n            }\n            return _command;\n        }\n    }\n\n    public void NextQuestion()\n    {\n        //Do Stuff Here\n\n    }\n</code></pre>\n\n<p>Bind your button to it by adding this to your <strong>XAML</strong>:</p>\n\n<pre><code>Command=\"{Binding Path=ExecuteCommand}\"\n</code></pre>\n\n<p>And, finally, add a <strong>RelayCommand</strong> class to your project:</p>\n\n<pre><code>public class RelayCommand : ICommand\n{\n\n    readonly Action&lt;object&gt; _ActionToExecute;\n    readonly Predicate&lt;object&gt; _ActionCanExecute;\n\n    public RelayCommand(Action&lt;object&gt; inActionToExecute): this(inActionToExecute, null)\n    {\n\n    }\n\n    public RelayCommand(Action&lt;object&gt; inActionToExecute, Predicate&lt;object&gt; inActionCanExecute)\n    {\n        if (inActionToExecute == null)\n            throw new ArgumentNullException(\"execute\");\n\n        _ActionToExecute = inActionToExecute;\n        _ActionCanExecute = inActionCanExecute;\n    }\n\n    public bool CanExecute(object parameter)\n    {\n        return _ActionCanExecute == null ? true : _ActionCanExecute(parameter);\n    }\n\n    public event EventHandler CanExecuteChanged\n    {\n        add { CommandManager.RequerySuggested += value; }\n        remove { CommandManager.RequerySuggested -= value; }\n    }\n\n    public void Execute(object parameter)\n    {\n        _ActionToExecute(parameter);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8987121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab187723f50b7586c8460b83cad44aaa?s=128&d=identicon&r=PG&f=1", "display_name": "StefanC", "link": "https://stackoverflow.com/users/8987121/stefanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521049802, "creation_date": 1521048134, "last_edit_date": 1521049358, "question_id": 49284064, "link": "https://stackoverflow.com/questions/49284064/bind-object-of-collection-to-a-button-in-xaml-without-using-code-behind", "title": "Bind object of collection to a button in xaml without using code behind", "body": "<p>I have a questionnaire application and I would like to display the objects (questions + answers in my case) one at a time. Meaning that I would like the user to be displayed the first question, answer it, then click a button and get the 2nd question (in the same window), click another button / or the same button and get the 3rd question and so on. At the moment, I am having difficulties trying to bind the 2nd question to my button by using only XAML. Is it possible to do this without using code behind? If so please do give me an idea. Thank you in anticipation.</p>\n\n<p>This is my ViewModel:</p>\n\n<pre><code>namespace TestAppMVVM.ViewModel\n{\n    public class TestViewModel\n    {\n        public ObservableCollection&lt;Test&gt; BeginnerTests\n        {\n            get;\n            set;\n        }\n\n        public Test CurrentQuestion\n        {\n            get;\n            set;\n        }\n\n        public Test NextQuestion\n        {\n            get;\n            set;\n        }\n\n        public Test CurrentAnswer\n        {\n            get;\n            set;\n        }\n\n        public Test NextAnswer\n        {\n            get;\n            set;\n        }\n\n\n\n\n        public void LoadBeginner()\n        {\n            ObservableCollection&lt;Test&gt; tests = new ObservableCollection&lt;Test&gt;();\n\n            tests.Add(new Test { Index = 1, Question = \"1.What is the capital of England ?\", FirstAnswer = \"Paris\", SecondAnswer = \"London\", ThirdAnswer = \"Berlin\" });\n            tests.Add(new Test { Index = 2, Question = \"2.What is the capital of France ?\", FirstAnswer = \"Paris\", SecondAnswer = \"London\", ThirdAnswer = \"Berlin\" });\n            tests.Add(new Test { Index = 3, Question = \"3.What is the capital of Germany ?\", FirstAnswer = \"Paris\", SecondAnswer = \"London\", ThirdAnswer = \"Berlin\" });\n\n\n            BeginnerTests = tests;\n            CurrentQuestion = BeginnerTests[0];\n            CurrentAnswer = BeginnerTests[0];\n\n            NextQuestion = BeginnerTests[1];\n            NextAnswer = BeginnerTests[1];\n\n        }\n    }\n}   \n</code></pre>\n\n<p>And here I paste the View:</p>\n\n<pre><code>&lt;Grid Background=\"Yellow\"&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"20\"/&gt;\n        &lt;ColumnDefinition Width=\"auto\"/&gt;\n        &lt;ColumnDefinition Width=\"auto\"/&gt;\n        &lt;ColumnDefinition Width=\"auto\"/&gt;\n        &lt;ColumnDefinition Width=\"*\"/&gt;\n        &lt;ColumnDefinition Width=\"20\"/&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height =\"20\"/&gt;\n        &lt;RowDefinition Height =\"100\"/&gt;\n        &lt;RowDefinition Height =\"auto\"/&gt;\n        &lt;RowDefinition Height =\"auto\"/&gt;\n        &lt;RowDefinition Height =\"30\"/&gt;\n        &lt;RowDefinition Height =\"*\"/&gt;\n        &lt;RowDefinition Height =\"20\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n    &lt;TextBlock Grid.Column=\"1\" Grid.Row=\"1\" FontSize=\"25\" Grid.ColumnSpan=\"3\" Text=\"{Binding CurrentQuestion.Question}\"/&gt;\n\n    &lt;StackPanel Orientation=\"Horizontal\" Grid.Column=\"2\" Grid.Row=\"3\" Grid.ColumnSpan=\"5\"&gt;\n        &lt;RadioButton FontWeight=\"Bold\" Content=\"{Binding CurrentAnswer.FirstAnswer}\"/&gt;\n        &lt;RadioButton FontWeight=\"Bold\" Margin=\"10 0 0 0\" Content=\"{Binding CurrentAnswer.SecondAnswer}\"/&gt;\n        &lt;RadioButton FontWeight=\"Bold\" Margin=\"10 0 0 0\" Content=\"{Binding CurrentAnswer.ThirdAnswer}\"/&gt;\n    &lt;/StackPanel&gt;\n\n\n    &lt;Button FontWeight=\"Bold\" x:Name=\"nextButton\" Content=\"Next Question\" Grid.Column=\"2\" Grid.Row=\"5\"/&gt;\n</code></pre>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 1402, "user_id": 5418754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AC4ZL.jpg?s=128&g=1", "display_name": "Alexey Klipilin", "link": "https://stackoverflow.com/users/5418754/alexey-klipilin"}, "edited": false, "score": 0, "creation_date": 1521048954, "post_id": 49284044, "comment_id": 85571435, "body": "use at least <code>timer().MoveNext();</code>, otherwise it will not call your method and<code>Debug.Log(&quot;blahblahblah&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1074, "user_id": 9258246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EaISP.png?s=128&g=1", "display_name": "TJ Wolschon", "link": "https://stackoverflow.com/users/9258246/tj-wolschon"}, "is_accepted": true, "score": 3, "last_activity_date": 1521048730, "creation_date": 1521048730, "answer_id": 49284273, "question_id": 49284044, "link": "https://stackoverflow.com/questions/49284044/timer-function-doesnt-work-unityc/49284273#49284273", "title": "Timer function doesnt work (Unity+C#)", "body": "<p>Try using <code>StartCoroutine(timer());</code> instead of just <code>timer();</code></p>\n"}, {"comments": [{"owner": {"reputation": 553, "user_id": 2080204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vHqtC.jpg?s=128&g=1", "display_name": "Ido Ben Shalom", "link": "https://stackoverflow.com/users/2080204/ido-ben-shalom"}, "edited": false, "score": 0, "creation_date": 1521115972, "post_id": 49284354, "comment_id": 85599925, "body": "the downside is if you ever change the method&#39;s name you have to remember to change its name in the coroutine as well"}], "tags": [], "owner": {"reputation": 31, "user_id": 9006476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0433540f1ae2fafd3cda4d162cf220e?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander M.", "link": "https://stackoverflow.com/users/9006476/alexander-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1521049231, "last_edit_date": 1521049231, "creation_date": 1521049022, "answer_id": 49284354, "question_id": 49284044, "link": "https://stackoverflow.com/questions/49284044/timer-function-doesnt-work-unityc/49284354#49284354", "title": "Timer function doesnt work (Unity+C#)", "body": "<pre><code>StartCoroutine(\"timer\", true);\n</code></pre>\n\n<p>would be the best way to do it!</p>\n\n<p><code>timer()</code> would just call a normal method. <code>IEnumerator</code> works different.</p>\n"}, {"tags": [], "owner": {"reputation": 3859, "user_id": 6383171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E1hf3.png?s=128&g=1", "display_name": "zambari", "link": "https://stackoverflow.com/users/6383171/zambari"}, "is_accepted": false, "score": 0, "last_activity_date": 1521211673, "creation_date": 1521211673, "answer_id": 49323534, "question_id": 49284044, "link": "https://stackoverflow.com/questions/49284044/timer-function-doesnt-work-unityc/49323534#49323534", "title": "Timer function doesnt work (Unity+C#)", "body": "<p>As mentioned before, the correct way to start a coroutine is StartCoroutine(timer());</p>\n\n<p>from your code it isn't clear what you are trying to achieve, currently you do nothing after waiting those five seconds</p>\n\n<p>Also you probably should implement some sort of mechanism that prevents user from spamming coroutines. You can set a bool flag, or hold reference to the coroutine you started - I often do</p>\n\n<pre><code>Coroutine myRoutine; // in global scope\nif (myRoutine==null) myRoutine=StartCoroutine(timer()); // in event handler\n</code></pre>\n\n<p>myRoutine will null itself when its finished</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8531441"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 49284273, "answer_count": 3, "score": 0, "last_activity_date": 1521211673, "creation_date": 1521048087, "last_edit_date": 1521048976, "question_id": 49284044, "link": "https://stackoverflow.com/questions/49284044/timer-function-doesnt-work-unityc", "title": "Timer function doesnt work (Unity+C#)", "body": "<p>I wrote my own function of rotating a group of objects. I want ot make a new one, with smooth rotating, so I need a timer. I have tried to call Timer a few times, but it doesnt work. Here's my code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class rotate_around : MonoBehaviour \n{\n    public Transform sphere;        \n\n    // Update is called once per frame\n    void Update ()\n    {\n        if (Input.GetKeyDown(KeyCode.RightArrow))\n        {\n            sphere.RotateAround(new Vector3(3, 3, 3), new Vector3(0, 1, 0), 45);\n            timer();\n        }\n    }        \n\n    public IEnumerator timer()\n    {\n        yield return new WaitForSeconds(5);\n        // actually I tried to add Debug.Log(\"blahblahblah\") here, but it still didnt output anything\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "oop"], "comments": [{"owner": {"reputation": 36783, "user_id": 2946329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ygJ.jpg?s=128&g=1", "display_name": "Salah Akbari", "link": "https://stackoverflow.com/users/2946329/salah-akbari"}, "edited": false, "score": 2, "creation_date": 1521048090, "post_id": 49284028, "comment_id": 85570837, "body": "You need to create a new instance of it unless you will use the <code>static</code> keyword."}, {"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 1, "creation_date": 1521048094, "post_id": 49284028, "comment_id": 85570842, "body": "There is no way to specify that a class is an &quot;instance class&quot;."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 6, "creation_date": 1521048143, "post_id": 49284028, "comment_id": 85570872, "body": "This should take less than a minute to test.  Is your <code>exampleClass</code> static?"}, {"owner": {"reputation": 666, "user_id": 8997882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/958771fb989682cf86e5e94b74a46028?s=128&d=identicon&r=PG&f=1", "display_name": "MBak", "link": "https://stackoverflow.com/users/8997882/mbak"}, "edited": false, "score": 0, "creation_date": 1521048354, "post_id": 49284028, "comment_id": 85571016, "body": "I&#39;m not testing it, just trying to understand the theoretical concept."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 4, "creation_date": 1521049981, "post_id": 49284028, "comment_id": 85572065, "body": "@MBaka Why does trying to understand it prevent you from testing it?  Testing things is a <i>great</i> way to understand them."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1521050469, "post_id": 49284028, "comment_id": 85572373, "body": "Testing it would also have shown you that your code isn&#39;t valid."}, {"owner": {"reputation": 666, "user_id": 8997882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/958771fb989682cf86e5e94b74a46028?s=128&d=identicon&r=PG&f=1", "display_name": "MBak", "link": "https://stackoverflow.com/users/8997882/mbak"}, "edited": false, "score": 0, "creation_date": 1527610227, "post_id": 49284028, "comment_id": 88186728, "body": "Thanks for your input guys. I&#39;ve written an article based on this conversation. If you have any feedback I&#39;d love to hear it."}], "answers": [{"tags": [], "owner": {"reputation": 411, "user_id": 6835862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UhjggAjFsDI/AAAAAAAAAAI/AAAAAAAAAmE/HkXWNlp-k3c/photo.jpg?sz=128", "display_name": "elhs16", "link": "https://stackoverflow.com/users/6835862/elhs16"}, "is_accepted": false, "score": 2, "last_activity_date": 1521048177, "creation_date": 1521048177, "answer_id": 49284083, "question_id": 49284028, "link": "https://stackoverflow.com/questions/49284028/do-c-classes-default-to-instance-or-static-classes-if-not-specified/49284083#49284083", "title": "Do C# classes default to instance or static classes if not specified?", "body": "<p>A class is always an instance class unless you specify otherwise</p>\n"}, {"comments": [{"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 2, "creation_date": 1521048337, "post_id": 49284119, "comment_id": 85571007, "body": "Not quite true, you don&#39;t <i>need</i> to create an instance of it. A non-static class can still contain only static member for example."}, {"owner": {"reputation": 666, "user_id": 8997882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/958771fb989682cf86e5e94b74a46028?s=128&d=identicon&r=PG&f=1", "display_name": "MBak", "link": "https://stackoverflow.com/users/8997882/mbak"}, "edited": false, "score": 0, "creation_date": 1527610366, "post_id": 49284119, "comment_id": 88186797, "body": "Excellent response."}], "tags": [], "owner": {"reputation": 386, "user_id": 7007925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e20c65576e0e1a912180d2617470a76?s=128&d=identicon&r=PG&f=1", "display_name": "Wiz", "link": "https://stackoverflow.com/users/7007925/wiz"}, "is_accepted": false, "score": 3, "last_activity_date": 1521049540, "last_edit_date": 1521049540, "creation_date": 1521048273, "answer_id": 49284119, "question_id": 49284028, "link": "https://stackoverflow.com/questions/49284028/do-c-classes-default-to-instance-or-static-classes-if-not-specified/49284119#49284119", "title": "Do C# classes default to instance or static classes if not specified?", "body": "<p>If the \"static\" is not specified, it will require an instance of the class to be used (Unless the member itself is specified as static).</p>\n\n<blockquote>\n  <p>If the class is not declared as static, client code can use it by creating objects or instances which are assigned to a variable.</p>\n</blockquote>\n\n<p>From: <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/classes\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/classes</a></p>\n"}, {"comments": [{"owner": {"reputation": 666, "user_id": 8997882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/958771fb989682cf86e5e94b74a46028?s=128&d=identicon&r=PG&f=1", "display_name": "MBak", "link": "https://stackoverflow.com/users/8997882/mbak"}, "edited": false, "score": 0, "creation_date": 1527610335, "post_id": 49284523, "comment_id": 88186781, "body": "Removed class declaration"}, {"owner": {"reputation": 666, "user_id": 8997882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/958771fb989682cf86e5e94b74a46028?s=128&d=identicon&r=PG&f=1", "display_name": "MBak", "link": "https://stackoverflow.com/users/8997882/mbak"}, "edited": false, "score": 0, "creation_date": 1527610377, "post_id": 49284523, "comment_id": 88186804, "body": "Excellent response. Super helpful."}], "tags": [], "owner": {"reputation": 154, "user_id": 3316304, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a00b64cacfd51a0cbcd4128cfb8d1501?s=128&d=identicon&r=PG&f=1", "display_name": "LeiMagnus", "link": "https://stackoverflow.com/users/3316304/leimagnus"}, "is_accepted": true, "score": 3, "last_activity_date": 1521049595, "creation_date": 1521049595, "answer_id": 49284523, "question_id": 49284028, "link": "https://stackoverflow.com/questions/49284028/do-c-classes-default-to-instance-or-static-classes-if-not-specified/49284523#49284523", "title": "Do C# classes default to instance or static classes if not specified?", "body": "<p>If you don't declare the class as static then its members can be either static or non-static. \nA static class can only have static members.\nYou can invoke non-static members only on instances of the class.\nYou can invoke static members only on the class itself.</p>\n\n<p>Also, in your class declaration, there are no parentheses.</p>\n"}], "owner": {"reputation": 666, "user_id": 8997882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/958771fb989682cf86e5e94b74a46028?s=128&d=identicon&r=PG&f=1", "display_name": "MBak", "link": "https://stackoverflow.com/users/8997882/mbak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 49284523, "answer_count": 3, "score": -10, "last_activity_date": 1527610154, "creation_date": 1521048009, "last_edit_date": 1527610154, "question_id": 49284028, "link": "https://stackoverflow.com/questions/49284028/do-c-classes-default-to-instance-or-static-classes-if-not-specified", "title": "Do C# classes default to instance or static classes if not specified?", "body": "<p>When declaring a class in C# without specifying if the class is a static or non-static class which will it default to?</p>\n\n<p>EDIT: Here's an article I wrote based on this discussion.</p>\n\n<p><a href=\"https://hackernoon.com/c-static-vs-instance-classes-and-methods-50fe8987b231\" rel=\"nofollow noreferrer\">https://hackernoon.com/c-static-vs-instance-classes-and-methods-50fe8987b231</a></p>\n"}, {"tags": ["c#", ".net", "reflection", ".net-assembly"], "answers": [{"tags": [], "owner": {"reputation": 27293, "user_id": 5740031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Una92.jpg?s=128&g=1", "display_name": "CodeFuller", "link": "https://stackoverflow.com/users/5740031/codefuller"}, "is_accepted": true, "score": 1, "last_activity_date": 1521119630, "creation_date": 1521119630, "answer_id": 49300420, "question_id": 49283983, "link": "https://stackoverflow.com/questions/49283983/getting-wrong-version-from-assembly-using-reflection/49300420#49300420", "title": "Getting wrong Version from Assembly using Reflection", "body": "<p>dotpeek does not have any magic here. It's just a very-very confusing name and behavior for <code>Assembly.LoadFile(string path)</code> method. <code>Assembly.LoadFile()</code> does not actually load the assembly at specified path, it would prefer GAC like described <a href=\"https://blogs.msdn.microsoft.com/suzcook/2003/09/19/loadfile-vs-loadfrom/\" rel=\"nofollow noreferrer\">here</a>. You could check the actual path of loaded assembly with <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer\" rel=\"nofollow noreferrer\">ProcessExplorer</a> or similar tool.</p>\n\n<p>If you want to load assembly at exact path for reflection purposes, it's better to use <code>Assembly.ReflectionOnlyLoadFrom()</code> method:</p>\n\n<pre><code>Assembly assembly = Assembly.ReflectionOnlyLoadFrom(f);\n</code></pre>\n\n<p>In this case <code>assembly.GetName().Version</code> should give you the correct assembly version.</p>\n"}], "owner": {"reputation": 6687, "user_id": 2072198, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/RiWxd.jpg?s=128&g=1", "display_name": "Fals", "link": "https://stackoverflow.com/users/2072198/fals"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 49300420, "answer_count": 1, "score": 1, "last_activity_date": 1521119630, "creation_date": 1521047843, "last_edit_date": 1521049754, "question_id": 49283983, "link": "https://stackoverflow.com/questions/49283983/getting-wrong-version-from-assembly-using-reflection", "title": "Getting wrong Version from Assembly using Reflection", "body": "<p>I'm trying to retrieve every assembly version from a huge solution, but I found out when I open the assembly using dotpeek, It shows the real version and I'm able to <code>bindiredirect</code> using this number:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WMOnJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WMOnJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But from reflection the number is completely different using <code>Assembly.ImageRuntimeVersion</code>: </p>\n\n<pre><code>System.Security.Cryptography.Primitives, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\n</code></pre>\n\n<p>Using <code>Assembly.GetName().Version</code>:</p>\n\n<pre><code>4.0.0.0\n</code></pre>\n\n<p>I've tried every possible version that I was able to find, with the code below, but none of them bring the right number.</p>\n\n<pre><code>Assembly assembly = Assembly.LoadFile(f);\nAssemblyName thisAssemName = assembly.GetName();\nVersion version = thisAssemName.Version;\nFileVersionInfo fileversion = FileVersionInfo.GetVersionInfo(f);\n\nvar multipleVersion = fileversion.ProductVersion\n    + \"|\" + version\n    + \"|\" + assembly.ImageRuntimeVersion\n    + \"|\" + assembly;\n</code></pre>\n\n<p>I don't know the magic behind dotpeek, but It has the right thing. How can I retrieve the same number as the tool?</p>\n"}, {"tags": ["c#", "epplus"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1521047824, "post_id": 49283949, "comment_id": 85570662, "body": "I think line breaks in openxml are <code>&lt;br&gt;</code>  Here&#39;s a similar question for Word <a href=\"https://stackoverflow.com/questions/2871887/inserting-newlines-in-word-using-openxml\" title=\"inserting newlines in word using openxml\">stackoverflow.com/questions/2871887/&hellip;</a>"}, {"owner": {"reputation": 1560, "user_id": 2775645, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/fKNjN.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/2775645/markus"}, "reply_to_user": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1521048375, "post_id": 49283949, "comment_id": 85571029, "body": "OK, but how would the Code look like? If I just replace the &quot;\\r\\n&quot; with &lt;br&gt; the &lt;br&gt; appears as normal Text in the cell..."}], "answers": [{"tags": [], "owner": {"reputation": 1560, "user_id": 2775645, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/fKNjN.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/2775645/markus"}, "is_accepted": true, "score": 5, "last_activity_date": 1521055273, "creation_date": 1521055273, "answer_id": 49286114, "question_id": 49283949, "link": "https://stackoverflow.com/questions/49283949/how-to-get-linebreaks-in-a-single-cell-in-epplus-with-richtext/49286114#49286114", "title": "How to get LineBreaks in a single Cell in EPPlus with RichText", "body": "<p>Finally I found the solution. Here is a working sample:</p>\n\n<pre><code>    using (var package = new ExcelPackage(fileInfo)) {    \n         var worksheet = package.Workbook.Worksheets.Add(\"Test\");    \n         var cell = worksheet.Cells[1, 1];\n         cell.Style.WrapText = true;\n         cell.Style.VerticalAlignment = ExcelVerticalAlignment.Top;\n\n         var r1 = cell.RichText.Add(\"TextLine1\" + \"\\r\\n\");\n         r1.Bold = true;\n         var r2 = cell.RichText.Add(\"TextLine2\" + \"\\r\\n\");\n         r2.Bold = false;\n\n         package.Save();\n     }\n</code></pre>\n\n<p>But I think I found a bug in the Lib: This Code is <strong>NOT</strong> working:</p>\n\n<pre><code>    using (var package = new ExcelPackage(fileInfo)) {    \n         var worksheet = package.Workbook.Worksheets.Add(\"Test\");    \n         var cell = worksheet.Cells[1, 1];\n         cell.Style.WrapText = true;\n         cell.Style.VerticalAlignment = ExcelVerticalAlignment.Top;\n\n         var r1 = cell.RichText.Add(\"TextLine1\" + \"\\r\\n\");\n         r1.Bold = true;\n         var r2 = cell.RichText.Add(\"TextLine2\" + \"\\r\\n\");\n         r2.Bold = false;\n\n         cell = worksheet.Cells[1, 1];\n         var r4 = cell.RichText.Add(\"TextLine3\" + \"\\r\\n\");\n         r4.Bold = true;\n\n         package.Save();\n     }\n</code></pre>\n\n<p>When I get the same range again and add new RichText Tokens, the old LineBreaks are deleted... (They are actually converted to \"\\n\" and this is not working in Excel.)</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4583053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSMRj.png?s=128&g=1", "display_name": "Tricinty", "link": "https://stackoverflow.com/users/4583053/tricinty"}, "is_accepted": false, "score": 3, "last_activity_date": 1521648148, "creation_date": 1521648148, "answer_id": 49411171, "question_id": 49283949, "link": "https://stackoverflow.com/questions/49283949/how-to-get-linebreaks-in-a-single-cell-in-epplus-with-richtext/49411171#49411171", "title": "How to get LineBreaks in a single Cell in EPPlus with RichText", "body": "<p>The Encoding of new line in excel cell is 10.\nI think you have to do someihing like thise:</p>\n\n<pre><code>var r1 = cell.RichText.Add(\"TextLine1\" + ((char)10).ToString());\n</code></pre>\n"}], "owner": {"reputation": 1560, "user_id": 2775645, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/fKNjN.jpg?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/2775645/markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4036, "favorite_count": 0, "accepted_answer_id": 49286114, "answer_count": 2, "score": 7, "last_activity_date": 1521648148, "creation_date": 1521047732, "question_id": 49283949, "link": "https://stackoverflow.com/questions/49283949/how-to-get-linebreaks-in-a-single-cell-in-epplus-with-richtext", "title": "How to get LineBreaks in a single Cell in EPPlus with RichText", "body": "<p>I use the following Code:</p>\n\n<pre><code>using (var package = new ExcelPackage()) {    \n    var worksheet = package.Workbook.Worksheets.Add(\"Test\");    \n    var cell = worksheet.Cells[1, 1];\n\n    var r1 = cell.RichText.Add(\"TextLine1\" + \"\\r\\n\");\n    r1.Bold = true;\n    var r2 = cell.RichText.Add(\"TextLine2\" + \"\\r\\n\");\n    r2.Bold = false;\n\n    package.SaveAs(...);\n}\n</code></pre>\n\n<p>But in the Excel file the newLines are gone...</p>\n\n<p>I tried also with \"\\n\" and \"\\r\" but nothing was working...</p>\n"}, {"tags": ["c#", ".net", "vba", "visual-studio", "ms-access"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 4, "creation_date": 1521048142, "post_id": 49283907, "comment_id": 85570870, "body": "I can understand your pain, (been there myself) but your question is simply off-topic or too broad. And if you really need an opinion, well. rewrite everything."}, {"owner": {"reputation": 97, "user_id": 7470572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47141453ecea29cdf4b43b2a97bba035?s=128&d=identicon&r=PG&f=1", "display_name": "JazzmanJim", "link": "https://stackoverflow.com/users/7470572/jazzmanjim"}, "edited": false, "score": 0, "creation_date": 1521048429, "post_id": 49283907, "comment_id": 85571071, "body": "Yes, this will be painful.  It will be a total re-write.  I&#39;ve had to do this for an app that started as Access (ugh) in the late 90&#39;s.  It was moved to VB6 with the database in sql server. In the 2012 time frame we needed to move to WIN7/10 which required a re-write as the third party ActiveX controls used were no longer supported.  Definitely a very painful process.  Good luck."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1521049658, "post_id": 49283907, "comment_id": 85571874, "body": "You might want to see what <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> can do for you. Sadly the <i>extract method</i> refactoring has been pulled out and is currently being rewritten (feel free to contribute - it&#39;s all written in C#), but the navigation tooling alone should help quite a bit. Disclaimer: I own &amp; manage this open-source project."}, {"owner": {"reputation": 67, "user_id": 7638743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1fcu.jpg?s=128&g=1", "display_name": "West", "link": "https://stackoverflow.com/users/7638743/west"}, "edited": false, "score": 0, "creation_date": 1521050492, "post_id": 49283907, "comment_id": 85572383, "body": "Thanks for the responses. I think at this time it is probably best to recommend a rewrite and see what the client wants to do from there. Y&#39;all are the best!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1521053387, "post_id": 49283907, "comment_id": 85574007, "body": "Does the client actually want a complete rewrite? Or just some changes that could easily be done in the existing Access application? -- You most probably have seen this, but I&#39;ll link it just in case: <a href=\"https://www.joelonsoftware.com/2000/04/06/things-you-should-never-do-part-i/\" rel=\"nofollow noreferrer\">joelonsoftware.com/2000/04/06/things-you-should-never-do-par&zwnj;&#8203;t-i</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7638743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1fcu.jpg?s=128&g=1", "display_name": "West", "link": "https://stackoverflow.com/users/7638743/west"}, "edited": false, "score": 1, "creation_date": 1521050541, "post_id": 49284212, "comment_id": 85572422, "body": "This is probably the direction I will take. Sorry, you were awesome enough to respond even though you were inevitably going to be downvoted. I appreciate the response and advice!"}], "tags": [], "owner": {"reputation": 143, "user_id": 1256136, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e5f996ed228e7ae4d85f7c6fed371683?s=128&d=identicon&r=PG", "display_name": "Pierce", "link": "https://stackoverflow.com/users/1256136/pierce"}, "is_accepted": true, "score": 4, "last_activity_date": 1521048542, "creation_date": 1521048542, "answer_id": 49284212, "question_id": 49283907, "link": "https://stackoverflow.com/questions/49283907/converting-vba-project-written-in-ms-access-to-any-modern-language/49284212#49284212", "title": "Converting VBA project written in MS Access to ANY modern language", "body": "<p>\"...there probably is not an answer other than simply rewriting the entire application.\"</p>\n\n<p>I had a similar issue a couple of years ago with a legacy application built on an Access97 database.  </p>\n\n<p>There is no quick fix.  You will spend more time trying to beat the existing code into a new form than it is worth.  Use the old code as a guide for structure, but start from scratch.</p>\n"}], "owner": {"reputation": 67, "user_id": 7638743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1fcu.jpg?s=128&g=1", "display_name": "West", "link": "https://stackoverflow.com/users/7638743/west"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "closed_date": 1521049030, "accepted_answer_id": 49284212, "answer_count": 1, "score": -3, "last_activity_date": 1521050401, "creation_date": 1521047621, "last_edit_date": 1521050401, "question_id": 49283907, "link": "https://stackoverflow.com/questions/49283907/converting-vba-project-written-in-ms-access-to-any-modern-language", "closed_reason": "Not suitable for this site", "title": "Converting VBA project written in MS Access to ANY modern language", "body": "<p>Okay, I know that this is a super weird question and there probably is not an answer other than simply rewriting the entire application. However, I recently took on a project for a client that has a MASSIVE project written inside of Access 2007 with Visual Basic for Applications and some VB6. In order to help them my first plan was to just modernize everything they have. The application runs on XP and I was hoping that I could at least move the project files and forms (automatically) to any type of .net project inside of Visual Studio. I've never used any of the Microsoft developer tools and after a couple days of digging around on the internet, most converters don't actually seem to work. There doesn't seem to be any sort of \"best practice\" way to bring an old VB project to a more modern developer environment. If rewriting everything is really the only option that's fine I was just hoping that one of you very smart people knew of a way that I could at least get most of the code/forms into a newer environment. If I can just open the project in an older version of Visual Basic that works too (their system has access to every major version since 2008) Thanks in advance! </p>\n\n<p>I am also totally open to porting the project into any other language if there is a better tool that works for say Python, Java, C (any iteration of C), etc. </p>\n\n<p>EDIT: \"Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it.\" \u2013 Scott Craner, Steve, Erik von Asmuth, Kostas K., braX</p>\n\n<p>So in response to this, I have attempted to rebuild the project inside of visual studio 2008 and then using the built-in converter bring the code from VBA to VB6 which (for the most part) worked. From there I could save the project and open it in visual studio 2010 once again using the built-in converter to take the code from VB6 to VB.Net. However, this is where the \"success\" stops. Essentially the project cannot be opened in any newer version of visual studio (attempted with 2012, 2015, and 2017) I was simply hoping that ANYONE would have any ideas on how else I could go about moving this project into Visual Studio or rebuilding it in another language. I understand that the question is not super relevant considering the software I am talking about updating is over 10 years old and some of it even older. Thanks for your responses as I think that it is probably time to evaluate the cost/time involved in a complete rewrite. </p>\n"}, {"tags": ["c#", "dll", "devexpress", "version", "conflicting-libraries"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8940012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5943becbe7968408e502888c4f2bfe1?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Ancelmo", "link": "https://stackoverflow.com/users/8940012/yuri-ancelmo"}, "edited": false, "score": 0, "creation_date": 1521463006, "post_id": 49330828, "comment_id": 85726338, "body": "Yes, this is what I would to do, but is out of context because, is not one application that use DevExpress different versions, and if I did about this way, I need to migrate every applications that use my dll."}, {"owner": {"reputation": 7, "user_id": 8940012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5943becbe7968408e502888c4f2bfe1?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Ancelmo", "link": "https://stackoverflow.com/users/8940012/yuri-ancelmo"}, "edited": false, "score": 0, "creation_date": 1521463058, "post_id": 49330828, "comment_id": 85726372, "body": "Thanks for your reply , my temporary solution is remove all DevExpress references and leave the project all in windows forms."}], "tags": [], "owner": {"reputation": 2418, "user_id": 8067407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154528961798456/picture?type=large", "display_name": "Victor Hugo Terceros", "link": "https://stackoverflow.com/users/8067407/victor-hugo-terceros"}, "is_accepted": false, "score": 0, "last_activity_date": 1521242849, "creation_date": 1521242849, "answer_id": 49330828, "question_id": 49283721, "link": "https://stackoverflow.com/questions/49283721/version-conflict-same-project-devexpress/49330828#49330828", "title": "Version Conflict same Project DevExpress", "body": "<p>let me see if I understand, so you want to use two versions of DevExpress in the same project?</p>\n\n<p>Why don't upgrade the entire project to v16?</p>\n\n<p>I never mixed dlls vresions because it is really crazy, but if it helps to you when I upgrade and look at the <strong>bin</strong> folder I <strong>must delete the old dlls and just keep the new ones, yes that means remove the old references, etc</strong> that solves the conflict.</p>\n\n<p>DevExpress has a wizard to upgrate the entire project including the config and all the files.</p>\n"}], "owner": {"reputation": 7, "user_id": 8940012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5943becbe7968408e502888c4f2bfe1?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Ancelmo", "link": "https://stackoverflow.com/users/8940012/yuri-ancelmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521242849, "creation_date": 1521047081, "question_id": 49283721, "link": "https://stackoverflow.com/questions/49283721/version-conflict-same-project-devexpress", "title": "Version Conflict same Project DevExpress", "body": "<p>I have one dll that uses a version 16.2 of DevExpress, this dll is used to show one form.</p>\n\n<ul>\n<li>Basically I want to install this dll in a project that constains all references in DevExpress 14.</li>\n<li>When I create my dll, I merge all DevExpress 16.2 in the dll, and I put in NuGet, when I download in the project (DevExpress 14) has conflicts between the types, that are present in both versions. </li>\n</ul>\n\n<p>Anyone know if I can use the dll of DevExpress 16.2 only when my dll need to be runned? Or anyway to solve this problem ?</p>\n"}]