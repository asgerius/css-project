[{"tags": ["c#", "regex"], "answers": [{"tags": [], "owner": {"reputation": 27179, "user_id": 710099, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0413774874b9baeccef7a5ba0344fec7?s=128&d=identicon&r=PG", "display_name": "Federico Piazza", "link": "https://stackoverflow.com/users/710099/federico-piazza"}, "is_accepted": false, "score": 1, "last_activity_date": 1444262499, "creation_date": 1444262499, "answer_id": 33004422, "question_id": 33004400, "link": "https://stackoverflow.com/questions/33004400/regex-for-letter-v-preceded-by-underscore-and-followed-by-any-length-number/33004422#33004422", "title": "Regex for letter v preceded by underscore...and followed by any length number", "body": "<p>The problem with your regex:</p>\n\n<pre><code>^[v][0-9]$\n</code></pre>\n\n<p>Is that you are using a pattern to start with <code>v</code> and finish with a number. So, only strings like <code>v0</code>, <code>v2</code> ... <code>v9</code> are valid. Btw, you don't need to use <code>[v]</code> since it's exactly the same as <code>v</code>.</p>\n\n<p>You can use a regex look ahead like this:</p>\n\n<pre><code>_v(?=\\d)\n</code></pre>\n\n<p><strong><a href=\"https://regex101.com/r/fG4cR6/1\" rel=\"nofollow\">Working demo</a></strong></p>\n\n<p>Or a simple regex</p>\n\n<pre><code>_v\\d\n</code></pre>\n\n<p><strong><a href=\"https://regex101.com/r/fG4cR6/2\" rel=\"nofollow\">Working demo</a></strong></p>\n"}, {"tags": [], "owner": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "is_accepted": false, "score": -1, "last_activity_date": 1444262534, "creation_date": 1444262534, "answer_id": 33004427, "question_id": 33004400, "link": "https://stackoverflow.com/questions/33004400/regex-for-letter-v-preceded-by-underscore-and-followed-by-any-length-number/33004427#33004427", "title": "Regex for letter v preceded by underscore...and followed by any length number", "body": "<p>Why not a simple search:</p>\n\n<pre><code>string searchString = \"_v1_\";\nint index = a.IndexOf(searchString);\nstring sNumber = a.Substring(index + searchString.Length);\nlong lNumber = long.Parse(sNumber);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6170, "user_id": 298891, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fd9ce7b0801822fec42aa3ad28cebf1a?s=128&d=identicon&r=PG", "display_name": "Relativity", "link": "https://stackoverflow.com/users/298891/relativity"}, "edited": false, "score": 0, "creation_date": 1444262943, "post_id": 33004429, "comment_id": 53833679, "body": "if we didnt use &quot;+&quot; at the end, will it only take single digit ?"}, {"owner": {"reputation": 5782, "user_id": 2832398, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/356c99a077310a35816f852423859f4c?s=128&d=identicon&r=PG&f=1", "display_name": "lilezek", "link": "https://stackoverflow.com/users/2832398/lilezek"}, "reply_to_user": {"reputation": 6170, "user_id": 298891, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fd9ce7b0801822fec42aa3ad28cebf1a?s=128&d=identicon&r=PG", "display_name": "Relativity", "link": "https://stackoverflow.com/users/298891/relativity"}, "edited": false, "score": 0, "creation_date": 1444264226, "post_id": 33004429, "comment_id": 53834031, "body": "As you are interested in index like others answered you really don&#39;t need &#39;+&#39;. Because in string: <code>some_words_v123124</code> the index of <code>_v1</code> is the same as <code>_v123124</code>"}], "tags": [], "owner": {"reputation": 5782, "user_id": 2832398, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/356c99a077310a35816f852423859f4c?s=128&d=identicon&r=PG&f=1", "display_name": "lilezek", "link": "https://stackoverflow.com/users/2832398/lilezek"}, "is_accepted": false, "score": 0, "last_activity_date": 1444262548, "creation_date": 1444262548, "answer_id": 33004429, "question_id": 33004400, "link": "https://stackoverflow.com/questions/33004400/regex-for-letter-v-preceded-by-underscore-and-followed-by-any-length-number/33004429#33004429", "title": "Regex for letter v preceded by underscore...and followed by any length number", "body": "<p>Use:</p>\n\n<pre><code>_v\\d+\n</code></pre>\n\n<p>As the regex you need.</p>\n"}, {"comments": [{"owner": {"reputation": 6170, "user_id": 298891, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fd9ce7b0801822fec42aa3ad28cebf1a?s=128&d=identicon&r=PG", "display_name": "Relativity", "link": "https://stackoverflow.com/users/298891/relativity"}, "edited": false, "score": 0, "creation_date": 1444263175, "post_id": 33004468, "comment_id": 53833751, "body": "Will single &quot;d&quot; take care of more than one digit it might have ?"}, {"owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "reply_to_user": {"reputation": 6170, "user_id": 298891, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fd9ce7b0801822fec42aa3ad28cebf1a?s=128&d=identicon&r=PG", "display_name": "Relativity", "link": "https://stackoverflow.com/users/298891/relativity"}, "edited": false, "score": 0, "creation_date": 1444263213, "post_id": 33004468, "comment_id": 53833762, "body": "No. But it does not seem to be needed, since we are interested in the index of <code>_</code> only."}, {"owner": {"reputation": 6170, "user_id": 298891, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fd9ce7b0801822fec42aa3ad28cebf1a?s=128&d=identicon&r=PG", "display_name": "Relativity", "link": "https://stackoverflow.com/users/298891/relativity"}, "edited": false, "score": 0, "creation_date": 1444263432, "post_id": 33004468, "comment_id": 53833824, "body": "It can be this way also - &quot;idh_abcdef_normal_verymuch_ext_v1&quot; .Just wanted to make sure that there is no alphabets after v[number]."}, {"owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "reply_to_user": {"reputation": 6170, "user_id": 298891, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fd9ce7b0801822fec42aa3ad28cebf1a?s=128&d=identicon&r=PG", "display_name": "Relativity", "link": "https://stackoverflow.com/users/298891/relativity"}, "edited": false, "score": 1, "creation_date": 1444263873, "post_id": 33004468, "comment_id": 53833933, "body": "@Relativity Do you mean that e.g. in <code>.._v1A</code> does not contain the substring because the number is followed by <code>A</code>? My code finds index of <code>_v&lt;digit&gt;</code> in <code>&lt;whatever&gt;_v&lt;digit&gt;&lt;whatever&gt;</code>."}], "tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": true, "score": 2, "last_activity_date": 1444263121, "last_edit_date": 1444263121, "creation_date": 1444262769, "answer_id": 33004468, "question_id": 33004400, "link": "https://stackoverflow.com/questions/33004400/regex-for-letter-v-preceded-by-underscore-and-followed-by-any-length-number/33004468#33004468", "title": "Regex for letter v preceded by underscore...and followed by any length number", "body": "<p>If you are sure that the string contains the given substring:</p>\n\n<pre><code>int index = Regex.Match(s, \"_v\\\\d\").Index;\n</code></pre>\n\n<p>otherwise</p>\n\n<pre><code>Match match = Regex.Match(s, \"_v\\\\d\");\nif (match.Success)\n    index = match.Index;\n</code></pre>\n"}], "owner": {"reputation": 6170, "user_id": 298891, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fd9ce7b0801822fec42aa3ad28cebf1a?s=128&d=identicon&r=PG", "display_name": "Relativity", "link": "https://stackoverflow.com/users/298891/relativity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 33004468, "answer_count": 4, "score": 1, "last_activity_date": 1444263121, "creation_date": 1444262369, "question_id": 33004400, "link": "https://stackoverflow.com/questions/33004400/regex-for-letter-v-preceded-by-underscore-and-followed-by-any-length-number", "title": "Regex for letter v preceded by underscore...and followed by any length number", "body": "<p>I have a string like below</p>\n\n<pre><code>string a= \"idh_abcdef_normal_verymuch_ext_v1_20131101000000\";\n</code></pre>\n\n<p>How do I find the index of \"_v1\" (small letter v followed by a number (<strong>of any length</strong>).</p>\n\n<p>Below code is not working :(</p>\n\n<pre><code>Console.WriteLine(System.Text.RegularExpressions.Regex.Match(a,\"^[v][0-9]$\").Index);\n</code></pre>\n\n<p>could someone help me please.</p>\n"}, {"tags": ["c#", "wpf", "events", "textbox", "handler"], "comments": [{"owner": {"reputation": 3536, "user_id": 733163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/KlDPn.jpg?s=128&g=1", "display_name": "Hopeless", "link": "https://stackoverflow.com/users/733163/hopeless"}, "edited": false, "score": 0, "creation_date": 1444262313, "post_id": 33004333, "comment_id": 53833486, "body": "this is a basic understanding about c# other than anything else. I can imagine that you&#39;ll have a hard time experiencing WPF (unless you are some XAML designer but now want to learn C#)."}, {"owner": {"reputation": 487, "user_id": 1638386, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cd610cd61227d5b1f612c6f8dd72a403?s=128&d=identicon&r=PG", "display_name": "dytori", "link": "https://stackoverflow.com/users/1638386/dytori"}, "edited": false, "score": 0, "creation_date": 1444286133, "post_id": 33004333, "comment_id": 53840562, "body": "Carefully inspect what the debugger says and google it before ask here."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 2999572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7764306b65d38f4670904e94bc717dec?s=128&d=identicon&r=PG&f=1", "display_name": "lukas.kurka", "link": "https://stackoverflow.com/users/2999572/lukas-kurka"}, "edited": false, "score": 0, "creation_date": 1444290611, "post_id": 33004431, "comment_id": 53843261, "body": "That is actually what I have there, made and error when trying to simplify the code for the question. Anyway I receive an error CS0123  C# No overload for &#39;doTheStuff&#39; matches delegate &#39;TextChangedEventHandler&#39;. Thanks"}, {"owner": {"reputation": 9649, "user_id": 773885, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/kOFz8.jpg?s=128&g=1", "display_name": "K Mehta", "link": "https://stackoverflow.com/users/773885/k-mehta"}, "reply_to_user": {"reputation": 35, "user_id": 2999572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7764306b65d38f4670904e94bc717dec?s=128&d=identicon&r=PG&f=1", "display_name": "lukas.kurka", "link": "https://stackoverflow.com/users/2999572/lukas-kurka"}, "edited": false, "score": 0, "creation_date": 1444327459, "post_id": 33004431, "comment_id": 53868285, "body": "your doTheStuff method must have the following signature: <code>void doTheStuff(object sender, System.Windows.Controls.TextChangedEventArgs e)</code>. Make sure that the namespace you&#39;re using for <code>TextChangedEventArgs</code> is correct."}, {"owner": {"reputation": 35, "user_id": 2999572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7764306b65d38f4670904e94bc717dec?s=128&d=identicon&r=PG&f=1", "display_name": "lukas.kurka", "link": "https://stackoverflow.com/users/2999572/lukas-kurka"}, "edited": false, "score": 0, "creation_date": 1444346090, "post_id": 33004431, "comment_id": 53877164, "body": "This actually did the stuff! Could you please explain why do I need to add the System.Windows.Controls in such case?"}, {"owner": {"reputation": 9649, "user_id": 773885, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/kOFz8.jpg?s=128&g=1", "display_name": "K Mehta", "link": "https://stackoverflow.com/users/773885/k-mehta"}, "reply_to_user": {"reputation": 35, "user_id": 2999572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7764306b65d38f4670904e94bc717dec?s=128&d=identicon&r=PG&f=1", "display_name": "lukas.kurka", "link": "https://stackoverflow.com/users/2999572/lukas-kurka"}, "edited": false, "score": 0, "creation_date": 1444674555, "post_id": 33004431, "comment_id": 53991998, "body": "You should read up on namespaces. There is plenty of information available on the web. That&#39;ll answer your question."}], "tags": [], "owner": {"reputation": 9649, "user_id": 773885, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/kOFz8.jpg?s=128&g=1", "display_name": "K Mehta", "link": "https://stackoverflow.com/users/773885/k-mehta"}, "is_accepted": true, "score": 2, "last_activity_date": 1444262887, "last_edit_date": 1444262887, "creation_date": 1444262554, "answer_id": 33004431, "question_id": 33004333, "link": "https://stackoverflow.com/questions/33004333/wpf-c-adding-event-handler-programmatically/33004431#33004431", "title": "WPF C# adding event handler programmatically", "body": "<p>Try:</p>\n\n<pre><code>pubAlt.TextChanged += new TextChangedEventHandler(doTheStuff);\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>pubAlt.TextChanged += doTheStuff;\n</code></pre>\n\n<p>Both lines do the same thing. The second one is just shorthand for the first line since it makes code easier to read.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 2999572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7764306b65d38f4670904e94bc717dec?s=128&d=identicon&r=PG&f=1", "display_name": "lukas.kurka", "link": "https://stackoverflow.com/users/2999572/lukas-kurka"}, "edited": false, "score": 0, "creation_date": 1444290747, "post_id": 33004616, "comment_id": 53843333, "body": "That is actually what I have there, made and error when trying to simplify the code for the question. Anyway I receive an error CS0123  C# No overload for &#39;doTheStuff&#39; matches delegate &#39;TextChangedEventHandler&#39; Thanks"}, {"owner": {"reputation": 10214, "user_id": 493389, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5c3f772d7effe2eda5d93e76aa1a4edb?s=128&d=identicon&r=PG&f=1", "display_name": "123 456 789 0", "link": "https://stackoverflow.com/users/493389/123-456-789-0"}, "reply_to_user": {"reputation": 35, "user_id": 2999572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7764306b65d38f4670904e94bc717dec?s=128&d=identicon&r=PG&f=1", "display_name": "lukas.kurka", "link": "https://stackoverflow.com/users/2999572/lukas-kurka"}, "edited": false, "score": 0, "creation_date": 1444324092, "post_id": 33004616, "comment_id": 53866467, "body": "I updated the code. I assume you had your parameter the same as the event handler."}], "tags": [], "owner": {"reputation": 10214, "user_id": 493389, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5c3f772d7effe2eda5d93e76aa1a4edb?s=128&d=identicon&r=PG&f=1", "display_name": "123 456 789 0", "link": "https://stackoverflow.com/users/493389/123-456-789-0"}, "is_accepted": false, "score": 0, "last_activity_date": 1444324117, "last_edit_date": 1444324117, "creation_date": 1444263886, "answer_id": 33004616, "question_id": 33004333, "link": "https://stackoverflow.com/questions/33004333/wpf-c-adding-event-handler-programmatically/33004616#33004616", "title": "WPF C# adding event handler programmatically", "body": "<p>You are invoking the method using <code>()</code>. Change your code to be like this:</p>\n\n<pre><code>pubAlt.TextChanged += new System.EventHandler((s,e) =&gt; doTheStuff());\npubAlt.TextChanged += RoutedEventHandler((s,e) =&gt;calculateCorAlts());\n</code></pre>\n\n<p>Your method are not matching what it was asking for.</p>\n"}], "owner": {"reputation": 35, "user_id": 2999572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7764306b65d38f4670904e94bc717dec?s=128&d=identicon&r=PG&f=1", "display_name": "lukas.kurka", "link": "https://stackoverflow.com/users/2999572/lukas-kurka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3273, "favorite_count": 0, "accepted_answer_id": 33004431, "answer_count": 2, "score": 2, "last_activity_date": 1444324117, "creation_date": 1444261943, "question_id": 33004333, "link": "https://stackoverflow.com/questions/33004333/wpf-c-adding-event-handler-programmatically", "title": "WPF C# adding event handler programmatically", "body": "<p>In my code I create an array of TextBoxes :</p>\n\n<pre><code>namespace TCalc\n{\n    public partial class MainWindow : Window\n    {\n        public TextBox[] pubAltArray;\n\n        public MainWindow()\n        {\n            InitializeComponent();\n\n            pubAltArray = new TextBox[10];\n</code></pre>\n\n<p>Then I create the TextBoxes programmatically using the following code :</p>\n\n<pre><code>private void generatePublishedTxtBox()\n{\n    for (int i = 0; i &lt; 10; i++)\n    {\n        TextBox pubAlt = new TextBox();\n        grid_profile.Children.Add(pubAlt);\n        pubAlt.SetValue(Grid.RowProperty, 1);\n        ...\n        pubAltArray[i] = pubAlt;\n    }\n}\n</code></pre>\n\n<p>Than I have some routine I want to run when the content of each TextBox changes :</p>\n\n<pre><code>private void doTheStuff(object sender, TextChangedEventArgs e)\n{\n...\n} \n</code></pre>\n\n<p>So I tried to add event handler during the definition of new TextBox however without success :</p>\n\n<pre><code>pubAlt.TextChanged += new System.EventHandler(doTheStuff());\n</code></pre>\n\n<p>or</p>\n\n<pre><code>pubAlt.TextChanged += RoutedEventHandler(calculateCorAlts());\n</code></pre>\n\n<p>Any hint for me?</p>\n"}, {"tags": ["c#", "if-statement"], "comments": [{"owner": {"reputation": 19939, "user_id": 325727, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e098b1ade159310d7a4d6405eebd930a?s=128&d=identicon&r=PG&f=1", "display_name": "JK.", "link": "https://stackoverflow.com/users/325727/jk"}, "edited": false, "score": 3, "creation_date": 1444262206, "post_id": 33004319, "comment_id": 53833449, "body": "Excuse me? Watch your language in questions please."}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 1, "creation_date": 1444262461, "post_id": 33004319, "comment_id": 53833533, "body": "You don&#39;t need to tell us what you can use, these questions are intended to help everyone, not just you."}, {"owner": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 0, "creation_date": 1444262855, "post_id": 33004319, "comment_id": 53833648, "body": "Forgot to edit that part out when writting it here. Sorry about that!"}, {"owner": {"reputation": 1360, "user_id": 753471, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc180a31ec5feada554c75c61ce5c718?s=128&d=identicon&r=PG", "display_name": "monty", "link": "https://stackoverflow.com/users/753471/monty"}, "edited": false, "score": 0, "creation_date": 1444263207, "post_id": 33004319, "comment_id": 53833759, "body": "@Dr. Roflcopter The term &quot;p*** off&quot; is considered offensive language. I&#39;ve edited it to say &quot;go away&quot; (pending approval).  You may find yourself using this site a lot in your career, and if some potential employer were to discover your handle here and read that, well, it&#39;s just not a good look. Welcome to stackoverflow!"}, {"owner": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 0, "creation_date": 1444264014, "post_id": 33004319, "comment_id": 53833968, "body": "Thank you for the tip! I&#39;ll keep that in mind next time I&#39;ll post here."}], "answers": [{"comments": [{"owner": {"reputation": 19939, "user_id": 325727, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e098b1ade159310d7a4d6405eebd930a?s=128&d=identicon&r=PG&f=1", "display_name": "JK.", "link": "https://stackoverflow.com/users/325727/jk"}, "edited": false, "score": 0, "creation_date": 1444262335, "post_id": 33004362, "comment_id": 53833491, "body": "Bradly .. isn&#39;t this question way too broad?  It just states a bunch of requirements and doesn&#39;t even have an actual question.  So why answer it?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 19939, "user_id": 325727, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e098b1ade159310d7a4d6405eebd930a?s=128&d=identicon&r=PG&f=1", "display_name": "JK.", "link": "https://stackoverflow.com/users/325727/jk"}, "edited": false, "score": 1, "creation_date": 1444262403, "post_id": 33004362, "comment_id": 53833513, "body": "@JK. He has a problem statement: &quot;The problem that I have in my code is that one of the last conditions ( if (ans == nb3)) never executes even&quot; and shows his attempt. My answer shows he was just missing one critical piece. I agree its not going to win question of the year, but as far as homework questions go, it was decent."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "reply_to_user": {"reputation": 19939, "user_id": 325727, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e098b1ade159310d7a4d6405eebd930a?s=128&d=identicon&r=PG&f=1", "display_name": "JK.", "link": "https://stackoverflow.com/users/325727/jk"}, "edited": false, "score": 0, "creation_date": 1444262447, "post_id": 33004362, "comment_id": 53833528, "body": "@JK with the code that&#39;s presented it&#39;s not that broad that the difference from thinking outside the box and being able to quickly refactor the code into a working solution using a different type of loop.."}, {"owner": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 0, "creation_date": 1444262465, "post_id": 33004362, "comment_id": 53833534, "body": "Thank you for the comment but it did not solve my problem. The problem is that the console wouldn&#39;t close after you failed 2 times and get the right answer. It would keep going until &quot;i&quot; hits 8."}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 1, "creation_date": 1444262555, "post_id": 33004362, "comment_id": 53833557, "body": "@Dr.Roflcopter Right... because you never assigned the input variable in the loop. Did you try my suggestion? Note that &quot;Bravo&quot; won&#39;t be printed, but would be trivial to add, the program currently will just end when the correct answer was inputted"}, {"owner": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 0, "creation_date": 1444262723, "post_id": 33004362, "comment_id": 53833608, "body": "<a href=\"http://i.imgur.com/T9RUABs.png\" rel=\"nofollow noreferrer\">i.imgur.com/T9RUABs.png</a> - I did what you said but it wouldn&#39;t work. Am I missing something?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 0, "creation_date": 1444262991, "post_id": 33004362, "comment_id": 53833694, "body": "@Dr.Roflcopter I would set a breakpoint on the if statement and see what <code>nb3</code> and <code>ans</code> are. It looks right to me though. If the values are correct, see if you break is working as expected."}, {"owner": {"reputation": 1360, "user_id": 753471, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bc180a31ec5feada554c75c61ce5c718?s=128&d=identicon&r=PG", "display_name": "monty", "link": "https://stackoverflow.com/users/753471/monty"}, "edited": false, "score": 0, "creation_date": 1444263476, "post_id": 33004362, "comment_id": 53833837, "body": "And if you can&#39;t set a breakpoint, just printout ans and nb3 after each new nb3 has been parsed."}, {"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 1, "creation_date": 1444263505, "post_id": 33004362, "comment_id": 53833845, "body": "<a href=\"http://ideone.com/Y8p7vV\" rel=\"nofollow noreferrer\">I put it in ideone and got the expected result</a>. (Added some print statements for clarity though.)"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 0, "creation_date": 1444263619, "post_id": 33004362, "comment_id": 53833872, "body": "@31eee384 Appreciate the sanity check :)"}, {"owner": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 0, "creation_date": 1444263960, "post_id": 33004362, "comment_id": 53833951, "body": "I&#39;ve rechecked the code and realised I made a VERY stupid mistake when editing it earlier. Thank you for the help Bradley, your fix worked. Hope that putting up with my very little knowlege in C# wasn&#39;t too painful for ya."}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "edited": false, "score": 0, "creation_date": 1444264049, "post_id": 33004362, "comment_id": 53833978, "body": "@Dr.Roflcopter Like I told JK, your question was decent for a beginner/homework one, if anything you just included a little too <i>much</i> information (far better than including too little). Your coding style will get better and more mature in time I&#39;m sure :)"}], "tags": [], "owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "is_accepted": true, "score": 3, "last_activity_date": 1444262089, "creation_date": 1444262089, "answer_id": 33004362, "question_id": 33004319, "link": "https://stackoverflow.com/questions/33004319/if-part-not-executing-c/33004362#33004362", "title": "&quot;If&quot; part not executing (C#)", "body": "<p>You never re-assign your input variable in the for loop:</p>\n\n<pre><code> for (int t = 1; t &lt; 8; t++)\n {  \n     Console.WriteLine(\"Quel est la reponse?\");\n     Console.ReadLine();\n     if (ans == nb3)\n         break;   \n }\n</code></pre>\n\n<p>Notice that you do nothing with the return value of <code>Console.ReadLine</code>. You need</p>\n\n<pre><code>for (int t = 1; t &lt; 8; t++)\n{  \n    Console.WriteLine(\"Quel est la reponse?\");\n    nb3 = int.Parse(Console.ReadLine());\n      if (ans == nb3)\n         break;    \n}\n</code></pre>\n\n<p>So that the new user input will be compared against <code>ans</code> instead of the previously entered value.</p>\n\n<p>As a matter of style, try to avoid variable names like \"nb1\" \"nb2\" and \"nb3\" as they are not very descriptive. Also, if you have numbered variables like that, its almost a surefire bet that you need an <em>array</em> instead of multiple variables.</p>\n"}], "owner": {"reputation": 45, "user_id": 5420760, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/h2DTc.png?s=128&g=1", "display_name": "Dr.Roflcopter", "link": "https://stackoverflow.com/users/5420760/dr-roflcopter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 33004362, "answer_count": 1, "score": -1, "last_activity_date": 1444263042, "creation_date": 1444261875, "last_edit_date": 1444263042, "question_id": 33004319, "link": "https://stackoverflow.com/questions/33004319/if-part-not-executing-c", "title": "&quot;If&quot; part not executing (C#)", "body": "<p>As a part of my programming class, I'm fairly new to it so I need some help.</p>\n\n<p>I have to create a program that does the following (loosely translated) :</p>\n\n<ol>\n<li><p>Create a program that will let a child practice his mathematics;</p></li>\n<li><p>Make him type in a number, an arithmetic operator, another number and finally, the answer to the equation;</p></li>\n<li><p>If the answer to said equation is correct, display a message saying \"Bravo\";</p></li>\n<li><p>If the answer is NOT correct. make him type in another answer.  He has a maximum of 8 chances (including the first one); and</p></li>\n<li><p>If after 8 tries he still doesn't get the answer to his own equation, you can tell him to go take a break.</p></li>\n</ol>\n\n<p>The problem that I have in my code is that one of the last conditions ( if (ans == nb3)) never executes even. </p>\n\n<p>For example, I'd type in 1 - 1 = 5. It would say that my answer is <code>false</code> and that I need to type another answer, to this point, everything is fine. If I were to type in the right answer after that ( 1 - 1 = 0 ), it would still ask me to type in another answer instead of breaking the loop.</p>\n\n<p>The current state of my program:</p>\n\n<pre><code>        int nb1, nb2, nb3, ans = 0;\n        string op;\n        Console.WriteLine(\"Entrez un premier chiffre\");\n        nb1 = Convert.ToInt32(Console.ReadLine());\n        Console.WriteLine(\"Entrez un operateur arithmetique \");\n        op = Convert.ToString(Console.ReadLine());\n        Console.WriteLine(\"Entrez un deuxieme chiffre\");\n        nb2 = Convert.ToInt32(Console.ReadLine());\n        Console.WriteLine(\"Quel est la reponse\");\n        nb3 = Convert.ToInt32(Console.ReadLine());\n\n\n        switch (op)\n        {\n\n            case (\"+\"):\n            case (\"plus\"):\n                ans = nb1 + nb2;\n                break;\n\n            case (\"-\"):\n            case (\"moins\"):\n                ans = nb1 - nb2;\n                break;\n\n            case (\"*\"):\n            case (\"multiplie\"):\n                ans = nb1 * nb2;\n                break;\n\n            case (\"/\"):\n            case (\"divise\"):\n                ans = nb1 / nb2;\n                break;\n        }\n\n        if (ans == nb3)\n            Console.WriteLine(\"Bravo\");\n\n        else\n        {\n            Console.WriteLine(\"Mauvaise reponse\");\n            for (int t = 1; t &lt; 8; t++)\n            {\n\n                Console.WriteLine(\"Quel est la reponse?\");\n                Console.ReadLine();\n                    if (ans == nb3)\n                    {\n                        break;\n                    }\n\n               }\n            }\n\n        }\n    }\n\n}     \n</code></pre>\n"}, {"tags": ["c#", ".net", "object"], "comments": [{"owner": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 1, "creation_date": 1444261857, "post_id": 33004296, "comment_id": 53833369, "body": "So...what&#39;s the question exactly?"}, {"owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "reply_to_user": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1444261981, "post_id": 33004296, "comment_id": 53833396, "body": "I need to add additional name value pairs to the existing object in c# @MikeH"}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 1, "creation_date": 1444262261, "post_id": 33004296, "comment_id": 53833463, "body": "Sounds like what you really want is a collection - like a <code>List&lt;T&gt;</code> or an array."}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 1, "creation_date": 1444262287, "post_id": 33004296, "comment_id": 53833474, "body": "Or maybe just a dictionary..."}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "reply_to_user": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1444262311, "post_id": 33004296, "comment_id": 53833485, "body": "@BradleyDotNET - Good point.  I hadn&#39;t thought of that."}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444262567, "post_id": 33004296, "comment_id": 53833563, "body": "Can you provide a little more context to your question?  Are you dealing with anonymous types or JSON or something else?"}, {"owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1444262585, "post_id": 33004296, "comment_id": 53833567, "body": "I am using SmartFormat .Net library <a href=\"https://github.com/scottrippey/SmartFormat.NET\" rel=\"nofollow noreferrer\">link</a> . It accepts (&quot;String&quot;,obj) to be passed to format the string. However, I already have this (&quot;String&quot;, obj) and I need to add some more field values in the obj"}, {"owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1444262688, "post_id": 33004296, "comment_id": 53833597, "body": "Eg: Smart.Format(&quot; Your Name is {Name}, new { Name = &quot;someName&quot;}. Need to add for eg {Age = &quot;10&quot;} to the above object."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1444262244, "post_id": 33004355, "comment_id": 53833458, "body": "someObj1 already has some items (count - unknown). And I need to add some new items.  Also, the members present in it is unknown (name1, or something else)"}, {"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "reply_to_user": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1444264060, "post_id": 33004355, "comment_id": 53833979, "body": "You can either do something like <code>var someObj2 = new {firstObj = someObj1, name2 = &quot;name 2&quot;};</code> and then access the values from the new child type, declare the anonymous type with all of it&#39;s values at once, or use a Dictionary&lt;string,obj&gt; instead of an anonymous type as that seems more appropriate for this use case."}], "tags": [], "owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "is_accepted": false, "score": 2, "last_activity_date": 1444262041, "creation_date": 1444262041, "answer_id": 33004355, "question_id": 33004296, "link": "https://stackoverflow.com/questions/33004296/add-members-to-object-in-c/33004355#33004355", "title": "Add members to object in c#", "body": "<p>You can either instantiate it all at once:</p>\n\n<pre><code>var someObj = new {name1 = \"name 1\", name2 = \"name 2\"};\n</code></pre>\n\n<p>Or you can do it in steps.</p>\n\n<pre><code>var someObj1 = new {name1 = \"name 1\"};\nvar someObj2 = new {name1 = someObj1.name1, name2 = \"name 2\"};\n</code></pre>\n\n<p>But no, you can't add properties/field to anonymous types at run-time or after it's been instantiated.</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1444262196, "post_id": 33004358, "comment_id": 53833445, "body": "It doesnt allow me to access obj1.name1. Also the number of items already presen tin obj1 is unknown @jakub-lortz"}], "tags": [], "owner": {"reputation": 13828, "user_id": 4588915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTCr8.png?s=128&g=1", "display_name": "Jakub Lortz", "link": "https://stackoverflow.com/users/4588915/jakub-lortz"}, "is_accepted": false, "score": 1, "last_activity_date": 1444262046, "creation_date": 1444262046, "answer_id": 33004358, "question_id": 33004296, "link": "https://stackoverflow.com/questions/33004296/add-members-to-object-in-c/33004358#33004358", "title": "Add members to object in c#", "body": "<p>You have to create a new object, of a new anonymous type:</p>\n\n<pre><code>var obj1 = new {name1 = \"string1\"};\nvar obj2 = new {name1 = obj1.name1, name2 = \"string2\" };\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444262046, "creation_date": 1444261764, "question_id": 33004296, "link": "https://stackoverflow.com/questions/33004296/add-members-to-object-in-c", "title": "Add members to object in c#", "body": "<p>I have an object created by - <code>new {name1 = \"string1\"}</code>\nI have to add additional members to it eg <code>{name2 = \"string2\"}</code> so that the final result is</p>\n\n<p><code>{\nname1 = \"string1\",\nname2 = \"string2\"\n}</code></p>\n"}, {"tags": ["c#", "stylecop", "remarks"], "answers": [{"comments": [{"owner": {"reputation": 376, "user_id": 63209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1792a1d9c694d461bd262a09071756?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/63209/paul"}, "edited": false, "score": 0, "creation_date": 1494455194, "post_id": 36669833, "comment_id": 74841271, "body": "Though the <code>href</code> attribute is <a href=\"https://docs.microsoft.com/en-us/dotnet/articles/csharp/programming-guide/xmldoc/see\" rel=\"nofollow noreferrer\">not documented by MS</a>, the VS compiler seems happy with it. And, for what it&#39;s worth, Sandcastle Help File Builder deals with it nicely as well (it creates a proper link)."}], "tags": [], "owner": {"reputation": 892, "user_id": 1501861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebeeb7f06a0b83f3ce8bfecbdca41e7?s=128&d=identicon&r=PG", "display_name": "Yanal-Yves Fargialla", "link": "https://stackoverflow.com/users/1501861/yanal-yves-fargialla"}, "is_accepted": false, "score": 9, "last_activity_date": 1460841243, "creation_date": 1460841243, "answer_id": 36669833, "question_id": 33004273, "link": "https://stackoverflow.com/questions/33004273/workaround-for-stylecop-sa1650-catching-url-as-misspelled-word-without-warning-s/36669833#36669833", "title": "Workaround for StyleCop SA1650 catching URL as misspelled word without warning suppression", "body": "<p>I believe using http links in comments is a good practice.</p>\n\n<p>Use </p>\n\n<pre><code>&lt;see href=\"http://myurl.com/\"/&gt; \n</code></pre>\n\n<p>when inserting a URL in your comments as answered <a href=\"http://stylecop.codeplex.com/workitem/7486\" rel=\"noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1527, "user_id": 983173, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917713e9f48b9aa4edad601dc3a1d84a?s=128&d=identicon&r=PG", "display_name": "Steverino", "link": "https://stackoverflow.com/users/983173/steverino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1769, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1460841243, "creation_date": 1444261631, "question_id": 33004273, "link": "https://stackoverflow.com/questions/33004273/workaround-for-stylecop-sa1650-catching-url-as-misspelled-word-without-warning-s", "title": "Workaround for StyleCop SA1650 catching URL as misspelled word without warning suppression", "body": "<p>I'm trying to include a URL in my remarks as shown in the example below.  This causes StyleCop to report a warning based on rule SA1650 (misspelled word in remarks), which for our purposes can't be suppressed (by policy).  This warning is no surprise because URL syntax doesn't demand proper English spelling.</p>\n\n<pre><code>...\n\n/// &lt;remarks&gt;\n/// &lt;para&gt;... some remarks ...&lt;/para&gt;\n/// &lt;para&gt;http://www.foo.wtvr.com&lt;/para&gt;\n/// &lt;para&gt;... some other remarks ...&lt;/para&gt;\n/// &lt;/remarks&gt;\n\n...\n</code></pre>\n\n<p>First off, is it considered bad practice to include URLs in summary/remarks?  I'd guess not since Visual Studio recognizes links and makes them clickable.  I'll remove it if necessary but I'd like to leave the reference there for others.</p>\n\n<p>If this <em>isn't</em> considered bad practice, is there a way to get StyleCop to ignore URL text <em>without</em> suppressing the warning (or adding the entire URL or each part of it to the list of recognized words)?  I have tried the following (four forward slashes on URL's line) but that results instead in a warning from rule SA1644 (no blank lines allowed in documentation headers):</p>\n\n<pre><code>...\n\n/// &lt;remarks&gt;\n/// &lt;para&gt;... some remarks ...&lt;/para&gt;\n//// &lt;para&gt;http://www.foo.wtvr.com&lt;/para&gt;\n/// &lt;para&gt;... some other remarks ...&lt;/para&gt;\n/// &lt;/remarks&gt;\n\n...\n</code></pre>\n\n<p>My current solution is to use the comment-in-comment tags, as shown below, which yields no warnings, but I don't know if this is best practice:</p>\n\n<pre><code>...\n\n/// &lt;remarks&gt;\n/// &lt;para&gt;... some remarks ...&lt;/para&gt;\n/// &lt;para&gt;&lt;!--http://www.foo.wtvr.com--&gt;&lt;/para&gt;\n/// &lt;para&gt;... some other remarks ...&lt;/para&gt;\n/// &lt;/remarks&gt;\n\n...\n</code></pre>\n\n<p>Help me document my code better.</p>\n"}, {"tags": ["c#", "regex", "parsing"], "comments": [{"owner": {"reputation": 19939, "user_id": 325727, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e098b1ade159310d7a4d6405eebd930a?s=128&d=identicon&r=PG&f=1", "display_name": "JK.", "link": "https://stackoverflow.com/users/325727/jk"}, "edited": false, "score": 1, "creation_date": 1444261640, "post_id": 33004143, "comment_id": 53833321, "body": "And what have you tried in order to solve this by yourself?  Questions that do not show any effort are viewed as being very lazy and will more likely than not get closed."}, {"owner": {"reputation": 2801, "user_id": 2877058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fMUyx.jpg?s=128&g=1", "display_name": "WhiteViking", "link": "https://stackoverflow.com/users/2877058/whiteviking"}, "edited": false, "score": 0, "creation_date": 1444261846, "post_id": 33004143, "comment_id": 53833368, "body": "Welcome to Stack Overflow! Have a look around. Please read <a href=\"http://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> to get an idea of the kind of questions that are likely to get an answer here. Your question does not describe the work you have done so far yourself. Try solving the problem yourself first."}], "answers": [{"comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444260981, "post_id": 33004153, "comment_id": 53833170, "body": "What is it with developers and always wanting to use RegEx for simple string functions?"}, {"owner": {"reputation": 27179, "user_id": 710099, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0413774874b9baeccef7a5ba0344fec7?s=128&d=identicon&r=PG", "display_name": "Federico Piazza", "link": "https://stackoverflow.com/users/710099/federico-piazza"}, "reply_to_user": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444261499, "post_id": 33004153, "comment_id": 53833286, "body": "@Tim lol, but if you create a regex with capturing group then a loop to iterate over all the capturing groups, grab its content and push it into an array can achieve the same goal! lol. I don&#39;t understand the downvoter"}, {"owner": {"reputation": 41, "user_id": 5420602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4a4f385108e1ba9315df3d9cbd8b588?s=128&d=identicon&r=PG&f=1", "display_name": "ngm_code", "link": "https://stackoverflow.com/users/5420602/ngm-code"}, "edited": false, "score": 0, "creation_date": 1444360058, "post_id": 33004153, "comment_id": 53880652, "body": "Simple and clear solution.  It works, thank you!"}], "tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": true, "score": 3, "last_activity_date": 1444260683, "creation_date": 1444260683, "answer_id": 33004153, "question_id": 33004143, "link": "https://stackoverflow.com/questions/33004143/parse-an-ip-address-string-into-segments-with-regular-expression-in-c/33004153#33004153", "title": "Parse an IP address string into segments with regular expression in C#", "body": "<p>You could just use <a href=\"https://msdn.microsoft.com/en-us/library/system.string.split%28v=vs.110%29.aspx\" rel=\"nofollow\">Split</a>:</p>\n\n<pre><code>string ip = \"100.5.10.15\";\nstring[] parts = ip.Split('.');\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2953, "user_id": 551322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2272a6dda4a161db846fdddf94c09c0e?s=128&d=identicon&r=PG", "display_name": "nrodic", "link": "https://stackoverflow.com/users/551322/nrodic"}, "edited": false, "score": 0, "creation_date": 1444400890, "post_id": 33004267, "comment_id": 53902235, "body": "Perfect! Thanks for pointing to <code>System.Net.IPAddress</code>."}], "tags": [], "owner": {"reputation": 2487, "user_id": 5380314, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8924d6d1c2470b1d7c8190dc37ef517c?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Nasonov", "link": "https://stackoverflow.com/users/5380314/andrey-nasonov"}, "is_accepted": false, "score": 4, "last_activity_date": 1444276950, "last_edit_date": 1592644375, "creation_date": 1444261566, "answer_id": 33004267, "question_id": 33004143, "link": "https://stackoverflow.com/questions/33004143/parse-an-ip-address-string-into-segments-with-regular-expression-in-c/33004267#33004267", "title": "Parse an IP address string into segments with regular expression in C#", "body": "<p>I recommend you to use <code>IPAddress.Parse</code> and <code>IPAddress.TryParse</code> methods to parse IP address string.</p>\n<p>The reason is described <a href=\"https://superuser.com/questions/486788/why-does-pinging-192-168-072-only-2-dots-return-a-response-from-192-168-0-58\">here</a>. String representation of IPv4 address is rather more complicated than 4 numbers separated by dot symbol. For example, the following strings are correct representations of the same IP address:</p>\n<blockquote>\n<p>74.125.226.4  (dotted decimal)</p>\n<p>1249763844  (flat decimal)</p>\n<p>0112.0175.0342.0004  (dotted octal)</p>\n<p>011237361004  (flat octal)</p>\n<p>0x4A.0x7D.0xE2.0x04  (dotted hex)</p>\n<p>0x4A7DE204  (flat hex)</p>\n<p>74.0175.0xe2.4  (\u0ca0_\u0ca0)</p>\n</blockquote>\n<p>In case if you still want to parse IP addresses manually and allow using only 4-number dotted decimal representation, I suggest you to use something like this:</p>\n<pre><code>^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$\n</code></pre>\n<p><em>Note: this regex is still not correct because it allows leading zeros (014.2.3.4)</em></p>\n"}], "owner": {"reputation": 41, "user_id": 5420602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4a4f385108e1ba9315df3d9cbd8b588?s=128&d=identicon&r=PG&f=1", "display_name": "ngm_code", "link": "https://stackoverflow.com/users/5420602/ngm-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "closed_date": 1444286050, "accepted_answer_id": 33004153, "answer_count": 2, "score": -3, "last_activity_date": 1444360009, "creation_date": 1444260617, "last_edit_date": 1444360009, "question_id": 33004143, "link": "https://stackoverflow.com/questions/33004143/parse-an-ip-address-string-into-segments-with-regular-expression-in-c", "closed_reason": "Not suitable for this site", "title": "Parse an IP address string into segments with regular expression in C#", "body": "<p><em>This question has been updated to improve its rating</em></p>\n\n<p>Language Environment:\nC#</p>\n\n<p>Desired Outcome:</p>\n\n<ul>\n<li>Use regular expressions to parse an IP address from a string.</li>\n<li>Use <code>Regex.Split()</code> to parse an IP address into individual segments and store them as individual string objects in an array.</li>\n</ul>\n\n<p>Starting with:</p>\n\n<pre><code>\"IP=100.5.10.15\"\n</code></pre>\n\n<p>Get to a <code>string[] ipAdrSegments</code> populated with:</p>\n\n<pre><code>ipSeg0 = \"100\"\nipSeg1 = \"5\"\nipSeg2 = \"10\"\nipSeg3 = \"15\"\n</code></pre>\n"}, {"tags": ["c#", ".net", "clipboard", "unmanaged", "intptr"], "comments": [{"owner": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1444260384, "post_id": 33003958, "comment_id": 53833018, "body": "Have you looked at the example provided here: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms649016(v=vs.85).aspx#_win32_Copying_Information_to_the_Clipboard\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a>"}, {"owner": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "reply_to_user": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 1, "creation_date": 1444260528, "post_id": 33003958, "comment_id": 53833047, "body": "@Roy It&#39;s a built in function, see the link provided by the OP"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "reply_to_user": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1444260647, "post_id": 33003958, "comment_id": 53833078, "body": "@MikeH Ah I missed that first link.  Still would have been nice to see the p-invoke specification just to be sure"}, {"owner": {"reputation": 2151, "user_id": 435418, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61b9beb5c479e01e74c2bcbe0a503891?s=128&d=identicon&r=PG", "display_name": "CODe", "link": "https://stackoverflow.com/users/435418/code"}, "reply_to_user": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1444260647, "post_id": 33003958, "comment_id": 53833079, "body": "@MikeH - I have seen that example. I&#39;m not great with C++, but isn&#39;t this for copying TO the clipboard? I&#39;m just trying to get the data off of it. I didn&#39;t see what I could try to convert to C# from this to work for my needs."}, {"owner": {"reputation": 2151, "user_id": 435418, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61b9beb5c479e01e74c2bcbe0a503891?s=128&d=identicon&r=PG", "display_name": "CODe", "link": "https://stackoverflow.com/users/435418/code"}, "reply_to_user": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 1, "creation_date": 1444260768, "post_id": 33003958, "comment_id": 53833107, "body": "@Roy I&#39;ll provide the pinvoke for ya. See edit."}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 3, "creation_date": 1444260993, "post_id": 33003958, "comment_id": 53833175, "body": "<code>data</code> is actually a <i>handle</i> not a direct pointer to memory.  You need to <i>lock it</i>  using <code>GlobalLock()</code> in order to get the memory block.  <a href=\"http://stackoverflow.com/questions/14762456/getclipboarddatacf-text\">See this answer here</a>.  It&#39;s c++ but you get the idea.  Any reason you are not just using the .NET <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.clipboard(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Clipboard</a> class?"}, {"owner": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 1, "creation_date": 1444261146, "post_id": 33003958, "comment_id": 53833206, "body": "There is a second example further on which shows retrieving info from the clipboard."}, {"owner": {"reputation": 2151, "user_id": 435418, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61b9beb5c479e01e74c2bcbe0a503891?s=128&d=identicon&r=PG", "display_name": "CODe", "link": "https://stackoverflow.com/users/435418/code"}, "reply_to_user": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1444261619, "post_id": 33003958, "comment_id": 53833316, "body": "@MikeH Ahh, I see it. Missed that, looks like it&#39;s reinforcing what Roy mentions."}], "answers": [{"comments": [{"owner": {"reputation": 2151, "user_id": 435418, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61b9beb5c479e01e74c2bcbe0a503891?s=128&d=identicon&r=PG", "display_name": "CODe", "link": "https://stackoverflow.com/users/435418/code"}, "edited": false, "score": 0, "creation_date": 1444586913, "post_id": 33007795, "comment_id": 53955000, "body": "Thanks for spelling it out, while I had figured it out already from the comments above, I do appreciate your answer."}], "tags": [], "owner": {"reputation": 906, "user_id": 3137337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B78pY.png?s=128&g=1", "display_name": "emoacht", "link": "https://stackoverflow.com/users/3137337/emoacht"}, "is_accepted": true, "score": 8, "last_activity_date": 1444284298, "creation_date": 1444284298, "answer_id": 33007795, "question_id": 33003958, "link": "https://stackoverflow.com/questions/33003958/getting-byte-from-getclipboarddata-native-method/33007795#33007795", "title": "Getting byte[] from GetClipboardData native method", "body": "<p>If you want to get byte array from clipboard, which represents unicode text for example, the code will be something like this:</p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\npublic class ClipboardHelper\n{\n    #region Win32\n\n    [DllImport(\"User32.dll\", SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    private static extern bool IsClipboardFormatAvailable(uint format);\n\n    [DllImport(\"User32.dll\", SetLastError = true)]\n    private static extern IntPtr GetClipboardData(uint uFormat);\n\n    [DllImport(\"User32.dll\", SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    private static extern bool OpenClipboard(IntPtr hWndNewOwner);\n\n    [DllImport(\"User32.dll\", SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    private static extern bool CloseClipboard();\n\n    [DllImport(\"Kernel32.dll\", SetLastError = true)]\n    private static extern IntPtr GlobalLock(IntPtr hMem);\n\n    [DllImport(\"Kernel32.dll\", SetLastError = true)]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    private static extern bool GlobalUnlock(IntPtr hMem);\n\n    [DllImport(\"Kernel32.dll\", SetLastError = true)]\n    private static extern int GlobalSize(IntPtr hMem);\n\n    private const uint CF_UNICODETEXT = 13U;\n\n    #endregion\n\n    public static string GetText()\n    {\n        if (!IsClipboardFormatAvailable(CF_UNICODETEXT))\n            return null;\n\n        try\n        {\n            if (!OpenClipboard(IntPtr.Zero))\n                return null;\n\n            IntPtr handle = GetClipboardData(CF_UNICODETEXT);\n            if (handle == IntPtr.Zero)\n                return null;\n\n            IntPtr pointer = IntPtr.Zero;\n\n            try\n            {\n                pointer = GlobalLock(handle);\n                if (pointer == IntPtr.Zero)\n                    return null;\n\n                int size = GlobalSize(handle);\n                byte[] buff = new byte[size];\n\n                Marshal.Copy(pointer, buff, 0, size);\n\n                return Encoding.Unicode.GetString(buff).TrimEnd('\\0');\n            }\n            finally\n            {\n                if (pointer != IntPtr.Zero)\n                    GlobalUnlock(handle);\n            }\n        }\n        finally\n        {\n            CloseClipboard();\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2151, "user_id": 435418, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/61b9beb5c479e01e74c2bcbe0a503891?s=128&d=identicon&r=PG", "display_name": "CODe", "link": "https://stackoverflow.com/users/435418/code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2188, "favorite_count": 2, "accepted_answer_id": 33007795, "answer_count": 1, "score": 0, "last_activity_date": 1444586824, "creation_date": 1444259459, "last_edit_date": 1444586824, "question_id": 33003958, "link": "https://stackoverflow.com/questions/33003958/getting-byte-from-getclipboarddata-native-method", "title": "Getting byte[] from GetClipboardData native method", "body": "<p>I'm trying to get the Clipboard data using <a href=\"http://msdn.microsoft.com/en-us/library/windows/desktop/ms649039(v=vs.85).aspx\" rel=\"nofollow\">this native method</a> with C#/.NET. The problem is I'm mangling the data. Here's my code:</p>\n\n<pre><code>IntPtr pointer = GetClipboardData(dataformat);\nint size = Marshal.SizeOf(pointer);\nbyte[] buff = new byte[size];\nMarshal.Copy(data, buff, 0, size);\n</code></pre>\n\n<p>Here's the pinvoke I'm using for the GetClipboardData method:</p>\n\n<pre><code>[DllImport(\"user32.dll\")]\nprivate static extern IntPtr GetClipboardData(uint uFormat);\n</code></pre>\n\n<p>Can anyone tell me where I'm going wrong?</p>\n"}, {"tags": ["c#", "loops", "response"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 2, "creation_date": 1444258825, "post_id": 33003804, "comment_id": 53832525, "body": "@Spencerstead, learn to use the debugger to step through your code.."}, {"owner": {"reputation": 16624, "user_id": 237934, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Hshoa.png?s=128&g=1", "display_name": "kame", "link": "https://stackoverflow.com/users/237934/kame"}, "edited": false, "score": 0, "creation_date": 1444403139, "post_id": 33003804, "comment_id": 53903820, "body": "you should use int instead of double."}], "answers": [{"tags": [], "owner": {"reputation": 1153, "user_id": 5399585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcJS6.jpg?s=128&g=1", "display_name": "Antony", "link": "https://stackoverflow.com/users/5399585/antony"}, "is_accepted": false, "score": 0, "last_activity_date": 1444261117, "creation_date": 1444261117, "answer_id": 33004209, "question_id": 33003804, "link": "https://stackoverflow.com/questions/33003804/why-does-this-program-stop-running-after-two-guesses/33004209#33004209", "title": "Why does this program stop running after two guesses?", "body": "<p>Your \"while\" condition isn't right, it currently checks if the number is within the 1-100 range while it should check if it was the right number. </p>\n\n<p>I would change it to:</p>\n\n<pre><code>while(guess != randomNumber); \n</code></pre>\n\n<p>or break when it is on the correct value:</p>\n\n<pre><code>if (guess == randomNumber)\n{\n    Console.WriteLine(\"Correct!\");\n    break;\n}\n</code></pre>\n\n<p>I would also note that your \"response\" value is currently useless once you fix your algorithm. </p>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 5420738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MayG9.png?s=128&g=1", "display_name": "C. McCarthy", "link": "https://stackoverflow.com/users/5420738/c-mccarthy"}, "is_accepted": false, "score": 0, "last_activity_date": 1444262840, "creation_date": 1444262840, "answer_id": 33004475, "question_id": 33003804, "link": "https://stackoverflow.com/questions/33003804/why-does-this-program-stop-running-after-two-guesses/33004475#33004475", "title": "Why does this program stop running after two guesses?", "body": "<p>You didn't need your guess as a double as the random number will only generate an integer. Also the responce variable is also not needed, as the loop can just be looped until:</p>\n\n<pre><code>while(guess != randomNumber);\n</code></pre>\n\n<p>Like the above answer said. If you would like to add a count of how many guesses the user takes to guess the number, add a count variable before the the opening 'do' loop.</p>\n\n<pre><code>int count = 0;\ndo\n{\n</code></pre>\n\n<p>And in each guess where the user doesn't guess it correctly increment the count by one, just like this:</p>\n\n<pre><code>if (guess &gt; randomNumber)\n{\nConsole.WriteLine(\"Too high\");\ncount += 1;\n}\n\nif (guess &lt; randomNumber)\n{\nConsole.WriteLine(\"Too low\");\ncount += 1;\n}\n</code></pre>\n\n<p>Then at the end when user guesses correctly</p>\n\n<pre><code>if (guess == randomNumber)\n{\n Console.WriteLine(\"Correct!\");\n Console.WriteLine(\"You took \" + count + \"guesses, to guess that number.\");\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5420652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0b3b30316d9d772906a3733a8e99f5?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer stead", "link": "https://stackoverflow.com/users/5420652/spencer-stead"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1444262840, "creation_date": 1444258554, "last_edit_date": 1444258774, "question_id": 33003804, "link": "https://stackoverflow.com/questions/33003804/why-does-this-program-stop-running-after-two-guesses", "title": "Why does this program stop running after two guesses?", "body": "<p>I am creating a simple C# console application game that creates a random number, then displays either \"too high\", \"too low\" or \"correct\", it is then supposed to ask the user to input another number &amp; then tell them whether that number is \"too high\", \"too low\" or \"correct\", once the right number is guessed, it should say \"correct\" and then display the number of guesses it took to get the correct number (this part I'm not sure how to do). Besides that I've created the code &amp; it will tell you whether your guess is too high or too low, and once you try to enter a second guess it automatically says it's correct. How can I get the program to read more guesses, and how do I display the number of guesses?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace _5.Number_Game\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            double response, guess;  \n            Random random = new Random();\n            int randomNumber = random.Next(1, 101);\n        do\n        {\n            Console.WriteLine(\"Enter your guess for a random number between 1 &amp; 100\");\n            guess = double.Parse(Console.ReadLine());\n            if (guess &gt; randomNumber)\n                Console.WriteLine(\"Too high\");\n\n            if (guess &lt; randomNumber)\n                Console.WriteLine(\"Too low\");\n\n            if (guess == randomNumber)\n                Console.WriteLine(\"Correct!\");\n\n             Console.WriteLine(\"Enter another number\");\n\n             response = double.Parse(Console.ReadLine());\n        }\n        while (response &lt;= 1 &amp;&amp; response &gt;=100);\n        Console.WriteLine(\"Correct, Goodbye!\");\n        Console.ReadLine();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sql", "linq"], "comments": [{"owner": {"reputation": 1447, "user_id": 4583854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/--sVT5cPJc1Q/AAAAAAAAAAI/AAAAAAAABOo/Yfn69gf8deo/photo.jpg=k-s128", "display_name": "Roger Oliveira", "link": "https://stackoverflow.com/users/4583854/roger-oliveira"}, "reply_to_user": {"reputation": 14193, "user_id": 183203, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf9ec57f64280ffe34ddd221d5c5151f?s=128&d=identicon&r=PG", "display_name": "antlersoft", "link": "https://stackoverflow.com/users/183203/antlersoft"}, "edited": false, "score": 0, "creation_date": 1444258683, "post_id": 33003785, "comment_id": 53832468, "body": "@antlersoft I tried but I couldn&#39;t understand that one, could you help me with the solution, would apreciate :)"}, {"owner": {"reputation": 1447, "user_id": 4583854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/--sVT5cPJc1Q/AAAAAAAAAAI/AAAAAAAABOo/Yfn69gf8deo/photo.jpg=k-s128", "display_name": "Roger Oliveira", "link": "https://stackoverflow.com/users/4583854/roger-oliveira"}, "reply_to_user": {"reputation": 14193, "user_id": 183203, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cf9ec57f64280ffe34ddd221d5c5151f?s=128&d=identicon&r=PG", "display_name": "antlersoft", "link": "https://stackoverflow.com/users/183203/antlersoft"}, "edited": false, "score": 0, "creation_date": 1444260974, "post_id": 33003785, "comment_id": 53833165, "body": "@antlersoft I am struggling here to make it work, I tried 20 examples, my case is slightly different, I have group by two fields, this website is suposed to help specific problems also. thanks"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1444262086, "post_id": 33003785, "comment_id": 53833422, "body": "Well, you should have linked it, and told exactly what you didn&#39;t understand about it. You can still do that! (Even if it would already have been closed, that wouldn&#39;t be the end unless you let it be the end.) Aside:: I probably won&#39;t be able to help you with an answer, not my bailwick."}, {"owner": {"reputation": 1447, "user_id": 4583854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/--sVT5cPJc1Q/AAAAAAAAAAI/AAAAAAAABOo/Yfn69gf8deo/photo.jpg=k-s128", "display_name": "Roger Oliveira", "link": "https://stackoverflow.com/users/4583854/roger-oliveira"}, "reply_to_user": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 0, "creation_date": 1444263580, "post_id": 33003785, "comment_id": 53833866, "body": "@Deduplicator I appreciate your attention, you are a legend, and I have great news I made it work!! Is it something useful to post the solution in this post? Thanks"}, {"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 1, "creation_date": 1444272754, "post_id": 33003785, "comment_id": 53836197, "body": "Great news. Well, it&#39;s your decision whether posting a new answer to <a href=\"http://stackoverflow.com/questions/3404975/left-outer-join-in-linq\" title=\"left outer join in linq\">stackoverflow.com/questions/3404975/left-outer-join-in-linq</a>, polishing (one or more) answers there, or posting a new answer here would be the better contribution to SO. I just don&#39;t know."}], "owner": {"reputation": 1447, "user_id": 4583854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh4.googleusercontent.com/--sVT5cPJc1Q/AAAAAAAAAAI/AAAAAAAABOo/Yfn69gf8deo/photo.jpg=k-s128", "display_name": "Roger Oliveira", "link": "https://stackoverflow.com/users/4583854/roger-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 2, "closed_date": 1444275085, "answer_count": 0, "score": 0, "last_activity_date": 1444261202, "creation_date": 1444258445, "last_edit_date": 1444261202, "question_id": 33003785, "link": "https://stackoverflow.com/questions/33003785/how-to-join-by-two-fields-showing-the-not-matching-records-and-group-by-using-li", "closed_reason": "Duplicate", "title": "How to join by two fields showing the not matching records and group by using Linq", "body": "<p>In <code>Visual Studio 2013</code>, <code>C# 4.5</code>, I have these classes:</p>\n\n<p><strong>Entities:</strong></p>\n\n<pre><code>public class KpiLabourHoursByTeamRole\n{\n    public DateTime Date { get; set; }\n    public int TeamId { get; set; }\n    public int RoleId { get; set; }\n    public double TotalHours { get; set; }\n    public double TotalCost { get; set; }\n}\n\npublic class TeamRole\n{\n    public int Id { get; set;}\n    public int RoleId { get; set;}\n    public int TeamId { get; set;}\n    public int? LabourCostCenterId { get; set; }\n}\n\npublic class KpiLabourHoursByCostCenter\n{\n   public int? LabourCostCenterId { get; set; }\n   public double TotalHours { get; set; }\n   public double TotalCost { get; set; }\n}\n</code></pre>\n\n<p><strong>Current Solution:</strong></p>\n\n<p>Currently, I have the solution below working perfectly as a <code>Inner Join</code> using <code>Linq</code>:</p>\n\n<p><code>kpiLabourHours</code> is a object of the type: <code>KpiLabourHoursByTeamRole</code></p>\n\n<p><code>kpiLabourHoursByCostCenter</code> is a object of the type: <code>KpiLabourHoursByCostCenter</code></p>\n\n<pre><code>var kpiLabourHoursByCostCenter = from k in kpiLabourHours\n    join tr in teamRoles on new {k.TeamId, k.RoleId} equals new {tr.TeamId, tr.RoleId}\n    group k by new { tr.LabourCostCenterId }\n    into grp\n    select new KpiLabourHoursByCostCenter\n    {\n        LabourCostCenterId = grp.Key.LabourCostCenterId,\n        TotalHours = grp.Sum(k =&gt; k.TotalHours),\n        TotalCost = grp.Sum(k =&gt; k.TotalCost),\n    };\n</code></pre>\n\n<p><strong>Equivalent in Sql:</strong></p>\n\n<p>The code above is represented by the equivalent <code>Sql</code>:</p>\n\n<pre><code>SELECT tr.LabourCostCenterId, sum(k.TotalHours), sum(k.TotalCost)\nFROM kpiLabourHours k\nINNER JOIN TeamRoles tr on tr.TeamId = k.TeamId and tr.RoleId = k.RoleId  \nGROUP tr.LabourCostCenterId\n</code></pre>\n\n<p><strong>My problem:</strong></p>\n\n<p>The problem is that it is hidding the results where there is no matching <code>TeamId</code> and <code>RoleId</code>, so I need to replace this code by a kind of <code>Left Outer Join</code>, such as:</p>\n\n<pre><code>SELECT tr.LabourCostCenterId, sum(k.TotalHours), sum(k.TotalCost)\nFROM kpiLabourHours k\nLEFT OUTER JOIN TeamRoles tr on tr.TeamId = k.TeamId and tr.RoleId = k.RoleId  \nGROUP tr.LabourCostCenterId\n</code></pre>\n\n<p>In a nutshell, I need to return <code>LabourCostCenter NULL</code> or <code>0</code> if there is no matching <code>TeamId</code> and <code>RoleId</code> with the totals.</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 1, "creation_date": 1444257800, "post_id": 33003583, "comment_id": 53832187, "body": "Did you try to use a TextFieldParser?"}, {"owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1444257995, "post_id": 33003583, "comment_id": 53832238, "body": "@Steve i dont know what that is, ill look for it, but if you are kind to give me your thoughts on how i could use that i would be gratefull"}, {"owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1444258055, "post_id": 33003583, "comment_id": 53832251, "body": "my file is being retrieved from a FTP server, and im trying to get that info into a datatable"}, {"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 1, "creation_date": 1444258080, "post_id": 33003583, "comment_id": 53832263, "body": "I have been using <a href=\"http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader\" rel=\"nofollow noreferrer\">codeproject.com/Articles/9258/A-Fast-CSV-Reader</a> for years.  Simple, easy to use."}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444258870, "post_id": 33003583, "comment_id": 53832540, "body": "I definitely recommend <code>TextFieldParser</code> - it&#39;s part of the .NET framework and it works well.  I&#39;ve used it several times (all from C# apps)."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1444304452, "post_id": 33003583, "comment_id": 53852393, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/906841/csv-parser-reader-for-c\">CSV parser/reader for C#?</a>"}, {"owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "reply_to_user": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1444318911, "post_id": 33003583, "comment_id": 53863497, "body": "@ivan_pozdeev so my question was actually of a regex.. these guys gave me another solution, that doesn&#39;t make this a re-post of the solution they suggested."}], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "edited": false, "score": 0, "creation_date": 1444258428, "post_id": 33003697, "comment_id": 53832379, "body": "i cant use TextFieldParser, i get an error trying to import using Microsoft.VisualBasic.FileIO; i am doing a c# console app."}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "edited": false, "score": 0, "creation_date": 1444258623, "post_id": 33003697, "comment_id": 53832444, "body": "This is strange because I have tested this code in a Console application. What error do you get?"}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444258816, "post_id": 33003697, "comment_id": 53832520, "body": "I&#39;ve used <code>TextFieldParser</code> in several C# applications - there shouldn&#39;t be any issue with it.  Did you add a reference to <code>Microsoft.VisualBasic.FileIO</code> in your project?"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1444258987, "post_id": 33003697, "comment_id": 53832582, "body": "It would be an act of courtesy (not just for me but also for the Readers) to explain the downvote."}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444259130, "post_id": 33003697, "comment_id": 53832643, "body": "That has to be the most non-sensical downvote I&#39;ve seen in my time on this site....."}, {"owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "edited": false, "score": 0, "creation_date": 1444267027, "post_id": 33003697, "comment_id": 53834805, "body": "it wont let me import the FileIO i get <code>the type or namespace FileIO does not exist in the namespace Microsoft.VisualBasic</code>"}, {"owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "edited": false, "score": 0, "creation_date": 1444267723, "post_id": 33003697, "comment_id": 53834979, "body": "added a reference and now i can use it, your example does work, ill try it with my actual code. THANKS!"}, {"owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "edited": false, "score": 0, "creation_date": 1444268468, "post_id": 33003697, "comment_id": 53835154, "body": "@Steve since this will give me an array with all the values how would i read the csv file? i would do this for every line? or is there another way? I need to get this data to a datatable"}], "tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": true, "score": 4, "last_activity_date": 1444259483, "last_edit_date": 1444259483, "creation_date": 1444258080, "answer_id": 33003697, "question_id": 33003583, "link": "https://stackoverflow.com/questions/33003583/working-with-regex-and-csv-quoted-strings/33003697#33003697", "title": "working with regex and csv quoted strings", "body": "<p>I am not sure why you need to use a Regex to parse comma separated data.<br>\nThere are a lot of free libraries specialized in parsing this kind of data and the same NET Framework provides a specific class in the Microsoft.VisualBasic.IO namespace</p>\n\n<p>Here how you could use it</p>\n\n<pre><code>string t = \"\\\"test\\\",645,23.4,42,\\\"13,13,14\\\",\\\"test\\\"\";\nStringReader sr = new StringReader(t);\nTextFieldParser tp = new TextFieldParser(sr);\ntp.Delimiters = new string[] {\",\"};\ntp.HasFieldsEnclosedInQuotes = true;\n\nstring[] result = tp.ReadFields();\n\nforeach(string s in result)\n   Console.WriteLine(s);\n</code></pre>\n\n<p>This code retrieves your data and respect the fields enclosed in double quotes avoiding to parse the content of these fields. However it seems that you want also a double quote arounde each string retrieved so you need a second loop to readd the missing quotes</p>\n\n<pre><code>for(int x = 0; x &lt; result.Length; x++)\n    result[x] = string.Concat(\"\\\"\", result[x], \"\\\"\");\n</code></pre>\n\n<p>By the way, I am not recommending to use this class, free libraries or custom code. To choice between these options is always a tradeoff between costs (write, debug, test, document) and perfomances. If performance is a critical aspect of your solution then you need to test a lot of things using the real data coming from your FTP server. A task that only you could perform.</p>\n"}], "owner": {"reputation": 711, "user_id": 3087763, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b4050dd35beb350ccfdb0efc9fcc79b2?s=128&d=identicon&r=PG&f=1", "display_name": "pato.llaguno", "link": "https://stackoverflow.com/users/3087763/pato-llaguno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 33003697, "answer_count": 1, "score": 0, "last_activity_date": 1444259483, "creation_date": 1444257464, "question_id": 33003583, "link": "https://stackoverflow.com/questions/33003583/working-with-regex-and-csv-quoted-strings", "title": "working with regex and csv quoted strings", "body": "<p>i am trying to convert a string like</p>\n\n<pre><code>\"test\",645,23.4,42,\"13,13,14\",\"test\"\n</code></pre>\n\n<p>into </p>\n\n<pre><code>\"test\",\"645\",\"23.4\",\"42\",\"13,13,14\",\"test\"\n</code></pre>\n\n<p>i am trying with this code.</p>\n\n<pre><code>string pattern = \"\\\",(? !\\\")\";\nstring pattern2 = \"(?&lt;!\\\"),(? !\\\")\";\nstring pattern3 = \"(?&lt;!\\\"),\\\"\";\nstring replacement = \"\\\",\\\"\";\n\nRegex rgx = new Regex(pattern);\ncatalogo = rgx.Replace(catalogo, replacement);\nrgx = new Regex(pattern2);\ncatalogo = rgx.Replace(catalogo, replacement);\nrgx = new Regex(pattern3);\ncatalogo = rgx.Replace(catalogo, replacement);\n</code></pre>\n\n<p>but i dont know how to get past the value that already contains commas. <code>\"13,13,14\"</code> since it will change it into <code>\"13\",\"13\",\"14\"</code></p>\n\n<p>i dont know if thats the best way to convert the string, but at least i believe that it will do the job, just that i dont know why i get past this.</p>\n"}, {"tags": ["c#", "asp.net", "signalr", "client-certificates"], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 5772463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da328fbca3a77b5f64bad9c34f32e031?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen VL", "link": "https://stackoverflow.com/users/5772463/jeroen-vl"}, "is_accepted": false, "score": 1, "last_activity_date": 1454411044, "creation_date": 1454411044, "answer_id": 35151691, "question_id": 33003557, "link": "https://stackoverflow.com/questions/33003557/signalr-with-client-certificate-authentication/35151691#35151691", "title": "SignalR with Client Certificate Authentication", "body": "<p>You should be able to get the certificate from the request you get as parameter.\n<code>HttpClientCertificate cert = request.GetHttpContext().Request.ClientCertificate;</code></p>\n"}], "owner": {"reputation": 335, "user_id": 3755268, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e2d25737f9d141e633d272ceaa606287?s=128&d=identicon&r=PG&f=1", "display_name": "user7702", "link": "https://stackoverflow.com/users/3755268/user7702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1860, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1454411044, "creation_date": 1444257323, "question_id": 33003557, "link": "https://stackoverflow.com/questions/33003557/signalr-with-client-certificate-authentication", "title": "SignalR with Client Certificate Authentication", "body": "<p>I have service hosted on IIS that uses SignalR to establish a persistent connection with a client. </p>\n\n<p>I am attempting to implement client certificate authentication so that the server can verify that the client is a valid client based on the certificate they send. I am using Signalr's PersistentConnection. </p>\n\n<p>Client: \nI create a Connection object, and i create a X.509 certificate which i add to the connection through:</p>\n\n<pre><code>var connection = new Connection(\"localhost:8060/TheService/connect\");\nconnection.AddClientCertificate(certificate); \nconnection.Start().Wait();\n</code></pre>\n\n<p>When the client attempts to connect, I want to verify that the certificate that it provides is a valid certificate. So on the server side I override the AuthorizeRequest() method in SignalR's PersistentConnection: </p>\n\n<pre><code>    public class MyConnection : PersistentConnection\n    {\n        protected override Task OnReceived(IRequest request, string connectionId, string data)\n        {\n            return Connection.Broadcast(\"Server Received: \" + data);\n        }\n\n        protected override bool AuthorizeRequest(IRequest request)\n        {\n            INameValueCollection headers = request.Headers;\n\n            foreach (KeyValuePair&lt;string, string&gt; entry in headers)\n            {\n                Console.WriteLine(\"Key: {0}, Value: {1}\", entry.Key, entry.Value);\n                Console.WriteLine(\"\");\n            }\n\n            return true; \n        }\n}\n</code></pre>\n\n<p>My question is: how do I retrieve the client certificate in the AuthorizeRequest method? I need SignalR to somehow gain access to the certificate so that I can verify it AuthorizeRequest and then either return false (bad cert), or return true (valid cert). </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "android", "json", "web-services", "soap"], "owner": {"reputation": 179, "user_id": 1848622, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1441ecbd73b6ff15d258a453385cd382?s=128&d=identicon&r=PG", "display_name": "Gerald Trost", "link": "https://stackoverflow.com/users/1848622/gerald-trost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1444257303, "creation_date": 1444257303, "question_id": 33003554, "link": "https://stackoverflow.com/questions/33003554/i-need-to-return-standard-html-json-status-codes-from-asp-soap-webservice", "title": "I need to return standard html/JSON Status codes from asp SOAP WebService", "body": "<p>We work with a c# SOAP WebService and we use this WebService \nfrom an ASP.NET Web Application.</p>\n\n<p>The WebService Class has these Compiler Tags:</p>\n\n<pre><code>[WebService(Namespace = \"http://myWebService/\")]\n[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\n</code></pre>\n\n<p>Since it was requested that the WebService can also communicate with JSON clients we added this Compiler Tag:</p>\n\n<pre><code>[ScriptService]\n</code></pre>\n\n<p>Methods are tagged with </p>\n\n<pre><code>[WebMethod] \n[ScriptMethod(ResponseFormat = ResponseFormat.Json)]\n</code></pre>\n\n<p>It all works fine with SOAP clients and with JSON clients.</p>\n\n<p>But there is an Issue with Exceptions:</p>\n\n<p>The SOAP Client can deal with the SoapExceptions of the WebService Methods.</p>\n\n<p>The JSON Clients (javaScript and Android) only get the Status\n500 and some Error Message - they don't get an Exception Object for any reason I don't know.</p>\n\n<p>The Android Developer wants to receive Standard Status Codes from the WebService in case something went wrong - i.e. codes like \n404, 403 ... because he cannot get an Error Object from the WebService Method.</p>\n\n<p>Important Note: \nI did already turn the Custom Error to \"OFF\" in the web.config file \nbecause It would be inefficient to always send \"Internal Server Error\" in any occurrence of an Exception.</p>\n\n<p>So my question is:\nHow can I achieve this:</p>\n\n<p>to throw an Exception in the WebService that will be serialized to the JSON client with the Error-Code \"404\" and with some individual Error Message. </p>\n"}, {"tags": ["c#", "asp.net", "authentication", "asp.net-web-api", "authorization"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "edited": false, "score": 0, "creation_date": 1444311505, "post_id": 33004129, "comment_id": 53857876, "body": "I think the problem is where I am implementing Thread.CurrentPrincipal and Current.User, because if I add the attribute [AllowAnonymous] in my API controller the app works fine, but if I Add the attribute [Authorize(Roles = RoleEntity.Collaborator)] for example the application does not recognizes this Role. So that&#39;s why I think I should implement The CurrentPrincipal in other place or in another way, do you know where I should implent?"}, {"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "reply_to_user": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "edited": false, "score": 0, "creation_date": 1448932430, "post_id": 33004129, "comment_id": 55777776, "body": "This is a late response, but how can you expect for an action to authorize for a role if the user has yet to authenticate?"}], "tags": [], "owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "is_accepted": false, "score": 12, "last_activity_date": 1519054227, "last_edit_date": 1519054227, "creation_date": 1444260544, "answer_id": 33004129, "question_id": 33003503, "link": "https://stackoverflow.com/questions/33003503/authorization-has-been-denied-for-this-request-always/33004129#33004129", "title": "Authorization has been denied for this request. Always", "body": "<p>You should add the <code>[AllowAnonymous]</code> attribute to your Controller's <code>LogInPost</code></p>\n\n<p>When you added the <code>AuthorizeAttribute</code> to your filters, it caused your controllers to assume they required authorization by default for all actions, including the one used to login.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "edited": false, "score": 0, "creation_date": 1444311623, "post_id": 33004157, "comment_id": 53857954, "body": "I&#39;m implementing my own authentication and I getting this error &quot;Authorization has been denied for this request&quot;. I think it&#39;s because I should implemente the current principal in other place, do you know where I should do?"}], "tags": [], "owner": {"reputation": 116, "user_id": 5420434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e65f936995f07edc08e7da47b3f03?s=128&d=identicon&r=PG", "display_name": "dotNetAuthor", "link": "https://stackoverflow.com/users/5420434/dotnetauthor"}, "is_accepted": false, "score": 3, "last_activity_date": 1444260707, "creation_date": 1444260707, "answer_id": 33004157, "question_id": 33003503, "link": "https://stackoverflow.com/questions/33003503/authorization-has-been-denied-for-this-request-always/33004157#33004157", "title": "Authorization has been denied for this request. Always", "body": "<p>Are you doing Windows Authentication? are you getting \"Access Denied\" error?</p>\n\n<p>At times IISEXpress and IIS does some trick and to overcome of that I have hosted the site in local iis (inetmgr), enable Authentication (windows if applicable) and now run it.</p>\n\n<p>P.S. not all machines have IIS server installed by default so if inetmgr doesn't work then you have to install it from Control Panel --> Windows Features --> select all the features of IIS and ASP .NET</p>\n\n<p>Hope this will help.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5023610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ea179a9fe757c58c7d3035a5817f12?s=128&d=identicon&r=PG&f=1", "display_name": "1MuddyDog", "link": "https://stackoverflow.com/users/5023610/1muddydog"}, "is_accepted": false, "score": 2, "last_activity_date": 1462859451, "creation_date": 1462859451, "answer_id": 37130213, "question_id": 33003503, "link": "https://stackoverflow.com/questions/33003503/authorization-has-been-denied-for-this-request-always/37130213#37130213", "title": "Authorization has been denied for this request. Always", "body": "<p>Sorry for such a late response - I found your question because, having switched from IIS-hosted web api to a self-hosted web api, I've just started experiencing the same problem.</p>\n\n<p>In my case, the problem was caused by how I was initialising Thread.CurrentPrincipal. Some background:</p>\n\n<ol>\n<li>I'm using a custom AuthenticationHandler (inheriting from DelegationHandler)</li>\n<li>In this handler, I'm overriding the SendAsync method to do some custom user validation.</li>\n<li>If the validation succeeds, I construct an instance of the ClaimsPrincipal class to contain some claims about the current user.</li>\n</ol>\n\n<p>Previously, I was assigning this ClaimsPrincipal instance to Thread.CurrentPrincipal before passing the message onward to the remaining message handlers in the pipeline. However, the solution for me was to use instead the Principal member on the HttpRequestContext instance that belongs to the HttpRequestMessage instance that is passed to SendAsync. Hence (in F#),</p>\n\n<pre><code>override this.SendAsync(request : HttpRequestMessage, cancellationToken : CancellationToken) =\n  // Do some user validation here first\n  // .. then setup the claims (method details omitted) \n  let principal = BuildClaimsPrincipal\n\n  // Assign to Principal on HttpRequestContext\n  let requestContext = request.GetRequestContext\n  requestContext.Principal &lt;- principal\n\n  // Rest of method omitted...\n</code></pre>\n\n<p>Hope this is able to help you in some way.</p>\n"}], "owner": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21663, "favorite_count": 0, "answer_count": 3, "score": 8, "last_activity_date": 1519054227, "creation_date": 1444256980, "question_id": 33003503, "link": "https://stackoverflow.com/questions/33003503/authorization-has-been-denied-for-this-request-always", "title": "Authorization has been denied for this request. Always", "body": "<p>I've already created a MVC webApi project and now I want to use Authentication and Authorization.\nI think I already implemented this security but for some reason something goes bad, when I write my credentials and I try to call some webApi methods the message \"Authorization has been denied for this request\" is shown.</p>\n\n<p>This is the code that I implemented.</p>\n\n<p>WebApiConfig:</p>\n\n<pre><code>public static void Register(HttpConfiguration config)\n    {\n        // Web API configuration and services\n\n        // Web API routes\n        config.MapHttpAttributeRoutes();\n\n        config.Routes.MapHttpRoute(\n            name: \"DefaultApi\",\n            routeTemplate: \"api/{controller}/{id}\",\n            defaults: new { id = RouteParameter.Optional }\n        );\n\n        config.Filters.Add(new AuthorizeAttribute());\n    }\n</code></pre>\n\n<p>Routing Config:</p>\n\n<pre><code>public static void RegisterRoutes(RouteCollection routes)\n    {\n        routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n        routes.MapRoute(\n            name: \"Default\",\n            url: \"{controller}/{action}/{id}\",\n            defaults: new { controller = \"Routing\", action = \"LogIn\", id = UrlParameter.Optional }\n        );\n    }\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code>public class RoutingController : Controller\n{\n    //\n    // GET: /Routing/\n    public ActionResult Index()\n    {\n        return View();\n    }\n\n    public ActionResult Projects()\n    {\n        return View();\n    }\n\n    public ActionResult Users()\n    {\n        return View();\n    }\n\n    public ActionResult LogIn()\n    {\n        return View();\n    }\n\n    [HttpPost]\n    public JsonResult LogInPost(string userName, string password)\n    {\n        User user = new User();\n        RoleByUser rByU = new RoleByUser();\n        password = UserController.EncriptPassword(password);\n        string url = string.Empty;\n        var checkUser = user.Get(userName);\n        var userExists = (from userInList in checkUser where userInList.UserName == userName &amp;&amp; userInList.Password == password select userInList).FirstOrDefault();\n        if(userExists!= null)\n        {\n            var roles = (from roleByUser in userExists.listOfRole select roleByUser.RoleName.Trim()).ToArray();\n            IPrincipal principal = new GenericPrincipal(\n            new GenericIdentity(userExists.UserName), roles);\n            SetPrincipal(principal);\n            url = \"Routing/Users\";\n        }\n        return Json(url);\n    }\n\n    private void SetPrincipal(IPrincipal principal)\n    {\n        Thread.CurrentPrincipal = principal;\n        if (System.Web.HttpContext.Current != null)\n        {\n            System.Web.HttpContext.Current.User = principal;\n        }\n    }\n\n}\n</code></pre>\n\n<p>HTML:</p>\n\n<pre><code>&lt;link href=\"~/css/Style.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n\n&lt;div class=\"container\"&gt;\n    &lt;div class=\"card card-container\"&gt;\n        &lt;img id=\"STK\" class=\"profile-img-card\" src=\"Images/Softtek.png\" /&gt;\n        &lt;p id=\"profile-name\" class=\"profile-name-card\"&gt;&lt;/p&gt;\n        &lt;form class=\"form-signin\"&gt;\n            &lt;span id=\"reauth-email\" class=\"reauth-email\"&gt;&lt;/span&gt;\n            &lt;input type=\"text\" id=\"txtUserName\" class=\"form-control\" placeholder=\"Email address\" required autofocus /&gt;\n            &lt;input type=\"password\" id=\"txtPassword\" class=\"form-control\" placeholder=\"Password\" required /&gt;\n            &lt;div id=\"remember\" class=\"checkbox\"&gt;\n                &lt;label&gt;\n                    &lt;input type=\"checkbox\" value=\"remember-me\" /&gt; Remember me\n                &lt;/label&gt;\n            &lt;/div&gt;\n            @*&lt;button id=\"btnLogIn\" class=\"btn btn-lg btn-primary btn-block btn-signin\"  &gt;Sing In&lt;/button&gt;*@\n        &lt;/form&gt;&lt;!-- /form --&gt;\n        &lt;button id=\"btnLogIn\" class=\"btn btn-lg btn-primary\"&gt;Sing In&lt;/button&gt;\n        &lt;a href=\"#\" class=\"forgot-password\"&gt;\n            Forgot the password?\n        &lt;/a&gt;\n    &lt;/div&gt;&lt;!-- /card-container --&gt;\n&lt;/div&gt;&lt;!-- /container --&gt;\n</code></pre>\n\n<p>JS:</p>\n\n<blockquote>\n  <p>$(document).ready(function () {\n      $('#btnLogIn').click(logIn); });</p>\n</blockquote>\n\n<pre><code>function logIn() {\n    $.ajax({\n        type: \"POST\",\n        url: \"http://localhost:21294/Routing/LogInPost\",\n        dataType: \"json\",\n        data: { userName: $('#txtUserName').val(), password: $('#txtPassword').val() },\n        success: function (data) {\n            if(data!= \"\" &amp;&amp; data!= undefined &amp;&amp; data!= null)\n                window.location.href = data;\n        },\n        error: function (err, e, error) {\n            toastr.error('Error')\n        }\n    });\n</code></pre>\n"}, {"tags": ["java", "c#", "unity3d", "java-native-interface", "hashtable"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 1092872, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b57a4198427ba62e9a5c742b4a7762ff?s=128&d=identicon&r=PG", "display_name": "user1092872", "link": "https://stackoverflow.com/users/1092872/user1092872"}, "edited": false, "score": 0, "creation_date": 1444294243, "post_id": 33007808, "comment_id": 53845516, "body": "Hi mate, thanks for the help, this throws the following error,                                                           Cannot implicitly convert type <code>UnityEngine.AndroidJavaObject&#39; to </code>System.Collections.Generic.List&lt;System.Collections.Generic.D&zwnj;&#8203;ictionary&lt;string,str&zwnj;&#8203;ing&gt;&gt;&#39;"}], "tags": [], "owner": {"reputation": 14588, "user_id": 521364, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/ACOKC.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/521364/david"}, "is_accepted": true, "score": 1, "last_activity_date": 1444296975, "last_edit_date": 1444296975, "creation_date": 1444284343, "answer_id": 33007808, "question_id": 33003410, "link": "https://stackoverflow.com/questions/33003410/unity-jni-get-arraylisthashtablestring-string-from-android-native-in-c/33007808#33007808", "title": "Unity JNI, get ArrayList&lt;Hashtable&lt;String, String&gt;&gt; from Android Native in C#", "body": "<pre><code>using System.Collections.Generic;\n\npublic AndroidJavaOject getProducts()\n{\n   return pluginClass.CallStatic&lt;AndroidJavaOject&gt;(\"getProductList\");\n}\n</code></pre>\n\n<p>Now when you getProducts() is called in C#, you get the product list, which is java representation of the products. And the next step is how to parse it into POCO, which apparently is another question.</p>\n\n<p>The parsing of the returned object into POCO is generally not recommended as it is hard to marshal all the data from Java to C# with no error or exceptions. An easy way is to use such medium as Json:</p>\n\n<p>Java Side:</p>\n\n<pre><code>public String getProducts(){\n    ObjectWriter ow = new  ObjectMapper().writer().withDefaultPrettyPrinter();\n    String json = ow.writeValueAsString(productListObject); \n    return json;\n}\n</code></pre>\n\n<p>in C# side</p>\n\n<pre><code>public void getProducts()\n{\n   string json = (string) pluginClass.CallStatic&lt;AndroidJavaOject&gt;(\"getProductList\"); //or\n   //string json = pluginClass.CallStatic&lt;AndroidJavaOject&gt;(\"getProductList\").ToString(); \n   //You can use any json library to deserialize the json then\n   Debug.Log(json); // Make sure this is correct string you wish to get\n}\n</code></pre>\n\n<p>Given the json string, it is much more convenient to desieralize the list of product out of it.</p>\n"}], "owner": {"reputation": 17, "user_id": 1092872, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b57a4198427ba62e9a5c742b4a7762ff?s=128&d=identicon&r=PG", "display_name": "user1092872", "link": "https://stackoverflow.com/users/1092872/user1092872"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 1, "accepted_answer_id": 33007808, "answer_count": 1, "score": 1, "last_activity_date": 1444296975, "creation_date": 1444256508, "last_edit_date": 1444263182, "question_id": 33003410, "link": "https://stackoverflow.com/questions/33003410/unity-jni-get-arraylisthashtablestring-string-from-android-native-in-c", "title": "Unity JNI, get ArrayList&lt;Hashtable&lt;String, String&gt;&gt; from Android Native in C#", "body": "<p>Can anyone help me with using an <code>ArrayList&lt;Hashtable&lt;String, String&gt;&gt;</code> in Unity C#?</p>\n\n<p>I can get bools and strings from an android native lib without issue but this one is throwing me,</p>\n\n<pre><code>public ArrayList&lt;Hashtable&lt;String, String&gt;&gt; getProducts()\n{\n  return pluginClass.CallStatic&lt;ArrayList&lt;Hashtable&lt;String, String&gt;&gt;&gt;(\"getProductList\");\n}\n</code></pre>\n\n<p>Many thanks.</p>\n"}, {"tags": ["c#", "foreach", "ms-word"], "comments": [{"owner": {"reputation": 5782, "user_id": 2832398, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/356c99a077310a35816f852423859f4c?s=128&d=identicon&r=PG&f=1", "display_name": "lilezek", "link": "https://stackoverflow.com/users/2832398/lilezek"}, "edited": false, "score": 2, "creation_date": 1444256579, "post_id": 33003402, "comment_id": 53831792, "body": "<i>I have been using the foreach loop, which does not work well as it stops at the first result.</i> A loop only stops if you explicitly tell to do so, or there are no more items to iterate over."}, {"owner": {"reputation": 5353, "user_id": 193486, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/926989dcb740cad69013964c20efdbc2?s=128&d=identicon&r=PG", "display_name": "TheEvilPenguin", "link": "https://stackoverflow.com/users/193486/theevilpenguin"}, "edited": false, "score": 0, "creation_date": 1444256599, "post_id": 33003402, "comment_id": 53831800, "body": "The <code>foreach</code> loop will behave the same as any other loop in this respect.  Is the problem being caught by the <code>res != resultRecord.Title</code> test, or is an exception being thrown?  An exception not caught inside the loop will break out of any loop."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1444256918, "post_id": 33003402, "comment_id": 53831908, "body": "can you explain what the value of <code>res</code> is and what <code>resultRecord.Title</code> is when you make your first iteration..? this will determine if you need a break; statement inside the foreach or not.. if worse comes to worse..then convert it to a for loop and determine what the loop count should be based on the <code>recser</code> size"}, {"owner": {"reputation": 53, "user_id": 4997121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/da608432af343846422a1fde44428595?s=128&d=identicon&r=PG&f=1", "display_name": "razor_ray", "link": "https://stackoverflow.com/users/4997121/razor-ray"}, "reply_to_user": {"reputation": 5353, "user_id": 193486, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/926989dcb740cad69013964c20efdbc2?s=128&d=identicon&r=PG", "display_name": "TheEvilPenguin", "link": "https://stackoverflow.com/users/193486/theevilpenguin"}, "edited": false, "score": 0, "creation_date": 1444257119, "post_id": 33003402, "comment_id": 53831983, "body": "@TheEvilPenguin It goes through each result individually, so for example, if the first result in the search is NOT equal to the Active Document, then it will think that the document doesn&#39;t exist and hence will attempt to create the Document."}, {"owner": {"reputation": 53, "user_id": 4997121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/da608432af343846422a1fde44428595?s=128&d=identicon&r=PG&f=1", "display_name": "razor_ray", "link": "https://stackoverflow.com/users/4997121/razor-ray"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1444257274, "post_id": 33003402, "comment_id": 53832031, "body": "@MethodMan res is the name of the active document and resultRecord.Title is the name of the document in the EDRMS search results. If the value for both are not equal, thats when I want the new document to be created"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1444257380, "post_id": 33003402, "comment_id": 53832063, "body": "@razor_ray I know that .. I am asking what is the actual value of both when you use the debugger... ..."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4997121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/da608432af343846422a1fde44428595?s=128&d=identicon&r=PG&f=1", "display_name": "razor_ray", "link": "https://stackoverflow.com/users/4997121/razor-ray"}, "edited": false, "score": 0, "creation_date": 1444260506, "post_id": 33003516, "comment_id": 53833039, "body": "that is exactly what I needed Eric. Thanks for your help!"}], "tags": [], "owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "is_accepted": true, "score": 1, "last_activity_date": 1444257037, "creation_date": 1444257037, "answer_id": 33003516, "question_id": 33003402, "link": "https://stackoverflow.com/questions/33003402/what-is-the-best-loop-to-use/33003516#33003516", "title": "What is the best loop to use?", "body": "<p>In your loop</p>\n\n<pre><code>foreach (Record resultRecord in recser)\n{\n    //if the document doesnt appear in the checked out results, then create the new document\n    if (res != resultRecord.Title)\n    {\n        //code to create the new doc\n    }\n    //otherwise display a message\n    else\n    {\n        MessageBox.Show(\"This is an existing document - \" + resultRecord.Number.ToString());\n    }\n}\n</code></pre>\n\n<p>if the first result isn't the same as <code>res</code>, you create a new document.  That's not the behavior you want.  It is unclear whether you break out of the loop at that point, as you have not shown code details.</p>\n\n<pre><code>bool foundExistingTitle = false;\nforeach (Record resultRecord in recser)\n{\n\n    //if the document doesnt appear in the checked out results, then create the new document\n    if (res == resultRecord.Title)\n    {\n        foundExistingTitle = true;\n        break;\n    }\n}\n\nif (foundExistingTitle)\n{\n    MessageBox.Show(\"This is an existing document - \" + resultRecord.Number.ToString());\n}\n</code></pre>\n\n<p>}</p>\n\n<p>You can greatly simplify that code if you want to use Linq.</p>\n\n<pre><code>bool foundExistingTitle = resultRecord.Where(r =&gt; r.Title == res).Any();\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4997121, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/da608432af343846422a1fde44428595?s=128&d=identicon&r=PG&f=1", "display_name": "razor_ray", "link": "https://stackoverflow.com/users/4997121/razor-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 33003516, "answer_count": 1, "score": -1, "last_activity_date": 1444257037, "creation_date": 1444256464, "question_id": 33003402, "link": "https://stackoverflow.com/questions/33003402/what-is-the-best-loop-to-use", "title": "What is the best loop to use?", "body": "<p>I'm making a Microsoft Word addin that integrates with our EDRMS software.</p>\n\n<p>On this addin, there is a button that will create a new Word Document and save it into the EDRMS.</p>\n\n<p>However, this button is also available when an existing Document is opened too.</p>\n\n<p>I want to be able to add some sort of validation so that if the User clicks on the \"Create New\" button on an existing Document, a message box appears saying that the Document already exists.</p>\n\n<p>I have been using the foreach loop, which does not work well as it stops at the first result.</p>\n\n<p>What is the best loop that I can use that will go through all the results first then determine if the document exists or if a new document can be created.</p>\n\n<p>My code is below:</p>\n\n<pre><code>    private void btnNewDoc_Click(object sender, EventArgs e)\n    {\n        try\n        {\n            string docName = Globals.ThisAddIn.Application.ActiveDocument.Name;\n\n            string res = Path.GetFileNameWithoutExtension(docName);\n\n            string fileloc = Path.GetFullPath(docName);\n\n            //searches through all existing documents that are checked out to me\n            TrimMainObjectSearch recser = new TrimMainObjectSearch(db, BaseObjectTypes.Record);\n            recser.SetSearchString(\"checkedOutBy:me\");\n\n            foreach (Record resultRecord in recser)\n            {\n                //if the document doesnt appear in the checked out results, then create the new document\n                if (res != resultRecord.Title)\n                {\n                    //code to create the new doc\n                }\n                //otherwise display a message\n                else\n                {\n                    MessageBox.Show(\"This is an existing document - \" + resultRecord.Number.ToString());\n                }\n            }\n\n        }\n\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.ToString());\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "c#-4.0"], "answers": [{"tags": [], "owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "is_accepted": true, "score": 1, "last_activity_date": 1444257223, "creation_date": 1444257223, "answer_id": 33003541, "question_id": 33003339, "link": "https://stackoverflow.com/questions/33003339/check-string-format-consist-of-specific-words-then-number-then-specific-words-in/33003541#33003541", "title": "Check string format consist of specific words then number then specific words in c#", "body": "<p>It's really easy to make a regular expression to get matches:</p>\n\n<pre><code>        string[] input = new string[6]\n        {\n            \"Auto_gen_1234@mail.com\", // match\n            \"Auto_gen_7302@mail.com\", // match\n            \"Auto_gen_8928@mail.com\", // match\n            \"Auto_gen_12345@mail.com\", // not a match\n            \"Auto_gen_72@mail.com\", // not a match\n            \"Auto_gen_Bob@mail.com\" // not a match\n        };\n\n        string pattern = @\"Auto_gen_\\d{4}@mail.com\";  //\\d{4} means 4 digits\n        foreach (string s in input)\n        {\n            if (Regex.IsMatch(s, pattern))\n            {\n                Console.WriteLine(string.Format(\"Input {0} is valid\",s));\n            }\n            else {\n                Console.WriteLine (string.Format(\"Input {0} is  not valid\",s));\n            }\n        }\n        Console.ReadKey();\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5346613, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6n-8k8-DN6c/AAAAAAAAAAI/AAAAAAAAABE/WQySo7VKhR8/photo.jpg?sz=128", "display_name": "sabreen saber", "link": "https://stackoverflow.com/users/5346613/sabreen-saber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "closed_date": 1444263697, "accepted_answer_id": 33003541, "answer_count": 1, "score": -5, "last_activity_date": 1444257223, "creation_date": 1444256152, "question_id": 33003339, "link": "https://stackoverflow.com/questions/33003339/check-string-format-consist-of-specific-words-then-number-then-specific-words-in", "closed_reason": "Not suitable for this site", "title": "Check string format consist of specific words then number then specific words in c#", "body": "<p>I have requirement to check if email in specific format and consists of specific words then number then specific words\nFor example</p>\n\n<pre><code> \"Auto_gen_1234@mail.com\"\n \"Auto_gen_7302@mail.com\"\n \"Auto_gen_8928@mail.com\"\n</code></pre>\n\n<p>\"auto_gen\" is fixed and \"@mail.com\" is fixed also but number is variable so do you know if i can check if email in this format ?</p>\n"}, {"tags": ["c#", "foreach", "directoryinfo", "getdirectories"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1444256502, "post_id": 33003290, "comment_id": 53831762, "body": "Can you give an example of some folders to make your question more understandable?"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1444259321, "post_id": 33003290, "comment_id": 53832705, "body": "Depends on starting directories <code>SearchOption.AllDirectories</code> can get you an error. Better, write recursive function to go through one dir at the time with try-catch"}], "answers": [{"tags": [], "owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "is_accepted": false, "score": 1, "last_activity_date": 1444256586, "creation_date": 1444256586, "answer_id": 33003420, "question_id": 33003290, "link": "https://stackoverflow.com/questions/33003290/getdirectory-based-on-getdirectory/33003420#33003420", "title": "GetDirectory based on getDirectory", "body": "<p>To me it seems like you want the <a href=\"https://msdn.microsoft.com/en-us/library/system.io.path.combine%28v=vs.110%29.aspx\" rel=\"nofollow\">Path.Combine()</a> method and use it like</p>\n\n<pre><code>string resultDir = Path.Combine(dir, \"..\\\\working\\\\products\");\n</code></pre>\n\n<p>if <code>dir</code> is a string or </p>\n\n<pre><code>string resultDir = Path.Combine(dir.FullName, \"..\\\\working\\\\products\");\n</code></pre>\n\n<p>if <code>dir</code> is a DirectoryInfo.</p>\n"}], "owner": {"reputation": 25, "user_id": 5419252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c547584fcd35d13256b310d74b827c4?s=128&d=identicon&r=PG&f=1", "display_name": "Spartenos", "link": "https://stackoverflow.com/users/5419252/spartenos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1444266822, "creation_date": 1444255905, "last_edit_date": 1444266822, "question_id": 33003290, "link": "https://stackoverflow.com/questions/33003290/getdirectory-based-on-getdirectory", "title": "GetDirectory based on getDirectory", "body": "<p>I have an application that needs to return the names of subdirectories in a specific path.  However, the path can include a variable, and towards the end of the path, I want it to check a certain folder.</p>\n\n<p>My current code is something like</p>\n\n<pre><code>string path = \"\\\\\\\\\" + computerList + \"\\\\C$\\\\Program Files (x86)\\\\blah1\\\\blah2\\\\\";\nstring searchPattern = \"*_*\";\n\nDirectoryInfo di = new DirectoryInfo(path);\nDirectoryInfo[] directories =\n    di.GetDirectories(searchPattern, SearchOption.AllDirectories);\n</code></pre>\n\n<p>followed by</p>\n\n<pre><code>foreach (DirectoryInfo dir in directories)\n{\n   versionInformation.Add(computerList+\" \"+dir.Parent.Parent.Parent+\" \"+dir.Parent + \" \" + dir.Name);\n}\n</code></pre>\n\n<p>What I <strong>want</strong> it to do is take the results from the directory search - and then add <code>\\\\working\\\\products\\\\</code> and iterate through that full list/path.</p>\n\n<p>So - in short - I want the versionInformation list to end up being\nDirectory information up to <code>blah2\\</code> - I want it to find the folder after blah2 (which it does) but then I want to append the <code>\\\\working\\\\products\\\\</code> and use that entire path for what it ends up searching for the <code>*_*</code> in.</p>\n\n<p><em>EDIT</em>  I just realized that I may have been addressing this the wrong way - It appears that my current code actually works - But when it lists the directory names, for some reason, It comes out wrong...</p>\n\n<pre><code>        foreach (DirectoryInfo dir in directories)\n        {\n\n            //DirectoryInfo threeLevelsUp = dir.Parent.Parent.Parent;\n            versionInformation.Add(computerList+\" \"+dir.Parent.Parent.Parent+\" \"+dir.Parent + \" \" + dir.Name);\n            //Console.WriteLine(dir.Parent + \" \" + dir.Name);\n        }\n    var beautifyList = string.Join(Environment.NewLine, versionInformation);\n    MessageBox.Show(beautifyList);\n</code></pre>\n\n<p>The first iteration for (using the below folders as an example) ICanBeDifferent will result in the FIRST item found being labeled as \"ICanBeDifferent\", but the SECOND result (for something found under ICanBeDifferent) would return FunTimes as the parent.parent.parent.</p>\n\n<p>What could be causing this?!\nExample Folders\nC:\\Program Files (x86)\\LLL\\Funtimes\\ICanBeDifferent\\Working\\Products\\Superman\\2015_2_0_7</p>\n\n<p>C:\\Program Files (x86)\\LLL\\Funtimes\\ICanBeDifferent\\Working\\Products\\Office\\2015_2_2_43</p>\n\n<p>C:\\Program Files (x86)\\LLL\\Funtimes\\ThisIsWhatChanges\\Working\\Products\\Lanyard\\2015_2_0_70</p>\n"}, {"tags": ["c#", ".net", "xaml", "windows-store-apps", "win-universal-app"], "answers": [{"comments": [{"owner": {"reputation": 23403, "user_id": 939213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85abdf3e1c88011c45e1a0cae01df78b?s=128&d=identicon&r=PG", "display_name": "ispiro", "link": "https://stackoverflow.com/users/939213/ispiro"}, "edited": false, "score": 0, "creation_date": 1444303334, "post_id": 33009815, "comment_id": 53851679, "body": "Thanks, but no. The animation of a FlipView depends on user interaction and can be long or short. I&#39;m looking for an actual event."}], "tags": [], "owner": {"reputation": 1617, "user_id": 5222921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KnTf6.jpg?s=128&g=1", "display_name": "Nasser AlNasser", "link": "https://stackoverflow.com/users/5222921/nasser-alnasser"}, "is_accepted": false, "score": 0, "last_activity_date": 1444290855, "creation_date": 1444290855, "answer_id": 33009815, "question_id": 33003283, "link": "https://stackoverflow.com/questions/33003283/detect-end-of-flipview-animation/33009815#33009815", "title": "Detect end of FlipView animation", "body": "<p>I'm not sure what you want, but you could try this :</p>\n\n<pre><code>await Task.Delay(animation time for example 1 sec.);\n</code></pre>\n\n<p>before the execution of selection changed event!</p>\n"}], "owner": {"reputation": 23403, "user_id": 939213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85abdf3e1c88011c45e1a0cae01df78b?s=128&d=identicon&r=PG", "display_name": "ispiro", "link": "https://stackoverflow.com/users/939213/ispiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444290855, "creation_date": 1444255873, "question_id": 33003283, "link": "https://stackoverflow.com/questions/33003283/detect-end-of-flipview-animation", "title": "Detect end of FlipView animation", "body": "<p><code>FlipView</code>'s <code>SelectionChanged</code> event is fired when the animation starts. How can I let the animation end before executing code?</p>\n"}, {"tags": ["c#", "sql-server", "tsql", "azure"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4766094, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/10152942188432961/picture?type=large", "display_name": "Kyle G", "link": "https://stackoverflow.com/users/4766094/kyle-g"}, "edited": false, "score": 0, "creation_date": 1444310520, "post_id": 33003849, "comment_id": 53857114, "body": "I appreciate the response but I am not sure the answer tells me much by saying the query isn&#39;t getting to the server.  What exactly would lead you to that determination?  Thanks Brian I will try the breakpoint."}, {"owner": {"reputation": 6511, "user_id": 4765200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb1ac82079e2f813975cfa1aad1e234?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Pressler", "link": "https://stackoverflow.com/users/4765200/brian-pressler"}, "reply_to_user": {"reputation": 139, "user_id": 4766094, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/10152942188432961/picture?type=large", "display_name": "Kyle G", "link": "https://stackoverflow.com/users/4766094/kyle-g"}, "edited": false, "score": 0, "creation_date": 1444320141, "post_id": 33003849, "comment_id": 53864225, "body": "I don&#39;t think the server is executing the query you shared with us because the string you seem to be building with that code does not match your results at all.  I don&#39;t think it&#39;s a problem with the query that you intended or the case of the strings in the data... I think it&#39;s a problem with the logistics of sending the correct string to the server.  I can&#39;t help you with that part with the information you have shared in your question.  It&#39;s not just matching addresses inappropriately... it&#39;s ignoring the part that joins on the IDs as well."}, {"owner": {"reputation": 139, "user_id": 4766094, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/10152942188432961/picture?type=large", "display_name": "Kyle G", "link": "https://stackoverflow.com/users/4766094/kyle-g"}, "edited": false, "score": 0, "creation_date": 1444320934, "post_id": 33003849, "comment_id": 53864747, "body": "The thing is it has been working well for many months. It only got weird this week &amp; only with addresses typed in all caps. That said it&#39;s understandable that with this limited information a direct answer is not likely attained. I was hoping the CHARINDEX and the all caps clue might ring a bell for someone but it could be a red herring.  Also even though there is concatenation in the SQL statement when I develop it it is a single line in VS 2015 &amp; both results match.  But what is most important is your suggestion to add breakpoints which I am currently elucidating myself to. Ty Brian!"}], "tags": [], "owner": {"reputation": 6511, "user_id": 4765200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb1ac82079e2f813975cfa1aad1e234?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Pressler", "link": "https://stackoverflow.com/users/4765200/brian-pressler"}, "is_accepted": true, "score": 1, "last_activity_date": 1444258775, "creation_date": 1444258775, "answer_id": 33003849, "question_id": 33003272, "link": "https://stackoverflow.com/questions/33003272/tsql-azure-sql-server-left-charindex/33003849#33003849", "title": "TSQL Azure SQL Server LEFT CHARINDEX", "body": "<p>I don't think that the query you are sending to the database server to get those results is the exact query you are generating with that code.  Not only is it improperly matching addresses... you can also see that there are <code>ID</code> in <code>b</code> that are less than <code>a</code>.  Set a break-point where you are sending the query to the server and examine the query string and verify what you are really sending.</p>\n"}], "owner": {"reputation": 139, "user_id": 4766094, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/10152942188432961/picture?type=large", "display_name": "Kyle G", "link": "https://stackoverflow.com/users/4766094/kyle-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 33003849, "answer_count": 1, "score": 0, "last_activity_date": 1444258775, "creation_date": 1444255825, "question_id": 33003272, "link": "https://stackoverflow.com/questions/33003272/tsql-azure-sql-server-left-charindex", "title": "TSQL Azure SQL Server LEFT CHARINDEX", "body": "<p>I have a TSQL statement that queries a single table looking for duplicate street address numbers.  For example \"123 Street\" matches \"123 St.\".  I use CHARINDEX to separate the string by selecting the characters on the left of the string but before the space which are almost always numbers as seen below:</p>\n\n<pre><code>    \"SELECT NewId() as NewId,\" +\n            //We rename the dbo.User table as \"a\" then rename it again as \"b\" so we can look for duplicate Street Address numbers\n            \"a.Id AS LeftID,a.DateSubmitted AS LeftDateSubmitted,a.Updated AS LeftUpdated,\" +\n            \"a.Status AS LeftStatus,a.StreetAddress AS LeftStreetAddress,\" +\n\n            \"b.Id AS RightID,b.DateSubmitted AS RightDateSubmitted,b.Updated AS RightUpdated,\" +\n            \"b.Status AS RightStatus,b.StreetAddress AS RightStreetAddress \" +\n\n            //We join the 2 virtual dbo.User tables where table b Id's are greater than table a meaning b records are newer\n            \"FROM [User] a JOIN [User] b ON b.Id &gt; a.Id AND \" +\n\n            //LEFT selects the left most characters (usually numbers) in the StreetAddress field string before the space ' '\n            //and eliminates the rest of the address isolating just the street address numbers for matching\n            \"LEFT(a.StreetAddress,CHARINDEX(' ',a.StreetAddress)) = LEFT(b.StreetAddress,CHARINDEX(' ',b.StreetAddress)) \" +\n\n            //Don't show orange or blue status records\n            \"AND b.Status != 'Orange' AND a.Status != 'Orange' AND a.Status != 'Blue' AND b.Status != 'Blue' \" +\n\n            //If a b record (newer) is red then ignore because it is completed and ignore a records (oldest) older than 90 days\n            \"WHERE a.DateSubmitted &gt;= (GetDate() - 90) AND b.Status != 'Red' \" +\n\n            //Show newest records first\n            \"ORDER BY b.DateSubmitted DESC\"\n</code></pre>\n\n<p>This has been working fairly well until today it was noticed that false positives were being picked up if the person entered the address in all caps as seen below:\n<a href=\"https://i.stack.imgur.com/6X9iz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6X9iz.png\" alt=\"Grid View\"></a></p>\n\n<p>My understanding of using:</p>\n\n<pre><code>    LEFT(a.StreetAddress,CHARINDEX(' ',a.StreetAddress))\n</code></pre>\n\n<p>Would result in the leftmost characters before the space being used for my JOIN yet the image above shows matches that should not occur? Please help an SQL beginner...</p>\n"}, {"tags": ["c#", "mvvm", "uwp"], "comments": [{"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 2, "creation_date": 1444255918, "post_id": 33003207, "comment_id": 53831534, "body": "Welcome on Stack Overflow. Can you make your question more clear? What have you tried? What&#39;s the exact error message?"}, {"owner": {"reputation": 3205, "user_id": 1926806, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/niiRQ.jpg?s=128&g=1", "display_name": "SWilko", "link": "https://stackoverflow.com/users/1926806/swilko"}, "edited": false, "score": 0, "creation_date": 1444294391, "post_id": 33003207, "comment_id": 53845620, "body": "use  <a href=\"https://github.com/Windows-XAML/Template10\" rel=\"nofollow noreferrer\">Template10</a> as no point reinventing the wheel"}], "answers": [{"tags": [], "owner": {"reputation": 2762, "user_id": 1641867, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/X2rrS.png?s=128&g=1", "display_name": "ventiseis", "link": "https://stackoverflow.com/users/1641867/ventiseis"}, "is_accepted": true, "score": 7, "last_activity_date": 1444259826, "creation_date": 1444259826, "answer_id": 33004024, "question_id": 33003207, "link": "https://stackoverflow.com/questions/33003207/universal-windows-platform-commanding-with-parameters/33004024#33004024", "title": "Universal Windows Platform commanding with parameters", "body": "<p>If you don't want to use a framework, you have to implement the interface <code>System.Windows.Input.ICommand</code> yourself. </p>\n\n<p>Command parameters can be passed by the the property <code>CommandParameter</code>. There is no need for a command manager. If you use a one-way binding for the parameter, the button will be enabled / disabled automatically when the binding change. For anything else raise the event <code>CanExecuteChanged</code>.</p>\n\n<p>Of course, in a more advanced scenario, you'll have to implement some state management for the command as well, which is easier if the commands are defined in a viewmodel or use are using some kind of self implemented command manager.</p>\n\n<p><strong>Simplified example</strong></p>\n\n<p>Here a simplified example how to use a button with <code>x:Bind</code> binding. No view model or command manager is reuired.</p>\n\n<p>Example.xaml:</p>\n\n<pre><code>&lt;Button x:Name=\"Test\" Command=\"{x:Bind FirstCommand}\" CommandParameter=\"{x:Bind SelectedItem, Mode=OneWay\"&gt;\n   &lt;TextBlock&gt;Test&lt;/TextBlock&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<p>Example.xaml.cs:</p>\n\n<pre><code>public sealed partial class Example : Page {\n\n    public SampleCommand FirstCommand { get; set; } =\n        new SampleCommand();\n\n    public object SelectedItem { get; set; }\n\n    public StandardProjectList() {\n        this.InitializeComponent();\n    }\n\n}\n</code></pre>\n\n<p>SampleCommand.cs:</p>\n\n<pre><code>public class SampleCommand : ICommand {\n\n    public event EventHandler CanExecuteChanged;\n\n    public bool CanExecute(object parameter) {\n        return parameter != null;\n    }   \n\n    public void Execute(object parameter) {\n        if (CanExecute(parameter))\n            //...\n    }   \n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4308406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39b6806638636c36fe63198d8a6e435?s=128&d=identicon&r=PG&f=1", "display_name": "Hadouken247", "link": "https://stackoverflow.com/users/4308406/hadouken247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4513, "favorite_count": 2, "closed_date": 1444290357, "accepted_answer_id": 33004024, "answer_count": 1, "score": 1, "last_activity_date": 1444259826, "creation_date": 1444255518, "question_id": 33003207, "link": "https://stackoverflow.com/questions/33003207/universal-windows-platform-commanding-with-parameters", "closed_reason": "Needs details or clarity", "title": "Universal Windows Platform commanding with parameters", "body": "<p>How I can make parameterized commands in Universal Windows Platform without MVVM-frameworks? I was tried to implement RelayCommand class, but System.Windows.Input namespace haven't CommandManager class.</p>\n"}, {"tags": ["c#", "generics"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 3, "creation_date": 1444255613, "post_id": 33003204, "comment_id": 53831392, "body": "What <i>exactly</i> to you want to do with the object - if you <i>know</i> it&#39;s of a particular type then just <i>cast it</i>.  If you <i>don&#39;t</i> know the type, how is the compiler supposed to know?"}, {"owner": {"reputation": 4109, "user_id": 860947, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WLi8a.png?s=128&g=1", "display_name": "ton.yeung", "link": "https://stackoverflow.com/users/860947/ton-yeung"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1444255724, "post_id": 33003204, "comment_id": 53831445, "body": "@DStanley there are various entities that can be passed in, so aside from the type being some sort of entity class (person, dog, cat, etc..) I don&#39;t known which type it will be."}, {"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 2, "creation_date": 1444255784, "post_id": 33003204, "comment_id": 53831466, "body": "You could look into <code>dynamic</code> (using <code>dynamic genericBar = ...</code>), but I&#39;m not a fan of using dynamic code when you have the option of strong types. It&#39;s unclear if you do or not. Maybe you really want a generic method? (<code>public void DoSomething&lt;T&gt;() where T : new()</code> if you need to do <code>new T()</code>)"}, {"owner": {"reputation": 3273, "user_id": 4355338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rc5kr.jpg?s=128&g=1", "display_name": "Sievajet", "link": "https://stackoverflow.com/users/4355338/sievajet"}, "edited": false, "score": 0, "creation_date": 1444256131, "post_id": 33003204, "comment_id": 53831617, "body": "You should cast it to the base type of your entity and work with that"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1444256247, "post_id": 33003204, "comment_id": 53831664, "body": "@ton.yeung Then how do you expect to call methods on it?  What would you expect <code>genericBar.Boom();</code> to do if T were <code>List&lt;Cat&gt;</code>?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1444256260, "post_id": 33003204, "comment_id": 53831669, "body": "Reflection is turtles all the way down, you&#39;d have to use genericBar.GetType().GetMethod(&quot;Boom&quot;).  Using <i>dynamic</i> is the very obvious alternative to stop that turtle."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1444256345, "post_id": 33003204, "comment_id": 53831703, "body": "@HansPassant But if you don&#39;t know what the type is (hence the need for reflection), how do you know that you can call <code>Boom</code> successfully, either at compile-time <i>or</i> run-time?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1444256388, "post_id": 33003204, "comment_id": 53831725, "body": "How do you know to pass &quot;Boom&quot; to GetMethod()?  You have to know <i>something</i>."}, {"owner": {"reputation": 4109, "user_id": 860947, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WLi8a.png?s=128&g=1", "display_name": "ton.yeung", "link": "https://stackoverflow.com/users/860947/ton-yeung"}, "edited": false, "score": 0, "creation_date": 1444256536, "post_id": 33003204, "comment_id": 53831773, "body": "I know that Bar has method Boom, as for T, its basically a value object or data transfer object, no behavior. What&#39;s Important is that I know I need Bar and that Bar has Boom, but its also a generic so I need to pass that in. Or at least, that&#39;s my understanding of how these things work."}, {"owner": {"reputation": 4109, "user_id": 860947, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WLi8a.png?s=128&g=1", "display_name": "ton.yeung", "link": "https://stackoverflow.com/users/860947/ton-yeung"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1444256593, "post_id": 33003204, "comment_id": 53831795, "body": "@DStanley it should still go Boom (poor cat)."}, {"owner": {"reputation": 4109, "user_id": 860947, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WLi8a.png?s=128&g=1", "display_name": "ton.yeung", "link": "https://stackoverflow.com/users/860947/ton-yeung"}, "reply_to_user": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 0, "creation_date": 1444256773, "post_id": 33003204, "comment_id": 53831847, "body": "@31eee384 Hans thanks the dynamic part lets me compile but for some reason when it tries to create the instance it errors out. I think this works, though. I&#39;ll continue debugging in a few hours, so thanks in the mean time."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1444256921, "post_id": 33003204, "comment_id": 53831909, "body": "@ton.yeung Is there a base type that has a <code>Boom</code> method or does each type implement its own.  If it&#39;s the latter then dynamic is the cleanest solution, dangerous as it is."}], "answers": [{"tags": [], "owner": {"reputation": 77031, "user_id": 44743, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9af6bab469df2f4e1486c3a608446f3b?s=128&d=identicon&r=PG", "display_name": "recursive", "link": "https://stackoverflow.com/users/44743/recursive"}, "is_accepted": true, "score": 0, "last_activity_date": 1444257147, "creation_date": 1444257147, "answer_id": 33003532, "question_id": 33003204, "link": "https://stackoverflow.com/questions/33003204/makegenerictype-actually-makes-an-object-and-i-cannot-use-the-types-methods/33003532#33003532", "title": "MakeGenericType() actually makes an object, and I cannot use the type&#39;s methods", "body": "<p>This sounds like a very questionable design, but if you must, <code>dynamic</code> neatly solves your problem.</p>\n\n<pre><code>public static void Main() {\n    var sample = new Baz&lt;List&lt;Foo&gt;&gt;();\n    sample.DoSomething();\n}\n\npublic class Foo { }\n\npublic class Bar&lt;T&gt; {\n    public void Boom() {\n        Console.WriteLine(\"I am booming\");\n    }\n}\n\n\npublic class Baz&lt;T&gt; {\n    public void DoSomething() {\n        var typeName = typeof(T).GetGenericArguments().Single().FullName;\n        var type = Type.GetType(typeName);\n        var genericRepoType = typeof(Bar&lt;&gt;);\n        var specificRepoType = genericRepoType.MakeGenericType(new Type[] { type });\n        dynamic genericBar = Activator.CreateInstance(specificRepoType);\n        Console.WriteLine(genericBar.GetType().Name); \n\n        genericBar.Boom();\n    }\n}\n</code></pre>\n\n<p><a href=\"https://dotnetfiddle.net/uPpfJa\" rel=\"nofollow\">https://dotnetfiddle.net/uPpfJa</a></p>\n\n<p>Alternatively, you could declare an <code>IBar</code> interface.</p>\n\n<pre><code>public class Bar&lt;T&gt; : IBar {\n    public void Boom() {\n        Console.WriteLine(\"I am booming\");\n    }\n}\n\ninterface IBar {\n    void Boom();\n}\n\n...\n\nvar genericBar = (IBar)Activator.CreateInstance(specificRepoType);\n</code></pre>\n"}], "owner": {"reputation": 4109, "user_id": 860947, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WLi8a.png?s=128&g=1", "display_name": "ton.yeung", "link": "https://stackoverflow.com/users/860947/ton-yeung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 33003532, "answer_count": 1, "score": 1, "last_activity_date": 1444257147, "creation_date": 1444255513, "last_edit_date": 1444255888, "question_id": 33003204, "link": "https://stackoverflow.com/questions/33003204/makegenerictype-actually-makes-an-object-and-i-cannot-use-the-types-methods", "title": "MakeGenericType() actually makes an object, and I cannot use the type&#39;s methods", "body": "<p>What it boils down to is that I'm trying to make a Generic and while the type shows up correctly at runtime, during compile time its still <code>object</code>, and so I cannot use any of the generic type's methods.</p>\n\n<p>thanks to brainless coder on a previous question I'm able to move forward a bit</p>\n\n<hr>\n\n<p><a href=\"https://dotnetfiddle.net/Kup10L\" rel=\"nofollow\">dotnetfiddle</a></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\npublic class Program\n{\n    public static void Main()\n    {\n        var sample = new Baz&lt;List&lt;Foo&gt;&gt;();\n        sample.DoSomething();\n    }\n\n    public class Foo\n    {\n    }\n\n\n    public class Bar&lt;T&gt;\n    {\n        public void Boom()\n        {\n        }\n    }\n\n\n    public class Baz&lt;T&gt;\n    {\n        public void DoSomething(){\n            if (typeof(T).Name == \"List`1\")\n            {\n                var typeName = typeof(T).GetGenericArguments().Single().FullName;\n                var type = Type.GetType(typeName);\n                var genericRepoType = typeof(Bar&lt;&gt;);\n                var specificRepoType = genericRepoType.MakeGenericType(new Type[] { type });\n                var genericBar = Activator.CreateInstance(specificRepoType);\n                Console.WriteLine(genericBar.GetType().Name); // Shows Bar`1\n                // but at compile time its foo is still an object\n                genericBar.Boom(); \n                //will error with 'object' does not contain a definition for Boom\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-mvc-4"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1444255410, "post_id": 33003152, "comment_id": 53831312, "body": "What happens if you run it locally? What is the <b>rendered</b> value of <code>Url.Action(&quot;GetSuggestionList&quot;, &quot;Home&quot;)</code>?"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1444255477, "post_id": 33003152, "comment_id": 53831335, "body": "BTW, you have a bug where your code will return no results if <code>TryParse</code> is unsuccessful. You should fall-back to a default page size or return an error response."}, {"owner": {"reputation": 4241, "user_id": 3994482, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GzsFL.png?s=128&g=1", "display_name": "Mahbubur Rahman", "link": "https://stackoverflow.com/users/3994482/mahbubur-rahman"}, "edited": false, "score": 0, "creation_date": 1444262568, "post_id": 33003152, "comment_id": 53833564, "body": "Is there any error message in console log?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5420524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2317af84fae6c980caabf38e4f876ca0?s=128&d=identicon&r=PG&f=1", "display_name": "shoes_on", "link": "https://stackoverflow.com/users/5420524/shoes-on"}, "is_accepted": false, "score": 0, "last_activity_date": 1446075616, "creation_date": 1446075616, "answer_id": 33403480, "question_id": 33003152, "link": "https://stackoverflow.com/questions/33003152/mvc-home-controller-debugging-unsuccesfull/33403480#33403480", "title": "MVC Home Controller debugging unsuccesfull", "body": "<p>I would like to thank everyone taking time and reading and trying to solve this problem. I did 2 things and got resolved.\n<a href=\"http://i.stack.imgur.com/92iT8.jpg\" rel=\"nofollow\">Enable Microsoft Symbol Servers</a></p>\n\n<p>and after that copied all the build files from the dev machine to remote machine and replaced it where the files were.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 1, "user_id": 5420524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2317af84fae6c980caabf38e4f876ca0?s=128&d=identicon&r=PG&f=1", "display_name": "shoes_on", "link": "https://stackoverflow.com/users/5420524/shoes-on"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446075616, "creation_date": 1444255271, "question_id": 33003152, "link": "https://stackoverflow.com/questions/33003152/mvc-home-controller-debugging-unsuccesfull", "title": "MVC Home Controller debugging unsuccesfull", "body": "<p>I am able to remote debug, and when I trace it , it goes thru all other cs files like HttpApplication.cs</p>\n\n<p>I can debug and it hits till in ..\\Website\\Views\\Shared_Layout.cshtml, since this has a delay I waited and the debugger timed out.</p>\n\n<pre><code> $(\"#pageSearchField\").autocomplete({\n            delay: 500,\n            source: function (request, response) {\n                $.ajax({\n                    url: '@Url.Action(\"GetSuggestionList\", \"Home\")',\n                    dataType: \"json\",\n                    data: request,\n                    cache: false,\n                    success: function (data) {\n                        response(data);\n                    }\n                });\n            },\n</code></pre>\n\n<p>But it doesn\u2019t go further, I also put break point in ..\\Website\\Controllers\\HomeController.cs</p>\n\n<pre><code>public ActionResult GetSuggestionList(string term){\n//break point here\n        int numberOfResults;\n        int.TryParse(ConfigurationManager.AppSettings[\"NumberOfResults\"], out numberOfResults);\n\n        var matched = _repository.GetSearchGroupList(term.ToLower(), numberOfResults);\n\n        return Json(matched, JsonRequestBehavior.AllowGet);\n    }\n</code></pre>\n\n<p>I am also including routing </p>\n\n<pre><code>public class RouteConfig\n{\n    /// &lt;summary&gt;\n    /// Registers the URL routes with the underlying MVC framework.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"routes\"&gt;The route collection to which the routes will be added.&lt;/param&gt;\n    public static void RegisterRoutes(RouteCollection routes)\n    {\n        routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n        routes.MapRoute(\n            \"Default\", // Route name\n            \"{controller}/{action}/{id}\", // URL with parameters\n            new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional });\n    }\n}\n</code></pre>\n\n<p>Any guidance would be helpful and appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "windows", "service"], "answers": [{"comments": [{"owner": {"reputation": 463, "user_id": 3801787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/820718418/picture?type=large", "display_name": "J Hunt", "link": "https://stackoverflow.com/users/3801787/j-hunt"}, "edited": false, "score": 0, "creation_date": 1444424704, "post_id": 33003248, "comment_id": 53915174, "body": "I haven&#39;t been able to try this out yet. My network guys are taking their time on giving me the ability to install it as an admin."}, {"owner": {"reputation": 463, "user_id": 3801787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/820718418/picture?type=large", "display_name": "J Hunt", "link": "https://stackoverflow.com/users/3801787/j-hunt"}, "edited": false, "score": 0, "creation_date": 1445358132, "post_id": 33003248, "comment_id": 54286129, "body": "Sorry it took so long, but i was finally able to test this and it worked great."}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": true, "score": 1, "last_activity_date": 1444255706, "creation_date": 1444255706, "answer_id": 33003248, "question_id": 33003010, "link": "https://stackoverflow.com/questions/33003010/c-command-prompt-app-to-windows-service-how-to-create-an-installer-class/33003248#33003248", "title": "C# command prompt app to windows service - How to create an installer class", "body": "<p>For that to work, you need to have a class that inherits from <code>System.Configuration.Install.Installer</code> in <code>System.Configuration.Install.dll</code>. TThe constructor should configure a <code>ServiceProcessInstaller</code> and a <code>ServiceInstaller</code>, and add them both to the <code>Installers</code> collection - setting the <code>Account</code>, <code>StartType</code>, <code>ServiceName</code>, <code>Description</code>, etc.</p>\n\n<p>MSDN has an example: <a href=\"https://msdn.microsoft.com/en-us/library/system.serviceprocess.serviceprocessinstaller(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/system.serviceprocess.serviceprocessinstaller(v=vs.110).aspx</a></p>\n"}], "owner": {"reputation": 463, "user_id": 3801787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/820718418/picture?type=large", "display_name": "J Hunt", "link": "https://stackoverflow.com/users/3801787/j-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33003248, "answer_count": 1, "score": 1, "last_activity_date": 1444255706, "creation_date": 1444254655, "question_id": 33003010, "link": "https://stackoverflow.com/questions/33003010/c-command-prompt-app-to-windows-service-how-to-create-an-installer-class", "title": "C# command prompt app to windows service - How to create an installer class", "body": "<p>How do I convert a command prompt app to a windows service?  So far this is what I have, but when I try to install it with InstallUtil.exe I'm received an error:</p>\n\n<p>No public installers with the RunInstallerAttribute.Yes attribute could be found in the ....</p>\n\n<p>I didn't know I had to create an installer class and I'm not sure how to go about this.  Can someone help me by telling me how to write an installer class so that I can install my app as a windows service?</p>\n\n<pre><code>   class Program\n   {\n    public const string ServiceName = \"ProcessingApp\";\n\n    public class Service : ServiceBase\n    {\n        public Service()\n        {\n            ServiceName = Program.ServiceName;\n        }\n\n        protected override void OnStart(string[] args)\n        {\n            Program.Start(args);\n        }\n\n        protected override void OnStop()\n        {\n            Program.Stop();\n        }\n    }\n\n    private static void Start(string[] args)\n    {\n        // onstart code here\n        StartCode();\n    }\n\n    private static void Stop()\n    {\n        // onstop code here\n\n        ServiceController service = new ServiceController(ServiceName);\n        try\n        {\n            TimeSpan timeout = TimeSpan.FromMilliseconds(100000);\n\n            service.Stop();\n            service.WaitForStatus(ServiceControllerStatus.Stopped, timeout);\n        }\n        catch\n        {\n\n        }\n\n    }\n\n    static void Main(string[] args)\n    {\n        if (!Environment.UserInteractive)\n            // running as service\n            using (var service = new Service())\n                ServiceBase.Run(service);\n        else\n        {\n            // running as console app\n            Start(args);\n\n            Console.WriteLine(\"Press any key to stop...\");\n            Console.ReadKey(true);\n\n            Stop();\n        }\n</code></pre>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1444254934, "post_id": 33002966, "comment_id": 53831113, "body": "Did you also read the Remarks section in <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.pushframe(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Dispatcher.PushFrame</a>? It explains it all, I guess."}, {"owner": {"reputation": 4698, "user_id": 461810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49c81c49603fee4d4ea52e30cd8841a8?s=128&d=identicon&r=PG", "display_name": "Dusan", "link": "https://stackoverflow.com/users/461810/dusan"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1444255207, "post_id": 33002966, "comment_id": 53831236, "body": "Yes, I have read that but it is still unclear. Does Dispatcher loop both initial Frame (created on startup) and my Frame one after another, or only my Frame?"}, {"owner": {"reputation": 4698, "user_id": 461810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49c81c49603fee4d4ea52e30cd8841a8?s=128&d=identicon&r=PG", "display_name": "Dusan", "link": "https://stackoverflow.com/users/461810/dusan"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1444255295, "post_id": 33002966, "comment_id": 53831270, "body": "Also, what happens when I <code>PushFrame</code> and later on when I set <code>Contionue</code> to <code>false</code>"}, {"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 2, "creation_date": 1444256097, "post_id": 33002966, "comment_id": 53831602, "body": "PushFrame &quot;enters an execute loop&quot; (MSDN). That loop (i.e. the DispatcherFrame) executes as long as its Continue property is true. As soon as the Continue property goes to false, the loop/frame is exited and the Dispatcher returns to the loop/frame that it executed before you called PushFrame."}, {"owner": {"reputation": 4698, "user_id": 461810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49c81c49603fee4d4ea52e30cd8841a8?s=128&d=identicon&r=PG", "display_name": "Dusan", "link": "https://stackoverflow.com/users/461810/dusan"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1444256557, "post_id": 33002966, "comment_id": 53831787, "body": "Great, that was one of my assumptions, also checked that in disassembled code and seems like that. Now, I am perfectly clear on what is going on. Please write the previous comment as an answer and I will accept it. Thanks a lot!"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1444287183, "post_id": 33002966, "comment_id": 53841217, "body": "<a href=\"http://stackoverflow.com/a/5183623/17034\">stackoverflow.com/a/5183623/17034</a>"}], "answers": [{"tags": [], "owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "is_accepted": true, "score": 5, "last_activity_date": 1444285466, "last_edit_date": 1592644375, "creation_date": 1444285466, "answer_id": 33008093, "question_id": 33002966, "link": "https://stackoverflow.com/questions/33002966/wpf-dispatcherframe-magic-how-and-why-this-works/33008093#33008093", "title": "WPF DispatcherFrame magic - how and why this works?", "body": "<p>From <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.pushframe(v=vs.110).aspx\" rel=\"noreferrer\">MSDN</a>:</p>\n<blockquote>\n<p>PushFrame</p>\n<p>Enters an execute loop.</p>\n</blockquote>\n<p>That loop (i.e. the <code>DispatcherFrame</code>) executes as long as its <code>Continue</code> property is <code>true</code>.</p>\n<p>As soon as the <code>Continue</code> property goes to <code>false</code>, the loop/frame is exited and the Dispatcher returns to the loop/frame that it executed before you called PushFrame.</p>\n"}, {"tags": [], "owner": {"reputation": 771, "user_id": 3561198, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/ssF6y.jpg?s=128&g=1", "display_name": "Serg046", "link": "https://stackoverflow.com/users/3561198/serg046"}, "is_accepted": false, "score": 0, "last_activity_date": 1484908299, "creation_date": 1484908299, "answer_id": 41761447, "question_id": 33002966, "link": "https://stackoverflow.com/questions/33002966/wpf-dispatcherframe-magic-how-and-why-this-works/41761447#41761447", "title": "WPF DispatcherFrame magic - how and why this works?", "body": "<p>If you want take a pause, why not anything like this?</p>\n\n<pre><code>private async void ButtonBase_OnClick(object sender, RoutedEventArgs e)\n{\n    var btn = sender as Button;\n    btn.Content = \"Before pause\";\n\n    var animation = new DoubleAnimation();\n    animation.From = btn.ActualWidth;\n    animation.To = 100;\n    animation.Duration = TimeSpan.FromSeconds(2);\n\n    btn.BeginAnimation(Button.WidthProperty, animation);\n\n    await Task.Delay(2000);\n\n    btn.Content = \"After pause\";\n}\n</code></pre>\n"}], "owner": {"reputation": 4698, "user_id": 461810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49c81c49603fee4d4ea52e30cd8841a8?s=128&d=identicon&r=PG", "display_name": "Dusan", "link": "https://stackoverflow.com/users/461810/dusan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2309, "favorite_count": 0, "accepted_answer_id": 33008093, "answer_count": 2, "score": 2, "last_activity_date": 1484908299, "creation_date": 1444254410, "question_id": 33002966, "link": "https://stackoverflow.com/questions/33002966/wpf-dispatcherframe-magic-how-and-why-this-works", "title": "WPF DispatcherFrame magic - how and why this works?", "body": "<p>I was trying to animate some stuff in <code>WPF</code> and run some other operations when animation finishes.</p>\n\n<p>Also, wanted to avoid animation finish callback mechanism, so, I came up with a solution illustrated in the code below: </p>\n\n<pre><code>// Start one second of animation\n...\n\n// Pause for one second\nWait(this.Dispatcher, 1000);\n\n// Continue and do some other stuff\n...\n</code></pre>\n\n<p>Now, the interesting part is <code>Wait</code> method which <strong>magically</strong> makes blocking pause in my code <strong>but</strong> the animation and UI stays normal, responsive:</p>\n\n<pre><code>    public static void Wait(Dispatcher Dispatcher, int Milliseconds)\n    {\n        var Frame = new DispatcherFrame();\n        ThreadPool.QueueUserWorkItem(State =&gt;\n        {\n            Thread.Sleep(Milliseconds);\n            Frame.Continue = false;\n        });\n        Dispatcher.PushFrame(Frame);\n    }\n</code></pre>\n\n<p>I have read a documentation and a few articles about <code>DispatcherFrame</code> but I am still unable to figure out what is really happening under the hood, and I need some clarification about how this construction with <code>PushFrame</code> really works.</p>\n"}, {"tags": ["c#", "sql-server", "ssis"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5415145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c62ced0d7200e702d018f3f105c9e40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5415145/peter"}, "edited": false, "score": 0, "creation_date": 1444258435, "post_id": 33003120, "comment_id": 53832383, "body": "I copied the code you mentioned into a &quot;protected void TextBox1_TextChanged(object sender, EventArgs e)&quot; but I feel that might not be the best way or the way you designed your statement."}, {"owner": {"reputation": 56, "user_id": 2762887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432737b9eb22fa50e538486bafec0475?s=128&d=identicon&r=PG&f=1", "display_name": "alexMil", "link": "https://stackoverflow.com/users/2762887/alexmil"}, "reply_to_user": {"reputation": 5, "user_id": 5415145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c62ced0d7200e702d018f3f105c9e40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5415145/peter"}, "edited": false, "score": 0, "creation_date": 1444431445, "post_id": 33003120, "comment_id": 53917517, "body": "You need to add a label named &#39;Label1&#39; to your page. Also I improved your page load by introducing using statements, you&#39;ll want to do something similar for the button click."}, {"owner": {"reputation": 5, "user_id": 5415145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c62ced0d7200e702d018f3f105c9e40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5415145/peter"}, "edited": false, "score": 0, "creation_date": 1444749229, "post_id": 33003120, "comment_id": 54027458, "body": "After watching C# training videos I can make sense of the code you posted. Thank you very much. The only issue that I have with it though is on the actually assigning Label1.text to the table rows[0][0] which I take gets the first column in the table. The error message I get is: &quot;Cannot implicitly convert type &#39;object&#39; to &#39;string&#39;. An explicit conversion exists (are you missing a cast?)&quot; I tried adding ToString to the end of things but no luck. I tried google but I haven&#39;t got a concrete answer that solves this issue for me. Any ideas?"}, {"owner": {"reputation": 5, "user_id": 5415145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c62ced0d7200e702d018f3f105c9e40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5415145/peter"}, "edited": false, "score": 0, "creation_date": 1444754152, "post_id": 33003120, "comment_id": 54030585, "body": "I found it! This is what I had to do to get it to display: Label1.Text = Convert.ToString(table.Rows[0][0]); Thank you so much for sending me off on the right direction AlexMill."}, {"owner": {"reputation": 56, "user_id": 2762887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432737b9eb22fa50e538486bafec0475?s=128&d=identicon&r=PG&f=1", "display_name": "alexMil", "link": "https://stackoverflow.com/users/2762887/alexmil"}, "reply_to_user": {"reputation": 5, "user_id": 5415145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c62ced0d7200e702d018f3f105c9e40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5415145/peter"}, "edited": false, "score": 0, "creation_date": 1444762863, "post_id": 33003120, "comment_id": 54035384, "body": "I edited that solution in case others have the same problem."}], "tags": [], "owner": {"reputation": 56, "user_id": 2762887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432737b9eb22fa50e538486bafec0475?s=128&d=identicon&r=PG&f=1", "display_name": "alexMil", "link": "https://stackoverflow.com/users/2762887/alexmil"}, "is_accepted": true, "score": 1, "last_activity_date": 1444762799, "last_edit_date": 1444762799, "creation_date": 1444255158, "answer_id": 33003120, "question_id": 33002894, "link": "https://stackoverflow.com/questions/33002894/display-date-of-last-successful-ssis-job-in-c-app/33003120#33003120", "title": "Display Date of last successful SSIS job in C# app", "body": "<pre><code>protected void Page_Load(object sender, EventArgs e)\n{\n    String str = \"Select Statement\";\n    //Replace 'YourJobName' with the name of your SQL Job!\n    string sqlSelect = @\"DECLARE @job_id binary(16)\n    SELECT @job_id = job_id FROM msdb.dbo.sysjobs WHERE (name = N'YourJobName')\n    SELECT TOP 1\n    CONVERT(DATETIME, RTRIM(run_date))\n    + ((run_time / 10000 * 3600) \n    + ((run_time % 10000) / 100 * 60) \n    + (run_time % 10000) % 100) / (86399.9964) AS run_datetime\n    , *\n    FROM\n    msdb..sysjobhistory sjh\n    WHERE\n    sjh.step_id = 0 \n    AND sjh.run_status = 1 \n    AND sjh.job_id = @job_id\n    ORDER BY\n    run_datetime DESC\";\n\n    using(var connection = new SqlConnection(My_Connection))\n    {\n        using (var sc = new SqlCommand(str, connection))\n        {\n            sc.ExecuteNonQuery();\n            using (SqlDataAdapter da = new SqlDataAdapter() { SelectCommand = sc })\n            {\n                DataSet ds = new DataSet();\n                da.Fill(ds, \"FirstName\");\n                GridView1.DataSource = ds;\n            }\n            GridView1.DataBind();\n        }\n\n        using (var adapter = new SqlDataAdapter(sqlSelect, connection))\n        {\n            var table = new DataTable();\n            adapter.Fill(table);\n            Label1.Text = Convert.ToString(table.Rows[0][0]); \n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5415145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c62ced0d7200e702d018f3f105c9e40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/5415145/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 33003120, "answer_count": 1, "score": 0, "last_activity_date": 1444762799, "creation_date": 1444254076, "last_edit_date": 1444260742, "question_id": 33002894, "link": "https://stackoverflow.com/questions/33002894/display-date-of-last-successful-ssis-job-in-c-app", "title": "Display Date of last successful SSIS job in C# app", "body": "<p>I am updating by code to include the entire .aspx source to give a better picture to those helping me on where to input code.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Data;\nusing System.Data.SqlClient;\n\npublic partial class _Default : System.Web.UI.Page\n{\nSqlConnection maindb = new SqlConnection(My_Connection);\n\nprotected void Page_Load(object sender, EventArgs e)\n{\n    String str = \"Select Statement\";\n    SqlCommand sc = new SqlCommand(str, maindb);\n\n    maindb.Open();\n    sc.ExecuteNonQuery();\n    SqlDataAdapter da = new SqlDataAdapter();\n    da.SelectCommand = sc;\n    DataSet ds = new DataSet();\n    da.Fill(ds, \"FirstName\");\n    GridView1.DataSource = ds;\n    GridView1.DataBind();\n    maindb.Close();\n}\nprotected void Button1_Click(object sender, EventArgs e)\n{\n    String str = \"Different Select Statement\";\n    SqlCommand sc = new SqlCommand(str, maindb);\n\n    maindb.Open();\n    sc.ExecuteNonQuery();\n    SqlDataAdapter da = new SqlDataAdapter();\n    da.SelectCommand = sc;\n    DataSet ds = new DataSet();\n    da.Fill(ds, \"FirstName\");\n    GridView1.DataSource = ds;\n    GridView1.DataBind();\n    maindb.Close();\n}\nprotected void GridView1_SelectedIndexChanged(object sender, EventArgs e)\n{\n\n}\n\n}\n</code></pre>\n\n<p>I have a single step job that runs daily, which updates a few tables in SQL.</p>\n\n<p>With my basic knowledge of C# I created an app that displays the data stored in that SQL table in a gridview. I would like to display on the app the last successful job run date, kind of a \"Data Updated On\" type of thing.</p>\n\n<p>On other Stack Overflow question I found this code to display a row in SQL management studio with the last successful job.</p>\n\n<pre><code>DECLARE @job_id binary(16)\nSELECT @job_id = job_id FROM msdb.dbo.sysjobs WHERE (name = N'YourJobName')\nSELECT TOP 1\nCONVERT(DATETIME, RTRIM(run_date))\n+ ((run_time / 10000 * 3600) \n+ ((run_time % 10000) / 100 * 60) \n+ (run_time % 10000) % 100) / (86399.9964) AS run_datetime\n, *\nFROM\nmsdb..sysjobhistory sjh\nWHERE\nsjh.step_id = 0 \nAND sjh.run_status = 1 \nAND sjh.job_id = @job_id\nORDER BY\nrun_datetime DESC\n</code></pre>\n\n<p>The question I have is how do I go about displaying the Date in the actual app?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c#", "asp.net", "vb.net", "sql-server-2008", "pivot"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3875617"}, "edited": false, "score": 1, "creation_date": 1444302214, "post_id": 33002854, "comment_id": 53851016, "body": "use pivot grid from extjs.<a href=\"http://dev.sencha.com/deploy/ext-3.4.0/examples/grid/totals.html\" rel=\"nofollow noreferrer\">dev.sencha.com/deploy/ext-3.4.0/examples/grid/totals.h&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 2634, "user_id": 5104101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9f9a8e32cb73369ec0b3f0f49e061c36?s=128&d=identicon&r=PG&f=1", "display_name": "haraman", "link": "https://stackoverflow.com/users/5104101/haraman"}, "edited": false, "score": 0, "creation_date": 1444317209, "post_id": 33002854, "comment_id": 53862345, "body": "@Karthikeyan 1. As already mentioned at the end of the question any <b>third party components are NOT to be used</b> and 2. The desired solution is to be in the form of <b>SQL query or SQL stored procedure or C# / VB.NET back-end code based only</b>."}], "owner": {"reputation": 2634, "user_id": 5104101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9f9a8e32cb73369ec0b3f0f49e061c36?s=128&d=identicon&r=PG&f=1", "display_name": "haraman", "link": "https://stackoverflow.com/users/5104101/haraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 902, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1444667187, "creation_date": 1444253914, "last_edit_date": 1495542255, "question_id": 33002854, "link": "https://stackoverflow.com/questions/33002854/dynamic-pivot-with-sub-column-total", "title": "Dynamic pivot with sub column total", "body": "<p>Assuming I have a resulting data-set of SQL query by joining multiple tables as follows:  </p>\n\n<pre><code>Class_Name  Roll_No  Student_Name  Fee_Type    Fee_Name    Amount\n----------  -------  ------------  ----------  ----------  ------\nClass_1     101      abc           Fee_Type_1  Fee_1       100\nClass_1     101      abc           Fee_Type_1  Fee_2       200\nClass_1     101      abc           Fee_Type_1  Fee_3       500\nClass_1     101      abc           Fee_Type_2  Fee_4       300\nClass_1     101      abc           Fee_Type_1  Fee_5       400\n\nClass_1     102      xyz           Fee_Type_1  Fee_1       100\nClass_1     102      xyz           Fee_Type_1  Fee_2       100\nClass_1     102      xyz           Fee_Type_2  Fee_4       300\nClass_1     102      xyz           Fee_Type_2  Fee_5       400\n\nClass_2     201      mno           Fee_Type_1  Fee_1       200\nClass_2     201      mno           Fee_Type_1  Fee_2       200\nClass_2     201      mno           Fee_Type_1  Fee_3       500\nClass_2     201      mno           Fee_Type_2  Fee_4       300\n\nClass_2     202      pqr           Fee_Type_1  Fee_1       200\nClass_2     202      pqr           Fee_Type_1  Fee_2       100\nClass_2     202      pqr           Fee_Type_1  Fee_3       500\nClass_2     202      pqr           Fee_Type_2  Fee_4       300\nClass_2     202      pqr           Fee_Type_2  Fee_5       600\n</code></pre>\n\n<p>The desired output is in following format</p>\n\n<pre><code>                                    -----------------------------------------------------------------------------\n                                    |               Fee_Type_1           |         Fee_Type_2         | Student |\n------------------------------------------------------------==============---------------============== Total   |\nClass_Name | Roll_No | Student_Name | Fee_1 | Fee_2 | Fee_3 | Type_Total | Fee_4 | Fee_5 | Type_Total |         |\n------------------------------------------------------------==============---------------==============----------\nClass_1    | 101     | abc          |   100 |   200 |   500 |        800 |   300 |   400 |        700 |  1500   |\n           | 102     | xyz          |   100 |   100 |     0 |        200 |   300 |   300 |        600 |   800   |\n-----------------------------------------------------------------------------------------------------------------\nClass Total                         |   200 |   300 |   500 |       1000 |   600 |   700 |       1300 |  2300   |\n-----------------------------------------------------------------------------------------------------------------\nClass_2    | 201     | mno          |   200 |   200 |   500 |        900 |   300 |     0 |        300 |  1200   |\n           | 202     | pqr          |   200 |   100 |   500 |        800 |   300 |   600 |        900 |  1700   |\n-----------------------------------------------------------------------------------------------------------------\nClass Total                         |   400 |   300 |  1000 |       1700 |   600 |   600 |       1200 |  2900   |\n-----------------------------------------------------------------------------------------------------------------\nFee Total                           |   600 |   600 |  1500 |       2700 |  1200 |  1300 |       2500 |  5200   |\n-----------------------------------------------------------------------------------------------------------------\n</code></pre>\n\n<p>The resulting SQL query data-set is fully dynamic, therefore, column names can not be hard-coded.  </p>\n\n<p>Generating pivot tables through SQL or ASP.NET code and adding totals of row (Student Total) and each column and sub grouping (Fee Total and Class Total) is easily achievable as mentioned in above given resource links. <strong>The problem is to get the Sub Totals in each row (Type_Total column for every Fee_Name under Fee_Type (Fee_1 + Fee_2 + Fee_3 and Fee_4 + Fee_5) in given example).</strong>  </p>\n\n<p><strong>How can these sub totals be added to dynamic data?</strong>  </p>\n\n<p>Tools: MS-SQL Server 2008 R2 and ASP.NET (.NET Framework 4.0). The desired solution can be SQL query, SQL stored procedure or C# / VB.NET back-end code.  </p>\n\n<p><strong>References</strong>\nI have studied and implemented the following resources available:  </p>\n\n<ol>\n<li><p>ASP.NET references for dynamic pivot: (A) <a href=\"http://www.codeproject.com/Articles/46486/Pivoting-DataTable-Simplified\" rel=\"nofollow noreferrer\">Pivoting-DataTable-Simplified</a> Sub total of ABC Infotech, TPS Software etc. along with total of all columns for each row is desired and (B) <a href=\"http://www.codeproject.com/Articles/810267/Pivot-Grid-in-Asp-Net-MVC\" rel=\"nofollow noreferrer\">Pivot-Grid-in-Asp-Net-MVC</a> Total of Apparel, Electronics and Food Items along with total of all columns for each row is desired.  </p></li>\n<li><p>ASP.NET reference for group and grand total for columns: <a href=\"http://www.dotnettwitter.com/2011/02/group-total-grand-total-in-grid-view.html\" rel=\"nofollow noreferrer\">group-total-grand-total-in-grid-view</a>  </p></li>\n<li><p>SQL references for dynamic SQL pivot: (A) <a href=\"https://stackoverflow.com/questions/2922797/t-sql-pivot-possibility-of-creating-table-columns-from-row-values\">t-sql-pivot-possibility-of-creating-table-columns-from-row-values</a> and (B) <a href=\"http://sqlhints.com/2014/03/18/dynamic-pivot-in-sql-server/\" rel=\"nofollow noreferrer\">dynamic-pivot-in-sql-server</a>  </p></li>\n</ol>\n\n<p>PS: Any reporting software such as Crystal Reports or excel can not be used.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "edited": false, "score": 1, "creation_date": 1444254246, "post_id": 33002738, "comment_id": 53830800, "body": "Looks like it just zeroes the internal buffer in case the memory region contains sensitive data: <a href=\"http://referencesource.microsoft.com/#mscorlib/system/security/cryptography/sha1managed.cs,e228b8e0c77ca9b1\" rel=\"nofollow noreferrer\">referencesource.microsoft.com/#mscorlib/system/security/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "is_accepted": true, "score": 3, "last_activity_date": 1444309148, "last_edit_date": 1444309148, "creation_date": 1444254320, "answer_id": 33002945, "question_id": 33002738, "link": "https://stackoverflow.com/questions/33002738/when-is-it-necessary-to-call-sha1managed-initialize/33002945#33002945", "title": "(When) Is it necessary to call SHA1Managed.Initialize()?", "body": "<p>checking the decompiled code, It just clears out the <code>buffer</code> and <code>expandedBuffer</code> byte arrays:</p>\n\n<pre><code>public override void Initialize()\n{\n  this.InitializeState();\n  Array.Clear((Array) this._buffer, 0, this._buffer.Length);\n  Array.Clear((Array) this._expandedBuffer, 0, this._expandedBuffer.Length);\n}\n</code></pre>\n\n<p>For conciseness, the <code>InitializeState</code> method, which is also called in the constructor:</p>\n\n<pre><code>private void InitializeState()\n{\n  this._count = 0L;\n  this._stateSHA1[0] = 1732584193U;\n  this._stateSHA1[1] = 4023233417U;\n  this._stateSHA1[2] = 2562383102U;\n  this._stateSHA1[3] = 271733878U;\n  this._stateSHA1[4] = 3285377520U;\n}\n</code></pre>\n\n<p>No need to call <code>Initialize</code> on construction.  Looks like more of a reset button.</p>\n"}, {"tags": [], "owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "is_accepted": false, "score": 0, "last_activity_date": 1444254978, "creation_date": 1444254978, "answer_id": 33003074, "question_id": 33002738, "link": "https://stackoverflow.com/questions/33002738/when-is-it-necessary-to-call-sha1managed-initialize/33003074#33003074", "title": "(When) Is it necessary to call SHA1Managed.Initialize()?", "body": "<p>From the CoreCLR:</p>\n\n<pre><code> [System.Security.SecuritySafeCritical]  // auto-generated\n    public override void Initialize() {\n        if (_safeHashHandle != null &amp;&amp; !_safeHashHandle.IsClosed)\n            _safeHashHandle.Dispose();\n\n        // _CreateHash will check for failures and throw the appropriate exception\n        _safeHashHandle = Utils.CreateHash(Utils.StaticProvHandle, Constants.CALG_SHA1);\n    }\n</code></pre>\n\n<p>It looks to be called as a part of standard implementations of HashAlgorihthm methods, and doesn't look like it ever needs to be called directly during normal usage.</p>\n"}], "owner": {"reputation": 3706, "user_id": 139560, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/885a6fe8a4179cf7b8c9b21869f5a8b2?s=128&d=identicon&r=PG", "display_name": "Jamie Kitson", "link": "https://stackoverflow.com/users/139560/jamie-kitson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 33002945, "answer_count": 2, "score": 3, "last_activity_date": 1444309148, "creation_date": 1444253404, "question_id": 33002738, "link": "https://stackoverflow.com/questions/33002738/when-is-it-necessary-to-call-sha1managed-initialize", "title": "(When) Is it necessary to call SHA1Managed.Initialize()?", "body": "<p>What does <code>SHA1Managed.Initialize()</code> actually do? When is it necessary to call it? <a href=\"https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1managed.initialize%28v=vs.110%29.aspx\" rel=\"nofollow\">The documentation</a> is very sparse.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-mvc-4", "kendo-ui"], "answers": [{"comments": [{"owner": {"reputation": 1244, "user_id": 2820641, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f5374efd49a5710a7a17665ff19dac5d?s=128&d=identicon&r=PG&f=1", "display_name": "TheDizzle", "link": "https://stackoverflow.com/users/2820641/thedizzle"}, "edited": false, "score": 0, "creation_date": 1444308772, "post_id": 33003236, "comment_id": 53855625, "body": "Uncaught ReferenceError: e is not defined is what I get when trying this method."}, {"owner": {"reputation": 733, "user_id": 876085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3880fa51d7823dfae31e5e8cb4e1f0?s=128&d=identicon&r=PG", "display_name": "JFM", "link": "https://stackoverflow.com/users/876085/jfm"}, "reply_to_user": {"reputation": 1244, "user_id": 2820641, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f5374efd49a5710a7a17665ff19dac5d?s=128&d=identicon&r=PG&f=1", "display_name": "TheDizzle", "link": "https://stackoverflow.com/users/2820641/thedizzle"}, "edited": false, "score": 0, "creation_date": 1444334736, "post_id": 33003236, "comment_id": 53872443, "body": "I&#39;ve edited the template a bit, please see if it helps you better"}, {"owner": {"reputation": 1244, "user_id": 2820641, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f5374efd49a5710a7a17665ff19dac5d?s=128&d=identicon&r=PG&f=1", "display_name": "TheDizzle", "link": "https://stackoverflow.com/users/2820641/thedizzle"}, "edited": false, "score": 0, "creation_date": 1444335873, "post_id": 33003236, "comment_id": 53873021, "body": "That is perfect.  We just added another value called &#39;Full Amount&#39; that needs a dollar sign also. Is there a way to add an or in there? if &#39;Fixed Amount&#39; or &#39;Full Amount&#39; use dollar sign else use percent"}, {"owner": {"reputation": 733, "user_id": 876085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3880fa51d7823dfae31e5e8cb4e1f0?s=128&d=identicon&r=PG", "display_name": "JFM", "link": "https://stackoverflow.com/users/876085/jfm"}, "reply_to_user": {"reputation": 1244, "user_id": 2820641, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f5374efd49a5710a7a17665ff19dac5d?s=128&d=identicon&r=PG&f=1", "display_name": "TheDizzle", "link": "https://stackoverflow.com/users/2820641/thedizzle"}, "edited": false, "score": 0, "creation_date": 1444337304, "post_id": 33003236, "comment_id": 53873706, "body": "Well, generally I&#39;m not too keen about placing any application logic inside templates like this, I&#39;d rather place that inside a page controller of some kind to bundle up the logic in more isolated units, it&#39;s easier to maintain and unittest that way. ex: &lt;span&gt;#: myPageController.getRateFormatted(Rate) #&lt;/span&gt;"}], "tags": [], "owner": {"reputation": 733, "user_id": 876085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3880fa51d7823dfae31e5e8cb4e1f0?s=128&d=identicon&r=PG", "display_name": "JFM", "link": "https://stackoverflow.com/users/876085/jfm"}, "is_accepted": false, "score": 1, "last_activity_date": 1444334694, "last_edit_date": 1444334694, "creation_date": 1444255661, "answer_id": 33003236, "question_id": 33002737, "link": "https://stackoverflow.com/questions/33002737/conditional-formatting-of-kendo-grid-column-in-mvc-based-on-secondary-column/33003236#33003236", "title": "Conditional Formatting of Kendo Grid Column in MVC based on secondary column", "body": "<p>This didnt work?</p>\n\n<pre><code>columns.Bound(p =&gt; p.Rate)\n            .Title(FieldTranslation.GetLabel(\"Rate\", GlobalVariables.LanguageID))\n            .HeaderHtmlAttributes(new { title = FieldTranslation.GetLabel(\"Rate\", GlobalVariables.LanguageID) })\n            .ClientTemplate(\"&lt;span&gt;#: BenefitMethod == 'Fixed Amount'? kendo.format('{0:c2}', Rate) : kendo.format('{0:p2}', Rate) #&lt;/span&gt;\");\n</code></pre>\n"}], "owner": {"reputation": 1244, "user_id": 2820641, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f5374efd49a5710a7a17665ff19dac5d?s=128&d=identicon&r=PG&f=1", "display_name": "TheDizzle", "link": "https://stackoverflow.com/users/2820641/thedizzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444334694, "creation_date": 1444253400, "question_id": 33002737, "link": "https://stackoverflow.com/questions/33002737/conditional-formatting-of-kendo-grid-column-in-mvc-based-on-secondary-column", "title": "Conditional Formatting of Kendo Grid Column in MVC based on secondary column", "body": "<p>I have a kendo grid I'm working with in MVC.  We have a <code>BenefitMethod</code> column and a <code>Rate</code> column.  I want to format the <code>Rate</code> column depending on the value inside the <code>BenefitMethod</code> Column.  I'd like to add decimals and a dollar sign or decimals and a percent sign depending on value.</p>\n\n<p>This is my MVC Grid Code</p>\n\n<pre><code>@(Html.Kendo().Grid&lt;xxx.Models.OBEEBenefits&gt;()\n        .Name(\"grid\")\n        .Columns(columns =&gt;\n        {\n            columns.Bound(p =&gt; p.BenefitCode).Title(FieldTranslation.GetLabel(\"BenefitCode\", GlobalVariables.LanguageID)).HeaderHtmlAttributes(new { title = FieldTranslation.GetLabel(\"BenefitCode\", GlobalVariables.LanguageID) });\n            columns.Bound(p =&gt; p.Description).Title(FieldTranslation.GetLabel(\"Description\", GlobalVariables.LanguageID)).HeaderHtmlAttributes(new { title = FieldTranslation.GetLabel(\"Description\", GlobalVariables.LanguageID) });\n            columns.Bound(p =&gt; p.BenefitMethod).Title(FieldTranslation.GetLabel(\"BenefitMethod\", GlobalVariables.LanguageID)).HeaderHtmlAttributes(new { title = FieldTranslation.GetLabel(\"BenefitMethod\", GlobalVariables.LanguageID) });\n            columns.Bound(p =&gt; p.Rate).Title(FieldTranslation.GetLabel(\"Rate\", GlobalVariables.LanguageID)).HeaderHtmlAttributes(new { title = FieldTranslation.GetLabel(\"Rate\", GlobalVariables.LanguageID) });\n            columns.Bound(p =&gt; p.StartDate).Format(\"{0:MM/dd/yyyy}\").Title(FieldTranslation.GetLabel(\"StartDate\", GlobalVariables.LanguageID)).HeaderHtmlAttributes(new { title = FieldTranslation.GetLabel(\"StartDate\", GlobalVariables.LanguageID) });\n            columns.Template(@&lt;text&gt;\n\n            &lt;/text&gt;)\n                  .ClientTemplate(\n                      \"&lt;center&gt;&lt;div class='tw-button'&gt;\" +\n                      \"&lt;a href='\" + Url.Action(\"ProcessForm\", \"OBProcess\", new { id = \"#= RecordID#\", tid = @ViewBag.TaskID, a = \"Dynamic\" }) + \"' title='Edit' class=''&gt;&lt;i class='icon-edit fa fa-pencil fa-fw fa-lg'&gt;&lt;/i&gt;&lt;/a&gt;\" +\n                      \"&lt;a href='\\\\#' title='Delete' class='' data-desc='#= BenefitCode#' id='delete' data-id='#= RecordID#'&gt;&lt;i class='icon-red fa fa-times fa-fw fa-lg'&gt;&lt;/i&gt;&lt;/a&gt;\" +\n                      \"&lt;/center&gt;\").Width(85);\n        })\n            .ToolBar(toolbar =&gt;\n                    {\n                        //toolbar.Create();\n                        toolbar.Save();\n                    })\n            .Editable(editable =&gt; editable.Mode(GridEditMode.InCell))\n            .Pageable()\n            .Sortable()\n            .Filterable()\n            .Groupable()\n        //.Navigatable()\n            .Scrollable()\n            .HtmlAttributes(new { style = \"height:430px;\" })\n            .DataSource(dataSource =&gt; dataSource\n                .Ajax()\n                .PageSize(15)\n                .Batch(true)\n                .ServerOperation(false)\n                .Events(events =&gt; events.Error(\"error_handler\"))\n                .Model(model =&gt;\n                {\n                    //The unique identifier (primary key) of the model is the ProductID property\n                    model.Id(p =&gt; p.RecordID);\n                    // Declare a model field and optionally specify its default value (used when a new model instance is created)\n                    model.Field(p =&gt; p.BenefitCode).Editable(false);\n                    model.Field(p =&gt; p.Description).Editable(false);\n                    model.Field(p =&gt; p.PayPeriod).Editable(false);\n                    model.Field(p =&gt; p.BenefitMethod).Editable(false);\n                    model.Field(p =&gt; p.StartDate).Editable(true);\n                })\n                .Create(update =&gt; update.Action(\"EditingInline_Create\", \"Grid\"))\n                .Read(read =&gt; read.Action(\"BenefitIndex_Read\", \"OBProcess\"))\n                .Update(update =&gt; update.Action(\"BenefitIndex_Update\", \"OBProcess\"))\n                .Destroy(update =&gt; update.Action(\"EditingInline_Destroy\", \"Grid\"))\n            )\n        )\n</code></pre>\n\n<p>I've tried using a Template and a ClientTemplate to no avail as far as doing the conditionals.</p>\n\n<p>The values of the <code>BenefitMethod</code> column can be </p>\n\n<ul>\n<li>Fixed Amount </li>\n<li>Percent of Net Wages</li>\n</ul>\n\n<p>I basically want to do <code>if benefit method is fixed amount show the dollar sign and decimals else show the percent sign and decimals</code></p>\n"}, {"tags": ["c#", "stream", "streamwriter"], "comments": [{"owner": {"reputation": 5640, "user_id": 1938826, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/gTGEx.jpg?s=128&g=1", "display_name": "an earwig", "link": "https://stackoverflow.com/users/1938826/an-earwig"}, "edited": false, "score": 0, "creation_date": 1444253360, "post_id": 33002707, "comment_id": 53830381, "body": "Be sure that you application process is not still running in the background. If the process is still running kill it. If that doesn&#39;t work, try restarting."}, {"owner": {"reputation": 69, "user_id": 3519261, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100003523737845/picture?type=large", "display_name": "user3519261", "link": "https://stackoverflow.com/users/3519261/user3519261"}, "reply_to_user": {"reputation": 5640, "user_id": 1938826, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/gTGEx.jpg?s=128&g=1", "display_name": "an earwig", "link": "https://stackoverflow.com/users/1938826/an-earwig"}, "edited": false, "score": 0, "creation_date": 1444253771, "post_id": 33002707, "comment_id": 53830558, "body": "The file is not open anywhere."}, {"owner": {"reputation": 5640, "user_id": 1938826, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/gTGEx.jpg?s=128&g=1", "display_name": "an earwig", "link": "https://stackoverflow.com/users/1938826/an-earwig"}, "edited": false, "score": 0, "creation_date": 1444253811, "post_id": 33002707, "comment_id": 53830574, "body": "I mean the program that is reading it. Sometimes, when closed incorrectly, the process may stay behind."}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1444254173, "post_id": 33002707, "comment_id": 53830776, "body": "related: <a href=\"http://stackoverflow.com/questions/1187700/does-disposing-a-streamwriter-close-the-underlying-stream\">Does disposing a StreamWriter close the underlying Stream?</a>"}, {"owner": {"reputation": 69, "user_id": 3519261, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100003523737845/picture?type=large", "display_name": "user3519261", "link": "https://stackoverflow.com/users/3519261/user3519261"}, "edited": false, "score": 0, "creation_date": 1444254705, "post_id": 33002707, "comment_id": 53831015, "body": "The stream should close after the using statement anyway. I&#39;ve tried to add a <code>file.Dispose()</code> in there but problem still persists."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3519261, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100003523737845/picture?type=large", "display_name": "user3519261", "link": "https://stackoverflow.com/users/3519261/user3519261"}, "edited": false, "score": 0, "creation_date": 1444253912, "post_id": 33002825, "comment_id": 53830633, "body": "I&#39;ve used that and <code>urltest.vshost.exe</code> is locked the file. Which seems to be the GUI in which my code is running in."}, {"owner": {"reputation": 69, "user_id": 3519261, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100003523737845/picture?type=large", "display_name": "user3519261", "link": "https://stackoverflow.com/users/3519261/user3519261"}, "edited": false, "score": 0, "creation_date": 1444254207, "post_id": 33002825, "comment_id": 53830789, "body": "I have a <code>StreamReader</code> in an earlier function which is in a <code>using</code> statement. This is the only <code>StreamWriter</code> I have in my code."}, {"owner": {"reputation": 69, "user_id": 3519261, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100003523737845/picture?type=large", "display_name": "user3519261", "link": "https://stackoverflow.com/users/3519261/user3519261"}, "edited": false, "score": 0, "creation_date": 1444255617, "post_id": 33002825, "comment_id": 53831396, "body": "Perfect, thank you very much, this made a lot of sense."}], "tags": [], "owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "is_accepted": true, "score": 1, "last_activity_date": 1444255070, "last_edit_date": 1444255070, "creation_date": 1444253823, "answer_id": 33002825, "question_id": 33002707, "link": "https://stackoverflow.com/questions/33002707/file-locked-by-another-process-even-with-using-statement/33002825#33002825", "title": "File locked by another process even with using statement", "body": "<p>There are many reasons why a file can still be locked, e.g. virus scanners.</p>\n\n<p>Use <a href=\"https://technet.microsoft.com/en-us/sysinternals/bb896653.aspx\" rel=\"nofollow\">SysInternals Process Explorer</a>, \"Find Handle\" (<kbd>Ctrl</kbd>+<kbd>F</kbd>), enter your file name and see which application has your file in use.</p>\n\n<p>You have identified <code>urltest.vshost.exe</code> as the culprit (mentioned in a comment), so it must be your code...</p>\n\n<p>In the code provided via PasteBin, I see the following loop</p>\n\n<pre><code>foreach (string file in fileEntries)\n{\n    StreamReader fileStream = new StreamReader(file);\n    ...\n    FileHander(fileStream, extension, websiteURL, fileName);\n}\n</code></pre>\n\n<p>This opens many file streams, but <code>FileHandler()</code> only operates on certain extensions:</p>\n\n<pre><code>private void FileHander(StreamReader fileStream, string extension, string websiteURL, string fileName)\n{\n    switch (extension)\n    {\n        ...\n        CheckPowershell(fileStream, websiteURL, fileName);\n        ...\n    }\n} \n</code></pre>\n\n<p>And only <code>CheckPowershell()</code> closes the files:</p>\n\n<pre><code>private void CheckPowershell(StreamReader fileStream, string websiteURL, string fileName)\n{\n    ...\n    fileStream.Close();\n}\n</code></pre>\n\n<p>So all files which do not have a specific extension (such as <code>.txt</code>) remain open.</p>\n\n<p>A quick solution seems to move the <code>Close()</code> from <code>CheckPowershell()</code> to <code>FileHander()</code>. A more professional way would need more refactoring.</p>\n"}], "owner": {"reputation": 69, "user_id": 3519261, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/100003523737845/picture?type=large", "display_name": "user3519261", "link": "https://stackoverflow.com/users/3519261/user3519261"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1536, "favorite_count": 0, "accepted_answer_id": 33002825, "answer_count": 1, "score": 0, "last_activity_date": 1444255784, "creation_date": 1444253284, "last_edit_date": 1444255784, "question_id": 33002707, "link": "https://stackoverflow.com/questions/33002707/file-locked-by-another-process-even-with-using-statement", "title": "File locked by another process even with using statement", "body": "<p>I'm trying to write to a file called <code>output.txt</code>. It's fine the first time my code runs but the second time it throws an exception:</p>\n\n<blockquote>\n  <p>The process cannot access output1.txt because it is being used by another process</p>\n</blockquote>\n\n<p>But I'm using this in a <code>using</code> statement, and it should be disposed of and the file should be unlocked.</p>\n\n<p>The constructor says <code>if the file exists, it can either be appended to or overwritten</code>. Doesn't seem to be doing this because of the IOException it is throwing.</p>\n\n<p>Why is this happening?</p>\n\n<pre><code>using (System.IO.StreamWriter file = new System.IO.StreamWriter(@directoryURL + \"\\\\output\"+outputNumber+\".txt\", true))\n{\n    foreach (string line in splitOutput)\n    {\n        file.WriteLine(line);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "iis", "iis-express"], "answers": [{"comments": [{"owner": {"reputation": 18474, "user_id": 971141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bad53cc72fd2873b4bd5b426fcc4c1?s=128&d=identicon&r=PG", "display_name": "David Ferenczy Rogo\u017ean", "link": "https://stackoverflow.com/users/971141/david-ferenczy-rogo%c5%bean"}, "edited": false, "score": 0, "creation_date": 1444291066, "post_id": 33005350, "comment_id": 53843524, "body": "I see. That does make a sense. But what can I do to use that certificate and keys under the full IIS, please?"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "reply_to_user": {"reputation": 18474, "user_id": 971141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bad53cc72fd2873b4bd5b426fcc4c1?s=128&d=identicon&r=PG", "display_name": "David Ferenczy Rogo\u017ean", "link": "https://stackoverflow.com/users/971141/david-ferenczy-rogo%c5%bean"}, "edited": false, "score": 1, "creation_date": 1444293215, "post_id": 33005350, "comment_id": 53844858, "body": "@DawidFerenczy you can grant the pool identity access to the certificate. It is very easy to do so in mmc&#39;s certificate management snap in."}, {"owner": {"reputation": 18474, "user_id": 971141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bad53cc72fd2873b4bd5b426fcc4c1?s=128&d=identicon&r=PG", "display_name": "David Ferenczy Rogo\u017ean", "link": "https://stackoverflow.com/users/971141/david-ferenczy-rogo%c5%bean"}, "edited": false, "score": 0, "creation_date": 1444308925, "post_id": 33005350, "comment_id": 53855771, "body": "OK, so I identified the Application Pool used for my application. Identity of this Application Pool is set to &quot;NetworkService&quot;, so I need to grant an access to the certificate for this account, right? I have checked the Certificates in MMC, but I wasn&#39;t able to find where permissions are configured. Could you help me, please? Also what permission do I need?"}, {"owner": {"reputation": 18474, "user_id": 971141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bad53cc72fd2873b4bd5b426fcc4c1?s=128&d=identicon&r=PG", "display_name": "David Ferenczy Rogo\u017ean", "link": "https://stackoverflow.com/users/971141/david-ferenczy-rogo%c5%bean"}, "edited": false, "score": 0, "creation_date": 1444311695, "post_id": 33005350, "comment_id": 53858006, "body": "I have solved it already, this StackOverflow question helped me with a certificate permissions set up: <a href=\"http://stackoverflow.com/questions/2609859/how-to-give-asp-net-access-to-a-private-key-in-a-certificate-in-the-certificate\" title=\"how to give asp net access to a private key in a certificate in the certificate\">stackoverflow.com/questions/2609859/&hellip;</a>."}, {"owner": {"reputation": 579, "user_id": 767463, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/SbT0g.jpg?s=128&g=1", "display_name": "Amruta", "link": "https://stackoverflow.com/users/767463/amruta"}, "edited": false, "score": 0, "creation_date": 1486108258, "post_id": 33005350, "comment_id": 71212701, "body": "How to overcome this exception without any IIS settings?"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "reply_to_user": {"reputation": 579, "user_id": 767463, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/SbT0g.jpg?s=128&g=1", "display_name": "Amruta", "link": "https://stackoverflow.com/users/767463/amruta"}, "edited": false, "score": 0, "creation_date": 1486111865, "post_id": 33005350, "comment_id": 71214529, "body": "@Sonali you cannot. There is no magic. You must follow the answer to make relevant settings."}], "tags": [], "owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "is_accepted": true, "score": 7, "last_activity_date": 1444313074, "last_edit_date": 1495535368, "creation_date": 1444269481, "answer_id": 33005350, "question_id": 33002690, "link": "https://stackoverflow.com/questions/33002690/certificate-private-key-throws-cryptographicexception-under-iis-web-server/33005350#33005350", "title": "Certificate private key throws CryptographicException under IIS Web Server", "body": "<p>Running on IIS Express, the program uses your credentials to access the certificate, while on IIS the pool identity's credentials are used. You can easily check the certificate ACL to see who is allowed or not.</p>\n\n<p>Follow these steps:</p>\n\n<ol>\n<li><p><strong>Check what Application Pool your web site uses</strong></p>\n\n<p>Open <em>Internet Information Services Manager</em>, select <em>Sites</em> in the <em>Connections</em> tree on the left. Select your site in the middle panel and click <em>Basic settings</em> under <em>Actions</em> on the right panel.</p></li>\n<li><p><strong>Check what identity the Application Pool uses</strong></p>\n\n<p>Select <em>Application Pools</em> in the <em>Connections</em> tree on the left and find the identity in the middle panel. It'll be probably \"NETWORK SERVICE\".</p></li>\n<li><p><strong>Add read permissions for the identity used by Application Pool to your certificate</strong></p>\n\n<p>Open the <em>Microsoft Management Console</em> (<code>mmc</code>), add the <em>Certificates</em> snap-in for local Computer account and find your certificate under <em>Personal</em> certificates. Open its context menu, <em>All Tasks</em> and <em>Manage Private Keys...</em>. Click <em>Add..</em>, enter the identity (\"NETWORK SERVICE\") and click <em>Check Names</em> and <em>OK</em>. Under <em>Permissions for </em> allow only the <em>Read</em> permission.</p>\n\n<p>You can read details in this question: <a href=\"https://stackoverflow.com/questions/2609859/how-to-give-asp-net-access-to-a-private-key-in-a-certificate-in-the-certificate\">How to give ASP.NET access to a private key in a certificate in the certificate store?</a></p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 579, "user_id": 767463, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/SbT0g.jpg?s=128&g=1", "display_name": "Amruta", "link": "https://stackoverflow.com/users/767463/amruta"}, "edited": false, "score": 0, "creation_date": 1486108423, "post_id": 36485592, "comment_id": 71212768, "body": "This solution doesn&#39;t work in my scenario..I have already set highest permission for almost IUSRS,Everyone,IUSR...but still the same exception of &quot;store.storehandle threw an exception of type system.security.cryptography.cryptographicexception&quot; is fired..Any advice..highly appreciated."}, {"owner": {"reputation": 1484, "user_id": 1626767, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/P5KrX.jpg?s=128&g=1", "display_name": "OpMt", "link": "https://stackoverflow.com/users/1626767/opmt"}, "edited": false, "score": 0, "creation_date": 1616032646, "post_id": 36485592, "comment_id": 117879051, "body": "This worked for me. Only had to add &quot;Everyone&quot; with only Read permission."}], "tags": [], "owner": {"reputation": 31, "user_id": 6174056, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/044d9091f4876baacad48ff6064cddb6?s=128&d=identicon&r=PG", "display_name": "Tamar", "link": "https://stackoverflow.com/users/6174056/tamar"}, "is_accepted": false, "score": 3, "last_activity_date": 1460057745, "creation_date": 1460057745, "answer_id": 36485592, "question_id": 33002690, "link": "https://stackoverflow.com/questions/33002690/certificate-private-key-throws-cryptographicexception-under-iis-web-server/36485592#36485592", "title": "Certificate private key throws CryptographicException under IIS Web Server", "body": "<p>I was having this problem to debug the application \".PrivateKey' threw an exception of type 'System.Security.Cryptography.CryptographicException\"\nI solve like this:</p>\n\n<p>In mmc > Local Computer > Personal > Certificate > right click on certificate > All Tasks > Manage Private Keys:\nAdd \"everyone\" user and select Total Control.</p>\n"}], "owner": {"reputation": 18474, "user_id": 971141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bad53cc72fd2873b4bd5b426fcc4c1?s=128&d=identicon&r=PG", "display_name": "David Ferenczy Rogo\u017ean", "link": "https://stackoverflow.com/users/971141/david-ferenczy-rogo%c5%bean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7260, "favorite_count": 0, "accepted_answer_id": 33005350, "answer_count": 2, "score": 4, "last_activity_date": 1597157910, "creation_date": 1444253191, "last_edit_date": 1460383502, "question_id": 33002690, "link": "https://stackoverflow.com/questions/33002690/certificate-private-key-throws-cryptographicexception-under-iis-web-server", "title": "Certificate private key throws CryptographicException under IIS Web Server", "body": "<p>In my ASP.NET application I'm loading a certificate from the certificate store:</p>\n\n<pre><code>var myCert = CertificateUtils.GetCertificate(\"thumbprint\");\n</code></pre>\n\n<p>This certificate contains a key pair which is used to decrypt the encrypted application settings.</p>\n\n<p>The certificate is installed in <em>Personal</em> certificate store under the <em>Local Computer</em>. It works well when the application is running under the <em>IIS Express</em>. But if I execute it under the <strong>full</strong> <em>IIS Web Server</em>, the <code>myCert</code> instance is <strong>missing the private key</strong>.</p>\n\n<p>The <code>PrivateKey</code> field of <code>myCert</code> object contains an exception:</p>\n\n<pre><code>'myCert.PrivateKey' threw an exception of type 'System.Security.Cryptography.CryptographicException'\n</code></pre>\n\n<p>I have checked that other fields of <code>myCert</code> object contain same values (like, for example, certificate serial number, thumbprint or expiration), so it seems it's getting the same certificate under both <em>IIS</em> and <em>IIS Express</em>. Only the private key is missing in the case of full <em>IIS</em>.</p>\n\n<p>The only thing I have changed was the <em>Local Development Server</em> in project's properties (\"Use IIE Express\" / \"Use IIS Web Server\"). It's running inside the <strong>Azure Emulator Express</strong> in both cases.</p>\n\n<p>Does anyone have an idea, why is this happenning?</p>\n"}, {"tags": ["c#", "jquery", "css", "asp.net", "gridview"], "answers": [{"tags": [], "owner": {"reputation": 115, "user_id": 5075108, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/22e2482a1236bbbad038863a37946027?s=128&d=identicon&r=PG&f=1", "display_name": "N&#39;oel C&#39;alero", "link": "https://stackoverflow.com/users/5075108/noel-calero"}, "is_accepted": false, "score": 0, "last_activity_date": 1444316540, "creation_date": 1444316540, "answer_id": 33019477, "question_id": 33002650, "link": "https://stackoverflow.com/questions/33002650/gridview-asp-net-lock-first-columns-and-first-rows/33019477#33019477", "title": "Gridview ASP.NET lock first columns and first rows", "body": "<p>I kept working on this last night and I found a solution for columns 0 and 1, nevertheless I'm still missing to freeze the first rows (0, 1, 2). This example I worked freezes the header but as I said previously I will hide header.</p>\n\n<p>This is the new code I'm applying:</p>\n\n<p>HTML:</p>\n\n<pre><code>                       &lt;div&gt;\n                   &lt;asp:GridView ID=\"cphMain_cphMain_cphMain_GridView2\" runat=\"server\" Width=\"100%\" AutoGenerateColumns=\"true\" GridLines=\"None\" \n                       OnRowCreated=\"COl\"   OnRowDataBound=\"ROWCSS\"&gt;  \n                   &lt;RowStyle HorizontalAlign=\"Left\" VerticalAlign=\"Middle\" Wrap=\"False\" /&gt;\n\n                &lt;/asp:GridView&gt;\n                &lt;script type=\"text/javascript\"&gt;\n                    $(document).ready(function () {\n                        $('#cphMain_cphMain_cphMain_GridView2').gridviewScroll({\n                            width: 930,\n                            height: 400,\n                            freezesize: 2\n                        });\n                    });\n                 &lt;/script&gt;\n               &lt;/div&gt; \n</code></pre>\n\n<p>In the \"head\" section I placed these scripts addresses:</p>\n\n<p>HTML :</p>\n\n<pre><code>       &lt;script type=\"text/javascript\" src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js\"&gt;&lt;/script&gt; \n   &lt;script type=\"text/javascript\" src=\"http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js\"&gt;&lt;/script&gt; \n   &lt;script src=\"JQuery/GridViewHeader.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>To provide the grid with CSS format I'm using the same Events I mentioned above, except the CSS extentions: Pinned, col1, col2, scrolled.</p>\n\n<p>This is not longer used:</p>\n\n<pre><code> //THIS IS THE FOR, THAT LOCKS THE COLUMN 0 and 1 ************\n\n        for (int j = 0; j &lt;= (i - 1); j++)\n        {\n\n            if (j == 0)\n            {\n                e.Row.Cells[j].CssClass = \"pinned col1\";\n            }\n            else if (j == 1)\n            {\n                e.Row.Cells[j].CssClass = \"pinned col2\";\n            }\n\n            else\n            {\n                e.Row.Cells[j].CssClass = \"scrolled\";\n            }\n\n        }\n\n//********************************\n</code></pre>\n\n<p>If you question what code is inside of:</p>\n\n<pre><code>&lt;script src=\"JQuery/GridViewHeader.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>you can check that out in here (to be honest I can't read this I just found it and copied pasted):</p>\n\n<p><a href=\"http://gridviewscroll.aspcity.idv.tw/Scripts/gridviewScroll.min.js?20130319\" rel=\"nofollow\">http://gridviewscroll.aspcity.idv.tw/Scripts/gridviewScroll.min.js?20130319</a></p>\n\n<p>I took the example from:</p>\n\n<p><a href=\"http://gridviewscroll.aspcity.idv.tw/Demo.aspx\" rel=\"nofollow\">http://gridviewscroll.aspcity.idv.tw/Demo.aspx</a></p>\n"}], "owner": {"reputation": 115, "user_id": 5075108, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/22e2482a1236bbbad038863a37946027?s=128&d=identicon&r=PG&f=1", "display_name": "N&#39;oel C&#39;alero", "link": "https://stackoverflow.com/users/5075108/noel-calero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3376, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444321900, "creation_date": 1444253007, "last_edit_date": 1444321900, "question_id": 33002650, "link": "https://stackoverflow.com/questions/33002650/gridview-asp-net-lock-first-columns-and-first-rows", "title": "Gridview ASP.NET lock first columns and first rows", "body": "<p>I need to freeze the columns 0, 1 at the same time I want the rows (NOT HEADER, HEADER is hidden) 0, 1, 2 frozen as well when the user scrolls up and down and also scrolls left to right these columns and rows will be statics in there, I tried some jQuery code but it did not work, I found this CSS example in a Stack Overflow question I took it for my project. So far I'm only working with the columns to get this done ASAP, however I will need as I said before the rows locked as well.</p>\n\n<p>I have a gridview ASP.NET C# inside of an HTML table, in the event \"load page\" the grid gets filled with a datatable information. this Datable gets info from a SQL database.</p>\n\n<p>I'm applying CSS on the grid when the events fire, all these work fine!</p>\n\n<p>To give you an idea how the grid looks like, here your are an example:</p>\n\n<p><img src=\"https://i.stack.imgur.com/suOcx.jpg\" alt=\"enter image description here\"></p>\n\n<p>You can't see the horizontal scroll bar because the amount of years the user chose, but this can change based on his selection.</p>\n\n<p>This is the CSS I used lately:</p>\n\n<pre><code>    .pinned\n{\n    position:fixed; \n    background-color: #FFFFFF; \n    z-index: 100;\n\n\n}\n.scrolled\n{\n    position: relative;\n    left: 150px; \n    overflow: hidden;\n    white-space: nowrap;\n    min-width: 50px; \n}\n.col1\n{\n    left: 0px;\n    width: 50px;\n}\n.col2\n\n{\n    left: 50px;  \n    width: 100px;\n}\n</code></pre>\n\n<p>HTML:</p>\n\n<pre><code>      &lt;div style=\"overflow:scroll; height: 400px; width: 911px; margin:auto;\"&gt;\n &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AutoGenerateColumns=\"true\" GridLines=\"Vertical\" OnRowCreated=\"COl\" OnRowDataBound=\"ROWCSS\" ShowHeader=\"false\"&gt; \n\n &lt;/asp:GridView&gt; \n&lt;/div&gt;\n</code></pre>\n\n<p>This the C# code, when the rowcreated event fires: then I colspan the headers (first 3 rows -0,1,2-) </p>\n\n<p>When the rowdatabound fires: then I apply the CSS font and background color:</p>\n\n<pre><code>        protected void ROWCSS(object sender, GridViewRowEventArgs e)\n    {\n        int i = e.Row.Cells.Count;\n        int index = e.Row.RowIndex;\n\n\n\n        if (e.Row.RowType == DataControlRowType.DataRow)\n        {\n\n //THIS IS THE FOR, THAT LOCKS THE COLUMN 0 and 1 ************\n\n            for (int j = 0; j &lt;= (i - 1); j++)\n            {\n\n                if (j == 0)\n                {\n                    e.Row.Cells[j].CssClass = \"pinned col1\";\n                }\n                else if (j == 1)\n                {\n                    e.Row.Cells[j].CssClass = \"pinned col2\";\n                }\n\n                else\n                {\n                    e.Row.Cells[j].CssClass = \"scrolled\";\n                }\n\n            }\n\n //********************************\n\n\n            if (index == 3 || index == 32 || index == 46 || index == 50)\n            {\n                for (int j = 0; j &lt;= (i - 1); j++)\n                {\n                    //Si la columna es la 0 o la 1, entonces aplicar formato izquierdo\n                    if (j == 0 || j == 1)\n                    {\n                        e.Row.Cells[j].CssClass = \"naranjaCSSLEFT\";\n                    }\n                    //En caso contrario, formato derecho\n                    else\n                    {\n                        e.Row.Cells[j].CssClass = \"naranjaCSSRIGHT\";\n                    }\n\n                }\n            }\n\n            else if (index == 4 || index == 15 || index == 29 || index == 33 || index == 41)\n            {\n                for (int j = 0; j &lt;= (i - 1); j++)\n                {\n                    //Si la columna es la 0 o la 1, entonces aplicar formato izquierdo\n                    if (j == 0 || j == 1)\n                    {\n                        e.Row.Cells[j].CssClass = \"azulCSSLEFT\";\n                    }\n                    //En caso contrario, formato derecho\n                    else\n                    {\n                        e.Row.Cells[j].CssClass = \"azulCSSRIGHT\";\n                    }\n\n                }\n            }\n\n            else if (!(index == 0 || index == 1 || index == 2))\n            {\n                for (int j = 0; j &lt;= (i - 1); j++)\n                {\n                    //Si la columna es la 0 o la 1, entonces aplicar formato izquierdo\n                    if (j == 0 || j == 1)\n                    {\n                        e.Row.Cells[j].CssClass = \"negroCSSLEFT\";\n                    }\n                    //En caso contrario, formato derecho\n                    else\n                    {\n                        e.Row.Cells[j].CssClass = \"negroCSSRIGHT\";\n                    }\n\n                }\n            }\n\n\n\n        }\n    }\n</code></pre>\n\n<p>Finally this is some of the CSS I used to color fonts and background (not sure if this is necessary to provide):</p>\n\n<pre><code>                    .naranjaCSSLEFT\n            {\n            font-weight:bold;\n            color:#C65911;\n            font-size: 13px;\n            text-align:left;\n            font-family:tahoma;\n            }\n            .naranjaCSSRIGHT\n            {\n            font-weight:bold;\n            color:#C65911;\n            font-size: 13px;\n            text-align:right;\n            font-family:tahoma;\n            }\n\n            .azulCSSLEFT\n            {\n            font-weight:bold;\n            color:#2F75B5;\n            font-size: 13px;\n            text-align:left;\n            font-family:tahoma;\n            }\n            .azulCSSRIGHT\n            {\n            font-weight:bold;\n            color:#2F75B5;\n            font-size: 13px;\n            text-align:right;\n            font-family:tahoma;\n            }\n            .negroCSSLEFT\n            {\n            font-weight:normal;\n            color:#000000;\n            font-size: 13px;\n            text-align:left;\n            font-family:tahoma;\n            }\n            .negroCSSRIGHT\n            {\n            font-weight:normal ;\n            color:#000000;\n            font-size: 13px;\n            text-align:right;\n            font-family:tahoma;\n\n            }\n\n            .FILACSS\n            {\n            font-weight:bold ;\n            color:#FFFFFF;\n            font-size: 13px;\n            text-align:center;\n            font-family:tahoma;\n            background:#2F75B5;\n            border:hidden;\n            }\n</code></pre>\n\n<p>If you are wondering what am I getting after applying this is this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/CeyMj.jpg\" alt=\"After css effects\"></p>\n\n<p>It looks: screwed up! the 3 first rows... don't know what happened. The colspan is applied in a different event.</p>\n\n<p>if you wonder what the colspan Rowcreated event is, is this:</p>\n\n<pre><code>        protected void COl(object sender, GridViewRowEventArgs e)\n    {\n        int index = e.Row.RowIndex;\n        int i = e.Row.Cells.Count;\n\n        if (i == 4)\n        {\n\n            if (index == 0)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    //e.Row.Cells[j].CssClass = \"GVFixedHeader\";\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n                // e.Row.Cells[2].Text = \"ACUMULADO DE ENERO - \" + NomMes;\n\n                e.Row.Cells[2].ColumnSpan = 2;\n                e.Row.Cells.RemoveAt(3);\n            }\n\n            if (index == 1)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n            }\n\n            if (index == 2)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n            }\n\n\n\n        }\n        if (i == 8)\n        {\n            if (index == 0)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    //e.Row.Cells[j].CssClass = \"FILACSS\";\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n\n                }\n\n                //*******************************\n                //e.Row.Cells[0].Text = \"ACUMULADO DE ENERO - \" + NomMes;\n                e.Row.Cells[2].ColumnSpan = 6;\n\n                for (int b = 7; b &gt;= 3; b--)\n                {\n                    e.Row.Cells.RemoveAt(b);\n                }\n\n\n            }\n\n            if (index == 1)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    //e.Row.Cells[j].CssClass = \"FILACSS\";\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n                //******************************\n                for (int b = 2; b &lt;= 6; b++)\n                {\n                    e.Row.Cells[b].ColumnSpan = 2;\n                    b++;\n                }\n\n                for (int b = 7; b &gt;= 3; b--)\n                {\n                    e.Row.Cells.RemoveAt(b);\n                    b--;\n                }\n\n\n            }\n\n            if (index == 2)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    //e.Row.Cells[j].CssClass = \"FILACSS\";\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n            }\n        }\n        if (i == 10)\n        {\n\n            if (index == 0)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n                //*******************************\n                //e.Row.Cells[2].Text = \"ACUMULADO DE ENERO - \" + NomMes;\n                e.Row.Cells[2].ColumnSpan = 8;\n\n                for (int b = 9; b &gt;= 3; b--)\n                {\n                    e.Row.Cells.RemoveAt(b);\n                }\n\n\n            }\n\n            if (index == 1)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n                //******************************\n                for (int b = 2; b &lt;= 8; b++)\n                {\n                    e.Row.Cells[b].ColumnSpan = 2;\n                    b++;\n                }\n\n                for (int b = 9; b &gt;= 3; b--)\n                {\n                    e.Row.Cells.RemoveAt(b);\n                    b--;\n                }\n\n\n            }\n\n            if (index == 2)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n            }\n\n        }\n\n        if (i == 12)\n        {\n            if (index == 0)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n                //*******************************\n                //e.Row.Cells[2].Text = \"ACUMULADO DE ENERO - \" + NomMes;\n                e.Row.Cells[2].ColumnSpan = 10;\n\n                for (int b = 11; b &gt;= 3; b--)\n                {\n                    e.Row.Cells.RemoveAt(b);\n                }\n\n\n            }\n\n            if (index == 1)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n                //******************************\n                for (int b = 2; b &lt;= 10; b++)\n                {\n                    e.Row.Cells[b].ColumnSpan = 2;\n                    b++;\n                }\n\n                for (int b = 11; b &gt;= 3; b--)\n                {\n                    e.Row.Cells.RemoveAt(b);\n                    b--;\n                }\n\n\n            }\n\n            if (index == 2)\n            {\n                for (int j = 2; j &lt;= (i - 1); j++)\n                {\n                    e.Row.Cells[j].CssClass = \"FILACSS\";\n                }\n\n            }\n        }\n    }\n</code></pre>\n\n<p>The columns are not getting frozen yet.</p>\n"}, {"tags": ["c#", "wpf", "linq"], "comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 1, "creation_date": 1444252895, "post_id": 33002598, "comment_id": 53830170, "body": "It would be simpler to simply call <code>.ToList()</code> on your subquery.  Like this:  <code>x.Descendants(&quot;Prefix&quot;).Select(p =&gt; new Prefix(....).ToList()</code>"}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444253083, "post_id": 33002598, "comment_id": 53830260, "body": "Also note that you may get null reference exceptions when attributes (or elements) aren&#39;t there.  You can avoid this by using an explicit cast to <code>string</code> (which will return null if the element/attribute is not found).  E.g., <code>(string)p.Attribute(&quot;Char&quot;)</code> or <code>Convert.ToDouble((string)p.Attribute(&quot;Factor&quot;))</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2973, "user_id": 1196886, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5143984de4abf18cfe2aaef3f1fff7c2?s=128&d=identicon&r=PG", "display_name": "Ronan Thibaudau", "link": "https://stackoverflow.com/users/1196886/ronan-thibaudau"}, "is_accepted": false, "score": 1, "last_activity_date": 1444253556, "creation_date": 1444253556, "answer_id": 33002769, "question_id": 33002598, "link": "https://stackoverflow.com/questions/33002598/how-can-i-read-a-complete-xml-element-here/33002769#33002769", "title": "How can I read a complete XML element here?", "body": "<p>It's not a list as is but a query, so you can't just cast it to a list but you can call ToList on it to have it enumerated and a list returned:</p>\n\n<pre><code> Form.Units = (data.Descendants(\"Unit\").Select(x =&gt; new Unit\n                 (\n                    x.Attribute(\"Name\").Value,\n                    //(List&lt;Prefix&gt;) no casting needed\n                    x.Descendants(\"Prefix\").Select(p =&gt; new Prefix(\n                        p.Attribute(\"Char\").Value,\n                        Convert.ToDouble(p.Attribute(\"Factor\").Value),\n                        p.Attribute(\"IsSelected\").Value == \"true\",\n                        p.Attribute(\"IsFixed\").Value == \"true\",\n                        p.Attribute(\"Func\").Value)\n                     ).ToList() // you had an IEnumerable&lt;Prefix&gt; now this is a List&lt;Prefix&gt;\n                  )\n                )\n           ).ToDictionary(x =&gt; x.Name, x =&gt; x);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1444253611, "creation_date": 1444253611, "answer_id": 33002784, "question_id": 33002598, "link": "https://stackoverflow.com/questions/33002598/how-can-i-read-a-complete-xml-element-here/33002784#33002784", "title": "How can I read a complete XML element here?", "body": "<p>To expand upon my comments, there are a couple of things here.  First, you can use the <code>.ToList()</code> extension method on the <code>.Select</code> to convert the <code>IEnumerable&lt;T&gt;</code> collection to a <code>List&lt;T&gt;</code>.</p>\n\n<p>Secondly, you will get a null reference exception if any attributes or elements are missing in the query.  You can handle this safely by explicitly casting to <code>string</code> (and then converting the result if needed).  </p>\n\n<p>The updated query would look like this:</p>\n\n<pre><code>Form.Units = (data.Descendants(\"Unit\").Select(x =&gt; new Unit\n    ((string)x.Attribute(\"Name\"),\n     x.Descendants(\"Prefix\").Select(p =&gt; new Prefix(\n         (string)p.Attribute(\"Char\"),\n         Convert.ToDouble((string)p.Attribute(\"Factor\")),\n         (string)p.Attribute(\"IsSelected\") == \"true\",\n         (string)p.Attribute(\"IsFixed\") == \"true\",\n         (string)p.Attribute(\"Func\")).ToList()\n      )\n    )\n)\n).ToDictionary(x =&gt; x.Name, x =&gt; x);\n</code></pre>\n\n<p>Note that you don't need <code>.Value</code> when using <code>(string)</code> (since <code>.Value</code> is already <code>string</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1444256678, "post_id": 33003394, "comment_id": 53831825, "body": "<code>.Descendants</code> returns a <i>collection</i> of <code>XElement</code>, with said collection containing all the children elements that match the selector.  Additionally, based on OP&#39;s XML, your query will throw a null reference exception on attributes that are not present in the <code>XElement</code> object."}], "tags": [], "owner": {"reputation": 732, "user_id": 3987238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832a63417e6cb501610dd162df301714?s=128&d=identicon&r=PG&f=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/3987238/brett-caswell"}, "is_accepted": true, "score": 1, "last_activity_date": 1444256724, "last_edit_date": 1444256724, "creation_date": 1444256422, "answer_id": 33003394, "question_id": 33002598, "link": "https://stackoverflow.com/questions/33002598/how-can-i-read-a-complete-xml-element-here/33003394#33003394", "title": "How can I read a complete XML element here?", "body": "<p>I would express this code in the following manner.. for it avoids doing parameter constructors that would constrain these types to IEnuermable expressions. i.e. avoid doing parameter constructors on types you plan to use for querying..</p>\n\n<p>I'm placeholding the types that are using in/by <code>Decendents</code> as <code>XmlElement</code> type... but I'm sure that's inaccurate.. just replace it with whatever is the correct type.</p>\n\n<p>Additionally, this snippet doesn't account for <code>Unit.funcs.TryGetValue(fn, out fnc);</code>.. and it presumes there is property name <code>Func</code> on the <code>Prefix</code> type. You can perform null checks during he assignment/setting.. </p>\n\n<pre><code>data.Descendants(\"Unit\")\n                .Select&lt;XmlElement, Unit&gt;(x =&gt; new Unit() \n                { \n                    Name = x.Attribute(\"Name\").Value,\n                    Prefixes = x.Descendants(\"Prefix\").Select&lt;XmlElement, Prefix&gt;(p =&gt; new Prefix() \n                    {\n                        Char = p.Attribute(\"Char\").Value,\n                        Factor = Convert.ToDouble(p.Attribute(\"Factor\").Value),\n                        IsSelectd = p.Attribute(\"IsSelected\").Value == \"true\",\n                        IsFixed = p.Attribute(\"IsFixed\").Value == \"true\",\n                        Func = p.Attribute(\"Func\").Value\n                    }).ToList()\n                })\n                .Select&lt;Unit, KeyValuePair&lt;string, Unit&gt;&gt;(unit =&gt; new KeyValuePair&lt;string, Unit&gt;() \n                {\n                    Key = x.Name,\n                    Value = x \n                })\n                .ToList()\n                .ForEach( kvp =&gt; {\n                    Form.Units.Add(kvp.Key, kvp.Value);\n                });\n</code></pre>\n"}], "owner": {"reputation": 808, "user_id": 3360864, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/z8m64.jpg?s=128&g=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/3360864/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 33003394, "answer_count": 3, "score": 0, "last_activity_date": 1444256724, "creation_date": 1444252789, "question_id": 33002598, "link": "https://stackoverflow.com/questions/33002598/how-can-i-read-a-complete-xml-element-here", "title": "How can I read a complete XML element here?", "body": "<p>I have an XML file with a number of <code>Unit</code>s:</p>\n\n<pre><code>&lt;Unit Name=\"Length\"&gt;\n&lt;Prefix Char=\"c\"\n          IsSelected=\"false\"\n          Factor=\"1\"/&gt;\n\n&lt;Prefix Char=\"d\"\n          IsSelected=\"true\"\n          Factor=\"104\"/&gt;\n&lt;/Unit&gt;\n</code></pre>\n\n<p>I want to read an entire object:</p>\n\n<pre><code>public static Dictionary&lt;string, Unit&gt; Units { get; set; } \npublic class Prefix\n{\n    public Func&lt;double, double&gt; fnc = null;            \n    public Prefix(string c, double f, bool i, bool ifix = false,string fn = null)\n    {\n        Char = c;\n        Factor = f;\n        IsFixed = ifix;\n        Unit.funcs.TryGetValue(fn, out fnc);\n    }\n\n     public bool IsSelected { get; set; }\n     public bool IsFixed { get; set; }\n     public double Factor { get; set; }\n     public string Char { get; set; }\n\n}\n\npublic Unit() { }\npublic Unit(string n, List&lt;Prefix&gt; p)\n{\n    _name = n;\n    Prefixes = p;\n}\n\n private List&lt;Prefix&gt; _prefixes;\n public List&lt;Prefix&gt; Prefixes\n {\n     get { return _prefixes; }\n     set { _prefixes = value;  }\n }\n private string _name;\n public string Name\n { \n    get { return _name; }\n    set { _name = value; }\n }\n  ....\n }\n</code></pre>\n\n<p>I now have this:</p>\n\n<pre><code> Form.Units = (data.Descendants(\"Unit\").Select(x =&gt; new Unit\n                     (\n                        x.Attribute(\"Name\").Value,\n                        (List&lt;Prefix&gt;) x.Descendants(\"Prefix\").Select(p =&gt; new Prefix(\n                            p.Attribute(\"Char\").Value,\n                            Convert.ToDouble(p.Attribute(\"Factor\").Value),\n                            p.Attribute(\"IsSelected\").Value == \"true\",\n                            p.Attribute(\"IsFixed\").Value == \"true\",\n                            p.Attribute(\"Func\").Value)\n                         )\n                      )\n                    )\n               ).ToDictionary(x =&gt; x.Name, x =&gt; x);\n</code></pre>\n\n<p>and get the following error:</p>\n\n<blockquote>\n  <p>\"Unable to cast object of type\n  'WhereSelectEnumerableIterator<code>2[System.Xml.Linq.XElement,DD.Prefix]'\n  to type 'System.Collections.Generic.List</code>1[DD.Prefix]'.\"</p>\n</blockquote>\n\n<p>Apparently there is something wrong with the <code>(List&lt;Prefix&gt;)</code></p>\n\n<p>What would the query have to be then? How do I get stuff in the List&lt;>?</p>\n\n<p>.</p>\n"}, {"tags": ["c#", "wpf", "mvvm", "prism"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5420778"}, "is_accepted": false, "score": 3, "last_activity_date": 1444263175, "creation_date": 1444263175, "answer_id": 33004524, "question_id": 33002585, "link": "https://stackoverflow.com/questions/33002585/wpf-cascading-combobox-using-prism-6/33004524#33004524", "title": "WPF Cascading Combobox using PRISM 6", "body": "<p>This isn't really a Prism issue.  To accomplish this task you simply need to place code in the setter of the PackageNameSelected property and then call your method to generate the dependent collection of options.  There are other ways to do it, but this is the most straight forward.</p>\n"}], "owner": {"reputation": 628, "user_id": 2658820, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/a863c68d1a10f25c7ce466be6d7133dd?s=128&d=identicon&r=PG", "display_name": "HiTech", "link": "https://stackoverflow.com/users/2658820/hitech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444268261, "creation_date": 1444252724, "last_edit_date": 1444268261, "question_id": 33002585, "link": "https://stackoverflow.com/questions/33002585/wpf-cascading-combobox-using-prism-6", "title": "WPF Cascading Combobox using PRISM 6", "body": "<p>To keep things simple, I  have two comboboxes on my view. I would like to cascade them while adhering to the MVVM design pattern and the PRISM 6 framework. Following Brian Lagunas MVVM/Prism <a href=\"https://www.youtube.com/watch?v=ZfBy2nfykqY\" rel=\"nofollow\">webinar</a> he mentions the <code>DelegateCommand</code>'s <code>ObservesProperty</code>. I have a hunch that's something I should be using but not sure. I provided a very simple View and ViewModel that I can't get working.</p>\n\n<h3>XAML (View):</h3>\n\n<pre><code>&lt;ComboBox ItemsSource=\"{Binding PackageNames}\" SelectedItem=\"{Binding PackageNameSelected}\" /&gt;\n&lt;ComboBox ItemsSource=\"{Binding PackageOptions}\"/&gt;\n</code></pre>\n\n<h3>ViewModel:</h3>\n\n<pre><code>public MainWindowViewModel() // Constructor\n{\n    PackageNamesCommand = new DelegateCommand(PackageNamesCommandExecute);\n    PackageOptionsCommand = new DelegateCommand(PackageOptionsCommandExecute).ObservesProperty(() =&gt; PackageNameSelected);\n}\n\nprivate string _packageNameSelected;\npublic string PackageNameSelected\n{\n    get { return _packageNameSelected; }\n    set { SetProperty(ref _packageNameSelected, value); }\n}\n\nprivate ObservableCollection&lt;string&gt; _packeNames;\npublic ObservableCollection&lt;string&gt; PackageNames\n{\n    get { return _packeNames; }\n    set { SetProperty(ref _packeNames, value); }\n}\n\nprivate ObservableCollection&lt;string&gt; _packageOptions;\npublic ObservableCollection&lt;string&gt; PackageOptions\n{\n    get { return _packageOptions; }\n    set { SetProperty(ref _packageOptions, value); }\n}\n\npublic DelegateCommand PackageNamesCommand { get; set; }\n\nprivate async void PackageNamesCommandExecute()\n{\n    await Task.Factory.StartNew(() =&gt; GetPackageNames()).ContinueWith(t =&gt; PackageNames = ToObservableCollection(t.Result));\n}\n\nprivate IQueryable&lt;string&gt; GetPackageNames()\n{\n    return //My LINQ Query Here\n}\n\npublic DelegateCommand PackageOptionsCommand { get; set; }\n\nprivate void PackageOptionsCommandExecute()\n{\n    Task.Factory.StartNew(() =&gt; GetPackageOptions()).ContinueWith(t =&gt; PackageOptions = ToObservableCollection(t.Result));\n}\n\nprivate IQueryable&lt;string&gt; GetPackageOptions()\n{\n    return // My LINQ query here\n}\n</code></pre>\n"}, {"tags": ["c#", "unit-testing", "windows-runtime"], "comments": [{"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "edited": false, "score": 0, "creation_date": 1444253828, "post_id": 33002445, "comment_id": 53830581, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/468791/is-there-a-way-of-setting-culture-for-a-whole-application-all-current-threads-a\">Is there a way of setting culture for a whole application? All current threads and new threads?</a>"}, {"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1444255007, "post_id": 33002445, "comment_id": 53831150, "body": "why aren&#39;t you just passing <code>CultureInfo.CurrentUICulture</code>?"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "edited": false, "score": 0, "creation_date": 1444256241, "post_id": 33002445, "comment_id": 53831662, "body": "@JonathonChase not a duplicate - WinRT is different."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1444259785, "post_id": 33002445, "comment_id": 53832841, "body": "You ought to check it first against the ApplicationLanguages.ManifestLanguages list.  Low odds in a unit test no doubt."}, {"owner": {"reputation": 30272, "user_id": 3795379, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/766013b4f63e7e59fde497a5b66a383d?s=128&d=identicon&r=PG", "display_name": "akazemis", "link": "https://stackoverflow.com/users/3795379/akazemis"}, "edited": false, "score": 0, "creation_date": 1476741856, "post_id": 33002445, "comment_id": 67465550, "body": "How come not to fake the <code>CurrentInfo.CurrentUICulture.Name</code> ?  That sounds more reasonable as it&#39;s a dependency for your method."}], "owner": {"reputation": 10053, "user_id": 322518, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfc432d64d41eef026c93901ff14d99e?s=128&d=identicon&r=PG&f=1", "display_name": "O.O", "link": "https://stackoverflow.com/users/322518/o-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1045, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1444254189, "creation_date": 1444252103, "last_edit_date": 1444254189, "question_id": 33002445, "link": "https://stackoverflow.com/questions/33002445/how-to-set-cultureinfo-for-unit-tests", "title": "How to set CultureInfo for unit tests?", "body": "<p>Seems like people are not getting the whole tag concept. Before you mark this as a duplicate, understand that <code>Thread.CurrentThread.CurrentCulture</code> does not exist in <strong>WinRT/Windows Runtime</strong>.</p>\n\n<p>Want to test following code with a culture other than the default:</p>\n\n<pre><code>public string Now =&gt;\n    DateTime.Now.ToString(\"g\", new CultureInfo(CultureInfo.CurrentUICulture.Name));\n</code></pre>\n\n<p>So far,</p>\n\n<pre><code>[UITestMethod]\npublic void UI_NowIsLocalizable()\n{\n    // Arrange\n    Clock clock = new Clock();\n    Windows.Globalization.ApplicationLanguages.PrimaryLanguageOverride = \"de-DE\";\n    string expected = DateTime.Now.ToString(\"g\");\n\n    // Act\n    string actual = clock.Now;\n\n    // Assert\n    Assert.AreEqual(expected, actual);\n}\n</code></pre>\n\n<p>While debugging the test, <code>CultureInfo.CurrentUICulture.Name</code> still shows us-en and the test passes (should fail).</p>\n"}, {"tags": ["c#", "sql", "sql-server", "stored-procedures"], "comments": [{"owner": {"reputation": 5358, "user_id": 1562451, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qEhut.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/1562451/fred"}, "edited": false, "score": 0, "creation_date": 1444252086, "post_id": 33002355, "comment_id": 53829765, "body": "Naming you connecion <code>SqlConnection </code> is not a great idea.  Have you got this code in a <code>try &#47; catch</code>?"}, {"owner": {"reputation": 5358, "user_id": 1562451, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qEhut.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/1562451/fred"}, "edited": false, "score": 0, "creation_date": 1444252256, "post_id": 33002355, "comment_id": 53829833, "body": "In your first call you name the <code>SqlCommand</code> <code>cmdCreateINHResponseTableSP </code> yet inside the using block you use <code>cmdCreateITableSP</code>"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1444259428, "post_id": 33002355, "comment_id": 53832744, "body": "So there is an error in all your &quot;other code&quot;. You should find it. At a glance since you are importing files I guess there is some data quality issue. Is your windows service crashing? You should capture errors and write them to the windows event log."}], "answers": [{"tags": [], "owner": {"reputation": 17932, "user_id": 16391, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8ff75049b31c4a05033be39792f1c2be?s=128&d=identicon&r=PG", "display_name": "StingyJack", "link": "https://stackoverflow.com/users/16391/stingyjack"}, "is_accepted": false, "score": 0, "last_activity_date": 1444252775, "last_edit_date": 1495539868, "creation_date": 1444252775, "answer_id": 33002596, "question_id": 33002355, "link": "https://stackoverflow.com/questions/33002355/stored-procedure-does-not-fire-in-windows-service/33002596#33002596", "title": "Stored Procedure does not fire in Windows Service", "body": "<p>I had a <a href=\"https://stackoverflow.com/q/424531/16391\">similar issue</a> with \"extra code\" in the middle of some SQL commands. While I couldn't immediately see it, there was indeed an error being thrown because of some of the code included between the SQL commands. Wrapping this in a try catch may help show this.</p>\n\n<p>To fix this (and as a matter of good practices), you should create new connections for each SQL command and not reuse the same connection object and keep it open for so long between commands. If you need to ensure that they are handled as a transacted unit, wrap the call to this method in a new TransactionScope()</p>\n"}], "owner": {"reputation": 329, "user_id": 1730125, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/deae6050387da6e7853be74d18458273?s=128&d=identicon&r=PG", "display_name": "Jerry Trac", "link": "https://stackoverflow.com/users/1730125/jerry-trac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444280142, "creation_date": 1444251722, "last_edit_date": 1444280142, "question_id": 33002355, "link": "https://stackoverflow.com/questions/33002355/stored-procedure-does-not-fire-in-windows-service", "title": "Stored Procedure does not fire in Windows Service", "body": "<p>I created a Windows service with this code below. Not sure why it will not fire the last SQL Server stored procedure. If I have nothing in the code but the stored procedure than it fires ok. There are no errors. </p>\n\n<pre><code>using (SqlConnection SqlConnection = new SqlConnection(connectionString))\n{\n    SqlConnection.Open();\n\n    using (SqlCommand cmdCreateITableSP = new SqlCommand(\"CreateSP\", SqlConnection))\n    {\n        cmdCreateITableSP.CommandType = CommandType.StoredProcedure;\n        cmdCreateTableSP.ExecuteNonQuery();\n    }\n\n    string INTable = \"IN\";\n    string XMLPackagesDir = \"D:\\\\Cle\\\\\";\n\n    // Create a datatable with two columns:\n    DataTable INHReponseDT = new DataTable(\"INHReponseDT\");\n\n    // Create Columns: \n    INHReponseDT.Columns.Add(\"XM\");\n    INHReponseDT.Columns.Add(\"Cl\");\n    INHReponseDT.Columns.Add(\"I\");\n    INHReponseDT.Columns.Add(\"INH\");\n    INHReponseDT.Columns.Add(\"IN\");\n\n    DirectoryInfo DirInfo = new DirectoryInfo(XMLPackagesDir);\n\n    DataRow INHReponseRow = INHReponseDT.NewRow();\n\n    foreach (FileInfo fi in DirInfo.GetFiles(\"*.*\", SearchOption.AllDirectories))\n    {\n        XmlSerializer serializer = new XmlSerializer(typeof(Response));\n        Response i;\n        FileStream fs = null;\n        fs = new FileStream(Path.Combine(XMLPackagesDir, fi.Name), FileMode.Open);\n\n        using (TextReader tr = new StreamReader(fs))\n        {\n            i = (Response)serializer.Deserialize(tr);\n            INHReponseRow = INHReponseDT.NewRow();\n            INHReponseRow[\"XM\"] = fi.Name;\n            INHReponseRow[\"Cl\"] = i.ClientCorrelationID;\n            INHReponseRow[\"I\"] = i.StatusInformation.StatusItem.MessageText;\n            INHReponseRow[\"INH\"] = i.ResponseStatus;\n            INHReponseRow[\"IN\"] = i.RequestProcessedTime.ToString();\n\n            INHReponseDT.Rows.Add(INHReponseRow);\n        }\n\n        //Insert into SQL Table\n        using (SqlBulkCopy s = new SqlBulkCopy(SqlConnection))\n        {\n\n            s.DestinationTableName = INTable;\n            s.BatchSize = INHReponseDT.Rows.Count;\n            s.WriteToServer(INHReponseDT);\n            s.Close();\n        }\n    }\n\n    using (SqlCommand cmdUpdateCaseInformationINHResponseSP = new SqlCommand(\"UpdateCaseSP\", SqlConnection))\n    {\n        cmdUpdateCaseInformationINHResponseSP.CommandType = CommandType.StoredProcedure;\n        cmdUpdateCaseInformationINHResponseSP.ExecuteNonQuery();\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "dependency-injection", "ninject", "asp.net-core"], "comments": [{"owner": {"reputation": 3406, "user_id": 1461061, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FdSE7.png?s=128&g=1", "display_name": "Dealdiane", "link": "https://stackoverflow.com/users/1461061/dealdiane"}, "edited": false, "score": 0, "creation_date": 1444292071, "post_id": 33002340, "comment_id": 53844176, "body": "What DI container are you trying to use?"}, {"owner": {"reputation": 36163, "user_id": 1823494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90507a6f34195753c4bdebb6623a34b1?s=128&d=identicon&r=PG", "display_name": "Henk Mollema", "link": "https://stackoverflow.com/users/1823494/henk-mollema"}, "reply_to_user": {"reputation": 3406, "user_id": 1461061, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FdSE7.png?s=128&g=1", "display_name": "Dealdiane", "link": "https://stackoverflow.com/users/1461061/dealdiane"}, "edited": false, "score": 0, "creation_date": 1444292518, "post_id": 33002340, "comment_id": 53844429, "body": "@opiants looks like Simple Injector."}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1444293392, "post_id": 33002340, "comment_id": 53844968, "body": "Can you share more information about the middleware you are writing and the dependencies you are trying to inject. Please you what you tried."}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1444294694, "post_id": 33002340, "comment_id": 53845843, "body": "&quot;or am I stuck using the built-in DI or writing an adapter&quot;. You will never need to build an adapter. Adapters are simply not needed and as I explained <a href=\"https://github.com/simpleinjector/SimpleInjector/issues/41\" rel=\"nofollow noreferrer\">here</a>, adapters will only be in the way."}, {"owner": {"reputation": 3406, "user_id": 1461061, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FdSE7.png?s=128&g=1", "display_name": "Dealdiane", "link": "https://stackoverflow.com/users/1461061/dealdiane"}, "reply_to_user": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1444295483, "post_id": 33002340, "comment_id": 53846375, "body": "@Steven The only problem with not having an &quot;adapter&quot; I suppose is that all registration chaining that&#39;s already made available by the team (services.UseSqlServer, services.UseMvc) will become useless and you&#39;ll have to register them yourself manually."}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "reply_to_user": {"reputation": 3406, "user_id": 1461061, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FdSE7.png?s=128&g=1", "display_name": "Dealdiane", "link": "https://stackoverflow.com/users/1461061/dealdiane"}, "edited": false, "score": 0, "creation_date": 1444296667, "post_id": 33002340, "comment_id": 53847203, "body": "@opiants: That shouldn&#39;t be a problem, since you should typically not inject those framework types into your own components. You need to write application-specific abstraction and write an implementation that adapts to those framework pieces to keep your application clean anyway (that&#39;s what the DIP advices). Such specific implementation can get the specific framework type injected. And even if you make it less clean, you typically need a handful of types that you need to share. You can register a simple delegate that calls the &#39;other&#39; container to request the required type."}, {"owner": {"reputation": 3406, "user_id": 1461061, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FdSE7.png?s=128&g=1", "display_name": "Dealdiane", "link": "https://stackoverflow.com/users/1461061/dealdiane"}, "reply_to_user": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1444297168, "post_id": 33002340, "comment_id": 53847575, "body": "@Steven True, but would that now mean that you&#39;ll now have 2 DI containers in your project (not saying it&#39;s plain bad but not saying it&#39;s good either)? And what happens if you need to tap into the pipeline like what the author wants and still want to use a more matured/feature-rich container?"}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "reply_to_user": {"reputation": 3406, "user_id": 1461061, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/FdSE7.png?s=128&g=1", "display_name": "Dealdiane", "link": "https://stackoverflow.com/users/1461061/dealdiane"}, "edited": false, "score": 1, "creation_date": 1444297346, "post_id": 33002340, "comment_id": 53847698, "body": "@opiants: You shouldn&#39;t see it as &quot;2 DI containers&quot;. You just have one DI container for your application, and you have the &quot;configuration system of ASP.NET&quot; which internally happens to look like a DI container. In a sense things aren&#39;t any different as before. MVC and Web API already had their own configuration system; we never wanted to replace their complete internal configuration system. That doesn&#39;t really make sense."}, {"owner": {"reputation": 1412, "user_id": 221851, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb03d854e9715b49124961eba158bc77?s=128&d=identicon&r=PG", "display_name": "Joshua Barron", "link": "https://stackoverflow.com/users/221851/joshua-barron"}, "edited": false, "score": 0, "creation_date": 1444335662, "post_id": 33002340, "comment_id": 53872914, "body": "Sorry Steven, I will try to post an update tonight."}, {"owner": {"reputation": 1412, "user_id": 221851, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb03d854e9715b49124961eba158bc77?s=128&d=identicon&r=PG", "display_name": "Joshua Barron", "link": "https://stackoverflow.com/users/221851/joshua-barron"}, "reply_to_user": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "edited": false, "score": 0, "creation_date": 1444753873, "post_id": 33002340, "comment_id": 54030433, "body": "@Steven sorry for the long delay - posted an update after I messed around with it some more."}, {"owner": {"reputation": 1412, "user_id": 221851, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb03d854e9715b49124961eba158bc77?s=128&d=identicon&r=PG", "display_name": "Joshua Barron", "link": "https://stackoverflow.com/users/221851/joshua-barron"}, "edited": false, "score": 0, "creation_date": 1444756138, "post_id": 33002340, "comment_id": 54031687, "body": "Steven reading your comments, it sounds like I probably need to write an adapter around the components I need.  This feels a little kludgey to me but I will give it a shot - thanks."}], "answers": [{"comments": [{"owner": {"reputation": 32660, "user_id": 45091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6161f7a9eaf37fa9df33b656d870b7?s=128&d=identicon&r=PG", "display_name": "davidfowl", "link": "https://stackoverflow.com/users/45091/davidfowl"}, "edited": false, "score": 2, "creation_date": 1457510477, "post_id": 33118861, "comment_id": 59433618, "body": "I understand the principles that are being violated by the happy path, but the alternative looks pretty awful. Following the principles to the letter means wrapping all abstractions outside of your control and cross wiring the external dependencies into the application container. Do you really think that&#39;s better?"}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "reply_to_user": {"reputation": 32660, "user_id": 45091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6161f7a9eaf37fa9df33b656d870b7?s=128&d=identicon&r=PG", "display_name": "davidfowl", "link": "https://stackoverflow.com/users/45091/davidfowl"}, "edited": false, "score": 2, "creation_date": 1457511105, "post_id": 33118861, "comment_id": 59433908, "body": "@davidfowl I don&#39;t suggest cross-wiring external dependencies in the application container AT ALL, because this means that application components can still depend on external dependencies, while those should be wrapped by adapters. And don&#39;t forget you only need to wrap the abstractions that your application actually uses, normally just a few. Whether &#39;it is better&#39; depends on the size and lifetime of the application at hand, but in general I would say that is actually is much, much better."}, {"owner": {"reputation": 32660, "user_id": 45091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6161f7a9eaf37fa9df33b656d870b7?s=128&d=identicon&r=PG", "display_name": "davidfowl", "link": "https://stackoverflow.com/users/45091/davidfowl"}, "edited": false, "score": 3, "creation_date": 1457511568, "post_id": 33118861, "comment_id": 59434168, "body": "Even worse then, it means you need to keep them out of the application container, get them somehow and manually pass them to the adapter. That&#39;s honestly pretty horrific IMO. The good news is, this pattern is doable but just not very nice from an aesthetic POV."}, {"owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "reply_to_user": {"reputation": 32660, "user_id": 45091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6161f7a9eaf37fa9df33b656d870b7?s=128&d=identicon&r=PG", "display_name": "davidfowl", "link": "https://stackoverflow.com/users/45091/davidfowl"}, "edited": false, "score": 0, "creation_date": 1457512343, "post_id": 33118861, "comment_id": 59434597, "body": "@davidfowl I really have no idea what you are talking about. Passing stuff into an adapter is simple; that never caused any trouble to me. You don&#39;t need to abuse your container for that."}, {"owner": {"reputation": 32660, "user_id": 45091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6161f7a9eaf37fa9df33b656d870b7?s=128&d=identicon&r=PG", "display_name": "davidfowl", "link": "https://stackoverflow.com/users/45091/davidfowl"}, "edited": false, "score": 1, "creation_date": 1457512487, "post_id": 33118861, "comment_id": 59434659, "body": "Sure, we&#39;ll let the users decide."}], "tags": [], "owner": {"reputation": 150628, "user_id": 264697, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53813b7dc989271bf45d1a047db31a1f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/264697/steven"}, "is_accepted": true, "score": 12, "last_activity_date": 1444818501, "last_edit_date": 1444818501, "creation_date": 1444806696, "answer_id": 33118861, "question_id": 33002340, "link": "https://stackoverflow.com/questions/33002340/replace-activator-for-middleware-in-asp-net-core/33118861#33118861", "title": "Replace activator for middleware in ASP.NET Core", "body": "<p>The SOLID principles dictate that:</p>\n\n<blockquote>\n  <p>the abstracts are owned by the upper/policy layers (<a href=\"https://en.wikipedia.org/wiki/Dependency_inversion_principle\">DIP</a>)</p>\n</blockquote>\n\n<p>Which means that our application code should not depend directly on framework code, even if they are abstractions. Instead we should define <a href=\"https://en.wikipedia.org/wiki/Interface_segregation_principle\">role interfaces</a> that are tailored for the use of our application.</p>\n\n<p>So instead of depending on a <code>Microsoft.Framework.Logging.ILogger</code> abstraction, that might or might not fit our application specific needs, the SOLID principles guide us towards abstractions (ports) that are owned by the application, and use adapter implementations that hook into framework code. Here's an example of how <a href=\"https://stackoverflow.com/a/5646876/264697\">your own ILogger abstraction</a> might look like.</p>\n\n<p>When application code depends on your own abstraction, you need an adapter implementation that will be able to forward the call to the implementation supplied by the framework:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public sealed class MsLoggerAdapter : MyApp.ILogger\n{\n    private readonly Func&lt;Microsoft.Framework.Logging.ILogger&gt; factory;\n    public MsLoggerAdapter(Func&lt;Microsoft.Framework.Logging.ILogger&gt; factory) {\n        this.factory = factory;\n    }\n\n    public void Log(LogEntry entry) {\n        var logger = this.factory();\n        LogLevel level = ToLogLevel(entry.Severity);\n        logger.Log(level, 0, entry.Message, entry.Exception,\n            (msg, ex) =&gt; ex != null ? ex.Message : msg.ToString());\n    }\n\n    private static LogLevel ToLogLevel(LoggingEventType severity) { ... }\n}\n</code></pre>\n\n<p>This adapter can be registered in your application container as follows:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>container.RegisterSingleton&lt;MyApp.ILogger&gt;(new MsLoggerAdapter(\n    app.ApplicationServices.GetRequiredService&lt;Microsoft.Framework.Logging.ILogger&gt;));\n</code></pre>\n\n<p><strong>BIG WARNING</strong>: Do <em>not</em> make direct copies of the framework abstractions. That will almost never lead to good results. you should specify abstractions that are defined in terms of your application. This could even mean that an adapter becomes more complex and needs multiple framework components to fulfill its contract, but this results in cleaner and more maintainable application code.</p>\n\n<p>But if applying SOLID is too much a hassle for you, and you just want to depend directly on external components, you can always cross-wire the required dependencies in your application container as follows:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>container.Register&lt;Microsoft.Framework.Logging.ILogger&gt;(\n    app.ApplicationServices.GetRequiredService&lt;Microsoft.Framework.Logging.ILogger&gt;);\n</code></pre>\n\n<p>It is as easy as this, but do note that in order to keep your application clean and maintainable, it's much better to define application specific abstractions that adhere to the SOLID principles. Also note that, even if you do this, you only need a few of those cross-wired dependencies anyway. So it's best to still keep your application container as separated as possible from the vNext configuration system.</p>\n\n<p>With the middleware, there is a completely different issue at play here. In your middleware you are injecting runtime data (the <code>next</code> delegate) into a component (the <code>CustomMiddleware</code> class). This is giving you double grief, because this complicates registration and resolving the component and prevents it to be verified and diagnosed by the container. Instead, you should move the <code>next</code> delegate out of the constructor and into the <code>Invoke</code> delegate as follows:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class CustomMiddleware\n{\n    private IPersonService _personService;\n\n    public CustomMiddleware(IPersonService personService) {\n        _personService = personService;\n    }\n\n    public async Task Invoke(HttpContext context, RequestDelegate next) { /* ... */ }\n}\n</code></pre>\n\n<p>Now you can hook your middleware into the pipeline as follows:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>app.Use(async (context, next) =&gt;\n{\n    await container.GetInstance&lt;CustomMiddleware&gt;().Invoke(context, next);\n});\n</code></pre>\n\n<p>But don't forget that you can always create your middleware by hand as follows:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var frameworkServices = app.ApplicationServices;\n\napp.Use(async (context, next) =&gt;\n{\n    var mw = new CustomMiddleware(\n        container.GetInstance&lt;IPersonService&gt;(),\n        container.GetInstance&lt;IApplicationSomething&gt;(),\n        frameworkServices.GetRequiredService&lt;ILogger&gt;(),\n        frameworkServices.GetRequiredService&lt;AspNetSomething&gt;());\n\n    await mw.Invoke(context, next);\n});\n</code></pre>\n\n<p>It's really unfortunate that ASP.NET calls its own services <code>ApplicationServices</code>, because that's where your own application container is for; not the built-in configuration system.</p>\n"}], "owner": {"reputation": 1412, "user_id": 221851, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb03d854e9715b49124961eba158bc77?s=128&d=identicon&r=PG", "display_name": "Joshua Barron", "link": "https://stackoverflow.com/users/221851/joshua-barron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3916, "favorite_count": 2, "accepted_answer_id": 33118861, "answer_count": 1, "score": 8, "last_activity_date": 1474629155, "creation_date": 1444251670, "last_edit_date": 1474629155, "question_id": 33002340, "link": "https://stackoverflow.com/questions/33002340/replace-activator-for-middleware-in-asp-net-core", "title": "Replace activator for middleware in ASP.NET Core", "body": "<p>I am trying to instruct my ASP.NET Core MVC application to use a 3rd party DI container.  Rather than writing an adapter I am trying to just plug in the the library following the advice in <a href=\"https://github.com/simpleinjector/SimpleInjector/issues/41#issuecomment-100470660\" rel=\"nofollow\">this post</a></p>\n\n<p>This works pretty well - I can replace the built in <code>IControllerActivator</code> with my own that uses the DI container.  However, I am running into a roadblock when trying to instantiate custom middleware that also relies on injected dependencies. ASP.NET cannot resolve these dependencies because it is not using my 3rd party DI container - is there an equivalent of <code>IControllerActivator</code> for middleware, or am I stuck using the built-in DI or writing an adapter?</p>\n\n<p>** EDIT **</p>\n\n<p>Here's some more of my code - I am actually trying to use Ninject using the pattern above. </p>\n\n<pre><code>internal sealed class NinjectControllerActivator : IControllerActivator\n{\n    private readonly IKernel _kernel;\n\n    public NinjectControllerActivator(IKernel kernel)\n    {\n        _kernel = kernel;\n    }\n\n    [DebuggerStepThrough]\n    public object Create(ActionContext context, Type controllerType)\n    {\n        return _kernel.Get(controllerType);\n    }\n}\n</code></pre>\n\n<p>I've discovered I have <strong>two</strong> problems:</p>\n\n<ul>\n<li>I can't inject standard ASP.NET components into my controllers because Ninject is not aware of them</li>\n<li>My middleware that uses application services can't be instantiated because ASP.NET isn't aware of Ninject.</li>\n</ul>\n\n<p>For an example of the first problem, here's a controller that fails to instantiate because I'm using <code>IUrlHelper</code> (also note the <code>ILogger</code>, which also fails to instantiate):</p>\n\n<pre><code>public class SystemController : Controller \n{\n    public SystemController(ILogger logger, IUrlHelper urlHelper) \n    {\n         /*...*/\n    }\n}\n</code></pre>\n\n<p>Here's an example of the second problem with a custom middleware:</p>\n\n<pre><code>public class CustomMiddleware\n{\n    private RequestDelegate _next;\n    // this is an application specific service registered via my Ninject kernel\n    private IPersonService _personService; \n\n    public CustomMiddleware(RequestDelegate next, IPersonService personService)\n    {\n        _next = next;\n        _personService = personService;\n    }\n\n    public async Task Invoke(HttpContext context)\n    {\n        /* ... */\n    }\n}\n</code></pre>\n\n<p>I realize that in theory ASP.NET components should be in their own pipeline and my application components should be in another, but in practice I often need to use components in a cross-cutting way (as in the examples above).</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "authentication", "login"], "comments": [{"owner": {"reputation": 6426, "user_id": 376382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb4579713b5d8a26ff716896fe1f7565?s=128&d=identicon&r=PG", "display_name": "Cacho Santa", "link": "https://stackoverflow.com/users/376382/cacho-santa"}, "edited": false, "score": 0, "creation_date": 1444252861, "post_id": 33002314, "comment_id": 53830161, "body": "add you Web.Config file to your question."}, {"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "edited": false, "score": 0, "creation_date": 1444254167, "post_id": 33002314, "comment_id": 53830768, "body": "Instead of <code>Request.IsAuthenticated</code>, try <code>User.Identity.IsAuthenticated</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4988856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbbff1e7617644881ef08cc70730638?s=128&d=identicon&r=PG&f=1", "display_name": "ryan g", "link": "https://stackoverflow.com/users/4988856/ryan-g"}, "edited": false, "score": 0, "creation_date": 1444252611, "post_id": 33002388, "comment_id": 53830017, "body": "I tried what you suggested but i get the same result as before. I do not get the option to logout @cacho"}, {"owner": {"reputation": 6426, "user_id": 376382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb4579713b5d8a26ff716896fe1f7565?s=128&d=identicon&r=PG", "display_name": "Cacho Santa", "link": "https://stackoverflow.com/users/376382/cacho-santa"}, "reply_to_user": {"reputation": 13, "user_id": 4988856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbbff1e7617644881ef08cc70730638?s=128&d=identicon&r=PG&f=1", "display_name": "ryan g", "link": "https://stackoverflow.com/users/4988856/ryan-g"}, "edited": false, "score": 0, "creation_date": 1444252655, "post_id": 33002388, "comment_id": 53830044, "body": "did you re-build your application?"}], "tags": [], "owner": {"reputation": 6426, "user_id": 376382, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bb4579713b5d8a26ff716896fe1f7565?s=128&d=identicon&r=PG", "display_name": "Cacho Santa", "link": "https://stackoverflow.com/users/376382/cacho-santa"}, "is_accepted": true, "score": 1, "last_activity_date": 1444252691, "last_edit_date": 1444252691, "creation_date": 1444251859, "answer_id": 33002388, "question_id": 33002314, "link": "https://stackoverflow.com/questions/33002314/c-mvc-after-i-login-i-dont-get-the-option-to-logout/33002388#33002388", "title": "C# MVC After I login, i dont get the option to Logout", "body": "<p>I think what you need is to add the following lines in the modules seccion, in the system.webServer tag (this should be inside your Web.config file)</p>\n\n<pre><code>&lt;remove name=\"FormsAuthentication\" /&gt;\n&lt;add name=\"FormsAuthentication\" type=\"System.Web.Security.FormsAuthenticationModule\" /&gt;\n</code></pre>\n\n<p>I had the same issue, and this made the <code>Request.IsAuthenticated</code> to always be <code>false</code>.</p>\n\n<p>These are the default values for <a href=\"https://msdn.microsoft.com/en-us/library/ff647070.aspx\" rel=\"nofollow\">FormAuthentication</a>:</p>\n\n<pre><code>&lt;system.web&gt;\n  &lt;authentication mode=\"Forms\"&gt;\n    &lt;forms loginUrl=\"Login.aspx\"\n           protection=\"All\"\n           timeout=\"30\"\n           name=\".ASPXAUTH\" \n           path=\"/\"\n           requireSSL=\"false\"\n           slidingExpiration=\"true\"\n           defaultUrl=\"default.aspx\"\n           cookieless=\"UseDeviceProfile\"\n           enableCrossAppRedirects=\"false\" /&gt;\n  &lt;/authentication&gt;\n&lt;/system.web&gt;\n</code></pre>\n\n<p>You don't need to have all of those properties for the forms tag, but you should have the authentication mode.</p>\n"}], "owner": {"reputation": 13, "user_id": 4988856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbbff1e7617644881ef08cc70730638?s=128&d=identicon&r=PG&f=1", "display_name": "ryan g", "link": "https://stackoverflow.com/users/4988856/ryan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 33002388, "answer_count": 1, "score": 1, "last_activity_date": 1444252691, "creation_date": 1444251546, "question_id": 33002314, "link": "https://stackoverflow.com/questions/33002314/c-mvc-after-i-login-i-dont-get-the-option-to-logout", "title": "C# MVC After I login, i dont get the option to Logout", "body": "<p>I am doing my first MVC web app. Im starting with the Login, logout and registration. The registration works great by creating a new user and adding a record to my a table in the database. I am also able to login. the issue i am having is after i login i get redirected to my homepage like it suppose to, but i am not given the option to logout. im my _layout i have an if/else statement that suppose to check if request is authenticated then give the option to logout but is does not. </p>\n\n<p>I am fairly new to this and any help would be appreciated. I am providing the code i have so far.</p>\n\n<p>This is what i have in my UserController: functions and methods for index page and login, logout, register and isvalid</p>\n\n<pre><code>public class UsersController : Controller\n{\n    private GroceryListEntities db = new GroceryListEntities();\n\n    [HttpGet]\n    public ActionResult LogIn()\n    {\n        return View();\n    }\n\n    [HttpPost]\n    public ActionResult LogIn(User u)\n    {\n\n        if (IsValid(u.UserName, u.Password))\n        {\n            FormsAuthentication.SetAuthCookie(u.UserName, false);\n            return RedirectToAction(\"Index\", \"Home\");\n        }\n        else\n        {\n            ModelState.AddModelError(\"\", \"Login details are wrong.\");\n        }\n        return View(u);\n    }\n\n    [HttpGet]\n    public ActionResult Register()\n    {\n        return View();\n    }\n\n    [HttpPost]\n    public ActionResult Register(User U)\n    {\n        if (ModelState.IsValid)\n        {\n            using (db)\n            {\n                //you should check duplicate registration here \n                db.Users.Add(U);\n                db.SaveChanges();\n                ModelState.Clear();\n                U = null;\n                ViewBag.Message = \"Successfully Registration Done\";\n                //return RedirectToAction(\"Index\", \"Home\");\n            }\n        }\n        return View(U);\n    }\n\n    public ActionResult LogOut()\n    {\n        FormsAuthentication.SignOut();\n        return RedirectToAction(\"Index\", \"Home\");\n    }\n\n    private bool IsValid(string userName, string password)\n    {\n        bool IsValid = false;\n\n        using (var db = new sogeti.got.groceries.app.Models.GroceryListEntities())\n\n        {\n            var user = db.Users.FirstOrDefault(u =&gt; u.UserName == userName);\n\n            if (user != null)\n            {\n                if (user.Password == password)\n                {\n                    IsValid = true;\n                }\n            }\n        }\n        return IsValid;\n    }\n\n    // GET: Users\n    public ActionResult Index()\n    {\n        return View(db.Users.ToList());\n    }\n</code></pre>\n\n<p>Login view:</p>\n\n<pre><code>@model project.app.Models.User\n\n@{\n    ViewBag.Title = \"Login\";\n}\n\n&lt;h2&gt;Login&lt;/h2&gt;\n\n@using (Html.BeginForm())\n{\n@Html.ValidationSummary(true, \"Login Failed, check details\");\n&lt;div&gt;\n    &lt;fieldset&gt;\n        &lt;legend&gt;Login Form&lt;/legend&gt;\n        &lt;div class=\"editor-label\"&gt;@Html.LabelFor(u =&gt; u.UserName)&lt;/div&gt;\n        &lt;div class=\"editor-field\"&gt;\n            @Html.TextBoxFor(u =&gt; u.UserName)\n            @Html.ValidationMessageFor(u =&gt; u.UserName)\n        &lt;/div&gt;\n        &lt;div class=\"editor-label\"&gt;@Html.LabelFor(u =&gt; u.Password)&lt;/div&gt;\n        &lt;div class=\"editor-field\"&gt;\n            @Html.PasswordFor(u =&gt; u.Password)\n            @Html.ValidationMessageFor(u =&gt; u.Password)\n        &lt;/div&gt;\n        &lt;input type=\"submit\" value=\"Log In\" /&gt;\n    &lt;/fieldset&gt;\n&lt;/div&gt;\n}\n\n@* This below line is for create javascript section *@\n\n@section Scripts{\n@Scripts.Render(\"~/bundles/jqueryval\")\n}\n</code></pre>\n\n<p>Registration view:</p>\n\n<pre><code>@model project.Models.User\n\n@{\nViewBag.Title = \"Register\";\n}\n\n&lt;h2&gt;Register&lt;/h2&gt;\n\n@using (Html.BeginForm())\n{\n@Html.ValidationSummary(true, \"Registration Failed\");\n\n&lt;fieldset&gt;\n    &lt;legend&gt;Registration Form&lt;/legend&gt;\n    @Html.AntiForgeryToken()\n    @if (ViewBag.Message != null)\n    {\n        &lt;div style=\"border:solid 1px green\"&gt;\n            @ViewBag.Message\n        &lt;/div&gt;\n    }\n    &lt;div class=\"editor-label\"&gt;\n        @Html.LabelFor(model =&gt; model.FirstName)\n    &lt;/div&gt;\n    &lt;div class=\"editor-field\"&gt;\n        @Html.EditorFor(model =&gt; model.FirstName)\n        @Html.ValidationMessageFor(model =&gt; model.FirstName)\n    &lt;/div&gt;\n    &lt;div class=\"editor-label\"&gt;\n        @Html.LabelFor(model =&gt; model.LastName)\n    &lt;/div&gt;\n    &lt;div class=\"editor-field\"&gt;\n        @Html.EditorFor(model =&gt; model.LastName)\n        @Html.ValidationMessageFor(model =&gt; model.LastName)\n    &lt;/div&gt;\n    &lt;div class=\"editor-label\"&gt;\n        @Html.LabelFor(model =&gt; model.Email)\n    &lt;/div&gt;\n    &lt;div class=\"editor-field\"&gt;\n        @Html.EditorFor(model =&gt; model.Email)\n        @Html.ValidationMessageFor(model =&gt; model.Email)\n    &lt;/div&gt;\n    &lt;div class=\"editor-label\"&gt;\n        @Html.LabelFor(model =&gt; model.UserName)\n    &lt;/div&gt;\n    &lt;div class=\"editor-field\"&gt;\n        @Html.EditorFor(model =&gt; model.UserName)\n        @Html.ValidationMessageFor(model =&gt; model.UserName)\n    &lt;/div&gt;\n    &lt;div class=\"editor-label\"&gt;\n        @Html.LabelFor(model =&gt; model.Password)\n    &lt;/div&gt;\n    &lt;div class=\"editor-field\"&gt;\n        @Html.EditorFor(model =&gt; model.Password)\n        @Html.ValidationMessageFor(model =&gt; model.Password)\n    &lt;/div&gt;\n    &lt;div class=\"editor-label\"&gt;\n        @Html.LabelFor(model =&gt; model.ConfirmPassword)\n    &lt;/div&gt;\n    &lt;div class=\"editor-field\"&gt;\n        @Html.EditorFor(model =&gt; model.ConfirmPassword)\n        @Html.ValidationMessageFor(model =&gt; model.ConfirmPassword)\n    &lt;/div&gt;\n    &lt;p&gt;\n        &lt;input type=\"submit\" value=\"Register\" /&gt;\n    &lt;/p&gt;\n&lt;/fieldset&gt;\n}\n\n&lt;div&gt;@Html.ActionLink(\"Back to List\", \"Index\")&lt;/div&gt;\n</code></pre>\n\n<p>in my _layout i have:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta charset=\"utf-8\" /&gt;\n&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n&lt;title&gt;@ViewBag.Title&lt;/title&gt;\n@Styles.Render(\"~/Content/css\")\n@Scripts.Render(\"~/bundles/modernizr\")\n\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div style=\"width:auto; background-color:aqua\"&gt;\n    @if (Request.IsAuthenticated)\n    {\n        &lt;strong&gt;@Html.Encode(User.Identity.Name)&lt;/strong&gt;\n        @Html.ActionLink(\"LogOut\", \"LogOut\", \"Users\")\n    }\n    else\n    {\n        @Html.ActionLink(\"Registration\", \"Register\", \"Users\")\n        &lt;span&gt; | &lt;/span&gt;\n        @Html.ActionLink(\"Login\", \"LogIn\", \"Users\")\n    }\n  &lt;/div&gt;\n    &lt;div class=\"container body-content\"&gt;\n        @RenderBody()\n        &lt;hr /&gt;\n        &lt;footer&gt;\n            &lt;p&gt;&amp;copy; @DateTime.Now.Year - &lt;i&gt;Got Groeries&lt;/i&gt; &lt;/p&gt;\n        &lt;/footer&gt;\n    &lt;/div&gt;\n    @Scripts.Render(\"~/bundles/jquery\")\n    @Scripts.Render(\"~/bundles/bootstrap\")\n    @RenderSection(\"scripts\", required: false)\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["c#", "gridview", "windows-phone-8.1"], "comments": [{"owner": {"reputation": 5907, "user_id": 613087, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d3ac2144120f923f23c49ee4ce4437ab?s=128&d=identicon&r=PG", "display_name": "Depechie", "link": "https://stackoverflow.com/users/613087/depechie"}, "edited": false, "score": 0, "creation_date": 1444288095, "post_id": 33002307, "comment_id": 53841722, "body": "Because your grid is bound to a model, you are getting 1 item of that model back through the click. So just cast that item to the model and get the Vender number... Not sure what the actual model class is but assuming it&#39;s VendorViewModel the code should be: ((VendorViewModel)e.ClickedItem).StrVendor this will give you the actual vendor number."}, {"owner": {"reputation": 11, "user_id": 5377140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ME8Lg.jpg?s=128&g=1", "display_name": "Jester2202", "link": "https://stackoverflow.com/users/5377140/jester2202"}, "reply_to_user": {"reputation": 5907, "user_id": 613087, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d3ac2144120f923f23c49ee4ce4437ab?s=128&d=identicon&r=PG", "display_name": "Depechie", "link": "https://stackoverflow.com/users/613087/depechie"}, "edited": false, "score": 0, "creation_date": 1444640761, "post_id": 33002307, "comment_id": 53971312, "body": "Thanks Depechie, great answer - really clear and on point."}, {"owner": {"reputation": 5907, "user_id": 613087, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d3ac2144120f923f23c49ee4ce4437ab?s=128&d=identicon&r=PG", "display_name": "Depechie", "link": "https://stackoverflow.com/users/613087/depechie"}, "edited": false, "score": 0, "creation_date": 1444641704, "post_id": 33002307, "comment_id": 53971876, "body": "hmm seems I aswered it through a comment :D, I&#39;ll repost it in an aswer so you can accept it ;)"}], "answers": [{"tags": [], "owner": {"reputation": 5907, "user_id": 613087, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d3ac2144120f923f23c49ee4ce4437ab?s=128&d=identicon&r=PG", "display_name": "Depechie", "link": "https://stackoverflow.com/users/613087/depechie"}, "is_accepted": false, "score": 0, "last_activity_date": 1444641867, "creation_date": 1444641867, "answer_id": 33077555, "question_id": 33002307, "link": "https://stackoverflow.com/questions/33002307/accessing-values-of-e-clickeditem-object-from-c-gridview-on-windows-phone-8-1/33077555#33077555", "title": "Accessing values of e.ClickedItem object from C# GridView on Windows Phone 8.1", "body": "<p>Because your grid is bound to a model, you are getting 1 item of that model back through the click. So just cast that item to the model and get the Vender number... Not sure what the actual model class is but assuming it's VendorViewModel the code should be: ((VendorViewModel)e.ClickedItem).StrVendor this will give you the actual vendor number.</p>\n\n<p>Best to check if you are actually getting a model so the final code could be as following:</p>\n\n<pre><code>if(e.ClickedItem is VendorViewModel)\n{\n   var vendornr = ((VendorViewModel)e.ClickedItem).StrVendor;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5377140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ME8Lg.jpg?s=128&g=1", "display_name": "Jester2202", "link": "https://stackoverflow.com/users/5377140/jester2202"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444641867, "creation_date": 1444251526, "last_edit_date": 1444256376, "question_id": 33002307, "link": "https://stackoverflow.com/questions/33002307/accessing-values-of-e-clickeditem-object-from-c-gridview-on-windows-phone-8-1", "title": "Accessing values of e.ClickedItem object from C# GridView on Windows Phone 8.1", "body": "<p>I'm building a Windows Phone 8.1 App for a client and have run into something I can't source an answer for, hence the question. I apologize in advance as it's probably something obvious and I'm oblivious to it.</p>\n\n<p>I have a GridView bound to a vendor list from my data model. I can select / click a returned value from the Grid as planned. \n<strong>XAML extract:</strong></p>\n\n<pre><code>&lt;GridView x:Name=\"VendorsGridView\" \n              ItemsSource=\"{Binding}\"\n              Grid.Row=\"1\"\n              Margin=\"10,8,10,12\"\n              Foreground=\"White\"     \n              SelectionMode=\"Single\"\n              IsSwipeEnabled=\"False\"\n              ItemClick=\"VendorsGridView_ItemClick\"\n              IsItemClickEnabled=\"True\"\n              ItemTemplate=\"{StaticResource VendorTemplate}\"&gt;\n    &lt;/GridView&gt;\n\n&lt;/Grid.RowDefinitions&gt;\n                &lt;TextBlock Text=\"{Binding StrVendor}\" \n                           Name=\"VNo\"\n                           Grid.Row=\"0\"\n                           Margin=\"0,0,0,0\" \n                           VerticalAlignment=\"Top\"\n                           HorizontalAlignment=\"Center\"\n                           FontSize=\"18\"\n                           FontWeight=\"SemiBold\"/&gt;\n                &lt;TextBlock Text=\"{Binding StrVName}\" \n                           Name=\"VName\"\n                           Grid.Row=\"1\"\n                           Margin=\"0,0,0,0\" \n                           VerticalAlignment=\"Center\" \n                           TextWrapping=\"Wrap\"\n                           FontSize=\"14\"/&gt;\n</code></pre>\n\n<p>If I examine e.ClickedItem in the debug window I can see the value I am trying to find, (StrVendor or vendor number). The design is then to write this back to a static table for use as a default when looking at other data.</p>\n\n<p><strong>Debug Window Output:</strong></p>\n\n<pre><code>e.ClickedItem\n{MOQ_v301.ViewModel.VendorViewModel}\nbase: {MOQ_v301.ViewModel.VendorViewModel}\nIsDirty: true\nisDirty: true\nStrVendor: \"40520\"\nstrVendor: \"40520\"\nStrVName: \"Forest Garden PLC\"\nstrVName: \"Forest Garden PLC\"\n</code></pre>\n\n<p>My question is how can I get the vendor number captured to a string variable to achieve it?</p>\n"}, {"tags": ["c#", "html", "wpf", "winforms", "webbrowser-control"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444251947, "post_id": 33002254, "comment_id": 53829711, "body": "I don&#39;t think those quotes are valid in the Winforms side, WPF looks to be correct. They should be encoded as <code>&amp;ldquo;</code> and <code>&amp;rdquo;</code>."}, {"owner": {"reputation": 4985, "user_id": 3773066, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mPcCO.jpg?s=128&g=1", "display_name": "OhBeWise", "link": "https://stackoverflow.com/users/3773066/ohbewise"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444252665, "post_id": 33002254, "comment_id": 53830051, "body": "@RonBeyer Your suggestion works. However, what if the user has already added the incorrect \u201c \u201d instead of <code>&amp;ldquo;</code> <code>&amp;rdquo;</code>? I&#39;m sure I could a do a Replace on them before rendering, but it&#39;s likely that these won&#39;t be the only incorrect special characters."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 2, "creation_date": 1444252847, "post_id": 33002254, "comment_id": 53830155, "body": "Special characters should be HTML encoded, if you had the plain text portions you could try to sanitize or encode it, but I&#39;m not sure how you can detect it other than have a dictionary of special characters vs the HTML encoded strings and do a brute-force find/replace on each special character, taking care not to hit things like <code>&lt;</code> or <code>&gt;</code> that should be encoded in the user text, but left alone in the HTML."}, {"owner": {"reputation": 11630, "user_id": 5149474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atyzF.jpg?s=128&g=1", "display_name": "Eser", "link": "https://stackoverflow.com/users/5149474/eser"}, "edited": false, "score": 1, "creation_date": 1444253575, "post_id": 33002254, "comment_id": 53830491, "body": "<code>\u201c \u201d</code>  chars doesn&#39;t have to be html-encoded. You can test it like this <code>var encoded  = WebUtility.HtmlEncode(&quot; \u201c \u201d &quot;);</code>  It seems like an charset/encoding problem. Here is a test case to regenerate it. <code>var buf = Encoding.UTF8.GetBytes(&quot; \u201c \u201d &quot;);  var str = Encoding.GetEncoding(&quot;Windows-1252&quot;).GetString(buf);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4985, "user_id": 3773066, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mPcCO.jpg?s=128&g=1", "display_name": "OhBeWise", "link": "https://stackoverflow.com/users/3773066/ohbewise"}, "edited": false, "score": 0, "creation_date": 1444403585, "post_id": 33031053, "comment_id": 53904134, "body": "Thanks! Rarely dealing with html, I never would have thought of that. My solution was to ensure that anyone creating these templates was properly trained to use the Entity Name, Entity Number, or Hexadecimal Reference instead of copy-pasting. But this adds a nice fourth option for those who want to copy-paste / don&#39;t know where to find such special character codes. Existing errors will just have to be dealt with per case."}], "tags": [], "owner": {"reputation": 822, "user_id": 2280432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1jVFX.jpg?s=128&g=1", "display_name": "Dax Pandhi", "link": "https://stackoverflow.com/users/2280432/dax-pandhi"}, "is_accepted": true, "score": 1, "last_activity_date": 1444371057, "creation_date": 1444371057, "answer_id": 33031053, "question_id": 33002254, "link": "https://stackoverflow.com/questions/33002254/how-do-i-render-special-characters-in-html-the-same-in-wpf-as-in-winforms/33031053#33031053", "title": "How do I render special characters in HTML the same in WPF as in Winforms?", "body": "<p>Just add this <code>meta</code> tag to the <code>&lt;head&gt;</code> of your HTML:</p>\n\n<pre><code>&lt;meta charset='utf-8'&gt;\n</code></pre>\n\n<p>This will display the special characters correctly. I just tested your exact code with this and it works.</p>\n"}], "owner": {"reputation": 4985, "user_id": 3773066, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mPcCO.jpg?s=128&g=1", "display_name": "OhBeWise", "link": "https://stackoverflow.com/users/3773066/ohbewise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1212, "favorite_count": 0, "accepted_answer_id": 33031053, "answer_count": 1, "score": 0, "last_activity_date": 1444371057, "creation_date": 1444251301, "last_edit_date": 1495535223, "question_id": 33002254, "link": "https://stackoverflow.com/questions/33002254/how-do-i-render-special-characters-in-html-the-same-in-wpf-as-in-winforms", "title": "How do I render special characters in HTML the same in WPF as in Winforms?", "body": "<p>I'm working on an email notification project, where in a preexisting Winforms screen the client can edit an email template - adding html, text, etc. A <em>very simplified</em> example input:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt; \n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;The Title&lt;/title&gt;\n    &lt;/head&gt;\n\n    &lt;body bgcolor=\"#f2f2f2\" style=\"margin: 0; padding: 0;\"&gt;\n        &lt;br /&gt;\n            &lt;b&gt;Please do not respond to this e-mail, as it is not monitored.&lt;/b&gt;\n        &lt;br/&gt;\n        &lt;br/&gt;\n            \u201cFoo bar baz.\n        &lt;br/&gt;\n        &lt;br/&gt;\n            Baz bar foo.\u201d\n        &lt;br/&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>This is saved as a <code>string</code>. On the same screen, the user may then click a button which will raise a <code>ShowDialog</code> call on another Form.  This form previews the user's html in a <code>WebBrowser</code> control:</p>\n\n<pre><code>this.webBrowser.DocumentText = theHtmlString;\n</code></pre>\n\n<p>And the results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XNhnV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XNhnV.png\" alt=\"Winforms WebBrowser\"></a></p>\n\n<p><strong>Problem:</strong></p>\n\n<p>I am creating a WPF screen related to the Winforms screens mentioned. It too needs the ability to preview the user's html. To do so I've used an attached behavior modified from <a href=\"https://stackoverflow.com/a/2586255/3773066\">this version</a>. Essentially, this dialog also previews the user's html in a <code>WebBrowser</code> control:</p>\n\n<pre><code>webBrowser.NavigateToString(theHtmlString);\n</code></pre>\n\n<p>However, the results aren't correct, as highlighted below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Oxzf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Oxzf.png\" alt=\"WPF WebBrowser\"></a></p>\n\n<p>If this were my own html input, I'd simply remove the offending characters and replace them with standard quotations. But since this input is from the client, <em>how do I get WPF to render the same as Winforms</em>?</p>\n\n<p>The reason this poses an issue:</p>\n\n<ol>\n<li>In the old Winforms screen, the user creates/edits-existing email templates, previews them, is satisfied with the rendered example, saves changes.</li>\n<li>In the new WPF screen, the user exports/imports existing email templates, previews them, is dissatisfied with the rendered example and strange characters, becomes confused when the other screen still renders correctly - calls to report a \"bug\" in the new screen.</li>\n</ol>\n\n<p><strong>Simple Reproduction Example: - Credit to <a href=\"https://stackoverflow.com/users/5149474/eser\">Eser</a></strong></p>\n\n<pre><code>var encoded = WebUtility.HtmlEncode(\" \u201c Test \u201d \");             //\" \u201c Test \u201d \"\nvar buf = Encoding.UTF8.GetBytes(\" \u201c Test \u201d \"); \nvar str = Encoding.GetEncoding(\"Windows-1252\").GetString(buf); //\" \u00e2\u20ac\u0153 Test \u00e2\u20ac \"\n</code></pre>\n"}, {"tags": ["c#", "dictionary", "priority-queue"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1444250629, "post_id": 33002057, "comment_id": 53829038, "body": "A Dictionary can find a Value from a Key. That&#39;s what it does. Use a different ADT to deal with ordered Values. Of course the <code>Dictioanry&lt;K,V&gt;</code> can be treated as an <code>IEnumerable&lt;KeyValuePair&lt;K,V&gt;&gt;</code> and the standard LINQ (eg. <code>OrderBy</code>) applies - but this is not utilizing the nature of the Dictionary (or of a different ADT), and such might result in less-than-ideal asymmetric bounds depending on how it is used."}, {"owner": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 0, "creation_date": 1444251052, "post_id": 33002057, "comment_id": 53829262, "body": "What about : people.OrderBy(val=&gt;val.Value).Select(t=&gt;t.Key).FirstOrDefau&zwnj;&#8203;lt();"}, {"owner": {"reputation": 851, "user_id": 3554076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37bdac05fb9c9bbae0d0f35087ca4fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/3554076/arash"}, "edited": false, "score": 0, "creation_date": 1444251448, "post_id": 33002057, "comment_id": 53829470, "body": "I think Lookup class would be better for this case"}], "answers": [{"comments": [{"owner": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 1, "creation_date": 1444251224, "post_id": 33002114, "comment_id": 53829352, "body": "First sample would most likely to be faster."}], "tags": [], "owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "is_accepted": true, "score": 5, "last_activity_date": 1444250764, "creation_date": 1444250764, "answer_id": 33002114, "question_id": 33002057, "link": "https://stackoverflow.com/questions/33002057/returning-the-key-in-a-c-dictionary-whos-valueclass-meets-a-criteria/33002114#33002114", "title": "Returning the key in a c# dictionary who&#39;s value(class) meets a criteria", "body": "<p>You could find the lowest age, then find the person with that age (or the first person with that age, there could be multiples):</p>\n\n<pre><code>int lowestAge = people.Min(kvp =&gt; kvp.Value.age);\nint id = people.First(kvp =&gt; kvp.Value.age == lowestAge).Key;\n</code></pre>\n\n<p>or, even simpler, just use <code>OrderBy</code> and grab the first:</p>\n\n<pre><code>int id = people.OrderBy(kvp =&gt; kvp.Value.age).First().Key;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 2, "creation_date": 1444252335, "post_id": 33002344, "comment_id": 53829877, "body": "Clever. Avoids double-scanning but also avoids a manually-typed foreach."}], "tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": false, "score": 5, "last_activity_date": 1444251683, "creation_date": 1444251683, "answer_id": 33002344, "question_id": 33002057, "link": "https://stackoverflow.com/questions/33002057/returning-the-key-in-a-c-dictionary-whos-valueclass-meets-a-criteria/33002344#33002344", "title": "Returning the key in a c# dictionary who&#39;s value(class) meets a criteria", "body": "<pre><code>var key = people.Aggregate((a, b) =&gt; a.Value.age &lt; b.Value.age ? a : b).Key;\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4044266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40e151e7d9df17dfa1d18e11c6cbc12a?s=128&d=identicon&r=PG&f=1", "display_name": "GeoJohn", "link": "https://stackoverflow.com/users/4044266/geojohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 33002114, "answer_count": 2, "score": 0, "last_activity_date": 1444251683, "creation_date": 1444250485, "question_id": 33002057, "link": "https://stackoverflow.com/questions/33002057/returning-the-key-in-a-c-dictionary-whos-valueclass-meets-a-criteria", "title": "Returning the key in a c# dictionary who&#39;s value(class) meets a criteria", "body": "<p>Given the following code, what is the best way to return the key with the lowest age from the dictionary.</p>\n\n<pre><code> public class Person\n    {\n        public int age {get; set;}\n        public string name {get; set;}\n\n        public Person(int Age, string Name)\n        {\n            age = Age;\n            name = Name;\n        }\n    }\n\n\n    public Dictionary&lt;int, Person&gt; people = new Dictionary&lt;int, Person&gt;();\n\n    public int idNumber = // Key of person with lowest age inside Dictionary ?????\n</code></pre>\n\n<p>I've looked into priority queues, but it all seems to overkill.  I feel like there must be a simple way to just say give me the key where age is the lowest.</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 3013996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0cff7ba354b64ffef44b8636ffc6c80b?s=128&d=identicon&r=PG&f=1", "display_name": "789", "link": "https://stackoverflow.com/users/3013996/789"}, "edited": false, "score": 0, "creation_date": 1444250969, "post_id": 33002086, "comment_id": 53829213, "body": "It worked! thanks. 2 questions: why can you bind only to properties? what is the problem with fields? if you try to bind in code behind - you can bind to fields. 2) what does <code>=&gt;</code> in C#6? delegate?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 668, "user_id": 3013996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0cff7ba354b64ffef44b8636ffc6c80b?s=128&d=identicon&r=PG&f=1", "display_name": "789", "link": "https://stackoverflow.com/users/3013996/789"}, "edited": false, "score": 0, "creation_date": 1444251199, "post_id": 33002086, "comment_id": 53829340, "body": "@789 Its just the rule, and has to do with how the binding system uses reflection to find the binding targets. As for 2, =&gt; reads &quot;such that&quot; and <i>usually</i> is used with lambda expressions. In this case it defines a function bodied member. I added a bit of explanation to my answer."}, {"owner": {"reputation": 668, "user_id": 3013996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0cff7ba354b64ffef44b8636ffc6c80b?s=128&d=identicon&r=PG&f=1", "display_name": "789", "link": "https://stackoverflow.com/users/3013996/789"}, "edited": false, "score": 0, "creation_date": 1444251316, "post_id": 33002086, "comment_id": 53829404, "body": "<code>system uses reflection</code> explain?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 668, "user_id": 3013996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0cff7ba354b64ffef44b8636ffc6c80b?s=128&d=identicon&r=PG&f=1", "display_name": "789", "link": "https://stackoverflow.com/users/3013996/789"}, "edited": false, "score": 0, "creation_date": 1444251535, "post_id": 33002086, "comment_id": 53829521, "body": "@789 Without trying to explain all of reflection (which is a decent sized topic in C#) the system dynamically looks for members with the name you provided on the <code>Path</code> variable of your binding. When it does so, it only looks for properties (not fields or methods). Its just how they chose to implement it. Here&#39;s an article on reflection: <a href=\"https://msdn.microsoft.com/en-us/library/ms173183.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms173183.aspx</a> Do note that this is an <i>advanced</i> concept that is <b>very easily misused</b>. I would steer clear of it until you have a good handle on programming in .NET."}, {"owner": {"reputation": 668, "user_id": 3013996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0cff7ba354b64ffef44b8636ffc6c80b?s=128&d=identicon&r=PG&f=1", "display_name": "789", "link": "https://stackoverflow.com/users/3013996/789"}, "edited": false, "score": 0, "creation_date": 1444252518, "post_id": 33002086, "comment_id": 53829972, "body": "basically reflection is creating custom objects at run time right?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 668, "user_id": 3013996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0cff7ba354b64ffef44b8636ffc6c80b?s=128&d=identicon&r=PG&f=1", "display_name": "789", "link": "https://stackoverflow.com/users/3013996/789"}, "edited": false, "score": 0, "creation_date": 1444252656, "post_id": 33002086, "comment_id": 53830045, "body": "@789 It can be used to create objects based on a <code>Type</code> object (<code>Activator.CreateInstance</code>) yes, but is used for <b>SO</b> much more than that. Come by the WPF room <a href=\"http://chat.stackoverflow.com/rooms/18165/wpf\">chat.stackoverflow.com/rooms/18165/wpf</a> if you want to chat about it."}], "tags": [], "owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "is_accepted": true, "score": 1, "last_activity_date": 1444251136, "last_edit_date": 1444251136, "creation_date": 1444250612, "answer_id": 33002086, "question_id": 33002034, "link": "https://stackoverflow.com/questions/33002034/combobox-itemssource-binding-doesnt-update-with-observable-collection-add/33002086#33002086", "title": "ComboBox ItemsSource binding doesn&#39;t update with Observable Collection Add", "body": "<p>Your binding never worked in the first place. You can only bind to <em>properties</em> not <em>fields</em>.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>public ObservableCollection&lt;string&gt; test { get; set; }\n\npublic Window1()\n{\n    Test = new ObservableCollection&lt;string&gt;();\n}\n</code></pre>\n\n<p>Or if you want some tricky C# 6 magic:</p>\n\n<pre><code>public ObservableCollection&lt;string&gt; test =&gt; new ObservableCollection&lt;string&gt;();\n</code></pre>\n\n<p>This is a <em>function bodied-member</em> and compiles to a read-only property that is initialized to the new <code>ObservableCollection</code></p>\n\n<p>Caveats/Design Errors:</p>\n\n<p>Note that in both cases you aren't using <code>INotifyPropertyChanged</code>, so wholesale assignments to the collection won't be picked up by the UI. You should also be using PascalCase for your public properties, and using a proper view model instead of binding to the code-behind.</p>\n"}], "owner": {"reputation": 668, "user_id": 3013996, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0cff7ba354b64ffef44b8636ffc6c80b?s=128&d=identicon&r=PG&f=1", "display_name": "789", "link": "https://stackoverflow.com/users/3013996/789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 33002086, "answer_count": 1, "score": 1, "last_activity_date": 1444251136, "creation_date": 1444250364, "last_edit_date": 1444250452, "question_id": 33002034, "link": "https://stackoverflow.com/questions/33002034/combobox-itemssource-binding-doesnt-update-with-observable-collection-add", "title": "ComboBox ItemsSource binding doesn&#39;t update with Observable Collection Add", "body": "<p>I have a simple wpf app, that I want to try to use ItemsSource binding from xaml. When I click the button. it should be updated also in the UI, but it doesn't.</p>\n\n<p>Why doesn't it work?</p>\n\n<p>Xaml code:</p>\n\n<pre><code>&lt;Window x:Class=\"SendRawEthernetPacketsGUI.Window1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Window1\" Height=\"300\" Width=\"300\"&gt;\n&lt;Grid&gt;\n    &lt;ComboBox HorizontalAlignment=\"Left\" Margin=\"76,65,0,0\" VerticalAlignment=\"Top\" Width=\"120\" ItemsSource=\"{Binding test}\"/&gt;\n    &lt;Button Content=\"Button\" HorizontalAlignment=\"Left\" Margin=\"90,171,0,0\" VerticalAlignment=\"Top\" Width=\"75\" Click=\"Button_Click\"/&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>C# code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Collections.ObjectModel;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Shapes;\n\nnamespace SendRawEthernetPacketsGUI\n{\n\n/// &lt;summary&gt;\n/// Interaction logic for Window1.xaml\n/// &lt;/summary&gt;\npublic partial class Window1 : Window\n{\n    public ObservableCollection&lt;string&gt; test = new ObservableCollection&lt;string&gt;();\n    public Window1()\n    {\n        InitializeComponent();\n        DataContext = this;\n    }\n\n    private void Button_Click(object sender, RoutedEventArgs e)\n    {\n        test.Add(\"fdfddf\");\n    }\n}\n}\n</code></pre>\n\n<p>It feels kinda stupid to even ask this, but even looking in google didn't help me. So can you?</p>\n"}, {"tags": ["c#", "solr", "lucene.net"], "comments": [{"owner": {"reputation": 5208, "user_id": 351154, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/21b6b9da626b128a26f839b8f96579da?s=128&d=identicon&r=PG", "display_name": "user8128167", "link": "https://stackoverflow.com/users/351154/user8128167"}, "edited": false, "score": 0, "creation_date": 1444253035, "post_id": 33002016, "comment_id": 53830240, "body": "Since Lucene.NET is open source, why don&#39;t you include it as a project in your solution, then step through the Lucene code to find out what exactly is causing the exception?"}, {"owner": {"reputation": 37, "user_id": 3582260, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb4bb298b4879562aa9c1d5614c51758?s=128&d=identicon&r=PG&f=1", "display_name": "user3582260", "link": "https://stackoverflow.com/users/3582260/user3582260"}, "reply_to_user": {"reputation": 5208, "user_id": 351154, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/21b6b9da626b128a26f839b8f96579da?s=128&d=identicon&r=PG", "display_name": "user8128167", "link": "https://stackoverflow.com/users/351154/user8128167"}, "edited": false, "score": 0, "creation_date": 1444262946, "post_id": 33002016, "comment_id": 53833680, "body": "Thank you user89861 - The error is caused by &quot;Lucene.Net.Search.IndexSearcher searcher = new Lucene.Net.Search.IndexSearcher(dir);&quot;"}, {"owner": {"reputation": 8298, "user_id": 2663985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/531b51e8cd1cf8655256f3e913ed9eef?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterion", "link": "https://stackoverflow.com/users/2663985/mysterion"}, "edited": false, "score": 0, "creation_date": 1444297726, "post_id": 33002016, "comment_id": 53847980, "body": "so, the problem is solved now or what?"}], "owner": {"reputation": 37, "user_id": 3582260, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb4bb298b4879562aa9c1d5614c51758?s=128&d=identicon&r=PG&f=1", "display_name": "user3582260", "link": "https://stackoverflow.com/users/3582260/user3582260"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444250812, "creation_date": 1444250281, "last_edit_date": 1444250812, "question_id": 33002016, "link": "https://stackoverflow.com/questions/33002016/lucene-net-query-error", "title": "Lucene.Net Query Error", "body": "<p>I've just installed Solr/Lucene on a Windows machine simply to test its capability. I've indexed a couple hundred files and I'm able to successfully query the indexed content through the web interface. Given that the web interface isn't too user friendly I thought I'd try to create a simple application to do a full text search over the indexed content. So far I have:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.IO;\nusing Lucene.Net;\n\nnamespace solrTest\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            string indexFileLocation = @\"C:\\solr-5.3.1\\server\\solr\\test\\data\\index\";\n            Lucene.Net.Store.Directory dir = Lucene.Net.Store.FSDirectory.Open(indexFileLocation);\n\n            Lucene.Net.Search.IndexSearcher searcher = new Lucene.Net.Search.IndexSearcher(dir);\n\n            Lucene.Net.Index.Term searchTerm = new Lucene.Net.Index.Term(\"ID\", \"1\");\n            Lucene.Net.Search.Query query = new Lucene.Net.Search.TermQuery(searchTerm);\n\n            Lucene.Net.Search.TopDocs results = searcher.Search(query, null, 10);\n\n            foreach(Lucene.Net.Search.ScoreDoc test in results.ScoreDocs)\n            {\n                Console.WriteLine(test.ToString());\n                Console.ReadLine();\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>When running the code I receive an error stating:</p>\n\n<pre><code>An unhandled exception of type 'System.IO.IOException' occurred in Lucene.Net.dll\nAdditional information: read past EOF\n</code></pre>\n\n<p>I know I'm missing something obvious. Your help would be greatly appreciated. </p>\n\n<p>Edit: I downloaded Luke.Net and received the same error. </p>\n"}, {"tags": ["c#", "windows-10", "certenroll"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444250339, "post_id": 33001983, "comment_id": 53828890, "body": "Have you tried running this in both 64 bit and 32 bit mode? Looks like MS changed the interface significantly between the two."}, {"owner": {"reputation": 451, "user_id": 1316167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad5693dca14b0f799b2fb575e86dfa5?s=128&d=identicon&r=PG", "display_name": "spowser", "link": "https://stackoverflow.com/users/1316167/spowser"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444250392, "post_id": 33001983, "comment_id": 53828917, "body": "So far my tests have only been x64"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 1, "creation_date": 1444250563, "post_id": 33001983, "comment_id": 53829004, "body": "From an elevated command prompt, can you run <code>regsvr32 c:\\Windows\\System32\\CertEnroll.dll</code> and see if that makes any difference? It could be because of a broken registration, otherwise try to run under 32 bit and see if you get the same error."}, {"owner": {"reputation": 451, "user_id": 1316167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad5693dca14b0f799b2fb575e86dfa5?s=128&d=identicon&r=PG", "display_name": "spowser", "link": "https://stackoverflow.com/users/1316167/spowser"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444250998, "post_id": 33001983, "comment_id": 53829229, "body": "The .dll is registered fine.  The target machine will always be x64 and the application this is in must be compiled as x64.  The code is simply a snippet from that application.  If I had to guess, this issue has something to do with the ActiveX changes they did in Windows 10 but I thought those were only for Edge"}, {"owner": {"reputation": 7491, "user_id": 2057955, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/286aaf1c939cbcfc4d4a812b398066a2?s=128&d=identicon&r=PG", "display_name": "zaitsman", "link": "https://stackoverflow.com/users/2057955/zaitsman"}, "edited": false, "score": 0, "creation_date": 1451126359, "post_id": 33001983, "comment_id": 56682585, "body": "I can confirm i am facing the same problem, have you ever found a solution?"}, {"owner": {"reputation": 3436, "user_id": 1452775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caeaaeb6ea07dac423f3a87a2929b29a?s=128&d=identicon&r=PG", "display_name": "Manish Parakhiya", "link": "https://stackoverflow.com/users/1452775/manish-parakhiya"}, "edited": false, "score": 0, "creation_date": 1472267355, "post_id": 33001983, "comment_id": 65696123, "body": "I have same issue. do you get any solution?"}, {"owner": {"reputation": 451, "user_id": 1316167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad5693dca14b0f799b2fb575e86dfa5?s=128&d=identicon&r=PG", "display_name": "spowser", "link": "https://stackoverflow.com/users/1316167/spowser"}, "edited": false, "score": 0, "creation_date": 1473356443, "post_id": 33001983, "comment_id": 66120195, "body": "Posted the answer below."}], "answers": [{"comments": [{"owner": {"reputation": 4283, "user_id": 1100379, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/jrX71.jpg?s=128&g=1", "display_name": "Asher Garland", "link": "https://stackoverflow.com/users/1100379/asher-garland"}, "edited": false, "score": 0, "creation_date": 1493312929, "post_id": 35365099, "comment_id": 74374937, "body": "Where does GetMachineDN come from?"}], "tags": [], "owner": {"reputation": 1202, "user_id": 5243037, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/haoWt.png?s=128&g=1", "display_name": "MHolzmayr", "link": "https://stackoverflow.com/users/5243037/mholzmayr"}, "is_accepted": false, "score": 16, "last_activity_date": 1456118433, "last_edit_date": 1495540940, "creation_date": 1455287438, "answer_id": 35365099, "question_id": 33001983, "link": "https://stackoverflow.com/questions/33001983/issues-compiling-in-windows-10/35365099#35365099", "title": "Issues compiling in Windows 10", "body": "<p>Somehow the Interface Implementation on CertEnroll.dll changed between \"vanilla\" Windows 2008 and Windows 2008 R2. I guess it is the same with some Windows 7 builds. To get it (halfway) working, you have to instantiate the classes with <code>Activator.CreateInstance(Type.GetTypeFromProgID(&lt;TypeName&gt;)</code>;\nThis will cause the system to look up the references in HKLM:\\SOFTWARE\\Classes\\Interface\\ to get the right class for you. </p>\n\n<h1>Working Example:</h1>\n\n<p>(Part of this code was used from <a href=\"https://stackoverflow.com/a/13806300/5243037\">https://stackoverflow.com/a/13806300/5243037</a>)</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.DirectoryServices.ActiveDirectory;\nusing System.Linq;\nusing System.Net;\nusing System.Net.NetworkInformation;\nusing System.Net.Sockets;\nusing System.Security.Cryptography.X509Certificates;\nusing CERTENROLLLib;\n\n\n/// &lt;summary&gt;\n///     Creates a self-signed certificate in the computer certificate store MY.\n///     Issuer and Subject are computername and its domain.\n/// &lt;/summary&gt;\n/// &lt;param name=\"friendlyName\"&gt;Friendly-name of the certificate&lt;/param&gt;\n/// &lt;param name=\"password\"&gt;Password which will be used by creation. I think it's obsolete...&lt;/param&gt;\n/// &lt;returns&gt;Created certificate&lt;/returns&gt;\n/// &lt;remarks&gt;Base from https://stackoverflow.com/a/13806300/5243037 &lt;/remarks&gt;\npublic static X509Certificate2 CreateSelfSignedCertificate(string friendlyName, string password)\n{\n    // create DN for subject and issuer\n    var dnHostName = new CX500DistinguishedName();\n    // DN will be in format CN=machinename, DC=domain, DC=local for machinename.domain.local\n    dnHostName.Encode(GetMachineDn());\n    var dnSubjectName = dnHostName;\n\n    //var privateKey = new CX509PrivateKey();\n    var typeName = \"X509Enrollment.CX509PrivateKey\";\n    var type = Type.GetTypeFromProgID(typeName);\n    if (type == null)\n    {\n        throw new Exception(typeName + \" is not available on your system: 0x80040154 (REGDB_E_CLASSNOTREG)\");\n    }\n    var privateKey = Activator.CreateInstance(type) as IX509PrivateKey;\n    if (privateKey == null)\n    {\n        throw new Exception(\"Your certlib does not know an implementation of \" + typeName +\n                            \" (in HKLM:\\\\SOFTWARE\\\\Classes\\\\Interface\\\\)!\");\n    }\n    privateKey.ProviderName = \"Microsoft Enhanced RSA and AES Cryptographic Provider\";\n    privateKey.ProviderType = X509ProviderType.XCN_PROV_RSA_AES;\n    // key-bitness\n    privateKey.Length = 2048;\n    privateKey.KeySpec = X509KeySpec.XCN_AT_KEYEXCHANGE;\n    privateKey.MachineContext = true;\n    // Don't allow export of private key\n    privateKey.ExportPolicy = X509PrivateKeyExportFlags.XCN_NCRYPT_ALLOW_EXPORT_NONE;\n\n    // use is not limited\n    privateKey.Create();\n\n    // Use the stronger SHA512 hashing algorithm\n    var hashobj = new CObjectId();\n    hashobj.InitializeFromAlgorithmName(ObjectIdGroupId.XCN_CRYPT_HASH_ALG_OID_GROUP_ID,\n        ObjectIdPublicKeyFlags.XCN_CRYPT_OID_INFO_PUBKEY_ANY,\n        AlgorithmFlags.AlgorithmFlagsNone, \"SHA512\");\n\n    // add extended key usage if you want - look at MSDN for a list of possible OIDs\n    var oid = new CObjectId();\n    oid.InitializeFromValue(\"1.3.6.1.5.5.7.3.1\"); // SSL server\n    var oidlist = new CObjectIds { oid };\n    var eku = new CX509ExtensionEnhancedKeyUsage();\n    eku.InitializeEncode(oidlist);\n\n    // add all IPs of current machine as dns-names (SAN), so a user connecting to our wcf \n    // service by IP still claim-trusts this server certificate\n    var objExtensionAlternativeNames = new CX509ExtensionAlternativeNames();\n    {\n        var altNames = new CAlternativeNames();\n        var dnsHostname = new CAlternativeName();\n        dnsHostname.InitializeFromString(AlternativeNameType.XCN_CERT_ALT_NAME_DNS_NAME, Environment.MachineName);\n        altNames.Add(dnsHostname);\n        foreach (var ipAddress in Dns.GetHostAddresses(Dns.GetHostName()))\n        {\n            if ((ipAddress.AddressFamily == AddressFamily.InterNetwork ||\n                 ipAddress.AddressFamily == AddressFamily.InterNetworkV6) &amp;&amp; !IPAddress.IsLoopback(ipAddress))\n            {\n                var dns = new CAlternativeName();\n                dns.InitializeFromString(AlternativeNameType.XCN_CERT_ALT_NAME_DNS_NAME, ipAddress.ToString());\n                altNames.Add(dns);\n            }\n        }\n        objExtensionAlternativeNames.InitializeEncode(altNames);\n    }\n\n    // Create the self signing request\n    //var cert = new CX509CertificateRequestCertificate();\n    typeName = \"X509Enrollment.CX509CertificateRequestCertificate\";\n    type = Type.GetTypeFromProgID(typeName);\n    if (type == null)\n    {\n        throw new Exception(typeName + \" is not available on your system: 0x80040154 (REGDB_E_CLASSNOTREG)\");\n    }\n    var cert = Activator.CreateInstance(type) as IX509CertificateRequestCertificate;\n    if (cert == null)\n    {\n        throw new Exception(\"Your certlib does not know an implementation of \" + typeName +\n                            \" (in HKLM:\\\\SOFTWARE\\\\Classes\\\\Interface\\\\)!\");\n    }\n    cert.InitializeFromPrivateKey(X509CertificateEnrollmentContext.ContextMachine, privateKey, \"\");\n    cert.Subject = dnSubjectName;\n    cert.Issuer = dnHostName; // the issuer and the subject are the same\n    cert.NotBefore = DateTime.Now.AddDays(-1);\n    // this cert expires immediately. Change to whatever makes sense for you\n    cert.NotAfter = DateTime.Now.AddYears(1);\n    cert.X509Extensions.Add((CX509Extension)eku); // add the EKU\n    cert.X509Extensions.Add((CX509Extension)objExtensionAlternativeNames);\n    cert.HashAlgorithm = hashobj; // Specify the hashing algorithm\n    cert.Encode(); // encode the certificate\n\n    // Do the final enrollment process\n    //var enroll = new CX509Enrollment();\n    typeName = \"X509Enrollment.CX509Enrollment\";\n    type = Type.GetTypeFromProgID(typeName);\n    if (type == null)\n    {\n        throw new Exception(typeName + \" is not available on your system: 0x80040154 (REGDB_E_CLASSNOTREG)\");\n    }\n    var enroll = Activator.CreateInstance(type) as IX509Enrollment;\n    if (enroll == null)\n    {\n        throw new Exception(\"Your certlib does not know an implementation of \" + typeName +\n                            \" (in HKLM:\\\\SOFTWARE\\\\Classes\\\\Interface\\\\)!\");\n    }\n    // Use private key to initialize the certrequest...\n    enroll.InitializeFromRequest(cert);\n    enroll.CertificateFriendlyName = friendlyName; // Optional: add a friendly name\n    var csr = enroll.CreateRequest(); // Output the request in base64 and install it back as the response\n    enroll.InstallResponse(InstallResponseRestrictionFlags.AllowUntrustedCertificate, csr,\n        EncodingType.XCN_CRYPT_STRING_BASE64, password);\n\n    // This will fail on Win2k8, some strange \"Parameter is empty\" error... Thus we search the\n    // certificate by serial number with the managed X509Store-class\n    // // output a base64 encoded PKCS#12 so we can import it back to the .Net security classes\n    //var base64Encoded = enroll.CreatePFX(password, PFXExportOptions.PFXExportChainNoRoot, EncodingType.XCN_CRYPT_STRING_BASE64);\n    //return new X509Certificate2(Convert.FromBase64String(base64Encoded), password, X509KeyStorageFlags.MachineKeySet | X509KeyStorageFlags.PersistKeySet);\n    var certFs = LoadCertFromStore(cert.SerialNumber);\n    if (!certFs.HasPrivateKey) throw new InvalidOperationException(\"Created certificate has no private key!\");\n\n    return certFs;\n}\n\n\n/// &lt;summary&gt;\n///     Converts Domain.local into CN=Domain, CN=local\n/// &lt;/summary&gt;\nprivate static string GetDomainDn()\n{\n    var fqdnDomain = IPGlobalProperties.GetIPGlobalProperties().DomainName;\n    if (string.IsNullOrWhiteSpace(fqdnDomain)) return null;\n    var context = new DirectoryContext(DirectoryContextType.Domain, fqdnDomain);\n    var d = Domain.GetDomain(context);\n    var de = d.GetDirectoryEntry();\n    return de.Properties[\"DistinguishedName\"].Value.ToString();\n}\n\n/// &lt;summary&gt;\n///     Gets machine and domain name in X.500-format: CN=PC,DN=MATESO,DN=local\n/// &lt;/summary&gt;\nprivate static string GetMachineDn()\n{\n    var machine = \"CN=\" + Environment.MachineName;\n    var dom = GetDomainDn();\n    return machine + (string.IsNullOrWhiteSpace(dom) ? \"\" : \", \" + dom);\n}\n\n/// &lt;summary&gt;\n///     Load a certificate by serial number from computer.my-store\n/// &lt;/summary&gt;\n/// &lt;param name=\"serialNumber\"&gt;Base64-encoded certificate serial number&lt;/param&gt;\nprivate static X509Certificate2 LoadCertFromStore(string serialNumber)\n{\n    var store = new X509Store(StoreName.My, StoreLocation.LocalMachine);\n    store.Open(OpenFlags.OpenExistingOnly | OpenFlags.MaxAllowed);\n    try\n    {\n        // serialnumber from certenroll.dll v6 is a base64 encoded byte array, which is reversed.\n        // serialnumber from certenroll.dll v10 is a base64 encoded byte array, which is NOT reversed.\n        var serialBytes = Convert.FromBase64String(serialNumber);\n        var serial = BitConverter.ToString(serialBytes.ToArray()).Replace(\"-\", \"\");\n        var serialReversed = BitConverter.ToString(serialBytes.Reverse().ToArray()).Replace(\"-\", \"\");\n\n        var serverCerts = store.Certificates.Find(X509FindType.FindBySerialNumber, serial, false);\n        if (serverCerts.Count == 0)\n        {\n            serverCerts = store.Certificates.Find(X509FindType.FindBySerialNumber, serialReversed, false);\n        }\n        if (serverCerts.Count == 0)\n        {\n            throw new KeyNotFoundException(\"No certificate with serial number &lt;\" + serial + \"&gt; or reversed serial &lt;\" + serialReversed + \"&gt; found!\");\n        }\n        if (serverCerts.Count &gt; 1)\n        {\n            throw new Exception(\"Found multiple certificates with serial &lt;\" + serial + \"&gt; or reversed serial &lt;\" + serialReversed + \"&gt;!\");\n        }\n\n        return serverCerts[0];\n    }\n    finally\n    {\n        store.Close();\n    }\n}\n</code></pre>\n\n<h1>Remarks</h1>\n\n<p>So why did I write \"halfway\"? There is a problem with certenroll.dll V. 6, which causes the build to fail on cert.InitializeFromPrivateKey. In certenroll.dll V 6.0, the second parameter must be of type \"CX509PrivateKey\", whereas on Win10 machines with Certenroll.dll V 10, it's IX509PrivateKey:</p>\n\n<blockquote>\n  <p>error CS1503: Argument 2: cannot convert from 'CERTENROLLLib.IX509PrivateKey' to 'CERTENROLLLib.CX509PrivateKey'</p>\n</blockquote>\n\n<p>So you would think: Yea, simply \"cast\" the privateKey in the above example to CX509PrivateKey on Activator.CreateInstance. The Problem here is, it will compile, but on vanilla Win2k8 it will not give you the class (CX509...) but the Interface (IX509...), and thus the cast fails and returns null.</p>\n\n<p>We've solved this issue by compiling the certenrollment function in a seperate project on a machine with certenroll.dll V 10. It compiles fine and works in Win2k8, too. It's never-the-less a bit annoying to have it in a seperate project, since the build will fail on our buildserver with certenroll.dll V 6.</p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 2130245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b656a1952be2fcf5725c0a1971149ab?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Mulgrew", "link": "https://stackoverflow.com/users/2130245/tom-mulgrew"}, "edited": false, "score": 0, "creation_date": 1507766231, "post_id": 39397121, "comment_id": 80346000, "body": "Note:You need to use the /out switch, i.e. Tlbimp.exe /out:CertEnroll_Interop c:\\Windows\\System32\\CertEnroll.dll  Otherwise it thinks CertEnroll_Interop is the type library name, and complains that it can&#39;t find it."}], "tags": [], "owner": {"reputation": 451, "user_id": 1316167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad5693dca14b0f799b2fb575e86dfa5?s=128&d=identicon&r=PG", "display_name": "spowser", "link": "https://stackoverflow.com/users/1316167/spowser"}, "is_accepted": true, "score": 9, "last_activity_date": 1473356322, "creation_date": 1473356322, "answer_id": 39397121, "question_id": 33001983, "link": "https://stackoverflow.com/questions/33001983/issues-compiling-in-windows-10/39397121#39397121", "title": "Issues compiling in Windows 10", "body": "<p>These are the steps from Microsoft to resolve this issue</p>\n\n<p>If you use Windows 10 solely as your build environment then the executable would run on downlevel OSes, however if you really just want to have a project that you can compile anywhere and run anywhere then the only solution is to create your own interop DLL that you include in the project folder.  You would have to generate it on Windows 7 first and reference that DLL.  </p>\n\n<p>Tlbimp.exe CertEnroll_Interop c:\\Windows\\System32\\CertEnroll.dll</p>\n\n<p>This generates a CertEnroll_Interop.dll file that you can copy to your project folder and then browse to in your project.  Of course you would need the using \u201cusing CertEnroll_Interop;\u201d statement.</p>\n\n<p>You can build the project on Windows 10 and have it run on Windows 7 and Windows 8.1 and any other combination.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 9209802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NwYJD.png?s=128&g=1", "display_name": "geraphl", "link": "https://stackoverflow.com/users/9209802/geraphl"}, "is_accepted": false, "score": 2, "last_activity_date": 1515773017, "creation_date": 1515773017, "answer_id": 48229896, "question_id": 33001983, "link": "https://stackoverflow.com/questions/33001983/issues-compiling-in-windows-10/48229896#48229896", "title": "Issues compiling in Windows 10", "body": "<p>I had the same problem, my development machine is running on windows 10 and the build server windows 8.1.</p>\n\n<p>But since c# has the ability of reflection and dynamic types, i now first analyze which types the <em>InitializeFromPrivateKey</em> method takes as parameters(I separated it from the actually certificate code by creating a method).</p>\n\n<pre><code>    private static bool IsCompiledOnWin10AndAbove()\n    {\n        var typeOfMethod = typeof(IX509CertificateRequestPkcs10);\n        var methodType = typeOfMethod.GetMethod(\"InitializeFromPrivateKey\", new Type[] { typeof(X509CertificateEnrollmentContext), typeof(CX509PrivateKey), typeof(string) });\n        var methodeParameters = methodType.GetParameters();\n        return methodeParameters[1].ParameterType != typeof(CX509PrivateKey);\n    }\n</code></pre>\n\n<p>And then use a dynamic type dependent on which type the second parameter is.</p>\n\n<pre><code>        dynamic privateKeyCorrectType;\n        if (IsCompiledOnWin10AndAbove()) // win 10 and above compiled\n        {\n            privateKeyCorrectType= privateKey;\n        }\n        else // below win 10 compiled\n        {\n            privateKeyCorrectType= (CX509PrivateKey)privateKey;\n        }\n        cert.InitializeFromPrivateKey(X509CertificateEnrollmentContext.ContextMachine, privateKeyCorrectType, \"\");\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 1316167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad5693dca14b0f799b2fb575e86dfa5?s=128&d=identicon&r=PG", "display_name": "spowser", "link": "https://stackoverflow.com/users/1316167/spowser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3540, "favorite_count": 4, "accepted_answer_id": 39397121, "answer_count": 3, "score": 16, "last_activity_date": 1515773017, "creation_date": 1444250115, "last_edit_date": 1444250509, "question_id": 33001983, "link": "https://stackoverflow.com/questions/33001983/issues-compiling-in-windows-10", "title": "Issues compiling in Windows 10", "body": "<p>I have identified an issue related to building apps that use C:\\Windows\\System32\\CertEnroll.dll as a reference.</p>\n\n<p>The following code works fine when compiled using VS 2015 on Windows 7 and then ran on a Windows 7 machine.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing CERTENROLLLib;\n\nnamespace CertTest\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            try\n            {\n                CX509PrivateKey key = new CX509PrivateKey();\n                key.ContainerName = Guid.NewGuid().ToString();\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e.Message);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>When you try and compile this in Windows 10 and then try and run it on a Windows 7 machine, it throws the following error.</p>\n\n<blockquote>\n  <p>\"Unable to cast COM object of type 'System.__ComObject' to interface type 'CERTENROLLLib.CX509PrivateKey'. This operation failed because the QueryInterface call on the COM component for the interface with IID '{728AB362-217D-11DA-B2A4-000E7BBB2B09}' failed due to the following error: No such interface supported (Exception from HRESULT: 0x80004002 (E_NOINTERFACE)).\"</p>\n</blockquote>\n\n<p>I have had several people here replicate it and I'd like to get more input before contacting Microsoft on what's going on here.</p>\n\n<p>I guess my question is:  Can anybody else confirm this or if it's confirmed they broke backward compatibilty?</p>\n"}, {"tags": ["c#", "windows-phone-8.1", "windows-phone", "charles-proxy"], "answers": [{"tags": [], "owner": {"reputation": 2803, "user_id": 1733263, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5Ysp4.jpg?s=128&g=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/1733263/damien"}, "is_accepted": true, "score": 2, "last_activity_date": 1444257132, "creation_date": 1444257132, "answer_id": 33003530, "question_id": 33001933, "link": "https://stackoverflow.com/questions/33001933/charles-proxy-and-windows-phone-when-using-http-queries-need-ssl-certificate/33003530#33003530", "title": "Charles Proxy and Windows Phone when using HTTP Queries (need SSL certificate)", "body": "<p>So after looking and trying different things, here is the full solution:</p>\n\n<p>You phone and windows machine need to be on the same network (of course)</p>\n\n<p><em>On your Windows device:</em></p>\n\n<p>On open cmd -> ipconfig get the IP of your windows device.</p>\n\n<p><em>On your Phone:</em></p>\n\n<p>In your Wi-Fi parameters, activate Proxy, set the IP of your windows device on your phone and the port on which the proxy is listening on ( for me it was 8890)</p>\n\n<p>Then in Internet explorer go to: <strong><a href=\"http://www.charlesproxy.com/getssl\" rel=\"nofollow\">http://www.charlesproxy.com/getssl</a></strong>  and install the certificate </p>\n\n<p><em>On your Windows device:</em></p>\n\n<p><strong>In Charles under **SSL proxy setting</strong> add the location to which you want to proxy, for me it was api.Blabla.com I did not put a port number.**</p>\n\n<p>In Charles proxy you should not be able to see https traffic. =)</p>\n"}], "owner": {"reputation": 2803, "user_id": 1733263, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5Ysp4.jpg?s=128&g=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/1733263/damien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "accepted_answer_id": 33003530, "answer_count": 1, "score": 1, "last_activity_date": 1444257132, "creation_date": 1444249925, "last_edit_date": 1444251353, "question_id": 33001933, "link": "https://stackoverflow.com/questions/33001933/charles-proxy-and-windows-phone-when-using-http-queries-need-ssl-certificate", "title": "Charles Proxy and Windows Phone when using HTTP Queries (need SSL certificate)", "body": "<p>I am trying to use Charles proxy to see if my API call are correct and i am having issues seeing my https calls, has anyone ever installed Charles proxy and used https on Windows Phone 8.1?</p>\n"}, {"tags": ["c#", "firefox", "selenium", "selenium-webdriver"], "comments": [{"owner": {"reputation": 21, "user_id": 5416056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9f390dfc70375733890787ae7ec068?s=128&d=identicon&r=PG&f=1", "display_name": "JWJ", "link": "https://stackoverflow.com/users/5416056/jwj"}, "edited": false, "score": 0, "creation_date": 1444254664, "post_id": 33001927, "comment_id": 53830998, "body": "I need to add that adding a wait period is not the answer. I have stepped through the program and waited until the page is completely loaded and I have verified manually that the element exists. I still cannot get the program to find this element. I also know that there are iframes on the page, but changing which iframe I am referencing doesn&#39;t seem to help either."}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1444265430, "post_id": 33001927, "comment_id": 53834352, "body": "Is this element visible on the page? Selenium will only interact with visible elements by design."}, {"owner": {"reputation": 1186, "user_id": 2285470, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Mt4NX.jpg?s=128&g=1", "display_name": "iamkenos", "link": "https://stackoverflow.com/users/2285470/iamkenos"}, "edited": false, "score": 0, "creation_date": 1495508720, "post_id": 33001927, "comment_id": 75269127, "body": "Check if your element is within an iframe. If it is, try this solution: <a href=\"https://stackoverflow.com/a/9652932/2285470\">stackoverflow.com/a/9652932/2285470</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1771, "user_id": 1909798, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0ecd6259597b943ddba1666629312e04?s=128&d=identicon&r=PG", "display_name": "robsonrosa", "link": "https://stackoverflow.com/users/1909798/robsonrosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1444250903, "last_edit_date": 1495541907, "creation_date": 1444250903, "answer_id": 33002161, "question_id": 33001927, "link": "https://stackoverflow.com/questions/33001927/how-do-i-access-this-element-in-c-using-selenium/33002161#33002161", "title": "How do I access this element in C# using Selenium?", "body": "<p>Try closing tag input with <code>/&gt;</code> like explained <a href=\"https://stackoverflow.com/questions/13232121/closing-html-input-tag-issue/13232170#13232170\">here</a>.</p>\n\n<p><code>&lt;input maxlength=\"100\" size=\"20\" value=\"\" name=\"keyword\" id=\"keyword\" title=\"keyword\" class=\"FORMshrt2\" /&gt;</code></p>\n\n<p>I don't know if Selenium expects this closing tag, but everything else look ok.</p>\n"}, {"tags": [], "owner": {"reputation": 411841, "user_id": 771848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2DTBv.jpg?s=128&g=1", "display_name": "alecxe", "link": "https://stackoverflow.com/users/771848/alecxe"}, "is_accepted": false, "score": 0, "last_activity_date": 1444250928, "last_edit_date": 1495541907, "creation_date": 1444250928, "answer_id": 33002169, "question_id": 33001927, "link": "https://stackoverflow.com/questions/33001927/how-do-i-access-this-element-in-c-using-selenium/33002169#33002169", "title": "How do I access this element in C# using Selenium?", "body": "<p>The element might not have appeared at the moment you've started looking for it. Wait for the element to <a href=\"https://stackoverflow.com/a/15142611/771848\">become present</a> in the DOM:</p>\n\n<pre><code>IWebElement element = new WebDriverWait(driver, TimeSpan.FromSeconds(timeOut)).Until(ExpectedConditions.ElementExists((By.Id(\"keyword\"))));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5416056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9f390dfc70375733890787ae7ec068?s=128&d=identicon&r=PG&f=1", "display_name": "JWJ", "link": "https://stackoverflow.com/users/5416056/jwj"}, "edited": false, "score": 0, "creation_date": 1444255123, "post_id": 33002252, "comment_id": 53831201, "body": "Tried this and got the same result; Unable to locate element: {&quot;method&quot;:&quot;xpath&quot;,&quot;selector&quot;:&quot;//input[@class=&#39;FORMshrt2&#39;]&quot;}"}], "tags": [], "owner": {"reputation": 433, "user_id": 5408955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/htM9B.jpg?s=128&g=1", "display_name": "Deepak_Mahalingam", "link": "https://stackoverflow.com/users/5408955/deepak-mahalingam"}, "is_accepted": false, "score": -1, "last_activity_date": 1444251292, "creation_date": 1444251292, "answer_id": 33002252, "question_id": 33001927, "link": "https://stackoverflow.com/questions/33001927/how-do-i-access-this-element-in-c-using-selenium/33002252#33002252", "title": "How do I access this element in C# using Selenium?", "body": "<p>Use wait statement then try the below code</p>\n\n<p>you can just try the following code, which may help for your case,</p>\n\n<pre><code>Thread.Sleep(5000);\n\ndriver.FindElement(By.XPath(\"//input[@class='FORMshrt2']\")).Click();\ndriver.FindElement(By.XPath(\"//input[@class='FORMshrt2']\")).SendKeys(\"your text\");\n</code></pre>\n\n<p>By using your class name i'm identifying the element, first clicking on it and then passing the string.</p>\n"}], "owner": {"reputation": 21, "user_id": 5416056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f9f390dfc70375733890787ae7ec068?s=128&d=identicon&r=PG&f=1", "display_name": "JWJ", "link": "https://stackoverflow.com/users/5416056/jwj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1145, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1444251292, "creation_date": 1444249899, "question_id": 33001927, "link": "https://stackoverflow.com/questions/33001927/how-do-i-access-this-element-in-c-using-selenium", "title": "How do I access this element in C# using Selenium?", "body": "<p>I am trying to find the following element and enter text into it. I have tried a number of different ways to access the element but always get the same error. My current line of code </p>\n\n<pre><code>searchTerm = driver.FindElement(By.Id(\"keyword\"));\n</code></pre>\n\n<p>generates the same error </p>\n\n<blockquote>\n  <p>Unable to locate element: {\"method\":\"id\",\"selector\":\"keyword\"}</p>\n</blockquote>\n\n<p>The element, shown below, clearly has the Id 'keyword'.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input maxlength=\"100\" size=\"20\" value=\"\" name=\"keyword\" id=\"keyword\" title=\"keyword\" class=\"FORMshrt2\"&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I used firebug to capture the complete XPath for this element.</p>\n\n<blockquote>\n  <p>/html/body/div/span/table[3]/tbody/tr/td/table[1]/tbody/tr[2]/td/div[1]/span/form/div[3]/table[3]/tbody/tr[2]/td/table/tbody/tr[1]/td/table/tbody/tr[11]/td[2]/span/input</p>\n</blockquote>\n\n<p>How do I access this element?</p>\n"}, {"tags": ["c#", "wpf", "citrix"], "comments": [{"owner": {"reputation": 8292, "user_id": 1178314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Riph7.jpg?s=128&g=1", "display_name": "Fr&#233;d&#233;ric", "link": "https://stackoverflow.com/users/1178314/fr%c3%a9d%c3%a9ric"}, "edited": false, "score": 0, "creation_date": 1444251385, "post_id": 33001915, "comment_id": 53829445, "body": "Maybe &#39;feature detection&#39; would be a better choice than &#39;environment detection&#39; for your case. But without knowing why you need those two modes, I can not guess. I mean, for example, <a href=\"http://stackoverflow.com/a/149802/1178314\">detect whether 3D acceleration is available or not</a>, if this is the lack of it which is the underlying reason for your need."}, {"owner": {"reputation": 11459, "user_id": 133476, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/100dc17fd21322a63b3b39716bba96ea?s=128&d=identicon&r=PG", "display_name": "peter", "link": "https://stackoverflow.com/users/133476/peter"}, "reply_to_user": {"reputation": 8292, "user_id": 1178314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Riph7.jpg?s=128&g=1", "display_name": "Fr&#233;d&#233;ric", "link": "https://stackoverflow.com/users/1178314/fr%c3%a9d%c3%a9ric"}, "edited": false, "score": 0, "creation_date": 1444255195, "post_id": 33001915, "comment_id": 53831231, "body": "It is much more simple than that. If it is running on the local machine the app needs to read some files from a specific place on the local machine. If it is running over citrix it needs to load the same files from a shared drive."}, {"owner": {"reputation": 8292, "user_id": 1178314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Riph7.jpg?s=128&g=1", "display_name": "Fr&#233;d&#233;ric", "link": "https://stackoverflow.com/users/1178314/fr%c3%a9d%c3%a9ric"}, "edited": false, "score": 0, "creation_date": 1444310788, "post_id": 33001915, "comment_id": 53857348, "body": "If the app on server is required to fetch the file remotely even if a session is locally opened on server for launching it (supposing it is possible with your servers), then the file path could be handled in a local config file / registry key."}], "answers": [{"tags": [], "owner": {"reputation": 1849, "user_id": 4258144, "user_type": "registered", "profile_image": "https://graph.facebook.com/601891163/picture?type=large", "display_name": "James Willock", "link": "https://stackoverflow.com/users/4258144/james-willock"}, "is_accepted": false, "score": -1, "last_activity_date": 1542195445, "last_edit_date": 1542195445, "creation_date": 1444296009, "answer_id": 33011581, "question_id": 33001915, "link": "https://stackoverflow.com/questions/33001915/how-to-determine-whether-c-app-running-under-citrix/33011581#33011581", "title": "How to Determine Whether C# App Running Under Citrix", "body": "<p>We use this:</p>\n\n<pre><code>var sessionName = (Environment.GetEnvironmentVariable(\"SessionName\") ?? \"\").ToUpper();\nreturn sessionName.StartsWith(\"ICA\") || sessionName.StartsWith(\"RDP\");\n</code></pre>\n\n<p>Where ICA infers Citrix, RDP remote desktop.</p>\n"}, {"tags": [], "owner": {"reputation": 11459, "user_id": 133476, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/100dc17fd21322a63b3b39716bba96ea?s=128&d=identicon&r=PG", "display_name": "peter", "link": "https://stackoverflow.com/users/133476/peter"}, "is_accepted": true, "score": 0, "last_activity_date": 1444339451, "creation_date": 1444339451, "answer_id": 33026185, "question_id": 33001915, "link": "https://stackoverflow.com/questions/33001915/how-to-determine-whether-c-app-running-under-citrix/33026185#33026185", "title": "How to Determine Whether C# App Running Under Citrix", "body": "<p>Sticking with the original method works, but instead of querying the WTSApplicationName I am querying the WTSClientProtocolType.</p>\n\n<p>So I call WTSQuerySessionInformation with 3rd parameter set to WTSClientProtocolType. And this returns,</p>\n\n<pre><code>0 for console sessions\n1 for ICA sessions\n2 for RDP sessions\n</code></pre>\n"}], "owner": {"reputation": 11459, "user_id": 133476, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/100dc17fd21322a63b3b39716bba96ea?s=128&d=identicon&r=PG", "display_name": "peter", "link": "https://stackoverflow.com/users/133476/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2756, "favorite_count": 1, "closed_date": 1444339514, "accepted_answer_id": 33026185, "answer_count": 2, "score": 0, "last_activity_date": 1542195445, "creation_date": 1444249854, "question_id": 33001915, "link": "https://stackoverflow.com/questions/33001915/how-to-determine-whether-c-app-running-under-citrix", "closed_reason": "Duplicate", "title": "How to Determine Whether C# App Running Under Citrix", "body": "<p>I have a C# WPF application that can run under 2 modes. The first is over Citrix, and the next is installed and running straight locally.</p>\n\n<p>This app is old, and we were using a call to the windows remote desktop API, WTSQuerySessionInformation to work out whether we were running over Citrix or not.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa383838(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa383838(v=vs.85).aspx</a></p>\n\n<p>The call was basically this,</p>\n\n<pre><code>hRet = WTSQuerySessionInformation(WF_CURRENT_SERVER_HANDLE, WF_CURRENT_SESSION,\n            WTS_INFO_CLASS.WTSApplicationName, ref ppBuffer, ref iBytesReturned);\n</code></pre>\n\n<p>So it was returning the application name on the current remote desktop session, and the assumption was that if there was no application name then it wasn't running under Citrix.</p>\n\n<p>This is no longer working since we upgrade the version of Citrix we are using. The call above returns an empty string.</p>\n\n<p>The questions are,</p>\n\n<ol>\n<li>Why is this call not working</li>\n<li>Is there a better way to work out whether a C# app is running over Citrix or not?</li>\n</ol>\n"}, {"tags": ["c#", "oracle", "datagridview"], "answers": [{"tags": [], "owner": {"reputation": 5208, "user_id": 351154, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/21b6b9da626b128a26f839b8f96579da?s=128&d=identicon&r=PG", "display_name": "user8128167", "link": "https://stackoverflow.com/users/351154/user8128167"}, "is_accepted": false, "score": 0, "last_activity_date": 1444250863, "creation_date": 1444250863, "answer_id": 33002140, "question_id": 33001885, "link": "https://stackoverflow.com/questions/33001885/dategridview-insert-into-another-oracle-table-c/33002140#33002140", "title": "DategridView insert into another oracle Table C#", "body": "<p>You would probably want to use:</p>\n\n<pre><code>    cmd.Parameters.Add(new OracleParameter(DbType.Date, datarow[\"DATE\"]))\n    cmd.Parameters.Add(new OracleParameter(DbType.Double, datarow[\"Number\"]));\n</code></pre>\n\n<p>Please see <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.dbtype(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.dbtype(v=vs.110).aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1444312895, "post_id": 33002909, "comment_id": 53858950, "body": "Can not apply indexing with [] to an expression of type &#39;System.Windows.Forms.DataGridViewRow.  Red line under datarow[&quot;Number&quot;]. It doesn&#39;t recognize, what can I do ?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1444313838, "post_id": 33002909, "comment_id": 53859763, "body": "Oh, I assumed datarow was a DataRow (System.Data.DataRow) based on your problem statement -- I didn&#39;t realize it was a grid row.  I think this is how you would normally get the value from a grid row: <code>datarow.Cells[&quot;Number&quot;].Value</code>.  If that works, let me know, and I can update the answer."}, {"owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1444313940, "post_id": 33002909, "comment_id": 53859852, "body": "Yeah I figured it out before I got your answer lol. Another problem I have is infinite loop. I thought it will stop after reading the last row of the datagrid but it kept running infinitely. Do you know why? Thanks a lot for your help!"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "edited": false, "score": 0, "creation_date": 1444314104, "post_id": 33002909, "comment_id": 53859991, "body": "I can&#39;t see anything in your code snippet that would cause that...  my only thought is that you have an event that is triggering <code>loopGrid()</code> that may be firing it based on something happening inside <code>loopGrid</code>.  Can you post more code?  Also, apologies -- you had the corrent datatype in your example.  I was not paying attention."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 1, "last_activity_date": 1444315281, "last_edit_date": 1444315281, "creation_date": 1444254183, "answer_id": 33002909, "question_id": 33001885, "link": "https://stackoverflow.com/questions/33001885/dategridview-insert-into-another-oracle-table-c/33002909#33002909", "title": "DategridView insert into another oracle Table C#", "body": "<p>Depending on the Oracle driver you are using, there may be an overload for the <code>.Add</code> method that accepts the value as the second parameter, or there may be an <code>.AddWithValue</code> method that does it explicitly.  I <em>think</em> for ODP.net you have it right as just <code>.Add</code>.</p>\n\n<p>Either way, these will derive the datatype from the datatype of the value.</p>\n\n<p>Regarding your parameters, you need to omit the colon <code>:</code> character when invoking the parameters.  I know in SQL Server, Sybase, SQLite and others you include them (a <code>@</code> in those cases), but in Oracle you leave them out during the parameter declaration.  Interestingly, I think PostgreSQL accepts either methodology.</p>\n\n<p>As such, I think this will work:</p>\n\n<pre><code>private void writeRecord(DataGridViewRow datarow)\n{\n\n    string sqlqry = \"insert into Table (Date,Number) values(:Date,:Number)\";\n\n    OracleCommand cmd = new OracleCommand(sqlqry, conn);\n    cmd.Parameters.Add(new OracleParameter(\"Date\", datarow[\"DATE\"]))\n    cmd.Parameters.Add(new OracleParameter(\"Number\", datarow[\"Number\"]));\n    // cmd.CommandText = sqlqry;  -- not necessary, handled in constructor\n    cmd.ExecuteNonQuery();\n}\n</code></pre>\n\n<p>If not, maybe try explicit conversions with either the type or value:</p>\n\n<p>Yuck:</p>\n\n<pre><code>cmd.Parameters.Add(new OracleParameter(\"Date\", Convert.ToDateTime(datarow[\"DATE\"])))\ncmd.Parameters.Add(new OracleParameter(\"Number\", Convert.ToDecimal(datarow[\"Number\"])));\n</code></pre>\n\n<p>Better:</p>\n\n<pre><code>cmd.Parameters.Add(new OracleParameter(\"DATE\", OracleDbType.Date,\n    datarow[\"DATE\"], ParameterDirection.Input);\ncmd.Parameters.Add(new OracleParameter(\"Number\", OracleDbType.Decimal,\n    datarow[\"Number\"], ParameterDirection.Input));\n</code></pre>\n\n<p>And if worse comes to worse, the bulletproof (although verbose) way to do it would be:</p>\n\n<pre><code>cmd.Parameters.Add(new OracleParameter(\"DATE\", OracleDbType.Date));\ncmd.Parameters.Add(new OracleParameter(\"Number\", OracleDbType.Decimal));\ncmd.Parameters[0].Value = datarow[\"DATE\"];\ncmd.Parameters[1].Value = datarow[\"Number\"];\n</code></pre>\n\n<p>As a footnote, this last way is actually preferred if you have multiple rows to insert, as you create the parameters once and modify the values and execute the insert multiple times:</p>\n\n<pre><code>cmd.Parameters.Add(new OracleParameter(\"DATE\", OracleDbType.Date));\ncmd.Parameters.Add(new OracleParameter(\"Number\", OracleDbType.Decimal));\n\nforeach (DataRow datarow in datarows)\n{\n    cmd.Parameters[0].Value = datarow[\"DATE\"];\n    cmd.Parameters[1].Value = datarow[\"Number\"];\n\n    cmd.ExecuteNonQuery();\n}\n</code></pre>\n\n<p>-- EDIT --</p>\n\n<p>Based on your feedback and my improved proofreading skills, this is what I'd recommend.  I added a transaction in there for good measure:</p>\n\n<pre><code>string sqlqry = \"insert into Table  (Date,Number) values(:Date,:Number)\";\n\nOracleTransaction trans = conn.BeginTransaction(IsolationLevel.ReadCommitted);\nOracleCommand cmd = new OracleCommand(sqlqry, conn, trans);\ncmd.Parameters.Add(new OracleParameter(\"DATE\", OracleDbType.Date));\ncmd.Parameters.Add(new OracleParameter(\"Number\", OracleDbType.Decimal));\n\nforeach (DataGridViewRow datarow in this.dataGridView1.Rows)\n{\n    cmd.Parameters[0].Value = datarow.Cells[\"DATE\"].Value;\n    cmd.Parameters[1].Value = datarow.Cells[\"Number\"].Value;\n\n    cmd.ExecuteNonQuery();\n}\n\ntrans.Commit();\n</code></pre>\n\n<p>For what it's worth, you also need some exception handling.</p>\n"}], "owner": {"reputation": 289, "user_id": 4450310, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/yTMzo.gif?s=128&g=1", "display_name": "Sailormoon", "link": "https://stackoverflow.com/users/4450310/sailormoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 33002909, "answer_count": 2, "score": 1, "last_activity_date": 1444315281, "creation_date": 1444249739, "last_edit_date": 1444258602, "question_id": 33001885, "link": "https://stackoverflow.com/questions/33001885/dategridview-insert-into-another-oracle-table-c", "title": "DategridView insert into another oracle Table C#", "body": "<p>I have a Datagridview of 46 columns consists of Date, Int and String Type. I want to insert the values to another oracle table.         </p>\n\n<pre><code>private void loopGrid()\n    {\n        foreach (DataGridViewRow datarow in this.dataGridView1.Rows)\n        {\n            writeRecord(datarow);\n        }\n    }\n\n    private void writeRecord(DataGridViewRow datarow)\n    {\n\n        string sqlqry = \"insert into Table  (Date,Number) values(:Date,:Number)\";\n\n        OracleCommand cmd = new OracleCommand(sqlqry, conn);\n        cmd.Parameters.Add(new OracleParameter(\":Date\", datarow[\"DATE\"]))\n        cmd.Parameters.Add(new OracleParameter(\":Number\", datarow[\"Number\"]));\n        cmd.CommandText = sqlqry;\n        cmd.ExecuteNonQuery();\n    }\n</code></pre>\n\n<p>I don't quite understand what I did wrong about passing the parameters. I'm pretty new to C#, what's the right way to pass the Datatype and value to the other oracle table? </p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 129, "user_id": 5152870, "user_type": "registered", "profile_image": "https://graph.facebook.com/911424418923526/picture?type=large", "display_name": "Geoffrey Fernandez", "link": "https://stackoverflow.com/users/5152870/geoffrey-fernandez"}, "edited": false, "score": 1, "creation_date": 1444249783, "post_id": 33001855, "comment_id": 53828591, "body": "Have you looked into regex expressions? You could specify all files of type PNG with something like this:    Directory.GetFiles(@&quot;C:\\temp\\&quot;, &quot;*.png&quot;);"}, {"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 0, "creation_date": 1444250403, "post_id": 33001855, "comment_id": 53828924, "body": "I think it&#39;s unclear how your image names are formatted. If you&#39;re just checking a string to contain another string, won&#39;t you get issues with coincidental names, like <code>HoldingSomeMapleSyrupInFrontOfThisTree</code>? You might want a true parser rather than contains checks. For example: match the first word (<code>Tree</code>) then move on to the next set of words <code>MapleWinter</code>: match the first word (<code>Maple</code>)..."}, {"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 0, "creation_date": 1444250824, "post_id": 33001855, "comment_id": 53829131, "body": "Also, if you make it clear what <code>&#47;&#47; assign image &quot;x&quot;</code> is, then maybe we could find a generalized solution for the assigning that allows for an approach that doesn&#39;t depend on your hierarchy (and therefore doesn&#39;t have to be updated with your hierarchy)."}], "answers": [{"comments": [{"owner": {"reputation": 256, "user_id": 4539631, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c1918caf1e5561bdc218f632e5e99b40?s=128&d=identicon&r=PG&f=1", "display_name": "Noah Roth", "link": "https://stackoverflow.com/users/4539631/noah-roth"}, "edited": false, "score": 0, "creation_date": 1444250589, "post_id": 33001963, "comment_id": 53829014, "body": "Thanks, I really like the first solution you have proposed. However, I&#39;d still like to &quot;break free&quot; from using hardcoded literal strings (in your switch-case clause), so perhaps I could loop through a List of ImageNames instead to find a match? Your second solution fixes this though, maybe I&#39;ll just implement that."}, {"owner": {"reputation": 6414, "user_id": 4979159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22618a43082c5a2336cc1db5e93c15f1?s=128&d=identicon&r=PG&f=1", "display_name": "maksymiuk", "link": "https://stackoverflow.com/users/4979159/maksymiuk"}, "reply_to_user": {"reputation": 256, "user_id": 4539631, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c1918caf1e5561bdc218f632e5e99b40?s=128&d=identicon&r=PG&f=1", "display_name": "Noah Roth", "link": "https://stackoverflow.com/users/4539631/noah-roth"}, "edited": false, "score": 0, "creation_date": 1444250661, "post_id": 33001963, "comment_id": 53829050, "body": "yes exactly! also thats why i proposed maybe a dictionary of <code>imageNames</code> as keys and delegates for handling!"}, {"owner": {"reputation": 256, "user_id": 4539631, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c1918caf1e5561bdc218f632e5e99b40?s=128&d=identicon&r=PG&f=1", "display_name": "Noah Roth", "link": "https://stackoverflow.com/users/4539631/noah-roth"}, "edited": false, "score": 0, "creation_date": 1444261975, "post_id": 33001963, "comment_id": 53833393, "body": "Implemented your second proposal, it works great! Although I did need to change one line - <code>match.Value</code> needs to be replaced with <code>match.Groups[1].Value</code>, as the former returns the original string in it&#39;s entirety (in this case, the file path)."}], "tags": [], "owner": {"reputation": 6414, "user_id": 4979159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22618a43082c5a2336cc1db5e93c15f1?s=128&d=identicon&r=PG&f=1", "display_name": "maksymiuk", "link": "https://stackoverflow.com/users/4979159/maksymiuk"}, "is_accepted": true, "score": 2, "last_activity_date": 1444251322, "last_edit_date": 1444251322, "creation_date": 1444250034, "answer_id": 33001963, "question_id": 33001855, "link": "https://stackoverflow.com/questions/33001855/good-way-to-search-a-directory-for-files-that-follow-a-specific-naming-conventio/33001963#33001963", "title": "Good way to search a directory for files that follow a specific naming convention?", "body": "<p>Something along the lines of this may be easier:</p>\n\n<pre><code>string pattern = @\"[^_]+_([^_]+)\\.png\";  // Regex pattern to capture *ImageName*\nRegex regex = new Regex(pattern);\nMatch match = regex.Match(currFile);\nif (match.Success)                       // If image abides by the format\n{\n    switch (match.Value) {               // Switch on the *ImageName*\n        case \"Tree\":\n            // Logic\n            break;\n        case \"Bush\":\n            // Logic\n            break;\n        case \"Maple\":\n            // Logic\n            break;\n    }\n}\n</code></pre>\n\n<p>or using delegates:</p>\n\n<pre><code>Dictionary&lt;string, Action&gt; imageActions = new Dictionary&lt;string, Action&gt;();\nif (match.Success &amp;&amp; imageActions.ContainsKey(match.Value))   // If image abides by the format and a delegate exists for handling that image name\n    imageActions[match.Value]();\n\n// usage\nimageActions.Add(\"Tree\", () =&gt; { /* Logic */ });\n</code></pre>\n"}], "owner": {"reputation": 256, "user_id": 4539631, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c1918caf1e5561bdc218f632e5e99b40?s=128&d=identicon&r=PG&f=1", "display_name": "Noah Roth", "link": "https://stackoverflow.com/users/4539631/noah-roth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 33001963, "answer_count": 1, "score": 0, "last_activity_date": 1444251322, "creation_date": 1444249627, "question_id": 33001855, "link": "https://stackoverflow.com/questions/33001855/good-way-to-search-a-directory-for-files-that-follow-a-specific-naming-conventio", "title": "Good way to search a directory for files that follow a specific naming convention?", "body": "<p>My application allows clients to specify 80 images manually that will be utilized later on. However, I also offer functionality to automatically find and load these image files, as long as they follow a specific naming convention.</p>\n\n<p>For example, the naming convention for these files is as follows:</p>\n\n<p><code>*ClientName*_*ImageName*.png</code></p>\n\n<p>Only PNG files are allowed, and <code>ImageName</code> is application-defined set of names. <code>ClientName</code> is ignored as it is defined client-side.</p>\n\n<p>I am in the process of adding more images, and realize that my current way of handling this is not feasible.</p>\n\n<p>Currently I get all files in a specified directory that have the PNG extension.</p>\n\n<p>Then, my code is as follows (an example):</p>\n\n<pre><code>if (StringContains(currFile, \"Tree\"))\n{\n    // assign image \"Tree\"\n}\nelse if (StringContains(currFile, \"Bush\"))\n{\n    // assign image \"Bush\"\n}\n\n...etc\n</code></pre>\n\n<p>My <code>StringContains</code> function simply does a <code>String.IndexOf(currFile, StringComparison.CurrentCultureIgnoreCase)</code> and returns true if the result is <code>&gt;= 0</code>.</p>\n\n<p>The first problem with this approach is the endless if/else if statements. It is not manageable.</p>\n\n<p>The second issue is if I have an image that is called <code>TreeMaple</code>. I <em>now</em> need to change my if statement for finding the \"Tree\" image to this:</p>\n\n<pre><code>if (StringContains(currFile, \"Tree\") &amp;&amp; !StringContains(currFile, \"Maple\"))\n</code></pre>\n\n<p>And you can imagine how crazy this gets when you add more image names like \"TreeMapleFall\", \"TreeMapleWinter\", \"TreeMapleWinterSnow\", etc., which is what I plan on doing.</p>\n\n<p>How can I make this code more simple, maintainable and easier to read? </p>\n"}, {"tags": ["c#", "xml"], "comments": [{"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1444256459, "post_id": 33001712, "comment_id": 53831747, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/421257/how-do-i-use-a-c-sharp-keyword-as-a-property-on-an-anonymous-object\">How do I use a C# keyword as a property on an anonymous object?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2931, "user_id": 3242103, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zmsJQ.jpg?s=128&g=1", "display_name": "snow_FFFFFF", "link": "https://stackoverflow.com/users/3242103/snow-ffffff"}, "is_accepted": true, "score": 2, "last_activity_date": 1444249418, "creation_date": 1444249418, "answer_id": 33001787, "question_id": 33001712, "link": "https://stackoverflow.com/questions/33001712/identifier-on-xmlattribute/33001787#33001787", "title": "Identifier on XmlAttribute", "body": "<p>You can provide a name in the attribute:</p>\n\n<pre><code>[XmlAttribute(\"ref\")]\npublic string anynameyouwant;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 930677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd12716d5643ac73e2b38c957d03d2d?s=128&d=identicon&r=PG", "display_name": "ziaziosk", "link": "https://stackoverflow.com/users/930677/ziaziosk"}, "is_accepted": false, "score": 0, "last_activity_date": 1444250218, "creation_date": 1444250218, "answer_id": 33002002, "question_id": 33001712, "link": "https://stackoverflow.com/questions/33001712/identifier-on-xmlattribute/33002002#33002002", "title": "Identifier on XmlAttribute", "body": "<p>You can change the attribute name in the xml file, by using the AttributeName, such as in the following example:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Xml.Serialization;\n\nnamespace soans\n{\n\n    public class Test\n    {\n\n        //problematic attribute (ref is reserved)\n         [XmlAttribute(AttributeName=\"ref\")]\n         public string RefAttr {get;set;}\n\n\n         //other attributes as well\n         [XmlAttribute()]\n         public string Field { get; set; }\n    }\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string filename = \"\"; //use your path here\n\n            Test original = new Test()\n            {\n                RefAttr = \"ref\",\n                Field = \"test\"\n            };\n            //serialiser\n            XmlSerializer ser = new XmlSerializer(typeof(Test));\n\n            //save to file\n            TextWriter writer = new StreamWriter(filename);\n            ser.Serialize(writer, original);\n            writer.Close();\n\n            //read from file\n            TextReader reader = new StreamReader(filename);\n            var fromfile = ser.Deserialize(reader) as Test;\n            if(fromfile!=null)\n            {\n                Console.WriteLine(fromfile.RefAttr);\n\n            }\n            reader.Close();\n            Console.ReadKey();\n\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 1546412, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a76aaf67e82736c0472dbc3757f7902e?s=128&d=identicon&r=PG", "display_name": "AmericanSuave", "link": "https://stackoverflow.com/users/1546412/americansuave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 33001787, "answer_count": 2, "score": 0, "last_activity_date": 1444250483, "creation_date": 1444249121, "last_edit_date": 1444250483, "question_id": 33001712, "link": "https://stackoverflow.com/questions/33001712/identifier-on-xmlattribute", "title": "Identifier on XmlAttribute", "body": "<p>I have an XML document I'm trying to deseralize that has a attribute that is ref which in C# can not be used to declare a variable hence the below doesn't work</p>\n\n<pre><code> [XmlAttribute()]\n public string ref;\n</code></pre>\n\n<p>Anyway to get this to deseralize properly? I know it is case sensitive so Ref wouldn't work.</p>\n"}, {"tags": ["c#", "sql-server", "entity-framework", "fluent"], "answers": [{"tags": [], "owner": {"reputation": 875, "user_id": 5291509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29914eefac6c45cb09c2201416df0071?s=128&d=identicon&r=PG&f=1", "display_name": "Ppp", "link": "https://stackoverflow.com/users/5291509/ppp"}, "is_accepted": false, "score": 1, "last_activity_date": 1444272132, "creation_date": 1444272132, "answer_id": 33005707, "question_id": 33001681, "link": "https://stackoverflow.com/questions/33001681/entity-framework-foreign-keys-with-zero-values/33005707#33005707", "title": "Entity Framework Foreign Keys with Zero Values", "body": "<blockquote>\n  <p>So EF knows, if column is Not Null and I Say the Reference is Optional\n  in Fluent it write a Zero in the Not Null Column.</p>\n</blockquote>\n\n<p>I would write it as this when inserting</p>\n\n<pre><code>myTable.destFK_Field = sourceFK_Field ?? 0\n</code></pre>\n\n<p>The SQL equivalent:</p>\n\n<pre><code>myTable.destFK_Field = COALESCE(sourceFK_Field,0)\n</code></pre>\n\n<p>Assuming that you are generating the models from EDMX, I think there is not much option that you can add to the models. </p>\n"}], "owner": {"reputation": 11, "user_id": 5420232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a3a455788e837c83bebbcf155edcd1?s=128&d=identicon&r=PG&f=1", "display_name": "Xoroles", "link": "https://stackoverflow.com/users/5420232/xoroles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444272132, "creation_date": 1444249020, "question_id": 33001681, "link": "https://stackoverflow.com/questions/33001681/entity-framework-foreign-keys-with-zero-values", "title": "Entity Framework Foreign Keys with Zero Values", "body": "<p>I have the following Problem, i must connect a Exiting Database with a very Ugly and not Normalized Design. \nSo I have many ForeignKeys with Not Null but a Foreign Key with Value 0 (Zero) so it was a Null Reference. </p>\n\n<p>But in Some Tables i have also Nullable FKs but also Zero Values. </p>\n\n<p>Can I Customize Entity Framework with Some Convention or something else. So EF knows, if column is Not Null and I Say the Reference is Optional in Fluent it write a Zero in the Not Null Column.</p>\n\n<p>The Only other Solution is to write Views for Read Access, and Sps for Write Access to make a Valid Abstraction on the Databasse. But with more then 500 Tables it was some many Work.</p>\n\n<p>So has somebody a Idea for some better Solution. </p>\n\n<p>A Additional Notice, the database is in Refactoring, so in one or two years it is Normalized, and has not an so Ugly design.</p>\n\n<p>The database System ist MsSql</p>\n\n<p>Sorry for my bad English.</p>\n"}, {"tags": ["c#", "asp.net-web-api", "odata"], "comments": [{"owner": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 0, "creation_date": 1444250455, "post_id": 33001583, "comment_id": 53828951, "body": "Correct me if I am wrong but startswith would have the same issue as you are returning the first 3 records. A seems to be the 4th from what you have posted."}, {"owner": {"reputation": 6302, "user_id": 2979430, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/CXpGy.jpg?s=128&g=1", "display_name": "bto.rdz", "link": "https://stackoverflow.com/users/2979430/bto-rdz"}, "reply_to_user": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 0, "creation_date": 1444250901, "post_id": 33001583, "comment_id": 53829168, "body": "@SurgeonofDeath True I missed that"}, {"owner": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 0, "creation_date": 1444251163, "post_id": 33001583, "comment_id": 53829322, "body": "since you are returning top 3, cant you just increment the top values, or actually order it by. If you order it by, the value A would be the first."}, {"owner": {"reputation": 6302, "user_id": 2979430, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/CXpGy.jpg?s=128&g=1", "display_name": "bto.rdz", "link": "https://stackoverflow.com/users/2979430/bto-rdz"}, "reply_to_user": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 0, "creation_date": 1444251251, "post_id": 33001583, "comment_id": 53829363, "body": "It would work if I order by name Length, do you know how I do that?"}, {"owner": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 0, "creation_date": 1444252425, "post_id": 33001583, "comment_id": 53829924, "body": "<a href=\"http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/supporting-odata-query-options\" rel=\"nofollow noreferrer\">asp.net/web-api/overview/odata-support-in-aspnet-web-api/&hellip;</a>  - (<a href=\"http://localhost/Products?$orderby=Name\" rel=\"nofollow noreferrer\">localhost/Products?$orderby=Name</a>)"}, {"owner": {"reputation": 6302, "user_id": 2979430, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/CXpGy.jpg?s=128&g=1", "display_name": "bto.rdz", "link": "https://stackoverflow.com/users/2979430/bto-rdz"}, "reply_to_user": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 0, "creation_date": 1444252658, "post_id": 33001583, "comment_id": 53830047, "body": "@SurgeonofDeath that will create a new problem, now I wont see the result if it is not alphabetically in the firts 3 positions. this would work If I could <code>&#47;Products?$orderby=length(Name)</code> but that is not supported, but I guess is the best I can do. thanks for your help"}, {"owner": {"reputation": 1065, "user_id": 2981403, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/0lENO.png?s=128&g=1", "display_name": "Hozikimaru", "link": "https://stackoverflow.com/users/2981403/hozikimaru"}, "edited": false, "score": 1, "creation_date": 1444252963, "post_id": 33001583, "comment_id": 53830205, "body": "Iqueryable has OrderBy option. Why dont you just return it inside your code? OrderBy(x=&gt;x.SomeProperty.length)"}], "owner": {"reputation": 6302, "user_id": 2979430, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/CXpGy.jpg?s=128&g=1", "display_name": "bto.rdz", "link": "https://stackoverflow.com/users/2979430/bto-rdz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 543, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1444251003, "creation_date": 1444248679, "last_edit_date": 1444251003, "question_id": 33001583, "link": "https://stackoverflow.com/questions/33001583/web-api-query-options-custom-filter", "title": "Web API query options custom filter", "body": "<p>I am trying to support <code>IQueryable</code> controllers but there is this problem I cant find a way to fix. suppouse I need to filter the next list of words </p>\n\n<ul>\n<li>Apple</li>\n<li>Arizona</li>\n<li>Automobile</li>\n<li>A</li>\n</ul>\n\n<p>Now my clients have an autocomplete textbox that shows possible options. It makes a query similar to this</p>\n\n<pre><code>\"api/RandomWods?$filter=substringof('\" + input + \"',Name)&amp;$top=3\"\n</code></pre>\n\n<p>When input is <code>A</code> I am not able to get <code>A</code> record as an option, because there are already 3 records that contains <code>A</code>.</p>\n\n<p><strong>Is there a better query to support this?</strong></p>\n\n<p><strong>Can I build a custom filter function?</strong></p>\n\n<p>something like</p>\n\n<pre><code>\"api/Currencies?$filter=bestmatches('\" + input + \"'),Name)&amp;$top=3\n</code></pre>\n\n<p>then define bestmatches as a server side method.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "razor"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1444253714, "post_id": 33001560, "comment_id": 53830536, "body": "The <code>DefaultModelBinder</code> will initialize all parameters in your method to their default value if no values are provided for them."}], "answers": [{"tags": [], "owner": {"reputation": 1757, "user_id": 3485021, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/274b48a5fd5cb8a453dfb97df7209cc9?s=128&d=identicon&r=PG&f=1", "display_name": "JB06", "link": "https://stackoverflow.com/users/3485021/jb06"}, "is_accepted": false, "score": 0, "last_activity_date": 1444250405, "creation_date": 1444250405, "answer_id": 33002042, "question_id": 33001560, "link": "https://stackoverflow.com/questions/33001560/submit-the-form-return-the-initialization-of-the-object-instead-of-null-mvc-c/33002042#33002042", "title": "Submit the form return the initialization of the object instead of null mvc C#", "body": "<p>I believe the model binder initializes objects to check their ModelState, although I could be mistaken.</p>\n\n<p>A quick fix you could do is add a hidden field in the if block and check it in your action.</p>\n\n<pre><code>@if (Model.StepNumber == (int)Booking_Steps.BookingDetails)\n{\n  &lt;input type=\"hidden\" name=\"partialRenderedFlag\" value=\"true\" /&gt;\n  @Html.Partial(\"_Booking_Details\", Model.BookingDetails)\n}\n</code></pre>\n\n<p>Controller action:</p>\n\n<pre><code>public async Task&lt;ActionResult&gt; Create(BookingViewModel bookingview, BookingDetailsViewModel bookingdetails, bool partialRenderedFlag = false)\n{\n  if (partialRenderedFlag)\n    // you know you rendered partial\n}\n</code></pre>\n"}], "owner": {"reputation": 14646, "user_id": 375166, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/86b0f2b670654a51223e694bc768a180?s=128&d=identicon&r=PG", "display_name": "kartal", "link": "https://stackoverflow.com/users/375166/kartal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444250405, "creation_date": 1444248602, "question_id": 33001560, "link": "https://stackoverflow.com/questions/33001560/submit-the-form-return-the-initialization-of-the-object-instead-of-null-mvc-c", "title": "Submit the form return the initialization of the object instead of null mvc C#", "body": "<pre><code>[HttpPost]    \npublic async Task&lt;ActionResult&gt; Create(BookingViewModel bookingview, BookingDetailsViewModel bookingdetails)\n</code></pre>\n\n<p>I am having a problem that when I submit the form I am expecting that the <code>bookingdetails</code> is null if I didn't show its <code>PartialView</code> related to it</p>\n\n<pre><code>@if (Model.StepNumber == (int)Booking_Steps.BookingDetails)\n {\n   @Html.Partial(\"_Booking_Details\", Model.BookingDetails)\n }\n</code></pre>\n\n<p>but instead it initialize the object. How to make it return null? because that's make the <code>ModelState</code> not valid.</p>\n"}, {"tags": ["c#", "unity3d", "collision-detection", "game-physics"], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 5371864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/huXfC.jpg?s=128&g=1", "display_name": "R&#250;ben Rocha", "link": "https://stackoverflow.com/users/5371864/r%c3%baben-rocha"}, "is_accepted": false, "score": 0, "last_activity_date": 1444260598, "creation_date": 1444260598, "answer_id": 33004139, "question_id": 33001533, "link": "https://stackoverflow.com/questions/33001533/collisiondetection-of-manual-scaling-object-2d-in-unity-5/33004139#33004139", "title": "CollisionDetection of manual scaling Object (2D) in Unity 5", "body": "<p>As far as i know, with kinematic objects you can only have trigger events which only return colliders and not collision information. </p>\n\n<p>I think you may try to check the collision with triggers and then do a circle sweep test in 8 direction for example to search for a collision and receive the information with the raycasthit2D. The sweep test will return you a raycasthit2D wich have a \"point\" member you can use.</p>\n\n<p>Follow this links - </p>\n\n<p>Unity Manual\n<a href=\"http://docs.unity3d.com/ScriptReference/Physics2D.CircleCast.html\" rel=\"nofollow\">http://docs.unity3d.com/ScriptReference/Physics2D.CircleCast.html</a></p>\n\n<p>How Capsule and Sphere Cast work (same thing as circle cast but in 3D)\n<a href=\"https://www.youtube.com/watch?v=D1xqen8uH64\" rel=\"nofollow\">https://www.youtube.com/watch?v=D1xqen8uH64</a></p>\n\n<p>Hope I could explain myself well enough. Good luck</p>\n"}], "owner": {"reputation": 33, "user_id": 5420187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b92a41d4f0fedd7fce2caa022138d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "Keoush", "link": "https://stackoverflow.com/users/5420187/keoush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444260598, "creation_date": 1444248528, "last_edit_date": 1592644375, "question_id": 33001533, "link": "https://stackoverflow.com/questions/33001533/collisiondetection-of-manual-scaling-object-2d-in-unity-5", "title": "CollisionDetection of manual scaling Object (2D) in Unity 5", "body": "<h3>Overview of Game:</h3>\n<p>The main character of the game is a gum which throws a piece of itself which is called anchor in any direction or at any angle.</p>\n<p>There is a thread like connection, which is called connection-thread Object, between the gum and its anchors whose elastic structure is implemented using SpringJoin2D which gives the connection-thread a spring-like behavior.</p>\n<p>In order to make the connection-thread more dynamic, a mechanism is added to the game which lets the connection-thread to get segmented by adding a new anchor in the part of the connection-thread that collides with an object in the game environment. In other words whenever an object hits the connection-thread a static anchor is added in the collision point.</p>\n<h3>The main problem:</h3>\n<p>The connection-thread Object is scaled and positioned manually in the script, which causes dysfunction in the collision detection system(Box2D) in a way that the collision points cannot be detected correctly.</p>\n<h3>Used Methods :</h3>\n<p><code>boxCollider</code> / <code>EdgeCollider</code> -&gt; dysfunctioned when scaling</p>\n<p><code>RayCast2D</code> / <code>LineCast2D</code> -&gt; middle anchors enter the environment Object in high speed</p>\n<p>static <code>boxcollider2D</code> in child object in size of maximum length of connection-thread Object -&gt; [not implemented yet]</p>\n<p>Any idea to fix this ?</p>\n<p><a href=\"https://i.stack.imgur.com/ug2iy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ug2iy.png\" alt=\"segmenting connection-thread (normal state)\" /></a></p>\n"}, {"tags": ["javascript", "c#", "asp.net", "visual-studio-2010", "asp.net-4.0"], "answers": [{"comments": [{"owner": {"reputation": 2791, "user_id": 4191466, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e8319491a3bf6019ad5ebaf8163be55?s=128&d=identicon&r=PG&f=1", "display_name": "fdkgfosfskjdlsjdlkfsf", "link": "https://stackoverflow.com/users/4191466/fdkgfosfskjdlsjdlkfsf"}, "edited": false, "score": 0, "creation_date": 1444249900, "post_id": 33001654, "comment_id": 53828659, "body": "In my case it works well since <code>Value</code> and <code>Text</code> are the same. But what would I use if I wanted to retrieve the <code>Text</code> instead of <code>Value</code>? Thanks."}, {"owner": {"reputation": 1363, "user_id": 4129738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JltNh.png?s=128&g=1", "display_name": "HashPsi", "link": "https://stackoverflow.com/users/4129738/hashpsi"}, "reply_to_user": {"reputation": 2791, "user_id": 4191466, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e8319491a3bf6019ad5ebaf8163be55?s=128&d=identicon&r=PG&f=1", "display_name": "fdkgfosfskjdlsjdlkfsf", "link": "https://stackoverflow.com/users/4191466/fdkgfosfskjdlsjdlkfsf"}, "edited": false, "score": 0, "creation_date": 1444250972, "post_id": 33001654, "comment_id": 53829215, "body": "The <code>Text</code> is not posted back to the server. If you need the text, you can either: (1) rebuild the items on the server to match the change made on the client or (2) use hidden fields to store the text from the javascript and get the value for these hidden fields on the server."}], "tags": [], "owner": {"reputation": 1363, "user_id": 4129738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JltNh.png?s=128&g=1", "display_name": "HashPsi", "link": "https://stackoverflow.com/users/4129738/hashpsi"}, "is_accepted": true, "score": 0, "last_activity_date": 1444248942, "creation_date": 1444248942, "answer_id": 33001654, "question_id": 33001506, "link": "https://stackoverflow.com/questions/33001506/page-enableeventvalidation-false-does-not-recognize-new-dropdownlist-values/33001654#33001654", "title": "Page.EnableEventValidation = false does not recognize new dropdownlist values", "body": "<p>You cannot get the value in the standard way as the server is not aware that the items have been changed for the drop down.</p>\n\n<p>However, you can get the value directly from the request:</p>\n\n<pre><code>protected void ButtonServer_Click(object sender, EventArgs e)\n{\n    string val = Request[this.DropDownListTest.UniqueID];\n}\n</code></pre>\n"}], "owner": {"reputation": 2791, "user_id": 4191466, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e8319491a3bf6019ad5ebaf8163be55?s=128&d=identicon&r=PG&f=1", "display_name": "fdkgfosfskjdlsjdlkfsf", "link": "https://stackoverflow.com/users/4191466/fdkgfosfskjdlsjdlkfsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 33001654, "answer_count": 1, "score": 1, "last_activity_date": 1444258588, "creation_date": 1444248394, "last_edit_date": 1444258588, "question_id": 33001506, "link": "https://stackoverflow.com/questions/33001506/page-enableeventvalidation-false-does-not-recognize-new-dropdownlist-values", "title": "Page.EnableEventValidation = false does not recognize new dropdownlist values", "body": "<p>My test webform has 1 <code>dropdownlist</code> and 2 <code>buttons</code>. This is it:</p>\n\n<pre><code>&lt;form id=\"form1\" runat=\"server\"&gt;\n    &lt;asp:DropDownList ID=\"DropDownListTest\" runat=\"server\" &gt;\n        &lt;asp:ListItem&gt;Value 0&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem&gt;Value 1&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem&gt;Value 2&lt;/asp:ListItem&gt;\n    &lt;/asp:DropDownList&gt;\n\n&lt;asp:Button ID=\"ButtonClient\" runat=\"server\" Text=\"Button\" OnClientClick=\"ChangeDropDown(); return false;\" /&gt;\n\n&lt;asp:Button ID=\"ButtonServer\" runat=\"server\" Text=\"Server\" onclick=\"ButtonServer_Click\" /&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>This is the <code>javascript</code> function <code>ChangeDropDown()</code>:</p>\n\n<pre><code>function ChangeDropDown() {\n        for (i = document.getElementById(\"&lt;%=DropDownListTest.ClientID%&gt;\").options.length - 1; i &gt;= 0; i--) {\n            document.getElementById(\"&lt;%=DropDownListTest.ClientID%&gt;\").remove(i);\n        }\n        var opt = document.createElement(\"option\");\n\n        opt.text = \"Complete\";\n        opt.value = \"Complete\";\n        document.getElementById(\"&lt;%=DropDownListTest.ClientID%&gt;\").options.add(opt);\n\n\n        var opt2 = document.createElement(\"option\");\n        opt2.text = \"Not Complete\";\n        opt2.value = \"Not Complete\";\n        document.getElementById(\"&lt;%=DropDownListTest.ClientID%&gt;\").options.add(opt2);\n} \n</code></pre>\n\n<p>And this is the codebehind:</p>\n\n<pre><code>    protected void ButtonServer_Click(object sender, EventArgs e)\n    {\n        string val = this.DropDownListTest.SelectedValue;\n    }\n    protected void Page_PreInit(object sender, EventArgs e)\n    {\n        Page.EnableEventValidation = false;\n        //\"Invalid postback or callback argument\" if I remove this.\n    }\n</code></pre>\n\n<p>Let's say that I click on <code>button ButtonClient</code> (which changes the values of dropdown), select \"Complete\" and then click on <code>ButtonServer</code>. In codebehind, the value of <code>this.DropDownListTest.SelectedValue</code> equals \"Value 0\" instead of \"Complete\".</p>\n\n<p>I understand why I'm getting the problem, but is there another solution besides adding the items codebehind?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "ssl", "oauth", "ssl-certificate"], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 4873398, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/10205507575981601/picture?type=large", "display_name": "Julius Doan", "link": "https://stackoverflow.com/users/4873398/julius-doan"}, "is_accepted": false, "score": 0, "last_activity_date": 1447343974, "creation_date": 1447343974, "answer_id": 33675794, "question_id": 33001502, "link": "https://stackoverflow.com/questions/33001502/unable-to-run-through-mvc-external-login-example/33675794#33675794", "title": "Unable to run through MVC external login example", "body": "<p>Have you registered your site to Twitter as well as obtain an app secret/key? Refer to this to get your answers.</p>\n\n<p><a href=\"http://www.asp.net/web-api/overview/security/external-authentication-services#TWITTER\" rel=\"nofollow\">http://www.asp.net/web-api/overview/security/external-authentication-services#TWITTER</a>. </p>\n"}], "owner": {"reputation": 499, "user_id": 2403744, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/ce478e459e7b417e715ff31120f2c28b?s=128&d=identicon&r=PG", "display_name": "tntwyckoff", "link": "https://stackoverflow.com/users/2403744/tntwyckoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447343974, "creation_date": 1444248370, "question_id": 33001502, "link": "https://stackoverflow.com/questions/33001502/unable-to-run-through-mvc-external-login-example", "title": "Unable to run through MVC external login example", "body": "<p>This has me feeling pretty lame. I'm trying to learn how to do the 'oAuth2 dance' and in order to see it working i wanted to get a trivial demo site up and running and logging in via twitter. i've seen a demo where it's as easy as creating a new web mvc project, making sure 'individual user accounts' is the auth mode, and un-commenting the two auto-generated lines to enable twitter auth in Startup.Auth.cs. i should then be able to hit the login page of the <em>completely</em> stock, boilerplate web project, and click the 'Twitter' button that's now visible under \"Use another service to log in.\" </p>\n\n<p>however, when i do this - unlike the demo i saw - i get a certificate error:</p>\n\n<blockquote>\n  <p>The remote certificate is invalid according to the validation procedure.\n  Exception Details: System.Security.Authentication.AuthenticationException: The remote certificate is invalid according to the validation procedure.</p>\n</blockquote>\n\n<p>Now, i don't claim to deeply understand how certs work, but i've checked and i have a certificate for 'localhost' and i've verified it as being associated with my user account and the computer account user the cert mgr tool in MMC (it even reads 'IIS Express Development Certificate'). i also see 'localhost' under 'trusted root cert authorities'. </p>\n\n<p>i immediately don't know what else to check...i'm not even 100% sure that it's complaining about <em>my</em> localhost cert (as opposed to that of twitter?); i'm not even sure what server address the internals of the Microsoft.Owin.Security.Twitter code is trying to hit?... </p>\n\n<p>One thing i noticed while looking at my user certs is that were a bunch that seemed to be installed by fiddler that were issued by 'DO_NOT_TRUST_FiddlerRoot', including one for localhost. I tried to disable this cert, however, and didn't make any difference. i can't imagine installing fiddler would so thoroughly disable your system configuration, anyway. that said, i 've tried it with and without fiddler running and nothing works. </p>\n\n<p>what could possibly be causing this? i still have a lot to get done and i'm stuck in the starting gate. i feel ridiculous that i can't even get auto-generated MS sample code to run on my machine....argh.</p>\n\n<p>thanks.</p>\n"}, {"tags": ["c#", "c#-6.0"], "comments": [{"owner": {"reputation": 16714, "user_id": 426894, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/LyG6D.jpg?s=128&g=1", "display_name": "asawyer", "link": "https://stackoverflow.com/users/426894/asawyer"}, "edited": false, "score": 0, "creation_date": 1444248474, "post_id": 33001477, "comment_id": 53827911, "body": "Write a property that does the property string logic and then just use that in the string instead."}, {"owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "reply_to_user": {"reputation": 16714, "user_id": 426894, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/LyG6D.jpg?s=128&g=1", "display_name": "asawyer", "link": "https://stackoverflow.com/users/426894/asawyer"}, "edited": false, "score": 1, "creation_date": 1444248530, "post_id": 33001477, "comment_id": 53827951, "body": "@asawyer I am aware of several workarounds, including one I stated in my question. I&#39;d just like to know if escaping is possible inside this new syntax."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444248753, "post_id": 33001477, "comment_id": 53828062, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/dn961160.aspx#Anchor_1\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/dn961160.aspx#Anchor_1</a>"}], "answers": [{"tags": [], "owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "is_accepted": true, "score": 87, "last_activity_date": 1444248720, "creation_date": 1444248720, "answer_id": 33001595, "question_id": 33001477, "link": "https://stackoverflow.com/questions/33001477/escaping-quotes-inside-new-c-6-string-syntax/33001595#33001595", "title": "Escaping Quotes inside new C# 6 String Syntax", "body": "<p>wrap your logic inside parentheses, <em>inside</em> the brackets:</p>\n\n<pre><code>var fullName = $\"My name is {(includePrefix ? \"Mr. \" : \"\")}{FirstName} {LastName}\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "is_accepted": false, "score": 19, "last_activity_date": 1444248733, "creation_date": 1444248733, "answer_id": 33001597, "question_id": 33001477, "link": "https://stackoverflow.com/questions/33001477/escaping-quotes-inside-new-c-6-string-syntax/33001597#33001597", "title": "Escaping Quotes inside new C# 6 String Syntax", "body": "<p>Regularly to escape quotes you need to use a slash (i.e. <code>\\\"</code>).</p>\n\n<p>However, this is not the issue here, as you don't need to escape, you're just missing parentheses over the expression.</p>\n\n<p>This works:</p>\n\n<pre><code>bool includePrefix = true;\nvar fullName = $\"My name is {(includePrefix ? \"Mr. \" : \"\")}{FirstName} {LastName}\";\n</code></pre>\n"}], "owner": {"reputation": 9813, "user_id": 2465182, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/27dda39f641c68b11b8fc65f65549481?s=128&d=identicon&r=PG", "display_name": "Nathan A", "link": "https://stackoverflow.com/users/2465182/nathan-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12124, "favorite_count": 2, "accepted_answer_id": 33001595, "answer_count": 2, "score": 56, "last_activity_date": 1444248830, "creation_date": 1444248296, "last_edit_date": 1444248830, "question_id": 33001477, "link": "https://stackoverflow.com/questions/33001477/escaping-quotes-inside-new-c-6-string-syntax", "title": "Escaping Quotes inside new C# 6 String Syntax", "body": "<p>I'm really excited about the new features in C# 6, including the new string syntax:</p>\n\n<pre><code>var fullName = $\"My Name is {FirstName} {LastName}\";\n</code></pre>\n\n<p>However, I can't figure out how to escape quotes inside the braces to do the follow:</p>\n\n<pre><code>bool includePrefix = true;\n\nvar fullName = $\"My name is {includePrefix ? \"Mr. \" : \"\"}{FirstName} {LastName}\";\n</code></pre>\n\n<p>C# 6 doesn't like that. I've had to revert to using <code>String.Format</code> in that second case.  Is it possible to escape quotes using the new syntax?  </p>\n\n<p>Update: Yes, I have tried using the <code>\\</code> escape, but it's not recognized.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-mvc-4", "asp.net-web-api"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1444248601, "post_id": 33001445, "comment_id": 53827990, "body": "Note that semantically &quot;redirect to another view&quot; is incorrect, as you do not redirect to a &quot;view&quot;, instead you redirect to an <i>action</i>, and the action returns a view."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1444252332, "post_id": 33001445, "comment_id": 53829875, "body": "Side note: There are no traces of WebAPI in the sample shown. Are you sure you&#39;ve posted correct sample?"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "edited": false, "score": 0, "creation_date": 1444251008, "post_id": 33001536, "comment_id": 53829234, "body": "I already made and nothing happen"}, {"owner": {"reputation": 424, "user_id": 2948906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1c5eebfe54d5aa0eed767440648d2f?s=128&d=identicon&r=PG", "display_name": "CainBot", "link": "https://stackoverflow.com/users/2948906/cainbot"}, "reply_to_user": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "edited": false, "score": 0, "creation_date": 1444251337, "post_id": 33001536, "comment_id": 53829421, "body": "Hang on I just realised your issue. The login is an AJAX request. You cannot issue a redirect when responding to an AJAX request. I suggest you review the response from the server in the developer tools and go from there. Perhaps change it to a vanilla form post? Get back if you need help."}, {"owner": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "edited": false, "score": 0, "creation_date": 1444252345, "post_id": 33001536, "comment_id": 53829886, "body": "I solved the issue, but not like I expected. I return the url and in the success function of the AJAX I made this:  window.location.href = data;"}], "tags": [], "owner": {"reputation": 424, "user_id": 2948906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1c5eebfe54d5aa0eed767440648d2f?s=128&d=identicon&r=PG", "display_name": "CainBot", "link": "https://stackoverflow.com/users/2948906/cainbot"}, "is_accepted": false, "score": 1, "last_activity_date": 1444248530, "creation_date": 1444248530, "answer_id": 33001536, "question_id": 33001445, "link": "https://stackoverflow.com/questions/33001445/redirect-to-another-view-mvc-webapi-asp-net/33001536#33001536", "title": "Redirect to another view MVC WebApi asp.net", "body": "<p>The only route name you have registered is Default.</p>\n\n<p>Try redirect to action instead:</p>\n\n<pre><code>return RedirectToAction(\"Users\");\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 3442776, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/2deb71da8d6926392482219e979109fa?s=128&d=identicon&r=PG&f=1", "display_name": "user3442776", "link": "https://stackoverflow.com/users/3442776/user3442776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "closed_date": 1444252529, "answer_count": 1, "score": 0, "last_activity_date": 1444248531, "creation_date": 1444248200, "last_edit_date": 1444248531, "question_id": 33001445, "link": "https://stackoverflow.com/questions/33001445/redirect-to-another-view-mvc-webapi-asp-net", "closed_reason": "Duplicate", "title": "Redirect to another view MVC WebApi asp.net", "body": "<p>I'm using MVC WebApi for creating an authentication, but when user is authenticated I try to send it to another view but for some reason it's not working and I don't know why</p>\n\n<p>RoutConfig:</p>\n\n<pre><code> public class RouteConfig\n{\n    public static void RegisterRoutes(RouteCollection routes)\n    {\n        routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n        routes.MapRoute(\n            name: \"Default\",\n            url: \"{controller}/{action}/{id}\",\n            defaults: new { controller = \"Routing\", action = \"LogIn\", id = UrlParameter.Optional }\n        );\n    }\n}\n</code></pre>\n\n<p>Controller Code:</p>\n\n<pre><code>public class RoutingController : Controller\n{\n    //\n    // GET: /Routing/\n    public ActionResult Index()\n    {\n        return View();\n    }\n\n    public ActionResult Projects()\n    {\n        return View();\n    }\n\n    public ActionResult Users()\n    {\n        return View();\n    }\n\n    public ActionResult LogIn()\n    {\n        return View();\n    }\n\n    [HttpPost]\n    public ActionResult LogInPost(string userName, string password)\n    {\n        User user = new User();\n        RoleByUser rByU = new RoleByUser();\n        password = UserController.EncriptPassword(password);\n        var checkUser = user.Get(userName);\n        var userExists = (from userInList in checkUser where userInList.UserName == userName &amp;&amp; userInList.Password == password select userInList).FirstOrDefault();\n        if(userExists!= null)\n        {\n            var roles = (from roleByUser in userExists.listOfRole select roleByUser.RoleName.Trim()).ToArray();\n            IPrincipal principal = new GenericPrincipal(\n            new GenericIdentity(userExists.UserName), roles);\n            SetPrincipal(principal);\n        }\n        //Users();\n        return RedirectToRoute(\"Users\");\n    }\n\n    private void SetPrincipal(IPrincipal principal)\n    {\n        Thread.CurrentPrincipal = principal;\n        if (System.Web.HttpContext.Current != null)\n        {\n            System.Web.HttpContext.Current.User = principal;\n        }\n    }\n\n}\n</code></pre>\n\n<p>View Code:</p>\n\n<pre><code>@{\n    ViewBag.Title = \"LogIn\";\n}\n\n&lt;link href=\"~/css/Style.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;\n\n&lt;div class=\"container\"&gt;\n    &lt;div class=\"card card-container\"&gt;\n        &lt;img id=\"STK\" class=\"profile-img-card\" src=\"Images/Softtek.png\" /&gt;\n        &lt;p id=\"profile-name\" class=\"profile-name-card\"&gt;&lt;/p&gt;\n        &lt;form class=\"form-signin\"&gt;\n            &lt;span id=\"reauth-email\" class=\"reauth-email\"&gt;&lt;/span&gt;\n            &lt;input type=\"text\" id=\"txtUserName\" class=\"form-control\" placeholder=\"Email address\" required autofocus /&gt;\n            &lt;input type=\"password\" id=\"txtPassword\" class=\"form-control\" placeholder=\"Password\" required /&gt;\n            &lt;div id=\"remember\" class=\"checkbox\"&gt;\n                &lt;label&gt;\n                    &lt;input type=\"checkbox\" value=\"remember-me\" /&gt; Remember me\n                &lt;/label&gt;\n            &lt;/div&gt;\n            &lt;button id=\"btnLogIn\" type=\"submit\" class=\"btn btn-lg btn-primary btn-block btn-signin\"  &gt;Sing In&lt;/button&gt;\n        &lt;/form&gt;&lt;!-- /form --&gt;\n        &lt;a href=\"#\" class=\"forgot-password\"&gt;\n            Forgot the password?\n        &lt;/a&gt;\n    &lt;/div&gt;&lt;!-- /card-container --&gt;\n&lt;/div&gt;&lt;!-- /container --&gt;\n\n\n\n&lt;script&gt;\n$(document).ready(function () {\n    $('#btnLogIn').click(logIn);\n});\n\nfunction logIn() {\n    $.ajax({\n        type: \"POST\",\n        url: \"http://localhost:21294/Routing/LogInPost\",\n        dataType: \"json\",\n        data: { userName: $('#txtUserName').val(), password: $('#txtPassword').val() },\n        success: function () {\n\n            toastr.success('Tus datos fueron agregados exitosamente!');\n        },\n        error: function (err, e, error) {\n            toastr.error('Error')\n        }\n    });\n}\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["c#", "entity-framework", "entity-framework-6", "code-first"], "comments": [{"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444248082, "post_id": 33001357, "comment_id": 53827666, "body": "Well, what does the <code>InnerException</code> say?"}, {"owner": {"reputation": 11009, "user_id": 1549450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SuCm4.jpg?s=128&g=1", "display_name": "Steve Greene", "link": "https://stackoverflow.com/users/1549450/steve-greene"}, "edited": false, "score": 0, "creation_date": 1444248443, "post_id": 33001357, "comment_id": 53827899, "body": "Are you just going with the edmx classes? You will probably need to add some annotations or fluent code for the relationships. You might want to reverse engineer it (<a href=\"https://msdn.microsoft.com/en-us/data/jj200620.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/data/jj200620.aspx</a>)."}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444248780, "post_id": 33001357, "comment_id": 53828079, "body": "The presence of that third table implies a many-to-many relationship, but since it appears the primary key of the <code>FinancialSell</code> table is linked to the primary key of the <code>Financial</code> table, each <code>Financial</code> record can only ever be mapped to single <code>Sell</code>.  If this is the desired implementation, you&#39;ll need to add some configuration in the <code>OnModelCreating</code> method, as Steve mentioned."}, {"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1444250933, "post_id": 33001357, "comment_id": 53829190, "body": "you have a <code>virtual Sell Sell { get; set; }</code> but you don&#39;t have an <code>int SellID { get; set; }</code>. I believe you need a foreign key to link the tables, not just a reference to them."}, {"owner": {"reputation": 55, "user_id": 634588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee39e9dc30cf604795ae7dc5a9d44bb?s=128&d=identicon&r=PG", "display_name": "adrianosepe", "link": "https://stackoverflow.com/users/634588/adrianosepe"}, "edited": false, "score": 0, "creation_date": 1444251598, "post_id": 33001357, "comment_id": 53829547, "body": "it was generated per VS2015 &quot;Code First from database&quot; wizard, and i don&#39;t know how configure using Fluent API, i found samples but don&#39;t work for me"}, {"owner": {"reputation": 11009, "user_id": 1549450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SuCm4.jpg?s=128&g=1", "display_name": "Steve Greene", "link": "https://stackoverflow.com/users/1549450/steve-greene"}, "edited": false, "score": 0, "creation_date": 1444271251, "post_id": 33001357, "comment_id": 53835831, "body": "When you reverse engineer it should create the POCO&#39;s plus a model class with the fluent code. You need to make sure you don&#39;t name the model the same as any of the tables."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 634588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee39e9dc30cf604795ae7dc5a9d44bb?s=128&d=identicon&r=PG", "display_name": "adrianosepe", "link": "https://stackoverflow.com/users/634588/adrianosepe"}, "edited": false, "score": 0, "creation_date": 1444305638, "post_id": 33008911, "comment_id": 53853279, "body": "Ok but i need to keep database model, the application are in production. My table FinancialSell has a a PK/FK called ID from Financial and SellID as FK from Sell"}], "tags": [], "owner": {"reputation": 23, "user_id": 1097002, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c2fb2553598f78b6f63e3ab62859b509?s=128&d=identicon&r=PG", "display_name": "ruffone", "link": "https://stackoverflow.com/users/1097002/ruffone"}, "is_accepted": false, "score": 0, "last_activity_date": 1444288092, "creation_date": 1444288092, "answer_id": 33008911, "question_id": 33001357, "link": "https://stackoverflow.com/questions/33001357/code-first-generated-code-doesnt-work/33008911#33008911", "title": "Code-First generated code doesn&#39;t work", "body": "<p>I am sorry but I can't provide it in C# for you :) But you should be able to fine a converter out there that'll do you right.</p>\n\n<pre><code>Imports System.ComponentModel.DataAnnotations\nImports System.ComponentModel.DataAnnotations.Schema\nImports System.Data.Entity\n\nModule Module1\n\n    Sub Main()\n\n    Dim sell = New Sell() With {\n        .Value = 1D\n    }\n    Dim financ = New Financial() With {\n        .[Date] = DateTime.Now,\n        .Sell = sell\n    }\n\n    Using ctx = New XContext()\n        ctx.Financials.Add(financ)\n        ctx.FinancialSells.Add(New FinancialSell With {.Financial = financ, .Sell = sell})\n        ctx.SaveChanges()\n\n        Console.WriteLine(\"Ok Success!\")\n    End Using\nEnd Sub\n\nEnd Module\nPartial Public Class XContext\nInherits DbContext\n\nPublic Sub New()\n    'Recreates your database when it changes.\n    Database.SetInitializer(Of XContext)(New DropCreateDatabaseIfModelChanges(Of XContext)())\n    'MyBase.New(\"name=XContext\")\nEnd Sub\n\n    Public Overridable Property Financials As DbSet(Of Financial)\n    Public Overridable Property Sells As DbSet(Of Sell)\n    Public Overridable Property FinancialSells As DbSet(Of FinancialSell)\n\n    Protected Overrides Sub OnModelCreating(modelBuilder As DbModelBuilder)\n    modelBuilder.Entity(Of FinancialSell)().HasRequired(Function(x) x.Sell).WithMany().WillCascadeOnDelete(False)\nEnd Sub\nEnd Class\n\n&lt;Table(\"Sell\")&gt;\nPartial Public Class Sell\n    &lt;System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2214:DoNotCallOverridableMethodsInConstructors\")&gt;\n    Public Sub New()\n        Financial = New HashSet(Of Financial)()\n    End Sub\n\n    &lt;Key, DatabaseGenerated(DatabaseGeneratedOption.Identity), ScaffoldColumn(False)&gt;\n    Public Property ID As Integer\n    Public Property Value As Decimal\n\n    &lt;System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2227:CollectionPropertiesShouldBeReadOnly\")&gt;\n    Public Overridable Property Financial As ICollection(Of Financial)\n\nEnd Class\n\n\n&lt;Table(\"Financial\")&gt;\nPartial Public Class Financial\n    &lt;Key, Column(Order:=0), DatabaseGenerated(DatabaseGeneratedOption.Identity), ScaffoldColumn(False)&gt;\n    Public Property ID As Integer\n    Public Property [Date] As DateTime\n    &lt;Column(Order:=1), ForeignKey(\"Sell\")&gt;\n    Public Property SellID As Integer\n\n    'Navigation Properties\n    Public Overridable Property Sell As Sell\n\nEnd Class\n\nPartial Public Class FinancialSell\n    &lt;Key, Column(Order:=0), ForeignKey(\"Financial\")&gt;\n    Public Property FinancialID As Integer\n    &lt;Key, Column(Order:=1), ForeignKey(\"Sell\")&gt;\n    Public Property SellID As Integer\n\n    'Navigation Properties\n    Public Overridable Property Sell As Sell\n    Public Overridable Property Financial As Financial\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 634588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bee39e9dc30cf604795ae7dc5a9d44bb?s=128&d=identicon&r=PG", "display_name": "adrianosepe", "link": "https://stackoverflow.com/users/634588/adrianosepe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493890420, "creation_date": 1444247912, "last_edit_date": 1493890420, "question_id": 33001357, "link": "https://stackoverflow.com/questions/33001357/code-first-generated-code-doesnt-work", "title": "Code-First generated code doesn&#39;t work", "body": "<p>I'm using database first, after I read about Entity Framework future then I decided to convert to code first using VS2015 wizard (code-first from database). </p>\n\n<p>This is my database diagram: </p>\n\n<p><a href=\"https://i.stack.imgur.com/ETGLD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ETGLD.png\" alt=\"enter image description here\"></a>. </p>\n\n<p>The generated code hasn't mapped the table <code>FinancialSell</code> like was in <code>.edmx</code>. But it doesn't put any configuration. This is the generated code:</p>\n\n<pre><code>public partial class XContext : DbContext\n{\n    public XContext()\n        : base(\"name=XContext\")\n    {\n    }\n\n    public virtual DbSet&lt;Financial&gt; Financial { get; set; }\n    public virtual DbSet&lt;Sell&gt; Sell { get; set; }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n    }\n}\n\n[Table(\"Sell\")]\npublic partial class Sell\n{\n    [System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2214:DoNotCallOverridableMethodsInConstructors\")]\n    public Sell()\n    {\n        Financial = new HashSet&lt;Financial&gt;();\n    }\n\n    public int ID { get; set; }\n\n    public decimal Value { get; set; }\n\n    [System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2227:CollectionPropertiesShouldBeReadOnly\")]\n    public virtual ICollection&lt;Financial&gt; Financial { get; set; }\n}\n\n\n[Table(\"Financial\")]\npublic partial class Financial\n{\n    public int ID { get; set; }\n\n    public DateTime Date { get; set; }\n\n    public virtual Sell Sell { get; set; }\n}\n</code></pre>\n\n<p>When i tried to use for a simple interaction: </p>\n\n<pre><code> var sell = new Sell {Value = 1.00M};\n        var financ = new Financial {Date = DateTime.Now, Sell = sell};\n\n        using(var ctx = new XContext())\n        {\n            ctx.Financial.Add(financ);\n            ctx.SaveChanges();\n\n            Console.WriteLine(\"Ok Success!\");\n        }\n</code></pre>\n\n<p>An exception is raised:</p>\n\n<blockquote>\n  <p>An error occurred while saving entities that do not expose foreign key properties for their relationships. The EntityEntries property will return null because a single entity cannot be identified as the source of the exception. Handling of exceptions while saving can be made easier by exposing foreign key properties in your entity types. See the InnerException for details.</p>\n</blockquote>\n\n<p><strong>Inner Exception</strong></p>\n\n<blockquote>\n  <p>Invalid column name 'Sell_ID'.</p>\n</blockquote>\n"}, {"tags": ["c#", "ios", "visual-studio", "ios-simulator"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444248245, "post_id": 33001248, "comment_id": 53827774, "body": "Have you tried disabling the firewall or opening that port? The problem you are going to run into is that VS may choose random ports to host the server on, and you&#39;ll be chasing it around in XCode. It would be better to create a self-hosted solution or publish to a local IIS and test that way."}, {"owner": {"reputation": 623, "user_id": 1254257, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1be115afa54114b04f660e11f70821e6?s=128&d=identicon&r=PG", "display_name": "shaharnakash", "link": "https://stackoverflow.com/users/1254257/shaharnakash"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444248777, "post_id": 33001248, "comment_id": 53828077, "body": "how to disable the firewall ?"}], "owner": {"reputation": 623, "user_id": 1254257, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1be115afa54114b04f660e11f70821e6?s=128&d=identicon&r=PG", "display_name": "shaharnakash", "link": "https://stackoverflow.com/users/1254257/shaharnakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444247812, "creation_date": 1444247577, "last_edit_date": 1444247812, "question_id": 33001248, "link": "https://stackoverflow.com/questions/33001248/parallels-integration-between-ios-simulator-and-visual-studio", "title": "Parallels integration between iOS simulator and Visual Studio", "body": "<p>How do I integrate an iPhone simulator on a Mac and Visual Studio 2015 that run in parallel on desktop 11? </p>\n\n<p>I built simple request on xcode:</p>\n\n<pre><code>Alamofire.request(.GET, \"http://localhost:49490/api/values/5\", parameters: [\"bar\": \"blabla\"])\n    .responseJSON { response in\n        print(response.request)  // original URL request\n        print(response.response) // URL response\n        print(response.data)     // server data\n        print(response.result)   // result of response serialization\n\n        if let JSON = response.result.value {\n            print(\"JSON: \\(JSON)\")\n        }\n}\n</code></pre>\n\n<p>The <code>http://localhost:49490/api/values/5</code> is the url that was generated from Visual Studio. However, the url does not reach the server code </p>\n\n<pre><code>// GET api/values/5\npublic string Get(int id)\n{\n    return \"value\";\n}\n</code></pre>\n\n<p>How can I create common networking between the 2 environments?</p>\n"}, {"tags": ["javascript", "c#", "xslt"], "answers": [{"comments": [{"owner": {"reputation": 1871, "user_id": 1379211, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/0Y3Rj.jpg?s=128&g=1", "display_name": "Rohit Vyas", "link": "https://stackoverflow.com/users/1379211/rohit-vyas"}, "edited": false, "score": 0, "creation_date": 1444331183, "post_id": 33003944, "comment_id": 53870402, "body": "Will it generate the ID for each request ? rite ? if yes then I am  looking for some other solution where I can define the RelID somewhere in config file and user That ID so that when there is new deployment it will take the ID from config file and server the latest JS file."}, {"owner": {"reputation": 1871, "user_id": 1379211, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/0Y3Rj.jpg?s=128&g=1", "display_name": "Rohit Vyas", "link": "https://stackoverflow.com/users/1379211/rohit-vyas"}, "edited": false, "score": 0, "creation_date": 1444411054, "post_id": 33003944, "comment_id": 53908486, "body": "Hi Vinit, thanks, this solution looks good to me but I have one question do I need to keep a key with name &#39;h&#39; in config file?"}], "tags": [], "owner": {"reputation": 1795, "user_id": 1050156, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ViBXE.jpg?s=128&g=1", "display_name": "Vinit", "link": "https://stackoverflow.com/users/1050156/vinit"}, "is_accepted": false, "score": 0, "last_activity_date": 1444342128, "last_edit_date": 1444342128, "creation_date": 1444259384, "answer_id": 33003944, "question_id": 33001247, "link": "https://stackoverflow.com/questions/33001247/how-to-add-server-variable-in-xslt/33003944#33003944", "title": "How to add server variable in XSLT", "body": "<p>Try this-</p>\n\n<pre><code>&lt;xsl:variable name=\"h\"&gt;&lt;h/&gt;&lt;/xsl:variable&gt;\n\n&lt;script language=\"javascript\" src=\"Scripts\\DainCSCommon.js?RelNo={generate-id($h)}\"&gt;\n&lt;/script&gt;\n</code></pre>\n\n<p>Updated answer to get value from a file-</p>\n\n<pre><code>&lt;xsl:variable name=\"h\" select=\"unparsed-text('http://test.com/config.php')\"&gt;\n\n&lt;script language=\"javascript\" src=\"Scripts\\DainCSCommon.js?RelNo={$h}\"&gt;\n    &lt;/script&gt;\n</code></pre>\n\n<p>Assuming config.php generates a random number</p>\n"}], "owner": {"reputation": 1871, "user_id": 1379211, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/0Y3Rj.jpg?s=128&g=1", "display_name": "Rohit Vyas", "link": "https://stackoverflow.com/users/1379211/rohit-vyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444342128, "creation_date": 1444247567, "question_id": 33001247, "link": "https://stackoverflow.com/questions/33001247/how-to-add-server-variable-in-xslt", "title": "How to add server variable in XSLT", "body": "<p>We are using xslt files in our project. In xslt files we are calling diffrent Javascripts file like :</p>\n\n<pre><code>&lt;xsl:template match=\"/\"&gt;\n        &lt;script language=\"javascript\" src=\"Scripts\\DainCSCommon.js\"/&gt;\n\n&lt;/xsl:template match=\"/\"&gt;\n</code></pre>\n\n<p>NOw what I want to append some ID in query string while including JS file to avoid the caching issue with each new release like </p>\n\n<pre><code>&lt;script language=\"javascript\" src=\"Scripts\\DainCSCommon.js?RelNo=1\"/&gt;\n</code></pre>\n\n<p>Question is how can I make the <code>RelNo</code> value dynamic here like getting this value from config file or so</p>\n"}, {"tags": ["c#", "asp.net-web-api2"], "comments": [{"owner": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1444247427, "post_id": 33001134, "comment_id": 53827214, "body": "Does your WebAPI controller action test for validity?"}, {"owner": {"reputation": 976, "user_id": 306182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gjxyu.jpg?s=128&g=1", "display_name": "Niels V", "link": "https://stackoverflow.com/users/306182/niels-v"}, "edited": false, "score": 0, "creation_date": 1444247443, "post_id": 33001134, "comment_id": 53827225, "body": "That depends what you did in your controller. What is the implementation of messenger - push message?"}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 1, "creation_date": 1444247485, "post_id": 33001134, "comment_id": 53827252, "body": "<a href=\"http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api\" rel=\"nofollow noreferrer\">This may point you in the right direction</a>"}, {"owner": {"reputation": 1970, "user_id": 1136506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/065dcdba52a57c9c83b2c21a7775fe2b?s=128&d=identicon&r=PG", "display_name": "Drake", "link": "https://stackoverflow.com/users/1136506/drake"}, "edited": false, "score": 0, "creation_date": 1444247648, "post_id": 33001134, "comment_id": 53827372, "body": "I know my controller is testing for validity because the <code>response</code> has a 400 status code, and the <code>response.ReasonPhrase</code> is &quot;Bad Request&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1970, "user_id": 1136506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/065dcdba52a57c9c83b2c21a7775fe2b?s=128&d=identicon&r=PG", "display_name": "Drake", "link": "https://stackoverflow.com/users/1136506/drake"}, "is_accepted": true, "score": 1, "last_activity_date": 1444350439, "last_edit_date": 1444350439, "creation_date": 1444290588, "answer_id": 33009722, "question_id": 33001134, "link": "https://stackoverflow.com/questions/33001134/get-custom-validation-error-message-from-web-api-request-to-httpclient/33009722#33009722", "title": "Get custom validation error message from Web Api request to HttpClient", "body": "<p>I figured it out, I needed to set the <code>Response.ReasonPhrase</code> in my validation class so the client can see it (instead of just \"BadRequest\"):</p>\n\n<pre><code>public class ValidateModelAttribute : ActionFilterAttribute\n{\n    public override void OnActionExecuting(HttpActionContext actionContext)\n    {\n        if (actionContext.ModelState.IsValid == false)\n        {\n            var errors = actionContext.ModelState\n                                      .Values\n                                      .SelectMany(m =&gt; m.Errors\n                                                        .Select(e =&gt; e.ErrorMessage));\n\n            actionContext.Response = actionContext.Request.CreateErrorResponse(\n                HttpStatusCode.BadRequest, actionContext.ModelState);\n\n            actionContext.Response.ReasonPhrase = string.Join(\"\\n\", errors);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1970, "user_id": 1136506, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/065dcdba52a57c9c83b2c21a7775fe2b?s=128&d=identicon&r=PG", "display_name": "Drake", "link": "https://stackoverflow.com/users/1136506/drake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2888, "favorite_count": 1, "accepted_answer_id": 33009722, "answer_count": 1, "score": 1, "last_activity_date": 1444350439, "creation_date": 1444247194, "last_edit_date": 1444290423, "question_id": 33001134, "link": "https://stackoverflow.com/questions/33001134/get-custom-validation-error-message-from-web-api-request-to-httpclient", "title": "Get custom validation error message from Web Api request to HttpClient", "body": "<p>I have the following model for my ASP.NET Web Api 2 service:</p>\n\n<pre><code>public class Message\n{\n    public int Id { get; set; }\n\n    [Required]\n    [StringLength(10, ErrorMessage = \"Message is too long; 10 characters max.\")]\n    public string Text { get; set; }\n}\n</code></pre>\n\n<p>I am making the request from my WinForms app:</p>\n\n<pre><code>using (var client = new HttpClient())\n{\n    client.BaseAddress = new Uri(BaseAddress);\n    client.DefaultRequestHeaders.Accept.Clear();\n    client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(\"application/json\"));\n\n    var messageOverTenCharacters = new Message { Text = \"OverTenCharacters\" }\n\n    var response = await client.PostAsJsonAsync(\"api/messenger/PushMessage\", messageOverTenCharacters);\n\n    // How do I see my custom error message that I wrote in my model class?\n}\n</code></pre>\n\n<p>How do I see my custom error message that I wrote in my model class?</p>\n\n<p>Here is my implementation for my validation class that I'm registering to the web api config:</p>\n\n<pre><code>public class ValidateModelAttribute : ActionFilterAttribute\n{\n    public override void OnActionExecuting(HttpActionContext actionContext)\n    {\n        if (actionContext.ModelState.IsValid == false)\n        {\n            actionContext.Response = actionContext.Request.CreateErrorResponse(\n                HttpStatusCode.BadRequest, actionContext.ModelState);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "json", "ssis", "etl"], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 4753717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9afd6e870e4872ca38c66de74b3a329?s=128&d=identicon&r=PG&f=1", "display_name": "George T", "link": "https://stackoverflow.com/users/4753717/george-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1444249633, "creation_date": 1444249633, "answer_id": 33001858, "question_id": 33001075, "link": "https://stackoverflow.com/questions/33001075/json-structured-column-into-multiple-columns/33001858#33001858", "title": "JSON structured column into multiple columns", "body": "<p>Here's a comprehensive article on <a href=\"https://www.simple-talk.com/sql/t-sql-programming/consuming-json-strings-in-sql-server/\" rel=\"nofollow\">consuming JSON Strings in SQL Server</a></p>\n\n<p>And the function that you need pasted here in case the URL stops working:</p>\n\n<pre><code>CREATE FUNCTION dbo.parseJSON( @JSON NVARCHAR(MAX))\nRETURNS @hierarchy TABLE\n  (\n   element_id INT IDENTITY(1, 1) NOT NULL, /* internal surrogate primary key gives the order of parsing and the list order */\n   sequenceNo [int] NULL, /* the place in the sequence for the element */\n   parent_ID INT,/* if the element has a parent then it is in this column. The document is the ultimate parent, so you can get the structure from recursing from the document */\n   Object_ID INT,/* each list or object has an object id. This ties all elements to a parent. Lists are treated as objects here */\n   NAME NVARCHAR(2000),/* the name of the object */\n   StringValue NVARCHAR(MAX) NOT NULL,/*the string representation of the value of the element. */\n   ValueType VARCHAR(10) NOT null /* the declared type of the value represented as a string in StringValue*/\n  )\nAS\nBEGIN\n  DECLARE\n    @FirstObject INT, --the index of the first open bracket found in the JSON string\n    @OpenDelimiter INT,--the index of the next open bracket found in the JSON string\n    @NextOpenDelimiter INT,--the index of subsequent open bracket found in the JSON string\n    @NextCloseDelimiter INT,--the index of subsequent close bracket found in the JSON string\n    @Type NVARCHAR(10),--whether it denotes an object or an array\n    @NextCloseDelimiterChar CHAR(1),--either a '}' or a ']'\n    @Contents NVARCHAR(MAX), --the unparsed contents of the bracketed expression\n    @Start INT, --index of the start of the token that you are parsing\n    @end INT,--index of the end of the token that you are parsing\n    @param INT,--the parameter at the end of the next Object/Array token\n    @EndOfName INT,--the index of the start of the parameter at end of Object/Array token\n    @token NVARCHAR(200),--either a string or object\n    @value NVARCHAR(MAX), -- the value as a string\n    @SequenceNo int, -- the sequence number within a list\n    @name NVARCHAR(200), --the name as a string\n    @parent_ID INT,--the next parent ID to allocate\n    @lenJSON INT,--the current length of the JSON String\n    @characters NCHAR(36),--used to convert hex to decimal\n    @result BIGINT,--the value of the hex symbol being parsed\n    @index SMALLINT,--used for parsing the hex value\n    @Escape INT --the index of the next escape character\n\n\n  DECLARE @Strings TABLE /* in this temporary table we keep all strings, even the names of the elements, since they are 'escaped' in a different way, and may contain, unescaped, brackets denoting objects or lists. These are replaced in the JSON string by tokens representing the string */\n    (\n     String_ID INT IDENTITY(1, 1),\n     StringValue NVARCHAR(MAX)\n    )\n  SELECT--initialise the characters to convert hex to ascii\n    @characters='0123456789abcdefghijklmnopqrstuvwxyz',\n    @SequenceNo=0, --set the sequence no. to something sensible.\n  /* firstly we process all strings. This is done because [{} and ] aren't escaped in strings, which complicates an iterative parse. */\n    @parent_ID=0;\n  WHILE 1=1 --forever until there is nothing more to do\n    BEGIN\n      SELECT\n        @start=PATINDEX('%[^a-zA-Z][\"]%', @json collate SQL_Latin1_General_CP850_Bin);--next delimited string\n      IF @start=0 BREAK --no more so drop through the WHILE loop\n      IF SUBSTRING(@json, @start+1, 1)='\"'\n        BEGIN --Delimited Name\n          SET @start=@Start+1;\n          SET @end=PATINDEX('%[^\\][\"]%', RIGHT(@json, LEN(@json+'|')-@start) collate SQL_Latin1_General_CP850_Bin);\n        END\n      IF @end=0 --no end delimiter to last string\n        BREAK --no more\n      SELECT @token=SUBSTRING(@json, @start+1, @end-1)\n      --now put in the escaped control characters\n      SELECT @token=REPLACE(@token, FROMString, TOString)\n      FROM\n        (SELECT\n          '\\\"' AS FromString, '\"' AS ToString\n         UNION ALL SELECT '\\\\', '\\'\n         UNION ALL SELECT '\\/', '/'\n         UNION ALL SELECT '\\b', CHAR(08)\n         UNION ALL SELECT '\\f', CHAR(12)\n         UNION ALL SELECT '\\n', CHAR(10)\n         UNION ALL SELECT '\\r', CHAR(13)\n         UNION ALL SELECT '\\t', CHAR(09)\n        ) substitutions\n      SELECT @result=0, @escape=1\n  --Begin to take out any hex escape codes\n      WHILE @escape&gt;0\n        BEGIN\n          SELECT @index=0,\n          --find the next hex escape sequence\n          @escape=PATINDEX('%\\x[0-9a-f][0-9a-f][0-9a-f][0-9a-f]%', @token collate SQL_Latin1_General_CP850_Bin)\n          IF @escape&gt;0 --if there is one\n            BEGIN\n              WHILE @index&lt;4 --there are always four digits to a \\x sequence  \n                BEGIN\n                  SELECT --determine its value\n                    @result=@result+POWER(16, @index)\n                    *(CHARINDEX(SUBSTRING(@token, @escape+2+3-@index, 1),\n                                @characters)-1), @index=@index+1 ;\n\n                END\n                -- and replace the hex sequence by its unicode value\n              SELECT @token=STUFF(@token, @escape, 6, NCHAR(@result))\n            END\n        END\n      --now store the string away\n      INSERT INTO @Strings (StringValue) SELECT @token\n      -- and replace the string with a token\n      SELECT @JSON=STUFF(@json, @start, @end+1,\n                    '@string'+CONVERT(NVARCHAR(5), @@identity))\n    END\n  -- all strings are now removed. Now we find the first leaf. \n  WHILE 1=1  --forever until there is nothing more to do\n  BEGIN\n\n  SELECT @parent_ID=@parent_ID+1\n  --find the first object or list by looking for the open bracket\n  SELECT @FirstObject=PATINDEX('%[{[[]%', @json collate SQL_Latin1_General_CP850_Bin)--object or array\n  IF @FirstObject = 0 BREAK\n  IF (SUBSTRING(@json, @FirstObject, 1)='{')\n    SELECT @NextCloseDelimiterChar='}', @type='object'\n  ELSE\n    SELECT @NextCloseDelimiterChar=']', @type='array'\n  SELECT @OpenDelimiter=@firstObject\n\n  WHILE 1=1 --find the innermost object or list...\n    BEGIN\n      SELECT\n        @lenJSON=LEN(@JSON+'|')-1\n  --find the matching close-delimiter proceeding after the open-delimiter\n      SELECT\n        @NextCloseDelimiter=CHARINDEX(@NextCloseDelimiterChar, @json,\n                                      @OpenDelimiter+1)\n  --is there an intervening open-delimiter of either type\n      SELECT @NextOpenDelimiter=PATINDEX('%[{[[]%',\n             RIGHT(@json, @lenJSON-@OpenDelimiter)collate SQL_Latin1_General_CP850_Bin)--object\n      IF @NextOpenDelimiter=0\n        BREAK\n      SELECT @NextOpenDelimiter=@NextOpenDelimiter+@OpenDelimiter\n      IF @NextCloseDelimiter&lt;@NextOpenDelimiter\n        BREAK\n      IF SUBSTRING(@json, @NextOpenDelimiter, 1)='{'\n        SELECT @NextCloseDelimiterChar='}', @type='object'\n      ELSE\n        SELECT @NextCloseDelimiterChar=']', @type='array'\n      SELECT @OpenDelimiter=@NextOpenDelimiter\n    END\n  ---and parse out the list or name/value pairs\n  SELECT\n    @contents=SUBSTRING(@json, @OpenDelimiter+1,\n                        @NextCloseDelimiter-@OpenDelimiter-1)\n  SELECT\n    @JSON=STUFF(@json, @OpenDelimiter,\n                @NextCloseDelimiter-@OpenDelimiter+1,\n                '@'+@type+CONVERT(NVARCHAR(5), @parent_ID))\n  WHILE (PATINDEX('%[A-Za-z0-9@+.e]%', @contents collate SQL_Latin1_General_CP850_Bin))&lt;&gt;0\n    BEGIN\n      IF @Type='Object' --it will be a 0-n list containing a string followed by a string, number,boolean, or null\n        BEGIN\n          SELECT\n            @SequenceNo=0,@end=CHARINDEX(':', ' '+@contents)--if there is anything, it will be a string-based name.\n          SELECT  @start=PATINDEX('%[^A-Za-z@][@]%', ' '+@contents collate SQL_Latin1_General_CP850_Bin)--AAAAAAAA\n          SELECT @token=SUBSTRING(' '+@contents, @start+1, @End-@Start-1),\n            @endofname=PATINDEX('%[0-9]%', @token collate SQL_Latin1_General_CP850_Bin),\n            @param=RIGHT(@token, LEN(@token)-@endofname+1)\n          SELECT\n            @token=LEFT(@token, @endofname-1),\n            @Contents=RIGHT(' '+@contents, LEN(' '+@contents+'|')-@end-1)\n          SELECT  @name=stringvalue FROM @strings\n            WHERE string_id=@param --fetch the name\n        END\n      ELSE\n        SELECT @Name=null,@SequenceNo=@SequenceNo+1\n      SELECT\n        @end=CHARINDEX(',', @contents)-- a string-token, object-token, list-token, number,boolean, or null\n      IF @end=0\n        SELECT  @end=PATINDEX('%[A-Za-z0-9@+.e][^A-Za-z0-9@+.e]%', @Contents+' ' collate SQL_Latin1_General_CP850_Bin)\n          +1\n       SELECT\n        @start=PATINDEX('%[^A-Za-z0-9@+.e][A-Za-z0-9@+.e]%', ' '+@contents collate SQL_Latin1_General_CP850_Bin)\n      --select @start,@end, LEN(@contents+'|'), @contents \n      SELECT\n        @Value=RTRIM(SUBSTRING(@contents, @start, @End-@Start)),\n        @Contents=RIGHT(@contents+' ', LEN(@contents+'|')-@end)\n      IF SUBSTRING(@value, 1, 7)='@object'\n        INSERT INTO @hierarchy\n          (NAME, SequenceNo, parent_ID, StringValue, Object_ID, ValueType)\n          SELECT @name, @SequenceNo, @parent_ID, SUBSTRING(@value, 8, 5),\n            SUBSTRING(@value, 8, 5), 'object'\n      ELSE\n        IF SUBSTRING(@value, 1, 6)='@array'\n          INSERT INTO @hierarchy\n            (NAME, SequenceNo, parent_ID, StringValue, Object_ID, ValueType)\n            SELECT @name, @SequenceNo, @parent_ID, SUBSTRING(@value, 7, 5),\n              SUBSTRING(@value, 7, 5), 'array'\n        ELSE\n          IF SUBSTRING(@value, 1, 7)='@string'\n            INSERT INTO @hierarchy\n              (NAME, SequenceNo, parent_ID, StringValue, ValueType)\n              SELECT @name, @SequenceNo, @parent_ID, stringvalue, 'string'\n              FROM @strings\n              WHERE string_id=SUBSTRING(@value, 8, 5)\n          ELSE\n            IF @value IN ('true', 'false')\n              INSERT INTO @hierarchy\n                (NAME, SequenceNo, parent_ID, StringValue, ValueType)\n                SELECT @name, @SequenceNo, @parent_ID, @value, 'boolean'\n            ELSE\n              IF @value='null'\n                INSERT INTO @hierarchy\n                  (NAME, SequenceNo, parent_ID, StringValue, ValueType)\n                  SELECT @name, @SequenceNo, @parent_ID, @value, 'null'\n              ELSE\n                IF PATINDEX('%[^0-9]%', @value collate SQL_Latin1_General_CP850_Bin)&gt;0\n                  INSERT INTO @hierarchy\n                    (NAME, SequenceNo, parent_ID, StringValue, ValueType)\n                    SELECT @name, @SequenceNo, @parent_ID, @value, 'real'\n                ELSE\n                  INSERT INTO @hierarchy\n                    (NAME, SequenceNo, parent_ID, StringValue, ValueType)\n                    SELECT @name, @SequenceNo, @parent_ID, @value, 'int'\n      if @Contents=' ' Select @SequenceNo=0\n    END\n  END\nINSERT INTO @hierarchy (NAME, SequenceNo, parent_ID, StringValue, Object_ID, ValueType)\n  SELECT '-',1, NULL, '', @parent_id-1, @type\n--\n   RETURN\nEND\nGO\n</code></pre>\n\n<p>From here, you can easily get to what you need:</p>\n\n<pre><code>DECLARE @Table TABLE\n(\n    id int NOT NULL,\n    [user] varchar(50),\n    [timestamp] datetime,\n    [type] varchar(50),\n    arguments nvarchar(max)\n)\nINSERT INTO @Table (id, [user], [timestamp], [type], arguments)\nVALUES (1, 'John', GETDATE(), 'play', '{\"track\": \"146661\", \"player_version\": \"3.0.0\", \"context\": \"search_tracks\"}')\n\nSELECT t.id, \n    t.[user], \n    t.[timestamp], \n    t.[type],\n    MAX(CASE \n            WHEN j.NAME = 'track' THEN j.StringValue\n            ELSE NULL\n        END) AS track,\n    MAX(CASE \n            WHEN j.NAME = 'player_version' THEN j.StringValue\n            ELSE NULL\n        END) AS player_version,\n    MAX(CASE \n        WHEN j.NAME = 'context' THEN j.StringValue\n        ELSE NULL\n        END) AS context\nFROM @Table t\n    CROSS APPLY dbo.parseJSON (t.arguments) j\nGROUP BY t.id, t.[user], t.[timestamp], t.[type]\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>id  user    timestamp   type    track   player_version  context\n1   John    2015-10-07  play    146661  3.0.0           search_tracks\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10988, "user_id": 653917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f265a17b3ce2d377f5db4dfd5610ea50?s=128&d=identicon&r=PG", "display_name": "Jovan MSFT", "link": "https://stackoverflow.com/users/653917/jovan-msft"}, "is_accepted": false, "score": 2, "last_activity_date": 1446752631, "creation_date": 1446752631, "answer_id": 33553420, "question_id": 33001075, "link": "https://stackoverflow.com/questions/33001075/json-structured-column-into-multiple-columns/33553420#33553420", "title": "JSON structured column into multiple columns", "body": "<p>In SQL Server 2016 you have OPENJSON function that <a href=\"https://msdn.microsoft.com/en-us/library/dn921879.aspx\" rel=\"nofollow\">transforms JSON to table</a>:</p>\n\n<pre><code>SELECT id, user, timestamp,   type,    track,   player_version,  context\nFROM mytab\n     CROSS APPLY OPENJSON (arguments)\n                 WITH (timestamp datetime,   type nvarchar(20),\n                       track int,   player_version nvarchar(10),\n                       context nvarchar(10))\n</code></pre>\n\n<p>You can specify what output columns you want and what should be return types. In older versions you will need to use CLR or some parsing in T-SQL.</p>\n"}], "owner": {"reputation": 300, "user_id": 4524064, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/1a52664ede93a5c591774451a9011752?s=128&d=identicon&r=PG&f=1", "display_name": "Blixter", "link": "https://stackoverflow.com/users/4524064/blixter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1465, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1446752631, "creation_date": 1444246983, "question_id": 33001075, "link": "https://stackoverflow.com/questions/33001075/json-structured-column-into-multiple-columns", "title": "JSON structured column into multiple columns", "body": "<p>What is the best approach to de-serialise one column \"arguments\", with json structure, into multiple columns. </p>\n\n<p><a href=\"https://i.stack.imgur.com/SWY0o.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SWY0o.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Picture above is an example. These rows exists in a sql-server which is the source i need to do ETL on. </p>\n\n<p>Take the first row, i will show you my desirable output:</p>\n\n<pre><code>ID   User   Timestamp   type   track  player_version  context\n123  John   XXXXXXXXX   Play   14661  3.0.0           search_tracks\n</code></pre>\n\n<p>I have tried using a JSON Parser -tool in SSIS but it can only use variables/urls as source. Im stuck on the variable bit because it needs to be dynamic for every unique row, and we're talking rows in millions.\nIs there another way? Maybe Script Component? Ive only seen examples using json weburls.</p>\n\n<p>any help is welcome,</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 2, "creation_date": 1444247095, "post_id": 33001047, "comment_id": 53827027, "body": "I suspect your value isn&#39;t what you think it is. Please show a short but <i>complete</i> program demonstrating the problem. I&#39;d also suggest just parsing this as a <code>TimeSpan</code> or a <code>DateTime</code> (although there&#39;s no date part - in Noda Time you&#39;d parse it as a <code>LocalTime</code>)."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 2, "creation_date": 1444247097, "post_id": 33001047, "comment_id": 53827030, "body": "Use <code>string.split</code> instead, and split on the <code>:</code>, you&#39;ll get an array with 3 indicies, the first will be hours, then minutes and seconds. And according to your input string, seconds should be 00, its minutes that should be 30."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1444247257, "post_id": 33001047, "comment_id": 53827128, "body": "Your second Substring call is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "is_accepted": true, "score": 3, "last_activity_date": 1444247193, "creation_date": 1444247193, "answer_id": 33001133, "question_id": 33001047, "link": "https://stackoverflow.com/questions/33001047/c-how-to-search-for-a-specific-character-in-a-string-by-using-indexof/33001133#33001133", "title": "C#: How to search for a specific character in a string by using IndexOf?", "body": "<p>Why not let the framework do it for you?    </p>\n\n<pre><code>var time = TimeSpan.Parse(\"18:30:00\");\n//time.Hours = 18\n//time.Minutes = 30\n</code></pre>\n\n<p>Parsing your string as a <code>TimeSpan</code> gives you exactly what you are expecting.</p>\n"}, {"tags": [], "owner": {"reputation": 1677, "user_id": 698589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zfBr8.png?s=128&g=1", "display_name": "dlxeon", "link": "https://stackoverflow.com/users/698589/dlxeon"}, "is_accepted": false, "score": 0, "last_activity_date": 1444247383, "creation_date": 1444247383, "answer_id": 33001188, "question_id": 33001047, "link": "https://stackoverflow.com/questions/33001047/c-how-to-search-for-a-specific-character-in-a-string-by-using-indexof/33001188#33001188", "title": "C#: How to search for a specific character in a string by using IndexOf?", "body": "<p>In general, to parse Date/Time you should use DateTime.Parse() method.\nFor your particular case, please take into account <em>value</em> remains the same after you do .Substring(), so your second call will start from the same position.</p>\n\n<p>Another way to solve your task can be to use String.Split</p>\n\n<pre><code>        var line = \"18:30:00\";\n        var items = line.Split(new[] {\":\"}, StringSplitOptions.None).Select(strValue =&gt; Convert.ToInt32(strValue)).ToArray();\n        var hour = items[0];\n        var minute = items[1];\n        var second = items[2];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444248371, "post_id": 33001207, "comment_id": 53827846, "body": "Since there are only two <code>:</code> in the string, <code>LastIndexOf</code> should return the same value."}], "tags": [], "owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "is_accepted": false, "score": 0, "last_activity_date": 1444247431, "creation_date": 1444247431, "answer_id": 33001207, "question_id": 33001047, "link": "https://stackoverflow.com/questions/33001047/c-how-to-search-for-a-specific-character-in-a-string-by-using-indexof/33001207#33001207", "title": "C#: How to search for a specific character in a string by using IndexOf?", "body": "<p>OP asked for IndexOf() solution to get the desired results.  This will give the second occurrence of \":\"</p>\n\n<pre><code>int second = value.IndexOf(':', value.IndexOf(':') + 1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 5408059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SWo8MXdsSXA/AAAAAAAAAAI/AAAAAAAAABM/xe7YW-dQp2A/photo.jpg?sz=128", "display_name": "002432SAM", "link": "https://stackoverflow.com/users/5408059/002432sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1444334377, "creation_date": 1444334377, "answer_id": 33024901, "question_id": 33001047, "link": "https://stackoverflow.com/questions/33001047/c-how-to-search-for-a-specific-character-in-a-string-by-using-indexof/33024901#33024901", "title": "C#: How to search for a specific character in a string by using IndexOf?", "body": "<p>Since everyone's answer is related to TimeSpan or Split, I will post mine. \nI used IndexOf, so it will search for any character (numbers &amp; text etc.) instead of time only.  </p>\n\n<p>So we are looking for hour values and mins value in a string looks like (00:00:00). I will use 18:30:00 as an example value.</p>\n\n<pre><code>int first = value.IndexOf(':'); //18:30:00\nint hour = Convert.ToInt32(value.Substring(0, first)); // get the value of hour = 18\nstring minushr = value.Substring(first + 1); // get the value of the rest (30:00)\nint last = minushr.IndexOf(':'); //30:00\nstring min = minushr.Substring(0, last); //Get the value of mins = 30\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5408059, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SWo8MXdsSXA/AAAAAAAAAAI/AAAAAAAAABM/xe7YW-dQp2A/photo.jpg?sz=128", "display_name": "002432SAM", "link": "https://stackoverflow.com/users/5408059/002432sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 33001133, "answer_count": 4, "score": -1, "last_activity_date": 1444334377, "creation_date": 1444246904, "question_id": 33001047, "link": "https://stackoverflow.com/questions/33001047/c-how-to-search-for-a-specific-character-in-a-string-by-using-indexof", "title": "C#: How to search for a specific character in a string by using IndexOf?", "body": "<p>I want to use IndexOf to search for a specific character in the string, but not sure how to do it. </p>\n\n<p>For example, for 18:30:00, I want to collect 18 and 30, and ignore the rest. I used the LastIndexOf, but it is not working correctly.</p>\n\n<p>Here is the code: (assume input is 18:30:00) </p>\n\n<pre><code>set\n        {\n            int first = value.IndexOf(':');\n            string hour = value.Substring(0, first); //first = 18\n            int second = value.LastIndexOf(':');\n            string mins = value.Substring(0, second; // second should be 30, but it keeps give me 0\n        }\n</code></pre>\n"}, {"tags": ["c#", "linq"], "comments": [{"owner": {"reputation": 17226, "user_id": 5038107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ZVMs.jpg?s=128&g=1", "display_name": "HubertL", "link": "https://stackoverflow.com/users/5038107/hubertl"}, "edited": false, "score": 1, "creation_date": 1444246860, "post_id": 33001019, "comment_id": 53826889, "body": "What error do you get?"}, {"owner": {"reputation": 1, "user_id": 5420100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156a061ed49103d6c2309f141329fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jf.Urk", "link": "https://stackoverflow.com/users/5420100/jf-urk"}, "reply_to_user": {"reputation": 17226, "user_id": 5038107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ZVMs.jpg?s=128&g=1", "display_name": "HubertL", "link": "https://stackoverflow.com/users/5038107/hubertl"}, "edited": false, "score": 0, "creation_date": 1444247119, "post_id": 33001019, "comment_id": 53827039, "body": "<a href=\"https://msdn.microsoft.com/query/dev14.query?appId=Dev14IDEF1&amp;l=EN-US&amp;k=k(EHArgument);k(TargetFrameworkMoniker-.NETFramework,Version%3Dv4.5);k(DevLang-csharp)&amp;rd=true\" rel=\"nofollow noreferrer\">msdn.microsoft.com/query/&hellip;</a>"}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1444247633, "post_id": 33001019, "comment_id": 53827360, "body": "Give the exception message in stead of a general link. The message should show specific information."}], "answers": [{"comments": [{"owner": {"reputation": 2088, "user_id": 3411954, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bdf4708e24a9aed291ca633c0eea915d?s=128&d=identicon&r=PG&f=1", "display_name": "Viru", "link": "https://stackoverflow.com/users/3411954/viru"}, "reply_to_user": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1444272687, "post_id": 33001138, "comment_id": 53836181, "body": "@OlivierJacot-Descombes  First ToList is actually not needed...Cast is anyway going to return IEnumerable&lt;string&gt; which is enough to use in Linq query. I will update it in answer too."}], "tags": [], "owner": {"reputation": 2088, "user_id": 3411954, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bdf4708e24a9aed291ca633c0eea915d?s=128&d=identicon&r=PG&f=1", "display_name": "Viru", "link": "https://stackoverflow.com/users/3411954/viru"}, "is_accepted": true, "score": 0, "last_activity_date": 1444272740, "last_edit_date": 1444272740, "creation_date": 1444247205, "answer_id": 33001138, "question_id": 33001019, "link": "https://stackoverflow.com/questions/33001019/i-want-to-filter-listbox-items-with-linq-but-i-get-an-error/33001138#33001138", "title": "I want to filter listbox items with linq . But I get an error", "body": "<p>I do not know the error but looking at your code. I think you are missing to wrap the whole query in ToList </p>\n\n<pre><code>listBox2.DataSource = (from Name in listBox1.Items.Cast&lt;String&gt;() where Name.StartsWith(Filter.Text) select Name).ToList();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 2, "last_activity_date": 1444314802, "last_edit_date": 1444314802, "creation_date": 1444247477, "answer_id": 33001224, "question_id": 33001019, "link": "https://stackoverflow.com/questions/33001019/i-want-to-filter-listbox-items-with-linq-but-i-get-an-error/33001224#33001224", "title": "I want to filter listbox items with linq . But I get an error", "body": "<p>I don't know exactly where your problem is; however, you have a strange mix of LINQ query syntax and extension method syntax. And also, since you are executing a where clause after converting to list, the result will be an <code>IEnumerable&lt;string&gt;</code>.</p>\n\n<p>Assuming that your combobox items are <em>strings</em>, I would do this:</p>\n\n<pre><code>listBox2.DataSource = listBox1.Items\n    .Cast&lt;string&gt;()\n    .Where(s =&gt; s.StartsWith(Filter.Text))\n    .ToList();\n</code></pre>\n\n<p>If your combobox contains <em>something else</em> and you want to insert these objects in the other listbox:</p>\n\n<pre><code>listBox2.DataSource = listBox1.Items\n    .Cast&lt;SomethingElse&gt;()\n    .Where(x =&gt; x.Name.StartsWith(Filter.Text))\n    .ToList();\n</code></pre>\n\n<p>Or if you want to insert only the <em>names</em> contained in these objects:</p>\n\n<pre><code>listBox2.DataSource = listBox1.Items\n    .Cast&lt;SomethingElse&gt;()\n    .Select(x =&gt; x.Name)\n    .Where(n =&gt; n.StartsWith(Filter.Text))\n    .ToList();\n</code></pre>\n\n<p>In my view, the LINQ query syntax is not of great help here and merely adds  complexity. That's why I stick to the extension method syntax.</p>\n"}], "owner": {"reputation": 1, "user_id": 5420100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f156a061ed49103d6c2309f141329fa9?s=128&d=identicon&r=PG&f=1", "display_name": "Jf.Urk", "link": "https://stackoverflow.com/users/5420100/jf-urk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "accepted_answer_id": 33001138, "answer_count": 2, "score": -1, "last_activity_date": 1444314802, "creation_date": 1444246800, "last_edit_date": 1444247099, "question_id": 33001019, "link": "https://stackoverflow.com/questions/33001019/i-want-to-filter-listbox-items-with-linq-but-i-get-an-error", "title": "I want to filter listbox items with linq . But I get an error", "body": "<p>This is my code \nListbox1 = input, Listbox2 = output, Filter = my filter textbox</p>\n\n<pre><code>    private void filter_TextChanged(object sender, EventArgs e)\n    {\n         listBox2.DataSource = from Name in listBox1.Items\n             .Cast&lt;String&gt;()\n             .ToList()\n             where Name.StartsWith(Filter.Text)\n             select Name;\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "azure", "active-directory", "azure-active-directory"], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 153779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26a99c02c27d45389d93d6f910777e8d?s=128&d=identicon&r=PG", "display_name": "Walrus von Zeppelin", "link": "https://stackoverflow.com/users/153779/walrus-von-zeppelin"}, "edited": false, "score": 0, "creation_date": 1444250280, "post_id": 33001894, "comment_id": 53828854, "body": "Thanks for the help. I&#39;m using Visual Studio 2015. I&#39;m not sure how to see what my subscription type is. It&#39;s being provided to me by my company and I know it&#39;s not a trial. I am using version 2.7 of the Azure SDK. When I publish, as far as I can tell, there is no dialog specifically for Client ID in the wizard. The way I am providing the Client ID is through the web.config which I have confirmed is what is on the web.config on the server."}, {"owner": {"reputation": 1488, "user_id": 28686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc42390938dcb533015d043a7d7e17?s=128&d=identicon&r=PG", "display_name": "brady gaster", "link": "https://stackoverflow.com/users/28686/brady-gaster"}, "reply_to_user": {"reputation": 438, "user_id": 153779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26a99c02c27d45389d93d6f910777e8d?s=128&d=identicon&r=PG", "display_name": "Walrus von Zeppelin", "link": "https://stackoverflow.com/users/153779/walrus-von-zeppelin"}, "edited": false, "score": 0, "creation_date": 1444339262, "post_id": 33001894, "comment_id": 53874614, "body": "I&#39;m emailing you now. :)"}], "tags": [], "owner": {"reputation": 1488, "user_id": 28686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26cc42390938dcb533015d043a7d7e17?s=128&d=identicon&r=PG", "display_name": "brady gaster", "link": "https://stackoverflow.com/users/28686/brady-gaster"}, "is_accepted": false, "score": 1, "last_activity_date": 1444249762, "creation_date": 1444249762, "answer_id": 33001894, "question_id": 33000992, "link": "https://stackoverflow.com/questions/33000992/azure-active-directory-using-wrong-application-client-id/33001894#33001894", "title": "Azure Active Directory using wrong Application Client ID", "body": "<p>I'm one of the PMs at Microsoft on the Web Tools Extensions crew, building out Azure tools. I have a few questions about your repro here. When you execute the publish experience, are you specifying the destination client id you want to use? I understand you're developing against AAD App #1, but you want your app to use AAD App #2 once you've published it. Are you providing the Client ID of the destination AAD App during publish? If you are, it should replace the Client ID of the one you're developing against to the one you want to run against. </p>\n\n<p>Also, which version of VS are you on, and which version of the Azure SDK do you have installed? That would help troubleshoot this. It'd also help to know if you're using a DreamSpark or CSP Azure subscription or if your subscription was one you set up on your own via a free trial, then pay-as-you-go or MSDN subscription. Some of the subscriptions have a variety of service availability so that would be helpful to know if you're willing to share the information. </p>\n\n<p>If you'd prefer to discuss this via email rather than on SO, we can facilitate that, too. Either way I will post either a resolution or action plan if this requires customers to update VS or if we have an issue that we need to resolve in a later release. </p>\n\n<p>Thanks for that info, we'll work through this and get you unblocked. </p>\n"}, {"comments": [{"owner": {"reputation": 438, "user_id": 153779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26a99c02c27d45389d93d6f910777e8d?s=128&d=identicon&r=PG", "display_name": "Walrus von Zeppelin", "link": "https://stackoverflow.com/users/153779/walrus-von-zeppelin"}, "edited": false, "score": 0, "creation_date": 1444251069, "post_id": 33002110, "comment_id": 53829277, "body": "No change. Must be something else. Thanks though."}, {"owner": {"reputation": 3026, "user_id": 5403693, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T6UqApDwHcc/AAAAAAAAAAI/AAAAAAAAEuM/OlAS3tBu0gc/photo.jpg?sz=128", "display_name": "kim", "link": "https://stackoverflow.com/users/5403693/kim"}, "reply_to_user": {"reputation": 438, "user_id": 153779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26a99c02c27d45389d93d6f910777e8d?s=128&d=identicon&r=PG", "display_name": "Walrus von Zeppelin", "link": "https://stackoverflow.com/users/153779/walrus-von-zeppelin"}, "edited": false, "score": 0, "creation_date": 1444252339, "post_id": 33002110, "comment_id": 53829881, "body": "Just to make sure nothing is being cached when you build your solution after changing the web.config, you could delete the obj and bin folders inside of your project folder. Just be sure to have a backup ready in case something goes wrong."}], "tags": [], "owner": {"reputation": 3026, "user_id": 5403693, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-T6UqApDwHcc/AAAAAAAAAAI/AAAAAAAAEuM/OlAS3tBu0gc/photo.jpg?sz=128", "display_name": "kim", "link": "https://stackoverflow.com/users/5403693/kim"}, "is_accepted": false, "score": 0, "last_activity_date": 1444250749, "creation_date": 1444250749, "answer_id": 33002110, "question_id": 33000992, "link": "https://stackoverflow.com/questions/33000992/azure-active-directory-using-wrong-application-client-id/33002110#33002110", "title": "Azure Active Directory using wrong Application Client ID", "body": "<p>I have a similar setup for one of my customers. So far running \"Clean Solution\" from the \"Build\" menu inside of VS2015 has solved it for me.</p>\n"}, {"tags": [], "owner": {"reputation": 438, "user_id": 153779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26a99c02c27d45389d93d6f910777e8d?s=128&d=identicon&r=PG", "display_name": "Walrus von Zeppelin", "link": "https://stackoverflow.com/users/153779/walrus-von-zeppelin"}, "is_accepted": true, "score": 2, "last_activity_date": 1444422612, "creation_date": 1444422612, "answer_id": 33046644, "question_id": 33000992, "link": "https://stackoverflow.com/questions/33000992/azure-active-directory-using-wrong-application-client-id/33046644#33046644", "title": "Azure Active Directory using wrong Application Client ID", "body": "<p>Thanks to brady gaster I was pointed to the Configure Azure AD Authentication option accessed by right clicking the project. By going through this wizard and then publishing it was able to set up the authentication correctly. I'm not sure what this does differently than changing the app settings in web.config but it worked.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JtNDF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JtNDF.png\" alt=\"Configure Azure AD Authentication\"></a></p>\n"}], "owner": {"reputation": 438, "user_id": 153779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/26a99c02c27d45389d93d6f910777e8d?s=128&d=identicon&r=PG", "display_name": "Walrus von Zeppelin", "link": "https://stackoverflow.com/users/153779/walrus-von-zeppelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1918, "favorite_count": 0, "accepted_answer_id": 33046644, "answer_count": 3, "score": 1, "last_activity_date": 1444422612, "creation_date": 1444246725, "question_id": 33000992, "link": "https://stackoverflow.com/questions/33000992/azure-active-directory-using-wrong-application-client-id", "title": "Azure Active Directory using wrong Application Client ID", "body": "<p>I developed an Azure web app that was using Azure Active Directory on my subscription for authentication but I am now trying to switch from my test AAD directory to the actual AAD I want to use on another subscription. I am getting the following error:</p>\n\n<blockquote>\n  <p>AADSTS50020: User account 'MyAccount' from external identity provider '<a href=\"https://sts.windows.net/a26def89-f7e6-4496-b4cb-7ffee9ddbabf/\" rel=\"nofollow\">https://sts.windows.net/a26def89-f7e6-4496-b4cb-7ffee9ddbabf/</a>' is not supported for application '025ef17e-9767-4f4e-a1b1-6218491d94ed'. The account needs to be added as an external user in the tenant. Please sign out and sign in again with an Azure Active Directory user account.</p>\n</blockquote>\n\n<p>The tennant ID is correct but the application Client ID is not what I am putting in my App Settings and it's not even the correct Client ID that I am using for this deployment. I have two different Applications added under my Azure Active Directory account and this Client ID belongs to a different one. I do not understand where the site is grabbing this from. After searching my solution I found it embedded in the Web Deploy for a different publishing profile, not the one I have been publishing from. I commented out this reference and unchecked Enable Organizational Authentication when publishing to see if that would change anything and it hasn't.</p>\n\n<p>I am using the standard AAD code that Visual Studio 2015 creates when you create a new MVC application and check to use Work or School accounts that provides the following AppSettings:</p>\n\n<pre><code>&lt;add key=\"ida:ClientId\" value=\"6b0dde38-55e6-4801-ba14-58708ecb5c06\" /&gt;\n&lt;add key=\"ida:AADInstance\" value=\"https://login.microsoftonline.com/\" /&gt;\n&lt;add key=\"ida:Domain\" value=\"new.domain.imtryingtouse\" /&gt;\n&lt;add key=\"ida:TenantId\" value=\"a26def89-f7e6-4496-b4cb-7ffee9ddbabf\" /&gt;\n&lt;add key=\"ida:PostLogoutRedirectUri\" value=\"mysite.azurewebsites.net\" /&gt;\n</code></pre>\n\n<p>I have verified through FTP that the correct ClientId in AppSettings is in my web.config on the server but it's not the one being used in that error message.</p>\n\n<p>Any help would be appreciated. Please and thank you.</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 43527, "user_id": 98094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VkdLW.jpg?s=128&g=1", "display_name": "Icemanind", "link": "https://stackoverflow.com/users/98094/icemanind"}, "edited": false, "score": 2, "creation_date": 1444246600, "post_id": 33000929, "comment_id": 53826734, "body": "This sounds like a weird requirement. Are you making a joke app or something?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5166622"}, "edited": false, "score": 0, "creation_date": 1444246831, "post_id": 33000929, "comment_id": 53826866, "body": "This is such a weird question, is this a homework task of a drunk teacher xD?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1400995"}, "edited": false, "score": 3, "creation_date": 1444246855, "post_id": 33000929, "comment_id": 53826883, "body": "take a look at the Mouse Move event and move your button accordingly"}, {"owner": {"reputation": 11, "user_id": 4686467, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-orR__tratgo/AAAAAAAAAAI/AAAAAAAABCE/mH07ETxf_D4/photo.jpg?sz=128", "display_name": "Quadrium", "link": "https://stackoverflow.com/users/4686467/quadrium"}, "edited": false, "score": 0, "creation_date": 1444247307, "post_id": 33000929, "comment_id": 53827154, "body": "So how do I move the button accordingly? xD"}, {"owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "edited": false, "score": 2, "creation_date": 1444247645, "post_id": 33000929, "comment_id": 53827370, "body": "If you anchor onto the <code>MouseMove</code> you should be able to grab coordinates by simply doing: <code>e.X</code> and <code>e.Y</code>.  So you should be able to always change the button&#39;s position on the form according."}, {"owner": {"reputation": 3564, "user_id": 1189566, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/YXOz8.png?s=128&g=1", "display_name": "sab669", "link": "https://stackoverflow.com/users/1189566/sab669"}, "reply_to_user": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "edited": false, "score": 0, "creation_date": 1444248845, "post_id": 33000929, "comment_id": 53828112, "body": "Expanding on @Greg&#39;s comment, you&#39;ll want to check the cursor&#39;s proximity to the form&#39;s borders (it&#39;s size, effectively) and move the button up / down / left / right so that it stays fully on the form. So if cursor.X &lt; 100 (within 100 pixels of the &quot;start&quot; of the X axis) then you know to move the button to the right rather than the left."}, {"owner": {"reputation": 11, "user_id": 4686467, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-orR__tratgo/AAAAAAAAAAI/AAAAAAAABCE/mH07ETxf_D4/photo.jpg?sz=128", "display_name": "Quadrium", "link": "https://stackoverflow.com/users/4686467/quadrium"}, "edited": false, "score": 0, "creation_date": 1444249723, "post_id": 33000929, "comment_id": 53828564, "body": "Sorry for being a noob, but I still don&#39;t understand. In my code I should create a MouseMove event, get rid of Random(?) and replace ClientSize with e.X and e.Y? Or what should I do with e.X and e.Y?"}, {"owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "edited": false, "score": 0, "creation_date": 1444250936, "post_id": 33000929, "comment_id": 53829196, "body": "@Quadrium <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousemove(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4393, "user_id": 3691973, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iytIc.jpg?s=128&g=1", "display_name": "Necoras", "link": "https://stackoverflow.com/users/3691973/necoras"}, "is_accepted": false, "score": 1, "last_activity_date": 1444253777, "creation_date": 1444253777, "answer_id": 33002813, "question_id": 33000929, "link": "https://stackoverflow.com/questions/33000929/c-runaway-button/33002813#33002813", "title": "C# - Runaway Button", "body": "<p>Your existing code generates a random set of coordinates and continues doing so until those coordinates ensure that the new button location doesn't contain the current pointer location. But you don't want a random location; you want a location which is close to the current pointer.</p>\n\n<p>Remove the random number generator all together. Instead, change your button1_MouseEnter method to move the button up the height of your button and to the left the width of your button. Do that until you hit an edge and then flip a bit and have it run down/right based on which window edge was hit.</p>\n\n<p>That will get your button tracking with the mouse pointer. If you want it to track <em>closely</em> you'll need to add some logic that detects where on the button the mouse entered. If it entered from the top, move down a few pixels. If it entered from the left, move right. Etc. If you hit a window edge, add an additional direction to its movement.</p>\n\n<p>Since this is a school assignment, I'll leave converting that logic into code as an exercise for the questioner.</p>\n"}], "owner": {"reputation": 11, "user_id": 4686467, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-orR__tratgo/AAAAAAAAAAI/AAAAAAAABCE/mH07ETxf_D4/photo.jpg?sz=128", "display_name": "Quadrium", "link": "https://stackoverflow.com/users/4686467/quadrium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444253777, "creation_date": 1444246517, "question_id": 33000929, "link": "https://stackoverflow.com/questions/33000929/c-runaway-button", "title": "C# - Runaway Button", "body": "<p>I need your help with the following program. I need to make a runaway button that should always be entirely contained in the form and should stay as close to the mouse pointer as possible without giving the possibility to be clicked. </p>\n\n<p>My Program:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    int i = 0;\n    public Form1()\n    {\n        InitializeComponent();\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        successLabel.Visible = true;\n        button1.Enabled = false;\n    }\n\n    private void Form1_Click(object sender, EventArgs e)\n    {\n        if (successLabel.Visible == false) missedLabel.Visible = true;\n    }\n\n    private void Form1_Load(object sender, EventArgs e)\n    {\n        successLabel.Visible = missedLabel.Visible = false;\n        timer1.Enabled = true;\n        progressBar1.Value = progressBar1.Minimum;\n    }\n\n    private void timer1_Tick(object sender, EventArgs e)\n    {\n        timer1.Interval = 1000;\n        if (progressBar1.Value == progressBar1.Maximum)\n        {\n            gameOverLabel.Visible = true;\n            this.Enabled = false;\n            timer1.Enabled = false;\n            Form1_MouseClick(sender, e);\n        }\n        else\n        {\n            gameOverLabel.Visible = false;\n            progressBar1.PerformStep();\n        }\n    }\n\n    private void Form1_MouseClick(object sender, EventArgs e)\n    {\n        i++;\n        gameOverLabel.Text = \"Game over, you failed! \" + Environment.NewLine + \"Clicks: \" + i.ToString();\n    }\n\n    private void button1_MouseEnter(object sender, EventArgs e)\n    {\n        missedLabel.Visible = false;\n        int x, y;\n        Point formClientSize = new Point(ClientSize);\n\n        Random rnd = new Random();\n        do\n        {\n            x = rnd.Next(0, formClientSize.X - button1.Width);\n        }\n        while (x &gt;= button1.Left - button1.Width &amp;&amp; x &lt;= button1.Right);\n        do\n        {\n            y = rnd.Next(0, formClientSize.Y - button1.Height);\n        }\n        while (y &gt;= button1.Top - button1.Height &amp;&amp; y &lt;= button1.Bottom);\n        button1.Location = new Point(x, y);\n    }\n}\n</code></pre>\n\n<p>So, the problem is that in my program the location of button is generated randomly and that is not as close to the mouse pointer as possible.</p>\n\n<p>Please help. Thank you.</p>\n"}, {"tags": ["c#", "sql", "asp.net"], "comments": [{"owner": {"reputation": 2931, "user_id": 3242103, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zmsJQ.jpg?s=128&g=1", "display_name": "snow_FFFFFF", "link": "https://stackoverflow.com/users/3242103/snow-ffffff"}, "edited": false, "score": 0, "creation_date": 1444247187, "post_id": 33000902, "comment_id": 53827087, "body": "In the context of SQL, DDL typically means Data Definition Language (a subset of SQL).  It took a minute for me to figure out that you probably mean Drop Down List.  Also, the answer will depend on if this ASP.NET application is WebForms or ASP.NET MVC - it isn&#39;t clear what you are using."}, {"owner": {"reputation": 229, "user_id": 3530169, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0d051716472fa78d2487abe3d4e87eb0?s=128&d=identicon&r=PG&f=1", "display_name": "user3530169", "link": "https://stackoverflow.com/users/3530169/user3530169"}, "reply_to_user": {"reputation": 2931, "user_id": 3242103, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zmsJQ.jpg?s=128&g=1", "display_name": "snow_FFFFFF", "link": "https://stackoverflow.com/users/3242103/snow-ffffff"}, "edited": false, "score": 0, "creation_date": 1444252535, "post_id": 33000902, "comment_id": 53829980, "body": "It does indeed refer to Drop Down List, and this ASP.NET application is indeed a WebForm. I&#39;m sorry for not being more clear earlier."}], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 3530169, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0d051716472fa78d2487abe3d4e87eb0?s=128&d=identicon&r=PG&f=1", "display_name": "user3530169", "link": "https://stackoverflow.com/users/3530169/user3530169"}, "edited": false, "score": 0, "creation_date": 1444256815, "post_id": 33001273, "comment_id": 53831868, "body": "The link provided wasn&#39;t the exact solution I was looking for, however the term &quot;Cascading Dropdown Lists&quot; helped me find exactly what I needed, and fast, so thank you!"}], "tags": [], "owner": {"reputation": 2931, "user_id": 3242103, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zmsJQ.jpg?s=128&g=1", "display_name": "snow_FFFFFF", "link": "https://stackoverflow.com/users/3242103/snow-ffffff"}, "is_accepted": true, "score": 1, "last_activity_date": 1444247663, "creation_date": 1444247663, "answer_id": 33001273, "question_id": 33000902, "link": "https://stackoverflow.com/questions/33000902/how-to-filter-the-data-in-an-sql-ddl-based-on-another-ddl/33001273#33001273", "title": "How to filter the data in an SQL DDL based on another DDL?", "body": "<p>My guess is that this is a webforms application - if so, what you are trying to accomplish is commonly referred to as cascading dropdown lists - here is an example of what you need:</p>\n\n<p><a href=\"http://www.aspsnippets.com/Articles/Creating-Cascading-DropDownLists-in-ASP.Net.aspx\" rel=\"nofollow\">http://www.aspsnippets.com/Articles/Creating-Cascading-DropDownLists-in-ASP.Net.aspx</a></p>\n"}], "owner": {"reputation": 229, "user_id": 3530169, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0d051716472fa78d2487abe3d4e87eb0?s=128&d=identicon&r=PG&f=1", "display_name": "user3530169", "link": "https://stackoverflow.com/users/3530169/user3530169"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 33001273, "answer_count": 1, "score": 0, "last_activity_date": 1444247663, "creation_date": 1444246391, "question_id": 33000902, "link": "https://stackoverflow.com/questions/33000902/how-to-filter-the-data-in-an-sql-ddl-based-on-another-ddl", "title": "How to filter the data in an SQL DDL based on another DDL?", "body": "<p>I am trying to make a simple ASP.NET C# application that will provide the user with two DDLs. The first one is pre-populated with customers from an SQL database, and when a customer is selected, the second will then populate with that customer's orders.</p>\n\n<p>I am using SqlDataSources for this, the first DDL lists without issue, and displays customer names alphabetically, along with assigning the CustomerID as the value. How could I go about using code to dynamically adjust the WHERE clause of the second DDL to dynamically match the value of the first DDL?</p>\n\n<p>To exemplify, my second dropdown would (ideally) have a SELECT statement similar to the following:</p>\n\n<pre><code>SELECT [OrderID], [CustomerID] FROM [Orders] WHERE [CustomerID] = ddl1.SelectedValue\n</code></pre>\n\n<p>Unfortunately, and naturally, this throws an error, but should illustrate what I am trying to accomplish.</p>\n\n<p>Making it dynamically update from this point would be easy, but I am not certain how to filter results based on an outside source.</p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["c#", "bitwise-operators", "roslyn", "c#-6.0"], "comments": [{"owner": {"reputation": 54636, "user_id": 1336654, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b1fcddf43425d951bb5dafef53563d45?s=128&d=identicon&r=PG", "display_name": "Jeppe Stig Nielsen", "link": "https://stackoverflow.com/users/1336654/jeppe-stig-nielsen"}, "edited": false, "score": 1, "creation_date": 1444255486, "post_id": 33000899, "comment_id": 53831338, "body": "See also <a href=\"http://stackoverflow.com/questions/31542256/\">Bitwise-or operator used on a sign-extended operand in Visual Studio 2015</a> and other threads."}, {"owner": {"reputation": 3283, "user_id": 241658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921260cf543cfed216e1a932bb538950?s=128&d=identicon&r=PG", "display_name": "Neal Gafter", "link": "https://stackoverflow.com/users/241658/neal-gafter"}, "edited": false, "score": 0, "creation_date": 1446135348, "post_id": 33000899, "comment_id": 54628312, "body": "This is a bug in VS2015 and will be fixed in VS2015 Update 1. See <a href=\"https://github.com/dotnet/roslyn/issues/4027\" rel=\"nofollow noreferrer\">github.com/dotnet/roslyn/issues/4027</a> ."}], "answers": [{"comments": [{"owner": {"reputation": 12460, "user_id": 234954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4aba9ddb6b8a1cb84962cd54a53ee98?s=128&d=identicon&r=PG", "display_name": "jmoreno", "link": "https://stackoverflow.com/users/234954/jmoreno"}, "edited": false, "score": 0, "creation_date": 1444250558, "post_id": 33001496, "comment_id": 53829002, "body": "I think I&#39;ll report it as a bug anyway, as there is no way of using |= without a warning or error in 2015, but 2013 was happy with it (so either it was a bug in 2013, or they deliberately suppressed the error, and I suspect the later)."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 12460, "user_id": 234954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4aba9ddb6b8a1cb84962cd54a53ee98?s=128&d=identicon&r=PG", "display_name": "jmoreno", "link": "https://stackoverflow.com/users/234954/jmoreno"}, "edited": false, "score": 0, "creation_date": 1444256011, "post_id": 33001496, "comment_id": 53831565, "body": "@jmoreno I wouldn&#39;t really call it a bug, but I agree that VS2013 is right here and VS2015 is not. I&#39;ve updated the answer a bit to explain that."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 12460, "user_id": 234954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4aba9ddb6b8a1cb84962cd54a53ee98?s=128&d=identicon&r=PG", "display_name": "jmoreno", "link": "https://stackoverflow.com/users/234954/jmoreno"}, "edited": false, "score": 2, "creation_date": 1444256319, "post_id": 33001496, "comment_id": 53831693, "body": "@jmoreno And it was apparently fixed: <a href=\"https://github.com/dotnet/roslyn/issues/4027\" rel=\"nofollow noreferrer\">github.com/dotnet/roslyn/issues/4027</a>"}], "tags": [], "owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "is_accepted": true, "score": 5, "last_activity_date": 1444256251, "last_edit_date": 1444256251, "creation_date": 1444248359, "answer_id": 33001496, "question_id": 33000899, "link": "https://stackoverflow.com/questions/33000899/bug-in-compiler-or-misunderstanding-or-operator-on-shorts/33001496#33001496", "title": "Bug in compiler or misunderstanding? Or operator on shorts", "body": "<p>If you look at the C# specifications (specifically in \"Integer logical operators\") you'll see that there's only a definition for <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code> for the logical OR operator:</p>\n\n<pre><code>int operator |(int x, int y);\nuint operator |(uint x, uint y);\nlong operator |(long x, long y);\nulong operator |(ulong x, ulong y);\n</code></pre>\n\n<p>Also, in <a href=\"http://blogs.msdn.com/b/ericlippert/archive/2010/11/29/bit-twiddling-what-does-warning-cs0675-mean.aspx\" rel=\"nofollow\">Bit twiddling: What does warning CS0675 mean?</a> Eric Lippert states that:</p>\n\n<blockquote>\n  <p>\"There are bitwise-or operators defined on <code>int</code>, <code>uint</code>, <code>long</code> and <code>ulong</code>\"</p>\n</blockquote>\n\n<p>The operator IS valid for <code>short</code>, but only in the sense that the short value can be extended to <code>int</code>. The return value of that operator however, is (at least) an <code>int</code>.</p>\n\n<p>So, technically speaking, according to the specs, this doesn't seem to be a bug as using <code>|=</code> does extend the signed value to int, which gives a warning and the regular <code>|</code> results in an <code>int</code> that needs to be cast down to be assigned to a <code>short</code>.</p>\n\n<p><strong>However</strong>, since the compiler can in fact know that both operands are originally <code>short</code>s, both get extended to <code>int</code> and the result will eventually be stored back into a <code>short</code> it doesn't really matter that the operands are extended. The extension will be lost by the cast from <code>int</code> to <code>short</code>.</p>\n\n<p>So, either the VS2013 compiler was smarter with its warnings than the VS2015 one or the VS2015 fixes a bug and warns where VS2013 failed to. Only the people behind the compiler can answer that but I assume it's indeed a bug (EDIT: <a href=\"https://github.com/dotnet/roslyn/issues/4027\" rel=\"nofollow\">and it is</a>).</p>\n"}], "owner": {"reputation": 12460, "user_id": 234954, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4aba9ddb6b8a1cb84962cd54a53ee98?s=128&d=identicon&r=PG", "display_name": "jmoreno", "link": "https://stackoverflow.com/users/234954/jmoreno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "closed_date": 1444256369, "accepted_answer_id": 33001496, "answer_count": 1, "score": 5, "last_activity_date": 1444256251, "creation_date": 1444246382, "last_edit_date": 1444249364, "question_id": 33000899, "link": "https://stackoverflow.com/questions/33000899/bug-in-compiler-or-misunderstanding-or-operator-on-shorts", "closed_reason": "Duplicate", "title": "Bug in compiler or misunderstanding? Or operator on shorts", "body": "<p>I have a line of code that is giving me an warning message (CS0675) in VS2015, but not in 2013. </p>\n\n<pre><code>shortValue |= (short)anEnum;\n</code></pre>\n\n<blockquote>\n  <p>Warning   CS0675  Bitwise-or operator used on a sign-extended operand;\n  consider casting to a smaller unsigned type first. The compiler\n  implicitly widened and sign-extended a variable, and then used the\n  resulting value in a bitwise OR operation. This can result in\n  unexpected behavior.</p>\n</blockquote>\n\n<p>Obviously what is happening is the enum and the short are being extended to an int, the or operator applied, and then the result assigned the result to the short.</p>\n\n<p>If I change the code to <code>shortValue = shortValue | (short)anEnum;</code> I get a compiler error CS0266.  But the bitwise OR should be valid for shorts (in both cases I believe).  If I hover the mouse over the <code>|</code> it shows as an int operator, am I missing something or should I report this as a bug?</p>\n\n<p>PS: I know I can eliminate the warning/error by using <code>=</code> instead of <code>|=</code> and casting the result to a short.  </p>\n"}, {"tags": ["c#", "sql", "sql-server"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1444246520, "post_id": 33000884, "comment_id": 53826673, "body": "That&#39;s because you can&#39;t just stick a string in where a list of values should go. When you do that sql thinks you are passing an in but you passed in a whole delimited list. You will need to split those values using a splitter. <a href=\"http://sqlperformance.com/2012/07/t-sql-queries/split-strings\" rel=\"nofollow noreferrer\">sqlperformance.com/2012/07/t-sql-queries/split-strings</a> You also are using the older ANSI-89 style joins. You really should use the &quot;newer&quot; ANSI-92 style joins, they have been around for over 25 years now. <a href=\"http://sqlblog.com/blogs/aaron_bertrand/archive/2009/10/08/bad-habits-to-kick-using-old-style-joins.aspx\" rel=\"nofollow noreferrer\">sqlblog.com/blogs/aaron_bertrand/archive/2009/10/08/&hellip;</a>"}, {"owner": {"reputation": 40188, "user_id": 60724, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5a9b6bb5bd27e98b366fe0bf5cc32c1?s=128&d=identicon&r=PG", "display_name": "STW", "link": "https://stackoverflow.com/users/60724/stw"}, "edited": false, "score": 3, "creation_date": 1444248364, "post_id": 33000884, "comment_id": 53827842, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/182060/where-in-array-of-ids\">WHERE IN (array of IDs)</a>"}, {"owner": {"reputation": 40188, "user_id": 60724, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e5a9b6bb5bd27e98b366fe0bf5cc32c1?s=128&d=identicon&r=PG", "display_name": "STW", "link": "https://stackoverflow.com/users/60724/stw"}, "edited": false, "score": 0, "creation_date": 1444248426, "post_id": 33000884, "comment_id": 53827888, "body": "See the duplicate question for a good answer, as well as a workaround (if there is no alternative)"}, {"owner": {"reputation": 23, "user_id": 4125975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0886b5b4d80284cd55a5e4a3f15eec?s=128&d=identicon&r=PG&f=1", "display_name": "Mikolz", "link": "https://stackoverflow.com/users/4125975/mikolz"}, "edited": false, "score": 0, "creation_date": 1444264377, "post_id": 33000884, "comment_id": 53834078, "body": "Updated the SQL to use correct joins. Thanks for pointing that out. I link was useful and I ended up implementing one of those solutions. The SQL is working as expected now."}], "answers": [{"tags": [], "owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1444247150, "last_edit_date": 1444247150, "creation_date": 1444246980, "answer_id": 33001073, "question_id": 33000884, "link": "https://stackoverflow.com/questions/33000884/inserting-multiple-values-into-an-in-condition/33001073#33001073", "title": "Inserting multiple values into an IN condition", "body": "<p>Even though <code>ListID</code> is an <code>int</code> type, you need to use a <code>varchar</code> for the <code>@ids</code> variable/parameter to allow it to contain a comma-separated string.</p>\n\n<p>Then you need to concatenate it to your dynamic sql string like this:</p>\n\n<pre><code>' ... WHERE ListID IN (' + @ids + ') ...'\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4125975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0886b5b4d80284cd55a5e4a3f15eec?s=128&d=identicon&r=PG&f=1", "display_name": "Mikolz", "link": "https://stackoverflow.com/users/4125975/mikolz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444264155, "creation_date": 1444246323, "last_edit_date": 1444264155, "question_id": 33000884, "link": "https://stackoverflow.com/questions/33000884/inserting-multiple-values-into-an-in-condition", "title": "Inserting multiple values into an IN condition", "body": "<p>I need to insert a parameter into an IN condition for a particular SQL statement. The actual value of the parameter is a command separated list of ID's that could be 1 ID or multiple ID's. Here is the SQL;</p>\n\n<pre><code>                CommandText = @\";WITH CTE(ListID, ParentID) AS\n                                (\n                                    SELECT ListID, ParentID FROM dvw.DistributionList WHERE ListID IN (@ids)\n                                    UNION ALL\n                                    SELECT dl.ListID, dl.ParentID FROM CTE AS c INNER JOIN dvw.DistributionList as dl\n                                    ON dl.ListID = c.parentID\n                                )\n\n                                SELECT DISTINCT Email FROM tiger_dev.dvw.Subscriptions AS sub INNER JOIN dvw.Users AS u\n                                ON sub.UserName = u.UserName WHERE u.ActiveUser = 1 and sub.ListID IN\n                                (\n                                    SELECT ListID FROM CTE\n                                )\n                                ORDER BY Email\"\n</code></pre>\n\n<p>Here's the issue, The <code>ListID</code> column data type is <code>int</code>. When I run the statement I get some conflicting data type issues. Here's a sample one;</p>\n\n<p>Conversion failed when converting the <code>nvarchar</code> value <code>'4703,4724,4704,4705'</code> to data type <code>int</code>. </p>\n\n<p>Is there anyway to go about this without having to create potentially X amount of parameters in the SQL text and set each of them?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1444246245, "post_id": 33000828, "comment_id": 53826495, "body": "what line produces the error?"}, {"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "reply_to_user": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1444246336, "post_id": 33000828, "comment_id": 53826541, "body": "labels[i].Text = letter.ToString();"}, {"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "reply_to_user": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1444246660, "post_id": 33000828, "comment_id": 53826771, "body": "how do I go about defing lables"}, {"owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1444246699, "post_id": 33000828, "comment_id": 53826789, "body": "actually, you do have labels defined -- it&#39;s a list."}, {"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "reply_to_user": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1444246787, "post_id": 33000828, "comment_id": 53826832, "body": "Ive been told that some of the code should create a compile error too             this code in particular:                                                                                              if (letters[i] == letter)"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1444247409, "post_id": 33000828, "comment_id": 53827200, "body": "The error you are getting is pretty self explanatory: <a href=\"https://msdn.microsoft.com/en-us/library/system.indexoutofrangeexception(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a> . If you step through your code, it should be pretty apparent where your mistake is."}, {"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444249179, "post_id": 33000828, "comment_id": 53828306, "body": "Believe me i&#39;m trying, i just not seeing it."}], "answers": [{"comments": [{"owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "reply_to_user": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444251860, "post_id": 33001023, "comment_id": 53829668, "body": "I&#39;ve re-written my answer."}], "tags": [], "owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "is_accepted": false, "score": 0, "last_activity_date": 1444251827, "last_edit_date": 1444251827, "creation_date": 1444246807, "answer_id": 33001023, "question_id": 33000828, "link": "https://stackoverflow.com/questions/33000828/c-sharp-game-out-of-range-error/33001023#33001023", "title": "c# sharp game. out of range error", "body": "<p>My original answer was completely wrong.</p>\n\n<p>Here is the problem.  labels is a List of type Label.  The list length is defined in MakeLabels(), here:</p>\n\n<pre><code>char[] chars = word.ToCharArray();\n...\nfor(int i = 0; i &lt; chars.Length - 1; i++)\n{\n        labels.Add(new Label());\n        ...\n        labels[i].Text = \"_\";\n        ...\n</code></pre>\n\n<p>So, the list length is chars.Length - 1</p>\n\n<p>But then in your button1_Click function, you have:</p>\n\n<pre><code>        char[] letters = word.ToCharArray();\n        for (int i = 0; i &lt; letters.Length; i++)\n        {\n            if (letters[i] == letter)\n                labels[i].Text = letter.ToString();\n         ...\n</code></pre>\n\n<p>Here, you i can go up to letters.Length, which is greater than the length of the labels list.  You should have as many labels as potential letters if you're going to assign a letter to labels[i].Text (at the same index as letters[i]).  This means you should change MakeLabels to:</p>\n\n<pre><code>for(int i = 0; i &lt; chars.Length; i++)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444254683, "post_id": 33002312, "comment_id": 53831009, "body": "The program is making the correct amount of lables without modifying the code. If I change it &quot;&lt;=&quot; i am getting one less."}, {"owner": {"reputation": 2323, "user_id": 245808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4895e2f0bd5e31186cc2fdbf14fa2b?s=128&d=identicon&r=PG", "display_name": "smelch", "link": "https://stackoverflow.com/users/245808/smelch"}, "reply_to_user": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444256256, "post_id": 33002312, "comment_id": 53831668, "body": "I don&#39;t see how that can be true. Are you sure you only made that change?"}, {"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444256544, "post_id": 33002312, "comment_id": 53831779, "body": "if i change the code the following code<code>for (int i = 0; i &lt; chars.Length -1; i++)</code> to <code>for (int i = 0; i &lt;= chars.Length -1; i++)</code> i get one less label"}, {"owner": {"reputation": 2323, "user_id": 245808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4895e2f0bd5e31186cc2fdbf14fa2b?s=128&d=identicon&r=PG", "display_name": "smelch", "link": "https://stackoverflow.com/users/245808/smelch"}, "reply_to_user": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444256872, "post_id": 33002312, "comment_id": 53831890, "body": "Generally speaking you should write it as for(int i=0; i &lt; chars.Length; i++) but the other form should be logically equivalent. Oh! your between might be wrong because you&#39;re subtracting 1 from the length. Try changing that line as well to be: int between = 330 / chars.Length; Using a debugger, you should look at the length of your labels list after that loop runs. You should have the same length as your word. If that is true, then the missing label is probably being placed incorrectly within the form (hence the suggestion to change the between calculation)."}, {"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444260104, "post_id": 33002312, "comment_id": 53832929, "body": "to be honest. I don&#39;t follow you completely. The initial problem was that there was an out of range error being created. Will any of these changes stop an out of range exception from occuring?"}, {"owner": {"reputation": 2323, "user_id": 245808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4895e2f0bd5e31186cc2fdbf14fa2b?s=128&d=identicon&r=PG", "display_name": "smelch", "link": "https://stackoverflow.com/users/245808/smelch"}, "reply_to_user": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444325572, "post_id": 33002312, "comment_id": 53867233, "body": "Yes. The initial suggestion of changing the conditions of your for loop in MakeLabels will fix the out of range exception. You are saying that when you do that you end up with one less label, which can&#39;t be true. So, your problem after your out of range exception was fixed is that there is some kind of behavior happening that makes you feel like you have one less label than you should. I promise you that if you made the change suggested in this answer you will not get the out of range exception anymore."}, {"owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "edited": false, "score": 0, "creation_date": 1444507101, "post_id": 33002312, "comment_id": 53936616, "body": "I tried that code for<code>(int i = 0; i &lt; chars.Length; i++)</code> like you said and I get an error message.I think the problem that is happening is that there are two arrays. One for <b>labels</b> and one for <b>letters</b>. They are supposed to be equal but they aren&#39;t for some reason. So i need to set them to the same value"}], "tags": [], "owner": {"reputation": 2323, "user_id": 245808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4895e2f0bd5e31186cc2fdbf14fa2b?s=128&d=identicon&r=PG", "display_name": "smelch", "link": "https://stackoverflow.com/users/245808/smelch"}, "is_accepted": false, "score": 2, "last_activity_date": 1444251543, "creation_date": 1444251543, "answer_id": 33002312, "question_id": 33000828, "link": "https://stackoverflow.com/questions/33000828/c-sharp-game-out-of-range-error/33002312#33002312", "title": "c# sharp game. out of range error", "body": "<p>When you are making your labels, you are missing the last one:</p>\n\n<pre><code>for(int i = 0; i &lt; chars.Length - 1; i++)\n    {\n        labels.Add(new Label());\n        labels[i].Location = new Point((i * between) + 10, 80);\n        labels[i].Text = \"_\";\n        labels[i].Parent = groupBox2;\n        labels[i].BringToFront();\n        labels[i].CreateControl();\n    }\n</code></pre>\n\n<p>The loop stops when i is less than one less than the length of the word. If you word is 6 characters long, your labels will stop at index 4 because 5 is not less than 6 - 1. Change it to &lt;= or just &lt; and drop the -1.</p>\n\n<p>When you loop through the labels to set the text to the letter, you are doing it correctly:</p>\n\n<pre><code>if (word.Contains(letter))\n    {\n        char[] letters = word.ToCharArray();\n        for (int i = 0; i &lt; letters.Length; i++)\n        {\n            if (letters[i] == letter)\n                labels[i].Text = letter.ToString();//Line gives out of rage error \n        }\n        foreach (Label l in labels)\n        if (l.Text == \"_\") return;\n        MessageBox.Show(\"You have won\", \"Congrats\");\n        ResetGame();\n    }\n</code></pre>\n\n<p>So, if your word is 6 letters long, when you guess the last letter in the word i will be 5, which you didn't create a label for, and it fails.</p>\n"}], "owner": {"reputation": 1, "user_id": 3495247, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1325394480/picture?type=large", "display_name": "user3495247", "link": "https://stackoverflow.com/users/3495247/user3495247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1444251827, "creation_date": 1444246122, "question_id": 33000828, "link": "https://stackoverflow.com/questions/33000828/c-sharp-game-out-of-range-error", "title": "c# sharp game. out of range error", "body": "<p>I am somewhat new to c#, and am getting an error message. I am trying to recreate a program that was posted on youtube at:\n<a href=\"https://www.youtube.com/watch?v=E8XQ9x-7yYk\" rel=\"nofollow\">https://www.youtube.com/watch?v=E8XQ9x-7yYk</a></p>\n\n<p>I seem to be running into some problems. It is saying that it is an out of range error. I've been trying different methods to fix the issue and I cant seem to do anything.</p>\n\n<pre><code>public partial class Form3 : Form\n{\n     public Form3()\n     {\n        InitializeComponent();\n    }\n    string word = \"\";\n    List&lt;Label&gt; labels = new List&lt;Label&gt;();\n    int amount = 0;\n\n    enum BodyParts\n    {\n        Head,\n        Left_Eye,\n        Right_Eye,\n        Mouth,\n        Right_Arm,\n        Left_Arm,\n        Body,\n        Left_Leg,\n        Right_Leg,\n\n    }\n    void drawhangpost()\n    {\n        Graphics g = panel1.CreateGraphics();\n        Pen p = new Pen(Color.Brown, 10);\n        g.DrawLine(p, new Point(130, 218), new Point(130, 5));\n        g.DrawLine(p, new Point(135, 5), new Point(65, 5));\n        g.DrawLine(p, new Point(60, 0), new Point(60, 50));\n        //DrawBodyPart(BodyParts.Head);//just for show\n        //DrawBodyPart(BodyParts.Left_Eye);\n        //DrawBodyPart(BodyParts.Right_Eye);\n        //DrawBodyPart(BodyParts.Mouth);\n        //DrawBodyPart(BodyParts.Right_Arm);\n        //DrawBodyPart(BodyParts.Left_Arm);\n        //DrawBodyPart(BodyParts.Body);\n        //DrawBodyPart(BodyParts.Left_Leg);\n        //DrawBodyPart(BodyParts.Right_Leg);\n        //MessageBox.Show(GetRandomWord());\n    }\n    void DrawBodyPart(BodyParts bp)\n    {\n        Graphics g = panel1.CreateGraphics();\n        Pen p = new Pen(Color.Blue, 2);\n        if (bp == BodyParts.Head)\n            g.DrawEllipse(p, 40, 50, 40, 40);\n        else if (bp == BodyParts.Left_Eye)\n        {\n            SolidBrush s = new SolidBrush(Color.Black);\n            g.FillEllipse(s, 50, 60, 5, 5);\n        }\n        else if (bp == BodyParts.Right_Eye)\n        {\n            SolidBrush s = new SolidBrush(Color.Black);\n            g.FillEllipse(s, 63, 60, 5, 5);\n        }\n        else if (bp == BodyParts.Mouth)\n        {\n            g.DrawArc(p, 50, 60, 20, 20, 45, 90);\n        }\n        else if (bp == BodyParts.Body)\n            g.DrawLine(p, new Point(60, 90), new Point(60, 170));\n        else if (bp == BodyParts.Left_Arm)\n            g.DrawLine(p, new Point(60, 100), new Point(30, 85));\n        else if (bp == BodyParts.Right_Arm)\n            g.DrawLine(p, new Point(60, 100), new Point(90, 85));\n        else if (bp == BodyParts.Left_Leg)\n            g.DrawLine(p, new Point(60, 170), new Point(30, 190));\n        else if (bp == BodyParts.Right_Leg)\n            g.DrawLine(p, new Point(60, 170), new Point(90, 190));\n    }\n    void MakeLables()\n    {\n        word = GetRandomWord();\n        char[] chars = word.ToCharArray();\n        int between = 330 / chars.Length - 1;\n        for(int i = 0; i &lt; chars.Length - 1; i++)\n        {\n            labels.Add(new Label());\n            labels[i].Location = new Point((i * between) + 10, 80);\n            labels[i].Text = \"_\";\n            labels[i].Parent = groupBox2;\n            labels[i].BringToFront();\n            labels[i].CreateControl();\n        }\n        label1.Text = \"Word Length: \" + (chars.Length - 1).ToString();\n    }\n    string GetRandomWord()\n    {\n        WebClient wc = new WebClient();\n        string wordList = wc.DownloadString(\"https://raw.githubusercontent.com/Tom25/Hangman/master/wordlist.txt\");\n        string[] words = wordList.Split('\\n');\n        Random ran = new Random();\n        return words[ran.Next(0, words.Length - 1)];\n    }\n    private void form3_shown(object sender, EventArgs e)\n    {\n        drawhangpost();\n        MakeLables();\n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        char letter = textBox1.Text.ToLower().ToCharArray()[0];\n        if (!char.IsLetter(letter))\n        {\n            MessageBox.Show(\"You can only submit letters.\", \"Error\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n            return;\n        }\n        if (word.Contains(letter))\n        {\n            char[] letters = word.ToCharArray();\n            for (int i = 0; i &lt; letters.Length; i++)\n            {\n                if (letters[i] == letter)\n                    labels[i].Text = letter.ToString();//Line gives out of rage error \n            }\n            foreach (Label l in labels)\n            if (l.Text == \"_\") return;\n            MessageBox.Show(\"You have won\", \"Congrats\");\n            ResetGame();\n        }\n        else\n        {\n            //MessageBox.Show(\"The letter you guessed is wrong\", \"Sorry\");\n            label2.Text += \" \" + letter.ToString() + \",\";\n            DrawBodyPart((BodyParts)amount);\n            amount++;\n            if (amount == 9)\n            {\n                MessageBox.Show(\"Sorry but you lost, the word was \" + word);\n                ResetGame();\n            }\n        }\n    }\n    void ResetGame()\n    {\n        amount = 0;// testing not sure\n        Graphics g = panel1.CreateGraphics();\n        g.Clear(panel1.BackColor);\n        GetRandomWord();\n        MakeLables();\n        drawhangpost();\n        label2.Text = \"Missed: \";\n        textBox1.Text = \"\";\n    }\n\n    private void button2_Click(object sender, EventArgs e)\n    {\n        if (textBox2.Text == word)\n        {\n            MessageBox.Show(\"You Have won\", \"Congrats\");\n            ResetGame();\n        }\n        else\n        {\n            MessageBox.Show(\"The word you guest was wrong\", \"Sorry\");\n            DrawBodyPart((BodyParts)amount);\n            amount++;\n            if (amount == 9)\n            {\n                MessageBox.Show(\"Sorry but you lost, the word was \" + word);\n                ResetGame();\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c#", "linq"], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 2048821, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/62e92642aa7c776eeb0af692f81c5664?s=128&d=identicon&r=PG", "display_name": "Mark Rabjohn", "link": "https://stackoverflow.com/users/2048821/mark-rabjohn"}, "edited": false, "score": 1, "creation_date": 1444246379, "post_id": 33000858, "comment_id": 53826571, "body": "Don&#39;t forget to use equals if the range is inclusive. Since it&#39;s very common to have an inclusive range start, you&#39;re almost sure to need &lt;= for the TicketNumberStart test."}, {"owner": {"reputation": 5, "user_id": 3225422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b989bff6b98f713aec3f780e463850?s=128&d=identicon&r=PG", "display_name": "Rick", "link": "https://stackoverflow.com/users/3225422/rick"}, "edited": false, "score": 0, "creation_date": 1444246486, "post_id": 33000858, "comment_id": 53826652, "body": "@D Stanley Okay thank you for the help.  That is my problem.  I guess I&#39;ve been staring at the code for too long and didn&#39;t see that."}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": true, "score": 2, "last_activity_date": 1444246424, "last_edit_date": 1444246424, "creation_date": 1444246233, "answer_id": 33000858, "question_id": 33000818, "link": "https://stackoverflow.com/questions/33000818/finding-if-value-is-between-two-columns-in-data-table/33000858#33000858", "title": "Finding if value is between two columns in data table", "body": "<p>I'm assuming that <code>TicketNumberEnd</code> is <em>more than</em> <code>TicketNumberStart</code>, in which case your condition will <em>never</em> be true.  I suspect you need to flip the comparisons:</p>\n\n<pre><code>var winner = from jnkDt in dt.AsEnumerable()\n    where\n    jnkDt.Field&lt;int&gt;(\"TicketNumberStart\") &lt;= rndNumber &amp;&amp;\n    jnkDt.Field&lt;int&gt;(\"TicketNumberEnd\") &gt;= rndNumber\n....\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>var winner = from jnkDt in dt.AsEnumerable()\n    where\n    rndNumber &gt;= jnkDt.Field&lt;int&gt;(\"TicketNumberStart\") &amp;&amp;\n    rndNumber &lt;= jnkDt.Field&lt;int&gt;(\"TicketNumberEnd\") \n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3225422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b989bff6b98f713aec3f780e463850?s=128&d=identicon&r=PG", "display_name": "Rick", "link": "https://stackoverflow.com/users/3225422/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 33000858, "answer_count": 1, "score": 0, "last_activity_date": 1444246470, "creation_date": 1444246090, "last_edit_date": 1444246470, "question_id": 33000818, "link": "https://stackoverflow.com/questions/33000818/finding-if-value-is-between-two-columns-in-data-table", "title": "Finding if value is between two columns in data table", "body": "<p>For the past week I have been searching for an answer to this  problem I am having and I cannot seem to find the answer.</p>\n\n<p>I have written a program to run a raffle for an online game I play.  The problem I have is that I need to remove duplicates from the drawing of the main prizes (new requirement).</p>\n\n<p>What I have now the database gets loaded into a DataTable and then I generate a random number and then I need to find where that random number falls between two columns in the DataTable, <code>TicketNumberStart</code> and <code>TicketNumberEnd</code>.  Here is what I am using for my LINQ right now.</p>\n\n<pre><code>var winner = from jnkDt in dt.AsEnumerable()\n    where\n    jnkDt.Field&lt;int&gt;(\"TicketNumberStart\") &gt; rndNumber &amp;&amp;\n    jnkDt.Field&lt;int&gt;(\"TicketNumberEnd\") &lt; rndNumber\n    select new\n    {\n        name = jnkDt.Field&lt;string&gt;(\"BuyerName\")\n    };\n    foreach (var jnk in winner)\n        tmpName = jnk.name.ToString();\n</code></pre>\n\n<p>The problem I am running into is that this returns a blank string no matter what the rndNumber is.</p>\n"}, {"tags": ["c#", "reflection"], "comments": [{"owner": {"reputation": 17932, "user_id": 16391, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8ff75049b31c4a05033be39792f1c2be?s=128&d=identicon&r=PG", "display_name": "StingyJack", "link": "https://stackoverflow.com/users/16391/stingyjack"}, "edited": false, "score": 0, "creation_date": 1444251729, "post_id": 33000762, "comment_id": 53829606, "body": "Take a look at System.Runtime.Caching.MemoryCache. You can put your constructed object away in the cache, using a cache key that identifies the both the application domain/clientrequestor and the object."}], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "edited": false, "score": 0, "creation_date": 1444252030, "post_id": 33002296, "comment_id": 53829738, "body": "Thank you for your answer. I tried to switch the value type in dictionary to MarshalByRefObject. Adding to dictionary still works fine, but when trying to retrieve the object using  <code>IsolatedClass isolatedClass = isolatedClassesList.First(x =&gt; x.Key == clientId).Value as IsolatedClass;</code>  it still throws an null refference exception. I will continue with testing the MemoryCache, as suggested by StingyJack."}, {"owner": {"reputation": 791, "user_id": 5414462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76885f3050514feabfed0269d5f5dda8?s=128&d=identicon&r=PG&f=1", "display_name": "Kentonbmax", "link": "https://stackoverflow.com/users/5414462/kentonbmax"}, "reply_to_user": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "edited": false, "score": 0, "creation_date": 1444254626, "post_id": 33002296, "comment_id": 53830982, "body": "See my revised solution."}, {"owner": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "edited": false, "score": 0, "creation_date": 1444255841, "post_id": 33002296, "comment_id": 53831486, "body": "Thank you, but it is still the same. The reason I need to identify it by clientId is that the main class is a WCF service class and thus, many clients can connect to it. The thing is, that Im pretty sure the key is present in the dictionary, I even checked it using breakpoints. The problem is, that the way Im storing <code>IsolatedClass</code> instance (or MarshalByRefObject from which my class inherits) is perhaps wrong, cause I can not retrieve the value back."}, {"owner": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "edited": false, "score": 0, "creation_date": 1444258986, "post_id": 33002296, "comment_id": 53832580, "body": "Ok, this is interesting - I tried again your way, but this time, I created simple dummy class - the only difference was, that my <code>IsolatedClass</code> was inheriting from <code>WhateverClass</code>, which was inheriting from MarshallByrRefObject. Now, with the new <code>DummyClass</code>, I tried to inherit from MarshalByRefObject directly and it seems to be working. I will procced with testing to identify, whether multi-level inheritance was the real issue or not."}, {"owner": {"reputation": 791, "user_id": 5414462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76885f3050514feabfed0269d5f5dda8?s=128&d=identicon&r=PG&f=1", "display_name": "Kentonbmax", "link": "https://stackoverflow.com/users/5414462/kentonbmax"}, "reply_to_user": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "edited": false, "score": 0, "creation_date": 1446127979, "post_id": 33002296, "comment_id": 54622899, "body": "You should always consider an alternative to multilevel inheritance since it is a direct violation of the &#39;O&#39; in SOLID."}], "tags": [], "owner": {"reputation": 791, "user_id": 5414462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76885f3050514feabfed0269d5f5dda8?s=128&d=identicon&r=PG&f=1", "display_name": "Kentonbmax", "link": "https://stackoverflow.com/users/5414462/kentonbmax"}, "is_accepted": true, "score": 1, "last_activity_date": 1444255061, "last_edit_date": 1444255061, "creation_date": 1444251494, "answer_id": 33002296, "question_id": 33000762, "link": "https://stackoverflow.com/questions/33000762/storing-instance-of-object-created-under-appdomain/33002296#33002296", "title": "Storing instance of object created under AppDomain", "body": "<p>I tried this and the only difference is that my class is inside of a different library. You can replace IsolatedClass with MarshalByRefObject as your value type in your dictionary if you have different class types you want to interact with. </p>\n\n<pre><code>var domain = AppDomain.CreateDomain(typeof(MyType).Assembly.FullName);\n\n                    var proxy = domain.CreateInstanceAndUnwrap(\n                        typeof(MyType).Assembly.FullName,\n                        typeof(MyType).FullName) as MyType;\n</code></pre>\n\n<p>UnhandledException and DomainUnload events inside of your IsolatedClass are a good way to dispose of any resources in your IsolatedClass when unloading your AppDomains. Also I recommend using 'as' instead of a direct cast this way you can check to see if the cast failed without throwing an InvalidCast Exception.</p>\n\n<p>Using .First is problematic because you are not guaranteed that the key exists and can therefore get back a null reference. If you know the clientId when you call Initialize why do you not know it when you call DoSomething? </p>\n\n<pre><code>if(_isolatedClassesList.ContainsKey(clientId)\n{\n    MyType mine = _isolatedClassesList[clientId] as MyType;\n    mine.MyMethod();\n}\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3576, "favorite_count": 0, "accepted_answer_id": 33002296, "answer_count": 1, "score": 0, "last_activity_date": 1444259244, "creation_date": 1444245884, "last_edit_date": 1444259244, "question_id": 33000762, "link": "https://stackoverflow.com/questions/33000762/storing-instance-of-object-created-under-appdomain", "title": "Storing instance of object created under AppDomain", "body": "<p>Iam trying to use AppDomains in order to isolate and run code in my application.\nWhat I need to do, is to create new AppDomain for each client and under that AppDomain, I need to create instance of another class which contains the code that needs to be isolated. I also need to somehow store that created instance, so that I can access it later when the same client that created it calls again. \nThe way Im creating it now is this:</p>\n\n<pre><code>private Dictionary&lt;string, IsolatedClass&gt; isolatedClassesList = new Dictionary&lt;string, IsolatedClass&gt;();\n\npublic void Initialize(string clientId)\n{\n    AppDomain appDomain = AppDomain.CreateDomain(\"New AppDomain\");\n\n    IsolatedClass isolatedClass = (IsolatedClass)appDomain.CreateInstanceAndUnwrap(Assembly.GetExecutingAssembly().FullName, typeof(IsolatedClass).FullName);\n\n    isolatedClass.Initialize(clientId);\n\n    isolatedClassesList.Add(clientId, isolatedClass);\n}\n</code></pre>\n\n<p>The creation of AppDomain and first call of \"<code>Initiliaze(clientId)</code>\" method works fine. Also storing it in the dictionary (for later use) is done without any exceptions.</p>\n\n<p>The problem occurs when I try to get the instance of previously created <code>IsolatedClass</code> later, like that:</p>\n\n<pre><code>public void DoSomething (string clientId)\n{\n    IsolatedClass isolatedClass = isolatedClassesList.First(x =&gt; x.Key == clientId).Value;\n\n    isolatedClass.RunIsolatedMethod();\n}\n</code></pre>\n\n<p>It throws null refference exception (it cannot retrieve the instance). When I put a breakpoint there and check what is inside the dictionary, for <code>Value</code>, it shows me that: \"Obtaining the runtime type of a transparent proxy is not supported in this context.\"</p>\n\n<p>Is this totally wrong approach or is there just some minor mistake?\nIf my approach is totally wrong, is there any other way how to achieve my goal?</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>Apparently, there was some issue with the <code>IsolatedClass</code> itself - it was inheriting from another class which was inheriting from MarshallByRefObject. When I created simple dummy class and procceded with instruction from Kentonbmax, it worked. \nI will continue testing to see, what was the real issue.</p>\n"}, {"tags": ["c#", "ibm-mq", "mq"], "answers": [{"tags": [], "owner": {"reputation": 2560, "user_id": 4454969, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zQkFQ.gif?s=128&g=1", "display_name": "ValerieLampkin", "link": "https://stackoverflow.com/users/4454969/valerielampkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1444305018, "creation_date": 1444305018, "answer_id": 33014962, "question_id": 33000754, "link": "https://stackoverflow.com/questions/33000754/ibm-mqlistener-not-automatically-remove-message-from-queue/33014962#33014962", "title": "IBM MQListener Not Automatically Remove Message From Queue", "body": "<p>You can browse the message to see if it is what you need and then do a GET if you determine it is.  GET is destructive and removes message from a queue, browse is not destructive but lets you examine contents. </p>\n\n<pre><code>openOptions = MQC.MQOO_BROWSE  // open queue for browsing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6263, "user_id": 1431734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ex16s.gif?s=128&g=1", "display_name": "Roger", "link": "https://stackoverflow.com/users/1431734/roger"}, "is_accepted": false, "score": 0, "last_activity_date": 1444403848, "creation_date": 1444403848, "answer_id": 33041866, "question_id": 33000754, "link": "https://stackoverflow.com/questions/33000754/ibm-mqlistener-not-automatically-remove-message-from-queue/33041866#33041866", "title": "IBM MQListener Not Automatically Remove Message From Queue", "body": "<p>It is far, far better to hand out queues like candy.  If there are 5 different types of schemas that could land in the original queue then you should just use 5 queues.<br>\ni.e.  </p>\n\n<ul>\n<li>ABC.SOMTHING.SHEMA.A  </li>\n<li>ABC.SOMTHING.SHEMA.B </li>\n<li>ABC.SOMTHING.SHEMA.C</li>\n<li>ABC.SOMTHING.SHEMA.D </li>\n<li>ABC.SOMTHING.SHEMA.E</li>\n</ul>\n\n<p>It will make for faster processing and you can have 1 listener for each queue.</p>\n"}], "owner": {"reputation": 709, "user_id": 5313605, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ef0fcbbded463b4ddfe2ddbcfcf6cd64?s=128&d=identicon&r=PG&f=1", "display_name": "nlstack01", "link": "https://stackoverflow.com/users/5313605/nlstack01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "accepted_answer_id": 33014962, "answer_count": 2, "score": 0, "last_activity_date": 1444403848, "creation_date": 1444245865, "last_edit_date": 1444308510, "question_id": 33000754, "link": "https://stackoverflow.com/questions/33000754/ibm-mqlistener-not-automatically-remove-message-from-queue", "title": "IBM MQListener Not Automatically Remove Message From Queue", "body": "<p>I am listening for messages from an IBM MQ using .Net. When it sees a message it removes the message from the queue automatically. I want to check the schema of the message first. If its not the correct schema I am looking for I want to keep it in the queue. </p>\n\n<p>How do I alter the code to not automatically remove the message from the queue when a message is found?</p>\n\n<pre><code> int openOptions = MQC.MQOO_INPUT_AS_Q_DEF | MQC.MQOO_FAIL_IF_QUIESCING;\n        IBM.WMQ.MQQueueManager mqManager = new IBM.WMQ.MQQueueManager(qmName);\n\n        MQQueue queue = mqManager.AccessQueue(queueName, openOptions);\n\n        MQGetMessageOptions gmo = new MQGetMessageOptions();\n        gmo.Options = MQC.MQGMO_FAIL_IF_QUIESCING | MQC.MQGMO_WAIT;\n        gmo.WaitInterval = MQC.MQWI_UNLIMITED;\n\n\n        queue.Get(message, gmo);\n\n        //Only remove message from the queue if a schema check of the message has passed\n</code></pre>\n"}, {"tags": ["c#", "mysql", "sql", "asp.net", "checkboxlist"], "comments": [{"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1444246447, "post_id": 33000730, "comment_id": 53826621, "body": "I dont understand the problem. Can you show some data of what is happening?"}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1444246538, "post_id": 33000730, "comment_id": 53826687, "body": "btw Why you open the connection inside the loop? would work better if you open connection once and execute all the commands and then close it?"}, {"owner": {"reputation": 145, "user_id": 5050225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49c31a4747736d198663ce94db07940f?s=128&d=identicon&r=PG&f=1", "display_name": "bds89", "link": "https://stackoverflow.com/users/5050225/bds89"}, "reply_to_user": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1444247175, "post_id": 33000730, "comment_id": 53827081, "body": "The problem is that every time the query is executed, it updates the row. So each time it updates the row, it is only updating it with one value and then when it is done with the loop, only the last value is in the SQL table. So instead of multiple values updated for a row, only one value has been updated."}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1444247899, "post_id": 33000730, "comment_id": 53827544, "body": "what is <code>&quot;UpdateProjectEntity&quot;</code>? If that is a storeproc you should include the code."}, {"owner": {"reputation": 145, "user_id": 5050225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49c31a4747736d198663ce94db07940f?s=128&d=identicon&r=PG&f=1", "display_name": "bds89", "link": "https://stackoverflow.com/users/5050225/bds89"}, "reply_to_user": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1444248528, "post_id": 33000730, "comment_id": 53827948, "body": "@JuanCarlosOropeza, I have added the query for the Stored Procedure."}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1444249088, "post_id": 33000730, "comment_id": 53828244, "body": "That looks ok. You only update a field. So if you update multiple time you will only get the last value. Maybe you should share some input data and desire result sample."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 5050225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49c31a4747736d198663ce94db07940f?s=128&d=identicon&r=PG&f=1", "display_name": "bds89", "link": "https://stackoverflow.com/users/5050225/bds89"}, "edited": false, "score": 0, "creation_date": 1444334566, "post_id": 33002635, "comment_id": 53872360, "body": "It will give an error if it is passed as a string since the stored procedure and the table is expecting an <code>INT</code>. I have tried with string in the past and forgot that it needs to be <code>INT</code>. There are a lot of tables in the DB that I am working with and my manager would not want more tables in it. I can do it but it is extra work."}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "reply_to_user": {"reputation": 145, "user_id": 5050225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49c31a4747736d198663ce94db07940f?s=128&d=identicon&r=PG&f=1", "display_name": "bds89", "link": "https://stackoverflow.com/users/5050225/bds89"}, "edited": false, "score": 0, "creation_date": 1444335374, "post_id": 33002635, "comment_id": 53872787, "body": "As I say, You wont be able to do solve it unless you change you structure. And I give you two options to do that. I will give you another <a href=\"http://stackoverflow.com/questions/17037446/get-multiple-selected-checkboxes-in-mvc\"><b>ONE</b></a> and <a href=\"http://stackoverflow.com/questions/11271249/multiple-checkboxes-to-select-and-save-values-in-database-table-c-sharp-mvc3\"><b>THIS</b></a>"}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "reply_to_user": {"reputation": 145, "user_id": 5050225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49c31a4747736d198663ce94db07940f?s=128&d=identicon&r=PG&f=1", "display_name": "bds89", "link": "https://stackoverflow.com/users/5050225/bds89"}, "edited": false, "score": 0, "creation_date": 1444340410, "post_id": 33002635, "comment_id": 53875118, "body": "I remember an <a href=\"http://stackoverflow.com/questions/32507413/tsql-for-filter-experice-from-range-multiselect/32508478#32508478\"><b>answer</b></a> i give last month. If you have very few check box you can save all options as an integer using bitwise operator."}], "tags": [], "owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "is_accepted": true, "score": 0, "last_activity_date": 1444252933, "creation_date": 1444252933, "answer_id": 33002635, "question_id": 33000730, "link": "https://stackoverflow.com/questions/33000730/update-multiple-checkboxlist-values-to-sql-db-asp-net-c/33002635#33002635", "title": "Update multiple checkboxlist values to SQL DB asp.net C#", "body": "<p>I can see you save your enity <code>INT</code>, maybe you should save it as a Comma Separated String.</p>\n\n<p>So instead of save 1, you can save <code>1,2,3</code></p>\n\n<p>Of course you will have to add some logic before the save building and concat the string. And also need to do some parsing when you read from db doing the split by <code>,</code></p>\n\n<p>The other aproach is creating a relation table to indicate with are the options selected.</p>\n\n<p>But this is also have problem when you remove a selection and add new ones.</p>\n\n<pre><code>ProjectID   CorpID\n   1          1\n   1          2\n   1          3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 5050225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49c31a4747736d198663ce94db07940f?s=128&d=identicon&r=PG&f=1", "display_name": "bds89", "link": "https://stackoverflow.com/users/5050225/bds89"}, "is_accepted": false, "score": 0, "last_activity_date": 1444676222, "creation_date": 1444676222, "answer_id": 33088298, "question_id": 33000730, "link": "https://stackoverflow.com/questions/33000730/update-multiple-checkboxlist-values-to-sql-db-asp-net-c/33088298#33088298", "title": "Update multiple checkboxlist values to SQL DB asp.net C#", "body": "<p>The way I resolved this without making any changes to the DB is I used a DELETE Statement to delete the rows with the ProjectID and then I used an insert stored procedure that I have used before. It was a lot faster than creating another table among all that is already in place. So the code looks like this</p>\n\n<pre><code>for (int i = 0; i &lt; cbAvailableEntities.Items.Count - 1; i++) {\nSqlConnection connection = new SqlConnection(connString);\nSqlCommand com = new SqlCommand(\"InsertProjectEntity\", connection);\nSqlCommand dcm = new SqlCommand();\n\nusing(connection) {\n    //First time going through the loop, i = 0 is true.\n    if (i == 0) {\n        connection.Open();\n        using(com) {\n            //This will remove anything in the DB related to the ProjectID being edited.\n            dcm.Connection = connection;\n            dcm.CommandText = \"DELETE FROM [dbo].[ProjectEntity] WHERE ProjectID = \" + _pID;\n            dcm.ExecuteNonQuery();\n            //This will insert all items checked in the checkboxlist but will not insert the unchecked.\n            if (cbAvailableEntities.Items[i].Selected) {\n                com.CommandType = CommandType.StoredProcedure;\n                SqlParameter paramPID = new SqlParameter(\"@ProjectID\", nr.ProjectID);\n                com.Parameters.Add(paramPID);\n                nr.Entities = cbAvailableEntities.Items[i].Value;\n                com.Parameters.AddWithValue(\"@CorpID\", nr.Entities);\n                com.ExecuteNonQuery();\n            }\n\n        }\n    } else {\n        connection.Open();\n        using(com) {\n            //This will insert all items checked in the checkboxlist but will not insert the unchecked.\n            if (cbAvailableEntities.Items[i].Selected) {\n                com.CommandType = CommandType.StoredProcedure;\n                SqlParameter paramPID = new SqlParameter(\"@ProjectID\", nr.ProjectID);\n                com.Parameters.Add(paramPID);\n                nr.Entities = cbAvailableEntities.Items[i].Value;\n                com.Parameters.AddWithValue(\"@CorpID\", nr.Entities);\n                com.ExecuteNonQuery();\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 5050225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49c31a4747736d198663ce94db07940f?s=128&d=identicon&r=PG&f=1", "display_name": "bds89", "link": "https://stackoverflow.com/users/5050225/bds89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "accepted_answer_id": 33002635, "answer_count": 2, "score": 0, "last_activity_date": 1444676222, "creation_date": 1444245754, "last_edit_date": 1444251241, "question_id": 33000730, "link": "https://stackoverflow.com/questions/33000730/update-multiple-checkboxlist-values-to-sql-db-asp-net-c", "title": "Update multiple checkboxlist values to SQL DB asp.net C#", "body": "<p>I am updating a row in SQL DB using the code below. The loop works and it updates the row but the problem is that each time it goes through the loop, it only updates one value and the other values are overwritten. So at the end, it has updated but instead of multiple values being inputted to the table for the respective Project ID, it only puts one value for the respective Project ID. I am not receiving any errors for this. Any help is much appreciated.</p>\n\n<pre><code>for (int i = 0; i &lt; cbAvailableEntities.Items.Count - 1; i++)\n{\n    SqlConnection connection = new SqlConnection(connString);\n    SqlCommand cmd = new SqlCommand(\"UpdateProjectEntity\", connection);\n\n    using (connection)\n    {\n        connection.Open();\n        using (cmd)\n        {\n           if (cbAvailableEntities.Items[i].Selected)\n            {\n               cmd.CommandType = CommandType.StoredProcedure;\n                //the following is the Project ID for the row being updated.\n               SqlParameter paramPID = new SqlParameter(\"@ProjectID\", nr.ProjectID);\n               cmd.Parameters.Add(paramPID);\n               nr.Entities = cbAvailableEntities.Items[i].Value;\n               cmd.Parameters.AddWithValue(\"@CorpID\", nr.Entities);\n               cmd.ExecuteNonQuery();\n           }\n        }\n    }\n}\n</code></pre>\n\n<p>Here is the SQL query for the Stored Procedure <code>\"UpdateProjectEntity\"</code></p>\n\n<pre><code>ALTER PROCEDURE [dbo].[UpdateProjectEntity]\n    @ProjectID int,\n    @CorpID int\nAS\nBEGIN\n    UPDATE [dbo].[ProjectEntity]\n    SET\n           [CorpID] = @CorpID\n     WHERE\n           ProjectID = @ProjectID\nEND\n</code></pre>\n\n<p>Here are screenshots of inputs and results when I run the program.\n<a href=\"http://i.stack.imgur.com/6lsy0.png\" rel=\"nofollow\">These are the checkboxes I am saving to the DB</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/ZF346.png\" rel=\"nofollow\">This is the result after I have saved to the DB</a></p>\n\n<p>I changed the date to show that everything else works in this program.</p>\n"}, {"tags": ["c#", "opos"], "comments": [{"owner": {"reputation": 420, "user_id": 2344556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be24566806155ae1a7f551b5f7f17a28?s=128&d=identicon&r=PG", "display_name": "Josh Anderson", "link": "https://stackoverflow.com/users/2344556/josh-anderson"}, "edited": false, "score": 0, "creation_date": 1444256805, "post_id": 33000640, "comment_id": 53831864, "body": "The drawer and printer are separate devices, you shouldn&#39;t need to open/claim the printer in order to use the drawer. Also, if you haven&#39;t already, try installing the common control objects (located here: <a href=\"http://monroecs.com/oposccos_current.htm\" rel=\"nofollow noreferrer\">monroecs.com/oposccos_current.htm</a>)."}, {"owner": {"reputation": 7217, "user_id": 475766, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Pm674.jpg?s=128&g=1", "display_name": "Ortund", "link": "https://stackoverflow.com/users/475766/ortund"}, "reply_to_user": {"reputation": 420, "user_id": 2344556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be24566806155ae1a7f551b5f7f17a28?s=128&d=identicon&r=PG", "display_name": "Josh Anderson", "link": "https://stackoverflow.com/users/2344556/josh-anderson"}, "edited": false, "score": 0, "creation_date": 1444257092, "post_id": 33000640, "comment_id": 53831971, "body": "@JoshAnderson just to be clear, you are aware that the cash drawer doesn&#39;t connect to the pc, but instead to the printer, right? Because I&#39;m still getting the 109 error code"}, {"owner": {"reputation": 420, "user_id": 2344556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be24566806155ae1a7f551b5f7f17a28?s=128&d=identicon&r=PG", "display_name": "Josh Anderson", "link": "https://stackoverflow.com/users/2344556/josh-anderson"}, "edited": false, "score": 0, "creation_date": 1444258128, "post_id": 33000640, "comment_id": 53832277, "body": "I&#39;m aware, those cash drawers can be pesky. Just seeing your latest edit, I thought you were using Microsoft&#39;s POS for .Net instead of directly using the common control classes. I&#39;m less familiar with them, but is there a method to enumerate through every installed device of a particular type just to see if it shows up? It could also be that the _drawer.Open() method expects a service object name, rather than the logical device name."}, {"owner": {"reputation": 7217, "user_id": 475766, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Pm674.jpg?s=128&g=1", "display_name": "Ortund", "link": "https://stackoverflow.com/users/475766/ortund"}, "reply_to_user": {"reputation": 420, "user_id": 2344556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be24566806155ae1a7f551b5f7f17a28?s=128&d=identicon&r=PG", "display_name": "Josh Anderson", "link": "https://stackoverflow.com/users/2344556/josh-anderson"}, "edited": false, "score": 0, "creation_date": 1444295334, "post_id": 33000640, "comment_id": 53846277, "body": "Doesn&#39;t look like there&#39;s a method in the OPOSCashDrawerClass for that"}], "answers": [{"comments": [{"owner": {"reputation": 7217, "user_id": 475766, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Pm674.jpg?s=128&g=1", "display_name": "Ortund", "link": "https://stackoverflow.com/users/475766/ortund"}, "edited": false, "score": 1, "creation_date": 1444591066, "post_id": 33048690, "comment_id": 53956328, "body": "While this is a valid point, the reason the cash drawer couldn&#39;t open was because I needed a specific driver for the cash drawer. Once I got that, the code worked (after I targeted the correct device in the .Open() method."}], "tags": [], "owner": {"reputation": 1, "user_id": 5340007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78ececa8e295d2cf9c417892ba121dc6?s=128&d=identicon&r=PG&f=1", "display_name": "zachz", "link": "https://stackoverflow.com/users/5340007/zachz"}, "is_accepted": false, "score": 0, "last_activity_date": 1444434435, "creation_date": 1444434435, "answer_id": 33048690, "question_id": 33000640, "link": "https://stackoverflow.com/questions/33000640/why-cant-opos-find-my-cash-drawer-using-common-controls/33048690#33048690", "title": "Why can&#39;t opos find my cash drawer using common controls?", "body": "<p>Your screenshot shows that the cashdrawer LDN is \"rp-cashdrawer\", but your code is using \"rpd\".</p>\n\n<pre><code>drawer.Open(\"rpd\");\n</code></pre>\n\n<p>You should be opening the device with a configured LDN, like:</p>\n\n<pre><code>drawer.Open(\"rp-cashdrawer\");\n</code></pre>\n"}], "owner": {"reputation": 7217, "user_id": 475766, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/Pm674.jpg?s=128&g=1", "display_name": "Ortund", "link": "https://stackoverflow.com/users/475766/ortund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3276, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444434435, "creation_date": 1444245397, "last_edit_date": 1495541670, "question_id": 33000640, "link": "https://stackoverflow.com/questions/33000640/why-cant-opos-find-my-cash-drawer-using-common-controls", "title": "Why can&#39;t opos find my cash drawer using common controls?", "body": "<p>In much the same way as <a href=\"https://stackoverflow.com/questions/16101966/error-fails-to-open-device-when-using-esc-opos-from-vb6\">this guy was having a problem</a>, I'm having a similar problem...</p>\n\n<p>My cashdrawer connects to the pc via an RJ11 (I think its 11 anyway...) connection to my printer which is a <code>Partner RP-600 Thermal Printer</code>.</p>\n\n<p>I've got the printer working well, but I can't get the cash drawer to open.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PhhfL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PhhfL.png\" alt=\"opos cash drawer config\"></a></p>\n\n<p>Basically my thinking on how this should work (based on my limited understanding is this:</p>\n\n<ol>\n<li>Open printer  </li>\n<li>Claim printer</li>\n<li>Enable printer</li>\n<li>Open cash drawer</li>\n<li>Claim cash drawer</li>\n<li>Enable cash drawer</li>\n<li>Open hardware drawer</li>\n</ol>\n\n<p>I've tried this a number of ways and I get the following errors:</p>\n\n<blockquote>\n  <p>OPOS_E_CLOSED = 101, but most commonly<br>\n  OPOS_E_NOEXIST = 109</p>\n</blockquote>\n\n<p>If I set it to <code>drawer.Open(\"rp-600 printer\")</code>, I get <code>OPOS_E_ILLEGAL = 106</code></p>\n\n<p>My code follows:</p>\n\n<pre><code>    using OPOSCONSTANTSLib;\n    using System;\n    using System.Collections.Generic;\n    using System.ComponentModel;\n    using System.Data;\n    using System.Drawing;\n    using System.Linq;\n    using System.Text;\n    using System.Windows.Forms;\n    using OposPOSPrinter_CCO;\n    using OposCashDrawer_CCO;\n\n    namespace PosPrinterTest\n    {\n        public partial class Form1 : Form\n        {\n        private OPOSPOSPrinterClass printer = null;\n        private OPOSCashDrawerClass drawer = null;\n        public Form1()\n        {\n            InitializeComponent();\n\n            printer = new OPOSPOSPrinterClass();\n            drawer = new OPOSCashDrawerClass();\n\n            _IOPOSPOSPrinterEvents_StatusUpdateEventEventHandler SUEH =\n                new _IOPOSPOSPrinterEvents_StatusUpdateEventEventHandler(\n                    PrinterStatusUpdateHandler);\n            printer.StatusUpdateEvent += SUEH;\n\n            _IOPOSCashDrawerEvents_StatusUpdateEventEventHandler DSUEH = new _IOPOSCashDrawerEvents_StatusUpdateEventEventHandler(CashDrawerStatusUpdateHandler);\n            drawer.StatusUpdateEvent += DSUEH;\n        }\n\n        private void AddList(object listline)\n        {\n            listBox1.Items.Add(listline);\n            listBox1.SelectedIndex = listBox1.Items.Count - 1;\n        }\n\n        private void OpenCashDrawer()\n        {\n            AddList(\"+Open drawer\");\n\n            int Result = drawer.Open(\"rpd\");\n            AddList(String.Format(\"  1-Open drawer: RC = {0}\", Result));\n            Result = drawer.ClaimDevice(1000);\n            AddList(String.Format(\"  2-Claim drawer: RC = {0}\", Result));\n            drawer.DeviceEnabled = true;\n            Result = drawer.ResultCode;\n            AddList(String.Format(\"  3-Enable drawer: RC = {0}\", Result));\n            Result = drawer.OpenDrawer();\n            AddList(String.Format(\"  4-Open drawer: RC = {0}\", Result));\n\n            AddList(String.Format(\"-Open drawer: {0}\", ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\")));\n            AddList(String.Empty);\n        }\n\n        private void CloseCashDrawer()\n        {\n            AddList(\"+Close drawer\");\n\n            int Result = drawer.ReleaseDevice();\n            AddList(String.Format(\"  Release drawer: RC = {0}\", Result));\n            AddList(\"-Release drawer: \" + ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\"));\n\n            Result = drawer.Close();\n            AddList(String.Format(\"  Close drawer: RC = {0}\", Result));\n            AddList(\"-Close drawer: \" + ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\"));\n            AddList(String.Empty);\n        }\n\n        private void Print()\n        {\n            AddList(\"+Print\");\n\n            int Result = printer.PrintNormal(2, \"\\x1B|cA\\x1B|2COPOS POSPrinter\\x1B|1C\\nvia Microsoft.NET\\n\\n\");\n\n            AddList(String.Format(\"  Print: BC = {0}\", Result));\n            AddList(String.Format(\"-Print: {0}\", ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\")));\n\n            Result = printer.CutPaper(100);\n            AddList(String.Format(\"  Cut: BC = {0}\", Result));\n            AddList(String.Format(\"-Cut: {0}\", ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\")));\n            AddList(String.Empty);\n        }\n\n        private void OpenPrinter()\n        {\n            AddList(\"+Open printer\");\n\n            int Result = printer.Open(\"rp-600 printer\");\n            AddList(String.Format(\"  Open: RC = {0}\", Result));\n\n            if (Result == (int)OPOS_Constants.OPOS_SUCCESS)\n            {\n                Result = printer.ClaimDevice(1000);\n                AddList(String.Format(\"  Claim printer: RC = {0}\", Result));\n\n                if (Result == (int)OPOS_Constants.OPOS_SUCCESS)\n                {\n                    printer.DeviceEnabled = true;\n                    Result = printer.ResultCode;\n                    AddList(String.Format(\"  Enable printer: RC = {0}&gt;\", Result));\n                }\n            }\n            AddList(String.Format(\"-Open: {0}\", ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\")));\n            AddList(String.Empty);\n        }\n\n        private void ClosePrinter()\n        {\n            AddList(\"+Close printer\");\n\n            int Result = printer.ReleaseDevice();\n            AddList(String.Format(\"  Release printer: RC = {0}\", Result));\n            AddList(\"-Release printer: \" + ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\"));\n\n            Result = printer.Close();\n            AddList(String.Format(\"  Close printer: RC = {0}\", Result));\n            AddList(\"-Close printer: \" + ((Result == (int)OPOS_Constants.OPOS_SUCCESS) ? \"Succeeded\" : \"Failed\"));\n            AddList(String.Empty);\n        }\n\n        private void PrinterStatusUpdateHandler(int nStatus)\n        {\n            AddList(\"  P StatusUpdate: \" + nStatus);\n        }\n\n        private void CashDrawerStatusUpdateHandler(int nStatus)\n        {\n            AddList(String.Format(\"  CD Status Update: {0}\", nStatus));\n        }\n\n        private void btnTender_Click_1(object sender, EventArgs e)\n        {\n            //OpenPrinter();\n            //Print();\n            //ClosePrinter();\n\n            OpenCashDrawer();\n            CloseCashDrawer();\n        }\n    }\n}\n</code></pre>\n\n<p>As you can see, the device name I'm specifying in OpenCashDrawer() is the same as the device name I set in opos.</p>\n\n<p>So what am I doing wrong that's preventing opos from finding the cash drawer?</p>\n"}, {"tags": ["c#", "timer", "stopwatch"], "comments": [{"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1444246253, "post_id": 33000567, "comment_id": 53826502, "body": "This is a bit too dense for me to analyse now (kind of tired and without too much time :)), but I can write a couple of quick remarks. Firstly, your statement &quot;it ticks at somewhere between 100 ms and about 115 ms... I might end up finishing over three hours late&quot; is quite misleading. By assuming that this information is right, it would mean that each tick might have a maximum delay of 15 ms; but these delays might either not happen or compensate among them (faster than 100 ms?!). Thus after hours or days, the average delay of all the ticks might be even zero (very unlikely though)..."}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1444246264, "post_id": 33000567, "comment_id": 53826507, "body": "... On the other hand, when dealing with so small intervals everything counts (the hardware/software of your computer, what is being run on your computer, the way in which your application is being executed, etc.); even the order in which the elapsed times of the different variables are being measured might affect the results. In any case, thanks for sharing your thoughts on this matter; I look forward to taking a closer look at your code at other point."}, {"owner": {"reputation": 448, "user_id": 2460534, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/14d0bc0413793f3145a2bfa4d920b968?s=128&d=identicon&r=PG", "display_name": "kvermeer", "link": "https://stackoverflow.com/users/2460534/kvermeer"}, "reply_to_user": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1444246654, "post_id": 33000567, "comment_id": 53826767, "body": "@varocarbas - I also assumed initially that the average delay would be zero, and that the result would either be approximately correct, or lie in a distribution about the correct value.  However, this is incorrect, the Timer class guarantees that the time between calls will be <i>greater than or equal to the target interval.</i>  In practice, as you can see above, it&#39;s about 8.4 ms per tick slow all the time!"}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1444246946, "post_id": 33000567, "comment_id": 53826945, "body": "As said, I will take a proper look at all this at other point (= tomorrow) and will share my impressions then"}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 1, "creation_date": 1444247011, "post_id": 33000567, "comment_id": 53826980, "body": "You may want to take a look at Reactive Extensions and the timers it provides (<code>Observable.Timer</code>). A lot of clever code went into this to ensure the timers are useful in this kind of scenario (firing on absolute times or with reliable intervals). See, for example, <a href=\"http://stackoverflow.com/questions/13838113/observable-timer-how-to-avoid-timer-drift\" title=\"observable timer how to avoid timer drift\">stackoverflow.com/questions/13838113/&hellip;</a>. (Rx has quite a steep learning curve if you&#39;ve never seen it before, though.)"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1444276751, "post_id": 33000567, "comment_id": 53837173, "body": "There are a lot of <i>possible</i> questions in your post. Could you please identify what the <i>actual</i> question is? I&#39;m having a hard time understanding what it is you actually want help with. As you already know, Windows won&#39;t give you precise timings. You&#39;ve already implemented a suitable work-around for ensuring accurate <i>average</i> timer behavior. Given that thread scheduling can be off as much as ~50ms, that you get only 15ms of jitter seems pretty reasonable. If you want more accurate timing, you need to use Windows&#39; multimedia timers, which are not exposed by .NET (i.e. you need p/invoke)."}, {"owner": {"reputation": 448, "user_id": 2460534, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/14d0bc0413793f3145a2bfa4d920b968?s=128&d=identicon&r=PG", "display_name": "kvermeer", "link": "https://stackoverflow.com/users/2460534/kvermeer"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1444306201, "post_id": 33000567, "comment_id": 53853716, "body": "@Peter - Sorry, there is a lot to digest.  My end goal is stated in the title, so if there&#39;s another way to get long term accuracy with smooth intervals, that would be great.  At the same time, I&#39;ve got a long-term accurate solution, but it&#39;s not smooth - help improving the algorithm is what I&#39;m really looking for."}, {"owner": {"reputation": 448, "user_id": 2460534, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/14d0bc0413793f3145a2bfa4d920b968?s=128&d=identicon&r=PG", "display_name": "kvermeer", "link": "https://stackoverflow.com/users/2460534/kvermeer"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1444306387, "post_id": 33000567, "comment_id": 53853849, "body": "@Jeroen - Reactive Extensions looks great!  I&#39;ve never seen it before, but I&#39;ll see if I can wrap my head around it.  Thanks for the link and Googleable name!"}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1444311962, "post_id": 33000567, "comment_id": 53858217, "body": "I have done some tests with your code and even tried different alternatives; and have to recognise that wasn&#39;t expecting to see so big (and constantly-increasing) differences. In any case, the proposed conditions represent an extreme case which can even be considered outside the truly-speaking scope of application of timers. In summary: the surprising (at least, to me) results should be as the logical consequence of bringing something to its extreme limits; that is: something to be avoided no matter what."}, {"owner": {"reputation": 448, "user_id": 2460534, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/14d0bc0413793f3145a2bfa4d920b968?s=128&d=identicon&r=PG", "display_name": "kvermeer", "link": "https://stackoverflow.com/users/2460534/kvermeer"}, "reply_to_user": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1444312132, "post_id": 33000567, "comment_id": 53858370, "body": "@varocarbas - thanks for trying it out! I&#39;m not sure that I understand what you&#39;re saying - did you see the stopwatch-compensated timer showing differences in the elapsed time?  Or were you surprised at the inaccuracy of the stock timer?"}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1444312228, "post_id": 33000567, "comment_id": 53858442, "body": "I was surprised by the accumulated delay in the tick events. I tried different alternatives and varied the conditions; but the differences (between the actual timer tick and the real elapsed time) did remain surprisingly high. But as said... ticking a timer each 100 ms for too long is not the way in which it is supposed to be used (= that&#39;s why its not too reliable behaviour). Regarding your correction, it seems fine. Perhaps you should account for some of the Hans Passant&#39;s suggestions too."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1444318413, "post_id": 33000567, "comment_id": 53863168, "body": "<i>&quot;if there&#39;s another way to get long term accuracy with smooth intervals&quot;</i> -- you state at the outset that you understand Windows is not a real-time OS. Well, it&#39;s not. And the fact that it&#39;s not precludes the possibility of &quot;smooth intervals&quot;. The best answer you could hope for is to use the multimedia timers, but a real answer actually providing full details on that topic would be too broad. You should research that yourself and ask for help with <i>specific</i> issues if they arise."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "reply_to_user": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 1, "creation_date": 1444318511, "post_id": 33000567, "comment_id": 53863240, "body": "@varocarbas: <i>&quot;wasn&#39;t expecting to see so big (and constantly-increasing) differences&quot;</i> -- that&#39;s completely expected, given the promise any of the timers provide: to be signaled <b>no sooner than</b> the stated interval, but without a guarantee of being signaled precisely <b>on</b> the interval. I.e. the timer can only ever be later, and so all errors are in the positive direction, and so over time the timer will only ever become later and later."}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1444320831, "post_id": 33000567, "comment_id": 53864682, "body": "@PeterDuniho As explained above, I never thought too much about this (equivalently to what I do with any other situation which might be considered as not-practical enough/beyond the application scope of the given object), neither I think that this is relevant in any way as far as these conditions shouldn&#39;t ever be attempted (timers weren&#39;t created to be used in this way). Timers have always been on time (under my expectations) when I have used them; and that&#39;s why so big delays (and always delays, with no compensation) were intuitively weird to me. That was the whole point of my comment."}], "answers": [{"comments": [{"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 1, "creation_date": 1444305774, "post_id": 33010863, "comment_id": 53853383, "body": "Your comment on 15.6 msec and using <code>timeBeginPeriod</code> is slightly out of date -- beginning with Windows 8, there&#39;s the <code>GetSystemTimePreciseAsFileTime</code> function, which gives high accuracy system times without the need for mucking about with the multimedia timer functions. NTP makes good use of this. (<code>DateTime</code> doesn&#39;t use it, however.)"}, {"owner": {"reputation": 448, "user_id": 2460534, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/14d0bc0413793f3145a2bfa4d920b968?s=128&d=identicon&r=PG", "display_name": "kvermeer", "link": "https://stackoverflow.com/users/2460534/kvermeer"}, "edited": false, "score": 0, "creation_date": 1444306640, "post_id": 33010863, "comment_id": 53854025, "body": "@Hans - I don&#39;t have hope it will run instantly, I just want it to be eventually correct.  I care about actual elapsed time, but I&#39;m working with external hardware that needs to make sure each event in a very long sequence happens for as close to 100 ms as can be provided within the acknowledged limitations, and I can&#39;t skip events.  And lastly, I&#39;m not burning core in a loop, I&#39;m using a timer WITH a stopwatch that doesn&#39;t seem to diverge from elapsed wall clock time, and looking for ways to make it better."}, {"owner": {"reputation": 448, "user_id": 2460534, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/14d0bc0413793f3145a2bfa4d920b968?s=128&d=identicon&r=PG", "display_name": "kvermeer", "link": "https://stackoverflow.com/users/2460534/kvermeer"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1444306748, "post_id": 33010863, "comment_id": 53854083, "body": "@Jeroen - That would be great, but I&#39;m still on Windows 7.  Looking at moving up to 10 soon, though!"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1444307136, "post_id": 33010863, "comment_id": 53854341, "body": "In spite of Jeroen&#39;s comment, you really are asking for the multi-media timer.  It makes an effort to &quot;catch-up&quot; when it falls behind.  Within reasonable limits of course.  You&#39;ll have to pinvoke timeSetEvent().  Realistically, &quot;external hardware&quot; ought to use a driver to get a service guarantee."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1444309387, "post_id": 33010863, "comment_id": 53856158, "body": "My comment was a footnote on the precision (not accuracy, sorry about that) of the system time, not a refutation. Whether or not you&#39;re using a multimedia timer is orthogonal to that. The idea that you must use <code>timeBeginPeriod</code> to be able to obtain precise system time is outdated on newer Windows, that&#39;s all. Accuracy is a different kettle of fish."}], "tags": [], "owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": false, "score": 2, "last_activity_date": 1444308585, "last_edit_date": 1444308585, "creation_date": 1444293991, "answer_id": 33010863, "question_id": 33000567, "link": "https://stackoverflow.com/questions/33000567/combining-a-stopwatch-and-timer-to-get-long-term-accurate-events-with-smooth-coe/33010863#33010863", "title": "Combining a Stopwatch and Timer to get long-term accurate events with smooth coercion", "body": "<blockquote>\n  <p>Windows is not a real-time OS</p>\n</blockquote>\n\n<p>More accurately, code that runs in ring 3 on a protected mode demand-paged virtual memory operating system cannot assume it can provide any execution guarantees.  Something as simple as a page fault can greatly delay code execution.  Plenty more like that, a gen #2 garbage collection is always around to ruin your expectations.  Ring 0 code (drivers) generally has excellent interrupt response times, modulo a crappy video driver that cheats on its benchmarks.</p>\n\n<p>So no, hoping that code activated by a Timer will run <em>instantly</em> is idle hope in general.  There will always be a delay.  A DispatcherTimer or Winforms Timer can only tick when the UI thread is idle, an asynchronous timer needs to compete with all the other threadpool requests as well as threads owned by other processes that compete for the processor.</p>\n\n<p>So one thing you <strong>never</strong> want to do is increment an elapsed time counter in the event handler or callback.  It will quickly diverge from elapsed wall clock time.  In a completely unpredictable way, the heavier the machine is loaded the more it falls behind.</p>\n\n<p>Workaround is simple, if you care about actual elapsed time then use the clock.  Either DateTime.UtcNow or Environment.TickCount, there's no fundamental difference between the two.  Store the value in variable when you start the timer, subtract it in the event or callback to know the actual elapsed time.  It is highly precise over long periods, accuracy is limited by the clock update rate.  Which by default is 64 times per second (15.6 msec), it can be jacked up by pinvoking <a href=\"http://pinvoke.net/default.aspx/winmm/timeBeginPeriod.html\" rel=\"nofollow\">timeBeginPeriod()</a>.  Do so conservatively, it is bad for power consumption.</p>\n\n<p>Stopwatch has opposite characteristics, it is highly accurate but not precise.  It is not calibrated to an atomic clock like DateTime.UtcNow and Environment.TickCount.  And is entirely useless to generate events, burning core in a loop to detect elapsed time will get your thread put in the dog house for a while after it burned through its quantum.  Only use it for ad hoc profiling.</p>\n"}], "owner": {"reputation": 448, "user_id": 2460534, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/14d0bc0413793f3145a2bfa4d920b968?s=128&d=identicon&r=PG", "display_name": "kvermeer", "link": "https://stackoverflow.com/users/2460534/kvermeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444308585, "creation_date": 1444245161, "last_edit_date": 1444275616, "question_id": 33000567, "link": "https://stackoverflow.com/questions/33000567/combining-a-stopwatch-and-timer-to-get-long-term-accurate-events-with-smooth-coe", "title": "Combining a Stopwatch and Timer to get long-term accurate events with smooth coercion", "body": "<p>First, let me say that I understand that Windows is not a real-time OS.  I do not expect any given timer interval to be accurate to better than 15 ms.  However, it is important to me that the sum of my timer ticks be accurate in the long term, which is not possible with the stock timers or the stopwatch.  </p>\n\n<p>If a normal System.Timers.Timer (or, worse yet, a Windows.Forms.Timer) is configured to run every 100 ms, it ticks at somewhere between 100 ms and about 115 ms.  This means that if I need to do the event for one day, 10 * 60 * 60 * 24 = 864,000 times, I might end up finishing over three hours late!  This is not acceptable for my application.</p>\n\n<p>How can I best construct a timer for which the average duration is accurate?  I have built one, but I think it could be smoother, more effective, or...there just has to be a better way.  Why would .NET provide a low-accuracy DateTime.Now, a low-accuracy Timer, and a high-accuracy Diagnostics.Stopwatch, but no high-accuracy timer?</p>\n\n<p>I wrote the following timer update routine:</p>\n\n<pre><code>var CorrectiveStopwatch = new System.Diagnostics.Stopwatch();\nvar CorrectedTimer = new System.Timers.Timer()\n{\n    Interval = targetInterval,\n    AutoReset = true,\n};\nCorrectedTimer.Elapsed += (o, e) =&gt;\n{\n    var actualMilliseconds = ; \n\n    // Adjust the next tick so that it's accurate\n    // EG: Stopwatch says we're at 2015 ms, we should be at 2000 ms\n    // 2000 + 100 - 2015 = 85 and should trigger at the right time\n    var newInterval = StopwatchCorrectedElapsedMilliseconds + \n                      targetInterval -\n                       CorrectiveStopwatch.ElapsedMilliseconds;\n\n    // If we're over 1 target interval too slow, trigger ASAP!\n    if (newInterval &lt;= 0)\n    {\n        newInterval = 1; \n    }\n\n    CorrectedTimer.Interval = newInterval;\n\n    StopwatchCorrectedElapsedMilliseconds += targetInterval;\n};\n</code></pre>\n\n<p>As you can see, it's not likely to be very smooth.  And, in testing, it isn't very smooth at all!  I get the following values for one example run: </p>\n\n<pre><code>100\n87\n91\n103\n88\n94\n102\n93\n103\n88\n</code></pre>\n\n<p>This sequence has an average value of I understand that network time and other tools smoothly coerce the current time to get an accurate timer. Perhaps doing some sort of PID loop to get the target interval to targetInterval - 15 / 2 or so could require smaller updates, or perhaps smoothing could reduce the difference in timing between short events and long events.  How can I integrate this with my approach?  Are there existing libraries which do this?  </p>\n\n<p>I compared it to a regular stopwatch, and it seems to be accurate. After 5 minutes, I measured the following millisecond counter values: </p>\n\n<pre><code>DateTime elapsed:  300119\nStopwatch elapsed: 300131\nTimer sum:         274800\nCorrected sum:     300200\n</code></pre>\n\n<p>and after 30 minutes, I measured:</p>\n\n<pre><code>DateTime elapsed:  1800208.2664\nStopwatch elapsed: 1800217\nTimer sum:         1648500\nCorrected sum:     1800300\n</code></pre>\n\n<p>The stock timers are slower than the stopwatch by 151.8 seconds, or 8.4% of the total. That seems remarkably close to an average tick duration being between 100 and 115 ms!  Also, the corrected sum is still within 100 ms of the measured values (and these are more accurate than I can find error with my watch), so this works.</p>\n\n<p>My full test program follows.  It runs in Windows Forms and requires a text box on \"Form1\", or delete the <code>textBox1.Text =</code> line and run it in a command-line project.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace StopwatchTimerTest\n{\n    public partial class Form1 : Form\n    {\n        private System.Diagnostics.Stopwatch ElapsedTimeStopwatch;\n        private double TimerSumElapsedMilliseconds;\n        private double StopwatchCorrectedElapsedMilliseconds;\n        private DateTime StartTime;\n\n        public Form1()\n        {\n            InitializeComponent();\n            Run();\n        }\n\n        private void Run()\n        {\n            var targetInterval = 100;\n            // A stopwatch running in normal mode provides the correct elapsed time to the best abilities of the system\n            // (save, for example, a network time server or GPS peripheral)\n            ElapsedTimeStopwatch = new System.Diagnostics.Stopwatch();\n\n            // A normal System.Timers.Timer ticks somewhere between 100 ms and 115ms, quickly becoming inaccurate.\n            var NormalTimer = new System.Timers.Timer()\n            {\n                Interval = targetInterval,\n                AutoReset = true,\n            };\n            NormalTimer.Elapsed += (o, e) =&gt;\n            {\n                TimerSumElapsedMilliseconds += NormalTimer.Interval;\n            };\n\n            // This is my \"quick and dirty\" corrective stopwatch\n            var CorrectiveStopwatch = new System.Diagnostics.Stopwatch();\n            var CorrectedTimer = new System.Timers.Timer()\n            {\n                Interval = targetInterval,\n                AutoReset = true,\n            };\n            CorrectedTimer.Elapsed += (o, e) =&gt;\n            {\n                var actualMilliseconds = CorrectiveStopwatch.ElapsedMilliseconds; // Drop this into a variable to avoid confusion in the debugger\n\n                // Adjust the next tick so that it's accurate\n                // EG: Stopwatch says we're at 2015 ms, we should be at 2000 ms, 2000 + 100 - 2015 = 85 and should trigger at the right time\n                var newInterval = StopwatchCorrectedElapsedMilliseconds + targetInterval - actualMilliseconds;\n\n                if (newInterval &lt;= 0)\n                {\n                    newInterval = 1; // Basically trigger instantly in an attempt to catch up; could be smoother...\n                }\n                CorrectedTimer.Interval = newInterval;\n\n                // Note: could be more accurate with actual interval, but actual app uses sum of tick events for many things\n                StopwatchCorrectedElapsedMilliseconds += targetInterval;\n            };\n\n            var updateTimer = new System.Windows.Forms.Timer()\n            {\n                Interval = 1000,\n                Enabled = true,\n            };\n            updateTimer.Tick += (o, e) =&gt;\n            {\n                var result = \"DateTime elapsed:  \" + (DateTime.Now - StartTime).TotalMilliseconds.ToString() + Environment.NewLine + \n                             \"Stopwatch elapsed: \" + ElapsedTimeStopwatch.ElapsedMilliseconds.ToString() + Environment.NewLine +\n                             \"Timer sum:         \" + TimerSumElapsedMilliseconds.ToString() + Environment.NewLine +\n                             \"Corrected sum:     \" + StopwatchCorrectedElapsedMilliseconds.ToString();\n                Console.WriteLine(result + Environment.NewLine);\n                textBox1.Text = result;\n            };\n\n            // Start everything simultaneously\n            StartTime = DateTime.Now;\n            ElapsedTimeStopwatch.Start();\n            updateTimer.Start();\n            NormalTimer.Start();\n            CorrectedTimer.Start();\n            CorrectiveStopwatch.Start();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "wcf", "soapui"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1444245198, "post_id": 33000551, "comment_id": 53825852, "body": "Post code or text where possible, not images.  Images reduce the ability to search and find duplicate questions."}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 1, "creation_date": 1444245313, "post_id": 33000551, "comment_id": 53825930, "body": "I think you need to use URL encoding.  %25 is the escape sequence for <code>%</code>. So for your test, it would be <code>http:&#47;&#47;localhost:89&#47;servicioWCF&#47;javier&#47;pas%25w_4</code>"}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 2, "creation_date": 1444245602, "post_id": 33000551, "comment_id": 53826113, "body": "I can safely assume that you&#39;re not using a username and password like this. This is just a test, right? You&#39;ll never do it that way."}, {"owner": {"reputation": 251, "user_id": 4810998, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/JVaTc.jpg?s=128&g=1", "display_name": "Jose Eduardo Poma Caceres", "link": "https://stackoverflow.com/users/4810998/jose-eduardo-poma-caceres"}, "edited": false, "score": 0, "creation_date": 1444260269, "post_id": 33000551, "comment_id": 53832976, "body": "Hi Tim, try but I get the same error, is there any other option?"}, {"owner": {"reputation": 251, "user_id": 4810998, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/JVaTc.jpg?s=128&g=1", "display_name": "Jose Eduardo Poma Caceres", "link": "https://stackoverflow.com/users/4810998/jose-eduardo-poma-caceres"}, "edited": false, "score": 0, "creation_date": 1444260324, "post_id": 33000551, "comment_id": 53832998, "body": "Thomas , is only a test , actually that should send as post , but I&#39;m doing tests with GET"}, {"owner": {"reputation": 8707, "user_id": 3124333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MCMEh.jpg?s=128&g=1", "display_name": "SiKing", "link": "https://stackoverflow.com/users/3124333/siking"}, "edited": false, "score": 0, "creation_date": 1444265296, "post_id": 33000551, "comment_id": 53834317, "body": "SoapUI has a known bug that it does not encode URLs properly. Has been there since sometime in version 4.0.1."}], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 4810998, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/JVaTc.jpg?s=128&g=1", "display_name": "Jose Eduardo Poma Caceres", "link": "https://stackoverflow.com/users/4810998/jose-eduardo-poma-caceres"}, "edited": false, "score": 0, "creation_date": 1444260233, "post_id": 33000691, "comment_id": 53832966, "body": "Hi pkmiec, try but I get the same error, is there any other option?"}, {"owner": {"reputation": 2426, "user_id": 248987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FB8Mo.jpg?s=128&g=1", "display_name": "pkmiec", "link": "https://stackoverflow.com/users/248987/pkmiec"}, "reply_to_user": {"reputation": 251, "user_id": 4810998, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/JVaTc.jpg?s=128&g=1", "display_name": "Jose Eduardo Poma Caceres", "link": "https://stackoverflow.com/users/4810998/jose-eduardo-poma-caceres"}, "edited": false, "score": 0, "creation_date": 1444284744, "post_id": 33000691, "comment_id": 53839898, "body": "Please post the error detalis.. It should be at least minimally different"}], "tags": [], "owner": {"reputation": 2426, "user_id": 248987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FB8Mo.jpg?s=128&g=1", "display_name": "pkmiec", "link": "https://stackoverflow.com/users/248987/pkmiec"}, "is_accepted": false, "score": 0, "last_activity_date": 1444245616, "creation_date": 1444245616, "answer_id": 33000691, "question_id": 33000551, "link": "https://stackoverflow.com/questions/33000551/how-to-send-parameter-containing-in-a-rest-c-wcf-service/33000691#33000691", "title": "How to send parameter containing &quot;%&quot; in a REST ( C # WCF ) service", "body": "<p>% sign is used for encoding in urls. It must be followed by 2 hexadecimal digits which denote the character code. Read more here <a href=\"http://www.w3schools.com/tags/ref_urlencode.asp\" rel=\"nofollow\">http://www.w3schools.com/tags/ref_urlencode.asp</a></p>\n\n<p>If you actually want to send \"%\" sign in the url, you have to encode it by entering \"%25\".</p>\n"}, {"tags": [], "owner": {"reputation": 251, "user_id": 4810998, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/JVaTc.jpg?s=128&g=1", "display_name": "Jose Eduardo Poma Caceres", "link": "https://stackoverflow.com/users/4810998/jose-eduardo-poma-caceres"}, "is_accepted": false, "score": 0, "last_activity_date": 1444375009, "creation_date": 1444375009, "answer_id": 33032198, "question_id": 33000551, "link": "https://stackoverflow.com/questions/33000551/how-to-send-parameter-containing-in-a-rest-c-wcf-service/33032198#33032198", "title": "How to send parameter containing &quot;%&quot; in a REST ( C # WCF ) service", "body": "<p>the temporary solution was to change the POST method, with that I was solved.</p>\n\n<p>The new function:</p>\n\n<pre><code>[OperationContract]\n    [WebInvoke(Method = \"POST\", UriTemplate = \"67g09k2r8\", \n        ResponseFormat = WebMessageFormat.Json,\n        BodyStyle = WebMessageBodyStyle.Wrapped, \n        RequestFormat = WebMessageFormat.Json)]\n    int Login(String usu, String pas);\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 4810998, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/JVaTc.jpg?s=128&g=1", "display_name": "Jose Eduardo Poma Caceres", "link": "https://stackoverflow.com/users/4810998/jose-eduardo-poma-caceres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444375009, "creation_date": 1444245113, "last_edit_date": 1444245530, "question_id": 33000551, "link": "https://stackoverflow.com/questions/33000551/how-to-send-parameter-containing-in-a-rest-c-wcf-service", "title": "How to send parameter containing &quot;%&quot; in a REST ( C # WCF ) service", "body": "<p>I have this function that returns the code of a user who was authenticated correctly</p>\n\n<pre><code>[OperationContract]\n[WebInvoke(Method = \"GET\", \n           UriTemplate = \"67g09k2r8/{usu}/{pas}\", \n           ResponseFormat = WebMessageFormat.Json)]\nint Login(String usu, String pas); \n</code></pre>\n\n<p>when I perform the tests from SoapUI works well . Here a test</p>\n\n<p><a href=\"http://i.stack.imgur.com/1hKyQ.png\" rel=\"nofollow\">Good</a></p>\n\n<p>but when I try with a parameter that contains the character \"%\" I get this error</p>\n\n<p><a href=\"http://i.stack.imgur.com/kLqek.png\" rel=\"nofollow\">Error</a></p>\n\n<p>Could you tell me how to solve this problem?</p>\n"}, {"tags": ["c#", "windows-phone", "windows-store-apps", "windows-10"], "comments": [{"owner": {"reputation": 1635, "user_id": 4089404, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100007444487425/picture?type=large", "display_name": "Stuart Smith", "link": "https://stackoverflow.com/users/4089404/stuart-smith"}, "edited": false, "score": 0, "creation_date": 1444253116, "post_id": 33000509, "comment_id": 53830282, "body": "Could you please add a picture of what you are trying to do"}, {"owner": {"reputation": 113, "user_id": 4227727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/14b88665638f457113f652329a59e9be?s=128&d=identicon&r=PG&f=1", "display_name": "shriyanshk", "link": "https://stackoverflow.com/users/4227727/shriyanshk"}, "reply_to_user": {"reputation": 1635, "user_id": 4089404, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100007444487425/picture?type=large", "display_name": "Stuart Smith", "link": "https://stackoverflow.com/users/4089404/stuart-smith"}, "edited": false, "score": 0, "creation_date": 1444412548, "post_id": 33000509, "comment_id": 53909232, "body": "@StuartSmith of what you want the picture ?"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4227727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/14b88665638f457113f652329a59e9be?s=128&d=identicon&r=PG&f=1", "display_name": "shriyanshk", "link": "https://stackoverflow.com/users/4227727/shriyanshk"}, "edited": false, "score": 0, "creation_date": 1444413273, "post_id": 33010080, "comment_id": 53909581, "body": "It works when my button and splitview are in same xaml files. But my split view is in Shell.xaml and I have a settings page which contains all buttons."}], "tags": [], "owner": {"reputation": 1617, "user_id": 5222921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KnTf6.jpg?s=128&g=1", "display_name": "Nasser AlNasser", "link": "https://stackoverflow.com/users/5222921/nasser-alnasser"}, "is_accepted": false, "score": 3, "last_activity_date": 1444291605, "creation_date": 1444291605, "answer_id": 33010080, "question_id": 33000509, "link": "https://stackoverflow.com/questions/33000509/how-to-change-split-view-background-color-dynamically-in-windows-10-app/33010080#33010080", "title": "How to change Split View Background color dynamically in Windows 10 App", "body": "<p>You can use 'PaneBackground' property be code and use this code in each item click event handler :</p>\n\n<pre><code>mySplitView.PaneBackground = new SolidColorBrush(Colors.Yellow); \n</code></pre>\n\n<p>Is this what you try to do ?</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 4227727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/14b88665638f457113f652329a59e9be?s=128&d=identicon&r=PG&f=1", "display_name": "shriyanshk", "link": "https://stackoverflow.com/users/4227727/shriyanshk"}, "edited": false, "score": 0, "creation_date": 1444412808, "post_id": 33037368, "comment_id": 53909356, "body": "It works but my concern is how to do it on button click that to my button being on different page. I have a shell.xaml which  has split view and I have a settings.xaml where I have all the buttons of color."}, {"owner": {"reputation": 63, "user_id": 1500369, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/045304cba854151866f0b1570f8b8730?s=128&d=identicon&r=PG", "display_name": "startewho", "link": "https://stackoverflow.com/users/1500369/startewho"}, "reply_to_user": {"reputation": 113, "user_id": 4227727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/14b88665638f457113f652329a59e9be?s=128&d=identicon&r=PG&f=1", "display_name": "shriyanshk", "link": "https://stackoverflow.com/users/4227727/shriyanshk"}, "edited": false, "score": 0, "creation_date": 1444436062, "post_id": 33037368, "comment_id": 53918560, "body": "@shriyanshk Maybe you can take a look at <a href=\"http://git.videolan.org/?p=vlc-ports/winrt.git;a=shortlog\" rel=\"nofollow noreferrer\">VLC git rep</a>,VLC have a similar case like your request"}], "tags": [], "owner": {"reputation": 63, "user_id": 1500369, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/045304cba854151866f0b1570f8b8730?s=128&d=identicon&r=PG", "display_name": "startewho", "link": "https://stackoverflow.com/users/1500369/startewho"}, "is_accepted": false, "score": 1, "last_activity_date": 1444397643, "last_edit_date": 1444397643, "creation_date": 1444390822, "answer_id": 33037368, "question_id": 33000509, "link": "https://stackoverflow.com/questions/33000509/how-to-change-split-view-background-color-dynamically-in-windows-10-app/33037368#33037368", "title": "How to change Split View Background color dynamically in Windows 10 App", "body": "<p>Maybe you can use the theme.</p>\n\n<p>1.In the App.xmal file ,you need add two theme resource</p>\n\n<pre><code>&lt;Application\nx:Class=\"App3.App\"\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nxmlns:local=\"using:App3\"\nRequestedTheme=\"Light\"&gt;\n&lt;Application.Resources&gt;\n    &lt;ResourceDictionary&gt;\n        &lt;ResourceDictionary.ThemeDictionaries&gt;\n            &lt;ResourceDictionary x:Key=\"Light\"&gt;\n                &lt;SolidColorBrush x:Key=\"ApplicationPageBackgroundThemeBrush\"&gt;#FFDEDEDE&lt;/SolidColorBrush&gt;\n            &lt;/ResourceDictionary&gt;\n            &lt;ResourceDictionary x:Key=\"Dark\"&gt;\n                &lt;SolidColorBrush x:Key=\"ApplicationPageBackgroundThemeBrush\"&gt;Yellow&lt;/SolidColorBrush&gt;\n            &lt;/ResourceDictionary&gt;\n        &lt;/ResourceDictionary.ThemeDictionaries&gt;\n        &lt;/ResourceDictionary&gt;\n&lt;/Application.Resources&gt;\n&lt;/Application&gt;\n</code></pre>\n\n<p>2.Change the MainPage's code</p>\n\n<pre><code>   public MainPage()\n    {\n        this.InitializeComponent();\n        RequestedTheme=ElementTheme.Light;\n    }\n\n    private void HamburgerButton_Click(object sender, RoutedEventArgs e)\n    {\n        RequestedTheme = ElementTheme.Dark;\n    }\n</code></pre>\n\n<p>It should work in winrt.</p>\n"}, {"tags": [], "owner": {"reputation": 3204, "user_id": 4621732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d48f3c0714ac29206570bfc7c9dde85?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Yao - MSFT", "link": "https://stackoverflow.com/users/4621732/alan-yao-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1444626216, "creation_date": 1444626216, "answer_id": 33073583, "question_id": 33000509, "link": "https://stackoverflow.com/questions/33000509/how-to-change-split-view-background-color-dynamically-in-windows-10-app/33073583#33073583", "title": "How to change Split View Background color dynamically in Windows 10 App", "body": "<p>The following can meet your requirements:</p>\n\n<ol>\n<li><p>Button on setting page which is responsible for change color of split view in other pages. The new color can be saved into application's local setting.</p>\n\n<pre><code>public sealed partial class SettingPage : Page\n{\n    public SettingPage()\n    {\n        this.InitializeComponent();\n    }\n\n    private void Button_Click(object sender, RoutedEventArgs e)\n    {\n        ApplicationDataContainer localsettings = ApplicationData.Current.LocalSettings;\n        localsettings.Values[\"SplitViewColoronShell\"] = Colors.Yellow.ToString();\n    }\n}\n</code></pre></li>\n<li><p>In the code behind of shell page, get the color from local setting and set it to the splitview.</p>\n\n<pre><code>protected override void OnNavigatedTo(NavigationEventArgs e)\n{\n    base.OnNavigatedTo(e);\n    ApplicationDataContainer localsettings = ApplicationData.Current.LocalSettings;\n    if (localsettings.Values[\"SplitViewColoronShell\"] != null)\n    {\n        mySplitView.PaneBackground = GetSolidColorBrush(localsettings.Values[\"SplitViewColoronShell\"].ToString());\n    }\n}\n\npublic SolidColorBrush GetSolidColorBrush(string hex)\n{\n    hex = hex.Replace(\"#\", string.Empty);\n    byte a = (byte)(Convert.ToUInt32(hex.Substring(0, 2), 16));\n    byte r = (byte)(Convert.ToUInt32(hex.Substring(2, 2), 16));\n    byte g = (byte)(Convert.ToUInt32(hex.Substring(4, 2), 16));\n    byte b = (byte)(Convert.ToUInt32(hex.Substring(6, 2), 16));\n    SolidColorBrush myBrush = new SolidColorBrush(Windows.UI.Color.FromArgb(a, r, g, b));\n    return myBrush;\n}\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 113, "user_id": 4227727, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/14b88665638f457113f652329a59e9be?s=128&d=identicon&r=PG&f=1", "display_name": "shriyanshk", "link": "https://stackoverflow.com/users/4227727/shriyanshk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1444626216, "creation_date": 1444244998, "last_edit_date": 1444412724, "question_id": 33000509, "link": "https://stackoverflow.com/questions/33000509/how-to-change-split-view-background-color-dynamically-in-windows-10-app", "title": "How to change Split View Background color dynamically in Windows 10 App", "body": "<pre><code>&lt;Grid Background=\"{ThemeResource ApplicationPageBackgroundThemeBrush}\"&gt;\n        &lt;SplitView x:Name=\"mySplitView\" DisplayMode=\"CompactInline\"  IsPaneOpen=\"False\" \n                CompactPaneLength=\"50\" OpenPaneLength=\"150\" Content=\"{Binding}\"&gt; // using PaneBackground I can set color statically\n            &lt;SplitView.Pane&gt;\n                &lt;StackPanel&gt;\n                    &lt;Button x:Name=\"HamburgerButton\" FontFamily=\"Segoe MDL2 Assets\" Content=\"&amp;#xE700;\"\n                     Width=\"50\" Height=\"50\" Background=\"Transparent\" Foreground=\"White\"  Click=\"HamburgerButton_Click\" /&gt;\n            &lt;StackPanel&gt;\n         &lt;/SplitView.Pane&gt;\n     &lt;/SplitView&gt;\n &lt;/Grid&gt;\n</code></pre>\n\n<p>.How to change the color of Splitview Pane dynamically i.e if a user clicks button to change color to yellow it should change and if user wants default accent color then that should be set just like in outlook Mail app. I have my split view in one page and want the buttons in other xaml page namely settings page.</p>\n"}, {"tags": ["c#", "multithreading", "parse-platform", "unity3d"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 4184223, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dZnbKGW18mk/AAAAAAAAAAI/AAAAAAAAAEc/E-oW1V5PXWg/photo.jpg?sz=128", "display_name": "VKnai", "link": "https://stackoverflow.com/users/4184223/vknai"}, "is_accepted": true, "score": 0, "last_activity_date": 1444286870, "creation_date": 1444286870, "answer_id": 33008512, "question_id": 33000501, "link": "https://stackoverflow.com/questions/33000501/parse-main-thread-error/33008512#33008512", "title": "Parse Main Thread Error", "body": "<p>So I figured out a solution; I thought you could save values on the fly within a query, but I guess saving information to the variable should happen outside of the query. </p>\n\n<p>What I have working now looks something like this:</p>\n\n<pre><code>    using Parse;\n    using System.Threading.Tasks;\n\n    public class MainMenuScript : MonoBehaviour {\n\n    ParseObject parseObjToUpdate; \n    private bool hasUpdatedParse;\n    public string myCurrentChalID;\n\n    void Start()\n    {\n        hasUpdatedParse = false;\n        var query = ParseObject.GetQuery(\"ChallengeStatus\")\n            .WhereEqualTo(\"challengeID\", myCurrentChalID);\n            query.FirstAsync().ContinueWith(t =&gt;\n             {\n                parseObjToUpdate = t.Result;\n                print (parseObjToUpdate.ObjectId); // to debug that something is happening and it's the right object\n              });\n    }\n\n    void Update ()\n    {\n       if (parseObjToUpdate != null &amp;&amp; !hasUpdatedParse)\n        {\n            parseObjToUpdate[\"playerTurn\"] = PlayerPrefs.GetString(\"opponentID\");\n            parseObjToUpdate.SaveAsync();\n            hasUpdatedParse = true;\n        }\n    }\n</code></pre>\n\n<p>So yeah. Gonna mark this as solved. Thank you everyone watching, it's been great.</p>\n"}], "owner": {"reputation": 33, "user_id": 4184223, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dZnbKGW18mk/AAAAAAAAAAI/AAAAAAAAAEc/E-oW1V5PXWg/photo.jpg?sz=128", "display_name": "VKnai", "link": "https://stackoverflow.com/users/4184223/vknai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "closed_date": 1482778666, "accepted_answer_id": 33008512, "answer_count": 1, "score": 0, "last_activity_date": 1444286870, "creation_date": 1444244978, "last_edit_date": 1495539961, "question_id": 33000501, "link": "https://stackoverflow.com/questions/33000501/parse-main-thread-error", "closed_reason": "Duplicate", "title": "Parse Main Thread Error", "body": "<p>So I have an app that's using Parse. I'm able to create new ParseObjects with no problem, as well as query for saved ParseObjects. However, whenever I try to update an existing ParseObject I've queried for, I get the following error:</p>\n\n<p><em>\"get_bundleIdentifier can only be called from the main thread.\nConstructors and field initializers will be executed from the loading thread when loading a scene.\nDon't use this function in the constructor or field initializers, instead move initialization code to the Awake or Start function.\"</em></p>\n\n<p>Now I've found some people getting similar errors, with \"get_bundleIdentifier\" being the difference, and I think it has to do with not being run from the \"main thread\", but I don't know how to affect that. I've tried the same code in a coroutine as suggested <a href=\"https://stackoverflow.com/questions/24441501/main-thread-issue-with-parse-com-queries\" title=\"here\">here</a> and I get the same error.</p>\n\n<p>I'm using Parse Version 1.6.0 and Unity Pro 5.1.2. Here is my code:</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\nusing Parse;\nusing System.Threading.Tasks;\npublic class SimpleParseScript : MonoBehaviour {\n\n    // Use this for initialization\n    void Start () {\n        var query = ParseObject.GetQuery(\"ChallengeScores\") // query to parse to find scores and whos turn\n            .WhereEqualTo(\"challengeID\", 20307271925313064);\n        query.FirstAsync().ContinueWith(t =&gt;\n                                        {\n            ParseObject gameStatus = t.Result;\n            print (gameStatus.ObjectId); // print queried ParseObject ObjectId - works fine\n            gameStatus[\"turnsTaken\"] = 100;\n            Task saveTask = gameStatus.SaveAsync();\n        });\n    }\n}\n</code></pre>\n\n<p>Now, if I comment out \"gameStatus[\"turnsTaken\"] = 100;\", then try to save it, it runs through just fine, though nothing gets saved for obvious reasons.</p>\n\n<p>Anyone got a clue? The parse documentation <a href=\"https://www.parse.com/docs/unity/guide#objects-updating-objects\" rel=\"nofollow noreferrer\">right here</a> says it should be as simple as declaring it and saving it again after querying, but no go. </p>\n\n<p>Thank you for your time and patience. </p>\n"}, {"tags": ["c#", "wpf", "xaml", "windows-runtime", "windows-10"], "comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 3, "creation_date": 1444246074, "post_id": 33000480, "comment_id": 53826397, "body": "It&#39;s not only data binding, but also style setters and animations that would require a dependency property. I would always use a dependency property, as it provides greater flexibility."}], "answers": [{"comments": [{"owner": {"reputation": 11321, "user_id": 4184842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9mD03.jpg?s=128&g=1", "display_name": "Peter Torr - MSFT", "link": "https://stackoverflow.com/users/4184842/peter-torr-msft"}, "edited": false, "score": 1, "creation_date": 1444264603, "post_id": 33001890, "comment_id": 53834140, "body": "Also, even if all you want is two-way binding (not animation) then you can implement <code>INotifyPropertyChanged</code> with a simple property rather than going all the way to a <code>DependencyProperty</code>"}], "tags": [], "owner": {"reputation": 10214, "user_id": 493389, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5c3f772d7effe2eda5d93e76aa1a4edb?s=128&d=identicon&r=PG&f=1", "display_name": "123 456 789 0", "link": "https://stackoverflow.com/users/493389/123-456-789-0"}, "is_accepted": true, "score": 1, "last_activity_date": 1444277895, "last_edit_date": 1444277895, "creation_date": 1444249754, "answer_id": 33001890, "question_id": 33000480, "link": "https://stackoverflow.com/questions/33000480/when-to-use-a-property-over-a-dependency-property-in-a-custom-control/33001890#33001890", "title": "When to use a Property over a Dependency Property in a custom control?", "body": "<p>I always ask these basic questions</p>\n\n<blockquote>\n  <p>Do I need this to be bindable, animations, or styles and have default\n  settings that a simple property can't offer for this control? </p>\n  \n  <p>Do I need to preserve the XAML (expression) with this new property when I am going to serialize/deserialize this\n  control?</p>\n</blockquote>\n\n<p><strong>If yes, then I would use <code>DependencyProperty</code>. If not then I'd just use simple properties to be used within this control. It's similar to the question on whether you want to use <code>fields</code> vs <code>properties</code> in an object. My tip is use it when you need the framework's capabilities in your property as they give you more options. You want to know if you need those options or not.</strong> </p>\n\n<p><strong>Another reason you want to use DependencyProperty is because you have a base/child control relationship and you want other developers to be able to consume. Instead of you creating interfaces to expose to your control, you provide instant static getter/setter to read/modify the value of your control. You are already creating your interfaces when you create <code>DependencyProperty</code>.</strong> </p>\n\n<p>When in doubt, always create simple properties/fields against your control.</p>\n\n<p><em>I don't agree with the comment that always go with <code>DependencyProperty</code> because it's not cheap compared to a simple property.</em> </p>\n\n<p><em>For example, you want to make changes to the property and it was a <code>DependencyProperty</code> then chances are, I would need to manually edit the name of the property which is a <code>string</code> and is error-prone. Now compare that to a simple property that gives me a compile time check and I can find the references easily and make some changes to it.</em></p>\n\n<p>I've had experiences where <code>DependencyProperty</code> was an overkill and should have just used simple properties and the intent would be clear for other developers to read.</p>\n"}], "owner": {"reputation": 4005, "user_id": 3813976, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zUdY0.png?s=128&g=1", "display_name": "Sergio0694", "link": "https://stackoverflow.com/users/3813976/sergio0694"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 33001890, "answer_count": 1, "score": 2, "last_activity_date": 1444277895, "creation_date": 1444244940, "question_id": 33000480, "link": "https://stackoverflow.com/questions/33000480/when-to-use-a-property-over-a-dependency-property-in-a-custom-control", "title": "When to use a Property over a Dependency Property in a custom control?", "body": "<p>I've been wondering when should I use a Property or a Dependency Property in a custom control for a while, so I thought it'd be a good idea to ask.</p>\n\n<p>Let's say I have a simple (I mean, really simple) UserControl with just a Button and a TextBlock inside it. Let's call the TextBlock \"myTextBlock\".</p>\n\n<p>Now, <em>if</em> I knew I'll need to bind the Text of that TextBlock to something else, I'd go with a Dependency Property, and that's not a problem.</p>\n\n<p>But what if I <em>just</em> need to set the Text property of the TextBlock to a certain value via XAML and leave it be?\nDoes it matter if I use a Property instead of a DependencyProperty?\nIs one option faster/better than the other one, and if so, why?</p>\n\n<p>Here is a sample with the two options:</p>\n\n<pre><code>public String ButtonText\n{\n    get { return (String)GetValue(ButtonTextProperty); }\n    set { SetValue(ButtonTextProperty, value); }\n}\n\npublic static readonly DependencyProperty ButtonTextProperty =\n    DependencyProperty.Register(\"ButtonText\", typeof(String), typeof(MyUserControl),\n    new PropertyMetadata(String.Empty, OnButtonTextPropertyChanged));\n\nprivate static void OnButtonTextPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)\n{\n    (MyUserControl)d.myTextBlock.Text = (String)e.NewValue;\n}\n</code></pre>\n\n<p>And with just the Property:</p>\n\n<pre><code>public String ButtonText\n{\n    get { return myTextBlock.Text; }\n    set { myTextBlock.Text = value; }\n}\n</code></pre>\n\n<p>I usually go with the simple Property, but I don't know if that's the better approach to use here. Of course it works fine, that's not a problem.</p>\n\n<p>Thanks in advance!</p>\n\n<p>Sergio</p>\n"}, {"tags": ["c#", "asp.net-core", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 1331, "user_id": 2461203, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KWGj5.gif?s=128&g=1", "display_name": "ragerory", "link": "https://stackoverflow.com/users/2461203/ragerory"}, "edited": false, "score": 1, "creation_date": 1444245657, "post_id": 33000474, "comment_id": 53826146, "body": "Interesting. Have you taken a look at this git page? <a href=\"https://github.com/dotnet/corefx/issues/1006\" rel=\"nofollow noreferrer\">github.com/dotnet/corefx/issues/1006</a>"}, {"owner": {"reputation": 22059, "user_id": 112196, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e34b0f9e6f02cc448b42093ef14d22b0?s=128&d=identicon&r=PG", "display_name": "Pero P.", "link": "https://stackoverflow.com/users/112196/pero-p"}, "edited": false, "score": 2, "creation_date": 1444251777, "post_id": 33000474, "comment_id": 53829628, "body": "You&#39;re not restricted to targeting dnxcore50 in asp.net 5. You can still target the full .net framework (or mono). What platform are you targeting; Windows, Linux?"}, {"owner": {"reputation": 28569, "user_id": 1922568, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UDzW1.jpg?s=128&g=1", "display_name": "Joe Audette", "link": "https://stackoverflow.com/users/1922568/joe-audette"}, "edited": false, "score": 0, "creation_date": 1444311635, "post_id": 33000474, "comment_id": 53857963, "body": "I think/hope that later there will be a nuget of mailkit that is compatible with dnxcore50, that is what I plan to use for sending email in my apps <a href=\"https://github.com/jstedfast/MailKit\" rel=\"nofollow noreferrer\">github.com/jstedfast/MailKit</a> but probably not many 3rd party things will be available until after .net core comes out of beta"}], "answers": [{"comments": [{"owner": {"reputation": 13685, "user_id": 99897, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5ea27fefd5d94036b0def62f7cda2c60?s=128&d=identicon&r=PG", "display_name": "Jeff Putz", "link": "https://stackoverflow.com/users/99897/jeff-putz"}, "edited": false, "score": 2, "creation_date": 1445131770, "post_id": 33009734, "comment_id": 54192533, "body": "It looks like it&#39;s beyond missing, as it&#39;s not even on the status page even though everything is essentially &quot;done.&quot; <a href=\"https://github.com/dotnet/corefx-progress/blob/master/src-diff/README.md\" rel=\"nofollow noreferrer\">github.com/dotnet/corefx-progress/blob/master/src-diff/&hellip;</a>"}], "tags": [], "owner": {"reputation": 27650, "user_id": 1212017, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4jeaX.png?s=128&g=1", "display_name": "Muhammad Rehan Saeed", "link": "https://stackoverflow.com/users/1212017/muhammad-rehan-saeed"}, "is_accepted": true, "score": 4, "last_activity_date": 1444290609, "creation_date": 1444290609, "answer_id": 33009734, "question_id": 33000474, "link": "https://stackoverflow.com/questions/33000474/asp-5-mvc-6-sending-email/33009734#33009734", "title": "ASP 5, MVC 6 sending email", "body": "<p>.NET Core has several missing API's at the moment. These include <code>System.Net.Mail.SmtpClient</code> as you have found and also <code>System.ServiceModel.SyndicationFeed</code> too which can be used to build RSS or Atom feeds. The workaround for this is to target the full .NET Framework, instead of .NET Core. You can always target .NET Core once these API's become available.</p>\n\n<p>So in your project.json file you need to remove the reference to <code>dnxcore50</code> and to add <code>dnx451</code> for .NET 4.5.1 or <code>dnx46</code> for .NET 4.6 if it is not already there:</p>\n\n<pre><code>\"frameworks\": {\n  \"dnx451\": {\n    \"frameworkAssemblies\": {\n      \"System.ServiceModel\": \"4.0.0.0\"\n      // ..Add other .NET Framework references.\n    }\n  },\n  // Remove this to stop targeting .NET Core.\n  // Note that you can't comment it out because project.json does not allow comments.\n  \"dnxcore50\": {            \n    \"dependencies\": {\n    }\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454511888, "post_id": 34117139, "comment_id": 58077978, "body": "Which version should I be installing? I tried to install 1.3.0-beta6 in my ASP.Net Core 1 class library but get the error &quot;The dependency MailKit 1.3.0-beta6 does not support framework .NetPlatform, Version=v5.4&quot;"}, {"owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "reply_to_user": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454511996, "post_id": 34117139, "comment_id": 58078067, "body": "MailKit requires .NETPlatform v5.5, it seems you are targeting v5.4."}, {"owner": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454512166, "post_id": 34117139, "comment_id": 58078193, "body": "I am as that is what the RC1 templates setup by default, which I think a lot of people will be targeting as well until RC2 comes out."}, {"owner": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454513019, "post_id": 34117139, "comment_id": 58078866, "body": "Well as stated on your githit you can&#39;t support v5.4 so off to look for something that works."}, {"owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "reply_to_user": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 3, "creation_date": 1454513224, "post_id": 34117139, "comment_id": 58079025, "body": "MailKit is the only mail library that supports dotnet core at all."}, {"owner": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454513790, "post_id": 34117139, "comment_id": 58079431, "body": "Where are you finding v5.5? When I search for that all I find is info about Mono as developed by Xamarin and not by Microsoft."}, {"owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "reply_to_user": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454514173, "post_id": 34117139, "comment_id": 58079729, "body": "Edit your project.json and change &quot;dotnet54&quot; to &quot;dotnet55&quot;. It has nothing to do with Xamarin or mono - it is just another subset of dotnet core APIs."}, {"owner": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454514309, "post_id": 34117139, "comment_id": 58079840, "body": "Any links to information on 5.5? I don&#39;t really like just jumping a framework version that google says does not exist."}, {"owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "reply_to_user": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454515018, "post_id": 34117139, "comment_id": 58080380, "body": "You can think of dotnet5x as PCL profiles. 55 is the full api while the others are subsets targeting the lowest common denominator (eg WindowsPhone or Silverlight, etc)"}, {"owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "reply_to_user": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454515191, "post_id": 34117139, "comment_id": 58080514, "body": "<a href=\"https://github.com/dotnet/corefx/blob/master/Documentation/project-docs/standard-platform.md\" rel=\"nofollow noreferrer\">github.com/dotnet/corefx/blob/master/Documentation/project-d&zwnj;&#8203;ocs/&hellip;</a> has more info than the other link."}, {"owner": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454515631, "post_id": 34117139, "comment_id": 58080855, "body": "Thanks for the links and info."}, {"owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "reply_to_user": {"reputation": 5700, "user_id": 2911737, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9abfd73c288a9f0f4fbc74b683dd0741?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Verstraete", "link": "https://stackoverflow.com/users/2911737/matthew-verstraete"}, "edited": false, "score": 0, "creation_date": 1454516280, "post_id": 34117139, "comment_id": 58081333, "body": "np, FWIW I think the reason I was unable to get MailKit to work on dotnet54 was because System.Net.Sockets wasn&#39;t available until dotnet55 (according to the last chart - note that dotnet55 is aka netstandard1.4)."}, {"owner": {"reputation": 17880, "user_id": 1104402, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/51a1a6aa3c65b84b02c56041cce937fc?s=128&d=identicon&r=PG", "display_name": "amd", "link": "https://stackoverflow.com/users/1104402/amd"}, "edited": false, "score": 0, "creation_date": 1458130141, "post_id": 34117139, "comment_id": 59719416, "body": "@jstedfast, I have used the code above, but I am getting: <code>TlsException: Invalid certificate received from server</code> while am setting <code>useSsl</code> to <code>false</code>, should I do something different ? (mac .netcore)"}, {"owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "edited": false, "score": 0, "creation_date": 1458131145, "post_id": 34117139, "comment_id": 59720117, "body": "Set the client.ServerCertificateValidationCallback delegate to something that will validate your server&#39;s certificate. Apparently your server is not using a certificate that is trusted by your system."}], "tags": [], "owner": {"reputation": 28276, "user_id": 87117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f9e45dad82da556b0acabdbf3be8452?s=128&d=identicon&r=PG", "display_name": "jstedfast", "link": "https://stackoverflow.com/users/87117/jstedfast"}, "is_accepted": false, "score": 27, "last_activity_date": 1452253254, "last_edit_date": 1452253254, "creation_date": 1449403004, "answer_id": 34117139, "question_id": 33000474, "link": "https://stackoverflow.com/questions/33000474/asp-5-mvc-6-sending-email/34117139#34117139", "title": "ASP 5, MVC 6 sending email", "body": "<p>My open source <a href=\"https://github.com/jstedfast/MimeKit\">MimeKit</a> and <a href=\"https://github.com/jstedfast/MailKit\">MailKit</a> libraries now support dnxcore50, which provide a really nice API for creating and sending email. As an added bonus, MimeKit supports DKIM signatures which is becoming more and more a must-have feature.</p>\n\n<pre><code>using System;\n\nusing MailKit.Net.Smtp;\nusing MailKit;\nusing MimeKit;\n\nnamespace TestClient {\n    class Program\n    {\n        public static void Main (string[] args)\n        {\n            var message = new MimeMessage ();\n            message.From.Add (new MailboxAddress (\"Joey Tribbiani\", \"joey@friends.com\"));\n            message.To.Add (new MailboxAddress (\"Mrs. Chanandler Bong\", \"chandler@friends.com\"));\n            message.Subject = \"How you doin'?\";\n\n            message.Body = new TextPart (\"plain\") {\n                Text = @\"Hey Chandler,\n\nI just wanted to let you know that Monica and I were going to go play some paintball, you in?\n\n-- Joey\"\n            };\n\n            using (var client = new SmtpClient ()) {\n                client.Connect (\"smtp.friends.com\", 587, false);\n\n                // Note: only needed if the SMTP server requires authentication\n                client.Authenticate (\"joey\", \"password\");\n\n                client.Send (message);\n                client.Disconnect (true);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 823, "user_id": 342581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de5d5c819aeb2216a181992be6d8a6d9?s=128&d=identicon&r=PG", "display_name": "Dan Jagnow", "link": "https://stackoverflow.com/users/342581/dan-jagnow"}, "is_accepted": false, "score": 1, "last_activity_date": 1490205699, "creation_date": 1490205699, "answer_id": 42959407, "question_id": 33000474, "link": "https://stackoverflow.com/questions/33000474/asp-5-mvc-6-sending-email/42959407#42959407", "title": "ASP 5, MVC 6 sending email", "body": "<p><strong>System.Net.Mail</strong> has been ported to .NET Core now.  See <a href=\"https://github.com/dotnet/corefx/issues/11792\" rel=\"nofollow noreferrer\">Issue 11792</a> in the <strong>corefx</strong> repo.  This change will be part of <a href=\"https://github.com/dotnet/standard/blob/master/docs/faq.md\" rel=\"nofollow noreferrer\">.NET Standard 2.0</a>.</p>\n"}], "owner": {"reputation": 3179, "user_id": 2501497, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f17a8edc1b8795ed8b2bdc45735e792a?s=128&d=identicon&r=PG", "display_name": "americanslon", "link": "https://stackoverflow.com/users/2501497/americanslon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8738, "favorite_count": 2, "accepted_answer_id": 33009734, "answer_count": 3, "score": 16, "last_activity_date": 1490205699, "creation_date": 1444244908, "last_edit_date": 1449403177, "question_id": 33000474, "link": "https://stackoverflow.com/questions/33000474/asp-5-mvc-6-sending-email", "title": "ASP 5, MVC 6 sending email", "body": "<p>I am dabbling with ASP 5/MVC 6 combination and I find that I no longer know how to do the simplest things. For example how do you send an email?</p>\n\n<p>In MVC 5 world I would do something like this:</p>\n\n<pre><code>using (var smtp = new SmtpClient(\"localhost\"))\n{\n    var mail = new MailMessage\n    {\n        Subject = subject,\n        From = new MailAddress(fromEmail),\n        Body = message\n    };\n\n    mail.To.Add(toEmail);\n    await smtp.SendMailAsync(mail);\n}\n</code></pre>\n\n<p>Now this code no longer compiles as <code>System.Net.Mail</code> seems to no longer exist. After some poking around the internet it seems it's no longer include in the new core (<code>dnxcore50</code>). Which brings me to my question...</p>\n\n<p>How do you send an email in the new world?</p>\n\n<p>And a larger question of where do you find substitutes for all the things that are no longer include in core .Net?</p>\n"}, {"tags": ["c#", ".net", "arrays", "client-server"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1444244990, "post_id": 33000449, "comment_id": 53825712, "body": "Additionally it looks like you need to skip columns 3-6 for rows 6 and 7."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444245081, "post_id": 33000449, "comment_id": 53825769, "body": "I don&#39;t think array is the right data structure here, a dictionary with a &quot;computer&quot; data structure would be more appropriate, using the hostname as the key and the <code>Computer</code> holding the row/column position, host name, and whatever data about the station you want."}, {"owner": {"reputation": 87, "user_id": 4529171, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/fijqM.jpg?s=128&g=1", "display_name": "charlie9495", "link": "https://stackoverflow.com/users/4529171/charlie9495"}, "edited": false, "score": 0, "creation_date": 1444245149, "post_id": 33000449, "comment_id": 53825815, "body": "it&#39;s already taken care of :), i just need a way to assign a certain value and retrieve it until the server stops receiving data"}, {"owner": {"reputation": 87, "user_id": 4529171, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/fijqM.jpg?s=128&g=1", "display_name": "charlie9495", "link": "https://stackoverflow.com/users/4529171/charlie9495"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444245339, "post_id": 33000449, "comment_id": 53825939, "body": "@RonBeyer I haven&#39;t looked into a dictionary. could you please provide me an example with your expanation about &quot;using the hostname as the key and the Computer holding the row/column position&quot; please. thank you"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4529171, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/fijqM.jpg?s=128&g=1", "display_name": "charlie9495", "link": "https://stackoverflow.com/users/4529171/charlie9495"}, "edited": false, "score": 1, "creation_date": 1444246076, "post_id": 33000734, "comment_id": 53826399, "body": "this looks neat and easier. by the way can i retain the sets of buttons I made or I have to make another UI?"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "reply_to_user": {"reputation": 87, "user_id": 4529171, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/fijqM.jpg?s=128&g=1", "display_name": "charlie9495", "link": "https://stackoverflow.com/users/4529171/charlie9495"}, "edited": false, "score": 1, "creation_date": 1444246222, "post_id": 33000734, "comment_id": 53826488, "body": "You can retain the buttons however you want, even setting an object reference to them in the <code>Computer</code>, but I would avoid that so you can separate your business logic from your UI logic."}, {"owner": {"reputation": 87, "user_id": 4529171, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/fijqM.jpg?s=128&g=1", "display_name": "charlie9495", "link": "https://stackoverflow.com/users/4529171/charlie9495"}, "edited": false, "score": 1, "creation_date": 1444246360, "post_id": 33000734, "comment_id": 53826559, "body": "hmm i see... i&#39;ll look into this more. thank you sir :)"}], "tags": [], "owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "is_accepted": true, "score": 3, "last_activity_date": 1444246073, "last_edit_date": 1444246073, "creation_date": 1444245762, "answer_id": 33000734, "question_id": 33000449, "link": "https://stackoverflow.com/questions/33000449/assigning-value-to-a-two-dimensional-array/33000734#33000734", "title": "Assigning value to a two dimensional array", "body": "<p>Here is an example of what I think would be a better data structure:</p>\n\n<p>For the Computer, you need to hold some information, so create a class for the computer:</p>\n\n<pre><code>public class Computer\n{\n    public string HostName { get; set; }\n    public int Row { get; set; }\n    public int Column { get; set; }\n    //Whatever else you want to add, like\n    public bool IsActive { get; set; }\n    public bool IsScrewingAround { get; set; }\n}\n</code></pre>\n\n<p>Then you can use a dictionary to store the data:</p>\n\n<pre><code>public Dictionary&lt;string, Computer&gt; _computers = \n     new Dictionary&lt;string, Computer&gt;(StringComparer.OrdinalIgnoreCase);\n</code></pre>\n\n<p>And you add computers to it like:</p>\n\n<pre><code>_computers.Add(\"someHostName\", new Computer() \n    { \n      HostName = \"someHostName\", \n      Row = 0,  \n      Column = 4, \n      IsActive = true, \n      IsScrewingAround = false \n    });\n</code></pre>\n\n<p>Then you can look up Computers by host name in an O(1) operation like:</p>\n\n<pre><code>var cpu = _computers[\"hostName\"];\n</code></pre>\n\n<p>Or get a list of computers that are screwing around:</p>\n\n<pre><code>var screwOffs = _computers.Values.Where(c =&gt; c.IsScrewingAround);\n</code></pre>\n\n<p>Want all the computers in row 4?</p>\n\n<pre><code>var row4 = _computers.Values.Where(c =&gt; c.Row == 4);\n</code></pre>\n\n<p>This gives you an advantage over an array that it can grow based on the number of <code>Computer</code>s added to it in case your room shape changes. </p>\n\n<p>Really this could be a <code>List&lt;Computer&gt;</code> if you don't need the O(1) look-up for the host name, which I'm guessing would be fine given the relatively small number of items you have in the classroom. </p>\n"}], "owner": {"reputation": 87, "user_id": 4529171, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/fijqM.jpg?s=128&g=1", "display_name": "charlie9495", "link": "https://stackoverflow.com/users/4529171/charlie9495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "accepted_answer_id": 33000734, "answer_count": 1, "score": 0, "last_activity_date": 1444246073, "creation_date": 1444244825, "question_id": 33000449, "link": "https://stackoverflow.com/questions/33000449/assigning-value-to-a-two-dimensional-array", "title": "Assigning value to a two dimensional array", "body": "<p>I have a client server program. The client are the students so I've made a seat plan that generates two dimensional button arrays.</p>\n\n<pre><code>Button[,] btnSeat = new Button[8, 6];\n</code></pre>\n\n<p>How can I assign the client's hostname to each button once a client is online? Assuming there is already a hostname. Assign the first user who goes online to the first array[0,0] and the second to array[0,1] and so on....? </p>\n\n<p>This is the layout of my seat plan\n<a href=\"https://i.stack.imgur.com/9frXg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9frXg.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I also need to retrieve array[x,y] that is equals to that hostname. Please help, thank you.</p>\n"}, {"tags": ["c#", "asp.net", "forms", "webforms"], "comments": [{"owner": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 1, "creation_date": 1444245082, "post_id": 33000358, "comment_id": 53825771, "body": "I&#39;m not sure what might be happening but you have a comment in your <code>finally</code> statement that is wrong.  <code>finally</code> is <b>always</b> called, even if there is an exception."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1444245375, "post_id": 33000358, "comment_id": 53825971, "body": "Don&#39;t do <code>catch (Exception ex)  { throw ex; }</code>, You destroy the original stack trace, making it <i>harder</i> to find the root of the problem.Don&#39;t use a catch block unless you intend to do something with the exception (like log it).  In that case you would re-throw the exception with <code>throw;</code> rather than <code>throw ex;</code>"}, {"owner": {"reputation": 942, "user_id": 3232812, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KXD6e.jpg?s=128&g=1", "display_name": "Culme", "link": "https://stackoverflow.com/users/3232812/culme"}, "edited": false, "score": 0, "creation_date": 1444287280, "post_id": 33000358, "comment_id": 53841277, "body": "If there is a known delay between form submission and the display of the &quot;thank you&quot; page, perhaps the user&#39;s might click the browser back button and resubmit the form believing that the delay meant something didn&#39;t work? Never underestimate the imagination and restlessness of Internet users... ;-)"}, {"owner": {"reputation": 6013, "user_id": 392591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/zxPUm.png?s=128&g=1", "display_name": "Jacques", "link": "https://stackoverflow.com/users/392591/jacques"}, "reply_to_user": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "edited": false, "score": 0, "creation_date": 1444291523, "post_id": 33000358, "comment_id": 53843814, "body": "@RickS - thanks for that, in the process of redacting the code I moved one or two things around. I&#39;ll move that back."}, {"owner": {"reputation": 6013, "user_id": 392591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/zxPUm.png?s=128&g=1", "display_name": "Jacques", "link": "https://stackoverflow.com/users/392591/jacques"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1444291530, "post_id": 33000358, "comment_id": 53843818, "body": "@DStanley - thanks for the tip I&#39;ll certainly remove them although, there are no exceptions being thrown. Everything in the code succeeds without failure."}, {"owner": {"reputation": 6013, "user_id": 392591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/zxPUm.png?s=128&g=1", "display_name": "Jacques", "link": "https://stackoverflow.com/users/392591/jacques"}, "reply_to_user": {"reputation": 942, "user_id": 3232812, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KXD6e.jpg?s=128&g=1", "display_name": "Culme", "link": "https://stackoverflow.com/users/3232812/culme"}, "edited": false, "score": 0, "creation_date": 1444291534, "post_id": 33000358, "comment_id": 53843820, "body": "@Culme - We actually added code, mentioned in the Attempted Solutions section, that prevents the user from manually taking double actions."}, {"owner": {"reputation": 942, "user_id": 3232812, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KXD6e.jpg?s=128&g=1", "display_name": "Culme", "link": "https://stackoverflow.com/users/3232812/culme"}, "edited": false, "score": 0, "creation_date": 1444301816, "post_id": 33000358, "comment_id": 53850754, "body": "@Jaques, I noticed that you said you are hiding the form when the submit button is clicked. I meant that the user could back up and have it re-displayed and thus submit it again. Depending on the actual application, this may or may not be a plausible cause - I guess you&#39;ve ruled it out."}, {"owner": {"reputation": 942, "user_id": 3232812, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KXD6e.jpg?s=128&g=1", "display_name": "Culme", "link": "https://stackoverflow.com/users/3232812/culme"}, "edited": false, "score": 0, "creation_date": 1444301931, "post_id": 33000358, "comment_id": 53850829, "body": "Tip: Check the IIS logs to see if there are multiple requests at the time when multiple emails/loggings occur. That will help you in determining if the cause is due to multiple postbacks or ...something else."}], "owner": {"reputation": 6013, "user_id": 392591, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/zxPUm.png?s=128&g=1", "display_name": "Jacques", "link": "https://stackoverflow.com/users/392591/jacques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444244512, "creation_date": 1444244512, "question_id": 33000358, "link": "https://stackoverflow.com/questions/33000358/very-difficult-to-diagnose-asp-net-webform-process-sequence-resulting-in-duplica", "title": "Very difficult to diagnose Asp.net WebForm process sequence resulting in duplication of actions", "body": "<p><strong>General Description</strong><br>\nI find myself having to diagnose a very annoying yet serious issue with such simple code that it is inexplicable where the problem could be coming from.   </p>\n\n<p>Our website allows a user to click a Contact Me button, fill in some details and the end result is that someone at one of our branches should recieve an email telling them to contact person X, and the event is logged to the database in an audit table.   </p>\n\n<p><strong>Symptoms</strong><br>\nAt times the notification and audit log actions are being completed multiple times. <strong>NOTE: This is steps 5 and 6 in the diagram and both are duplicated when this happens, it's never one or the other.</strong> </p>\n\n<ol>\n<li>The number of duplications is not consistent. Sometimes you get 2 emails and 2 audit logs, sometimes 3 sometimes more. </li>\n<li>The occurrence of the problem is not consistent</li>\n</ol>\n\n<p><strong>Diagram</strong><br>\nThe diagram illustrates the sequence of events.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/n0N7L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n0N7L.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Attempted Solutions</strong><br>\nHere's what I've tried so far:  </p>\n\n<ul>\n<li>User Error (Clicking multiple times) - I assumed that the user might be clicking the Submit button more than once [the server can be a bit slow to respond sometimes and based on the fact that it's an iframe dailog they wouldn't see that it is actually being processed], which would account for the fact that this is happening intermittently and a variable number of duplications occur. To this end we added code to hide the entire form on clicking submit and replaced it with a loading GIF to give the user feedback and prevent them from clicking submit again. </li>\n<li>User Error (F5 and Ok) - I also thought the user might be hitting F5 and resubmitting the form. However, after submission our forms redirect to another page altogether so refreshing will only result in a Thank You page being reloaded. Can't be that.   </li>\n</ul>\n\n<h2>The Code</h2>\n\n<p><strong>WebForm Button_Click handler</strong><br>\nSequence (4) in the diagram.   </p>\n\n<pre><code>protected void ContactSendButton_Click(object sender, EventArgs e)\n{\n    try\n    {\n        if (Page.IsValid)\n        {\n            Communications.SendContactUsEmail(FromName.Text, FromEmail.Text, FromPhone.Text, BranchID);\n        }\n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n}\n</code></pre>\n\n<p><strong>Send Email Notification</strong><br>\nSequence (5) in the diagram.  </p>\n\n<pre><code>public void SendContactUsEmail(string name, string email, string phone, int branchID)\n{\n    SmtpClient smtp = new SmtpClient();\n\n    MailMessage mailMessage = new MailMessage(\"webmaster@oursite.com\", \"agent@oursite.com\");\n    mailMessage.Subject = \"Contact Request\";\n    mailMessage.Body = \"Name: \" + name +\n                        \"\\r\\nEmail: \" + email +\n                        \"\\r\\nPhone: \" + phone;\n\n    try\n    {\n        smtp.Send(mailMessage);\n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n    finally\n    {\n        //log entry should only be created if the message was sent without error\n        CommunicationsData.LogContactCompanyDetails(name, email, phone, branchID);\n    }\n}  \n</code></pre>\n\n<p><strong>Audit Log Entry</strong><br>\nSequence (6) in the diagram.  </p>\n\n<pre><code>public void LogContactCompanyDetails(string name, string email, string phone, int branchID)\n{\n    try\n    {\n        using (SqlConnection _sqlConnection = new SqlConnection(_sqlConnectionString))\n        {\n            var sqlCommand = new SqlCommand(\"dbo.CreateContactAuditLog\", _sqlConnection);\n            sqlCommand.CommandType = CommandType.StoredProcedure;\n            sqlCommand.Parameters.Add(new SqlParameter(\"from_name\", name));\n            sqlCommand.Parameters.Add(new SqlParameter(\"from_email\", email));\n            sqlCommand.Parameters.Add(new SqlParameter(\"from_phone\", phone));\n            sqlCommand.Parameters.Add(new SqlParameter(\"branch_id\", branchID));\n\n            _sqlConnection.Open();\n            sqlCommand.ExecuteScalar();\n            _sqlConnection.Close();\n        }\n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n}  \n</code></pre>\n\n<p>There's nothing complicated here so I'm at a loss and desperate! </p>\n"}, {"tags": ["c#", "sms-gateway"], "comments": [{"owner": {"reputation": 343, "user_id": 1757418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAZI9.jpg?s=128&g=1", "display_name": "Rolando Retana", "link": "https://stackoverflow.com/users/1757418/rolando-retana"}, "edited": false, "score": 2, "creation_date": 1444244380, "post_id": 33000257, "comment_id": 53825299, "body": "So, what is the question?"}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1444244832, "post_id": 33000257, "comment_id": 53825597, "body": "please write in proper english. i tried to fix your mistakes. but check them out if i didnt change the meaning..."}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444247845, "post_id": 33000257, "comment_id": 53827504, "body": "What library are you using to interact with AD?"}, {"owner": {"reputation": 1, "user_id": 5419971, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206531620467124/picture?type=large", "display_name": "Magnus Lund-jensen", "link": "https://stackoverflow.com/users/5419971/magnus-lund-jensen"}, "edited": false, "score": 0, "creation_date": 1444284599, "post_id": 33000257, "comment_id": 53839831, "body": "Landpy ActiveDirectory"}], "owner": {"reputation": 1, "user_id": 5419971, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206531620467124/picture?type=large", "display_name": "Magnus Lund-jensen", "link": "https://stackoverflow.com/users/5419971/magnus-lund-jensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444247487, "creation_date": 1444244134, "last_edit_date": 1444247487, "question_id": 33000257, "link": "https://stackoverflow.com/questions/33000257/c-password-recovery-and-sms-gateway", "title": "C# Password recovery and SMS gateway", "body": "<p>I am trying to make a program in forms that resets a password in AD and then sends a SMS to the user with the NYE code.</p>\n\n<p>I have got it to work, but it uses my login and password to reset the password for the user. and as et is right now if a user get there hand,s on the program thay can make password reset,s fore fx Administrator.</p>\n\n<p>the Quistion is how do i make the program so that is taks the Username and password from the computer that is logt ind to the domain so it only is Users vith password reset promisions that cane make the Password reset.</p>\n\n<p>I am  dyslexic so very sory for my english </p>\n\n<pre><code>private readonly IADOperator _adOperator = new ADOperator(@\"administrator\", \"Password\",\"Domain\");\n</code></pre>\n\n<p>Can you help?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444244612, "post_id": 33000199, "comment_id": 53825465, "body": "What do you mean by &quot;<i>invoke an editor</i>&quot;?  Presumably every one of your implementation has to do something here, so just add another method to your interface for it.  Once you&#39;ve done that, just add an implementation of that method on all of your classes that implement the interface, and you&#39;ll be able to call the method with any of your comparators."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "reply_to_user": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444244871, "post_id": 33000199, "comment_id": 53825623, "body": "By Invoke an editor, I mean just that. A dialog box should present the user with a list of comparator names (File name, File Extension and so on). When use &quot;clicks&quot; edit, I need to create the correct editor based upon the ICompareFile instance. The instance of which come from a list, so I have basically lost type information."}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444245076, "post_id": 33000199, "comment_id": 53825764, "body": "You haven&#39;t <i>lost</i> any type information, it&#39;s just not accessible at compile-time.  Calls to <code>GetType()</code> will return the actual type instead of the interface."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "reply_to_user": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444245179, "post_id": 33000199, "comment_id": 53825837, "body": "I appreciate that, but what I don&#39;t want is something like... switch (fileComparator.GetType().Name {   case &quot;CompareFileName&quot; : DoSomething(); break;   case &quot;CompareFileExtension&quot; : DoSomethingDifferent(); break;   case &quot;CompareFileDateCreated&quot; : DoSomethingEvenMoreDifferent(); break; }"}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444245412, "post_id": 33000199, "comment_id": 53825986, "body": "If the desire is to split the comparator logic with the interface for editing it, just add a new generic interface with a type constraint (<code>interface ICompareFileUI&lt;TComparator&gt; where TComparator: ICompareFile</code>) and have it expose some manner of building and managing the editor user-interface for a particular implementation of <code>ICompareFile</code>."}, {"owner": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444245755, "post_id": 33000199, "comment_id": 53826213, "body": "Will every &quot;plugin class&quot; be responsible for its own UI? I&#39;d like to understand how this is going to be packaged. This will need to have a bearing on how you plan to patternize."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "edited": false, "score": 0, "creation_date": 1444246119, "post_id": 33000199, "comment_id": 53826435, "body": "Not sure at the moment. Currently, I have implemented some basic comparators and UI. However, thinking ahead, I would like 3rd parties to be able to develop their own filters as seen  fir for their own processing needs"}, {"owner": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444246473, "post_id": 33000199, "comment_id": 53826643, "body": "@Karl: then probably you do not want to maintain the relationship between the UI and the comparator in a central place (e.g. via a <code>dictionary</code>) but rather, keep the relationship atomic (i.e. UI knows what comparator it is servicing). In which case every UI should dependency inject the comparator it plans to present. Which then means that the picklist you present should really be the list of the available UI&#39;s."}, {"owner": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444246618, "post_id": 33000199, "comment_id": 53826747, "body": "Sorry another clarification: of course pretty much every DI framework allows you to pull up a list of classes implementing a specific interface. So if you have an <code>IComparatorPresenter</code> implemented in these UIs, there&#39;s your pick list..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "reply_to_user": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444246847, "post_id": 33000199, "comment_id": 53826879, "body": "@code4life - Initially I was thinking this. I like to keep code compact, pigeon-holed, dare I say. The thing is, this software is service-oriented and UI oriented. Never really been involved in UI development, mainly middle-tier, back end etc. Really appreciate your input though! I actually do like the idea of a central place to control this. Should make debugging easier when the need arises"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "reply_to_user": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444247222, "post_id": 33000199, "comment_id": 53827107, "body": "@code4life - not sure how that really works. Are you saying that when a user adds a new comparator, I create an object that contains the Comparator and the object. Maybe a UIFileComparator object?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "edited": false, "score": 0, "creation_date": 1444245473, "post_id": 33000566, "comment_id": 53826019, "body": "I considered this, but wasn&#39;t to sure how to code against my requirements.  Could you supply pseudo-code as to how I might use the Strategy Pattern? Thanks."}], "tags": [], "owner": {"reputation": 9776, "user_id": 1688439, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52818f5444acf8fbdab4697cd218825e?s=128&d=identicon&r=PG", "display_name": "Owen Pauling", "link": "https://stackoverflow.com/users/1688439/owen-pauling"}, "is_accepted": false, "score": 0, "last_activity_date": 1444245161, "creation_date": 1444245161, "answer_id": 33000566, "question_id": 33000199, "link": "https://stackoverflow.com/questions/33000199/separating-ui-from-data-logic/33000566#33000566", "title": "Separating UI from data/logic", "body": "<p>I would suggest using the <a href=\"https://en.wikipedia.org/wiki/Strategy_pattern\" rel=\"nofollow\">Strategy Pattern</a> here because you are creating an algorithm whose behaviour is assembled by the user. Your <code>ICompareFile</code> interface would be the inferface for the strategies, and your filter would contain a collection of these based on what the user has selected. </p>\n"}, {"comments": [{"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 1, "creation_date": 1444245648, "post_id": 33000665, "comment_id": 53826132, "body": "This doesn&#39;t seem very <i>extensible</i>.  You won&#39;t be able to add new comparators (or their editors) without modifications to the code."}, {"owner": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "reply_to_user": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444245837, "post_id": 33000665, "comment_id": 53826262, "body": "@JoshuaShearer pressed &lt;Tab&gt;&lt;Enter&gt; by habit, ended up with a prematurely published answer"}, {"owner": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 1, "creation_date": 1444245940, "post_id": 33000665, "comment_id": 53826322, "body": "@StenPetrov: not a big fan of <code>Activator.CreateInstance</code>. How will you handle dependency injection requirements? So many pain points from this approach."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "edited": false, "score": 0, "creation_date": 1444245997, "post_id": 33000665, "comment_id": 53826348, "body": "Excellent, that seems like a fairly robust solution to a fairly complex problem. Best is that if I do delegate to plugins, the &quot;plugin developer&quot; just needs to call Register with the Comparator and the editor. Nice, succint solutions, many thanks"}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1444246117, "post_id": 33000665, "comment_id": 53826433, "body": "@StenPetrov Ah, this is much better.  I originally thought you were suggesting using a collection initializer to map the classes at compile-time, but I&#39;m glad I was mistaken."}, {"owner": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "reply_to_user": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444246138, "post_id": 33000665, "comment_id": 53826447, "body": "@code4life Absolutely! Not a fan of it either, but it&#39;s there for simplicity&#39;s sake. I would go with it until it doesn&#39;t work, at least it&#39;s one place where the View is obtained, so even if you refactor it the rest of your UI code won&#39;t know"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "edited": false, "score": 0, "creation_date": 1444246239, "post_id": 33000665, "comment_id": 53826493, "body": "I must say, this is a great use of the factory pattern. To think I have been developing software for over 15 years, stumped me this one did. Thanks guys, for your help"}, {"owner": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 1, "creation_date": 1444246299, "post_id": 33000665, "comment_id": 53826526, "body": "@StenPetrov: lemme be the devil&#39;s advocate: what if we just didn&#39;t use a factory pattern at all, and used pure dependency injection oriented SRP approach? The classic patterns are dying out these days because they orient towards chunky large blocks of code, wherease SRP drives towards smaller and smaller blocks of code (kind of like lego blocks, lol)..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "edited": false, "score": 0, "creation_date": 1444246540, "post_id": 33000665, "comment_id": 53826689, "body": "@codeForLife - For my solution, I do not need fancy stuff, like dependency injection. I need a solution to solve a particular problem. I think sometimes, one can over think a problem. Just my input, no offence and all :-)"}, {"owner": {"reputation": 3573, "user_id": 1449587, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7f15222a49d2be8ab93a93892ab123fe?s=128&d=identicon&r=PG", "display_name": "sksallaj", "link": "https://stackoverflow.com/users/1449587/sksallaj"}, "reply_to_user": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444247124, "post_id": 33000665, "comment_id": 53827045, "body": "I was thinking about the same thing - as what @code4life suggested (considering dependency injection) I&#39;ve used really small libraries that gets the job done, like simpleinjector, which is amazingly efficient at what it does. And it&#39;s pretty simple to wrap your head around."}, {"owner": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "reply_to_user": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1444253624, "post_id": 33000665, "comment_id": 53830505, "body": "@code4life please feel free to express your idea in an answer. While in principle I agree - the best design would rely on IoC etc, simplicity is a feature I personally value greatly. For the needs of the OP I perceived I believe the simplest and most straightforward solution to be a Factory. As these needs evolve the Factory offers one-stop refactoring. Basically nothing is lost"}], "tags": [], "owner": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "is_accepted": true, "score": 1, "last_activity_date": 1444246011, "last_edit_date": 1444246011, "creation_date": 1444245508, "answer_id": 33000665, "question_id": 33000199, "link": "https://stackoverflow.com/questions/33000199/separating-ui-from-data-logic/33000665#33000665", "title": "Separating UI from data/logic", "body": "<p>One approach is to use a <a href=\"https://en.wikipedia.org/wiki/Factory_method_pattern\" rel=\"nofollow\">Factory</a> pattern.</p>\n\n<p>In your Factory you will register concrete classes and their corresponding UI classes, such as:</p>\n\n<pre><code>public class FileCompareUIFactory{\n// pseudo code, needs work\n  private Dictionary&lt;Type,Type&gt; registered = new {\n    { typeof(FileCompareNames), typeof(FileCompareNamesUIView)}\n  }\n  public void Register&lt;C,V&gt; where C: IFileCompare, V: View{\n    registered[typeof(C)] = typeof(V);\n  }\n\n  public V GetView&lt;C,V&gt;() where C:IFileCompare, V: View {\n    // cache already instantiated if needed\n    return (V)(Activator.CreateInstance(registered[typeof(C)])\n  }\n}\n</code></pre>\n\n<p>You can also make the Factory a singleton and require all plugin file comparators to register in the factory</p>\n\n<pre><code>public class FileCompareUIFactory{\n  private static FileCompareUIFactory _instance = null;\n  public FileCompareUIFactory Instance{\n    get{ return (_instance = _instance ?? new FileCompareUIFactory()); }\n  }\n  protected FileCompareUIFactory(){ }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2225284"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "closed_date": 1444257579, "accepted_answer_id": 33000665, "answer_count": 2, "score": 0, "last_activity_date": 1444246509, "creation_date": 1444243895, "last_edit_date": 1444246509, "question_id": 33000199, "link": "https://stackoverflow.com/questions/33000199/separating-ui-from-data-logic", "closed_reason": "Needs more focus", "title": "Separating UI from data/logic", "body": "<p>I am working on a file indexing application that generates file-meta data for use by 3rd party applications. To reduce the working set, I use file filters. Each file filter contains a number of comparators (e.g. CompareFileName, CompareFile Extension, CompareFileDateCreated). All comparators implements a simple ICompareFile interface.</p>\n\n<pre><code>public interface ICompareFile\n{\n  bool Compare(IFile file);\n}\n</code></pre>\n\n<p>This works well for raw coding/testing. The problem I have is when trying to create an editor via the user interface. My FileFilter class contains a list of ICompareFile instances. So, my question is, what is the best approach to invoke an editor when a user selects an ICompareFile from a List.</p>\n\n<p>Initially, I was thinking the visitor pattern, however, I may delegate comparators to a plugin class, of which I will supply basic, well-known implementations. In short, the solution must be extensible.</p>\n\n<p>My aim is to separate the representation from the data. For example, I could display a comparator in numerous ways. However, the data is pretty static.</p>\n\n<p>The problem is really about mapping an editor (of some sort) to an ICompareFile instance.</p>\n\n<p>My question, is should the ICompareFile concrete implementation specify its editor or should an external class do this. Personally, I think the latter, (SOLID and DRY principles).</p>\n"}, {"tags": ["c#", "activemq", "nms"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 831075, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/49bb2fee3d3447f7a662764d9aedea13?s=128&d=identicon&r=PG", "display_name": "Mubashir Koul", "link": "https://stackoverflow.com/users/831075/mubashir-koul"}, "edited": false, "score": 0, "creation_date": 1527799651, "post_id": 33000655, "comment_id": 88275294, "body": "msaero, what is wrong with this code.  <a href=\"https://stackoverflow.com/questions/50632265/connection-closes-after-few-seconds-when-connecting-to-activemq-set-up-on-aws\" title=\"connection closes after few seconds when connecting to activemq set up on aws\">stackoverflow.com/questions/50632265/&hellip;</a>"}], "tags": [], "owner": {"reputation": 74, "user_id": 1884104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45a5f02759d39aa1631bb4cc1790e52?s=128&d=identicon&r=PG", "display_name": "msaero", "link": "https://stackoverflow.com/users/1884104/msaero"}, "is_accepted": true, "score": 1, "last_activity_date": 1444245464, "creation_date": 1444245464, "answer_id": 33000655, "question_id": 33000185, "link": "https://stackoverflow.com/questions/33000185/how-to-maintain-activemq-connection-open/33000655#33000655", "title": "How to maintain ActiveMQ connection open?", "body": "<p>Please take the connection object out of using block. It will do. \nIn C# API normal connection is durable, in STOMP one have to set heartbeat.</p>\n"}], "owner": {"reputation": 4282, "user_id": 578808, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/fdMGa.png?s=128&g=1", "display_name": "eestein", "link": "https://stackoverflow.com/users/578808/eestein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 0, "accepted_answer_id": 33000655, "answer_count": 1, "score": 0, "last_activity_date": 1444245464, "creation_date": 1444243867, "question_id": 33000185, "link": "https://stackoverflow.com/questions/33000185/how-to-maintain-activemq-connection-open", "title": "How to maintain ActiveMQ connection open?", "body": "<p>I'm using Apache ActiveMQ to integrate my app to a custom service. I need to make this run always, not one time like it's right now. \nThe code below works, but only for one message, I need to maintain the connection active in order to receive all the messages. </p>\n\n<pre><code>using (var connection = (Apache.NMS.ActiveMQ.Connection)factory.CreateConnection())\n{\n   connection.UserName = Username;\n   connection.Password = Password;\n\n   using (var session = connection.CreateSession())\n   {\n        IDestination destination = SessionUtil.GetDestination(session, \"queue://\" + Queue);\n\n        using (IMessageConsumer consumer = session.CreateConsumer(destination))\n        //using (IMessageConsumer consumer = session.CreateDurableConsumer(new ActiveMQTopic(Queue), \"fpapp\", null, false))\n        {\n            consumer.Listener += ConsumerOnListener;\n            connection.Start();\n        }\n    }\n}\n</code></pre>\n\n<p>I did some research and found out I should create a durable consumer, and that's what I tried  (commented line). But it doesn't work, it says network connections can't subscribe to topics.</p>\n\n<p>Any ideas?</p>\n\n<p>PS: I'm completely new to ActiveMQ.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "visual-studio"], "comments": [{"owner": {"reputation": 1007, "user_id": 3769412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aef035a16cb34b932d01c38edd223c1?s=128&d=identicon&r=PG&f=1", "display_name": "Daemedeor", "link": "https://stackoverflow.com/users/3769412/daemedeor"}, "edited": false, "score": 2, "creation_date": 1444243744, "post_id": 33000122, "comment_id": 53824903, "body": "is that typo &quot;no&quot; == &quot;nos&quot;?"}, {"owner": {"reputation": 23, "user_id": 4530045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474c332966f300889c3f5389886e5b43?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Sahasrabuddhe", "link": "https://stackoverflow.com/users/4530045/saurabh-sahasrabuddhe"}, "reply_to_user": {"reputation": 1007, "user_id": 3769412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6aef035a16cb34b932d01c38edd223c1?s=128&d=identicon&r=PG&f=1", "display_name": "Daemedeor", "link": "https://stackoverflow.com/users/3769412/daemedeor"}, "edited": false, "score": 0, "creation_date": 1444243792, "post_id": 33000122, "comment_id": 53824937, "body": "Yes, its &quot;nos&quot; at both places. Sorry"}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1444243941, "post_id": 33000122, "comment_id": 53825038, "body": "did your problem fixed now? how could you debug when you get error at compiletime"}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 2, "creation_date": 1444243951, "post_id": 33000122, "comment_id": 53825045, "body": "Please post code that is actually valid. It&#39;s really hard to tell where a problem might be if the code isn&#39;t valid to start with."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 1, "creation_date": 1444244094, "post_id": 33000122, "comment_id": 53825135, "body": "Place the breakpoint <i>after</i> the line to be executed, not on it. Since its the last line in the method, place the breakpoint on the closing brace of the method. Either that or step to the next statement after hitting the breakpoint."}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444244187, "post_id": 33000122, "comment_id": 53825180, "body": "@RonBeyer: Or you can place it on the line, then press F10 to step over and <i>then</i> check the value in <code>no</code> (or <code>nos</code> or whatever it&#39;s supposed to be)."}, {"owner": {"reputation": 23, "user_id": 4530045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474c332966f300889c3f5389886e5b43?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Sahasrabuddhe", "link": "https://stackoverflow.com/users/4530045/saurabh-sahasrabuddhe"}, "edited": false, "score": 0, "creation_date": 1444244231, "post_id": 33000122, "comment_id": 53825212, "body": "Can not post any more code, sorry about that :( I have seen VS do this earlier as well. I am using VS Ultimate 13. The breakpoint is after the nos = MyDictionary... line... I am trying to run step by step.. It just does not recognize the variable not gives me any errors."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 1, "creation_date": 1444244383, "post_id": 33000122, "comment_id": 53825302, "body": "This can also happen if you are running the debugger in release mode and it has optimized away <code>nos</code>."}, {"owner": {"reputation": 2125, "user_id": 2037335, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/BupT4.jpg?s=128&g=1", "display_name": "Jude", "link": "https://stackoverflow.com/users/2037335/jude"}, "edited": false, "score": 1, "creation_date": 1444244748, "post_id": 33000122, "comment_id": 53825552, "body": "<code>private nos</code>. What&#39;s that mean? Where is the type? Paste the code as is."}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 1, "creation_date": 1444245581, "post_id": 33000122, "comment_id": 53826095, "body": "@SaurabhSahasrabuddhe: If you can&#39;t give enough information for people to be able to reproduce the problem, then how do you expect anybody to be able to help? See <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 23, "user_id": 4530045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474c332966f300889c3f5389886e5b43?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Sahasrabuddhe", "link": "https://stackoverflow.com/users/4530045/saurabh-sahasrabuddhe"}, "edited": false, "score": 0, "creation_date": 1444246917, "post_id": 33000122, "comment_id": 53826923, "body": "Matt, i will keep that in mind. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 5419942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d5f76a1b8e30c50697ebdd7940e755?s=128&d=identicon&r=PG&f=1", "display_name": "CBri", "link": "https://stackoverflow.com/users/5419942/cbri"}, "is_accepted": false, "score": 0, "last_activity_date": 1444244253, "creation_date": 1444244253, "answer_id": 33000284, "question_id": 33000122, "link": "https://stackoverflow.com/questions/33000122/vs-studio-does-not-show-value-of-new-variable-during-debugging/33000284#33000284", "title": "VS studio does not show value of new variable during debugging", "body": "<p>Clean Solution and after that Build Solution. If it doesn't work, delete the bin and obj folders, build solution and try again.</p>\n"}], "owner": {"reputation": 23, "user_id": 4530045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474c332966f300889c3f5389886e5b43?s=128&d=identicon&r=PG&f=1", "display_name": "Saurabh Sahasrabuddhe", "link": "https://stackoverflow.com/users/4530045/saurabh-sahasrabuddhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1444244253, "creation_date": 1444243643, "last_edit_date": 1444243860, "question_id": 33000122, "link": "https://stackoverflow.com/questions/33000122/vs-studio-does-not-show-value-of-new-variable-during-debugging", "title": "VS studio does not show value of new variable during debugging", "body": "<p>Have a class</p>\n\n<pre><code>public class ABC\n{\n  private wt;\n  private nos;\n  MyDictionary1;\n  MyDictionary2;\n\n  public void XYZ(some arguements)\n  {\n    // Dictionaries are populated here ( I can see the contents during debug)\n\n    wt = MyDictionary1[arguements.key]; // wt was added last week. shows value during debugging\n    no = MyDictionary1[arguements.key]; // Added no today, does not show value during debudding\n   }\n\n}\n</code></pre>\n\n<p>The control does do to the line where no is being assigned a value. But when I add it to watch, VS says 'no' does not exist in current context. If both the variables are declared and populated the same way, I do not know why this is happening. \nCan someone please help? </p>\n"}, {"tags": ["c#", ".net", "struct"], "comments": [{"owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "edited": false, "score": 1, "creation_date": 1444243457, "post_id": 33000004, "comment_id": 53824738, "body": "Side note: Your struct is mutable.  Check out <a href=\"http://stackoverflow.com/questions/441309/why-are-mutable-structs-evil\" title=\"why are mutable structs evil\">stackoverflow.com/questions/441309/why-are-mutable-structs-e&zwnj;&#8203;vil</a>"}], "answers": [{"tags": [], "owner": {"reputation": 30265, "user_id": 3246555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ziIu9.png?s=128&g=1", "display_name": "AlexD", "link": "https://stackoverflow.com/users/3246555/alexd"}, "is_accepted": false, "score": 1, "last_activity_date": 1444243468, "creation_date": 1444243468, "answer_id": 33000071, "question_id": 33000004, "link": "https://stackoverflow.com/questions/33000004/why-is-an-unboxed-struct-rvalue-in-c/33000071#33000071", "title": "Why is an unboxed struct rvalue in c#", "body": "<p>See <a href=\"https://msdn.microsoft.com/en-us/library/1zd0a13x.aspx\" rel=\"nofollow\">MSDN</a>:</p>\n\n<blockquote>\n  <p>The result of an unboxing conversion is a temporary variable. The compiler prevents you from modifying such variables because any modification would go away when the temporary variable goes away. To fix this, declare a new value-type variable to store the intermediate expression, and assign the result of the unboxing conversion to that variable.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 9660, "user_id": 3256506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IbkJm.gif?s=128&g=1", "display_name": "Tamir Vered", "link": "https://stackoverflow.com/users/3256506/tamir-vered"}, "is_accepted": true, "score": 1, "last_activity_date": 1444244137, "last_edit_date": 1444244137, "creation_date": 1444243516, "answer_id": 33000083, "question_id": 33000004, "link": "https://stackoverflow.com/questions/33000004/why-is-an-unboxed-struct-rvalue-in-c/33000083#33000083", "title": "Why is an unboxed struct rvalue in c#", "body": "<p>Since <code>s</code> is a <code>struct</code> (a.k.a: a <a href=\"https://msdn.microsoft.com/en-us/library/t63sy5hs.aspx\" rel=\"nofollow\">value type</a>), <strong><em><code>(SPoint)o</code> is a copy of the data</em></strong>:</p>\n\n<p>From the C# language spec (\u00a71.3, \"Types and Variables\"):</p>\n\n<blockquote>\n  <p>When a value of a value type is converted to type object, an object instance, also called a \u201cbox,\u201d is allocated to hold the value, and the value is copied into that box. Conversely, when an object reference is cast to a value type, a check is made that the referenced object is a box of the correct value type, and, if the check succeeds, the value in the box is copied out.</p>\n</blockquote>\n\n<p><strong><em>The language protects you</em></strong> from changing the data <strong><em>of the cloned value type</em></strong> without putting it in a variable first, since you might think that you are changing the original <code>s.x</code> value while you are changing it's temporary (not - variabled) clone, unlike unsafe languages like C++/CLI where this kind of assignments might be allowed.</p>\n\n<p>If you want, you are able to explicitly create a new variable and do your manipulations in it:</p>\n\n<pre><code>SPoint cloneOfS = ((SPoint)o);\ncloneOfS.x = 5;\n</code></pre>\n"}], "owner": {"reputation": 4198, "user_id": 4396113, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/026c3ac09dad11029efe60f660e21dd5?s=128&d=identicon&r=PG&f=1", "display_name": "moped", "link": "https://stackoverflow.com/users/4396113/moped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "closed_date": 1444243710, "accepted_answer_id": 33000083, "answer_count": 2, "score": 0, "last_activity_date": 1482133242, "creation_date": 1444243213, "last_edit_date": 1482133242, "question_id": 33000004, "link": "https://stackoverflow.com/questions/33000004/why-is-an-unboxed-struct-rvalue-in-c", "closed_reason": "Duplicate", "title": "Why is an unboxed struct rvalue in c#", "body": "<p>Let's look at the following code.</p>\n\n<pre><code>struct SPoint\n{\n    public int x;\n    public int y;\n\n    public SPoint(int x, int y)\n    {\n        this.x = x;\n        this.y = y;\n    }\n}\n\nclass Test\n{\n\n    public static void Main()\n    {\n        SPoint s = new SPoint(3, 4);\n        object o = s;\n        ((SPoint) o).x = 5;\n    }\n}\n</code></pre>\n\n<p>Why isn't the last assignment possible? What is the reason for such behaviour?</p>\n"}, {"tags": ["c#", "multithreading", "generics", "task-parallel-library", "task"], "comments": [{"owner": {"reputation": 17815, "user_id": 1822514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2TMH.jpg?s=128&g=1", "display_name": "chue x", "link": "https://stackoverflow.com/users/1822514/chue-x"}, "edited": false, "score": 1, "creation_date": 1444243789, "post_id": 32999953, "comment_id": 53824934, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/10044099/is-there-a-generic-task-waitall\">Is there a generic Task.WaitAll?</a>"}, {"owner": {"reputation": 13828, "user_id": 4588915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTCr8.png?s=128&g=1", "display_name": "Jakub Lortz", "link": "https://stackoverflow.com/users/4588915/jakub-lortz"}, "reply_to_user": {"reputation": 17815, "user_id": 1822514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e2TMH.jpg?s=128&g=1", "display_name": "chue x", "link": "https://stackoverflow.com/users/1822514/chue-x"}, "edited": false, "score": 0, "creation_date": 1444244616, "post_id": 32999953, "comment_id": 53825468, "body": "@chuex The answers to that questions are outdated. There is a better way now."}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 1, "creation_date": 1444245062, "post_id": 32999953, "comment_id": 53825757, "body": "@Nair: Why are the tasks in an <i>observable collection</i> to begin with? Surely they aren&#39;t being data-bound..."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1444246084, "post_id": 32999953, "comment_id": 53826405, "body": "@StephenCleary, This code is just a stripped version to demonstrate the issue. Now to answer your question, the result from individual task has to be bound to a control in WPF and intention is to have responsive UI."}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 3, "creation_date": 1444246543, "post_id": 32999953, "comment_id": 53826691, "body": "@Nair: You can&#39;t bind to <code>Task&lt;T&gt;.Result</code> and have a responsive UI."}, {"owner": {"reputation": 135642, "user_id": 1870803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYakG.jpg?s=128&g=1", "display_name": "Yuval Itzchakov", "link": "https://stackoverflow.com/users/1870803/yuval-itzchakov"}, "edited": false, "score": 0, "creation_date": 1444246924, "post_id": 32999953, "comment_id": 53826927, "body": "Any reason you&#39;re not using <code>Microsoft.Bcl.Async</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1444245679, "post_id": 33000291, "comment_id": 53826162, "body": "Appreciate your support. Sorry I am using .NET 4."}, {"owner": {"reputation": 13828, "user_id": 4588915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTCr8.png?s=128&g=1", "display_name": "Jakub Lortz", "link": "https://stackoverflow.com/users/4588915/jakub-lortz"}, "reply_to_user": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1444246451, "post_id": 33000291, "comment_id": 53826626, "body": "@Nair If you&#39;re using .NET 4 in VS 2012 or higher, you can get Microsoft.Bcl.Async package from nuget and use TaskEx.WhenAny."}], "tags": [], "owner": {"reputation": 13828, "user_id": 4588915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTCr8.png?s=128&g=1", "display_name": "Jakub Lortz", "link": "https://stackoverflow.com/users/4588915/jakub-lortz"}, "is_accepted": true, "score": 2, "last_activity_date": 1444244265, "creation_date": 1444244265, "answer_id": 33000291, "question_id": 32999953, "link": "https://stackoverflow.com/questions/32999953/task-waitany-to-accept-taskt-instead-of-task/33000291#33000291", "title": "Task.WaitAny to accept Task&lt;T&gt; instead of Task [ ]", "body": "<p>There is a generic <code>Task.WhenAny</code></p>\n\n<pre><code>public static Task&lt;Task&lt;TResult&gt;&gt; WhenAny&lt;TResult&gt;(IEnumerable&lt;Task&lt;TResult&gt;&gt; tasks);\npublic static Task&lt;Task&lt;TResult&gt;&gt; WhenAny&lt;TResult&gt;(params Task&lt;TResult&gt;[] tasks);\n</code></pre>\n\n<p><code>await</code> it to get the completed task.</p>\n"}, {"comments": [{"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1444245701, "post_id": 33000461, "comment_id": 53826177, "body": "Appreciate your support. Sorry I am using .NET 4."}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "reply_to_user": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1444246005, "post_id": 33000461, "comment_id": 53826357, "body": "@Nair: Np, then just ignore the warning - <code>Task.WaitAny</code> does not modify the passed array anyway."}], "tags": [], "owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "is_accepted": false, "score": 2, "last_activity_date": 1444244859, "creation_date": 1444244859, "answer_id": 33000461, "question_id": 32999953, "link": "https://stackoverflow.com/questions/32999953/task-waitany-to-accept-taskt-instead-of-task/33000461#33000461", "title": "Task.WaitAny to accept Task&lt;T&gt; instead of Task [ ]", "body": "<p>You can use <a href=\"https://msdn.microsoft.com/en-us/library/hh194914(v=vs.110).aspx\" rel=\"nofollow\">Task.WhenAny</a> which in your case will even simplify your code like this  </p>\n\n<pre><code>var result = new ObservableCollection&lt;LenderScoreCard&gt;();\nvar parallelScoreList = parallelScore.ToList();\nwhile (parallelScoreList.Count != 0)\n{\n    var completedTask = Task.WhenAny(parallelScoreList).Result;\n    result.Add(completedTask.Result);\n    parallelScoreList.Remove(completedTask);\n}\n</code></pre>\n"}], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 2, "accepted_answer_id": 33000291, "answer_count": 2, "score": 4, "last_activity_date": 1444244859, "creation_date": 1444243001, "last_edit_date": 1444243321, "question_id": 32999953, "link": "https://stackoverflow.com/questions/32999953/task-waitany-to-accept-taskt-instead-of-task", "title": "Task.WaitAny to accept Task&lt;T&gt; instead of Task [ ]", "body": "<p>I have a collection of generic Tasks those are marked for execution. As and when a  task complete (using <code>Task.WaitAny</code>), I am adding it to an <code>ObservableCollection</code>.</p>\n\n<p>But, the issue is at <code>Task.WaitAny(...)</code> line, which says <strong>Co-variant array conversion from Task&lt;MyType&gt;[] to Task[] can cause run-time exception on write operation.</strong></p>\n\n<p>I am fairly knowledgeable on what this exception means and why it complains at this stage.</p>\n\n<p><strong>Question:</strong> Is there any generic version of <code>Task.WaitAny()</code>, which can take <code>Task&lt;T&gt;</code> as parameter instead of <code>Task[]</code>.</p>\n\n<p>Thanks in advance.</p>\n\n<p><a href=\"https://i.stack.imgur.com/axdux.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/axdux.png\" alt=\"code\"></a></p>\n"}, {"tags": ["c#", "linq", "memory"], "comments": [{"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1444257531, "post_id": 32999862, "comment_id": 53832107, "body": "<code>for (int i = 0; 0 &lt; itemAmmount; i++)</code> --&gt; <code>for (int i = 0; i &lt; itemAmmount; i++)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13828, "user_id": 4588915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTCr8.png?s=128&g=1", "display_name": "Jakub Lortz", "link": "https://stackoverflow.com/users/4588915/jakub-lortz"}, "is_accepted": false, "score": 5, "last_activity_date": 1444243261, "last_edit_date": 1444243261, "creation_date": 1444242821, "answer_id": 32999893, "question_id": 32999862, "link": "https://stackoverflow.com/questions/32999862/code-keeps-eating-memory/32999893#32999893", "title": "Code keeps eating Memory", "body": "<pre><code>for (int i = 0; 0 &lt; itemAmmount; i++)\n</code></pre>\n\n<p>You're not checking the loop counter, you're comparing 0 with <code>itemAmount</code>. That's an infinite loop.</p>\n\n<p>Try <code>for (int i = 0; i &lt; itemAmmount; i++)</code> instead.</p>\n\n<p>You can use code snippets in Visual Studio to avoid such errors. Type 'for' and press Tab twice, and a code snippet for <code>for</code> loop will be inserted with possibility to rename <code>i</code> and <code>length</code>:</p>\n\n<pre><code>for (int i = 0; i &lt; length; i++)\n{\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "is_accepted": false, "score": 2, "last_activity_date": 1444242831, "creation_date": 1444242831, "answer_id": 32999897, "question_id": 32999862, "link": "https://stackoverflow.com/questions/32999862/code-keeps-eating-memory/32999897#32999897", "title": "Code keeps eating Memory", "body": "<pre><code>for (int i = 0; 0 &lt; itemAmmount; i++)\n{\n    dropRate = Random.Next(1, 6);\n    Loot.Add(new Items(dropRate));\n}\n</code></pre>\n\n<p>you set <code>itemAmmount</code>, and never alter it.  The only way your loop will exit is if <code>itemAmmount</code> decreased (to below 0). </p>\n\n<p>Fix your <code>for</code> loop, so that it makes logical sense:</p>\n\n<pre><code>for(int i=0; i&lt;itemAmmount; i++)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5410833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4002a8292d210416632be64f7631800?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Ringenberg", "link": "https://stackoverflow.com/users/5410833/martin-ringenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1444243261, "creation_date": 1444242698, "question_id": 32999862, "link": "https://stackoverflow.com/questions/32999862/code-keeps-eating-memory", "title": "Code keeps eating Memory", "body": "<p>So basically this code asked how many items do I want to generate but after that just keep running without response.\nAnd just eats up ram.</p>\n\n<p>What I want it to do is ask amount of items to generate then state its name and its stats.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace TestingRNG\n{\nclass Program\n{\n    public static Random Random = new Random();\n    public static int dropRate, itemAmmount;\n    public static List&lt;Items&gt; Loot = new List&lt;Items&gt;();\n    public static List&lt;string&gt; WeaponList = new List&lt;string&gt; { \"Staff\", \"Sword\", \"Dagger\", \"Wand\", \"Axe\", \"Mace\" };\n    static void Main(string[] args)\n    {\n        Programs();\n    }\n    public static void Programs()\n    {\n        Console.WriteLine(\"How many items do you want to generate\");\n        itemAmmount = Int32.Parse(Console.ReadLine());\n\n        for (int i = 0; 0 &lt; itemAmmount; i++)\n        {\n            dropRate = Random.Next(1, 6);\n            Loot.Add(new Items(dropRate));\n        }\n        foreach (var Item in Loot)\n        {\n            Console.WriteLine(Item.Name);\n            if (WeaponList.Contains(Item.ItemType))\n            {\n                Console.WriteLine(Item.Damage);\n            }\n            else\n            {\n                Console.WriteLine(Item.HP);\n                Console.WriteLine(Item.MANA);\n            }\n            Console.ReadLine();\n\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c#", "sql", "sql-server", "linq"], "comments": [{"owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 0, "creation_date": 1444242472, "post_id": 32999742, "comment_id": 53824198, "body": "does this answer your question?  <a href=\"http://stackoverflow.com/questions/1442891/is-linq-generally-slower-than-a-equal-sql-statement\" title=\"is linq generally slower than a equal sql statement\">stackoverflow.com/questions/1442891/&hellip;</a>"}, {"owner": {"reputation": 21279, "user_id": 507793, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/6G686.jpg?s=128&g=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/507793/matthew"}, "edited": false, "score": 1, "creation_date": 1444242548, "post_id": 32999742, "comment_id": 53824233, "body": "What query does the database end up receiving?"}, {"owner": {"reputation": 16714, "user_id": 426894, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/LyG6D.jpg?s=128&g=1", "display_name": "asawyer", "link": "https://stackoverflow.com/users/426894/asawyer"}, "edited": false, "score": 0, "creation_date": 1444242779, "post_id": 32999742, "comment_id": 53824352, "body": "What exactly is the question here?"}, {"owner": {"reputation": 8181, "user_id": 1220627, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bcc4752767827a60b2e32ac3d090f337?s=128&d=identicon&r=PG", "display_name": "Sn&#230;bj&#248;rn", "link": "https://stackoverflow.com/users/1220627/sn%c3%a6bj%c3%b8rn"}, "edited": false, "score": 0, "creation_date": 1444242905, "post_id": 32999742, "comment_id": 53824412, "body": "To me the two linq quries should do the exact same thing. They also produce the same results. But the sequential linq expression take a very long time to execute. I don&#39;t understand why"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 2, "creation_date": 1444243012, "post_id": 32999742, "comment_id": 53824469, "body": "How are you measuring it?  Are you measuring both the query and <code>ToDictionary</code> in the first case?  The query doesn&#39;t actually get executed until <code>ToDictionary</code> is called."}, {"owner": {"reputation": 8181, "user_id": 1220627, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bcc4752767827a60b2e32ac3d090f337?s=128&d=identicon&r=PG", "display_name": "Sn&#230;bj&#248;rn", "link": "https://stackoverflow.com/users/1220627/sn%c3%a6bj%c3%b8rn"}, "edited": false, "score": 0, "creation_date": 1444243156, "post_id": 32999742, "comment_id": 53824551, "body": "Yes it&#39;s measured after the ToDict call in both cases."}, {"owner": {"reputation": 2489, "user_id": 4941264, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/72edbb7098bc7082a3f245d694602160?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Price", "link": "https://stackoverflow.com/users/4941264/simon-price"}, "edited": false, "score": 0, "creation_date": 1444246823, "post_id": 32999742, "comment_id": 53826861, "body": "take a look at sql profiler and see what the actual call is thats being made,"}, {"owner": {"reputation": 8181, "user_id": 1220627, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bcc4752767827a60b2e32ac3d090f337?s=128&d=identicon&r=PG", "display_name": "Sn&#230;bj&#248;rn", "link": "https://stackoverflow.com/users/1220627/sn%c3%a6bj%c3%b8rn"}, "edited": false, "score": 0, "creation_date": 1444284210, "post_id": 32999742, "comment_id": 53839657, "body": "included the generated sql"}], "answers": [{"tags": [], "owner": {"reputation": 8181, "user_id": 1220627, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bcc4752767827a60b2e32ac3d090f337?s=128&d=identicon&r=PG", "display_name": "Sn&#230;bj&#248;rn", "link": "https://stackoverflow.com/users/1220627/sn%c3%a6bj%c3%b8rn"}, "is_accepted": true, "score": 0, "last_activity_date": 1444283556, "creation_date": 1444283556, "answer_id": 33007621, "question_id": 32999742, "link": "https://stackoverflow.com/questions/32999742/sql-is-fast-but-when-converted-to-linq-its-slow/33007621#33007621", "title": "Sql is fast but when converted to linq it&#39;s slow", "body": "<p>So turns out that the LINQ expressions are not identical.</p>\n\n<p>The correct linq expression is:</p>\n\n<pre><code>_myRepository.AsQueryable()\n    .GroupBy(x =&gt; new {x.Foo, x.Bar, x.Baz})\n    .GroupBy(x =&gt; x.Key.Foo)\n    .Select(x =&gt; new {x.Key, Count = x.Count()})\n    .ToDictionary(x =&gt; x.Key, x =&gt; x.Count);\n</code></pre>\n\n<p>I was missing a select, which I didn't expect because in normal SQL you can only select on columns that are in the group by clause. But LINQ does all kinds of magic to get the rest of the columns included, unless you limit it in the select.</p>\n"}], "owner": {"reputation": 8181, "user_id": 1220627, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bcc4752767827a60b2e32ac3d090f337?s=128&d=identicon&r=PG", "display_name": "Sn&#230;bj&#248;rn", "link": "https://stackoverflow.com/users/1220627/sn%c3%a6bj%c3%b8rn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 33007621, "answer_count": 1, "score": 0, "last_activity_date": 1444284453, "creation_date": 1444242283, "last_edit_date": 1444284453, "question_id": 32999742, "link": "https://stackoverflow.com/questions/32999742/sql-is-fast-but-when-converted-to-linq-its-slow", "title": "Sql is fast but when converted to linq it&#39;s slow", "body": "<p>This is fast</p>\n\n<pre><code>SELECT Foo,\n       count(*)\nFROM\n  (SELECT Foo\n   FROM MyTable\n   GROUP BY Foo,\n            Bar,\n            Baz) AS Subquery\nGROUP BY Foo\n</code></pre>\n\n<p>This is fast</p>\n\n<pre><code>var query = from fooGrp in\n    (from rv in _myRepository.AsQueryable()\n        group rv by new {rv.Foo, rv.Bar, rv.Baz}\n        into grp\n        select grp)\n    group fooGrp by fooGrp.Key.Foo\n    into grp2\n    select new {grp2.Key, Count = grp2.Count()};\nquery.ToDictionary(x =&gt; x.Key, x =&gt; x.Count);\n</code></pre>\n\n<p>This is slow, really slow!</p>\n\n<pre><code>_myRepository.AsQueryable()\n    .GroupBy(x =&gt; new { x.Foo, x.Bar, x.Baz })\n    .GroupBy(x =&gt; x.Key.Foo)\n    .ToDictionary(x =&gt; x.Key, x =&gt; x.Count());\n</code></pre>\n\n<p>I don't understand :(\nWhat is the difference between the two linq expressions? They both return the expected result set.</p>\n\n<hr>\n\n<p>The generated SQL for the first expression (fast) is:</p>\n\n<pre><code>SELECT \n    1 AS [C1], \n    [GroupBy1].[K1] AS [Foo], \n    [GroupBy1].[A1] AS [C2]\n    FROM ( SELECT \n        [Distinct1].[Foo] AS [K1], \n        COUNT(1) AS [A1]\n        FROM ( SELECT DISTINCT \n            [Extent1].[Foo] AS [Foo], \n            [Extent1].[Bar] AS [Bar], \n            [Extent1].[Baz] AS [Baz]\n            FROM [dbo].[MyTable] AS [Extent1]\n        )  AS [Distinct1]\n        GROUP BY [Distinct1].[Foo]\n    )  AS [GroupBy1]\n</code></pre>\n\n<p>The generated SQL for the second expression (slow) is:</p>\n\n<blockquote>\n  <p>Is so long that it exceeds the character limit of this post, so cannot post it :/</p>\n</blockquote>\n"}, {"tags": ["c#", "command-line", "windows-7"], "comments": [{"owner": {"reputation": 3360, "user_id": 878519, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eebf3cf169ccc501746d5d4b429b0462?s=128&d=identicon&r=PG", "display_name": "Reinard", "link": "https://stackoverflow.com/users/878519/reinard"}, "edited": false, "score": 0, "creation_date": 1444242428, "post_id": 32999694, "comment_id": 53824170, "body": "Could you look if the following helps <a href=\"http://stackoverflow.com/questions/14616837/how-to-redirect-output-from-exe-after-it-has-terminated\" title=\"how to redirect output from exe after it has terminated\">stackoverflow.com/questions/14616837/&hellip;</a> this will allow you to write it to a file."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 1, "creation_date": 1444242551, "post_id": 32999694, "comment_id": 53824235, "body": "Have you looked at using a logging library that allows console listeners to be defined, like log4net? You can also attach the console window to your application using p/invoke. Are you using <code>Console.WriteXXX</code> or <code>Debug.WriteXXX</code> calls? There is also a small issue with the way you are using the mutex to create a single instance app, you need to catch unhandled exceptions and release there."}, {"owner": {"reputation": 5456, "user_id": 502395, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GesJX.jpg?s=128&g=1", "display_name": "venerik", "link": "https://stackoverflow.com/users/502395/venerik"}, "edited": false, "score": 0, "creation_date": 1444242572, "post_id": 32999694, "comment_id": 53824246, "body": "This program doesn&#39;t write anything to the console. I&#39;d add a <code>Console.WriteLine(&quot;something&quot;);</code> before the <code>if</code>-statement for testing purpose."}, {"owner": {"reputation": 6044, "user_id": 2985796, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e23b7774b4e4cdaf47f2ac655eb423bd?s=128&d=identicon&r=PG", "display_name": "KDecker", "link": "https://stackoverflow.com/users/2985796/kdecker"}, "reply_to_user": {"reputation": 5456, "user_id": 502395, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GesJX.jpg?s=128&g=1", "display_name": "venerik", "link": "https://stackoverflow.com/users/502395/venerik"}, "edited": false, "score": 0, "creation_date": 1444242732, "post_id": 32999694, "comment_id": 53824324, "body": "@venerik I actually just did that. Made it the very first statement, and it was not shown. // @RonBeyer I am using <code>Console.Write...</code> // @SirTroll this does write the output to a file. That is a good fix for the meantime, though it would be nice to be able to see what actions cause what messages at a given time."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 2, "creation_date": 1444248742, "post_id": 32999694, "comment_id": 53828055, "body": "Your program is being built as a Windows application (the <code>&#47;SUBSYSTEM:Windows</code> linker option).  If you want it to output to the console, you have to build it as a console application (the <code>&#47;SUBSYSTEM:Console</code> option).  However, this means that if you double-click the application a console will be automatically opened, which may be undesirable.  There isn&#39;t any way for the same executable to do both at once; the usual solution is to have two executables, a GUI version and a console version."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1444248820, "post_id": 32999694, "comment_id": 53828101, "body": "(Actually, it is <i>possible</i> for a Windows application to attach to the parent console and write to it, but because the console won&#39;t wait for the application this is usually not a good idea - the output will be intermixed with the output of <code>cmd.exe</code> and/or whatever other program is running in the same console.)"}, {"owner": {"reputation": 6044, "user_id": 2985796, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e23b7774b4e4cdaf47f2ac655eb423bd?s=128&d=identicon&r=PG", "display_name": "KDecker", "link": "https://stackoverflow.com/users/2985796/kdecker"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1444306617, "post_id": 32999694, "comment_id": 53854007, "body": "@HarryJohnston Hmm, opening a console with the application doesn&#39;t seem too harmful for its use, I think I will look into that. // Could you give me some more information about your second comment? Specifically more about what will be intermixed in the output? I don&#39;t understand where this other output would come from. // Also, you could do that in an answer and I would accept it."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1444332686, "post_id": 32999694, "comment_id": 53871264, "body": "If you attach to the parent console, any output from <code>cmd.exe</code> (including in particular the command-line prompt) will be intermixed with your output.  So will the output from any command or program the user might run: for example, if the user asks for a directory listing, the output from your program, or fragments of it, might appear in the middle of that listing at random."}], "answers": [{"comments": [{"owner": {"reputation": 6044, "user_id": 2985796, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e23b7774b4e4cdaf47f2ac655eb423bd?s=128&d=identicon&r=PG", "display_name": "KDecker", "link": "https://stackoverflow.com/users/2985796/kdecker"}, "edited": false, "score": 0, "creation_date": 1444332612, "post_id": 33024364, "comment_id": 53871219, "body": "Thank you Harry, I will look into the linked question!"}], "tags": [], "owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "is_accepted": true, "score": 1, "last_activity_date": 1444332420, "last_edit_date": 1495542144, "creation_date": 1444332420, "answer_id": 33024364, "question_id": 32999694, "link": "https://stackoverflow.com/questions/32999694/stop-windows-command-prompt-from-returning-after-an-executable-is-started/33024364#33024364", "title": "Stop windows command prompt from &quot;returning&quot; after an executable is started?", "body": "<p>To allow your program to output to the console, build it as a console application.</p>\n\n<p>In Visual Studio, the relevant linker option is <code>/SUBSYSTEM:Console</code> ; or, when creating a new project, choose the \"console application\" template which will set the linker option automatically.</p>\n\n<p>This will also mean that if you run the program from the command prompt, the command prompt will wait for the program to exit.  Also, if you double-click the program rather than running it from the command prompt, a console window will automatically be created.</p>\n\n<p>(There is no way to make the command prompt wait for a program but prevent the program from creating a console window if double-clicked.  See <a href=\"https://stackoverflow.com/q/8030831/886887\">this question and its answers</a> for more information.)</p>\n"}], "owner": {"reputation": 6044, "user_id": 2985796, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e23b7774b4e4cdaf47f2ac655eb423bd?s=128&d=identicon&r=PG", "display_name": "KDecker", "link": "https://stackoverflow.com/users/2985796/kdecker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 33024364, "answer_count": 1, "score": 1, "last_activity_date": 1444332420, "creation_date": 1444242121, "question_id": 32999694, "link": "https://stackoverflow.com/questions/32999694/stop-windows-command-prompt-from-returning-after-an-executable-is-started", "title": "Stop windows command prompt from &quot;returning&quot; after an executable is started?", "body": "<p>I am developing an application that writes some exception messages to the <code>Console</code> if they are of no use to the user. As a result if someone runs the executable by simply double clicking it, they will never see these messages. </p>\n\n<p>In Visual Studio these messages show up in the output window, but in my case I am testing my application on a machine that does not a Visual Studio installation, though I still want to see if any of these messages appear.</p>\n\n<p>In the past I have simply ran the executable from the command prompt and it acted as the output window in Visual Studio. Though for some reason my application, when ran from the command prompt, simple \"returns\" and does not show any messages.</p>\n\n<p>For example I might start it like so, and it instantly returns</p>\n\n<pre><code>D:\\&gt;MyApp.exe\n\nD:\\&gt;\n</code></pre>\n\n<p>I am not sure if there is a specific switch I should use (I have tried <code>/K</code> to no avail) when I run it, or if there is something about my application that causes it to return.</p>\n\n<p>Any ideas on how I might run it via the command line so I can see the messages?</p>\n\n<p>For reference here is my applications <code>Program.cs</code></p>\n\n<pre><code>static class Program\n{\n    static Mutex mutex = new Mutex(true, \"{12345678-1234-1234-1234-123456789012}\");\n\n    [STAThread]\n    static void Main()\n    {\n        if (mutex.WaitOne(TimeSpan.Zero, true))\n        {\n            Application.EnableVisualStyles();\n            Application.SetCompatibleTextRenderingDefault(false);\n\n            SplashScreen.ShowSplashScreen();\n            Application.Run(MainForm.Instance);\n\n            mutex.ReleaseMutex();\n        }\n        else\n            NativeMethods.PostMessage((IntPtr)NativeMethods.HWND_BROADCAST, NativeMethods.WM_JTTMAINWINDOW, IntPtr.Zero, IntPtr.Zero);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "xml", "windows", "process"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1444242152, "post_id": 32999617, "comment_id": 53823991, "body": "I&#39;m not sure what you are trying to do here? Are you saying that <code>HasExited</code> is returning true when the program is open? Are you saying that there is no <code>process</code> that is started, but that line returns true anyway? What happens when you run this program? I&#39;m guessing Internet Explorer opens..."}, {"owner": {"reputation": 7613, "user_id": 1364007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d106de3dec9586b56ed7f110497689e?s=128&d=identicon&r=PG", "display_name": "Wai Ha Lee", "link": "https://stackoverflow.com/users/1364007/wai-ha-lee"}, "edited": false, "score": 0, "creation_date": 1444245553, "post_id": 32999617, "comment_id": 53826073, "body": "Seems a bit dangerous to suggest we delete keys in our registry!"}, {"owner": {"reputation": 51, "user_id": 764567, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f8f6952be99cb86d7457113d2705506a?s=128&d=identicon&r=PG", "display_name": "anotheruser", "link": "https://stackoverflow.com/users/764567/anotheruser"}, "edited": false, "score": 0, "creation_date": 1444257539, "post_id": 32999617, "comment_id": 53832110, "body": "I found the issue here. If i have a default editor as notepad++  [launched in UAC non admin mode]. Then i run my program it launches another tab and opens my XML file. But the launcher [my program] thinks the notepadd ++ exits already. If i have notepadd++ launched in administrator mode, no issues. All works as expected, (i mean process.HasExcited is working as expected.) So i added a app.manifest with &lt;requestedExecutionLevel  level=&quot;requireAdministrator&quot; uiAccess=&quot;false&quot; /&gt; so my program is enforced to launch always as administrator."}], "owner": {"reputation": 51, "user_id": 764567, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f8f6952be99cb86d7457113d2705506a?s=128&d=identicon&r=PG", "display_name": "anotheruser", "link": "https://stackoverflow.com/users/764567/anotheruser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444242229, "creation_date": 1444241901, "last_edit_date": 1444242229, "question_id": 32999617, "link": "https://stackoverflow.com/questions/32999617/system-diagnostics-process-is-always-true-when-no-default-program-is-registered", "title": "System.Diagnostics.Process.is always true, when no default program is registered", "body": "<p>How to repro:</p>\n\n<ol>\n<li>Delete the key and subkey <code>[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.xml</code></li>\n<li>Create a XML <code>%temp%\\myxml.xml</code></li>\n<li><p>and run this c#</p>\n\n<pre><code>System.Diagnostics.Process process = System.Diagnostics.Process.Start(\"%temp%\\myxml.xml\");\nif (process == null)\n{\n    log.WriteError(\"Failed to Launch a XML Editor. \");\n    return;\n}\n\n//Wait for the Editor to be closed.\nwhile (!process.HasExited); //&lt;= This line is always true \n</code></pre></li>\n</ol>\n\n<p>How to HasExited to be waiting when the user is still using the file/program ?</p>\n"}, {"tags": ["c#", "regex", "xml", "double-quotes", "slash"], "comments": [{"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1444242011, "post_id": 32999596, "comment_id": 53823889, "body": "You are not &#39;getting&#39; slashes, only seeing them in a Debug View. Looking for a dupe."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1444242014, "post_id": 32999596, "comment_id": 53823893, "body": "Those slashes are to escape characters. making <code>&quot;</code> as character so the compiler does not take it as end or start of string."}, {"owner": {"reputation": 3769, "user_id": 801098, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/49a2f1ba2e29fc702a18d253c4fcdb9e?s=128&d=identicon&r=PG", "display_name": "OnlineCop", "link": "https://stackoverflow.com/users/801098/onlinecop"}, "edited": false, "score": 0, "creation_date": 1444242085, "post_id": 32999596, "comment_id": 53823939, "body": "When you have a string surrounded by double quotes, any double quotes within that string need to be escaped. That changes each of those <code>&quot;</code> into <code>\\&quot;</code>. This is by design."}, {"owner": {"reputation": 23, "user_id": 5057045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLxyb.jpg?s=128&g=1", "display_name": "Mattia Bonfanti", "link": "https://stackoverflow.com/users/5057045/mattia-bonfanti"}, "edited": false, "score": 0, "creation_date": 1444242781, "post_id": 32999596, "comment_id": 53824355, "body": "Thanks a lot guys, now I get it"}], "owner": {"reputation": 23, "user_id": 5057045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TLxyb.jpg?s=128&g=1", "display_name": "Mattia Bonfanti", "link": "https://stackoverflow.com/users/5057045/mattia-bonfanti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1444242074, "answer_count": 0, "score": 0, "last_activity_date": 1444241828, "creation_date": 1444241828, "question_id": 32999596, "link": "https://stackoverflow.com/questions/32999596/c-troubles-reading-xml-value", "closed_reason": "Duplicate", "title": "C# Troubles reading xml value", "body": "<p>I'm trying to read an XML value but I'm having some problems.</p>\n\n<p>This is the string:<code>\"\"id\"\":\"\"[0-9]{19}\"\",\"\"display_src</code></p>\n\n<p>This is what I have put in the XML file (because of the doublequotes): </p>\n\n<p><code>&amp;quot;&amp;quot;id&amp;quot;&amp;quot;:&amp;quot;&amp;quot;[0-9]{19}&amp;quot;&amp;quot;,&amp;quot;&amp;quot;display_src</code></p>\n\n<p>This is the function I wrote for reading the values (works fine with the others):</p>\n\n<pre><code>public static string Load()\n{\n    return XML.SelectSingleNode(\"Config/Contacts/First).InnerText;\n}\n</code></pre>\n\n<p>But when I'm calling it I get this:</p>\n\n<pre><code>\"\\\"\\\"id\\\"\\\":\\\"\\\"[0-9]{19}\\\"\\\",\\\"\\\"display_src\"\n</code></pre>\n\n<p>Why am I getting those slashes? How can I fix that? Thanks in advance for any answers :)</p>\n"}, {"tags": ["c#", "unity3d", "cycle"], "answers": [{"comments": [{"owner": {"reputation": 3020, "user_id": 1072825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a27932ed81093b975e0b2619367cce95?s=128&d=identicon&r=PG", "display_name": "Pavan K", "link": "https://stackoverflow.com/users/1072825/pavan-k"}, "edited": false, "score": 0, "creation_date": 1566577523, "post_id": 33003980, "comment_id": 101713543, "body": "The skybox exposure changes but my objects are not changing lighting on them with this? Should I enable anything ?"}], "tags": [], "owner": {"reputation": 143, "user_id": 5371864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/huXfC.jpg?s=128&g=1", "display_name": "R&#250;ben Rocha", "link": "https://stackoverflow.com/users/5371864/r%c3%baben-rocha"}, "is_accepted": true, "score": 1, "last_activity_date": 1444259549, "creation_date": 1444259549, "answer_id": 33003980, "question_id": 32999572, "link": "https://stackoverflow.com/questions/32999572/how-to-change-the-exposure-of-a-skybox-at-runtime-in-unity/33003980#33003980", "title": "How to change the exposure of a skybox at runtime in Unity?", "body": "<p>Try this </p>\n\n<pre><code>RenderSettings.skybox.SetFloat(\"_Exposure\", Mathf.Sin(Time.time * Mathf.Deg2Rad * 100) + 1);\n</code></pre>\n"}], "owner": {"reputation": 214, "user_id": 5072572, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/MYdha.jpg?s=128&g=1", "display_name": "mr-matt", "link": "https://stackoverflow.com/users/5072572/mr-matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3770, "favorite_count": 0, "accepted_answer_id": 33003980, "answer_count": 1, "score": 0, "last_activity_date": 1444259549, "creation_date": 1444241754, "question_id": 32999572, "link": "https://stackoverflow.com/questions/32999572/how-to-change-the-exposure-of-a-skybox-at-runtime-in-unity", "title": "How to change the exposure of a skybox at runtime in Unity?", "body": "<p>I have a skybox in Unity with a day/night cycle. Currently the sun changes intensity and color as the day or night progress. But I want the skybox's exposure and atmosphere thickness to change as well but I can't seem to be able to access them from my script. I tried the logical thing which was the following:</p>\n\n<pre><code>if(isNight()){\n    RenderSettings.skybox.exposure -= 0.05f;\n}else{\n    RenderSettings.skybox.exposure += 0.05f;\n}\n</code></pre>\n\n<p>However exposure doesn't exist, nor does atmosphere thickness. I tried accessing the skybox directly from the inspector too but no luck there. Could someone show me how to access these thing in c#?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c#", "excel", "import", "epplus"], "comments": [{"owner": {"reputation": 168, "user_id": 1429096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8fde19d63c559cee70112e0236db71c3?s=128&d=identicon&r=PG", "display_name": "ScruffMcGruff", "link": "https://stackoverflow.com/users/1429096/scruffmcgruff"}, "edited": false, "score": 1, "creation_date": 1444242276, "post_id": 32999550, "comment_id": 53824083, "body": "What are you trying to do with the data you read in?  What methods have you tried already?  Before anyone can really answer your question we need a better idea of what you&#39;re trying to do."}, {"owner": {"reputation": 15273, "user_id": 2980607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ee98ba9cb770efb26642e7ab18dfe8?s=128&d=identicon&r=PG&f=1", "display_name": "peteb", "link": "https://stackoverflow.com/users/2980607/peteb"}, "edited": false, "score": 0, "creation_date": 1444242328, "post_id": 32999550, "comment_id": 53824112, "body": "For just a simple example of reading Excel files see this <a href=\"http://stackoverflow.com/questions/11685204/reading-excel-spreasheet-using-epplus\">question</a>"}, {"owner": {"reputation": 213, "user_id": 5090475, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjPAe.jpg?s=128&g=1", "display_name": "stringnome", "link": "https://stackoverflow.com/users/5090475/stringnome"}, "edited": false, "score": 0, "creation_date": 1444243084, "post_id": 32999550, "comment_id": 53824508, "body": "just read the spreadsheet data, which contains a list of clients will have to consult these customer information there is no registration is necessary to create the record in the database."}, {"owner": {"reputation": 213, "user_id": 5090475, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjPAe.jpg?s=128&g=1", "display_name": "stringnome", "link": "https://stackoverflow.com/users/5090475/stringnome"}, "edited": false, "score": 0, "creation_date": 1444243406, "post_id": 32999550, "comment_id": 53824697, "body": "just want to find a way to read the data"}], "answers": [{"tags": [], "owner": {"reputation": 350, "user_id": 2527399, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/0dd463514caa9c5800d4682d8afacbda?s=128&d=identicon&r=PG", "display_name": "Velkumar", "link": "https://stackoverflow.com/users/2527399/velkumar"}, "is_accepted": false, "score": 2, "last_activity_date": 1444245521, "creation_date": 1444245521, "answer_id": 33000667, "question_id": 32999550, "link": "https://stackoverflow.com/questions/32999550/read-data-from-an-excel-file/33000667#33000667", "title": "Read data from an Excel file", "body": "<p>Here is a method that will read csv and excel data, and return as datatable </p>\n\n<p><strong>Note- Install-Package ExcelDataReader</strong> via nuget </p>\n\n<pre><code>using Excel;\nusing System;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.IO; \nusing System.Text; \n\npublic static DataTable LoadDataTable(string filePath)\n        {\n            string fileExtension = Path.GetExtension(filePath);\n            switch (fileExtension.ToLower())\n            {\n                case \".xlsx\":\n                    return ConvertExcelToDataTable(filePath, true);\n                case \".xls\":\n                    return ConvertExcelToDataTable(filePath);\n                case \".csv\":\n                    return ConvertCsvToDataTable(filePath);\n                default:\n                    return new DataTable();\n            }\n\n        }\n\n\npublic static DataTable ConvertExcelToDataTable(string filePath, bool isXlsx = false)\n        {\n            FileStream stream = null;\n            IExcelDataReader excelReader = null;\n            DataTable dataTable = null;\n            stream = File.Open(filePath, FileMode.Open, FileAccess.Read);\n            excelReader = isXlsx ? ExcelReaderFactory.CreateOpenXmlReader(stream) : ExcelReaderFactory.CreateBinaryReader(stream);\n            excelReader.IsFirstRowAsColumnNames = true;\n            DataSet result = excelReader.AsDataSet();\n            if (result != null &amp;&amp; result.Tables.Count &gt; 0)\n                dataTable = result.Tables[0];\n            return dataTable;\n        }\n\npublic static DataTable ConvertCsvToDataTable(string filePath)\n        {\n            DataTable dt = new DataTable();\n            using (StreamReader sr = new StreamReader(filePath))\n            {\n                string[] headers = sr.ReadLine().Split(',');\n                foreach (string header in headers)\n                {\n                    dt.Columns.Add(header);\n                }\n                while (!sr.EndOfStream)\n                {\n                    string[] rows = sr.ReadLine().Split(',');\n                    DataRow dr = dt.NewRow();\n                    for (int i = 0; i &lt; headers.Length; i++)\n                    {\n                        dr[i] = rows[i];\n                    }\n                    dt.Rows.Add(dr);\n                }\n\n            }\n            return dt;\n        }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17932, "user_id": 16391, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8ff75049b31c4a05033be39792f1c2be?s=128&d=identicon&r=PG", "display_name": "StingyJack", "link": "https://stackoverflow.com/users/16391/stingyjack"}, "edited": false, "score": 0, "creation_date": 1526758176, "post_id": 33001385, "comment_id": 87872210, "body": "This works when you need other properties or information that can only be had from the Excel object model, but if you need the data only, the object model is significantly slower than the OleDB provider method."}], "tags": [], "owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "is_accepted": false, "score": 2, "last_activity_date": 1444247974, "creation_date": 1444247974, "answer_id": 33001385, "question_id": 32999550, "link": "https://stackoverflow.com/questions/32999550/read-data-from-an-excel-file/33001385#33001385", "title": "Read data from an Excel file", "body": "<p>Or use Excel Interop:</p>\n\n<pre><code>using Microsoft.Office.Interop.Excel;\n</code></pre>\n\n<p>...</p>\n\n<pre><code>        Microsoft.Office.Interop.Excel.Application xl = new Microsoft.Office.Interop.Excel.Application();\n        Microsoft.Office.Interop.Excel.Workbook workbook = xl.Workbooks.Open(@\"C:\\test.xlsx\");\n        Microsoft.Office.Interop.Excel.Worksheet sheet = workbook.Sheets[1];\n\n\n        int numRows = sheet.UsedRange.Rows.Count;\n        int numColumns = 2;     // according to your sample\n\n        List&lt;string[]&gt; contents = new List&lt;string[]&gt;();\n        string [] record = new string[2];\n\n        for (int rowIndex = 1; rowIndex &lt;= numRows; rowIndex++)  // assuming the data starts at 1,1\n        {\n            for (int colIndex = 1; colIndex &lt;= numColumns; colIndex++)\n            {\n                Range cell = (Range)sheet.Cells[rowIndex, colIndex];\n                if (cell.Value != null)\n                {\n                    record[colIndex-1] = Convert.ToString( cell.Value);\n                }\n            }\n            contents.Add(record);\n        }\n\n        xl.Quit();\n        Marshal.ReleaseComObject(xl);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 5077953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PF1lm.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/5077953/george"}, "is_accepted": false, "score": 2, "last_activity_date": 1540464728, "last_edit_date": 1540464728, "creation_date": 1444291084, "answer_id": 33009886, "question_id": 32999550, "link": "https://stackoverflow.com/questions/32999550/read-data-from-an-excel-file/33009886#33009886", "title": "Read data from an Excel file", "body": "<p>I have had the same issue a while ago.</p>\n\n<p>I used this solution  to Read Data From an Excel File (.xls) in ASP.NET: <a href=\"http://www.dotnetcurry.com/ShowArticle.aspx?ID=138\" rel=\"nofollow noreferrer\">http://www.dotnetcurry.com/ShowArticle.aspx?ID=138</a> . </p>\n\n<p>Simply read the range via SQL and post it into a GridView on the webpage.</p>\n\n<p>It looked to me simpler to understand for a not experienced ASP.NET/C# developer.</p>\n"}], "owner": {"reputation": 213, "user_id": 5090475, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjPAe.jpg?s=128&g=1", "display_name": "stringnome", "link": "https://stackoverflow.com/users/5090475/stringnome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19025, "favorite_count": 2, "answer_count": 3, "score": -1, "last_activity_date": 1540464728, "creation_date": 1444241677, "last_edit_date": 1444243341, "question_id": 32999550, "link": "https://stackoverflow.com/questions/32999550/read-data-from-an-excel-file", "title": "Read data from an Excel file", "body": "<p>I searched the official documentation, but it is focused on creating the Excel file and not on reading. Any code snippet as an example will help me!  </p>\n\n<p>How do I read Excel data? </p>\n\n<pre><code>COMPANY     | DOCUMENT  | \nCOMPANYONE  | 123455986 | \nCOMPANYTWO  | 123455986 |\nCOMPANYTHREE| 123455986 |\n</code></pre>\n"}, {"tags": ["c#", "windows", "webclient"], "comments": [{"owner": {"reputation": 1, "user_id": 2338921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8201392a59263b108bd84b539d33fa?s=128&d=identicon&r=PG", "display_name": "Serdar", "link": "https://stackoverflow.com/users/2338921/serdar"}, "edited": false, "score": 0, "creation_date": 1444242024, "post_id": 32999523, "comment_id": 53823905, "body": "Oh, forgot to mention: either of the system I use has .NET 4.0 installed"}, {"owner": {"reputation": 1, "user_id": 2338921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8201392a59263b108bd84b539d33fa?s=128&d=identicon&r=PG", "display_name": "Serdar", "link": "https://stackoverflow.com/users/2338921/serdar"}, "edited": false, "score": 0, "creation_date": 1444244501, "post_id": 32999523, "comment_id": 53825392, "body": "Also, I tried changing Proxy property of WebClient to null or WebRequest.DefaultWebProxy, but still it didn&#39;t change anything."}], "owner": {"reputation": 1, "user_id": 2338921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd8201392a59263b108bd84b539d33fa?s=128&d=identicon&r=PG", "display_name": "Serdar", "link": "https://stackoverflow.com/users/2338921/serdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444246773, "creation_date": 1444241595, "last_edit_date": 1444246773, "question_id": 32999523, "link": "https://stackoverflow.com/questions/32999523/strange-behavior-of-webclient-downloadstringasync-in-win8-c", "title": "Strange behavior of WebClient.DownloadStringAsync in Win8 (C#)", "body": "<p>I came across a problem in my program when I run it on Win8 (it runs fine on WinXP). I will be grateful if anyone can give some ideas about what's going on. It seems that some network settings have been changed between WinXP and Win8.</p>\n\n<p>Here I made sample code that causes weird things for me:</p>\n\n<p>HttpListener listening locally for port 20000</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        // Create listener\n        HttpListener listener = new HttpListener();\n        listener.Prefixes.Add(\"http://127.0.0.1:20000/\");\n        listener.Start();\n\n        Console.WriteLine(\"Listening...\");\n\n        // Wait for request\n        HttpListenerContext context = listener.GetContext();\n        HttpListenerResponse response = context.Response;\n\n        // Create response\n        string responseString = GenerateString();\n        byte[] buffer = System.Text.Encoding.UTF8.GetBytes(responseString);\n        response.ContentLength64 = buffer.Length;\n\n        // Send response \n        System.IO.Stream output = response.OutputStream;\n        output.Write(buffer, 0, buffer.Length);\n        output.Close();\n        listener.Stop();\n\n        Console.ReadLine();\n    }\n\n    private static string GenerateString()\n    {\n        StringBuilder sb = new StringBuilder();\n\n        for (int i = 0; i &lt; 6000000; i++)\n        {\n            sb.Append(\"A\");\n        }\n        return sb.ToString();\n    }\n</code></pre>\n\n<p>WebClient downloading string from port 20000</p>\n\n<pre><code>static void Main(string[] args)\n    {\n        WebClient c = new WebClient();\n        //c.Proxy = null;\n            try\n            {\n                Console.WriteLine(\"Start downloading: {0}\", DateTime.Now.ToString(\"hh:mm:ss.fff\"));\n                c.DownloadStringCompleted += (s,a) =&gt; OnDownloadStringCompleted(s,a);\n                c.DownloadStringAsync(new Uri(\"http://127.0.0.1:20000\"), c);\n                //c.DownloadString(new Uri(\"http://127.0.0.1:20000\"));\n                //Console.WriteLine(\"Finish downloading: {0}\", DateTime.Now.ToString(\"hh:mm:ss.fff\"));\n            }\n            catch(Exception e)\n            {\n                Console.WriteLine(e.Message);\n            }\n\n        Console.ReadLine();\n\n        c.Dispose();\n    }\n\n    private static void OnDownloadStringCompleted(object s, DownloadStringCompletedEventArgs arg)\n    {\n        try\n        {\n            string response = arg.Result;\n            Console.WriteLine(\"Finish downloading: {0}\", DateTime.Now.ToString(\"hh:mm:ss.fff\"));\n        }\n        catch (Exception ex)\n        {\n            Console.WriteLine(ex.Message);\n        }\n    } \n</code></pre>\n\n<p>If I run this on my XP machine it works fine (WebClient downloads string asynchronously). If I run this on Win8 machine (I tried 2 machines with Win8 and Win8.1) then it depends on size of the string I pass to HttpListenerResponse.OutputStream - say, for small response string of 100000 chars it works fine, but for 6000000 chars it only works sometimes and sometimes throws errors: either \"An existing connection was forcibly closed by the remote host\" or \"No connection could be made because the target machine actively refused it 127.0.0.1:20000\".</p>\n\n<p>Another strange thing is that sync DownloadString (commented there) seems to work fine on Win8!</p>\n\n<p>Actually, it's so weird that I'm a bit lost. I'm not sure why it works sometimes, but seems that it works first time after I build it and then stops working.</p>\n\n<p>Things I've tried so far:\n1. Disabling Windows firewall - didn't help\n2. Playing with localhost&lt;->127.0.0.1 (Win8 seems to change policy about DNS, so localhost may work slower or not work without changing hosts). Both 127.0.0.1 and localhost work in this strange way.\n3. Running code from Administrator and from user - also didn't help.</p>\n\n<p>Did anyone experienced this thing or do you have some clues?</p>\n"}, {"tags": ["c#", ".net", "npgsql"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1444241558, "post_id": 32999452, "comment_id": 53823615, "body": "Yes it is possible, as you can very quickly test. Errors can always happen. Commands won&#39;t break connections in any way."}], "answers": [{"tags": [], "owner": {"reputation": 11446, "user_id": 640325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/018fc595a3e6b1ac5c18cb27e73a066d?s=128&d=identicon&r=PG", "display_name": "Shay Rojansky", "link": "https://stackoverflow.com/users/640325/shay-rojansky"}, "is_accepted": true, "score": 4, "last_activity_date": 1444251468, "creation_date": 1444251468, "answer_id": 33002289, "question_id": 32999452, "link": "https://stackoverflow.com/questions/32999452/npgsql-one-connection-multiple-commands/33002289#33002289", "title": "Npgsql: One connection, multiple commands", "body": "<p>As said above, there is no issue with executing multiple commands serially on the same connection. Connections can always break (e.g. network cut), this has nothing to do with how many commands you run.</p>\n\n<p>If you want to execute the commands <em>in parallel</em>, you need to open multiple connections and execute one command on each one. However, be careful of touching the same data across the different commands, and be aware of the added overhead of multiple connections on your PostgreSQL.</p>\n"}], "owner": {"reputation": 1463, "user_id": 4784579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KRlU0.jpg?s=128&g=1", "display_name": "ipavlu", "link": "https://stackoverflow.com/users/4784579/ipavlu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2873, "favorite_count": 0, "accepted_answer_id": 33002289, "answer_count": 1, "score": 3, "last_activity_date": 1444251468, "creation_date": 1444241324, "question_id": 32999452, "link": "https://stackoverflow.com/questions/32999452/npgsql-one-connection-multiple-commands", "title": "Npgsql: One connection, multiple commands", "body": "<p>is it possible to execute multiple NpgslqCommands against one connection?\nI mean like:</p>\n\n<pre><code>conn.Open();\nExecuteCommandA(conn);\nExecuteCommandB(conn);\nExecuteCommandC(conn);\nconn.Close();\n</code></pre>\n\n<p>I believe, it should be possible, but is there any issue here?\nIf there is a batch of commands to be executed, that could take a longer time, there is a chance the connection could be lost or some other error can happen.</p>\n\n<p>So it should be tested, right?\nAlso can a command bring the connection into some kind error state?</p>\n\n<p>Thanks for answers...</p>\n\n<p>/IP/</p>\n"}, {"tags": ["c#", "asp.net", "webforms"], "comments": [{"owner": {"reputation": 20550, "user_id": 1529657, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7GjZY.jpg?s=128&g=1", "display_name": "Rahul Singh", "link": "https://stackoverflow.com/users/1529657/rahul-singh"}, "edited": false, "score": 0, "creation_date": 1444241602, "post_id": 32999368, "comment_id": 53823639, "body": "Have you defined the <code>btnLogin_Click</code> method in your code behind file? This happens when you declaratively attach the event in aspx page but do not define it in code behind(.aspx.cs) file."}, {"owner": {"reputation": 21, "user_id": 5078249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/304424e2e101ce0780557db9fcf12ded?s=128&d=identicon&r=PG&f=1", "display_name": "Hariharan V", "link": "https://stackoverflow.com/users/5078249/hariharan-v"}, "reply_to_user": {"reputation": 20550, "user_id": 1529657, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7GjZY.jpg?s=128&g=1", "display_name": "Rahul Singh", "link": "https://stackoverflow.com/users/1529657/rahul-singh"}, "edited": false, "score": 0, "creation_date": 1444280038, "post_id": 32999368, "comment_id": 53838061, "body": "@RahulSingh yes by clicking the Log in event it takes me the code behind(.cs) where i have defined what action that button need to perform"}, {"owner": {"reputation": 20550, "user_id": 1529657, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7GjZY.jpg?s=128&g=1", "display_name": "Rahul Singh", "link": "https://stackoverflow.com/users/1529657/rahul-singh"}, "edited": false, "score": 0, "creation_date": 1444284632, "post_id": 32999368, "comment_id": 53839845, "body": "Can you post your code behind code or just the <code>btnLogin_Click</code> method?"}], "owner": {"reputation": 21, "user_id": 5078249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/304424e2e101ce0780557db9fcf12ded?s=128&d=identicon&r=PG&f=1", "display_name": "Hariharan V", "link": "https://stackoverflow.com/users/5078249/hariharan-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444244799, "creation_date": 1444241030, "last_edit_date": 1444244799, "question_id": 32999368, "link": "https://stackoverflow.com/questions/32999368/getting-login-button-error-during-run-time", "title": "Getting Login button error during run time", "body": "<p>When i run my code i am getting login button  error during run time.. why i am getting a simple button on clicking it should validate but for that design also i am getting error</p>\n\n<pre><code>ASP.userinterface_login_aspx' does not contain a definition for 'btnLogin_Click' and no extension method 'btnLogin_Click' accepting a first argument of type 'ASP.userinterface_login_aspx' could be found (are you missing a using directive or an assembly reference?)\n</code></pre>\n\n<p>and here is my design</p>\n\n<pre><code>&lt;asp:Button ID=\"LoginButton\" runat=\"server\" Text=\"Login\" onclick=\"btnLogin_Click\"   /&gt; \n</code></pre>\n"}, {"tags": ["c#", ".net", "type-conversion", ".net-4.5"], "comments": [{"owner": {"reputation": 12270, "user_id": 10853, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a882ac46fab1a0940bcee41887ca9ecc?s=128&d=identicon&r=PG", "display_name": "Ian P", "link": "https://stackoverflow.com/users/10853/ian-p"}, "edited": false, "score": 0, "creation_date": 1444241176, "post_id": 32999367, "comment_id": 53823406, "body": "If the behavior of Convert.ToInt32 is doing what you want, then this is an acceptable way. Alternatively you could inline everything like this: <code>intval = (dblVal == null) ? null : Convert.ToInt32(dblVal);</code>"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 12270, "user_id": 10853, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a882ac46fab1a0940bcee41887ca9ecc?s=128&d=identicon&r=PG", "display_name": "Ian P", "link": "https://stackoverflow.com/users/10853/ian-p"}, "edited": false, "score": 1, "creation_date": 1444241414, "post_id": 32999367, "comment_id": 53823530, "body": "@IanP: That won&#39;t compile, because the compiler won&#39;t be able to figure out the type of the conditional expression. You&#39;d need to cast either the second or third operand to <code>int?</code>, or use <code>default(int?)</code> or something similar."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1444241494, "post_id": 32999367, "comment_id": 53823577, "body": "You can go to string first and then parse int from string"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 2, "creation_date": 1444242228, "post_id": 32999367, "comment_id": 53824049, "body": "@T.S.: Why would you want to do that? It wouldn&#39;t even work without some effort, as you can&#39;t parse non-integer values with <code>int.Parse</code> (e.g. <code>int.Parse(&quot;5.5&quot;)</code> will throw an exception)"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "reply_to_user": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1444242465, "post_id": 32999367, "comment_id": 53824193, "body": "@JonSkeet Correct. I don&#39;t say it is THE way, but as question implies, it is an &quot;Alternative way...&quot;"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1444242730, "post_id": 32999367, "comment_id": 53824322, "body": "@T.S.: Well you <i>could</i> send it to a web service to do the conversion - but it wouldn&#39;t in any way be a <i>useful</i> way. I think the OP is really asking for <i>sensible</i> alternatives, and I don&#39;t view unnecessary string conversions as falling in that category."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "reply_to_user": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1444242981, "post_id": 32999367, "comment_id": 53824453, "body": "@JonSkeet Web service would probably do one of those anyways, right? And while sending it, wouldn&#39;t you sometimes serialize values to strings (XML) and deserialize them back? There we go - to string and back, used all over the place"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1444244285, "post_id": 32999367, "comment_id": 53825249, "body": "@T.S.: Uh, yes - when string conversions are <i>necessary</i>, that&#39;s fine. My point is that it&#39;s the wrong approach here."}], "answers": [{"tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": true, "score": 15, "last_activity_date": 1444241580, "last_edit_date": 1592644375, "creation_date": 1444241217, "answer_id": 32999424, "question_id": 32999367, "link": "https://stackoverflow.com/questions/32999367/alternative-way-convert-int-to-double/32999424#32999424", "title": "Alternative way convert int ? to double?", "body": "<p>Just cast:</p>\n<pre><code>intVal = (int?) dblVal;\n</code></pre>\n<p>This will already result in a <code>null</code> value if <code>dblVal</code> is null. Note that unlike <code>Convert.ToInt32(double)</code>, this does <em>not</em> result in an exception if <code>dblVal</code> is outside the range of <code>int</code>. If that's a concern, you should work out exactly what you want to achieve.</p>\n<p>From the C# 5 spec, section 6.2.3:</p>\n<blockquote>\n<p>Explicit nullable conversions permit predefined explicit conversions that operate on non-nullable value types to also be used with nullable forms of those types. For each of the predefined explicit conversions that convert from a non-nullable value type S to a non-nullable value type T (\u00a76.1.1, \u00a76.1.2, \u00a76.1.3, \u00a76.2.1, and \u00a76.2.2), the following nullable conversions exist:</p>\n<ul>\n<li>An explicit conversion from S? to T?.</li>\n<li>An explicit conversion from S to T?.</li>\n<li>An explicit conversion from S? to T.</li>\n</ul>\n<p>Evaluation of a nullable conversion based on an underlying conversion from S to T proceeds as follows:</p>\n<ul>\n<li>If the nullable conversion is from S? to T?:\n<ul>\n<li>If the source value is null (HasValue property is false), the result is the null value of type T?.</li>\n<li>Otherwise, the conversion is evaluated as an unwrapping from S? to S, followed by the underlying conversion from S to T, followed by a wrapping from T to T?.</li>\n</ul>\n</li>\n<li>...</li>\n</ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "is_accepted": false, "score": 0, "last_activity_date": 1444241606, "last_edit_date": 1444241606, "creation_date": 1444241367, "answer_id": 32999468, "question_id": 32999367, "link": "https://stackoverflow.com/questions/32999367/alternative-way-convert-int-to-double/32999468#32999468", "title": "Alternative way convert int ? to double?", "body": "<p>Here's a way:</p>\n\n<pre><code>intVal = dblVal.HasValue ? Convert.ToInt32(dblVal.Value) : (int?)null;\n</code></pre>\n"}], "owner": {"reputation": 12021, "user_id": 438624, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e430d41d5cd17845c1aaf320b6842f57?s=128&d=identicon&r=PG", "display_name": "kbvishnu", "link": "https://stackoverflow.com/users/438624/kbvishnu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 32999424, "answer_count": 2, "score": 0, "last_activity_date": 1444393085, "creation_date": 1444241025, "last_edit_date": 1444393085, "question_id": 32999367, "link": "https://stackoverflow.com/questions/32999367/alternative-way-convert-int-to-double", "title": "Alternative way convert int ? to double?", "body": "<p>Is there any way to convert this ?</p>\n\n<pre><code>public int? intVal ;\npublic double? dblVal ;\n</code></pre>\n\n<p>How I am working now</p>\n\n<pre><code>if(dblVal==null)\n    intVal =null;\nelse\n    intVal = Convert.ToInt32(dblVal);\n</code></pre>\n\n<p>Any alternative way  ? Thanks in advance .</p>\n"}]