[{"tags": ["c#", "ios", "xamarin"], "comments": [{"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1564022223, "post_id": 57192591, "comment_id": 100896111, "body": "have you tried running it in the debugger on your device to capture the exception causing the crash?"}, {"owner": {"reputation": 1, "user_id": 11330345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc50ee5fb506acbaed09b1666a16e95?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Garcia ", "link": "https://stackoverflow.com/users/11330345/marco-garcia"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1564155956, "post_id": 57192591, "comment_id": 100951024, "body": "I already did everything, I already made the debug and everything well in the code, there is another view where I occupy the same structure and it shows without problem the image or photo, but in others it is where the error of sending me to another view occurs I do not know if it Close for any problems before or navigation problems."}, {"owner": {"reputation": 1, "user_id": 11330345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc50ee5fb506acbaed09b1666a16e95?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Garcia ", "link": "https://stackoverflow.com/users/11330345/marco-garcia"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1564158344, "post_id": 57192591, "comment_id": 100952100, "body": "In addition this error only occurs on ios devices, on Android it works perfectly."}, {"owner": {"reputation": 1, "user_id": 11330345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc50ee5fb506acbaed09b1666a16e95?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Garcia ", "link": "https://stackoverflow.com/users/11330345/marco-garcia"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1564163239, "post_id": 57192591, "comment_id": 100954050, "body": "Make a symbolic breakpoint at UIViewAlertForUnsatisfiableConstraints to catch this in the debugger.The methods in the UIConstraintBasedLayoutDebugging category on UIView listed in &lt;UIKitCore/UIView.h&gt; may also be helpful. Thread finished: &lt;Thread Pool&gt; #14 Navigation stack: TabPage 2019-07-26 12:31:37.562166-0500 HomieProveedorApp.iOS[5878:419099] [discovery] errors encountered while discovering extensions: Error Domain=PlugInKit Code=13 &quot;query cancelled&quot;UserInfo{NSLocalizedDescription=query cancelled}Thread started:  #16"}], "owner": {"reputation": 1, "user_id": 11330345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc50ee5fb506acbaed09b1666a16e95?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Garcia ", "link": "https://stackoverflow.com/users/11330345/marco-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564013305, "creation_date": 1564012210, "last_edit_date": 1564013305, "question_id": 57192591, "link": "https://stackoverflow.com/questions/57192591/problems-selecting-a-photo-or-image-from-the-cell-phone", "title": "Problems selecting a photo or image from the cell phone", "body": "<p>I have a problem with views, when I open the camera and take the photo it sends me directly to the home screen, the same happens with an image of the gallery, this only happens with ios, since Android works without any problem. I would like to know what is happening because I have not found the error.</p>\n\n<pre><code>public async Task TakePicture()\n        {\n            await CrossMedia.Current.Initialize();\n\n            if (!CrossMedia.Current.IsCameraAvailable || !CrossMedia.Current.IsTakePhotoSupported)\n            {\n                await Application.Current.MainPage.DisplayAlert(\"Error\", \"No se encontro una c\u00e1mara disponible.\", \"OK\");\n                return;\n            }\n\n            var file = await CrossMedia.Current.TakePhotoAsync(new Plugin.Media.Abstractions.StoreCameraMediaOptions\n            {\n                SaveToAlbum = false,\n                CompressionQuality = 30,\n                PhotoSize = PhotoSize.Small\n            });\n\n            if (file == null)\n            {\n                return;\n            }\n\n            byte[] array;\n            using (var memoryStream = new MemoryStream())\n            {\n                int count = 0;\n                file.GetStream().CopyTo(memoryStream);\n                array = memoryStream.ToArray();\n                while (count &lt; 10)\n                {\n                    if (array.Count() == 0)\n                    {\n                        file.GetStream().CopyTo(memoryStream);\n                        array = memoryStream.ToArray();\n                        await Task.Delay(1000);\n                    }\n                    count++;\n                }\n            }\n\n            Stream stream = new MemoryStream(array);\n            var image = ImageSource.FromStream(() =&gt; stream);\n            FotoPerfil = image;\n            User.Foto = array;\n\n        }\n</code></pre>\n\n<p>This part is to take the photo directly from the cell phone, I have no problem opening the camera, the error comes when I choose that photo sends me to another screen, I do not know if it is closing and reopening the application but I do not know what happens.</p>\n\n<pre><code>public async Task PickPicture()\n        {\n            await CrossMedia.Current.Initialize();\n            if (!CrossMedia.Current.IsPickPhotoSupported)\n            {\n                await Application.Current.MainPage.DisplayAlert(\"Error\",\n                    \"No se otorgaron permisos para accesar a las fotos.\", \"OK\");\n                return;\n            }\n\n            var file = await CrossMedia.Current.PickPhotoAsync(new PickMediaOptions\n            {\n                PhotoSize = PhotoSize.Medium,\n                CompressionQuality = 30,\n\n            });\n\n\n            if (file == null)\n            {\n                return;\n            }\n            byte[] array;\n            using (var memoryStream = new MemoryStream())\n            {\n                int count = 0;\n                file.GetStream().CopyTo(memoryStream);\n                array = memoryStream.ToArray();\n                while (count &lt; 10)\n                {\n                    if (array.Count() == 0)\n                    {\n                        file.GetStream().CopyTo(memoryStream);\n                        array = memoryStream.ToArray();\n                        await Task.Delay(1000);\n                    }\n                    count++;\n                }\n            }\n\n            await Application.Current.MainPage.DisplayAlert(\"Error\", array.ToString(), \"OK\");\n            User.Foto = array;\n            Stream stream = new MemoryStream(array);\n            var image = ImageSource.FromStream(() =&gt; stream);\n            FotoPerfil = image;\n        }\n</code></pre>\n\n<p>The latter is to select any image from the gallery, and exactly the same happens.</p>\n"}, {"tags": ["c#", ".net", "ssl", "encryption"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 1, "creation_date": 1564012985, "post_id": 57192567, "comment_id": 100894611, "body": "Why do you need to restrict the client&#39;s ciphers? The TLS protocol will cause them to negotiate a cipher suite that they have in common, so if it is restricted on the server, you don&#39;t have to restrict it on the client."}, {"owner": {"reputation": 2773, "user_id": 3330523, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/k6Sca.png?s=128&g=1", "display_name": "ydoow", "link": "https://stackoverflow.com/users/3330523/ydoow"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1564016434, "post_id": 57192567, "comment_id": 100895163, "body": "@JohnWu makes sense to me, is there any way to look up if my platform support the cipher in the list?"}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 1, "creation_date": 1564036774, "post_id": 57192567, "comment_id": 100900073, "body": "Visit <a href=\"https://www.ssllabs.com/ssltest/viewMyClient.html\" rel=\"nofollow noreferrer\">this site</a> and scroll to about the fifth box. It&#39;ll list your cipher suites."}], "owner": {"reputation": 2773, "user_id": 3330523, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/k6Sca.png?s=128&g=1", "display_name": "ydoow", "link": "https://stackoverflow.com/users/3330523/ydoow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1917, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1564011974, "creation_date": 1564011974, "question_id": 57192567, "link": "https://stackoverflow.com/questions/57192567/programmatic-way-to-restrict-cipher-suite-in-c", "title": "Programmatic way to restrict cipher suite in C#", "body": "<p>my C# program is calling an external API using TLS 1.2.</p>\n\n<p>This is the way I make it restricted to TLS 1.2</p>\n\n<pre><code>System.Net.ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;\n</code></pre>\n\n<p>Also the API further restricts the cipher suite to following </p>\n\n<blockquote>\n  <p><strong>Cipher Suite</strong></p>\n  \n  <p>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\n  TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n  TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384\n  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\n  TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\n  TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n  TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384\n  TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</p>\n</blockquote>\n\n<p>I've done further research and found this can be achieved by changing Network Configuration on the running machine.</p>\n\n<p><a href=\"https://www.c-sharpcorner.com/forums/change-cipher-suitetlsecdheecdsawithaes256gcmsha384\" rel=\"nofollow noreferrer\">https://www.c-sharpcorner.com/forums/change-cipher-suitetlsecdheecdsawithaes256gcmsha384</a></p>\n\n<p>But my machine has more than one programs calling different APIs (at different external parties), I want to avoid a global change at machine level. Is there any way I can restrict the cipher list programmatically?</p>\n"}, {"tags": ["c#", "asp.net-core", "entity-framework-core"], "comments": [{"owner": {"reputation": 8924, "user_id": 10201850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rz0ZX.jpg?s=128&g=1", "display_name": "Xueli Chen", "link": "https://stackoverflow.com/users/10201850/xueli-chen"}, "edited": false, "score": 1, "creation_date": 1564045862, "post_id": 57192552, "comment_id": 100904986, "body": "What are you trying to achieve is not possible. EF (Core) supports only real FK based relationships, while you are seeking for polymorphic (or more generally, logical) associations.Refer to what Ivan Stoev commented in <a href=\"https://stackoverflow.com/questions/50646600/entity-framework-core-many-to-many-relationship-between-generic-object-tables\">here</a> ."}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 1, "creation_date": 1564059426, "post_id": 57192552, "comment_id": 100912557, "body": "What you have should generally work, but you cannot have separate tables for <code>Course</code>, <code>Lecture</code>, etc. EF Core does not support TPT, only TPH, where all the properties for all derived classes goes in the same base table, and a discriminator column is used to determine the actual type to initialize."}], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 3745425, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/6832297/picture?type=large", "display_name": "rleffler", "link": "https://stackoverflow.com/users/3745425/rleffler"}, "is_accepted": true, "score": 1, "last_activity_date": 1564026250, "creation_date": 1564026250, "answer_id": 57193980, "question_id": 57192552, "link": "https://stackoverflow.com/questions/57192552/ef-core-reuse-the-same-join-table-entity-for-several-relationships/57193980#57193980", "title": "EF Core - Reuse the same join table entity for several relationships", "body": "<p>You won't be able to use the base class ModelBase as the object in the mapping class because c# wont know the actual type coming back from the db.  You can look at table per hierarchy inheritance, but I'm still not sure you would be able to use that in a mapping table either.   <a href=\"https://www.learnentityframeworkcore.com/inheritance/table-per-hierarchy\" rel=\"nofollow noreferrer\">Here is a good article</a></p>\n\n<p>If your Course.cs, Lecture.cs, and Game.cs are the same and the only difference is type, you could combine them into one class and add an enum property to set the type.</p>\n\n<pre><code>public enum EntityType{\n    Game = 1,\n    Lecture = 2,\n    Course = 3\n}\n\npublic class MyEntity : ModelBase{\n    private ICollection&lt;FileInEntity&gt; Icons { get; set; } = new List&lt;FileInEntity&gt;();\n\n    [NotMapped]\n    public File Image =&gt; Icons.Select(e =&gt; e.File).FirstOrDefault();\n\n    public EntityType EntityType {get;set;} //course, lecture, or  game\n}\n</code></pre>\n\n<p>When you care about the type just use a where clause.</p>\n"}, {"tags": [], "owner": {"reputation": 438, "user_id": 7575384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sovDP.jpg?s=128&g=1", "display_name": "ASLIM", "link": "https://stackoverflow.com/users/7575384/aslim"}, "is_accepted": false, "score": 1, "last_activity_date": 1564029079, "creation_date": 1564029079, "answer_id": 57194360, "question_id": 57192552, "link": "https://stackoverflow.com/questions/57192552/ef-core-reuse-the-same-join-table-entity-for-several-relationships/57194360#57194360", "title": "EF Core - Reuse the same join table entity for several relationships", "body": "<p>Be sure to use <code>Fluent Api</code> in <code>DbContext's OnModelCreating</code> to determine <code>One to One relationship</code> for this tables. (and be sure again correct reference properties are selected)</p>\n\n<p>Missing parts of your codes. </p>\n\n<pre><code>public class ModelBase\n{\n    [Key]// add for primary key\n    //set none always for primary keys (because guid has no auto increment)\n    [DatabaseGenerated(DatabaseGeneratedOption.None)] \n    public Guid Id { get; set; }\n}\n\n\n[Table(\"Files\")]\npublic class File : ModelBase\n{\n    //make it public\n    public ICollection&lt;FileInEntity&gt; FileInEntities { get; set; } = new List&lt;FileInEntity&gt;(); \n\n    [NotMapped] //set not mapped\n    public IEnumerable&lt;ModelBase&gt; Entities =&gt; FileInEntities.Select(e =&gt; e.Entities);\n\n    //do it same changes for `Lacture.cs`, `Game.cs` and `Course.cs`...\n}\n</code></pre>\n"}], "owner": {"reputation": 1630, "user_id": 3096156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pAtsL.jpg?s=128&g=1", "display_name": "Julien Ambos", "link": "https://stackoverflow.com/users/3096156/julien-ambos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 1, "accepted_answer_id": 57193980, "answer_count": 2, "score": 1, "last_activity_date": 1564029079, "creation_date": 1564011799, "question_id": 57192552, "link": "https://stackoverflow.com/questions/57192552/ef-core-reuse-the-same-join-table-entity-for-several-relationships", "title": "EF Core - Reuse the same join table entity for several relationships", "body": "<p>I want to reuse the same many-to-many relationship table (FileInEntity) for several other objects (Course, Lecture, Game), since they all can have files. Since we have to manually create the many-to-many relationships by creating a join entity, I want to reuse the join entity for the objects (Course, Lecture, Game).</p>\n\n<p>If we look at the table structure, I would like to have the following:</p>\n\n<p><strong>Course</strong>: Id, ...</p>\n\n<p><strong>Lecture</strong>: Id, ...</p>\n\n<p><strong>Game</strong>: Id, ...</p>\n\n<p><strong>FileInEntity</strong>: EntityId (this can be either Course.Id, Lecture.Id or Game.Id), FileId</p>\n\n<p><strong>File</strong>: Id, ...\n(File is base class type with two derived types: Image and Audio)</p>\n\n<p>When I try this approach in .NET Core, I receive the following error message:</p>\n\n<blockquote>\n  <p>Entity type 'FileInEntities' is in shadow-state. A valid model requires\n  all entity types to have corresponding CLR type.</p>\n</blockquote>\n\n<p>Is this even possible?</p>\n\n<hr>\n\n<p><em>This is my setup:</em></p>\n\n<p>ModelBase.cs</p>\n\n<pre><code>public class ModelBase\n{\n    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n    public Guid Id { get; set; }\n}\n</code></pre>\n\n<p>Course.cs</p>\n\n<pre><code>[Table(\"Courses\")]\npublic class Course : ModelBase\n{\n    private ICollection&lt;FileInEntity&gt; IconsInCourse { get; set; } = new List&lt;FileInEntity&gt;();\n\n    [NotMapped]\n    public File Image =&gt; IconsInCourse.Select(e =&gt; e.File).FirstOrDefault();\n}\n</code></pre>\n\n<p>Lecture.cs</p>\n\n<pre><code>// Same as Course.cs\n</code></pre>\n\n<p>Game.cs</p>\n\n<pre><code>// Same as Course.cs\n</code></pre>\n\n<p>FileInEntity.cs</p>\n\n<pre><code>[Table(\"FilesInEntities\")]\npublic class FileInEntity\n{\n    public Guid FileId { get; set; }\n\n    public Guid EntityId { get; set; }\n\n    public virtual ModelBase Entity { get; set; }\n\n    public virtual File File { get; set; }\n}\n</code></pre>\n\n<p>File.cs</p>\n\n<pre><code>[Table(\"Files\")]\npublic class File : ModelBase\n{\n    // This is the property for which the error occured\n    private ICollection&lt;FileInEntity&gt; FileInEntities { get; set; } = new List&lt;FileInEntity&gt;();\n\n    public IEnumerable&lt;ModelBase&gt; Entities =&gt; FileInEntities.Select(e =&gt; e.Entities);\n}\n</code></pre>\n\n<p>FilesInEntitiesMap.cs (Relationship Configuration)</p>\n\n<pre><code>builder.HasOne(p =&gt; p.Entity)\n    .WithMany()\n    .HasForeignKey(k =&gt; k.EntityId);\n\nbuilder.HasOne(p =&gt; p.File)\n    .WithMany()\n    .HasForeignKey(k =&gt; k.FileId);\n</code></pre>\n\n<p>FileMap.cs</p>\n\n<pre><code>// This is the key to which the error references to\nbuilder.HasMany(\"FileInEntities\")\n    .WithOne(\"Entity\")\n    .HasForeignKey(\"EntityId\");\n</code></pre>\n"}, {"tags": ["c#", "sql"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 2, "creation_date": 1564011964, "post_id": 57192541, "comment_id": 100894434, "body": "Can you show us your attempt to use <code>NOT IN</code>? Basically doing something like <code>SELECT * FROM Table1 WHERE Table1Column NOT IN (Select Table2Column FROM Table2)</code>?"}, {"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 1, "creation_date": 1564012257, "post_id": 57192541, "comment_id": 100894478, "body": "Can&#39;t you just do a left join somewhere or write a better query.  It seems like all the information you need is in the database."}, {"owner": {"reputation": 1329, "user_id": 10359630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479b071e83039556045c2232e6d4c804?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyShoe", "link": "https://stackoverflow.com/users/10359630/jimmyshoe"}, "edited": false, "score": 0, "creation_date": 1564012856, "post_id": 57192541, "comment_id": 100894589, "body": "Also if @PackageId is a single value why not use not equal instead of not like?"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1564013459, "post_id": 57192541, "comment_id": 100894689, "body": "Since <code>listPackages</code> is a <code>List&lt;Package&gt;</code>, then <code>listPackages.ToString()</code> will be something like <code>&quot;System.Collections.Generic.List&#39;1[Namespace.Package]&quot;</code>. Also, if there&#39;s more than one item in the list, your <code>listItem</code> string will only contain the last one. Should you be concatenating it instead?"}, {"owner": {"reputation": 171, "user_id": 5981996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4109356d5d47a8f89515df25901b84b6?s=128&d=identicon&r=PG&f=1", "display_name": "PixelsOfMind", "link": "https://stackoverflow.com/users/5981996/pixelsofmind"}, "edited": false, "score": 0, "creation_date": 1564018957, "post_id": 57192541, "comment_id": 100895586, "body": "Thank you everyone for the comments. This query took a lot of trial and error but JimmyShoe was right about being able to do this with the info in the database. I will post an update with the working query."}], "owner": {"reputation": 171, "user_id": 5981996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4109356d5d47a8f89515df25901b84b6?s=128&d=identicon&r=PG&f=1", "display_name": "PixelsOfMind", "link": "https://stackoverflow.com/users/5981996/pixelsofmind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1564019242, "creation_date": 1564011686, "last_edit_date": 1564019242, "question_id": 57192541, "link": "https://stackoverflow.com/questions/57192541/filter-values-from-query-that-exist-in-another-query", "title": "Filter Values from Query that Exist in Another Query", "body": "<p>I have been trying to come up with a solution to this for a while. I have a query that displays the products associated with a package. To had to do a 3-table join to get these values, which work without any issues.</p>\n\n<p>I tried to create a query to show all available products not in the package. I have tried filtering these values out within my query without any any luck and have tried multiple different approaches.</p>\n\n<p>This is my current query:</p>\n\n<pre><code>string showProdQuery = \n    @\"SELECT DISTINCT ProdName FROM Products P \" +\n    \"INNER JOIN Products_Suppliers S ON P.ProductId = S.ProductId \" +\n    \"INNER JOIN Packages_Products_Suppliers O ON S.ProductSupplierId = O.ProductSupplierId \" +\n    \"INNER JOIN Packages G ON G.PackageId = O.PackageId \" +\n    \"WHERE O.PackageId NOT LIKE @PackageId AND G.PackageId NOT LIKE @PackageId\";\n</code></pre>\n\n<p>My next idea is loop through the list from my original query and use these values within the select statement, something like this:</p>\n\n<pre><code>List&lt;Package&gt; listPackages = PackageList(packageId);\nstring listItem = \"\";\nfor (var i = 0; i &lt; listPackages.Count(); i++)\n{\n    listItem = \"NOT LIKE \" + listPackages.ToString() + \" AND \";\n}\n\nstring showProdQuery = \n    @\"SELECT DISTINCT ProdName FROM Products P \" +\n    \"INNER JOIN Products_Suppliers S ON P.ProductId = S.ProductId \" +\n    \"INNER JOIN Packages_Products_Suppliers O ON S.ProductSupplierId = O.ProductSupplierId \" +\n    \"INNER JOIN Packages G ON G.PackageId = O.PackageId \" +\n    \"WHERE P.ProdName \" +\n    listItem +\n    \"G.PackageId NOT LIKE @PackageId\";\n</code></pre>\n\n<p>I don't know if this is an appropriate approach or if I am missing something really simple. I'd love any advice on how I can make this work.</p>\n\n<p>Here is the updated query I managed to make work. Thank you for the advice everyone.</p>\n\n<pre><code>string showProdQuery = \n    @\"SELECT DISTINCT ProdName FROM Products P \" +\n    \"INNER JOIN Products_Suppliers S ON P.ProductId = S.ProductId \" +\n    \"INNER JOIN Packages_Products_Suppliers D ON S.ProductSupplierId = D.ProductSupplierId \" +\n    \"WHERE P.ProductId = S.ProductId AND S.ProductSupplierId = D.ProductSupplierId AND P.ProductId \" +\n    \"NOT IN (SELECT ProductId FROM Products_Suppliers S \" +\n    \"INNER JOIN Packages_Products_Suppliers D ON S.ProductSupplierId = D.ProductSupplierId \" +\n    \"AND D.PackageId = @PackageId)\";\n</code></pre>\n"}, {"tags": ["c#", "system.data.sqlite"], "comments": [{"owner": {"reputation": 131, "user_id": 3052279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3f1392fa4d592f93727ea48defe5162?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew17856", "link": "https://stackoverflow.com/users/3052279/andrew17856"}, "edited": false, "score": 0, "creation_date": 1564013276, "post_id": 57192538, "comment_id": 100894669, "body": "... it looks like I should be able to get a performance increase by wrapping all of the updates in a single transaction. However, I think my question still stands as to whether the multiple update queries is the correct architecture for this at all. Thanks."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1564014744, "post_id": 57192538, "comment_id": 100894880, "body": "There may be any number of other ways, it is hard to tell from the fake pseudo code."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1564041962, "post_id": 57192538, "comment_id": 100902760, "body": "It&#39;s hard to tell why your previous code was so slow because  your pseudo-pseudo-code was not useful (despite adding more abstract CPL).  It revealed nothing of the actual C# objects or SQL statements... details that are <b>critical</b> to asking for help with performance, etc.  Because sqlite is an in-process, embedded DBMS, it allows <a href=\"https://stackoverflow.com/questions/2108870/how-to-create-custom-functions-in-sqlite\">custom functions</a> to be defined so that you could do something like <code>UPDATE mytable SET FIRSTFIELD = myfunction(SECONDFIELD)</code>... very similar to the CPL snippet."}, {"owner": {"reputation": 131, "user_id": 3052279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3f1392fa4d592f93727ea48defe5162?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew17856", "link": "https://stackoverflow.com/users/3052279/andrew17856"}, "edited": false, "score": 0, "creation_date": 1564043695, "post_id": 57192538, "comment_id": 100903755, "body": "Thanks.  OK.  I probably should have been more specific with my question.  I wasn&#39;t having difficulty with the coding.  My query was more sense-checking the principle: i.e. whether the <i>only</i> way to update all rows in a SQLite database is by multiple UPDATE commands referencing the different RowIDs.  It seems the answer is &quot;yes&quot;, since even if you use a SQLDataAdapter is still just creating UPDATE commands behind the scene."}, {"owner": {"reputation": 131, "user_id": 3052279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3f1392fa4d592f93727ea48defe5162?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew17856", "link": "https://stackoverflow.com/users/3052279/andrew17856"}, "edited": false, "score": 0, "creation_date": 1564046043, "post_id": 57192538, "comment_id": 100905068, "body": "p.s. I&#39;m also aware of the ability to define custom functions in SQLite.  I&#39;m not aware that there&#39;s an interface that allows SQLite to use C# .net functions though (which is the brief here)?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 1, "creation_date": 1564065327, "post_id": 57192538, "comment_id": 100916114, "body": "<a href=\"https://stackoverflow.com/questions/172735/create-use-user-defined-functions-in-system-data-sqlite\" title=\"create use user defined functions in system data sqlite\">stackoverflow.com/questions/172735/&hellip;</a>  Sorry, I&#39;m not able to dredge up my use of them right now with a more complete code sample, but here&#39;s a start for C# using system.data.sqlite (which can easily be added to a Visual Studio project using nuget)."}, {"owner": {"reputation": 131, "user_id": 3052279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3f1392fa4d592f93727ea48defe5162?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew17856", "link": "https://stackoverflow.com/users/3052279/andrew17856"}, "edited": false, "score": 0, "creation_date": 1564069886, "post_id": 57192538, "comment_id": 100918633, "body": "That&#39;s really helpful - thank you.  That&#39;s another way to do it then.  Create the c# function, bind it into SQLite, then execute an update command that calls back to it."}], "answers": [{"comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1564041498, "post_id": 57195196, "comment_id": 100902482, "body": "The fact that this helped to improve your code, great.  But even the code in the linked page is still incomplete and does not use best practices.  You could probably speed it up even more.  The point of defining a SQLiteCommand object is to create a parameterized <b>prepared</b> (i.e. similar to pre-compiled statement) statement that you then only pass in the data and re-execute.  The linked code is redefining the <code>cmd.CommandText</code> repeatedly... not efficient.  Look into SQLiteCommand parameters.  Simply wrapping in a transaction was likely not what gained the orders of magnitude in performance."}, {"owner": {"reputation": 131, "user_id": 3052279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3f1392fa4d592f93727ea48defe5162?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew17856", "link": "https://stackoverflow.com/users/3052279/andrew17856"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 1, "creation_date": 1564044066, "post_id": 57195196, "comment_id": 100903964, "body": "Thanks.  Yes, I&#39;m using parameters in my code.  The command is defined in the &quot;using&quot; statement, and only the parameters are updated as it loops through each record."}], "tags": [], "owner": {"reputation": 131, "user_id": 3052279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3f1392fa4d592f93727ea48defe5162?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew17856", "link": "https://stackoverflow.com/users/3052279/andrew17856"}, "is_accepted": true, "score": 0, "last_activity_date": 1564205134, "last_edit_date": 1564205134, "creation_date": 1564034158, "answer_id": 57195196, "question_id": 57192538, "link": "https://stackoverflow.com/questions/57192538/populate-new-field-in-sqlite-database-using-existing-field-value-and-a-c-functi/57195196#57195196", "title": "Populate new field in SQLite database using existing field value and a C# function", "body": "<p>The answer to this is to wrap all of the updates into a single transaction.</p>\n\n<p>There is an example here that does it for bulk inserts:\n<a href=\"https://www.jokecamp.com/blog/make-your-sqlite-bulk-inserts-very-fast-in-c/\" rel=\"nofollow noreferrer\">https://www.jokecamp.com/blog/make-your-sqlite-bulk-inserts-very-fast-in-c/</a></p>\n\n<p>In my case, it would be bulk updates based on RowID wrapped into a single transaction.</p>\n\n<p>It's now working, and performance is many orders of magnitude better.</p>\n\n<p>EDIT: per the helpful comment above, defining a custom C# function and then reference it in a single UPDATE command also works well, and in some ways is better than the above as you don't have to loop through within C# itself.  See e.g. <a href=\"https://stackoverflow.com/questions/172735/create-use-user-defined-functions-in-system-data-sqlite\">Create/Use User-defined functions in System.Data.SQLite?</a></p>\n"}], "owner": {"reputation": 131, "user_id": 3052279, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c3f1392fa4d592f93727ea48defe5162?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew17856", "link": "https://stackoverflow.com/users/3052279/andrew17856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 57195196, "answer_count": 1, "score": -1, "last_activity_date": 1564205134, "creation_date": 1564011663, "last_edit_date": 1564033429, "question_id": 57192538, "link": "https://stackoverflow.com/questions/57192538/populate-new-field-in-sqlite-database-using-existing-field-value-and-a-c-functi", "title": "Populate new field in SQLite database using existing field value and a C# function", "body": "<p>I have a SQLite database for which I want to populate a new field based on an existing one.  I want to derive the new field value using a C# function.</p>\n\n<p>In pseudocode, it would be something like:</p>\n\n<pre><code>foreach ( record in the SQLite database)\n{\nmy_new_field[record_num] = my_C#_function(existing_field_value[record_num]);\n}\n</code></pre>\n\n<p>Having looked at other suggestions on StackOverflow, I'm using a SqliteDataReader to read each record, and then running a SQlite \"UPDATE\" command based on the specific RowId to update the new field value for the same record.</p>\n\n<p>It works .... but it's REALLY slow and thrashes the hard drive like crazy.  Is there really no better way to do this?</p>\n\n<p>Some of the databases I need to update might be millions of records.</p>\n\n<p>Thanks in advance for any help.</p>\n\n<p>Edit:</p>\n\n<p>In response to the comment, here's some real code in a legacy language called Concordance CPL.  The important point to note is that you can read and write changes to the current record in one go:</p>\n\n<pre><code>int db;\n\ncycle(db)\n{\ndb-&gt;FIRSTFIELD = myfunction(db-&gt;SECONDFIELD);\n}\n\nmyfunction(text input)\n{\ntext output;\n\n/// code in here to derive output from input\n\nreturn output;\n}\n</code></pre>\n\n<p>I have a feeling there's no equivalent way to do this in SQLite as SQL is inherently transactional, whereas Concordance allowed you to traverse and update the database sequentially. </p>\n"}, {"tags": ["c#", "request", "microsoft-cognitive", "timeoutexception"], "comments": [{"owner": {"reputation": 51, "user_id": 1544704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0583a1734b42319f61dad817c71daaba?s=128&d=identicon&r=PG", "display_name": "user1544704", "link": "https://stackoverflow.com/users/1544704/user1544704"}, "edited": false, "score": 0, "creation_date": 1564012290, "post_id": 57192537, "comment_id": 100894486, "body": "Checking to see if Microsoft might have changed their endpoint."}, {"owner": {"reputation": 1258, "user_id": 11297406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d86e856318cc26c5d195f7b74e1ac1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ram-msft", "link": "https://stackoverflow.com/users/11297406/ram-msft"}, "edited": false, "score": 0, "creation_date": 1564044992, "post_id": 57192537, "comment_id": 100904456, "body": "Can you share the Uri and sample data that you are trying?"}, {"owner": {"reputation": 51, "user_id": 1544704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0583a1734b42319f61dad817c71daaba?s=128&d=identicon&r=PG", "display_name": "user1544704", "link": "https://stackoverflow.com/users/1544704/user1544704"}, "reply_to_user": {"reputation": 1258, "user_id": 11297406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d86e856318cc26c5d195f7b74e1ac1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ram-msft", "link": "https://stackoverflow.com/users/11297406/ram-msft"}, "edited": false, "score": 0, "creation_date": 1564071809, "post_id": 57192537, "comment_id": 100919558, "body": "Turns out the process I was requesting did indeed take too long and will need to reduce the size of my dataset or increase the timeout value if that is an option."}], "answers": [{"tags": [], "owner": {"reputation": 1258, "user_id": 11297406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d86e856318cc26c5d195f7b74e1ac1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ram-msft", "link": "https://stackoverflow.com/users/11297406/ram-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1564407755, "creation_date": 1564407755, "answer_id": 57255173, "question_id": 57192537, "link": "https://stackoverflow.com/questions/57192537/forms-recognizer-408-request-time-out-with-custom-train-api-call/57255173#57255173", "title": "Forms Recognizer 408 request time-out with custom\\train API call", "body": "<p>Please refer the Input requirements for the Form Recognizer.\n<a href=\"https://i.stack.imgur.com/Nxh0G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nxh0G.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 51, "user_id": 1544704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0583a1734b42319f61dad817c71daaba?s=128&d=identicon&r=PG", "display_name": "user1544704", "link": "https://stackoverflow.com/users/1544704/user1544704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564407755, "creation_date": 1564011641, "question_id": 57192537, "link": "https://stackoverflow.com/questions/57192537/forms-recognizer-408-request-time-out-with-custom-train-api-call", "title": "Forms Recognizer 408 request time-out with custom\\train API call", "body": "<p>Using Forms Recognizer to Train a model with 6 sample forms and API call times out with 408.</p>\n\n<p>Followed documentation.  Uploaded sample forms to blob storage and put valid (active) SAS key in {\"source\":\"\"} json object in request body.</p>\n\n<pre><code>string requestBody = \"{ \\\"source\\\": \\\"\" + \"&lt;valid_SAS_URL&gt;\" + \"\\\"}\";\nvar content = new StringContent(requestBody);\n            content.Headers.ContentType = new MediaTypeHeaderValue(\"application/json\");\n            response = client.PostAsync(uri, content).Result;\n</code></pre>\n\n<p>Should have received a success json string but instead a 408 timeout.  No other info is available about why this might have happened.  No log entries on the Azure side that I could find.</p>\n"}, {"tags": ["c#", "saml", "saml-2.0"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 10356267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fyTVRwmxUY/AAAAAAAAAAI/AAAAAAAAABI/O7dlQpzTepY/photo.jpg?sz=128", "display_name": "ONLAEG", "link": "https://stackoverflow.com/users/10356267/onlaeg"}, "edited": false, "score": 0, "creation_date": 1564014181, "post_id": 57192647, "comment_id": 100894789, "body": "Thanks for answer. When I try to access a resource on another SAML service provider, What must I request to the identity provider? Is the first time redirect to identity provider same? The first time I login on a mobile app."}, {"owner": {"reputation": 2994, "user_id": 4392800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB5iN.png?s=128&g=1", "display_name": "identigral", "link": "https://stackoverflow.com/users/4392800/identigral"}, "reply_to_user": {"reputation": 135, "user_id": 10356267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fyTVRwmxUY/AAAAAAAAAAI/AAAAAAAAABI/O7dlQpzTepY/photo.jpg?sz=128", "display_name": "ONLAEG", "link": "https://stackoverflow.com/users/10356267/onlaeg"}, "edited": false, "score": 0, "creation_date": 1564014668, "post_id": 57192647, "comment_id": 100894870, "body": "You don&#39;t need to request anything as long as the relationship/trust is established between the identity provider and the service provider and the service provider supports SP-initiated SSO. When you access the resource on a SP, it&#39;ll send a SAML authentication request to the identity provider. The identity provider will reply to this request with a SAML response."}, {"owner": {"reputation": 135, "user_id": 10356267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fyTVRwmxUY/AAAAAAAAAAI/AAAAAAAAABI/O7dlQpzTepY/photo.jpg?sz=128", "display_name": "ONLAEG", "link": "https://stackoverflow.com/users/10356267/onlaeg"}, "edited": false, "score": 0, "creation_date": 1564015575, "post_id": 57192647, "comment_id": 100895013, "body": "I mean that, second time &quot;When you access the resource on a SP, it&#39;ll send a SAML authentication request to the identity provider.&quot;. Is second time authentication request the same with first time authentication request?(after redirect to second site from mobile app). I cannot imagine that how identity provider can identify App and website has been login by one man without something like token (example only)."}, {"owner": {"reputation": 2994, "user_id": 4392800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB5iN.png?s=128&g=1", "display_name": "identigral", "link": "https://stackoverflow.com/users/4392800/identigral"}, "reply_to_user": {"reputation": 135, "user_id": 10356267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fyTVRwmxUY/AAAAAAAAAAI/AAAAAAAAABI/O7dlQpzTepY/photo.jpg?sz=128", "display_name": "ONLAEG", "link": "https://stackoverflow.com/users/10356267/onlaeg"}, "edited": false, "score": 0, "creation_date": 1564018174, "post_id": 57192647, "comment_id": 100895469, "body": "The 2nd authentication request will be structurally the same as the 1st one but it&#39;ll have different values. For example, one difference will be the identity of the service provider (Issuer element)."}], "tags": [], "owner": {"reputation": 2994, "user_id": 4392800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB5iN.png?s=128&g=1", "display_name": "identigral", "link": "https://stackoverflow.com/users/4392800/identigral"}, "is_accepted": false, "score": 3, "last_activity_date": 1564012837, "creation_date": 1564012837, "answer_id": 57192647, "question_id": 57192408, "link": "https://stackoverflow.com/questions/57192408/saml-sso-how-does-it-work-with-multiple-service-providers/57192647#57192647", "title": "SAML SSO - how does it work with multiple service providers", "body": "<p>Yes. This happens seamlessly if you use <a href=\"http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0-cd-02.html#5.1.1.Introduction%7Coutline\" rel=\"nofollow noreferrer\">service provider-initiated SSO flow</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/YlVuy.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YlVuy.gif\" alt=\"enter image description here\"></a></p>\n\n<p>When you try to access a resource on any SAML-speaking service provider, if you're not authenticated at the service provider, you'll be redirected back to the identity provider. Let's say this is the first time it happened. Identity provider would prompt for authentication and following that it would send a SAML response to the service provider. Now you try to access a resource on another SAML service provider. You would again be redirected to the identity provider but this time you won't be prompted for authentication as long as your security context (session..) at the identity provider is still alive. The identity provider will silently send a SAML response to the second service provider.</p>\n"}], "owner": {"reputation": 135, "user_id": 10356267, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7fyTVRwmxUY/AAAAAAAAAAI/AAAAAAAAABI/O7dlQpzTepY/photo.jpg?sz=128", "display_name": "ONLAEG", "link": "https://stackoverflow.com/users/10356267/onlaeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1564013829, "creation_date": 1564010301, "last_edit_date": 1564013829, "question_id": 57192408, "link": "https://stackoverflow.com/questions/57192408/saml-sso-how-does-it-work-with-multiple-service-providers", "title": "SAML SSO - how does it work with multiple service providers", "body": "<p>I'm tasked with developing an SSO system with SAML. I have to login to the identity provider (via a mobile app) and redirect to my site after authentication. </p>\n\n<p>After some research I think understand the interaction between a Service Provider and an ID Provider and how a user's identity is confirmed. </p>\n\n<p>But what happens when I redirect the user to another Service Provider? How can I transfer the authenticated user's identity to my site without login once again with Identity Provider. </p>\n\n<p>Must I send the SAML assertion tokens along with the redirect request?</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 1, "user_id": 11827673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8MO7s-iII0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfOfUdgA7YTrTQV0DgbKJoOoB5ipg/photo.jpg?sz=128", "display_name": "Jeremy E", "link": "https://stackoverflow.com/users/11827673/jeremy-e"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1564011276, "post_id": 57192349, "comment_id": 100894296, "body": "^^This is for a UWP app. I am using Windows Forms. Can I still use these classes and methods?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1564011450, "post_id": 57192349, "comment_id": 100894337, "body": "I don&#39;t see a WinForms tag on your question. Missed it in the first sentence - you should add the tag. It doesn&#39;t appear that it&#39;s available in WinForms. Good thing I only posted a comment instead of an answer. :-)"}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1564017660, "post_id": 57192349, "comment_id": 100895381, "body": "Does a DOS command work in copying a file? eg <code>xcopy sourcePath destinationPath &#47;O &#47;X &#47;E &#47;H &#47;K</code>  Can you see the removable drive by <code>foreach (DriveInfo drive in DriveInfo.GetDrives()) { if (drive.DriveType == DriveType.Removable) { Console.PrintLine(dirve.Name); } }</code> ?"}], "owner": {"reputation": 1, "user_id": 11827673, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8MO7s-iII0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfOfUdgA7YTrTQV0DgbKJoOoB5ipg/photo.jpg?sz=128", "display_name": "Jeremy E", "link": "https://stackoverflow.com/users/11827673/jeremy-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564011460, "creation_date": 1564009784, "last_edit_date": 1564011460, "question_id": 57192349, "link": "https://stackoverflow.com/questions/57192349/how-to-address-external-usb-devices-using-c", "title": "How to address external USB devices using C#?", "body": "<p>I am creating a Windows Forms application to copy folders without losing metadata such as creation and modification dates. It works fine when transferring files between my computer, flash drives, and external hard drives, but fails to work when I try to copy files off of my phone connected over a USB cable.</p>\n\n<p>Using the suggestion in <a href=\"https://stackoverflow.com/a/33378836/11827673\">this</a> post, I have tried using the shell32 library to get the path to the device by using <code>Shell.BrowseForFolder</code> instead of <code>Forms.FolderBrowserDialog.ShowDialog</code>. Sadly, this breaks the rest of my program by introducing invalid characters into the path: <code>::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\\\\\?\\usb#vid_04e8&amp;pid_6860&amp;ms_comp_mtp&amp;samsung_android#6&amp;fee689d&amp;3&amp;0000#{6ac27878-a6fa-4155-ba85-f98f491d4f33}\\SID-{20002,SECZ9519043CHOHB01,63829639168}\\{013C00D0-011B-0130-3A01-380113012901}</code>\nThis introduces invalid path errors when using <code>DirectoryInfo</code>, <code>File.Copy</code>, and <code>Directory.EnumerateFiles</code>.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private void PickSourceButton_Click( object sender, EventArgs e )\n{\n    int hwnd = 0;\n    Folder folder = shell.BrowseForFolder( hwnd, SourceFolderPicker.Description, 0, 0 );\n    if( folder != null )\n        SourceFolderTextBox.Text = ( folder as Folder3 ).Self.Path;\n}\n</code></pre>\n\n<p>Short of rewriting the entire program to use <code>Shell32.NameSpace</code> and <code>FolderItem</code>, I do not know if there is another way to accomplish what I am trying to do. I am hoping that there is a way to translate this cryptic path into something more traditional.</p>\n"}, {"tags": ["c#", "unity3d"], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 9313796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2Vtr.png?s=128&g=1", "display_name": "Wyeknott", "link": "https://stackoverflow.com/users/9313796/wyeknott"}, "edited": false, "score": 0, "creation_date": 1564044711, "post_id": 57192494, "comment_id": 100904298, "body": "Of all the things I looked at, undefined start order never appeared. Using the script execution order from your link has worked. Will try the awake approach shortly"}], "tags": [], "owner": {"reputation": 6430, "user_id": 6858891, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/z4vFM.png?s=128&g=1", "display_name": "Hellium", "link": "https://stackoverflow.com/users/6858891/hellium"}, "is_accepted": true, "score": 1, "last_activity_date": 1564011246, "creation_date": 1564011246, "answer_id": 57192494, "question_id": 57192339, "link": "https://stackoverflow.com/questions/57192339/cannot-reference-a-script-on-an-array-of-gameobjects-generated-in-another-script/57192494#57192494", "title": "Cannot reference a script on an array of gameobjects generated in another script", "body": "<p>Unless you don't <a href=\"https://docs.unity3d.com/Manual/class-MonoManager.html\" rel=\"nofollow noreferrer\">clearly define otherwise</a>, you don't know when the <code>Start</code> method of two MonoBehaviours will run.</p>\n\n<p>In your case, the <code>Pulse</code>'s Start method is called <strong>before</strong> <code>CreateGrid</code>'s.</p>\n\n<p>To fix your problem, I advise you to call <code>CreateGrid</code>'s <code>Generate</code> method inside the <code>Awake</code> method of the class.</p>\n\n<p>I often use this method to initialize members of the class not relying on other classes instances and use the <code>Start</code> method to initialize members needing other instances to be self-initialized.</p>\n"}], "owner": {"reputation": 114, "user_id": 9313796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I2Vtr.png?s=128&g=1", "display_name": "Wyeknott", "link": "https://stackoverflow.com/users/9313796/wyeknott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 57192494, "answer_count": 1, "score": 0, "last_activity_date": 1564011246, "creation_date": 1564009708, "question_id": 57192339, "link": "https://stackoverflow.com/questions/57192339/cannot-reference-a-script-on-an-array-of-gameobjects-generated-in-another-script", "title": "Cannot reference a script on an array of gameobjects generated in another script", "body": "<p>I want an array of game objects, each game object has a simple script to move it. I want a controlling script to be able to trigger the remote script by referencing the array coordinates / game object at that point.</p>\n\n<p>I am missing something basic in referencing a \"global\" variable - so apologies in advance. I have spent several hours now reading and trying things out. \nExample questions like here <a href=\"https://stackoverflow.com/questions/25930919/accessing-a-variable-from-another-script-c-sharp\">Accessing a variable from another script C#</a>\nor\n<a href=\"https://answers.unity.com/questions/42843/referencing-non-static-variables-from-another-scri.html\" rel=\"nofollow noreferrer\">https://answers.unity.com/questions/42843/referencing-non-static-variables-from-another-scri.html</a></p>\n\n<p>I believe the array should be static as there is only one set of data, however I don't care if it isnt</p>\n\n<p>CreateGrid.cs</p>\n\n<pre><code>public class CreateGrid : MonoBehaviour\n{\n\npublic static GameObject[,] gridArray = new GameObject[5, 5];\npublic GameObject gridSpace;\n\n// Start is called before the first frame update\nvoid Start()\n{\n    GenerateGrid();\n}\n\nvoid GenerateGrid()\n{\n    for (int x = 0; x &lt; 5; x++)\n    {\n        for (int z = 0; z &lt; 5; z++)\n        {\n            gridArray[x, z] = Instantiate(gridSpace, new Vector3(x, 0, z), Quaternion.identity) as GameObject;\n        }\n    }\n\n    // test grid works\n    // gridArray[2, 2].transform.Translate(0.0f, 3.0f, 0.0f);\n}\n</code></pre>\n\n<p>}</p>\n\n<p>test code</p>\n\n<pre><code>public class Pulse : MonoBehaviour\n{\n    // Start is called before the first frame update\n    void Start()\n    {\n\n     for (int x = 0; x &lt; 5; x++)\n        {\n        CreateGrid.gridArray[x, 3].GetComponent&lt;MoveObject&gt;().StartBounce(5.0f);\n        }\n    }\n}\n</code></pre>\n\n<p>The grid of objects works.\nHowever the test code errors with Object reference not set to an instance of an object from the line \n    CreateGrid.gridArray[x, 3].GetComponent().StartBounce(5.0f);</p>\n\n<p>specifically CreateGrid.gridArray</p>\n\n<p>Given that I seem to be really struggling with a concept, please explain clearly.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "list", "linq", "lambda", "reactiveui"], "answers": [{"tags": [], "owner": {"reputation": 297, "user_id": 11351183, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SAHuILVYU3Y/AAAAAAAAAAI/AAAAAAAAAus/h-V9aBReS_w/photo.jpg?sz=128", "display_name": "Artyom", "link": "https://stackoverflow.com/users/11351183/artyom"}, "is_accepted": true, "score": 5, "last_activity_date": 1564054235, "last_edit_date": 1564054235, "creation_date": 1564053935, "answer_id": 57200836, "question_id": 57192317, "link": "https://stackoverflow.com/questions/57192317/reactiveui-observing-collection-with-whenany-and-assigning-boolean-propertyhelpe/57200836#57200836", "title": "ReactiveUI observing Collection with WhenAny and assigning boolean PropertyHelper", "body": "<p>The <code>WhenAnyValue</code> extension method is typically used for cases when you'd like to observe changes of view model properties and is excellent in doing just that. It wasn't designed to work with mutable collections, such as <code>ObservableCollection</code> or <code>ReadOnlyObservableCollection</code>. For reactive collections, use the <a href=\"https://github.com/reactiveui/DynamicData\" rel=\"noreferrer\">DynamicData</a> library, see the related <a href=\"https://reactiveui.net/docs/handbook/collections/\" rel=\"noreferrer\">documentation page</a> as well. Newest ReactiveUI versions have a dependency on DynamicData, so you don't have to install any additional packages.</p>\n\n<p>TLDR;</p>\n\n<ol>\n<li><p>If you have a property of type <code>T</code>, then use <code>WhenAnyValue</code>.</p></li>\n<li><p>If you have a property of type <code>ObservableCollection&lt;T&gt;</code>, use <code>ToObservableChangeSet</code>.</p></li>\n</ol>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[ObservableAsProperty] \npublic bool Easy { get; }\n\npublic ObservableCollection&lt;string&gt; Difficulties { get; }\n\npublic Song()\n{\n    Difficulties = new ObservableCollection&lt;string&gt;();\n\n    // Observe any changes in the observable collection.\n    // Note that the property has no public setters, so we \n    // assume the collection is mutated by using the Add(), \n    // Delete(), Clear() and other similar methods.\n    this.Difficulties\n        // Convert the collection to a stream of chunks,\n        // so we have IObservable&lt;IChangeSet&lt;TKey, TValue&gt;&gt;\n        // type also known as the DynamicData monad.\n        .ToObservableChangeSet(x =&gt; x)\n        // Each time the collection changes, we get\n        // all updated items at once.\n        .ToCollection()\n        // If the collection isn't empty, we access the\n        // first element and check if it is an empty string.\n        .Select(items =&gt; \n            items.Any() &amp;&amp;\n            !string.IsNullOrWhiteSpace(items.First()))\n        // Then, we convert the boolean value to the\n        // property. When the first string in the\n        // collection isn't empty, Easy will be set\n        // to True, otherwise to False.\n        .ToPropertyEx(this, x =&gt; x.Easy);\n}\n</code></pre>\n\n<p>Note, that if you are using immutable data sets, for example somewhat like this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Reactive] public IEnumerable&lt;string&gt; Difficulties { get; set; }\n</code></pre>\n\n<p>and that data set is updated only through its public setter, then you should use the <code>WhenAnyValue</code> extension method here, as the collection declared as <code>IEnumerable&lt;string&gt;</code> isn't observable:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>this.WhenAnyValue(x =&gt; x.Difficulties)\n    .Select(items =&gt; \n        items.Any() &amp;&amp;\n        !string.IsNullOrWhiteSpace(items.First()))\n    .ToPropertyEx(this, x =&gt; x.Easy);\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 11741663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40653ada9722e5da8be5f9921f05231e?s=128&d=identicon&r=PG&f=1", "display_name": "TomMaier", "link": "https://stackoverflow.com/users/11741663/tommaier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1644, "favorite_count": 0, "accepted_answer_id": 57200836, "answer_count": 1, "score": 1, "last_activity_date": 1564054235, "creation_date": 1564009541, "question_id": 57192317, "link": "https://stackoverflow.com/questions/57192317/reactiveui-observing-collection-with-whenany-and-assigning-boolean-propertyhelpe", "title": "ReactiveUI observing Collection with WhenAny and assigning boolean PropertyHelper", "body": "<p>I have an ObservableCollection containing strings that I want to observe. When there is a change in the first index I want to update a ObservableAsPropertyHelper boolean variable and set it to true if the string at that index is not null and not empty. Alternatively a way to convert the Collection into an second ObservableCollection containing bools would also be ok.<br>\nHere is what I tried:</p>\n\n<pre><code>public ObservableCollection&lt;string&gt; Difficulties { get; set; }\npublic extern bool Easy { [ObservableAsProperty] get; }\n\npublic Song()\n{\n    this.WhenAny(x =&gt; x.Easy, x =&gt; x.GetValue()[0] != null &amp;&amp; x.GetValue()[0}]!= \"\").ToPropertyEx(this, x =&gt; x.Easy);\n}\n</code></pre>\n\n<p>I tried the code above because it worked for a similar example:</p>\n\n<pre><code>[Reactive] public string Title { get; set; }\npublic extern bool Enabled { [ObservableAsProperty] get; }\n\npublic Song()\n{\n   this.WhenAny(x =&gt; x.Title, x =&gt; x.GetValue() != null &amp;&amp; x.GetValue() != \"\").ToPropertyEx(this, x =&gt; x.Enabled);\n}\n</code></pre>\n\n<p>I am pretty new to using Linq expressions so the solution is probably easy (much easier that the stuff I have tried -_-)<br>\nI am using ReactiveUi.WPF and ReactiveUi.Fody on .net core 3.0 by the way.</p>\n"}, {"tags": ["c#", "cntk"], "comments": [{"owner": {"reputation": 2425, "user_id": 1183804, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/hk2kW.jpg?s=128&g=1", "display_name": "Rusty Nail", "link": "https://stackoverflow.com/users/1183804/rusty-nail"}, "edited": false, "score": 0, "creation_date": 1564968155, "post_id": 57192309, "comment_id": 101190428, "body": "Well, it must be too hard? No answers or comments..."}], "owner": {"reputation": 2425, "user_id": 1183804, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/hk2kW.jpg?s=128&g=1", "display_name": "Rusty Nail", "link": "https://stackoverflow.com/users/1183804/rusty-nail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1564706235, "creation_date": 1564009459, "last_edit_date": 1564706139, "question_id": 57192309, "link": "https://stackoverflow.com/questions/57192309/cntk-add-a-bidirectional-lstm-layer", "title": "CNTK add a Bidirectional LSTM Layer", "body": "<p>From here: <a href=\"https://docs.microsoft.com/en-us/cognitive-toolkit/Hands-On-Labs-Language-Understanding#solution-3-bidirectional-recurrent-model\" rel=\"nofollow noreferrer\">Tutorial</a></p>\n\n<p>I am asking how C# could implement such a function:</p>\n\n<p>In Brainscript:</p>\n\n<pre><code>BiRecurrentLSTMLayer {outDim} = {\n    F = RecurrentLSTMLayer {outDim, goBackwards=false}\n    G = RecurrentLSTMLayer {outDim, goBackwards=true}\n    apply (x) = Splice (F(x):G(x))\n}.apply\n</code></pre>\n\n<p>The function is implemented in the Sequential:</p>\n\n<pre><code>hiddenDim = 150      ##### changed from 300 to 150\n\nmodel = Sequential (\n    EmbeddingLayer {embDim} :\n    ###OneWordLookahead :                   ##### removed\n    BatchNormalizationLayer {} :\n    BiRecurrentLSTMLayer {hiddenDim} :\n    BatchNormalizationLayer {} :\n    DenseLayer {labelDim}\n)\n</code></pre>\n\n<p>An LSTM is implemented here: <a href=\"https://github.com/microsoft/CNTK/blob/master/Examples/TrainingCSharp/Common/LSTMSequenceClassifier.cs\" rel=\"nofollow noreferrer\">LSTMClassifier</a></p>\n\n<p>I have got this so far:</p>\n\n<pre><code>Function BiRecurrentLSTMLayer(Variable input, int outDim)\n{\n\n    Function F = Layers.LSTMLayer(input, outDim, 50, 35, 50, Device, \"\");\n    Function G = Layers.LSTMLayer(input, outDim, 50, 35, 50, Device, \"\");\n\n    return CNTK.CNTKLib.Splice(new VariableVector() { F, G }, null, \"\");\n}\n</code></pre>\n\n<p>As you can see, there is no F of X'ing! Or go-Backwards...</p>\n\n<p>To get the LSTM 'forward' and 'backward' setting, how to splice, and add as an array function?</p>\n\n<p>EDIT:</p>\n\n<p>I have dabbled with, and cant find a spot of documentation on: <code>CNTK.CNTKLib.ForwardBackward</code> see the code:</p>\n\n<pre><code>Function F = LSTMLayer(input, numOutput / 2, embedDim, hiddenDim / 2, cellDim, device, \"\");\nFunction G = LSTMLayer(input, (int)((numOutput / 2.0) + 0.5D), embedDim, hiddenDim / 2, cellDim, device, \"\");\n\nreturn CNTK.CNTKLib.ForwardBackward(G, F, blankTokenId, delayConstraint, name);\n</code></pre>\n\n<p>but get the error:</p>\n\n<blockquote>\n  <p>System.ApplicationException: 'Reduction operation ReduceElements: number (1) of reduction axes exceeds the rank (0) of the operand shape '[]'.</p>\n</blockquote>\n"}, {"tags": ["c#", ".net", "string"], "comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1564009640, "post_id": 57192225, "comment_id": 100894032, "body": "Use a <code>Regex</code> pattern to extract and LINQ to process."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11833128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b598c705e4b9def7a36485c84f61952b?s=128&d=identicon&r=PG&f=1", "display_name": "Shylif", "link": "https://stackoverflow.com/users/11833128/shylif"}, "edited": false, "score": 0, "creation_date": 1564011369, "post_id": 57192390, "comment_id": 100894317, "body": "I like this solution. Would you be able to implement this without regex? @NetMage"}, {"owner": {"reputation": 876, "user_id": 828062, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/387f7aa5e840b008c3f9837cbe2519f0?s=128&d=identicon&r=PG", "display_name": "zendu", "link": "https://stackoverflow.com/users/828062/zendu"}, "reply_to_user": {"reputation": 9, "user_id": 11833128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b598c705e4b9def7a36485c84f61952b?s=128&d=identicon&r=PG&f=1", "display_name": "Shylif", "link": "https://stackoverflow.com/users/11833128/shylif"}, "edited": false, "score": 0, "creation_date": 1564014113, "post_id": 57192390, "comment_id": 100894781, "body": "@Shylif, can you elaborate reasons not to use regular expression? This feels like an assignment. Do you really want community to solve it for you??"}, {"owner": {"reputation": 9, "user_id": 11833128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b598c705e4b9def7a36485c84f61952b?s=128&d=identicon&r=PG&f=1", "display_name": "Shylif", "link": "https://stackoverflow.com/users/11833128/shylif"}, "edited": false, "score": 0, "creation_date": 1564014261, "post_id": 57192390, "comment_id": 100894806, "body": "It&#39;s not an assignment I just would like to have saw another solution to compare speed and memory efficiency."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 9, "user_id": 11833128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b598c705e4b9def7a36485c84f61952b?s=128&d=identicon&r=PG&f=1", "display_name": "Shylif", "link": "https://stackoverflow.com/users/11833128/shylif"}, "edited": false, "score": 0, "creation_date": 1564081745, "post_id": 57192390, "comment_id": 100923897, "body": "@Shylif I added a non-RE solution using LINQ and Split."}], "tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 0, "last_activity_date": 1564175160, "last_edit_date": 1564175160, "creation_date": 1564010120, "answer_id": 57192390, "question_id": 57192225, "link": "https://stackoverflow.com/questions/57192225/is-there-a-function-in-string-that-extracts-a-specific-substring-from-all-occure/57192390#57192390", "title": "Is there a function in string that extracts a specific substring from all occurences of a delimiter?", "body": "<p>Assuming you meant your string (I used <code>src</code>) has multiple lines within it, this should work:</p>\n\n<pre><code>var pRE = new Regex(@\"(?&lt;=})[^,\\r\\n]+\", RegexOptions.Compiled);\nvar ans = String.Join(\", \", pRE.Matches(src).Cast&lt;Match&gt;().Select(m =&gt; m.Value).Distinct());\n</code></pre>\n\n<p>I did not sort the Px however.</p>\n\n<p>Here is a non-RE based version using an extension method I have <code>UpTo</code> which takes an array of stopper characters and returns the string up to the first occurrence, or the whole string if none occur.</p>\n\n<pre><code>var ans = src.Split('}').Skip(1).Select(s =&gt; s.UpTo(',', '\\r', '\\n')).Distinct();\n</code></pre>\n\n<p>Here is the extension:</p>\n\n<pre><code>public static class Extensions {\n    public static string UpTo(this string s, params char[] stopChars) {\n        var stopPos = s.IndexOfAny(stopChars);\n        return (stopPos &gt;= 0) ? s.Substring(0, stopPos) : s;\n    }    \n    public static T MinOrDefault&lt;T&gt;(this IEnumerable&lt;T&gt; src, T defval = default) =&gt; src.DefaultIfEmpty(defval).Min();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 102, "user_id": 6938368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e586a5ea40963e848fab2dc8a1c48d?s=128&d=identicon&r=PG&f=1", "display_name": "M.Hazara", "link": "https://stackoverflow.com/users/6938368/m-hazara"}, "is_accepted": false, "score": 0, "last_activity_date": 1564013148, "creation_date": 1564013148, "answer_id": 57192677, "question_id": 57192225, "link": "https://stackoverflow.com/questions/57192225/is-there-a-function-in-string-that-extracts-a-specific-substring-from-all-occure/57192677#57192677", "title": "Is there a function in string that extracts a specific substring from all occurences of a delimiter?", "body": "<p>As mentioned, you can use regex to solve your problem. But if you want to do it without using regex then you can use split('}') on your string to create a collection of substrings, then take all substrings starting with P followed by a number, then sort the result and join your collection into a new string. \ud83d\udc4c</p>\n"}, {"tags": [], "owner": {"reputation": 14634, "user_id": 64348, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/h3b3u.png?s=128&g=1", "display_name": "Kit", "link": "https://stackoverflow.com/users/64348/kit"}, "is_accepted": false, "score": 0, "last_activity_date": 1564016282, "last_edit_date": 1564016282, "creation_date": 1564015194, "answer_id": 57192855, "question_id": 57192225, "link": "https://stackoverflow.com/questions/57192225/is-there-a-function-in-string-that-extracts-a-specific-substring-from-all-occure/57192855#57192855", "title": "Is there a function in string that extracts a specific substring from all occurences of a delimiter?", "body": "<p>No, but there can be if you make an extension method out of this solution, which uses a <a href=\"https://en.wikipedia.org/wiki/Finite-state_machine\" rel=\"nofollow noreferrer\">state machine</a> and no regular expressions.</p>\n\n<p>Without knowing all of your constraints, this may not be 100% correct, but it <em>does</em> yield the correct output you are looking for. You can add states and constraints to this if necessary.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        var input = @\"        {..}P1, {.sdfsdfsdf.}P2, {.sdfsdfsdf.}P3, {..}P3\n    {..}P4, {..}P1, {..}P8886, {..}P5\";\n\n        var items = Extractinator(input).Distinct().OrderBy(x =&gt; x).ToList();\n        Console.WriteLine(string.Join(\", \", items));\n        Console.ReadLine();\n    }\n\n    static IEnumerable&lt;string&gt; Extractinator(string source)\n    {\n        var state = States.Extraneous;\n        string item = \"\";\n        foreach (var c in source)\n        {\n            switch (state)\n            {\n                case States.Extraneous:\n                    switch (c)\n                    {\n                        case '{':\n                            state = States.InsideBrackets;\n                            break;\n                    }\n                    continue;\n                case States.InsideBrackets:\n                    switch (c)\n                    {\n                        case '}':\n                            state = States.BuildingItem;\n                            break;\n                    }\n                    continue;\n                case States.BuildingItem:\n                    switch (c)\n                    {\n                        case char _ when char.IsDigit(c) || char.IsLetter(c):\n                            item += c;\n                            break;\n                        default:\n                            yield return item;\n                            item = \"\";\n                            state = States.Extraneous;\n                            break;\n                    }\n                    continue;\n            }\n        }\n\n        if (item != \"\")\n            yield return item;\n    }\n\n    enum States\n    {\n        Extraneous,\n        InsideBrackets,\n        BuildingItem,\n    }\n}\n</code></pre>\n\n<p>I gummed up the input just to make it a little more realistic. I also used <code>switch</code> rather than <code>if</code>/<code>else</code> as that's a \"classic\" way to do it that allows you to add in new rules if necessary. For example, if the comma <code>,</code> is really the signal to move to extraneous text, then in <code>case States.BuildingItem</code> you might want to replace <code>case char _ when char.IsDigit(c) || char.IsLetter(c):</code> with <code>case char _ when c != ',':</code>.</p>\n\n<p>The key to state machines like this is buffering up partial results, yielding/doing something with the results when complete, and knowing when to switch states.</p>\n"}], "owner": {"reputation": 9, "user_id": 11833128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b598c705e4b9def7a36485c84f61952b?s=128&d=identicon&r=PG&f=1", "display_name": "Shylif", "link": "https://stackoverflow.com/users/11833128/shylif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1564175160, "creation_date": 1564008728, "question_id": 57192225, "link": "https://stackoverflow.com/questions/57192225/is-there-a-function-in-string-that-extracts-a-specific-substring-from-all-occure", "title": "Is there a function in string that extracts a specific substring from all occurences of a delimiter?", "body": "<p>I have a string for example that has multiple strings within it that contain tokens that must be extracted while also removing duplicates</p>\n\n<pre><code>{..}P1, {..}P2, {..}P3, {..}P3\n{..}P4, {..}P1, {..}P6, {..}P5\n</code></pre>\n\n<p>Is there a built in string function (or one that can be made) that can be used to create this tokens?:</p>\n\n<pre><code>P1, P2, P3, P4, P5, P6\n</code></pre>\n\n<p>The P tokens will always immediately follow an ending curly brace with no space in between. How can I achieve the result?</p>\n"}, {"tags": ["c#", "winforms"], "answers": [{"comments": [{"owner": {"reputation": 3111, "user_id": 847881, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/00937cabb32af54d9f127dbaa938e9c9?s=128&d=identicon&r=PG", "display_name": "Daniel Lip", "link": "https://stackoverflow.com/users/847881/daniel-lip"}, "edited": false, "score": 0, "creation_date": 1564010414, "post_id": 57192260, "comment_id": 100894164, "body": "I have edited my question to be more specific with what I wanted and with two problems I see when highlighting in green like in your answer. I want to color only the text part of the node/s not the whole line. And I&#39;m not sure what is the small white color on the red triangle that show now after changing the highlighting code in the OnDrawNode."}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "reply_to_user": {"reputation": 3111, "user_id": 847881, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/00937cabb32af54d9f127dbaa938e9c9?s=128&d=identicon&r=PG", "display_name": "Daniel Lip", "link": "https://stackoverflow.com/users/847881/daniel-lip"}, "edited": false, "score": 0, "creation_date": 1564010600, "post_id": 57192260, "comment_id": 100894194, "body": "@MuhamadAbutShtil Then just call the highlight coloring after the backcolor is filled.  I updated the post."}], "tags": [], "owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "is_accepted": true, "score": 1, "last_activity_date": 1564010563, "last_edit_date": 1564010563, "creation_date": 1564009071, "answer_id": 57192260, "question_id": 57192209, "link": "https://stackoverflow.com/questions/57192209/how-can-i-highlight-a-node-in-a-treeview-when-selecting-it/57192260#57192260", "title": "How can I highlight a node in a treeview when selecting it?", "body": "<p>Just check to see if the node is highlighted like you do with the Focus Rectangle:</p>\n\n<pre><code>Color backColor = (GetTopNodeIndex(e.Node) &amp; 1) == 0 ? BackColor : AlternateBackColor;\nusing (Brush b = new SolidBrush(backColor))\n{\n  e.Graphics.FillRectangle(b, new Rectangle(0, e.Bounds.Top, ClientSize.Width, e.Bounds.Height));\n}\nif ((e.State &amp; TreeNodeStates.Selected) != 0) {\n  e.Graphics.FillRectangle(Brushes.Green, e.Bounds);\n}\n</code></pre>\n"}], "owner": {"reputation": 3111, "user_id": 847881, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/00937cabb32af54d9f127dbaa938e9c9?s=128&d=identicon&r=PG", "display_name": "Daniel Lip", "link": "https://stackoverflow.com/users/847881/daniel-lip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57192260, "answer_count": 1, "score": 1, "last_activity_date": 1564010563, "creation_date": 1564008602, "last_edit_date": 1564010300, "question_id": 57192209, "link": "https://stackoverflow.com/questions/57192209/how-can-i-highlight-a-node-in-a-treeview-when-selecting-it", "title": "How can I highlight a node in a treeview when selecting it?", "body": "<p>The problem is that inside OnDrawNode I'm using specific background and alternative colors already :</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Drawing;\nusing System.Windows.Forms;\n\npublic class AdvancedTreeView : TreeView\n{\n    private Bitmap openedIcon, closedIcon;\n    private List&lt;TreeNode&gt; rootNodes = new List&lt;TreeNode&gt;();\n\n    public AdvancedTreeView()\n    {\n        DrawMode = TreeViewDrawMode.OwnerDrawText;\n        ShowLines = false;\n        AlternateBackColor = BackColor;\n        ArrowColor = SystemColors.WindowText;\n        this.AllowDrop = true;  \n    }\n\n    public Color AlternateBackColor { get; set; }\n    public Color ArrowColor { get; set; }\n\n    protected override void OnDrawNode(DrawTreeNodeEventArgs e)\n    {\n        Color backColor = (GetTopNodeIndex(e.Node) &amp; 1) == 0 ? BackColor : AlternateBackColor;\n        using (Brush b = new SolidBrush(backColor))\n        {\n            e.Graphics.FillRectangle(b, new Rectangle(0, e.Bounds.Top, ClientSize.Width, e.Bounds.Height));\n        }\n\n        // icon\n        if (e.Node.Nodes.Count &gt; 0)\n        {\n            Image icon = GetIcon(e.Node.IsExpanded);\n            e.Graphics.DrawImage(icon, e.Bounds.Left - icon.Width - 3, e.Bounds.Top);\n        }\n\n        // text (due to OwnerDrawText mode, indenting of e.Bounds will be correct)\n        TextRenderer.DrawText(e.Graphics, e.Node.Text, Font, e.Bounds, ForeColor);\n\n        // indicate selection (if not by backColor):\n        if ((e.State &amp; TreeNodeStates.Selected) != 0)\n            ControlPaint.DrawFocusRectangle(e.Graphics, e.Bounds);\n\n    }\n</code></pre>\n\n<p>And since it's keep doing calling OnDrawNode all the time it will never do the part inside the OnAfterSelect :</p>\n\n<pre><code>protected override void OnAfterSelect(TreeViewEventArgs e)\n    {\n        e.Node.BackColor = Color.Green;\n    }\n</code></pre>\n\n<p>Once I click on a node and selecting it, It will also go to the OnDrawNode and will color the node/s in it's original colors again.</p>\n\n<p>I want to keep the code in the OnDrawNode but also to be able to highlight the selected node/s.</p>\n\n<p>EDIT : This is what I have tried so far :</p>\n\n<p>Inside the OnDrawNode :</p>\n\n<pre><code>Color backColor = (GetTopNodeIndex(e.Node) &amp; 1) == 0 ? BackColor : AlternateBackColor;\n        if ((e.State &amp; TreeNodeStates.Selected) != 0)\n        {\n            e.Graphics.FillRectangle(Brushes.Green, e.Bounds);\n        }\n        else\n        {\n            using (Brush b = new SolidBrush(backColor))\n            {\n                e.Graphics.FillRectangle(b, new Rectangle(0, e.Bounds.Top, ClientSize.Width, e.Bounds.Height));\n            }\n        }\n</code></pre>\n\n<p>But there is two problem with this :</p>\n\n<ol>\n<li><p>In the two screenshots when it's on Node10 it looks like fine but when it's on Node9 you can it's coloring the whole line. And I wanted to highlight only the text \"New Node 10\" ... \"New Node 9\" and not the whole line.</p></li>\n<li><p>When selecting a node on the red line triangle there is something small in white color. It wasn't like that before changing the code in the OnDrawNode.</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/ZgXNW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZgXNW.jpg\" alt=\"Selected Node 10\"></a></p>\n\n<p>And the second screenshot :</p>\n\n<p><a href=\"https://i.stack.imgur.com/CGpzD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CGpzD.jpg\" alt=\"Selected Node 9\"></a></p>\n\n<p>This is the full code of the TreeView control :</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Drawing;\nusing System.Windows.Forms;\n\npublic class AdvancedTreeView : TreeView\n{\n    private Bitmap openedIcon, closedIcon;\n    private List&lt;TreeNode&gt; rootNodes = new List&lt;TreeNode&gt;();\n\n    public AdvancedTreeView()\n    {\n        DrawMode = TreeViewDrawMode.OwnerDrawText;\n        ShowLines = false;\n        AlternateBackColor = BackColor;\n        ArrowColor = SystemColors.WindowText;\n        this.AllowDrop = true;\n    }\n\n    public Color AlternateBackColor { get; set; }\n    public Color ArrowColor { get; set; }\n\n    protected override void OnDrawNode(DrawTreeNodeEventArgs e)\n    {\n        Color backColor = (GetTopNodeIndex(e.Node) &amp; 1) == 0 ? BackColor : AlternateBackColor;\n        if ((e.State &amp; TreeNodeStates.Selected) != 0)\n        {\n            e.Graphics.FillRectangle(Brushes.Green, e.Bounds);\n        }\n        else\n        {\n            using (Brush b = new SolidBrush(backColor))\n            {\n                e.Graphics.FillRectangle(b, new Rectangle(0, e.Bounds.Top, ClientSize.Width, e.Bounds.Height));\n            }\n        }\n\n        // icon\n        if (e.Node.Nodes.Count &gt; 0)\n        {\n            Image icon = GetIcon(e.Node.IsExpanded);\n            e.Graphics.DrawImage(icon, e.Bounds.Left - icon.Width - 3, e.Bounds.Top);\n        }\n\n        // text (due to OwnerDrawText mode, indenting of e.Bounds will be correct)\n        TextRenderer.DrawText(e.Graphics, e.Node.Text, Font, e.Bounds, ForeColor);\n\n        // indicate selection (if not by backColor):\n        if ((e.State &amp; TreeNodeStates.Selected) != 0)\n            ControlPaint.DrawFocusRectangle(e.Graphics, e.Bounds);\n    }\n\n    protected override void OnItemDrag(ItemDragEventArgs e)\n    {\n        // Move the dragged node when the left mouse button is used.\n        if (e.Button == MouseButtons.Left)\n        {\n            DoDragDrop(e.Item, DragDropEffects.Move);\n        }\n\n        // Copy the dragged node when the right mouse button is used.\n        else if (e.Button == MouseButtons.Right)\n        {\n            DoDragDrop(e.Item, DragDropEffects.Copy);\n        }\n    }\n\n    protected override void OnDragOver(DragEventArgs e)\n    {\n        // Retrieve the client coordinates of the mouse position.\n        Point targetPoint = this.PointToClient(new Point(e.X, e.Y));\n\n        // Select the node at the mouse position.\n        this.SelectedNode = this.GetNodeAt(targetPoint);\n    }\n\n    protected override void OnDragDrop(DragEventArgs e)\n    {\n        Point targetPoint = PointToClient(new Point(e.X, e.Y));\n        TreeNode targetNode = GetNodeAt(targetPoint);\n        TreeNode draggedNode = (TreeNode)e.Data.GetData(typeof(TreeNode));\n        if (draggedNode == null || targetNode == null || draggedNode.Level != targetNode.Level)\n        {\n            return;\n        }\n        else\n        {\n            TreeNode parentNode = targetNode;\n            if (!draggedNode.Equals(targetNode) &amp;&amp; targetNode != null)\n            {\n                bool canDrop = true;\n                while (canDrop &amp;&amp; (parentNode != null))\n                {\n                    canDrop = !Object.ReferenceEquals(draggedNode, parentNode);\n                    parentNode = parentNode.Parent;\n                }\n                if (canDrop)\n                {\n                    TreeNode treeNode = draggedNode.Parent;\n                    if (treeNode != null)\n                    {\n                        int index = draggedNode.Index;\n                        draggedNode.Remove();\n                        treeNode.Nodes.Insert(targetNode.Index, draggedNode);\n                        targetNode.Remove();\n                        treeNode.Nodes.Insert(index, targetNode);\n                    }\n                    else\n                    {\n                        int draggedindex = draggedNode.Index;\n                        int targetindex = targetNode.Index;\n                        draggedNode.Remove();\n                        targetNode.Remove();\n                        this.Nodes.Insert(targetindex, draggedNode);\n                        this.Nodes.Insert(draggedindex, targetNode);\n                    }\n                }\n            }\n        }\n        SelectedNode = draggedNode;\n    }\n\n    private int GetTopNodeIndex(TreeNode node)\n    {\n        while (node.Parent != null)\n            node = node.Parent;\n\n        return Nodes.IndexOf(node);\n    }\n\n    // Determine whether one node is a parent \n    // or ancestor of a second node.\n    private bool ContainsNode(TreeNode node1, TreeNode node2)\n    {\n        // Check the parent node of the second node.\n        if (node2.Parent == null) return false;\n        if (node2.Parent.Equals(node1)) return true;\n\n        // If the parent node is not null or equal to the first node, \n        // call the ContainsNode method recursively using the parent of \n        // the second node.\n        return ContainsNode(node1, node2.Parent);\n    }\n\n    private Image GetIcon(bool nodeIsExpanded)\n    {\n        if (openedIcon == null)\n            InitIcons();\n        return nodeIsExpanded ? openedIcon : closedIcon;\n    }\n\n    private void InitIcons()\n    {\n        openedIcon = new Bitmap(16, 16);\n        closedIcon = new Bitmap(16, 16);\n        using (Brush b = new SolidBrush(ArrowColor))\n        {\n            using (Graphics g = Graphics.FromImage(openedIcon))\n                g.FillPolygon(b, new[] { new Point(0, 0), new Point(15, 0), new Point(8, 15), });\n            using (Graphics g = Graphics.FromImage(closedIcon))\n                g.FillPolygon(b, new[] { new Point(0, 0), new Point(15, 8), new Point(0, 15), });\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core-mvc"], "answers": [{"tags": [], "owner": {"reputation": 14390, "user_id": 10158551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/45RCc.jpg?s=128&g=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/10158551/ryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1564025793, "creation_date": 1564025793, "answer_id": 57193919, "question_id": 57192165, "link": "https://stackoverflow.com/questions/57192165/aspnetcore-mvc-upload-file-error-the-var-caminho-always-null-even-with-iformfil/57193919#57193919", "title": "AspnetCore.Mvc Upload file error, the var caminho always null even with IFormfile valid", "body": "<p>Make sure you have the <code>ImageFiles</code> folder in wwwroot. Then try to use below code</p>\n\n<pre><code>var caminho = Path.Combine(he.WebRootPath, \"ImageFiles\",Path.GetFileName(Localimagem.FileName));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11833093, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215332130445091/picture?type=large", "display_name": "Miguel Gomes", "link": "https://stackoverflow.com/users/11833093/miguel-gomes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1564025793, "creation_date": 1564008245, "last_edit_date": 1564009390, "question_id": 57192165, "link": "https://stackoverflow.com/questions/57192165/aspnetcore-mvc-upload-file-error-the-var-caminho-always-null-even-with-iformfil", "title": "AspnetCore.Mvc Upload file error, the var caminho always null even with IFormfile valid", "body": "<p>I try upload a image, but var root is always null...</p>\n\n<p>NullReferenceException: Object reference not set to an instance of an object.</p>\n\n<pre><code>[HttpPost]\n[ValidateAntiForgeryToken]\npublic async Task&lt;IActionResult&gt; Create([Bind(\"Vinhoid,Nome,Ano,Teoralcool,Produtorid,Tipoid,Regiaoid,Datacriacao,Localimagem,Garrafid,Descricao,Preco,Stock\")] VinhoDistribuicao vinhoDistribuicao, IFormFile Localimagem)\n{\n    if (HttpContext.Session.GetString(\"TipoUtilizador\") == \"Garrafeira\")\n\n\n\n\n    {\n        if (ModelState.IsValid)\n        {\n           if (_context.Vinho.Any(x =&gt; x.Ano == vinhoDistribuicao.Ano &amp;&amp; x.Nome == vinhoDistribuicao.Nome &amp;&amp; x.Tipoid == vinhoDistribuicao.Tipoid) == false)\n\n           {\n\n                var caminho = Path.Combine(he.WebRootPath + \"/ImageFiles\",\n                    Path.GetFileName(Localimagem.FileName));\n\n                FileStream fileStream = new FileStream(caminho, FileMode.Create);\n                Localimagem.CopyTo(fileStream);\n                fileStream.Close();\n</code></pre>\n\n<p>HTML</p>\n\n<pre><code>@model Lab4_Vinhos6.Models.VinhoDistribuicao\n\n&lt;div class=\"form-group\"&gt;\n    &lt;label asp-for=\"Localimagem\" class=\"control-label\"&gt;&lt;/label&gt;\n    &lt;input asp-for=\"Localimagem\" type=\"file\" accept=\".png, .jpg\" class=\"form-control\" value=\"\" /&gt;\n\n    &lt;span asp-validation-for=\"Localimagem\" class=\"text-danger\"&gt;&lt;/span&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>NullReferenceException: Object reference not set to an instance of an object.</p>\n\n<pre><code>var caminho = Path.Combine(he.WebRootPath + \"/ImageFiles\",\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "rest"], "comments": [{"owner": {"reputation": 906, "user_id": 4393579, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-V1IEbWgumBA/AAAAAAAAAAI/AAAAAAAAAPw/5dZ4Yl2qgd4/photo.jpg?sz=128", "display_name": "Stas Ivanov", "link": "https://stackoverflow.com/users/4393579/stas-ivanov"}, "edited": false, "score": 0, "creation_date": 1564011565, "post_id": 57192148, "comment_id": 100894357, "body": "In case the line you give as an example is line 46 in your XmlController.cs, I would double check under debugging if  the formatter you are passing as argument is null or not."}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1564014414, "post_id": 57192148, "comment_id": 100894828, "body": "Did you by chance clear you XML formatters at Startup?"}, {"owner": {"reputation": 1211, "user_id": 1890137, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a1576e69670076684909c1a117b507cd?s=128&d=identicon&r=PG", "display_name": "Hoodlum", "link": "https://stackoverflow.com/users/1890137/hoodlum"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1564061327, "post_id": 57192148, "comment_id": 100913712, "body": "@Nkosi, what do you mean by &quot;clear XML formatters at startup.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 1211, "user_id": 1890137, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a1576e69670076684909c1a117b507cd?s=128&d=identicon&r=PG", "display_name": "Hoodlum", "link": "https://stackoverflow.com/users/1890137/hoodlum"}, "is_accepted": false, "score": 0, "last_activity_date": 1564062276, "creation_date": 1564062276, "answer_id": 57203450, "question_id": 57192148, "link": "https://stackoverflow.com/questions/57192148/null-argument-exception-for-httpresponsemessage-return-type-from-api/57203450#57203450", "title": "Null argument exception for HttpResponseMessage return type from API", "body": "<p>I was under the impression that \"GlobalConfiguration.Configuration.Formatters.XmlFormatter\" gets a new instance of the formatter. I found that syntax in multiple Google and Stack Overflow searches; but @StasIvanov's question got me wondering, so I instantiated a new System.Net.Http.Formatting.XmlMediaTypeFormatter and passed it in. That fixed the issue.</p>\n"}], "owner": {"reputation": 1211, "user_id": 1890137, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a1576e69670076684909c1a117b507cd?s=128&d=identicon&r=PG", "display_name": "Hoodlum", "link": "https://stackoverflow.com/users/1890137/hoodlum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564062276, "creation_date": 1564008131, "question_id": 57192148, "link": "https://stackoverflow.com/questions/57192148/null-argument-exception-for-httpresponsemessage-return-type-from-api", "title": "Null argument exception for HttpResponseMessage return type from API", "body": "<p>I'm am trying to force my API controller to return XML. Here is the code I am using to return the value :</p>\n\n<pre><code>return Request.CreateResponse(System.Net.HttpStatusCode.OK, doc, GlobalConfiguration.Configuration.Formatters.XmlFormatter);\n</code></pre>\n\n<p>where doc is an XDocument.</p>\n\n<p>I receive this exception : \"Value cannot be null.\\r\\nParameter name: formatter\"\nAny ideas why?</p>\n\n<p>Just for fun, here is the entire response as displayed in Postman\n<a href=\"https://i.stack.imgur.com/s6syP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s6syP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["c#", "file", "dictionary", ".net-3.5"], "comments": [{"owner": {"reputation": 11994, "user_id": 3231537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/buUum.jpg?s=128&g=1", "display_name": "Icepickle", "link": "https://stackoverflow.com/users/3231537/icepickle"}, "edited": false, "score": 0, "creation_date": 1564008981, "post_id": 57192093, "comment_id": 100893899, "body": "Do you need to save it like this in a text document, assuming you will want to read it at some point, you don&#39;t want to use a better way of saving the data? Did you check into <code>File.AppendText(path)</code> to create a streamwriter, or maybe <code>File.AppendAllLines( path, IEnumerable&lt;string&gt;)</code>"}, {"owner": {"reputation": 173, "user_id": 7872996, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c55be51be10ed2bdd160e8042ca972e?s=128&d=identicon&r=PG&f=1", "display_name": "AlexZ", "link": "https://stackoverflow.com/users/7872996/alexz"}, "reply_to_user": {"reputation": 11994, "user_id": 3231537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/buUum.jpg?s=128&g=1", "display_name": "Icepickle", "link": "https://stackoverflow.com/users/3231537/icepickle"}, "edited": false, "score": 0, "creation_date": 1564009126, "post_id": 57192093, "comment_id": 100893925, "body": "@Icepickle but I work in framework 3.5"}, {"owner": {"reputation": 11994, "user_id": 3231537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/buUum.jpg?s=128&g=1", "display_name": "Icepickle", "link": "https://stackoverflow.com/users/3231537/icepickle"}, "edited": false, "score": 0, "creation_date": 1564009203, "post_id": 57192093, "comment_id": 100893945, "body": "That&#39;s good information to add to your question :)"}, {"owner": {"reputation": 777, "user_id": 6929654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b75028ea25d35f08d8be18fb73db5a0a?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/6929654/joseph"}, "edited": false, "score": 1, "creation_date": 1564009471, "post_id": 57192093, "comment_id": 100894000, "body": "@AlexZ just for future reference, there&#39;s a .net-3.5 flag you can add to your question to specify which version you&#39;re using. Its helpful for us to know so that we can  make sure our answers work with your configuration - otherwise we tend to assume you&#39;re using the latest main version."}], "answers": [{"comments": [{"owner": {"reputation": 11994, "user_id": 3231537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/buUum.jpg?s=128&g=1", "display_name": "Icepickle", "link": "https://stackoverflow.com/users/3231537/icepickle"}, "edited": false, "score": 0, "creation_date": 1564011692, "post_id": 57192231, "comment_id": 100894378, "body": "Good and concise, but would the file need to exist before you can use <code>append: true</code>?"}, {"owner": {"reputation": 777, "user_id": 6929654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b75028ea25d35f08d8be18fb73db5a0a?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/6929654/joseph"}, "reply_to_user": {"reputation": 11994, "user_id": 3231537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/buUum.jpg?s=128&g=1", "display_name": "Icepickle", "link": "https://stackoverflow.com/users/3231537/icepickle"}, "edited": false, "score": 1, "creation_date": 1564015315, "post_id": 57192231, "comment_id": 100894974, "body": "Fair point - the file would not need to exist. I&#39;ll add a note about that - I figured there might be some reason he was using two different sets of logic, but it doesn&#39;t appear to be so from the example code."}], "tags": [], "owner": {"reputation": 777, "user_id": 6929654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b75028ea25d35f08d8be18fb73db5a0a?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/6929654/joseph"}, "is_accepted": false, "score": 2, "last_activity_date": 1564015575, "last_edit_date": 1564015575, "creation_date": 1564008765, "answer_id": 57192231, "question_id": 57192093, "link": "https://stackoverflow.com/questions/57192093/how-to-add-the-value-of-each-dictionary-in-a-new-line-in-txt/57192231#57192231", "title": "How to add the value of each dictionary in a new line in txt?", "body": "<p>If you declare your new StreamWriter with the flag append set to true, it will add to the file instead of overwriting:</p>\n\n<pre><code>new StreamWriter(path, append: true)\n</code></pre>\n\n<p>You'd want to change your else if to this:</p>\n\n<pre><code>else if (File.Exists(path))\n{\n    using (StreamWriter file = new StreamWriter(\"myfile.txt\", append: true))\n    {\n        foreach (var entry in dictionary)\n        {\n            //        //file.WriteLine(\"[{0} {1}]\", entry.Key, entry.Value);\n            valueDic = valueDic + \"|\" + entry.Value.ToString();\n\n        }\n        file.WriteLine(valueDic);\n    }\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>If you're using .Net 3.5 and can't use optional parameters, just replace append: true with true:</p>\n\n<pre><code>new StreamWriter(path, true)\n</code></pre>\n\n<p>Also, when you declare a new StreamWriter in append mode, the file doesn't need to already exist - it will automatically create it if it doesn't exist. All you'd need is to replace your if/else statement with just this:</p>\n\n<pre><code>Dictionary&lt;string, string&gt; dictionary = new Dictionary&lt;string, string&gt;();\ndictionary = objeto.diccionary;\nstring valueDic = \"\";\n\nstring path = Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), @\"myfile.txt\");\n\nusing (StreamWriter file = new StreamWriter(\"myfile.txt\", append: true))\n{\n    foreach (var entry in dictionary)\n    {\n        valueDic = valueDic + \"|\" + entry.Value.ToString();\n    }\n    file.WriteLine(valueDic);\n}\n</code></pre>\n\n<p>But, like Icepickle's answer says, there are more elegant and reusable ways to deal with this entire scenario.</p>\n"}, {"comments": [{"owner": {"reputation": 777, "user_id": 6929654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b75028ea25d35f08d8be18fb73db5a0a?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph", "link": "https://stackoverflow.com/users/6929654/joseph"}, "edited": false, "score": 1, "creation_date": 1564014935, "post_id": 57192511, "comment_id": 100894914, "body": "Good alternative. Definitely more elegant overall than using regular StreamWriters. Always find the answer here interesting, referring to the usability of File wrapper methods vs a regular StreamWriter: <a href=\"https://stackoverflow.com/questions/3924469/c-sharp-i-o-difference-between-system-io-file-and-streamwriter-streamreader\" title=\"c sharp i o difference between system io file and streamwriter streamreader\">stackoverflow.com/questions/3924469/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11994, "user_id": 3231537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/buUum.jpg?s=128&g=1", "display_name": "Icepickle", "link": "https://stackoverflow.com/users/3231537/icepickle"}, "is_accepted": false, "score": 2, "last_activity_date": 1564011515, "creation_date": 1564011515, "answer_id": 57192511, "question_id": 57192093, "link": "https://stackoverflow.com/questions/57192093/how-to-add-the-value-of-each-dictionary-in-a-new-line-in-txt/57192511#57192511", "title": "How to add the value of each dictionary in a new line in txt?", "body": "<p>There are some issues with your code as it is, you really don't need to create the file as you do when it doesn't exist, there are some easier ways to go about this.</p>\n\n<p>For one, you really don't have to create a file manually, this is usually handled by the methods provided to you by the framework, or by specifying a <code>FileMode</code> like <code>OpenOrCreate</code> or <code>Create</code> or <code>Append</code>.</p>\n\n<p>Another thing to note is that you do the same operation twice, once when you are creating the file, once when you are trying to append to the file. This is a bit error prone, if you would change the formatting at a later time, you could forget about the two methods, and then create or append create different strings.</p>\n\n<p>I wrote a bit of a sample which other ways you could go at it.</p>\n\n<p>For example, you could consider this option, of creating the filestream itself, using <code>FileMode.Append</code></p>\n\n<pre><code>static void WriteDictionaryToFile&lt;TKey, TValue&gt;( IDictionary&lt;TKey, TValue&gt; dict, string filename )\n{\n  using (var fs = new StreamWriter( new FileStream(filename, FileMode.Append, FileAccess.Write ) ) )\n  {\n    foreach (var kvp in dict)\n    {\n      fs.WriteLine(string.Format(\"{0}|{1}\", kvp.Key, kvp.Value));\n    }\n  } \n}\n</code></pre>\n\n<p>However, there is no real need to go that deep to create a <code>StreamWriter</code> for appending text to it, C# 3.5 already provides you with the following option, using <code>File.AppendText</code> instead</p>\n\n<pre><code>static void WriteDictionaryToFileEasy&lt;TKey, TValue&gt;( IDictionary&lt;TKey, TValue&gt; dict, string filename)\n{\n  using (var fs = File.AppendText( filename ))\n  {\n    foreach (var kvp in dict)\n    {\n      fs.WriteLine(string.Format(\"{0}|{1}\", kvp.Key, kvp.Value));\n    }\n  }\n}\n</code></pre>\n\n<p>Or if you feel secure enough to use Linq, you could use the <code>File.AppendAllText</code> method instead, although that might feel a bit akward, as we have to add the final newline only when the dictionary is not empty (this is in absence of the <code>File.AppendAllLines</code> method, that would take care of that for you )</p>\n\n<pre><code>static void WriteDictionaryToFileLinq&lt;TKey, TValue&gt;( IDictionary&lt;TKey, TValue&gt; dict, string filename)\n{\n  if ( dict == null || dict.Count == 0)\n  {\n    return;\n  }\n  File.AppendAllText(\n    filename, \n    string.Join(\n      Environment.NewLine, \n      dict.Select( kvp =&gt; string.Format(\"{0}|{1}\", kvp.Key, kvp.Value) )\n        .Concat( new[] { string.Empty } ).ToArray() \n    )  \n  );\n}\n</code></pre>\n\n<p>(I added the line breaks purely for readability here)</p>\n\n<p>If you throw that all together, you could use the program like this:</p>\n\n<pre><code>static void Main(string[] args)\n{\n  var dict = new Dictionary&lt;string, string&gt;()\n  {\n    { \"key1\", \"value1\" }\n  };\n\n  string targetFile = Path.Combine(Environment.CurrentDirectory, \"temp.txt\");\n  if (File.Exists( targetFile))\n  {\n    File.Delete(targetFile);\n  }\n  WriteDictionaryToFile(dict, targetFile);\n  WriteDictionaryToFileEasy(dict, targetFile);\n  WriteDictionaryToFileLinq(dict, targetFile);\n\n  var lines = File.ReadAllLines(targetFile);\n  Debug.Assert(lines.Length == 3, \"Expected exactly 3 lines\");\n  Debug.Assert(string.Equals(lines[0], \"key1|value1\"), \"First line should equal 'key1|value1'\");\n}\n</code></pre>\n\n<p>A final point of consideration is what you want to do with the eventual data that you have stored. I guess at a certain time, you will want to retrieve the data from the files into some dictionaries.</p>\n\n<p>This could potentially create some errors, like having keys or values containing the <code>|</code> character, or most likely, having saved multiple same named keys, just be aware of that, as the question didn't deal with how you would store this data, I am leaving that part open with a warning</p>\n"}], "owner": {"reputation": 173, "user_id": 7872996, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3c55be51be10ed2bdd160e8042ca972e?s=128&d=identicon&r=PG&f=1", "display_name": "AlexZ", "link": "https://stackoverflow.com/users/7872996/alexz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1564028516, "creation_date": 1564007694, "last_edit_date": 1564028516, "question_id": 57192093, "link": "https://stackoverflow.com/questions/57192093/how-to-add-the-value-of-each-dictionary-in-a-new-line-in-txt", "title": "How to add the value of each dictionary in a new line in txt?", "body": "<p>I am consulting an information and I am saving it in a dictionary (I have about 1000 dictionaries) and I want the values of each dictionary to be stored in a line,</p>\n\n<p>but my code currently overwrites each time a new dictionary is read. How can I make it Does each line have the values of each dictionary?</p>\n\n<pre><code>        Dictionary&lt;string, string&gt; dictionary = new Dictionary&lt;string, string&gt;();\n        dictionary = objeto.diccionary;\n        string valueDic = \"\";\n\n\n        string path = Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), @\"myfile.txt\");\n\n\n        if (!File.Exists(path))\n        {\n            File.Create(path).Dispose();\n\n            using (StreamWriter file = new StreamWriter(path))\n            {\n                foreach (var entry in dictionary)\n                {\n\n                    valueDic = valueDic + \"|\" + entry.Value.ToString();\n\n                }\n                file.WriteLine(valueDic);\n            }\n\n        }\n        else if (File.Exists(path))\n        {\n            using (StreamWriter file = new StreamWriter(\"myfile.txt\"))\n            {\n                foreach (var entry in dictionary)\n                {\n            //        //file.WriteLine(\"[{0} {1}]\", entry.Key, entry.Value);\n                    valueDic = valueDic + \"|\" + entry.Value.ToString();\n\n                }\n\n            }\n        }\n</code></pre>\n"}, {"tags": ["c#", "wpf", "listbox", "listboxitem"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3188639"}, "is_accepted": true, "score": 0, "last_activity_date": 1564015604, "creation_date": 1564015604, "answer_id": 57192895, "question_id": 57191973, "link": "https://stackoverflow.com/questions/57191973/c-wpf-help-in-either-1-removing-first-two-entries-in-listbox-or-2-preventing/57192895#57192895", "title": "C# WPF help in either 1. removing first two entries in listbox or 2. preventing it from displaying the command syntax from batch in output", "body": "<p>Perhaps you can collect all output, check first and add to output if not whitespace. Then, in <code>Exited</code> event add to listbox. This is a command line example, but it should work in WPF if you replace <code>Exited</code> event handler.</p>\n\n<pre><code>List&lt;string&gt; output = new List&lt;string&gt;();\nproc.OutputDataReceived += (obj, args) =&gt;\n{\n    if (args.Data != null)\n    {\n        if (String.IsNullOrWhiteSpace(args.Data))\n            return;\n        output.Add(args.Data);\n    }\n};\n\nproc.Exited += (s, args) =&gt;\n{\n    foreach (var o in output)\n        Console.WriteLine(o);\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11833026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IsH_MYMyPs4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsP8YrQBf_K3p4EsqD4QiLmSvF5g/photo.jpg?sz=128", "display_name": "Ryan Hari", "link": "https://stackoverflow.com/users/11833026/ryan-hari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 57192895, "answer_count": 1, "score": 0, "last_activity_date": 1564015604, "creation_date": 1564006742, "last_edit_date": 1564007796, "question_id": 57191973, "link": "https://stackoverflow.com/questions/57191973/c-wpf-help-in-either-1-removing-first-two-entries-in-listbox-or-2-preventing", "title": "C# WPF help in either 1. removing first two entries in listbox or 2. preventing it from displaying the command syntax from batch in output", "body": "<p>Here is the code snippet I have that I am calling during window_loaded event in my wpf. It will execute a batch file, and output the results in listbox. However, the first entry within listbox is showing the command itself from within the batch file. I would like to remove the first entry, or if that can't be done in an efficient manner then to prevent it from displaying it in the first place.</p>\n\n<p>I have tried using item count remove, but it throws an outofargument exception. My educated guess would be that despite the fact that it is trying to add items in window_loaded, it does not finish adding it until the window has actually finished loading. As such when I call the syntax to remove item from index count, it throws that error since the listbox is still empty at this point. So how can I add data while window is loading, and once it is finished adding the data, to remove the first entry that includes syntax from batch or to prevent it from displaying the first entry.</p>\n\n<pre><code>private void Window_Loaded(object sender, RoutedEventArgs e)\n{\n    var info = new ProcessStartInfo(\"extractServiceList.bat\") { UseShellExecute = false, RedirectStandardOutput = true };\n    var proc = new Process { StartInfo = info, EnableRaisingEvents = true };\n\n    proc.OutputDataReceived += (obj, args) =&gt;\n    {\n        if (args.Data != null)\n        {\n            this.Dispatcher.Invoke(() =&gt;\n            {\n                listBoxServices.Items.Add(args.Data);\n\n                //below logic for removing whitespaces from listbox view\n                int count = listBoxServices.Items.Count;\n\n                for (int i = count - 1; i &gt;= 0; i--)\n                {\n                    //Condition evaluating to see if it return true for = listbox items empty and\n                    //looping through each entry to remove the whitespace entry\n                    if (String.IsNullOrWhiteSpace(listBoxServices.Items[i].ToString()))\n                    {\n                        listBoxServices.Items.RemoveAt(i);\n                    }\n                }\n                //end of logic above for removing whitespaces from listbox view\n            });\n\n            //listBoxServices.Items.RemoveAt(listBoxServices.Items.Count - 1);\n        }\n    };\n\n    proc.Start();\n    proc.BeginOutputReadLine();\n}\n</code></pre>\n\n<p><a href=\"https://i.imgur.com/Sif8wky.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/Sif8wky.png</a></p>\n"}, {"tags": ["c#", "quartz.net"], "comments": [{"owner": {"reputation": 2191, "user_id": 6666799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9aCa.jpg?s=128&g=1", "display_name": "Rabban", "link": "https://stackoverflow.com/users/6666799/rabban"}, "edited": false, "score": 0, "creation_date": 1564132695, "post_id": 57191918, "comment_id": 100938237, "body": "&quot;<i>Would this be ideal</i>&quot; No. The Task will wait infinitely and you lose the control over your app. Just let your <code>RunProgramRunExample()</code> return the <code>Scheduler</code> and call <code>.Shutdown()</code> after <code>Console.ReadKey();</code> in your Main method."}, {"owner": {"reputation": 53, "user_id": 3895221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d98887ef0e2773658dba8590111d9e?s=128&d=identicon&r=PG&f=1", "display_name": "simpleorchid", "link": "https://stackoverflow.com/users/3895221/simpleorchid"}, "reply_to_user": {"reputation": 2191, "user_id": 6666799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C9aCa.jpg?s=128&g=1", "display_name": "Rabban", "link": "https://stackoverflow.com/users/6666799/rabban"}, "edited": false, "score": 0, "creation_date": 1564157714, "post_id": 57191918, "comment_id": 100951845, "body": "Then how do we loop it. for the next schedule. Main purpose is to run the job as per schedule. After shutdown(), the job wont run the next schedule. Say the run the task everyday at 9pm.  changing the TriggerBuilder to run every day at 9pm.  then calling shutdown after that. So for the next day. How do we run that as it is already shutdowned."}], "owner": {"reputation": 53, "user_id": 3895221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d98887ef0e2773658dba8590111d9e?s=128&d=identicon&r=PG&f=1", "display_name": "simpleorchid", "link": "https://stackoverflow.com/users/3895221/simpleorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564016204, "creation_date": 1564006397, "last_edit_date": 1564016204, "question_id": 57191918, "link": "https://stackoverflow.com/questions/57191918/how-to-call-the-scheduler-start-again-after-shutdown-quartz-net-3-0-2-and", "title": "How to call the scheduler.Start() again after shutdown()? (quartz.net 3.0.2 and C#)", "body": "<p>I am creating an application that uses quartz.net scheduler (3.0.2 version). I need to make the scheduler works for say many months or years. I dont see other tutorials related to this after googling alot.</p>\n\n<p>So far I have been following the samples used in the site - <a href=\"https://www.quartz-scheduler.net/documentation/quartz-3.x/quick-start.html\" rel=\"nofollow noreferrer\">https://www.quartz-scheduler.net/documentation/quartz-3.x/quick-start.html</a>. </p>\n\n<p>and </p>\n\n<p><a href=\"https://www.quartz-scheduler.net/documentation/quartz-3.x/tutorial/index.html\" rel=\"nofollow noreferrer\">https://www.quartz-scheduler.net/documentation/quartz-3.x/tutorial/index.html</a></p>\n\n<p>For this one....\nawait Task.Delay(TimeSpan.FromSeconds(60));</p>\n\n<p>From this code, I can change it to await Task.Delay(-1) to make it work continuously without shut down if i want to have the scheduler works for many months or years.</p>\n\n<p>Would this be ideal not having to touch the \"await scheduler.Shutdown();\" part?</p>\n\n<p>Plans is to put it in IIS later.</p>\n\n<pre><code>using System;\nusing System.Threading.Tasks;\nusing Quartz;\nusing Quartz.Impl;\nusing Quartz.Logging;\n\nnamespace QuartzSampleApp\n{\n    public class Program\n    {\n        private static void Main(string[] args)\n        {\n            LogProvider.SetCurrentLogProvider(new ConsoleLogProvider());\n\n            RunProgramRunExample().GetAwaiter().GetResult();\n\n            Console.WriteLine(\"Press any key to close the application\");\n            Console.ReadKey();\n        }\n\n        private static async Task RunProgramRunExample()\n        {\n            try\n            {\n                // Grab the Scheduler instance from the Factory\n                NameValueCollection props = new NameValueCollection\n                {\n                    { \"quartz.serializer.type\", \"binary\" }\n                };\n                StdSchedulerFactory factory = new StdSchedulerFactory(props);\n                IScheduler scheduler = await factory.GetScheduler();\n\n                // and start it off\n                await scheduler.Start();\n\n                // define the job and tie it to our HelloJob class\n                IJobDetail job = JobBuilder.Create&lt;HelloJob&gt;()\n                    .WithIdentity(\"job1\", \"group1\")\n                    .Build();\n\n                // Trigger the job to run now, and then repeat every 10 seconds\n                ITrigger trigger = TriggerBuilder.Create()\n                    .WithIdentity(\"trigger1\", \"group1\")\n                    .StartNow()\n                    .WithSimpleSchedule(x =&gt; x\n                        .WithIntervalInSeconds(10)\n                        .RepeatForever())\n                    .Build();\n\n                // Tell quartz to schedule the job using our trigger\n                await scheduler.ScheduleJob(job, trigger);\n\n                // some sleep to show what's happening\n                await Task.Delay(TimeSpan.FromSeconds(60));\n\n                // and last shut down the scheduler when you are ready to close your program\n                await scheduler.Shutdown();\n            }\n            catch (SchedulerException se)\n            {\n                Console.WriteLine(se);\n            }\n        }\n\n        ..........\n}\n</code></pre>\n\n<p>I am not sure of any other options. Other options will be calling Start() again after shutdown() part. But how to do that?</p>\n"}, {"tags": ["c#", "mysql", "database", "datetime", "date-format"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 2, "creation_date": 1564006939, "post_id": 57191830, "comment_id": 100893423, "body": "` a column of Date named as varchar` Dates are not strings and dates <i>only</i> have a format when stored as strings.  Dont do that - store date data as Date."}, {"owner": {"reputation": 25340, "user_id": 3181933, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/eQpds.jpg?s=128&g=1", "display_name": "Llama", "link": "https://stackoverflow.com/users/3181933/llama"}, "edited": false, "score": 1, "creation_date": 1564008327, "post_id": 57191830, "comment_id": 100893775, "body": "Use parameterized SQL queries, as you&#39;re supposed to."}, {"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 0, "creation_date": 1564065185, "post_id": 57191830, "comment_id": 100916024, "body": "Also: <code>ToShortDateString()</code> is non-deterministic. The format is system-dependent, where you can see different formats from one machine to the next. Someone could configure it to not even include real data at all, or you could end up with a mix of formats that result in ambiguity. Mix a UK citizen and US citizen talking to the same DB, and suddenly 2/3/2019 could represent both Feb 3 or Mar 2. You <i>really</i> should be storing this data in a DateTime column. <i>If you ever find yourself converting an .Net DateTime variable to a string for use in SQL, you&#39;re doing something <b>very</b> wrong.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "is_accepted": false, "score": 0, "last_activity_date": 1564066364, "last_edit_date": 1564066364, "creation_date": 1564066027, "answer_id": 57204751, "question_id": 57191830, "link": "https://stackoverflow.com/questions/57191830/how-to-store-and-compare-dates-in-a-sql-database/57204751#57204751", "title": "How to store and compare dates in a SQL database", "body": "<p>There are several things here we need to address. </p>\n\n<p>First up is an easy one. <code>BETWEEN</code> is probably not the best option to use for ranged reports, since it is inclusive of values at both edges of the range. You end update double counting anything that happens at exactly midnight. Better to structure the query like this:</p>\n\n<pre><code>select * from sale where date &gt;= '\"+textbox1.text+\"' and date &lt; '\"+textbox2+\"'\n</code></pre>\n\n<p>This gives us an exclusive upper bound on the date range. Sometimes, users expect the inclusive upper bound on a date range query, but even in these cases that will coincide with also expect the upper bound to include the <em>full day</em>. So a user will enter something like <code>7/25/2019</code> and want to get all of today's data. But on the datebase side, there is an implied time of midnight at the beginning of the day, and you still miss out. So what you do is <em>add a day</em> to the input, and <em>still use the exclusive upper bound</em>. </p>\n\n<p>Moving on. You <em>REALLY</em> should be storing this data in a <code>DateTime</code> column. It's not okay at all put Date data into varchar columns! Additionally, <em>if you ever find yourself converting an .Net DateTime variable to a string for use in SQL, you're doing something <strong>very</strong> wrong.</em></p>\n\n<p>The <code>ToShortDateString()</code> method here is especially bad, because it's non-deterministic. The format is system-dependent, where you can see different formats from one machine to the next. Someone could configure it to not even include real data at all. More likely you eventually end up with a mix of formats that result in ambiguity. Mix a UK citizen and US citizen talking to the same DB, and suddenly <code>2/3/2019</code> could represent both <code>Feb 3</code> or <code>Mar 2</code>, depending on who entered the data. That's just one example of many.</p>\n\n<p>Even worse is the string concatenation in the query. A user could put <em>anything</em> there. For example: <code>';DROP TABLE sale; --</code>. Think carefully about what would happen with that value in your textbox. You might never see anything this bad, but there are plenty of ways real users will break that field purely by accident. </p>\n\n<p>It may be tempting now to try to sanitize these textbox inputs, but that is not answer. Sanitizing inputs only takes you so far, and puts you into a game of cat and mouse or whac-a-mole with your users/attackers. The better option is to <strong>quarantine</strong> your inputs. You do this using parameterized queries. </p>\n\n<p>Correctly parameterized code for the SELECT might look like this:</p>\n\n<pre><code>string sql = \"select * from sale where date &gt;= @startdate and date &lt; @enddate;\";\nusing (var cn = new MySqlConnection(\"connection string here\"))\nusing (var cmd = new MySqlCommand(sql, cn))\n{\n    cmd.Parameters.Add(\"@startdate\", MySqlDbType.DateTime).Value = DateTime.Parse(TextBox1.Text); \n    cmd.Parameters.Add(\"@enddate\", MySqlDbType.DateTime).Value = DateTime.Parse(TextBox2.Text);\n\n    cn.Open();\n    // Fill() a dataset or cmd.ExecuteReader() here\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11832941, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gf0otW-Uuc8/AAAAAAAAAAI/AAAAAAAAAAw/O0xgJdCo_N4/photo.jpg?sz=128", "display_name": "Malik atif", "link": "https://stackoverflow.com/users/11832941/malik-atif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564066364, "creation_date": 1564005842, "last_edit_date": 1564064942, "question_id": 57191830, "link": "https://stackoverflow.com/questions/57191830/how-to-store-and-compare-dates-in-a-sql-database", "title": "How to store and compare dates in a SQL database", "body": "<p>I am working on a Windows Forms C# project. I have a sale table in a MySQL database and this table has a column of <code>Date</code> named <code>varchar</code>. When I pass  a current date as a string from <code>sale.cs</code> C# it gets stored correctly.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>string a = datetime.now.date.toshortdatestring();\n</code></pre>\n\n<p>But when I try to apply MySQL between query on sale it doesn't work properly as only the day is compared with day..month and year is not compared.</p>\n\n<p>This is my query:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select * from sale where date between '\"+textbox1.text+\"' and '\"+textbox2+\"'\n</code></pre>\n\n<p>I want to save the current date at the time of sale and I want to get a report of from one date to other date. What is the column type in xamp <code>Date</code> , <code>varchar</code> or <code>datetime</code> and how can I save the current time as <code>datetime</code> or <code>string</code>? How do I get the report from one date to other also comparing the month and year?</p>\n"}, {"tags": ["c#", "image"], "comments": [{"owner": {"reputation": 304, "user_id": 929834, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BJgT4.png?s=128&g=1", "display_name": "Seige", "link": "https://stackoverflow.com/users/929834/seige"}, "edited": false, "score": 0, "creation_date": 1564006520, "post_id": 57191805, "comment_id": 100893318, "body": "Assuming you want a byte[] for the database. I cant remember the save methods off the top of my head for BitmapImage, You could save the file to disk as a PNG, read that file as a byte[], then immediately delete the hard image."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1564008014, "post_id": 57191805, "comment_id": 100893720, "body": "You should mention what kind of Database you&#39;re referring to. There are quite different options and outcomes when treating a binary for storage, depending on the database technology."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8549611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eeed8e747ba66f5bf928d28b4f6de4?s=128&d=identicon&r=PG&f=1", "display_name": "SWDeveloper", "link": "https://stackoverflow.com/users/8549611/swdeveloper"}, "edited": false, "score": 0, "creation_date": 1564009097, "post_id": 57192118, "comment_id": 100893920, "body": "Thank you for your response. I currently read the touch screen for the signature and save the image as bitmap in my code and save it in database as byteArray[]. Will it take less memory to save as a png byteArray rather than bitmap byteArray[] ? if so, I want to convert bitmap image to png image in the code and then save it in the database. I do not want to save the image in disk."}, {"owner": {"reputation": 18262, "user_id": 97754, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/49d678618a22b1ae47b4395554eea6a9?s=128&d=identicon&r=PG", "display_name": "Margus", "link": "https://stackoverflow.com/users/97754/margus"}, "reply_to_user": {"reputation": 115, "user_id": 8549611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eeed8e747ba66f5bf928d28b4f6de4?s=128&d=identicon&r=PG&f=1", "display_name": "SWDeveloper", "link": "https://stackoverflow.com/users/8549611/swdeveloper"}, "edited": false, "score": 0, "creation_date": 1564037917, "post_id": 57192118, "comment_id": 100900602, "body": "BMP is both uncompressed and lossless and PNG is compressed but lossless - yes, it will take less space. Instead of saving the PNG to a file I showed how to store it in a stream, convert it to byte array and store it in database. Instead of passing BMP file name and reading it from the disk you can just pass the BMP class object."}, {"owner": {"reputation": 18262, "user_id": 97754, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/49d678618a22b1ae47b4395554eea6a9?s=128&d=identicon&r=PG", "display_name": "Margus", "link": "https://stackoverflow.com/users/97754/margus"}, "reply_to_user": {"reputation": 115, "user_id": 8549611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eeed8e747ba66f5bf928d28b4f6de4?s=128&d=identicon&r=PG&f=1", "display_name": "SWDeveloper", "link": "https://stackoverflow.com/users/8549611/swdeveloper"}, "edited": false, "score": 0, "creation_date": 1564038464, "post_id": 57192118, "comment_id": 100900851, "body": "Additionally, I should point out that stackoverflow questions should show some effort - what have you tried, why did it fail, set constraints like database schema and ex: ORM/database you are using. My goal is not to give you a working solution, but help you where you are stuck."}], "tags": [], "owner": {"reputation": 18262, "user_id": 97754, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/49d678618a22b1ae47b4395554eea6a9?s=128&d=identicon&r=PG", "display_name": "Margus", "link": "https://stackoverflow.com/users/97754/margus"}, "is_accepted": false, "score": 0, "last_activity_date": 1564007880, "creation_date": 1564007880, "answer_id": 57192118, "question_id": 57191805, "link": "https://stackoverflow.com/questions/57191805/convert-bitmap-to-png-image-and-save-in-database/57192118#57192118", "title": "Convert bitmap to png image and save in database", "body": "<p>To get png byte array from png source </p>\n\n<pre><code>public byte[] GetPng(string filename)\n{\n    using (var bitmap = new Bitmap(filename))\n    using (var stream = new MemoryStream())\n    {\n        bitmap.Save(stream, ImageFormat.Png);\n        return stream.ToArray();\n    }\n}\n</code></pre>\n\n<p>With Dapper ORM  </p>\n\n<pre><code>var sql = \"INSERT INTO [dbo].[Images]([FullName], [Data]) VALUES (@FullName, @Data)\";\nvar result = db.Execute(sql, new\n{\n    FullName = filename,\n    Data = GetPng(filename)\n});\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8549611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1eeed8e747ba66f5bf928d28b4f6de4?s=128&d=identicon&r=PG&f=1", "display_name": "SWDeveloper", "link": "https://stackoverflow.com/users/8549611/swdeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564007880, "creation_date": 1564005705, "question_id": 57191805, "link": "https://stackoverflow.com/questions/57191805/convert-bitmap-to-png-image-and-save-in-database", "title": "Convert bitmap to png image and save in database", "body": "<p>I have a bitmap image. I want to compress it into a png image so that it will consume less memory while saving it in database.</p>\n\n<p>During my research, I get lot of options to save it as a file in hard disk. I want to return the png image from a method.</p>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 2110, "user_id": 3666741, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/3o38Y.jpg?s=128&g=1", "display_name": "cSteusloff", "link": "https://stackoverflow.com/users/3666741/csteusloff"}, "edited": false, "score": 0, "creation_date": 1564005810, "post_id": 57191736, "comment_id": 100893125, "body": "Sorry, SO doesn&#39;t solve homework tasks."}, {"owner": {"reputation": 304, "user_id": 929834, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BJgT4.png?s=128&g=1", "display_name": "Seige", "link": "https://stackoverflow.com/users/929834/seige"}, "edited": false, "score": 0, "creation_date": 1564005937, "post_id": 57191736, "comment_id": 100893153, "body": "A barcode is a series of numbers that normally is a ID to the real information. It in itself doesn&#39;t hold any real info, especially not 4 lots of data strings that could be lengthy. You might want to look more into QR Codes or something similar. There are lots of generators online you could probably API into, save as a image to insert into your PDF."}, {"owner": {"reputation": 9, "user_id": 11359510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f3892fceb2e544e9a561bbb73f82b2?s=128&d=identicon&r=PG&f=1", "display_name": "EngineerStudent", "link": "https://stackoverflow.com/users/11359510/engineerstudent"}, "edited": false, "score": 0, "creation_date": 1564005990, "post_id": 57191736, "comment_id": 100893163, "body": "Hello.I&#39;m sorry.Not homework.I am developing a library project to improve myself.So I want to learn how to do it, not a general code."}, {"owner": {"reputation": 9, "user_id": 11359510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f3892fceb2e544e9a561bbb73f82b2?s=128&d=identicon&r=PG&f=1", "display_name": "EngineerStudent", "link": "https://stackoverflow.com/users/11359510/engineerstudent"}, "reply_to_user": {"reputation": 304, "user_id": 929834, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BJgT4.png?s=128&g=1", "display_name": "Seige", "link": "https://stackoverflow.com/users/929834/seige"}, "edited": false, "score": 0, "creation_date": 1564006077, "post_id": 57191736, "comment_id": 100893192, "body": "@Seige Thank you for the information you provided"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5683877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd4b64ab4118c40a83ce7ecb55d50a8?s=128&d=identicon&r=PG&f=1", "display_name": "sayaladev", "link": "https://stackoverflow.com/users/5683877/sayaladev"}, "is_accepted": false, "score": 0, "last_activity_date": 1564008068, "creation_date": 1564008068, "answer_id": 57192142, "question_id": 57191736, "link": "https://stackoverflow.com/questions/57191736/how-can-i-make-a-barcode-pdf-generate-in-c/57192142#57192142", "title": "How can I make a barcode pdf generate in c#?", "body": "<p>Pdf417 is very easy...\n<a href=\"https://www.nuget.org/packages/Pdf417EncoderLibrary/\" rel=\"nofollow noreferrer\">https://www.nuget.org/packages/Pdf417EncoderLibrary/</a></p>\n\n<p>then pdf with \n<a href=\"https://selectpdf.com/pdf-library-for-net/\" rel=\"nofollow noreferrer\">https://selectpdf.com/pdf-library-for-net/</a></p>\n"}], "owner": {"reputation": 9, "user_id": 11359510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5f3892fceb2e544e9a561bbb73f82b2?s=128&d=identicon&r=PG&f=1", "display_name": "EngineerStudent", "link": "https://stackoverflow.com/users/11359510/engineerstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564009810, "creation_date": 1564005211, "last_edit_date": 1564009810, "question_id": 57191736, "link": "https://stackoverflow.com/questions/57191736/how-can-i-make-a-barcode-pdf-generate-in-c", "title": "How can I make a barcode pdf generate in c#?", "body": "<p>I want to generate barcode and this barcode I want to keep some values(author,bookname,pagenumber,author).Because \nWhen the barcode is read you want the author,bookname,page number and book shelf number to come up to see those values.\nSo when creating, I want it to be created with 3 values.</p>\n\n<p><strong>When I press the Create button when I enter a value in the textbox, I can create a barcode.\nBut my problem is this. There is a database table (table name: books) in 10 books.\nTo print the barcode of the author, bookname, pagenumber, author fields in this table with 10 records.\nI want to pull the data and write it into qr code.</strong></p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n        {\n\n            using (SaveFileDialog sfd = new SaveFileDialog() {Filter = \"JPEG|*.jpg\", ValidateNames = true})\n            {\n                if (sfd.ShowDialog() == DialogResult.OK)\n                {\n                    MessagingToolkit.QRCode.Codec.QRCodeEncoder encoder=new QRCodeEncoder();\n                    encoder.QRCodeScale = 8;\n                    Bitmap bmp = encoder.Encode(textBox1.Text);\n                    pictureBox1.Image = bmp;\n                    bmp.Save(sfd.FileName,ImageFormat.Jpeg);\n                }\n            }\n    }\n</code></pre>\n"}, {"tags": ["c#", "winforms", "async-await"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 2, "creation_date": 1564005835, "post_id": 57191627, "comment_id": 100893130, "body": "<i>I need to open another form in another thread</i> Why do you believe you need to do this? That is generally a really bad idea. There is one and only one UI thread."}, {"owner": {"reputation": 849, "user_id": 10675707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2RPXD.png?s=128&g=1", "display_name": "Cursed", "link": "https://stackoverflow.com/users/10675707/cursed"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1564044288, "post_id": 57191627, "comment_id": 100904085, "body": "Because there is to much data on db and i need to load it all and if dont do a waiting form it will break the program and it will not respond for some time."}], "answers": [{"tags": [], "owner": {"reputation": 11114, "user_id": 402366, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/43074670e3a479a1d3ae5242ce00819e?s=128&d=identicon&r=PG", "display_name": "Paulo Morgado", "link": "https://stackoverflow.com/users/402366/paulo-morgado"}, "is_accepted": true, "score": 1, "last_activity_date": 1564050654, "creation_date": 1564050654, "answer_id": 57199858, "question_id": 57191627, "link": "https://stackoverflow.com/questions/57191627/updating-main-ui-after-all-loaded/57199858#57199858", "title": "Updating main ui after all loaded", "body": "<p>You should avoid mixing UI and non-UI code.</p>\n\n<p>Try this:</p>\n\n<pre><code>private async void Disp_data_Sim()\n{\n    var windowToOpen = new WaitingWorker()\n    {\n        Owner = this,\n    };\n\n        try\n        {\n            windowToOpen.ShowDialog();\n\n            dataGridView1.DataSource = await GetDataAsync();\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.ToString());\n        }\n\n        windowToOpen.Close();\n}\n\nprivate async Task&lt;DataTable&gt; GetDataAsync()\n{\n    var tempCon = File.ReadAllText(\"DBConnection.json\");\n    var tempCon1 = Crypt.Decrypt(tempCon, \"encryption\");\n    var sqlInfo = new JavaScriptSerializer().Deserialize&lt;SQLInfo&gt;(tempCon1);\n    using (SqlConnection con = new SqlConnection(sqlInfo.GetConString()))\n    {\n        using (SqlCommand cmd = con.CreateCommand())\n        {\n            cmd.CommandText = \"SELECT referencia,descricao,pr_custo1,etiqueta,qtd FROM Etiquetas Where etiqueta = @etiqueta\";\n            cmd.Parameters.AddWithValue(\"@etiqueta\", 'S');\n            using (SqlDataAdapter da = new SqlDataAdapter(cmd))\n            {\n                DataTable dtbl = new DataTable();\n                await con.OpenAsync();\n                await Task.Yield(); // just to make sure it yields back to the caller.\n                da.Fill(dtbl);\n                return dtbl;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Unfortunately, the <code>SqlDataAdapter</code> does not have an asynchronous API. You could make this better by using a <code>SqlDataReader</code> and filling the table yourself.</p>\n"}], "owner": {"reputation": 849, "user_id": 10675707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2RPXD.png?s=128&g=1", "display_name": "Cursed", "link": "https://stackoverflow.com/users/10675707/cursed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 57199858, "answer_count": 1, "score": 0, "last_activity_date": 1564050654, "creation_date": 1564004495, "last_edit_date": 1564006575, "question_id": 57191627, "link": "https://stackoverflow.com/questions/57191627/updating-main-ui-after-all-loaded", "title": "Updating main ui after all loaded", "body": "<p>The problem is as follows, it executes another form but uses the primary so the program becomes \"unavailable\".</p>\n\n<p>I tried with backgroundworker but after found out this method and switched.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code> private async void Disp_data_Sim()\n        {\n            var windowToOpen = new WaitingWorker()\n            {\n                Owner = this,\n            };\n\n            await Task.Run(new Action(() =&gt;\n            {\n                this.BeginInvoke((MethodInvoker)delegate\n                {\n\n                    windowToOpen.ShowDialog();\n                });\n                try\n                {\n                    var tempCon = File.ReadAllText(\"DBConnection.json\");\n                    var tempCon1 = Crypt.Decrypt(tempCon, \"encryption\");\n                    var sqlInfo = new JavaScriptSerializer().Deserialize&lt;SQLInfo&gt;(tempCon1);\n                    using (SqlConnection con = new SqlConnection(sqlInfo.GetConString()))\n                    {\n                        con.Open();\n                        using (SqlCommand cmd = con.CreateCommand())\n                        {\n                            cmd.CommandText = \"SELECT referencia,descricao,pr_custo1,etiqueta,qtd FROM Etiquetas Where etiqueta = @etiqueta\";\n                            cmd.Parameters.AddWithValue(\"@etiqueta\", 'S');\n                            DataTable dtbl = new DataTable();\n                            SqlDataAdapter da = new SqlDataAdapter(cmd);\n                            da.Fill(dtbl);\n\n                            dataGridView1.Invoke(new Action(() =&gt; dataGridView1.DataSource = dtbl));\n                        }\n                        con.Close();\n\n                    }\n\n                }\n                catch (Exception ex)\n                {\n                    MessageBox.Show(ex.ToString());\n                }\n                this.Invoke((MethodInvoker)delegate\n                {\n\n                    windowToOpen.Close();\n                });\n            }));\n        }\n</code></pre>\n\n<p>What I am trying to do is, I need to open another form in another thread where there is a progress bar that is indeterminated, and in main ui I need to update the datagrid with the bd data after the load is gone.</p>\n"}, {"tags": ["c#", "unity3d", "reflection", "feed"], "answers": [{"tags": [], "owner": {"reputation": 573, "user_id": 4111662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c55ff04a93f9f899e7f66afd02a65e90?s=128&d=identicon&r=PG&f=1", "display_name": "gitbox", "link": "https://stackoverflow.com/users/4111662/gitbox"}, "is_accepted": false, "score": 0, "last_activity_date": 1564008219, "creation_date": 1564008219, "answer_id": 57192160, "question_id": 57191575, "link": "https://stackoverflow.com/questions/57191575/how-to-call-projectwide-properties-using-reflection/57192160#57192160", "title": "How to call projectwide properties using Reflection?", "body": "<p>You might use <a href=\"https://github.com/dotnet/roslyn/wiki/Scripting-API-Samples\" rel=\"nofollow noreferrer\">Roslyn's scripting APIs</a>.</p>\n\n<p><a href=\"https://www.strathweb.com/2018/01/easy-way-to-create-a-c-lambda-expression-from-a-string-with-roslyn/\" rel=\"nofollow noreferrer\">Here's a good article</a> where they do exactly what you want.</p>\n"}], "owner": {"reputation": 157, "user_id": 4859057, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a05911ff16be04e9937115c5237a3a84?s=128&d=identicon&r=PG&f=1", "display_name": "Mc Midas", "link": "https://stackoverflow.com/users/4859057/mc-midas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594037026, "creation_date": 1564004127, "last_edit_date": 1594037026, "question_id": 57191575, "link": "https://stackoverflow.com/questions/57191575/how-to-call-projectwide-properties-using-reflection", "title": "How to call projectwide properties using Reflection?", "body": "<p>I am building a newsfeed system for a game, and I have a file which contains various string messages that the system reads in to show them on screen.</p>\n<p>Strings like that are not the problem: &quot;Welcome to Trash Island&quot;</p>\n<p>But I would like to add some dynamic text that includes some specific variables from classes or non-void functions that return their result to the defined position of the message:</p>\n<p>Example: &quot;Time: [SHOW CURRENT TIME]&quot; should give &quot;Time: 10:23pm&quot;</p>\n<p>I think it could be good enough to use tags that mark the code.\nTo implement the format of the example above I have come up with this:</p>\n<blockquote>\n<p>&quot;Time: &lt; code=UIManager.ToTime(DayManager.instance.dayTime)/&gt;&quot;</p>\n<p>//Note: daytime is a float value and ToTime returns a time formatted string</p>\n</blockquote>\n<p>This is my approach, but of course not working:</p>\n<pre><code>string msg = messages [_index];\nstring prefix = &quot;&quot;;\nstring subfix = &quot;&quot;;\nstring code = &quot;&quot;;\nif (msg.Contains (&quot;&lt;code=&quot;)) {\n    int start = msg.IndexOf (&quot;&lt;code=&quot;)\n    prefix = msg.Substring (0, start);\n    start += 6;\n    end = msg.IndexOf (&quot;/&gt;&quot;);\n    code = msg.Substring (start, end - start);\n    suffix = msg.Substring (end+2, msg.Length-1);\n    Debug.Log (&quot;Function found: &quot; + code);\n    string codeReturnValue = //DO MAGIC REFLECTION WITH &quot;code&quot; \n    text_message.text = prefix + codeReturnValue + subfix;\n} else { \n    text_message.text = msg;\n}\n</code></pre>\n<p>But how would I turn &quot;code&quot; to an actual call using reflection?</p>\n<p>I think this is not possible, but how would I manage something like this without having to create tons of hard coded functions and instead gather all information based of the message-string?</p>\n"}, {"tags": ["c#", ".net", "wpf", "local-network"], "comments": [{"owner": {"reputation": 108835, "user_id": 15541, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/515ca9736a9a8ce65e58af764ccddf46?s=128&d=identicon&r=PG", "display_name": "leppie", "link": "https://stackoverflow.com/users/15541/leppie"}, "edited": false, "score": 0, "creation_date": 1564004275, "post_id": 57191522, "comment_id": 100892718, "body": "This is a known problem. It only happens when you have the debugger attached IIRC. Edit: I cant find the link since connect was shutdown..."}, {"owner": {"reputation": 109, "user_id": 9059059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WPH51.jpg?s=128&g=1", "display_name": "kakashi senpai", "link": "https://stackoverflow.com/users/9059059/kakashi-senpai"}, "reply_to_user": {"reputation": 108835, "user_id": 15541, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/515ca9736a9a8ce65e58af764ccddf46?s=128&d=identicon&r=PG", "display_name": "leppie", "link": "https://stackoverflow.com/users/15541/leppie"}, "edited": false, "score": 0, "creation_date": 1564005005, "post_id": 57191522, "comment_id": 100892911, "body": "@leppie ah so is there is any alternative way ? i just want to provide list of Available ip addresses in local network , ill delivering this project tomorrow so any possible help even if its dirty i appreciate it x) welppppp"}], "owner": {"reputation": 109, "user_id": 9059059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WPH51.jpg?s=128&g=1", "display_name": "kakashi senpai", "link": "https://stackoverflow.com/users/9059059/kakashi-senpai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "closed_date": 1564004503, "answer_count": 0, "score": 0, "last_activity_date": 1564003834, "creation_date": 1564003834, "question_id": 57191522, "link": "https://stackoverflow.com/questions/57191522/using-networkinformation-ping-in-for-loop-somehow-freeze-my-computer-and-causing", "closed_reason": "Duplicate", "title": "using Networkinformation.Ping in for loop somehow freeze my computer and causing blue screen of death c#", "body": "<p>in weird way , what ever i use this function below</p>\n\n<p>my application freeze and take long time before throwing <strong>blue screen of death</strong></p>\n\n<pre><code>public void getLocalNetworkIpList()\n{\n   Ping p = new Ping();\n   PingReply rep;\n\n    for (int i = 1; i &lt; 100; i++)\n    {\n      string ipstring = \"192.168.1.\" + i.ToString();\n      rep = p.Send(ipstring);\n\n      if (rep.Status == IPStatus.Success)\n      Local_IpAdresses_combobox.Items.Add(ipstring);\n\n      }\n}\n</code></pre>\n\n<p>this function is only to provide a list of the ip addresses available in my local network , start from 192.168.1.1 and end with 192.168.1.100  </p>\n\n<p>im really confused because it look like a simple loop with some ip address checking and pushing in the combobox</p>\n"}, {"tags": ["c#", "asp.net-mvc-5", "json.net"], "comments": [{"owner": {"reputation": 5935, "user_id": 2038271, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c97eeb430e344e58a2df1ab6a2b5a4c7?s=128&d=identicon&r=PG", "display_name": "SamJolly", "link": "https://stackoverflow.com/users/2038271/samjolly"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1564006495, "post_id": 57191505, "comment_id": 100893307, "body": "I want to remove all properties called &quot;name&quot; which have a text value as opposed to the other version that has a complex type of type &quot;name&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 5935, "user_id": 2038271, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c97eeb430e344e58a2df1ab6a2b5a4c7?s=128&d=identicon&r=PG", "display_name": "SamJolly", "link": "https://stackoverflow.com/users/2038271/samjolly"}, "edited": false, "score": 0, "creation_date": 1564006932, "post_id": 57191951, "comment_id": 100893421, "body": "I have added a more complete example if this affects your answer in any way. Thanks for the comprehensive reply, actually amazing reply..... :)"}, {"owner": {"reputation": 5935, "user_id": 2038271, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c97eeb430e344e58a2df1ab6a2b5a4c7?s=128&d=identicon&r=PG", "display_name": "SamJolly", "link": "https://stackoverflow.com/users/2038271/samjolly"}, "edited": false, "score": 0, "creation_date": 1564007448, "post_id": 57191951, "comment_id": 100893570, "body": "To be more specific, can I alter the path to &quot;SelectTokens(&quot;items.name&quot;) ?"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "reply_to_user": {"reputation": 5935, "user_id": 2038271, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c97eeb430e344e58a2df1ab6a2b5a4c7?s=128&d=identicon&r=PG", "display_name": "SamJolly", "link": "https://stackoverflow.com/users/2038271/samjolly"}, "edited": false, "score": 1, "creation_date": 1564007628, "post_id": 57191951, "comment_id": 100893628, "body": "No, because the value of <code>items</code> is an array.  You need to use <code>&quot;items[*].name&quot;</code> to pick out all array values.  Demo fiddle #2 here: <a href=\"https://dotnetfiddle.net/OMwt4R\" rel=\"nofollow noreferrer\">dotnetfiddle.net/OMwt4R</a>"}], "tags": [], "owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "is_accepted": true, "score": 2, "last_activity_date": 1564007785, "last_edit_date": 1564007785, "creation_date": 1564006618, "answer_id": 57191951, "question_id": 57191505, "link": "https://stackoverflow.com/questions/57191505/is-it-possible-to-remove-string-valued-json-nodes-from-a-jobject-variable/57191951#57191951", "title": "Is it possible to remove string-valued JSON nodes from a JObject variable?", "body": "<p>You can combine a <a href=\"https://goessner.net/articles/JsonPath/\" rel=\"nofollow noreferrer\">JSONPath</a> query to select the values of all relevant <code>\"name\"</code> nodes in your JSON hierarchy, then filter those for which <a href=\"https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_Linq_JToken_Type.htm\" rel=\"nofollow noreferrer\"><code>JToken.Type</code></a> is <a href=\"https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_Linq_JTokenType.htm\" rel=\"nofollow noreferrer\"><code>JTokenType.String</code></a>.  Then you can <a href=\"https://www.newtonsoft.com/json/help/html/M_Newtonsoft_Json_Linq_JToken_Remove.htm\" rel=\"nofollow noreferrer\">remove</a> them from their parent <code>JObject</code> by removing the containing <code>JProperty</code>.</p>\n\n<p>The following code does the job:</p>\n\n<pre><code>// Select the values of all relevant \"name\" nodes using a JSONPath query, \n// https://goessner.net/articles/JsonPath/\n// Then select only those whose which are of type string.\nvar query = jsonPerson\n    .SelectTokens(\"..name\")\n    .Where(t =&gt; t.Type == JTokenType.String);\n\nquery.ToList().ForEach(t =&gt; t.RemoveFromLowestPossibleParent());\n</code></pre>\n\n<p>Using the extension method:</p>\n\n<pre><code>public static partial class JsonExtensions\n{\n    public static JToken RemoveFromLowestPossibleParent(this JToken node)\n    {\n        if (node == null)\n            return null;\n        // If the parent is a JProperty, remove that instead of the token itself.\n        var contained = node.Parent is JProperty ? node.Parent : node;\n        contained.Remove();\n        // Also detach the node from its immediate containing property -- Remove() does not do this even though it seems like it should\n        if (contained is JProperty)\n            ((JProperty)node.Parent).Value = null;\n        return node;\n    }\n}\n</code></pre>\n\n<p>Demo fiddle <a href=\"https://dotnetfiddle.net/s6RThS\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Notes:</p>\n\n<ul>\n<li><p>I used the JSONPath recursive descent operator <code>..</code> to select the values of <em>all</em> properties named <code>name</code> anywhere in the JSON hierarchy.  Assuming your JSON has a fairly fixed schema you might want to simplify that to select the <code>name</code> nodes at their expected location in the hierarchy:</p>\n\n<pre><code>var query = jsonPerson\n    .SelectTokens(\"items[*].name\")\n    .Where(t =&gt; t.Type == JTokenType.String);\n</code></pre>\n\n<p>Where <code>*</code> is the wildcard operator selecting all array entries. Demo fiddle #2 <a href=\"https://dotnetfiddle.net/OMwt4R\" rel=\"nofollow noreferrer\">here</a>.</p></li>\n<li><p><a href=\"https://www.newtonsoft.com/json/help/html/Overload_Newtonsoft_Json_Linq_JToken_SelectTokens.htm\" rel=\"nofollow noreferrer\"><code>SelectTokens</code></a> returns the selected property <em>values</em>.  In order to remove those values from the hierarchy it is necessary to remove the containing <code>JProperty</code>.  The extension method <code>JsonExtensions.RemoveFromLowestPossibleParent()</code> does this.</p></li>\n</ul>\n"}], "owner": {"reputation": 5935, "user_id": 2038271, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/c97eeb430e344e58a2df1ab6a2b5a4c7?s=128&d=identicon&r=PG", "display_name": "SamJolly", "link": "https://stackoverflow.com/users/2038271/samjolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 57191951, "answer_count": 1, "score": 1, "last_activity_date": 1564007785, "creation_date": 1564003726, "last_edit_date": 1564007139, "question_id": 57191505, "link": "https://stackoverflow.com/questions/57191505/is-it-possible-to-remove-string-valued-json-nodes-from-a-jobject-variable", "title": "Is it possible to remove string-valued JSON nodes from a JObject variable?", "body": "<p>I am using .NET 4.7, MVC5, C# and JSON.NET</p>\n\n<p>I have a JObject variable called \"json\"</p>\n\n<pre><code>JObject jsonPerson = JObject.Parse(strPersonsDetails);\n</code></pre>\n\n<p>It contains nodes with same name, but different structure:</p>\n\n<pre><code>name : \"Joe Bloggs\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>name : {\n        firstname : \"Joe\",\n        lastname : \"Bloggs\"\n        }\n</code></pre>\n\n<p>I would like to remove any node that are of type string ie :</p>\n\n<pre><code>name : \"Joe Bloggs\"\n</code></pre>\n\n<p>and leave  :</p>\n\n<pre><code>name : {\n        firstname : \"Joe\",\n        lastname : \"Bloggs\"\n        }\n</code></pre>\n\n<p>which is of type \"name\"</p>\n\n<p>Is there any way to remove all properties called \"name\" which have a text value as opposed to the other version that has a complex type of type \"name\" from <code>jsonPerson</code>?</p>\n\n<p>EDIT:</p>\n\n<p>More complete JSON:</p>\n\n<pre><code>{\n\"items\": [\n         {\n         \"id\" : 1,\n         \"name\" : \"Joe Bloggs\"\n         },\n         {\n         \"id\" : 2,\n         \"name\" : {\n                  \"FirstName\" : \"Joe\",\n                  \"LastName\" : \"Bloggs\"\n                  }\n          }\n          ]\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", ".net-core", ".net-standard"], "comments": [{"owner": {"reputation": 355, "user_id": 10238974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HSld1.jpg?s=128&g=1", "display_name": "PWND", "link": "https://stackoverflow.com/users/10238974/pwnd"}, "edited": false, "score": 0, "creation_date": 1564052491, "post_id": 57191504, "comment_id": 100908727, "body": "Check that topic: <a href=\"https://github.com/dotnet/standard/issues/328\" rel=\"nofollow noreferrer\">github.com/dotnet/standard/issues/328</a> There is many flows to resolve your problem, and it depends on your project configuration."}, {"owner": {"reputation": 124, "user_id": 8339471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gUcEqg3fcEc/AAAAAAAAAAI/AAAAAAAAABE/PycZjzEc0EI/photo.jpg?sz=128", "display_name": "Sergio Cabrera Gari", "link": "https://stackoverflow.com/users/8339471/sergio-cabrera-gari"}, "reply_to_user": {"reputation": 355, "user_id": 10238974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HSld1.jpg?s=128&g=1", "display_name": "PWND", "link": "https://stackoverflow.com/users/10238974/pwnd"}, "edited": false, "score": 0, "creation_date": 1564059007, "post_id": 57191504, "comment_id": 100912241, "body": "Will check that source, thank you"}], "owner": {"reputation": 124, "user_id": 8339471, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gUcEqg3fcEc/AAAAAAAAAAI/AAAAAAAAABE/PycZjzEc0EI/photo.jpg?sz=128", "display_name": "Sergio Cabrera Gari", "link": "https://stackoverflow.com/users/8339471/sergio-cabrera-gari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564003723, "creation_date": 1564003723, "question_id": 57191504, "link": "https://stackoverflow.com/questions/57191504/publishing-in-iis-application-with-netstandard-reference", "title": "Publishing in IIS application with .netstandard reference", "body": "<p>I have a web api application that has been working fine for a year. \nThe project has one layer that has the DB access and other with all entities used all across.\nI have added some new entities for a new project that I'm doing now, that new project is with .netCore 2.2, I have been using some data annotations on the classes and that adds .netstandard as a reference on my project.</p>\n\n<p>Now when I publish my WebApi application it doesn't run in IIS. it works locally perfect but in IIS I receive this error.</p>\n\n<blockquote>\n  <p>Could not load file or assembly 'netstandard, Version=2.0.0.0,\n  Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51' </p>\n</blockquote>\n\n<p>I have checked and the reference to .netstandard is there in the project.</p>\n\n<p>It might be something simple, I'm new in .netcore.\nThank you, </p>\n"}, {"tags": ["c#", "asp.net", "asp.net-core", "razor"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11832669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c69e70f0d5b8db3a74c4a04d6fde3b?s=128&d=identicon&r=PG&f=1", "display_name": "ljk401", "link": "https://stackoverflow.com/users/11832669/ljk401"}, "edited": false, "score": 0, "creation_date": 1564010282, "post_id": 57191493, "comment_id": 100894140, "body": "Thanks I tried your suggestion and it seemed very correct, however I am getting a new error that I have encounter before.  Error\tCS0104\t&#39;JsonResult&#39; is an ambiguous reference between &#39;Microsoft.AspNetCore.Mvc.JsonResult&#39; and &#39;System.Web.Mvc.JsonResult&#39;"}, {"owner": {"reputation": 3, "user_id": 11832669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c69e70f0d5b8db3a74c4a04d6fde3b?s=128&d=identicon&r=PG&f=1", "display_name": "ljk401", "link": "https://stackoverflow.com/users/11832669/ljk401"}, "edited": false, "score": 0, "creation_date": 1564011333, "post_id": 57191493, "comment_id": 100894310, "body": "I re-pasted your code everything worked except JsonRequestBehavior.AllowGet parameter. There I get a The name &#39;JsonRequestBehavior&#39; does not exist. Still seems like I am missing a using statement. Like I said in my previous comment I put those in and still came up with errors."}, {"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "reply_to_user": {"reputation": 3, "user_id": 11832669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c69e70f0d5b8db3a74c4a04d6fde3b?s=128&d=identicon&r=PG&f=1", "display_name": "ljk401", "link": "https://stackoverflow.com/users/11832669/ljk401"}, "edited": false, "score": 0, "creation_date": 1564015203, "post_id": 57191493, "comment_id": 100894955, "body": "@ljk401 I crossed my wires a bit between asp.net and asp.net core. I&#39;ve edited in a solution for core."}, {"owner": {"reputation": 3, "user_id": 11832669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c69e70f0d5b8db3a74c4a04d6fde3b?s=128&d=identicon&r=PG&f=1", "display_name": "ljk401", "link": "https://stackoverflow.com/users/11832669/ljk401"}, "edited": false, "score": 0, "creation_date": 1564021819, "post_id": 57191493, "comment_id": 100896047, "body": "It Worked, No Problem,Now I have to figure the rest out :)  Thanks so much, Been out of the programming game for about 5 years. Had my 4th Open Heart and it didn&#39;t go as planned. So, I am starting over. Used to be a VB.NET and asp classic legacy programmer. I like C# and Core. It&#39;s just very different.  Again Thanks"}], "tags": [], "owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "is_accepted": true, "score": 3, "last_activity_date": 1564029707, "last_edit_date": 1564029707, "creation_date": 1564003663, "answer_id": 57191493, "question_id": 57191389, "link": "https://stackoverflow.com/questions/57191389/i-can-not-convert-result-of-an-actionresult-method-to-jsonresult-in-the-return-l/57191493#57191493", "title": "I can not convert result of an ActionResult Method to JsonResult in the return line. I get an error in Visual Studio 2019", "body": "<p>Unlike some of the other helper methods on a controller for returning ActionResults like <code>Ok</code> or <code>NotFound</code>, <code>JsonResult</code> is a type and not a method. You need to create a new <code>JsonResult</code> to return it, like so:</p>\n\n<pre><code>return new JsonResult(searchResult);\n</code></pre>\n\n<p>We omit the <code>JsonRequestBehavior</code> in asp.net core, as it's been deprecated. You can choose to pass in custom serializer settings here.</p>\n\n<p>You should also be able to call the controller's <code>Json</code> method as well.</p>\n\n<pre><code>return Json(searchResult);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11832669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23c69e70f0d5b8db3a74c4a04d6fde3b?s=128&d=identicon&r=PG&f=1", "display_name": "ljk401", "link": "https://stackoverflow.com/users/11832669/ljk401"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1023, "favorite_count": 0, "accepted_answer_id": 57191493, "answer_count": 1, "score": 0, "last_activity_date": 1564029707, "creation_date": 1564003099, "last_edit_date": 1564024840, "question_id": 57191389, "link": "https://stackoverflow.com/questions/57191389/i-can-not-convert-result-of-an-actionresult-method-to-jsonresult-in-the-return-l", "title": "I can not convert result of an ActionResult Method to JsonResult in the return line. I get an error in Visual Studio 2019", "body": "<p>I am new to C#, ASP.NET Core, and LINQ. I have been working on an action method to be used with an autocomplete. I am just working on the Razor page C#. I can not replicate many different examples of code returning the <code>ActionResult</code> to JSON:</p>\n\n<pre><code>public ActionResult SwordSearch(string term)\n{ \n    var searchResult = _context.SMReferenceDB\n                               .Where(Swordmakers =&gt; Swordmakers.LastName.Contains(term))\n                               .Select(Swordmakers =&gt; Swordmakers.LastName)\n                               .ToList();\n\n    return JsonResult(searchResult, JsonRequestBehavior.AllowGet);\n}\n</code></pre>\n\n<p>In Visual Studio, I get this error at <code>JsonResult</code>:</p>\n\n<blockquote>\n  <p>Error CS 1955 Non-invocable member 'JsonResult' cannot be used like a method.</p>\n</blockquote>\n\n<p>I have tried everything I can, I went to many examples of autocomplete for Razor and MVC and they all use the <code>JsonResult</code> or JSON. I have all the references and NuGet packages.  This seemed like a normal way of making sure your result would be return in a JSON format.</p>\n\n<p>I can't build the solution because of this error, I have also copied and pasted examples of code and get the same red underline error in VS.  Thank You for your help. I am perplexed, been working on this one line for hours.</p>\n"}, {"tags": ["c#", "asp.net", "listview"], "comments": [{"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1564005317, "post_id": 57191333, "comment_id": 100893001, "body": "GridViews do support insert. Generally, if you need a validator in a GridView, you can add one into a <code>template field</code>. Search for converting a bound field to a template field."}, {"owner": {"reputation": 55, "user_id": 9036070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5cca9b441ceedcbdb7535fe97d83d5?s=128&d=identicon&r=PG&f=1", "display_name": "Billson3000", "link": "https://stackoverflow.com/users/9036070/billson3000"}, "reply_to_user": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1564077896, "post_id": 57191333, "comment_id": 100922198, "body": "Thanks Wazz. Yes I got that now!"}], "owner": {"reputation": 55, "user_id": 9036070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5cca9b441ceedcbdb7535fe97d83d5?s=128&d=identicon&r=PG&f=1", "display_name": "Billson3000", "link": "https://stackoverflow.com/users/9036070/billson3000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564002773, "creation_date": 1564002773, "question_id": 57191333, "link": "https://stackoverflow.com/questions/57191333/apply-a-required-field-validator-when-listview-item-value-x", "title": "Apply a required field validator when Listview Item Value = x", "body": "<p>I have a listview that users use to enter some data. I have applied some required fields validators using a ValidationGroup that triggers on the Insert button.</p>\n\n<p>However, I now need a different validation rule to trigger if a particular value is added to the listview via a drop down list in the template field.</p>\n\n<p>I can do this using a GridView but....the GridView doesn't support Insert so I am stumped.</p>\n\n<p>Can anyone please help??</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "edited": false, "score": 0, "creation_date": 1564007102, "post_id": 57191316, "comment_id": 100893471, "body": "This seems pretty OK-ish to me. See also my answer. Is there anything in particular that worries you?"}, {"owner": {"reputation": 111, "user_id": 7681174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918735775435/picture?type=large", "display_name": "Emily Samantha Heiner", "link": "https://stackoverflow.com/users/7681174/emily-samantha-heiner"}, "reply_to_user": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "edited": false, "score": 0, "creation_date": 1564008101, "post_id": 57191316, "comment_id": 100893733, "body": "It just smells funny to me... like there&#39;s a better way to accomplish this that I&#39;m not seeing."}, {"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "edited": false, "score": 0, "creation_date": 1564009140, "post_id": 57191316, "comment_id": 100893927, "body": "Can you lay out some ideas/requirements about how you would like it to look, even if you don&#39;t quite know how to achieve that?"}], "answers": [{"comments": [{"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "edited": false, "score": 0, "creation_date": 1564007336, "post_id": 57191894, "comment_id": 100893536, "body": "It&#39;s obviously just an example. Also, what does it help to make the settings private? Especially if you&#39;re assigning them in a <i>constructor</i>? That seems just confusing."}, {"owner": {"reputation": 111, "user_id": 7681174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918735775435/picture?type=large", "display_name": "Emily Samantha Heiner", "link": "https://stackoverflow.com/users/7681174/emily-samantha-heiner"}, "edited": false, "score": 0, "creation_date": 1564007606, "post_id": 57191894, "comment_id": 100893624, "body": "I need to be able to have multiple instances of Foo, so a static field won&#39;t work for me."}, {"owner": {"reputation": 79, "user_id": 6468720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ebf3ab30c7facc680e7e418f0a98d49?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Chepik", "link": "https://stackoverflow.com/users/6468720/igor-chepik"}, "edited": false, "score": 0, "creation_date": 1564008759, "post_id": 57191894, "comment_id": 100893855, "body": "Vilx, private - nohow, adding {get; private set;} will solve your cognitive dissonance with constructor assigning, i guess Emily, got it. Remove ref`s, because  &quot;settings&quot; are actually a reference to a class object"}], "tags": [], "owner": {"reputation": 79, "user_id": 6468720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ebf3ab30c7facc680e7e418f0a98d49?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Chepik", "link": "https://stackoverflow.com/users/6468720/igor-chepik"}, "is_accepted": false, "score": 0, "last_activity_date": 1564006212, "creation_date": 1564006212, "answer_id": 57191894, "question_id": 57191316, "link": "https://stackoverflow.com/questions/57191316/best-way-to-access-settings-from-parent-class-in-child-class/57191894#57191894", "title": "Best way to access settings from parent class in child class", "body": "<p>May be to make the settings a static field? </p>\n\n<pre><code>        public class Foo\n        {\n            public static FooSettings Settings;\n\n            public FooMethods.Bar1 Bar1 { get; private set; }\n            public FooMethods.Bar2 Bar2 { get; private set; }\n\n            public Foo(FooSettings settings)\n            {\n                Settings = settings;\n                Bar1 = new FooMethods.Bar1();\n                Bar2 = new FooMethods.Bar2();\n            }\n        }\n\n        public class FooSettings\n        {\n            public string Tag { get; set; }\n\n            public FooSettings(string tag)\n            {\n                Tag = tag;\n            }\n        }\n\n        public class FooMethods\n        {\n            public class Bar1\n            {\n                public void WriteTag()\n                {\n                    Console.WriteLine(\"Bar1 \" + Foo.Settings.Tag);\n                }\n            }\n\n            public class Bar2\n            {\n                public void WriteTag()\n                {\n                    Console.WriteLine(\"Bar2 \" + Foo.Settings.Tag);\n                }\n            }\n        }\n</code></pre>\n\n<p>And methods bar1 and bar2 can be implemented by the one class. Or its just for example?</p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 7681174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918735775435/picture?type=large", "display_name": "Emily Samantha Heiner", "link": "https://stackoverflow.com/users/7681174/emily-samantha-heiner"}, "edited": false, "score": 0, "creation_date": 1564007951, "post_id": 57192013, "comment_id": 100893702, "body": "Can you elaborate on lazy instantiating Foo.BarX? Maybe an example?"}, {"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "reply_to_user": {"reputation": 111, "user_id": 7681174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918735775435/picture?type=large", "display_name": "Emily Samantha Heiner", "link": "https://stackoverflow.com/users/7681174/emily-samantha-heiner"}, "edited": false, "score": 0, "creation_date": 1564009328, "post_id": 57192013, "comment_id": 100893977, "body": "@EmilySamanthaHeiner - Without pretty formatting - <code>private Bar1 bar1; public Bar1 Bar1 { get { if (this.bar1 == null) { this.bar1 = new Bar1(this.Settings); } return this.bar1; }}</code>"}, {"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "reply_to_user": {"reputation": 111, "user_id": 7681174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918735775435/picture?type=large", "display_name": "Emily Samantha Heiner", "link": "https://stackoverflow.com/users/7681174/emily-samantha-heiner"}, "edited": false, "score": 0, "creation_date": 1564009509, "post_id": 57192013, "comment_id": 100894012, "body": "Ok, maybe come up with some prettier names. Having a type <code>Bar1</code>, a property <code>Bar1</code> and a field <code>bar1</code> is just begging for confusion."}], "tags": [], "owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "is_accepted": false, "score": 1, "last_activity_date": 1564007044, "creation_date": 1564007044, "answer_id": 57192013, "question_id": 57191316, "link": "https://stackoverflow.com/questions/57191316/best-way-to-access-settings-from-parent-class-in-child-class/57192013#57192013", "title": "Best way to access settings from parent class in child class", "body": "<p>Ok, so this actually seems pretty fine. A few tweaks I would make myself:</p>\n\n<ul>\n<li>There's not much need for child classes here - I would use namespaces instead. Makes it easier to write.</li>\n<li>There's no need for the <code>ref</code> qualifier in the <code>BarX</code> constructors.</li>\n<li><code>BarX</code> classes could be lazily instantiated when someone first accesses <code>Foo.BarX</code>. When using such huge APIs, the typical use case will probably just use a few methods, so most <code>BarX</code>s will never be needed.</li>\n<li>Make <code>Foo.Settings</code> readonly, either through a property or just with a <code>readonly</code> qualifier.</li>\n<li>Optionally, pass the <code>Foo</code> instance to the <code>BarX</code> instead of the settings. <code>BarX</code> can access the settings (and more if needed) through that.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 7681174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918735775435/picture?type=large", "display_name": "Emily Samantha Heiner", "link": "https://stackoverflow.com/users/7681174/emily-samantha-heiner"}, "edited": false, "score": 0, "creation_date": 1564012139, "post_id": 57192151, "comment_id": 100894456, "body": "This is exactly what I was looking for. Thanks!"}, {"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "edited": false, "score": 0, "creation_date": 1564078755, "post_id": 57192151, "comment_id": 100922597, "body": "I&#39;m not sure I see the tremendous improvement here, but OK. One thing though - why bother with the interface for FooSettings? If it&#39;s just a &quot;dumb&quot; data object (and settings objects usually are), then there&#39;s no point in mocking it in unit tests. Just use <code>FooSettings</code> directly wherever you need them."}, {"owner": {"reputation": 445, "user_id": 1556780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f3274ae71d7225e82cafc8b1d54621a?s=128&d=identicon&r=PG", "display_name": "Praveen M", "link": "https://stackoverflow.com/users/1556780/praveen-m"}, "edited": false, "score": 0, "creation_date": 1564078956, "post_id": 57192151, "comment_id": 100922673, "body": "I agree. Now its &quot;dumb&quot; object . but i just opened an option in future , in case if we are going to add more functionalities to FooSettings . We can go ahead without interface if there is no more functionalities going to be added"}], "tags": [], "owner": {"reputation": 445, "user_id": 1556780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f3274ae71d7225e82cafc8b1d54621a?s=128&d=identicon&r=PG", "display_name": "Praveen M", "link": "https://stackoverflow.com/users/1556780/praveen-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1564009786, "last_edit_date": 1564009786, "creation_date": 1564008147, "answer_id": 57192151, "question_id": 57191316, "link": "https://stackoverflow.com/questions/57191316/best-way-to-access-settings-from-parent-class-in-child-class/57192151#57192151", "title": "Best way to access settings from parent class in child class", "body": "<p>I can suggest you following changes .</p>\n\n<p>You can have a base class for FooMethods , something like FooMethodsBaseClass which will be parent class for Bar1 and Bar2 . </p>\n\n<p>You can move all your common codes, methods to base class and Bar1 and Bar2 can access those . </p>\n\n<p>This way you can segregate the code . And in future, if you get requirement in which you have to implement in both in Bar1 and Bar2 you can add it in single place, in base class.\nThus you can avoid duplicates . </p>\n\n<p>As you can see WriteTag i made it as virtual . And overridden by child classes </p>\n\n<p>Also passing as ref is not needed </p>\n\n<p>Further more, you can have interface for FooMethodsBaseClass. This will actually help you in writing unit tests </p>\n\n<p>Base Interface :</p>\n\n<pre><code> public interface IFooMethodsBaseClass\n    {\n        void WriteTag();\n    }\n</code></pre>\n\n<p>Base class: </p>\n\n<pre><code>    public class FooMethodsBaseClass:IFooMethodsBaseClass\n    {\n        protected IFooSettings Settings { get; }\n\n        public FooMethodsBaseClass(IFooSettings settings)\n        {\n            Settings = settings;\n        }\n\n        public virtual void WriteTag()\n        {\n\n        }\n    }\n</code></pre>\n\n<p>Bar1 class</p>\n\n<pre><code>public class Bar1: FooMethodsBaseClass\n{\n    public Bar1(IFooSettings fooSettings):base(fooSettings)\n    {\n\n    }\n\n    public override void WriteTag()\n    {\n        Console.WriteLine(\"Bar1 \" + Settings.Tag);\n    }\n}\n</code></pre>\n\n<p>Bar2 Class</p>\n\n<pre><code>public class Bar2: FooMethodsBaseClass\n{\n    public Bar2(IFooSettings fooSettings):base(fooSettings)\n    {\n\n    }\n\n    public override void WriteTag()\n    {\n        Console.WriteLine(\"Bar2 \" + Settings.Tag);\n    }\n}\n</code></pre>\n\n<p>Foo and Foo Settings . \nFoo settings can be derived from interface as well. Since you are creating Foo by passing FooSettings , by introducing interface based injection you can write unit tests without any dependency by mocking  </p>\n\n<pre><code>    public class Foo\n    {\n        public IFooSettings Settings;\n\n        public IFooMethodsBaseClass Bar1 { get; }\n        public IFooMethodsBaseClass Bar2 { get; }\n\n        public Foo(IFooSettings settings)\n        {\n            Settings = settings;\n            Bar1 = new Bar1(Settings);\n            Bar2 = new Bar2(Settings);\n        }\n    }\n\n    public class FooSettings: IFooSettings\n    {\n        public string Tag { get; set; }\n\n        public FooSettings(string tag)\n        {\n            Tag = tag;\n        }\n\n    }\n\n    public interface IFooSettings\n    {\n        string Tag { get; set; }\n    }\n</code></pre>\n\n<p>Finally you can create Foo instance like this</p>\n\n<pre><code> IFooSettings fs = new FooSettings(\"1\");\n Foo foo = new Foo(fs);\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7681174, "user_type": "registered", "profile_image": "https://graph.facebook.com/1844918735775435/picture?type=large", "display_name": "Emily Samantha Heiner", "link": "https://stackoverflow.com/users/7681174/emily-samantha-heiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57192151, "answer_count": 3, "score": 0, "last_activity_date": 1564009786, "creation_date": 1564002675, "last_edit_date": 1564003864, "question_id": 57191316, "link": "https://stackoverflow.com/questions/57191316/best-way-to-access-settings-from-parent-class-in-child-class", "title": "Best way to access settings from parent class in child class", "body": "<p>I have a project where I'm implementing an API that has about 300 methods and I want to separate them out so they're organized by the API category.</p>\n\n<p>I'm trying to lay out my classes so that I have a parent class that has settings, and organize child classes inside of the parent that have access to those settings. I found a horribly convoluted way to do this that probably breaks every rule on the planet. Is there a more standardized way of going about this than what I've come up with?</p>\n\n<p>I want to be able to create an instance of the parent class like:</p>\n\n<pre><code>var foo = new Foo(new FooSettings(\"Hello\"));\n</code></pre>\n\n<p>and be able to access the functions in the child classes like:</p>\n\n<pre><code>foo.Bar1.WriteTag();\nfoo.Settings.Tag = \"Woot\";\nfoo.Bar2.WriteTag();\n</code></pre>\n\n<p>with Bar1 and Bar2 having access to the settings I gave when I created the instance of Foo. My current class layout is:</p>\n\n<pre><code>public class Foo\n{\n    public FooSettings Settings;\n\n    public FooMethods.Bar1 Bar1 { get; }\n    public FooMethods.Bar2 Bar2 { get; }\n\n    public Foo(FooSettings settings)\n    {\n        Settings = settings;\n        Bar1 = new FooMethods.Bar1(ref Settings);\n        Bar2 = new FooMethods.Bar2(ref Settings);\n    }\n}\n\npublic class FooSettings\n{\n    public string Tag { get; set; }\n\n    public FooSettings(string tag)\n    {\n        Tag = tag;\n    }\n}\n\npublic class FooMethods\n{\n    public class Bar1\n    {\n        private FooSettings Settings { get; }\n\n        public Bar1(ref FooSettings settings)\n        {\n            Settings = settings;\n        }\n\n        public void WriteTag()\n        {\n            Console.WriteLine(\"Bar1 \" + Settings.Tag);\n        }\n    }\n\n    public class Bar2\n    {\n        private FooSettings Settings { get; }\n\n        public Bar2(ref FooSettings settings)\n        {\n            Settings = settings;\n        }\n\n        public void WriteTag()\n        {\n            Console.WriteLine(\"Bar2 \" + Settings.Tag);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sql", "asp.net-core", "ado.net"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10463632"}, "edited": false, "score": 0, "creation_date": 1564070162, "post_id": 57191629, "comment_id": 100918775, "body": "I actually do need each &quot;selectedOrderHoliday&quot;, &quot;selectedHoliday&quot;, &quot;orderDays&quot;, and &quot;noOrderDays&quot; seperated and put into their assigned column.  Which thinking back is why I had put those values into a list as seperate entities being passed in as arguments. Don&#39;t know what I was thinking rejoining them together as a string seperated by comma&#39;s. I am having some trouble formulating a good way to do that, any suggestions?"}, {"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 0, "creation_date": 1564071168, "post_id": 57191629, "comment_id": 100919263, "body": "<code>&quot;I actually do need each [item] seperated and put into their assigned column.&quot;</code> <i><b>No, you don&#39;t. You really don&#39;t.</b></i> You can accomplish the same thing using a separate <b>table</b> for this, where each row has the primary key from the current table, a &quot;type&quot; column to tell you which source sequence int he current table you&#39;re looking at, and just one single item from the associated sequence. So there will be many more rows in the supplemental table the current table, but you preserve good normalization."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10463632"}, "edited": false, "score": 0, "creation_date": 1564072970, "post_id": 57191629, "comment_id": 100920054, "body": "Thank you! I didn&#39;t mean to come across as argumentitive but being new to all of this I really don&#39;t know what I don&#39;t know."}], "tags": [], "owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "is_accepted": true, "score": 6, "last_activity_date": 1564005126, "last_edit_date": 1564005126, "creation_date": 1564004509, "answer_id": 57191629, "question_id": 57191288, "link": "https://stackoverflow.com/questions/57191288/sqlexception-procedure-or-function-has-too-many-arguments-specified/57191629#57191629", "title": "SqlException: procedure or function has too many arguments specified", "body": "<p>We have this loop:</p>\n\n<pre><code>foreach (SessionInfoList session in sessionList)\n{\n</code></pre>\n\n<p>And within the loop, we have this parameter:</p>\n\n<pre><code>cmd.Parameters.Add(\"@SessionId\", SqlDbType.Int).Value = session.SessionID;\n</code></pre>\n\n<p>and conditionally these others, which are also inside loops:  </p>\n\n<pre><code>cmd.Parameters.Add(\"@NoOrderDays\", SqlDbType.NVarChar).Value = nod; \ncmd.Parameters.Add(\"@HolidayName\", SqlDbType.NVarChar).Value = orderHolidays; \ncmd.Parameters.Add(\"@SelectedHolidayName\", SqlDbType.NVarChar).Value = noOrderHolidays; \ncmd.Parameters.Add(\"@OrderDays\", SqlDbType.NVarChar).Value = od; \n</code></pre>\n\n<p>These loops attempt to <strong>re-add</strong> new items to the Parameters collection on each iteration, meaning you'll have the wrong number of parameters starting the first time any of those reaches it's second iteration.</p>\n\n<p>Additionally, we do this at the bottom of the loop:</p>\n\n<pre><code>connection.Open();\ncmd.ExecuteNonQuery();\ncmd.Dispose();\n</code></pre>\n\n<p>A tight loop like this is the one case where we don't really have to re-create and re-open the connection each time. Let's do this:</p>\n\n<pre><code>private void SaveGlobalOrderDays(IEnumerable&lt;SessionInfoList&gt; sessionList, IEnumerable&lt;Holiday&gt; selectedOrderHolidays, IEnumerable&lt;Holiday&gt; selectedHolidays, IEnumerable&lt;string&gt; orderDays, IEnumerable&lt;string&gt; noOrderDays)\n{\n    try\n    {\n        using (SqlConnection connection = new SqlConnection(ConnectionString))\n        using (SqlCommand cmd = new SqlCommand(\"[dbo].[SaveGlobalOrderDays]\", connection))\n        {\n            cmd.CommandTimeout = 600;\n            cmd.CommandType = CommandType.StoredProcedure;\n\n            //Set up parameter placeholders once, before any looping starts.\n            // From here on out we'll only ever set their .Value properties.\n            cmd.Parameters.Add(\"@SessionId\", SqlDbType.Int);\n            //Add a Length to these!\n            // If the target columns really are nvarchar(max), use -1\n            cmd.Parameters.Add(\"@HolidayName\", SqlDbType.NVarChar, -1); \n            cmd.Parameters.Add(\"@SelectedHolidayName\", SqlDbType.NVarChar, -1);\n            cmd.Parameters.Add(\"@OrderDays\", SqlDbType.NVarChar, -1);\n            cmd.Parameters.Add(\"@NoOrderDays\", SqlDbType.NVarChar, -1);\n\n\n            //Open the connection just once, immediately before beginning of the loop.\n            // The using block will ensure it is closed later.\n            connection.Open(); \n            foreach (SessionInfoList session in sessionList)\n            {\n                cmd.Parameters[\"@SessionId\"].Value = session.SessionID;\n\n                cmd.Paramters[\"@HolidayName\"].Value = DBNull.Value;\n                string joinedNames = string.Join(\",\", selectedOrderHolidays.Select(h =&gt; h.Name.Trim()));\n                if (!string.IsNullOrEmpty(joinedNames))\n                    cmd.Paramters[\"@HolidayName\"].Value = joinedNames;\n\n                cmd.Paramters[\"@SelectedHolidayName\"].Value = DBNull.Value;\n                joinedNames = string.Join(\",\", selectedHolidays.Select(h =&gt; h.Name.Trim()));\n                if (!string.IsNullOrEmpty(orderHolidays))\n                    cmd.Paramters[\"@SelectedHolidayName\"].Value = joinedNames;\n\n                cmd.Paramters[\"@OrderDays\"].Value = DBNull.Value;\n                joinedNames = string.Join(\",\", orderDays);\n                if (!string.IsNullOrEmpty(joinedNames))\n                    cmd.Paramters[\"@OrderDays\"].Value = joinedNames;\n\n                cmd.Paramters[\"@NoOrderDays\"].Value = DBNull.Value;\n                joinedNames = string.Join(\",\", noOrderDays);\n                if (!string.IsNullOrEmpty(joinedNames))\n                    cmd.Paramters[\"@NoOrderDays\"].Value = joinedNames;\n\n                //Now there's no need to Open() or Dispose() anything at this point.\n                cmd.ExecuteNonQuery();\n            }\n        }\n        // Consider using a separate Try/Catch inside the loop.\n        // ... unless you want one failure to abort everything part way through, with some updates completed and some not.\n        catch (Exception ex)\n        {\n            string message = \"Failed to save global order info\";\n            // Logger.Error(LogSource, \"SaveGlobalOrderDays\", string.Empty, message, string.Empty, ex);\n            throw new Exception(message, ex);\n        }\n    }\n</code></pre>\n\n<p>Finally, this looks like you're setting comma-separated values within individual columns. This is <strong>really poor schema design!</strong> <em>Never</em> put comma-separated data into a single column. You'll likely do so much better to put these columns into additional tables.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10463632"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1371, "favorite_count": 0, "accepted_answer_id": 57191629, "answer_count": 1, "score": 0, "last_activity_date": 1564041943, "creation_date": 1564002527, "last_edit_date": 1564041943, "question_id": 57191288, "link": "https://stackoverflow.com/questions/57191288/sqlexception-procedure-or-function-has-too-many-arguments-specified", "title": "SqlException: procedure or function has too many arguments specified", "body": "<p>I have very little experience in SQL, I have a method that is accessing the database and adding data to a few different tables. I think my stored procedure is correct. It's the method I am having issues with. </p>\n\n<p>I am creating a Web API endpoint that is a <code>PUT</code>, it's supposed to be able to add multiple holidays and dates to multiple sessions and update the database. </p>\n\n<p>This is what I have currently, what do I need to do so I do not get the exception?</p>\n\n<pre><code>private void SaveGlobalOrderDays(List&lt;SessionInfoList&gt; sessionList, List&lt;Holiday&gt; selectedOrderHolidays, List&lt;Holiday&gt; selectedHolidays, List&lt;string&gt; orderDays, List&lt;string&gt; noOrderDays)\n{\n    try\n    {\n        using (SqlCommand cmd = new SqlCommand())\n        using (SqlConnection connection = new SqlConnection(ConnectionString))\n        {\n            cmd.CommandTimeout = 600;\n            cmd.CommandText = \"[dbo].[SaveGlobalOrderDays]\"; \n            cmd.CommandType = CommandType.StoredProcedure;\n            cmd.Connection = connection;\n\n            foreach (SessionInfoList session in sessionList)\n            {\n                cmd.Parameters.Add(\"@SessionId\", SqlDbType.Int).Value = session.SessionID;\n\n                if (selectedOrderHolidays.Count &gt; 0)\n                {\n                    foreach (Holiday holiday in selectedOrderHolidays)\n                    {\n                        string orderHolidays = string.Join(\",\", holiday.Name).Trim();\n                        cmd.Parameters.Add(\"@HolidayName\", SqlDbType.NVarChar).Value = orderHolidays; \n                    }                                \n                }\n\n                if (selectedHolidays.Count &gt; 0)\n                {\n                    foreach (Holiday holiday in selectedHolidays)\n                    {\n                        string noOrderHolidays = string.Join(\",\", holiday.Name).Trim();\n                        cmd.Parameters.Add(\"@SelectedHolidayName\", SqlDbType.NVarChar).Value = noOrderHolidays; \n                    }                                \n                }\n\n                if (orderDays.Count &gt; 0)\n                {\n                    foreach (string order in orderDays)\n                    {\n                        string od = string.Join(\",\",order).Trim();\n                        cmd.Parameters.Add(\"@OrderDays\", SqlDbType.NVarChar).Value = od; \n                    }                                \n                }\n\n                if (noOrderDays.Count &gt; 0)\n                {\n                    foreach (string noOrder in noOrderDays)\n                    {\n                        string nod = string.Join(\",\",noOrder).Trim();\n                        cmd.Parameters.Add(\"@NoOrderDays\", SqlDbType.NVarChar).Value = nod; \n                    }                                \n                }                                             \n            }\n\n            foreach (SqlParameter parameter in cmd.Parameters)\n            {\n                if (parameter.Value == null)\n                    parameter.Value = DBNull.Value;\n            }\n\n            connection.Open();\n\n            cmd.ExecuteNonQuery();\n\n            cmd.Dispose();\n        }\n    }\n    catch (Exception ex)\n    {\n        string message = \"Failed to save global order info\";\n        // Logger.Error(LogSource, \"SaveGlobalOrderDays\", string.Empty, message, string.Empty, ex);\n        throw new Exception(message, ex);\n    }\n}\n</code></pre>\n\n<p>Stored procedure:</p>\n\n<pre><code>IF OBJECT_ID('[dbo].[SaveGlobalOrderDays]') IS NOT NULL\n     DROP PROCEDURE [dbo].[SaveGlobalOrderDays]\nGO\n\nCREATE PROCEDURE [dbo].[SaveGlobalOrderDays]\n    @SessionId INT,\n    @HolidayName NVARCHAR(MAX),\n    @SelectedHolidayName NVARCHAR(MAX),\n    @OrderDays NVARCHAR(MAX),\n    @NoOrderDays NVARCHAR(MAX)\nWITH ENCRYPTION\nAS\nBEGIN\n    SET NOCOUNT ON;\n\n    UPDATE [cfgSchedule]\n    SET [cfgSchedule].[SessionId] = @SessionId,\n        [OrderDays] = @OrderDays,\n        [NoOrderDays] = @NoOrderDays\n    FROM [cfgSchedule],[SessionHolidayMapping],[SessionOrderHolidayMapping]\n    WHERE [cfgSchedule].[SessionId] = [SessionHolidayMapping].[SessionId]\n      AND [cfgSchedule].[SessionId] = [SessionOrderHolidayMapping].[SessionId]\n      AND [cfgSchedule].[SessionId] = @SessionId\n\n    UPDATE [SessionHolidayMapping]\n    SET [SessionHolidayMapping].[HolidayName] = @SelectedHolidayName\n    FROM [cfgSchedule],[SessionHolidayMapping],[SessionOrderHolidayMapping]\n    WHERE [cfgSchedule].[SessionId] = [SessionHolidayMapping].[SessionId]\n      AND [cfgSchedule].[SessionId] = [SessionOrderHolidayMapping].[SessionId]\n      AND [cfgSchedule].[SessionId] = @SessionId\n\n    UPDATE [SessionOrderHolidayMapping]\n    SET [SessionOrderHolidayMapping].[HolidayName] = @HolidayName\n    FROM [cfgSchedule],[SessionHolidayMapping],[SessionOrderHolidayMapping]\n    WHERE [cfgSchedule].[SessionId] = [SessionHolidayMapping].[SessionId]\n      AND [cfgSchedule].[SessionId] = [SessionOrderHolidayMapping].[SessionId]\n      AND [cfgSchedule].[SessionId] = @SessionId\nEND\nGO  \n</code></pre>\n"}, {"tags": ["c#", "windows", "winapi"], "comments": [{"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1564021124, "post_id": 57191245, "comment_id": 100895937, "body": "For win32 API you can use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea\" rel=\"nofollow noreferrer\"><code>CreateFile</code></a>. For example,     <code>HANDLE hPort = CreateFile(         L&quot;COM1&quot;,         GENERIC_READ | GENERIC_WRITE,         0,         NULL,         OPEN_EXISTING,         FILE_FLAG_OVERLAPPED,         NULL);</code>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1564041353, "post_id": 57191245, "comment_id": 100902400, "body": "you need set <a href=\"https://docs.microsoft.com/ru-ru/windows/win32/api/winbase/ns-winbase-_commtimeouts\" rel=\"nofollow noreferrer\"><code>COMMTIMEOUTS</code></a> - <i>If an application sets <code>ReadIntervalTimeout</code> and <code>ReadTotalTimeoutMultiplier</code> to <code>MAXDWORD</code> and sets <code>ReadTotalTimeoutConstant</code> to a value greater than zero and less than MAXDWORD, one of the following occurs when the ReadFile function is called: If there are any bytes in the input buffer, <code>ReadFile</code> returns immediately with the bytes in the buffer.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1564032347, "creation_date": 1564032347, "answer_id": 57194861, "question_id": 57191245, "link": "https://stackoverflow.com/questions/57191245/serial-port-read-a-byte-as-soon-as-it-arrives/57194861#57194861", "title": "Serial port: read a byte as soon as it arrives", "body": "<p>Maybe not much of a complete answer for your question but I think this might be worth a try.</p>\n\n<p>Depending on your needs (you did not explain them) you can try to use <a href=\"https://www.compuphase.com/software_termite.htm\" rel=\"nofollow noreferrer\">Termite</a> together with com0com. You can see a quick example <a href=\"https://stackoverflow.com/a/57062146/11476836\">here</a>.</p>\n\n<p>There is also an open source <a href=\"http://termie.sourceforge.net/\" rel=\"nofollow noreferrer\">clone</a> but I think the very feature you need (forwarding) was never implemented.</p>\n\n<p>In any case, Termite allows scripting, so it is quite likely to be able to meet your needs.</p>\n"}], "owner": {"reputation": 325, "user_id": 2558240, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/IaLUU.jpg?s=128&g=1", "display_name": "Awer Muller", "link": "https://stackoverflow.com/users/2558240/awer-muller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564032347, "creation_date": 1564002345, "question_id": 57191245, "link": "https://stackoverflow.com/questions/57191245/serial-port-read-a-byte-as-soon-as-it-arrives", "title": "Serial port: read a byte as soon as it arrives", "body": "<p>I need to write an application that can seat in the middle of a serial port communication between an application (3rd party, no source) running on my pc and a serial device connected to it (say on COM1).</p>\n\n<p>The application normally communicates with the device as soon as you plug the cable. What I need to do is break this communication by \"installing\" my app in the middle so I can control what data goes through.</p>\n\n<p>The only way I can think of solving this is creating a a pair of virtual serial ports (COM5&lt;->COM6) using com0com. Then I would redirect the app to use COM5 instead of COM1 (I can set this in the app options) and then write a program that will copy every byte received in COM6 (sent by the application) into COM1 (sent to the device) and viceversa.</p>\n\n<p>The problem is that I need to do this without introducing any delays into the communication, otherwise the application and the device will go out of sync.</p>\n\n<p>I tried creating a C# console app to do this, but it seems to wait for a pause in the stream before raising the datareceived event, effectively introducing several ms of delay (speed is 9600).</p>\n\n<p>What I would like to try now is to rewrite the program (maybe using the win32 api?) in such a way that it relays each rx byte as soon as it arrives, so the device would not notice any delay.</p>\n\n<p>Can I do this using win32? Is there a simpler solution you can recommend?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", ".net", "winforms"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 1, "creation_date": 1564002249, "post_id": 57191168, "comment_id": 100892066, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.form.controlcollection.add?view=netframework-4.8\" rel=\"nofollow noreferrer\">Form.Controls.Add()</a>"}, {"owner": {"reputation": 91, "user_id": 9618437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff66778a04db4be0b9e5f0207c4aee5?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Tworkowski", "link": "https://stackoverflow.com/users/9618437/oliver-tworkowski"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1564005864, "post_id": 57191168, "comment_id": 100893140, "body": "Doesnt seem to work. Also the site says: &quot;adds a TextBox and Label control to the control collection of a form&quot; so thats probably the reason"}], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 10446030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e4c5709cf47f246ba29daa51066ab2?s=128&d=identicon&r=PG&f=1", "display_name": "eXPresso", "link": "https://stackoverflow.com/users/10446030/expresso"}, "is_accepted": true, "score": 1, "last_activity_date": 1565000497, "creation_date": 1565000497, "answer_id": 57356626, "question_id": 57191168, "link": "https://stackoverflow.com/questions/57191168/how-to-display-form-components-from-list/57356626#57356626", "title": "How to display Form Components from List", "body": "<p>John Wu is right, you have to add the Controls to the Form via <code>Controls.Add()</code></p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    Eintrag.Anfangszeit.Add(new DateTimePicker());\n    for (int i = 0; i &lt; Eintrag.Anfangszeit.Count; i++) {\n        Eintrag.Anfangszeit[i].Location = new System.Drawing.Point(30, 50 + 50 * i);\n        Eintrag.Anfangszeit[i].Size = new System.Drawing.Size(200, 20);\n        Eintrag.Anfangszeit[i].Visible = true;\n        this.Controls.Add(Eintrag.Anfangszeit[i]);\n        Eintrag.Anfangszeit[i].Show();            \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 9618437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff66778a04db4be0b9e5f0207c4aee5?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Tworkowski", "link": "https://stackoverflow.com/users/9618437/oliver-tworkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57356626, "answer_count": 1, "score": 1, "last_activity_date": 1565000497, "creation_date": 1564001993, "last_edit_date": 1564278339, "question_id": 57191168, "link": "https://stackoverflow.com/questions/57191168/how-to-display-form-components-from-list", "title": "How to display Form Components from List", "body": "<p>this question might be really stupid but here it is anyway. What I want my programm to do: When I press a button I want to add a DatePicker Component to a List and then display all the Components in the Main Form. However when I press the button it only adds the components but doesnt show them in the Form Window. No Errors are thrown. What do I have to do to display the DatePicker Components in the Main Form?</p>\n\n<pre><code>//class containing the List of Components\n     class Eintrag\n        {\n            static public List&lt;DateTimePicker&gt; Anfangszeit = new List&lt;DateTimePicker&gt;();\n        }\n\n//Main Form Class\n    public partial class Form1 : Form\n        {\n            public Form1()\n            {\n                InitializeComponent();\n            }\n\n            private void button1_Click(object sender, EventArgs e)\n            {\n                Eintrag.Anfangszeit.Add(new DateTimePicker());\n                for (int i = 0; i &lt; Eintrag.Anfangszeit.Count; i++)\n                {\n                    Eintrag.Anfangszeit[i].Location = new System.Drawing.Point(30, 50 + 50*i);\n                    Eintrag.Anfangszeit[i].Size = new System.Drawing.Size(200, 20);\n                    Eintrag.Anfangszeit[i].Visible = true;\n                    Eintrag.Anfangszeit[i].Show();\n                }\n            }\n        }\n</code></pre>\n"}, {"tags": ["c#", "azure", "botframework", "azure-bot-service"], "comments": [{"owner": {"reputation": 3394, "user_id": 10708483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puvWi.jpg?s=128&g=1", "display_name": "tdurnford", "link": "https://stackoverflow.com/users/10708483/tdurnford"}, "edited": false, "score": 0, "creation_date": 1564079689, "post_id": 57191147, "comment_id": 100922987, "body": "Are you using Web Chat? If so how are you requesting your toke - does the request include a user id?"}, {"owner": {"reputation": 25, "user_id": 10167787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4151e809242e0b3c601d9fd19d03475?s=128&d=identicon&r=PG&f=1", "display_name": "RafaelVenancioGD", "link": "https://stackoverflow.com/users/10167787/rafaelvenanciogd"}, "reply_to_user": {"reputation": 3394, "user_id": 10708483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puvWi.jpg?s=128&g=1", "display_name": "tdurnford", "link": "https://stackoverflow.com/users/10708483/tdurnford"}, "edited": false, "score": 0, "creation_date": 1564085282, "post_id": 57191147, "comment_id": 100925314, "body": "@tdurnford I&#39;m using Direct-line and Telegram only. In direct-line I set the user_id by jscript function &#39;User-&#39; + Math.floor((1 + Math.random()) * 10000); I set the bot_id with the same logic too, but even with this random ID they share the same state in all Direct-line and Telegram conversations.Thanks for the help."}, {"owner": {"reputation": 3394, "user_id": 10708483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puvWi.jpg?s=128&g=1", "display_name": "tdurnford", "link": "https://stackoverflow.com/users/10708483/tdurnford"}, "edited": false, "score": 0, "creation_date": 1564086109, "post_id": 57191147, "comment_id": 100925649, "body": "Can you add that code?"}, {"owner": {"reputation": 25, "user_id": 10167787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4151e809242e0b3c601d9fd19d03475?s=128&d=identicon&r=PG&f=1", "display_name": "RafaelVenancioGD", "link": "https://stackoverflow.com/users/10167787/rafaelvenanciogd"}, "reply_to_user": {"reputation": 3394, "user_id": 10708483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puvWi.jpg?s=128&g=1", "display_name": "tdurnford", "link": "https://stackoverflow.com/users/10708483/tdurnford"}, "edited": false, "score": 0, "creation_date": 1564086340, "post_id": 57191147, "comment_id": 100925735, "body": "@tdurnford Sure, I you can see the jscript code right now."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10167787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4151e809242e0b3c601d9fd19d03475?s=128&d=identicon&r=PG&f=1", "display_name": "RafaelVenancioGD", "link": "https://stackoverflow.com/users/10167787/rafaelvenanciogd"}, "edited": false, "score": 0, "creation_date": 1564399312, "post_id": 57227494, "comment_id": 101005370, "body": "The _UserStorage is a AzureBlobStorage  object that has my Azure configuration for user data which I would use to store some user information. I&quot;ll remove this because is better to use only one storage configuration in _ConversationStorage.                           await VerificarDialogo(); Get Azure data that will be used in &quot;MainDialog&quot;.                                                                                                                  IniciarDialogo is a task that will create the state property and call dialogContext.BeginDialogAsync.I updated the code with this task. Thanks"}], "tags": [], "owner": {"reputation": 7957, "user_id": 86646, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/z9iB2.jpg?s=128&g=1", "display_name": "Eric Dahlvang", "link": "https://stackoverflow.com/users/86646/eric-dahlvang"}, "is_accepted": false, "score": 2, "last_activity_date": 1564178732, "creation_date": 1564178732, "answer_id": 57227494, "question_id": 57191147, "link": "https://stackoverflow.com/questions/57191147/botframework-v4-same-state-for-all-users-c/57227494#57227494", "title": "Botframework v4 same state for all users C#", "body": "<p>What is <code>_UserStorage</code>?  ... the <code>UserState</code> class should be utilizing your <code>IStorage</code> implementation, which it will do automatically since you are already injecting an <code>IStorage</code> If you just inject the UserState, di will ensure it is created using the IStorage already present: <code>services.AddSingleton&lt;UserState&gt;();</code> </p>\n\n<p>There is not enough here to determine what is going wrong.</p>\n\n<p>Also, what is happening here?</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>if (member.Id != turnContext.Activity.Recipient.Id)\n{\n     dialogo = await VerificarDialogo();                    \n     await IniciarDialogo(turnContext, cancellationToken);\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10167787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4151e809242e0b3c601d9fd19d03475?s=128&d=identicon&r=PG&f=1", "display_name": "RafaelVenancioGD", "link": "https://stackoverflow.com/users/10167787/rafaelvenanciogd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564399487, "creation_date": 1564001896, "last_edit_date": 1564399487, "question_id": 57191147, "link": "https://stackoverflow.com/questions/57191147/botframework-v4-same-state-for-all-users-c", "title": "Botframework v4 same state for all users C#", "body": "<p>I'm trying to migrate my botframework APP v3 to v4, I followed the instruction from microsoft documentation and everything works fine except state control, in my bot the state is shared for all user and for all channels (directline, telegram).</p>\n\n<p>I saw this topic <a href=\"https://stackoverflow.com/questions/55690399/userprofile-state-persistent-between-users-in-bot-v4\">UserProfile state persistent between users in bot v4</a> but even forcing web random ID the state still share between users.</p>\n\n<p>My bot has been created with Core bot template provided by Microsoft. You can see my C# code below. I'll skip to post Maindialog due to only business rules there in a waterfall dialog, but if needed I can post too.</p>\n\n<p>Thanks for the help.</p>\n\n<p>Startup.cs</p>\n\n<pre><code>public class Startup\n{\n    private const string BotOpenIdMetadataKey = \"BotOpenIdMetadata\";\n    private static readonly AzureBlobStorage _UserStorage = new AzureBlobStorage(\"DefaultEndpointsProtocol=https;AccountName=evabotwebbe9c;AccountKey=wsU18jImJVSX+2vq6l0flx9Ou83hcDyrxie0tUN7fjxMV3bfHhYJuFobmq0h/TXU/pBBOvfpGVUlHtuqn7cNVw==;EndpointSuffix=core.windows.net\", \"botuserstate\");\n    private static readonly AzureBlobStorage _ConversationStorage = new AzureBlobStorage(\"DefaultEndpointsProtocol=https;AccountName=evabotwebbe9c;AccountKey=wsU18jImJVSX+2vq6l0flx9Ou83hcDyrxie0tUN7fjxMV3bfHhYJuFobmq0h/TXU/pBBOvfpGVUlHtuqn7cNVw==;EndpointSuffix=core.windows.net\", \"botconversationstate\");        \n\n    public Startup(IConfiguration configuration)\n    {\n        Configuration = configuration;\n    }\n\n    public IConfiguration Configuration { get; }\n\n    // This method gets called by the runtime. Use this method to add services to the container.\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);\n\n        if (!string.IsNullOrEmpty(Configuration[BotOpenIdMetadataKey]))\n            ChannelValidation.OpenIdMetadataUrl = Configuration[BotOpenIdMetadataKey];\n\n        // Create the credential provider to be used with the Bot Framework Adapter.\n        services.AddSingleton&lt;ICredentialProvider, ConfigurationCredentialProvider&gt;();\n\n        // Create the Bot Framework Adapter with error handling enabled.\n        services.AddSingleton&lt;IBotFrameworkHttpAdapter, WebSocketEnabledHttpAdapter&gt;();           \n\n        // Create the storage we'll be using for User and Conversation state. (Memory is great for testing purposes.)\n        services.AddSingleton&lt;IStorage, AzureBlobStorage&gt;();\n\n        // Create the User state. (Used in this bot's Dialog implementation.)            \n        var userState = new UserState(_UserStorage);\n\n        // Create the Conversation state. (Used by the Dialog system itself.)            \n        var conversationState = new ConversationState(_ConversationStorage);\n\n        // Add the states as singletons\n        services.AddSingleton(userState);\n        services.AddSingleton(conversationState);            \n\n        services.AddSingleton(sp =&gt;\n        {\n            userState = sp.GetService&lt;UserState&gt;();\n            conversationState = sp.GetService&lt;ConversationState&gt;();\n\n            // Create the Conversation state. (Used by the Dialog system itself.)\n            return new BotStateSet(userState, conversationState);\n        });\n\n\n        // The Dialog that will be run by the bot.\n        services.AddSingleton&lt;MainDialog&gt;();            \n\n        // Create the bot as a transient. In this case the ASP Controller is expecting an IBot.\n        services.AddTransient&lt;IBot, DialogAndWelcomeBot&lt;MainDialog&gt;&gt;();\n    }        \n\n    // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.\n    public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n    {\n        if (env.IsDevelopment())\n        {\n            app.UseDeveloperExceptionPage();\n        }\n        else\n        {\n            app.UseHsts();\n        }\n\n        app.UseDefaultFiles();\n        app.UseStaticFiles();\n        app.UseWebSockets();\n        //app.UseHttpsRedirection();\n        app.UseMvc();\n    }\n}\n</code></pre>\n\n<p>DialogAndWelcomeBot.cs</p>\n\n<pre><code>public class DialogAndWelcomeBot&lt;T&gt; : DialogBot&lt;T&gt; where T : Dialog\n{\n    protected IConfiguration Configuration;\n    private BotState _conversationState;\n    private BotState _userState;\n    protected IStatePropertyAccessor&lt;DialogState&gt; accessor;        \n    protected Dialogo dialogo;\n    protected Dialog Dialog;\n\n    public DialogAndWelcomeBot(ConversationState conversationState, UserState userState, T dialog, ILogger&lt;DialogBot&lt;T&gt;&gt; logger, IConfiguration configuration)\n        : base(conversationState, userState, dialog, logger)\n    {            \n        Configuration = configuration;\n        dialogo = new Dialogo();\n        _conversationState = conversationState;\n        _userState = userState;\n        Dialog = dialog;\n    }\n\n    protected override async Task OnMembersAddedAsync(IList&lt;ChannelAccount&gt; membersAdded, ITurnContext&lt;IConversationUpdateActivity&gt; turnContext, CancellationToken cancellationToken)\n    {\n        foreach (var member in membersAdded)\n        {\n            // Greet anyone that was not the target (recipient) of this message.\n            // To learn more about Adaptive Cards, see https://aka.ms/msbot-adaptivecards for more details.\n            if (member.Id != turnContext.Activity.Recipient.Id)\n            {\n                dialogo = await VerificarDialogo();                    \n                await IniciarDialogo(turnContext, cancellationToken);\n            }\n        }\n    }\n\nprivate async Task IniciarDialogo(ITurnContext&lt;IConversationUpdateActivity&gt; turnContext, CancellationToken cancellationToken)\n    {\n        accessor = _conversationState.CreateProperty&lt;DialogState&gt;(\"DialogState\");\n\n        var dialog = Dialog;\n        var dialogSet = new DialogSet(accessor);            \n        dialogSet.Add(dialog);\n\n        var dialogContext = await dialogSet.CreateContextAsync(turnContext, cancellationToken);\n        var results = await dialogContext.ContinueDialogAsync(cancellationToken);\n\n        if (results.Status == DialogTurnStatus.Empty)\n        {\n            var conversationStateAccessors = _conversationState.CreateProperty&lt;ConversationData&gt;(nameof(ConversationData));\n            var conversationData = await conversationStateAccessors.GetAsync(turnContext, () =&gt; new ConversationData());\n\n            var userStateAccessors = _userState.CreateProperty&lt;UserProfile&gt;(nameof(UserProfile));\n            var userProfile = await userStateAccessors.GetAsync(turnContext, () =&gt; new UserProfile());\n\n            await dialogContext.BeginDialogAsync(dialog.Id, dialogo, cancellationToken);\n        }            \n    }\n</code></pre>\n\n<p>DialogBot.cs</p>\n\n<pre><code>public class DialogBot&lt;T&gt; : ActivityHandler where T : Dialog\n{\n    private readonly Dialog Dialog;\n    private BotState _conversationState;\n    private BotState _userState;\n    protected readonly ILogger Logger;        \n\n    public DialogBot(ConversationState conversationState, UserState userState, T dialog, ILogger&lt;DialogBot&lt;T&gt;&gt; logger)\n    {\n        _conversationState = conversationState;\n        _userState = userState;\n        Dialog = dialog;\n        Logger = logger;            \n    }\n\n    public override async Task OnTurnAsync(ITurnContext turnContext, CancellationToken cancellationToken = default(CancellationToken))\n    {\n        await base.OnTurnAsync(turnContext, cancellationToken);\n\n        // Client notifying this bot took to long to respond (timed out)\n        if (turnContext.Activity.Code == EndOfConversationCodes.BotTimedOut)\n        {\n            await turnContext.SendActivityAsync(MessageFactory.Text(\"Desculpe-me, mas parece que a conex\u00e3o com a internet est\u00e1 ruim e isto ir\u00e1 afetar o desempenho da nossa conversa.\"), cancellationToken);\n            return;\n        }\n\n        await _userState.SaveChangesAsync(turnContext, false, cancellationToken);\n        await _conversationState.SaveChangesAsync(turnContext, false, cancellationToken);\n\n    }\n\n    protected override async Task OnMessageActivityAsync(ITurnContext&lt;IMessageActivity&gt; turnContext, CancellationToken cancellationToken)\n    {\n        Logger.LogInformation(\"Message Activity log\");\n        // Run the Dialog with the new message Activity.\n\n        await Dialog.Run(turnContext, _conversationState.CreateProperty&lt;DialogState&gt;(nameof(DialogState)), cancellationToken);            \n    }        \n}\n</code></pre>\n\n<p>DialogExtensions.cs</p>\n\n<pre><code>public static class DialogExtensions\n{\n    public static async Task Run(this Dialog dialog, ITurnContext turnContext, IStatePropertyAccessor&lt;DialogState&gt; accessor, CancellationToken cancellationToken = default(CancellationToken))\n    {\n        var dialogSet = new DialogSet(accessor);\n        dialogSet.Add(dialog);\n\n        var dialogContext = await dialogSet.CreateContextAsync(turnContext, cancellationToken);\n        var results = await dialogContext.ContinueDialogAsync(cancellationToken);\n\n        if (results.Status == DialogTurnStatus.Empty)\n        {                \n            await dialogContext.BeginDialogAsync(dialog.Id, null, cancellationToken);\n        }\n        else\n        {                \n            await dialogContext.ReplaceDialogAsync(dialog.Id, null, cancellationToken);\n        }\n    }\n}\n</code></pre>\n\n<p>Jscript code into HTML file.</p>\n\n<pre><code>&lt;script&gt;\n    function guid() {\n        return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n            s4() + '-' + s4() + s4() + s4();\n    }\n\n    function s4() {\n        return Math.floor((1 + Math.random()) * 0x10000)\n            .toString(16)\n            .substring(1);\n    }        \n\n    var user = {\n        id: guid().toUpperCase(),\n        name: 'User-' + Math.floor((1 + Math.random()) * 10000)\n    };\n    var botConnection = new BotChat.DirectLine({\n        token: 'MyToken',\n        user: user,\n        webSocket: 'true'\n    });          \n\n    const speechOptions = {\n     speechRecognizer: new BotChat.Speech.BrowserSpeechRecognizer(),\n     speechSynthesizer: new BotChat.Speech.BrowserSpeechSynthesizer()\n     };\n\n    BotChat.App({\n        user: user,            \n        botConnection: botConnection,\n        speechOptions: speechOptions,\n        bot: { id: 'Bot'+ Math.floor((1 + Math.random()) * 10000)},\n        resize: 'detect',            \n    }, document.getElementById(\"bot\"));\n    botConnection\n        .postActivity({\n            from: user,\n            name: 'none',\n            type: 'event',\n            value: 'none'\n        })\n        .subscribe(function (id) {\n            console.log('\"trigger setUserIdEvent\" sent');\n        });\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["c#", "postgresql", ".net-core", "npgsql", "rds"], "answers": [{"comments": [{"owner": {"reputation": 11446, "user_id": 640325, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/018fc595a3e6b1ac5c18cb27e73a066d?s=128&d=identicon&r=PG", "display_name": "Shay Rojansky", "link": "https://stackoverflow.com/users/640325/shay-rojansky"}, "edited": false, "score": 2, "creation_date": 1564013261, "post_id": 57191928, "comment_id": 100894665, "body": "Note that if the Database parameter is omitted, Npgsql will default to the username as your database (this is standard PostgreSQL behavior). So you were in effect trying to open a database called <code>uname</code>."}], "tags": [], "owner": {"reputation": 1110, "user_id": 214205, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d31fb7fc0df66e3e50f24f51ad5368ed?s=128&d=identicon&r=PG", "display_name": "6footunder", "link": "https://stackoverflow.com/users/214205/6footunder"}, "is_accepted": false, "score": 1, "last_activity_date": 1564006483, "creation_date": 1564006483, "answer_id": 57191928, "question_id": 57191070, "link": "https://stackoverflow.com/questions/57191070/connecting-to-postgres-in-rds-with-npgsql/57191928#57191928", "title": "Connecting to PostGres in RDS with npgsql", "body": "<p>Sigh.</p>\n\n<p>Problem was me.</p>\n\n<p>Must have copied a connection string from somewhere which had \",\" instead of \";\" as the property seperator.</p>\n\n<p>I was also missing the database property.</p>\n\n<p>Working conn string is:</p>\n\n<pre><code>Host=test2.ckxycbarkbtw.ap-southeast-2.rds.amazonaws.com;Username=unamePassword=***;Database=test2;\n</code></pre>\n"}], "owner": {"reputation": 1110, "user_id": 214205, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d31fb7fc0df66e3e50f24f51ad5368ed?s=128&d=identicon&r=PG", "display_name": "6footunder", "link": "https://stackoverflow.com/users/214205/6footunder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1564006483, "creation_date": 1564001533, "question_id": 57191070, "link": "https://stackoverflow.com/questions/57191070/connecting-to-postgres-in-rds-with-npgsql", "title": "Connecting to PostGres in RDS with npgsql", "body": "<p>The following code produces \n<em>System.Net.Sockets.SocketException: 'No such host is known'</em>\non the Open() statement</p>\n\n<pre><code>var connection = new NpgsqlConnection(\"Host=dev-materialized-views-std.ckxycbarkbtw.ap-southeast-2.rds.amazonaws.com,Port=5432,Username=uname,Password=***\");                                                              \nconnection.Open();\n</code></pre>\n\n<p>This code works:</p>\n\n<pre><code>var connection = new NpgsqlConnection(\"Host=tm-integration.ckxycbarkbtw.ap-southeast-2.rds.amazonaws.com,Port=5432,Username=uname,Password=***\");\n</code></pre>\n\n<p>The only difference we can spot via the RDS console is that the working connection string points at PostGre 10.4, the failing connection string points at a 11.4 instance.</p>\n\n<p>Given all else is equal (RDS network config / VPC setting) this looks like an issue in the dotnet core stack itself? We've tried this on 2.2 and 2.0, no difference.</p>\n"}, {"tags": ["c#", "async-await"], "comments": [{"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 1, "creation_date": 1564001595, "post_id": 57191065, "comment_id": 100891826, "body": "In the first version the <code>await</code> is part of that lambda function not the enclosing <code>DoSomething</code>, therefore <code>DoSomething</code> lacks an <code>await</code>"}, {"owner": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "reply_to_user": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1564001771, "post_id": 57191065, "comment_id": 100891893, "body": "@JSteward can you elaborate on that? The one in the loop is contained in a loop, that sounds very similar to being enclosed in a lambda. Also, if <code>listOfStuff</code> is empty then neither will actually run and no <code>await</code> is ever touched."}, {"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1564001945, "post_id": 57191065, "comment_id": 100891962, "body": "<code>DoSomething</code> is a function, the lambda function is... a function. In the first version only the lambda has an <code>await</code>. It doesn&#39;t matter if <code>listOfStuff</code> may or may not be empty <code>DoSomething</code>, in the second version, has an <code>await</code>."}, {"owner": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "reply_to_user": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1564002060, "post_id": 57191065, "comment_id": 100891998, "body": "Ok, is there an actual functional difference between the two? At the core level of iterating through a list and calling a method on each item in the list, is there an actual difference between the two implementations?"}, {"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1564002287, "post_id": 57191065, "comment_id": 100892075, "body": "<a href=\"https://github.com/microsoft/referencesource/blob/e0bf122d0e52a42688b92bb4be2cfd66ca3c2f07/mscorlib/system/collections/generic/list.cs#L545\" rel=\"nofollow noreferrer\"><code>List&lt;T&gt;.ForEach</code></a> takes an <code>Action&lt;T&gt;</code> not a <code>Func&lt;T, Task&gt;</code>, so when you send an async function to it you&#39;ve created an <code>async void</code> method that is unawaitable."}, {"owner": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "reply_to_user": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1564002357, "post_id": 57191065, "comment_id": 100892100, "body": "@JSteward can you flesh all that out into a proper answer?"}], "answers": [{"comments": [{"owner": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "edited": false, "score": 0, "creation_date": 1564006493, "post_id": 57191357, "comment_id": 100893306, "body": "The addition of the test case really helps clarify. I&#39;m very surprised by the functional difference of <code>.ForEach()</code> vs <code>foreach</code>."}], "tags": [], "owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "is_accepted": true, "score": 1, "last_activity_date": 1564002916, "creation_date": 1564002916, "answer_id": 57191357, "question_id": 57191065, "link": "https://stackoverflow.com/questions/57191065/lack-of-await-warning-in-async-method-that-has-await-in-a-lambda/57191357#57191357", "title": "Lack of await warning in async method that has await in a lambda", "body": "<p>In the first version, the <code>DoSomething</code> function lacks an <code>await</code> operator. The only <code>await</code> is within the async void lambda passed to the <code>ForEach</code> method. In the second version the <code>DoSomething</code> function has an <code>await</code> as part of the actual body of the function and thus you get no warning. It doesn't matter if the <code>listOfStuff</code> may or may not be empty, the condition that the method needs an <code>await</code> is satisfied.</p>\n\n<p>Now the functional difference may not be immediatly clear but it is critical. As stated the first version uses an async void method. That is un-awaitable and the method will therefore continue before the async operation completes as you can see with this test:</p>\n\n<pre><code>[Test]\npublic void DoSomething()\n{\n    var sw = Stopwatch.StartNew();\n    var list = Enumerable.Range(0, 10).ToList();\n    list.ForEach(async x =&gt; await Task.Delay(TimeSpan.FromSeconds(1)));\n    Console.WriteLine($\"{sw.ElapsedMilliseconds}ms\");\n}\n</code></pre>\n\n<p>Result <code>6ms</code>, not the 10 seconds we'd expect. The second version of your code is a properly awaitable <code>async Task</code>:</p>\n\n<pre><code>[Test]\npublic async Task DoSomething()\n{\n    var sw = Stopwatch.StartNew();\n    var list = Enumerable.Range(0, 10).ToList();\n    foreach(var x in list)\n    {\n        await Task.Delay(TimeSpan.FromSeconds(1));\n    }\n    Console.WriteLine($\"{sw.ElapsedMilliseconds}ms\");\n}\n</code></pre>\n\n<p>And we see the result is: <code>10032ms</code> right within expectations.</p>\n"}, {"tags": [], "owner": {"reputation": 15450, "user_id": 11178549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N3P6o.png?s=128&g=1", "display_name": "Theodor Zoulias", "link": "https://stackoverflow.com/users/11178549/theodor-zoulias"}, "is_accepted": false, "score": 0, "last_activity_date": 1564006042, "last_edit_date": 1564006042, "creation_date": 1564005081, "answer_id": 57191710, "question_id": 57191065, "link": "https://stackoverflow.com/questions/57191065/lack-of-await-warning-in-async-method-that-has-await-in-a-lambda/57191710#57191710", "title": "Lack of await warning in async method that has await in a lambda", "body": "<p>If we replace the lambda with a local function, things may become clearer:</p>\n\n<pre><code>public async Task&lt;Response&gt; DoSomething()\n{\n    //stuff\n    listOfStuff.ForEach(ProcessStuffAsync);\n    return new Response(listOfStuff.Count);\n\n    async Task ProcessStuffAsync(Stuff s) // local function\n    {\n        await _repo.DoThing(s);\n    }\n}\n</code></pre>\n\n<p>The <code>DoSomething</code> method returns a <code>Task</code>, but it is not really asynchronous because it lacks an <code>await</code>. So the <code>Task</code> returned will be in a completed state. All code inside <code>DoSomething</code> (excluding the code inside the local function) will run synchronously.</p>\n\n<p>The local function <code>ProcessStuffAsync</code> is trully asynchronous, and will return one <code>Task</code> each time is called. These tasks are neither awaited nor stored somewhere inside the <code>DoSomething</code> method, so they are fire-and-forget tasks. Nobody knows what's gonna happen to them.</p>\n\n<hr>\n\n<p><strong>Update:</strong> The code above doesn't compile because <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.list-1.foreach\" rel=\"nofollow noreferrer\"><code>List.ForEach</code></a> cannot accept the <code>ProcessStuffAsync</code> local function as argument. The compiler complains that it has wrong return type. To make the code compile, the local function must return <code>void</code>. But <a href=\"https://msdn.microsoft.com/en-us/magazine/jj991977.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">async void</a> functions are a can of worms by themselves.</p>\n"}], "owner": {"reputation": 2038, "user_id": 7129076, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a190b1b49a5ce2f6d1ead8ccbb11dc35?s=128&d=identicon&r=PG&f=1", "display_name": "gilliduck", "link": "https://stackoverflow.com/users/7129076/gilliduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 57191357, "answer_count": 2, "score": -2, "last_activity_date": 1564278370, "creation_date": 1564001518, "last_edit_date": 1564278370, "question_id": 57191065, "link": "https://stackoverflow.com/questions/57191065/lack-of-await-warning-in-async-method-that-has-await-in-a-lambda", "title": "Lack of await warning in async method that has await in a lambda", "body": "<p>Either Visual Studio is confused, or I am (probably me). </p>\n\n<p>If I have</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public async Task&lt;Response&gt; DoSomething()\n{\n    //stuff\n    listOfStuff.ForEach(async s =&gt; await _repo.DoThing(s));\n    return new Response(listOfStuff.Count);\n}\n</code></pre>\n\n<p>It complains that </p>\n\n<blockquote>\n  <p>This async method lacks 'await' ...</p>\n</blockquote>\n\n<p>However if I change my method to</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public async Task&lt;Response&gt; DoSomething()\n{\n    //stuff\n    foreach (var s in listOfStuff)\n    {\n        await _repo.DoThing(s);\n    }\n    return new Response(listOfStuff.Count);\n}\n</code></pre>\n\n<p>Then it is perfectly happy and the warning goes away.</p>\n\n<p>So twofold question, is the warning correct and if it is, what is the reasoning for the difference? I'm under the impression that the two methods are intrinsically the same, if the warning is correct, then I must assume that my impression is wrong.</p>\n"}, {"tags": ["c#", "post", "apple-news"], "owner": {"reputation": 29, "user_id": 11697374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6af489235efbabd966662ebf55d109e?s=128&d=identicon&r=PG&f=1", "display_name": "Chulsy", "link": "https://stackoverflow.com/users/11697374/chulsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1564001354, "creation_date": 1564001354, "question_id": 57191032, "link": "https://stackoverflow.com/questions/57191032/post-request-in-apple-news-api", "title": "POST request in Apple News API", "body": "<p>I am struggling with the POST request for creating an article.</p>\n\n<p><strong>Can anybody please provide me an example value of the canonical request in C#?</strong></p>\n\n<p>The error I receive is signature issue:</p>\n\n<pre><code>{\"errors\":[{\"code\":\"WRONG_SIGNATURE\"}]}\n</code></pre>\n\n<p>From what I learnt a canonical request is build from:</p>\n\n<pre><code>Method = POST\nURL = https://news-api.apple.com/channels/ChanelID/articles\nDate = 2019-07-24T18:12:32Z\nContent-Type = multipart/form-data\nBody - Not fully understood\n</code></pre>\n\n<p>The Apple News API documentation says</p>\n\n<blockquote>\n  <p>If the request is a POST request and it includes an entity, include\n  the following:</p>\n  \n  <p>The value of the Content-Type header </p>\n  \n  <p>The full content of the entity - <strong>What is meant by this?</strong></p>\n</blockquote>\n\n<p>I want to post one test article from the json files provided in the apple's documentation.</p>\n\n<p>This is the class generating the auth header:</p>\n\n<pre><code>public class Security\n{\n  public static string AuthHeader(string method, string url, object content=null)\n  {\n        string formDataBoundary = String.Format(\"{0:N}\", Guid.NewGuid());\n        var apiKeyId = Constants.AppleNewsKeyId;\n        var apiKeySecret = Constants.AppleNewsKeySecret;\n        if (string.IsNullOrEmpty(apiKeyId) || string.IsNullOrEmpty(apiKeySecret)) return string.Empty;\n        var encoding = new ASCIIEncoding();\n        var dt = DateTime.Now.ToString(Constants.DateFormat);\n        var canonicalRequest = string.Format(\"{0}{1}{2}{3}\", method, url, dt, content);\n        var key = Convert.FromBase64String(apiKeySecret);\n        var hmac = new HMACSHA256(key);\n        var hashed = hmac.ComputeHash(encoding.GetBytes(canonicalRequest));\n        var signature = Convert.ToBase64String(hashed);\n        var authorizaton = string.Format(@\"HHMAC; key={0}; signature={1}; date={2}\", apiKeyId, signature, dt);\n        return authorizaton;\n    }\n}\n</code></pre>\n\n<p>This is the constants class:</p>\n\n<pre><code>public static class Constants\n{\n    public static readonly string ChannelId = \"myID\"; \n    public static readonly string AppleNewsBaseUri = \"https://news-api.apple.com\";\n    public static readonly string DateFormat = \"yyyy-MM-ddTHH:mm:ssK\";\n    public static readonly string AppleNewsKeySecret = \"myID\";\n    public static readonly string AppleNewsKeyId = \"myID\";   \n}\n</code></pre>\n\n<p>And the action class which is missing code in order to have proper content instead of null passed to the AuthHeader method:</p>\n\n<pre><code> public class Action\n    {\n        public static string SendCommand(string action, string method)\n        {\n         var url = $\"{Constants.AppleNewsBaseUri}{action}\" + \"/articles\";\n        //string content = String.Format(\"{0}:{1}\", \"Content-Disposition\", \"form-data; filename=article.json; name=article.json;\");\n        var authheader = Security.AuthHeader(method, url, null);\n        var request = WebRequest.Create(url);\n        request.PreAuthenticate = true;\n        request.Method = \"POST\";\n        request.Headers.Add(\"Authorization\", authheader);\n\n        if (method.Equals(\"post\", StringComparison.InvariantCultureIgnoreCase))\n            request.ContentType = \"multipart/form-data;\" ;\n        var output = string.Empty;\n        try\n        {\n            string filePath = Path.GetFullPath(\"article.json\");\n            using (StreamReader r = new StreamReader(filePath))\n            {\n                string json = r.ReadToEnd();\n                dynamic jsonObj = JsonConvert.DeserializeObject(json);\n\n                ASCIIEncoding encoding = new ASCIIEncoding();\n                Byte[] bytes = encoding.GetBytes(json);\n                request.ContentLength = bytes.Length;\n\n                Stream newStream = request.GetRequestStream();\n                newStream.Write(bytes, 0, bytes.Length);\n                newStream.Close();\n            }\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine(\"The file could not be read:\");\n            Console.WriteLine(e.Message);\n        }\n\n        try\n        {\n            using (var response = request.GetResponse())\n            {\n                using (var reader = new StreamReader(response.GetResponseStream()))\n                    output = reader.ReadToEnd();\n            }\n        }\n        catch (WebException e)\n        {\n            using (var reader = new StreamReader(e.Response.GetResponseStream()))\n            {\n                output = reader.ReadToEnd();\n            }\n        }\n        return output;\n    }\n\n\n    public static string ReadChannel()\n    {\n        var action = $\"/channels/{Constants.ChannelId}\";\n        const string method = \"POST\";\n        return SendCommand(action, method);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "unity3d"], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 3939292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u04yP.jpg?s=128&g=1", "display_name": "Gutblender", "link": "https://stackoverflow.com/users/3939292/gutblender"}, "is_accepted": true, "score": 0, "last_activity_date": 1564002962, "creation_date": 1564002962, "answer_id": 57191367, "question_id": 57191017, "link": "https://stackoverflow.com/questions/57191017/how-do-i-make-my-weapon-toggle-script-scroll-up-and-down/57191367#57191367", "title": "How do I make my weapon toggle script scroll up and down?", "body": "<p>I think you might want your \"down wheel\" block to work a little differently:</p>\n\n<pre><code>    if (Input.GetAxis(\"Mouse ScrollWheel\") &lt; 0f)\n    {\n        if (selectedWeapon &lt;= 0)\n            selectedWeapon = transform.childCount - 1;\n        else\n            selectedWeapon--;\n    }\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 57191367, "answer_count": 1, "score": 0, "last_activity_date": 1564002962, "creation_date": 1564001272, "last_edit_date": 1564002084, "question_id": 57191017, "link": "https://stackoverflow.com/questions/57191017/how-do-i-make-my-weapon-toggle-script-scroll-up-and-down", "title": "How do I make my weapon toggle script scroll up and down?", "body": "<p>So What you do is attach the script to the parent object and when you scroll it will scroll through the weapons. The problem is I can scroll down but when i try to scroll up it just takes me back to the top weapon.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>public class toggleweapon : MonoBehaviour\n{\npublic int selectedWeapon = 0;\n// Start is called before the first frame update\nvoid Start()\n{\n    SelectWeapon();\n}\n\n// Update is called once per frame\nvoid Update()\n{\n\n    int previousSelectedWeapon = selectedWeapon;\n\n    if (Input.GetAxis(\"Mouse ScrollWheel\") &gt; 0f)\n    {\n        if (selectedWeapon &gt;= transform.childCount - 1)\n            selectedWeapon = 0;\n        else\n            selectedWeapon++;\n    }\n    if (Input.GetAxis(\"Mouse ScrollWheel\") &lt; 0f)\n    {\n        if (selectedWeapon &lt;= transform.childCount - 1)\n            selectedWeapon = 0;\n        else\n            selectedWeapon--;\n    }\n\n    if (previousSelectedWeapon != selectedWeapon)\n    {\n        SelectWeapon();\n    }\n}\n\nvoid SelectWeapon ()\n{\n    int i = 0;\n    foreach (Transform weapon in transform)\n    {\n        if (i == selectedWeapon)\n            weapon.gameObject.SetActive(true);\n        else\n            weapon.gameObject.SetActive(false);\n        i++;\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c#", "api", "http", "httpwebrequest", "rocket.chat"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 3271820, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3Njqw.png?s=128&g=1", "display_name": "SammuelMiranda", "link": "https://stackoverflow.com/users/3271820/sammuelmiranda"}, "edited": false, "score": 0, "creation_date": 1587130044, "post_id": 57224158, "comment_id": 108395063, "body": "hi, so kind of strange, i&#39;m doing something similar, but just sending the message, and i get a 400 http error code on anything past login - i&#39;ll have your code as a help to understand, but i think i&#39;m doing it right, because is very similar."}, {"owner": {"reputation": 341, "user_id": 3271820, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/3Njqw.png?s=128&g=1", "display_name": "SammuelMiranda", "link": "https://stackoverflow.com/users/3271820/sammuelmiranda"}, "edited": false, "score": 1, "creation_date": 1587134751, "post_id": 57224158, "comment_id": 108397902, "body": "never mind, it&#39;s working, your code helped to see i wans&#39;t doing anything wrong, is some cfg on the user account; choose other and worked."}], "tags": [], "owner": {"reputation": 53, "user_id": 11696603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AVkdXWA3qjE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfEitoInLODHOaXN_-cbpfH1qwqGw/photo.jpg?sz=128", "display_name": "Manuel Fohrer", "link": "https://stackoverflow.com/users/11696603/manuel-fohrer"}, "is_accepted": true, "score": 2, "last_activity_date": 1564159671, "creation_date": 1564159671, "answer_id": 57224158, "question_id": 57191015, "link": "https://stackoverflow.com/questions/57191015/how-to-upload-files-from-a-net-application-to-a-rocket-chat-channel/57224158#57224158", "title": "How to upload files from a .NET-Application to a Rocket.Chat-Channel?", "body": "<p>After some time i got a code, which is working fine. Maybe it will help someone later.</p>\n\n<pre><code>private void SendFileToRocketChat()\n        {\n            var url = \"https://exampleurl.net/api/v1/rooms.upload/fsgfadgTXAPWsQ9\";\n            var filePath = \"text.zip\";\n            NameValueCollection formFields = null;\n            string boundary = \"----------------------------\" + DateTime.Now.Ticks.ToString(\"x\");\n\n            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);\n            request.ContentType = \"multipart/form-data; boundary=\" + boundary;\n            request.Method = \"POST\";\n            request.KeepAlive = true;\n            request.Headers.Add(\"X-Auth-Token\", \"4ZLqSyN9IEgfasgfdagsdg8S0eGPEFdfS9C\");\n            request.Headers.Add(\"X-User-Id\", \"rocket.bot\");\n\n            Stream memStream = new System.IO.MemoryStream();\n            var boundarybytes = System.Text.Encoding.ASCII.GetBytes(\"\\r\\n--\" + boundary + \"\\r\\n\");\n            var endBoundaryBytes = System.Text.Encoding.ASCII.GetBytes(\"\\r\\n--\" + boundary + \"--\");\n            string formdataTemplate = \"\\r\\n--\" + boundary + \"\\r\\nContent-Disposition: form-data; name=\\\"{0}\\\";\\r\\n\\r\\n{1}\";\n\n            string files = filePath;\n            if (formFields != null)\n            {\n                foreach (string key in formFields.Keys)\n                {\n                    string formitem = string.Format(formdataTemplate, key, formFields[key]);\n                    byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);\n                    memStream.Write(formitembytes, 0, formitembytes.Length);\n                }\n            }\n\n            string headerTemplate = \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"{1}\\\"\\r\\n\" + \"Content-Type: application/zip\\r\\n\\r\\n\";\n            memStream.Write(boundarybytes, 0, boundarybytes.Length);\n            var header = string.Format(headerTemplate, \"file\", files);\n            var headerbytes = System.Text.Encoding.UTF8.GetBytes(header);\n            memStream.Write(headerbytes, 0, headerbytes.Length);\n            using (var fileStream = new FileStream(files, FileMode.Open, FileAccess.Read))\n            {\n                var buffer = new byte[1024];\n                var bytesRead = 0;\n                while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)\n                {\n                    memStream.Write(buffer, 0, bytesRead);\n                }\n            }\n\n            memStream.Write(endBoundaryBytes, 0, endBoundaryBytes.Length);\n            request.ContentLength = memStream.Length;\n            using (Stream requestStream = request.GetRequestStream())\n            {\n                memStream.Position = 0;\n                byte[] tempBuffer = new byte[memStream.Length];\n                memStream.Read(tempBuffer, 0, tempBuffer.Length);\n                memStream.Close();\n                requestStream.Write(tempBuffer, 0, tempBuffer.Length);\n            }\n            using (var response = request.GetResponse())\n            {\n                Stream stream2 = response.GetResponseStream();\n                StreamReader reader2 = new StreamReader(stream2);\n                string res = reader2.ReadToEnd();\n\n                logger.LogInformation(JsonConvert.DeserializeObject(res).ToString().Trim('{', '}'));\n            }\n        }\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11696603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AVkdXWA3qjE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfEitoInLODHOaXN_-cbpfH1qwqGw/photo.jpg?sz=128", "display_name": "Manuel Fohrer", "link": "https://stackoverflow.com/users/11696603/manuel-fohrer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 57224158, "answer_count": 1, "score": 3, "last_activity_date": 1564159671, "creation_date": 1564001269, "last_edit_date": 1564090930, "question_id": 57191015, "link": "https://stackoverflow.com/questions/57191015/how-to-upload-files-from-a-net-application-to-a-rocket-chat-channel", "title": "How to upload files from a .NET-Application to a Rocket.Chat-Channel?", "body": "<p>I need to make a feedback-form in my .NET application, which sends messages to a Rocket.Chat-Channel (<a href=\"https://rocket.chat/\" rel=\"nofollow noreferrer\">What is Rocket.Chat?</a>).</p>\n\n<p>I am already able to send a textmessage with the api of Rocket.Chat.</p>\n\n<p>I found a <a href=\"https://rocket.chat/docs/developer-guides/rest-api/rooms/upload/\" rel=\"nofollow noreferrer\">documentation</a>, how to send files with an api, but i never had done this before. How can I send the files with my Json?</p>\n\n<p>Someone did that before? Maybe somebody can give me a small example to get this done.</p>\n\n<p>This is the code of my method, which sends the textmessage.</p>\n\n<pre><code>private void SendToRocketChat()\n        {\n            var baseAddress = \"https://plc.ifm-sw.net/api/v1/chat.sendMessage\";\n\n            var http = (HttpWebRequest)WebRequest.Create(new Uri(baseAddress));\n            http.Method = \"POST\";\n            http.ContentType = \"application/json\";\n            http.Headers.Add(\"X-Auth-Token\", \"4ZLqSyN9IEFIkj6SqIde2a4orHhEdL8S0eGPEFdfS9C\");\n            http.Headers.Add(\"X-User-Id\", \"rocket.cat\");\n\n            string rid = \"F24Ydk2kkTXAPWsQ9\";\n\n            JObject Json = new JObject(new JProperty(\"message\", new JObject(new JProperty(\"rid\", rid), new JProperty(\"msg\", WebUtility.HtmlEncode(FeedbackText)))));\n\n            ASCIIEncoding encoding = new ASCIIEncoding();\n            Byte[] bytes = encoding.GetBytes(Json.ToString());\n\n            Stream newStream = http.GetRequestStream();\n            newStream.Write(bytes, 0, bytes.Length);\n            newStream.Close();\n\n            var response = http.GetResponse();\n\n            var stream = response.GetResponseStream();\n            var sr = new StreamReader(stream);\n            var content = sr.ReadToEnd();\n            logger.LogInformation(JsonConvert.DeserializeObject(content).ToString().Trim('{', '}'));\n        }\n</code></pre>\n\n<p>And this is what i already tried for the Fileupload. Where is my error?</p>\n\n<pre><code>private void SendFileToRocketChat()\n        {\n            var url = \"https://example-sw.net/api/v1/rooms.upload/:gdfgfgdkTXAPWsQ9\";\n            var filePath = \"Abbildung13.jpg\";\n\n            var httpClient = (HttpWebRequest)WebRequest.Create(new Uri(url));\n            httpClient.Method = \"POST\";\n            httpClient.Headers.Add(\"X-Auth-Token\", \"4ZLqSyN9IEhEdLgfd8S0eGPEFdfS9C\");\n            httpClient.Headers.Add(\"X-User-Id\", \"rocket.cat\");\n            httpClient.ContentType = \"multipart/form-data\";\n\n            MultipartFormDataContent form = new MultipartFormDataContent();\n\n            FileStream fs = File.OpenRead(filePath);\n            var streamContent = new StreamContent(fs);\n\n            var imageContent = new ByteArrayContent(streamContent.ReadAsByteArrayAsync().Result);\n            imageContent.Headers.ContentType = MediaTypeHeaderValue.Parse(\"multipart/form-data\");\n\n            imageContent.Headers.ContentType = MediaTypeHeaderValue.Parse(\"multipart/form-data\");\n\n            form.Add(imageContent, \"file\", Path.GetFileName(filePath));\n            form.Add(imageContent, \"msg\", \"This is a message with a file\");\n            form.Add(imageContent, \"description\", \"Simple text file\");\n\n            var response = httpClient.GetResponse();\n\n            var stream = response.GetResponseStream();\n            var sr = new StreamReader(stream);\n            var content = sr.ReadToEnd();\n            logger.LogInformation(JsonConvert.DeserializeObject(content).ToString().Trim('{', '}'));\n        }\n</code></pre>\n"}, {"tags": ["c#", "visual-studio-code", "vscode-debugger"], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 3736114, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4aa47c0b671ef794d5b48e31d1704327?s=128&d=identicon&r=PG&f=1", "display_name": "user3736114", "link": "https://stackoverflow.com/users/3736114/user3736114"}, "edited": false, "score": 1, "creation_date": 1564002076, "post_id": 57191133, "comment_id": 100892002, "body": "I&#39;m using vs code. They&#39;re also my own csproj files. It shouldn&#39;t need to download them. They&#39;re all in a bin that the debugger is aware of (I say this because it finds the other csproj pdb files)"}], "tags": [], "owner": {"reputation": 181, "user_id": 11652796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4b0d5881d8edd01de8e3607aec89e3?s=128&d=identicon&r=PG&f=1", "display_name": "Eva", "link": "https://stackoverflow.com/users/11652796/eva"}, "is_accepted": false, "score": 0, "last_activity_date": 1564001832, "creation_date": 1564001832, "answer_id": 57191133, "question_id": 57190974, "link": "https://stackoverflow.com/questions/57190974/vs-code-cannot-find-or-open-the-pdb-file-even-though-the-pdb-exists-and-it-loa/57191133#57191133", "title": "VS Code &quot;Cannot find or open the PDB file&quot; even though the pdb exists and it loads other csproj pdb files", "body": "<p>Try Tools-> Options-> Debugging-> Symbols. Select checkbox \"Microsoft Symbol Servers\".\n Visual Studio will download PDBs automatically. Let me know if it does not work.</p>\n"}, {"tags": [], "owner": {"reputation": 399, "user_id": 3736114, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4aa47c0b671ef794d5b48e31d1704327?s=128&d=identicon&r=PG&f=1", "display_name": "user3736114", "link": "https://stackoverflow.com/users/3736114/user3736114"}, "is_accepted": true, "score": 0, "last_activity_date": 1564002774, "creation_date": 1564002774, "answer_id": 57191335, "question_id": 57190974, "link": "https://stackoverflow.com/questions/57190974/vs-code-cannot-find-or-open-the-pdb-file-even-though-the-pdb-exists-and-it-loa/57191335#57191335", "title": "VS Code &quot;Cannot find or open the PDB file&quot; even though the pdb exists and it loads other csproj pdb files", "body": "<p>Setting debug type to portable in the csproj file worked. </p>\n\n<pre><code> &lt;PropertyGroup&gt;\n   &lt;DebugType&gt;portable&lt;/DebugType&gt;\n &lt;/PropertyGroup&gt;\n</code></pre>\n"}], "owner": {"reputation": 399, "user_id": 3736114, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4aa47c0b671ef794d5b48e31d1704327?s=128&d=identicon&r=PG&f=1", "display_name": "user3736114", "link": "https://stackoverflow.com/users/3736114/user3736114"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 0, "accepted_answer_id": 57191335, "answer_count": 2, "score": 2, "last_activity_date": 1564002774, "creation_date": 1564001109, "last_edit_date": 1564002172, "question_id": 57190974, "link": "https://stackoverflow.com/questions/57190974/vs-code-cannot-find-or-open-the-pdb-file-even-though-the-pdb-exists-and-it-loa", "title": "VS Code &quot;Cannot find or open the PDB file&quot; even though the pdb exists and it loads other csproj pdb files", "body": "<p>I'm launching a web api project and I noticed the problem when I tried to set a breakpoint in the logic layer (which is a separate csproj) and it showed unverified breakpoint. </p>\n\n<p>Digging into it I found that the Debug console shows \"Cannot find or open the PDB file\" even though the pdb file exists in the directory it searches AND it can load the other 7 csproj dll's that are in the same directory.</p>\n\n<p>I've tried cleaning and rebuilding, deleting the repo and recloning, restarting my computer, etc. Not sure how to proceed or what other information to provide. Please help because this will keep me from using vs code. </p>\n"}, {"tags": ["c#", "printing"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1564001779, "post_id": 57190951, "comment_id": 100891895, "body": "You are trying to print a pdf file?  See <a href=\"https://stackoverflow.com/q/11579624/719186\">How to print a PDF with C#</a>"}, {"owner": {"reputation": 47, "user_id": 1148597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f01333ecee118167255cdd406baf0da1?s=128&d=identicon&r=PG", "display_name": "Tony Sullivan", "link": "https://stackoverflow.com/users/1148597/tony-sullivan"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1564004241, "post_id": 57190951, "comment_id": 100892709, "body": "No, trying to print to a postscript printer driver."}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1564007948, "post_id": 57190951, "comment_id": 100893701, "body": "Maybe try <a href=\"https://stackoverflow.com/a/6911828/719186\">How to send raw data to a printer</a>"}, {"owner": {"reputation": 47, "user_id": 1148597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f01333ecee118167255cdd406baf0da1?s=128&d=identicon&r=PG", "display_name": "Tony Sullivan", "link": "https://stackoverflow.com/users/1148597/tony-sullivan"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1564171993, "post_id": 57190951, "comment_id": 100957152, "body": "Thanks, not trying to send raw data to the printer though. I was trying to print using the Windows print driver. I never found a way to access the printer object on a non-event basis, so I just wrote my code to operate using the existing event based model. It just makes a relatively simple process look way over complicated."}], "owner": {"reputation": 47, "user_id": 1148597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f01333ecee118167255cdd406baf0da1?s=128&d=identicon&r=PG", "display_name": "Tony Sullivan", "link": "https://stackoverflow.com/users/1148597/tony-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1564000994, "creation_date": 1564000994, "question_id": 57190951, "link": "https://stackoverflow.com/questions/57190951/how-to-print-multi-page-form-letters-in-c", "title": "How to print multi-page form letters in c#", "body": "<p>I am in the process of converting a VB6 program that creates two page form letters for several thousand individuals each week. These letters are legally mandated, not junk mail. The letters are printed as one document to a postscript printer driver so that they can be both sent directly to a printer and converted to a PDF for archival purposes. </p>\n\n<p>I am having difficulty determining how I can go about this using c#. All of the examples I have seen for printing from c# use the PrintPageEventHandler to handle the printing, but I don't see a way to use this without having created all of the form letters before even starting the print routine. Am I missing something?</p>\n\n<p>The code I am converting works like this:</p>\n\n<p>Loop through all groups that have letters\n   Loop through all members in each group who need letters\n      Send page one of the letter to the printer\n      Send page two of the letter to the printer</p>\n\n<p>When the routine is finished there is one postscript file that has five thousand or so pages in it. That file is then sent to the printer and also converted to a PDF for archival.</p>\n\n<p>Is there a non-event way of printing to a printer in c#? This is a console application if that is important.</p>\n"}, {"tags": ["c#", "sql-server", "powershell", "xmla"], "comments": [{"owner": {"reputation": 1191, "user_id": 9541862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fe5271e65a59c7c1be5a45b618b078?s=128&d=identicon&r=PG&f=1", "display_name": "quaabaam", "link": "https://stackoverflow.com/users/9541862/quaabaam"}, "edited": false, "score": 1, "creation_date": 1564511666, "post_id": 57190762, "comment_id": 101052760, "body": "Have you tried using Microsoft.AnalysisServices.dll, as this link&#39;s selected answer did...<a href=\"https://stackoverflow.com/questions/33260674/run-xmla-file-analysis-services-from-command-line\" title=\"run xmla file analysis services from command line\">stackoverflow.com/questions/33260674/&hellip;</a>"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 1, "creation_date": 1564755453, "post_id": 57190762, "comment_id": 101146628, "body": "The commands in Power Shell are really running the sqlcmd.exe command line utility (<a href=\"https://docs.microsoft.com/en-us/sql/tools/command-prompt-utility-reference-database-engine?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/tools/&hellip;</a>).  So you can either setup a bat file with the same commands that are in your Power Shell and execute with Process class or make the Power Shell Parameters Parameters to the Process class.  I usually put the output of sqlcmd.exe into a CSV file and then read the results of the csv into my c# program."}], "answers": [{"comments": [{"owner": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "edited": false, "score": 0, "creation_date": 1565098209, "post_id": 57362982, "comment_id": 101238867, "body": "I&#39;ll try this. Thanks!"}, {"owner": {"reputation": 619, "user_id": 1136496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5bdda977c118e3bb76f52fccd506e1?s=128&d=identicon&r=PG", "display_name": "jogi", "link": "https://stackoverflow.com/users/1136496/jogi"}, "reply_to_user": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "edited": false, "score": 1, "creation_date": 1565190228, "post_id": 57362982, "comment_id": 101276371, "body": "fyi my answer was pieced together from this MSDN <a href=\"https://social.msdn.microsoft.com/Forums/sqlserver/en-US/c4c28b83-bc79-4400-bae9-709f533d66fb/how-to-run-xmla-file-in-c-sharp?forum=sqldatamining\" rel=\"nofollow noreferrer\">forum post</a>."}], "tags": [], "owner": {"reputation": 619, "user_id": 1136496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5bdda977c118e3bb76f52fccd506e1?s=128&d=identicon&r=PG", "display_name": "jogi", "link": "https://stackoverflow.com/users/1136496/jogi"}, "is_accepted": true, "score": 1, "last_activity_date": 1565024192, "creation_date": 1565024192, "answer_id": 57362982, "question_id": 57190762, "link": "https://stackoverflow.com/questions/57190762/xmla-deployment-to-sql-using-c/57362982#57362982", "title": ".xmla deployment to SQL using C#", "body": "<pre><code>using Microsoft.AnalysisServices.AdomdClient;\n\ntry\n{\n    var xmlaFileContents = File.ReadAllText(\"path/to/your/file.xmla\");\n\n    using (AdomdCommand cmd = conn.CreateCommand())\n    {\n        cmd.CommandText = xmlaFileContents;\n        cmd.ExecuteNoQuery();\n    }\n}\ncatch(Exception)\n{\n}\n</code></pre>\n\n<p>** please note that I have not run this code **</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 3178666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/022f23ed24e04848e72e435b681656d2?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/3178666/rob"}, "is_accepted": false, "score": 1, "last_activity_date": 1565104650, "creation_date": 1565104650, "answer_id": 57379205, "question_id": 57190762, "link": "https://stackoverflow.com/questions/57190762/xmla-deployment-to-sql-using-c/57379205#57379205", "title": ".xmla deployment to SQL using C#", "body": "<p>As the AdomdConnection is inherited from IDbConnection, it's pretty similar to how the SqlConnection works, and therefor, similar syntax can be used, as @jogi presented for you.</p>\n\n<p>I wrote a PS function a few years back which we use in TFS builds. It uses the .NET assemblies rather than the PS layer, so I figured since you seem savvy in PS, you can perhaps get something out of it. Still essentially the same as what @jogi wrote, only wrapped in PS.</p>\n\n<pre><code>function Invoke-XmlaScript {\n[CmdletBinding()] param (\n    [Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$ServerInstance,\n    [Parameter(Mandatory=$true)][ValidateNotNullOrEmpty()][string]$XmlaScript\n)\nprocess {\n    $connection = New-Object Microsoft.AnalysisServices.AdomdClient.AdomdConnection(\"Data Source=$ServerInstance;Provider=MSOLAP.4;Integrated Security=SSPI;Impersonation Level=Impersonate;\")\n    $connection.Open()\n    try {\n        $command = $connection.CreateCommand()\n        $command.CommandTimeout = 20000\n        $command.CommandType = [System.Data.CommandType]::Text\n        $command.CommandText = $Xmla\n        $reader = $command.ExecuteXmlReader()\n        if($reader.Read()) {\n            Write-Output $reader.ReadOuterXml()\n        }\n    }\n    catch { }\n    $connection.Dispose()\n}\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 57362982, "answer_count": 2, "score": 3, "last_activity_date": 1565104650, "creation_date": 1564000072, "question_id": 57190762, "link": "https://stackoverflow.com/questions/57190762/xmla-deployment-to-sql-using-c", "title": ".xmla deployment to SQL using C#", "body": "<p>I use <code>Invoke-ASCmd</code> in PowerShell right now to create a database in SQL Server, like this:</p>\n\n<p><code>Invoke-ascmd -Query $MyScript -Server $ASServer</code></p>\n\n<p>Where <code>$MyScript</code> is a string holding the contents of an .xmla file that I read in previously.</p>\n\n<p>This works great. Now I need to do something similar in C#, but am unable to find a simple solution like the one that exists in PowerShell.</p>\n\n<p>I see some people using a Microsoft DLL called <code>Microsoft.AnalysisServices.XMLA.dll</code>, but it's not supported, and the class in question is \"internal\", so I can't even reference it.</p>\n\n<p>I found this DLL <code>Microsoft.AnalysisServices.AdomdClient.dll</code> while searching around, but don't see any of the classes being relevant to what I need: <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.analysisservices.adomdclient?view=analysisservices-dotnet\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/api/microsoft.analysisservices.adomdclient?view=analysisservices-dotnet</a></p>\n"}, {"tags": ["c#", "sqlite", "dapper", "system.data.sqlite"], "comments": [{"owner": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 0, "creation_date": 1564002438, "post_id": 57190758, "comment_id": 100892128, "body": "Another reminder to get Chic up and running :( ; But! Can you post the target class? Have you tried using ` Dapper.ExecuteQuery&lt;DestinationClass&gt;(query)` at all?"}, {"owner": {"reputation": 12968, "user_id": 86431, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a90d03e6464b450b1fb50aaaf35885b?s=128&d=identicon&r=PG", "display_name": "Eric Brown - Cal", "link": "https://stackoverflow.com/users/86431/eric-brown-cal"}, "reply_to_user": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 0, "creation_date": 1564066684, "post_id": 57190758, "comment_id": 100916913, "body": "The target class is the first item in the top code block, called UsrMiniDto."}, {"owner": {"reputation": 12968, "user_id": 86431, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a90d03e6464b450b1fb50aaaf35885b?s=128&d=identicon&r=PG", "display_name": "Eric Brown - Cal", "link": "https://stackoverflow.com/users/86431/eric-brown-cal"}, "reply_to_user": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 0, "creation_date": 1564067133, "post_id": 57190758, "comment_id": 100917171, "body": "ExecuteQuery doesn&#39;t seem to be an extension on IDBCOnnection, or a member of Dapper, how do i call it?  Also what&#39;s Chic, can&#39;t get a useful looking google result, Thanks,"}, {"owner": {"reputation": 12968, "user_id": 86431, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a90d03e6464b450b1fb50aaaf35885b?s=128&d=identicon&r=PG", "display_name": "Eric Brown - Cal", "link": "https://stackoverflow.com/users/86431/eric-brown-cal"}, "reply_to_user": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 1, "creation_date": 1564067701, "post_id": 57190758, "comment_id": 100917473, "body": "Found it, System.Data.Linq"}, {"owner": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 1, "creation_date": 1564068341, "post_id": 57190758, "comment_id": 100917807, "body": "Sorry, that was a typeo on my part, Dapper is .Execute. I have a pet project for Dapper that I&#39;ve been calling <i>Chic</i> and I just really need to get it available as it would give you what you want (I believe) pretty easily."}, {"owner": {"reputation": 12968, "user_id": 86431, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a90d03e6464b450b1fb50aaaf35885b?s=128&d=identicon&r=PG", "display_name": "Eric Brown - Cal", "link": "https://stackoverflow.com/users/86431/eric-brown-cal"}, "reply_to_user": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 0, "creation_date": 1564069419, "post_id": 57190758, "comment_id": 100918407, "body": "So it&#39;s not in dapper? am i off target? is this what you meant?"}, {"owner": {"reputation": 12968, "user_id": 86431, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a90d03e6464b450b1fb50aaaf35885b?s=128&d=identicon&r=PG", "display_name": "Eric Brown - Cal", "link": "https://stackoverflow.com/users/86431/eric-brown-cal"}, "reply_to_user": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 0, "creation_date": 1564071939, "post_id": 57190758, "comment_id": 100919630, "body": "Connection.Execute doesn&#39;t have a form like List&lt;T&gt; db.Execute&lt;T&gt;(sql), just int db.Execute(sql)."}, {"owner": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 0, "creation_date": 1564083899, "post_id": 57190758, "comment_id": 100924767, "body": "You are right, Sorry I&#39;ve been sort of speed responding on mobile.   What I&#39;m not sure how it&#39;s happening: Your generated query is missing the aliases for the columns. <code>SELECT u.user_id ,u.user_active </code> should be ` SELECT u.user_id UserId ,u.user_active UserActive `. Is that straight from the debugger?"}, {"owner": {"reputation": 12968, "user_id": 86431, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a90d03e6464b450b1fb50aaaf35885b?s=128&d=identicon&r=PG", "display_name": "Eric Brown - Cal", "link": "https://stackoverflow.com/users/86431/eric-brown-cal"}, "reply_to_user": {"reputation": 4363, "user_id": 2040569, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/78834c6b2f1bb61025b0d29ae59af530?s=128&d=identicon&r=PG&f=1", "display_name": "Austin T French", "link": "https://stackoverflow.com/users/2040569/austin-t-french"}, "edited": false, "score": 0, "creation_date": 1564087759, "post_id": 57190758, "comment_id": 100926264, "body": "That&#39;s not my generated query, that&#39;s the query I passing in. Is there a log where I can see the generated query?  I&#39;ve tried manually adding the aliases and turning use underscores off, and I get the same results, column n is getting the value of n-1  I&#39;m trying to build a local copy of dapper so I can debug, but it&#39;s refusing to see my .netcore 2.1 sdk install.."}], "owner": {"reputation": 12968, "user_id": 86431, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a90d03e6464b450b1fb50aaaf35885b?s=128&d=identicon&r=PG", "display_name": "Eric Brown - Cal", "link": "https://stackoverflow.com/users/86431/eric-brown-cal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 996, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1564162205, "creation_date": 1564000060, "last_edit_date": 1564162205, "question_id": 57190758, "link": "https://stackoverflow.com/questions/57190758/dapper-mapping-issue", "title": "Dapper mapping issue", "body": "<p>I'm having trouble getting Dapper to map sql results from a local sqlite Db to our entity type objects.</p>\n\n<p>It keeps trying to map column n-1 to column n, which causes it to die when mapping to a DateTime (as the previous column will not convert)</p>\n\n<p>Exception msg :Error parsing column 2 (user_pswd_exp_dt=Y - String)</p>\n\n<p>Here is a simplified version which reproduces the issue for me.</p>\n\n<pre><code> public class UsrMiniDto : IDto\n    {\n\n        [Column( \"user_id\" )]\n        public Int64 UserId { get; set; }\n\n        [Column( \"user_active\" )]\n        public string UserActive { get; set; }\n\n        [Column( \"user_pswd_exp_dt\" )]\n        public DateTime? UserPswdExpDt { get; set; }\n\n        [Column( \"add_user\" )]\n        public string AddUser { get; set; }\n\n        [Column( \"add_dt\" )]\n        public DateTime AddDt { get; set; }\n\n\n    }\n\n\npublic List&lt;UsrMiniDto&gt; GetMiniUsrByUsrName( string usrName )\n        {\n            StringBuilder sql = new StringBuilder();\n\n            sql.Append( \"SELECT  u.user_id ,\" );\n            sql.Append( \"u.user_active ,\" );\n            sql.Append( \"u.user_pswd_exp_dt   \" );//as UserPswdExpDt\n            //sql.Append( \", u.add_user ,\" );\n            //sql.Append( \"u.add_dt  \" );\n            sql.Append( \" FROM \" );\n            sql.Append( \" usr u\" );\n            sql.Append( \" WHERE u.user_login_name = :usrName\" );\n\n            List&lt;UserInput&gt; listUserInput = new List&lt;UserInput&gt;();\n            listUserInput.Add( new UserInput( \":usrName\", \"System.String\", usrName ) );\n\n            ICustomFixSql customFixSql = ObjectFactory.GetInstance&lt;ICustomFixSql&gt;();\n\n            string mainSql = customFixSql.BuildSqlFromUserArgs(sql.ToString(), listUserInput);\n\n            try\n            {\n                DapperCustomMapping&lt;UsrMiniDto&gt;();\n                return SqliteGetList&lt;UsrMiniDto&gt;( mainSql );\n\n            }\n            catch ( Exception ex )\n            {\n                throw;\n            }\n\n        }\n\npublic virtual List&lt;T&gt; SqliteGetList&lt;T&gt;(string mainSql)\n        {\n            List&lt;T&gt; x;\n            using ( SQLiteConnection connection = GetSqLiteConnection() )\n            {\n                //dapper\n                x = connection.Query&lt;T&gt;( mainSql ).ToList();\n            }\n            return x;\n        }\n\n    protected void DapperCustomMapping&lt;T&gt;()\n    {\n        // custom mapping\n        var map = new CustomPropertyTypeMap(typeof(T),\n                                            (type, columnName) =&gt; type.GetProperties().FirstOrDefault(prop =&gt; GetDescriptionFromAttribute(prop) == columnName));\n        SqlMapper.SetTypeMap( typeof( T ), map );\n\n    }\n\n\n\n   private string GetDescriptionFromAttribute( System.Reflection.MemberInfo member )// this lets you override bad mappings via teh column attribute - EWB\n    {\n        if ( member == null ) return null;\n\n        var attrib = (ColumnAttribute)Attribute.GetCustomAttribute(member, typeof(ColumnAttribute), false);\n        return attrib == null ? null : attrib.Name;\n    }\n</code></pre>\n\n<p>Originally i was default mapping and got this issue once i turn on the setting to map using underscores (didnt'map at all before)</p>\n\n<p>I tried renaming the columns to match the DTo name in the Sql. No Joy, then as you can see above i tried using the column attribute to specify the exact column, and it still miss mapps the column off by one.</p>\n\n<p>Here is the Sql Generated by my code and passed to Dapper in the query method.</p>\n\n<pre><code>SELECT  u.user_id ,u.user_active ,u.user_pswd_exp_dt    FROM  usr u WHERE u.user_login_name = 'KainJesi' \n</code></pre>\n\n<p>Here is the Row returned.\nuser_id user_active user_pswd_exp_dt<br>\n66657   Y           1/1/2099 12:00:00 AM</p>\n\n<p>As you can see, user_active, is incorrectly trying to be mapped to UserPswdExpDt.</p>\n\n<p>I'm an utter noob at Dapper, i literally  downloaded it and started using it Saturday.</p>\n\n<p>what am I doing wrong?</p>\n\n<p>I'm in .Net 4.5.2, so i cant' use Dapper.Dimplecrud, which is how our other teams seems to have solved this issue.</p>\n\n<p>-------update</p>\n\n<p>Per comment i converted it to ExecuteQuery in Linq2sql, thusly</p>\n\n<pre><code>public List&lt;UsrMiniDto&gt; GetMiniUsrByUsrName( string usrName )\n        {\n            StringBuilder sql = new StringBuilder();\n\n            sql.Append( \"SELECT  u.user_id as UserId,\" );\n            sql.Append( \"u.user_active as UserActive,\" );\n            sql.Append( \"u.user_pswd_exp_dt  as UserPswdExpDt \" );//as UserPswdExpDt\n            //sql.Append( \", u.add_user as AddUser,\" );\n            //sql.Append( \"u.add_dt as AddDt \" );\n            sql.Append( \" FROM \" );\n            sql.Append( \" usr u\" );\n            sql.Append( \" WHERE u.user_login_name = :usrName\" );\n\n            List&lt;UserInput&gt; listUserInput = new List&lt;UserInput&gt;();\n            listUserInput.Add( new UserInput( \":usrName\", \"System.String\", usrName ) );\n\n            ICustomFixSql customFixSql = ObjectFactory.GetInstance&lt;ICustomFixSql&gt;();\n\n            string mainSql = customFixSql.BuildSqlFromUserArgs(sql.ToString(), listUserInput);\n\n            try\n            {\n                //DapperCustomMapping&lt;UsrMiniDto&gt;();\n                //return SqliteGetList&lt;UsrMiniDto&gt;( mainSql );\n                return SqliteGetList2&lt;UsrMiniDto&gt;( mainSql );\n\n\n            }\n            catch ( Exception ex )\n            {\n                throw;\n            }\n\n        }\n\npublic virtual List&lt;T&gt; SqliteGetList2&lt;T&gt;( string mainSql )\n        {\n\n            // show complete SQL in log...JK\n            INetLog log = ObjectFactory.GetInstance&lt;INetLog&gt;();\n\n            log.Debug( \"SqliteGetList&lt;T&gt;(string mainSql = '\" + mainSql + \"')\" );\n\n            List&lt;T&gt; x;\n            using ( SQLiteConnection connection = GetSqLiteConnection() )\n            {\n\n                //dapper\n                //x = connection.Query&lt;T&gt;( mainSql ).ToList();\n\n                //linq 2 sql\n                DataContext dc = new DataContext(connection);\n                x = dc.ExecuteQuery&lt;T&gt;(mainSql).ToList();\n            }\n            return x;\n        }\n</code></pre>\n\n<p>and i get the Exception \"String was not recognized as a valid DateTime.\"</p>\n\n<p>Which sounds like the same \"Y\" is getting mapped to a dateTime issue. But I still don't know WHY it's mapping column n-1 to n.. Any help is greatly appreciated.</p>\n\n<p>Notes: This appears to be a sqlite specific issue, if I swap teh connection to point to one of our dev Dbs it works fine. if i point it to my local sqlitedb, it crashes again.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "linq"], "answers": [{"tags": [], "owner": {"reputation": 942, "user_id": 821807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o9ZY5.png?s=128&g=1", "display_name": "outbred", "link": "https://stackoverflow.com/users/821807/outbred"}, "is_accepted": false, "score": 1, "last_activity_date": 1564001453, "creation_date": 1564001453, "answer_id": 57191054, "question_id": 57190734, "link": "https://stackoverflow.com/questions/57190734/how-would-i-create-a-dynamic-total-on-field-name-in-c/57191054#57191054", "title": "How would I create a dynamic total on field name in C#?", "body": "<p>Do you mean something like this, that uses grouping?</p>\n\n<pre><code>public class Person\n{\n    public bool IsActive { get; set; }\n    public List&lt;Activity&gt; Activities { get; set; }\n    public string Name { get; set;}\n}\n\npublic class Activity\n{\n    public string ActivityType { get; set; }\n    public uint Hours { get; set; }\n}\n\npublic class Example\n{\n    private const uint Threshold = 60;\n    public void CheckHours(IEnumerable&lt;Person&gt; persons)\n    {\n        foreach (var person in persons)\n        {\n            var grouped = (from a in person.Activities\n                group a by a.ActivityType\n                into groupedActivities\n                    select new { Activity = groupedActivities.Key, TotalHours = groupedActivities.Sum(g =&gt; g.Hours)}).ToList();\n\n            foreach (var group in grouped)\n            {\n                if(group.TotalHours &gt; Threshold)\n                    throw new Exception($\"Activity {group.Activity} for person {person.Name} has exceeded the threshold!\");\n            }\n\n        }\n    }\n}\n</code></pre>\n\n<p>The CheckHours method will throw an exception for any activity for a person with total hours > 60.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7475309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45407b3f552f4de79d53f4a00768223a?s=128&d=identicon&r=PG&f=1", "display_name": "ZigZag", "link": "https://stackoverflow.com/users/7475309/zigzag"}, "is_accepted": false, "score": 1, "last_activity_date": 1564001642, "creation_date": 1564001642, "answer_id": 57191095, "question_id": 57190734, "link": "https://stackoverflow.com/questions/57190734/how-would-i-create-a-dynamic-total-on-field-name-in-c/57191095#57191095", "title": "How would I create a dynamic total on field name in C#?", "body": "<p>You need to use GroupBy to group elements with same ActivityType, and them use sum on each group. New {} is an anonymous type </p>\n\n<pre><code>var result = Activities.GroupBy((x) =&gt; x.ActivityType)\n                       .Select((x) =&gt; new { Name = x.Key, Hours = x.Sum((z) =&gt; z.Hours) });\n</code></pre>\n\n<p>and also for your validation you can use this </p>\n\n<pre><code>if (!result.All((x) =&gt; x.Hours &lt;= 60)) validations.Add(string.Format(\"Each activity may only have up to 60 hours per week.\"));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11832710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6dedc2cdc58289f404777ebe8c086dd?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Calder", "link": "https://stackoverflow.com/users/11832710/derek-calder"}, "is_accepted": false, "score": 1, "last_activity_date": 1564003593, "last_edit_date": 1564003593, "creation_date": 1564003226, "answer_id": 57191411, "question_id": 57190734, "link": "https://stackoverflow.com/questions/57190734/how-would-i-create-a-dynamic-total-on-field-name-in-c/57191411#57191411", "title": "How would I create a dynamic total on field name in C#?", "body": "<p>Here is a solution that uses LINQ GroupBy, and includes the name of the activity that failed validation.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>foreach (var activity in Activities.GroupBy(a =&gt; a.ActivityType, a =&gt; a.Hours))\n{\n    if (activity.Sum() &gt; 60)\n        validations.Add(string.Format($\"Each activity may only have up to 60 hours per week. {activity.Key} exceeds this.\"));\n}`\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 10576796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1da51ebcfbb5ca8247f3f3d0ad5456?s=128&d=identicon&r=PG&f=1", "display_name": "aplane1290", "link": "https://stackoverflow.com/users/10576796/aplane1290"}, "edited": false, "score": 0, "creation_date": 1564146341, "post_id": 57193037, "comment_id": 100945590, "body": "Thank you, this is exactly what I needed."}], "tags": [], "owner": {"reputation": 15446, "user_id": 7299782, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/nNfiq.png?s=128&g=1", "display_name": "Anu Viswan", "link": "https://stackoverflow.com/users/7299782/anu-viswan"}, "is_accepted": true, "score": 1, "last_activity_date": 1564017299, "creation_date": 1564017299, "answer_id": 57193037, "question_id": 57190734, "link": "https://stackoverflow.com/questions/57190734/how-would-i-create-a-dynamic-total-on-field-name-in-c/57193037#57193037", "title": "How would I create a dynamic total on field name in C#?", "body": "<p>You could Group By Activity and use Sum to achieve this.</p>\n\n<p>For example,</p>\n\n<pre><code>foreach(var activity in Activities.GroupBy(x=&gt;x.ActivityType).Select(x=&gt; new {ActivityType=x.Key,Hours=x.ToList().Sum(c=&gt;c.Hours)}).Where(x=&gt;x.Hours&gt;60))\n{\n    validations.Add($\"Activity {activity.ActivityType} exceeds permitted limit, Total Hours Spend ={activity.Hours}\");\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 10576796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1da51ebcfbb5ca8247f3f3d0ad5456?s=128&d=identicon&r=PG&f=1", "display_name": "aplane1290", "link": "https://stackoverflow.com/users/10576796/aplane1290"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 57193037, "answer_count": 4, "score": 0, "last_activity_date": 1564017299, "creation_date": 1563999916, "question_id": 57190734, "link": "https://stackoverflow.com/questions/57190734/how-would-i-create-a-dynamic-total-on-field-name-in-c", "title": "How would I create a dynamic total on field name in C#?", "body": "<p>My users can create any number of \"Activity\" objects. I need to write some code that will go through each of these \"Activity\" objects and count the \"Hours\" field based on each \"ActivityType\" field. Then it throws an error if the Hours total for any of the fields is over 60. (Optional: display the ActivityType that caused the error)</p>\n\n<p>Example:</p>\n\n<pre><code>{\n    \"Activity1\": {\n        \"ActivityType\": \"Swimming\",\n        \"Hours\": 40,\n    },\n    \"Activity2\": {\n        \"ActivityType\": \"Cycling\",\n        \"Hours\": 20,\n    }\n    \"Activity3\": {\n        \"ActivityType\": \"Cycling\",\n        \"Hours\": 50,\n    }\n    \"Activity4\": {\n        \"ActivityType\": \"Baseball\",\n        \"Hours\": 20,\n    }\n    \"Activity5\": {\n        \"ActivityType\": \"Baseball\",\n        \"Hours\": 20,\n    }\n}\n</code></pre>\n\n<p>Swimming Total: 40\nCycling Total: 70 &lt;- validation error message\nBaseball Total: 40</p>\n\n<p>My code used to count by Person, but now it should count by Activity. This code doesn't keep a tally per Activity, but rather for all activities on the page. So the \"foreach (var person in Persons)\" can be changed.</p>\n\n<pre><code>foreach (var person in Persons.Where(x =&gt; x.IsActive == true))\n    {\n       if (Activities.Where(x =&gt; x.ActivityType &gt; 0).Sum(Y =&gt; Y.Hours) &gt; 60)\n           validations.Add(string.Format(\"Each activity may only have up to 60 hours per week.\"));\n    }\n)\n</code></pre>\n\n<p>It should have a total per Activity, instead of the full total of 150.</p>\n"}, {"tags": ["c#", "out-of-memory"], "comments": [{"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 0, "creation_date": 1563999668, "post_id": 57190638, "comment_id": 100891143, "body": "You don&#39;t dispose your resources properly. Particularly, <code>MemoryStream</code> and <code>Bitmap</code> classes are <code>IDisposable</code> and you need to dispose them by wrapping into <code>using ()</code> statements to optimize usage of memory."}, {"owner": {"reputation": 11, "user_id": 10939329, "user_type": "registered", "profile_image": "https://graph.facebook.com/240167176859522/picture?type=large", "display_name": "Marin Sozanj Sekovic", "link": "https://stackoverflow.com/users/10939329/marin-sozanj-sekovic"}, "reply_to_user": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 0, "creation_date": 1563999822, "post_id": 57190638, "comment_id": 100891192, "body": "Can you give me an example please?"}, {"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 0, "creation_date": 1563999826, "post_id": 57190638, "comment_id": 100891196, "body": "There can be another reason of this behaviour though: <a href=\"https://stackoverflow.com/questions/4318563/c-sharp-out-of-memory-when-creating-bitmap\" title=\"c sharp out of memory when creating bitmap\">stackoverflow.com/questions/4318563/&hellip;</a>. But you still need to dispose the resources properly."}, {"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 0, "creation_date": 1563999924, "post_id": 57190638, "comment_id": 100891224, "body": "Sure, here is the official docs: <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/garbage-collection/using-objects\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/standard/garbage-collection/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 10939329, "user_type": "registered", "profile_image": "https://graph.facebook.com/240167176859522/picture?type=large", "display_name": "Marin Sozanj Sekovic", "link": "https://stackoverflow.com/users/10939329/marin-sozanj-sekovic"}, "reply_to_user": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 0, "creation_date": 1564000837, "post_id": 57190638, "comment_id": 100891572, "body": "I&#39;ve wrapped them both but i&#39;m still getting out of memory exception"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1564002706, "post_id": 57190638, "comment_id": 100892218, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/199468/c-sharp-image-clone-out-of-memory-exception\" title=\"c sharp image clone out of memory exception\">stackoverflow.com/questions/199468/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 10939329, "user_type": "registered", "profile_image": "https://graph.facebook.com/240167176859522/picture?type=large", "display_name": "Marin Sozanj Sekovic", "link": "https://stackoverflow.com/users/10939329/marin-sozanj-sekovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 772, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563999404, "creation_date": 1563999404, "question_id": 57190638, "link": "https://stackoverflow.com/questions/57190638/selenium-out-of-memory-exception", "title": "Selenium Out Of Memory Exception", "body": "<p>I'm getting the out of memory exception when i put my ChromeDriver to headless mode.I haven't noticed it happening while ChromeDriver is working normally but when i put it in \"headless\" mode I'm getting exception.</p>\n\n<p>The program is multi threaded and it should take the screenshot of captcha and convert it into base64.I've tried locking the method so only 1 thread can access but it's still happening.</p>\n\n<pre><code> lock (this)\n        {\n            string fileName = DateTime.Now.ToString(\"yyyy-MM-dd HH-mm-ss\") + \".png\";\n            Byte[] byteArray = ((ITakesScreenshot)driver).GetScreenshot().AsByteArray;\n            Bitmap screenshot = new Bitmap(new System.IO.MemoryStream(byteArray));\n            Rectangle croppedImage = new Rectangle(element.Location.X, element.Location.Y, element.Size.Width, element.Size.Height);\n            //EXCEPTION ON THE LINE BELOW\n            screenshot = screenshot.Clone(croppedImage, screenshot.PixelFormat);\n            screenshot.Save(String.Format(fileName, ImageFormat.Png));\n\n            byte[] imageArray = System.IO.File.ReadAllBytes(fileName);\n            string base64ImageRepresentation = Convert.ToBase64String(imageArray);\n            base64 = base64ImageRepresentation;\n            File.Delete(fileName);\n        }\n</code></pre>\n"}, {"tags": ["c#", "bridge.net"], "comments": [{"owner": {"reputation": 326, "user_id": 8063133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3dd9f55e35f79c1bc9810b8040c4dc3?s=128&d=identicon&r=PG", "display_name": "Fabr&#237;cio Murta", "link": "https://stackoverflow.com/users/8063133/fabr%c3%adcio-murta"}, "edited": false, "score": 1, "creation_date": 1564029993, "post_id": 57190589, "comment_id": 100897617, "body": "What led you to the assumption of using Bridge 1.12.0 to support .NET 2.0? Bridge projects were not supposed to be targetted against .NET 2 at any point in its history. By targetting .NET 2 you probably are making it so Bridge&#39;s implementation would never work at all."}, {"owner": {"reputation": 510, "user_id": 7331107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb38005afef63402c5202085735b99b4?s=128&d=identicon&r=PG&f=1", "display_name": "avenmia", "link": "https://stackoverflow.com/users/7331107/avenmia"}, "reply_to_user": {"reputation": 326, "user_id": 8063133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3dd9f55e35f79c1bc9810b8040c4dc3?s=128&d=identicon&r=PG", "display_name": "Fabr&#237;cio Murta", "link": "https://stackoverflow.com/users/8063133/fabr%c3%adcio-murta"}, "edited": false, "score": 0, "creation_date": 1564065244, "post_id": 57190589, "comment_id": 100916056, "body": "That&#39;s a good point. When I was doing the nuget package installation I would get errors saying the Bridge package required the project to target .NET framework &gt;= 4.0, until I downloaded version 1.12.0. I made a probably incorrect assumption that there were no framework compatibility issues then. I haven&#39;t been able to find documentation on what the framework requirements are for each version of Bridge."}], "answers": [{"comments": [{"owner": {"reputation": 510, "user_id": 7331107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb38005afef63402c5202085735b99b4?s=128&d=identicon&r=PG&f=1", "display_name": "avenmia", "link": "https://stackoverflow.com/users/7331107/avenmia"}, "edited": false, "score": 0, "creation_date": 1564070724, "post_id": 57205835, "comment_id": 100919034, "body": "Thank you this is really helpful! I&#39;m going to use Bridge to migrate from script sharp. It turns out that script sharp is the only thing holding the project to .NET 2.0 so once that&#39;s gone it should be on 4.0+ and won&#39;t have these issues."}], "tags": [], "owner": {"reputation": 326, "user_id": 8063133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3dd9f55e35f79c1bc9810b8040c4dc3?s=128&d=identicon&r=PG", "display_name": "Fabr&#237;cio Murta", "link": "https://stackoverflow.com/users/8063133/fabr%c3%adcio-murta"}, "is_accepted": true, "score": 2, "last_activity_date": 1564069457, "last_edit_date": 1592644375, "creation_date": 1564069457, "answer_id": 57205835, "question_id": 57190589, "link": "https://stackoverflow.com/questions/57190589/how-can-i-add-bridge-net-to-my-existing-c-project/57205835#57205835", "title": "How can I add Bridge.net to my existing c# project?", "body": "<p>Although I don't see a clear indication on what exact change triggered this .NET framework limitation in Bridge since version 1.13.0, Bridge was never meant to work under projects targetted against .NET Framework v2 (and not v1 also).</p>\n<p>Yet, between <a href=\"https://github.com/bridgedotnet/Bridge/compare/v1.12.1...v1.13.0\" rel=\"nofollow noreferrer\">versions 1.12.1 and 1.13.0</a> the NuGet packages were rearranged in the hierarchy they look nowadays (introducing the Bridge.Core, Bridge.Min, and other packages, that are pulled from the main Bridge one). And this probably triggered a means for NuGet to identify this issue while installing in a .NET v2 project instead of just getting undone references.</p>\n<p>That said, Bridge was always projected to reproduce .NET Framework 4 (down to 4.8.0), and thrives to reproduce the whole implementation where's possible. But there isn't a v2-focused version of Bridge, so .NET Framework project formats aren't supported by Bridge.</p>\n<p>Not to lose all hope, this does not necessarily mean it shouldn't work. If you do some at your own. By chance, yesterday we had somebody in the community share a <a href=\"https://github.com/samuelGrahame/DotNetFramework2\" rel=\"nofollow noreferrer\">.NET 2 project that claimed to output a simple &quot;Hello World&quot; with Bridge 17.9.0</a>. It was done by creating a .NET 4 project then switching to .NET 2 (public message in gitter). I see the project has <code>Bridge.dll</code> file copied and committed in the repo, so that may be also required to have Bridge working in that scenario.</p>\n<p>In case the message ever becomes unavailable in gitter, here's a transcript:</p>\n<blockquote>\n<p>@Jpard6991 i was looking at it, i just changed the .net framework in the bridge library to 2 using nodepad++ then removed the reference to the bridge.dll and re-added that dll. changed to target .Net Framework 2.0 i got it to and show hello world.</p>\n<p><a href=\"https://github.com/samuelGrahame/DotNetFramework2\" rel=\"nofollow noreferrer\">https://github.com/samuelGrahame/DotNetFramework2</a></p>\n</blockquote>\n<p>Notice the Bridge's implementation of mscorlib is probably not going to match .NET Framework's, if any methods or classes parameters are different between the two versions, the Bridge project will be getting .NET 4 syntax instead of 2 in this case.</p>\n"}], "owner": {"reputation": 510, "user_id": 7331107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb38005afef63402c5202085735b99b4?s=128&d=identicon&r=PG&f=1", "display_name": "avenmia", "link": "https://stackoverflow.com/users/7331107/avenmia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 57205835, "answer_count": 1, "score": 1, "last_activity_date": 1564069457, "creation_date": 1563999159, "question_id": 57190589, "link": "https://stackoverflow.com/questions/57190589/how-can-i-add-bridge-net-to-my-existing-c-project", "title": "How can I add Bridge.net to my existing c# project?", "body": "<p>I'm currently trying to add Bridge.net to upgrade from saltarelle. The project uses .net framework 2.0 so I downloaded Bridge version 1.12.0. I'm currently having an issue with the compiler detecting the updated Bridge attributes.</p>\n\n<p>I downloaded Bridge from the nuget package manager. I've tried cleaning and rebuilding the project, but it's still not recognizing Bridge.net attributes.</p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// Gets or sets Items to add\n    /// &lt;/summary&gt;\n    [Field]\n    [DataMember]\n    [SuppressMessage(\"Microsoft.Performance\", \"CA1819\", Justification = \"The object is a POCO, the fact that the array is writable is irrelevant.\")]\n    public UpdateData[] Items\n    {\n        get;\n        set;\n    }\n\n</code></pre>\n\n<p>The field attribute is not being a detected.</p>\n\n<p>I'm currently getting the following error: \nError   CS0246  The type or namespace name 'Field' could not be found (are you missing a using directive or an assembly reference?)</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1563999622, "post_id": 57190579, "comment_id": 100891130, "body": "There is no pre-built component that does this. You&#39;re going to have to write it yourself."}, {"owner": {"reputation": 197, "user_id": 6331229, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f6f6caa6017dfd2a40737c3fe2a38516?s=128&d=identicon&r=PG&f=1", "display_name": "Adithya.K", "link": "https://stackoverflow.com/users/6331229/adithya-k"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1564000110, "post_id": 57190579, "comment_id": 100891279, "body": "@Draco18s I understand that, but instead of creating the Elastic Bone using 3d modeling, is there alternate way to do that in unity? like using a cloth? im not that good with unity just trying to learn and build as i go, so whats the best way to get a full length slingshot effect ?"}, {"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1564000305, "post_id": 57190579, "comment_id": 100891357, "body": "There are 2 major questions in this post - the elastic band and the trajectory prediction. Asking both makes this post too broad - one of them should be removed. It can then be asked in a separate post."}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1564005575, "post_id": 57190579, "comment_id": 100893056, "body": "<i><code>like using a cloth?</code></i> See my earlier comment: <i><code>There is no pre-built component that does this.</code></i> Cloth is a pre-built component. There is no pre-built component that does what you want."}], "owner": {"reputation": 197, "user_id": 6331229, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f6f6caa6017dfd2a40737c3fe2a38516?s=128&d=identicon&r=PG&f=1", "display_name": "Adithya.K", "link": "https://stackoverflow.com/users/6331229/adithya-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563999116, "creation_date": 1563999116, "question_id": 57190579, "link": "https://stackoverflow.com/questions/57190579/how-to-get-the-slingshot-effect-elastic-band-with-trajectory-prediction-based", "title": "How to get the slingshot effect (elastic band) with trajectory prediction based on the pull and angle in 3d world", "body": "<p>first, im unable to create a elastic bad over my model (slingshot), is there any unity component (like cloth), that I can use that will give me the elastic band effect while the user pulls to launch a ball.</p>\n\n<p>Second, how to create a trajectory based on the elastic stretch and the angle of launch.</p>\n\n<p>Im able to do the math to launch a ball based on the amount of stretch and the angle of release, but is there a simple way to create elastic band (I am not a designer so I dont know how to create a model with a band and animate it in the gameplay).</p>\n\n<p>public class SlingShot : MonoBehaviour\n{</p>\n\n<pre><code>public GameObject launcher;\n\nprivate bool isAiming;\nprivate float sphereRadius;\n\npublic GameObject prefabBall;\npublic GameObject activeBall;\npublic float speedMultiplier = 16f;\n\nvoid Start()\n{\n    isAiming = false;\n    sphereRadius = this.GetComponent&lt;SphereCollider&gt;().radius;\n    activeBall = null;\n}\n\nprivate void OnMouseEnter()\n{\n    launcher.SetActive(true);\n}\n\nprivate void OnMouseExit()\n{\n    launcher.SetActive(false);\n}\n\nvoid Update()\n{\n    if (Input. GetMouseButton(0) &amp;&amp; !isAiming)\n    {\n        isAiming = true;\n        activeBall = Instantiate(prefabBall) as GameObject;\n        activeBall.transform.position = launcher.transform.position;\n        activeBall.GetComponent&lt;Rigidbody&gt;().isKinematic = true;\n    }\n    else if (isAiming &amp;&amp; (check if the mouse is released))\n    {\n        Vector3 mousePositionScreen = Input.mousePosition;\n        mousePositionScreen.z = Camera.main.transform.position.z;\n        Vector3 mousePositionWorld = Camera.main.ScreenToWorldPoint(mousePositionScreen);\n        Vector3 dragVector = mousePositionWorld - launcher.transform.position;\n\n        if (dragVector.magnitude &gt; sphereRadius)\n        {\n            dragVector.Normalize();\n            dragVector *= sphereRadius;\n        }\n\n        activeBall.transform.position = launcher.transform.position + dragVector;\n\n        if (isAiming)\n        {\n            isAiming = false;\n            Rigidbody rb = activeBall.GetComponent&lt;Rigidbody&gt;();\n            rb.isKinematic = false;\n            rb.velocity = -dragVector * speedMultiplier;\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>The above code helped me launch the ball but, im stuck how to create elastic band material that stretches with the pull and also the trajectory prediction of the ball based on the pull and angle</p>\n"}, {"tags": ["c#", "asp.net-core"], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 9943104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a597a4a4a7e026c164b851d70ca38139?s=128&d=identicon&r=PG&f=1", "display_name": "chelly", "link": "https://stackoverflow.com/users/9943104/chelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1564000159, "creation_date": 1564000159, "answer_id": 57190784, "question_id": 57190570, "link": "https://stackoverflow.com/questions/57190570/is-it-possible-to-map-this-kind-of-url-to-my-controller-action/57190784#57190784", "title": "Is it possible to map this kind of url to my controller action?", "body": "<p>You can use the <code>Route</code> attribute.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[Route(\"{id}\")]\npublic class DispatchController : Controller\n{\n    public IActionResult Index(string id)\n    {\n        // ...\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10503, "user_id": 9200675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PxESv.jpg?s=128&g=1", "display_name": "pfx", "link": "https://stackoverflow.com/users/9200675/pfx"}, "is_accepted": false, "score": 0, "last_activity_date": 1564001968, "last_edit_date": 1564001968, "creation_date": 1564001358, "answer_id": 57191035, "question_id": 57190570, "link": "https://stackoverflow.com/questions/57190570/is-it-possible-to-map-this-kind-of-url-to-my-controller-action/57191035#57191035", "title": "Is it possible to map this kind of url to my controller action?", "body": "<p>Since you are using conventional <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-2.2\" rel=\"nofollow noreferrer\">routing</a> (instead of attribute based routing), you can register the route below.  </p>\n\n<pre><code>routes.MapRoute(\n    name: \"id-only\",\n    template: \"{id}\",\n    defaults: new { controller = \"Dispatch\", action = \"Index\" }\n    );\n</code></pre>\n\n<p>Beware of the order of registration; in your case it should look like:</p>\n\n<pre><code>routes.MapRoute(\n    name: \"dispatch1\",\n    template: \"{controller=Dispatch}/{action=Index}\");\nroutes.MapRoute(\n    name: \"dispatch2\",\n    template: \"{controller=Dispatch}/{action=Index}/{id?}\");\nroutes.MapRoute(\n    name : \"areas\",\n    template : \"{area:exists}/{controller=Home}/{action=Index}/{id?}\"   \nroutes.MapRoute(\n    name: \"id-only\",\n    template: \"{id}\",\n    defaults: new { controller = \"Dispatch\", action = \"Index\" }\n    );\n</code></pre>\n\n<p><hr>\nNote that you can't combine attribute based routing and conventional routing \nwithin the same <code>Controller</code>.<br>\nFrom the <a href=\"https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/routing?view=aspnetcore-2.2#mixed-routing-attribute-routing-vs-conventional-routing\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p>Actions are either conventionally routed or attribute routed.<br>\n  Placing a route on the controller or the action makes it attribute routed.<br>\n  Actions that define attribute routes cannot be reached through the conventional routes and vice-versa. Any route attribute on the controller makes all actions in the controller attribute routed.</p>\n</blockquote>\n"}], "owner": {"reputation": 4698, "user_id": 461810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49c81c49603fee4d4ea52e30cd8841a8?s=128&d=identicon&r=PG", "display_name": "Dusan", "link": "https://stackoverflow.com/users/461810/dusan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564001968, "creation_date": 1563999077, "question_id": 57190570, "link": "https://stackoverflow.com/questions/57190570/is-it-possible-to-map-this-kind-of-url-to-my-controller-action", "title": "Is it possible to map this kind of url to my controller action?", "body": "<p>I have the following controller:</p>\n\n<pre><code>public class DispatchController : Controller\n{\n    public IActionResult Index(string id)\n    {\n        // ...\n    }\n}\n</code></pre>\n\n<p>Is there a way to map route (or something else) so that url like this one</p>\n\n<p><code>https://my-website.com/abcd</code></p>\n\n<p>properly resolve to my <code>Dispatch</code> controller, <code>Index</code> action and <code>abcd</code> as a value of <code>id</code> parameter?</p>\n\n<p>I have tried the following routes: </p>\n\n<pre><code>            routes.MapRoute(\n                name: \"dispatch1\",\n                template: \"{controller=Dispatch}/{action=Index}\");\n            routes.MapRoute(\n                name: \"dispatch2\",\n                template: \"{controller=Dispatch}/{action=Index}/{id?}\");\n            routes.MapRoute(\n                name : \"areas\",\n                template : \"{area:exists}/{controller=Home}/{action=Index}/{id?}\"\n</code></pre>\n\n<p><code>https://my-website.com</code> works fine, resolves fine (id is null)</p>\n\n<p><code>https://my-website.com/abcd</code> does not work, does not resolve (404)</p>\n"}, {"tags": ["c#", "authentication", "jwt", "claims-based-identity", ".net-core-2.2"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1563998968, "post_id": 57190466, "comment_id": 100890886, "body": "What version of ASP.NET Core are you using? Core 1 and Core 2 have very different auth designs. Also, are you getting a compiler error or a runtime issue? The parameter is name <code>token</code> but your code-sample is assigning <code>validatedToken</code>."}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1563999072, "post_id": 57190466, "comment_id": 100890932, "body": "@Dai Added the tag for Core 2.2 and corrected the typo (it got wrong when I formatted for nicer display)."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1563999412, "post_id": 57190466, "comment_id": 100891040, "body": "can you also please post your <code>AddAuthentication</code> part from your <code>Startup</code> class?"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1563999517, "post_id": 57190466, "comment_id": 100891087, "body": "Also, which <code>ISecurityTokenValidator</code> are you using? It&#39;s in multiple namespaces, like <code>System.IdentityModel</code>, <code>Microsoft.IdentityModel</code>, and others."}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1563999705, "post_id": 57190466, "comment_id": 100891157, "body": "@Dai Well, I&#39;ll be damned - that was highly unexpected. Otherwise I&#39;d mention that in the question. It&#39;s <i>Microsoft.IdentityModel.Tokens;</i>. I take they differ somehow?"}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1563999979, "post_id": 57190466, "comment_id": 100891240, "body": "@Dai I posted the full authentication assignment, as requested."}, {"owner": {"reputation": 6377, "user_id": 4753489, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/haFrH.png?s=128&g=1", "display_name": "Divyang Desai", "link": "https://stackoverflow.com/users/4753489/divyang-desai"}, "edited": false, "score": 0, "creation_date": 1564035139, "post_id": 57190466, "comment_id": 100899365, "body": "@KonradViltersten: I had same requirement, however, I have override <code>OnAuthorization</code> to custom validate."}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "reply_to_user": {"reputation": 6377, "user_id": 4753489, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/haFrH.png?s=128&g=1", "display_name": "Divyang Desai", "link": "https://stackoverflow.com/users/4753489/divyang-desai"}, "edited": false, "score": 0, "creation_date": 1564043645, "post_id": 57190466, "comment_id": 100903721, "body": "@Div When I implemented the <i>ISecurityTokenValidator</i> interface I didn&#39;t get any intellisense about overriding <i>OnAuthorization</i>. Where is it located?"}], "answers": [{"comments": [{"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "edited": false, "score": 0, "creation_date": 1564081867, "post_id": 57206817, "comment_id": 100923939, "body": "I&#39;m not sure if I get the point of the first link. The token returned there - what is it good for? I get that the token is out&#39;ed in the ValidateToken but I simply fail to understand why. The token (string form) is already available in the framework. Is the point to get in the (stringed) token, add som claims to it and return a new, updated version of it?"}], "tags": [], "owner": {"reputation": 1207, "user_id": 1513396, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/b5058f9659ef21c8ae53d784499777e1?s=128&d=identicon&r=PG", "display_name": "Edward", "link": "https://stackoverflow.com/users/1513396/edward"}, "is_accepted": false, "score": 1, "last_activity_date": 1564073465, "creation_date": 1564073465, "answer_id": 57206817, "question_id": 57190466, "link": "https://stackoverflow.com/questions/57190466/how-to-design-a-custom-validator-for-jwt-tokens-in-net-core/57206817#57206817", "title": "How to design a custom validator for JWT tokens in .NET Core?", "body": "<p>You're really talking about 2 different pieces, authentication (proving who you are) and authorization (what you can do).</p>\n\n<p>For the authentication,</p>\n\n<p>The 401 is probably caused by the <code>ValidFrom</code> and <code>ValidTo</code> properties not being set. They get set in the constructor. You may also be able to set the <code>ValidateLifetime</code> property on your <code>TokenValidationParameters</code> to false to get around it.</p>\n\n<p>Here's an example of the using the constructor:\n<a href=\"https://github.com/aspnet/AspNetCore/blob/c76cb9248de8966b25bc08b098b88d6734b96d09/src/Mvc/test/WebSites/SecurityWebSite/BearerAuth.cs#L38\" rel=\"nofollow noreferrer\">https://github.com/aspnet/AspNetCore/blob/c76cb9248de8966b25bc08b098b88d6734b96d09/src/Mvc/test/WebSites/SecurityWebSite/BearerAuth.cs#L38</a></p>\n\n<p>I believe the <code>401</code> redirect is done in the <code>HandleChallengeAsync</code> method on the <code>AuthenticationHandler</code>\nHere's that method:\n<a href=\"https://github.com/aspnet/AspNetCore/blob/c76cb9248de8966b25bc08b098b88d6734b96d09/src/Security/Authentication/JwtBearer/src/JwtBearerHandler.cs#L195\" rel=\"nofollow noreferrer\">https://github.com/aspnet/AspNetCore/blob/c76cb9248de8966b25bc08b098b88d6734b96d09/src/Security/Authentication/JwtBearer/src/JwtBearerHandler.cs#L195</a></p>\n\n<p>This is a grey area of authentication/authorization. The 401 in my mind would be authentication, where a 403 would be authorization. The decision as to whether or not to return the <code>401</code> challenge response and <code>403</code> forbidden response I'm pretty sure is done in the <code>AuthorizeAsync</code> method in the <code>PolicyEvaluator</code>.</p>\n\n<p><a href=\"https://github.com/aspnet/AspNetCore/blob/6526022f6c72eb98e9afb7dd77672c4340f00312/src/Security/Authorization/Policy/src/PolicyEvaluator.cs#L77\" rel=\"nofollow noreferrer\">https://github.com/aspnet/AspNetCore/blob/6526022f6c72eb98e9afb7dd77672c4340f00312/src/Security/Authorization/Policy/src/PolicyEvaluator.cs#L77</a></p>\n\n<p>I hope it helps.</p>\n\n<p>The set of claims is used by the policy evaluators for authorization.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/aspnet/core/security/authorization/policies?view=aspnetcore-2.2\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/aspnet/core/security/authorization/policies?view=aspnetcore-2.2</a></p>\n"}], "owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1973, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1564073465, "creation_date": 1563998619, "last_edit_date": 1564043734, "question_id": 57190466, "link": "https://stackoverflow.com/questions/57190466/how-to-design-a-custom-validator-for-jwt-tokens-in-net-core", "title": "How to design a custom validator for JWT tokens in .NET Core?", "body": "<p>I'm using authentication as follows.</p>\n\n<pre><code>TokenValidationParameters parameters = new TokenValidationParameters\n  {\n    ValidateIssuerSigningKey = false,\n    ValidateLifetime = true,\n    ValidateActor = false,\n    ValidateAudience = false,\n    ValidateIssuer = false,\n    ValidateTokenReplay = false,\n    IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(...)),\n    ClockSkew = TimeSpan.Zero\n  };\nservices.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)\n  .AddJwtBearer(options =&gt;\n  {\n    options.TokenValidationParameters = parameters;\n    options.SecurityTokenValidators.Add(new SecurityTokenValidator());\n  });\n</code></pre>\n\n<p>I've implemented <em>ISecurityTokenValidator</em> (Microsoft.IdentityModel.Tokens) and overriden <em>ValidateToken</em> method like this.</p>\n\n<pre><code>public ClaimsPrincipal ValidateToken(string securityToken,\n                                     TokenValidationParameters parameters,\n                                     out SecurityToken token)\n{\n  IIdentity identity = new ClaimsIdentity(new[] { new Claim(\"name\", \"donkey\") });\n  ClaimsPrincipal principal = new ClaimsPrincipal(identity);\n\n  token = new JwtSecurityToken();\n\n  return principal;\n}\n</code></pre>\n\n<p>The code was authorizing correctly previously but now, that I specified a custom validator, I only get <em>401 Unauthorized</em>. It's pretty obvious that I'm doing something wrong here and the main suspect is the <em>token</em> that's <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.identitymodel.tokens.jwt.jwtsecuritytokenhandler.validatetoken?view=azure-dotnet\" rel=\"nofollow noreferrer\">sparsely documented</a>.</p>\n\n<p>When I debug, I can see the contents of the token passed in but since the parameter is <em>out</em> I have to assign it and the compiler refuses to cooperate.</p>\n\n<ol>\n<li>Is the failure to validate due to the outed token being a dummy?</li>\n<li>Where is the method that returns a <em>bool</em> causing the 401 to appear?</li>\n<li>What is the point of returning a set of claims combined with validated token?</li>\n</ol>\n\n<p>I've been googling but fail to find specific info in this regard. It all drowns in the noise from a gazillion blogs copying examples from each other (and I might be ignorant of the proper search criteria).</p>\n\n<p>There's a few examples like <a href=\"https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/blob/master/src/System.IdentityModel.Tokens.Jwt/JwtSecurityTokenHandler.cs#L773\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://www.frakkingsweet.com/plain-and-simple-token-authentication-in-asp-net-core/\" rel=\"nofollow noreferrer\">this</a> but due to complexity, I'm not certain it's the right set up to follow. Others seem to be just reusing an instance of a <a href=\"https://www.jerriepelser.com/blog/manually-validating-rs256-jwt-dotnet/\" rel=\"nofollow noreferrer\"><em>JwtSecurityTokenHandler</em></a>, which doesn't seem like the custom validator I want.</p>\n"}, {"tags": ["c#", "delimiter"], "comments": [{"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 2, "creation_date": 1563998463, "post_id": 57190401, "comment_id": 100890649, "body": "just split the line by tokens (using either string-split or spans) and look at the pieces you want, and ignore all the rest?"}], "answers": [{"tags": [], "owner": {"reputation": 4490, "user_id": 3416551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1tRdb.png?s=128&g=1", "display_name": "pwilcox", "link": "https://stackoverflow.com/users/3416551/pwilcox"}, "is_accepted": true, "score": 1, "last_activity_date": 1563998735, "creation_date": 1563998735, "answer_id": 57190495, "question_id": 57190401, "link": "https://stackoverflow.com/questions/57190401/is-it-possible-to-get-specific-column-data-from-a-large-pipe-delimited-file-with/57190495#57190495", "title": "Is it possible to get specific column data from a large pipe delimited file without creating a class for every column?", "body": "<p>Well, you don't mention much as to how you're loading the file, but I imagine it is using System.IO and then doing a string split on each line.  If so, you need not extract every field in the resulting splitted array.</p>\n\n<p>Imagine you only needed two columns, the second and fourth, and had a class to accept each row as follows:</p>\n\n<pre><code>public class row {\n    public string field2;\n    public string field4;\n}\n</code></pre>\n\n<p>Then you would extract your data like this:</p>\n\n<pre><code>IEnumerable&lt;row&gt; parsed = \n    File.ReadLines(@\"path to file\")\n    .Skip(1)\n    .Select(line =&gt; {\n        var splitted = line.Split('|');\n        return new row { \n            field2 = splitted[1], \n            field4 = splitted[3] \n        };\n    });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 5415162, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1f9c49d9cf645c99a8a2aec82bac902c?s=128&d=identicon&r=PG&f=1", "display_name": "Roro", "link": "https://stackoverflow.com/users/5415162/roro"}, "is_accepted": false, "score": 0, "last_activity_date": 1563999285, "creation_date": 1563999285, "answer_id": 57190608, "question_id": 57190401, "link": "https://stackoverflow.com/questions/57190401/is-it-possible-to-get-specific-column-data-from-a-large-pipe-delimited-file-with/57190608#57190608", "title": "Is it possible to get specific column data from a large pipe delimited file without creating a class for every column?", "body": "<p>You could use the Microsoft.VisualBasic.FileIO reference and then do something like this: </p>\n\n<pre><code>using(var parser = new TextFieldParsser(file))\n{\nInt32 skipHeader = 0;\nparser.SetDelimiters(\"|\");\nwhile (!parser.EndOfData)\n{\n    //Processing row\n    string[] fields = parser.ReadFields();\n    Int32 x = 0;\n\n    if (skipHeader &gt; 0)\n    {\n        foreach (var field in fields)\n        {\n            if (x == 0)\n            {\n                //SAVE STUFF TO VARIABLE\n            }\n            else if (x==4)\n            {\n                //SAVE MORE STUFF\n            }\n            else if (x == 20)\n            {\n                //SAVE LAST STUFF\n\n                break;//THIS IS THE LAST COLUMN OF DATA NEEDED SO YOU BREAK\n            }\n\n            x++;\n        }\n        //DO SOMETHING WITH ALL THE SAVED STUFF AND CLEAR IT OUT\n    }\n    else\n    {\n        skipHeader++;\n    }\n}}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5340189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501ea37cbf9e498fdd7df54735f4c342?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby ", "link": "https://stackoverflow.com/users/5340189/bobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57190495, "answer_count": 2, "score": 0, "last_activity_date": 1563999285, "creation_date": 1563998283, "question_id": 57190401, "link": "https://stackoverflow.com/questions/57190401/is-it-possible-to-get-specific-column-data-from-a-large-pipe-delimited-file-with", "title": "Is it possible to get specific column data from a large pipe delimited file without creating a class for every column?", "body": "<p>I am writing a C# program that will grab some data from a pipe delimited file with 400 columns in it. I'm only required to work with 6 of the columns in each row. The file does not have headers, and the first line is a 5 column row with general description of file (file name, batch date, number of records, total, report id). Before I create a class with 400 fields in it, I was curious if anyone here had a better idea of how to approach this. Thanks for your time.</p>\n"}, {"tags": ["c#", "wpf"], "answers": [{"comments": [{"owner": {"reputation": 274, "user_id": 11830603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52678bf2f3c2f6428020e584ca4e8704?s=128&d=identicon&r=PG&f=1", "display_name": "startNet", "link": "https://stackoverflow.com/users/11830603/startnet"}, "edited": false, "score": 0, "creation_date": 1564002236, "post_id": 57190913, "comment_id": 100892059, "body": "This is not a problem here. When I set <code>Any CPU</code>, the database works but then the DLL does not work"}], "tags": [], "owner": {"reputation": 125, "user_id": 10647492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67c548efdf00dc89331bc56e47cd554?s=128&d=identicon&r=PG&f=1", "display_name": "slig_3", "link": "https://stackoverflow.com/users/10647492/slig-3"}, "is_accepted": false, "score": 0, "last_activity_date": 1564000842, "creation_date": 1564000842, "answer_id": 57190913, "question_id": 57190289, "link": "https://stackoverflow.com/questions/57190289/debugging-x64-with-sqlite/57190913#57190913", "title": "Debugging x64 with SQLite", "body": "<p>Have you tried changing your query to: </p>\n\n<pre><code>SELECT ID FROM [DatabaseName]..MAIN\n</code></pre>\n\n<p>Is the error occurring only when you're debugging?</p>\n"}, {"tags": [], "owner": {"reputation": 13840, "user_id": 1177147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/zHhAS.jpg?s=128&g=1", "display_name": "Mark Feldman", "link": "https://stackoverflow.com/users/1177147/mark-feldman"}, "is_accepted": false, "score": 0, "last_activity_date": 1564004998, "creation_date": 1564004998, "answer_id": 57191699, "question_id": 57190289, "link": "https://stackoverflow.com/questions/57190289/debugging-x64-with-sqlite/57191699#57191699", "title": "Debugging x64 with SQLite", "body": "<p>Welcome to SO!</p>\n\n<p>It sounds like you're loading the wrong version of the DLL, I've had problems like this myself in the past. Make sure you're checking at runtime whether you're running in 32 or 64 bit mode and then loading the appropriate DLL. Better yet, run NuGet Manager and add SQLite to your project from there, that version supports both.</p>\n"}], "owner": {"reputation": 274, "user_id": 11830603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52678bf2f3c2f6428020e584ca4e8704?s=128&d=identicon&r=PG&f=1", "display_name": "startNet", "link": "https://stackoverflow.com/users/11830603/startnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564004998, "creation_date": 1563997804, "question_id": 57190289, "link": "https://stackoverflow.com/questions/57190289/debugging-x64-with-sqlite", "title": "Debugging x64 with SQLite", "body": "<p>I use SQLite in the project</p>\n\n<p>I tested:</p>\n\n<ul>\n<li><code>System.Data.SQLite.x64</code></li>\n<li><code>System.Data.SQLite</code></li>\n</ul>\n\n<p>The error shows up when I want to debug in x64\nThis is necessary because I'm using an external DLL in x64 (<code>DllImport</code>)</p>\n\n<pre><code>SQLite error (1): no such table: MAIN in \"SELECT ID FROM MAIN\"\nException thrown: 'System.Data.SQLite.SQLiteException' in System.Data.SQLite.dll\nAn exception of type 'System.Data.SQLite.SQLiteException' occurred in System.Data.SQLite.dll but was not handled in user code\nSQL logic error\nno such table: MAIN\n</code></pre>\n\n<p>What is wrong?</p>\n"}, {"tags": ["c#", "android", "unity3d"], "comments": [{"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 0, "creation_date": 1563997987, "post_id": 57190216, "comment_id": 100890450, "body": "did you try to add some Logs or something to see which of your checks is the one failing?"}, {"owner": {"reputation": 6142, "user_id": 2548010, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/49fb97002d1a160f5818111732643b57?s=128&d=identicon&r=PG", "display_name": "Big Money", "link": "https://stackoverflow.com/users/2548010/big-money"}, "edited": false, "score": 0, "creation_date": 1563999976, "post_id": 57190216, "comment_id": 100891239, "body": "This all looks correct to me. Make sure the update function is actually running, and that Unity is picking it up as Android.  Try to <code>Debug.Log(Application.platform)</code> in Start() and see if it gives you android"}, {"owner": {"reputation": 13, "user_id": 11568863, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aZ6vFLdrAQ/AAAAAAAAAAI/AAAAAAAAC4A/eB3R_DrIU5w/photo.jpg?sz=128", "display_name": "Dhaval Bhagwat", "link": "https://stackoverflow.com/users/11568863/dhaval-bhagwat"}, "edited": false, "score": 0, "creation_date": 1564143766, "post_id": 57190216, "comment_id": 100944139, "body": "ok i will try that"}, {"owner": {"reputation": 13, "user_id": 11568863, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aZ6vFLdrAQ/AAAAAAAAAAI/AAAAAAAAC4A/eB3R_DrIU5w/photo.jpg?sz=128", "display_name": "Dhaval Bhagwat", "link": "https://stackoverflow.com/users/11568863/dhaval-bhagwat"}, "edited": false, "score": 0, "creation_date": 1565813505, "post_id": 57190216, "comment_id": 101472086, "body": "Problem is solved ..."}], "owner": {"reputation": 13, "user_id": 11568863, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aZ6vFLdrAQ/AAAAAAAAAAI/AAAAAAAAC4A/eB3R_DrIU5w/photo.jpg?sz=128", "display_name": "Dhaval Bhagwat", "link": "https://stackoverflow.com/users/11568863/dhaval-bhagwat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563998002, "creation_date": 1563997454, "last_edit_date": 1563998002, "question_id": 57190216, "link": "https://stackoverflow.com/questions/57190216/unity-back-button", "title": "Unity back button", "body": "<p>I am creating a unity app for android and want to implement back button functionality.I am using Unity 2019.1.11f1</p>\n\n<p>I added an empty game object and attached a script to it which I have attached below.</p>\n\n<pre><code>public class BackButton : MonoBehaviour\n{\n    private void Update()\n    {\n        if(Application.platform == RuntimePlatform.Android)\n        {\n            if(Input.GetKeyDown(KeyCode.Escape))\n            {\n                Application.Quit();\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I am expecting the app to quit but nothing happens.I also tried using GetKey and GetKeyUp instead of GetKeyDown.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1563997774, "post_id": 57190212, "comment_id": 100890360, "body": "You shouldn&#39;t need to add a picture. We don&#39;t like pictures of code. Pictures of error messages are sometimes helpful, but the raw text of the error message should always be included in your question as well (not as a pic). Also - you never actually asked a question. Please ask a clear question so we know which part you need clarification on."}, {"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "edited": false, "score": 1, "creation_date": 1563997794, "post_id": 57190212, "comment_id": 100890365, "body": "This is just a warning, so it shouldn&#39;t stop you from running your application (so long as you haven&#39;t set it treat warnings as errors)"}], "answers": [{"comments": [{"owner": {"reputation": 150, "user_id": 5864483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0bb61bd6491a5f3650e9a63cc89ab11?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Palmpje", "link": "https://stackoverflow.com/users/5864483/paul-palmpje"}, "edited": false, "score": 1, "creation_date": 1563997761, "post_id": 57190243, "comment_id": 100890352, "body": "This happens often in the IDE when you&#39;re developing code. Just ignore it when you plan to use the variable later on. But if it stays there longer - you&#39;ve written some code that needs improvement."}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "edited": false, "score": 0, "creation_date": 1564000055, "post_id": 57190243, "comment_id": 100891261, "body": "A slight addition to this answer: The warning usually only shows for private properties or variables. Most times I get it, it is because I messed up the access modifier (e.g. private, public, etc.)."}], "tags": [], "owner": {"reputation": 300, "user_id": 10124421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b9e8871733b28561ebaea8a5cf91fb?s=128&d=identicon&r=PG&f=1", "display_name": "RSchneyer", "link": "https://stackoverflow.com/users/10124421/rschneyer"}, "is_accepted": false, "score": 5, "last_activity_date": 1563997579, "creation_date": 1563997579, "answer_id": 57190243, "question_id": 57190212, "link": "https://stackoverflow.com/questions/57190212/variable-is-assigned-but-its-value-is-never-used/57190243#57190243", "title": "Variable is assigned but its value is never used", "body": "<p><a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/misc/cs0219\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/dotnet/csharp/misc/cs0219</a></p>\n\n<p>You're creating a variable named <code>num01</code>, but you're not using it. I'm far from a C# expert, but I assume the easiest way to get rid of this warning would be to either use or remove the offending variable.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11832537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14f15b2224ddc1009ee32dbf23754d6?s=128&d=identicon&r=PG&f=1", "display_name": "JChilton", "link": "https://stackoverflow.com/users/11832537/jchilton"}, "is_accepted": false, "score": 0, "last_activity_date": 1563997770, "creation_date": 1563997770, "answer_id": 57190281, "question_id": 57190212, "link": "https://stackoverflow.com/questions/57190212/variable-is-assigned-but-its-value-is-never-used/57190281#57190281", "title": "Variable is assigned but its value is never used", "body": "<p>This is a warning, not an error. Everything will still compile and run fine.</p>\n\n<p>Assigning a value to a variable is not 'using' it. </p>\n\n<p>Although not recommended, you can suppress this warning by adding the following line above it</p>\n\n<pre><code>#pragma warning disable CS0219\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1773, "user_id": 357783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bdd2f5c1db505b2aad93d5024552960?s=128&d=identicon&r=PG", "display_name": "mbabramo", "link": "https://stackoverflow.com/users/357783/mbabramo"}, "is_accepted": false, "score": 0, "last_activity_date": 1563998164, "creation_date": 1563998164, "answer_id": 57190371, "question_id": 57190212, "link": "https://stackoverflow.com/questions/57190212/variable-is-assigned-but-its-value-is-never-used/57190371#57190371", "title": "Variable is assigned but its value is never used", "body": "<p><a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/misc/cs0219\" rel=\"nofollow noreferrer\">CS0219</a> is a warning, not an error, so your program should compile. It might seem strange to you, because you are \"using\" the variable by assigning 20 to it. The warning message should be understood as pointing out that you are not using the variable in any other way <em>besides</em> assigning to it. In other words, the assignment cannot have any effect, other than if you are stepping through the program and looking at values in the debugger. If you add another line to your code using the variable in any way other than an assignment, then the warning will go away. For example, the following will do:</p>\n\n<pre><code>    int num01;\n    num01 = 20;\n    Console.WriteLine(num01);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11832467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c42b522806973abfdb2b47086655dc0c?s=128&d=identicon&r=PG&f=1", "display_name": "Prismo", "link": "https://stackoverflow.com/users/11832467/prismo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2821, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1563998164, "creation_date": 1563997439, "last_edit_date": 1563998048, "question_id": 57190212, "link": "https://stackoverflow.com/questions/57190212/variable-is-assigned-but-its-value-is-never-used", "title": "Variable is assigned but its value is never used", "body": "<p>The code:</p>\n\n<pre><code>int num01;\nnum01 = 20; \n</code></pre>\n\n<p>Gives:</p>\n\n<blockquote>\n  <p>Warning CS0219 The variable 'num01' is assigned but its value is never used</p>\n</blockquote>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 3, "creation_date": 1563997761, "post_id": 57190174, "comment_id": 100890353, "body": "Have all the CheckBoxes use the same method, and then use the &quot;sender&quot; to know which CheckBox was being clicked.  Generally, CheckChanged is more appropriate than Click."}, {"owner": {"reputation": 429, "user_id": 10723900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f18121149158e762a9de427a0f07aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/10723900/jo%c3%a3o"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1563997807, "post_id": 57190174, "comment_id": 100890372, "body": "I use click to give the user a chance to go back after he reads what the click does. If it&#39;s already checked a click will delete the entries"}, {"owner": {"reputation": 429, "user_id": 10723900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f18121149158e762a9de427a0f07aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/10723900/jo%c3%a3o"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1563998031, "post_id": 57190174, "comment_id": 100890466, "body": "I understand directing all of them to the same method but how do I use the sender as you suggested?"}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 1, "creation_date": 1563998077, "post_id": 57190174, "comment_id": 100890482, "body": "You cast it to a CheckBox, then you can examine the Name or Tag or Text property."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 1, "creation_date": 1563998387, "post_id": 57190174, "comment_id": 100890616, "body": "You can associate a Control with an Action. Cast sender to CheckBox (<code>var chkBox = sender as CheckBox;</code>) in the event handler and use <a href=\"https://stackoverflow.com/a/56938597/7444103\">code similar to this</a> to trigger a specific action linked to a specific control."}, {"owner": {"reputation": 429, "user_id": 10723900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f18121149158e762a9de427a0f07aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/10723900/jo%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1563998492, "post_id": 57190174, "comment_id": 100890664, "body": "Thanks guys, I managed to do it by casting <code>sender</code> to a CheckBox variable, and then using the variable as suggested by LarsTech"}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 10723900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f18121149158e762a9de427a0f07aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/10723900/jo%c3%a3o"}, "edited": false, "score": 0, "creation_date": 1563998742, "post_id": 57190475, "comment_id": 100890784, "body": "Yes, that&#39;s it, but check for null here?"}, {"owner": {"reputation": 79, "user_id": 6468720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ebf3ab30c7facc680e7e418f0a98d49?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Chepik", "link": "https://stackoverflow.com/users/6468720/igor-chepik"}, "reply_to_user": {"reputation": 429, "user_id": 10723900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f18121149158e762a9de427a0f07aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/10723900/jo%c3%a3o"}, "edited": false, "score": 1, "creation_date": 1563999412, "post_id": 57190475, "comment_id": 100891041, "body": "Just a rule of good tone - after each soft conversion of &quot;as&quot; - to check the result to null. If, for example, this event handler func will attached to a radiobutton, then when you click on it, there will be radibutton in the sender parameter. And the result of this conversion will be null"}], "tags": [], "owner": {"reputation": 79, "user_id": 6468720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ebf3ab30c7facc680e7e418f0a98d49?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Chepik", "link": "https://stackoverflow.com/users/6468720/igor-chepik"}, "is_accepted": true, "score": 1, "last_activity_date": 1563998813, "last_edit_date": 1563998813, "creation_date": 1563998642, "answer_id": 57190475, "question_id": 57190174, "link": "https://stackoverflow.com/questions/57190174/handle-all-checkbox-events-on-a-single-method/57190475#57190475", "title": "Handle all checkbox events on a single method", "body": "<p>If I understand the question correctly - binding a single function as an event handler for several checkboxes?</p>\n\n<pre><code>private void checkBox_CheckedChanged(object sender, EventArgs e)\n{\n   CheckBox checkbox = sender as CheckBox;\n   if (checkbox == null) return;\n   if (checkbox.Checked)\n   {\n     CheckAdicionarMaterial(checkbox.Text);//The text of the boxes is always the string I want to pass here.\n   }else\n   {\n     if (Confirmacao(\"Desmarcar remover\u00e1 todas ocorr\u00eancias do material. Continuar?\"))\n       CheckRemoverMaterial(checkbox.Text);\n     else\n         checkbox.Checked = true;\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 10723900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f18121149158e762a9de427a0f07aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o", "link": "https://stackoverflow.com/users/10723900/jo%c3%a3o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 57190475, "answer_count": 1, "score": 1, "last_activity_date": 1579868842, "creation_date": 1563997237, "last_edit_date": 1579868842, "question_id": 57190174, "link": "https://stackoverflow.com/questions/57190174/handle-all-checkbox-events-on-a-single-method", "title": "Handle all checkbox events on a single method", "body": "<p>I found some similar questions but none of them on <code>C#</code> <code>Winforms</code>. I have many similar methods for different <code>Checkboxes</code> I have on my form, but now the number of checks is about to double and I'm looking for a simpler way of doing this.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>private void CheckPET_Click(object sender, EventArgs e)\n{\n    if (CheckPET.Checked)\n    {\n        CheckAdicionarMaterial(\"PET\");\n    }\n    else\n    {\n        if (Confirmacao())\n            CheckRemoverMaterial(\"PET\");\n        else\n            CheckPET.Checked = true;\n    }\n}\n</code></pre>\n\n<p>I have one of these for each <code>Checkbox</code>, and all of them follow the same pattern, so if I could have a method that handles all clicks I could do something like this:</p>\n\n<pre><code>private void GenericCheckbox_Click(object sender, EventArgs e)\n{\n    if (Checkbox.Checked)\n    {\n        CheckAdicionarMaterial(Checkbox.Text);//The text of the boxes is always the string I want to pass here.\n    }\n    else\n    {\n        if (Confirmacao())\n            CheckRemoverMaterial(Checkbox.Text);\n        else\n            Checkbox.Checked = true;\n    }\n}\n</code></pre>\n\n<p>What can I do to achieve this?</p>\n"}, {"tags": ["c#", "generics", "inheritance"], "comments": [{"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 0, "creation_date": 1563997083, "post_id": 57190066, "comment_id": 100890093, "body": "What is wrong with the code that is commented out?"}, {"owner": {"reputation": 1458, "user_id": 11746212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69fe33bc21a8570b9e9c0fce89a681fa?s=128&d=identicon&r=PG&f=1", "display_name": "IronMan", "link": "https://stackoverflow.com/users/11746212/ironman"}, "edited": false, "score": 0, "creation_date": 1563997180, "post_id": 57190066, "comment_id": 100890124, "body": "You might be interested in a framework for observables like <a href=\"https://ikeptwalking.com/a-beginners-reactive-tutorial-using-rx-net/\" rel=\"nofollow noreferrer\">Rx.Net</a>"}, {"owner": {"reputation": 231, "user_id": 5037956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6f6fe6fdcf46ca963f5b663af869aff?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Hartz", "link": "https://stackoverflow.com/users/5037956/matthew-hartz"}, "reply_to_user": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 0, "creation_date": 1564095915, "post_id": 57190066, "comment_id": 100928456, "body": "@MattRowland Problem with the code commented out, was that the calling class isn&#39;t generic, therefore it doesn&#39;t have an Action&lt;T&gt;."}, {"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 0, "creation_date": 1564096382, "post_id": 57190066, "comment_id": 100928537, "body": "@MatthewHartz if you solved it, add it as an answer."}, {"owner": {"reputation": 231, "user_id": 5037956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6f6fe6fdcf46ca963f5b663af869aff?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Hartz", "link": "https://stackoverflow.com/users/5037956/matthew-hartz"}, "reply_to_user": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 0, "creation_date": 1564096653, "post_id": 57190066, "comment_id": 100928576, "body": "@MattRowland done"}], "answers": [{"comments": [{"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 0, "creation_date": 1564096930, "post_id": 57211209, "comment_id": 100928631, "body": "Code only answers are sometimes hard to understand. Providing some explanation can help future visitors."}], "tags": [], "owner": {"reputation": 231, "user_id": 5037956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6f6fe6fdcf46ca963f5b663af869aff?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Hartz", "link": "https://stackoverflow.com/users/5037956/matthew-hartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1564096494, "creation_date": 1564096494, "answer_id": 57211209, "question_id": 57190066, "link": "https://stackoverflow.com/questions/57190066/how-to-implement-a-non-generic-interface-and-call-with-generic/57211209#57211209", "title": "How to implement a non-generic interface and call with generic", "body": "<pre class=\"lang-cs prettyprint-override\"><code>internal interface IHandler\n{\n    void Subscribe(Func&lt;Action&lt;object&gt;, Guid&gt; subscribe);\n    void Unsubscribe(Action&lt;Guid&gt; action);\n}\n\npublic abstract class Handler&lt;T&gt; : IHandler\n{\n    private Guid _subscriptionToken;\n\n    public virtual void Subscribe(Func&lt;Action&lt;object&gt;, Guid&gt; subscribe)\n    {\n        var action = new Action&lt;T&gt;(HandleNonAsync);\n        _subscriptionToken = subscribe(Convert(action));\n    }\n\n    public virtual void Unsubscribe(Action&lt;Guid&gt; action)\n    {\n        action(_subscriptionToken);\n    }\n\n    public abstract Task HandleAsync(T eventType);\n\n    private void HandleNonAsync(T eventType)\n    {\n        HandleAsync(eventType).GetAwaiter().GetResult();\n    }\n\n    private Action&lt;object&gt; Convert(Action&lt;T&gt; myActionT)\n    {\n        if (myActionT == null) return null;\n        else return new Action&lt;object&gt;(o =&gt; myActionT((T)o));\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 5037956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6f6fe6fdcf46ca963f5b663af869aff?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Hartz", "link": "https://stackoverflow.com/users/5037956/matthew-hartz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564096516, "creation_date": 1563996756, "last_edit_date": 1564096516, "question_id": 57190066, "link": "https://stackoverflow.com/questions/57190066/how-to-implement-a-non-generic-interface-and-call-with-generic", "title": "How to implement a non-generic interface and call with generic", "body": "<p>Probably a bad title, but I am trying to abstract away the type \"EventHub\" from my generic Handler class. </p>\n\n<p>I would like to inject a function instead into my subscribe method to decouple the two types. Unfortunately, the only way I can see doing this is if I make my IHandler a generic, but this causes other problems.</p>\n\n<p>Is there a design pattern to decouple these two types? Commented out are lines that I would like in some way.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public interface IHandler\n{\n    //void Subscribe(Func&lt;Action&lt;T&gt;, Guid&gt; subscribe);\n    void Subscribe(EventHub eventHub);\n    void Unsubscribe(Action&lt;Guid&gt; action);\n}\n\npublic abstract class Handler&lt;T&gt; : IHandler\n{\n    private Guid _subscriptionToken;\n\n    public virtual void Subscribe(EventHub eventHub)\n    {\n        var action = new Action&lt;T&gt;(Handle);\n        _subscriptionToken = eventHub.Subscribe(action);\n    }\n\n    /*public virtual void Subscribe(Func&lt;Action&lt;T&gt;, Guid&gt; subscribe)\n    {\n        var action = new Action&lt;T&gt;(Handle);\n        _subscriptionToken = subscribe(action);\n    }*/\n\n    public virtual void Unsubscribe(Action&lt;Guid&gt; action)\n    {\n        action(_subscriptionToken);\n    }\n\n    public abstract void Handle(T eventType);\n}\n</code></pre>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["javascript", "c#", "asp.net"], "comments": [{"owner": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "edited": false, "score": 0, "creation_date": 1563996784, "post_id": 57190005, "comment_id": 100889972, "body": "Please include code as text, not as an image."}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1564003391, "post_id": 57190005, "comment_id": 100892448, "body": "I would consider whether it&#39;s really necessary to show the waiting gif in the first place.  You are returning a file so reading the response headers would be necessary to know that the file has been returned and has started to download.... so wait until you &quot;getResponseHeader(&quot;Content-Type&quot;);&quot;"}], "owner": {"reputation": 16, "user_id": 10777833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118468b249b49015d16f6c7c5ff001b2?s=128&d=identicon&r=PG", "display_name": "Juan Diego", "link": "https://stackoverflow.com/users/10777833/juan-diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563999268, "creation_date": 1563996501, "last_edit_date": 1563999268, "question_id": 57190005, "link": "https://stackoverflow.com/questions/57190005/how-to-stop-displaying-a-loading-gif-after-downloading-an-excel", "title": "How to stop displaying a loading GIF after downloading an Excel", "body": "<p>I have a problem when I try to stop displaying a loading GIF, after I download an excel file.</p>\n\n<p>I excecute a method from client side that shows a loading GIF, and then I serch information to export it to an Excel. </p>\n\n<p>The problem is, when the file is downloaded, I try to stop displaying the GIF from code behind with a ScriptManager like in the code...</p>\n\n<pre><code>private void hideLoading()\n{\n  ScriptManager.RegisterStartupScript(this, this.GetType(), \"loadingModal\", \"hideModalLoading();\", true);            \n}\n</code></pre>\n\n<p>But this doesn\u2019t work I think its because the response has already been sent to download the file. \n(I'm not sure...)</p>\n\n<p>The problem...\n<a href=\"https://i.stack.imgur.com/91y1m.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/91y1m.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "unity3d", "virtual-reality"], "comments": [{"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 2, "creation_date": 1563996418, "post_id": 57189951, "comment_id": 100889801, "body": "So you want the canvas to be <i>Headstable</i> in front of the player? Whic of your transforms refers to the canvas and which to the player? What does <code>doesn&#39;t work the way I wanted</code> mean exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "is_accepted": false, "score": 0, "last_activity_date": 1563997026, "last_edit_date": 1563997026, "creation_date": 1563996538, "answer_id": 57190014, "question_id": 57189951, "link": "https://stackoverflow.com/questions/57189951/how-to-make-panel-show-up-in-front-of-camera/57190014#57190014", "title": "How to make panel show up in front of camera", "body": "<p>Use this to move the canvas/panel in front of the camera and make it face the camera</p>\n\n<pre><code>// move the canvas distance meters in front of the camera\npainel_escolha.transform.position = transform_tela.position + transform_tela.transform.forward * distance;\n// make the canvas point in the same direction as the camera\npainel_escolha.transform.rotation = transform_tela.transform.rotation;\n</code></pre>\n\n<p>Doing this in <code>LateUpdate</code>(! so after User input and position and rotation changes are processed) makes your panel absolutely <em>head stable</em> meaning it always stays in front of the user and he can't look away basically.</p>\n\n<p>Often you rather want to use some kind of smoothed lerping instead e.g. doing</p>\n\n<pre><code>[Range(0,1)]\npublic float interpolationRatePosition = 0.5f;\n\n[Range(0,1)]\npublic float interpolationRateRotation = 0.5f;\n\nprivtae Vector3 lastPosition;\nprivate Quaternion lastRotation;\n\nprivtae void LateUpdate()\n{\n    painel_escolha.transform.position = Vector3.Lerp(painel_escolha.transform.position, transform_tela.position, interpolationRatePosition);\n\n    painel_escolha.transform.rotation = Quaterinon.Lerp(painel_escolha.transform.rotation, transform_tela.rotation, interpolationRateRotation);\n} \n</code></pre>\n\n<p>this resuts basically in the same end position but makes it looking a bit smoother.</p>\n"}, {"tags": [], "owner": {"reputation": 407, "user_id": 7020445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fm9ze.png?s=128&g=1", "display_name": "Milos Romanic", "link": "https://stackoverflow.com/users/7020445/milos-romanic"}, "is_accepted": false, "score": 0, "last_activity_date": 1564125869, "creation_date": 1564125869, "answer_id": 57215052, "question_id": 57189951, "link": "https://stackoverflow.com/questions/57189951/how-to-make-panel-show-up-in-front-of-camera/57215052#57215052", "title": "How to make panel show up in front of camera", "body": "<p>Canvas positions are basically 2D screen positions. You could get the clicked objects world position with transform.position but for a canvas element to point to that (be on top of it) you need to transform that world position to the screen position via <a href=\"https://docs.unity3d.com/ScriptReference/Camera.WorldToScreenPoint.html\" rel=\"nofollow noreferrer\">https://docs.unity3d.com/ScriptReference/Camera.WorldToScreenPoint.html</a></p>\n"}], "owner": {"reputation": 35, "user_id": 6922819, "user_type": "registered", "profile_image": "https://graph.facebook.com/992465280811592/picture?type=large", "display_name": "Mario Segalla", "link": "https://stackoverflow.com/users/6922819/mario-segalla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564125869, "creation_date": 1563996320, "question_id": 57189951, "link": "https://stackoverflow.com/questions/57189951/how-to-make-panel-show-up-in-front-of-camera", "title": "How to make panel show up in front of camera", "body": "<p>I have this project where I click on an object and a canvas will show up to the player select an option inside the canvas. I needed the canvas to be world space so the player can move its head and the canvas will stay static in front. The problem is, there is a ton of objects around the scene and I need to update the position of the canvas everytime the player clicks an object.</p>\n\n<p>I've tried to use \"transform.position\" but it doesn't work the way I wanted.</p>\n\n<p>obs:\npainel_escolha = canvas with panel;\ntransform_tela = camera.</p>\n\n<pre><code>  painel_escolha.transform.position = transform_tela.transform.position;\n</code></pre>\n"}, {"tags": ["c#", "entity-framework"], "comments": [{"owner": {"reputation": 1463, "user_id": 4121714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/204a24de5ac68f36edb9e26c7beaf0e2?s=128&d=identicon&r=PG&f=1", "display_name": "SouXin", "link": "https://stackoverflow.com/users/4121714/souxin"}, "edited": false, "score": 0, "creation_date": 1563996738, "post_id": 57189922, "comment_id": 100889950, "body": "Try find device index using LINQ. If index isn&#39;t found then do assign."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1564063327, "post_id": 57189922, "comment_id": 100914932, "body": "Put <code>DeviceTypeId</code> in <code>Device</code> as a foreign key property."}], "owner": {"reputation": 698, "user_id": 5132661, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/934c87cde0b353a4363bc3bba472e263?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowStack", "link": "https://stackoverflow.com/users/5132661/overflowstack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563997245, "creation_date": 1563996227, "last_edit_date": 1563997245, "question_id": 57189922, "link": "https://stackoverflow.com/questions/57189922/entity-framework-core-updating-nested-entity", "title": "Entity Framework Core - Updating Nested Entity", "body": "<p>Given these two classes:</p>\n\n<pre><code>public class Device {\n   public int DeviceId { get; set;}\n   public string Name { get; set;}\n   public virtual DeviceType DeviceType { get; set;}\n}\n\npublic class DeviceType {\n   public int DeviceTypeId { get; set;}\n   public string Name { get; set;}\n}\n</code></pre>\n\n<p>And assuming I get Device from database the following way:</p>\n\n<pre><code>var device = context.Devices.Include(d =&gt; d.DeviceType).FirstOrDefault();\n</code></pre>\n\n<p>How would I update DeviceType for selected device?</p>\n\n<p>I've been trying the following way:</p>\n\n<pre><code>device.DeviceType = new DeviceType { DeviceTypeId = 1 };\ncontext.SaveChanges();\n</code></pre>\n\n<p>However that does not work and give me the following error:</p>\n\n<pre><code>System.InvalidOperationException: 'The instance of entity type 'DeviceType' \ncannot be tracked because another instance with the key value '{DeviceTypeId: 1}' \nis already being tracked. When attaching existing entities, ensure that only one \nentity instance with a given key value is attached.'\n</code></pre>\n\n<p><strong>EDIT</strong> \nWorks the following way</p>\n\n<pre><code>context.Entry&lt;Device&gt;(device).Property&lt;int?&gt;(\"DeviceTypeId\").CurrentValue = 1;\n</code></pre>\n\n<p>But it's not that elegant. I wonder if there is better way.</p>\n"}, {"tags": ["c#", "sql", "linq", "lambda"], "comments": [{"owner": {"reputation": 1610, "user_id": 8451520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wc4e0.png?s=128&g=1", "display_name": "ivcubr", "link": "https://stackoverflow.com/users/8451520/ivcubr"}, "edited": false, "score": 0, "creation_date": 1563995740, "post_id": 57189723, "comment_id": 100889486, "body": "What isn&#39;t working with the <code>where</code> clause?"}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1563995859, "post_id": 57189723, "comment_id": 100889548, "body": "You tried, great! But what&#39;s the result?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1563996023, "post_id": 57189723, "comment_id": 100889628, "body": "Perhaps my <a href=\"https://stackoverflow.com/questions/49245160/sql-to-linq-with-multiple-join-count-and-left-join/49245786#49245786\">SQL to LINQ Recipe</a> might help you."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1563996154, "post_id": 57189723, "comment_id": 100889683, "body": "Why does your LINQ have <code>x.statusID != Closed</code> but your SQL have <code>t.StatusId = 3</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11776271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rpDur.jpg?s=128&g=1", "display_name": "Wendel Viana", "link": "https://stackoverflow.com/users/11776271/wendel-viana"}, "is_accepted": false, "score": 0, "last_activity_date": 1563996504, "creation_date": 1563996504, "answer_id": 57190006, "question_id": 57189723, "link": "https://stackoverflow.com/questions/57189723/how-to-use-inner-join-with-lambda-expression/57190006#57190006", "title": "How to use Inner Join with Lambda expression?", "body": "<p>These worked fine with me:</p>\n\n<pre><code>  var TicketList =   Tickets\n    .Join( Groups,\n         ticket =&gt; ticket.GroupID,\n         group =&gt; group.ID,\n         (customer , group ) =&gt; new { Ticket = ticket, Group = group})\n.Where(x =&gt; x.Group.UserId == 4 &amp;&amp; (x.Ticket.StatusId == 3 || x.Ticket.UserCreatedBy == 4) &amp;&amp; x.Ticket.StatusId == 3)\n         .Select(select =&gt; select.Ticket ).ToList();\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11397700, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--acfI1mka-Q/AAAAAAAAAAI/AAAAAAAAAAw/ujNAAiCPbuk/photo.jpg?sz=128", "display_name": "Alexis Lopez", "link": "https://stackoverflow.com/users/11397700/alexis-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563996504, "creation_date": 1563995341, "question_id": 57189723, "link": "https://stackoverflow.com/questions/57189723/how-to-use-inner-join-with-lambda-expression", "title": "How to use Inner Join with Lambda expression?", "body": "<p>I have a query in SQL that need convert to lambda expression, but I'm not sure how to use the WHERE function.</p>\n\n<p>This is my query in SQL:</p>\n\n<p>SELECT * FROM tickets t\nINNER JOIN groups g on t.GroupId = g.GroupId \nWHERE g.UserId = 4 AND t.StatusId = 3 OR t.UserCreatedBy = 4 AND t.StatusId = 3</p>\n\n<p>I tried to convert it of the following way:</p>\n\n<pre><code>var query = db.Tickets\n.Include(t =&gt; t.CftGroup)\n.Include(t =&gt; t.Customer)\n.Include(t =&gt; t.Factory)\n.Include(t =&gt; t.Failure)\n.Include(t =&gt; t.Line)\n.Include(t =&gt; t.Priority)\n.Include(t =&gt; t.Process.ProcessGroup)\n.Include(t =&gt; t.Site)\n.Include(t =&gt; t.Status)\n.Join(db.Groups, t =&gt; t.CftGroupId, g =&gt; g.CftGroupId, (t, g) =&gt; new\n{\n    userCreatedBy = t.UserCreatedBy,\n    userId = g.UserId,\n    statusId = t.StatusId\n})\n.Where(\nx =&gt; x.userId == id\n&amp;&amp; x.statusId != Closed\n|| x.userCreatedBy = id\n&amp;&amp; x.statusId != Closed\n);\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1563995479, "post_id": 57189662, "comment_id": 100889354, "body": "You&#39;d have to write code that generates the columns. You could wrap that code in a behavior/attached property and make it look like &quot;auto generation&quot; in the XAML. Another option would be to recreate your data in a <code>DataTable</code>, with those column names, and use that as the ItemsSource."}, {"owner": {"reputation": 75, "user_id": 11138303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea3d6139b7c7ab06d3bf1c11fcc3723?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/11138303/ethan"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1563996059, "post_id": 57189662, "comment_id": 100889640, "body": "@EdPlunkett Ah, I was wondering if perhaps it was beyond scope of what AutoGenerate could handle. I&#39;ll take a look into using a <code>DataTable</code> and building what I need around that."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 11138303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea3d6139b7c7ab06d3bf1c11fcc3723?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/11138303/ethan"}, "is_accepted": false, "score": 0, "last_activity_date": 1564068030, "last_edit_date": 1564068030, "creation_date": 1563997968, "answer_id": 57190318, "question_id": 57189662, "link": "https://stackoverflow.com/questions/57189662/can-i-autogeneratecolumns-inside-a-datagrid-based-on-a-list-inside-observableco/57190318#57190318", "title": "Can I AutoGenerateColumns inside a DataGrid, based on a list inside ObservableCollection?", "body": "<p>Thanks to the comment from @EdPlunkett, I solved this using a DataTable as the ItemsSource.</p>\n\n<pre><code>DataTable logDataTable = new DataTable();\n\nfor (var index = 0; index &lt; systemLog.LogEntries.Count; index++)\n{\n    var entry = systemLog.LogEntries[index];\n    foreach (var logDetailsEntity in entry.Name)\n    {\n        if (logDataTable.Columns.Contains(logDetailsEntity.Header)) continue;\n        logDataTable.Columns.Add(logDetailsEntity.Header);\n    }\n    logDataTable.Rows.Add();\n    foreach (var logDetailsEntity in entry.Name)\n    {\n        logDataTable.Rows[index][logDetailsEntity.Header] = logDetailsEntity.Details;\n    }\n}\nMainDataGrid.ItemsSource = logDataTable.DefaultView;\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11138303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea3d6139b7c7ab06d3bf1c11fcc3723?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/11138303/ethan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564068030, "creation_date": 1563995087, "question_id": 57189662, "link": "https://stackoverflow.com/questions/57189662/can-i-autogeneratecolumns-inside-a-datagrid-based-on-a-list-inside-observableco", "title": "Can I AutoGenerateColumns inside a DataGrid, based on a list inside ObservableCollection?", "body": "<p>I'm attempting to create a dynamic log viewer. I currently have three classes:</p>\n\n<pre><code>public class SystemLogEntry\n{\n    public ObservableCollection&lt;SystemLogRowEntity&gt; LogEntries { get; set; }\n    public SystemLogEntry(){LogEntries = new ObservableCollection&lt;SystemLogRowEntity&gt;();}\n}\n\npublic class SystemLogRowEntity\n{\n    public int Id { get; set; }\n    public List&lt;LogDetailsEntity&gt; Name { get; set; }\n}\npublic class LogDetailsEntity\n{\n    public string Header { get; set; }\n    public string Details { get; set; }\n}\n</code></pre>\n\n<p>My DataGrid Code:</p>\n\n<pre><code>&lt;DataGrid x:Name=\"MainDataGrid\" AutoGenerateColumns=\"True\"/&gt;\n</code></pre>\n\n<p>I also have some initialization code:</p>\n\n<pre><code>private SystemLogEntry systemLog = new SystemLogEntry();\n</code></pre>\n\n<pre><code>systemLog.LogEntries.Add(new SystemLogRowEntity\n{\n    Id = 1,\n    Name = new List&lt;LogDetailsEntity&gt;\n    {\n        new LogDetailsEntity {Header = \"Name\", Details = \"SQL Report\"},\n        new LogDetailsEntity {Header = \"Type\", Details = \"Message\"},\n        new LogDetailsEntity {Header = \"Time\", Details = \"15:00\"},\n        new LogDetailsEntity {Header = \"Date\", Details = \"01/01/2019\"},\n        new LogDetailsEntity {Header = \"Details\", Details = \"The SQL Report completed successfully.\"}\n    }\n});\nsystemLog.LogEntries.Add(new SystemLogRowEntity\n{\n    Id = 2,\n    Name = new List&lt;LogDetailsEntity&gt;\n    {\n        new LogDetailsEntity {Header = \"Name\", Details = \"SQL Report\"},\n        new LogDetailsEntity {Header = \"Type\", Details = \"Error\"},\n        new LogDetailsEntity {Header = \"Time\", Details = \"15:01\"},\n        new LogDetailsEntity {Header = \"Date\", Details = \"01/01/2019\"},\n        new LogDetailsEntity {Header = \"Details\", Details = \"The SQL Report failed catastrophically.\"},\n        new LogDetailsEntity {Header = \"Thread\", Details = \"10250\"},\n        new LogDetailsEntity {Header = \"User\", Details = \"System\"}\n    }\n});\n\n\nMainDataGrid.AutoGenerateColumns = true;\nMainDataGrid.DataContext = systemLog;\nMainDataGrid.SetBinding(ItemsControl.ItemsSourceProperty,\n    new Binding\n    {\n        Source = systemLog.LogEntries,\n        UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged\n    });\n</code></pre>\n\n<p>I would like each item inside LogDetailsEntity to appear as a column header (with associated \"details\" as the content). However I always just receive \"collection\" on my DataGrid output.</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 391, "user_id": 5916272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMifm.jpg?s=128&g=1", "display_name": "YouneS", "link": "https://stackoverflow.com/users/5916272/younes"}, "edited": false, "score": 0, "creation_date": 1563995207, "post_id": 57189641, "comment_id": 100889238, "body": "I think that the problem is that You draw the Cells one on top of another that is why you think that you only draw one."}, {"owner": {"reputation": 391, "user_id": 5916272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMifm.jpg?s=128&g=1", "display_name": "YouneS", "link": "https://stackoverflow.com/users/5916272/younes"}, "edited": false, "score": 0, "creation_date": 1563995275, "post_id": 57189641, "comment_id": 100889266, "body": "You have to set the &quot;cell.Location&quot; for each cell to draw it in the correct place"}], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 11731800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213677514508596/picture?type=large", "display_name": "Adrian Mangion", "link": "https://stackoverflow.com/users/11731800/adrian-mangion"}, "edited": false, "score": 0, "creation_date": 1563995554, "post_id": 57189710, "comment_id": 100889394, "body": "Thanks. A rookie mistake that. Cheers for the quick help!"}, {"owner": {"reputation": 692, "user_id": 6538434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b8f4c88a2ad0bcedcad56fa3efc26?s=128&d=identicon&r=PG&f=1", "display_name": "eye_am_groot", "link": "https://stackoverflow.com/users/6538434/eye-am-groot"}, "reply_to_user": {"reputation": 112, "user_id": 11731800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213677514508596/picture?type=large", "display_name": "Adrian Mangion", "link": "https://stackoverflow.com/users/11731800/adrian-mangion"}, "edited": false, "score": 0, "creation_date": 1563995634, "post_id": 57189710, "comment_id": 100889431, "body": "No problem!  Sometimes you just need a second set of eyes!"}, {"owner": {"reputation": 692, "user_id": 6538434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b8f4c88a2ad0bcedcad56fa3efc26?s=128&d=identicon&r=PG&f=1", "display_name": "eye_am_groot", "link": "https://stackoverflow.com/users/6538434/eye-am-groot"}, "reply_to_user": {"reputation": 112, "user_id": 11731800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213677514508596/picture?type=large", "display_name": "Adrian Mangion", "link": "https://stackoverflow.com/users/11731800/adrian-mangion"}, "edited": false, "score": 0, "creation_date": 1563995939, "post_id": 57189710, "comment_id": 100889584, "body": "Feel free to mark this as the answer (and upvote, if you want) to let others know that this is the answer.  Cheers!"}, {"owner": {"reputation": 112, "user_id": 11731800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213677514508596/picture?type=large", "display_name": "Adrian Mangion", "link": "https://stackoverflow.com/users/11731800/adrian-mangion"}, "edited": false, "score": 0, "creation_date": 1563996341, "post_id": 57189710, "comment_id": 100889767, "body": "I believe it is set as the answer and I did upvote, however, it won&#39;t show since upvotes by users who have less than 15 rep points won&#39;t show."}, {"owner": {"reputation": 692, "user_id": 6538434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b8f4c88a2ad0bcedcad56fa3efc26?s=128&d=identicon&r=PG&f=1", "display_name": "eye_am_groot", "link": "https://stackoverflow.com/users/6538434/eye-am-groot"}, "reply_to_user": {"reputation": 112, "user_id": 11731800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213677514508596/picture?type=large", "display_name": "Adrian Mangion", "link": "https://stackoverflow.com/users/11731800/adrian-mangion"}, "edited": false, "score": 0, "creation_date": 1563996483, "post_id": 57189710, "comment_id": 100889827, "body": "No problem.  If the check mark is green, you&#39;ve selected it as the answer."}], "tags": [], "owner": {"reputation": 692, "user_id": 6538434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5b8f4c88a2ad0bcedcad56fa3efc26?s=128&d=identicon&r=PG&f=1", "display_name": "eye_am_groot", "link": "https://stackoverflow.com/users/6538434/eye-am-groot"}, "is_accepted": true, "score": 0, "last_activity_date": 1563995300, "creation_date": 1563995300, "answer_id": 57189710, "question_id": 57189641, "link": "https://stackoverflow.com/questions/57189641/why-cant-i-create-an-array-of-an-object-i-created/57189710#57189710", "title": "Why can&#39;t I create an array of an object I created?", "body": "<p>The line:</p>\n\n<pre><code>Cell cell[] = new Cell[26]; \n</code></pre>\n\n<p>gives you mismatched types (<code>cell</code> vs <code>cell[]</code>).  It should be:</p>\n\n<pre><code>Cell[] cell = new Cell[26]; \n</code></pre>\n"}], "owner": {"reputation": 112, "user_id": 11731800, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213677514508596/picture?type=large", "display_name": "Adrian Mangion", "link": "https://stackoverflow.com/users/11731800/adrian-mangion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57189710, "answer_count": 1, "score": 0, "last_activity_date": 1563995374, "creation_date": 1563994998, "last_edit_date": 1563995374, "question_id": 57189641, "link": "https://stackoverflow.com/questions/57189641/why-cant-i-create-an-array-of-an-object-i-created", "title": "Why can&#39;t I create an array of an object I created?", "body": "<p>The objective is to create a spreadsheet kind of program such as Microsoft Excel. I have created a cell class which I want to create multiple instances of. Is the syntax incorrect or am I missing something logically?</p>\n\n<p>What I did so far:\n- Create a cell class.\n- Initialized array, only to get an error.</p>\n\n<pre><code>public partial class form_welcomeScreen : Form\n{\n    Label[] cellLetters = new Label[26];\n    Label[] cellNumbers = new Label[26];\n    Cell cell[] = new Cell[26]; \n    char cellLetter = 'A';\n    int cellNumber = 1;\n\n    public form_welcomeScreen()\n    {\n        InitializeComponent();\n    }\n\n    private void Btn_newSheet_Click(object sender, EventArgs e)\n    {\n        for (int i = 0; i &lt; 26; i++)\n        {\n            Cell cell = new Cell();\n            pnl_main.Controls.Add(cell.createCell());\n            cell.CellLetter = cellLetter;\n            cell.CellNumber = cellNumber;\n            cellLetter++;\n            cellNumber++;\n        }\n    }\n}\n\n\nclass Cell : System.Windows.Forms.TextBox\n{\n\n    private char cellLetter;\n    private int cellNumber;\n    private string cellID;\n\n    public char CellLetter\n    {\n        get { return cellLetter; }\n        set { cellLetter = value; }\n    }\n\n    public int CellNumber\n    {\n        get { return cellNumber; }\n        set { cellNumber = value; }\n    }\n\n    public string CellID\n    {\n        get { return cellID; }\n        set { cellID = CellLetter + Convert.ToString(CellNumber); }\n    }\n\n    public TextBox createCell()\n    {\n        TextBox cell = new TextBox();\n        cell.AcceptsReturn = true;\n        cell.Name = cellID;\n        cell.Size = new System.Drawing.Size(50, 25);\n        return cell;\n    }\n</code></pre>\n\n<p>I expect an array to be created so I can be able to create a whole spreadsheet of cells rather than just the one.</p>\n"}, {"tags": ["c#", ".net-core", "asp.net-identity"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9902008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7dcd9f0952aedb7f5c35ab27f4e1cc?s=128&d=identicon&r=PG&f=1", "display_name": "Legrooch", "link": "https://stackoverflow.com/users/9902008/legrooch"}, "edited": false, "score": 0, "creation_date": 1563997062, "post_id": 57189703, "comment_id": 100890077, "body": "Yes, didn&#39;t help"}, {"owner": {"reputation": 1, "user_id": 9902008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7dcd9f0952aedb7f5c35ab27f4e1cc?s=128&d=identicon&r=PG&f=1", "display_name": "Legrooch", "link": "https://stackoverflow.com/users/9902008/legrooch"}, "edited": false, "score": 0, "creation_date": 1563997526, "post_id": 57189703, "comment_id": 100890262, "body": "On debug when I&#39;m on callbackurl i see mixed letters, but on next step (await on emailsender) callbackurl shows token in lowercase."}], "tags": [], "owner": {"reputation": 502, "user_id": 7529020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a724a6e1135e2bde518384500c5b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Y.", "link": "https://stackoverflow.com/users/7529020/y-y"}, "is_accepted": false, "score": 0, "last_activity_date": 1563995255, "creation_date": 1563995255, "answer_id": 57189703, "question_id": 57189548, "link": "https://stackoverflow.com/questions/57189548/why-my-email-confirmation-token-is-invalid/57189703#57189703", "title": "Why my email confirmation token is invalid?", "body": "<p>I'm not sure but did you try this one?<br> <code>code = System.Web.HttpUtility.UrlEncode(code);</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9902008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7dcd9f0952aedb7f5c35ab27f4e1cc?s=128&d=identicon&r=PG&f=1", "display_name": "Legrooch", "link": "https://stackoverflow.com/users/9902008/legrooch"}, "is_accepted": false, "score": 0, "last_activity_date": 1564227710, "creation_date": 1564227710, "answer_id": 57231773, "question_id": 57189548, "link": "https://stackoverflow.com/questions/57189548/why-my-email-confirmation-token-is-invalid/57231773#57231773", "title": "Why my email confirmation token is invalid?", "body": "<p>Problem was in my startup.cs file, </p>\n\n<pre><code>options.LowercaseQueryStrings = true;\n</code></pre>\n\n<p>After comment token is working ok.</p>\n"}], "owner": {"reputation": 1, "user_id": 9902008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e7dcd9f0952aedb7f5c35ab27f4e1cc?s=128&d=identicon&r=PG&f=1", "display_name": "Legrooch", "link": "https://stackoverflow.com/users/9902008/legrooch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564227710, "creation_date": 1563994568, "question_id": 57189548, "link": "https://stackoverflow.com/questions/57189548/why-my-email-confirmation-token-is-invalid", "title": "Why my email confirmation token is invalid?", "body": "<p>I'm trying to get clean emailconfirmation on Microsoft Identity 2.0. I'm generating email link for confirmation and it's not working. \nI found, that encoded token on callbackrul is changing to lowercase and I believe that there is a problem. But I don't know how to solve it.....</p>\n\n<p>When code variable gets value it looks like:\nCfDJ8C5jg3XNISFEoFA015AdmTmmbOmQG/cxNBfdOALg4WM+iU6uf8WeJ13buFIzbdlP3tK3kWU1Q6BwGh/DY7dAYqbj+zz7jXGOK1Y79mtDT2jiEKV4NdaLbfaruzOvoKSVhvg4EFVYPAQRrjcAnOkfCxlff6hMVhIBWHkg8rqv7GBnqXvJ+UbCErqlobIxI69YreNWVTM1Z4lkAYQM2xmwRA//0T53KNPTWIX52oDc52eFLJAlsWhXI9uHwgfwTt0X9g==</p>\n\n<p>After callback it's changed to:\ncfdj8c5jg3xnisfeofa015admtmmbomqg%2Fcxnbfdoalg4wm%2Biu6uf8wej13bufizbdlp3tk3kwu1q6bwgh%2Fdy7dayqbj%2Bzz7jxgok1y79mtdt2jiekv4ndalbfaruzovoksvhvg4efvypaqrrjcanokfcxlff6hmvhibwhkg8rqv7gbnqxvj%2Bubcerqlobixi69yrenwvtm1z4lkayqm2xmwra%2F%2F0t53knptwix52odc52efljalswhxi9uhwgfwtt0x9g%3D%3D</p>\n\n<p>On confirmation action I'm getting decoded token as:\ncfdj8c5jg3xnisfeofa015admtmmbomqg/cxnbfdoalg4wm+iu6uf8wej13bufizbdlp3tk3kwu1q6bwgh/dy7dayqbj+zz7jxgok1y79mtdt2jiekv4ndalbfaruzovoksvhvg4efvypaqrrjcanokfcxlff6hmvhibwhkg8rqv7gbnqxvj+ubcerqlobixi69yrenwvtm1z4lkayqm2xmwra//0t53knptwix52odc52efljalswhxi9uhwgfwtt0x9g==</p>\n\n<p>Part of register.cshtml.cs</p>\n\n<pre><code>var code = await _userManager.GenerateEmailConfirmationTokenAsync(user);\nvar callbackUrl = Url.Page(\n                  \"/Account/ConfirmEmail\",\n                  pageHandler: null,\n                  values: new { userId = user.Id, code = codeenc },\n                  protocol: Request.Scheme\n                  );\nawait _emailSender.SendEmailAsync(Input.Email, \"Confirm your email\",\n                        $\"Please confirm your account by &lt;a href='{HtmlEncoder.Default.Encode(callbackUrl)}'&gt;clicking here&lt;/a&gt;.\");\n</code></pre>\n\n<p>confirmemail.cshtml.cs</p>\n\n<pre><code>var user = await _userManager.FindByIdAsync(userId);\n    if (user == null)\n       {\n          return NotFound($\"Unable to load user with ID '{userId}'.\");\n       }\nvar result = await _userManager.ConfirmEmailAsync(user, code);\n</code></pre>\n\n<p>So where I make a mistake?</p>\n"}, {"tags": ["c#", "json"], "comments": [{"owner": {"reputation": 2556, "user_id": 10883465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E5Lki7kUGF8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY1dMAbpAmyyBJtdSM1p4AdgBm_QQ/mo/photo.jpg?sz=128", "display_name": "Joelius", "link": "https://stackoverflow.com/users/10883465/joelius"}, "edited": false, "score": 0, "creation_date": 1563995247, "post_id": 57189518, "comment_id": 100889256, "body": "JsonConvert is built for performance. It&#39;s unlikely that you can get much faster than that prior to .net core 3. In .net core 3 (currently in preview7) the .net team implements a new and faster serializer to get rid of old json.net dependencies. You can read more <a href=\"https://devblogs.microsoft.com/dotnet/try-the-new-system-text-json-apis/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1082, "user_id": 3129954, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f43a71ffc579d42bc321f7cf49734fa6?s=128&d=identicon&r=PG&f=1", "display_name": "IgorM", "link": "https://stackoverflow.com/users/3129954/igorm"}, "edited": false, "score": 0, "creation_date": 1563996018, "post_id": 57189518, "comment_id": 100889625, "body": "As far as I know <code>JsonConvert</code> with defined class type is the fastest approach for now."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1564022611, "post_id": 57189518, "comment_id": 100896173, "body": "<i>I tried deserializing directly from a stream rather than going to string first, but my Dictionary kept being returned as &quot;null&quot;</i> - can you share a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?  Possibly you just forgot to rewind the stream if you had already read <code>myString</code> from it.  Also, see <a href=\"https://www.newtonsoft.com/json/help/html/performance.htm\" rel=\"nofollow noreferrer\">newtonsoft.com/json/help/html/performance.htm</a>"}, {"owner": {"reputation": 1635, "user_id": 5480147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a4c467c7c34e0e9162535a801ae21a?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/5480147/tom"}, "edited": false, "score": 0, "creation_date": 1565611520, "post_id": 57189518, "comment_id": 101394998, "body": "Problem of famost general parsers is they are too complex and use too much memory per object... You can get few times better speed using some lighter alternative - made one in C# translating Gason from C++ <a href=\"https://github.com/eltomjan/gason\" rel=\"nofollow noreferrer\">github.com/eltomjan/gason</a>"}], "owner": {"reputation": 33, "user_id": 11627703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fb849abd69ba16a055f7143f6b7e485?s=128&d=identicon&r=PG&f=1", "display_name": "Kess", "link": "https://stackoverflow.com/users/11627703/kess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563994402, "creation_date": 1563994402, "question_id": 57189518, "link": "https://stackoverflow.com/questions/57189518/fast-deserialization-from-json", "title": "Fast Deserialization from JSON", "body": "<p>Currently in my code I retrieve a string value and then deserialize it to a Dictionary using JsonConvert.  This works perfectly fine, but I was curious as to if there was a faster way for me to do this in order to increase performance.</p>\n\n<p>I tried deserializing directly from a stream rather than going to string first, but my Dictionary kept being returned as \"null\".  I know deserializing from a stream is possible, as I have done it in other projects</p>\n\n<pre><code>// Using JsonConvert (works but would like to be faster)\nDictionary&lt;int, MyClass&gt; myDictionary = JsonConvert.DeserializeObject&lt;Dictionary&lt;int, MyClass&gt;&gt;(myString);\n\n// Using Streams directly (Dictionary is returned as null even though I have confirmed the stream is not empty)\n// In my actual code this is within a function that returns a Dictionary and takes the stream as a parameter\nJsonSerializer serializer = new JsonSerializer();\nusing (StreamReader sr = new StreamReader(myStream))\nusing (JsonTextReader jsonTextReader = new JsonTextReader(sr))\n{\n    return serializer.Deserialize&lt;Dictionary&lt;int, MyClass&gt;&gt;(jsonTextReader);\n}\n</code></pre>\n\n<p>As I said before, using JsonConvert gets me the correct result, but I was hoping somebody could either help me with the stream one, or provide another idea for deserialization that could be faster. Thanks!</p>\n"}, {"tags": ["c#", "winforms", "keyboard-shortcuts", "desktop-application", "visual-studio-2019"], "comments": [{"owner": {"reputation": 391, "user_id": 5916272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMifm.jpg?s=128&g=1", "display_name": "YouneS", "link": "https://stackoverflow.com/users/5916272/younes"}, "edited": false, "score": 0, "creation_date": 1563994324, "post_id": 57189387, "comment_id": 100888934, "body": "I think the problem comes from the incorrect if condition which should be more like : if(e.KeyData == (Keys.Control | Keys.Enter))"}, {"owner": {"reputation": 167, "user_id": 3843432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12a6e8ffc03dbbf85da571f02799d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Seabass77", "link": "https://stackoverflow.com/users/3843432/seabass77"}, "edited": false, "score": 0, "creation_date": 1563994325, "post_id": 57189387, "comment_id": 100888936, "body": "Can edit your question to add your code for the form?"}, {"owner": {"reputation": 3, "user_id": 7005520, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sc1ga9BPS9k/AAAAAAAAAAI/AAAAAAAABGY/ZLzCTGArjt8/photo.jpg?sz=128", "display_name": "jpollock0010", "link": "https://stackoverflow.com/users/7005520/jpollock0010"}, "reply_to_user": {"reputation": 391, "user_id": 5916272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMifm.jpg?s=128&g=1", "display_name": "YouneS", "link": "https://stackoverflow.com/users/5916272/younes"}, "edited": false, "score": 0, "creation_date": 1563994442, "post_id": 57189387, "comment_id": 100888982, "body": "@YouneS That didn&#39;t work, either, unfortunately."}, {"owner": {"reputation": 3, "user_id": 7005520, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sc1ga9BPS9k/AAAAAAAAAAI/AAAAAAAABGY/ZLzCTGArjt8/photo.jpg?sz=128", "display_name": "jpollock0010", "link": "https://stackoverflow.com/users/7005520/jpollock0010"}, "reply_to_user": {"reputation": 167, "user_id": 3843432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12a6e8ffc03dbbf85da571f02799d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Seabass77", "link": "https://stackoverflow.com/users/3843432/seabass77"}, "edited": false, "score": 0, "creation_date": 1563994489, "post_id": 57189387, "comment_id": 100888996, "body": "@Seabass77 What code would you like to see? There&#39;s ~300 lines, some of which contains sensitive data for my company, so it&#39;s a bit too much to add it all."}, {"owner": {"reputation": 391, "user_id": 5916272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SMifm.jpg?s=128&g=1", "display_name": "YouneS", "link": "https://stackoverflow.com/users/5916272/younes"}, "edited": false, "score": 0, "creation_date": 1563994522, "post_id": 57189387, "comment_id": 100889010, "body": "@BlueJae You have extra code in the if condition. The extra code is (e.SuppressKeyPress = ...)"}, {"owner": {"reputation": 167, "user_id": 3843432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12a6e8ffc03dbbf85da571f02799d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Seabass77", "link": "https://stackoverflow.com/users/3843432/seabass77"}, "edited": false, "score": 0, "creation_date": 1563994630, "post_id": 57189387, "comment_id": 100889049, "body": "@BlueJae Can you tell us which TextBox Property you are using for the code above?"}, {"owner": {"reputation": 3, "user_id": 7005520, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sc1ga9BPS9k/AAAAAAAAAAI/AAAAAAAABGY/ZLzCTGArjt8/photo.jpg?sz=128", "display_name": "jpollock0010", "link": "https://stackoverflow.com/users/7005520/jpollock0010"}, "edited": false, "score": 0, "creation_date": 1563995476, "post_id": 57189387, "comment_id": 100889351, "body": "I&#39;m not using a TextBox property; I&#39;m trying to accomplish this without it. The form does have a multi-line TextBox and a single-line name input TextBox, but it&#39;s an optional input. Otherwise, there are 3 combo boxes and some radio buttons with the submit button."}, {"owner": {"reputation": 167, "user_id": 3843432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12a6e8ffc03dbbf85da571f02799d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Seabass77", "link": "https://stackoverflow.com/users/3843432/seabass77"}, "edited": false, "score": 0, "creation_date": 1564012592, "post_id": 57189387, "comment_id": 100894543, "body": "Can you try looking at this post? Seems to have the same question as you. <a href=\"https://stackoverflow.com/questions/3172731/forms-not-responding-to-keydown-events\" title=\"forms not responding to keydown events\">stackoverflow.com/questions/3172731/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 7005520, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sc1ga9BPS9k/AAAAAAAAAAI/AAAAAAAABGY/ZLzCTGArjt8/photo.jpg?sz=128", "display_name": "jpollock0010", "link": "https://stackoverflow.com/users/7005520/jpollock0010"}, "reply_to_user": {"reputation": 167, "user_id": 3843432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12a6e8ffc03dbbf85da571f02799d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Seabass77", "link": "https://stackoverflow.com/users/3843432/seabass77"}, "edited": false, "score": 0, "creation_date": 1564059862, "post_id": 57189387, "comment_id": 100912822, "body": "@Seabass77 It does look like what I&#39;m looking for. Basically looks like I can&#39;t use the Enter key...Thanks for all the advice! It might not be possible but I still learned a lot from it. :)"}, {"owner": {"reputation": 167, "user_id": 3843432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/12a6e8ffc03dbbf85da571f02799d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Seabass77", "link": "https://stackoverflow.com/users/3843432/seabass77"}, "edited": false, "score": 0, "creation_date": 1564066770, "post_id": 57189387, "comment_id": 100916967, "body": "@BlueJae No problem! If you find the solution remember to post it here and accept it so that it can help others."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 7005520, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sc1ga9BPS9k/AAAAAAAAAAI/AAAAAAAABGY/ZLzCTGArjt8/photo.jpg?sz=128", "display_name": "jpollock0010", "link": "https://stackoverflow.com/users/7005520/jpollock0010"}, "is_accepted": false, "score": 0, "last_activity_date": 1564076027, "creation_date": 1564076027, "answer_id": 57207401, "question_id": 57189387, "link": "https://stackoverflow.com/questions/57189387/can-the-acceptbutton-property-on-a-c-winform-be-changed-from-the-enter-key-to-u/57207401#57207401", "title": "Can the AcceptButton property on a C# winform be changed from the Enter key to using Ctrl+Enter without using a TextBox?", "body": "<p>I actually did manage to get this to work after a lot of trial, error, and splicing together samples from a vast number of different forums. Here's what ended up working for me. If there are any edits that would make it more streamlined, please feel free to let me know.</p>\n\n<pre><code>private void SubmitShortcut(object sender, KeyEventArgs e)\n        {\n            if(e.KeyCode == Keys.Enter &amp;&amp; e.Control)\n            {\n                e.Handled = true;\n                SubmitBtn_Click(sender, e);\n            }\n            else if (e.KeyCode != Keys.Enter &amp;&amp; e.Control)\n            {\n                e.Handled = false;\n            }\n        }\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7005520, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Sc1ga9BPS9k/AAAAAAAAAAI/AAAAAAAABGY/ZLzCTGArjt8/photo.jpg?sz=128", "display_name": "jpollock0010", "link": "https://stackoverflow.com/users/7005520/jpollock0010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1564076027, "creation_date": 1563993811, "question_id": 57189387, "link": "https://stackoverflow.com/questions/57189387/can-the-acceptbutton-property-on-a-c-winform-be-changed-from-the-enter-key-to-u", "title": "Can the AcceptButton property on a C# winform be changed from the Enter key to using Ctrl+Enter without using a TextBox?", "body": "<p>I'm working on updates to a program I wrote a while ago (and thank you all for helping out with my previous question!), and I've run into a hiccup. I'd like to make it so that my program will submit its data to the SharePoint list using CTRL+ENTER without needing a TextBox. </p>\n\n<p>I've scoured Google Searches for hours and haven't found anything that really gives me the functionality I want. I'm not married to using the AcceptButton feature on the WinForm, so any suggestions to make this work are welcome.</p>\n\n<p>I've tried various variations of this code to make it cooperate, but it didn't work out at all.</p>\n\n<pre><code>if (e.SuppressKeyPress = (e.KeyData == (Keys.Control | Keys.Enter)))\n{\nSubmitBtn.Focus();\nSubmitBtn.PerformClick();\n}\n</code></pre>\n\n<p>I just need the program to click a button once CTRL+ENTER is pressed. The button itself does the rest of the work.</p>\n"}, {"tags": ["c#", "azure-cosmosdb", "azure-cosmosdb-sqlapi"], "comments": [{"owner": {"reputation": 9215, "user_id": 5641598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b3f7d049c5109218dbefd86712da2d5?s=128&d=identicon&r=PG", "display_name": "Matias Quaranta", "link": "https://stackoverflow.com/users/5641598/matias-quaranta"}, "edited": false, "score": 0, "creation_date": 1563998266, "post_id": 57189075, "comment_id": 100890562, "body": "Which version of the SDK package are you using?"}, {"owner": {"reputation": 1013, "user_id": 7536864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cabd23035f69f6d95474f5396cd13e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gy&#246;rgy Guly&#225;s", "link": "https://stackoverflow.com/users/7536864/gy%c3%b6rgy-guly%c3%a1s"}, "reply_to_user": {"reputation": 9215, "user_id": 5641598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b3f7d049c5109218dbefd86712da2d5?s=128&d=identicon&r=PG", "display_name": "Matias Quaranta", "link": "https://stackoverflow.com/users/5641598/matias-quaranta"}, "edited": false, "score": 0, "creation_date": 1564146817, "post_id": 57189075, "comment_id": 100945878, "body": "I use the Azure Cosmos DB .NET SDK Version 3.0.0.1-preview"}], "answers": [{"comments": [{"owner": {"reputation": 1013, "user_id": 7536864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cabd23035f69f6d95474f5396cd13e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gy&#246;rgy Guly&#225;s", "link": "https://stackoverflow.com/users/7536864/gy%c3%b6rgy-guly%c3%a1s"}, "edited": false, "score": 0, "creation_date": 1564217144, "post_id": 57222770, "comment_id": 100964433, "body": "But in your code there is no any index creation! Anyway I will update the driver, and I will try it"}, {"owner": {"reputation": 1013, "user_id": 7536864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cabd23035f69f6d95474f5396cd13e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gy&#246;rgy Guly&#225;s", "link": "https://stackoverflow.com/users/7536864/gy%c3%b6rgy-guly%c3%a1s"}, "edited": false, "score": 0, "creation_date": 1564217297, "post_id": 57222770, "comment_id": 100964471, "body": "Same effect with newest version as well. The index is not in the container properties"}, {"owner": {"reputation": 9215, "user_id": 5641598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b3f7d049c5109218dbefd86712da2d5?s=128&d=identicon&r=PG", "display_name": "Matias Quaranta", "link": "https://stackoverflow.com/users/5641598/matias-quaranta"}, "reply_to_user": {"reputation": 1013, "user_id": 7536864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cabd23035f69f6d95474f5396cd13e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gy&#246;rgy Guly&#225;s", "link": "https://stackoverflow.com/users/7536864/gy%c3%b6rgy-guly%c3%a1s"}, "edited": false, "score": 0, "creation_date": 1564417574, "post_id": 57222770, "comment_id": 101015205, "body": "@Gy&#246;rgyGuly&#225;s I edited the code sample, adding an ExcludedPath during creation also returns the correct value after a query."}], "tags": [], "owner": {"reputation": 9215, "user_id": 5641598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6b3f7d049c5109218dbefd86712da2d5?s=128&d=identicon&r=PG", "display_name": "Matias Quaranta", "link": "https://stackoverflow.com/users/5641598/matias-quaranta"}, "is_accepted": true, "score": 1, "last_activity_date": 1564417272, "last_edit_date": 1564417272, "creation_date": 1564153706, "answer_id": 57222770, "question_id": 57189075, "link": "https://stackoverflow.com/questions/57189075/how-can-i-get-the-containerproperties-with-indexes-from-an-existing-container-in/57222770#57222770", "title": "How can I get the ContainerProperties with Indexes from an existing container in CosmosDB", "body": "<p>From the comments, you are using a preview version of the SDK, please update to the <a href=\"https://www.nuget.org/packages/Microsoft.Azure.Cosmos\" rel=\"nofollow noreferrer\">latest GA release</a>, which is <code>3.0.0</code> at this time.</p>\n\n<p>On that version, running the code that you shared, returns a <code>ContainerProperties</code> instance that has the IndexingPolicy populated.</p>\n\n<pre><code>ContainerProperties containerDefinition = new ContainerProperties(new Guid().ToString(), \"/id\");\ncontainerDefinition.IndexingPolicy.ExcludedPaths.Add(new Cosmos.ExcludedPath()\n{\n    Path = \"/*\"\n});\nContainerResponse response = await cosmosDatabase.CreateContainerAsync(containerDefinition);\nFeedIterator&lt;ContainerProperties&gt; resultSet = cosmosDatabase.GetContainerQueryIterator&lt;ContainerProperties&gt;(($\"select * from c where c.id = \\\"{response.Container.Id}\\\"\"));\nFeedResponse&lt;ContainerProperties&gt; queryProperties = resultSet.ReadNextAsync().Result;\nContainerProperties containerSettings = queryProperties.Resource.ToList().FirstOrDefault();\nAssert.AreEqual(containerDefinition.IndexingPolicy.ExcludedPaths.First().Path, containerSettings.IndexingPolicy.ExcludedPaths.First().Path);\n</code></pre>\n"}], "owner": {"reputation": 1013, "user_id": 7536864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cabd23035f69f6d95474f5396cd13e3?s=128&d=identicon&r=PG&f=1", "display_name": "Gy&#246;rgy Guly&#225;s", "link": "https://stackoverflow.com/users/7536864/gy%c3%b6rgy-guly%c3%a1s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 57222770, "answer_count": 1, "score": 1, "last_activity_date": 1564417272, "creation_date": 1563992511, "last_edit_date": 1564002193, "question_id": 57189075, "link": "https://stackoverflow.com/questions/57189075/how-can-i-get-the-containerproperties-with-indexes-from-an-existing-container-in", "title": "How can I get the ContainerProperties with Indexes from an existing container in CosmosDB", "body": "<p>I created a container with container properties, and this <code>ContainerProperties</code> contains indexes.</p>\n\n<p>How can I get back the <code>ContainerProperties</code> from cosmos later.\nI use following code:</p>\n\n<pre><code>FeedIterator&lt;ContainerProperties&gt; resultSet = CosmosDatabase.GetContainerQueryIterator&lt;ContainerProperties&gt;( ($\"select * from c where c.id = \\\"{collectionName}\\\"\") );\nFeedResponse&lt;ContainerProperties&gt; queryProperties = resultSet.ReadNextAsync().Result;\n\nContainerProperties containerProperties = queryProperties.Resource.ToList().FirstOrDefault()\n</code></pre>\n\n<p>There is a <code>ContainerProperties</code> and the name is filled correctly, and this is what I want, but the indexes are empty. The <code>containerProperties.IndexingPolicy.IncludedPaths</code> and the <code>containerProperties.IndexingPolicy.ExcludedPaths</code>  does not contains any element. But when I created it, it does.</p>\n"}, {"tags": ["c#", "azure", "azure-media-services"], "answers": [{"comments": [{"owner": {"reputation": 789, "user_id": 4659089, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9bdb9f0ba256952e98888bfd549c715b?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/4659089/john"}, "edited": false, "score": 0, "creation_date": 1563995906, "post_id": 57189241, "comment_id": 100889566, "body": "We are looking at running FFMpeg to do the transcription.  We were hoping to avoid downloading the file to do the transform and hoping it could be done in azure.   We have a micoservice that will be running to move the wav file to the transcription service, so we can modify it to use FFMpeg to do the transform first.  Thanks."}, {"owner": {"reputation": 570, "user_id": 6331794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/778b88f2a23e0f6e41ea48a910b1d024?s=128&d=identicon&r=PG&f=1", "display_name": "Anil Murching", "link": "https://stackoverflow.com/users/6331794/anil-murching"}, "reply_to_user": {"reputation": 789, "user_id": 4659089, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9bdb9f0ba256952e98888bfd549c715b?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/4659089/john"}, "edited": false, "score": 0, "creation_date": 1564071565, "post_id": 57189241, "comment_id": 100919458, "body": "Presume you know that you can write that microservice using Azure Functions? With an App Service plan, I am told that you can have long running Functions (default timeout of 30min which can be extended further). Thanks"}], "tags": [], "owner": {"reputation": 570, "user_id": 6331794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/778b88f2a23e0f6e41ea48a910b1d024?s=128&d=identicon&r=PG&f=1", "display_name": "Anil Murching", "link": "https://stackoverflow.com/users/6331794/anil-murching"}, "is_accepted": false, "score": 0, "last_activity_date": 1563993217, "creation_date": 1563993217, "answer_id": 57189241, "question_id": 57189061, "link": "https://stackoverflow.com/questions/57189061/convert-an-mp4-to-wav-file-using-azure-media-services-transforms/57189241#57189241", "title": "Convert an MP4 to WAV file using Azure media-services transforms", "body": "<p>Short answer: no, you can't create a Transform in our service today that will enable you to decode an MP4 input file into a WAV output file.</p>\n\n<p>Where are you running your transcription software? Have you considered running open source SW like ffmpeg on those compute instances to convert MP4 to WAV?</p>\n\n<p>Thanks</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 11842486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff1f9c4eb9e3ad7e167859dfcf57cc2?s=128&d=identicon&r=PG&f=1", "display_name": "Xavier Pouyat", "link": "https://stackoverflow.com/users/11842486/xavier-pouyat"}, "is_accepted": true, "score": 0, "last_activity_date": 1564412311, "creation_date": 1564412311, "answer_id": 57256436, "question_id": 57189061, "link": "https://stackoverflow.com/questions/57189061/convert-an-mp4-to-wav-file-using-azure-media-services-transforms/57256436#57256436", "title": "Convert an MP4 to WAV file using Azure media-services transforms", "body": "<p>Here is a sample of an Azure function that can encode a Azure blob and output to a blob blob. <a href=\"https://github.com/Azure-Samples/media-services-v3-dotnet-core-functions-integration/tree/master/Encoding\" rel=\"nofollow noreferrer\">https://github.com/Azure-Samples/media-services-v3-dotnet-core-functions-integration/tree/master/Encoding</a></p>\n"}], "owner": {"reputation": 789, "user_id": 4659089, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9bdb9f0ba256952e98888bfd549c715b?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/4659089/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 57256436, "answer_count": 2, "score": 0, "last_activity_date": 1564412311, "creation_date": 1563992457, "question_id": 57189061, "link": "https://stackoverflow.com/questions/57189061/convert-an-mp4-to-wav-file-using-azure-media-services-transforms", "title": "Convert an MP4 to WAV file using Azure media-services transforms", "body": "<p>We have a blob storage that we are putting MP4 files into.  We want to create a function that watches for the incoming files (like a pub/sub), and then using azure media-services encode the file to a wav, and save the transformed artifact to another blob storage container.  I can create the job to watch for the files that come in, the problem we are having is finding out how to create a wav file using the media-services transforms. We are trying to avoid having to copy the MP4 files to another location to encode them to wav files, then deleting the MP4 file and the wav file once we are done.  These files can run into the gig size quite a bit.</p>\n\n<p>We use the wav files to transcribe them into text (our transcription software requires the files in wav format).  We looked at the azure speech services to do the transcriptions, but it is cost prohibitive, and the transcription software we currently use is specialized for our line of work and more efficient at transcriptions.</p>\n\n<p>I guess the first question is \"Is it possible to transform an MP4 to wav using azure media-services?\"  If so, does someone have an example on how this is done?</p>\n\n<p>Thanks.  </p>\n"}, {"tags": ["c#", ".net", "windows", "uac", "administrator"], "comments": [{"owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1563992753, "post_id": 57188988, "comment_id": 100888285, "body": "You problem is not admin let me tell you that. It&#39;s the way you are dealing with your interop that has something wrong"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 1, "creation_date": 1563992761, "post_id": 57188988, "comment_id": 100888290, "body": "I&#39;m curious as to why you are doing the development as admin?"}, {"owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1563993571, "post_id": 57188988, "comment_id": 100888642, "body": "@lurker Visual Studio has to be in admin to use &quot;Register for COM Interop.&quot;  That&#39;s for a different project, but if I forget to switch back things start going wrong, and it&#39;s hard to figure out why."}, {"owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1563993841, "post_id": 57188988, "comment_id": 100888750, "body": "@TheGreatB3 No it does not necessary. This is only because you run from F5. The exe ran from VS use same credential as VS was started with. This can also be limited with Domain policy where even with run as admin you wont be able to register due to limitation with new registry key."}, {"owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "reply_to_user": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1563995203, "post_id": 57188988, "comment_id": 100889233, "body": "@Franck I&#39;m not sure we&#39;re on the same page.  One VS solution makes an assembly that is registered for COM interop, and thus has to be built with VS as admin.  The other solution makes an EXE and connects with other programs that are already running (not as admin).  The problem happens when I run the EXE solution from VS (F5) if VS is still admin, because it runs the EXE as admin."}, {"owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1563995987, "post_id": 57188988, "comment_id": 100889611, "body": "How is a COM interop a running process ? A COM Interop is just a DLL front it&#39;s not actively running."}, {"owner": {"reputation": 2666, "user_id": 937093, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f1cebb492bf988423f44b552cd8c5c0?s=128&d=identicon&r=PG", "display_name": "Steffen Winkler", "link": "https://stackoverflow.com/users/937093/steffen-winkler"}, "edited": false, "score": 0, "creation_date": 1563997034, "post_id": 57188988, "comment_id": 100890064, "body": "would <a href=\"https://stackoverflow.com/a/41110726/937093\">this</a> help solve your issue?"}, {"owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "reply_to_user": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1563997049, "post_id": 57188988, "comment_id": 100890072, "body": "@Franck The COM DLL doesn&#39;t run.  The EXE runs, and it&#39;s supposed to connect to a running Excel process.  But if the EXE is run from VS when VS is still admin, then the EXE is admin, and instead of connecting to the running Excel process, it tries to start Excel as admin, which I don&#39;t want."}, {"owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "reply_to_user": {"reputation": 2666, "user_id": 937093, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3f1cebb492bf988423f44b552cd8c5c0?s=128&d=identicon&r=PG", "display_name": "Steffen Winkler", "link": "https://stackoverflow.com/users/937093/steffen-winkler"}, "edited": false, "score": 0, "creation_date": 1563997316, "post_id": 57188988, "comment_id": 100890184, "body": "@SteffenWinkler I think it would, thank you."}], "owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563992120, "creation_date": 1563992120, "question_id": 57188988, "link": "https://stackoverflow.com/questions/57188988/how-do-i-force-my-c-application-to-not-run-as-administrator", "title": "How do I force my C# application to NOT run as administrator?", "body": "<p>When I'm running Visual Studio as admin, and I use it to run my C# application, it automatically runs the application as admin.<br>\nThis causes problems when it tries to use interop, because instead of connecting to running processes, it launches new ones as admin.<br>\nIt's an easy mistake to make, and debugging doesn't help catch it.  </p>\n\n<p>I'd like to make sure the application runs at a lower UAC level, or stop it from running at all if the permissions are wrong.</p>\n\n<p>I'm aware of <code>&lt;requestedExecutionLevel&gt;</code> in the application manifest.  The problem is that the only <code>level</code>s it seems to provide are <code>asInvoker</code>, <code>requireAdministrator</code>, and <code>highestAvailable</code>.  As far as I can tell, these only raise the level, not lower it.  </p>\n"}, {"tags": ["c#", "json", "unity3d"], "comments": [{"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 0, "creation_date": 1563992068, "post_id": 57188956, "comment_id": 100887975, "body": "Welcome to StackOverflow! what is a <code>ReactiveProperty</code>? Why don&#39;t you simply use <code>int</code>?"}, {"owner": {"reputation": 39, "user_id": 11816263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353fe5088c78faa27471a390f0f41097?s=128&d=identicon&r=PG&f=1", "display_name": "bawbaw44", "link": "https://stackoverflow.com/users/11816263/bawbaw44"}, "reply_to_user": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 0, "creation_date": 1563992144, "post_id": 57188956, "comment_id": 100888005, "body": "Like I said, it&#39;s a type coming from UniRx ( <a href=\"https://github.com/neuecc/UniRx\" rel=\"nofollow noreferrer\">github.com/neuecc/UniRx</a> ) which is a library for Unity that reimplement .NET reactive extensions. It allows me to be notified when this value change and update my UI."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11816263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353fe5088c78faa27471a390f0f41097?s=128&d=identicon&r=PG&f=1", "display_name": "bawbaw44", "link": "https://stackoverflow.com/users/11816263/bawbaw44"}, "edited": false, "score": 0, "creation_date": 1563994375, "post_id": 57189041, "comment_id": 100888957, "body": "Thanks, it would work, I find it&#39;s also tedious ( i need to define two fields for all reactive properties ) but it seems like I don&#39;t have other choice here."}], "tags": [], "owner": {"reputation": 89, "user_id": 11705765, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0df82e9997b935c193552b1bdbe992f4?s=128&d=identicon&r=PG", "display_name": "user11705765", "link": "https://stackoverflow.com/users/11705765/user11705765"}, "is_accepted": true, "score": 0, "last_activity_date": 1563992368, "creation_date": 1563992368, "answer_id": 57189041, "question_id": 57188956, "link": "https://stackoverflow.com/questions/57188956/deserialize-json-to-nested-classes-with-reactiveproperty-fields/57189041#57189041", "title": "Deserialize JSON to nested classes with ReactiveProperty fields", "body": "<p>Make the Reactive property fields NonSerializable.</p>\n\n<p>Make new serializable String fields.</p>\n\n<p>Deserialize the JSON.</p>\n\n<p>Add some functions to your class(es) that cast the string representations into your ReactiveProperty variables.  </p>\n\n<p>Call those functions after you desierialize your JSON.</p>\n\n<p>Note:  I am unfamiliar with ReactiveProperty, you'll need to investigate that library to find the best way of casting a string into those objects.</p>\n"}], "owner": {"reputation": 39, "user_id": 11816263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353fe5088c78faa27471a390f0f41097?s=128&d=identicon&r=PG&f=1", "display_name": "bawbaw44", "link": "https://stackoverflow.com/users/11816263/bawbaw44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 1, "accepted_answer_id": 57189041, "answer_count": 1, "score": 0, "last_activity_date": 1563992982, "creation_date": 1563991969, "question_id": 57188956, "link": "https://stackoverflow.com/questions/57188956/deserialize-json-to-nested-classes-with-reactiveproperty-fields", "title": "Deserialize JSON to nested classes with ReactiveProperty fields", "body": "<p>I'm calling an API endpoint that return me a JSON some data and I need to deserialize it into classes and nested classes that may contains ReactiveProperty fields ( a type coming from UniRx library which is a reimplemntation of Reactive extensions for Unity3D ).</p>\n\n<p>I'm new to C#, I tried some things, but I can't achieve it the way i want.</p>\n\n<p>Here is the json returned by my Api ( in reality there are more data but this example will suffice ) : </p>\n\n<pre><code>   \"user\": {\n        \"id\": \"87f2ae6e-af99-4f8e-9d69-08de6ad6baf8\",\n        \"username\": \"test\",\n        \"email\": \"test@test.com\",\n        \"money\": 800,\n        \"morale\": 100,\n        \"health\": 100,\n        \"credits\": 15,\n        \"energy\": 100,\n        \"banned_at\": null,\n        \"last_connection\": null,\n        \"officers\": [\n            {\n                \"id\": \"2b72d9d4-635c-4b32-9575-5df49f566e93\",\n                \"name\": \"David Le Salmon\",\n                \"is_available\": true,\n                \"age\": 42,\n                \"condition\": 100,\n                \"user_id\": \"87f2ae6e-af99-4f8e-9d69-08de6ad6baf8\"\n            },\n            {\n                \"id\": \"ebc4074c-7b94-4ea3-96d9-f80608972afa\",\n                \"name\": \"Philippe Mercier\",\n                \"is_available\": true,\n                \"age\": 34,\n                \"condition\": 100,\n                \"user_id\": \"87f2ae6e-af99-4f8e-9d69-08de6ad6baf8\"\n            },\n            {\n                \"id\": \"edba67b5-9053-4fd6-b64e-6b85f4d0cc25\",\n                \"name\": \"Raymond Wagner-Berthelot\",\n                \"is_available\": true,\n                \"age\": 55,\n                \"condition\": 100,\n                \"user_id\": \"87f2ae6e-af99-4f8e-9d69-08de6ad6baf8\"\n            }\n        ],\n        \"vehicles\": [\n            {\n                \"id\": \"3161d274-ed2a-491b-8515-beb7da9bfd29\",\n                \"mileage\": 0,\n                \"health\": 100,\n                \"level\": 3,\n                \"equipment_level\": 4,\n                \"vehicle_prefab_id\": \"14e8d96f-0e85-40ad-b01b-5f00a37b1108\"\n            },\n            {\n                \"id\": \"ff984c79-4511-4ade-92d1-9bf6899a243c\",\n                \"mileage\": 0,\n                \"health\": 100,\n                \"level\": 4,\n                \"equipment_level\": 4,\n                \"vehicle_prefab_id\": \"14e8d96f-0e85-40ad-b01b-5f00a37b1108\"\n            }\n        ]\n    }\n}\n</code></pre>\n\n<p>I defined some classes like this : </p>\n\n<pre><code>[Serializable]\npublic class AppState {\n    public User user = new User();\n}\n\n</code></pre>\n\n<pre><code>[Serializable]\npublic class User {\n    public string username;\n    public string email;\n    public ReactiveProperty&lt;int&gt; money = new ReactiveProperty&lt;int&gt;();\n    public ReactiveProperty&lt;int&gt; morale = new ReactiveProperty&lt;int&gt;();\n    public ReactiveProperty&lt;int&gt; health = new ReactiveProperty&lt;int&gt;();\n    public ReactiveProperty&lt;int&gt; energy = new ReactiveProperty&lt;int&gt;();\n    public List&lt;Officer&gt; officers = new List&lt;Officer[]&gt;();\n    public List&lt;Vehicles&gt; vehicles = new List&lt;Vehicle&gt;();\n}\n</code></pre>\n\n<p><code>Officer</code> and <code>Vehicle</code> are defined in the same way, some fields are ReactiveProperty, some not.</p>\n\n<p>And here how I tried to deserialize :</p>\n\n<pre><code>RestClient.Get(\"/getAppState\").Then(response =&gt; {\n    var stuff = JsonConvert.DeserializeObject&lt;AppState&gt;(response.Text);\n})\n</code></pre>\n\n<p>This code throws this error :</p>\n\n<pre><code>Could not cast or convert from System.String to UniRx.ReactiveProperty\n</code></pre>\n\n<p>I found something that \"work\", I assigned all ReactiveProperty fields manually, but it's really tedious.</p>\n\n<p>Is there a way to do this in C#?</p>\n"}, {"tags": ["c#", "entity-framework", "linq", "generics"], "comments": [{"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 1, "creation_date": 1563991778, "post_id": 57188907, "comment_id": 100887839, "body": "automapper can help with this sort of scenario."}, {"owner": {"reputation": 1, "user_id": 10215803, "user_type": "registered", "profile_image": "https://graph.facebook.com/2058629030828448/picture?type=large", "display_name": "El Kay", "link": "https://stackoverflow.com/users/10215803/el-kay"}, "reply_to_user": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1563995999, "post_id": 57188907, "comment_id": 100889616, "body": "@DanielA.White many thanks. it works for me. you saved my day."}], "owner": {"reputation": 1, "user_id": 10215803, "user_type": "registered", "profile_image": "https://graph.facebook.com/2058629030828448/picture?type=large", "display_name": "El Kay", "link": "https://stackoverflow.com/users/10215803/el-kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563991892, "creation_date": 1563991706, "last_edit_date": 1563991892, "question_id": 57188907, "link": "https://stackoverflow.com/questions/57188907/cast-iqueryable-generic-to-another-iqueryable-generic", "title": "Cast IQueryable generic to another IQueryable generic", "body": "<p>I would like to have a common class for my business layers (BL) which has a method convert IQueryable to IQueryable.\n- efo: Entity Framework object\n- bo: business object</p>\n\n<p>I'm using Entity Framework Core.</p>\n\n<pre><code>public partial class Language //EF object\n{\n    public long Id { get; set; }\n    public string Code { get; set; }\n    public string Name { get; set; }\n    public string Image { get; set; }\n\n    public virtual ICollection&lt;News&gt; News { get; set; }\n}\n\npublic class BOLanguage //Business object\n{\n    public string Name { get; set; }\n    public string Image { get; set; }\n}\n\npublic class BL&lt;efo, bo&gt;\n       where efo : class, new()\n       where bo : class, new()\n{\n    public Context context;\n    public BL()\n    {\n        context = new Context();\n    }\n\n    public IQueryable&lt;bo&gt; SelectAll()\n    {\n        IQueryable&lt;efo&gt; query = context.Set&lt;efo&gt;();\n        return query.Select(x =&gt; new bo\n        {\n           //TODO: I don't know how to do here \n        });;\n    }\n\n    //public IQueryable&lt;BOLanguage&gt; SelectAll() //example\n    //{\n    //    return context.Language.Select(x =&gt; new BOLanguage\n    //    {\n    //        Name = x.Name,\n    //        Image = x.Image\n    //    });\n    //}\n}\n</code></pre>\n\n<p>Thank you. Hope you understand.</p>\n"}, {"tags": ["c#", "performance", "linq", "search"], "answers": [{"comments": [{"owner": {"reputation": 3233, "user_id": 2630427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb9b9af50987875657ed5b86bcef0aa?s=128&d=identicon&r=PG", "display_name": "ilkerkaran", "link": "https://stackoverflow.com/users/2630427/ilkerkaran"}, "edited": false, "score": 1, "creation_date": 1564057108, "post_id": 57201705, "comment_id": 100911110, "body": "This is a poorly described answer whether the link may contain the solution. You should elaborate at least some part of the link in your answer."}, {"owner": {"reputation": 3233, "user_id": 2630427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ceb9b9af50987875657ed5b86bcef0aa?s=128&d=identicon&r=PG", "display_name": "ilkerkaran", "link": "https://stackoverflow.com/users/2630427/ilkerkaran"}, "edited": false, "score": 0, "creation_date": 1564060124, "post_id": 57201705, "comment_id": 100912985, "body": "changed my vote upon your edit. Thanks for the answer. happy coding."}, {"owner": {"reputation": 193, "user_id": 3212927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/554a520974d72a45b4b55ec986c11b3b?s=128&d=identicon&r=PG", "display_name": "Vis", "link": "https://stackoverflow.com/users/3212927/vis"}, "edited": false, "score": 0, "creation_date": 1564065012, "post_id": 57201705, "comment_id": 100915921, "body": "Thanks for your answer, but this is not a solution to my issue. The first suggestion with the various helper methods has a lot of overhead (will convert Strings of filepaths to FileInfo objects, build up large amounts of memory with the recursion). This slows the query down significantly. The later is indeed more elegant. I have seen this solution (you forgot to copy in the most important part though: the ExceptionExtension), but I could not get this to work. It still throws  UnauthorizedAccessExceptions."}], "tags": [], "owner": {"reputation": 408, "user_id": 3798087, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6YidD.png?s=128&g=1", "display_name": "Power Mouse", "link": "https://stackoverflow.com/users/3798087/power-mouse"}, "is_accepted": false, "score": 1, "last_activity_date": 1564065293, "last_edit_date": 1564065293, "creation_date": 1564056746, "answer_id": 57201705, "question_id": 57188867, "link": "https://stackoverflow.com/questions/57188867/handle-skip-unauthorizedaccessexception-in-enumeratefiles-linq-c/57201705#57201705", "title": "Handle (skip) UnauthorizedAccessException in EnumerateFiles() LINQ C#", "body": "<p>Answer EDITED:\nA workaround is to call it recursively instead of using SearchOption.AllDirectories. This is actually more inefficient in your case because you don't need to load every file in the filesystem into an array. Start with the following helper methods:</p>\n\n<pre><code>    List&lt;string&gt; GetDirectoriesRecursive (string parent)\n    {\n        var directories = new List&lt;string&gt;();\n        GetDirectoriesRecursive (directories, parent);\n        return directories;\n    }\n\n    void GetDirectoriesRecursive (List&lt;string&gt; directories, string parent)\n    {\n        directories.Add (parent);\n        foreach (string child in GetAuthorizedDirectories (parent))\n            GetDirectoriesRecursive (directories, child);\n    }\n\n    string[] GetAuthorizedDirectories (string dir)\n    {\n        try { return Directory.GetDirectories (dir); }\n        catch (UnauthorizedAccessException) { return new string[0]; }\n    }\n\n    string[] GetAuthorizedFiles (string dir)\n    {\n        try { return Directory.GetFiles (dir); }\n        catch (UnauthorizedAccessException) { return new string[0]; }\n    }\n</code></pre>\n\n<p>Then, to get the big files:</p>\n\n<pre><code>     var bigFiles =\n         from dir in GetDirectoriesRecursive ( @\"c:\\\" )\n         from file in GetAuthorizedFiles (dir)\n         where new FileInfo (file).Length &gt; 100000000 \n         select file;\n</code></pre>\n\n<p>Or, to get just their directories:</p>\n\n<pre><code>     var foldersWithBigFiles =\n         from dir in GetDirectoriesRecursive ( @\"c:\\\" )\n         where GetAuthorizedFiles (dir).Any (f =&gt; new FileInfo (f).Length &gt; 100000000 )\n         select dir;\n</code></pre>\n\n<p>ANOTHER APPROACH:</p>\n\n<pre><code> string[] directories = Directory.EnumerateDirectories(@\"\\\\testnetwork\\abc$\",\"*.*\", SearchOption.AllDirectories).Catch(typeof(UnauthorizedAccessException)).ToArray();\n</code></pre>\n\n<p>ADDED missing part:</p>\n\n<pre><code>static class ExceptionExtensions\n{\npublic static IEnumerable&lt;TIn&gt; Catch&lt;TIn&gt;(\n            this IEnumerable&lt;TIn&gt; source,\n            Type exceptionType)\n{   \n    using (var e = source.GetEnumerator())\n    while (true)\n    {\n        var ok = false;\n\n        try\n        {\n            ok = e.MoveNext();\n        }\n        catch(Exception ex)\n        {\n            if (ex.GetType() != exceptionType)\n                throw;\n            continue;\n        }\n\n        if (!ok)\n            yield break;\n\n        yield return e.Current;\n    }\n}\n}\n\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3212927, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/554a520974d72a45b4b55ec986c11b3b?s=128&d=identicon&r=PG", "display_name": "Vis", "link": "https://stackoverflow.com/users/3212927/vis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564065293, "creation_date": 1563991543, "question_id": 57188867, "link": "https://stackoverflow.com/questions/57188867/handle-skip-unauthorizedaccessexception-in-enumeratefiles-linq-c", "title": "Handle (skip) UnauthorizedAccessException in EnumerateFiles() LINQ C#", "body": "<p>I am trying to write a high performance file system searcher that can search unindexed drives (both local and network) very fast filtering on extensions and keywords. I am trying to achieve this using C#'s <code>DirectoryInfo.EnumerateDirectories()</code>, <code>DirectoryInfo.EnumerateFiles()</code> and LINQ queries. From my testing, this is (by far) the best performing code I could find: </p>\n\n<pre><code>\nFileInfo[] dirFiles = dirInfo.EnumerateDirectories()\n                            .AsParallel()\n                            .SelectMany(di =&gt; di.EnumerateFiles(\"*.*\", SearchOption.AllDirectories)\n                                                .Where(fi =&gt; EndsWithExtension(fi.Extension)) )\n                                                .ToArray();\n</code></pre>\n\n<p>However, the <code>UnauthorizedAccessException</code> is not handled and when thrown, crashes the entire query.</p>\n\n<p>I've tried various ways as outlined on SO related to this issue, but I found that they are significantly slower in search performance. This second best method I found working is over 20 times slower for example: </p>\n\n<pre><code>try {\n    foreach (string fileName in EnumerateFiles(dirInfo, \"*.*\", SearchOption.AllDirectories)) {\n        if (ContainsKeyword(fileName)) {\n             Results.Add(fileName.FullName);\n        }\n    }\n} catch (Exception e) { continue; }\n\n</code></pre>\n\n<p>I would like to skip over the directory when it throws an exception. I've being trying to achieve this with something similar to this, but I can't get it to work (my knowledge of LINQ and Enumerables is too limited...): </p>\n\n<pre><code>FileInfo[] dirFiles = dirInfo.EnumerateDirectories()\n                            .AsParallel()\n                            .SelectMany(di =&gt; di.EnumerateFiles(\"*.*\", SearchOption.AllDirectories)\n                                                .SkipExceptions()\n                                                .Where(fi =&gt; EndsWithExtension(fi.Extension)) )\n                                                .ToArray();\n\npublic static class Extensions {\n        public static IEnumerable&lt;T&gt; SkipExceptions&lt;T&gt;(this IEnumerable&lt;T&gt; values) {\n            using (var enumerator = values.GetEnumerator()) {\n                bool next = true;\n                while (next) {\n                    try {\n                        if (enumerator.Current != null)\n                            Console.WriteLine(enumerator.Current.ToString()); \n                        next = enumerator.MoveNext();\n                    } catch {\n                        continue;\n                    }\n\n                    if (next) yield return enumerator.Current;\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>Is it possible to handle (<code>UnauthorizedAccess</code>) exceptions, while still remaining as high performant as the \"raw\" LINQ query?</p>\n\n<p>Thanks in advance for your help!</p>\n"}, {"tags": ["c#", "visual-studio-code"], "comments": [{"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 5, "creation_date": 1563991224, "post_id": 57188772, "comment_id": 100887557, "body": "do you have a reference to an assembly that has that namespace in it?"}, {"owner": {"reputation": 155, "user_id": 10000684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b383ff8552d995d374d9d1b1c1ff874c?s=128&d=identicon&r=PG&f=1", "display_name": "katiedidkatie", "link": "https://stackoverflow.com/users/10000684/katiedidkatie"}, "reply_to_user": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1563991350, "post_id": 57188772, "comment_id": 100887621, "body": "@DanielA.White I don&#39;t believe so... this is the only file in the project that references System.Deployment.Application"}, {"owner": {"reputation": 155, "user_id": 10000684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b383ff8552d995d374d9d1b1c1ff874c?s=128&d=identicon&r=PG&f=1", "display_name": "katiedidkatie", "link": "https://stackoverflow.com/users/10000684/katiedidkatie"}, "reply_to_user": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1563992759, "post_id": 57188772, "comment_id": 100888288, "body": "@DanielA.White I just trying running the line <code>dotnet add package System.Deployment.dll</code> and the terminal says the project does not support adding package references through the add package command"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 10000684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b383ff8552d995d374d9d1b1c1ff874c?s=128&d=identicon&r=PG&f=1", "display_name": "katiedidkatie", "link": "https://stackoverflow.com/users/10000684/katiedidkatie"}, "edited": false, "score": 0, "creation_date": 1563991727, "post_id": 57188886, "comment_id": 100887814, "body": "Where can I find the Solution Explorer?"}, {"owner": {"reputation": 155, "user_id": 10000684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b383ff8552d995d374d9d1b1c1ff874c?s=128&d=identicon&r=PG&f=1", "display_name": "katiedidkatie", "link": "https://stackoverflow.com/users/10000684/katiedidkatie"}, "edited": false, "score": 0, "creation_date": 1563991814, "post_id": 57188886, "comment_id": 100887856, "body": "If it helps, I have VS Code verision 1.35.1"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "reply_to_user": {"reputation": 155, "user_id": 10000684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b383ff8552d995d374d9d1b1c1ff874c?s=128&d=identicon&r=PG&f=1", "display_name": "katiedidkatie", "link": "https://stackoverflow.com/users/10000684/katiedidkatie"}, "edited": false, "score": 1, "creation_date": 1563991866, "post_id": 57188886, "comment_id": 100887881, "body": "@katiedidkatie: Despite the confusing name, &quot;Visual Studio&quot; and &quot;Visual Studio Code&quot; are entirely different applications. I suspect you want to find a VS Code tag for your post."}, {"owner": {"reputation": 306, "user_id": 4355568, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nBPdrG9Ic20/AAAAAAAAAAI/AAAAAAAAAE0/VztffFoZ_A0/photo.jpg?sz=128", "display_name": "Ali Maleki", "link": "https://stackoverflow.com/users/4355568/ali-maleki"}, "edited": false, "score": 1, "creation_date": 1563992023, "post_id": 57188886, "comment_id": 100887954, "body": "read this : <a href=\"https://stackoverflow.com/questions/31888274/how-to-reference-assemblies-using-visual-studio-code\" title=\"how to reference assemblies using visual studio code\">stackoverflow.com/questions/31888274/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 7428141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674819d4cbd2c1fdbecf24072b1a7a15?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7428141/brad"}, "reply_to_user": {"reputation": 155, "user_id": 10000684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b383ff8552d995d374d9d1b1c1ff874c?s=128&d=identicon&r=PG&f=1", "display_name": "katiedidkatie", "link": "https://stackoverflow.com/users/10000684/katiedidkatie"}, "edited": false, "score": 1, "creation_date": 1563992214, "post_id": 57188886, "comment_id": 100888041, "body": "@katiedidkatie Like Jon mentioned, Visual Studio and Visual Studio Code are two very different beasts. I was assuming that you were not using Visual Studio Code. This may help you : <a href=\"https://stackoverflow.com/questions/42000798/how-to-add-assembly-references-in-visual-studio-code/42399545\" title=\"how to add assembly references in visual studio code\">stackoverflow.com/questions/42000798/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11, "user_id": 7428141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/674819d4cbd2c1fdbecf24072b1a7a15?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7428141/brad"}, "is_accepted": false, "score": 1, "last_activity_date": 1563993241, "last_edit_date": 1563993241, "creation_date": 1563991631, "answer_id": 57188886, "question_id": 57188772, "link": "https://stackoverflow.com/questions/57188772/c-type-does-not-exist-in-the-namespace-name-does-not-exist-in-the-current-conte/57188886#57188886", "title": "C# type does not exist in the namespace/name does not exist in the current context", "body": "<p>From Visual Studio Code, open your.csproj file. In this file you can add an assembly reference to System.Deployment which should fix you issue. </p>\n\n<p>Reference:</p>\n\n<pre><code>    &lt;Reference Include=\"System.Deployment\"/&gt;\n</code></pre>\n\n<p>This will be added in the ItemGroup Section of the .csproj file</p>\n\n<pre><code>&lt;ItemGroup&gt;\n&lt;Reference Include=\"System\" /&gt;\n&lt;Reference Include=\"System.Core\" /&gt;\n&lt;Reference Include=\"System.Xml.Linq\" /&gt;\n&lt;Reference Include=\"System.Data.DataSetExtensions\" /&gt;\n&lt;Reference Include=\"Microsoft.CSharp\" /&gt;\n&lt;Reference Include=\"System.Data\" /&gt;\n&lt;Reference Include=\"System.Net.Http\" /&gt;\n&lt;Reference Include=\"System.Xml\" /&gt;\n&lt;Reference Include=\"System.Deployment\"/&gt;\n&lt;/ItemGroup&gt;\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 10000684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b383ff8552d995d374d9d1b1c1ff874c?s=128&d=identicon&r=PG&f=1", "display_name": "katiedidkatie", "link": "https://stackoverflow.com/users/10000684/katiedidkatie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563993241, "creation_date": 1563991137, "last_edit_date": 1563991913, "question_id": 57188772, "link": "https://stackoverflow.com/questions/57188772/c-type-does-not-exist-in-the-namespace-name-does-not-exist-in-the-current-conte", "title": "C# type does not exist in the namespace/name does not exist in the current context", "body": "<p>I have the line <code>using System.Deployment.Application;</code> at the beginning of my code. There is a red squiggly line under <code>Application</code> and mousing over it gives me the following information: </p>\n\n<p><code>The type or namespace name 'Application' does not exist in the namespace 'System.Deployment' (are you missing an assembly reference?) (CS0234)</code></p>\n\n<p>This of course gives me problems when I use <code>ApplicationDeployment</code> and it says <code>The name 'ApplicationDeployment' does not exist in the current context (CS0103)</code></p>\n\n<p>Why is Visual Studio telling me that <code>Application</code> is not a part of <code>System.Deployment</code>?</p>\n"}, {"tags": ["c#", "antlr4", "grammar"], "comments": [{"owner": {"reputation": 4293, "user_id": 11147851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b04faf05f8abb0f94a18fabc1b11ba73?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel Smirnov", "link": "https://stackoverflow.com/users/11147851/pavel-smirnov"}, "edited": false, "score": 0, "creation_date": 1563991644, "post_id": 57188713, "comment_id": 100887768, "body": "Sure you can get intermediate representation of users code, but the problem is - how do you know expressions are the same? F.e., one extra space character in the expression will make it a &quot;different&quot; expression."}, {"owner": {"reputation": 71, "user_id": 2507352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9bdc67454d6079b19d3997ee599cb42?s=128&d=identicon&r=PG", "display_name": "Fernando Jaconete", "link": "https://stackoverflow.com/users/2507352/fernando-jaconete"}, "reply_to_user": {"reputation": 4293, "user_id": 11147851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b04faf05f8abb0f94a18fabc1b11ba73?s=128&d=identicon&r=PG&f=1", "display_name": "Pavel Smirnov", "link": "https://stackoverflow.com/users/11147851/pavel-smirnov"}, "edited": false, "score": 0, "creation_date": 1564000213, "post_id": 57188713, "comment_id": 100891316, "body": "The purpose of this approach is to receive an expression from user, compile it and persist it for later usage. Then, if the user changes it, a new version of the expression is made, with a new compilation. Each group of expressions represent an atomic unit of logic, so the user will produce it and then use it for many operations through the software usage."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 2507352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9bdc67454d6079b19d3997ee599cb42?s=128&d=identicon&r=PG", "display_name": "Fernando Jaconete", "link": "https://stackoverflow.com/users/2507352/fernando-jaconete"}, "is_accepted": false, "score": 0, "last_activity_date": 1564745388, "creation_date": 1564745388, "answer_id": 57325634, "question_id": 57188713, "link": "https://stackoverflow.com/questions/57188713/is-there-a-way-to-produce-executables-from-an-existing-antlr4-grammar-within-exp/57325634#57325634", "title": "Is there a way to produce executables from an existing Antlr4 grammar within expressions from the user?", "body": "<p>After some extra time analysing the implementation and also the usage we have of AntLr, I could see that even though I could find a way to compile expressions analysis, the output results wouldn't be executable for our scenario, because of many usages of local libraries.</p>\n\n<p>The path I choose to run on was to create, dynamicaly, C# code while visiting AntLr expression navigation, through visit methods overrides and, later, compile this C# code into a memory assembly, so I can locate the execution class, create instance and invoke it's execute method. Also I'm using Rosyln to achieve this approach.</p>\n"}], "owner": {"reputation": 71, "user_id": 2507352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9bdc67454d6079b19d3997ee599cb42?s=128&d=identicon&r=PG", "display_name": "Fernando Jaconete", "link": "https://stackoverflow.com/users/2507352/fernando-jaconete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564745388, "creation_date": 1563990916, "question_id": 57188713, "link": "https://stackoverflow.com/questions/57188713/is-there-a-way-to-produce-executables-from-an-existing-antlr4-grammar-within-exp", "title": "Is there a way to produce executables from an existing Antlr4 grammar within expressions from the user?", "body": "<p>I've already an existing application, in which I use Antlr4 in order to declare a customized grammar, compile the .g4 files into our c# base parser and lexer and also I've implemented the visitors for expression parsing.</p>\n\n<p>The question is about finding a way to change the behavior from interpretation to compilation.</p>\n\n<p>The way the app works today, we receive an expression from our users (in the customized grammar format), pass it through Antlr4 implementations in order to get our visitors running and executing the expression. This is a very repetitive process, considering the same expression gets evaluated over and over with just different arguments, the implemented logic is just the same.</p>\n\n<p>I'd like to ask about if I could compile the provided expression of my users, save the compiled artifact so I can load it up and call it instead of parsing their expressions every time.\nThis is similar I do with C# programming, considering that I produce a DLL file that will get loaded up and executed later, without needing to get interpreted every time (not considering JIT at this context ;).</p>\n\n<p>Hope I made my self clear enough about that.</p>\n\n<p>It's not a problem to change architecture for this implementation, so we do need a \"facelift\" on the project, because of performance issues. Our customers use to produce very large expressions, which take lots of memory to be parsed and are causing some issues at runtime.</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["c#", "razor", "model", "boolean"], "comments": [{"owner": {"reputation": 306, "user_id": 4355568, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nBPdrG9Ic20/AAAAAAAAAAI/AAAAAAAAAE0/VztffFoZ_A0/photo.jpg?sz=128", "display_name": "Ali Maleki", "link": "https://stackoverflow.com/users/4355568/ali-maleki"}, "edited": false, "score": 0, "creation_date": 1563991054, "post_id": 57188638, "comment_id": 100887486, "body": "try this :  var text = (boolean)yesNo ? &quot;Yes&quot; : &quot;No&quot;;"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "reply_to_user": {"reputation": 306, "user_id": 4355568, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nBPdrG9Ic20/AAAAAAAAAAI/AAAAAAAAAE0/VztffFoZ_A0/photo.jpg?sz=128", "display_name": "Ali Maleki", "link": "https://stackoverflow.com/users/4355568/ali-maleki"}, "edited": false, "score": 1, "creation_date": 1563991137, "post_id": 57188638, "comment_id": 100887520, "body": "@AliMaleki <code>yesNo</code> is already declared as a <code>bool</code>"}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 3, "creation_date": 1563991214, "post_id": 57188638, "comment_id": 100887548, "body": "Your property is spelled <code>Percantage</code>. Is it <code>Percentage</code> in the database? It looks like you&#39;re using Dapper to execute the query. If the column names don&#39;t match, it wouldn&#39;t map them."}, {"owner": {"reputation": 17, "user_id": 9795309, "user_type": "registered", "profile_image": "https://graph.facebook.com/1593241127465069/picture?type=large", "display_name": "Cheruiyot A Kirui", "link": "https://stackoverflow.com/users/9795309/cheruiyot-a-kirui"}, "reply_to_user": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 0, "creation_date": 1563992484, "post_id": 57188638, "comment_id": 100888157, "body": "Thanks @madreflection such a mess spelling from me. Sorted it out. Big thanks."}], "owner": {"reputation": 17, "user_id": 9795309, "user_type": "registered", "profile_image": "https://graph.facebook.com/1593241127465069/picture?type=large", "display_name": "Cheruiyot A Kirui", "link": "https://stackoverflow.com/users/9795309/cheruiyot-a-kirui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563990614, "creation_date": 1563990614, "question_id": 57188638, "link": "https://stackoverflow.com/questions/57188638/c-boolean-value-always-returns-false-yet-it-is-true-in-the-database", "title": "C# boolean Value always returns false yet it is true in the database", "body": "<p>I have the followin Code in Model class which has a data type\n'bool'</p>\n\n<pre><code>public class MiscellaneousSettings\n    {\n        public string Name { get; set; }\n        public string Account_No { get; set; }\n        public bool Percantage { get; set; }\n\n        public decimal default_amount { get; set; }\n        public string type { get; set; }        \n\n    }\n</code></pre>\n\n<p>Then the code for controller where I get the data which I will display in view I am using dapper ORM to fetch and send the data to the database\nand consume the sp</p>\n\n<pre><code>[Authorize]\n        public ActionResult Index()\n        {\n            try\n            {\n                using (sqlConnection)\n                {\n\n\n                    var list_charge = sqlConnection.Query&lt;MiscellaneousSettings&gt;(\"get_miscellaneous_charges\", \n                        new {  }, commandType: CommandType.StoredProcedure).ToList();\n\n                    return View(list_charge);\n\n                }\n            }\n            catch (Exception ex)\n            {\n\n                throw ex;\n            }\n</code></pre>\n\n<p>Then the code for index View which shows 'No' for the boolean value while in the Database it shows the true value.</p>\n\n<pre><code>@foreach (var item in Model)\n            {\n                &lt;tr&gt;\n                    &lt;td&gt;\n                        @Html.DisplayFor(modelItem =&gt; item.Name)\n                    &lt;/td&gt;\n                    &lt;td&gt;\n                        @Html.DisplayFor(modelItem =&gt; item.Account_No)\n                    &lt;/td&gt;\n                    &lt;td&gt;\n                        @Html.YesNo(item.Percantage)\n                    &lt;/td&gt;\n                    &lt;td&gt;\n                        @Html.DisplayFor(modelItem =&gt; item.default_amount)\n                    &lt;/td&gt;\n                    &lt;td&gt;\n                        @Html.DisplayFor(modelItem =&gt; item.type)\n                    &lt;/td&gt;\n                    &lt;td&gt;\n                        @Html.ActionLink(\"Edit\", \"Edit\", new {id=item.type}) |\n                        @Html.ActionLink(\"Delete\", \"#\", new { /* id=item.PrimaryKey */ })\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n            }\n</code></pre>\n\n<p>I used the htm helper extenseion for decorating booolean \nvalues in the view to read Yes or No \ninstead of checkboxes</p>\n\n<pre><code> public static class HtmlHelperExtension\n    {\n        public static MvcHtmlString YesNo(this HtmlHelper htmlHelper, bool yesNo)\n        {\n            var text = yesNo ? \"Yes\" : \"No\";\n            return new MvcHtmlString(text);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "wpf", "file-io"], "comments": [{"owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1563994407, "post_id": 57188598, "comment_id": 100888969, "body": "Linq has some good options for comparing 2 sets of collections. Generally if you have large files, you stream small chunks at a time and then compare that to what you have in memory(the array). Another way is to split the work out into different threads with the <code>TaskFactory</code> and maybe compare say 4 items from the file at one time asynchronously."}, {"owner": {"reputation": 82, "user_id": 8097991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/69c5964ecf859abd539d7d0d0a38307e?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Mott", "link": "https://stackoverflow.com/users/8097991/nicholas-mott"}, "reply_to_user": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1563995689, "post_id": 57188598, "comment_id": 100889457, "body": "Thanks I will give this a go."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1564005391, "post_id": 57188598, "comment_id": 100893012, "body": "Use a lookup from <code>ToLookup</code> to group the <code>activeCells</code> <code>Name</code> values into smaller batches, lookup e.g. the first two characters of each line in the lookup and then test against the smaller batch. Knowledge of distribution of the <code>Name</code> values would help decide how to group. In your code, creating a <code>List&lt;string&gt;</code> from the values once and using a <code>for</code> loop to test against them would be faster than <code>foreach</code> and property references."}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 8097991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/69c5964ecf859abd539d7d0d0a38307e?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Mott", "link": "https://stackoverflow.com/users/8097991/nicholas-mott"}, "edited": false, "score": 0, "creation_date": 1564005085, "post_id": 57190143, "comment_id": 100892930, "body": "This helped a lot, down to 12 seconds per file which is within my margin."}], "tags": [], "owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "is_accepted": true, "score": 1, "last_activity_date": 1563997077, "creation_date": 1563997077, "answer_id": 57190143, "question_id": 57188598, "link": "https://stackoverflow.com/questions/57188598/compare-large-txt-file-against-array-of-values/57190143#57190143", "title": "Compare large .txt file against array of values", "body": "<p>I would break things out into 2-3 functions. The calling function, the file function, and the thread work function.</p>\n\n<pre><code>    public static void CopyActiveFiles(List&lt;string&gt; files, string targetLocation, OutfitCell[] activeCells)\n    {\n        foreach (string file in files)\n        {\n            CheckFile(file, activeCells);\n        }\n    }\n\n    private static void CheckFile(string file, OutfitCell[] activeCells)\n    {\n        // Thread call\n        // declare some thread safe collection.\n        // var lines = File.ReadLines(file).Skip(&lt;index&gt;).Take(&lt;count&gt;);\n        // Use a variant of the above line to grab a section of lines from the file to then ship out to threads.\n    }\n</code></pre>\n\n<p><a href=\"https://www.nimaara.com/counting-lines-of-a-text-file/\" rel=\"nofollow noreferrer\">https://www.nimaara.com/counting-lines-of-a-text-file/</a></p>\n\n<p>That link will help you count the lines in the file. This is useful for dividing up the file into chunks. Math will be required. Probably loop through x number of times with y items to count and the last block will be of size z.</p>\n"}, {"comments": [{"owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1564062307, "post_id": 57192103, "comment_id": 100914293, "body": "Indexing the first few characters is not the best way to go about this. I suspect there are names as part of lines and with lots of duplicates, that will cause performance issues and bad data."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1566575897, "post_id": 57192103, "comment_id": 101712797, "body": "@DavidBentley Lots of duplicates is fine - reducing 100,000 comparisons by 2x or 3x would still be a significant improvement, and given that the array contains only unique elements, and that there are up to 14,000 values in it, I doubt if the duplicates are nearly that many. You did make me think about improving the <code>StartsWith</code> to skip the first few characters since we already know they match, but that would require <code>Span</code> to prevent extra allocation erasing the improvement."}], "tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 1, "last_activity_date": 1564010310, "last_edit_date": 1564010310, "creation_date": 1564007800, "answer_id": 57192103, "question_id": 57188598, "link": "https://stackoverflow.com/questions/57188598/compare-large-txt-file-against-array-of-values/57192103#57192103", "title": "Compare large .txt file against array of values", "body": "<p>I created a large file (133k lines) from the cmudict words file, using just the words over two characters long and adding 70 random ASCII characters to the end of each line. I also stored the words in another file and pulled between 1000 and 14,000 of them into a <code>List&lt;string&gt;</code> named <code>values</code>.</p>\n\n<p>Using <code>ToLookup</code>, I grouped the <code>values</code> by the first two characters and just compared lines against the appropriate sub-group. I also took out the <code>BufferedStream</code> as various blogs showed that it doesn't improve performance for reading, and in this case slowed it down.</p>\n\n<p>Running your code against my data took around 14.7 seconds to create a result file. Running the lookup code took around 0.2 seconds. Indexing with 3 characters cut that in half to 0.1 seconds for an over 150 times speedup. Constraining the <code>values</code> size to be over 10,000 took the time to 137 seconds down to 0.267 seconds for an over 500 times speedup (with 3 character indexes).</p>\n\n<p>You can create <code>values</code> from <code>activeCells</code> with</p>\n\n<pre><code>var values = activeCells.Select(a =&gt; a.Name).ToList();\n</code></pre>\n\n<p>Then use this code:</p>\n\n<pre><code>var possibles = values.ToLookup(v =&gt; v.Substring(0, 2));\nusing (FileStream fs = File.Open(file, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)) {\n    using (StreamReader sr = new StreamReader(fs)) {\n        using (var writer = File.CreateText(tempFile)) {\n            while (!sr.EndOfStream) {\n                var line = sr.ReadLine();\n                var index = line.Substring(0, 2);\n                foreach (var value in possibles[index]) {\n                    if (line.StartsWith(value)) {\n                        writer.WriteLine(line);\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 82, "user_id": 8097991, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/69c5964ecf859abd539d7d0d0a38307e?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Mott", "link": "https://stackoverflow.com/users/8097991/nicholas-mott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57190143, "answer_count": 2, "score": 0, "last_activity_date": 1564010310, "creation_date": 1563990446, "question_id": 57188598, "link": "https://stackoverflow.com/questions/57188598/compare-large-txt-file-against-array-of-values", "title": "Compare large .txt file against array of values", "body": "<p>Good day, I am trying to compare a fairly large text file, about 100k lines against an array of between 1000 and 14000 values. The purpose of this is that a user has a text file of values, 1 per line, and the array contains pieces of information that may or may not match each line. Each line in the text file is unique and each item in the array is unique.</p>\n\n<p>Eg text file structure :<img src=\"https://i.stack.imgur.com/MqJov.png\" alt=\"1]: [![https://imgur.com/a/xOwYoal\">]<a href=\"https://i.stack.imgur.com/MqJov.png\" rel=\"nofollow noreferrer\">1</a></p>\n\n<p>The array (outfitCell) will contain the first word of each line but may contain all or none of some matches within the text file, eg it will contain the word  \"Is\" but wont contain the rest of the line. I need it to retain the whole line and write it to a new file in a new path.</p>\n\n<p>I have tried to use file stream and the standard stream reader and writer, but it takes about 50 seconds to do the comparison and write out the lines that \"start with\" the items from the array into a new txt file.</p>\n\n<p>Does anyone have any suggestions on how I could make this faster, I have had a look online but cant seem to find anything useful.</p>\n\n<pre><code>public static void CopyActiveFiles(List&lt;string&gt; files, string targetLocation, OutfitCell[] activeCells)\n        {\n            string tempFile = Path.Combine(Path.GetTempPath(), \"tempPermit.txt\");\n            try\n            {\n                foreach (string file in files)\n                {\n\n                    File.SetAttributes(file, FileAttributes.Normal);\n                    using (FileStream fs = File.Open(file, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))\n                    {\n                        using (BufferedStream bs = new BufferedStream(fs))\n                        {\n                            using (StreamReader sr = new StreamReader(bs))\n                            {\n                                using (var writer = File.CreateText(tempFile))\n                                {\n                                    string line;\n                                    while ((line = sr.ReadLine()) != null)\n                                    {\n                                            foreach (var activeCell in activeCells)\n                                            {\n                                                if (line.StartsWith(activeCell.Name))\n                                                {\n\n                                                    writer.WriteLine(line);\n                                                }\n                                            }\n\n                                    }\n                                }\n                            }\n                        }\n                    }\n\n                    File.SetAttributes(tempFile, FileAttributes.Normal);\n                    File.Copy(tempFile, Path.Combine(targetLocation, Path.GetFileName(file)));\n</code></pre>\n"}, {"tags": ["c#", "xml", "comments", "xml-documentation"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11563179"}, "edited": false, "score": 0, "creation_date": 1563991393, "post_id": 57188682, "comment_id": 100887640, "body": "I know that <code>[-]</code>. But they are constantly revealed. And the color of the closed version is distracting."}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1563991463, "post_id": 57188682, "comment_id": 100887676, "body": "If you use the extension, it won&#39;t expand unless you explicitly do so. Also, try getting used to comments, being distracted is a habit, you can overcome it. Comments are super useful."}], "tags": [], "owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "is_accepted": true, "score": 1, "last_activity_date": 1563990812, "creation_date": 1563990812, "answer_id": 57188682, "question_id": 57188534, "link": "https://stackoverflow.com/questions/57188534/xml-documentation-comments-in-a-separate-file/57188682#57188682", "title": "XML documentation comments in a separate file", "body": "<p>You can hide those comments by clicking the small <code>[-]</code> icon at the left hand side.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xOcpb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xOcpb.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you want to hide them all at once, this neat <a href=\"https://marketplace.visualstudio.com/items?itemName=3dGrabber.NoComment\" rel=\"nofollow noreferrer\">Visual Studio Extension called NoComment</a> can help you.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11563179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57188682, "answer_count": 1, "score": 0, "last_activity_date": 1563990812, "creation_date": 1563990176, "question_id": 57188534, "link": "https://stackoverflow.com/questions/57188534/xml-documentation-comments-in-a-separate-file", "title": "XML documentation comments in a separate file", "body": "<p>I find a lot of topics that describe the way through</p>\n\n<pre><code>/// &lt;summary&gt;\n/// \n/// &lt;/summary&gt;\n</code></pre>\n\n<p>But when I give such a description to several functions of the class, it starts to distract and disturb me. Can I put it in a separate file or hide it? To see only in <code>IntelliSense</code>.</p>\n"}, {"tags": ["c#", "ssis", "ssis-2012"], "answers": [{"comments": [{"owner": {"reputation": 30925, "user_id": 7031230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sPvnP.jpg?s=128&g=1", "display_name": "Hadi", "link": "https://stackoverflow.com/users/7031230/hadi"}, "edited": false, "score": 0, "creation_date": 1563991668, "post_id": 57188746, "comment_id": 100887784, "body": "Well explained!"}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1563997484, "post_id": 57188746, "comment_id": 100890246, "body": "Why &#39;var xml&#39;? It&#39;s an object, but I have to pull out a URL/string.  Does this need to go in the PreExecute method?  Even there, I get the error &quot;&#39;Variables&#39; does not contain a definition for &#39;Weather_XML&#39; and no extension method &#39;Weather_XML&#39; accepting a first argument of type &#39;Variables&#39; could be found (are you missing a using directive or an assembly reference?)&quot;"}, {"owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 0, "creation_date": 1564075140, "post_id": 57188746, "comment_id": 100920959, "body": "I just created a new SSIS project, added a dummy DataFlow task with an Excel file as input to satisfy the designer tool and get it to allow me to add a Script Component.  I then added a Package level string variable called <code>Weather_XML</code> (represented in GUI as <code>User::Weather_XML</code>, then I edited the Script Component adding <code>Weather_XML</code> as a ReadWriteVariable.  Then I chose &#39;Edit Script` to get the template C# code -- I was able to reference <code>this.Variables.Weather_XML</code> in any of the methods in the template: <code>PreExecute()</code> <code>PostExecute()</code> <code>CreateNewOutoutRows()</code>."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1564076116, "post_id": 57188746, "comment_id": 100921372, "body": "Maybe I&#39;ll start a fresh project.  Maybe there&#39;s so many tries in this one that it&#39;s just messed up."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1564081498, "post_id": 57188746, "comment_id": 100923780, "body": "A fresh project, just adding that one line, and it gives an error.  Am I missing a directive or assembly reference?  Does this work in 2012?"}, {"owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 0, "creation_date": 1564083655, "post_id": 57188746, "comment_id": 100924661, "body": "I did not have to add any additional assemblies or <code>using</code> statements etc.  I do not have VS2012 installed -- sorry.  When I choose &#39;Edit Script` from the Script Component properties dialog, what happens is this: long wait, then another instance of VS opens with just the C# code.  I am curious if you see similar behavior?"}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1564084162, "post_id": 57188746, "comment_id": 100924861, "body": "Yes, that is the same.  And I selected a Source Script Component, as did you, since there is a CreateNewOutputRows() method in the template.  So perhaps it&#39;s the ancient version I have."}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1564436970, "post_id": 57188746, "comment_id": 101022759, "body": "I can access a string, using your code above.  But not an object.  I&#39;m now working to modify my code so one record at a time is used, with strings, and skipping the object altogether."}], "tags": [], "owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "is_accepted": false, "score": 2, "last_activity_date": 1563991344, "last_edit_date": 1563991344, "creation_date": 1563991030, "answer_id": 57188746, "question_id": 57188518, "link": "https://stackoverflow.com/questions/57188518/access-object-variable-in-script-component-in-ssis-2012/57188746#57188746", "title": "Access Object variable in Script Component in SSIS 2012", "body": "<p>In SSIS, the <em>Script Task</em> and the <em>Script Component</em> are similar but definitely not identical.</p>\n\n<p>When using the <em>Script Component</em> <code>Dts.Variables</code> <strong>is not available</strong> (although in <em>Script Task</em> it is available).</p>\n\n<p>The following MSDN article compares <em>Script Task</em> and <em>Script Component</em> clarifying the differences between them: <a href=\"https://docs.microsoft.com/en-us/sql/integration-services/extending-packages-scripting/comparing-the-script-task-and-the-script-component?view=sql-server-2017\" rel=\"nofollow noreferrer\">Comparing Script Task and Script Compnent</a></p>\n\n<p>The relevant info from that article is as follows:</p>\n\n<blockquote>\n  <p><strong>Using variables</strong></p>\n  \n  <p>The Script component uses typed accessor properties of the\n  autogenerated based class, created from the component's\n  ReadOnlyVariables and ReadWriteVariables properties. For example:</p>\n  \n  <p>[Visual Basic]</p>\n\n<pre><code>Dim myVar as String \nmyVar = Me.Variables.MyStringVariable\n</code></pre>\n  \n  <p>[C#]</p>\n\n<pre><code>string myVar; \nmyVar = this.Variables.MyStringVariable;\n</code></pre>\n</blockquote>\n\n<p>In your case the following syntax should work:</p>\n\n<pre><code>var xml = this.Variables.Weather_XML;\n</code></pre>\n\n<p>The following TechNet article is another good source with examples of using Variables in the SSIS <em>Script Component</em>.</p>\n\n<p><a href=\"https://social.technet.microsoft.com/wiki/contents/articles/22198.use-ssis-variables-and-parameters-in-a-script-component.aspx\" rel=\"nofollow noreferrer\">https://social.technet.microsoft.com/wiki/contents/articles/22198.use-ssis-variables-and-parameters-in-a-script-component.aspx</a></p>\n"}], "owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1563991344, "creation_date": 1563990109, "last_edit_date": 1563990902, "question_id": 57188518, "link": "https://stackoverflow.com/questions/57188518/access-object-variable-in-script-component-in-ssis-2012", "title": "Access Object variable in Script Component in SSIS 2012", "body": "<p>I am using SSIS in VS 2012, and a lot of the answers I'm finding appear to be working for older or newer versions.</p>\n\n<p>I have declared a ReadWriteVariables called User::Weather_XML\n<a href=\"https://i.stack.imgur.com/9fzVG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9fzVG.png\" alt=\"Script Transformation Editor\"></a>\n(I hope this displays - my company policy doesn't allow access to imgur, so it looks like it works, but I can't tell.)</p>\n\n<p>I've looked at a lot of answers:\n<a href=\"https://stackoverflow.com/questions/21011550/reading-object-variable-values-in-ssis-script-component-source\">Reading object variable values in SSIS script component source</a> - this refers to Dts.Variables, which apparently is no longer available in 2012?</p>\n\n<p>So my code has this, but it won't compile because Dts.Variables doesn't exist in the current context:</p>\n\n<pre><code>    DataTable dt = new DataTable();\n    OleDbDataAdapter oleda = new OleDbDataAdapter();\n    oleda.Fill(dt, Dts.Variables(\"Weather_XML\").Value);\n</code></pre>\n\n<p>How do I get the set of data into the Script Component so I can use it?</p>\n\n<p>I have a data set, with an URL string - I want to go through the list and use each URL, get the corresponding XML, and then save that back to my object.  Or write it to a database, or something.  It seems like it's just the syntax, but I can't figure it out.  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/13450289/how-to-access-ssis-package-variables-inside-script-component\">This</a> uses a IDTSVariables100, but then references it to a string, and I have an entire object, with strings within it.  If I add the code   </p>\n\n<pre><code>    IDTSVariables100 varCollection = null;\n    this.VariableDispenser.LockForRead(\"User::Weather_XML\");\n</code></pre>\n\n<p>it does compile, so it's progress.</p>\n\n<p>I am very weak in C#.  Obviously.  What is the syntax needed in 2012 to get the Object variable into something I can use in the Script Component?  With, perhaps some guidance on accessing a specific part of the object.  Pretend that the URL is the first string field in the object, and I currently have 4 rows.</p>\n\n<p>Also, I include the following namespaces, probably way more than I need:</p>\n\n<pre><code>using System;\nusing System.Data;\nusing Microsoft.SqlServer.Dts.Pipeline.Wrapper;\nusing Microsoft.SqlServer.Dts.Runtime.Wrapper;\nusing System.Net;\nusing Microsoft.SqlServer.Dts.Runtime;\nusing System.Windows.Forms;\nusing System.IO;\nusing System.Web.Script.Serialization;\nusing System.Xml;\nusing System.Xml.Serialization;\nusing System.Collections.Generic;\nusing System.Data.OleDb;\n</code></pre>\n"}, {"tags": ["c#", "azure"], "comments": [{"owner": {"reputation": 30516, "user_id": 9455659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Albsq.jpg?s=128&g=1", "display_name": "Joy Wang", "link": "https://stackoverflow.com/users/9455659/joy-wang"}, "edited": false, "score": 0, "creation_date": 1564970858, "post_id": 57188514, "comment_id": 101190876, "body": "Could it solve your issue?"}], "answers": [{"tags": [], "owner": {"reputation": 30516, "user_id": 9455659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Albsq.jpg?s=128&g=1", "display_name": "Joy Wang", "link": "https://stackoverflow.com/users/9455659/joy-wang"}, "is_accepted": false, "score": 1, "last_activity_date": 1564024700, "last_edit_date": 1564024700, "creation_date": 1564021447, "answer_id": 57193448, "question_id": 57188514, "link": "https://stackoverflow.com/questions/57188514/query-azure-ad-with-graphserviceclient/57193448#57193448", "title": "Query Azure AD with GraphServiceClient", "body": "<p>If you want to list the users, you could use the code as below.</p>\n\n<pre><code> var users = await graphClient.Users\n                .Request()\n                .GetAsync();\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/DLSSy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DLSSy.png\" alt=\"enter image description here\"></a></p>\n\n<p>For more details, refer to this <a href=\"https://docs.microsoft.com/en-us/graph/api/user-list?view=graph-rest-1.0&amp;tabs=csharp#examples\" rel=\"nofollow noreferrer\">link</a>. </p>\n"}], "owner": {"reputation": 709, "user_id": 5313605, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ef0fcbbded463b4ddfe2ddbcfcf6cd64?s=128&d=identicon&r=PG&f=1", "display_name": "nlstack01", "link": "https://stackoverflow.com/users/5313605/nlstack01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564024700, "creation_date": 1563990107, "question_id": 57188514, "link": "https://stackoverflow.com/questions/57188514/query-azure-ad-with-graphserviceclient", "title": "Query Azure AD with GraphServiceClient", "body": "<p>I want to query Azure Active Directory For Users with GraphServiceClient.</p>\n\n<p>I registered an application on the Azure portal and get back a token. \nNow I want to GetUsers of my ActiveDirectory but dont understand how to query the Azure AD</p>\n\n<pre><code>  static async void Works() //gets a token \n        {\n            try\n            {\n                var tenantId = \"myTenant\";\n                var clientId = \"myId\";\n                var clientSecret = @\"MySecret\";\n\n                // Configure app builder\n                var authority = $\"https://login.microsoftonline.com/{tenantId}\";\n                var app = ConfidentialClientApplicationBuilder\n                    .Create(clientId)\n                    .WithClientSecret(clientSecret)\n                    .WithAuthority(new Uri(authority))\n                    .Build();\n\n                // Acquire tokens for Graph API\n                var scopes = new[] { \"https://graph.microsoft.com/.default\" };\n                var authenticationResult = await app.AcquireTokenForClient(scopes).ExecuteAsync();\n\n                // Create GraphClient and attach auth header to all request (acquired on previous step)\n                var graphClient = new GraphServiceClient(\n                    new DelegateAuthenticationProvider(requestMessage =&gt;\n                    {\n                        requestMessage.Headers.Authorization =\n                            new System.Net.Http.Headers.AuthenticationHeaderValue(\"bearer\", authenticationResult.AccessToken);\n\n                        return Task.FromResult(0);\n                    }));\n\n                // Call Graph API\n                //HOW DO I QUERY AZURE AD????\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine(ex.Message);\n                Console.ReadKey();\n            }\n        }\n</code></pre>\n"}, {"tags": ["c#", "oop", "inheritance", "refactoring"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9383829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01f57de0dcb1163e9121500a34b0a83f?s=128&d=identicon&r=PG&f=1", "display_name": "aa_talanin", "link": "https://stackoverflow.com/users/9383829/aa-talanin"}, "edited": false, "score": 0, "creation_date": 1563992255, "post_id": 57188823, "comment_id": 100888063, "body": "So, I should have just combined both <code>protected</code> and <code>internal</code> in one modifier. Thanks, much appreciated!"}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": true, "score": 2, "last_activity_date": 1563991334, "creation_date": 1563991334, "answer_id": 57188823, "question_id": 57188504, "link": "https://stackoverflow.com/questions/57188504/how-to-perform-a-cross-hierarchy-call-in-c/57188823#57188823", "title": "How to perform a cross-hierarchy call in C#", "body": "<p>Use <code>protected internal</code></p>\n\n<pre><code>protected internal virtual void OnKeyPressed(object sender, KeyboardEventArgs args)\n{ ... }\n</code></pre>\n\n<p>The <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/access-modifiers\" rel=\"nofollow noreferrer\">documentation</a> says:</p>\n\n<blockquote>\n  <p><strong>protected internal</strong> The type or member can be accessed by any code in the assembly in which it is declared, or from within a derived class in another assembly.</p>\n</blockquote>\n"}], "owner": {"reputation": 113, "user_id": 9383829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01f57de0dcb1163e9121500a34b0a83f?s=128&d=identicon&r=PG&f=1", "display_name": "aa_talanin", "link": "https://stackoverflow.com/users/9383829/aa-talanin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57188823, "answer_count": 1, "score": 1, "last_activity_date": 1563991334, "creation_date": 1563990071, "question_id": 57188504, "link": "https://stackoverflow.com/questions/57188504/how-to-perform-a-cross-hierarchy-call-in-c", "title": "How to perform a cross-hierarchy call in C#", "body": "<p>I am working on a simple GUI framework, and I faced a problem calling protected virtual methods.</p>\n\n<p>Here is the <code>IKeyboardInputListenerService</code> interface of service I use to receive keyboard events and the <code>Control</code> class that represents a base for all my GUI controls. The internal method is the one being refactored.</p>\n\n<pre><code>public interface IKeyboardInputListenerService\n{\n    event EventHandler&lt;KeyboardEventArgs&gt; KeyPressed;\n}\n\npublic abstract class Control\n{\n    public IKeyboardInputListenerService KeyboardInputListenerService { get; }\n\n    protected Control(IKeyboardInputListenerService keyboardInputListenerService) =&gt;\n        KeyboardInputListenerService = keyboardInputListenerService;\n\n    public event EventHandler&lt;KeyboardEventArgs&gt; KeyPressed;\n\n    /* protected */ internal virtual void OnKeyPressed(object sender, KeyboardEventArgs args)\n    {\n        if (enabled &amp;&amp; visible &amp;&amp; focused &amp;&amp; !args.Suppressed)\n        {\n            KeyPressed?.Invoke(sender, args);\n            args.Suppressed = true;\n        }\n    }\n\n    public void Activate() =&gt;\n        KeyboardInputListenerService.KeyPressed += new EventHandler&lt;KeyboardEventArgs&gt;(OnKeyPressed);\n}\n</code></pre>\n\n<p>I also created a <code>ContainerControl</code> class that is supposed to contain child controls(like the <code>Panel</code> or <code>GroupBox</code> in Windows Forms) and that overrides the virtual method:</p>\n\n<pre><code>public abstract class ContainerControl : Control\n{\n    private readonly ObservableCollection&lt;Control&gt; controls;\n\n    protected ContainerControl(IKeyboardInputListenerService keyboardInputListenerService)\n        : base(keyboardInputListenerService) =&gt;\n        controls = new ObservableCollection&lt;Control&gt;();\n\n    /* protected */ internal override void OnKeyPressed(object sender, KeyboardEventArgs args)\n    {\n        foreach (Control control in controls)\n            control.OnKeyPressed(sender, args);\n\n        base.OnKeyPressed(sender, args);\n    }\n}\n</code></pre>\n\n<p>Problem is, I cannot decide which modifier to use for methods such as <code>OnKeyPressed</code>. I wanted to make them <code>protected</code>, but it causes a compiler error:</p>\n\n<blockquote>\n  <p>Error CS1540 Cannot access protected member 'Control.OnKeyPressed(object, KeyboardEventArgs)' via a qualifier of type 'Control'; the qualifier must be of type 'ContainerControl' (or derived from it)</p>\n</blockquote>\n\n<p>I can make them <code>public</code>, but I do not really think it is a good idea, because there is no reason for it except for resolving the problem caused by a cross-hierarchy call. I made them <code>internal</code>, but there is also a drawback: if anyone will want to create a user control, they will not be able to receive events, so the control will be useless.</p>\n\n<p><strong>The question is</strong> how to get access from a derived class to virtual methods of the base class without making the methods public-accessed.</p>\n"}, {"tags": ["c#", "async-await", "task-parallel-library"], "comments": [{"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 1, "creation_date": 1563990576, "post_id": 57188421, "comment_id": 100887257, "body": "Seems like you just need an overload of <code>ExecuteIntrasactionAsync</code> that only returns a <code>Task</code> and not a result."}, {"owner": {"reputation": 2556, "user_id": 10883465, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E5Lki7kUGF8/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcY1dMAbpAmyyBJtdSM1p4AdgBm_QQ/mo/photo.jpg?sz=128", "display_name": "Joelius", "link": "https://stackoverflow.com/users/10883465/joelius"}, "edited": false, "score": 1, "creation_date": 1563991330, "post_id": 57188421, "comment_id": 100887610, "body": "Why do you need to return a <code>dynamic</code>-<code>null</code> after updating? Have you thought about the options of just returning nothing (here <code>Task</code>) or maybe the dynamic object that you just changed (so change <code>null</code> to <code>dto</code>)?"}], "answers": [{"comments": [{"owner": {"reputation": 8804, "user_id": 649737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ffb1bb7b9f96cd3b1ca567899f9d256?s=128&d=identicon&r=PG", "display_name": "Leron_says_get_back_Monica", "link": "https://stackoverflow.com/users/649737/leron-says-get-back-monica"}, "edited": false, "score": 0, "creation_date": 1563991869, "post_id": 57188735, "comment_id": 100887883, "body": "Yeah... I&#39;ve seen both approaches. The problem for me is that in general - a method that shouldn&#39;t return anything return something, even if it&#39;s a null."}, {"owner": {"reputation": 2923, "user_id": 783912, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/98e9b626cf9e9e74ae50c190da325a5e?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingFoX", "link": "https://stackoverflow.com/users/783912/flyingfox"}, "reply_to_user": {"reputation": 8804, "user_id": 649737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ffb1bb7b9f96cd3b1ca567899f9d256?s=128&d=identicon&r=PG", "display_name": "Leron_says_get_back_Monica", "link": "https://stackoverflow.com/users/649737/leron-says-get-back-monica"}, "edited": false, "score": 0, "creation_date": 1563992068, "post_id": 57188735, "comment_id": 100887976, "body": "@Leron Can you change the signature of <code>UpdateInTransaction</code> to <code>async Task</code> without the <code>&lt;dynamic&gt;</code>?"}, {"owner": {"reputation": 8804, "user_id": 649737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ffb1bb7b9f96cd3b1ca567899f9d256?s=128&d=identicon&r=PG", "display_name": "Leron_says_get_back_Monica", "link": "https://stackoverflow.com/users/649737/leron-says-get-back-monica"}, "edited": false, "score": 1, "creation_date": 1563992603, "post_id": 57188735, "comment_id": 100888207, "body": "Yes, I&#39;ve played around a lot with those. Most of the time I got exception that I can cast <code>Tasks.VoidResult</code> to <code>Tasks.Task</code>."}], "tags": [], "owner": {"reputation": 2923, "user_id": 783912, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/98e9b626cf9e9e74ae50c190da325a5e?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingFoX", "link": "https://stackoverflow.com/users/783912/flyingfox"}, "is_accepted": false, "score": 0, "last_activity_date": 1563991002, "creation_date": 1563991002, "answer_id": 57188735, "question_id": 57188421, "link": "https://stackoverflow.com/questions/57188421/calling-multiple-async-methods-within-other-method-without-returning-result/57188735#57188735", "title": "Calling multiple async methods within other method without returning result", "body": "<p>You can change </p>\n\n<pre><code>private async Task&lt;dynamic&gt; UpdateInTransaction(dynamic dto)\n{\n  await UpdateName(dto.Name);\n  await UpdateAddress(dto.Address);\n  await UpdateAge(dto.Age);\n\n  return await Task.FromResult&lt;dynamic&gt;(null);\n}\n</code></pre>\n\n<p>to </p>\n\n<pre><code>private async Task&lt;dynamic&gt; UpdateInTransaction(dynamic dto)\n{\n  await UpdateName(dto.Name);\n  await UpdateAddress(dto.Address);\n  await UpdateAge(dto.Age);\n\n  return null;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8804, "user_id": 649737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ffb1bb7b9f96cd3b1ca567899f9d256?s=128&d=identicon&r=PG", "display_name": "Leron_says_get_back_Monica", "link": "https://stackoverflow.com/users/649737/leron-says-get-back-monica"}, "edited": false, "score": 0, "creation_date": 1563991791, "post_id": 57188854, "comment_id": 100887847, "body": "I&#39;m honored to have you answered on my question. I&#39;ve read some posts from you on this topic but I still have a hard time wrapping my head around it. I would like to avoid introducing changes to the existing code base, I think there should be no problem introducing your idea for <code>Update</code> and reusing it later if such moment occurs. What do you think?"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "reply_to_user": {"reputation": 8804, "user_id": 649737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ffb1bb7b9f96cd3b1ca567899f9d256?s=128&d=identicon&r=PG", "display_name": "Leron_says_get_back_Monica", "link": "https://stackoverflow.com/users/649737/leron-says-get-back-monica"}, "edited": false, "score": 0, "creation_date": 1563991987, "post_id": 57188854, "comment_id": 100887940, "body": "You could add in the overload and try it without changing the other code. I&#39;m not entirely sure which way the overload resolution will go if given a lambda returning <code>Task&lt;T&gt;</code> - would it choose the <code>Func&lt;Task&gt;</code> or the <code>Delegate</code>?"}, {"owner": {"reputation": 8804, "user_id": 649737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ffb1bb7b9f96cd3b1ca567899f9d256?s=128&d=identicon&r=PG", "display_name": "Leron_says_get_back_Monica", "link": "https://stackoverflow.com/users/649737/leron-says-get-back-monica"}, "edited": false, "score": 1, "creation_date": 1563992965, "post_id": 57188854, "comment_id": 100888384, "body": "I&#39;ve tested your exact suggestion - <code>public async Task ExecuteInTransactionAsync(Func&lt;Task&gt; function)</code> with the current code, it seems like there is no ambiguity, the compiler is also fine. I think to take advantage of this approach. Thank you very much!"}], "tags": [], "owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "is_accepted": true, "score": 3, "last_activity_date": 1563991482, "creation_date": 1563991482, "answer_id": 57188854, "question_id": 57188421, "link": "https://stackoverflow.com/questions/57188421/calling-multiple-async-methods-within-other-method-without-returning-result/57188854#57188854", "title": "Calling multiple async methods within other method without returning result", "body": "<p>I would avoid the use of <code>Delegate</code> since it isn't typed:</p>\n\n<pre><code>public async Task&lt;TOut&gt; ExecuteInTransactionAsync&lt;TOut&gt;(Func&lt;Task&lt;TOut&gt;&gt; function)\n{\n    using (var scope = new TransactionScope(TransactionScopeAsyncFlowOption.Enabled))\n    {\n        var result = await (function()).ConfigureAwait(false);\n\n        scope.Complete();\n\n        return result;\n    }\n}\n</code></pre>\n\n<p>This signature would mean you'd need to capture parameters rather than pass them:</p>\n\n<pre><code>public async Task&lt;dynamic&gt; SaveEntireEntity(EntityDTO entityDTO)\n{\n  return await _transactionProvider.ExecuteInTransactionAsync(\n     async () =&gt; await SaveInTransaction(\n         new { Name = entityDTO.Name, Address = entityDTO.Address, Age = entityDTO.Age }));\n}\n</code></pre>\n\n<p>Once you're using the strongly-typed <code>Func&lt;Task&lt;T&gt;&gt;</code> instead of <code>Delegate</code> in your method signature, you can create an overload for <code>ExecuteInTransactionAsync</code> as such:</p>\n\n<pre><code>public async Task ExecuteInTransactionAsync(Func&lt;Task&gt; function)\n{\n    using (var scope = new TransactionScope(TransactionScopeAsyncFlowOption.Enabled))\n    {\n        await (function()).ConfigureAwait(false);\n        scope.Complete();\n    }\n}\n</code></pre>\n\n<p>which can be used as such:</p>\n\n<pre><code>public async Task UpdateEntireEntity(UpdateEntityDTO entityDTO)\n{\n  await _transactionProvider.ExecuteInTransactionAsync(\n    async () =&gt; await UpdateInTransaction(\n        new { Name = entityDTO.Name, Address = entityDTO.Address, Age = entityDTO.Age }));\n}\n\nprivate async Task UpdateInTransaction(dynamic dto)\n{\n  await UpdateName(dto.Name);\n  await UpdateAddress(dto.Address);\n  await UpdateAge(dto.Age);\n}\n</code></pre>\n"}], "owner": {"reputation": 8804, "user_id": 649737, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ffb1bb7b9f96cd3b1ca567899f9d256?s=128&d=identicon&r=PG", "display_name": "Leron_says_get_back_Monica", "link": "https://stackoverflow.com/users/649737/leron-says-get-back-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 57188854, "answer_count": 2, "score": 0, "last_activity_date": 1563991482, "creation_date": 1563989634, "last_edit_date": 1563990473, "question_id": 57188421, "link": "https://stackoverflow.com/questions/57188421/calling-multiple-async-methods-within-other-method-without-returning-result", "title": "Calling multiple async methods within other method without returning result", "body": "<p>I am working on an <code>ASP.NET Core 2.2</code> application with <code>Dapper</code>. Virtually all methods follows the <code>async/await</code> pattern returning some sort of <code>Task</code> as a result.</p>\n\n<p>Due to an issue we had with <code>Dapper</code> (I haven't personally investigated it, this part of the code I use as it is) but basically it boils down to the fact that if you want to execute in <code>Transaction</code> multiple async methods, which internally are calling other async methods and you may have several levels of nesting this way, you need to wrap all those method invocations within a single method which would be executed in a transaction.</p>\n\n<p>The method that handles this is as follows:</p>\n\n<pre><code>public async Task&lt;TOut&gt; ExecuteInTransactionAsync&lt;TOut&gt;(\n    Delegate function, \n    params object[] parameters)\n{\n    using (var scope = new TransactionScope(TransactionScopeAsyncFlowOption.Enabled))\n    {\n        var result = await ((Task&lt;TOut&gt;)function.DynamicInvoke(parameters))\n            .ConfigureAwait(false);\n\n        scope.Complete();\n\n        return result;\n    }\n}\n</code></pre>\n\n<p>So I have a very complex Entity which is saved by calling <code>Save</code> to a lot of smaller entities. This part of the code is working OK and looks like this:</p>\n\n<pre><code>public async SaveEntireEntity(EntityDTO entityDTO)\n{\n  return await _transactionProvider.ExecuteInTransactionAsync&lt;dynamic&gt;(\n     new Func&lt;object, Task&lt;dynamic&gt;&gt;(async dto =&gt; await SaveInTransaction(dto)),\n     new { Name = entityDTO.Name, Address = entityDTO.Address, Age = entityDTO.Age });\n}\n</code></pre>\n\n<p>And the <code>SaveInTransaction</code> method looks like:</p>\n\n<pre><code>private async Task&lt;dynamic&gt; SaveInTransaction(dynamic dto)\n{\n  var entityId = await nameService.Add(dto.Name);\n  await addressService.Add(dto.Address);\n  await ageService.Add(dto.Age);\n\n  return entityId;\n}\n</code></pre>\n\n<p>so this is simplified, but indeed I am calling a multiple services here, which on their part are calling multiple repositories and this works fine.</p>\n\n<p><strong>The Problem</strong> I have is when it comes to updating the same entity within a transaction. The whole purpose of showing the <code>Save</code> logic was to point out that at the end because I have this <code>return entityId;</code> I am able to chain everything together without any problems. However, as it is right now, by default our <code>Update</code> methods are not returning anything and this is where I can't figure out how to implement the <code>Update</code> logic.</p>\n\n<p>Currently I have this:</p>\n\n<pre><code>public async Task UpdateEntireEntity(UpdateEntityDTO, entityDTO)\n{\n  await _transactionProvider.ExecuteInTransactionAsync&lt;dynamic&gt;(\n    new Func&lt;object, Task&lt;dynamic&gt;&gt;(async dto =&gt; await UpdateInTransaction(dto)),\n    new { Name = entityDTO.Name, Address = entityDTO.Address, Age = entityDTO.Age });\n}\n</code></pre>\n\n<p>And <code>UpdateInTransaction</code> looks like this:</p>\n\n<pre><code>private async Task&lt;dynamic&gt; UpdateInTransaction(dynamic dto)\n{\n  await UpdateName(dto.Name);\n  await UpdateAddress(dto.Address);\n  await UpdateAge(dto.Age);\n\n  return await Task.FromResult&lt;dynamic&gt;(null);\n}\n</code></pre>\n\n<p>This seems to work at least based on the several tests I made, however I really don't like this part:</p>\n\n<p><code>return await Task.FromResult&lt;dynamic&gt;(null);</code></p>\n\n<p>To me it seems like an ugly hack. The <code>Update</code> methods were thought not to return any value and this is just too artificial. </p>\n\n<p>And even the worst part is that I can not figure out how implement the update method without having to return something.</p>\n\n<p>One thing I've tried is to change the declaration of <code>UpdateInTransaction</code> to</p>\n\n<p><code>private async Task UpdateInTransaction(dynamic dto)</code></p>\n\n<p>and when I call the method I change it to:</p>\n\n<pre><code>await _transactionProvider.ExecuteInTransactionAsync&lt;dynamic&gt;(\nnew Func&lt;object, Task&gt;( async dto =&gt; await UpdateInTransaction(dto)..\n</code></pre>\n\n<p>But I got the following exception:</p>\n\n<blockquote>\n  <p>AsyncStateMachineBox<code>1[System.Threading.Tasks.VoidTaskResult,\n  &lt;fully-qualified- name&gt;.&lt;&lt;UpdateEntireEntity&gt;b__0&gt;d] to type \n  'System.Threading.Tasks.Task</code>1[System.Threading.Tasks.Task]'</p>\n</blockquote>\n\n<p>.\nSo basically that's it. Sorry for the long post. I would really appreciate some well explained answer.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "syncfusion"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1563990252, "post_id": 57188317, "comment_id": 100887122, "body": "Why are you serving this file to the end user with a .xls extension, yet saving it on disk with a .xlsx extension? I would assume .xlsx is correct since you specified Excel 2016."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1563990446, "post_id": 57188317, "comment_id": 100887214, "body": "@mason It&#39;s deceptive.  That overload of <code>SaveAs</code> doesn&#39;t use the second parameter as a filename.  It&#39;s not actually saving to disk."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1563990783, "post_id": 57188317, "comment_id": 100887359, "body": "You should be flushing the array <i>before</i> getting its array buffer."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1563992814, "post_id": 57188317, "comment_id": 100888317, "body": "@Amy Interesting. Never worked with Syncfusion. renu - my advice still stands on making sure you&#39;re serving the file to the user with the correct extension and <a href=\"https://stackoverflow.com/questions/4212861/what-is-a-correct-mime-type-for-docx-pptx-etc\">MIME Type</a>. Or if you&#39;re doing a CSV, then use .csv and <code>text&#47;csv</code>"}], "answers": [{"comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "reply_to_user": {"reputation": 21, "user_id": 8144599, "user_type": "registered", "profile_image": "https://graph.facebook.com/569771433506881/picture?type=large", "display_name": "renu", "link": "https://stackoverflow.com/users/8144599/renu"}, "edited": false, "score": 0, "creation_date": 1563992245, "post_id": 57188581, "comment_id": 100888054, "body": "Ah ha, that works too.  It&#39;ll generate a CSV file with a comma as a delimiter."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "reply_to_user": {"reputation": 21, "user_id": 8144599, "user_type": "registered", "profile_image": "https://graph.facebook.com/569771433506881/picture?type=large", "display_name": "renu", "link": "https://stackoverflow.com/users/8144599/renu"}, "edited": false, "score": 0, "creation_date": 1563993346, "post_id": 57188581, "comment_id": 100888533, "body": "@renu If my answer was helpful, please consider accepting it and/or voting.  See <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a> for more information.  If my answer wasn&#39;t sufficient, please let me know how it needs to be amended, thanks."}], "tags": [], "owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "is_accepted": false, "score": 0, "last_activity_date": 1563990390, "creation_date": 1563990390, "answer_id": 57188581, "question_id": 57188317, "link": "https://stackoverflow.com/questions/57188317/how-to-input-data-in-excel-sheets/57188581#57188581", "title": "How to input data in excel sheets?", "body": "<p>According to the <a href=\"https://help.syncfusion.com/cr/cref_files/file-formats/Syncfusion.XlsIO.Base~Syncfusion.XlsIO.IWorkbook~SaveAs(Stream,String).html\" rel=\"nofollow noreferrer\">SyncFusion documentation</a>, that <code>SaveAs</code> method doesn't do what you seem to think it does.  The second parameter is not a filename, it's a delimeter. It saves a CSV with the second parameter used as a delimiter.</p>\n\n<blockquote>\n  <p>Signature:<br>\n  <code>void SaveAs( \n     Stream stream,\n     string separator\n  )</code>  </p>\n  \n  <p>Parameters<br>\n  <strong>stream</strong> - Stream to save.<br>\n  <strong>separator</strong> - Denotes separator for the CSV file types.</p>\n</blockquote>\n\n<p>You should just use <code>SaveAs(ms)</code>.  </p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4295668, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X8Iusda03cI/AAAAAAAAAAI/AAAAAAAAAKs/CCnREXHiYEA/photo.jpg?sz=128", "display_name": "Abirami Varadharajan", "link": "https://stackoverflow.com/users/4295668/abirami-varadharajan"}, "is_accepted": false, "score": 0, "last_activity_date": 1564060891, "creation_date": 1564060891, "answer_id": 57202962, "question_id": 57188317, "link": "https://stackoverflow.com/questions/57188317/how-to-input-data-in-excel-sheets/57202962#57202962", "title": "How to input data in excel sheets?", "body": "<p>You are saving the stream with separator \u201c0.xlsx\u201d hence the added text is appended with \u201c0.xlsx\u201d. If you wish to save the file as csv, provide the separator parameter as \u2018,\u2019 also file extension as csv. Please find the updated code from your snippet.</p>\n\n<pre><code>using (ExcelEngine excelEngine = new ExcelEngine())\n            {\n                IApplication application = excelEngine.Excel;\n                application.DefaultVersion = ExcelVersion.Excel2016;\n                IWorkbook workbook = application.Workbooks.Create(1);\n                IWorksheet namedSheet = workbook.Worksheets[0];\n\n                namedSheet.Range[\"A1\"].Text = \"Hey there\";\n                namedSheet.Range[\"A2\"].Text = \"Good Morning\";\n                namedSheet.Range[\"A6\"].Text = \"Here I am!\";\n                namedSheet.Range[\"B5\"].Text = \"1\";\n\n                MemoryStream ms = new MemoryStream();\n                workbook.SaveAs(ms, \",\");\n                byte[] bytes = ms.ToArray();\n                ms.Flush();\n                ms.Close();\n                Response.Clear();\n                Response.AddHeader(\"Content-Disposition\", \"attachment; filename=foo.csv\");\n                Response.AddHeader(\"Content-Length\", bytes.Length.ToString());\n                Response.ContentType = \"application/octet-stream\";\n                Response.BinaryWrite(bytes);\n            }\n</code></pre>\n\n<p>We have also prepared sample for the same and sharing for your reference. The sample can be downloaded from following link.</p>\n\n<p>Sample Link: <a href=\"https://www.syncfusion.com/downloads/support/directtrac/general/ze/Sample1353252283.zip\" rel=\"nofollow noreferrer\">https://www.syncfusion.com/downloads/support/directtrac/general/ze/Sample1353252283.zip</a> </p>\n\n<p>You can also save the file as xlsx without providing the separator parameter.</p>\n\n<p>Please refer to below API reference to know more about different overloads for SaveAs</p>\n\n<p><a href=\"https://help.syncfusion.com/cr/file-formats/Syncfusion.XlsIO.Base~Syncfusion.XlsIO.IWorkbook~SaveAs.html\" rel=\"nofollow noreferrer\">https://help.syncfusion.com/cr/file-formats/Syncfusion.XlsIO.Base~Syncfusion.XlsIO.IWorkbook~SaveAs.html</a> </p>\n\n<p>Please refer to below documentation to know more on working with XlsIO</p>\n\n<p><a href=\"https://help.syncfusion.com/file-formats/xlsio/overview\" rel=\"nofollow noreferrer\">https://help.syncfusion.com/file-formats/xlsio/overview</a> </p>\n\n<p>Regards,</p>\n\n<p>Abirami</p>\n"}], "owner": {"reputation": 21, "user_id": 8144599, "user_type": "registered", "profile_image": "https://graph.facebook.com/569771433506881/picture?type=large", "display_name": "renu", "link": "https://stackoverflow.com/users/8144599/renu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1564060891, "creation_date": 1563989220, "last_edit_date": 1563990050, "question_id": 57188317, "link": "https://stackoverflow.com/questions/57188317/how-to-input-data-in-excel-sheets", "title": "How to input data in excel sheets?", "body": "<p>I'm trying to do something like this:</p>\n\n<p>I'm trying to add data in excel sheet. This is done correctly only if I add data to cells in first column. After that file name appears with the cells data. For example if the cell is C5, it'll append 4 file names to every input and then the data.\nCan someone help me with what I'm doing wrong?</p>\n\n<pre><code>public void Create()\n    {\n        string filepath = string.Empty;\n        using (ExcelEngine excelEngine = new ExcelEngine())\n        {\n            IApplication application = excelEngine.Excel;\n            application.DefaultVersion = ExcelVersion.Excel2016;\n            IWorkbook workbook = application.Workbooks.Create(1);          \n            IWorksheet namedSheet = workbook.Worksheets[0];\n\n            namedSheet.Range[\"A1\"].Text = \"Hey there\";\n            namedSheet.Range[\"A2\"].Text = \"Good Morning\";\n            namedSheet.Range[\"A6\"].Text = \"Here I am!\";\n            namedSheet.Range[\"B5\"].Text = \"1\";\n\n            MemoryStream ms = new MemoryStream();\n            workbook.SaveAs(ms, \"0.xlsx\");\n            byte[] bytes = ms.ToArray();\n            ms.Flush();\n            ms.Close();\n            Response.Clear();\n            Response.AddHeader(\"Content-Disposition\", \"attachment; filename=foo.xls\");\n            Response.AddHeader(\"Content-Length\", bytes.Length.ToString());\n            Response.ContentType = \"application/octet-stream\";\n            Response.BinaryWrite(bytes);\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Hey there0.xlsx<br>\n  Good Morning0.xlsx<br>\n  0.xlsx1<br>\n  Here I am!0.xlsx<br>\n  Created with a trial version of Syncfusion Essential XlsIO  </p>\n</blockquote>\n"}, {"tags": ["c#", "asp.net-core", "blazor"], "comments": [{"owner": {"reputation": 2847, "user_id": 2658697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d9486e90f5e906e38a06aa76bf5fa0b?s=128&d=identicon&r=PG", "display_name": "Mister Magoo", "link": "https://stackoverflow.com/users/2658697/mister-magoo"}, "edited": false, "score": 0, "creation_date": 1563990757, "post_id": 57188302, "comment_id": 100887343, "body": "What&#39;s in ToggleItemClass? Try adding @key=&quot;item&quot; to the &lt;a&gt; tag"}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "reply_to_user": {"reputation": 2847, "user_id": 2658697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d9486e90f5e906e38a06aa76bf5fa0b?s=128&d=identicon&r=PG", "display_name": "Mister Magoo", "link": "https://stackoverflow.com/users/2658697/mister-magoo"}, "edited": false, "score": 0, "creation_date": 1563991333, "post_id": 57188302, "comment_id": 100887614, "body": "ToggleItemClass simply toggles the item&#39;s Class property. Ex: &quot;show&quot; vs &quot;collapsed&quot;. let me try adding that @key."}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "reply_to_user": {"reputation": 2847, "user_id": 2658697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d9486e90f5e906e38a06aa76bf5fa0b?s=128&d=identicon&r=PG", "display_name": "Mister Magoo", "link": "https://stackoverflow.com/users/2658697/mister-magoo"}, "edited": false, "score": 0, "creation_date": 1563991660, "post_id": 57188302, "comment_id": 100887776, "body": "Unfortunately, @key did not work. Also, please see my updated code snippet. The anchor tag is wrapped in an LI tag."}, {"owner": {"reputation": 6642, "user_id": 147301, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/5cRaa.png?s=128&g=1", "display_name": "Flores", "link": "https://stackoverflow.com/users/147301/flores"}, "edited": false, "score": 0, "creation_date": 1563992167, "post_id": 57188302, "comment_id": 100888022, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/53964536/blazor-onclick-event-passing-in-counter-from-loop\">Blazor onclick event passing in counter from loop</a>"}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "reply_to_user": {"reputation": 6642, "user_id": 147301, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/5cRaa.png?s=128&g=1", "display_name": "Flores", "link": "https://stackoverflow.com/users/147301/flores"}, "edited": false, "score": 0, "creation_date": 1563992707, "post_id": 57188302, "comment_id": 100888264, "body": "Thanks for the comment @Flores. But this is not the same situation. I am iterating thru object types here, not value types. If i print the item.Name from the click event handler, the property item is being passed in. So this is not an issue."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1563996741, "post_id": 57188302, "comment_id": 100889955, "body": "reference or value types is not the issue. But the foreach() should fix the capturing. Still worth trying to make a copy, the symptoms are pretty clear."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1563996905, "post_id": 57188302, "comment_id": 100890019, "body": "Also, post the ToggleItemClass() . Questions should be <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> here."}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 1, "creation_date": 1563999865, "post_id": 57188302, "comment_id": 100891209, "body": "Added the toggle method."}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 0, "creation_date": 1564000539, "post_id": 57188302, "comment_id": 100891456, "body": "I updated to show how i tried another way. see class=&quot;@classname"}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1564008978, "post_id": 57188302, "comment_id": 100893897, "body": "<code>&quot;collapsed&quot; != &quot;collapse&quot;</code>. It is unclear if  this is intentional."}], "answers": [{"comments": [{"owner": {"reputation": 39156, "user_id": 842935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2b3b9d4aa138cb30767b8b1a7a90f027?s=128&d=identicon&r=PG", "display_name": "dani herrera", "link": "https://stackoverflow.com/users/842935/dani-herrera"}, "reply_to_user": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 0, "creation_date": 1564001687, "post_id": 57188842, "comment_id": 100891859, "body": "@AlvinfromDiaspar, I changed the answer."}, {"owner": {"reputation": 39156, "user_id": 842935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2b3b9d4aa138cb30767b8b1a7a90f027?s=128&d=identicon&r=PG", "display_name": "dani herrera", "link": "https://stackoverflow.com/users/842935/dani-herrera"}, "reply_to_user": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 1, "creation_date": 1564027042, "post_id": 57188842, "comment_id": 100896890, "body": "Because in <code>class=&quot;@classname&quot;</code> the <code>classname</code> never change. Also, be careful with <code>collapse</code> vs <code>collapsed</code>."}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 0, "creation_date": 1564027757, "post_id": 57188842, "comment_id": 100897052, "body": "You mean there is a possibility classname variable doesn&#39;t change, which would prevent Blazor from rendering the difference?"}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 0, "creation_date": 1564028253, "post_id": 57188842, "comment_id": 100897152, "body": "The classname variable is declared inside the loop. So not sure what you mean by it never changes."}, {"owner": {"reputation": 39156, "user_id": 842935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2b3b9d4aa138cb30767b8b1a7a90f027?s=128&d=identicon&r=PG", "display_name": "dani herrera", "link": "https://stackoverflow.com/users/842935/dani-herrera"}, "reply_to_user": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 0, "creation_date": 1564030428, "post_id": 57188842, "comment_id": 100897734, "body": "You set a value to classname in first loop sentence and the var remains with this value forever. No one changes classname value again. You set a string to classname and this string remains on var because you never assign a new string to var again."}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "edited": false, "score": 0, "creation_date": 1564036558, "post_id": 57188842, "comment_id": 100899984, "body": "What do you mean the variable is never set again? The variable is declared inside the loop, which means it gets set every loop iteration. If this is not the case then I need to seriously review all of my razor files!"}, {"owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "reply_to_user": {"reputation": 39156, "user_id": 842935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2b3b9d4aa138cb30767b8b1a7a90f027?s=128&d=identicon&r=PG", "display_name": "dani herrera", "link": "https://stackoverflow.com/users/842935/dani-herrera"}, "edited": false, "score": 0, "creation_date": 1564075853, "post_id": 57188842, "comment_id": 100921272, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/197000/discussion-between-alvinfromdiaspar-and-dani-herrera\">continue this discussion in chat</a>."}, {"owner": {"reputation": 25716, "user_id": 6152891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b45b7f89429f8766cdbf6c776c0a9d41?s=128&d=identicon&r=PG", "display_name": "enet", "link": "https://stackoverflow.com/users/6152891/enet"}, "edited": false, "score": 0, "creation_date": 1564124865, "post_id": 57188842, "comment_id": 100934608, "body": "You&#39;re wrong, @dani. the variable classname is defined at each loop iteration, is assigned a value which is then assigned to the class attribute of the anchor element. This should work just as the first version of the loop should have work... As far as I understand the original code was fine, and the code should have worked, but it didn&#39;t.. why ? God knows...Let&#39;s move to the next question. Oh, AlvinfromDiaspar, did you see the answer to your previous question ? Weird things also happened there..."}, {"owner": {"reputation": 39156, "user_id": 842935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2b3b9d4aa138cb30767b8b1a7a90f027?s=128&d=identicon&r=PG", "display_name": "dani herrera", "link": "https://stackoverflow.com/users/842935/dani-herrera"}, "reply_to_user": {"reputation": 25716, "user_id": 6152891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b45b7f89429f8766cdbf6c776c0a9d41?s=128&d=identicon&r=PG", "display_name": "enet", "link": "https://stackoverflow.com/users/6152891/enet"}, "edited": false, "score": 0, "creation_date": 1564128225, "post_id": 57188842, "comment_id": 100936129, "body": "@Issac, thanks about your comment. Are you so kind to fork <a href=\"https://blazorfiddle.com/s/ell2z9s2\" rel=\"nofollow noreferrer\">blazorfiddle.com/s/ell2z9s2</a> with <code>classname</code> variable in a runable sample? I would like to see it running to better understand your approach. Thanks."}, {"owner": {"reputation": 39156, "user_id": 842935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2b3b9d4aa138cb30767b8b1a7a90f027?s=128&d=identicon&r=PG", "display_name": "dani herrera", "link": "https://stackoverflow.com/users/842935/dani-herrera"}, "reply_to_user": {"reputation": 25716, "user_id": 6152891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b45b7f89429f8766cdbf6c776c0a9d41?s=128&d=identicon&r=PG", "display_name": "enet", "link": "https://stackoverflow.com/users/6152891/enet"}, "edited": false, "score": 0, "creation_date": 1564255279, "post_id": 57188842, "comment_id": 100973110, "body": "Hi @issac, when you have some time, fork blazzorfiddle and show me your code with <code>classbame</code> please. I want to understand."}], "tags": [], "owner": {"reputation": 39156, "user_id": 842935, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2b3b9d4aa138cb30767b8b1a7a90f027?s=128&d=identicon&r=PG", "display_name": "dani herrera", "link": "https://stackoverflow.com/users/842935/dani-herrera"}, "is_accepted": true, "score": 2, "last_activity_date": 1564001622, "last_edit_date": 1564001622, "creation_date": 1563991413, "answer_id": 57188842, "question_id": 57188302, "link": "https://stackoverflow.com/questions/57188302/razor-weird-issue-with-updating-class-attribute-in-a-foreach-loop/57188842#57188842", "title": "Razor - Weird issue with updating class attribute in a foreach loop", "body": "<p>They are no issues in your (first) code (the current one, with <code>classname</code> var is wrong):</p>\n\n<p><a href=\"https://i.stack.imgur.com/LudFa.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LudFa.gif\" alt=\"enter image description here\"></a></p>\n\n<p>The snipped has no issues and is running for me, try it at <a href=\"https://blazorfiddle.com/s/ell2z9s2\" rel=\"nofollow noreferrer\">blazorfiddle</a>.</p>\n\n<pre><code>@page \"/\"\n\n&lt;h1&gt;Hello, world!&lt;/h1&gt;\n\n@foreach (var item in this.MenuItems)\n{          \n\n&lt;li&gt;\n    &lt;a class=\"@item.Class\" \n       @onclick=\"@(() =&gt; this.ToggleItemClass(item))\"&gt;@item.Name @item.Class\n    &lt;/a&gt;\n&lt;/li&gt;\n}\n\n@code {\n\n    public class Item\n    {\n        public string Class {set; get;} = \"blue\";\n        public string Name {set; get;} = \"Item\";\n    }\n    public List&lt;Item&gt; MenuItems = new List&lt;Item&gt;()\n    {\n        new Item(),\n        new Item(),\n        new Item(),\n    };\n    // Toggle method\n    void ToggleItemClass(Item item)\n    {\n        item.Class = item.Class == \"red\" ? \"green\" : \"red\";\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5839, "user_id": 158103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b8d753a2cfc92032857aa82dd2079d55?s=128&d=identicon&r=PG", "display_name": "AlvinfromDiaspar", "link": "https://stackoverflow.com/users/158103/alvinfromdiaspar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "accepted_answer_id": 57188842, "answer_count": 1, "score": 0, "last_activity_date": 1564115839, "creation_date": 1563989172, "last_edit_date": 1564115839, "question_id": 57188302, "link": "https://stackoverflow.com/questions/57188302/razor-weird-issue-with-updating-class-attribute-in-a-foreach-loop", "title": "Razor - Weird issue with updating class attribute in a foreach loop", "body": "<p>RESOLVED</p>\n\n<blockquote>\n  <p>The code I have is completely correct. The problem was that I was\n  referencing a bootstrap.js which was interfering with the CSS. Because\n  my actual code has bootstrap CSS, the script side of bootstrap was\n  messing things up. It was one of the hardest bugs to find! The fix was\n  to remove the bootstrap.js script reference.</p>\n</blockquote>\n\n<p>I have an array of objects which represents a list of clickable items.\nIn my razor page i iterate thru this array with a @foreach.\nInside the loop i am rendering simple html anchor element which is clickable.</p>\n\n<p>When the link is clicked an icon is to be changed (for a toggle effect).\nI achieve this by changing the class attribute via following way:</p>\n\n<blockquote>\n  <p>Item @item.Name</p>\n</blockquote>\n\n<p>The issue is that when i click on one link, all other links are getting the same icon rendered. Naturally i thought this was a simple error in the code. But I can see, by using System.Console.WriteLines, that the class names that SHOULD BE APPLIED to each anchor element is CORRECT.</p>\n\n<p>To paraphrase, the class names that should be applied to each anchor looks correct (based on Console outputs). But the actual class name that is rendered is not correct (based on inspecting the DOM).</p>\n\n<p>Now i've looked into loop related issues in Razor/Blazor. So i am aware of the pitfalls there. This is not that kind of problem since i am iterating thru a collection of object references.</p>\n\n<p>Here is a snippet of the code in question:</p>\n\n<pre><code>@foreach (var item in this.MenuItems)\n{          \n   var classname = item.Class == \"collapsed\" ? \"nav collapsed\" : \"nav\";\n\n   &lt;li&gt;\n       &lt;a class=\"@classname\" @onclick=\"@(() =&gt; this.ToggleItemClass(item))\"&gt;@item.Name&lt;/a&gt;\n   &lt;/li&gt;\n}\n\n// Toggle method\nvoid ToggleItemClass(Item item)\n{\n   item.Class = (item.Class == \"collapse\") ? \"collapse show\" : \"collapse\";\n}\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "powershell", "xmla"], "comments": [{"owner": {"reputation": 6608, "user_id": 2100227, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/uzsFd.png?s=128&g=1", "display_name": "Eris", "link": "https://stackoverflow.com/users/2100227/eris"}, "edited": false, "score": 0, "creation_date": 1563989388, "post_id": 57188293, "comment_id": 100886739, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3241401/xmlaclient-discovermdschema-modules-system-out-of-memory-exception\">xmlaclient.Discover(MDSCHEMA_MODULES,...) System out of memory exception</a>"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "reply_to_user": {"reputation": 6608, "user_id": 2100227, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/uzsFd.png?s=128&g=1", "display_name": "Eris", "link": "https://stackoverflow.com/users/2100227/eris"}, "edited": false, "score": 0, "creation_date": 1563989417, "post_id": 57188293, "comment_id": 100886757, "body": "@Eris: Did you paste the wrong link?"}, {"owner": {"reputation": 6608, "user_id": 2100227, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/uzsFd.png?s=128&g=1", "display_name": "Eris", "link": "https://stackoverflow.com/users/2100227/eris"}, "edited": false, "score": 0, "creation_date": 1563989437, "post_id": 57188293, "comment_id": 100886769, "body": "While the topic of that question is different, the answer is still valid for this question."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "reply_to_user": {"reputation": 6608, "user_id": 2100227, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/uzsFd.png?s=128&g=1", "display_name": "Eris", "link": "https://stackoverflow.com/users/2100227/eris"}, "edited": false, "score": 0, "creation_date": 1563989493, "post_id": 57188293, "comment_id": 100886795, "body": "@Eris: That&#39;s pretty far afield to make it a duplicate of this specific question."}, {"owner": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "reply_to_user": {"reputation": 6608, "user_id": 2100227, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/uzsFd.png?s=128&g=1", "display_name": "Eris", "link": "https://stackoverflow.com/users/2100227/eris"}, "edited": false, "score": 2, "creation_date": 1563989831, "post_id": 57188293, "comment_id": 100886938, "body": "@Eris I&#39;m looking into the new DLL referenced there now to see if it will do what I need it to. Thanks for the link."}], "answers": [{"tags": [], "owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "is_accepted": true, "score": 3, "last_activity_date": 1563989388, "last_edit_date": 1563989388, "creation_date": 1563989226, "answer_id": 57188320, "question_id": 57188293, "link": "https://stackoverflow.com/questions/57188293/class-is-inaccessible-due-to-its-protection-level-in-dll-reference/57188320#57188320", "title": "Class is inaccessible due to its protection level in DLL reference", "body": "<p>The class itself is not public</p>\n\n<pre><code>internal class XmlaClient\n^^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 1084, "user_id": 2829492, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cMV8k.jpg?s=128&g=1", "display_name": "coinbird", "link": "https://stackoverflow.com/users/2829492/coinbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 57188320, "answer_count": 1, "score": 0, "last_activity_date": 1563989905, "creation_date": 1563989148, "last_edit_date": 1563989905, "question_id": 57188293, "link": "https://stackoverflow.com/questions/57188293/class-is-inaccessible-due-to-its-protection-level-in-dll-reference", "title": "Class is inaccessible due to its protection level in DLL reference", "body": "<p>I've seen this error in C# before when referencing a class with private properties, but I'm at a loss here, as this class has public properties. It's actually a microsoft .dll</p>\n\n<p>I'm creating a new object:</p>\n\n<p><code>XmlaClient clnt = new XmlaClient();</code></p>\n\n<p>But that's where the \"Class is inaccessible due to its protection level\" error is coming from. I look at the class (dll) definition, and it shows all the items inside are public. Here's an excerpt:</p>\n\n<p>using System.Data;</p>\n\n<pre><code>namespace Microsoft.AnalysisServices\n{\n    internal class XmlaClient\n    {\n        public XmlaClient();\n\n        public ConnectionInfo ConnectionInfo { get; }\n        public IdentityTransferToken IdentityTransferToken { get; set; }\n        #etc etc\n</code></pre>\n\n<p>One thing I noticed is the namespace is different than my project's. My other .dll references have their own unique namespaces, so I didn't think that was the issue. Just a thought though.</p>\n\n<p>Edit: Attempting to use Microsoft.AnalysisServices.AdomdClient.dll now. It seems quite a bit different than the previous DLL though.</p>\n"}, {"tags": ["c#", "appdomain", "strongname"], "answers": [{"comments": [{"owner": {"reputation": 1816, "user_id": 716296, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/182b07f86f731f26791821b1182a30a6?s=128&d=identicon&r=PG", "display_name": "Aaron Murray", "link": "https://stackoverflow.com/users/716296/aaron-murray"}, "edited": false, "score": 0, "creation_date": 1565457161, "post_id": 57438266, "comment_id": 101364355, "body": "That was exactly what I missed.  The second link you gave (which was the tutorial I was working off of), was kind of vague with the &quot;Sign the assembly that contains the hosting class&quot;.  I thought that was what the <code>StrongName fullTrustAssembly = typeof(Sandboxer).Assembly.Evidence.GetHostEvidence&lt;StrongNa&zwnj;&#8203;me&gt;();</code> was doing.  Once I went into the assembly &#39;Properties&#39; / &#39;Sign&#39; and signed the assembly, the above line worked properly (as per your first link).  Now I have a better understanding I can research that more.  However why then does the &#39;workaround&#39; work without signing?"}, {"owner": {"reputation": 1816, "user_id": 716296, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/182b07f86f731f26791821b1182a30a6?s=128&d=identicon&r=PG", "display_name": "Aaron Murray", "link": "https://stackoverflow.com/users/716296/aaron-murray"}, "edited": false, "score": 0, "creation_date": 1565540483, "post_id": 57438266, "comment_id": 101378108, "body": "Not sure why you created a second answer to the question, however, neither answer really explains why the workaround works for obtaining the <code>StrongName</code>.  I understand now the step I missed in actually signing the assembly (which was not clear by the tutorial), but now if I haven&#39;t signed it, why can I still get the StrongName if I haven&#39;t signed it?"}, {"owner": {"reputation": 96, "user_id": 5212187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d75093b0fbacd7aa3d50d52ee997bb?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek Sayed - MSFT", "link": "https://stackoverflow.com/users/5212187/tarek-sayed-msft"}, "reply_to_user": {"reputation": 1816, "user_id": 716296, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/182b07f86f731f26791821b1182a30a6?s=128&d=identicon&r=PG", "display_name": "Aaron Murray", "link": "https://stackoverflow.com/users/716296/aaron-murray"}, "edited": false, "score": 0, "creation_date": 1565633662, "post_id": 57438266, "comment_id": 101405697, "body": "You didn\u2019t get the StrongName object from the assembly.  You just created a StrongName object using the constructor which is not the same thing. This is not guaranteed to have this nicely work later when really needed to match the running assembly."}, {"owner": {"reputation": 96, "user_id": 5212187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d75093b0fbacd7aa3d50d52ee997bb?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek Sayed - MSFT", "link": "https://stackoverflow.com/users/5212187/tarek-sayed-msft"}, "reply_to_user": {"reputation": 1816, "user_id": 716296, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/182b07f86f731f26791821b1182a30a6?s=128&d=identicon&r=PG", "display_name": "Aaron Murray", "link": "https://stackoverflow.com/users/716296/aaron-murray"}, "edited": false, "score": 0, "creation_date": 1565633796, "post_id": 57438266, "comment_id": 101405754, "body": "I removed the second answer as you pointed out. I didn\u2019t mean to have it as a second answer."}], "tags": [], "owner": {"reputation": 96, "user_id": 5212187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d75093b0fbacd7aa3d50d52ee997bb?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek Sayed - MSFT", "link": "https://stackoverflow.com/users/5212187/tarek-sayed-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1565394451, "creation_date": 1565394451, "answer_id": 57438266, "question_id": 57188151, "link": "https://stackoverflow.com/questions/57188151/why-is-gethostevidencestrongname-returning-null-instead-of-the-expected-stro/57438266#57438266", "title": "Why is GetHostEvidence&lt;StrongName&gt;() returning null instead of the expected StrongName?", "body": "<p>@Aaron Murray</p>\n\n<p>Did you sign your assembly which has the SandBox class? if not, you can try the instructions mentioned here <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/app-domains/how-to-sign-an-assembly-with-a-strong-name\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/app-domains/how-to-sign-an-assembly-with-a-strong-name</a></p>\n\n<p>If the assembly is not signed, then it is expected to have typeof(Sandboxer).Assembly.Evidence.GetHostEvidence() returning null.</p>\n\n<p>the doc <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox</a> is explicity mentioning the signing requirements in step #2</p>\n\n<p>Thanks.  </p>\n"}], "owner": {"reputation": 1816, "user_id": 716296, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/182b07f86f731f26791821b1182a30a6?s=128&d=identicon&r=PG", "display_name": "Aaron Murray", "link": "https://stackoverflow.com/users/716296/aaron-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565478943, "creation_date": 1563988543, "question_id": 57188151, "link": "https://stackoverflow.com/questions/57188151/why-is-gethostevidencestrongname-returning-null-instead-of-the-expected-stro", "title": "Why is GetHostEvidence&lt;StrongName&gt;() returning null instead of the expected StrongName?", "body": "<p>I am putting together a simple (sandboxed) module system for an application that I am writing in order to allow loading and execution of 'modules' written by others (untrusted code) while locking down permissions (File.IO, etc) to minimize the risk of malicious code.</p>\n\n<p>Based on the article: <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/misc/how-to-run-partially-trusted-code-in-a-sandbox\" rel=\"nofollow noreferrer\">How to: Run Partially Trusted Code in a Sandbox</a></p>\n\n<p><em>In step 2: Sign the assembly:</em></p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>StrongName fullTrustAssembly = typeof(Sandboxer).Assembly.Evidence.GetHostEvidence&lt;StrongName&gt;();\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>System.ArgumentException: 'A null StrongName was found in the full trust assembly list.'</p>\n</blockquote>\n\n<p>Further investigation, sure enough, <code>fullTrustAssembly</code> is in fact null, and digging a bit deeper the <code>.GetHostEvidence&lt;StrongName&gt;();</code> is the method that is returning null.</p>\n\n<p>I have found a solution here (that works): <a href=\"https://social.msdn.microsoft.com/Forums/azure/en-US/150cc452-366f-412d-ab7b-b0593f24355e/a-null-strongname-was-found-in-the-full-trust-assembly-list-sandbox-application?forum=csharpgeneral\" rel=\"nofollow noreferrer\">A null strongname was found in the full trust assembly list sandbox application</a> that looks like:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>StrongName fullTrustAssembly = new StrongName(\n    new StrongNamePublicKeyBlob(typeof(Sandboxer).Assembly.GetName().GetPublicKey()),\n    typeof(Sandboxer).Assembly.GetName().Name,\n    typeof(Sandboxer).Assembly.GetName().Version);\n</code></pre>\n\n<p>However, the person that provided the answer to that question stated:</p>\n\n<blockquote>\n  <p>Prior to .net framework 4.0, you could not obtain a strongName by calling GetHostEvidence. Change the version of your .net framework.</p>\n</blockquote>\n\n<p>I am using .NET Framework 4.8, so according to that statement, and the original tutorial, the GetHostEvidence() should be working.</p>\n\n<p><strong>1.  Why is <code>GetHostEvidence&lt;StrongName&gt;()</code> not working as per the original tutorial?</strong></p>\n\n<p><strong>2.  What is the real difference between the two different methods of obtaining a signed StrongName above?</strong></p>\n\n<p><strong>Bonus points</strong></p>\n\n<p>Google has not been my friend with finding current implementations and tutorials to accomplish my task in this sandboxed module manager portion of my project.  Are there any good resources (besides the .NET documentation) that can give more detail to understanding how it all works?  Most of what I can find is way out of date (10+ years old).  Are there more current strategies for achieving this. (note: I have looked into <code>Managed Extensibility Framework (MEF)</code> and feel it's great for another separate part of the project I am working on, but seems like overkill for this part. I have also looked at <code>System.Addin</code> (MAF?) but all I can find is Web/ASP related information for that, to which most of it is also extremely outdated)</p>\n"}, {"tags": ["c#", "entity-framework", "foreach", "savechanges"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 1713644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b23ce0ed99366bf93ee2cca2b3d80a?s=128&d=identicon&r=PG", "display_name": "yurexus", "link": "https://stackoverflow.com/users/1713644/yurexus"}, "is_accepted": true, "score": 1, "last_activity_date": 1563989632, "creation_date": 1563989632, "answer_id": 57188420, "question_id": 57188148, "link": "https://stackoverflow.com/questions/57188148/c-entity-framework-loop-through-records-savechanges-error/57188420#57188420", "title": "c# entity framework loop through records savechanges() error", "body": "<p>You created a single instance of data context for all iterations of the loop. All objects added to the context will live there until the context is disposed or cleared. The situation you observe is:</p>\n\n<ol>\n<li>First entity is added</li>\n<li>An attempt to save changes, but it is failed due to constraint violation</li>\n<li>Second entity is added</li>\n<li>Another attempt to save changes. And here both first and second entity will be attempted to be inserted, because they still belong to the data context.</li>\n</ol>\n\n<p>Please also note that calling \"save changes\" after each entity usually is not efficient. It is better to insert a portion of entities (let's say 100) and persist it in one shot.</p>\n"}], "owner": {"reputation": 1656, "user_id": 3047200, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/2b56e96ec7fa3d6ffc28182ad5af345c?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/3047200/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 57188420, "answer_count": 1, "score": 0, "last_activity_date": 1563989632, "creation_date": 1563988540, "question_id": 57188148, "link": "https://stackoverflow.com/questions/57188148/c-entity-framework-loop-through-records-savechanges-error", "title": "c# entity framework loop through records savechanges() error", "body": "<p>I am doing an <code>C# Entity Framework</code> Application.</p>\n\n<p>I am migrating data from a couple of tables from one database to another database. Those tables are called with the same name.</p>\n\n<p>Here is my code</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>string ConnexionOrigen = ReadConnectionBiz.GetOrigen();\r\nstring ConnexionDestino = ReadConnectionBiz.GetDestino();\r\nusing (var db = new MigrateModel(ConnexionOrigen))\r\n{\r\n  db.Configuration.LazyLoadingEnabled = false;\r\n  db.Configuration.ProxyCreationEnabled = false;\r\n  db.Configuration.AutoDetectChangesEnabled = false;\r\n  List&lt;Promocion&gt; promo = await (from p in db.Promocions\r\n                               .Include(a =&gt;a.PromocionAddresIds)\r\n                         where (p.CAM_ID == 107936 || p.CAM_ID == 107937)\r\n                        select p)\r\n                        .AsNoTracking()\r\n                         .ToListAsync();\r\n\r\n  var dbDestino = new MigrateModel(ConnexionDestino);\r\n  foreach (Promocion pp in promo)\r\n  {\r\n    try\r\n    {\r\n      dbDestino.Promocions.Add(pp);\r\n      await dbDestino.SaveChangesAsync();\r\n    }\r\n    catch (Exception ex)\r\n    {\r\n    string err =  ex.InnerException.InnerException.Message.ToString();\r\n    }\r\n }</code></pre>\r\n</div>\r\n</div>\r\n\nWhat it does here is:</p>\n\n<p>I search in <code>Origen</code> Database from table <code>Promocions</code> and insert those records in Promotions table in Destino Database .</p>\n\n<p>I include a child table called <code>PromocionAddresIds</code> that is migrated too.</p>\n\n<p>Everythig works fine...</p>\n\n<p>The table <code>PromocionAddresIds</code> has a constraint with a table that it is not been migrated.</p>\n\n<p>When I insert the <code>Promotions</code> with <code>cam_id=107936</code> it thrown an exception of <code>contraint violation</code>... Witch is correct...</p>\n\n<p>But when it read the next <code>Promotions</code> record with <code>Cam_id =107937</code>. That record has no record in table PromocionAddresIds, so it must be inserted, but it thrown the same error exception... </p>\n\n<p>It appears that   <code>await dbDestino.SaveChangesAsync();</code> still have the all record or it persist somewhere...</p>\n\n<p>I have tried adding </p>\n\n<p><code>dbDestino.Promocions.Remove(pp);</code> inside the <code>catch exception</code>, but it did not work.</p>\n\n<p>I do not have any clue how to solve it.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "asp.net-core-identity"], "answers": [{"comments": [{"owner": {"reputation": 4533, "user_id": 1034022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d4b94026bd4202e31ff7db86edc182f?s=128&d=identicon&r=PG", "display_name": "Nugs", "link": "https://stackoverflow.com/users/1034022/nugs"}, "edited": false, "score": 0, "creation_date": 1563992980, "post_id": 57188375, "comment_id": 100888389, "body": "Thanks, that was helpful. I now have: _context.Entry(user).Collection(x =&gt; x.UserRoles).Load(); if (!_userManager.IsInRoleAsync(user, &quot;Admin&quot;).GetAwaiter().GetResult()) {     return BadRequest(&quot;Not a Admin&quot;); }  Roles seems to be in the user record now, however IsInRoleAsync still returns a false. Should i not use _userManager?"}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "reply_to_user": {"reputation": 4533, "user_id": 1034022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d4b94026bd4202e31ff7db86edc182f?s=128&d=identicon&r=PG", "display_name": "Nugs", "link": "https://stackoverflow.com/users/1034022/nugs"}, "edited": false, "score": 0, "creation_date": 1563993210, "post_id": 57188375, "comment_id": 100888479, "body": "If that&#39;s returning false, then the user literally isn&#39;t in that role. Simple as that. There&#39;s nothing complex about that method. You&#39;ll need to determine where your data is off. On a side not, what is your resistance to using async? ASP.NET Core is async top to bottom, and so is EF Core. In fact, the sync methods of EF Core merely block on the async versions. Embrace async/await."}], "tags": [], "owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "is_accepted": false, "score": 1, "last_activity_date": 1563989450, "creation_date": 1563989450, "answer_id": 57188375, "question_id": 57188106, "link": "https://stackoverflow.com/questions/57188106/userroles-property-null-for-core-identity-user-record/57188375#57188375", "title": "UserRoles property NULL for Core Identity User record", "body": "<p>Relationships are not automatically loaded. You must either eagerly, explicitly or lazy load them. Eager loading would be using <code>Include</code>, but you cannot do that via <code>UserManager&lt;TUser&gt;</code>. However, you can just use your context instead:</p>\n\n<pre><code>var user = await _context.Users.Include(x =&gt; x.UserRoles).SingleOrDefault(x =&gt; x.NormalizedUserName == userName.ToUpper());\n</code></pre>\n\n<p>That's admittedly not the most ideal way, but it's the only way to do this in a single query.</p>\n\n<p>Explicit loading will issue an additional query, but you can keep using <code>UserManager&lt;TUser&gt;</code>.</p>\n\n<pre><code>var user = await _userManager.FindByNameAsync(userName);\nif (user != null)\n{\n    await _context.Entry(user).Collection(x =&gt; x.UserRoles).LoadAsync();\n    ...\n}\n</code></pre>\n\n<p>Finally, you can lazy load, which is what you're probably <em>trying</em> to do here, since you made all these properties <code>virtual</code>. Lazy-loading is still going to require an extra query (or more, ref: N+1 queries). It's similar to explicit loading, except that call to <code>LoadAsync</code> is basically in the custom getter on the proxy class EF adds, so you don't need to call it explicitly. In general, lazy-loading is frowned upon and should be avoided if at all possible. It is far too easy to end up thrashing your database with hundreds or even thousands of queries for what looks like a simple operation.</p>\n\n<p>Regardless, if you do intend to go the lazy loading route, you have to actually enable it, which is done by calling <code>UseLazyLoadingProxies()</code> when you define your context:</p>\n\n<pre><code>services.AddDbContextPool&lt;dbContext&gt;(options =&gt; options\n    .UseMySql(Configuration.GetConnectionString(\"MySQLConnection\"), mysqlOptions =&gt;\n    {\n        mysqlOptions.ServerVersion(new Version(5, 7, 14), ServerType.MySql);\n    })\n    .UseLazyLoadingProxies()\n);\n</code></pre>\n"}], "owner": {"reputation": 4533, "user_id": 1034022, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9d4b94026bd4202e31ff7db86edc182f?s=128&d=identicon&r=PG", "display_name": "Nugs", "link": "https://stackoverflow.com/users/1034022/nugs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563989450, "creation_date": 1563988352, "last_edit_date": 1563989121, "question_id": 57188106, "link": "https://stackoverflow.com/questions/57188106/userroles-property-null-for-core-identity-user-record", "title": "UserRoles property NULL for Core Identity User record", "body": "<p>I have a custom implementation of Core Identity Users, Roles and UserRoles. The following code is not working for me:</p>\n\n<pre><code>var user = _userManager.FindByNameAsync(userName).GetAwaiter().GetResult();\nif (user != null)\n{\n    if (_passwordHasher.VerifyHashedPassword(user, user.PasswordHash, password) != PasswordVerificationResult.Success)\n    {\n        return BadRequest(\"Invalid password\");\n    }\n\n    if (!await _userManager.IsInRoleAsync(user, \"Admin\"))\n    {\n        return BadRequest(\"Not a Admin\");\n    }\n}\n</code></pre>\n\n<p>When looking at the user object, i see UserRoles property as null:\n<a href=\"https://i.stack.imgur.com/FzkAT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FzkAT.png\" alt=\"enter image description here\"></a></p>\n\n<p>My Identity models are as follows:</p>\n\n<pre><code>public class ApplicationUser : IdentityUser&lt;long&gt;\n{\n    public ApplicationUser()\n    {\n        Accountgroups = new HashSet&lt;Accountgroups&gt;();\n        Balances = new HashSet&lt;Balances&gt;();\n        Payouts = new HashSet&lt;Payouts&gt;();\n        Useralerts = new HashSet&lt;Useralerts&gt;();\n        Userlogs = new HashSet&lt;Userlogs&gt;();\n        Usersettings = new HashSet&lt;Usersettings&gt;();\n        Userinvites = new HashSet&lt;Userinvites&gt;();\n        Withdrawals = new HashSet&lt;Withdrawals&gt;();\n    }\n\n    public long LegacyUserId { get; set; }\n    public long AccountId { get; set; }\n    public string Timezone { get; set; }\n    public string Ip { get; set; }\n    public string Key { get; set; }\n    public string AccountToken { get; set; }\n    public string CurrencyCode { get; set; }\n    public DateTime? Created { get; set; }\n    public DateTime? Activated { get; set; }\n    public DateTime? Deleted { get; set; }\n\n    public virtual ICollection&lt;ApplicationUserClaim&gt; Claims { get; set; }\n    public virtual ICollection&lt;ApplicationUserLogin&gt; Logins { get; set; }\n    public virtual ICollection&lt;ApplicationUserToken&gt; Tokens { get; set; }\n    public virtual ICollection&lt;ApplicationUserRole&gt; UserRoles { get; set; }\n\n    public virtual Accounts Account { get; set; }\n    public virtual ICollection&lt;Accountgroups&gt; Accountgroups { get; set; }\n    public virtual ICollection&lt;Balances&gt; Balances { get; set; }\n    public virtual ICollection&lt;Payouts&gt; Payouts { get; set; }\n    public virtual ICollection&lt;Useralerts&gt; Useralerts { get; set; }\n    public virtual ICollection&lt;Userlogs&gt; Userlogs { get; set; }\n    public virtual ICollection&lt;Userinvites&gt; Userinvites { get; set; }\n    public virtual ICollection&lt;Usersettings&gt; Usersettings { get; set; }\n    public virtual ICollection&lt;Withdrawals&gt; Withdrawals { get; set; }\n}\n\npublic class ApplicationUserRole : IdentityUserRole&lt;long&gt;\n{\n    public virtual ApplicationUser User { get; set; }\n    public virtual ApplicationRole Role { get; set; }\n\n}\n\npublic class ApplicationUserClaim : IdentityUserClaim&lt;long&gt;\n{\n    public virtual ApplicationUser User { get; set; }\n}\n\npublic class ApplicationUserLogin : IdentityUserLogin&lt;long&gt;\n{\n    public virtual ApplicationUser User { get; set; }\n}\n\npublic class ApplicationUserToken : IdentityUserToken&lt;long&gt;\n{\n    public virtual ApplicationUser User { get; set; }\n}\n\npublic class ApplicationRole : IdentityRole&lt;long&gt;\n{\n    public string Description { get; set; }\n\n    public virtual ICollection&lt;ApplicationUserRole&gt; UserRoles { get; set; }\n    public virtual ICollection&lt;ApplicationRoleClaim&gt; RoleClaims { get; set; }\n}\n\npublic class ApplicationRoleClaim : IdentityRoleClaim&lt;long&gt;\n{\n    public virtual ApplicationRole Role { get; set; }\n}\n</code></pre>\n\n<p>My Startup.cs looks like this:</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    services.AddDbContextPool&lt;dbContext&gt;(\n        options =&gt; options.UseMySql(Configuration.GetConnectionString(\"MySQLConnection\"),\n            mysqlOptions =&gt;\n            {\n                mysqlOptions.ServerVersion(new Version(5, 7, 14), ServerType.MySql);\n            }\n    ));\n\n    services.AddDbContextPool&lt;loggerContext&gt;(\n        options =&gt; options.UseMySql(Configuration.GetConnectionString(\"MySQLConnection_Logger\"),\n            mysqlOptions =&gt;\n            {\n                mysqlOptions.ServerVersion(new Version(5, 7, 14), ServerType.MySql);\n            }\n    ));\n\n    services.AddSingleton&lt;IHttpContextAccessor, HttpContextAccessor&gt;();\n    services.AddSingleton&lt;IActionContextAccessor, ActionContextAccessor&gt;();\n\n    //Initialize Identity\n    services.AddIdentity&lt;ApplicationUser, ApplicationRole&gt;(config =&gt;\n    {\n        config.SignIn.RequireConfirmedEmail = true;\n        config.Password.RequireDigit = true;\n        config.Password.RequiredLength = 6;\n        config.Password.RequireNonAlphanumeric = false;\n        config.Password.RequireUppercase = true;\n        config.Password.RequireLowercase = true;\n    })\n    .AddRoles&lt;ApplicationRole&gt;()\n    .AddEntityFrameworkStores&lt;dbContext&gt;()\n    .AddDefaultTokenProviders();\n\n    //Authentication Configuration\n    services.AddAuthorization(options =&gt;\n    {\n        options.AddPolicy(\"TokenRequired\", policy =&gt; policy.RequireClaim(System.Security.Claims.ClaimTypes.NameIdentifier));\n        options.AddPolicy(\"CloudUIAdminOnly\", policy =&gt; policy.RequireClaim(\"IsCloudUIAdmin\"));\n        options.AddPolicy(\"AdminViewAs\", policy =&gt; policy.RequireClaim(\"IsViewingAs\"));\n    });\n\n    services.AddAuthentication(options =&gt;\n    {\n        //MVC cookie authentication\n        options.DefaultAuthenticateScheme = CookieAuthenticationDefaults.AuthenticationScheme;\n        options.DefaultSignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;\n        options.DefaultChallengeScheme = CookieAuthenticationDefaults.AuthenticationScheme;\n    })\n    .AddCookie(options =&gt;\n    {\n        options.AccessDeniedPath = \"/account/login\";\n        options.LoginPath = \"/account/login\";\n        options.Cookie.Name = \".AspNet.SharedCookie\";\n    });\n\n    services.AddDataProtection()\n            .PersistKeysToFileSystem(new DirectoryInfo(@\"D:\\Shared\"))\n            .SetApplicationName(\"TheApp\");\n\n    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n\n    //Inject Identity configuration settings \n    services.Configure&lt;IdentityConfiguration&gt;(Configuration.GetSection(\"Identity\"));\n\n    services.Configure&lt;CookiePolicyOptions&gt;(options =&gt;\n    {\n        options.CheckConsentNeeded = context =&gt; false;\n        options.MinimumSameSitePolicy = SameSiteMode.None;\n    });\n}\n</code></pre>\n\n<p>I've also attempted adding:</p>\n\n<pre><code>.AddUserStore&lt;UserStore&lt;ApplicationUser, \n                        ApplicationRole, \n                        dbContext, \n                        long, \n                        ApplicationUserClaim, \n                        ApplicationUserRole, \n                        ApplicationUserLogin, \n                        ApplicationUserToken, \n                        ApplicationRoleClaim&gt;&gt;()\n.AddRoleStore&lt;RoleStore&lt;ApplicationRole, dbContext, long, ApplicationUserRole, ApplicationRoleClaim&gt;&gt;();\n</code></pre>\n\n<p>and</p>\n\n<pre><code>services.AddScoped&lt;IUserClaimsPrincipalFactory&lt;ApplicationUser&gt;, UserClaimsPrincipalFactory&lt;ApplicationUser, ApplicationRole&gt;&gt;();\n</code></pre>\n\n<p>and</p>\n\n<pre><code>.AddRoleManager&lt;RoleManager&lt;ApplicationRole&gt;&gt;()\n</code></pre>\n\n<p>Nothing seems to fill the user record with their roles. </p>\n\n<p>I have done some searching on this and have found the following:\n<a href=\"https://github.com/aspnet/Identity/issues/1361#issuecomment-348863959\" rel=\"nofollow noreferrer\">https://github.com/aspnet/Identity/issues/1361#issuecomment-348863959</a>\n<a href=\"https://github.com/aspnet/Identity/issues/1813#issuecomment-420066501\" rel=\"nofollow noreferrer\">https://github.com/aspnet/Identity/issues/1813#issuecomment-420066501</a></p>\n\n<p>Nothing seems to be changing my situation. Additionally i am able to create roles and assign user to roles just fine.</p>\n\n<p>Am i missing something here to fill the users roles?</p>\n"}, {"tags": ["c#", "asp.net", "linq", "arraylist", "collections"], "comments": [{"owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1563988686, "post_id": 57188104, "comment_id": 100886417, "body": "Generally if you have a collection and need to convert to another type, you can use a loop to add elements from the collection to a newly instantiated object of the type you want. Its hard to replicate what you have without more code though."}, {"owner": {"reputation": 596, "user_id": 3797979, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ad305143f98cffad1d9b03b72a2048e1?s=128&d=identicon&r=PG&f=1", "display_name": "wolfeh", "link": "https://stackoverflow.com/users/3797979/wolfeh"}, "reply_to_user": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1563989379, "post_id": 57188104, "comment_id": 100886734, "body": "@David Bentley  i use this same code within vb.net and it works perfect.  But C# has a problem with this conversion.  I must be able to cast it or something without putting a loop on every one of these linq querys that would be so monotonous"}, {"owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1563989571, "post_id": 57188104, "comment_id": 100886822, "body": "You could just create a conversion method or extend what <code>AddressCollection</code> can do by following below. Its not much extra code. Olivier Jacot-Descombes answer is elegant but I will post my option for you also."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1563989619, "post_id": 57188104, "comment_id": 100886852, "body": "Your search code is not compiling. Yo are mixing LINQ query syntax with extension method syntax and there is a left brace missing. Also, I don&#39;t see the part where you are converting <code>objSearch</code> back into the <code>AddressCollection</code>"}], "answers": [{"comments": [{"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 596, "user_id": 3797979, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ad305143f98cffad1d9b03b72a2048e1?s=128&d=identicon&r=PG&f=1", "display_name": "wolfeh", "link": "https://stackoverflow.com/users/3797979/wolfeh"}, "edited": false, "score": 0, "creation_date": 1563989904, "post_id": 57188324, "comment_id": 100886971, "body": "I don&#39;t find your code where you are converting a <code>System.Collections.Generic.List</code> to a <code>MemberModel.AddressCollection</code>. Please post the faulty code."}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 0, "last_activity_date": 1563991517, "last_edit_date": 1563991517, "creation_date": 1563989253, "answer_id": 57188324, "question_id": 57188104, "link": "https://stackoverflow.com/questions/57188104/cannot-implicitly-convert-type-system-collections-generic-list-back-to-object-af/57188324#57188324", "title": "Cannot implicitly convert type System.Collections.Generic.List back to Object after linq query", "body": "<p><code>Collection&lt;T&gt;</code> has a constructor accepting a <code>IList&lt;T&gt;</code>. Add a correpsponding constructor to the <code>AddressCollection</code> class and call the base constructor.</p>\n\n<pre><code>public class AddressCollection : System.Collections.ObjectModel.Collection&lt;Address&gt;\n{\n    public AddressCollection(IList&lt;Address&gt; addresses)\n        : base(addresses)\n    {\n    }\n\n    public AddressCollection()\n    {\n    }\n}\n</code></pre>\n\n<p>Now you can convert arrays and lists with</p>\n\n<pre><code>objAddresses = new AddressCollection(objSearch.ToList());\n</code></pre>\n\n<p>See:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.collections.objectmodel.collection-1.-ctor?view=netframework-4.8\" rel=\"nofollow noreferrer\">Collection&lt;T&gt; Constructors</a> </li>\n<li><a href=\"https://stackoverflow.com/questions/12051/calling-the-base-constructor-in-c-sharp\">Calling the base constructor in C#</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "is_accepted": false, "score": 0, "last_activity_date": 1563989742, "creation_date": 1563989742, "answer_id": 57188439, "question_id": 57188104, "link": "https://stackoverflow.com/questions/57188104/cannot-implicitly-convert-type-system-collections-generic-list-back-to-object-af/57188439#57188439", "title": "Cannot implicitly convert type System.Collections.Generic.List back to Object after linq query", "body": "<p>Another simple way of doing it. I am also guessing the parameter is <code>IList</code>. If not try <code>System.Collections.ObjectModel.Collection&lt;Address&gt;</code> instead.</p>\n\n<pre><code>    public AddressCollection GetAddressList(IList&lt;Address&gt; addresses)\n    {\n        MemberModel.AddressCollection objAddresses = new MemberModel.AddressCollection();\n        foreach (var item in addresses)\n        {\n            objAddresses.Add(item);\n        }\n\n        return objAddresses;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "is_accepted": true, "score": 1, "last_activity_date": 1563991470, "last_edit_date": 1563991470, "creation_date": 1563991082, "answer_id": 57188756, "question_id": 57188104, "link": "https://stackoverflow.com/questions/57188104/cannot-implicitly-convert-type-system-collections-generic-list-back-to-object-af/57188756#57188756", "title": "Cannot implicitly convert type System.Collections.Generic.List back to Object after linq query", "body": "<p>You're declaring this:</p>\n\n<pre><code>MemberModel.AddressCollection objAddresses = new MemberModel.AddressCollection();\n</code></pre>\n\n<p>The declared type of <code>objAddresses</code> is <code>AddressCollection</code>. C# is statically typed. Once you have declared a variable with a given type, you cannot assign anything to it which is not of that type.</p>\n\n<p>That's why you're getting an compile error here:</p>\n\n<pre><code>var objSearch = from searchAddresses in objAddresses\n    .WheresearchAddresses =&gt; searchAddresses.MemberZipcode.Contains(\"1173\"))\n    select searchAddresses;\n\nobjAddresses = objSearch.ToList(); // compile error\n</code></pre>\n\n<p><code>objSearch</code> is an <code>IEnumerable&lt;Address&gt;</code>.<br>\nCalling <code>.ToList()</code> gets you a <code>List&lt;Address&gt;</code>. You can't assign a <code>List&lt;Address&gt;</code> to a variable declared as type <code>AddressCollection</code>. You can only assign an <code>AddressCollection</code> or something that inherits from it to that variable.</p>\n\n<p>You can do this:</p>\n\n<pre><code>objAddresses = new MemberModel.AddressCollection(objSearch.ToList());\n</code></pre>\n\n<p>Now you're creating a new instance of <code>AddressCollection</code> that contains all of the items in the <code>List</code>. Then you're assigning the an object of the correct type - <code>AddressCollection</code> -  to the variable.</p>\n\n<hr>\n\n<p>As a side point, when you initially declare the variable you're assigning a new collection but you're never using it. You're just replacing it later with a new collection.</p>\n\n<p>You could just eliminate this:</p>\n\n<pre><code>MemberModel.AddressCollection objAddresses = new MemberModel.AddressCollection ();\n</code></pre>\n\n<p>and declare the variable later where you assign it:</p>\n\n<pre><code>var objAddresses = new MemberModel.AddressCollection(objSearch.ToList());\n</code></pre>\n\n<hr>\n\n<p>And, finally, hungarian notation is dead. You don't need the <code>obj</code> prefix on variable names. People will look at it funny. You can just call the variable <code>addresses</code>.</p>\n"}], "owner": {"reputation": 596, "user_id": 3797979, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ad305143f98cffad1d9b03b72a2048e1?s=128&d=identicon&r=PG&f=1", "display_name": "wolfeh", "link": "https://stackoverflow.com/users/3797979/wolfeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5398, "favorite_count": 0, "accepted_answer_id": 57188756, "answer_count": 3, "score": 0, "last_activity_date": 1563991517, "creation_date": 1563988333, "last_edit_date": 1563988760, "question_id": 57188104, "link": "https://stackoverflow.com/questions/57188104/cannot-implicitly-convert-type-system-collections-generic-list-back-to-object-af", "title": "Cannot implicitly convert type System.Collections.Generic.List back to Object after linq query", "body": "<p>I have an Address class and a collection of Addresses called AddressCollection  \u201cobjAddresses\u201d</p>\n\n<pre><code>namespace MemberModel\n{\n    [Serializable()]\n    public class Address \n    {\n        public int MemberID { get; set; }\n\n        public string MemberStreet { get; set; }\n\n        public string MemberCity { get; set; }\n\n        public string MemberState { get; set; }\n\n        public string MemberZipcode { get; set; }\n    }\n}\n\nusing System.Collections.Generic;\nnamespace MemberModel\n{\n    [System.Serializable()]\n    public class AddressCollection : System.Collections.ObjectModel.Collection&lt;Address&gt;\n    {\n    }\n}\n</code></pre>\n\n<p>I am using Linq to parse down this AddressCollection to get Addrsses with zipcodes that only contain 1173.</p>\n\n<pre><code>MemberModel.AddressCollection objAddresses = new MemberModel.AddressCollection ();\nDataAccess dal = new Member.DataAccess();\n\nobjAddresses = dal.GetAllMemberAddresses();\n\nvar objSearch = from searchAddresses in objAddresses\n    .WheresearchAddresses =&gt; searchAddresses.MemberZipcode.Contains(\"1173\"))\n    select searchAddresses;\n</code></pre>\n\n<p>This works I get 40 addresses out of 1000.</p>\n\n<p>The problem is now I need to convert this objSearch back into the AddressCollection object objAddresses.  I get this error \n<strong>Cannot implicitly convert type</strong></p>\n\n<blockquote>\n  <p>Cannot implicitly convert type System.Collections.Generic.List to\n      MemberModel.AddressCollection</p>\n</blockquote>\n\n<pre><code>objAddresses = objSearch.ToList();\n</code></pre>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 5, "creation_date": 1563986718, "post_id": 57187704, "comment_id": 100885529, "body": "I don&#39;t know ... where is the code for the implementation of the Camera movement/rotation?"}, {"owner": {"reputation": 11, "user_id": 4722134, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153263013877074/picture?type=large", "display_name": "Shawn Steffey", "link": "https://stackoverflow.com/users/4722134/shawn-steffey"}, "edited": false, "score": 0, "creation_date": 1563987274, "post_id": 57187704, "comment_id": 100889226, "body": "It sounds like your camera movement isn&#39;t tied to the Time construct within Unity. Is camera movement determined purely by input or variables incrementing arbitrarily every frame? Make sure all the movement scripts around your camera refer to Time.deltaTime or some part of the calculation connected to the Time system so the <code>Time.timescale = 0f</code> actually affects it."}, {"owner": {"reputation": 679, "user_id": 3264657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20c5379214923e99c21443dd4d3351f1?s=128&d=identicon&r=PG&f=1", "display_name": "Graph Theory", "link": "https://stackoverflow.com/users/3264657/graph-theory"}, "edited": false, "score": 0, "creation_date": 1563994578, "post_id": 57187704, "comment_id": 100889027, "body": "Wild guess since the camera code isn&#39;t present, but setting the timescale to 0 doesn&#39;t necessarily freeze your camera. Sort of like a scene from The Matrix, where the action is stopped but the camera can still move around."}, {"owner": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "reply_to_user": {"reputation": 679, "user_id": 3264657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20c5379214923e99c21443dd4d3351f1?s=128&d=identicon&r=PG&f=1", "display_name": "Graph Theory", "link": "https://stackoverflow.com/users/3264657/graph-theory"}, "edited": false, "score": 0, "creation_date": 1563995158, "post_id": 57187704, "comment_id": 100889219, "body": "@GraphTheory thats what I was thinking after doing more research, but I still have not found a way to fix it."}, {"owner": {"reputation": 679, "user_id": 3264657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20c5379214923e99c21443dd4d3351f1?s=128&d=identicon&r=PG&f=1", "display_name": "Graph Theory", "link": "https://stackoverflow.com/users/3264657/graph-theory"}, "edited": false, "score": 0, "creation_date": 1563995509, "post_id": 57187704, "comment_id": 100889370, "body": "@EthanK-B Adding your camera code can help us answer your question and also help people in the future who have the same question."}, {"owner": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "reply_to_user": {"reputation": 679, "user_id": 3264657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20c5379214923e99c21443dd4d3351f1?s=128&d=identicon&r=PG&f=1", "display_name": "Graph Theory", "link": "https://stackoverflow.com/users/3264657/graph-theory"}, "edited": false, "score": 0, "creation_date": 1563995775, "post_id": 57187704, "comment_id": 100889509, "body": "@GraphTheory I added it"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "edited": false, "score": 1, "creation_date": 1564001596, "post_id": 57190049, "comment_id": 100891829, "body": "So Sorry but I put the wrong camera code (thats what happens when you have been up for 2 nights straight). I updated the post with the correct code."}, {"owner": {"reputation": 419, "user_id": 11797706, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vp2DbJJEVE0/AAAAAAAAAAI/AAAAAAAAACs/DhGqRVbvuN0/photo.jpg?sz=128", "display_name": "mihoci10", "link": "https://stackoverflow.com/users/11797706/mihoci10"}, "reply_to_user": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "edited": false, "score": 0, "creation_date": 1564029638, "post_id": 57190049, "comment_id": 100897519, "body": "Ok now it makes more sense. I edited the answer and it should work now."}, {"owner": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "edited": false, "score": 0, "creation_date": 1564031686, "post_id": 57190049, "comment_id": 100898135, "body": "It does work, but it makes the camera glitchy and it does move well."}, {"owner": {"reputation": 419, "user_id": 11797706, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vp2DbJJEVE0/AAAAAAAAAAI/AAAAAAAAACs/DhGqRVbvuN0/photo.jpg?sz=128", "display_name": "mihoci10", "link": "https://stackoverflow.com/users/11797706/mihoci10"}, "reply_to_user": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "edited": false, "score": 0, "creation_date": 1564031780, "post_id": 57190049, "comment_id": 100898175, "body": "Okay I would guess that is because Time.DeltaTime is being variable throught. Restore the code to the previous one and check my edit above."}, {"owner": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "edited": false, "score": 0, "creation_date": 1564034676, "post_id": 57190049, "comment_id": 100899195, "body": "Works flawlessly. Thank you."}], "tags": [], "owner": {"reputation": 419, "user_id": 11797706, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vp2DbJJEVE0/AAAAAAAAAAI/AAAAAAAAACs/DhGqRVbvuN0/photo.jpg?sz=128", "display_name": "mihoci10", "link": "https://stackoverflow.com/users/11797706/mihoci10"}, "is_accepted": true, "score": 0, "last_activity_date": 1564031913, "last_edit_date": 1564031913, "creation_date": 1563996670, "answer_id": 57190049, "question_id": 57187704, "link": "https://stackoverflow.com/questions/57187704/unity-why-wont-my-fps-pause-menu-stop-the-camera-rotation/57190049#57190049", "title": "Unity Why wont my FPS pause menu stop the camera rotation?", "body": "<p>It could solve it for you, try rotating the camera relative to its own position. So what you would do is add this to the top of your function call:</p>\n\n<pre><code>void Rotation()\n{\n    if(Time.deltaTime == 0){\n        return;\n    }\n...\n</code></pre>\n\n<p>Also note that you might need to change a couple of values to get the rotation amount like before.</p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 89, "user_id": 11755888, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jvKtRBxeyq8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcuEAjGi3csf45-EdGoeoad8-f4BA/photo.jpg?sz=128", "display_name": "Ethan K-B", "link": "https://stackoverflow.com/users/11755888/ethan-k-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 57190049, "answer_count": 1, "score": 0, "last_activity_date": 1564031913, "creation_date": 1563986578, "last_edit_date": 1564001689, "question_id": 57187704, "link": "https://stackoverflow.com/questions/57187704/unity-why-wont-my-fps-pause-menu-stop-the-camera-rotation", "title": "Unity Why wont my FPS pause menu stop the camera rotation?", "body": "<p>I am working on the pause menu for my FPS game and so far I am able to get the pause menu panel to show up and interact with it, but it does not stop the camera movement. Can someone tell me what I am doing wrong?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>public class PauseMenuu : MonoBehaviour\n{\n    public static bool GameIsPaused = false;\n    public GameObject PauseMenu;\n\n    private void Start()\n    {\n\n    }\n\n    void Update()\n    {\n        if (Input.GetKeyDown(KeyCode.Escape))\n        {\n            if (GameIsPaused)\n            {\n                Resume();\n            }\n            else\n            {\n                Pause();\n            }\n        }\n    }\n\n    void Resume()\n    {\n        PauseMenu.SetActive(false);\n        Time.timeScale = 1f;\n        GameIsPaused = false;\n    }\n\n    void Pause()\n    {\n        PauseMenu.SetActive(true);\n        Time.timeScale = 0f;\n        GameIsPaused = true;\n    }\n}\n</code></pre>\n\n<p>here is my camera rotate code if this helps you figure out what is going on with the camera.</p>\n\n<pre><code>public class CameraRotate : MonoBehaviour\n{\npublic float speed;\nfloat time = 14.0f;\npublic GameObject HeadCamera;\npublic bool updateOn = true;\n\nvoid Start()\n{\n    StartCoroutine(updateOff());\n}\n\nvoid Update()\n{\n    Rotation();\n}\nvoid Rotation()\n{\n    RotateX += Input.GetAxis(\"Mouse X\") * RotationSpeed;\n    RotateY += Input.GetAxis(\"Mouse Y\") * RotationSpeed;\n    RotateY = Mathf.Clamp(RotateY, MinYAxis, MaxYAxis);\n    Camera.transform.localRotation = Quaternion.Euler(-RotateY, 0f, 0f);\n    transform.rotation = Quaternion.Euler(0f, RotateX, 0f);\n}\n}\n</code></pre>\n"}, {"tags": ["c#", "winforms", "vsto", "handle", "multiple-monitors"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1563988972, "post_id": 57187603, "comment_id": 100886539, "body": "What do you expect if Word is streched across multiple monitors? Do you just want to center your form over Word? Or are you trying to detect a monitor?"}, {"owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1563995480, "post_id": 57187603, "comment_id": 100889357, "body": "@RufusL: Can&#39;t remember where I saw it, but I think I read that if an app is across monitors, Windows will report that the app is on the monitor that has the majority of the app&#39;s window on it. In any case, I want the form to be centered on the screen that Windows reports the app is on. My updated code (based on your answer) accomplishes this"}], "answers": [{"comments": [{"owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1563995296, "post_id": 57188060, "comment_id": 100889276, "body": "See <b>Update</b> in my op."}, {"owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1563995984, "post_id": 57188060, "comment_id": 100889610, "body": "There is no need to do any math calculations."}, {"owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1563996082, "post_id": 57188060, "comment_id": 100889647, "body": "Isn&#39;t the <code>StartPosition</code> property made for exactly for such purposes?"}, {"owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "reply_to_user": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1564148270, "post_id": 57188060, "comment_id": 100946654, "body": "@EugeneAstafiev The <code>Form</code> has a flyout. I need to calculate left/top using the worst case (1345 pixels wide) so when the form first appears (900 pixels wide) it will still fit on the screen when the flyout appears. Also, the app supports screen resolutions 1360x768-1920x1080. <code>StartPostion</code> in my case is <code>Manual</code>, i,e,, I don&#39;t want or need Windows positioning my form. See <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.form.startposition?view=netframework-4.8\" rel=\"nofollow noreferrer\">Form.StartPosition Property</a> for more info regarding <code>StartPostion</code>."}], "tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": true, "score": 2, "last_activity_date": 1563988157, "creation_date": 1563988157, "answer_id": 57188060, "question_id": 57187603, "link": "https://stackoverflow.com/questions/57187603/why-doesnt-the-child-form-appear-on-the-same-screen-as-the-parent-form/57188060#57188060", "title": "Why doesn&#39;t the child form appear on the same screen as the parent form?", "body": "<p>I don't have VSTO to test this, but it seems to me that you could just get the position of the <code>ActiveWindow</code> that you're using as the parent, and then use that as a reference for positioning your child form:</p>\n\n<pre><code>private void allRootsWithChilds_CheckedChanged(object sender, EventArgs e)\n{\n    var winWordMain = new NativeWindow();\n    var parent = Globals.ThisAddIn.Application.ActiveWindow;\n    winWordMain.AssignHandle(new IntPtr(parent.Hwnd));\n\n    using (var objFormFoo = new ClsFormFoo())\n    {\n        // Set the Left and Top properties so this form is centered over the parent\n        objFormFoo.Left = parent.Left + (parent.Width - objFormFoo.Width) / 2;\n        objFormFoo.Top = parent.Top + (parent.Height - objFormFoo.Height) / 2;\n\n        objFormFoo.ShowDialog(winWordMain);\n    }\n\n    winWordMain.ReleaseHandle();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1563989918, "post_id": 57188125, "comment_id": 100886982, "body": "Maybe its because I&#39;m using <code>ShowDialog(IWin32Window object)</code> and/or because it&#39;s a VSTO add-in and the parent in this case is the Word application, but your approach didn&#39;t work. I made the changes you suggested and when I have Word on the secondary monitor, <code>objFormFoo</code> continues to appear on the primary monitor. Also, my explicit width and height settings for objFormFoo (It&#39;s a <code>FixedDialog</code>) are ignored and objFormFoo is displayed with a width and height that I can&#39;t explain"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11563179"}, "reply_to_user": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1563990332, "post_id": 57188125, "comment_id": 100887160, "body": "@NovaSysEng I will try this myself and say you result"}, {"owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1563991289, "post_id": 57188125, "comment_id": 100887584, "body": "My bad - I forgot that in my <code>ClsFormFoo</code> code, I modify the <code>Left&#39; property myself for centering based on screen resolution. When I used your code and commented my code out,  </code>objFormFoo` appeared on the same screen as Word itself. However, the ClsFormFoo height setting that I established in the designer was over-written with the <code>Height</code> setting from parent screen Bounds object passed in. For this reason, I have to go with Rufus L&#39;s solution. It modifies only the properties needed to move <code>objFormFoo</code> to the same screen as the parent."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11563179"}, "reply_to_user": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1563991291, "post_id": 57188125, "comment_id": 100887586, "body": "@NovaSysEng try set <code>StartPosition</code> for <code>Form</code> to <code>Manual</code>. Since <code>bounds</code> contains the size of the screen, the <code>form</code> will be opened to the full screen. You need to change this yourself. As well as the starting position (<code>Location</code>). Starting from the bounds of the desired screen."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11563179"}, "is_accepted": false, "score": 0, "last_activity_date": 1563988418, "creation_date": 1563988418, "answer_id": 57188125, "question_id": 57187603, "link": "https://stackoverflow.com/questions/57187603/why-doesnt-the-child-form-appear-on-the-same-screen-as-the-parent-form/57188125#57188125", "title": "Why doesn&#39;t the child form appear on the same screen as the parent form?", "body": "<p>I used to make a simple screensaver on C#. I used the following code to open the screensaver on the desired screen or on all of them. </p>\n\n<p>You have to take <code>bounds</code> from the desired screen and pass it to the form.</p>\n\n<pre><code>// Constructor\npublic NameForm(Rectangle bounds)\n{\n    InitializeComponent();\n\n    this.Bounds = bounds;\n}\n\n// In my case, this is opening the screensaver on all screens\nforeach (Screen screen in Screen.AllScreens)\n{\n    NameForm form = new NameForm (screen.Bounds);\n    form.Show();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1564049865, "post_id": 57189873, "comment_id": 100907219, "body": "I also assumed that passing the parent window handle to the child form would make the child form &quot;follow&quot; the parent, but that&#39;s not true. Your code makes the child form center on the parent when the Word app is on the primary screen, but when the Word app is on the secondary screen, the child form still appears on the primary screen (centered on the screen)"}, {"owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1564164542, "post_id": 57189873, "comment_id": 100954570, "body": "Did Word start on the primary screen?"}, {"owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "edited": false, "score": 0, "creation_date": 1564235519, "post_id": 57189873, "comment_id": 100968142, "body": "As I said in my first reply: Your code makes the child form center on the parent when the Word app is on the primary screen, but when the Word app is on the secondary screen, the child form still appears on the primary screen (centered on the screen)"}], "tags": [], "owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1563996046, "creation_date": 1563996046, "answer_id": 57189873, "question_id": 57187603, "link": "https://stackoverflow.com/questions/57187603/why-doesnt-the-child-form-appear-on-the-same-screen-as-the-parent-form/57189873#57189873", "title": "Why doesn&#39;t the child form appear on the same screen as the parent form?", "body": "<p>You just need to set the <code>StartPosition</code> property of your form to the <code>FormStartPosition.CenterParent</code> value:</p>\n\n<pre><code>loginForm.StartPosition = FormStartPosition.CenterParent;\nloginForm.ShowDialog(parentWindowdle);\n</code></pre>\n"}], "owner": {"reputation": 2160, "user_id": 9446665, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BmYHc.png?s=128&g=1", "display_name": "William Charlton", "link": "https://stackoverflow.com/users/9446665/william-charlton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 57188060, "answer_count": 3, "score": 0, "last_activity_date": 1563996046, "creation_date": 1563986091, "last_edit_date": 1563995276, "question_id": 57187603, "link": "https://stackoverflow.com/questions/57187603/why-doesnt-the-child-form-appear-on-the-same-screen-as-the-parent-form", "title": "Why doesn&#39;t the child form appear on the same screen as the parent form?", "body": "<p><strong>Update</strong></p>\n\n<p>I accepted Rufus L's answer with a few mods, Relevant code follows</p>\n\n<pre><code>public partial class ClsOfficeRibbonFooTab\n{\n\n    private void FooTab_Load(object sender, RibbonUIEventArgs e)\n    {\n         .\n         .\n         .\n    }\n\n    private void CheckResolution()\n    {\n        // set the left position so that the expanded version of the form fits on the screen\n        Screen screen = Screen.FromHandle(new IntPtr(Globals.ThisAddIn.Application.ActiveWindow.Hwnd));\n\n        if (screen.Bounds.Width &lt; 1360 || screen.Bounds.Height &lt; 768)\n        {\n            throw new FormatException(String.Format(\"The {0} is supported on screens with a resolution of 1360 by 768 or greater. Your screen is {1} by {2}\", \"Some caption text\", screen.Bounds.Width, screen.Bounds.Height));\n        }\n    }\n\n    private void ObjButtonFoo_Click(object sender, RibbonControlEventArgs e)\n    {\n        using (ClsFormFoo objFormFoo = new ClsFormFoo(parentWindow: Globals.ThisAddIn.Application.ActiveWindow))\n        {\n            CheckResolution();\n            objFormFoo.ShowDialog();\n        }\n    }\n}\n\npublic partial class ClsFormFoo : Form\n{\n    // This form is a fixed dialog with a flyout on the right side. \n    // expandedWidth is a const set to the max width of this fixed dialog (i.e., the dialog with the flyout extended)\n    const int expandedWidth = 1345;\n\n    public ClsFormFoo(Microsoft.Office.Interop.Word.Window parentWindow)\n    {\n        InitializeComponent();\n        Top = parentWindow.Top;\n    }\n\n    private void ClsFormFoo_Load(object sender, EventArgs e)\n    {\n        Screen screen = Screen.FromHandle(new IntPtr(Globals.ThisAddIn.Application.ActiveWindow.Hwnd));\n\n        // set the left position so that the expanded version of the form fits on the screen for all legal resolutions\n        int halfScreenWidth = (int)(screen.WorkingArea.Width / 2);\n        // This form is a fixed dialog with a flyout on the right side. \n        // expandedWidth is a const set to the max width of this fixed dialog (i.e., the dialog with the flyout extended)\n        int halfFormWidth = (int)(expandedWidth / 2);\n        this.Left = screen.Bounds.Left + ((int)(halfScreenWidth - halfFormWidth));\n    }\n}\n</code></pre>\n\n<p><strong>Original Post</strong></p>\n\n<p>My <code>VSTO Add-In</code> provides a ribbon button that when clicked, calls <code>ObjButtonFoo_Click</code>, which in turn, shows a <code>ClsFormFoo</code> form (See <strong>Code</strong> below). <code>ObjButtonFoo_Click</code> includes code to create an IWin32Window owner value representative of Word to pass to ShowDialog.</p>\n\n<p>On a multiple-monitor setup, I would expect that <code>objFormFoo</code> would appear on the same monitor on which Word itself is displayed. However, when I bring up Word on a secondary monitor and cause <code>ObjButtonFoo_Click</code> to be executed, <code>objFormFoo</code> appears on the Primary monitor</p>\n\n<p>What do I do to make <code>objFormFoo</code> appear on the same monitor that Word itself is displayed on whether its the primary monitor or not?</p>\n\n<p>Note: I verified that winWordMain is populated, i.e., its not null. See <strong>winWordMain</strong> below</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>private void ObjButtonFoo_Click(object sender, RibbonControlEventArgs e)\n{\n    NativeWindow winWordMain = new NativeWindow();\n    winWordMain.AssignHandle(new IntPtr(Globals.ThisAddIn.Application.ActiveWindow.Hwnd));\n    IntPtr(Globals.ThisAddIn.Application.ActiveWindow.Hwnd);\n\n    using (ClsFormFoo objFormFoo = new ClsFormFoo()\n    {\n        objFormFoo.ShowDialog(winWordMain);\n    }\n\n    winWordMain.ReleaseHandle();\n}\n</code></pre>\n\n<p><strong>winWordMain</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/LFb7d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LFb7d.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1563987495, "post_id": 57187600, "comment_id": 100885887, "body": "<code>listBox.ItemsSource = Screen.AllScreens.Select(s =&gt; s.DeviceName);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 425, "user_id": 6283419, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/sAgcw.jpg?s=128&g=1", "display_name": "Franck E", "link": "https://stackoverflow.com/users/6283419/franck-e"}, "edited": false, "score": 0, "creation_date": 1563986914, "post_id": 57187772, "comment_id": 100885643, "body": "You made me realize how not straight I was thinking... Thank you."}, {"owner": {"reputation": 644, "user_id": 4852910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--J28Ep3p3_Q/AAAAAAAAAAI/AAAAAAAAARY/4cseKaCZd7s/photo.jpg?sz=128", "display_name": "Gaurav Mathur", "link": "https://stackoverflow.com/users/4852910/gaurav-mathur"}, "reply_to_user": {"reputation": 425, "user_id": 6283419, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/sAgcw.jpg?s=128&g=1", "display_name": "Franck E", "link": "https://stackoverflow.com/users/6283419/franck-e"}, "edited": false, "score": 0, "creation_date": 1563986982, "post_id": 57187772, "comment_id": 100885679, "body": "If this answered your question please mark it as answer :)"}], "tags": [], "owner": {"reputation": 644, "user_id": 4852910, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--J28Ep3p3_Q/AAAAAAAAAAI/AAAAAAAAARY/4cseKaCZd7s/photo.jpg?sz=128", "display_name": "Gaurav Mathur", "link": "https://stackoverflow.com/users/4852910/gaurav-mathur"}, "is_accepted": true, "score": 0, "last_activity_date": 1563989503, "last_edit_date": 1563989503, "creation_date": 1563986805, "answer_id": 57187772, "question_id": 57187600, "link": "https://stackoverflow.com/questions/57187600/wpf-c-create-an-array-for-screen-allscreens-and-display-all-values-within-a-lis/57187772#57187772", "title": "WPF C# Create an array for Screen.AllScreens and display all values within a listbox", "body": "<p>You can simply do - </p>\n\n<pre><code>foreach (Screen screen in Screen.AllScreens)\n{\n      listBox.Items.Add(screen.DeviceName); // Or whatever property you to bind\n}\n</code></pre>\n\n<p><code>AllScreens</code> is already an array.</p>\n\n<p><strong>Update</strong></p>\n\n<p>And yes, as suggested in comment we can directly use <code>ItemsSource</code> property instead of looping. </p>\n\n<p>I completely missed <code>wpf</code> tag on your question, I assumed you are working on <code>WinForms</code> as the question you have linked was related to WinForms</p>\n\n<pre><code>listBox.ItemsSource = Screen.AllScreens.Select(x =&gt; x.DeviceName);\n</code></pre>\n"}], "owner": {"reputation": 425, "user_id": 6283419, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/sAgcw.jpg?s=128&g=1", "display_name": "Franck E", "link": "https://stackoverflow.com/users/6283419/franck-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57187772, "answer_count": 1, "score": -1, "last_activity_date": 1563989503, "creation_date": 1563986062, "question_id": 57187600, "link": "https://stackoverflow.com/questions/57187600/wpf-c-create-an-array-for-screen-allscreens-and-display-all-values-within-a-lis", "title": "WPF C# Create an array for Screen.AllScreens and display all values within a listbox", "body": "<p>I am trying to do something simple and seem to be struggling. Using the answer on another question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1418623/is-there-a-way-to-invoke-the-identify-monitors-function-from-c\">Is there a way to invoke the &quot;Identify Monitors&quot; function from C#?</a></p>\n\n<p>I am trying to create the array and display all values. How should I be doing that?</p>\n\n<pre><code>foreach (Screen screen in Screen.AllScreens as $item)\n        {\n            listBox.Items.Add($item);\n        }\n</code></pre>\n"}, {"tags": ["c#", "botframework", "azure-language-understanding", "qnamaker"], "comments": [{"owner": {"reputation": 2159, "user_id": 10002118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IvgFr.png?s=128&g=1", "display_name": "JJ_Wailes", "link": "https://stackoverflow.com/users/10002118/jj-wailes"}, "edited": false, "score": 0, "creation_date": 1564072897, "post_id": 57187555, "comment_id": 100920015, "body": "Pretty sure I just answered this for you yesterday here <a href=\"https://stackoverflow.com/questions/57116584/can-we-call-qna-bot-for-null-intents-from-main-dialog-or-do-we-need-to-use-dis/57190120#57190120\" title=\"can we call qna bot for null intents from main dialog or do we need to use dis\">stackoverflow.com/questions/57116584/&hellip;</a>"}, {"owner": {"reputation": 2159, "user_id": 10002118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IvgFr.png?s=128&g=1", "display_name": "JJ_Wailes", "link": "https://stackoverflow.com/users/10002118/jj-wailes"}, "edited": false, "score": 0, "creation_date": 1564072952, "post_id": 57187555, "comment_id": 100920042, "body": "This is literally a duplicate OF YOUR OWN QUESTION."}], "answers": [{"comments": [{"owner": {"reputation": 2397, "user_id": 5209435, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d14a78299ebf996ea9b9054cc3bd26ba?s=128&d=identicon&r=PG", "display_name": "Matt Stannett", "link": "https://stackoverflow.com/users/5209435/matt-stannett"}, "reply_to_user": {"reputation": 47, "user_id": 8428927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ad42e95401ec23baec36ad5be90204?s=128&d=identicon&r=PG", "display_name": "user64870", "link": "https://stackoverflow.com/users/8428927/user64870"}, "edited": false, "score": 0, "creation_date": 1564045726, "post_id": 57192158, "comment_id": 100904905, "body": "@user64870 Please upvote and mark as accepted if my answer helped you in order to help others that come across this in the future. \ud83d\ude42"}, {"owner": {"reputation": 47, "user_id": 8428927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ad42e95401ec23baec36ad5be90204?s=128&d=identicon&r=PG", "display_name": "user64870", "link": "https://stackoverflow.com/users/8428927/user64870"}, "edited": false, "score": 0, "creation_date": 1564421916, "post_id": 57192158, "comment_id": 101017079, "body": "I do but get this message: &quot;Thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score&quot;"}, {"owner": {"reputation": 2397, "user_id": 5209435, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d14a78299ebf996ea9b9054cc3bd26ba?s=128&d=identicon&r=PG", "display_name": "Matt Stannett", "link": "https://stackoverflow.com/users/5209435/matt-stannett"}, "reply_to_user": {"reputation": 47, "user_id": 8428927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ad42e95401ec23baec36ad5be90204?s=128&d=identicon&r=PG", "display_name": "user64870", "link": "https://stackoverflow.com/users/8428927/user64870"}, "edited": false, "score": 0, "creation_date": 1564438898, "post_id": 57192158, "comment_id": 101023234, "body": "No worries. :-)"}], "tags": [], "owner": {"reputation": 2397, "user_id": 5209435, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d14a78299ebf996ea9b9054cc3bd26ba?s=128&d=identicon&r=PG", "display_name": "Matt Stannett", "link": "https://stackoverflow.com/users/5209435/matt-stannett"}, "is_accepted": false, "score": 0, "last_activity_date": 1564008179, "creation_date": 1564008179, "answer_id": 57192158, "question_id": 57187555, "link": "https://stackoverflow.com/questions/57187555/how-to-call-qna-maker-from-luis-none-intent-in-c-v4/57192158#57192158", "title": "How to Call QnA maker from LUIS none intent in C# v4", "body": "<p>You'd probably do best to use the <a href=\"https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/14.nlp-with-dispatch\" rel=\"nofollow noreferrer\">nlp-with-dispatch</a> sample as your starting point instead of the CoreBot template, as it already has all of the wiring done for LUIS and QnA maker.</p>\n\n<p>If your already have a QnA Maker KB and LUIS dispatch App setup then you will just need to enter the relevant keys in the <code>appsettings.json</code> file, otherwise you will have to complete the pre-requisite steps in the guide <a href=\"https://docs.microsoft.com/en-us/azure/bot-service/bot-builder-tutorial-dispatch?view=azure-bot-service-4.0&amp;tabs=cs\" rel=\"nofollow noreferrer\">here</a> before being able to run the bot locally.</p>\n\n<p>Once you've got the bot running it is <a href=\"https://github.com/microsoft/BotBuilder-Samples/blob/master/samples/csharp_dotnetcore/14.nlp-with-dispatch/Bots/DispatchBot.cs#L51-L69\" rel=\"nofollow noreferrer\">this block</a> that you're interested in:</p>\n\n<pre><code>private async Task DispatchToTopIntentAsync(ITurnContext&lt;IMessageActivity&gt; turnContext, string intent, RecognizerResult recognizerResult, CancellationToken cancellationToken)\n{\n    switch (intent)\n    {\n        case \"l_HomeAutomation\":\n            await ProcessHomeAutomationAsync(turnContext, recognizerResult.Properties[\"luisResult\"] as LuisResult, cancellationToken);\n            break;\n        case \"l_Weather\":\n            await ProcessWeatherAsync(turnContext, recognizerResult.Properties[\"luisResult\"] as LuisResult, cancellationToken);\n            break;\n        case \"q_sample-qna\":\n            await ProcessSampleQnAAsync(turnContext, cancellationToken);\n            break;\n        default:\n            _logger.LogInformation($\"Dispatch unrecognized intent: {intent}.\");\n            await turnContext.SendActivityAsync(MessageFactory.Text($\"Dispatch unrecognized intent: {intent}.\"), cancellationToken);\n            break;\n    }\n}\n</code></pre>\n\n<p>If you've run through the guide then any qna steps should fall through to the <code>\"q_sample-qna\"</code> case. To answer your question you could add a new case statement to handle the \"none\" intent here then call the <code>ProcessSampleQnAAsync</code> method.</p>\n\n<p>As you add more QnA pairs you will have to update your dispatch model using the <code>refresh</code> command documented <a href=\"https://github.com/microsoft/botbuilder-tools/tree/master/packages/Dispatch#refreshing-your-dispatch-model\" rel=\"nofollow noreferrer\">here</a>, the install instructions for this tool are <a href=\"https://github.com/microsoft/botbuilder-tools/tree/master/packages/Dispatch#installation\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 47, "user_id": 8428927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ad42e95401ec23baec36ad5be90204?s=128&d=identicon&r=PG", "display_name": "user64870", "link": "https://stackoverflow.com/users/8428927/user64870"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "closed_date": 1564074448, "answer_count": 1, "score": -1, "last_activity_date": 1564008179, "creation_date": 1563985905, "question_id": 57187555, "link": "https://stackoverflow.com/questions/57187555/how-to-call-qna-maker-from-luis-none-intent-in-c-v4", "closed_reason": "Duplicate", "title": "How to Call QnA maker from LUIS none intent in C# v4", "body": "<p>I wanted to know if we can call the QnA maker from \"None\" Intent of LUIS apart from using Dispatcher? --- I'm using latest CoreBot Template in C# V4 to build my bot.\nAny code snippets?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "asp.net-core", "smtp"], "comments": [{"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 1, "creation_date": 1563987798, "post_id": 57187480, "comment_id": 100886004, "body": "Make sure your server is actually allowed to call out. You haven&#39;t provided a ton of information, but it&#39;s quite typical to disable outside network access on servers in enterprise environments."}, {"owner": {"reputation": 21656, "user_id": 6265620, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/uf6qO.jpg?s=128&g=1", "display_name": "Edward", "link": "https://stackoverflow.com/users/6265620/edward"}, "edited": false, "score": 0, "creation_date": 1564020484, "post_id": 57187480, "comment_id": 100895827, "body": "Share us the value for <code>emailInfo</code>. Can you send email from your current developer pc manually?"}], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 1158379, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d0d3a91339f11ef77e5edc7fef051585?s=128&d=identicon&r=PG", "display_name": "udaya726", "link": "https://stackoverflow.com/users/1158379/udaya726"}, "edited": false, "score": 0, "creation_date": 1563987108, "post_id": 57187754, "comment_id": 100885734, "body": "Did you use &quot;EASendMail&quot; dependency?"}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 0, "creation_date": 1563987675, "post_id": 57187754, "comment_id": 100885958, "body": "I&#39;m sending email in production through O365 with just <code>EnableSSL</code> on. Works fine. What you&#39;re doing here isn&#39;t necessary."}, {"owner": {"reputation": 930, "user_id": 1158379, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d0d3a91339f11ef77e5edc7fef051585?s=128&d=identicon&r=PG", "display_name": "udaya726", "link": "https://stackoverflow.com/users/1158379/udaya726"}, "edited": false, "score": 0, "creation_date": 1563987940, "post_id": 57187754, "comment_id": 100886062, "body": "I am using  client.EnableSsl = true;"}, {"owner": {"reputation": 619, "user_id": 1136496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5bdda977c118e3bb76f52fccd506e1?s=128&d=identicon&r=PG", "display_name": "jogi", "link": "https://stackoverflow.com/users/1136496/jogi"}, "reply_to_user": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 0, "creation_date": 1563992046, "post_id": 57187754, "comment_id": 100887964, "body": "@ChrisPratt Well if that is the case then I am wrong and there must be another issue with his code or settings.  The other likely cause would be simply lack of connection but I didn&#39;t think it would be that obvious."}], "tags": [], "owner": {"reputation": 619, "user_id": 1136496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5bdda977c118e3bb76f52fccd506e1?s=128&d=identicon&r=PG", "display_name": "jogi", "link": "https://stackoverflow.com/users/1136496/jogi"}, "is_accepted": false, "score": -1, "last_activity_date": 1563986754, "creation_date": 1563986754, "answer_id": 57187754, "question_id": 57187480, "link": "https://stackoverflow.com/questions/57187480/send-email-outlook-smtp-net-core/57187754#57187754", "title": "Send email outlook SMTP .net core", "body": "<p>The issue is that the settings cannot be configured correctly using the SmtpClient object.  To send email with office 365 you need SSL off and TLS on which isn't correctly set using the SmtpClient.EnableSSL setting.</p>\n\n<p>Try this:</p>\n\n<pre><code>var server = new SmtpServer(\"smtp.office365.com\");\n\nserver.User = \"********\";\nserver.Password = \"********\";\n\n// Set 587 port\nserver.Port = 587;\n\n// detect SSL/TLS connection automatically\nserver.ConnectType = SmtpConnectType.ConnectSSLAuto;\n\n// create mail instance\nvar mail = new SmtpMail(\"TryIt\");\nmail.To = \"to@email.com\";\nmail.Subject = \"subject\";\nmail.TextBody = \"text body\";\n\n// send\nsmtp.SendMail(server, mail);\n</code></pre>\n\n<p><strong>I didn't run this but it should be close</strong></p>\n"}], "owner": {"reputation": 930, "user_id": 1158379, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d0d3a91339f11ef77e5edc7fef051585?s=128&d=identicon&r=PG", "display_name": "udaya726", "link": "https://stackoverflow.com/users/1158379/udaya726"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2362, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1563986754, "creation_date": 1563985605, "question_id": 57187480, "link": "https://stackoverflow.com/questions/57187480/send-email-outlook-smtp-net-core", "title": "Send email outlook SMTP .net core", "body": "<p>I am using following code send email through SMTP outlook.</p>\n\n<pre><code>public class EmailHelper\n{\n    private static string SmtpServer { get; set; }\n    private static int SmtpPort { get; set; }\n    private static string SmtpUser { get; set; }\n    private static string SmtpPassword { get; set; }\n\n    public EmailHelper()\n    {\n        SmtpServer = \"smtp.office365.com\";\n        SmtpPort = 587;\n        SmtpUser = \"********\"; //Organization email\n        SmtpPassword = \"******\";//password\n    }\n\n    /// &lt;summary&gt;\n    /// SendEmail\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"emailInfo\"&gt;&lt;/param&gt;\n    public void SendEmail(EmailInfo emailInfo)\n    {\n        emailInfo.SmtpServer = SmtpServer;\n        emailInfo.SmtpPort = SmtpPort;\n        emailInfo.SmtpUser = SmtpUser;\n        emailInfo.SmtpPassword = SmtpPassword;\n\n        using (var client = new SmtpClient(emailInfo.SmtpServer, emailInfo.SmtpPort))\n        {\n            client.UseDefaultCredentials = false;\n            client.Credentials = new NetworkCredential(emailInfo.SmtpUser, emailInfo.SmtpPassword);\n            client.EnableSsl = true;\n\n            MailMessage mailMessage = new MailMessage\n            {\n                From = new MailAddress(emailInfo.From),\n                Subject = emailInfo.Subject,\n                Body = emailInfo.Body,\n                IsBodyHtml = emailInfo.IsBodyHtml\n            };\n\n            foreach (var to in emailInfo.To)\n            {\n                mailMessage.To.Add(to);\n            }\n\n            client.Send(mailMessage);\n        }\n    }\n}\n</code></pre>\n\n<p>I am always getting the error \"A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond\" or the \"operation timeout\"</p>\n\n<p>Please help to sort out this issue</p>\n"}, {"tags": ["c#", "python"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1563986030, "post_id": 57187451, "comment_id": 100885160, "body": "Are any of the files used by Python on a Network drive? I have had issues when full pathnames exceed around 120 characters."}, {"owner": {"reputation": 446, "user_id": 9963147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0598073a516a4b48edb8111a116c73d?s=128&d=identicon&r=PG&f=1", "display_name": "G. B.", "link": "https://stackoverflow.com/users/9963147/g-b"}, "edited": false, "score": 0, "creation_date": 1563988305, "post_id": 57187451, "comment_id": 100886231, "body": "You are probably using different interpreters with different installed packages. To find out your interpreter path: <a href=\"https://stackoverflow.com/questions/2589711/find-full-path-of-the-python-interpreter\" title=\"find full path of the python interpreter\">stackoverflow.com/questions/2589711/&hellip;</a> . To install packages to ipython: <a href=\"https://stackoverflow.com/questions/8663046/how-to-install-a-python-package-from-within-ipython\" title=\"how to install a python package from within ipython\">stackoverflow.com/questions/8663046/&hellip;</a>"}, {"owner": {"reputation": 7, "user_id": 11831442, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-flWBbCHIhfI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkgySZJ62kCIZvG_sTfZc_txqFCw/photo.jpg?sz=128", "display_name": "Allen Hawthorne", "link": "https://stackoverflow.com/users/11831442/allen-hawthorne"}, "edited": false, "score": 0, "creation_date": 1563993518, "post_id": 57187451, "comment_id": 100888621, "body": "Thanks G.B. So Anaconda and IronPython use different interpreter? As I said, I&#39;m new to Python. I can say that the Test.py runs fine from the Anaconda3 power shell prompt, which is using the environment and interpreter I set up. The error only occurs when I run the C# program, which  uses IronPython for creating the engine, but I have no idea what that entails or what needs to be identified. It may well be a case of two interpreters, but I&#39;m not sure what to do about it. IronPython package was obtained with NuGet, if that helps."}, {"owner": {"reputation": 7, "user_id": 11831442, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-flWBbCHIhfI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkgySZJ62kCIZvG_sTfZc_txqFCw/photo.jpg?sz=128", "display_name": "Allen Hawthorne", "link": "https://stackoverflow.com/users/11831442/allen-hawthorne"}, "edited": false, "score": 0, "creation_date": 1563993610, "post_id": 57187451, "comment_id": 100888658, "body": "Thanks jdweng. All files are on my PC."}], "answers": [{"tags": [], "owner": {"reputation": 7, "user_id": 11831442, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-flWBbCHIhfI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkgySZJ62kCIZvG_sTfZc_txqFCw/photo.jpg?sz=128", "display_name": "Allen Hawthorne", "link": "https://stackoverflow.com/users/11831442/allen-hawthorne"}, "is_accepted": false, "score": -1, "last_activity_date": 1564069535, "creation_date": 1564069535, "answer_id": 57205858, "question_id": 57187451, "link": "https://stackoverflow.com/questions/57187451/import-recognition-executing-python-script-from-c/57205858#57205858", "title": "Import recognition executing Python script from C#", "body": "<p>I found the problem. I needed to include:</p>\n\n<p>using IronPython.Runtime;\nusing IronPython;</p>\n"}], "owner": {"reputation": 7, "user_id": 11831442, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-flWBbCHIhfI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkgySZJ62kCIZvG_sTfZc_txqFCw/photo.jpg?sz=128", "display_name": "Allen Hawthorne", "link": "https://stackoverflow.com/users/11831442/allen-hawthorne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564069535, "creation_date": 1563985496, "last_edit_date": 1564016675, "question_id": 57187451, "link": "https://stackoverflow.com/questions/57187451/import-recognition-executing-python-script-from-c", "title": "Import recognition executing Python script from C#", "body": "<p>I'm trying to execute a simple Python script from C# program. The Python script imports cv2 and numpy. This script works when executing from command line, but cannot find cv2 when executing from C#. I'm using Anaconda3, IronPython, Windows 10, Visual Studio 2015 Profesional. I'm new to Python, but I think this may be a path/location problem.</p>\n\n<p><strong>The instruction:</strong></p>\n\n<p><code>engine.ExecuteFile(@\"C:\\Development\\Test.py\");</code></p>\n\n<p>gives the following exception:</p>\n\n<blockquote>\n  <p>\"No module named cv2\"</p>\n</blockquote>\n\n<p>See the code below:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>Using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nusing IronPython.Hosting;\nusing Microsoft.Scripting.Hosting;\n\nnamespace EmbededPyConsoleTest\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n           ExecutePythonScript();\n        }\n        private static void ExecutePythonScript()\n        {\n            ScriptEngine engine = Python.CreateEngine();\n            engine.ExecuteFile(@\"C:\\Development\\Test.py\");\n        }\n    }\n}\n</code></pre>\n\n<pre><code>Python test script:\n\nimport cv2\nimport numpy as np\n-\n-\n-\n-\n</code></pre>\n"}, {"tags": ["c#", "bitmap", "mapping"], "comments": [{"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1563990593, "post_id": 57187447, "comment_id": 100887265, "body": "Did you consider Stride?"}, {"owner": {"reputation": 4573, "user_id": 395685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/506a37c8660a6faa6382086e4a538811?s=128&d=identicon&r=PG", "display_name": "Nyerguds", "link": "https://stackoverflow.com/users/395685/nyerguds"}, "edited": false, "score": 0, "creation_date": 1564126682, "post_id": 57187447, "comment_id": 100935400, "body": "That first code needs to use a lot more <code>using</code> statements... it looks ridiculously leaky."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11666253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0313246d18929c97366e3534b39b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/11666253/axel"}, "edited": false, "score": 0, "creation_date": 1563989972, "post_id": 57187597, "comment_id": 100887002, "body": "what do you mean by an example ? what kind of example do you need?"}, {"owner": {"reputation": 619, "user_id": 1136496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5bdda977c118e3bb76f52fccd506e1?s=128&d=identicon&r=PG", "display_name": "jogi", "link": "https://stackoverflow.com/users/1136496/jogi"}, "reply_to_user": {"reputation": 29, "user_id": 11666253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0313246d18929c97366e3534b39b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/11666253/axel"}, "edited": false, "score": 0, "creation_date": 1563991953, "post_id": 57187597, "comment_id": 100887924, "body": "You give code for three methods but no examples of the values they are given/operating on.  I can&#39;t do much analysis on your code except by reading it and imaging what values the code is working on.  I realize though, that you cannot provide an example image so not sure what more can be done.  did you try what i suggested or was i wrong?"}, {"owner": {"reputation": 29, "user_id": 11666253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0313246d18929c97366e3534b39b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/11666253/axel"}, "edited": false, "score": 0, "creation_date": 1563999517, "post_id": 57187597, "comment_id": 100891088, "body": "The function called Andrew() works and it used the same variables. what do you think Global_x and global_x should be?"}, {"owner": {"reputation": 29, "user_id": 11666253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0313246d18929c97366e3534b39b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/11666253/axel"}, "edited": false, "score": 0, "creation_date": 1564009153, "post_id": 57187597, "comment_id": 100893932, "body": "do you know how this ling workings ?      g.DrawImage(originalBmp, videoSourcePlayer.imagex, videoSourcePlayer.imagey, videoSourcePlayer.imgWidth, videoSourcePlayer.imgHeight);"}, {"owner": {"reputation": 619, "user_id": 1136496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5bdda977c118e3bb76f52fccd506e1?s=128&d=identicon&r=PG", "display_name": "jogi", "link": "https://stackoverflow.com/users/1136496/jogi"}, "reply_to_user": {"reputation": 29, "user_id": 11666253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0313246d18929c97366e3534b39b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/11666253/axel"}, "edited": false, "score": 0, "creation_date": 1564146907, "post_id": 57187597, "comment_id": 100945937, "body": "If you are asking me if I know how graphics.DrawImage works then yes I have used it before.  Not exhaustively but I have used it.  You simple provide an image, and then the drawing dimensions and location.  The issue I would think is more the values you are passing to the call, not if the call works."}], "tags": [], "owner": {"reputation": 619, "user_id": 1136496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5bdda977c118e3bb76f52fccd506e1?s=128&d=identicon&r=PG", "display_name": "jogi", "link": "https://stackoverflow.com/users/1136496/jogi"}, "is_accepted": false, "score": 0, "last_activity_date": 1563986045, "creation_date": 1563986045, "answer_id": 57187597, "question_id": 57187447, "link": "https://stackoverflow.com/questions/57187447/bitmap-to-two-dimensional-array-mapping-error/57187597#57187597", "title": "bitmap to two dimensional array mapping error", "body": "<p>That is a lot of code and without an example that is workable I can only offer a guess that might help.  It would be better if you could show how you are calling these methods and rather than a long explanation offer a working example.  But that aside:</p>\n\n<p>I think you might be off on your initial assignment of global_x and global_y variables in the GetSnapshot method.  You mention that your coords end up being negative and I think you may need to rethink the assignment of </p>\n\n<pre><code>global_x = (int)(videoSourcePlayer.imgWidth - videoSourcePlayer.imagex);\n</code></pre>\n\n<p>I am not sure what you really want in global_x but later you are using it as a loop limit and with this assignment I don't see how it would ever come out positive.  </p>\n"}], "owner": {"reputation": 29, "user_id": 11666253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0313246d18929c97366e3534b39b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Axel", "link": "https://stackoverflow.com/users/11666253/axel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563986045, "creation_date": 1563985471, "question_id": 57187447, "link": "https://stackoverflow.com/questions/57187447/bitmap-to-two-dimensional-array-mapping-error", "title": "bitmap to two dimensional array mapping error", "body": "<p>So I have one connection to a camera but I am pulling data at multiple locations in the code. By data I mean the current frame.\nMy plan is to display the 8 scale version on a (Aforge) videoSourcePlayer, so the user can zoom in and out and draw a box around the area they want, but then map that to a two dimensional array of 12 byte data.\nI am having a problem with the mapping,  somehow when I draw the box on the videoSourcePlayer  the corresponding pixels location are not the same in the two dimensional array and I am not sure why.\nFurthermore, when I do a zoom in, the x and y values became negative numbers and I do not know how to map that back to my two dimensional array.\nNow this code works for I do everything as a bitmap:</p>\n\n<pre><code> private Bitmap Andrew()\n    {\n        Bitmap tempBitmap = new Bitmap(videoSourcePlayer.Width, videoSourcePlayer.Height);\n        Graphics.FromImage(tempBitmap);\n        Graphics g = Graphics.FromImage(tempBitmap);\n        Bitmap originalBmp = videoSourcePlayer.GetCurrentVideoFrame();\n      while (originalBmp == null)\n        {\n            originalBmp = videoSourcePlayer.GetCurrentVideoFrame();\n        }\n        g.DrawImage(originalBmp, videoSourcePlayer.imagex, videoSourcePlayer.imagey, videoSourcePlayer.imgWidth, videoSourcePlayer.imgHeight);\n\n        return tempBitmap;\n    }\n</code></pre>\n\n<p>but when I try to do the two dimensional array my locations are off.</p>\n\n<p>and again I do not know how to handle the negative numbers when it comes to zoom in and out .</p>\n\n<p>here is my code :</p>\n\n<pre><code>    public double[,] GetSnapshot()\n    {\n        global_x = 0;\n        global_y = 0;\n        int rawImageSize = DetermineRawImageSize();\n        byte[] temp = new byte[rawImageSize];\n\n        float[] parameters = new float[1];\n        parameters[0] = 1.5F;\n        transfer.bits = new byte[getBufferSize()];\n        FrameDescriptor frameDesc = new FrameDescriptor();\n        //gets frame from camera\n        ReturnCode rc = Api.GetNextFrame(m_hCamera, transfer.bits.Length, transfer.bits, ref frameDesc);\n        int i4 = 0;\n        int value2 = 0;\n        global_y = (int)(videoSourcePlayer.imgHeight - videoSourcePlayer.imagey);\n        global_x = (int)(videoSourcePlayer.imgWidth - videoSourcePlayer.imagex);\n        double[,] returndata = new double[global_x, global_y];\n\n        for (int x = (int)videoSourcePlayer.imagex; x &lt; global_x; x++)\n        {\n          for (int y = (int)videoSourcePlayer.imagey; y &lt; global_y; y++ )\n            {\n                int value = ((transfer.bits[i4] &lt;&lt; 8) + transfer.bits[i4 + 1]);\n                value2 = (value &gt;&gt; 4);\n                returndata[x,y]= value2;\n                i4 = i4 + 2;\n            }\n        }\n        return returndata;\n    }\n</code></pre>\n\n<p>but when I try and map it to the video player, so the user drawing a blue box on the video player and get the pixels locations of the box, the mapping are not matching up  :</p>\n\n<pre><code>    double zoomingetback(int i2)\n    {\n        double answer = 0D;\n        double l = 0D;\n        double tempD = 0D;\n        double[,] data = GetSnapshot();\n\n            for (int x = stIRList[i2].X; x &lt;= endIRList[i2].X; x++)\n            {\n                for (int y = stIRList[i2].Y; y &lt;= endIRList[i2].Y; y++)\n                {\n                tempD = data[x, y];\n                answer = answer + tempD;\n                    l++;\n                }\n            }\n\n\n        answer = answer / l;\n        return answer;\n\n    }\n</code></pre>\n\n<p>can anyone help ?</p>\n"}, {"tags": ["c#", "microsoft-graph-api"], "answers": [{"tags": [], "owner": {"reputation": 52004, "user_id": 1375553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/a94s0.jpg?s=128&g=1", "display_name": "Vadim Gremyachev", "link": "https://stackoverflow.com/users/1375553/vadim-gremyachev"}, "is_accepted": false, "score": 0, "last_activity_date": 1564288950, "last_edit_date": 1564288950, "creation_date": 1564246718, "answer_id": 57234272, "question_id": 57187426, "link": "https://stackoverflow.com/questions/57187426/error-creating-a-system-io-stream-for-ms-graph/57234272#57234272", "title": "Error creating a system.io.stream for ms graph", "body": "<p>It appears the provided C# example is <em>invalid</em> since <a href=\"https://docs.microsoft.com/en-us/graph/api/page-update?view=graph-rest-1.0&amp;tabs=csharp\" rel=\"nofollow noreferrer\">Update OneNote page content</a> endpoint accepts <em>an array of <a href=\"https://docs.microsoft.com/en-us/graph/api/resources/patchcontentcommand?view=graph-rest-1.0\" rel=\"nofollow noreferrer\"><code>patchContentCommand</code> objects</a></em> as a request body. </p>\n\n<p>The request </p>\n\n<pre><code>PATCH /me/onenote/pages/{id}/content\n[\n    {\n       \"action\":\"append\",\n       \"target\":\"div:{72e378de-be4b-4633-86bc-8e136f9b3c2e}{107}\",\n       \"content\":\"&lt;h1&gt;Some content goes here...&lt;/h1&gt;\",\n       \"position\":\"before\"\n    }\n]\n</code></pre>\n\n<p>could be constructed via <a href=\"https://github.com/microsoftgraph/msgraph-sdk-dotnet\" rel=\"nofollow noreferrer\"><code>msgraph-sdk-dotnet</code></a> like this:    </p>\n\n<pre><code>var patchCommands = new List&lt;OnenotePatchContentCommand&gt;();\npatchCommands.Add(new OnenotePatchContentCommand()\n   {\n        Target = \"div:{72e378de-be4b-4633-86bc-8e136f9b3c2e}{107}\",\n        Action = OnenotePatchActionType.Append,\n        Position = OnenotePatchInsertPosition.Before,\n        Content = \"&lt;h1&gt;Some content goes here...&lt;/h1&gt;\"\n   });\n\nvar request = graphClient.Me.Onenote.Pages[pageId].Content.Request();\nvar message = new HttpRequestMessage(new HttpMethod(\"PATCH\"), request.RequestUrl);\nmessage.Content = new StringContent(JsonConvert.SerializeObject(patchCommands), Encoding.UTF8, \"application/json\");\nawait graphClient.AuthenticationProvider.AuthenticateRequestAsync(message);\nvar response = await graphClient.HttpProvider.SendAsync(message);\n</code></pre>\n\n<blockquote>\n  <p>Note: has been verified against <a href=\"https://www.nuget.org/packages/Microsoft.Graph/\" rel=\"nofollow noreferrer\"><code>Microsoft.Graph 1.16.0</code></a></p>\n</blockquote>\n"}], "owner": {"reputation": 9, "user_id": 11831584, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yi-md03PVyA/AAAAAAAAAAI/AAAAAAAAAEE/RiifsFEdmvk/photo.jpg?sz=128", "display_name": "Bill Pardi", "link": "https://stackoverflow.com/users/11831584/bill-pardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564288950, "creation_date": 1563985405, "last_edit_date": 1563986080, "question_id": 57187426, "link": "https://stackoverflow.com/questions/57187426/error-creating-a-system-io-stream-for-ms-graph", "title": "Error creating a system.io.stream for ms graph", "body": "<p>Trying to update a OneNote page in C# using MS Graph per the instructions here: <a href=\"https://docs.microsoft.com/en-us/graph/api/page-update?view=graph-rest-1.0&amp;tabs=csharp\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/graph/api/page-update?view=graph-rest-1.0&amp;tabs=csharp</a>. </p>\n\n<pre><code>var Stream = new List&lt;Stream&gt;()\n    {\n        new Stream\n        {\n            Target = \"#para-id\",\n            Action = \"insert\",\n            Position = \"before\",\n            Content = \"&lt;img src=\\\"image-url-or-part-name\\\" alt=\\\"image-alt-text\\\" /&gt;\"\n        },\n        new Stream\n        {\n            Target = \"#list-id\",\n            Action = \"append\",\n            Content = \"&lt;li&gt;new-page-content&lt;/li&gt;\"\n        }\n    };\n</code></pre>\n\n<p>But keep getting the error: </p>\n\n<blockquote>\n  <p>\"Cannot create an instance of the abstract class or interface\n  'Stream'\"</p>\n</blockquote>\n\n<p>I can't figure out any way to create a stream that the Onenotepage object will accept.</p>\n\n<p>I've tried variations of </p>\n\n<pre><code>    IRandomAccessStream stream = null;\n    Stream content = onRichText.Document.SaveToStream(Windows.UI.Text.TextGetOptions.None, stream);\n</code></pre>\n\n<p>but get the error </p>\n\n<blockquote>\n  <p>\"Cannot implicitly convert type 'void' to 'System.IO.Stream'\"</p>\n</blockquote>\n"}, {"tags": ["c#", "restsharp"], "owner": {"reputation": 421, "user_id": 1438368, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7fb47cded2b43ebb0dedcc39ede925cf?s=128&d=identicon&r=PG", "display_name": "user94614", "link": "https://stackoverflow.com/users/1438368/user94614"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1563985404, "creation_date": 1563985404, "question_id": 57187424, "link": "https://stackoverflow.com/questions/57187424/restsharp-how-to-post-object-with-stream", "title": "RestSharp How to post object with stream", "body": "<p>I'm attempting to post an object that contains a stream. Is there a \"best\" practice to do this with RestSharp? Do I serialize the object to JSON or use a Multipart/form-data?</p>\n\n<p>Sample object:</p>\n\n<pre><code>public class Document\n{\n    public string Number { get; set; }\n    public string Revision { get; set; }\n    public string FileName { get; set; }\n    public Stream File { get; set; }\n}\n</code></pre>\n\n<p>Sample RestSharp client:</p>\n\n<pre><code>RestClient restClient = new RestClient(fullUrl)\n{\n    Authenticator = new HttpBasicAuthenticator(username, password),\n};\nRestRequest request = new RestRequest(Method.POST);\n\n// do I use AddFile, AddParameters or both here?\n\nIRestResponse response = restClient.Execute(request);\n</code></pre>\n\n<p>I have used Postman as my PoC but I honestly don't understand the AddParameter part:</p>\n\n<pre><code>var client = new RestClient(myURL);\nvar request = new RestRequest(Method.POST);\nrequest.AddHeader(\"content-type\", \"multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\");\nrequest.AddParameter(\n    \"multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\", \n    \"------WebKitFormBoundary7MA4YWxkTrZu0gW\\r\\nContent-Disposition: form-data; name=\\\"number\\\"\\r\\n\\r\\nmyFile\\r\\n\n    ------WebKitFormBoundary7MA4YWxkTrZu0gW\\r\\nContent-Disposition: form-data; name=\\\"revision\\\"\\r\\n\\r\\nA.4\\r\\n\n    ------WebKitFormBoundary7MA4YWxkTrZu0gW\\r\\nContent-Disposition: form-data; name=\\\"file\\\"; filename=\\\"myFile.pdf\\\"\\r\\nContent-Type: application/pdf\\r\\n\\r\\n\\r\\n\n    ------WebKitFormBoundary7MA4YWxkTrZu0gW--\", \n    ParameterType.RequestBody);\nIRestResponse response = client.Execute(request);\n</code></pre>\n"}, {"tags": ["c#", "html", "css", "asp.net-core", "mobile"], "answers": [{"tags": [], "owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "is_accepted": true, "score": 0, "last_activity_date": 1563988239, "creation_date": 1563988239, "answer_id": 57188081, "question_id": 57187407, "link": "https://stackoverflow.com/questions/57187407/core-2-0-navbar-banner-covering-page-content-on-mobile-device/57188081#57188081", "title": "Core 2.0 navbar banner covering page content on mobile device", "body": "<p>You're using a fixed header and its text is wrapping on mobile. Therefore, the normal top padding you're applying to the content to push it below the header is insufficient on mobile. You'll need to utilize media query breakpoints to change either the font-size in the header (so it doesn't wrap) and/or adjust the top padding to compensate for the wrapping.</p>\n\n<pre><code>.body-content {\n    padding-top: 210px;\n}\n\n@media (min-width: 480px) {\n    .body-content {\n        padding-top: 110px;\n    }\n}\n</code></pre>\n\n<p>This might look a little backwards, but your base style should be what's required on mobile, and then you specify break points from there, reducing the padding once you hit a width that no longer wraps the heading text. I just plopped in <code>480px</code>, but you'll need to test to see what the actual width is for you.</p>\n"}], "owner": {"reputation": 139, "user_id": 2370664, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6cd903cc77e046b1f80c6afadbdeba70?s=128&d=identicon&r=PG", "display_name": "user2370664", "link": "https://stackoverflow.com/users/2370664/user2370664"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 57188081, "answer_count": 1, "score": 0, "last_activity_date": 1563988239, "creation_date": 1563985351, "question_id": 57187407, "link": "https://stackoverflow.com/questions/57187407/core-2-0-navbar-banner-covering-page-content-on-mobile-device", "title": "Core 2.0 navbar banner covering page content on mobile device", "body": "<p>I created a simple core 2.0 web application but i'm having issues getting the content to display on a mobile device.</p>\n\n<p>This is an image of the site when i hold the device vertical:\n<a href=\"https://i.stack.imgur.com/SFnx6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SFnx6.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is an image when i hold the device vertical and scroll down:\n<a href=\"https://i.stack.imgur.com/yXLDX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yXLDX.png\" alt=\"enter image description here\"></a></p>\n\n<p>When i hold the device sideways, the message also appears:\n<a href=\"https://i.stack.imgur.com/oWpvM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oWpvM.png\" alt=\"enter image description here\"></a></p>\n\n<p>For the most part i used the default settings after creating the project in Visual Studio 2017.\nThis is the markup in _Layout.cshtml:</p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n        &lt;nav class=\"navbar navbar-inverse navbar-fixed-top text-center vcenter \" style=\"font-size:80px; font-weight:bolder;color:white;\"&gt;\n            The                 \n        &lt;/nav&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Here's the markup for the page that contains the message:</p>\n\n<pre><code>&lt;div class=\"row\" style=\"width:100%;height:100%;\"&gt;\n    @if (!String.IsNullOrEmpty(Model.message))\n    {\n        &lt;div class=\"row col-md-10 text-center\" id=\"divMessage\" \n          style=\"background-color:white;\"&gt;\n          @Model.message\n        &lt;/div&gt;\n}\n&lt;/div&gt;\n</code></pre>\n\n<p>Here is the css for the navbar:</p>\n\n<pre><code>   .navbar {\n        position: fixed;\n        min-height: 100px;\n        margin-bottom: 20px;\n        min-width: 100%;\n        border: 1px solid transparent;\n        color: white;\n    }\n@media (min-width: 768px) {\n    .navbar {\n        border-radius: 4px;\n    }\n    .navbar-fixed-top {\n        position: relative;\n        top: auto;\n    }\n    .navbar-collapse {\n        max-height: none;\n    }\n    body {\n        margin: 0;\n    }\n}\n</code></pre>\n\n<p>Here is the css for the body:</p>\n\n<pre><code>    body {\n    padding-top: 0px;\n    padding-bottom: 20px;\n}\n\n.body-content {\n    padding-top: 110px;\n    padding-left: 15px;\n    padding-right: 15px;\n}\n</code></pre>\n\n<p>Can someone please help me fix the vertical view of the site on a mobile device so that body content does not get hidden underneath the navbar?</p>\n"}, {"tags": ["c#", ".net", "dependency-injection", "autofac"], "comments": [{"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1563988070, "post_id": 57187397, "comment_id": 100886119, "body": "Have a look at <a href=\"https://autofaccn.readthedocs.io/en/latest/advanced/keyed-services.html\" rel=\"nofollow noreferrer\">Named and Keyed Services</a>"}, {"owner": {"reputation": 25, "user_id": 10624019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HV2HZzKboyg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAsCD3XDmeD71cKxW_Rt3SNvWqKaQ/mo/photo.jpg?sz=128", "display_name": "earp", "link": "https://stackoverflow.com/users/10624019/earp"}, "reply_to_user": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1564039580, "post_id": 57187397, "comment_id": 100901406, "body": "Hello, I&#39;ve looked at them. I think what I needed more was the Instance Scope page. I&#39;m still beginner so I get lost sometimes. Thanks anyway, Olivier."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10624019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HV2HZzKboyg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAsCD3XDmeD71cKxW_Rt3SNvWqKaQ/mo/photo.jpg?sz=128", "display_name": "earp", "link": "https://stackoverflow.com/users/10624019/earp"}, "edited": false, "score": 0, "creation_date": 1564039682, "post_id": 57194246, "comment_id": 100901462, "body": "First thanks John King for your answer. It must have took you some times to make it. You totally covered everything my questions implied. I don&#39;t need to have the same repo during the whole life time of BLLClass. I think i&#39;ll go for &quot;.InstancePerDependency()&quot; with using statement because then my BLLClass doesnt need to implement IDisposable. I&#39;m having trouble figuring out when using &quot;.InstancePerLifeTimeScope()&quot; would be preferable, but my problem is solved ! Thanks again (I did upvote your answer but my rep is too low to display it)"}, {"owner": {"reputation": 194, "user_id": 11820113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c24d36d7745e24a5d765de7ffa3ea8?s=128&d=identicon&r=PG&f=1", "display_name": "John King", "link": "https://stackoverflow.com/users/11820113/john-king"}, "reply_to_user": {"reputation": 25, "user_id": 10624019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HV2HZzKboyg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAsCD3XDmeD71cKxW_Rt3SNvWqKaQ/mo/photo.jpg?sz=128", "display_name": "earp", "link": "https://stackoverflow.com/users/10624019/earp"}, "edited": false, "score": 0, "creation_date": 1564044232, "post_id": 57194246, "comment_id": 100904058, "body": "No worries. I think you can still accept the answer as per this: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> (I&#39;m also new to this). Thanks!"}], "tags": [], "owner": {"reputation": 194, "user_id": 11820113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c24d36d7745e24a5d765de7ffa3ea8?s=128&d=identicon&r=PG&f=1", "display_name": "John King", "link": "https://stackoverflow.com/users/11820113/john-king"}, "is_accepted": true, "score": 1, "last_activity_date": 1564028212, "creation_date": 1564028212, "answer_id": 57194246, "question_id": 57187397, "link": "https://stackoverflow.com/questions/57187397/when-does-iindexk-v-instanciates-its-resolved-components/57194246#57194246", "title": "When does IIndex&lt;K,V&gt; instanciates its resolved components?", "body": "<p>The injected <code>IIndex</code> does act like a factory, as you say. With</p>\n\n<pre><code>// Let's say that \"repositories\" is a IIndex&lt;K,V&gt;\nIRepository&lt;SomeObjectType&gt; someRepository = repositories[someEnum.SomeValue];\n</code></pre>\n\n<p>That will return either a new or existing object, depending on how everything has been registered. By default, you would get a new object every time <code>repositories[someEnum.SomeValue]</code> is called.</p>\n\n<p>Regarding disposal, I think you can leverage one of several built-in Autofac options to get the behaviour you want, if you switch your <code>Repositories</code> field to this:</p>\n\n<pre><code>public BLLClass : IDisposable\n{\n    private IIndex&lt;eBaseSQL,IRepository&lt;SomeObjectType&gt;&gt; Repositories;\n</code></pre>\n\n<p>First question: is it important to have the same repo of each type for all operations which the <code>BLLClass</code> executes in its lifetime? The overhead creating objects such as your repos each time they're used is generally pretty small, and using shorter-lived objects can help keep things simple and clean. In that case, if your registrations for the repos are <code>InstancePerDependency</code> (this is also the default), in your <code>BLLClass</code>, operations would just look like:</p>\n\n<pre><code>public void DoStuff()\n{\n    using (var repo = Repositories[eBaseSql.SomeKey])\n    {\n    }\n}\n</code></pre>\n\n<p>So the repo would be recreated every time you request it and you can safely dispose of each instance yourself with <code>using</code>. That would still work resolving the repos multiple times, like:</p>\n\n<pre><code>public void DoStuff()\n{\n    using (var repo = Repositories[eBaseSql.SomeKey]) { }\n    using (var sameRepoAgainButNew = Repositories[eBaseSql.SomeKey]) { }\n}\n</code></pre>\n\n<p>The other approach, if you do need a single instance of each repo for any calls within the lifetime of a single <code>BLLClass</code>, you can just register your <code>IRepository</code> implementation using Autofac's <code>.InstancePerLifetimeScope</code>:</p>\n\n<pre><code>builder.RegisterType&lt;Repository&lt;SomeObjectType&gt;&gt;()\n    .Keyed&lt;IRepository&lt;SomeObjectType&gt;&gt;(eBaseSql.SomeKey)\n    .InstancePerLifetimeScope();\n</code></pre>\n\n<p>Then if in <code>BLLClass</code> you have:</p>\n\n<pre><code>public void DoStuff()\n{\n    var repo = Repositories[eBaseSql.SomeKey];\n}\n</code></pre>\n\n<p>that repo instance should be disposed at the end of the life of the BLLClass. The assumption is that the BLLClass itself created from a scope which is disposed one way or another, a very simple example being:</p>\n\n<pre><code>using (var scope = container.BeginLifetimeScope())\n{\n    var bll = scope.Resolve&lt;BLLClass&gt;();\n    bll.DoStuff();\n}\n</code></pre>\n\n<p>The implementation of <code>IIndex&lt;&gt;</code> which is injected into the <code>BLLClass</code> stores a reference to a component context which is disposed when that outer scope is disposed, which in turn will dispose of any child objects which implement IDisposable (see <a href=\"https://autofaccn.readthedocs.io/en/latest/lifetime/disposal.html#automatic-disposal\" rel=\"nofollow noreferrer\">https://autofaccn.readthedocs.io/en/latest/lifetime/disposal.html#automatic-disposal</a>). In this case, that's the repositories we've generated. For example:</p>\n\n<pre><code>using (var scope = container.BeginLifetimeScope())\n{\n    var bll = scope.Resolve&lt;BLLClass&gt;();\n    bll.DoStuff();      // do something using our first repo implementation\n    bll.DoMoreStuff();  // do something else using the same type of repo\n}                       // here the scope is disposed, taking any generated repos with it\n\npublic void DoStuff()\n{\n    var repo = _repositories[eBaseSql.SomeKey];\n    // some actions here\n}\n\npublic void DoMoreStuff()\n{\n    var repo = _repositories[eBaseSql.SomeKey];    // the same repo as used in DoStuff will be returned here because of the .InstancePerLifetimeScope registration\n}\n</code></pre>\n\n<p>Dynamically creating objects with one of these approaches using Autofac's built-in factories also means that you won't create any repos you end up not using, which looks to be possible in your initial implementation.</p>\n"}], "owner": {"reputation": 25, "user_id": 10624019, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HV2HZzKboyg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAsCD3XDmeD71cKxW_Rt3SNvWqKaQ/mo/photo.jpg?sz=128", "display_name": "earp", "link": "https://stackoverflow.com/users/10624019/earp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 57194246, "answer_count": 1, "score": 0, "last_activity_date": 1564028212, "creation_date": 1563985310, "question_id": 57187397, "link": "https://stackoverflow.com/questions/57187397/when-does-iindexk-v-instanciates-its-resolved-components", "title": "When does IIndex&lt;K,V&gt; instanciates its resolved components?", "body": "<p>I searched about topics related to this question, but I didnt find the answer i was looking for.\nSorry in advance if this has already been said.</p>\n\n<p>Let's present my question :\nI've a concrete class, let's call it BLLClass, on which I inject by constructor two implementations of IRepository.\nEach of thoses implementations has its own DbContext type.\nI want to have access to both IRepository at anytime, to be able to perform actions on any database at anytime, and to dispose them once i've finished.\nOriginally, I went with something like that :</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public BLLClass : IDisposable\n{\n    private Dictionary&lt;eBaseSQL,IRepository&lt;SomeObjectType&gt;&gt; Repositories;\n\n    public BLLClass(IIndex&lt;eBaseSql, IRepository&lt;SomeObjectType&gt; repositories)\n    {\n        Repositories = new Dictionary&lt;eBaseSQL, IRepository&lt;SomeObjectType&gt;&gt;();\n        Repositories.Add(eBaseSQL.DatabaseOne, repositories[eBaseSQL.DatabaseOne]);\n        Repositories.Add(eBaseSQL.DatabaseTwo, repositories[eBaseSQL.DatabaseTwo]);\n    }\n\n    public void Dispose()\n    {\n        foreach(IRepository&lt;SomeObjectType&gt; Repository in Repositories.Values)\n        {\n            Repository.Dispose();\n        }   \n    }\n}\n</code></pre>\n\n<p>This is working fine and doing exactly what I want.\nBut, I find it kinda ugly to add my implementations into a Dictionary while Autofac provides IIndex, which, is not a dictionary but LOOKS LIKE to act like one. </p>\n\n<p>So here's my questions :\nCan i use IIndex like I do with Dictionary ?\nWhen does my concrete implementation of IRepository gets instanciated ?\nWill it create a new object eachtime I do </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// Let's say that \"repositories\" is a IIndex&lt;K,V&gt;\nIRepository&lt;SomeObjectType&gt; someRepository = repositories[someEnum.SomeValue];\n</code></pre>\n\n<p>Or it will give always the same object ?\nThis really concerns me because, if IIndex instanciates a new Repository everytime I use one, I won't be able to dispose them afterwards.</p>\n\n<p>Thanks for your time, and sorry for my english that is clearly, not the best.</p>\n"}, {"tags": ["c#", "string", "split"], "comments": [{"owner": {"reputation": 2689, "user_id": 2403570, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Z2ngh.jpg?s=128&g=1", "display_name": "Zam", "link": "https://stackoverflow.com/users/2403570/zam"}, "edited": false, "score": 0, "creation_date": 1564002648, "post_id": 57187325, "comment_id": 100892197, "body": "why no one offer you to use <code>RegEx</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 11713280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18efffc9c39e8f1b866b9a70d2179c4d?s=128&d=identicon&r=PG&f=1", "display_name": "pappbence96", "link": "https://stackoverflow.com/users/11713280/pappbence96"}, "reply_to_user": {"reputation": 2689, "user_id": 2403570, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Z2ngh.jpg?s=128&g=1", "display_name": "Zam", "link": "https://stackoverflow.com/users/2403570/zam"}, "edited": false, "score": 0, "creation_date": 1563985668, "post_id": 57187400, "comment_id": 100884995, "body": "Yeah I assumed this is always the format. If it is not (for example, the company can have a name with &gt;1 words, this won&#39;t work either)."}, {"owner": {"reputation": 1068, "user_id": 11713280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18efffc9c39e8f1b866b9a70d2179c4d?s=128&d=identicon&r=PG&f=1", "display_name": "pappbence96", "link": "https://stackoverflow.com/users/11713280/pappbence96"}, "reply_to_user": {"reputation": 2689, "user_id": 2403570, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Z2ngh.jpg?s=128&g=1", "display_name": "Zam", "link": "https://stackoverflow.com/users/2403570/zam"}, "edited": false, "score": 0, "creation_date": 1563985894, "post_id": 57187400, "comment_id": 100885091, "body": "Added an improved solution which should cover his cases."}], "tags": [], "owner": {"reputation": 1068, "user_id": 11713280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18efffc9c39e8f1b866b9a70d2179c4d?s=128&d=identicon&r=PG&f=1", "display_name": "pappbence96", "link": "https://stackoverflow.com/users/11713280/pappbence96"}, "is_accepted": false, "score": 0, "last_activity_date": 1563985808, "last_edit_date": 1563985808, "creation_date": 1563985322, "answer_id": 57187400, "question_id": 57187325, "link": "https://stackoverflow.com/questions/57187325/i-want-to-split-the-string-and-should-get-specific-text-using-c/57187400#57187400", "title": "I want to split the string and should get specific text using C#", "body": "<p>Your indices are off by one. You have 5 spaces in the string, so that will result in 6 strings after <code>Split(\" \")</code>. So you have to access <code>companyName[4]</code> and <code>companyName[5]</code>.</p>\n\n<p>A more elegant solution would be:</p>\n\n<pre><code>int last = companyName.Count;\nstring companyNameString = companyName[last - 1] + \" \" + companyName[last];\n</code></pre>\n\n<p>But the best solution, assuming the format is always the following:</p>\n\n<blockquote>\n  <p>&lt;string&gt; - &lt;number&gt; - &lt;company name&gt;</p>\n</blockquote>\n\n<p>is:</p>\n\n<pre><code>string companyName = this.renewalSummaryPage.QuoteNameField.GetText().Split(\"-\").LastOrDefault();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1563987331, "post_id": 57187461, "comment_id": 100885826, "body": "Does not handle possible <code>&#39;-&#39;</code> characters in the company name. I added a neat way of doing it below."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "reply_to_user": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 0, "creation_date": 1563987585, "post_id": 57187461, "comment_id": 100885921, "body": "@DavidBentley: The problem is that we do not have specification of the possible inputs. Maybe the hyphen is always surrounded by spaces. Then we could split at <code>&quot; - &quot;</code>. This would probably exclude the ones inside a name <code>&quot;Quote - 1234 - Best-Company&quot;</code>."}, {"owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "edited": false, "score": 1, "creation_date": 1563988356, "post_id": 57187461, "comment_id": 100886263, "body": "True. We would definitely need to have a more concrete spec for the input."}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": true, "score": 1, "last_activity_date": 1563986266, "last_edit_date": 1563986266, "creation_date": 1563985538, "answer_id": 57187461, "question_id": 57187325, "link": "https://stackoverflow.com/questions/57187325/i-want-to-split-the-string-and-should-get-specific-text-using-c/57187461#57187461", "title": "I want to split the string and should get specific text using C#", "body": "<p>If you split by spaces, then you will get <code>\"Kernal\"</code> and <code>\"Ltd\"</code> as two distinct entries. Split by <code>'-'</code> and don't rely on a specific number of parts. Instead look for the length of the resulting array.</p>\n\n<pre><code>string[] parts = \"Your Quote - 12345- Kernal Ltd\".Split('-');\nstring name = parts[parts.Length - 1].Trim(); // ==&gt; \"Kernal Ltd\"\n</code></pre>\n\n<p>Array indexes are zero-based and range from <code>0</code> to <code>Length - 1</code>.</p>\n\n<p>Or with Linq</p>\n\n<pre><code>string[] parts = \"Your Quote - 12345- Kernal Ltd\".Split('-');\nstring name = parts.Last().Trim();\n</code></pre>\n\n<p>Note that <code>String.Split</code> returns always at least one item. If the input string does not contain the split character(s), the whole string is returned in an array of length 1.</p>\n"}, {"tags": [], "owner": {"reputation": 732, "user_id": 6641300, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9b14b1e30b33d5cfd2e7d7df59fabc67?s=128&d=identicon&r=PG", "display_name": "David Bentley", "link": "https://stackoverflow.com/users/6641300/david-bentley"}, "is_accepted": false, "score": 0, "last_activity_date": 1563987375, "last_edit_date": 1563987375, "creation_date": 1563985788, "answer_id": 57187527, "question_id": 57187325, "link": "https://stackoverflow.com/questions/57187325/i-want-to-split-the-string-and-should-get-specific-text-using-c/57187527#57187527", "title": "I want to split the string and should get specific text using C#", "body": "<p>You should probably provide more context. If this is something reusable and the format is always the same, you could split and trim based on the <code>'-'</code> character. This will work assuming you do not have <code>'-'</code> in your company names. Remember this will FAIL if the format is not the same for your input.</p>\n\n<pre><code>var companyName = this.renewalSummaryPage.QuoteNameField.GetText().Split('-').LastOrDefault().Trim();\n</code></pre>\n\n<p>Now, if you have <code>'-'</code> characters in the company name...you can do the following. This will rebuild the string with the company name if <code>'-'</code> characters exist.</p>\n\n<pre><code>string[] parts = text.Split('-');\nif (parts.Length &gt; 2)\n{\n    companyName = string.Join(\"-\", parts.Skip(2)).Trim();\n}\nelse\n{\n    companyName = parts.LastOrDefault().Trim();\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9067878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65a337e662c84a01f6a2c7655cdfc84a?s=128&d=identicon&r=PG&f=1", "display_name": "Vinoth", "link": "https://stackoverflow.com/users/9067878/vinoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 57187461, "answer_count": 3, "score": 0, "last_activity_date": 1563987375, "creation_date": 1563985072, "last_edit_date": 1563986878, "question_id": 57187325, "link": "https://stackoverflow.com/questions/57187325/i-want-to-split-the-string-and-should-get-specific-text-using-c", "title": "I want to split the string and should get specific text using C#", "body": "<p>I want to split the string and to get specific text(\"Kernal Ltd\") using split functionality. This is my following string,</p>\n\n<p><code>Your Quote - 12345- Kernal Ltd</code></p>\n\n<p>Tried to split the string with empty string and tried to get the string by index</p>\n\n<pre><code>var companyName = this.renewalSummaryPage.QuoteNameField.GetText().Split(\n            new string[] { \" \" }, StringSplitOptions.None);\n        Assert.AreEqual(CommonMessages.CompanyName, companyName[5]+\" \"+ companyName[6]);\n</code></pre>\n\n<p>Expected to get string of :   </p>\n\n<p><code>Kernal Ltd</code>  </p>\n\n<p>Actual:</p>\n\n<blockquote>\n  <p>index outside the bounds of the array error</p>\n</blockquote>\n"}, {"tags": ["c#", "winforms", "serial-port"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 1, "creation_date": 1563985161, "post_id": 57187303, "comment_id": 100884733, "body": "I would use a List&lt;Byte&gt; so you are easily add more data to the end and remove data from beginning."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1563985194, "post_id": 57187303, "comment_id": 100884747, "body": "Just for info: Usually circulair buffers are typically used when handling continuous signals."}, {"owner": {"reputation": 21, "user_id": 11804869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-scIrEaEQCzI/AAAAAAAAAAI/AAAAAAAAI8w/yyF10V_hSAg/photo.jpg?sz=128", "display_name": "DocSwag", "link": "https://stackoverflow.com/users/11804869/docswag"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1563985985, "post_id": 57187303, "comment_id": 100885133, "body": "@jdweng I thought of doing that, but one thing I saw seemed to say that removing stuff from the beginning of a list is pretty slow, and a linked list would be much faster for doing that since lists are based around arrays so when you add/remove items you have to copy the array to a new one"}, {"owner": {"reputation": 1190, "user_id": 11291455, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DeXw9UBXxKQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVpCjCZyaprKSzlRLY9Dy1QdNo1w/mo/photo.jpg?sz=128", "display_name": "Steve Todd", "link": "https://stackoverflow.com/users/11291455/steve-todd"}, "edited": false, "score": 1, "creation_date": 1563986261, "post_id": 57187303, "comment_id": 100885291, "body": "Why can&#39;t you just treat it as a stream, using the normal stream handling classes?"}, {"owner": {"reputation": 21, "user_id": 11804869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-scIrEaEQCzI/AAAAAAAAAAI/AAAAAAAAI8w/yyF10V_hSAg/photo.jpg?sz=128", "display_name": "DocSwag", "link": "https://stackoverflow.com/users/11804869/docswag"}, "reply_to_user": {"reputation": 1190, "user_id": 11291455, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DeXw9UBXxKQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVpCjCZyaprKSzlRLY9Dy1QdNo1w/mo/photo.jpg?sz=128", "display_name": "Steve Todd", "link": "https://stackoverflow.com/users/11291455/steve-todd"}, "edited": false, "score": 0, "creation_date": 1563986715, "post_id": 57187303, "comment_id": 100885527, "body": "@SteveTodd that&#39;s an interesting idea, but I looked into it and I think that removing items from the beginning of a stream requires copying the stream over to a new one, is that correct? I feel like that would be really slow       EDIT: Actually wait, I&#39;m not sure if I really even understand how a stream works. I saw someone give it an analogy like a hose, and if that&#39;s the case it&#39;s basically what I want. Is that correct? I&#39;m having a hard time finding information on how it works"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1563987778, "post_id": 57187303, "comment_id": 100885998, "body": "Data may not come in one chunk due to the windows driver working off of timers.  So with continuous data you may need to read only some of the data from the buffer (up to end of line or size of message) while you are getting new data that gets added to the end.  Linked list would be no different in the time."}, {"owner": {"reputation": 21, "user_id": 11804869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-scIrEaEQCzI/AAAAAAAAAAI/AAAAAAAAI8w/yyF10V_hSAg/photo.jpg?sz=128", "display_name": "DocSwag", "link": "https://stackoverflow.com/users/11804869/docswag"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1563988392, "post_id": 57187303, "comment_id": 100886286, "body": "@jdweng so what you&#39;re saying is, I&#39;m gonna end up waiting for data at some point anyways, so the time needed for the removals isn&#39;t going to matter as much, and List&lt;Byte&gt; will be easier to work with than a linked list?"}, {"owner": {"reputation": 1548, "user_id": 2009197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kzFYk.png?s=128&g=1", "display_name": "Baddack", "link": "https://stackoverflow.com/users/2009197/baddack"}, "edited": false, "score": 0, "creation_date": 1563998608, "post_id": 57187303, "comment_id": 100890716, "body": "You should use the <code>DataReceived</code> event built into the <code>SerialPort</code> class.  It fires when new data comes in.  When that happens you build a string or array of characters and check to see if you have everything you need.  Once you do, you evaluate it and clear the array/string.  I work with microcontrollers for a living and I do pretty much everything in ASCII/strings.  <code>serialPort1.ReadExisting()</code> will give you the existing ASCII characters in the buffer.  Let the class do the work for you, no need to re-invent it."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1563998657, "post_id": 57187303, "comment_id": 100890739, "body": "I do not know what a link list would do to solve the issue.  You have to frame the data and the List&lt;Byte&gt; is the easiest method to do the framing.  I do not know the speed of the input so do not know anything about the wait time.  Just the data rate has to be less than the process rate."}, {"owner": {"reputation": 21, "user_id": 11804869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-scIrEaEQCzI/AAAAAAAAAAI/AAAAAAAAI8w/yyF10V_hSAg/photo.jpg?sz=128", "display_name": "DocSwag", "link": "https://stackoverflow.com/users/11804869/docswag"}, "reply_to_user": {"reputation": 1548, "user_id": 2009197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kzFYk.png?s=128&g=1", "display_name": "Baddack", "link": "https://stackoverflow.com/users/2009197/baddack"}, "edited": false, "score": 0, "creation_date": 1564017685, "post_id": 57187303, "comment_id": 100895387, "body": "@Baddack I was going to, but then I saw <a href=\"http://www.sparxeng.com/blog/software/must-use-net-system-io-ports-serialport\" rel=\"nofollow noreferrer\">this</a> that indicates it&#39;s riddled with flaws, so I decided to be safe and use basestream"}, {"owner": {"reputation": 21, "user_id": 11804869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-scIrEaEQCzI/AAAAAAAAAAI/AAAAAAAAI8w/yyF10V_hSAg/photo.jpg?sz=128", "display_name": "DocSwag", "link": "https://stackoverflow.com/users/11804869/docswag"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1564017720, "post_id": 57187303, "comment_id": 100895393, "body": "@jdweng that&#39;s fair, I think I&#39;ll use a List then, thanks for the help!"}], "owner": {"reputation": 21, "user_id": 11804869, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-scIrEaEQCzI/AAAAAAAAAAI/AAAAAAAAI8w/yyF10V_hSAg/photo.jpg?sz=128", "display_name": "DocSwag", "link": "https://stackoverflow.com/users/11804869/docswag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563984990, "creation_date": 1563984990, "question_id": 57187303, "link": "https://stackoverflow.com/questions/57187303/managing-a-buffer-using-inputted-data-from-a-serial-port", "title": "Managing a buffer using inputted data from a serial port", "body": "<p>I'm writing an application that will read a continuous stream of data from a microcontroller via the serial port and then process the information it provides. I'm trying to read all the data via <code>SerialPort.BaseStream.ReadAsync</code> and then store that data into a global buffer so that I can the process the data being received. However, I'm not sure what data structure I should use for the buffer. I've seen some stuff about circular buffers, which seem like they could work, but they appear difficult to program. I then thought of using a linked list: I think that it might be able to work, since I could keep adding new data to the end of the list, and have a function that processes the data continually check for data in the buffer and read the data from the front and then delete it. However, I would probably have to keep the size of it in check by deleting data from the front if it gets too large due to me processing it too slow for some reason, right? Also, is there any issue with having to remove items from memory when I remove the first items? I guess, in a way I'm just trying to make a circular buffer from a linked list, and I'm not sure if that's a good way to tackle this. If you guys have any suggestions I would appreciate it!</p>\n"}, {"tags": ["c#", "asp.net", "ajax", "asp.net-mvc"], "comments": [{"owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "edited": false, "score": 0, "creation_date": 1563990097, "post_id": 57187279, "comment_id": 100887062, "body": "Have you tried specifying <code>[Route(&quot;&#47;company&#47;delete&quot;)]</code>? (notice the leading slash)"}, {"owner": {"reputation": 616, "user_id": 9629238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGSvY.jpg?s=128&g=1", "display_name": "Mateus Wolkmer", "link": "https://stackoverflow.com/users/9629238/mateus-wolkmer"}, "reply_to_user": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "edited": false, "score": 0, "creation_date": 1563990942, "post_id": 57187279, "comment_id": 100887442, "body": "@Alexander Just tried it, still receiving error 400 returns, same thing."}, {"owner": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1564004013, "post_id": 57187279, "comment_id": 100892649, "body": "You may need to add verb for DELETE.  Not sure if that&#39;s there by default.  Are you sure you want to use DELETE instead of get or post?  Is company a file?"}, {"owner": {"reputation": 616, "user_id": 9629238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGSvY.jpg?s=128&g=1", "display_name": "Mateus Wolkmer", "link": "https://stackoverflow.com/users/9629238/mateus-wolkmer"}, "reply_to_user": {"reputation": 855, "user_id": 4744568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/125cdb7d43927756913b920de016f420?s=128&d=identicon&r=PG", "display_name": "pcalkins", "link": "https://stackoverflow.com/users/4744568/pcalkins"}, "edited": false, "score": 0, "creation_date": 1564010094, "post_id": 57187279, "comment_id": 100894113, "body": "@pcalkins It is not just the DELETE method that doesn&#39;t work, I&#39;ve tried with POST and GET."}, {"owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "edited": false, "score": 0, "creation_date": 1564060936, "post_id": 57187279, "comment_id": 100913466, "body": "Please post your controller class code as well"}, {"owner": {"reputation": 616, "user_id": 9629238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGSvY.jpg?s=128&g=1", "display_name": "Mateus Wolkmer", "link": "https://stackoverflow.com/users/9629238/mateus-wolkmer"}, "reply_to_user": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "edited": false, "score": 0, "creation_date": 1564139626, "post_id": 57187279, "comment_id": 100942020, "body": "@Alexander Updated the question with more code."}], "answers": [{"comments": [{"owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "edited": false, "score": 0, "creation_date": 1563989693, "post_id": 57187419, "comment_id": 100886876, "body": "What does it change?"}], "tags": [], "owner": {"reputation": 153, "user_id": 9046933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNoGB.jpg?s=128&g=1", "display_name": "Sandy Rizky", "link": "https://stackoverflow.com/users/9046933/sandy-rizky"}, "is_accepted": false, "score": -1, "last_activity_date": 1563985390, "creation_date": 1563985390, "answer_id": 57187419, "question_id": 57187279, "link": "https://stackoverflow.com/questions/57187279/400-bad-request-when-trying-ajax-call-to-controller-in-asp-net-mvc/57187419#57187419", "title": "400 Bad Request when trying Ajax call to Controller in ASP.NET MVC", "body": "<p>Change your controller function return type to ActionResult instead of JsonResult</p>\n\n<pre><code>[HttpDelete]\n[Route(\"company/delete\")]\npublic ActionResult DeleteCompany()\n{\n    return Json(\"ok\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 616, "user_id": 9629238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGSvY.jpg?s=128&g=1", "display_name": "Mateus Wolkmer", "link": "https://stackoverflow.com/users/9629238/mateus-wolkmer"}, "is_accepted": true, "score": 0, "last_activity_date": 1565963359, "creation_date": 1565963359, "answer_id": 57525826, "question_id": 57187279, "link": "https://stackoverflow.com/questions/57187279/400-bad-request-when-trying-ajax-call-to-controller-in-asp-net-mvc/57525826#57525826", "title": "400 Bad Request when trying Ajax call to Controller in ASP.NET MVC", "body": "<p>It turns out it was bad IIS configuration. Adding a rule to accept every type of request worked. </p>\n\n<p>This is the handler in <code>web.config</code>:</p>\n\n<pre><code>&lt;add name=\"aspNetCore\" path=\"*\" verb=\"GET,HEAD,POST,DEBUG,DELETE,PUT\" modules=\"AspNetCoreModuleV2\" resourceType=\"Unspecified\" requireAccess=\"None\" /&gt;\n</code></pre>\n"}], "owner": {"reputation": 616, "user_id": 9629238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hGSvY.jpg?s=128&g=1", "display_name": "Mateus Wolkmer", "link": "https://stackoverflow.com/users/9629238/mateus-wolkmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 57525826, "answer_count": 2, "score": 0, "last_activity_date": 1565963359, "creation_date": 1563984902, "last_edit_date": 1564140260, "question_id": 57187279, "link": "https://stackoverflow.com/questions/57187279/400-bad-request-when-trying-ajax-call-to-controller-in-asp-net-mvc", "title": "400 Bad Request when trying Ajax call to Controller in ASP.NET MVC", "body": "<p>So I've been struggling to do a simple request from a CSHTML page to a Controller in my ASP.NET MVC website application. I'm using Ajax to try a DELETE call:</p>\n\n<pre><code>$.ajax({\n    url: \"/company/delete\",\n    type: \"DELETE\",\n    success: function (e) {\n        showAlert('Success!');\n    }\n});\n</code></pre>\n\n<p>And just returning a JSON on the controller side:</p>\n\n<pre><code>public class CompanyController : BaseController\n{\n    protected readonly IHttpClientFactory _clientFactory;\n\n    public CompanyController(IHttpClientFactory clientFactory)\n    {\n        _clientFactory = clientFactory;\n    }\n\n    [HttpDelete]\n    [Route(\"company/delete\")]\n    public JsonResult DeleteCompany()\n    {\n        return Json(\"ok\");\n    }\n}\n</code></pre>\n\n<p><code>BaseController.cs</code>:</p>\n\n<pre><code>[Authorize(Policy = \"IsLoggedIn\")]\npublic class BaseController : Controller\n{ }\n</code></pre>\n\n<p>Every other implementation I saw was something like this. I've tried using <code>@Url.Action(\"DeleteCompany\", \"Company\")</code> as Ajax URL, removing route and requesting to <code>/Company/DeleteSite</code>, adding <code>[AllowAnonymous]</code> tag as I'm using authentication, nothing works. It will always return a <em>400 Bad Request</em> error (at least it is not <em>404</em>).</p>\n\n<p>I didn't start the project, so I don't know if there is any other configurations to set and access the Controller from the View. Note that I can access my API from the Ajax and access the API from the Controller, but I'm not being successful with accessing the Controller from the View with Ajax.</p>\n"}, {"tags": ["c#", ".net", "wcf", "visual-studio-2017"], "answers": [{"tags": [], "owner": {"reputation": 6039, "user_id": 10163251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fwrh.jpg?s=128&g=1", "display_name": "Abraham Qian", "link": "https://stackoverflow.com/users/10163251/abraham-qian"}, "is_accepted": false, "score": 0, "last_activity_date": 1564031854, "creation_date": 1564031854, "answer_id": 57194787, "question_id": 57187266, "link": "https://stackoverflow.com/questions/57187266/wcf-does-not-generate-partial-classes-on-the-client-side-of-the-project/57194787#57194787", "title": "WCF does not generate partial classes on the client side of the project", "body": "<p>From the structure of the generated client proxy class, The TestMethod do not reference the Datacontract class. So it is reasonable that the auto-generated the proxy does not contain data contract. We could add the Data Contract class to the parameter of the TestMethod, and then verify the result.<br>\nDataContract example.<br>\n<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/using-data-contracts\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/using-data-contracts</a><br>\nFeel free to let me know if there is anything I can help with.</p>\n"}], "owner": {"reputation": 1, "user_id": 11827071, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3kkmvyvnlsI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1erubCmxtcKH2zC8YGF4F4xGPFw/photo.jpg?sz=128", "display_name": "Ari100krat", "link": "https://stackoverflow.com/users/11827071/ari100krat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1564031854, "creation_date": 1563984840, "question_id": 57187266, "link": "https://stackoverflow.com/questions/57187266/wcf-does-not-generate-partial-classes-on-the-client-side-of-the-project", "title": "WCF does not generate partial classes on the client side of the project", "body": "<p>There is such a class:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[DataContract]\n    public sealed partial class Worker : IKeyedModel\n    {\n        [DataMember]\n        public int Id { get =&gt; this.id; set =&gt; this.id = value; }\n\n        [DataMember]\n        public string Test { get; set; }\n\n        [DataMember]\n        public string FirstName { get =&gt; this.firstName; set =&gt; this.firstName = value; }\n\n        [DataMember]\n        public string LastName { get =&gt; this.lastName; set =&gt; this.lastName = value; }\n\n        [DataMember]\n        public DateTime DateOfBirth { get =&gt; this.dateOfBirth; set =&gt; this.dateOfBirth = value; }\n</code></pre>\n\n<p>Wcf is also available for server and client communication. I connect the service in my project and I want to use this partial class in the client code, but the link to the service does not generate this class.\nA year ago, I did everything exactly the same, but it worked.\nI would be grateful for any help.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>namespace TestManagerClient.WcfReference {\n\n\n    [System.CodeDom.Compiler.GeneratedCodeAttribute(\"System.ServiceModel\", \"4.0.0.0\")]\n    [System.ServiceModel.ServiceContractAttribute(ConfigurationName=\"WcfReference.IService\")]\n    public interface IService {\n\n        [System.ServiceModel.OperationContractAttribute(Action=\"http://tempuri.org/IService/TestMethod\", ReplyAction=\"http://tempuri.org/IService/TestMethodResponse\")]\n        void TestMethod();\n\n        [System.ServiceModel.OperationContractAttribute(Action=\"http://tempuri.org/IService/TestMethod\", ReplyAction=\"http://tempuri.org/IService/TestMethodResponse\")]\n        System.Threading.Tasks.Task TestMethodAsync();\n    }\n\n    [System.CodeDom.Compiler.GeneratedCodeAttribute(\"System.ServiceModel\", \"4.0.0.0\")]\n    public interface IServiceChannel : TestManagerClient.WcfReference.IService, System.ServiceModel.IClientChannel {\n    }\n\n    [System.Diagnostics.DebuggerStepThroughAttribute()]\n    [System.CodeDom.Compiler.GeneratedCodeAttribute(\"System.ServiceModel\", \"4.0.0.0\")]\n    public partial class ServiceClient : System.ServiceModel.ClientBase&lt;TestManagerClient.WcfReference.IService&gt;, TestManagerClient.WcfReference.IService {\n\n        public ServiceClient() {\n        }\n\n        public ServiceClient(string endpointConfigurationName) : \n                base(endpointConfigurationName) {\n        }\n\n        public ServiceClient(string endpointConfigurationName, string remoteAddress) : \n                base(endpointConfigurationName, remoteAddress) {\n        }\n\n        public ServiceClient(string endpointConfigurationName, System.ServiceModel.EndpointAddress remoteAddress) : \n                base(endpointConfigurationName, remoteAddress) {\n        }\n\n        public ServiceClient(System.ServiceModel.Channels.Binding binding, System.ServiceModel.EndpointAddress remoteAddress) : \n                base(binding, remoteAddress) {\n        }\n\n        public void TestMethod() {\n            base.Channel.TestMethod();\n        }\n\n        public System.Threading.Tasks.Task TestMethodAsync() {\n            return base.Channel.TestMethodAsync();\n        }\n    }\n}\n</code></pre>\n"}]