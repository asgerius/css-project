[{"tags": ["c#", ".net", "service", "timer", "windows-services"], "comments": [{"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1446076701, "post_id": 33403647, "comment_id": 54598801, "body": "Set off another timer with an interval of a few seconds to do the data migration."}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1446076879, "post_id": 33403647, "comment_id": 54598860, "body": "Why not use a background thread for the data migration?"}], "answers": [{"tags": [], "owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "is_accepted": true, "score": 1, "last_activity_date": 1446077205, "creation_date": 1446077205, "answer_id": 33403759, "question_id": 33403647, "link": "https://stackoverflow.com/questions/33403647/windows-service-not-starting-in-a-timely-manner-pass-off-initial-workload-to-t/33403759#33403759", "title": "Windows Service not starting in a timely manner - pass off initial workload to timer?", "body": "<p>The problem is that the <code>OnStart</code> method needs to complete in a fairly short time (30 seconds perhaps?) before Windows assumes something has gone wrong. A simple solution would be to fire the timer very quickly on it's first run, the reconfigure the timer from inside the event to run again in 4 hours:</p>\n\n<pre><code>protected override void OnStart(string[] args)\n{\n    // Set up timer\n    int initialIntervalSync = 10; // 10 seconds\n    timer = new System.Timers.Timer();\n    timer.Interval = initialIntervalSync * 1000;\n    timer.Elapsed += new System.Timers.ElapsedEventHandler(this.OnTimer);\n    timer.Start();    \n}\n\npublic void OnTimer(object sender, System.Timers.ElapsedEventArgs args)\n{\n    //Reset timer interval\n    int intervalSync = 14400; // 4 hours default\n    timer.Interval = intervalSync * 1000;\n\n    this.DoMigration();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": false, "score": 1, "last_activity_date": 1446077796, "creation_date": 1446077796, "answer_id": 33403863, "question_id": 33403647, "link": "https://stackoverflow.com/questions/33403647/windows-service-not-starting-in-a-timely-manner-pass-off-initial-workload-to-t/33403863#33403863", "title": "Windows Service not starting in a timely manner - pass off initial workload to timer?", "body": "<p>IMHO, the easiest way to address this is to use <code>async</code>/<code>await</code>:</p>\n\n<pre><code>protected override void OnStart(string[] args)\n{\n    // Storing the returned Task in a variable is a hack\n    // to suppresses the usual compiler warning.\n    var _ = DoMigrationLoop();\n}\n\nprivate async Task DoMigrationLoop()\n{\n    while (true)\n    {\n        await Task.Run(() =&gt; this.DoMigration());\n        await Task.Delay(TimeSpan.FromHours(4));\n    }\n}\n</code></pre>\n\n<p>This causes the <code>DoMigration()</code> method to be executed in a separate thread immediately, and then every four hours thereafter. Note that since the original <code>DoMigrationLoop()</code> method call returns immediately at the first <code>await</code> call, the <code>OnStart()</code> method is itself not delayed at all.</p>\n\n<p>Feel free to add task cancellation, exception handling, and other niceties as desired. :)</p>\n"}], "owner": {"reputation": 1016, "user_id": 289430, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/re2Wg.png?s=128&g=1", "display_name": "Manachi", "link": "https://stackoverflow.com/users/289430/manachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 33403759, "answer_count": 2, "score": 0, "last_activity_date": 1446077796, "creation_date": 1446076603, "question_id": 33403647, "link": "https://stackoverflow.com/questions/33403647/windows-service-not-starting-in-a-timely-manner-pass-off-initial-workload-to-t", "title": "Windows Service not starting in a timely manner - pass off initial workload to timer?", "body": "<p>I'm running a Windows Service which does a large data migration process (will take 10 minutes+ on first run through). Currently I have the service running once initially on startup, and then every 4 hours thereafter. Something like this (excerpt):</p>\n\n<pre><code>protected override void OnStart(string[] args)\n{\n    // Set up timer\n    int intervalSync = 14400; // 4 hours default\n    timer = new System.Timers.Timer();\n    timer.Interval = intervalSync * 1000;\n    timer.Elapsed += new System.Timers.ElapsedEventHandler(this.OnTimer);\n    timer.Start();\n\n    // Call once initially.\n    this.DoMigration();\n}\n\npublic void OnTimer(object sender, System.Timers.ElapsedEventArgs args)\n{\n    this.DoMigration();\n}\n</code></pre>\n\n<p>The problem is after deploying and running, the Windows Service errors with \"The service did not respond to the start or control request in a timely fashion\".</p>\n\n<p>I realise I could just remove the initial call of DoMigration() from OnStart, and let the service start up quickly - but then the work would not be done for 4 hours which is not desirable.</p>\n\n<p>Is there a way I can set a different time interval for the first timer to run (perhaps 30 seconds or 60 seconds), and then the separate 4 hour periodic interval after that? Basically I want to push the workload out of OnStart to prevent the error, but I want to still have it run as soon as possible after starting.</p>\n\n<p>Is this possible? And is it the best approach? Any advice would be appreciated.</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1446076634, "post_id": 33403572, "comment_id": 54598783, "body": "I guess you have a typo: <code>)&quot;RegexOptions.Multiline)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1446130136, "post_id": 33403591, "comment_id": 54624465, "body": "Glad it worked for you. Please also consider upvoting if my answer proved helpful to you\u044e"}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 0, "last_activity_date": 1446076688, "last_edit_date": 1446076688, "creation_date": 1446076259, "answer_id": 33403591, "question_id": 33403572, "link": "https://stackoverflow.com/questions/33403572/splitting-text-containing-word/33403591#33403591", "title": "Splitting text containing word", "body": "<p>In C#, you need to use verbatim string literals to declare regexps, or you may run into trouble, like here, where you have <code>\\b</code> as a backspace and not a word boundary.</p>\n\n<p>Use</p>\n\n<pre><code>@\"(?=^.+?\\bINT[.]|^.+?\\bEXT[.]|^.+?\\bI/E[.])\"\n^                ^            ^            ^\n</code></pre>\n\n<p>or contracted a bit:</p>\n\n<pre><code>@\"(?=^.+?\\b(?:INT|EXT|I/E)[.])\"\n</code></pre>\n\n<p>Note that I removed <code>\\b</code> word boundaries after the literal period because those word boundaries required a word character after the period. I think you do not need that.</p>\n"}], "owner": {"reputation": 521, "user_id": 3050582, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/ef917be8e3533c2518b91824d72379e0?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/3050582/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 33403591, "answer_count": 1, "score": 1, "last_activity_date": 1446076688, "creation_date": 1446076135, "question_id": 33403572, "link": "https://stackoverflow.com/questions/33403572/splitting-text-containing-word", "title": "Splitting text containing word", "body": "<p>I'm trying to split a text in paragraphs. The split should happen each at the beginning of each line containing following words INT. | EXT. |I/E.</p>\n\n<p>This is the expression I use:</p>\n\n<pre><code>string[] res = Regex.Split(text, \"(?=^.+?INT[.]|^.+?EXT[.]|^.+?I/E[.])\"RegexOptions.Multiline);\n</code></pre>\n\n<p>It works fairly well but it also makes a new paragraph when a the line contains words such as PRINT. or TEXT.</p>\n\n<p>How can I modify the REGEX expression so it fits the exact words  INT. EXT. I/E. ? I tried </p>\n\n<pre><code>\"(?=^.+?\\bINT[.]\\b|^.+?\\bEXT[.]\\b|^.+?\\bI/E[.]\\b)\"\n</code></pre>\n\n<p>but that doesn't work. Any ideas how I can make an exact word match?</p>\n"}, {"tags": ["c#", "linq", "collections", "dataset", "large-files"], "comments": [{"owner": {"reputation": 185, "user_id": 4063329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ac8c6ff0a4988f51ce5f489ca239274?s=128&d=identicon&r=PG&f=1", "display_name": "danieljaguiar", "link": "https://stackoverflow.com/users/4063329/danieljaguiar"}, "edited": false, "score": 1, "creation_date": 1446075482, "post_id": 33403452, "comment_id": 54598402, "body": "I am afraid someone will tell me to use SQL Server... just saying."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 1, "creation_date": 1446076015, "post_id": 33403452, "comment_id": 54598587, "body": "This will take forever.. use something more robust to store the data, for example store it into <code>Oracle DB, || Sql Server</code>"}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1446076585, "post_id": 33403452, "comment_id": 54598768, "body": "Do you really need to load it all into memory at once? What is your use case here? I&#39;m afraid the question is too broad as it currently stands."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446077712, "post_id": 33403452, "comment_id": 54599121, "body": "<code>Eventually, when my customer needs to open his 10GB file it will be impossible, because it is going to take 12GB+ of Memory.</code>  No, that&#39;s <a href=\"http://blogs.msdn.com/b/ericlippert/archive/2009/06/08/out-of-memory-does-not-refer-to-physical-memory.aspx\" rel=\"nofollow noreferrer\">just not true</a>.  (Although it&#39;s a very bad idea to try to load that much data into memory, even though it&#39;s possible.  Oh, and of course there are systems that just will actually have 12+GB of RAM, but that&#39;s also not really the point here.)"}, {"owner": {"reputation": 185, "user_id": 4063329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ac8c6ff0a4988f51ce5f489ca239274?s=128&d=identicon&r=PG&f=1", "display_name": "danieljaguiar", "link": "https://stackoverflow.com/users/4063329/danieljaguiar"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446079341, "post_id": 33403452, "comment_id": 54599603, "body": "@MethodMan, I was afraid of that :) ."}, {"owner": {"reputation": 185, "user_id": 4063329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ac8c6ff0a4988f51ce5f489ca239274?s=128&d=identicon&r=PG&f=1", "display_name": "danieljaguiar", "link": "https://stackoverflow.com/users/4063329/danieljaguiar"}, "reply_to_user": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1446079509, "post_id": 33403452, "comment_id": 54599663, "body": "@DavidG This App will do automatic analysis of log files of one specific server product. I thought on get 1000 lines and dispose it, then get next 1000 thousand and dispose it. The problem with that is that for every other analysis, I need to read the file and work again in batches. Better to have everything in memory, or in a SQL Server. But if I want everything in memory which type/collection/list/dataset performs better?"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446112022, "post_id": 33403452, "comment_id": 54611740, "body": "If you want everything memory - array of structs. But I think you should consider some sort of a tiny <code>IEnumerable&lt;T&gt;</code> wrapper around memory mapped file."}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 1757521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1073b7a72812d5b26c5b3d853b4ead2c?s=128&d=identicon&r=PG", "display_name": "Dano", "link": "https://stackoverflow.com/users/1757521/dano"}, "is_accepted": false, "score": 0, "last_activity_date": 1446080218, "last_edit_date": 1446080218, "creation_date": 1446079912, "answer_id": 33404179, "question_id": 33403452, "link": "https://stackoverflow.com/questions/33403452/c-best-type-collection-list-dataset-to-handle-super-large-data-csv-tab-files/33404179#33404179", "title": "c# Best type/collection/list/dataset to handle super large data (csv/tab files)", "body": "<p>When i've had to do something like this before I handled it by having a container object that held a list of dictionaries.  At the time I thought the limit would/should be 2^32 number of elements, but an exception for exceeding the collection was thrown  well before getting 2^32 elements and still had many GB of ram left.   Say you want a Dictionary, something like this should work until you really do exhaust all physical and virtual memory...  A possible solution for you follows...  I remember when I worked on this a few years ago the server actually had 512Gb of ram, I'm sure they have ones with more now...  Anyway that's a separate story.</p>\n\n<pre><code>   public class MyHugeDictionary  \n   {  \n        List&lt;Dictionary&lt;typea, typeb&gt; allDict= null;  \n        Dictionary&lt;typea, typeb&gt; currDictionary ;  \n\n        MyHugeDictiionary()  \n        {  \n            allDict = new List&lt;Dictionary&lt;typea, typeb&gt;();  \n            currDictionary = new Dictionary&lt;typea, typeb);  \n            allDict.Add(currDictionary);  \n        }  \n\n        public bool ItemExists( typea, typeb)  \n        {  \n            foreach( KeyValue&lt;Dictionary&lt;typea, typeb&gt; kv in allDict)  \n            {  \n                if( kv.ContainsKey(typea) )  \n                {  \n                    return true;  \n                }  \n            }  \n            return false;  \n        }  \n\n        public Add( typea a, typeb b)  \n        {  \n            try  \n            {  \n                if( !ItemExist( tyepa, typeb) )  // find if items is in any other dictionary first  \n                {  \n                    currDictionary.Add( a, b) ;  \n                }  \n                else  { // handle dups... ; }  \n            }  \n            catch( CollectionSizeError x)   // look-up for actual exception\n            {  \n                currDictionary = CreateDictiionary();  \n                allDict.Add( currDictionary ) ;  \n                currDictionary.Add( a,b);  \n            }  \n            catch( OutOfMemory y)     // look-up for actual exception\n            {  \n                // oops game over for real now :(  \n            }  \n         }  \n    }  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 185, "user_id": 4063329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ac8c6ff0a4988f51ce5f489ca239274?s=128&d=identicon&r=PG&f=1", "display_name": "danieljaguiar", "link": "https://stackoverflow.com/users/4063329/danieljaguiar"}, "is_accepted": true, "score": 0, "last_activity_date": 1446151798, "creation_date": 1446151798, "answer_id": 33424343, "question_id": 33403452, "link": "https://stackoverflow.com/questions/33403452/c-best-type-collection-list-dataset-to-handle-super-large-data-csv-tab-files/33424343#33424343", "title": "c# Best type/collection/list/dataset to handle super large data (csv/tab files)", "body": "<p>After some discussion the best thing is to read the file, process it, and dispose all the rest, sticking only with the result.</p>\n\n<p>Another possibility was to use database, but it would add too much complexity, although it is possible.</p>\n"}, {"tags": [], "owner": {"reputation": 586, "user_id": 1932601, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Rycr.png?s=128&g=1", "display_name": "itadapter DKh", "link": "https://stackoverflow.com/users/1932601/itadapter-dkh"}, "is_accepted": false, "score": -1, "last_activity_date": 1500159794, "last_edit_date": 1500159794, "creation_date": 1500158890, "answer_id": 45123418, "question_id": 33403452, "link": "https://stackoverflow.com/questions/33403452/c-best-type-collection-list-dataset-to-handle-super-large-data-csv-tab-files/45123418#45123418", "title": "c# Best type/collection/list/dataset to handle super large data (csv/tab files)", "body": "<p>See this:</p>\n\n<p><a href=\"https://github.com/aumcode/nfx/tree/master/Source/NFX/ApplicationModel/Pile\" rel=\"nofollow noreferrer\">https://github.com/aumcode/nfx/tree/master/Source/NFX/ApplicationModel/Pile</a>\n<a href=\"https://www.infoq.com/articles/Big-Memory-Part-3\" rel=\"nofollow noreferrer\">https://www.infoq.com/articles/Big-Memory-Part-3</a></p>\n\n<p>You can store whatever you want - no pauses.\nThe problem with large collections is:\na. They are not really designed to hold very many entries (i.e. Dictionary never shrinks back to zero size)\nb. You get GC stalls/pauses when you have too many objects</p>\n\n<p>see the links above - what we did is \"hiding\" of data from GC as described in the article. This way you can store millions of objects using LocalCache class as a dictionary.</p>\n\n<p>For large memory apps in net - remember to enable 64 bit and set GC to SERVER mode in your app config file</p>\n"}], "owner": {"reputation": 185, "user_id": 4063329, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ac8c6ff0a4988f51ce5f489ca239274?s=128&d=identicon&r=PG&f=1", "display_name": "danieljaguiar", "link": "https://stackoverflow.com/users/4063329/danieljaguiar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1541, "favorite_count": 0, "accepted_answer_id": 33424343, "answer_count": 3, "score": -2, "last_activity_date": 1500159794, "creation_date": 1446075460, "question_id": 33403452, "link": "https://stackoverflow.com/questions/33403452/c-best-type-collection-list-dataset-to-handle-super-large-data-csv-tab-files", "title": "c# Best type/collection/list/dataset to handle super large data (csv/tab files)", "body": "<p>I am building one WPF (MVVM) app that handles really large csv files. We are talking about 1GB to 10GB.</p>\n\n<p>I open the file and parse it with File.ReadLines into a List of following class:</p>\n\n<pre><code>public class FileLine\n{\n    public DateTime Time { get; set; } \n    public string Message { get; set; } //Usually around 256 characters\n    public string Info1 { get; set; } //Exact 56 characters\n    public string Info2 { get; set; } //Exact 4 characters\n    //and so on\n}\n</code></pre>\n\n<p>... then I do all sort of data manipulation, queries, charts... you name it... everything using Linq.</p>\n\n<p>We are testing a 1.8GB file and when it is opened, the process takes around 2GB of memory.</p>\n\n<p>Eventually, when my customer needs to open his 10GB file it will be impossible, because it is going to take 12GB+ of Memory.\nWhat is the best type/collection/list/dataset to this kind of work?</p>\n"}, {"tags": ["c#", "android", "xamarin", "nfc", "iso-15693"], "comments": [{"owner": {"reputation": 700, "user_id": 3154630, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e334n.png?s=128&g=1", "display_name": "Leze", "link": "https://stackoverflow.com/users/3154630/leze"}, "edited": false, "score": 0, "creation_date": 1446139366, "post_id": 33403302, "comment_id": 54631025, "body": "After some search i see here <a href=\"https://code.google.com/p/nfcutils/source/browse/org/android/nfc/tech/ReadNfcV.java?r=71e8373bc57e64a1fc961b7990fe00fcf138ba8d\" rel=\"nofollow noreferrer\">nfcapp</a> On line 370 in readSingleBlock and on line 395 in readMultipleBlocks that he avoid reading the first byte. Is it normal?"}], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 3154630, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e334n.png?s=128&g=1", "display_name": "Leze", "link": "https://stackoverflow.com/users/3154630/leze"}, "edited": false, "score": 0, "creation_date": 1447055416, "post_id": 33581478, "comment_id": 54983775, "body": "Thanks a lot for your answer Michael. I looked for a while to get a Doc for the nfc-v protocol to check if this byte is normal, i still have not found it. So you answer is more than apreciate for me. And your illustration is more than explicit."}], "tags": [], "owner": {"reputation": 36212, "user_id": 2425802, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RKefk.png?s=128&g=1", "display_name": "Michael Roland", "link": "https://stackoverflow.com/users/2425802/michael-roland"}, "is_accepted": true, "score": 4, "last_activity_date": 1446890817, "creation_date": 1446890817, "answer_id": 33581478, "question_id": 33403302, "link": "https://stackoverflow.com/questions/33403302/android-nfcv-read-tag-always-prepend-0x00/33581478#33581478", "title": "Android NfcV read tag always prepend 0x00", "body": "<p>What you see is the flags byte. This byte is part of every NFC-V response frame and provides information about the command status. If this byte is 0x00 (or possibly 0x80), then the command was executed successfully and the remaining bytes contain the response parameters/data for your command (in your case one block starting at block zero requested by the READ MULTIPLE BLOCKS command).</p>\n\n<p>If bit 0 of the flags byte is set, this indicates an execution error, the second byte will encode error information as defined in the ISO/IEC 15693-3 standard.</p>\n\n<p>Thus a typical NFC-V command frame (when exchanged using <code>NfcV.transceive()</code>) looks like this:</p>\n\n<pre><code>+-------+--------------+--------------------------------+-------------------------+\n| FLAGS | COMMAND CODE | [ADDRESS, if Addressed_flag=1] | COMMAND PARAMETERS/DATA |\n+-------+--------------+--------------------------------+-------------------------+\n</code></pre>\n\n<p>and the response frame looks like this:</p>\n\n<pre><code>+-------+--------------------------+\n| FLAGS | RESPONSE PARAMETERS/DATA |\n+-------+--------------------------+\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 3154630, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e334n.png?s=128&g=1", "display_name": "Leze", "link": "https://stackoverflow.com/users/3154630/leze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 680, "favorite_count": 1, "accepted_answer_id": 33581478, "answer_count": 1, "score": 4, "last_activity_date": 1446890817, "creation_date": 1446074485, "last_edit_date": 1446890256, "question_id": 33403302, "link": "https://stackoverflow.com/questions/33403302/android-nfcv-read-tag-always-prepend-0x00", "title": "Android NfcV read tag always prepend 0x00", "body": "<p>I got a problem with NFC-V tag reading. The tag type is Tag-it HF-I Plus (TMS37112). Here is the code I use to read data:</p>\n\n<pre><code>private void GetTagInfo(Tag tag){\n        String[] techList = tag.GetTechList();\n        for (int i = 0; i &lt; techList.Length; i++) {\n            if(techList[i].Contains(\"NfcV\")){\n                NfcV nfcv = NfcV.Get (tag);\n                nfcv.Connect ();\n\n                var response = nfcv.Transceive(new byte[] {\n                    (byte)0x00,\n                    (byte)0x23,\n                    (byte)0x00,\n                    (byte)0x01 });\n            }\n        }\n    }\n</code></pre>\n\n<p>Writing in c# but not the purpose here (working on Xamarin).</p>\n\n<p>Regardless of what I use as the first block number, I got an 0x00 before my data. Is this normal?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 2514, "user_id": 2527942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/0xl3B.jpg?s=128&g=1", "display_name": "Erdinc Ay", "link": "https://stackoverflow.com/users/2527942/erdinc-ay"}, "edited": false, "score": 0, "creation_date": 1446074586, "post_id": 33403297, "comment_id": 54598114, "body": "which programming language are you using? or do you want a generic answer?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 2514, "user_id": 2527942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/0xl3B.jpg?s=128&g=1", "display_name": "Erdinc Ay", "link": "https://stackoverflow.com/users/2527942/erdinc-ay"}, "edited": false, "score": 1, "creation_date": 1446074695, "post_id": 33403297, "comment_id": 54598161, "body": "@ErdincAy It&#39;s in the tags."}], "answers": [{"tags": [], "owner": {"reputation": 269390, "user_id": 98713, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f4acdb91aba11ddf8f03d4b12453f3d5?s=128&d=identicon&r=PG", "display_name": "Thomas Levesque", "link": "https://stackoverflow.com/users/98713/thomas-levesque"}, "is_accepted": true, "score": 2, "last_activity_date": 1446074598, "creation_date": 1446074598, "answer_id": 33403327, "question_id": 33403297, "link": "https://stackoverflow.com/questions/33403297/definition-of-a-private-access-modifier/33403327#33403327", "title": "Definition of a private access modifier", "body": "<blockquote>\n  <p>Maybe you could say that this nested class is actually a private member of the class nesting it and therefore can't be seen outside of the nesting class.</p>\n</blockquote>\n\n<p>That's exactly what it means.</p>\n"}], "owner": {"reputation": 6591, "user_id": 2063755, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/18btC.jpg?s=128&g=1", "display_name": "David Klempfner", "link": "https://stackoverflow.com/users/2063755/david-klempfner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1446075780, "accepted_answer_id": 33403327, "answer_count": 1, "score": -3, "last_activity_date": 1446074840, "creation_date": 1446074445, "last_edit_date": 1446074840, "question_id": 33403297, "link": "https://stackoverflow.com/questions/33403297/definition-of-a-private-access-modifier", "closed_reason": "Duplicate", "title": "Definition of a private access modifier", "body": "<p>Is this definition for a private access modifier accurate?:</p>\n\n<p><em>private: Any thing declared as private can\u2019t be seen outside of its class.</em> </p>\n\n<p>What about a private nested class?</p>\n\n<p>This class can be seen \"outside of its own class\" by the class that is nesting it.</p>\n\n<p>Maybe you could say that this nested class is actually a private member of the class nesting it and therefore can't be seen outside of the nesting class which would make the definition provided above true.</p>\n\n<p>If a private nested class is NOT considered a member of the nesting class then I think the definition provided above is not accurate.</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 5261, "user_id": 858757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMQgQ.png?s=128&g=1", "display_name": "Silvermind", "link": "https://stackoverflow.com/users/858757/silvermind"}, "edited": false, "score": 1, "creation_date": 1446074412, "post_id": 33403234, "comment_id": 54598053, "body": "Binding applies to the <code>DataContext</code> (models, etc...), where as <code>TemplateBinding</code> applies to the templated control (the button). You should use <code>{TemplateBinding Caption}</code>."}, {"owner": {"reputation": 273, "user_id": 2903089, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4f927c4c6f54181f4babf15aae34214?s=128&d=identicon&r=PG&f=1", "display_name": "user2903089", "link": "https://stackoverflow.com/users/2903089/user2903089"}, "reply_to_user": {"reputation": 5261, "user_id": 858757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMQgQ.png?s=128&g=1", "display_name": "Silvermind", "link": "https://stackoverflow.com/users/858757/silvermind"}, "edited": false, "score": 0, "creation_date": 1446082798, "post_id": 33403234, "comment_id": 54600550, "body": "If I change to TemplateBinding it has no idea what I am on about as it cannot find the members for Caption, HintText.  Also it cannot find thst statc members for the DependencyProperty on Button."}, {"owner": {"reputation": 273, "user_id": 2903089, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4f927c4c6f54181f4babf15aae34214?s=128&d=identicon&r=PG&f=1", "display_name": "user2903089", "link": "https://stackoverflow.com/users/2903089/user2903089"}, "reply_to_user": {"reputation": 5261, "user_id": 858757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMQgQ.png?s=128&g=1", "display_name": "Silvermind", "link": "https://stackoverflow.com/users/858757/silvermind"}, "edited": false, "score": 0, "creation_date": 1446082857, "post_id": 33403234, "comment_id": 54600567, "body": "I was just rying INotifyPropertyChanged but that does not work either, so frustrated now.  I assume taht because coming from the style?"}], "answers": [{"tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": false, "score": 2, "last_activity_date": 1446077455, "creation_date": 1446077455, "answer_id": 33403809, "question_id": 33403234, "link": "https://stackoverflow.com/questions/33403234/binding-misunderstanding-not-getting-properties-set/33403809#33403809", "title": "Binding misunderstanding not getting properties set", "body": "<p>Without <a href=\"https://stackoverflow.com/help/mcve\">a good, <em>minimal</em>, <em>complete</em> code example</a>, it can be difficult or impossible to know for sure what the problem is, never mind test a solution. But looking over your code, the most obvious thing I notice wrong with it is that you are declaring your dependency properties incorrectly.</p>\n\n<p>The owner of the dependency property is the type in which the property will be declared, not the type which you expect to use as the target for a binding.</p>\n\n<p>So your code should look like this instead:</p>\n\n<pre><code>    public static readonly DependencyProperty CaptionProperty =\n    DependencyProperty.Register(\"Caption\",\n                                typeof(string),\n                                typeof(BSHintButton)\n                                );\n    public static readonly DependencyProperty HintTextProperty =\n    DependencyProperty.Register(\"HintText\",\n                                typeof(string),\n                                typeof(BSHintButton)\n                                );\n</code></pre>\n\n<p>Having the wrong owner may prevent WPF from correctly handling the binding declared in the XAML. It's my hope and expectation that fixing your code as above will allow the binding to work.</p>\n\n<p>If not though, please edit your question so that it includes a good code example. Without one, it's not possible to example your specific problem \"in situ\", to debug it properly.</p>\n\n<p>Speaking of debugging, you should also get into the habit of checking the debug output for your program. When binding doesn't work, often WPF has emitted one or more error messages to the debug output. Some of the time, these messages are even helpful. :)</p>\n"}], "owner": {"reputation": 273, "user_id": 2903089, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4f927c4c6f54181f4babf15aae34214?s=128&d=identicon&r=PG&f=1", "display_name": "user2903089", "link": "https://stackoverflow.com/users/2903089/user2903089"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446077455, "creation_date": 1446074141, "last_edit_date": 1446076528, "question_id": 33403234, "link": "https://stackoverflow.com/questions/33403234/binding-misunderstanding-not-getting-properties-set", "title": "Binding misunderstanding not getting properties set", "body": "<p>I have the following XAML and am trying to implement properties on two labels inside so I can set the captions on them when the controls are instantiated in the XAML. At a later stage this will be from code as well. Please can you tell me what am I missing about databinding, and what I should be doing? I am quite new to WPF.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Window x:Class=\"WpfApplication1.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:p=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:local=\"clr-namespace:WpfApplication1\"\n        xmlns:ctrl=\"clr-namespace:xCtrl\"\n        Title=\"MainWindow\" Width=\"525\" ResizeMode=\"NoResize\" SizeToContent=\"WidthAndHeight\" WindowStartupLocation=\"CenterScreen\" WindowStyle=\"None\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;p:Style TargetType=\"ctrl:BSHintButton\" x:Key=\"BSStyle\"&gt;\n            &lt;Setter Property=\"Template\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;ControlTemplate TargetType=\"{x:Type Button}\"&gt;\n\n                        &lt;Grid x:Name=\"xgrid\" Height=\"50\" Width=\"500\" VerticalAlignment=\"Top\"&gt;\n                            &lt;Grid.RowDefinitions&gt;\n                                &lt;RowDefinition Height=\"25\"/&gt;\n                                &lt;RowDefinition Height=\"25\"/&gt;\n                            &lt;/Grid.RowDefinitions&gt;\n                            &lt;Grid.ColumnDefinitions&gt;\n                                &lt;ColumnDefinition Width=\"70\"/&gt;\n                                &lt;ColumnDefinition Width=\"430\n                                                      \"/&gt;\n                            &lt;/Grid.ColumnDefinitions&gt;\n                            &lt;Label x:Name=\"xLabel\" Content=\"{Binding Caption}\"\n                                   Grid.Column=\"1\" HorizontalAlignment=\"Left\"\n                                   Margin=\"10,8,0,0\" VerticalAlignment=\"Top\"\n                                   Grid.RowSpan=\"2\" Width=\"Auto\"\n                                   FontFamily=\"Calibri\" FontSize=\"14\"\n                                   FontWeight=\"Bold\" Height=\"Auto\"/&gt;\n                            &lt;Label x:Name=\"xHint\" Content=\"{Binding HintText}\"\n                                   Foreground=\"DarkCyan\" Grid.Column=\"1\"\n                                   HorizontalAlignment=\"Left\" Height=\"Auto\"\n                                   Margin=\"10,-2,0,0\" Grid.Row=\"1\"\n                                   VerticalAlignment=\"Top\" Width=\"Auto\"\n                                   FontFamily=\"Calibri\" FontSize=\"14\"/&gt;\n                            &lt;Rectangle x:Name=\"xFocus\"\n                                Stroke=\"Orange\"\n                                StrokeThickness=\"1\"\n                                RadiusX = \"4\" RadiusY=\"4\" Grid.RowSpan=\"2\" Grid.ColumnSpan=\"2\" IsEnabled=\"True\" Visibility=\"Hidden\"       \n                                       /&gt;\n                        &lt;/Grid&gt;\n                        &lt;ControlTemplate.Triggers&gt;\n                            &lt;Trigger Property=\"IsMouseOver\"\n                  Value=\"True\"&gt;\n                                &lt;Setter TargetName=\"xgrid\" Property=\"Background\"&gt;\n                                    &lt;Setter.Value&gt;\n                                        &lt;LinearGradientBrush EndPoint=\"0.504,1.5\" StartPoint=\"0.504,0.01\"&gt;\n                                            &lt;GradientStop Color=\"White\" Offset=\"0\"/&gt;\n                                            &lt;GradientStop Color=\"Gold\"  Offset=\"0.1\"/&gt;\n                                            &lt;GradientStop Color=\"White\" Offset=\"0.8\"/&gt;\n                                        &lt;/LinearGradientBrush&gt;\n\n                                    &lt;/Setter.Value&gt;\n                                &lt;/Setter&gt;\n                                &lt;Setter TargetName=\"xFocus\" Property=\"Visibility\"\n                   Value=\"Visible\" /&gt;\n\n                            &lt;/Trigger&gt;\n                        &lt;/ControlTemplate.Triggers&gt;\n                    &lt;/ControlTemplate&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n        &lt;Style TargetType=\"ctrl:OfficeBSHintButton\" BasedOn=\"{StaticResource BSStyle}\" /&gt;\n\n    &lt;/Window.Resources&gt;\n\n\n    &lt;StackPanel Orientation=\"Vertical\" Margin=\"0,0,0,0.001\"&gt;\n        &lt;ctrl:BSHintButton x:Name=\"Button1\" Tag =\"2\" Click=\"Button1_Click\" Caption=\"caption1\" HintText=\"Hint1\"&gt;\n        &lt;/ctrl:BSHintButton&gt;\n        &lt;ctrl:BSHintButton x:Name=\"Button2\" Tag =\"1\" Click=\"Button1_Click\" Caption=\"caption1\" HintText=\"Hint2\"&gt;\n        &lt;/ctrl:BSHintButton&gt;\n    &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><strong>Code for the class</strong></p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Controls;\n\nnamespace xCtrl\n{\n    public class BSHintButton : Button\n    {\n        public static readonly DependencyProperty CaptionProperty =\n        DependencyProperty.Register(\"Caption\",\n                                    typeof(string),\n                                    typeof(Label)\n                                    );\n        public static readonly DependencyProperty HintTextProperty =\n        DependencyProperty.Register(\"HintText\",\n                                    typeof(string),\n                                    typeof(Label)\n                                    );\n        public string Caption\n        {\n            get { return (string)GetValue(CaptionProperty); }\n            set { SetValue(CaptionProperty, value); }\n        }\n        public string HintText\n        {\n            get { return (string)GetValue(HintTextProperty); }\n            set { SetValue(HintTextProperty, value); }\n        }\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c#", "formatting", "currency"], "answers": [{"comments": [{"owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "reply_to_user": {"reputation": 301, "user_id": 5445423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/aed99cda4c5407e351091df27c4608e5?s=128&d=identicon&r=PG&f=1", "display_name": "Nelly", "link": "https://stackoverflow.com/users/5445423/nelly"}, "edited": false, "score": 0, "creation_date": 1446073955, "post_id": 33403162, "comment_id": 54597884, "body": "which method? the first or second?"}, {"owner": {"reputation": 301, "user_id": 5445423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/aed99cda4c5407e351091df27c4608e5?s=128&d=identicon&r=PG&f=1", "display_name": "Nelly", "link": "https://stackoverflow.com/users/5445423/nelly"}, "edited": false, "score": 0, "creation_date": 1446074104, "post_id": 33403162, "comment_id": 54597940, "body": "to both of them. the first show me: &quot;2.20 ? Euro&quot; and the second &quot;? 2.20 Euro&quot;."}, {"owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "reply_to_user": {"reputation": 301, "user_id": 5445423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/aed99cda4c5407e351091df27c4608e5?s=128&d=identicon&r=PG&f=1", "display_name": "Nelly", "link": "https://stackoverflow.com/users/5445423/nelly"}, "edited": false, "score": 0, "creation_date": 1446074165, "post_id": 33403162, "comment_id": 54597974, "body": "hmm, that&#39;s odd - what&#39;s your native culture? i.e - where are you"}, {"owner": {"reputation": 2495, "user_id": 1507941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b90a751acafeb9d30d2efbb60bf77?s=128&d=identicon&r=PG", "display_name": "Pluto", "link": "https://stackoverflow.com/users/1507941/pluto"}, "edited": false, "score": 1, "creation_date": 1446074217, "post_id": 33403162, "comment_id": 54597988, "body": "That&#39;s a separate issue: <a href=\"http://stackoverflow.com/questions/5055659/c-sharp-unicode-string-output\" title=\"c sharp unicode string output\">stackoverflow.com/questions/5055659/&hellip;</a>"}, {"owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "reply_to_user": {"reputation": 2495, "user_id": 1507941, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b90a751acafeb9d30d2efbb60bf77?s=128&d=identicon&r=PG", "display_name": "Pluto", "link": "https://stackoverflow.com/users/1507941/pluto"}, "edited": false, "score": 0, "creation_date": 1446074589, "post_id": 33403162, "comment_id": 54598117, "body": "the link posted by @Pluto should help"}, {"owner": {"reputation": 301, "user_id": 5445423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/aed99cda4c5407e351091df27c4608e5?s=128&d=identicon&r=PG&f=1", "display_name": "Nelly", "link": "https://stackoverflow.com/users/5445423/nelly"}, "edited": false, "score": 0, "creation_date": 1446077117, "post_id": 33403162, "comment_id": 54598944, "body": "I&#39;ve changed in all fonts found in properties but it displays the same question mark."}], "tags": [], "owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "is_accepted": false, "score": 12, "last_activity_date": 1446073694, "creation_date": 1446073694, "answer_id": 33403162, "question_id": 33403122, "link": "https://stackoverflow.com/questions/33403122/converter-into-euro-c/33403162#33403162", "title": "Converter into euro c#", "body": "<p>You need to specify the Culture, to a String.Format</p>\n\n<p>Something like</p>\n\n<pre><code>//use any european culture\nvar cultureInfo = CultureInfo.GetCultureInfo(\"fr-FR\"); \nConsole.WriteLine(String.Format(cultureInfo, \"{0:C} Euro\", result));\n</code></pre>\n\n<p>An alternative</p>\n\n<pre><code>Console.WriteLine(string.Format(\"\u20ac{0:N2} Euro\", result));\n</code></pre>\n\n<p>Format to 2 decimal places (prefixed by \u20ac)</p>\n"}, {"tags": [], "owner": {"reputation": 10871, "user_id": 1698987, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cg2Q3.jpg?s=128&g=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/1698987/noctis"}, "is_accepted": false, "score": 1, "last_activity_date": 1446074088, "creation_date": 1446074088, "answer_id": 33403223, "question_id": 33403122, "link": "https://stackoverflow.com/questions/33403122/converter-into-euro-c/33403223#33403223", "title": "Converter into euro c#", "body": "<p>From: <a href=\"https://msdn.microsoft.com/en-us/library/dwhawy9k%28v=vs.110%29.aspx\" rel=\"nofollow\">MSDN</a>:</p>\n\n<blockquote>\n  <p>\"C\" or \"c\" : Currency      Result: A currency value. Supported by: All\n  numeric types. Precision specifier: Number of decimal digits. Default\n  precision specifier: Defined by\n  NumberFormatInfo.CurrencyDecimalDigits.</p>\n  \n  <p>More information: The Currency (\"C\") Format Specifier.</p>\n</blockquote>\n\n<pre><code>123.456 (\"C\", en-US) -&gt; $123.46  \n123.456 (\"C\", fr-FR) -&gt; 123,46 \u20ac  \n123.456 (\"C\", ja-JP) -&gt; \u00a5123  \n-123.456 (\"C3\", en-US) -&gt; ($123.456)  \n-123.456 (\"C3\", fr-FR) -&gt; -123,456 \u20ac  \n-123.456 (\"C3\", ja-JP) -&gt; -\u00a5123.456  \n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 5445423, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/aed99cda4c5407e351091df27c4608e5?s=128&d=identicon&r=PG&f=1", "display_name": "Nelly", "link": "https://stackoverflow.com/users/5445423/nelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19426, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1446074088, "creation_date": 1446073446, "last_edit_date": 1446073864, "question_id": 33403122, "link": "https://stackoverflow.com/questions/33403122/converter-into-euro-c", "title": "Converter into euro c#", "body": "<p>I have to convert from Lei into euro by using string formatting for currency.\nMy method is:</p>\n\n<pre><code>public static void ConvertFromRonEur()\n    {\n        //string amount = string.Format(\"{0:C}\");\n        double result;\n        Console.WriteLine(\"Lei: \");\n        double quantity;\n        double euro = 0.22D;\n        quantity = double.Parse(Console.ReadLine());\n        result = quantity * euro;\n        Console.WriteLine((\"{0:C} Euro\"), result);\n    }\n</code></pre>\n\n<p>When I run the result is:</p>\n\n<pre><code>  Lei:\n  10\n  $2,20 Euro\n</code></pre>\n\n<p>How can I have only the <code>2,20</code> Euro result, but to use the string formatting currency? Thank you.</p>\n"}, {"tags": ["c#", "xml", "xmlserializer", "xml-deserialization"], "comments": [{"owner": {"reputation": 4090, "user_id": 190042, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5ZXq7.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/190042/jonathan"}, "edited": false, "score": 6, "creation_date": 1446073701, "post_id": 33403110, "comment_id": 54597784, "body": "&quot;I don&#39;t have the code in front of me, but it wasn&#39;t working, and I think it was <i>something</i> like this&quot;... Please post actual failing code instead of asking others to try your potentially failing code."}, {"owner": {"reputation": 13, "user_id": 5500545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c892d75290febfdb6ca68a11163aa957?s=128&d=identicon&r=PG&f=1", "display_name": "SeanThreeD", "link": "https://stackoverflow.com/users/5500545/seanthreed"}, "reply_to_user": {"reputation": 4090, "user_id": 190042, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5ZXq7.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/190042/jonathan"}, "edited": false, "score": 0, "creation_date": 1446109528, "post_id": 33403110, "comment_id": 54610211, "body": "Sorry for not posting actual failing code. I updated my question now."}], "answers": [{"tags": [], "owner": {"reputation": 1083, "user_id": 1875118, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d8c958ab3844c995f041bd818122680?s=128&d=identicon&r=PG", "display_name": "AntiHeadshot", "link": "https://stackoverflow.com/users/1875118/antiheadshot"}, "is_accepted": false, "score": 0, "last_activity_date": 1446115267, "creation_date": 1446115267, "answer_id": 33411999, "question_id": 33403110, "link": "https://stackoverflow.com/questions/33403110/how-to-deserialize-this-xml-document/33411999#33411999", "title": "How to deserialize this XML document?", "body": "<p>In your XML you have </p>\n\n<pre><code>&lt;alpha&gt;???&lt;/alpha&gt;\n</code></pre>\n\n<p>and in your class </p>\n\n<pre><code>public float alphaValue;\n</code></pre>\n\n<p>maybe using </p>\n\n<pre><code>public float alpha;\n</code></pre>\n\n<p>will work.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5500545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c892d75290febfdb6ca68a11163aa957?s=128&d=identicon&r=PG&f=1", "display_name": "SeanThreeD", "link": "https://stackoverflow.com/users/5500545/seanthreed"}, "edited": false, "score": 0, "creation_date": 1446126578, "post_id": 33412001, "comment_id": 54621700, "body": "Yes, that was it! Thanks a lot!!"}, {"owner": {"reputation": 5961, "user_id": 3093396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mo36S.png?s=128&g=1", "display_name": "Volkan Paksoy", "link": "https://stackoverflow.com/users/3093396/volkan-paksoy"}, "reply_to_user": {"reputation": 13, "user_id": 5500545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c892d75290febfdb6ca68a11163aa957?s=128&d=identicon&r=PG&f=1", "display_name": "SeanThreeD", "link": "https://stackoverflow.com/users/5500545/seanthreed"}, "edited": false, "score": 0, "creation_date": 1446126756, "post_id": 33412001, "comment_id": 54621855, "body": "@SeanThreeD: No problem. You can accept the answer too if it worked for you."}], "tags": [], "owner": {"reputation": 5961, "user_id": 3093396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mo36S.png?s=128&g=1", "display_name": "Volkan Paksoy", "link": "https://stackoverflow.com/users/3093396/volkan-paksoy"}, "is_accepted": true, "score": 1, "last_activity_date": 1446115273, "creation_date": 1446115273, "answer_id": 33412001, "question_id": 33403110, "link": "https://stackoverflow.com/questions/33403110/how-to-deserialize-this-xml-document/33412001#33412001", "title": "How to deserialize this XML document?", "body": "<p>If you decorate Hotspot and Properties collections with XmlElement attribute as below deserialization works fine:</p>\n\n<pre><code>public class Data\n{\n    [XmlElement(\"Hotspot\")]\n    public List&lt;Hotspot&gt; Hotspot;\n\n    [XmlIgnore]\n    public Data XmlData;\n\n    public void Deserialize()\n    {\n        XmlSerializer deserializer = new XmlSerializer(typeof(Data));\n        TextReader reader = new StreamReader(@\"XMLFile1.xml\");\n        object obj = deserializer.Deserialize(reader);\n\n        XmlData = (Data)obj;\n        reader.Close();\n    }\n}\n\npublic class Hotspot\n{\n    [XmlElement(\"Properties\")]\n    public List&lt;Properties&gt; Properties = new List&lt;Properties&gt;();\n}\n\npublic class Properties\n{\n    public float xPos;\n    public float yPos;\n\n    [XmlElement(\"alpha\")]\n    public float alphaValue;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5500545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c892d75290febfdb6ca68a11163aa957?s=128&d=identicon&r=PG&f=1", "display_name": "SeanThreeD", "link": "https://stackoverflow.com/users/5500545/seanthreed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 33412001, "answer_count": 2, "score": 0, "last_activity_date": 1446115273, "creation_date": 1446073395, "last_edit_date": 1446114935, "question_id": 33403110, "link": "https://stackoverflow.com/questions/33403110/how-to-deserialize-this-xml-document", "title": "How to deserialize this XML document?", "body": "<p>How do I deserialize this XML document structure with the C# XmlSerializer? </p>\n\n<pre><code>...\n&lt;Data&gt;\n    &lt;Hotspot&gt;\n        &lt;Properties&gt;\n            &lt;xPos&gt;0.5&lt;/xPos&gt;\n            &lt;yPos&gt;0.3&lt;/yPos&gt;\n            &lt;alpha&gt;0.1&lt;/alpha&gt;\n        &lt;/Properties&gt;\n        &lt;Properties&gt;\n            &lt;xPos&gt;0.4&lt;/xPos&gt;\n            &lt;yPos&gt;0.7&lt;/yPos&gt;\n            &lt;alpha&gt;0.2&lt;/alpha&gt;\n        &lt;/Properties&gt;\n    &lt;/Hotspot&gt;\n    &lt;Hotspot&gt;\n        &lt;Properties&gt;\n            &lt;xPos&gt;0.1&lt;/xPos&gt;\n            &lt;yPos&gt;0.2&lt;/yPos&gt;\n            &lt;alpha&gt;0.9&lt;/alpha&gt;\n        &lt;/Properties&gt;\n        &lt;Properties&gt;\n            &lt;xPos&gt;0.2&lt;/xPos&gt;\n            &lt;yPos&gt;0.3&lt;/yPos&gt;\n            &lt;alpha&gt;0.8&lt;/alpha&gt;\n        &lt;/Properties&gt;\n    &lt;/Hotspot&gt;\n&lt;/Data&gt;\n</code></pre>\n\n<p>I'm working in Unity and I want to drive a GUI element with the position data in this XML document.</p>\n\n<p>Here is my code for deserializing:</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Xml.Serialization;\nusing System;\nusing System.IO;\n\npublic class Data\n{\n    public List&lt;Hotspot&gt; Hotspot;\n\n    [XmlIgnore]\n    public Data XmlData;\n\n    public void Deserialize()\n    {\n        XmlSerializer deserializer = new XmlSerializer(typeof(Data));\n        TextReader reader = new StreamReader(@\"D:\\Unity Projects\\Axion800_Kabine\\Assets\\hspositions.xml\");\n        object obj = deserializer.Deserialize(reader);\n\n        XmlData = (Data)obj;\n        reader.Close ();\n    }\n}\n\npublic class Hotspot\n{\n    public List&lt;Properties&gt; Properties = new List&lt;Properties&gt;();\n}\n\npublic class Properties\n{\n    public float xPos;\n    public float yPos;\n\n    public float alphaValue;\n}\n</code></pre>\n\n<p>Just for testing purposes I made another script to actually use the XML data and attached it to a GUI element:</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\nusing System.Collections.Generic;\n\npublic class UseXMLData : MonoBehaviour \n{\n    private RectTransform rectTrans;\n    private int _index = 0;\n\n    private Data data;\n\n    void Awake () \n    {\n        data = new Data();\n        data.Deserialize();\n        rectTrans = GetComponent&lt;RectTransform&gt;();\n    }\n\n    void Update () \n    {\n        rectTrans.anchoredPosition = new Vector2(data.XmlData.Hotspot[0].Properties[_index].xPos, data.XmlData.Hotspot[0].Properties[_index].yPos);\n        _index++;\n\n        if(_index == data.XmlData.Hotspot[0].Properties.Count - 1)\n            _index = 0;\n    }\n}\n</code></pre>\n\n<p>This is the error message I receive:</p>\n\n<pre><code>ArgumentOutOfRangeException: Argument is out of range.\nParameter name: index\nSystem.Collections.Generic.List`1[Properties].get_Item (Int32 index) (at /Users/builduser/buildslave/mono-runtime-and-classlibs/build/mcs/class/corlib/System.Collections.Generic/List.cs:633)\nUseXMLData.Update () (at Assets/UseXMLData.cs:21)\n</code></pre>\n\n<p>Looks to me like the XML data was never successfully read, so that the arrays contain no data. Have I done something wrong in how I set up the Data, Hotspot and Properties classes?</p>\n\n<p>Many thanks for any help!</p>\n\n<p>Sean</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 2560, "user_id": 5273580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/R28Ti.png?s=128&g=1", "display_name": "Falco Alexander", "link": "https://stackoverflow.com/users/5273580/falco-alexander"}, "edited": false, "score": 0, "creation_date": 1446077013, "post_id": 33403075, "comment_id": 54598906, "body": "why did the author get -3 votes?"}, {"owner": {"reputation": 2829, "user_id": 1718305, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4b4e9d661afce1c743a637d3670b836b?s=128&d=identicon&r=PG", "display_name": "ndd", "link": "https://stackoverflow.com/users/1718305/ndd"}, "edited": false, "score": 0, "creation_date": 1446080956, "post_id": 33403075, "comment_id": 54600101, "body": "Use ILSpy it will help you understand how compiler changes the code behind the scenes"}], "answers": [{"comments": [{"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1446073590, "post_id": 33403102, "comment_id": 54597744, "body": "Ok. In that case, why following assignment doesn&#39;t work                        private string anotherInstaceName = &quot;Jon&quot;;         //A field initializer cannot reference a non static field         public string Name { get; set; } = anotherInstaceName;"}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1446073726, "post_id": 33403102, "comment_id": 54597792, "body": "As per the documentation, it doesn&#39;t set such in-line assignment through setters."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 1, "creation_date": 1446073885, "post_id": 33403102, "comment_id": 54597853, "body": "@Nair It doesn&#39;t work for exactly the same reason it wouldn&#39;t work in this answer&#39;s second snippet, which is what it&#39;s conceptually transformed into.  Try doing the same thing with a field initializer and it fails for exactly the same reason."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446074189, "post_id": 33403102, "comment_id": 54597984, "body": "@Servy, Much appreciate your version. I am aware of how this is implemented internally in the past. But, what I am trying to understand is, how this is different in c# 6.0 to facilitate as in-line assignment."}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446074369, "post_id": 33403102, "comment_id": 54598034, "body": "@Servy, If I assume your point as valid then  why we couldn&#39;t do in-line assignment in the past?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446074507, "post_id": 33403102, "comment_id": 54598081, "body": "Nothing changed with respect to how fields are initialized.  You can simply initialize the field now.  Your invalid initializer is just as invalid for a field as it is for an automatically implemented property, and for <i>exactly</i> the same reason, as the code samples in the answer show."}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "reply_to_user": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1446074855, "post_id": 33403102, "comment_id": 54598215, "body": "@Nair the <i>only</i> thing that has changed is that C# now emits two instructions when assigning a default value to a property. Those two instructions are <code>IL_0001:  ldstr       &quot;Jon&quot;</code> and <code>IL_0006:  stfld</code>. Before <code>C#6</code>, it would be equivalent to <code>private string _name;</code> instead of <code>private string _name  = &quot;Jon&quot;;</code>. The <b><i>only</i></b> difference is the initialization of the backing field, nothing else."}], "tags": [], "owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "is_accepted": true, "score": 3, "last_activity_date": 1519774899, "last_edit_date": 1519774899, "creation_date": 1446073371, "answer_id": 33403102, "question_id": 33403075, "link": "https://stackoverflow.com/questions/33403075/about-backing-field-type-in-c-6/33403102#33403102", "title": "About backing field type in C# 6", "body": "<p>This:</p>\n\n<pre><code>class ProDemo \n{            \n    public string Name { get; set; } = \"Jon\";\n}\n</code></pre>\n\n<p>Is compiled to this:</p>\n\n<pre><code>class ProDemo \n{        \n    private string _name = \"Jon\";\n    public string get_Name() { return _name; }\n    public void set_Name(string value) { _name = value; }\n}\n</code></pre>\n\n<p>There isn't anything to do with static types, at all.</p>\n"}], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 33403102, "answer_count": 1, "score": 0, "last_activity_date": 1519774899, "creation_date": 1446073250, "last_edit_date": 1446082048, "question_id": 33403075, "link": "https://stackoverflow.com/questions/33403075/about-backing-field-type-in-c-6", "title": "About backing field type in C# 6", "body": "<p>In C# 6, we can assign in-line values to automatic property. Since the value of these automatic property is set directly to the backing field (without setter), can I assume the backing field is a 'static type'? If I am wrong, can someone explain me how value is been assigned to backing field? At which stage compiler assign the in-line to the Property ?</p>\n\n<pre><code>class ProDemo \n{            \n    public string Name { get; set; } = \"Jon\";\n}\n</code></pre>\n\n<p>Can someone explain me how automatic property implemented differently in C# 6 while comparing previous version of C#?</p>\n"}, {"tags": ["c#", ".net", "parsing", "xpath", "html-agility-pack"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5500531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce0d13607ba1d867473d99a525b6b84?s=128&d=identicon&r=PG&f=1", "display_name": "anvar98", "link": "https://stackoverflow.com/users/5500531/anvar98"}, "edited": false, "score": 0, "creation_date": 1446306907, "post_id": 33408945, "comment_id": 54693659, "body": "Thanks a lot, this works! However, i am still missing one link, i get 39 in total, lazylinks - 35, where is it possible to lose one?"}, {"owner": {"reputation": 4906, "user_id": 696140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18e975e0df71c6cdc4ad30b9d64892b?s=128&d=identicon&r=PG", "display_name": "Tung", "link": "https://stackoverflow.com/users/696140/tung"}, "reply_to_user": {"reputation": 3, "user_id": 5500531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce0d13607ba1d867473d99a525b6b84?s=128&d=identicon&r=PG&f=1", "display_name": "anvar98", "link": "https://stackoverflow.com/users/5500531/anvar98"}, "edited": false, "score": 0, "creation_date": 1446452622, "post_id": 33408945, "comment_id": 54732036, "body": "I still retrieve 40 total.  Check whether there are subtle differences in the link that you&#39;re missing and the XPATH we&#39;ve chosen (see that extra trailing space in the XPATH).  The XPATH I used is based on a common property shared amongst the links of interest. The properties on which you rely may be changed without the developer even intending for them to change.  It&#39;s not entirely improbable for the developer or their framework to remove that trailing space or change the way in which these &quot;links&quot; are rendered completely."}], "tags": [], "owner": {"reputation": 4906, "user_id": 696140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18e975e0df71c6cdc4ad30b9d64892b?s=128&d=identicon&r=PG", "display_name": "Tung", "link": "https://stackoverflow.com/users/696140/tung"}, "is_accepted": true, "score": 0, "last_activity_date": 1446157394, "last_edit_date": 1446157394, "creation_date": 1446106355, "answer_id": 33408945, "question_id": 33403031, "link": "https://stackoverflow.com/questions/33403031/xpath-not-working-in-htmlagilitypack-c/33408945#33408945", "title": "XPath not working in HtmlAgilityPack C#", "body": "<p><em>NOTE</em>: I tested this against <a href=\"http://www.aliexpress.com/wholesale?site=glo&amp;SearchText=watch&amp;page=1\" rel=\"nofollow\">http://www.aliexpress.com/wholesale?site=glo&amp;SearchText=watch&amp;page=1</a></p>\n\n<p>This is not a problem related to HTMLAgility pack nor with XPath. The issue here is that this website is using something called handlebar js to implement some type of lazy-loading.  One thing to keep in mind is that the <code>WebClient</code> is not a web browser.  That is, the <code>WebClient</code> retrieves the static HTML response that the server sends, and does not execute any javascript, whereas a browser would.  </p>\n\n<p>If you examine the raw HTML response that you're getting from the server, there are only four items in the <code>&lt;ul class=\"util-clearfix son-list util-clearfix\" id=\"hs-below-list-items\"&gt;</code> element:</p>\n\n<pre><code>&lt;ul class=\"util-clearfix son-list util-clearfix\" id=\"hs-below-list-items\"&gt;\n    &lt;!-- each li here is the ancestor of an anchor tag that you're hoping to scrape --&gt;\n    &lt;li qrdata=\"200214047|32341478696|cn1513149702\"  class=\"list-item list-item-first \"&gt;... &lt;/li&gt;\n    &lt;li qrdata=\"200214047|32259964358|ali900189121\"  class=\"list-item list-item-first \"&gt;...&lt;/li&gt;\n    &lt;li qrdata=\"200214021|32388460600|cn1000737283\"  class=\"list-item list-item-first \"&gt;..&lt;/li&gt;\n    &lt;li qrdata=\"200214007|32400985609|cn1513217672\"  class=\"list-item list-item-first \"&gt;...&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>After that, there's a script block where the remainder of the items reside:</p>\n\n<pre><code>&lt;script type=\"text/x-handlebars-template\" id=\"lazy-render\" class=\"lazy-render\"&gt;\n    &lt;li qrdata=\"200214007|32390805633|cn111508265\"  class=\"list-item   \"&gt;\n    ....\n&lt;/script&gt;\n</code></pre>\n\n<p>When you load the Raw HTML inside the <code>HtmlDocument</code> object, it treats the content inside the <code>&lt;script&gt;</code> element as <code>NodeType.Text</code>.  This is why you're not getting the results you want.</p>\n\n<p>That said, here's a workaround:</p>\n\n<pre><code>var links = document.DocumentNode.SelectNodes(\"//a[@class='picRind history-item ']|//a[@class='picRind history-item j-p4plog']\").Select(a =&gt; a.Attributes[\"href\"].Value).Distinct();\nforeach (var link in links)\n{\n    Console.WriteLine(link);\n}\n\nvar lazyContent = new HtmlDocument();\nlazyContent.LoadHtml(document.DocumentNode.SelectNodes(\"//script[@id='lazy-render']\").First().ChildNodes[0].InnerHtml);\nvar lazyLinks = lazyContent.DocumentNode.SelectNodes(\"//a[@class='picRind history-item ']|//a[@class='picRind history-item j-p4plog']\")\n                .Select(a =&gt; a.Attributes[\"href\"].Value)\n                .Distinct();\n\nforeach (var link in lazyLinks)\n{\n    // Prints the remaining 36 product links\n    Console.WriteLine(link);\n}\n</code></pre>\n\n<p>What we did in the work-around was fetch the script block, and treated it as a new document, then scraped the remaining product links.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6611888, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/dbd87f60dfc36669921c68cf9941078d?s=128&d=identicon&r=PG", "display_name": "Lundy", "link": "https://stackoverflow.com/users/6611888/lundy"}, "is_accepted": false, "score": -1, "last_activity_date": 1468992599, "creation_date": 1468992599, "answer_id": 38472983, "question_id": 33403031, "link": "https://stackoverflow.com/questions/33403031/xpath-not-working-in-htmlagilitypack-c/38472983#38472983", "title": "XPath not working in HtmlAgilityPack C#", "body": "<p>Yahoo has new format, it causes errors while using HAP XPath.\nFor example HAP cannot parse data from Statistic Tab.\ntry this link: <a href=\"http://finance.yahoo.com/quote/IBM/key-statistics\" rel=\"nofollow\">http://finance.yahoo.com/quote/IBM/key-statistics</a>\nto get Price/Book (mrq) data. HAP failed at parsing the ..section data.</p>\n"}], "owner": {"reputation": 3, "user_id": 5500531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ce0d13607ba1d867473d99a525b6b84?s=128&d=identicon&r=PG&f=1", "display_name": "anvar98", "link": "https://stackoverflow.com/users/5500531/anvar98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 33408945, "answer_count": 2, "score": 0, "last_activity_date": 1468992599, "creation_date": 1446073054, "question_id": 33403031, "link": "https://stackoverflow.com/questions/33403031/xpath-not-working-in-htmlagilitypack-c", "title": "XPath not working in HtmlAgilityPack C#", "body": "<p>I am trying to parse this web page <a href=\"http://www.aliexpress.com/wholesale?site=glo&amp;SearchText=watch&amp;page=1\" rel=\"nofollow\">http://www.aliexpress.com/wholesale?site=glo&amp;SearchText=watch&amp;page=1</a> and get all the watches. However, i tried around dozen different XPaths with HTMLAgilityPack and I am able to scrape only 4 product links (should be around 36).</p>\n\n<pre><code>    WebClient client = new WebClient();\n        client.Headers[HttpRequestHeader.UserAgent] = \"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36\";\n    var html = client.DownloadString(currentUrl);\n    var document = new HtmlDocument();\n\n    document.LoadHtml(html);\n\n     var links = doc.DocumentNode.SelectNodes(\"//div[@class='item']//a\").Select(a =&gt; a.Attributes[\"href\"].Value).Distinct();\n</code></pre>\n\n<p>I tried a lot of different XPaths, nothing seems to work, what is interesting even \"//a[@href]\" does not parse all the products but again i can see the links of only 4 of them.</p>\n\n<p>I rechecked the html it's loading and i can see there more products. So what is the problem? Is it some HtmlAgilityPack issue? Could anybody help, I am struggling with this for three days now...</p>\n"}, {"tags": ["c#", "generics", "inheritance", "casting"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1446074010, "post_id": 33402887, "comment_id": 54597906, "body": "Why do you need <code>IntRange</code> in the first place? Just to contain the static method <code>ParseRanges</code>? Did you add any new instance members to <code>IntRange</code>?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1446074044, "post_id": 33402887, "comment_id": 54597923, "body": "Rather than create a <code>Create</code> method for every derived <code>Range</code> class, **don&#39;t create derived <code>Range</code> classes.  Deal exclusively with <code>Range&lt;T&gt;</code>.  Seal it even.  Create a static method in another class that can take a <code>string</code> and return a <code>List&lt;Range&lt;int&gt;&gt;</code> if you want to; but you&#39;re getting nothing but trouble out of inheriting <code>Range</code> like this."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1446074120, "post_id": 33402887, "comment_id": 54597951, "body": "Oh, and it&#39;s probably best for <code>Range</code> to be immutable, rather than mutable.  It&#39;s all the more true if you want to maintain invariant, such as that the maximum is actually larger.  If it&#39;s mutable someone can violate that invariant."}, {"owner": {"reputation": 3615, "user_id": 975724, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/o10HS.jpg?s=128&g=1", "display_name": "Nicholas Miller", "link": "https://stackoverflow.com/users/975724/nicholas-miller"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446125076, "post_id": 33402887, "comment_id": 54620507, "body": "@Servy Thanks.  I never considered immutability.  By the way, it might be I should seal the class in this example, but surely there are other instances where subclassing is acceptable, right?  <a href=\"https://msdn.microsoft.com/en-us/library/ms379564(v=vs.80).aspx#csharp_generics_topic6\" rel=\"nofollow noreferrer\">The MSDN generics article</a>  even show&#39;s its valid, so I assume there must be a use case."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1446125156, "post_id": 33402887, "comment_id": 54620568, "body": "Yes, there are.  I even said as much.  It&#39;s simply a harmful approach <i>in this situation</i>."}, {"owner": {"reputation": 3615, "user_id": 975724, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/o10HS.jpg?s=128&g=1", "display_name": "Nicholas Miller", "link": "https://stackoverflow.com/users/975724/nicholas-miller"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1446125167, "post_id": 33402887, "comment_id": 54620575, "body": "@YacoubMassad Yes it only contains the helper function.  Seemed to be like the most suitable place for it.  While that is the example I used, I was trying to focus on the cast."}], "answers": [{"comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446074097, "post_id": 33402986, "comment_id": 54597938, "body": "And of course now you&#39;ve lost the ability to infer the types of <code>Create</code>, making it quite cumbersome to use.  And if <code>Range</code> becomes immutable (which it really should) then this ceases to become an option."}], "tags": [], "owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "is_accepted": false, "score": 0, "last_activity_date": 1446072879, "creation_date": 1446072879, "answer_id": 33402986, "question_id": 33402887, "link": "https://stackoverflow.com/questions/33402887/how-to-cast-ranget-to-intrange/33402986#33402986", "title": "How to cast Range&lt;T&gt; to IntRange?", "body": "<p>You'll need to change your create method to create the correct range:</p>\n\n<pre><code>public class IntRange : Range&lt;Int32&gt;\n{\n    public static List&lt;IntRange&gt; ParseRanges(string ranges)\n    {\n        return new[] { Create&lt;IntRange, int&gt;(1, 2) }.ToList();\n    }\n}\n\npublic static TRangeType Create&lt;TRangeType, TItemType&gt;(TItemType bound1, TItemType bound2)\n where TRangeType : Range&lt;TItemType&gt;, new()\n where TItemType : IComparable&lt;TItemType&gt;\n{\n    if (bound1.CompareTo(bound2) &lt;= 0)\n    {\n        return new TRangeType { Minimum = bound1 };\n    }\n    else\n    {\n        return new TRangeType { Minimum = bound2, Maximum=bound2 };\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3615, "user_id": 975724, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/o10HS.jpg?s=128&g=1", "display_name": "Nicholas Miller", "link": "https://stackoverflow.com/users/975724/nicholas-miller"}, "edited": false, "score": 0, "creation_date": 1446125401, "post_id": 33403229, "comment_id": 54620764, "body": "This is quiet an elegant solution.  Are there any side-effects from doing this?  As far as I can tell, this is working properly."}], "tags": [], "owner": {"reputation": 13062, "user_id": 1464084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e33614e1c697bd6eedeeff7172cf22e?s=128&d=identicon&r=PG", "display_name": "Moho", "link": "https://stackoverflow.com/users/1464084/moho"}, "is_accepted": true, "score": 0, "last_activity_date": 1446074108, "creation_date": 1446074108, "answer_id": 33403229, "question_id": 33402887, "link": "https://stackoverflow.com/questions/33402887/how-to-cast-ranget-to-intrange/33403229#33403229", "title": "How to cast Range&lt;T&gt; to IntRange?", "body": "<p>Use constructors instead of a static method, which also allows you to make the setters of the <code>Minimum</code> and <code>Maximum</code> properties protected/private, as they really should be (should a user be able to change their values, ultimately redefining the object after instantiation?).  Pass the parameters to the base constructor when the default logic is sufficient, use the default <code>base()</code> constructor when you want to override the logic in your derived classes.</p>\n\n<pre><code>public class Range&lt;T&gt; \n{\n    Range() { }\n    Range( T bound1, T bound2 ) { /* your static method logic here */ }\n}\n\npublic class IntRange : Range&lt;int&gt;\n{\n    IntRange( int bound1, int bound2 ) \n        : base( bound1, bound2 )\n    { }\n\n    IntRange( int b1, int b2, bool someExampleFlag )\n    {\n        // custom logic here\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3615, "user_id": 975724, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/o10HS.jpg?s=128&g=1", "display_name": "Nicholas Miller", "link": "https://stackoverflow.com/users/975724/nicholas-miller"}, "edited": false, "score": 0, "creation_date": 1446125884, "post_id": 33404007, "comment_id": 54621127, "body": "I fail to see the real difference in this versus rolling out my own create function.  I&#39;m asking for the situation that I must subclass, but rely on the parent to create.  But in the factory method, we&#39;ve told the factory what the logic must be.  If we instead try to rely on the default (parent) behavior, we&#39;ll be trying to cast <code>Range&lt;Int32&gt;</code> in to an <code>IntRange</code> once again.  Despite this, thanks for showing me how factories look like. ^^"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "reply_to_user": {"reputation": 3615, "user_id": 975724, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/o10HS.jpg?s=128&g=1", "display_name": "Nicholas Miller", "link": "https://stackoverflow.com/users/975724/nicholas-miller"}, "edited": false, "score": 1, "creation_date": 1446157318, "post_id": 33404007, "comment_id": 54640414, "body": "@NickMiller - This has the difference of separating the mechanism to create from the place that you want to create it. It also allows you to choose at run-time which class you want returned without needing to change the <code>Range</code> class. How do you expect your code to be able to differentiate between <code>IntRange</code> &amp; <code>VerySpecialIntRange</code> without you coding for the correct one? This approach even lets you inject new subclasses from different assemblies into your code. This is a run-time rather than compile-time approach. I don&#39;t think any other method will get closer to what you want."}], "tags": [], "owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "is_accepted": false, "score": 0, "last_activity_date": 1446078829, "creation_date": 1446078829, "answer_id": 33404007, "question_id": 33402887, "link": "https://stackoverflow.com/questions/33402887/how-to-cast-ranget-to-intrange/33404007#33404007", "title": "How to cast Range&lt;T&gt; to IntRange?", "body": "<p>It's a little bit tricky to do, but you basically need to create an abstract factory pattern.</p>\n\n<p>First up I would change the original <code>Range&lt;T&gt;</code> class to have the signature <code>public class Range&lt;T&gt; : Range where T : IComparable&lt;T&gt;</code>.</p>\n\n<p>Now I define the <code>Range</code> class as this:</p>\n\n<pre><code>public class Range\n{\n    private static Dictionary&lt;Type, Delegate&gt; _factories = new Dictionary&lt;Type, Delegate&gt;();\n\n    public static void AddFactory&lt;T&gt;(Func&lt;T, T, Range&lt;T&gt;&gt; factory) where T : IComparable&lt;T&gt;\n    {\n        _factories.Add(typeof(T), factory);\n    }\n\n    public static Range&lt;T&gt; Create&lt;T&gt;(T bound1, T bound2) where T : IComparable&lt;T&gt;\n    {\n        Func&lt;T, T, Range&lt;T&gt;&gt; factory =\n            _factories.ContainsKey(typeof(T))\n                ? (Func&lt;T, T, Range&lt;T&gt;&gt;)_factories[typeof(T)]\n                : (Func&lt;T, T, Range&lt;T&gt;&gt;)((n, x) =&gt; new Range&lt;T&gt;()\n                {\n                    Minimum = bound1,\n                    Maximum = bound2\n                });\n\n        return\n            bound1.CompareTo(bound2) &lt;= 0\n                ? factory(bound1, bound2)\n                : factory(bound2, bound1);\n    }\n}\n</code></pre>\n\n<p>What this does is creates a <code>Dictionary&lt;Type, Delegate&gt;</code> that can hold as many different factories that you need to create all of the special range types that you want to define. When you call <code>Create&lt;T&gt;</code> the type of <code>T</code> is used to check if you have a special factory, and, if you do, it uses this factory to create your range, and otherwise it uses the default <code>Range&lt;T&gt;</code> class.</p>\n\n<p>A non-generic <code>Range</code> class is required to make this work. If you try to put the factory code in the <code>Range&lt;T&gt;</code> you'll get a separate <code>_factories</code> instance per <code>T</code>. With the non-generic class you only get one.</p>\n\n<p>You can define a factory like this:</p>\n\n<pre><code>Range.AddFactory&lt;int&gt;((n, x) =&gt; new IntRange() { Minimum = n, Maximum = x });\n</code></pre>\n\n<p>Now you can call your create code like this:</p>\n\n<pre><code>IntRange range = (IntRange)Range.Create&lt;int&gt;(4, 9);\n</code></pre>\n\n<p>This runs and works perfectly fine.</p>\n"}], "owner": {"reputation": 3615, "user_id": 975724, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/o10HS.jpg?s=128&g=1", "display_name": "Nicholas Miller", "link": "https://stackoverflow.com/users/975724/nicholas-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 33403229, "answer_count": 3, "score": 1, "last_activity_date": 1446078829, "creation_date": 1446072386, "last_edit_date": 1495535238, "question_id": 33402887, "link": "https://stackoverflow.com/questions/33402887/how-to-cast-ranget-to-intrange", "title": "How to cast Range&lt;T&gt; to IntRange?", "body": "<p>I am using the <a href=\"https://stackoverflow.com/a/5343033/975724\"><code>Range&lt;T&gt;</code> class described in this answer</a>.</p>\n\n<p>And I created the following sub-class in order to create a range of a specific type:</p>\n\n<pre><code>public class IntRange : Range&lt;Int32&gt;\n{\n    public static List&lt;IntRange&gt; ParseRanges(string ranges)\n    {\n        //...\n    }\n}\n</code></pre>\n\n<p>In order to finish the <code>ParseRanges</code> function, I need to cast from <code>Range&lt;Int32&gt;</code> to <code>IntRange</code>.  This is because I am calling a helper function I added to the <code>Range&lt;T&gt;</code> class:</p>\n\n<pre><code>//Create a range that automatically determines the min/max between two bounds.\npublic static Range&lt;T&gt; Create(T bound1, T bound2)\n{\n    if (bound1.CompareTo(bound2) &lt;= 0)\n    {\n        return new Range&lt;T&gt;() { Minimum = bound1, Maximum = bound2 };\n    }\n    else\n    {\n        return new Range&lt;T&gt;() { Minimum = bound2, Maximum = bound2 };\n    }\n}\n</code></pre>\n\n<p>The method calls look like the following:</p>\n\n<pre><code>IntRange range = (IntRange)Create(2, 0);\n</code></pre>\n\n<hr>\n\n<p>First of all, I understand that I cannot legally make this cast because it is possible for another person to create a class:</p>\n\n<pre><code>public class VerySpecialIntRange : Range&lt;Int32&gt; { /* ... */ }\n</code></pre>\n\n<p>And it isn't possible for the compiler to know if <code>Range&lt;Int32&gt;</code> should be an <code>IntRange</code> or a <code>VerySpecialIntRange</code>, hence the error it spits out when I try to cast.</p>\n\n<p>How can I make this cast so that I do not need to roll out the <code>Create</code> function for every subclass?  Sure, I have my own source code and can do this with relative ease, but if the <code>Range&lt;T&gt;</code> is a part of some closed third-party library, and I need to subclass it, I cannot easily determine how to properly implement the <code>Create</code> function.</p>\n"}, {"tags": ["c#", ".net", "multithreading", "task-parallel-library", "task"], "comments": [{"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1446072408, "post_id": 33402821, "comment_id": 54597236, "body": "Depending on your use case, you could create a static object, and lock on that."}], "answers": [{"comments": [{"owner": {"reputation": 1658, "user_id": 2292615, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1138e8838bcbc306d9d63fe6091f22f9?s=128&d=identicon&r=PG&f=1", "display_name": "Osman Esen", "link": "https://stackoverflow.com/users/2292615/osman-esen"}, "edited": false, "score": 0, "creation_date": 1446074790, "post_id": 33402905, "comment_id": 54598196, "body": "The static object was actually what I needed. Thank you very much !"}], "tags": [], "owner": {"reputation": 13828, "user_id": 4588915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTCr8.png?s=128&g=1", "display_name": "Jakub Lortz", "link": "https://stackoverflow.com/users/4588915/jakub-lortz"}, "is_accepted": true, "score": 2, "last_activity_date": 1446072476, "creation_date": 1446072476, "answer_id": 33402905, "question_id": 33402821, "link": "https://stackoverflow.com/questions/33402821/locking-tasks-in-a-method-which-is-called-on-different-instances-of-a-class/33402905#33402905", "title": "Locking tasks in a method, which is called on different instances of a class", "body": "<p>You can do it with <code>Monitor</code>, just lock on a static object so that it's shared between all instances.</p>\n\n<pre><code>private static object _lock = new object();\n\npublic IRapportBestilling GetNextReportOrderAndLock(...)\n{\n    ...\n    using (var scope = new QueryEngineSessionScope())\n    {\n        lock(_lock)\n        {\n            ...\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1658, "user_id": 2292615, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1138e8838bcbc306d9d63fe6091f22f9?s=128&d=identicon&r=PG&f=1", "display_name": "Osman Esen", "link": "https://stackoverflow.com/users/2292615/osman-esen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 33402905, "answer_count": 1, "score": 0, "last_activity_date": 1446072476, "creation_date": 1446072060, "question_id": 33402821, "link": "https://stackoverflow.com/questions/33402821/locking-tasks-in-a-method-which-is-called-on-different-instances-of-a-class", "title": "Locking tasks in a method, which is called on different instances of a class", "body": "<p>I have following method, which is called by different instances of my ReportGenerator class. The ReportGenerator class starts a single task, which accesses following method with an Interface to the class containing this method.       </p>\n\n<pre><code> public IRapportBestilling GetNextReportOrderAndLock(DateTime nextTimeoutValue, string correlationId, Func&lt;EstimatedReportSize?, int, bool&gt; getPermission, int taskId)\n    {\n        this.ValidateReportOrderQueueTimeout(nextTimeoutValue, correlationId);\n        IRapportBestillingKoe reportOrderQueue;         \n        try\n        {            \n            using (var scope = new QueryEngineSessionScope())\n            {\n --&gt; Lock here   bool allowLargeReports = getPermission.Invoke(EstimatedReportSize.RequestForLarge, taskId); \n                reportOrderQueue = this.rapportBestillingKoeRepository.GetNextReportOrderQueueItem(scope, correlationId, allowLargeReports, taskId);                    \n\n                reportOrderQueue.Laast = true;\n                reportOrderQueue.Timeout = nextTimeoutValue;\n                this.rapportBestillingKoeRepository.Save(reportOrderQueue, scope, correlationId);\n                scope.Complete(); \n\n --&gt; Release lock getPermission.Invoke(reportOrderQueue.EstimeretRapportStoerelse, taskId);\n\n                var rep = this.rapportBestillingRepository.GetDomainObjectById(reportOrderQueue.RapportBestillingId, scope, correlationId);\n\n                rep.StorRapport = (reportOrderQueue.EstimeretRapportStoerelse == EstimatedReportSize.Large); \n                return rep;\n            }\n        }\n    }\n</code></pre>\n\n<p>I need to only allow a single task to be executing the code block in the method shown above. I have used Interlocked as well as Monitor class to handle this problem, but this is not working since this method is called on different instances of my class. Is there an approach to handle this problem ?. </p>\n"}, {"tags": ["c#", "asp.net", ".net", "asp.net-mvc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1446072195, "post_id": 33402814, "comment_id": 54597151, "body": "Remove the <code>@Value = &quot; &quot; </code> code. If the value of <code>Item.ItemId</code> is <code>123</code>, then it will be added automatically. You need to show your <code>Details(int ID)</code> method"}, {"owner": {"reputation": 109, "user_id": 4195718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ecfe263e752a43aa3ad78bfcdd7c86?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouS", "link": "https://stackoverflow.com/users/4195718/curious"}, "edited": false, "score": 0, "creation_date": 1446073227, "post_id": 33402814, "comment_id": 54597566, "body": "@StephenMuecke       public ActionResult Details(int id)         {             var item = _auctionhDbc.Items.Find(id);             return View(item);         }"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1446073478, "post_id": 33402814, "comment_id": 54597686, "body": "Edit your question (not in comments). But the code in you comment does not appear to set the value of property <code>Item.ItemId</code> (and what is your model in the view? Based on what you have show you need <code>item.Item.ItemId = id;</code> which does not make much sense"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4195718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ecfe263e752a43aa3ad78bfcdd7c86?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouS", "link": "https://stackoverflow.com/users/4195718/curious"}, "edited": false, "score": 0, "creation_date": 1446077711, "post_id": 33403654, "comment_id": 54599120, "body": "Great!   What if I need to access other properties of the item, e.g. Item.ItemName?"}, {"owner": {"reputation": 1025, "user_id": 3624340, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qQKHe.jpg?s=128&g=1", "display_name": "A. Burak Erbora", "link": "https://stackoverflow.com/users/3624340/a-burak-erbora"}, "reply_to_user": {"reputation": 109, "user_id": 4195718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ecfe263e752a43aa3ad78bfcdd7c86?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouS", "link": "https://stackoverflow.com/users/4195718/curious"}, "edited": false, "score": 0, "creation_date": 1446077956, "post_id": 33403654, "comment_id": 54599180, "body": "whatever your model carries with it, you can access the same way. i.e. <code>@Html.EditorFor(m =&gt; m.YourModelProperty)</code>"}, {"owner": {"reputation": 1025, "user_id": 3624340, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qQKHe.jpg?s=128&g=1", "display_name": "A. Burak Erbora", "link": "https://stackoverflow.com/users/3624340/a-burak-erbora"}, "reply_to_user": {"reputation": 109, "user_id": 4195718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ecfe263e752a43aa3ad78bfcdd7c86?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouS", "link": "https://stackoverflow.com/users/4195718/curious"}, "edited": false, "score": 1, "creation_date": 1446078007, "post_id": 33403654, "comment_id": 54599205, "body": "Consider also using a view model (a custom class for this) instead of your <code>DbContext</code> class <code>Items</code>. That way you will have more flexibility."}, {"owner": {"reputation": 109, "user_id": 4195718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ecfe263e752a43aa3ad78bfcdd7c86?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouS", "link": "https://stackoverflow.com/users/4195718/curious"}, "edited": false, "score": 0, "creation_date": 1446120655, "post_id": 33403654, "comment_id": 54617483, "body": "It helped me figure out the solution. :)"}], "tags": [], "owner": {"reputation": 1025, "user_id": 3624340, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qQKHe.jpg?s=128&g=1", "display_name": "A. Burak Erbora", "link": "https://stackoverflow.com/users/3624340/a-burak-erbora"}, "is_accepted": true, "score": 1, "last_activity_date": 1446076643, "creation_date": 1446076643, "answer_id": 33403654, "question_id": 33402814, "link": "https://stackoverflow.com/questions/33402814/asp-net-mvc-passing-url-id-between-views-of-different-controllers/33403654#33403654", "title": "ASP.NET MVC Passing URL id between views of different controllers", "body": "<p>Assuming you are using strongly typed views, your model for the <code>Create</code> view will already have the value of 123 in <code>ItemID</code>. The problem is, your model is of type <code>Items</code>, yet you are trying to use <code>EditorFor</code> for <code>model.Item.ItemID</code>.</p>\n\n<p>Thus, instead of your line </p>\n\n<pre><code>@Html.EditorFor(model =&gt; model.Item.ItemId, \n    new { htmlAttributes = new { @class = \"form-control\", @Value = \" \" } })\n</code></pre>\n\n<p>if you use </p>\n\n<pre><code>@Html.EditorFor(model =&gt; model.ItemId, \n        new { htmlAttributes = new { @class = \"form-control\" } })\n</code></pre>\n\n<p>you will already have passed the value there. Make sure you use <a href=\"http://www.asp.net/mvc/overview/views/dynamic-v-strongly-typed-views\" rel=\"nofollow\">strongly typed views</a> by putting:</p>\n\n<pre><code>@model YourNameSpace.Items\n</code></pre>\n\n<p>in the beginning of your view.</p>\n"}], "owner": {"reputation": 109, "user_id": 4195718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ecfe263e752a43aa3ad78bfcdd7c86?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouS", "link": "https://stackoverflow.com/users/4195718/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 33403654, "answer_count": 1, "score": 0, "last_activity_date": 1446076643, "creation_date": 1446072016, "last_edit_date": 1446075791, "question_id": 33402814, "link": "https://stackoverflow.com/questions/33402814/asp-net-mvc-passing-url-id-between-views-of-different-controllers", "title": "ASP.NET MVC Passing URL id between views of different controllers", "body": "<p>So I decided to make an auction house web application as my first asp.net mvc project and I cannot figure out how to pass a parameter between two views that belong to different controllers. In the first view, Details of AuctionHouseController, I have:</p>\n\n<pre><code>&lt;a class=\"btn btn-default\" href=\"@Url.Action(\"Create\", \"Auctions\", new { id = Model.ItemId })\"&gt;Start Auction &amp;raquo;&lt;/a&gt;\n</code></pre>\n\n<p>and a URL: <a href=\"http://localhost:2142/AuctionHouse/Details/123\" rel=\"nofollow\">http://localhost:2142/AuctionHouse/Details/123</a></p>\n\n<p>And here is the Details method:</p>\n\n<pre><code>public ActionResult Details(int id)\n    {\n        var item = _auctionhDbc.Items.Find(id);\n        return View(item);\n    }\n</code></pre>\n\n<p>I want to pass the id part of the URL - the \"123\" to the view where the button leads - Create of AuctionsController, where I have:</p>\n\n<pre><code>    &lt;div class=\"form-group\"&gt;\n        @Html.LabelFor(model =&gt; model.Item.ItemId, htmlAttributes: new { @class = \"control-label col-md-2\" })\n        &lt;div class=\"col-md-10\"&gt;\n            @Html.EditorFor(model =&gt; model.Item.ItemId, new { htmlAttributes = new { @class = \"form-control\", @Value = \" \" } })\n            @Html.ValidationMessageFor(model =&gt; model.Item.ItemId, \"\", new { @class = \"text-danger\" })\n        &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>I want to place the \"123\" as the default value (@Value) of the Html Editor field. How can I do that?</p>\n"}, {"tags": ["c#", ".net", "asp.net-web-api"], "comments": [{"owner": {"reputation": 5261, "user_id": 858757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMQgQ.png?s=128&g=1", "display_name": "Silvermind", "link": "https://stackoverflow.com/users/858757/silvermind"}, "edited": false, "score": 1, "creation_date": 1446072614, "post_id": 33402777, "comment_id": 54597303, "body": "Can you show us the entire method/action with only the relevant code?"}, {"owner": {"reputation": 37, "user_id": 1509736, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/640b434ae1b7b7249f30bb58c86bb8d9?s=128&d=identicon&r=PG", "display_name": "aamir", "link": "https://stackoverflow.com/users/1509736/aamir"}, "reply_to_user": {"reputation": 5261, "user_id": 858757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMQgQ.png?s=128&g=1", "display_name": "Silvermind", "link": "https://stackoverflow.com/users/858757/silvermind"}, "edited": false, "score": 0, "creation_date": 1446099156, "post_id": 33402777, "comment_id": 54605299, "body": "Basically, I am extending the MediaTypeFormatter and in the class overriding the  public virtual Task&lt;object&gt; ReadFromStreamAsync(Type type, Stream readStream, HttpContent content, IFormatterLogger formatterLogger, CancellationToken cancellationToken);  The very first line is content.ReadAsStringAsync() where i see the above mentioned exception."}, {"owner": {"reputation": 5261, "user_id": 858757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMQgQ.png?s=128&g=1", "display_name": "Silvermind", "link": "https://stackoverflow.com/users/858757/silvermind"}, "edited": false, "score": 0, "creation_date": 1446109027, "post_id": 33402777, "comment_id": 54609894, "body": "You should provide a simple but working example which you can edit into your question. I am missing the <code>await</code> operator in your comment: <code>await content.ReadAsStringAsync();</code>"}], "owner": {"reputation": 37, "user_id": 1509736, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/640b434ae1b7b7249f30bb58c86bb8d9?s=128&d=identicon&r=PG", "display_name": "aamir", "link": "https://stackoverflow.com/users/1509736/aamir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1661, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446071812, "creation_date": 1446071812, "question_id": 33402777, "link": "https://stackoverflow.com/questions/33402777/httpcontent-readasstringasync-throws-exception-the-i-o-operation-has-been-abort", "title": "HttpContent.ReadAsStringAsync throws exception &quot;The I/O operation has been aborted because of either a thread exit or an application request&quot;", "body": "<p>Upon receiving the request on the service side, I always retrieve the content by calling ReadAsStringAsync on the HttpContent object. From the service logs I can see that many times on line HttpContent.ReadAsStringAsync, the service raises following exception</p>\n\n<p>System.Net.Http.HttpRequestException: Error while copying content to a stream. ---> System.IO.IOException ---> System.Net.HttpListenerException: The I/O operation has been aborted because of either a thread exit or an application request</p>\n\n<p>Does anyone know why would I see this exception? and how to resolve this?</p>\n\n<p>thx</p>\n"}, {"tags": ["javascript", "c#", "asp.net-mvc-5", "typescript"], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 5465199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a480ff9620f8de233298dfb8a81a36b?s=128&d=identicon&r=PG&f=1", "display_name": "amg-argh", "link": "https://stackoverflow.com/users/5465199/amg-argh"}, "is_accepted": true, "score": 3, "last_activity_date": 1446072205, "creation_date": 1446072205, "answer_id": 33402852, "question_id": 33402755, "link": "https://stackoverflow.com/questions/33402755/block-scoped-declarations-typescript-and-asp-net-mvc-5/33402852#33402852", "title": "Block-scoped declarations ... TypeScript and Asp.net MVC 5", "body": "<p>Url.Content only transforms a relative path to an absolute one. It won't be changing the file extension.</p>\n\n<p>The browser can't read your .ts file (hence that error, as it doesn't understand TypeScript syntax). Change the file extension to the compiled .js file:</p>\n\n<pre><code>@section scripts{\n   &lt;script src=\"@Url.Content(\"~/Scripts/app.js\")\"&gt;&lt;/script&gt;\n}\n</code></pre>\n"}], "owner": {"reputation": 2141, "user_id": 3406718, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/086e335e5d643fdfd8c22feaa7e78b98?s=128&d=identicon&r=PG&f=1", "display_name": "Taras Kovalenko", "link": "https://stackoverflow.com/users/3406718/taras-kovalenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 33402852, "answer_count": 1, "score": 0, "last_activity_date": 1446072205, "creation_date": 1446071682, "question_id": 33402755, "link": "https://stackoverflow.com/questions/33402755/block-scoped-declarations-typescript-and-asp-net-mvc-5", "title": "Block-scoped declarations ... TypeScript and Asp.net MVC 5", "body": "<p>I try use in my asp.net mvc5 project TypeScript. I create app.ts file and install nuget-package\n<strong>jquery.TypeScript.DefinitelyTyped</strong>.\napp.ts code:</p>\n\n<pre><code>/// &lt;reference path=\"typings/jquery/jquery.d.ts\"/&gt;\n\nclass TestClass {\n    test(): void {\n        alert(\"Taras TS\");\n    }\n}\n\nwindow.onload = () =&gt; {\n    var tcs: TestClass = new TestClass();\n    $('#taras').click(() =&gt; { tcs.test() });\n};\n</code></pre>\n\n<p>It's very simple code. And after it I create index.cshtml file, where created some button with <strong>id='taras'</strong>, code:</p>\n\n<pre><code>@{\n    ViewBag.Title = \"tmp\";\n}\n\n&lt;button id=\"taras\"&gt; TS EVENT &lt;/button&gt;\n\n@section scripts{\n    &lt;script src=\"@Url.Content(\"~/Scripts/app.ts\")\"&gt;&lt;/script&gt;\n}\n</code></pre>\n\n<p>I think it is healthy code, but I catch next exception in google chrome debug console:</p>\n\n<blockquote>\n  <p>app.ts:3 Uncaught SyntaxError: Block-scoped declarations (let, const,\n  function, class) not yet supported outside strict mode</p>\n</blockquote>\n\n<p>Why it happens? And how to fix it, thanks a lot.</p>\n"}, {"tags": ["c#", "xml"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446071717, "post_id": 33402728, "comment_id": 54596934, "body": "do a simple google search then <code>C# Load XML into memory and change attribute</code>"}, {"owner": {"reputation": 2479, "user_id": 808891, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4ef6345606ee0f7253d351ff569ee33e?s=128&d=identicon&r=PG", "display_name": "Somebody", "link": "https://stackoverflow.com/users/808891/somebody"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446071885, "post_id": 33402728, "comment_id": 54596997, "body": "@MethodMan did you read my question, is a bit different to the ones I&#39;ve found on google."}, {"owner": {"reputation": 13143, "user_id": 69527, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/215056e1d2d4b5ce5f5837c445dba4d5?s=128&d=identicon&r=PG", "display_name": "CoderDennis", "link": "https://stackoverflow.com/users/69527/coderdennis"}, "edited": false, "score": 1, "creation_date": 1446071942, "post_id": 33402728, "comment_id": 54597023, "body": "What do you want the xml to look like after the change? It&#39;s not clear to me from your question. Also, what are you going to do with it after the change?"}], "answers": [{"comments": [{"owner": {"reputation": 4600, "user_id": 463206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4edc6d888e98324130d6de9ff0f37f8?s=128&d=identicon&r=PG&f=1", "display_name": "radarbob", "link": "https://stackoverflow.com/users/463206/radarbob"}, "edited": false, "score": 0, "creation_date": 1446072687, "post_id": 33402861, "comment_id": 54597330, "body": "Hmm. That seem to beat iterating the <code>XDocument.XElement.Attributes()</code>. Probably lots faster too."}], "tags": [], "owner": {"reputation": 13143, "user_id": 69527, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/215056e1d2d4b5ce5f5837c445dba4d5?s=128&d=identicon&r=PG", "display_name": "CoderDennis", "link": "https://stackoverflow.com/users/69527/coderdennis"}, "is_accepted": true, "score": 1, "last_activity_date": 1446072245, "creation_date": 1446072245, "answer_id": 33402861, "question_id": 33402728, "link": "https://stackoverflow.com/questions/33402728/load-xml-into-memory-and-change-attribute-wherever-found-using-c/33402861#33402861", "title": "Load XML into memory and change attribute wherever found using c#", "body": "<p>You don't need to worry about the fact that it's xml. Just load it as a string and use the <a href=\"https://msdn.microsoft.com/en-us/library/fk49wtc1(v=vs.110).aspx\" rel=\"nofollow\">string.Replace</a> method.</p>\n"}], "owner": {"reputation": 2479, "user_id": 808891, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4ef6345606ee0f7253d351ff569ee33e?s=128&d=identicon&r=PG", "display_name": "Somebody", "link": "https://stackoverflow.com/users/808891/somebody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 33402861, "answer_count": 1, "score": 1, "last_activity_date": 1446072245, "creation_date": 1446071583, "last_edit_date": 1446072066, "question_id": 33402728, "link": "https://stackoverflow.com/questions/33402728/load-xml-into-memory-and-change-attribute-wherever-found-using-c", "title": "Load XML into memory and change attribute wherever found using c#", "body": "<p>I have bellow xml template file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Root&gt;\n  &lt;Items&gt;\n    &lt;TextItem Name=\"\" Text=\"_Brand\" Font=\"\" /&gt;\n    &lt;TextItem Name=\"\" Text=\"_Model\" Font=\"\" /&gt;\n    &lt;BarcodeItem Name=\"\" Symbology=\"Code128\" Code=\"_Brand\" /&gt;\n    &lt;BarcodeItem Name=\"\" Symbology=\"Code128\" Code=\"_Model\" /&gt;\n  &lt;/Items&gt;\n&lt;/Root&gt;\n</code></pre>\n\n<p>I need to change some attributes from the template file in memory to avoid changing the physical file. The attributes to change will be defined by the <code>_Brand</code> and <code>_Model</code> variables.</p>\n\n<p>The idea is to change the <code>_Brand</code> <em>wherever found</em> by let's say: AA and <code>_Model</code> <em>wherever found</em> by BB</p>\n\n<p>I only know that I can load the xml file using either <code>XDocument</code> or <code>XmlTextReader</code> but I don't know how to do the rest.</p>\n\n<p>This should be the xml output:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Root&gt;\n  &lt;Items&gt;\n    &lt;TextItem Name=\"\" Text=\"AA\" Font=\"\" /&gt;\n    &lt;TextItem Name=\"\" Text=\"BB\" Font=\"\" /&gt;\n    &lt;BarcodeItem Name=\"\" Symbology=\"Code128\" Code=\"AA\" /&gt;\n    &lt;BarcodeItem Name=\"\" Symbology=\"Code128\" Code=\"BB\" /&gt;\n  &lt;/Items&gt;\n&lt;/Root&gt;\n</code></pre>\n"}, {"tags": ["c#", "linq", "entity-framework-6", "entity", "entity-framework-6.1"], "comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1446074297, "post_id": 33402718, "comment_id": 54598013, "body": "If you want Product.Code, why not query Product only (with a select of Code of course)"}], "owner": {"reputation": 131, "user_id": 4148561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/284efabac12666d7d26a6e4a3331d62f?s=128&d=identicon&r=PG&f=1", "display_name": "Phillsta", "link": "https://stackoverflow.com/users/4148561/phillsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446072143, "creation_date": 1446071531, "last_edit_date": 1446072143, "question_id": 33402718, "link": "https://stackoverflow.com/questions/33402718/selecting-columns-the-include-path-expression-must-refer-to-a-navigation-proper", "title": "Selecting Columns: The Include path expression must refer to a navigation property defined on the type", "body": "<p>I need some help with an optimisation of a lambda expression.</p>\n\n<p><strong>Entities</strong></p>\n\n<pre><code>    public class ProductGroup \n    {\n\n        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n        [Key]\n        public int Id { get; set; }\n\n        [Required]\n        [Index(IsUnique = true)]\n        [StringLength(50)]\n        public string Code { get; set; }\n\n        [Required]\n        [StringLength(50)]\n        public string Name { get; set; }\n\n        public virtual ICollection&lt;GroupProduct&gt; GroupProducts { get; set; }\n\n    }\n\n    public class GroupProduct \n    {\n\n            [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n            [Key]\n            public int Id { get; set; }\n\n            // Foreign Key\n            public int ProductGroupId { get; set; }\n            public int ProductId { get; set; }\n\n            // Navigation Properties\n            [Required]\n            [ForeignKey(\"ProductGroupId\")]\n            public virtual ProductGroup ProductGroup { get; set; }\n\n            [Required]\n            [ForeignKey(\"ProductId\")]\n            public virtual Product Product { get; set; }    \n        }\n\n    public class Product\n        {\n\n            [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n            [Key]\n            public int Id { get; set; }\n\n            [Required]\n            [Index(IsUnique = true)]\n            [StringLength(50)]\n            public string Code { get; set; }\n\n            [Required]\n            [StringLength(100)]\n            public string Name{ get; set; }\n    }\n</code></pre>\n\n<p><strong>Expression Currently Used</strong></p>\n\n<pre><code>var q = context.ProductGroups.Where(s =&gt; s.Code == code)\n            .Include(s =&gt; s.GroupProduct.Select(p =&gt; p.Product));\n</code></pre>\n\n<p>There are a lot more columns in the <code>Product</code> Entity. What I'm trying to do optimise the expression so when the SQL is generated on the <code>Product.Code</code> column is selected and not the entire <code>Product</code> table, along with the Related GroupProduct, and the owning ProductGroup.</p>\n\n<p>When I try and \"Filter\" the Product entity I get a error: </p>\n\n<blockquote>\n  <p>The Include path expression must refer to a navigation\n  property defined on the type. Use dotted paths for reference\n  navigation properties and the Select operator for collection\n  navigation properties. Parameter name: path</p>\n</blockquote>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c#", "hibernate", "caching", "nhibernate", "future"], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 1619238, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/46wxy.jpg?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/1619238/vlad"}, "is_accepted": true, "score": 0, "last_activity_date": 1468413721, "creation_date": 1468413721, "answer_id": 38352072, "question_id": 33402699, "link": "https://stackoverflow.com/questions/33402699/why-futures-are-not-cached-in-session-1st-level-cache/38352072#38352072", "title": "Why futures are not cached in session 1st level cache?", "body": "<p>The only correct way of using futures for loading entity with collections is with <code>Fetch</code> which means joins for each query:</p>\n\n<pre><code>  var q = session.Query&lt;User&gt;().Where(x =&gt; x.Id == id);\n\n    var lst = new List&lt;IEnumerable&gt;\n    {\n        q.FetchMany(x =&gt; x.Characters).ToFuture(),\n        q.Fetch(x=&gt;x.UpdateableData).ToFuture(),\n        session.QueryOver&lt;User&gt;().Where(x =&gt; x.Id == id)\n            .Fetch(x=&gt;x.Characters).Eager\n            .Fetch(x =&gt; x.Characters.First().SmartChallengeTrackers).Eager\n            .Future()\n    };\n\n    var r = session.QueryOver&lt;User&gt;().Where(x =&gt; x.Id == id)\n        .TransformUsing(Transformers.DistinctRootEntity)\n        .Future();\n\n    foreach (IEnumerable el in lst)\n    {\n        foreach (object o in el)\n        {\n\n        }\n    }\n\n    return r.ToArray();\n</code></pre>\n\n<p>It's still better than join everything in a one query - NHibernate won't have to parse thousands of rows introduced by join x join x join x join...</p>\n\n<p>You can add normal select queries (without <code>Fetch</code>) to to the same batch but they won't be used for retrieving collections on another entity.</p>\n"}], "owner": {"reputation": 2538, "user_id": 1619238, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/46wxy.jpg?s=128&g=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/1619238/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 38352072, "answer_count": 1, "score": 0, "last_activity_date": 1468413721, "creation_date": 1446071442, "last_edit_date": 1446071828, "question_id": 33402699, "link": "https://stackoverflow.com/questions/33402699/why-futures-are-not-cached-in-session-1st-level-cache", "title": "Why futures are not cached in session 1st level cache?", "body": "<p>I have \"static\" readonly entities which I simply load with <code>QueryOver&lt;T&gt;().List&lt;T&gt;()</code>. All their properties are not \"lazy\". So some of them have N+1 problem.</p>\n\n<p>I tried to use <code>Future</code> to avoid N+1. But it looks like then NH considers entity properties as \"lazy\". And when I access them it even reloads entities from db one by one (leading to the same N+1 situation) despite that all entities were preloaded preliminary and should be cached in the session 1st level cache. Here is the code how I'm doing it:</p>\n\n<pre><code>        var futures = new List&lt;IEnumerable&gt;();\n        futures.Add(s.QueryOver&lt;DailyBonus&gt;().Future&lt;DailyBonus&gt;());\n        futures.Add(s.QueryOver&lt;DailyBonusChestContent&gt;().Future&lt;DailyBonusChestContent&gt;());\n        // ... other entities ...\n\n        // all queries should be sent with first enumeration\n        // but I want to ensure everything is loaded \n        // before using lazy properties\n        foreach (IEnumerable future in futures)\n        {\n            if (future.Cast&lt;object&gt;().Any(x =&gt; false)) break;\n        }\n        // now everything should be in cache, right?\n        // so I can travel the whole graph without accessing db?\n        Serializer.Serialize(ms, futures); // wow, N+1 here!          \n</code></pre>\n\n<p>I checked this behavior using hibernatingrhinos profiler.</p>\n\n<p>So what is going on wrong here?</p>\n"}, {"tags": ["c#", "compiler-errors", "event-handling"], "comments": [{"owner": {"reputation": 2851, "user_id": 3503521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d0c033ee57f9049e9c71ea6ed42062?s=128&d=identicon&r=PG", "display_name": "Vladimir Serykh", "link": "https://stackoverflow.com/users/3503521/vladimir-serykh"}, "edited": false, "score": 4, "creation_date": 1446071543, "post_id": 33402695, "comment_id": 54596865, "body": "What are you actually trying to do by this code?"}, {"owner": {"reputation": 21, "user_id": 5500427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhyKg.jpg?s=128&g=1", "display_name": "Clemente", "link": "https://stackoverflow.com/users/5500427/clemente"}, "reply_to_user": {"reputation": 2851, "user_id": 3503521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d0c033ee57f9049e9c71ea6ed42062?s=128&d=identicon&r=PG", "display_name": "Vladimir Serykh", "link": "https://stackoverflow.com/users/3503521/vladimir-serykh"}, "edited": false, "score": 0, "creation_date": 1446071873, "post_id": 33402695, "comment_id": 54596990, "body": "I&#39;m trying built some events for a Avatar morphing mesh with LOD, is for change the some items like hair, clothing."}, {"owner": {"reputation": 6063, "user_id": 3225495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/57OBG.jpg?s=128&g=1", "display_name": "BJ Myers", "link": "https://stackoverflow.com/users/3225495/bj-myers"}, "edited": false, "score": 0, "creation_date": 1446074802, "post_id": 33402695, "comment_id": 54598199, "body": "Your code defines an event called <code>OnCostumeLoad</code>, and then the first line in the <code>add</code> tries to assign the event to a variable of type <code>CostumeLOD</code>.  This makes no sense.  I don&#39;t think the <code>event</code> keyword does what you think it does."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "reply_to_user": {"reputation": 6063, "user_id": 3225495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/57OBG.jpg?s=128&g=1", "display_name": "BJ Myers", "link": "https://stackoverflow.com/users/3225495/bj-myers"}, "edited": false, "score": 0, "creation_date": 1446075323, "post_id": 33402695, "comment_id": 54598357, "body": "@BJMyers: <a href=\"https://msdn.microsoft.com/en-us/library/bb882534.aspx\" rel=\"nofollow noreferrer\">the use of the <code>event</code> keyword is fine here</a>. Most people use the auto-generated implementation the compiler provides, but one can in fact explicitly define the implementation, as in the code above."}, {"owner": {"reputation": 21, "user_id": 5500427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhyKg.jpg?s=128&g=1", "display_name": "Clemente", "link": "https://stackoverflow.com/users/5500427/clemente"}, "edited": false, "score": 0, "creation_date": 1446081445, "post_id": 33402695, "comment_id": 54600228, "body": "Yes, maybe the problem is far behind at code, need check it I will post when solve it. This morph mesh avatar is turning complicated."}, {"owner": {"reputation": 7658, "user_id": 3195477, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/PK4P1.jpg?s=128&g=1", "display_name": "StayOnTarget", "link": "https://stackoverflow.com/users/3195477/stayontarget"}, "edited": false, "score": 0, "creation_date": 1550682396, "post_id": 33402695, "comment_id": 96361637, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4496799/event-can-only-appear-on-the-left-hand-side-of-or\">-event- can only appear on the left hand side of += or -=</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5500427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhyKg.jpg?s=128&g=1", "display_name": "Clemente", "link": "https://stackoverflow.com/users/5500427/clemente"}, "edited": false, "score": 0, "creation_date": 1446079918, "post_id": 33403389, "comment_id": 54599784, "body": "public delegate void CostumeLOD(AvatarCustomization costume);"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "reply_to_user": {"reputation": 21, "user_id": 5500427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhyKg.jpg?s=128&g=1", "display_name": "Clemente", "link": "https://stackoverflow.com/users/5500427/clemente"}, "edited": false, "score": 0, "creation_date": 1446082276, "post_id": 33403389, "comment_id": 54600436, "body": "@Clemente: I&#39;m not talking about the declaration of the <code>delegate</code> type named <code>CostumeLOD</code>. I am talking about the <b><i>field</i></b> that is needed to hold the <i>state</i> of the event. Normally, the C# compiler provides this for you; when you use the automatic implementation of an event, the name you give the event is actually treated as a <i>field</i> by any code in the same class where the event is declared. If you explicitly implement the event, you have to provide that field, as I have done in the code example above in my answer, and which you have <i>not</i> done in your own code."}, {"owner": {"reputation": 21, "user_id": 5500427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhyKg.jpg?s=128&g=1", "display_name": "Clemente", "link": "https://stackoverflow.com/users/5500427/clemente"}, "edited": false, "score": 0, "creation_date": 1446083166, "post_id": 33403389, "comment_id": 54600647, "body": "Thank you Peter, I implemented the field and the compiler don&#39;t give any error. I have to do some tests to see if the events are working as I want. Appreciated the help!"}], "tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": false, "score": 0, "last_activity_date": 1446075077, "creation_date": 1446075077, "answer_id": 33403389, "question_id": 33402695, "link": "https://stackoverflow.com/questions/33402695/the-event-can-only-appear-on-the-left-hand-side-of-or/33403389#33403389", "title": "The event can only appear on the left hand side of += or -=", "body": "<p>I am unconvinced that implementing the <code>event</code> explicitly is really necessary here. You seem to be trying to make it thread-safe, but the compiler-provided implementation already does a reasonable job of that.</p>\n\n<p>That said, if you want the code to work, you need to declare your own backing field for the event. For example:</p>\n\n<pre><code>private CostumeLOD _onCostumeLOD;\npublic event CostumeLOD OnCostumeLOD\n{\n    add\n    {\n        CostumeLOD costumeLOD01 = this._onCostumeLOD;\n        CostumeLOD costumeLOD02;\n        do\n        {\n            costumeLOD02 = costumeLOD01;\n            costumeLOD01 = Interlocked.CompareExchange(ref this._onCostumeLOD, (CostumeLOD)Delegate.Combine(costumeLOD02, value), costumeLOD01);\n        }\n        while (costumeLOD01 != costumeLOD02);\n    }\n    remove\n    {\n        CostumeLOD costumeLOD01 = this._onCostumeLOD;\n        CostumeLOD costumeLOD02;\n        do\n        {\n            costumeLOD02 = costumeLOD01;\n            costumeLOD01 = Interlocked.CompareExchange(ref this._onCostumeLOD, (CostumeLOD)Delegate.Remove(costumeLOD02, value), costumeLOD01);\n        }\n        while (costumeLOD01 != costumeLOD02);\n    }\n}\n</code></pre>\n\n<p><br/>\n<em>Note: I am making no claims as to whether the above actually solves whatever thread-safety issue you are trying to address. I am simply offering advice as to how to get it to compile.</em></p>\n"}], "owner": {"reputation": 21, "user_id": 5500427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhyKg.jpg?s=128&g=1", "display_name": "Clemente", "link": "https://stackoverflow.com/users/5500427/clemente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3877, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549615878, "creation_date": 1446071422, "last_edit_date": 1446080491, "question_id": 33402695, "link": "https://stackoverflow.com/questions/33402695/the-event-can-only-appear-on-the-left-hand-side-of-or", "title": "The event can only appear on the left hand side of += or -=", "body": "<p>In Visual Studio 2015 appears a CS0079 compile error when I tried to run this code:</p>\n\n<pre><code>public delegate void CostumeLOD(AvatarCustomization costume);\n\npublic event CostumeLOD OnCostumeLOD\n        {\n            add\n            {\n                CostumeLOD costumeLOD01 = this.OnCostumeLOD;\n                CostumeLOD costumeLOD02;\n                do\n                {\n                    costumeLOD02 = costumeLOD01;\n                    costumeLOD01 = Interlocked.CompareExchange(ref this.OnCostumeLOD, (CostumeLOD)Delegate.Combine(costumeLOD02, value), costumeLOD01);\n                }\n                while (costumeLOD01 != costumeLOD02);\n            }\n            remove\n            {\n                CostumeLOD costumeLOD01 = this.OnCostumeLOD;\n                CostumeLOD costumeLOD02;\n                do\n                {\n                    costumeLOD02 = costumeLOD01;\n                    costumeLOD01 = Interlocked.CompareExchange(ref this.OnCostumeLOD, (CostumeLOD)Delegate.Remove(costumeLOD02, value), costumeLOD01);\n                }\n                while (costumeLOD01 != costumeLOD02);\n            }\n        }\n</code></pre>\n\n<p>The event \"OnCostumeLOD\" can only appear on the left hand side of <code>+=' or</code>-=' operator</p>\n\n<p>Someone can help me find a way to solve this error?</p>\n"}, {"tags": ["c#", "list", "nested-lists"], "comments": [{"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 1, "creation_date": 1446072345, "post_id": 33402633, "comment_id": 54597218, "body": "Are the properties known at compile time? (Do we know that the end result will have <code>id</code> <code>item</code> <code>name</code> and <code>color</code>?) Or can they be any properties? And if so, what happens with collisions (two objects have the same property name but different value) ?"}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1446076846, "post_id": 33402908, "comment_id": 54598845, "body": "ah, yes, that&#39;s what i&#39;m after is a join. i wasn&#39;t aware you could do this inside C#. i thought that was only a SQL thing."}, {"owner": {"reputation": 13062, "user_id": 1464084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e33614e1c697bd6eedeeff7172cf22e?s=128&d=identicon&r=PG", "display_name": "Moho", "link": "https://stackoverflow.com/users/1464084/moho"}, "reply_to_user": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1446078921, "post_id": 33402908, "comment_id": 54599485, "body": "Look up some tutorials on LINQ"}], "tags": [], "owner": {"reputation": 13062, "user_id": 1464084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e33614e1c697bd6eedeeff7172cf22e?s=128&d=identicon&r=PG", "display_name": "Moho", "link": "https://stackoverflow.com/users/1464084/moho"}, "is_accepted": true, "score": 1, "last_activity_date": 1446072493, "creation_date": 1446072493, "answer_id": 33402908, "question_id": 33402633, "link": "https://stackoverflow.com/questions/33402633/how-to-set-properties-of-a-listclass-in-c/33402908#33402908", "title": "How to set properties of a List&lt;Class&gt; in C#", "body": "<p>Inner join with projection:</p>\n\n<pre><code>var list = from l1 in LIST1\n    join l2 in LIST2 on l1.ID equals l2.ID\n    select new {\n        l1.ID,\n        l1.Item,\n        l1.Name,\n        l2.Color\n    }\n    .ToList()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1446076780, "post_id": 33403621, "comment_id": 54598823, "body": "with <code>Enumerable.Zip()</code> must the elements be in the same order? i&#39;m also not clear how this would work on multidimensional arrays..."}, {"owner": {"reputation": 123, "user_id": 3788844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b4d851dae6f46216744098c86aafcf?s=128&d=identicon&r=PG&f=1", "display_name": "gadeweever", "link": "https://stackoverflow.com/users/3788844/gadeweever"}, "reply_to_user": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1446089416, "post_id": 33403621, "comment_id": 54602291, "body": "Zip will zip them together in order so you would have to know their order before hand. If you wanted multidimensionality i.e triplets and n-tuples, you would just chain a zips onto other. However, your example is with classes, not with n-dimensional arrays, so I am wondering what you mean by multidimensionality."}], "tags": [], "owner": {"reputation": 123, "user_id": 3788844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16b4d851dae6f46216744098c86aafcf?s=128&d=identicon&r=PG&f=1", "display_name": "gadeweever", "link": "https://stackoverflow.com/users/3788844/gadeweever"}, "is_accepted": false, "score": 1, "last_activity_date": 1446076473, "creation_date": 1446076473, "answer_id": 33403621, "question_id": 33402633, "link": "https://stackoverflow.com/questions/33402633/how-to-set-properties-of-a-listclass-in-c/33403621#33403621", "title": "How to set properties of a List&lt;Class&gt; in C#", "body": "<p>Without knowing exactly what your goal is, the Zip function acts on two lists and returns the product of those two lists. You can read about it more here:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/vstudio/dd267698(v=vs.100).aspx\" rel=\"nofollow\">Zip on MSDN</a></p>\n\n<p>But in effect, if you have two lists of things, lets say:</p>\n\n<pre><code>int[] numbers = { 1, 2, 3, 4 };\nstring[] words = { \"one\", \"two\", \"three\" };\n// The following example concatenates corresponding elements of the\n// two input sequences.\nvar numbersAndWords = numbers.Zip(words, (first, second) =&gt; first + \" \" + second);\n</code></pre>\n\n<p>So in your case it might be something like this:</p>\n\n<pre><code>Response2[] response2 = //some list\nResponse3[] response3= // some other list\nvar response2Andresponse3 = response2.Zip(response3, (res2,res3) =&gt; //something you want to do with them\n</code></pre>\n\n<p>This will pair the first element of response2 with the first element of response3 and so on. We are also assuming here that they have the same length so that you don't have unpaired attributes.</p>\n\n<p>You'll have to figure out a way to pipe this out to something you might find useful, but you will have a list where they correspond element by element.</p>\n"}], "owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 33402908, "answer_count": 2, "score": 0, "last_activity_date": 1446076473, "creation_date": 1446071079, "question_id": 33402633, "link": "https://stackoverflow.com/questions/33402633/how-to-set-properties-of-a-listclass-in-c", "title": "How to set properties of a List&lt;Class&gt; in C#", "body": "<p>I have a class defined as such:</p>\n\n<pre><code>[DataContract]\npublic class Response2\n{\n    [DataMember(Name = \"done\")]\n    public bool done;\n    [DataMember(Name = \"records\")]\n    public List&lt;Response3&gt; r3entry;\n}\n\n[DataContract]\npublic class Response3\n{\n    [DataMember(Name = \"Id\")]\n    public string strId { get; set; }\n    [DataMember(Name = \"Name\")]\n    public string strName { get; set; }\n}\n</code></pre>\n\n<p>Now, what I'd like to happen is take the values from ANOTHER class and populate... something like this:</p>\n\n<pre><code>string propertyRequest2 = CreatePropertyRequest2();\nResponse2 propResponse2 = MakeRequest2(propertyRequest2, sfToken);\n\nList&lt;Response&gt; listAllData = new List&lt;Response&gt;();\n\nforeach (var responseEntry in propResponse2.r3entry)\n{\n    listAllData.Add(new Response() { strId = responseEntry.strId, strName = responseEntry.strName } );\n\n    // NOTE .strId IS ALWAYS UNIQUE IN BOTH CLASSES\n    // - I know this is NOT the right syntax... will fix later.\n    Where listAllData.strId = responseEntry.strId\n    {\n        listAllData.property = propertyResponse2(.strId=responseEntry.strId).property\n    }\n}\n</code></pre>\n\n<p>I'm sure (at least) the last bit of the code is painful to most people reading this, but I will fix so it's not so terrible. I just don't know if explaining it is as clear.  Just in case I'm wrong, the point here is more like this:</p>\n\n<pre><code>// WE HAVE A LIST OF CLASSES WITH PROPERTIES\n// ASSUME PROPERTIES ARE ID, ITEM, NAME\nLIST1 = { (\"1\", \"A\", \"APPLE\"), (\"2\", \"B\", \"BANANA\"), (\"3\", \"C\", \"COCONUT\")}\n\n// NOW WE HAVE ANOTHER LIST THAT HAS THE SAME ID BUT DIFF DATA\n// ASSUME PROPERTIES ARE ID, COLOR\nLIST2 = { (\"1\", \"RED\"), (\"2\", \"YELLOW\"), (\"3\", \"BROWN) }\n\n// AND THEN I WANT TO CREATE A NEW LIST WITH BOTH SETS OF DATA COMBINED\n// ASSUME PROPERTIES ARE ID, ITEM, NAME, COLOR\nLIST3 = { (\"1\", \"A\", \"APPLE\", \"RED\"), (\"2\", \"B\", \"BANANA\"), (\"3\", \"C\", \"COCONUT\", \"BROWN\") }\n</code></pre>\n\n<p>Any ideas on how to do this?</p>\n"}, {"tags": ["c#", "expression-trees"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 2, "creation_date": 1446071191, "post_id": 33402613, "comment_id": 54596729, "body": "Sure you can, just replace the expression to create an instance with an expression to use an existing instance.  What problems are you having doing that?  Also please include all of the relevant details <i>in the question itself</i>.  People shouldn&#39;t have to read the link to understand your question."}, {"owner": {"reputation": 4885, "user_id": 3395015, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4uXL2.png?s=128&g=1", "display_name": "garryp", "link": "https://stackoverflow.com/users/3395015/garryp"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446071489, "post_id": 33402613, "comment_id": 54596848, "body": "Thanks for the reply Servy. What is the syntax to do that?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1446071648, "post_id": 33402613, "comment_id": 54596906, "body": "It&#39;s the same as the syntax for creating an expression based on any other value that you have, which is showcased right in the article that you referenced."}], "answers": [{"comments": [{"owner": {"reputation": 4885, "user_id": 3395015, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4uXL2.png?s=128&g=1", "display_name": "garryp", "link": "https://stackoverflow.com/users/3395015/garryp"}, "edited": false, "score": 0, "creation_date": 1446072011, "post_id": 33402749, "comment_id": 54597060, "body": "Thank you. That&#39;s exactly what I was looking for."}], "tags": [], "owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "is_accepted": true, "score": 2, "last_activity_date": 1446071667, "creation_date": 1446071667, "answer_id": 33402749, "question_id": 33402613, "link": "https://stackoverflow.com/questions/33402613/expression-new-but-i-already-have-an-object/33402749#33402749", "title": "Expression.New(..) - but I already have an object", "body": "<p>You can do this:</p>\n\n<pre><code>public class SampleClass\n{\n    public int AddIntegers(int a, int b)\n    {\n        return a + b;\n    }\n}\n\nvar sampleClass = new SampleClass();\nExpression callExpr = Expression.Call(\n    Expression.Constant(sampleClass),\n    typeof(SampleClass).GetMethod(\"AddIntegers\", new Type[] { typeof(int), typeof(int) }),\n    Expression.Constant(1),\n    Expression.Constant(2)\n    );\n</code></pre>\n"}], "owner": {"reputation": 4885, "user_id": 3395015, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4uXL2.png?s=128&g=1", "display_name": "garryp", "link": "https://stackoverflow.com/users/3395015/garryp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 33402749, "answer_count": 1, "score": 0, "last_activity_date": 1446071667, "creation_date": 1446070972, "last_edit_date": 1446071584, "question_id": 33402613, "link": "https://stackoverflow.com/questions/33402613/expression-new-but-i-already-have-an-object", "title": "Expression.New(..) - but I already have an object", "body": "<p>Looking at expression trees in C# and was reading <a href=\"https://msdn.microsoft.com/en-us/library/dd402755(v=vs.110).aspx\" rel=\"nofollow\">this article</a>.</p>\n\n<pre><code>// Add the following directive to your file:\n// using System.Linq.Expressions;  \npublic class SampleClass\n{\n    public int AddIntegers(int arg1, int arg2)\n    {\n        return arg1 + arg2;\n    }\n}\n\nstatic public void TestCall()\n{\n    // This expression represents a call to an instance method that has two arguments.\n    // The first argument is an expression that creates a new object of the specified type.\n    Expression callExpr = Expression.Call(\n        Expression.New(typeof(SampleClass)),\n        typeof(SampleClass).GetMethod(\"AddIntegers\", new Type[] { typeof(int), typeof(int) }),\n        Expression.Constant(1),\n        Expression.Constant(2)\n        );\n\n    // Print out the expression.\n    Console.WriteLine(callExpr.ToString());\n\n    // The following statement first creates an expression tree,\n    // then compiles it, and then executes it.\n    Console.WriteLine(Expression.Lambda&lt;Func&lt;int&gt;&gt;(callExpr).Compile()());\n\n    // This code example produces the following output:\n    //\n    // new SampleClass().AddIntegers(1, 2)\n    // 3\n}\n</code></pre>\n\n<p>I want to do something almost identical to this, except I don't want to create a new instance of <code>SampleClass</code> - I already have an instance, I just want to invoke a method on it.</p>\n\n<p>The code essentially does this:</p>\n\n<pre><code>new SampleClass().AddIntegers(1, 2)\n</code></pre>\n\n<p>...using expression trees; however, I want to do this:</p>\n\n<pre><code>sampleClassInstance.AddIntegers(1, 2)\n</code></pre>\n\n<p>Is this something I can do, or should I just stick with reflection for this?</p>\n"}, {"tags": ["c#", "wpf", "mvvm", "mvvm-light"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user57508"}, "edited": false, "score": 0, "creation_date": 1446070872, "post_id": 33402508, "comment_id": 54596615, "body": "as a side-note, and if I remember correctly: PropertyChanged.Fody detects such dependencies and adds automatic triggering of all connected properties ... I prefer weaving over manually coding anyway ..."}, {"owner": {"reputation": 1521, "user_id": 1405500, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ef69fb9d88417454432fef78954caf5?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/1405500/jake"}, "edited": false, "score": 0, "creation_date": 1446070977, "post_id": 33402508, "comment_id": 54596649, "body": "@AndreasNiedermair, is <a href=\"https://github.com/Fody/PropertyChanged\" rel=\"nofollow noreferrer\">this</a> what you&#39;re talking about?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user57508"}, "edited": false, "score": 0, "creation_date": 1446071097, "post_id": 33402508, "comment_id": 54596693, "body": "? there&#39;s something missing I guess. Anyway, you can find a rough overview at <a href=\"https://github.com/Fody/PropertyChanged/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/Fody/PropertyChanged/blob/master/README.md</a>"}], "owner": {"reputation": 1521, "user_id": 1405500, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1ef69fb9d88417454432fef78954caf5?s=128&d=identicon&r=PG", "display_name": "Jake", "link": "https://stackoverflow.com/users/1405500/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446070349, "creation_date": 1446070349, "question_id": 33402508, "link": "https://stackoverflow.com/questions/33402508/requerying-other-bindings-when-another-binding-changes", "title": "Requerying other bindings when another binding changes", "body": "<p><strong>tl;dr:</strong><br/>\nWhat is the 'correct' way to requery bindings when another binding has changed?</p>\n\n<p><strong>Context:</strong><br/>\nI'm developing an MVVM application that looks and behaves similar to MS Access. (Ribbon + tabbed interface).</p>\n\n<p>Basically, when a certain tab (viewmodel) is selected, I need certain contextual tabs to be displayed. I have a number of properties in my view model which determine if a set of contexual tabs is visible or not. As an example. I'd want the contextual tabs for ViewModel1 to show, when ViewModel1 is the 'selected' viewmodel, so I have this property in my view model.</p>\n\n<pre><code>public bool ViewModel1Active\n{\n    get { return (selectedWorkspace is ViewModel1); }\n    set { Set(ref viewModel1Active, value); }\n}\n</code></pre>\n\n<p>I also have a separate property which is bound to the selected view model:</p>\n\n<pre><code>public WorkspaceViewModel SelectedWorkspace\n{\n    get { return selectedWorkspace; }\n    set { Set(ref selectedWorkspace, value); }\n}\n</code></pre>\n\n<p>My theory is that when the set accessor is called on <code>SelectedWorkspace</code>, I requery all of the bindings for the contextual tabs:</p>\n\n<pre><code>public WorkspaceViewModel SelectedWorkspace\n{\n    get { return selectedWorkspace; }\n    set { Set(ref selectedWorkspace, value); RefreshContextualTabs(); }\n}\n\nvoid RefreshContextualTabs()\n{\n    RaisePropertyChanged(\"ViewModel1IsActive\");\n    RaisePropertyChanged(\"ViewModel2IsActive\");\n   // etc.\n}\n</code></pre>\n\n<p>Which should show the correct set of tabs when the viewmodel is selected</p>\n\n<p>Is there a better way to approach this?</p>\n\n<p>Libraries being used: MVVMLight and FluentRibbon</p>\n"}, {"tags": ["c#", "unity3d"], "answers": [{"tags": [], "owner": {"reputation": 10414, "user_id": 1251354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/650becb7843763fb2a7e8f7135d9ef5e?s=128&d=identicon&r=PG", "display_name": "rutter", "link": "https://stackoverflow.com/users/1251354/rutter"}, "is_accepted": false, "score": 0, "last_activity_date": 1446070608, "creation_date": 1446070608, "answer_id": 33402556, "question_id": 33402428, "link": "https://stackoverflow.com/questions/33402428/unity-game-object-not-in-correct-position/33402556#33402556", "title": "Unity game object not in correct position", "body": "<p><code>position</code> specifies an object's location in the world. If you take two objects and assign the same <code>position</code>, then they will both be in the same place.</p>\n\n<p><code>localPosition</code> specifies an object's location relative to its parent. If you take two objects and assign the same <code>localPosition</code>, the outcome will depend on the position of each object's parent. If they have different parents, different scaling, or different rotation, they may end up in different places.</p>\n\n<p>Roughly the same idea applies to <code>rotation</code> and <code>localRotation</code>.</p>\n\n<p>You seem to have confused the relationship between world-space and local-space coordinates. It's very important to understand the difference, and how they relate to the scene hierarchy.</p>\n\n<p>If you want to put both objects in the same place, this should suffice:</p>\n\n<pre><code>transform.position = seat.transform.position;\ntransform.rotation = seat.transform.rotation;\n</code></pre>\n\n<p>If you want the object to move with the car, afterward, you could also reassign its parent:</p>\n\n<pre><code>transform.parent = seat.transform.parent;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1584, "user_id": 4698599, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cb74bfec29d1aa195b6b14b6dc73040f?s=128&d=identicon&r=PG", "display_name": "Burak Karasoy", "link": "https://stackoverflow.com/users/4698599/burak-karasoy"}, "is_accepted": false, "score": 0, "last_activity_date": 1446072383, "creation_date": 1446072383, "answer_id": 33402886, "question_id": 33402428, "link": "https://stackoverflow.com/questions/33402428/unity-game-object-not-in-correct-position/33402886#33402886", "title": "Unity game object not in correct position", "body": "<p>Check your player object's pivot point.It might not be on position you expect.If it is not, try to make it point where you want by dragging your model.</p>\n"}], "owner": {"reputation": 27, "user_id": 5199516, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cd400bdad901118e210e1523a71e74df?s=128&d=identicon&r=PG&f=1", "display_name": "user5199516", "link": "https://stackoverflow.com/users/5199516/user5199516"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1584, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446072383, "creation_date": 1446069962, "question_id": 33402428, "link": "https://stackoverflow.com/questions/33402428/unity-game-object-not-in-correct-position", "title": "Unity game object not in correct position", "body": "<p>I'm making a unity 3D game, part of the game allows the player to get into a car and drive it.</p>\n\n<p>Inside the car I have put a \"seat\" GameObject whose position and rotation is used to determine where the player will sit.</p>\n\n<p>When I want the player to sit in the car, I make the car the players parent, then set the player transform position and rotation to that of the seat.</p>\n\n<p>Here is the C# code</p>\n\n<pre><code> // make player's parent the same as the seats parent (which is the car)\n transform.parent = seat.transform.parent;\n\n // put player in the exact position and rotation as the seat\n animator.transform.position = transform.position = seat.transform.position;\n animator.transform.rotation = transform.rotation = seat.transform.rotation;\n\n animator.transform.localPosition = transform.localPosition = seat.transform.localPosition;\n animator.transform.localRotation = transform.localRotation = seat.transform.localRotation;\n</code></pre>\n\n<p>This seems like it should work, but what ends up happenning is that for some reason the player does not end up perfectly in the seat, but some short distance away from it, and also the players rotation doesnt match the seat, instead ends up slightly off. So the player looks like he is not really in the seat but floating near it, and turned around in some other direction.</p>\n\n<p>Anybody knows what I'm doing wrong?</p>\n"}, {"tags": ["c#", "mysql"], "comments": [{"owner": {"reputation": 1405, "user_id": 2512859, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e975b8b9c2801749a16009a8cebfd369?s=128&d=identicon&r=PG", "display_name": "Bxx", "link": "https://stackoverflow.com/users/2512859/bxx"}, "edited": false, "score": 1, "creation_date": 1446070019, "post_id": 33402419, "comment_id": 54596279, "body": "You normally just open it once, then do all your queries. No need to open it multiple times."}, {"owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 3, "creation_date": 1446070192, "post_id": 33402419, "comment_id": 54596344, "body": "&quot;using&quot; is the correct way to handle objects that implement <a href=\"https://msdn.microsoft.com/en-us/library/3bwa4xa9%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">IDisposable</a>."}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1446070277, "post_id": 33402419, "comment_id": 54596373, "body": "See <a href=\"http://dev.mysql.com/doc/connector-net/en/connector-net-programming-connection-pooling.html\" rel=\"nofollow noreferrer\">Connection Pooling in MySql</a>"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "reply_to_user": {"reputation": 1405, "user_id": 2512859, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e975b8b9c2801749a16009a8cebfd369?s=128&d=identicon&r=PG", "display_name": "Bxx", "link": "https://stackoverflow.com/users/2512859/bxx"}, "edited": false, "score": 2, "creation_date": 1446070526, "post_id": 33402419, "comment_id": 54596481, "body": "@Bxx No - connections are pooled in .NET, so creating one isn&#39;t an expensive process.  Keeping a connection open for long periods can cause issues, though."}], "answers": [{"comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446070666, "post_id": 33402459, "comment_id": 54596538, "body": "this is not an answer also <code>using</code> takes care of auto-disposing"}], "tags": [], "owner": {"reputation": 1039, "user_id": 5020152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb59ef74a06d62ddf2602d22f74cd02?s=128&d=identicon&r=PG&f=1", "display_name": "FirebladeDan", "link": "https://stackoverflow.com/users/5020152/firebladedan"}, "is_accepted": false, "score": 0, "last_activity_date": 1446070143, "creation_date": 1446070143, "answer_id": 33402459, "question_id": 33402419, "link": "https://stackoverflow.com/questions/33402419/using-on-mysql-connection/33402459#33402459", "title": "&#39;using&#39; on mysql connection", "body": "<p>Nope! Just make sure the logic you're using is within that using block. It will be connected to and disposed of correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 897, "user_id": 747609, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16223c3aff8f1a7c324d81d877639308?s=128&d=identicon&r=PG", "display_name": "IROEGBU", "link": "https://stackoverflow.com/users/747609/iroegbu"}, "is_accepted": false, "score": 0, "last_activity_date": 1446070408, "creation_date": 1446070408, "answer_id": 33402521, "question_id": 33402419, "link": "https://stackoverflow.com/questions/33402419/using-on-mysql-connection/33402521#33402521", "title": "&#39;using&#39; on mysql connection", "body": "<p>This should open your connection and dispose it properly at the end of the <code>using</code> block.</p>\n\n<pre><code>using (SqlConnection con = new SqlConnection(CNN_STRING))\n{\n    SqlCommand cmd = new SqlCommand(\"COMMAND, con);\n    //do something\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4600, "user_id": 463206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4edc6d888e98324130d6de9ff0f37f8?s=128&d=identicon&r=PG&f=1", "display_name": "radarbob", "link": "https://stackoverflow.com/users/463206/radarbob"}, "edited": false, "score": 0, "creation_date": 1446072953, "post_id": 33402578, "comment_id": 54597443, "body": "upvote. Last paragraph - ditto. I&#39;m fed up with our code -  all the <code>Open</code> and <code>Close</code>ings, especially when using <code>using</code>."}, {"owner": {"reputation": 7325, "user_id": 2359687, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b567febb6032c881398226a28bedc09c?s=128&d=identicon&r=PG", "display_name": "devlin carnate", "link": "https://stackoverflow.com/users/2359687/devlin-carnate"}, "edited": false, "score": 1, "creation_date": 1446072966, "post_id": 33402578, "comment_id": 54597448, "body": "not to mention... <a href=\"https://coding.abel.nu/2011/12/idisposable-and-using-in-c/\" rel=\"nofollow noreferrer\">orphaned connections</a>."}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": false, "score": 4, "last_activity_date": 1446070716, "creation_date": 1446070716, "answer_id": 33402578, "question_id": 33402419, "link": "https://stackoverflow.com/questions/33402419/using-on-mysql-connection/33402578#33402578", "title": "&#39;using&#39; on mysql connection", "body": "<blockquote>\n  <p>Well, if i use this the connection will be closed and opened every time, right? </p>\n</blockquote>\n\n<p>It will be <em>closed</em> automatically.  You still have to <em>open</em> it before you use it.</p>\n\n<blockquote>\n  <p>The problem is that opening the connection takes about 200ms, will it take this time every time that i try to do a query?</p>\n</blockquote>\n\n<p>You'll have to try it and measure it to know for sure, but connections are pooled in .NET, so creating one isn't an expensive process.  Whether <em>opening</em> one will take the same amount of time each time cannot be determined without trying it, since it depends on the quality of your network.</p>\n\n<p>Try it the recommended way, and if it becomes a <em>measurable</em> problem for your app overall <em>then</em> look for other solutions.</p>\n\n<p>Do NOT go to the other end of the spectrum where you keep a connection open for the life of your app.  If you do, then you constantly have to check to make sure the connection is still open (since it can be closed by other means) and can cause other issues.</p>\n"}], "owner": {"reputation": 733, "user_id": 3324670, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4dbb617bc207a6f20cee4580d6129abe?s=128&d=identicon&r=PG&f=1", "display_name": "Pau C", "link": "https://stackoverflow.com/users/3324670/pau-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1446070716, "creation_date": 1446069881, "last_edit_date": 1446070557, "question_id": 33402419, "link": "https://stackoverflow.com/questions/33402419/using-on-mysql-connection", "title": "&#39;using&#39; on mysql connection", "body": "<p>im working on a login server in c# with mysql and i've a question:\nI've seen on the internet that the correct way to use MySqlConnection and doing queries is using the \"using\" statment like this:</p>\n\n<pre><code>using (SqlConnection con = new SqlConnection(CNN_STRING))\n{\n    using (SqlCommand cmd = new SqlCommand(\"COMMAND\", con))\n    {\n        //do something\n    }\n}\n</code></pre>\n\n<p>Well, if i use this the connection will be closed and opened every time, right? The problem is that opening the connection takes about 200ms, will it take this time every time that i try to do a query? </p>\n"}, {"tags": ["c#", "git"], "answers": [{"tags": [], "owner": {"reputation": 1833, "user_id": 352826, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pEfHi.jpg?s=128&g=1", "display_name": "Francesc Castells", "link": "https://stackoverflow.com/users/352826/francesc-castells"}, "is_accepted": false, "score": 0, "last_activity_date": 1446070619, "creation_date": 1446070619, "answer_id": 33402559, "question_id": 33402408, "link": "https://stackoverflow.com/questions/33402408/visual-studio-reference-separate-git-project/33402559#33402559", "title": "Visual Studio reference separate git project", "body": "<p>I'd suggest Nuget, but you don't need a server. Nuget can work from a simple local folder. Setting it up takes one minute.\nSet up a git repo for the packages and clone it on your machines. In VS, Tools->Options->Nuget, configure a new package repository pointing to your local folder. </p>\n"}], "owner": {"reputation": 8645, "user_id": 444917, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cbf71204645a6417868c85cee85e9244?s=128&d=identicon&r=PG", "display_name": "Clay", "link": "https://stackoverflow.com/users/444917/clay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 648, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446070619, "creation_date": 1446069844, "question_id": 33402408, "link": "https://stackoverflow.com/questions/33402408/visual-studio-reference-separate-git-project", "title": "Visual Studio reference separate git project", "body": "<h1>Example</h1>\n\n<ul>\n<li>C# Project A is stored in <em>internal</em> Git Repository A</li>\n<li>C# Project B is stored in <em>internal</em> Git Repository B but references Project A</li>\n</ul>\n\n<h1>Question</h1>\n\n<p>What is a simple way for Project B to reference a Project A?</p>\n\n<h1>Options considered</h1>\n\n<ul>\n<li>Install, configure, and deploy internal NuGet server</li>\n<li>Check Project A's dll into git and use <a href=\"https://www.npmjs.com/\" rel=\"nofollow\">npm</a> since it has the <a href=\"https://docs.npmjs.com/files/package.json#git-urls-as-dependencies\" rel=\"nofollow\">ability</a> to add a dependency directly to a git url (including version)</li>\n<li>Use git submodule</li>\n<li>Use git subtree</li>\n<li>Copy Project A's dll manually into Project B</li>\n</ul>\n"}, {"tags": ["javascript", "c#", "jquery", "html", "asp.net"], "comments": [{"owner": {"reputation": 484, "user_id": 3499931, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ag9Qr.png?s=128&g=1", "display_name": "Trasiva", "link": "https://stackoverflow.com/users/3499931/trasiva"}, "edited": false, "score": 0, "creation_date": 1446070370, "post_id": 33402384, "comment_id": 54596407, "body": "So far this isn&#39;t even your code causing an issue, this is your web.config configuration being unhappy. Have you verified all of your connection info? According to <a href=\"http://stackoverflow.com/a/16988949/3499931\">this answer</a>, you need to set <code>Copy Local = true</code>."}, {"owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "reply_to_user": {"reputation": 484, "user_id": 3499931, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ag9Qr.png?s=128&g=1", "display_name": "Trasiva", "link": "https://stackoverflow.com/users/3499931/trasiva"}, "edited": false, "score": 0, "creation_date": 1446071653, "post_id": 33402384, "comment_id": 54596908, "body": "Where do I write that at? Are you (and they) talking about doing this: <a href=\"https://msdn.microsoft.com/en-us/library/t1zz5y8c(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/t1zz5y8c(v=vs.90).aspx</a> ?"}, {"owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "reply_to_user": {"reputation": 484, "user_id": 3499931, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ag9Qr.png?s=128&g=1", "display_name": "Trasiva", "link": "https://stackoverflow.com/users/3499931/trasiva"}, "edited": false, "score": 0, "creation_date": 1446079422, "post_id": 33402384, "comment_id": 54599626, "body": "Why did someone vote to close this question? This is a serious one, as the answer that was linked to wasn&#39;t clear at all! Even worse was that, when I looked at the Microsoft website, their instructions weren&#39;t followable at all."}], "answers": [{"comments": [{"owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "edited": false, "score": 0, "creation_date": 1446081477, "post_id": 33402903, "comment_id": 54600236, "body": "This is nice. Now, how precisely do I resolve my initial issue, so that I can see this work?"}, {"owner": {"reputation": 8349, "user_id": 1588897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzUvv.jpg?s=128&g=1", "display_name": "DinoMyte", "link": "https://stackoverflow.com/users/1588897/dinomyte"}, "reply_to_user": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "edited": false, "score": 0, "creation_date": 1446138458, "post_id": 33402903, "comment_id": 54630420, "body": "Please refer to the code under &#39;UPDATE&#39;. I did not test it but hopefully should do the job. Put breakpoints on the methods in the code behind to check if ajax call went through."}, {"owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "edited": false, "score": 0, "creation_date": 1446168238, "post_id": 33402903, "comment_id": 54643777, "body": "That&#39;s not the part I was talking about. See my screenshot."}, {"owner": {"reputation": 8349, "user_id": 1588897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzUvv.jpg?s=128&g=1", "display_name": "DinoMyte", "link": "https://stackoverflow.com/users/1588897/dinomyte"}, "reply_to_user": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "edited": false, "score": 0, "creation_date": 1446221043, "post_id": 33402903, "comment_id": 54668441, "body": "The referenced dll &#39;system.web.provider&#39; is either missing from the references of your web or website project or is not the correct one. Go through this article : <a href=\"https://msdn.microsoft.com/en-us/library/7314433t%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/7314433t%28v=vs.90%29.aspx</a>"}], "tags": [], "owner": {"reputation": 8349, "user_id": 1588897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzUvv.jpg?s=128&g=1", "display_name": "DinoMyte", "link": "https://stackoverflow.com/users/1588897/dinomyte"}, "is_accepted": false, "score": 1, "last_activity_date": 1446138394, "last_edit_date": 1446138394, "creation_date": 1446072456, "answer_id": 33402903, "question_id": 33402384, "link": "https://stackoverflow.com/questions/33402384/html-button-sending-input-text-data-to-asp-side/33402903#33402903", "title": "HTML button sending input text data to ASP side", "body": "<p>The code is not going to post data to the asp.net server because you are just using regular HTML elements. In order to convert an html element to asp.net element, you need to use attribute <code>runat=\"server\"</code>, so your markup would become :</p>\n\n<pre><code>&lt;input id=\"TweetBox\" type=\"text\" runat=\"server\" /&gt;&lt;input id=\"TweetButton\" type=\"button\" value=\"button\" runat=\"server\" /&gt;\n</code></pre>\n\n<p>Alternately, to make the job simpler and have more flexibility on the asp.net controls ( like accessing additional properties ), you should strictly use asp.net core controls. So your new markup would look like :</p>\n\n<pre><code>&lt;asp:TextBox id=\"TweetBox\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n&lt;asp:Button id=\"TweetButton\" runat=\"server\"&gt;&lt;/asp:Button&gt;\n</code></pre>\n\n<p>In order to trigger a click event to post data onto the server ( codebehind ), you need to add the attributes <code>OnClick</code> to your button.</p>\n\n<pre><code>&lt;asp:Button id=\"TweetButton\" runat=\"server\" OnClick=\"TweetButton_Click\"&gt;&lt;/asp:Button&gt;\n</code></pre>\n\n<p>In the codebehind (*.aspx.cs), you need to handle the event triggered by the button and check for the length of the text.</p>\n\n<pre><code>public partial class Feed_Feed : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void TweetButton_Click(object sender, EventArgs e)\n    {\n       if(TweetBox.Text.Length &lt;= 140)\n       {\n         // Save data in the database.\n       }\n    }\n\n}\n</code></pre>\n\n<p><strong>UPDATE :</strong> </p>\n\n<p>To work with ajax, you would need asp.net controls, so your markup would be </p>\n\n<p>.ASPX =></p>\n\n<pre><code>&lt;input id=\"TweetBox\" type=\"text\" /&gt;\n&lt;input id=\"TweetButton\" type=\"button\" value=\"button\" /&gt;\n\n\n\n &lt;script&gt;\n    $().ready(function()\n    {\n    $('#TweetButton').click(function(){\n                        // if it is 140 characters or less\n                        if (status.length &lt;= 140)\n                        {\n                            // send to the server page\n                            $.ajax({\n                                url: '/Feed.aspx/SubmitTweet',\n                                type: 'POST',\n                                dataType: 'json',\n                                  data: \"{'tweet':'\" + $('#TweetBox').val() + \"'}\",\n                                success: function(myStatus) \n                                {\n                                    $('#MyStatus').html(myStatus.d);\n                                },\n                                error : function(er)\n                                {\n\n                                }\n                            });\n                        }\n                        else\n                        {\n                            alert(\"Tweet should contain no more than 140 characters\");\n                        }\n                    });\n\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>.ASPX.CS ( code-behind ) =></p>\n\n<pre><code>[WebMethod]\n    public static string SubmitTweet(string tweet)\n    {\n        // dummy function :\n        return DataSubmit(tweet) ? \"Data Was submitted\" : \"Error while submitting data\";\n    }\n\n    public bool DataSubmit(string data)\n    {        \n        //call db connection and save the tweet\n        // if successful , return true else false\n    }\n</code></pre>\n"}], "owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1313, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1446138394, "creation_date": 1446069732, "question_id": 33402384, "link": "https://stackoverflow.com/questions/33402384/html-button-sending-input-text-data-to-asp-side", "title": "HTML button sending input text data to ASP side", "body": "<p>I am working on a group project, and am trying to figure out ASP.net (hardly anyone in my group knows it, including me). My job is to make some text box and button such that, when the button is clicked, the text in the text box is processed and posted iff it has &lt;= 140 characters. </p>\n\n<p>I tried to write some jQuery that checks the text in the text box, and then sends it to the server for processing. The server is to save it to database, and post it to page, if it is no more than 140 characters long (this will be checked again). </p>\n\n<p>Unfortunately, I run into <a href=\"http://imgur.com/JRABDbi\" rel=\"nofollow\">this</a> error. I tried to contact my team members, but they are super busy with other issues. Here is my code:</p>\n\n<p>Feed.aspx:</p>\n\n<pre><code>&lt;%@ Page Title=\"\" Language=\"C#\" MasterPageFile=\"~/MasterPage.master\" AutoEventWireup=\"true\" CodeFile=\"Feed.aspx.cs\" Inherits=\"Feed_Feed\" %&gt;\n\n&lt;asp:Content ID=\"Content1\" ContentPlaceHolderID=\"head\" Runat=\"Server\"&gt;\n&lt;/asp:Content&gt;\n&lt;!-- This is here for test purpose --&gt;\n&lt;script src=\"https://code.jquery.com/jquery-1.9.1.min.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" language=\"javascript\"&gt;\n    $(document).ready(\n        function()\n        {\n            $('#TweetButton').click(\n                function()\n                {\n                    // get the text from the TweetBox\n                    var status = $('#TweetBox').val();\n                    // if it is 140 characters or less\n                    if (status.length &lt;= 140)\n                    {\n                        var data = JSON.stringify(status);\n                        // send to the server page\n                        $.ajax({\n                            url: '/Feed.aspx.cs',\n                            type: 'POST',\n                            dataType: 'json',\n                            data: data,\n                            success: function(myStatus) \n                            {\n                                $('#MyStatus').html(myStatus);\n                            }\n                        });\n                    }\n                    else\n                    {\n                        alert(\"Tweet should contain no more than 140 characters\");\n                    }\n                });\n        });\n&lt;/script&gt;\n&lt;asp:Content ID=\"Content2\" ContentPlaceHolderID=\"MainContent\" Runat=\"Server\"&gt;\n    &lt;h1&gt;User Feed&lt;/h1&gt;\n    &lt;p&gt;\n        &lt;input id=\"TweetBox\" type=\"text\" /&gt;&lt;input id=\"TweetButton\" type=\"button\" value=\"button\" /&gt;\n\n    &lt;/p&gt;\n    &lt;div id=\"MyStatus\"&gt;&lt;/div&gt;\n&lt;/asp:Content&gt;\n&lt;asp:Content ID=\"Content3\" ContentPlaceHolderID=\"LeftContent\" Runat=\"Server\"&gt;\n&lt;/asp:Content&gt;\n</code></pre>\n\n<p>Feed.aspx.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n\npublic partial class Feed_Feed : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n}\n</code></pre>\n\n<p>The C# file is practically empty because I don't know how to handle the data being posted to the page (should it be in <code>Page_Load</code>?) I don't know what to do here...</p>\n"}, {"tags": ["c#", "xunit", "appveyor"], "answers": [{"tags": [], "owner": {"reputation": 3022, "user_id": 2172786, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6772170b76b706f762c2439027fe5753?s=128&d=identicon&r=PG", "display_name": "mrahhal", "link": "https://stackoverflow.com/users/2172786/mrahhal"}, "is_accepted": true, "score": 3, "last_activity_date": 1446142449, "creation_date": 1446142449, "answer_id": 33421721, "question_id": 33402323, "link": "https://stackoverflow.com/questions/33402323/xunit-console-in-appveyor-is-failing-while-looking-for-xunit-dll/33421721#33421721", "title": "xunit.console in appveyor is failing while looking for xunit.dll", "body": "<p>I have no idea what's causing the problem, so I followed what appveyor <strong>really</strong> does when it automatically discovers and runs tests (as opposed to what it instructs us to do in the docs).</p>\n\n<p>My script that runs on the CI is now this:</p>\n\n<p><code>%xunit20%\\xunit.console.x86 path\\to\\test.dll -appveyor\n</code></p>\n"}], "owner": {"reputation": 3022, "user_id": 2172786, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6772170b76b706f762c2439027fe5753?s=128&d=identicon&r=PG", "display_name": "mrahhal", "link": "https://stackoverflow.com/users/2172786/mrahhal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "accepted_answer_id": 33421721, "answer_count": 1, "score": 4, "last_activity_date": 1446142449, "creation_date": 1446069425, "last_edit_date": 1446093603, "question_id": 33402323, "link": "https://stackoverflow.com/questions/33402323/xunit-console-in-appveyor-is-failing-while-looking-for-xunit-dll", "title": "xunit.console in appveyor is failing while looking for xunit.dll", "body": "<p>I have a project under appveyor. Running the build script fails when testing begin with the following message:</p>\n\n<p><code>EXEC : error : Could not find file: C:\\projects\\Projname\\test\\Projname.Tests\\bin\\Release\\xunit.dll\n</code></p>\n\n<p>I'm invoking the test runner from the build script using:</p>\n\n<p><code>xunit.console.clr4 test/Projname.Tests/bin/Release/Projname.Tests.dll /appveyor\n</code></p>\n\n<p><code>xunit.console</code> is working fine locally on my machine and without looking for <code>xunit.dll</code>. Why is this happening in appveyor?</p>\n"}, {"tags": ["c#", ".net", "performance", "wcf", "threadpool"], "comments": [{"owner": {"reputation": 3, "user_id": 5500275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5293a2e40b14652241ab7d31b1cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit", "link": "https://stackoverflow.com/users/5500275/ankit"}, "edited": false, "score": 0, "creation_date": 1446131241, "post_id": 33402316, "comment_id": 54625332, "body": "<a href=\"http://www.filedropper.com/wcfthrottling\" rel=\"nofollow noreferrer\">Source Code</a>. It has the Service and client code for testing."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5500275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5293a2e40b14652241ab7d31b1cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit", "link": "https://stackoverflow.com/users/5500275/ankit"}, "edited": false, "score": 0, "creation_date": 1446130960, "post_id": 33404717, "comment_id": 54625106, "body": "Actually i did set the Min &amp; Max threads to 500 &amp; 2000. But it did not help. <a href=\"http://www.filedropper.com/wcfthrottling\" rel=\"nofollow noreferrer\">Source Code</a>. It has test Server as well as the client application."}, {"owner": {"reputation": 325, "user_id": 732303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b36167bb5956c59e2672baeaa78eb3a?s=128&d=identicon&r=PG", "display_name": "SeongTae Jeong", "link": "https://stackoverflow.com/users/732303/seongtae-jeong"}, "reply_to_user": {"reputation": 3, "user_id": 5500275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5293a2e40b14652241ab7d31b1cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit", "link": "https://stackoverflow.com/users/5500275/ankit"}, "edited": false, "score": 0, "creation_date": 1446167315, "post_id": 33404717, "comment_id": 54643544, "body": "OK, I made a mistake.You have to increase IO threads in this case, not worker threads.  You just modify this line,  ThreadPool.SetMinThreads(_NewMinThreads, _CurrentMinCompPort);  as follows,  ThreadPool.SetMinThreads(_NewMinThreads, 100);"}, {"owner": {"reputation": 3, "user_id": 5500275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5293a2e40b14652241ab7d31b1cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit", "link": "https://stackoverflow.com/users/5500275/ankit"}, "edited": false, "score": 0, "creation_date": 1446218181, "post_id": 33404717, "comment_id": 54666503, "body": "Thanks that did help, I was able to make max 300 calls simultaneously by increasing the IO threads to 500. do you know how to take it further? Or its better to use Task Parallel Library to increase the simultaneous calls."}, {"owner": {"reputation": 325, "user_id": 732303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b36167bb5956c59e2672baeaa78eb3a?s=128&d=identicon&r=PG", "display_name": "SeongTae Jeong", "link": "https://stackoverflow.com/users/732303/seongtae-jeong"}, "reply_to_user": {"reputation": 3, "user_id": 5500275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5293a2e40b14652241ab7d31b1cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit", "link": "https://stackoverflow.com/users/5500275/ankit"}, "edited": false, "score": 0, "creation_date": 1446441981, "post_id": 33404717, "comment_id": 54728028, "body": "300 might be depends on &lt;serviceThrottling /&gt;, so you can increase by settings them with ThreadPool. Using TPL is not so helpful in this case. Because TPL is also based on ThreadPool.  See this article  <a href=\"http://www.danielmoth.com/Blog/New-And-Improved-CLR-4-Thread-Pool-Engine.aspx\" rel=\"nofollow noreferrer\">New and Improved CLR 4 Thread Pool Engine</a>"}], "tags": [], "owner": {"reputation": 325, "user_id": 732303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b36167bb5956c59e2672baeaa78eb3a?s=128&d=identicon&r=PG", "display_name": "SeongTae Jeong", "link": "https://stackoverflow.com/users/732303/seongtae-jeong"}, "is_accepted": true, "score": 0, "last_activity_date": 1558121036, "last_edit_date": 1558121036, "creation_date": 1446083921, "answer_id": 33404717, "question_id": 33402316, "link": "https://stackoverflow.com/questions/33402316/bottleneck-delay-when-calling-wcf-service/33404717#33404717", "title": "BottleNeck/delay when Calling WCF service", "body": "<p>I think, this is based on a basic policy of thread pool. You can modify minThreads as follows,</p>\n\n<pre><code>int worker, int io;\nThreadPool.GetMinThreads(out worker, out io); \nThreadPool.SetMinThreads(worker, 100 - io); // 100 is just sample value.\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5500275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5293a2e40b14652241ab7d31b1cb9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit", "link": "https://stackoverflow.com/users/5500275/ankit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 33404717, "answer_count": 1, "score": 0, "last_activity_date": 1558121036, "creation_date": 1446069377, "question_id": 33402316, "link": "https://stackoverflow.com/questions/33402316/bottleneck-delay-when-calling-wcf-service", "title": "BottleNeck/delay when Calling WCF service", "body": "<p>I have created a simple WCF service with a method Do work, which sleeps for 15 seconds and then return a string. Its a Singleton service with multiple Concurrency. </p>\n\n<p>The client(.net Desktop Application)  has a for loop of 100 to call this function. I want to see how many threads i can process at one time and increase performance. </p>\n\n<p>I am using NetTCP binding and have added the performance parameters</p>\n\n<p>Server config</p>\n\n<pre><code>&lt;services&gt;\n  &lt;service name=\"WCFService.WCFService\" behaviorConfiguration=\"mexbahaviour\"&gt;\n    &lt;endpoint address=\"WCFService\" binding=\"netTcpBinding\" contract=\"WCFService.IWCFService\" &gt;&lt;/endpoint&gt;\n    &lt;endpoint address=\"WCFService\" binding=\"netNamedPipeBinding\" contract=\"WCFService.IWCFService\" &gt;&lt;/endpoint&gt;\n    &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\" &gt;&lt;/endpoint&gt;\n    &lt;host&gt;\n      &lt;baseAddresses&gt;\n        &lt;add baseAddress=\"http://localhost:8090/ \"/&gt;\n        &lt;add baseAddress=\"net.tcp://localhost:8091/ \"/&gt;\n        &lt;add baseAddress=\"net.pipe://localhost/ \"/&gt;\n      &lt;/baseAddresses&gt;\n    &lt;/host&gt;\n  &lt;/service&gt;\n&lt;/services&gt;\n&lt;behaviors&gt;\n  &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"mexbahaviour\"&gt;\n      &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n      &lt;serviceThrottling maxConcurrentCalls=\"300\" maxConcurrentSessions=\"300\"\n        maxConcurrentInstances=\"600\" /&gt;\n    &lt;/behavior&gt;\n  &lt;/serviceBehaviors&gt;\n&lt;/behaviors&gt;\n</code></pre>\n\n<p></p>\n\n<p>The issue is the that the request is not hitting the server fast enough. Initial sec there are 4 request, but after that there are 2 requests per seconds. \n<a href=\"http://i.stack.imgur.com/GHNuE.png\" rel=\"nofollow\">The output window on service looks like this.</a></p>\n\n<p>So in this a new thread is created whenever a requests hit the service and logs the time it was received and the goes to sleep. </p>\n\n<p>I did Add connection Management section on the client side</p>\n\n<pre><code>&lt;connectionManagement&gt;\n  &lt;add address=\"*\" maxconnection=\"100\"/&gt;\n&lt;/connectionManagement&gt;\n</code></pre>\n\n<p>Is the delay due to thread creation? or some service-throttling limitation that i am hitting? </p>\n\n<p>Please Give suggestions what i do. </p>\n\n<p>I also tried to implement using this article which helped\n<a href=\"http://www.codeproject.com/Articles/133738/Quick-Ways-to-Boost-Performance-and-Scalability-of\" rel=\"nofollow\">Boost WCF Performance</a></p>\n"}, {"tags": ["c#", "html", "html-agility-pack"], "comments": [{"owner": {"reputation": 2851, "user_id": 3503521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d0c033ee57f9049e9c71ea6ed42062?s=128&d=identicon&r=PG", "display_name": "Vladimir Serykh", "link": "https://stackoverflow.com/users/3503521/vladimir-serykh"}, "edited": false, "score": 2, "creation_date": 1446070406, "post_id": 33402229, "comment_id": 54596420, "body": "Did you read the Html Agility Pack docs?"}, {"owner": {"reputation": 1, "user_id": 4519646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38fdc5e309d885c5ed9dcc67c12cb01?s=128&d=identicon&r=PG&f=1", "display_name": "Bulut", "link": "https://stackoverflow.com/users/4519646/bulut"}, "reply_to_user": {"reputation": 2851, "user_id": 3503521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d0c033ee57f9049e9c71ea6ed42062?s=128&d=identicon&r=PG", "display_name": "Vladimir Serykh", "link": "https://stackoverflow.com/users/3503521/vladimir-serykh"}, "edited": false, "score": 0, "creation_date": 1446206879, "post_id": 33402229, "comment_id": 54659270, "body": "I solved my problem and shared the answer. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 2851, "user_id": 3503521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d0c033ee57f9049e9c71ea6ed42062?s=128&d=identicon&r=PG", "display_name": "Vladimir Serykh", "link": "https://stackoverflow.com/users/3503521/vladimir-serykh"}, "edited": false, "score": 0, "creation_date": 1446206975, "post_id": 33435634, "comment_id": 54659327, "body": "I&#39;m not sure that <code>.NextSibling.NextSibling</code> points to right element."}, {"owner": {"reputation": 1, "user_id": 4519646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38fdc5e309d885c5ed9dcc67c12cb01?s=128&d=identicon&r=PG&f=1", "display_name": "Bulut", "link": "https://stackoverflow.com/users/4519646/bulut"}, "reply_to_user": {"reputation": 2851, "user_id": 3503521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d0c033ee57f9049e9c71ea6ed42062?s=128&d=identicon&r=PG", "display_name": "Vladimir Serykh", "link": "https://stackoverflow.com/users/3503521/vladimir-serykh"}, "edited": false, "score": 0, "creation_date": 1446281677, "post_id": 33435634, "comment_id": 54686706, "body": "I couldn&#39;t find any answer for my problem on web. Firstly i thought it was absurd too but it works fine. I got about 60K data with this code then i share the solution maybe it will be helpful to someone."}], "tags": [], "owner": {"reputation": 1, "user_id": 4519646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38fdc5e309d885c5ed9dcc67c12cb01?s=128&d=identicon&r=PG&f=1", "display_name": "Bulut", "link": "https://stackoverflow.com/users/4519646/bulut"}, "is_accepted": false, "score": 0, "last_activity_date": 1446206956, "last_edit_date": 1446206956, "creation_date": 1446206833, "answer_id": 33435634, "question_id": 33402229, "link": "https://stackoverflow.com/questions/33402229/how-to-get-div-without-class-with-html-agility-pack/33435634#33435634", "title": "How to get div without class with Html Agility Pack", "body": "<pre><code>HtmlNodeCollection aciklamaCek = dokuman.DocumentNode.SelectNodes(\"//div[@class='dRib1']\");\n\ntextBox8.Text = aciklamaCek[0].NextSibling.NextSibling.InnerText.Trim();\n</code></pre>\n\n<p>I solved my problem with this code.</p>\n"}], "owner": {"reputation": 1, "user_id": 4519646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38fdc5e309d885c5ed9dcc67c12cb01?s=128&d=identicon&r=PG&f=1", "display_name": "Bulut", "link": "https://stackoverflow.com/users/4519646/bulut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446206956, "creation_date": 1446069020, "last_edit_date": 1446206939, "question_id": 33402229, "link": "https://stackoverflow.com/questions/33402229/how-to-get-div-without-class-with-html-agility-pack", "title": "How to get div without class with Html Agility Pack", "body": "<p>I try to get 'Galatasaray.' from following HTML. I don't know how can I specified that</p>\n\n<pre><code>&lt;div class=\"dRib1\"&gt;\n    &lt;h2&gt;Bilgi&lt;/h2&gt;\n&lt;/div&gt;\n\n&lt;div&gt;Galatasaray.&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["c#", "null", "compare"], "answers": [{"comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 4, "creation_date": 1446068988, "post_id": 33402208, "comment_id": 54595738, "body": "Correct but you are not answering the question"}], "tags": [], "owner": {"reputation": 196, "user_id": 5465199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a480ff9620f8de233298dfb8a81a36b?s=128&d=identicon&r=PG&f=1", "display_name": "amg-argh", "link": "https://stackoverflow.com/users/5465199/amg-argh"}, "is_accepted": false, "score": 1, "last_activity_date": 1446068940, "creation_date": 1446068940, "answer_id": 33402208, "question_id": 33402178, "link": "https://stackoverflow.com/questions/33402178/firstordefault-comparation-with-null/33402208#33402208", "title": "FirstOrDefault comparation with null", "body": "<p>You might be better off using \"Any\", which will return true if any elements in the list match your conditions.</p>\n\n<pre><code>public static bool IsLanguageAvaliable(string lang)\n{\n    return AvaliableLanguages.Any(languages =&gt; languages.LangCultureName.Equals(lang));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16505, "user_id": 97382, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5j1Z4.png?s=128&g=1", "display_name": "Craig W.", "link": "https://stackoverflow.com/users/97382/craig-w"}, "is_accepted": false, "score": 4, "last_activity_date": 1446069333, "last_edit_date": 1446069333, "creation_date": 1446069011, "answer_id": 33402227, "question_id": 33402178, "link": "https://stackoverflow.com/questions/33402178/firstordefault-comparation-with-null/33402227#33402227", "title": "FirstOrDefault comparation with null", "body": "<p><code>FirstOrDefault</code> will return the default value for the type if the expression doesn't find any matches in the collection. Put another way, if no <code>languages.LangCultureName</code> is equal to the value of <code>lang</code> you will get a <code>null</code> back from <code>FirstOrDefault</code>.</p>\n\n<p>While it is true that your expression <code>languages.LangCultureName.Equals(lang)</code> returns true or false, that value is used to <em>select an object from the collection</em>, it is not the return value of your method.</p>\n\n<p>If all you're trying to do is determine if the <code>lang</code> exists you should use <code>.Any</code> rather than <code>.FirstOrDefault</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 3958, "user_id": 1450348, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/NWuXW.jpg?s=128&g=1", "display_name": "manman", "link": "https://stackoverflow.com/users/1450348/manman"}, "is_accepted": false, "score": 0, "last_activity_date": 1446069127, "creation_date": 1446069127, "answer_id": 33402249, "question_id": 33402178, "link": "https://stackoverflow.com/questions/33402178/firstordefault-comparation-with-null/33402249#33402249", "title": "FirstOrDefault comparation with null", "body": "<p>If you look at the signature of <code>FirstOrDefualt</code> method, it's an <a href=\"https://msdn.microsoft.com/en-us/library/bb383977.aspx\" rel=\"nofollow\">extension method</a> on <code>IEnumerable&lt;T&gt;</code>:</p>\n\n<pre><code>FirstOrDefault&lt;TSource&gt;(IEnumerable&lt;TSource&gt;,\u2002Func&lt;TSource,\u2002Boolean&gt;)\n</code></pre>\n\n<p>As you can see the second parameter is of type Func which takes an object of type T and returns <code>boolean</code>. With this Func parameter, you're defining which elements should be chosen. So <code>FirstOrDefault</code> method iterates over your list and uses your Func method to evaluate which object is eligible for it. As a result, <code>FirstOrDefault</code> will return an object of type T if it finds an element in your <code>IEnumerable&lt;T&gt;</code> list, otherwise the result would be <code>null</code></p>\n"}, {"comments": [{"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1446074033, "post_id": 33402286, "comment_id": 54597917, "body": "It&#39;s redundant to say &quot;class deriving from object&quot;. All classes except object derive from object."}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1446099117, "post_id": 33402286, "comment_id": 54605279, "body": "@EricLippert (You&#39;re awesome) yes, that statement was more about default for any object and indirectly hinting that default is not always null for other types not deriving from object."}], "tags": [], "owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "is_accepted": true, "score": 2, "last_activity_date": 1446099201, "last_edit_date": 1446099201, "creation_date": 1446069261, "answer_id": 33402286, "question_id": 33402178, "link": "https://stackoverflow.com/questions/33402178/firstordefault-comparation-with-null/33402286#33402286", "title": "FirstOrDefault comparation with null", "body": "<blockquote>\n  <p>how it can return true or false as first expression already returns true or or false?</p>\n</blockquote>\n\n<p>The first expression does not return true or false, your assertion is incorrect.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/vstudio/bb340482(v=vs.100).aspx\" rel=\"nofollow\">FirstOrDefault()</a></p>\n\n<blockquote>\n  <p>Returns the first element of a sequence, or a default value if the sequence contains no elements.</p>\n</blockquote>\n\n<p>onto</p>\n\n<blockquote>\n  <p>I mean why does it still need to compare with !=null</p>\n</blockquote>\n\n<p>Since your first assumption is incorrect, and per the documentation it returns the <a href=\"https://msdn.microsoft.com/en-us/library/xwth0h0d.aspx\" rel=\"nofollow\">default</a> and the default of a class deriving from object is <code>null</code> checking equality on null means that no object exists in the sequence.</p>\n"}], "owner": {"reputation": 783, "user_id": 1430517, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/589afd32b0d7cf0f0557a8572eefb3ca?s=128&d=identicon&r=PG", "display_name": "Ozgur Erdogan", "link": "https://stackoverflow.com/users/1430517/ozgur-erdogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "closed_date": 1446735678, "accepted_answer_id": 33402286, "answer_count": 4, "score": -5, "last_activity_date": 1446099201, "creation_date": 1446068810, "question_id": 33402178, "link": "https://stackoverflow.com/questions/33402178/firstordefault-comparation-with-null", "closed_reason": "Not suitable for this site", "title": "FirstOrDefault comparation with null", "body": "<p>Can you please explain, how it can return true or false as first expression already returns true or or false? I mean why does it still need to compare with !=null</p>\n\n<pre><code>public static bool IsLanguageAvaliable(string lang)\n    {\n        return AvaliableLanguages.FirstOrDefault(languages =&gt; languages.LangCultureName.Equals(lang)) != null;\n    }\n</code></pre>\n"}, {"tags": ["c#", "pdf", "selenium", "automation", "pdfbox"], "comments": [{"owner": {"reputation": 3269, "user_id": 1392498, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef0f44b508cb22fc17047f65f828c3a1?s=128&d=identicon&r=PG&f=1", "display_name": "LINGS", "link": "https://stackoverflow.com/users/1392498/lings"}, "edited": false, "score": 0, "creation_date": 1446069577, "post_id": 33402144, "comment_id": 54596059, "body": "After logging in, are you using the same browser to access the PDF URL or opening a new browser?"}, {"owner": {"reputation": 1, "user_id": 5500317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f29d027ec7d09316d3d7f8b3358fdd3?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm Dorfeuille", "link": "https://stackoverflow.com/users/5500317/malcolm-dorfeuille"}, "reply_to_user": {"reputation": 3269, "user_id": 1392498, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef0f44b508cb22fc17047f65f828c3a1?s=128&d=identicon&r=PG&f=1", "display_name": "LINGS", "link": "https://stackoverflow.com/users/1392498/lings"}, "edited": false, "score": 0, "creation_date": 1446074619, "post_id": 33402144, "comment_id": 54598130, "body": "In the same browser, and it automatically opens in a different tab."}], "answers": [{"tags": [], "owner": {"reputation": 370, "user_id": 3387943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/829b5b9d582dc60ca483b95871d23b56?s=128&d=identicon&r=PG&f=1", "display_name": "Sneh Tripathi", "link": "https://stackoverflow.com/users/3387943/sneh-tripathi"}, "is_accepted": false, "score": 0, "last_activity_date": 1447845025, "last_edit_date": 1447845025, "creation_date": 1447843539, "answer_id": 33777943, "question_id": 33402144, "link": "https://stackoverflow.com/questions/33402144/pdf-automation-using-url-thats-a-continuation-from-what-is-already-opened/33777943#33777943", "title": "PDF Automation using URL that&#39;s a continuation from what is already opened", "body": "<blockquote>\n  <p>Blockquote</p>\n</blockquote>\n\n<p>try this:</p>\n\n<pre><code>    PDFTextStripper pdfStripper = null;\n    PDDocument pdDoc = null;\n    COSDocument cosDoc = null;\n    String parsedText = null;\n\n        URL url = new URL(strURL);\n        Proxy proxy = new Proxy(Proxy.Type.HTTP, new         InetSocketAddress(\"172.18.65.50\", 8080));\n        URLConnection urlc = url.openConnection(proxy);\n        urlc.addRequestProperty(\"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:6.0a2) Gecko/20110613 Firefox/6.0a2\");\n       RandomAccessBufferedFileInputStream file = new RandomAccessBufferedFileInputStream(urlc.getInputStream());\n        PDFParser parser = new PDFParser(file);         \n        parser.parse();\n        cosDoc = parser.getDocument();\n        pdfStripper = new PDFTextStripper();\n        pdfStripper.setStartPage(1);\n        pdfStripper.setEndPage(1);\n\n        pdDoc = new PDDocument(cosDoc);\n        parsedText = pdfStripper.getText(pdDoc);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5500317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f29d027ec7d09316d3d7f8b3358fdd3?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm Dorfeuille", "link": "https://stackoverflow.com/users/5500317/malcolm-dorfeuille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539254180, "creation_date": 1446068675, "last_edit_date": 1539254180, "question_id": 33402144, "link": "https://stackoverflow.com/questions/33402144/pdf-automation-using-url-thats-a-continuation-from-what-is-already-opened", "title": "PDF Automation using URL that&#39;s a continuation from what is already opened", "body": "<p>Currently i'm using Selenium Webdriver for c# and PDFBox to automate the PDF text of a report. Now, using PDFBox, we have the ability to parse a pdf given a URL link, with URL  = new URL(\"link of pdf\"); However, this takes the URL link directly without preconditions. </p>\n\n<p>If I access the PDF with the direct URL address, I get a \"resource not found\" error. I essentially would need to log into the application, and select the report that I need in order to load the actual PDF. This has the same address, except it was loaded in the application instead of being loaded directly. How would I link Selenium with PDFbox?, so that instead of the code opening a new URL that goes directly to the Denied Permissions URL, it would go to the PDF Report that's already preloaded on the screen, with the same URL address? </p>\n\n<pre><code>         URL url = new URL(\"link of url\");\n    BufferedInputStream input = new  BufferedInputStream(url.openStream());\n        PDFParser parsepdf = new PDFParser(input);\n        parsepdf.parse();\n        textofpdf = new PDFTextStripper().getText(parsepdf.getPDDocument())\n</code></pre>\n\n<p>So essentially, I have a Selenium Test class that executes the functionality of logging in, and opening the Report. After that, I make a call to the above PDFParse method. This method currently functions as if a new URL is loaded, instead of continuing with the current Selenium session. </p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 1590, "user_id": 1892668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c28efdb2f8e6019360d2e25c8b1a373b?s=128&d=identicon&r=PG", "display_name": "Bradford Dillon", "link": "https://stackoverflow.com/users/1892668/bradford-dillon"}, "edited": false, "score": 0, "creation_date": 1446069335, "post_id": 33401940, "comment_id": 54595937, "body": "What version of Visual Studio?"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 1344147, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/940d4af6bb0b879a07d49fee6b99b338?s=128&d=identicon&r=PG", "display_name": "DanBrum", "link": "https://stackoverflow.com/users/1344147/danbrum"}, "edited": false, "score": 0, "creation_date": 1446068151, "post_id": 33401963, "comment_id": 54595282, "body": "Sorry, I phrased the question incorrectly. I would like to break on a breakpoint before the exception."}, {"owner": {"reputation": 4600, "user_id": 463206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4edc6d888e98324130d6de9ff0f37f8?s=128&d=identicon&r=PG&f=1", "display_name": "radarbob", "link": "https://stackoverflow.com/users/463206/radarbob"}, "reply_to_user": {"reputation": 349, "user_id": 1344147, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/940d4af6bb0b879a07d49fee6b99b338?s=128&d=identicon&r=PG", "display_name": "DanBrum", "link": "https://stackoverflow.com/users/1344147/danbrum"}, "edited": false, "score": 0, "creation_date": 1446068732, "post_id": 33401963, "comment_id": 54595590, "body": "Do as @DanBrum said. The debugger will stop immediately when the exception happens. Now put a breakpoint as needed."}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 349, "user_id": 1344147, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/940d4af6bb0b879a07d49fee6b99b338?s=128&d=identicon&r=PG", "display_name": "DanBrum", "link": "https://stackoverflow.com/users/1344147/danbrum"}, "edited": false, "score": 0, "creation_date": 1446068895, "post_id": 33401963, "comment_id": 54595687, "body": "@DanBrum, if you do as I said, the debugger will break at the exception. then you can look at the call stack and place a breakpoint higher up the call stack where you want. Then re-start your project."}, {"owner": {"reputation": 349, "user_id": 1344147, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/940d4af6bb0b879a07d49fee6b99b338?s=128&d=identicon&r=PG", "display_name": "DanBrum", "link": "https://stackoverflow.com/users/1344147/danbrum"}, "edited": false, "score": 0, "creation_date": 1446125477, "post_id": 33401963, "comment_id": 54620815, "body": "I want the breakpoint in the code that is not mine. You cannot do this unless just my code is disabled. The breakpoint will not be hit. And I want the breakpoint to be hit before the exception is fired."}], "tags": [], "owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "is_accepted": false, "score": 1, "last_activity_date": 1446067939, "creation_date": 1446067939, "answer_id": 33401963, "question_id": 33401940, "link": "https://stackoverflow.com/questions/33401940/declaring-non-user-code-as-user-code-when-just-my-code-is-enabled/33401963#33401963", "title": "Declaring non user code as user code when Just My Code is enabled", "body": "<p>I assume you're using Visual Studio. Go to Debug->Exceptions dialog and check the exceptions you want the debugger to break at.</p>\n"}], "owner": {"reputation": 349, "user_id": 1344147, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/940d4af6bb0b879a07d49fee6b99b338?s=128&d=identicon&r=PG", "display_name": "DanBrum", "link": "https://stackoverflow.com/users/1344147/danbrum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446068128, "creation_date": 1446067850, "last_edit_date": 1446068128, "question_id": 33401940, "link": "https://stackoverflow.com/questions/33401940/declaring-non-user-code-as-user-code-when-just-my-code-is-enabled", "title": "Declaring non user code as user code when Just My Code is enabled", "body": "<p>I want to break before (on a break point) an exception is thrown in code that is not mine (a WSDL generated proxy class) but still have just my code enabled everywhere else. Is there an attribute or some other way to do this?</p>\n"}, {"tags": ["c#", "wpf", "visual-studio-2015"], "comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1446068558, "post_id": 33401900, "comment_id": 54595498, "body": "That is the normal way to do it. Please clarify your question. Provide <a href=\"https://stackoverflow.com/help/mcve\">a good, <i>minimal</i>, <i>complete</i> code example</a> that reliably reproduces the problem. Include a precise, detailed explanation of what that code does and how that&#39;s different from what you want it to do. Saying &quot;it doesn&#39;t seem to work&quot; is not a useful problem statement."}], "answers": [{"tags": [], "owner": {"reputation": 3365, "user_id": 4322228, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/388b0e91fd6bb09be4f12dc5a67a992a?s=128&d=identicon&r=PG&f=1", "display_name": "kskyriacou", "link": "https://stackoverflow.com/users/4322228/kskyriacou"}, "is_accepted": true, "score": 2, "last_activity_date": 1446070873, "creation_date": 1446070873, "answer_id": 33402597, "question_id": 33401900, "link": "https://stackoverflow.com/questions/33401900/wpf-detect-design-mode-in-a-converter/33402597#33402597", "title": "WPF - Detect design mode in a Converter", "body": "<p>What you're doing should work.</p>\n\n<p>I'm guessing you have a viewmodel behind your window and using the converter on a binding to that viewmodel. Please make sure you are setting your data context in XAML and not in code, because if you are setting it in code your converter will never hit in design mode.</p>\n\n<pre><code>&lt;Window x:Class=\"WpfApp1.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n        xmlns:local=\"clr-namespace:WpfApp1\"\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        Title=\"MainWindow\"\n        Width=\"525\"\n        Height=\"350\"\n        mc:Ignorable=\"d\"&gt;\n\n    &lt;Window.DataContext&gt;\n        &lt;local:ViewModel /&gt;\n    &lt;/Window.DataContext&gt;\n\n    ...\n\n&lt;/Window&gt;\n</code></pre>\n\n<p>This ensures bindings are updated at design time and hence your converter will be called.</p>\n"}, {"comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1467676790, "post_id": 38192908, "comment_id": 63812359, "body": "Would you mind pasting in the code here? There are too many dead links in answers on SO, all of which were reasonably expected to be around indefinitely. Also: Very cool markup extension."}, {"owner": {"reputation": 2638, "user_id": 612510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aae0eaaf72364c6a85f8fb8608286deb?s=128&d=identicon&r=PG", "display_name": "Mike Marynowski", "link": "https://stackoverflow.com/users/612510/mike-marynowski"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1467682420, "post_id": 38192908, "comment_id": 63813295, "body": "Makes sense, dead links on here are incredible annoying."}], "tags": [], "owner": {"reputation": 2638, "user_id": 612510, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/aae0eaaf72364c6a85f8fb8608286deb?s=128&d=identicon&r=PG", "display_name": "Mike Marynowski", "link": "https://stackoverflow.com/users/612510/mike-marynowski"}, "is_accepted": false, "score": 3, "last_activity_date": 1467696621, "last_edit_date": 1467696621, "creation_date": 1467671102, "answer_id": 38192908, "question_id": 33401900, "link": "https://stackoverflow.com/questions/33401900/wpf-detect-design-mode-in-a-converter/38192908#38192908", "title": "WPF - Detect design mode in a Converter", "body": "<p>I wrote a markup extension that makes it way easier to muck around with design time bindings and property values without messing around with the code your view binds to or changing the actual runtime value of a property. The full write up is here: <a href=\"http://www.singulink.com/CodeIndex/post/wpf-visibility-binding-with-design-time-control\" rel=\"nofollow\">http://www.singulink.com/CodeIndex/post/wpf-visibility-binding-with-design-time-control</a></p>\n\n<p>It works with visibility as well as most other properties. Usage looks like:</p>\n\n<pre><code>&lt;Grid Visibility=\"{data:Value {Binding RootObject, Converter={StaticResource NullToVisibilityConverter}}, DesignValue=Visible}\"&gt;\n    &lt;TextBlock Background=\"Red\" Text=\"Testing visibility\" /&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>The extension class: </p>\n\n<pre><code>public class ValueExtension : MarkupExtension\n{\n    public object DesignValue { get; set; } = DependencyProperty.UnsetValue;\n\n    [ConstructorArgument(\"value\")]\n    public object Value { get; set; } = DependencyProperty.UnsetValue;\n\n    public ValueExtension() { }\n\n    public ValueExtension(object value)\n    {\n        Value = value;\n    }\n\n    public override object ProvideValue(IServiceProvider serviceProvider)\n    {\n        var provideValueTarget = serviceProvider.GetService(typeof(IProvideValueTarget)) as IProvideValueTarget;\n        var target = provideValueTarget.TargetObject as FrameworkElement;\n\n        var value = DesignerProperties.GetIsInDesignMode(target) &amp;&amp; DesignValue != DependencyProperty.UnsetValue ? DesignValue : Value;\n\n        if (value == DependencyProperty.UnsetValue || value == null)\n            return value;\n\n        if (value is MarkupExtension)\n        {\n            return ((MarkupExtension)value).ProvideValue(serviceProvider);\n        }\n\n        var property = provideValueTarget.TargetProperty as DependencyProperty;\n\n        if (property.PropertyType.IsInstanceOfType(value))\n            return value;\n\n\n        return TypeDescriptor.GetConverter(property.PropertyType).ConvertFrom(value);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1870, "user_id": 188577, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/1d1f51b6653a0f724df58f1916b09c47?s=128&d=identicon&r=PG", "display_name": "H20rider", "link": "https://stackoverflow.com/users/188577/h20rider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2180, "favorite_count": 0, "accepted_answer_id": 33402597, "answer_count": 2, "score": 4, "last_activity_date": 1467696621, "creation_date": 1446067644, "last_edit_date": 1446612433, "question_id": 33401900, "link": "https://stackoverflow.com/questions/33401900/wpf-detect-design-mode-in-a-converter", "title": "WPF - Detect design mode in a Converter", "body": "<p>I have a converter in which I want to be able to change the value to Visibility.Collapsed when in DesignMode. Right it is ignoring the GetIsInDesignMode.  </p>\n\n<p>Also, I am binding the VM via dependency injectio (prism)</p>\n\n<p><strong>Converter:</strong></p>\n\n<pre><code>public object Convert(object value, Type targetType, object parameter, CultureInfo culture)\n    {\n\n        if (DesignerProperties.GetIsInDesignMode(new DependencyObject()))\n            return Visibility.Collapsed;\n\n        if (value != null &amp;&amp; value is AllowedSourceCode)\n        {\n            var allowedSourceCode = (AllowedSourceCode)value;\n\n            if (value == null)\n                return Visibility.Visible;\n            else if (allowedSourceCode.SupportedSourceCodes.Contains(allowedSourceCode.SelectedSourceCode))\n            {\n                return Visibility.Collapsed;\n            }\n            else\n            return Visibility.Visible;\n\n        }\n        return Visibility.Collapsed;\n    }\n</code></pre>\n\n<p><strong>View:</strong></p>\n\n<pre><code>        &lt;Canvas Visibility=\"{Binding SupportedSourceCodes,Converter={StaticResource AllowedSourcesConverter}}\" Background=\"Gray\" Opacity=\"0.9\"\n            Grid.Row=\"0\" Grid.Column=\"0\" Grid.RowSpan=\"3\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" Panel.ZIndex=\"5\"  &gt;\n</code></pre>\n\n<p><strong>xaml.cs:</strong></p>\n\n<pre><code>        public ACARSubLedgerUC(ACARSubLedgerVM vm)\n    {\n        InitializeComponent();\n        DataContext = vm;\n    }\n</code></pre>\n"}, {"tags": ["c#", "winforms", "path", "filenames", "savefiledialog"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446067831, "post_id": 33401854, "comment_id": 54595130, "body": "look at this and you will quickly see where your problem / Issue lies.. <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.savefiledialog(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4664405"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446068450, "post_id": 33401854, "comment_id": 54595438, "body": "Tried but it does not even jump into the if branch"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4664405"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446069254, "post_id": 33401854, "comment_id": 54595880, "body": "Why did I get a downvote?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4664405"}, "edited": false, "score": 0, "creation_date": 1446068626, "post_id": 33401929, "comment_id": 54595532, "body": "argumentexception at the folderpath. invalid format"}, {"owner": {"reputation": 184, "user_id": 5491285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f15cbcf19bc76e53c2780ad4fb8cd7?s=128&d=identicon&r=PG&f=1", "display_name": "321polorex123", "link": "https://stackoverflow.com/users/5491285/321polorex123"}, "edited": false, "score": 0, "creation_date": 1446068872, "post_id": 33401929, "comment_id": 54595670, "body": "What value does the <code>saveFileDialog1.FileName</code> property have?"}], "tags": [], "owner": {"reputation": 184, "user_id": 5491285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f15cbcf19bc76e53c2780ad4fb8cd7?s=128&d=identicon&r=PG&f=1", "display_name": "321polorex123", "link": "https://stackoverflow.com/users/5491285/321polorex123"}, "is_accepted": false, "score": 2, "last_activity_date": 1446067762, "creation_date": 1446067762, "answer_id": 33401929, "question_id": 33401854, "link": "https://stackoverflow.com/questions/33401854/savefiledialog-does-not-save-the-filename-or-path/33401929#33401929", "title": "SaveFileDialog does not save the filename or path", "body": "<p>Check this example from MSDN (<a href=\"https://msdn.microsoft.com/de-de/library/system.windows.forms.savefiledialog(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/de-de/library/system.windows.forms.savefiledialog(v=vs.110).aspx</a>):</p>\n\n<pre><code>private void button1_Click(object sender, System.EventArgs e)\n {\n     Stream myStream ;\n     SaveFileDialog saveFileDialog1 = new SaveFileDialog();\n\n     saveFileDialog1.Filter = \"txt files (*.txt)|*.txt|All files (*.*)|*.*\"  ;\n     saveFileDialog1.FilterIndex = 2 ;\n     saveFileDialog1.RestoreDirectory = true ;\n\n     if(saveFileDialog1.ShowDialog() == DialogResult.OK)\n     {\n         if((myStream = saveFileDialog1.OpenFile()) != null)\n         {\n             // Code to write the stream goes here.\n             myStream.Close();\n         }\n     }\n }\n</code></pre>\n\n<p>You only have to check the return value of <code>saveFileDialog1.ShowDialog()</code> to know whether the user has clicked ok or not.</p>\n\n<p>Then, you can use the <code>FileName</code> property which contains the selected file path.</p>\n\n<p>EDIT: To get the folder path of the file, you can use this:</p>\n\n<pre><code>string folderPath = new DirectoryInfo(saveFileDialog1.FileName).Name;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446068082, "post_id": 33401951, "comment_id": 54595244, "body": "@MethodMan Pay attention that the OP created a new local instance in <code>Button_Click</code> and show it, then in <code>FileOk</code> he uses <code>saveFileDialog1.FileName</code> that obviously different from the instance that he show."}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446068158, "post_id": 33401951, "comment_id": 54595289, "body": "@MethodMan And surely you are not blind, I wear glasses and my glasses point me to the point ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4664405"}, "edited": false, "score": 0, "creation_date": 1446068499, "post_id": 33401951, "comment_id": 54595463, "body": "So how to avoid that? Everything works fine - just the saving does not work"}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1446068548, "post_id": 33401951, "comment_id": 54595492, "body": "I&#39;ll post the fix for you now"}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 1, "creation_date": 1446069013, "post_id": 33401951, "comment_id": 54595751, "body": "@Jackson30 Did you get the problem of your code? You are showing a dialog and reading FileName from other dialog that is obviously empty :)"}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1446069418, "post_id": 33401951, "comment_id": 54595978, "body": "By the way you should know, while you can only select on accepted answer, but you can kindly vote up for as many answer as you find helpful including the accepted one, by click on up arrow near the answer.  This makes answers more useful for future readers :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4664405"}, "edited": false, "score": 0, "creation_date": 1446106162, "post_id": 33401951, "comment_id": 54608346, "body": "Yes I did. I had too less reputation but now it works! :)"}], "tags": [], "owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "is_accepted": true, "score": 2, "last_activity_date": 1446069145, "last_edit_date": 1446069145, "creation_date": 1446067902, "answer_id": 33401951, "question_id": 33401854, "link": "https://stackoverflow.com/questions/33401854/savefiledialog-does-not-save-the-filename-or-path/33401951#33401951", "title": "SaveFileDialog does not save the filename or path", "body": "<p>The main problem you have is using 2 instance of <code>SaveFileDialog</code>.</p>\n\n<p>You show one dialog and then try to read <code>File</code> from another dialog that is obviously empty.</p>\n\n<p>Pay attention that in your button click you are creating a new local instance and show it, and then in <code>FileOk</code> you are using another instance that seems to be a form level member.</p>\n\n<hr>\n\n<p><strong>Fix 1:</strong>\nYou can simply remove  <code>SaveFileDialog saveFileDialog1 = new SaveFileDialog();</code> because it seems you have saveFileDialog1 as a member of your form.</p>\n\n<p><strong>Fix 2:</strong>\nYou can use <code>SaveFileDialog</code> this way:</p>\n\n<pre><code>var sfd= new SaveFileDialog();\n//Other initializations ...\n//sfd.Filter= \"Text files (*.txt)|*.txt|All files (*.*)|*.*\";\n//sfd.DefaultExt = \"txt\";\n\nif(sfd.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n{\n    MessageBox.Show(sfd.FileName);\n    //\u0650Do something for save\n}\nelse\n{\n    //Do something for cancel if you want\n}\n</code></pre>\n\n<p>Then you can access to selected file using FileName property, for example MessageBox.Show(sfd.FileName);</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4664405"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2512, "favorite_count": 1, "accepted_answer_id": 33401951, "answer_count": 2, "score": 0, "last_activity_date": 1446069145, "creation_date": 1446067456, "question_id": 33401854, "link": "https://stackoverflow.com/questions/33401854/savefiledialog-does-not-save-the-filename-or-path", "title": "SaveFileDialog does not save the filename or path", "body": "<p>I want to use a SaveFileDialog and when clicking on the Save Button I want to save the filename and the path into seperate variables. Here is the code:</p>\n\n<pre><code> private void Button_Click(object sender, EventArgs e)\n    {\n        SaveFileDialog saveFileDialog1 = new SaveFileDialog();\n        saveFileDialog1.FileName = \"SaveFile\";\n        saveFileDialog1.DefaultExt = \".txt\";\n        saveFileDialog1.Filter = \"Text Files (*.txt)|*.txt\";\n        saveFileDialog1.Title = \"Save a Text File\";\n        saveFileDialog1.FileOk += saveFileDialog1_FileOk;\n        saveFileDialog1.ShowDialog();\n    }\n\n    private void saveFileDialog1_FileOk(object sender, CancelEventArgs e)\n    {\n            string filename = System.IO.Path.GetFileName(saveFileDialog1.FileName);\n            string name = saveFileDialog1.FileName;\n\n            var test = System.IO.Path.GetDirectoryName(saveFileDialog1.FileName);\n        }\n</code></pre>\n\n<p>The dialog opens and it triggers the saveFileDialog1_FileOk Event but I get an empty string for the filename and the solution for getting the path (without filename) does not work. What am I doing wrong?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 415, "user_id": 1570093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f035b57df122d980a84e826f64bbd3?s=128&d=identicon&r=PG", "display_name": "Tim Freese", "link": "https://stackoverflow.com/users/1570093/tim-freese"}, "edited": false, "score": 2, "creation_date": 1446067216, "post_id": 33401711, "comment_id": 54594832, "body": "This must be homework or some kind of test question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3594120"}, "reply_to_user": {"reputation": 415, "user_id": 1570093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f035b57df122d980a84e826f64bbd3?s=128&d=identicon&r=PG", "display_name": "Tim Freese", "link": "https://stackoverflow.com/users/1570093/tim-freese"}, "edited": false, "score": 0, "creation_date": 1446067433, "post_id": 33401711, "comment_id": 54594938, "body": "No. It&#39;s not. I am trying learn c sharp on my own by coding examples."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 2, "creation_date": 1446067496, "post_id": 33401711, "comment_id": 54594962, "body": "start reading some tutorials as well there are tons of free examples online in regard to tutorials <a href=\"http://www.csharp-station.com/Tutorial/CSharp/SmartConsoleSetup.aspx\" rel=\"nofollow noreferrer\">csharp-station.com/Tutorial/CSharp/SmartConsoleSetup.aspx</a>"}, {"owner": {"reputation": 11882, "user_id": 8745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2f99dd64c734457165e8a584b4b281?s=128&d=identicon&r=PG", "display_name": "JB King", "link": "https://stackoverflow.com/users/8745/jb-king"}, "edited": false, "score": 0, "creation_date": 1446067632, "post_id": 33401711, "comment_id": 54595029, "body": "You could make public members for another possible implementation here,"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1446067708, "post_id": 33401711, "comment_id": 54595067, "body": "This question doesn&#39;t seem to make sense. It&#39;s not clear what you&#39;re asking, because your assertions do not seem to correlate with the code you&#39;ve written."}], "answers": [{"comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1446068471, "post_id": 33401843, "comment_id": 54595444, "body": "<i>&quot;True,&quot;</i> What is true, exactly?"}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1446068796, "post_id": 33401843, "comment_id": 54595627, "body": "@JonathonReinhart, from my reading it&#39;s asking the difference between &#39;fields&#39; and &#39;properties&#39;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3594120"}, "edited": false, "score": 0, "creation_date": 1446071224, "post_id": 33401843, "comment_id": 54596743, "body": "@Gread.And.Powerful.Oz  You are right. The get set declaration were off. When i fixed them I was able to access the values via member and via properties.  Thank you for not calling my question and statements &quot;non sense&quot; unlike others and answering."}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "edited": false, "score": 0, "creation_date": 1446071607, "post_id": 33401843, "comment_id": 54596893, "body": "@user3594120, I think they weren&#39;t calling the code nonsense, but the statements about the ctors are a bit unclear and took me some interpolation to assume what was trying to be said. I don&#39;t know where those statements came from, but if from another place, well they could fix them to be more clear."}], "tags": [], "owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "is_accepted": false, "score": 1, "last_activity_date": 1446067407, "creation_date": 1446067407, "answer_id": 33401843, "question_id": 33401711, "link": "https://stackoverflow.com/questions/33401711/constructor-initialization-vs-get-set-initialization/33401843#33401843", "title": "Constructor initialization vs get set initialization", "body": "<p>True, but your implementation of the get/set is off:</p>\n\n<pre><code>public int PEmpId {\n    set { empId = value; }\n    get { return empId; }\n}\npublic string PEmpName {\n    set { empName = value; }\n    get { return empName; }\n}\n</code></pre>\n\n<p>unless you're wanting \"automatic (or implicit) properties\", then you don't need the <code>empId</code> or <code>empName</code> fields.</p>\n"}, {"tags": [], "owner": {"reputation": 637210, "user_id": 69083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db0cdfd3fe268e270ec481a73046c2f?s=128&d=identicon&r=PG", "display_name": "Guffa", "link": "https://stackoverflow.com/users/69083/guffa"}, "is_accepted": false, "score": 4, "last_activity_date": 1446067616, "creation_date": 1446067616, "answer_id": 33401891, "question_id": 33401711, "link": "https://stackoverflow.com/questions/33401711/constructor-initialization-vs-get-set-initialization/33401891#33401891", "title": "Constructor initialization vs get set initialization", "body": "<p>Those statements are nonsense. There is no relation between how members are initialised and how you can access them.</p>\n\n<p>The <code>emp</code> class has both member variables and properties. If you initialise the member variables you can get the values from the member variables. If you initialise the properties you can get the values from the properties.</p>\n\n<p>The constructor that takes parameters uses those values to initialise the member variables. That means that you have values in the member variables, so you can use those. It doesn't however keep you from also initialising the properties and use those if you like.</p>\n"}, {"tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": false, "score": 0, "last_activity_date": 1446067878, "creation_date": 1446067878, "answer_id": 33401948, "question_id": 33401711, "link": "https://stackoverflow.com/questions/33401711/constructor-initialization-vs-get-set-initialization/33401948#33401948", "title": "Constructor initialization vs get set initialization", "body": "<blockquote>\n  <p>A class object if initialized using a constructor then the member\n  variables can only be accessed only directly (objectname.variablename)\n  via a member method.</p>\n  \n  <p>If a class object is initialized using get;set; then the member\n  variables can only be accessed only via get;set; properties.</p>\n</blockquote>\n\n<p>Both statements are untrue. The way of member initialization is not directly connected to the how you can access them. The latter is specified by the <em>access modifier</em> (<code>private</code>, <code>public</code> etc.) when talking about referencing the members directly. If you make your fields public, then they can be accessed directly by any code using your class, no matter how they were instantiated. On the other hand, if you make them private, then only code inside the class itself has access to them and it's up to you how this access will be implemented. You can expose a getter and/or setter, create a method that will change their values, or both (or none). All these options are possible every time, regardless of the way of initialization.</p>\n"}, {"tags": [], "owner": {"reputation": 4600, "user_id": 463206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4edc6d888e98324130d6de9ff0f37f8?s=128&d=identicon&r=PG&f=1", "display_name": "radarbob", "link": "https://stackoverflow.com/users/463206/radarbob"}, "is_accepted": false, "score": 0, "last_activity_date": 1446068297, "creation_date": 1446068297, "answer_id": 33402044, "question_id": 33401711, "link": "https://stackoverflow.com/questions/33401711/constructor-initialization-vs-get-set-initialization/33402044#33402044", "title": "Constructor initialization vs get set initialization", "body": "<blockquote>\n  <p>Are these statements true? </p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>am I missing something here?</p>\n</blockquote>\n\n<p>Yes. It appears to me that you do not understand </p>\n\n<ul>\n<li>access modifiers. e.g. <code>public</code>, <code>private</code>, etc.</li>\n<li>Properties vis-a-vis Fields</li>\n<li>The general idea of information hiding, a.k.a. encapsulation.</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3594120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1446068297, "creation_date": 1446066950, "last_edit_date": 1446067474, "question_id": 33401711, "link": "https://stackoverflow.com/questions/33401711/constructor-initialization-vs-get-set-initialization", "title": "Constructor initialization vs get set initialization", "body": "<blockquote>\n  <p>A class object if initialized using a constructor then the member variables can only be accessed only directly (objectname.variablename) via a member method. </p>\n</blockquote>\n\n<p>And</p>\n\n<blockquote>\n  <p>If a class object is initialized using get;set; then the member variables can only be accessed only via get;set; properties. </p>\n</blockquote>\n\n<p>Are these statements true? Or am I missing something here?</p>\n\n<p>Following is the code and the output of the code.</p>\n\n<pre><code>using System;\npublic class emp {\n\n    private int empId = -1;\n    private string empName = string.Empty;\n\n    public int PEmpId {\n        set;\n        get;\n    }\n    public string PEmpName {\n        set;\n        get;\n    }\n\n    public emp(int i, string str) {\n        empId = i;\n        empName = str;\n    }\n\n    public void empDis(emp e) {\n        Console.WriteLine(\"Id =&gt;{0}&lt;=, Nm =&gt;{1}&lt;=\", e.empId, e.empName);\n        Console.WriteLine(\"Id =&gt;{0}&lt;=, Nm =&gt;{1}&lt;=\", e.PEmpId, e.PEmpName);\n    }\n\n    public emp() {}\n}\n\npublic class empUsage {\n\n    public void Main() {\n        emp e = new emp(1, \"R\");\n        e.empDis(e);\n        emp e1 = new emp();\n        e1.PEmpId = 1;\n        e1.PEmpName = \"W\";\n\n        e1.empDis(e1);\n    }\n\n}\n</code></pre>\n\n<p>Output:  </p>\n\n<pre>\nId =>1&lt;=, Nm =>R&lt;=  \nId =>0&lt;=, Nm =>&lt;=  \n\nId =>-1&lt;=, Nm =>&lt;=  \nId =>1&lt;=, Nm =>W&lt;=\n</pre>\n"}, {"tags": ["c#", "printing", "byte", "ascii", "epson"], "comments": [{"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1446157621, "post_id": 33401688, "comment_id": 54640551, "body": "To print graphics, you need to know what its documentation means by &quot;bit image&quot;, and how the data is formatted.  The command-list does not have that information."}, {"owner": {"reputation": 1, "user_id": 3938517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCHJS.png?s=128&g=1", "display_name": "Andr&#233;s Monsalve", "link": "https://stackoverflow.com/users/3938517/andr%c3%a9s-monsalve"}, "reply_to_user": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1446562012, "post_id": 33401688, "comment_id": 54787380, "body": "I found how data should be formatted in this post <a href=\"http://stackoverflow.com/questions/14099239/printing-a-bit-map-image-to-pos-printer-via-comport-in-c-sharp\" title=\"printing a bit map image to pos printer via comport in c sharp\">stackoverflow.com/questions/14099239/&hellip;</a> and then just send the bytes to the printer using the RawPrinter methods"}], "owner": {"reputation": 1, "user_id": 3938517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCHJS.png?s=128&g=1", "display_name": "Andr&#233;s Monsalve", "link": "https://stackoverflow.com/users/3938517/andr%c3%a9s-monsalve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1761, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1446157537, "creation_date": 1446066892, "last_edit_date": 1446157537, "question_id": 33401688, "link": "https://stackoverflow.com/questions/33401688/print-graphics-to-epson-printer-using-ascii-conversion-of-pos-commands-c", "title": "Print Graphics to Epson printer using ASCII conversion of POS commands C#", "body": "<p>Been trying to print to my EPSON TM-T88IIIP printer using C# and RawPrinterHelper class, so far i could only print text, now what i need is to print graphics but the EPSON documentation for this is not clear.</p>\n\n<p>This is my code for printing text:</p>\n\n<pre><code>    static string printerName = \"Epson TM-T88III\";\n    static string ESC = Convert.ToString((char)27);\n    static string LF = Convert.ToString((char)10);\n    static string GS = Convert.ToString((char)29);\n    static string cutCommand = $\"{ESC}@{GS}V{(char)66}{(char)0}\";\n\n    static void Main(string[] args)\n    {\n        PrintText();\n        //PrintGraphics();\n    }\n\n    private static void PrintText()\n    {                        \n        byte[] bytes = Encoding.Unicode.GetBytes($@\"{ESC}COMPANYNAME.{LF}COMPANY ADDRESS{LF}RANDOM TEXT{LF}__________________________________________{LF}{(char)179}1234567890123456789012345678901234567890{(char)179}{LF}{(char)196}{LF}\");\n        RawPrinterHelper.SendBytesToPrinter(printerName, bytes);\n        RawPrinterHelper.SendBytesToPrinter(printerName, Encoding.ASCII.GetBytes(cutCommand));\n    }\n</code></pre>\n\n<p><a href=\"http://www.codeproject.com/Tips/667062/Print-Image-to-Zebra-Printer-using-EPL-Language\" rel=\"nofollow\">RawPrinterHelper code</a></p>\n\n<p>And it works perfectly fine, now graphics command goes something like this:</p>\n\n<p>Command Definition = '// GS ( L   pL  pH   m  fn   a kc1/Kc2  b  xL  xH  yL  yH   c</p>\n\n<p>Command Execution = GS \"(L\" 139   7  48  67  48   \"G1\"   1 128   0 120   0  49</p>\n\n<p>Here is the problem, how to escape all those parameters in ASCII, my code so far:.</p>\n\n<pre><code>public static void PrintGraphics()\n    {                        \n        byte[] commandBytes = Encoding.ASCII.GetBytes($\"{ESC}@{GS}{(char)40}{(char)76}{(char)139}{(char)7}{(char)48}{(char)67}{(char)48}G1{(char)1}{(char)128}{(char)0}{(char)120}{(char)0}{(char)49}\");\n        //byte[] commandBytes = Encoding.Unicode.GetBytes($\"{ESC} (L 139 7 48 67 48 G1 1 128 0 120 0 49\");\n        byte[] imageBytes = Example.GetExampleImageBytes();\n        byte[] commandEndBytes = Encoding.ASCII.GetBytes($\"{ESC}@{GS}{(char)40}{(char)76}{(char)6}{(char)0}{(char)48}{(char)69}G1{(char)1}{(char)1}\");\n        byte[] endBytes = commandBytes.Concat(imageBytes).Concat(commandEndBytes).ToArray();\n        RawPrinterHelper.SendBytesToPrinter(printerName, endBytes);\n        RawPrinterHelper.SendBytesToPrinter(printerName, Encoding.ASCII.GetBytes(cutCommand));\n    }\n</code></pre>\n\n<p><a href=\"https://reference.epson-biz.com/modules/ref_escpos/index.php?content_id=72\" rel=\"nofollow\">EPSON Commands List</a></p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1446067370, "post_id": 33401678, "comment_id": 54594910, "body": "Shouldn&#39;t that counter variable be in a loop with what you are trying to accomplish?"}, {"owner": {"reputation": 35626, "user_id": 224370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CPH4K.jpg?s=128&g=1", "display_name": "Ian Mercer", "link": "https://stackoverflow.com/users/224370/ian-mercer"}, "edited": false, "score": 0, "creation_date": 1446067396, "post_id": 33401678, "comment_id": 54594923, "body": "You are getting the exception because the file DOES exist but you are looking in the wrong place. You stripped off the directory in the process of creating the new file name."}, {"owner": {"reputation": 6198, "user_id": 1524210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dgptu.jpg?s=128&g=1", "display_name": "David Tunnell", "link": "https://stackoverflow.com/users/1524210/david-tunnell"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1446067620, "post_id": 33401678, "comment_id": 54595021, "body": "@LarsTech I didn&#39;t want to post the entire program, it is in a foreach."}, {"owner": {"reputation": 6198, "user_id": 1524210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dgptu.jpg?s=128&g=1", "display_name": "David Tunnell", "link": "https://stackoverflow.com/users/1524210/david-tunnell"}, "reply_to_user": {"reputation": 35626, "user_id": 224370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CPH4K.jpg?s=128&g=1", "display_name": "Ian Mercer", "link": "https://stackoverflow.com/users/224370/ian-mercer"}, "edited": false, "score": 0, "creation_date": 1446067884, "post_id": 33401678, "comment_id": 54595152, "body": "@Ian Mercer You found the issue. Please put as an answer."}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1446067922, "post_id": 33401678, "comment_id": 54595169, "body": "A <code>for each</code> of what?  That doesn&#39;t make any sense.  Your posted code can only handle a blank or a 0.  The Path class is your friend, you should be using it a lot in your code."}, {"owner": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1446068210, "post_id": 33401678, "comment_id": 54595309, "body": "Does the problem go away if you do a Clean before a Build?"}], "answers": [{"comments": [{"owner": {"reputation": 6198, "user_id": 1524210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dgptu.jpg?s=128&g=1", "display_name": "David Tunnell", "link": "https://stackoverflow.com/users/1524210/david-tunnell"}, "edited": false, "score": 0, "creation_date": 1446067367, "post_id": 33401746, "comment_id": 54594906, "body": "I am still getting the same exception."}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 6198, "user_id": 1524210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dgptu.jpg?s=128&g=1", "display_name": "David Tunnell", "link": "https://stackoverflow.com/users/1524210/david-tunnell"}, "edited": false, "score": 0, "creation_date": 1446067564, "post_id": 33401746, "comment_id": 54594989, "body": "Maybe it&#39;s because it already exists from other tries at running your code?"}, {"owner": {"reputation": 35626, "user_id": 224370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CPH4K.jpg?s=128&g=1", "display_name": "Ian Mercer", "link": "https://stackoverflow.com/users/224370/ian-mercer"}, "edited": false, "score": 0, "creation_date": 1446067583, "post_id": 33401746, "comment_id": 54595002, "body": "This code is still stripping the directory path from <code>FileToSave</code>."}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 35626, "user_id": 224370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CPH4K.jpg?s=128&g=1", "display_name": "Ian Mercer", "link": "https://stackoverflow.com/users/224370/ian-mercer"}, "edited": false, "score": 0, "creation_date": 1446067621, "post_id": 33401746, "comment_id": 54595022, "body": "@IanMercer, that is true. But I don&#39;t know the intention of the OP."}], "tags": [], "owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "is_accepted": false, "score": 0, "last_activity_date": 1446067085, "creation_date": 1446067085, "answer_id": 33401746, "question_id": 33401678, "link": "https://stackoverflow.com/questions/33401678/file-copy-failing-to-create-files-with-same-name/33401746#33401746", "title": "File Copy failing to create files with same name", "body": "<p>use this instead:</p>\n\n<pre><code>string CurrentFileName = System.IO.Path.GetFileName(FileToSave);\nstring CurretFilePrefix = System.IO.Path.GetFileNameWithoutExtension(FileToSave);\nstring CurrentFileSuffix = System.IO.Path.GetExtension(FileToSave);\nstring UpdatedFileName = CurretFilePrefix + \"_\" + counter + \".\" + CurrentFileSuffix;\n</code></pre>\n\n<p>Then you have</p>\n\n<pre><code>File.Copy(FileToCopy, UpdatedFileName);\n</code></pre>\n\n<p>Are you sure this shouldn't be</p>\n\n<pre><code>File.Copy(FileToSave, UpdatedFileName); // FileToSave instead of FileToCopy\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6198, "user_id": 1524210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dgptu.jpg?s=128&g=1", "display_name": "David Tunnell", "link": "https://stackoverflow.com/users/1524210/david-tunnell"}, "edited": false, "score": 0, "creation_date": 1446067406, "post_id": 33401768, "comment_id": 54594927, "body": "The folder is generated before trying to save the file. That isn&#39;t whats causing the exception."}, {"owner": {"reputation": 35626, "user_id": 224370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CPH4K.jpg?s=128&g=1", "display_name": "Ian Mercer", "link": "https://stackoverflow.com/users/224370/ian-mercer"}, "edited": false, "score": 0, "creation_date": 1446067488, "post_id": 33401768, "comment_id": 54594960, "body": "The path in the exception message doesn&#39;t say &quot;C:\\ScrumWorks...&quot; so that&#39;s not where it&#39;s trying to save to."}, {"owner": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1446068154, "post_id": 33401768, "comment_id": 54595284, "body": "It doesn&#39;t matter if the folder exists, as you are not saving in that folder. You&#39;ve stripped the path of of <code>CurrentFileName</code>, so by default, it goes to the path of your .exe file."}, {"owner": {"reputation": 35626, "user_id": 224370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CPH4K.jpg?s=128&g=1", "display_name": "Ian Mercer", "link": "https://stackoverflow.com/users/224370/ian-mercer"}, "edited": false, "score": 3, "creation_date": 1446069057, "post_id": 33401768, "comment_id": 54595774, "body": "BTW you should use <code>Path.Combine</code> not <code>string.format</code> to combine path elements otherwise this code will not work correctly on other OS platforms."}], "tags": [], "owner": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "is_accepted": false, "score": 1, "last_activity_date": 1446069425, "last_edit_date": 1446069425, "creation_date": 1446067153, "answer_id": 33401768, "question_id": 33401678, "link": "https://stackoverflow.com/questions/33401678/file-copy-failing-to-create-files-with-same-name/33401768#33401768", "title": "File Copy failing to create files with same name", "body": "<p>As <code>CurrentFileName</code> is relative, you are trying to save the file in the location of your executable. Check that directory if your file exists.</p>\n\n<p>Also, there are much better ways to find if the file exists, and also to get the filename and extension of a given file.</p>\n\n<p>i.e. you should use the <a href=\"https://msdn.microsoft.com/en-us/library/system.io.file.exists%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>File.Exists</code></a> method to determine if the file exists, instead of using exceptions for flow control</p>\n\n<pre><code>if (File.Exists(FileToSave))\n{\n   FileToSave = GetNewFileName(FileToSave)\n}\ntry\n{\n  File.Copy(FileToCopy, FileToSave);\n}\ncatch (Exception)\n{\n  //something went really wrong\n}\n</code></pre>\n\n<p>You should also use the <code>Path</code> methods for getting parts of the name, instead of \"knowing\" to get the fifth part of the filename (<a href=\"https://msdn.microsoft.com/en-us/library/system.io.path.getextension%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>Path.GetExtension</code></a>, <a href=\"https://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>Path.GetFileNameWithoutExtension</code></a>)</p>\n\n<pre><code>private string GetNewFileName(string oldFileName){\n   var counter = 0;\n   var extension = Path.GetExtension(oldFileName);\n   var directory = Path.GetDirectoryName(oldFileName);\n   var fileName = Path.GetFileNameWithoutExtension(oldFileName);\n\n   var newFileName = Path.Combine(directory, \n      string.Format(\"{1}_{2}{3}\", filename, counter, extension);\n\n   while (File.Exists(newFileName)){\n      counter++;\n      newFileName = Path.Combine(directory, \n        string.Format(\"{1}_{2}{3}\", filename, counter, extension);\n   }\n\n   return newFileName;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35626, "user_id": 224370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CPH4K.jpg?s=128&g=1", "display_name": "Ian Mercer", "link": "https://stackoverflow.com/users/224370/ian-mercer"}, "is_accepted": true, "score": 2, "last_activity_date": 1446069216, "last_edit_date": 1446069216, "creation_date": 1446068898, "answer_id": 33402196, "question_id": 33401678, "link": "https://stackoverflow.com/questions/33401678/file-copy-failing-to-create-files-with-same-name/33402196#33402196", "title": "File Copy failing to create files with same name", "body": "<p>A good approach to this problem would include (i) a loop; (ii) use of <code>Path</code> expressions; (iii) avoidance of <code>try-catch</code> when you can test if the file exists; (iv) use of a specific Exception for the extremely unlikely case that two threads or processes are trying to do this same copy at the same time and each get past the <code>File.Exists</code> check; (v) avoidance of while-true-forever loops as even the best code can contain mistakes that could cause a spin-wait forever in production code on a server and it's better to instead have an exception that tells you when something has gone wrong.</p>\n\n<pre><code>        int counter = 0;\n        string proposedDest = dest;\n        while(counter &lt; 5000)\n        {\n            if (!File.Exists(proposedDest))\n            {\n                try\n                {\n                    File.Copy(fileToCopy, proposedDest);\n                    break;\n                }\n                catch (IOException ex) when ((uint)ex.HResult == 0x80070050)\n                {\n                }\n            }\n            counter++;\n            proposedDest = Path.Combine(Path.GetDirectoryName(dest),\n                Path.GetFileNameWithoutExtension(dest) + \n                \"_\" + counter + Path.GetExtension(dest));\n        }\n        ;\n        if (counter == 5000) \n           throw new Exception($\"Could not copy file {fileToCopy} too many retries\");\n</code></pre>\n\n<p>[A better approach would also not use hard coded constants littered through the code ;)]</p>\n"}], "owner": {"reputation": 6198, "user_id": 1524210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/dgptu.jpg?s=128&g=1", "display_name": "David Tunnell", "link": "https://stackoverflow.com/users/1524210/david-tunnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2366, "favorite_count": 0, "accepted_answer_id": 33402196, "answer_count": 3, "score": 1, "last_activity_date": 1446069425, "creation_date": 1446066817, "last_edit_date": 1592644375, "question_id": 33401678, "link": "https://stackoverflow.com/questions/33401678/file-copy-failing-to-create-files-with-same-name", "title": "File Copy failing to create files with same name", "body": "<p>I am copying files from one location to another. I encountered an issue where sometimes a file with the same name would try to save and it would break the program. So I added the logic below to add a number to the filename before copying it:</p>\n<pre><code>                int counter = 0;\n                try\n                {\n                    File.Copy(FileToCopy, FileToSave);\n\n                }\n                catch (Exception)\n                {\n                    string CurrentFileName = FileToSave.Split('\\\\', '\\\\')[4];\n                    string CurretFilePrefix = CurrentFileName.Split('.')[0];\n                    string CurrentFileSuffix = CurrentFileName.Split('.')[1];\n                    string UpdatedFileName = CurretFilePrefix + &quot;_&quot; + counter + &quot;.&quot; + CurrentFileSuffix;\n                    File.Copy(FileToCopy, UpdatedFileName);\n                    counter++;\n                }\n</code></pre>\n<p>However, this is now causing a crash saying the file already exists:</p>\n<p><a href=\"https://i.stack.imgur.com/s5utP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s5utP.png\" alt=\"enter image description here\" /></a></p>\n<p>When I check the file does not exist:</p>\n<p><a href=\"https://i.stack.imgur.com/7y3f6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7y3f6.png\" alt=\"enter image description here\" /></a></p>\n<p>Why am I getting this exception? How do I save copies of these files?</p>\n"}, {"tags": ["c#", "win-universal-app", "contact", "profile-picture"], "comments": [{"owner": {"reputation": 3264, "user_id": 1783306, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/32kYg.jpg?s=128&g=1", "display_name": "gregkalapos", "link": "https://stackoverflow.com/users/1783306/gregkalapos"}, "edited": false, "score": 1, "creation_date": 1446067961, "post_id": 33401625, "comment_id": 54595184, "body": "It&#39;s the same for me... the thumbnails are always null, although there is an image in the picker popup. But it seems that we are not the only two with the problem: <a href=\"https://social.msdn.microsoft.com/Forums/expression/en-US/3aba81b1-5f87-4bc4-98a2-8c291bd1502d/missing-thumbnail-contact-on-desktop-uwp?forum=wpdevelop\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/expression/en-US/&hellip;</a> . It would be interesting to set it from code and then trying to read it back..."}], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "edited": false, "score": 0, "creation_date": 1451721449, "post_id": 34528754, "comment_id": 56871122, "body": "This does work, <i>if</i> you add the &#39;contacts&#39; capability to the app manifest, which is an unfortunate requirement and should be unneccesary. However, this is the only solution I know of, so thanks!"}], "tags": [], "owner": {"reputation": 36, "user_id": 5730481, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c7bafeb80cacc11a728f3a0f0b1339e2?s=128&d=identicon&r=PG", "display_name": "kaa", "link": "https://stackoverflow.com/users/5730481/kaa"}, "is_accepted": true, "score": 2, "last_activity_date": 1451711427, "last_edit_date": 1451711427, "creation_date": 1451475275, "answer_id": 34528754, "question_id": 33401625, "link": "https://stackoverflow.com/questions/33401625/cant-get-contact-profile-images-in-uwp/34528754#34528754", "title": "Can&#39;t Get Contact Profile Images in UWP", "body": "<p>The following code may help you:</p>\n\n<pre><code>ContactPicker cp = new ContactPicker();\nContact res = await cp.PickContactAsync();\nContactStore contactStore = await ContactManager.RequestStoreAsync(ContactStoreAccessType.AllContactsReadOnly);\nContact realContact = await contactStore.GetContactAsync(res.Id);\n</code></pre>\n"}], "owner": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 1, "accepted_answer_id": 34528754, "answer_count": 1, "score": 1, "last_activity_date": 1451711427, "creation_date": 1446066493, "question_id": 33401625, "link": "https://stackoverflow.com/questions/33401625/cant-get-contact-profile-images-in-uwp", "title": "Can&#39;t Get Contact Profile Images in UWP", "body": "<p>I am using the ContactPicker.PickContactAsync() api in a Windows 10 UWP (C#/XAML) project. I have tried using both my own code, and the sample project from the Windows 10 samples github repo, both have the same symtpom. The same symptom also occurs on both desktop and mobile OS', though it is primarily mobile I am interested in at this point.</p>\n\n<p>When I call the PickContactAync method the system picker UI is shown as expected. I scroll through my contacts and pick one that is showing a profile image within the picker (it doesn't seem to matter which contact I pick, they all behave the same way).</p>\n\n<p>The contact object return contains valid details (i.e the contacts name, email addresses etc) but SourceDisplayPicture, LargeDisplayPicture, SmallDisplayPicture and Thumbnail properties are all null. I cannot find any way to obtain the profile image(s) for a contact, even though I specifically picked a contact that dispalyed an image in the picker UI.</p>\n\n<p>Does anyone know how to get the profile image?</p>\n"}, {"tags": ["c#", "asp.net", "custom-controls"], "answers": [{"tags": [], "owner": {"reputation": 10890, "user_id": 393280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4f0bc239a1291a514e469127bd79e350?s=128&d=identicon&r=PG", "display_name": "palswim", "link": "https://stackoverflow.com/users/393280/palswim"}, "is_accepted": false, "score": 0, "last_activity_date": 1446066357, "creation_date": 1446066357, "answer_id": 33401583, "question_id": 33401582, "link": "https://stackoverflow.com/questions/33401582/how-do-i-allow-templated-controls-in-a-control-that-doesnt-inherit-from-webcont/33401583#33401583", "title": "How do I allow Templated Controls in a Control that doesn&#39;t inherit from WebControl?", "body": "<p>Of course you must inherit from the <code>Control</code> class, but the magic happens with the <code>ParseChildren</code> attribute. To use Template variables, you must set the <code>ParseChildren</code> attribute to <code>true</code>.</p>\n\n<pre><code>[ParseChildren(true)] // Don't treat tags within the Control as properties, but as Controls\npublic class CustomControl : Control\n{\n    // ...\n}\n</code></pre>\n\n<p>I found this after inspecting the <code>WebControl</code> class and <a href=\"http://bchavez.bitarmory.com/archive/2008/07/27/parsechildren-persistchildren-persistencemode.innerproperty.aspx\" rel=\"nofollow\" title=\"Article about Template Attributes\">reading more about the attribute</a>.</p>\n\n<p>The <code>ParseChildren</code> attribute specifies how to interpret your ASP.NET code, whether the objects inside represent Controls (<code>ParseChildren(false)</code>) or Properties (<code>ParseChilren(true)</code>). Since your Template variables are actually Properties, you must set the <code>ParseChildren</code> attribute to <code>true</code>. Unfortunately, this also means that you can't mix Templated and non-Templated controls in your ASP.NET code, like this:</p>\n\n<pre><code>&lt;prefix:CustomControl ID=\"Control1\" runat=\"server\"&gt;\n    &lt;Content&gt;\n        &lt;asp:Literal ID=\"ExampleContent\" runat=\"server\" Text=\"Look at me\" /&gt;\n    &lt;/Content&gt;\n    &lt;asp:Literal ID=\"ControlNonTemplate\" runat=\"server\" Text=\"This will not work (Parser error)\" /&gt;\n&lt;/prefix:CustomControl&gt;\n</code></pre>\n"}], "owner": {"reputation": 10890, "user_id": 393280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4f0bc239a1291a514e469127bd79e350?s=128&d=identicon&r=PG", "display_name": "palswim", "link": "https://stackoverflow.com/users/393280/palswim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446066357, "creation_date": 1446066357, "question_id": 33401582, "link": "https://stackoverflow.com/questions/33401582/how-do-i-allow-templated-controls-in-a-control-that-doesnt-inherit-from-webcont", "title": "How do I allow Templated Controls in a Control that doesn&#39;t inherit from WebControl?", "body": "<p>In all of the <a href=\"https://msdn.microsoft.com/en-us/library/ms178657.aspx\" rel=\"nofollow\" title=\"Walkthrough of creating a Templated Server Control\">examples of Templated server controls</a>, the class to contain the Template inherit from the <code>CompositeControl</code> class, which itself inherits from the <code>WebControl</code> class.</p>\n\n<p>In my application, I want to <a href=\"https://msdn.microsoft.com/en-us/library/aa478964.aspx\" rel=\"nofollow\" title=\"Information about creating Templated Server Controls\">use Templates in my Control</a>, but also to inherit from a different class, which does not inherit from either <code>CompositeControl</code> or <code>WebControl</code>.</p>\n\n<p>\"Template\" could mean a whole host of things, but I am asking about code like this:</p>\n\n<pre><code>[\nBrowsable(false),\nDefaultValue(null),\nDescription(\"The Template for the content of the Control\"),\nPersistenceMode(PersistenceMode.InnerProperty),\nTemplateInstance(TemplateInstance.Single),\n]\npublic ITemplate Content { get; set; }\n</code></pre>\n\n<p>and ASP.NET code like this:</p>\n\n<pre><code>&lt;prefix:CustomControl ID=\"Control1\" runat=\"server\"&gt;\n    &lt;Content&gt;\n        &lt;asp:Literal ID=\"ExampleContent\" runat=\"server\" Text=\"Look at me\" /&gt;\n    &lt;/Content&gt;\n&lt;/prefix:CustomControl&gt;\n</code></pre>\n\n<p>But, I have noticed that when I inherit from the <code>WebControl</code> class, the <code>ITemplate</code> variables in my object have the data I would expect, whereas if I don't inherit from <code>WebControl</code>, those variables have <code>NULL</code> data.</p>\n\n<p>How do I use Template variables, but also inherit from any class of my choosing?</p>\n"}, {"tags": ["c#", "sum", "add"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446067535, "post_id": 33401605, "comment_id": 54594976, "body": "how can i update my table value from lttotal.Text? thanks man."}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446067683, "post_id": 33401605, "comment_id": 54595057, "body": "@JGarma, That&#39;s a separate question and it&#39;s not obvious what to tell you from the example code given."}, {"owner": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446068448, "post_id": 33401605, "comment_id": 54595435, "body": "So i have a column &quot;Available&quot; on my Products table. I designed a form that has a textbox that will add its value and the current value from the &quot;Available&quot; column. How can i generate the code? So far, this is my code. Sorry, noob here."}, {"owner": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446068528, "post_id": 33401605, "comment_id": 54595480, "body": "int a = Convert.ToInt32(ltAvailable.Text);         int b = Convert.ToInt32(txtInput.Text);         ltTotal.Text = (a + b).ToString();          con.Open();         SqlCommand cmd = new SqlCommand();         cmd.Connection = con;         cmd.CommandText = &quot;UPDATE Products SET Available=@Available WHERE ProductID=@ProductID&quot;;         cmd.Parameters.AddWithValue(&quot;Available&quot;, ltAvailable.Text);         cmd.ExecuteNonQuery();         con.Close();         Response.Redirect(&quot;Details.aspx&quot;);"}, {"owner": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446068554, "post_id": 33401605, "comment_id": 54595497, "body": "how can i convert my comment to a code one haha sorry"}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446069085, "post_id": 33401605, "comment_id": 54595790, "body": "@JGarma you can use the back-tick ` or graph character. The one below the tilde ~ on your keyboard. (Assuming QWERTY keyboard)"}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446069310, "post_id": 33401605, "comment_id": 54595926, "body": "@JGarma, that&#39;s beyond the scope of this question. Please do some research. There are examples out there of adding a &quot;table&quot; to a WinForm and updating the columns, etc. Try that and then comeback and ask another question."}], "tags": [], "owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "is_accepted": false, "score": 5, "last_activity_date": 1446066440, "creation_date": 1446066440, "answer_id": 33401605, "question_id": 33401578, "link": "https://stackoverflow.com/questions/33401578/cs0029-cannot-implicitly-convert-type-int-to-string/33401605#33401605", "title": "CS0029: Cannot implicitly convert type &#39;int&#39; to &#39;string&#39;", "body": "<p>Here:</p>\n\n<pre><code>ltTotal.Text = (a + b).ToString();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446067580, "post_id": 33401624, "comment_id": 54595001, "body": "ow can i update my table value from lttotal.Text? thanks man"}, {"owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "reply_to_user": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "edited": false, "score": 0, "creation_date": 1446067632, "post_id": 33401624, "comment_id": 54595028, "body": "what table value? you don&#39;t mention any table in your question. probably better for a separate question"}], "tags": [], "owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1446066493, "creation_date": 1446066493, "answer_id": 33401624, "question_id": 33401578, "link": "https://stackoverflow.com/questions/33401578/cs0029-cannot-implicitly-convert-type-int-to-string/33401624#33401624", "title": "CS0029: Cannot implicitly convert type &#39;int&#39; to &#39;string&#39;", "body": "<pre><code>protected void btnAdd_Click(object sender, EventArgs e)\n{\n    int a = Convert.ToInt32(ltAvailable.Text);\n    int b = Convert.ToInt32(txtInput.Text);\n    ltTotal.Text = (a + b).ToString();\n</code></pre>\n\n<p>You just need to call <code>.ToString()</code> on your calculation result</p>\n\n<p>This would also work</p>\n\n<pre><code>ltTotal.Text = Convert.ToString(a + b)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5500264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e38c73212d87f9beb304f0e0cf063e?s=128&d=identicon&r=PG&f=1", "display_name": "JGarma", "link": "https://stackoverflow.com/users/5500264/jgarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5158, "favorite_count": 0, "closed_date": 1446066632, "answer_count": 2, "score": -3, "last_activity_date": 1446066493, "creation_date": 1446066340, "question_id": 33401578, "link": "https://stackoverflow.com/questions/33401578/cs0029-cannot-implicitly-convert-type-int-to-string", "closed_reason": "Duplicate", "title": "CS0029: Cannot implicitly convert type &#39;int&#39; to &#39;string&#39;", "body": "<pre><code>protected void btnAdd_Click(object sender, EventArgs e)\n{\n    int a = Convert.ToInt32(ltAvailable.Text);\n    int b = Convert.ToInt32(txtInput.Text);\n    ltTotal.Text = a + b;\n</code></pre>\n\n<p>How can i add values in a literal and a textbox? Thanks</p>\n"}, {"tags": ["c#", ".net", "encoding", "rfid", "zebra-printers"], "answers": [{"comments": [{"owner": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 0, "creation_date": 1446069578, "post_id": 33402251, "comment_id": 54596060, "body": "I will be using UHF EPC Gen 2 (ISO 18000-6C). Given you code, all I can understand is that it is saying it is RF write, hex, data is 1234. I am confused at to where we set up RFID parameters in the ZPL code?"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 1, "creation_date": 1446069615, "post_id": 33402251, "comment_id": 54596080, "body": "What are you going to actually write to the tag?"}, {"owner": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 0, "creation_date": 1446069687, "post_id": 33402251, "comment_id": 54596124, "body": "For the RFID, an inventory tracking id number. On the tag itself, hello world works for now, but eventually probably the id number and the name of what we are tracking."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 1, "creation_date": 1446069774, "post_id": 33402251, "comment_id": 54596165, "body": "I added the extra line in, to init for EPC Gen2. It&#39;s the same as their example (^RS8)."}, {"owner": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 0, "creation_date": 1446069937, "post_id": 33402251, "comment_id": 54596245, "body": "You are awesome. I will read the pages you mentioned and then code on this. I think it will work, and if it does I will mark yours as the answer. I bow in humble thanks for your assistance thus far. I&#39;ll keep you informed."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 0, "creation_date": 1446070044, "post_id": 33402251, "comment_id": 54596288, "body": "Good luck! Be sure to give me an update either way ;) RFID stuff is a lot of fun, but I mostly play with MiFare (ISO 14443A) and Tag-It (ISO 15693).Have fun :)"}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "reply_to_user": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 1, "creation_date": 1446070136, "post_id": 33402251, "comment_id": 54596323, "body": "BTW - the big thing to take out of this (at least, I&#39;m willing to bet money) is that the commands to print and encode are sent together - all in one request."}, {"owner": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "edited": false, "score": 0, "creation_date": 1446581339, "post_id": 33402251, "comment_id": 54799796, "body": "I have not been able to verify RFID encoding yet. I ran into this problem: <a href=\"http://bit.ly/1Mfrj2v\" rel=\"nofollow noreferrer\">bit.ly/1Mfrj2v</a> on my way. Once I can print text on a label as intended, I feel comfortable with using the approach with above. Can you please help?"}], "tags": [], "owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "is_accepted": false, "score": 2, "last_activity_date": 1446069727, "last_edit_date": 1446069727, "creation_date": 1446069132, "answer_id": 33402251, "question_id": 33401575, "link": "https://stackoverflow.com/questions/33401575/how-to-encode-rfid-label-for-zebra-printer-using-c-and-net/33402251#33402251", "title": "How to encode RFID label for Zebra Printer using C# and .NET?", "body": "<p>Some notes -</p>\n\n<p>Check out page 381 (table 18) for a list of commands compatible with that printer.</p>\n\n<p>Pages 400 and 401 contain some writing examples. The first one is:</p>\n\n<pre><code>^XA\n^RS8\n^RFW,A^FD00 my data^FS\n^XZ\n</code></pre>\n\n<p>Let's dissect this. ^XA (start) and ^XZ (end). Plus two others: ^RS and ^RF.</p>\n\n<p>^RS \u2013 Set Up RFID Parameters</p>\n\n<blockquote>\n<pre><code>UHF Printers\n0 = None\n1 = EPC Class 0\n2 = EPC Class 0 Plus\n3 = EPC Class 1 64-bit\n4 = EPC Class 1 96-bit\n5 = UCODE EPC 1.19\n6 = Impinj Class 0 Plus\n7 = ISO 18000-06A\n8 = EPC Class 1, Generation 2 (Gen 2)\n9 = ISO 18000-06B\n</code></pre>\n</blockquote>\n\n<p>Not sure which transponder you're using. Adjust accordingly.</p>\n\n<p>Then there's ^RF: Read or Write RFID Format.\nIn this example, they're doing a write operation in ASCII (^RFW,A) </p>\n\n<p>Next, we see</p>\n\n<pre><code>^FD00 my data^FS\n</code></pre>\n\n<p>Which is the begin and end marker for data.</p>\n\n<hr>\n\n<p>Another example, this time writing hex:</p>\n\n<pre><code>^XA\n^RFW,H^FD1234^FS\n^XZ\n</code></pre>\n\n<p>You see the <code>,H</code> used, instead of <code>,A</code>. Again, we see ^FD and ^FS delimiting data.</p>\n\n<hr>\n\n<p><strong>In Summary...</strong></p>\n\n<p>I'm guessing that you want something like this (let's assume you're writing hex):</p>\n\n<pre><code>^XA\n^FO10,10\n^A0,100,150\n^FDHello, World!^FS\n^RS8\n^RFW,H^FD1234^FS\n^XZ\n</code></pre>\n\n<p>So, in c#:</p>\n\n<pre><code>string ZPLString = \"^XA^FO10,10^A0,100,150^FDHello, World!^FS^RS8^RFW,H^FD1234^FS^XZ\";\n</code></pre>\n\n<p>You MAY need to throw in a <code>^RS</code> and go off of the above chart.\nWhen sending the command string, you don't need to add in any extra line feeds or CR's.</p>\n\n<p>std_disclaimer: I have only used ZPL to print, not for RFID encoding. Make sure that you have the correct transponders for this unit. According to docs, it supports tags compatible with UHF EPC Gen 2 V1.2/ \nISO 18000-6C.</p>\n\n<p>I would test out your ZPL using Zebra's utilities first. If it works, then start playing in c#. Just trying to limit the number of variables at play ;)</p>\n"}], "owner": {"reputation": 1219, "user_id": 4005362, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e44b354813847e0dc637b9580e2ebe4b?s=128&d=identicon&r=PG&f=1", "display_name": "hlyates", "link": "https://stackoverflow.com/users/4005362/hlyates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4429, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447105714, "creation_date": 1446066314, "last_edit_date": 1495539872, "question_id": 33401575, "link": "https://stackoverflow.com/questions/33401575/how-to-encode-rfid-label-for-zebra-printer-using-c-and-net", "title": "How to encode RFID label for Zebra Printer using C# and .NET?", "body": "<p><strong>Problem</strong></p>\n\n<p>I am using Visual Studio, C#, and .NET. I am also using ZPL commands to print hello world to a Zebra ZD500R. I have been currently unsuccessful in figuring out how to encode an RFID label using the above. I know a SDK for java exists, but my environment is a strict Microsoft stack. </p>\n\n<p>The RFID label that is printed has VOID printed on the entire label. Something like VOIDVOIDVOIDVOIDVOIDVOID. I have included the updated code below. </p>\n\n<p><strong>Code</strong></p>\n\n<p>Here is the following code I have currently written after studying Zebra documentation and sample code: </p>\n\n<pre><code>  public static void PrintLabels()\n        {\n            try\n            {\n\n                string ipAddress = \"127.0.0.1\";\n                int port = 1337;\n\n                // ZPL Command(s)\n                string ZPLString =\n                \"CT~~CD,~CC^~CT~\" +\n                \"^XA~TA000~JSN^LT0^MNW^MTT^PON^PMN^LH0,0^JMA^PR4,4~SD10^JUS^LRN^CI0^XZ\" +\n                \"^XA\" +\n                \"^MMT\" +\n                \"^PW300\" +\n                \"^LL0526\" +\n                \"^LS0\" +\n                \"^FT267,433^A0I,42,40^FH\\\\^FDHello World^FS\" +\n                \"^RS8\" +\n                \"^RFW,H^FD1234^FS\" +\n                \"^PQ1,0,1,Y^XZ\";  \n\n\n\n\n\n\n                // Open connection\n                System.Net.Sockets.TcpClient client = new System.Net.Sockets.TcpClient();\n                client.Connect(ipAddress, port);\n\n                // Write ZPL String to connection\n                System.IO.StreamWriter writer =\n                new System.IO.StreamWriter(client.GetStream());\n                writer.Write(ZPLString);\n                writer.Flush();\n\n                // Close Connection\n                writer.Close();\n                client.Close();\n\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine(ex.Message);\n            }\n        }\n</code></pre>\n\n<p>This is a rudimentary example, but does the trick by printing hello world. As far as I know, I was thinking the RFID encoding aspect should be a new line in the string ZPLString. Unfortunately, when I looked into the Zebra programming book I did not see any ZPL commands to confirm this thought.  </p>\n\n<p><strong>Attempts</strong></p>\n\n<p>I have done the following in an attempt to solve this problem. </p>\n\n<ul>\n<li>RTFM for Zebra ZPL found <a href=\"https://www.zebra.com/content/dam/zebra/manuals/en-us/software/zpl-zbi2-pm-en.pdf\" rel=\"nofollow noreferrer\">here</a></li>\n<li>Downloaded the Zebra Label designer. No encoding function found. </li>\n<li>Browsed the ZPL sample code. </li>\n<li>Checked stack overflow for relevant questions. Closest I found was <a href=\"https://stackoverflow.com/questions/16610260/communication-with-zebra-rfid-printer-c-sharp-net\">this</a> or <a href=\"https://stackoverflow.com/questions/16775701/verify-encoding-tags-by-zebra-printer-rz400\">this</a>, but still not my use case.  </li>\n</ul>\n\n<p>Any advice, tips, or comments would be deeply appreciated.</p>\n"}, {"tags": ["c#", ".net", "ftp"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446066038, "post_id": 33401495, "comment_id": 54594280, "body": "when you connect to the same ftp site via file-zilla do you actually upload successfully using file-zilla"}, {"owner": {"reputation": 988, "user_id": 571723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be1759766cc3c5e34c82749523e888ea?s=128&d=identicon&r=PG", "display_name": "dmikester1", "link": "https://stackoverflow.com/users/571723/dmikester1"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446066081, "post_id": 33401495, "comment_id": 54594304, "body": "yes, uploading and downloading works fine with filezilla"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446066145, "post_id": 33401495, "comment_id": 54594344, "body": "try doing this using <code>WebClient</code> here <a href=\"http://stackoverflow.com/questions/15268760/upload-file-to-ftp-using-c-sharp\" title=\"upload file to ftp using c sharp\">stackoverflow.com/questions/15268760/&hellip;</a>"}, {"owner": {"reputation": 988, "user_id": 571723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be1759766cc3c5e34c82749523e888ea?s=128&d=identicon&r=PG", "display_name": "dmikester1", "link": "https://stackoverflow.com/users/571723/dmikester1"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446066739, "post_id": 33401495, "comment_id": 54594622, "body": "can I do that with an httppostedfile?  I don&#39;t have a file path for the httppostedfile."}, {"owner": {"reputation": 1332, "user_id": 1237333, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/fwmik.jpg?s=128&g=1", "display_name": "Sin5k4", "link": "https://stackoverflow.com/users/1237333/sin5k4"}, "edited": false, "score": 0, "creation_date": 1446471898, "post_id": 33401495, "comment_id": 54742784, "body": "do you have a firewall running somewhere?"}, {"owner": {"reputation": 988, "user_id": 571723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be1759766cc3c5e34c82749523e888ea?s=128&d=identicon&r=PG", "display_name": "dmikester1", "link": "https://stackoverflow.com/users/571723/dmikester1"}, "edited": false, "score": 0, "creation_date": 1446472127, "post_id": 33401495, "comment_id": 54742918, "body": "I have disabled my Kaspersky firewall.  I will try disabling my Windows firewall to see if that helps at all."}, {"owner": {"reputation": 988, "user_id": 571723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be1759766cc3c5e34c82749523e888ea?s=128&d=identicon&r=PG", "display_name": "dmikester1", "link": "https://stackoverflow.com/users/571723/dmikester1"}, "edited": false, "score": 0, "creation_date": 1446472579, "post_id": 33401495, "comment_id": 54743215, "body": "Getting same response after disabling Windows firewall as well."}, {"owner": {"reputation": 224, "user_id": 2463038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/100e012403ac21a5219f9f39bc1fc990?s=128&d=identicon&r=PG", "display_name": "Phillip Morton", "link": "https://stackoverflow.com/users/2463038/phillip-morton"}, "edited": false, "score": 0, "creation_date": 1446477077, "post_id": 33401495, "comment_id": 54746247, "body": "Hi @dmikester1, are you attempting to connect to a FTP or FTPS?"}, {"owner": {"reputation": 988, "user_id": 571723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be1759766cc3c5e34c82749523e888ea?s=128&d=identicon&r=PG", "display_name": "dmikester1", "link": "https://stackoverflow.com/users/571723/dmikester1"}, "edited": false, "score": 0, "creation_date": 1446478567, "post_id": 33401495, "comment_id": 54747288, "body": "I am connecting to a regular FTP server."}, {"owner": {"reputation": 224, "user_id": 2463038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/100e012403ac21a5219f9f39bc1fc990?s=128&d=identicon&r=PG", "display_name": "Phillip Morton", "link": "https://stackoverflow.com/users/2463038/phillip-morton"}, "edited": false, "score": 0, "creation_date": 1446479560, "post_id": 33401495, "comment_id": 54748000, "body": "I&#39;ve just noticed your  <code>FtpWebRequest ftp = (FtpWebRequest)FtpWebRequest.Create(uploadUrl);</code> is resoving to potentially to a file that doesn&#39;t exist, as you state your uploadURL is the server, and the name of the file you&#39;re attempting to upload. Hence a access denied?  Try just making it <code>string uploadUrl = server;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 988, "user_id": 571723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be1759766cc3c5e34c82749523e888ea?s=128&d=identicon&r=PG", "display_name": "dmikester1", "link": "https://stackoverflow.com/users/571723/dmikester1"}, "is_accepted": true, "score": 2, "last_activity_date": 1446481234, "creation_date": 1446481234, "answer_id": 33482186, "question_id": 33401495, "link": "https://stackoverflow.com/questions/33401495/ftpwebrequest-getresponse-is-throwing-550-access-denied/33482186#33482186", "title": "ftpwebrequest.getresponse is throwing 550 access denied", "body": "<p>OK, I tinkered around with this some more after reading through the comments here.  I went into my Kaspersky settings and disabled scanning of port 20 and 21.  Boom!  File is there.  Now it is coming across empty for some reason, so I will investigate that or come back for some help here! :)</p>\n"}], "owner": {"reputation": 988, "user_id": 571723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/be1759766cc3c5e34c82749523e888ea?s=128&d=identicon&r=PG", "display_name": "dmikester1", "link": "https://stackoverflow.com/users/571723/dmikester1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 0, "accepted_answer_id": 33482186, "answer_count": 1, "score": 5, "last_activity_date": 1446481234, "creation_date": 1446065962, "question_id": 33401495, "link": "https://stackoverflow.com/questions/33401495/ftpwebrequest-getresponse-is-throwing-550-access-denied", "title": "ftpwebrequest.getresponse is throwing 550 access denied", "body": "<p>I am trying to figure out how to get this file uploaded to my ftp server in C#.  When it calls <code>getResponse()</code> on <code>ftpwebrequest</code> it is throwing an error that says \"550 - access denied\".  I cannot figure out why.  I can connect to the server with Filezilla just fine using the same credentials.</p>\n\n<p>Here is my code that does the connection:</p>\n\n<pre><code>private void UploadFileToFTP(HttpPostedFile file, string server, string user, string pass)\n    {\n        string uploadUrl = server + file.FileName;\n        string uploadFileName = Path.GetFileName(file.FileName);\n\n        Stream streamObj = file.InputStream;\n        Byte[] buffer = new Byte[file.ContentLength];\n        streamObj.Read(buffer, 0, buffer.Length);\n        streamObj.Close();\n        streamObj = null;\n        try\n        {\n            SetMethodRequiresCWD();\n            FtpWebRequest ftp = (FtpWebRequest)FtpWebRequest.Create(uploadUrl);\n            //ftp.Method = WebRequestMethods.Ftp.MakeDirectory;\n            ftp.Method = WebRequestMethods.Ftp.UploadFile;\n            ftp.UsePassive = true;\n            ftp.Credentials = new NetworkCredential(user, pass);\n            FtpWebResponse CreateForderResponse = (FtpWebResponse)ftp.GetResponse();\n\n            if (CreateForderResponse.StatusCode == FtpStatusCode.PathnameCreated)\n            {\n\n                string ftpUrl = string.Format(\"{0}/{1}\", uploadUrl, uploadFileName);\n\n                FtpWebRequest requestObj = FtpWebRequest.Create(ftpUrl) as FtpWebRequest;\n\n                requestObj.KeepAlive = true;\n                requestObj.UseBinary = true;\n\n                requestObj.Method = WebRequestMethods.Ftp.UploadFile;\n                requestObj.Credentials = new NetworkCredential(user, pass);\n\n                Stream requestStream = requestObj.GetRequestStream();\n                requestStream.Write(buffer, 0, buffer.Length);\n                requestStream.Flush();\n                requestStream.Close();\n                requestObj = null;\n\n            }\n        }\n        catch (WebException e)\n        {\n            String status = ((FtpWebResponse)e.Response).StatusDescription;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "image-processing", "photoshop", "alpha", "blending"], "comments": [{"owner": {"reputation": 163, "user_id": 2535105, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/195de0f6c40a841ec005c1d45cddd0d8?s=128&d=identicon&r=PG", "display_name": "Terrordoll", "link": "https://stackoverflow.com/users/2535105/terrordoll"}, "edited": false, "score": 0, "creation_date": 1446066967, "post_id": 33401470, "comment_id": 54594722, "body": "Whoops, my bad! I just found the equation and it all works like a charm!  <a href=\"http://stackoverflow.com/questions/746899/how-to-calculate-an-rgb-colour-by-specifying-an-alpha-blending-amount\" title=\"how to calculate an rgb colour by specifying an alpha blending amount\">stackoverflow.com/questions/746899/&hellip;</a>  I&#39;ll search more thoroughly next time!"}], "answers": [{"comments": [{"owner": {"reputation": 577, "user_id": 2119915, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/qU9sD.png?s=128&g=1", "display_name": "Lonefish", "link": "https://stackoverflow.com/users/2119915/lonefish"}, "edited": false, "score": 1, "creation_date": 1475141803, "post_id": 36230193, "comment_id": 66827865, "body": "Small tip, since GetPixel is so horribly slow, maybe save it in a variable, or even better, use lockbits"}], "tags": [], "owner": {"reputation": 317, "user_id": 1523086, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/354d0f12bc8e9ac761e5c5c6852e0a07?s=128&d=identicon&r=PG", "display_name": "cad", "link": "https://stackoverflow.com/users/1523086/cad"}, "is_accepted": false, "score": 1, "last_activity_date": 1598887668, "last_edit_date": 1598887668, "creation_date": 1458952034, "answer_id": 36230193, "question_id": 33401470, "link": "https://stackoverflow.com/questions/33401470/c-color-blend-and-calculating-opacity-alpha-like-photoshop/36230193#36230193", "title": "C# Color Blend and calculating opacity / alpha like Photoshop", "body": "<p>I just solved this problem like this (background.png and colorWithAlpha.png have the same dimensions):</p>\n<pre><code>Bitmap bg = new Bitmap(&quot;background.png&quot;);\nBitmap overlay = new Bitmap(&quot;colorWithAlpha.png&quot;);\nfloat m = 0;\nColor c;\nfor (int i = 0; i &lt; bg.Width; i++)\n{\n    for (int j = 0; j &lt; bg.Height; j++)\n    {\n        m = overlay.GetPixel(i, j).A / 255f;\n        c = HSVtoRGB(overlay.GetPixel(i,j).GetHue(), overlay.GetPixel(i,j).GetSaturation(), bg.GetPixel(i, j).GetBrightness());\n        c = Color.FromArgb((int)(m * c.R + (1 - m) * bg.GetPixel(i, j).R), (int)(m * c.G + (1 - m) * bg.GetPixel(i, j).G), (int)(m * c.B + (1 - m) * bg.GetPixel(i, j).B));\n        bg.SetPixel(i, j, c);\n    }\n}\n\npublic static Color HSVtoRGB(float hue, float saturation, float value)\n{\n    // HSV contains values scaled as in the color wheel:\n    // that is, all from 0 to 255.\n\n    // for ( this code to work, HSV.Hue needs\n    // to be scaled from 0 to 360 (it//s the angle of the selected\n    // point within the circle). HSV.Saturation and HSV.value must be\n    // scaled to be between 0 and 1.\n\n    double h;\n    double s;\n    double v;\n\n    double r = 0;\n    double g = 0;\n    double b = 0;\n\n    // Scale Hue to be between 0 and 360. Saturation\n    // and value scale to be between 0 and 1.\n    h = ((double)hue / 255 * 360) % 360;\n    s = (double)saturation / 255;\n    v = (double)value / 255;\n\n    if (s == 0)\n    {\n        // If s is 0, all colors are the same.\n        // This is some flavor of gray.\n        r = v;\n        g = v;\n        b = v;\n    }\n    else\n    {\n        double p;\n        double q;\n        double t;\n\n        double fractionalSector;\n        int sectorNumber;\n        double sectorPos;\n\n        // The color wheel consists of 6 sectors.\n        // Figure out which sector you//re in.\n        sectorPos = h / 60;\n        sectorNumber = (int)(Math.Floor(sectorPos));\n\n        // get the fractional part of the sector.\n        // That is, how many degrees into the sector\n        // are you?\n        fractionalSector = sectorPos - sectorNumber;\n\n        // Calculate values for the three axes\n        // of the color.\n        p = v * (1 - s);\n        q = v * (1 - (s * fractionalSector));\n        t = v * (1 - (s * (1 - fractionalSector)));\n\n        // Assign the fractional colors to r, g, and b\n        // based on the sector the angle is in.\n        switch (sectorNumber)\n        {\n            case 0:\n                r = v;\n                g = t;\n                b = p;\n                break;\n\n            case 1:\n                r = q;\n                g = v;\n                b = p;\n                break;\n\n            case 2:\n                r = p;\n                g = v;\n                b = t;\n                break;\n\n            case 3:\n                r = p;\n                g = q;\n                b = v;\n                break;\n\n            case 4:\n                r = t;\n                g = p;\n                b = v;\n                break;\n\n            case 5:\n                r = v;\n                g = p;\n                b = q;\n                break;\n        }\n    }\n    // return an RGB structure, with values scaled\n    // to be between 0 and 255.\n    return Color.FromArgb((int)(r * 255), (int)(g * 255), (int)(b * 255));\n}\n</code></pre>\n<p>The function HSVtoRGB is taken from <a href=\"https://bytes.com/topic/c-sharp/answers/236124-how-would-i-change-hue-bitmap\" rel=\"nofollow noreferrer\">https://bytes.com/topic/c-sharp/answers/236124-how-would-i-change-hue-bitmap</a>, slightly adjusted as the original function expects all inputs as values from 0-255, so the scaling has to be removed.</p>\n"}], "owner": {"reputation": 163, "user_id": 2535105, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/195de0f6c40a841ec005c1d45cddd0d8?s=128&d=identicon&r=PG", "display_name": "Terrordoll", "link": "https://stackoverflow.com/users/2535105/terrordoll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1636, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1598887668, "creation_date": 1446065857, "question_id": 33401470, "link": "https://stackoverflow.com/questions/33401470/c-color-blend-and-calculating-opacity-alpha-like-photoshop", "title": "C# Color Blend and calculating opacity / alpha like Photoshop", "body": "<p>I have an image I'm trying to process into a very specific look. I found a tutorial in Photoshop and have been slowly, step by step, recreating the Photoshop effects. The latest one is a color blend mode which I was able to get working, but they add an alpha to it and it's got me stumped.</p>\n\n<p>Photoshop does this by creating a filter, setting the color, selecting \"Blend\" and then applying the alpha. The alpha applies to the filter and not the base image.</p>\n\n<p>What I'm doing is taking two colors, the base image and the overlay color to blend, and converting them to HSL. I'm figuring the Blend by taking the Hue/Saturation from the overlay and the Luminosity from the base and creating a new HSL color. I then convert that to RGB and write that pixel to the bitmap over the original base color.</p>\n\n<p>What I don't know how to do is apply the alpha. It seems like I should be take the base color and the product of the blend and figure the alpha between them. I'm not sure if this is correct though, or where to find the proper calculation between the colors. </p>\n\n<p>I don't see the need for code for this question but if you need it, I can post some.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "wpf", "httprequest"], "comments": [{"owner": {"reputation": 174, "user_id": 980464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e70ef0fdddd6dc8db27fcc6c67740f4a?s=128&d=identicon&r=PG", "display_name": "tc44", "link": "https://stackoverflow.com/users/980464/tc44"}, "edited": false, "score": 1, "creation_date": 1446065999, "post_id": 33401450, "comment_id": 54594257, "body": "Have you ever used Fiddler? I would recommend using that to catch the request to see exactly what is being passed."}, {"owner": {"reputation": 1275, "user_id": 2816527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zq3Wu.jpg?s=128&g=1", "display_name": "alvaropaco", "link": "https://stackoverflow.com/users/2816527/alvaropaco"}, "reply_to_user": {"reputation": 174, "user_id": 980464, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e70ef0fdddd6dc8db27fcc6c67740f4a?s=128&d=identicon&r=PG", "display_name": "tc44", "link": "https://stackoverflow.com/users/980464/tc44"}, "edited": false, "score": 0, "creation_date": 1446066214, "post_id": 33401450, "comment_id": 54594383, "body": "tc44 I never have used Fiddler, but i will search about this. Thank you."}, {"owner": {"reputation": 7185, "user_id": 1645737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0tr7.png?s=128&g=1", "display_name": "keenthinker", "link": "https://stackoverflow.com/users/1645737/keenthinker"}, "edited": false, "score": 0, "creation_date": 1446066972, "post_id": 33401450, "comment_id": 54594725, "body": "Are you sure, that your content length is <i>211</i>? This is normally in bytes - the bytes of the posted data."}, {"owner": {"reputation": 1275, "user_id": 2816527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zq3Wu.jpg?s=128&g=1", "display_name": "alvaropaco", "link": "https://stackoverflow.com/users/2816527/alvaropaco"}, "edited": false, "score": 0, "creation_date": 1446067106, "post_id": 33401450, "comment_id": 54594783, "body": "Yes, i&#39;am sure. By documentation of the web service api, i need pass Content-Lenght equals to &quot;211&quot;."}, {"owner": {"reputation": 3851, "user_id": 2469152, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4nZol.png?s=128&g=1", "display_name": "Peuczynski", "link": "https://stackoverflow.com/users/2469152/peuczynski"}, "edited": false, "score": 1, "creation_date": 1446072422, "post_id": 33401450, "comment_id": 54597242, "body": "If I were you I would look at <a href=\"http://stackoverflow.com/questions/20064505/requesting-html-over-https-with-c-sharp-webclient\" title=\"requesting html over https with c sharp webclient\">stackoverflow.com/questions/20064505/&hellip;</a> <a href=\"http://stackoverflow.com/questions/536352/webclient-https-issues\">stackoverflow.com/questions/536352/webclient-https-issues</a> but my guess is <a href=\"http://stackoverflow.com/questions/11328061/c-sharp-webclient-download-string-https\" title=\"c sharp webclient download string https\">stackoverflow.com/questions/11328061/&hellip;</a>"}], "owner": {"reputation": 1275, "user_id": 2816527, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zq3Wu.jpg?s=128&g=1", "display_name": "alvaropaco", "link": "https://stackoverflow.com/users/2816527/alvaropaco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 371, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446065758, "creation_date": 1446065758, "question_id": 33401450, "link": "https://stackoverflow.com/questions/33401450/how-to-pass-body-data-with-uploadstringasync-c", "title": "How to pass body data with UploadStringAsync C#", "body": "<p>I'm trying pass a string in the body of my POST request using WebClient class. Below is my code:</p>\n\n<pre><code>protected void GetAccessToken(string client_id, string secret)\n    {\n        var urlEncodedSecret = HttpUtility.UrlEncode(secret);\n        var urlEncodedSid = HttpUtility.UrlEncode(client_id);\n\n        string bodyData = String.Format(\"grant_type=client_credentials&amp;client_id=ms-app%3a%2f%2f{0}&amp;client_secret={1}&amp;scope=notify.windows.com\", client_id, secret);\n\n        string address = \"https://login.live.com/accesstoken.srf\";\n        string myParameters = \"param1=value1&amp;param2=value2&amp;param3=value3\";\n\n        Uri URI = new Uri(address);\n        System.Net.WebClient webClient = new WebClient();\n        webClient.BaseAddress = address;\n\n        webClient.Headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n        webClient.Headers[\"Content-Length\"] = \"211\";\n        webClient.Headers[\"Host\"] = \"https://login.live.com\";\n\n        webClient.UploadStringCompleted += new UploadStringCompletedEventHandler(uploadStringCompleted);\n        webClient.UploadStringAsync(URI, \"POST\", bodyData);\n    }\n\n    private void uploadStringCompleted(object sender, UploadStringCompletedEventArgs e)\n    {\n        string json = e.Result.ToString();\n        _oAuthToken = GetOAuthTokenFromJson(json);\n    }\n</code></pre>\n\n<p>When i run the application, i received the exception \"The remote server returned an error: NotFound.\".\nI succeeded to make the same request using the Postman:\n<a href=\"https://i.stack.imgur.com/fU515.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fU515.png\" alt=\"Postman requisition\"></a></p>\n\n<p>Anyone know something wrong about my request? Or something that puting me on a right way!?</p>\n"}, {"tags": ["c#", "json", "json.net"], "answers": [{"tags": [], "owner": {"reputation": 3199, "user_id": 209555, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/07995ab10178efba6e51018f74fedc5b?s=128&d=identicon&r=PG", "display_name": "NicoJuicy", "link": "https://stackoverflow.com/users/209555/nicojuicy"}, "is_accepted": false, "score": 0, "last_activity_date": 1446065807, "creation_date": 1446065807, "answer_id": 33401460, "question_id": 33401372, "link": "https://stackoverflow.com/questions/33401372/json-deserialize-variable-number-of-properties/33401460#33401460", "title": "JSON deserialize variable number of properties", "body": "<p>Use of dynamic would be a good bet</p>\n\n<pre><code>dynamic d = Newtonsoft.Json.Linq.JObject.Parse(\"{number:1000, str:'string', array: [1,2,3,4,5,6]}\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 344, "user_id": 1895685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c587f6865bfd0cc0b8452047fe853a4a?s=128&d=identicon&r=PG", "display_name": "Cyrus", "link": "https://stackoverflow.com/users/1895685/cyrus"}, "is_accepted": true, "score": 3, "last_activity_date": 1446066238, "creation_date": 1446066238, "answer_id": 33401558, "question_id": 33401372, "link": "https://stackoverflow.com/questions/33401372/json-deserialize-variable-number-of-properties/33401558#33401558", "title": "JSON deserialize variable number of properties", "body": "<p>Turn your Zone property to a dictionary since you don't know the keys in before hand, but do know their content structure.</p>\n\n<p>Like so</p>\n\n<pre><code>public class Template\n{\n    public string Name { get; set; }\n    public string RuleName { get; set; }\n    public Dictionary&lt;string,Zone&gt; Zones { get; set; }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 613325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kmi1q.jpg?s=128&g=1", "display_name": "Paul Day", "link": "https://stackoverflow.com/users/613325/paul-day"}, "is_accepted": false, "score": 1, "last_activity_date": 1446068100, "creation_date": 1446068100, "answer_id": 33402001, "question_id": 33401372, "link": "https://stackoverflow.com/questions/33401372/json-deserialize-variable-number-of-properties/33402001#33402001", "title": "JSON deserialize variable number of properties", "body": "<p>What if you changed the Template class to the following:</p>\n\n<pre><code>public class Template\n{\n    public string Name { get; set; }\n    public string RuleName { get; set; }\n    public Dictionary&lt;string, Zone&gt; Zones { get; set; }\n}\n</code></pre>\n\n<p>You could then access the name via the key of the entry.</p>\n"}], "owner": {"reputation": 1163, "user_id": 5481865, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/36eb3783cb07bbdff9581179614bcf5e?s=128&d=identicon&r=PG&f=1", "display_name": "FailedUnitTest", "link": "https://stackoverflow.com/users/5481865/failedunittest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 33401558, "answer_count": 3, "score": 1, "last_activity_date": 1446068100, "creation_date": 1446065409, "question_id": 33401372, "link": "https://stackoverflow.com/questions/33401372/json-deserialize-variable-number-of-properties", "title": "JSON deserialize variable number of properties", "body": "<p>I have a JSON class structure like this from a third party API (only the problem part shown):</p>\n\n<pre><code>\"template\": {\n    \"name\": \"MovieTemplate\",\n    \"ruleName\": \"Movie Template\",\n    \"zones\": {\n        \"Products\": {\n            \"type\": \"Record\",\n            \"name\": \"Products\",\n            \"content\": \"www.imagescloudsite.com/blahblah.gif\"\n            \"records\": [ \u2026 ]\n        },\n        \"URL\": {\n            \"type\":\"DVD\",\n            \"name\":\"Bundle\"\n            \"content\": \"www.imagescloudsite.com/blahblah.gif\"\n        }\n    }\n}\n</code></pre>\n\n<p>The \"zones\" property can contain many properties \"<strong>Products</strong>\",\"<strong>URL</strong>\",\"Superman\",\"Descartes\",etc...</p>\n\n<p>But, I do not know which ones and how many will be there, because these are added by our content guys in a special control panel. Newtonsoft Deserializer complains because I have a model like this and it clearly does not capture the zone name like 'Products' and 'URL':</p>\n\n<pre><code>public class Zone\n{\n    public string Type { get; set; }\n    public string Name { get; set; }\n    public string Content { get; set; }\n}\n\npublic class Template\n{\n    public string Name { get; set; }\n    public string RuleName { get; set; }\n    public List&lt;Zone&gt; Zones { get; set; }\n}\n</code></pre>\n\n<p>Any ideas on how I can capture the zone names using NewtonSoft?\nThanks.</p>\n"}, {"tags": ["c#", "padding"], "comments": [{"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 5, "creation_date": 1446065477, "post_id": 33401356, "comment_id": 54593944, "body": "Your problem is <a href=\"https://en.wikipedia.org/wiki/Kerning\" rel=\"nofollow noreferrer\">kerning</a>. Change your text to a <a href=\"https://en.wikipedia.org/wiki/Typeface#Monospaced_typefaces\" rel=\"nofollow noreferrer\">monospaced</a> font (where all the characters are the same width) or use a control that has actual columns instead of trying to match up padding. Consolas is the default font in visual studio and is monospaced, for example."}, {"owner": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446065517, "post_id": 33401356, "comment_id": 54593971, "body": "Try using the Courier New font."}, {"owner": {"reputation": 388, "user_id": 4659509, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbc1eff6f66115cc25a310e70b6c6c3e?s=128&d=identicon&r=PG&f=1", "display_name": "Scriven", "link": "https://stackoverflow.com/users/4659509/scriven"}, "edited": false, "score": 0, "creation_date": 1446065655, "post_id": 33401356, "comment_id": 54594057, "body": "Looks like its most likely the font you are using, see how much bigger I is than M."}, {"owner": {"reputation": 33255, "user_id": 162671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eb08e134b9db338890cf6fd42200f6de?s=128&d=identicon&r=PG&f=1", "display_name": "Nasreddine", "link": "https://stackoverflow.com/users/162671/nasreddine"}, "edited": false, "score": 0, "creation_date": 1446065747, "post_id": 33401356, "comment_id": 54594118, "body": "Can you post the code you have so far?"}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 1, "creation_date": 1446066067, "post_id": 33401356, "comment_id": 54594299, "body": "Are you using WPF? Or WinForms? In WPF you can use <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid(v=vs.110).aspx\" rel=\"nofollow noreferrer\">DataGrid</a> to display data in a table with columns (which will be properly aligned)."}, {"owner": {"reputation": 11, "user_id": 5500168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e641da2c2f4d944e1048ad2a99ceffe6?s=128&d=identicon&r=PG&f=1", "display_name": "Scott_42", "link": "https://stackoverflow.com/users/5500168/scott-42"}, "edited": false, "score": 0, "creation_date": 1446068547, "post_id": 33401356, "comment_id": 54595491, "body": "I am in fact using WinForms. Spot on with the answer. Once I changed the font to a monospaced as recommended, everything lined right up. Thanks, guys!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5500168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e641da2c2f4d944e1048ad2a99ceffe6?s=128&d=identicon&r=PG&f=1", "display_name": "Scott_42", "link": "https://stackoverflow.com/users/5500168/scott-42"}, "edited": false, "score": 0, "creation_date": 1446068654, "post_id": 33401539, "comment_id": 54595550, "body": "That was an easy fix. Thank you for the explanation!"}], "tags": [], "owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "is_accepted": true, "score": 1, "last_activity_date": 1446067113, "last_edit_date": 1495539890, "creation_date": 1446066141, "answer_id": 33401539, "question_id": 33401356, "link": "https://stackoverflow.com/questions/33401356/formatting-text-with-padding-does-not-line-up-in-c/33401539#33401539", "title": "Formatting text with padding does not line up in C#", "body": "<p><strong>Note:</strong> One of the comments asked an important question, regarding whether the question refers to the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>System.Windows.Forms.RichTextBox</code> (WinForms)</a> or the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.controls.richtextbox(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>System.Windows.Controls.RichTextBox</code> (WPF)</a> control.  This answer applies <em>only</em> to the WinForms version of <code>RichTextBox</code>, so if you're using WPF, this doesn't apply.</p>\n\n<p>The most important thing, and this was mentioned in the comments, is that you'll need to use a <a href=\"https://en.wikipedia.org/wiki/Monospaced_font\" rel=\"nofollow noreferrer\">Monospaced font</a>.</p>\n\n<p>Since you stated you're using a <code>RichTextBox</code>, you'll need to know how to set it to use whatever monospaced font you've chosen.</p>\n\n<p>To do that, you can use the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.selectionfont(v=vs.71).aspx\" rel=\"nofollow noreferrer\"><code>RichTextBox.SelectionFont</code></a> property.  </p>\n\n<p>For more general instructions, refer to this MSDN article: <a href=\"https://msdn.microsoft.com/en-us/library/aa983722(v=vs.71).aspx\" rel=\"nofollow noreferrer\">Setting Font Attributes for the Windows Forms RichTextBox Control</a></p>\n\n<p>Once you set the <code>RichTextBox.SelectionFont</code> property, only text added to the control <em>afterwards</em> will use the specified font.  To apply the font to <em>existing</em> text (i.e. you populate the <code>RichTextBox</code> and then change the font to an appropriate monospaced font), take a look at <a href=\"https://stackoverflow.com/a/15554613/1187982\">this answer</a>, which tells you precisely what to do.</p>\n\n<p>Once that's done, there remains the simple matter of adding the appropriate amount of whitespace to the end of each string, such that the next piece of data appears at the appropriate position.  You'll probably be using <a href=\"https://msdn.microsoft.com/en-us/library/system.string.padright(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>String.PadRight</code></a>, but for more general information about padding strings, check out this MSDN article: <a href=\"https://msdn.microsoft.com/en-us/library/66f6d830(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Padding Strings in the .NET Framework</a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5500168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e641da2c2f4d944e1048ad2a99ceffe6?s=128&d=identicon&r=PG&f=1", "display_name": "Scott_42", "link": "https://stackoverflow.com/users/5500168/scott-42"}, "edited": false, "score": 0, "creation_date": 1446068603, "post_id": 33401571, "comment_id": 54595520, "body": "I was actually looking for this explanation on String.Format as well so thank you very much!"}], "tags": [], "owner": {"reputation": 513, "user_id": 5490634, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/40fb5ac8f3fce5c4056c2a762a040b88?s=128&d=identicon&r=PG&f=1", "display_name": "Vadim", "link": "https://stackoverflow.com/users/5490634/vadim"}, "is_accepted": false, "score": 0, "last_activity_date": 1446066291, "creation_date": 1446066291, "answer_id": 33401571, "question_id": 33401356, "link": "https://stackoverflow.com/questions/33401356/formatting-text-with-padding-does-not-line-up-in-c/33401571#33401571", "title": "Formatting text with padding does not line up in C#", "body": "<p>Here is string formatting example:</p>\n\n<pre><code>string varOne = \"Line One\";\ndouble varTwo = 15/100;\n\nstring output= String.Format(\"{0,-10} {1,5:P1}\", varOne, varTwo);\n\n//expected output is\n//Line One   15 %\n</code></pre>\n\n<p>where formatting properties in curly brackets are:\n{index[,alignment][ :formatString] }</p>\n"}], "owner": {"reputation": 11, "user_id": 5500168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e641da2c2f4d944e1048ad2a99ceffe6?s=128&d=identicon&r=PG&f=1", "display_name": "Scott_42", "link": "https://stackoverflow.com/users/5500168/scott-42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1832, "favorite_count": 0, "accepted_answer_id": 33401539, "answer_count": 2, "score": 0, "last_activity_date": 1446067113, "creation_date": 1446065343, "last_edit_date": 1446065555, "question_id": 33401356, "link": "https://stackoverflow.com/questions/33401356/formatting-text-with-padding-does-not-line-up-in-c", "title": "Formatting text with padding does not line up in C#", "body": "<p>I am fairly new to programming and I just wrote a simple application in C# .NET to retrieve information about system drive space. The program functions fine but I'm struggling with formatting the output.</p>\n\n<p>See output: </p>\n\n<p><a href=\"https://i.stack.imgur.com/Ys9Px.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ys9Px.jpg\" alt=\"Output Example\"></a></p>\n\n<p>I'm trying to use padding to get the text to line up in sort of a column format within a rich text box but the output doesn't line up because if there are multiple drives, the drive names are different lengths which throws off the padding. Even if the drive letter comes back one as M: and the other as I: the difference in the size of the letter is enough to throw off the alignment while padding.</p>\n\n<p>I am wondering if there is a way to force each string value to a specific length so the padding is applied evenly or if maybe there's an even better way to format my output. Thank you in advance for your time and let me know if any further information would be helpful!</p>\n"}, {"tags": ["c#", "visual-studio-2015"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 2, "creation_date": 1446065289, "post_id": 33401278, "comment_id": 54593859, "body": "InitializeComponent missing?"}, {"owner": {"reputation": 581, "user_id": 5415573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1951142ff2f935b43aa8f04ea55cf780?s=128&d=identicon&r=PG&f=1", "display_name": "RDR", "link": "https://stackoverflow.com/users/5415573/rdr"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1446065578, "post_id": 33401278, "comment_id": 54594007, "body": "Someone else suggested that as well, I am new to this and dont know what that is nor where it would go."}, {"owner": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446065638, "post_id": 33401278, "comment_id": 54594051, "body": "We&#39;re going to have to see some code."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1446065840, "post_id": 33401278, "comment_id": 54594163, "body": "More to the point, your constructor for the form is where the designer adds the initialization code"}, {"owner": {"reputation": 581, "user_id": 5415573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1951142ff2f935b43aa8f04ea55cf780?s=128&d=identicon&r=PG&f=1", "display_name": "RDR", "link": "https://stackoverflow.com/users/5415573/rdr"}, "edited": false, "score": 0, "creation_date": 1446066196, "post_id": 33401278, "comment_id": 54594375, "body": "InitializeComponent() is in the FrmWorldEdit.Designer.Cs still"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 1, "creation_date": 1446066413, "post_id": 33401278, "comment_id": 54594469, "body": "Please put your details in the question, not in comments. Please include <a href=\"https://stackoverflow.com/help/mcve\">a good, <i>minimal</i>, <i>complete</i> code example</a> that reliably reproduces the problem. Or at a minimum, you need to at least show all of the code being executed here (including your <code>FrmWorldEdit</code> class)."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1446066417, "post_id": 33401278, "comment_id": 54594471, "body": "Also, it&#39;s not clear why you are showing your form in the way that you are; assuming your program is already a Winforms program, you should be able to just call e.g. <code>new FrmWorldEdit().ShowDialog()</code>. If your program is not already a Winforms program, then you need to use an STA thread to execute the code you&#39;ve shown. Of course, you also need to make sure to not block that thread. In any case, there&#39;s just not enough information in your question for a good answer to be provided."}, {"owner": {"reputation": 581, "user_id": 5415573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1951142ff2f935b43aa8f04ea55cf780?s=128&d=identicon&r=PG&f=1", "display_name": "RDR", "link": "https://stackoverflow.com/users/5415573/rdr"}, "edited": false, "score": 0, "creation_date": 1446066837, "post_id": 33401278, "comment_id": 54594667, "body": "this isnt a winforms program, its a .sln project(s) for a  private server for a game, and i just did  right clck&gt;add&gt;windows form and made the form and everything and then made a command that opens the form, but the forms shows blank, just white, not what i added to it in vs.."}, {"owner": {"reputation": 581, "user_id": 5415573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1951142ff2f935b43aa8f04ea55cf780?s=128&d=identicon&r=PG&f=1", "display_name": "RDR", "link": "https://stackoverflow.com/users/5415573/rdr"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1446067568, "post_id": 33401278, "comment_id": 54594992, "body": "@PeterDuniho How do I use an STA thread to execute the code, because thats what I need to do, its not a winforms program, its a solution with 9 projects that like compile together for a private server for a game."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1446067794, "post_id": 33401278, "comment_id": 54595111, "body": "The .sln isn&#39;t specific for WinForms or not, the .csproj is. You will need a Main that calls Application.Run(myMainForm) somewhere."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1446067844, "post_id": 33401278, "comment_id": 54595137, "body": "The real answer is that you will need to add a WinForms project to your solution and learn how to refactor and reference the existing code."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1446067846, "post_id": 33401278, "comment_id": 54595140, "body": "You need to create a new thread and call <code>SetApartmentState()</code> on it before you start the thread. Note that in the code you posted, it does <i>not</i> call <code>InitializeComponent()</code> in the constructor, so that easily could be at least part of your problem as well."}, {"owner": {"reputation": 581, "user_id": 5415573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1951142ff2f935b43aa8f04ea55cf780?s=128&d=identicon&r=PG&f=1", "display_name": "RDR", "link": "https://stackoverflow.com/users/5415573/rdr"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1446067975, "post_id": 33401278, "comment_id": 54595196, "body": "Where would <code>InitializeComponent()</code> go, where/what is the constructor? I see <code>InitializeComponent()</code> on the <code>private void</code> @PeterDuniho"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1446068256, "post_id": 33401278, "comment_id": 54595332, "body": "All due respect, if you don&#39;t know what a constructor is, you are already way out of your depth. If you know nothing about C#, it&#39;s hard enough to implement Winforms in a standalone program, with the Visual Studio Designer&#39;s help, . To do so as a component within a non-Winforms project requires special handling and knowledge about how threading and GUI in Windows and .NET work. To get you started: first, the <i>presence</i> of a method is not sufficient; it has to be <i>called</i> by something for it to do anything. Second, try searching for the text &quot;C# constructor&quot; on MSDN, Google, Bing, whatever."}], "answers": [{"comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1446069063, "post_id": 33402164, "comment_id": 54595779, "body": "The OP needs to also remove the empty constructor that is at the end of the designer file."}, {"owner": {"reputation": 3407, "user_id": 3220603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9d9aa93189d249900811f30b2503d9b?s=128&d=identicon&r=PG&f=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/3220603/lucas"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1446070907, "post_id": 33402164, "comment_id": 54596630, "body": "Yes, that is correct LarsTech, I have missed that detail. Either remove the constructor from the Designer file and add it to the other class as I have presented above; or leave the &#39;Designer&#39; code as it is, but add the &#39;InitializeComponent&#39; method to your constructor in the Designer file"}], "tags": [], "owner": {"reputation": 3407, "user_id": 3220603, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e9d9aa93189d249900811f30b2503d9b?s=128&d=identicon&r=PG&f=1", "display_name": "lucas", "link": "https://stackoverflow.com/users/3220603/lucas"}, "is_accepted": false, "score": 7, "last_activity_date": 1446071286, "last_edit_date": 1446071286, "creation_date": 1446068754, "answer_id": 33402164, "question_id": 33401278, "link": "https://stackoverflow.com/questions/33401278/windows-form-is-shown-blank-when-opened/33402164#33402164", "title": "Windows Form Is Shown Blank When Opened", "body": "<p>You have provided the content of the 'FrmWorldEdit.Designer.cs' file</p>\n\n<p>Go to your 'FrmWorldEdit' file and make sure you have 'InitializeComponent' method call in the constructor, like so:</p>\n\n<pre><code>    public partial class FrmWorldEdit : Form\n{\n    public FrmWorldEdit()\n    {\n        InitializeComponent();\n    }\n}\n</code></pre>\n\n<p>Dont forget to remove your constructor from the 'Designer' file if will decide to implement as I have suggested. Otherwise leave all as it is, but dont forget to add 'InitializeComponent()' method to your constructor in the 'Designer.cs' file</p>\n"}], "owner": {"reputation": 581, "user_id": 5415573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1951142ff2f935b43aa8f04ea55cf780?s=128&d=identicon&r=PG&f=1", "display_name": "RDR", "link": "https://stackoverflow.com/users/5415573/rdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5038, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446071286, "creation_date": 1446065067, "last_edit_date": 1446067136, "question_id": 33401278, "link": "https://stackoverflow.com/questions/33401278/windows-form-is-shown-blank-when-opened", "title": "Windows Form Is Shown Blank When Opened", "body": "<p>this is how the form shows when opened\n<a href=\"http://imgur.com/JbE5I6m\" rel=\"nofollow\">http://imgur.com/JbE5I6m</a>\nwhat the form is supposed to look like\n<a href=\"http://imgur.com/eTTiWUw\" rel=\"nofollow\">http://imgur.com/eTTiWUw</a></p>\n\n<p>note: when in visual studio i did not start by making a win form app, this is for a private server for a game, its a .sln with 9 projects in it that all compile and work together, i am experimenting and seeing if its possible to do windows form in it, so far ive gotten good results, except for when i do the command (/wedit) to open it, the form shows blank, meanwhile in VS i have indeed added stuff to the form.</p>\n\n<p>FrmWorldEdit.Designer.cs below</p>\n\n<pre><code>namespace WorldEdit\n{\n    partial class FrmWorldEdit\n{\n    /// &lt;summary&gt;\n    /// Required designer variable.\n    /// &lt;/summary&gt;\n    private System.ComponentModel.IContainer components = null;\n\n    /// &lt;summary&gt;\n    /// Clean up any resources being used.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"disposing\"&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;\n    protected override void Dispose(bool disposing)\n    {\n        if (disposing &amp;&amp; (components != null))\n        {\n            components.Dispose();\n        }\n        base.Dispose(disposing);\n    }\n\n    #region Windows Form Designer generated code\n\n    /// &lt;summary&gt;\n    /// Required method for Designer support - do not modify\n    /// the contents of this method with the code editor.\n    /// &lt;/summary&gt;\n    private void InitializeComponent()\n    {\n        this.listTiles = new System.Windows.Forms.ListView();\n        this.lblSearch = new System.Windows.Forms.Label();\n        this.tbxSearch = new System.Windows.Forms.TextBox();\n        this.btnToggle = new System.Windows.Forms.Button();\n        this.lblSelected = new System.Windows.Forms.Label();\n        this.SuspendLayout();\n        // \n        // listTiles\n        // \n        this.listTiles.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) \n        | System.Windows.Forms.AnchorStyles.Left) \n        | System.Windows.Forms.AnchorStyles.Right)));\n        this.listTiles.Location = new System.Drawing.Point(24, 69);\n        this.listTiles.Margin = new System.Windows.Forms.Padding(6);\n        this.listTiles.MultiSelect = false;\n        this.listTiles.Name = \"listTiles\";\n        this.listTiles.Size = new System.Drawing.Size(512, 492);\n        this.listTiles.TabIndex = 0;\n        this.listTiles.UseCompatibleStateImageBehavior = false;\n        this.listTiles.View = System.Windows.Forms.View.List;\n        this.listTiles.SelectedIndexChanged += new System.EventHandler(this.listTiles_SelectedIndexChanged);\n        // \n        // lblSearch\n        // \n        this.lblSearch.AutoSize = true;\n        this.lblSearch.Location = new System.Drawing.Point(19, 28);\n        this.lblSearch.Name = \"lblSearch\";\n        this.lblSearch.Size = new System.Drawing.Size(138, 25);\n        this.lblSearch.TabIndex = 1;\n        this.lblSearch.Text = \"Search Tiles:\";\n        // \n        // tbxSearch\n        // \n        this.tbxSearch.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left) \n        | System.Windows.Forms.AnchorStyles.Right)));\n        this.tbxSearch.Location = new System.Drawing.Point(163, 26);\n        this.tbxSearch.Name = \"tbxSearch\";\n        this.tbxSearch.Size = new System.Drawing.Size(373, 31);\n        this.tbxSearch.TabIndex = 2;\n        this.tbxSearch.TextChanged += new System.EventHandler(this.tbxSearch_TextChanged);\n        // \n        // btnToggle\n        // \n        this.btnToggle.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left) \n        | System.Windows.Forms.AnchorStyles.Right)));\n        this.btnToggle.Location = new System.Drawing.Point(24, 617);\n        this.btnToggle.Name = \"btnToggle\";\n        this.btnToggle.Size = new System.Drawing.Size(512, 45);\n        this.btnToggle.TabIndex = 3;\n        this.btnToggle.Text = \"Start Painting\";\n        this.btnToggle.UseVisualStyleBackColor = true;\n        this.btnToggle.Click += new System.EventHandler(this.btnToggle_Click);\n        // \n        // lblSelected\n        // \n        this.lblSelected.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));\n        this.lblSelected.AutoSize = true;\n        this.lblSelected.Location = new System.Drawing.Point(20, 577);\n        this.lblSelected.Name = \"lblSelected\";\n        this.lblSelected.Size = new System.Drawing.Size(197, 25);\n        this.lblSelected.TabIndex = 4;\n        this.lblSelected.Text = \"Selected Tile: none\";\n        // \n        // FrmWorldEdit\n        // \n        this.AutoScaleDimensions = new System.Drawing.SizeF(12F, 25F);\n        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n        this.ClientSize = new System.Drawing.Size(564, 685);\n        this.Controls.Add(this.lblSelected);\n        this.Controls.Add(this.btnToggle);\n        this.Controls.Add(this.tbxSearch);\n        this.Controls.Add(this.lblSearch);\n        this.Controls.Add(this.listTiles);\n        this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.SizableToolWindow;\n        this.Margin = new System.Windows.Forms.Padding(6);\n        this.Name = \"FrmWorldEdit\";\n        this.Text = \"World Editor Tool\";\n        this.FormClosing += new System.Windows.Forms.FormClosingEventHandler(this.FrmWorldEdit_FormClosing);\n        this.ResumeLayout(false);\n        this.PerformLayout();\n\n    }\n\n    #endregion\n\n    private System.Windows.Forms.ListView listTiles;\n    private System.Windows.Forms.Label lblSearch;\n    private System.Windows.Forms.TextBox tbxSearch;\n    private System.Windows.Forms.Button btnToggle;\n    private System.Windows.Forms.Label lblSelected;\n\n    public FrmWorldEdit()\n    {\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c#", "image", "onpaint", "dynamic-data-display"], "comments": [{"owner": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 1, "creation_date": 1446065860, "post_id": 33401235, "comment_id": 54594172, "body": "2 - You have to create a subclass of Panel and override its OnPaint."}, {"owner": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446066244, "post_id": 33401235, "comment_id": 54594391, "body": "1 - How do you get the frames? Are you using DirectShow? If so, you might be able to apply a filter to your graph that could utilize the GPU to convert the images to gray scale. Again, how do you get the frames?"}, {"owner": {"reputation": 526, "user_id": 3071003, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d1fe6473d97822cf2e2773d377d3dc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nazar", "link": "https://stackoverflow.com/users/3071003/nazar"}, "reply_to_user": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446066439, "post_id": 33401235, "comment_id": 54594480, "body": "@Lorek The raw pixel data is streamed via USB. So, the starting point where I own the data is the global array to which I collect data."}, {"owner": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446066829, "post_id": 33401235, "comment_id": 54594663, "body": "Can you provide a sample image? And can you provide the code you are currently using to convert the bytes to a bitmap? Have you run a profiler on your code to see what is costing the most time?"}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1446067627, "post_id": 33401235, "comment_id": 54595025, "body": "you can also use a double buffering technique where your loading the images in another image box as well and just unhiding that image when you need it"}, {"owner": {"reputation": 1214, "user_id": 1277156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7633db2bd4a5ba7398ccdc6f8bd5ea5f?s=128&d=identicon&r=PG", "display_name": "Measuring", "link": "https://stackoverflow.com/users/1277156/measuring"}, "edited": false, "score": 0, "creation_date": 1446113325, "post_id": 33401235, "comment_id": 54612621, "body": "<a href=\"http://stackoverflow.com/a/11025428/1277156\">You might want to have a look at this answer. It explains what you can do to make the most of GDI+..</a>"}, {"owner": {"reputation": 526, "user_id": 3071003, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d1fe6473d97822cf2e2773d377d3dc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nazar", "link": "https://stackoverflow.com/users/3071003/nazar"}, "reply_to_user": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446119892, "post_id": 33401235, "comment_id": 54616929, "body": "@Lorek The image is just a collection of 16bit values 640x480 frame. It is a raw data - no video standard. Look at the accepted answer <a href=\"http://stackoverflow.com/questions/32290631/how-to-display-raw-data-as-an-image-visual-studio-c\">here</a> - I use this code. I do not know how to perform profiling, however, since I do not do anything else with the program but display images, I would expect that to be the limiting factor. Actually, after increasing transfer buffer sizes from USB, the program works ok. Well, I would still be interested to re-write it the proper way."}, {"owner": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446120471, "post_id": 33401235, "comment_id": 54617347, "body": "That answer converts from grayscale to RGB48. I thought you wanted to go the opposite way. If you provide code I will be much more helpful. What is your source format? What is your output format? Check out dotTrace for profiling."}, {"owner": {"reputation": 526, "user_id": 3071003, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d1fe6473d97822cf2e2773d377d3dc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nazar", "link": "https://stackoverflow.com/users/3071003/nazar"}, "reply_to_user": {"reputation": 850, "user_id": 3427024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eec86135dfa7799f4300a031264b059?s=128&d=identicon&r=PG&f=1", "display_name": "Lorek", "link": "https://stackoverflow.com/users/3427024/lorek"}, "edited": false, "score": 0, "creation_date": 1446121008, "post_id": 33401235, "comment_id": 54617695, "body": "@Lorek That is the answer to my previous question. My input data is for grayscale. However, the <i>PixelFormat.Format16bppGrayScale</i> does not work, so I had to create <i>PixelFormat.Format48bppRgb</i> making it look like grayscale. The code is exactly like in that answer, except I do not have to fill the buffer with random values."}], "owner": {"reputation": 526, "user_id": 3071003, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d1fe6473d97822cf2e2773d377d3dc5?s=128&d=identicon&r=PG&f=1", "display_name": "Nazar", "link": "https://stackoverflow.com/users/3071003/nazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446066095, "creation_date": 1446064897, "last_edit_date": 1495540317, "question_id": 33401235, "link": "https://stackoverflow.com/questions/33401235/what-is-the-optimal-way-to-display-images-fast-c", "title": "What is the optimal way to display images fast (C#)", "body": "<p>I am trying to create an application to display 8/16bit grayscale video. Currently, I create a BMP bitmap as RGB48 from frames, and simply assign</p>\n\n<pre><code>pictureBox.Image = bmp\n</code></pre>\n\n<p>This requires to create three redundant channels to make an RGB image look like grayscale (the grayscale image formats do not seem to work). This approach works on my fast computer, but slower computers can not keep up. So, I was hoping that someone could advise a better way of how to display images fast and efficient.</p>\n\n<p>In <a href=\"https://stackoverflow.com/questions/32290631/how-to-display-raw-data-as-an-image-visual-studio-c\">my previous question</a>, I was advised to display images on a <em>panel</em> using <em>onPaint</em> event, instead of <em>picturebox</em>. However, I still did not figure out how to do it.</p>\n\n<ol>\n<li>Is there a way to avoid creating three color channel for RGB if it is to be displayed as a grayscale?</li>\n<li>If I place a <em>panel</em> component on the current <em>form</em>, how to create an <em>Onpaint</em> event so the <em>panel</em> displays the image?</li>\n</ol>\n\n<p>The general functioning of my program is as follows: One thread receives the image data and the other thread collects this data into a larger byte array. As soon as the larger array contains enough data for a full frame, I display the image. </p>\n"}, {"tags": ["c#", ".net", "serial-port"], "comments": [{"owner": {"reputation": 1776, "user_id": 935052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1696ab637a3b0db5dfc722e5c5957b2b?s=128&d=identicon&r=PG", "display_name": "endofzero", "link": "https://stackoverflow.com/users/935052/endofzero"}, "edited": false, "score": 1, "creation_date": 1446065991, "post_id": 33401217, "comment_id": 54594251, "body": "This method retrieves the names from the registry. Perhaps it has invalid data. <a href=\"https://msdn.microsoft.com/en-us/library/system.io.ports.serialport.getportnames(v=vs.110).aspx\" rel=\"nofollow noreferrer\">GetPortNames</a>"}, {"owner": {"reputation": 111, "user_id": 4988160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35de797e3c0c81f46b16f87b0a4b21ec?s=128&d=identicon&r=PG&f=1", "display_name": "Kelly Anderson", "link": "https://stackoverflow.com/users/4988160/kelly-anderson"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 1, "creation_date": 1446656306, "post_id": 33401217, "comment_id": 54836569, "body": "Thanks for the edit @MethodMan"}], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 1755158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c889939287c465ef92e46297dbbe8f20?s=128&d=identicon&r=PG", "display_name": "cory.todd", "link": "https://stackoverflow.com/users/1755158/cory-todd"}, "edited": false, "score": 0, "creation_date": 1446073220, "post_id": 33401525, "comment_id": 54597563, "body": "Not sure why that was voted down. Good thorough answer and +1 for garbage in garbage out."}, {"owner": {"reputation": 111, "user_id": 4988160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35de797e3c0c81f46b16f87b0a4b21ec?s=128&d=identicon&r=PG&f=1", "display_name": "Kelly Anderson", "link": "https://stackoverflow.com/users/4988160/kelly-anderson"}, "edited": false, "score": 1, "creation_date": 1446656453, "post_id": 33401525, "comment_id": 54836692, "body": "I&#39;m thinking it is multiple uses of the same device. It only happens rarely, and the workaround is to make a list of unique string names from the names given. I do handshaking with each device to determine which COM it&#39;s on, so this is not blocking me, I just thought it was strange. I don&#39;t understand why Microsoft would run this from the registry as opposed to some kind of &quot;live&quot; data in the OS. The whole Serial Port API has weird mojo for my money."}], "tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": true, "score": 3, "last_activity_date": 1446066082, "creation_date": 1446066082, "answer_id": 33401525, "question_id": 33401217, "link": "https://stackoverflow.com/questions/33401217/serialport-getportnames-returns-same-port-multiple-times/33401525#33401525", "title": "SerialPort.GetPortNames returns same port multiple times", "body": "<p>Without a lot more information about your specific environment, including machine configuration and registry information, it's impossible to answer for sure. But most likely the (unsatisfying) answer is that <code>GetPortNames()</code> is just doing the best it can with the information available to it.</p>\n\n<p>I.e. it examines the registry to see what ports exist and returns a list of them to you. In some cases, the same COM port number may be reused by multiple devices, or even multiple uses of the same device (depending on driver), causing the port number to be listed in the registry more than once.</p>\n\n<p>Indeed, in some cases you may get a COM port name returned that isn't even valid at the moment. I.e. some device that did exist at some time, but which was removed/disconnected/etc. and is no longer usable.</p>\n\n<p>It's a classic \"garbage-in, garbage-out\" issue.</p>\n\n<p>For related information on the question, you might like to check out these Stack Overflow questions:</p>\n\n<p><a href=\"https://stackoverflow.com/q/19823450\">GetPortNames() returns stale data/Remove stale comport entries in Windows?</a><br/>\n<a href=\"https://stackoverflow.com/q/8218153\">SerialPort.GetPortNames() is wrong</a><br/>\n<a href=\"https://stackoverflow.com/q/2754857\">SerialPort.GetPortNames() behavior</a></p>\n"}], "owner": {"reputation": 111, "user_id": 4988160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35de797e3c0c81f46b16f87b0a4b21ec?s=128&d=identicon&r=PG&f=1", "display_name": "Kelly Anderson", "link": "https://stackoverflow.com/users/4988160/kelly-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 0, "accepted_answer_id": 33401525, "answer_count": 1, "score": 3, "last_activity_date": 1446066082, "creation_date": 1446064842, "last_edit_date": 1446064995, "question_id": 33401217, "link": "https://stackoverflow.com/questions/33401217/serialport-getportnames-returns-same-port-multiple-times", "title": "SerialPort.GetPortNames returns same port multiple times", "body": "<pre><code>SerialPort.GetPortNames();\n</code></pre>\n\n<p>is returning the following array:</p>\n\n<pre><code>{ \"COM1\", \"COM5\", \"COM5\", \"COM5\", \"COM5\", \"COM5\", \"COM5\" }\n</code></pre>\n\n<p>It normally only has each name once. Working around this is very easy, but does anyone know why it would ever do this?</p>\n"}, {"tags": ["c#", "list", "loops", "datacontractserializer", "datacontract"], "comments": [{"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "edited": false, "score": 0, "creation_date": 1446064929, "post_id": 33401170, "comment_id": 54593651, "body": "You must be coming from a <code>JavaScript</code> world.  --- I assume <code>propResponse2</code> is of type <code>Response2</code>? If so, then I assume you&#39;re trying to iterate over the data members of the class? <code>foreach</code> will not do that. And there is no such beast. I assume you&#39;re trying to serialize the class. For that, use <code>DataContractSerializer</code> or <code>NetDataContractSerializer</code>"}, {"owner": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 0, "creation_date": 1446064935, "post_id": 33401170, "comment_id": 54593654, "body": "How is <code>propResponse2</code> defined?"}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 1, "creation_date": 1446064987, "post_id": 33401170, "comment_id": 54593677, "body": "@UweKeim, from the error message it&#39;s obvious it&#39;s declared as <code>Response2</code>"}, {"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "reply_to_user": {"reputation": 36654, "user_id": 107625, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/53a82f701ae492808834e621de2586eb?s=128&d=identicon&r=PG", "display_name": "Uwe Keim", "link": "https://stackoverflow.com/users/107625/uwe-keim"}, "edited": false, "score": 1, "creation_date": 1446066106, "post_id": 33401170, "comment_id": 54594322, "body": "@UweKeim - i updated the question with the definition"}], "answers": [{"comments": [{"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1446066175, "post_id": 33401287, "comment_id": 54594368, "body": "this worked, but needs to be changed to <code>resp3.strName</code>"}], "tags": [], "owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "is_accepted": true, "score": 2, "last_activity_date": 1446067639, "last_edit_date": 1446067639, "creation_date": 1446065093, "answer_id": 33401287, "question_id": 33401170, "link": "https://stackoverflow.com/questions/33401170/iterating-through-datacontract-class/33401287#33401287", "title": "Iterating through DataContract class", "body": "<pre><code>foreach (var resp3 in propResponse2.r3entry)\n{\n    System.Windows.Forms.MessageBox.Show(resp3.strName)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1446066406, "post_id": 33401334, "comment_id": 54594467, "body": "so what&#39;s the downside of iterating through this list? i&#39;m not sure i understand why <code>reflection</code> is bad and getting all the properties from all the fields is good? the issue is not that i want only &quot;some&quot; of the properties, but rather that this is defined as a list, so there are many &quot;sets&quot; of these properties in the list and i want to iterate through those individual items."}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "edited": false, "score": 0, "creation_date": 1446066655, "post_id": 33401334, "comment_id": 54594585, "body": "@gotmike: I didn&#39;t say <code>reflection</code> is bad. I&#39;m just not sure what you&#39;re wanting. Are you wanting the values of the fields of <code>propResponse2</code> or are you wanting the <code>DataContract.Name</code> value?  Reflection is slower than compile-time access for sure, but reflection has been optimized in C#. The &quot;issue&quot; is that if this is code that will be executed a lot then reflection is a performance issue."}], "tags": [], "owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "is_accepted": false, "score": 1, "last_activity_date": 1446066763, "last_edit_date": 1446066763, "creation_date": 1446065259, "answer_id": 33401334, "question_id": 33401170, "link": "https://stackoverflow.com/questions/33401170/iterating-through-datacontract-class/33401334#33401334", "title": "Iterating through DataContract class", "body": "<p>To do what you're wanting (if that is indeed what you want) you need to use <code>reflection</code></p>\n\n<pre><code>        foreach (var field in propResponse2.GetType().GetFields())\n        {\n            System.Windows.Forms.MessageBox.Show(field.GetValue(propResponse2).ToString());\n        }\n</code></pre>\n\n<p>if on the other hand you're wanting to get all the [DataContract] properties from all the fields, then:</p>\n\n<pre><code>foreach (DataContract dc in propResponse2.GetType()\n            .GetFields(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic)\n            .Where(m =&gt; m.GetCustomAttributes(typeof(DataContract), false).Length &gt; 0)\n            .SelectMany(m =&gt; m.GetCustomAttributes(false).OfType&lt;DataContract&gt;()).ToArray())\n{\nSystem.Windows.Forms.MessageBox.Show(dc.Name);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 1873738, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b107251be6c98c6370d61339f810b812?s=128&d=identicon&r=PG", "display_name": "gotmike", "link": "https://stackoverflow.com/users/1873738/gotmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 33401287, "answer_count": 2, "score": 1, "last_activity_date": 1446067639, "creation_date": 1446064666, "last_edit_date": 1446065339, "question_id": 33401170, "link": "https://stackoverflow.com/questions/33401170/iterating-through-datacontract-class", "title": "Iterating through DataContract class", "body": "<p>I have a class that returns a <code>Response2</code> which includes only two definitions I care about:</p>\n\n<pre><code>Response3.Id\nResponse3.Name\n</code></pre>\n\n<p>But, this data is returned as a list, b/c my class definition looks like this:</p>\n\n<pre><code>[DataContract]\npublic class Response2\n{\n    [DataMember(Name = \"done\")]\n    public bool done;\n    [DataMember(Name = \"records\")]\n    public List&lt;Response3&gt; r3entry;\n}\n\n[DataContract]\npublic class Response3\n{\n    [DataMember(Name = \"Id\")]\n    public string strId { get; set; }\n    [DataMember(Name = \"Name\")]\n    public string strName { get; set; }\n}\n</code></pre>\n\n<p>Now I have a List of strings to iterate through, but when I try to do the following:</p>\n\n<pre><code>Response2 propResponse2 = MakeRequest2(propertyRequest2, sfToken);\n\nforeach (string strId in propResponse2)\n{\n    System.Windows.Forms.MessageBox.Show(strId.Name)\n}\n</code></pre>\n\n<p>I get an error stating:</p>\n\n<blockquote>\n  <p>foreach statement cannot operate on variables of type 'Response2' because 'Response2' does not contain a public definition for 'GetEnumerator'</p>\n</blockquote>\n\n<p>I assume that means I need to add something to the DataContract in the class, but I'm not sure where to do this so I can properly iterate.</p>\n\n<p>Any help?</p>\n"}, {"tags": ["javascript", "c#", "asp.net-mvc", "razor", "google-visualization"], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 1394665, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/752e128d172a1055f43faa86c02515fa?s=128&d=identicon&r=PG", "display_name": "Brian Hanf", "link": "https://stackoverflow.com/users/1394665/brian-hanf"}, "edited": false, "score": 0, "creation_date": 1446132401, "post_id": 33401241, "comment_id": 54626150, "body": "That comes close, but I get {&amp;quot;0&amp;quot;:&amp;quot;{color:\\&amp;quot;#009add\\&amp;quot;}&amp;quot;, in the text instead of {0:{color:&quot;#009add&quot;},"}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "reply_to_user": {"reputation": 534, "user_id": 1394665, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/752e128d172a1055f43faa86c02515fa?s=128&d=identicon&r=PG", "display_name": "Brian Hanf", "link": "https://stackoverflow.com/users/1394665/brian-hanf"}, "edited": false, "score": 1, "creation_date": 1446135506, "post_id": 33401241, "comment_id": 54628403, "body": "@BrianHanf: Sorry, that&#39;s HTML escaping. You just need to add <code>Html.Raw()</code> around it. See my update."}, {"owner": {"reputation": 534, "user_id": 1394665, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/752e128d172a1055f43faa86c02515fa?s=128&d=identicon&r=PG", "display_name": "Brian Hanf", "link": "https://stackoverflow.com/users/1394665/brian-hanf"}, "edited": false, "score": 0, "creation_date": 1446136958, "post_id": 33401241, "comment_id": 54629381, "body": "Funny I found that just a few minutes ago and finished testing I was about to come and add that note. I needed to also remove the extra &quot; and replace the \\&quot; with &quot;, i&#39;ll edit to show that change"}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "reply_to_user": {"reputation": 534, "user_id": 1394665, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/752e128d172a1055f43faa86c02515fa?s=128&d=identicon&r=PG", "display_name": "Brian Hanf", "link": "https://stackoverflow.com/users/1394665/brian-hanf"}, "edited": false, "score": 0, "creation_date": 1446137301, "post_id": 33401241, "comment_id": 54629612, "body": "@BrianHanf: Yeah, if you construct your <code>seriesValues</code> using an anonymous object rather than a string, it won&#39;t have that problem. Instead of <code>&quot;{color:\\&quot;#009add\\&quot;}&quot;</code>, you want <code>new {color = &quot;#009add&quot;}</code>"}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "reply_to_user": {"reputation": 534, "user_id": 1394665, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/752e128d172a1055f43faa86c02515fa?s=128&d=identicon&r=PG", "display_name": "Brian Hanf", "link": "https://stackoverflow.com/users/1394665/brian-hanf"}, "edited": false, "score": 0, "creation_date": 1446137437, "post_id": 33401241, "comment_id": 54629705, "body": "@BrianHanf: I rejected your edit because that&#39;s not the right approach. You want your <code>seriesValues</code> objects to use object structures instead of strings in the first place. Then you won&#39;t need to remove quotes or anything."}], "tags": [], "owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "is_accepted": true, "score": 1, "last_activity_date": 1446137359, "last_edit_date": 1495542595, "creation_date": 1446064905, "answer_id": 33401241, "question_id": 33401145, "link": "https://stackoverflow.com/questions/33401145/how-to-pass-options-to-javascript-in-a-cshtml-page/33401241#33401241", "title": "how to pass options to JavaScript in a cshtml page", "body": "<p>Just use JSON serialization:</p>\n\n<pre><code>series: @Html.Raw(JsonConvert.SerializeObject(Model.seriesValues))\n</code></pre>\n\n<p>You'll want to make <code>seriesValues</code> a <code>Dictionary</code> keyed by the number you want associated with each color.</p>\n\n<p>For a deeper dive, see this answer: <a href=\"https://stackoverflow.com/questions/4599169/using-razor-within-javascript/4599403#4599403\">Using Razor within JavaScript</a></p>\n"}, {"comments": [{"owner": {"reputation": 534, "user_id": 1394665, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/752e128d172a1055f43faa86c02515fa?s=128&d=identicon&r=PG", "display_name": "Brian Hanf", "link": "https://stackoverflow.com/users/1394665/brian-hanf"}, "edited": false, "score": 0, "creation_date": 1446132503, "post_id": 33401261, "comment_id": 54626237, "body": "I am building an array or list of the colors for each column, not sure how a single color would help, am I missing a step?"}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "edited": false, "score": 0, "creation_date": 1446135668, "post_id": 33401261, "comment_id": 54628527, "body": "While this might work for specific cases, it&#39;s not a good approach to use generally. If the value you output has an apostrophe, you&#39;ll break the entire script. If you use JSON Serialization instead, then a string value will automatically have quotes around it, and any quotes inside will be escaped appropriately."}], "tags": [], "owner": {"reputation": 128, "user_id": 1504316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3kSe.jpg?s=128&g=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1504316/kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1446065007, "creation_date": 1446065007, "answer_id": 33401261, "question_id": 33401145, "link": "https://stackoverflow.com/questions/33401145/how-to-pass-options-to-javascript-in-a-cshtml-page/33401261#33401261", "title": "how to pass options to JavaScript in a cshtml page", "body": "<p>You can access properties from your model anywhere on the page, including within the script, via:</p>\n\n<pre><code>@Model.MyPropertyName\n</code></pre>\n\n<p>With that in mind, your javascript can look something like this:</p>\n\n<pre><code>myColor = '@Model.MyGreenColorProperty';\n</code></pre>\n\n<p>Note the single quotations around the @Model...  this is very important, and will not work if the value is not surrounded by the quotes.</p>\n"}], "owner": {"reputation": 534, "user_id": 1394665, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/752e128d172a1055f43faa86c02515fa?s=128&d=identicon&r=PG", "display_name": "Brian Hanf", "link": "https://stackoverflow.com/users/1394665/brian-hanf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 33401241, "answer_count": 2, "score": 1, "last_activity_date": 1446137359, "creation_date": 1446064593, "question_id": 33401145, "link": "https://stackoverflow.com/questions/33401145/how-to-pass-options-to-javascript-in-a-cshtml-page", "title": "how to pass options to JavaScript in a cshtml page", "body": "<p>I would like to set the colors in a google chart from my code, and not sure how to do it.  I have this in a cshtml page.    </p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n\n    // Load the Visualization API and the piechart package.\n    //google.load('visualization', '1.0', { 'packages': ['bar'] });\n    google.load('visualization', '1.0', { 'packages': ['corechart'] });\n    var visualization;\n    // Set a callback to run when the Google Visualization API is loaded.\n    google.setOnLoadCallback(drawCharts);\n\n    function drawCharts() {\n\n                var titleName = \"Rounding Eligible\";\n\n\n                $(\"#chartHeader\").html(titleName);\n                var options = {\n                    'backgroundColor': 'transparent',\n                    title: titleName,\n                    subtitle: 'Range of ddd to ddd', seriesType: \"bars\",isStacked: true,\n                    series:  {  0:{color:\"#009add\"} ,1:{color:\"#009844\"} ,2: {color:\"#ef7521\"} ,3: {color:\"#89d2e6\"},4:{color:\"#82bc00\"},5:{color:\"#f19f53\"},6:{color:\"#0055b7\"},@(Model.NumSeries) : { type: \"line\", visibleInLegend: false, color: \"#FF0000\"  }},\n                    vAxis:{title: \"Count\", minValue:10}\n\n                };\n                // Create the data table.\n                var data = google.visualization.arrayToDataTable(@Html.Raw(Model.ChartJson));\n                var chart_div = document.getElementById('chartDiv');\n                var chart = new google.visualization.ComboChart(chart_div);\n\n                chart.draw(data, options);\n\n                //setup a temp image to gold hold the chart\n                createHiddenImage('hiddenCanvas1', 'chartDiv', chart.getImageURI());\n            }\n    &lt;/script&gt;\n</code></pre>\n\n<p>What I would like to do is replace my colors ( 0:{color:\"#009add\"} ,1:{color:\"#009844\"}) to be based on something in the code and do something like</p>\n\n<pre><code> isStacked: true,\nseries: \n @foreach seriesvalue in @Model.seriesValues\n{@Html.Raw(seriesvalue);},  \nAxis:{title: \"Count\", minValue:10}\n</code></pre>\n\n<p>I have no idea what is possible to accomplish this, is it best to just pass the whole options object from the model? Basically I can't figure out how to do it.  </p>\n"}, {"tags": ["c#", ".net", "winforms", "panel", "move"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446064685, "post_id": 33401075, "comment_id": 54593516, "body": "well what do the errors in red say..? we are not mind readers here.."}, {"owner": {"reputation": 1190, "user_id": 3091161, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/0cRXI.png?s=128&g=1", "display_name": "enkryptor", "link": "https://stackoverflow.com/users/3091161/enkryptor"}, "edited": false, "score": 0, "creation_date": 1446064729, "post_id": 33401075, "comment_id": 54593538, "body": "you are trying to assign int to a Point"}, {"owner": {"reputation": 43, "user_id": 5464917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ca63e3737fa4e779d98fa070dc624d?s=128&d=identicon&r=PG&f=1", "display_name": "Learning_To_Code", "link": "https://stackoverflow.com/users/5464917/learning-to-code"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446064799, "post_id": 33401075, "comment_id": 54593573, "body": "sorry, Error: Cannot implicitly convert type int to System.Drawing.Point @MethodMan"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1446064826, "post_id": 33401075, "comment_id": 54593587, "body": "why not do something like the following  <code>panel2.Location = new Point(x,y);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5464917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ca63e3737fa4e779d98fa070dc624d?s=128&d=identicon&r=PG&f=1", "display_name": "Learning_To_Code", "link": "https://stackoverflow.com/users/5464917/learning-to-code"}, "edited": false, "score": 0, "creation_date": 1446065201, "post_id": 33401200, "comment_id": 54593806, "body": "Thank you, that did the trick. I&#39;m going to look up new point instances. Still learning these terms :) @c.wider"}, {"owner": {"reputation": 43, "user_id": 5464917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ca63e3737fa4e779d98fa070dc624d?s=128&d=identicon&r=PG&f=1", "display_name": "Learning_To_Code", "link": "https://stackoverflow.com/users/5464917/learning-to-code"}, "edited": false, "score": 0, "creation_date": 1446065487, "post_id": 33401200, "comment_id": 54593948, "body": "is there a way to write the code like this  panel2.Location = new Point(panel2.Location.X +0.5, panel2.Location.Y); .....(0.5 )so the slide will be slower. Instead of  + 1"}, {"owner": {"reputation": 66, "user_id": 3825295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52066c9cc4f0602a71a6789ab0743da3?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Wider", "link": "https://stackoverflow.com/users/3825295/christoph-wider"}, "reply_to_user": {"reputation": 43, "user_id": 5464917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ca63e3737fa4e779d98fa070dc624d?s=128&d=identicon&r=PG&f=1", "display_name": "Learning_To_Code", "link": "https://stackoverflow.com/users/5464917/learning-to-code"}, "edited": false, "score": 1, "creation_date": 1446066370, "post_id": 33401200, "comment_id": 54594449, "body": "no, a location of a control can only be presented by an integer, but I think your problem is not a too fast sliding than a refreshing problem. Try to Refresh the control after every set of the location like this: panel2.Refresh()"}], "tags": [], "owner": {"reputation": 66, "user_id": 3825295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52066c9cc4f0602a71a6789ab0743da3?s=128&d=identicon&r=PG&f=1", "display_name": "Christoph Wider", "link": "https://stackoverflow.com/users/3825295/christoph-wider"}, "is_accepted": true, "score": 4, "last_activity_date": 1446064783, "creation_date": 1446064783, "answer_id": 33401200, "question_id": 33401075, "link": "https://stackoverflow.com/questions/33401075/sliding-the-panel/33401200#33401200", "title": "Sliding the Panel", "body": "<p>You get an error because you try to set the location with an integer. You will need a new point instance:</p>\n\n<pre><code>panel2.Location = new Point(panel2.Location.X, panel2.Location.Y + 1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1446067185, "creation_date": 1446067185, "answer_id": 33401778, "question_id": 33401075, "link": "https://stackoverflow.com/questions/33401075/sliding-the-panel/33401778#33401778", "title": "Sliding the Panel", "body": "<p>Try using .Left instead of .Location.X</p>\n\n<p>This works in VB...</p>\n\n<pre><code>Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click\n    If sender.text = \"&gt;\" Then\n        Do Until Panel1.Left &gt; Me.Width - 50\n            Panel1.Left += 1\n        Loop\n        sender.text = \"&lt;\"\n    Else\n        Panel1.Left = 511\n        sender.text = \"&gt;\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>I'm surprised it is a smooth as it is - panel is empty however.</p>\n"}], "owner": {"reputation": 43, "user_id": 5464917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9ca63e3737fa4e779d98fa070dc624d?s=128&d=identicon&r=PG&f=1", "display_name": "Learning_To_Code", "link": "https://stackoverflow.com/users/5464917/learning-to-code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 1, "accepted_answer_id": 33401200, "answer_count": 2, "score": 0, "last_activity_date": 1446072342, "creation_date": 1446064392, "last_edit_date": 1446072342, "question_id": 33401075, "link": "https://stackoverflow.com/questions/33401075/sliding-the-panel", "title": "Sliding the Panel", "body": "<p>I'm using WinForms. In My form i have a button and a panel. When i click on that button i want to slide the panel to the right. I'm having issues with the code. Currently I'm getting red error lines under\n<code>= panel2.Location.X + 1;</code></p>\n\n<p><code>Error Message: Cannot implicitly convert type int to System.Drawing.Point</code></p>\n\n<p>I was trying to move the panel with the similar approach i did by growing the panel. I provided that in my code. How can i move the panel?</p>\n\n<pre><code>private void btn_Right_Click(object sender, EventArgs e)\n{   \n    // Make Panel Grow\n    //while (panel1.Width &lt; 690)\n    //{\n    //    panel1.Width = panel1.Width + 1;\n    //}\n\n    while (panel2.Location.X &lt; 690)\n    {\n        panel2.Location = panel2.Location.X + 1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "reflection", "interface"], "comments": [{"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 1, "creation_date": 1446069745, "post_id": 33400979, "comment_id": 54596155, "body": "None of those are fields.  Those are all properties."}], "answers": [{"comments": [{"owner": {"reputation": 16505, "user_id": 97382, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5j1Z4.png?s=128&g=1", "display_name": "Craig W.", "link": "https://stackoverflow.com/users/97382/craig-w"}, "edited": false, "score": 3, "creation_date": 1446065298, "post_id": 33401284, "comment_id": 54593864, "body": "You don&#39;t need an instance of <code>A</code>, you can just use <code>typeof(A).GetProperties()...</code>"}, {"owner": {"reputation": 3638, "user_id": 1145114, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7bfed7438c368b3758b48965bc4545d6?s=128&d=identicon&r=PG", "display_name": "Luiso", "link": "https://stackoverflow.com/users/1145114/luiso"}, "reply_to_user": {"reputation": 16505, "user_id": 97382, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/5j1Z4.png?s=128&g=1", "display_name": "Craig W.", "link": "https://stackoverflow.com/users/97382/craig-w"}, "edited": false, "score": 0, "creation_date": 1446066499, "post_id": 33401284, "comment_id": 54594505, "body": "@CraigW. yes i know i was just trying to be very explicit to avoid any confusion. Thanks for the comment though i really forgot to say that"}, {"owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "edited": false, "score": 0, "creation_date": 1446067803, "post_id": 33401284, "comment_id": 54595117, "body": "As mentioned earlier, there are various classes like class A.@CraigW , @Luiso"}, {"owner": {"reputation": 3638, "user_id": 1145114, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7bfed7438c368b3758b48965bc4545d6?s=128&d=identicon&r=PG", "display_name": "Luiso", "link": "https://stackoverflow.com/users/1145114/luiso"}, "edited": false, "score": 0, "creation_date": 1446068058, "post_id": 33401284, "comment_id": 54595235, "body": "so you want to get all classes that have properties of a type that is assignable from the <code>ISample</code>? In that case an <code>Assembly</code> will have to be used."}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1446069611, "post_id": 33401284, "comment_id": 54596077, "body": "Your <a href=\"https://msdn.microsoft.com/en-us/library/system.type.isassignablefrom(v=vs.110).aspx\" rel=\"nofollow noreferrer\">IsAssignableFrom()</a> is backwards.  <code>typeof(ISample).IsAssignableFrom(pi.PropertyType)</code>.  <code>public virtual bool IsAssignableFrom( \tType c )</code> -&gt; c is derived either directly or indirectly from the current instance or The current instance is an interface that c implements."}, {"owner": {"reputation": 3638, "user_id": 1145114, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7bfed7438c368b3758b48965bc4545d6?s=128&d=identicon&r=PG", "display_name": "Luiso", "link": "https://stackoverflow.com/users/1145114/luiso"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1446070114, "post_id": 33401284, "comment_id": 54596316, "body": "Thanks @ErikPhilips i will correct my answer accordingly"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1145114, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7bfed7438c368b3758b48965bc4545d6?s=128&d=identicon&r=PG", "display_name": "Luiso", "link": "https://stackoverflow.com/users/1145114/luiso"}, "is_accepted": true, "score": 4, "last_activity_date": 1446070327, "last_edit_date": 1446070327, "creation_date": 1446065089, "answer_id": 33401284, "question_id": 33400979, "link": "https://stackoverflow.com/questions/33400979/how-can-i-use-reflection-to-get-all-fields-of-particular-interface-type/33401284#33401284", "title": "How can I use Reflection to get all fields of particular interface type", "body": "<p>You can use a combination of <code>Reflection</code> and <code>Linq</code> to do something like this:</p>\n\n<pre><code>var obj = new A();\nvar properties = obj.GetType().GetProperties()\n                    .Where(pi =&gt; typeof(ISample).IsAssignableFrom(pi.PropertyType))\n</code></pre>\n\n<p>You must be extra cautious when dealing with generics. But for what you ask this should be good</p>\n\n<p>If you want to get all classes that have at least one property returning a child of <code>ISample</code> you will have to use assemblies, for instance, the Currently executing </p>\n\n<pre><code>Assembly.GetExecutingAssembly().GetTypes()\n        .SelectMany(t =&gt; t.GetProperties().Where(pi =&gt; // same code as the sample above)\n</code></pre>\n\n<p>In case you have several assemblies to probe you can use something like this</p>\n\n<pre><code>IEnumerable&lt;Assembly&gt; assemblies = ....\nvar properties = assemblies\n            .SelectMany(a =&gt; a.GetTypes().SelectMany(t =&gt; t.GetProperties()...))\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 2237543, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ada6d62898fca8612f2dee82bb4f2be1?s=128&d=identicon&r=PG", "display_name": "Mohit Jain", "link": "https://stackoverflow.com/users/2237543/mohit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1833, "favorite_count": 0, "accepted_answer_id": 33401284, "answer_count": 1, "score": 1, "last_activity_date": 1446070327, "creation_date": 1446064009, "question_id": 33400979, "link": "https://stackoverflow.com/questions/33400979/how-can-i-use-reflection-to-get-all-fields-of-particular-interface-type", "title": "How can I use Reflection to get all fields of particular interface type", "body": "<p>Consider following interfaces</p>\n\n<pre><code>public interface ISample \npublic interface ISample2 : ISample\n\npublic class A\n{\n    [Field]\n    ISample SomeField {get; set;}\n\n    [Field]\n    ISample2 SomeOtherField {get; set; }\n}\n</code></pre>\n\n<p>Suppose there are various classes like class A and various Fields like SomeField and SomeOtherField. \nHow can I get a list of all such Fields which are of type ISample or other interfaces derived from ISample (like ISample2)</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 1270, "user_id": 1644369, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fcec08f66613385299b3c5c07590705f?s=128&d=identicon&r=PG", "display_name": "netaholic", "link": "https://stackoverflow.com/users/1644369/netaholic"}, "edited": false, "score": 0, "creation_date": 1446117242, "post_id": 33400958, "comment_id": 54615179, "body": "Set &quot;CanContentScroll&quot; property of a ScrollViewer to true"}], "answers": [{"tags": [], "owner": {"reputation": 6580, "user_id": 355682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c02079e74de8563fdfa7e4ac1d87d76?s=128&d=identicon&r=PG", "display_name": "Raven Dreamer", "link": "https://stackoverflow.com/users/355682/raven-dreamer"}, "is_accepted": true, "score": 0, "last_activity_date": 1446131767, "creation_date": 1446131767, "answer_id": 33418074, "question_id": 33400958, "link": "https://stackoverflow.com/questions/33400958/how-do-i-ensure-the-entire-parent-control-is-visible-when-a-compound-xaml-contro/33418074#33418074", "title": "How do I ensure the entire parent control is visible when a compound XAML control is Tab Selected?", "body": "<p>Figured out a way to make it work by responding to the top control's \"GotFocus\" event. <code>scrollViewer</code> in this case is the parent ScrollViewer that the compound control gets added to.</p>\n\n<pre><code>private const int SCROLL_PADDING = 10;\nprivate void lblTop_GotKeyboardFocus(object sender, System.Windows.Input.KeyboardFocusChangedEventArgs e)\n        {\n            if (scrollViewer == null) return;\n            FrameworkElement element = e.OriginalSource as FrameworkElement;\n            var transform = element.TransformToVisual(scrollViewer);\n            var positionInScrollViewer = transform.Transform(new Point(0, 0));\n\n            //Scrolls the viewer down far enough to see this control + the control directly below it.\n            if (positionInScrollViewer.Y &lt; 0 ||\n                positionInScrollViewer.Y + SCROLL_PADDING &gt; scrollViewer.ViewportHeight)\n            {\n               scrollViewer.ScrollToVerticalOffset(scrollViewer.VerticalOffset +\n                    positionInScrollViewer.Y - SCROLL_PADDING);\n            }\n\n\n        }\n</code></pre>\n\n<p>This will scroll the ScrollViewer past the entirety of the compound control, but only if the top part of the compound control is off, or nearly-off, the screen.</p>\n"}], "owner": {"reputation": 6580, "user_id": 355682, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c02079e74de8563fdfa7e4ac1d87d76?s=128&d=identicon&r=PG", "display_name": "Raven Dreamer", "link": "https://stackoverflow.com/users/355682/raven-dreamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 33418074, "answer_count": 1, "score": 0, "last_activity_date": 1446131767, "creation_date": 1446063907, "question_id": 33400958, "link": "https://stackoverflow.com/questions/33400958/how-do-i-ensure-the-entire-parent-control-is-visible-when-a-compound-xaml-contro", "title": "How do I ensure the entire parent control is visible when a compound XAML control is Tab Selected?", "body": "<p>I have a compound XAML control. It looks like this:</p>\n\n<pre><code>&lt;UI:CompoundControl \n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:Dynamics=\"clr-namespace:MyNamespace.UI\" Height=\"Auto\" &gt;\n    &lt;Stackpanel Orietnation=\"Vertical\"&gt;\n        &lt;TextArea x:Name=\"lblTop\" DockPanel.Dock=\"Left\"&gt;Label&lt;/TextArea &gt;\n        &lt;TextArea x:Name=\"lblBottom\" DockPanel.Dock=\"Left\"&gt;Label&lt;/TextArea &gt;\n    &lt;/Stackpanel &gt;\n&lt;/UI:CompoundControl&gt;\n</code></pre>\n\n<p>When the application runs, there is a UIElementCollection of these <code>CompoundControl</code>s, which displays them in a scrollable list.</p>\n\n<p>When I press the <kbd>Tab</kbd> key, the application moves focus to the next TextArea in sequence, scrolling the view to do so. However, it only scrolls to show the <em>focused</em> control, so I'm running into an issue where pressing <kbd>Tab</kbd> doesn't show the entirety of the <code>CompoundControl</code>, only the upper half.</p>\n\n<p>Is there some attribute I can set so that the automatic scrolling shows the entire control, instead of simply the upper half?</p>\n"}, {"tags": ["c#", "text-files"], "comments": [{"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1446066423, "post_id": 33400912, "comment_id": 54594474, "body": "Would you please poste your text file?"}, {"owner": {"reputation": 1524, "user_id": 3022900, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b70bbcb50b5b6043301dfd5ed8de47dc?s=128&d=identicon&r=PG&f=1", "display_name": "LiranBo", "link": "https://stackoverflow.com/users/3022900/liranbo"}, "edited": false, "score": 0, "creation_date": 1446070877, "post_id": 33400912, "comment_id": 54596619, "body": "if you know exactly the column indexes (header?) and you load the data per row, why don&#39;t you go directly to the relevant indexes and check their values instead of iterating over all the cells? for example lets assume you know that index 5 is <code>BSC</code> col, just go to <code>row[5]</code> and check the value. the same goes for the rest of the conditions. by accessing each column directly their order doesn&#39;t matter."}], "answers": [{"tags": [], "owner": {"reputation": 5456, "user_id": 502395, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GesJX.jpg?s=128&g=1", "display_name": "venerik", "link": "https://stackoverflow.com/users/502395/venerik"}, "is_accepted": false, "score": 1, "last_activity_date": 1446073667, "creation_date": 1446073667, "answer_id": 33403156, "question_id": 33400912, "link": "https://stackoverflow.com/questions/33400912/how-to-read-textfile-for-setting-value-based-on-another-in-same-row/33403156#33403156", "title": "How to read textfile for setting value based on another in same row", "body": "<p>You can do it like this. Put the first row in a list of columns. Go through the remaining rows, putting each row in a list of cells. Then, get the index of a certain column by column name (e.g. <code>columns.IndexOf(\"BSC\")</code> to get the cell value. That way you can easily access the cell values of both columns <code>BSC</code> and <code>LAC</code>.</p>\n\n<pre><code>using System;\nusing System.Linq;\n\npublic class Program\n{\n    public static void Main()\n    {       \n        var text = \"BSC,LAC\" + Environment.NewLine\n            + \"BSC37,1\" + Environment.NewLine\n            + \"BSC38,2\" + Environment.NewLine\n            + \"BSCN10,3\"+ Environment.NewLine\n            + \"BSCN10,4\";\n\n        var rows = text.Split(new string[]{Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries).ToList();\n        var columns = rows[0].Split(',').ToList();\n\n        foreach(var row in rows.Skip(1)) {\n            var cells = row.Split(',');\n\n            string regionCode = \"\";\n\n            if(cells[columns.IndexOf(\"BSC\")] == \"BSC37\" \n              || cells[columns.IndexOf(\"BSC\")] == \"BSC38\") { \n                regionCode = \"AUH\";\n            }\n\n            if(cells[columns.IndexOf(\"BSC\")] == \"BSCN10\")\n            {\n                if(cells[columns.IndexOf(\"LAC\")] == \"3\") {\n                    regionCode = \"AUH\";\n                } \n                if(cells[columns.IndexOf(\"LAC\")] == \"4\") \n                    regionCode = \"DXB\";\n                }\n            }\n\n            Console.WriteLine(\"{0},{1}-&gt;{2}\",cells[0],cells[1], regionCode);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7162, "user_id": 71470, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/c87f89a1fbb8dab4df1e53a5b76d896a?s=128&d=identicon&r=PG", "display_name": "peter", "link": "https://stackoverflow.com/users/71470/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446073667, "creation_date": 1446063730, "last_edit_date": 1446070078, "question_id": 33400912, "link": "https://stackoverflow.com/questions/33400912/how-to-read-textfile-for-setting-value-based-on-another-in-same-row", "title": "How to read textfile for setting value based on another in same row", "body": "<p>I am accessing a text file which has values in a column, rows format so first line is columns and rest all corresponding rows.  </p>\n\n<p>I have one condition like if column name is <code>BSC</code> and its value is <code>BSC37</code> or <code>BSC38</code> I have to set value like <code>region_code = \"AUH\";</code>. If value is <code>BSCN10</code> then <code>region_code</code> can be <code>AUH</code> or <code>DBL</code>, so here another value for a column name \"LAC\" ==3 then region_code is 'AUH' otherwise if \"LAC\"==4 then <code>region_code</code> is 'DXB'.</p>\n\n<p>I got stuck to achieve it since these values are coming in same row and sequentially.</p>\n\n<p>Here is what I did so far:</p>\n\n<pre><code>string[] cols = lines[0]\n    .Trim()\n    .Split(new[] { '\\t', ' ' }, StringSplitOptions.RemoveEmptyEntries);\n\nint liness = 1;\nforeach (string line in lines.Skip(2))\n{\n    string[] cells = line\n        .Trim()\n        .Split(new[] { '\\t' }, StringSplitOptions.RemoveEmptyEntries);\n\n    for (int counter = 0; counter &lt; cols.Length; counter++)\n    {\n        string cellValue = \"N/A\";\n        if (counter &lt; cells.Length)\n            cellValue = cells[counter];\n\n        if (cols[counter] == \"BSC\")\n        {               \n            insvalues2gericson.Add(new FormField(\"BSC_ID\", cellValue, 2));\n            if (cellValue == \"BSC37\" || cellValue == \"BSC38\" )\n            {\n                region_code = \"AUH\";\n            }\n            else\n            if (cellValue == \"BSCN10\")\n            {\n               //here i need to coding\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 0, "creation_date": 1446063576, "post_id": 33400824, "comment_id": 54592957, "body": "Your string isn&#39;t a string for a start. What are you actual requirements here? How was the string generated in the first place? Do you need to worry about stuff like spaces between the <code>X</code> and the <code>:</code> or the <code>:</code> and the number. Start with a strict set of rules and your regex will write itself"}, {"owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "edited": false, "score": 0, "creation_date": 1446063746, "post_id": 33400824, "comment_id": 54593030, "body": "<code>{EnemyMove X:9 Y:10}</code> isn&#39;t a string. Your sample code won&#39;t even compile."}, {"owner": {"reputation": 2423, "user_id": 1850978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c7e6fab879022fe474c48b829a42cc53?s=128&d=identicon&r=PG", "display_name": "David Faizulaev", "link": "https://stackoverflow.com/users/1850978/david-faizulaev"}, "reply_to_user": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "edited": false, "score": 0, "creation_date": 1446067068, "post_id": 33400824, "comment_id": 54594769, "body": "@ErikE, sorry about that, must have missed it when I was writing it here, fixed now."}, {"owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "edited": false, "score": 0, "creation_date": 1446069376, "post_id": 33400824, "comment_id": 54595955, "body": "My next comment is that regex is not a great way to parse this. Why not just split on ` ` (space), take the resulting tokens and split them on <code>:</code>, then for each one, if the <code>[0]</code> is X or Y, use the <code>[1]</code> appropriately?"}], "answers": [{"comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1446064136, "post_id": 33400862, "comment_id": 54593230, "body": "Looks like that&#39;s it now. If you have any doubts, please feel free to drop a comment."}, {"owner": {"reputation": 2423, "user_id": 1850978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c7e6fab879022fe474c48b829a42cc53?s=128&d=identicon&r=PG", "display_name": "David Faizulaev", "link": "https://stackoverflow.com/users/1850978/david-faizulaev"}, "edited": false, "score": 0, "creation_date": 1446066398, "post_id": 33400862, "comment_id": 54594463, "body": "I tested the demo and I get the string &#39;X:7&#39;, I&#39;ve managed to get to this result, but I need just the digit."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2423, "user_id": 1850978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c7e6fab879022fe474c48b829a42cc53?s=128&d=identicon&r=PG", "display_name": "David Faizulaev", "link": "https://stackoverflow.com/users/1850978/david-faizulaev"}, "edited": false, "score": 0, "creation_date": 1446067452, "post_id": 33400862, "comment_id": 54594945, "body": "Did you use <code>m.Groups[&quot;X&quot;].Value</code> and <code>m.Groups[&quot;Y&quot;].Value</code>?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2423, "user_id": 1850978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c7e6fab879022fe474c48b829a42cc53?s=128&d=identicon&r=PG", "display_name": "David Faizulaev", "link": "https://stackoverflow.com/users/1850978/david-faizulaev"}, "edited": false, "score": 0, "creation_date": 1446068050, "post_id": 33400862, "comment_id": 54595229, "body": "Please update the question with the  current code so that I could have a look. State what the expected output is."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 2423, "user_id": 1850978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c7e6fab879022fe474c48b829a42cc53?s=128&d=identicon&r=PG", "display_name": "David Faizulaev", "link": "https://stackoverflow.com/users/1850978/david-faizulaev"}, "edited": false, "score": 1, "creation_date": 1446108607, "post_id": 33400862, "comment_id": 54609619, "body": "Again, did you use <code>match.Groups[&quot;X&quot;].Value</code> (=9) and <code>match.Groups[&quot;Y&quot;].Value</code> (=10)?"}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1446068618, "last_edit_date": 1446068618, "creation_date": 1446063603, "answer_id": 33400862, "question_id": 33400824, "link": "https://stackoverflow.com/questions/33400824/c-parse-string-using-regex-number-adjacent-to-letter/33400862#33400862", "title": "C# parse string using regex - number adjacent to letter", "body": "<p>If you want to restrict the numbers to 0-10 range, replace <code>\\d+</code> with <code>10|\\d</code>:</p>\n\n<pre><code>X:(?&lt;X&gt;10|\\d)\\s+Y:(?&lt;Y&gt;10|\\d)\n</code></pre>\n\n<p>See <a href=\"http://regexstorm.net/tester?p=X%3a(%3f%3cX%3e10%7c%5cd)%5cs%2bY%3a(%3f%3cY%3e10%7c%5cd)&amp;i=%7bEnemyMove+X%3a7+Y%3a8%7d\" rel=\"nofollow noreferrer\">demo</a></p>\n\n<p>So, you need to remove the delimiters (leading/trailing <code>/</code>) and add the <code>Y</code> part.</p>\n\n<p>Group <code>X</code> will contain the digits after <code>X</code> and Group <code>Y</code> will contain the digits after <code>Y</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HTLIc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HTLIc.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"http://ideone.com/vEWtRe\" rel=\"nofollow noreferrer\">C# demo</a>:</p>\n\n<pre><code>var str = \"{EnemyMove X:9 Y:10}\";\nvar regex_sp_chrs = new Regex(@\"X:(?&lt;X&gt;10|\\d)\\s+Y:(?&lt;Y&gt;10|\\d)\");\nvar ms = regex_sp_chrs.Matches(str);\nforeach (Match m in ms)\nConsole.WriteLine(string.Format(\"{0} - {1}\", \n                   m.Groups[\"X\"].Value,\n                   m.Groups[\"Y\"].Value));\n</code></pre>\n\n<p>It will output <code>9 - 10</code>, <code>9</code> is the <code>m.Groups[\"X\"].Value</code> and <code>10</code> is the <code>m.Groups[\"Y\"].Value</code>.</p>\n\n<p>If you know <code>{EnemyMove</code> is static (always present as a literal before <code>X</code>), add it to the regex to make it safer (i.e. <code>@\"{EnemyMove\\s+X:(?&lt;X&gt;\\d+)\\s+Y:(?&lt;Y&gt;\\d+)\"</code>).</p>\n"}], "owner": {"reputation": 2423, "user_id": 1850978, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c7e6fab879022fe474c48b829a42cc53?s=128&d=identicon&r=PG", "display_name": "David Faizulaev", "link": "https://stackoverflow.com/users/1850978/david-faizulaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 33400862, "answer_count": 1, "score": 1, "last_activity_date": 1446097649, "creation_date": 1446063447, "last_edit_date": 1446097649, "question_id": 33400824, "link": "https://stackoverflow.com/questions/33400824/c-parse-string-using-regex-number-adjacent-to-letter", "title": "C# parse string using regex - number adjacent to letter", "body": "<p>I'm having trouble writing a correct REGEX and parsing the string in C#.\nThe string I get an input is:</p>\n\n<p>{EnemyMove X:7 Y:8}</p>\n\n<p>I need to digits the follow X and the digits that follow Y, the range is 0-10.\nTried the code below, but the regex is incorrect and I get an incorrect result.</p>\n\n<p>I need to run it twice, once to get the digits adjacent to X and second time for the digits after Y.</p>\n\n<pre><code>string str = \"{EnemyMove X:9 Y:10}\";\nvar regex_sp_chrs = new Regex(\"/X:.*?(\\d+)/\");\nregex_sp_chrs.Matches(str );\n</code></pre>\n\n<p>Expected output - \n9\n10</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "varchar", "binary-data"], "answers": [{"comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 1, "creation_date": 1446066164, "post_id": 33400813, "comment_id": 54594362, "body": "One thing you gloss over in alternative but is very widely used is Base64 encoding, that gives you a increase in size of 4/3 (~1.333x) vs. hex encoding&#39;s 2x. It also is reduceable to a single call via <code>Convert.ToBase64String</code> and <code>Convert.FromBase64String</code>"}], "tags": [], "owner": {"reputation": 12523, "user_id": 1835769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kannS.jpg?s=128&g=1", "display_name": "displayName", "link": "https://stackoverflow.com/users/1835769/displayname"}, "is_accepted": true, "score": 3, "last_activity_date": 1446063405, "last_edit_date": 1495540716, "creation_date": 1446063405, "answer_id": 33400813, "question_id": 33400812, "link": "https://stackoverflow.com/questions/33400812/can-a-binary-file-be-read-as-text/33400813#33400813", "title": "Can a binary file be read as text?", "body": "<p>There is only one problem with reading a binary file chunk as text and then sending that text. That problem is that the converted text does not return that same binary from which this text was created.</p>\n\n<p>It's straightforward enough to understand without <a href=\"http://www.gigamonkeys.com/book/practical-parsing-binary-files.html\" rel=\"nofollow noreferrer\">providing links</a> that <em>at a sufficiently low level of abstraction, all files are \"binary\" in the sense that they just contain a bunch of numbers encoded in binary form.</em></p>\n\n<p>However, it's <strong>VERY important</strong> to distinguish between</p>\n\n<ul>\n<li><strong>text files</strong>, <em>where all the numbers can be interpreted as characters representing human-readable text</em>, and </li>\n<li><strong>binary files</strong>, <em>which contain data that, if interpreted as characters, yields non-printable characters</em>.<em><sup>1</sup></em></li>\n</ul>\n\n<p>So, we may read a binary file which may contain the byte combination for producing a sound and because it is non-printable, it will be <em>irrecoverably lost</em>. There are byte combinations for moving the cursor position. No sooner you hit one, you lose the positioning.</p>\n\n<p>Not only any Control Character will be lost when converted to text, the entire printable text would also not be in place, resulting in garble out of your binary file.</p>\n\n<p><strong><em>So, binary to text to binary conversion is lossy.</em></strong></p>\n\n<hr>\n\n<h3>Alternative?</h3>\n\n<p>The most commonly found alternative is to convert the binary data to its hexadecimal representation and then send back this string equivalent of binary data. Now, the size of a byte is obviously 1 byte. The size of 1 char is 1 byte too but it takes 2 chars to represent 1 byte in hex form. In other words, you get 2 GB of text when you want to retrieve a 1 GB binary file.</p>\n\n<p>However, when taking this approach there is support from <a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.remoting.metadata.w3cxsd2001.soaphexbinary(v=vs.110).aspx\" rel=\"nofollow noreferrer\">SoapHexBinary class</a> which reduces the <em>hexadecimal string to binary conversion</em> down to one method call, demonstrated in <a href=\"https://stackoverflow.com/a/2556329/1835769\">this answer to How do you convert Byte Array to Hexadecimal String, and vice versa.</a></p>\n\n<h2>--------</h2>\n\n<p>Not proven to be better but another method is as follows:</p>\n\n<ul>\n<li>Create a string stream (or some equivalent of it like a <code>string builder</code>).</li>\n<li>Pick any char (it'll take 1 byte) as a delimiter.</li>\n<li>Pick the biggest possible primitive numeric supported by the DBMS. Let its size be <em>k</em> bytes. In my DBMS's case it is <code>BIGINT</code> which is an integer of fixed size of 64-bits (8 bytes).</li>\n<li>Read the binary file <em>k</em> bytes at a time and create the equivalent numeric value.</li>\n<li>Insert the numeric value to the string stream, char delimited.</li>\n<li>When the size of the stream/builder has reached to max value possible, return this string.</li>\n</ul>\n\n<p>At the client end, extract the char delimited strings, convert them to the numeric value, get bytes from this value and concatenate these bytes to re-create the binary file.</p>\n\n<hr>\n\n<p><em><sub><sup>1</sup>In ASCII, the first 32 characters are nonprinting control characters originally used to control the behavior of a Teletype machine, causing it to do such things as sound the bell, back up one character, move to a new line, and move the carriage to the beginning of the line. Of these 32 control characters, only three, the newline, carriage return, and horizontal tab, are typically found in text files.</sub></em></p>\n"}], "owner": {"reputation": 12523, "user_id": 1835769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kannS.jpg?s=128&g=1", "display_name": "displayName", "link": "https://stackoverflow.com/users/1835769/displayname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2777, "favorite_count": 0, "accepted_answer_id": 33400813, "answer_count": 1, "score": 0, "last_activity_date": 1446063405, "creation_date": 1446063405, "question_id": 33400812, "link": "https://stackoverflow.com/questions/33400812/can-a-binary-file-be-read-as-text", "title": "Can a binary file be read as text?", "body": "<p>While the question heading is complete in itself, I'll provide some meta info as to how I hit this problem.</p>\n\n<hr>\n\n<p>With SQL Server and MySQL it was all good and fine with any kind of and any size of data but recently I started working with a DBMS that allows only a max of 64 KB of data in each column of a table. The limit of 64 KB is problematic when there is binary data in the columns. Other examples are - a column containing an image or an audio or a multimedia object or geospatial data.</p>\n\n<p>You won't always get images of size less than 64 KB. BLOBs can simply not be stored in such DBMS. The DBMS allows users to add to its capabilities by writing functions in C/C++ and calling them. But with even these functions we can return a max of 64 KB data per call.</p>\n\n<p>Somebody suggested me a workaround - </p>\n\n<blockquote>\n  <p>store the binary data on file system and store an identifier to that\n  particular binary data in the table's column. This way, when anyone\n  requests that data, the data can be sent back to the caller in <em>chunks\n  of 64 KB size each.</em></p>\n</blockquote>\n\n<p>But then the second limitation came up, which is that the data can be sent from the DBMS as one of the following datatypes only - char / varchar / integer / smallint / bigint / boolean / real. The most favoured candidate in this list was varchar(max) for obvious reasons (that it's the longest).</p>\n\n<p>So, <strong>can a binary file be read and sent as text?</strong> The client end which talks with DBMS is being developed in C#.</p>\n"}, {"tags": ["c#", "error-handling", "media-player"], "comments": [{"owner": {"reputation": 3564, "user_id": 1189566, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/YXOz8.png?s=128&g=1", "display_name": "sab669", "link": "https://stackoverflow.com/users/1189566/sab669"}, "edited": false, "score": 2, "creation_date": 1446063496, "post_id": 33400795, "comment_id": 54592921, "body": "I think you&#39;re mixing up C# and VB; <code>Dim</code> is a VB keyword. For C# you&#39;d simply just declare variables as <code>string sPath;</code> or <code>Media.SoundPlayer mySound;</code>. Your code sample looks like you&#39;ve smashed the languages together. The <code>button1_Click</code> arguments are in C# syntax (<code>object sender</code> instead of <code>sender as object</code>) but then none of your lines of code end in a semicolon (<code>;</code>) as if it were VB"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4074606"}, "is_accepted": true, "score": 0, "last_activity_date": 1446065400, "last_edit_date": 1446065400, "creation_date": 1446064065, "answer_id": 33400992, "question_id": 33400795, "link": "https://stackoverflow.com/questions/33400795/creating-a-soundboard-in-c-net-dim-statement-doesnt-turn-blue/33400992#33400992", "title": "Creating A Soundboard In C# .NET Dim Statement Doesnt Turn Blue", "body": "<p>Since you have not provided error code I will assume it is syntax error.</p>\n\n<p>Your button_click event should look something close to this:</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    string sPath; //Declaration pattern: Variable Type followed by Name\n    System.Media.SoundPlayer mySound; //if you're not using namespace full path\n\n    sPath = \"Location of where I have the sound file.wmv\";\n    mySound = new Media.SoundPlayer(sPath);\n    mySOund.Play();\n}\n</code></pre>\n\n<p>Since dim is used in VB and does not exist in C#. You should declare variables as shown above. Following pattern: type, name and optional - provide variables with values. </p>\n\n<p>Note: reference types should be assigned before using, otherwise it will throw NullReferenceException.</p>\n"}], "owner": {"reputation": 13, "user_id": 4208312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff201833d94bb007843ce12576a761ce?s=128&d=identicon&r=PG", "display_name": "Haley Alisson", "link": "https://stackoverflow.com/users/4208312/haley-alisson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 33400992, "answer_count": 1, "score": -2, "last_activity_date": 1446065400, "creation_date": 1446063348, "last_edit_date": 1446063894, "question_id": 33400795, "link": "https://stackoverflow.com/questions/33400795/creating-a-soundboard-in-c-net-dim-statement-doesnt-turn-blue", "title": "Creating A Soundboard In C# .NET Dim Statement Doesnt Turn Blue", "body": "<p>I'm quite new to c# but most of the times I can handle the errors being thrown my way but this one just doesn't seem to work. Not sure if I'm too close to the issue or something.</p>\n\n<p>-Problem-</p>\n\n<p>I've been working on a small project called \"SoundBoard For Kids\" where I want to create an educational software like a Sound book, nothing too fancy just something to get my knowledge going, and I've made it pretty far into the code but now when I try to make a button play a sound I cant get the code to work, The \"Dim\" statement doesnt want to light up, neither does the \"As String\". Am I forgetting to add something? I'm too afraid to add a Media Player because i'm worried it will mess up the whole code.</p>\n\n<pre><code>        private void button1_Click(object sender, EventArgs e)\n    {\n        Dim sPath As String\n        Dim mySound As Media.SoundPlayer\n\n        sPath = \"Location of where I have the sound file.wmv\"\n        mySound = new Media.SoundPlayer(sPath)\n        mySOund.Play()\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "webhooks"], "answers": [{"comments": [{"owner": {"reputation": 16352, "user_id": 932728, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/4PyNZ.jpg?s=128&g=1", "display_name": "Peter Bons", "link": "https://stackoverflow.com/users/932728/peter-bons"}, "reply_to_user": {"reputation": 3968, "user_id": 3131402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IZkH6.jpg?s=128&g=1", "display_name": "Baqer Naqvi", "link": "https://stackoverflow.com/users/3131402/baqer-naqvi"}, "edited": false, "score": 0, "creation_date": 1502122968, "post_id": 39141303, "comment_id": 78062776, "body": "@BaqerNaqvi If you inspect all the routes in <code>config.Routes</code>, does it show your incoming endpoint?"}, {"owner": {"reputation": 3968, "user_id": 3131402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IZkH6.jpg?s=128&g=1", "display_name": "Baqer Naqvi", "link": "https://stackoverflow.com/users/3131402/baqer-naqvi"}, "edited": false, "score": 0, "creation_date": 1502124307, "post_id": 39141303, "comment_id": 78063500, "body": "No, I placed a debug point before config.InitializeReceiveCustomWebHooks() in WebApiConfig and inspected config.Routes by hovering on config.Routes.MapHttpRoute... code and it does not include api/webhooks/incoming/custom rather in contains two entries one that is default and the second one is empty."}, {"owner": {"reputation": 16352, "user_id": 932728, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/4PyNZ.jpg?s=128&g=1", "display_name": "Peter Bons", "link": "https://stackoverflow.com/users/932728/peter-bons"}, "reply_to_user": {"reputation": 3968, "user_id": 3131402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IZkH6.jpg?s=128&g=1", "display_name": "Baqer Naqvi", "link": "https://stackoverflow.com/users/3131402/baqer-naqvi"}, "edited": false, "score": 0, "creation_date": 1502124992, "post_id": 39141303, "comment_id": 78063836, "body": "You should set a breakpoint after all the initializations. What happens then? Can you post your code somewhere?"}, {"owner": {"reputation": 16352, "user_id": 932728, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/4PyNZ.jpg?s=128&g=1", "display_name": "Peter Bons", "link": "https://stackoverflow.com/users/932728/peter-bons"}, "reply_to_user": {"reputation": 3968, "user_id": 3131402, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IZkH6.jpg?s=128&g=1", "display_name": "Baqer Naqvi", "link": "https://stackoverflow.com/users/3131402/baqer-naqvi"}, "edited": false, "score": 1, "creation_date": 1502128475, "post_id": 39141303, "comment_id": 78065709, "body": "@BaqerNaqvi can you take a look at my pull request? Looks like I missed the <code>EnsureInitialized</code> call"}], "tags": [], "owner": {"reputation": 16352, "user_id": 932728, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/4PyNZ.jpg?s=128&g=1", "display_name": "Peter Bons", "link": "https://stackoverflow.com/users/932728/peter-bons"}, "is_accepted": false, "score": 1, "last_activity_date": 1502129930, "last_edit_date": 1502129930, "creation_date": 1472116771, "answer_id": 39141303, "question_id": 33400788, "link": "https://stackoverflow.com/questions/33400788/asp-net-custom-web-hook/39141303#39141303", "title": "Asp.net Custom Web hook", "body": "<p>Got the same problem (using the latest version (RC1) of the WebHooks packages).</p>\n\n<p>I tracked it down using the source code on GitHub. When you register a WebHook the registration endpoint sends a Get request to the WebHook url (htp://host/api/webhooks/incoming/custom) to check whether it is a valid url or not. In my case the endpoint was not found due to the controller not being present.</p>\n\n<p>I've managed to solve it by making sure the assembly that contains the <code>WebHookReceiversController</code> that provides the <code>api/webhooks/incoming</code> endpoint is loaded. Change your code to this:</p>\n\n<pre><code>public static class WebApiConfig\n{\n    public static void Register(HttpConfiguration config)\n    {\n        // Make sure the assembly Microsoft.AspNet.WebHooks.Receivers is loaded\n        var controllerType = typeof (WebHookReceiversController);\n\n        // Web API configuration and services\n\n        // Web API routes\n        config.MapHttpAttributeRoutes();\n\n        config.Routes.MapHttpRoute(\n            name: \"DefaultApi\",\n            routeTemplate: \"api/{controller}/{id}\",\n            defaults: new { id = RouteParameter.Optional }\n        );\n\n        // Load Web API controllers \n        config.InitializeCustomWebHooks();\n        config.InitializeCustomWebHooksApis();\n        config.InitializeReceiveCustomWebHooks();\n\n        config.EnsureInitialized();\n\n        var webhookRoutes = config.Routes;\n        ; // Set breakpoint here and inspect the variable above, you should see the custom incoming webhook route listened.\n    }\n}\n</code></pre>\n\n<p>Note: the line</p>\n\n<pre><code>var controllerType = typeof (WebHookReceiversController);\n</code></pre>\n\n<p>is added.</p>\n\n<p>If that assembly is not loaded before the routes are mapped the controller is not discovered and therefore not included in the routes known to the api, hence the NotFound error.</p>\n\n<p>A complete end-to-end project using self hosted api projects can be found here:\n<a href=\"https://github.com/Expecho/WebHooks-PoC\" rel=\"nofollow noreferrer\">https://github.com/Expecho/WebHooks-PoC</a></p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 5543489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1ce0dca15487cdad0482c99a384d735?s=128&d=identicon&r=PG&f=1", "display_name": "crumb", "link": "https://stackoverflow.com/users/5543489/crumb"}, "is_accepted": false, "score": -4, "last_activity_date": 1478291151, "last_edit_date": 1478291151, "creation_date": 1478271036, "answer_id": 40425603, "question_id": 33400788, "link": "https://stackoverflow.com/questions/33400788/asp-net-custom-web-hook/40425603#40425603", "title": "Asp.net Custom Web hook", "body": "<p>In case someone still has the problems with that example (even after one year!), here is package that fixed my pain:</p>\n\n<pre><code>Install-Package Microsoft.AspNet.WebHooks.Receivers.Custom -Pre\n</code></pre>\n\n<p>It's a latest version of receiver.</p>\n\n<p><a href=\"https://www.nuget.org/packages/Microsoft.AspNet.WebHooks.Receivers.Custom/1.2.0-rc2\" rel=\"nofollow noreferrer\">https://www.nuget.org/packages/Microsoft.AspNet.WebHooks.Receivers.Custom/1.2.0-rc2</a></p>\n\n<p>Have fun!</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7105134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bad0145ab3cf106a8a5838fcd6a2e00?s=128&d=identicon&r=PG&f=1", "display_name": "Kay Albertus", "link": "https://stackoverflow.com/users/7105134/kay-albertus"}, "is_accepted": false, "score": 0, "last_activity_date": 1497060881, "last_edit_date": 1497060881, "creation_date": 1497059166, "answer_id": 44468753, "question_id": 33400788, "link": "https://stackoverflow.com/questions/33400788/asp-net-custom-web-hook/44468753#44468753", "title": "Asp.net Custom Web hook", "body": "<p>Make sure the WebHookURI property points to your actual server by setting the HTTP port to the correct value, for example</p>\n\n<p><a href=\"http://localhost:YOURPORTVALUE/api/webhooks/incoming/custom\" rel=\"nofollow noreferrer\">http://localhost:YOURPORTVALUE/api/webhooks/incoming/custom</a></p>\n\n<p><a href=\"http://localhost:12345/\" rel=\"nofollow noreferrer\">http://localhost:12345/</a></p>\n\n<p>You might also be missing the following line:</p>\n\n<pre><code>        config.InitializeCustomWebHooksAzureStorage();\n</code></pre>\n\n<p>in your WebApiConfig.cs</p>\n\n<p>We just use the local Development Storage so set the MS_AzureStoreConnectionString connection string</p>\n\n<p>\n  \n</p>\n\n<p>Have a Look at the following </p>\n\n<p>The support for sending WebHooks is provided by the following Nuget packages:</p>\n\n<p>Microsoft.AspNet.WebHooks.Custom: This package provides the core functionality for adding WebHook support to your ASP.NET project. The functionality enables users to register WebHooks using a simple pub/sub model and for your code to send WebHooks to receivers with matching WebHook registrations.</p>\n\n<p>Microsoft.AspNet.WebHooks.Custom.AzureStorage This package provides optional support for persisting WebHook registrations in Microsoft Azure Table Storage.</p>\n\n<p>Microsoft.AspNet.WebHooks.Custom.SqlStorage This package provides optional support for persisting WebHook registrations in SQL. See Updates to Microsoft ASP.NET WebHooks Preview for a description of how to use it.</p>\n\n<p>Microsoft.AspNet.WebHooks.Custom.Mvc This package exposes optional helpers for accessing WebHooks functionality from within ASP.NET MVC Controllers. The helpers assist in providing WebHook registration through MVC controllers as well as creating event notification to be sent to WebHook registrants.</p>\n\n<p>Microsoft.AspNet.WebHooks.Custom.Api This package contains an  optional set of ASP.NET Web API Controllers for managing filters and registrations through a REST-style interface.</p>\n\n<p>a great place to start would be here </p>\n\n<p><a href=\"https://github.com/aspnet/WebHooks/tree/master/samples\" rel=\"nofollow noreferrer\">https://github.com/aspnet/WebHooks/tree/master/samples</a></p>\n"}, {"tags": [], "owner": {"reputation": 5005, "user_id": 442496, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7e6b4064f8f40991e0e7e51f562ada8a?s=128&d=identicon&r=PG", "display_name": "nologo", "link": "https://stackoverflow.com/users/442496/nologo"}, "is_accepted": false, "score": 0, "last_activity_date": 1498460944, "creation_date": 1498460944, "answer_id": 44754590, "question_id": 33400788, "link": "https://stackoverflow.com/questions/33400788/asp-net-custom-web-hook/44754590#44754590", "title": "Asp.net Custom Web hook", "body": "<p>your startup looks different from the article:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web.Http;\n\nnamespace WebApplication2\n{\n    public static class WebApiConfig\n    {\n        public static void Register(HttpConfiguration config)\n        {\n            // Web API configuration and services\n\n            // Web API routes\n            config.MapHttpAttributeRoutes();\n\n            config.Routes.MapHttpRoute(\n                name: \"DefaultApi\",\n                routeTemplate: \"api/{controller}/{id}\",\n                defaults: new { id = RouteParameter.Optional }\n            );\n\n            // Load Web API controllers and Azure Storage store\n            config.InitializeCustomWebHooks();\n            config.InitializeCustomWebHooksAzureStorage();\n            config.InitializeCustomWebHooksApis();\n            config.InitializeReceiveCustomWebHooks();\n        }\n    }\n}\n</code></pre>\n\n<p>particularly look at this line:</p>\n\n<pre><code>config.InitializeCustomWebHooksAzureStorage();\n</code></pre>\n\n<p>you don't have any storage setup.  hopefully this helps someone.</p>\n\n<p>cheers</p>\n"}], "owner": {"reputation": 812, "user_id": 780805, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/fd74d0b9128a18b6f2d780d0b6baa191?s=128&d=identicon&r=PG", "display_name": "Anish", "link": "https://stackoverflow.com/users/780805/anish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10494, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1560896167, "creation_date": 1446063323, "question_id": 33400788, "link": "https://stackoverflow.com/questions/33400788/asp-net-custom-web-hook", "title": "Asp.net Custom Web hook", "body": "<p>I am trying to learn webhooks, my requirement needs to have a publisher which can publish some data and all its subscriber will receive webhook notification.\nHere my requirement i needs to have both publisher and receiver in local host.</p>\n\n<p>I am trying out using the following post.\n<a href=\"http://blogs.msdn.com/b/webdev/archive/2015/09/15/sending-webhooks-with-asp-net-webhooks-preview.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/webdev/archive/2015/09/15/sending-webhooks-with-asp-net-webhooks-preview.aspx</a></p>\n\n<p>How ever when i call the subscribe method it fails. Please advice, whether i am doing any thing wrong.</p>\n\n<pre><code>function subscribe() {\n$.ajax({\n    type: \"POST\",\n    url: \"/api/webhooks/registrations\",\n    data: JSON.stringify({\n        WebHookUri: \"http://localhost:59927/api/webhooks/incoming/custom\",\n        Secret: \"12345678901234567890123456789012\",\n        Description: \"My first WebHook!\"\n    }),\n    contentType: \"application/json; charset=utf-8\",\n    dataType: \"json\",\n    success: function(data, status) { alert(status); },\n    failure: function(errMsg) { alert(errMsg); }\n});\nreturn false;\n</code></pre>\n\n<p>}</p>\n\n<p>This is the error message when i call subscribe method.</p>\n\n<p>\"Message\":\"WebHook verification failed. Please ensure that the WebHook URI is valid and that the endpoint\n is accessible. Error encountered: NotFound\",\"ExceptionMessage\":\"WebHook verification failed. Please\n ensure that the WebHook URI is valid and that the endpoint is accessible. Error encountered: NotFound\"\n,\"ExceptionType\":\"System.InvalidOperationException\"</p>\n\n<p>and this is my WebApiConfig.cs file</p>\n\n<pre><code>public static class WebApiConfig\n{\n    public static void Register(HttpConfiguration config)\n    {\n        // Web API configuration and services\n\n        // Web API routes\n        config.MapHttpAttributeRoutes();\n\n        config.Routes.MapHttpRoute(\n            name: \"DefaultApi\",\n            routeTemplate: \"api/{controller}/{id}\",\n            defaults: new { id = RouteParameter.Optional }\n        );\n\n        // Load Web API controllers \n        config.InitializeCustomWebHooks();\n        config.InitializeCustomWebHooksApis();\n        config.InitializeReceiveCustomWebHooks();\n    }\n}\n</code></pre>\n\n<p>and Global.asax file</p>\n\n<pre><code>protected void Application_Start()\n{\n        AreaRegistration.RegisterAllAreas();\n        GlobalConfiguration.Configure(WebApiConfig.Register);            \n        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);\n        RouteConfig.RegisterRoutes(RouteTable.Routes);\n        BundleConfig.RegisterBundles(BundleTable.Bundles);\n}\n</code></pre>\n"}, {"tags": ["c#", "outlook", "icalendar"], "comments": [{"owner": {"reputation": 10008, "user_id": 462006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/37peF.jpg?s=128&g=1", "display_name": "scrappedcola", "link": "https://stackoverflow.com/users/462006/scrappedcola"}, "edited": false, "score": 0, "creation_date": 1446063862, "post_id": 33400775, "comment_id": 54593089, "body": "You need more details. How are you generating the ics file? What is the raw output for your file? Are you certain the format is correct?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1446066816, "post_id": 33400775, "comment_id": 54594654, "body": "Please post the full MIME source of the message that you are sending."}], "answers": [{"tags": [], "owner": {"reputation": 899, "user_id": 3237930, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/588f966a28c57e0b88c5477bda1cdfc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ferid Sejdovi\u0107", "link": "https://stackoverflow.com/users/3237930/ferid-sejdovi%c4%87"}, "is_accepted": true, "score": 0, "last_activity_date": 1446074395, "creation_date": 1446074395, "answer_id": 33403290, "question_id": 33400775, "link": "https://stackoverflow.com/questions/33400775/how-to-read-my-ics-file-as-a-meeting-email-in-outlook/33403290#33403290", "title": "How to read my ICS file as a meeting email in Outlook", "body": "<p>I found this working fine:\n\"Optionally, you could also attach the .ics file itself, so regular mail readers can offer the user something to click on. Outlook does not really require the attachment because it just reads the text/calendar part.\"</p>\n"}], "owner": {"reputation": 899, "user_id": 3237930, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/588f966a28c57e0b88c5477bda1cdfc0?s=128&d=identicon&r=PG&f=1", "display_name": "Ferid Sejdovi\u0107", "link": "https://stackoverflow.com/users/3237930/ferid-sejdovi%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 33403290, "answer_count": 1, "score": 0, "last_activity_date": 1446074395, "creation_date": 1446063282, "last_edit_date": 1446067042, "question_id": 33400775, "link": "https://stackoverflow.com/questions/33400775/how-to-read-my-ics-file-as-a-meeting-email-in-outlook", "title": "How to read my ICS file as a meeting email in Outlook", "body": "<p>I found a method <a href=\"https://blogs.perficient.com/microsoft/2008/11/generating-outlook-calendar-invitations-on-the-fly-using-c-and-net/\" rel=\"nofollow\">here</a> which creates *.ICS file which I need to send as a email. The problem I am facing is that Outlook 2010 is not reading that as meeting email. Instead, it reads it as a regular email. Here is the code below:</p>\n\n<pre><code>System.Net.Mime.ContentType contype = new System.Net.Mime.ContentType(\"text/calendar\");\ncontype.Parameters.Add(\"method\", \"REQUEST\");\ncontype.Parameters.Add(\"name\", \"Meeting.ics\");\nAlternateView avCal = AlternateView.CreateAlternateViewFromString(str.ToString(), contype);\nmsg.AlternateViews.Add(avCal);\nclient.Send(msg);\n</code></pre>\n"}, {"tags": ["c#", ".net", "vb.net"], "answers": [{"tags": [], "owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1446066335, "creation_date": 1446066335, "answer_id": 33401577, "question_id": 33400752, "link": "https://stackoverflow.com/questions/33400752/obtaining-the-correct-path-to-a-resource-file-in-my-project/33401577#33401577", "title": "Obtaining the correct path to a resource file in my project", "body": "<p><code>Application.StartupPath</code> returns the folder for the program running from within the VS project. You can parse back up the path and come down to Resources. Only works while running under VS of course. Typical path: <code>C:\\DevVS2010\\_Misc_Projects\\_TestApp\\TestApp\\bin\\Debug</code></p>\n"}, {"tags": [], "owner": {"reputation": 1614, "user_id": 4552326, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/f1LTL.jpg?s=128&g=1", "display_name": "David BS", "link": "https://stackoverflow.com/users/4552326/david-bs"}, "is_accepted": false, "score": 0, "last_activity_date": 1446069600, "creation_date": 1446069600, "answer_id": 33402357, "question_id": 33400752, "link": "https://stackoverflow.com/questions/33400752/obtaining-the-correct-path-to-a-resource-file-in-my-project/33402357#33402357", "title": "Obtaining the correct path to a resource file in my project", "body": "<p>I guess your problem is also related to wrong slashes...</p>\n\n<p>Try this code:</p>\n\n<pre><code>    Public Const ThemesPath As String = Application.StartupPath &amp; \"\\Resources\\SyntaxEditor\\\"\n</code></pre>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 2280, "user_id": 1458985, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/0fcfed451b42d89b70f5e7ee49ec62b3?s=128&d=identicon&r=PG", "display_name": "Dom Sinclair", "link": "https://stackoverflow.com/users/1458985/dom-sinclair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446069600, "creation_date": 1446063224, "last_edit_date": 1446067651, "question_id": 33400752, "link": "https://stackoverflow.com/questions/33400752/obtaining-the-correct-path-to-a-resource-file-in-my-project", "title": "Obtaining the correct path to a resource file in my project", "body": "<p>I have translated a piece of C# code that is referencing a resource in a namespace path, something which VB doesn't exactly replicate.</p>\n\n<p>The translated code is as follows:</p>\n\n<pre><code>Dim path As String = ThemesPath &amp; \"Dark.vssettings\"\n Using stream As Stream = System.Reflection.Assembly.GetExecutingAssembly().GetManifestResourceStream(path)\n                If stream IsNot Nothing Then\n                    AmbientHighlightingStyleRegistry.Instance.ImportHighlightingStyles(stream)\n                End If\n            End Using\n</code></pre>\n\n<p>In my Project I have folder Called 'Resources', which in turn contains a folder called 'SyntaxEditor' which contains the Dark.vssettings file.</p>\n\n<p>I would like to declare ThemesPath as a string constant but am having trouble getting the syntax right such that the code within the Using statement can find the Dark.vssettings file.</p>\n\n<p>I tried the following which I thought would do the trick but it doesn't.</p>\n\n<pre><code> Public Const ThemesPath As String = \"Resources/SyntaxEditor/\"\n</code></pre>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c#", "wpf", "triggers", "user-controls", "resourcedictionary"], "comments": [{"owner": {"reputation": 1431, "user_id": 3063835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10ab12800198b9531488aa7a97df5e?s=128&d=identicon&r=PG&f=1", "display_name": "Rowbear", "link": "https://stackoverflow.com/users/3063835/rowbear"}, "edited": false, "score": 0, "creation_date": 1446064203, "post_id": 33400719, "comment_id": 54593266, "body": "Are you certain the StaticResource BackgroundGray and SelectedGray are resolvable? Have you tried setting the trigger color changes to some default colors just to make sure it&#39;s not an issue with resolving the custom brushes?"}, {"owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "reply_to_user": {"reputation": 1431, "user_id": 3063835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10ab12800198b9531488aa7a97df5e?s=128&d=identicon&r=PG&f=1", "display_name": "Rowbear", "link": "https://stackoverflow.com/users/3063835/rowbear"}, "edited": false, "score": 0, "creation_date": 1446067368, "post_id": 33400719, "comment_id": 54594909, "body": "I checked it just in case, but no, those brushes are defined in the same dictionary, in the same way that the foreground property colour of &quot;ContainedTextBlock&quot; is defined (which is working) - I&#39;ve edited the OP to reflect this."}], "answers": [{"tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": false, "score": 1, "last_activity_date": 1446073686, "creation_date": 1446073686, "answer_id": 33403160, "question_id": 33400719, "link": "https://stackoverflow.com/questions/33400719/resourcedictionary-style-triggers-not-working-in-usercontrol/33403160#33403160", "title": "ResourceDictionary Style.Triggers Not Working In UserControl", "body": "<p>The <code>Grid</code> object cannot receive focus (nor can <code>TextBlock</code> for that matter, though that's not immediately relevant in the code posted above). It stands to reason then, that any trigger that is activated only when it does receive focus will itself never be activated.</p>\n\n<p>If you feel otherwise, please provide <a href=\"https://stackoverflow.com/help/mcve\">a good, <em>minimal</em>, <em>complete</em> code example</a> that reliably reproduces the problem. Please be sure to include a precise explanation of how the user should interact with the program such that you would expect these triggers to be activated.</p>\n"}, {"tags": [], "owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "is_accepted": true, "score": 0, "last_activity_date": 1446412843, "last_edit_date": 1446412843, "creation_date": 1446158172, "answer_id": 33425834, "question_id": 33400719, "link": "https://stackoverflow.com/questions/33400719/resourcedictionary-style-triggers-not-working-in-usercontrol/33425834#33425834", "title": "ResourceDictionary Style.Triggers Not Working In UserControl", "body": "<p>I finally got this working.</p>\n\n<p>For the User Control:</p>\n\n<pre><code>&lt;UserControl x:Class=\"Project.Controls.CustomGrid\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             Height=\"Auto\" Width=\"Auto\" Style=\"{StaticResource GridStyle}\"&gt;\n\n    &lt;Grid Style=\"{StaticResource ContainedGrid}\"&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"200\"/&gt;\n            &lt;ColumnDefinition Width=\"10\"/&gt;\n            &lt;ColumnDefinition Width=\"200\"/&gt;\n            &lt;ColumnDefinition Width=\"10\"/&gt;\n            &lt;ColumnDefinition Width=\"70\"/&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;TextBlock x:Name=\"Block1\" Grid.Column=\"0\" Style=\"{StaticResource ContainedTextBlock}\"/&gt;\n        &lt;TextBlock x:Name=\"Block2\" Grid.Column=\"2\" Style=\"{StaticResource ContainedTextBlock}\"/&gt;\n        &lt;TextBlock x:Name=\"Block3\" Grid.Column=\"4\" TextAlignment=\"Right\" Style=\"{StaticResource ContainedTextBlock}\"/&gt;\n    &lt;/Grid&gt;\n\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>In the Resource Dictionary:</p>\n\n<pre><code>    &lt;Style TargetType=\"UserControl\" x:Key=\"GridStyle\"&gt;\n        &lt;Setter Property=\"DockPanel.Dock\" Value=\"Top\"/&gt;\n        &lt;Setter Property=\"Focusable\" Value=\"True\"/&gt;\n    &lt;/Style&gt;\n\n    &lt;Style TargetType=\"{x:Type Grid}\" x:Key=\"ContainedGrid\"&gt;\n        &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n        &lt;Style.Triggers&gt;\n            &lt;DataTrigger Binding=\"{Binding Path=IsFocused, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}\" Value=\"True\"&gt;\n                &lt;Setter Property=\"Background\" Value=\"{StaticResource BackgroundGray}\"/&gt;\n            &lt;/DataTrigger&gt;\n            &lt;DataTrigger Binding=\"{Binding Path=IsKeyboardFocused, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}\" Value=\"True\"&gt;\n                &lt;Setter Property=\"Background\" Value=\"{StaticResource SelectedGray}\"/&gt;\n            &lt;/DataTrigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n\n    &lt;Style TargetType=\"{x:Type TextBlock}\" x:Key=\"ContainedTextBlock\"&gt;\n        &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n        &lt;Setter Property=\"Foreground\" Value=\"{StaticResource PrimaryColor}\"/&gt;\n        &lt;Setter Property=\"TextTrimming\" Value=\"WordEllipsis\"/&gt;\n        &lt;Style.Triggers&gt;\n            &lt;DataTrigger Binding=\"{Binding Path=IsKeyboardFocused, RelativeSource={RelativeSource FindAncestor, AncestorType=UserControl}}\" Value=\"True\"&gt;\n                &lt;Setter Property=\"Foreground\" Value=\"White\"/&gt;\n            &lt;/DataTrigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n</code></pre>\n\n<p>Another thing to watch out for, the final thing that threw me off, is that the event handler I\u2019m using to give keyboard focus to the User Control didn\u2019t have\u2026</p>\n\n<pre><code>e.Handled = true;\n</code></pre>\n\n<p>\u2026 at the end.</p>\n\n<p>The click was therefore bubbling back and giving the container (a ScrollViewer) the keyboard focus.</p>\n\n<p>To summarise:</p>\n\n<ol>\n<li>The element getting focus is the UserControl.</li>\n<li>The Grid and TextBlocks are being formatted based on the focus status of the nearest UserControl in their ancestry.</li>\n</ol>\n"}], "owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 930, "favorite_count": 0, "accepted_answer_id": 33425834, "answer_count": 2, "score": 1, "last_activity_date": 1446412843, "creation_date": 1446063078, "last_edit_date": 1446073778, "question_id": 33400719, "link": "https://stackoverflow.com/questions/33400719/resourcedictionary-style-triggers-not-working-in-usercontrol", "title": "ResourceDictionary Style.Triggers Not Working In UserControl", "body": "<p>I have the following <code>Grid</code> in a <code>UserControl</code>, in its own XAML file:</p>\n\n<pre><code>&lt;Grid Style=\"{StaticResource GridStyle}\"&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"200\"/&gt;\n        &lt;ColumnDefinition Width=\"10\"/&gt;\n        &lt;ColumnDefinition Width=\"200\"/&gt;\n        &lt;ColumnDefinition Width=\"10\"/&gt;\n        &lt;ColumnDefinition Width=\"70\"/&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;TextBlock x:Name=\"Box1\" Style=\"{StaticResource ContainedTextBlock}\" Grid.Column=\"0\"/&gt;\n    &lt;TextBlock x:Name=\"Box2\" Style=\"{StaticResource ContainedTextBlock}\" Grid.Column=\"2\"/&gt;\n    &lt;TextBlock x:Name=\"Box3\" Style=\"{StaticResource ContainedTextBlock}\" Grid.Column=\"4\" TextAlignment=\"Right\"/&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>In a separate Resource Dictionary XAML file, I have the following:</p>\n\n<pre><code>&lt;SolidColorBrush x:Key=\"PrimaryColour\" Color=\"#FF334D51\"/&gt;\n&lt;SolidColorBrush x:Key=\"BackgroundGray\" Color=\"#FFDEDEDE\"/&gt;\n&lt;SolidColorBrush x:Key=\"SelectedGray\" Color=\"#FF566164\"/&gt;\n\n&lt;Style TargetType=\"TextBlock\" x:Key=\"ContainedTextBlock\"&gt;\n    &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n    &lt;Setter Property=\"Foreground\" Value=\"{StaticResource PrimaryColour}\"/&gt;\n    &lt;Setter Property=\"TextTrimming\" Value=\"WordEllipsis\"/&gt;\n    &lt;Style.Triggers&gt;\n        &lt;DataTrigger Binding=\"{Binding Path=IsFocused, RelativeSource={RelativeSource TemplatedParent}}\" Value=\"True\"&gt;\n            &lt;Setter Property=\"Foreground\" Value=\"White\"/&gt;\n        &lt;/DataTrigger&gt;\n    &lt;/Style.Triggers&gt;\n&lt;/Style&gt;\n\n&lt;Style TargetType=\"Grid\" x:Key=\"GridStyle\"&gt;\n    &lt;Setter Property=\"DockPanel.Dock\" Value=\"Top\"/&gt;\n    &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n    &lt;Style.Triggers&gt;\n        &lt;Trigger Property=\"IsFocused\" Value=\"True\"&gt;\n            &lt;Setter Property=\"Background\" Value=\"{StaticResource BackgroundGray}\"/&gt;\n        &lt;/Trigger&gt;\n        &lt;Trigger Property=\"IsKeyboardFocused\" Value=\"True\"&gt;\n            &lt;Setter Property=\"Background\" Value=\"{StaticResource SelectedGray}\"/&gt;\n        &lt;/Trigger&gt;\n    &lt;/Style.Triggers&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p>Can anyone help me on why the Style.Triggers parts are not being picked up at runtime, i.e. the colours of my controls are not changing? (Note: The other parts of the styles are working.)</p>\n"}, {"tags": ["c#", ".net", "entity-framework", "profiler"], "comments": [{"owner": {"reputation": 5914, "user_id": 134848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a52afd6c788eb27121003a9a8a4a9333?s=128&d=identicon&r=PG", "display_name": "krystan honour", "link": "https://stackoverflow.com/users/134848/krystan-honour"}, "edited": false, "score": 0, "creation_date": 1458042776, "post_id": 33400685, "comment_id": 59672461, "body": "would help if you posted the database schema"}], "owner": {"reputation": 1878, "user_id": 2148090, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6db0f6a8439e1d282a940aa562a08c16?s=128&d=identicon&r=PG", "display_name": "MicroMan", "link": "https://stackoverflow.com/users/2148090/microman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1446062966, "creation_date": 1446062966, "question_id": 33400685, "link": "https://stackoverflow.com/questions/33400685/hibernating-rhinos-profiler-column-type-mismatch-warning", "title": "Hibernating Rhinos Profiler Column Type Mismatch Warning", "body": "<p>When i run the entity framework profiler i get lost of Column Type mismatch errors which apparently can affect performance\n<a href=\"http://hibernatingrhinos.com/products/EFProf/learn/alert/ColumnTypeMismatch\" rel=\"nofollow\">http://hibernatingrhinos.com/products/EFProf/learn/alert/ColumnTypeMismatch</a></p>\n\n<p>So i tried to match my entity up to the database using attributes but i still get the warning.</p>\n\n<pre><code>[Key, Required, Column(TypeName = \"nvarchar\"), StringLength(25)]\npublic virtual string UserLoginName { get; set; }\n\n[Column(TypeName = \"nvarchar\"), StringLength(50)]\npublic virtual string FirstName { get; set; }\n\n[Column(TypeName = \"nvarchar\"), StringLength(50)]\npublic virtual string LastName { get; set; }\n\n[Column(\"UserType\", TypeName = \"int\")]\npublic virtual CompanyType? CompanyType { get; set; } // this is a ENUM nut maps to a int is this correct to map to int?\n\npublic virtual ICollection&lt;Permits&gt; Permits { get; set; } // navigation property so no attributes?\n\n[Column(TypeName = \"DateTime2\")]\npublic virtual DateTime? DOB{ get; set; } // is it correct to map datetime to Datetime2?\n\n[Column(TypeName = \"nvarchar(MAX)\")]\npublic virtual string Notes { get; set; }\n</code></pre>\n"}, {"tags": ["c#", ".net", "linq"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 3, "creation_date": 1446063118, "post_id": 33400638, "comment_id": 54592715, "body": "Note that you can pull <code>numbers.Count &#47; 2 + 1</code> out of the query and into a variable to avoid recalculating it for every single group."}, {"owner": {"reputation": 775, "user_id": 2847379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec73d9e807b93deae33c4cf922fed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGriff", "link": "https://stackoverflow.com/users/2847379/michael-mcgriff"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446063504, "post_id": 33400638, "comment_id": 54592927, "body": "@Servy isn&#39;t <code>Count</code> a property of <code>IList&lt;T&gt;</code> so it&#39;s not actually being calculated?"}, {"owner": {"reputation": 636, "user_id": 2685732, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/ERSgr.png?s=128&g=1", "display_name": "arnaudoff", "link": "https://stackoverflow.com/users/2685732/arnaudoff"}, "reply_to_user": {"reputation": 775, "user_id": 2847379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec73d9e807b93deae33c4cf922fed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGriff", "link": "https://stackoverflow.com/users/2847379/michael-mcgriff"}, "edited": false, "score": 0, "creation_date": 1446063608, "post_id": 33400638, "comment_id": 54592976, "body": "@MichaelMcGriff He is referring to the expression as a whole."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 775, "user_id": 2847379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec73d9e807b93deae33c4cf922fed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGriff", "link": "https://stackoverflow.com/users/2847379/michael-mcgriff"}, "edited": false, "score": 0, "creation_date": 1446063731, "post_id": 33400638, "comment_id": 54593022, "body": "@MichaelMcGriff You&#39;re still dividing it by 2 and adding one over and over.  You&#39;re correct that any sensible <code>IList</code> implementation won&#39;t have io iterate the collection to get a count."}, {"owner": {"reputation": 775, "user_id": 2847379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec73d9e807b93deae33c4cf922fed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGriff", "link": "https://stackoverflow.com/users/2847379/michael-mcgriff"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446063982, "post_id": 33400638, "comment_id": 54593148, "body": "@Servy I thought the compiler might be smart enough to know that <code>number.Count &#47; 2 + 1</code> wouldn&#39;t change during the process and not have to recalculate it each time.  Thanks for the information."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 775, "user_id": 2847379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec73d9e807b93deae33c4cf922fed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGriff", "link": "https://stackoverflow.com/users/2847379/michael-mcgriff"}, "edited": false, "score": 1, "creation_date": 1446064158, "post_id": 33400638, "comment_id": 54593244, "body": "@MichaelMcGriff The compiler is smart enough to know that <code>number.Count</code> <i>can</i> change between invocations of that delegate, which is why it <i>can&#39;t</i> avoid recalculating it each time."}], "answers": [{"tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": true, "score": 9, "last_activity_date": 1446063030, "creation_date": 1446063030, "answer_id": 33400704, "question_id": 33400638, "link": "https://stackoverflow.com/questions/33400638/singleordefault-when-the-sequence-contains-the-default-value/33400704#33400704", "title": "SingleOrDefault() when the sequence contains the default value", "body": "<p>Use a nullable value where <code>null</code> indicates that there is no majorant, rather than using \"0\" to mean that.  And conveniently enough, the default value of <code>int?</code> is <code>null</code>, so the only change needed to your code is to get a sequence of nullable ints before calling <code>SingleOrDefault</code>.</p>\n\n<pre><code>public static int? FindMajorant(IList&lt;int&gt; numbers)\n{\n    return numbers\n        .GroupBy(x =&gt; x)\n        .Where(g =&gt; g.Count() &gt;= numbers.Count / 2 + 1)\n        .Select(g =&gt; (int?)g.Key)\n        .SingleOrDefault();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10685, "user_id": 4079967, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/509151049/picture?type=large", "display_name": "Kevin Smith", "link": "https://stackoverflow.com/users/4079967/kevin-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1446063413, "creation_date": 1446063413, "answer_id": 33400818, "question_id": 33400638, "link": "https://stackoverflow.com/questions/33400638/singleordefault-when-the-sequence-contains-the-default-value/33400818#33400818", "title": "SingleOrDefault() when the sequence contains the default value", "body": "<p>You could project the result in to a typed object say <code>MajorantResult</code> thus then returning null:</p>\n\n<pre><code>    public static MajorantResult FindMajorant(IList&lt;int&gt; numbers)\n    {\n        return numbers\n            .GroupBy(x =&gt; x)\n            .Where(g =&gt; g.Count() &gt;= numbers.Count/2 + 1)\n            .Select(g =&gt; new MajorantResult(g.Key))\n            .SingleOrDefault();\n    }\n\n    public class MajorantResult\n    {\n        public int Key { get; }\n\n        public MajorantResult(int key)\n        {\n            this.Key = key;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 636, "user_id": 2685732, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/ERSgr.png?s=128&g=1", "display_name": "arnaudoff", "link": "https://stackoverflow.com/users/2685732/arnaudoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 1, "accepted_answer_id": 33400704, "answer_count": 2, "score": 7, "last_activity_date": 1446063413, "creation_date": 1446062784, "question_id": 33400638, "link": "https://stackoverflow.com/questions/33400638/singleordefault-when-the-sequence-contains-the-default-value", "title": "SingleOrDefault() when the sequence contains the default value", "body": "<p>I have stumbled upon an interesting scenario, which I couldn't find a solution to. Suppose I have to find the majorant in a sequence (the number that occurs at least <code>n / 2 + 1</code> times, where <code>n</code> is the size of the sequence). This is my implementation:</p>\n\n<pre><code>public static int FindMajorant(IList&lt;int&gt; numbers)\n{\n    return numbers\n        .GroupBy(x =&gt; x)\n        .Where(g =&gt; g.Count() &gt;= numbers.Count / 2 + 1)\n        .Select(g =&gt; g.Key)\n        .SingleOrDefault();\n}\n</code></pre>\n\n<p>I'm using <code>SingleOrDefault()</code>, which returns the element if it's found in the sequence or the default value for the type: in this case, it will return <code>0</code> as it's the default value for an <code>int</code>. For example, my method returns <code>3</code> for the following sequence:</p>\n\n<pre><code>List&lt;int&gt; sampleNumbers = new List&lt;int&gt;() { 2, 2, 3, 3, 2, 3, 4, 3, 3 };\n</code></pre>\n\n<p>which is the expected behaviour.</p>\n\n<p>However, what happens if the majorant in the sequence is zero (<code>0</code>)? It would return 0, but that way, how could I determine whether it's the zero from <code>SingleOrDefault()</code> as a default value, or the majorant? Perhaps, I could use <code>Single()</code>, but that would throw an exception which is pretty much incorrent. I could also catch this exception, but this seems a bad practice to me. So my question is, what's the preferred way to handle this situation?</p>\n"}, {"tags": ["c#", ".net", "xaml", "windows-store-apps", "win-universal-app"], "answers": [{"comments": [{"owner": {"reputation": 13365, "user_id": 1028230, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/fbeKv.png?s=128&g=1", "display_name": "ruffin", "link": "https://stackoverflow.com/users/1028230/ruffin"}, "edited": false, "score": 1, "creation_date": 1474927717, "post_id": 33401164, "comment_id": 66724351, "body": "Anything that solves <a href=\"http://stackoverflow.com/a/37260436/1028230\">the issue @Parham.D sees</a>, namely that the text has the title appended? If I want to set it programmatically, but without the <i>- AppName</i> appended, what would I do?"}, {"owner": {"reputation": 13365, "user_id": 1028230, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/fbeKv.png?s=128&g=1", "display_name": "ruffin", "link": "https://stackoverflow.com/users/1028230/ruffin"}, "edited": false, "score": 0, "creation_date": 1474930617, "post_id": 33401164, "comment_id": 66725270, "body": "I guess there&#39;s <a href=\"http://stackoverflow.com/a/32648955/1028230\">this sort of complete customization</a> (<a href=\"https://marcominerva.wordpress.com/2015/05/19/easily-manage-the-title-bar-in-windows-10-apps/\" rel=\"nofollow noreferrer\">another example</a>, both pretty much copies of <a href=\"https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/TitleBar\" rel=\"nofollow noreferrer\">this from Microsoft on GitHub</a>), but that&#39;s a little overkill-ish imo. Guess I&#39;ll just deal with the app name in the &quot;wrong&quot; order for now. Thanks!"}, {"owner": {"reputation": 317, "user_id": 946519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/130435d41e6d3e9b134beff19804b5ec?s=128&d=identicon&r=PG", "display_name": "Gavin Williams", "link": "https://stackoverflow.com/users/946519/gavin-williams"}, "edited": false, "score": 1, "creation_date": 1515933485, "post_id": 33401164, "comment_id": 83481779, "body": "This doesn&#39;t seem to work for me, GetForCurrentView gives : System.Exception: &#39;Element not found. (Exception from HRESULT: 0x80070490)&#39;"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": true, "score": 19, "last_activity_date": 1446064649, "creation_date": 1446064649, "answer_id": 33401164, "question_id": 33400597, "link": "https://stackoverflow.com/questions/33400597/change-a-windows-store-apps-title-text/33401164#33401164", "title": "Change a Windows Store App&#39;s title text", "body": "<pre><code>using Windows.UI.ViewManagement;\n\n...\n\nApplicationView appView = ApplicationView.GetForCurrentView();\nappView.Title = \"Title text goes here\";\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3012, "user_id": 3101082, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1WxPj.jpg?s=128&g=1", "display_name": "dub stylee", "link": "https://stackoverflow.com/users/3101082/dub-stylee"}, "edited": false, "score": 0, "creation_date": 1469053945, "post_id": 37260436, "comment_id": 64385290, "body": "In addition to setting the name in the <code>Package.appxmanifest</code>, it is also necessary to check the box for the different logo sizes that you want to display the app title."}], "tags": [], "owner": {"reputation": 1090, "user_id": 1224187, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/MXLoW.jpg?s=128&g=1", "display_name": "Parham.D", "link": "https://stackoverflow.com/users/1224187/parham-d"}, "is_accepted": false, "score": 12, "last_activity_date": 1469064993, "last_edit_date": 1469064993, "creation_date": 1463422190, "answer_id": 37260436, "question_id": 33400597, "link": "https://stackoverflow.com/questions/33400597/change-a-windows-store-apps-title-text/37260436#37260436", "title": "Change a Windows Store App&#39;s title text", "body": "<p>When I use <code>ApplicationView</code>, it appends the <code>Title</code> to the assembly name.</p>\n\n<p>We could edit <code>Application</code> -> <code>Display Name</code>  in the <code>Package.appxmanifest</code> file.</p>\n"}], "owner": {"reputation": 23403, "user_id": 939213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85abdf3e1c88011c45e1a0cae01df78b?s=128&d=identicon&r=PG", "display_name": "ispiro", "link": "https://stackoverflow.com/users/939213/ispiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6441, "favorite_count": 2, "accepted_answer_id": 33401164, "answer_count": 2, "score": 10, "last_activity_date": 1469064993, "creation_date": 1446062648, "question_id": 33400597, "link": "https://stackoverflow.com/questions/33400597/change-a-windows-store-apps-title-text", "title": "Change a Windows Store App&#39;s title text", "body": "<p>How can I change the shown title of the app? (Like <strong>Photos</strong> does)</p>\n\n<p>In Winforms that would be <code>form1.Text = \"new title\";</code>.</p>\n\n<p>How do we do that in UWP?</p>\n"}, {"tags": ["c#", ".net", "vb.net", "winforms", "macos"], "comments": [{"owner": {"reputation": 4264, "user_id": 5413498, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Za8D3.jpg?s=128&g=1", "display_name": "David Wilson", "link": "https://stackoverflow.com/users/5413498/david-wilson"}, "edited": false, "score": 0, "creation_date": 1446136715, "post_id": 33400587, "comment_id": 54629230, "body": "I&#39;m away from my pc at the moment, but is is possible to set the frmMain visible property in design mode to false and then programmatically set it to visible after the computation has finished?"}], "owner": {"reputation": 2461, "user_id": 1084005, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/31bb5aa72c4216b825859f22c46728b8?s=128&d=identicon&r=PG", "display_name": "jordan koskei", "link": "https://stackoverflow.com/users/1084005/jordan-koskei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449409297, "creation_date": 1446062626, "last_edit_date": 1449409297, "question_id": 33400587, "link": "https://stackoverflow.com/questions/33400587/vb-net-form-is-visible-before-load-event-is-done-when-using-mac-remote-desktop", "title": "vb.net form is visible before Load event is done when using Mac remote desktop", "body": "<p>i have a scenario involving 2 forms <code>frmSplash</code> and <code>frmmain</code> whereby :-\n(a)I need to load and show <code>frmSplash</code>\n(b)load <code>frmmain</code>, BUT dont show it until some computation that happen in the <code>Load()</code> event is complete at which point I hide <code>frmSplash</code>. That is how it should work anyway.</p>\n\n<p>Both <code>frmSplash</code> and <code>frmmain</code> are loaded in a sub Main as below:</p>\n\n<pre><code>sub main\n{\nfrmSplash .show()\n\n Application.Run(New frmMain)\n}\n</code></pre>\n\n<p>PROBLEM is that when we get to running <code>frmMain</code>,  its form shows up BEFORE the <code>load()</code> event is done WHEN running the application via remote desktop connection from a Mac client. There is no problem with remoting from windows machines as the <code>frmMain</code> does NOT appear until its load is executed and <code>frmSplash</code> has been hidden by <code>frmmain</code>.</p>\n"}, {"tags": ["c#", "http", "elasticsearch"], "comments": [{"owner": {"reputation": 10800, "user_id": 3601682, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Rs82W.jpg?s=128&g=1", "display_name": "ChintanShah25", "link": "https://stackoverflow.com/users/3601682/chintanshah25"}, "edited": false, "score": 0, "creation_date": 1446063301, "post_id": 33400569, "comment_id": 54592816, "body": "shouldn&#39;t string s1 be &quot;{\\&quot;query\\&quot;: {\\&quot;match\\&quot;: { \\&quot;name\\&quot; : \\&quot;john\\&quot; }}}&quot; ?"}, {"owner": {"reputation": 717, "user_id": 3625461, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b46b43d3b4b629c2a560bc029bb928ef?s=128&d=identicon&r=PG&f=1", "display_name": "Gondil", "link": "https://stackoverflow.com/users/3625461/gondil"}, "reply_to_user": {"reputation": 10800, "user_id": 3601682, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Rs82W.jpg?s=128&g=1", "display_name": "ChintanShah25", "link": "https://stackoverflow.com/users/3601682/chintanshah25"}, "edited": false, "score": 0, "creation_date": 1446067078, "post_id": 33400569, "comment_id": 54594773, "body": "Sorry just a mistake.. I tried to make it easier to understand. In my original document I use field &#180;text&#180; but here I renamed it to &#180;name&#180; but I forgot to overwrite that particular &#180;text&#180; in that piece of code. But my problem is still current."}, {"owner": {"reputation": 301, "user_id": 5159740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCbqV.jpg?s=128&g=1", "display_name": "Emna Jaoua", "link": "https://stackoverflow.com/users/5159740/emna-jaoua"}, "edited": false, "score": 0, "creation_date": 1564476696, "post_id": 33400569, "comment_id": 101034056, "body": "Is it possible to explain what does &#39;pretty&#39; refers to in your url request ?"}, {"owner": {"reputation": 717, "user_id": 3625461, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b46b43d3b4b629c2a560bc029bb928ef?s=128&d=identicon&r=PG&f=1", "display_name": "Gondil", "link": "https://stackoverflow.com/users/3625461/gondil"}, "reply_to_user": {"reputation": 301, "user_id": 5159740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCbqV.jpg?s=128&g=1", "display_name": "Emna Jaoua", "link": "https://stackoverflow.com/users/5159740/emna-jaoua"}, "edited": false, "score": 0, "creation_date": 1564477857, "post_id": 33400569, "comment_id": 101034719, "body": "@EmnaJaoua <a href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html\" rel=\"nofollow noreferrer\">elastic.co/guide/en/elasticsearch/reference/current/&hellip;</a>"}, {"owner": {"reputation": 301, "user_id": 5159740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uCbqV.jpg?s=128&g=1", "display_name": "Emna Jaoua", "link": "https://stackoverflow.com/users/5159740/emna-jaoua"}, "edited": false, "score": 0, "creation_date": 1564479190, "post_id": 33400569, "comment_id": 101035454, "body": "Thanks for your reply. I am trying to do the same also using HttpClient library (since I need to work with .Net Client 2.2 framework). I am defining the url and credentials through client.BaseAddress and client.DefaultRequestHeaders.Authorization but when I get the response through response = await client.GetAsync(path), the response is not successful so I was not able to make a request. I am using exactly the same query format as yours (string s). Any useful links for help please ?"}], "answers": [{"comments": [{"owner": {"reputation": 560, "user_id": 605006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/159f1f433be0b865a6556ff4d0c6f54a?s=128&d=identicon&r=PG", "display_name": "Shawn Eary", "link": "https://stackoverflow.com/users/605006/shawn-eary"}, "edited": false, "score": 0, "creation_date": 1548989739, "post_id": 33444073, "comment_id": 95752195, "body": "Your answer used a POST verb. For security reasons, I want to find a solution with the GET verb. GNU/Linux cURL will allow you to send message bodies with the GET verb so I don&#39;t understand why so many other WebRequest tools don&#39;t allow it. From what I&#39;ve read elsewhere on SO, sending a request body with a GET request is &quot;weird&quot;, but the standard doesn&#39;t specifically disallow it."}], "tags": [], "owner": {"reputation": 717, "user_id": 3625461, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b46b43d3b4b629c2a560bc029bb928ef?s=128&d=identicon&r=PG&f=1", "display_name": "Gondil", "link": "https://stackoverflow.com/users/3625461/gondil"}, "is_accepted": true, "score": 2, "last_activity_date": 1446235541, "creation_date": 1446235541, "answer_id": 33444073, "question_id": 33400569, "link": "https://stackoverflow.com/questions/33400569/how-to-query-elasticsearch-from-c-via-http/33444073#33444073", "title": "How to query Elasticsearch from C# via HTTP?", "body": "<p>Final solution for my question is in this code</p>\n\n<pre><code>string url_req = \"http://localhost:9200/my_index/my_type/_search?pretty\";\n\nstring s = \"{\\\"query\\\": {\\\"match\\\": { \\\"name\\\" : \\\"john\\\" }}}\";\n\nusing (var client = new WebClient())\n{\n    Console.Write(client.UploadString(url_req, \"POST\", s));\n}\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 3625461, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b46b43d3b4b629c2a560bc029bb928ef?s=128&d=identicon&r=PG&f=1", "display_name": "Gondil", "link": "https://stackoverflow.com/users/3625461/gondil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8336, "favorite_count": 2, "accepted_answer_id": 33444073, "answer_count": 1, "score": 6, "last_activity_date": 1446235541, "creation_date": 1446062567, "last_edit_date": 1446067194, "question_id": 33400569, "link": "https://stackoverflow.com/questions/33400569/how-to-query-elasticsearch-from-c-via-http", "title": "How to query Elasticsearch from C# via HTTP?", "body": "<p>I am trying to write code in C# for PUT and GET to my elasticsearch data.\nI typed code for PUT like this, and it seems that it works:</p>\n\n<pre><code>string url = \"http://localhost:9200/my_index/my_type/\";\n\nJsonDocFormat json = new JsonDocFormat()\n{\n   name = \"John\"\n};\n\nstring s = JsonConvert.SerializeObject(json);\n\nusing (var client = new WebClient())\n{\n   client.UploadString(url, \"POST\", s);\n}\n</code></pre>\n\n<p>But I can't write code for this GET:</p>\n\n<pre><code>GET my_index/my_type/_search\n{\n   \"query\" : {\n       \"match\" : {\n            \"name\" : \"john\"\n        }\n    }\n}\n</code></pre>\n\n<p>I tried something like this:</p>\n\n<pre><code>string url_req = \"http://localhost:9200/my_index/my_type/_search?pretty\";\n\nstring s1 = \"{\\\"query\\\": {\\\"match\\\": { \\\"name\\\" : \\\"john\\\" }}}\";\n\nstring s_req = url_req + s1;\n\nusing (var client = new WebClient())\n{\n    Console.Write(client.DownloadString(s_req));\n}\n</code></pre>\n\n<p>But this code returned same output as for this GET:</p>\n\n<pre><code>GET /my_index/my_type/_search\n</code></pre>\n\n<p>It did not throw any error, but it absolutely ignored json body at the end of URL. I want to write this without any external package (as NEST or Elasticsearch.NET), just with HTTP.</p>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 2, "creation_date": 1446062784, "post_id": 33400537, "comment_id": 54592517, "body": "you can&#39;t really combine them because they are doing two different operations."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 1, "creation_date": 1446062953, "post_id": 33400537, "comment_id": 54592612, "body": "do you call this messy?! this isnt really messy if you good format your code as i did it for you ;) you can also define regexes behind each other to make it less seem messy"}, {"owner": {"reputation": 13040, "user_id": 2881286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOMtA.png?s=128&g=1", "display_name": "Grundy", "link": "https://stackoverflow.com/users/2881286/grundy"}, "edited": false, "score": 0, "creation_date": 1446063024, "post_id": 33400537, "comment_id": 54592656, "body": "what is <code>fullBook</code> here?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1446063164, "post_id": 33400537, "comment_id": 54592744, "body": "<i>turn any new line into a single space</i> - <code>\\s+</code> matches <i>1 or more any whitespace</i>. If you need to match newlines only, use <code>[\\r\\n]+</code>. How many files do you handle? 1, 10, 100000? If more than a hundred, I suggest that you should avoid declaring the Regex object every time, declare it outside the method (best as <code>private static readonly</code> field)."}, {"owner": {"reputation": 13040, "user_id": 2881286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOMtA.png?s=128&g=1", "display_name": "Grundy", "link": "https://stackoverflow.com/users/2881286/grundy"}, "edited": false, "score": 0, "creation_date": 1446067486, "post_id": 33400537, "comment_id": 54594959, "body": "see about <a href=\"https://msdn.microsoft.com/en-us/library/ht1sxswy(v=vs.110).aspx\" rel=\"nofollow noreferrer\">this</a> override replace method"}], "answers": [{"tags": [], "owner": {"reputation": 13040, "user_id": 2881286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOMtA.png?s=128&g=1", "display_name": "Grundy", "link": "https://stackoverflow.com/users/2881286/grundy"}, "is_accepted": false, "score": 1, "last_activity_date": 1446108543, "creation_date": 1446108543, "answer_id": 33409593, "question_id": 33400537, "link": "https://stackoverflow.com/questions/33400537/how-to-avoid-using-multiple-regex-replace/33409593#33409593", "title": "How to avoid using multiple regex.replace", "body": "<p>You can combine your regex, and use <a href=\"https://msdn.microsoft.com/en-us/library/ht1sxswy(v=vs.110).aspx\" rel=\"nofollow\">Replace method with MatchEvaluator</a> like this</p>\n\n<pre><code>public string readTextFile(string fileName)\n{\n    Regex rgx = new Regex(\"\");\n    string txtFile = File.ReadAllText(fileName).ToUpper();\n\n    txtFile = Regex.Replace(txtFile, @\"(\\s+)|([^A-Z ])\", \n                m=&gt; m.Groups[2].Success ? string.Empty : \" \",\n                RegexOptions.Multiline);\n    return txtFile;\n}\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 1632705, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2d614a5f8330c9efa110f3796fbac05?s=128&d=identicon&r=PG", "display_name": "Justin Tennant", "link": "https://stackoverflow.com/users/1632705/justin-tennant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446108543, "creation_date": 1446062473, "last_edit_date": 1446063071, "question_id": 33400537, "link": "https://stackoverflow.com/questions/33400537/how-to-avoid-using-multiple-regex-replace", "title": "How to avoid using multiple regex.replace", "body": "<p>Goal is to take in a text file, normalize it down to only having all upper case letters, remove all special characters, and turn any new line into a single space.</p>\n\n<p>This is my current messy code to do it, and as far as I can tell it does work.</p>\n\n<pre><code>public string readTextFile(string fileName)\n{\n    Regex rgx = new Regex(\"[^A-Z ]\");\n    string txtFile = File.ReadAllText(fileName).ToUpper();\n\n    txtFile = Regex.Replace(txtFile, @\"\\s+\", \" \", RegexOptions.Multiline);\n    return rgx.Replace(txtFile, \"\");\n}\n</code></pre>\n\n<p>Looking for anyone to help clean this code up, improve efficiency, and possibly combine my regex statements to one.</p>\n"}, {"tags": ["c#", "app-config"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1446062710, "post_id": 33400514, "comment_id": 54592484, "body": "Visual Studio just adds an app.config to a class library project for development purposes.  The app.config of the <i>executing</i> project is always used at run-time."}, {"owner": {"reputation": 365, "user_id": 2287472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6643db4ad7dde19c78936553b6a8da0d?s=128&d=identicon&r=PG", "display_name": "mijail", "link": "https://stackoverflow.com/users/2287472/mijail"}, "edited": false, "score": 0, "creation_date": 1446063036, "post_id": 33400514, "comment_id": 54592665, "body": "If you need your <code>app.Config</code> of testing, try to add a testing project and there add an <code>app.Config</code>file. If not the case, you could have <code>configuration</code> class to read values from <code>ConfigurationManager</code> but the .config file needs always to be in a test project or a console project."}], "owner": {"reputation": 43, "user_id": 1817661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f0347da44f4023e4ebdbd953331d922?s=128&d=identicon&r=PG", "display_name": "user1817661", "link": "https://stackoverflow.com/users/1817661/user1817661"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "closed_date": 1446062666, "answer_count": 0, "score": 0, "last_activity_date": 1446062385, "creation_date": 1446062385, "question_id": 33400514, "link": "https://stackoverflow.com/questions/33400514/add-app-config-to-class-library-project", "closed_reason": "Duplicate", "title": "Add app.config to class library project", "body": "<p>I am developing in C #, I opened a Class Library project to for to get DLL.\nI have a problem when I add app.config manually , when i get the value from a config, the value is null, its mean, the code does not recognize the config file\nI turn config as usual. And get NULL;</p>\n\n<p>string test = ConfigurationManager.AppSettings[\"Test\"];</p>\n\n<p>thank you for your help</p>\n"}, {"tags": ["c#", "wpf", "coded-ui-tests", "testcontext"], "comments": [{"owner": {"reputation": 12629, "user_id": 546871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/p1diY.jpg?s=128&g=1", "display_name": "AdrianHHH", "link": "https://stackoverflow.com/users/546871/adrianhhh"}, "edited": false, "score": 0, "creation_date": 1446108985, "post_id": 33400485, "comment_id": 54609867, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13482796/executing-coded-ui-test-from-a-standalone-application\">Executing coded UI test from a standalone application</a>"}, {"owner": {"reputation": 1, "user_id": 5500022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce61ebf7348df90c2fa211c6496399f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lavleen", "link": "https://stackoverflow.com/users/5500022/lavleen"}, "reply_to_user": {"reputation": 12629, "user_id": 546871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/p1diY.jpg?s=128&g=1", "display_name": "AdrianHHH", "link": "https://stackoverflow.com/users/546871/adrianhhh"}, "edited": false, "score": 0, "creation_date": 1446128259, "post_id": 33400485, "comment_id": 54623145, "body": "The requirement is to execute coded ui test from wpf application directly through code not using test agent or bat file."}, {"owner": {"reputation": 12629, "user_id": 546871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/p1diY.jpg?s=128&g=1", "display_name": "AdrianHHH", "link": "https://stackoverflow.com/users/546871/adrianhhh"}, "edited": false, "score": 0, "creation_date": 1446128495, "post_id": 33400485, "comment_id": 54623315, "body": "Read the suggested duplicate again. There are several approaches offered, only one of them mentions &quot;bat&quot; and &quot;agent&quot;. Please <a href=\"https://stackoverflow.com/posts/33400485/edit\">edit</a> the question to show any additional requirements."}, {"owner": {"reputation": 1, "user_id": 5500022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce61ebf7348df90c2fa211c6496399f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lavleen", "link": "https://stackoverflow.com/users/5500022/lavleen"}, "reply_to_user": {"reputation": 12629, "user_id": 546871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/p1diY.jpg?s=128&g=1", "display_name": "AdrianHHH", "link": "https://stackoverflow.com/users/546871/adrianhhh"}, "edited": false, "score": 0, "creation_date": 1446128811, "post_id": 33400485, "comment_id": 54623501, "body": "I am calling the Playback.Initialize, TestMethod and Playback.Cleanup in the right order. But the TestContext, when accessed, is null."}], "answers": [{"tags": [], "owner": {"reputation": 466, "user_id": 3846633, "user_type": "registered", "profile_image": "https://graph.facebook.com/1121366849/picture?type=large", "display_name": "Michael Rieger", "link": "https://stackoverflow.com/users/3846633/michael-rieger"}, "is_accepted": false, "score": 3, "last_activity_date": 1446065141, "last_edit_date": 1592644375, "creation_date": 1446065141, "answer_id": 33401302, "question_id": 33400485, "link": "https://stackoverflow.com/questions/33400485/run-coded-ui-test-from-wpf-application-without-using-mstest/33401302#33401302", "title": "Run coded ui test from WPF application (without using mstest)", "body": "<h3>This a behavior question of test runners</h3>\n<p><code>TestConext</code> is populated at run time of the &quot;TestHarness/TestRunner&quot;.\nIts is an abstract class that in <code>Visual Studio</code> the process is called <code>QAagent32.exe</code> that supplies an implemented version for this based upon what your test method and class requires of it, e.g. Iterating data rows from a <code>Excel Worksheet</code>, <code>TFS TestCase</code> parameter data table; Coded UI, Unit Test.\nIf you want to use what is already used in <code>Visual Studio</code> you can just call <code>GetType()</code> on it, and research from there for its fully qualified type used. However, <strong>IF</strong> that class type isn't available you'll have to implement a concrete class that fully implements <code>TestContex</code></p>\n<p>Then in code you can do like the following:</p>\n<pre><code>PlayBack.Initialize();\nvar yourTestClass = new YourUniqueClassTests();\nyourTestClass.TestContext = TestConextFactory.GetImplimentation();\nyourTestClass.TestMethodThatsImportant();\n</code></pre>\n<p>Now if your using the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.datasourceattribute.aspx\" rel=\"nofollow noreferrer\">DataSource</a> attribute on your test methods you will probably have to use reflection to pull that info.</p>\n<pre><code>var attribute= yourTestClass.GetType()\n                            .GetMethod(&quot;TestMethodThatsImportant&quot;)\n                            .GetCustomAttributes(typeof(DataSourceAttribute),false)[0] \n                             as DataSourceAttribute;\n</code></pre>\n<p>This should be able to get that data for you. Once you have it you could add logic to decide on what type of <code>TestContext</code> object you implement to set on the test class.</p>\n"}], "owner": {"reputation": 1, "user_id": 5500022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce61ebf7348df90c2fa211c6496399f9?s=128&d=identicon&r=PG&f=1", "display_name": "Lavleen", "link": "https://stackoverflow.com/users/5500022/lavleen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446125121, "creation_date": 1446062285, "last_edit_date": 1446125121, "question_id": 33400485, "link": "https://stackoverflow.com/questions/33400485/run-coded-ui-test-from-wpf-application-without-using-mstest", "title": "Run coded ui test from WPF application (without using mstest)", "body": "<p>I want to run my coded ui test cases from a WPF application. However, when I initialize playback and call the test method, I am getting an error that the TestContext is NULL. Could anyone pls suggest if execution of coded ui test via WPF application is possible? Also, how can I access the TestContext in this approach as the test cases are data driven and I need to access TestContext.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "windows-10"], "answers": [{"tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": false, "score": 0, "last_activity_date": 1446064281, "creation_date": 1446064281, "answer_id": 33401047, "question_id": 33400466, "link": "https://stackoverflow.com/questions/33400466/uwp-app-how-change-login-screen-image/33401047#33401047", "title": "UWP app, how change login screen image?", "body": "<p>There is no API for changing the Login Screen background image.</p>\n\n<p>The image itself exists as an embedded PRI resource that cannot easily be changed (you'll need to hack the PRI file to change the image).</p>\n\n<p>There is a Group Policy setting to hide the image and use a solid colour instead, however there is no Windows Runtime API for modifying Group Policy directly, you must change the registry settings yourself:</p>\n\n<ol>\n<li>Locate the key <code>HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\System</code></li>\n<li>Create or set a DWORD value <code>DisableLogonBackgroundImage</code> to <code>1</code>.</li>\n</ol>\n"}], "owner": {"reputation": 105, "user_id": 5294302, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zmRGy.jpg?s=128&g=1", "display_name": "landonmutch", "link": "https://stackoverflow.com/users/5294302/landonmutch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446064281, "creation_date": 1446062198, "question_id": 33400466, "link": "https://stackoverflow.com/questions/33400466/uwp-app-how-change-login-screen-image", "title": "UWP app, how change login screen image?", "body": "<p>The Windows10 UWP APIs let you change the desktop background image and lockscreen image like so:</p>\n\n<pre><code>// set wallpaper\nUserProfilePersonalizationSettings profileSettings = UserProfilePersonalizationSettings.Current;\n    if (wallpaper)\n    {\n        success = await profileSettings.TrySetWallpaperImageAsync(storageFile);\n    } // or lockscreen\n    else\n    {\n        success = await profileSettings.TrySetLockScreenImageAsync(storageFile);\n    }\n</code></pre>\n\n<p>But how would one change the login screen image?</p>\n"}, {"tags": ["c#", "arrays", "char"], "answers": [{"comments": [{"owner": {"reputation": 109546, "user_id": 38206, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4eea78103ba2306f23b41fd15b46228e?s=128&d=identicon&r=PG", "display_name": "Brian Rasmussen", "link": "https://stackoverflow.com/users/38206/brian-rasmussen"}, "edited": false, "score": 2, "creation_date": 1446062262, "post_id": 33400459, "comment_id": 54592225, "body": "You can index directly into the string, so there&#39;s really no need for the CharArray operation."}], "tags": [], "owner": {"reputation": 183792, "user_id": 1749403, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/g0aFU.png?s=128&g=1", "display_name": "Sajeetharan", "link": "https://stackoverflow.com/users/1749403/sajeetharan"}, "is_accepted": false, "score": 1, "last_activity_date": 1509588723, "last_edit_date": 1509588723, "creation_date": 1446062187, "answer_id": 33400459, "question_id": 33400428, "link": "https://stackoverflow.com/questions/33400428/display-the-first-char-in-a-string-array/33400459#33400459", "title": "Display the first char in a string array?", "body": "<p>just like this</p>\n\n<pre><code>var first = numberList[2-1][0];\nfirst.ToString();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4671915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f24cb7de0ca8698f346cf3a759f7a5?s=128&d=identicon&r=PG&f=1", "display_name": "Eire", "link": "https://stackoverflow.com/users/4671915/eire"}, "edited": false, "score": 0, "creation_date": 1446063028, "post_id": 33400531, "comment_id": 54592658, "body": "Thanks this worked so if I want the  &#39;T&#39; in Three I would just do var firstletter = numberList[3 - 1][0];"}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "reply_to_user": {"reputation": 1, "user_id": 4671915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f24cb7de0ca8698f346cf3a759f7a5?s=128&d=identicon&r=PG&f=1", "display_name": "Eire", "link": "https://stackoverflow.com/users/4671915/eire"}, "edited": false, "score": 0, "creation_date": 1446063329, "post_id": 33400531, "comment_id": 54592834, "body": "@Eire remember to mark this answer as answer. if this answer helped you."}], "tags": [], "owner": {"reputation": 344, "user_id": 1895685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c587f6865bfd0cc0b8452047fe853a4a?s=128&d=identicon&r=PG", "display_name": "Cyrus", "link": "https://stackoverflow.com/users/1895685/cyrus"}, "is_accepted": true, "score": 2, "last_activity_date": 1446062529, "last_edit_date": 1446062529, "creation_date": 1446062448, "answer_id": 33400531, "question_id": 33400428, "link": "https://stackoverflow.com/questions/33400428/display-the-first-char-in-a-string-array/33400531#33400531", "title": "Display the first char in a string array?", "body": "<p>So if the number is 2 and the strings are always in that order, then you can do </p>\n\n<pre><code>var firstletter = numberList[2-1][0];\n</code></pre>\n\n<p>That will get you a Char. If you want that also as string then do </p>\n\n<pre><code>firstletter.ToString();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8150538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157150659836515/picture?type=large", "display_name": "Ethan Dowler", "link": "https://stackoverflow.com/users/8150538/ethan-dowler"}, "is_accepted": false, "score": 0, "last_activity_date": 1497368379, "creation_date": 1497368379, "answer_id": 44525985, "question_id": 33400428, "link": "https://stackoverflow.com/questions/33400428/display-the-first-char-in-a-string-array/44525985#44525985", "title": "Display the first char in a string array?", "body": "<p>I don't know if this is optimized, but I like using substring() because it's very obvious what I want.</p>\n\n<pre><code>    numberlist[i-1].Substring(0, 1);\n</code></pre>\n\n<p>where 'i' is the number you are looking for (subtract 1 because arrays use a 0-based index)</p>\n"}], "owner": {"reputation": 1, "user_id": 4671915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61f24cb7de0ca8698f346cf3a759f7a5?s=128&d=identicon&r=PG&f=1", "display_name": "Eire", "link": "https://stackoverflow.com/users/4671915/eire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 33400531, "answer_count": 3, "score": -5, "last_activity_date": 1509588723, "creation_date": 1446062099, "last_edit_date": 1446062403, "question_id": 33400428, "link": "https://stackoverflow.com/questions/33400428/display-the-first-char-in-a-string-array", "title": "Display the first char in a string array?", "body": "<p>I am making a simple learning game where a number is generated and the user will have to enter the word. The problem is Im trying to get a hint button working basically when the user clicks the hint button a message box will display the first character of the string which is in the array.</p>\n\n<p>Here is a example of what my array looks like.</p>\n\n<pre><code>static string[] numberList = { \"one\",\"two\", \"Three\",\"four\",\"five\",\"Six\",\"Seven\",\"Eight\",\"Nine\",\"Ten\"};\n</code></pre>\n"}, {"tags": ["c#", "visual-studio-2012", "maskedtextbox"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3551218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f0c4fcc89422022b9cbe6b030cb3bf?s=128&d=identicon&r=PG&f=1", "display_name": "Kadir", "link": "https://stackoverflow.com/users/3551218/kadir"}, "edited": false, "score": 0, "creation_date": 1446062121, "post_id": 33400375, "comment_id": 54592142, "body": "Thanks! It was such an easy but a handy way! :)"}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1446062177, "post_id": 33400375, "comment_id": 54592172, "body": "fastest answer i have ever seen"}, {"owner": {"reputation": 20451, "user_id": 1630665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/499605b887254f196fddfa8cff22233b?s=128&d=identicon&r=PG", "display_name": "Dave Zych", "link": "https://stackoverflow.com/users/1630665/dave-zych"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1446062511, "post_id": 33400375, "comment_id": 54592364, "body": "@M.kazemAkhgary must have refreshed as it was posted. shrug."}, {"owner": {"reputation": 20451, "user_id": 1630665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/499605b887254f196fddfa8cff22233b?s=128&d=identicon&r=PG", "display_name": "Dave Zych", "link": "https://stackoverflow.com/users/1630665/dave-zych"}, "reply_to_user": {"reputation": 43, "user_id": 3551218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f0c4fcc89422022b9cbe6b030cb3bf?s=128&d=identicon&r=PG&f=1", "display_name": "Kadir", "link": "https://stackoverflow.com/users/3551218/kadir"}, "edited": false, "score": 0, "creation_date": 1446066928, "post_id": 33400375, "comment_id": 54594705, "body": "@Kadir did this solve your issue? If it did, consider upvoting and accepting the answer."}], "tags": [], "owner": {"reputation": 20451, "user_id": 1630665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/499605b887254f196fddfa8cff22233b?s=128&d=identicon&r=PG", "display_name": "Dave Zych", "link": "https://stackoverflow.com/users/1630665/dave-zych"}, "is_accepted": true, "score": 1, "last_activity_date": 1446061959, "creation_date": 1446061959, "answer_id": 33400375, "question_id": 33400366, "link": "https://stackoverflow.com/questions/33400366/how-do-i-convert-a-masked-textbox-to-an-int-with-the-mask-of-000-000/33400375#33400375", "title": "How do I convert a masked textbox to an int with the mask of 000-000?", "body": "<p>The easiest would be using <a href=\"https://msdn.microsoft.com/en-us/library/fk49wtc1(v=vs.110).aspx\" rel=\"nofollow\"><code>Replace</code></a> to replace the hyphen with nothing:</p>\n\n<pre><code>int AccNo = Convert.ToInt32(AccMaskedTextBox.Text).Replace(\"-\", string.Empty);\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3551218, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f0c4fcc89422022b9cbe6b030cb3bf?s=128&d=identicon&r=PG&f=1", "display_name": "Kadir", "link": "https://stackoverflow.com/users/3551218/kadir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2709, "favorite_count": 0, "accepted_answer_id": 33400375, "answer_count": 1, "score": 0, "last_activity_date": 1446061959, "creation_date": 1446061919, "question_id": 33400366, "link": "https://stackoverflow.com/questions/33400366/how-do-i-convert-a-masked-textbox-to-an-int-with-the-mask-of-000-000", "title": "How do I convert a masked textbox to an int with the mask of 000-000?", "body": "<pre><code>int AccNo = Convert.ToInt32(AccMaskedTextBox.Text);\n</code></pre>\n\n<p>This is how I try to assign the input of my maskedtextbox. The issue I have is that I set a custom mask. It is in the form of 000-000. When I try to assign the input of maskedtextbox to AccNo it breaks with the error :</p>\n\n<pre><code>Input string was not in a correct format.\n</code></pre>\n\n<p>The value of AccNo comes out to be for example 123-456 if string type is used. So I need to get rid of the hyphen so I can assign it to type int.\nHow can I do t without changing my mask?</p>\n"}, {"tags": ["c#", "xml", "datacontractserializer"], "answers": [{"comments": [{"owner": {"reputation": 15799, "user_id": 1195273, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/392b9a49e8a308036d37c9d07e9c7d9b?s=128&d=identicon&r=PG", "display_name": "crush", "link": "https://stackoverflow.com/users/1195273/crush"}, "edited": false, "score": 0, "creation_date": 1446068320, "post_id": 33401835, "comment_id": 54595367, "body": "Thanks for the detailed answer. This is basically what I suspected after research. The first example of my question is the format a third party is asking me to send. That means that <code>type</code> in their context must be part of their own namespace, thus must not be a mechanism for deserializing into a derived type with any generic serializer. I&#39;m afraid I may have to make a custom factory that can take their <code>type</code> attribute and turn it into one of the types that I assume must be deriving a common base. That&#39;s going to be messy and hard to maintain."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "reply_to_user": {"reputation": 15799, "user_id": 1195273, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/392b9a49e8a308036d37c9d07e9c7d9b?s=128&d=identicon&r=PG", "display_name": "crush", "link": "https://stackoverflow.com/users/1195273/crush"}, "edited": false, "score": 0, "creation_date": 1446068648, "post_id": 33401835, "comment_id": 54595545, "body": "@crush - if you only have to serialize and not deserialize, you could use the <code>PrefixSelectingXmlWriterProxy</code> from <a href=\"https://stackoverflow.com/questions/32301809/xdocument-duplicate-namespace-with-different-local-name\">XDocument duplicate namespace with different Local Name</a> to remap the prefix of the <code>type</code> attribute.   Or you could <a href=\"http://stackoverflow.com/questions/806095/how-do-i-serialize-an-object-into-an-xdocument\">Serialize to an XDocument</a> and remap the attribute name with Linq to XML."}, {"owner": {"reputation": 15799, "user_id": 1195273, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/392b9a49e8a308036d37c9d07e9c7d9b?s=128&d=identicon&r=PG", "display_name": "crush", "link": "https://stackoverflow.com/users/1195273/crush"}, "edited": false, "score": 1, "creation_date": 1446069139, "post_id": 33401835, "comment_id": 54595824, "body": "I must serialize and deserialize, unfortunately. I was looking into using a <code>DataContractSurrogate</code>, but I haven&#39;t determined if it will allow me to customize the serialization and deserialization process enough. Applying some transformations to the raw data might be a good compromise to make this work without having to write a custom factory or serializer though. I&#39;ll report back with what I come up with and add it as a supplemental answer. Your answer technically answers my question as it was asked though, so it will remain accepted."}], "tags": [], "owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "is_accepted": true, "score": 2, "last_activity_date": 1446067357, "creation_date": 1446067357, "answer_id": 33401835, "question_id": 33400308, "link": "https://stackoverflow.com/questions/33400308/datacontractserializer-namespace-for-derived-class-does-not-match-specified-in-a/33401835#33401835", "title": "DataContractSerializer namespace for derived class does not match specified in attribute", "body": "<p>You may just be misreading the XML and things are working as desired.  In your XML, the namespace <code>xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"</code> is only being used to qualify the <em>attribute</em> <code>i:type</code>, and nothing else.  All of your actual data is in the namespace you specify.  If the object itself were in a different namespace, you would see something like:</p>\n\n<pre><code>i:type=\"i:MyDerived\"\n</code></pre>\n\n<p>But you're not.</p>\n\n<p><a href=\"http://www.w3.org/TR/xmlschema-1/#Instance_Document_Constructions\" rel=\"nofollow\"><code>http://www.w3.org/2001/XMLSchema-instance</code></a> is a W3C globally standard namespace, knowledge of which is built in to <code>DataContractSerializer</code> (as well as many other XML serializers).  It contains 4 built-in attributes defined as follows in the <a href=\"http://www.w3.org/TR/xmlschema-1/#Instance_Document_Constructions\" rel=\"nofollow\">standards document</a>:</p>\n\n<ul>\n<li><p><code>nil</code>: Signals that an element may be \u00b7valid\u00b7 without content if it has this attribute with the value <code>true</code>.</p></li>\n<li><p><code>schemaLocation</code> and <code>noNamespaceSchemaLocation</code>: used to provide hints as to the physical location of schema documents.</p></li>\n<li><p><code>type</code>:  An element information item in an instance may explicitly assert its type using the attribute <code>type</code>. The value of this attribute is a \u00b7QName\u00b7.</p></li>\n</ul>\n\n<p>The <code>i:type</code> you are seeing is the last of these standard, globally recognized attributes.  It says: \"this element has the following type\".  Reasons for <code>DataContractSerializer</code> to use it to represent .Net type information could include:</p>\n\n<ol>\n<li><p>It is standard.  For instance <a href=\"https://msdn.microsoft.com/en-us/library/ca1ks327.aspx\" rel=\"nofollow\"><code>XmlSerializer</code> recognizes and supports the same attribute</a>.</p></li>\n<li><p>Your element might have its own data attribute named <code>type</code>.  If so, it would reside in its own namespace, <em>not</em> <code>http://www.w3.org/2001/XMLSchema-instance</code>.  The latter is reserved by convention for schema information not content, thereby avoiding name collision.</p></li>\n</ol>\n\n<p>For more, see <a href=\"http://blogs.msdn.com/b/youssefm/archive/2009/04/22/understanding-known-types.aspx\" rel=\"nofollow\">Understanding Known Types</a> and <a href=\"https://msdn.microsoft.com/en-us/library/ms730167%28v=vs.110%29.aspx\" rel=\"nofollow\">Data Contract Known Types</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 15799, "user_id": 1195273, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/392b9a49e8a308036d37c9d07e9c7d9b?s=128&d=identicon&r=PG", "display_name": "crush", "link": "https://stackoverflow.com/users/1195273/crush"}, "edited": false, "score": 0, "creation_date": 1446069848, "post_id": 33402332, "comment_id": 54596201, "body": "I&#39;m thinking that for deserializing, I can use a string replace method to add in the <code>i</code> namespace, and for serializing, I can strip it out - might be the easiest method."}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "reply_to_user": {"reputation": 15799, "user_id": 1195273, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/392b9a49e8a308036d37c9d07e9c7d9b?s=128&d=identicon&r=PG", "display_name": "crush", "link": "https://stackoverflow.com/users/1195273/crush"}, "edited": false, "score": 0, "creation_date": 1446070186, "post_id": 33402332, "comment_id": 54596340, "body": "Thats the only way!! I guess."}], "tags": [], "owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "is_accepted": false, "score": 1, "last_activity_date": 1446069477, "creation_date": 1446069477, "answer_id": 33402332, "question_id": 33400308, "link": "https://stackoverflow.com/questions/33400308/datacontractserializer-namespace-for-derived-class-does-not-match-specified-in-a/33402332#33402332", "title": "DataContractSerializer namespace for derived class does not match specified in attribute", "body": "<p>Unfortunately you'll not be able to achieve it even using custom <code>XmlWriter</code>. <code>DataContractSerializer</code> doesn't work like <code>XMLSerializer</code>. The information into your xml is added to support the fact:</p>\n\n<blockquote>\n  <p>The line <strong>xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"</strong> tells the XML parser that this document should be validated against a schema.</p>\n</blockquote>\n\n<p>Also these namespaces are considered as reserved namespaces. So if you try to override them .Net runtime will throw exception. </p>\n\n<p>@dbc explained it very well and inclusion of the namespaces is part of a pretty standard process and is harmless for your xml.</p>\n\n<p>If you really need to get rid of this default namespace then you just have to <strong>hack</strong> your XML output with string replace method. But this may lead you to problems while desalinizing. </p>\n"}], "owner": {"reputation": 15799, "user_id": 1195273, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/392b9a49e8a308036d37c9d07e9c7d9b?s=128&d=identicon&r=PG", "display_name": "crush", "link": "https://stackoverflow.com/users/1195273/crush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 0, "accepted_answer_id": 33401835, "answer_count": 2, "score": 1, "last_activity_date": 1446069477, "creation_date": 1446061704, "question_id": 33400308, "link": "https://stackoverflow.com/questions/33400308/datacontractserializer-namespace-for-derived-class-does-not-match-specified-in-a", "title": "DataContractSerializer namespace for derived class does not match specified in attribute", "body": "<p>I'm expecting XML output as follows:</p>\n\n<pre><code>&lt;MyBase type=\"MyDerived\"\n        xmlns=\"http://www.mynamespace.com/MySchema\" /&gt;\n</code></pre>\n\n<p>Instead, my actual output is as follows:</p>\n\n<pre><code>&lt;MyBase i:type=\"MyDerived\"\n        xmlns=\"http://www.mynamespace.com/MySchema\"\n        xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\" /&gt;\n</code></pre>\n\n<p>I'm using the following class definitions to attempt to generate my expected output:</p>\n\n<p>MyBase.cs</p>\n\n<pre><code>namespace MyProject\n{\n    [KnownType(typeof(MyDerived))]\n    [DataContract(Namespace = MyBase.Namespace)]\n    public abstract class MyBase \n    {\n        public const string Namespace = \"http://www.mynamespace.com/MySchema\";\n    }\n}\n</code></pre>\n\n<p>MyDerived.cs</p>\n\n<pre><code>namespace MyProject.Events\n{\n    [DataContract(Namespace = MyBase.Namespace)]\n    public sealed class MyDerived : MyBase {}\n}\n</code></pre>\n\n<p>And I'm using the following serialization code:</p>\n\n<pre><code>var knownTypes = new Type[]\n{\n    typeof(MyDerived)\n};\n\nvar xmlDictionary = new XmlDictionary(1);\nvar settings = new DataContractSerializerSettings();\nsettings.KnownTypes = knownTypes;\nsettings.RootNamespace = xmlDictionary.Add(MyBase.Namespace);\n\nserializer = new DataContractSerializer(typeof(MyBase), settings);\n\nvar actual = String.Empty;\n\nusing (var memoryStream = new MemoryStream())\n{\n    serializer.WriteObject(memoryStream, new MyDerived());\n\n    memoryStream.Position = 0;\n\n    using (var streamReader = new StreamReader(memoryStream))\n    {\n        actual = streamReader.ReadToEnd();\n    }\n}\n</code></pre>\n\n<p>I'm not sure why it's using the <code>XMLSchema-instance</code> namespace for my derived object instead of the namespace I've specified to use. I've spent over an hour digging around StackOverflow, Google, and MSDN trying to figure out what I'm doing wrong, but I must be missing it. It seems so close, it must be a simple mistake.</p>\n\n<p>Is this a problem with my class structure, or am I misapplying attributes in some way?</p>\n\n<p>How can I get my expected output?</p>\n"}, {"tags": ["c#", "multithreading", "task-parallel-library"], "answers": [{"comments": [{"owner": {"reputation": 1532, "user_id": 491766, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/489fD.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/491766/ali"}, "edited": false, "score": 0, "creation_date": 1446062315, "post_id": 33400341, "comment_id": 54592253, "body": "It&#39;s because I want to update the UI, is there any other way where I can update the UI other than using TaskScheduler?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 1532, "user_id": 491766, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/489fD.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/491766/ali"}, "edited": false, "score": 0, "creation_date": 1446062365, "post_id": 33400341, "comment_id": 54592285, "body": "@Ali You can&#39;t update the UI from a non-UI thread.  That&#39;s pretty much true <i>by definition</i>."}, {"owner": {"reputation": 1532, "user_id": 491766, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/489fD.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/491766/ali"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446062449, "post_id": 33400341, "comment_id": 54592326, "body": "@Servy actually I want to show the progress on the UI from worker threads."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 1532, "user_id": 491766, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/489fD.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/491766/ali"}, "edited": false, "score": 2, "creation_date": 1446062782, "post_id": 33400341, "comment_id": 54592515, "body": "@Ali Then use the <code>Progress</code> class, which is specifically designed to do <i>exactly</i> that."}, {"owner": {"reputation": 1532, "user_id": 491766, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/489fD.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/491766/ali"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446064142, "post_id": 33400341, "comment_id": 54593234, "body": "@Servy I get your point and now understand the philosophy behind TPL, Thank you for explanation pal."}, {"owner": {"reputation": 1532, "user_id": 491766, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/489fD.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/491766/ali"}, "edited": false, "score": 0, "creation_date": 1446064250, "post_id": 33400341, "comment_id": 54593293, "body": "@ndd I accept your answer based on yours and Servy comments. Thanks for your help."}], "tags": [], "owner": {"reputation": 2829, "user_id": 1718305, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4b4e9d661afce1c743a637d3670b836b?s=128&d=identicon&r=PG", "display_name": "ndd", "link": "https://stackoverflow.com/users/1718305/ndd"}, "is_accepted": true, "score": 2, "last_activity_date": 1446064021, "last_edit_date": 1446064021, "creation_date": 1446061807, "answer_id": 33400341, "question_id": 33400292, "link": "https://stackoverflow.com/questions/33400292/task-and-main-thread-returns-same-id/33400341#33400341", "title": "Task and Main Thread returns same Id?", "body": "<p>You are using <code>var uiScheduler = TaskScheduler.FromCurrentSynchronizationContext();</code> which means that it will use Context for your UI thread.</p>\n\n<p>Use <code>Task.Run()</code> or other <code>TaskScheduler</code> to have separate ThreadIDs</p>\n\n<p>More details can be found on - <a href=\"https://msdn.microsoft.com/en-us/library/dd997394(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/dd997394(v=vs.110).aspx</a></p>\n"}], "owner": {"reputation": 1532, "user_id": 491766, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/489fD.jpg?s=128&g=1", "display_name": "Ali", "link": "https://stackoverflow.com/users/491766/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 33400341, "answer_count": 1, "score": 0, "last_activity_date": 1446064021, "creation_date": 1446061644, "question_id": 33400292, "link": "https://stackoverflow.com/questions/33400292/task-and-main-thread-returns-same-id", "title": "Task and Main Thread returns same Id?", "body": "<p>Following code returns the same id, is it expected because Task should be running in a separate thread?</p>\n\n<pre><code>    private void frmSplash_Load(object sender, EventArgs e)\n    {\n        **MessageBox.Show(Thread.CurrentThread.ManagedThreadId.ToString());**\n\n        var uiScheduler = TaskScheduler.FromCurrentSynchronizationContext();\n        Task.Factory.StartNew(() =&gt;\n        {\n            **MessageBox.Show(Thread.CurrentThread.ManagedThreadId.ToString());**\n\n        }, CancellationToken.None, TaskCreationOptions.None, uiScheduler);\n\n    }\n</code></pre>\n"}, {"tags": ["c#", "wcf", "soap"], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 4768648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f88d1e425646c5a3b1ee4703678109?s=128&d=identicon&r=PG&f=1", "display_name": "Jan W", "link": "https://stackoverflow.com/users/4768648/jan-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1446064293, "last_edit_date": 1495542680, "creation_date": 1446064293, "answer_id": 33401052, "question_id": 33400170, "link": "https://stackoverflow.com/questions/33400170/wcf-service-update-operation-best-practice/33401052#33401052", "title": "WCF service - update operation best practice", "body": "<p>After googling around a bit I've finally found an answer to my question :)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8993507/data-member-default-values-how-to-figure-out-whether-something-was-really-sent\">Data member default values, how to figure out whether something was really sent?</a></p>\n\n<p>This is a very elegant and simple solution. Right now it seems so obvious to me :)</p>\n\n<pre><code>[DataContract]\npublic class CustomerUpdateDTO\n{\n\n    private string firstName;\n    public bool FirstNameSpecified { get; set; }\n\n    ...\n\n    [DataMember(Order = 1)]\n    public string FirstName\n    {\n        get\n        {\n            return firstName;\n        }\n\n        set\n        {\n            FirstNameSpecified = true;\n            firstName = value;\n        }\n    }\n\n    ...\n\n}\n</code></pre>\n\n<p>When the SOAP message is deserialized and the value is present, the ...Specified flag is set to true.</p>\n\n<p>And that's it! Pure awesomeness :)</p>\n"}, {"tags": [], "owner": {"reputation": 872, "user_id": 2444725, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1531314183f9c163e167f0e12885a931?s=128&d=identicon&r=PG", "display_name": "Lightman", "link": "https://stackoverflow.com/users/2444725/lightman"}, "is_accepted": false, "score": 0, "last_activity_date": 1452015487, "creation_date": 1452015487, "answer_id": 34617919, "question_id": 33400170, "link": "https://stackoverflow.com/questions/33400170/wcf-service-update-operation-best-practice/34617919#34617919", "title": "WCF service - update operation best practice", "body": "<blockquote>\n  <p>A message formatted like that would mean, that the client wants to update ONLY the FirstName, leave LastName unchanged, and set the address to null.</p>\n</blockquote>\n\n<p>Either break update operation into several distinct update operations:</p>\n\n<pre><code>class FirstNameUpdate\n    public Customer as integer\n    public FirstName as string\nend class \n\nclass LastNameUpdate\n    public Customer as integer\n    public LastName as string\nend class\n\nclass AddressUpdate\n    public Customer as integer\n    public Address as string\nend class\n</code></pre>\n\n<p>or resend the known value that doesn't change</p>\n\n<pre><code>dim Customer = Service.GetCustomer(10)\n\ndim CustomerUpdate as new CustomerUpdateDTO with {\n    .CustomerID = Customer.ID,\n    .FirstName = \"Joe\",\n    .LastName = Customer.LastName,\n    .Address = Nothing}\n\nService.Update(CustomerUpdate)\n</code></pre>\n\n<p>Notice <code>LastName</code> is taken from <code>Customer</code> DTO and is sent back to the service in <code>CustomerUpdate</code> DTO.</p>\n"}], "owner": {"reputation": 444, "user_id": 4768648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42f88d1e425646c5a3b1ee4703678109?s=128&d=identicon&r=PG&f=1", "display_name": "Jan W", "link": "https://stackoverflow.com/users/4768648/jan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1452015487, "creation_date": 1446061267, "question_id": 33400170, "link": "https://stackoverflow.com/questions/33400170/wcf-service-update-operation-best-practice", "title": "WCF service - update operation best practice", "body": "<p>Let's assume we have a simple DTO that we want to use as an input parameter of a CustomerUpdate method:</p>\n\n<pre><code>[DataContract]\npublic class CustomerUpdateDTO\n{\n    [DataMember(IsRequired = true, Order = 0)]\n    public int CustomerId { get; set; }\n\n    [DataMember(Order = 1)]\n    public string FirstName { get; set; }\n\n    [DataMember(Order = 2)]\n    public string LastName { get; set; }\n\n    [DataMember(Order = 3)]\n    public string Address { get; set; }\n}\n</code></pre>\n\n<p>Only one filed is required - CustomerId - which is rather obvious, as we have to know which customer to update. I would like to achieve the following: </p>\n\n<p>If the incoming SOAP message contains a given value (ex: Joe) i means that the client wants to update this property. If the SOAP message does not contain a value, then the value should not be updated. If the property's value should be deleted (nulled), the client should explicitly declare this by using nil=\"true\" attribute (so explicitly passing a null value).</p>\n\n<p>Example:</p>\n\n<pre><code>&lt;CustomerUpdateDTO&gt;\n  &lt;CustomerId&gt;1&lt;/CustomerId&gt;\n  &lt;FirstName&gt;Joe&lt;/FirstName&gt;\n  &lt;Address xsi:nil=\"true\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" /&gt;\n&lt;/CustomerUpdateDTO&gt;\n</code></pre>\n\n<p>A message formatted like that would mean, that the client wants to update ONLY the FirstName, leave LastName unchanged, and set the address to null.</p>\n\n<p>The problem is, that under default configuration, a message like that is deserialized as:</p>\n\n<pre><code>CustomerId = 1\nFirstName = \"Joe\"\nLastName = null\nAddress = null\n</code></pre>\n\n<p>So both LastName and Address end up as nulls.</p>\n\n<p>Is there a way to tell which \"null\" was caused by omitting the value in the SOAP message, and which \"null\" was explicitly set?</p>\n\n<p>If not, what would be a \"best practice\" for a situation like this?</p>\n"}, {"tags": ["c#", "excel", "pivot-table"], "owner": {"reputation": 11, "user_id": 5499965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40d1594c40253fe48ab4fe07d4c18daf?s=128&d=identicon&r=PG&f=1", "display_name": "SoIDecidedToCode", "link": "https://stackoverflow.com/users/5499965/soidecidedtocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 767, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446061841, "creation_date": 1446061187, "last_edit_date": 1446061841, "question_id": 33400144, "link": "https://stackoverflow.com/questions/33400144/add-multiple-row-and-column-fields-to-a-pivottable", "title": "Add multiple row and column fields to a PivotTable", "body": "<p><strong>What I'm trying to do</strong>: Add multiple row and column fields to the pivot table.</p>\n\n<p><strong>My code</strong>: I have the row and column fields in a list and in an array object. I've tried to assign the fields from both and they both give me an error.</p>\n\n<p><strong>Method 1</strong>: List</p>\n\n<p>//PTRowFields is a list where the row fields are stored</p>\n\n<pre><code>foreach (var item in PTRowFields)\n{\n     Microsoft.Office.Interop.Excel.PivotField Rfield = PT.PivotFields(item);\n     Rfield.Orientation = Microsoft.Office.Interop.Excel.XlPivotFieldOrientation.xlRowField;\n}\n</code></pre>\n\n<p><strong>Method 2</strong>: Array</p>\n\n<p>//PTrowfields is an array where the row fields are stored</p>\n\n<pre><code>int num = PTrowfields.Count();\nfor (int i = 0; i &lt; num; i++)\n{\n     Microsoft.Office.Interop.Excel.PivotField rowfield = PT.PivotFields(PTrowfields[i]);\n     rowfield.Orientation = Microsoft.Office.Interop.Excel.XlPivotFieldOrientation.xlRowField;\n     rowfield.Position = i + 1;\n}\n</code></pre>\n\n<p><strong>Error I receive</strong>: </p>\n\n<p>A first chance exception of type 'System.Runtime.InteropServices.COMException' occured in mscorlip.dl</p>\n\n<p>Additional information: PivotFields method of PivotTable class failed</p>\n\n<p>Found a thread on a similar topic in <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/97821314-933d-4b5c-9548-196d82612a91/pivot-table-excel-c-adding-multiple-rowfield\" rel=\"nofollow\">MSDN forums</a> but that doesn't seem to work for me.</p>\n"}, {"tags": ["c#", "unit-testing", "powershell", "testing"], "comments": [{"owner": {"reputation": 103396, "user_id": 712649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tP0yV.jpg?s=128&g=1", "display_name": "Mathias R. Jessen", "link": "https://stackoverflow.com/users/712649/mathias-r-jessen"}, "edited": false, "score": 1, "creation_date": 1446066904, "post_id": 33400117, "comment_id": 54594698, "body": "That article is quite dated. Check out Pester instead <a href=\"http://www.powershellmagazine.com/2014/03/12/get-started-with-pester-powershell-unit-testing-framework/\" rel=\"nofollow noreferrer\">powershellmagazine.com/2014/03/12/&hellip;</a>"}, {"owner": {"reputation": 51015, "user_id": 356849, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/INqgP.jpg?s=128&g=1", "display_name": "NullVoxPopuli", "link": "https://stackoverflow.com/users/356849/nullvoxpopuli"}, "reply_to_user": {"reputation": 103396, "user_id": 712649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tP0yV.jpg?s=128&g=1", "display_name": "Mathias R. Jessen", "link": "https://stackoverflow.com/users/712649/mathias-r-jessen"}, "edited": false, "score": 0, "creation_date": 1446119272, "post_id": 33400117, "comment_id": 54616555, "body": "So the tests <i>need</i> to be written in that spec syntax/format? Is that compatible with a cmdlet not written in powershell script? (mine is written in c#)"}, {"owner": {"reputation": 51015, "user_id": 356849, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/INqgP.jpg?s=128&g=1", "display_name": "NullVoxPopuli", "link": "https://stackoverflow.com/users/356849/nullvoxpopuli"}, "reply_to_user": {"reputation": 103396, "user_id": 712649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tP0yV.jpg?s=128&g=1", "display_name": "Mathias R. Jessen", "link": "https://stackoverflow.com/users/712649/mathias-r-jessen"}, "edited": false, "score": 0, "creation_date": 1446119332, "post_id": 33400117, "comment_id": 54616586, "body": "Will MS Test pick up this type of test? or (Resharper&#39;s test runner?)"}, {"owner": {"reputation": 103396, "user_id": 712649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tP0yV.jpg?s=128&g=1", "display_name": "Mathias R. Jessen", "link": "https://stackoverflow.com/users/712649/mathias-r-jessen"}, "edited": false, "score": 1, "creation_date": 1446121322, "post_id": 33400117, "comment_id": 54617878, "body": "I&#39;m not sure if MS Test or Resharper works with pester but yes it works with c#. You write your test in that descriptive format and pester takes care of spinning up the runspace etc."}], "owner": {"reputation": 51015, "user_id": 356849, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/INqgP.jpg?s=128&g=1", "display_name": "NullVoxPopuli", "link": "https://stackoverflow.com/users/356849/nullvoxpopuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1005, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1446061556, "creation_date": 1446061117, "last_edit_date": 1446061556, "question_id": 33400117, "link": "https://stackoverflow.com/questions/33400117/how-do-i-test-my-c-based-cmdlet", "title": "How do I test my c#-based cmdlet?", "body": "<p>I've been looking all over the place for a decent example and most results are basics of power shell....</p>\n\n<p>But anyway, I did manage to find this: <a href=\"http://blogs.msdn.com/b/heaths/archive/2008/04/06/functional-testing-of-cmdlets.aspx\" rel=\"nofollow\">http://blogs.msdn.com/b/heaths/archive/2008/04/06/functional-testing-of-cmdlets.aspx</a></p>\n\n<p>Which gave me a start, and allowed me to end up with this test, based of the example in the above link:</p>\n\n<pre><code>using System;\nusing System.Collections.ObjectModel;\nusing Microsoft.VisualStudio.TestTools.UnitTesting;\nusing System.Management.Automation;\nusing System.Management.Automation.Runspaces;\nusing MyProject;\n\nnamespace Commands.Tests\n{\n    [TestClass]\n    public class StartServiceTest\n    {\n        private RunspaceConfiguration config;\n\n        [TestInitialize]\n        public void Initialize()\n        {\n            config = RunspaceConfiguration.Create();\n            config.Cmdlets.Append(new CmdletConfigurationEntry(\n                \"Start-UseService\",\n                typeof(StartUseServiceCommand),\n                \"Microsoft.Windows.Installer.PowerShell.dll-Help.xml\"));\n        }\n\n        [TestMethod]\n        [DeploymentItem(@\"data\\example.txt\")]\n        public void PathTest()\n        {\n            using (Runspace rs = RunspaceFactory.CreateRunspace(config))\n            {\n                rs.Open();\n                using (Pipeline p = rs.CreatePipeline(@\"start-useservice -service ACE\"))\n                {\n                    Collection&lt;PSObject&gt; objs = p.Invoke();\n                    Assert.AreEqual&lt;int&gt;(1, objs.Count);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The article doesn't explain anything, so I'm sure \"data\\example.txt\" doesn't apply to me, but example.txt is used as a parameter in the example's test. But the method attribute just isn't discussed.</p>\n\n<p>Has anyone successfully wrote a test for their cmdlet? \nI'm also looking for a bit of an explanation of what each piece does.\n(I'm not new to MSTest, but I've never used the System.Management.Automation/Runspaces Namespace(s) before)</p>\n\n<p>My cmdlet name is <code>Start-UseService</code></p>\n"}, {"tags": ["c#", "asp.net", "event-handling"], "comments": [{"owner": {"reputation": 16196, "user_id": 752527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e4c2e460e91d6368255ccec79e1763b?s=128&d=identicon&r=PG", "display_name": "Hanlet Esca&#241;o", "link": "https://stackoverflow.com/users/752527/hanlet-esca%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1446061126, "post_id": 33400073, "comment_id": 54591616, "body": "Does the button cause a Post though?"}, {"owner": {"reputation": 1711, "user_id": 1479915, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5Iv8y.jpg?s=128&g=1", "display_name": "Veljko89", "link": "https://stackoverflow.com/users/1479915/veljko89"}, "reply_to_user": {"reputation": 16196, "user_id": 752527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e4c2e460e91d6368255ccec79e1763b?s=128&d=identicon&r=PG", "display_name": "Hanlet Esca&#241;o", "link": "https://stackoverflow.com/users/752527/hanlet-esca%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1446061180, "post_id": 33400073, "comment_id": 54591644, "body": "No, it doesn&#39;t cause a post ether"}, {"owner": {"reputation": 16196, "user_id": 752527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e4c2e460e91d6368255ccec79e1763b?s=128&d=identicon&r=PG", "display_name": "Hanlet Esca&#241;o", "link": "https://stackoverflow.com/users/752527/hanlet-esca%c3%b1o"}, "edited": false, "score": 1, "creation_date": 1446061248, "post_id": 33400073, "comment_id": 54591675, "body": "Therein lies your problem. Try a new button, or some other Control. Check your console for JavaScript errors."}, {"owner": {"reputation": 1711, "user_id": 1479915, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5Iv8y.jpg?s=128&g=1", "display_name": "Veljko89", "link": "https://stackoverflow.com/users/1479915/veljko89"}, "reply_to_user": {"reputation": 16196, "user_id": 752527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e4c2e460e91d6368255ccec79e1763b?s=128&d=identicon&r=PG", "display_name": "Hanlet Esca&#241;o", "link": "https://stackoverflow.com/users/752527/hanlet-esca%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1446061672, "post_id": 33400073, "comment_id": 54591902, "body": "Thanks man ... I found where the problem was, If you want post this as answer to give you points for fast response and help"}, {"owner": {"reputation": 16196, "user_id": 752527, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e4c2e460e91d6368255ccec79e1763b?s=128&d=identicon&r=PG", "display_name": "Hanlet Esca&#241;o", "link": "https://stackoverflow.com/users/752527/hanlet-esca%c3%b1o"}, "edited": false, "score": 3, "creation_date": 1446062617, "post_id": 33400073, "comment_id": 54592424, "body": "It&#39;s alright. If the problem was different you should post your own answer as it may help people in the future :)"}], "owner": {"reputation": 1711, "user_id": 1479915, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/5Iv8y.jpg?s=128&g=1", "display_name": "Veljko89", "link": "https://stackoverflow.com/users/1479915/veljko89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446060978, "creation_date": 1446060978, "question_id": 33400073, "link": "https://stackoverflow.com/questions/33400073/asp-net-onclick-event-not-firing", "title": "ASP.net OnClick event not firing", "body": "<p>I know there are a lot of posts like this one, and I have tried lots of advice and it's not working ... I need help to figure this one out</p>\n\n<p>Just a side not, I am using bootstrap for css and look of my site, this is my code on page</p>\n\n<pre><code>&lt;asp:Button ID=\"Button1\" CssClass=\"btn\" runat=\"server\" Text=\"Log In\" OnClick=\"Button1_Click\" /&gt;\n</code></pre>\n\n<p>And code behind my page, don't focus on code itself, my main problem is that on load breakpoint hits Page_load event, but it will not stop at Button1_click</p>\n\n<pre><code>protected void Button1_Click(object sender, EventArgs e)\n{\n    string Mail;\n    ServiceReference1.Service1Client age = new ServiceReference1.Service1Client();\n    Mail = (inputEmail.Value);\n}\n</code></pre>\n\n<p>I have tried to make event fire by adding this on Page_load event </p>\n\n<pre><code>Button1.Click += new EventHandler(Button1_Click);\nButton1.Command += new CommandEventHandler(Button1_Command);\n</code></pre>\n\n<p>And it's not working, a thing that cross my mind is that I manual write Button1_Click method, as for some reason I can not access event page from properties on my button</p>\n"}, {"tags": ["c#", "wpf", "visual-studio", "datagridview"], "answers": [{"comments": [{"owner": {"reputation": 1954, "user_id": 3669204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xDT8A.jpg?s=128&g=1", "display_name": "AdamMcquiff", "link": "https://stackoverflow.com/users/3669204/adammcquiff"}, "edited": false, "score": 0, "creation_date": 1446574292, "post_id": 33400280, "comment_id": 54795740, "body": "This is how to add a number? I want to add text. Doesn&#39;t HeaderCell affect the top box, where it says &quot;test&quot;?"}, {"owner": {"reputation": 880, "user_id": 1979354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6682211859f2139212f77c3dee07a9cb?s=128&d=identicon&r=PG", "display_name": "Spawn", "link": "https://stackoverflow.com/users/1979354/spawn"}, "reply_to_user": {"reputation": 1954, "user_id": 3669204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xDT8A.jpg?s=128&g=1", "display_name": "AdamMcquiff", "link": "https://stackoverflow.com/users/3669204/adammcquiff"}, "edited": false, "score": 0, "creation_date": 1446615596, "post_id": 33400280, "comment_id": 54811599, "body": "@AdamMcquiff no difference, numbers, or text, whatever you want. Did you try use these samples?"}, {"owner": {"reputation": 1954, "user_id": 3669204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xDT8A.jpg?s=128&g=1", "display_name": "AdamMcquiff", "link": "https://stackoverflow.com/users/3669204/adammcquiff"}, "edited": false, "score": 0, "creation_date": 1446982747, "post_id": 33400280, "comment_id": 54962072, "body": "Yeah it worked! :) is it possible to add rows without adding columns?"}, {"owner": {"reputation": 880, "user_id": 1979354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6682211859f2139212f77c3dee07a9cb?s=128&d=identicon&r=PG", "display_name": "Spawn", "link": "https://stackoverflow.com/users/1979354/spawn"}, "reply_to_user": {"reputation": 1954, "user_id": 3669204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xDT8A.jpg?s=128&g=1", "display_name": "AdamMcquiff", "link": "https://stackoverflow.com/users/3669204/adammcquiff"}, "edited": false, "score": 1, "creation_date": 1446983049, "post_id": 33400280, "comment_id": 54962154, "body": "No as i know, but you can hide RowHeader and create one column, will look same"}, {"owner": {"reputation": 1954, "user_id": 3669204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xDT8A.jpg?s=128&g=1", "display_name": "AdamMcquiff", "link": "https://stackoverflow.com/users/3669204/adammcquiff"}, "edited": false, "score": 0, "creation_date": 1446983122, "post_id": 33400280, "comment_id": 54962183, "body": "Do you know of any other WinForm elements that I could use to achieve a calendar style grid?"}, {"owner": {"reputation": 880, "user_id": 1979354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6682211859f2139212f77c3dee07a9cb?s=128&d=identicon&r=PG", "display_name": "Spawn", "link": "https://stackoverflow.com/users/1979354/spawn"}, "reply_to_user": {"reputation": 1954, "user_id": 3669204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xDT8A.jpg?s=128&g=1", "display_name": "AdamMcquiff", "link": "https://stackoverflow.com/users/3669204/adammcquiff"}, "edited": false, "score": 1, "creation_date": 1446983267, "post_id": 33400280, "comment_id": 54962224, "body": "You can try to play with TableLayoutPanel"}], "tags": [], "owner": {"reputation": 880, "user_id": 1979354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6682211859f2139212f77c3dee07a9cb?s=128&d=identicon&r=PG", "display_name": "Spawn", "link": "https://stackoverflow.com/users/1979354/spawn"}, "is_accepted": true, "score": 1, "last_activity_date": 1446061596, "creation_date": 1446061596, "answer_id": 33400280, "question_id": 33399897, "link": "https://stackoverflow.com/questions/33399897/add-titles-to-the-side-columns-in-datagridview-in-c/33400280#33400280", "title": "Add Titles to the Side Columns in DataGridView in C#", "body": "<p>In WPF it's DataGridRowHeader, an example of row number you can find in <a href=\"https://msdn.microsoft.com/ru-ru/library/system.windows.controls.datagrid.rowheaderstyle(v=vs.110).aspx\" rel=\"nofollow\">MSDN</a>,</p>\n\n<p>And in WinForms it's HeaderCell property of DataGridViewRow. And again in <a href=\"https://msdn.microsoft.com/ru-ru/library/system.windows.forms.datagridviewrow.headercell(v=vs.110).aspx\" rel=\"nofollow\">MSDN</a> we can see row number sample.</p>\n"}], "owner": {"reputation": 1954, "user_id": 3669204, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/xDT8A.jpg?s=128&g=1", "display_name": "AdamMcquiff", "link": "https://stackoverflow.com/users/3669204/adammcquiff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 33400280, "answer_count": 1, "score": 0, "last_activity_date": 1446062084, "creation_date": 1446060452, "question_id": 33399897, "link": "https://stackoverflow.com/questions/33399897/add-titles-to-the-side-columns-in-datagridview-in-c", "title": "Add Titles to the Side Columns in DataGridView in C#", "body": "<p>I am attempting to a create a excel-style grid in a C#/Visual Studio application that I am developing. I am aware that you can dynamically add the titles to the DGV on the top row, but is it possible to add a title on the side columns, where the arrow and asterisk are on the image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ExP4e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ExP4e.png\" alt=\"enter image description here\"></a></p>\n\n<p>If  this cannot be achieved with a DataGridView is there a similar element in Windows Forms or Wpf?</p>\n\n<p>Any answers or engagement would be appreciated!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 887, "user_id": 4691745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c19abe086079cb43dd719867d2f4838?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Vercoelen", "link": "https://stackoverflow.com/users/4691745/jim-vercoelen"}, "edited": false, "score": 0, "creation_date": 1446060982, "post_id": 33399959, "comment_id": 54591539, "body": "item.SelectedItem.Tag is no possibility. Only: ToString, Equals, GetHashCode and GetType :("}, {"owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "reply_to_user": {"reputation": 887, "user_id": 4691745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c19abe086079cb43dd719867d2f4838?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Vercoelen", "link": "https://stackoverflow.com/users/4691745/jim-vercoelen"}, "edited": false, "score": 0, "creation_date": 1446061807, "post_id": 33399959, "comment_id": 54591969, "body": "@JimVercoelen is this WinForms or WPF?"}], "tags": [], "owner": {"reputation": 1738, "user_id": 5477536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14649f2805928d4ab23ab0dafa475553?s=128&d=identicon&r=PG&f=1", "display_name": "GreatAndPowerfulOz", "link": "https://stackoverflow.com/users/5477536/greatandpowerfuloz"}, "is_accepted": false, "score": 0, "last_activity_date": 1446060623, "creation_date": 1446060623, "answer_id": 33399959, "question_id": 33399887, "link": "https://stackoverflow.com/questions/33399887/c-add-tag-to-listbox-item/33399959#33399959", "title": "c# add tag to ListBox item", "body": "<p>here:</p>\n\n<pre><code>public void ShowVolunteerProfile(object sender, EventArgs e)\n{\n    // get volunteer out of tag\n    var item = sender as ListBox;\n    var tagQuestionDetail = (TagQuestionDetail)item.SelectedItem.Tag;\n\n\n    // Show volunteer profile info\n    // code                     \n}\n</code></pre>\n"}], "owner": {"reputation": 887, "user_id": 4691745, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c19abe086079cb43dd719867d2f4838?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Vercoelen", "link": "https://stackoverflow.com/users/4691745/jim-vercoelen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446060880, "creation_date": 1446060417, "last_edit_date": 1446060880, "question_id": 33399887, "link": "https://stackoverflow.com/questions/33399887/c-add-tag-to-listbox-item", "title": "c# add tag to ListBox item", "body": "<p>In my application there is a listbox which is being filled dynamically.</p>\n\n<p>Each item needs to have a click event, so it will open a component belonging by this item.</p>\n\n<p>Thereby I need to add a tag on each item, so I can get this tag within the event method.</p>\n\n<p>Listbox:</p>\n\n<pre><code>var lb_Volunteers_From_Question = new ListBox();\nforeach (var volunteer in volunteers)\n{\n    lb_Volunteers_From_Question.Items.Add(volunteer.Name);\n    {\n        // set tag\n        Tag = volunteer;\n    };\n\n    // set event\n    lb_Volunteers_From_Question.Click += new EventHandler(ShowVolunteerProfile);\n}\n\n// listbox settings\n</code></pre>\n\n<p>Event method</p>\n\n<pre><code>public void ShowVolunteerProfile(object sender, EventArgs e)\n{\n    // get volunteer out of tag\n    var item = sender as ListBox;\n    var tagQuestionDetail = (TagQuestionDetail)item.Tag;\n\n\n    // Show volunteer profile info\n    // code                     \n}\n</code></pre>\n\n<p>But this is not working out for me. Is there a way? </p>\n"}, {"tags": ["c#", "lambda", "expression", "code-reuse", "func"], "answers": [{"comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446077220, "post_id": 33403558, "comment_id": 54598978, "body": "He asked for a way to have the lambda compiled into an expression and a delegate without compiling the delegate at runtime; you&#39;re compiling it at runtime."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446089507, "post_id": 33403558, "comment_id": 54602311, "body": "I never said &#39;without compiling the delegate at runtime&#39;.  I asked if there was a way to prevent/stop it from being &#39;locked down to a particular type at compile-time&#39;.  You&#39;re putting too much emphasis on the &#39;compile-time&#39; and missing the point that I&#39;m trying to not duplicate a complex expression, whilst having the ability to use it as both an Expression and a Delegate for use with Queryable and Enumerable methods.  The &quot;Compile&quot; method undoes the compile-time lock-down as an Expression, so your comment is invalid."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446090032, "post_id": 33403558, "comment_id": 54602462, "body": "Given that the question specifically mentions the ability to compile expressions, and you went on for quite some time in comments about how that wasn&#39;t solving your problem, apparently it didn&#39;t solve your problem, so posting it as an answer is pretty nonsensical.  Apparently you never had a question in the first place, if the answer is functionally identical to the code in the question."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446135125, "post_id": 33403558, "comment_id": 54628157, "body": "No, it&#39;s not functionally equivalent.  The workaround in the question was susceptible to a race condition; two threads could hit the method at the same time, both see the variable as null, and both call Compile, resulting in redundant compilation.  There&#39;s also an &quot;if&quot; statement that runs every time in the question, but not so in my answer.  Form is also important.  The original workaround clutters the class with static variables that need to be maintained with unique and well-identified names.  In my solution, they&#39;re encapsulated locally in classes, so &quot;_expression&quot; and &quot;_delegate&quot; suffice."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446135147, "post_id": 33403558, "comment_id": 54628169, "body": "And I&#39;m still interested in hearing if there are any other workarounds."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446135554, "post_id": 33403558, "comment_id": 54628446, "body": "So you&#39;re saying that the entirety of your question is asking how to remove that one race condition, and that everything about compiling expressions as lambdas or delegates is unrelated to what you&#39;re actually asking?  If so, that not clear <i>at all</i> from your question."}, {"owner": {"reputation": 15516, "user_id": 310276, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/WLBKa.jpg?s=128&g=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/310276/diego"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446150100, "post_id": 33403558, "comment_id": 54636991, "body": "I agree with @Servy: Triynko, you should put in order what you need of the solution and what are their priorities. Also, if you are still interested in other workarounds, I believe my answer is a good way to go (at least for some of the things you wanted to avoid)."}, {"owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "edited": false, "score": 0, "creation_date": 1446150625, "post_id": 33403558, "comment_id": 54637241, "body": "This requires one class per lambda. That is not very great. See <a href=\"http://stackoverflow.com/a/33415686/57611\">Diego&#39;s answer</a>."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446423693, "post_id": 33403558, "comment_id": 54723317, "body": "@Servy No, the question is simple.  Lambas compile to either expression or delegate, which results in extra work being required to use it in both the Enumerble and Queryable APIs (e.g. duplication of the lamba itself, runtime compilation of the Expression, etc.), which would not be necessary if you were only using one or the other.  The problem (i.e. the question) is to find a solution that minimizes that otherwise unnecessary effort, without introducing new problems (e.g. race condition, additional computations like null-checks with every call, maintaining new variable names, etc.)."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "reply_to_user": {"reputation": 15516, "user_id": 310276, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/WLBKa.jpg?s=128&g=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/310276/diego"}, "edited": false, "score": 0, "creation_date": 1446424249, "post_id": 33403558, "comment_id": 54723464, "body": "@Diego  I like your solution of using a single class that provides members to access both the Expression and Func delegate along with implicit cast operators so you don&#39;t even have to use the members.  It&#39;s also nice that it requires only one class per lambda method signature, rather than one class per unique lambda like mine. It doesn&#39;t introduce race conditions, it doesn&#39;t require any special variable names, except for the static variable you assign the instance to, which is great. It doesn&#39;t require maintaining duplicate copies of the lambda or introduce unnecessary extra overhead per call."}], "tags": [], "owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "is_accepted": false, "score": -2, "last_activity_date": 1446076054, "creation_date": 1446076054, "answer_id": 33403558, "question_id": 33399863, "link": "https://stackoverflow.com/questions/33399863/is-there-a-way-to-capture-a-lambda-expression-so-that-its-not-compile-time-forc/33403558#33403558", "title": "Is there a way to capture a lambda expression so that it&#39;s not compile-time forced to take on an identity as either an Expression or Delegate type?", "body": "<p>Here is one workaround.  It generates an explicit class for the expression (as the compiler would do under the hood anyway with lambda expressions that require a function closure) instead of just a method, and it compiles the expression in a static constructor so it doesn't have any race conditions that could result in multiple compilations.  This workaround still incurs an additional runtime delay as a result of the Compile call which could otherwise be offloaded to build-time, but at least it's guaranteed to run only once using this pattern.</p>\n\n<p>Given a type to be used in the expression:</p>\n\n<pre><code>public class SomeClass\n{\n    public int A { get; set; }\n    public int? B { get; set; }\n}\n</code></pre>\n\n<p>Build an inner class instead of a method, naming it whatever you would have named the method:</p>\n\n<pre><code>static class SomeClassMeetsConditionName\n{\n    private static Expression&lt;Func&lt;SomeClass,bool&gt;&gt; _expression;\n    private static Func&lt;SomeClass,bool&gt; _delegate;\n    static SomeClassMeetsConditionName()\n    {\n        _expression = x =&gt; (x.A &gt; 3 &amp;&amp; !x.B.HasValue) || (x.B.HasValue &amp;&amp; x.B.Value &gt; 5);\n        _delegate = _expression.Compile();\n    }\n    public static Expression&lt;Func&lt;SomeClass, bool&gt;&gt; Expression { get { return _expression; } }\n    public static Func&lt;SomeClass, bool&gt; Delegate { get { return _delegate; } }\n}\n</code></pre>\n\n<p>Then instead of using <code>Where( SomeClassMeetsConditionName() )</code>, you simply pass <code>SomeClassMeetsConditionName</code> followed by either <code>.Delegate</code> or <code>.Expression</code>, depending on the context:</p>\n\n<pre><code>public void Test()\n{\n    IEnumerable&lt;SomeClass&gt; list = GetList();\n    IQueryable&lt;SomeClass&gt; repo = GetQuery();\n\n    var r0 = list.Where( SomeClassMeetsConditionName.Delegate );\n    var r1 = repo.Where( SomeClassMeetsConditionName.Expression );\n}\n</code></pre>\n\n<p>As an inner class, it could be given an access level just like a method and accessed just like a method, and even collapsed all at once like a method, so if you can stand to look at the class instead of a method, this is a functional workaround.  It could even be made into a code template.</p>\n"}, {"comments": [{"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446424733, "post_id": 33415686, "comment_id": 54723592, "body": "I like this solution of using a single class that provides members to access both the Expression and Func delegate along with implicit cast operators so you don&#39;t even have to use those members. It&#39;s also nice that it requires only one class per lambda method signature, rather than one class per unique lambda like mine did. It doesn&#39;t introduce new problems like race conditions, and it doesn&#39;t require maintaining superfluous variable names -- just the static variable you assign the instance to, which is great. It doesn&#39;t introduce duplicate copies of the lambda or any extra overhead per call."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446425157, "post_id": 33415686, "comment_id": 54723704, "body": "*No extra overhead per call (potentially) as long as you&#39;re accessing the exp and func variables directly, as opposed to calling the implicit operators which perform the null-check; not that it would be significant nor that it&#39;s an unnecessary check for such a static operator."}, {"owner": {"reputation": 15516, "user_id": 310276, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/WLBKa.jpg?s=128&g=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/310276/diego"}, "reply_to_user": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446464347, "post_id": 33415686, "comment_id": 54738435, "body": "I&#39;m glad you liked my solution. However @ErikE&#39;s though very similar is better. I didn&#39;t know that I was missing the <code>delegator</code> constraint. That was my first try, but I couldn&#39;t do it. So I&#39;m happy to have lerned something new :)"}], "tags": [], "owner": {"reputation": 15516, "user_id": 310276, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/WLBKa.jpg?s=128&g=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/310276/diego"}, "is_accepted": false, "score": 1, "last_activity_date": 1446125601, "creation_date": 1446125601, "answer_id": 33415686, "question_id": 33399863, "link": "https://stackoverflow.com/questions/33399863/is-there-a-way-to-capture-a-lambda-expression-so-that-its-not-compile-time-forc/33415686#33415686", "title": "Is there a way to capture a lambda expression so that it&#39;s not compile-time forced to take on an identity as either an Expression or Delegate type?", "body": "<p>You could create a wrapper class. Something like this:</p>\n\n<pre><code>public class FuncExtensionWrap&lt;T&gt;\n{\n    private readonly Expression&lt;Func&lt;T, bool&gt;&gt; exp;\n    private readonly Func&lt;T, bool&gt; func;\n\n    public FuncExtensionWrap(Expression&lt;Func&lt;T, bool&gt;&gt; exp)\n    {\n        this.exp = exp;\n        this.func = exp.Compile();\n    }\n\n    public Expression&lt;Func&lt;T, bool&gt;&gt; AsExp()\n    {\n        return this;\n    }\n\n    public Func&lt;T, bool&gt; AsFunc()\n    {\n        return this;\n    }\n\n    public static implicit operator Expression&lt;Func&lt;T, bool&gt;&gt;(FuncExtensionWrap&lt;T&gt; w)\n    {\n        if (w == null)\n            return null;\n        return w.exp;\n    }\n\n    public static implicit operator Func&lt;T, bool&gt;(FuncExtensionWrap&lt;T&gt; w)\n    {\n        if (w == null)\n            return null;\n        return w.func;\n    }\n}\n</code></pre>\n\n<p>And then it would be used like this:</p>\n\n<pre><code>static readonly FuncExtensionWrap&lt;int&gt; expWrap = new FuncExtensionWrap&lt;int&gt;(i =&gt; i == 2);\n\n// As expression\nExpression&lt;Func&lt;int, bool&gt;&gt; exp = expWrap;\nConsole.WriteLine(exp.Compile()(2));\n\n// As expression (another way)\nConsole.WriteLine(expWrap.AsExp().Compile()(2));\n\n// As function\nFunc&lt;int, bool&gt; func = expWrap;\nConsole.WriteLine(func(1));\n\n// As function(another way)\nConsole.WriteLine(expWrap.AsFunc()(2));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446426264, "post_id": 33425886, "comment_id": 54723958, "body": "Your &quot;VersatileLambda&quot; is exactly what I had originally envisioned as a solution before realizing C# doesn&#39;t support a &quot;delegate&quot; as a type constraint.  I ran into Fody&#39;s workaround and I read the same thing you stated -- that it&#39;s a compiler limitation, not a .NET limitation.  I would choose Diego&#39;s solution over this, only because this introduces a dependency on Fody, but if delegate was natively supported as a type constraint, then this solution is best because it requires only one class, which will support any lambda.  I wish Delegate and &quot;Numeric&quot; type constraints were supported."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446427745, "post_id": 33425886, "comment_id": 54724276, "body": "On second though, I am going to mark this as the answer, because it will work even without Fody.  The <code>Expression</code> class itself requires a delegate type, yet settles for naming the generic type parameter <code>TDelegate</code>; so, if it&#39;s good enough for the framework, it&#39;s good enough for me.  Worst case, if a non-delegate type is used, it will error out in <code>Expression&lt;T&gt;</code>&#39;s final cast in its <code>TDelegate Compile</code> call: <code>(TDelegate)((object)LambdaCompiler.Compile(this, null));</code>"}, {"owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "reply_to_user": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446430470, "post_id": 33425886, "comment_id": 54724931, "body": "For what it&#39;s worth, Diego&#39;s and my code are very similar, and he did post first, but it was almost exactly what I was thinking of. I also went to some substantial trouble to validate that the implicit conversion works just fine in a linq to entities statement. I do think an AsFunc or ToFunc method is worthwhile. (And Expression.) I also think the chaining I presented is added value. And I like the name I selected better. :)"}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446431941, "post_id": 33425886, "comment_id": 54725296, "body": "VersatileLamda is indeed more descriptive.  Personally, I named mine <code>AutoLambda</code>, mirroring the C++ <code>auto</code> return type keyword that achieves the same purpose. These answers are all similar, but this one is also significantly different from the others in that it explicitly points out the need for a Delegate type constraint and provides a compile-time solution via Fody. It also gives examples of how the class can be used alone or extended to support a specific type of delegate such as the predicate <code>Func&lt;T,bool&gt;</code>."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446431943, "post_id": 33425886, "comment_id": 54725299, "body": "The Chain method is added-value in this context, because this problem is specifically concerned with complex lambdas (i.e. lambdas that we&#39;re actually worried about having to repeat or maintain in two different forms), so the Chain method would indeed allow us to break Expressions down in ways that would not be possible with lambas alone.  I also agree that having explicit ToFunc/ToExpression methods would be useful."}, {"owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "reply_to_user": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446488420, "post_id": 33425886, "comment_id": 54753388, "body": "@Triynko I updated my answer. While the updated class is a little more complicated, I believe it is a functional improvement because it avoids compiling the <code>Func</code> until it is used. It also does the caching in a way that I think is better--rather than checking <code>null</code> each time, it rewrites the method that&#39;s being used. After the first fetch of the <code>Func</code>, no further checking is done. I&#39;ve also followed the double-checking locking pattern, which should be safe (it wasn&#39;t in early versions of C#, but I believe it is now)."}, {"owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "reply_to_user": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1446500263, "post_id": 33425886, "comment_id": 54759507, "body": "@Triynko Update: the proper way to do this is with a <code>Lazy</code>, as now shown."}, {"owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1447086473, "post_id": 33425886, "comment_id": 55001526, "body": "I actually prefer the original implementation.  The <code>?.</code> (null conditional member access or null-propagation operator) is new in Visual Studio 2015 (C# 6.0), and it performs the same null check every time, so it&#39;s not really an optmization.  The Lazy class introduces a lot of extra logic and multiple internal method calls with volatile reads, locks, and checks of LazyThreadSafetyMode.  I&#39;d rather have the initialization take place up-front, rather than causing a stutter on first-runs."}, {"owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "reply_to_user": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "edited": false, "score": 0, "creation_date": 1447087142, "post_id": 33425886, "comment_id": 55001924, "body": "The null conditional member access is just there because I was playing around with VS 2015. It&#39;s identical to the null check, as you say, and wasn&#39;t intended to be an optimization of speed, just a clarity improver. I understand about your preference to not lazily .Compile the Expression, but see that as an implementation-specific issue, not a timeless, global one. I&#39;ll present both versions later."}], "tags": [], "owner": {"reputation": 43256, "user_id": 57611, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/fbIWO.jpg?s=128&g=1", "display_name": "ErikE", "link": "https://stackoverflow.com/users/57611/erike"}, "is_accepted": true, "score": 1, "last_activity_date": 1446500220, "last_edit_date": 1446500220, "creation_date": 1446158409, "answer_id": 33425886, "question_id": 33399863, "link": "https://stackoverflow.com/questions/33399863/is-there-a-way-to-capture-a-lambda-expression-so-that-its-not-compile-time-forc/33425886#33425886", "title": "Is there a way to capture a lambda expression so that it&#39;s not compile-time forced to take on an identity as either an Expression or Delegate type?", "body": "<p>Unfortunately, I can see no way to truly get, at compile time, a <code>Func</code> and an <code>Expression</code> from the same lambda. However, you could at least encapsulate away the difference, and you can also defer the compilation of the <code>Func</code> until the first time it's used. Here's a solution that makes the best of things and may meet your needs, even though it doesn't quite go all the way to what you really wanted (compile-time evaluation of both the <code>Expression</code> and the <code>Func</code>).</p>\n\n<p>Please note that this works fine <em>without</em> using the <code>[DelegateConstraint]</code> attribute (from <a href=\"https://github.com/Fody/ExtraConstraints\" rel=\"nofollow\">Fody.ExtraConstraints</a>), but with it, you will get compile-time checking of the constructor parameter. The attributes make the classes act like they have a constraint <code>where T : Delegate</code>, which is not currently supported in C#, even though it <em>is</em> supported in the ILE (not sure if I'm saying that right, but you get the idea).</p>\n\n<pre><code>public class VersatileLambda&lt;[DelegateConstraint] T&gt; where T : class {\n    private readonly Expression&lt;T&gt; _expression;\n    private readonly Lazy&lt;T&gt; _funcLazy;\n\n    public VersatileLambda(Expression&lt;T&gt; expression) {\n        if (expression == null) {\n            throw new ArgumentNullException(nameof(expression));\n        }\n        _expression = expression;\n        _funcLazy = new Lazy&lt;T&gt;(expression.Compile);\n    }\n\n    public static implicit operator Expression&lt;T&gt;(VersatileLambda&lt;T&gt; lambda) {\n        return lambda?._expression;\n    }\n\n    public static implicit operator T(VersatileLambda&lt;T&gt; lambda) {\n        return lambda?._funcLazy.Value;\n    }\n\n    public Expression&lt;T&gt; AsExpression() { return this; }\n    public T AsLambda() { return this; }\n}\n\npublic class WhereConstraint&lt;[DelegateConstraint] T&gt; : VersatileLambda&lt;Func&lt;T, bool&gt;&gt; {\n    public WhereConstraint(Expression&lt;Func&lt;T, bool&gt;&gt; lambda)\n        : base(lambda) { }\n}\n</code></pre>\n\n<p>The beauty of the implicit conversion is that in contexts where a specific <code>Expression&lt;Func&lt;&gt;&gt;</code> or <code>Func&lt;&gt;</code> is expected, you don't have to do anything at all, just, <em>use</em> it.</p>\n\n<p>Now, given an object:</p>\n\n<pre><code>public partial class MyObject {\n    public int Value { get; set; }\n}\n</code></pre>\n\n<p>That is represented in the database like so:</p>\n\n<pre><code>CREATE TABLE dbo.MyObjects (\n    Value int NOT NULL CONSTRAINT PK_MyObjects PRIMARY KEY CLUSTERED\n);\n</code></pre>\n\n<p>Then it works like this:</p>\n\n<pre><code>var greaterThan5 = new WhereConstraint&lt;MyObject&gt;(o =&gt; o.Value &gt; 5);\n\n// Linq to Objects\nList&lt;MyObject&gt; list = GetObjectsList();\nvar filteredList = list.Where(greaterThan5).ToList(); // no special handling\n\n// Linq to Entities\nIQueryable&lt;MyObject&gt; myObjects = new MyObjectsContext().MyObjects;\nvar filteredList2 = myObjects.Where(greaterThan5).ToList(); // no special handling\n</code></pre>\n\n<p>If implicit conversion isn't suitable, you can cast explicitly to the target type:</p>\n\n<pre><code>var expression = (Expression&lt;Func&lt;MyObject, bool&gt;&gt;) greaterThan5;\n</code></pre>\n\n<p>Note that you don't <em>really</em> need the <code>WhereConstraint</code> class, or you could get rid of <code>VersatileLambda</code> by moving its contents to <code>WhereConstraint</code>, but I liked making the two separate (as now you can use <code>VersatileLambda</code> for something that returns other than a <code>bool</code>). (And this difference is largely what sets apart my answer from Diego's.) Using <code>VersatileLambda</code> as it is now looks like this (you can see why I wrapped it):</p>\n\n<pre><code>var vl = new VersatileLambda&lt;Func&lt;MyObject, bool&gt;&gt;(o =&gt; o.Value &gt; 5);\n</code></pre>\n\n<p>I have confirmed that this works perfectly for <code>IEnumerable</code> as well as <code>IQueryable</code>, properly projecting the lambda expression into the SQL, as proven by running SQL Profiler.</p>\n\n<p>Also, you can do some really cool things with expressions that can't be done with lambdas. Check this out:</p>\n\n<pre><code>public static class ExpressionHelper {\n    public static Expression&lt;Func&lt;TFrom, TTo&gt;&gt; Chain&lt;TFrom, TMiddle, TTo&gt;(\n        this Expression&lt;Func&lt;TFrom, TMiddle&gt;&gt; first,\n        Expression&lt;Func&lt;TMiddle, TTo&gt;&gt; second\n    ) {\n        return Expression.Lambda&lt;Func&lt;TFrom, TTo&gt;&gt;(\n           new SwapVisitor(second.Parameters[0], first.Body).Visit(second.Body),\n           first.Parameters\n        );\n    }\n\n    // this method thanks to Marc Gravell   \n    private class SwapVisitor : ExpressionVisitor {\n        private readonly Expression _from;\n        private readonly Expression _to;\n\n        public SwapVisitor(Expression from, Expression to) {\n            _from = from;\n            _to = to;\n        }\n\n        public override Expression Visit(Expression node) {\n            return node == _from ? _to : base.Visit(node);\n        }\n    }\n}\n\nvar valueSelector = new Expression&lt;Func&lt;MyTable, int&gt;&gt;(o =&gt; o.Value);\nvar intSelector = new Expression&lt;Func&lt;int, bool&gt;&gt;(x =&gt; x &gt; 5);\nvar selector = valueSelector.Chain&lt;MyTable, int, bool&gt;(intSelector);\n</code></pre>\n\n<p>You can create an overload of <code>Chain</code> that takes a <code>VersatileLambda</code> as the first parameter, and returns a <code>VersatileLambda</code>. Now you're really sizzling along.</p>\n"}], "owner": {"reputation": 17282, "user_id": 88409, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/hi9Fb.jpg?s=128&g=1", "display_name": "Triynko", "link": "https://stackoverflow.com/users/88409/triynko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 33425886, "answer_count": 3, "score": 4, "last_activity_date": 1446500220, "creation_date": 1446060349, "last_edit_date": 1446448379, "question_id": 33399863, "link": "https://stackoverflow.com/questions/33399863/is-there-a-way-to-capture-a-lambda-expression-so-that-its-not-compile-time-forc", "title": "Is there a way to capture a lambda expression so that it&#39;s not compile-time forced to take on an identity as either an Expression or Delegate type?", "body": "<p>Suppose I have a complex lambda expression as follows:</p>\n\n<pre><code>x =&gt; x.A.HasValue || (x.B.HasValue &amp;&amp; x.C == q) || (!x.C.HasValue &amp;&amp; !x.A.HasValue) || //...expression goes on\n</code></pre>\n\n<p>I want to use this as an <code>Expression&lt;Func&lt;T,bool&gt;</code> in (e.g. Linq-To-Entities) <a href=\"https://msdn.microsoft.com/en-us/library/system.linq.queryable.where%28v=vs.100%29.aspx\" rel=\"nofollow\">Queryable.Where</a> method.  I also want to use it in the <a href=\"https://msdn.microsoft.com/en-us/library/system.linq.enumerable.where%28v=vs.100%29.aspx\" rel=\"nofollow\">Enumerable.Where</a> method, but the Where method only accepts a <code>Func&lt;T,bool&gt;</code>, not an <code>Expression&lt;Func&lt;T,bool&gt;</code>.</p>\n\n<p>The lambda syntax itself can be used to generate <em>either</em> an <code>Expression&lt;Func&lt;T,bool&gt;&gt;</code> or a <code>Func&lt;T,bool&gt;</code> (or any delegate type for that matter), but in this context it cannot generate more than one at once.</p>\n\n<p>For example, I can write:</p>\n\n<pre><code>public Expression&lt;Func&lt;Pair,bool&gt;&gt; PairMatchesExpression()\n{\n    return x =&gt; x.A == x.B;\n}\n</code></pre>\n\n<p>as easily as I can write:</p>\n\n<pre><code>public Func&lt;Pair,bool&gt; PairMatchesDelegate()\n{\n    return x =&gt; x.A == x.B;\n}\n</code></pre>\n\n<p>The problem is that <strong>I cannot</strong> use the same exact lambda expression (i.e. x => x.A == x.B) in both ways, without physically duplicating it into two separate methods with two different return types, in spite of the compiler's ability to compile it into either one.</p>\n\n<p>In other words, if I'd like to use the lambda expression in the <code>Queryable</code> methods, then I have to use the <code>Expression</code> method signature.  Once I do that however, <strong>I cannot</strong> use it as a <code>Func</code> as easily as I could have had I just declared the method return type as <code>Func</code>.  Instead, I now have to call <code>Compile</code> on the <code>Expression</code> and then worry about caching the results manually like so:</p>\n\n<pre><code>static Func&lt;Pair,bool&gt; _cachedFunc;\npublic Func&lt;Pair,bool&gt; PairMatchesFunc()\n{\n    if (_cachedFunc == null)\n        _cachedFunc = PairMatchesExpression().Compile();\n    return _cachedFunc;\n}\n</code></pre>\n\n<p>Is there a solution to this problem so that I can use the lambda expression in a more general way without it being locked down to a particular type at compile-time?</p>\n"}, {"tags": ["c#", "http"], "comments": [{"owner": {"reputation": 697, "user_id": 202891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed15e526de056b3fe7d84760f131c8f6?s=128&d=identicon&r=PG", "display_name": "maniak1982", "link": "https://stackoverflow.com/users/202891/maniak1982"}, "edited": false, "score": 1, "creation_date": 1446060309, "post_id": 33399777, "comment_id": 54591135, "body": "<code>public void NewMethod(){}</code> right above <code>public void Request()</code> should do the trick."}, {"owner": {"reputation": 22942, "user_id": 18821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ec2b04ac1bad14fea8244a78ef0f2133?s=128&d=identicon&r=PG", "display_name": "Nathan Koop", "link": "https://stackoverflow.com/users/18821/nathan-koop"}, "edited": false, "score": 1, "creation_date": 1446060410, "post_id": 33399777, "comment_id": 54591178, "body": "I&#39;m not clear on why you need a new method. You can use the <code>Stopwatch</code> class to time how long it takes to run your method. If you need to access it from a different method, then just save it in a variable and return it from a second method. <a href=\"https://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 47, "user_id": 5463650, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/548ba0e7bfb5cd90c7aaabf1b822752c?s=128&d=identicon&r=PG&f=1", "display_name": "NewDev", "link": "https://stackoverflow.com/users/5463650/newdev"}, "edited": false, "score": 0, "creation_date": 1446060811, "post_id": 33399777, "comment_id": 54591445, "body": "Yes I&#39;ll try stopwatch, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5463650, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/548ba0e7bfb5cd90c7aaabf1b822752c?s=128&d=identicon&r=PG&f=1", "display_name": "NewDev", "link": "https://stackoverflow.com/users/5463650/newdev"}, "edited": false, "score": 0, "creation_date": 1446066159, "post_id": 33399904, "comment_id": 54594356, "body": "I finally got my code to run, thanks for the help. But I don&#39;t understand why some websites are bringing back 2 request results and some are giving me 3 request results?"}], "tags": [], "owner": {"reputation": 480, "user_id": 5179742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4CC8e.jpg?s=128&g=1", "display_name": "g2000", "link": "https://stackoverflow.com/users/5179742/g2000"}, "is_accepted": true, "score": 4, "last_activity_date": 1446060478, "creation_date": 1446060478, "answer_id": 33399904, "question_id": 33399777, "link": "https://stackoverflow.com/questions/33399777/how-do-i-add-another-method/33399904#33399904", "title": "How do I add another method?", "body": "<p>How about stopwatch? </p>\n\n<pre><code>using System.Diagnostics;\n\nStopwatch stopwatch = new Stopwatch();\nusing (var writer = new StreamWriter(filename, true))\n{\n    foreach (string website in lstWebSites)\n    {\n        for (var i = 0; i &lt; 4; i++)\n        {\n\n            MyWebRequest request = new MyWebRequest();\n            stopwatch.Start();\n            request.Request();\n            stopwatch.Stop();\n            Console.WriteLine(\"Time elapse: {0}\", stopwatch.Elapse);\n            stopwatch.Restart();\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5463650, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/548ba0e7bfb5cd90c7aaabf1b822752c?s=128&d=identicon&r=PG&f=1", "display_name": "NewDev", "link": "https://stackoverflow.com/users/5463650/newdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 33399904, "answer_count": 1, "score": -4, "last_activity_date": 1446060478, "creation_date": 1446060044, "question_id": 33399777, "link": "https://stackoverflow.com/questions/33399777/how-do-i-add-another-method", "title": "How do I add another method?", "body": "<p>I have two classes, I want to add a method to MyWebRequest class. In this method I have to time the HTTP request I am making.\nPlease help me with this. \nProgram.cs </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.IO;\n\nnamespace HTTP\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            var lstWebSites = new List&lt;string&gt;\n            {\n                \"www.amazon.com\",\n                \"www.ebay.com\",\n                \"www.att.com\",\n                \"www.verizon.com\",\n                \"www.sprint.com\",\n                \"www.centurylink.com\",\n                \"www.yahoo.com\"\n            };\n            string filename = \"RequestLog.csv\";\n            {\n                using (var writer = new StreamWriter(filename, true))\n                {\n                    foreach (string website in lstWebSites)\n                    {\n                        for (var i = 0; i &lt; 4; i++)\n                        {\n                            MyWebRequest request = new MyWebRequest();\n                            request.Request();\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>This is MyWebRequest.cs and this is where I want to do all of my http requests and time how long it took to retrieve the response.</p>\n\n<pre><code>using System;\nusing System.IO;\nusing System.Net;\n\nnamespace HTTP\n{\n    class MyWebRequest\n    {\n        public void Request()\n        {\n            HttpWebResponse response = null;\n\n            try\n            {\n                HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(\"lstWebSites\");\n                request.Method = \"GET\";\n\n                response = (HttpWebResponse)request.GetResponse();\n\n                using (StreamReader sr = new StreamReader(response.GetResponseStream()));\n            }\n            catch (WebException e)\n            {\n                if (e.Status == WebExceptionStatus.ProtocolError)\n                {\n                    response = (HttpWebResponse)e.Response;\n                    Console.Write(\"Errorcode: {0}\", (int)response.StatusCode);\n                }\n                else\n                {\n                    Console.WriteLine(\"Error: {0}\", e.Status);\n                }\n            }\n            finally\n            {\n                if (response != null)\n                {\n                    response.Close();\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "json", "datatable"], "comments": [{"owner": {"reputation": 586, "user_id": 2019779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ELIP.png?s=128&g=1", "display_name": "fabrosell", "link": "https://stackoverflow.com/users/2019779/fabrosell"}, "edited": false, "score": 0, "creation_date": 1446061296, "post_id": 33399749, "comment_id": 54591703, "body": "Check Json.NET <a href=\"http://www.newtonsoft.com/json\" rel=\"nofollow noreferrer\">newtonsoft.com/json</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 5499932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b2e72901c8621720ddc95896e549d68?s=128&d=identicon&r=PG&f=1", "display_name": "Gazzi", "link": "https://stackoverflow.com/users/5499932/gazzi"}, "is_accepted": false, "score": 2, "last_activity_date": 1446061720, "last_edit_date": 1495542321, "creation_date": 1446061291, "answer_id": 33400177, "question_id": 33399749, "link": "https://stackoverflow.com/questions/33399749/convert-a-data-row-to-a-json-object/33400177#33400177", "title": "Convert a data row to a JSON object", "body": "<p>Spelling? Shouldn't your call to the \"SerializeObject\" method be:</p>\n\n<pre><code>string js = JsonConvert.SerializeObject(datatable);\n</code></pre>\n\n<p>Also see a similar question on converting a <a href=\"https://stackoverflow.com/questions/2979922/how-to-convert-datatable-to-json-string-using-json-net\">datatable to JSON string</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 2203864, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1f66f38e6a3b6f38321c4596f901f4db?s=128&d=identicon&r=PG", "display_name": "David Price", "link": "https://stackoverflow.com/users/2203864/david-price"}, "is_accepted": false, "score": 2, "last_activity_date": 1446062039, "creation_date": 1446062039, "answer_id": 33400409, "question_id": 33399749, "link": "https://stackoverflow.com/questions/33399749/convert-a-data-row-to-a-json-object/33400409#33400409", "title": "Convert a data row to a JSON object", "body": "<p>Like Gazzi said you should include the NewtonSoft.Json library it is included in Visual Studio. </p>\n\n<p>To get an object similar to what you have described you should create a data model like Country.cs which would look like this.</p>\n\n<pre><code>[Serializable]\npublic class CountryModel {\n   public int ID { get; set; }\n   public string Title { get; set; }\n   public List&lt;ValueModel&gt; Values { get; set; }\n}\n\n[Serializable]\npublic class ValueModel {\n   public int ValueID { get; set; }\n   public string Type { get; set; }\n}\n</code></pre>\n\n<p>Create a helper function to convert your table data to these models. You can then serialize/deserialize data as need using the Newtonsoft Library.</p>\n"}, {"tags": [], "owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "is_accepted": false, "score": 18, "last_activity_date": 1564872786, "last_edit_date": 1564872786, "creation_date": 1446063118, "answer_id": 33400729, "question_id": 33399749, "link": "https://stackoverflow.com/questions/33399749/convert-a-data-row-to-a-json-object/33400729#33400729", "title": "Convert a data row to a JSON object", "body": "<p>Assuming you are using <a href=\"/questions/tagged/json.net\" class=\"post-tag\" title=\"show questions tagged &#39;json.net&#39;\" rel=\"tag\">json.net</a>, there is a special built-in converter, <a href=\"https://github.com/JamesNK/Newtonsoft.Json/blob/master/Src/Newtonsoft.Json/Converters/DataTableConverter.cs\" rel=\"noreferrer\"><code>DataTableConverter</code></a>, that outputs data tables in an <a href=\"https://www.newtonsoft.com/json/help/html/SerializeDataSet.htm\" rel=\"noreferrer\">abbreviated format</a> as an array of rows where each row is serialized as column name/value pairs as shown in your question.  While there is also <a href=\"https://github.com/JamesNK/Newtonsoft.Json/blob/master/Src/Newtonsoft.Json/Converters/DataSetConverter.cs\" rel=\"noreferrer\">a converter for <code>DataSet</code></a>, there is no specific built-in converter for <a href=\"https://msdn.microsoft.com/en-us/library/system.data.datarow.aspx\" rel=\"noreferrer\"><code>DataRow</code></a>.  Thus when directly serializing a <code>DataRow</code> Json.NET will serialize all the fields and properties of the <code>DataRow</code> resulting in a more verbose output - which you do not want.</p>\n\n<p><strong>The easiest way</strong> to serialize a <code>DataRow</code> in the more compact form used by  <code>DataTable</code> is to serialize the entire table to a <code>JArray</code> using <a href=\"https://www.newtonsoft.com/json/help/html/M_Newtonsoft_Json_Linq_JArray_FromObject.htm\" rel=\"noreferrer\"><code>JArray.FromObject()</code></a> and then pick out the array item with the same index as the <code>DataRow</code> you want to serialize:</p>\n\n<pre><code>var rowIndex = 0;\n\nvar jArray = JArray.FromObject(datatable, JsonSerializer.CreateDefault(new JsonSerializerSettings { NullValueHandling = NullValueHandling.Ignore }));\n\nvar rowJToken = jArray[rowIndex];\nvar rowJson = rowJToken.ToString(Formatting.Indented);  // Or Formatting.None if you prefer\n</code></pre>\n\n<p>Since your table has only one row, <code>rowIndex</code> should be <code>0</code>.  More generally, if you don't know the index of a given <code>DataRow</code>, see <em><a href=\"https://stackoverflow.com/q/4502920/3744182\">How to get the row number from a datatable?</a></em>.</p>\n\n<p>Demo fiddle #1 <a href=\"https://dotnetfiddle.net/ywqDCZ\" rel=\"noreferrer\">here</a>.</p>\n\n<p><strong>Alternatively</strong>, if your table is large enough that serializing the entire table has performance implications, you can introduce a <a href=\"https://www.newtonsoft.com/json/help/html/CustomJsonConverter.htm\" rel=\"noreferrer\">custom <code>JsonConverter</code></a> for <code>DataRow</code> that writes the row to JSON as an object:</p>\n\n<pre><code>public class DataRowConverter : JsonConverter&lt;DataRow&gt;\n{\n    public override DataRow ReadJson(JsonReader reader, Type objectType, DataRow existingValue, bool hasExistingValue, JsonSerializer serializer)\n    {\n        throw new NotImplementedException(string.Format(\"{0} is only implemented for writing.\", this));\n    }\n\n    public override void WriteJson(JsonWriter writer, DataRow row, JsonSerializer serializer)\n    {\n        var table = row.Table;\n        if (table == null)\n            throw new JsonSerializationException(\"no table\");\n        var contractResolver = serializer.ContractResolver as DefaultContractResolver;\n\n        writer.WriteStartObject();\n        foreach (DataColumn col in row.Table.Columns)\n        {\n            var value = row[col];\n\n            if (serializer.NullValueHandling == NullValueHandling.Ignore &amp;&amp; (value == null || value == DBNull.Value))\n                continue;\n\n            writer.WritePropertyName(contractResolver != null ? contractResolver.GetResolvedPropertyName(col.ColumnName) : col.ColumnName);\n            serializer.Serialize(writer, value);\n        }\n        writer.WriteEndObject();\n    }\n}\n</code></pre>\n\n<p>And then use it like:</p>\n\n<pre><code>var row = datatable.Rows[rowIndex];\n\nvar settings = new JsonSerializerSettings\n{\n    NullValueHandling = NullValueHandling.Ignore,\n    Converters = { new DataRowConverter() },\n};\nvar rowJson = JsonConvert.SerializeObject(row, Formatting.Indented, settings);\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li><p>While it makes sense to serialize a single <code>DataRow</code>, it doesn't make sense to <em>deserialize</em> one since a <code>DataRow</code> is not a standalone object; it exists only inside some parent <code>DataTable</code>.  Thus <code>ReadJson()</code> is not implemented.</p></li>\n<li><p><a href=\"https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_JsonConverter_1.htm\" rel=\"noreferrer\"><code>JsonConverter&lt;T&gt;</code></a> was introduces in Json.NET <a href=\"https://github.com/JamesNK/Newtonsoft.Json/releases/tag/11.0.1\" rel=\"noreferrer\">11.0.1</a>.  In earlier versions inherit from <a href=\"https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_JsonConverter.htm\" rel=\"noreferrer\"><code>JsonConverter</code></a>.</p></li>\n</ul>\n\n<p>Demo fiddle #2 <a href=\"https://dotnetfiddle.net/p2JMxL\" rel=\"noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1895, "user_id": 556770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4c52eb0cacda184d23ba162d078b009?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rn Roberg", "link": "https://stackoverflow.com/users/556770/bj%c3%b6rn-roberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1590137120, "creation_date": 1590137120, "answer_id": 61951095, "question_id": 33399749, "link": "https://stackoverflow.com/questions/33399749/convert-a-data-row-to-a-json-object/61951095#61951095", "title": "Convert a data row to a JSON object", "body": "<p>As an alternative to the answer found <a href=\"https://stackoverflow.com/a/33400729/556770\">here</a>, you can use an <code>ExpandoObject</code> to quickly and pretty easily render a single row as JSON, as such:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var expando = new System.Dynamic.ExpandoObject() as IDictionary&lt;string, object&gt;;\nforeach (DataColumn col in myRow.Table.Columns)\n{\n    eo[col.ColumnName] = myRow[col];\n}\nvar json = JsonConvert.SerializeObject(expando);\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 5332792, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8713fabbab4c3c9de0dd6d43ed19489a?s=128&d=identicon&r=PG&f=1", "display_name": "Sciguy13", "link": "https://stackoverflow.com/users/5332792/sciguy13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21447, "favorite_count": 0, "answer_count": 4, "score": 10, "last_activity_date": 1590137120, "creation_date": 1446059960, "last_edit_date": 1564868967, "question_id": 33399749, "link": "https://stackoverflow.com/questions/33399749/convert-a-data-row-to-a-json-object", "title": "Convert a data row to a JSON object", "body": "<p>I have a <code>DataTable</code> which has only a single row and looks like</p>\n\n<pre><code>   America              |  Africa               |     Japan     |   \n   -------------------------------------------------------------\n  {\"Id\":1,\"Title\":\"Ka\"} | {\"Id\":2,\"Title\":\"Sf\"} | {\"Id\":3,\"Title\":\"Ja\",\"Values\":{\"ValID\":4,\"Type\":\"Okinawa\"}} \n</code></pre>\n\n<p>The <code>DataTable</code> columns are America, Africa, Japan.</p>\n\n<p>Now I want to convert the <code>DataTable</code> to JSON such that the JSON looks like </p>\n\n<pre><code>{\n\"America\": {\n    \"Id\": 1,\n    \"Title\": \"Ka\"\n},\n\"Africa\": {\n    \"Id\": 2,\n    \"Title\": \"Sf\"\n},\n\"Japan\": {\n    \"Id\": 3,\n    \"Title\": \"Ja\",\n    \"Values\": {\n        \"ValID\": 4,\n        \"Type\": \"Okinawa\"\n    }\n  }\n}  \n</code></pre>\n\n<p>My attempt was:</p>\n\n<pre><code>string js = JSonConvverter.Serializeobject(datatable);\nvar objType =  JObject.Parse(js);\n</code></pre>\n\n<p>But it didn't work.  Any help would be appreciated.</p>\n"}, {"tags": ["c#", "asp.net", "jwt", "claims-based-identity"], "answers": [{"comments": [{"owner": {"reputation": 1954, "user_id": 6276704, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/587d0480487de975a4b5f296f40701ae?s=128&d=identicon&r=PG&f=1", "display_name": "BluE", "link": "https://stackoverflow.com/users/6276704/blue"}, "edited": false, "score": 0, "creation_date": 1551434182, "post_id": 33421378, "comment_id": 96647071, "body": "You should be able to create your own ClaimValueTypes though."}], "tags": [], "owner": {"reputation": 2671, "user_id": 401173, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b1adb34a7a2e75061cafae01ceaee6e2?s=128&d=identicon&r=PG", "display_name": "Josh Russo", "link": "https://stackoverflow.com/users/401173/josh-russo"}, "is_accepted": false, "score": 0, "last_activity_date": 1446141323, "creation_date": 1446141323, "answer_id": 33421378, "question_id": 33399723, "link": "https://stackoverflow.com/questions/33399723/net-claimsidentity-to-jwt/33421378#33421378", "title": ".NET ClaimsIdentity to JWT?", "body": "<p>Big ugly case / if statement it is. I just implemented the bare minimum and will add cases as needed. Unfortunately, there's no <code>Decimal</code> type in the <code>ClaimValueTypes</code></p>\n\n<pre><code>public static class ClaimExtensions\n{\n    public static object ValueAsValueType(this Claim claim)\n    {\n        switch (claim.ValueType)\n        {\n            case ClaimValueTypes.Double:\n                return double.Parse(claim.Value);\n            case ClaimValueTypes.String:\n                return claim.Value;\n            default:\n                throw new Exception(string.Format(\"Unhandled ClaimValueType {0} in ClaimExtensions.ValueAsValueType()\", claim.ValueType));\n        }\n    }\n\n    public static List&lt;Claim&gt; ToClaims(this Dictionary&lt;string, object&gt; payload)\n    {\n        return payload.Select(x =&gt;\n        {\n            string valueType;\n            var value = x.Value;\n\n            if (x.Value is double || x.Value is decimal)\n                valueType = ClaimValueTypes.Double;\n            else if (x.Value is string)\n                valueType = ClaimValueTypes.String;\n            else\n                throw new Exception(string.Format(\"Unhandled type of Claim Value {0} in ClaimExtensions.ToClaims()\", value.GetType()));\n\n            return new Claim(x.Key, x.Value.ToString(), valueType);\n        }).ToList();\n\n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 2671, "user_id": 401173, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b1adb34a7a2e75061cafae01ceaee6e2?s=128&d=identicon&r=PG", "display_name": "Josh Russo", "link": "https://stackoverflow.com/users/401173/josh-russo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1152, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1446141323, "creation_date": 1446059855, "question_id": 33399723, "link": "https://stackoverflow.com/questions/33399723/net-claimsidentity-to-jwt", "title": ".NET ClaimsIdentity to JWT?", "body": "<p>I'm tying to determine the best practice for converting the <code>Claims</code> list in the .NET <code>ClaimsIdentity</code> to a JSON Web Token (<a href=\"https://github.com/jwt-dotnet/jwt\" rel=\"nofollow\">https://github.com/jwt-dotnet/jwt</a>). If I try to use the <code>Claims</code> list directly in <code>JsonWebToken.Encode()</code> I get a circular reference exception.</p>\n\n<p>My first thought was to convert it into a <code>Dictionary&lt;string,object&gt;</code>. The challenge is to convert the string <code>Claim.Value</code> to the appropriate type instance. It doesn't look like there's any good way to use the <code>ClaimValueTypes</code> indications to convert the <code>Value</code> to the appropriate instances, barring a big ugly case statement.</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["c#", "loops", "multidimensional-array", "wordsearch"], "comments": [{"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446061131, "post_id": 33399657, "comment_id": 54591621, "body": "What does the structure represent - some sort of a word dictionary? Why not simple <code>HashSet&lt;string&gt;</code>?"}, {"owner": {"reputation": 959, "user_id": 2301600, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c4f74ae6ee91ed872e4bb4e3db0d6177?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Lynx", "link": "https://stackoverflow.com/users/2301600/henry-lynx"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446063115, "post_id": 33399657, "comment_id": 54592713, "body": "It is a two dimensional grid like N * M. If I use HashSet&lt;string&gt;, how would I  go about searching in diagonal direction?"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446063400, "post_id": 33399657, "comment_id": 54592876, "body": "My comment was on <code>Also if the structure is the right one?</code>. But probably I don&#39;t understand the use case - so it&#39;s a some sort of a game board, not just a word dictionary as in my first question? Why don&#39;t you remove that sentence, it&#39;s misleading."}, {"owner": {"reputation": 959, "user_id": 2301600, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c4f74ae6ee91ed872e4bb4e3db0d6177?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Lynx", "link": "https://stackoverflow.com/users/2301600/henry-lynx"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446063973, "post_id": 33399657, "comment_id": 54593143, "body": "Yep it is a game board like a cross word."}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446064767, "post_id": 33399657, "comment_id": 54593558, "body": "Is there some special symbol that indicates end of the word inside the <code>char[,]</code>? Also should we search for a whole word, i.e if we search for let say &quot;as&quot; and find &quot;assume&quot;, is this counted as a match?"}, {"owner": {"reputation": 959, "user_id": 2301600, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c4f74ae6ee91ed872e4bb4e3db0d6177?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Lynx", "link": "https://stackoverflow.com/users/2301600/henry-lynx"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446065084, "post_id": 33399657, "comment_id": 54593728, "body": "I need to count the occurrences of the word a the table. The word can be found horizontally, vertically and across both left to right and right to left. I am reading the data from a text file. I know the size of the table 4x5. There are no special characters, only chars."}, {"owner": {"reputation": 959, "user_id": 2301600, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c4f74ae6ee91ed872e4bb4e3db0d6177?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Lynx", "link": "https://stackoverflow.com/users/2301600/henry-lynx"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446065639, "post_id": 33399657, "comment_id": 54594053, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/93622/discussion-between-henry-lynx-and-ivan-stoev\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "is_accepted": true, "score": 1, "last_activity_date": 1446076405, "last_edit_date": 1446076405, "creation_date": 1446072203, "answer_id": 33402851, "question_id": 33399657, "link": "https://stackoverflow.com/questions/33399657/continue-iterating-a-2d-array-from-certain-element/33402851#33402851", "title": "Continue iterating a 2D array from certain element", "body": "<p>Here you go:</p>\n\n<pre><code>public static class Sample\n{\n    public static int CountOccurrences(char[,] table, string word)\n    {\n        if (string.IsNullOrEmpty(word)) return 0;\n        int count = 0;\n        int rowCount = table.GetLength(0);\n        int colCount = table.GetLength(1);\n        for (int row = 0; row &lt; rowCount; row++)\n        {\n            for (int col = 0; col &lt; colCount; col++)\n            {\n                if (table[row, col] != word[0]) continue;\n                if (word.Length == 1) { count++; continue; }\n                for (int dy = -1; dy &lt;= 1; dy++)\n                    for (int dx = -1; dx &lt;= 1; dx++)\n                        if ((dx != 0 || dy != 0) &amp;&amp; Match(word, table, rowCount, colCount, row, col, dy, dx)) count++;\n            }\n        }\n        return count;\n    }\n    private static bool Match(string word, char[,] table, int rowCount, int colCount, int startRow, int startCol, int dy, int dx)\n    {\n        int row = startRow + dy;\n        if (dy != 0 &amp;&amp; (dy &lt; 0 ? row : rowCount - row) &lt; word.Length - 1) return false;\n        int col = startCol + dx;\n        if (dx != 0 &amp;&amp; (dx &lt; 0 ? col : colCount - col) &lt; word.Length - 1) return false;\n        for (int charPos = 1; charPos &lt; word.Length; row += dy, col += dx, charPos++)\n            if (table[row, col] != word[charPos]) return false;\n        return true;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 959, "user_id": 2301600, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c4f74ae6ee91ed872e4bb4e3db0d6177?s=128&d=identicon&r=PG&f=1", "display_name": "Henry Lynx", "link": "https://stackoverflow.com/users/2301600/henry-lynx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 33402851, "answer_count": 1, "score": 1, "last_activity_date": 1446076405, "creation_date": 1446059633, "question_id": 33399657, "link": "https://stackoverflow.com/questions/33399657/continue-iterating-a-2d-array-from-certain-element", "title": "Continue iterating a 2D array from certain element", "body": "<p>I am creating a word search game and I am stuck with the algorithm. I need to find the occurrences of a word in a table like data structure. I have chosen to use a 2d array for which I know the length and height. My idea is to look for the first letter of the word and if found to look in all possible directions. What I cannot grasp is how to start searching after I have found the first letter. I want to pass the location of the first letter to the methods that will search in all directions. Here is what I have so far:</p>\n\n<pre><code> public void SearchWord(char[,] input, string name)\n    {\n        //1. loop through the array and look for the first letter of the string\n        //2. if found search in all directions \"iterative\"\n        //3. if one direction doesn't find it break out of the method and continue to search in other directions\n        //4. if found mark the positions so you don't find the same word more than once\n        char firstLetter = name[0];\n\n        //go look for it in the 2d array\n        for (int y = 0; y &lt; 5; y++)\n        {\n            for (int x = 0; x &lt; 4; x++)\n            {\n                if (results[x, y] == firstLetter)//found the letter\n                {\n                    Console.WriteLine(\"Found it \" + \" \" + firstLetter);\n                    Console.WriteLine(x + \" \" + y);\n                    SearchRightDirection(x, y);\n                    SearchLeftDirection(x, y);\n\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>I have tried passing the location as a parameter like SearchRightDirection(char[,], int x, int y){} however I cannot continue from this exact location row and column the array. </p>\n\n<p>Do you have suggestions? Also if the structure is the right one?</p>\n"}, {"tags": ["c#", "uwp"], "comments": [{"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 1, "creation_date": 1446059724, "post_id": 33399614, "comment_id": 54590790, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33017016/deploy-windows-apps-to-family-and-friends-without-store-enterprise-or-developme\">Deploy Windows Apps to Family and Friends without store, enterprise or development-tools</a>"}, {"owner": {"reputation": 993, "user_id": 3767693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/38GTM.gif?s=128&g=1", "display_name": "WJM", "link": "https://stackoverflow.com/users/3767693/wjm"}, "reply_to_user": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1446059900, "post_id": 33399614, "comment_id": 54590902, "body": "Hi Joshua, I am looking for a way to mimic the functionality which is mentioned in your link, but in C#"}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1446060049, "post_id": 33399614, "comment_id": 54590987, "body": "Will it suffice if you just execute the powershell script <i>via</i> your C# code?"}, {"owner": {"reputation": 993, "user_id": 3767693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/38GTM.gif?s=128&g=1", "display_name": "WJM", "link": "https://stackoverflow.com/users/3767693/wjm"}, "reply_to_user": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1446060196, "post_id": 33399614, "comment_id": 54591068, "body": "Yes I think so, if it also allows the user to update an appx package and for the installer to get error information if the powershell script failed for some reason"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1446060718, "post_id": 33399614, "comment_id": 54591390, "body": "So the trivial google query is &quot;run powershell script from c#&quot;.  Looky there, that first hit tells you exactly what to do."}], "answers": [{"comments": [{"owner": {"reputation": 993, "user_id": 3767693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/38GTM.gif?s=128&g=1", "display_name": "WJM", "link": "https://stackoverflow.com/users/3767693/wjm"}, "edited": false, "score": 0, "creation_date": 1446336230, "post_id": 33404663, "comment_id": 54702369, "body": "Thanks Rob. Is this only accessible through a UWP? Or can I access this from WPF also?"}, {"owner": {"reputation": 21144, "user_id": 4068779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0Hsj.png?s=128&g=1", "display_name": "Rob Caplan - MSFT", "link": "https://stackoverflow.com/users/4068779/rob-caplan-msft"}, "reply_to_user": {"reputation": 993, "user_id": 3767693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/38GTM.gif?s=128&g=1", "display_name": "WJM", "link": "https://stackoverflow.com/users/3767693/wjm"}, "edited": false, "score": 0, "creation_date": 1446336363, "post_id": 33404663, "comment_id": 54702399, "body": "It is available only from desktop apps (such as WPF). It is not available to Windows Store apps"}, {"owner": {"reputation": 993, "user_id": 3767693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/38GTM.gif?s=128&g=1", "display_name": "WJM", "link": "https://stackoverflow.com/users/3767693/wjm"}, "edited": false, "score": 0, "creation_date": 1446340913, "post_id": 33404663, "comment_id": 54703192, "body": "Do I have to make a reference to System.Runtime and Windows.Management.Deployment through the TargetPlatformVersion adjustment in the VS project file? The class does not seem accessible just by trying to find the right reference in VS."}, {"owner": {"reputation": 1378, "user_id": 1480500, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/9dMOn.png?s=128&g=1", "display_name": "GGleGrand", "link": "https://stackoverflow.com/users/1480500/gglegrand"}, "edited": false, "score": 0, "creation_date": 1452966563, "post_id": 33404663, "comment_id": 57401858, "body": "Does this apply to UWP (Windows IoT-Core RaspberryPi)? I guess it should, but? Alternatively, is the a way to simply start the Add-AppxDevPackage.ps1 -Force script on the IoT-Core device from a headless  app running on the device?"}, {"owner": {"reputation": 1378, "user_id": 1480500, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/9dMOn.png?s=128&g=1", "display_name": "GGleGrand", "link": "https://stackoverflow.com/users/1480500/gglegrand"}, "edited": false, "score": 0, "creation_date": 1462566871, "post_id": 33404663, "comment_id": 61706698, "body": "Still looking for a way to do this with UWP!"}, {"owner": {"reputation": 683, "user_id": 4017847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AG1V4.jpg?s=128&g=1", "display_name": "Ali123", "link": "https://stackoverflow.com/users/4017847/ali123"}, "edited": false, "score": 0, "creation_date": 1591171164, "post_id": 33404663, "comment_id": 109950203, "body": "Hi Rob, thanks for your answer but the sample is not found. i am not sure what type of project or script should i create to manage UWP packages. Is this similar to App Installer that comes with UWP?"}, {"owner": {"reputation": 683, "user_id": 4017847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AG1V4.jpg?s=128&g=1", "display_name": "Ali123", "link": "https://stackoverflow.com/users/4017847/ali123"}, "edited": false, "score": 0, "creation_date": 1594113150, "post_id": 33404663, "comment_id": 111004974, "body": "can anyone support me with this? any documentation will be highly appreciated."}], "tags": [], "owner": {"reputation": 21144, "user_id": 4068779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0Hsj.png?s=128&g=1", "display_name": "Rob Caplan - MSFT", "link": "https://stackoverflow.com/users/4068779/rob-caplan-msft"}, "is_accepted": true, "score": 7, "last_activity_date": 1446083459, "creation_date": 1446083459, "answer_id": 33404663, "question_id": 33399614, "link": "https://stackoverflow.com/questions/33399614/uwp-installer-without-powershell/33404663#33404663", "title": "UWP installer without powershell", "body": "<p>You can install an appx package from code with the Windows.Management.Deployment.PackageManager object's <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.management.deployment.packagemanager.addpackageasync.aspx\" rel=\"noreferrer\">AddPackageAsync</a> method. This is demonstrated for C++ and C# in the <a href=\"https://code.msdn.microsoft.com/windowsapps/Package-Manager-Deployment-f4a89ec0\" rel=\"noreferrer\">Add app package sample</a> on MSDN.</p>\n\n<p>To update an existing package call PackageManager.<a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/br240978.aspx\" rel=\"noreferrer\">UpdatePackageAsync</a> </p>\n"}, {"comments": [{"owner": {"reputation": 683, "user_id": 4017847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AG1V4.jpg?s=128&g=1", "display_name": "Ali123", "link": "https://stackoverflow.com/users/4017847/ali123"}, "edited": false, "score": 0, "creation_date": 1591170871, "post_id": 42996581, "comment_id": 109950080, "body": "will this work if powershell is disabled by the admin? We are allowed to install apps like .exe but access to powershell is not allowed."}, {"owner": {"reputation": 683, "user_id": 4017847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AG1V4.jpg?s=128&g=1", "display_name": "Ali123", "link": "https://stackoverflow.com/users/4017847/ali123"}, "edited": false, "score": 0, "creation_date": 1594113205, "post_id": 42996581, "comment_id": 111005008, "body": "does anyone know if this works without admin access or powershell?  i am getting the following error Appinstaller operation failed with error code 0x80190191. Detail: Unauthorized"}], "tags": [], "owner": {"reputation": 853, "user_id": 1158254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6aa7422f94c2c78a249cc29add89eb8f?s=128&d=identicon&r=PG", "display_name": "blacksheep_2011", "link": "https://stackoverflow.com/users/1158254/blacksheep-2011"}, "is_accepted": false, "score": 3, "last_activity_date": 1490350022, "creation_date": 1490350022, "answer_id": 42996581, "question_id": 33399614, "link": "https://stackoverflow.com/questions/33399614/uwp-installer-without-powershell/42996581#42996581", "title": "UWP installer without powershell", "body": "<p>Microsoft has now adds its own graphical installer.\nYou can simply double click the appxbundle file.</p>\n\n<p>If you use a self signed cert it must be set as trusted in the system.\nThe cer file is also in the zip archive with is created by Visual Studio.</p>\n"}], "owner": {"reputation": 993, "user_id": 3767693, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/38GTM.gif?s=128&g=1", "display_name": "WJM", "link": "https://stackoverflow.com/users/3767693/wjm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5368, "favorite_count": 2, "accepted_answer_id": 33404663, "answer_count": 2, "score": 8, "last_activity_date": 1492161598, "creation_date": 1446059515, "last_edit_date": 1446059969, "question_id": 33399614, "link": "https://stackoverflow.com/questions/33399614/uwp-installer-without-powershell", "title": "UWP installer without powershell", "body": "<p>I am looking for a more userfriendly way to make an installer for my UWP Application. I don't want to distribute through the store and I am aware that you need to set the developer setting to enable sideloading of applications.</p>\n\n<p>Is it possible, in C#, to mimic the execution of the PowerShell script which deploys an appx package into the system? And if so, how does this work when you want to update the appx package instead of a new install?</p>\n\n<p>It seems a bit weird for my users to have to execute a powershell script by hand to install an application. So I would like to create an installer instead.</p>\n\n<p>EDIT: to elaborate, I am looking for a way in C# to install an appx package. I don't want to use any command line / external tools</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "linq"], "answers": [{"tags": [], "owner": {"reputation": 139130, "user_id": 141172, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vuodg.jpg?s=128&g=1", "display_name": "Eric J.", "link": "https://stackoverflow.com/users/141172/eric-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1446059768, "creation_date": 1446059768, "answer_id": 33399692, "question_id": 33399597, "link": "https://stackoverflow.com/questions/33399597/can-i-create-a-helper-function-to-use-with-linq/33399692#33399692", "title": "Can I create a helper function to use with Linq?", "body": "<p>Yes, but when querying against a datasource (e.g. SQL Server), that provider will not know what to do with your function.</p>\n\n<p>You can use <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/bb335435(v=vs.100).aspx\" rel=\"nofollow\">.AsEnumerable()</a> in a query to cause the rest of that query to be evaluated in the client rather than in the database.  After a call to .AsEnumerable(), you can use your own functions such as Format.FullName().</p>\n\n<p>Note that you should avoid calling .AsEnumerable() before filtering is done that could be done in the database, as all data after that call are transported from the database to the client program.</p>\n"}, {"tags": [], "owner": {"reputation": 35071, "user_id": 316799, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0fa8da5d4aacf3078d23d33c4effadd5?s=128&d=identicon&r=PG", "display_name": "Felipe Oriani", "link": "https://stackoverflow.com/users/316799/felipe-oriani"}, "is_accepted": false, "score": 0, "last_activity_date": 1446059815, "creation_date": 1446059815, "answer_id": 33399710, "question_id": 33399597, "link": "https://stackoverflow.com/questions/33399597/can-i-create-a-helper-function-to-use-with-linq/33399710#33399710", "title": "Can I create a helper function to use with Linq?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/bb425822.aspx\" rel=\"nofollow\">Linq To Sql</a> does not know how to parse the content of your method <code>FullName(..)</code> to sql. </p>\n\n<p>You could execute your query returning an anonymous object, for sample:</p>\n\n<pre><code>var tempUser = (\n    from pi in db.ProfileIdentifier\n    join p in db.Profile on pi.ProfileId equals p.ProfileId\n    where\n        pi.ProfileIdentifierTypeId == (int)ProfileIdentifierTypes.email &amp;&amp;\n        pi.ProfileIdentifierValue == email &amp;&amp;\n        pi.IsActive\n    select new \n    {\n        p.ProfileId,\n        SessionId = sessionTokenId,\n        p.Salutation,       \n        p.FirstName,\n        p.MiddleName,\n        p.LastName,\n        Email = email\n    }).FirstOrDefault();\n</code></pre>\n\n<p>After, you could convert the result using your function <code>FullName(..)</code>, for sample:</p>\n\n<pre><code>if (tempUser != null)   \n{\n    SessionUser = new LoginViewModel\n    {\n        ProfileId = tempUser.ProfileId,\n        SessionId = tempUser.SessionId,\n        FullName = Format.FullName(tempUser.Salutation, tempUser.FirstName, tempUser.MiddleName, tempUser.LastName),\n        Email = tempUser.Email\n    };\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3684, "user_id": 405883, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/drtTA.jpg?s=128&g=1", "display_name": "M Kenyon II", "link": "https://stackoverflow.com/users/405883/m-kenyon-ii"}, "edited": false, "score": 0, "creation_date": 1446060221, "post_id": 33399762, "comment_id": 54591084, "body": "That looks good. However, I added some code to my linq statement. I am doing a second/sub query. I&#39;m wondering if I can do that still?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1446060250, "post_id": 33399762, "comment_id": 54591100, "body": "Using <code>ToList</code> here is a <i>very</i> bad idea.  At a <i>bare minimum</i> you should be using <code>AsEnumerable</code>, and even that isn&#39;t the best."}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "reply_to_user": {"reputation": 3684, "user_id": 405883, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/drtTA.jpg?s=128&g=1", "display_name": "M Kenyon II", "link": "https://stackoverflow.com/users/405883/m-kenyon-ii"}, "edited": false, "score": 0, "creation_date": 1446060584, "post_id": 33399762, "comment_id": 54591296, "body": "@MKenyonII Yes, you can still do that.  Just make sure to do the .Take(1) as well to limit the number of rows you return from the database to only 1.  Put your Permissions in the first select so it has access to the database, and add <code>Permissions=p.Permissions</code> in the second select."}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "edited": false, "score": 0, "creation_date": 1446062146, "post_id": 33399762, "comment_id": 54592159, "body": "Feel free to change the .ToList() to .AsEnumerable() as Servy suggested, although on my system the difference between the two is approximately 2/10000ths of a second +/- 1/10000ths of a second.  I would not classify that as a <i>very</i> bad idea, but it is better to use .AsEnumerable()"}], "tags": [], "owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "is_accepted": false, "score": -1, "last_activity_date": 1446060264, "last_edit_date": 1446060264, "creation_date": 1446060005, "answer_id": 33399762, "question_id": 33399597, "link": "https://stackoverflow.com/questions/33399597/can-i-create-a-helper-function-to-use-with-linq/33399762#33399762", "title": "Can I create a helper function to use with Linq?", "body": "<p>This is the easiest conversion:</p>\n\n<pre><code>SessionUser = (\n    from pi in db.ProfileIdentifier\n    join p in db.Profile on pi.ProfileId equals p.ProfileId\n    where\n        pi.ProfileIdentifierTypeId == (int)ProfileIdentifierTypes.email &amp;&amp;\n        pi.ProfileIdentifierValue == email &amp;&amp;\n        pi.IsActive\n    select p)\n    .ToList()\n    .Select(p=&gt;new LoginViewModel\n    {\n        ProfileId = p.ProfileId,\n        SessionId = sessionTokenId,\n        FullName = Format.FullName(p.Salutation,p.FirstName,p.MiddleName,p.LastName),\n        Email = email\n    }).FirstOrDefault();\n</code></pre>\n\n<p>This would be more efficient:</p>\n\n<pre><code>SessionUser = (\n    from pi in db.ProfileIdentifier\n    join p in db.Profile on pi.ProfileId equals p.ProfileId\n    where\n        pi.ProfileIdentifierTypeId == (int)ProfileIdentifierTypes.email &amp;&amp;\n        pi.ProfileIdentifierValue == email &amp;&amp;\n        pi.IsActive\n    select p)\n    .Take(1)\n    .ToList()\n    .Select(p=&gt;new LoginViewModel\n    {\n        ProfileId = p.ProfileId,\n        SessionId = sessionTokenId,\n        FullName = Format.FullName(p.Salutation,p.FirstName,p.MiddleName,p.LastName),\n        Email = email\n    }).FirstOrDefault();\n</code></pre>\n\n<p>Even more efficient:</p>\n\n<pre><code>SessionUser = (\n    from pi in db.ProfileIdentifier\n    join p in db.Profile on pi.ProfileId equals p.ProfileId\n    where\n        pi.ProfileIdentifierTypeId == (int)ProfileIdentifierTypes.email &amp;&amp;\n        pi.ProfileIdentifierValue == email &amp;&amp;\n        pi.IsActive\n    select new \n    {\n        p.ProfileId,\n        p.Salutation,       \n        p.FirstName,\n        p.MiddleName,\n        p.LastName\n    })\n    .Take(1)\n    .ToList()\n    .Select(p=&gt;new LoginViewModel\n    {\n        ProfileId = p.ProfileId,\n        SessionId = sessionTokenId,\n        FullName = Format.FullName(p.Salutation,p.FirstName,p.MiddleName,p.LastName),\n        Email = email\n    }).FirstOrDefault();\n</code></pre>\n"}], "owner": {"reputation": 3684, "user_id": 405883, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/drtTA.jpg?s=128&g=1", "display_name": "M Kenyon II", "link": "https://stackoverflow.com/users/405883/m-kenyon-ii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1446060264, "creation_date": 1446059440, "last_edit_date": 1446060030, "question_id": 33399597, "link": "https://stackoverflow.com/questions/33399597/can-i-create-a-helper-function-to-use-with-linq", "title": "Can I create a helper function to use with Linq?", "body": "<p>I have a helper function :</p>\n\n<pre><code>namespace PublicationSystem.Tools\n{\n    public class Format\n    {\n        public static string FullName(string salutation, \n            string first, \n            string middle, \n            string last, \n            string suffix = \"\")\n        {\n            var fullName = new StringBuilder();\n\n            if (!string.IsNullOrEmpty(salutation)) fullName.Append(salutation + \" \");\n\n            fullName.Append(first + \" \");\n\n            if (!string.IsNullOrEmpty(middle)) fullName.Append(middle.Trim() + \" \");\n\n            fullName.Append(last);\n\n            if (!string.IsNullOrEmpty(suffix)) fullName.Append(\" \" + suffix);\n\n            return fullName.ToString().Trim();\n        }\n    }\n}\n</code></pre>\n\n<p>I would love to use this in Linq queries, like this:</p>\n\n<pre><code>SessionUser = (\n    from pi in db.ProfileIdentifier\n    join p in db.Profile on pi.ProfileId equals p.ProfileId\n    where\n        pi.ProfileIdentifierTypeId == (int)ProfileIdentifierTypes.email &amp;&amp;\n        pi.ProfileIdentifierValue == email &amp;&amp;\n        pi.IsActive\n    select new LoginViewModel\n    {\n        ProfileId = p.ProfileId,\n        SessionId = sessionTokenId,\n        FullName = Format.FullName(p.Salutation,p.FirstName,p.MiddleName,p.LastName),\n        Email = email,\n        Permissions = (\n            from ra in db.RoleAssignment\n            join rp in db.RolePermission on ra.RoleId equals rp.RoleId\n            join perm in db.Permission on rp.PermissionId equals perm.PermissionId\n            where ra.AssigneeId == p.ProfileId &amp;&amp;\n                rp.IsActive\n            select new ProfilePermission\n            {\n                RoleId = ra.RoleId,\n                AssignedToId = ra.AssignedToId,\n                PermissionId = perm.PermissionId,\n                PermissionName = perm.PermissionName,\n                PermissionGroupId = perm.PermissionGroupId\n            }).ToList()\n    }).FirstOrDefault();\n</code></pre>\n\n<p>Is there any way to do that?</p>\n"}, {"tags": ["javascript", "c#", "c++"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1446059202, "post_id": 33399533, "comment_id": 54590477, "body": "Don&#39;t add random language tags."}, {"owner": {"reputation": 21, "user_id": 4622230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65e2c58855ec5341f3174ef52c6cc49?s=128&d=identicon&r=PG", "display_name": "Usman Nadeem", "link": "https://stackoverflow.com/users/4622230/usman-nadeem"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1446059458, "post_id": 33399533, "comment_id": 54590626, "body": "oky sir , i&#39;ll care next time"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1446059571, "post_id": 33399533, "comment_id": 54590689, "body": "You can even care this time! Editing is as easy as never before! Go ahead and try it! :-)"}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1446062351, "post_id": 33399533, "comment_id": 54592275, "body": "In C++, the <code>main</code> function returns <code>int</code>.  Always."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 0, "creation_date": 1446064681, "post_id": 33399533, "comment_id": 54593510, "body": "@ThomasMatthews Nitpicky but doesn&#39;t that only hold true for strictly-conforming programs? I think the implementation is allowed to offer a <code>void main</code>. And for freestanding implementations it might be a whole different matter. Maybe I&#39;m confusing this with the C standard, though..."}], "owner": {"reputation": 21, "user_id": 4622230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65e2c58855ec5341f3174ef52c6cc49?s=128&d=identicon&r=PG", "display_name": "Usman Nadeem", "link": "https://stackoverflow.com/users/4622230/usman-nadeem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446238578, "creation_date": 1446059135, "last_edit_date": 1446238578, "question_id": 33399533, "link": "https://stackoverflow.com/questions/33399533/find-to-work-with-analyzing-anonymous-writer-identification", "title": "find to work with analyzing anonymous writer identification", "body": "<p>I want to design author identification but don't know how it works.\nhere is the online tool that is doing something like that... but its working??\n<a href=\"http://www.aicbt.com/authorship-attribution/online-software/\" rel=\"nofollow\">http://www.aicbt.com/authorship-attribution/online-software/</a></p>\n\n<pre><code>void main()\n    try\n    {\n        main program\n    }\n    catch exception\n    {\n        break;\n    }\n</code></pre>\n"}, {"tags": ["c#", "excel", "visual-studio-2015", "xlsx", "gembox-spreadsheet"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1930845"}, "edited": false, "score": 0, "creation_date": 1446132418, "post_id": 33411204, "comment_id": 54626168, "body": "&quot;Size property is in twip units (1/20th of a point)&quot; thank you for point it out. Yes, it works as expected now."}], "tags": [], "owner": {"reputation": 638, "user_id": 921142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IKCNU.png?s=128&g=1", "display_name": "GemBox Dev Team", "link": "https://stackoverflow.com/users/921142/gembox-dev-team"}, "is_accepted": true, "score": 1, "last_activity_date": 1573822335, "last_edit_date": 1573822335, "creation_date": 1446113128, "answer_id": 33411204, "question_id": 33399490, "link": "https://stackoverflow.com/questions/33399490/gembox-software-cant-change-font-name-and-or-font-size/33411204#33411204", "title": "Gembox software can&#39;t change Font Name and/or Font Size", "body": "<p>Note that a Size property is in twip units (1/20th of a point), see the <a href=\"http://www.gemboxsoftware.com/spreadsheet/help/html/P_GemBox_Spreadsheet_ExcelFont_Size.htm\" rel=\"nofollow noreferrer\">Size property's help page</a>.\nCan you try setting its value to 8 * 20, does this solve your issue?</p>\n\n<p>In case it does not then can you send us your file by <a href=\"https://support.gemboxsoftware.com/new-ticket\" rel=\"nofollow noreferrer\">submitting a support ticket</a>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1930845"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 33411204, "answer_count": 1, "score": 0, "last_activity_date": 1573822335, "creation_date": 1446058997, "question_id": 33399490, "link": "https://stackoverflow.com/questions/33399490/gembox-software-cant-change-font-name-and-or-font-size", "title": "Gembox software can&#39;t change Font Name and/or Font Size", "body": "<p>Using <a href=\"http://www.gemboxsoftware.com/\" rel=\"nofollow noreferrer\">GemBox</a> to take an existing .xlsx excel file to populate with data and save it to an .xlsx file.</p>\n\n<p>The issue I am having is this when trying to set the font name and font size using documentation on Gembox website I am getting the following results.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4ovXH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4ovXH.png\" alt=\"Error when Excel file is open\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tmyj2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tmyj2.png\" alt=\"Data inside the Excel file\"></a></p>\n\n<p>Here is how I am setting font name </p>\n\n<pre><code>.Style.Font.Name = \"Calibri\";\n.Style.Font.Size = 8;\n</code></pre>\n\n<p>Can change any other style except when changing Font Name or Font Size I get the error.</p>\n"}, {"tags": ["c#", "visual-studio-2015"], "comments": [{"owner": {"reputation": 1067, "user_id": 4203255, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/24402072d2872fde4eb25d154d25c99c?s=128&d=identicon&r=PG&f=1", "display_name": "code", "link": "https://stackoverflow.com/users/4203255/code"}, "edited": false, "score": 0, "creation_date": 1446059192, "post_id": 33399483, "comment_id": 54590472, "body": "You have 2 golds in your code...you pass an int name gold, then you set its value...is this on purpose"}, {"owner": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1446059209, "post_id": 33399483, "comment_id": 54590481, "body": "What value is passed to this method as a parameter value? It this the current amount of player&#39;s gold? If this is so, you possibly can&#39;t compare current amount of gold to current amount of gold (or rather, you can compare but you won&#39;t make anything of it)."}, {"owner": {"reputation": 3408, "user_id": 1950812, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Ol07c.png?s=128&g=1", "display_name": "fillobotto", "link": "https://stackoverflow.com/users/1950812/fillobotto"}, "edited": false, "score": 0, "creation_date": 1446059215, "post_id": 33399483, "comment_id": 54590484, "body": "You are overwriting <code>Client.Player.Gold</code> on <code>Gold</code>, but the if clause is asking for those two values to be different <code>!=</code>, so you never enter inside that block of code"}, {"owner": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1446059539, "post_id": 33399483, "comment_id": 54590667, "body": "Do you mean +1 gold as in the state of the property <code>Gold</code> changed by +1, or do you mean that <code>Gold</code> is +1 or higher? Hard to tell by reading your code alone...."}], "answers": [{"tags": [], "owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "is_accepted": true, "score": 1, "last_activity_date": 1446060115, "last_edit_date": 1446060115, "creation_date": 1446059496, "answer_id": 33399609, "question_id": 33399483, "link": "https://stackoverflow.com/questions/33399483/how-to-write-if-player-gets-1-in-c/33399609#33399609", "title": "How to write &quot;If player gets +1&quot; in c#", "body": "<p>You have to keep the original value before checking and then add gold to player.</p>\n\n<pre><code>private void GoldNotification(int Gold)\n{\n    //Gold = Client.Player.Gold; // remove this\n\n    if (Gold != -1 &amp;&amp; Client.Player.Gold != Gold + Client.Player.Gold) // after this check add gold to player\n    {\n        Client.Player.Gold += Gold;\n        //...\n    }\n}\n</code></pre>\n\n<p>in this part <code>Client.Player.Gold != Gold + Client.Player.Gold</code> if Gold is <code>0</code> the condition becomes false means no gold added</p>\n\n<p>Edit : I am so stupid. this can be simplified to </p>\n\n<pre><code>if (Gold &gt; 0)\n</code></pre>\n\n<p>That means gold is more than 0 so sure we added this to player.</p>\n"}, {"tags": [], "owner": {"reputation": 13818, "user_id": 603200, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b5dc04ca089d917bf05b0eda8516763?s=128&d=identicon&r=PG", "display_name": "Alireza Noori", "link": "https://stackoverflow.com/users/603200/alireza-noori"}, "is_accepted": false, "score": 0, "last_activity_date": 1446059848, "creation_date": 1446059848, "answer_id": 33399720, "question_id": 33399483, "link": "https://stackoverflow.com/questions/33399483/how-to-write-if-player-gets-1-in-c/33399720#33399720", "title": "How to write &quot;If player gets +1&quot; in c#", "body": "<p>As far as I understood your problem, you're trying to notify user whenever he/she gets gold. Now assuming you're passing the new value for Gold to the function your code should be something like:</p>\n\n<pre><code>private void GoldNotification(int newGold)\n{\n    var oldGold = Client.Player.Gold;\n\n    if (newGold != -1 &amp;&amp; newGold &gt; oldGold) \n    //they've got gold. prceed to notify\n}\n</code></pre>\n\n<p>But if you want the process to be automated, you could use events for this. You could implement Gold as a property and fire an event whenever its value changes.</p>\n\n<p>Again, I'm not 100% sure what exactly you are trying to achieve but hopefully this'll be helpful.</p>\n"}], "owner": {"reputation": 581, "user_id": 5415573, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1951142ff2f935b43aa8f04ea55cf780?s=128&d=identicon&r=PG&f=1", "display_name": "RDR", "link": "https://stackoverflow.com/users/5415573/rdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 33399609, "answer_count": 2, "score": -2, "last_activity_date": 1446060115, "creation_date": 1446058985, "question_id": 33399483, "link": "https://stackoverflow.com/questions/33399483/how-to-write-if-player-gets-1-in-c", "title": "How to write &quot;If player gets +1&quot; in c#", "body": "<p>So the code im adding, is, when a 'player' gets + 1 'gold' (you get gold for killing monsters like around every 5-10 monsters)</p>\n\n<p>I dont know how to make it say if player gets + 1 gold, all i have is</p>\n\n<pre><code>    private void GoldNotification(int Gold)\n    {\n        Gold = Client.Player.Gold;\n\n        if (Gold != -1 &amp;&amp; Client.Player.Gold != Gold)\n        //then here im going to add code for it to display a notification that says +1 Gold above your character for a brief few seconds just so people know when they gain gold\n    }\n</code></pre>\n\n<p>just focus on the</p>\n\n<pre><code>    if (Gold != -1 &amp;&amp; Client.Player.Gold != Gold)\n</code></pre>\n\n<p>because thats all im really questioning about, i get 0 errors in VS but when i test it in-game, it doesnt work.</p>\n"}, {"tags": ["c#", "unity3d", "unityscript"], "answers": [{"comments": [{"owner": {"reputation": 1033, "user_id": 2497085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bbdccd6b3f71719a4fcc9e0f10361785?s=128&d=identicon&r=PG", "display_name": "HoloLady", "link": "https://stackoverflow.com/users/2497085/hololady"}, "edited": false, "score": 0, "creation_date": 1446111499, "post_id": 33408933, "comment_id": 54611430, "body": "You could also just have the players click on the NPC&#39;s and have that be the beginning of the interaction"}, {"owner": {"reputation": 3037, "user_id": 2598562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/gie1o.png?s=128&g=1", "display_name": "Creative Magic", "link": "https://stackoverflow.com/users/2598562/creative-magic"}, "reply_to_user": {"reputation": 1033, "user_id": 2497085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bbdccd6b3f71719a4fcc9e0f10361785?s=128&d=identicon&r=PG", "display_name": "HoloLady", "link": "https://stackoverflow.com/users/2497085/hololady"}, "edited": false, "score": 0, "creation_date": 1446111688, "post_id": 33408933, "comment_id": 54611558, "body": "Method of interaction is really not important, but usually you would be prompted when a dialog is available; usually when you&#39;re close enough to the target.  As the hooking part, I really feel it&#39;s easy with Unity&#39;s component-based approach to access a target GameObject&#39;s component and start a sequence, get data or start a coroutine."}, {"owner": {"reputation": 1033, "user_id": 2497085, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bbdccd6b3f71719a4fcc9e0f10361785?s=128&d=identicon&r=PG", "display_name": "HoloLady", "link": "https://stackoverflow.com/users/2497085/hololady"}, "edited": false, "score": 0, "creation_date": 1446111951, "post_id": 33408933, "comment_id": 54611693, "body": "Ooh I see, sorry, I misunderstood the question. Your way does seem like the way to go then!"}], "tags": [], "owner": {"reputation": 3037, "user_id": 2598562, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/gie1o.png?s=128&g=1", "display_name": "Creative Magic", "link": "https://stackoverflow.com/users/2598562/creative-magic"}, "is_accepted": false, "score": 3, "last_activity_date": 1446106295, "creation_date": 1446106295, "answer_id": 33408933, "question_id": 33399432, "link": "https://stackoverflow.com/questions/33399432/unity-3d-game-object-interaction/33408933#33408933", "title": "Unity 3D: Game Object interaction", "body": "<p>If you're looking for a simple solution, I could offer this:</p>\n\n<p>Inside of the character's <code>GameObject</code> have another <code>GameObject</code> called, let's say, \"Dialog Collider\". Add a collider component to that game object, make it (the collider) a trigger. Also, I would advise you to make the collider a cylinder with a larger radius so that you can enter dialog without actually colliding with another character.</p>\n\n<p>Add a script your player character that starts the dialog when the \"Dialog Collider\" enters the collision with another GameObject of same name/tag. At this point I presume you would have the same setup for all game character: they all should have a \"Dialog Collider\" <code>GameObject</code> inside of the main GameObject, if they have a dialog option to begin with that is.</p>\n\n<p>That way you can leave the collision detection to the UnityEngine and not check for it every frame.</p>\n\n<p>Also, I'd advise to make a generic <code>Dialog</code> script; make it an abstract class that you can inherit from to override some methods so you'd have all the basic functionality right from the start and enough flexibility to change/extend the behaviour of the NPC later on.</p>\n\n<p>Or make a IDialogCharacter interface and implement the methods and dialogs manually for every class; use polymorphism to your advantage to check for the IDialogCharacter interface if you prefer composition over inheritance.</p>\n\n<p>As the hooking up part - when the collision begins your player character will be able to fetch the script (first get the colliding GameObject, then the script component) of the other character and request the dialog start from the other character or get some data object from the other character and start the dialog.</p>\n"}], "owner": {"reputation": 8748, "user_id": 903124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/bagV8.jpg?s=128&g=1", "display_name": "Fabian Bigler", "link": "https://stackoverflow.com/users/903124/fabian-bigler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1446106295, "creation_date": 1446058800, "last_edit_date": 1446096097, "question_id": 33399432, "link": "https://stackoverflow.com/questions/33399432/unity-3d-game-object-interaction", "title": "Unity 3D: Game Object interaction", "body": "<p>Assuming we have one first person character and several NPC AIs. The first person character should be able to talk to the NPC AI's (via dialog service). My problem is: How should I \"connect\" the two game objects (FPC and NPC) to each other?</p>\n\n<p>So he can basically walk around and talk to them, then they answer something, and the first person character may choose an option.</p>\n\n<p>I see several options here: </p>\n\n<ol>\n<li>add a public variable to 'first person character'. this public\nvariable will hold the NPC AI. So the NPC AI and first person\ncharacter can talk to each other via functions on both classes.</li>\n<li>Add a class 'DialogService' which implements the observer pattern.\nSo there will be several publishers and subscribers. My problem here\nis how to hook up the NPCs and first person character to each other</li>\n<li>Maybe you have a better alternative?</li>\n</ol>\n"}, {"tags": ["c#", "xml", "annotations"], "comments": [{"owner": {"reputation": 1611, "user_id": 3423291, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c4V7H.jpg?s=128&g=1", "display_name": "MajkeloDev", "link": "https://stackoverflow.com/users/3423291/majkelodev"}, "edited": false, "score": 0, "creation_date": 1446058548, "post_id": 33399307, "comment_id": 54590097, "body": "The output You receive makes more sense than the one You want to achieve :)"}, {"owner": {"reputation": 10390, "user_id": 495247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/08d49f7263093a9ddfebf43ccf9006ad?s=128&d=identicon&r=PG", "display_name": "Scottie", "link": "https://stackoverflow.com/users/495247/scottie"}, "reply_to_user": {"reputation": 1611, "user_id": 3423291, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c4V7H.jpg?s=128&g=1", "display_name": "MajkeloDev", "link": "https://stackoverflow.com/users/3423291/majkelodev"}, "edited": false, "score": 0, "creation_date": 1446058791, "post_id": 33399307, "comment_id": 54590229, "body": "Agreed... If only I had control over this request.  But I&#39;m integrating with a 3rd party."}, {"owner": {"reputation": 1611, "user_id": 3423291, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c4V7H.jpg?s=128&g=1", "display_name": "MajkeloDev", "link": "https://stackoverflow.com/users/3423291/majkelodev"}, "edited": false, "score": 0, "creation_date": 1446059079, "post_id": 33399307, "comment_id": 54590410, "body": "ok give me a second I&#39;ll open VS and try it out :)"}, {"owner": {"reputation": 1611, "user_id": 3423291, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c4V7H.jpg?s=128&g=1", "display_name": "MajkeloDev", "link": "https://stackoverflow.com/users/3423291/majkelodev"}, "edited": false, "score": 0, "creation_date": 1446059326, "post_id": 33399307, "comment_id": 54590552, "body": "You will always have 3pair of teleType/teleNumber or it can be one for instance ?"}, {"owner": {"reputation": 10390, "user_id": 495247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/08d49f7263093a9ddfebf43ccf9006ad?s=128&d=identicon&r=PG", "display_name": "Scottie", "link": "https://stackoverflow.com/users/495247/scottie"}, "reply_to_user": {"reputation": 1611, "user_id": 3423291, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c4V7H.jpg?s=128&g=1", "display_name": "MajkeloDev", "link": "https://stackoverflow.com/users/3423291/majkelodev"}, "edited": false, "score": 0, "creation_date": 1446059576, "post_id": 33399307, "comment_id": 54590694, "body": "There is no limit to how many.  0-*."}, {"owner": {"reputation": 1611, "user_id": 3423291, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c4V7H.jpg?s=128&g=1", "display_name": "MajkeloDev", "link": "https://stackoverflow.com/users/3423291/majkelodev"}, "edited": false, "score": 0, "creation_date": 1446061093, "post_id": 33399307, "comment_id": 54591600, "body": "Please see my answer"}], "answers": [{"tags": [], "owner": {"reputation": 1611, "user_id": 3423291, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/c4V7H.jpg?s=128&g=1", "display_name": "MajkeloDev", "link": "https://stackoverflow.com/users/3423291/majkelodev"}, "is_accepted": true, "score": 1, "last_activity_date": 1446061114, "last_edit_date": 1446061114, "creation_date": 1446060726, "answer_id": 33399995, "question_id": 33399307, "link": "https://stackoverflow.com/questions/33399307/how-do-i-annotate-my-xml-to-remove-the-parent-node-of-an-array-in-c/33399995#33399995", "title": "How do I annotate my XML to remove the parent node of an array in C#?", "body": "<p>I Found the solution using Linq to xml, I hope You can go this way. Please see below:</p>\n\n<pre><code>// You will have to use System.Xml.Linq library\npublic class Phone // the only class I have\n{\n    public string PhoneType { get; set; }\n    public string Number { get; set; }\n}\n\npublic XElement CreateTelecomNode(List&lt;Phone&gt; phones)\n{\n    var telecom = new XElement(\"Telecom\");\n    foreach (var item in phones)\n    {\n        telecom.Add(new XElement(\"TeleType\", item.PhoneType));\n        telecom.Add(new XElement(\"TeleNumber\", item.Number));\n    }\n    return telecom;\n}\n</code></pre>\n\n<p>Output with example list:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R4cUg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R4cUg.png\" alt=\"outputExample\"></a></p>\n"}], "owner": {"reputation": 10390, "user_id": 495247, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/08d49f7263093a9ddfebf43ccf9006ad?s=128&d=identicon&r=PG", "display_name": "Scottie", "link": "https://stackoverflow.com/users/495247/scottie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 33399995, "answer_count": 1, "score": 0, "last_activity_date": 1446061114, "creation_date": 1446058385, "question_id": 33399307, "link": "https://stackoverflow.com/questions/33399307/how-do-i-annotate-my-xml-to-remove-the-parent-node-of-an-array-in-c", "title": "How do I annotate my XML to remove the parent node of an array in C#?", "body": "<p>I have an integration that I need to follow a certain pattern of XML.</p>\n\n<p>One of the requirements is something like this...</p>\n\n<pre><code>&lt;Telecom&gt;\n    &lt;TeleType&gt;Mobile&lt;/TeleType&gt;\n    &lt;TeleNumber&gt;806-611-1111&lt;/TeleNumber&gt;\n    &lt;TeleType&gt;Home&lt;/TeleType&gt;\n    &lt;TeleNumber&gt;806-411-9111&lt;/TeleNumber&gt;\n    &lt;TeleType&gt;Other&lt;/TeleType&gt;\n    &lt;TeleNumber&gt;806-311-1111&lt;/TeleNumber&gt;\n&lt;/Telecom&gt;\n</code></pre>\n\n<p>I've set up my model to look like this:</p>\n\n<pre><code>[XmlArray(\"Telecom\")]\n[XmlArrayItem(typeof(Phone))]\npublic List&lt;Phone&gt; Phones { get; set; }\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[XmlRoot(\"Telecom\")]\npublic class Phone\n{\n    [XmlElement(\"TeleType\")]\n    public string PhoneType { get; set; }\n\n    [XmlElement(\"TeleNumber\")]\n    public string Number { get; set; }\n}\n</code></pre>\n\n<p>However, the output I receive is:</p>\n\n<pre><code>&lt;Telecom&gt;\n    &lt;Phone&gt;\n        &lt;TeleType&gt;HOME&lt;/TeleType&gt;\n        &lt;TeleNumber&gt;801-555-1234&lt;/TeleNumber&gt;\n    &lt;/Phone&gt;\n    &lt;Phone&gt;\n        &lt;TeleType&gt;WORK&lt;/TeleType&gt;\n        &lt;TeleNumber&gt;801-123-4321&lt;/TeleNumber&gt;\n    &lt;/Phone&gt;\n&lt;/Telecom&gt;\n</code></pre>\n\n<p>How do I remove the Phone node from this and render the first example?</p>\n\n<p>Note: using </p>\n\n<pre><code>[XmlElement(\"Telecom\")]\npublic List&lt;MICAPhone&gt; Phones { get; set; }\n</code></pre>\n\n<p>doesn't work either as I get multiple Telecom nodes.</p>\n"}, {"tags": ["c#", "arrays", "string"], "comments": [{"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 1, "creation_date": 1446058729, "post_id": 33399302, "comment_id": 54590205, "body": "<code>char[,]</code> does not make sense. you should use jagged array. <code>char[][]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4782977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fab2237875ade76e3255f6070692e4?s=128&d=identicon&r=PG", "display_name": "infexo37", "link": "https://stackoverflow.com/users/4782977/infexo37"}, "edited": false, "score": 0, "creation_date": 1446059202, "post_id": 33399446, "comment_id": 54590478, "body": "That&#39;s great. But how can I display &#39;result&#39; in richTextBox ?"}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "reply_to_user": {"reputation": 13, "user_id": 4782977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fab2237875ade76e3255f6070692e4?s=128&d=identicon&r=PG", "display_name": "infexo37", "link": "https://stackoverflow.com/users/4782977/infexo37"}, "edited": false, "score": 0, "creation_date": 1446059294, "post_id": 33399446, "comment_id": 54590535, "body": "@infexo37 how you want to display result in richtextbox"}, {"owner": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "reply_to_user": {"reputation": 13, "user_id": 4782977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fab2237875ade76e3255f6070692e4?s=128&d=identicon&r=PG", "display_name": "infexo37", "link": "https://stackoverflow.com/users/4782977/infexo37"}, "edited": false, "score": 0, "creation_date": 1446059338, "post_id": 33399446, "comment_id": 54590560, "body": "@infexo37: all you asked for in the original question was how to generate the 2D array. If you have more requirements, ask another question or elaborate your original question, please."}, {"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "reply_to_user": {"reputation": 15033, "user_id": 215741, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/523632d546a902405b674284d0a2cee9?s=128&d=identicon&r=PG", "display_name": "code4life", "link": "https://stackoverflow.com/users/215741/code4life"}, "edited": false, "score": 0, "creation_date": 1446059526, "post_id": 33399446, "comment_id": 54590662, "body": "@code4life is right; if your question has changed, you&#39;d need to ask another (separate) question.  However, I would advise <i>against</i> changing the question to include this new requirement."}], "tags": [], "owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "is_accepted": true, "score": 1, "last_activity_date": 1446059174, "last_edit_date": 1446059174, "creation_date": 1446058855, "answer_id": 33399446, "question_id": 33399302, "link": "https://stackoverflow.com/questions/33399302/whats-the-best-way-to-make-two-dimensional-array-from-string/33399446#33399446", "title": "What&#39;s the best way to make two dimensional array from string[]?", "body": "<p>You can call <a href=\"https://msdn.microsoft.com/en-us/library/ezftk57x(v=vs.110).aspx\" rel=\"nofollow\"><code>ToCharArray</code></a> on each line.</p>\n\n<pre><code>String filepath = @\"C:\\test.txt\";\nChar[][] result = File.ReadAllLines(filepath).Select(obj =&gt; obj.ToCharArray()).ToArray();\n</code></pre>\n\n<p>It's worth noting that this will give you a <code>Char[][]</code> (which is a <a href=\"https://msdn.microsoft.com/en-us/library/2s05feca.aspx\" rel=\"nofollow\">jagged array</a> ), and <strong>not</strong> <code>Char[,]</code> (which is a <a href=\"https://msdn.microsoft.com/en-us/library/2yd9wwz4.aspx\" rel=\"nofollow\">multidimensional array</a>)</p>\n"}], "owner": {"reputation": 13, "user_id": 4782977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fab2237875ade76e3255f6070692e4?s=128&d=identicon&r=PG", "display_name": "infexo37", "link": "https://stackoverflow.com/users/4782977/infexo37"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33399446, "answer_count": 1, "score": 0, "last_activity_date": 1446059537, "creation_date": 1446058373, "last_edit_date": 1446059537, "question_id": 33399302, "link": "https://stackoverflow.com/questions/33399302/whats-the-best-way-to-make-two-dimensional-array-from-string", "title": "What&#39;s the best way to make two dimensional array from string[]?", "body": "<p>I'm trying to read lines from txt file like this:</p>\n\n<pre><code>string[] data = File.ReadAllLines(\"data.txt\");\n</code></pre>\n\n<p>What i need to make is char[,] array, which dimensions are:</p>\n\n<pre><code>[single row from txt file chars count] X [row from txt file count].\n</code></pre>\n\n<p>Then this char array have to be filled with data from string[] data.</p>\n\n<p>Is there any easy way to do this ? I'm trying to convert string to char somehow but I can't. Any ideas?</p>\n"}, {"tags": ["c#", "entity-framework", "linq"], "comments": [{"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1446058352, "post_id": 33399272, "comment_id": 54589966, "body": "can you post the full query you&#39;re running"}, {"owner": {"reputation": 25125, "user_id": 156755, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VYXRG.jpg?s=128&g=1", "display_name": "Basic", "link": "https://stackoverflow.com/users/156755/basic"}, "edited": false, "score": 1, "creation_date": 1446058680, "post_id": 33399272, "comment_id": 54590178, "body": "Seems like the real question is why you&#39;re representing the same information in multiple fields on your model. If your data structure was normalised, you wouldn&#39;t need logic in the model at all..."}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "edited": false, "score": 1, "creation_date": 1446059615, "post_id": 33399272, "comment_id": 54590716, "body": "Rather odd example that doesn&#39;t seem to be very useful.  If your search criteria is &quot;B,D&quot;, it would fail if CredCodeStr was &quot;A,B,C,D&quot; which you would think that is a match."}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "edited": false, "score": 0, "creation_date": 1446059723, "post_id": 33399272, "comment_id": 54590789, "body": "Just rewrite your query as <code>query=query.Where(wo=&gt;searchCriteria.crewCode.All(cc=&gt;wo.Cre&zwnj;&#8203;wCodesList.Contains(&zwnj;&#8203;cc)));</code> or <code>foreach(var cc in searchCriteria.crewCode) query=query.Where(wo=&gt;wo.CrewCodesList.Contains(cc));</code>"}, {"owner": {"reputation": 1757, "user_id": 3485021, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/274b48a5fd5cb8a453dfb97df7209cc9?s=128&d=identicon&r=PG&f=1", "display_name": "JB06", "link": "https://stackoverflow.com/users/3485021/jb06"}, "reply_to_user": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "edited": false, "score": 0, "creation_date": 1446065558, "post_id": 33399272, "comment_id": 54593994, "body": "@RobertMcKee You&#39;re right, this was a pretty useless example, turns out it was old code that I hadn&#39;t gotten around to updating yet. A simple example would be <code>var wo = query.Where(x =&gt; x.CrewCodesStr.Contains(&quot;1234&quot;);</code> This was failing because I hadn&#39;t put the data in memory yet."}], "answers": [{"comments": [{"owner": {"reputation": 1757, "user_id": 3485021, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/274b48a5fd5cb8a453dfb97df7209cc9?s=128&d=identicon&r=PG&f=1", "display_name": "JB06", "link": "https://stackoverflow.com/users/3485021/jb06"}, "edited": false, "score": 0, "creation_date": 1446065631, "post_id": 33399327, "comment_id": 54594044, "body": "This is what I ended up using, but instead of doing the join here, I am able to call the CrewCodesStr property since the object is in memory now, and I&#39;m working with LINQ to Objects instead of Entities. Thanks!"}], "tags": [], "owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "is_accepted": true, "score": 3, "last_activity_date": 1446062161, "last_edit_date": 1446062161, "creation_date": 1446058453, "answer_id": 33399327, "question_id": 33399272, "link": "https://stackoverflow.com/questions/33399272/linq-equivalent-of-string-join-that-is-usable-in-linq-to-entities/33399327#33399327", "title": "LINQ equivalent of string.Join that is usable in LINQ to Entities", "body": "<p>You can do a <code>string.Join</code> <em>after</em> you've selected the info you need from your database. If you do a <code>ToList()</code>, this will enumerate the data you need from the database. Then you can do whatever C# you want, as it will run in memory after the <code>ToList()</code></p>\n\n<pre><code>var result = MyObjects.Select(x =&gt; new\n{\n    ID = x.ID,\n    CrewCodes = x.CrewCodes\n})\n.AsEnumerable()//enumerate the queryable\n.Select(x =&gt; new\n{\n    ID = x.ID,\n    String = string.Join(\",\",x.CrewCodes)\n});\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 3485021, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/274b48a5fd5cb8a453dfb97df7209cc9?s=128&d=identicon&r=PG&f=1", "display_name": "JB06", "link": "https://stackoverflow.com/users/3485021/jb06"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1536, "favorite_count": 0, "accepted_answer_id": 33399327, "answer_count": 1, "score": 0, "last_activity_date": 1446062161, "creation_date": 1446058303, "last_edit_date": 1446058498, "question_id": 33399272, "link": "https://stackoverflow.com/questions/33399272/linq-equivalent-of-string-join-that-is-usable-in-linq-to-entities", "title": "LINQ equivalent of string.Join that is usable in LINQ to Entities", "body": "<p>I have a metadata class with some custom properties for easier data access. One problem that I have run across though, is that when I try to use this property in LINQ statements I get this error.</p>\n\n<pre><code>The specified type member 'CrewCodesStr' is not supported in LINQ to Entities.\n</code></pre>\n\n<p>I know why I get it, I'm wondering if there is another way to do this to allow the property to be used in LINQ statements.</p>\n\n<p>Here is the property:</p>\n\n<pre><code>public string CrewCodesStr\n{\n    get { return string.Join(\", \", CrewCodesList); }\n}\n</code></pre>\n\n<p>Here is an example query that it fails on.</p>\n\n<pre><code>query = query.Where(wo =&gt; searchCriteria.crewCode.Contains(wo.CrewCodesStr));\n</code></pre>\n"}, {"tags": ["javascript", "c#", "api", "github"], "answers": [{"tags": [], "owner": {"reputation": 2829, "user_id": 1718305, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4b4e9d661afce1c743a637d3670b836b?s=128&d=identicon&r=PG", "display_name": "ndd", "link": "https://stackoverflow.com/users/1718305/ndd"}, "is_accepted": false, "score": 2, "last_activity_date": 1446059420, "creation_date": 1446059420, "answer_id": 33399589, "question_id": 33399103, "link": "https://stackoverflow.com/questions/33399103/upload-and-display-net-source-code-on-my-website/33399589#33399589", "title": "Upload and display .NET source code on my website", "body": "<p>You may have seen <a href=\"http://referencesource.microsoft.com/\" rel=\"nofollow\">http://referencesource.microsoft.com/</a> which shows code for .Net Framework. </p>\n\n<p>This is done using <a href=\"https://github.com/KirillOsenkov/SourceBrowser\" rel=\"nofollow\">https://github.com/KirillOsenkov/SourceBrowser</a>. Try this and you should be able to create and host your own static HTML website to browse your C#/VB/MSBuild/TypeScript source code.</p>\n\n<p>You can find more details on Channel 9 - <a href=\"https://channel9.msdn.com/coding4fun/blog/A-modern-means-to-make-your-source-browsable-online\" rel=\"nofollow\">https://channel9.msdn.com/coding4fun/blog/A-modern-means-to-make-your-source-browsable-online</a></p>\n"}], "owner": {"reputation": 16, "user_id": 5497948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e803045aaf01e94ebd6a55c4a7ae74?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Deweer", "link": "https://stackoverflow.com/users/5497948/thomas-deweer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 2, "closed_date": 1446234204, "answer_count": 1, "score": -3, "last_activity_date": 1446345950, "creation_date": 1446057751, "last_edit_date": 1446345950, "question_id": 33399103, "link": "https://stackoverflow.com/questions/33399103/upload-and-display-net-source-code-on-my-website", "closed_reason": "Not suitable for this site", "title": "Upload and display .NET source code on my website", "body": "<p>So what I want is to upload my C# projects onto my website, which I can, and then make my website show the code of my projects very nicely and smooth.</p>\n\n<p>The best example you can compare this with is GitHub projects. For example: <a href=\"https://github.com/restsharp/RestSharp\" rel=\"nofollow\">https://github.com/restsharp/RestSharp</a> . It would be nice to support multiple langauges but C# is my main one. I don't want mine on GitHub but just on my website.</p>\n\n<p>Any help on finding a API for this or the nessecary source code?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "url", "uri", "webclient", "downloadfile"], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 4789261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6be00c69cb635fc2e404efca7df165b4?s=128&d=identicon&r=PG", "display_name": "Joshu&#39;s Mu", "link": "https://stackoverflow.com/users/4789261/joshus-mu"}, "edited": false, "score": 0, "creation_date": 1446060447, "post_id": 33399755, "comment_id": 54591199, "body": "The slashes were escaped by the @&quot;...&quot; causing the string to be taken as a string literal. However, you did hit the nail on the head - somehow the forward slashes were converted to backslashes (I probably did this by accident when writing tons of local filepaths). Showed this to several people and no one else noticed! Thank you so much for your keen eye! It is the little things in life..."}], "tags": [], "owner": {"reputation": 264, "user_id": 4747464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8ca9d8aefd8504d8a631ff0684c5e55?s=128&d=identicon&r=PG&f=1", "display_name": "acg_so", "link": "https://stackoverflow.com/users/4747464/acg-so"}, "is_accepted": true, "score": 3, "last_activity_date": 1446059988, "creation_date": 1446059988, "answer_id": 33399755, "question_id": 33399045, "link": "https://stackoverflow.com/questions/33399045/webclient-downloadfile-invalid-uri-the-hostname-could-not-be-parsed/33399755#33399755", "title": "WebClient.DownloadFile - Invalid URI: The hostname could not be parsed", "body": "<p>My first thought would be that your URI backslashes are being interpreted as escape characters, leading to a nonsense result after evaluation. I would try a quick test where each backslash is escaped as itself (i.e. \"\\\" instead of \"\\\" in each instance). I'm also a little puzzled as to why your URI is not using forward slashes...?</p>\n\n<pre><code>// Create an absolute Uri from a string.\nUri absoluteUri = new Uri(\"http://www.contoso.com/\");\n</code></pre>\n\n<p>Ref: <a href=\"https://msdn.microsoft.com/en-us/library/ceyeze4f(v=vs.110).aspx?cs-save-lang=1&amp;cs-lang=csharp#code-snippet-2\" rel=\"nofollow\">Uri Constructor on MSDN</a></p>\n"}], "owner": {"reputation": 136, "user_id": 4789261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6be00c69cb635fc2e404efca7df165b4?s=128&d=identicon&r=PG", "display_name": "Joshu&#39;s Mu", "link": "https://stackoverflow.com/users/4789261/joshus-mu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3001, "favorite_count": 0, "accepted_answer_id": 33399755, "answer_count": 1, "score": 0, "last_activity_date": 1446059988, "creation_date": 1446057534, "question_id": 33399045, "link": "https://stackoverflow.com/questions/33399045/webclient-downloadfile-invalid-uri-the-hostname-could-not-be-parsed", "title": "WebClient.DownloadFile - Invalid URI: The hostname could not be parsed", "body": "<p>So I tried this in several different formats and produced different results. I will include all relevant information below.</p>\n\n<p>My company uses a web-based application to schedule the generation of reports. The service emails a URL that can be clicked on and will immediately begin the \"Open Save As Cancel\" dialogue box. I am trying to automate the process of downloading these reports with a C# script as part of a Visual Studio project (the end goal is to import these reports in SQL Server).</p>\n\n<p>I am encountering terrible difficulty initiating the download of this file using WebClient Here is the closest I have gotten with any of the methods I have tried:</p>\n\n<p>*NOTE: I removed all identifying information from the URL, but left all special characters and the basic architecture intact. Hopefully this will be a happy medium between protecting confidential info and giving you enough to understand my dilemma. The URL <strong>does</strong> work when manually copied and pasted into the address bar of internet explorer.</p>\n\n<p>Error Message:</p>\n\n<p>\"Invalid URI: The hostname could not be parsed.\"</p>\n\n<pre><code>public void Main()\n{\nusing (var wc = new System.Net.WebClient())\n{\nwc.DownloadFile(\nnew Uri(@\"http:\\\\webapp.locality.company.com\\scripts\\rds\\cgigetf.exe?job_id=3058352&amp;file_id=1&amp;format=TAB\\report.tab\"), \n@\"\\\\server\\directory\\folder1\\folder2\\folder3\\...\\...\\...\\rawfile.tab\");\n        }\n   }\n</code></pre>\n\n<p>Note also that I have tried to set:</p>\n\n<pre><code>        string sourceUri = @\"http:\\\\webapp.locality.company.com\\scripts\\rds\\cgigetf.exe?job_id=3058352&amp;file_id=1&amp;format=TAB\\report.tab\\abc123_3058352.tab\";\n        Uri uriPath;\n        Uri.TryCreate(sourceUri, UriKind.Absolute, out uriPath);\n</code></pre>\n\n<p>But uriPath remains null - TryCreate fails.</p>\n\n<p>I have attempted doing a webrequest / webresponse / WebStream, but it still cannot find the host.</p>\n\n<p>I have tried including the download URL (as in my first code example) and the download URL + the file name (as in my second code example). I do not need the file name in the URL to initiate the download if I do it manually. I have also tried replacing the \"report.tab\" portion of the URL with the file name, but to no avail.</p>\n\n<p>Help is greatly appreciated as I have simply run out of thoughts on this one. The only idea I have left is that perhaps one of the special characters in my URL is getting in the way, but I don't know which one that would be or how to handle it properly.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c#", "bitmap", "comparison", "lockbits"], "comments": [{"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446058356, "post_id": 33399027, "comment_id": 54589968, "body": "Shouldn&#39;t this <code>byte* numPtr = (byte*)data.Scan0.ToPointer();</code> be <code>byte* numPtr = (byte*)numData.Scan0.ToPointer();</code>. Looks like you are comparing bitmap to itself :-)"}, {"owner": {"reputation": 339, "user_id": 4723364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29426fde6ce72ab44a4aa0deb2e96e73?s=128&d=identicon&r=PG&f=1", "display_name": "BrianH", "link": "https://stackoverflow.com/users/4723364/brianh"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446058933, "post_id": 33399027, "comment_id": 54590315, "body": "@IvanStoev YES! That work&#39;s perfectly. See - rookie mistake. If you make that an answer I&#39;ll accept it :) Thanks so much!"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446059276, "post_id": 33399027, "comment_id": 54590523, "body": "You welcome. I&#39;m not quite sure if I&#39;m supposed to post such as answer, but since you are asking, I will."}, {"owner": {"reputation": 339, "user_id": 4723364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29426fde6ce72ab44a4aa0deb2e96e73?s=128&d=identicon&r=PG&f=1", "display_name": "BrianH", "link": "https://stackoverflow.com/users/4723364/brianh"}, "reply_to_user": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446059582, "post_id": 33399027, "comment_id": 54590695, "body": "@IvanStoev It is the answer. It fixed the problem, and I appreciate that. I&#39;m just upset someone down-voted my question LOL"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1446060246, "post_id": 33399027, "comment_id": 54591095, "body": "No problem, that&#39;s easy fixable :-) Take care, mate."}], "answers": [{"tags": [], "owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "is_accepted": true, "score": 1, "last_activity_date": 1446059296, "creation_date": 1446059296, "answer_id": 33399572, "question_id": 33399027, "link": "https://stackoverflow.com/questions/33399027/comparing-images-using-lockbits-not-functioning-correctly/33399572#33399572", "title": "Comparing images using lockbits not functioning correctly", "body": "<p>There is a (probably copy/paste) mistake in the following line</p>\n\n<pre><code>byte* numPtr = (byte*)data.Scan0.ToPointer();\n</code></pre>\n\n<p>which is causing comparing the bitmap to itself. It should be</p>\n\n<pre><code>byte* numPtr = (byte*)numData.Scan0.ToPointer();\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 4723364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29426fde6ce72ab44a4aa0deb2e96e73?s=128&d=identicon&r=PG&f=1", "display_name": "BrianH", "link": "https://stackoverflow.com/users/4723364/brianh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 33399572, "answer_count": 1, "score": 0, "last_activity_date": 1446059296, "creation_date": 1446057469, "last_edit_date": 1492087233, "question_id": 33399027, "link": "https://stackoverflow.com/questions/33399027/comparing-images-using-lockbits-not-functioning-correctly", "title": "Comparing images using lockbits not functioning correctly", "body": "<p>I am trying to perform a basic number-only OCR on an image by comparing it to bitmaps of the numbers 0 - 9, using the code below. I have tried to follow the code in the answer to <a href=\"https://codereview.stackexchange.com/questions/39980/determining-if-2-images-are-the-same\">this question</a>, but it is not returning the correct results. There are 2 main issues that I am facing: </p>\n\n<p>1: If the program determines that the number 0 is present at any given point, then it also determines that 1, 2, 3, ... , and 9 are present at that location, which is obviously not true.</p>\n\n<p>2: The locations that it finds numbers in ... most of the locations are blank (white) spaces.</p>\n\n<p>I'll be the first to admit that using the lockbits method is new to me, as I usually use the getPixel() method of comparing, but it was far too slow for this project, so I may be making a rookie mistake or 2. </p>\n\n<p>Thanks for the help!!!</p>\n\n<p>P.S. The image to OCR is RTA, and I believe everything else is self-explanatory.</p>\n\n<pre><code>void newOCR()\n    {\n        Rectangle rect = new Rectangle(0, 0, 8, 9);\n        Rectangle numRect = new Rectangle(0, 0, 8, 9);\n\n        for (int i = 0; i &lt; RTA.Width - 8; i++)\n        {\n            for (int j = 0; j &lt; RTA.Height - 9; j++)\n            {\n                rect.Location = new Point(i, j);\n                for (int n = 0; n &lt; numbers.Length; n++)\n                {\n                    System.Drawing.Imaging.BitmapData data = RTA.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadOnly, RTA.PixelFormat);\n                    System.Drawing.Imaging.BitmapData numData = numbers[n].LockBits(numRect, System.Drawing.Imaging.ImageLockMode.ReadOnly, numbers[n].PixelFormat);\n\n                    unsafe\n                    {\n                        byte* ptr = (byte*)data.Scan0.ToPointer();\n                        byte* numPtr = (byte*)data.Scan0.ToPointer();\n\n                        int width = rect.Width * Image.GetPixelFormatSize(data.PixelFormat) / 8;\n                        for(int y = 0; y &lt; rect.Height; y++)\n                        {\n                            bool outBreak = false;\n                            for(int x = 0; x &lt; width; x++)\n                            {\n                                if(*ptr != *numPtr)\n                                {\n                                    outBreak = true;\n                                    break;\n                                }\n                                else if(y == rect.Height - 1 &amp;&amp; x == width - 1)\n                                {\n                                    timeDict.Add(new Point(i, j), n);\n                                }\n\n                                ptr++;\n                                numPtr++;\n                            }\n\n                            if(outBreak)\n                            {\n                                break;\n                            }\n\n                            ptr += data.Stride - width;\n                            numPtr += numData.Stride - width;\n                        }\n\n                        RTA.UnlockBits(data);\n                        numbers[n].UnlockBits(numData);\n                    }\n                }\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "entity-framework", "asp.net-web-api2", "ef-database-first"], "answers": [{"tags": [], "owner": {"reputation": 13861, "user_id": 1071632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xkf8n.jpg?s=128&g=1", "display_name": "Sam FarajpourGhamari", "link": "https://stackoverflow.com/users/1071632/sam-farajpourghamari"}, "is_accepted": false, "score": 7, "last_activity_date": 1446241360, "creation_date": 1446241360, "answer_id": 33445340, "question_id": 33398961, "link": "https://stackoverflow.com/questions/33398961/db-first-authentication-confusion-with-asp-net-web-api-2-ef6/33445340#33445340", "title": "DB-First authentication confusion with ASP.NET Web API 2 + EF6", "body": "<p>Since your DB schema are not compatible with default <code>UserStore</code> You must implement your own <code>UserStore</code> and <code>UserPasswordStore</code> classes then inject them to <code>UserManager</code>. Consider this simple example:</p>\n\n<p>First write your custom user class and implement <code>IUser</code> interface:</p>\n\n<pre><code>class User:IUser&lt;int&gt;\n{\n    public int ID {get;set;}\n    public string Username{get;set;}\n    public string Password_hash {get;set;}\n    // some other properties \n}\n</code></pre>\n\n<p>Now author your custom <code>UserStore</code> and <code>IUserPasswordStore</code> class like this:</p>\n\n<pre><code>public class MyUserStore : IUserStore&lt;User&gt;, IUserPasswordStore&lt;User&gt;\n{\n    private readonly MyDbContext _context;\n\n    public MyUserStore(MyDbContext context)\n    {\n        _context=context;\n    }\n\n    public Task CreateAsync(AppUser user)\n    {\n        // implement your desired logic such as\n        // _context.Users.Add(user);\n    }\n\n    public Task DeleteAsync(AppUser user)\n    {\n        // implement your desired logic\n    }\n\n    public Task&lt;AppUser&gt; FindByIdAsync(string userId)\n    {\n        // implement your desired logic\n    }\n\n    public Task&lt;AppUser&gt; FindByNameAsync(string userName)\n    {\n        // implement your desired logic\n    }\n\n    public Task UpdateAsync(AppUser user)\n    {\n        // implement your desired logic\n    }\n\n    public void Dispose()\n    {\n        // implement your desired logic\n    }\n\n    // Following 3 methods are needed for IUserPasswordStore\n    public Task&lt;string&gt; GetPasswordHashAsync(AppUser user)\n    {\n        // something like this:\n        return Task.FromResult(user.Password_hash);\n    }\n\n    public Task&lt;bool&gt; HasPasswordAsync(AppUser user)\n    {\n        return Task.FromResult(user.Password_hash != null);\n    }\n\n    public Task SetPasswordHashAsync(AppUser user, string passwordHash)\n    {\n        user.Password_hash = passwordHash;\n        return Task.FromResult(0);\n    }\n}\n</code></pre>\n\n<p>Now you have very own user store simply inject it to the user manager:</p>\n\n<pre><code>public class ApplicationUserManager: UserManager&lt;User, int&gt;\n{\n    public static ApplicationUserManager Create(IdentityFactoryOptions&lt;ApplicationUserManager&gt; options, IOwinContext context)\n    {\n         var manager = new ApplicationUserManager(new MyUserStore(context.Get&lt;MyDbContext&gt;()));\n         // rest of code\n    }\n}\n</code></pre>\n\n<p>Also please note you must directly inherit your DB Context class from <code>DbContext</code> not <code>IdentityDbContext</code> since you have implemented own user store.</p>\n"}, {"comments": [{"owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1446839230, "post_id": 33546674, "comment_id": 54927011, "body": "Thanks, this is what I was looking for. Sorry if my question was unclear, but I was confused by the &quot;role&quot; of ASP.NET Identity."}, {"owner": {"reputation": 11504, "user_id": 1148153, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/PnJGH.jpg?s=128&g=1", "display_name": "Fabio Luz", "link": "https://stackoverflow.com/users/1148153/fabio-luz"}, "reply_to_user": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "edited": false, "score": 0, "creation_date": 1446841623, "post_id": 33546674, "comment_id": 54928283, "body": "You are welcome mate. If you have some trouble on the implementation, don&#39;t hesitate to comment here"}, {"owner": {"reputation": 837, "user_id": 1525289, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29f7893d436426a1a6aa6dd32527b1e8?s=128&d=identicon&r=PG", "display_name": "Savail", "link": "https://stackoverflow.com/users/1525289/savail"}, "edited": false, "score": 1, "creation_date": 1450819035, "post_id": 33546674, "comment_id": 56590737, "body": "Hey, could you tell me what would be the userService object in your code above? Just a custom class object which would connect to my DB Context and return my custom User from DB? The User doesn&#39;t have to inherit after IUser or anything?"}, {"owner": {"reputation": 11504, "user_id": 1148153, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/PnJGH.jpg?s=128&g=1", "display_name": "Fabio Luz", "link": "https://stackoverflow.com/users/1148153/fabio-luz"}, "edited": false, "score": 2, "creation_date": 1450830428, "post_id": 33546674, "comment_id": 56594810, "body": "Yes, it is a custom class which retrieves the user from database. And yes, User doesn&#39;t have to inherit from anything, because in the above example, Identity is not being used."}, {"owner": {"reputation": 837, "user_id": 1525289, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29f7893d436426a1a6aa6dd32527b1e8?s=128&d=identicon&r=PG", "display_name": "Savail", "link": "https://stackoverflow.com/users/1525289/savail"}, "edited": false, "score": 1, "creation_date": 1450863105, "post_id": 33546674, "comment_id": 56605802, "body": "Thanks a lot! I finally managed to get the authentication working! The problem was also that many things happen automatically and are not so obvious like automatic search of OWIN Startup called class in assemblies."}, {"owner": {"reputation": 95, "user_id": 1574861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e57ceb0b0d20818276a1e2d3cee9ed?s=128&d=identicon&r=PG", "display_name": "Miguel Hughes", "link": "https://stackoverflow.com/users/1574861/miguel-hughes"}, "edited": false, "score": 0, "creation_date": 1480369258, "post_id": 33546674, "comment_id": 68924598, "body": "I also had to install package <code>Microsoft.Owin.Cors</code> for this to work"}, {"owner": {"reputation": 571, "user_id": 1648559, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92557c35c93ec5487813516d6cfe73f8?s=128&d=identicon&r=PG", "display_name": "Sometimes Code", "link": "https://stackoverflow.com/users/1648559/sometimes-code"}, "edited": false, "score": 0, "creation_date": 1481697067, "post_id": 33546674, "comment_id": 69475732, "body": "@FabioLuz  GrantResourceOwnerCredentials method not hitting? Am i missing something?"}, {"owner": {"reputation": 198, "user_id": 1916015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3b1e564e92dbabd4a6d111fa34ce010?s=128&d=identicon&r=PG", "display_name": "user1916015", "link": "https://stackoverflow.com/users/1916015/user1916015"}, "edited": false, "score": 0, "creation_date": 1531008520, "post_id": 33546674, "comment_id": 89435674, "body": "It throws me an error: &quot;No HTTP resource was found that matches the request URI &#39;<a href=\"http://localhost:50013/api/security/token?grant_type=password&amp;username=User1&amp;password=aaaa\" rel=\"nofollow noreferrer\">localhost:50013/api/security/&hellip;</a>&quot;. Any ideas?"}, {"owner": {"reputation": 107, "user_id": 5677188, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/NWAEP.jpg?s=128&g=1", "display_name": "Chanchal Zoarder", "link": "https://stackoverflow.com/users/5677188/chanchal-zoarder"}, "edited": false, "score": 0, "creation_date": 1589485260, "post_id": 33546674, "comment_id": 109321668, "body": "Can I put logged in UserId and retrieve it from the controller like User.Identity.GetUserId()"}], "tags": [], "owner": {"reputation": 11504, "user_id": 1148153, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/PnJGH.jpg?s=128&g=1", "display_name": "Fabio Luz", "link": "https://stackoverflow.com/users/1148153/fabio-luz"}, "is_accepted": true, "score": 23, "last_activity_date": 1568301728, "last_edit_date": 1568301728, "creation_date": 1446732460, "answer_id": 33546674, "question_id": 33398961, "link": "https://stackoverflow.com/questions/33398961/db-first-authentication-confusion-with-asp-net-web-api-2-ef6/33546674#33546674", "title": "DB-First authentication confusion with ASP.NET Web API 2 + EF6", "body": "<p>You say:</p>\n\n<blockquote>\n  <p>I want to implement a login/registration system (so that I can\n  implement roles and permissions in the future, and restrict certain\n  API requests).</p>\n  \n  <p>How do I setup authentication in a Web API 2 application, having an\n  existing user entity?</p>\n</blockquote>\n\n<p>It definitely means that you <strong>DO NOT</strong> need ASP.NET Identity. ASP.NET Identity is a technology to handle all users stuffs. It actually does not \"make\" the authentication mechanism. ASP.NET Identity uses OWIN Authentication mechanism, which is another thing.</p>\n\n<p>What you are looking for is not <strong>\"how to use ASP.NET Identity with my existing Users table\"</strong>, but <strong>\"How to configure OWIN Authentication using my existing Users table\"</strong></p>\n\n<p>To use OWIN Auth follow these steps:</p>\n\n<p>Install the packages:</p>\n\n<pre><code>Owin\nMicrosoft.AspNet.Cors\nMicrosoft.AspNet.WebApi.Client\nMicrosoft.AspNet.WebApi.Core\nMicrosoft.AspNet.WebApi.Owin\nMicrosoft.AspNet.WebApi.WebHost\nMicrosoft.Owin\nMicrosoft.Owin.Cors\nMicrosoft.Owin.Host.SystemWeb\nMicrosoft.Owin.Security\nMicrosoft.Owin.Security.OAuth\n</code></pre>\n\n<p>Create <code>Startup.cs</code> file inside the root folder (example):</p>\n\n<p><strong>make sure that [assembly: OwinStartup] is correctly configured</strong></p>\n\n<pre><code>[assembly: OwinStartup(typeof(YourProject.Startup))]\nnamespace YourProject\n{\n    public class Startup\n    {\n        public void Configuration(IAppBuilder app)\n        {\n            var config = new HttpConfiguration();\n            //other configurations\n\n            ConfigureOAuth(app);\n            app.UseCors(Microsoft.Owin.Cors.CorsOptions.AllowAll);\n            app.UseWebApi(config);\n        }\n\n        public void ConfigureOAuth(IAppBuilder app)\n        {\n            var oAuthServerOptions = new OAuthAuthorizationServerOptions()\n            {\n                AllowInsecureHttp = true,\n                TokenEndpointPath = new PathString(\"/api/security/token\"),\n                AccessTokenExpireTimeSpan = TimeSpan.FromHours(2),\n                Provider = new AuthorizationServerProvider()\n            };\n\n            app.UseOAuthAuthorizationServer(oAuthServerOptions);\n            app.UseOAuthBearerAuthentication(new OAuthBearerAuthenticationOptions());\n        }\n    }\n\n    public class AuthorizationServerProvider : OAuthAuthorizationServerProvider\n    {\n        public override async Task ValidateClientAuthentication(OAuthValidateClientAuthenticationContext context)\n        {\n            context.Validated();\n        }\n\n        public override async Task GrantResourceOwnerCredentials(OAuthGrantResourceOwnerCredentialsContext context)\n        {\n            context.OwinContext.Response.Headers.Add(\"Access-Control-Allow-Origin\", new[] { \"*\" });\n\n            try\n            {\n                //retrieve your user from database. ex:\n                var user = await userService.Authenticate(context.UserName, context.Password);\n\n                var identity = new ClaimsIdentity(context.Options.AuthenticationType);\n\n                identity.AddClaim(new Claim(ClaimTypes.Name, user.Name));\n                identity.AddClaim(new Claim(ClaimTypes.Email, user.Email));\n\n                //roles example\n                var rolesTechnicalNamesUser = new List&lt;string&gt;();\n\n                if (user.Roles != null)\n                {\n                    rolesTechnicalNamesUser = user.Roles.Select(x =&gt; x.TechnicalName).ToList();\n\n                    foreach (var role in user.Roles)\n                        identity.AddClaim(new Claim(ClaimTypes.Role, role.TechnicalName));\n                }\n\n                var principal = new GenericPrincipal(identity, rolesTechnicalNamesUser.ToArray());\n\n                Thread.CurrentPrincipal = principal;\n\n                context.Validated(identity);\n            }\n            catch (Exception ex)\n            {\n                context.SetError(\"invalid_grant\", \"message\");\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Use the <code>[Authorize]</code> attribute to authorize the actions.</p>\n\n<p>Call <code>api/security/token</code> with <code>GrantType</code>, <code>UserName</code>, and <code>Password</code> to get the bearer token. Like this:</p>\n\n<pre><code>\"grant_type=password&amp;username=\" + username + \"&amp;password=\" password;\n</code></pre>\n\n<p>Send the token within the <code>HttpHeader Authorization</code> as <code>Bearer \"YOURTOKENHERE\"</code>. Like this:</p>\n\n<pre><code>headers: { 'Authorization': 'Bearer ' + token }\n</code></pre>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 82712, "user_id": 598696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k1Yif.png?s=128&g=1", "display_name": "Vittorio Romeo", "link": "https://stackoverflow.com/users/598696/vittorio-romeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9039, "favorite_count": 10, "accepted_answer_id": 33546674, "answer_count": 2, "score": 15, "last_activity_date": 1568301728, "creation_date": 1446057250, "question_id": 33398961, "link": "https://stackoverflow.com/questions/33398961/db-first-authentication-confusion-with-asp-net-web-api-2-ef6", "title": "DB-First authentication confusion with ASP.NET Web API 2 + EF6", "body": "<p>I need to create a Web API C# application for an existing MySQL database. I've managed to use Entity Framework 6 to bind every database table to a RESTful API <em>(that allows CRUD operations)</em>.</p>\n\n<p>I want to implement a login/registration system <em>(so that I can implement roles and permissions in the future, and restrict certain API requests)</em>.</p>\n\n<p>The MySQL database I have to use has a table for users <em>(called <code>user</code>)</em> that has the following self-explanatory columns:</p>\n\n<ul>\n<li><code>id</code></li>\n<li><code>email</code></li>\n<li><code>username</code></li>\n<li><code>password_hash</code></li>\n</ul>\n\n<p>It seems that the de-facto standard for authentication is ASP.Net Identity. I have spent the last hour trying to figure out how to make Identity work with an existing DB-First Entity Framework setup.</p>\n\n<p>If I try to construct <code>ApplicationUser</code> instances storing <code>user</code> instances <em>(entities from the MySQL database)</em> to retrieve user data, I get the following error:</p>\n\n<blockquote>\n  <p>The entity type ApplicationUser is not part of the model for the current context.</p>\n</blockquote>\n\n<p>I assume I need to store Identity data in my MySQL database, but couldn't find any resource on how to do that. I've tried completely removing the <code>ApplicationUser</code> class and making my <code>user</code> entity class derive from <code>IdentityUser</code>, but calling <code>UserManager.CreateAsync</code> resulted in LINQ to Entities conversion errors.</p>\n\n<p><strong>How do I setup authentication in a Web API 2 application, having an existing <code>user</code> entity?</strong></p>\n"}, {"tags": ["c#", "actor", "akka.net"], "answers": [{"tags": [], "owner": {"reputation": 6652, "user_id": 2721139, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/8beJH.jpg?s=128&g=1", "display_name": "Bartosz Sypytkowski", "link": "https://stackoverflow.com/users/2721139/bartosz-sypytkowski"}, "is_accepted": true, "score": 5, "last_activity_date": 1446115270, "creation_date": 1446115270, "answer_id": 33412000, "question_id": 33398923, "link": "https://stackoverflow.com/questions/33398923/akka-net-waiting-for-multiple-pieces-of-data/33412000#33412000", "title": "Akka.net waiting for multiple pieces of data", "body": "<p>The common solution for that is attaching some kind of correlation id shared by both request and response messages - since actor processes messages synchronously, this could be unchecked int/long counter.</p>\n\n<p>You simply store correlation ids in some data structure (let say set) inside the caller, and when response is received, remove it's correlation id from set. <code>WaitAll</code> finishes basically when set is empty or timeout occurs. </p>\n\n<p>You can set timeout by using <code>Context.SetReceiveTimeout(timeout)</code>, this way actor will send a <code>ReceiveTimeout</code> method to itself after it haven't received any message for some time.</p>\n\n<p>This behavior is pretty generic and may be abstracted quite easily.</p>\n"}, {"tags": [], "owner": {"reputation": 425, "user_id": 2211001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3b194eb1c91710f8cbb4808d0c9ad4c?s=128&d=identicon&r=PG", "display_name": "Morgan Skinner", "link": "https://stackoverflow.com/users/2211001/morgan-skinner"}, "is_accepted": false, "score": 2, "last_activity_date": 1448149692, "creation_date": 1448149692, "answer_id": 33850022, "question_id": 33398923, "link": "https://stackoverflow.com/questions/33398923/akka-net-waiting-for-multiple-pieces-of-data/33850022#33850022", "title": "Akka.net waiting for multiple pieces of data", "body": "<p>The simplest way to do this would be to increment a \"vote\" count on the master when each child replies. When vote == child count, you're done.</p>\n\n<p>You could extend this so as to only count the first message from each child, or a specific message from each child, but it all boils down to counting in the end.</p>\n"}], "owner": {"reputation": 4800, "user_id": 707088, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ebe9cfae7adb46f8a65144a9ae9f5896?s=128&d=identicon&r=PG", "display_name": "Kyle Gobel", "link": "https://stackoverflow.com/users/707088/kyle-gobel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 1, "accepted_answer_id": 33412000, "answer_count": 2, "score": 9, "last_activity_date": 1448149692, "creation_date": 1446057124, "question_id": 33398923, "link": "https://stackoverflow.com/questions/33398923/akka-net-waiting-for-multiple-pieces-of-data", "title": "Akka.net waiting for multiple pieces of data", "body": "<p>This is a common scenario I run into, where I have two (or more) actors getting some data asynchronously, and then I need to do an operation when they're all finished.</p>\n\n<p>What is the common pattern to do this?</p>\n\n<p>Here's a simplified example.</p>\n\n<pre><code>public MasterActor : ReceiveActor\n{\n     public MasterActor() \n     {\n          Initialize();\n     }\n\n     public void Initiaize()\n     {\n         Receive&lt;DoSomeWork&gt;(_ =&gt; \n         {\n              var actor1 = Context.ActorOf(Props.Create(() =&gt; new Actor1());\n              var actor2 = Context.ActorOf(Props.Create(() =&gt; new Actor2());\n\n              // pretend these actors send responses to their senders\n              // for sake of example each of these methods take between 1 and 3 seconds\n              actor1.Tell(new GetActor1Data());\n              actor2.Tell(new GetActor2Data());\n         });\n\n        Receive&lt;Actor1Response&gt;(m =&gt; \n        {\n             //actor 1 has finished it's work\n        });\n\n        Receive&lt;Actor2Response&gt;(m =&gt; \n        {\n             //actor 2 has finished it's work\n        });\n     }\n}\n</code></pre>\n\n<p>To kick this off I send the <code>MasterActor</code> a <code>DoSomeWork</code> message.  </p>\n\n<p>What is the common way to do an operation when I have both a <code>Actor1Response</code> and an <code>Actor2Response</code>.  </p>\n\n<p>I don't really want to have logic in each receive handler checking if the other one is finished or anything like that.  I guess what i'm thinking of something similar to a <code>Task.WaitAll()</code> method.</p>\n\n<p>Am I just attacking the problem the wrong way?  Do I need to re-write the actors in a different way?</p>\n\n<p>Any common patterns or solutions would be awesome.</p>\n"}]