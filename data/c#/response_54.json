[{"tags": ["c#", "visual-studio-2008", "t4"], "comments": [{"owner": {"reputation": 1143, "user_id": 2214462, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bLarQ.jpg?s=128&g=1", "display_name": "Mathemats", "link": "https://stackoverflow.com/users/2214462/mathemats"}, "edited": false, "score": 0, "creation_date": 1453333976, "post_id": 34912906, "comment_id": 57561310, "body": "Are you trying to edit the project file of the currently opened project?"}, {"owner": {"reputation": 3592, "user_id": 1339704, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/57cb97f89a82b5b39c8e73e3f29137d8?s=128&d=identicon&r=PG", "display_name": "Soenhay", "link": "https://stackoverflow.com/users/1339704/soenhay"}, "reply_to_user": {"reputation": 1143, "user_id": 2214462, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bLarQ.jpg?s=128&g=1", "display_name": "Mathemats", "link": "https://stackoverflow.com/users/2214462/mathemats"}, "edited": false, "score": 0, "creation_date": 1453334294, "post_id": 34912906, "comment_id": 57561438, "body": "No, I am not trying to edit the file. I am just trying to read the file."}, {"owner": {"reputation": 3592, "user_id": 1339704, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/57cb97f89a82b5b39c8e73e3f29137d8?s=128&d=identicon&r=PG", "display_name": "Soenhay", "link": "https://stackoverflow.com/users/1339704/soenhay"}, "reply_to_user": {"reputation": 1143, "user_id": 2214462, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bLarQ.jpg?s=128&g=1", "display_name": "Mathemats", "link": "https://stackoverflow.com/users/2214462/mathemats"}, "edited": false, "score": 0, "creation_date": 1453334463, "post_id": 34912906, "comment_id": 57561488, "body": "I am pretty sure that it doesn&#39;t work because it is an open file but I thought I would ask anyway."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 2338057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a7d49660246214b077e53e57e42ae94?s=128&d=identicon&r=PG", "display_name": "CodeIsArt", "link": "https://stackoverflow.com/users/2338057/codeisart"}, "is_accepted": true, "score": 1, "last_activity_date": 1453413513, "creation_date": 1453413513, "answer_id": 34935115, "question_id": 34912906, "link": "https://stackoverflow.com/questions/34912906/how-can-i-access-the-csproj-file-via-a-t4-text-template-in-visual-studio-2008/34935115#34935115", "title": "How can I access the csproj file via a T4 text template in Visual Studio 2008?", "body": "<p>Try this method for getting the .csproj path...</p>\n\n<pre><code>string csprojPath = Host.TemplateFile.Replace(Path.GetFileName(Host.TemplateFile), \"ProjectName.csproj\");\n</code></pre>\n\n<p>'Host.Templatefile' gets the path for the 'TemplateFileName.tt'</p>\n\n<p>This is assuming that the .TT file is in the same folder as your .csproj</p>\n"}], "owner": {"reputation": 3592, "user_id": 1339704, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/57cb97f89a82b5b39c8e73e3f29137d8?s=128&d=identicon&r=PG", "display_name": "Soenhay", "link": "https://stackoverflow.com/users/1339704/soenhay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 34935115, "answer_count": 1, "score": 2, "last_activity_date": 1453413513, "creation_date": 1453333825, "question_id": 34912906, "link": "https://stackoverflow.com/questions/34912906/how-can-i-access-the-csproj-file-via-a-t4-text-template-in-visual-studio-2008", "title": "How can I access the csproj file via a T4 text template in Visual Studio 2008?", "body": "<p>How can I access the csproj file via a T4 text template in Visual Studio 2008?</p>\n\n<p>I have tried this but it does not work:</p>\n\n<pre><code>using(StreamReader assemblyInfoReader = File.OpenText(Host.ResolvePath(\"ProjectName.csproj\")))\n{\n ...\n}\n</code></pre>\n\n<p>The error message I get is \"Unable to locate file\".</p>\n\n<p>When I type the absolute path the message I get is \"The length cannot be zero\".</p>\n\n<p>When I try to open a different file such as AssemblyInfo.cs it works fine.</p>\n\n<p>As an aside, I am trying to access the ApplicationVersion tag from within the csproj file. This is different from what is returned from:</p>\n\n<pre><code>Assembly.GetExecutingAssembly().GetName().Version.ToString();\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 31846, "user_id": 281678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfwnN.jpg?s=128&g=1", "display_name": "Dan Puzey", "link": "https://stackoverflow.com/users/281678/dan-puzey"}, "edited": false, "score": 3, "creation_date": 1453333613, "post_id": 34912829, "comment_id": 57561182, "body": "What about your existing code is not working? <code>acc1.ACCSaldo</code> should work fine; are you seeing an error?"}, {"owner": {"reputation": 11, "user_id": 5818535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1eb67d7b55fc9c2b8e2387ae71e1b1e?s=128&d=identicon&r=PG&f=1", "display_name": "morqe", "link": "https://stackoverflow.com/users/5818535/morqe"}, "reply_to_user": {"reputation": 31846, "user_id": 281678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfwnN.jpg?s=128&g=1", "display_name": "Dan Puzey", "link": "https://stackoverflow.com/users/281678/dan-puzey"}, "edited": false, "score": 0, "creation_date": 1453334716, "post_id": 34912829, "comment_id": 57561566, "body": "That would be fine in main part of program after creating acc1."}, {"owner": {"reputation": 31846, "user_id": 281678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfwnN.jpg?s=128&g=1", "display_name": "Dan Puzey", "link": "https://stackoverflow.com/users/281678/dan-puzey"}, "edited": false, "score": 0, "creation_date": 1453334876, "post_id": 34912829, "comment_id": 57561618, "body": "Do you mean that you want to be able to access <code>acc1</code> in a <i>different</i> method to the one you&#39;ve already got?"}, {"owner": {"reputation": 11, "user_id": 5818535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1eb67d7b55fc9c2b8e2387ae71e1b1e?s=128&d=identicon&r=PG&f=1", "display_name": "morqe", "link": "https://stackoverflow.com/users/5818535/morqe"}, "reply_to_user": {"reputation": 31846, "user_id": 281678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NfwnN.jpg?s=128&g=1", "display_name": "Dan Puzey", "link": "https://stackoverflow.com/users/281678/dan-puzey"}, "edited": false, "score": 0, "creation_date": 1453335392, "post_id": 34912829, "comment_id": 57561768, "body": "What I&#39;m after is a method that is inside ATM class and can be used in main program. Something like:      public static void writeSaldo()             {                 double x;                 x = ACC.ACCSaldo;                 Console.WriteLine(&quot;You got {0} dolars.&quot;, x);             }   And then in main part I should write something like: ATM.writeSaldo();"}, {"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 1, "creation_date": 1453336157, "post_id": 34912829, "comment_id": 57561982, "body": "I know you did not ask this, but you should use <code>decimal</code> for monetary amounts, not <code>double</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 1386080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfe10e5ca4bc8da639ab6f53f53bd61c?s=128&d=identicon&r=PG", "display_name": "Tony XU", "link": "https://stackoverflow.com/users/1386080/tony-xu"}, "is_accepted": false, "score": 1, "last_activity_date": 1453336736, "last_edit_date": 1453336736, "creation_date": 1453334422, "answer_id": 34913010, "question_id": 34912829, "link": "https://stackoverflow.com/questions/34912829/how-to-get-value-from-object-in-c/34913010#34913010", "title": "How to get value from object in C#", "body": "<p>If there is only one Account in the ATM, you can declare a ACC instance (e.g. _acc) in the ATM; You need to initialise in your main method, then you can do sth like:</p>\n\n<pre><code>public void DisplayAccountDetails()\n{\n   Console.Write(String.Format(\"Account Balance:{0}\", _acc.ACCSaldo));\n}\n</code></pre>\n\n<p>I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "is_accepted": false, "score": 0, "last_activity_date": 1453336600, "last_edit_date": 1453336600, "creation_date": 1453335639, "answer_id": 34913206, "question_id": 34912829, "link": "https://stackoverflow.com/questions/34912829/how-to-get-value-from-object-in-c/34913206#34913206", "title": "How to get value from object in C#", "body": "<p>Assuming there is only one account in the ATM class and it looks similar to the follow:</p>\n\n<pre><code>public class ATM\n{\n    public ACC Acc;\n}\n</code></pre>\n\n<p>You can add a method inside the ATM class like the following:</p>\n\n<pre><code>public void WriteSaldo()\n{\n    Console.WriteLine(\"Saldo: {0}\", Acc.ACCSaldo);\n}\n</code></pre>\n\n<p>Then in your <code>Main</code> method you can use <code>ATM01.WriteSaldo();</code></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5818535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1eb67d7b55fc9c2b8e2387ae71e1b1e?s=128&d=identicon&r=PG&f=1", "display_name": "morqe", "link": "https://stackoverflow.com/users/5818535/morqe"}, "edited": false, "score": 0, "creation_date": 1453336036, "post_id": 34913246, "comment_id": 57561942, "body": "Sorry to say this but I don&#39;t know what get; set; is and how to use it."}, {"owner": {"reputation": 455, "user_id": 4557802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OwLEl.jpg?s=128&g=1", "display_name": "Nicholas Ramsay", "link": "https://stackoverflow.com/users/4557802/nicholas-ramsay"}, "reply_to_user": {"reputation": 11, "user_id": 5818535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1eb67d7b55fc9c2b8e2387ae71e1b1e?s=128&d=identicon&r=PG&f=1", "display_name": "morqe", "link": "https://stackoverflow.com/users/5818535/morqe"}, "edited": false, "score": 1, "creation_date": 1453336361, "post_id": 34913246, "comment_id": 57562033, "body": "Instead of just declaring the variable in your class for example: public double ACCSaldo;  , what you can do is in the declaration give it get and set properties, do this by putting {get; set;} after it. The get allows another class to get the value, while the set allows you to set the value. If you need any other explanation there are many tutorials on the internet just search get and set properties. This should definitely fix your problem."}], "tags": [], "owner": {"reputation": 455, "user_id": 4557802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OwLEl.jpg?s=128&g=1", "display_name": "Nicholas Ramsay", "link": "https://stackoverflow.com/users/4557802/nicholas-ramsay"}, "is_accepted": false, "score": 1, "last_activity_date": 1453335830, "creation_date": 1453335830, "answer_id": 34913246, "question_id": 34912829, "link": "https://stackoverflow.com/questions/34912829/how-to-get-value-from-object-in-c/34913246#34913246", "title": "How to get value from object in C#", "body": "<p>You could add get and set properties. \n    public double ACCSaldo{\n        get;\n        set;\n    }</p>\n"}], "owner": {"reputation": 11, "user_id": 5818535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1eb67d7b55fc9c2b8e2387ae71e1b1e?s=128&d=identicon&r=PG&f=1", "display_name": "morqe", "link": "https://stackoverflow.com/users/5818535/morqe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1453336736, "creation_date": 1453333459, "last_edit_date": 1453334938, "question_id": 34912829, "link": "https://stackoverflow.com/questions/34912829/how-to-get-value-from-object-in-c", "title": "How to get value from object in C#", "body": "<p>I'm writing a simple ATM program in C# and it is suppose to be Object Oriented.\nI created a public class ATM and inside it a another public class ACC (account).\nHow can i create method inside ATM class to write how much money is in ATM.ACC.ACCSaldo?</p>\n\n<pre><code>public class ACC\n{\n    public int ACCNr;       //accaunt number\n    public int ACCPIN;      //PIN number\n    public double ACCSaldo; //How much money is in account\n\n    //constr\n    public ACC(int p, int p2, double p3)\n    {\n        ACCNr = p;\n        ACCPIN = p2;\n        ACCSaldo = p3;\n    }\n}\n</code></pre>\n\n<p>My main part of code looks like this:</p>\n\n<pre><code>static void Main(string[] args)\n{\n    ATM ATM01 = new ATM();\n\n    ATM.ACC acc1 = new ATM.ACC(3333, 1234, 3000.53);\n\n    acc1.ACCNr = ATM01.czytnik();\n\n    Console.WriteLine(\"ACCNr: {0}\", acc1.ACCNr);\n    Console.WriteLine(\"PIN: {0}\", acc1.ACCPIN);\n    Console.WriteLine(\"Saldo: {0}\", acc1.ACCSaldo);\n\n    ATM.tstPIN tstPIN1 = new ATM.tstPIN(acc1.ACCNr, acc1.ACCPIN ,acc1.ACCSaldo);\n    tstPIN1.test();\n\n    ATM.menu();\n\n    // Keep the console window open in debug mode.\n    Console.WriteLine(\"Press any key to exit.\");\n    Console.ReadKey();\n}   \n</code></pre>\n"}, {"tags": ["c#", "mysql"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1453339749, "post_id": 34912774, "comment_id": 57563022, "body": "dont concat SQL use Parameters <a href=\"https://imgs.xkcd.com/comics/exploits_of_a_mom.png\" rel=\"nofollow noreferrer\">imgs.xkcd.com/comics/exploits_of_a_mom.png</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12857, "user_id": 4802649, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e3863cbe82a27e2480b7a969af49fe1f?s=128&d=identicon&r=PG", "display_name": "Phiter", "link": "https://stackoverflow.com/users/4802649/phiter"}, "is_accepted": false, "score": 0, "last_activity_date": 1453333415, "creation_date": 1453333415, "answer_id": 34912818, "question_id": 34912774, "link": "https://stackoverflow.com/questions/34912774/can-i-create-several-different-insert-queries-under-one-connection-string-to-mys/34912818#34912818", "title": "Can I create several different insert queries under one connection string to Mysql?", "body": "<p>Well you can always run two queries using the same string.</p>\n\n<pre><code>string Query1 = \"insert into table1 (value) values('\" + value+ \"');\";\n\nstring Query2 = \"insert into table1 (value2) values('\" + value2+ \"');\";\n\nstring Query = Query1 + Query2;\n\nrun(Query) // &lt;--I forgot the actual command, but that's the logic.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "is_accepted": false, "score": 0, "last_activity_date": 1453334040, "creation_date": 1453334040, "answer_id": 34912947, "question_id": 34912774, "link": "https://stackoverflow.com/questions/34912774/can-i-create-several-different-insert-queries-under-one-connection-string-to-mys/34912947#34912947", "title": "Can I create several different insert queries under one connection string to Mysql?", "body": "<p>Yes, you can insert multiple values by separating them with commas, like so:</p>\n\n<p><code>string query = \"INSERT INTO table1 (value, value2) VALUES ('\" + value + \"', '\" + value2 + \"');\";</code></p>\n\n<p>You can also insert multiple rows by separating your values with commas, like so:</p>\n\n<p><code>string query = \"INSERT INTO table1 (value) VALUES ('\" + value1 + \"'), ('\" + value2 + \"');\";</code></p>\n"}], "owner": {"reputation": 65, "user_id": 5785542, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5515f6f11e090ca58f8f137562c02f69?s=128&d=identicon&r=PG&f=1", "display_name": "Coby Abutbul", "link": "https://stackoverflow.com/users/5785542/coby-abutbul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453371445, "creation_date": 1453333155, "last_edit_date": 1453371445, "question_id": 34912774, "link": "https://stackoverflow.com/questions/34912774/can-i-create-several-different-insert-queries-under-one-connection-string-to-mys", "title": "Can I create several different insert queries under one connection string to Mysql?", "body": "<p>After opening connection string to mysql database, can I create several different insert queries?\n(I must to separate them since the first query is in a loop).\nIf so, I would like to know the format.</p>\n\n<p>Example:</p>\n\n<pre><code>string myConnection = \"datasource=localhost;port=3306;username=root;password=123\";\n\nstring Query1 = \"insert into table1 (value1) values('\" + value1+ \"');\";\n\nstring Query2 = \"insert into table2 (value2) values('\" + value2+ \"');\";\n</code></pre>\n"}, {"tags": ["c#", ".net", "multithreading", "task-parallel-library"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 2, "creation_date": 1453349579, "post_id": 34912698, "comment_id": 57565591, "body": "The number of CPU cores."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 2, "creation_date": 1453378150, "post_id": 34912698, "comment_id": 57580246, "body": "@Enigmativity the number of cores has no meaning for IO-bound workloads and the TPL is clueless about IO."}, {"owner": {"reputation": 54181, "user_id": 9382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc7b9ac824e43ce9d62bf7dfb37b6393?s=128&d=identicon&r=PG", "display_name": "AngryHacker", "link": "https://stackoverflow.com/users/9382/angryhacker"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1453499761, "post_id": 34912698, "comment_id": 57644859, "body": "@Enigmativity So the default rule for TPL is to have a max thread count that is equal to the CPU count?"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1453505196, "post_id": 34912698, "comment_id": 57646914, "body": "@AngryHacker - Yes, that&#39;s my understanding."}, {"owner": {"reputation": 1150, "user_id": 987850, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/UQFy3.jpg?s=128&g=1", "display_name": "23W", "link": "https://stackoverflow.com/users/987850/23w"}, "edited": false, "score": 0, "creation_date": 1513539762, "post_id": 34912698, "comment_id": 82682082, "body": "Why do not change <code>Semaphore</code> to <code>SemaphoreSlim</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 2, "creation_date": 1453378404, "post_id": 34913057, "comment_id": 57580428, "body": "The TPL has no idea what the workload does. It <i>cannot possibly</i> be well-tuned for IO. The idea that the TPL &quot;will do the right thing&quot; is repeated all over the web but false. This question is a great example: 4 threads it a throughput-limiting choice."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5766999"}, "reply_to_user": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 1, "creation_date": 1453378529, "post_id": 34913057, "comment_id": 57580504, "body": "Hence why I said: &quot;a whole different story&quot;!"}, {"owner": {"reputation": 54181, "user_id": 9382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc7b9ac824e43ce9d62bf7dfb37b6393?s=128&d=identicon&r=PG", "display_name": "AngryHacker", "link": "https://stackoverflow.com/users/9382/angryhacker"}, "reply_to_user": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 1, "creation_date": 1453413737, "post_id": 34913057, "comment_id": 57603070, "body": "@usr Exactly my thoughts.  There is no way TPL knows anything about my workflow.  I ended up implementing it with <code>TaskCreationOptions.LongRunning</code> plus a Semaphore."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5766999"}, "is_accepted": true, "score": 19, "last_activity_date": 1453508759, "last_edit_date": 1453508759, "creation_date": 1453334716, "answer_id": 34913057, "question_id": 34912698, "link": "https://stackoverflow.com/questions/34912698/what-determines-the-number-of-threads-for-a-taskfactory-spawned-jobs/34913057#34913057", "title": "What determines the number of threads for a TaskFactory spawned jobs?", "body": "<p>When you are using a <code>Task</code> in .NET, you are telling the TPL to schedule a piece of work (via <code>TaskScheduler</code>) to be executed on the <code>ThreadPool</code>. Note that the work will be scheduled at its earliest opportunity and however the scheduler sees fit. This means that the <code>TaskScheduler</code> will decide how many threads will be used to run <code>n</code> number of tasks and which task is executed on which thread.</p>\n\n<p>The TPL is very well tuned and continues to adjust its algorithm as it executes your tasks. So, in most cases, it tries to minimize contention. What this means is if you are running 100 tasks and only have 4 cores (which you can get using <code>Environment.ProcessorCount</code>), it would not make sense to execute more than 4 threads at any given time, as otherwise it would need to do more context switching. Now there are times where you want to explicitly override this behaviour. Let's say in the case where you need to wait for <strong>some sort of IO to finish, which is a whole different story</strong>.</p>\n\n<p>In summary, trust the TPL. But if you are adamant to spawn a thread per task (not always a good idea!), you can use:</p>\n\n<pre><code>Task.Factory.StartNew(\n    () =&gt; /* your piece of work */, \n    TaskCreationOptions.LongRunning);\n</code></pre>\n\n<p>This tells the <em>Default</em><code>Taskscheduler</code> to explicitly spawn a new thread for that piece of work.</p>\n\n<p>You can also use your own <code>Scheduler</code> and pass it in to the <code>TaskFactory</code>. You can find a whole bunch of <code>Schedulers</code> <a href=\"http://blogs.msdn.com/pfxteam/archive/2010/04/04/9990342.aspx\" rel=\"noreferrer\"><code>HERE</code></a>.</p>\n\n<p>Note another alternative would be to use <b><code>PLINQ</code></b> which again by default analyses your query and decides whether parallelizing it would yield any benefit or not, again in the case of a blocking IO where you are certain starting multiple threads will result in a better execution you can force the parallelism by using <b><code>WithExecutionMode(ParallelExecutionMode.ForceParallelism)</code></b> you then can use <b>WithDegreeOfParallelism</b>, to give hints on how many threads to use <b>but</b> remember there is <b>no guarantee</b> you would get that many threads, as <a href=\"https://msdn.microsoft.com/library/dd383719%28v=vs.100%29.aspx\" rel=\"noreferrer\">MSDN</a> says:</p>\n\n<blockquote>\n  <p>Sets the degree of parallelism to use in a query. Degree of\n  parallelism is the <b>maximum number</b> of concurrently executing tasks that\n  will be used to process the query.</p>\n</blockquote>\n\n<p>Finally, I <b>highly</b> recommend having a read of <a href=\"http://www.albahari.com/threading/part5.aspx#_Task_Parallelism\" rel=\"noreferrer\"><code>THIS</code></a> great series of articles on <code>Threading</code> and <code>TPL</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "edited": false, "score": 1, "creation_date": 1453379141, "post_id": 34923410, "comment_id": 57580893, "body": "What do you mean by DOP? With <code>AsParallel()</code> in the case of a blocking IO you still need to give it hint by using <code>WithDegreeOfParallelism</code> otherwise it thinks the work is CPU bound and allocates threads differently so again on a 4-core machine <code>PLINQ</code> may run only 4 tasks at the same time."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "reply_to_user": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "edited": false, "score": 0, "creation_date": 1453379635, "post_id": 34923410, "comment_id": 57581232, "body": "@MaYaN yes, you always need to specify a DegreeOfParallelism (=DOP) with IO involved no matter how you do it. That is a key point: No library can know the correct value. You need to find it empirically (or through human guessing)."}], "tags": [], "owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "is_accepted": false, "score": 4, "last_activity_date": 1453379666, "last_edit_date": 1453379666, "creation_date": 1453378039, "answer_id": 34923410, "question_id": 34912698, "link": "https://stackoverflow.com/questions/34912698/what-determines-the-number-of-threads-for-a-taskfactory-spawned-jobs/34923410#34923410", "title": "What determines the number of threads for a TaskFactory spawned jobs?", "body": "<p>If you increase the number of tasks to for example 1000000 you will see a lot more threads spawned over time. The TPL tends to inject one every 500ms.</p>\n\n<p>The TPL threadpool does not understand IO-bound workloads (sleep is IO). It's not a good idea to rely on the TPL for picking the right degree of parallelism in these cases. The TPL is completely clueless and injects more threads based on vague guesses about throughput. Also to avoid deadlocks.</p>\n\n<p>Here, the TPL policy clearly is not useful because the more threads you add the more throughput you get. Each thread can process one item per second in this contrived case. The TPL has no idea about that. It makes no sense to limit the thread count to the number of cores.</p>\n\n<blockquote>\n  <p>What determines the number of threads used at a time?</p>\n</blockquote>\n\n<p>Barely documented TPL heuristics. They frequently go wrong. In particular they will spawn an <em>unlimited number of threads</em> over time in this case. Use task manager to see for yourself. Let this run for an hour and you'll have 1000s of threads.</p>\n\n<blockquote>\n  <p>How can I retrieve this number? How can I change this number?</p>\n</blockquote>\n\n<p>You can retrieve <em>some</em> of these numbers but that's not the right way to go. If you need a guaranteed DOP you can use <code>AsParallel().WithDegreeOfParallelism(...)</code> or a custom task scheduler. You also can manually start <code>LongRunning</code> tasks. Do not mess with process global settings.</p>\n"}], "owner": {"reputation": 54181, "user_id": 9382, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bc7b9ac824e43ce9d62bf7dfb37b6393?s=128&d=identicon&r=PG", "display_name": "AngryHacker", "link": "https://stackoverflow.com/users/9382/angryhacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8773, "favorite_count": 2, "accepted_answer_id": 34913057, "answer_count": 2, "score": 12, "last_activity_date": 1453508759, "creation_date": 1453332741, "last_edit_date": 1453505958, "question_id": 34912698, "link": "https://stackoverflow.com/questions/34912698/what-determines-the-number-of-threads-for-a-taskfactory-spawned-jobs", "title": "What determines the number of threads for a TaskFactory spawned jobs?", "body": "<p>I have the following code:</p>\n\n<pre><code>var factory = new TaskFactory();\nfor (int i = 0; i &lt; 100; i++)\n{\n    var i1 = i;\n    factory.StartNew(() =&gt; foo(i1));\n}\n\nstatic void foo(int i)\n{\n    Thread.Sleep(1000);\n    Console.WriteLine($\"foo{i} - on thread {Thread.CurrentThread.ManagedThreadId}\");\n}            \n</code></pre>\n\n<p>I can see it only does 4 threads at a time (based on observation).  My questions:</p>\n\n<ol>\n<li>What determines the number of threads used at a time?</li>\n<li>How can I retrieve this number?</li>\n<li>How can I change this number?</li>\n</ol>\n\n<p>P.S. My box has 4 cores.</p>\n\n<p>P.P.S.  I needed to have a specific number of tasks (and no more) that are concurrently processed by the TPL and ended up with the following code:</p>\n\n<pre><code>private static int count = 0;   // keep track of how many concurrent tasks are running\n\nprivate static void SemaphoreImplementation()\n{\n    var s = new Semaphore(20, 20);  // allow 20 tasks at a time\n\n    for (int i = 0; i &lt; 1000; i++)\n    {\n        var i1 = i;\n\n        Task.Factory.StartNew(() =&gt;\n        {\n            try\n            {                        \n                s.WaitOne();\n                Interlocked.Increment(ref count);\n\n                foo(i1);\n            }\n            finally\n            {\n                s.Release();\n                Interlocked.Decrement(ref count);\n            }\n        }, TaskCreationOptions.LongRunning);\n    }\n}\n\nstatic void foo(int i)\n{\n    Thread.Sleep(100);\n    Console.WriteLine($\"foo{i:00} - on thread \" + \n            $\"{Thread.CurrentThread.ManagedThreadId:00}. Executing concurently: {count}\");\n}\n</code></pre>\n"}, {"tags": ["c#", "user-interface", "textbox", "newline", "whitespace"], "comments": [{"owner": {"reputation": 12853, "user_id": 2878550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvO6l.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2878550/dmitry"}, "edited": false, "score": 2, "creation_date": 1453332785, "post_id": 34912656, "comment_id": 57560911, "body": "Is it possible that you forgot to set <code>textBox1.Multiline = true</code>?"}, {"owner": {"reputation": 237, "user_id": 4965277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32a0f7a746ebc9ed1e90eb5355719b0c?s=128&d=identicon&r=PG&f=1", "display_name": "DianaM", "link": "https://stackoverflow.com/users/4965277/dianam"}, "reply_to_user": {"reputation": 12853, "user_id": 2878550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvO6l.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2878550/dmitry"}, "edited": false, "score": 0, "creation_date": 1453333170, "post_id": 34912656, "comment_id": 57561049, "body": "I&#39;ve checked it and it is set to true."}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 4965277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32a0f7a746ebc9ed1e90eb5355719b0c?s=128&d=identicon&r=PG&f=1", "display_name": "DianaM", "link": "https://stackoverflow.com/users/4965277/dianam"}, "edited": false, "score": 0, "creation_date": 1453333229, "post_id": 34912691, "comment_id": 57561071, "body": "It works with \\r\\n on this example. Thank you."}], "tags": [], "owner": {"reputation": 14130, "user_id": 73381, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Hsume.png?s=128&g=1", "display_name": "Rob P.", "link": "https://stackoverflow.com/users/73381/rob-p"}, "is_accepted": true, "score": 4, "last_activity_date": 1453334744, "last_edit_date": 1453334744, "creation_date": 1453332688, "answer_id": 34912691, "question_id": 34912656, "link": "https://stackoverflow.com/questions/34912656/c-how-to-allow-new-line-and-white-spaces-in-textbox/34912691#34912691", "title": "C# How to allow NEW LINE and WHITE SPACES in textBox", "body": "<p>Use <code>\\r\\n</code> or <code>Environment.NewLine</code></p>\n"}], "owner": {"reputation": 237, "user_id": 4965277, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/32a0f7a746ebc9ed1e90eb5355719b0c?s=128&d=identicon&r=PG&f=1", "display_name": "DianaM", "link": "https://stackoverflow.com/users/4965277/dianam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "closed_date": 1453332871, "accepted_answer_id": 34912691, "answer_count": 1, "score": 1, "last_activity_date": 1453334744, "creation_date": 1453332550, "question_id": 34912656, "link": "https://stackoverflow.com/questions/34912656/c-how-to-allow-new-line-and-white-spaces-in-textbox", "closed_reason": "Duplicate", "title": "C# How to allow NEW LINE and WHITE SPACES in textBox", "body": "<p>I am trying to write a string in a C# textBox by pressing a button. When I press the button my string should be added in the textBox. However, the string  is added, but the \"\\n\" is completely ignored. How can I allow it?</p>\n\n<p>This is a very simple example that I have written only to understand where the problem is, but I noticed that the same thing happens with white spaces when I am trying to redirect my console output to a textBox.</p>\n\n<pre><code>public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            String s = \"first line\";\n            s += \"\\n\"; \n            s += \"second line\";\n            Console.Out.WriteLine(s);\n            textBox1.AppendText(s);\n        }\n\n        private void textBox1_TextChanged(object sender, EventArgs e)\n        {\n\n        }\n    }\n</code></pre>\n\n<p>how i call it:</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        Application.EnableVisualStyles();\n        Application.SetCompatibleTextRenderingDefault(false);\n        Application.Run(new Form1());\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/8FPqi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8FPqi.jpg\" alt=\"output in console and output in textBox\"></a></p>\n"}, {"tags": ["c#", "visual-studio", "msbuild", "sonarqube", "sonar-runner"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 1282343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba81f0c4c630bb7d805e57d75bc8911?s=128&d=identicon&r=PG", "display_name": "user1282343", "link": "https://stackoverflow.com/users/1282343/user1282343"}, "edited": false, "score": 0, "creation_date": 1453346472, "post_id": 34913892, "comment_id": 57564804, "body": "It is the default address and port (pretty sure its localhost:9000) and i could also confirm that i could navigate to it from the server itself. Plus earlier today when i had it working and then not working with the vbnet example, i made no changes to SonarQube.Analysis.xml between it working and it not."}], "tags": [], "owner": {"reputation": 682, "user_id": 1944091, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/AmSgv.jpg?s=128&g=1", "display_name": "WiSeeker", "link": "https://stackoverflow.com/users/1944091/wiseeker"}, "is_accepted": false, "score": 0, "last_activity_date": 1453340220, "creation_date": 1453340220, "answer_id": 34913892, "question_id": 34912574, "link": "https://stackoverflow.com/questions/34912574/sonarqube-msbuild-runner-defaults-to-h2-database/34913892#34913892", "title": "SonarQube MSBuild Runner defaults to h2 Database", "body": "<p>In the MSBuild.SonarQube.Runner install folder, there is a <code>SonarQube.Analysis.xml</code>. Do you have the correct server details on the below line in there?</p>\n\n<pre><code>&lt;Property Name=\"sonar.host.url\"&gt;http://{host}:{port}/{optionalPath}&lt;/Property&gt;\n</code></pre>\n\n<p>This property value should point to your Sonar server.</p>\n"}, {"tags": [], "owner": {"reputation": 682, "user_id": 1944091, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/AmSgv.jpg?s=128&g=1", "display_name": "WiSeeker", "link": "https://stackoverflow.com/users/1944091/wiseeker"}, "is_accepted": false, "score": 0, "last_activity_date": 1453398057, "creation_date": 1453398057, "answer_id": 34930657, "question_id": 34912574, "link": "https://stackoverflow.com/questions/34912574/sonarqube-msbuild-runner-defaults-to-h2-database/34930657#34930657", "title": "SonarQube MSBuild Runner defaults to h2 Database", "body": "<p>Couple other things to try. Do you see tables being populated with analysis data in your oracle database? When was the last time it got any record?</p>\n\n<p>Also, are you seeing below warning on your SonarQube application pages (say default dashboard)? If yes, then oracle configuration is not being picked up.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LsYdH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LsYdH.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1282343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba81f0c4c630bb7d805e57d75bc8911?s=128&d=identicon&r=PG", "display_name": "user1282343", "link": "https://stackoverflow.com/users/1282343/user1282343"}, "is_accepted": true, "score": 0, "last_activity_date": 1453403264, "creation_date": 1453403264, "answer_id": 34932287, "question_id": 34912574, "link": "https://stackoverflow.com/questions/34912574/sonarqube-msbuild-runner-defaults-to-h2-database/34932287#34932287", "title": "SonarQube MSBuild Runner defaults to h2 Database", "body": "<p>So i upgraded to the latest SonarQube version (5.3) and upgraded a few of the extensions while i was at it and preliminary testing is showing positive results. Ill try it a few more times but im closing the question for now. Thank you all that helped! </p>\n"}], "owner": {"reputation": 11, "user_id": 1282343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba81f0c4c630bb7d805e57d75bc8911?s=128&d=identicon&r=PG", "display_name": "user1282343", "link": "https://stackoverflow.com/users/1282343/user1282343"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 34932287, "answer_count": 3, "score": 0, "last_activity_date": 1453403264, "creation_date": 1453332152, "question_id": 34912574, "link": "https://stackoverflow.com/questions/34912574/sonarqube-msbuild-runner-defaults-to-h2-database", "title": "SonarQube MSBuild Runner defaults to h2 Database", "body": "<p>I am using Win Server 2012, Developer Command Prompt for VS2013, SonarQube v5.1.2, SonarQube Scanner for MSBuild 1.1. </p>\n\n<p>I have my Sonar instance running off this same server, but connected to an Oracle database. Using the default sonar runner, i can analyze projects properly and see them appear in the dashboard using this method. That cannot be said for using the recommended MSBuild.SonarQube.Runner.exe approach. </p>\n\n<p>I have tried with the csharp and vbnet examples, as well as our actual code. Oddly, i want to say each of these have worked at least once, but fail to do so now. Today, I tried using the vbnet example project for the first time and discovered and it worked as intended when using the MSBuild runner. I deleted the project from the dashboard, and ran it again. At this point i do not remember it it worked or not, but the third time for sure it stopped working and began producing the error below (wherein it tries to connect to the default h2 database instead of the oracle one that SonarQube is connected to). </p>\n\n<p>I tried deleting the examples folder, extracting it again, giving it a slightly different name, and running the Sonar on it giving THOSE a different name/key/version, but now it is consistently giving me the db error. </p>\n\n<p>Any idea what could be going on here, and why it would go from working to not, without me making any changes to the runner, msbuild, or the code? </p>\n\n<p>Running the begin step:</p>\n\n<pre><code>c:\\sonar-examples-master\\projects\\languages\\vbnet&gt;msbuild.sonarqube.runner.exe b\negin /v:vbnet1 /k:vbnet1 /n:vbnet1\nSonarQube Scanner for MSBuild 1.1\nDefault properties file was found at c:\\sonarqube\\bin\\SonarQube.Analysis.xml\nLoading analysis properties from c:\\sonarqube\\bin\\SonarQube.Analysis.xml\nPre-processing started.\nPreparing working directories...\nChecking for updates...\nMSBuild SonarQube Runner Pre-processor 1.0.2.0\n17:40:49.625  Loading analysis properties from c:\\sonarqube\\bin\\SonarQube.Analys\nis.xml\n17:40:49.656  Updating build integration targets...\n17:40:49.656  Fetching analysis configuration settings...\n17:40:50.813  Generating rulesets...\nPre-processing succeeded.\n</code></pre>\n\n<p>MSBuild ran, but nothing worthwhile to post from it..</p>\n\n<p>Running the end step:</p>\n\n<pre><code>c:\\sonar-examples-master\\projects\\languages\\vbnet&gt;msbuild.sonarqube.runner.exe e\nnd\nSonarQube Scanner for MSBuild 1.1\nDefault properties file was found at c:\\sonarqube\\bin\\SonarQube.Analysis.xml\nLoading analysis properties from c:\\sonarqube\\bin\\SonarQube.Analysis.xml\nPost-processing started.\nMSBuild SonarQube Runner Post-processor 1.0.2.0\nWARNING: File is not under the project directory and cannot currently be analyse\nd by SonarQube. File: C:\\Users\\ts3conusr\\AppData\\Local\\Temp\\.NETFramework,Versio\nn=v4.5.AssemblyAttributes.vb, project: c:\\sonar-examples-master\\projects\\languag\nes\\vbnet\\ConsoleApplication1\\ConsoleApplication1.vbproj\nThe SONAR_RUNNER_HOME environment variable is not required and will be ignored.\nSONAR_RUNNER_OPTS is not configured. Setting it to the default value of -Xmx1024\nm\nCalling the sonar-runner...\nc:\\sonar-examples-master\\projects\\languages\\vbnet\\.sonarqube\\bin\\sonar-runner\\bi\nn\\..\nSonarQube Runner 2.4\nJava 1.7.0_79 Oracle Corporation (32-bit)\nWindows Server 2008 R2 6.1 x86\nSONAR_RUNNER_OPTS=-Xmx1024m\nINFO: Error stacktraces are turned on.\nINFO: Runner configuration file: c:\\sonar-examples-master\\projects\\languages\\vbn\net\\.sonarqube\\bin\\sonar-runner\\bin\\..\\conf\\sonar-runner.properties\nINFO: Project configuration file: c:\\sonar-examples-master\\projects\\languages\\vb\nnet\\.sonarqube\\out\\sonar-project.properties\nINFO: Default locale: \"en_US\", source code encoding: \"UTF-8\"\nINFO: Work directory: c:\\sonar-examples-master\\projects\\languages\\vbnet\\.sonarqu\nbe\\out\\.sonar\nINFO: SonarQube Server 5.1.2\n17:41:04.563 INFO  - Load global repositories\n17:41:04.751 INFO  - Load global repositories (done) | time=188ms\n17:41:04.751 INFO  - Server id: 20160120154951\n17:41:04.751 INFO  - User cache: C:\\Users\\ts3conusr\\.sonar\\cache\n17:41:04.766 INFO  - Install plugins\n17:41:04.860 INFO  - Install JDBC driver\n17:41:04.860 INFO  - Create JDBC datasource for jdbc:h2:tcp://localhost/sonar\nINFO: ------------------------------------------------------------------------\nINFO: EXECUTION FAILURE\nINFO: ------------------------------------------------------------------------\nTotal time: 1.047s\nFinal Memory: 3M/15M\nINFO: ------------------------------------------------------------------------\nERROR: Error during Sonar runner execution\norg.sonar.runner.impl.RunnerException: Unable to execute Sonar\n</code></pre>\n\n<p>Of note: I feel that it is worth mentioning that the vbnet report didn't actually have any content in it, but did at least properly get generated in the Sonar dashboard. I have tried running the commands against both that and the csharp example with now neither of them being added to the dashboard.</p>\n"}, {"tags": ["c#", "process", "ipc", "shared-memory"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1453332348, "post_id": 34912529, "comment_id": 57560745, "body": "It just doesn&#39;t matter, all IPC mechanism operate at the same speed.  They all solve the same problem, just in different ways.  The underlying operation is fundamentally the same, it requires shared memory and a thread context switch.  The other ways are convenient because you don&#39;t have to solve the synchronization problems that raw MMFs require you to solve.  The kind of problem you <i>really</i> don&#39;t want to have to solve.  Named pipes and local loopback sockets are fine as well.  .NET adds remoting and WCF.  If you notice lag from <i>only</i> reporting progress then you are doing it wrong."}, {"owner": {"reputation": 6495, "user_id": 1082327, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/FzJNd.jpg?s=128&g=1", "display_name": "PoweredByOrange", "link": "https://stackoverflow.com/users/1082327/poweredbyorange"}, "edited": false, "score": 0, "creation_date": 1453332401, "post_id": 34912529, "comment_id": 57560765, "body": "Do you absolutely have to use a separate process? Can&#39;t you employ worker threads within your main process?"}, {"owner": {"reputation": 1664, "user_id": 2481095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/881f8d0282145d0cdd6df29991eefbeb?s=128&d=identicon&r=PG", "display_name": "user2481095", "link": "https://stackoverflow.com/users/2481095/user2481095"}, "edited": false, "score": 0, "creation_date": 1453332593, "post_id": 34912529, "comment_id": 57560838, "body": "I would want it be on a separate thread as well, however that is not possible due to stability issues"}], "answers": [{"comments": [{"owner": {"reputation": 1664, "user_id": 2481095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/881f8d0282145d0cdd6df29991eefbeb?s=128&d=identicon&r=PG", "display_name": "user2481095", "link": "https://stackoverflow.com/users/2481095/user2481095"}, "edited": false, "score": 0, "creation_date": 1453332832, "post_id": 34912672, "comment_id": 57560927, "body": "Are you talking about for an anonymous pipe? No I don&#39;t think I did that. Is that always necessary to do?"}, {"owner": {"reputation": 26, "user_id": 3366405, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000087946273/picture?type=large", "display_name": "user3366405", "link": "https://stackoverflow.com/users/3366405/user3366405"}, "reply_to_user": {"reputation": 1664, "user_id": 2481095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/881f8d0282145d0cdd6df29991eefbeb?s=128&d=identicon&r=PG", "display_name": "user2481095", "link": "https://stackoverflow.com/users/2481095/user2481095"}, "edited": false, "score": 0, "creation_date": 1453474987, "post_id": 34912672, "comment_id": 57630843, "body": "well, to improve throughput, it&#39;s likely to be buffered (fewer context switches), as low latency isn&#39;t always important. When latency is important, eliminate the buffer or force a flush."}, {"owner": {"reputation": 1664, "user_id": 2481095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/881f8d0282145d0cdd6df29991eefbeb?s=128&d=identicon&r=PG", "display_name": "user2481095", "link": "https://stackoverflow.com/users/2481095/user2481095"}, "edited": false, "score": 0, "creation_date": 1453501729, "post_id": 34912672, "comment_id": 57645627, "body": "In case anyone is wondering I tried using an anonymous pipe again, making sure to flush the pipe after ever write and this helped improve the latency."}], "tags": [], "owner": {"reputation": 26, "user_id": 3366405, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000087946273/picture?type=large", "display_name": "user3366405", "link": "https://stackoverflow.com/users/3366405/user3366405"}, "is_accepted": true, "score": 1, "last_activity_date": 1453332611, "creation_date": 1453332611, "answer_id": 34912672, "question_id": 34912529, "link": "https://stackoverflow.com/questions/34912529/low-latency-ipc-between-ui-thread-and-child-process-in-c/34912672#34912672", "title": "Low-Latency IPC Between UI Thread and Child Process in C#", "body": "<p>Have you tried setting the buffer sizes to 0 and/or flushing the pipe after a write?</p>\n"}], "owner": {"reputation": 1664, "user_id": 2481095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/881f8d0282145d0cdd6df29991eefbeb?s=128&d=identicon&r=PG", "display_name": "user2481095", "link": "https://stackoverflow.com/users/2481095/user2481095"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "closed_date": 1453341789, "accepted_answer_id": 34912672, "answer_count": 1, "score": 0, "last_activity_date": 1453332611, "creation_date": 1453331974, "question_id": 34912529, "link": "https://stackoverflow.com/questions/34912529/low-latency-ipc-between-ui-thread-and-child-process-in-c", "closed_reason": "Not suitable for this site", "title": "Low-Latency IPC Between UI Thread and Child Process in C#", "body": "<p>I have program that spawns a separate child process that performs a function that can potentially run for a long period of time. While the child process is running, a windows form is displayed on the main thread (this has to be on the main thread) showing the progress of the child process. I need to set up IPC in order to communicate the current progress state of the child process on the main UI thread. I was able to get an anonymous pipeline set up, however there was significant lag. Are there any recommendations for a faster method? I have read that using Memory-Mapped Files can reduce latency even further, however I am having trouble setting this up.   </p>\n"}, {"tags": ["c#", "active-directory"], "comments": [{"owner": {"reputation": 103396, "user_id": 712649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tP0yV.jpg?s=128&g=1", "display_name": "Mathias R. Jessen", "link": "https://stackoverflow.com/users/712649/mathias-r-jessen"}, "edited": false, "score": 1, "creation_date": 1453332322, "post_id": 34912517, "comment_id": 57560732, "body": "-2147467259 = <code>0x80004005</code> = Access Denied - sure you have the rights to set that attribute?"}, {"owner": {"reputation": 177, "user_id": 3334377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74f22d7efc8a979e9a0b6a0de1ee1d96?s=128&d=identicon&r=PG&f=1", "display_name": "Beresford", "link": "https://stackoverflow.com/users/3334377/beresford"}, "reply_to_user": {"reputation": 103396, "user_id": 712649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tP0yV.jpg?s=128&g=1", "display_name": "Mathias R. Jessen", "link": "https://stackoverflow.com/users/712649/mathias-r-jessen"}, "edited": false, "score": 0, "creation_date": 1453336113, "post_id": 34912517, "comment_id": 57561972, "body": "I can clear the thumbnail. And using ADPhotoEdit as myself, I can upload a new photo. Could be a permission problem though."}, {"owner": {"reputation": 1284, "user_id": 1041457, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/319dd4fa47c522082ee7eed75cd3e385?s=128&d=identicon&r=PG", "display_name": "Vikram", "link": "https://stackoverflow.com/users/1041457/vikram"}, "edited": false, "score": 0, "creation_date": 1453384079, "post_id": 34912517, "comment_id": 57584398, "body": "I don&#39;t think that as permission problem. I would like you to debug it and ensure and let us know for which line you are getting this error. I had written same type of application earlier and got that very error code when tried to enclose code in <b>using</b> for <i>MemoryStream</i>."}, {"owner": {"reputation": 177, "user_id": 3334377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74f22d7efc8a979e9a0b6a0de1ee1d96?s=128&d=identicon&r=PG&f=1", "display_name": "Beresford", "link": "https://stackoverflow.com/users/3334377/beresford"}, "edited": false, "score": 0, "creation_date": 1453402969, "post_id": 34912517, "comment_id": 57597153, "body": "It happens when the information is saved to AD. After I set a new value for userPrincipal.thumbnailPhoto, I then call userPrincipal.Save(), which is when the exception occurs."}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 3334377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74f22d7efc8a979e9a0b6a0de1ee1d96?s=128&d=identicon&r=PG&f=1", "display_name": "Beresford", "link": "https://stackoverflow.com/users/3334377/beresford"}, "is_accepted": true, "score": 5, "last_activity_date": 1454056576, "creation_date": 1454056576, "answer_id": 35080077, "question_id": 34912517, "link": "https://stackoverflow.com/questions/34912517/writing-thumbnailphoto-property-to-active-directory/35080077#35080077", "title": "Writing thumbnailPhoto property to Active Directory", "body": "<p>I managed to get this working today using the function below. Hopefully this helps someone else.</p>\n\n<pre><code>    private void UpdatePhoto()\n    {\n        var principalContext = new PrincipalContext(ContextType.Domain);\n        var userPrincipal = UserPrincipalEx.FindByIdentity(principalContext, System.Environment.UserName);\n\n        DirectoryEntry directoryEntry = new DirectoryEntry(string.Format(\"LDAP://{0}:389/{1}\", principalContext.ConnectedServer, userPrincipal.DistinguishedName));\n        directoryEntry.Properties[\"thumbnailPhoto\"].Value = ImageManipulation.imageToByteArray(pictureBoxthumbnail.Image);\n        directoryEntry.CommitChanges();\n    }\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 3334377, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74f22d7efc8a979e9a0b6a0de1ee1d96?s=128&d=identicon&r=PG&f=1", "display_name": "Beresford", "link": "https://stackoverflow.com/users/3334377/beresford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2976, "favorite_count": 0, "accepted_answer_id": 35080077, "answer_count": 1, "score": 2, "last_activity_date": 1454056576, "creation_date": 1453331906, "last_edit_date": 1592644375, "question_id": 34912517, "link": "https://stackoverflow.com/questions/34912517/writing-thumbnailphoto-property-to-active-directory", "title": "Writing thumbnailPhoto property to Active Directory", "body": "<p>I'm creating an application (.Net 3.5) to allow users to update their own photos and telephone numbers in Active Directory.</p>\n<p>I'm using the UserPrincipal class, which I've extended using this <a href=\"https://stackoverflow.com/questions/9540436/get-job-title-using-system-directoryservices-accountmanagement\">example</a></p>\n<pre><code>    // Create the &quot;thumbnailPhoto&quot; property.    \n    [DirectoryProperty(&quot;thumbnailPhoto&quot;)]\n    public byte[] thumbnailPhoto\n    {\n        get\n        {\n            if (ExtensionGet(&quot;thumbnailPhoto&quot;).Length != 1)\n                return null;\n\n            return (byte[])ExtensionGet(&quot;thumbnailPhoto&quot;)[0];\n        }\n        set\n        {\n            ExtensionSet(&quot;thumbnailPhoto&quot;, value);\n        }\n    }\n</code></pre>\n<p>I get the byte array and write it to a pictureBox with</p>\n<pre><code>pictureBoxthumbnail.Image = Image.FromStream(new MemoryStream(userPrincipal.thumbnailPhoto));\n</code></pre>\n<p>This shows the picture, on the form, so far so good. When I try to write the image to Active Directory, I convert the pictureBox to a byte array with</p>\n<pre><code>userPrincipal.thumbnailPhoto = ImageManipulation.imageToByteArray(pictureBoxthumbnail.Image);\n\npublic static byte[] imageToByteArray(System.Drawing.Image imageIn)\n{\n    MemoryStream ms = new MemoryStream();\n    imageIn.Save(ms, System.Drawing.Imaging.ImageFormat.Png);\n    return ms.ToArray();\n}\n</code></pre>\n<p>And try and save the data, but I get the following exception.</p>\n<blockquote>\n<p>System.DirectoryServices.AccountManagement.PrincipalOperationException was unhandled</p>\n<p>Message=Unspecified error</p>\n<p>Source=System.DirectoryServices.AccountManagement</p>\n<p>ErrorCode=-2147467259</p>\n</blockquote>\n<p>I suspect my pictureBox to byte array is wrong. Is anyone able to help?</p>\n<p>Thank you.</p>\n"}, {"tags": ["c#", "windows", "service", "command", "isolatedstorage"], "comments": [{"owner": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "edited": false, "score": 1, "creation_date": 1453332227, "post_id": 34912486, "comment_id": 57560699, "body": "I&#39;ve already answered this on your other thread, let me look for any new info here"}, {"owner": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "edited": false, "score": 0, "creation_date": 1453332251, "post_id": 34912486, "comment_id": 57560708, "body": "send me your project adamt at microsoft I&#39;ll check it out"}, {"owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "reply_to_user": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "edited": false, "score": 0, "creation_date": 1453332330, "post_id": 34912486, "comment_id": 57560737, "body": "How would I do this @AdamTuliper-MSFT"}, {"owner": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "edited": false, "score": 0, "creation_date": 1453332528, "post_id": 34912486, "comment_id": 57560813, "body": "right click on your solution, select &quot;Open folder in file explorer&quot;. Close visual studio out. Go up one folder (or two) to your folder that contains all your solution stuff and right click in it and send to-&gt;comrpessed folder. Email it to me.. but FIRST go into the folder, find your bin/debug folder and delete it for each project. many email filters wont allow .exe files in zips."}, {"owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "reply_to_user": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "edited": false, "score": 0, "creation_date": 1453333493, "post_id": 34912486, "comment_id": 57561141, "body": "@AdamTuliper-MSFT whats your email?"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "edited": false, "score": 0, "creation_date": 1453371971, "post_id": 34912650, "comment_id": 57576048, "body": "I took these two scenarios and implemented them. The account the service is running on is LocalSystem and I took away the isolated storage part and just wrote to a text file <code>WriteServiceInfo(&quot;data written to isolated storage&quot;)</code> and it works. Putting the file into IsolatedStorage is the problem. The custom commands are working."}, {"owner": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "reply_to_user": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "edited": false, "score": 0, "creation_date": 1453394427, "post_id": 34912650, "comment_id": 57591908, "body": "Jusy curious, with system permissions and running a service why are you using local storage and not a normal file? Also if you must use isolated storage try running your service as a specific account."}], "tags": [], "owner": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "is_accepted": true, "score": 0, "last_activity_date": 1453332533, "creation_date": 1453332533, "answer_id": 34912650, "question_id": 34912486, "link": "https://stackoverflow.com/questions/34912486/sending-commands-to-windows-service/34912650#34912650", "title": "Sending Commands to Windows Service", "body": "<p>There's a couple things here:\n1. Check the account your service is running as. With your service installer you can specify. I tested your <em>exact</em> scenario (using your code) with System to ensure I can access files <em>on my desktop</em> as a log test and it worked fine.\n2. Limit the test case to not log to isolated, but a simple text file log.</p>\n\n<p>I also posted code that I used to your other post - so lets clean this up first and figure out which one to resolve on.</p>\n"}], "owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1524, "favorite_count": 0, "accepted_answer_id": 34912650, "answer_count": 1, "score": 0, "last_activity_date": 1486056841, "creation_date": 1453331735, "question_id": 34912486, "link": "https://stackoverflow.com/questions/34912486/sending-commands-to-windows-service", "title": "Sending Commands to Windows Service", "body": "<p>I am trying to send custom commands to a windows service. My application has a windows service and a form. When the service is running I want to create a file in Isolated Storage using a button click event. I am using this tutorial <a href=\"http://arcanecode.com/2007/05/30/windows-services-in-c-sending-commands-to-your-windows-service-part-7/\" rel=\"nofollow\">http://arcanecode.com/2007/05/30/windows-services-in-c-sending-commands-to-your-windows-service-part-7/</a>. When I run the program and click the button nothing seems to happen and the file is not place into Isolated Storage. I have put break points on these methods to see if they execute and they seem to work. I am not sure if the button click method can reach the Isolated Storage code in the service from the form but according to this tutorial I cannot see what the problem would be. Source code below.</p>\n\n<p><strong>Form</strong> </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.ServiceProcess;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing Project2Service;\n\nnamespace Project2\n{\n    public partial class Form1 : Form\n    {\n        public Service1 s = new Service1();\n        public ServiceInstaller si = new ServiceInstaller();\n        public ProjectInstaller pi = new ProjectInstaller();\n        public ServiceController sc = new ServiceController(\"Project2Service\");\n\n        private string[] isoType;\n\n        string machineName = System.Windows.Forms.SystemInformation.ComputerName;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            isoType = new string[] { \"User\", \"Assembly And Domain\"};\n            cboIsoType.Items.AddRange(isoType);\n\n            cboIsoType.SelectedIndex = 0;\n\n            btnContinue.Enabled = false;\n            btnPause.Enabled = false;\n            btnStop.Enabled = false;\n        }\n\n        public void Labels()\n        {\n            lblMachine.Text = machineName;\n            lblSName.Text = s.ServiceName;\n            lblSType.Text = si.StartType.ToString();\n\n            lblSStatus.Text = sc.Status.ToString();\n            lblPause.Text = sc.CanPauseAndContinue.ToString();\n            lblShutdown.Text = sc.CanShutdown.ToString();\n            lblStop.Text = sc.CanStop.ToString();\n        }\n\n        private void btnStart_Click(object sender, EventArgs e)\n        {\n            //Controller.Refresh(); //Gets the current status of service\n            //if (Controller.Status == ServiceControllerStatus.Stopped)\n            //{\n            //    Controller.Start();\n            //}\n\n            sc.Start();\n            sc.WaitForStatus(ServiceControllerStatus.Running);\n            Labels();\n\n            btnStart.Enabled = false;\n            btnContinue.Enabled = false;\n            btnStop.Enabled = true;\n            btnPause.Enabled = true;\n\n        }\n\n        private void btnStop_Click(object sender, EventArgs e)\n        {\n            sc.Stop();\n            sc.WaitForStatus(ServiceControllerStatus.Stopped);\n            Labels();\n\n            btnStart.Enabled = true;\n            btnContinue.Enabled = false;\n            btnPause.Enabled = false;\n            btnStop.Enabled = false;\n        }\n\n        private void btnPause_Click(object sender, EventArgs e)\n        {\n            sc.Pause();\n            sc.WaitForStatus(ServiceControllerStatus.Paused);\n            Labels();\n\n            btnPause.Enabled = false;\n            btnContinue.Enabled = true;\n            btnStart.Enabled = false;\n            btnStop.Enabled = true;\n        }\n\n        private void btnContinue_Click(object sender, EventArgs e)\n        {\n            sc.Continue();\n            sc.WaitForStatus(ServiceControllerStatus.Running);\n            Labels();\n\n            btnStop.Enabled = true;\n            btnStart.Enabled = false;\n            btnPause.Enabled = true;\n            btnContinue.Enabled = false;\n        }\n\n        private void btnSubmit_Click(object sender, EventArgs e)\n        {\n            ServiceController sc2 = new ServiceController(\"Project2Service\");\n            sc2.ExecuteCommand(200);\n\n            //if (cboIsoType.SelectedItem.ToString() == \"User\")   \n            //{\n\n            //    sc.ExecuteCommand(128);\n            //}\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Service</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Diagnostics;\nusing System.IO;\nusing System.IO.IsolatedStorage;\nusing System.Linq;\nusing System.ServiceProcess;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace Project2Service\n{\n    public partial class Service1 : ServiceBase\n    {\n        public enum commands\n        {\n            LogIt = 200\n        }\n\n        //public enum ServiceCustomCommands { Command1 = 128, Command2 = 129 };\n        //private IsolatedStorageScope iso;\n\n        public Service1()\n        {\n            InitializeComponent();\n        }\n\n        protected override void OnStart(string[] args)\n        {\n\n            //iso = IsolatedStorageScope.User | IsolatedStorageScope.Domain;\n            FileSystemWatcher Watcher = new FileSystemWatcher(@\"C:\\Users\\Martin\\Desktop\\Project2\\ServiceTest\");\n            Watcher.EnableRaisingEvents = true;\n            Watcher.NotifyFilter = NotifyFilters.LastAccess\n                        | NotifyFilters.LastWrite\n                        | NotifyFilters.FileName\n                        | NotifyFilters.DirectoryName;\n\n            Watcher.Changed += new FileSystemEventHandler(Watcher_Changed);\n            Watcher.Created += new FileSystemEventHandler(Watcher_Created);\n            Watcher.Deleted += new FileSystemEventHandler(Watcher_Deleted);\n            Watcher.Renamed += new RenamedEventHandler(Watcher_Renamed);\n            WriteServiceInfo(\"Service Started!\");\n        }\n\n        // This event is raised when a file is changed\n        private void Watcher_Changed(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Changed!\");\n\n            DirectoryInfo d = new DirectoryInfo(@\"C:\\Users\\Martin\\Desktop\\Project2\\ServiceTest\");//Assuming Watch is your Folder\n            FileInfo[] Files = d.GetFiles(\"*.txt\"); //Getting Text files\n            string str = \"\";\n            foreach (FileInfo file in Files)\n            {\n                str = str + \", \" + file.Name;\n                str = str + \", \" + file.LastWriteTime;\n                str = str + \", \" + file.CreationTime;\n                str = str + \", \" + file.Length;\n\n                WriteServiceInfo(file.Name);\n                WriteServiceInfo(file.LastWriteTime.ToString());\n                WriteServiceInfo(file.CreationTime.ToString());\n                WriteServiceInfo(file.Length.ToString());\n            }\n        }\n\n        private void Watcher_Created(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Created!\");\n        }\n\n        private void Watcher_Deleted(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Deleted!\");\n        }\n        private void Watcher_Renamed(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Renamed!\");\n        }\n\n        private void WriteServiceInfo(string info)\n        {\n            FileStream fs = new FileStream(@\"C:\\Users\\Martin\\Desktop\\Project2\\WindowsServiceLog.txt\",\n                                 FileMode.OpenOrCreate, FileAccess.Write);\n            StreamWriter m_streamWriter = new StreamWriter(fs);\n            m_streamWriter.BaseStream.Seek(0, SeekOrigin.End);\n            m_streamWriter.WriteLine(info + \"\\n\");\n            m_streamWriter.Flush();\n            m_streamWriter.Close();\n        }\n\n        protected override void OnStop()\n        {\n            WriteServiceInfo(\"Service Stopped!\");\n\n        }\n\n        protected override void OnCustomCommand(int command)\n        {\n            base.OnCustomCommand(command);\n            if (command == (int)commands.LogIt)\n            {\n                IsolatedStorageFile isoFile = IsolatedStorageFile.GetStore(IsolatedStorageScope.User | IsolatedStorageScope.Domain | IsolatedStorageScope.Assembly, null, null);\n                IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream(\"LaptopInfo.txt\", FileMode.Append, FileAccess.Write, isoFile);\n                using (StreamWriter writer = new StreamWriter(isoStream))\n                {\n                    writer.WriteLine(\"Data\");\n                }\n            }\n        }\n\n        //protected override void OnCustomCommand(int command)\n        //{\n        //    switch ((ServiceCustomCommands)command)\n        //    {\n        //        case ServiceCustomCommands.Command1:\n        //            //Command1 Implementation\n        //            IsolatedStorageFile isoFile = IsolatedStorageFile.GetStore(IsolatedStorageScope.User | IsolatedStorageScope.Domain | IsolatedStorageScope.Assembly, null, null);\n        //            IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream(\"LaptopInfo.txt\", FileMode.Append, FileAccess.Write, isoFile);\n        //            using (StreamWriter writer = new StreamWriter(isoStream))\n        //            {\n        //                writer.WriteLine(\"Data\");\n        //            }\n        //            //iso = IsolatedStorageScope.User;\n        //            break;\n        //        case ServiceCustomCommands.Command2:\n        //            //iso = IsolatedStorageScope.User | IsolatedStorageScope.Assembly;\n        //            break;\n        //        default:\n        //            break;\n\n        //    }\n        //}\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sql", "sql-server", "ado.net"], "comments": [{"owner": {"reputation": 2784, "user_id": 2134198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/901oM.jpg?s=128&g=1", "display_name": "Jens Meinecke", "link": "https://stackoverflow.com/users/2134198/jens-meinecke"}, "edited": false, "score": 0, "creation_date": 1453333859, "post_id": 34912436, "comment_id": 57561268, "body": "have you tried running the Stored procedure manually in SQL Server Studio or similar to just do a sanity check that you are getting the correct data returned?"}, {"owner": {"reputation": 63, "user_id": 793433, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/35c7b0d780f2b70ab9ee8bbe393b1d99?s=128&d=identicon&r=PG", "display_name": "matt weston", "link": "https://stackoverflow.com/users/793433/matt-weston"}, "reply_to_user": {"reputation": 2784, "user_id": 2134198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/901oM.jpg?s=128&g=1", "display_name": "Jens Meinecke", "link": "https://stackoverflow.com/users/2134198/jens-meinecke"}, "edited": false, "score": 0, "creation_date": 1453334863, "post_id": 34912436, "comment_id": 57561613, "body": "Yes, that was the first thing I tried."}, {"owner": {"reputation": 13590, "user_id": 1405921, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/9PkFQ.jpg?s=128&g=1", "display_name": "Mairaj Ahmad", "link": "https://stackoverflow.com/users/1405921/mairaj-ahmad"}, "edited": false, "score": 0, "creation_date": 1453349524, "post_id": 34912436, "comment_id": 57565574, "body": "Please add some code."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 793433, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/35c7b0d780f2b70ab9ee8bbe393b1d99?s=128&d=identicon&r=PG", "display_name": "matt weston", "link": "https://stackoverflow.com/users/793433/matt-weston"}, "is_accepted": true, "score": 0, "last_activity_date": 1453849670, "creation_date": 1453849670, "answer_id": 35025808, "question_id": 34912436, "link": "https://stackoverflow.com/questions/34912436/sqldataadapter-not-returning-rows/35025808#35025808", "title": "SqlDataAdapter not returning rows", "body": "<p>The issue didn't lye in this section of code at all.  We were passing a parameter string that wasn't handled as expected.  The subsequent call to the database returned no rows because the parameters we had passed in the previous call were incorrect.</p>\n"}], "owner": {"reputation": 63, "user_id": 793433, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/35c7b0d780f2b70ab9ee8bbe393b1d99?s=128&d=identicon&r=PG", "display_name": "matt weston", "link": "https://stackoverflow.com/users/793433/matt-weston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 35025808, "answer_count": 1, "score": -1, "last_activity_date": 1453849670, "creation_date": 1453331487, "last_edit_date": 1453356168, "question_id": 34912436, "link": "https://stackoverflow.com/questions/34912436/sqldataadapter-not-returning-rows", "title": "SqlDataAdapter not returning rows", "body": "<p>I have a <code>SqlDataAdapter</code> that I use to call a stored procedure that returns three result sets that are to fill a <code>DataSet</code>.</p>\n\n<p>The adapter works great for the 2nd and 3rd result sets, but the first one only returns the schema and not any rows.</p>\n\n<p>The stored procedure is written using a CTE to pull the first result set and calls two additional stored procedures for the 2nd and 3rd result sets.</p>\n\n<p>Any thoughts or suggestions as to what I can check?  My thoughts are that the issue lies between the database and the C# app.  I am thinking that the <code>SqlDataAdapter</code> is having an issue with the CTE.</p>\n"}, {"tags": ["c#", "sql", "postgresql", "sqlite", "ansi"], "comments": [{"owner": {"reputation": 1497, "user_id": 4987223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0850ea3162cafc96ef345404cf7dcca0?s=128&d=identicon&r=PG&f=1", "display_name": "vmachan", "link": "https://stackoverflow.com/users/4987223/vmachan"}, "edited": false, "score": 0, "creation_date": 1453343556, "post_id": 34912409, "comment_id": 57563988, "body": "I think what you need is Data Access Layer (DAL) to talk to your databases, this should abstract the database (SQL, Oracle, etc.) from your C# code. I know with Java you have things like Hibernate, unsure if that also works with .Net or C#, but you might find similar DALs for C#.  You can try <a href=\"http://www.npersistence.org/\" rel=\"nofollow noreferrer\">NPersistance</a> which seems to be geared for .Net."}, {"owner": {"reputation": 3785, "user_id": 2659189, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/aa5208474e7a4c1b7f5dc483beb9e222?s=128&d=identicon&r=PG", "display_name": "blgrnboy", "link": "https://stackoverflow.com/users/2659189/blgrnboy"}, "reply_to_user": {"reputation": 1497, "user_id": 4987223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0850ea3162cafc96ef345404cf7dcca0?s=128&d=identicon&r=PG&f=1", "display_name": "vmachan", "link": "https://stackoverflow.com/users/4987223/vmachan"}, "edited": false, "score": 0, "creation_date": 1453393741, "post_id": 34912409, "comment_id": 57591377, "body": "Isn&#39;t that geared more towards ORM?  We already use Entity Framework for the some other Databases and tables, but these in particular are considered auxiliary tables."}, {"owner": {"reputation": 1497, "user_id": 4987223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0850ea3162cafc96ef345404cf7dcca0?s=128&d=identicon&r=PG&f=1", "display_name": "vmachan", "link": "https://stackoverflow.com/users/4987223/vmachan"}, "edited": false, "score": 0, "creation_date": 1453394620, "post_id": 34912409, "comment_id": 57592041, "body": "Yes, ORM is another term in this space.. and I think it would apply to these auxillary tables as well, since you are trying to run the same code no matter what database (Oracle, SQL Server, etc.) you connect to.."}], "owner": {"reputation": 3785, "user_id": 2659189, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/aa5208474e7a4c1b7f5dc483beb9e222?s=128&d=identicon&r=PG", "display_name": "blgrnboy", "link": "https://stackoverflow.com/users/2659189/blgrnboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453331357, "creation_date": 1453331357, "question_id": 34912409, "link": "https://stackoverflow.com/questions/34912409/c-ansi-database-bulk-insert", "title": "C# ANSI Database Bulk Insert", "body": "<p>I am looking for a way to do multi row inserts with C# which can be universal enough so that the same procedures can be applied to more than just SQL Server.</p>\n\n<p>Right now, we have an application that can use SQLite, PostgreSQL, and SQL as a back end to store data, with a possibility of adding Oracle into the mix as well.  For that reason, it would be great to have a single procedure that can insert multiple rows in one round trip, and for that same procedure to work regardless of which Data Client is being used.  (For this reason, I am not using a SQL Server Stored Procedure).</p>\n"}, {"tags": ["c#", "asp.net-mvc", "entity-framework-6"], "comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1453332398, "post_id": 34912394, "comment_id": 57560762, "body": "Get a <code>Country</code> from the database and assign it to <code>City</code> or attach the <code>new County</code> to the context before assigning it."}, {"owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1453332543, "post_id": 34912394, "comment_id": 57560818, "body": "Can you post the code for this? if so, I mark as answer if it works right.  but would not give the same duplicity error? I would be entering a county that already exists in the database."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1453332668, "post_id": 34912394, "comment_id": 57560875, "body": "No, EF will see the object as <code>Unchanged</code> and therefore not insert it. No time for an &quot;official&quot; answer now. Someone else?"}, {"owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1453332936, "post_id": 34912394, "comment_id": 57560964, "body": "@GertArnold I am implementing it without problems for the explanation ... Implement step and the feedback then. If you can insert the code is easier to understand what the order process."}, {"owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1453333501, "post_id": 34912394, "comment_id": 57561145, "body": "@GertArnold i have the same error... so I selected in the form sought in the bank one count of the same name (as the name is my key) insert in City.County and when saved from the same mistake."}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453335722, "post_id": 34913070, "comment_id": 57561867, "body": "Same error! I think the solution is to find a way to do an override in CreateAsync and change the entity state.But I do not know how to do."}, {"owner": {"reputation": 739, "user_id": 3881866, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000032449654/picture?type=large", "display_name": "John Ephraim Tugado", "link": "https://stackoverflow.com/users/3881866/john-ephraim-tugado"}, "reply_to_user": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453335891, "post_id": 34913070, "comment_id": 57561905, "body": "If updating the entity state is what you want then do this db.Entry(myObject).State = System.Data.Entity.EntityState.Modified; db.SaveChanges(); where myObject is the existing record in the database you want to update"}, {"owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453336049, "post_id": 34913070, "comment_id": 57561950, "body": "I know how it works, but CreateAsync I use is Identity method and I do not know how to change."}, {"owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453337322, "post_id": 34913070, "comment_id": 57562332, "body": "simply give an override and not changing anything will not modify the error. Right?"}, {"owner": {"reputation": 739, "user_id": 3881866, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000032449654/picture?type=large", "display_name": "John Ephraim Tugado", "link": "https://stackoverflow.com/users/3881866/john-ephraim-tugado"}, "reply_to_user": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453338410, "post_id": 34913070, "comment_id": 57562653, "body": "Duplicate keys occur as you said, on what entity? ApplicationUser?"}, {"owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453338615, "post_id": 34913070, "comment_id": 57562712, "body": "County. if you read, you say that I insert the counties in the seed (Seed runs when the command to create the database), it leaves these values entered to me by default."}, {"owner": {"reputation": 739, "user_id": 3881866, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000032449654/picture?type=large", "display_name": "John Ephraim Tugado", "link": "https://stackoverflow.com/users/3881866/john-ephraim-tugado"}, "reply_to_user": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453342149, "post_id": 34913070, "comment_id": 57563619, "body": "Have you checked the database if a new record has been added to County after applying my first suggested answer? Please check the DB"}, {"owner": {"reputation": 739, "user_id": 3881866, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000032449654/picture?type=large", "display_name": "John Ephraim Tugado", "link": "https://stackoverflow.com/users/3881866/john-ephraim-tugado"}, "reply_to_user": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "edited": false, "score": 0, "creation_date": 1453346133, "post_id": 34913070, "comment_id": 57564696, "body": "I tested this solution in Web Api 2 and didn&#39;t have any problems. Simply search for the county record on the db and assign it to the user. No modifications to CreateAsync is needed. You can get the instance of the db using var db = Request.GetOwinContext().Get&lt;ApplicationDbContext&gt;();"}], "tags": [], "owner": {"reputation": 739, "user_id": 3881866, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000032449654/picture?type=large", "display_name": "John Ephraim Tugado", "link": "https://stackoverflow.com/users/3881866/john-ephraim-tugado"}, "is_accepted": false, "score": 0, "last_activity_date": 1453336810, "last_edit_date": 1453336810, "creation_date": 1453334807, "answer_id": 34913070, "question_id": 34912394, "link": "https://stackoverflow.com/questions/34912394/entity-framework-duplicated-key-on-createasync-idendity-method/34913070#34913070", "title": "Entity Framework: Duplicated Key on CreateAsync (Idendity method)", "body": "<p>Do something like this:</p>\n\n<pre><code>ApplicationDbContext db = new ApplicationDbContext();\n\nCountry county = db.Countie.FirstOrDefault(c =&gt; c.NameId == model.CountyId);\n\nif(county == null)\n{\n     ModelState.AddModelError(\"\", \"Invalid County\");\n}\nelse\n{\n    user.Address.City.County = county;\n}\n</code></pre>\n\n<p>Get the county record from the context and use it instead of creating a new one.</p>\n\n<p>Update:</p>\n\n<p>If you have your implementation of UserManager like this then you can simply override its behavior.</p>\n\n<pre><code> public class ApplicationUserManager : UserManager&lt;ApplicationUser&gt;\n {\n    public ApplicationUserManager(IUserStore&lt;ApplicationUser&gt; store)\n        : base(store)\n    {\n    }\n\n    public override System.Threading.Tasks.Task&lt;IdentityResult&gt; CreateAsync(ApplicationUser user, string password)\n    {\n        return base.CreateAsync(user, password);\n    }\n\n    public static ApplicationUserManager Create(IdentityFactoryOptions&lt;ApplicationUserManager&gt; options, IOwinContext context)\n    {\n        var manager = new ApplicationUserManager(new UserStore&lt;ApplicationUser&gt;(context.Get&lt;ApplicationDbContext&gt;()));\n        // Configure validation logic for usernames\n        manager.UserValidator = new UserValidator&lt;ApplicationUser&gt;(manager)\n        {\n            AllowOnlyAlphanumericUserNames = false,\n            RequireUniqueEmail = true\n        };\n        // Configure validation logic for passwords\n        manager.PasswordValidator = new PasswordValidator\n        {\n            RequiredLength = 6,\n            RequireNonLetterOrDigit = true,\n            RequireDigit = true,\n            RequireLowercase = true,\n            RequireUppercase = true,\n        };\n        var dataProtectionProvider = options.DataProtectionProvider;\n        if (dataProtectionProvider != null)\n        {\n            manager.UserTokenProvider = new DataProtectorTokenProvider&lt;ApplicationUser&gt;(dataProtectionProvider.Create(\"ASP.NET Identity\"));\n        }\n        return manager;\n    }\n}\n</code></pre>\n\n<p>And make sure you are using your ApplicationManager. In your Startup add this:</p>\n\n<pre><code> public void ConfigureAuth(IAppBuilder app)\n {\n        // Configure the db context and user manager to use a single instance per request\n        app.CreatePerOwinContext(ApplicationDbContext.Create);\n        app.CreatePerOwinContext&lt;ApplicationUserManager&gt;(ApplicationUserManager.Create);\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 5220431, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/fea9b04af31f19c49d4b4d4dc484af78?s=128&d=identicon&r=PG&f=1", "display_name": "Luiz Negrini", "link": "https://stackoverflow.com/users/5220431/luiz-negrini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 741, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453336810, "creation_date": 1453331303, "last_edit_date": 1453333724, "question_id": 34912394, "link": "https://stackoverflow.com/questions/34912394/entity-framework-duplicated-key-on-createasync-idendity-method", "title": "Entity Framework: Duplicated Key on CreateAsync (Idendity method)", "body": "<p>I'm having a duplicated key problem to insert my data in the database. The problem occurs because the implementation of the Seed method I insert some default values.</p>\n\n<p>After that the register I create a user who has complex relationship, follows the code:</p>\n\n<p><strong>Seed()</strong>:</p>\n\n<pre><code>//Counties\ncontext.Countie.AddOrUpdate(\n    c =&gt;  c.NameId ,\n    new County { NameId = \"Antrim\" },\n    new County { NameId = \"Armagh\" },\n    new County { NameId = \"Carlow\" },\n    new County { NameId = \"Cavan\" },\n    new County { NameId = \"Clare\" },\n    new County { NameId = \"Cork\" },\n    new County { NameId = \"Derry\" },\n    new County { NameId = \"Donegal\" },\n    new County { NameId = \"Down\" },\n    new County { NameId = \"Dublin\" },\n</code></pre>\n\n<p><strong>Register</strong>:</p>\n\n<pre><code>public async Task&lt;ActionResult&gt; Register(RegisterViewModel model)\n{\n    if (ModelState.IsValid)\n    {\n        var user = new ApplicationUser\n        {\n            UserName = model.Email,\n            Email = model.Email,\n            BornDate = model.BornDate,\n            Name = model.Name,\n            Gender = model.Gender,\n            Price = model.Price,\n            UserType = model.UserType,\n            PhoneNumber = model.PhoneNumber\n        };\n        if (model.Photo != null &amp;&amp; model.Photo.ContentLength &gt; 0)\n            user.PhotoPath = $\"\\\\Content\\\\UsersPhotos\\\\{FileUploaderHelper.Upload(model.Photo, model.UserType, user.Id)}\";\n\n        user.Address = new Address\n        {\n            Id = Guid.NewGuid().ToString(),\n            StreetAddress = model.StreetAddress,\n            PostalCode = model.PostalCode,\n            Number = model.StreetNumber\n        };\n            user.Address.City = new City\n        {\n            Id = Guid.NewGuid().ToString(),\n            Name = model.City,\n            County = new County { NameId = model.CountyId }\n        };\n            var geocoded = GeocodeHelper.GetGeoCodedAddress(user.Address);\n        user.Address.Latitude = geocoded.Coordinates.Latitude.ToString().Replace(\",\",\".\");\n        user.Address.Longitude = geocoded.Coordinates.Longitude.ToString().Replace(\",\", \".\");\n\n        try\n        {\n            var result = await UserManager.CreateAsync(user, model.Password); //error occurs here\n</code></pre>\n\n<p>I believe the error is because I am instantiating a new object. But what is the correct way to do?</p>\n\n<p>The following relationship follows:</p>\n\n<p>Address -> City -> County</p>\n\n<p>It can read:\nEvery address has a city which in turn has a County.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ci2Qi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ci2Qi.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "windows", "visual-studio", "uml", "windows-forms-designer"], "comments": [{"owner": {"reputation": 11096, "user_id": 541208, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2dfc2e563d2150994a6e06ef37f9e7be?s=128&d=identicon&r=PG", "display_name": "TankorSmash", "link": "https://stackoverflow.com/users/541208/tankorsmash"}, "edited": false, "score": 1, "creation_date": 1453331503, "post_id": 34912367, "comment_id": 57560435, "body": "You&#39;ll need to turn this into a better question for SO please. This sounds like you&#39;re asking us to write the project for you. What specifically do you want to know?"}, {"owner": {"reputation": 79, "user_id": 3443401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001051150170/picture?type=large", "display_name": "user3443401", "link": "https://stackoverflow.com/users/3443401/user3443401"}, "reply_to_user": {"reputation": 11096, "user_id": 541208, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2dfc2e563d2150994a6e06ef37f9e7be?s=128&d=identicon&r=PG", "display_name": "TankorSmash", "link": "https://stackoverflow.com/users/541208/tankorsmash"}, "edited": false, "score": 0, "creation_date": 1453331781, "post_id": 34912367, "comment_id": 57560543, "body": "I got this UML class diagram and was told to program this class in C# Visual studio i am confused on how to program UML classes"}, {"owner": {"reputation": 79, "user_id": 3443401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001051150170/picture?type=large", "display_name": "user3443401", "link": "https://stackoverflow.com/users/3443401/user3443401"}, "edited": false, "score": 0, "creation_date": 1453331939, "post_id": 34912367, "comment_id": 57560601, "body": "I am not Lazy bone Mr Thomas i m just asking the way to prgram it and better mind your language"}, {"owner": {"reputation": 11096, "user_id": 541208, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2dfc2e563d2150994a6e06ef37f9e7be?s=128&d=identicon&r=PG", "display_name": "TankorSmash", "link": "https://stackoverflow.com/users/541208/tankorsmash"}, "edited": false, "score": 0, "creation_date": 1453331952, "post_id": 34912367, "comment_id": 57560607, "body": "@user3443401 that&#39;s too vague though, you&#39;ll need to be specific. What part of the UML classes are you not familiar with? I&#39;m sure you know a bit of it. Remember we&#39;re not here to write it for you but to help you finish what you&#39;ve started"}, {"owner": {"reputation": 79, "user_id": 3443401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001051150170/picture?type=large", "display_name": "user3443401", "link": "https://stackoverflow.com/users/3443401/user3443401"}, "edited": false, "score": 0, "creation_date": 1453332020, "post_id": 34912367, "comment_id": 57560634, "body": "Just on how to prgram dialogresult i have done some work below :        class AutomotiveManager     {         private bool isBeingTested         {             set             {                 isBeingTested= false;             }         }"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 3443401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001051150170/picture?type=large", "display_name": "user3443401", "link": "https://stackoverflow.com/users/3443401/user3443401"}, "edited": false, "score": 0, "creation_date": 1453339901, "post_id": 34912787, "comment_id": 57563062, "body": "How can i code the messagebox :Dialog result"}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "reply_to_user": {"reputation": 79, "user_id": 3443401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001051150170/picture?type=large", "display_name": "user3443401", "link": "https://stackoverflow.com/users/3443401/user3443401"}, "edited": false, "score": 0, "creation_date": 1453340635, "post_id": 34912787, "comment_id": 57563276, "body": "Are you referring to the return result of the <code>ShowMessage()</code> operation or the <code>messageBoxResult</code> attribute?"}, {"owner": {"reputation": 79, "user_id": 3443401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001051150170/picture?type=large", "display_name": "user3443401", "link": "https://stackoverflow.com/users/3443401/user3443401"}, "edited": false, "score": 0, "creation_date": 1453343825, "post_id": 34912787, "comment_id": 57564040, "body": "i am referring both as i tried to class them but its showing me error"}], "tags": [], "owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "is_accepted": false, "score": 1, "last_activity_date": 1453333244, "creation_date": 1453333244, "answer_id": 34912787, "question_id": 34912367, "link": "https://stackoverflow.com/questions/34912367/how-can-i-program-this-uml-class-diagram-to-c-language/34912787#34912787", "title": "How can i program this UML class diagram to C# language?", "body": "<p>To convert your UML class diagram into a C# class, you'll need to understand what each of the symbols represent in your UML class diagram. This image from <a href=\"http://www.tutorialspoint.com/uml/uml_basic_notations.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com</a> is useful:\n<a href=\"https://i.stack.imgur.com/tqLLt.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tqLLt.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>From there, it's a matter of writing the equivalent C# code based on the symbols provided in your example.</p>\n"}, {"tags": [], "owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "is_accepted": true, "score": 2, "last_activity_date": 1453348196, "creation_date": 1453348196, "answer_id": 34915076, "question_id": 34912367, "link": "https://stackoverflow.com/questions/34912367/how-can-i-program-this-uml-class-diagram-to-c-language/34915076#34915076", "title": "How can i program this UML class diagram to C# language?", "body": "<p>It seems that there are a few different issues here.</p>\n\n<ul>\n<li>The difference between properties and attributes</li>\n<li>The meaning of the <code>=</code> in the attributes</li>\n<li>The error (which error?) you get for the declaration of the messageBoxResult</li>\n</ul>\n\n<p>Private <code>Attributes</code> are just private Attributes.\nSo the implementation of a private attribute like the <code>isBeingTested</code> would be</p>\n\n<pre><code>private bool isBeingTested;\n</code></pre>\n\n<p>The <code>=</code> in the attributes means the default value. So that would be the value you assign in the <code>constructor</code> or at the declaration of the attribute. For the <code>isBeingTested</code> you could add that to the declaration like this:</p>\n\n<pre><code>private bool isBeingTested = false;\n</code></pre>\n\n<p>But since in C# the default value for a boolean is false anyway you don't even need to specify it. The way you programmed it you will en up in an infinite loop the moment you try to use the setter for <code>isBeingTested</code></p>\n\n<p>The <code>\u00abProperty\u00bb</code> presumably indicates that you are meant to create a <code>Property</code> rather then an <code>Attribute</code>, and I guess the <code>{get;}</code> indicates that you only need to implement a getter, not a setter for this property. (I'm guessing here since none of that is defined in UML)</p>\n\n<p>The error you are getting is probably because the compiler doesn't know the type <code>dialogResult</code>. It may know the type <code>DialogResult</code> (notice the uppercase) if you add <code>System.Windows.Forms</code> as a reference to your project, and add a using statement like this</p>\n\n<pre><code>using System.Windows.Forms;\n</code></pre>\n\n<p>PS. You also failed to implement the <code>static</code> keyword on the class.</p>\n"}], "owner": {"reputation": 79, "user_id": 3443401, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001051150170/picture?type=large", "display_name": "user3443401", "link": "https://stackoverflow.com/users/3443401/user3443401"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "closed_date": 1454619674, "accepted_answer_id": 34915076, "answer_count": 2, "score": -3, "last_activity_date": 1453348196, "creation_date": 1453331166, "last_edit_date": 1453332237, "question_id": 34912367, "link": "https://stackoverflow.com/questions/34912367/how-can-i-program-this-uml-class-diagram-to-c-language", "closed_reason": "Needs details or clarity", "title": "How can i program this UML class diagram to C# language?", "body": "<p><a href=\"https://i.stack.imgur.com/HjM30.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HjM30.jpg\" alt=\"Automotive Class\"></a></p>\n\n<p>I am confused on how to create  class can you please help me??</p>\n\n<pre><code>   class AutomotiveManager\n{\n    private bool isBeingTested\n    {\n        set\n        {\n            isBeingTested= false;\n        }\n    }\n\n    private dialogResult MessageBoxResult\n    {\n            ///need help over here\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "sql-server"], "comments": [{"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 2, "creation_date": 1453331109, "post_id": 34912319, "comment_id": 57560286, "body": "This is hard. Shouldn&#39;t you measure cached performance anyway because it is more representative?"}, {"owner": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "edited": false, "score": 0, "creation_date": 1453331316, "post_id": 34912319, "comment_id": 57560364, "body": "How about just sending <code>dbcc dropcleanbuffers</code> prior to your query?"}, {"owner": {"reputation": 2729, "user_id": 4456072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53125b2b9ea9b9e5c95a6128097b235c?s=128&d=identicon&r=PG&f=1", "display_name": "Liesel", "link": "https://stackoverflow.com/users/4456072/liesel"}, "edited": false, "score": 2, "creation_date": 1453333003, "post_id": 34912319, "comment_id": 57560993, "body": "This is a bad idea and you most probably don&#39;t want to do this; doubly so in production. But if you must, <code>dbcc dropcleanbuffers</code> and <code>dbcc freeproccache</code> <a href=\"https://msdn.microsoft.com/en-AU/library/ms187762.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-AU/library/ms187762.aspx</a> and <a href=\"https://msdn.microsoft.com/en-us/library/ms174283.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms174283.aspx</a>"}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 1, "creation_date": 1453388611, "post_id": 34912319, "comment_id": 57587784, "body": "If performance matters - you are measuring it so I guess it does - you should be all cached, all the time. First buy enough RAM."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 2729, "user_id": 4456072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53125b2b9ea9b9e5c95a6128097b235c?s=128&d=identicon&r=PG&f=1", "display_name": "Liesel", "link": "https://stackoverflow.com/users/4456072/liesel"}, "edited": false, "score": 0, "creation_date": 1453388643, "post_id": 34912319, "comment_id": 57587797, "body": "@LesH, that&#39;s the answer."}], "answers": [{"tags": [], "owner": {"reputation": 1893, "user_id": 741326, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/544276e94455fea1fb3b2fbb3a06d3b3?s=128&d=identicon&r=PG", "display_name": "saarp", "link": "https://stackoverflow.com/users/741326/saarp"}, "is_accepted": true, "score": 0, "last_activity_date": 1453405008, "creation_date": 1453405008, "answer_id": 34932780, "question_id": 34912319, "link": "https://stackoverflow.com/questions/34912319/disabling-sql-servers-caching-through-net-code/34932780#34932780", "title": "Disabling SQL Server&#39;s caching through .NET code", "body": "<p>First thing, by \"cacheing\" here I'm assuming you're referring to the Execution Plan Cache. Once SQL Server figures out the best order to execute your statements, it stores it for a while. This problem is commonly known as \"Parameter Sniffing\". This is what you clear when you run <code>dbcc freeproccache</code>. Unfortunately, that's an admin-privileged command and it affects all connections.</p>\n\n<p>The root of the problem is that your SQL probably performs differently with a different set of parameters. SQL Server will only store the execution plan of the first execution it sees and the parameters associated with it. So if the arguments on first execution are good for the common case, your app will perform fine. But once in a while, the wrong arguments will get used on first execution and your entire application can perform poorly.</p>\n\n<p>There are a number of ways to optimize your SQL statement to reduce the impact of this, but it's not completely avoidable.</p>\n\n<ol>\n<li>Generate the SQL dynamically - You take the performance hit of generating a query plan on each execution, but this may be worth it if using the wrong execution plan causes your query to never return. I suggest this path, though it is more cumbersome. I found <code>SET STATISTICS TIME ON</code> and SQL Profiler helpful in reducing the plan generation time. The biggest improvement came from using 3-part naming (<code>owner.schema.table</code>) for the tables.</li>\n<li>Specify a \"good set\" of initial parameters for your query with query hints.</li>\n</ol>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT Col1, Col2\nFROM dbo.MySchema.MyTab\nWHERE Col1=@Parameter\nOPTION (OPTIMIZE FOR (@Parameter='value'));\n</code></pre>\n\n<p>This link describe the <a href=\"http://www.brentozar.com/archive/2013/06/the-elephant-and-the-mouse-or-parameter-sniffing-in-sql-server/\" rel=\"nofollow\">parameter sniffing problem</a> fairly well. This was a bigger problem in SQL 2005. Later versions of SQL did a better job of avoiding this.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user499054"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 34932780, "answer_count": 1, "score": 5, "last_activity_date": 1453405008, "creation_date": 1453330912, "last_edit_date": 1453397435, "question_id": 34912319, "link": "https://stackoverflow.com/questions/34912319/disabling-sql-servers-caching-through-net-code", "title": "Disabling SQL Server&#39;s caching through .NET code", "body": "<p>I am currently calling up several stored procedures in some .NET code, <code>SqlConnection</code>. I'd like to disable the caching done by SQL Server, so that I can measure performance periodically (I'm gonna be comparing it to another server that likely won't have any cached data either). Is this possible to do without modifying the sprocs?</p>\n\n<p>This is the code that I am currently using:</p>\n\n<pre><code>using (SqlConnection connection = new SqlConnection(/* connection string goes here */)) {\n\n    SqlCommand command = new SqlCommand(procName, connection);\n    command.Parameters.AddRange(parameters);\n    command.CommandType = System.Data.CommandType.StoredProcedure;\n    connection.Open();\n\n    SqlDataReader r = command.ExecuteReader();\n    // todo: read data here\n    r.Close();\n    connection.Close();\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "gridview", "mvvm"], "comments": [{"owner": {"reputation": 12228, "user_id": 271106, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/RN48w.jpg?s=128&g=1", "display_name": "Michal Ciechan", "link": "https://stackoverflow.com/users/271106/michal-ciechan"}, "edited": false, "score": 0, "creation_date": 1453331617, "post_id": 34912284, "comment_id": 57560481, "body": "Could you provide the VM and a method that returns it with some sample data I can use for testing. Sorry feeling a bit lazy to reverse engineer atm"}, {"owner": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "reply_to_user": {"reputation": 12228, "user_id": 271106, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/RN48w.jpg?s=128&g=1", "display_name": "Michal Ciechan", "link": "https://stackoverflow.com/users/271106/michal-ciechan"}, "edited": false, "score": 0, "creation_date": 1453332584, "post_id": 34912284, "comment_id": 57560832, "body": "I have updated my question to include the full view and view model code.  Please note I&#39;m using MVVM Light."}, {"owner": {"reputation": 2632, "user_id": 5443818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59fea2cb8588725f8284b6125ab3528?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/5443818/ilan"}, "edited": false, "score": 0, "creation_date": 1453641064, "post_id": 34912284, "comment_id": 57681755, "body": "@Kurorion please look at the next solution it is a good starting point to your question - <a href=\"http://stackoverflow.com/questions/2643545/wpf-mvvm-how-to-bind-gridviewcolumn-to-viewmodel-collection\" title=\"wpf mvvm how to bind gridviewcolumn to viewmodel collection\">stackoverflow.com/questions/2643545/&hellip;</a>. Let me know if you will have problems with the code."}, {"owner": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "reply_to_user": {"reputation": 2632, "user_id": 5443818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59fea2cb8588725f8284b6125ab3528?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/5443818/ilan"}, "edited": false, "score": 0, "creation_date": 1453925285, "post_id": 34912284, "comment_id": 57818224, "body": "@Ilan Thanks for pointing out Dan Parsonson&#39;s solution.  But I&#39;m not really sure how to implement it.  Are you able to provide a short example of the implementation?"}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "edited": false, "score": 0, "creation_date": 1454114485, "post_id": 35066853, "comment_id": 57914829, "body": "your solution looks amazing and I really appreciate your help.  But there is still one little problem.  In my question, the elements in my data collection aren&#39;t made of a class, instead they are nested collection of primitive objects with INotifyPropertyChanged interface (therefore the two dimensional collection).    How can I map the elements in the nested collection to column descriptor collection (like you do with the Person class properties)?"}, {"owner": {"reputation": 2632, "user_id": 5443818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59fea2cb8588725f8284b6125ab3528?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/5443818/ilan"}, "reply_to_user": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "edited": false, "score": 0, "creation_date": 1454225670, "post_id": 35066853, "comment_id": 57943597, "body": "@Kurorion can you please explain again why do you need that two dimensional  collection?"}, {"owner": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "edited": false, "score": 0, "creation_date": 1454343518, "post_id": 35066853, "comment_id": 57990406, "body": "the data is provided to me by the backend programmer.  He would like to feed data from the database that can be of any type and number of rows/columns.  Some of the data can also be updated, therefore needing to be formatted based on the data type.  Basically the view needs to sets of data with varying type and columns without needing to update the view and viewmodel code.  But thinking about it, I believe I can make your solution work  as well.  I still haven&#39;t had time to try it out, been stuck on another project at the moment.  I will let you know!"}, {"owner": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "edited": false, "score": 0, "creation_date": 1454602691, "post_id": 35066853, "comment_id": 58127762, "body": "I just tried your original solution and it works great. It also really helped me view the problem from another perspective.  The backend programmer and myself can definitely adapt it to our project.  Thanks again!"}], "tags": [], "owner": {"reputation": 2632, "user_id": 5443818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59fea2cb8588725f8284b6125ab3528?s=128&d=identicon&r=PG&f=1", "display_name": "Ilan", "link": "https://stackoverflow.com/users/5443818/ilan"}, "is_accepted": true, "score": 0, "last_activity_date": 1454228946, "last_edit_date": 1495542659, "creation_date": 1453998692, "answer_id": 35066853, "question_id": 34912284, "link": "https://stackoverflow.com/questions/34912284/wpf-mvvm-binding-two-dimensional-collection-to-gridview/35066853#35066853", "title": "WPF: MVVM Binding Two Dimensional Collection to GridView", "body": "<p>please try the next solution. All credits to guys which provided us with solution <a href=\"https://stackoverflow.com/questions/2643545/wpf-mvvm-how-to-bind-gridviewcolumn-to-viewmodel-collection\">here</a>. So I've tried to match your question to solution of guys in the link behind. </p>\n\n<p><strong>XAML</strong></p>\n\n<pre><code>&lt;UserControl x:Class=\"WPFAddGridViewColumnDynamicHelpAttempt.BindingTest\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n         xmlns:clr=\"clr-namespace:System;assembly=mscorlib\"\n         xmlns:wpfAddGridViewColumnDynamicHelpAttempt=\"clr-namespace:WPFAddGridViewColumnDynamicHelpAttempt\"\n         mc:Ignorable=\"d\" \n         d:DesignHeight=\"300\" d:DesignWidth=\"300\"&gt;\n&lt;UserControl.DataContext&gt;\n    &lt;wpfAddGridViewColumnDynamicHelpAttempt:ViewModel/&gt;\n&lt;/UserControl.DataContext&gt;\n&lt;ListView x:Name=\"ListView\" ItemsSource=\"{Binding Data}\" Grid.Row=\"0\"&gt;\n    &lt;ListView.View&gt;\n        &lt;GridView wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.HeaderTextMember=\"HeaderText\"\n                  wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.Parent=\"{Binding ElementName=ListView}\"\n                  wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.DisplayMemberMember=\"DisplayMember\"\n                  wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.ColumnTemplateKey=\"ColumnTemplateTemplateKey\"\n                  wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.ColumnsSource=\"{Binding ColumnHeaders}\"&gt;\n        &lt;/GridView&gt;\n    &lt;/ListView.View&gt;\n&lt;/ListView&gt;&lt;/UserControl&gt;\n</code></pre>\n\n<p><strong>ViewModel and models (please see comments)</strong></p>\n\n<pre><code>public class ViewModel : BaseObservableObject\n{\n    public ObservableCollection&lt;ColumnDescriptor&gt; ColumnHeaders\n    {\n        get { return _columnHeaders; }\n        set\n        {\n            if (_columnHeaders == value)\n                return;\n\n            _columnHeaders = value;\n            OnPropertyChanged(() =&gt; ColumnHeaders);\n        }\n    }\n\n    public ObservableCollection&lt;Person&gt; Data\n    {\n        get { return _data; }\n        set\n        {\n            if (_data == value)\n                return;\n\n            _data = value;\n            OnPropertyChanged(() =&gt; Data);\n        }\n    }\n\n    //here I've changed the column object from string to ColumnDescriptor object,\n    //to match the values defined in AttachedPropeties (GridViewColumns class)\n    //please keep in mind that every colun is binded to data in model, thus if your model \n    //won't have property named Salary, but your ColumnHeaders collection will have the ColumnDescriptor \n    //with that DisplayMember you will have binding expression exception in output window.\n    //So you have define ColumnHeaders collection with certain number of ColumnDescriptors (as you want to display by model).\n    private ObservableCollection&lt;ColumnDescriptor&gt; _columnHeaders;\n\n    //since the Data is binded to the listview that give its ItemsSource to the GridView,\n    //we don't have to have an ObservableCollection of ObservableCollections of objects, we can provide the actual values and \n    //they will be distrebuted to presented columns\n    private ObservableCollection&lt;Person&gt; _data;\n\n    public ViewModel()\n    {\n        ColumnHeaders = new ObservableCollection&lt;ColumnDescriptor&gt;\n        {\n            new ColumnDescriptor {HeaderText = \"Last name\", DisplayMember = \"LastName\", ColumnTemplateTemplateKey = typeof(String)},\n            new ColumnDescriptor {HeaderText = \"First name\", DisplayMember = \"FirstName\", ColumnTemplateTemplateKey = typeof(String)},\n            new ColumnDescriptor {HeaderText = \"Salary\", DisplayMember = \"Salary\", ColumnTemplateTemplateKey = typeof(String)},\n            new ColumnDescriptor {HeaderText = \"Date Of Birth\", DisplayMember = \"DateOfBirth\", ColumnTemplateTemplateKey = typeof(DateTime)},\n            new ColumnDescriptor {HeaderText = \"Gift Was Delivered\", DisplayMember = \"GiftWasDelivered\", ColumnTemplateTemplateKey = typeof(Boolean)},\n        };\n\n        Data = new ObservableCollection&lt;Person&gt;();\n\n        for (int i = 0; i &lt; 5; i++)\n        {\n            Data = new ObservableCollection&lt;Person&gt;\n            {\n                new Person {FirstName = \"John\", LastName = \"A.\", DateOfBirth=new DateTime(1965, 12, 1), GiftWasDelivered = false},\n                new Person {FirstName = \"Ron\", LastName = \"B.\", DateOfBirth=new DateTime(1995, 6, 8), GiftWasDelivered = false}\n            };\n        }\n    }\n}\n\n/// &lt;summary&gt;\n/// defines the column data (column heder text and column content)\n/// &lt;/summary&gt;\npublic class ColumnDescriptor\n{\n    /// &lt;summary&gt;\n    /// defines the actual text that will be shown in the grid view column header\n    /// &lt;/summary&gt;\n    public string HeaderText { get; set; }\n    /// &lt;summary&gt;\n    /// defines the name of the property in view model that will be presented by this column\n    /// &lt;/summary&gt;\n    public string DisplayMember { get; set; }\n\n    /// &lt;summary&gt;\n    /// defines the key of thew template\n    /// &lt;/summary&gt;\n    public object ColumnTemplateTemplateKey { get; set; }\n}\n\npublic class Person:BaseObservableObject\n{\n    private string _name;\n    private string _lastName;\n    private DateTime _dateOfBirth;\n    private bool _giftWasDelivered;\n\n    public bool GiftWasDelivered\n    {\n        get { return _giftWasDelivered; }\n        set\n        {\n            _giftWasDelivered = value;\n            OnPropertyChanged();\n        }\n    }\n\n    public string FirstName\n    {\n        get { return _name; }\n        set\n        {\n            _name = value;\n            OnPropertyChanged();\n        }\n    }\n\n    public string LastName\n    {\n        get { return _lastName; }\n        set\n        {\n            _lastName = value;\n            OnPropertyChanged();\n        }\n    }\n\n    public DateTime DateOfBirth\n    {\n        get { return _dateOfBirth; }\n        set\n        {\n            _dateOfBirth = value;\n            OnPropertyChanged();\n        }\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p><strong>Adapted Attached propertis from <a href=\"https://stackoverflow.com/questions/2643545/wpf-mvvm-how-to-bind-gridviewcolumn-to-viewmodel-collection\">here</a>, use this as a black box solution</strong></p>\n\n<pre><code>public static class GridViewColumns\n{\n    [AttachedPropertyBrowsableForType(typeof(GridView))]\n    public static object GetColumnsSource(DependencyObject obj)\n    {\n        return (object)obj.GetValue(ColumnsSourceProperty);\n    }\n\n    public static void SetColumnsSource(DependencyObject obj, object value)\n    {\n        obj.SetValue(ColumnsSourceProperty, value);\n    }\n\n    // Using a DependencyProperty as the backing store for ColumnsSource.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty ColumnsSourceProperty =\n        DependencyProperty.RegisterAttached(\n            \"ColumnsSource\",\n            typeof(object),\n            typeof(GridViewColumns),\n            new UIPropertyMetadata(\n                null,\n                ColumnsSourceChanged));\n\n\n    [AttachedPropertyBrowsableForType(typeof(GridView))]\n    public static string GetHeaderTextMember(DependencyObject obj)\n    {\n        return (string)obj.GetValue(HeaderTextMemberProperty);\n    }\n\n    public static void SetHeaderTextMember(DependencyObject obj, string value)\n    {\n        obj.SetValue(HeaderTextMemberProperty, value);\n    }\n\n    // Using a DependencyProperty as the backing store for HeaderTextMember.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty HeaderTextMemberProperty =\n        DependencyProperty.RegisterAttached(\"HeaderTextMember\", typeof(string), typeof(GridViewColumns), new UIPropertyMetadata(null));\n\n\n    [AttachedPropertyBrowsableForType(typeof(GridView))]\n    public static string GetDisplayMemberMember(DependencyObject obj)\n    {\n        return (string)obj.GetValue(DisplayMemberMemberProperty);\n    }\n\n    public static void SetDisplayMemberMember(DependencyObject obj, string value)\n    {\n        obj.SetValue(DisplayMemberMemberProperty, value);\n    }\n\n    // Using a DependencyProperty as the backing store for DisplayMember.  This enables animation, styling, binding, etc...\n    public static readonly DependencyProperty DisplayMemberMemberProperty =\n        DependencyProperty.RegisterAttached(\"DisplayMemberMember\", typeof(string), typeof(GridViewColumns), new UIPropertyMetadata(null));\n\n\n    private static void ColumnsSourceChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)\n    {\n        GridView gridView = obj as GridView;\n        if (gridView != null)\n        {\n            gridView.Columns.Clear();\n\n            if (e.OldValue != null)\n            {\n                ICollectionView view = CollectionViewSource.GetDefaultView(e.OldValue);\n                if (view != null)\n                    RemoveHandlers(gridView, view);\n            }\n\n            if (e.NewValue != null)\n            {\n                ICollectionView view = CollectionViewSource.GetDefaultView(e.NewValue);\n                if (view != null)\n                {\n                    AddHandlers(gridView, view);\n                    CreateColumns(gridView, view);\n                }\n            }\n        }\n    }\n\n    private static IDictionary&lt;ICollectionView, List&lt;GridView&gt;&gt; _gridViewsByColumnsSource =\n        new Dictionary&lt;ICollectionView, List&lt;GridView&gt;&gt;();\n\n    [AttachedPropertyBrowsableForType(typeof(GridView))]\n    public static string GetColumnTemplateKey(DependencyObject element)\n    {\n        return (string)element.GetValue(ColumnTemplateKeyProperty);\n    }\n\n    public static void SetColumnTemplateKey(DependencyObject element, string value)\n    {\n        element.SetValue(ColumnTemplateKeyProperty, value);\n    }\n\n    public static readonly DependencyProperty ColumnTemplateKeyProperty =\n        DependencyProperty.RegisterAttached(\"ColumnTemplateKey\", typeof (string), typeof (GridViewColumns),\n            new PropertyMetadata(default(string)));\n\n    public static object GetParent(DependencyObject element)\n    {\n        return (object)element.GetValue(ParentProperty);\n    }\n\n    public static void SetParent(DependencyObject element, object value)\n    {\n        element.SetValue(ParentProperty, value);\n    }\n\n    public static readonly DependencyProperty ParentProperty = DependencyProperty.RegisterAttached(\"Parent\",\n        typeof (object), typeof (GridViewColumns), new PropertyMetadata(default(object)));\n\n    private static List&lt;GridView&gt; GetGridViewsForColumnSource(ICollectionView columnSource)\n    {\n        List&lt;GridView&gt; gridViews;\n        if (!_gridViewsByColumnsSource.TryGetValue(columnSource, out gridViews))\n        {\n            gridViews = new List&lt;GridView&gt;();\n            _gridViewsByColumnsSource.Add(columnSource, gridViews);\n        }\n        return gridViews;\n    }\n\n    private static void AddHandlers(GridView gridView, ICollectionView view)\n    {\n        GetGridViewsForColumnSource(view).Add(gridView);\n        view.CollectionChanged += ColumnsSource_CollectionChanged;\n    }\n\n    private static void CreateColumns(GridView gridView, ICollectionView view)\n    {\n        foreach (var item in view)\n        {\n            GridViewColumn column = CreateColumn(gridView, item);\n            gridView.Columns.Add(column);\n        }\n    }\n\n    private static void RemoveHandlers(GridView gridView, ICollectionView view)\n    {\n        view.CollectionChanged -= ColumnsSource_CollectionChanged;\n        GetGridViewsForColumnSource(view).Remove(gridView);\n    }\n\n    private static void ColumnsSource_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)\n    {\n        ICollectionView view = sender as ICollectionView;\n        var gridViews = GetGridViewsForColumnSource(view);\n        if (gridViews == null || gridViews.Count == 0)\n            return;\n\n        switch (e.Action)\n        {\n            case NotifyCollectionChangedAction.Add:\n                foreach (var gridView in gridViews)\n                {\n                    for (int i = 0; i &lt; e.NewItems.Count; i++)\n                    {\n                        GridViewColumn column = CreateColumn(gridView, e.NewItems[i]);\n                        gridView.Columns.Insert(e.NewStartingIndex + i, column);\n                    }\n                }\n                break;\n            case NotifyCollectionChangedAction.Move:\n                foreach (var gridView in gridViews)\n                {\n                    List&lt;GridViewColumn&gt; columns = new List&lt;GridViewColumn&gt;();\n                    for (int i = 0; i &lt; e.OldItems.Count; i++)\n                    {\n                        GridViewColumn column = gridView.Columns[e.OldStartingIndex + i];\n                        columns.Add(column);\n                    }\n                    for (int i = 0; i &lt; e.NewItems.Count; i++)\n                    {\n                        GridViewColumn column = columns[i];\n                        gridView.Columns.Insert(e.NewStartingIndex + i, column);\n                    }\n                }\n                break;\n            case NotifyCollectionChangedAction.Remove:\n                foreach (var gridView in gridViews)\n                {\n                    for (int i = 0; i &lt; e.OldItems.Count; i++)\n                    {\n                        gridView.Columns.RemoveAt(e.OldStartingIndex);\n                    }\n                }\n                break;\n            case NotifyCollectionChangedAction.Replace:\n                foreach (var gridView in gridViews)\n                {\n                    for (int i = 0; i &lt; e.NewItems.Count; i++)\n                    {\n                        GridViewColumn column = CreateColumn(gridView, e.NewItems[i]);\n                        gridView.Columns[e.NewStartingIndex + i] = column;\n                    }\n                }\n                break;\n            case NotifyCollectionChangedAction.Reset:\n                foreach (var gridView in gridViews)\n                {\n                    gridView.Columns.Clear();\n                    CreateColumns(gridView, sender as ICollectionView);\n                }\n                break;\n            default:\n                break;\n        }\n    }\n\n    //here we create columns and define theire binding,\n    //in addition we can create (or find) data template for each columns\n    private static GridViewColumn CreateColumn(GridView gridView, object columnSource)\n    {\n        GridViewColumn column = new GridViewColumn();\n        string headerTextMember = GetHeaderTextMember(gridView);\n        string displayMemberMember = GetDisplayMemberMember(gridView);\n        string templateKey = GetColumnTemplateKey(gridView);\n        if (!string.IsNullOrEmpty(headerTextMember))\n        {\n            column.Header = GetPropertyValue(columnSource, headerTextMember);\n        }\n        if (!string.IsNullOrEmpty(templateKey))\n        {\n            DefineSimpleCustomDataTemplateWithBinding(columnSource, templateKey, displayMemberMember, column);\n        }\n        else\n        {\n            DefineDefaultBinding(columnSource, displayMemberMember, column);\n        }\n        return column;\n    }\n\n    private static void DefineSimpleCustomDataTemplateWithBinding(object columnSource, string templateKey, string displayMemberMember,\n        GridViewColumn column)\n    {\n        var keyType = GetPropertyValue(columnSource, templateKey) as Type;\n        if (keyType == null)\n        {\n            DefineDefaultBinding(columnSource, displayMemberMember, column);\n        }\n        else\n        {\n            var propertyName = GetPropertyValue(columnSource, displayMemberMember) as string;\n            var binding = new Binding(propertyName) {FallbackValue = \"data is not presented by provided model\"};\n            var dataTemplate = DataTemplateFactory.GetDataTemplateWithBindingByType(keyType, binding);\n            if (dataTemplate == null)\n            {\n                DefineDefaultBinding(columnSource, displayMemberMember, column);\n            }\n            else\n            {\n                column.CellTemplate = dataTemplate;\n            }\n        }\n    }\n\n    private static void DefineDefaultBinding(object columnSource, string displayMemberMember, GridViewColumn column)\n    {\n        if (!string.IsNullOrEmpty(displayMemberMember))\n        {\n            string propertyName = GetPropertyValue(columnSource, displayMemberMember) as string;\n            var binding = new Binding(propertyName) {FallbackValue = \"data is not presented by provided model\"};\n            column.DisplayMemberBinding = binding;\n        }\n    }\n\n    private static object GetPropertyValue(object obj, string propertyName)\n    {\n        if (obj != null)\n        {\n            PropertyInfo prop = obj.GetType().GetProperty(propertyName);\n            if (prop != null)\n                return prop.GetValue(obj, null);\n        }\n        return null;\n    }\n}\n</code></pre>\n\n<p><strong>Factory to create data template in code (create your own as you need)</strong></p>\n\n<pre><code>    /// &lt;summary&gt;\n/// helps to define simple data template in code\n/// &lt;/summary&gt;\npublic class DataTemplateFactory\n{\n    public static DataTemplate GetDataTemplateWithBindingByType(Type type, Binding binding)\n    {\n        var key = type.Name;\n\n        DataTemplate template;\n        switch (key)\n        {\n            case \"String\":\n            {\n                template = GetStringTemplate(binding);\n            }\n            break;\n            case \"Boolean\":\n            {\n                template = GetBooleanTemplate(binding);\n            }\n            break;\n            case \"DateTime\":\n            {\n                template = GetDateTimeTemplate(binding);\n            }\n            break;\n            default:\n                return null;\n        }\n        return template;\n    }\n\n    private static DataTemplate GetDateTimeTemplate(Binding binding)\n    {\n        DataTemplate template = new DataTemplate();\n        FrameworkElementFactory factory = new FrameworkElementFactory(typeof(DatePicker));\n        factory.SetValue(Control.BackgroundProperty, Brushes.CadetBlue);\n        factory.SetBinding(DatePicker.SelectedDateProperty, binding);\n        template.VisualTree = factory;\n        return template;\n    }\n\n    private static DataTemplate GetBooleanTemplate(Binding binding)\n    {\n        DataTemplate template = new DataTemplate();\n        FrameworkElementFactory factory = new FrameworkElementFactory(typeof(CheckBox));\n        factory.SetValue(ContentControl.ContentProperty, \"\");\n        factory.SetValue(Control.BackgroundProperty, Brushes.Green);\n        factory.SetBinding(ToggleButton.IsCheckedProperty, binding);\n        template.VisualTree = factory;\n        return template;\n    }\n\n    private static DataTemplate GetStringTemplate(Binding binding)\n    {\n        DataTemplate template = new DataTemplate();\n        FrameworkElementFactory factory = new FrameworkElementFactory(typeof(TextBlock));\n        factory.SetValue(TextBlock.TextAlignmentProperty, TextAlignment.Left);\n        factory.SetValue(TextBlock.BackgroundProperty, Brushes.Tomato);\n        factory.SetBinding(TextBlock.TextProperty, binding);\n        template.VisualTree = factory;\n        return template;\n    }\n}\n</code></pre>\n\n<p><strong>How its looks like:</strong>\n<a href=\"https://i.stack.imgur.com/JZkUb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JZkUb.png\" alt=\"here\"></a></p>\n\n<p><strong>Update (added mappers)</strong></p>\n\n<p><strong>Xaml code</strong></p>\n\n<pre><code>&lt;UserControl x:Class=\"WPFAddGridViewColumnDynamicHelpAttempt.BindingTest\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n         xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n         xmlns:clr=\"clr-namespace:System;assembly=mscorlib\"\n         xmlns:wpfAddGridViewColumnDynamicHelpAttempt=\"clr-namespace:WPFAddGridViewColumnDynamicHelpAttempt\"\n         mc:Ignorable=\"d\" \n         d:DesignHeight=\"300\" d:DesignWidth=\"300\" x:Name=\"This\"&gt;\n&lt;UserControl.DataContext&gt;\n    &lt;wpfAddGridViewColumnDynamicHelpAttempt:UpdatedViewModel/&gt;\n&lt;/UserControl.DataContext&gt;\n&lt;ListView x:Name=\"OuterListView\" ItemsSource=\"{Binding Data}\"&gt;\n    &lt;ListView.ItemContainerStyle&gt;\n        &lt;Style TargetType=\"ListViewItem\"&gt;\n            &lt;Setter Property=\"ContentTemplate\"&gt;\n                &lt;Setter.Value&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;ListView x:Name=\"InnerListView\" ItemsSource=\"{Binding MappedObjects}\"&gt;\n                            &lt;ListView.View&gt;\n                                &lt;GridView wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.HeaderTextMember=\"HeaderText\"\n                                          wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.DisplayMemberMember=\"DisplayMember\"\n                                          wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.ColumnTemplateKey=\"ColumnTemplateTemplateKey\"\n                                          wpfAddGridViewColumnDynamicHelpAttempt:GridViewColumns.ColumnsSource=\"{Binding ElementName=This, Path=DataContext.ColumnHeaders}\"&gt;\n                                &lt;/GridView&gt;\n                            &lt;/ListView.View&gt;\n                        &lt;/ListView&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/Setter.Value&gt;\n            &lt;/Setter&gt;\n        &lt;/Style&gt;\n    &lt;/ListView.ItemContainerStyle&gt;\n&lt;/ListView&gt;&lt;/UserControl&gt;\n</code></pre>\n\n<p><strong>ViewMOdel and mappers</strong></p>\n\n<pre><code>public class UpdatedViewModel:BaseObservableObject\n{\n    public ObservableCollection&lt;ColumnDescriptor&gt; ColumnHeaders \n    {\n        get { return _columnHeaders; } \n        set\n        {\n            if (_columnHeaders == value)\n                return;\n\n            _columnHeaders = value;\n            OnPropertyChanged(() =&gt; ColumnHeaders);\n        }\n    }\n\n    public ObservableCollection&lt;MappedCollection&lt;MappedObject&gt;&gt; Data\n    {\n        get { return _data; }\n        set\n        {\n            if (_data == value)\n                return;\n\n            _data = value;\n            OnPropertyChanged(() =&gt; Data);\n        }\n    }\n\n    private ObservableCollection&lt;ColumnDescriptor&gt; _columnHeaders;\n    private ObservableCollection&lt;MappedCollection&lt;MappedObject&gt;&gt; _data;\n\n    public UpdatedViewModel()\n    {\n        //ColumnHeaders = new ObservableCollection&lt;string&gt;();\n        //ColumnHeaders.Add(\"String Column\");\n        //ColumnHeaders.Add(\"Boolean Column\");\n\n        ColumnHeaders = new ObservableCollection&lt;ColumnDescriptor&gt;\n        {\n            new ColumnDescriptor {HeaderText = \"String Column\", DisplayMember = \"StringColumn\", ColumnTemplateTemplateKey = typeof(String)},\n            new ColumnDescriptor {HeaderText = \"Bolean Column\", DisplayMember = \"BoleanColumn\", ColumnTemplateTemplateKey = typeof(Boolean)},\n        };\n\n        Data = new ObservableCollection&lt;MappedCollection&lt;MappedObject&gt;&gt;();\n        var mappedCollection = new MappedCollection&lt;MappedObject&gt;();\n        for(int i = 0; i &lt; 5; i++)\n        {\n            //row.Add(\"cell \" + i);\n            //row.Add(i % 2 == 0 ? true : false);\n            mappedCollection.MappedObjects.Add(new MappedObject { StringColumn = string.Format(\"cell:{0}\", i), BoleanColumn = i % 2 == 0 });\n\n        }\n        Data.Add(mappedCollection);\n    }\n}\n\npublic class MappedCollection&lt;T&gt;:BaseObservableObject\n{\n    private ObservableCollection&lt;T&gt; _mappedObjects;\n\n    public MappedCollection()\n    {\n        MappedObjects = new ObservableCollection&lt;T&gt;();\n    }\n\n    public ObservableCollection&lt;T&gt; MappedObjects\n    {\n        get { return _mappedObjects; }\n        set\n        {\n            _mappedObjects = value;\n            OnPropertyChanged();\n        }\n    }\n}\n\npublic class MappedObject:BaseObservableObject\n{\n    private object _stringColumn;\n    private object _boleanColumn;\n\n    public object StringColumn\n    {\n        get { return _stringColumn; }\n        set\n        {\n            _stringColumn = value;\n            OnPropertyChanged();\n        }\n    }\n\n    public object BoleanColumn\n    {\n        get { return _boleanColumn; }\n        set\n        {\n            _boleanColumn = value;\n            OnPropertyChanged();\n        }\n    }\n}\n</code></pre>\n\n<p>I'll glad to help if there will be problems with the code.</p>\n\n<p>Regards.</p>\n"}], "owner": {"reputation": 88, "user_id": 5786449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c29a9d1ee9e259d3ea3231e93a214ea?s=128&d=identicon&r=PG&f=1", "display_name": "Kurorion", "link": "https://stackoverflow.com/users/5786449/kurorion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1267, "favorite_count": 0, "accepted_answer_id": 35066853, "answer_count": 1, "score": 0, "last_activity_date": 1454228946, "creation_date": 1453330757, "last_edit_date": 1453332904, "question_id": 34912284, "link": "https://stackoverflow.com/questions/34912284/wpf-mvvm-binding-two-dimensional-collection-to-gridview", "title": "WPF: MVVM Binding Two Dimensional Collection to GridView", "body": "<p>I'm looking for a way to bind a two dimensional collection to a <code>ListView</code> <code>GridView</code>.  So far I have been able to bind my data to nested <code>ItemsControl</code> controls that look like a grid.  However I would like it to behave like a <code>GridView</code> where the columns can be resized by the user.</p>\n\n<p>The view model looks like this:</p>\n\n<pre><code>using GalaSoft.MvvmLight;\nusing System.Collections.ObjectModel;\n\nnamespace BindingTest\n{\n    public class ViewModel : ViewModelBase\n    {\n        public ObservableCollection&lt;string&gt; ColumnHeaders \n        {\n            get { return _columnHeaders; } \n            set\n            {\n                if (_columnHeaders == value)\n                    return;\n\n                _columnHeaders = value;\n                RaisePropertyChanged(() =&gt; ColumnHeaders);\n            }\n        }\n\n        public ObservableCollection&lt;ObservableCollection&lt;object&gt;&gt; Data\n        {\n            get { return _data; }\n            set\n            {\n                if (_data == value)\n                    return;\n\n                _data = value;\n                RaisePropertyChanged(() =&gt; Data);\n            }\n        }\n\n        private ObservableCollection&lt;string&gt; _columnHeaders;\n        private ObservableCollection&lt;ObservableCollection&lt;object&gt;&gt; _data;\n\n        public ViewModel()\n        {\n            ColumnHeaders = new ObservableCollection&lt;string&gt;();\n            ColumnHeaders.Add(\"String Column\");\n            ColumnHeaders.Add(\"Boolean Column\");\n\n            Data = new ObservableCollection&lt;ObservableCollection&lt;object&gt;&gt;();\n\n            for(int i = 0; i &lt; 5; i++)\n            {\n                ObservableCollection&lt;object&gt; row = new ObservableCollection&lt;object&gt;();\n                row.Add(\"cell \" + i);\n                row.Add(i % 2 == 0 ? true : false);\n\n                Data.Add(row);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The inner collection in <code>Data</code> can contain any type of objects and there can be any number of columns.  I also need to be able to use different <code>DataTemplate</code> to render each cell depending on the object type.</p>\n\n<p>My current view xaml looks like the following:</p>\n\n<pre><code>&lt;UserControl x:Class=\"BindingTest.View\"\n             xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" \n             xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n             xmlns:clr=\"clr-namespace:System;assembly=mscorlib\"\n             mc:Ignorable=\"d\" \n             d:DesignHeight=\"300\" d:DesignWidth=\"300\"\n             DataContext=\"{Binding ViewModel, Source={StaticResource Locator}}\"&gt;\n    &lt;UserControl.Resources&gt;\n        &lt;DataTemplate x:Key=\"StringDataTemplate\"&gt;\n            &lt;TextBlock Text=\"{Binding}\"/&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/UserControl.Resources&gt;\n    &lt;StackPanel&gt;\n        &lt;ItemsControl ItemsSource=\"{Binding ColumnHeaders}\"&gt;\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"/&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;TextBlock Width=\"100\" Text=\"{Binding }\"/&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n        &lt;ItemsControl ItemsSource=\"{Binding Data}\"&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;StackPanel&gt;\n                        &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                            &lt;ItemsControl ItemsSource=\"{Binding}\"&gt;\n                                &lt;ItemsControl.ItemsPanel&gt;\n                                    &lt;ItemsPanelTemplate&gt;\n                                        &lt;StackPanel Orientation=\"Horizontal\"/&gt;\n                                    &lt;/ItemsPanelTemplate&gt;\n                                &lt;/ItemsControl.ItemsPanel&gt;\n                                &lt;ItemsControl.ItemTemplate&gt;\n                                    &lt;DataTemplate&gt;\n                                        &lt;ContentPresenter Content=\"{Binding}\"&gt;\n                                            &lt;ContentPresenter.Resources&gt;\n                                                &lt;DataTemplate DataType=\"{x:Type clr:String}\"&gt;\n                                                    &lt;TextBox Width=\"100\" Text=\"{Binding Path=.}\"/&gt;\n                                                &lt;/DataTemplate&gt;\n                                                &lt;DataTemplate DataType=\"{x:Type clr:Boolean}\"&gt;\n                                                    &lt;CheckBox Width=\"100\" IsChecked=\"{Binding Path=.}\"/&gt;\n                                                &lt;/DataTemplate&gt;\n                                                &lt;DataTemplate DataType=\"{x:Type clr:DateTime}\"&gt;\n                                                    &lt;DatePicker Width=\"100\" SelectedDate=\"{Binding Path=.}\"/&gt;\n                                                &lt;/DataTemplate&gt;\n                                            &lt;/ContentPresenter.Resources&gt;\n                                        &lt;/ContentPresenter&gt;\n                                    &lt;/DataTemplate&gt;\n                                &lt;/ItemsControl.ItemTemplate&gt;\n                            &lt;/ItemsControl&gt;\n                        &lt;/StackPanel&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ItemsControl.ItemTemplate&gt;\n        &lt;/ItemsControl&gt;\n    &lt;/StackPanel&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>I would like to use a <code>GridView</code> on my <code>ListView</code> but I can't quite figure out how to bind to my data in a MVVM manner.</p>\n"}, {"tags": ["c#", ".net", "sql-server", "database", "entity-framework"], "comments": [{"owner": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1453356877, "post_id": 34912235, "comment_id": 57567901, "body": "If this is some one-off code that just creates some demo data in the database, why not just write a query to <code>INSERT</code> the records.  If this code corresponds to the data you want to create, the query would be trivial to write."}, {"owner": {"reputation": 373, "user_id": 928589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6dc36c6f027e2ba655f4830c52e80b5?s=128&d=identicon&r=PG", "display_name": "jacktric", "link": "https://stackoverflow.com/users/928589/jacktric"}, "reply_to_user": {"reputation": 1113, "user_id": 1187982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8735831e588c07dfcbaecc2893deac?s=128&d=identicon&r=PG", "display_name": "Joshua Shearer", "link": "https://stackoverflow.com/users/1187982/joshua-shearer"}, "edited": false, "score": 0, "creation_date": 1453363588, "post_id": 34912235, "comment_id": 57570841, "body": "@JoshuaShearer this is only a test method that I wrote to explain the problem. The real insert procedure is more complicated. This is because I would avoid to write explicit sql query."}], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 928589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6dc36c6f027e2ba655f4830c52e80b5?s=128&d=identicon&r=PG", "display_name": "jacktric", "link": "https://stackoverflow.com/users/928589/jacktric"}, "edited": false, "score": 0, "creation_date": 1453364976, "post_id": 34912381, "comment_id": 57571561, "body": "<a href=\"https://msdn.microsoft.com/it-it/library/system.data.sqlclient.sqlbulkcopy(v=vs.110).aspx\" rel=\"nofollow noreferrer\">SqlBulkCopy</a> class seems to be very interesting. I would try to use it before to look at TVPs techniques."}], "tags": [], "owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "is_accepted": false, "score": 5, "last_activity_date": 1453331237, "creation_date": 1453331237, "answer_id": 34912381, "question_id": 34912235, "link": "https://stackoverflow.com/questions/34912235/net-slow-insert-in-remote-sql-server-database/34912381#34912381", "title": ".NET slow insert in remote SQL Server database", "body": "<p>Looks like most time is spend on the network waiting for a round-trip to complete. EF cannot be made to batch inserts (yet). So you cannot use EF for inserts here.</p>\n\n<p>Investigate the typical solutions to this problem (TVPs and SqlBulkCopy).</p>\n\n<hr>\n\n<p>The dispose pattern you are using is not a good choice. Just wrap <code>dc</code> in \u00b4using` and delete all exception handling.</p>\n"}, {"comments": [{"owner": {"reputation": 373, "user_id": 928589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6dc36c6f027e2ba655f4830c52e80b5?s=128&d=identicon&r=PG", "display_name": "jacktric", "link": "https://stackoverflow.com/users/928589/jacktric"}, "edited": false, "score": 0, "creation_date": 1453364674, "post_id": 34916927, "comment_id": 57571412, "body": "Many thanks for your tip. I will try to use BulkInsert for Entity Framework and I will post a comparison with my actual (bad) strategy."}, {"owner": {"reputation": 373, "user_id": 928589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6dc36c6f027e2ba655f4830c52e80b5?s=128&d=identicon&r=PG", "display_name": "jacktric", "link": "https://stackoverflow.com/users/928589/jacktric"}, "edited": false, "score": 1, "creation_date": 1453378456, "post_id": 34916927, "comment_id": 57580452, "body": "have a look at my first AddRange vs. BulkInsert comparison."}, {"owner": {"reputation": 406, "user_id": 2404597, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375a308026bd80cd6b9e7b5169161116?s=128&d=identicon&r=PG", "display_name": "user2404597", "link": "https://stackoverflow.com/users/2404597/user2404597"}, "reply_to_user": {"reputation": 373, "user_id": 928589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6dc36c6f027e2ba655f4830c52e80b5?s=128&d=identicon&r=PG", "display_name": "jacktric", "link": "https://stackoverflow.com/users/928589/jacktric"}, "edited": false, "score": 0, "creation_date": 1453400947, "post_id": 34916927, "comment_id": 57595952, "body": "Wow..that is impressive"}], "tags": [], "owner": {"reputation": 406, "user_id": 2404597, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375a308026bd80cd6b9e7b5169161116?s=128&d=identicon&r=PG", "display_name": "user2404597", "link": "https://stackoverflow.com/users/2404597/user2404597"}, "is_accepted": false, "score": 3, "last_activity_date": 1453358200, "creation_date": 1453358200, "answer_id": 34916927, "question_id": 34912235, "link": "https://stackoverflow.com/questions/34912235/net-slow-insert-in-remote-sql-server-database/34916927#34916927", "title": ".NET slow insert in remote SQL Server database", "body": "<p>As suggested, SqlBulkCopy is your best bet, however there is an Interesting Nuget Package which does <a href=\"http://EntityFramework.BulkInsert\" rel=\"nofollow\">BulkInsert</a> for Entity Framework:</p>\n\n<p><a href=\"https://efbulkinsert.codeplex.com/\" rel=\"nofollow\">https://efbulkinsert.codeplex.com/</a></p>\n"}], "owner": {"reputation": 373, "user_id": 928589, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b6dc36c6f027e2ba655f4830c52e80b5?s=128&d=identicon&r=PG", "display_name": "jacktric", "link": "https://stackoverflow.com/users/928589/jacktric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1453378293, "creation_date": 1453330551, "last_edit_date": 1453378293, "question_id": 34912235, "link": "https://stackoverflow.com/questions/34912235/net-slow-insert-in-remote-sql-server-database", "title": ".NET slow insert in remote SQL Server database", "body": "<p>I developed a client .NET WinForms application. This application is used to populate a database with thousands of records. For the data layer I used EF6.</p>\n\n<p>When I work and run the application locally every thing works as expected. Insertions are very fast (over 500000 records in about 2 mins).</p>\n\n<p>Now I'm trying to use a remote database on a hosted server and I notice that insertions are very very slow (less than 500 records in about 2 mins). This means 1000 times slower than locally.</p>\n\n<p>If I try to insert 500 records in the remote database using SQL Server Management Studio the operation is completed in less than 1 second.</p>\n\n<p>Is the problem on my client application?</p>\n\n<p>Here the insert function:</p>\n\n<pre><code>public void SetDemoDimCustomer()\n{\n        DWContext dc = null;\n\n        try\n        {\n            dc = DWContext.Create(SqlServerInstance, DbName);\n            dc.Configuration.AutoDetectChangesEnabled = false;\n\n            dc.Database.ExecuteSqlCommand(\"DELETE FROM DimCustomer\");\n            dc.Database.ExecuteSqlCommand(\"DBCC CHECKIDENT ('DimCustomer', RESEED, 0)\");\n\n            DimCustomer objCustomer;\n            List&lt;DimCustomer&gt; lstDemoCustomers = new List&lt;DimCustomer&gt;();\n            int length = 100;\n\n            for (int i = 0; i &lt; length; i++)\n            {\n                objCustomer = new DimCustomer();\n                objCustomer.Name = \"Customer \" + (i + 1);\n                objCustomer.CustomerBKey = (i + 1).ToString();\n\n                lstDemoCustomers.Add(objCustomer);\n            }\n\n            dc.DimCustomer.AddRange(lstDemoCustomers);\n            dc.SaveChanges();\n        }\n        catch (Exception)\n        {\n            throw;\n        }\n        finally\n        {\n            if (dc != null)\n            {\n                dc.Dispose();\n            }\n        }\n    }\n</code></pre>\n\n<p>I tried to use Linq-to-SQL instead of EF6 but the result is the same. Maybe is not a specific EF6 problem.</p>\n\n<p>Some infos about the remote system:</p>\n\n<ul>\n<li>OS: Windows Server 2012</li>\n<li>RDBMS: SQL Server 2014 Express</li>\n</ul>\n\n<p>Thanks in advance.  </p>\n\n<p><strong>UPDATE AFTER SOME TESTS WITH BULKINSERT</strong></p>\n\n<p>Ok here the results of my first tests with BulkInsert:</p>\n\n<ul>\n<li>100 records -> EF6 AddRange: 9 sec. / EF6 BulkInsert: 1 sec.</li>\n<li>1000 records -> EF6 AddRange: 1:27 min. / EF6 BulkInsert: 1 sec. (wow!)</li>\n<li>10000 records -> EF6 AddRange: 14:39 min. / EF6 BulkInsert: 4 sec. (wooooow!)</li>\n</ul>\n\n<p>Now, of course, the EF6 BulkInsert package is part of my project.</p>\n"}, {"tags": ["c#", "css", "asp.net", "vb.net"], "answers": [{"tags": [], "owner": {"reputation": 1618, "user_id": 5553294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xTGbH.jpg?s=128&g=1", "display_name": "Khazratbek", "link": "https://stackoverflow.com/users/5553294/khazratbek"}, "is_accepted": false, "score": 0, "last_activity_date": 1453339130, "creation_date": 1453339130, "answer_id": 34913734, "question_id": 34912201, "link": "https://stackoverflow.com/questions/34912201/asp-net-4-change-selected-menuitem-color/34913734#34913734", "title": "asp.net 4 change selected menuitem color", "body": "<p>use following style:</p>\n\n<pre><code>a:active{background-color:color;}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5517827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593f7334bc77fc0b78b7c42ab3b322b9?s=128&d=identicon&r=PG&f=1", "display_name": "harmony", "link": "https://stackoverflow.com/users/5517827/harmony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 978, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453339130, "creation_date": 1453330396, "question_id": 34912201, "link": "https://stackoverflow.com/questions/34912201/asp-net-4-change-selected-menuitem-color", "title": "asp.net 4 change selected menuitem color", "body": "<p>The menuitem's background color of asp.net 4 (developed via Visual Studio 2010)can't be change after be selected (I want the selected menuitem's background color is YellowGreen). I google this issue and try all ways found from internet. But they don't work. The menu is in a master file and uses the project's default menu css style:</p>\n\n<pre><code>            &lt;asp:Menu ID=\"NavigationMenu\" runat=\"server\" CssClass=\"menu\" \n                EnableViewState=\"false\" IncludeStyleBlock=\"false\" Orientation=\"Horizontal\"&gt;\n                &lt;Items&gt;                       \n                    &lt;asp:MenuItem NavigateUrl=\"Statistics.aspx\" Text=\"Statistics\"/&gt;\n\n                    &lt;asp:MenuItem NavigateUrl=\"Change.aspx\" Text=\"Change\"/&gt;\n\n                    &lt;asp:MenuItem NavigateUrl=\"HistoryData.aspx\" Text=\"History Data\" /&gt;\n\n                    &lt;asp:MenuItem NavigateUrl=\"ChangePassword.aspx\" Text=\"Change Password\"/&gt;\n                    &lt;asp:MenuItem NavigateUrl=\"About.aspx\" Text=\"About\"/&gt;\n                &lt;/Items&gt;\n            &lt;/asp:Menu&gt;\n</code></pre>\n\n<p>The menu css in Site.css is</p>\n\n<pre><code> div.hideSkiplink\n {\n   background-color:#3a4f63;\n   width:100%;\n }\n\n div.menu\n {\n   padding: 0px 0px 0px 0px; /*padding: 4px 0px 4px 8px;*/\n }\n\ndiv.menu ul\n{\n  list-style: none;\n  margin: 0px;\n  padding: 0px;\n  width: auto;\n}\n\ndiv.menu ul li a, div.menu ul li a:visited\n{\nbackground-color: #465c71;\nborder: 1px #4e667d solid;\ncolor: #dde4ec;\ndisplay: block;\nline-height: 2.0em;\npadding: 4px 20px;\ntext-decoration: none;\nwhite-space: nowrap;\nfont-size:medium;\n}\n\n div.menu ul li a:hover\n {\n  background-color: #bfcbd6;\n  color: #465c71;\n  text-decoration: none;\n }\n\n div.menu ul li a:active\n{\nbackground-color:#ADFF2F;\ncolor:White;\ntext-decoration: none;\n} \n</code></pre>\n\n<p>I can see the color change when I click a menuitem but the color is back to dark blue after release the mouse button. I tried change its static selected/dynamic selected style; change the menuitem's select status as true in MenuItemClick event; add selected css style;etc. But the selected menuitem's back color can't be changed. Thanks for your help</p>\n"}, {"tags": ["c#", "visual-studio", "methods", "call"], "comments": [{"owner": {"reputation": 2287, "user_id": 3697604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ba861fd9c4a0282daf790ff90b75bfe?s=128&d=identicon&r=PG&f=1", "display_name": "willaien", "link": "https://stackoverflow.com/users/3697604/willaien"}, "edited": false, "score": 1, "creation_date": 1453330420, "post_id": 34912168, "comment_id": 57560001, "body": "Will need to see the class declarations."}, {"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 2, "creation_date": 1453330429, "post_id": 34912168, "comment_id": 57560008, "body": "Are you really in the same class?"}, {"owner": {"reputation": 10693, "user_id": 3227403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cuOOz.gif?s=128&g=1", "display_name": "pid", "link": "https://stackoverflow.com/users/3227403/pid"}, "edited": false, "score": 0, "creation_date": 1453330572, "post_id": 34912168, "comment_id": 57560069, "body": "Turn it back to private, that&#39;s not the problem. Check if form1 and form2 really are the same, because just from the filenames it looks like those are two different classes."}, {"owner": {"reputation": 127019, "user_id": 59303, "user_type": "moderator", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/gIt1g.png?s=128&g=1", "display_name": "ChrisF", "link": "https://stackoverflow.com/users/59303/chrisf"}, "reply_to_user": {"reputation": 10693, "user_id": 3227403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cuOOz.gif?s=128&g=1", "display_name": "pid", "link": "https://stackoverflow.com/users/3227403/pid"}, "edited": false, "score": 0, "creation_date": 1453330618, "post_id": 34912168, "comment_id": 57560087, "body": "@pid I rolled back your edit as it was too big a change to the code in the question."}, {"owner": {"reputation": 10693, "user_id": 3227403, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cuOOz.gif?s=128&g=1", "display_name": "pid", "link": "https://stackoverflow.com/users/3227403/pid"}, "edited": false, "score": 0, "creation_date": 1453330692, "post_id": 34912168, "comment_id": 57560122, "body": "Yes it&#39;s true. I added one <code>{</code> and unintentionally changed the nature of the question. Thanks for fixing!"}, {"owner": {"reputation": 127019, "user_id": 59303, "user_type": "moderator", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/gIt1g.png?s=128&g=1", "display_name": "ChrisF", "link": "https://stackoverflow.com/users/59303/chrisf"}, "edited": false, "score": 1, "creation_date": 1453330700, "post_id": 34912168, "comment_id": 57560125, "body": "@Annie123 Please add the partial class definition and the class/method where you are calling <code>TestMethod1</code>. What you are trying to do should work so there must be something wrong in the code you&#39;re not showing us."}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "edited": false, "score": 1, "creation_date": 1453331064, "post_id": 34912168, "comment_id": 57560270, "body": "@Annie123 Are your partial classes located within the same namespace?"}, {"owner": {"reputation": 33, "user_id": 4561904, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/aad79d8a7f4a3f9179a5253d6aa35a41?s=128&d=identicon&r=PG&f=1", "display_name": "Annie123", "link": "https://stackoverflow.com/users/4561904/annie123"}, "edited": false, "score": 0, "creation_date": 1453331208, "post_id": 34912168, "comment_id": 57560327, "body": "Yes same namespaces. The only difference between the partial classes is that 1 uses inheritance and the other doesnt."}, {"owner": {"reputation": 33, "user_id": 4561904, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/aad79d8a7f4a3f9179a5253d6aa35a41?s=128&d=identicon&r=PG&f=1", "display_name": "Annie123", "link": "https://stackoverflow.com/users/4561904/annie123"}, "edited": false, "score": 0, "creation_date": 1453332112, "post_id": 34912168, "comment_id": 57560663, "body": "I did put in more info :) Thanks so much"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11523568"}, "edited": false, "score": 0, "creation_date": 1569521743, "post_id": 34912168, "comment_id": 102633692, "body": "You call a private method in a derived class in the same file?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4561904, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/aad79d8a7f4a3f9179a5253d6aa35a41?s=128&d=identicon&r=PG&f=1", "display_name": "Annie123", "link": "https://stackoverflow.com/users/4561904/annie123"}, "edited": false, "score": 0, "creation_date": 1453331667, "post_id": 34912433, "comment_id": 57560496, "body": "That helped a bit thanks. When I put my method outside of the InitializeComponent, I get a different error (&quot;method must have a return type&quot;) even though my method has a void. private void test1() { }"}], "tags": [], "owner": {"reputation": 2784, "user_id": 2134198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/901oM.jpg?s=128&g=1", "display_name": "Jens Meinecke", "link": "https://stackoverflow.com/users/2134198/jens-meinecke"}, "is_accepted": false, "score": 0, "last_activity_date": 1453331481, "creation_date": 1453331481, "answer_id": 34912433, "question_id": 34912168, "link": "https://stackoverflow.com/questions/34912168/call-method-in-partial-class/34912433#34912433", "title": "Call method in partial class", "body": "<p>If the situation is as you described, then the compiler should not generate the error message as it is valid code.</p>\n\n<p>However, if you try to use the visual editor, and you insert the call in your code inside the <code>InitializeComponent</code> method you will get an error.</p>\n\n<p>This is caused by the Form editor not being able to call functions that are defined within the class you are actually editing - it is a bit restrictive about what you can do within that scope.</p>\n"}], "owner": {"reputation": 33, "user_id": 4561904, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/aad79d8a7f4a3f9179a5253d6aa35a41?s=128&d=identicon&r=PG&f=1", "display_name": "Annie123", "link": "https://stackoverflow.com/users/4561904/annie123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1572, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453332089, "creation_date": 1453330221, "last_edit_date": 1453332089, "question_id": 34912168, "link": "https://stackoverflow.com/questions/34912168/call-method-in-partial-class", "title": "Call method in partial class", "body": "<p>I'm using Visual Studios. I wrote a method in a form1.cs file in a partial class</p>\n\n<pre><code>private void TestMethod1()\n{\n}\n</code></pre>\n\n<p>I want to call this method in form2.designer.cs, in the same partial class. I tried this: </p>\n\n<pre><code>TestMethod1(); \n</code></pre>\n\n<p>but I got the error method not found. </p>\n\n<p>this is the form.cs \nnamespace classA\n{\n    public partial class A : B\n    {....<br>\n          private void TestMethod1()\n        {\n        }\n    }\n}</p>\n\n<p>this is the form.designer.cs\nnamespace classA\n{\n    partial class A\n    {\n        private void InitializaCOmponent()\n        {\n         .....\n         }\n         (where I call my function)\n         TestMethod1();\n     }\n}</p>\n"}, {"tags": ["c#", "asp.net", "dependency-injection", "unity-container", "ioc-container"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453330615, "post_id": 34912128, "comment_id": 57560084, "body": "How is <code>AuthenticationService</code> related to the factories?"}, {"owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453330759, "post_id": 34912128, "comment_id": 57560152, "body": "@YacoubMassad Edited to include authentication service."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453336006, "post_id": 34912128, "comment_id": 57561935, "body": "Which implementation of <code>ICrudFactory</code> do you want to inject to <code>AuthenticationService</code>?"}, {"owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453336072, "post_id": 34912128, "comment_id": 57561961, "body": "Well, I&#39;d like to do ZNodeDataContext but if I need the other, access it."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453336213, "post_id": 34912128, "comment_id": 57561995, "body": "Add a default registration for it like this: <code>container.RegisterType&lt;ICrudFactory, ZNodeDataContextFactory&gt;();</code>"}, {"owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453336247, "post_id": 34912128, "comment_id": 57562004, "body": "@YacoubMassad That is what I did."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453336301, "post_id": 34912128, "comment_id": 57562016, "body": "Don&#39;t create a default registration for the other one. Keep the other one named."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453336344, "post_id": 34912128, "comment_id": 57562027, "body": "By the way, is there a particular reason why are you using property injection and not constructor injection? Also, is there a reason why you use attributes (the <code>Dependency</code> attribute)?"}, {"owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453336450, "post_id": 34912128, "comment_id": 57562062, "body": "@YacoubMassad The documentation mentioned it, if you have a better approach I would be happy to learn from it."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453337866, "post_id": 34912128, "comment_id": 57562488, "body": "Using Constructor Injection (like how you injected <code>ICrudFactory</code> into <code>AuthenticationService</code>) is better since it cannot be changed once it is set. Did you try to make only <code>ZNodeDataContextFactory</code> the default registration?"}], "answers": [{"tags": [], "owner": {"reputation": 9225, "user_id": 4949005, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/uwKDt.png?s=128&g=1", "display_name": "smoksnes", "link": "https://stackoverflow.com/users/4949005/smoksnes"}, "is_accepted": false, "score": 1, "last_activity_date": 1453461556, "creation_date": 1453461556, "answer_id": 34945492, "question_id": 34912128, "link": "https://stackoverflow.com/questions/34912128/unity-with-the-same-interface-multiple-factories/34945492#34945492", "title": "Unity with the same interface, multiple factories", "body": "<p>Do you want to inject <code>ZNodeDataContextFactory</code> into <code>AuthenticationService</code> ? A bit of the point with the injection is that the service should not now anything about the implementation. But if you really want a specific implementation you can create a named instance.</p>\n\n<pre><code>public class AuthenticationService\n{\n     private readonly ICrudFactory _factory;\n     public AuthenticationService([Dependency(\"ZNodeData\")] ICrudFactory factory)\n     {\n         _factory = factory;\n     }\n}\n</code></pre>\n\n<p>And in your configuration:</p>\n\n<pre><code>container.RegisterType&lt;ICrudFactory, ZNodeDataContextFactory&gt;(\"ZNodeData\");\ncontainer.RegisterType&lt;ICrudFactory, MincronDataContextFactory&gt;(\"MincronData\");\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>    public class AuthenticationService\n    {\n         private readonly IEnumerable&lt;ICrudFactory&gt; _factories;\n         public AuthenticationService(ICrudFactory[] factories)\n         {\n             // Now you got both...\n             _factories = factories;\n             var zNodeFactory = _factories.FirstOrDefault(x =&gt; x.Factory == ZNode);\n         }\n    }\n\n\n    public interface ICrudFactory\n    {\n         ICrud Create();\n         // Something to identify the type of data. Maybe an enum?\n         FactoryType Factory {get;}\n    }\n\npublic ZNodeDataContextFactory : ICrudFactory\n{\n     ICrud ICrudFactory.Create()\n     {\n           return ZNodeDataContext();\n     }\n\n     FactoryType ICrudFactory.Factory\n     {\n        {get {return FactoryType.ZNode;}\n     }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "is_accepted": true, "score": 0, "last_activity_date": 1454002543, "creation_date": 1454002543, "answer_id": 35068207, "question_id": 34912128, "link": "https://stackoverflow.com/questions/34912128/unity-with-the-same-interface-multiple-factories/35068207#35068207", "title": "Unity with the same interface, multiple factories", "body": "<p>I ended up solving the issue, by creating particular containers for each generic repository.</p>\n\n<pre><code>public interface IZNodeContextFactory : ICrudFactory\n{\n\n}\n\npublic interface IMincronContextFactory : ICrudFactory\n{\n\n}\n</code></pre>\n\n<p>By doing it in this manner, I was able to simply do:</p>\n\n<pre><code>container.RegisterType&lt;IZNodeContextFactory, ZNodeContextFactory&gt;();\ncontainer.RegisterType&lt;IMincronContextFactory, MincronContextFactory&gt;();\n</code></pre>\n\n<p>This allowed the automatic dependency resolver to work, and implement since they now had unique names.</p>\n"}], "owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 35068207, "answer_count": 2, "score": 1, "last_activity_date": 1454002543, "creation_date": 1453330081, "last_edit_date": 1453388552, "question_id": 34912128, "link": "https://stackoverflow.com/questions/34912128/unity-with-the-same-interface-multiple-factories", "title": "Unity with the same interface, multiple factories", "body": "<p>So the issue, is when I declare:</p>\n\n<pre><code>[Dependency]\npublic AuthenticationService _authenticationServices { get; set; }\n</code></pre>\n\n<p>The <code>_authenticationServices</code> will constantly remain <code>null</code>.  It isn't referenced, which will throw a Null Reference Exception.  I'm assuming the issue stems from my Unity Configuration file:</p>\n\n<pre><code>container.RegisterType&lt;ICrudFactory, ZNodeDataContextFactory&gt;();\ncontainer.RegisterType&lt;ICrudFactory, MincronDataContextFactory&gt;();\n</code></pre>\n\n<p>Since they both use the same interface, but a separate concrete implementation.  The implementation is as follows:</p>\n\n<pre><code>public interface ICrud : IDisposable\n{\n     // Method's to be exposed, via general repository.\n}\n\npublic interface ICrudFactory\n{\n     ICrud Create();\n}\n\npublic ZNodeDataContext : DbContext, ICrud\n{\n     // Concrete implementation.\n}\n\npublic MincronDataContext : DbContext, ICrud\n{\n     // Concrete implementation.\n}\n\npublic ZNodeDataContextFactory : ICrudFactory\n{\n     ICrud ICrudFactory.Create()\n     {\n           return ZNodeDataContext();\n     }\n}\n\npublic MincronDataContextFactory : ICrudFactory\n{\n     ICrud ICrudFactory.Create()\n     {\n           return MincronDataContext();\n     }\n}\n\npublic class AuthenticationService\n{\n     private readonly ICrudFactory _factory;\n     public AuthenticationService(ICrudFactory factory)\n     {\n         _factory = factory;\n     }\n\n     public void Sample()\n     {\n          using(var context = _factory.Create())\n              context.Method(...);\n     }\n}\n</code></pre>\n\n<p>I'd like to keep that structure, to avoid code duplication.</p>\n"}, {"tags": ["c#", "visual-studio", "visual-studio-2015", "t4"], "comments": [{"owner": {"reputation": 1143, "user_id": 2214462, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bLarQ.jpg?s=128&g=1", "display_name": "Mathemats", "link": "https://stackoverflow.com/users/2214462/mathemats"}, "edited": false, "score": 4, "creation_date": 1453330225, "post_id": 34912006, "comment_id": 57559897, "body": "One is spelled CustomDataGenterator.dll and the other is CustomDataGenerator.dll."}, {"owner": {"reputation": 109, "user_id": 2051642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9bEh.jpg?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/2051642/todd"}, "reply_to_user": {"reputation": 1143, "user_id": 2214462, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bLarQ.jpg?s=128&g=1", "display_name": "Mathemats", "link": "https://stackoverflow.com/users/2214462/mathemats"}, "edited": false, "score": 0, "creation_date": 1453475655, "post_id": 34912006, "comment_id": 57631312, "body": "Hangs head in shame....@Mathemats Thank you very much.  I will update this question with that change and add a small piece that completes the sample."}], "owner": {"reputation": 109, "user_id": 2051642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9bEh.jpg?s=128&g=1", "display_name": "Todd", "link": "https://stackoverflow.com/users/2051642/todd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1453476494, "creation_date": 1453329507, "last_edit_date": 1453476494, "question_id": 34912006, "link": "https://stackoverflow.com/questions/34912006/t4-templatesmicrosoft-visualstudio-texttemplating-14-0-how-can-i-get-custom", "title": "T4 Templates(Microsoft.VisualStudio.TextTemplating.14.0) - How can I get custom utility methods to work in VS2015?", "body": "<p>I've seen many questions related to this topic but none that seem to work for my test project. I am using VS2015 and Microsoft.VisualStudio.TextTemplating.14.0.  I have followed a tutorial from Pluralsight that is for Microsoft.VisualStudio.TextTemplating.10.0 I'm not sure that make a huge difference. Considor this I have a solution with 2 projects one is a class library that contains a simple TextTransformation method:</p>\n\n<pre><code>using Microsoft.VisualStudio.TextTemplating;\nusing System;\nusing System.Globalization;\nusing System.Threading;\n\nnamespace CustomDataGenerator\n{\n    public class CustomDataMethods : TextTransformation\n    {\n        public string ToTitleCase(string input)\n        {\n            TextInfo ti = Thread.CurrentThread.CurrentCulture.TextInfo;\n            return ti.ToTitleCase(input.ToLower());\n        }\n        public override string TransformText()\n        {\n            throw new NotImplementedException();\n        }\n    }\n}\n</code></pre>\n\n<p>The other is a console application.  Both projects reference:</p>\n\n<blockquote>\n  <p>Microsoft.VisualStudio.TextTemplating.14.0</p>\n</blockquote>\n\n<p>and the console application has a reference to the class library project.</p>\n\n<blockquote>\n  <p>CustomDataGenerator</p>\n</blockquote>\n\n<p>I added a Text template to the console application configuring it as follows:</p>\n\n<pre><code>&lt;#@ template debug=\"false\" hostspecific=\"false\" language=\"C#\" inherits=\"CustomDataGenerator.CustomDataMethods\" #&gt;\n&lt;#@ output extension=\".txt\" #&gt;\n&lt;#@ assembly name=\"$(TargetDir)CustomDataGenerator.dll\" #&gt;\n    &lt;#= ToTitleCase(\"HELLO\") #&gt;\n</code></pre>\n\n<p>I built the assembly to make sure it exists. Here is the path on my machine:</p>\n\n<blockquote>\n  <p>C:\\Users\\Todd.MANCHESTERVILLE\\Documents\\VSTesting\\NewT4Test\\NewT4Test\\bin\\Debug\\CustomDataGenerator.dll</p>\n</blockquote>\n\n<p>and this is the error generated by the text template.:</p>\n\n<blockquote>\n  <p>Error       Compiling transformation: Metadata file 'C:\\Users\\Todd.MANCHESTERVILLE\\Documents\\VSTesting\\NewT4Test\\NewT4Test\\bin\\Debug\\CustomDataGenerator.dll' could not be found    NewT4Test   C:\\Users\\Todd.MANCHESTERVILLE\\Documents\\VSTesting\\NewT4Test\\NewT4Test\\TextTemplate1.tt  1   </p>\n</blockquote>\n\n<p>Here is my full albeit small sample: <a href=\"https://github.com/toddmanchester/NewT4Test/\" rel=\"nofollow\">Git Repo</a></p>\n\n<p>I can't seem to figure out what is wrong.  I can't reference the class in the library. I have verified the assembly exists.  Thanks for helping!</p>\n\n<p><strong>Edit:</strong> I fixed my spelling mistake and added this line:</p>\n\n<blockquote>\n  <p>&lt;#= ToTitleCase(\"HELLO\") #></p>\n</blockquote>\n\n<p>Showing that the custom utility method works. I have updated the <a href=\"https://github.com/toddmanchester/NewT4Test/\" rel=\"nofollow\">Git Repo</a>\ntoo.</p>\n\n<p>All is temporarily right in the universe! Except my spelling.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1453330115, "post_id": 34911996, "comment_id": 57559857, "body": "Where do you declare and initialize the variable connect?"}, {"owner": {"reputation": 11, "user_id": 5811677, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fe885cd4b0730f6fe91bc70da2aa78c7?s=128&d=identicon&r=PG&f=1", "display_name": "mengli00", "link": "https://stackoverflow.com/users/5811677/mengli00"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1453389074, "post_id": 34911996, "comment_id": 57588066, "body": "Globally, at the top of each form. The connection string is:  SqlConnection connect = new SqlConnection(&quot;Data Source=XXXXXX;Initial Catalog=XXXXXX;Integrated Security=True;&quot;);"}, {"owner": {"reputation": 11, "user_id": 5811677, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fe885cd4b0730f6fe91bc70da2aa78c7?s=128&d=identicon&r=PG&f=1", "display_name": "mengli00", "link": "https://stackoverflow.com/users/5811677/mengli00"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1453390457, "post_id": 34911996, "comment_id": 57589075, "body": "The datareader has no rows."}, {"owner": {"reputation": 11, "user_id": 5811677, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fe885cd4b0730f6fe91bc70da2aa78c7?s=128&d=identicon&r=PG&f=1", "display_name": "mengli00", "link": "https://stackoverflow.com/users/5811677/mengli00"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1453391557, "post_id": 34911996, "comment_id": 57589827, "body": "Thank you for your question, Steve. You started me thinking down another path where I discovered the issue was actually a problem in my stored procedure. I was trying to get the value of the wrong column. Embarrassed, but happy to be moving on. Thank you!"}], "owner": {"reputation": 11, "user_id": 5811677, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fe885cd4b0730f6fe91bc70da2aa78c7?s=128&d=identicon&r=PG&f=1", "display_name": "mengli00", "link": "https://stackoverflow.com/users/5811677/mengli00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453333223, "creation_date": 1453329477, "last_edit_date": 1453333223, "question_id": 34911996, "link": "https://stackoverflow.com/questions/34911996/how-to-call-a-popup-form-datareader-from-cellclick-event", "title": "How to call a popup form DataReader from CellClick Event", "body": "<p>When I pass the value from the calling form to the popup, the value is received, but when the code reaches the while (drInsiderInfo.Read) statement it bounces back to insiderPopUp.ShowDialog on the calling form and the DataReader is never executed.</p>\n\n<p>Here is my CellClick event code:</p>\n\n<pre><code>        private void allInsiderTransactionsDataGridView_CellClick(object sender, DataGridViewCellEventArgs e)\n    {\n        string passedInsider;\n\n        try\n        {\n            passedInsider = allInsiderTransactionsDataGridView.Rows[e.RowIndex].Cells[3].Value.ToString();\n\n            DataGridViewCell cellClicked = (DataGridViewCell)allInsiderTransactionsDataGridView.Rows[e.RowIndex].Cells[e.ColumnIndex];\n            if (cellClicked.ColumnIndex == this.allInsiderTransactionsDataGridView.Columns[\"Insider\"].Index) \n            {\n                frmInsiderPopUp insiderPopUp = new frmInsiderPopUp(passedInsider);\n                insiderPopUp.passedNumber = passedInsider;\n                insiderPopUp.ShowDialog();\n            }\n        }\n        catch (Exception ex)\n        {\n            throw (ex);\n        }\n    }\n</code></pre>\n\n<p>And here is my popup form DataReader code:</p>\n\n<pre><code>        public string passedNumber { get; set; }\n\n    public frmInsiderPopUp(string passedNumber)\n    {\n        InitializeComponent();\n\n        passedInsiderNumberTextBox.Text = passedNumber;\n        populateVipNumberTextBoxes();\n\n    }\n\n    public void populateVipNumberTextBoxes()\n    {\n\n        if (passedInsiderNumberTextBox.Text != null) \n\n        connect.Open();\n        try\n        {\n            SqlCommand insiderStProc = new SqlCommand(\"RMM3InsiderInformation\");\n            insiderStProc.Connection = connect;\n            insiderStProc.CommandType = CommandType.StoredProcedure;\n\n            insiderStProc.Parameters.AddWithValue(\"@InsiderNumber\", passedInsiderNumberTextBox.Text);\n\n            using (SqlDataReader drInsiderInfo = insiderStProc.ExecuteReader())\n            {\n                while (drInsiderInfo.Read())\n                {\n                    insiderNameTextBox.Text = drInsiderInfo[\"Name\"].ToString();\n                    insiderStoreTextBox.Text = drInsiderInfo[\"Store\"].ToString();\n                    insiderPhoneTextBox.Text = drInsiderInfo[\"Phone\"].ToString();\n                    insiderStreetTextBox.Text = drInsiderInfo[\"Street\"].ToString();\n                    insiderSuiteTextBox.Text = drInsiderInfo[\"Apt\"].ToString();\n                    insiderCityTextBox.Text = drInsiderInfo[\"City\"].ToString();\n                    insiderStateTextBox.Text = drInsiderInfo[\"State\"].ToString();\n                    insiderZipCodeMaskedTextBox.Text = drInsiderInfo[\"ZipCode\"].ToString();\n                    insiderEmailTextBox.Text = drInsiderInfo[\"Email\"].ToString();\n                    insiderSignUpDateMaskedTextBox.Text = drInsiderInfo[\"DateIn\"].ToString();\n                    insiderLastMailedMaskedTextBox.Text = drInsiderInfo[\"LastMailed\"].ToString();\n                    insiderTotalTransactionsTextBox.Text = drInsiderInfo[\"TotalTrans\"].ToString();\n                    insiderTotalDollarsTextBox.Text = drInsiderInfo[\"TotalDollars\"].ToString();\n                    insiderColorTextBox.Text = drInsiderInfo[\"Color\"].ToString();\n                }\n            }\n        }\n        catch (Exception ex)\n        {\n            throw (ex);\n        }\n           connect.Close();\n    }\n</code></pre>\n"}, {"tags": ["c#", "parsing", "datetime", "datetimeoffset"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 5123835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i54oG.jpg?s=128&g=1", "display_name": "Zakariaa.B", "link": "https://stackoverflow.com/users/5123835/zakariaa-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1453329565, "creation_date": 1453329565, "answer_id": 34912013, "question_id": 34911921, "link": "https://stackoverflow.com/questions/34911921/parse-date-time-c-with-correct-timezone-and-kind/34912013#34912013", "title": "Parse date time c# with correct timezone and kind", "body": "<p>You can use something like this:</p>\n\n<pre><code>string format = \"ddd dd MMM h:mm tt yyyy\";\nDateTime dateTime = DateTime.ParseExact(dateString, format,\n    CultureInfo.InvariantCulture);\n</code></pre>\n\n<p>In format variable, you can put the format you want, and pass it to ParseExact function.</p>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 0, "creation_date": 1453331489, "post_id": 34912103, "comment_id": 57560430, "body": "Even if I specify the timezone for <code>DateTime.Parse()</code> (&#39;Z&#39; in my case), it is still <code>DateTimeKind.Local</code> and also <code>DateTime.ParseExact(&quot;2016-01-20T22:20:29.055Z&quot;, &quot;yyyy-MM-ddThh:mm:ss.fffZ&quot;, null)</code> still comes out as <code>DateTimeKind.Local</code>"}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "reply_to_user": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 1, "creation_date": 1453331856, "post_id": 34912103, "comment_id": 57560575, "body": "By default, <code>ParseExact</code> will convert to <code>DateTimeKind.Local</code>. You need to use the <code>AdjustToUniversal</code> <code>DateTimeStyle</code> to convert to UTC. Like so: <code>DateTime.ParseExact(&quot;2016-01-20T22:20:29.055Z&quot;, &quot;yyyy-MM-ddTHH:mm:ss.fffZ&quot;, CultureInfo.InvariantCulture, DateTimeStyles.AdjustToUniversal);</code>"}, {"owner": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 0, "creation_date": 1453332158, "post_id": 34912103, "comment_id": 57560674, "body": "^^^ is still <code>DateTimeKind.Local</code>"}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "reply_to_user": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 1, "creation_date": 1453332367, "post_id": 34912103, "comment_id": 57560753, "body": "Using the following code produces <code>DateTimeKind.Utc</code> for me: <code>DateTime time = DateTime.ParseExact(&quot;2016-01-20T22:20:29.055Z&quot;, &quot;yyyy-MM-ddTHH:mm:ss.fffZ&quot;, CultureInfo.InvariantCulture, DateTimeStyles.AdjustToUniversal);             DateTimeKind kind = time.Kind;</code>"}, {"owner": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 0, "creation_date": 1453332607, "post_id": 34912103, "comment_id": 57560846, "body": "I mistook AdjustToUniversal for AssumeUniversal which was producing DateTimeKind.Local. But yes, the above works. Thanks."}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "reply_to_user": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 1, "creation_date": 1453332664, "post_id": 34912103, "comment_id": 57560873, "body": "Sorry, originally was AssumeUniversal when I posted it. Was probably editing it to AdjustToUniversal when you saw it. :)"}], "tags": [], "owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "is_accepted": false, "score": 2, "last_activity_date": 1453329975, "creation_date": 1453329975, "answer_id": 34912103, "question_id": 34911921, "link": "https://stackoverflow.com/questions/34911921/parse-date-time-c-with-correct-timezone-and-kind/34912103#34912103", "title": "Parse date time c# with correct timezone and kind", "body": "<p>In your second example, <code>2016-01-20T22:20:29.055Z</code> has timezone information provided with it; the 'Z' at the end indicates that the timestamp is intended for Coordinated Universal Time (UTC). However, <code>DateTime.Parse()</code> will default its conversion using <code>DateTimeKind.Local</code> unless a specific timezone is specified. You can use <code>DateTime.ParseExact</code> to be more specific.</p>\n\n<p>As to why the datetime values in your database are coming out as <code>Unspecified</code>, that's likely because they contain no timezone indication at all. Check to see if your database values specify timezone information, either by using 'Z' at the end or specifying an exact timezone, such as <code>2016-01-20T22:20:29.055-07:00</code> (UTC-7).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5812655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8bd0aceff20d8c1807d0f2312654095?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Colonna", "link": "https://stackoverflow.com/users/5812655/nicolas-colonna"}, "is_accepted": false, "score": 0, "last_activity_date": 1453330969, "creation_date": 1453330969, "answer_id": 34912328, "question_id": 34911921, "link": "https://stackoverflow.com/questions/34911921/parse-date-time-c-with-correct-timezone-and-kind/34912328#34912328", "title": "Parse date time c# with correct timezone and kind", "body": "<p>You are missing the datetime context (offset) in your database. You should persist it either in a datetimeoffset column or in a datetime column but persisting utc datetimes.\nAnd always better compare two utc datetimes.</p>\n"}, {"comments": [{"owner": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 1, "creation_date": 1453331721, "post_id": 34912442, "comment_id": 57560517, "body": "But isn&#39;t that&#39;s what the &quot;Z&quot; is for? Why does it still come out as <code>DateTimeKind.Local</code>. It should have been <code>DateTimeKind.Utc</code> because &quot;Z&quot; is UTC, is that not correct?"}, {"owner": {"reputation": 11802, "user_id": 1015164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dfdd18f01b5c44aab80e653799e53e?s=128&d=identicon&r=PG", "display_name": "JamieSee", "link": "https://stackoverflow.com/users/1015164/jamiesee"}, "reply_to_user": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "edited": false, "score": 1, "creation_date": 1453332545, "post_id": 34912442, "comment_id": 57560819, "body": "@mwahidje Oops, good point. Hold on while I edit the answer to be correct. Thanks for catching it."}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 0, "creation_date": 1453496955, "post_id": 34912442, "comment_id": 57643480, "body": "Note that in this particular case, <i>either</i> <code>AdjustToUniversal</code> or <code>RoundTripKind</code> will solve the problem."}], "tags": [], "owner": {"reputation": 11802, "user_id": 1015164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66dfdd18f01b5c44aab80e653799e53e?s=128&d=identicon&r=PG", "display_name": "JamieSee", "link": "https://stackoverflow.com/users/1015164/jamiesee"}, "is_accepted": true, "score": 6, "last_activity_date": 1453333147, "last_edit_date": 1453333147, "creation_date": 1453331507, "answer_id": 34912442, "question_id": 34911921, "link": "https://stackoverflow.com/questions/34911921/parse-date-time-c-with-correct-timezone-and-kind/34912442#34912442", "title": "Parse date time c# with correct timezone and kind", "body": "<p>Because SQLReader cannot reasonably infer a DateTimeKind, it leaves it as unspecified. You'll want to use <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"noreferrer\"><code>DateTime.SpecifyKind</code></a> to change the DateTimeKind on your output from the SQLReader to the appropriate value. This works ok if you are only dealing with UTC and one consistent local time zone; otherwise, you really should be using DateTimeOffset in both your code and the SQL Database.</p>\n\n<p>The string \"2016-01-20T22:20:29.055Z\" is <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"noreferrer\">ISO 8601</a> compliant and is a UTC date; however, <a href=\"https://msdn.microsoft.com/en-us/library/system.datetime.parse(v=vs.110).aspx\" rel=\"noreferrer\"><code>DateTime.Parse</code></a> with only 1 argument can end up performing a conversion to local time. Per the documentation:</p>\n\n<blockquote>\n  <p>Generally, the Parse method returns a DateTime object whose Kind\n  property is DateTimeKind.Unspecified. However, the Parse method may\n  also perform time zone conversion and set the value of the Kind\n  property differently, depending on the values of the s and styles\n  parameters:</p>\n</blockquote>\n\n<ul>\n<li>If s contains time zone information, the date and time is converted\nto the time in the local time zone and the Kind is DateTimeKind.Local.</li>\n<li>If s contains time zone information, and styles includes the\nAdjustToUniversalflag, the date and time is converted to Coordinated\nUniversal Time (UTC) and the Kind is DateTimeKind.Utc.</li>\n<li>If s contains the Z or GMT time zone designator, and styles includes\nthe RoundtripKind flag, the date and time are interpreted as UTC and\nthe Kind is DateTimeKind.Utc.</li>\n</ul>\n\n<p>Also see <a href=\"http://blog.dezfowler.com/2010/07/utc-gotchas-in-net-and-sql-server.html\" rel=\"noreferrer\">UTC gotchas in .NET and SQL Server</a> in Derek Fowler's blog for additional coverage on the topic.</p>\n"}], "owner": {"reputation": 611, "user_id": 5552182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19536d9e8dd2f8caefe40be01065d087?s=128&d=identicon&r=PG&f=1", "display_name": "Shikasta_Kashti", "link": "https://stackoverflow.com/users/5552182/shikasta-kashti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6501, "favorite_count": 1, "accepted_answer_id": 34912442, "answer_count": 4, "score": 9, "last_activity_date": 1453333147, "creation_date": 1453329160, "question_id": 34911921, "link": "https://stackoverflow.com/questions/34911921/parse-date-time-c-with-correct-timezone-and-kind", "title": "Parse date time c# with correct timezone and kind", "body": "<p>I have a datetime in database which I read using SqlDataReader and then cast it to <code>(DateTime)</code>. After the cast its <code>Kind</code> property is <code>DateTimeKind.Unspecified</code>.</p>\n\n<p>Then I have another string which I read from some other source. Its format is like this <code>2016-01-20T22:20:29.055Z</code>. I do <code>DateTime.Parse(\"2016-01-20T22:20:29.055Z\")</code> and its Kind property is DateTimeKind.Local. </p>\n\n<p>How do I properly parse the both date times for comparison? Do I need to use DateTimeOffsets? How should I parse them?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", ".net", "task-parallel-library"], "answers": [{"comments": [{"owner": {"reputation": 5864, "user_id": 429091, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8defe14b1c80bc2bd59a1fab3848cfb?s=128&d=identicon&r=PG", "display_name": "binki", "link": "https://stackoverflow.com/users/429091/binki"}, "edited": false, "score": 0, "creation_date": 1453330857, "post_id": 34911995, "comment_id": 57560195, "body": "Opening a file would still be a blocking operation for which asynchronous APIs exist and which \u201cfaking\u201d asynchronous access with the threadpool \u2019s help would work even if people recommend against it."}, {"owner": {"reputation": 608, "user_id": 2345665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f97c10e6a0d5fea0a31dbf152efc41a1?s=128&d=identicon&r=PG", "display_name": "Darren Clark", "link": "https://stackoverflow.com/users/2345665/darren-clark"}, "reply_to_user": {"reputation": 5864, "user_id": 429091, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8defe14b1c80bc2bd59a1fab3848cfb?s=128&d=identicon&r=PG", "display_name": "binki", "link": "https://stackoverflow.com/users/429091/binki"}, "edited": false, "score": 1, "creation_date": 1453340328, "post_id": 34911995, "comment_id": 57563190, "body": "Yes, opening a file has asynchronous APIs, but the DbConnection class would have no idea that&#39;s what&#39;s going on. A provider that used file access would have a trivial time implementing a proper OpenAsync, for the base class it would be impossible. Faking it with a threadpool would work, unless Open did something like put the file handle in thread local storage, then it wouldn&#39;t work at all. Personally I would just assume that a provider properly implemented OpenAsync if Open could be a time consuming operation."}], "tags": [], "owner": {"reputation": 608, "user_id": 2345665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f97c10e6a0d5fea0a31dbf152efc41a1?s=128&d=identicon&r=PG", "display_name": "Darren Clark", "link": "https://stackoverflow.com/users/2345665/darren-clark"}, "is_accepted": false, "score": 0, "last_activity_date": 1453329474, "creation_date": 1453329474, "answer_id": 34911995, "question_id": 34911914, "link": "https://stackoverflow.com/questions/34911914/why-is-the-default-implementation-of-dbconnection-openasynccancellationtoken-s/34911995#34911995", "title": "Why is the default implementation of DbConnection.OpenAsync(CancellationToken) synchronous?", "body": "<p>The key phrase in the docs is </p>\n\n<blockquote>\n  <p>Providers should override with an appropriate implementation.</p>\n</blockquote>\n\n<p>DbConnection is the base class for implementation specific classes. It has no idea of the underlying implementation, of how to to make it asynchronous. The base class developers opted to provide a simple implementation for providers that did not implement their own Async version. </p>\n\n<p>I agree, the implementation isn't a great one, but about all you can do without knowing the underlying implementation.</p>\n\n<p>What if the Open implementation doesn't use a network? Maybe it just opens a file. There's no generalization that can be made by the base class.</p>\n\n<p>I would expect most providers to implement a real async version of this method, but if you really need to be async from <em>anyone</em>, then I'd just wrap it in a run. However if you ran across a provider that didn't support a true async open, it may very well not support a thread safe open either.</p>\n"}, {"comments": [{"owner": {"reputation": 5864, "user_id": 429091, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8defe14b1c80bc2bd59a1fab3848cfb?s=128&d=identicon&r=PG", "display_name": "binki", "link": "https://stackoverflow.com/users/429091/binki"}, "edited": false, "score": 0, "creation_date": 1453330584, "post_id": 34912194, "comment_id": 57560075, "body": "That sort of implicit transaction management API looks dangerous to use and like something to avoid altogether to me\u2026"}, {"owner": {"reputation": 5864, "user_id": 429091, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8defe14b1c80bc2bd59a1fab3848cfb?s=128&d=identicon&r=PG", "display_name": "binki", "link": "https://stackoverflow.com/users/429091/binki"}, "edited": false, "score": 0, "creation_date": 1453330712, "post_id": 34912194, "comment_id": 57560130, "body": "Ah, I see, you\u2019re saying that because some providers use thread local storage while opening up a connection the default implementation provided by <code>DbConnection</code> <i>cannot</i> safely use the threadpool to enable it to return immediately."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 5864, "user_id": 429091, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8defe14b1c80bc2bd59a1fab3848cfb?s=128&d=identicon&r=PG", "display_name": "binki", "link": "https://stackoverflow.com/users/429091/binki"}, "edited": false, "score": 0, "creation_date": 1453330945, "post_id": 34912194, "comment_id": 57560230, "body": "@binki Like it says in the documentation for <code>Transaction.Current</code>, you don&#39;t generally use it directly. You use <code>TransactionScope</code> to manage it, and then it becomes a very useful mechanism. The connection class itself would use <code>Transaction.Current</code> directly though, and wouldn&#39;t see the intended value if called on a background thread. I didn&#39;t say anything about the connection class itself using thread-local storage (I was thinking only about other classes), but you are right, that&#39;s another valid possibility."}, {"owner": {"reputation": 5864, "user_id": 429091, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8defe14b1c80bc2bd59a1fab3848cfb?s=128&d=identicon&r=PG", "display_name": "binki", "link": "https://stackoverflow.com/users/429091/binki"}, "edited": false, "score": 0, "creation_date": 1453331250, "post_id": 34912194, "comment_id": 57560335, "body": "I still think that relying on thread local storage makes it fragile in surprising ways. But I say that because I\u2019ve never even heard of that pattern/API before. Now, if there was something like nodejs\u2019s continuation-local-storage to track transaction scopes, that might feel a little safer to me though it\u2019s still not straightforward. Interesting that the scopes thing exists and, yes, I can see how it could unclutter code quite a bit."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": true, "score": 4, "last_activity_date": 1453330360, "creation_date": 1453330360, "answer_id": 34912194, "question_id": 34911914, "link": "https://stackoverflow.com/questions/34911914/why-is-the-default-implementation-of-dbconnection-openasynccancellationtoken-s/34912194#34912194", "title": "Why is the default implementation of DbConnection.OpenAsync(CancellationToken) synchronous?", "body": "<p>Your <code>await Task.Run(async () =&gt; await connection.OpenAsync())</code> wouldn't execute <code>connection.OpenAsync()</code> in the same thread, but it's perfectly reasonable for <code>connection.OpenAsync()</code> and <code>connection.Open()</code> to depend on thread-local state. They may and generally should pay attention to <a href=\"https://msdn.microsoft.com/en-us/library/system.transactions.transaction.current(v=vs.110).aspx\" rel=\"nofollow\"><code>Transaction.Current</code></a>, for instance. If .NET Framework silently executed <code>connection.Open()</code> in a background thread, some people would get very wrong results.</p>\n"}, {"tags": [], "owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "is_accepted": false, "score": 1, "last_activity_date": 1453503981, "creation_date": 1453503981, "answer_id": 34957425, "question_id": 34911914, "link": "https://stackoverflow.com/questions/34911914/why-is-the-default-implementation-of-dbconnection-openasynccancellationtoken-s/34957425#34957425", "title": "Why is the default implementation of DbConnection.OpenAsync(CancellationToken) synchronous?", "body": "<blockquote>\n  <p>Why is the default implementation this way</p>\n</blockquote>\n\n<p>In a word: backwards compatibility. In an ideal world, <code>ConnectAsync</code> would be an abstract method; however, this was not possible because there were already many <code>DbConnection</code> implementations by the time <code>async</code> came on the scene.</p>\n\n<p>So, the designers of <code>DbConnection</code> had to choose either synchronous or fake-asynchronous (thread pool) implementations. Neither choice provides a great end-user experience.</p>\n\n<p>For an interesting counterexample, consider <code>Stream</code>. This is another common base class that faced the same issue, but made the opposite choice (that is, the base <code>Stream.ReadAsync</code> implementation calls <code>Stream.Read</code> from the thread pool).</p>\n\n<blockquote>\n  <p>and how is one supposed to know when Task.Run() is needed without writing provider-aware code?</p>\n</blockquote>\n\n<p>Unfortunately, that is not possible. You have to think of a <code>Task</code>-returning member on a base type or interface as meaning <em>possibly</em> asynchronous.</p>\n"}], "owner": {"reputation": 5864, "user_id": 429091, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a8defe14b1c80bc2bd59a1fab3848cfb?s=128&d=identicon&r=PG", "display_name": "binki", "link": "https://stackoverflow.com/users/429091/binki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 0, "accepted_answer_id": 34912194, "answer_count": 3, "score": 4, "last_activity_date": 1533230942, "creation_date": 1453329137, "last_edit_date": 1533230942, "question_id": 34911914, "link": "https://stackoverflow.com/questions/34911914/why-is-the-default-implementation-of-dbconnection-openasynccancellationtoken-s", "title": "Why is the default implementation of DbConnection.OpenAsync(CancellationToken) synchronous?", "body": "<p>I was reading the <a href=\"https://msdn.microsoft.com/en-us/library/hh223693%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">documentation for <code>DbConnection.OpenAsync(CancellationToken)</code></a> and found the following snippet:</p>\n\n<blockquote>\n  <p>The default implementation invokes the synchronous <a href=\"https://msdn.microsoft.com/en-us/library/system.data.common.dbconnection.open(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Open</a> call and returns a completed task. The default implementation will return a cancelled task if passed an already cancelled cancellationToken. Exceptions thrown by Open will be communicated via the returned Task Exception property.</p>\n</blockquote>\n\n<p>Now, if I were on a spotty/slow network connection and used a database provider that hasn\u2019t overridden <code>DbConnection.OpenAsync(CancellationToken)</code> (i.e., I\u2019m using something other than <code>System.Data.SqlClient</code>), <em>and</em> if I plopped that into a UI Button\u2019s event handler, like: (hypothetical code, untested)</p>\n\n<pre><code>async void button1_Clicked(object sender, EventArgs e)\n{\n    using (var connection = MyProviderFactory.CreateConnection())\n    {\n        button1.Text = \"Opening\u2026\";\n        connection.ConnectionString = _SomeString;\n        try\n        {\n            await connection.OpenAsync(default);\n            button1.Text = \"Opened successfully!\";\n        }\n        catch (Exception ex)\n        {\n            button1.Text = ex.Message;\n        }\n    }\n}\n</code></pre>\n\n<p>Based on the documentation I quoted, if the connection took long enough to complete, my Form would be \u201c (Not Responding)\u201d while the connection was being established if the provider hasn\u2019t overridden the default implementation. To prevent this from happening regardless of the underlying database provider, I might as well do <code>await Task.Run(async () =&gt; await connection.OpenAsync());</code>. Why is the default implementation this way and how is one supposed to know when <code>Task.Run()</code> is needed without writing provider-aware code?</p>\n"}, {"tags": ["c#", "date", "parsing", "string-parsing"], "comments": [{"owner": {"reputation": 2633, "user_id": 283606, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e56c33d441fc4675d9d4fd0fc09002aa?s=128&d=identicon&r=PG", "display_name": "Aleksandr Ivanov", "link": "https://stackoverflow.com/users/283606/aleksandr-ivanov"}, "edited": false, "score": 0, "creation_date": 1453329437, "post_id": 34911874, "comment_id": 57559573, "body": "Use regular expression to get date strings, and then use your method to converting it to <code>DateTime</code>."}, {"owner": {"reputation": 34967, "user_id": 961695, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8e7b165d12beed90e3727119042bb948?s=128&d=identicon&r=PG", "display_name": "Yuriy Galanter", "link": "https://stackoverflow.com/users/961695/yuriy-galanter"}, "edited": false, "score": 0, "creation_date": 1453329851, "post_id": 34911874, "comment_id": 57559747, "body": "Is the text preceding dates always the same? If that&#39;s the case you can use simple substring to cut the date"}, {"owner": {"reputation": 2396, "user_id": 1109689, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/68f0d70e27d1cc00bdc1d883da0219a9?s=128&d=identicon&r=PG", "display_name": "h-rai", "link": "https://stackoverflow.com/users/1109689/h-rai"}, "edited": false, "score": 0, "creation_date": 1453330337, "post_id": 34911874, "comment_id": 57559955, "body": "<code>DateTime.ParseExact()</code> method exactly parses string like <code>01&#47;20&#47;2012</code> into a date object. You are trying to convert the whole string which contains a date value into a date object which is not possible. Extract the date string using regular expression and parse that into a date object."}], "answers": [{"tags": [], "owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "is_accepted": true, "score": 3, "last_activity_date": 1453329860, "creation_date": 1453329860, "answer_id": 34912069, "question_id": 34911874, "link": "https://stackoverflow.com/questions/34911874/extracting-a-date-value-from-a-string/34912069#34912069", "title": "Extracting a Date value from a string", "body": "<p>You can use <a href=\"https://msdn.microsoft.com/en-us/library/0z2heewz(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>Regex.Match</code></a> to get the first date string you meet. This method returns the first substring that matches a regular expression pattern in an input string.</p>\n\n<pre><code>string stringWithDate = \"Employee Filter: All Employees; Time Entry Dates: 01/07/2016-01/07/2016; Exceptions: All Exceptions\";\nMatch match = Regex.Match(stringWithDate, @\"\\d{2}\\/\\d{2}\\/\\d{4}\");\nstring date = match.Value;\nif (!string.IsNullOrEmpty(date)) {\n    var dateTime = DateTime.ParseExact(date, \"MM/dd/yyyy\", CultureInfo.CurrentCulture);\n    Console.WriteLine(dateTime.ToString());\n}\n</code></pre>\n\n<p>What the regular expression <code>\\d{2}\\/\\d{2}\\/\\d{4}</code> does:<br>\n<a href=\"https://i.stack.imgur.com/TwSTk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TwSTk.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 5411243, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E76BlcSHwY4/AAAAAAAAAAI/AAAAAAAAAdE/oFU48nvqvTk/photo.jpg?sz=128", "display_name": "Adeel Kamran", "link": "https://stackoverflow.com/users/5411243/adeel-kamran"}, "edited": false, "score": 0, "creation_date": 1549662035, "post_id": 54600593, "comment_id": 95997559, "body": "For me this above code works to get DATE from text string."}], "tags": [], "owner": {"reputation": 73, "user_id": 5411243, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-E76BlcSHwY4/AAAAAAAAAAI/AAAAAAAAAdE/oFU48nvqvTk/photo.jpg?sz=128", "display_name": "Adeel Kamran", "link": "https://stackoverflow.com/users/5411243/adeel-kamran"}, "is_accepted": false, "score": 0, "last_activity_date": 1549661920, "creation_date": 1549661920, "answer_id": 54600593, "question_id": 34911874, "link": "https://stackoverflow.com/questions/34911874/extracting-a-date-value-from-a-string/54600593#54600593", "title": "Extracting a Date value from a string", "body": "<pre><code> var regex = new Regex(@\"\\d{2}\\/\\d{2}\\/\\d{4}\");\n foreach (Match m in regex.Matches(line))\n {\n  DateTime dt;\n  if (DateTime.TryParseExact(m.Value, \"MM/dd/yyyy\", null, DateTimeStyles.None, out dt))\n  remittanceDateArr[chequeNo - 1] = dt.ToString(\"MM/dd/yyyy\");                                   \n  rtbExtract.Text = rtbExtract.Text + remittanceDateArr[chequeNo - 1] + \"\\n\";\n  }\n</code></pre>\n"}], "owner": {"reputation": 562, "user_id": 2272357, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d3d250d994db4c4d9c2a1c14de245ef9?s=128&d=identicon&r=PG", "display_name": "HappyCoding", "link": "https://stackoverflow.com/users/2272357/happycoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3557, "favorite_count": 0, "accepted_answer_id": 34912069, "answer_count": 2, "score": 0, "last_activity_date": 1549661920, "creation_date": 1453328979, "question_id": 34911874, "link": "https://stackoverflow.com/questions/34911874/extracting-a-date-value-from-a-string", "title": "Extracting a Date value from a string", "body": "<p>Forum.</p>\n\n<p>My code reads from an excel file and gets the following string in a variable 'textContainingDate':  </p>\n\n<pre><code>\"Employee Filter: All Employees; Time Entry Dates: 01/07/2016-01/07/2016; Exceptions: All Exceptions\"\n</code></pre>\n\n<p>What I would like to do is extract the date value from the string. Although there are two dates to be read as a date range, the two dates will always be the same. My thought is, regardless of the scenario, I will be satisfied with the first date I come across.</p>\n\n<pre><code>var dateTime = DateTime.ParseExact(textContainingDate, \"MM/dd/yyyy\", CultureInfo.CurrentCulture);\n</code></pre>\n\n<p>I tried using the above statement, which I pieced together from other stackoverflow questions and Googled articles. From what I have read, I believe it fails because it is expecting only a date string.</p>\n\n<p>Any advising on a solution and/or direction towards what text to read to find a solution is appreciated.</p>\n"}, {"tags": ["c#", "multithreading", "winforms", "treeview"], "comments": [{"owner": {"reputation": 2784, "user_id": 2134198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/901oM.jpg?s=128&g=1", "display_name": "Jens Meinecke", "link": "https://stackoverflow.com/users/2134198/jens-meinecke"}, "edited": false, "score": 0, "creation_date": 1453333254, "post_id": 34911858, "comment_id": 57561081, "body": "Have you tried <code>tree.Invalidate()</code> after the <code>foreach</code> loop?"}, {"owner": {"reputation": 29, "user_id": 2985365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1155c308370d6782d8666c27f0df06c1?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2985365/dmitry"}, "reply_to_user": {"reputation": 2784, "user_id": 2134198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/901oM.jpg?s=128&g=1", "display_name": "Jens Meinecke", "link": "https://stackoverflow.com/users/2134198/jens-meinecke"}, "edited": false, "score": 0, "creation_date": 1453503941, "post_id": 34911858, "comment_id": 57646477, "body": "@&#220;bercoder yes, no result"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5816844, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153423550417075/picture?type=large", "display_name": "BroCode", "link": "https://stackoverflow.com/users/5816844/brocode"}, "is_accepted": false, "score": 0, "last_activity_date": 1453334693, "creation_date": 1453334693, "answer_id": 34913053, "question_id": 34911858, "link": "https://stackoverflow.com/questions/34911858/treeview-does-not-update-when-modified-windows-forms/34913053#34913053", "title": "TreeView does not update when modified. Windows Forms", "body": "<p>Did you try setting the focus back to the treeview? With TreeView.Focus() this causes a refresh.</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 2985365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1155c308370d6782d8666c27f0df06c1?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2985365/dmitry"}, "edited": false, "score": 0, "creation_date": 1453503109, "post_id": 34921426, "comment_id": 57646148, "body": "It turns out that TreeNode can&#39;t be used by more than one TreeView. So in order to do it I had to treeNode.Clone() it or to store TreeNodes not in TreeView."}], "tags": [], "owner": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "is_accepted": false, "score": 2, "last_activity_date": 1453372802, "creation_date": 1453372802, "answer_id": 34921426, "question_id": 34911858, "link": "https://stackoverflow.com/questions/34911858/treeview-does-not-update-when-modified-windows-forms/34921426#34921426", "title": "TreeView does not update when modified. Windows Forms", "body": "<p>I suspect that one TreeNode cannot be changed from one TreeView to another</p>\n\n<p>This is my test code that works:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button3_Click(object sender, EventArgs e)\n        {\n            ChangeTree(treeView1);\n        }\n\n        public void ChangeTree(TreeView tree)\n        {\n            Thread thread4 = new Thread(() =&gt; { UpdateTreeView(tree); });\n            thread4.Name = \"Thread 4\";\n            thread4.IsBackground = true;\n            thread4.Start();\n        }\n\n        private void UpdateTreeView(TreeView tree)\n        {\n            if (tree.InvokeRequired)\n            {\n                tree.Invoke((MethodInvoker)delegate\n                {\n                    UpdateTreeView(tree);\n                });\n            }\n            else\n            {\n                tree.Nodes.Clear();\n                foreach (var node in GetTree())\n                {\n                    tree.Nodes.Add(node as TreeNode);\n                }\n            }\n        }\n\n        private List&lt;TreeNode&gt; GetTree()\n        {\n            var result = new List&lt;TreeNode&gt;();\n\n            result.Add(new TreeNode(\"changed\"));\n\n            return result;\n        }\n    }\n}\n</code></pre>\n\n<p>If I change the <code>GetTree()</code> function into</p>\n\n<pre><code>    private TreeView GetTree()\n    {\n        var result = new TreeView();\n\n        result.Nodes.Add(new TreeNode(\"changed\"));\n\n        return result;\n    }\n</code></pre>\n\n<p>And revert the <code>UpdateTreeView</code> function into what it was before, it behaves like you described</p>\n"}], "owner": {"reputation": 29, "user_id": 2985365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1155c308370d6782d8666c27f0df06c1?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2985365/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1453503881, "creation_date": 1453328911, "last_edit_date": 1453503881, "question_id": 34911858, "link": "https://stackoverflow.com/questions/34911858/treeview-does-not-update-when-modified-windows-forms", "title": "TreeView does not update when modified. Windows Forms", "body": "<p>I have a Windows Forms C# application which deals with TreeView and uses a separate thread to update it. \nUpdate launched by button click:</p>\n\n<pre><code>    private void button3_Click(object sender, EventArgs e)\n    {\n        vc.ChangeTree(treeView1);\n    }\n</code></pre>\n\n<p>ChangeTree() starts UpdateTree() in a separate thread to update the TreeView asynchronously. \nHere I just need to use Thread for this:</p>\n\n<pre><code>    public void ChangeTree(TreeView tree)\n    {\n        Thread thread4 = new Thread(() =&gt; { UpdateTreeView(tree); });\n        thread4.Name = \"Thread 4\";\n        thread4.IsBackground = true;\n        thread4.Start();\n    }\n</code></pre>\n\n<p>UpdateTree() simply invokes the TreeView and adds nodes from another tree to it. Note that there aren't time consuming operations. The GetTree() just returns another TreeView: </p>\n\n<pre><code>    private void UpdateTreeView(TreeView tree)\n    {\n        if (tree.InvokeRequired)\n        {\n            tree.Invoke((MethodInvoker)delegate\n            {\n                UpdateTreeView(tree);\n            });\n        }\n        else\n        {\n            tree.Nodes.Clear();\n            foreach (var node in GetTree().Nodes)\n            {\n                tree.Nodes.Add(node as TreeNode);\n            }\n            //Application.DoEvents(); // doesn't help\n        }\n    }\n</code></pre>\n\n<p>The problem is that it actually adds nodes to the tree, but form does not show it. I checked the treeView1.Nodes after i clicked the button. It contains the nodes I need. </p>\n\n<p>The Application.DoEvents() does not help, even though it may, according to my search. Neither does treeView1.Refresh().</p>\n\n<p>If i click the button twice, treeView1 updates as I planned. But I don't know why and, obviously, I don't need such behavior.</p>\n\n<p>So here is the question. How to make it update with one click?</p>\n\n<hr>\n\n<p>It turns out that TreeNode can't be used by more than one TreeView. </p>\n\n<p><strong>The solution</strong> I found is to use treeNode.Clone():</p>\n\n<pre><code>tree.Nodes.Add((node as TreeNode).Clone() as TreeNode);\n</code></pre>\n\n<p><strong>But</strong> I still don't understand why the initial code worked, even though it took two times for it.</p>\n"}, {"tags": ["c#", "c++", "powershell", "winapi", "explorer"], "comments": [{"owner": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "edited": false, "score": 0, "creation_date": 1453344697, "post_id": 34911797, "comment_id": 57564287, "body": "FWIW, on my Windows Server 2008R2 (Win 7) system, using the verbs <code>taskbarpin</code> and <code>taskbarunpin</code> worked, whereas &quot;&amp;Pin to Taskbar&quot; and &quot;Unpin from Taskbar&quot; didn&#39;t work, in the call to InvokeVerb."}, {"owner": {"reputation": 1951, "user_id": 941548, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b13d4393e6fda83cea20e7b68a2966d?s=128&d=identicon&r=PG", "display_name": "Malcolm McCaffery", "link": "https://stackoverflow.com/users/941548/malcolm-mccaffery"}, "reply_to_user": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "edited": false, "score": 0, "creation_date": 1453443485, "post_id": 34911797, "comment_id": 57612428, "body": "Yeah thats what I meant...Windows 10 RTM also works, but was disabled in an update &quot;by design&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "edited": false, "score": 0, "creation_date": 1453336588, "post_id": 34911948, "comment_id": 57562101, "body": "are you suggesting to somehow cast a number below 65536 as a pointer to a string in Powershell? I suppose using Runtime.Marshal or some other form of .NET/COM interop that might be possible."}, {"owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "reply_to_user": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "edited": false, "score": 0, "creation_date": 1453336649, "post_id": 34911948, "comment_id": 57562117, "body": "@user2460798 Nope, I was answering the &quot;or Win32 C/C++&quot; part of the question. No idea how you would do this in the other things."}], "tags": [], "owner": {"reputation": 33827, "user_id": 506413, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1a474f3be606bcc6f964913b523626e9?s=128&d=identicon&r=PG", "display_name": "Jonathan Potter", "link": "https://stackoverflow.com/users/506413/jonathan-potter"}, "is_accepted": true, "score": 1, "last_activity_date": 1453329243, "creation_date": 1453329243, "answer_id": 34911948, "question_id": 34911797, "link": "https://stackoverflow.com/questions/34911797/windows-shell-automation-invokeverb-based-on-number-instead-of-command-string/34911948#34911948", "title": "Windows Shell Automation InvokeVerb based on number instead of command string", "body": "<p>The underlying shell context menu extension system actually works with numeric IDs natively; string verbs are an <strong>optional</strong> layer on top. However as you observe, command IDs are internal to a context menu extension and are not guaranteed to stay the same between versions (or even between invocations) - the whole point of verbs is that they allow commands to be invoked programatically irrespective of their ID.</p>\n\n<p>In C/C++ you can invoke a command by its ID by casting the numeric ID as a string pointer (the rationale being that since all valid string pointers are higher than 65535, it's \"safe\" to pass a number as a string pointer as long as it fits into 16 bits, since the receiving API is able to correctly determine whether it is a \"real string\" or not).</p>\n\n<p>Note that this is different from printing the number as a string, which is not correct. The <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms648029(v=vs.85).aspx\" rel=\"nofollow\"><code>MAKEINTRESOURCE</code></a> macro exists for exactly this purpose.</p>\n\n<p>E.g., a command with ID 1234 would be invoked using <code>MAKEINTRESOURCE(1234)</code> as the verb.</p>\n"}, {"tags": [], "owner": {"reputation": 119, "user_id": 5739443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953b8f82ebef80e4ff265cffb95dea?s=128&d=identicon&r=PG&f=1", "display_name": "lidqy", "link": "https://stackoverflow.com/users/5739443/lidqy"}, "is_accepted": false, "score": 1, "last_activity_date": 1572745048, "last_edit_date": 1572745048, "creation_date": 1572744737, "answer_id": 58676730, "question_id": 34911797, "link": "https://stackoverflow.com/questions/34911797/windows-shell-automation-invokeverb-based-on-number-instead-of-command-string/58676730#58676730", "title": "Windows Shell Automation InvokeVerb based on number instead of command string", "body": "<p>I ran into the same problem these days, in a Windows Script Host based script.</p>\n\n<p>Invoking the verb with the localized string didn't work as it used to.\nHowever you can still get the item's \"Verbs\" collection and then enumerate them until you get the verb you want to invoke. Then you can invoke it using it's \"DoIt\" method, without the need to pass the verbs name in.</p>\n\n<p>In a WSH JScript it looks like this:</p>\n\n<pre><code>    /* workaround for 'item.InvokeVerb(\"&amp;Delete\")' which no longer works */\n\n    var verbs = item.Verbs(); // item == return of folder.ParseName(..)\n\n    for (var x = 0; x &lt; verbs.Count; x++)\n    {\n        var verb = verbs.Item(x);\n        if (verb.Name == \"&amp;Delete\") //replace with \"&amp;Pin to taskbar\"\n        {                   \n            try\n            {\n                verb.DoIt();\n                WSH.Echo (\"Deleted:\", item.Name);\n            }\n            catch(e)\n            {\n                WSH.Echo (\"Error Deleting:\", item.Name + \"\\r\\n\\t\", e.description, e.number);\n            }\n\n            break;\n        }\n    }\n}\n</code></pre>\n\n<p>Likely it also works somehow in PowerShell</p>\n\n<p>ffr:<br/>\n<a href=\"https://docs.microsoft.com/en-us/windows/win32/shell/folderitem-verbs\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/shell/folderitem-verbs</a><br/>\n<a href=\"https://docs.microsoft.com/en-us/windows/win32/shell/folderitemverb\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/shell/folderitemverb</a></p>\n"}], "owner": {"reputation": 1951, "user_id": 941548, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b13d4393e6fda83cea20e7b68a2966d?s=128&d=identicon&r=PG", "display_name": "Malcolm McCaffery", "link": "https://stackoverflow.com/users/941548/malcolm-mccaffery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 34911948, "answer_count": 2, "score": 1, "last_activity_date": 1572745048, "creation_date": 1453328621, "question_id": 34911797, "link": "https://stackoverflow.com/questions/34911797/windows-shell-automation-invokeverb-based-on-number-instead-of-command-string", "title": "Windows Shell Automation InvokeVerb based on number instead of command string", "body": "<p>Normally shell automation InvokeVerb only accepts a string command, based on the documentation here: <a href=\"https://msdn.microsoft.com/en-us/library/ms723189(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms723189(v=vs.85).aspx</a></p>\n\n<p>However I noticed a cmd line EXE utility that accepts a number instead\n<a href=\"http://www.technosys.net/products/utils/pintotaskbar\" rel=\"nofollow\">http://www.technosys.net/products/utils/pintotaskbar</a></p>\n\n<p>This is interesting because in Windows 10 \"&amp;Pin to taskbar\" is removed from shell automation, despite being visible in the UI. ( <a href=\"https://connect.microsoft.com/PowerShell/feedback/details/1609288/pin-to-taskbar-no-longer-working-in-windows-10\" rel=\"nofollow\">https://connect.microsoft.com/PowerShell/feedback/details/1609288/pin-to-taskbar-no-longer-working-in-windows-10</a> )</p>\n\n<p>However with this EXE passing the \"number\" 5386 as the command works.</p>\n\n<p>I am interested to know what methods can be used to achieve this in either PowerShell/VBScript/.NET language or Win32 C/C++. </p>\n\n<p>I understand this is almost certainly unsupported and likely to break any time as these numbers have changed between OS releases.</p>\n\n<p>An example using the string version in PowerShell</p>\n\n<pre><code>$filepath = \"C:\\windows\\system32\\notepad.exe\"\n$path = Split-Path $FilePath \n$shell= New-Object -com \"Shell.Application\"  \n$folder=$shell.Namespace($path)    \n$item = $folder.Parsename((split-path $FilePath -leaf)) \n$item.InvokeVerb(\"&amp;Pin to taskbar\")\n</code></pre>\n"}, {"tags": ["c#", "wpf", "mvvm"], "comments": [{"owner": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "edited": false, "score": 0, "creation_date": 1453330030, "post_id": 34911711, "comment_id": 57559817, "body": "Have a look at Commands <a href=\"http://www.wpf-tutorial.com/commands/introduction/\" rel=\"nofollow noreferrer\">wpf-tutorial.com/commands/introduction</a>"}, {"owner": {"reputation": 49, "user_id": 5764571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/381a8f860ce1d05348edd2cddd960184?s=128&d=identicon&r=PG&f=1", "display_name": "Everix", "link": "https://stackoverflow.com/users/5764571/everix"}, "reply_to_user": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "edited": false, "score": 0, "creation_date": 1453330427, "post_id": 34911711, "comment_id": 57560006, "body": "@komaflash Yeah, I&#39;m familiar with binding to Commands in the view, I just hadn&#39;t thought of using them in the context of ViewModel -&gt; ViewModel communication. Seems like it could work fairly well to take a Command (CloseCommand, etc) or whatever as a constructor argument and then just call that command whenever needed."}, {"owner": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "edited": false, "score": 0, "creation_date": 1453377615, "post_id": 34911711, "comment_id": 57579921, "body": "You coudl use relative binding, have a look at my answer."}, {"owner": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "edited": false, "score": 0, "creation_date": 1514894211, "post_id": 34911711, "comment_id": 83093475, "body": "Could you please mark my post as answer if it was helpfull?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5764571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/381a8f860ce1d05348edd2cddd960184?s=128&d=identicon&r=PG&f=1", "display_name": "Everix", "link": "https://stackoverflow.com/users/5764571/everix"}, "edited": false, "score": 0, "creation_date": 1453329737, "post_id": 34912004, "comment_id": 57559708, "body": "Yeah, I thought about using the first method. However, I think that doing exactly that couples the two View Models together too tightly and doesn&#39;t allow you to unit test very well as you can&#39;t mock up the &quot;parent&quot; view model.    The second method seems viable, but it feels wrong to handle this in an event based manner due to the nature of the relationship between the view models."}, {"owner": {"reputation": 13840, "user_id": 1177147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/zHhAS.jpg?s=128&g=1", "display_name": "Mark Feldman", "link": "https://stackoverflow.com/users/1177147/mark-feldman"}, "edited": false, "score": 0, "creation_date": 1453332338, "post_id": 34912004, "comment_id": 57560743, "body": "Definitely the second one, the parent should always inject its dependencies into the child. This is particularly important when it comes to unit testing. Try Googling &quot;Dependency Injection&quot; (specifically Ninject) and &quot;Inversion of Control&quot;."}], "tags": [], "owner": {"reputation": 926, "user_id": 5743967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e855822f999e8abdece6bdd5a413e60?s=128&d=identicon&r=PG&f=1", "display_name": "Shadowed", "link": "https://stackoverflow.com/users/5743967/shadowed"}, "is_accepted": false, "score": 0, "last_activity_date": 1453329505, "creation_date": 1453329505, "answer_id": 34912004, "question_id": 34911711, "link": "https://stackoverflow.com/questions/34911711/wpf-mvvm-proper-way-to-call-method-in-parent-view-model/34912004#34912004", "title": "WPF MVVM - Proper way to call method in &quot;parent&quot; View Model", "body": "<p>I'm not sure about proper way but here are two options that come to mind and seems pretty proper to me :)</p>\n\n<p>One is to add <code>MainWindowViewModel Parent {get;set;}</code> property to child model and then in main <code>MainWindowViewModel</code> to set that property whenever you add or remove child to a <code>Tabs</code> collection (as it's ObservableCollection, you can add event handlers to it to make sure, to set Parent property no matter how child is added to collection).\nSomething like this is used in Win Forms to maintain parent/child relation between window and controls.</p>\n\n<p>Second one is to add event to child ViewModel and to subscribe/unsubscribe to that event in parent ViewModel when child is added/removed (similarly to first option just with events, not with property). Then from event handler you can call method you wanted</p>\n\n<p>First option is more direct answer to your question (calling parent's method from child).\nSecond option is more general, child doesn't have to be aware of parent and you can subscribe to event from some other kind of parent or whatever you want.</p>\n\n<p>Which is more proper depends on your need for current project.</p>\n"}, {"tags": [], "owner": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "is_accepted": false, "score": 2, "last_activity_date": 1453377653, "creation_date": 1453377653, "answer_id": 34923271, "question_id": 34911711, "link": "https://stackoverflow.com/questions/34911711/wpf-mvvm-proper-way-to-call-method-in-parent-view-model/34923271#34923271", "title": "WPF MVVM - Proper way to call method in &quot;parent&quot; View Model", "body": "<p>You could access the parents DataContext by using a relative binding like this:</p>\n\n<pre><code>Binding=\"{Binding RelativeSource={RelativeSource FindAncestor, \n    AncestorType={x:Type Window}}, Path=DataContext.AllowItemCommand}\"\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5764571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/381a8f860ce1d05348edd2cddd960184?s=128&d=identicon&r=PG&f=1", "display_name": "Everix", "link": "https://stackoverflow.com/users/5764571/everix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2664, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1453377653, "creation_date": 1453328260, "question_id": 34911711, "link": "https://stackoverflow.com/questions/34911711/wpf-mvvm-proper-way-to-call-method-in-parent-view-model", "title": "WPF MVVM - Proper way to call method in &quot;parent&quot; View Model", "body": "<p>I'm working on a project in WPF-MVVM where I have a Main Window that contains a Tab Control with two tabs. Each of these tabs has a button on it.</p>\n\n<p>In this project, there are 3 different View Models, one for the Main Window and one for each of the tabs. When one of the buttons is pressed, I would like the \"parent\" view model (the View Model for the Main Window) to perform some action, such as closing the application.</p>\n\n<p>What is the proper way to go about having the View Model for the Tabs ask the Main View Model to perform this action?</p>\n\n<p><a href=\"http://i.stack.imgur.com/MSKEb.png\" rel=\"nofollow\">Screenshot of Application</a>  </p>\n\n<p><a href=\"http://pastebin.com/wUfyPhz9\" rel=\"nofollow\">Code on Pastebin</a></p>\n\n<p><strong>Note: I am not using any sort of framework such as MVVM Light or Prism.</strong></p>\n"}, {"tags": ["c#", "excel", "add-in"], "comments": [{"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 0, "creation_date": 1453328183, "post_id": 34911648, "comment_id": 57558998, "body": "Can you set a break point to see exactly which line causes it to crash?"}, {"owner": {"reputation": 1162, "user_id": 4339319, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh4.googleusercontent.com/-UF4YDM-Oy40/AAAAAAAAAAI/AAAAAAAAABI/4f_jMruyo9U/photo.jpg?sz=128", "display_name": "Little Fox", "link": "https://stackoverflow.com/users/4339319/little-fox"}, "reply_to_user": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 0, "creation_date": 1453329299, "post_id": 34911648, "comment_id": 57559504, "body": "@MattBurland it crashes at  col.Insert(XlInsertShiftDirection.xlShiftToRight, false);"}], "answers": [{"tags": [], "owner": {"reputation": 1101, "user_id": 3626160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U5qkD.png?s=128&g=1", "display_name": "TheAtomicOption", "link": "https://stackoverflow.com/users/3626160/theatomicoption"}, "is_accepted": false, "score": 0, "last_activity_date": 1510173662, "creation_date": 1510173662, "answer_id": 47189272, "question_id": 34911648, "link": "https://stackoverflow.com/questions/34911648/excel-crashes-when-editing-column/47189272#47189272", "title": "Excel crashes when editing column", "body": "<p>You can't add columns while editing a cell. See the answers to <a href=\"https://stackoverflow.com/questions/221984/how-to-tell-if-excel-application-is-in-cell-edit-mode?noredirect=1&amp;lq=1\">this SO question for code</a> that can test and let you abort if you press F3 accidentally while in a cell.</p>\n"}], "owner": {"reputation": 1162, "user_id": 4339319, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh4.googleusercontent.com/-UF4YDM-Oy40/AAAAAAAAAAI/AAAAAAAAABI/4f_jMruyo9U/photo.jpg?sz=128", "display_name": "Little Fox", "link": "https://stackoverflow.com/users/4339319/little-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510173662, "creation_date": 1453327950, "last_edit_date": 1453329250, "question_id": 34911648, "link": "https://stackoverflow.com/questions/34911648/excel-crashes-when-editing-column", "title": "Excel crashes when editing column", "body": "<p>I want to insert a new column when I press <strong>F3</strong>, my code works, but if I press <strong>F3</strong> while I'm editing some column - my Excel crashes. How can I solve this? </p>\n\n<pre><code>if (checkModifiers() &amp;&amp; (checkKey(Keys.F3)))\n{\n    try \n    {\n        Workbook wb = Globals.ThisAddIn.Application.ActiveWorkbook;\n        Worksheet ws = Globals.ThisAddIn.Application.ActiveSheet;\n        Microsoft.Office.Interop.Excel.Range rng = (Microsoft.Office.Interop.Excel.Range)Globals.ThisAddIn.Application.ActiveCell;\n\n        Range col = rng.EntireColumn;\n        col.Insert(XlInsertShiftDirection.xlShiftToRight, false);\n        col.Interior.Color = System.Drawing.Color.DarkOrange;\n\n\n    } \n    catch(Exception ex)\n    { \n        MessageBox.Show(ex.ToString()); \n    }\n}\n</code></pre>\n\n<p>I have tried</p>\n\n<pre><code>Globals.ThisAddIn.Application.EnableEvents = false;\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Globals.ThisAddIn.Application.Interactive = false;\n</code></pre>\n\n<p>but it didn't help, or I used them in the wrong way.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XpDm8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XpDm8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "command-line", "process", "cmd"], "comments": [{"owner": {"reputation": 41117, "user_id": 1864167, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WalEV.jpg?s=128&g=1", "display_name": "Jeroen Vannevel", "link": "https://stackoverflow.com/users/1864167/jeroen-vannevel"}, "edited": false, "score": 0, "creation_date": 1453327861, "post_id": 34911561, "comment_id": 57558834, "body": "Do you know what the /c parameter does?"}, {"owner": {"reputation": 1815, "user_id": 1772419, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/181d9597aa3db07b3f4162f9bb9896b8?s=128&d=identicon&r=PG", "display_name": "CodingMadeEasy", "link": "https://stackoverflow.com/users/1772419/codingmadeeasy"}, "reply_to_user": {"reputation": 41117, "user_id": 1864167, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/WalEV.jpg?s=128&g=1", "display_name": "Jeroen Vannevel", "link": "https://stackoverflow.com/users/1864167/jeroen-vannevel"}, "edited": false, "score": 0, "creation_date": 1453327971, "post_id": 34911561, "comment_id": 57558891, "body": "@JeroenVannevel Yes. Hence why I&#39;m asking the question."}], "answers": [{"comments": [{"owner": {"reputation": 1815, "user_id": 1772419, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/181d9597aa3db07b3f4162f9bb9896b8?s=128&d=identicon&r=PG", "display_name": "CodingMadeEasy", "link": "https://stackoverflow.com/users/1772419/codingmadeeasy"}, "edited": false, "score": 0, "creation_date": 1453331089, "post_id": 34912233, "comment_id": 57560279, "body": "Thanks for the answer. If we redirect the output of &quot;application.exe&quot;, will cmd /c wait until the EndOfStream is reached? Or will it just close as soon as the process has started?"}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "reply_to_user": {"reputation": 1815, "user_id": 1772419, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/181d9597aa3db07b3f4162f9bb9896b8?s=128&d=identicon&r=PG", "display_name": "CodingMadeEasy", "link": "https://stackoverflow.com/users/1772419/codingmadeeasy"}, "edited": false, "score": 0, "creation_date": 1453331304, "post_id": 34912233, "comment_id": 57560358, "body": "<code>cmd &#47;c</code> is a synchronous call and will not return until the executed process runs to completion. Redirecting the output of &quot;application.exe&quot; would have no effect."}], "tags": [], "owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "is_accepted": true, "score": 3, "last_activity_date": 1453330537, "creation_date": 1453330537, "answer_id": 34912233, "question_id": 34911561, "link": "https://stackoverflow.com/questions/34911561/advantages-of-using-cmd-exe-c-over-not-using-cmd-at-all/34912233#34912233", "title": "Advantages of using cmd.exe /c over not using cmd at all", "body": "<p>If you use <code>cmd /c</code>, you can execute multiple commands at once by separating the commands with <code>&amp;&amp;</code>. For example: <code>cmd /c \"application1.exe&amp;&amp;application2.exe\"</code>. Otherwise if there is only one process to execute, there is no difference to simply executing the process directly.</p>\n\n<p>EDIT: Apparently <code>cmd /c</code> can also return an error if the process does not exist, for example.</p>\n"}, {"tags": [], "owner": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "is_accepted": false, "score": 1, "last_activity_date": 1453346022, "creation_date": 1453346022, "answer_id": 34914769, "question_id": 34911561, "link": "https://stackoverflow.com/questions/34911561/advantages-of-using-cmd-exe-c-over-not-using-cmd-at-all/34914769#34914769", "title": "Advantages of using cmd.exe /c over not using cmd at all", "body": "<p>Another benefit of using <code>CMD.EXE</code> is if you want to execute a built-in command. Many commands in <code>CMD.EXE</code> are not separate executables but are wholly implemented within <code>CMD.EXE</code> such as <code>dir</code>, <code>copy</code>, <code>mkdir</code>, <code>cd</code>, and so forth. <code>MKLINK</code> is a built in command I've seen trip people up. </p>\n\n<p>I don't know of a easy built in way to get a list of builtin commands. But you can get a list of <code>CMD.EXE</code> commands using <code>HELP</code> (which is not builtin!) and pass each command to <code>WHERE</code>. If not found by <code>WHERE</code> then the command must be builtin. </p>\n\n<p>Also if you want to execute BAT/CMD files, CMD.EXE is the way to go.</p>\n"}], "owner": {"reputation": 1815, "user_id": 1772419, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/181d9597aa3db07b3f4162f9bb9896b8?s=128&d=identicon&r=PG", "display_name": "CodingMadeEasy", "link": "https://stackoverflow.com/users/1772419/codingmadeeasy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3344, "favorite_count": 0, "accepted_answer_id": 34912233, "answer_count": 2, "score": 3, "last_activity_date": 1453346022, "creation_date": 1453327617, "question_id": 34911561, "link": "https://stackoverflow.com/questions/34911561/advantages-of-using-cmd-exe-c-over-not-using-cmd-at-all", "title": "Advantages of using cmd.exe /c over not using cmd at all", "body": "<p>If I'm running a process in C#. Is there any benefit to using cmd /c over just running the process directly? </p>\n\n<p>Ex: </p>\n\n<pre><code>ProcessStartInfo info = new ProcessStartInfo(\"cmd.exe\");\ninfo.Arguments = \"/c application.exe\";\nProcess.Start(info);\n</code></pre>\n\n<p>as opposed to </p>\n\n<pre><code>ProcessStartInfo info = new ProcessStartInfo(\"application.exe\");\nProcess.Start(info);\n</code></pre>\n"}, {"tags": ["c#", "wpf", "binding"], "comments": [{"owner": {"reputation": 315, "user_id": 1214141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ceb481fe3f6524af5a0d7d179cc376d?s=128&d=identicon&r=PG", "display_name": "Kami", "link": "https://stackoverflow.com/users/1214141/kami"}, "edited": false, "score": 0, "creation_date": 1453327532, "post_id": 34911475, "comment_id": 57558667, "body": "Why don&#39;t you bind the combobox in code behind?"}, {"owner": {"reputation": 315, "user_id": 1214141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ceb481fe3f6524af5a0d7d179cc376d?s=128&d=identicon&r=PG", "display_name": "Kami", "link": "https://stackoverflow.com/users/1214141/kami"}, "edited": false, "score": 0, "creation_date": 1453327710, "post_id": 34911475, "comment_id": 57558764, "body": "do the following:  genreComboBox.ItemSource = List&lt;Genre&gt;; genreComboBox.DisplayMemberPath = &quot;Name&quot;; genreComboBox..SelectedValuePath= &quot;Id&quot;;  genreComboBox.DataContext = List&lt;Genre&gt;;  Read List&lt;Genre&gt; in a List Object."}, {"owner": {"reputation": 49, "user_id": 1176869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7a4ba458c153efd1e608273091a30a1e?s=128&d=identicon&r=PG", "display_name": "Frank Vermeulen", "link": "https://stackoverflow.com/users/1176869/frank-vermeulen"}, "reply_to_user": {"reputation": 315, "user_id": 1214141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ceb481fe3f6524af5a0d7d179cc376d?s=128&d=identicon&r=PG", "display_name": "Kami", "link": "https://stackoverflow.com/users/1214141/kami"}, "edited": false, "score": 0, "creation_date": 1453327885, "post_id": 34911475, "comment_id": 57558847, "body": "Well, I&#39;m trying to wrap my head around Binding, which is still quite new. Would it make a difference whether I got <code>ItemSource={Binding}</code> in XAML and <code>genreComboBox.DataContext = genreList;</code> in code behind OR just <code>genreComboBox.ItemSource = genreList</code> in code behind?"}, {"owner": {"reputation": 49, "user_id": 1176869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7a4ba458c153efd1e608273091a30a1e?s=128&d=identicon&r=PG", "display_name": "Frank Vermeulen", "link": "https://stackoverflow.com/users/1176869/frank-vermeulen"}, "reply_to_user": {"reputation": 315, "user_id": 1214141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ceb481fe3f6524af5a0d7d179cc376d?s=128&d=identicon&r=PG", "display_name": "Kami", "link": "https://stackoverflow.com/users/1214141/kami"}, "edited": false, "score": 0, "creation_date": 1453328657, "post_id": 34911475, "comment_id": 57559236, "body": "Doesn&#39;t make a difference. I still get a NullReferenceException from albumListView.SelectedValue"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 1176869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7a4ba458c153efd1e608273091a30a1e?s=128&d=identicon&r=PG", "display_name": "Frank Vermeulen", "link": "https://stackoverflow.com/users/1176869/frank-vermeulen"}, "edited": false, "score": 0, "creation_date": 1453328649, "post_id": 34911615, "comment_id": 57559231, "body": "Simple, but neat trick. Still don&#39;t know what the actual binding problem was, but this will do just fine."}], "tags": [], "owner": {"reputation": 473, "user_id": 5784633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rz5Ix.jpg?s=128&g=1", "display_name": "Saifeddine M", "link": "https://stackoverflow.com/users/5784633/saifeddine-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1453327824, "creation_date": 1453327824, "answer_id": 34911615, "question_id": 34911475, "link": "https://stackoverflow.com/questions/34911475/wpf-combobox-with-name-and-id/34911615#34911615", "title": "WPF combobox with name and id", "body": "<p>You may try calling <code>getStuffById</code> by the orignal list of genres.</p>\n\n<pre><code>getStuffById(listofGenres[genreComboBox.SelectedIndex].GenreId);\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 1176869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7a4ba458c153efd1e608273091a30a1e?s=128&d=identicon&r=PG", "display_name": "Frank Vermeulen", "link": "https://stackoverflow.com/users/1176869/frank-vermeulen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 34911615, "answer_count": 1, "score": 0, "last_activity_date": 1453327824, "creation_date": 1453327272, "question_id": 34911475, "link": "https://stackoverflow.com/questions/34911475/wpf-combobox-with-name-and-id", "title": "WPF combobox with name and id", "body": "<p>I've got a ComboBox which looks like this:</p>\n\n<pre><code>    &lt;ComboBox x:Name=\"genreComboBox\" ItemsSource=\"{Binding}\" SelectionChanged=\"genreComboBox_SelectionChanged\"&gt;\n        &lt;ComboBox.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;TextBlock Text=\"{Binding Name}\"/&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/ComboBox.ItemTemplate&gt;\n    &lt;/ComboBox&gt;\n</code></pre>\n\n<p>I'm binding it to a list of Genres <code>List&lt;Genre&gt;</code>, which have a Name and a genreId. Whenever the selection changes, I update the DataContext of a GridView based on that id. So basically I need to display the name, and use the id in a <code>DataContext=someDB.getStuffById(int genreId);</code></p>\n\n<p>I've tried messing around with <code>getStuffById(genreComboBox.SelectedItem)</code> and <code>getStuffById(genreComboBox.SelectedValue)</code>, setting <code>DisplayMemeberPath=\"Name\"</code> and <code>SelectedValuePath=\"GenreId\"</code>. Most of the time, the named get displayed. </p>\n\n<p>Whatever I try to get that genreId out, I always get a NullReferenceException.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", ".net", "csv", ".net-4.5", "csvhelper"], "answers": [{"tags": [], "owner": {"reputation": 8718, "user_id": 478478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd8d8f41c11188824110ab54f92ad174?s=128&d=identicon&r=PG", "display_name": "Alex Hope O&#39;Connor", "link": "https://stackoverflow.com/users/478478/alex-hope-oconnor"}, "is_accepted": true, "score": 0, "last_activity_date": 1453417855, "creation_date": 1453417855, "answer_id": 34936158, "question_id": 34911419, "link": "https://stackoverflow.com/questions/34911419/csvhelper-fluent-class-mapping-constructusing-ignored-in-referenced-maps/34936158#34936158", "title": "CsvHelper fluent class mapping ConstructUsing() ignored in referenced maps?", "body": "<p>After also posting this question as an <a href=\"https://github.com/JoshClose/CsvHelper/issues/477\" rel=\"nofollow\">issue</a> I got the following response:</p>\n\n<blockquote>\n  <p>Taking a quick look at the source (as I don't have a computer to test it on at the moment), it looks like that isn't implemented, but should be a pretty quick thing to do.</p>\n</blockquote>\n"}], "owner": {"reputation": 8718, "user_id": 478478, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fd8d8f41c11188824110ab54f92ad174?s=128&d=identicon&r=PG", "display_name": "Alex Hope O&#39;Connor", "link": "https://stackoverflow.com/users/478478/alex-hope-oconnor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 0, "accepted_answer_id": 34936158, "answer_count": 1, "score": 0, "last_activity_date": 1453417855, "creation_date": 1453327096, "question_id": 34911419, "link": "https://stackoverflow.com/questions/34911419/csvhelper-fluent-class-mapping-constructusing-ignored-in-referenced-maps", "title": "CsvHelper fluent class mapping ConstructUsing() ignored in referenced maps?", "body": "<p>I was wondering if I am doing this right, but I am using <a href=\"https://github.com/JoshClose/CsvHelper\" rel=\"nofollow\">CsvHelper</a> and have the following fluent class maps defined:</p>\n\n<pre><code>        internal class WasteEstimationGenericDayCsvMap : CsvClassMap&lt;WasteEstimationGenericDay&gt;\n        {\n            public WasteEstimationGenericDayCsvMap(WasteEstimationGenericDay dayModel)\n            {\n                var qualityModel = dayModel.Quality;\n                ConstructUsing(() =&gt; new WasteEstimationGenericDay(dayModel.ModelUnitContext));\n                Map(m =&gt; m.InflowVolume).Name(dayModel.GetPropertyDisplayName(() =&gt; dayModel.InflowVolume));\n                References&lt;WasteStreamQualityCsvMap&gt;(m =&gt; m.Quality, qualityModel);\n            }\n        }\n\n        internal class WasteStreamQualityCsvMap : CsvClassMap&lt;WasteStreamQuality&gt;\n        {\n            public WasteStreamQualityCsvMap(WasteStreamQuality qualityModel)\n            {\n                ConstructUsing(() =&gt; new WasteStreamQuality(qualityModel.ModelUnitContext));\n                Map(m =&gt; m.TotalNitrogen).Name(qualityModel.GetPropertyDisplayName(() =&gt; qualityModel.TotalNitrogen));\n                Map(m =&gt; m.TotalPhosphorus).Name(qualityModel.GetPropertyDisplayName(() =&gt; qualityModel.TotalPhosphorus));\n                Map(m =&gt; m.TotalDissolvedSalts).Name(qualityModel.GetPropertyDisplayName(() =&gt; qualityModel.TotalDissolvedSalts));\n                Map(m =&gt; m.VolatileSolids).Name(qualityModel.GetPropertyDisplayName(() =&gt; qualityModel.VolatileSolids));\n                Map(m =&gt; m.TotalSolids).Name(qualityModel.GetPropertyDisplayName(() =&gt; qualityModel.TotalSolids));\n                Map(m =&gt; m.ElectricalConductivity).Name(qualityModel.GetPropertyDisplayName(() =&gt; qualityModel.ElectricalConductivity));\n            }\n        }\n</code></pre>\n\n<p>These class maps are designed to be able to map dynamic column names in no particular order to my type <code>WasteEstimationGenericDay</code>, however the problem is before mapping values to the type I need to specify the units those values are in, this is why <code>ConstructUsing()</code> is specified in each class map to set the units during the construction of the type for mapping.</p>\n\n<p>However for the referenced class map for the type <code>WasteStreamQuality</code> on the property <code>WasteEstimationGenericDay.Quality, the</code>ConstructUsing()` statement is never called and the units are not specified. Does anyone know if I am doing something wrong in my mapping configuration? or is this a bug/limitation in <a href=\"https://github.com/JoshClose/CsvHelper\" rel=\"nofollow\">CsvHelper</a>?</p>\n\n<p>I have also tried registering both class maps separately on the configuration like so:</p>\n\n<pre><code>      csvReaderConfig.RegisterClassMap(new WasteEstimationGenericDayCsvMap(dayModel));\n      csvReaderConfig.RegisterClassMap(new WasteStreamQualityCsvMap(dayModel.Quality));\n</code></pre>\n\n<p>But it does not appear to have any affect unless it is the type that was specified when calling <code>CsvReader.GetRecords&lt;T&gt;()</code>.</p>\n\n<p>Thanks for any help. </p>\n"}, {"tags": ["c#", "sql", "arrays", "wpf"], "comments": [{"owner": {"reputation": 143226, "user_id": 993547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aOivq.jpg?s=128&g=1", "display_name": "Patrick Hofman", "link": "https://stackoverflow.com/users/993547/patrick-hofman"}, "edited": false, "score": 1, "creation_date": 1453327037, "post_id": 34911372, "comment_id": 57558391, "body": "Why make it a string? Why not just save the bytes?"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 2, "creation_date": 1453329037, "post_id": 34911372, "comment_id": 57559391, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4057748/save-byte-into-a-sql-server-database-from-c-sharp\">Save byte&#91;&#93; into a SQL Server database from C#</a>"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 3, "creation_date": 1453329162, "post_id": 34911372, "comment_id": 57559443, "body": "Funny how things fare differently at different points in time. 3 close votes (before mine for duplicate), but <a href=\"http://stackoverflow.com/questions/4057748/save-byte-into-a-sql-server-database-from-c-sharp\">this very similar question</a> from 2010 has lots of upvotes. Also, I don&#39;t see why all the close votes, unless we&#39;d close as a duplicate. How is this off topic? OP gave minimal code and an explanation of what he tried."}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1454015013, "post_id": 34911372, "comment_id": 57866906, "body": "@MillieSmith not all systems are great. <a href=\"http://meta.stackoverflow.com/a/310511\">meta</a>"}], "answers": [{"comments": [{"owner": {"reputation": 143226, "user_id": 993547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aOivq.jpg?s=128&g=1", "display_name": "Patrick Hofman", "link": "https://stackoverflow.com/users/993547/patrick-hofman"}, "edited": false, "score": 0, "creation_date": 1453327464, "post_id": 34911493, "comment_id": 57558636, "body": "Why do you think he doesn&#39;t?"}, {"owner": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "reply_to_user": {"reputation": 143226, "user_id": 993547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aOivq.jpg?s=128&g=1", "display_name": "Patrick Hofman", "link": "https://stackoverflow.com/users/993547/patrick-hofman"}, "edited": false, "score": 0, "creation_date": 1453327572, "post_id": 34911493, "comment_id": 57558695, "body": "@PatrickHofman Because of his <code>GetStringFromBytes</code> and <code>GetBytesFromString</code> method he removed a few seconds ago. And he asks for the right way to store bytes in a database."}, {"owner": {"reputation": 9876, "user_id": 1667868, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/01faa51ea5dddd44aeeb572d4b45c835?s=128&d=identicon&r=PG&f=1", "display_name": "Sven van den Boogaart", "link": "https://stackoverflow.com/users/1667868/sven-van-den-boogaart"}, "edited": false, "score": 0, "creation_date": 1453327823, "post_id": 34911493, "comment_id": 57558817, "body": "How should i Retrive it? im storing it now just as a bytearray in a text value as other people suggested to remove the conversion function"}, {"owner": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "reply_to_user": {"reputation": 9876, "user_id": 1667868, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/01faa51ea5dddd44aeeb572d4b45c835?s=128&d=identicon&r=PG&f=1", "display_name": "Sven van den Boogaart", "link": "https://stackoverflow.com/users/1667868/sven-van-den-boogaart"}, "edited": false, "score": 0, "creation_date": 1453329372, "post_id": 34911493, "comment_id": 57559545, "body": "@SvenB I updated my answer. Hope it helps."}], "tags": [], "owner": {"reputation": 785, "user_id": 3451056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390b57162963fcecce553da29093ede4?s=128&d=identicon&r=PG&f=1", "display_name": "devmb", "link": "https://stackoverflow.com/users/3451056/devmb"}, "is_accepted": true, "score": 2, "last_activity_date": 1453329224, "last_edit_date": 1453329224, "creation_date": 1453327348, "answer_id": 34911493, "question_id": 34911372, "link": "https://stackoverflow.com/questions/34911372/c-put-a-byte-into-an-database-and-retrive-later/34911493#34911493", "title": "c# put a byte[] into an database and retrive later", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/ms188362.aspx\" rel=\"nofollow\">BINARY or VARBINARY</a> to store binary data.</p>\n\n<pre><code>string query = \"INSERT INTO dbo.MyTable(Content) VALUES(@Content)\";\n\nusing(SqlConnection connection = new SqlConnection(/*yout connection string here*/))\nusing(SqlCommand command = new SqlCommand(query, connection))\n{\n    connection.Open();\n    SqlParameter param = command.Parameters.Add(\"@Content\", SqlDbType.VarBinary);\n    param.Value = YourByteArrayVariableHere;\n\n    command.ExecuteNonQuery();  \n}\n</code></pre>\n\n<p>You could retrieve it by using a SqlDataReader to get data and than cast the result as byte array. This code gets only the first row. If you want to get more use <code>while (d.Read())</code> instead of the <code>if (d.Read())</code>.</p>\n\n<pre><code>string query = \"Select Content from dbo.MyTable\";\nusing(SqlConnection connection = new SqlConnection(/*your connection string here*/))\nusing(SqlCommand command = new SqlCommand(query, connection))\n{\n    connection.Open();\n    using (SqlDataReader d = command.ExecuteReader())\n    {\n        if (d.Read())\n        {\n            byte[] byteArray = (byte[])d[\"Content\"];\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9876, "user_id": 1667868, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/01faa51ea5dddd44aeeb572d4b45c835?s=128&d=identicon&r=PG&f=1", "display_name": "Sven van den Boogaart", "link": "https://stackoverflow.com/users/1667868/sven-van-den-boogaart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1922, "favorite_count": 0, "closed_date": 1454014986, "accepted_answer_id": 34911493, "answer_count": 1, "score": -6, "last_activity_date": 1453329224, "creation_date": 1453326915, "last_edit_date": 1453327482, "question_id": 34911372, "link": "https://stackoverflow.com/questions/34911372/c-put-a-byte-into-an-database-and-retrive-later", "closed_reason": "Not suitable for this site", "title": "c# put a byte[] into an database and retrive later", "body": "<p>In my c# wpf project I have a byte array which needs to be stored in a database and converted back to a bytearray. What is the right approach for storing byte arrays? My query looks like:</p>\n\n<pre><code>string query = \"UPDATE sometable SET file= @File  WHERE identifier =   @identifierwhere\";\n\nupsert = new SqlCommand(query, _connector.getMsConnection());\nupsert.Parameters.Add(new SqlParameter(\"@identifier\", v.UniqueIdentifier));\nupsert.Parameters.Add(new SqlParameter(\"@File  \", filestring\"\"));\n\nfilestring i made like:\n\nif (v.File != null)\n{\n    fileString = GetStringFromBytes(v.File);\n}\n</code></pre>\n\n<p>I use this function</p>\n\n<pre><code>static string GetStringFromBytes(byte[] bytes)\n{\n    char[] chars = new char[bytes.Length / sizeof(char)];\n    System.Buffer.BlockCopy(bytes, 0, chars, 0, bytes.Length);\n    return new string(chars);\n}\n</code></pre>\n\n<p>When i look in my database all i see is one letter 'A' when debbuging i see the value of filestring containse 'chinese?' characters. \nWhat is the right way to store and retrive a byte array?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 4, "creation_date": 1453327061, "post_id": 34911323, "comment_id": 57558405, "body": "The code you&#39;ve posted doesn&#39;t work - it doesn&#39;t compile. You can&#39;t declare a variable using <code>var</code> and initialize it with a value of <code>null</code>."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 5818303, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1a98531b84110ff40d98d16437e5e79?s=128&d=identicon&r=PG&f=1", "display_name": "netchi", "link": "https://stackoverflow.com/users/5818303/netchi"}, "edited": false, "score": 0, "creation_date": 1453327954, "post_id": 34911377, "comment_id": 57558884, "body": "thank you sir. I had to use the combine path as mentioned in the post above because there were a lot of files in that path."}], "tags": [], "owner": {"reputation": 887, "user_id": 867530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a677438c4dfa46842416f0f7755b78?s=128&d=identicon&r=PG", "display_name": "christophano", "link": "https://stackoverflow.com/users/867530/christophano"}, "is_accepted": false, "score": 3, "last_activity_date": 1453326937, "creation_date": 1453326937, "answer_id": 34911377, "question_id": 34911323, "link": "https://stackoverflow.com/questions/34911323/c-file-last-modified-time/34911377#34911377", "title": "C# File Last Modified time", "body": "<p>Yes, you can just pass the path to the file you're interested in to a <code>new FileInfo</code> object.</p>\n\n<pre><code>var fileInfo = new FileInfo(pathToFile);\nvar fileLastModified = fileInfo.LastWriteTime;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2633, "user_id": 283606, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e56c33d441fc4675d9d4fd0fc09002aa?s=128&d=identicon&r=PG", "display_name": "Aleksandr Ivanov", "link": "https://stackoverflow.com/users/283606/aleksandr-ivanov"}, "edited": false, "score": 0, "creation_date": 1453330233, "post_id": 34911382, "comment_id": 57559899, "body": "If this answer solved your problem please don&#39;t forget to accept it."}], "tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": false, "score": 10, "last_activity_date": 1453326952, "creation_date": 1453326952, "answer_id": 34911382, "question_id": 34911323, "link": "https://stackoverflow.com/questions/34911323/c-file-last-modified-time/34911382#34911382", "title": "C# File Last Modified time", "body": "<p>You don't have to search through a directory to get a <code>FileInfo</code> - <a href=\"https://msdn.microsoft.com/en-us/library/system.io.fileinfo.fileinfo\">you can construct one directly from the full path</a>. It sounds like you just need:</p>\n\n<pre><code>var fileInfo = new FileInfo(Path.Combine(folderPath, \"InputData.csv\"));\nvar lastModified = fileInfo.LastWriteTime;\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5818303, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a1a98531b84110ff40d98d16437e5e79?s=128&d=identicon&r=PG&f=1", "display_name": "netchi", "link": "https://stackoverflow.com/users/5818303/netchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1453326952, "creation_date": 1453326739, "last_edit_date": 1453326882, "question_id": 34911323, "link": "https://stackoverflow.com/questions/34911323/c-file-last-modified-time", "title": "C# File Last Modified time", "body": "<p>I am trying to get the last write time of a particular file. This is the code and it works:`</p>\n\n<pre><code>DirectoryInfo DR = new DirectoryInfo(folderPath);  \nFileInfo[] FR2 = DR.GetFiles(\"InputData.csv\");\nvar FileLastModified= null;\n\nforeach (FileInfo F1 in FR2)\n{\n    FileLastModified = F1.LastWriteTime;\n}\n</code></pre>\n\n<p>FileLastModified gives me the last write time and I am only interested to find the time of this InputData.csv file. The problem is I do not want to use a for loop and need the write time for just one particular file. Is there a better way to write this without the loop? </p>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 576, "user_id": 2221795, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Vdzh.jpg?s=128&g=1", "display_name": "bogza.anton", "link": "https://stackoverflow.com/users/2221795/bogza-anton"}, "edited": false, "score": 0, "creation_date": 1453326791, "post_id": 34911256, "comment_id": 57558248, "body": "Try DependencyProperty.Register(&quot;ScrollViewer&quot;, typeof(ScrollViewer), typeof(NexusCanvas), new FrameworkPropertyMetadata(null));"}], "answers": [{"comments": [{"owner": {"reputation": 4576, "user_id": 3156300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Oo88B.png?s=128&g=1", "display_name": "JokerMartini", "link": "https://stackoverflow.com/users/3156300/jokermartini"}, "edited": false, "score": 0, "creation_date": 1453326796, "post_id": 34911325, "comment_id": 57558250, "body": "do i still keep the bit above it? as well?"}, {"owner": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "reply_to_user": {"reputation": 4576, "user_id": 3156300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Oo88B.png?s=128&g=1", "display_name": "JokerMartini", "link": "https://stackoverflow.com/users/3156300/jokermartini"}, "edited": false, "score": 0, "creation_date": 1453326848, "post_id": 34911325, "comment_id": 57558281, "body": "Yes, you need everything."}, {"owner": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "reply_to_user": {"reputation": 4576, "user_id": 3156300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Oo88B.png?s=128&g=1", "display_name": "JokerMartini", "link": "https://stackoverflow.com/users/3156300/jokermartini"}, "edited": false, "score": 0, "creation_date": 1453327055, "post_id": 34911325, "comment_id": 57558402, "body": "Please mark it as answer then &lt;/endofshamelessreppursuit&gt; :)"}], "tags": [], "owner": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "is_accepted": true, "score": 1, "last_activity_date": 1453326827, "last_edit_date": 1453326827, "creation_date": 1453326748, "answer_id": 34911325, "question_id": 34911256, "link": "https://stackoverflow.com/questions/34911256/wpf-register-dependecy-of-another-control/34911325#34911325", "title": "wpf register dependecy of another control", "body": "<p>Use <code>NexusCanvas</code> in the <code>typeof</code> for the third parameter.</p>\n\n<pre><code>public class NexusCanvas : Canvas\n{\n    private Point? dragStartPoint = null;\n\n\n    // attempt to combine scrollview and canvas into one\n    public ScrollViewer ScrollViewer\n    {\n        get { return (ScrollViewer)GetValue(ScrollViewerProperty); }\n        set { SetValue(ScrollViewerProperty, value); }\n    }\n    public static readonly DependencyProperty ScrollViewerProperty =\n        DependencyProperty.Register(\"ScrollViewer\", typeof(ScrollViewer), typeof(NexusCanvas));\n}\n</code></pre>\n"}], "owner": {"reputation": 4576, "user_id": 3156300, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Oo88B.png?s=128&g=1", "display_name": "JokerMartini", "link": "https://stackoverflow.com/users/3156300/jokermartini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 34911325, "answer_count": 1, "score": -1, "last_activity_date": 1453326827, "creation_date": 1453326472, "question_id": 34911256, "link": "https://stackoverflow.com/questions/34911256/wpf-register-dependecy-of-another-control", "title": "wpf register dependecy of another control", "body": "<p>I have a canvas and I want to create a dependency property and set it to the scroll view which is the parent control of the canvas. I get a dependecy error </p>\n\n<blockquote>\n  <p>Exception thrown: 'System.Windows.Markup.XamlParseException' in PresentationFramework.dll</p>\n</blockquote>\n\n<p><strong>MainWindow.xaml</strong></p>\n\n<pre><code>&lt;Grid&gt;\n        &lt;ScrollViewer Name=\"NexusScrollViewer\"\n                                  Background=\"Transparent\"\n                                  HorizontalScrollBarVisibility=\"Auto\"\n                                  VerticalScrollBarVisibility=\"Auto\"&gt;\n            &lt;nexus:NexusCanvas x:Name=\"MyDesignerCanvas\"\n                                          MinHeight=\"800\"\n                                          MinWidth=\"800\"\n                                          AllowDrop=\"True\"\n                                          ScrollViewer=\"{Binding ElementName=NexusScrollViewer}\"\n                                          Background=\"#FF252629\"&gt;\n                &lt;Ellipse Canvas.Left=\"50\" Canvas.Top=\"200\" Fill=\"Red\" Width=\"100\" Height=\"100\"/&gt;\n                &lt;Ellipse Canvas.Left=\"200\" Canvas.Top=\"10\" Fill=\"LightBlue\" Width=\"100\" Height=\"100\"/&gt;\n            &lt;/nexus:NexusCanvas&gt;\n        &lt;/ScrollViewer&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p><strong>NexusCanvas.cs</strong></p>\n\n<pre><code>public class NexusCanvas : Canvas\n    {\n        private Point? dragStartPoint = null;\n\n\n        // attempt to combine scrollview and canvas into one\n        public ScrollViewer ScrollViewer\n        {\n            get { return (ScrollViewer)GetValue(ScrollViewerProperty); }\n            set { SetValue(ScrollViewerProperty, value); }\n        }\n        public static readonly DependencyProperty ScrollViewerProperty =\n            DependencyProperty.Register(\"ScrollViewer\", typeof(ScrollViewer), typeof(ScrollViewer));\n\n    }\n</code></pre>\n\n<p>Would i be better of just finding the parent of canvas when i create the control in the NexusCanvas.cs, if so how would i do that?</p>\n"}, {"tags": ["c#", "generics", "design-patterns", "reflection", "rtti"], "comments": [{"owner": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "edited": false, "score": 0, "creation_date": 1453327042, "post_id": 34911249, "comment_id": 57558399, "body": "Feel free to ask any questions if there is anything not clear. It is not a homework of some sort - just me having fun with C# but I really want to create good code."}, {"owner": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "edited": false, "score": 0, "creation_date": 1453327078, "post_id": 34911249, "comment_id": 57558416, "body": "Are you doing this as an exercise or you just need Mathematical matrix operations for something else?"}, {"owner": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "edited": false, "score": 0, "creation_date": 1453327262, "post_id": 34911249, "comment_id": 57558531, "body": "It seems to me like you could get this kind of functionality from some library around"}, {"owner": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "reply_to_user": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "edited": false, "score": 0, "creation_date": 1453327279, "post_id": 34911249, "comment_id": 57558543, "body": "I will probably create some LUP decompositions or calculating determinant in many ways or maybe even smith normal form but It always be only for fun not some serious calculations."}, {"owner": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "reply_to_user": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "edited": false, "score": 0, "creation_date": 1453328095, "post_id": 34911249, "comment_id": 57558958, "body": "@EduardoWada, I am trying to build one myself."}], "answers": [{"comments": [{"owner": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "edited": false, "score": 0, "creation_date": 1453327543, "post_id": 34911469, "comment_id": 57558676, "body": "I am very sorry, I forgot to add &lt;T&gt; in my code! Will your answer be the same after this modification?"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "edited": false, "score": 0, "creation_date": 1453328642, "post_id": 34911469, "comment_id": 57559228, "body": "@Malin No, it would not be the same. Here is the approach that I used successfully in a project where I needed to do something like yours. I used classes in place of lambdas, and avoided conditionals and casts."}, {"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "edited": false, "score": 0, "creation_date": 1453329418, "post_id": 34911469, "comment_id": 57559566, "body": "I wrote a very similar approach, but without the dictionary. Check it below."}, {"owner": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "edited": false, "score": 0, "creation_date": 1453369116, "post_id": 34911469, "comment_id": 57574015, "body": "Thank you @dasblinkenlight, this idea is briliant! It was exactly was I was looking for. Also : check my updated question I posted my code based on yours."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1453328524, "last_edit_date": 1453328524, "creation_date": 1453327260, "answer_id": 34911469, "question_id": 34911249, "link": "https://stackoverflow.com/questions/34911249/c-generic-operators-rtti-approach/34911469#34911469", "title": "C# generic operators - RTTI approach", "body": "<p>Yes, your approach will work fine.</p>\n\n<p>Your static constructor will run for each type parameter <code>T</code>, ensuring that <code>Add</code> is set correctly.</p>\n\n<p>You may want to separate out the addition logic into a separate class outside your matrix, and use that class to run operations based on type for your matrix. For example, if you also need multiplication, you could build a <code>ITypeTraits&lt;T&gt;</code> interface that has <code>Add</code> and <code>Multiply</code>:</p>\n\n<pre><code>public interface ITypeTraits&lt;T&gt; {\n    T Add(T a, T b);\n    T Mul(T a, T b);\n}\n</code></pre>\n\n<p>Now you can build implementations of <code>ITypeTraits&lt;T&gt;</code> for individual types, e.g.</p>\n\n<pre><code>public class IntTypeTraits : ITypeTraits&lt;int&gt; {\n    public int Add(int a, int b) { return a+b; }\n    public int Mul(int a, int b) { return a*b; }\n}\npublic class LongTypeTraits : ITypeTraits&lt;long&gt; {\n    public long Add(long a, long b) { return a+b; }\n    public long Mul(long a, long b) { return a*b; }\n}\n... // and so on\n</code></pre>\n\n<p>make a dictionary out of them</p>\n\n<pre><code>static readonly IDictionary&lt;Type,object&gt; traitByType = new Dictionary&lt;Type,object&gt; {\n    {typeof(int), new IntTypeTraits() }\n,   {typeof(long), new LongTypeTraits() }\n... // and so on\n};\n</code></pre>\n\n<p>and get the one you need to perform operations:</p>\n\n<pre><code>ITypeTraits&lt;T&gt; traits = (ITypeTraits&lt;T&gt;)traitByType(typeof(T));\nT first = ...\nT second = ...\nT sum = traits.Add(first, second);\nT prod = traits.Mul(first, second);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 1286900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ppzRc.jpg?s=128&g=1", "display_name": "Algemist", "link": "https://stackoverflow.com/users/1286900/algemist"}, "is_accepted": false, "score": 0, "last_activity_date": 1453328938, "creation_date": 1453328938, "answer_id": 34911863, "question_id": 34911249, "link": "https://stackoverflow.com/questions/34911249/c-generic-operators-rtti-approach/34911863#34911863", "title": "C# generic operators - RTTI approach", "body": "<p>What is wrong with #3?  You can just check for type, like so:</p>\n\n<pre><code>public abstract class Matrix&lt;T&gt;\n{\n    public static HashSet&lt;Type&gt; AllowAdd = new HashSet&lt;Type&gt;\n    {\n        typeof(int),\n        typeof(long),\n        typeof(string),\n        typeof(double),\n    };\n\n    public T Add&lt;T&gt;(T first, T second)\n    {\n        if(!AllowAdd.Contains(typeof(T)))\n        {\n            throw new Exception(string.Format(\"Cannot preform addition for type: {0}\", typeof(T).Name));\n        }\n\n        dynamic result = (dynamic)first + (dynamic)second;\n        return (T)result;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "edited": false, "score": 0, "creation_date": 1453329939, "post_id": 34911964, "comment_id": 57559789, "body": "He mentions building a library, a library&#39;s user would be required to change MatrixBase&#39;s implementation in order to use this code on his custom class that contains the + operator"}, {"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "reply_to_user": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "edited": false, "score": 0, "creation_date": 1453330431, "post_id": 34911964, "comment_id": 57560009, "body": "@EduardoWada - Well, he can add an extension point where the user of the library can supply these functions. Also, if he can figure out a way to generate these functions, that too can be incorporated."}], "tags": [], "owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "is_accepted": false, "score": 0, "last_activity_date": 1453329638, "last_edit_date": 1495542228, "creation_date": 1453329302, "answer_id": 34911964, "question_id": 34911249, "link": "https://stackoverflow.com/questions/34911249/c-generic-operators-rtti-approach/34911964#34911964", "title": "C# generic operators - RTTI approach", "body": "<p>Bulding on <a href=\"https://stackoverflow.com/a/34911469/41360\">dasblinkenlight's answer</a>, here's my version of it. The benefit is that it doesn't need a dictionary lookup, instead making the type system do it. Should be faster, I think, but I haven't measured it. Also a bit less typing.</p>\n\n<pre><code>public abstract class MatrixBase\n{\n    protected static class OperationDict&lt;T&gt;\n    {\n        private static Func&lt;T,T,T&gt; _notSupported = (a, b) =&gt; { throw new NotSupportedException(string.Format(\"Type {0} not supported for Matrix operations!\", typeof(T))); };\n\n        public static Func&lt;T, T, T&gt; Add = _notSupported;\n        public static Func&lt;T, T, T&gt; Multiply = _notSupported;\n    }\n\n    static MatrixBase()\n    {\n        OperationDict&lt;int&gt;.Add = (a, b) =&gt; a + b;\n        OperationDict&lt;int&gt;.Multiply = (a, b) =&gt; a * b;\n\n        OperationDict&lt;decimal&gt;.Add = (a, b) =&gt; a + b;\n        OperationDict&lt;decimal&gt;.Multiply = (a, b) =&gt; a * b;\n\n        // Etc. for all supported types\n\n    }\n}\npublic class Matrix&lt;T&gt; : MatrixBase\n{\n    public T DoAdd(T a, T b)\n    {\n        return OperationDict&lt;T&gt;.Add(a, b);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2344, "user_id": 1102585, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/773c7057e6c2b7c20d4d245e9d49379f?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo Wada", "link": "https://stackoverflow.com/users/1102585/eduardo-wada"}, "is_accepted": false, "score": 0, "last_activity_date": 1453329794, "last_edit_date": 1495541271, "creation_date": 1453329794, "answer_id": 34912048, "question_id": 34911249, "link": "https://stackoverflow.com/questions/34911249/c-generic-operators-rtti-approach/34912048#34912048", "title": "C# generic operators - RTTI approach", "body": "<p>I think you are on the right path, in order to avoid using reflection, you are required to somehow inform the compiler that you know \"T\" has the \"+\" operator, however, <a href=\"https://stackoverflow.com/questions/5997107/is-there-a-generic-constraint-i-could-use-for-the-operator\">this feature does not yet exist</a> in C#, so this is impossible to implement without runtime type checking or imposing other constraints.</p>\n\n<p>If you don't care about the performance, you could use <code>dynamic</code>:</p>\n\n<pre><code>(dynamic)first + (dynamic)second\n</code></pre>\n\n<p>but that will take several reflection performance hits in every operation</p>\n\n<p>Or you could use some other more complex approach that caches the specific methods in a dictionary, but you won't escape calling at least <code>.GetType()</code> in your <code>add</code>'s implementation</p>\n"}], "owner": {"reputation": 1179, "user_id": 3809977, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/164cc62813a536bd716a34ff6fe0e777?s=128&d=identicon&r=PG&f=1", "display_name": "MaLiN2223", "link": "https://stackoverflow.com/users/3809977/malin2223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "accepted_answer_id": 34911469, "answer_count": 4, "score": 1, "last_activity_date": 1453369417, "creation_date": 1453326436, "last_edit_date": 1453369417, "question_id": 34911249, "link": "https://stackoverflow.com/questions/34911249/c-generic-operators-rtti-approach", "title": "C# generic operators - RTTI approach", "body": "<p>I intend to ask about generic operator+ overloading but not in typical \"can I do operator+ for generic type\" way.</p>\n\n<p><strong>Questions are on the bottom</strong></p>\n\n<p>I recently started to create matrix class in C# and after a while It came to me that I cannot do simple T + T !</p>\n\n<p>Thus, I googled and googled and found several workarounds.</p>\n\n<ol>\n<li>Create Expression <a href=\"http://www.yoda.arachsys.com/csharp/genericoperators.html\" rel=\"nofollow\">link</a></li>\n<li>Create abstract class <code>abstract class Matrix&lt;T&gt;{//some code}</code>. Create 'protected virtual method Add(T itemToAdd)'  and then create\noperator like this : <code>T operator+(T item1, T item2){return item1.Add(item2);}</code>(most posts on stack) and then inherit this method in <code>class Matrix : Matrix&lt;int&gt;</code>  <a href=\"https://github.com/mathnet/mathnet-numerics/tree/master/src/Numerics/LinearAlgebra\" rel=\"nofollow\">here</a></li>\n<li>Use method Add such as : <code>T Add(T first, T second){ dynamic output = first + second; return output;}</code> (somewhere on stack)</li>\n</ol>\n\n<p>First one just does not suited me so I tried second one but then I run onto serious problems like: </p>\n\n<ol>\n<li>(A LOT of )repetative code - I created 4 classes for : int, double, long, Complex - my own type</li>\n<li>Creating multiple extension methods and so on.</li>\n</ol>\n\n<p>Third one is just so unsafe that I rejected it immidietlay.</p>\n\n<p>After my struggling I came to realise : 'Why don't I use RTTI and reflection?' I know, it is expensive in running time but why not use static constructor to do this?</p>\n\n<p>Here is my idea (pseudocode): </p>\n\n<pre><code>class Matrix&lt;T&gt;{\n   static Func&lt;T,T,T&gt; Add;\n   static Matrix\n   {\n     if(T is int) \n        Add = (first,second) = &gt; ((int)first)+((int)second);\n     else if(T is long) \n        Add = (first,second) = &gt; ((long)first)+((long)second);\n   // and so on for built-in types\n   else\n   { // T is not built-in type\n     if(typeof(T).GetMethods().Contains(\"op_Addition\"))\n     {\n       Add = (first,second) =&gt; typeof(T).getMethod(\"op_Addition\").invoke(first,second);\n     } \n   }\n}\n</code></pre>\n\n<p>I know that reflection is costly but it will do it only one time (per type)!\nAnd before you start argue : I am going to code <code>T is int</code> like this :</p>\n\n<pre><code>var type = typeof(T);\nif(type==typeof(int)) // code\n</code></pre>\n\n<p>I am aware that I cannot explicitly convert T to int but there must be some sort of 'work around'. Problem is that (for example) Int32 has not explicit 'method' for operator+ hence, reflection is not of much use.</p>\n\n<p>After all that introduction I have two questions : </p>\n\n<ol>\n<li>Is it a good approach or do you see major flaws in it?</li>\n<li>Is it doable? I don't want to start creating code without knowing for sure that my lambda function WILL work.</li>\n</ol>\n\n<p><strong>EDIT 1+2</strong>\nI changed my code to generic.\nI figured that maybe you need an usage of my class, here you are : </p>\n\n<pre><code>Matrix&lt;int&gt; matrix = new Matrix(1,1); // creates int-based matrix\nMatrix&lt;MyClass&gt; matrix2 = new Matrix(1,1); // creates some other type matrix\n</code></pre>\n\n<p><strong>ANSWER</strong>\nbased on dasblinkenlight's answer I managed to do this : </p>\n\n<pre><code> public interface ITypeTratis&lt;T&gt;\n    {\n        T Add(T a, T b);\n        T Mul(T a, T b);\n        T Sub(T a, T b);\n        T Div(T a, T b);\n        bool Eq(T a, T b);\n    }\n\n    public class IntTypeTratis : ITypeTratis&lt;int&gt;\n    {\n        //code for int\n    }\n    public class DoubleTypeTratis : ITypeTratis&lt;double&gt;\n    {\n       //code for double\n    }\ninternal class TypeTraits&lt;T&gt; : ITypeTratis&lt;T&gt;\n{\n    public Func&lt;T, T, T&gt; AddF;\n    public Func&lt;T, T, T&gt; MulF;\n    public Func&lt;T, T, T&gt; DivF;\n    public Func&lt;T, T, T&gt; SubF;\n    public Func&lt;T, T, bool&gt; EqF;\n    public T Add(T a, T b) =&gt; AddF(a, b);\n\n    public bool Eq(T a, T b) =&gt; EqF(a, b);\n\n    public T Mul(T a, T b) =&gt; MulF(a, b);\n\n    public T Sub(T a, T b) =&gt; SubF(a, b);\n\n    public T Div(T a, T b) =&gt; DivF(a, b);\n}\npublic class Matrix&lt;T&gt;\n    { \n        private static IDictionary&lt;Type, object&gt; traitByType = new Dictionary&lt;Type, object&gt;()\n        {\n            {typeof (int), new IntTypeTratis()},\n            {typeof (double), new DoubleTypeTratis()}\n        };\n        static Matrix()\n        {\n            Debug.WriteLine(\"Robie konstruktor dla \" + typeof(T));\n            var type = typeof(T);\n            if (!traitByType.ContainsKey(type))\n            {\n                MethodInfo add, sub, mul, div, eq;\n                if ((add = type.GetMethod(\"op_Addition\")) == null)\n                    throw new NotSupportedException(\"Addition is not implemented\");\n                if ((sub = type.GetMethod(\"op_Subtraction\")) == null)\n                    throw new NotSupportedException(\"Substraction is not implemented\");\n                if ((mul = type.GetMethod(\"op_Multiply\")) == null)\n                    throw new NotSupportedException(\"Multiply is not implemented\");\n                if ((div = type.GetMethod(\"op_Division\")) == null)\n                    throw new NotSupportedException(\"Division is not implemented\");\n                if ((eq = type.GetMethod(\"op_Equality\")) == null)\n                    throw new NotSupportedException(\"Equality is not implemented\");\n                var obj = new TypeTraits&lt;T&gt;\n                {\n                    AddF = (a, b) =&gt; (T)add.Invoke(null, new object[] { a, b }),\n                    SubF = (a, b) =&gt; (T)sub.Invoke(null, new object[] { a, b }),\n                    MulF = (a, b) =&gt; (T)mul.Invoke(null, new object[] { a, b }),\n                    DivF = (a, b) =&gt; (T)div.Invoke(null, new object[] { a, b }),\n                    EqF = (a, b) =&gt; (bool)eq.Invoke(null, new object[] { a, b })\n                }; \n                traitByType[type] = obj;\n\n            }\n        }\n}\n</code></pre>\n\n<p>And this is exactly what I was looking for.</p>\n"}, {"tags": ["c#", "sql"], "comments": [{"owner": {"reputation": 101, "user_id": 5604944, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7fccc99b55460a1b70a0e1e4c9b4be69?s=128&d=identicon&r=PG&f=1", "display_name": "ImDeveloping", "link": "https://stackoverflow.com/users/5604944/imdeveloping"}, "edited": false, "score": 0, "creation_date": 1453326889, "post_id": 34911220, "comment_id": 57558305, "body": "close it right after you execute the first one then re open it :)"}], "answers": [{"comments": [{"owner": {"reputation": 334, "user_id": 4668193, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/37da9945602522cb1cd758354248afd9?s=128&d=identicon&r=PG&f=1", "display_name": "maltman", "link": "https://stackoverflow.com/users/4668193/maltman"}, "edited": false, "score": 0, "creation_date": 1453326644, "post_id": 34911274, "comment_id": 57558185, "body": "Sorry that is one of the things I tried.  Here is the error when I execute  An unhandled exception of type &#39;System.InvalidOperationException&#39; occurred in System.Data.dll  Additional information: There is already an open DataReader associated with this Command which must be closed first."}, {"owner": {"reputation": 32697, "user_id": 34208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98600a959a58d3bd851c12fec2e1f88?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/34208/david"}, "reply_to_user": {"reputation": 334, "user_id": 4668193, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/37da9945602522cb1cd758354248afd9?s=128&d=identicon&r=PG&f=1", "display_name": "maltman", "link": "https://stackoverflow.com/users/4668193/maltman"}, "edited": false, "score": 0, "creation_date": 1453326860, "post_id": 34911274, "comment_id": 57558290, "body": "That&#39;s the error you need to fix.  You need to create a 2nd connection object since you are using your existing connection to loop through the list of servers."}, {"owner": {"reputation": 334, "user_id": 4668193, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/37da9945602522cb1cd758354248afd9?s=128&d=identicon&r=PG&f=1", "display_name": "maltman", "link": "https://stackoverflow.com/users/4668193/maltman"}, "edited": false, "score": 0, "creation_date": 1453386778, "post_id": 34911274, "comment_id": 57586449, "body": "Thank you.  Adding the second SQL connection fixed the issue."}], "tags": [], "owner": {"reputation": 32697, "user_id": 34208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98600a959a58d3bd851c12fec2e1f88?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/34208/david"}, "is_accepted": true, "score": 3, "last_activity_date": 1453327032, "last_edit_date": 1453327032, "creation_date": 1453326545, "answer_id": 34911274, "question_id": 34911220, "link": "https://stackoverflow.com/questions/34911220/programmatically-get-windows-services-and-write-to-sql/34911274#34911274", "title": "Programmatically get Windows Services and write to SQL", "body": "<p>You never execute your SqlCommand.  After you add your parameters, try adding <code>cmd.ExecuteNonQuery();</code></p>\n\n<p>The 2nd problem is that you are trying to reuse the same SqlConnection.  You'll need to create a new SqlConnection since you are using your existing connection to loop through the list of servers.</p>\n"}, {"tags": [], "owner": {"reputation": 44, "user_id": 5322573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae156bb1fd44d464ad9d7950dc2d9ef4?s=128&d=identicon&r=PG&f=1", "display_name": "wi_marti", "link": "https://stackoverflow.com/users/5322573/wi-marti"}, "is_accepted": false, "score": 1, "last_activity_date": 1453326660, "creation_date": 1453326660, "answer_id": 34911307, "question_id": 34911220, "link": "https://stackoverflow.com/questions/34911220/programmatically-get-windows-services-and-write-to-sql/34911307#34911307", "title": "Programmatically get Windows Services and write to SQL", "body": "<p>You've built up the Command object (cmd), now you just need to save it, like <code>cmd.ExecuteNonQuery();</code></p>\n"}, {"tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": false, "score": 1, "last_activity_date": 1453327311, "last_edit_date": 1453327311, "creation_date": 1453326905, "answer_id": 34911368, "question_id": 34911220, "link": "https://stackoverflow.com/questions/34911220/programmatically-get-windows-services-and-write-to-sql/34911368#34911368", "title": "Programmatically get Windows Services and write to SQL", "body": "<p>First this you need to change the stored procedure declaration as </p>\n\n<pre><code>ALTER PROCEDURE [dbo].[sp_InsertServices]\n    @Display    nvarchar(50),\n    @Service    nvarchar(50),\n    @Status     nvarchar(50),\n    @Server     nvarchar(50)\n\nAS\nBEGIN\n\n    SET NOCOUNT ON\n\n    INSERT INTO Services\n    (DisplayName, ServiceName, Status, Server)\n    VALUES\n    (@Display,@Service,@Status,@Server)\n\n    SELECT SCOPE_IDENTITY()\n\nEND\n</code></pre>\n\n<p>And now change the calling code to </p>\n\n<pre><code>using (SqlCommand cmd = new SqlCommand(\"sp_InsertServices\", conn))\n{\n    cmd.CommandType = System.Data.CommandType.StoredProcedure;\n    cmd.Parameters.AddWithValue(\"@Display\", service.DisplayName);\n    cmd.Parameters.AddWithValue(\"@Service\", service.ServiceName);\n    cmd.Parameters.AddWithValue(\"@Status\", service.Status);\n    cmd.Parameters.AddWithValue(\"@Server\", serverName);\n\n    int serviceID = (int)cmd.ExecuteScalar();\n\n    // What you want to do with the ID returned?\n\n\n}\n</code></pre>\n\n<p>The ID parameter is not needed if your ID field is an IDENTITY column, it is automatically calculated by the database and you could return it using a simple select. If your stored procedure ends with a SELECT SCOPE_IDENTITY() the result can be retrieved on the C# code using a simple ExecuteScalar without the need of an output parameter. </p>\n\n<p>Finally, if you try to ExecuteXXX an SqlCommand using the same connection in use by a SqlDataReader you get an exception because the connection is busy serving the SqlDataReader and cannot execute the command.   </p>\n\n<p>The simple solution is to add this to your connection string</p>\n\n<pre><code>  ....;MultipleActiveResultSets=True;....\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/cfa084cz(v=vs.110).aspx\" rel=\"nofollow\">See MSDN for MultipleActiveResultSets</a></p>\n"}], "owner": {"reputation": 334, "user_id": 4668193, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/37da9945602522cb1cd758354248afd9?s=128&d=identicon&r=PG&f=1", "display_name": "maltman", "link": "https://stackoverflow.com/users/4668193/maltman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 1, "accepted_answer_id": 34911274, "answer_count": 3, "score": 1, "last_activity_date": 1453327311, "creation_date": 1453326351, "last_edit_date": 1453326851, "question_id": 34911220, "link": "https://stackoverflow.com/questions/34911220/programmatically-get-windows-services-and-write-to-sql", "title": "Programmatically get Windows Services and write to SQL", "body": "<p>I am trying to query services on a remote server and insert them into SQL.  I know I am missing something that will actually write this back but I cannot figure out what it is.  Everything works until I try to write the data to SQL.</p>\n\n<pre><code>static void Main(string[] args)\n{\n    string username = ConfigurationManager.AppSettings[\"UserName\"].ToString();\n    string password = ConfigurationManager.AppSettings[\"Password\"].ToString();\n    string domain = ConfigurationManager.AppSettings[\"Domain\"].ToString();\n    var logonType = SimpleImpersonation.LogonType.NewCredentials;\n\n    using (SimpleImpersonation.Impersonation.LogonUser(domain, username, password, logonType))\n    {\n        var connection = ConfigurationManager.ConnectionStrings[\"Connection\"].ConnectionString;\n\n        using (SqlConnection conn = new SqlConnection(connection))\n        {\n            conn.Open();\n            using (SqlCommand command = new SqlCommand(\"SELECT ServerName, ServerIP FROM Server\", conn))\n            {\n                SqlDataReader reader = command.ExecuteReader();\n\n                while (reader.Read())\n                {\n                    string serverIP = reader[\"ServerIP\"].ToString();\n                    string serverName = reader[\"ServerName\"].ToString();\n\n                    ServiceController[] services = ServiceController.GetServices(serverIP);\n\n                    foreach (ServiceController service in services)\n                    {\n                        using (SqlCommand cmd = new SqlCommand(\"sp_InsertServices\", conn))\n                        {\n                            cmd.CommandType = System.Data.CommandType.StoredProcedure;\n                            SqlParameter ID = new SqlParameter();\n                            ID.ParameterName = \"@ID\";\n                            ID.Direction = System.Data.ParameterDirection.Output;\n                            cmd.Parameters.AddWithValue(\"@ID\", ID);\n                            cmd.Parameters.AddWithValue(\"@Display\", service.DisplayName);\n                            cmd.Parameters.AddWithValue(\"@Service\", service.ServiceName);\n                            cmd.Parameters.AddWithValue(\"@Status\", service.Status);\n                            cmd.Parameters.AddWithValue(\"@Server\", serverName);\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Here is the Stored Proc</p>\n\n<pre><code>PROCEDURE [dbo].[sp_InsertServices]\n@ID         int,\n@Display    nvarchar(50),\n@Service    nvarchar(50),\n@Status     nvarchar(50),\n@Server     nvarchar(50)\n\nAS\nBEGIN\n\nSET NOCOUNT ON\n\nINSERT INTO Services\n(ID,\nDisplayName,\nServiceName,\nStatus,\nServer)\n\nVALUES\n(@ID,\n@Display,\n@Service,\n@Status,\n@Server)\n\nSET @ID = SCOPE_IDENTITY()\n\nEND\n</code></pre>\n\n<p>EDIT: Sorry some more info.  I have added an execute at the end after the param adds and I get this error.</p>\n\n<p>An unhandled exception of type 'System.InvalidOperationException' occurred in System.Data.dll</p>\n\n<p>Additional information: There is already an open DataReader associated with this Command which must be closed first.</p>\n\n<p>Looks like I need to close the first reader but I still use it in the second command.  Don't now where I can safely close it.</p>\n"}, {"tags": ["c#", "wix", "windows-installer"], "answers": [{"comments": [{"owner": {"reputation": 4988, "user_id": 1208289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97c181541960937621a547a4287d0362?s=128&d=identicon&r=PG", "display_name": "Brannon", "link": "https://stackoverflow.com/users/1208289/brannon"}, "edited": false, "score": 0, "creation_date": 1453412714, "post_id": 34934666, "comment_id": 57602557, "body": "fileVersion succeeds, but that&#39;s not the version number that I want. My <code>AssemblyVersion</code> is different than my <code>AssemblyFileVersion</code>, and fileVersion returns the former. My assemblies all define both attributes."}, {"owner": {"reputation": 1748, "user_id": 5437411, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6o2bS.jpg?s=128&g=1", "display_name": "Arkady Sitnitsky", "link": "https://stackoverflow.com/users/5437411/arkady-sitnitsky"}, "reply_to_user": {"reputation": 4988, "user_id": 1208289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97c181541960937621a547a4287d0362?s=128&d=identicon&r=PG", "display_name": "Brannon", "link": "https://stackoverflow.com/users/1208289/brannon"}, "edited": false, "score": 0, "creation_date": 1453417563, "post_id": 34934666, "comment_id": 57604771, "body": "set File/@Assembly to &quot;.net&quot; or &quot;win32&quot;, then for the same file set File/@AssemblyApplication to the value for File/@Id."}, {"owner": {"reputation": 1748, "user_id": 5437411, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6o2bS.jpg?s=128&g=1", "display_name": "Arkady Sitnitsky", "link": "https://stackoverflow.com/users/5437411/arkady-sitnitsky"}, "reply_to_user": {"reputation": 4988, "user_id": 1208289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97c181541960937621a547a4287d0362?s=128&d=identicon&r=PG", "display_name": "Brannon", "link": "https://stackoverflow.com/users/1208289/brannon"}, "edited": false, "score": 0, "creation_date": 1453417598, "post_id": 34934666, "comment_id": 57604789, "body": "Got it from <a href=\"http://blogs.msdn.com/b/heaths/archive/2008/02/08/get-binder-variables-for-assemblies-without-installing-into-the-gac.aspx\" rel=\"nofollow noreferrer\">blogs.msdn.com/b/heaths/archive/2008/02/08/&hellip;</a>"}, {"owner": {"reputation": 4988, "user_id": 1208289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97c181541960937621a547a4287d0362?s=128&d=identicon&r=PG", "display_name": "Brannon", "link": "https://stackoverflow.com/users/1208289/brannon"}, "edited": false, "score": 2, "creation_date": 1454025995, "post_id": 34934666, "comment_id": 57872040, "body": "To be clear, I was never able to make <code>assemblyFileVersion</code> work. <code>fileVersion</code> did start working for me after I got <code>Assembly=&quot;.net&quot;</code> added to my main executable <code>File</code> declaration."}], "tags": [], "owner": {"reputation": 1748, "user_id": 5437411, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6o2bS.jpg?s=128&g=1", "display_name": "Arkady Sitnitsky", "link": "https://stackoverflow.com/users/5437411/arkady-sitnitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1453411590, "creation_date": 1453411590, "answer_id": 34934666, "question_id": 34911178, "link": "https://stackoverflow.com/questions/34911178/unable-to-get-assemblyfilebinding-to-compile/34934666#34934666", "title": "Unable to get assemblyFileBinding to compile", "body": "<p>Try to use !(bind.fileVersion.filMobiusExe).</p>\n"}], "owner": {"reputation": 4988, "user_id": 1208289, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/97c181541960937621a547a4287d0362?s=128&d=identicon&r=PG", "display_name": "Brannon", "link": "https://stackoverflow.com/users/1208289/brannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "accepted_answer_id": 34934666, "answer_count": 1, "score": 2, "last_activity_date": 1549908836, "creation_date": 1453326177, "question_id": 34911178, "link": "https://stackoverflow.com/questions/34911178/unable-to-get-assemblyfilebinding-to-compile", "title": "Unable to get assemblyFileBinding to compile", "body": "<p>I'm attempting to use the AssemblyFileVersion binding (as seen in the full WSX below). I always get this compilation error:</p>\n\n<blockquote>\n  <p>error LGHT0298: Unresolved bind-time variable\n  !(bind.assemblyFileVersion.filMobiusExe)</p>\n</blockquote>\n\n<p>Can you see something wrong? I've declared my referenced <code>filMobiusExe</code> as a .net assembly, which it is. Do I need to use some additional command line switch or extension? I'm using 3.10.2.2516. I use Heat to generate the AsiWix_Generated ComponentGroup.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;Wix xmlns=\"http://schemas.microsoft.com/wix/2006/wi\"\n         xmlns:util=\"http://schemas.microsoft.com/wix/UtilExtension\"&gt;\n\n    &lt;Product\n        Id=\"...\"\n        Name=\"MyStuff\"\n        Language=\"1033\"\n        Version=\"!(bind.assemblyFileVersion.filMobiusExe)\"\n        Manufacturer=\"Autonomous Solutions, Inc.\"\n        UpgradeCode=\"...\"&gt;\n\n        &lt;Package Id=\"*\"\n         InstallerVersion=\"200\"\n         Compressed=\"yes\"\n         InstallScope=\"perMachine\"\n         Description=\"My Stuff\"/&gt;\n        &lt;Property Id=\"TARGETSERVERADDRESS\" Value=\"http://localhost:18080/\"/&gt;\n\n        &lt;MediaTemplate EmbedCab=\"yes\" CompressionLevel=\"high\" MaximumUncompressedMediaSize=\"10000\"/&gt;\n\n        &lt;Property Id=\"ARPNOREPAIR\" Value=\"yes\" Secure=\"yes\" /&gt;\n        &lt;Property Id=\"ARPNOMODIFY\" Value=\"yes\" Secure=\"yes\" /&gt;\n        &lt;Property Id=\"MSIFASTINSTALL\" Value=\"1\" /&gt;&lt;!-- disable restore point creation --&gt;\n\n        &lt;Directory Id=\"TARGETDIR\" Name=\"SourceDir\"&gt;\n            &lt;Directory Id=\"ProgramMenuFolder\"&gt;\n                &lt;Directory Id=\"ProgramMenuDirAsiRoot\" Name=\"ASI\"&gt;\n                    &lt;Directory Id=\"ProgramMenuDirAsi\" Name=\"Mobius\"&gt;\n                    &lt;/Directory&gt;\n                &lt;/Directory&gt;\n            &lt;/Directory&gt;\n\n            &lt;Directory Id=\"ProgramFilesFolder\"&gt;\n                &lt;Directory Id=\"INSTALLDIRROOT\" Name=\"ASI\"&gt;\n                    &lt;Directory Id=\"INSTALLDIR\" Name=\"Mobius\"&gt;\n                        &lt;Component Id=\"cmpMobiusExe\" Guid=\"*\"&gt;\n                            &lt;File Id=\"filMobiusExe\" KeyPath=\"yes\" Source=\"$(var.AsiWixSourceDir)\\Mobius.exe\" Vital=\"yes\" Assembly=\".net\"\n                                    AssemblyApplication=\"filMobiusExe\" ProcessorArchitecture=\"msil\"&gt;\n                                &lt;Shortcut Id=\"ApplicationStartMenuShortcut\" Name=\"Mobius\" Description=\"Client\" WorkingDirectory=\"INSTALLDIR\" Advertise=\"yes\" Directory=\"ProgramMenuDirAsi\" /&gt;\n                            &lt;/File&gt;\n                            &lt;File Id=\"filMobiusConfig\" Source=\"$(var.AsiWixSourceDir)\\Mobius.exe.config\" /&gt;\n                        &lt;/Component&gt;\n                    &lt;/Directory&gt;\n                &lt;/Directory&gt;\n            &lt;/Directory&gt;\n        &lt;/Directory&gt;\n\n        &lt;Component Id=\"SetConfigToServerAddress\" Guid=\"...\" KeyPath=\"yes\" Directory=\"INSTALLDIR\"&gt;\n            &lt;Condition&gt;TARGETSERVERADDRESS&lt;/Condition&gt;\n            &lt;util:XmlFile Id=\"AppConfigSetServerAddress\" Action=\"setValue\" Permanent=\"yes\"\n                        File=\"#filMobiusConfig\" Name=\"value\"\n                        ElementPath=\"/configuration/appSettings/add[\\[]@key='ServerAddress'[\\]]\"\n                        Value=\"[TARGETSERVERADDRESS]\" /&gt;\n        &lt;/Component&gt;\n\n        &lt;Component Id=\"SetConfigToServerExe\" Guid=\"...\" KeyPath=\"yes\" Directory=\"INSTALLDIR\"&gt;\n            &lt;Condition&gt;TARGETSERVEREXE&lt;/Condition&gt;\n            &lt;util:XmlFile Id=\"AppConfigSetServerExecutable\" Action=\"setValue\" Permanent=\"yes\"\n                        File=\"#filMobiusConfig\" Name=\"value\"\n                        ElementPath=\"/configuration/appSettings/add[\\[]@key='ServerPath'[\\]]\"\n                        Value=\"[TARGETSERVEREXE]\" /&gt;\n        &lt;/Component&gt;\n\n        &lt;Feature Id=\"ProductFeature\" Title=\"Mobius.Setup\" Level=\"1\"&gt;\n            &lt;ComponentRef Id=\"cmpMobiusExe\"/&gt;\n            &lt;ComponentGroupRef Id=\"AsiWix_Generated\"/&gt;\n            &lt;ComponentRef Id=\"SetConfigToServerAddress\"/&gt;\n            &lt;ComponentRef Id=\"SetConfigToServerExe\"/&gt;\n        &lt;/Feature&gt;\n\n        &lt;SetProperty Id=\"ARPINSTALLLOCATION\" Value=\"[INSTALLDIR]\" After=\"CostFinalize\" /&gt;\n    &lt;/Product&gt;\n\n&lt;/Wix&gt;\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "reflection", "system.reflection"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5198404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1oyz.jpg?s=128&g=1", "display_name": "Didier Vera", "link": "https://stackoverflow.com/users/5198404/didier-vera"}, "edited": false, "score": 0, "creation_date": 1453394965, "post_id": 34913715, "comment_id": 57592251, "body": "that wouldnt work becuase I cant make a typeof(mydinamobject).  public ActionResult Index()         {             IMyInterface myObject = (IMyInterface)ObjectBuilder.CreateOurNewObject();                          ViewBag.Rule = RuleModel.Create(typeof(IMyInterface));             return View();         }"}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "reply_to_user": {"reputation": 91, "user_id": 5198404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1oyz.jpg?s=128&g=1", "display_name": "Didier Vera", "link": "https://stackoverflow.com/users/5198404/didier-vera"}, "edited": false, "score": 0, "creation_date": 1453410973, "post_id": 34913715, "comment_id": 57601645, "body": "@Didier Could you update your original post with the code you&#39;re trying to write, and provide the error you&#39;re getting from the compiler? I&#39;m not sure where you&#39;re trying to create a <code>typeof(mydinamobject)</code>?  If my previous post was misleading, <code>IMyInterface</code> isn&#39;t a real interface, just a placeholder."}, {"owner": {"reputation": 91, "user_id": 5198404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1oyz.jpg?s=128&g=1", "display_name": "Didier Vera", "link": "https://stackoverflow.com/users/5198404/didier-vera"}, "edited": false, "score": 0, "creation_date": 1453411398, "post_id": 34913715, "comment_id": 57601908, "body": "please check this question here <a href=\"http://stackoverflow.com/questions/34929745/could-not-find-or-load-assembly-tmpassembly\" title=\"could not find or load assembly tmpassembly\">stackoverflow.com/questions/34929745/&hellip;</a> its the updated code"}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "reply_to_user": {"reputation": 91, "user_id": 5198404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1oyz.jpg?s=128&g=1", "display_name": "Didier Vera", "link": "https://stackoverflow.com/users/5198404/didier-vera"}, "edited": false, "score": 0, "creation_date": 1453411494, "post_id": 34913715, "comment_id": 57601961, "body": "Okay, that looks like a separate problem. Did my original answer help you?"}], "tags": [], "owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "is_accepted": false, "score": 1, "last_activity_date": 1453339023, "creation_date": 1453339023, "answer_id": 34913715, "question_id": 34911152, "link": "https://stackoverflow.com/questions/34911152/how-to-use-a-dynamically-generated-object-as-the-data-source-of-codeeffects-gene/34913715#34913715", "title": "How to use a dynamically generated object as the data source of CodeEffects generator", "body": "<p>Using your <code>TypeBuilder</code>, you might try tacking on an existing or custom interface to your generated type and then using that as your type.</p>\n\n<pre><code>typeBuilder.AddInterfaceImplementation(typeof(IMyInterface));\n</code></pre>\n\n<p>Now the object you've created (in the above example) has type <code>IMyInterface</code>, which you could then use in your <code>Index</code> action:</p>\n\n<pre><code>ViewBag.Rule = RuleModel.Create(typeof(IMyInterface));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1751, "user_id": 75826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23ec08b506cd9e3d93bc509914df8dd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ruslan", "link": "https://stackoverflow.com/users/75826/ruslan"}, "is_accepted": false, "score": 2, "last_activity_date": 1453512909, "creation_date": 1453512909, "answer_id": 34958616, "question_id": 34911152, "link": "https://stackoverflow.com/questions/34911152/how-to-use-a-dynamically-generated-object-as-the-data-source-of-codeeffects-gene/34958616#34958616", "title": "How to use a dynamically generated object as the data source of CodeEffects generator", "body": "<p>Extract a portion from the CreateOurNewObject() method that deals with a type creation. Call it <strong>CreateType</strong>(string xml).</p>\n\n<p>Change the AssemlbyBuilderAccess.Run to AssemblyBuilderAccess.RunAndSave. Then, once the type has been created, call the assemblyBuilder.Save() method. Save it in the location that Assembly.Load will find (e.g. bin or one of .net temp folders), or any other place so long it in the search path.</p>\n\n<p>Use it to create the type and to instantiate objects.</p>\n\n<p>Then, in the index, call</p>\n\n<pre><code>Type myType = CreateType(xml);\nRuleModel.Create(myType);\n</code></pre>\n\n<p>If you are doing evaluation outside make sure to use the same type (don't regenerate it every time). Which means you will need to load it first.</p>\n\n<pre><code>Type myType = Assembly.Load(assemblyName);\nobject myObject = Activator.CreateInstance(myType);\n//...populate myObject with necessary values based on your xml\nEvaluator ev = new Evaluator(myType, rule);\nbool result = ev.Evaluate(myObject);\n</code></pre>\n\n<p>or you could use DynamicEvaluator, which simply calls myObject.GetType()</p>\n\n<pre><code>DynamicEvaluator ev = new DynamicEvaluator(rule);\nbool result = ev.Evaluate(myObject);\n</code></pre>\n\n<p>This should work. The important piece here is that you save your assembly first (it cannot be read from the memory at the moment), and that it is in a folder that is part of a search path so that Assembly.Load(name) can find it.</p>\n"}], "owner": {"reputation": 91, "user_id": 5198404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1oyz.jpg?s=128&g=1", "display_name": "Didier Vera", "link": "https://stackoverflow.com/users/5198404/didier-vera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1512834348, "creation_date": 1453326077, "last_edit_date": 1512834348, "question_id": 34911152, "link": "https://stackoverflow.com/questions/34911152/how-to-use-a-dynamically-generated-object-as-the-data-source-of-codeeffects-gene", "title": "How to use a dynamically generated object as the data source of CodeEffects generator", "body": "<p>We are using this component www.codeeffects.com which allows us to create business rules based on the object properties.</p>\n\n<p>The html of the view is like this:</p>\n\n<pre><code>@{\n    ViewBag.Title = \"Post Example\";\n\n    Html.CodeEffects().Styles()\n        .SetTheme(ThemeType.Gray)\n        .Render();\n}\n@using (Html.BeginForm(\"Evaluate\", \"Post\", FormMethod.Post))\n{\n    &lt;div class=\"area\"&gt;\n        &lt;h1 class=\"title\"&gt;Post Example&lt;/h1&gt;\n        &lt;div style=\"margin-top:10px;\"&gt;\n            &lt;span&gt;Info:&lt;/span&gt;\n            &lt;span style=\"color:Red;\"&gt;@ViewBag.Message&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;div style=\"margin-top:10px;\"&gt;\n            @{\n    Html.CodeEffects().RuleEditor()\n        .Id(\"ruleEditor\")\n        .SaveAction(\"Save\", \"Post\")\n        .DeleteAction(\"Delete\", \"Post\")\n        .LoadAction(\"Load\", \"Post\")\n        .Mode(RuleType.Execution)\n        .ContextMenuRules(ViewBag.ContextMenuRules)\n        .ToolBarRules(ViewBag.ToolBarRules)\n        .Rule(ViewBag.Rule)\n        .Render();\n            }\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\"area\"&gt;\n        &lt;h1 class=\"title\" style=\"margin-top:20px;\"&gt;Rule Test Form&lt;/h1&gt;\n        @{\n    Html.RenderPartial(\"_PatientForm\");\n        }\n    &lt;/div&gt;\n}\n@{\n    Html.CodeEffects().Scripts().Render();\n}\n</code></pre>\n\n<p>the index action in the controller  is like this:</p>\n\n<pre><code> [HttpGet]\n        public ActionResult Index()\n        {\n            ViewBag.Rule = RuleModel.Create(typeof(Patient));\n            return View();\n        }\n</code></pre>\n\n<p>The class Patient is like this:</p>\n\n<pre><code>// External methods and actions\n    [ExternalMethod(typeof(PatientService), \"IsToday\")]\n    [ExternalAction(typeof(PatientService), \"RequestInfo\")]\n\n    // Dynamic Menu Data Sources; details can be found at\n    // http://codeeffects.com/Doc/Business-Rules-Dynamic-Menu-Data-Sources\n\n    // The getEducationTypes() client-side function declared in /Views/Shared/_Layout.cshtml\n    [Data(\"Education\", \"getEducationTypes\")]\n    // The List() method declared by the Physician class\n    [Data(\"Physicians\", typeof(Physician), \"List\")]\n    public class Patient\n    {\n        // C-tor\n        public Patient()\n        {\n            this.ID = Guid.Empty;\n            this.Gender = Gender.Unknown;\n        }\n\n        // This property will not appear in the Rule Editor - Code Effects component ignores Guids.\n        // Details at http://codeeffects.com/Doc/Business-Rules-Data-Types\n        public Guid ID { get; set; }\n\n        [Field(DisplayName = \"First Name\", Description = \"Patient's first name\", Max = 30)]\n        public string FirstName { get; set; }\n\n        [Field(DisplayName = \"Last Name\", Max = 30, Description = \"Patient's last name\")]\n        public string LastName { get; set; }\n\n        [Field(DisplayName = \"Email Address\", ValueInputType = ValueInputType.User, Max = 150, Description = \"Email address of the patient\")]\n        public string Email { get; set; }\n\n        [Field(DisplayName = \"Date of Birth\", DateTimeFormat = \"MMM dd, yyyy\")]\n        public DateTime? DOB { get; set; }\n\n        [Field(ValueInputType = ValueInputType.User, Description = \"Patient's gender\")]\n        public Gender Gender { get; set; }\n\n        // This field uses the \"Physicians\" dynamic menu source (declared at class level)\n        [Field(DisplayName = \"Physician\", DataSourceName = \"Physicians\", Description = \"Patient's primary physician\")]\n        public int PhysicianID { get; set; }\n\n        // This field uses the \"Education\" client-side dynamic menu source (declared at class level)\n        [Field(DisplayName = \"Education\", DataSourceName = \"Education\", Description = \"Patient's education level\")]\n        public int EducationTypeID { get; set; }\n\n        [Field(Min = 0, Max = 200, Description = \"Current pulse\")]\n        public int? Pulse { get; set; }\n\n        [Field(Min = 0, Max = 200, DisplayName = \"Systolic Pressure\", Description = \"Current systolic pressure\")]\n        public int? SystolicPressure { get; set; }\n\n        [Field(Min = 0, Max = 200, DisplayName = \"Diastolic Pressure\", Description = \"Current Diastolic pressure\")]\n        public int? DiastolicPressure { get; set; }\n\n        [Field(Min = 0, Max = 110, Description = \"Current temperature\")]\n        public decimal? Temperature { get; set; }\n\n        [Field(DisplayName = \"Headaches Box\", Description = \"Does the patient have frequent headaches?\")]\n        public bool Headaches { get; set; }\n\n        [Field(DisplayName = \"Allergies Box\", Description = \"Any allergies?\")]\n        public bool Allergies { get; set; }\n\n        [Field(DisplayName = \"Tobacco Box\", Description = \"Does the patient smoke?\")]\n        public bool Tobacco { get; set; }\n\n        [Field(DisplayName = \"Alcohol Box\", Description = \"Alcohol use?\")]\n        public bool Alcohol { get; set; }\n\n        public Address Home { get; set; }\n        public Address Work { get; set; }\n\n        // This property is used to display outputs of rule actions\n        [ExcludeFromEvaluation]\n        public string Output { get; set; }\n\n        [Method(\"Full Name\", \"Joins together patient's first and last names\")]\n        public string FullName()\n        {\n            return string.Format(\"{0} {1}\", this.FirstName, this.LastName);\n        }\n\n        // Empty overload of the Register method.\n        // No Method attribute is needed here because its\n        // display name is the same as its declared name.\n        [Action(Description = \"Registers new patient\")]\n        public void Register()\n        {\n            this.Output = \"The patient has been registered\";\n        }\n\n        // Overload of the Register method that takes one param.\n        // Both overloads can be used in Code Effects as two different actions\n        // as long as their display names are different.\n        [Action(\"Register with a Message\", \"Registers new patient with additional info\")]\n        public void Register([Parameter(ValueInputType.User, Description = \"Output message\")] string message)\n        {\n            this.Output = message;\n        }\n    }\n</code></pre>\n\n<p>However we want to a dinamyc object built using reflection, the method I created is this:</p>\n\n<pre><code> private static object CreateOurNewObject()\n        {\n            string _xml = \"&lt;root&gt;\" +\n                \"&lt;column name=\\\"Name\\\"&gt;Miron&lt;/column&gt;\" +\n                \"&lt;column name=\\\"LastName\\\"&gt;Abramson&lt;/column&gt;\" +\n                \"&lt;column name=\\\"Blog\\\"&gt;www.blog.mironabramson.com&lt;/column&gt;\" +\n                \"&lt;/root&gt;\";\n\n            XmlDocument xmlDoc = new XmlDocument();\n            xmlDoc.LoadXml(_xml);\n\n            // create a dynamic assembly and module \n            AssemblyName assemblyName = new AssemblyName();\n            assemblyName.Name = \"tmpAssembly\";\n            System.Reflection.Emit.AssemblyBuilder assemblyBuilder = Thread.GetDomain().DefineDynamicAssembly(assemblyName, AssemblyBuilderAccess.Run);\n            ModuleBuilder module = assemblyBuilder.DefineDynamicModule(\"tmpModule\");\n\n            // create a new type builder\n            TypeBuilder typeBuilder = module.DefineType(\"BindableRowCellCollection\", TypeAttributes.Public | TypeAttributes.Class);\n\n            // Loop over the attributes that will be used as the properties names in out new type\n            foreach (XmlNode node in xmlDoc.SelectSingleNode(\"root\").ChildNodes)\n            {\n                string propertyName = node.Attributes[\"name\"].Value;\n\n                // Generate a private field\n                FieldBuilder field = typeBuilder.DefineField(\"_\" + propertyName, typeof(string), FieldAttributes.Private);\n                // Generate a public property\n                PropertyBuilder property =\n                    typeBuilder.DefineProperty(propertyName,\n                                     PropertyAttributes.None,\n                                     typeof(string),\n                                     new Type[] { typeof(string) });\n\n                // The property set and property get methods require a special set of attributes:\n\n                MethodAttributes GetSetAttr =\n                    MethodAttributes.Public |\n                    MethodAttributes.HideBySig;\n\n                // Define the \"get\" accessor method for current private field.\n                MethodBuilder currGetPropMthdBldr =\n                    typeBuilder.DefineMethod(\"get_value\",\n                                               GetSetAttr,\n                                               typeof(string),\n                                               Type.EmptyTypes);\n\n                // Intermediate Language stuff...\n                ILGenerator currGetIL = currGetPropMthdBldr.GetILGenerator();\n                currGetIL.Emit(OpCodes.Ldarg_0);\n                currGetIL.Emit(OpCodes.Ldfld, field);\n                currGetIL.Emit(OpCodes.Ret);\n\n                // Define the \"set\" accessor method for current private field.\n                MethodBuilder currSetPropMthdBldr =\n                    typeBuilder.DefineMethod(\"set_value\",\n                                               GetSetAttr,\n                                               null,\n                                               new Type[] { typeof(string) });\n\n                // Again some Intermediate Language stuff...\n                ILGenerator currSetIL = currSetPropMthdBldr.GetILGenerator();\n                currSetIL.Emit(OpCodes.Ldarg_0);\n                currSetIL.Emit(OpCodes.Ldarg_1);\n                currSetIL.Emit(OpCodes.Stfld, field);\n                currSetIL.Emit(OpCodes.Ret);\n\n                // Last, we must map the two methods created above to our PropertyBuilder to \n                // their corresponding behaviors, \"get\" and \"set\" respectively. \n                property.SetGetMethod(currGetPropMthdBldr);\n                property.SetSetMethod(currSetPropMthdBldr);\n            }\n\n            // Generate our type\n            Type generetedType = typeBuilder.CreateType();\n\n            // Now we have our type. Let's create an instance from it:\n            object generetedObject = Activator.CreateInstance(generetedType);\n\n            // Loop over all the generated properties, and assign the values from our XML:\n            PropertyInfo[] properties = generetedType.GetProperties();\n\n            int propertiesCounter = 0;\n\n            // Loop over the values that we will assign to the properties\n            foreach (XmlNode node in xmlDoc.SelectSingleNode(\"root\").ChildNodes)\n            {\n                string value = node.InnerText;\n                properties[propertiesCounter].SetValue(generetedObject, value, null);\n                propertiesCounter++;\n            }\n\n            //Yoopy ! Return our new genereted object.\n            return generetedObject;\n        }\n</code></pre>\n\n<p>How do we replace the line in the index action to use that object instead of Patient? typeof(object), wouldn't work.</p>\n"}, {"tags": ["c#", "runtime", "connection-string"], "comments": [{"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 1, "creation_date": 1453326461, "post_id": 34911124, "comment_id": 57558071, "body": "Why would you want to do this?  Modifications to the web.config will restart the app pool."}, {"owner": {"reputation": 71114, "user_id": 567435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zYyZz.jpg?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/567435/rahul"}, "edited": false, "score": 0, "creation_date": 1453326996, "post_id": 34911124, "comment_id": 57558367, "body": "If you really want to build connection string dynamically (though that&#39;s weird) then what&#39;s the point in setting it in <code>web.config</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1020, "user_id": 851752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w6h1y.jpg?s=128&g=1", "display_name": "Gurgen Sargsyan", "link": "https://stackoverflow.com/users/851752/gurgen-sargsyan"}, "is_accepted": true, "score": 1, "last_activity_date": 1453330194, "creation_date": 1453330194, "answer_id": 34912160, "question_id": 34911124, "link": "https://stackoverflow.com/questions/34911124/update-connectionstring-value-is-not-working/34912160#34912160", "title": "Update connectionString value is not working", "body": "<p>Try to use</p>\n\n<pre><code>Configuration config = WebConfigurationManager.OpenWebConfiguration(\"/\");\nconfig.AppSettings.Settings[\"ServerDSN\"].Value=newValue;\nconfig.ConnectionStrings.ConnectionStrings[\"myConnectionString\"].ConnectionString = string.Format(\";database Name={0};host=localhost;\", db);\nconfig.Save();\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 4625006, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b5ca9eec5c77c98c50775b8b6369c538?s=128&d=identicon&r=PG&f=1", "display_name": "UserEsp", "link": "https://stackoverflow.com/users/4625006/useresp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 34912160, "answer_count": 1, "score": 0, "last_activity_date": 1453330194, "creation_date": 1453325975, "last_edit_date": 1453326451, "question_id": 34911124, "link": "https://stackoverflow.com/questions/34911124/update-connectionstring-value-is-not-working", "title": "Update connectionString value is not working", "body": "<p>I'm trying to update some config files on runtime.  One file is being updated but connectionString values are not being changed.</p>\n\n<p>Here is my code </p>\n\n<pre><code>Configuration config = WebConfigurationManager.OpenWebConfiguration(\"/\");\nconfig.AppSettings.Settings[\"ServerDSN\"].Value=newValue;\nconfig.Save(ConfigurationSaveMode.Modified);\nSystem.Data.EntityClient.EntityConnectionStringBuilder builder = null;\n\nforeach (ConnectionStringSettings connString in ConfigurationManager.ConnectionStrings)\n{\n    if (connString.Name == \"myConnectionString\")\n    {\n        Configuration config2 = WebConfigurationManager.OpenWebConfiguration(\"/\");\n        //Configuration config2 = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);\n        builder = new EntityConnectionStringBuilder(connString.ToString());\n        builder.ProviderConnectionString = string.Format(\";database Name={0};host=localhost;\", db);\n        config2.Save(ConfigurationSaveMode.Modified, true);\n        ConfigurationManager.RefreshSection(\"connectionStrings\");\n    }\n}\n</code></pre>\n\n<p>THANKS</p>\n"}, {"tags": ["c#", "jquery", "json", "ajax"], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 2001594, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b7562f66356c7adb688e1d7a4fbf16f?s=128&d=identicon&r=PG&f=1", "display_name": "coggicc", "link": "https://stackoverflow.com/users/2001594/coggicc"}, "edited": false, "score": 0, "creation_date": 1453386043, "post_id": 34912152, "comment_id": 57585868, "body": "based on your comment I found another stack question:  <a href=\"http://stackoverflow.com/questions/206384/format-a-microsoft-json-date\" title=\"format a microsoft json date\">stackoverflow.com/questions/206384/format-a-microsoft-json-d&zwnj;&#8203;ate</a>  I tried: var date = new Date(returnData); and I get invalid date...any Ideas?"}, {"owner": {"reputation": 887, "user_id": 867530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a677438c4dfa46842416f0f7755b78?s=128&d=identicon&r=PG", "display_name": "christophano", "link": "https://stackoverflow.com/users/867530/christophano"}, "reply_to_user": {"reputation": 205, "user_id": 2001594, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b7562f66356c7adb688e1d7a4fbf16f?s=128&d=identicon&r=PG&f=1", "display_name": "coggicc", "link": "https://stackoverflow.com/users/2001594/coggicc"}, "edited": false, "score": 0, "creation_date": 1453386737, "post_id": 34912152, "comment_id": 57586415, "body": "You still need to extract the number from the string (<code>&#47;Date\\(([^)]+)\\)&#47;.exec(value)[1]</code>) and parse this as an int (<code>parseInt({value}, 10)</code>) too. You can&#39;t just pass &quot;/Date(1451628000000)/&quot; to a <code>Date</code> constructor."}, {"owner": {"reputation": 205, "user_id": 2001594, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b7562f66356c7adb688e1d7a4fbf16f?s=128&d=identicon&r=PG&f=1", "display_name": "coggicc", "link": "https://stackoverflow.com/users/2001594/coggicc"}, "edited": false, "score": 0, "creation_date": 1453387333, "post_id": 34912152, "comment_id": 57586859, "body": "That just returns &quot;returnData = [&quot;/Date(1451628000000)/&quot;]&quot;, which is the same thing that is passed into your function."}], "tags": [], "owner": {"reputation": 887, "user_id": 867530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a677438c4dfa46842416f0f7755b78?s=128&d=identicon&r=PG", "display_name": "christophano", "link": "https://stackoverflow.com/users/867530/christophano"}, "is_accepted": false, "score": 0, "last_activity_date": 1453393799, "last_edit_date": 1453393799, "creation_date": 1453330152, "answer_id": 34912152, "question_id": 34911100, "link": "https://stackoverflow.com/questions/34911100/return-list-of-datetimes-to-drop-down-using-ajax/34912152#34912152", "title": "Return list of datetimes to drop down using Ajax", "body": "<p>The format you're seeing is the old \"microsoft\" way of formatting dates. There are 2 ways to get around it.</p>\n\n<p>One way would be to use the JSON.Net serialiser instead of the built in <code>JavaScriptSerializer</code>, as it (since version 4.5) formats dates so that they can be automatically parsed.</p>\n\n<p>Another (quicker) way would simply be to extract the numbers from the date in it's current format as pass them to a new javascript <code>Date</code> object.</p>\n\n<pre><code>function toDate(value) {\n  return new Date(parseInt(/Date\\(([^)]+)\\)/.exec(value)[1], 10));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 887, "user_id": 867530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a677438c4dfa46842416f0f7755b78?s=128&d=identicon&r=PG", "display_name": "christophano", "link": "https://stackoverflow.com/users/867530/christophano"}, "edited": false, "score": 0, "creation_date": 1453394443, "post_id": 34927877, "comment_id": 57591916, "body": "This answer does the same as mine, with the exception of the date formatting on your final line."}, {"owner": {"reputation": 205, "user_id": 2001594, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b7562f66356c7adb688e1d7a4fbf16f?s=128&d=identicon&r=PG&f=1", "display_name": "coggicc", "link": "https://stackoverflow.com/users/2001594/coggicc"}, "reply_to_user": {"reputation": 887, "user_id": 867530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a677438c4dfa46842416f0f7755b78?s=128&d=identicon&r=PG", "display_name": "christophano", "link": "https://stackoverflow.com/users/867530/christophano"}, "edited": false, "score": 0, "creation_date": 1453395167, "post_id": 34927877, "comment_id": 57592394, "body": "Add the last line to your answer and I&#39;ll mark your&#39;s correct."}], "tags": [], "owner": {"reputation": 205, "user_id": 2001594, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b7562f66356c7adb688e1d7a4fbf16f?s=128&d=identicon&r=PG&f=1", "display_name": "coggicc", "link": "https://stackoverflow.com/users/2001594/coggicc"}, "is_accepted": false, "score": 0, "last_activity_date": 1453390503, "creation_date": 1453390503, "answer_id": 34927877, "question_id": 34911100, "link": "https://stackoverflow.com/questions/34911100/return-list-of-datetimes-to-drop-down-using-ajax/34927877#34927877", "title": "Return list of datetimes to drop down using Ajax", "body": "<p>I resolved this with the following:</p>\n\n<pre><code>function convertDate(returnData) \n{\n    var pattern = /Date\\(([^)]+)\\)/;\n    var results = pattern.exec(returnData);\n    var dt = new Date(parseFloat(results[1]));\n    return (dt.getMonth() + 1) + \"/\" + dt.getDate() + \"/\" + dt.getFullYear();\n}\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 2001594, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b7562f66356c7adb688e1d7a4fbf16f?s=128&d=identicon&r=PG&f=1", "display_name": "coggicc", "link": "https://stackoverflow.com/users/2001594/coggicc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1453393799, "creation_date": 1453325904, "last_edit_date": 1495535311, "question_id": 34911100, "link": "https://stackoverflow.com/questions/34911100/return-list-of-datetimes-to-drop-down-using-ajax", "title": "Return list of datetimes to drop down using Ajax", "body": "<p>I have a drop down list that I need to fill with datetime values passed from an ajax call.  The values that populate look like this: \"/date1234847269/\" and not actual dates. I just need the dates to be passed into the drop down list. I do not need the time stamps that are also in the datetime value that is returned from the controller.</p>\n\n<p>I'm not sure if jQuery has issues with handling c# datetime values and not strings.  Any help would be appreciated.  Thanks</p>\n\n<p>My View:</p>\n\n<pre><code>&lt;select id=\"ddlDate\" class=\"form-control bold\"&gt;\n    &lt;option value='0'&gt;--Select Date--&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>My Ajax Call:</p>\n\n<pre><code>function loadDateDDL(historicalIsChecked, monthlyIsChecked) {\n    $.ajax({\n        type: 'POST',\n        url: '@Url.Action(\"GetGroupReportDates\")',\n        dataType: 'json',\n        data: { isMonthly: monthlyIsChecked },\n        success: function (returnData) {\n            convertDate(returnData);\n            $(\"#ddlDate\").empty();\n            $(\"#ddlDate\").append(\"&lt;option value='0'&gt;--Select Date--&lt;/option&gt;\");\n                            $.each(returnData, function (value, key) {\n                                $(\"#ddlDate\").append($(\"&lt;option&gt;&lt;/option&gt;\")\n                                                    .attr(\"value\", value).text(key));\n                            });\n            //alert(returnData);\n        },\n        error: function (ex) {\n            alert('Failed to retrieve dates.' + ex);\n        }\n    });\n}\n\nfunction convertDate(returnData) \n    {\n        var date = new Date(returnData);\n        return date;\n    }\n</code></pre>\n\n<p>My Controller:</p>\n\n<pre><code>public JsonResult GetGroupReportDates ( Boolean isMonthly )\n{\n    List&lt;DateTime&gt; reportDates = RealmsModel.RealmsAuditDataInterface ( ).GetGroupQueryRptDates ( isMonthly );\n\n    return new JsonResult ( )\n    {\n        Data = reportDates,\n        MaxJsonLength = Int32.MaxValue\n    };\n}\n</code></pre>\n\n<p>Update 1/21/2016:</p>\n\n<p>I am now passing my json data \"returnData\" to the javascript function below and converting it based on another stack post: <a href=\"https://stackoverflow.com/questions/206384/format-a-microsoft-json-date\">How do I format a Microsoft JSON date?</a></p>\n\n<pre><code>function convertDate(returnData) \n    {\n        var date = new Date(returnData);\n        return date;\n    }\n</code></pre>\n\n<p>This now gives me the error \"<code>date = Invalid Date {}, returnData = [\"/Date(1451628000000)/\"]</code>\".  I feel like I'm getting close.  Any help is appreciated.</p>\n"}, {"tags": ["c#", "xml", "validation", "xsd"], "comments": [{"owner": {"reputation": 23254, "user_id": 1320845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c806c11bc65456280ef4832f82441d43?s=128&d=identicon&r=PG", "display_name": "Charles Mager", "link": "https://stackoverflow.com/users/1320845/charles-mager"}, "edited": false, "score": 1, "creation_date": 1453326131, "post_id": 34911098, "comment_id": 57557880, "body": "You&#39;ve not provided any specifics, but if you&#39;re validating XML with random schemas then this is probably expected. The best you&#39;ll get is a warning if the document doesn&#39;t have any matching elements in the schema."}, {"owner": {"reputation": 23254, "user_id": 1320845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c806c11bc65456280ef4832f82441d43?s=128&d=identicon&r=PG", "display_name": "Charles Mager", "link": "https://stackoverflow.com/users/1320845/charles-mager"}, "edited": false, "score": 4, "creation_date": 1453326149, "post_id": 34911098, "comment_id": 57557887, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16755058/validating-xml-documents-with-xsd-correctly\">Validating XML documents with XSD correctly</a>"}, {"owner": {"reputation": 2714, "user_id": 569353, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e6688111b5951a8df6e2496b6ab62de?s=128&d=identicon&r=PG", "display_name": "SCB", "link": "https://stackoverflow.com/users/569353/scb"}, "edited": false, "score": 1, "creation_date": 1453326195, "post_id": 34911098, "comment_id": 57557911, "body": "Check that the namespace in the XML document matches the one being targeted by the schema. Might be helpful to post anexample of the schema and xml files you are trying to validate"}, {"owner": {"reputation": 851, "user_id": 5170116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g76oA.png?s=128&g=1", "display_name": "JerryM", "link": "https://stackoverflow.com/users/5170116/jerrym"}, "edited": false, "score": 0, "creation_date": 1453327160, "post_id": 34911098, "comment_id": 57558472, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17232575/xdocument-validate-is-always-successful\">Xdocument.Validate is always successful</a>"}, {"owner": {"reputation": 538, "user_id": 2067941, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/7BSLv.jpg?s=128&g=1", "display_name": "chazbot7", "link": "https://stackoverflow.com/users/2067941/chazbot7"}, "reply_to_user": {"reputation": 23254, "user_id": 1320845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c806c11bc65456280ef4832f82441d43?s=128&d=identicon&r=PG", "display_name": "Charles Mager", "link": "https://stackoverflow.com/users/1320845/charles-mager"}, "edited": false, "score": 0, "creation_date": 1453328549, "post_id": 34911098, "comment_id": 57559190, "body": "@CharlesMager Looking at the duplicate you suggested now, that looks promising, thank you."}, {"owner": {"reputation": 538, "user_id": 2067941, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/7BSLv.jpg?s=128&g=1", "display_name": "chazbot7", "link": "https://stackoverflow.com/users/2067941/chazbot7"}, "reply_to_user": {"reputation": 23254, "user_id": 1320845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c806c11bc65456280ef4832f82441d43?s=128&d=identicon&r=PG", "display_name": "Charles Mager", "link": "https://stackoverflow.com/users/1320845/charles-mager"}, "edited": false, "score": 0, "creation_date": 1453329719, "post_id": 34911098, "comment_id": 57559700, "body": "@CharlesMager so if the namespaces on the XSD and the XML don&#39;t match, the validation will still pass because there&#39;s nothing to compare. Am I understanding that correctly?"}], "answers": [{"tags": [], "owner": {"reputation": 20710, "user_id": 886533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AORA3.png?s=128&g=1", "display_name": "Petru Gardea", "link": "https://stackoverflow.com/users/886533/petru-gardea"}, "is_accepted": false, "score": 0, "last_activity_date": 1454078163, "last_edit_date": 1454078163, "creation_date": 1454031076, "answer_id": 35075394, "question_id": 34911098, "link": "https://stackoverflow.com/questions/34911098/xml-validation-against-xsd-always-returns-true/35075394#35075394", "title": "XML Validation against XSD always returns true", "body": "<p>In .NET you have to check yourself if the validator actually matches a schema component; if it doesn't, there is no exception thrown, and so your code will not work as you expect.</p>\n\n<p>A match means one or both of the following:</p>\n\n<ul>\n<li>there is one global element in your schema set with a qualified name that is the same as your XML document element's qualified name.</li>\n<li>the document element has an xsi:type attribute, that is a qualified name pointing to a global type in your schema set.</li>\n</ul>\n\n<p>In streaming mode, you can do this check easily. This pseudo-kind-of-code should give you an idea (error handling not shown, etc.):</p>\n\n<pre><code>using (XmlReader reader = XmlReader.Create(xmlfile, settings))\n{\n    reader.MoveToContent();\n    var qn = new XmlQualifiedName(reader.LocalName, reader.NamespaceURI);\n    // element test: schemas.GlobalElements.ContainsKey(qn);\n    // check if there's an xsi:type attribute: reader[\"type\", XmlSchema.InstanceNamespace] != null;\n    // if exists, resolve the value of the xsi:type attribute to an XmlQualifiedName\n    // type test: schemas.GlobalTypes.ContainsKey(qn);\n    // if all good, keep reading; otherwise, break here after setting your error flag, etc.\n}\n</code></pre>\n\n<p>You might also consider the <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.xmlnode.schemainfo(v=vs.110).aspx\" rel=\"nofollow\">XmlNode.SchemaInfo</a> which represents the post schema validation infoset that has been assigned to a node as a result of schema validation. I would test different conditions and see how it works for your scenario. The first method is recommended to reduce the attack surface in DoS attacks, as it is the fastest way to detect completely bogus payloads.</p>\n"}], "owner": {"reputation": 538, "user_id": 2067941, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/7BSLv.jpg?s=128&g=1", "display_name": "chazbot7", "link": "https://stackoverflow.com/users/2067941/chazbot7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454078163, "creation_date": 1453325895, "question_id": 34911098, "link": "https://stackoverflow.com/questions/34911098/xml-validation-against-xsd-always-returns-true", "title": "XML Validation against XSD always returns true", "body": "<p>I have a c# script that validates an XML document against an XSD document, as follows:</p>\n\n<pre><code>    static bool IsValidXml(string xmlFilePath, string xsdFilePath)\n    {\n\n        XmlReaderSettings settings = new XmlReaderSettings();\n        settings.Schemas.Add(null, xsdFilePath);\n        settings.ValidationType = ValidationType.Schema;\n        settings.Schemas.Compile();\n\n        try\n        {\n            XmlReader xmlRead = XmlReader.Create(xmlFilePath, settings);\n            while (xmlRead.Read())\n            { };\n            xmlRead.Close();\n        }\n        catch (Exception e)\n        {\n            return false;\n        }\n\n        return true;\n    }\n</code></pre>\n\n<p>I've compiled this after looking at a number of MSDN articles and questions here where this is the solution. It does correctly validate that the XSD is formed well (returns false if I mess with the file) and checks that the XML is formed well (also returns false when messed with).</p>\n\n<p>I've also tried the following, but it does the exact same thing:</p>\n\n<pre><code>    static bool IsValidXml(string xmlFilePath, string xsdFilePath)\n    {\n\n        XDocument xdoc = XDocument.Load(xmlFilePath);\n        XmlSchemaSet schemas = new XmlSchemaSet();\n        schemas.Add(null, xsdFilePath);\n\n        try\n        {\n            xdoc.Validate(schemas, null);\n        }\n        catch (XmlSchemaValidationException e)\n        {\n            return false;\n        }\n\n        return true;\n    }\n</code></pre>\n\n<p>I've even pulled a completely random XSD off the internet and thrown it into both scripts, and it still validates on both. What am I missing here?</p>\n\n<p>Using .NET 3.5 within an SSIS job.</p>\n"}, {"tags": ["c#", "epplus"], "comments": [{"owner": {"reputation": 2085, "user_id": 4372746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7421528d3e64e8186fcc0f6020cc1f14?s=128&d=identicon&r=PG&f=1", "display_name": "Glorin Oakenfoot", "link": "https://stackoverflow.com/users/4372746/glorin-oakenfoot"}, "edited": false, "score": 0, "creation_date": 1453326564, "post_id": 34911085, "comment_id": 57558131, "body": "Just glancing at their source code, it appears to be built with at least some thought to multi-threading. That, at least, is promising. As a side note, be wary, as your <code>Parallel.For</code> has absolutely no guarantee of putting the worksheets in any particular order, if that matters to you."}, {"owner": {"reputation": 3444, "user_id": 107762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VKkkC.png?s=128&g=1", "display_name": "codechurn", "link": "https://stackoverflow.com/users/107762/codechurn"}, "reply_to_user": {"reputation": 2085, "user_id": 4372746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7421528d3e64e8186fcc0f6020cc1f14?s=128&d=identicon&r=PG&f=1", "display_name": "Glorin Oakenfoot", "link": "https://stackoverflow.com/users/4372746/glorin-oakenfoot"}, "edited": false, "score": 0, "creation_date": 1453328043, "post_id": 34911085, "comment_id": 57558934, "body": "Order of the worksheets does not matter to me; I just want to optimize workbook creation.  I have all of the data ready ahead of time and just need to slice/dice/filter for each worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 3444, "user_id": 107762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VKkkC.png?s=128&g=1", "display_name": "codechurn", "link": "https://stackoverflow.com/users/107762/codechurn"}, "edited": false, "score": 0, "creation_date": 1453484853, "post_id": 34913512, "comment_id": 57637415, "body": "I was hoping for a definitive &quot;I&#39;ve done it and it works fine&quot; answer and possibly so areas where I should exercise caution.  I guess I will just have to look at the source and deal with any bumps as I go along."}, {"owner": {"reputation": 248, "user_id": 1417716, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-FqIvkPmX2tI/AAAAAAAAAAI/AAAAAAAAAEQ/lfDK_Xsn0K0/photo.jpg?sz=128", "display_name": "w33z33", "link": "https://stackoverflow.com/users/1417716/w33z33"}, "reply_to_user": {"reputation": 3444, "user_id": 107762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VKkkC.png?s=128&g=1", "display_name": "codechurn", "link": "https://stackoverflow.com/users/107762/codechurn"}, "edited": false, "score": 1, "creation_date": 1481707587, "post_id": 34913512, "comment_id": 69480943, "body": "@codechurn about 1 year later, what were your findings?"}, {"owner": {"reputation": 3444, "user_id": 107762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VKkkC.png?s=128&g=1", "display_name": "codechurn", "link": "https://stackoverflow.com/users/107762/codechurn"}, "reply_to_user": {"reputation": 248, "user_id": 1417716, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-FqIvkPmX2tI/AAAAAAAAAAI/AAAAAAAAAEQ/lfDK_Xsn0K0/photo.jpg?sz=128", "display_name": "w33z33", "link": "https://stackoverflow.com/users/1417716/w33z33"}, "edited": false, "score": 2, "creation_date": 1481739812, "post_id": 34913512, "comment_id": 69501381, "body": "@w33z33 I have been doing it for that entire year without one problem. In the Visual Studio debugger I will occasionally (once out of every 300) times get a goofy error.  I have never had a problem in the production deployed code."}], "tags": [], "owner": {"reputation": 556, "user_id": 2133676, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/80a5c41aca9146a2cceeae86728338af?s=128&d=identicon&r=PG", "display_name": "stratever", "link": "https://stackoverflow.com/users/2133676/stratever"}, "is_accepted": true, "score": 2, "last_activity_date": 1543487116, "last_edit_date": 1543487116, "creation_date": 1453337443, "answer_id": 34913512, "question_id": 34911085, "link": "https://stackoverflow.com/questions/34911085/creating-excel-worksheets-using-parallel-for-and-epplus/34913512#34913512", "title": "Creating Excel worksheets using Parallel.For and EPPlus", "body": "<p>Take a short look for the source code: <a href=\"https://github.com/JanKallman/EPPlus/blob/master/EPPlus/ExcelWorksheets.cs\" rel=\"nofollow noreferrer\">https://github.com/JanKallman/EPPlus/blob/master/EPPlus/ExcelWorksheets.cs</a></p>\n\n<p>As you can see, the Add method calls the AddSheet method that uses lock(...) to make the operation thread-safe, so yes, you can use the Parallel.For.</p>\n"}], "owner": {"reputation": 3444, "user_id": 107762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VKkkC.png?s=128&g=1", "display_name": "codechurn", "link": "https://stackoverflow.com/users/107762/codechurn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1993, "favorite_count": 0, "accepted_answer_id": 34913512, "answer_count": 1, "score": 3, "last_activity_date": 1543487116, "creation_date": 1453325856, "last_edit_date": 1453329393, "question_id": 34911085, "link": "https://stackoverflow.com/questions/34911085/creating-excel-worksheets-using-parallel-for-and-epplus", "title": "Creating Excel worksheets using Parallel.For and EPPlus", "body": "<p>I am using the <a href=\"http://epplus.codeplex.com/\" rel=\"nofollow\">EPPlus</a> library to create an Excel workbook with many worksheets.  I was wondering if it is safe to build the worksheets in parallel.  I could not find a mention in the (limited) documentation if the library supports this kind of behavior:</p>\n\n<pre><code>package = new ExcelPackage();\nint start = 1;\nint end = 100;\n\nParallel.For(start, end; s =&gt;\n{\n    var worksheet = package.Workbook.Worksheets.Add(\"Worksheet\" + s.ToString());\n    //routine to populate data here\n});\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "braintree"], "comments": [{"owner": {"reputation": 412, "user_id": 738258, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/4jBK3.png?s=128&g=1", "display_name": "Rohit Rohela", "link": "https://stackoverflow.com/users/738258/rohit-rohela"}, "edited": false, "score": 0, "creation_date": 1453368316, "post_id": 34910968, "comment_id": 57573497, "body": "Have you checked whether your newEdit is null ?"}, {"owner": {"reputation": 67, "user_id": 4850133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ab457f344f2286c4559031981ffbe7?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Makarov", "link": "https://stackoverflow.com/users/4850133/nikita-makarov"}, "reply_to_user": {"reputation": 412, "user_id": 738258, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/4jBK3.png?s=128&g=1", "display_name": "Rohit Rohela", "link": "https://stackoverflow.com/users/738258/rohit-rohela"}, "edited": false, "score": 0, "creation_date": 1453378086, "post_id": 34910968, "comment_id": 57580203, "body": "I am stupid, i was so focused thinking it was something wrong with my understanding of the concept, that i totally forgot to double check that the innerclass was being instantiated."}, {"owner": {"reputation": 412, "user_id": 738258, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/4jBK3.png?s=128&g=1", "display_name": "Rohit Rohela", "link": "https://stackoverflow.com/users/738258/rohit-rohela"}, "edited": false, "score": 0, "creation_date": 1453378520, "post_id": 34910968, "comment_id": 57580501, "body": "You can post your finding as a solution. Its perfectly Ok on Stack Overflow. :)"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 4850133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ab457f344f2286c4559031981ffbe7?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Makarov", "link": "https://stackoverflow.com/users/4850133/nikita-makarov"}, "is_accepted": false, "score": 1, "last_activity_date": 1453411241, "creation_date": 1453411241, "answer_id": 34934585, "question_id": 34910968, "link": "https://stackoverflow.com/questions/34910968/braintree-generate-client-token-in-asp-net-mvc-4-5/34934585#34934585", "title": "Braintree: Generate Client Token in ASP.NET MVC 4.5", "body": "<p>As said in the comment, i was far too focused on Braintree that i made an extremely beginner error. This serves as a great reminder that you can find the answer by just taking a step back and looking at the error from a new perspective. :)</p>\n"}], "owner": {"reputation": 67, "user_id": 4850133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ab457f344f2286c4559031981ffbe7?s=128&d=identicon&r=PG&f=1", "display_name": "Nikita Makarov", "link": "https://stackoverflow.com/users/4850133/nikita-makarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1246, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453411241, "creation_date": 1453325440, "question_id": 34910968, "link": "https://stackoverflow.com/questions/34910968/braintree-generate-client-token-in-asp-net-mvc-4-5", "title": "Braintree: Generate Client Token in ASP.NET MVC 4.5", "body": "<p>I'm having some issues integrating Braintree, as well as understanding the concept of how the transaction takes place.</p>\n\n<p>Here's how i currently understand Braintree:</p>\n\n<p>Server Generates ClientToken -> Integrates into html/js -> User receives payment form and sends data to Braintree -> Nonce is sent to Server -> Server sends Transaction to Braintree</p>\n\n<p>Is this correct?</p>\n\n<p>I'm currently on step 1, trying to generate a client token, and i'm getting a NullReferenceException:</p>\n\n<pre><code>public ActionResult Payment(EditContainerViewModel newEdit)\n    {\n\n        //generate client token\n        newEdit.PaymentInfo.ClientToken = PaymentConstants.Gateway.ClientToken.generate();\n\n        return View(newEdit);\n    }\n</code></pre>\n\n<p>And heres the Gateway declaration:</p>\n\n<pre><code> public static class PaymentConstants\n{\n    public static BraintreeGateway Gateway = new BraintreeGateway\n    {\n        Environment = Braintree.Environment.SANDBOX,\n        MerchantId = \"id\",\n        PublicKey = \"publickey\",\n        PrivateKey = \"privatekey\"\n    };\n}\n</code></pre>\n\n<p>Heres my view:</p>\n\n<pre><code>@model Sandbox.Models.EditContainerViewModel\n\n\n&lt;h2&gt;Payment&lt;/h2&gt;\n\n&lt;form id=\"checkout\" method=\"post\" action=\"/checkout\"&gt;\n    &lt;div id=\"payment-form\"&gt;&lt;/div&gt;\n    &lt;input type=\"submit\" value=\"Pay $10\"&gt;\n&lt;/form&gt;\n\n&lt;script src=\"https://js.braintreegateway.com/v2/braintree.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n// We generated a client token for you so you can test out this code\n// immediately. In a production-ready integration, you will need to\n// generate a client token on your server (see section below).\n    var clientToken = \"@Html.Raw(Model.PaymentInfo.ClientToken)\";\n\nbraintree.setup(clientToken, \"dropin\", {\n  container: \"payment-form\"\n});\n&lt;/script&gt;\n</code></pre>\n\n<p>I'd really appreciate any insight on this topic, especially as i found that the provided ASP.NET examples didn't show the token generation stage. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", "com", "custom-attributes", "regsvr32", "dsofile"], "comments": [{"owner": {"reputation": 909, "user_id": 2117114, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/12cc69ff25c673e3d552e2758ad0bdb4?s=128&d=identicon&r=PG", "display_name": "yo2011", "link": "https://stackoverflow.com/users/2117114/yo2011"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1453327001, "post_id": 34910936, "comment_id": 57558369, "body": "Hi, Is there any alternatives?"}, {"owner": {"reputation": 909, "user_id": 2117114, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/12cc69ff25c673e3d552e2758ad0bdb4?s=128&d=identicon&r=PG", "display_name": "yo2011", "link": "https://stackoverflow.com/users/2117114/yo2011"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1453327090, "post_id": 34910936, "comment_id": 57558421, "body": "I want to add Unique Identifier to any type of file"}, {"owner": {"reputation": 909, "user_id": 2117114, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/12cc69ff25c673e3d552e2758ad0bdb4?s=128&d=identicon&r=PG", "display_name": "yo2011", "link": "https://stackoverflow.com/users/2117114/yo2011"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1453371191, "post_id": 34910936, "comment_id": 57575523, "body": "Any help Hans Passant"}], "owner": {"reputation": 909, "user_id": 2117114, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/12cc69ff25c673e3d552e2758ad0bdb4?s=128&d=identicon&r=PG", "display_name": "yo2011", "link": "https://stackoverflow.com/users/2117114/yo2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453325344, "creation_date": 1453325344, "question_id": 34910936, "link": "https://stackoverflow.com/questions/34910936/how-to-reference-and-register-dsofile-dll-in-c-project-for-different-platforms", "title": "How to reference and register DSOFile.dll in c# project for different platforms 32 and 64?", "body": "<p>I am using DSOFile.dll to add custom attributes to windows file system but how reference the dll in my c# project as there two versions of the dll(32 and 64).\nAlso, How register the correct dll based on the platform either 32 or 46?\nI need clear steps to this.</p>\n"}, {"tags": ["c#", "wpf", "uac", "credentials", "mediaelement"], "comments": [{"owner": {"reputation": 12222, "user_id": 815938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8mNbc.png?s=128&g=1", "display_name": "kennyzx", "link": "https://stackoverflow.com/users/815938/kennyzx"}, "edited": false, "score": 0, "creation_date": 1453341709, "post_id": 34910904, "comment_id": 57563516, "body": "How did you set the source after moving the mp4 to another drive? Show the code."}, {"owner": {"reputation": 21, "user_id": 4102715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962ce1765faea761f87a6720bd75b5cc?s=128&d=identicon&r=PG&f=1", "display_name": "MelT", "link": "https://stackoverflow.com/users/4102715/melt"}, "reply_to_user": {"reputation": 12222, "user_id": 815938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8mNbc.png?s=128&g=1", "display_name": "kennyzx", "link": "https://stackoverflow.com/users/815938/kennyzx"}, "edited": false, "score": 0, "creation_date": 1453385128, "post_id": 34910904, "comment_id": 57585201, "body": "I do not move the file runtime, I meant that I manually moved the file THEN modified my code; the path is set in my ViewModel then binded in the xaml."}], "owner": {"reputation": 21, "user_id": 4102715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/962ce1765faea761f87a6720bd75b5cc?s=128&d=identicon&r=PG&f=1", "display_name": "MelT", "link": "https://stackoverflow.com/users/4102715/melt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453341808, "creation_date": 1453325255, "last_edit_date": 1453341808, "question_id": 34910904, "link": "https://stackoverflow.com/questions/34910904/mediaelement-in-wpf-4-0-vs-user-credentials", "title": "MediaElement in WPF 4.0 vs user credentials", "body": "<p>I have a WPF application with a simple \"Getting Started\" .mp4 when first launching the app.</p>\n\n<p>I simply added a <code>MediaElement</code> in a WPF Window and set the source to an absolute path under <code>C:\\Program Files</code>.</p>\n\n<p>If I launch my .exe \"As Administrator\", everything runs fine.\nIf I launch it as standard user (or by double-clicking the .exe with UAC active), the video is not shown.</p>\n\n<p>The <code>MediaOpened</code> event is received, with the Source set accordingly.\nThe <code>MediaFailed</code> event is not fired at all.</p>\n\n<p>I tried changing the way the path is packed (Uri?), I tried moving the file on another drive, tried to change the permission of the parent folder (just in case)...nothing works. The mediaElement content remains gray. If I set ScrubbingEnabled it turns black but nothing more...</p>\n\n<p>I've read we cannot use resources as videoSource...so be it, I'm setting a path.</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 5322573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae156bb1fd44d464ad9d7950dc2d9ef4?s=128&d=identicon&r=PG&f=1", "display_name": "wi_marti", "link": "https://stackoverflow.com/users/5322573/wi-marti"}, "is_accepted": false, "score": 0, "last_activity_date": 1453325602, "creation_date": 1453325602, "answer_id": 34911010, "question_id": 34910851, "link": "https://stackoverflow.com/questions/34910851/changing-a-value-of-an-object-through-the-controller/34911010#34911010", "title": "Changing a value of an object through the controller", "body": "<p>That's because you are not storing the running count of hits anywhere. Every time the page comes back to the controller .Hits is 0 because every time the page reloads it re-initializes the CustomButtons and .Hits starts back at 0.</p>\n\n<p>You should store the current number of Hits in the Model and send the Model back with the View. In the View you can take the current number of Hits from the Model and store it back in .Hits. Then when sent to the controller, increment Hits and store it back in the Model and return the new Model with the View.</p>\n"}, {"comments": [{"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "edited": false, "score": 0, "creation_date": 1453338043, "post_id": 34911202, "comment_id": 57562547, "body": "Precisely. <code>db.CustomButtons.Find(id).Hits += 1;</code> does nothing by itself other than specify a desire for the <code>Hits</code> value of your <code>CustomButton</code> object with id <code>id</code> to be increased by one. That value is not actually converted and saved into your database until you invoke <code>db.SaveChanges();</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 4660736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ce96494c2b130b02f94186314b1d64?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Page", "link": "https://stackoverflow.com/users/4660736/tyler-page"}, "is_accepted": false, "score": 0, "last_activity_date": 1453326285, "creation_date": 1453326285, "answer_id": 34911202, "question_id": 34910851, "link": "https://stackoverflow.com/questions/34910851/changing-a-value-of-an-object-through-the-controller/34911202#34911202", "title": "Changing a value of an object through the controller", "body": "<p>I figured it out, I had to add db.SaveChanges(); to the next line after increasing hits by one.</p>\n"}], "owner": {"reputation": 1, "user_id": 4660736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ce96494c2b130b02f94186314b1d64?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Page", "link": "https://stackoverflow.com/users/4660736/tyler-page"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453326285, "creation_date": 1453325076, "last_edit_date": 1453325904, "question_id": 34910851, "link": "https://stackoverflow.com/questions/34910851/changing-a-value-of-an-object-through-the-controller", "title": "Changing a value of an object through the controller", "body": "<p>My images have a int called hits which is intended to count the amount of times somebody has clicked on an image.  When an image is clicked on it goes to /Details/[Image ID].  My details controller has this code:</p>\n\n<pre><code>public ActionResult Details(int? id)\n{\n    if (id == null)\n    {\n        return new HttpStatusCodeResult(HttpStatusCode.BadRequest);\n    }\n    CustomButton customButton = db.CustomButtons.Find(id);\n    if (customButton == null)\n    {\n        return HttpNotFound();\n    }\n    db.CustomButtons.Find(id).Hits += 1;\n    return View(customButton);\n}\n</code></pre>\n\n<p>The image's hits remain at either 1 or 2 though no matter how many times they are clicked on.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1453325081, "post_id": 34910836, "comment_id": 57557309, "body": "Would you mind pointing out exactly <i>where</i> the error is happening?"}, {"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1453325183, "post_id": 34910836, "comment_id": 57557379, "body": "any where &quot;tax =&quot; is and  taxoutputlabel.Text = tax; has the same error"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 2, "creation_date": 1453325236, "post_id": 34910836, "comment_id": 57557413, "body": "try <code>tax = income * 0.10m</code>;"}, {"owner": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "edited": false, "score": 0, "creation_date": 1453325252, "post_id": 34910836, "comment_id": 57557423, "body": "Also the code doesn&#39;t even compile. <code>decimal income &#47;&#47;hold income value</code> without semicolon at end et cetera. Please be more cautious about these errors when asking questions."}, {"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453325532, "post_id": 34910836, "comment_id": 57557551, "body": "Thank you, as I did say i have been out of coding for about two years. Sorry for missing that. I knew was something simple."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1453326086, "post_id": 34910836, "comment_id": 57557855, "body": "Linked duplicate explains the reason of the error message. If you need help with C# syntax SO is somewhat wrong place to ask about it."}, {"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453326318, "post_id": 34910836, "comment_id": 57557974, "body": "idk helped me so far :)"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453325611, "post_id": 34910919, "comment_id": 57557597, "body": "Thank you very much. taxoutputlabel.Text = tax; has the error of cannot implicity convert type Decimal to string."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453325642, "post_id": 34910919, "comment_id": 57557617, "body": "use <code>tax.ToString()</code>."}, {"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453325775, "post_id": 34910919, "comment_id": 57557681, "body": "taxoutputlabel.Text = tax.ToString(); now says use of unassigned local variable &#39;tax&#39;"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "reply_to_user": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 1, "creation_date": 1453325831, "post_id": 34910919, "comment_id": 57557711, "body": "@MatthewHunt that means you need to <code>Initialize</code> it to a value for example <code>var tax = 0.0;</code>"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453325975, "post_id": 34910919, "comment_id": 57557788, "body": "@MethodMan, if OP wants to use <code>var</code>, then he should initialize it as <code>0.0m</code> so that the compiler knows it is a decimal."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453326086, "post_id": 34910919, "comment_id": 57557854, "body": "I know @YacoubMassad basically what I was stating is that the  compiler was complaining because just doing <code>decimal tax;</code> the compiler expects it to be initialized"}, {"owner": {"reputation": 549, "user_id": 1885199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e5ecc2d4b2e7bcfc885c5cd74ffad9?s=128&d=identicon&r=PG", "display_name": "Chrotenise", "link": "https://stackoverflow.com/users/1885199/chrotenise"}, "edited": false, "score": 0, "creation_date": 1453326148, "post_id": 34910919, "comment_id": 57557886, "body": "@YacoubMassad .ToString() will not solve your compile issues, it will only introduce another issue since tax is repeatedly used in the code further down."}, {"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453326220, "post_id": 34910919, "comment_id": 57557927, "body": "thank you all soo much. That helped!!! when you dont use this stuff you really forgot it"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 549, "user_id": 1885199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e5ecc2d4b2e7bcfc885c5cd74ffad9?s=128&d=identicon&r=PG", "display_name": "Chrotenise", "link": "https://stackoverflow.com/users/1885199/chrotenise"}, "edited": false, "score": 0, "creation_date": 1453326289, "post_id": 34910919, "comment_id": 57557955, "body": "@Chrotenise, I am not really sure what you mean. I advised OP to use <code>taxoutputlabel.Text = tax.ToString()</code> to set the value of the label."}, {"owner": {"reputation": 549, "user_id": 1885199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e5ecc2d4b2e7bcfc885c5cd74ffad9?s=128&d=identicon&r=PG", "display_name": "Chrotenise", "link": "https://stackoverflow.com/users/1885199/chrotenise"}, "edited": false, "score": 0, "creation_date": 1453326456, "post_id": 34910919, "comment_id": 57558066, "body": "@YacoubMassad it is/was not clear you&#39;re refering to Matthew Hunt&#39;s comment. I would edit that in your comment for easier reading."}, {"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453326605, "post_id": 34910919, "comment_id": 57558162, "body": "You all are great. I have no more error! Though now I am getting 0 returned back to me each time I run the program."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453326736, "post_id": 34910919, "comment_id": 57558220, "body": "You should set <code>taxoutputlabel.Text</code> after you are doing with the calculations, not before."}, {"owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "edited": false, "score": 0, "creation_date": 1453327354, "post_id": 34910919, "comment_id": 57558582, "body": "sigh... I feel like a nube all over again. thank you so much. I knew something was out of place. Just did not know what."}], "tags": [], "owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "is_accepted": true, "score": 14, "last_activity_date": 1453325321, "creation_date": 1453325321, "answer_id": 34910919, "question_id": 34910836, "link": "https://stackoverflow.com/questions/34910836/i-getting-this-error-cannot-implicitly-convert-type-double-to-decimal-an-e/34910919#34910919", "title": "I getting this error. Cannot implicitly convert type &#39;double&#39; to &#39;decimal&#39;. An explicit conversation exists (are you missing a cast?)", "body": "<p>The compiler treats 0.10 (and any other fractions) as a <code>double</code> by default.</p>\n\n<p>To tell the compiler that it is a decimal, you have to use the <code>m</code> suffix like this:</p>\n\n<pre><code>tax = income * 0.10m;\n</code></pre>\n\n<p>You have to do this for all numbers used in the equations. For example:</p>\n\n<pre><code>tax = 4867.50m + (35350m - 8700m) * 0.15m; \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5818244, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BYgjfijKOEw/AAAAAAAAAAI/AAAAAAAAAZg/AsjgJDzbBfU/photo.jpg?sz=128", "display_name": "Victhor Christianno", "link": "https://stackoverflow.com/users/5818244/victhor-christianno"}, "is_accepted": false, "score": 4, "last_activity_date": 1453325968, "creation_date": 1453325968, "answer_id": 34911121, "question_id": 34910836, "link": "https://stackoverflow.com/questions/34910836/i-getting-this-error-cannot-implicitly-convert-type-double-to-decimal-an-e/34911121#34911121", "title": "I getting this error. Cannot implicitly convert type &#39;double&#39; to &#39;decimal&#39;. An explicit conversation exists (are you missing a cast?)", "body": "<p>Simply convert to decimal would not resolve?</p>\n\n<pre><code>tax = Convert.ToDecimal(4867.50 + (70700 - 17400) * 0.15);\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5818205, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-r5qTKtcqL9U/AAAAAAAAAAI/AAAAAAAAAEA/LzqnHJzTANo/photo.jpg?sz=128", "display_name": "Matthew Hunt", "link": "https://stackoverflow.com/users/5818205/matthew-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7892, "favorite_count": 0, "closed_date": 1453326020, "accepted_answer_id": 34910919, "answer_count": 2, "score": 4, "last_activity_date": 1453325968, "creation_date": 1453325030, "question_id": 34910836, "link": "https://stackoverflow.com/questions/34910836/i-getting-this-error-cannot-implicitly-convert-type-double-to-decimal-an-e", "closed_reason": "Duplicate", "title": "I getting this error. Cannot implicitly convert type &#39;double&#39; to &#39;decimal&#39;. An explicit conversation exists (are you missing a cast?)", "body": "<p>I getting this error. Cannot implicitly convert type 'double' to 'decimal'. An explicit conversation exists (are you missing a cast?) I am a bit rusty on C#. have not done much for about two years </p>\n\n<p>I am to be writing this \nWrite a console application that calculates the amount of income tax required based on filing status and\ntaxable income.\nThe program should prompt the user to enter either a filing status of Single or Married (or Quit). If\nanything else is entered, an error message should be displayed and the input should be repeated.\nIf the status is either Single or Married, the taxable income is input and the amount of tax is printed.\nThis process should repeat until Quit is entered.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsApplication2\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n\n        }\n\n        private void gobutton_Click(object sender, EventArgs e)\n        {\n            decimal income  //hold income value\n            decimal tax     //hold tax value  \n\n            //get income value\n            income = int.Parse(textBox2.Text);\n\n\n            //Display the output ino the tax output label\n            taxoutputlabel.Text = tax;\n\n            if (textBox1.Text == \"single\")\n                if (income &lt;= 8700)\n                    tax = income * 0.10;\n                else if (income &lt;= 35350)\n                    tax = 4867.50 + (35350 - 8700) * 0.15;\n                else if (income &lt;= 85650)\n                    tax = 17442.50 + (85650 - 35350) * 0.25;\n                else if (income &lt;= 178650)\n                    tax = 43482.50 + (178650 - 85650) * 0.28;\n                else if (income &lt;= 388350)\n                    tax = 112683.50 + (388350 - 178650) * 0.35;\n            else if (textBox1.Text == \"marriage, married\")\n                if (income &lt;= 17400)\n                        tax = income * 0.10;\n                else if (income &lt;= 70700)\n                        tax = 4867.50 + (70700 - 17400) * 0.15;\n                else if (income &lt;= 142700)\n                        tax = 17442.50 + (142700 - 70700) * 0.25;\n                else if (income &lt;= 217450)\n                        tax = 43482.50 + (217450 -142700) * 0.28;\n                else if (income &lt;= 388350)\n                        tax = 112683.50 + (388350 - 178650) * 0.35;\n            else if (textBox1.Text == \"divorced\")\n                if (income &lt;= 8700)\n                    tax = income * 0.10;\n                else if (income &lt;= 35350)\n                    tax = 4867.50 + (35350 - 8700) * 0.15;\n                else if (income &lt;= 85650)\n                    tax = 17442.50 + (85650 - 35350) * 0.25;\n                else if (income &lt;= 178650)\n                    tax = 43482.50 + (178650 - 85650) * 0.28;\n                else if (income &lt;= 388350)\n                    tax = 112683.50 + (388350 - 178650) * 0.35;\n\n        }\n\n        private void exitbutton_Click(object sender, EventArgs e)\n        {\n            //closes form\n            this.Close();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "filehelpers"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 229942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/33c1f4162773cc51948f3b4eaca88b6c?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/229942/jeff"}, "edited": false, "score": 0, "creation_date": 1453471698, "post_id": 34928133, "comment_id": 57628582, "body": "Thanks shamp00! I don&#39;t use filehelpers enough to know that I could override and create my own converter. This is perfect, thanks."}], "tags": [], "owner": {"reputation": 10464, "user_id": 1077279, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5f2013394a5cd1c804eac4cfa3f3cd49?s=128&d=identicon&r=PG", "display_name": "shamp00", "link": "https://stackoverflow.com/users/1077279/shamp00"}, "is_accepted": true, "score": 1, "last_activity_date": 1453479446, "last_edit_date": 1453479446, "creation_date": 1453391203, "answer_id": 34928133, "question_id": 34910718, "link": "https://stackoverflow.com/questions/34910718/filehelpers-multiple-delimiters-in-each-row/34928133#34928133", "title": "Filehelpers: Multiple delimiters in each row?", "body": "<p>The <a href=\"https://stackoverflow.com/questions/34910718/filehelpers-multiple-delimiters-in-each-row\"><code>[FieldDelimiter]</code></a> attribute allows you to specify a different delimiter for a given field.</p>\n\n<p>Another way would be to write your own converter for the key value pairs.</p>\n\n<pre><code>public class KeyValuePairConverter : ConverterBase\n{\n    private String _KeyName;\n\n    public KeyValuePairConverter(String keyName)\n    {\n        // needs a parameter to get the export correct\n        _KeyName = keyName;\n    }\n\n    public override object StringToField(string from)\n    {\n        // return everything after the last equals\n        // (you could choose to validate the first part of the string against the _KeyName)\n        return from.Substring(from.LastIndexOf('=') + 1);;\n    }\n\n    public override string FieldToString(object fieldValue)\n    {\n        return String.Format(\"{0}={1}\", _KeyName, fieldValue);\n    }\n}\n</code></pre>\n\n<p>and then your field definitions would look like this</p>\n\n<pre><code>    [FieldConverter(typeof(KeyValuePairConverter), \"ItemID\")]\n    public String ItemID;\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 229942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/33c1f4162773cc51948f3b4eaca88b6c?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/229942/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 34928133, "answer_count": 1, "score": 0, "last_activity_date": 1453479529, "creation_date": 1453324632, "last_edit_date": 1453479529, "question_id": 34910718, "link": "https://stackoverflow.com/questions/34910718/filehelpers-multiple-delimiters-in-each-row", "title": "Filehelpers: Multiple delimiters in each row?", "body": "<p>Can <a href=\"http://www.filehelpers.net/\" rel=\"nofollow\">FileHelpers</a> parse into an object when there are multiple delimiters in each row of a file? Below is a sample row that I need to parse from a third party data provider using FileHelpers, if possible:</p>\n\n<pre><code>ItemID=1000|VerificationResult=ERROR|VerificationResultCode=-101|VerificationResultDetail=Duplicate ItemID|ProfileID=|ACHRouting=|ACHAccount=|LastFourCC=4444|InvoiceNo=731-021-36-572|DateTime=1/20/2016 1:04:30 PM|CustomField1=|CustomField2=\n</code></pre>\n\n<p>It would have been trivial with FileHelpers if the data provider had only used the pipe delimiter but as you see each key/value pair has an \"=\" between them then the pipe delimiter between each pair...sigh.</p>\n"}, {"tags": ["c#", "image", "label", "controls", "paint"], "comments": [{"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1453325232, "post_id": 34910672, "comment_id": 57557408, "body": "What are you targetting: Winforms? WPF? ASP? ...?? <b>Always</b> tag your question accordingly!"}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1453325325, "post_id": 34910672, "comment_id": 57557456, "body": "I see two ways to do this: Either by owner-drawing the whole Label or by adorning it with a second label that shows the icon. See here for an <a href=\"http://stackoverflow.com/questions/29756038/add-a-badge-to-a-c-sharp-winforms-control/29757940#29757940\">example</a> - Some measuring will be needed in both cases, see &#220;bercoder&#39;s answer!"}, {"owner": {"reputation": 136, "user_id": 1724489, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/bHARd.png?s=128&g=1", "display_name": "crait", "link": "https://stackoverflow.com/users/1724489/crait"}, "reply_to_user": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1453326309, "post_id": 34910672, "comment_id": 57557966, "body": "@TaW - I&#39;m sorry about that. Yes, it is Winforms!"}], "answers": [{"comments": [{"owner": {"reputation": 136, "user_id": 1724489, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/bHARd.png?s=128&g=1", "display_name": "crait", "link": "https://stackoverflow.com/users/1724489/crait"}, "edited": false, "score": 0, "creation_date": 1453326332, "post_id": 34910906, "comment_id": 57557979, "body": "I don&#39;t see any OnPaint event for Label controls. I only see the Paint event. Is that the one you mean? The steps that you have listed are pretty much the ones I expected, but I&#39;m not too sure where to start with the OnPaint event, like I said about."}, {"owner": {"reputation": 2784, "user_id": 2134198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/901oM.jpg?s=128&g=1", "display_name": "Jens Meinecke", "link": "https://stackoverflow.com/users/2134198/jens-meinecke"}, "reply_to_user": {"reputation": 136, "user_id": 1724489, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/bHARd.png?s=128&g=1", "display_name": "crait", "link": "https://stackoverflow.com/users/1724489/crait"}, "edited": false, "score": 0, "creation_date": 1453326883, "post_id": 34910906, "comment_id": 57558301, "body": "@crait - you can either use the Paint event, or your can override the OnPaint member function. I usually do the latter."}, {"owner": {"reputation": 136, "user_id": 1724489, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/bHARd.png?s=128&g=1", "display_name": "crait", "link": "https://stackoverflow.com/users/1724489/crait"}, "edited": false, "score": 0, "creation_date": 1453362437, "post_id": 34910906, "comment_id": 57570269, "body": "Like I said, I figured you&#39;d have to do that, but I don&#39;t know how to do that."}], "tags": [], "owner": {"reputation": 2784, "user_id": 2134198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/901oM.jpg?s=128&g=1", "display_name": "Jens Meinecke", "link": "https://stackoverflow.com/users/2134198/jens-meinecke"}, "is_accepted": false, "score": 0, "last_activity_date": 1453325266, "creation_date": 1453325266, "answer_id": 34910906, "question_id": 34910672, "link": "https://stackoverflow.com/questions/34910672/replace-text-in-label-with-inline-image-in-c/34910906#34910906", "title": "Replace Text in Label With Inline Image In C#", "body": "<p>This is not a trivial exercise.</p>\n\n<ol>\n<li>You'd have to provide a property on your derived label class to attach the image(s) to the text.</li>\n<li>Embed some sort of token(s) in the text to represent the image(s).</li>\n<li>In the OnPaint you have to parse the text for the token(s)</li>\n<li>Do a <code>graphics.MeasureString()</code> for each bit of text between the tokens. And then render it with <code>graphics.DrawString()</code> move to the right by the width of the text, render the image based on the token using one of the many <code>graphics.DrawImage()</code> overrides - move to the right by the width of the image and repeat.</li>\n</ol>\n"}], "owner": {"reputation": 136, "user_id": 1724489, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/bHARd.png?s=128&g=1", "display_name": "crait", "link": "https://stackoverflow.com/users/1724489/crait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570031215, "creation_date": 1453324482, "last_edit_date": 1592644375, "question_id": 34910672, "link": "https://stackoverflow.com/questions/34910672/replace-text-in-label-with-inline-image-in-c", "title": "Replace Text in Label With Inline Image In C#", "body": "<p>My program has several Label controls that are updated to have different text every so often. I have a few icons that I want to reference within the text. I figured that instead of just displaying &quot;<strong>(E)</strong>&quot; in the Label, there should be a way to replace that with the corresponding image that I have that looks like: <a href=\"https://i.stack.imgur.com/jPjsX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jPjsX.png\" alt=\"e\" /></a>. I figure that I need to override the Label.Paint event, but I'm not too sure how to do that properly. Every occurrence of &quot;<strong>(E)</strong>&quot; needs to be replaced with the image inline.</p>\n<h2>Example</h2>\n<p><em>Look for the (E) icon on the top.</em> \u2192 <strong>Look for the <a href=\"https://i.stack.imgur.com/jPjsX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jPjsX.png\" alt=\"e\" /></a> icon on the top.</strong></p>\n"}, {"tags": ["c#", "angularjs", "asp.net-mvc", "asp.net-mvc-5", "owin"], "comments": [{"owner": {"reputation": 1364, "user_id": 3585500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egUPp.jpg?s=128&g=1", "display_name": "ourmandave", "link": "https://stackoverflow.com/users/3585500/ourmandave"}, "edited": false, "score": 1, "creation_date": 1453341427, "post_id": 34910656, "comment_id": 57563448, "body": "This sounds like a long shot, but the <a href=\"http://stackoverflow.com/a/23372772/3585500\">VS2013 SPA template had the same kind of problem</a>. Maybe they copied the bogus templates into VS2015, so you need to update from NuGet?"}, {"owner": {"reputation": 119, "user_id": 2587942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/652557844/picture?type=large", "display_name": "&#201;tienne Brouillard", "link": "https://stackoverflow.com/users/2587942/%c3%89tienne-brouillard"}, "reply_to_user": {"reputation": 1364, "user_id": 3585500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egUPp.jpg?s=128&g=1", "display_name": "ourmandave", "link": "https://stackoverflow.com/users/3585500/ourmandave"}, "edited": false, "score": 0, "creation_date": 1453389564, "post_id": 34910656, "comment_id": 57588406, "body": "I get from the logs that it&#39;s an invalid client id that is sent in: Microsoft.Owin.Security.OAuth.OAuthAuthorizationServerMiddle&zwnj;&#8203;ware Error: 0 : clientID is not valid. This page (<a href=\"https://www.symbolsource.org/MyGet/Metadata/aspnetwebstacknightlyrelease/Project/Microsoft.Owin.Security.OAuth/2.1.0-rtw-30119-769-rel/Release/.NETFramework,Version%3Dv4.5/Microsoft.Owin.Security.OAuth/Microsoft.Owin.Security.OAuth/OAuthAuthorizationServerHandler.cs?ImageName=Microsoft.Owin.Security.OAuth\" rel=\"nofollow noreferrer\">symbolsource.org/MyGet/Metadata/aspnetwebstacknightlyreleas&zwnj;&#8203;e/&hellip;</a>) on symbol source does shot where the error is logged. What I need to know, the client id is compared against what?"}, {"owner": {"reputation": 258, "user_id": 892072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f5d91a74b4da2597700cecfe1d3be553?s=128&d=identicon&r=PG", "display_name": "Clayton Hyatt", "link": "https://stackoverflow.com/users/892072/clayton-hyatt"}, "edited": false, "score": 0, "creation_date": 1474990213, "post_id": 34910656, "comment_id": 66754774, "body": "@&#201;tienneBrouillard, Were you able to resolve this and if so, how? I&#39;m having the same issue and I need to get this working."}, {"owner": {"reputation": 119, "user_id": 2587942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/652557844/picture?type=large", "display_name": "&#201;tienne Brouillard", "link": "https://stackoverflow.com/users/2587942/%c3%89tienne-brouillard"}, "reply_to_user": {"reputation": 258, "user_id": 892072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f5d91a74b4da2597700cecfe1d3be553?s=128&d=identicon&r=PG", "display_name": "Clayton Hyatt", "link": "https://stackoverflow.com/users/892072/clayton-hyatt"}, "edited": false, "score": 0, "creation_date": 1474999589, "post_id": 34910656, "comment_id": 66760545, "body": "@ClaytonHyatt Hi, I never got around that and we resorted on using OAuth2 server on NodeJS for the sake of getting things running."}, {"owner": {"reputation": 258, "user_id": 892072, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f5d91a74b4da2597700cecfe1d3be553?s=128&d=identicon&r=PG", "display_name": "Clayton Hyatt", "link": "https://stackoverflow.com/users/892072/clayton-hyatt"}, "edited": false, "score": 0, "creation_date": 1474999868, "post_id": 34910656, "comment_id": 66760715, "body": "That&#39;a a bummer! Thanks for the response. ;)"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 2587942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/652557844/picture?type=large", "display_name": "&#201;tienne Brouillard", "link": "https://stackoverflow.com/users/2587942/%c3%89tienne-brouillard"}, "edited": false, "score": 0, "creation_date": 1453399047, "post_id": 34930728, "comment_id": 57594835, "body": "Yes I do get that. But let&#39;s just say the &quot;client&quot; doesn&#39;t want to change to ASP.Net 5 and the devs are stucked with this, it still needs resolution right?"}, {"owner": {"reputation": 13152, "user_id": 24975, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Dl8nC.jpg?s=128&g=1", "display_name": "Maxime Rouiller", "link": "https://stackoverflow.com/users/24975/maxime-rouiller"}, "reply_to_user": {"reputation": 119, "user_id": 2587942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/652557844/picture?type=large", "display_name": "&#201;tienne Brouillard", "link": "https://stackoverflow.com/users/2587942/%c3%89tienne-brouillard"}, "edited": false, "score": 0, "creation_date": 1453400236, "post_id": 34930728, "comment_id": 57595547, "body": "Katana has always been an experiment and never had any LTS planned for it. So... Microsoft will not fix because it was a &quot;developer preview&quot;. As for ASP.NET 5 RC1? I think there&#39;s a &quot;Go Live&quot; for it."}, {"owner": {"reputation": 13152, "user_id": 24975, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Dl8nC.jpg?s=128&g=1", "display_name": "Maxime Rouiller", "link": "https://stackoverflow.com/users/24975/maxime-rouiller"}, "reply_to_user": {"reputation": 119, "user_id": 2587942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/652557844/picture?type=large", "display_name": "&#201;tienne Brouillard", "link": "https://stackoverflow.com/users/2587942/%c3%89tienne-brouillard"}, "edited": false, "score": 0, "creation_date": 1453400450, "post_id": 34930728, "comment_id": 57595670, "body": "<a href=\"http://www.hanselman.com/blog/ASPNET5AndNETCoreRC1InContextPlusAllTheConnect2015News.aspx\" rel=\"nofollow noreferrer\">Relevant link</a> and quote: &quot;ASP.NET 5 RC1 is out with .NET Core and has a Go Live License.  This means you can go into production with ASP.NET 5 on Windows or Linux and Microsoft will support you.&quot;"}], "tags": [], "owner": {"reputation": 13152, "user_id": 24975, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/Dl8nC.jpg?s=128&g=1", "display_name": "Maxime Rouiller", "link": "https://stackoverflow.com/users/24975/maxime-rouiller"}, "is_accepted": false, "score": 0, "last_activity_date": 1453398287, "creation_date": 1453398287, "answer_id": 34930728, "question_id": 34910656, "link": "https://stackoverflow.com/questions/34910656/asp-net-mvc-5-spa-template-owin-token-results-in-invalid-client/34930728#34930728", "title": "ASP.Net MVC 5 SPA Template OWin /token results in &#39;invalid_client&#39;", "body": "<p>It seems that you are using <a href=\"/questions/tagged/katana\" class=\"post-tag\" title=\"show questions tagged &#39;katana&#39;\" rel=\"tag\">katana</a>.</p>\n\n<p>This is technically an obsolete technology and has been superseded by <a href=\"/questions/tagged/asp.net-5\" class=\"post-tag\" title=\"show questions tagged &#39;asp.net-5&#39;\" rel=\"tag\">asp.net-5</a>. </p>\n\n<p>I would recommend installing it from <a href=\"http://get.asp.net\" rel=\"nofollow\">http://get.asp.net</a> and trying it from there.</p>\n"}], "owner": {"reputation": 119, "user_id": 2587942, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/652557844/picture?type=large", "display_name": "&#201;tienne Brouillard", "link": "https://stackoverflow.com/users/2587942/%c3%89tienne-brouillard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463127596, "creation_date": 1453324435, "question_id": 34910656, "link": "https://stackoverflow.com/questions/34910656/asp-net-mvc-5-spa-template-owin-token-results-in-invalid-client", "title": "ASP.Net MVC 5 SPA Template OWin /token results in &#39;invalid_client&#39;", "body": "<p>In AngularJS and using Chrome Advanced REST Client I am trying to get the token using the 'password' grant_type from an ASP.Net MVC 5 SPA Visual Studio 2015 Template based project. The project is brand new with no modifications at all.</p>\n\n<p>The endpoint is called using this URL:\n<a href=\"http://localhost:55472/Token\" rel=\"nofollow\">http://localhost:55472/Token</a></p>\n\n<pre><code>[Headers]\nContent-Type: application/x-www-form-urlencoded\nAccept: application/json\n[Encoded Payload]\nData:=grant_type%3Dpassword%26username%3Db%40c.d%26password%3DPass123--%26client_id%3Dweb\n</code></pre>\n\n<p>And the result is this:</p>\n\n<pre><code>400 Bad Request\n{\"error\":\"invalid_client\"}\n</code></pre>\n\n<p>No external login is configured and the user registered using the template application.</p>\n\n<p>I tried different ways to construct the payload like this and got the same result:</p>\n\n<pre><code>[Encoded Payload]\ngrant_type=password&amp;username=b%40c.d&amp;password=Pass123--&amp;client_id=web\n</code></pre>\n\n<p>So out of this, it might be the client is not calling the endpoint properly:</p>\n\n<pre><code>var _tokenPath = '/Token';\nvar data = 'grant_type=password&amp;username=b@c.d&amp;password=Pass123--&amp;client_id=web;\n$http.post(_tokenPath, data, { headers: { 'Content-Type': 'application/x-www-form-urlencoded' } }).then(\n        function (response) {\n            debugger;\n            console.log(response);\n        },\n        function (error) {\n            debugger;\n            console.log(error);\n        }\n    )\n</code></pre>\n\n<p>Or there's something not right in the Startup.Auth.cs file which prevents the endpoint from working properly.</p>\n\n<p>How do we get the /Token url working out of the box on the SPA Template for MVC5?\nThanks for your help!</p>\n"}, {"tags": ["c#", "linq", "automapper"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453324914, "post_id": 34910641, "comment_id": 57557219, "body": "Can you show the <code>ParentEntity</code> class?"}, {"owner": {"reputation": 4383, "user_id": 262123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lmTAL.png?s=128&g=1", "display_name": "Pathoschild", "link": "https://stackoverflow.com/users/262123/pathoschild"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453326477, "post_id": 34910641, "comment_id": 57558082, "body": "@YacoubMassad let&#39;s assume <code>ParentEntity</code> looks just like <code>Parent</code> (with a <code>ChildEntity Value</code> property), so we can automap it by convention. The actual models are more complicated and use mapping expressions, but not in a way that affects the question."}], "answers": [{"tags": [], "owner": {"reputation": 18484, "user_id": 5112433, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/UWv9h.jpg?s=128&g=1", "display_name": "Ilya Chumakov", "link": "https://stackoverflow.com/users/5112433/ilya-chumakov"}, "is_accepted": false, "score": 1, "last_activity_date": 1453328667, "creation_date": 1453328667, "answer_id": 34911805, "question_id": 34910641, "link": "https://stackoverflow.com/questions/34910641/override-resolved-property-type-with-automapper/34911805#34911805", "title": "Override resolved property type with AutoMapper", "body": "<p>You may re-assign new object manually after mapping:</p>\n\n<pre><code>Mapper.CreateMap&lt;ParentEntity, Parent&gt;()\n    .AfterMap((src, dest) =&gt; dest.Value =  new DerivedChild(){...});\n</code></pre>\n\n<p>or even re-map it:</p>\n\n<pre><code>   .AfterMap((src, dest) =&gt; dest.Value = Mapper.Map&lt;DerivedChild&gt;(dest.Value));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 4383, "user_id": 262123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lmTAL.png?s=128&g=1", "display_name": "Pathoschild", "link": "https://stackoverflow.com/users/262123/pathoschild"}, "edited": false, "score": 0, "creation_date": 1453330503, "post_id": 34911903, "comment_id": 57560044, "body": "I am glad I could help"}], "tags": [], "owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "is_accepted": true, "score": 1, "last_activity_date": 1453329085, "creation_date": 1453329085, "answer_id": 34911903, "question_id": 34910641, "link": "https://stackoverflow.com/questions/34910641/override-resolved-property-type-with-automapper/34911903#34911903", "title": "Override resolved property type with AutoMapper", "body": "<p>Here is one way to do it:</p>\n\n<pre><code>map.CreateMap&lt;ChildEntity, DerivedChild&gt;();\n\nmap.CreateMap&lt;ParentEntity, Parent&gt;()\n    .ForMember(\n        x =&gt; x.Value,\n        opt =&gt; opt.ResolveUsing(\n            rr =&gt; map.Map&lt;DerivedChild&gt;(((ParentEntity)rr.Context.SourceValue).Value)));\n</code></pre>\n\n<p><code>ResolveUsing</code> allows to specify custom logic for mapping the value.</p>\n\n<p>The custom logic that is used here is actually calling <code>map.Map</code> to map to <code>DerivedChild</code>.</p>\n"}], "owner": {"reputation": 4383, "user_id": 262123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lmTAL.png?s=128&g=1", "display_name": "Pathoschild", "link": "https://stackoverflow.com/users/262123/pathoschild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 34911903, "answer_count": 2, "score": 3, "last_activity_date": 1453329085, "creation_date": 1453324398, "question_id": 34910641, "link": "https://stackoverflow.com/questions/34910641/override-resolved-property-type-with-automapper", "title": "Override resolved property type with AutoMapper", "body": "<p>With AutoMapper, can I override the resolved type for a property? For example, given these classes:</p>\n\n<pre><code>public class Parent\n{\n    public Child Value { get; set; }\n}\n\npublic class Child { ... }\npublic class DerivedChild : Child { ... }\n</code></pre>\n\n<p>Can I configure AutoMapper to automap the <code>Child Value</code> property with a <code>DerivedChild</code> instance? The hypothetical mapping would look something like this:</p>\n\n<pre><code>map.CreateMap&lt;ChildEntity, DerivedChild&gt;();\nmap.CreateMap&lt;ParentEntity, Parent&gt;()\n   .ForMember(p =&gt; p.Value, p =&gt; p.UseDestinationType&lt;DerivedChild&gt;());\n</code></pre>\n\n<p>(I'm <a href=\"https://github.com/AutoMapper/AutoMapper/wiki/Queryable-Extensions\" rel=\"nofollow\">projecting from LINQ entities</a>. The closest I could find is using a <a href=\"https://github.com/AutoMapper/AutoMapper/wiki/Custom-type-converters\" rel=\"nofollow\">custom type converter</a>, but it looks like I'd need to override the <em>entire</em> mapping.)</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "url", "routing"], "comments": [{"owner": {"reputation": 374, "user_id": 3234202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87498eab69ea741ce8a9d69e7e15ba34?s=128&d=identicon&r=PG", "display_name": "Mat Hellums", "link": "https://stackoverflow.com/users/3234202/mat-hellums"}, "edited": false, "score": 0, "creation_date": 1453337151, "post_id": 34910608, "comment_id": 57562279, "body": "What does your razor action look like?"}, {"owner": {"reputation": 915, "user_id": 5812435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fc94225678c6426df78425f1555d04?s=128&d=identicon&r=PG", "display_name": "Chase", "link": "https://stackoverflow.com/users/5812435/chase"}, "edited": false, "score": 0, "creation_date": 1453337800, "post_id": 34910608, "comment_id": 57562466, "body": "You might try changing the order of your mapped routes by putting the &quot;Default&quot; route before the &quot;Design-Fancy&quot; and &quot;Design-Simple&quot; routes, since routes that are mapped first have higher precedence. However, this might break the normal behavior of your Fancy and Simple routes."}, {"owner": {"reputation": 1205, "user_id": 2021860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62e1bfbf2358b24963407127e344a759?s=128&d=identicon&r=PG", "display_name": "RoteS", "link": "https://stackoverflow.com/users/2021860/rotes"}, "edited": false, "score": 0, "creation_date": 1453361191, "post_id": 34910608, "comment_id": 57569628, "body": "<a href=\"https://www.packtpub.com/books/content/mixing-aspnet-webforms-and-aspnet-mvc\" rel=\"nofollow noreferrer\">packtpub.com/books/content/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 3314553, "user_type": "registered", "profile_image": "https://graph.facebook.com/624322094/picture?type=large", "display_name": "user3314553", "link": "https://stackoverflow.com/users/3314553/user3314553"}, "edited": false, "score": 0, "creation_date": 1453399731, "post_id": 34910608, "comment_id": 57595249, "body": "Changing the order of the routes registrations did fix the Razor action links. And the links to the .aspx pages is still at least functional. However, They don&#39;t end up as friendly URLs in this case (as displayed in the address bar of the browser). I get: <a href=\"http://domain.tld/Design/example10.aspx\" rel=\"nofollow noreferrer\">domain.tld/Design/example10.aspx</a> for the .aspx page. I&#39;m trying to figure out how to keep friendly URLs for all. So, thanks RoteS... this was a partial answer."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 3314553, "user_type": "registered", "profile_image": "https://graph.facebook.com/624322094/picture?type=large", "display_name": "user3314553", "link": "https://stackoverflow.com/users/3314553/user3314553"}, "is_accepted": false, "score": 0, "last_activity_date": 1453405401, "creation_date": 1453405401, "answer_id": 34932883, "question_id": 34910608, "link": "https://stackoverflow.com/questions/34910608/mixing-asp-net-and-mvc-routing/34932883#34932883", "title": "Mixing ASP.NET and MVC routing", "body": "<p>Here is the solution I settled on. I installed the NuGet Microsoft.AspNet.FriendlyUrls package. Then I named the .aspx page with a page name that would look good without the extension. Then I set up the routing as follows:     </p>\n\n<pre><code>\n    public static void RegisterRoutes(RouteCollection routes)\n    {\n        FriendlyUrlSettings aspxSettings = new FriendlyUrlSettings();\n        aspxSettings.AutoRedirectMode = RedirectMode.Off;  // default=Off\n        routes.EnableFriendlyUrls(aspxSettings);\n\n        routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n        routes.MapRoute(\n            name: \"Default\",\n            url: \"{controller}/{action}/{id}\",\n            defaults: new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional } \n        );\n\n        routes.MapPageRoute(\"Design-Fancy\", \"Design/Fancy/{*queryvalues}\", \"~/Design/Fancy.aspx\", true);\n        routes.MapPageRoute(\"Design-Simple\", \"Design/Simple/{*queryvalues}\", \"~/Design/Simple.aspx\", true);\n    } \n</code></pre>\n\n<p>This gives the effect I wanted, and works with my MVC routing, and results in routing to .aspx pages while removing the .aspx extension.</p>\n"}], "owner": {"reputation": 51, "user_id": 3314553, "user_type": "registered", "profile_image": "https://graph.facebook.com/624322094/picture?type=large", "display_name": "user3314553", "link": "https://stackoverflow.com/users/3314553/user3314553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 562, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1453405401, "creation_date": 1453324298, "last_edit_date": 1453332489, "question_id": 34910608, "link": "https://stackoverflow.com/questions/34910608/mixing-asp-net-and-mvc-routing", "title": "Mixing ASP.NET and MVC routing", "body": "<p>I thought I could have friendly URLs for all routes in my mixed ASP.NET + MVC application, but it is not working as I expect. Here is my routing definition setup:</p>\n\n<pre><code>public static void RegisterRoutes(RouteCollection routes)\n{\n    routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n    routes.MapPageRoute(\"Design-Fancy\", \"Design/Fancy/{*queryvalues}\", \"~/Design/example10.aspx\", true);\n    routes.MapPageRoute(\"Design-Simple\", \"Design/Simple/{*queryvalues}\", \"~/Design/example5.aspx\", true);\n\n    routes.MapRoute(\n        name: \"Default\",\n        url: \"{controller}/{action}/{id}\",\n        defaults: new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional } \n    );\n}\n</code></pre>\n\n<p>While this works to route to the *.aspx pages, Any Razor action tags on the same page that are defined for example as \"Home\" for the controller and \"About\" for the Action actually are rendered in the page source as '<a href=\"http://..../Design/Fancy?action=About&amp;controller=Home\" rel=\"nofollow\">http://..../Design/Fancy?action=About&amp;controller=Home</a>'. So, this breaks all the navigation menu URLs, etc. I must be doing it wrongly!</p>\n"}, {"tags": ["c#", "windows", "forms", "service", "isolatedstorage"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453324452, "post_id": 34910571, "comment_id": 57556956, "body": "Did you debug the service to verify that <code>OnCustomCommand</code> was executed?"}, {"owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453326501, "post_id": 34910571, "comment_id": 57558096, "body": "@YacoubMassad I put a break point on that method and when I click the button nothing seems to happen"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453326582, "post_id": 34910571, "comment_id": 57558142, "body": "Are you sure that <code>sc.ExecuteCommand(128)</code> was executed? I see an <code>if</code> statement there."}, {"owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453327125, "post_id": 34910571, "comment_id": 57558445, "body": "@YacoubMassad the <code>if</code> statement executes because it is able to return true for the user but <code>sc.ExecuteCommand(128)</code> does not do anything. The code I have written it should be able to reach the <code>switch</code> in the service."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "edited": false, "score": 0, "creation_date": 1453332245, "post_id": 34912498, "comment_id": 57560706, "body": "Yes I see that the methods are executing. Why is the switch not executing and putting the file into isolated storage."}], "tags": [], "owner": {"reputation": 29509, "user_id": 371637, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/y4ryl.png?s=128&g=1", "display_name": "Adam Tuliper - MSFT", "link": "https://stackoverflow.com/users/371637/adam-tuliper-msft"}, "is_accepted": true, "score": 1, "last_activity_date": 1453332760, "last_edit_date": 1453332760, "creation_date": 1453331780, "answer_id": 34912498, "question_id": 34910571, "link": "https://stackoverflow.com/questions/34910571/sending-custom-commands-to-a-service-using-windows-form/34912498#34912498", "title": "Sending custom commands to a service using windows form", "body": "<p>This worked just fine for me so I surmise its your code not hitting the call to execute the command. I took your code, made it a bit easier. </p>\n\n<p>For example - stripping out all the stuff above - this code below worked and the text file appeared with the \"Command Received\" in it.</p>\n\n<p>In your case it could be that you aren't closing the file. Try this:</p>\n\n<pre>\nusing (\n    IsolatedStorageFile isoFile =\n        IsolatedStorageFile.GetStore(\n            IsolatedStorageScope.User | IsolatedStorageScope.Domain | IsolatedStorageScope.Assembly,\n            null, null))\n{\n    IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream(\"LaptopInfo.txt\",\n        FileMode.Append, FileAccess.Write, isoFile);\n    using (StreamWriter writer = new StreamWriter(isoStream))\n    {\n        writer.WriteLine(\"Data\");\n    }\n    WriteServiceInfo(\"data written to isolated storage\");\n    isoFile.Close();\n}\n</pre>\n\n<p>I changed the submit button to simply send the command, I'd suggest the same</p>\n\n<pre>\nprivate void btnSubmit_Click(object sender, EventArgs e)\n{\n     sc.ExecuteCommand(128);\n}\n</pre>\n\n<p>Service code is as follows</p>\n\n<pre>\nusing System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Diagnostics;\nusing System.IO;\nusing System.IO.IsolatedStorage;\nusing System.Linq;\nusing System.ServiceProcess;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace Project2Service\n{\n    public partial class Service1 : ServiceBase\n    {\n        public enum ServiceCustomCommands { Command1 = 128, Command2 = 129 };\n        //private IsolatedStorageScope iso;\n\n        public Service1()\n        {\n            InitializeComponent();\n        }\n\n        protected override void OnStart(string[] args)\n        {\n            WriteServiceInfo(\"Service Started!\");\n        }\n\n        // This event is raised when a file is changed\n        private void Watcher_Changed(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Changed!\");\n        }\n\n        private void Watcher_Created(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Created!\");\n        }\n\n        private void Watcher_Deleted(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Deleted!\");\n        }\n        private void Watcher_Renamed(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Renamed!\");\n        }\n\n        private void WriteServiceInfo(string info)\n        {\n            FileStream fs = new FileStream(@\"C:\\Users\\Adam\\Desktop\\WindowsServiceLog.txt\",\n                                 FileMode.OpenOrCreate, FileAccess.Write);\n            StreamWriter m_streamWriter = new StreamWriter(fs);\n            m_streamWriter.BaseStream.Seek(0, SeekOrigin.End);\n            m_streamWriter.WriteLine(info + \"\\n\");\n            m_streamWriter.Flush();\n            m_streamWriter.Close();\n        }\n\n        protected override void OnStop()\n        {\n            WriteServiceInfo(\"Service Stopped!\");\n\n        }\n\n        protected override void OnCustomCommand(int command)\n        {\n\n            WriteServiceInfo(\"Command received\");\n            switch ((ServiceCustomCommands)command)\n            {\n                case ServiceCustomCommands.Command1:\n                    //Command1 Implementation\n                    IsolatedStorageFile isoFile = IsolatedStorageFile.GetStore(IsolatedStorageScope.User | IsolatedStorageScope.Domain | IsolatedStorageScope.Assembly, null, null);\n                    IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream(\"LaptopInfo.txt\", FileMode.Append, FileAccess.Write, isoFile);\n                    using (StreamWriter writer = new StreamWriter(isoStream))\n                    {\n                        writer.WriteLine(\"Data\");\n                    }\n                    //iso = IsolatedStorageScope.User;\n                    break;\n                case ServiceCustomCommands.Command2:\n                    //iso = IsolatedStorageScope.User | IsolatedStorageScope.Assembly;\n                    break;\n                default:\n                    break;\n\n            }\n        }\n    }\n}\n</pre>\n"}], "owner": {"reputation": 167, "user_id": 3557664, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1807659384/picture?type=large", "display_name": "Martin Hoban", "link": "https://stackoverflow.com/users/3557664/martin-hoban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 34912498, "answer_count": 1, "score": 0, "last_activity_date": 1453332760, "creation_date": 1453324164, "question_id": 34910571, "link": "https://stackoverflow.com/questions/34910571/sending-custom-commands-to-a-service-using-windows-form", "title": "Sending custom commands to a service using windows form", "body": "<p>I am trying to send custom commands to a service using a windows form. The command I am trying to send is trying to place a file in Isolated Storage. Below is my source code.</p>\n\n<p><strong>Form</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.ServiceProcess;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing Project2Service;\n\nnamespace Project2\n{\n    public partial class Form1 : Form\n    {\n        public Service1 s = new Service1();\n        public ServiceInstaller si = new ServiceInstaller();\n        public ProjectInstaller pi = new ProjectInstaller();\n        public ServiceController sc = new ServiceController(\"Project2Service\");\n\n        private string[] isoType;\n\n        string machineName = System.Windows.Forms.SystemInformation.ComputerName;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            isoType = new string[] { \"User\", \"Assembly And Domain\"};\n            cboIsoType.Items.AddRange(isoType);\n\n            cboIsoType.SelectedIndex = 0;\n\n            btnContinue.Enabled = false;\n            btnPause.Enabled = false;\n            btnStop.Enabled = false;\n        }\n\n        public void Labels()\n        {\n            lblMachine.Text = machineName;\n            lblSName.Text = s.ServiceName;\n            lblSType.Text = si.StartType.ToString();\n\n            lblSStatus.Text = sc.Status.ToString();\n            lblPause.Text = sc.CanPauseAndContinue.ToString();\n            lblShutdown.Text = sc.CanShutdown.ToString();\n            lblStop.Text = sc.CanStop.ToString();\n        }\n\n        private void btnStart_Click(object sender, EventArgs e)\n        {\n            //Controller.Refresh(); //Gets the current status of service\n            //if (Controller.Status == ServiceControllerStatus.Stopped)\n            //{\n            //    Controller.Start();\n            //}\n\n            sc.Start();\n            sc.WaitForStatus(ServiceControllerStatus.Running);\n            Labels();\n\n            btnStart.Enabled = false;\n            btnContinue.Enabled = false;\n            btnStop.Enabled = true;\n            btnPause.Enabled = true;\n\n        }\n\n        private void btnStop_Click(object sender, EventArgs e)\n        {\n            sc.Stop();\n            sc.WaitForStatus(ServiceControllerStatus.Stopped);\n            Labels();\n\n            btnStart.Enabled = true;\n            btnContinue.Enabled = false;\n            btnPause.Enabled = false;\n            btnStop.Enabled = false;\n        }\n\n        private void btnPause_Click(object sender, EventArgs e)\n        {\n            sc.Pause();\n            sc.WaitForStatus(ServiceControllerStatus.Paused);\n            Labels();\n\n            btnPause.Enabled = false;\n            btnContinue.Enabled = true;\n            btnStart.Enabled = false;\n            btnStop.Enabled = true;\n        }\n\n        private void btnContinue_Click(object sender, EventArgs e)\n        {\n            sc.Continue();\n            sc.WaitForStatus(ServiceControllerStatus.Running);\n            Labels();\n\n            btnStop.Enabled = true;\n            btnStart.Enabled = false;\n            btnPause.Enabled = true;\n            btnContinue.Enabled = false;\n        }\n\n        private void btnSubmit_Click(object sender, EventArgs e)\n        {  \n            if (cboIsoType.SelectedItem.ToString() == \"User\")   \n            {\n\n                sc.ExecuteCommand(128);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Service</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Diagnostics;\nusing System.IO;\nusing System.IO.IsolatedStorage;\nusing System.Linq;\nusing System.ServiceProcess;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace Project2Service\n{\n    public partial class Service1 : ServiceBase\n    {\n        public enum ServiceCustomCommands { Command1 = 128, Command2 = 129 };\n        //private IsolatedStorageScope iso;\n\n        public Service1()\n        {\n            InitializeComponent();\n        }\n\n        protected override void OnStart(string[] args)\n        {\n\n            //iso = IsolatedStorageScope.User | IsolatedStorageScope.Domain;\n            FileSystemWatcher Watcher = new FileSystemWatcher(@\"C:\\Users\\Martin\\Desktop\\Project2\\ServiceTest\");\n            Watcher.EnableRaisingEvents = true;\n            Watcher.NotifyFilter = NotifyFilters.LastAccess\n                        | NotifyFilters.LastWrite\n                        | NotifyFilters.FileName\n                        | NotifyFilters.DirectoryName;\n\n            Watcher.Changed += new FileSystemEventHandler(Watcher_Changed);\n            Watcher.Created += new FileSystemEventHandler(Watcher_Created);\n            Watcher.Deleted += new FileSystemEventHandler(Watcher_Deleted);\n            Watcher.Renamed += new RenamedEventHandler(Watcher_Renamed);\n            WriteServiceInfo(\"Service Started!\");\n        }\n\n        // This event is raised when a file is changed\n        private void Watcher_Changed(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Changed!\");\n\n            DirectoryInfo d = new DirectoryInfo(@\"C:\\Users\\Martin\\Desktop\\Project2\\ServiceTest\");//Assuming Watch is your Folder\n            FileInfo[] Files = d.GetFiles(\"*.txt\"); //Getting Text files\n            string str = \"\";\n            foreach (FileInfo file in Files)\n            {\n                str = str + \", \" + file.Name;\n                str = str + \", \" + file.LastWriteTime;\n                str = str + \", \" + file.CreationTime;\n                str = str + \", \" + file.Length;\n\n                WriteServiceInfo(file.Name);\n                WriteServiceInfo(file.LastWriteTime.ToString());\n                WriteServiceInfo(file.CreationTime.ToString());\n                WriteServiceInfo(file.Length.ToString());\n            }\n        }\n\n        private void Watcher_Created(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Created!\");\n        }\n\n        private void Watcher_Deleted(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Deleted!\");\n        }\n        private void Watcher_Renamed(object sender, FileSystemEventArgs e)\n        {\n            WriteServiceInfo(\"File Renamed!\");\n        }\n\n        private void WriteServiceInfo(string info)\n        {\n            FileStream fs = new FileStream(@\"C:\\Users\\Martin\\Desktop\\Project2\\WindowsServiceLog.txt\",\n                                 FileMode.OpenOrCreate, FileAccess.Write);\n            StreamWriter m_streamWriter = new StreamWriter(fs);\n            m_streamWriter.BaseStream.Seek(0, SeekOrigin.End);\n            m_streamWriter.WriteLine(info + \"\\n\");\n            m_streamWriter.Flush();\n            m_streamWriter.Close();\n        }\n\n        protected override void OnStop()\n        {\n            WriteServiceInfo(\"Service Stopped!\");\n\n        }\n\n        protected override void OnCustomCommand(int command)\n        {\n\n\n            switch ((ServiceCustomCommands)command)\n            {\n                case ServiceCustomCommands.Command1:\n                    //Command1 Implementation\n                    IsolatedStorageFile isoFile = IsolatedStorageFile.GetStore(IsolatedStorageScope.User | IsolatedStorageScope.Domain | IsolatedStorageScope.Assembly, null, null);\n                    IsolatedStorageFileStream isoStream = new IsolatedStorageFileStream(\"LaptopInfo.txt\", FileMode.Append, FileAccess.Write, isoFile);\n                    using (StreamWriter writer = new StreamWriter(isoStream))\n                    {\n                        writer.WriteLine(\"Data\");\n                    }\n                    //iso = IsolatedStorageScope.User;\n                    break;\n                case ServiceCustomCommands.Command2:\n                    //iso = IsolatedStorageScope.User | IsolatedStorageScope.Assembly;\n                    break;\n                default:\n                    break;\n\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>sc.ExecuteCommand(128); in the submit button method does not seem to fire.</p>\n"}, {"tags": ["c#", "visual-studio", "visual-studio-2015"], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 5534263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/abb02fd2128a98cc4e4b0902078583c6?s=128&d=identicon&r=PG", "display_name": "user5534263", "link": "https://stackoverflow.com/users/5534263/user5534263"}, "edited": false, "score": 0, "creation_date": 1453739598, "post_id": 34911222, "comment_id": 57723084, "body": "Yes this folder is under git. Should I be fixing my git settings? If so what should I look for?"}, {"owner": {"reputation": 76, "user_id": 4629928, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YbXPhRzYYXU/AAAAAAAAAAI/AAAAAAAAIgI/mcjTd8LSzHc/photo.jpg?sz=128", "display_name": "Daniel McMullen", "link": "https://stackoverflow.com/users/4629928/daniel-mcmullen"}, "reply_to_user": {"reputation": 118, "user_id": 5534263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/abb02fd2128a98cc4e4b0902078583c6?s=128&d=identicon&r=PG", "display_name": "user5534263", "link": "https://stackoverflow.com/users/5534263/user5534263"}, "edited": false, "score": 0, "creation_date": 1454515402, "post_id": 34911222, "comment_id": 58080689, "body": "If you&#39;re using git I don&#39;t think this is your issue. I have know others like TFS to lock files until they see it as being checked out, but git should let you edit and save at your leisure.  If you have the solution project file open elsewhere, such as in a text editor, that may also cause it to not save."}], "tags": [], "owner": {"reputation": 76, "user_id": 4629928, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YbXPhRzYYXU/AAAAAAAAAAI/AAAAAAAAIgI/mcjTd8LSzHc/photo.jpg?sz=128", "display_name": "Daniel McMullen", "link": "https://stackoverflow.com/users/4629928/daniel-mcmullen"}, "is_accepted": false, "score": 0, "last_activity_date": 1453326359, "creation_date": 1453326359, "answer_id": 34911222, "question_id": 34910516, "link": "https://stackoverflow.com/questions/34910516/projects-disappear-from-vs-2015-solution-after-reopening/34911222#34911222", "title": "projects disappear from VS 2015 solution after reopening", "body": "<p>It sounds like you are having issues with write permissions in your solution. Is the folder your solution is in under any type of source control?</p>\n\n<p>Try creating a new folder at the root of your harddrive. Something like c:\\testsolution\nCopy your project files there and then try adding you solution file again.</p>\n\n<p>Good luck.</p>\n"}, {"tags": [], "owner": {"reputation": 3197, "user_id": 331325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C5mYW.jpg?s=128&g=1", "display_name": "Imre P&#252;hvel", "link": "https://stackoverflow.com/users/331325/imre-p%c3%bchvel"}, "is_accepted": false, "score": 0, "last_activity_date": 1453327574, "creation_date": 1453327574, "answer_id": 34911554, "question_id": 34910516, "link": "https://stackoverflow.com/questions/34910516/projects-disappear-from-vs-2015-solution-after-reopening/34911554#34911554", "title": "projects disappear from VS 2015 solution after reopening", "body": "<p>Most likely this is an issue with not saving the changes to VS solution file.</p>\n\n<p>Before closing Visual Studio, take an extra step to make sure all changes are actually saved  (File-> Save All). Then manually verify that all your projects successfully made it to the solution file by opening the solution file with a text editor. If you don't see your projects listed, try editing the file yourself to verify you have the necessary permissions.</p>\n"}], "owner": {"reputation": 118, "user_id": 5534263, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/abb02fd2128a98cc4e4b0902078583c6?s=128&d=identicon&r=PG", "display_name": "user5534263", "link": "https://stackoverflow.com/users/5534263/user5534263"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1200, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1453327574, "creation_date": 1453323971, "question_id": 34910516, "link": "https://stackoverflow.com/questions/34910516/projects-disappear-from-vs-2015-solution-after-reopening", "title": "projects disappear from VS 2015 solution after reopening", "body": "<p>I have a weird problem with my C# solution file. I noticed that my .sln file itself was missing. So I created an empty .sln file, added my Existing projects to it, built and it worked fine. When I close and reopen Visual Studio, the .sln file I created is there but projects added to the solution have disappeared. How to fix this?</p>\n"}, {"tags": ["c#", ".net", "wcf", ".net-4.5", ".net-4.6"], "answers": [{"tags": [], "owner": {"reputation": 5441, "user_id": 217415, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7e97db74e2b8a823c2ae35488465e186?s=128&d=identicon&r=PG", "display_name": "BrandonAGr", "link": "https://stackoverflow.com/users/217415/brandonagr"}, "is_accepted": true, "score": 18, "last_activity_date": 1453341599, "last_edit_date": 1495542746, "creation_date": 1453341599, "answer_id": 34914106, "question_id": 34910373, "link": "https://stackoverflow.com/questions/34910373/wcf-sslstreamsecurity-dns-identity-check-failing-for-just-4-6-framework/34914106#34914106", "title": "WCF SslStreamSecurity DNS Identity Check failing for just 4.6 framework", "body": "<p>I needed to look at <a href=\"https://msdn.microsoft.com/en-us/library/mt620031(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Retargetting Changes in the .NET Framework 4.6.1</a>, as certificate validation logic changed in that release. (<a href=\"https://msdn.microsoft.com/en-us/library/mt620030(v=vs.110).aspx\" rel=\"nofollow noreferrer\">change in behavior for X509CertificateClaimSet.FindClaims</a> that was causing my issue)</p>\n\n<p>The fix is editing my app.config to add:</p>\n\n<pre><code>&lt;runtime&gt;\n    &lt;AppContextSwitchOverrides value=\"Switch.System.IdentityModel.DisableMultipleDNSEntriesInSANCertificate=true\" /&gt; \n&lt;/runtime&gt;\n</code></pre>\n\n<p>You can see the <a href=\"http://referencesource.microsoft.com/#System.IdentityModel/System/IdentityModel/Claims/X509CertificateClaimSet.cs,262\" rel=\"nofollow noreferrer\">changed code on referencesource</a>, and naturally makecert.exe doesn't appear to support <a href=\"https://stackoverflow.com/questions/6383054/add-or-create-subject-alternative-name-field-to-self-signed-certificate-using\">generating certificates with \"Subject Alternative Name\" fields</a></p>\n"}, {"tags": [], "owner": {"reputation": 1133, "user_id": 1060468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab99ee9cf4bfd7ebc1957f08b4125b6e?s=128&d=identicon&r=PG", "display_name": "Brent Schmaltz", "link": "https://stackoverflow.com/users/1060468/brent-schmaltz"}, "is_accepted": false, "score": 1, "last_activity_date": 1453935145, "creation_date": 1453935145, "answer_id": 35049685, "question_id": 34910373, "link": "https://stackoverflow.com/questions/34910373/wcf-sslstreamsecurity-dns-identity-check-failing-for-just-4-6-framework/35049685#35049685", "title": "WCF SslStreamSecurity DNS Identity Check failing for just 4.6 framework", "body": "<p>Brandon.</p>\n\n<p>It appears that if the flag is 'false' AND a cert does NOT contain SAN entries, we don't add the dns entry.</p>\n"}, {"comments": [{"owner": {"reputation": 3385, "user_id": 648738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b83ce7fa50380a35f5526800b47e218?s=128&d=identicon&r=PG", "display_name": "Jazaret", "link": "https://stackoverflow.com/users/648738/jazaret"}, "edited": false, "score": 1, "creation_date": 1475091201, "post_id": 38724972, "comment_id": 66808171, "body": "For some reason this worked and the app.config change did not."}, {"owner": {"reputation": 469, "user_id": 175662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1fe118860639c28702a74f559881d51?s=128&d=identicon&r=PG", "display_name": "erlingormar", "link": "https://stackoverflow.com/users/175662/erlingormar"}, "edited": false, "score": 1, "creation_date": 1479299082, "post_id": 38724972, "comment_id": 68496621, "body": "I&#39;m experiencing the same thing. I set the switch in web.config&#39;s <code>runtime</code> section, but it doesn&#39;t get applied. Setting it in code works, though (and fixes the problem for me). I don&#39;t have a solution to this at the time being... just thought I&#39;d chime in."}], "tags": [], "owner": {"reputation": 41, "user_id": 3724100, "user_type": "registered", "profile_image": "https://graph.facebook.com/1101879094/picture?type=large", "display_name": "cperezcali", "link": "https://stackoverflow.com/users/3724100/cperezcali"}, "is_accepted": false, "score": 4, "last_activity_date": 1470152481, "creation_date": 1470152481, "answer_id": 38724972, "question_id": 34910373, "link": "https://stackoverflow.com/questions/34910373/wcf-sslstreamsecurity-dns-identity-check-failing-for-just-4-6-framework/38724972#38724972", "title": "WCF SslStreamSecurity DNS Identity Check failing for just 4.6 framework", "body": "<p>You can fix in code adding one line.</p>\n\n<p>like this.</p>\n\n<pre><code>        AppContext.SetSwitch(\"Switch.System.IdentityModel.DisableMultipleDNSEntriesInSANCertificate\",true);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 606, "user_id": 1084022, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a700605c59339936dfe5181a7f62c41a?s=128&d=identicon&r=PG", "display_name": "slinzerthegod", "link": "https://stackoverflow.com/users/1084022/slinzerthegod"}, "is_accepted": false, "score": 2, "last_activity_date": 1506586285, "creation_date": 1506586285, "answer_id": 46464117, "question_id": 34910373, "link": "https://stackoverflow.com/questions/34910373/wcf-sslstreamsecurity-dns-identity-check-failing-for-just-4-6-framework/46464117#46464117", "title": "WCF SslStreamSecurity DNS Identity Check failing for just 4.6 framework", "body": "<p>Installing .net 4.7 on the server solved the problem for me.</p>\n"}], "owner": {"reputation": 5441, "user_id": 217415, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7e97db74e2b8a823c2ae35488465e186?s=128&d=identicon&r=PG", "display_name": "BrandonAGr", "link": "https://stackoverflow.com/users/217415/brandonagr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5745, "favorite_count": 4, "accepted_answer_id": 34914106, "answer_count": 4, "score": 11, "last_activity_date": 1506586285, "creation_date": 1453323432, "last_edit_date": 1453338244, "question_id": 34910373, "link": "https://stackoverflow.com/questions/34910373/wcf-sslstreamsecurity-dns-identity-check-failing-for-just-4-6-framework", "title": "WCF SslStreamSecurity DNS Identity Check failing for just 4.6 framework", "body": "<p>I am working on developing a new binding for a Wcf service that is hosted in IIS, I thought I got everything working, but it turns out that the client only works when it is targetting .Net framework 4.5, if I change it to target 4.6 then I get the following error when I try to open a connection:</p>\n\n<pre><code>System.ServiceModel.Security.MessageSecurityException occurred\n  HResult=-2146233087\n  Message=The Identity check failed for the outgoing message. The remote endpoint did not provide a domain name system (DNS) claim and therefore did not satisfied DNS identity 'xxx.domain.local'. This may be caused by lack of DNS or CN name in the remote endpoint X.509 certificate's distinguished name.\n  Source=System.ServiceModel\n  StackTrace:\n       at System.ServiceModel.Security.IdentityVerifier.EnsureIdentity(EndpointAddress serviceReference, AuthorizationContext authorizationContext, String errorString)\n</code></pre>\n\n<p>If I do nothing other than change the target framework in my test code back to 4.5, then it works fine. This makes me think that it could be a bug in .Net 4.6, I know there were <a href=\"https://msdn.microsoft.com/en-us/library/ms171868(v=vs.110).aspx#v46\" rel=\"noreferrer\">Wcf ssl changes made in 4.6</a></p>\n\n<p>With first chance exceptions turned on I see the following exception that is raised internally in System.ServiceModel</p>\n\n<pre><code>System.ArgumentNullException occurred\n  HResult=-2147467261\n  Message=Value cannot be null.\nParameter name: value\n  ParamName=value\n  Source=mscorlib\n  StackTrace:\n       at System.Enum.TryParseEnum(Type enumType, String value, Boolean ignoreCase, EnumResult&amp; parseResult)\n  InnerException: \n\n    System.ServiceModel.dll!System.ServiceModel.Security.IssuanceTokenProviderBase&lt;System.ServiceModel.Security.Tokens.IssuedSecurityTokenProvider.FederatedTokenProviderState&gt;.DoNegotiation(System.TimeSpan timeout)  Unknown     System.ServiceModel.dll!System.ServiceModel.Security.IssuanceTokenProviderBase&lt;System.ServiceModel.Security.Tokens.IssuedSecurityTokenProvider.FederatedTokenProviderState&gt;.GetTokenCore(System.TimeSpan timeout)   Unknown\n    System.IdentityModel.dll!System.IdentityModel.Selectors.SecurityTokenProvider.GetToken(System.TimeSpan timeout) Unknown\n    System.ServiceModel.dll!System.ServiceModel.Security.Tokens.IssuedSecurityTokenProvider.GetTokenCore(System.TimeSpan timeout)   Unknown\n    System.IdentityModel.dll!System.IdentityModel.Selectors.SecurityTokenProvider.GetToken(System.TimeSpan timeout) Unknown\n    System.ServiceModel.dll!System.ServiceModel.Security.SecurityProtocol.TryGetSupportingTokens(System.ServiceModel.Security.SecurityProtocolFactory factory, System.ServiceModel.EndpointAddress target, System.Uri via, System.ServiceModel.Channels.Message message, System.TimeSpan timeout, bool isBlockingCall, out System.Collections.Generic.IList&lt;System.ServiceModel.Security.SupportingTokenSpecification&gt; supportingTokens)    Unknown\n    System.ServiceModel.dll!System.ServiceModel.Security.TransportSecurityProtocol.SecureOutgoingMessageAtInitiator(ref System.ServiceModel.Channels.Message message, string actor, System.TimeSpan timeout)    Unknown\n    System.ServiceModel.dll!System.ServiceModel.Security.TransportSecurityProtocol.SecureOutgoingMessage(ref System.ServiceModel.Channels.Message message, System.TimeSpan timeout) Unknown\n    System.ServiceModel.dll!System.ServiceModel.Security.SecurityProtocol.SecureOutgoingMessage(ref System.ServiceModel.Channels.Message message, System.TimeSpan timeout, System.ServiceModel.Security.SecurityProtocolCorrelationState correlationState)  Unknown\n    System.ServiceModel.dll!System.ServiceModel.Channels.SecurityChannelFactory&lt;System.ServiceModel.Channels.IRequestChannel&gt;.SecurityRequestChannel.Request(System.ServiceModel.Channels.Message message, System.TimeSpan timeout) Unknown\n    System.ServiceModel.dll!System.ServiceModel.Channels.TransactionRequestChannelGeneric&lt;System.ServiceModel.Channels.IRequestChannel&gt;.Request(System.ServiceModel.Channels.Message message, System.TimeSpan timeout)  Unknown\n    System.ServiceModel.dll!System.ServiceModel.Dispatcher.RequestChannelBinder.Request(System.ServiceModel.Channels.Message message, System.TimeSpan timeout)  Unknown\n    System.ServiceModel.dll!System.ServiceModel.Channels.ServiceChannel.Call(string action, bool oneway, System.ServiceModel.Dispatcher.ProxyOperationRuntime operation, object[] ins, object[] outs, System.TimeSpan timeout)  Unknown\n    System.ServiceModel.dll!System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(System.Runtime.Remoting.Messaging.IMethodCallMessage methodCall, System.ServiceModel.Dispatcher.ProxyOperationRuntime operation) Unknown\n    System.ServiceModel.dll!System.ServiceModel.Channels.ServiceChannelProxy.Invoke(System.Runtime.Remoting.Messaging.IMessage message) Unknown\n    mscorlib.dll!System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(ref System.Runtime.Remoting.Proxies.MessageData msgData, int type) Unknown\n</code></pre>\n\n<p>The wcf service being communicated to is targeting 4.6, and as far as I can tell I am specifying the dns identity, which does exist as a CN= in the cert subject. The binding is a custom binding so that I can do federated net.tcp, the client creates everything in code and I don't use the Add Service Reference feature in visual studio, the client code that is creating the binding:</p>\n\n<pre><code>var binding = new CustomBinding(new BindingElement[] {\n            new TransactionFlowBindingElement(),\n            security,\n            new SslStreamSecurityBindingElement(),\n            new BinaryMessageEncodingBindingElement() {\n                ReaderQuotas = { MaxDepth = maxReceivedSizeBytes, MaxStringContentLength = maxReceivedSizeBytes, MaxArrayLength = maxReceivedSizeBytes, MaxBytesPerRead = maxReceivedSizeBytes, MaxNameTableCharCount = maxReceivedSizeBytes },\n            },\n            new TcpTransportBindingElement {\n                TransferMode = TransferMode.StreamedResponse,\n                MaxReceivedMessageSize = maxReceivedSizeBytes,\n            },\n        }) {\n    SendTimeout = sendTimeout,\n};\n\nvar channelFactory = new ChannelFactory&lt;T&gt;(binding, new EndpointAddress(new Uri(url), EndpointIdentity.CreateDnsIdentity(\"xxx.domain.local\"), new AddressHeader[0]));\n</code></pre>\n\n<p>Could this be a bug in the 4.6 framework causing different behavior? Would the next steps only be trying to step through and debug framework code to try and find why 4.6 is behaving differently?</p>\n\n<p><strong>EDIT -</strong> \nI created a <a href=\"https://github.com/brandonagr/Wcf46IdentityFailExample\" rel=\"noreferrer\">small sample project that demonstrates the error</a>, the repro steps are:</p>\n\n<ul>\n<li>(Using VS 2015) Open the WcfSelfHostedServer solution</li>\n<li>Add the IdentityFail.pfx cert to your Local Computer, Personal store using mmc</li>\n<li>Run the WcfSelfHostedServer project (likely clicking firewall yes allow port 30000)</li>\n<li>Open the WcfClient solution</li>\n<li>Right click on project > properties, note that it is targetting 4.6.1</li>\n<li>Run the project, it will throw the exception described above</li>\n<li>Now switch the client to target 4.5.2, it will run fine with no errors</li>\n</ul>\n\n<p><strong>Update -</strong>\nI found the following that appear related:\n<a href=\"https://support.microsoft.com/en-us/kb/3069494\" rel=\"noreferrer\">https://support.microsoft.com/en-us/kb/3069494</a>\n<a href=\"https://msdn.microsoft.com/en-us/library/mt298998(v=vs.110).aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/mt298998(v=vs.110).aspx</a></p>\n\n<p>But specifying Tls12 at the server and client didn't fix the issue, and even adding the DontEnableSchUseStrongCrypto=true flag didn't affect the DNS Identity Check error even though it got around the Enum.Parse internal error that <a href=\"http://referencesource.microsoft.com/#System/net/System/Net/ServicePointManager.cs,686\" rel=\"noreferrer\">was being thrown from this line</a></p>\n"}, {"tags": ["c#", "wpf", ".net-4.5"], "comments": [{"owner": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "edited": false, "score": 0, "creation_date": 1453323637, "post_id": 34910351, "comment_id": 57556489, "body": "Do you have a method <code>private void checkLongText_Unchecked(object sender, RoutedEventArgs e) { }</code> in your MainWindow.xaml.cs?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 1317002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uugpe.jpg?s=128&g=1", "display_name": "Kryssi", "link": "https://stackoverflow.com/users/1317002/kryssi"}, "edited": false, "score": 0, "creation_date": 1453324304, "post_id": 34910559, "comment_id": 57556872, "body": "It has this, @coagulantmonkey, but gives me the message:"}, {"owner": {"reputation": 3, "user_id": 1317002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uugpe.jpg?s=128&g=1", "display_name": "Kryssi", "link": "https://stackoverflow.com/users/1317002/kryssi"}, "edited": false, "score": 0, "creation_date": 1453324318, "post_id": 34910559, "comment_id": 57556883, "body": "Error\t1\t&#39;Layout.MainWindow.chkLongText_Unchecked(object, System.Windows.RoutedEventArgs)&#39; must declare a body because it is not marked abstract, extern, or partial\tc:\\users\\kryssi\\documents\\visual studio 2013\\Projects\\Layout\\Layout\\MainWindow.xaml.cs"}, {"owner": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "edited": false, "score": 1, "creation_date": 1453324390, "post_id": 34910559, "comment_id": 57556919, "body": "It seems like you have <code>private void checkLongText_Unchecked(object sender, RoutedEventArgs e);</code> instead of <code>private void checkLongText_Unchecked(object sender, RoutedEventArgs e) { }</code>. According to this last error message you pasted."}, {"owner": {"reputation": 3, "user_id": 1317002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uugpe.jpg?s=128&g=1", "display_name": "Kryssi", "link": "https://stackoverflow.com/users/1317002/kryssi"}, "reply_to_user": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "edited": false, "score": 0, "creation_date": 1453324826, "post_id": 34910559, "comment_id": 57557154, "body": "@SzabolcsD&#233;zsi I did this and posted some updates above."}], "tags": [], "owner": {"reputation": 136, "user_id": 1784022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bf76ee5cef6f4841fc4e425addee611?s=128&d=identicon&r=PG", "display_name": "cgt_mky", "link": "https://stackoverflow.com/users/1784022/cgt-mky"}, "is_accepted": false, "score": 0, "last_activity_date": 1453324119, "creation_date": 1453324119, "answer_id": 34910559, "question_id": 34910351, "link": "https://stackoverflow.com/questions/34910351/how-do-i-define-chklongtext-checked/34910559#34910559", "title": "How do I define &quot;chkLongText_Checked&quot;?", "body": "<p>In your code behind you need a method something like</p>\n\n<pre><code>private void checkLongText_Unchecked(object sender, RoutedEventArgs e)\n{\n     // Do something\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 1317002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uugpe.jpg?s=128&g=1", "display_name": "Kryssi", "link": "https://stackoverflow.com/users/1317002/kryssi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453325357, "creation_date": 1453323363, "last_edit_date": 1453325357, "question_id": 34910351, "link": "https://stackoverflow.com/questions/34910351/how-do-i-define-chklongtext-checked", "title": "How do I define &quot;chkLongText_Checked&quot;?", "body": "<p>This user interface has a short text and a long text option. When the long text is used, the buttons that contain the text are re-sized automatically. \nHere is what I have done, but I haven't the foggiest on how I am to define 'checkLongText_Unchecked.' It says I'm missing an extension method. Does anyone have any advice?</p>\n\n<p><a href=\"http://i.stack.imgur.com/7HQy4.png\" rel=\"nofollow\">the code</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/phwe3.png\" rel=\"nofollow\">the error</a></p>\n\n<pre><code>&lt;Window x:Class=\"Layout.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"*\"&gt;&lt;/RowDefinition&gt;\n        &lt;RowDefinition Height=\"Auto\"&gt;&lt;/RowDefinition&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"Auto\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"*\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n\n    &lt;StackPanel Grid.Row=\"0\" Grid.Column=\"0\"&gt;\n        &lt;Button Name=\"cmdPrev\" Margin=\"10,10,10,3\"&gt;Prev&lt;/Button&gt;\n        &lt;Button Name=\"cmdNext\" Margin=\"10,3,10,3\"&gt;Next&lt;/Button&gt;\n        &lt;CheckBox Name=\"chkLongText\" Margin=\"10,10,10,10\"\n         Checked=\"chkLongText_Checked\" Unchecked=\"chkLongText_Unchecked\"&gt;\n         Show Long Text&lt;/CheckBox&gt;\n         &lt;/StackPanel&gt;\n    &lt;TextBox Grid.Row=\"0\" Grid.Column=\"1\" Margin=\"0,10,10,10\"\n             TextWrapping=\"WrapWithOverflow\" Grid.RowSpan=\"2\"&gt; This is a very basic test.&lt;/TextBox&gt;\n    &lt;Button Grid.Row=\"1\" Grid.Column=\"0\" Name=\"cmdClose\"\n            Margin=\"10,3,10,10\"&gt;Close&lt;/Button&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>Here is the C#. </p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n    }\n\n    private void chkLongText_Checked(object sender, RoutedEventArgs e)\n\n    {\n\n    }\n    private void chkLongText_Unchecked(object sender, RoutedEventArgs e)\n    { }\n}\n</code></pre>\n\n<p>The error is: </p>\n\n<blockquote>\n  <p>Error 1   'Layout.MainWindow.chkLongText_Unchecked(object,\n  System.Windows.RoutedEventArgs)' must declare a body because it is not\n  marked abstract, extern, or partial   c:\\users\\kryssi\\documents\\visual\n  studio 2013\\Projects\\Layout\\Layout\\MainWindow.xaml.cs 33  22  Layout</p>\n</blockquote>\n"}, {"tags": ["c#", "oop", "serialization", "solid-principles"], "answers": [{"comments": [{"owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1453364494, "post_id": 34912921, "comment_id": 57571313, "body": "Will this work with List&lt;Entry&gt; as well? It also have public get, set properties"}, {"owner": {"reputation": 2633, "user_id": 283606, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e56c33d441fc4675d9d4fd0fc09002aa?s=128&d=identicon&r=PG", "display_name": "Aleksandr Ivanov", "link": "https://stackoverflow.com/users/283606/aleksandr-ivanov"}, "reply_to_user": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1453366450, "post_id": 34912921, "comment_id": 57572370, "body": "Yes, it will. I added an example to my answer."}, {"owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1453395705, "post_id": 34912921, "comment_id": 57592759, "body": "What about if I have a <code>BitmapSource</code> (Which can&#39;t be serialized) property? . I can convert it to base64, but how can I tell the serializer to do it?"}, {"owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1453396799, "post_id": 34912921, "comment_id": 57593443, "body": "Nvm, read it in (this) [<a href=\"http://stackoverflow.com/questions/18841690/serialize-and-store-an-image-in-an-xml-file]\" title=\"serialize and store an image in an xml file%5d\">stackoverflow.com/questions/18841690/&hellip;</a> answer"}, {"owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1453397310, "post_id": 34912921, "comment_id": 57593751, "body": "Just one more question. How should I use the SerializationContract classes? Should I instantiate those classes from the original class during serialization and instantiate the original class using contract classes during deserialization?"}, {"owner": {"reputation": 2633, "user_id": 283606, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e56c33d441fc4675d9d4fd0fc09002aa?s=128&d=identicon&r=PG", "display_name": "Aleksandr Ivanov", "link": "https://stackoverflow.com/users/283606/aleksandr-ivanov"}, "reply_to_user": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 1, "creation_date": 1453410348, "post_id": 34912921, "comment_id": 57601301, "body": "You can do it manually, or use AutoMapper for example. So to create serialziaztion contract from Customer class: <code>var contract = Mapper.Map&lt;CostomerSerializationContract&gt;(customer);</code> You can get more information in their <a href=\"https://github.com/AutoMapper/AutoMapper/wiki/Getting-started\" rel=\"nofollow noreferrer\">getting started guide</a>."}, {"owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1453416336, "post_id": 34912921, "comment_id": 57604303, "body": "Thank you. I got everything working now. I found using separate contract classes really useful :)"}], "tags": [], "owner": {"reputation": 2633, "user_id": 283606, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e56c33d441fc4675d9d4fd0fc09002aa?s=128&d=identicon&r=PG", "display_name": "Aleksandr Ivanov", "link": "https://stackoverflow.com/users/283606/aleksandr-ivanov"}, "is_accepted": true, "score": 3, "last_activity_date": 1453366417, "last_edit_date": 1453366417, "creation_date": 1453333906, "answer_id": 34912921, "question_id": 34910348, "link": "https://stackoverflow.com/questions/34910348/serializing-a-custom-object-using-solid-principles/34912921#34912921", "title": "Serializing a custom object using SOLID principles", "body": "<p>Writing your own serializer might be an interesting task, but I doubt that this is a good idea.</p>\n\n<p>As I understood you want to keep your models clean, without any serialization specific attributes. I guess by \"typical .NET serialization\" you mean methods included with .Net framework.</p>\n\n<p>For simplicity we will use these simple classes as an example:</p>\n\n<pre><code>class Customer\n{\n    public string Name { get; set; }\n    public int Age { get; set; }\n    public List&lt;Order&gt; Orders { get; set; }     \n}\n\nclass Order \n{\n    public int Id { get; set; }\n    public string Details { get; set; }\n}\n</code></pre>\n\n<p>An easy option would be to use Json.NET:</p>\n\n<pre><code>var customer = new Customer \n{ \n    Name = \"Darth Vader\", \n    Age = 45,\n    Orders = new List&lt;Order&gt; \n    {\n        new Order { Id = 1, Details = \"Order1\" },\n        new Order { Id = 2, Details = \"Order2\" }\n    }\n};\nstring json = JsonConvert.SerializeObject(customer);\n</code></pre>\n\n<p>So as you can see you don't need to add any custom attributes to <code>Customer</code> class. It will work until you want to serialize all public properties.</p>\n\n<p>The resulting JSON will be:</p>\n\n<pre><code>{\n  \"Name\": \"Darth Vader\",\n  \"Age\": 45,\n  \"Orders\": [\n    {\n      \"Id\": 1,\n      \"Details\": \"Order1\"\n    },\n    {\n      \"Id\": 2,\n      \"Details\": \"Order2\"\n    }\n  ]\n}\n</code></pre>\n\n<p>After that you can always deserialize it:</p>\n\n<pre><code>var customer = JsonConvert.DeserializeObject&lt;Customer&gt;(json);\n</code></pre>\n\n<p>Lets say that you don't want <code>Age</code> property to be included. In this case I would suggest to create a different class that will be used for serialization only:</p>\n\n<pre><code>class CostomerSerializationContract\n{\n    public string Name { get; set; }\n    public List&lt;Order&gt; Orders { get; set; }\n}\n</code></pre>\n\n<p>This main advantage if this approach is that you have separate class for serialization, and you can add any custom attributes there, if you choose to use some other serializer, without violating SOLID principle. The main disadvantage is that you need to keep both objects in sync manually.</p>\n\n<p>You can use <a href=\"https://github.com/AutoMapper/AutoMapper\" rel=\"nofollow\">AutoMapper</a> to reduce manual work when creating serialization contract from source class. </p>\n"}], "owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 0, "accepted_answer_id": 34912921, "answer_count": 1, "score": 0, "last_activity_date": 1453366417, "creation_date": 1453323357, "question_id": 34910348, "link": "https://stackoverflow.com/questions/34910348/serializing-a-custom-object-using-solid-principles", "title": "Serializing a custom object using SOLID principles", "body": "<p>I want to serialize my model objects (from WPF MVVM) which contains pure data. This sounds easy but I don't want to use the Serialization attributes and stuff provided in .NET framework. I just want to serialize it using my own way.<br>\nSo here's a simplified version of one of my classes.  </p>\n\n<pre><code>public class EntryKeyValuePair \n{\n    public EntryKeyValuePair(string key, string value, bool isMultiline = false, bool isMandatory = true, bool isProtected = false)\n    {\n        Key = key;\n        Value = value;\n        IsMultiline = isMultiline;\n        IsMandatory = isMandatory;\n        IsProtected = isProtected;\n    }\n\n    public string Key { get; set; }\n    public string Value { get; set; }\n    public bool IsMultiline { get; set; }\n    public bool IsMandatory { get; set; }\n    public bool IsProtected { get; set; }\n\n    public static EntryKeyValuePair FromXML(XElement element, ICipher cipher)\n    {\n        string key = cipher.Decrypt(element.Element(nameof(Key)).Value);\n        string value = cipher.Decrypt(element.Element(nameof(Value)).Value);\n        bool isMultiline = bool.Parse(element.Element(nameof(IsMultiline)).Value);\n        bool isMandatory = bool.Parse(element.Element(nameof(IsMandatory)).Value);\n        bool isProtected = bool.Parse(element.Element(nameof(IsProtected)).Value);\n        return new EntryKeyValuePair(key, value, isMultiline, isMandatory, isProtected);\n    }\n\n    public XElement ToXML(ICipher cipher)\n    {\n        return new XElement(nameof(EntryKeyValuePair),\n                                new XElement(nameof(Key),cipher.Encrypt(Key)),\n                                new XElement(nameof(Value), cipher.Encrypt(Value)),\n                                new XElement(nameof(IsMultiline), IsMultiline), new XElement(nameof(IsMandatory), IsMandatory),\n                                new XElement(nameof(IsProtected), IsProtected));\n    }\n}\n</code></pre>\n\n<p>This works quite well. But this violates single responsibility principle and maybe other principles as well. This is also difficult to maintain and extend.<br>\nSo I wanted to find another way. And here it is:  </p>\n\n<p>First I defined an <code>IStringFormatter</code> interface which can format the data to any string data formats like XML and JSON. (Not sure tho)  </p>\n\n<pre><code>interface IStringFormatter\n{\n    string Name { get; set; }\n    Dictionary&lt;string, string&gt; FieldDictionary { get; }\n    string Format();\n}\n</code></pre>\n\n<p>Here's how the XMLStringFormatter looks like: </p>\n\n<pre><code>class XmlStringFormatter : IStringFormatter\n{\n    public XmlStringFormatter()\n    {\n        FieldDictionary = new Dictionary&lt;string, string&gt;();\n    }\n\n    public string Name { get; set; }\n    public Dictionary&lt;string, string&gt; FieldDictionary { get; }\n\n    public string Format()\n    {\n        var xElement = new XElement(Name, FieldDictionary.Keys.Select(key =&gt; new XElement(key, FieldDictionary[key])));\n        return xElement.ToString();\n    }\n}\n</code></pre>\n\n<p>Then I defined an <code>ISerializer</code> to serialize (or rather save) my data objects to the <code>IStringFormatter</code>. </p>\n\n<pre><code>interface ISerializer&lt;T&gt;\n{\n    T DeSerialize(IStringFormatter stringFormatter);\n    void Serialize(T obj, IStringFormatter stringFormatter);\n}\n</code></pre>\n\n<p>And here is how I \"Serialize\" <code>EntryKeyValurPair</code> by implementing this: </p>\n\n<pre><code>internal class EntryKeyValurPairSerializer : ISerializer&lt;EntryKeyValuePair&gt;\n{\n    public EntryKeyValuePair DeSerialize(IStringFormatter stringFormatter)\n    {\n        Dictionary&lt;string, string&gt; fieldDictionary = stringFormatter.FieldDictionary;\n\n        try {\n            string key = fieldDictionary[nameof(EntryKeyValuePair.Key)];\n            string value = fieldDictionary[nameof(EntryKeyValuePair.Value)];\n            bool isMandatory = bool.Parse(fieldDictionary[nameof(EntryKeyValuePair.IsMandatory)]);\n            bool isProtected = bool.Parse(fieldDictionary[nameof(EntryKeyValuePair.IsProtected)]);\n            bool isMultiline = bool.Parse(fieldDictionary[nameof(EntryKeyValuePair.IsMultiline)]);\n            return new EntryKeyValuePair(key, value, isMultiline, isMandatory, isProtected);\n        }\n        catch (KeyNotFoundException ex) {\n            throw new SerializationException(ex);\n        }\n        catch (FormatException ex) {\n            throw new SerializationException(ex);\n        }\n    }\n\n    public void Serialize(EntryKeyValuePair obj, IStringFormatter stringFormatter)\n    {\n        stringFormatter.Name = nameof(EntryKeyValuePair);\n        Dictionary&lt;string, string&gt; fieldDictionary = stringFormatter.FieldDictionary;\n\n        fieldDictionary.Add(nameof(EntryKeyValuePair.Key), obj.Key);\n        fieldDictionary.Add(nameof(EntryKeyValuePair.Value), obj.Value);\n        fieldDictionary.Add(nameof(EntryKeyValuePair.IsMandatory), obj.IsMandatory.ToString());\n        fieldDictionary.Add(nameof(EntryKeyValuePair.IsProtected), obj.IsProtected.ToString());\n        fieldDictionary.Add(nameof(EntryKeyValuePair.IsMultiline), obj.IsMultiline.ToString());\n    }\n}\n</code></pre>\n\n<p>Now this works fine. But the problem is when I have a complex type like <code>List&lt;Entry&gt;</code> (where Entry is another data class) in my data classes.<br>\nAs the <code>IStringFormatter</code> contains a <code>Dictionary&lt;string, string&gt;</code>, I can't just convert a <code>List&lt;Entry&gt;</code> to a string because I don't know what kind of <code>IStringFormatter</code> it wants in the context of <code>ISerializer</code>. How can I fix this? I also want to know if my solution is adhering to SOLID principles. If you can suggest a better solution (NOT the typical .NET serialization), I would appreciate it.</p>\n"}, {"tags": ["c#"], "answers": [{"tags": [], "owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "is_accepted": false, "score": 0, "last_activity_date": 1453323206, "creation_date": 1453323206, "answer_id": 34910299, "question_id": 34910253, "link": "https://stackoverflow.com/questions/34910253/how-to-split-in-c/34910299#34910299", "title": "How to Split in C#?", "body": "<p>You need to find the first occurrence of <code>:</code> and take the rest of the string using <a href=\"https://msdn.microsoft.com/en-us/library/hxthx5h6%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>string.Substring</code></a> after that in order to get your desired output.</p>\n\n<pre><code>columnVal = val.Contains(\":\") ? val.Substring(val.IndexOf(':') + 1).Trim() : val;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "edited": false, "score": 0, "creation_date": 1453323463, "post_id": 34910308, "comment_id": 57556394, "body": "That is not the correct parameter, it should be something like <code>new [] { &#39;:&#39; }</code> or <code>&quot;:&quot;.ToCharArray()</code>. Although I never noticed a second parameter existed on split, nice find."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "reply_to_user": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "edited": false, "score": 0, "creation_date": 1453324606, "post_id": 34910308, "comment_id": 57557046, "body": "Oh yeah, oops. Fixing."}], "tags": [], "owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "is_accepted": false, "score": 4, "last_activity_date": 1453324613, "last_edit_date": 1453324613, "creation_date": 1453323225, "answer_id": 34910308, "question_id": 34910253, "link": "https://stackoverflow.com/questions/34910253/how-to-split-in-c/34910308#34910308", "title": "How to Split in C#?", "body": "<p>You need <a href=\"https://msdn.microsoft.com/en-us/library/c1bs0eda.aspx\" rel=\"nofollow\">this overload</a> of <code>string.Split</code>, where you can specify the maximum number of substrings to return:</p>\n\n<pre><code>columnVal = val.Contains(\":\") ? val.Split(new [] {':'}, 2)[1] : val;\n</code></pre>\n\n<p>So it will stop splitting after the first <code>:</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 9793, "user_id": 2391169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b9c6b03a46672d5698ec565319c072?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2391169/david"}, "is_accepted": false, "score": 2, "last_activity_date": 1453323278, "creation_date": 1453323278, "answer_id": 34910326, "question_id": 34910253, "link": "https://stackoverflow.com/questions/34910253/how-to-split-in-c/34910326#34910326", "title": "How to Split in C#?", "body": "<p>If you only want the string split once, rather than at every possible symbol match, use <a href=\"https://msdn.microsoft.com/en-us/library/hxthx5h6(v=vs.110).aspx\" rel=\"nofollow\"><code>string.SubString</code></a> and <a href=\"https://msdn.microsoft.com/en-us/library/kwb0bwyd(v=vs.110).aspx\" rel=\"nofollow\"><code>string.IndexOf</code></a>.</p>\n\n<pre><code>var index = val.IndexOf(':') + 1;\ncolumnVal = (index &lt; val.Length &amp;&amp; index &gt;= 0)\n    ? val.Substring(index)\n    : val;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11916, "user_id": 21155, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/b2f449ce4b718f9bd1bc040dad34f500?s=128&d=identicon&r=PG", "display_name": "Aheho", "link": "https://stackoverflow.com/users/21155/aheho"}, "is_accepted": false, "score": 0, "last_activity_date": 1453323410, "creation_date": 1453323410, "answer_id": 34910366, "question_id": 34910253, "link": "https://stackoverflow.com/questions/34910253/how-to-split-in-c/34910366#34910366", "title": "How to Split in C#?", "body": "<pre><code> string parseTarget = \"Example #2 Approval Date: 11/18/2015 3:53:22 PM\"\n\n int  colonPosition = parseTarget.IndexOf(\":\");\n\n if (colonPosition == -1)\n {\n      throw new Exception(\"Missing Delimeter\");\n }\n\n string Value = parseTarget.Substring(colonPosition + 1, parseTarget.Length - colonPosition - 1);\n\n console.WriteLine(Value);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 549, "user_id": 1885199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66e5ecc2d4b2e7bcfc885c5cd74ffad9?s=128&d=identicon&r=PG", "display_name": "Chrotenise", "link": "https://stackoverflow.com/users/1885199/chrotenise"}, "is_accepted": false, "score": 0, "last_activity_date": 1453327134, "creation_date": 1453327134, "answer_id": 34911429, "question_id": 34910253, "link": "https://stackoverflow.com/questions/34910253/how-to-split-in-c/34911429#34911429", "title": "How to Split in C#?", "body": "<p>Rather than using String.Split / String.Contains, I would advise using <code>Regex.Split</code>. It's more flexible in that you can specify a maximum amount of positions and different splitting parameters. On top of that it's shorter and more readable than the other answers provided, imo. See <a href=\"https://msdn.microsoft.com/en-us/library/98awefz7(v=vs.110).aspx\" rel=\"nofollow\">Regex documentation</a></p>\n\n<p>Code snippet for you:</p>\n\n<pre><code>Regex rgx = new Regex(\":\");\nstring[] result = rgx.Split(val, 1);\nstring date = result[1];\n</code></pre>\n\n<p>Alternatively, you can replace the last line with the following snippet if there will <strong>ALWAYS</strong> be a split:</p>\n\n<pre><code>string date = rgx.Split(val, 1)[1];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4867998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd797cda83f82503d79695734a62998?s=128&d=identicon&r=PG&f=1", "display_name": "mayura", "link": "https://stackoverflow.com/users/4867998/mayura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "answer_count": 5, "score": -3, "last_activity_date": 1453327134, "creation_date": 1453323019, "last_edit_date": 1453323174, "question_id": 34910253, "link": "https://stackoverflow.com/questions/34910253/how-to-split-in-c", "title": "How to Split in C#?", "body": "<p>I am using code for splitting :</p>\n\n<pre><code>columnVal = val.Contains(\":\") ? val.Split(':')[1] : val;\n</code></pre>\n\n<p>Example #2 Approval Level: Formulator  I am getting result  Formulator<br>\nAs per expected ...But<br>\nNow having issue when date and time is there<br>\nExample #2 Approval Date: 11/18/2015 3:53:22 PM<br>\nResult 11/18/2015 3<br>\nI am looking for whole string 11/18/2015 3:53:22 PM<br>\nWhat to do in this ? Please help me  </p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1453323108, "post_id": 34910211, "comment_id": 57556218, "body": "what is <code>urlHelper</code> ?"}, {"owner": {"reputation": 45352, "user_id": 1625737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/v8qtx.png?s=128&g=1", "display_name": "haim770", "link": "https://stackoverflow.com/users/1625737/haim770"}, "edited": false, "score": 1, "creation_date": 1453323147, "post_id": 34910211, "comment_id": 57556238, "body": "Show the action method signature and the relevant registered routes"}, {"owner": {"reputation": 9977, "user_id": 401643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89503845649598e0ea21e8e9d5b5f9ca?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/401643/pascal"}, "edited": false, "score": 0, "creation_date": 1453323160, "post_id": 34910211, "comment_id": 57556244, "body": "Its System.Web.Mvc.UrlHelper"}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 2, "creation_date": 1453323928, "post_id": 34910211, "comment_id": 57556640, "body": "what is values ?. From your screenshot, it looks like the dictionary has 0 and null values for Name and Id. So whatever you are getting is the expected result. Isn&#39;t it ?"}, {"owner": {"reputation": 9977, "user_id": 401643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89503845649598e0ea21e8e9d5b5f9ca?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/401643/pascal"}, "edited": false, "score": 0, "creation_date": 1453324440, "post_id": 34910211, "comment_id": 57556949, "body": "I would expect /id/0 or ?id=0"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 3, "creation_date": 1453324491, "post_id": 34910211, "comment_id": 57556984, "body": "Assuming <code>values</code> is a new default instance of <code>Test</code>, (and your using the Default route <code>{controller}&#47;{action}&#47;{id}</code>), then the url <b>is</b> correct"}, {"owner": {"reputation": 9977, "user_id": 401643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89503845649598e0ea21e8e9d5b5f9ca?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/401643/pascal"}, "edited": false, "score": 0, "creation_date": 1453325008, "post_id": 34910211, "comment_id": 57557267, "body": "Is correct means what format? I have url default route and still the url is broken."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1453325235, "post_id": 34910211, "comment_id": 57557412, "body": "@Pascal, The url you have shown is exactly what should be created assuming <code>values=new Test()</code> - <code>Test</code> has an <code>id</code> property which matches the <code>{id}</code> placeholder in the default route, but there are no route placeholders for <code>{name}</code> or <code>{IsSelected}</code> so those values are added as query string parameters (but because <code>Name</code> is null, its not added)"}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1453325270, "post_id": 34910211, "comment_id": 57557435, "body": "the generated url <code>&#47;Home&#47;GetRejectTest&#47;0</code> matches with your route pattern <code>{controller}&#47;{action}&#47;{id}</code>. This is the expected behavior. <code>&#47;Home&#47;GetRejectTest&#47;0</code> is same as <code>&#47;Home&#47;GetRejectTest?id=0</code> when it comes to processing the request."}], "answers": [{"comments": [{"owner": {"reputation": 9977, "user_id": 401643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89503845649598e0ea21e8e9d5b5f9ca?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/401643/pascal"}, "edited": false, "score": 0, "creation_date": 1453492685, "post_id": 34914777, "comment_id": 57641340, "body": "Ok now I understand it. That I used id as query param in myself was just stupid then ;-) Thanks for your reasonable explanation."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "is_accepted": true, "score": 3, "last_activity_date": 1611286220, "last_edit_date": 1611286220, "creation_date": 1453346060, "answer_id": 34914777, "question_id": 34910211, "link": "https://stackoverflow.com/questions/34910211/url-action-generates-a-wrong-url/34914777#34914777", "title": "Url.Action generates a wrong url", "body": "<p>The url your generating (<code>/Home/GetRejectTest/0?IsSelected=False</code>) is correct for your route definition. You passing a new instance of <code>Test</code> to the <code>Url.Action()</code> method, which</p>\n<ol>\n<li>Internally builds a dictionary based on the name and value\n(using<code>.ToString()</code>) of each property in your model - i.e.\n<code>controller=Home, action=GetRejectTest, id=0, Name=null, IsSelected=False</code></li>\n<li>Then searches your route definitions for a match which it finds\n(<code>url: &quot;{controller}/{action}/{id}&quot;</code>) and updates the placeholders\n(which at this point generates <code>/Home/GetRejectTest/0</code>) but your\nroute definition does not have url parameters for <code>Name</code> and\n<code>IsSelected</code> so these are added as query string parameters (because\n<code>Name</code> is <code>null</code>, a query string for that propery is not generated)\nso the result is now <code>/Home/GetRejectTest/0?IsSelected=False</code></li>\n</ol>\n<p>You have not indicated what result you're actually expecting, but creating specific route definitions will solve most cases. For example if you want</p>\n<pre><code>/Home/GetRejectTest/0/false\n</code></pre>\n<p>or <code>/Home/GetRejectTest/0/false/someName</code> if the value of <code>Name</code> is not <code>null</code>, then you can create an additional route (which must be before the default route)</p>\n<pre><code>routes.MapRoute(\n  name: &quot;Test&quot;,\n  url: &quot;Home/GetRejectTest/{id}/{isselected}/{name}&quot;,\n  defaults: new { controller = &quot;Home&quot;, action = &quot;GetRejectTest&quot;, name = UrlParameter.Optional }\n);\n</code></pre>\n<p>Note that because <code>Name</code> is typeof <code>string</code> and therefore can be <code>null</code>, the <code>{name}</code> placeholder needs be the last one and marked as <code>UrlParameter.Optional</code> (otherwise it will revert back to using query string parameters)</p>\n"}], "owner": {"reputation": 9977, "user_id": 401643, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89503845649598e0ea21e8e9d5b5f9ca?s=128&d=identicon&r=PG", "display_name": "Pascal", "link": "https://stackoverflow.com/users/401643/pascal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1894, "favorite_count": 0, "accepted_answer_id": 34914777, "answer_count": 1, "score": 0, "last_activity_date": 1611286220, "creation_date": 1453322891, "last_edit_date": 1453324968, "question_id": 34910211, "link": "https://stackoverflow.com/questions/34910211/url-action-generates-a-wrong-url", "title": "Url.Action generates a wrong url", "body": "<p>I use the Url.Action method to generate a Url string.</p>\n\n<p><a href=\"https://i.stack.imgur.com/z4AOT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z4AOT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thats the result:</p>\n\n<pre><code>\"/Home/GetRejectTest/0?IsSelected=False\"\n</code></pre>\n\n<p>The controller and action name are correct but the query parameters are screwed up. Is this because The action does not have a RouteAttribute thus query parameters are generated?</p>\n\n<p>My action:</p>\n\n<pre><code>   public ActionResult GetRejectTest(Test test)\n        {\n            return new EmptyResult();\n\n        }\n</code></pre>\n\n<p>Test class has those 3 properties Id, Name, IsSelected.</p>\n\n<p>My route definition:</p>\n\n<pre><code> routes.MapRoute(\n                name: \"Default\",\n                url: \"{controller}/{action}/{id}\",\n                defaults: new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional }\n            );\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "security", "iis"], "comments": [{"owner": {"reputation": 3155, "user_id": 1426450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c61b9f354bdea5e67f662c3d6803f2?s=128&d=identicon&r=PG", "display_name": "stephen.vakil", "link": "https://stackoverflow.com/users/1426450/stephen-vakil"}, "edited": false, "score": 2, "creation_date": 1453323887, "post_id": 34910206, "comment_id": 57556625, "body": "You can indeed prevent Visual Studio from copying web.config during a publish operation.  <a href=\"http://stackoverflow.com/questions/2812905/how-do-i-prevent-publish-web-from-overwriting-config-files\" title=\"how do i prevent publish web from overwriting config files\">stackoverflow.com/questions/2812905/&hellip;</a>  I tend to put my app&#39;s configuration data into a separate .config file that is referenced from web.config and then prevent VS from publishing it."}], "answers": [{"comments": [{"owner": {"reputation": 1515, "user_id": 969881, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0f51d93e5841c0480e608d698c3e4731?s=128&d=identicon&r=PG", "display_name": "Thordax", "link": "https://stackoverflow.com/users/969881/thordax"}, "edited": false, "score": 0, "creation_date": 1453326260, "post_id": 34910604, "comment_id": 57557943, "body": "Thanks a lot for you quick and exhaustive answer."}, {"owner": {"reputation": 450, "user_id": 9872244, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pHdr0EnMlaI/AAAAAAAAAAI/AAAAAAAAABk/E4l8uhLpv_U/photo.jpg?sz=128", "display_name": "Dalton Pearson", "link": "https://stackoverflow.com/users/9872244/dalton-pearson"}, "edited": false, "score": 0, "creation_date": 1572980836, "post_id": 34910604, "comment_id": 103728833, "body": "For anyone coming to this now, here&#39;s the rather sparse documentation for encrypting configuration sections: <a href=\"https://docs.microsoft.com/en-us/previous-versions/aspnet/zhhddkxy(v=vs.100)?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/aspnet/&hellip;</a>"}], "tags": [], "owner": {"reputation": 76, "user_id": 3402202, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wzUSg.png?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/3402202/jack"}, "is_accepted": true, "score": 1, "last_activity_date": 1453324284, "creation_date": 1453324284, "answer_id": 34910604, "question_id": 34910206, "link": "https://stackoverflow.com/questions/34910206/whats-the-most-secure-way-to-store-configuration-parameters-of-a-web-site/34910604#34910604", "title": "What&#39;s the most secure way to store configuration parameters of a web site", "body": "<p>Well for a .net aspx or mvc web.site, the web.config is the standard configuration, and a remote user can't see or download it.</p>\n\n<p>If you want to store sensitive information, you can store encrypted values, using a reversible algorithm.</p>\n\n<p>Have a look at the appSettings section.\nIn this case you can read data with the webconfigurationmanager.appsettings but bear in mind that if you want to change those values, you will need to restart the application to have new values loaded. </p>\n\n<p>Machine.config is more a machine configuration.</p>\n\n<p>SQL SERVER or in general a database could be a way, but again I'd use encryption is data are sensitive. This might be the way to go if you wanted to have values loaded on the fly, without having to reload the application, but it really depends on how you read or cache the values.</p>\n\n<p>About Registry and ini files I wouldn't suggest them for a web app.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 1515, "user_id": 969881, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0f51d93e5841c0480e608d698c3e4731?s=128&d=identicon&r=PG", "display_name": "Thordax", "link": "https://stackoverflow.com/users/969881/thordax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "closed_date": 1453324419, "accepted_answer_id": 34910604, "answer_count": 1, "score": 0, "last_activity_date": 1453324284, "creation_date": 1453322879, "question_id": 34910206, "link": "https://stackoverflow.com/questions/34910206/whats-the-most-secure-way-to-store-configuration-parameters-of-a-web-site", "closed_reason": "Duplicate", "title": "What&#39;s the most secure way to store configuration parameters of a web site", "body": "<p>I'm looking for the most secure and most convenient method to store some critical parameters into a configuration file of my ASP.NET web site (code in C# with Visual Studio 2012, and published with IIS, but I don't know this really matters), such as connection strings, and other parameters.</p>\n\n<p>From what I found, I have the following options :</p>\n\n<ul>\n<li>The web.config. That way, only my website will access the settings. </li>\n</ul>\n\n<p>Problem : when I publish the changes of my site from Visual Studio, the parameters may be overwritten (or is there a way not to overwrite them during the publication ?)</p>\n\n<ul>\n<li>The machine.config => The publication won't overwrite the existing parameters.</li>\n</ul>\n\n<p>Problem : All websites on the machine will have access to the configuration file (and this may be a security issue)</p>\n\n<ul>\n<li>SQL Server : easy to maintain</li>\n</ul>\n\n<p>Problem : needs a Connection String to access the database. Where should I store the Connection String ?</p>\n\n<ul>\n<li><p>Registry : Average maintainability. Impossible to define specific users rights for each category or web site.</p></li>\n<li><p>A simple INI file. Very easy to maintain. But is that secure enough ? </p></li>\n</ul>\n\n<p>Thanks in advance for your answers.</p>\n"}, {"tags": ["c#"], "answers": [{"tags": [], "owner": {"reputation": 8492, "user_id": 430560, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8f7fcef7829f7213704c7c4bba9de68?s=128&d=identicon&r=PG", "display_name": "Jonathan Dickinson", "link": "https://stackoverflow.com/users/430560/jonathan-dickinson"}, "is_accepted": true, "score": 1, "last_activity_date": 1453323250, "last_edit_date": 1495542208, "creation_date": 1453323250, "answer_id": 34910318, "question_id": 34910173, "link": "https://stackoverflow.com/questions/34910173/c-pointer-exceeds-intptr-limit/34910318#34910318", "title": "C# pointer exceeds IntPtr limit", "body": "<p>Windows is a 64-bit OS. UInt is 64bits wide. I assume the problem is that your application is either built for 32bit or is built to \"Prefer 32bit\" (the Visual Studio defaults).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12066638/what-is-the-purpose-of-the-prefer-32-bit-setting-in-visual-studio-2012-and-how\">This answer</a> has the details of the setting you want to change.</p>\n"}], "owner": {"reputation": 398, "user_id": 5020853, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8b87b9b2a03d6b97f483e2c740ce467b?s=128&d=identicon&r=PG&f=1", "display_name": "Rikus Honey", "link": "https://stackoverflow.com/users/5020853/rikus-honey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 34910318, "answer_count": 1, "score": -1, "last_activity_date": 1453323250, "creation_date": 1453322789, "question_id": 34910173, "link": "https://stackoverflow.com/questions/34910173/c-pointer-exceeds-intptr-limit", "title": "C# pointer exceeds IntPtr limit", "body": "<p>I'm  trying to read a process's memory, but the address I would like to start reading from exceeds the IntPtr and UIntPtr limit.</p>\n\n<pre><code>[DllImport(\"kernel32.dll\", EntryPoint = \"ReadProcessMemory\")]\n    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, [Out] byte[] lpBuffer, int dwSize, [Out] int lpNumberOfBytesRead);\n\nReadProcessMemory(ProcessHandle, (IntPtr)0x14EC7B38A, buffer, buffer.Length, bytesused);\n</code></pre>\n\n<p>Doing this produces a OverflowException exception even if I use a <code>UIntPtr</code>. I have tried using a <code>ulong</code>, but this produces an AccessViolationException exception. What other data type should I use?</p>\n"}, {"tags": ["javascript", "c#", "asp.net-mvc", "foreach", "signalr"], "comments": [{"owner": {"reputation": 30145, "user_id": 1168070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e461ac690e034cb5b99cf011311c1c7?s=128&d=identicon&r=PG", "display_name": "Pawel", "link": "https://stackoverflow.com/users/1168070/pawel"}, "edited": false, "score": 0, "creation_date": 1453337721, "post_id": 34910166, "comment_id": 57562438, "body": "Have you tried awaiting <code>jobDetailService.NotifyUpdates()</code>? e.g. <code>return View(await jobDetailService.NotifyUpdates());</code> This will require making your <code>Index()</code> method async though and will potentially bubble up even more."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 2663303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/512894c58d5840d235fe198f289792ec?s=128&d=identicon&r=PG", "display_name": "TheDamned", "link": "https://stackoverflow.com/users/2663303/thedamned"}, "edited": false, "score": 0, "creation_date": 1453327718, "post_id": 34910336, "comment_id": 57558770, "body": "I also tried that earlier and I got this error message in run time:   Cannot implicitly convert type &#39;System.Threading.Tasks.Task&lt;object&gt;&#39; to &#39;System.Collections.Generic.List&lt;DataAccessModels.Models.Job&zwnj;&#8203;CurrentStatusDetails&zwnj;&#8203;&gt;&#39;&quot;}"}, {"owner": {"reputation": 190, "user_id": 2931053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08879694e6ce7ff8d0e8b201e189a2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Pricey", "link": "https://stackoverflow.com/users/2931053/pricey"}, "reply_to_user": {"reputation": 47, "user_id": 2663303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/512894c58d5840d235fe198f289792ec?s=128&d=identicon&r=PG", "display_name": "TheDamned", "link": "https://stackoverflow.com/users/2663303/thedamned"}, "edited": false, "score": 0, "creation_date": 1453328190, "post_id": 34910336, "comment_id": 57559006, "body": "@TheDamned Did you try with the .Result on the end of hubContext.Clients.All.updateData(db)? Either way you must be returning an object from updateData instead of a list."}, {"owner": {"reputation": 47, "user_id": 2663303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/512894c58d5840d235fe198f289792ec?s=128&d=identicon&r=PG", "display_name": "TheDamned", "link": "https://stackoverflow.com/users/2663303/thedamned"}, "edited": false, "score": 0, "creation_date": 1453330358, "post_id": 34910336, "comment_id": 57559966, "body": "Hi Pricey.. It worked now but failing in the View load. I debugged it and could see that data was being fetched in the Service and Controller objects. For some reason, jSonRefreshData is showing as null. Is my javascript code fine ? Thanks"}, {"owner": {"reputation": 190, "user_id": 2931053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08879694e6ce7ff8d0e8b201e189a2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Pricey", "link": "https://stackoverflow.com/users/2931053/pricey"}, "reply_to_user": {"reputation": 47, "user_id": 2663303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/512894c58d5840d235fe198f289792ec?s=128&d=identicon&r=PG", "display_name": "TheDamned", "link": "https://stackoverflow.com/users/2663303/thedamned"}, "edited": false, "score": 0, "creation_date": 1453331331, "post_id": 34910336, "comment_id": 57560372, "body": "@TheDamned From the code you&#39;ve given I can see that you&#39;ve passed jSonRefreshData in as a parameter to a function, but I can&#39;t see anywhere that you&#39;ve initialised it."}, {"owner": {"reputation": 190, "user_id": 2931053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08879694e6ce7ff8d0e8b201e189a2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Pricey", "link": "https://stackoverflow.com/users/2931053/pricey"}, "reply_to_user": {"reputation": 47, "user_id": 2663303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/512894c58d5840d235fe198f289792ec?s=128&d=identicon&r=PG", "display_name": "TheDamned", "link": "https://stackoverflow.com/users/2663303/thedamned"}, "edited": false, "score": 0, "creation_date": 1453335279, "post_id": 34910336, "comment_id": 57561724, "body": "@TheDamned Also, if I&#39;ve answered your question, please mark it as such. Thanks!"}], "tags": [], "owner": {"reputation": 190, "user_id": 2931053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08879694e6ce7ff8d0e8b201e189a2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Pricey", "link": "https://stackoverflow.com/users/2931053/pricey"}, "is_accepted": true, "score": 1, "last_activity_date": 1484802680, "last_edit_date": 1484802680, "creation_date": 1453323322, "answer_id": 34910336, "question_id": 34910166, "link": "https://stackoverflow.com/questions/34910166/compilation-error-in-foreach-statement-while-looping-an-object-of-type-system-t/34910336#34910336", "title": "Compilation error in foreach statement while looping an object of type &#39;System.Threading.Tasks.Task&lt;System.Collections.Generic.List&#39; i", "body": "<p>You are returning a Task as the Model. You could do this instead:</p>\n\n<pre><code>public List&lt;JobCurrentStatusDetails&gt; NotifyUpdates()\n{\n   var hubContext = lobalHost.ConnectionManager.GetHubContext&lt;JobDetailsHub&gt;();\n   if (hubContext != null)\n   {\n       db =  DataAccess.DataAccessModels.GetDashboardCounts();\n\n       return hubContext.Clients.All.updateData(db).Result;\n\n   }\n   else return null;\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 2663303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/512894c58d5840d235fe198f289792ec?s=128&d=identicon&r=PG", "display_name": "TheDamned", "link": "https://stackoverflow.com/users/2663303/thedamned"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 34910336, "answer_count": 1, "score": 0, "last_activity_date": 1484802680, "creation_date": 1453322766, "last_edit_date": 1453327962, "question_id": 34910166, "link": "https://stackoverflow.com/questions/34910166/compilation-error-in-foreach-statement-while-looping-an-object-of-type-system-t", "title": "Compilation error in foreach statement while looping an object of type &#39;System.Threading.Tasks.Task&lt;System.Collections.Generic.List&#39; i", "body": "<p>In the Asp.Net Project MVC with SignalR, I am trying to iterate over a object returned by Service in the Javascript Client. I get the below compile error for the foreach statement present in the below code</p>\n\n<p>foreach statement cannot operate on variables of type 'System.Threading.Tasks.Task>' because 'System.Threading.Tasks.Task>' does not contain a public definition for 'GetEnumerator'</p>\n\n<p>Can someone advise what changes should be done either in View/Service call ?</p>\n\n<p><strong>View Code</strong></p>\n\n<pre><code>  @model  System.Threading.Tasks.Task&lt;List&lt;JobCurrentStatusDetails&gt;&gt;\n\n   &lt;script type=\"text/javascript\"&gt;\n\n\n                var connection = $.hubConnection();\n                var hub = connection.createHubProxy(\"JobDetailsHub\");\n                hub.on('updateData',function(jSonRefreshData){\n                    console.log(jSonRefreshData);\n                });\n                hub.invoke('NotifyUpdates').done(function(jSonRefreshData){\n\n                    @Model = jSonRefreshData\n                    @{int countTiles = 0;}\n                    @foreach(item in Model)\n                    {\n                        if(item.color == \"red\")\n                        {}\n                         if(item.color == \"green\")\n                         {}\n  }\n                });\n    &lt;/script&gt;\n</code></pre>\n\n<p>Adding Server Side code</p>\n\n<pre><code> public async Task&lt;List&lt;JobCurrentStatusDetails&gt;&gt; NotifyUpdates()\n        {\n       var hubContext = lobalHost.ConnectionManager.GetHubContext&lt;JobDetailsHub&gt;    ();\n       if (hubContext != null)\n       {\n           db =  DataAccess.DataAccessModels.GetDashboardCounts();\n\n           return await hubContext.Clients.All.updateData(db);\n\n       }\n       else return null;\n   }\n</code></pre>\n\n<p>The Controller code is below :</p>\n\n<pre><code>public  ActionResult Index()\n        {\n            DataAccess da = new DataAccess();\n            var jobDetailService = new JobDetailsService(da);\n\n            return View(jobDetailService.NotifyUpdates());\n\n\n        }\n</code></pre>\n"}, {"tags": ["c#", "uwp", "windows-10-iot-core"], "comments": [{"owner": {"reputation": 1656, "user_id": 5199288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0Cru.jpg?s=128&g=1", "display_name": "MattWhilden", "link": "https://stackoverflow.com/users/5199288/mattwhilden"}, "edited": false, "score": 2, "creation_date": 1453342013, "post_id": 34910051, "comment_id": 57563585, "body": "Interesting... does this still reproduce if you disable .NET Native compilation? (Project properties &gt; BUILD &gt; &quot;Enable .NET Native toolchain&quot;)"}, {"owner": {"reputation": 89, "user_id": 689875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440fc4f37e353a4f4f32bb10434c9f3?s=128&d=identicon&r=PG", "display_name": "Gnm", "link": "https://stackoverflow.com/users/689875/gnm"}, "reply_to_user": {"reputation": 1656, "user_id": 5199288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0Cru.jpg?s=128&g=1", "display_name": "MattWhilden", "link": "https://stackoverflow.com/users/5199288/mattwhilden"}, "edited": false, "score": 0, "creation_date": 1453373916, "post_id": 34910051, "comment_id": 57577440, "body": "It was already set to disabled (unchecked), so what I tried to do was to enable it and run it on the RPI2 in release mode. Now Ive been running nearly 50K requests without any issues... I&#39;m not sure what this tells me, are you able to provide additonal information on this, Matt?"}, {"owner": {"reputation": 1656, "user_id": 5199288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0Cru.jpg?s=128&g=1", "display_name": "MattWhilden", "link": "https://stackoverflow.com/users/5199288/mattwhilden"}, "edited": false, "score": 1, "creation_date": 1453398422, "post_id": 34910051, "comment_id": 57594453, "body": ".NET Native is our new ahead of time compilation stack for UWP applications. The landing page is a bit dated but you can find more information here: <a href=\"https://msdn.microsoft.com/en-us/vstudio/dotnetnative.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vstudio/dotnetnative.aspx</a>. It&#39;s not immediately obvious why this clears up the issue but it will be the way UWP applications are served from the Store... so maybe that&#39;s good enough? Sorry I couldn&#39;t be more immediately useful. :-("}, {"owner": {"reputation": 89, "user_id": 689875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440fc4f37e353a4f4f32bb10434c9f3?s=128&d=identicon&r=PG", "display_name": "Gnm", "link": "https://stackoverflow.com/users/689875/gnm"}, "reply_to_user": {"reputation": 1656, "user_id": 5199288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0Cru.jpg?s=128&g=1", "display_name": "MattWhilden", "link": "https://stackoverflow.com/users/5199288/mattwhilden"}, "edited": false, "score": 0, "creation_date": 1453398846, "post_id": 34910051, "comment_id": 57594715, "body": "Ok, Thank you for supplying some more information! I will do some more testing with the setting enabled and disabled, checking whether or not it really fixes the issue. I&#39;ll update my question when testing has concluded and most likely accept your comment as the answer."}, {"owner": {"reputation": 1656, "user_id": 5199288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0Cru.jpg?s=128&g=1", "display_name": "MattWhilden", "link": "https://stackoverflow.com/users/5199288/mattwhilden"}, "edited": false, "score": 0, "creation_date": 1453399855, "post_id": 34910051, "comment_id": 57595333, "body": "Sounds good. If .NET Native gives you other issues, you can mail my team at dotnetnative@microsoft.com. Good luck!"}, {"owner": {"reputation": 11, "user_id": 4556552, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205738944450652/picture?type=large", "display_name": "Eoin Kavanagh", "link": "https://stackoverflow.com/users/4556552/eoin-kavanagh"}, "edited": false, "score": 0, "creation_date": 1494810118, "post_id": 34910051, "comment_id": 74971573, "body": "When the .NET option is enabled that everyone mentions above, I can only get responses to work for 1 minute. I then switched the option off and redeployed and the application works a lot better. Anyway, I have the same problem, but it happens after 2 days or so. I have not found a solution yet."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 3522397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GqL4v.jpg?s=128&g=1", "display_name": "Zaccone", "link": "https://stackoverflow.com/users/3522397/zaccone"}, "edited": false, "score": 0, "creation_date": 1489765214, "post_id": 34931745, "comment_id": 72829366, "body": "Same issue, same inexplicable resolution. The big clue that something is verifiably different with the Native Toolchain is that clients now properly detect/handshake that the connection has been closed when the server disposes the Socket. Previously, <code>nc myIp myPort</code> from a client never completed... which makes one wonder if the server had the same issue was leaking sockets. Thanks, @Gnm and @matt-whilden"}], "tags": [], "owner": {"reputation": 89, "user_id": 689875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440fc4f37e353a4f4f32bb10434c9f3?s=128&d=identicon&r=PG", "display_name": "Gnm", "link": "https://stackoverflow.com/users/689875/gnm"}, "is_accepted": true, "score": 3, "last_activity_date": 1453401584, "creation_date": 1453401584, "answer_id": 34931745, "question_id": 34910051, "link": "https://stackoverflow.com/questions/34910051/c-windows-10-iot-streamsocketlistener-randomly-stops-listening-in-release-mode/34931745#34931745", "title": "C# Windows 10 IoT StreamSocketListener randomly stops listening in release mode", "body": "<p>After a whole day long term testing with the \"Compile with .NET Native tool chain\" setting turned ON for my UWP project this issue seems to be fixed. When disabling this feature the issue occur after just a couple of minutes.</p>\n\n<p>Because I cant accept a comment as an answer, I'll just answer my own question, and accept it. But all thanks to Matt for pointing me in the right direction.</p>\n\n<blockquote>\n  <p>Interesting... does this still reproduce if you disable .NET Native compilation? (Project properties > BUILD > \"Enable .NET Native toolchain\") \u2013 Matt Whilden</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7420717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/771a2812cc8e67b46734a6082d495f38?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7420717/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1484464821, "creation_date": 1484464821, "answer_id": 41658784, "question_id": 34910051, "link": "https://stackoverflow.com/questions/34910051/c-windows-10-iot-streamsocketlistener-randomly-stops-listening-in-release-mode/41658784#41658784", "title": "C# Windows 10 IoT StreamSocketListener randomly stops listening in release mode", "body": "<p>Matt, Gnm:\nI've had exactly the same issue on a RPi3 running on Win-IoT 10.0.14393.693, with a C# code very similar to that in Gnm's first post: StreamSocketListener just stopping to listen to/receive http POST messages while the rest of the app (a web server background service) remained responsive. </p>\n\n<p>Two differences though: \na) on my machine, that happened already within one minute after app launch, and after only one or two requests. \nb) And it happened with the \"Compile with .NET Native Tool chain\" option switched to \"ON\"! </p>\n\n<p>Inspired by Gnm's findings I have now switched this option to OFF, and: my problem appears to be solved. At the time of writing this, the code has been running for one hour only, but it appears to be working and stable now. So, surprisingly, for me the exact opposite of Gnm's solution works...  </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7584529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15c699fb0ec997ea650dec1d60ad875?s=128&d=identicon&r=PG", "display_name": "bbSkygazer", "link": "https://stackoverflow.com/users/7584529/bbskygazer"}, "is_accepted": false, "score": 0, "last_activity_date": 1487409307, "creation_date": 1487409307, "answer_id": 42313287, "question_id": 34910051, "link": "https://stackoverflow.com/questions/34910051/c-windows-10-iot-streamsocketlistener-randomly-stops-listening-in-release-mode/42313287#42313287", "title": "C# Windows 10 IoT StreamSocketListener randomly stops listening in release mode", "body": "<p>FYI I had the same problem for a Windows 10 Iot c# app. Mine was fixed by \"Compile with .NET Native Tool chain\" option switched to \"ON\" then \"Compile with .NET Native Tool chain\" option switched to \"OFF\"! </p>\n"}], "owner": {"reputation": 89, "user_id": 689875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1440fc4f37e353a4f4f32bb10434c9f3?s=128&d=identicon&r=PG", "display_name": "Gnm", "link": "https://stackoverflow.com/users/689875/gnm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 0, "protected_date": 1510162850, "accepted_answer_id": 34931745, "answer_count": 3, "score": 4, "last_activity_date": 1510160357, "creation_date": 1453322373, "last_edit_date": 1484465406, "question_id": 34910051, "link": "https://stackoverflow.com/questions/34910051/c-windows-10-iot-streamsocketlistener-randomly-stops-listening-in-release-mode", "title": "C# Windows 10 IoT StreamSocketListener randomly stops listening in release mode", "body": "<p>Ive been working on some communication between a PC and a Raspberry PI 2 with Windows 10 IoT (build 10586 TH2) using \"<em>StreamSocketListener</em>\". This seems to work fine in debug mode, but when testing the code in release mode the \"<em>StreamSocketListener</em>\" seems to randomly stop responding to requests. </p>\n\n<p>In debug mode, on the RPI2, I've had sessions with 100k requests without a single issue, but when I push the release build it stops, randomly, quite quickly (typically after a couple of hundreds requests). The request is of static type, so the input is the same every time.    </p>\n\n<p>Has anyone experienced the same issue, and is there a solution to this problem?</p>\n\n<p>The code is based on this blog post: </p>\n\n<p><a href=\"http://www.dzhang.com/blog/2012/09/18/a-simple-in-process-http-server-for-windows-8-metro-apps\" rel=\"nofollow noreferrer\"><strong>A simple in-process HTTP server for Windows 8 Metro apps</strong></a></p>\n\n<pre><code> private void Listen()\n {\n      _listener = new StreamSocketListener();\n      _listener.ConnectionReceived += (s, e) =&gt; ProcessRequestAsync(e.Socket);\n      _listener.BindServiceNameAsync(requestPort.ToString());\n }\nprivate async void ProcessRequestAsync(StreamSocket socket)\n    {\n        try\n        {\n            // this works for text only\n            StringBuilder request = new StringBuilder();\n            using (IInputStream input = socket.InputStream)\n            {\n                byte[] data = new byte[BufferSize];\n                IBuffer buffer = data.AsBuffer();\n                uint dataRead = BufferSize;\n                while (dataRead == BufferSize)\n                {\n                    await input.ReadAsync(buffer, BufferSize, InputStreamOptions.Partial);\n                    request.Append(Encoding.UTF8.GetString(data, 0, data.Length));\n                    dataRead = buffer.Length;\n                }\n            }\n\n            using (IOutputStream output = socket.OutputStream)\n            {\n                string requestMethod = request.ToString().Split('\\n')[0];\n                string[] requestParts = requestMethod.Split(' ');\n\n                if (requestParts[0] == \"GET\")\n                    await WriteResponseAsync(requestParts[1], output);\n                else\n                    throw new InvalidDataException(\"HTTP method not supported: \"\n                                                   + requestParts[0]);\n            }\n        }\n        catch (Exception e)\n        {\n            Debug.WriteLine(\"Main ex: \" + e);\n        }\n        RequestCount++;\n    }\n</code></pre>\n"}, {"tags": ["c#", "visual-studio-2012", "asynchronous", "progress-bar"], "answers": [{"comments": [{"owner": {"reputation": 14755, "user_id": 93394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/942b14d020c6788c24369cb9ed3a6cb3?s=128&d=identicon&r=PG", "display_name": "kmote", "link": "https://stackoverflow.com/users/93394/kmote"}, "edited": false, "score": 0, "creation_date": 1453325094, "post_id": 34910238, "comment_id": 57557316, "body": "Thanks. That was my first strategy, but I wanted the text to lay over the top of the ProgressBar, and I couldn&#39;t find anyway to give the progresLbl a transparent background."}, {"owner": {"reputation": 190, "user_id": 2931053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08879694e6ce7ff8d0e8b201e189a2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Pricey", "link": "https://stackoverflow.com/users/2931053/pricey"}, "reply_to_user": {"reputation": 14755, "user_id": 93394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/942b14d020c6788c24369cb9ed3a6cb3?s=128&d=identicon&r=PG", "display_name": "kmote", "link": "https://stackoverflow.com/users/93394/kmote"}, "edited": false, "score": 0, "creation_date": 1453330603, "post_id": 34910238, "comment_id": 57560081, "body": "Ok, then maybe you could try something based on the answers to this question (if you still don&#39;t want to create a custom ProgressBar): <a href=\"http://stackoverflow.com/q/10714358/2931053\">stackoverflow.com/q/10714358/2931053</a>"}], "tags": [], "owner": {"reputation": 190, "user_id": 2931053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08879694e6ce7ff8d0e8b201e189a2bf?s=128&d=identicon&r=PG&f=1", "display_name": "Pricey", "link": "https://stackoverflow.com/users/2931053/pricey"}, "is_accepted": false, "score": 0, "last_activity_date": 1453322964, "creation_date": 1453322964, "answer_id": 34910238, "question_id": 34910022, "link": "https://stackoverflow.com/questions/34910022/why-does-the-text-on-my-asynchronous-progressbar-flicker/34910238#34910238", "title": "Why does the text on my asynchronous ProgressBar flicker?", "body": "<p>It's probably because you're drawing the string from another thread. If you can use a <code>Control</code> based text element instead you can use BeginInvoke in the same way as the ProgressBar:</p>\n\n<pre><code>// Label progressLbl\n\nprivate void UpdateProgressFromAnotherThread(int completed, int total, string progressText)\n{\n    this.progBar.BeginInvoke(new Action(() =&gt;\n    {\n        this.progBar.Maximum = total;\n        this.progBar.Value = completed;\n    }));\n\n    this.progressLbl.BeginInvoke(new Action(() =&gt;\n    {\n        this.progressLbl.Text = progressText;\n    }));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14755, "user_id": 93394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/942b14d020c6788c24369cb9ed3a6cb3?s=128&d=identicon&r=PG", "display_name": "kmote", "link": "https://stackoverflow.com/users/93394/kmote"}, "edited": false, "score": 0, "creation_date": 1453325227, "post_id": 34910290, "comment_id": 57557406, "body": "Thanks, you might be right. But it&#39;s just odd to me that my method works fine from the UI thread and only flickers on the background thread. But I do like your simplified version of a custom progressbar (much simpler than the version in the accepted answer I referenced above). I&#39;ll have to give it a try"}], "tags": [], "owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1453323508, "last_edit_date": 1453323508, "creation_date": 1453323166, "answer_id": 34910290, "question_id": 34910022, "link": "https://stackoverflow.com/questions/34910022/why-does-the-text-on-my-asynchronous-progressbar-flicker/34910290#34910290", "title": "Why does the text on my asynchronous ProgressBar flicker?", "body": "<p>In all honesty, a custom ProgressBar would be your best bet.. if you set it up correctly. I know I'm not answering your question so please don't downvote, just offering a different solution. I haven't tested this yet, but it would in theory draw the percentage every time the progress bar had to repaint, which would happen everytime the value was changed.</p>\n\n<p>Your current problem is that the bar is repainting itself everytime you change the value, thus the flickering of the text. If it didn't repaint, you would see percentage you draw starting to overlay on top of eachother which is not good either.</p>\n\n<p>This would be better to encapsulate everything within one control from a design standpoint as well.</p>\n\n<pre><code>class CustomProgressBar : ProgressBar {\n    public CustomProgressBar() : base() {}\n\n    protected override void OnPaint(PaintEventArgs e) {\n        // Call the OnPaint method of the base class.\n        base.OnPaint(e);\n        string percentStr = this.Value.ToString() + \"%\";\n        PointF location = new PointF(this.Width / 2 - 10, this.Height / 2 - 7);\n        // Call methods of the System.Drawing.Graphics object.\n        e.Graphics.DrawString(percentStr, new Font(\"Arial\",10), Brushes.Red, location );\n    } \n}\n</code></pre>\n"}], "owner": {"reputation": 14755, "user_id": 93394, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/942b14d020c6788c24369cb9ed3a6cb3?s=128&d=identicon&r=PG", "display_name": "kmote", "link": "https://stackoverflow.com/users/93394/kmote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1453323508, "creation_date": 1453322253, "last_edit_date": 1495542208, "question_id": 34910022, "link": "https://stackoverflow.com/questions/34910022/why-does-the-text-on-my-asynchronous-progressbar-flicker", "title": "Why does the text on my asynchronous ProgressBar flicker?", "body": "<p>I want to display text on a <code>ProgressBar</code>, (<em>without</em> all the nonsense of a <a href=\"https://stackoverflow.com/a/3529945/93394\">custom progress bar</a>). This is not hard to do, and does not involve the <code>OnPaint</code> method -- as demonstrated with button1 of the following code. However, this method blocks the UI thread, which is <a href=\"https://stackoverflow.com/questions/8259157/text-on-progressbar-in-c-sharp\">evil</a>.\nUnfortunately, my best stab at an asynchronous approach causes the text to flicker, which is very annoying. </p>\n\n<p>Can somebody show me how to update the text asynchronously without the flicker?</p>\n\n<blockquote>\n  <p><sub>(To run the following code, just paste it into a new project\n  containing a Form with 3 Buttons and 3 ProgressBars). </sub></p>\n</blockquote>\n\n<pre><code>using System;\nusing System.Drawing;\nusing System.Windows.Forms;\nusing System.Threading.Tasks;\nusing System.Threading;\n\nnamespace  ProgBarTest //change namespace in Program.cs accordingly\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            //This method will block the main UI thread\n            // (thus freezing the other buttons)\n            StartUpdate(this.progressBar1); \n        }\n        private void button2_Click(object sender, EventArgs e)\n        {\n            //this method (and the next) don't block the UI, and can be used concurrently,\n            // but the text flickers\n            Task t = new Task(() =&gt; StartUpdate(this.progressBar2));\n            t.Start();\n        }\n        private void button3_Click(object sender, EventArgs e)\n        {\n            Task t = new Task(() =&gt; StartUpdate(this.progressBar3));\n            t.Start();\n        }\n\n        private void StartUpdate( ProgressBar progBar)\n        {\n            for (int i = 1; i &lt;= 100; i++)\n            {\n                UpdateProgressBar(i, progBar);\n                Thread.Sleep(100);\n            }\n        }\n\n        private void UpdateProgressBar(int i, ProgressBar progBar)\n        {\n            if (progBar.InvokeRequired) //for use with background Task\n            {\n                progBar.Invoke(new Action&lt;int, ProgressBar&gt;(UpdateProgressBar), \n                                  new Object[] { i, progBar });\n            }\n            else\n            {\n                //set progress bar:\n                progBar.Value = i;\n                progBar.Refresh();\n\n                //set status label:\n                string percentStr = i.ToString() + \"%\";\n                PointF location = new PointF(progBar.Width / 2 - 10, progBar.Height / 2 - 7);\n                using (Graphics gr = progBar.CreateGraphics())\n                {\n                    gr.DrawString(percentStr, new Font(\"Arial\",10), Brushes.Red, location );\n                }\n            }\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "async-await", "task-parallel-library"], "answers": [{"comments": [{"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1453325953, "post_id": 34910100, "comment_id": 57557776, "body": "&quot;You should almost always create tasks that have already started (once they are created).&quot; - Why? What if I want to run them latter?"}, {"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1453325975, "post_id": 34910100, "comment_id": 57557789, "body": "&quot; the task returned by test() is a promise-style task&quot; - What is this?"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 3, "creation_date": 1453326380, "post_id": 34910100, "comment_id": 57558015, "body": "Because <code>Task.Run</code> is a better alternative. Take a look at <a href=\"http://blog.stephencleary.com/2015/02/a-tour-of-task-part-8-starting.html\" rel=\"nofollow noreferrer\">this article</a>. If you want to create something and start it later, use <code>Action&lt;T&gt;</code>, and then start it via <code>Task.Run</code> later."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 1, "creation_date": 1453326449, "post_id": 34910100, "comment_id": 57558063, "body": "<a href=\"http://blog.stephencleary.com/2015/04/a-tour-of-task-part-10-promise-tasks.html\" rel=\"nofollow noreferrer\">Here</a> is a good article about promise tasks."}], "tags": [], "owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "is_accepted": false, "score": 3, "last_activity_date": 1453322968, "last_edit_date": 1453322968, "creation_date": 1453322522, "answer_id": 34910100, "question_id": 34910015, "link": "https://stackoverflow.com/questions/34910015/c-async-function-as-taskint/34910100#34910100", "title": "C# async function as Task&lt;int&gt;", "body": "<p>The task returned by <code>test()</code> has already started when you invoked <code>test()</code>. So you cannot start it again.</p>\n\n<p>Actually, the task returned by <code>test()</code> is a promise-style task that does not run on the thread-pool thread in the first place.</p>\n\n<p>You should almost always create tasks that have already started (once they are created).</p>\n\n<p>I.e., you should not use the constructor of <code>Task</code> and then call the <code>Start</code> method.</p>\n\n<p>Instead, if you want to run the task on a thread-pool thread, use <a href=\"https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.run%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>Task.Run</code></a>.</p>\n"}, {"comments": [{"owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1453326185, "post_id": 34910285, "comment_id": 57557905, "body": "I agree, it already started. Is there a way, to pass test function as Task&lt;int&gt; to the  List&lt;Task&lt;int&gt;&gt; ?"}, {"owner": {"reputation": 594, "user_id": 1488675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c1934c8c16a4a47e680496f274c8f7?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/1488675/martin"}, "reply_to_user": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "edited": false, "score": 0, "creation_date": 1453327378, "post_id": 34910285, "comment_id": 57558591, "body": "I have updated the List initialization part. You could now call <code>Start</code> when you require."}], "tags": [], "owner": {"reputation": 594, "user_id": 1488675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c1934c8c16a4a47e680496f274c8f7?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/1488675/martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1453327335, "last_edit_date": 1453327335, "creation_date": 1453323147, "answer_id": 34910285, "question_id": 34910015, "link": "https://stackoverflow.com/questions/34910015/c-async-function-as-taskint/34910285#34910285", "title": "C# async function as Task&lt;int&gt;", "body": "<p>As others mentioned you cannot call <code>Start</code> as it was already started. You could still achieve your goals by checking for the status, if that is what you wish for. Please see the updated code below:</p>\n\n<pre><code>async static Task&lt;int&gt; test(){ \n    Console.WriteLine(\"{0}: Start 3\", DateTime.Now);\n    await Task.Delay(3000);\n    return 3; \n}\n\n\n        List&lt;Task&lt;int&gt;&gt; tasks2 = new List&lt;Task&lt;int&gt;&gt; {\n           new Task&lt;int&gt;( delegate{ return test().Result;}),\n            new Task&lt;int&gt;( delegate { Console.WriteLine(\"{0}: Start 3\", DateTime.Now); Task.Delay(3000).Wait(); return 3; } ),\n            new Task&lt;int&gt;( delegate { Console.WriteLine(\"{0}: Start 1\", DateTime.Now); Task.Delay(1000).Wait(); return 1; } ),\n            };\n\nforeach (var task in tasks2)\n{\n        task.Start();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 682, "user_id": 1944091, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/AmSgv.jpg?s=128&g=1", "display_name": "WiSeeker", "link": "https://stackoverflow.com/users/1944091/wiseeker"}, "is_accepted": false, "score": 0, "last_activity_date": 1453324008, "last_edit_date": 1453324008, "creation_date": 1453323618, "answer_id": 34910412, "question_id": 34910015, "link": "https://stackoverflow.com/questions/34910015/c-async-function-as-taskint/34910412#34910412", "title": "C# async function as Task&lt;int&gt;", "body": "<p>Like everyone else has pointed out, the task has been set in motion when you called <code>test()</code> so you can't start on it again. Give below code a shot to see what's going on.</p>\n\n<p>As you can see, the console output comes for each of the task. Task returned by <code>test()</code> is started by calling that method. So, this code only explicitly starts the other tasks that are in <code>Created</code> status. Finally, we wait for all tasks to complete by calling <code>WhenAll()</code> which in turn returns a task on which we wait. You will notice the longest delay of 3 seconds (of all tasks) before \"All done!\" is printed.</p>\n\n<pre><code>public static class AsyncTest\n{\n    static async Task&lt;int&gt; test()\n    {\n        Console.WriteLine(\"{0}: Start 3\", DateTime.Now);\n        await Task.Delay(3000);\n        return 3;\n    }\n\n    public static void Main()\n    {\n\n        var tasks2 = new List&lt;Task&lt;int&gt;&gt;\n        {\n            test(),\n            new Task&lt;int&gt;( delegate { Console.WriteLine(\"{0}: Start 3\", DateTime.Now); Task.Delay(3000).Wait(); return 3; } ),\n            new Task&lt;int&gt;( delegate { Console.WriteLine(\"{0}: Start 1\", DateTime.Now); Task.Delay(1000).Wait(); return 1; } )\n        };\n\n        foreach (var task in tasks2)\n        {\n            if (task.Status == TaskStatus.Created)\n                task.Start();\n        }\n\n        Task.WhenAll(tasks2).Wait();\n\n        Console.WriteLine(\"All done!\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 4055, "user_id": 1559666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/056d49ed81998b09cfe70aebec986cc2?s=128&d=identicon&r=PG", "display_name": "tower120", "link": "https://stackoverflow.com/users/1559666/tower120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 34910285, "answer_count": 3, "score": 2, "last_activity_date": 1453327335, "creation_date": 1453322239, "last_edit_date": 1453322971, "question_id": 34910015, "link": "https://stackoverflow.com/questions/34910015/c-async-function-as-taskint", "title": "C# async function as Task&lt;int&gt;", "body": "<p>In the following code: </p>\n\n<pre><code>async static Task&lt;int&gt; test(){ \n    Console.WriteLine(\"{0}: Start 3\", DateTime.Now);\n    await Task.Delay(3000);\n    return 3; \n}\n\nList&lt;Task&lt;int&gt;&gt; tasks2 = new List&lt;Task&lt;int&gt;&gt; {\n    test(),\n    new Task&lt;int&gt;( delegate { Console.WriteLine(\"{0}: Start 3\", DateTime.Now); Task.Delay(3000).Wait(); return 3; } ),\n    new Task&lt;int&gt;( delegate { Console.WriteLine(\"{0}: Start 1\", DateTime.Now); Task.Delay(1000).Wait(); return 1; } ),\n};\n\n\nforeach (var task in tasks2)\n    task.Start(); // this cause exception at runtime\n</code></pre>\n\n<p>Why I can't use <code>test</code> method as <code>Task&lt;int&gt;</code>? If function returns <code>Task&lt;int&gt;</code>...</p>\n"}, {"tags": ["c#", "bluetooth", "windows-10", "win-universal-app"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 1923050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a99935971bca89f05578974ae9d5cdc0?s=128&d=identicon&r=PG", "display_name": "syam218", "link": "https://stackoverflow.com/users/1923050/syam218"}, "is_accepted": false, "score": 2, "last_activity_date": 1500993165, "last_edit_date": 1500993165, "creation_date": 1500986887, "answer_id": 45303815, "question_id": 34909991, "link": "https://stackoverflow.com/questions/34909991/send-data-through-bluetooth-windows-10-universal-app/45303815#45303815", "title": "Send data through Bluetooth windows 10 universal app", "body": "<p>You can refer to this MSDN link:<br>\n<a href=\"https://docs.microsoft.com/en-us/windows/uwp/devices-sensors/send-or-receive-files-with-rfcomm\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/uwp/devices-sensors/send-or-receive-files-with-rfcomm</a></p>\n\n<p>This example shows client and server model Bluetooth communication.</p>\n\n<p>For device enumeration and pairing, you can use this Windows samples:<br>\n<a href=\"https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/DeviceEnumerationAndPairing\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/DeviceEnumerationAndPairing</a></p>\n\n<p>This sample will not work in old Windows SDK versions (10240).</p>\n\n<p>For file transfer, you have to implement IrOBEX protocol connect, disconnect and data packets as in the document.</p>\n\n<p>I think the steps will be like this:</p>\n\n<ol>\n<li>Enumerate and pair using windows sample.</li>\n<li>open a stream socket.</li>\n<li>Implement the OBEX protocol.</li>\n</ol>\n\n<p>Something like this:</p>\n\n<pre><code>private static byte[] CreateConnectPacketOPP(int maxPacketSize)\n{\n    int packetSize = 7;\n    byte[] theConnectPacket = new byte[packetSize];\n\n    int offset = 0;\n    ConnectPacket[offset++] = 0x80;                                   // Connect\n    ConnectPacket[offset++] = (byte)((packetSize &amp; 0xFF00) &gt;&gt; 8);     // Packetlength Hi Byte\n    ConnectPacket[offset++] = (byte)(packetSize &amp; 0xFF);              // Packetlength Lo Byte\n    ConnectPacket[offset++] = 0x10;                                   // Obex v1\n    ConnectPacket[offset++] = 0x00;                                   // No flags\n    ConnectPacket[offset++] = (byte) ((maxPacketSize &amp; 0xFF00) &gt;&gt; 8); // 2048 byte client max packet size Hi Byte\n    ConnectPacket[offset++] = (byte) (maxPacketSize &amp; 0xFF);          // 2048 byte max packet size Lo Byte    \n\n    return ConnectPacket;\n}\n</code></pre>\n"}], "owner": {"reputation": 975, "user_id": 2620725, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000174175246/picture?type=large", "display_name": "Sven Borden", "link": "https://stackoverflow.com/users/2620725/sven-borden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2515, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1500993424, "creation_date": 1453322141, "last_edit_date": 1500993424, "question_id": 34909991, "link": "https://stackoverflow.com/questions/34909991/send-data-through-bluetooth-windows-10-universal-app", "title": "Send data through Bluetooth windows 10 universal app", "body": "<p>I cannot figure out how to communicate between two devices running Windows universal apps for Windows 10, using Bluetooth. I'm not sure if there is something with my research, but I couldn't find anything  on the API.</p>\n\n<p>Can someone guide me quickly through this using C#?</p>\n"}, {"tags": ["c#", "string"], "comments": [{"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 5, "creation_date": 1453322339, "post_id": 34909988, "comment_id": 57555792, "body": "Your question is missing a link to the competition question and the examples of what works and what doesn&#39;t, i.e. input and expected output."}, {"owner": {"reputation": 471, "user_id": 873703, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4e654d99c125053d4f1eae192efc1553?s=128&d=identicon&r=PG", "display_name": "wentimo", "link": "https://stackoverflow.com/users/873703/wentimo"}, "edited": false, "score": 0, "creation_date": 1453322440, "post_id": 34909988, "comment_id": 57555847, "body": "What are the inputs it failed on, and what are the expected outputs of those inputs?"}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1453323015, "post_id": 34909988, "comment_id": 57556165, "body": "I think I found a link to the original site <a href=\"https://www.hackerearth.com/problem/algorithm/string-division/\" rel=\"nofollow noreferrer\">hackerearth.com/problem/algorithm/string-division</a>"}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1453326826, "post_id": 34909988, "comment_id": 57558264, "body": "Did my explanation help, Prashant? Anything that I can clarify more?  I&#39;ve taken those tests, as well... and it also frustrates me that they don&#39;t give you all of the test cases."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5817998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb7a6b5d8be4592820945581f825d15c?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Garje", "link": "https://stackoverflow.com/users/5817998/prashant-garje"}, "edited": false, "score": 0, "creation_date": 1453482785, "post_id": 34910666, "comment_id": 57636233, "body": "Thanks John,  I missed that part :)"}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "reply_to_user": {"reputation": 9, "user_id": 5817998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb7a6b5d8be4592820945581f825d15c?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Garje", "link": "https://stackoverflow.com/users/5817998/prashant-garje"}, "edited": false, "score": 0, "creation_date": 1453484228, "post_id": 34910666, "comment_id": 57637074, "body": "@PrashantGarje No problem"}], "tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": false, "score": 1, "last_activity_date": 1453324770, "last_edit_date": 1453324770, "creation_date": 1453324468, "answer_id": 34910666, "question_id": 34909988, "link": "https://stackoverflow.com/questions/34909988/splitting-string-n-into-4-distinct-strings/34910666#34910666", "title": "Splitting String N into 4 distinct strings", "body": "<p>This would be an example which would not work with your algorithm: <code>\"aababa\"</code>.  The 4 strings should be <code>[\"aa\", \"b\", \"a\",\"ba\"]</code> given your criteria, but your algorithm always assumes that the first character is the first string in the solution.  This assumption is false.  If <code>\"a\"</code> is the first string in the example I give, your algorithm would fail because it would make the first 3 strings <code>[\"a\", \"ab\", \"aba\",...]</code> that last one would fail with your algorithm because it has no more characters to add to the array.</p>\n\n<p>A recursive solution makes sense to me... here's some code that I think would work.</p>\n\n<p>EDIT: it does work... <a href=\"https://dotnetfiddle.net/07FDtr\" rel=\"nofollow\">here's a dotnetfiddle</a></p>\n\n<pre><code>public static List&lt;string&gt; FindStrings(string s, int n) {\n    if (n == 0) {\n        if (string.IsNullOrEmpty(s)) {\n            return new List&lt;string&gt;{ };\n        }\n        return null; // null means invalid\n    }\n\n    for (var i=s.Length-1; i&gt;=0; i--){\n        var startOfString = s.Substring(0, i);\n        var endOfString = s.Substring(i);\n        var list = FindStrings(startOfString, n-1);\n\n        // invalid... gotta continue to next try\n        if (list == null) continue;\n\n        // make sure there are no matches so far\n        if (list.Contains(endOfString)) continue;\n\n        // bingo!\n        if (list.Count == n-1) {\n            list.Add(endOfString);\n            return list;\n        }\n    }\n\n    return null; // null means invalid\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1453325537, "creation_date": 1453325537, "answer_id": 34910993, "question_id": 34909988, "link": "https://stackoverflow.com/questions/34909988/splitting-string-n-into-4-distinct-strings/34910993#34910993", "title": "Splitting String N into 4 distinct strings", "body": "<p>One way to tackle this problem is to solve the problem of creating all possible substrings.  Then going through all the possibilities and making sure the results are distinct.  </p>\n\n<pre><code>private static void Main(string[] args)\n{\n  var N = int.Parse(Console.ReadLine());\n  for (var i = 0; i &lt; N; i++)\n  {\n    Console.WriteLine(IsPairwiseUnquie(Console.ReadLine(), 4) ? \"YES\" : \"NO\");\n  }\n}\n\npublic static bool IsPairwiseUnquie(string s, int count)\n{\n  return s.AllSubstrings(4).Any(subs =&gt; subs.Count == subs.Distinct().Count());\n}\n\npublic static IEnumerable&lt;List&lt;string&gt;&gt; AllSubstrings(this string str, int count)\n{\n  if(str.Length &lt; count)\n    throw new ArgumentException(\"Not enough characters\");\n  if(count &lt;= 0)\n    throw new ArgumentException(\"Must be greater than 0\", nameof(count));\n\n  // Base case of only one substring, just return the original string.\n  if (count == 1)\n  {\n    yield return new List&lt;string&gt; { str };\n    yield break;\n  }\n\n  // break the string down by making a substring of all possible lengths from the first n\n  // then recursively call to get the possible substrings for the rest of the string.\n  for (int i = 1; i &lt;= str.Length - count + 1; i++)\n  {\n    foreach (var subsubstrings in str.Substring(i).AllSubstrings(count - 1))\n    {\n      subsubstrings.Insert(0, str.Substring(0, i));\n      yield return subsubstrings;\n    }\n  }\n} \n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5817998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb7a6b5d8be4592820945581f825d15c?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Garje", "link": "https://stackoverflow.com/users/5817998/prashant-garje"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1453325537, "creation_date": 1453322120, "last_edit_date": 1453325027, "question_id": 34909988, "link": "https://stackoverflow.com/questions/34909988/splitting-string-n-into-4-distinct-strings", "title": "Splitting String N into 4 distinct strings", "body": "<p>The string has to be split into 4 pairwise different non-empty parts. For example,</p>\n\n<ul>\n<li><code>\"happynewyear\"</code> could become <code>[\"happy\", \"new\", \"ye\" and \"ar\"</code>]</li>\n</ul>\n\n<p>No deletion, change of order of characters is permitted.</p>\n\n<p>This question was part of an online competition, which is now over. I have written the following C# code which works for the test cases which I have run but it failed in 3 test cases after submission. I am not sure what cases I might be missing, can anyone help?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace Hackerearth___India_Hacks\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            var line1 = System.Console.ReadLine().Trim();\n            var N = Int32.Parse(line1);\n            string[] s = new string[N];\n            string result = \"\";\n            for (var i = 0; i &lt; N; i++)\n            {\n                s[i] = System.Console.ReadLine().Trim();\n                result = result + \"\\n\" + check(s[i]);\n            }\n            System.Console.Write(result);\n            Console.ReadKey();\n        }\n        static string check(string s)\n        {\n            if (s.Length &gt; 3)\n            {\n                string[] s1 = new string[4];\n                int k = 0;\n                string c = \"\";\n                foreach (char ch in s)\n                {\n                    c = c + ch.ToString();\n\n                    //  Console.WriteLine(\"C :\" +c);\n                    if (k == 0)\n                    {\n                        s1[k] = c;\n                        c = \"\";\n                        k = 1;\n                    }\n                    else\n                        for (int i = 0; i &lt; k; i++)\n                        {\n                            int f = 0;\n                            for (int j = 0; j &lt; k; j++)\n                            {\n                                if (s1[j].Equals(c) || c == \"\")\n                                    f=1;\n                            }\n                            if (f == 1)\n                                break;\n                            s1[k] = c;\n                            c = \"\";\n\n                            if (k == 3 &amp;&amp; s1[k] != null)\n                                return \"YES\";\n                            k++;\n                        //          Console.WriteLine(\"K :\"+s[k]);\n                    }\n\n                }\n                return \"NO\";\n\n            }\n            else\n            {\n                return \"NO\";\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "regex", "replaceall"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 1, "creation_date": 1453322148, "post_id": 34909950, "comment_id": 57555681, "body": "It&#39;s best to show what you tried."}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "reply_to_user": {"reputation": 630, "user_id": 2988954, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f3c5a2cdd73592d09eeaa42a137a3a4?s=128&d=identicon&r=PG&f=1", "display_name": "RedLaser", "link": "https://stackoverflow.com/users/2988954/redlaser"}, "edited": false, "score": 0, "creation_date": 1453322198, "post_id": 34909950, "comment_id": 57555718, "body": "@RedLaser That&#39;s 2 to 4 periods, I think the OP means numbers after a decimal."}], "answers": [{"comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 1, "creation_date": 1453322353, "post_id": 34910000, "comment_id": 57555806, "body": "Should note this won&#39;t match if there isn&#39;t at least one number before the decimal like &quot;.05&quot;"}, {"owner": {"reputation": 21876, "user_id": 1678362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba023d18099cde022b9e4394d5714c0?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1678362/aaron"}, "reply_to_user": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1453324052, "post_id": 34910000, "comment_id": 57556710, "body": "@juharr yeah, most people write the leading 0 so I didn&#39;t mention it, but replacing the <code>+</code> by a <code>*</code> and prefixing the pattern with a <code>^</code> would make it work with your format."}], "tags": [], "owner": {"reputation": 21876, "user_id": 1678362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba023d18099cde022b9e4394d5714c0?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/1678362/aaron"}, "is_accepted": true, "score": 1, "last_activity_date": 1453322180, "creation_date": 1453322180, "answer_id": 34910000, "question_id": 34909950, "link": "https://stackoverflow.com/questions/34909950/regex-expression-help-for-two-or-more-decimal-places/34910000#34910000", "title": "regex expression help for two or more decimal places", "body": "<p><code>\\d+\\.\\d{2,4}</code> will match numbers with two to four decimals.<br>\n<code>\\d+\\.\\d{2,}</code> will match numbers with two and more decimals.</p>\n\n<p>Note that you should not use regex here if you can avoid. You will disregard localization and won't easily be able to round (if that's what you want).</p>\n"}], "owner": {"reputation": 27, "user_id": 5734389, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b210fe8ef21302e89c70ba075964f02d?s=128&d=identicon&r=PG&f=1", "display_name": "Jin Joe", "link": "https://stackoverflow.com/users/5734389/jin-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 34910000, "answer_count": 1, "score": 0, "last_activity_date": 1453322180, "creation_date": 1453322013, "question_id": 34909950, "link": "https://stackoverflow.com/questions/34909950/regex-expression-help-for-two-or-more-decimal-places", "title": "regex expression help for two or more decimal places", "body": "<p>Using c# I am trying to replace text in richtextbox that has two or more decimal places. In particular I am looking for Regex expression for two to four decimal places.</p>\n\n<p>if someone can assist with this. I would appreciate it. I tried numerous regex expression, most of which did not work   </p>\n"}, {"tags": ["c#", "plugins", "architecture"], "answers": [{"comments": [{"owner": {"reputation": 6137, "user_id": 107945, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f6c326d7075039abf8fe625c2ffa41ec?s=128&d=identicon&r=PG", "display_name": "Kelly", "link": "https://stackoverflow.com/users/107945/kelly"}, "edited": false, "score": 0, "creation_date": 1453323793, "post_id": 34910363, "comment_id": 57556583, "body": "That is what I thought. Was hoping there was a better way to do it, but sometimes the long road is better in the end I suppose."}, {"owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "reply_to_user": {"reputation": 6137, "user_id": 107945, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f6c326d7075039abf8fe625c2ffa41ec?s=128&d=identicon&r=PG", "display_name": "Kelly", "link": "https://stackoverflow.com/users/107945/kelly"}, "edited": false, "score": 0, "creation_date": 1453323988, "post_id": 34910363, "comment_id": 57556676, "body": "@Kelly You can try to find a library for that. But MEF, most popular library for plugins, doesn&#39;t work with appdomains. And I almost sure there are some examples on Github."}, {"owner": {"reputation": 6137, "user_id": 107945, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f6c326d7075039abf8fe625c2ffa41ec?s=128&d=identicon&r=PG", "display_name": "Kelly", "link": "https://stackoverflow.com/users/107945/kelly"}, "edited": false, "score": 0, "creation_date": 1453325164, "post_id": 34910363, "comment_id": 57557363, "body": "Thanks I&#39;ve used MEF a reasonable amount and your right it isn&#39;t exactly what I&#39;m looking for here. I have plenty of time to snoop around and see what I can find."}], "tags": [], "owner": {"reputation": 3307, "user_id": 1295010, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9f397d33316aee7a3b0de54298476d37?s=128&d=identicon&r=PG", "display_name": "Alex Butenko", "link": "https://stackoverflow.com/users/1295010/alex-butenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1453323400, "creation_date": 1453323400, "answer_id": 34910363, "question_id": 34909921, "link": "https://stackoverflow.com/questions/34909921/c-add-remove-dynamic-plugins-without-restart/34910363#34910363", "title": "c# Add/Remove Dynamic Plugins without restart", "body": "<p>In general, you need to load every plugin into its own AppDomain. There is no other way to make it unloadable. It doesn't make any memory leaks (if you don't make them yourself). And it is stable if you implement it right. It is not an easy task, but this topic is too big to explain in details, it would rather take a big article or a book.</p>\n"}], "owner": {"reputation": 6137, "user_id": 107945, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f6c326d7075039abf8fe625c2ffa41ec?s=128&d=identicon&r=PG", "display_name": "Kelly", "link": "https://stackoverflow.com/users/107945/kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 1, "accepted_answer_id": 34910363, "answer_count": 1, "score": 1, "last_activity_date": 1453323400, "creation_date": 1453321898, "question_id": 34909921, "link": "https://stackoverflow.com/questions/34909921/c-add-remove-dynamic-plugins-without-restart", "title": "c# Add/Remove Dynamic Plugins without restart", "body": "<p>I'm designing a solution that I believe will work well in a plugin style architecture. </p>\n\n<p>The \"Main Program\" will provide services such as database access, messaging to remote clients, logging and other functions. </p>\n\n<p>Each \"Plugin\" will be able to use those functions and contain custom functions that will perform \"Plugin\" specific logic. </p>\n\n<p><strong>I need to be able to install and uninstall the plugins at runtime without the \"Main Program\" being restarted.</strong> Uninstalls will mainly occur when new versions of the \"Plugin\" are available and need to be added to the \"Main Program\".</p>\n\n<p>If I create each plugin as a DLL and place it in a folder I can signal the \"Main Program\" to load them and all is fine. What I'm not sure of is how to correctly unload them when no longer needed, without creating a memory leak. </p>\n\n<p>If I do a Application.Load on the assembly the only way to unload it is to unload the whole AppDomain. I am not very familiar with how AppDomains work but this seems like it would cause issues. </p>\n\n<p>Has anyone done this sort of thing before and can offer some advice on the best way to do this without creating instability or memory leaks?</p>\n"}, {"tags": ["c#", ".net", "c#-6.0"], "comments": [{"owner": {"reputation": 576, "user_id": 1876951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2270f482039c5495bd1a0099ef88fa55?s=128&d=identicon&r=PG", "display_name": "Devin Prejean", "link": "https://stackoverflow.com/users/1876951/devin-prejean"}, "edited": false, "score": 0, "creation_date": 1453322100, "post_id": 34909915, "comment_id": 57555648, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/32580536/operator-cannot-be-applied-to-operand-of-type-t\" title=\"operator cannot be applied to operand of type t\">stackoverflow.com/questions/32580536/&hellip;</a>"}, {"owner": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1453322239, "post_id": 34909915, "comment_id": 57555737, "body": "Can you show <code>GetLogger()</code> please? Your <code>DoWork()</code> seems irrelevant to the problem you&#39;re facing."}, {"owner": {"reputation": 712, "user_id": 656426, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d224b32911dbd98ae8998ecda9c726e?s=128&d=identicon&r=PG", "display_name": "Andrew Khmylov", "link": "https://stackoverflow.com/users/656426/andrew-khmylov"}, "edited": false, "score": 0, "creation_date": 1453322791, "post_id": 34909915, "comment_id": 57556045, "body": "Which behavior do you expect when <code>logger</code> is null? Make <code>logAction</code> value null? Make <code>logAction</code> to ignore the passed string (effectively, make it <code>s =&gt; { }</code>)? Don&#39;t call <code>DoWork(..)</code> at all?"}, {"owner": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "reply_to_user": {"reputation": 712, "user_id": 656426, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d224b32911dbd98ae8998ecda9c726e?s=128&d=identicon&r=PG", "display_name": "Andrew Khmylov", "link": "https://stackoverflow.com/users/656426/andrew-khmylov"}, "edited": false, "score": 0, "creation_date": 1453322989, "post_id": 34909915, "comment_id": 57556154, "body": "@AndrewKhmylov I would expect logger?.Log to evaluate to either null or logger.Log."}, {"owner": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "reply_to_user": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1453323175, "post_id": 34909915, "comment_id": 57556251, "body": "@krillgar GetLogger() is irrelevant."}, {"owner": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "reply_to_user": {"reputation": 576, "user_id": 1876951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2270f482039c5495bd1a0099ef88fa55?s=128&d=identicon&r=PG", "display_name": "Devin Prejean", "link": "https://stackoverflow.com/users/1876951/devin-prejean"}, "edited": false, "score": 0, "creation_date": 1453323249, "post_id": 34909915, "comment_id": 57556286, "body": "@DevinPrejean I see, but the other post is about using null-checking operator with generic types, which is fairly different."}, {"owner": {"reputation": 712, "user_id": 656426, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0d224b32911dbd98ae8998ecda9c726e?s=128&d=identicon&r=PG", "display_name": "Andrew Khmylov", "link": "https://stackoverflow.com/users/656426/andrew-khmylov"}, "edited": false, "score": 0, "creation_date": 1453323864, "post_id": 34909915, "comment_id": 57556609, "body": "@AhmedA.Hamid Ah, I see, then hvd answer is correct here."}], "answers": [{"comments": [{"owner": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "edited": false, "score": 0, "creation_date": 1453323629, "post_id": 34910020, "comment_id": 57556486, "body": "1. Does this imply ?. is more or less efficient syntactic sugar for the ternary operator?  2. Do you have an idea why logger.Log does not have a type? It seems like the compiler has enough clues to tell what its type is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "edited": false, "score": 0, "creation_date": 1453324305, "post_id": 34910020, "comment_id": 57556875, "body": "@AhmedA.Hamid 1. The fact that makes it evaluate <code>logger</code> only once means to me that it wouldn&#39;t be fair to call it syntactic sugar, but I won&#39;t argue if you disagree. 2. Method groups never have a type. It can&#39;t be <code>Action&lt;string&gt;</code>: given <code>public delegate void MyStringAction(string s);</code>, a type <code>MyStringAction</code> would be an example of an equally acceptable delegate type. The C# compiler can&#39;t choose without looking at the context, but a language design decision has been made that C# shouldn&#39;t require looking for too much context."}, {"owner": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "edited": false, "score": 0, "creation_date": 1453325659, "post_id": 34910020, "comment_id": 57557627, "body": "I do agree with you ?. isn&#39;t just syntactic sugar. It&#39;s just that your answer gave me the impression there was a conversion or connection of some sort between the null-checking operator and the ternary operator. Is there any?  Thanks again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "edited": false, "score": 1, "creation_date": 1453325782, "post_id": 34910020, "comment_id": 57557687, "body": "@AhmedA.Hamid Ah, no, sorry for the confusion, there isn&#39;t. I just translated it to <code>?:</code> to show that the underlying issue already existed, that it isn&#39;t new to the <code>?.</code> operator, but I see how you can interpret my answer differently. Reworded to hopefully make it clearer."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": true, "score": 18, "last_activity_date": 1453325999, "last_edit_date": 1453325999, "creation_date": 1453322250, "answer_id": 34910020, "question_id": 34909915, "link": "https://stackoverflow.com/questions/34909915/operator-cannot-be-applied-to-operand-of-type-method-group/34910020#34910020", "title": "Operator &#39;?&#39; cannot be applied to operand of type &#39;method group&#39;", "body": "<p>There's nothing special going on with <code>?.</code> here, it works just like it does with <code>?:</code>: <code>logger?.Log</code> would give the same result as <code>logger == null ? null : logger.Log</code>, except for <code>logger</code> only being evaluated once.</p>\n\n<p>The problem is that <code>logger == null ? null : logger.Log</code> is just as invalid in earlier versions of C#. <code>?:</code> requires one operand to be convertible to the type of the other, but neither <code>null</code> nor <code>logger.Log</code> have a type. You'd have to write that as e.g. <code>logger == null ? null : (Action&lt;string&gt;) logger.Log</code>.</p>\n\n<p>Unfortunately, the introduction of that cast means there's no simple pretty C# 6 shortened version you can use, as the same applies to <code>?.</code>: <code>logger?.Log</code> is invalid because <code>logger.Log</code> does not have a type, so <code>logger?.Log</code> doesn't have a type either, but if it's an expression without a type, and it's not a method group, then there's nothing C# would let you do with it.</p>\n"}, {"comments": [{"owner": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "edited": false, "score": 0, "creation_date": 1453403891, "post_id": 34932215, "comment_id": 57597702, "body": "I&#39;m not really sure about this statement: &quot;because people will prefer that if string is null then it should return 0&quot;. This isn&#39;t how nullables work; there&#39;s so such thing as default values with null-checking operator, you either get null or value."}, {"owner": {"reputation": 3199, "user_id": 892214, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/s6WBG.jpg?s=128&g=1", "display_name": "Banketeshvar Narayan", "link": "https://stackoverflow.com/users/892214/banketeshvar-narayan"}, "reply_to_user": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "edited": false, "score": 0, "creation_date": 1453405201, "post_id": 34932215, "comment_id": 57598426, "body": "@AhmedA.Hamid, I have provided an example that it can be used in this way also.   we have another usage of null conditional operator too. like when you are working with event handling in that case we can use  myCustomEventHandler?.Invoke(this, EventArgs.Empty); where &quot;myCustomEventHandler&quot; is public event  before C#6.0 we have to create local copy of &quot;myCustomEventHandler&quot; otherwise it may throw exception in case of muti-threaded application. whereas in C# 6 we can directly call the &quot;myCustomEventHandler&quot; without creating local copy and it is thread safe."}], "tags": [], "owner": {"reputation": 3199, "user_id": 892214, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/s6WBG.jpg?s=128&g=1", "display_name": "Banketeshvar Narayan", "link": "https://stackoverflow.com/users/892214/banketeshvar-narayan"}, "is_accepted": false, "score": -1, "last_activity_date": 1453405752, "last_edit_date": 1453405752, "creation_date": 1453403049, "answer_id": 34932215, "question_id": 34909915, "link": "https://stackoverflow.com/questions/34909915/operator-cannot-be-applied-to-operand-of-type-method-group/34932215#34932215", "title": "Operator &#39;?&#39; cannot be applied to operand of type &#39;method group&#39;", "body": "<p>Adding to @hvd  statement</p>\n\n<p>We can also use <strong>Null Conditional Operator ( ?. )</strong> with <strong>Null-Coalescing Operator ( ?? )</strong>\n If you write following code</p>\n\n<pre><code>string userName = null;\nint len = userName.Length;\n</code></pre>\n\n<p>then </p>\n\n<pre><code>userName.Length\n</code></pre>\n\n<p>will throw the exception: \"An unhandled exception of type 'System.NullReferenceException' occurred in ConsoleApplication...\n Additional information: Object reference not set to an instance of an object.\"</p>\n\n<p>if you use the following code  </p>\n\n<pre><code>string userName = null;\nint? len = userName.Length;\n</code></pre>\n\n<p>still you will get the same exception</p>\n\n<p>But </p>\n\n<pre><code>int? len = userName?.Length;\n</code></pre>\n\n<p>It will return null and will not throw the exception</p>\n\n<p>But we are still having an issue. The issue is I am using int? (Nullable int) which is not good because people will prefer that if string is null then it should return 0.</p>\n\n<p><strong>So we can do this by combination of null Conditional Operator(?.) and null-coalescing Operator(??)</strong></p>\n\n<pre><code>int len = userName?.Length ?? 0;\n</code></pre>\n\n<p><strong>Added</strong></p>\n\n<p>we have another usage of null conditional operator too. </p>\n\n<p>like when you are working with event handling in that case we can use</p>\n\n<p>myCustomEventHandler?.Invoke(this, EventArgs.Empty); </p>\n\n<p>where \"myCustomEventHandler\" is public event before C#6.0 we have to create local copy of \"myCustomEventHandler\" otherwise it may throw exception in case of muti-threaded application. whereas in C# 6 we can directly call the \"myCustomEventHandler\" without creating local copy and it is thread safe.</p>\n\n<p>e.g. in C# 5</p>\n\n<pre><code>var handler= this.myCustomEventHandler;\nif (handler!= null)\n    handler(\u2026)\n</code></pre>\n\n<p>in C# 6</p>\n\n<pre><code>myCustomEventHandler?.Invoke(e)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1400, "user_id": 2968001, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/sZvV1.jpg?s=128&g=1", "display_name": "Stijn Van Antwerpen", "link": "https://stackoverflow.com/users/2968001/stijn-van-antwerpen"}, "is_accepted": false, "score": 0, "last_activity_date": 1507796813, "creation_date": 1507796813, "answer_id": 46704847, "question_id": 34909915, "link": "https://stackoverflow.com/questions/34909915/operator-cannot-be-applied-to-operand-of-type-method-group/46704847#46704847", "title": "Operator &#39;?&#39; cannot be applied to operand of type &#39;method group&#39;", "body": "<p>If you are able to change your interface to</p>\n\n<pre><code>interface ILogger\n{\n    //void Log(string message);\n    Action&lt;string&gt; Log {get; }\n}\n</code></pre>\n\n<p>Then you could use the <code>logger?.Log</code> notation.</p>\n\n<p>The ILogger implementation would then look something like</p>\n\n<pre><code>class Logger : ILogger\n{\n    Action&lt;string&gt; Log =&gt; str =&gt; { /* Do stuff with str */ };\n}\n</code></pre>\n"}], "owner": {"reputation": 228, "user_id": 5817793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d303279cd67822ddd2bc4113b70c409d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed A.Hamid", "link": "https://stackoverflow.com/users/5817793/ahmed-a-hamid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7149, "favorite_count": 2, "accepted_answer_id": 34910020, "answer_count": 3, "score": 13, "last_activity_date": 1507796813, "creation_date": 1453321875, "question_id": 34909915, "link": "https://stackoverflow.com/questions/34909915/operator-cannot-be-applied-to-operand-of-type-method-group", "title": "Operator &#39;?&#39; cannot be applied to operand of type &#39;method group&#39;", "body": "<p>This is a question about C#'s newly introduced null-checking operator.</p>\n\n<p>Assuming I have an interface like:</p>\n\n<pre><code>interface ILogger\n{\n    void Log(string message);\n}\n</code></pre>\n\n<p>and a function that expects a logging action:</p>\n\n<pre><code>void DoWork(Action&lt;string&gt; logAction)\n{\n    // Do work and use @logAction\n}\n</code></pre>\n\n<p>Why do I get the following compiler error if I try to write:</p>\n\n<pre><code>void Main(string[] args)\n{\n    ILogger logger = GetLogger(); // Assume GetLogger() may return null\n\n    //\n    // Compiler error: \n    // Operator '?' cannot be applied to operand of type 'method group'\n    //\n    DoWork(logger?.Log);   \n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "winforms"], "comments": [{"owner": {"reputation": 594, "user_id": 1488675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c1934c8c16a4a47e680496f274c8f7?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/1488675/martin"}, "edited": false, "score": 0, "creation_date": 1453321956, "post_id": 34909898, "comment_id": 57555548, "body": "Can you explain what is not working?"}, {"owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "edited": false, "score": 0, "creation_date": 1453321962, "post_id": 34909898, "comment_id": 57555552, "body": "what exactly doesn&#39;t work? please be more specific."}, {"owner": {"reputation": 37, "user_id": 4704250, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d429b751007211420c7c5db08d9a0ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursaciuc Adrian", "link": "https://stackoverflow.com/users/4704250/ursaciuc-adrian"}, "edited": false, "score": 0, "creation_date": 1453322189, "post_id": 34909898, "comment_id": 57555712, "body": "it&#39;s dissapearing from form, i think is because i calucalte wrong <b>R1</b> and <b>R2</b>"}, {"owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "edited": false, "score": 0, "creation_date": 1453322189, "post_id": 34909898, "comment_id": 57555713, "body": "are you using some sort of update function or timer to recalculate the earth location every so often? you should be if you want to see it move."}, {"owner": {"reputation": 594, "user_id": 1488675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90c1934c8c16a4a47e680496f274c8f7?s=128&d=identicon&r=PG", "display_name": "Martin", "link": "https://stackoverflow.com/users/1488675/martin"}, "edited": false, "score": 1, "creation_date": 1453322278, "post_id": 34909898, "comment_id": 57555757, "body": "What was the expected values for R1 and R2, and what did you get instead?"}, {"owner": {"reputation": 37, "user_id": 4704250, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d429b751007211420c7c5db08d9a0ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursaciuc Adrian", "link": "https://stackoverflow.com/users/4704250/ursaciuc-adrian"}, "edited": false, "score": 0, "creation_date": 1453322460, "post_id": 34909898, "comment_id": 57555858, "body": "that&#39;s the problem, i don&#39;t know how to get that value"}], "answers": [{"tags": [], "owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "is_accepted": true, "score": 0, "last_activity_date": 1453322802, "creation_date": 1453322802, "answer_id": 34910177, "question_id": 34909898, "link": "https://stackoverflow.com/questions/34909898/solar-system-program/34910177#34910177", "title": "Solar System program", "body": "<p>Don't try to calculate the new position based on the old position. Instead, use the sun's position (fixed, I assume), the distance of earth from the sun, and the angle. Change the angle when you want to move the earth.</p>\n\n<p>You need some setup like this:</p>\n\n<pre><code>// angle\ndouble alpha = 0;   // radians, so from zero to 2*PI is a circle.\n\n// distance from the sun\ndouble r1 = 200; // or whatever you decide\ndouble r2 = 100;\n</code></pre>\n\n<p>How to calculate Earth's position given the value of <code>alpha</code>:</p>\n\n<pre><code>x = sun.Location.X + (r1 * Math.Cos(alpha));\ny = sun.Location.Y + (r2 * Math.Sin(alpha));\n</code></pre>\n\n<p>Next, you probably want to look at making <code>alpha</code> change value every few milliseconds so that Earth will move.</p>\n"}], "owner": {"reputation": 37, "user_id": 4704250, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d429b751007211420c7c5db08d9a0ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Ursaciuc Adrian", "link": "https://stackoverflow.com/users/4704250/ursaciuc-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 0, "closed_date": 1453919686, "accepted_answer_id": 34910177, "answer_count": 1, "score": 0, "last_activity_date": 1453322802, "creation_date": 1453321811, "last_edit_date": 1453322270, "question_id": 34909898, "link": "https://stackoverflow.com/questions/34909898/solar-system-program", "closed_reason": "Not suitable for this site", "title": "Solar System program", "body": "<p>I want to make a program with solar system planets.I have the Sun and planets (Mercury, Venus, Earth .. ) and i want to make the planets to move around the sun.</p>\n\n<p><a href=\"http://i.stack.imgur.com/AjEuI.png\" rel=\"nofollow\">Here is the math part</a></p>\n\n<p>Where <br><br>\n <strong>X=R1 * cos \u03b1 <br> Y=R2 * sin \u03b1 <br> \u03b1 = 1</strong> </p>\n\n<p>I try to implement it like this</p>\n\n<pre><code>        double x;\n        double y;\n\n\n        x = (earth.Location.X - sun.Location.X) * Math.Cos(1);\n        y = (earth.Location.Y - sun.Location.Y+30) * Math.Sin(1);\n\n        earth.Location = new Point(Convert.ToInt32(x), Convert.ToInt32(y));\n</code></pre>\n\n<p>but is not really working,it's dissapearing from form, can someone help me ?</p>\n\n<p><strong>P.S: i use a timer for that code</strong></p>\n"}, {"tags": ["c#", "sql-server", "winforms", "entity-framework", "visual-studio-2015"], "comments": [{"owner": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1453321624, "post_id": 34909744, "comment_id": 57555348, "body": "You need to show us the code. The <code>bool?</code> means that it is a nullable boolean."}, {"owner": {"reputation": 21, "user_id": 5236799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8adcb87aba1b9e1a37a8f29740ae7b?s=128&d=identicon&r=PG&f=1", "display_name": "HES", "link": "https://stackoverflow.com/users/5236799/hes"}, "reply_to_user": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1453756561, "post_id": 34909744, "comment_id": 57733121, "body": "The Solution has a database with three tables:"}, {"owner": {"reputation": 21, "user_id": 5236799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8adcb87aba1b9e1a37a8f29740ae7b?s=128&d=identicon&r=PG&f=1", "display_name": "HES", "link": "https://stackoverflow.com/users/5236799/hes"}, "reply_to_user": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1454173651, "post_id": 34909744, "comment_id": 57930014, "body": "Thanks. I uninstalled Community 2015 and installed VS Community 2013 - Update 5 plus Nuget Framework. All works fine. Not the ideal solution but one gains time until the bug is fixed."}], "owner": {"reputation": 21, "user_id": 5236799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8adcb87aba1b9e1a37a8f29740ae7b?s=128&d=identicon&r=PG&f=1", "display_name": "HES", "link": "https://stackoverflow.com/users/5236799/hes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453757444, "creation_date": 1453321320, "last_edit_date": 1453757444, "question_id": 34909744, "link": "https://stackoverflow.com/questions/34909744/entityframework-creates-corrupt-getsetter-files-and-datasources-for-use-in-winfo", "title": "EntityFramework creates corrupt GetSetter files and DataSources for use in Winforms", "body": "<p>Visual Studio 2015 Community - SSMS 2016 - Entity Framework 6.1.3 - .NET 4.6</p>\n\n<p>Visual Studio crashes every time when a DataSource from entities is slid onto a WinForm, when the Table used has a relation of any kind to another table.\nWhen the table has no relationships, it can be slid as a DataGrid or with Detail fields, but:\n1. All fields will be moved with DataGrid. Many field will not be moved in Detail view. \n2. All but the \"Id\" field are marked with \"none\" and are not moved to the Form, unless mart as a field type.\n3. Some field like DateTime, DateTime2, int and others cannot be moved because the FieldType selector does not to offer the change.</p>\n\n<p>When examining the Get/Setter files there are (at least) two things I can identify as \"abnormal\": \n     a) Boolean fields a have question mark after the word bool.\n     b) The NOT_NULL is inserted in the wrong place in the line.</p>\n\n<p>Is there a known way to get correct code generated?\nIs there a way to get relationships created in VS or in SSMS working with the entities?</p>\n\n<p>I have tested this with a Local DB - SQL Server that comes as part of VS 2015 Community, using Code First from Database and with the EF Designer from Database. I have tested this with a DB I created in SSMS, with the Northwind Database and with a minimal database created from scratch in  VisualStudio; all with the crash and corrupt DataSource files. I have repaired and reinstalled VS and tested it on two different PCs.\nThe only thing I can think of is that either the template used to generate the Entity Framework is deffective, or the databases, once opened in SSMS 2016 are not fully readable by VS 2015.</p>\n\n<p>I am fairly new to VS  (coming from VSP) and unable to continue until this is solved.\nPlease help.</p>\n\n<p>The Solution has a database with three tables: Customer, Product and Supplier, autogenerated by VS.                                                                                                      </p>\n\n<pre><code>namespace EntTrade\n{\n    using System;\n    using System.Collections.Generic;\n\n    public partial class Customer\n    {\n        public int Id { get; set; }\n        public string Name { get; set; }\n        public Nullable&lt;bool&gt; IsActive { get; set; }\n        public Nullable&lt;System.DateTime&gt; HireDate { get; set; }\n    }\n}                                                                                                                                      \n\nnamespace EntTrade\n{\n    using System;\n    using System.Collections.Generic;\n\n    public partial class Product\n    {\n        [System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2214:DoNotCallOverridableMethodsInConstructors\")]\n        public Product()\n        {\n            this.Suppliers = new HashSet&lt;Supplier&gt;();\n        }\n\n        public int Id { get; set; }\n        public string Name { get; set; }\n        public Nullable&lt;int&gt; ShelfLife { get; set; }\n\n        [System.Diagnostics.CodeAnalysis.SuppressMessage(\"Microsoft.Usage\", \"CA2227:CollectionPropertiesShouldBeReadOnly\")]\n        public virtual ICollection&lt;Supplier&gt; Suppliers { get; set; }\n    }\n}\n                                                                                                                         namespace EntTrade\n{\n    using System;\n    using System.Collections.Generic;\n\n    public partial class Supplier\n    {\n        public int Id { get; set; }\n        public string CompanyName { get; set; }\n        public string Address { get; set; }\n        public int ProductId { get; set; }\n\n        public virtual Product Product { get; set; }\n    }\n}\n</code></pre>\n\n<p>Customer will slide from the DataSources Window onto the form (in \"detail\" mode) all non-nullable fields. Product and Supplier will not, and the program will hang and reboot. All code is system generated (no coding by me).\nHangs every time with this database, with Northwind and with my customers database.</p>\n"}, {"tags": ["c#", "asp.net", ".net", "asp.net-web-api", "asp.net-web-api2"], "comments": [{"owner": {"reputation": 968, "user_id": 5785878, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/5A3KW.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/5785878/james"}, "edited": false, "score": 0, "creation_date": 1453326384, "post_id": 34909715, "comment_id": 57558018, "body": "Could you aggregate your filter logic in to one filter? You would have total control over the execution order then."}, {"owner": {"reputation": 15538, "user_id": 1350476, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1fdc7b4b3da278b1c1c5b4c4b250bafb?s=128&d=identicon&r=PG", "display_name": "SharpCoder", "link": "https://stackoverflow.com/users/1350476/sharpcoder"}, "reply_to_user": {"reputation": 968, "user_id": 5785878, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/5A3KW.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/5785878/james"}, "edited": false, "score": 0, "creation_date": 1453326874, "post_id": 34909715, "comment_id": 57558298, "body": "@James: I will do that only if I do not come across any solid answer. Currently the filters are getting executed in same order in which they got added. But I have not come across any article that confirm the same."}, {"owner": {"reputation": 4554, "user_id": 192221, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/38504ff52422b72b239a7b05ef0ccaae?s=128&d=identicon&r=PG", "display_name": "kristianp", "link": "https://stackoverflow.com/users/192221/kristianp"}, "edited": false, "score": 0, "creation_date": 1464919557, "post_id": 34909715, "comment_id": 62694107, "body": "It doesn&#39;t seem like much has changed here since 2.1, so this should apply: <a href=\"http://stackoverflow.com/questions/21628467/order-of-execution-with-multiple-filters-in-web-api\" title=\"order of execution with multiple filters in web api\">stackoverflow.com/questions/21628467/&hellip;</a>"}], "owner": {"reputation": 15538, "user_id": 1350476, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1fdc7b4b3da278b1c1c5b4c4b250bafb?s=128&d=identicon&r=PG", "display_name": "SharpCoder", "link": "https://stackoverflow.com/users/1350476/sharpcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453322978, "creation_date": 1453321218, "last_edit_date": 1453322978, "question_id": 34909715, "link": "https://stackoverflow.com/questions/34909715/asp-net-web-api-2-2-authorizationfilterattribute-manage-order", "title": "asp.net web api 2.2 AuthorizationFilterAttribute manage order", "body": "<p>I am using <strong>asp.net web api 2.2</strong>. I have created 3 AuthorizationFilterAttribute. Lets call them <code>A, B &amp; C</code>. Since these filters are global filters I have added them under <code>WebApiConfig.cs</code> file.</p>\n\n<pre><code>config.Filters.Add(new A());\nconfig.Filters.Add(new B());\nconfig.Filters.Add(new C());\n</code></pre>\n\n<p>All the filters are AuthorizationFilter &amp; are global (not specific to controller or action). I want to ensure Filter A get executed first then filter B and then filter C. </p>\n\n<p>What do I need to do to ensure filters gets executed in specific order? <code>So far What I am seeing is, the filters get called in the order in which they got added.</code> </p>\n"}, {"tags": ["c#", "facebook", "encoding", "response"], "comments": [{"owner": {"reputation": 947, "user_id": 864433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9119fed98488e35dd4d179eb4a08c44d?s=128&d=identicon&r=PG", "display_name": "Clay Ver Valen", "link": "https://stackoverflow.com/users/864433/clay-ver-valen"}, "edited": false, "score": 1, "creation_date": 1453321525, "post_id": 34909712, "comment_id": 57555285, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/system.text.encoding.utf8(v=vs.110).aspx\" rel=\"nofollow noreferrer\">This</a> posting on MSDN includes code to convert from UTF8 to something more easily readable."}, {"owner": {"reputation": 81732, "user_id": 1427878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db5fbf44c0eeeaf38c4e4a54ce9eff7a?s=128&d=identicon&r=PG&f=1", "display_name": "CBroe", "link": "https://stackoverflow.com/users/1427878/cbroe"}, "edited": false, "score": 2, "creation_date": 1453376982, "post_id": 34909712, "comment_id": 57579481, "body": "That is for sure not the <i>whole</i> API response. The API returns JSON, and that\u2019s how unicode is escaped in JSON. Really <i>all</i> you have to do, is decode the JSON."}], "owner": {"reputation": 163, "user_id": 3588235, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/fd555656c5428f18a86786b334b473b2?s=128&d=identicon&r=PG&f=1", "display_name": "user3588235", "link": "https://stackoverflow.com/users/3588235/user3588235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453323884, "creation_date": 1453321204, "last_edit_date": 1453323884, "question_id": 34909712, "link": "https://stackoverflow.com/questions/34909712/convert-response-as-u041d-u0438-to-readable-format", "title": "Convert response as u041d u0438 to readable format", "body": "<p>Work with Facebook API and my response from request is:</p>\n\n<pre><code>\\u041d\\u0438\\u043a\\u0438\\u0442\\u0430\n</code></pre>\n\n<p>How can I convert this string to normal readable string. I think format must be UTF8. I work with C#.</p>\n"}, {"tags": ["c#", "asp.net", "linq-to-entities"], "comments": [{"owner": {"reputation": 36783, "user_id": 2946329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ygJ.jpg?s=128&g=1", "display_name": "Salah Akbari", "link": "https://stackoverflow.com/users/2946329/salah-akbari"}, "edited": false, "score": 2, "creation_date": 1453321192, "post_id": 34909686, "comment_id": 57555097, "body": "<i>below is simple example for understanding my question</i>. What is your question?"}, {"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 1, "creation_date": 1453321233, "post_id": 34909686, "comment_id": 57555113, "body": "I guess the question is, instead of modifying each property the OP wants to set the object reference to a new existing object."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453321269, "post_id": 34909686, "comment_id": 57555130, "body": "Do you want to set specific properties or all the properties?"}, {"owner": {"reputation": 349, "user_id": 4331353, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-VY2IpiE0Ugw/AAAAAAAAAAI/AAAAAAAAAYA/V7CG6hq3VPs/photo.jpg?sz=128", "display_name": "M.Muzammil", "link": "https://stackoverflow.com/users/4331353/m-muzammil"}, "edited": false, "score": 0, "creation_date": 1453321509, "post_id": 34909686, "comment_id": 57555274, "body": "Yes Habib you have understand my problem"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 1, "creation_date": 1453321678, "post_id": 34909686, "comment_id": 57555376, "body": "Can you explain the reason behind this? You can use AutoMapper to copy property values from the new object to the old object in less code if that is what you want."}], "answers": [{"tags": [], "owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "is_accepted": true, "score": 0, "last_activity_date": 1453329127, "creation_date": 1453329127, "answer_id": 34911911, "question_id": 34909686, "link": "https://stackoverflow.com/questions/34909686/update-data-in-linq-with-object-instead-of-set-properties/34911911#34911911", "title": "Update data in LINQ with Object instead of set properties", "body": "<p>Looks like you're looking for <a href=\"https://msdn.microsoft.com/en-us/library/system.data.entity.infrastructure.dbpropertyvalues.setvalues(v=vs.113).aspx\" rel=\"nofollow\"><code>CurrentValues.SetValues()</code></a>:</p>\n\n<pre><code>Employee emp_new = new Employee();\nemp_new.ID = 1 ;\nemp_new.Name = \"Ahmed\";\n\nEmployee temp = db.Employees.Find(1);\ndb.Entry(temp).CurrentValues.SetValues(emp_new);\n</code></pre>\n\n<p>This methods overwrites properties that both the target and the source object have in common (by name and type). Note that <code>emp_new</code> doesn't even have to be an <code>Employee</code> instance.</p>\n"}], "owner": {"reputation": 349, "user_id": 4331353, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-VY2IpiE0Ugw/AAAAAAAAAAI/AAAAAAAAAYA/V7CG6hq3VPs/photo.jpg?sz=128", "display_name": "M.Muzammil", "link": "https://stackoverflow.com/users/4331353/m-muzammil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 34911911, "answer_count": 1, "score": 1, "last_activity_date": 1453329127, "creation_date": 1453321114, "last_edit_date": 1453324536, "question_id": 34909686, "link": "https://stackoverflow.com/questions/34909686/update-data-in-linq-with-object-instead-of-set-properties", "title": "Update data in LINQ with Object instead of set properties", "body": "<p>I want to update my data with object instead of set properties. below is simple example for understanding my question really i am stuck in big problem on updating data </p>\n\n<pre><code>Employee emp_old = new Employee();\nemp_old.ID = 1 ;\nemp_old.Name = \"Muzammil\";\n\nEmployee emp_new = new Employee();\nemp_new.ID = 1 ;\nemp_new.Name = \"Ahmed\";\n\nEmployee temp = db.Employees.single(emp =&gt; emp.ID == emp_old.ID);\ntemp = emp_new;\n</code></pre>\n"}, {"tags": ["c#", "sockets", "singleton"], "comments": [{"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1453320962, "post_id": 34909578, "comment_id": 57554964, "body": "What is <code>ModuleManager.Current.GetModule(module.Name)</code> doing?"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1453341558, "post_id": 34909578, "comment_id": 57563481, "body": "Singletons can be shared within an app domain; if your projects are all loaded into the same app domain, they can all share the same singleton. But it&#39;s not clear that&#39;s really what your question is anyway. You seem instead to be trying to debug a hang in your program. But without a good <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that reliably reproduces the problem, I doubt much good help will be possible, never mind forthcoming."}, {"owner": {"reputation": 105, "user_id": 5208079, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-8fAk7NcvnOo/AAAAAAAAAAI/AAAAAAAAAEs/VLG_9UI1O80/photo.jpg?sz=128", "display_name": "Mlezi", "link": "https://stackoverflow.com/users/5208079/mlezi"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1453360933, "post_id": 34909578, "comment_id": 57569515, "body": "@Rob, I check wether a module with the same name has been registered before."}, {"owner": {"reputation": 105, "user_id": 5208079, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-8fAk7NcvnOo/AAAAAAAAAAI/AAAAAAAAAEs/VLG_9UI1O80/photo.jpg?sz=128", "display_name": "Mlezi", "link": "https://stackoverflow.com/users/5208079/mlezi"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1453361115, "post_id": 34909578, "comment_id": 57569598, "body": "@Peter Duniho, I know I&#39;m not exactly clear on the problem. But that&#39;s because I don&#39;t really get the problem myself either. For some reason when I debug the ModuleManager.Add() function, it doesn&#39;t break on anything when being called from the socket callback. But when it is called from somewhere else there seems to be no problem at all"}, {"owner": {"reputation": 2931, "user_id": 2505186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/DV6Bx.jpg?s=128&g=1", "display_name": "Tobias Knauss", "link": "https://stackoverflow.com/users/2505186/tobias-knauss"}, "edited": false, "score": 0, "creation_date": 1453486110, "post_id": 34909578, "comment_id": 57638057, "body": "Your conclusion is wrong. You also don&#39;t get the log line if the <code>if</code> clause is not executed. This is very likely the case because I could not find any issue in your code."}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 5208079, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-8fAk7NcvnOo/AAAAAAAAAAI/AAAAAAAAAEs/VLG_9UI1O80/photo.jpg?sz=128", "display_name": "Mlezi", "link": "https://stackoverflow.com/users/5208079/mlezi"}, "is_accepted": false, "score": 0, "last_activity_date": 1453649135, "creation_date": 1453649135, "answer_id": 34977546, "question_id": 34909578, "link": "https://stackoverflow.com/questions/34909578/why-does-my-program-hang-when-calling-function-from-socket-callback/34977546#34977546", "title": "Why does my program hang when calling function from socket callback?", "body": "<p>Okay, found the problem. I wasn't listening for modules on a different thread, so some weird behaviour showed up. Sorry for the nebulous question. I just couldn't put it the way i wanted..</p>\n"}], "owner": {"reputation": 105, "user_id": 5208079, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-8fAk7NcvnOo/AAAAAAAAAAI/AAAAAAAAAEs/VLG_9UI1O80/photo.jpg?sz=128", "display_name": "Mlezi", "link": "https://stackoverflow.com/users/5208079/mlezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1453649135, "creation_date": 1453320748, "last_edit_date": 1453361633, "question_id": 34909578, "link": "https://stackoverflow.com/questions/34909578/why-does-my-program-hang-when-calling-function-from-socket-callback", "title": "Why does my program hang when calling function from socket callback?", "body": "<p>I'm trying to access a wrapper for a Collection type(ModuleManager.cs) from a socket callback function. Whenever a client connects to this socket, I want it to give some data about itself to put it and it's socket into the ModuleManager.</p>\n\n<pre><code>private static void AddModule (StateObject state)\n    {\n        string[] ModuleInfo = state.sb.ToString().Split('|');\n\n        // Create the module object.\n        Module module = new Module();\n        module.Socket = state.workSocket;\n        module.Name = ModuleInfo[0];\n        module.Plugin = PluginManager.PluginManager.Current.GetPlugin(ModuleInfo[1].Substring(0, ModuleInfo[1].Length - 5));\n\n\n        File.AppendAllText(@\"C:\\log.txt\", System.DateTime.Now.ToString() + \" -&gt; [ModuleFinder] Adding module : \" + state.sb.ToString() + Environment.NewLine);\n        ModuleManager.Current.Add(module);\n    }\n</code></pre>\n\n<p>So basically the data to create the Module is in the state stringbuilder. The Module is created and then added to the ModuleManager:</p>\n\n<pre><code>    public void Add(Module module)\n    {\n        File.AppendAllText(@\"C:\\log.txt\", System.DateTime.Now.ToString() + \" -&gt; [ModuleManager] Adding Module: \" + module.Name + \" | \" + module.Plugin.Name + Environment.NewLine);\n        if (ModuleManager.Current.GetModule(module.Name) == null &amp;&amp; PluginManager.PluginManager.Current.GetPlugin(module.Plugin) != null)\n        {\n            Modules.Add(module);\n            File.AppendAllText(@\"C:\\log.txt\", System.DateTime.Now.ToString() + \" -&gt; [ModuleManager] Added Module: \" + module.Name + \" | \" + module.Plugin.Name + Environment.NewLine);\n        }\n    }\n</code></pre>\n\n<p>As you might have noticed, a logfile is created in the process, since the last log never gets appended I came to the conclusion that the program gets stuck on</p>\n\n<pre><code>Modules.Add(module)\n</code></pre>\n\n<p>But I have no idea why. When I then check the WebApp to see if there are any registered modules, no result.</p>\n\n<p>The full project on git: <a href=\"https://github.com/LarsGardien/EniacHome\" rel=\"nofollow\">https://github.com/LarsGardien/EniacHome</a></p>\n\n<p>Any help would be much appreciated, thanks in advance!</p>\n"}, {"tags": ["c#", "nhibernate", "asp.net-identity"], "answers": [{"comments": [{"owner": {"reputation": 44021, "user_id": 8741, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/feef9dda8bbe41e9def78c274a37f60c?s=128&d=identicon&r=PG", "display_name": "ProfK", "link": "https://stackoverflow.com/users/8741/profk"}, "edited": false, "score": 0, "creation_date": 1453356665, "post_id": 34913671, "comment_id": 57567829, "body": "Wonderful. I only started with NHibernate two weeks ago, and found it clumsy compared to EF 6, but each time I learn something like this, I love it even more. Thanks."}], "tags": [], "owner": {"reputation": 2762, "user_id": 1486443, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2zfhf.jpg?s=128&g=1", "display_name": "Najera", "link": "https://stackoverflow.com/users/1486443/najera"}, "is_accepted": true, "score": 0, "last_activity_date": 1453338665, "creation_date": 1453338665, "answer_id": 34913671, "question_id": 34909410, "link": "https://stackoverflow.com/questions/34909410/how-can-i-determine-how-an-nhibernate-entity-key-is-generated-at-execution-time/34913671#34913671", "title": "How can I determine how an NHibernate entity key is generated at execution time?", "body": "<p>You need can get the identifier generator using the <code>SessionFactory</code>:</p>\n\n<pre><code>var generator = ((ISessionFactoryImplementor)Session.SessionFactory)\n    .GetIdentifierGenerator(typeof(TEntity).FullName);\n\nif (generator is Assigned)\n{\n    // Generate the identifier\n}\n</code></pre>\n"}], "owner": {"reputation": 44021, "user_id": 8741, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/feef9dda8bbe41e9def78c274a37f60c?s=128&d=identicon&r=PG", "display_name": "ProfK", "link": "https://stackoverflow.com/users/8741/profk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 34913671, "answer_count": 1, "score": 2, "last_activity_date": 1453338665, "creation_date": 1453320095, "question_id": 34909410, "link": "https://stackoverflow.com/questions/34909410/how-can-i-determine-how-an-nhibernate-entity-key-is-generated-at-execution-time", "title": "How can I determine how an NHibernate entity key is generated at execution time?", "body": "<p>I have adapted the Identity Entity Framework project to an NHibernate version. Now I have an <code>ApplicationUser</code> class like this:</p>\n\n<pre><code>public class ApplicationUser : IdentityUser&lt;TKey&gt;\n{\n    // TODO Auto determine if Id must be generated here or at DB.\n    public async Task&lt;ClaimsIdentity&gt; GenerateUserIdentityAsync(UserManager&lt;ApplicationUser, TKey&gt; manager)\n    {\n        // Note the authenticationType must match the one defined in CookieAuthenticationOptions.AuthenticationType\n        var userIdentity = await manager.CreateIdentityAsync(this, DefaultAuthenticationTypes.ApplicationCookie);\n\n        // Add custom user claims here\n        return userIdentity;\n    }\n}\n</code></pre>\n\n<p>In my current project, we use <code>int</code> keys for everything, backed by <code>Identity</code> fields in the database. In this scenario, I would prefer the method generated a negative int temporary id, instead of using <code>manager.CreateIdentityAsync</code>, but if I use Identity as it is normally used, and <code>typeof(TKey)</code> is <code>string</code>, I'd like this method to work normally. </p>\n\n<p>But, NB, I'm not concerned with the type of the id, but whether I must generate it in my app, or whether the DB will generate it for me, and that is what I want to find out at run time.</p>\n"}, {"tags": ["c#", "vb.net"], "comments": [{"owner": {"reputation": 3550, "user_id": 367726, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/930c39adbfc69c06d414c72fb8d57061?s=128&d=identicon&r=PG", "display_name": "Kyle W", "link": "https://stackoverflow.com/users/367726/kyle-w"}, "edited": false, "score": 2, "creation_date": 1453320348, "post_id": 34909325, "comment_id": 57554619, "body": "When you say &quot;it magically works&quot; do you mean that it compiles?"}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 1, "creation_date": 1453320360, "post_id": 34909325, "comment_id": 57554624, "body": "In both cases you could do the increment before the if, which IMHO would be more readable anyway."}, {"owner": {"reputation": 15215, "user_id": 187526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/945ce46bc3a5619ea401bf6f5329725a?s=128&d=identicon&r=PG", "display_name": "Mark Peters", "link": "https://stackoverflow.com/users/187526/mark-peters"}, "edited": false, "score": 0, "creation_date": 1453320413, "post_id": 34909325, "comment_id": 57554654, "body": "Not sure why the VB doesn&#39;t work, but I would avoid side effects in an if statement and make the code more explicit"}, {"owner": {"reputation": 1422, "user_id": 4498937, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/o2VBg.png?s=128&g=1", "display_name": "terbubbs", "link": "https://stackoverflow.com/users/4498937/terbubbs"}, "edited": false, "score": 0, "creation_date": 1453320559, "post_id": 34909325, "comment_id": 57554732, "body": "<a href=\"http://www.tutorialspoint.com/vb.net/vb.net_operators.htm\" rel=\"nofollow noreferrer\">tutorialspoint.com/vb.net/vb.net_operators.htm</a> well according to this, it&#39;s the same.."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1453320601, "post_id": 34909325, "comment_id": 57554759, "body": "I assume you&#39;re getting a compile error? I don&#39;t think you can use the result of an assignment statement like that in VB."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453321011, "post_id": 34909325, "comment_id": 57554991, "body": "why don&#39;t you post the full code block for the C# and VB so that we can see what you are doing and or not doing.."}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 1, "creation_date": 1453321296, "post_id": 34909325, "comment_id": 57555146, "body": "This <a href=\"http://stackoverflow.com/questions/3350433/vb-net-assign-value-to-variable-inside-an-if-condition\">question</a> seems related."}, {"owner": {"reputation": 501, "user_id": 2990244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vHSas.jpg?s=128&g=1", "display_name": "SomeNickName", "link": "https://stackoverflow.com/users/2990244/somenickname"}, "reply_to_user": {"reputation": 3550, "user_id": 367726, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/930c39adbfc69c06d414c72fb8d57061?s=128&d=identicon&r=PG", "display_name": "Kyle W", "link": "https://stackoverflow.com/users/367726/kyle-w"}, "edited": false, "score": 0, "creation_date": 1453321357, "post_id": 34909325, "comment_id": 57555188, "body": "@KyleW yes, it compiles, i wanted to make it a one-liner because the code is fairly short (5 lines) and there is no need to extend in this case, i can post the rest of the code but it wouldn&#39;t matter to the problem."}], "answers": [{"comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1453321243, "post_id": 34909471, "comment_id": 57555117, "body": "I&#39;m not sure you&#39;re first example would work since VB.Net uses <code>=</code> for both assignment and comparison, vs C# that uses <code>==</code> for comparisons instead."}, {"owner": {"reputation": 501, "user_id": 2990244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vHSas.jpg?s=128&g=1", "display_name": "SomeNickName", "link": "https://stackoverflow.com/users/2990244/somenickname"}, "edited": false, "score": 0, "creation_date": 1453321459, "post_id": 34909471, "comment_id": 57555248, "body": "Your first example doesn&#39;t compile with option strict on, and if i turn it off the code doesn&#39;t do what i want, which i&#39;m sure is because of the problem i faced."}, {"owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "edited": false, "score": 0, "creation_date": 1453321492, "post_id": 34909471, "comment_id": 57555269, "body": "Yes, you guys are correct.. I usually live in the c# world, I&#39;ll edit it.. thanks"}, {"owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "reply_to_user": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1453321670, "post_id": 34909471, "comment_id": 57555370, "body": "@juharr is correct, VB uses <code>=</code> as a comparator as well as an assignment operator"}], "tags": [], "owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "is_accepted": true, "score": 4, "last_activity_date": 1453321541, "last_edit_date": 1453321541, "creation_date": 1453320346, "answer_id": 34909471, "question_id": 34909325, "link": "https://stackoverflow.com/questions/34909325/plusequal-operator-inside-if-statement/34909471#34909471", "title": "plusequal operator inside if statement", "body": "<p>This should let you do what you need to do.</p>\n\n<pre><code>Dim toAdd As Integer = 0\nDim list As New List(Of Integer)() From {1500, 1500, 1200, 1200, 1100, 1100, 1100, 1100, 1000, 1000, 900, 900, 600, 600, 600, 600, 400, 400, 400, 400}\n\nFor i As Integer = 0 To list.Count - 1\n    toAdd = toAdd + list(i)\n    If toAdd &lt;= (3000 - list(i)) Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "edited": false, "score": 0, "creation_date": 1453321276, "post_id": 34909670, "comment_id": 57555137, "body": "in most other languages you can do <code>if((x = y + 1) &lt;= z)</code> which is essentially what you are trying to say I think, but I&#39;m not on the up and up with my VB code so you could very well be correct"}, {"owner": {"reputation": 501, "user_id": 2990244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vHSas.jpg?s=128&g=1", "display_name": "SomeNickName", "link": "https://stackoverflow.com/users/2990244/somenickname"}, "edited": false, "score": 0, "creation_date": 1453321656, "post_id": 34909670, "comment_id": 57555361, "body": "Yea, i understand now, i will have to separate the += operator from the if statement, i&#39;ve tried many things but vb doesn&#39;t allow it... thanks."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1453327333, "post_id": 34909670, "comment_id": 57558572, "body": "I don&#39;t know if &quot;most other languages&quot; support that. You probably mean &quot;in C-derived languages.&quot; Which probably makes up the majority of languages in popular use today, but a small fraction of all the computer languages in existence."}], "tags": [], "owner": {"reputation": 3550, "user_id": 367726, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/930c39adbfc69c06d414c72fb8d57061?s=128&d=identicon&r=PG", "display_name": "Kyle W", "link": "https://stackoverflow.com/users/367726/kyle-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1453321070, "creation_date": 1453321070, "answer_id": 34909670, "question_id": 34909325, "link": "https://stackoverflow.com/questions/34909325/plusequal-operator-inside-if-statement/34909670#34909670", "title": "plusequal operator inside if statement", "body": "<p>I don't think VB.Net supports what you're trying to do.  Consider <code>x = y = z</code>.  It won't evaluate that as <code>set y = z, then set x = y</code>, it will evaluate it as <code>set x equal to the result of whether y is equal to z</code>.  I think it expects the += to be an entire statement, and not part of a subexpression.  Its the presence inside the if that is screwing it up.  Thus, I think the best result is to remove that from the if statement.</p>\n\n<pre><code>For i As Integer = 0 To list.Count - 1\n    toAdd = toAdd + list(i)\n    If toAdd &lt;= (3000 - list(i)) Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 2990244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vHSas.jpg?s=128&g=1", "display_name": "SomeNickName", "link": "https://stackoverflow.com/users/2990244/somenickname"}, "edited": false, "score": 0, "creation_date": 1453321951, "post_id": 34909879, "comment_id": 57555542, "body": "Thanks for the simple explanation, i guess i moved from vb to c# too early to understand it."}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 1, "creation_date": 1453326605, "post_id": 34909879, "comment_id": 57558164, "body": "<code>a = b += 12;  &#47;&#47; works in C#, but not in VB</code> <b><i>of course not</i></b> you left the <b>&quot;;&quot;</b> in which wont compile in vb... :)"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1453327145, "post_id": 34909879, "comment_id": 57558458, "body": "Those #@$% semicolons."}], "tags": [], "owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "is_accepted": false, "score": 6, "last_activity_date": 1453352176, "last_edit_date": 1453352176, "creation_date": 1453321747, "answer_id": 34909879, "question_id": 34909325, "link": "https://stackoverflow.com/questions/34909325/plusequal-operator-inside-if-statement/34909879#34909879", "title": "plusequal operator inside if statement", "body": "<p>You can't do that in Visual Basic.</p>\n\n<p>In C#, assignments are considered expressions. In VB they're statements, but not expressions. So this statement is valid in C#, but not VB (even when you remove the semicolon):</p>\n\n<pre><code>a = b += 12;  // works in C#, but not in VB\n</code></pre>\n\n<p>Or, said another way, assignment expressions in C# return a value. In VB, assignment statements do not return a value.</p>\n"}], "owner": {"reputation": 501, "user_id": 2990244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/vHSas.jpg?s=128&g=1", "display_name": "SomeNickName", "link": "https://stackoverflow.com/users/2990244/somenickname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 34909471, "answer_count": 3, "score": 1, "last_activity_date": 1453352176, "creation_date": 1453319781, "last_edit_date": 1453320946, "question_id": 34909325, "link": "https://stackoverflow.com/questions/34909325/plusequal-operator-inside-if-statement", "title": "plusequal operator inside if statement", "body": "<pre><code>int toAdd = 0;\nList&lt;int&gt; list = new List&lt;int&gt; {1500, 1500, 1200, 1200, 1100, 1100, 1100, 1100, 1000, 1000, 900, 900, 600, 600, 600, 600, 400, 400, 400, 400};\n\nfor (int i = 0; i &lt; list.Count; i++) \n{\n    if ((toAdd += list[i]) &lt;= (3000 - list[i])) \n    {\n</code></pre>\n\n<p>This c# code works, this vb code doesn't:</p>\n\n<pre><code>Dim toAdd As Integer = 0\nDim list As New List(Of Integer)() From {1500, 1500, 1200, 1200, 1100, 1100, 1100, 1100, 1000, 1000, 900, 900, 600, 600, 600, 600, 400, 400, 400, 400}\n\nFor i As Integer = 0 To list.Count - 1\n    If (toAdd += list(i)) &lt;= (3000 - list(i)) Then\n</code></pre>\n\n<p>I've identified the problem being the '+=' operator, if i delete the '=' it magically works.</p>\n\n<p>Does vb.net handle the '+=' differently than c#? I can't understand how am i supposed to do what i'm trying to do inside the if statement in vb.</p>\n"}, {"tags": ["c#", "entity-framework", "foreign-keys", "entity-framework-6", "entitykey"], "answers": [{"comments": [{"owner": {"reputation": 3095, "user_id": 615288, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ZKBiE.jpg?s=128&g=1", "display_name": "KingKerosin", "link": "https://stackoverflow.com/users/615288/kingkerosin"}, "edited": false, "score": 0, "creation_date": 1453319694, "post_id": 34909258, "comment_id": 57554280, "body": "I&#39;m using <code>database-first</code> approach. So, the <code>entities</code> are generated and I can&#39;t update each of them each time I update the database."}, {"owner": {"reputation": 3196, "user_id": 444149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/11000ced4b79bd219c6b79d6c963d3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/444149/marty"}, "reply_to_user": {"reputation": 3095, "user_id": 615288, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ZKBiE.jpg?s=128&g=1", "display_name": "KingKerosin", "link": "https://stackoverflow.com/users/615288/kingkerosin"}, "edited": false, "score": 0, "creation_date": 1453319963, "post_id": 34909258, "comment_id": 57554403, "body": "That&#39;s why Your EntitiesContext class is generated as &#39;Partial&#39;. So there would be a place to put Your customisations that would not get overWriten when You update the model from DB.  Another thing - if EF thinks that the ID is autogenerated - Identity specification in SQL must be set to true (take a look at column properties in SQL)"}, {"owner": {"reputation": 3196, "user_id": 444149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/11000ced4b79bd219c6b79d6c963d3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/444149/marty"}, "reply_to_user": {"reputation": 3095, "user_id": 615288, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ZKBiE.jpg?s=128&g=1", "display_name": "KingKerosin", "link": "https://stackoverflow.com/users/615288/kingkerosin"}, "edited": false, "score": 0, "creation_date": 1453319998, "post_id": 34909258, "comment_id": 57554428, "body": "In my case - if I generate the model from DB, the prop ID (for ChronosItem) has StoreGeneratedPattern = None"}], "tags": [], "owner": {"reputation": 3196, "user_id": 444149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/11000ced4b79bd219c6b79d6c963d3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/444149/marty"}, "is_accepted": false, "score": 0, "last_activity_date": 1453320140, "last_edit_date": 1453320140, "creation_date": 1453319560, "answer_id": 34909258, "question_id": 34909203, "link": "https://stackoverflow.com/questions/34909203/set-entitykey-manually-without-accessing-the-database/34909258#34909258", "title": "Set EntityKey manually without accessing the database", "body": "<p>If You're using POCO's - here's a sample how it could be done</p>\n\n<pre><code>public class ChronosItem \n{\n    [Column, Key, Required, MaxLength(26), DatabaseGenerated(DatabaseGeneratedOption.None)]\n    public string Id { get;  set; }\n    ....\n</code></pre>\n\n<p>In case You cant adjust Your entities </p>\n\n<p>override the \"OnModelCreating\" method on Your context.. like so..</p>\n\n<pre><code>protected override void OnModelCreating(DbModelBuilder modelBuilder)\n        {\n            modelBuilder.Entity&lt;ChronosItem &gt;()\n                .HasKey(p =&gt; p.Id)\n                .Property(p =&gt; p.Id)\n                .HasDatabaseGeneratedOption(DatabaseGeneratedOption.None);\n</code></pre>\n"}], "owner": {"reputation": 3095, "user_id": 615288, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/ZKBiE.jpg?s=128&g=1", "display_name": "KingKerosin", "link": "https://stackoverflow.com/users/615288/kingkerosin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453322168, "creation_date": 1453319377, "last_edit_date": 1453322168, "question_id": 34909203, "link": "https://stackoverflow.com/questions/34909203/set-entitykey-manually-without-accessing-the-database", "title": "Set EntityKey manually without accessing the database", "body": "<p>In my application (database-first) the primary keys are always created by client, not by the underlying database.</p>\n\n<p>In Entity Framework v4 each <code>Entity</code> had it's <code>EntityKey</code> property that could be set manually.</p>\n\n<p>However, I can't find it anymore in EF6?</p>\n\n<p>Is there any specific reason why?</p>\n\n<p>I don't want to call <code>ctx.SaveChanges()</code> only to have an <code>Entity's</code> key set as this means a call to the database.</p>\n\n<p>I'm also wondering why <code>ObjectContext.CreateEntityKey</code> is gone?!</p>\n"}, {"tags": ["c#", "mysql", "entity-framework"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 1, "creation_date": 1453320482, "post_id": 34909170, "comment_id": 57554700, "body": "Any reason why you are writing SQL instead of using LINQ queries?"}, {"owner": {"reputation": 454, "user_id": 3859419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f19cd841009b448ea20a1bfb4a6357?s=128&d=identicon&r=PG&f=1", "display_name": "DivideByzero", "link": "https://stackoverflow.com/users/3859419/dividebyzero"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453327556, "post_id": 34909170, "comment_id": 57558683, "body": "@YacoubMassad Well, this is not my actual problem. I have just used two sample tables only for demonstration purpose of my question. There is a complex query comprising of joins, filters and conditions."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453327662, "post_id": 34909170, "comment_id": 57558741, "body": "all of which can be easier to specify via LINQ"}, {"owner": {"reputation": 454, "user_id": 3859419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f19cd841009b448ea20a1bfb4a6357?s=128&d=identicon&r=PG&f=1", "display_name": "DivideByzero", "link": "https://stackoverflow.com/users/3859419/dividebyzero"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1453327871, "post_id": 34909170, "comment_id": 57558840, "body": "@YacoubMassad the query includes a full text search as well, that&#39;s the main reason I opted for inline query instead of LINQ."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1453331870, "post_id": 34909170, "comment_id": 57560585, "body": "<code>SqlQuery</code> just doesn&#39;t create object graphs. Period. But may you can find some inspiration in <a href=\"http://www.entityframework.info/Home/FullTextSearch\" rel=\"nofollow noreferrer\">entityframework.info/Home/FullTextSearch</a>."}], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 5785644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/edV2F.jpg?s=128&g=1", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/5785644/konstantin"}, "is_accepted": false, "score": 3, "last_activity_date": 1453321349, "creation_date": 1453321349, "answer_id": 34909752, "question_id": 34909170, "link": "https://stackoverflow.com/questions/34909170/how-to-convert-inline-join-query-result-in-entityframework-to-an-entity/34909752#34909752", "title": "How to convert inline join query result in EntityFramework to an entity", "body": "<p>One option is to rewrite the SqlQuery using linq and use the Include property:</p>\n\n<pre><code>var customers = (from c in context.Customer\n  select c).Include(c =&gt; c.Address).ToList();\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/data/jj574232.aspx\" rel=\"nofollow\">Loading Related Entities</a> from MSDN for details.</p>\n"}, {"tags": [], "owner": {"reputation": 454, "user_id": 3859419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f19cd841009b448ea20a1bfb4a6357?s=128&d=identicon&r=PG&f=1", "display_name": "DivideByzero", "link": "https://stackoverflow.com/users/3859419/dividebyzero"}, "is_accepted": true, "score": 0, "last_activity_date": 1453327688, "creation_date": 1453327688, "answer_id": 34911582, "question_id": 34909170, "link": "https://stackoverflow.com/questions/34909170/how-to-convert-inline-join-query-result-in-entityframework-to-an-entity/34911582#34911582", "title": "How to convert inline join query result in EntityFramework to an entity", "body": "<p>Instead of running the query on the database, running the query on Customer entities solved my problem.</p>\n\n<pre><code> var customers= context.Customer.SqlQuery&lt;Customer&gt;( \n               \"SELECT * FROM Customer c INNER JOIN Address a ON a.CustomerId = c.Id\").ToList();\n</code></pre>\n"}], "owner": {"reputation": 454, "user_id": 3859419, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/50f19cd841009b448ea20a1bfb4a6357?s=128&d=identicon&r=PG&f=1", "display_name": "DivideByzero", "link": "https://stackoverflow.com/users/3859419/dividebyzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "accepted_answer_id": 34911582, "answer_count": 2, "score": 1, "last_activity_date": 1453327688, "creation_date": 1453319255, "question_id": 34909170, "link": "https://stackoverflow.com/questions/34909170/how-to-convert-inline-join-query-result-in-entityframework-to-an-entity", "title": "How to convert inline join query result in EntityFramework to an entity", "body": "<p>I have two entities named Customer and Address (one to one mapping, each Customer has an address), and I am using code first approach using Entity Framework.</p>\n\n<p>I have written inline sql query to fetch some details. </p>\n\n<pre><code> var customers= context.Database.SqlQuery&lt;Customer&gt;( \n                   \"SELECT * FROM Customer c INNER JOIN Address a ON a.CustomerId = c.Id\").ToList();\n</code></pre>\n\n<p>This statement is fetching only Customer details, Address property is NULL for all the customer objects being returned.</p>\n\n<p>How do I get the result of an inline join query as a Customer entity(maintaining the same structure). </p>\n"}, {"tags": ["c#", "asp.net", "xml", "serialization", "repeater"], "answers": [{"comments": [{"owner": {"reputation": 576, "user_id": 1876951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2270f482039c5495bd1a0099ef88fa55?s=128&d=identicon&r=PG", "display_name": "Devin Prejean", "link": "https://stackoverflow.com/users/1876951/devin-prejean"}, "edited": false, "score": 0, "creation_date": 1453321398, "post_id": 34909575, "comment_id": 57555213, "body": "Yes, another repeater should work so it can cycle through them all for that one job. When there are multiple values you have to loop through them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2635152"}, "edited": false, "score": 0, "creation_date": 1453325410, "post_id": 34909575, "comment_id": 57557490, "body": "Thank you very much for your assistance Mason and Devin. Your answers put me on the right track in solving my programming issue. Are there any beginner learning resources you would recommend for MVC and/or Razor?"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1453336654, "post_id": 34909575, "comment_id": 57562121, "body": "@danslik Well I provided two links in my answer. Then there&#39;s the usual places to look, such as MSDN, Pluralsight, <a href=\"https://channel9.msdn.com/Series/Introduction-to-ASP-NET-MVC\" rel=\"nofollow noreferrer\">Channel 9</a>, and YouTube."}], "tags": [], "owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "is_accepted": true, "score": 1, "last_activity_date": 1453321726, "last_edit_date": 1453321726, "creation_date": 1453320734, "answer_id": 34909575, "question_id": 34909158, "link": "https://stackoverflow.com/questions/34909158/asp-net-repeater-issue/34909575#34909575", "title": "ASP.NET Repeater issue", "body": "<p>Your location and salary data aren't stored directly in the <code>Job</code>. They're stored in the <code>JobLocation</code> property of <code>Job</code>, which is a collection object. That's why you can't access them like <code>&lt;%#Item.Salary%&gt;&lt;/div&gt;</code>, because there's multiple salaries/locations.</p>\n\n<p>Depending on how you want to display the data, you may need to have a nested repeater or other control that displays the salary.</p>\n\n<pre><code>&lt;asp:Repeater ID=\"Job\" runat=\"server\" ItemType=\"Job\" SelectMethod=\"JobGrid_GetData\"&gt;\n        &lt;ItemTemplate&gt;\n          &lt;div class=\"flex-item\"&gt;\n            &lt;div&gt;Title: &lt;%#Item.Title%&gt;&lt;/div&gt;\n            &lt;div&gt;S.Desc: &lt;%#Item.ShortDescription%&gt;&lt;/div&gt;\n            &lt;div&gt;\n                &lt;asp:Repeater runat=\"server\" ItemType=\"JobLocations\" DataSource=\"&lt;%# Item.JobLocation %&gt;\"&gt;\n                    &lt;ItemTemplate&gt;\n                        &lt;div&gt;Location: &lt;%#Item.Location%&gt; &lt;/div&gt;\n                        &lt;div&gt;Salary: &lt;%#Item.Salary%&gt; &lt;/div&gt;\n                    &lt;/ItemTemplate&gt;\n                &lt;/asp:Repeater&gt;\n            &lt;/div&gt;\n            &lt;div&gt;Category: &lt;%#Item.Category%&gt;&lt;/div&gt;\n            &lt;div&gt;Jobtype: &lt;%#Item.Jobtype%&gt;&lt;/div&gt;\n            &lt;div&gt;Benefits: &lt;%#Item.Benefits%&gt;&lt;/div&gt;  \n            &lt;div&gt;Desc: &lt;%#Item.Description%&gt;&lt;/div&gt;\n          &lt;/div&gt;  \n        &lt;/ItemTemplate&gt;        \n    &lt;/asp:Repeater&gt;\n</code></pre>\n\n<hr>\n\n<p>An alternative way of doing this is a foreach loop, but those end up looking a little ugly with all the <code>&lt;%</code> markup scattered everywhere. If you're not stuck on Web Forms, then switching to <a href=\"http://www.asp.net/mvc\" rel=\"nofollow\">MVC</a> so you can use <a href=\"http://www.asp.net/web-pages/overview/getting-started/introducing-razor-syntax-c\" rel=\"nofollow\">Razor markup</a> would be an improvement.</p>\n\n<pre><code>foreach(var job in jobs)\n{\n    &lt;div&gt;Title: @job.Title&lt;/div&gt;\n    &lt;div&gt;S.Desc: @job.ShortDescription&lt;/div&gt;\n    ...etc...\n    foreach(var jobLocation in job.JobLocation)\n    {\n        &lt;div&gt;Location: @jobLocation.Location&lt;/div&gt;\n        &lt;div&gt;Salary: @jobLocation.Salary&lt;/div&gt;\n    }\n    &lt;div&gt;Category: @job.Category&lt;/div&gt;\n    ...etc...\n}\n</code></pre>\n\n<hr>\n\n<p>Your <code>JobLocations</code> class should be renamed <code>JobLocation</code> and your <code>Job.JobLocation</code> property should be renamed <code>Job.JobLocations</code> in keeping with normal C# conventions. That's because the property represents a collection of job locations, so it makes sense to pluralize the name. However, the class represents a single instance so don't pluralize the name.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2635152"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 34909575, "answer_count": 1, "score": 0, "last_activity_date": 1453321726, "creation_date": 1453319229, "last_edit_date": 1453320772, "question_id": 34909158, "link": "https://stackoverflow.com/questions/34909158/asp-net-repeater-issue", "title": "ASP.NET Repeater issue", "body": "<p>I'm a new to .NET development and I have run into an issue with some data not showing up in my repeater. </p>\n\n<p>I have an XML file that I am deserializing and using a repeater to display that data. My issue is that the Location and Salary data are not showing up, every other XML element is.</p>\n\n<p>I am not sure how to access the JobLocations class and display Salary and Location.</p>\n\n<p>.xml </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;Jobs&gt;   \n  &lt;Job Category=\"Administration\" Title=\"Senior Human Resource Coordinator\"&gt;\n    &lt;Description&gt;\n      &lt;![CDATA[ Long description of the job goes here. ]]&gt;\n    &lt;/Description&gt;\n    &lt;ShortDescription&gt;\n      &lt;![CDATA[ Short description of the job goes here.  ]]&gt;\n    &lt;/ShortDescription&gt;\n    &lt;JobLocations&gt;\n      &lt;Location Salary=\"$50000\"&gt;Toronto&lt;/Location&gt;\n      &lt;Location Salary=\"\u00a335000\"&gt;London&lt;/Location&gt;\n    &lt;/JobLocations&gt;\n    &lt;Benefits&gt;Drug, Dental, Optical and Extended Healthcare Benefits&lt;/Benefits&gt;\n    &lt;Jobtype&gt;Full-Time&lt;/Jobtype&gt;\n  &lt;/Job&gt;\n&lt;/Job&gt;\n</code></pre>\n\n<p>.cs</p>\n\n<pre><code>[Serializable]\npublic class Job\n{        \n    [XmlAttribute]\n    public string Category { get; set; }\n    [XmlAttribute]\n    public string Title { get; set; }\n    [XmlElement]\n    public string Description { get; set; }\n    [XmlElement]\n    public string ShortDescription { get; set; }\n\n    [XmlElement(\"JobLocations\")]\n    public List&lt;JobLocations&gt; JobLocation { get; set; }\n\n    public string Benefits { get; set; }\n    [XmlElement]\n    public string Jobtype { get; set; }                \n\n\n    public class JobLocations\n    {\n        [XmlAttribute(\"Salary\")]\n        public string Salary { get; set; }\n        [XmlText]\n        public string Location { get; set; }\n    }\n\n    public static List&lt;Job&gt; Load( string path )\n    {\n        return SerializerSupport.DeserializeList&lt;Job&gt;(System.IO.Path.Combine( path, \"jobs.xml\" ) );\n    }\n</code></pre>\n\n<p>.aspx</p>\n\n<pre><code>&lt;asp:Repeater ID=\"Job\" runat=\"server\" ItemType=\"Job\" SelectMethod=\"JobGrid_GetData\"&gt;\n        &lt;ItemTemplate&gt;\n          &lt;div class=\"flex-item\"&gt;\n            &lt;div&gt;Title: &lt;%#Item.Title%&gt;&lt;/div&gt;\n            &lt;div&gt;S.Desc: &lt;%#Item.ShortDescription%&gt;&lt;/div&gt;\n            &lt;div&gt;Location: ??? &lt;/div&gt;\n            &lt;div&gt;Salary: ??? &lt;/div&gt;\n            &lt;div&gt;Category: &lt;%#Item.Category%&gt;&lt;/div&gt;\n            &lt;div&gt;Jobtype: &lt;%#Item.Jobtype%&gt;&lt;/div&gt;\n            &lt;div&gt;Benefits: &lt;%#Item.Benefits%&gt;&lt;/div&gt;  \n            &lt;div&gt;Desc: &lt;%#Item.Description%&gt;&lt;/div&gt;\n          &lt;/div&gt;  \n        &lt;/ItemTemplate&gt;        \n    &lt;/asp:Repeater&gt;\n</code></pre>\n\n<p>.aspx.cs</p>\n\n<pre><code>public partial class JobCategories : BasePage\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    public IEnumerable&lt;Job&gt; JobGrid_GetData()\n    {\n        return DataCache.Instance.Jobs;\n    }\n\n    public IEnumerable&lt;Job&gt; Jobs_GetData()\n    {\n        return null;\n    }\n\n    public static IEnumerable&lt;Job&gt; JobGrid_DistinctCategories()\n    {\n        return DataCache.Instance.Jobs.GroupBy(p =&gt; p.Category).Select(g =&gt; g.First()).ToList();\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "dependency-injection", "asp.net-core"], "answers": [{"comments": [{"owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1453321401, "post_id": 34909757, "comment_id": 57555218, "body": "I probably should have just tried it first. I apologize. I just realized that it works."}, {"owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1453321490, "post_id": 34909757, "comment_id": 57555267, "body": "One more question... I noticed that when referencing the new class library (package) you can&#39;t use the new dnxcore50 in your MVC app. Is it possible to still target dnxcore50 or do I basically have to remove it? For example if I want to reference my DataLibrary from my MVC project I keep getting an intellisense error saying it is available in 45 but not core50. My current solution is to just remove the framework dnxcore50 from my mvc app and in all class libraries remove dotnet5.4"}, {"owner": {"reputation": 777, "user_id": 3544846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13533ccc5128f74b1fef7dda69261d23?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Auty", "link": "https://stackoverflow.com/users/3544846/ian-auty"}, "reply_to_user": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1453322654, "post_id": 34909757, "comment_id": 57555978, "body": "I believe this <a href=\"http://stackoverflow.com/questions/31539341/project-json-definition-dnx451-vs-dotnet-4-51\">SO page</a> will answer your question on the different environments your app can target. Essentially, dnxcore50 is the .net core environment which is cross platform. dnxcore50 and dnx451 are not compatible with each other, however you can allow your app to target both environments."}], "tags": [], "owner": {"reputation": 777, "user_id": 3544846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13533ccc5128f74b1fef7dda69261d23?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Auty", "link": "https://stackoverflow.com/users/3544846/ian-auty"}, "is_accepted": false, "score": 1, "last_activity_date": 1453321360, "creation_date": 1453321360, "answer_id": 34909757, "question_id": 34909155, "link": "https://stackoverflow.com/questions/34909155/will-the-built-in-asp-net-5-dependency-resolver-resolve-dependencies-throughout/34909757#34909757", "title": "Will the built in ASP.NET 5 dependency resolver resolve dependencies throughout libraries outside of the MVC project", "body": "<p>Yes, they will be available if you have configured them correctly. I have successfully decoupled my Data Access Layer from my MVC app using Dependency Injection. Have you actually tried doing this yourself before you posted your question, or are you having trouble getting it working?</p>\n"}], "owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453321360, "creation_date": 1453319225, "question_id": 34909155, "link": "https://stackoverflow.com/questions/34909155/will-the-built-in-asp-net-5-dependency-resolver-resolve-dependencies-throughout", "title": "Will the built in ASP.NET 5 dependency resolver resolve dependencies throughout libraries outside of the MVC project", "body": "<p>I have a typical 3 tier project structure.</p>\n\n<p>ASP.NET 5 MVC App --> BusinessLayer --> DataLayer</p>\n\n<p>When I register services in the Startup.cs of the MVC app will it handle the constructor injection between the DataLayer and BusinessLayer?</p>\n\n<p>i.e.</p>\n\n<pre><code>private ICustomerRepository _repository;\npublic CustomerManager(ICustomerRepository repository)\n{\n     _repository = repository;\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "visual-studio", "webforms", "web-site-project"], "comments": [{"owner": {"reputation": 6155, "user_id": 3793448, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ilKH.jpg?s=128&g=1", "display_name": "Izzy", "link": "https://stackoverflow.com/users/3793448/izzy"}, "edited": false, "score": 0, "creation_date": 1464263257, "post_id": 34909110, "comment_id": 62419002, "body": "This you manage to solve this issue? As I&#39;ve come across it today"}, {"owner": {"reputation": 287, "user_id": 4698543, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9a7f11c50d0c75c2562c4a83ef66a975?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4698543/corey"}, "reply_to_user": {"reputation": 6155, "user_id": 3793448, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9ilKH.jpg?s=128&g=1", "display_name": "Izzy", "link": "https://stackoverflow.com/users/3793448/izzy"}, "edited": false, "score": 0, "creation_date": 1464365730, "post_id": 34909110, "comment_id": 62472599, "body": "We ended up copying a working folder from a dev&#39;s machine that was known to work. For whatever reason that cleared it up. You may try checking out your code from scratch in a new folder. Unfortunately it&#39;s just a guess as we weren&#39;t able to determine a root cause."}], "answers": [{"tags": [], "owner": {"reputation": 2295, "user_id": 1662973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ed645158328a98bc1123912751ea33f2?s=128&d=identicon&r=PG", "display_name": "Anthony Horne", "link": "https://stackoverflow.com/users/1662973/anthony-horne"}, "is_accepted": false, "score": 2, "last_activity_date": 1489132530, "last_edit_date": 1495541840, "creation_date": 1489132530, "answer_id": 42713106, "question_id": 34909110, "link": "https://stackoverflow.com/questions/34909110/could-not-load-the-assembly-the-property-assembly-must-be-a-valid-assembly-as/42713106#42713106", "title": "Could not load the assembly. The property &#39;assembly&#39; must be a valid assembly ASP.NET Website project", "body": "<p>What solved it for me was the \"Run Visual Studio as Administrator\".  </p>\n\n<p>I found the idea at <a href=\"https://social.msdn.microsoft.com/Forums/en-US/0757eb10-826e-472d-b865-0b815779c480/aspnetcompiler-error-can-not-load-assembly-in-msbuild-only?forum=msbuild\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/0757eb10-826e-472d-b865-0b815779c480/aspnetcompiler-error-can-not-load-assembly-in-msbuild-only?forum=msbuild</a> by @Stephan Golux / @Stephan-G</p>\n\n<p>Also somewhat at <a href=\"https://stackoverflow.com/a/36182890/1662973\">https://stackoverflow.com/a/36182890/1662973</a></p>\n\n<p>I am a local admin on the machine, but this seems to be an old school fix.  Using VS2017.</p>\n"}], "owner": {"reputation": 287, "user_id": 4698543, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9a7f11c50d0c75c2562c4a83ef66a975?s=128&d=identicon&r=PG&f=1", "display_name": "Corey", "link": "https://stackoverflow.com/users/4698543/corey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489132530, "creation_date": 1453319096, "question_id": 34909110, "link": "https://stackoverflow.com/questions/34909110/could-not-load-the-assembly-the-property-assembly-must-be-a-valid-assembly-as", "title": "Could not load the assembly. The property &#39;assembly&#39; must be a valid assembly ASP.NET Website project", "body": "<p>Has anyone seen this:<a href=\"https://i.stack.imgur.com/ahTHz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ahTHz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Only one developer is getting this on our team so it doesn't seem to me something that's checked into source control. Does anyone have any clues as to what to look at?</p>\n"}, {"tags": ["c#", "mysql", "asp.net"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453320260, "post_id": 34909085, "comment_id": 57554571, "body": "<code>DropDownList1.DataValueField = &quot;club_id&quot;;</code> shouldn&#39;t this be  <code>DropDownList1.DataValueField = &quot;enrolment_no&quot;;</code> if not can you show what the DataGridView Template looks like also where are you calling the <code>connection.Open()</code> command..?"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453320550, "post_id": 34909085, "comment_id": 57554726, "body": "also when populating the dropdown I would change that to load from a SqlDataAdapter I will post an example"}, {"owner": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453321130, "post_id": 34909085, "comment_id": 57555059, "body": "EDIT: Here is a screenshot of the table i have used to display the options in the dropdownlist :<a href=\"http://i.stack.imgur.com/wDbwm.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/wDbwm.png</a>."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453321297, "post_id": 34909085, "comment_id": 57555150, "body": "check the edit this should still work.."}, {"owner": {"reputation": 576, "user_id": 1876951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2270f482039c5495bd1a0099ef88fa55?s=128&d=identicon&r=PG", "display_name": "Devin Prejean", "link": "https://stackoverflow.com/users/1876951/devin-prejean"}, "edited": false, "score": 0, "creation_date": 1453321849, "post_id": 34909085, "comment_id": 57555480, "body": "When you run it in debug mode what is the value of the <code>SelectedItem.Text</code> property? also check the <code>SelectedValue</code> value to compare."}, {"owner": {"reputation": 576, "user_id": 1876951, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2270f482039c5495bd1a0099ef88fa55?s=128&d=identicon&r=PG", "display_name": "Devin Prejean", "link": "https://stackoverflow.com/users/1876951/devin-prejean"}, "edited": false, "score": 0, "creation_date": 1453321926, "post_id": 34909085, "comment_id": 57555524, "body": "Please show the code where the method is getting called. Is it on click? on selected change? etc."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453323200, "post_id": 34909085, "comment_id": 57556264, "body": "Don&#39;t use <code>Server.Transfer</code> use <code>Response.Redirect(&quot;~&#47;Registration_Login.aspx&quot;);</code> instead also put break points in the <code>Page_Load</code> event and use <code>F12</code> Developer tools from the web browser.. you are probably getting some errors that are not showing up on the rendering of the pages postback"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453414635, "post_id": 34909085, "comment_id": 57603523, "body": "@SoniaMathews were you able to get your code to work ?"}, {"owner": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "edited": false, "score": 0, "creation_date": 1453417138, "post_id": 34909085, "comment_id": 57604600, "body": "I was able to get rid of the errors but no whenever I choose a club from the drop down list, the table displays &#39;select item&#39; instead of the club name ..."}], "answers": [{"comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453323075, "post_id": 34909592, "comment_id": 57556201, "body": "what errors are you running into .. I tried the same thing with a different query basically pulling back ID field and Name and works perfectly fine.."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "reply_to_user": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "edited": false, "score": 0, "creation_date": 1453323779, "post_id": 34909592, "comment_id": 57556570, "body": "@SoniaMathews you need to put the word var infront of ds this should have been obvious but I will update for you hold on also change the way that you are doing your connection string and add entries into a <code>Web.Config</code> file don&#39;t hard code usernames and passwords in your code read them directly from the <code>&lt;connectionStrings&gt;</code> section of your config file"}, {"owner": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "edited": false, "score": 0, "creation_date": 1453324132, "post_id": 34909592, "comment_id": 57556764, "body": "ok thankyou, However I still seem to be left with one more error where &#39;connection&#39; is highlighted red....Argument 2: cannot convert from &#39;MySql.Data.MySqlClient.MySqlConnection&#39; to &#39;string&#39;"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "reply_to_user": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "edited": false, "score": 0, "creation_date": 1453324233, "post_id": 34909592, "comment_id": 57556827, "body": "@SoniaMathews lets discuss <a href=\"http://chat.stackoverflow.com/rooms/101226/sonia-issues\">here</a>"}, {"owner": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "edited": false, "score": 0, "creation_date": 1453324517, "post_id": 34909592, "comment_id": 57557000, "body": "ok sure but unfortunately i am a first time user of this website forum and it says &#39; You must have 20 reputation on Stack Overflow to talk here.&#39;"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "reply_to_user": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "edited": false, "score": 0, "creation_date": 1453324581, "post_id": 34909592, "comment_id": 57557027, "body": "I need a way to get your code so I can edit it to work properly @SoniaMathews"}], "tags": [], "owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "is_accepted": false, "score": 0, "last_activity_date": 1453324365, "last_edit_date": 1453324365, "creation_date": 1453320791, "answer_id": 34909592, "question_id": 34909085, "link": "https://stackoverflow.com/questions/34909085/how-to-send-selected-data-from-a-dropdownlist-to-the-corresponding-table-in-mysq/34909592#34909592", "title": "How to send selected data from a dropdownlist to the corresponding table in mysql?", "body": "<pre><code>var sqlQry = \"SELECT club_id,club_name FROM club_details\";\nvar da = new MySqlDataAdapter(sqlQry, connection);\nvar ds = new DataSet();\nda.Fill(ds, \"ClubDetails\");\nDropDownList1.DataSource = ds.Tables[\"ClubDetails\"];\nDropDownList1.DataTextField = \"club_name\";\nDropDownList1.DataValueField = \"club_id\";\nDropDownList1.DataBind();\nDropDownList1.Items.Insert(0, new ListItem(\"Select Item\", \"0\"));\n</code></pre>\n\n<p>you may also want to change this <code>string input_club = DropDownList1.SelectedItem.Text;</code>\nto test off of </p>\n\n<pre><code>var input_club = DropDownList1.SelectedValue;\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5816430, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c4662feeebd2b1b87484fb4fad7e1edd?s=128&d=identicon&r=PG&f=1", "display_name": "Sonia Mathews", "link": "https://stackoverflow.com/users/5816430/sonia-mathews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453324365, "creation_date": 1453318984, "last_edit_date": 1453323140, "question_id": 34909085, "link": "https://stackoverflow.com/questions/34909085/how-to-send-selected-data-from-a-dropdownlist-to-the-corresponding-table-in-mysq", "title": "How to send selected data from a dropdownlist to the corresponding table in mysql?", "body": "<p>So this what I have done so far : </p>\n\n<pre><code> //inserting enrolment details\nstring input_club = DropDownList1.SelectedItem.Text;\nstring enrol_mysql = \"INSERT INTO enrolment_details(child_id,club_name) VALUES (@child_id, @club_name)\";\nlong id = newchild.LastInsertedId;\nMySqlCommand enrol = new MySqlCommand(enrol_mysql, connection);\nenrol.CommandText = enrol_mysql;\nenrol.Parameters.AddWithValue(\"@child_id\", id);\nenrol.Parameters.AddWithValue(\"@club_name\", input_club);\nenrol.ExecuteNonQuery();\n</code></pre>\n\n<p>The problem occurs when if for example user selects the club, the correct option does not appear on the table. (please look at the screen shots I have inserted)</p>\n\n<p><a href=\"https://i.stack.imgur.com/tebUB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tebUB.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/GWe9C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GWe9C.png\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT: This has been called on a button click :</p>\n\n<pre><code>protected void registerEventMethod(object sender, EventArgs e)\n{\n    registerUser();\n    Server.Transfer(\"~/Registration_Login.aspx\");\n}\n\n\nprivate void registerUser()\n{...}\n</code></pre>\n\n<p>Additionally the options shown in the dropdownlist are retrieved from another table. Here is the code if for any relevance :</p>\n\n<pre><code>// Retriving club data from club_detail table from mysql\nMySqlCommand clubdata = new MySqlCommand(\"SELECT club_id,club_name FROM club_details\", connection);\nDropDownList1.DataSource = clubdata.ExecuteReader();\nDropDownList1.DataTextField = \"club_name\";\nDropDownList1.DataValueField = \"club_id\";\nDropDownList1.DataBind();\n</code></pre>\n\n<p>Many thanks for the help. </p>\n"}, {"tags": ["c#", "visual-studio", "visual-studio-2013"], "comments": [{"owner": {"reputation": 4893, "user_id": 194709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oTCwx.png?s=128&g=1", "display_name": "Chris O", "link": "https://stackoverflow.com/users/194709/chris-o"}, "edited": false, "score": 0, "creation_date": 1453396788, "post_id": 34909078, "comment_id": 57593437, "body": "Pretty sure I run into this issue before, sorry don&#39;t remember the details.  IIRC, msbuild has a bug/limitation such that if the solution doesn&#39;t contain the project file, then msbuild does something to figure out the project reference and always looks for the debug assembly no matter what the specified build configuration."}, {"owner": {"reputation": 4478, "user_id": 3486353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsJWp.jpg?s=128&g=1", "display_name": "Sam Hanley", "link": "https://stackoverflow.com/users/3486353/sam-hanley"}, "reply_to_user": {"reputation": 4893, "user_id": 194709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oTCwx.png?s=128&g=1", "display_name": "Chris O", "link": "https://stackoverflow.com/users/194709/chris-o"}, "edited": false, "score": 0, "creation_date": 1453397353, "post_id": 34909078, "comment_id": 57593780, "body": "@ChrisO, yeah, that about exactly describes what I&#39;m seeing. I&#39;m just wondering if you&#39;re correct in thinking it&#39;s a bug (as I&#39;m thinking too, at this point) or if there&#39;s any way to configure the behavior. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 4478, "user_id": 3486353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsJWp.jpg?s=128&g=1", "display_name": "Sam Hanley", "link": "https://stackoverflow.com/users/3486353/sam-hanley"}, "edited": false, "score": 0, "creation_date": 1453319616, "post_id": 34909189, "comment_id": 57554241, "body": "The reference is a project reference, not an assembly reference, and has no path specified in the .csproj. That&#39;s why this seems so odd to me. I&#39;d think it would either not find it in debug OR release, or find it in both."}], "tags": [], "owner": {"reputation": 11904, "user_id": 43222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4e95fd5c3acda6a9c893460cb2d4821c?s=128&d=identicon&r=PG", "display_name": "Zack Marrapese", "link": "https://stackoverflow.com/users/43222/zack-marrapese"}, "is_accepted": false, "score": 0, "last_activity_date": 1453395779, "last_edit_date": 1453395779, "creation_date": 1453319332, "answer_id": 34909189, "question_id": 34909078, "link": "https://stackoverflow.com/questions/34909078/why-does-visual-studio-look-for-unresolved-project-references-in-bin-debug-dur/34909189#34909189", "title": "Why does Visual Studio look for unresolved project references in /bin/debug/ during Release build?", "body": "<p>Check your C.csproj file.  </p>\n\n<p>You may be referencing B.dll by a hard-coded path which explicitly references \\bin\\debug\\</p>\n\n<p><strong>Edit:</strong> @sphanley: In that case, check B.csproj.  Verify that the release OutputPath is setup correctly.  Something like:</p>\n\n<pre><code>  &lt;PropertyGroup Condition=\"'$(Configuration)|$(Platform)' == 'Release|AnyCPU'\"&gt;\n    &lt;PlatformTarget&gt;AnyCPU&lt;/PlatformTarget&gt;\n    &lt;OutputPath&gt;bin\\Release\\&lt;/OutputPath&gt;\n    &lt;DefineConstants&gt;RELEASE&lt;/DefineConstants&gt;\n    &lt;Optimize&gt;true&lt;/Optimize&gt;\n  &lt;/PropertyGroup&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4478, "user_id": 3486353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsJWp.jpg?s=128&g=1", "display_name": "Sam Hanley", "link": "https://stackoverflow.com/users/3486353/sam-hanley"}, "edited": false, "score": 0, "creation_date": 1453319667, "post_id": 34909234, "comment_id": 57554263, "body": "Both of these things have been verified - it&#39;s definitely building the relevant projects with the correct configurations. It&#39;s just building to the /bin/release folder, then looking for the DLLs in /bin/debug."}], "tags": [], "owner": {"reputation": 44, "user_id": 5322573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae156bb1fd44d464ad9d7950dc2d9ef4?s=128&d=identicon&r=PG&f=1", "display_name": "wi_marti", "link": "https://stackoverflow.com/users/5322573/wi-marti"}, "is_accepted": false, "score": 0, "last_activity_date": 1453319466, "creation_date": 1453319466, "answer_id": 34909234, "question_id": 34909078, "link": "https://stackoverflow.com/questions/34909078/why-does-visual-studio-look-for-unresolved-project-references-in-bin-debug-dur/34909234#34909234", "title": "Why does Visual Studio look for unresolved project references in /bin/debug/ during Release build?", "body": "<p>Make sure your Build - Configuration Manager 's Active solution configuration is set to Release and the Build column all has checkmarks on them for each project in the solution.</p>\n"}], "owner": {"reputation": 4478, "user_id": 3486353, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qsJWp.jpg?s=128&g=1", "display_name": "Sam Hanley", "link": "https://stackoverflow.com/users/3486353/sam-hanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3410, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1453395779, "creation_date": 1453318954, "question_id": 34909078, "link": "https://stackoverflow.com/questions/34909078/why-does-visual-studio-look-for-unresolved-project-references-in-bin-debug-dur", "title": "Why does Visual Studio look for unresolved project references in /bin/debug/ during Release build?", "body": "<p>I'm dealing with a strange, non-ideal project/solution architecture and I'm trying to figure out if there's a way to accomplish what is needed. My situation is as follows:</p>\n\n<p>I'm working on software which is broken into two solutions, which I'll call SolutionOne.sln (which builds under VS 2010) and SolutionTwo.sln (which builds under VS 2013). In SolutionOne, we have the following projects:</p>\n\n<blockquote>\n  <p>SolutionOne.sln</p>\n  \n  <ul>\n  <li>A.csproj</li>\n  <li>B.csproj</li>\n  <li>C.csproj (includes reference to B.csproj)</li>\n  </ul>\n</blockquote>\n\n<p>In SolutionTwo, we have several projects which are unique to SolutionTwo, but we're also including the \"C\" project from SolutionOne -- but <strong>not</strong> project B (because outside of this minimal example, there's actually several more chained references and by the time we included them all, it'd basically be the majority of SolutionOne). I understand that this means that when we open SolutionTwo, the \"C\" project shows an unresolved reference to the \"B\" project, since it is not included in our second solution.</p>\n\n<p>However: as long as I build SolutionOne before SolutionTwo, in the Debug configuration, the builds are successful and our app is functional. It appears that at build time, Visual Studio is smart enough to grab the built DLLs for the missing \"B\" project reference from their locations in the SolutionOne build, as these two solutions share a root directory. However, when I try to build both solutions in their Release configurations, I get the following error:</p>\n\n<blockquote>\n  <p>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Microsoft.CSharp.targets(316,9): error MSB3104: The referenced assembly \"[path to project]\\bin\\debug[ProjectReferenceName].dll\" was not found. If this assembly is produced by another one of your projects, please make sure to build that project before building this one.</p>\n</blockquote>\n\n<p>Note that in that error message, it appears to be probing in the correct bin folder, but it's looking in the /debug subdirectory rather than /release even though both solutions are building with their release configurations.</p>\n\n<p>I understand that this is not ideal use of project/solution relationships, but it's highly unlikely that I can reorganize the way this is designed at this stage. Is there any way I can get the Release builds to properly look for the non-resolved Project Reference DLL in the /bin/release/ directory, as I would expect?</p>\n"}, {"tags": ["c#", "global-asax"], "answers": [{"tags": [], "owner": {"reputation": 1372, "user_id": 1087335, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e8f1cacd7704a1853381ecdbf3168c76?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1087335/sergey"}, "is_accepted": true, "score": 0, "last_activity_date": 1453404129, "last_edit_date": 1453404129, "creation_date": 1453403803, "answer_id": 34932447, "question_id": 34909048, "link": "https://stackoverflow.com/questions/34909048/check-if-file-page-allows-anonymous-access/34932447#34932447", "title": "Check if file/page allows anonymous access", "body": "<p>Since the <code>CheckUrlAccessForPrincipal</code> method tells you if a certain user has access to a specific resource, passing in an anonymous user (rather than the current user) will tell you if <em>anyone</em> can access that resource.</p>\n\n<ol>\n<li><p>Create the anonymous user:</p>\n\n<pre><code>var anonymousUser = new GenericPrincipal(new GenericIdentity(String.Empty, String.Empty), new string[] { });\n</code></pre></li>\n<li><p>Pass in the user into the <code>CheckUrlAccessForPrincipal</code> method:</p>\n\n<pre><code>bool isPublicResource = UrlAuthorizationModule.CheckUrlAccessForPrincipal(virtualPath, anonymousUser , HttpContext.Current.Request.HttpMethod);\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 1372, "user_id": 1087335, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e8f1cacd7704a1853381ecdbf3168c76?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey", "link": "https://stackoverflow.com/users/1087335/sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 34932447, "answer_count": 1, "score": 0, "last_activity_date": 1453404129, "creation_date": 1453318864, "last_edit_date": 1453320788, "question_id": 34909048, "link": "https://stackoverflow.com/questions/34909048/check-if-file-page-allows-anonymous-access", "title": "Check if file/page allows anonymous access", "body": "<p>I'm working on the <code>Global.asax</code> file in the <code>Application_BeginRequest</code> method. How can I find out if the currently requested file requires authorization?</p>\n\n<p>I know I can find out if the current user will have access to the file like this:</p>\n\n<pre><code>UrlAuthorizationModule.CheckUrlAccessForPrincipal(path, user, httpVerb)\n</code></pre>\n\n<p>...but I need to know <em>if</em> the file is public or not regardless of the user making the request (whether they're logged in or not).</p>\n\n<p>Passing in <code>null</code> for the user will throw an exception. Maybe I can pass in an instance of an <em>anonymous</em> user, but I don't know where to start with that.</p>\n\n<p>I will be using this information to do further checks, as part of a validation for SSO.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 3019, "user_id": 3577195, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jBRiy.png?s=128&g=1", "display_name": "Blue Eyed Behemoth", "link": "https://stackoverflow.com/users/3577195/blue-eyed-behemoth"}, "edited": false, "score": 0, "creation_date": 1453319037, "post_id": 34909024, "comment_id": 57553929, "body": "Something is wrong with nFIleUpload.OrigFileName"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453319076, "post_id": 34909024, "comment_id": 57553953, "body": "add the values to a List&lt;string&gt; and it will be easier.. change sting Save = string.Empty to <code>var Save = new List&lt;string&gt;();</code> then add the values of nFileUpload.OrgFileName to the list.."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1453319150, "post_id": 34909024, "comment_id": 57553989, "body": "If <code>nFIleUpload.OrgFileName</code> is <code>&quot;testtest1test2&quot;</code>, how do you know where to put the commas? Where does <code>OrgFileName</code> come from?"}, {"owner": {"reputation": 87, "user_id": 4779701, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/d84c2a44cded49b4ada633ef9293027d?s=128&d=identicon&r=PG&f=1", "display_name": "user4779701", "link": "https://stackoverflow.com/users/4779701/user4779701"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1453319251, "post_id": 34909024, "comment_id": 57554047, "body": "@Blorgbeard it is a loop on i=0 it test 1=1 test1..."}, {"owner": {"reputation": 87, "user_id": 4779701, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/d84c2a44cded49b4ada633ef9293027d?s=128&d=identicon&r=PG&f=1", "display_name": "user4779701", "link": "https://stackoverflow.com/users/4779701/user4779701"}, "reply_to_user": {"reputation": 3019, "user_id": 3577195, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jBRiy.png?s=128&g=1", "display_name": "Blue Eyed Behemoth", "link": "https://stackoverflow.com/users/3577195/blue-eyed-behemoth"}, "edited": false, "score": 0, "creation_date": 1453319406, "post_id": 34909024, "comment_id": 57554131, "body": "@BlueEyedBehemoth check my edited question"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453319430, "post_id": 34909024, "comment_id": 57554146, "body": "common sense should tell you that this line would never work  <code>Save += nFIleUpload.OrgFileName;</code> when trying <code>to join(&quot;,&quot; Save);</code>"}, {"owner": {"reputation": 319, "user_id": 2484289, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/c17aa7993a2af55337525fa26c762658?s=128&d=identicon&r=PG", "display_name": "James", "link": "https://stackoverflow.com/users/2484289/james"}, "edited": false, "score": 0, "creation_date": 1453319511, "post_id": 34909024, "comment_id": 57554192, "body": "Your code won&#39;t even compile. You are passing a string as the second parameter to string.Join when it requires a collection. If you were to just pass a string then the Join method wouldn&#39;t know where one item ended and the next item started so it wouldn&#39;t know where to put the join character/string."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1453319590, "post_id": 34909024, "comment_id": 57554225, "body": "Isn&#39;t <code>nFIleUpload.OrgFileName</code> going to be the same value every time? Anyway.. just change <code>Save</code> to be a <code>List&lt;string&gt;</code> instead of <code>string</code>, and do <code>Save.Add(nFIleUpload.OrgFileName);</code> in the loop."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1453319797, "post_id": 34909024, "comment_id": 57554331, "body": "@user4779701 when posting code you need to post all relevant code.. also use the debugger.. I am curious how you are loading multiple filenames inot the <code>nFileUpload</code> object.. in the meantime you could have saved yourself a lot of headache by googling the <code>string.Join()</code> function as well"}, {"owner": {"reputation": 36783, "user_id": 2946329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ygJ.jpg?s=128&g=1", "display_name": "Salah Akbari", "link": "https://stackoverflow.com/users/2946329/salah-akbari"}, "edited": false, "score": 0, "creation_date": 1453319834, "post_id": 34909024, "comment_id": 57554347, "body": "Why you  don&#39;t add <code>Save += &quot;,&quot;;</code> simply after <code>Save += nFIleUpload.OrgFileName;</code> ?? I think your issue will resolved in this way!"}], "answers": [{"tags": [], "owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "is_accepted": false, "score": 2, "last_activity_date": 1453319623, "creation_date": 1453319623, "answer_id": 34909275, "question_id": 34909024, "link": "https://stackoverflow.com/questions/34909024/to-join-comma-separated-in-string/34909275#34909275", "title": "To join comma separated in string", "body": "<p>Change this code </p>\n\n<pre><code>string Save=string.Empty;\nfor (int i = 0; i &lt; files.Count; i++)\n{\n     Save += nFIleUpload.OrgFileName;// display  value like testtest1test2..\n}\nstring s = string.Join(\",\", Save);\n</code></pre>\n\n<p>to the following</p>\n\n<pre><code>var Save = new List&lt;string&gt;();\nfor (int i = 0; i &lt; files.Count; i++)\n{\n     Save.Add(nFIleUpload.OrgFileName);// display  value like testtest1test2..\n}\nvar s = string.Join(\",\", Save);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35071, "user_id": 316799, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0fa8da5d4aacf3078d23d33c4effadd5?s=128&d=identicon&r=PG", "display_name": "Felipe Oriani", "link": "https://stackoverflow.com/users/316799/felipe-oriani"}, "is_accepted": false, "score": 0, "last_activity_date": 1453321714, "last_edit_date": 1453321714, "creation_date": 1453319828, "answer_id": 34909337, "question_id": 34909024, "link": "https://stackoverflow.com/questions/34909024/to-join-comma-separated-in-string/34909337#34909337", "title": "To join comma separated in string", "body": "<p>Try it using an array, for sample:</p>\n\n<pre><code>string[] save = new string[files.Count];\nfor (var i = 0; i &lt; files.Count; i++)\n   save[i] = nFIleUpload.OrgFileName;\n\n// join all values\nstring s = string.Join(\",\", save);\n</code></pre>\n\n<p>Or use a <code>stringBulder</code> which is better to concat strings, for sample:</p>\n\n<pre><code>// define the stringBuilder\nStringBuilder text = new StringBuilder();\n\n// define the loop to concat all values separated by ',' comma\nfor (var i = 0; i &lt; files.Count; i++)\n    text.AppendFormat(\"{0},\", nFIleUpload.OrgFileName);\n\n// get the output\nstring s = text.ToString();\n\n// remove the last comma if necessary\nif (s.EndsWith(\",\"))\n    s = s.Remove(s.Length - 1);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5012, "user_id": 3845456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEWf8.jpg?s=128&g=1", "display_name": "DrewJordan", "link": "https://stackoverflow.com/users/3845456/drewjordan"}, "edited": false, "score": 0, "creation_date": 1453325043, "post_id": 34909387, "comment_id": 57557280, "body": "touche @mike, touche."}], "tags": [], "owner": {"reputation": 445, "user_id": 1836910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445b4e8bf538284642ace665d99ed40?s=128&d=identicon&r=PG", "display_name": "mike", "link": "https://stackoverflow.com/users/1836910/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1453320028, "creation_date": 1453320028, "answer_id": 34909387, "question_id": 34909024, "link": "https://stackoverflow.com/questions/34909024/to-join-comma-separated-in-string/34909387#34909387", "title": "To join comma separated in string", "body": "<p>And to go off of MethodMan's answer, when you get tired of seeing the same value added to Save for each iteration, make sure to use that index.</p>\n\n<pre><code>var Save = new List&lt;string&gt;();\nfor (int i = 0; i &lt; files.Count; i++)\n{\n    Save.Add(nFIleUpload[i].OrgFileName);// display  value like testtest1test2..\n}\nvar s = string.Join(\",\", Save);\n</code></pre>\n\n<p>If nFIleUpload is actually the variable that holds the strings.. is it the files variable? Who watches the watchmen? These are the questions to ask..</p>\n"}], "owner": {"reputation": 87, "user_id": 4779701, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/d84c2a44cded49b4ada633ef9293027d?s=128&d=identicon&r=PG&f=1", "display_name": "user4779701", "link": "https://stackoverflow.com/users/4779701/user4779701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 2, "closed_date": 1453320723, "answer_count": 3, "score": -2, "last_activity_date": 1453321714, "creation_date": 1453318788, "last_edit_date": 1453319474, "question_id": 34909024, "link": "https://stackoverflow.com/questions/34909024/to-join-comma-separated-in-string", "closed_reason": "Not suitable for this site", "title": "To join comma separated in string", "body": "<p>In the below code i want the string value to be comma separated but it produces the result like testtest1test2 .But i want to display like test,test1,test2.Pls help me.</p>\n\n<pre><code>    string Save=string.Empty;\n    for (int i = 0; i &lt; files.Count; i++)\n    {\n//i=0 test ,i=1 test1....\n         Save += nFIleUpload.OrgFileName;// display  value like testtest1test2..\n    }\n    string s = string.Join(\",\", Save);\n</code></pre>\n"}, {"tags": ["c#", ".net", "multithreading", "dll", "native"], "answers": [{"comments": [{"owner": {"reputation": 11566, "user_id": 71200, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0a9d0aadd049fa597a20fe4274e8d1b9?s=128&d=identicon&r=PG", "display_name": "Kenneth Cochran", "link": "https://stackoverflow.com/users/71200/kenneth-cochran"}, "edited": false, "score": 0, "creation_date": 1453390848, "post_id": 34909780, "comment_id": 57589311, "body": "The library in question was written in house but all the threads were being created by third party libraries that were statically linked into the dll. Rather than attempt to babysit the thread management of third party code it was easier to use the &quot;sledge hammer&quot;."}], "tags": [], "owner": {"reputation": 67555, "user_id": 2530848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rYg1g.jpg?s=128&g=1", "display_name": "Sriram Sakthivel", "link": "https://stackoverflow.com/users/2530848/sriram-sakthivel"}, "is_accepted": true, "score": 1, "last_activity_date": 1453321468, "creation_date": 1453321468, "answer_id": 34909780, "question_id": 34909000, "link": "https://stackoverflow.com/questions/34909000/process-continues-running-after-main-thread-has-terminated/34909780#34909780", "title": "Process continues running after main thread has terminated?", "body": "<p>This means that some of your Foreground Threads are still alive. Unlike Background Threads, Foreground Threads keeps the process alive.</p>\n\n<p>You should either use Background Threads or Stop your Foregrounds Threads to be able to exit the process gracefully.</p>\n\n<p>Windows application will automatically exit when all of its thread(s) are stopped.</p>\n\n<p>As you said </p>\n\n<blockquote>\n  <p>If the dll is never loaded the application terminates without a\n  problem</p>\n</blockquote>\n\n<p>I'm assuming all the running threads are unmanaged threads(not created by clr). There is no concept of background threads in native code. All threads must be terminated to terminate the process.</p>\n\n<p>You must find a way to signal all threads to exit in that library. See if you have any api exposed for that.</p>\n\n<p>If you don't find anything, you've got a \"Sledge Hammer\" approach. i.e Terminate the process with <code>Environment.Exit</code> which works almost always. Be sure you use this approach as a last resort as this can corrupt the process state.</p>\n"}], "owner": {"reputation": 11566, "user_id": 71200, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0a9d0aadd049fa597a20fe4274e8d1b9?s=128&d=identicon&r=PG", "display_name": "Kenneth Cochran", "link": "https://stackoverflow.com/users/71200/kenneth-cochran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 34909780, "answer_count": 1, "score": 1, "last_activity_date": 1453321468, "creation_date": 1453318706, "question_id": 34909000, "link": "https://stackoverflow.com/questions/34909000/process-continues-running-after-main-thread-has-terminated", "title": "Process continues running after main thread has terminated?", "body": "<p>I'll start by saying I do not have a lot of experience in troubleshooting multi-threading problems. So a lot of what I've read about debugging race conditions, dead locks, live locks, etc. are strictly theoretical to me.</p>\n\n<p>I have this .NET application that is making use of a dynamically loaded native win32 dll. If the dll is never loaded the application terminates without a problem. However, if the dll is loaded then when the user exits the application the UI disappears but the process never terminates.</p>\n\n<p>I've turned on native code debugging in the project settings so I can see all the threads that are running. When the user closes the application window the main thread appears to terminate. I know this because if I perform a <em>Break All</em> in the Threads windows in Visual Studio the main thread is re-categorized as a worker thread and there is no call stack available for it. There are 20 other threads still active, all with call stacks. I've looked through the call stacks for all of these threads and nothing sticks out at me (there's no mention of the dll in any of the call stacks).</p>\n\n<p>What steps can I take to narrow down the cause of this problem? Are there any additional tools I should be using to help pin point the problem?</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 3155, "user_id": 1426450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c61b9f354bdea5e67f662c3d6803f2?s=128&d=identicon&r=PG", "display_name": "stephen.vakil", "link": "https://stackoverflow.com/users/1426450/stephen-vakil"}, "edited": false, "score": 0, "creation_date": 1453319095, "post_id": 34908892, "comment_id": 57553960, "body": "You might consider the solution here:  <a href=\"http://stackoverflow.com/questions/5706815/html-inside-label-using-html-helper\" title=\"html inside label using html helper\">stackoverflow.com/questions/5706815/&hellip;</a>"}, {"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1453319134, "post_id": 34908892, "comment_id": 57553979, "body": "Why not just pass in <code>model.Content</code> instead of wrapping it in <code>Html.Raw()</code> ?"}, {"owner": {"reputation": 2484, "user_id": 4771606, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/J5l4l.png?s=128&g=1", "display_name": "Lucian Bumb", "link": "https://stackoverflow.com/users/4771606/lucian-bumb"}, "edited": false, "score": 0, "creation_date": 1453319239, "post_id": 34908892, "comment_id": 57554035, "body": "model.Content is with html tags, and need somehow to process that tags and display the formated text"}], "answers": [{"comments": [{"owner": {"reputation": 3007, "user_id": 1541224, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/KW5Hm.jpg?s=128&g=1", "display_name": "joym8", "link": "https://stackoverflow.com/users/1541224/joym8"}, "edited": false, "score": 0, "creation_date": 1453323257, "post_id": 34910266, "comment_id": 57556288, "body": "Should&#39;nt <code>@Html.MyModal(model.Content, model.Title, resources.Close, model.Id)</code> be enough? Bootstrap should handle it automatically?"}, {"owner": {"reputation": 2484, "user_id": 4771606, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/J5l4l.png?s=128&g=1", "display_name": "Lucian Bumb", "link": "https://stackoverflow.com/users/4771606/lucian-bumb"}, "reply_to_user": {"reputation": 3007, "user_id": 1541224, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/KW5Hm.jpg?s=128&g=1", "display_name": "joym8", "link": "https://stackoverflow.com/users/1541224/joym8"}, "edited": false, "score": 0, "creation_date": 1453323403, "post_id": 34910266, "comment_id": 57556368, "body": "is not enough, the model.content contain html tags and by using it without Html.Raw(), I was getting the tags into the modal body"}, {"owner": {"reputation": 2484, "user_id": 4771606, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/J5l4l.png?s=128&g=1", "display_name": "Lucian Bumb", "link": "https://stackoverflow.com/users/4771606/lucian-bumb"}, "reply_to_user": {"reputation": 3007, "user_id": 1541224, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/KW5Hm.jpg?s=128&g=1", "display_name": "joym8", "link": "https://stackoverflow.com/users/1541224/joym8"}, "edited": false, "score": 0, "creation_date": 1453324394, "post_id": 34910266, "comment_id": 57556924, "body": "that was my way with modal, but when I try it dynamically with a helper, did not work, only in the way I describe it.because the html content is stored like string in database, and you need something to tell to the browser that is not plain text"}], "tags": [], "owner": {"reputation": 2484, "user_id": 4771606, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/J5l4l.png?s=128&g=1", "display_name": "Lucian Bumb", "link": "https://stackoverflow.com/users/4771606/lucian-bumb"}, "is_accepted": true, "score": 1, "last_activity_date": 1453323066, "creation_date": 1453323066, "answer_id": 34910266, "question_id": 34908892, "link": "https://stackoverflow.com/questions/34908892/how-to-pass-an-html-rawx-as-string-parameter-in-a-mvc-helper/34910266#34910266", "title": "How to pass an Html.Raw(x) as string parameter in a Mvc helper?", "body": "<p>One solution to my problem, is: </p>\n\n<ol>\n<li>I changed the data type for bodycontent from <code>string</code> to <code>IHtmlString</code></li>\n<li><p>I replace the following line in the helper:</p>\n\n<p>bodyTag.SetInnerText(bodycontent);</p></li>\n</ol>\n\n<p>with:</p>\n\n<pre><code> bodyTag.InnerHtml=bodycontent.ToHtmlString();\n</code></pre>\n\n<p>and now my helper is working as expected: </p>\n\n<pre><code> @Html.MyModal(Html.Raw(model.Content), model.Title, resources.Close, model.Id)\n</code></pre>\n"}], "owner": {"reputation": 2484, "user_id": 4771606, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/J5l4l.png?s=128&g=1", "display_name": "Lucian Bumb", "link": "https://stackoverflow.com/users/4771606/lucian-bumb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "accepted_answer_id": 34910266, "answer_count": 1, "score": 0, "last_activity_date": 1453323066, "creation_date": 1453318356, "question_id": 34908892, "link": "https://stackoverflow.com/questions/34908892/how-to-pass-an-html-rawx-as-string-parameter-in-a-mvc-helper", "title": "How to pass an Html.Raw(x) as string parameter in a Mvc helper?", "body": "<p>I am not sure that even the question is correct, so I am trying to explain what I want to achieve and hope you can help me with the best solution. </p>\n\n<p>I am using in many places in my project the bootstrap modal, so I made an helper to make my life easier. </p>\n\n<p>The helper is working with only one exception, I am not able to give the body content in the correct format. </p>\n\n<p>The helper need 4 parameters to run: </p>\n\n<pre><code>@Html.MyModal(string bodycontent, string title, string closeBtnText, string id)\n</code></pre>\n\n<p>I have the bodycontent stored in the database like html, and I was planing to use this helper <code>@Html.Raw(bodycontent)</code>like this:</p>\n\n<pre><code> @Html.MyModal(Html.Raw(model.Content).toString(), model.Title, resources.Close, model.Id)\n</code></pre>\n\n<p>Obviously is not working, still showing the content with html tags. </p>\n\n<p>Here is the helper code which handle the bodyContent:</p>\n\n<pre><code>var bodyTag = new TagBuilder(\"div\");\n    bodyTag.MergeAttribute(\"class\", \"modal-body\");\n    bodyTag.MergeAttribute(\"style\", \"overflow-y: scroll;height:250px;\");\n    bodyTag.SetInnerText(bodycontent);\n</code></pre>\n\n<p><em>bodycontent is helper parameter, of type string.</em> </p>\n\n<p>Can you please help me with a solution in order to display the bodycontent like plain text (in database is stored like html)?</p>\n"}, {"tags": ["c#", "user-controls"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5090208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/debc3533b4cc3d661771014b18f765c5?s=128&d=identicon&r=PG&f=1", "display_name": "Yasston", "link": "https://stackoverflow.com/users/5090208/yasston"}, "edited": false, "score": 1, "creation_date": 1453456260, "post_id": 34909023, "comment_id": 57618864, "body": "Thank you, I chose this one as ansswer although I&#39;m sure @redlum answer is the best practice."}, {"owner": {"reputation": 126, "user_id": 5597313, "user_type": "registered", "profile_image": "https://graph.facebook.com/633045356832436/picture?type=large", "display_name": "Alyson Freitas", "link": "https://stackoverflow.com/users/5597313/alyson-freitas"}, "reply_to_user": {"reputation": 35, "user_id": 5090208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/debc3533b4cc3d661771014b18f765c5?s=128&d=identicon&r=PG&f=1", "display_name": "Yasston", "link": "https://stackoverflow.com/users/5090208/yasston"}, "edited": false, "score": 0, "creation_date": 1453466297, "post_id": 34909023, "comment_id": 57625022, "body": "I believe @redlum answer is the best practice too, but is not always doable"}], "tags": [], "owner": {"reputation": 126, "user_id": 5597313, "user_type": "registered", "profile_image": "https://graph.facebook.com/633045356832436/picture?type=large", "display_name": "Alyson Freitas", "link": "https://stackoverflow.com/users/5597313/alyson-freitas"}, "is_accepted": true, "score": 1, "last_activity_date": 1453318784, "creation_date": 1453318784, "answer_id": 34909023, "question_id": 34908875, "link": "https://stackoverflow.com/questions/34908875/call-a-user-control-method-on-a-usercontrol-object/34909023#34909023", "title": "Call a user control method on a UserControl object", "body": "<p>You can use MethodInfo:</p>\n\n<pre><code>//Get the method information using the method info class\n MethodInfo mi = _userControl.GetType().GetMethod(\"Initialize\");\n\n//Invoke the method\nmi.Invoke(_userControl, null);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 5785550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BDAY1.jpg?s=128&g=1", "display_name": "redlum", "link": "https://stackoverflow.com/users/5785550/redlum"}, "is_accepted": false, "score": 0, "last_activity_date": 1453319044, "creation_date": 1453319044, "answer_id": 34909099, "question_id": 34908875, "link": "https://stackoverflow.com/questions/34908875/call-a-user-control-method-on-a-usercontrol-object/34909099#34909099", "title": "Call a user control method on a UserControl object", "body": "<p>Create an interface with the Initialize() method. Implement the interface. Save the control in CTPManager as that interface. Or, if you want to store it as a UserControl, then you could cast it to the type you want:</p>\n\n<pre><code>var init = (InitializerInterface)_userControl;\nif (init != null) ...\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5090208, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/debc3533b4cc3d661771014b18f765c5?s=128&d=identicon&r=PG&f=1", "display_name": "Yasston", "link": "https://stackoverflow.com/users/5090208/yasston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1190, "favorite_count": 0, "accepted_answer_id": 34909023, "answer_count": 2, "score": 0, "last_activity_date": 1453319044, "creation_date": 1453318295, "question_id": 34908875, "link": "https://stackoverflow.com/questions/34908875/call-a-user-control-method-on-a-usercontrol-object", "title": "Call a user control method on a UserControl object", "body": "<p>I have a user control class that is derived from UserControl</p>\n\n<pre><code>[ComVisible(true)]\npublic class MyUserControl : UserControl\n</code></pre>\n\n<p>it contains a method I called Initialize() : <code>public void Initialize()</code>\nIn another class, I need to use a MyUserControl, but I would like to declare and use generic UserControl objects. That way, I'll be able to reuse this class even with a new and different user control (let's say MyUserControl2).</p>\n\n<p>So I declared a member of this class as </p>\n\n<pre><code>private static UserControl _userControl;\n</code></pre>\n\n<p>here is the constructor</p>\n\n<pre><code>public CTPManager(UserControl userControl, string Title, MsoCTPDockPosition Position)\n{\n    //stuff\n\n    _userControl = userControl;\n    _title = Title;\n    _position = Position;\n}\n</code></pre>\n\n<p>First question : is it possible to later instantiate the class with this :</p>\n\n<pre><code>MyUserControl newControl = new MyUserControl();\nCTPManager newCTP = new CTPManager(newControl, \"window title\", etc.);\n</code></pre>\n\n<p>If so, can I call Initialize() method of MyUserControl newControl since I only need to do these two calls inside the CTPManager class :</p>\n\n<pre><code>CustomTaskPaneFactory.CreateCustomTaskPane(typeof(UserControl), _title, _EXCELApp.ActiveWindow)); //-&gt; this one will be ok because of CreateCustomTaskPane signature\n_userControl.Initialize //-&gt; that is what I would like to be able to do !\n</code></pre>\n\n<p>Thank you very much for any answers or advice</p>\n"}, {"tags": ["c#", "string", "visual-studio", "console.writeline"], "comments": [{"owner": {"reputation": 20130, "user_id": 479869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oiCBo.jpg?s=128&g=1", "display_name": "Steve Wellens", "link": "https://stackoverflow.com/users/479869/steve-wellens"}, "edited": false, "score": 4, "creation_date": 1453318338, "post_id": 34908837, "comment_id": 57553511, "body": "You couldn&#39;t Google for examples?"}, {"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 0, "creation_date": 1453318655, "post_id": 34908837, "comment_id": 57553721, "body": "This is an extremely trivial issue and shows practically no research effort."}, {"owner": {"reputation": 333, "user_id": 5601246, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f49c2e4bbb5f79ead57828914024da21?s=128&d=identicon&r=PG&f=1", "display_name": "Taegos", "link": "https://stackoverflow.com/users/5601246/taegos"}, "edited": false, "score": 0, "creation_date": 1453321104, "post_id": 34908837, "comment_id": 57555039, "body": "Having a trivial understanding of programming and VS, trivial issues are very recurrent for me. The examples on the forums and google did not apply 100% to my issue."}], "answers": [{"comments": [{"owner": {"reputation": 13681, "user_id": 701054, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/494c00da8ba5640f1f6a1eb1a62aaa46?s=128&d=identicon&r=PG", "display_name": "Avner Shahar-Kashtan", "link": "https://stackoverflow.com/users/701054/avner-shahar-kashtan"}, "edited": false, "score": 2, "creation_date": 1453318325, "post_id": 34908853, "comment_id": 57553505, "body": "You don&#39;t actually need to call <code>string.Format</code>. Console.WriteLine accepts format strings automatically."}, {"owner": {"reputation": 333, "user_id": 5601246, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f49c2e4bbb5f79ead57828914024da21?s=128&d=identicon&r=PG&f=1", "display_name": "Taegos", "link": "https://stackoverflow.com/users/5601246/taegos"}, "edited": false, "score": 0, "creation_date": 1453320794, "post_id": 34908853, "comment_id": 57554865, "body": "Wow so +string works? I tried that and it did not work at first, so i made the conclusion that the + only worked for numbers. I tried again and it worked though thank you!"}], "tags": [], "owner": {"reputation": 50118, "user_id": 913124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/20dGq.jpg?s=128&g=1", "display_name": "Christos", "link": "https://stackoverflow.com/users/913124/christos"}, "is_accepted": true, "score": 9, "last_activity_date": 1557748460, "last_edit_date": 1557748460, "creation_date": 1453318209, "answer_id": 34908853, "question_id": 34908837, "link": "https://stackoverflow.com/questions/34908837/console-writeline-using-strings/34908853#34908853", "title": "Console.writeline using strings", "body": "<p>You can use string concatenation:</p>\n\n<pre><code>Console.WriteLine(\"**** Name of product:\" + productName);\n</code></pre>\n\n<p>or you can use this:</p>\n\n<pre><code>Console.WriteLine(\"**** Name of product:{0}\", productName);\n</code></pre>\n\n<p>Furthermore, if you program in C# 6, you can use string interpolation:</p>\n\n<pre><code>Console.WriteLine($\"**** Name of product:{productName}\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13969, "user_id": 4167200, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/ceLYp.jpg?s=128&g=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4167200/thomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1453318312, "creation_date": 1453318312, "answer_id": 34908881, "question_id": 34908837, "link": "https://stackoverflow.com/questions/34908837/console-writeline-using-strings/34908881#34908881", "title": "Console.writeline using strings", "body": "<p>You can use a string format:</p>\n\n<pre><code>Console.WriteLine(\"**** Name of product: {0}\", productName);\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 5601246, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f49c2e4bbb5f79ead57828914024da21?s=128&d=identicon&r=PG&f=1", "display_name": "Taegos", "link": "https://stackoverflow.com/users/5601246/taegos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8365, "favorite_count": 3, "accepted_answer_id": 34908853, "answer_count": 2, "score": 4, "last_activity_date": 1557748460, "creation_date": 1453318153, "question_id": 34908837, "link": "https://stackoverflow.com/questions/34908837/console-writeline-using-strings", "title": "Console.writeline using strings", "body": "<p>A simple question: How do you display strings in the CMD using Console.Writeline() using C# in VS? I Know you use + for ints and floats. But what do you use for strings? This is what i have:</p>\n\n<pre><code>    private string productName;\n\n    public void GetItemData()\n    {\n        ShowReciept();\n    }\n\n    private void ReadItem()\n    {    \n        Console.WriteLine(\"Enter the product's name: \"); \n        productName = Console.ReadLine();\n    }\n\n    private void ShowReciept()\n    {\n        Console.WriteLine(\"**** Name of product:\", productName);\n    }\n</code></pre>\n\n<p>In void ShowReciept() it writes out everything in the Console.WriteLine command, exept the product Name. So its just blank were the product name should have been.  </p>\n"}, {"tags": ["c#", "asp.net-mvc", "firefox", "razor"], "comments": [{"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1453318239, "post_id": 34908827, "comment_id": 57553453, "body": "Something in the CSS perhaps?  The markup alone won&#39;t do this."}, {"owner": {"reputation": 801, "user_id": 4462995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/509813639/picture?type=large", "display_name": "djblois", "link": "https://stackoverflow.com/users/4462995/djblois"}, "reply_to_user": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1453318428, "post_id": 34908827, "comment_id": 57553573, "body": "Hi @David - I just added my CSS (I think all that you may need)."}, {"owner": {"reputation": 743, "user_id": 232611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1480b679f801be3e1a5ccaeb88e86863?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/232611/brendan"}, "edited": false, "score": 0, "creation_date": 1453328812, "post_id": 34908827, "comment_id": 57559299, "body": "With bootstrap 3.3.6 CSS  and your style block alone, I can&#39;t reproduce this in Firefox.  There must be some other CSS getting applied to the &lt;option&gt; tags inside of the &lt;select&gt;."}], "owner": {"reputation": 801, "user_id": 4462995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://graph.facebook.com/509813639/picture?type=large", "display_name": "djblois", "link": "https://stackoverflow.com/users/4462995/djblois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453320293, "creation_date": 1453318122, "last_edit_date": 1453320293, "question_id": 34908827, "link": "https://stackoverflow.com/questions/34908827/why-is-firefox-combobox-spread-out-mvc", "title": "Why is Firefox Combobox spread out (MVC)", "body": "<p>In my MVC solution for a helpdesk, I have multiple comboboxes throughout.  In both IE and Chrome they look fine; however, in firefox they look terrible.</p>\n\n<p>Here is example code:</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n    @Html.Label(\"Category\", htmlAttributes: new { @class = \"control-label col-md-2\" })\n    &lt;div class=\"col-md-3\"&gt;\n        @Html.DropDownList(\"CategoryId\", null, \"Select Category\", htmlAttributes: new { @class = \"form-control\" })\n        @Html.ValidationMessageFor(model =&gt; model.CategoryId, \"\", new { @class = \"text-danger\" })\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>here is a pic of what the combobox looks like on the different browsers:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sCYlU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sCYlU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and here is my css:</p>\n\n<pre><code>.form-control:-moz-placeholder {\n  color: #999999;\n}\n\n.form-control::-moz-placeholder {\n  color: #999999;\n}\n\n.form-control:-ms-input-placeholder {\n  color: #999999;\n}\n\n.form-control::-webkit-input-placeholder {\n  color: #999999;\n}\n\n.form-control {\n  display: block;\n  width: 100%;\n  height: 34px;\n  padding: 6px 12px;\n  font-size: 14px;\n  line-height: 1.428571429;\n  color: #555555;\n  vertical-align: middle;\n  background-color: #ffffff;\n  border: 1px solid #cccccc;\n  border-radius: 4px;\n  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n          box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);\n  -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n          transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;\n}\n\n.form-control:focus {\n  border-color: #66afe9;\n  outline: 0;\n  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6);\n          box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px rgba(102, 175, 233, 0.6);\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc"], "answers": [{"tags": [], "owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_accepted": true, "score": 2, "last_activity_date": 1453318295, "creation_date": 1453318295, "answer_id": 34908874, "question_id": 34908822, "link": "https://stackoverflow.com/questions/34908822/dynamic-selectlist-not-selecting-specified-value/34908874#34908874", "title": "Dynamic SelectList not selecting specified value", "body": "<p>Set the <code>SeasonId</code> value of your view model to the option value you want to be selected.</p>\n\n<pre><code>var vm=new YourViewModel();\nvar match = _context.Matches.Single(m =&gt; m.MatchId == id);\nvm.SeasonList = _context.Seasons\n                 .Select(x=&gt;new SelectListItem { Value= x.SeasonId.ToString(),\n                                                 Text= x.SeasonName).ToList();\nvm.SeasonId= match.SeasonId;\nreturn View(vm);\n</code></pre>\n"}], "owner": {"reputation": 1195, "user_id": 218314, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/dd70db84c6ac488415abbd1c53e7b10c?s=128&d=identicon&r=PG", "display_name": "G_Man", "link": "https://stackoverflow.com/users/218314/g-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 34908874, "answer_count": 1, "score": 1, "last_activity_date": 1453318295, "creation_date": 1453318113, "question_id": 34908822, "link": "https://stackoverflow.com/questions/34908822/dynamic-selectlist-not-selecting-specified-value", "title": "Dynamic SelectList not selecting specified value", "body": "<p>Using ASP.Net MVC6 and Entity Framework 7</p>\n\n<p>I am populating select boxes on a edit form using a database table and attempting to select proper record. For some reason the selected variable isn't getting pushed at all and the first record is always selected regardless of what the database reflects.</p>\n\n<p>Here is the form helper</p>\n\n<pre><code>&lt;select asp-for=\"SeasonId\" asp-items=\"Model.SeasonList\" class=\"form-control\"&gt;&lt;/select&gt;\n</code></pre>\n\n<p>Here is the controller</p>\n\n<pre><code>var match = _context.Matches.Single(m =&gt; m.MatchId == id);\nSeasonList = new SelectList(_context.Seasons, \"SeasonId\", \"SeasonName\", match.SeasonId)\n</code></pre>\n\n<p>Here is the ViewModel</p>\n\n<pre><code>public int SeasonId { get; set; }\npublic IEnumerable&lt;SelectListItem&gt; SeasonList { get; set; }\npublic Season Season { get; set; }\n</code></pre>\n\n<p>Am I missing something?</p>\n"}, {"tags": ["c#", "cryptography", "pki"], "answers": [{"comments": [{"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 1, "creation_date": 1453415906, "post_id": 34929779, "comment_id": 57604119, "body": "Thanks for reporting back. I guessed as much but I wasn&#39;t able to test, ran out of time. Horrible API documentation, glad you figured it out."}], "tags": [], "owner": {"reputation": 143, "user_id": 5817663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d77957affcf633f30b110e9aed0982?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5817663/zach"}, "is_accepted": true, "score": 4, "last_activity_date": 1453395522, "creation_date": 1453395522, "answer_id": 34929779, "question_id": 34908771, "link": "https://stackoverflow.com/questions/34908771/c-cx509privatekey-format/34929779#34929779", "title": "C# CX509PrivateKey Format", "body": "<p>I think I answered my own question:</p>\n\n<p>The command</p>\n\n<pre><code>Export(\"PRIVATEBLOB\", EncodingType.XCN_CRYPT_STRING_BASE64)\n</code></pre>\n\n<p>exports the private key as a BASE64 encoded CSP blob. In order to import is using the C# RSA libraries I had to use the following:</p>\n\n<pre><code>RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();\nbyte[] CryptoKey = Convert.FromBase64String(base64CspBlob);\nrsa.ImportCspBlob(CryptoKey);\n</code></pre>\n\n<p>That did it!</p>\n"}], "owner": {"reputation": 143, "user_id": 5817663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d77957affcf633f30b110e9aed0982?s=128&d=identicon&r=PG", "display_name": "Zach", "link": "https://stackoverflow.com/users/5817663/zach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1143, "favorite_count": 0, "accepted_answer_id": 34929779, "answer_count": 1, "score": 4, "last_activity_date": 1453395522, "creation_date": 1453317957, "last_edit_date": 1453321212, "question_id": 34908771, "link": "https://stackoverflow.com/questions/34908771/c-cx509privatekey-format", "title": "C# CX509PrivateKey Format", "body": "<p>I'm trying to re-use the key pair I generated for creating a <code>PKCS10</code> Certificate Signing request, but I cannot figure out what the format of this private key is. </p>\n\n<p>To create the key, I'm using the <code>CERTENROLLLib CX509PrivateKey</code> class.</p>\n\n<p>I've set the Private Key ProviderType to <code>XCV_PROV_RSA_FULL</code>, and when I export it (trying to figure out what format it is) I use </p>\n\n<pre><code>Export(\"PRIVATEBLOB\", EncodingType.XCN_CRYPT_STRING_BASE64)\n</code></pre>\n\n<p>When I export it, the private key always starts with <code>\"BwIAAACkAABSU0E\"</code></p>\n\n<p>Does anyone know what format this is? I thought ANS.1 DER Encoding always started with <code>\"MII\"</code> or someting like that.</p>\n"}, {"tags": ["c#", "powershell", "azure"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2989480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb3693d70bf7a9fae559378e64f503d5?s=128&d=identicon&r=PG&f=1", "display_name": "Repkam09", "link": "https://stackoverflow.com/users/2989480/repkam09"}, "edited": false, "score": 0, "creation_date": 1453320203, "post_id": 34909264, "comment_id": 57554545, "body": "Yeah, this is almost exactly the solution I was planning to use initially! The requirement of CruiseControl.NET to handle the builds and provide a nice web front end made it so I could no longer use the built in Azure continuous deployment features."}], "tags": [], "owner": {"reputation": 3417, "user_id": 5463877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88da9f0b09bd7ddb86d1336e75980fd?s=128&d=identicon&r=PG", "display_name": "Xiaomin Wu", "link": "https://stackoverflow.com/users/5463877/xiaomin-wu"}, "is_accepted": true, "score": 0, "last_activity_date": 1453319593, "creation_date": 1453319593, "answer_id": 34909264, "question_id": 34908691, "link": "https://stackoverflow.com/questions/34908691/depoyment-of-pre-built-azure-web-service-via-powershell/34909264#34909264", "title": "Depoyment of pre-built Azure Web Service via PowerShell", "body": "<p>have you consider to use Azure App Service? where you can get those build infrastructure for free. e.g <a href=\"https://azure.microsoft.com/en-us/documentation/articles/web-sites-publish-source-control/\" rel=\"nofollow\">https://azure.microsoft.com/en-us/documentation/articles/web-sites-publish-source-control/</a></p>\n\n<p>Once you setup continues deployment, you will get below three when there is push event (if you are using git)</p>\n\n<ul>\n<li>Pulling code from source control when commits happen</li>\n<li>Building the projects</li>\n<li>Copying output/binaries to an output location</li>\n</ul>\n\n<p>and to \"Running some unit test cases\", you can create your own batch or powershell script with post deployment hook <a href=\"https://github.com/projectkudu/kudu/wiki/Post-Deployment-Action-Hooks\" rel=\"nofollow\">https://github.com/projectkudu/kudu/wiki/Post-Deployment-Action-Hooks</a></p>\n"}], "owner": {"reputation": 3, "user_id": 2989480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb3693d70bf7a9fae559378e64f503d5?s=128&d=identicon&r=PG&f=1", "display_name": "Repkam09", "link": "https://stackoverflow.com/users/2989480/repkam09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 34909264, "answer_count": 1, "score": 0, "last_activity_date": 1453319593, "creation_date": 1453317741, "question_id": 34908691, "link": "https://stackoverflow.com/questions/34908691/depoyment-of-pre-built-azure-web-service-via-powershell", "title": "Depoyment of pre-built Azure Web Service via PowerShell", "body": "<p>I am completely new to Azure and PowerShell but have been tasked with setting up a build and deploy solution for several app services.</p>\n\n<p>We currently have a build server (Azure VM) that is running CruiseControl.NET to build and test some C# .NET solutions that should be deployed in Azure.</p>\n\n<p>This build server currently handles the following tasks:</p>\n\n<ul>\n<li>Pulling code from source control when commits happen</li>\n<li>Building the projects</li>\n<li>Running some unit test cases</li>\n<li>Copying output/binaries to an output location</li>\n</ul>\n\n<p>However, as it exists now, developers of each of our app services need to 'Publish' their services manually from their development machines by clicking the button in Visual Studio once they have verified that the build and test cases have passed in the test environment on the server.</p>\n\n<p>As I am hoping for a completely automated solution, I expect I need to use something like PowerShell or the Azure Cross Platform CLI (npm) to do this?</p>\n\n<p>I'm extremely confused with the Azure Service Management vs Azure Resource Management versions with the new Azure Powershell 1.0. All of our services appear to be the newer Resource Management versions, not 'classic'.</p>\n\n<p>The eventual goal is to have the build server do the following</p>\n\n<ul>\n<li>Pulling code from source control when commits happen</li>\n<li>Building the projects</li>\n<li>Running some unit test cases</li>\n<li>Copying output/binaries to an output location</li>\n<li>If the build and test cases are successful, update the service in azure to the latest build</li>\n</ul>\n\n<p>I am hoping there is a way to set up these projects, or take the existing binaries that result from the builds, and have them be deployed into Web Apps using the new Azure Resource Management Powershell features.</p>\n\n<p>Any advice or resources for more information about how this can be done? </p>\n\n<p>Hopefully this makes some sense. Please let me know if I am going about this completely the wrong way or direct me to a more correct forum.\nThanks!</p>\n"}, {"tags": ["c#", "sql"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1453318113, "post_id": 34908666, "comment_id": 57553381, "body": "If you know the data types, don&#39;t use <code>AddWithValue()</code>; specify the type."}, {"owner": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1453318126, "post_id": 34908666, "comment_id": 57553392, "body": "According to your error, your <code>Auto_Parts_Id</code> column is an <code>int</code>, but the value you&#39;re trying to insert is a string (&quot;Part 1&quot;). You can&#39;t insert that into that column."}, {"owner": {"reputation": 33, "user_id": 5741006, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/993635714037468/picture?type=large", "display_name": "Mahmoud Omar", "link": "https://stackoverflow.com/users/5741006/mahmoud-omar"}, "edited": false, "score": 0, "creation_date": 1453323335, "post_id": 34908666, "comment_id": 57556337, "body": "i know that but this value is combo box how i pass it into the database"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5741006, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/993635714037468/picture?type=large", "display_name": "Mahmoud Omar", "link": "https://stackoverflow.com/users/5741006/mahmoud-omar"}, "edited": false, "score": 0, "creation_date": 1453323474, "post_id": 34908942, "comment_id": 57556405, "body": "this CB_Auto_parts. is combo box i used this code to display the value  that i choose in grid view an i want insert this value to data base"}], "tags": [], "owner": {"reputation": 13658, "user_id": 775, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6ecff6d9bd022f20e7e1680cb4055947?s=128&d=identicon&r=PG", "display_name": "Mun", "link": "https://stackoverflow.com/users/775/mun"}, "is_accepted": false, "score": 2, "last_activity_date": 1453318521, "creation_date": 1453318521, "answer_id": 34908942, "question_id": 34908666, "link": "https://stackoverflow.com/questions/34908666/conversion-failed-when-converting-the-nvarchar-value-part-1-to-data-type-int/34908942#34908942", "title": "Conversion failed when converting the nvarchar value &#39;Part 1&#39; to data type int", "body": "<p>The problem is that the <code>Auto_Parts_id</code> column in your table is an integer type, but you're trying to insert the value \"<code>Part 1</code>\" which is a string, and cannot implicitly be converted to an integer.</p>\n\n<p>In your <code>btn_Add_Job_card_Click</code> method, you're setting the following:</p>\n\n<pre><code>r[3] = CB_Auto_parts.Text;\n</code></pre>\n\n<p>...and then using this when doing your insert:</p>\n\n<pre><code>sd.Parameters.AddWithValue(\"@Auto_Parts_id\", dgv_Add_job_card.Rows[i].Cells[3].Value);\n</code></pre>\n\n<p>If you want the ID instead of the text, you could perhaps store this in your datarow as well, and use that as your parameter value instead of the text.</p>\n"}], "owner": {"reputation": 33, "user_id": 5741006, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/993635714037468/picture?type=large", "display_name": "Mahmoud Omar", "link": "https://stackoverflow.com/users/5741006/mahmoud-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453318521, "creation_date": 1453317681, "last_edit_date": 1453317976, "question_id": 34908666, "link": "https://stackoverflow.com/questions/34908666/conversion-failed-when-converting-the-nvarchar-value-part-1-to-data-type-int", "title": "Conversion failed when converting the nvarchar value &#39;Part 1&#39; to data type int", "body": "<p>code in C# :- </p>\n\n<pre><code>private void btn_Add_Click(object sender, EventArgs e)\n{\n    for (int i = 0; i &lt; dgv_Add_job_card.Rows.Count; i++)\n    {\n        con.Open();\n        s = \"insert into Auto_Part_Details (Items_No, Job_Card, Value_Part, Auto_Parts_id) values (@Items_No, @Job_Card, @Value_Part,@Auto_Parts_id )\";\n        sd=new SqlCommand(s,con);\n        sd.Parameters.AddWithValue(\"@Items_No\", dgv_Add_job_card.Rows[i].Cells[0].Value);\n        sd.Parameters.AddWithValue(\"@Job_Card\", dgv_Add_job_card.Rows[i].Cells[1].Value);\n        sd.Parameters.AddWithValue(\"@Value_Part\", dgv_Add_job_card.Rows[i].Cells[2].Value);\n        sd.Parameters.AddWithValue(\"@Auto_Parts_id\", dgv_Add_job_card.Rows[i].Cells[3].Value);\n        sd.ExecuteNonQuery();\n        con.Close();\n    }\n}\n</code></pre>\n\n<p>the error in the line :-</p>\n\n<pre><code>sd.Parameters.AddWithValue(\"@Auto_Parts_id\", dgv_Add_job_card.Rows[i].Cells[3].Value);\n</code></pre>\n\n<p>this line is a combo box , table is :- Auto_Parts_id (int),\nAuto_Part_desc (varchar(50))</p>\n\n<p>and this form have the data grid view that display data only and after that i add all data i insert it in data grid view to database.</p>\n\n<p>my code that display data in data grid view is :- </p>\n\n<pre><code>private void btn_Add_Job_card_Click(object sender, EventArgs e)\n    {\n\n        Validation_Add_Job_card_order();\n        if (validate == true)\n        {\n            DataRow r = dt.NewRow();\n            // = dt.Rows.Count + 1;\n            r[0] = dt.Rows.Count + 1;\n            //r[0] = txt_Items_No.Text;\n            r[1] = txt_Job_card.Text;\n            r[2] = txt_Value_Part.Text;\n            r[3] = CB_Auto_parts.Text;\n            r[4] = x;\n            r[5] = CB_Providers_desc.Text;\n            r[6] = CB_Hand_installation.Text;\n            r[7] = txt_Notes.Text;\n\n            dt.Rows.Add(r);\n            dgv_Add_job_card.DataSource = dt;\n            ClearText();\n\n            txt_Total_Values.Text = (from DataGridViewRow row in dgv_Add_job_card.Rows\n                                     where row.Cells[2].FormattedValue.ToString() != string.Empty\n                                     select Convert.ToDouble(row.Cells[2].FormattedValue)).Sum().ToString();\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "sql", "sql-server"], "answers": [{"tags": [], "owner": {"reputation": 20130, "user_id": 479869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oiCBo.jpg?s=128&g=1", "display_name": "Steve Wellens", "link": "https://stackoverflow.com/users/479869/steve-wellens"}, "is_accepted": true, "score": 1, "last_activity_date": 1453317626, "creation_date": 1453317626, "answer_id": 34908642, "question_id": 34908440, "link": "https://stackoverflow.com/questions/34908440/insert-lists-of-different-types-with-foreach-loop-into-a-sql-server-database/34908642#34908642", "title": "Insert lists of different types with foreach loop into a SQL Server database", "body": "<p>I think you want something like this:</p>\n\n<pre><code>for (int i = 0; i &lt; competitorList.Count; i++)\n{\n    cmd.Parameters[\"@CompetitorID\"].Value = competitorList[i];\n    cmd.Parameters[\"@ProductCode\"].Value = productCodeList[i];\n    cmd.Parameters[\"@ProductName\"].Value = productNameList[i];\n    // etc\n    int rowsAffected = cmd.ExecuteNonQuery();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 426, "user_id": 5816083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mVusMNEr-_g/AAAAAAAAAAI/AAAAAAAAAPE/TXeQE58BLtQ/photo.jpg?sz=128", "display_name": "Santiago", "link": "https://stackoverflow.com/users/5816083/santiago"}, "is_accepted": false, "score": 1, "last_activity_date": 1453318690, "creation_date": 1453318690, "answer_id": 34908994, "question_id": 34908440, "link": "https://stackoverflow.com/questions/34908440/insert-lists-of-different-types-with-foreach-loop-into-a-sql-server-database/34908994#34908994", "title": "Insert lists of different types with foreach loop into a SQL Server database", "body": "<p>Having them in a separate list like that, makes it really hard to identify which productCode goes with which productName.</p>\n\n<p>I would suggest to build a dto to handle this. Something like:</p>\n\n<pre><code>public class Products\n{\npublic string productCodeList {get; set;}\npublic string productNameList {get; set;}\npublic string productPriceList {get; set;}\npublic int competitorList {get; set;}\npublic DateTime dateCreatedList {get; set;}\n}\n</code></pre>\n\n<p>than you can use:</p>\n\n<pre><code>List&lt;Products&gt; products = new List&lt;Products&gt;();\n</code></pre>\n\n<p>Alternatively you could just build the whole DataTable in your code and use SqlBulckCopy to insert it into your database.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.data.datatable(v=vs.110).aspx\" rel=\"nofollow\">DatTable</a></p>\n\n<p><a href=\"http://www.dotnetperls.com/datatable\" rel=\"nofollow\">Quick Example of Datatables</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy(v=vs.110).aspx\" rel=\"nofollow\">SqlBulkCopy</a></p>\n"}, {"tags": [], "owner": {"reputation": 682, "user_id": 1944091, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/AmSgv.jpg?s=128&g=1", "display_name": "WiSeeker", "link": "https://stackoverflow.com/users/1944091/wiseeker"}, "is_accepted": false, "score": 2, "last_activity_date": 1453319596, "creation_date": 1453319596, "answer_id": 34909265, "question_id": 34908440, "link": "https://stackoverflow.com/questions/34908440/insert-lists-of-different-types-with-foreach-loop-into-a-sql-server-database/34909265#34909265", "title": "Insert lists of different types with foreach loop into a SQL Server database", "body": "<p>You have logically related properties like name, code etc split into multiple lists which would be hard to maintain and error prone like @Santiago pointed out.</p>\n\n<p>If you have complete control over the code, you may consider creating a <code>Product</code> class and having a collection of Products.</p>\n\n<pre><code>public class Product\n{\n    public string Code { get; set; }\n    public string Name { get; set; }\n    public decimal Price { get; set; }\n    public int CompetitorId { get; set; }\n    public DateTime DateCreated { get; set; }\n}\n\npublic class DemoClass\n{\n    public static void Demo()\n    {\n        var products = new List&lt;Product&gt;();\n\n        // fill the list here\n\n        using (var con = new SqlConnection(connectionString))\n        {\n            con.Open();\n            using (var cmd = new SqlCommand(@\"INSERT INTO OnlineProductsTemp$(CompetitorID, ProductCode, ProductName, Price, DateCreated)\n            VALUES(@CompetitorID, @ProductCode, @ProductName, @Price, @DateCreated)\", con))\n            {\n                cmd.Parameters.Add(\"@CompetitorID\", SqlDbType.Int);\n                cmd.Parameters.Add(\"@ProductCode\", SqlDbType.VarChar);\n                cmd.Parameters.Add(\"@ProductName\", SqlDbType.VarChar);\n                cmd.Parameters.Add(\"@Price\", SqlDbType.Decimal);\n                cmd.Parameters.Add(\"@DateCreated\", SqlDbType.DateTime);\n                foreach (var p in products)\n                {\n                    cmd.Parameters[\"@CompetitorID\"].Value = p.CompetitorId;\n                    cmd.Parameters[\"@ProductCode\"].Value = p.Code;\n                    cmd.Parameters[\"@ProductName\"].Value = p.Name;\n                    cmd.Parameters[\"@Price\"].Value = p.Price;\n                    cmd.Parameters[\"@DateCreated\"].Value = p.DateCreated;\n\n                    var rowsAffected = cmd.ExecuteNonQuery();\n                }\n                products.Clear();\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 3235199, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3e2d9d9f265b4b75aef2e27025d9f402?s=128&d=identicon&r=PG&f=1", "display_name": "TeaAnyOne", "link": "https://stackoverflow.com/users/3235199/teaanyone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1930, "favorite_count": 0, "accepted_answer_id": 34908642, "answer_count": 3, "score": 1, "last_activity_date": 1453322278, "creation_date": 1453317004, "last_edit_date": 1453322278, "question_id": 34908440, "link": "https://stackoverflow.com/questions/34908440/insert-lists-of-different-types-with-foreach-loop-into-a-sql-server-database", "title": "Insert lists of different types with foreach loop into a SQL Server database", "body": "<p>I'm trying to add data into a database using a foreach loop to iterate through lists which contain values of different types.</p>\n\n<pre><code>List&lt;string&gt; productCodeList = new List&lt;string&gt;();\nList&lt;string&gt; productNameList = new List&lt;string&gt;();\nList&lt;string&gt; productPriceList = new List&lt;string&gt;();\nList&lt;int&gt; competitorList = new List&lt;int&gt;();\nList&lt;DateTime&gt; dateCreatedList = new List&lt;DateTime&gt;();\n</code></pre>\n\n<p>Is there a way to iterate through multiple lists with different types? Because at the moment I'm only able to insert one list to one column. What I want is to insert data to all the columns specified.</p>\n\n<p>Or is there possibly a better way of doing this?</p>\n\n<pre><code>using (var con = new SqlConnection(connectionString))\n{\n    con.Open();\n\n    using (var cmd = new SqlCommand(@\"INSERT INTO OnlineProductsTemp$(CompetitorID, ProductCode, ProductName, Price, DateCreated)\n                VALUES(@CompetitorID, @ProductCode, @ProductName, @Price, @DateCreated)\", con))\n    {\n        cmd.Parameters.Add(\"@CompetitorID\", SqlDbType.Int);\n        cmd.Parameters.Add(\"@ProductCode\", SqlDbType.VarChar);\n        cmd.Parameters.Add(\"@ProductName\", SqlDbType.VarChar);\n        cmd.Parameters.Add(\"@Price\", SqlDbType.Decimal);\n        cmd.Parameters.Add(\"@DateCreated\", SqlDbType.DateTime);\n\n        foreach (var value in competitorList)\n        {\n             cmd.Parameters[\"@CompetitorID\"].Value = value;\n             int rowsAffected = cmd.ExecuteNonQuery();\n        }\n\n        competitorList.Clear();\n    }\n}\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c#", ".net", "skype4com"], "comments": [{"owner": {"reputation": 1, "user_id": 5817677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47de2018301e6b7d7612942f46601742?s=128&d=identicon&r=PG&f=1", "display_name": "Max Payne", "link": "https://stackoverflow.com/users/5817677/max-payne"}, "edited": false, "score": 0, "creation_date": 1453317169, "post_id": 34908415, "comment_id": 57552894, "body": "_skype = new Skype(); _skype.Attach();"}], "answers": [{"comments": [{"owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 0, "creation_date": 1466002447, "post_id": 37198510, "comment_id": 63138709, "body": "This does NOT show all chats. I am a member of at least 6 chats, with recent messages (last day or so), that are not found by this code. Many of my chats are found but not all of them."}, {"owner": {"reputation": 161, "user_id": 2085182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7a0636534ba51c723cf784abbe12e?s=128&d=identicon&r=PG", "display_name": "Peter Ho", "link": "https://stackoverflow.com/users/2085182/peter-ho"}, "reply_to_user": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 1, "creation_date": 1467586659, "post_id": 37198510, "comment_id": 63777362, "body": "Oops!  Thanks for this, I only had a few group chats and they all showed up.  I did some digging, and I found that the group names are stored under the DisplayName property within the Conversations table in the main.db file, but currently I see no way to access this with the Skype API."}, {"owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 0, "creation_date": 1467673213, "post_id": 37198510, "comment_id": 63811690, "body": "This makes me sad ... I had hoped to develop a little script that would set my chats to /alertsoff at night and /alertson in the morning. But it doesn&#39;t look like it&#39;s going to happen."}, {"owner": {"reputation": 161, "user_id": 2085182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7a0636534ba51c723cf784abbe12e?s=128&d=identicon&r=PG", "display_name": "Peter Ho", "link": "https://stackoverflow.com/users/2085182/peter-ho"}, "reply_to_user": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 0, "creation_date": 1467919315, "post_id": 37198510, "comment_id": 63928436, "body": "Ross Presser, could you instead make a script to turn your profile to &quot;Do not disturb&quot; at night and &quot;Online&quot; in the morning?  Would this accomplish what you want?"}, {"owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "edited": false, "score": 0, "creation_date": 1467921289, "post_id": 37198510, "comment_id": 63929456, "body": "Thanks for the suggestion, I&#39;ll look into it. I actually accomplished what I wanted with an autohotkey script that simulates mouse and keypresses."}], "tags": [], "owner": {"reputation": 161, "user_id": 2085182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7a0636534ba51c723cf784abbe12e?s=128&d=identicon&r=PG", "display_name": "Peter Ho", "link": "https://stackoverflow.com/users/2085182/peter-ho"}, "is_accepted": false, "score": 0, "last_activity_date": 1463092267, "creation_date": 1463092267, "answer_id": 37198510, "question_id": 34908415, "link": "https://stackoverflow.com/questions/34908415/get-list-of-chats-in-skype/37198510#37198510", "title": "Get list of chats in Skype", "body": "<p>This will show all chats, including hidden ones.  For this reason, you may see duplicates of chats with <em>single contacts</em> only.</p>\n\n<pre><code>Imports SKYPE4COMLib\n\nPublic Class Form1\nDim skype As Skype\n\nPrivate Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n\n    For Each r As Chat In skype.Chats\n        'If topic = \"\", then it is an individual chat\n        If r.Topic &lt;&gt; \"\" Then\n            RichTextBox1.AppendText(r.Topic &amp; vbCrLf)\n        Else\n            'If topic = \"\", then display the FriendlyName instead (individual chat)\n            RichTextBox1.AppendText(r.FriendlyName &amp; vbCrLf)\n        End If\n\n    Next\nEnd Sub\n\nPrivate Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n    skype = New Skype()\n    skype.Attach(7, True)\nEnd Sub\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5817677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47de2018301e6b7d7612942f46601742?s=128&d=identicon&r=PG&f=1", "display_name": "Max Payne", "link": "https://stackoverflow.com/users/5817677/max-payne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 643, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463092267, "creation_date": 1453316945, "last_edit_date": 1453317796, "question_id": 34908415, "link": "https://stackoverflow.com/questions/34908415/get-list-of-chats-in-skype", "title": "Get list of chats in Skype", "body": "<p>I just have tried to get list of chats and I am not able to get it. </p>\n\n<pre><code>from Chat chat in _skype.chats select new Chat\n</code></pre>\n\n<p>It doesn't include all chats. I have create new one and can't see it in list.</p>\n"}, {"tags": ["c#", "asp.net", "xml"], "comments": [{"owner": {"reputation": 1422, "user_id": 4498937, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/o2VBg.png?s=128&g=1", "display_name": "terbubbs", "link": "https://stackoverflow.com/users/4498937/terbubbs"}, "edited": false, "score": 0, "creation_date": 1453489255, "post_id": 34908345, "comment_id": 57639700, "body": "Did my solution end up working for you? If so, please accept it as the answer."}], "answers": [{"tags": [], "owner": {"reputation": 1422, "user_id": 4498937, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/o2VBg.png?s=128&g=1", "display_name": "terbubbs", "link": "https://stackoverflow.com/users/4498937/terbubbs"}, "is_accepted": true, "score": 0, "last_activity_date": 1453318187, "creation_date": 1453318187, "answer_id": 34908849, "question_id": 34908345, "link": "https://stackoverflow.com/questions/34908345/trying-to-update-xml-file-but-it-puts-everything-in-one-tag/34908849#34908849", "title": "trying to update xml file but it puts everything in one tag", "body": "<p>Give this a try.. and I'll leave this <a href=\"http://csharp.net-tutorials.com/xml/writing-xml-with-the-xmldocument-class/\" rel=\"nofollow\">link</a> for further reference.</p>\n\n<pre><code>public static void InsetXML(string user, string date, string content, string Xmlfile)\n{\n    XmlDocument xmlDoc = new XmlDocument();\n    XmlNode rootNode = xmlDoc.CreateElement(\"news\");\n    xmlDoc.AppendChild(rootNode);\n\n    XmlNode parent = xmlDoc.CreateElement(\"report\");\n    rootNode.AppendChild(parent);\n\n    XmlNode child1 = xmlDoc.CreateElement(\"user\");\n    child1.InnerText = user;\n    parent.AppendChild(child1);\n\n    XmlNode child2 = xmlDoc.CreateElement(\"date\");\n    child2.InnerText = date;\n    parent.AppendChild(child2);\n\n    XmlNode child3 = xmlDoc.CreateElement(\"content\");\n    child3.InnerText = content;\n    parent.AppendChild(child3);\n\n    FileStream fsxml = new FileStream(Xmlfile, FileMode.Truncate, FileAccess.Write, FileShare.ReadWrite);\n    xmlDoc.Save(fsxml);\n    fsxml.Close();\n}\n</code></pre>\n\n<p>I tested this and wrote the XML to an existing .xml file on my drive.</p>\n\n<p>This was the result:</p>\n\n<pre><code>&lt;news&gt;\n  &lt;report&gt;\n    &lt;user&gt;dsfdsfg&lt;/user&gt;\n    &lt;date&gt;10.10.1999&lt;/date&gt;\n    &lt;content&gt;sdfas&lt;/content&gt;\n  &lt;/report&gt;\n&lt;/news&gt;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5817652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18836d110f47dc5ebfe92361335230f?s=128&d=identicon&r=PG&f=1", "display_name": "Pit Omer", "link": "https://stackoverflow.com/users/5817652/pit-omer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 34908849, "answer_count": 1, "score": 0, "last_activity_date": 1453378342, "creation_date": 1453316652, "last_edit_date": 1453378342, "question_id": 34908345, "link": "https://stackoverflow.com/questions/34908345/trying-to-update-xml-file-but-it-puts-everything-in-one-tag", "title": "trying to update xml file but it puts everything in one tag", "body": "<p>im trying to update this xml page:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;news&gt;\n  &lt;report&gt;\n    &lt;user&gt;&lt;/user&gt;\n    &lt;date&gt;&lt;/date&gt;\n    &lt;content&gt;&lt;/content&gt;\n  &lt;/report&gt;\n&lt;/news&gt;\n</code></pre>\n\n<p>with this method:</p>\n\n<pre><code>public static void InsetXML(string user, string date, string content, string Xmlfile)\n    {\n\n\n        string XMLfile;\n        XmlElement reportEle, userEle, dateEle, contentEle;\n        XmlDocument doc = new XmlDocument();\n        XMLfile = Xmlfile;\n        doc.Load(XMLfile);\n        reportEle = doc.CreateElement(\"report\");\n        userEle = doc.CreateElement(\"user\");\n        dateEle = doc.CreateElement(\"date\");\n        contentEle = doc.CreateElement(\"content\");\n        userEle.InnerText = user;\n        dateEle.InnerText = date;\n        contentEle.InnerText = content;\n        reportEle.AppendChild(userEle);\n        reportEle.AppendChild(dateEle);\n        reportEle.AppendChild(contentEle);\n        doc.DocumentElement.InsertAfter(reportEle, doc.DocumentElement.FirstChild);\n        FileStream fsxml = new FileStream(XMLfile, FileMode.Truncate, FileAccess.Write, FileShare.ReadWrite);\n        doc.Save(fsxml);\n        fsxml.Close();\n\n    }\n</code></pre>\n\n<p>take into consideration, <code>string Xmlfile =  Server.MapPath(\"news.xml\");</code>\n (copied the method from a book that i'm using) but every time i try it it just writes everything into the user tag like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;news&gt;\n  &lt;report&gt;\n    &lt;user&gt;\n    &lt;/user&gt;\n    &lt;date&gt;\n    &lt;/date&gt;\n    &lt;content&gt;\n    &lt;/content&gt;\n  &lt;/report&gt;\n  &lt;report&gt;\n    &lt;user&gt;dsfdsfg,10.10.1999,sdfas&lt;/user&gt;\n    &lt;date&gt;\n    &lt;/date&gt;\n    &lt;content&gt;\n    &lt;/content&gt;\n  &lt;/report&gt;\n&lt;/news&gt;\n</code></pre>\n\n<p>thanks to all helpers :D</p>\n"}, {"tags": ["c#", "string"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 5, "creation_date": 1453316716, "post_id": 34908340, "comment_id": 57552635, "body": "The second argument to <code>Substring</code> is the length of the desired substring, not an end index.  You can just leave off the second argument if you want to go to the end of the string."}, {"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1453316808, "post_id": 34908340, "comment_id": 57552692, "body": "<code>string StaffID = mystring.Split(new char[] {&#39;-&#39;}).Last();</code> maybe?"}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "reply_to_user": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1453316863, "post_id": 34908340, "comment_id": 57552721, "body": "@juharr Or <a href=\"https://msdn.microsoft.com/en-us/library/hxthx5h6(v=vs.110).aspx\" rel=\"nofollow noreferrer\">leave it off entirely</a>"}, {"owner": {"reputation": 36783, "user_id": 2946329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ygJ.jpg?s=128&g=1", "display_name": "Salah Akbari", "link": "https://stackoverflow.com/users/2946329/salah-akbari"}, "reply_to_user": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 1, "creation_date": 1453317056, "post_id": 34908340, "comment_id": 57552834, "body": "@MaximilianGerhardt....<code>new char[]</code> is redundant."}], "answers": [{"tags": [], "owner": {"reputation": 36783, "user_id": 2946329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ygJ.jpg?s=128&g=1", "display_name": "Salah Akbari", "link": "https://stackoverflow.com/users/2946329/salah-akbari"}, "is_accepted": false, "score": 0, "last_activity_date": 1453318036, "last_edit_date": 1453318036, "creation_date": 1453316763, "answer_id": 34908371, "question_id": 34908340, "link": "https://stackoverflow.com/questions/34908340/substring-in-c/34908371#34908371", "title": "Substring() in C#", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/tabh47cf(v=vs.110).aspx\" rel=\"nofollow\"><code>Split</code></a> like this:</p>\n\n<pre><code>string ss = \"VGT501 - GE TIMES MICROWAVE ELECTRONICS\";\nvar result = ss.Split('-')[1];//GE TIMES MICROWAVE ELECTRONICS\n//Or  var result = ss.Split('-').Last();\n</code></pre>\n\n<p>By using <code>Split</code> you didn't get any error if there is not <code>-</code> in your string or if the string is null.</p>\n"}, {"comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1453317235, "post_id": 34908390, "comment_id": 57552924, "body": "The classic approach to &quot;return everything after some character, or return everything if the character is not found&quot; is to use <code>mystring.Substring(mystring.LastIndexOf(&quot;-&quot;)+1);</code> because it never throws an exception for a non-null <code>mystring</code>."}, {"owner": {"reputation": 2581, "user_id": 4911, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/320610faffaa9fa6268f3d260b7e584f?s=128&d=identicon&r=PG", "display_name": "Larry Smithmier", "link": "https://stackoverflow.com/users/4911/larry-smithmier"}, "edited": false, "score": 1, "creation_date": 1453318406, "post_id": 34908390, "comment_id": 57553557, "body": "Change from <code>LastIndexOf</code> to <code>IndexOf</code> and you are on target.  An input of <code>&quot;test - test - test&quot;</code> would return <code>&quot;test&quot;</code> rather than the required <code>&quot;test - test&quot;</code>."}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "reply_to_user": {"reputation": 2581, "user_id": 4911, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/320610faffaa9fa6268f3d260b7e584f?s=128&d=identicon&r=PG", "display_name": "Larry Smithmier", "link": "https://stackoverflow.com/users/4911/larry-smithmier"}, "edited": false, "score": 0, "creation_date": 1453319786, "post_id": 34908390, "comment_id": 57554324, "body": "@LarrySmithmier Yeah, based on the <i>first &quot;-&quot; character</i> reference you are correct."}], "tags": [], "owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1453319903, "last_edit_date": 1453319903, "creation_date": 1453316853, "answer_id": 34908390, "question_id": 34908340, "link": "https://stackoverflow.com/questions/34908340/substring-in-c/34908390#34908390", "title": "Substring() in C#", "body": "<p>The second argument to <code>string.Substring</code> is the length of the desired substring.  If you want to go to the end of the string you can use the overload that only takes the starting index.  Also since you want everything after the <em>first \"-\" character</em> you'd actually want to use <code>IndexOf</code> instead of <code>LastIndexOf</code>.</p>\n\n<pre><code>string StaffID = mystring.Substring(mystring.IndexOf('-') + 1);\n</code></pre>\n\n<p>Also it makes more sense to do the <code>IndexOf</code> on the <code>char</code> and not on a <code>string</code> and you need to add 1 so you get everything after the dash.  This also handles the case where there is no dash as <code>IndexOf</code> will return -1.  If the dash is the last character in the string you'll end up with an empty string.</p>\n\n<p>If you want to default the value to something other than the original string if the dash isn't found you'd have to do something like the following.</p>\n\n<pre><code>int lastDash = mystring.IndexOf(\"-\");\nstring StaffID = whateverDefaultValueYouWant;\nif(lastDash != -1)\n    StaffID = mystring.Substring(lastDash);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2581, "user_id": 4911, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/320610faffaa9fa6268f3d260b7e584f?s=128&d=identicon&r=PG", "display_name": "Larry Smithmier", "link": "https://stackoverflow.com/users/4911/larry-smithmier"}, "is_accepted": false, "score": 0, "last_activity_date": 1453799486, "last_edit_date": 1453799486, "creation_date": 1453317868, "answer_id": 34908732, "question_id": 34908340, "link": "https://stackoverflow.com/questions/34908340/substring-in-c/34908732#34908732", "title": "Substring() in C#", "body": "<p>This will pull the string following the first <code>-</code> and not error if there is not an instance of <code>-</code> in the string or if the initial string is null:</p>\n\n<pre><code>string test = \"VGT501 - GE TIMES MICROWAVE ELECTRONICS\";\nvar output = (test ?? string.Empty).Substring((test ?? string.Empty).IndexOf('-') + 1).Trim();\n</code></pre>\n\n<p><code>output</code> gets the value: <code>GE TIMES MICROWAVE ELECTRONICS</code></p>\n\n<pre><code>string test = \"VGT501 GE TIMES MICROWAVE ELECTRONICS\";\n</code></pre>\n\n<p><code>output</code> gets the value: <code>VGT501 GE TIMES MICROWAVE ELECTRONICS</code></p>\n\n<pre><code>string test = string.Empty;\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>string test = null;\n</code></pre>\n\n<p><code>output</code> gets <code>string.Empty</code></p>\n"}], "owner": {"reputation": 109, "user_id": 5273761, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6085bb6118e754a23ef1fb48c47e66ce?s=128&d=identicon&r=PG&f=1", "display_name": "sony921", "link": "https://stackoverflow.com/users/5273761/sony921"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "closed_date": 1453326275, "answer_count": 3, "score": 0, "last_activity_date": 1453799486, "creation_date": 1453316631, "last_edit_date": 1453321326, "question_id": 34908340, "link": "https://stackoverflow.com/questions/34908340/substring-in-c", "closed_reason": "Not suitable for this site", "title": "Substring() in C#", "body": "<p>I have a string like <code>VGT501  -  GE TIMES MICROWAVE ELECTRONICS</code>\nand I want to break this string into two part depend on first <code>-</code> character .I only want second part of the string for example <code>GE TIMES MICROWAVE ELECTRONICS</code>.\nI am using  below code:</p>\n\n<pre><code>string StaffID = mystring.Substring(mystring.LastIndexOf(\"-\"), mystring.Length );\n</code></pre>\n\n<p>But its giving me <code>ArgumentOutofRangeException</code> error.</p>\n"}]