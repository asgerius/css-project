[{"tags": ["c#", "jquery", "asp.net", "ajax", "asp.net-mvc"], "comments": [{"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 1, "creation_date": 1534982227, "post_id": 51976616, "comment_id": 90903421, "body": "what is <code>file</code> here?"}, {"owner": {"reputation": 222, "user_id": 7166007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rXoDS2O1Pho/AAAAAAAAAAI/AAAAAAAAAH4/RyXghaqXd9s/photo.jpg?sz=128", "display_name": "Narek Daduryan", "link": "https://stackoverflow.com/users/7166007/narek-daduryan"}, "reply_to_user": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1534982882, "post_id": 51976616, "comment_id": 90903543, "body": "It&amp;#39;s an HttpPostedFile containing an image. I should mention when called the file is successfully uploaded to the server"}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1534984931, "post_id": 51976616, "comment_id": 90903922, "body": "hmm.. not entirely certain, try changing your <code>ActionResult</code> to <code>JsonResult</code> and run your scenario again."}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1534985333, "post_id": 51976616, "comment_id": 90903992, "body": "was actually surprised to see this is valid Json text response: <a href=\"https://stackoverflow.com/questions/7487869/is-this-simple-string-considered-valid-json\" title=\"is this simple string considered valid json\">stackoverflow.com/questions/7487869/&hellip;</a> .. I suppose I&#39;m still pre 2014 on this :P"}, {"owner": {"reputation": 222, "user_id": 7166007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rXoDS2O1Pho/AAAAAAAAAAI/AAAAAAAAAH4/RyXghaqXd9s/photo.jpg?sz=128", "display_name": "Narek Daduryan", "link": "https://stackoverflow.com/users/7166007/narek-daduryan"}, "reply_to_user": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1534985542, "post_id": 51976616, "comment_id": 90904017, "body": "Response is still empty, except it just shows {} now"}, {"owner": {"reputation": 195, "user_id": 3324968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c1b7237ebda4372921c8634ae349c21?s=128&d=identicon&r=PG&f=1", "display_name": "Reza Ebadi", "link": "https://stackoverflow.com/users/3324968/reza-ebadi"}, "edited": false, "score": 2, "creation_date": 1534986295, "post_id": 51976616, "comment_id": 90904186, "body": "did you check the directory permission you are saving in(in remote server)? it should have write permission for your app pool user"}], "answers": [{"comments": [{"owner": {"reputation": 2873, "user_id": 2789978, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b5ec692bf03786cc14d3f242dfa1bd17?s=128&d=identicon&r=PG&f=1", "display_name": "TejSoft", "link": "https://stackoverflow.com/users/2789978/tejsoft"}, "edited": false, "score": 0, "creation_date": 1534997599, "post_id": 51977395, "comment_id": 90906222, "body": "You should have a try-catch block to wrap your code to capture any exception and send out a &quot;success&quot; or &quot;failure&quot; response to your ajax call. Another point is to capture the ajax error and write into the console: failure: function () { console.log(&quot;Error in ajax call&quot;); }"}], "tags": [], "owner": {"reputation": 222, "user_id": 7166007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rXoDS2O1Pho/AAAAAAAAAAI/AAAAAAAAAH4/RyXghaqXd9s/photo.jpg?sz=128", "display_name": "Narek Daduryan", "link": "https://stackoverflow.com/users/7166007/narek-daduryan"}, "is_accepted": false, "score": 0, "last_activity_date": 1534989786, "creation_date": 1534989786, "answer_id": 51977395, "question_id": 51976616, "link": "https://stackoverflow.com/questions/51976616/asp-net-server-not-sending-httpresponse-to-ajax-post-call-after-file-save/51977395#51977395", "title": "ASP.NET server not sending httpresponse to ajax post call after file save", "body": "<p>Fixed, it was a problem with directory permissions.</p>\n\n<p>(weird, i didnt think it's an issue because the files were being uploaded successfully anyway) </p>\n"}], "owner": {"reputation": 222, "user_id": 7166007, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rXoDS2O1Pho/AAAAAAAAAAI/AAAAAAAAAH4/RyXghaqXd9s/photo.jpg?sz=128", "display_name": "Narek Daduryan", "link": "https://stackoverflow.com/users/7166007/narek-daduryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534989786, "creation_date": 1534981821, "last_edit_date": 1592644375, "question_id": 51976616, "link": "https://stackoverflow.com/questions/51976616/asp-net-server-not-sending-httpresponse-to-ajax-post-call-after-file-save", "title": "ASP.NET server not sending httpresponse to ajax post call after file save", "body": "<p>Im making a jquery ajax post call, and the .success method is being called, but the response data is empty.</p>\n<p>Javascript:</p>\n<pre><code>$.ajax({\n        type: 'post',\n        url: '/MediaUploader/fileUpload',\n        data: formData,\n        contentType: false,\n        processData: false,\n    })\n        .done(function (data) {\n            //Data \n        })\n</code></pre>\n<p>The success function is called, but the data is empty.</p>\n<p>Controller:</p>\n<pre><code>[HttpPost]\npublic ActionResult FileUpload() {\n    //code\n    file.SaveAs(pathToSave);\n    return Json(str_image);\n</code></pre>\n<p>When called, the response is empty:\n<a href=\"https://i.stack.imgur.com/dbT3V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dbT3V.png\" alt=\"no response\" /></a></p>\n<p>However, commenting out the file.SaveAs, or returning before it, causes the respond to go through:</p>\n<pre><code>[HttpPost]\npublic ActionResult FileUpload() {\n    //code\n    //file.SaveAs(pathToSave);\n    return Json(str_image);\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/KbrMw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KbrMw.png\" alt=\"yes response\" /></a></p>\n<p>When debugging, the file.SaveAs doesn't throw any exceptions, and in both cases the return is reached. Also, this problem only is occurring on the remote. On local host both versions work fine.</p>\n<p>The response doesnt go through only after the file.SaveAs on remote server.</p>\n"}, {"tags": ["c#", "asp.net", "webforms"], "answers": [{"comments": [{"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 1, "creation_date": 1534981776, "post_id": 51976526, "comment_id": 90903345, "body": "would be more acceptable of an answer to say it can be done client-side.  jQuery being a good framework and example to that notion."}, {"owner": {"reputation": 13274, "user_id": 920669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/639ffd0669e8284dcfe77a883effe31d?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/920669/corey"}, "edited": false, "score": 1, "creation_date": 1534982394, "post_id": 51976526, "comment_id": 90903446, "body": "I think Brett&#39;s comment was more of a prompt to fill out the answer with a bit more content.  Yes your code works, but it is useful to add some information about why and how so that people learn rather than just copy-paste answers.  Good answers are teaching moments :)"}], "tags": [], "owner": {"reputation": 385, "user_id": 7201721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lqCOC.jpg?s=128&g=1", "display_name": "Majdi Saibi", "link": "https://stackoverflow.com/users/7201721/majdi-saibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1534982760, "last_edit_date": 1534982760, "creation_date": 1534981117, "answer_id": 51976526, "question_id": 51976422, "link": "https://stackoverflow.com/questions/51976422/execute-method-before-form-submitted/51976526#51976526", "title": "Execute method before form submitted", "body": "<p>You can do it client-side using jQuery. So when the user clicks submit, and before submitting the form, you can update your hidden input and then return true to proceed the submission of your form.</p>\n\n<p>This is it could be done:</p>\n\n<pre><code>$(document).ready(function(){\n    $('#myForm').on('submit', function(){\n        $('#MyNewValue').val('YOUR_VALUE');\n        return true;\n    })\n});\n</code></pre>\n"}], "owner": {"reputation": 6163, "user_id": 985012, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CAxo1.png?s=128&g=1", "display_name": "TomSelleck", "link": "https://stackoverflow.com/users/985012/tomselleck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 51976526, "answer_count": 1, "score": 1, "last_activity_date": 1534982760, "creation_date": 1534980002, "question_id": 51976422, "link": "https://stackoverflow.com/questions/51976422/execute-method-before-form-submitted", "title": "Execute method before form submitted", "body": "<p>I have the following code to submit a form with a hidden value.</p>\n\n<p>The problem is - I can't set the value of <code>MyNewValue</code> before the form is submitted to the remote address <code>https://some-remote-site/Form.aspx</code>.</p>\n\n<p>Does anybody know how I can set the hidden value when the user clicks the button and then submit the form to the same address?</p>\n\n<p>MyFile.aspx</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n    &lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body style=\"height: 370px\"&gt;    \n    &lt;form id=\"myForm\" method=\"post\" runat=\"server\" action=\"https://some-remote-site/Form.aspx\"&gt;\n        &lt;fieldset&gt;\n            &lt;asp:HiddenField id=\"MyNewValue\" Value=\"X\" runat=\"server\" /&gt;\n            &lt;p&gt;\n                &lt;label for=\"Username\"&gt;Username:&lt;/label&gt;\n                &lt;asp:TextBox id=\"Username\" Text=\"Username\" runat=\"server\" /&gt;\n            &lt;/p&gt;\n            &lt;asp:Button ID=\"SubmitForm\" runat=\"server\" onclick=\"SubmitForm_Click\" Text=\"Button\" /&gt;\n        &lt;/fieldset&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>MyFile.aspx.cs</p>\n\n<pre><code>// Not executed because action=\"https://some-remote-site/Form.aspx\" is set\nprotected void SubmitForm_Click(object sender, EventArgs e)\n{\n    MyNewValue.Value = DateTime.Now.ToString();\n}\n</code></pre>\n"}, {"tags": ["c#", "entity-framework-core"], "comments": [{"owner": {"reputation": 14946, "user_id": 8188846, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/85a7614508b329eb4a495c59ccf64ac7?s=128&d=identicon&r=PG", "display_name": "Maximilian Burszley", "link": "https://stackoverflow.com/users/8188846/maximilian-burszley"}, "edited": false, "score": 0, "creation_date": 1534980312, "post_id": 51976296, "comment_id": 90903107, "body": "I mean.. .NET core and framework are not on parity.  This is to be expected?"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 2, "creation_date": 1534980568, "post_id": 51976296, "comment_id": 90903150, "body": "You are using a new framework, don&#39;t expect it to be the same. The constructor now takes <code>DbContextOptions</code> or <code>DbContextOptions&lt;OpsCentralEntities&gt;</code>"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 1, "creation_date": 1534981847, "post_id": 51976296, "comment_id": 90903360, "body": "Entity Framework Core has <b>many</b> differences with Entity Framework 6, don&#39;t think you can just replace one with the other. Also, EF Core works in .NET Framework while EF6 does not in .NET Core. You only need to use EF Core if you are targeting .NET Core"}, {"owner": {"reputation": 7076, "user_id": 93922, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c80e295c8f9d603d771873e1997e3f85?s=128&d=identicon&r=PG", "display_name": "Tetsujin no Oni", "link": "https://stackoverflow.com/users/93922/tetsujin-no-oni"}, "edited": false, "score": 0, "creation_date": 1534983629, "post_id": 51976296, "comment_id": 90903664, "body": "Perhaps a better structured question which invites specific answers, rather than what appears to be a request for an article on &quot;how to convert from EF6 to EF Core&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 14875, "user_id": 1100248, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/uE79r.jpg?s=128&g=1", "display_name": "Vova Bilyachat", "link": "https://stackoverflow.com/users/1100248/vova-bilyachat"}, "is_accepted": true, "score": 1, "last_activity_date": 1535000317, "creation_date": 1535000317, "answer_id": 51978591, "question_id": 51976296, "link": "https://stackoverflow.com/questions/51976296/upgrading-net-entity-framework-to-ef-core-seems-that-base-and-onmodelcreating-a/51978591#51978591", "title": "Upgrading .net entity framework to EF Core seems that base and OnModelCreating are not available", "body": "<p>On model creating is available</p>\n\n<pre><code>OnModelCreating(DbModelBuilder modelBuilder) -&gt; OnModelCreating(ModelBuilder modelBuilder) \n</code></pre>\n\n<p>Constructor parameter accept options</p>\n\n<pre><code>base(\"name=mydbentities\")-&gt; YourContextContext(DbContextOptions options) : base(options)\n</code></pre>\n\n<p>There will be problem if you are using <code>SqlQuery</code> because now you need to <a href=\"https://github.com/aspnet/EntityFrameworkCore/issues/1862#issuecomment-372889792\" rel=\"nofollow noreferrer\">add it to model</a> </p>\n\n<pre><code>modelBuilder.Query&lt;YourModel&gt;() //to OnModelCreating(ModelBuilder modelBuilder)\n\ndb.Query&lt;YourModel&gt;().FromSql(rawSql)\n</code></pre>\n\n<p>And last problem i got was many to many should <a href=\"https://www.learnentityframeworkcore.com/configuration/many-to-many-relationship-configuration\" rel=\"nofollow noreferrer\">be using Extra type</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10189172"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 51978591, "answer_count": 1, "score": -1, "last_activity_date": 1535000317, "creation_date": 1534979022, "last_edit_date": 1534999563, "question_id": 51976296, "link": "https://stackoverflow.com/questions/51976296/upgrading-net-entity-framework-to-ef-core-seems-that-base-and-onmodelcreating-a", "title": "Upgrading .net entity framework to EF Core seems that base and OnModelCreating are not available", "body": "<p>I have been upgrading from .net 4.6 application to .net core 2.1.x and some of these objects and methods are just not available.</p>\n\n<p>Examples:  </p>\n\n<ol>\n<li>Issues with <code>:base(\"name=mydbentities\")</code></li>\n<li><code>OnModelCreating(DbModelBuilder modelBuilder)</code></li>\n<li><code>base:(nameOrConnectionString)</code></li>\n</ol>\n\n<p>From the old .net code base are 2 partial classes</p>\n\n<pre><code>public partial class OpsCentralEntities : DbContext\n{\n    public OpsCentralEntities() : base(\"name=OpsCentralEntities\")\n    {\n    }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        throw new UnintentionalCodeFirstException();\n    }\n}\n</code></pre>\n\n<p>In the above code</p>\n\n<blockquote>\n  <p>Error CS1503  Argument 1: cannot convert from 'string' to 'Microsoft.EntityFrameworkCore.DbContextOptions'    </p>\n</blockquote>\n\n<p>then this</p>\n\n<blockquote>\n  <p>'OpsCentralEntities.OnModelCreating(DbModelBuilder)': no suitable method found to override </p>\n</blockquote>\n\n<p>Then with the other partial class</p>\n\n<pre><code>public partial class OpsCentralEntities : IDbContext\n{\n    public OpsCentralEntities(string nameOrConnectionString)\n        : base(nameOrConnectionString)\n    { }\n    ....\n}\n</code></pre>\n\n<blockquote>\n  <p>Cannot convert from 'string' to 'Microsoft.EntityFrameworkCore.DbContextOptions'  </p>\n</blockquote>\n"}, {"tags": ["c#", "php", "ssl", "curl"], "comments": [{"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 1, "creation_date": 1534979571, "post_id": 51976278, "comment_id": 90902948, "body": "Depending on which Windows version and the software running on it you may or may not have support for TLS 1.2. By using <code>SslProtocols.Tls</code> you are probably letting the client/server negotiate whatever version they can speak, and it could be TLS 1.0 or 1.1 but they have found a common ground, as it seems at least one party is not able to do TLS 1.2"}, {"owner": {"reputation": 2178, "user_id": 808417, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rmLRB.jpg?s=128&g=1", "display_name": "Alfie", "link": "https://stackoverflow.com/users/808417/alfie"}, "reply_to_user": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1534980764, "post_id": 51976278, "comment_id": 90903177, "body": "@PatrickMevzek thank you, this is basically it. SSPI was a red-herring somewhat, instead I think I should have been looking at the &#39;Registered Stream Socket Transports&#39; detail in phpInfo(). Only &#39;tls&#39; is listed on the remote server, but locally there is &#39;tls, tlsv1.0, tlsv1.1, tlsv1.2&#39;. If you turn this in to an answer I will accept."}], "answers": [{"tags": [], "owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "is_accepted": true, "score": 1, "last_activity_date": 1535736286, "creation_date": 1535736286, "answer_id": 52120204, "question_id": 51976278, "link": "https://stackoverflow.com/questions/51976278/ssl-tls-errors-using-curl-php-with-a-c-rest-api-and-the-sslstream-class/52120204#52120204", "title": "SSL/TLS errors using cURL (PHP) with a C# REST API and the SslStream class", "body": "<p>The problem was not  related to SSPI in fact.</p>\n\n<p><code>SslProtocols.Tls</code> probably means: \"auto-negotiate any suitable common version\" while <code>SslProtocols.Tls12</code> means: \"force TLS version 1.2\"</p>\n\n<p>So if you force TLS 1.2 but not all parties know this version, then the handshake will fail.\nBy letting them autonegotiate they are instead probably able to converge on TLS 1.1 or 1.0</p>\n\n<p>Note that nowadays anything other than TLS 1.2 is not a good idea, or at least it should really be a temporary situation. Also TLS 1.3 just went out as a standard 2 weeks ago.</p>\n\n<p>It is often better to let systems autonegotiate versions so that, when they are upgraded, they fall into the highest possible one at that time. So forcing <code>SslProtocols.Tls12</code> even if it had worked, would have been good in the short term (best TLS version right now) but not in long term (if both your systems were upgraded and capable of TLS 1.3 in some future, you would not profit from it which is sad as 1.3 is better than 1.2 in many aspects).</p>\n\n<p>But, on the opposite, just letting them autonegotiate has some drawbacks:</p>\n\n<ol>\n<li>while mostly cosmetic, the symbolic constant in OpenSSL to have this auto negotiation is very misleadingly called <code>SSLv23_METHOD</code> (where you have also <code>TLSv1_2_METHOD</code> for example) and this does <strong>not</strong> mean SSL 2 or SSL 3 (two things that should be now dead) but \"whatever best we can autonegotiate\" (on the generic issue of proper design and use of TLS APIs specifically outside the web, this is an eye-opening paper: <a href=\"https://www.cs.utexas.edu/~shmat/shmat_ccs12.pdf\" rel=\"nofollow noreferrer\">https://www.cs.utexas.edu/~shmat/shmat_ccs12.pdf</a>)</li>\n<li>more important, if you do not watch what is happening (logging), you could have systems autonegotiating very low versions like TLS 1.0 or even worse SSL 3.0 when you wanted at the same time something better. So you may have a running systems but not up to the security level you want or need.</li>\n</ol>\n"}], "owner": {"reputation": 2178, "user_id": 808417, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rmLRB.jpg?s=128&g=1", "display_name": "Alfie", "link": "https://stackoverflow.com/users/808417/alfie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 52120204, "answer_count": 1, "score": 0, "last_activity_date": 1535736286, "creation_date": 1534978865, "last_edit_date": 1534979442, "question_id": 51976278, "link": "https://stackoverflow.com/questions/51976278/ssl-tls-errors-using-curl-php-with-a-c-rest-api-and-the-sslstream-class", "title": "SSL/TLS errors using cURL (PHP) with a C# REST API and the SslStream class", "body": "<p>I have written a REST API server in C#, it uses the <code>System.Net.Security.SslStream</code> class to provide SSL/TLS encryption.</p>\n\n<p>I am also creating a web service which uses PHP + cURL to handle communication with the server.</p>\n\n<p>Locally, I am using WAMP as a test environment, and all works fine.</p>\n\n<p>However, upon uploading and testing on a remote environment, communication failed with the following error messages:</p>\n\n<p><strong>cURL Error</strong></p>\n\n<pre><code>Unknown SSL protocol error in connection to mywebsite.example:443\n</code></pre>\n\n<p><strong>SslStream Error</strong></p>\n\n<p><code>AuthenticationException</code> in <code>SslStream.AuthenticateAsServer()</code>:</p>\n\n<pre><code>A call to SSPI failed, see inner exception.\n\nInner exception: The client and server cannot communicate, because they do not possess a common algorithm\n</code></pre>\n\n<p>This exception and error occurs when attempting to use TLS 1.2 authentication:</p>\n\n<pre><code>SslStream.AuthenticateAsServer(ServerCertificate, false, SslProtocols.Tls12, true);\n</code></pre>\n\n<p>I tried setting various cURL options such as:</p>\n\n<pre><code>    curl_setopt($curl, CURLOPT_SSLVERSION,CURL_SSLVERSION_TLSv1_2);\n</code></pre>\n\n<p>but, alas, no joy.</p>\n\n<p>After checking the <code>phpInfo()</code> configurations for differences, I noticed SSPI was enabled in the cURL settings locally, but not on the remote server:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HXXA6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HXXA6.png\" alt=\"cURL settings\"></a></p>\n\n<p>I know very little about SSPI, in fact, mostly just what is summarised on Wikipedia:</p>\n\n<blockquote>\n  <p>Security Support Provider Interface (SSPI) is a Win32 API used by\n  Microsoft Windows systems to perform a variety of security-related\n  operations such as authentication.</p>\n</blockquote>\n\n<p>So, it seems to make sense that this is the cause of the problem - but...</p>\n\n<p><strong>I managed to achieve successful communication</strong> by changing the <code>SslProtocols</code> type from <code>SslProtocols.Tls12</code> to just <code>SslProtocols.Tls</code>. However, from what I can tell, SSPI is not tied to any particular SSL protocol, so why did this work?</p>\n\n<p>This is a workaround for now, but I would really like to understand the underlying issue causing this problem. Can anyone shed some light on what's going on here?</p>\n\n<p>I would much rather fully support TLS 1.2 and not have to downgrade.</p>\n"}, {"tags": ["c#", "system.reflection", "c#-7.0"], "comments": [{"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 2, "creation_date": 1534979912, "post_id": 51976234, "comment_id": 90903023, "body": "Firstly, there are setting to monitor for exceptions types and you can just turn them off, however, the fact you are using exceptions to control the flow of your application is the real problem here, although this can work, it is bad design... You really should be in control of this, you know your types, or if dont you could use reflection to figure it out, either way its a bit smelly"}, {"owner": {"reputation": 11324, "user_id": 460084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da1ca34cd223036fca4443fe8187b2fd?s=128&d=identicon&r=PG", "display_name": "kofifus", "link": "https://stackoverflow.com/users/460084/kofifus"}, "reply_to_user": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 0, "creation_date": 1534980535, "post_id": 51976234, "comment_id": 90903145, "body": "ah got it, I should look for a constructor using Type.GetConstructor ! if you want to post an answer I&#39;ll mark it, thanks!"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 1, "creation_date": 1534983508, "post_id": 51976234, "comment_id": 90903648, "body": "I think the real question here is <i>why you are using <code>Activator.CreateInstance</code> for a type you <b>know</b> at <b>compile-time</b>?</i>  Why not just use <code>new MyClass(f1, f2)</code>?"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1534983705, "post_id": 51976234, "comment_id": 90903679, "body": "Also, to <i>&quot;to prevent the debugger from stopping on the exception if it is caught&quot;</i> - see <a href=\"https://stackoverflow.com/a/34172404/585968\">stackoverflow.com/a/34172404/585968</a>"}], "answers": [{"tags": [], "owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "is_accepted": true, "score": 3, "last_activity_date": 1534980911, "creation_date": 1534980911, "answer_id": 51976506, "question_id": 51976234, "link": "https://stackoverflow.com/questions/51976234/visual-studio-2017-prevent-debugger-from-stopping-on-exception-in-activator-crea/51976506#51976506", "title": "Visual Studio 2017 prevent debugger from stopping on exception in Activator.CreateInstance", "body": "<p>A quick an nasty approach is to look for constructors, <code>GetConstructors</code> and looking at the <code>GetParameters</code> count, then branch accordingly.</p>\n\n<pre><code>var ctors = typeof(A).GetConstructors();\n// assuming class A has only one constructor\nvar ctor = ctors[0];\nforeach (var param in ctor.GetParameters())\n{\n    Console.WriteLine(string.Format(\n        \"Param {0} is named {1} and is of type {2}\",\n        param.Position, param.Name, param.ParameterType));\n}\n</code></pre>\n\n<p>Once again, there are probably better ways to do this. However, at least you aren't using exceptions to control the flow of your application.</p>\n\n<p>If you know the type of your classes, you could also compare types. Or if you are using base classes, or interface, you could use generics with constraints. A lot of this depends on the stuff we cant see and the <em>whys</em></p>\n"}], "owner": {"reputation": 11324, "user_id": 460084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da1ca34cd223036fca4443fe8187b2fd?s=128&d=identicon&r=PG", "display_name": "kofifus", "link": "https://stackoverflow.com/users/460084/kofifus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 51976506, "answer_count": 1, "score": 1, "last_activity_date": 1534988899, "creation_date": 1534978456, "last_edit_date": 1534988899, "question_id": 51976234, "link": "https://stackoverflow.com/questions/51976234/visual-studio-2017-prevent-debugger-from-stopping-on-exception-in-activator-crea", "title": "Visual Studio 2017 prevent debugger from stopping on exception in Activator.CreateInstance", "body": "<p>I have code that tries to create an object first with one constructor and then, if that fails, with the default constructor:</p>\n\n<pre><code>MyClass Construct(MyField f1, MyField f2) \n{\n    try \n    {\n        return (MyClass)Activator.CreateInstance(typeof(MyClass), f1, f2);\n    }\n    catch \n    {\n        var o = (MyClass)Activator.CreateInstance(typeof(MyClass)); \n        o.f1= f1; \n        o.f2=f2;\n        return o;\n    }\n}\n</code></pre>\n\n<p>I want to prevent the debugger from stopping on the exception if it is caught. I tried <code>[DebuggerStepThrough]</code>, <code>[DebuggerHidden]</code> and <code>[DebuggerNonUserCode]</code> without luck.</p>\n\n<p>I also tried running: <code>\"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\\Common7\\IDE\\VsRegEdit.exe\" set \"C:\\Program Files (x86)\\Microsoft Visual Studio\\2017\\Community\" HKLM Debugger\\Engine AlwaysEnableExceptionCallbacksOutsideMyCode dword 1</code> as advised <a href=\"https://developercommunity.visualstudio.com/content/problem/2294/avoid-first-chance-exceptions-in-methods-marked-wi.html\" rel=\"nofollow noreferrer\">here</a> but no luck.</p>\n\n<p>Is there any way to do this in VS2017? Alternatively, is there a way to use <code>Activator.CreateInstance</code> that will return <code>null</code> instead of throwing an exception?</p>\n\n<p>(using visual studio 2017 15.8.0 preview 4.0)</p>\n"}, {"tags": ["c#", "asp.net", "ssl", "smtp", "system.net.mail"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1534982606, "post_id": 51976207, "comment_id": 90903484, "body": "What port does your email provider use for SSL email?"}, {"owner": {"reputation": 1317, "user_id": 6647188, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Ol4rA.jpg?s=128&g=1", "display_name": "Kyle Vassella", "link": "https://stackoverflow.com/users/6647188/kyle-vassella"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1534983439, "post_id": 51976207, "comment_id": 90903635, "body": "Unsure, but I would guess 465"}, {"owner": {"reputation": 1605, "user_id": 1689226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd71f9f43c5a587ef304196c5e667c3e?s=128&d=identicon&r=PG", "display_name": "Subbu", "link": "https://stackoverflow.com/users/1689226/subbu"}, "edited": false, "score": 0, "creation_date": 1534992656, "post_id": 51976207, "comment_id": 90905320, "body": "instead of <code>25</code> as port number, can you give the actual SSL enabled port number of your mail server ? (also set <code>EnableSsl</code> to <code>true</code>). You can also see the exact error message the remote server is returning. This can help in trouble shooting. We have used the following command line program (<a href=\"http://caspian.dotconf.net/menu/Software/SendEmail/\" rel=\"nofollow noreferrer\">caspian.dotconf.net/menu/Software/SendEmail</a>) for trouble shooting the mail issues. In our experience, in most cases, there is some setting change that is required in the mail server. (For e.g., to relax relaying restrictions, etc). So, the exact error message from the mail server is crtiical."}], "answers": [{"tags": [], "owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "is_accepted": false, "score": 1, "last_activity_date": 1534984112, "creation_date": 1534984112, "answer_id": 51976838, "question_id": 51976207, "link": "https://stackoverflow.com/questions/51976207/how-to-use-explicit-ssl-with-system-net-mail-smtp/51976838#51976838", "title": "How to use explicit SSL with System.Net.Mail SMTP", "body": "<p>You can't.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/950260/you-cannot-use-system-net-mail-smtpclient-to-send-an-e-mail-message-wi\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/950260/you-cannot-use-system-net-mail-smtpclient-to-send-an-e-mail-message-wi</a></p>\n\n<p>You can supposedly use cdo.sys, but it's really old and I don't believe it's supported anymore. I'm also not sure it's available or usable since it came with Windows 2000.</p>\n\n<p>Your best bet would be to setup an actual mail server to handle talking to the outside world and talk to it with your unencrypted port 25 connection. If you have a small box to dedicate, Postfix is a free, very lightweight and very robust SMTP server that would work nicely.</p>\n"}], "owner": {"reputation": 1317, "user_id": 6647188, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Ol4rA.jpg?s=128&g=1", "display_name": "Kyle Vassella", "link": "https://stackoverflow.com/users/6647188/kyle-vassella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1185, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534984112, "creation_date": 1534978291, "last_edit_date": 1534979889, "question_id": 51976207, "link": "https://stackoverflow.com/questions/51976207/how-to-use-explicit-ssl-with-system-net-mail-smtp", "title": "How to use explicit SSL with System.Net.Mail SMTP", "body": "<p>I've seen a lot of examples of implicit SSL (for use with the deprecated <code>System.Web.Mail</code>), but I'm using <code>System.Net.Mail</code> and would like a code example for how to send SMTP emails via explicit SSL. </p>\n\n<p>My current <code>sendEmail</code> code is below - note that if I set <code>EnableSsl = true</code>, server returns a 500 error and the email is never sent. I assume because this is implicit SSL, which <code>System.Net.Mail</code> does not support:</p>\n\n<pre><code>using System.Net.Mail;\n...\n\n    public static void SendEmail(string emailbody)\n    {\n\n        MailMessage mailMessage = new MailMessage(\"myDomain@me.com\", \"yourDomain@me.com\");\n\n        mailMessage.IsBodyHtml = true;\n\n        mailMessage.Body = emailbody;\n\n        mailMessage.Subject = \"My email\";\n\n        SmtpClient smtpClient = new SmtpClient(\"smtp.me.com\", 25);\n\n        // if false, email sends. If true, email does not send, server returns 500 error\n        smtpClient.EnableSsl = false;\n\n        smtpClient.Send(mailMessage);\n    }\n</code></pre>\n"}, {"tags": ["c#", "printing", "printdocument"], "comments": [{"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 0, "creation_date": 1534979188, "post_id": 51976182, "comment_id": 90902878, "body": "I think this might depend on the print driver, though you might want to play with the print spool settings, <code>print after last page is spooled</code>, and  <code>start printing immediately</code>. Postscript, PCL, HPGL, breaks up printing work into a special language that the printer understands, the Windows spools that work so the printer can deal with it in a orderly fashion. I&#39;m not sure if this is the case, but it could be possible that the way you are doing this is trying to send 20 pages at once (as 1 page) to the printer and its running out of memory."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1534985147, "post_id": 51976182, "comment_id": 90903973, "body": "I haven&#39;t seen a printer than can&#39;t handle many more than 3 pages since the days of Windows 3.x, including old dot matrix and thermal receipt printers."}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 2, "creation_date": 1534988624, "post_id": 51976182, "comment_id": 90904612, "body": "All those drawing classes you are using (Graphics, Font, etc.) are wrappers around Win32 GDI objects and are Disposable. If you don&#39;t Dispose those things, unexpected results can happen. Read up on the &quot;using&quot; statement and IDisposable, and make sure you clean things up properly.  You aren&#39;t printing line by line; you are printing page by page (hence the PrintPage event). You should be able to print <i>a lot</i> of pages."}, {"owner": {"reputation": 300, "user_id": 6357272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-qKLVQY5Zzp4/AAAAAAAAAAI/AAAAAAAAAGI/hBUTcdFh8GI/photo.jpg?sz=128", "display_name": "Adan Sandoval", "link": "https://stackoverflow.com/users/6357272/adan-sandoval"}, "reply_to_user": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1535045276, "post_id": 51976182, "comment_id": 90932144, "body": "@Flydog57 Edited the Question showing the way I&#39;m disposing of those objects (I forgot earlier to include those lines but they are actually in my code)  But I just realized most of the iterations those lines are not being called, thanks for the advice. It actually solved the issue, post it as an answer please to mark it as resolved."}], "answers": [{"tags": [], "owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "is_accepted": true, "score": 1, "last_activity_date": 1535049306, "creation_date": 1535049306, "answer_id": 51992236, "question_id": 51976182, "link": "https://stackoverflow.com/questions/51976182/does-printdocument-sends-whole-document-to-printer-or-line-by-line/51992236#51992236", "title": "Does PrintDocument sends whole document to printer or line by line?", "body": "<p>Some hints:</p>\n\n<p>All those drawing classes you are using (Graphics, Font, etc.) are wrappers around Win32 GDI objects and are Disposable. If you don't Dispose those things, <em>unexpected</em> results can happen. Read up on the \"using\" statement and IDisposable, and make sure you clean things up properly. You aren't printing line by line; you are printing page by page (hence the PrintPage event). You should be able to print a <em>lot</em> of pages.</p>\n"}], "owner": {"reputation": 300, "user_id": 6357272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-qKLVQY5Zzp4/AAAAAAAAAAI/AAAAAAAAAGI/hBUTcdFh8GI/photo.jpg?sz=128", "display_name": "Adan Sandoval", "link": "https://stackoverflow.com/users/6357272/adan-sandoval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 944, "favorite_count": 0, "accepted_answer_id": 51992236, "answer_count": 1, "score": 2, "last_activity_date": 1535049306, "creation_date": 1534978073, "last_edit_date": 1535040854, "question_id": 51976182, "link": "https://stackoverflow.com/questions/51976182/does-printdocument-sends-whole-document-to-printer-or-line-by-line", "title": "Does PrintDocument sends whole document to printer or line by line?", "body": "<p>A little context: I'm developing a Windows Form app that contains a feature where the user prints some info.</p>\n\n<p>The thing is that the size of that information can change from time to time: sometimes it can fit on a single page or sometimes it can be 20+ pages.</p>\n\n<p>For the printings, I'm using .Net's <code>PrintDocument</code></p>\n\n<p>So I'm using <code>e.HasMorePages</code> to handle the possible multiple pages. Here's a simplified version of my code:</p>\n\n<pre><code>int printIndex = 0;\n\nprivate void startPrinting(){\n    PrintDocument printDoc = new PrintDocument();\n    printDoc.PrinterSettings.PrinterName = \"Ticket printer1\"\n\n    printDoc.PrintPage += new PrintPageEventHandler(printPage);\n    printDoc.Print();\n}\n</code></pre>\n\n<p>And the <code>printPage</code> method:</p>\n\n<pre><code>private void printPage(object sender, PrintPageEventArgs e)\n{\n    Graphics graphics = e.Graphics;\n    int yPos = 0;\n    Font regular = new Font(FontFamily.GenericSansSerif, 10.0f, FontStyle.Regular);\n\n    for(int i = printIndex; i &lt; data.Length; i++)\n    {\n        if (yPos + 30 &gt;= e.PageBounds.Height)\n        {\n            e.HasMorePages = true;\n            return;\n        }\n        else\n        {\n            e.HasMorePages = false;\n        }\n        graphics.DrawString(data[i], regular, Brushes.Black, yPos, 110);\n        yPos += 20;\n        printIndex++;\n    }\n    regular.Dispose();\n    graphics.Dispose();\n}\n</code></pre>\n\n<p>And this works just fine on virtual printers and even some physical printers here at the office. But when the user runs the app on his actual computer (with his actual printer) it prints no more than 3 pages.</p>\n\n<p>I asked a peer and he suggested that Windows is sending the whole document to the printer and maybe some printers can't handle large documents due to low memory issues.</p>\n\n<p>Is it how it works? and if it is: how can I fix it to print more than 3 pages?</p>\n"}, {"tags": ["c#", "string", "list", "dictionary", "data-structures"], "comments": [{"owner": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "edited": false, "score": 0, "creation_date": 1534976977, "post_id": 51975997, "comment_id": 90902406, "body": "You should probably reverse the order, and then use linq <code>.GroupBy()</code> to reverse the order of the array for lookup."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 1, "creation_date": 1534980466, "post_id": 51975997, "comment_id": 90903130, "body": "<code>var value = myDictionary.FirstOrDefault(kvp =&gt; kvp.Key.Contains(&quot;beans&quot;)).Value ?? &quot;undefined&quot;;</code> this returns the value of the first item whose key contains the string you&#39;re searching for, or &quot;undefined&quot; if it doesn&#39;t exist."}, {"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 0, "creation_date": 1534981428, "post_id": 51975997, "comment_id": 90903293, "body": "This is a job for a relationship structure, class called <code>category</code>, class called <code>food</code>, Many-to-many you would usually stick this in a Database, however you could use A dictionary of list of food, or a mapping list (many to many), or a dictionary of list of category.   Or you food could just have a sub list of category , or many options. choose your favorite"}, {"owner": {"reputation": 756, "user_id": 8157029, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/074942783234568a3632db47917e8428?s=128&d=identicon&r=PG&f=1", "display_name": "jtth", "link": "https://stackoverflow.com/users/8157029/jtth"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1535053350, "post_id": 51975997, "comment_id": 90935959, "body": "@RufusL yes thanks"}], "answers": [{"comments": [{"owner": {"reputation": 13274, "user_id": 920669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/639ffd0669e8284dcfe77a883effe31d?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/920669/corey"}, "edited": false, "score": 0, "creation_date": 1534978754, "post_id": 51976133, "comment_id": 90902785, "body": "Umm... yes, but why?  And what happens when you try <code>myDictionary[&quot;radish&quot;]</code>?"}], "tags": [], "owner": {"reputation": 61863, "user_id": 133910, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f1b913d48f914347dcafabff8d01ded?s=128&d=identicon&r=PG", "display_name": "Yuriy Faktorovich", "link": "https://stackoverflow.com/users/133910/yuriy-faktorovich"}, "is_accepted": false, "score": 0, "last_activity_date": 1534977788, "creation_date": 1534977788, "answer_id": 51976133, "question_id": 51975997, "link": "https://stackoverflow.com/questions/51975997/what-data-structure-am-i-looking-for/51976133#51976133", "title": "What data structure am I looking for?", "body": "<pre><code>var myItems = new Tuple&lt;List&lt;string&gt;, string&gt;[]\n{\n    new Tuple&lt;List&lt;string&gt;, string&gt;(new List&lt;string&gt; { \"raspberries\", \"blackberries\", \"blueberries\", \"orange\", \"watermelon\", \"apple\", \"strawberries\" }, \"fruits\" ),\n    new Tuple&lt;List&lt;string&gt;, string&gt;(new List&lt;string&gt; { \"spinach\", \"kale\", \"carrots\", \"celery\", \"tomato\", \"red onion\" }, \"veggies\" ),\n    new Tuple&lt;List&lt;string&gt;, string&gt;(new List&lt;string&gt; { \"almonds\", \"walnuts\", \"fish oil\", \"nut butter\" }, \"fats\" ),\n    new Tuple&lt;List&lt;string&gt;, string&gt;(new List&lt;string&gt; { \"oatmeal\", \"brown rice\", \"beans\", \"lentils\" }, \"carbs\" ),\n    new Tuple&lt;List&lt;string&gt;, string&gt;(new List&lt;string&gt; { \"beef\", \"chicken\", \"eggs\", \"salmon\", \"mackerel\" }, \"proteins\" ),\n};\n\nvar myDictionary = myItems.SelectMany(t =&gt; t.Item1.Select(item =&gt; new {item, type = t.Item2}))\n    .ToDictionary(a =&gt; a.item, a =&gt; a.type);\n\nConsole.WriteLine(myDictionary[\"spinach\"]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 569, "user_id": 7158180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ed6efada879923203f990ac3ab546e?s=128&d=identicon&r=PG", "display_name": "Jim Berg", "link": "https://stackoverflow.com/users/7158180/jim-berg"}, "edited": false, "score": 0, "creation_date": 1534982724, "post_id": 51976240, "comment_id": 90903511, "body": "The data structure he&#39;s looking for is clearly not close to what it needs to be.  Getting it to work is one thing, getting it to work well is another.  Any answer that involves a linear search isn&#39;t likely the best one, especially if this is a smaller example of a much larger database.    Your LINQ recommendation is that he does a linear search for the first array which has his value in it which is also searched linearly."}, {"owner": {"reputation": 13274, "user_id": 920669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/639ffd0669e8284dcfe77a883effe31d?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/920669/corey"}, "reply_to_user": {"reputation": 569, "user_id": 7158180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ed6efada879923203f990ac3ab546e?s=128&d=identicon&r=PG", "display_name": "Jim Berg", "link": "https://stackoverflow.com/users/7158180/jim-berg"}, "edited": false, "score": 0, "creation_date": 1535065012, "post_id": 51976240, "comment_id": 90940165, "body": "@JimBerg I answered the question as posed.  With a small number of items in the list the search time is less than a millisecond.  And with the proposed use - looking up items entered by the user - we&#39;re not talking about doing a million lookups over the lifespan of the program.  If the question was about <i>efficient</i> structures I would answer differently."}, {"owner": {"reputation": 569, "user_id": 7158180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ed6efada879923203f990ac3ab546e?s=128&d=identicon&r=PG", "display_name": "Jim Berg", "link": "https://stackoverflow.com/users/7158180/jim-berg"}, "edited": false, "score": 0, "creation_date": 1535198798, "post_id": 51976240, "comment_id": 90984198, "body": "@Correy The OP asked &quot;What structure is best for this type of data usage?&quot;  Efficient structures <i>are</i> the best structures.  We don&#39;t know how many eventual users the OP will have for the app or how much data will be contained within it.  The worst case search for &quot;mackerel&quot; is 30 times faster using a dictionary vs an array.  Think about 30 users getting an answer back in the same time it would take 1 user to get an answer.   It only gets worse as the database expands.  The most important thing for the OP to learn is using proper indexing to find data vs. brute force methods."}], "tags": [], "owner": {"reputation": 13274, "user_id": 920669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/639ffd0669e8284dcfe77a883effe31d?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/920669/corey"}, "is_accepted": false, "score": 0, "last_activity_date": 1534978486, "creation_date": 1534978486, "answer_id": 51976240, "question_id": 51975997, "link": "https://stackoverflow.com/questions/51975997/what-data-structure-am-i-looking-for/51976240#51976240", "title": "What data structure am I looking for?", "body": "<p>Since <code>Dictionary&lt;TKey, TValue&gt;</code> implements <code>IEnumerable&lt;KeyValuePair&lt;TKey, TValue&gt;&gt;</code> you can use LINQ to operate on the data.</p>\n\n<p>In this case your keys are <code>List&lt;string&gt;</code>, and <code>List.Contains</code> will let you check if a string is in the list.  Once you find the entry that matches you just need to grab the <code>Value</code> member of the pair.  Since <code>KeyValuePair&lt;&gt;</code> is a value type you won't have to worry about null returns from <code>FirstOrDefault</code> so let's use that:</p>\n\n<pre><code>var value = myDictionary.FirstOrDefault(kv =&gt; kv.Key.Contains(\"beans\")).Value;\n</code></pre>\n\n<p>If the string you're searching for (\"beans\" in this case) isn't found the output will be null.</p>\n\n<p>As to the data structure...</p>\n\n<p><code>Dictionary&lt;List&lt;string&gt;, string&gt;</code> is an odd choice.  You get almost nothing from the object except overheads.  You can't use the <code>Dictionary&lt;&gt;</code> methods to get at the data, your 'keys' aren't readily searchable, etc.</p>\n\n<p>For plain storage with a little decoration for easy reading you can use an array of the new <code>ValueTuple&lt;&gt;</code> class like this:</p>\n\n<pre><code>(string Category, string[] Items)[] foods = new[] {\n    (\"fruits\", new[] { \"raspberries\", \"blackberries\", \"blueberries\", \"orange\", \"watermelon\", \"apple\", \"strawberries\" }),\n    ( \"veggies\", new[] { \"spinach\", \"kale\", \"carrots\", \"celery\", \"tomato\", \"red onion\" }),\n    ( \"fats\", new[] { \"almonds\", \"walnuts\", \"fish oil\", \"nut butter\" }),\n    ( \"carbs\", new[] { \"oatmeal\", \"brown rice\", \"beans\", \"lentils\" }),\n    ( \"proteins\", new[] { \"beef\", \"chicken\", \"eggs\", \"salmon\", \"mackerel\" }),\n};\n</code></pre>\n\n<p>This is an array with some compile-time stuff to make it simpler to access.  The lookup is fundamentally the same:</p>\n\n<pre><code>var value = foods.FirstOrDefault(_ =&gt; _.Items.Contains(\"beans\")).Category;\n</code></pre>\n\n<p>Only one of many, many ways to do it.  Without more information on your actual use case there are way too many ways you could go.</p>\n"}, {"tags": [], "owner": {"reputation": 569, "user_id": 7158180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0ed6efada879923203f990ac3ab546e?s=128&d=identicon&r=PG", "display_name": "Jim Berg", "link": "https://stackoverflow.com/users/7158180/jim-berg"}, "is_accepted": false, "score": 2, "last_activity_date": 1534981301, "last_edit_date": 1534981301, "creation_date": 1534980921, "answer_id": 51976508, "question_id": 51975997, "link": "https://stackoverflow.com/questions/51975997/what-data-structure-am-i-looking-for/51976508#51976508", "title": "What data structure am I looking for?", "body": "<p>\"beans\" should be a key with \"carb\" being the value.  Key's should be simple types with the value possibly being complex.  It should be neither in your case.  Just use a Dictionary  where the food is the key and the type of food is the value.  You shouldn't have to search within a key to find what value it's associated with.  In your example, you'd have to iterate though all of the keys and then search which key matches and then get the value.  That defeats the purpose of having a key.</p>\n\n<p>Flip it so that the food type is the key to find what food list it goes with and then build a Dictionary where you can lookup the food type based on the food.</p>\n\n<p>Yes, LINQ can do all sorts of wonderous things, but it will be slow to get there unless you structure things correctly.  This is the fastest way you can lookup what you want in either direction.</p>\n\n<pre><code>    var myDictionary = new Dictionary&lt;string, List&lt;string&gt;&gt;\n    {\n        { \"fruits\", new List&lt;string&gt; { \"raspberries\", \"blackberries\", \"blueberries\", \"orange\", \"watermelon\", \"apple\", \"strawberries\" } },\n        { \"veggies\", new List&lt;string&gt; { \"spinach\", \"kale\", \"carrots\", \"celery\", \"tomato\", \"red onion\" } },\n        { \"fats\", new List&lt;string&gt; { \"almonds\", \"walnuts\", \"fish oil\", \"nut butter\" } },\n        { \"carbs\",new List&lt;string&gt; { \"oatmeal\", \"brown rice\", \"beans\", \"lentils\" } },\n        { \"proteins\", new List&lt;string&gt; { \"beef\", \"chicken\", \"eggs\", \"salmon\", \"mackerel\" } },\n    };\n        var myFoodIndex = new Dictionary&lt;string, string&gt;();\n        foreach(var key in myDictionary.Keys)\n        {\n            foreach (var foodType in myDictionary[key])\n                myFoodIndex.Add(foodType, key);\n        }\n        Console.WriteLine(myFoodIndex.ContainsKey(\"beans\") ? myFoodIndex[\"beans\"] : \"Not Found\");\n        Console.ReadKey();\n</code></pre>\n\n<p>I should add that if you want to order the list, use an SortedDictionary or a SortedList.  Read more <a href=\"https://stackoverflow.com/questions/935621/whats-the-difference-between-sortedlist-and-sorteddictionary\">here</a> about the advantages and disadvantages of each. </p>\n"}], "owner": {"reputation": 756, "user_id": 8157029, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/074942783234568a3632db47917e8428?s=128&d=identicon&r=PG&f=1", "display_name": "jtth", "link": "https://stackoverflow.com/users/8157029/jtth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1535126544, "creation_date": 1534976835, "last_edit_date": 1535126544, "question_id": 51975997, "link": "https://stackoverflow.com/questions/51975997/what-data-structure-am-i-looking-for", "title": "What data structure am I looking for?", "body": "<pre><code>Dictionary&lt;List&lt;string&gt;, string&gt; myDictionary = new Dictionary&lt;List&lt;string&gt;, string&gt;\n{\n    { new List&lt;string&gt; { \"blackberries\", \"orange\", \"watermelon\", \"apple\" }, \"fruits\" },\n    { new List&lt;string&gt; { \"spinach\", \"kale\", \"celery\", \"tomato\", \"red onion\" }, \"veggies\" },\n    { new List&lt;string&gt; { \"almonds\", \"walnuts\", \"fish oil\", \"nut butter\" }, \"fats\" },\n    { new List&lt;string&gt; { \"oatmeal\", \"brown rice\", \"beans\", \"lentils\" }, \"carbs\" },\n    { new List&lt;string&gt; { \"beef\", \"chicken\", \"eggs\", \"salmon\", \"mackerel\" }, \"proteins\" },\n};\n</code></pre>\n\n<p>Use case is punching in a string and seeing which key it exists in and spitting out its correct value. Ex: </p>\n\n<pre><code>var temp = myDictionary[new List&lt;string&gt; { \"beans\" }];\n</code></pre>\n\n<p>temp returns carbs.</p>\n\n<p>Though the way this is currently structured, this does not work as \"beans\" does not exist as a <code>key</code> it exists as part of a <code>key</code>.</p>\n\n<p>What structure is best for this type of data usage?</p>\n"}, {"tags": ["c#", "unity3d", "textures", "bmp", "texture2d"], "answers": [{"comments": [{"owner": {"reputation": 460, "user_id": 3410785, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/a9856b360b03ad3719fc1a7dfb61c2cc?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Burg", "link": "https://stackoverflow.com/users/3410785/anthony-burg"}, "edited": false, "score": 0, "creation_date": 1594852635, "post_id": 51977073, "comment_id": 111276144, "body": "Note that the BMPLoader doesn&#39;t check for mirror image bmps. This will result in them being drawn incorrectly."}], "tags": [], "owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "is_accepted": true, "score": 7, "last_activity_date": 1534987202, "last_edit_date": 1534987202, "creation_date": 1534986743, "answer_id": 51977073, "question_id": 51975990, "link": "https://stackoverflow.com/questions/51975990/how-can-i-use-a-bmp-file-and-create-a-texture-in-unity-at-runtime/51977073#51977073", "title": "How can I use a .bmp file and create a Texture in Unity at runtime?", "body": "<p>The <a href=\"https://docs.unity3d.com/ScriptReference/ImageConversion.LoadImage.html\" rel=\"noreferrer\"><code>Texture2D.LoadImage</code></a> function is only used to load PNG/JPG image byte array into a <code>Texture</code>. It doesn't support <code>.bmp</code> so the red symbol which usually means corrupted or unknown image is expected.  </p>\n\n<p>To load <code>.bmp</code> image format in Unity, you have to read and understand the <code>.bmp</code> format specification then implement a method that converts its byte array into Unity's Texture. Luckily, this has already been done by another person. Grab the <em><code>BMPLoader</code></em> plugin <a href=\"https://pastebin.com/fykWMpuB\" rel=\"noreferrer\"><em>here</em></a>.</p>\n\n<p>To use it, include the <code>using B83.Image.BMP</code> namespace:</p>\n\n<pre><code>public static Texture2D LoadTexture(string filePath)\n{\n    Texture2D tex = null;\n    byte[] fileData;\n\n    if (File.Exists(filePath))\n    {\n        fileData = File.ReadAllBytes(filePath);\n\n        BMPLoader bmpLoader = new BMPLoader();\n        //bmpLoader.ForceAlphaReadWhenPossible = true; //Uncomment to read alpha too\n\n        //Load the BMP data\n        BMPImage bmpImg = bmpLoader.LoadBMP(fileData);\n\n        //Convert the Color32 array into a Texture2D\n        tex = bmpImg.ToTexture2D();\n    }\n    return tex;\n}\n</code></pre>\n\n<p>You can also skip the <code>File.ReadAllBytes(filePath);</code> part and pass the <code>.bmp</code> image path directly to the <code>BMPLoader.LoadBMP</code> function:</p>\n\n<pre><code>public static Texture2D LoadTexture(string filePath)\n{\n    Texture2D tex = null;\n\n    if (File.Exists(filePath))\n    {\n        BMPLoader bmpLoader = new BMPLoader();\n        //bmpLoader.ForceAlphaReadWhenPossible = true; //Uncomment to read alpha too\n\n        //Load the BMP data\n        BMPImage bmpImg = bmpLoader.LoadBMP(filePath);\n\n        //Convert the Color32 array into a Texture2D\n        tex = bmpImg.ToTexture2D();\n    }\n    return tex;\n}\n</code></pre>\n"}], "owner": {"reputation": 904, "user_id": 7102009, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh6.googleusercontent.com/-E7w9qXEZq10/AAAAAAAAAAI/AAAAAAAAAJw/-sA4BTZUh1Q/photo.jpg?sz=128", "display_name": "Eduardo Corona", "link": "https://stackoverflow.com/users/7102009/eduardo-corona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2330, "favorite_count": 0, "accepted_answer_id": 51977073, "answer_count": 1, "score": 3, "last_activity_date": 1534987202, "creation_date": 1534976777, "last_edit_date": 1534984756, "question_id": 51975990, "link": "https://stackoverflow.com/questions/51975990/how-can-i-use-a-bmp-file-and-create-a-texture-in-unity-at-runtime", "title": "How can I use a .bmp file and create a Texture in Unity at runtime?", "body": "<p>I'm working in a Unity Project where the user choose image files (in <code>.bmp</code> format) that is used to make a <code>Texture2D</code> and pasted to a model, I create the next code, I work fine with <code>.png</code> and <code>.jpg</code> file, but when I try load <code>.bmp</code> I got only a (I assume) default texture with a red \"?\" symbol, so I think is for the image format, how can I create a Texture using <code>.bmp</code> files at run-time?</p>\n\n<p>this is my code:</p>\n\n<pre><code>public static Texture2D LoadTexture(string filePath)\n{\n    Texture2D tex = null;\n    byte[] fileData;\n\n    if (File.Exists(filePath))\n    {\n        fileData = File.ReadAllBytes(filePath);\n        tex = new Texture2D(2, 2);\n        tex.LoadImage(fileData);\n    }\n\n    return tex;\n}\n</code></pre>\n"}, {"tags": ["javascript", "c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 21842, "user_id": 6378815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810b57a09174a18f7b91655115ce11a5?s=128&d=identicon&r=PG&f=1", "display_name": "Tetsuya Yamamoto", "link": "https://stackoverflow.com/users/6378815/tetsuya-yamamoto"}, "edited": false, "score": 0, "creation_date": 1534991200, "post_id": 51975983, "comment_id": 90905068, "body": "I found that you have query string like <code>_=1534975761119</code> instead of <code>Facturas&#47;Save&#47;4176</code>. Can you put <code>console.log</code> inside <code>function(data)</code> of <code>Save</code> anchor link to see what <code>id_Proveedor</code> contains?"}, {"owner": {"reputation": 935, "user_id": 8012407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iT4aC.jpg?s=128&g=1", "display_name": "Hieu Le", "link": "https://stackoverflow.com/users/8012407/hieu-le"}, "edited": false, "score": 0, "creation_date": 1534991502, "post_id": 51975983, "comment_id": 90905134, "body": "your action is GET, but I didn&#39;t see where you call it from javascript side"}, {"owner": {"reputation": 1605, "user_id": 1689226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd71f9f43c5a587ef304196c5e667c3e?s=128&d=identicon&r=PG", "display_name": "Subbu", "link": "https://stackoverflow.com/users/1689226/subbu"}, "edited": false, "score": 0, "creation_date": 1534992978, "post_id": 51975983, "comment_id": 90905367, "body": "<code>500 internal server error</code> essentially means that the server side code is failing. See whether you can add some logging to your server side code to see the exact exception."}, {"owner": {"reputation": 13, "user_id": 10261997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ae044e0f992687d6d02a894845d043?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Morquecho", "link": "https://stackoverflow.com/users/10261997/rodrigo-morquecho"}, "edited": false, "score": 0, "creation_date": 1535036609, "post_id": 51975983, "comment_id": 90927215, "body": "I found the error, my model was wrong, I just changed and referred my model well and everything was corrected ...... Thanks to all"}], "owner": {"reputation": 13, "user_id": 10261997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ae044e0f992687d6d02a894845d043?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo Morquecho", "link": "https://stackoverflow.com/users/10261997/rodrigo-morquecho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534981479, "creation_date": 1534976722, "last_edit_date": 1534981479, "question_id": 51975983, "link": "https://stackoverflow.com/questions/51975983/error-showing-view-in-popup-mvc", "title": "Error showing view in popup MVC", "body": "<p>I have a view and tried to show it directly in a popup by clicking from a webgrid... I get the following error:</p>\n\n<blockquote>\n  <p>jquery-3.2.1.min.js:4 GET <a href=\"http://localhost:54751/Facturas/Save/4176?_=1534975761119\" rel=\"nofollow noreferrer\">http://localhost:54751/Facturas/Save/4176?_=1534975761119</a> 500 (Internal Server Error)</p>\n</blockquote>\n\n<p>My JS code:</p>\n\n<pre><code>&lt;script&gt;\n    $(document).ready(function () {\n        var oTable = $('#myDatatable').DataTable({\n            \"ajax\": {\n                \"url\" : '/Facturas/GetEmployees',\n                \"type\" : \"get\",\n                \"datatype\" : \"json\"\n            },\n            \"columns\": [\n                { \"data\": \"id_docto\", \"autoWidth\": true },\n                { \"data\": \"id_Proveedor\", \"autoWidth\" : true},\n                { \"data\": \"Nombre_Archivo\", \"autoWidth\": true },\n                { \"data\": \"Ruta_Docto\", \"autoWidth\": true },\n                { \"data\": \"id_tipo_docto\", \"autoWidth\": true },\n                { \"data\": \"Estatus\", \"autoWidth\": true },\n                { \"data\": \"Fecha\", \"autoWidth\": true },\n                {\n                    \"data\": \"id_Proveedor\", \"width\": \"50px\", \"render\": function (data) {\n                        return '&lt;a class=\"popup\" href=\"/Facturas/Save/' + data + '\"&gt;Editar&lt;/a&gt;';\n                    }\n                },\n                {\n                    \"data\": \"EmployeeID\", \"width\": \"50px\", \"render\": function (data) {\n                        return '&lt;a class=\"popup\" href=\"/Facturas/Delete' + data + '\"&gt;Borrar&lt;/a&gt;';\n                    }\n                }\n            ]\n        })\n        $('.tablecontainer').on('click', 'a.popup', function (e) {\n            e.preventDefault();\n            OpenPopup($(this).attr('href'));\n        })\n        function OpenPopup(pageUrl) {\n            debugger;\n            var $pageContent = $('&lt;div/&gt;');\n            $pageContent.load(pageUrl, function () {\n                $('#popupForm', $pageContent).removeData('validator');\n                $('#popupForm', $pageContent).removeData('unobtrusiveValidation');\n                $.validator.unobtrusive.parse('form');\n\n            });\n\n            $dialog = $('&lt;div class=\"popupWindow\" style=\"overflow:auto\"&gt;&lt;/div&gt;')\n                      .html($pageContent)\n                      .dialog({\n                          draggable : false,\n                          autoOpen : false,\n                          resizable : false,\n                          model : true,\n                          title:'Actualizaci\u00f3n de Datos',\n                          height : 550,\n                          width : 600,\n                          close: function () {\n                              $dialog.dialog('destroy').remove();\n                          }\n                      })\n            debugger;\n            $('.popupWindow').on('submit', '#popupForm', function (e) {\n                var url = $('#popupForm')[0].action;\n                $.ajax({\n                    type : \"POST\",\n                    url : url,\n                    data: $('#popupForm').serialize(),\n                    success: function (data) {\n                        if (data.status) {\n                            $dialog.dialog('close');\n                            oTable.ajax.reload();\n                        }\n                    }\n                })\n\n                e.preventDefault();\n            })\n            $dialog.dialog('open');\n        }\n    })\n&lt;/script&gt;\n</code></pre>\n\n<p>My C# code:</p>\n\n<pre><code>[HttpGet]\npublic ActionResult Save(int id)\n{\n    try\n    {\n        using (SiniestrosEntities dc = new SiniestrosEntities())\n        {\n            var v = dc.CAT_Doctos_Proveedores.Where(a =&gt; a.id_Proveedor == id).FirstOrDefault();\n            return View(v);\n        }\n    }\n    catch (Exception e)\n    {\n        return View(\"Login\");\n    }            \n }\n</code></pre>\n\n<p>Does anyone have an idea why it does not return my view \"Save\" to my Popup?</p>\n"}, {"tags": ["c#", "actions-on-google"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10210249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a22712ca70ec0f9a66e5c6367cf6c410?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/10210249/steven"}, "is_accepted": false, "score": 0, "last_activity_date": 1535144779, "creation_date": 1535144779, "answer_id": 52011733, "question_id": 51975800, "link": "https://stackoverflow.com/questions/51975800/linking-accounts-with-google-assistant-returns-bad-response-from-idp-in-auth-co/52011733#52011733", "title": "Linking accounts with google assistant returns &quot;Bad response from IdP in Auth Code Exchange&quot;", "body": "<p>Turns out this code had no issues. The reason for the \u201cBad response from IdP in Auth Code Exchange\u201d response was due to the fact that Google's handler was unable to look up the DNS for my Token exchange API.</p>\n"}], "owner": {"reputation": 11, "user_id": 10210249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a22712ca70ec0f9a66e5c6367cf6c410?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/10210249/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535144779, "creation_date": 1534975576, "question_id": 51975800, "link": "https://stackoverflow.com/questions/51975800/linking-accounts-with-google-assistant-returns-bad-response-from-idp-in-auth-co", "title": "Linking accounts with google assistant returns &quot;Bad response from IdP in Auth Code Exchange&quot;", "body": "<p>Trying to link a demo account to my google assistant service keeps throwing me \"Bad response from IdP in Auth Code Exchange\" when I redirect to the redirect url specified by google. I'm using MVC with C# on my side.</p>\n\n<p>My flow follows the code here</p>\n\n<pre><code>public ActionResult Authorize(OAuthRequest request)\n{\n\n    ViewBag.Message = \"Authorize Google to access your account?\";\n    User user = GetUserData();\n\n    ViewBag.User = !string.IsNullOrEmpty(user?.UserName) ? user.UserName : null;\n    Session[\"OAuth\"] = request;\n    return View();\n}\n\npublic ActionResult LinkAccount(bool confirmation)\n{\n    if (Session[\"OAuth\"] == null || !ValidateGoogleRequest((OAuthRequest)Session[\"OAuth\"]))\n    {\n        return RedirectToAction(\"Index\", \"Home\");\n    }\n\n    if (!confirmation)\n    {\n        return RedirectToAction(\"Index\", \"Home\");\n    }\n    else\n    {\n        OAuthRequest request = (OAuthRequest)Session[\"OAuth\"];\n\n        User user = GetUserData();\n\n        string accessCode = Token.CreateAccessCode(user.UserName);\n        string url = $\"{request.Redirect_URI}?code={accessCode}&amp;state={request.State}\";\n\n        return Redirect(url);\n    }\n}\n</code></pre>\n\n<p>The OAuthRequest is just an object that stores all the parameters google passes.</p>\n\n<pre><code>public class OAuthRequest\n{\n    public string Client_ID { get; set; }\n    public string Redirect_URI { get; set; }\n    public string State { get; set; }\n    public string Scope { get; set; }\n    public string Response_Type { get; set; }\n}\n</code></pre>\n\n<p>I am using https on localhost for testing.</p>\n"}, {"tags": ["c#", "unity3d", "ip", "ip-address"], "comments": [{"owner": {"reputation": 51, "user_id": 6743645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bc43850a4926a9cce9e9c9b5d2de8c?s=128&d=identicon&r=PG&f=1", "display_name": "Orkan", "link": "https://stackoverflow.com/users/6743645/orkan"}, "reply_to_user": {"reputation": 6430, "user_id": 6858891, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/z4vFM.png?s=128&g=1", "display_name": "Hellium", "link": "https://stackoverflow.com/users/6858891/hellium"}, "edited": false, "score": 0, "creation_date": 1534977680, "post_id": 51975799, "comment_id": 90902559, "body": "I searched it. But no new information about it on Stack. There is only discussions about old way of getting ip, which is depricated right now."}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539194886, "post_id": 51975799, "comment_id": 92417258, "body": "ALERT - it does seem to be the case that you can now (late 2018?) simply call <b>nc.address</b>."}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539201159, "post_id": 51975799, "comment_id": 92420109, "body": "LATER - this is <b><i>FINALLY RESOLVED</i></b> in the latest Unity.  See long second answer."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6743645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bc43850a4926a9cce9e9c9b5d2de8c?s=128&d=identicon&r=PG&f=1", "display_name": "Orkan", "link": "https://stackoverflow.com/users/6743645/orkan"}, "edited": false, "score": 0, "creation_date": 1535026253, "post_id": 51977237, "comment_id": 90920348, "body": "How should I initialize NetworkManager? It gives me NullReferenceException. Was trying  NetworkManager networkManager = NetworkManager.singleton; NetworkManager networkManager = new NetworkManager(); But there is new errors, exceptions dropping with this lines."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 51, "user_id": 6743645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bc43850a4926a9cce9e9c9b5d2de8c?s=128&d=identicon&r=PG&f=1", "display_name": "Orkan", "link": "https://stackoverflow.com/users/6743645/orkan"}, "edited": false, "score": 0, "creation_date": 1535033474, "post_id": 51977237, "comment_id": 90925131, "body": "You attach <code>NetworkManager</code> to a GameObject. If you haven&#39;t already attached <code>NetworkManager</code> to a GameObject then you are not using uNet and should use the second method in my answer."}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539194891, "post_id": 51977237, "comment_id": 92417260, "body": "ALERT - it does seem to be the case that you can now (late 2018?) simply call <b>nc.address</b>."}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539195845, "post_id": 51977237, "comment_id": 92417693, "body": ".. although only on the Server; you can&#39;t seem to get your &quot;own&quot; on a Client."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539197089, "post_id": 51977237, "comment_id": 92418259, "body": "@Fattie Hi, it was added in 2017.1 and that was even before my answer. The problem with using this is that is that you need to implement those functions you used to get that. You can&#39;t  just directly access the ip address directly without those callback functions. That&#39;s the only issue I find with this."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1539198434, "post_id": 51977237, "comment_id": 92418876, "body": "Which one. There  are two examples. The <code>NetworkManager.singleton.networkAddress</code> or <code>GetIpv4</code> function? Sorry, but also, what do you mean by &quot;type&quot;"}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539199569, "post_id": 51977237, "comment_id": 92419415, "body": "OK, your excellent class <code>IPManager</code> does not work on a Mac sadly.  (The reason it does not work is, <code>.NetworkInterfaceType</code> is f&#39;ed up on a Mac, try spitting them out.  Your code in <code>IPManager</code> involving your variable <code>_type</code> doesn&#39;t work on Mac.)"}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539200334, "post_id": 51977237, "comment_id": 92419744, "body": "@Programmer - ah, of course !  You can now actually use the weird <code>.connectionToClient</code> property and directly get it, ie on the server.  (Whenever a &quot;command&quot; arrives from that client in question.)  I will put in an answer."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1539201829, "post_id": 51977237, "comment_id": 92420407, "body": "Just saw it and it looks grate. I think Unity update caused the issue in my code. Don&#39;t know which one but will update the code to something I currently use just in-case anyone want&#39;s to get IP without uNet"}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539203830, "post_id": 51977237, "comment_id": 92421298, "body": "@Programmer I wonder how you have Unity remove the lame ::ffff:192.168.0.120  &quot;::ffff:&quot;  so annoying!  : O"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1539204778, "post_id": 51977237, "comment_id": 92421685, "body": "Currently on my crappy computer because my Unity computer got liquid damage on the motherboard and can&#39;t do most things in Unity on it for days but taking a guess, it looks like Unity is mixing IPv6 with IPV4."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539204926, "post_id": 51977237, "comment_id": 92421758, "body": "@Fattie From my code you said it&#39;s not working, what happens when you replace <code>if (item.NetworkInterfaceType == _type &amp;&amp; item.OperationalStatus == OperationalStatus.Up)</code> <b>with</b> <code>if ((item.NetworkInterfaceType == NetworkInterfaceType.Wireless80211 || item.NetworkInterfaceType == NetworkInterfaceType.Ethernet) &amp;&amp; item.OperationalStatus == OperationalStatus.Up)</code>? If that doesn&#39;t fix your issue, can you log the  <code>Debug.Log(item.NetworkInterfaceType)</code> and tell me the value?"}, {"owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "edited": false, "score": 0, "creation_date": 1539259162, "post_id": 51977237, "comment_id": 92442103, "body": "it just spewed 20 of the same pointless text description (I think it was &quot;interface&quot;) - you know, unfortunately I worked onwards with the code and it&#39;s gone now!  If I get a minute I&#39;ll rewind and put the info here ......... apple idiots"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1539262653, "post_id": 51977237, "comment_id": 92444274, "body": "There is a bug with the <code>NetworkInterface.NetworkInterfaceType</code> property and I have verified this not on MacOS but on Android. That&#39;s why there is different function for mobile devices in my original answer. I have modified the answer to only allow the use of the <code>NetworkInterface.NetworkInterfaceType</code> property <b>only</b> on Windows since that&#39;s the only platform it works on so far. If what you&#39;re using from your answer is working for you fine then go with it, if it&#39;s not use the updated code in my answer. I also added IPv6 support especially since that&#39;s now required on iOS and Mac."}, {"owner": {"reputation": 2856, "user_id": 230851, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85bfabc247b68f8f12f2449386f7e92d?s=128&d=identicon&r=PG", "display_name": "orion elenzil", "link": "https://stackoverflow.com/users/230851/orion-elenzil"}, "edited": false, "score": 0, "creation_date": 1548441410, "post_id": 51977237, "comment_id": 95556378, "body": "@Programmer re the bug with NetworkInterfaceType, can you be specific ? I&#39;m seeing that field reliably return &quot;Ethernet&quot; for &quot;en*&quot; interfaces on MacOS (10.13) and iOS (12.1). I haven&#39;t had a chance to test Android yet tho. I do see that &quot;OperationalStatus&quot; is &quot;Unknown&quot; on MacOS and iOS tho.  So modifying your code a bit to include the checks on Type but not the check on OperationalStatus works well for me. I&#39;ll post the result as a new answer"}], "tags": [], "owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "is_accepted": true, "score": 12, "last_activity_date": 1539262780, "last_edit_date": 1539262780, "creation_date": 1534988531, "answer_id": 51977237, "question_id": 51975799, "link": "https://stackoverflow.com/questions/51975799/how-to-get-ip-address-of-device-in-unity-2018/51977237#51977237", "title": "How to get IP address of device in Unity 2018+?", "body": "<p>The <code>Network.player.ipAddress</code> has been deprecated since it is based on the old obsolete Unity networking system.</p>\n\n<p>If you are using Unity's new uNet Network System, you can use <a href=\"https://docs.unity3d.com/ScriptReference/Networking.NetworkManager-networkAddress.html\" rel=\"noreferrer\"><code>NetworkManager.networkAddress</code></a>;</p>\n\n<pre><code>string IP = NetworkManager.singleton.networkAddress;\n</code></pre>\n\n<hr>\n\n<p>If you are using raw networking protocol and APIs like TCP/UDP, you have to use the <code>NetworkInterface</code> API to find the IP Address. I use <code>IPManager</code> which has been working for me on both desktop and mobile devices:</p>\n\n<p><strong>IPv4</strong>:</p>\n\n<pre><code>string ipv4 = IPManager.GetIP(ADDRESSFAM.IPv4);\n</code></pre>\n\n<p><strong>IPv6</strong>:</p>\n\n<pre><code>string ipv6 = IPManager.GetIP(ADDRESSFAM.IPv6);\n</code></pre>\n\n<p>The <code>IPManager</code> class:</p>\n\n<pre><code>using System.Net;\nusing System.Net.NetworkInformation;\nusing System.Net.Sockets;\n\npublic class IPManager\n{\n    public static string GetIP(ADDRESSFAM Addfam)\n    {\n        //Return null if ADDRESSFAM is Ipv6 but Os does not support it\n        if (Addfam == ADDRESSFAM.IPv6 &amp;&amp; !Socket.OSSupportsIPv6)\n        {\n            return null;\n        }\n\n        string output = \"\";\n\n        foreach (NetworkInterface item in NetworkInterface.GetAllNetworkInterfaces())\n        {\n#if UNITY_EDITOR_WIN || UNITY_STANDALONE_WIN\n            NetworkInterfaceType _type1 = NetworkInterfaceType.Wireless80211;\n            NetworkInterfaceType _type2 = NetworkInterfaceType.Ethernet;\n\n            if ((item.NetworkInterfaceType == _type1 || item.NetworkInterfaceType == _type2) &amp;&amp; item.OperationalStatus == OperationalStatus.Up)\n#endif \n            {\n                foreach (UnicastIPAddressInformation ip in item.GetIPProperties().UnicastAddresses)\n                {\n                    //IPv4\n                    if (Addfam == ADDRESSFAM.IPv4)\n                    {\n                        if (ip.Address.AddressFamily == AddressFamily.InterNetwork)\n                        {\n                            output = ip.Address.ToString();\n                        }\n                    }\n\n                    //IPv6\n                    else if (Addfam == ADDRESSFAM.IPv6)\n                    {\n                        if (ip.Address.AddressFamily == AddressFamily.InterNetworkV6)\n                        {\n                            output = ip.Address.ToString();\n                        }\n                    }\n                }\n            }\n        }\n        return output;\n    }\n}\n\npublic enum ADDRESSFAM\n{\n    IPv4, IPv6\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "is_accepted": false, "score": 0, "last_activity_date": 1539427968, "last_edit_date": 1539427968, "creation_date": 1539195251, "answer_id": 52746431, "question_id": 51975799, "link": "https://stackoverflow.com/questions/51975799/how-to-get-ip-address-of-device-in-unity-2018/52746431#52746431", "title": "How to get IP address of device in Unity 2018+?", "body": "<p>For 2018...</p>\n\n<h1>However, SEE THE NEWER ANSWER BELOW.</h1>\n\n<p>It does seem to be the case that you can now call - <strong>on the server, in NetworkManager</strong> - simply <code>NetworkConnection#address</code> and it will give it to you.</p>\n\n<p>Recall that you <em>must</em> write your own NetworkManager, it does not work out of the box. Explained here if yer new to unity networking:</p>\n\n<p><a href=\"https://forum.unity.com/threads/networkmanager-error-server-client-disconnect-error-1.439245/#post-3754939\" rel=\"nofollow noreferrer\">https://forum.unity.com/threads/networkmanager-error-server-client-disconnect-error-1.439245/#post-3754939</a></p>\n\n<pre><code>public class OurNetworkManager : NetworkManager {\n\n    //\n    // server .............\n    //\n\n    public override void OnServerConnect(NetworkConnection nc) {\n\n        // it means \"here on the server\" one of the clients has connected\n        base.OnServerConnect(nc);\n\n        Log(\"a client connected \" + nc.connectionId + \" \" + nc.hostId);\n        Log(\"address? \" + nc.address);\n    }\n\n    public override void OnServerDisconnect(NetworkConnection nc) { .. etc\n</code></pre>\n\n<p>. </p>\n\n<h1>However note that</h1>\n\n<p>1) this only gives it to you <em>on the server</em>,</p>\n\n<p>2) and only at \"NetworkManager\" which (of course!) is <strong><em>not actually when you identify each connecting client</em></strong></p>\n\n<p>Note the even newer answer - Unity finally resolved this.</p>\n"}, {"tags": [], "owner": {"reputation": 29735, "user_id": 294884, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f8675693dfeb3908195657eb3a3fdda4?s=128&d=identicon&r=PG", "display_name": "Fattie", "link": "https://stackoverflow.com/users/294884/fattie"}, "is_accepted": false, "score": 1, "last_activity_date": 1539427530, "last_edit_date": 1592644375, "creation_date": 1539201133, "answer_id": 52747787, "question_id": 51975799, "link": "https://stackoverflow.com/questions/51975799/how-to-get-ip-address-of-device-in-unity-2018/52747787#52747787", "title": "How to get IP address of device in Unity 2018+?", "body": "<h1>FINALLY resolved by Unity (from about version 2018.2)</h1>\n<p>Inside any <code>[Command]</code> arriving on the server,</p>\n<p>the IP of the client, which, sent the <code>[Command]</code> is</p>\n<pre><code>        connectionToClient.address\n</code></pre>\n<p>Phew.</p>\n<hr />\n<p>You will in fact have your own <code>NetworkBehaviour</code> derived class, you must do this. (It is very often called &quot;Comms&quot;):</p>\n<pre><code>public partial class Comms : NetworkBehaviour {\n</code></pre>\n<p>That class must override both the server/client startoffs, so that each Comms &quot;knows what it is&quot;.</p>\n<pre><code>public override void OnStartServer() {\n    .. this &quot;Comms&quot; does know it IS the server ..\n}\n\npublic override void OnStartLocalPlayer() {\n    .. this &quot;Comms&quot; does know it IS one of the clients ..\n}\n</code></pre>\n<p>On any actual project, since Unity doesn't do it, the clients must identify themselves to the server. You have to entirely handle that in Unity networking, from scratch.</p>\n<p>(Note. that process is explained in the long blog here</p>\n<p><a href=\"https://forum.unity.com/threads/networkmanager-error-server-client-disconnect-error-1.439245/#post-3754939\" rel=\"nofollow noreferrer\">https://forum.unity.com/threads/networkmanager-error-server-client-disconnect-error-1.439245/#post-3754939</a>  )</p>\n<p>So this would be the first thing you (must) do in <code>OnStartLocalPlayer</code></p>\n<pre><code>public override void OnStartLocalPlayer() {\n    \n    Grid.commsLocalPlayer = this;\n\n    StandardCodeYouMustHave_IdentifySelfToServer();\n    \n    // hundreds of other things to do..\n    // hundreds of other things to do..\n}\n</code></pre>\n<p>That &quot;command pair&quot; inside comms would look like this:</p>\n<p>You must do this in all networking projects (or you will have no clue which client is which):</p>\n<pre><code>public void StandardCodeYouMustHave_IdentifySelfToServer() {\n    \n    string identityString = &quot;quarterback&quot; &quot;linebacker&quot; &quot;johnny smith&quot;\n        .. or whatever this device is ..\n\n    CmdIdentifySelfToServer( identityString );\n\n    // hundreds more lines of your code\n    // hundreds more lines of your code\n}\n\n[Command]\nvoid CmdIdentifySelfToServer(string connectingClientIdString) {\n    \n    .. you now know this connection is a &quot;connectingClientIdString&quot;\n    .. and Unity gives you the connection: in the property: connectionToClient\n    .. you must record this in a hash, database, or whatever you like\n\n    MakeANote( connectingClientIdString , connectionToClient )\n\n    // hundreds more lines of your code\n    // hundreds more lines of your code\n}\n</code></pre>\n<p>The good news is Unity have added the <code>connectionToClient</code> property, that is to say on the server, inside a <code>[Command]</code>.</p>\n<p>And then, you can indeed use the new <code>.address</code> property on that.</p>\n<h1>YOU CAN FINALLY GET THE IP OF THAT CLIENT!</h1>\n<pre><code>public void StandardCodeYouMustHave_IdentifySelfToServer() {\n    CmdIdentifySelfToServer( identityString );\n}\n\n[Command]\nvoid CmdIdentifySelfToServer(string connectingClientIdString) {\n    MakeANote( connectingClientIdString , connectionToClient )\n    string THEDAMNEDIP = connectionToClient.address;\n}\n</code></pre>\n<p>It's that &quot;simple&quot;, the ip of the client, which just connected, is &quot;THEDAMNEDIP&quot;.</p>\n<p>Phew.</p>\n<p>Only took Unity 5? years.</p>\n"}, {"tags": [], "owner": {"reputation": 2856, "user_id": 230851, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85bfabc247b68f8f12f2449386f7e92d?s=128&d=identicon&r=PG", "display_name": "orion elenzil", "link": "https://stackoverflow.com/users/230851/orion-elenzil"}, "is_accepted": false, "score": 0, "last_activity_date": 1548442728, "creation_date": 1548442728, "answer_id": 54371349, "question_id": 51975799, "link": "https://stackoverflow.com/questions/51975799/how-to-get-ip-address-of-device-in-unity-2018/54371349#54371349", "title": "How to get IP address of device in Unity 2018+?", "body": "<p>this is a minor modification to the <a href=\"https://stackoverflow.com/a/51977237/230851\">excellent answer already provided by @Programmer</a>.  the motivation here is to improve functionality on MacOS and iOS.  i haven't looked at android yet. i've also only tested IPV4.</p>\n\n<p>what's different from @Programmer's original:</p>\n\n<ol>\n<li>for MacOS and iOS, include the filter on Interface Type</li>\n<li>.. but exclude the check on OperationalStatus</li>\n<li>move the enum into the class</li>\n<li>mark the class as static</li>\n<li>refactor so there's one method which returns all the matching IPs,<br>\nand another to simply return the last one, which matches the logic of the original version.</li>\n<li>also included a diagnostic option for the list of IPs to include some details such as the \"Description\" of the interface (eg <code>en0</code>, <code>en1</code>). This option should obviously not be used if all you want is the IP address itself.</li>\n</ol>\n\n<pre><code>public static class IPManager\n{\n    public enum ADDRESSFAM\n    {\n        IPv4, IPv6\n    }\n\n    public static string GetIP(ADDRESSFAM Addfam)\n    {\n      string ret = \"\";\n      List&lt;string&gt; IPs = GetAllIPs(Addfam, false);\n      if (IPs.Count &gt; 0) {\n        ret = IPs[IPs.Count - 1];\n      }\n      return ret;\n    }\n\n    public static List&lt;string&gt; GetAllIPs(ADDRESSFAM Addfam, bool includeDetails)\n    {\n        //Return null if ADDRESSFAM is Ipv6 but Os does not support it\n        if (Addfam == ADDRESSFAM.IPv6 &amp;&amp; !Socket.OSSupportsIPv6)\n        {\n            return null;\n        }\n\n        List&lt;string&gt; output = new List&lt;string&gt;();\n\n        foreach (NetworkInterface item in NetworkInterface.GetAllNetworkInterfaces())\n        {\n\n#if UNITY_EDITOR_WIN || UNITY_STANDALONE_WIN || UNITY_EDITOR_OSX || UNITY_STANDALONE_OSX || UNITY_IOS\n            NetworkInterfaceType _type1 = NetworkInterfaceType.Wireless80211;\n            NetworkInterfaceType _type2 = NetworkInterfaceType.Ethernet;\n\n            bool isCandidate = (item.NetworkInterfaceType == _type1 || item.NetworkInterfaceType == _type2);\n\n#if UNITY_EDITOR_WIN || UNITY_STANDALONE_WIN\n            // as of MacOS (10.13) and iOS (12.1), OperationalStatus seems to be always \"Unknown\".\n            isCandidate = isCandidate &amp;&amp; item.OperationalStatus == OperationalStatus.Up;\n#endif\n\n            if (isCandidate)\n#endif \n            {\n                foreach (UnicastIPAddressInformation ip in item.GetIPProperties().UnicastAddresses)\n                {\n                    //IPv4\n                    if (Addfam == ADDRESSFAM.IPv4)\n                    {\n                        if (ip.Address.AddressFamily == AddressFamily.InterNetwork)\n                        {\n                            string s = ip.Address.ToString();\n                            if (includeDetails) {\n                                s += \"  \" + item.Description.PadLeft(6) + item.NetworkInterfaceType.ToString().PadLeft(10);\n                            }\n                            output.Add(s);\n                        }\n                    }\n\n                    //IPv6\n                    else if (Addfam == ADDRESSFAM.IPv6)\n                    {\n                        if (ip.Address.AddressFamily == AddressFamily.InterNetworkV6)\n                        {\n                            output.Add(ip.Address.ToString());\n                        }\n                    }\n                }\n            }\n        }\n        return output;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12193306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBLdnYqlL3XFXwUmp4Pb6WxopWni8bUSzDujCwg1Q=k-s128", "display_name": "Gurunathan L", "link": "https://stackoverflow.com/users/12193306/gurunathan-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1570690734, "creation_date": 1570690734, "answer_id": 58317160, "question_id": 51975799, "link": "https://stackoverflow.com/questions/51975799/how-to-get-ip-address-of-device-in-unity-2018/58317160#58317160", "title": "How to get IP address of device in Unity 2018+?", "body": "<pre><code>using UnityEngine;\nusing System.Collections;\nusing UnityEngine.UI;\nusing System.Net;\nusing System.Net.NetworkInformation;\nusing System.Net.Sockets;\n\npublic class TestLocationService : MonoBehaviour\n{\n    public Text hintText;\n\n    private void Start()\n    {\n        GetLocalIPAddress();\n    }\n    public string GetLocalIPAddress()\n    {\n        var host = Dns.GetHostEntry(Dns.GetHostName());\n        foreach (var ip in host.AddressList)\n        {\n            if (ip.AddressFamily == AddressFamily.InterNetwork)\n            {\n                hintText.text = ip.ToString();\n                return ip.ToString();\n            }\n        }\n        throw new System.Exception(\"No network adapters with an IPv4 address in the system!\");\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6743645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7bc43850a4926a9cce9e9c9b5d2de8c?s=128&d=identicon&r=PG&f=1", "display_name": "Orkan", "link": "https://stackoverflow.com/users/6743645/orkan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27502, "favorite_count": 1, "accepted_answer_id": 51977237, "answer_count": 5, "score": 0, "last_activity_date": 1570690734, "creation_date": 1534975576, "last_edit_date": 1534987409, "question_id": 51975799, "link": "https://stackoverflow.com/questions/51975799/how-to-get-ip-address-of-device-in-unity-2018", "title": "How to get IP address of device in Unity 2018+?", "body": "<p>How to get IP address on C# in program which developing for android device in Unity 2018.2+?</p>\n\n<p>Seems like <code>Network.player.ipAddress</code> is deprecated right now, so I'm looking for a new way.</p>\n"}, {"tags": ["c#", "asp.net", ".net", "asp.net-mvc", "actionresult"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1534975131, "post_id": 51975679, "comment_id": 90901888, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 2, "creation_date": 1534975480, "post_id": 51975679, "comment_id": 90901997, "body": "@CamiloTerevinto I think you might mean: <code>bool isEuropeanUnion = EUCountries.Any(eu =&gt; eu.Name == model.CountryOfResidence);</code> since <code>SingleOrDefault</code> doesn&#39;t return a <code>bool</code>"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1534975575, "post_id": 51975679, "comment_id": 90902025, "body": "@RufusL Yes, I meant exactly that (but on <code>dbContext.EuropeanUnionContries</code>), thanks"}, {"owner": {"reputation": 1008, "user_id": 8604465, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5f4ff41ec61421ef2f45bee26d922ccc?s=128&d=identicon&r=PG&f=1", "display_name": "J.G.Sable", "link": "https://stackoverflow.com/users/8604465/j-g-sable"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1534975772, "post_id": 51975679, "comment_id": 90902072, "body": "@RufusL that worked perfectly."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 1, "creation_date": 1534978545, "post_id": 51975679, "comment_id": 90902753, "body": "No problem, it&#39;s just a shortcut for what you have. To fix your existing code, you&#39;d just need to replace <code>return;</code> (which exits the method) with <code>break;</code> (which exits the loop)"}], "answers": [{"tags": [], "owner": {"reputation": 2355, "user_id": 9918730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Sqil.jpg?s=128&g=1", "display_name": "GoldenAge", "link": "https://stackoverflow.com/users/9918730/goldenage"}, "is_accepted": false, "score": 1, "last_activity_date": 1534975410, "creation_date": 1534975410, "answer_id": 51975773, "question_id": 51975679, "link": "https://stackoverflow.com/questions/51975679/an-object-of-a-type-convertible-to-actionresult-is-required/51975773#51975773", "title": "An Object of a type convertible to &#39;ActionResult&#39; is required", "body": "<p>I can only guess that you are trying to invoke your code inside the action which returns <code>IActionResult</code> so in such case you cannot use <code>return;</code>, you must return an object which inherits from the IActionResult.\nI would try to do something like this instead:</p>\n\n<pre><code>var flag = false;\nforeach (var country in EUCountries)\n{\n    if (model.CountryOfResidence == country.Name)\n    {\n        // if you don't use isEuropeanUnion inside the foreach loop\n        // the code makes no sense \n        isEuropeanUnion = true;\n        flag = true;\n        break;\n    }\n    else\n    {\n        isEuropeanUnion = false;\n    }\n}\n\nif (flag)\n{\n    // do something\n}\n</code></pre>\n"}], "owner": {"reputation": 1008, "user_id": 8604465, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5f4ff41ec61421ef2f45bee26d922ccc?s=128&d=identicon&r=PG&f=1", "display_name": "J.G.Sable", "link": "https://stackoverflow.com/users/8604465/j-g-sable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1535126181, "creation_date": 1534974734, "last_edit_date": 1535126181, "question_id": 51975679, "link": "https://stackoverflow.com/questions/51975679/an-object-of-a-type-convertible-to-actionresult-is-required", "title": "An Object of a type convertible to &#39;ActionResult&#39; is required", "body": "<p>I have a list of European union countries.</p>\n\n<p>When a user enters their country of residence on the registration form, I run a <code>foreach</code> block to check if the country they live in is in the EU. If it is, I assign <code>true</code> to a boolean I've declared of <code>isEuropeanUnion</code>. If not, I assign <code>isEuropeanUnion</code> to <code>false</code> and pass that onto my new user object to be saved in the db.</p>\n\n<p>However, because I'm not exiting out of the <code>foreach</code> block on a <code>true</code> hit, it's always returning <code>false</code>. When I try to add a <code>return</code> to the <code>foreach</code> block, I get the red squiggly saying </p>\n\n<blockquote>\n  <p>An Object of a type convertible to 'ActionResult' is required.</p>\n</blockquote>\n\n<pre><code>//check if the user resides in a EU country\nvar EUCountries = dbContext.EuropeanUnionCountries.ToList();\n\nforeach (var country in EUCountries)\n{\n    if (model.CountryOfResidence == country.Name)\n    {\n        isEuropeanUnion = true;\n        return;\n    } else\n    {\n        isEuropeanUnion = false;\n    }\n}\n\nvar user = new ApplicationUser {\n    UserName = model.Email,\n    Email = model.Email,\n    FirstName = model.FirstName,\n    LastName = model.LastName,\n    CreatedAt = DateTime.Now,\n    LastUpdated = DateTime.Now,\n    CountryOfResidence = model.CountryOfResidence,\n    IsEuropeanUnion = isEuropeanUnion\n};\n</code></pre>\n"}, {"tags": ["c#", "windows", "unity3d", "serial-port", "device"], "comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1534975042, "post_id": 51975659, "comment_id": 90901855, "body": "There should be a Windows C++ API to do this. You to write need a C++ plugin then use C# to communicate with it."}, {"owner": {"reputation": 743, "user_id": 10067555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23629f32bc51e9dff04aec6b8eb51123?s=128&d=identicon&r=PG&f=1", "display_name": "karamazovbros", "link": "https://stackoverflow.com/users/10067555/karamazovbros"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1534975356, "post_id": 51975659, "comment_id": 90901956, "body": "I&#39;m looking for a method in C# without using plugins, dlls. For instance, the manually com port loop that checks each one individually almost seems like a good alternative if there was a simpler way to check without creating a new SerialPort for every com for testing."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1534975798, "post_id": 51975659, "comment_id": 90902081, "body": "You&#39;re making accessing hardware on Windows look like a magic. You don&#39;t want to use <code>SerialPort</code>, you don&#39;t want to use <code>System.Management.dll</code> and you don&#39;t want want make your own plugin.  How else do expect to accomplish this? If you don&#39;t want to use standard .NET API then make your own with native API (C++). You can enumerate devices with C++ and return then in your Unity app and this is the appropriate way to go based on your comment."}, {"owner": {"reputation": 743, "user_id": 10067555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23629f32bc51e9dff04aec6b8eb51123?s=128&d=identicon&r=PG&f=1", "display_name": "karamazovbros", "link": "https://stackoverflow.com/users/10067555/karamazovbros"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1534976088, "post_id": 51975659, "comment_id": 90902169, "body": "If you provide a C++ answer, I can try that out (I haven&#39;t used C++ plugins in Unity before). I guess I thought that maybe there would be a similar method as the Mac/Linux way, like maybe the devices are temporarily stored in some windows folder somewhere on use."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1534983714, "post_id": 51975659, "comment_id": 90903681, "body": "See <a href=\"https://mariusbancila.ro/blog/2007/08/02/how-to-detect-available-com-ports/\" rel=\"nofollow noreferrer\">this</a>. It shows how to  do it in C++. Now, you have to convert that into a plugin. <a href=\"https://stackoverflow.com/a/50727287/3785314\">Here</a> one example of a C++ and C# plugin. For instruction on how to build a C++ plugin in Unity, see <a href=\"https://stackoverflow.com/questions/49793560/build-c-plugin-for-unity/49795660#49795660\">this</a> post."}, {"owner": {"reputation": 1864, "user_id": 4675770, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f03c96e787ca2330d89c2e3c6b8d2cb?s=128&d=identicon&r=PG", "display_name": "Jinjinov", "link": "https://stackoverflow.com/users/4675770/jinjinov"}, "edited": false, "score": 0, "creation_date": 1535554826, "post_id": 51975659, "comment_id": 91111201, "body": "to add any .net assembly to your unity project, you have to copy it to your <code>Assets&#47;Libraries</code> folder in your unity editor. then go to:   <code>edit &#47; project settings &#47; player &#47; other settings &#47; optimization &#47; api compatibility level</code>   and set it to: .NET 2.0"}], "owner": {"reputation": 743, "user_id": 10067555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23629f32bc51e9dff04aec6b8eb51123?s=128&d=identicon&r=PG&f=1", "display_name": "karamazovbros", "link": "https://stackoverflow.com/users/10067555/karamazovbros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 808, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534974616, "creation_date": 1534974616, "question_id": 51975659, "link": "https://stackoverflow.com/questions/51975659/how-to-look-for-available-devices-and-their-com-ports-on-windows-in-unity-withou", "title": "How to look for available devices and their COM ports on Windows in Unity without using System.Management?", "body": "<p>I've looked over several of these questions for Windows and C# in general. I see some answers, where ManagementObjectSearcher is used, but as far as I know Unity doesn't have System.Management.dll by default, which is okay, because I'd rather use another way if possible (I know you can manually add it, but I'd prefer to use a different method). </p>\n\n<p>This question below is similar to mine, but the answer uses System.Management and as a back-up tests every COM on the <code>SerialPort.GetPortNames()</code> list. I don't like that the back-up test needs to create new SerialPorts every time to test whether a device is connected or not. It just seems inefficient to check every COM port. This is the question and answer:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12813151/how-can-i-discover-if-a-device-is-connected-to-a-specific-serial-com-port\">How can I discover if a device is connected to a specific serial (COM) port?</a></p>\n\n<p>On Mac/Linux, it's fairly simple to look up a device in /dev/ folder, and find the proper device for both USB and bluetooth and get the proper port name to use when creating a new SerialPort:</p>\n\n<pre><code>string[] ttys = System.IO.Directory.GetFiles(\"/dev/\", \"tty.*\");\n// iterate over list looking for device by name for usb and bluetooth\n</code></pre>\n\n<p>Is there a similar method in Windows to get a list of current devices connected to a Windows machine and their COM ports, without using System.Management or checking every single COM individually for feedback?</p>\n\n<p>An ideal solution would be to lookup the devices on Windows without using System.Management.</p>\n"}, {"tags": ["c#", "json", "json.net"], "comments": [{"owner": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1535004133, "post_id": 51975646, "comment_id": 90908097, "body": "Use the type JRaw instead of string for JSON data."}, {"owner": {"reputation": 833, "user_id": 969431, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZTsGg.jpg?s=128&g=1", "display_name": "jlavallet", "link": "https://stackoverflow.com/users/969431/jlavallet"}, "reply_to_user": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "edited": false, "score": 0, "creation_date": 1535023601, "post_id": 51975646, "comment_id": 90918736, "body": "I can\u2019t do that. I am using this class as an entity in entity framework. I wouldn\u2019t mind having an attribute if there was one"}], "answers": [{"tags": [], "owner": {"reputation": 2355, "user_id": 7565574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c334fc330dcc40914af415c5f99aefa2?s=128&d=identicon&r=PG", "display_name": "ckuri", "link": "https://stackoverflow.com/users/7565574/ckuri"}, "is_accepted": true, "score": 2, "last_activity_date": 1535024133, "creation_date": 1535024133, "answer_id": 51984898, "question_id": 51975646, "link": "https://stackoverflow.com/questions/51975646/how-do-you-convert-encoded-json-string-properties-when-calling-jsonconvert-seria/51984898#51984898", "title": "How do you convert encoded JSON string properties when calling JsonConvert.SerializeObject?", "body": "<p>You can use a property-specific converter by putting the converter attribute above your JSON properties:</p>\n\n<pre><code>public class LogAction\n{\n  // other properties\n  [JsonConverter(typeof(RawJsonConverter))]\n  public string Request { get; set; }\n  [JsonConverter(typeof(RawJsonConverter))]\n  public string Response { get; set; }\n}\n</code></pre>\n\n<p>The converter would be the following and writes strings as is assuming them to already be JSON.</p>\n\n<pre><code>public class RawJsonConverter: JsonConverter\n{\n  public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)\n  {\n    return JObject.Load(reader).ToString();\n  }\n\n  public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)\n  {\n    writer.WriteRawValue((string)value);\n  }\n\n  public override bool CanConvert(Type objectType)\n  {\n    return objectType == typeof(string);\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 833, "user_id": 969431, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZTsGg.jpg?s=128&g=1", "display_name": "jlavallet", "link": "https://stackoverflow.com/users/969431/jlavallet"}, "is_accepted": false, "score": 0, "last_activity_date": 1535383900, "last_edit_date": 1535383900, "creation_date": 1535135005, "answer_id": 52009904, "question_id": 51975646, "link": "https://stackoverflow.com/questions/51975646/how-do-you-convert-encoded-json-string-properties-when-calling-jsonconvert-seria/52009904#52009904", "title": "How do you convert encoded JSON string properties when calling JsonConvert.SerializeObject?", "body": "<p>@ckuri set me on the right path so I marked his response as the answer, but I ultimately settled on a different implementation. </p>\n\n<p>Here's why I changed the implementation: </p>\n\n<ul>\n<li>The encoded string could be an object or it could be an array. </li>\n<li>I wanted a clear error message if the encoded string property could not\nbe parsed. </li>\n<li>I was seeing some buffer overrun issues using the JToken.Load(reader) call.</li>\n</ul>\n\n<p>I hope this will help someone else.</p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// The RawJsonConverter is used to convert an object's string-typed properties containing valid string-encoded\n    /// JavaScript Object Notation (JSON) into non-encoded strings so that they may be treated as JSON objects and\n    /// arrays instead of strings when their containing objects are serialized.\n    /// Note that the properties of the object must be decorated with the JsonConverterAttribute like this:\n    ///     [JsonConverter(typeof(RawJsonConverter))]\n    ///     public string EncodedJsonProperty { get; set; }\n    /// &lt;/summary&gt;\n    public class RawJsonConverter : JsonConverter\n    {\n        /// &lt;inheritdoc /&gt;\n        public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)\n        {\n            try\n            {\n                var value = serializer.Deserialize&lt;String&gt;(reader).Trim();\n                return JToken.Parse(value).ToString();\n            }\n            catch (Exception ex)\n            {\n                throw new Exception(\"Could not parse JSON from string in RawJsonConverter.\", ex);\n            }\n        }\n\n        /// &lt;inheritdoc /&gt;\n        public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)\n        {\n            writer.WriteRawValue((string)value);\n        }\n\n        /// &lt;inheritdoc /&gt;\n        public override bool CanConvert(Type objectType)\n        {\n            return objectType == typeof(string);\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 833, "user_id": 969431, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZTsGg.jpg?s=128&g=1", "display_name": "jlavallet", "link": "https://stackoverflow.com/users/969431/jlavallet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "accepted_answer_id": 51984898, "answer_count": 2, "score": 1, "last_activity_date": 1535383900, "creation_date": 1534974549, "question_id": 51975646, "link": "https://stackoverflow.com/questions/51975646/how-do-you-convert-encoded-json-string-properties-when-calling-jsonconvert-seria", "title": "How do you convert encoded JSON string properties when calling JsonConvert.SerializeObject?", "body": "<p>I have a POCO with some string properties that contain encoded JSON objects.</p>\n\n<p>When I call JsonConvert.SerializeObject, I would like to convert these strings back into JSON and have Json.NET serialize them as embedded JSON objects.</p>\n\n<p>How do you convert encoded JSON string properties when calling JsonConvert.SerializeObject?</p>\n\n<p>Here is the relevant code:</p>\n\n<pre><code>public class LogAction\n{\n    // other properties\n    public string Request { get; set; }\n    public string Response { get; set; }\n}\n</code></pre>\n\n<p>Here is a line of code that sets the Response property:</p>\n\n<pre><code>Response = actionExecutedContext.Response?.Content?.ReadAsStringAsync().Result\n</code></pre>\n\n<p>I include this line of code to demonstrate that the property is being set using a method \u2013 <code>ReadAsStringAsync</code> which returns an encoded JSON string. In my case it will always be an encoded JSON string or it will be null.</p>\n\n<p>Ideas?</p>\n"}, {"tags": ["c#", "enums", "enum-flags"], "answers": [{"comments": [{"owner": {"reputation": 1064, "user_id": 1221989, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f2b4b0a167c23b526ff4728c693d6fd?s=128&d=identicon&r=PG", "display_name": "SP1", "link": "https://stackoverflow.com/users/1221989/sp1"}, "edited": false, "score": 0, "creation_date": 1534974842, "post_id": 51975607, "comment_id": 90901779, "body": "Awesome..Thank you so much"}], "tags": [], "owner": {"reputation": 2839, "user_id": 470096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c88080fb2ed07fc23209593063e224ed?s=128&d=identicon&r=PG", "display_name": "Mark PM", "link": "https://stackoverflow.com/users/470096/mark-pm"}, "is_accepted": true, "score": 8, "last_activity_date": 1534974381, "creation_date": 1534974381, "answer_id": 51975607, "question_id": 51975514, "link": "https://stackoverflow.com/questions/51975514/getting-common-flags-enum-value-in-c/51975607#51975607", "title": "Getting common flags enum value in c#", "body": "<p>You can get that using the binary &amp; (and) operator:</p>\n\n<pre><code>var s = Letters.A | Letters.B | Letters.D;\nvar p = Letters.A | Letters.C | Letters.D | Letters.E;\nvar sAndp = s &amp; p; // This will give you only the common values ( A &amp; D)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5172, "user_id": 1411104, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d76247ee9f2ba6c7c79fc5cea3e8fba2?s=128&d=identicon&r=PG", "display_name": "MistyK", "link": "https://stackoverflow.com/users/1411104/mistyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1534974470, "creation_date": 1534974470, "answer_id": 51975634, "question_id": 51975514, "link": "https://stackoverflow.com/questions/51975514/getting-common-flags-enum-value-in-c/51975634#51975634", "title": "Getting common flags enum value in c#", "body": "<p>If that's suitable for you it will return List of individual flags</p>\n\n<pre><code> static IEnumerable&lt;Enum&gt; GetFlags(Enum input)\n    {\n        foreach (Enum value in Enum.GetValues(input.GetType()))\n            if (input.HasFlag(value))\n                yield return value;\n    }\n\nGetFlags(s).Intersect(GetFlags(p))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1534974550, "creation_date": 1534974550, "answer_id": 51975647, "question_id": 51975514, "link": "https://stackoverflow.com/questions/51975514/getting-common-flags-enum-value-in-c/51975647#51975647", "title": "Getting common flags enum value in c#", "body": "<p>Just as you use <code>|</code> to get a union of values, you can use the <code>&amp;</code> to get the intersection:</p>\n\n<pre><code>var s = Letters.A | Letters.B | Letters.D;\nvar p = Letters.A | Letters.C | Letters.D | Letters.E;\n\nvar intersection = s &amp; p;  // A | D\nvar union = s | p;         // All | D | E\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1055, "user_id": 2310805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/REDuN.jpg?s=128&g=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/2310805/eugene"}, "is_accepted": false, "score": 1, "last_activity_date": 1534974620, "creation_date": 1534974620, "answer_id": 51975661, "question_id": 51975514, "link": "https://stackoverflow.com/questions/51975514/getting-common-flags-enum-value-in-c/51975661#51975661", "title": "Getting common flags enum value in c#", "body": "<p>Here is the result:</p>\n\n<pre><code>    var result =  s &amp; p;\n</code></pre>\n"}], "owner": {"reputation": 1064, "user_id": 1221989, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f2b4b0a167c23b526ff4728c693d6fd?s=128&d=identicon&r=PG", "display_name": "SP1", "link": "https://stackoverflow.com/users/1221989/sp1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 51975607, "answer_count": 4, "score": 1, "last_activity_date": 1534974724, "creation_date": 1534973923, "last_edit_date": 1534974724, "question_id": 51975514, "link": "https://stackoverflow.com/questions/51975514/getting-common-flags-enum-value-in-c", "title": "Getting common flags enum value in c#", "body": "<p>Say I have the below enum</p>\n\n<pre><code>[Flags]\nenum Letters\n{\n     A = 1,\n     B = 2,\n     C = 4,\n     D = 8,\n     E = 16,\n     F = 32,\n     AB = A | B,\n     All = A | B | C,\n}\n</code></pre>\n\n<p>If I have the variables:</p>\n\n<pre><code>var s = Letters.A | Letters.B | Letters.D;\nvar p = Letters.A | Letters.C | Letters.D | Letters.E;\n</code></pre>\n\n<p>What I want is to get the common values between these two enums so in this case it should be <code>A | D</code>. Can some one please tell me how I can achieve this.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "csvhelper"], "comments": [{"owner": {"reputation": 10823, "user_id": 1567352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bdfeb44480b0de2237a5fe8001b8233b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Green", "link": "https://stackoverflow.com/users/1567352/brendan-green"}, "edited": false, "score": 0, "creation_date": 1534980176, "post_id": 51975504, "comment_id": 90903079, "body": "Does <code>GetRecord()</code> work?  It looks like you&#39;ve mixed the &quot;get single record&quot; and &quot;read all records&quot; examples together."}], "answers": [{"tags": [], "owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1534978762, "creation_date": 1534978762, "answer_id": 51976271, "question_id": 51975504, "link": "https://stackoverflow.com/questions/51975504/csv-helper-saying-item-does-not-exist-when-it-does/51976271#51976271", "title": "CSV Helper saying item does not exist when it does", "body": "<p>Your GetRecords function needs a type specifier like so:</p>\n\n<pre><code>var records = csv.GetRecords&lt;type&gt;();\n</code></pre>\n\n<p>Also you may want to put csv.Read() in a while loop depending on your need.</p>\n"}, {"tags": [], "owner": {"reputation": 2312, "user_id": 6330636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KwL7RaFztwM/AAAAAAAAAAI/AAAAAAAAADg/34eEeb890LE/photo.jpg?sz=128", "display_name": "Filip Cordas", "link": "https://stackoverflow.com/users/6330636/filip-cordas"}, "is_accepted": false, "score": 0, "last_activity_date": 1534979292, "creation_date": 1534979292, "answer_id": 51976335, "question_id": 51975504, "link": "https://stackoverflow.com/questions/51975504/csv-helper-saying-item-does-not-exist-when-it-does/51976335#51976335", "title": "CSV Helper saying item does not exist when it does", "body": "<p>Since all your values have quotes you need to specify it in the config. Working with quotes in csvHelper is frustrating. if not all if the values have quotes there are ways to handle that as well but not as nicely as this</p>\n\n<pre><code> var csv = new CsvReader(reader,new CsvHelper.Configuration.Configuration\n            {\n                HasHeaderRecord = true,\n                QuoteAllFields = true\n            });\n\n\n            var anonymousTypeDefinition = new\n            {\n                Itemcode = string.Empty,\n                Barcode = string.Empty\n            };\n            var records = csv.GetRecords(anonymousTypeDefinition);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2312, "user_id": 6330636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KwL7RaFztwM/AAAAAAAAAAI/AAAAAAAAADg/34eEeb890LE/photo.jpg?sz=128", "display_name": "Filip Cordas", "link": "https://stackoverflow.com/users/6330636/filip-cordas"}, "edited": false, "score": 0, "creation_date": 1534983618, "post_id": 51976406, "comment_id": 90903661, "body": "I think his issue is the quotes in the headers. But complicity agree on making a class also a mapping for Pascal case on description would be good as well."}], "tags": [], "owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "is_accepted": true, "score": 0, "last_activity_date": 1534979937, "creation_date": 1534979937, "answer_id": 51976406, "question_id": 51975504, "link": "https://stackoverflow.com/questions/51975504/csv-helper-saying-item-does-not-exist-when-it-does/51976406#51976406", "title": "CSV Helper saying item does not exist when it does", "body": "<p>You are better off creating a strongly typed model to hold the data if one does not already exist</p>\n\n<pre><code>public class Item {\n    public string Itemcode { get; set; }\n    public string Barcode { get; set; }\n    public string description { get; set; }\n}\n</code></pre>\n\n<p>and using <a href=\"https://joshclose.github.io/CsvHelper/reading#getting-all-records\" rel=\"nofollow noreferrer\"><code>GetRecords&lt;T&gt;()</code></a> to read the records by type</p>\n\n<pre><code>TextReader reader = File.OpenText(filename);\nvar csv = new CsvReader(reader);\nvar records = csv.GetRecords&lt;Item&gt;();\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10160788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7244b94d4e0bf84e50562da5ab201c?s=128&d=identicon&r=PG&f=1", "display_name": "david", "link": "https://stackoverflow.com/users/10160788/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 51976406, "answer_count": 3, "score": 1, "last_activity_date": 1534979937, "creation_date": 1534973868, "question_id": 51975504, "link": "https://stackoverflow.com/questions/51975504/csv-helper-saying-item-does-not-exist-when-it-does", "title": "CSV Helper saying item does not exist when it does", "body": "<p>I am trying to use csv helper libary to parse my csv. But I am having an issue it says that the itemcode does not exist when its there in the file.</p>\n\n<pre><code>    // Adding stock item code \nSage.Accounting.Stock.StockItem stockItem = new Sage.Accounting.Stock.StockItem();\n\nstring line = null;\npublic void ImportCsv(string filename)\n{\n         TextReader reader = File.OpenText(filename);\n\n\n\n    var csv = new CsvReader(reader);\n        csv.Configuration.HasHeaderRecord = true;\n        csv.Read();\n        // Dynamic\n      // Using anonymous type for the class definition\n        var anonymousTypeDefinition = new\n        {\n            Itemcode = string.Empty,\n            Barcode = string.Empty \n        };\n        var records = csv.GetRecords(anonymousTypeDefinition);\n\n\n }\n</code></pre>\n\n<p>This is the csv structure</p>\n\n<p>\"Itemcode\",\"Barcode\",\"description\"</p>\n\n<p>\"P4S100001\",\"303300054486\",\"Test Product\"</p>\n\n<p>This is my first time using the csvhelper as showing here at <a href=\"https://joshclose.github.io/CsvHelper/\" rel=\"nofollow noreferrer\">https://joshclose.github.io/CsvHelper/</a></p>\n"}, {"tags": ["c#", ".net", "xml", "linq-to-xml"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1535015646, "post_id": 51975489, "comment_id": 90914085, "body": "Try following : xdoc.Descendants().Where(x =&gt; x.Name.LocalName == &quot;SourcePartyName&quot;).Select(x =&gt; (string)x).FirstOrDefault()"}], "answers": [{"tags": [], "owner": {"reputation": 10503, "user_id": 9200675, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PxESv.jpg?s=128&g=1", "display_name": "pfx", "link": "https://stackoverflow.com/users/9200675/pfx"}, "is_accepted": true, "score": 1, "last_activity_date": 1534975535, "creation_date": 1534975535, "answer_id": 51975791, "question_id": 51975489, "link": "https://stackoverflow.com/questions/51975489/how-to-get-value-of-an-xml-node/51975791#51975791", "title": "How to get value of an XML node?", "body": "<p>When using an <code>XDocument</code> you have to go via its <strong><code>Root</code></strong> property.</p>\n\n<pre><code>String xml = @\"\n    &lt;ns0:Visit xmlns:ns0=\"\"http://Co.Burgers.Ues\"\"&gt;\n        &lt;ns0:SourcePartyName&gt;NDHARY&lt;/ns0:SourcePartyName&gt;\n    &lt;/ns0:Visit&gt;\n    \";\nXDocument xdoc = XDocument.Parse(xml);\nXNamespace ns = \"http://Co.Burgers.Ues\";\nString sourcePartyName = (String)xdoc.Root.Element(ns + \"SourcePartyName\");\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 10055317, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0r4irKby24U/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rVEaVB0q-Mpl5pTthTB96FFn4UEg/mo/photo.jpg?sz=128", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/10055317/alex-gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 51975791, "answer_count": 1, "score": -1, "last_activity_date": 1535002776, "creation_date": 1534973813, "last_edit_date": 1535002776, "question_id": 51975489, "link": "https://stackoverflow.com/questions/51975489/how-to-get-value-of-an-xml-node", "title": "How to get value of an XML node?", "body": "<p>For the life of me I have not been able to extract the <code>SourcePartyName</code> from this XML document:</p>\n\n<pre><code>&lt;ns0:Visit xmlns:ns0=\"http://Co.Burgers.Ues\"&gt;\n&lt;ns0:SourcePartyName&gt;NDHARY&lt;/ns0:SourcePartyName&gt;\n&lt;/ns0:Visit&gt;\n</code></pre>\n\n<p>Using Scott's <a href=\"http://www.hanselman.com/blog/GetNamespacesFromAnXMLDocumentWithXPathDocumentAndLINQToXML.aspx\" rel=\"nofollow noreferrer\">solution</a>, I've been able to extract the namespace info; however, after dozens of attempts at monkeying with <code>XDocument</code> / <code>XElement</code>, I have not been able to get the desired <code>NDHARY</code> value.</p>\n\n<p>Attempts have included:</p>\n\n<p><code>xdoc.Descendants(ns + \"SourcePartyName\").FirstOrDefault()?.Value;</code></p>\n\n<p>and</p>\n\n<p><code>xdoc.Element(ns + \"SourcePartyName\").Value;</code></p>\n\n<p><strong>How do you get the value of a node from an XDocument?</strong></p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 1, "creation_date": 1534973939, "post_id": 51975439, "comment_id": 90901448, "body": "What you are looking for is a feature called &quot;Console Virtual Terminal Sequences&quot;.  Current docs at: <a href=\"https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/console/&hellip;</a>.  You get to control the appearance of the console window by sending &quot;control sequences&quot; to the window."}, {"owner": {"reputation": 12931, "user_id": 1472222, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0970aeafe38e05589964ef6ec1ec3b4?s=128&d=identicon&r=PG", "display_name": "theMayer", "link": "https://stackoverflow.com/users/1472222/themayer"}, "edited": false, "score": 0, "creation_date": 1534982534, "post_id": 51975439, "comment_id": 90903473, "body": "I\u2019m not sure exactly what you\u2019re trying to do, but if you feel like this is additional \u201cgold plating\u201d then I guess I\u2019d worry about some more important thing. UX with console is already as bad as it gets."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 10211917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e15157c957fc864c7d1847273d694?s=128&d=identicon&r=PG&f=1", "display_name": "fskdjwe", "link": "https://stackoverflow.com/users/10211917/fskdjwe"}, "edited": false, "score": 0, "creation_date": 1535020914, "post_id": 51976617, "comment_id": 90917162, "body": "This works well, the only problem with it is if you scroll up, and then scroll back down to the bottom, it doesn&#39;t stop where you last left off, it scrolls much further down for a while. Is there a way to fix this?"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "reply_to_user": {"reputation": 147, "user_id": 10211917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e15157c957fc864c7d1847273d694?s=128&d=identicon&r=PG&f=1", "display_name": "fskdjwe", "link": "https://stackoverflow.com/users/10211917/fskdjwe"}, "edited": false, "score": 0, "creation_date": 1535031305, "post_id": 51976617, "comment_id": 90923633, "body": "Do you mean that you can scroll down further than the blank line below the output? If so, that&#39;s due to the buffer size settings on your console window. If you set the buffer size to the same size as the window, it will prevent scrolling: <code>Console.SetBufferSize(Console.WindowWidth, Console.WindowHeight);</code>"}], "tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1534982613, "last_edit_date": 1534982613, "creation_date": 1534981824, "answer_id": 51976617, "question_id": 51975439, "link": "https://stackoverflow.com/questions/51975439/why-do-i-always-have-a-blank-line-at-the-bottom-of-a-console-application/51976617#51976617", "title": "Why do I always have a blank line at the bottom of a console application?", "body": "<p>I think the only problem with your method is that it doesn't write anything to the console window. If you add an argument and write it to the console, it should work as expected.</p>\n\n<p>This example uses an <code>object</code> with a default value of <code>null</code>, but you could create many overloads to mimic the actual <code>WriteLine</code> method. It's basically the same code that you have, except that it prints the argument to the window plus a newline character, then moves the cursor up one space. I also added an optional argument to change the number of blank lines below the last line:</p>\n\n<pre><code>private static void TerminalWriteLine(object output = null, int numBlankLinesBelow = 1)\n{\n    // Don't allow negative numbers\n    numBlankLinesBelow = Math.Max(0, numBlankLinesBelow);\n    Console.WriteLine(output + new string('\\n', numBlankLinesBelow));\n    Console.SetCursorPosition(Console.CursorLeft, Console.CursorTop - numBlankLinesBelow);\n}\n</code></pre>\n\n<p>Then you would use this method in your code in place of <code>Console.WriteLine</code>, for example:</p>\n\n<pre><code>private static void Main()\n{\n    for (int i = 0; i &lt; 100; i++)\n    {\n        TerminalWriteLine(i);                \n    }\n\n    Console.ReadLine();\n    TerminalWriteLine(\"There should be 5 blank lines below this\", 5);\n    Console.ReadLine();\n}\n</code></pre>\n\n<p>Output after first <code>ReadLine()</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yHRvJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yHRvJ.png\" alt=\"![enter image description here\"></a></p>\n\n<p>Output after second <code>ReadLine()</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U1nbK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U1nbK.png\" alt=\"![enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14338157, "user_type": "registered", "profile_image": "https://graph.facebook.com/1521604351367028/picture?type=large", "display_name": "Luke Nukem", "link": "https://stackoverflow.com/users/14338157/luke-nukem"}, "is_accepted": false, "score": 0, "last_activity_date": 1601020830, "creation_date": 1601020830, "answer_id": 64060152, "question_id": 51975439, "link": "https://stackoverflow.com/questions/51975439/why-do-i-always-have-a-blank-line-at-the-bottom-of-a-console-application/64060152#64060152", "title": "Why do I always have a blank line at the bottom of a console application?", "body": "<p><strong>Hello there!</strong></p>\n<p>I had to sign up just to give <em>your question</em> a real and correct answer.</p>\n<p>WriteLine() with no params, is 100% okay, and it doesn't cause issues. I'm sorry about <em>Rufus L</em>.</p>\n<ul>\n<li>Your function shouldn't be called after the loop. It won't be called then until you break loop.</li>\n<li>That's all I can say without more code giving context to your words.</li>\n</ul>\n<p>It's always nice to*recreate your code as excerpts if you wish to keep your code private, like below.</p>\n<hr />\n<p>The correct answer is the simplest. Copy and paste this, then play with it.</p>\n<pre><code>        while (true)\n        {\n            Console.WriteLine(&quot;&gt;&quot;);\n            Console.CursorTop--;\n            Console.CursorLeft++;\n            string input = Console.ReadLine();\n        }\n</code></pre>\n<hr />\n<p>At this point, it is answered.</p>\n<p>But let's break it all down and have some fun!</p>\n<hr />\n<p>Print a prompt string (&quot;&gt;&quot;), or nothing (), and go to next line as desired.</p>\n<pre><code>Console.WriteLine(&quot;&gt;&quot;); // Or...\nConsole.WriteLine(); // Blank prompt.\n</code></pre>\n<hr />\n<p>There are times when it is impossible to know the target position.</p>\n<pre><code>Console.CursorTop--; // Cursor up by 1.\nConsole.CursorLeft++; // Right by length of prompt, if not blank.\n</code></pre>\n<hr />\n<p>The '_' represents the cursor position as is.</p>\n<pre><code>&gt;_ // Prompt awaiting user input.\n</code></pre>\n<hr />\n<p>At which point user input can be captured.</p>\n<pre><code>string input = Console.ReadLine();\n</code></pre>\n<hr />\n<p>Blurb.</p>\n<p>I am weird because I love Command Prompt console apps the most. I have made several over the past few years, and only this month created my latest version, the <em>omg</em> simplest of the lot, and the absolute best functional--works 100% as Cmd.exe, yet now has <strong>front end</strong> ability to add custom commands, so by default it is Cmd.exe.</p>\n<p>My most complex version, the previous version, had amazing custom functionality, including a Terminal function to become a literal terminal. The terminal also had the 'exit' command which snapped you back to my Control Console.</p>\n<p>This is literally one of my greatest programming passions. As such, a page full of horrible non-answers are sighted swiftly and with lament.</p>\n<p>Hence...</p>\n<hr />\n<p>In my consoles, I always use the Write function as I haven't desired a sure blank line below.</p>\n<p>Write also gives you more control. <strong>Let's get dynamic!</strong></p>\n<pre><code>        while (true)\n        {\n            string prompt = &quot;Terminal&gt; &quot;;\n            Console.Write(prompt);\n            int count = 5;\n            for (int i = 0; i &lt; count; i++) Console.WriteLine();\n            Console.CursorTop -= count;\n            Console.CursorLeft += prompt.Length;\n            string input = Console.ReadLine();\n        }\n</code></pre>\n<hr />\n<p>Now we want the prompt string to be a variable.</p>\n<pre><code>string prompt = &quot;Terminal&gt; &quot;; // Notice the space.\nConsole.Write(prompt);\n</code></pre>\n<hr />\n<p>Here we can decide how many blank lines we want, which can also be decided externally.</p>\n<pre><code>int count = 5; // Or variable.\n</code></pre>\n<hr />\n<p>A simple for loop to give us the desired number of blank lines after each prompt.</p>\n<p>This is why we do not prompt with WriteLine, as that would give us an extra one.</p>\n<pre><code>for (int i = 0; i &lt; count; i++) Console.WriteLine();\n</code></pre>\n<hr />\n<p>Move the cursor up and right based on the sizes known to us.</p>\n<pre><code>Console.CursorTop -= count; // Blank lines we printed.\nConsole.CursorLeft += prompt.Length; // The string length of the prompt.\n</code></pre>\n<hr />\n<p>The '_' represents the cursor position as is.</p>\n<pre><code>Terminal&gt; _ // Prompt awaiting user input.\n</code></pre>\n<hr />\n<p>At which point user input can be captured.</p>\n<pre><code>string input = Console.ReadLine();\n</code></pre>\n<hr />\n<p>Here is what my code might look like. Copy and paste this function, and have fun!</p>\n<pre><code>    static void CommandPrompt()\n    {\n        string input = &quot;&quot;;\n        string promptString = &quot;Terminal&gt; &quot;;\n        int blankLinesCount = 1;\n\n        while (true) PromptLoop();\n\n        // Local functions are a thing.\n\n        string PromptSimple()\n        {\n            Console.Write(&quot;&gt;&quot;);\n            return Console.ReadLine();\n        }\n\n        string Prompt()\n        {\n            Console.Write(promptString);\n            for (int i = 0; i &lt; blankLinesCount; i++) Console.WriteLine();\n            Console.CursorTop -= blankLinesCount;\n            Console.CursorLeft += promptString.Length;\n            return Console.ReadLine();\n        }\n\n        void PromptLoop()\n        {\n            input = Prompt();\n\n            // Process the input.\n        }\n    }\n</code></pre>\n<hr />\n<p><em><strong>Enjoy! \u2665</strong></em></p>\n"}], "owner": {"reputation": 147, "user_id": 10211917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/880e15157c957fc864c7d1847273d694?s=128&d=identicon&r=PG&f=1", "display_name": "fskdjwe", "link": "https://stackoverflow.com/users/10211917/fskdjwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1601020830, "creation_date": 1534973551, "last_edit_date": 1535000788, "question_id": 51975439, "link": "https://stackoverflow.com/questions/51975439/why-do-i-always-have-a-blank-line-at-the-bottom-of-a-console-application", "title": "Why do I always have a blank line at the bottom of a console application?", "body": "<p>I have a console application which I'm trying to treat like a terminal. Even terminals don't go this far to make sure the format is perfect, but I have OCD with this kind of thing, and wish to do it.</p>\n\n<p>Once I've typed about 10 or 20 lines into the terminal, I reach a place where my input cursor is right at the bottom of the console window, and there isn't a blank line underneath.</p>\n\n<p>I just think things would go much better if there was a line below at all lines. So after my while loop, I've attempted this, but it doesn't seem to help with the problem I'm currently facing.</p>\n\n<pre><code>private static void PrintLineToBottom()\n{\n    Console.WriteLine();\n    Console.SetCursorPosition(0, Console.CursorTop - 1);\n}\n</code></pre>\n\n<p>Can anyone help here? I suppose it also needs to know when it needs to do this.</p>\n"}, {"tags": ["c#", ".net", "gethashcode"], "comments": [{"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1534973286, "post_id": 51975304, "comment_id": 90901197, "body": "You can make GetHashCode return whatever you want, e.g. <code>Type &lt;&lt; 32 | Subtype</code>"}, {"owner": {"reputation": 2735, "user_id": 536593, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/862190992f07fd8fbdec19063608c4f1?s=128&d=identicon&r=PG&f=1", "display_name": "gabba", "link": "https://stackoverflow.com/users/536593/gabba"}, "edited": false, "score": 0, "creation_date": 1534975660, "post_id": 51975304, "comment_id": 90902049, "body": "it not possible with standard Dictionary, but it possible if you make custom realization with custom hash code comparation. But be careful, you should add value with joker second type to all buckets with same hash of primary type. so it waste memory and can be slower"}, {"owner": {"reputation": 2735, "user_id": 536593, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/862190992f07fd8fbdec19063608c4f1?s=128&d=identicon&r=PG&f=1", "display_name": "gabba", "link": "https://stackoverflow.com/users/536593/gabba"}, "edited": false, "score": 0, "creation_date": 1534975902, "post_id": 51975304, "comment_id": 90902105, "body": "if you make this experiment, please provide a results its will very much appreciated"}], "answers": [{"comments": [{"owner": {"reputation": 631, "user_id": 4215389, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000607354657/picture?type=large", "display_name": "K&#225;roly Ozsv&#225;rt", "link": "https://stackoverflow.com/users/4215389/k%c3%a1roly-ozsv%c3%a1rt"}, "edited": false, "score": 1, "creation_date": 1534974406, "post_id": 51975549, "comment_id": 90901619, "body": "You are right. I am aware of this, but this (the way I exapleined) is the exact way I want it to work like. Do you have any other recommendations?"}, {"owner": {"reputation": 44608, "user_id": 1127114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb1b2345f4c7b696d7c0376d273d01b2?s=128&d=identicon&r=PG", "display_name": "Michael Liu", "link": "https://stackoverflow.com/users/1127114/michael-liu"}, "reply_to_user": {"reputation": 631, "user_id": 4215389, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000607354657/picture?type=large", "display_name": "K&#225;roly Ozsv&#225;rt", "link": "https://stackoverflow.com/users/4215389/k%c3%a1roly-ozsv%c3%a1rt"}, "edited": false, "score": 2, "creation_date": 1534974480, "post_id": 51975549, "comment_id": 90901647, "body": "@K&#225;rolyOzsv&#225;rt: The Dictionary class <b>requires</b> an Equals method that&#39;s transitive. The MyDictKey.Equals method isn&#39;t transitive (you can&#39;t define an Equals method that ignores a member <i>some of the time</i>), so you can&#39;t use the class as the dictionary key. If you want it to work a different way, then implement your own lookup logic instead of using Dictionary."}], "tags": [], "owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "is_accepted": true, "score": 4, "last_activity_date": 1534974089, "creation_date": 1534974089, "answer_id": 51975549, "question_id": 51975304, "link": "https://stackoverflow.com/questions/51975304/how-to-include-a-joker-value-in-hashcode/51975549#51975549", "title": "How to include a &quot;joker&quot; value in HashCode", "body": "<p>That's not even a well-defined equality function, as it fails to be transitive.</p>\n\n<p>EG A=(1,1), B =(1,-1), C=(1,2)</p>\n\n<p>A=B, B=C, but not A=C</p>\n\n<p>Consider:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\n    namespace ConsoleApp5\n    {\n        class Program\n        {\n            static void Main(string[] args)\n            {\n                var A = new MyDictKey(1, 1);\n                var B = new MyDictKey(1, -1);\n                var C = new MyDictKey(1, 2);\n\n                var h = new HashSet&lt;MyDictKey&gt;();\n                h.Add(A);\n                h.Add(B);\n                h.Add(C);\n                Console.WriteLine(h.Count); //outputs 2\n\n\n                var h2 = new HashSet&lt;MyDictKey&gt;();\n                h2.Add(B);\n                h2.Add(C);\n                h2.Add(A);\n                Console.WriteLine(h2.Count); //outputs 1\n\n                Console.ReadKey();\n\n            }\n\n            public sealed class MyDictKey\n            {\n                public int Type { get; }\n                public int SubType { get; }\n\n                public MyDictKey(int type, int subType) // both can only be positive values\n                {\n                    Type = type;\n                    SubType = subType;\n                }\n\n                public override bool Equals(object obj)\n                {\n                    if (obj is MyDictKey other)\n                    {\n                        bool typeEqual = other.Type == Type;\n                        bool subTypeEqual = other.SubType == -1 || SubType == -1 || other.SubType == SubType;\n                        return typeEqual &amp;&amp; subTypeEqual;\n                    }\n\n                    return false;\n                }\n\n                public override int GetHashCode()\n                {\n                    unchecked\n                    {\n                        int hash = 17;\n                        hash = hash * 23 + Type.GetHashCode();\n                        return hash;\n                    }\n                }\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 631, "user_id": 4215389, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000607354657/picture?type=large", "display_name": "K&#225;roly Ozsv&#225;rt", "link": "https://stackoverflow.com/users/4215389/k%c3%a1roly-ozsv%c3%a1rt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "closed_date": 1534974486, "accepted_answer_id": 51975549, "answer_count": 1, "score": 3, "last_activity_date": 1534974329, "creation_date": 1534972807, "last_edit_date": 1534974150, "question_id": 51975304, "link": "https://stackoverflow.com/questions/51975304/how-to-include-a-joker-value-in-hashcode", "closed_reason": "Duplicate", "title": "How to include a &quot;joker&quot; value in HashCode", "body": "<p>I have the following example class:</p>\n\n<pre><code>public sealed class MyDictKey\n{\n    public int Type { get; }\n    public int SubType { get; }\n\n    public MyDictKey(int type, int subType) // both can only be positive values\n    {\n        Type = type;\n        SubType = subType;\n    }\n\n    public override bool Equals(object obj)\n    {\n        if (obj is MyDictKey other)\n        {\n            bool typeEqual = other.Type == Type;\n            bool subTypeEqual = other.SubType == -1 || SubType == -1 || other.SubType == SubType;\n            return typeEqual &amp;&amp; subTypeEqual;\n        }\n\n        return false;\n    }\n\n    public override int GetHashCode()\n    {\n        unchecked\n        {\n            int hash = 17;\n            hash = hash * 23 + Type.GetHashCode();\n            return hash;\n        }\n    }\n}\n</code></pre>\n\n<p>And the following test <em>(NUnit, if anyone is interested)</em>:</p>\n\n<pre><code>    [Test]\n    public void CalculatorTest()\n    {\n        Dictionary&lt;MyDictKey, string&gt; myTypeProcessors = new Dictionary&lt;MyDictKey, string&gt;();\n\n        myTypeProcessors.Add(new MyDictKey(10, 20), \"10.20_processor\");\n        myTypeProcessors.Add(new MyDictKey(3, 4), \"3.4_processor\");\n        myTypeProcessors.Add(new MyDictKey(4, -1), \"4.any_processor\");\n        // -1 means it can process \"any\" subtype\n\n        for (int i = 0; i &lt; 1000; i++) // should work for any positive number\n        {\n            bool canGet = myTypeProcessors.TryGetValue(new MyDictKey(4, i), out string value);\n            Assert.IsTrue(canGet);\n            Assert.That(value, Is.EqualTo(\"4.any_processor\"));\n\n            bool canGet2 = myTypeProcessors.TryGetValue(new MyDictKey(10, i), out string value2);\n            if (i == 20)\n            {\n                Assert.IsTrue(canGet2);\n                Assert.That(value2, Is.EqualTo(\"10.20_processor\"));\n            }\n            else\n            {\n                Assert.IsFalse(canGet2);\n            }\n        }\n    }\n</code></pre>\n\n<p><strong>Can I somehow reach the same mechanism only by using the GetHashCode?</strong> Since this way, if only the SubTypes differ, the dictionary's TryGetValue will always call into the Equals method. It is important that the new method must not be slower than the original one.</p>\n\n<p>I was thinking of bitwise operators; or are there any magical mathematical formulas for this?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c#", "certificate", "x509certificate2"], "answers": [{"tags": [], "owner": {"reputation": 957, "user_id": 3277813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b3b4a2ac530ee2f68419e3f58bec01?s=128&d=identicon&r=PG&f=1", "display_name": "trix", "link": "https://stackoverflow.com/users/3277813/trix"}, "is_accepted": true, "score": 0, "last_activity_date": 1534975969, "creation_date": 1534975969, "answer_id": 51975869, "question_id": 51975265, "link": "https://stackoverflow.com/questions/51975265/how-to-get-issuer-name-in-rfc-1779-from-x509certificate2/51975869#51975869", "title": "How to get issuer name in RFC-1779 from X509Certificate2?", "body": "<p>The string you're wanting is just the reverse of the string you're actually getting from <code>Issuer</code>, and is delimited by slashes instead of commas with a following space.</p>\n\n<p>My first attempt to solve this problem was to create a new <code>X500DistinguishedName</code> object, passing the certificate's <code>IssuerName</code> and <code>X500DistinguishedNameFlags.Reversed</code> to the constructor:</p>\n\n<pre><code>var distinguishedName = new X500DistinguishedName(cert.Issuer, X500DistinguishedNameFlags.Reversed);\n</code></pre>\n\n<p>But that didn't provide me with the result I was hoping for. I'm not sure of any baked in way to do this. But you could try reformatting the string manually to meet your needs:</p>\n\n<pre><code>var split = cert.Issuer.Split(new []{',', ' '}, StringSplitOptions.RemoveEmptyEntries);\nvar reversed = split.Reverse();\nvar finalIssuerName = string.Join(\"/\", reversed); \n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 5113846, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81cc0efae1be36962452b9337c488b33?s=128&d=identicon&r=PG&f=1", "display_name": "Ma3yTa", "link": "https://stackoverflow.com/users/5113846/ma3yta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 51975869, "answer_count": 1, "score": 0, "last_activity_date": 1534990417, "creation_date": 1534972633, "last_edit_date": 1534990417, "question_id": 51975265, "link": "https://stackoverflow.com/questions/51975265/how-to-get-issuer-name-in-rfc-1779-from-x509certificate2", "title": "How to get issuer name in RFC-1779 from X509Certificate2?", "body": "<p>The <code>Issuer</code> property from <code>X509Certificate2</code> returns a <code>string</code> such as:</p>\n\n<p>\"CN=eBusiness Development CA, OU=ITSB eBusiness Systems Team, O=AVANO, L=Sydney, S=NSW, C=AU\"</p>\n\n<p>How do I get the same in RFC-1779? For example:</p>\n\n<p>\"/C=AU/ST=NSW/L=Sydney/O=AVANO/OU=ITSB eBusiness Systems Team/CN=eBusiness Development CA\"</p>\n\n<pre><code>var cert = new X509Certificate2(certPath, password);\nConsole.WriteLine(cert.Issuer);\n</code></pre>\n"}, {"tags": ["c#", "dictionary", "binaryformatter", "iserializable"], "comments": [{"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1534973099, "post_id": 51975261, "comment_id": 90901107, "body": "Set debugger to break on unhandled exception. You will probably find that it is object inside the dictionary which doesn&#39;t implement IConvertible"}, {"owner": {"reputation": 36, "user_id": 3461317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a789d4dc45759b198576e047001c143?s=128&d=identicon&r=PG&f=1", "display_name": "D A M", "link": "https://stackoverflow.com/users/3461317/d-a-m"}, "reply_to_user": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1535032222, "post_id": 51975261, "comment_id": 90924280, "body": "It shouldn&#39;t have to. I did discover that the underlying type was actually NHibernate.Collection.Generic.PersistentGenericMap&lt;string,st&zwnj;&#8203;ring&gt; so I guess now I need to discover why that is the case. As you can see from above it&#39;s defined as Dictionary&lt;string,string&gt;."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1535033240, "post_id": 51975261, "comment_id": 90924953, "body": "Dictionary is an interface, many types can implement it."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 3461317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a789d4dc45759b198576e047001c143?s=128&d=identicon&r=PG&f=1", "display_name": "D A M", "link": "https://stackoverflow.com/users/3461317/d-a-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1535033321, "creation_date": 1535033321, "answer_id": 51987800, "question_id": 51975261, "link": "https://stackoverflow.com/questions/51975261/system-invalidcastexception-object-must-implement-iconvertible-when-deseriali/51987800#51987800", "title": "System.InvalidCastException &quot;Object must implement IConvertible.&quot; when deserializing a Dictionary using a BinaryFormatter", "body": "<p>Turns out that since I'm using NHibernate that it injects it's own implementation of collections. In order to make this work I must use the interface IDictionary in the serialization/deserialization:</p>\n\n<pre><code>    protected CustomFields( SerializationInfo info, StreamingContext context )\n        : base( info, context )\n    {\n        if( info == null )\n            throw new ArgumentNullException( \"info\" );\n\n        this.CustomFieldDictionary = ( IDictionary&lt;string, string&gt; ) info.GetValue( \"CustomFieldDictionary\", typeof( IDictionary&lt;string, string&gt; ) );\n    }\n\n    [SecurityPermission( SecurityAction.LinkDemand,\n        Flags = SecurityPermissionFlag.SerializationFormatter )]\n    public override void GetObjectData( SerializationInfo info, StreamingContext context )\n    {\n        if( info == null )\n            throw new ArgumentNullException( \"info\" );\n\n        base.GetObjectData( info, context );\n\n        // Following line throws\n        info.AddValue( \"CustomFieldDictionary\", this.CustomFieldDictionary, typeof( IDictionary&lt;string, string&gt; ) );\n    }\n</code></pre>\n"}], "owner": {"reputation": 36, "user_id": 3461317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a789d4dc45759b198576e047001c143?s=128&d=identicon&r=PG&f=1", "display_name": "D A M", "link": "https://stackoverflow.com/users/3461317/d-a-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 706, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1535033321, "creation_date": 1534972610, "question_id": 51975261, "link": "https://stackoverflow.com/questions/51975261/system-invalidcastexception-object-must-implement-iconvertible-when-deseriali", "title": "System.InvalidCastException &quot;Object must implement IConvertible.&quot; when deserializing a Dictionary using a BinaryFormatter", "body": "<pre><code>[Serializable]\npublic class CustomFields : MyObject, ICustomFields // MyObject is marked as ISerializable\n{\n    private IDictionary&lt;string, string&gt; _customFieldDictionary;\n\n    public CustomFields( ) {\n        this._customFieldDictionary = new Dictionary&lt;string, string&gt;( );\n    }\n\n    protected CustomFields( SerializationInfo info, StreamingContext context )\n        : base( info, context )\n    {\n        if( info == null )\n            throw new System.ArgumentNullException( \"info\" );\n\n        // Following line throws\n        this.CustomFieldDictionary = ( Dictionary&lt;string, string&gt; ) info.GetValue( \"CustomFieldDictionary\", typeof( Dictionary&lt;string, string&gt; ) );\n    }\n\n    [SecurityPermission( SecurityAction.LinkDemand,\n        Flags = SecurityPermissionFlag.SerializationFormatter )]\n    public override void GetObjectData( SerializationInfo info, StreamingContext context )\n    {\n        if( info == null )\n            throw new ArgumentNullException( \"info\" );\n\n        base.GetObjectData( info, context );\n\n        info.AddValue( \"CustomFieldDictionary\", this.CustomFieldDictionary, typeof( Dictionary&lt;string, string&gt; ) );\n    }\n\n    public virtual IDictionary&lt;string, string&gt; CustomFieldDictionary\n    {\n        get { return this._customFieldDictionary; }\n        set { this._customFieldDictionary = value; }\n    }\n}\n</code></pre>\n\n<p>This class is referenced by another Serializable class.</p>\n\n<pre><code>[Serializable]\npublic class UserOfCustomFields : MyObject, IUserOfCustomFields {\n\n    public UserOfCustomFields( ) {\n        this.CustomFields = new CustomFields( );\n    }\n\n    protected UserOfCustomFields( SerializationInfo info, StreamingContext context ) : base(info, context)\n    {\n        if( info == null )\n            throw new System.ArgumentNullException( \"info\" );\n        this.CustomFields = ( CustomFields ) info.GetValue( \"CustomFields\", typeof( CustomFields ) );\n    }\n\n    [SecurityPermission(SecurityAction.LinkDemand,\n        Flags = SecurityPermissionFlag.SerializationFormatter)]\n    public override void GetObjectData( SerializationInfo info, StreamingContext context )\n    {\n        if( info == null )\n            throw new ArgumentNullException( \"info\" );\n\n        base.GetObjectData( info, context );\n\n        info.AddValue( \"CustomFields\", this.CustomFields, typeof( CustomFields ) );\n    }\n\n    public virtual ICustomFields CustomFields { get; set; }\n}\n</code></pre>\n\n<p>Here's the code that calls the serialization/deserialization code:</p>\n\n<pre><code>    public bool SaveObjects( IEnumerable&lt;IMyObject&gt; objects ) {\n        // If we have null objects fail\n        if ( objects == null ) { return false; }\n\n        var local_objects = objects.ToList( );\n        var new_list = new List&lt; IDBObject&lt; Guid &gt; &gt;( );\n        foreach ( var obj in local_objects ) {\n            var clone = this.DeepCopy( obj );\n            new_list.Add( clone );\n        }\n\n        return true;\n    }\n</code></pre>\n\n<p>And the actual serialization/deserialization  takes place here:</p>\n\n<pre><code>    public virtual T DeepCopy&lt;T&gt;( T obj )\n    {\n        if( !obj.GetType( ).IsSerializable )\n        {\n            throw new Exception( \"The source object must be serializable\" );\n        }\n\n        if( Object.ReferenceEquals( obj, null ) )\n        {\n            throw new Exception( \"The source object must not be null\" );\n        }\n\n        T result = default( T );\n\n        using( var memoryStream = new MemoryStream( ) )\n        {\n            var formatter = new BinaryFormatter( );\n            formatter.Serialize( memoryStream, obj );\n            memoryStream.Seek( 0, SeekOrigin.Begin );\n\n            result = ( T ) formatter.Deserialize( memoryStream );\n\n            memoryStream.Close( );\n        }\n\n        return result;\n    }\n</code></pre>\n\n<p>As noted in the title I get System.InvalidCastException \"Object must implement IConvertible.\" when deserializing. Is Dictionary a special case? I've had no problems with any other types (up to now).</p>\n"}, {"tags": ["c#", ".net", "vb.net", "interface", "indexer"], "comments": [{"owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "edited": false, "score": 0, "creation_date": 1534972557, "post_id": 51975202, "comment_id": 90900899, "body": "Is there API documentation for this custom library you&#39;re using?"}, {"owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "edited": false, "score": 1, "creation_date": 1534972687, "post_id": 51975202, "comment_id": 90900946, "body": "After removing your own code, what does Visual Studio suggest as implementation when you hover over the Esprit.Tooolbar?"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1534972708, "post_id": 51975202, "comment_id": 90900953, "body": "What is the interface specification for this missing member?"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 3, "creation_date": 1534973085, "post_id": 51975202, "comment_id": 90901102, "body": "Are you sure the return type of <code>this[]</code> is &#39;ToolBarControl&#39;?"}, {"owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "reply_to_user": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1534973410, "post_id": 51975202, "comment_id": 90901249, "body": "If you can&#39;t find documentation, open the reference in a disassembler and see what it&#39;s looking for specifically.  @Neil might be right, it could be expecting &#39;object&#39; from the indexer, or &#39;IToolbarControl&#39;."}, {"owner": {"reputation": 1420, "user_id": 2043621, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ngBOJ.png?s=128&g=1", "display_name": "Still.Tony", "link": "https://stackoverflow.com/users/2043621/still-tony"}, "reply_to_user": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "edited": false, "score": 0, "creation_date": 1535115560, "post_id": 51975202, "comment_id": 90959580, "body": "@ParrishHusband There is documentation but it does not address sub-classing Esprit.Toolbar. See additional info added in question for answer to VS suggested implementation."}, {"owner": {"reputation": 1420, "user_id": 2043621, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ngBOJ.png?s=128&g=1", "display_name": "Still.Tony", "link": "https://stackoverflow.com/users/2043621/still-tony"}, "reply_to_user": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1535115725, "post_id": 51975202, "comment_id": 90959670, "body": "@Neil I verified the return type. See additional edit and screenshot for <code>Item[int]</code> definition in the <code>IToolBar</code> from Object Browser."}], "answers": [{"tags": [], "owner": {"reputation": 13274, "user_id": 920669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/639ffd0669e8284dcfe77a883effe31d?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/920669/corey"}, "is_accepted": false, "score": 0, "last_activity_date": 1534982199, "creation_date": 1534982199, "answer_id": 51976663, "question_id": 51975202, "link": "https://stackoverflow.com/questions/51975202/indexer-named-item-required-by-interface-but-not-possible-to-implement/51976663#51976663", "title": "Indexer named &quot;Item&quot; required by interface but not possible to implement?", "body": "<p>The problem is that there is no valid C# syntax for declaring a named indexer so you cannot satisfy that interface using C#.  There have been several requests to implement named indexers in C# all of which have been ignored or outright refused by the C# language team.  They appear to not want to implement this feature in C#.  Maybe if they change their minds later you might get a shot.</p>\n\n<p>The only way I can think to approach this currently is to create a VB.NET library with a class that implements the interface and acts as either a wrapper or a base class for your own class.</p>\n"}, {"comments": [{"owner": {"reputation": 1420, "user_id": 2043621, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ngBOJ.png?s=128&g=1", "display_name": "Still.Tony", "link": "https://stackoverflow.com/users/2043621/still-tony"}, "edited": false, "score": 1, "creation_date": 1535116635, "post_id": 51976869, "comment_id": 90960253, "body": "I implemented <code>get_Item</code> as <code>public ToolBarControl get_Item(int index) =&gt; ToolBar.Item[index];</code> and it (oddly enough) satisfied the <code>Item[int] get</code> requirement. Want to add a TLDR blurb at the top of your answer stating basically that <code>get_Item(int index)</code> can satisfy the <code>Item</code> requirement of an interface?"}, {"owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "reply_to_user": {"reputation": 1420, "user_id": 2043621, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ngBOJ.png?s=128&g=1", "display_name": "Still.Tony", "link": "https://stackoverflow.com/users/2043621/still-tony"}, "edited": false, "score": 1, "creation_date": 1535117950, "post_id": 51976869, "comment_id": 90961192, "body": "@Still.Tony, I&#39;ve worked with another 3rd party library which is written in VB.NET and I&#39;ve noticed somewhat similar behavior.  If you have an IL disassembler, it might be worth looking at IToolbar to see the underlying code.  Maybe update your question with &#39;Esprit&#39; somewhere, so that others might be able to find this."}], "tags": [], "owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "is_accepted": true, "score": 4, "last_activity_date": 1551546839, "last_edit_date": 1551546839, "creation_date": 1534984458, "answer_id": 51976869, "question_id": 51975202, "link": "https://stackoverflow.com/questions/51975202/indexer-named-item-required-by-interface-but-not-possible-to-implement/51976869#51976869", "title": "Indexer named &quot;Item&quot; required by interface but not possible to implement?", "body": "<p>C# can satisfy that .Item 'indexer' from the Interface with <code>get_Item</code>.  This is because of how Property/Index getters and setters are generated during IL compilation.  </p>\n\n<p>Here is how it is described in the <a href=\"https://www.ecma-international.org/publications/files/ECMA-ST/ECMA-335.pdf\" rel=\"nofollow noreferrer\">CLI Specification</a>:</p>\n\n<blockquote>\n  <h1><strong>I.10.4 Naming patterns</strong></h1>\n  \n  <p><strong>For Properties:</strong></p>\n  \n  <p>An individual property is created by deciding on the type returned by its getter method and the\n  types of the getter\u2019s parameters (if any). <strong>Then, two methods are created with names based on the\n  <em>name of the property and these types.</em></strong> For the examples below we define two properties: Name\n  takes no parameters and returns a System.String, while Item takes a System.Object parameter\n  and returns a System.Object. Item is referred to as an indexed property, meaning that it takes\n  parameters and thus can appear to the user as through it were an array with indices.</p>\n</blockquote>\n\n<pre><code>PropertyGet, used to read the value of the property\n   Pattern: &lt;PropType&gt; get_&lt;PropName&gt; (&lt;Indices&gt;)\n   Example: System.String get_Name ();\n   Example: System.Object get_Item (System.Object key);\nPropertySet, used to modify the value of the property\n   Pattern: void set_&lt;PropName&gt; (&lt;Indices&gt;, &lt;PropType&gt;)\n   Example: void set_Name (System.String name);\n   Example: void set_Item (System.Object key, System.Object value); \n</code></pre>\n\n<p>Therefore you should be able to meet the conditions of the indexer implementing it with something like this:</p>\n\n<pre><code>public class ManagedEspritToolbar : Esprit.Toolbar\n{\n    public ToolbarControl get_Item(int index) =&gt; Toolbar[index];\n}\n</code></pre>\n\n<hr>\n\n<p>For testing this you can create a simple interface in VB.NET:</p>\n\n<pre><code>Public Interface IVBNetInterface\n    Property Item(index As Integer) As String\nEnd Interface\n</code></pre>\n\n<p>Then implement the interface on a new class in C#.  Note how it defaults to <code>get_Item/set_Item</code> accessors when allowing the IDE to auto-implement the interface:</p>\n\n<pre><code>public class CSharpClass : IVBNetInterface\n{\n    public string get_Item(int index)\n    {\n        throw new NotImplementedException();\n    }\n\n    public void set_Item(int index, string Value)\n    {\n        throw new NotImplementedException();\n    }\n}\n</code></pre>\n\n<p>Reading the generated IL of the Interface confirms this behavior:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1uxlv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1uxlv.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2>What about VB.NET's Default Property?</h2>\n\n<p>In VB.NET, there is a <code>Default</code> property decorator which is essentially the mechanism for declaring an indexer on a class:</p>\n\n<pre><code>Public Interface IVBNetInterface\n    Default Property Item(index As Integer) As String\nEnd Interface\n</code></pre>\n\n<p>When this is implemented correctly on the VB.NET class/interface, the standard C# <code>this[int]</code> indexing implementation will work.  Therefore the <code>get_Item</code> workaround <strong>should only really be necessary when the Default attribute has <em>not</em> been properly applied to the target index property</strong>.  Note the addition of the <code>System.Reflection.DefaultMemberAttribute</code> attribute when investigating the IL code once this has been applied:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sOCgS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sOCgS.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2>Improving Usage:</h2>\n\n<p>To get around underlying classes/interfaces <em>not</em> being written with the <code>Default</code> modifier, you can implement the interface indexers explicitely, which allows exposing a traditional C# styled indexer on the class:</p>\n\n<pre><code>public class CSharpClass : IVBNetInterface\n{\n    public string this[int index]\n    {\n        get =&gt; throw new NotImplementedException();\n        set =&gt; throw new NotImplementedException();\n    }\n\n    #region IVBNetInterface\n\n    string IVBNetInterface.get_Item(int index) =&gt; this[index];\n\n    void IVBNetInterface.set_Item(int index, string value) =&gt; this[index] = value;\n\n    #endregion\n}\n</code></pre>\n\n<p>This may be the preferred approach if you want the usage of the class to be inferred through the typical indexer while still satisfying the underlying Interface.Item requirement.</p>\n"}], "owner": {"reputation": 1420, "user_id": 2043621, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ngBOJ.png?s=128&g=1", "display_name": "Still.Tony", "link": "https://stackoverflow.com/users/2043621/still-tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "accepted_answer_id": 51976869, "answer_count": 2, "score": 4, "last_activity_date": 1551546839, "creation_date": 1534972350, "last_edit_date": 1535726129, "question_id": 51975202, "link": "https://stackoverflow.com/questions/51975202/indexer-named-item-required-by-interface-but-not-possible-to-implement", "title": "Indexer named &quot;Item&quot; required by interface but not possible to implement?", "body": "<p>I'm trying to implement an interface of a class in the ESPRIT api that requires an indexer named \"Item.\" (I'm guessing the interface came from VB.NET but I don't have the source.) Obviously the \"Item[index]\" indexer is auto-generated by the compiler by default but I'm getting the following errors:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mRE2T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mRE2T.png\" alt=\"Errors\"></a></p>\n\n<p>I realize <code>[System.Runtime.CompilerServices.IndexerName(\"Item\")]</code> is redundant; it's simply there to demonstrate explicitly that <code>Item</code> is generated and the error remains.</p>\n\n<p>Attempting to implement <code>public ToolBarControl Item[int index]</code> 'splodes everything in the rest of the class.</p>\n\n<p><em>Edit1: The third screenshot shows <code>IToolBar.this</code> but I did try <code>IToolBar.Item</code> with the result stated above.</em></p>\n\n<p>Looks like I'm not the first to request named iterators but I <em>think</em> the generated named indexer should satisfy the requirement.\n<a href=\"https://github.com/dotnet/csharplang/issues/471\" rel=\"nofollow noreferrer\">https://github.com/dotnet/csharplang/issues/471</a></p>\n\n<p>How do I implement this indexer to satisfy the interface?</p>\n\n<hr>\n\n<p><em>Note: I'm making the following edit for completeness, future troubleshooting and to answer questions posed in comments but I already know the solution for this particular instance is implementing <code>get_Item(int index)</code> as stated in the accepted answer.</em></p>\n\n<p>Edit2: To answer \"what does visual studio suggest?\" As you can see, it knows before it makes the replacement that <code>Index</code> will be in error because there is no <code>Index</code> parameter defined on <code>Item</code> (I've tested this and it indeed fails.) Neither of the other two options for automatic implementation work.\n<a href=\"https://i.stack.imgur.com/UBmGZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UBmGZ.png\" alt=\"Visual Studio suggestion\"></a></p>\n\n<p>Edit3: From Object Browser, inside <code>IToolBar</code>, <code>Item[int]</code> is defined as:<a href=\"https://i.stack.imgur.com/rBBAM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rBBAM.png\" alt=\"Item definition\"></a></p>\n"}, {"tags": ["c#", "asp.net", ".net", "webforms", "postback"], "comments": [{"owner": {"reputation": 2978, "user_id": 760139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VrAo0.jpg?s=128&g=1", "display_name": "Tony Dong", "link": "https://stackoverflow.com/users/760139/tony-dong"}, "edited": false, "score": 0, "creation_date": 1534972226, "post_id": 51975058, "comment_id": 90900782, "body": "That is normal, and you can&#39;t get changed value (ex. use JQuery change the value, post back did not work)"}], "answers": [{"tags": [], "owner": {"reputation": 21519, "user_id": 639716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/NN38X.png?s=128&g=1", "display_name": "pete", "link": "https://stackoverflow.com/users/639716/pete"}, "is_accepted": true, "score": 2, "last_activity_date": 1534972621, "creation_date": 1534972621, "answer_id": 51975263, "question_id": 51975058, "link": "https://stackoverflow.com/questions/51975058/behavior-of-a-disabled-textbox-on-post-back-in-asp-net-webforms/51975263#51975263", "title": "Behavior of a disabled TextBox on post-back in asp.net webforms", "body": "<p>In short:</p>\n\n<blockquote>\n  <p>yes, because the value is coming from your viewstate, not the form.</p>\n</blockquote>\n\n<p>For a slightly more involved answer...</p>\n\n<p>The form data that gets submitted (accessible through <code>Request.Form</code>) will be missing for <code>vPlantNameTB</code> as it is disabled and therefore not sent by the browser to the server.</p>\n\n<p>Also included in the form data sent to the server is a hidden input (generated by the .Net engine) called <code>__VIEWSTATE</code> and it's value is a base64-encoded string that represents the current state of the page.</p>\n\n<p>The page state automatically serialized out to the rendered web page and automatically deserialized when the form is posted (the deserialization process also handles re-association with your page controls which is why <code>vPlantNameTB</code> has a value again in your postback handler).</p>\n\n<p>Scott Mitchell has a <a href=\"https://msdn.microsoft.com/en-us/library/ms972976.aspx\" rel=\"nofollow noreferrer\">decent article about ViewState on MSDN</a> which describes the process quite well.</p>\n"}], "owner": {"reputation": 2401, "user_id": 3377344, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7deCJ.jpg?s=128&g=1", "display_name": "psj01", "link": "https://stackoverflow.com/users/3377344/psj01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 51975263, "answer_count": 1, "score": 1, "last_activity_date": 1535126266, "creation_date": 1534971643, "last_edit_date": 1535126266, "question_id": 51975058, "link": "https://stackoverflow.com/questions/51975058/behavior-of-a-disabled-textbox-on-post-back-in-asp-net-webforms", "title": "Behavior of a disabled TextBox on post-back in asp.net webforms", "body": "<p>I was reading about the difference between Disabled vs Read only and I learned that with a disabled field the data is not send back on postback.\nHowever I have a webforms page with a textbox like below:</p>\n\n<pre><code>&lt;asp:TextBox runat=\"server\" ID=\"vPlantNameTB\" Text=\"\" Enabled=\"false\"&gt;&lt;/asp:TextBox&gt;\n</code></pre>\n\n<p>On page load I set the value of <code>vPlantNameTB</code> to some value. (instead of blank).\nSince I have this TextBox disabled.  I expect the value of the TextBox to be blank on post-back.  But that is not the case... </p>\n\n<p>I am able to get the value I set it to on page load during post-post back.<br>\nIs this behavior normal for web-forms?</p>\n"}, {"tags": ["c#", "asp.net", ".net", "asp.net-mvc", "telerik"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "edited": false, "score": 0, "creation_date": 1534972807, "post_id": 51975157, "comment_id": 90900995, "body": "yes I have tried that and the selectedIndex is always -1"}, {"owner": {"reputation": 222, "user_id": 10256655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IceNr.jpg?s=128&g=1", "display_name": "Neto Costa", "link": "https://stackoverflow.com/users/10256655/neto-costa"}, "reply_to_user": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "edited": false, "score": 0, "creation_date": 1534972928, "post_id": 51975157, "comment_id": 90901050, "body": "That\u2019s strange because once the Selected Index changed, it shouldn\u2019t be -1, try setting an default selected item to see the value that will appear."}, {"owner": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "edited": false, "score": 0, "creation_date": 1534973683, "post_id": 51975157, "comment_id": 90901346, "body": "below code in         protected void Page_Init(object sender, EventArgs e){ if (!IsPostBack)             {  RadCombo1.SelectedValue = &quot;2&quot;;}} this doesn&#39;t defaults the value to 2"}, {"owner": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "edited": false, "score": 0, "creation_date": 1534973831, "post_id": 51975157, "comment_id": 90901408, "body": "e.Text and e.Value in RadCombo1_SelectedIndexChanged works"}, {"owner": {"reputation": 222, "user_id": 10256655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IceNr.jpg?s=128&g=1", "display_name": "Neto Costa", "link": "https://stackoverflow.com/users/10256655/neto-costa"}, "reply_to_user": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "edited": false, "score": 0, "creation_date": 1534973936, "post_id": 51975157, "comment_id": 90901446, "body": "Can\u2019t you set the default value by \u201cRadCombo1.SelectedItem\u201d?"}, {"owner": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "edited": false, "score": 0, "creation_date": 1535033523, "post_id": 51975157, "comment_id": 90925165, "body": "The issue was I had  RadComboBox RadCombo1 = new RadComboBox() in the code..I deleted that from code and that fixed the issue..Thank you Neto Costa"}, {"owner": {"reputation": 222, "user_id": 10256655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IceNr.jpg?s=128&g=1", "display_name": "Neto Costa", "link": "https://stackoverflow.com/users/10256655/neto-costa"}, "reply_to_user": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "edited": false, "score": 0, "creation_date": 1535036230, "post_id": 51975157, "comment_id": 90926951, "body": "Makes sense, glad you could make it."}], "tags": [], "owner": {"reputation": 222, "user_id": 10256655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IceNr.jpg?s=128&g=1", "display_name": "Neto Costa", "link": "https://stackoverflow.com/users/10256655/neto-costa"}, "is_accepted": true, "score": 0, "last_activity_date": 1534972131, "creation_date": 1534972131, "answer_id": 51975157, "question_id": 51975027, "link": "https://stackoverflow.com/questions/51975027/radcombobox-selectedvalue-is-null/51975157#51975157", "title": "RadCombobox SelectedValue is Null", "body": "<p>I\u2019ve never used Telerik, but have you tried doing it like this:</p>\n\n<pre><code>var text1 =RadCombo1.Items[radCombo1.SelectedIndex];\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 6713710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c584b8dee72e0a74307547be25c40105?s=128&d=identicon&r=PG&f=1", "display_name": "Lotus", "link": "https://stackoverflow.com/users/6713710/lotus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 51975157, "answer_count": 1, "score": 1, "last_activity_date": 1535126230, "creation_date": 1534971490, "last_edit_date": 1535126230, "question_id": 51975027, "link": "https://stackoverflow.com/questions/51975027/radcombobox-selectedvalue-is-null", "title": "RadCombobox SelectedValue is Null", "body": "<p>I'm new to Telerik.\nI have a radcombobox as below:</p>\n\n<pre><code>&lt;telerik:RadComboBox ID =\"RadCombo1\" runat =\"server\"   \n        Width=\"200px\" autopostback =\"true\" OnSelectedIndexChanged=\"RadCombo1_SelectedIndexChanged\"&gt;   \n    &lt;Items&gt;   \n        &lt;telerik:RadComboBoxItem Text =\"One\" Value =\"1\"  /&gt;   \n        &lt;telerik:RadComboBoxItem  Text=\"Two\"  Value =\"2\" /&gt;    \n    &lt;/Items&gt;  \n&lt;/telerik:RadComboBox&gt;\n</code></pre>\n\n<p>In my code I have:</p>\n\n<pre><code>public void RadCombo1_SelectedIndexChanged(object o, Telerik.Web.UI.RadComboBoxSelectedIndexChangedEventArgs e)\n{\n    var text1 = RadCombo1.SelectedValue;\n}\n</code></pre>\n\n<p>RadCombo1.SelectedValue is null irrespective of any value selected. Can anyone please help me? Thanks!</p>\n"}, {"tags": ["c#", "excel", "vsto", "add-in", "excel-addins"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1535700114, "post_id": 51975002, "comment_id": 91171292, "body": "Hi, do you need any assistance with my answer?"}, {"owner": {"reputation": 145, "user_id": 6934044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/273f5ab5a7552fcaf5eb200adfa16a34?s=128&d=identicon&r=PG&f=1", "display_name": "Yang Wang", "link": "https://stackoverflow.com/users/6934044/yang-wang"}, "reply_to_user": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1535761638, "post_id": 51975002, "comment_id": 91198998, "body": "@JeremyThompson, thanks a lot for your answer. However, my wife just delivered our baby this week. It was totally a mess these days. I will try your suggestions ASAP and get back to you soon."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 6934044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/273f5ab5a7552fcaf5eb200adfa16a34?s=128&d=identicon&r=PG&f=1", "display_name": "Yang Wang", "link": "https://stackoverflow.com/users/6934044/yang-wang"}, "edited": false, "score": 0, "creation_date": 1535401566, "post_id": 51996474, "comment_id": 91043996, "body": "Thanks for your suggestion. I have tried but it doesn&#39;t work. If I run the Excel Automation add-in first, both two functions work well, then I run the COM add-in, the same error &quot;Type-mismatch&quot; for the second function. However, when I run the COM add-in first, the second function directly shows the error &quot;Invalid procedure call or argument&quot;. Then I run the Excel automation add-in, the second function shows the error &quot;Type-mismatch&quot; again."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 0, "last_activity_date": 1535075758, "creation_date": 1535075758, "answer_id": 51996474, "question_id": 51975002, "link": "https://stackoverflow.com/questions/51975002/optional-argument-of-com-add-in-vs-automation-add-in-written-in-c/51996474#51996474", "title": "Optional Argument of COM Add-in vs Automation Add-in Written in C#", "body": "<p>This is a total stab in the dark, but can you create overloaded versions of the method to mimic the way you would have accomplished this before C# had optional parameters and see if that would work?</p>\n\n<pre><code>public int TestAddExcel(int a, int b)\n{\n    return a + b;\n}\n\npublic int TestAddExcel(int a)\n{\n    return a + 1;\n}\n\npublic int TestAddExcel()\n{\n    return 2;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1535471202, "post_id": 52050257, "comment_id": 91073895, "body": "Hi Jeremy, I thought that Visual Studio did all the registering on the machine when created using the &#39;Excel Add-In&#39; project type(been a while since I created any such work)... I wonder if OP will solve the issue with the function call with no parameters."}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1535497108, "post_id": 52050257, "comment_id": 91084806, "body": "Under the hood Visual Studio uses Regasm to do the registering, see the comments in the linked answer. I&#39;m sure OP will have luck borrowing from my example :)"}, {"owner": {"reputation": 145, "user_id": 6934044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/273f5ab5a7552fcaf5eb200adfa16a34?s=128&d=identicon&r=PG&f=1", "display_name": "Yang Wang", "link": "https://stackoverflow.com/users/6934044/yang-wang"}, "edited": false, "score": 0, "creation_date": 1535829465, "post_id": 52050257, "comment_id": 91213276, "body": "@JeremyThompson, thanks a lot for your suggestion. Both of your solutions work very well. But I am still a little wondering what is the rationale behind this? Just as MacroMarc mentioned, it will automatically register by VS itself."}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1535936164, "post_id": 52050257, "comment_id": 91234022, "body": "The Excel Add-In <code>TestVBA</code> registers itself on build, but you need to tick the Register for COM checkbox for the Class Library <code>TestExcel</code>. Without it, it isn&#39;t visible in the VB Editors References listbox. So something to do with being discovered."}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1535988009, "post_id": 52050257, "comment_id": 91255267, "body": "If you guys want to go further, quickly run ProcessMonitor while it happens. Cheers"}], "tags": [], "owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "is_accepted": true, "score": 4, "last_activity_date": 1535996551, "last_edit_date": 1535996551, "creation_date": 1535431514, "answer_id": 52050257, "question_id": 51975002, "link": "https://stackoverflow.com/questions/51975002/optional-argument-of-com-add-in-vs-automation-add-in-written-in-c/52050257#52050257", "title": "Optional Argument of COM Add-in vs Automation Add-in Written in C#", "body": "<p>I am not sure how you Referenced the class library without Registering for COM?  I see now, you're using Late Binding. I didnt know you could do that (didn't think it would let you) <em>and</em> suspect that is the problem, it also matches the <code>Type mismatch</code> error.</p>\n\n<p>Follow the second solution in my <a href=\"https://stackoverflow.com/a/39199922/495455\">canonical answer here on the 3 methods to call .Net from Excel or VBA</a> and make sure you <strong>Register for COM</strong>:</p>\n\n<blockquote>\n  <p>Click on the Build tab and check the check box that says \u201cRegister for COM Interop\u201d.  At this point you have an extra step if you are running on Windows Vista or higher.  Visual Studio has to be run with administrator privileges to register for COM Interop.  Save your project and exit Visual Studio.  Then find Visual Studio in the Start menu and right click on it and choose \u201cRun as Administrator\u201d.  Reopen your project in Visual Studio.  Then choose \u201cBuild\u201d to build the add-in. </p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/xJ9xl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xJ9xl.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Optionally if the above doesn't work, follow the third solution in my answer and reference the Automation Add-In and use Early Binding, I've tested this and it works perfectly:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZjyzF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZjyzF.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TestVBA1_Click()\n\nDim addIn As COMAddIn\nDim TesthObj As Object\n\nSet addIn = Application.COMAddIns(\"TestVBA\")\nSet TestObj = addIn.Object\n\nDebug.Print TestObj.TestAddVBA(2, 3)\nDebug.Print TestObj.TestAddVBA()\n\n\nDim dotNetClass As TestExcel.TestExcel\nSet dotNetClass = New TestExcel.TestExcel\n\nDebug.Print dotNetClass.TestAddExcel(7, 3)\nDebug.Print dotNetClass.TestAddExcel()\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6934044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/273f5ab5a7552fcaf5eb200adfa16a34?s=128&d=identicon&r=PG&f=1", "display_name": "Yang Wang", "link": "https://stackoverflow.com/users/6934044/yang-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 3, "accepted_answer_id": 52050257, "answer_count": 2, "score": 6, "last_activity_date": 1535996551, "creation_date": 1534971366, "last_edit_date": 1535434843, "question_id": 51975002, "link": "https://stackoverflow.com/questions/51975002/optional-argument-of-com-add-in-vs-automation-add-in-written-in-c", "title": "Optional Argument of COM Add-in vs Automation Add-in Written in C#", "body": "<p>I am working on a library of COM Add-in and Excel Automation Add-in, whose core codes are written in C#. I'd like to set an optional argument for the function and I know that this is legal for both C# and VBA, and even Excel WorksheetFunction. But I find that finally the optional argument works exclusively for COM and Automation add-in, meaning that if one add-in is run first, then works well but the optional argument of the other one will not work.</p>\n\n<p>Below please see the example:</p>\n\n<p>In the VS 2013 solution, I have two projects: one is called <code>TestVBA</code> and another one is called <code>TestExcel</code>.</p>\n\n<p><code>TestVBA</code> is for the COM add-in and built through the \"Excel 2013 Add-in\" and there are two <code>.cs</code> files:</p>\n\n<ol>\n<li><code>ThisAddIn.cs</code></li>\n</ol>\n\n<p>This file is generated automatically and modified a little bit. The codes are</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Xml.Linq;\nusing Excel = Microsoft.Office.Interop.Excel;\nusing Office = Microsoft.Office.Core;\nusing Microsoft.Office.Tools.Excel;\n\nnamespace TestVBA\n{\n    public partial class ThisAddIn\n    {\n        private void ThisAddIn_Startup(object sender, System.EventArgs e)\n        {\n        }\n\n        private void ThisAddIn_Shutdown(object sender, System.EventArgs e)\n        {\n        }\n\n        private ExcelVBA oExcelVBA;\n\n        protected override object RequestComAddInAutomationService()\n        {\n            if (oExcelVBA == null)\n            {\n                oExcelVBA = new ExcelVBA();\n            }\n            return oExcelVBA;\n        }\n        #region VSTO generated code\n\n        /// &lt;summary&gt;\n        /// Required method for Designer support - do not modify\n        /// the contents of this method with the code editor.\n        /// &lt;/summary&gt;\n        private void InternalStartup()\n        {\n            this.Startup += new System.EventHandler(ThisAddIn_Startup);\n            this.Shutdown += new System.EventHandler(ThisAddIn_Shutdown);\n        }\n\n        #endregion\n    }\n}\n</code></pre>\n\n<ol start=\"2\">\n<li><code>TestVBA.cs</code></li>\n</ol>\n\n<p>This file is the main calculation file of COM add-in. The codes are</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nusing System.Runtime.InteropServices;\nusing Excel = Microsoft.Office.Interop.Excel;\n\nusing System.Reflection;\n\n\nnamespace TestVBA\n{\n    [ComVisible(true)]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    public class ExcelVBA\n    {\n        public int TestAddVBA(int a = 1, int b = 1)\n        {\n            return a + b;\n        }\n    }\n}\n</code></pre>\n\n<p>Another <code>TestExcel</code> is for the Excel Automation add-in and built through the C# \"Class Library\" and there are two <code>.cs</code> files either:</p>\n\n<ol>\n<li><code>BaseUDF.cs</code></li>\n</ol>\n\n<p>This file defines the decoration of two attributes. The codes are</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nusing System.Runtime.InteropServices;\nusing Microsoft.Win32;\n\nnamespace BaseUDF\n{\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    [ComVisible(true)]\n    public abstract class BaseUDF\n    {\n        [ComRegisterFunctionAttribute]\n        public static void RegisterFunction(Type type)\n        {\n            // Add the \"Programmable\" registry key under CLSID.\n            Registry.ClassesRoot.CreateSubKey(\n              GetSubKeyName(type, \"Programmable\"));\n            // Register the full path to mscoree.dll which makes Excel happier.\n            RegistryKey key = Registry.ClassesRoot.OpenSubKey(\n              GetSubKeyName(type, \"InprocServer32\"), true);\n            key.SetValue(\"\",\n              System.Environment.SystemDirectory + @\"\\mscoree.dll\",\n              RegistryValueKind.String);\n        }\n\n        [ComUnregisterFunctionAttribute]\n        public static void UnregisterFunction(Type type)\n        {\n            // Remove the \"Programmable\" registry key under CLSID.\n            Registry.ClassesRoot.DeleteSubKey(\n              GetSubKeyName(type, \"Programmable\"), false);\n        }\n\n        private static string GetSubKeyName(Type type,\n          string subKeyName)\n        {\n            System.Text.StringBuilder s =\n              new System.Text.StringBuilder();\n            s.Append(@\"CLSID\\{\");\n            s.Append(type.GUID.ToString().ToUpper());\n            s.Append(@\"}\\\");\n            s.Append(subKeyName);\n            return s.ToString();\n        }\n\n        // Hiding these methods from Excel.\n        [ComVisible(false)]\n        public override string ToString()\n        {\n            return base.ToString();\n        }\n\n        [ComVisible(false)]\n        public override bool Equals(object obj)\n        {\n            return base.Equals(obj);\n        }\n\n        [ComVisible(false)]\n        public override int GetHashCode()\n        {\n            return base.GetHashCode();\n        }\n    }\n}\n</code></pre>\n\n<ol start=\"2\">\n<li><code>TestExcel.cs</code></li>\n</ol>\n\n<p>This file is the main calculation file of Excel Automation add-in. The codes are</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nusing Microsoft.Win32;\nusing System.Runtime.InteropServices;\nusing Excel = Microsoft.Office.Interop.Excel;\nusing Extensibility;\n\nnamespace TestExcel\n{\n    [Guid(\"7127696E-AB87-427a-BC85-AB3CBA301CF3\")]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    [ComVisible(true)]\n    public class TestExcel : BaseUDF.BaseUDF\n    {\n        public int TestAddExcel(int a = 1, int b = 1)\n        {\n            return a + b;\n        }\n    }\n}\n</code></pre>\n\n<p>After building, the two add-ins have been registered in the system and in Excel we can use them successfully.</p>\n\n<p>For the Automation add-in, we call them in the spreadsheet as <code>=TestAddExcel(2,3)</code> and <code>=TestAddExcel()</code> both of them work very well and give the right result <code>5</code> and <code>2</code>. However, when I try to call the COM add-in via</p>\n\n<pre><code>Sub TestVBA_Click()\n\nDim addIn As COMAddIn\nDim TesthObj As Object\n\nSet addIn = Application.COMAddIns(\"TestVBA\")\nSet TestObj = addIn.Object\n\nRange(\"Output\").Value2 = TestObj.TestAddVBA(2, 3)\nRange(\"Output\").Offset(1, 0).Value2 = TestObj.TestAddVBA()\n\nEnd Sub\n</code></pre>\n\n<p>The first call with all arguments existing works well, but for the second one with arguments missing shows the error <code>Type mismatch</code>.</p>\n\n<p>The interesting thing is, when I close the test excel file and open it again, this time I test the COM add-in first, still via the above VBA codes, both two calls work very well. Then when I test the two spreadsheet functions which used to work well, only the first one is good, the second one with arguments missing <code>=TestAddExcel()</code> fails with <code>#VALUE!</code>.</p>\n\n<p>It would be very nice if someone can help with this strange issue.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "type-conversion"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1534971239, "post_id": 51974927, "comment_id": 90900386, "body": "I&#39;m not familiar with how Inkscape outputs XAML, but have you tried <a href=\"https://stackoverflow.com/questions/910814/loading-xaml-at-runtime\">XamlReader</a> to load a XAML file at runtime? Could you post the contents of a small example XAML file from Inkscape?"}, {"owner": {"reputation": 1, "user_id": 4259078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515d4ec06c47dc72c2846afe68c7e1f7?s=128&d=identicon&r=PG", "display_name": "Andrii Vdovenko", "link": "https://stackoverflow.com/users/4259078/andrii-vdovenko"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1534971486, "post_id": 51974927, "comment_id": 90900487, "body": "Thank You for idea. Need to pack everything inside one only <code>C#</code> file. That&#39;s why I am going to put whole file in string manually. I played with <code>XamlReader</code>, but can&#39;t let it to read from string."}, {"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1534972043, "post_id": 51974927, "comment_id": 90900718, "body": "Use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.markup.xamlreader.parse?view=netframework-4.7.2#System_Windows_Markup_XamlReader_Parse_System_String_\" rel=\"nofollow noreferrer\">XamlReader.Parse</a>"}, {"owner": {"reputation": 1, "user_id": 4259078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515d4ec06c47dc72c2846afe68c7e1f7?s=128&d=identicon&r=PG", "display_name": "Andrii Vdovenko", "link": "https://stackoverflow.com/users/4259078/andrii-vdovenko"}, "edited": false, "score": 0, "creation_date": 1535018667, "post_id": 51974927, "comment_id": 90915883, "body": "Sorry, still not works for me. Tried it before, trying now, but no result. Can&#39;t find any info, also, about how to convert <code>Canvas</code> to <code>Geometry</code>"}], "owner": {"reputation": 1, "user_id": 4259078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515d4ec06c47dc72c2846afe68c7e1f7?s=128&d=identicon&r=PG", "display_name": "Andrii Vdovenko", "link": "https://stackoverflow.com/users/4259078/andrii-vdovenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "closed_date": 1534971284, "answer_count": 0, "score": 0, "last_activity_date": 1535051022, "creation_date": 1534971062, "last_edit_date": 1535051022, "question_id": 51974927, "link": "https://stackoverflow.com/questions/51974927/how-to-convert-whole-xaml-file-to-system-windows-media-geometry-object", "closed_reason": "Duplicate", "title": "How to convert whole XAML file to System.Windows.Media.Geometry object?", "body": "<p>How to: <code>XAML</code> -> <a href=\"/questions/tagged/c%23\" class=\"post-tag\" title=\"show questions tagged &#39;c#&#39;\" rel=\"tag\">c#</a> <code>System.Windows.Media.Geometry</code> ?</p>\n\n<p>I want to create vector image <em>(for example, in Inkscape)</em>, save it to XAML, than take whole file <em>(from the very first \"&lt;\" symbol to the very last symbol \">\")</em>, put in <a href=\"/questions/tagged/c%23\" class=\"post-tag\" title=\"show questions tagged &#39;c#&#39;\" rel=\"tag\">c#</a> string, and then to make <code>System.Windows.Media.Geometry</code> object.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/40019463/rounded-corners-for-path\">This</a> way is very good, it works perfect:</p>\n\n<pre><code> System.Windows.Media.Geometry g = Geometry.Parse(\"M 263,99 ... Z\");\n</code></pre>\n\n<p>But, it fails <em>(in my hands)</em> with multi-line paths, fills, and other symbols.</p>\n\n<p>UPD:\n</p>\n\n<pre><code>string sourse_xaml_str = \n</code></pre>\n\n<p><code>@\"</code></p>\n\n<pre class=\"lang-xaml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!--This file is compatible with Silverlight--&gt;\n&lt;Canvas xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\" Name=\"svg8\" Width=\"210\" Height=\"297\"&gt;\n  &lt;Canvas.RenderTransform&gt;\n    &lt;TranslateTransform X=\"0\" Y=\"0\"/&gt;\n  &lt;/Canvas.RenderTransform&gt;\n  &lt;Canvas.Resources/&gt;\n  &lt;!--Unknown tag: sodipodi:namedview--&gt;\n  &lt;!--Unknown tag: metadata--&gt;\n  &lt;Canvas Name=\"layer1\"&gt;\n    &lt;Path xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\" Name=\"path10\" Fill=\"#FFFF5555\" StrokeThickness=\"0.26458332\" Data=\"m 74.083331 126.9107 -10.873824 18.802 9.324097 19.61673 -21.241956 -4.53148 -15.775318 14.92964 -2.254427 -21.6026 -19.073781 -10.38971 19.848644 -8.81966 3.987074 -21.35084 14.521563 16.15176 z\"/&gt;\n  &lt;/Canvas&gt;\n&lt;/Canvas&gt;\n</code></pre>\n\n<p><code>\";</code></p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>System.Windows.Media.Geometry top_menu_item_icon = XamlReader.Parse( sourse_xaml_str ) as System.Windows.Media.Geometry;\nConsole.WriteLn( XamlReader.Parse( sourse_xaml_str ).ToString() );\n</code></pre>\n\n<p>Results:</p>\n\n<ol>\n<li><code>top_menu_item_icon</code> == <code>null</code></li>\n<li><code>WriteLn()</code> show this: <code>System.Windows.Controls.Canvas</code> </li>\n</ol>\n\n<p>So, it still not works for me.</p>\n"}, {"tags": ["c#", "xml", "asp.net-mvc"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10261685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc29300f5e49b1feeaf5b4aaad5bd42?s=128&d=identicon&r=PG&f=1", "display_name": "Eicv", "link": "https://stackoverflow.com/users/10261685/eicv"}, "edited": false, "score": 0, "creation_date": 1535033878, "post_id": 51975398, "comment_id": 90925414, "body": "thanks i tried that but it didn&#39;t work either in my case. i am concatenating declaration to xml string and then returning it as  content type xml."}, {"owner": {"reputation": 2355, "user_id": 9918730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Sqil.jpg?s=128&g=1", "display_name": "GoldenAge", "link": "https://stackoverflow.com/users/9918730/goldenage"}, "reply_to_user": {"reputation": 35, "user_id": 10261685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc29300f5e49b1feeaf5b4aaad5bd42?s=128&d=identicon&r=PG&f=1", "display_name": "Eicv", "link": "https://stackoverflow.com/users/10261685/eicv"}, "edited": false, "score": 1, "creation_date": 1535039389, "post_id": 51975398, "comment_id": 90928987, "body": "so maybe try <code>return File(stream, &quot;text&#47;xml&quot;);</code> instead?"}, {"owner": {"reputation": 35, "user_id": 10261685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc29300f5e49b1feeaf5b4aaad5bd42?s=128&d=identicon&r=PG&f=1", "display_name": "Eicv", "link": "https://stackoverflow.com/users/10261685/eicv"}, "edited": false, "score": 0, "creation_date": 1535381646, "post_id": 51975398, "comment_id": 91034601, "body": "Works thanks! I&#39;m not sure why it wouldn&#39;t appear in Chrome but in IE"}, {"owner": {"reputation": 2355, "user_id": 9918730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Sqil.jpg?s=128&g=1", "display_name": "GoldenAge", "link": "https://stackoverflow.com/users/9918730/goldenage"}, "reply_to_user": {"reputation": 35, "user_id": 10261685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc29300f5e49b1feeaf5b4aaad5bd42?s=128&d=identicon&r=PG&f=1", "display_name": "Eicv", "link": "https://stackoverflow.com/users/10261685/eicv"}, "edited": false, "score": 0, "creation_date": 1535407156, "post_id": 51975398, "comment_id": 91045906, "body": "I&#39;m glad I helped :) if you see the result in the IE and not in chrome it&#39;s a matter of the frontend code. Open developer tools in each web browser and check the console log."}], "tags": [], "owner": {"reputation": 2355, "user_id": 9918730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Sqil.jpg?s=128&g=1", "display_name": "GoldenAge", "link": "https://stackoverflow.com/users/9918730/goldenage"}, "is_accepted": true, "score": 2, "last_activity_date": 1534973856, "last_edit_date": 1534973856, "creation_date": 1534973326, "answer_id": 51975398, "question_id": 51974907, "link": "https://stackoverflow.com/questions/51974907/how-do-i-return-xml-with-declaration-using-an-actionresult-in-asp-net-mvc/51975398#51975398", "title": "How do I return Xml with declaration using an ActionResult in ASP.NET MVC?", "body": "<p>Maybe try this:</p>\n\n<pre><code>public IActionResult Index()\n{\n    // you need to convert your xml to string\n    var xmlString = \"xml content..\";\n    return this.Content(xmlString, \"text/xml\");\n}\n</code></pre>\n\n<p>See <a href=\"https://docs.microsoft.com/en-us/previous-versions/aspnet/web-frameworks/dd492713%28v%3dvs.100%29\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/aspnet/web-frameworks/dd492713%28v%3dvs.100%29</a></p>\n"}], "owner": {"reputation": 35, "user_id": 10261685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cc29300f5e49b1feeaf5b4aaad5bd42?s=128&d=identicon&r=PG&f=1", "display_name": "Eicv", "link": "https://stackoverflow.com/users/10261685/eicv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "accepted_answer_id": 51975398, "answer_count": 1, "score": 2, "last_activity_date": 1534980979, "creation_date": 1534970982, "last_edit_date": 1534980979, "question_id": 51974907, "link": "https://stackoverflow.com/questions/51974907/how-do-i-return-xml-with-declaration-using-an-actionresult-in-asp-net-mvc", "title": "How do I return Xml with declaration using an ActionResult in ASP.NET MVC?", "body": "<p>I'm unable to attach a xml declaration while returning xml using Action Result. \nI can see it being included while debugging till line at which it returns xml in below code but doesn't not show up on the web. </p>\n\n<p><strong>What I am doing currently:</strong></p>\n\n<ol>\n<li>Getting Xml from Sql Server using XML PATH.</li>\n<li><p>Returning xml string using <code>XML Reader</code>:</p>\n\n<pre><code>public XmlDocumentResult XmlData()\n{\n    String s = \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\" ?&gt;\" + \"\\n\" +  this.GetData();\n    byte[] encodedString = Encoding.UTF8.GetBytes(s);\n    MemoryStream ms = new MemoryStream(encodedString);\n    ms.Flush();\n    ms.Position = 0;\n    XmlDocument doc = new XmlDocument();\n    doc.Load(ms);           \n    return new XmlDocumentResult { XmlDocument = doc };\n}\n\npublic class XmlDocumentResult : ContentResult\n {\n     public XmlDocument XmlDocument { get; set; }\n\n     public override void ExecuteResult(ControllerContext context)\n     {\n         if (XmlDocument == null)\n             return;\n\n         Content = XmlDocument.OuterXml;\n         ContentType = \"text/xml\";\n         base.ExecuteResult(context);\n     }\n }\n</code></pre></li>\n</ol>\n\n<p><strong>I have tried following code snippets from Stackoverflow:</strong></p>\n\n<pre><code>XmlDeclaration xmldecl;\nxmldecl = xmlDocument.CreateXmlDeclaration(\"1.0\", \"UTF-8\", null);\nXmlElement root = xmlDocument.DocumentElement;\nxmlDocument.InsertBefore(xmldecl, root);\n\n\nXmlNode docNode = xml.CreateXmlDeclaration(\"1.0\", \"UTF-8\", null);\nxml.AppendChild(docNode);\n</code></pre>\n"}, {"tags": ["c#", ".net", ".net-core", "idictionary", "onactionexecuting"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 5, "creation_date": 1534971030, "post_id": 51974888, "comment_id": 90900294, "body": "&quot;Better way of doing this...&quot; Better way of doing what, exactly? You described your solution but not your problem."}, {"owner": {"reputation": 29640, "user_id": 1123123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c4f71e418588524bba4c9c0b3a7d393?s=128&d=identicon&r=PG", "display_name": "Sam I am says Reinstate Monica", "link": "https://stackoverflow.com/users/1123123/sam-i-am-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534971041, "post_id": 51974888, "comment_id": 90900300, "body": "What exactly are you trying to find in ActionArguements?"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1534971045, "post_id": 51974888, "comment_id": 90900302, "body": "Are you guaranteeing that the key (class name) means that there is only ever one of each type of class in the collection? I&#39;m not sure what you are trying to do here..."}], "answers": [{"tags": [], "owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "is_accepted": true, "score": 2, "last_activity_date": 1534972866, "last_edit_date": 1534972866, "creation_date": 1534972383, "answer_id": 51975209, "question_id": 51974888, "link": "https://stackoverflow.com/questions/51974888/how-to-find-a-specific-value-in-an-idictionarystring-object/51975209#51975209", "title": "How to find a specific value in an IDictionary&lt;string, object&gt;?", "body": "<p>Just use <a href=\"https://stackoverflow.com/questions/4015930/when-to-use-cast-and-oftype-in-linq\"><code>OfType&lt;&gt;()</code></a>. You don't even need the key.</p>\n\n<pre><code>public static void Main()\n{\n    var d = new Dictionary&lt;string,object&gt;\n    {\n        { \"string\", \"Foo\" },\n        { \"int\", 123 },\n        { \"MyComplexType\", new MyComplexType { Text = \"Bar\" } }\n    };\n\n    var s = d.Values.OfType&lt;string&gt;().Single();\n    var i = d.Values.OfType&lt;int&gt;().Single();\n    var o = d.Values.OfType&lt;MyComplexType&gt;().Single();\n\n    Console.WriteLine(s);\n    Console.WriteLine(i);\n    Console.WriteLine(o.Text);\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Foo\n123\nBar\n</code></pre>\n\n<p><a href=\"https://dotnetfiddle.net/FSm63p\" rel=\"nofollow noreferrer\">Link to Fiddle</a></p>\n"}], "owner": {"reputation": 123, "user_id": 3614722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d637802c88b3d6d40d8c71c790afa6?s=128&d=identicon&r=PG&f=1", "display_name": "koshi", "link": "https://stackoverflow.com/users/3614722/koshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 0, "accepted_answer_id": 51975209, "answer_count": 1, "score": -3, "last_activity_date": 1535001088, "creation_date": 1534970880, "last_edit_date": 1535001088, "question_id": 51974888, "link": "https://stackoverflow.com/questions/51974888/how-to-find-a-specific-value-in-an-idictionarystring-object", "title": "How to find a specific value in an IDictionary&lt;string, object&gt;?", "body": "<p>This <code>IDictionary&lt;string, object&gt;</code> contains user data I'm logging into mongodb. The issue is the <code>TValue</code> is a complex object. The <code>TKey</code> is simply the class name.</p>\n\n<p>For example:</p>\n\n<pre><code>public class UserData\n{\n    public string FirstName { get; set; }\n    public string LastName  { get; set; }\n    public Admin NewAdmin   { get; set; }\n}    \npublic class Admin\n{\n    public string UserName { get; set; }\n    public string Password { get; set; }\n}\n</code></pre>\n\n<p>Currently, I'm trying to iterate through the <code>Dictionary</code> and compare types but to no avail. Is there a better way of doing this or am I missing the mark?</p>\n\n<pre><code>var argList = new List&lt;object&gt;();\nforeach(KeyValuePair&lt;string, object&gt; kvp in context.ActionArguments)\n{\n    dynamic v = kvp.Value;\n    //..compare types...\n}\n</code></pre>\n"}, {"tags": ["c#", "google-chrome", "settings", "preferences"], "answers": [{"comments": [{"owner": {"reputation": 668, "user_id": 2896780, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/800ce90266574cdc768731d2e6e0c456?s=128&d=identicon&r=PG&f=1", "display_name": "herme 0", "link": "https://stackoverflow.com/users/2896780/herme-0"}, "edited": false, "score": 1, "creation_date": 1535137182, "post_id": 51975049, "comment_id": 90971428, "body": "Not all settings are available as policy; since we need to touch the preference file then we might as well make all modification there. Otherwise, this would have been my preferred approach."}], "tags": [], "owner": {"reputation": 942, "user_id": 10247440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0kwxp.jpg?s=128&g=1", "display_name": "Selmir", "link": "https://stackoverflow.com/users/10247440/selmir"}, "is_accepted": false, "score": 0, "last_activity_date": 1534972047, "last_edit_date": 1534972047, "creation_date": 1534971592, "answer_id": 51975049, "question_id": 51974851, "link": "https://stackoverflow.com/questions/51974851/google-chrome-browser-read-write-settings-in-c/51975049#51975049", "title": "google chrome browser - read/write settings in C#", "body": "<p>Chrome settings are stored in the registry, so <a href=\"https://www.c-sharpcorner.com/UploadFile/f9f215/windows-registry/\" rel=\"nofollow noreferrer\">here</a> to read/write the registry and <a href=\"http://dev.chromium.org/administrators/policy-list-3\" rel=\"nofollow noreferrer\">here</a> for the list of available settings.</p>\n\n<pre><code>RegistryKey key = Registry.CurrentUser.CreateSubKey(@\"SOFTWARE\\OurSettings\"); \n\n/// Reading value \nvar value = key.GetValue(\"Setting1\");\n\n/// Setting value\nkey.SetValue(\"Setting1\", \"This is our setting 1\"); \n</code></pre>\n\n<p>Be aware by Google's warning if you are not developing this for internal use :</p>\n\n<blockquote>\n  <p>These policies are strictly intended to be used to configure instances of Google Chrome internal to your organization. Use of these policies outside of your organization (for example, in a publicly distributed program) is considered malware and will likely be labeled as malware by Google and anti-virus vendors.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 439, "user_id": 4025651, "user_type": "registered", "accept_rate": 3, "profile_image": "https://www.gravatar.com/avatar/53a01f0ec9cc190ff71100da98407b19?s=128&d=identicon&r=PG&f=1", "display_name": "SimonKravis", "link": "https://stackoverflow.com/users/4025651/simonkravis"}, "edited": false, "score": 0, "creation_date": 1575154228, "post_id": 51975062, "comment_id": 104471484, "body": "This file does indeed control Chrome settings, and can be edited but unless syncing with email (which identifies you across Google apps) is turned off, the file will be rewritten each time Chrome is run and your edits will be lost."}], "tags": [], "owner": {"reputation": 864, "user_id": 3131918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb5b9626e23dcabaab24e8689a964ef?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Bhave", "link": "https://stackoverflow.com/users/3131918/aditya-bhave"}, "is_accepted": true, "score": 1, "last_activity_date": 1534971652, "creation_date": 1534971652, "answer_id": 51975062, "question_id": 51974851, "link": "https://stackoverflow.com/questions/51974851/google-chrome-browser-read-write-settings-in-c/51975062#51975062", "title": "google chrome browser - read/write settings in C#", "body": "<p>Check if you can modify the following file.</p>\n\n<p>Location - c:\\Users\\\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Preferences</p>\n\n<p>This file contains a few settings. I have never done this so not sure if you can modify the file. But looks like a good start. Also, not sure if chrome rebuilds the file. (It was updated when I opened chrome while this file was open on my machine). </p>\n"}], "owner": {"reputation": 668, "user_id": 2896780, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/800ce90266574cdc768731d2e6e0c456?s=128&d=identicon&r=PG&f=1", "display_name": "herme 0", "link": "https://stackoverflow.com/users/2896780/herme-0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 51975062, "answer_count": 2, "score": 2, "last_activity_date": 1534972047, "creation_date": 1534970745, "question_id": 51974851, "link": "https://stackoverflow.com/questions/51974851/google-chrome-browser-read-write-settings-in-c", "title": "google chrome browser - read/write settings in C#", "body": "<p>I need to build a console program to read and update the chrome browser setting.</p>\n\n<p>Where should I start?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 481, "user_id": 6713871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d0cf46b08a63241386786e74ae4b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Rollins", "link": "https://stackoverflow.com/users/6713871/chris-rollins"}, "edited": false, "score": 0, "creation_date": 1534970556, "post_id": 51974787, "comment_id": 90900111, "body": "VisualStudio 2017 was released for MacOS last year"}, {"owner": {"reputation": 3833, "user_id": 906357, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/456c9cf9b7e6c61a7037bd5a604769ca?s=128&d=identicon&r=PG", "display_name": "user906357", "link": "https://stackoverflow.com/users/906357/user906357"}, "edited": false, "score": 0, "creation_date": 1534970821, "post_id": 51974787, "comment_id": 90900218, "body": "I was hoping to not need an entire IDE as I&#39;m already compiling in the terminal, but as there are already several responses suggesting VS I will download it."}, {"owner": {"reputation": 481, "user_id": 6713871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d0cf46b08a63241386786e74ae4b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Rollins", "link": "https://stackoverflow.com/users/6713871/chris-rollins"}, "edited": false, "score": 0, "creation_date": 1534971050, "post_id": 51974787, "comment_id": 90900306, "body": "@user906357 then it looks like VSCode is what you want. my bad."}], "answers": [{"tags": [], "owner": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "is_accepted": true, "score": 3, "last_activity_date": 1534970593, "creation_date": 1534970593, "answer_id": 51974817, "question_id": 51974787, "link": "https://stackoverflow.com/questions/51974787/mac-editor-for-c/51974817#51974817", "title": "Mac editor for C#", "body": "<p>What about Visual Studio Code? If that is all you need. VSCode is lightweight (especially compared to the big Visual Studio), is a really great code editor, but lacks all designer functions.</p>\n\n<p><a href=\"https://code.visualstudio.com/download\" rel=\"nofollow noreferrer\">https://code.visualstudio.com/download</a></p>\n"}, {"tags": [], "owner": {"reputation": 481, "user_id": 6713871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d0cf46b08a63241386786e74ae4b1f?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Rollins", "link": "https://stackoverflow.com/users/6713871/chris-rollins"}, "is_accepted": false, "score": 0, "last_activity_date": 1534970700, "creation_date": 1534970700, "answer_id": 51974839, "question_id": 51974787, "link": "https://stackoverflow.com/questions/51974787/mac-editor-for-c/51974839#51974839", "title": "Mac editor for C#", "body": "<p>This is the full blown Visual Studio IDE for mac.\n<a href=\"https://visualstudio.microsoft.com/vs/mac/\" rel=\"nofollow noreferrer\">https://visualstudio.microsoft.com/vs/mac/</a></p>\n"}, {"tags": [], "owner": {"reputation": 8019, "user_id": 440921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/UnEvy.jpg?s=128&g=1", "display_name": "Mark Whitaker", "link": "https://stackoverflow.com/users/440921/mark-whitaker"}, "is_accepted": false, "score": 0, "last_activity_date": 1534971004, "creation_date": 1534971004, "answer_id": 51974910, "question_id": 51974787, "link": "https://stackoverflow.com/questions/51974787/mac-editor-for-c/51974910#51974910", "title": "Mac editor for C#", "body": "<p>Another excellent cross-platform tool, which I use occasionally even on Windows, is <a href=\"https://www.jetbrains.com/rider/\" rel=\"nofollow noreferrer\">JetBrains Rider</a>.</p>\n\n<p>Rider has all the usual excellent IDE features that are familiar across all JetBrains tools (including the best refactoring features out there), and it's a lot faster that Visual Studio + <a href=\"https://www.jetbrains.com/resharper/\" rel=\"nofollow noreferrer\">ReSharper</a>. The main downside is that, unlike Visual Studio and Visual Studio Code, it isn't free, although you can download a 30-day trial.</p>\n"}], "owner": {"reputation": 3833, "user_id": 906357, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/456c9cf9b7e6c61a7037bd5a604769ca?s=128&d=identicon&r=PG", "display_name": "user906357", "link": "https://stackoverflow.com/users/906357/user906357"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "closed_date": 1534972228, "accepted_answer_id": 51974817, "answer_count": 3, "score": -1, "last_activity_date": 1534971004, "creation_date": 1534970466, "question_id": 51974787, "link": "https://stackoverflow.com/questions/51974787/mac-editor-for-c", "closed_reason": "Not suitable for this site", "title": "Mac editor for C#", "body": "<p>Does anyone know of an editor for MacOS that will allow me to see the syntax coloring and automatically perform the indentations for C#? I am compiling and running in the terminal already so I just need an editor. I am currently using Xcode, but there is no coloring or indentation unless I manually add it.</p>\n"}, {"tags": ["c#", "sql-server", "crystal-reports", "report"], "comments": [{"owner": {"reputation": 4517, "user_id": 1970497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OzVV8.jpg?s=128&g=1", "display_name": "Shawn", "link": "https://stackoverflow.com/users/1970497/shawn"}, "edited": false, "score": 0, "creation_date": 1534970948, "post_id": 51974764, "comment_id": 90900262, "body": "<code>CAST</code> those values to strings on your query."}, {"owner": {"reputation": 7742, "user_id": 3142139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kKrve.jpg?s=128&g=1", "display_name": "M.Hassan", "link": "https://stackoverflow.com/users/3142139/m-hassan"}, "edited": false, "score": 0, "creation_date": 1534974521, "post_id": 51974764, "comment_id": 90901663, "body": "Have a look <a href=\"https://archive.sap.com/discussions/thread/3236857\" rel=\"nofollow noreferrer\">archive.sap.com/discussions/thread/3236857</a>"}, {"owner": {"reputation": 1695, "user_id": 7982548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VHqYU.jpg?s=128&g=1", "display_name": "CR241", "link": "https://stackoverflow.com/users/7982548/cr241"}, "edited": false, "score": 0, "creation_date": 1534975866, "post_id": 51974764, "comment_id": 90902096, "body": "check this link: <a href=\"https://stackoverflow.com/questions/19031669/time-datatype-not-showing-in-the-crystal-report-vs2010\" title=\"time datatype not showing in the crystal report vs2010\">stackoverflow.com/questions/19031669/&hellip;</a>"}], "owner": {"reputation": 19, "user_id": 2100454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23fd8cc7328cef326954e15ddb07d4a6?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/2100454/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534970962, "creation_date": 1534970391, "last_edit_date": 1534970962, "question_id": 51974764, "link": "https://stackoverflow.com/questions/51974764/sql-server-column-type-time7-will-not-show-up-in-crystal-reports", "title": "SQL Server column type time(7) will not show up in Crystal Reports", "body": "<p>I am new to Crystal Reports. As I am bringing tables from my SQL Server database over to use in my report, I am noticing that any column of <code>Time(7)</code> type does not show up as a column in my Crystal Reports. These tables I am using have a lot of <code>time(7)</code> columns.</p>\n\n<p>Is there a way to bring those column types into Crystal Reports?</p>\n\n<p>I am using Visual Studio 2017 enterprise. I have just added on the latest CR_13_22 release.</p>\n\n<p>Any clues?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 1, "creation_date": 1534970684, "post_id": 51974723, "comment_id": 90900163, "body": "I think you&#39;re reading the pointer address, not the value stored there. Perhaps you want <code>Marshall.ReadInt32</code> instead?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10173692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QKSqqsmW9UQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7gkiZJIa3fbmgP6DuR0x4H14UEQ/mo/photo.jpg?sz=128", "display_name": "indev", "link": "https://stackoverflow.com/users/10173692/indev"}, "edited": false, "score": 0, "creation_date": 1534971832, "post_id": 51975014, "comment_id": 90900618, "body": "Thank you very much, you made my day. Everything worked."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3188639"}, "is_accepted": true, "score": 0, "last_activity_date": 1534971444, "creation_date": 1534971444, "answer_id": 51975014, "question_id": 51974723, "link": "https://stackoverflow.com/questions/51974723/c-operator-cannot-be-applied-to-operands-of-type-intptr-and-int/51975014#51975014", "title": "C# Operator &#39;+&#39; cannot be applied to operands of type &#39;IntPtr&#39; and &#39;int&#39;", "body": "<p>If you look at the source for IntPtr for version 4.7.2(<a href=\"https://referencesource.microsoft.com/#mscorlib/system/intptr.cs\" rel=\"nofollow noreferrer\">https://referencesource.microsoft.com/#mscorlib/system/intptr.cs</a>) you'll see that there's an implementation of the operator +</p>\n\n<pre><code>public static IntPtr operator +(IntPtr pointer, int offset) \n    {\n        #if WIN32\n            return new IntPtr(pointer.ToInt32() + offset);\n        #else\n            return new IntPtr(pointer.ToInt64() + offset);\n        #endif\n    }\n</code></pre>\n\n<p>I can't find the implementation for the version 3.5, but I guess that this operator is not implemented in earlier versions.</p>\n\n<p>You can make it work using the code for the operator +, like this:</p>\n\n<pre><code>    static void Main(string[] args)\n    {\n        IntPtr vaultGuids = IntPtr.Zero;\n        int i = 10;\n\n// Works in .net 4.0\n        var vauldIdPtr = vaultGuids + i * Marshal.SizeOf(typeof(Guid));\n        Console.WriteLine(vauldIdPtr);\n\n// works in .net 4.0 and 3.5\n        var ptr2 = new IntPtr(vaultGuids.ToInt32() + i * Marshal.SizeOf(typeof(Guid)));\n        Console.WriteLine(ptr2);\n    }\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10173692, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QKSqqsmW9UQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r7gkiZJIa3fbmgP6DuR0x4H14UEQ/mo/photo.jpg?sz=128", "display_name": "indev", "link": "https://stackoverflow.com/users/10173692/indev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 509, "favorite_count": 0, "accepted_answer_id": 51975014, "answer_count": 1, "score": 1, "last_activity_date": 1534971444, "creation_date": 1534970168, "last_edit_date": 1534970637, "question_id": 51974723, "link": "https://stackoverflow.com/questions/51974723/c-operator-cannot-be-applied-to-operands-of-type-intptr-and-int", "title": "C# Operator &#39;+&#39; cannot be applied to operands of type &#39;IntPtr&#39; and &#39;int&#39;", "body": "<p>I'm not a big connoisseur of C #. I would be very grateful if anyone could help me with this:</p>\n\n<p>I have the function of recovering the \"log \\ password\" from the Windows store.</p>\n\n<p>If I compile in a <strong>.Net 4.0</strong> environment, then everything is fine and everything works.</p>\n\n<p>But I would like to make this function and the program as a whole for <strong>.Net 3.5</strong> and here I get an error in these lines:</p>\n\n<pre><code>var vaultIdPtr = vaultGuids + i * Marshal.SizeOf(typeof(Guid));\n\nvar itemPtr = items + i * Marshal.SizeOf(typeof(VAULT_ITEM_W8));\n</code></pre>\n\n<p>and so on</p>\n\n<p>CS0019  C# Operator '+' cannot be applied to operands of type 'IntPtr' and 'int'</p>\n\n<pre><code> public static List&lt;RecoveredAccount&gt; ReadVaultPasswords()\n    {\n\n        List&lt;RecoveredAccount&gt; ReadVault = new List&lt;RecoveredAccount&gt;();\n\n        if (!(Environment.OSVersion.Version.Major &gt; 6 || (Environment.OSVersion.Version.Major == 6 &amp;&amp; Environment.OSVersion.Version.Minor &gt;= 1)))\n        {\n            // continue;\n        }\n\n        // var Vault_WebCredential_ID = Guid.Parse(\"3CCD5499-87A8-4B10-A215-608888DD3B55\");\n\n        Guid Vault_WebCredential_ID = new Guid(\"3CCD5499-87A8-4B10-A215-608888DD3B55\");\n\n        const uint ERROR_SUCCESS = 0;\n        const uint VAULT_ENUMERATE_ALL_ITEMS = 512;\n\n        bool isWin8 = Environment.OSVersion.Version.Major == 6 &amp;&amp; Environment.OSVersion.Version.Minor &gt; 1;\n\n        int vaultCount;\n        IntPtr vaultGuids = IntPtr.Zero;\n        try\n        {\n            if (VaultEnumerateVaults(0, out vaultCount, out vaultGuids) == ERROR_SUCCESS)\n            {\n                for (var i = 0; i &lt; vaultCount; ++i)\n                {\n                    IntPtr vault = IntPtr.Zero;\n                    try\n                    {\n                        var vaultIdPtr = vaultGuids + i * Marshal.SizeOf(typeof(Guid));\n\n\n                        if (VaultOpenVault(vaultIdPtr, 0, out vault) == ERROR_SUCCESS)\n                        {\n                            int itemCount;\n                            IntPtr items = IntPtr.Zero;\n                            try\n                            {\n                                if (VaultEnumerateItems(vault, VAULT_ENUMERATE_ALL_ITEMS, out itemCount, out items) == ERROR_SUCCESS)\n                                {\n                                    for (var j = 0; j &lt; itemCount; ++j)\n                                    {\n                                        string host;\n                                        string username;\n                                        string password = string.Empty;\n                                        DateTime date = DateTime.Now;\n                                        if (isWin8)\n                                        {\n                                            var itemPtr = items + i * Marshal.SizeOf(typeof(VAULT_ITEM_W8));\n\n\n                                            var item = (VAULT_ITEM_W8)Marshal.PtrToStructure(itemPtr, typeof(VAULT_ITEM_W8));\n                                            if (!Vault_WebCredential_ID.Equals(new Guid(item.SchemaId)))\n                                            {\n                                                continue;\n                                            } ...etc\n\n\n    [DllImport(VAULTCLI_DLL, CallingConvention = CallingConvention.StdCall)]\n    private static extern uint VaultEnumerateVaults(uint dwFlags, out int VaultsCount, out IntPtr ppVaultGuids);\n\n    [DllImport(VAULTCLI_DLL, CallingConvention = CallingConvention.StdCall)]\n    private static extern uint VaultEnumerateItems(IntPtr pVaultHandle, uint dwFlags, out int ItemsCount, out IntPtr ppItems);\n\n    [DllImport(VAULTCLI_DLL, CallingConvention = CallingConvention.StdCall, EntryPoint = \"VaultGetItem\")]\n    private static extern uint VaultGetItem7(IntPtr pVaultHandle, IntPtr pSchemaId, IntPtr pResource, IntPtr pIdentity, IntPtr hwndOwner, uint dwFlags, out IntPtr ppItems);\n\n    [DllImport(VAULTCLI_DLL, CallingConvention = CallingConvention.StdCall, EntryPoint = \"VaultGetItem\")]\n    private static extern uint VaultGetItem8(IntPtr pVaultHandle, IntPtr pSchemaId, IntPtr pResource, IntPtr pIdentity, IntPtr pPackageSid, IntPtr hwndOwner, uint dwFlags, out IntPtr ppItems);\n\n    [DllImport(VAULTCLI_DLL, CallingConvention = CallingConvention.StdCall)]\n    private static extern uint VaultOpenVault(IntPtr pVaultId, uint dwFlags, out IntPtr pVaultHandle);\n\n    [DllImport(VAULTCLI_DLL, CallingConvention = CallingConvention.StdCall)]\n    private static extern uint VaultCloseVault(IntPtr pVaultHandle);\n\n    [DllImport(VAULTCLI_DLL, CallingConvention = CallingConvention.StdCall)]\n    private static extern uint VaultFree(IntPtr pMemory);\n</code></pre>\n"}, {"tags": ["c#", "automapper", ".net-standard-2.0"], "comments": [{"owner": {"reputation": 1100, "user_id": 3937941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5642931c64fb512106e59b6ba5989a5f?s=128&d=identicon&r=PG", "display_name": "Zysce", "link": "https://stackoverflow.com/users/3937941/zysce"}, "edited": false, "score": 0, "creation_date": 1534970113, "post_id": 51974641, "comment_id": 90899908, "body": "What is the the configuration of Autofac ?"}, {"owner": {"reputation": 659, "user_id": 217981, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/42y8z.jpg?s=128&g=1", "display_name": "Eugene Niemand", "link": "https://stackoverflow.com/users/217981/eugene-niemand"}, "reply_to_user": {"reputation": 1100, "user_id": 3937941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5642931c64fb512106e59b6ba5989a5f?s=128&d=identicon&r=PG", "display_name": "Zysce", "link": "https://stackoverflow.com/users/3937941/zysce"}, "edited": false, "score": 0, "creation_date": 1534970227, "post_id": 51974641, "comment_id": 90899967, "body": "Sorry this is actually an AutoMapper issue I got the library names mixed up"}, {"owner": {"reputation": 1100, "user_id": 3937941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5642931c64fb512106e59b6ba5989a5f?s=128&d=identicon&r=PG", "display_name": "Zysce", "link": "https://stackoverflow.com/users/3937941/zysce"}, "edited": false, "score": 0, "creation_date": 1534970282, "post_id": 51974641, "comment_id": 90899993, "body": "You map a class to an interface. It can&#39;t instantiate the interface. Do you have an implementation of this interface ?"}, {"owner": {"reputation": 659, "user_id": 217981, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/42y8z.jpg?s=128&g=1", "display_name": "Eugene Niemand", "link": "https://stackoverflow.com/users/217981/eugene-niemand"}, "reply_to_user": {"reputation": 1100, "user_id": 3937941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5642931c64fb512106e59b6ba5989a5f?s=128&d=identicon&r=PG", "display_name": "Zysce", "link": "https://stackoverflow.com/users/3937941/zysce"}, "edited": false, "score": 0, "creation_date": 1534970361, "post_id": 51974641, "comment_id": 90900025, "body": "But why would the unit tests work but calling the same code from UWP raise an exception?"}, {"owner": {"reputation": 1100, "user_id": 3937941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5642931c64fb512106e59b6ba5989a5f?s=128&d=identicon&r=PG", "display_name": "Zysce", "link": "https://stackoverflow.com/users/3937941/zysce"}, "edited": false, "score": 0, "creation_date": 1534970399, "post_id": 51974641, "comment_id": 90900048, "body": "Do you use stub or change the context in the unit tests ?"}, {"owner": {"reputation": 659, "user_id": 217981, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/42y8z.jpg?s=128&g=1", "display_name": "Eugene Niemand", "link": "https://stackoverflow.com/users/217981/eugene-niemand"}, "reply_to_user": {"reputation": 1100, "user_id": 3937941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5642931c64fb512106e59b6ba5989a5f?s=128&d=identicon&r=PG", "display_name": "Zysce", "link": "https://stackoverflow.com/users/3937941/zysce"}, "edited": false, "score": 0, "creation_date": 1534970767, "post_id": 51974641, "comment_id": 90900197, "body": "Not at all, I load the same json from disk and deserialise into the DTO then call the ToSettings method on the exact same DTO. In the tests it works but from UWP I get an exception. Also your comment about mapping to an Interface you will notice in the config I&#39;m using the ConstructUsing and a class that implements the corresponding interface."}, {"owner": {"reputation": 1745, "user_id": 3086836, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/AHhRH.jpg?s=128&g=1", "display_name": "Aman B", "link": "https://stackoverflow.com/users/3086836/aman-b"}, "edited": false, "score": 0, "creation_date": 1534971674, "post_id": 51974641, "comment_id": 90900556, "body": "@EugeneNiemand never mind. just saw the gist"}, {"owner": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 0, "creation_date": 1534998944, "post_id": 51974641, "comment_id": 90906499, "body": "I&#39;ve run your code and I don&#39;t see it, so a real repro would be nice. The way this code looks I&#39;m wondering how can you ensure that Initialize is only called once."}, {"owner": {"reputation": 659, "user_id": 217981, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/42y8z.jpg?s=128&g=1", "display_name": "Eugene Niemand", "link": "https://stackoverflow.com/users/217981/eugene-niemand"}, "reply_to_user": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 0, "creation_date": 1534999515, "post_id": 51974641, "comment_id": 90906603, "body": "@lucian what do you mean the initialize is only called once? surely this is scope to the method and can run multiple times. I know the code runs as I said it works from my tests but from the UWP side it fails"}, {"owner": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 0, "creation_date": 1535001592, "post_id": 51974641, "comment_id": 90907192, "body": "That&#39;s broken. Initialize should be only called once per appdomain. Newer versions throw when calling it twice. You should upgrade."}], "owner": {"reputation": 659, "user_id": 217981, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/42y8z.jpg?s=128&g=1", "display_name": "Eugene Niemand", "link": "https://stackoverflow.com/users/217981/eugene-niemand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 426, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1534970358, "creation_date": 1534969753, "last_edit_date": 1534970358, "question_id": 51974641, "link": "https://stackoverflow.com/questions/51974641/cannot-create-an-instance-of-interface-type", "title": "Cannot create an instance of interface type", "body": "<p>I'm getting an error when trying to map a DTO to an Object and I'm not sure why. </p>\n\n<p>I created NUnit tests against my libraries which are all .NetStandard 2.0 and it all works and tests are passing. </p>\n\n<p>Please <a href=\"https://gist.github.com/eugeneniemand/80ec6926494f02b9539944c9db4cff5d\" rel=\"nofollow noreferrer\">see this gist</a> (please note these are just grouped together for illustrative purposes, my code is actually spread across different files and projects) </p>\n\n<p>Now here is the problem, unit tests pass however when I call the ToSettings method with the exact same values for the parameters etc from my UWP app I get an error on the two lines where I do the mapping </p>\n\n<pre><code>settings = mapper.Map&lt;SettingsDto, ...&gt;(dto);\n</code></pre>\n\n<p>This is the Exception for NZ</p>\n\n<pre><code>System.ArgumentException: Cannot create an instance of interface type \nMyLifePlan.Interfaces.ISettings_NZ.\nParameter name: type\n at lambda_method(Closure , SettingsDto , ISettings_NZ , ResolutionContext )\n at AutoMapper.Mapper.AutoMapper.IMapper.Map[TSource,TDestination](TSource source)\n at MyLifePlan.Model.Converters.ToSettings(SettingsDto dto)\n</code></pre>\n\n<p>I get something very similar for UK but on the TaxBracket</p>\n"}, {"tags": ["c#", "asp.net-core", "asp.net-core-2.0"], "comments": [{"owner": {"reputation": 5421, "user_id": 504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e3af512b76d08790c8a9c6c9bce18b?s=128&d=identicon&r=PG", "display_name": "Maverik", "link": "https://stackoverflow.com/users/504757/maverik"}, "edited": false, "score": 1, "creation_date": 1534970399, "post_id": 51974625, "comment_id": 90900050, "body": "I&#39;m not sure if there is a problem. The last bit of code you&#39;ve written is valid. There&#39;s no obligation to use the parameter passed in by Action, you could just ignore it and use myoptions from closure like you&#39;ve written."}], "answers": [{"comments": [{"owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 0, "creation_date": 1534972712, "post_id": 51975008, "comment_id": 90900955, "body": "If you didn&#39;t alter the code of <i>AddAsResourceServer</i>, this simply CANNOT work. You only change the object reference stored in parameter <i>a</i> of the lambda function, what has no effect on the object reference held by the caller method."}], "tags": [], "owner": {"reputation": 1626, "user_id": 4206735, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bccfa766f0da76e534334083c87d6033?s=128&d=identicon&r=PG", "display_name": "christopher clark", "link": "https://stackoverflow.com/users/4206735/christopher-clark"}, "is_accepted": false, "score": -1, "last_activity_date": 1534971406, "creation_date": 1534971406, "answer_id": 51975008, "question_id": 51974625, "link": "https://stackoverflow.com/questions/51974625/passing-an-instance-of-an-object-to-a-method-that-takes-an-action-as-parameter/51975008#51975008", "title": "Passing an Instance of an Object to a Method that takes an Action&lt;&gt; as Parameter", "body": "<p>I tried many patterns, it wasn't until I hovered over <code>a</code> in the method to realize that it wasnt of type <code>Action&lt;AuthMiddlewareOptions&gt;</code>, but it was in fact <code>AuthMiddleWareOptions</code>. so this very simple assignment worked!</p>\n\n<pre><code>services.AddAsResourceServer(a =&gt; a = myoptions);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 283, "user_id": 2417186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16a3103a71039ad53e9ffa430c20de2?s=128&d=identicon&r=PG", "display_name": "kipy", "link": "https://stackoverflow.com/users/2417186/kipy"}, "reply_to_user": {"reputation": 1626, "user_id": 4206735, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bccfa766f0da76e534334083c87d6033?s=128&d=identicon&r=PG", "display_name": "christopher clark", "link": "https://stackoverflow.com/users/4206735/christopher-clark"}, "edited": false, "score": 0, "creation_date": 1534971836, "post_id": 51975026, "comment_id": 90900619, "body": "OK nice to see you solved your problem, but I think I don&#39;t deserve the &quot;-1&quot; as I answered your exact question wich is &quot;Passing an Instance of an Object to a Method that takes an Action&lt;&gt; as Parameter&quot;..."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1558301436, "post_id": 51975026, "comment_id": 99045448, "body": "@kipy: you don&#39;t know who downvoted you, and it is best not to try to guess. Voting here is anonymous by design (except to Stack Overflow database admins)."}, {"owner": {"reputation": 283, "user_id": 2417186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16a3103a71039ad53e9ffa430c20de2?s=128&d=identicon&r=PG", "display_name": "kipy", "link": "https://stackoverflow.com/users/2417186/kipy"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1558480794, "post_id": 51975026, "comment_id": 99113207, "body": "@halfer : Yes, you&#39;re right. I just wasn&#39;t familiar enough with SO in that time :)"}], "tags": [], "owner": {"reputation": 283, "user_id": 2417186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b16a3103a71039ad53e9ffa430c20de2?s=128&d=identicon&r=PG", "display_name": "kipy", "link": "https://stackoverflow.com/users/2417186/kipy"}, "is_accepted": false, "score": -1, "last_activity_date": 1534971954, "last_edit_date": 1534971954, "creation_date": 1534971483, "answer_id": 51975026, "question_id": 51974625, "link": "https://stackoverflow.com/questions/51974625/passing-an-instance-of-an-object-to-a-method-that-takes-an-action-as-parameter/51975026#51975026", "title": "Passing an Instance of an Object to a Method that takes an Action&lt;&gt; as Parameter", "body": "<p>Quick answer to your question \"Passing an Instance of an Object to a Method that takes an Action&lt;> as Parameter\" is \"no, you can't\"</p>\n\n<p>But as a workaround, you could simply make a deepclone of your object, to swap the properties of the \"inner\" options.</p>\n\n<p>Something like this :</p>\n\n<pre><code>static class Copy\n{\n    public static void ObjectToAnother&lt;T&gt;(T source, T target)\n    {\n        foreach (var sourceProp in source.GetType().GetProperties())\n        {\n            var targetProp = target.GetType().GetProperty(sourceProp.Name);\n            targetProp.SetValue(target, sourceProp.GetValue(source, null), null);\n        }\n    }\n}\n</code></pre>\n\n<p>And you could use that like this :</p>\n\n<pre><code>var obj = new Obj();\nFoo.Bar((a) =&gt;\n{\n    Copy.ObjectToAnother(a, obj);\n});\n</code></pre>\n\n<p>It should work</p>\n"}, {"tags": [], "owner": {"reputation": 14805, "user_id": 2441442, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/0Aevu.jpg?s=128&g=1", "display_name": "Christian Gollhardt", "link": "https://stackoverflow.com/users/2441442/christian-gollhardt"}, "is_accepted": false, "score": 0, "last_activity_date": 1534972812, "creation_date": 1534972812, "answer_id": 51975305, "question_id": 51974625, "link": "https://stackoverflow.com/questions/51974625/passing-an-instance-of-an-object-to-a-method-that-takes-an-action-as-parameter/51975305#51975305", "title": "Passing an Instance of an Object to a Method that takes an Action&lt;&gt; as Parameter", "body": "<p>You need to do it the other way arround.</p>\n\n<p>I use for example the <code>AddAuthorization</code> since I do not find your method:</p>\n\n<pre><code>services.AddAuthorization(c =&gt;\n{\n    c.DefaultPolicy = null;\n});\n</code></pre>\n\n<p>This can be configured using the following method:</p>\n\n<pre><code>public static void Config(AuthorizationOptions configure, IConfiguration configuration)\n{\n    configure.DefaultPolicy = null;\n    //Configuration.Bind(\"AuthMiddlewareOptions\", myoptions);\n}\n</code></pre>\n\n<p>That way you can do:</p>\n\n<pre><code>services.AddAuthorization(c =&gt; Config(c, Configuration));\n</code></pre>\n\n<p>The problem is, that in these <code>Action&lt;T&gt;</code> methods you get the object <code>T</code>, which is already instantiated. So you need to copy the custom created object to it. With above we change the API, so it is configured on the correct object.</p>\n"}, {"comments": [{"owner": {"reputation": 1626, "user_id": 4206735, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bccfa766f0da76e534334083c87d6033?s=128&d=identicon&r=PG", "display_name": "christopher clark", "link": "https://stackoverflow.com/users/4206735/christopher-clark"}, "edited": false, "score": 0, "creation_date": 1535038256, "post_id": 51975385, "comment_id": 90928309, "body": "I am not sure I understand what you are saying, I am not trying to change the <code>AuthMiddlewareOptions</code> object. I just want to use it as is, passed to the ``AddAsResourceServer` method. &quot;Special Things&quot; was just a placeholder for what I needed to do to the <code>AuthMiddlewareOptions</code> object to get it to be passed into the <code>AddAsResourceServer</code> method. I see what you are saying if I did want to make changes to <code>AuthMiddlewareOptions</code> but I do not."}, {"owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "reply_to_user": {"reputation": 1626, "user_id": 4206735, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bccfa766f0da76e534334083c87d6033?s=128&d=identicon&r=PG", "display_name": "christopher clark", "link": "https://stackoverflow.com/users/4206735/christopher-clark"}, "edited": false, "score": 0, "creation_date": 1535049191, "post_id": 51975385, "comment_id": 90934031, "body": "Ok, I think I get your point. However, options doesn&#39;t work that way in .NET Core. <b>It&#39;s the responsibility of the framework to create actual option objects.</b> (Just take a look at the <a href=\"https://github.com/aspnet/Options/blob/master/src/Microsoft.Extensions.Options/OptionsFactory.cs#L39\" rel=\"nofollow noreferrer\">sources</a>.) We have the <i>IConfigureOptions&lt;TOptions&gt;</i> interface to setup these object instances. The various overloads of <i>services.Configure</i> registers implementations of this interface in the DI container under the hood."}, {"owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "reply_to_user": {"reputation": 1626, "user_id": 4206735, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bccfa766f0da76e534334083c87d6033?s=128&d=identicon&r=PG", "display_name": "christopher clark", "link": "https://stackoverflow.com/users/4206735/christopher-clark"}, "edited": false, "score": 0, "creation_date": 1535049385, "post_id": 51975385, "comment_id": 90934122, "body": "Consumers of your service shouldn&#39;t create option objects, they should register configurers as shown in my answer. Of course, if you stick to using the Options API."}], "tags": [], "owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "is_accepted": false, "score": 1, "last_activity_date": 1534973632, "last_edit_date": 1534973632, "creation_date": 1534973231, "answer_id": 51975385, "question_id": 51974625, "link": "https://stackoverflow.com/questions/51974625/passing-an-instance-of-an-object-to-a-method-that-takes-an-action-as-parameter/51975385#51975385", "title": "Passing an Instance of an Object to a Method that takes an Action&lt;&gt; as Parameter", "body": "<p>You may register multiple configuration delegates for a single option class:</p>\n\n<pre><code>services.Configure&lt;AuthMiddlewareOptions&gt;(Configuration.GetSection(\"AuthMiddlewareOptions\"));\n\nservices.AddAsResourceServer(options =&gt; SpecialThing(options));\n</code></pre>\n\n<p>And <em>AddAsResourceServer</em> should call <code>services.Configure</code>, as well:</p>\n\n<pre><code>public static IServiceCollection AddAsResourceServer(this IServiceCollection services, Action&lt;AuthMiddlewareOptions&gt; action = null)\n{\n    if (action != null)\n        services.Configure(action);\n\n\n    // ...\n\n    return services;\n}\n</code></pre>\n\n<p>Having this setup, <em>AuthMiddlewareOptions</em> is populated from the configuration section \"AuthMiddlewareOptions\", then the customization delegate (<em>SpecialThing</em>) has a chance to change the options filled at the previous step.</p>\n\n<p>It's important that <strong>the order matters</strong>! If you swap the two lines, <em>SpecialThing</em>'s  changes will be overwritten by the values coming from the configuration.</p>\n"}, {"comments": [{"owner": {"reputation": 1626, "user_id": 4206735, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bccfa766f0da76e534334083c87d6033?s=128&d=identicon&r=PG", "display_name": "christopher clark", "link": "https://stackoverflow.com/users/4206735/christopher-clark"}, "edited": false, "score": 0, "creation_date": 1535055045, "post_id": 51976940, "comment_id": 90936754, "body": "This is what I ended up doing. If I need to save the options, I can save them within the AddAsResourceServer Method."}], "tags": [], "owner": {"reputation": 4047, "user_id": 5782634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cab870f0dff7ba711aec822b4c57c64?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/5782634/brad"}, "is_accepted": true, "score": 2, "last_activity_date": 1534985315, "creation_date": 1534985315, "answer_id": 51976940, "question_id": 51974625, "link": "https://stackoverflow.com/questions/51974625/passing-an-instance-of-an-object-to-a-method-that-takes-an-action-as-parameter/51976940#51976940", "title": "Passing an Instance of an Object to a Method that takes an Action&lt;&gt; as Parameter", "body": "<p>You can simply bind your configuration to the options instance provided by the method.</p>\n\n<pre><code>services.AddAsResourceServer(options =&gt; \n{\n    Configuration.Bind(\"AuthMiddlewareOptions\", options);\n});\n</code></pre>\n"}], "owner": {"reputation": 1626, "user_id": 4206735, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bccfa766f0da76e534334083c87d6033?s=128&d=identicon&r=PG", "display_name": "christopher clark", "link": "https://stackoverflow.com/users/4206735/christopher-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 51976940, "answer_count": 5, "score": 0, "last_activity_date": 1534985315, "creation_date": 1534969667, "question_id": 51974625, "link": "https://stackoverflow.com/questions/51974625/passing-an-instance-of-an-object-to-a-method-that-takes-an-action-as-parameter", "title": "Passing an Instance of an Object to a Method that takes an Action&lt;&gt; as Parameter", "body": "<p>In Dot Net Core convention for configuring services is as follows.</p>\n\n<blockquote>\n  <p>Method that Requires Action&lt;> As Parameter</p>\n</blockquote>\n\n<pre><code>public static IServiceCollection AddAsResourceServer(this IServiceCollection services, Action&lt;AuthMiddlewareOptions&gt; action = null)\n{\n     if(action != null)\n     {\n         AuthMiddlewareOptions authOptions = new AuthMiddlewareOptions();\n         action.Invoke(authOptions);\n     }\n     ...\n     return services\n}\n</code></pre>\n\n<p>This allows us to configure our service in startup as follows.</p>\n\n<blockquote>\n  <p>Startup ConfigureServices Method</p>\n</blockquote>\n\n<pre><code>services.AddAsResourceServer((a) =&gt;\n{\n    a.Audience = \"Long Audience\";\n    a.Issuer = \"provider.com/oauthprovider\";\n});\n</code></pre>\n\n<p>This is really cool! I like this pattern. It works very well for allowing anyone to overwrite base configuration options.</p>\n\n<p>However this seems very cumbersome when you already have an instance of the object. How would I create an instance of an object, convert it to an action, and pass that to the <code>.AddAsResourceServer</code> method?</p>\n\n<blockquote>\n  <p>I have tried:</p>\n</blockquote>\n\n<pre><code>Action&lt;AuthMiddleWareOptions&gt; auth = new Action&lt;AuthMiddleWareOptions&gt;()\n/// The above way still requires a \"target\" in constructor so it doesnt work.\n///so i still need to pass each \n///property into it.\n</code></pre>\n\n<p>My consumers of the service may have just created an instance of AuthMiddleWareOptions and populated through appsettings! </p>\n\n<blockquote>\n  <p>They may have done something like this.</p>\n</blockquote>\n\n<pre><code>AuthMiddlewareOptions myoptions = new AuthMddlewareOptions();\nConfiguration.Bind(\"AuthMiddlewareOptions\", myoptions);\n</code></pre>\n\n<p>Now that they have 'myoptions'. Is there a quick way to use that with the Action Parameter. Maybe like this?</p>\n\n<pre><code>AuthMiddlewareOptions myoptions = new AuthMddlewareOptions();\nConfiguration.Bind(\"AuthMiddlewareOptions\", myoptions);\nservices.AddAsResourceServer((a) =&gt; SpecialThing(myoptions));\n</code></pre>\n"}, {"tags": ["c#", "linq", "linq-to-sql", "sum"], "comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1534969880, "post_id": 51974573, "comment_id": 90899792, "body": "&quot;Unable to get Net Field in select statement in my LINQ query&quot; But it&#39;s there, isn&#39;t it? Do you mean that some error occurs or that you don&#39;t get the expected results?"}, {"owner": {"reputation": 942, "user_id": 10247440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0kwxp.jpg?s=128&g=1", "display_name": "Selmir", "link": "https://stackoverflow.com/users/10247440/selmir"}, "edited": false, "score": 0, "creation_date": 1534970259, "post_id": 51974573, "comment_id": 90899985, "body": "Your code seems correct, can you add your models so we can have more details."}, {"owner": {"reputation": 39, "user_id": 10261658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eaa2e63adc92183646b300070bb6025?s=128&d=identicon&r=PG&f=1", "display_name": "Luci", "link": "https://stackoverflow.com/users/10261658/luci"}, "edited": false, "score": 0, "creation_date": 1534971472, "post_id": 51974573, "comment_id": 90900482, "body": "<code>public class GISTracts     {         public int? LeaseID { get; set; }         public int? TractID { get; set; }         public string TractName { get; set; }         public decimal? GrossAc { get; set; }         public string County { get; set; }         public string Source { get; set; }         public string Legal { get; set; }         public decimal? GasExecutive { get; set; }         public decimal? Net { get; set; }     } </code>"}, {"owner": {"reputation": 39, "user_id": 10261658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eaa2e63adc92183646b300070bb6025?s=128&d=identicon&r=PG&f=1", "display_name": "Luci", "link": "https://stackoverflow.com/users/10261658/luci"}, "edited": false, "score": 0, "creation_date": 1534971743, "post_id": 51974573, "comment_id": 90900588, "body": "Error goes off if I use                                                                                         Net = gcs.Sum(x =&gt; x.GrossAcres * x.Interests.Sum(j=&gt;j.GasExecutive)). But Net is not same as SQL query results"}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1534977804, "post_id": 51974573, "comment_id": 90902587, "body": "&quot;Error goes off&quot; -- Which error? What you do here is seen more often in Stack Overflow questions. You tell what you want and what you tried, fine, but apparently it didn&#39;t succeed and you forget to tell why."}], "answers": [{"tags": [], "owner": {"reputation": 2289, "user_id": 2471463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEadi.jpg?s=128&g=1", "display_name": "Vinit", "link": "https://stackoverflow.com/users/2471463/vinit"}, "is_accepted": true, "score": 0, "last_activity_date": 1534980082, "creation_date": 1534980082, "answer_id": 51976431, "question_id": 51974573, "link": "https://stackoverflow.com/questions/51974573/linq-query-group-multiple-entities-and-sum/51976431#51976431", "title": "LINQ Query - Group multiple entities and sum", "body": "<p>The root cause is, you haven't included <code>Tracts</code> entity in <code>group</code> clause. Try\nupdating the <code>group by</code> clause as - </p>\n\n<pre><code>group new { WIG,In,Tr } by new {....} into gcs\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>group WIG by new {....} into gcs\n</code></pre>\n\n<p>Then update the Net calculation as  </p>\n\n<pre><code>Net = gcs.Sum(x=&gt;x.Tr.GrossAcres * x.In.GasExecutive) //Not sure if GrossAcres part of tracks or other entity, update it accordingly.\n</code></pre>\n\n<p>Your <code>linq</code> query will look like below.</p>\n\n<pre><code>var myResults = from WIG in db.WorkingInterestGroups\n                            join In in db.Interests on WIG.Id equals In.WorkingInterestGroupId\n                            join Tr in db.Tracts on In.TractId equals Tr.Id\n                            where WIG.LeaseId == LeaseID\n                            group new { WIG,In,Tr } by new\n                            {\n                                WIG.LeaseId,\n                                Tr.Id,\n                                Tr.Name,\n                                Tr.GrossAc,\n                                Tr.County,\n                                Tr.District,\n                                Tr.Legal,\n                                Tr.Source                                \n                            } into gcs\n                            select new GISTracts\n                            {\n                                LeaseID = gcs.Key.LeaseId,\n                                TractID = gcs.Key.Id,\n                                TractName = gcs.Key.Name,\n                                GrossAc = gcs.Key.GrossAc,\n                                County = gcs.Key.County,\n                                Source = gcs.Key.Source,\n                                Legal = gcs.Key.Legal,\n                                Net = gcs.Sum(x=&gt;x.Tr.GrossAcres * x.In.GasExecutive)\n                            };\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10261658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eaa2e63adc92183646b300070bb6025?s=128&d=identicon&r=PG&f=1", "display_name": "Luci", "link": "https://stackoverflow.com/users/10261658/luci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 51976431, "answer_count": 1, "score": 1, "last_activity_date": 1535056579, "creation_date": 1534969433, "last_edit_date": 1535056579, "question_id": 51974573, "link": "https://stackoverflow.com/questions/51974573/linq-query-group-multiple-entities-and-sum", "title": "LINQ Query - Group multiple entities and sum", "body": "<p>I am trying to convert SQL Query to LINQ</p>\n\n<p>Here is the relevant model: </p>\n\n<pre><code>public class GISTracts \n{ \n    public int? LeaseID     { get; set; } \n    public int? TractID     { get; set; } \n    public string County    { get; set; } \n    public string Source    { get; set; } \n    public string Legal     { get; set; } \n    public decimal? Net     { get; set; } \n    public string TractName { get; set; } \n    public decimal? GrossAc { get; set; } \n    public decimal? GasExecutive { get; set; } \n}\n</code></pre>\n\n<p>Here is my sql query:</p>\n\n<pre><code>select leaseId, Tracts.Id as TractsId, Tracts.Name as TractsName, Tracts.GrossAc, County, Source,  District, Legal,\nSum(Interests.GasExecutive*Tracts.GrossAc) as Net\nfrom WorkingInterestGroups\nInner Join Interests on WorkingInterestGroups.Id = Interests.WorkingInterestGroupId\nInner Join Tracts on Interests.TractId = Tracts.Id\ngroup by leaseId, Tracts.Id , Tracts.Name, Tracts.GrossAc, County, District, Legal, Source;\n</code></pre>\n\n<p>Here is my LINQ Query</p>\n\n<pre><code>var myResults = from WIG in db.WorkingInterestGroups\n                join In in db.Interests on WIG.Id equals In.WorkingInterestGroupId\n                join Tr in db.Tracts on In.TractId equals Tr.Id\n                where WIG.LeaseId == LeaseID\n                group WIG by new\n                {\n                    WIG.LeaseId,\n                    Tr.Id,\n                    Tr.Name,\n                    Tr.GrossAc,\n                    Tr.County,\n                    Tr.District,\n                    Tr.Legal,\n                    Tr.Source                                \n                } into gcs\n                select new GISTracts\n                {\n                    LeaseID = gcs.Key.LeaseId,\n                    TractID = gcs.Key.Id,\n                    TractName = gcs.Key.Name,\n                    GrossAc = gcs.Key.GrossAc,\n                    County = gcs.Key.County,\n                    Source = gcs.Key.Source,\n                    Legal = gcs.Key.Legal,\n                    Net = gcs.Sum(x=&gt;x.GrossAcres * x.Interests.GasExecutive)\n                };\n</code></pre>\n\n<p>Unable to get Net Field in select statement in my LINQ query.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["c#", ".net", "binaryfiles", "dds-format"], "comments": [{"owner": {"reputation": 155, "user_id": 5622844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e935f40ea1116eea47d4934fcc9870c0?s=128&d=identicon&r=PG", "display_name": "NaCl", "link": "https://stackoverflow.com/users/5622844/nacl"}, "edited": false, "score": 0, "creation_date": 1534969235, "post_id": 51974508, "comment_id": 90899480, "body": "By DDS you mean DirectDraw Surface, am I right?"}, {"owner": {"reputation": 172, "user_id": 9616687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd372729d752196e0634e2be4711063?s=128&d=identicon&r=PG&f=1", "display_name": "Jacce", "link": "https://stackoverflow.com/users/9616687/jacce"}, "reply_to_user": {"reputation": 155, "user_id": 5622844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e935f40ea1116eea47d4934fcc9870c0?s=128&d=identicon&r=PG", "display_name": "NaCl", "link": "https://stackoverflow.com/users/5622844/nacl"}, "edited": false, "score": 0, "creation_date": 1534969342, "post_id": 51974508, "comment_id": 90899536, "body": "Yes you are right"}, {"owner": {"reputation": 155, "user_id": 5622844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e935f40ea1116eea47d4934fcc9870c0?s=128&d=identicon&r=PG", "display_name": "NaCl", "link": "https://stackoverflow.com/users/5622844/nacl"}, "edited": false, "score": 0, "creation_date": 1534969526, "post_id": 51974508, "comment_id": 90899624, "body": "This may be helpful: <a href=\"https://docs.microsoft.com/en-us/windows/desktop/direct3ddds/dds-header\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/direct3ddds/dds-hea&zwnj;&#8203;der</a>"}, {"owner": {"reputation": 172, "user_id": 9616687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd372729d752196e0634e2be4711063?s=128&d=identicon&r=PG&f=1", "display_name": "Jacce", "link": "https://stackoverflow.com/users/9616687/jacce"}, "reply_to_user": {"reputation": 155, "user_id": 5622844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e935f40ea1116eea47d4934fcc9870c0?s=128&d=identicon&r=PG", "display_name": "NaCl", "link": "https://stackoverflow.com/users/5622844/nacl"}, "edited": false, "score": 0, "creation_date": 1534970282, "post_id": 51974508, "comment_id": 90899995, "body": "That is helpfull thanks. But if I would open a dds file in a hex editor for example I would not know at what position DDSD_PIXELFORMAT so I do not know how to write code to read the bytes in that position. In the webpage I can see I row with the header &quot;value&quot; that has a bunch of columns but I guess that won&#39;t tell me the position in the file?"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 5622844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e935f40ea1116eea47d4934fcc9870c0?s=128&d=identicon&r=PG", "display_name": "NaCl", "link": "https://stackoverflow.com/users/5622844/nacl"}, "is_accepted": true, "score": 4, "last_activity_date": 1535033177, "last_edit_date": 1535033177, "creation_date": 1535032029, "answer_id": 51987353, "question_id": 51974508, "link": "https://stackoverflow.com/questions/51974508/how-can-i-make-sure-that-a-directdraw-surface-has-a-correct-file-format/51987353#51987353", "title": "How can I make sure that a DirectDraw surface has a correct file format?", "body": "<p>The first thing to be done with a file that has a header is to check for its magic numbers (if any is given on documentation), in case of <a href=\"https://docs.microsoft.com/en-us/windows/desktop/direct3ddds/dx-graphics-dds-pguide#dds-file-layout\" rel=\"nofollow noreferrer\">DDS file</a>, the magic number is <code>0x44445220</code> which is equal to <code>\"DDS \"</code> in \"plain text\".</p>\n\n<p>After that, just deal with the specs. Everything (excepting magic number) is stored in little endian format, so be careful when dealing with bytes, according to Microsoft, the <a href=\"https://docs.microsoft.com/en-us/windows/desktop/direct3ddds/dds-header\" rel=\"nofollow noreferrer\">definition</a> of the DDS header is (C++):</p>\n\n<pre><code>typedef struct {\n  DWORD           dwSize;                 /* Always equal to 124 */\n  DWORD           dwFlags;\n  DWORD           dwHeight;\n  DWORD           dwWidth;\n  DWORD           dwPitchOrLinearSize;\n  DWORD           dwDepth;\n  DWORD           dwMipMapCount;\n  DWORD           dwReserved1[11];\n  DDS_PIXELFORMAT ddspf;\n  DWORD           dwCaps;\n  DWORD           dwCaps2;\n  DWORD           dwCaps3;\n  DWORD           dwCaps4;\n  DWORD           dwReserved2;\n} DDS_HEADER;\n</code></pre>\n\n<p>Based on that, I just came with the following code for any \"generic\" DDS file:</p>\n\n<pre><code>public static bool IsValidDDS(string path)\n{\n  if (path == null)\n    throw new ArgumentNullException(nameof(path));\n  if (!File.Exists(path)) // Check for existence.\n    return false;\n\n  uint magicNumber = 0; byte[] headerLength = new byte[sizeof(byte)];\n  using (var fs = new FileStream(path, FileMode.Open, FileAccess.Read))\n  {\n    byte[] magic = new byte[sizeof(uint)];\n\n    // I'm still pretty used to C and fread, so here you go :^)\n    if (fs.Read(magic, 0, sizeof(uint)) != sizeof(uint))\n      return false; // Not even a valid file.\n\n    if (fs.Read(headerLength, 0, sizeof(byte)) != sizeof(byte))\n      return false; // Not enough bytes, even if the first 4 bytes were checked.\n\n    // Convert to a big endian integer.\n    magicNumber = (uint)((magic[0] &lt;&lt; 24) | (magic[1] &lt;&lt; 16) | (magic[2] &lt;&lt; 8) | magic[3]);\n  }\n  return (headerLength[0] == 0x7C) &amp;&amp; (magicNumber == 0x44445320);\n}\n</code></pre>\n\n<p>The code above just checks for the first 5 bytes of the input file (passed as argument <code>path</code>), those are always the same as I have seen and should be equal to:</p>\n\n<pre><code>0x44 0x44 0x53 0x20 0x7C 0x00 0x00 0x00 (8 bytes)\n</code></pre>\n\n<p>The code above was tested with the <code>.dds</code> files on this repository: <a href=\"https://github.com/toji/webgl-texture-utils/tree/master/sample/img\" rel=\"nofollow noreferrer\">https://github.com/toji/webgl-texture-utils/tree/master/sample/img</a>, and both files had exactly the same header:</p>\n\n<pre><code>iamnacl:~/workspace $ cd dds-test/\niamnacl:~/workspace/dds-test $ dotnet run ../test-dxt1.dds \nThe file is a valid DDS file? True\niamnacl:~/workspace/dds-test $ dotnet run ../test-dxt5.dds                                                                                               \nThe file is a valid DDS file? True\niamnacl:~/workspace/dds-test $ \n</code></pre>\n\n<p>You can optimize the code above to perform a single call to <code>fs.Read</code> with a size of <code>ulong</code> and check the whole thing against this value: <code>0x444453207C000000</code>.</p>\n\n<p>Hope this helps :)</p>\n"}], "owner": {"reputation": 172, "user_id": 9616687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd372729d752196e0634e2be4711063?s=128&d=identicon&r=PG&f=1", "display_name": "Jacce", "link": "https://stackoverflow.com/users/9616687/jacce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 1, "accepted_answer_id": 51987353, "answer_count": 1, "score": 5, "last_activity_date": 1535033177, "creation_date": 1534969127, "last_edit_date": 1535029362, "question_id": 51974508, "link": "https://stackoverflow.com/questions/51974508/how-can-i-make-sure-that-a-directdraw-surface-has-a-correct-file-format", "title": "How can I make sure that a DirectDraw surface has a correct file format?", "body": "<p>I need to make a simple check if a dds file is of valid format. I just need to do a general check of the dds file, so I do not need to check if it is a dxt1, dxt5, dx10 etc. For example if I have a png image and I rename the extensions to .dds the dds format will ofcourse be wrong and I would then need to tell the user that he is trying to use a dds file with a wrong format. However if I have a dds that indeed has a correct file format I will not need to do any further investigation since I do not care of what type of dds file it is (at this moment). So I do only have to read the parts of the dds file that will stay the same on ALL dds files. \nI'm thinking I could read the dds header and magic number in some way. \nI have to do the same validation for a png file and there I am reading the png header like this:</p>\n\n<pre><code>    var png = new byte[] { 0x89, 0x50, 0x4e, 0x47, 0x0D, 0x0A, 0x1A, 0x0A }\n    using (FileStream fs = new FileStream(fileToCheck, FileMode.Open, FileAccess.Read))\n            {\n               if (fs.Length &gt; buffer.Length)\n                 {\n                   fs.Read(buffer, 0, buffer.Length);\n                   fs.Position = (int)fs.Length - endBuffer.Length;\n                   fs.Read(bufferEnd, 0, endBuffer.Length);\n                 }\n\n               fs.Close();\n            } \n    for (int i = 0; i &lt; png.Length; i++)\n        {\n            if (buffer[i] != png[i])\n                return false;\n        }\n\n    return true;\n</code></pre>\n\n<p>And I was looking if there is a similiar way to check the format of a dds file. I am new to this and the problem I am having is to know what bytes in the dds file that will always be the same for all dds files (so that I can check these bytes to see if the dds format is valid) and how I can implement the code in a simple way to check the dds format. Any help will be appreciated.</p>\n\n<p>Edit:\nSo thanks to @NaCl I have got the first part of the question answered. I now know what parts in the dds file that is required but I do not know how to locate it in the dds file. I have opened a lot of dds files with a hex editor but I am not very good at reverse engineering so I can't understand where the bytes that I need to check is located which will furthermore make me not to know how I can implement code to search for bytes at the specified positions (which I can do with the png file since I found much more document about that file) since I do not know at what position to go to.</p>\n\n<p>If anybody can Point me in the right direction or help me in some other way I would appreciate it very much . Thanks.</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 2, "creation_date": 1534969001, "post_id": 51974419, "comment_id": 90899369, "body": "Where is it setting it to <code>true</code>? I see you have <code>AbleToShoot();</code> which is attempting to call a property like a method (and you should be getting an error). I don&#39;t see anywhere that you say <code>AbleToShoot = true;</code>..."}, {"owner": {"reputation": 2904, "user_id": 580627, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bdab596b1c704403fba98930c6955a56?s=128&d=identicon&r=PG", "display_name": "Fredrik Widerberg", "link": "https://stackoverflow.com/users/580627/fredrik-widerberg"}, "edited": false, "score": 2, "creation_date": 1534970514, "post_id": 51974419, "comment_id": 90900095, "body": "Or setting it to <code>false</code> again for that matter. When you say infinite loop, do you mean that your unity editor freezes?"}, {"owner": {"reputation": 29, "user_id": 9416256, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Simonas Holcmann", "link": "https://stackoverflow.com/users/9416256/simonas-holcmann"}, "edited": false, "score": 0, "creation_date": 1534971843, "post_id": 51974419, "comment_id": 90900626, "body": "That&#39;s the thing, it doesn&#39;t freeze. It stops when the list is empty.  AbleToShoot just sets the lastBall.AbleToShoot to true, nothing more."}, {"owner": {"reputation": 1578, "user_id": 342842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98efa40198faaa312c6465b969f1fae?s=128&d=identicon&r=PG", "display_name": "Immersive", "link": "https://stackoverflow.com/users/342842/immersive"}, "edited": false, "score": 0, "creation_date": 1535012764, "post_id": 51974419, "comment_id": 90912400, "body": "There&#39;s no loop so it can&#39;t be getting stuck (I recommend updating your title, too).  Did you intend for <i>all</i> projectiles to be fired in the one <code>Shoot</code> call?"}, {"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 0, "creation_date": 1535042740, "post_id": 51974419, "comment_id": 90930905, "body": "<code>So I get the feeling that the event is somehow put to a queue which executes whenever AbleToShoot == true, however I could not find anything in the documentation</code> .. which documentation?"}, {"owner": {"reputation": 29, "user_id": 9416256, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Simonas Holcmann", "link": "https://stackoverflow.com/users/9416256/simonas-holcmann"}, "reply_to_user": {"reputation": 1578, "user_id": 342842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98efa40198faaa312c6465b969f1fae?s=128&d=identicon&r=PG", "display_name": "Immersive", "link": "https://stackoverflow.com/users/342842/immersive"}, "edited": false, "score": 0, "creation_date": 1535111719, "post_id": 51974419, "comment_id": 90957071, "body": "@Immersive No, that&#39;s the thing i don&#39;t want to happen."}, {"owner": {"reputation": 1578, "user_id": 342842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98efa40198faaa312c6465b969f1fae?s=128&d=identicon&r=PG", "display_name": "Immersive", "link": "https://stackoverflow.com/users/342842/immersive"}, "edited": false, "score": 0, "creation_date": 1535247480, "post_id": 51974419, "comment_id": 90995338, "body": "@SimonasHolcmann I don&#39;t have access to Visual Studio at the moment, I&#39;ll write up a proper answer when I get back home tomorrow.  Basically, the problem is your use of the <code>event Shoot</code>.  Replace that with a list/queue and you&#39;ll be good."}, {"owner": {"reputation": 1578, "user_id": 342842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98efa40198faaa312c6465b969f1fae?s=128&d=identicon&r=PG", "display_name": "Immersive", "link": "https://stackoverflow.com/users/342842/immersive"}, "edited": false, "score": 0, "creation_date": 1535247882, "post_id": 51974419, "comment_id": 90995402, "body": "eg <code>Queue&lt;Action&gt; Shoot</code>  then <code>var oneShot = Shoot.Pop();  oneShot();</code>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9416256, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Simonas Holcmann", "link": "https://stackoverflow.com/users/9416256/simonas-holcmann"}, "edited": false, "score": 0, "creation_date": 1535111765, "post_id": 51995365, "comment_id": 90957113, "body": "I need each object to have this property, so it is not an option."}], "tags": [], "owner": {"reputation": 652, "user_id": 5905688, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10153506638119397/picture?type=large", "display_name": "Christopher Vickers", "link": "https://stackoverflow.com/users/5905688/christopher-vickers"}, "is_accepted": false, "score": 0, "last_activity_date": 1535065309, "creation_date": 1535065309, "answer_id": 51995365, "question_id": 51974419, "link": "https://stackoverflow.com/questions/51974419/event-causing-an-infinite-loop/51995365#51995365", "title": "Event causing an infinite loop", "body": "<p>I think it is because it creating multiple copies of the class. Without knowing where else it is used, this is just a guess. Try changing it so there is only ever one copy of the variable ableToShoot:</p>\n\n<pre><code>private static bool ableToShoot;\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9416256, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Simonas Holcmann", "link": "https://stackoverflow.com/users/9416256/simonas-holcmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535065309, "creation_date": 1534968716, "last_edit_date": 1535063931, "question_id": 51974419, "link": "https://stackoverflow.com/questions/51974419/event-causing-an-infinite-loop", "title": "Event causing an infinite loop", "body": "<p>I have a static event which is triggered whenever the player clicks the Left-Click Button.</p>\n\n<p>I have a list of gameobjects that are listening to this event, however the function that is supposed to execute ONLY when <code>ableToShoot</code> is <code>true</code>. </p>\n\n<p>Seems to execute even if it is false. I do have a function which calls a function which makes the next object's from the list <code>ableToShoot = true</code>,\nhowever this seems to put it in an infinite loop.</p>\n\n<p>This is the LeftClickEvent Script.</p>\n\n<pre><code>public class InputManager : MonoBehaviour\n{\n    public delegate void ShootProjectile();\n    public static event ShootProjectile Shoot;\n\n    private void Update()\n    {\n        if (Input.touchCount &gt; 0)\n        {\n            if (Input.GetTouch(0).phase == TouchPhase.Began)\n            {\n                if (Shoot != null)\n                {\n                    Shoot();\n                }\n            }\n        }\n        else if (Input.GetMouseButtonDown(0))\n        {\n            if (Shoot != null)\n            {\n                Shoot();\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>This is the Script that is listening to the LeftClickEvent :</p>\n\n<pre><code>public class ProjectileMovement : MonoBehaviour\n{\n\n    public float speed = 3;\n    private bool ableToShoot;\n    public int itemInList = 0;\n    public StartLevelMechanics mechanics;\n    HitParticles particles;\n\n    public bool AbleToShoot\n    {\n        get\n        {\n            return ableToShoot;\n        }\n\n        set\n        {\n            ableToShoot = value;\n        }\n    }\n\n    private void Awake()\n    {\n        InputManager.Shoot += ShootProjectile;\n        particles = GameObject.Find(\"HitParticles\").GetComponent&lt;HitParticles&gt;();\n        AbleToShoot = false;\n    }\n\n    public void ShootProjectile()\n    {\n        if (AbleToShoot)\n        {\n            GetComponentInChildren&lt;Animator&gt;().SetTrigger(\"Shoot\");\n            iTween.MoveTo(this.gameObject, iTween.Hash(\"position\", new Vector3(transform.position.x, 10, transform.position.z),\n                          \"easetype\", iTween.EaseType.spring, \"time\", 1f, \"oncomplete\", \"DestroyProjectile\",  \"oncompletetarget\", \n                          this.gameObject));\n            mechanics.NewBall();\n            return;\n        }\n    }\n}\n</code></pre>\n\n<p>And this is the mechanics script which turns the next gameobjects AbleToShoot to true.</p>\n\n<pre><code>public void NewBall()\n{\n    if (projectiles.Count == 1)\n    {\n        projectiles.Clear();\n    }\n    else\n    {\n        projectiles.Remove(projectiles[0]);\n    }\n\n    if (projectiles.Count == 0)\n    {\n        levelOver();\n        return;\n    }\n\n    lastBall = projectiles[0];\n    ProjectileMovement movement = lastBall.GetComponent&lt;ProjectileMovement&gt;();\n\n    iTween.MoveTo(lastBall, iTween.Hash(\"position\", ShootStartPosition,\n                  \"time\", 0.3f, \"easetype\", iTween.EaseType.easeOutQuad));\n    RotateBalls();\n    AbleToShoot();\n    return;\n}\n</code></pre>\n\n<p>So I get the feeling that the event is somehow put to a queue which executes whenever <code>AbleToShoot == true</code>, however I could not find anything in the documentation.</p>\n"}, {"tags": ["c#", ".net", "asp-classic", "com"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 1, "creation_date": 1534968539, "post_id": 51974360, "comment_id": 90899168, "body": "You need to use COM interop, and instance methods."}, {"owner": {"reputation": 725, "user_id": 2174305, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MhKkM.jpg?s=128&g=1", "display_name": "A. Cristian Nogueira", "link": "https://stackoverflow.com/users/2174305/a-cristian-nogueira"}, "reply_to_user": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1534969255, "post_id": 51974360, "comment_id": 90899496, "body": "Could you please be more specific? I&#39;ve been reading lots of articles about COM interop but didn&#39;t find a real solution for this case in particular."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1534980045, "post_id": 51974360, "comment_id": 90903049, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/24329935/classic-asp-using-c-sharp-net-dll-object-doesnt-support-this-property-or-metho\">Classic ASP using C# .net DLL Object doesn&#39;t support this property or method</a>"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1534980236, "post_id": 51974360, "comment_id": 90903092, "body": "The <code>static</code> method is the problem, only instance methods are supported by COM <i>(mentioned by Slaks in the <a href=\"https://stackoverflow.com/questions/51974360/call-asp-net-c-sharp-dll-method-from-classic-asp#comment90899168_51974360\">comment above</a>)</i> as stated in <a href=\"https://stackoverflow.com/a/24330489/692942\">this answer</a> that&#39;s been on <a href=\"https://stackoverflow.com\">Stack Overflow</a> for over 4 years now."}, {"owner": {"reputation": 725, "user_id": 2174305, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MhKkM.jpg?s=128&g=1", "display_name": "A. Cristian Nogueira", "link": "https://stackoverflow.com/users/2174305/a-cristian-nogueira"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1534982479, "post_id": 51974360, "comment_id": 90903462, "body": "So if I remove the static word from my method, like in <i>public static Int32 SendStringToPrinter(string szPrinterName, string szString)</i> Will my asp object be able to call it?  In that case  I&#39;ll have to pass two strings as the method requires: <i>(PrinterName, stringText)</i>. Which is the best approach to do that from asp? That&#39;s the real thing about the question. I have read the topic @Lankymart says before, but it didn&#39;t seem to be clear to me and I&#39;m desperate about an answer who satisfy my question. I&#39;m sorry about that."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1534983249, "post_id": 51974360, "comment_id": 90903607, "body": "Sorry, struggling to understand the problem. Did you change it from static methods to instance methods and retry the ASP code? In relation to how to pass the parameters, will it not just be <code>objZebra.SendStringToPrinter &quot;PrinterName&quot;, &quot;StringValue&quot;</code>?"}, {"owner": {"reputation": 725, "user_id": 2174305, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MhKkM.jpg?s=128&g=1", "display_name": "A. Cristian Nogueira", "link": "https://stackoverflow.com/users/2174305/a-cristian-nogueira"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1534983834, "post_id": 51974360, "comment_id": 90903699, "body": "Thanks for the reply and patience @Lankymart. I&#39;m not sure on how to change it from static methods to instance methods. I know it&#39;s a basics on OO, but I think I missed that class. Working on a VB Windows Application this DLL works fine. But now I need to use it on an ASP application an this turned into a nightmare to me. About the parameters, I think this is exactly what I need."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 1213289, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ad784b4e226e63481f5a60ac9b94bb92?s=128&d=identicon&r=PG", "display_name": "mjk6035", "link": "https://stackoverflow.com/users/1213289/mjk6035"}, "edited": false, "score": 1, "creation_date": 1562746522, "post_id": 52019526, "comment_id": 100469492, "body": "Thanks a lot for posting this. Helped me a lot"}], "tags": [], "owner": {"reputation": 725, "user_id": 2174305, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MhKkM.jpg?s=128&g=1", "display_name": "A. Cristian Nogueira", "link": "https://stackoverflow.com/users/2174305/a-cristian-nogueira"}, "is_accepted": true, "score": 5, "last_activity_date": 1535217022, "creation_date": 1535217022, "answer_id": 52019526, "question_id": 51974360, "link": "https://stackoverflow.com/questions/51974360/call-net-c-dll-method-from-classic-asp/52019526#52019526", "title": "Call .Net C# DLL method from Classic ASP", "body": "<p>After lots of research and nights awake, I realized what was wrong with my code.</p>\n\n<p>First I want to thank @Lankymart and @SLaks for point me the way.</p>\n\n<p>Let's go to the Code:</p>\n\n<p>First I went to <code>AssemblyInfo.cs</code> and change the <code>[assembly: ComVisible(false)]</code>, and before every class I wanted to be visible to <em>COM</em> I add <code>[ComVisible(true)]</code> which I find in this MSDN document: <a href=\"https://msdn.microsoft.com/en-us/library/ms182198.aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/ms182198.aspx</a></p>\n\n<p>After that cames the most difficult part to me: Turn the static method into a instance method.</p>\n\n<p>But, researching further and trying without give away, I changed my code from:</p>\n\n<pre><code>public static Int32 SendStringToPrinter(string szPrinterName, string szString)   \n{\n     ...\n}\n\npublic class PrintHandler\n{\n    [MethodImpl(MethodImplOptions.NoInlining)]\n    public Int32 SendStringToPrinter(string text, string printerName)\n    {            \n        return RawPrinterHelper.SendStringToPrinter(printerName, text);\n    }\n}\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>[ComVisible(true)]\npublic Int32 SendStringToPrinter(string szPrinterName, string szString)\n{\n     ...\n}\n\n[ComVisible(true)]\npublic class PrintHandler\n{\n    RawPrinterHelper rph = new RawPrinterHelper();\n    [MethodImpl(MethodImplOptions.NoInlining)]\n    [ComVisible(true)]\n    public Int32 SendStringToPrinter(string text, string printerName)\n    {            \n        return rph.SendStringToPrinter(printerName, text);\n    }\n}\n</code></pre>\n\n<p>After that all went well and I was able to call the method as follows:</p>\n\n<pre><code>set objZebra = Server.CreateObject(\"PrintZebra.RawPrinterHelper\")   \nobjZebra.SendStringToPrinter strPrinterName, strText\n</code></pre>\n\n<p>That's it. Hope this could help any other with a nearly or same problem as mine.</p>\n"}], "owner": {"reputation": 725, "user_id": 2174305, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MhKkM.jpg?s=128&g=1", "display_name": "A. Cristian Nogueira", "link": "https://stackoverflow.com/users/2174305/a-cristian-nogueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2344, "favorite_count": 0, "accepted_answer_id": 52019526, "answer_count": 1, "score": 4, "last_activity_date": 1535217022, "creation_date": 1534968463, "last_edit_date": 1535037906, "question_id": 51974360, "link": "https://stackoverflow.com/questions/51974360/call-net-c-dll-method-from-classic-asp", "title": "Call .Net C# DLL method from Classic ASP", "body": "<p>I'm working on a classic asp project that needs to send a string to a DLL who will serialize it and send to a Zebra Thermal Printer.</p>\n\n<p>I have already build my DLL and registered it using <em>regasm</em> followed by <em>/codebase</em> which make IIS recognizes it.</p>\n\n<p>Althougt I'm able to set my object with <em>Server.CreateObject(\"MyDLL\")</em> without errors, I'm having trouble trying to access the C# methods in it.</p>\n\n<p>The C# code for the DLL was written as below:</p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\nusing System.IO;\n\n//[assembly: ComVisible(true)]\n//[assembly: Guid(\"6c87161d-1e02-40ef-8512-82f30bc1ae3e\")]\nnamespace PrintZebra\n{\n    //[ClassInterface(ClassInterfaceType.None)]\n    /// &lt;summary&gt;\n    /// Classe \n    /// &lt;/summary&gt;\n    public class RawPrinterHelper\n\n    {\n        // Structure and API declarions:\n        /// &lt;summary&gt;\n        /// \n        /// &lt;/summary&gt;\n        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]\n        public class DOCINFOA\n        {\n            [MarshalAs(UnmanagedType.LPStr)] public string pDocName;\n            [MarshalAs(UnmanagedType.LPStr)] public string pOutputFile;\n            [MarshalAs(UnmanagedType.LPStr)] public string pDataType;\n        }\n        [DllImport(\"winspool.Drv\", EntryPoint = \"OpenPrinterA\", SetLastError = true, CharSet = CharSet.Ansi, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]\n        public static extern bool OpenPrinter([MarshalAs(UnmanagedType.LPStr)] string szPrinter, out IntPtr hPrinter, IntPtr pd);\n\n        [DllImport(\"winspool.Drv\", EntryPoint = \"ClosePrinter\", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]\n        public static extern bool ClosePrinter(IntPtr hPrinter);\n\n        [DllImport(\"winspool.Drv\", EntryPoint = \"StartDocPrinterA\", SetLastError = true, CharSet = CharSet.Ansi, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]\n        public static extern bool StartDocPrinter(IntPtr hPrinter, Int32 level, [In, MarshalAs(UnmanagedType.LPStruct)] DOCINFOA di);\n\n        [DllImport(\"winspool.Drv\", EntryPoint = \"EndDocPrinter\", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]\n        public static extern bool EndDocPrinter(IntPtr hPrinter);\n\n        [DllImport(\"winspool.Drv\", EntryPoint = \"StartPagePrinter\", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]\n        public static extern bool StartPagePrinter(IntPtr hPrinter);\n\n        [DllImport(\"winspool.Drv\", EntryPoint = \"EndPagePrinter\", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]\n        public static extern bool EndPagePrinter(IntPtr hPrinter);\n\n        [DllImport(\"winspool.Drv\", EntryPoint = \"WritePrinter\", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]\n        public static extern bool WritePrinter(IntPtr hPrinter, IntPtr pBytes, Int32 dwCount, out Int32 dwWritten);\n\n        // SendBytesToPrinter()\n        // When the function is given a printer name and an unmanaged array\n        // of bytes, the function sends those bytes to the print queue.\n        // Returns true on success, false on failure.\n        public static bool SendBytesToPrinter(string szPrinterName, IntPtr pBytes, Int32 dwCount)\n        {\n            Int32 dwError = 0, dwWritten = 0;\n            IntPtr hPrinter = new IntPtr(0);\n            DOCINFOA di = new DOCINFOA();\n            bool bSuccess = false; // Assume failure unless you specifically succeed.\n\n            di.pDocName = \".NET RAW Document\";\n            di.pDataType = \"RAW\";\n\n            // Open the printer.\n            if (OpenPrinter(szPrinterName.Normalize(), out hPrinter, IntPtr.Zero))\n            {\n                // Start a document.\n                if (StartDocPrinter(hPrinter, 1, di))\n                {\n                    // Start a page.\n                    if (StartPagePrinter(hPrinter))\n                    {\n                        // Write your bytes.\n                        bSuccess = WritePrinter(hPrinter, pBytes, dwCount, out dwWritten);\n                        EndPagePrinter(hPrinter);\n                    }\n                    EndDocPrinter(hPrinter);\n                }\n                ClosePrinter(hPrinter);\n            }\n            // If you did not succeed, GetLastError may give more information\n            // about why not.\n            if (bSuccess == false)\n            {\n                dwError = Marshal.GetLastWin32Error();\n            }\n            return bSuccess;\n        }\n\n        public static bool SendFileToPrinter(string szPrinterName, string szFileName)\n        {\n            // Open the file.\n            FileStream fs = new FileStream(szFileName, FileMode.Open);\n            // Create a BinaryReader on the file.\n            BinaryReader br = new BinaryReader(fs);\n            // Dim an array of bytes big enough to hold the file's contents.\n            Byte[] bytes = new Byte[fs.Length];\n            bool bSuccess = false;\n            // Your unmanaged pointer.\n            IntPtr pUnmanagedBytes = new IntPtr(0);\n            int nLength;\n\n            nLength = Convert.ToInt32(fs.Length);\n            // Read the contents of the file into the array.\n            bytes = br.ReadBytes(nLength);\n            // Allocate some unmanaged memory for those bytes.\n            pUnmanagedBytes = Marshal.AllocCoTaskMem(nLength);\n            // Copy the managed byte array into the unmanaged array.\n            Marshal.Copy(bytes, 0, pUnmanagedBytes, nLength);\n            // Send the unmanaged bytes to the printer.\n            bSuccess = SendBytesToPrinter(szPrinterName, pUnmanagedBytes, nLength);\n            // Free the unmanaged memory that you allocated earlier.\n            Marshal.FreeCoTaskMem(pUnmanagedBytes);\n            return bSuccess;\n        }\n\n        public static Int32 SendStringToPrinter(string szPrinterName, string szString)\n        {\n            IntPtr pBytes;\n            Int32 dwCount;\n            // How many characters are in the string?\n            //dwCount = szString.Length;joao\n            dwCount = (szString.Length + 1) * Marshal.SystemMaxDBCSCharSize;\n            // Assume that the printer is expecting ANSI text, and then convert\n            // the string to ANSI text.\n            pBytes = Marshal.StringToCoTaskMemAnsi(szString);\n            // Send the converted ANSI string to the printer.\n            bool bSuccess = SendBytesToPrinter(szPrinterName, pBytes, dwCount);\n            Int32 dwError = 0;\n            if (bSuccess == false)\n               {\n                  dwError = Marshal.GetLastWin32Error();\n               }\n               Marshal.FreeCoTaskMem(pBytes);\n            return dwError;\n        }            \n\n    }\n}\n</code></pre>\n\n<p>In my ASP application I'm trying to access the <em>SendStringToPrinter</em> method as follows:</p>\n\n<pre><code>Dim objZebra    \nset objZebra = Server.CreateObject(\"Opus127Etiquetas.RawPrinterHelper\")\n\nobjZebra.SendStringToPrinter\n</code></pre>\n\n<p>But debugger says that objZebra does not support <em>SendStringToPrinter</em> property or method.</p>\n\n<p>Is important to tell that all the permissions to access the DLL are granted and if I start a new VB project on Visual Studio 2015 adding my custom DLL as a reference it works like a charm.</p>\n\n<p>The real question is: is it possible to do what I'm trying?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>After discussing with some members at the comments I realize that what I realy need to know is how to change the C# methods above from <em>static</em> to <em>instance</em>.\nAs I said before, if I use this DLL on a Windows Application it works fine, but on ASP it didn't.\nI now know what the problem is but I don't know how to solve it.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 1, "creation_date": 1534968772, "post_id": 51974334, "comment_id": 90899274, "body": "I think you want something like SelectedItems Contains p.Status. Right now you are asking for Status that equals all selected items and that&#39;s impossible unless all selected items are identical."}], "answers": [{"comments": [{"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1534969421, "post_id": 51974458, "comment_id": 90899575, "body": "This may work but it is incorrect to say the code only uses the last filter. They are cummulative, but obviously a string cannot equal more than one different string."}], "tags": [], "owner": {"reputation": 1055, "user_id": 2310805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/REDuN.jpg?s=128&g=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/2310805/eugene"}, "is_accepted": true, "score": 1, "last_activity_date": 1534968911, "creation_date": 1534968911, "answer_id": 51974458, "question_id": 51974334, "link": "https://stackoverflow.com/questions/51974334/query-sql-table-with-value-from-multipleselectioncombobox/51974458#51974458", "title": "Query SQL Table with Value from MultipleSelectionComboBox", "body": "<p>The code use only last filter. \nTry this: </p>\n\n<pre><code>public IEnumerable&lt;Orders&gt; LoadData()\n{\n    var ctx = new DbContext();\n    var query = (from o in ctx.tblOrders.AsQueryable()\n                 select new Orders\n                 {\n                     ID = o.OrderID,\n                     OrderNum = o.OrderNum.ToString(),\n                     Status = o.OrderStatus,\n                     Date = o.OrderDate\n                 });\n    if(CmbOrderStatus.SelectedItems != null)\n    {\n        List&lt;string&gt; list = new List&lt;string&gt;();\n        foreach (SelectedItems obj in CmbOrderStatus.SelectedItems)\n        {\n            list.Add(obj.ToString());\n        }\n\n        query = query.Where(p =&gt; list.Contains(p.Status));            \n    }\n    return query.ToList();\n}\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 4832282, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/519a2cb21364279ab11e03c7cfe40f38?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Ferreira", "link": "https://stackoverflow.com/users/4832282/carlos-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 51974458, "answer_count": 1, "score": 0, "last_activity_date": 1534968911, "creation_date": 1534968326, "question_id": 51974334, "link": "https://stackoverflow.com/questions/51974334/query-sql-table-with-value-from-multipleselectioncombobox", "title": "Query SQL Table with Value from MultipleSelectionComboBox", "body": "<p>So, I'm using Syncfusion controls and I've a MultipleSelectionCombobox where user can filter multiple arguments.</p>\n\n<p>I have a query which will load a list based on parameters query.</p>\n\n<p>So, first, I have a class to hold my values;</p>\n\n<pre><code>public class Orders\n{\n    public int ID { get; set; }\n    public string OrderNum { get; set; }\n    public string Status { get; set; }\n    public DateTime Date { get; set; }\n}\n</code></pre>\n\n<p>Then, the query:</p>\n\n<pre><code>public IEnumerable&lt;Orders&gt; LoadData()\n    {\n        var ctx = new DbContext();\n        var query = (from o in ctx.tblOrders.AsQueryable()\n                     select new Orders\n                     {\n                         ID = o.OrderID,\n                         OrderNum = o.OrderNum.ToString(),\n                         Status = o.OrderStatus,\n                         Date = o.OrderDate\n                     });\n        if(CmbOrderStatus.SelectedItems != null)\n        {\n            List&lt;string&gt; list = new List&lt;string&gt;();\n            foreach (SelectedItems obj in CmbOrderStatus.SelectedItems)\n            {\n                list.Add(obj.ToString());\n            }\n            for(int i = 0; i &lt; list.Count; i++)\n            {\n                var value = list[i];\n                query = query.Where(p =&gt; p.Status == value);\n            }\n        }\n        return query.ToList();\n    }\n</code></pre>\n\n<p>So, in Database in have many Orders and many OrderStatus, like \"Opened\", \"Delayed\", \"Closed\".</p>\n\n<p>So, if I filter in CmbOrderStatus \"Opened\" and \"Delayed\", I get nothing! If only one is selected, I get nothing!</p>\n\n<p>Any help here?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "3d-modelling"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4399588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oR3Uc.jpg?s=128&g=1", "display_name": "Muzaffer Onur DA\u011eHAN", "link": "https://stackoverflow.com/users/4399588/muzaffer-onur-da%c4%9ehan"}, "is_accepted": false, "score": 0, "last_activity_date": 1605615205, "creation_date": 1605615205, "answer_id": 64875088, "question_id": 51974269, "link": "https://stackoverflow.com/questions/51974269/read-modify-and-display-stl-file-3d-model-using-c/64875088#64875088", "title": "Read, modify, and display .STL file 3D model using c#", "body": "<p>You may user batu92k's <a href=\"https://github.com/batu92k/STL-Viewer\" rel=\"nofollow noreferrer\">STL Viewer</a>.\nProject url is below.</p>\n<p><a href=\"https://github.com/batu92k/STL-Viewer\" rel=\"nofollow noreferrer\">https://github.com/batu92k/STL-Viewer</a></p>\n<p>And also you may open stl in a text editor and modify the file by changing related parameters.</p>\n"}], "owner": {"reputation": 21, "user_id": 10261560, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3QZyCL3d9I0/AAAAAAAAAAI/AAAAAAAAABA/0f9K6e4KJX8/photo.jpg?sz=128", "display_name": "NGUYEN PHAM", "link": "https://stackoverflow.com/users/10261560/nguyen-pham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1605615205, "creation_date": 1534968010, "last_edit_date": 1534975087, "question_id": 51974269, "link": "https://stackoverflow.com/questions/51974269/read-modify-and-display-stl-file-3d-model-using-c", "title": "Read, modify, and display .STL file 3D model using c#", "body": "<p>I used Solidworks to build a 3D model and save as a .STL file. I would like to use C# to read the file and change the data while displaying the model.</p>\n\n<p>Can any one give me some references?</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "azure", "file-upload"], "answers": [{"comments": [{"owner": {"reputation": 357, "user_id": 10084424, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zj2YyhN3k3k/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p6VpO81p8ICerhPw0j136Dtkzipw/mo/photo.jpg?sz=128", "display_name": "Arjun C", "link": "https://stackoverflow.com/users/10084424/arjun-c"}, "edited": false, "score": 0, "creation_date": 1535012135, "post_id": 51974818, "comment_id": 90912039, "body": "Thank you so much. It works using the index based approach!"}], "tags": [], "owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_accepted": true, "score": 2, "last_activity_date": 1534982059, "last_edit_date": 1534982059, "creation_date": 1534970594, "answer_id": 51974818, "question_id": 51974259, "link": "https://stackoverflow.com/questions/51974259/multiple-file-upload-in-asp-net-mvc-is-uploading-a-single-file-multiple-times/51974818#51974818", "title": "Multiple file upload in ASP.NET MVC is uploading a single file multiple times", "body": "<p>When you execute, <code>foreach (string file in Request.Files)</code>, for each iteration, the value of <code>file</code> will be the string value <code>\"Attachment\"</code>, which is the name of your file input. When user uploads multiple files from the same input, <code>Request.Files</code> stores all of them with the same key - the name of your input element, which is \"Attachment\". Now when you execute <code>Request.Files[\"Attachment\"]</code>, it will give you only the first item (<strong><em>because all items has same key</em></strong>). For all iterations of the loop, this is what happening.</p>\n\n<p>When accessing <code>Request.Files</code>, do not use name based access approach, <strong>Use index based approach</strong> (<code>Request.Files[zeroBasedindex]</code>).</p>\n\n<p>You can use a <code>for</code> loop to properly iterate through the collection and read <code>Request.Files</code> using index based approach.</p>\n\n<pre><code>for(var i = 0; i &lt; Request.Files.Count; i++)\n{\n    HttpPostedFileBase hpf =  Request.Files[i];\n    // Your existing code to save hpf.\n}\n</code></pre>\n\n<p>I personally always use a collection of <code>HttpPostedFileBase</code> as my HttpPost action method parameter or as a property in my view model (which i will use a paramater as my HttpPost action method) and loop that. The important thing to remember is, <strong>your parameter/property name should match with the name of the input</strong> you are using for file upload.</p>\n\n<pre><code>public ActionResult Save(List&lt;HttpPostedFileBase&gt; attachment)\n{\n   foreach(var hpf in attachment)\n   {\n     // to do : save hpf\n   }\n   // to do : return something\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1534977980, "post_id": 51974943, "comment_id": 90902635, "body": "you <b>need</b> to use <code>List&lt;HttpPostedFileBase&gt;</code>. No!. Though that is an ideal way to do it, &quot;NEED TO USE&quot; might not be the correct language."}, {"owner": {"reputation": 357, "user_id": 10084424, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zj2YyhN3k3k/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p6VpO81p8ICerhPw0j136Dtkzipw/mo/photo.jpg?sz=128", "display_name": "Arjun C", "link": "https://stackoverflow.com/users/10084424/arjun-c"}, "edited": false, "score": 0, "creation_date": 1535012242, "post_id": 51974943, "comment_id": 90912104, "body": "I wanted to use this, but the problem is that the form is posting a Model to the server and I want to have some attachments posted from the same form. The problem is solved when I used the index based approach. Thanks though."}], "tags": [], "owner": {"reputation": 1354, "user_id": 10230250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd88700623b97c996d5407464bd9c2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dj079", "link": "https://stackoverflow.com/users/10230250/dj079"}, "is_accepted": false, "score": 0, "last_activity_date": 1534992868, "last_edit_date": 1534992868, "creation_date": 1534971121, "answer_id": 51974943, "question_id": 51974259, "link": "https://stackoverflow.com/questions/51974259/multiple-file-upload-in-asp-net-mvc-is-uploading-a-single-file-multiple-times/51974943#51974943", "title": "Multiple file upload in ASP.NET MVC is uploading a single file multiple times", "body": "<p><strong>Mudassar Ahmed Khan has explained it really well here:</strong> <a href=\"https://www.aspsnippets.com/Articles/MVC-HttpPostedFileBase-multiple-files-Upload-multiple-files-using-HttpPostedFileBase-in-ASPNet-MVC.aspx\" rel=\"nofollow noreferrer\">https://www.aspsnippets.com/Articles/MVC-HttpPostedFileBase-multiple-files-Upload-multiple-files-using-HttpPostedFileBase-in-ASPNet-MVC.aspx</a></p>\n\n<blockquote>\n  <p>You should consider using <code>List&lt;HttpPostedFileBase&gt;</code>  as method parameter in your controller method. And then loop through each of them. Something like below;</p>\n</blockquote>\n\n<pre><code>foreach (HttpPostedFileBase postedFile in postedFiles)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 if (postedFile != null)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 string fileName = Path.GetFileName(postedFile.FileName);\n</code></pre>\n\n<p>Hope this is helpful!</p>\n"}], "owner": {"reputation": 357, "user_id": 10084424, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zj2YyhN3k3k/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p6VpO81p8ICerhPw0j136Dtkzipw/mo/photo.jpg?sz=128", "display_name": "Arjun C", "link": "https://stackoverflow.com/users/10084424/arjun-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3728, "favorite_count": 0, "accepted_answer_id": 51974818, "answer_count": 2, "score": 0, "last_activity_date": 1534992868, "creation_date": 1534967950, "question_id": 51974259, "link": "https://stackoverflow.com/questions/51974259/multiple-file-upload-in-asp-net-mvc-is-uploading-a-single-file-multiple-times", "title": "Multiple file upload in ASP.NET MVC is uploading a single file multiple times", "body": "<p>I have a ASP.NET MVC project in which the user can upload multiple files at a time. The following code is in the View:</p>\n\n<pre><code>@using (Html.BeginForm(\"Edit\",\n            \"Bacteria\",\n            FormMethod.Post,\n            new { enctype = \"multipart/form-data\" }))\n{\n@Html.AntiForgeryToken()\n&lt;!--Other fields that are posted correctly to the db--&gt;\n &lt;div class=\"\"&gt;\n    &lt;label class=\"control-label col-md-2\"&gt;Attach New Files:&lt;/label&gt;\n    &lt;div class=\"col-md-10\"&gt;\n        &lt;input type=\"file\" id=\"Attachment\" name=\"Attachment\" class=\"form-control\" accept=\".xls,.xlsx,.csv,.CSV,.png,.jpeg,.jpg,.gif,.doc,.docx,.pdf,.PDF\" multiple /&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"form-group\"&gt;\n    &lt;div class=\"col-md-offset-2 col-md-10\"&gt;\n        &lt;input type=\"submit\" value=\"Save\" class=\"btn btn-default\" /&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The method in the controller is:</p>\n\n<pre><code>if (ModelState.IsValid)\n{\n    db.Entry(bacteria).State = EntityState.Modified;\n    db.SaveChanges();\n\n    foreach (string file in Request.Files)\n    {\n        HttpPostedFileBase hpf = Request.Files[file];\n        var fileName = Path.GetFileName(hpf.FileName);\n        if (fileName == null || fileName == \"\")\n        {\n            break;\n        }\n        var subPath = \"Attachments/Bacteria/\" + bacteria.ID + \"/\";\n        bool exists = System.IO.Directory.Exists(Server.MapPath(\"~/\" + subPath));\n        if (!exists)\n        {\n            System.IO.Directory.CreateDirectory(Server.MapPath(\"~/\" + subPath));\n        }\n        var path = Path.Combine(subPath, fileName);\n        hpf.SaveAs(Server.MapPath(\"~/\" + path));\n        BacteriaAttachment a = new BacteriaAttachment()\n        {\n            Name = fileName,\n            Bacteria = bacteria,\n            Link = path\n         };\n         db.BacteriaAttachments.Add(a);\n         db.SaveChanges();\n    }\n}\n</code></pre>\n\n<p>If I upload FileOne.png, FileTwo.png, FileThree.png; the BacteriaAttachements table will get 3 new records with all of them having the same name (such as FileOne.png), link and bacteriaID. Only their ID (the primary key) is unique. And only one file (E.g: FileOne.png) gets uploaded in the server. </p>\n\n<p>So instead of the three files being uploaded, only one of them is being uploaded thrice. </p>\n\n<p>Any help is much appreciated.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c#", "xamarin", "opayo"], "comments": [{"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 1, "creation_date": 1534967937, "post_id": 51974236, "comment_id": 90898935, "body": "It is no different than less-nested json. What is your code?"}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1534968041, "post_id": 51974236, "comment_id": 90898979, "body": "<a href=\"http://json2csharp.com/\" rel=\"nofollow noreferrer\">json2csharp.com</a>"}, {"owner": {"reputation": 1055, "user_id": 2310805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/REDuN.jpg?s=128&g=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/2310805/eugene"}, "edited": false, "score": 0, "creation_date": 1534968122, "post_id": 51974236, "comment_id": 90899008, "body": "Take a look this link <a href=\"https://stackoverflow.com/questions/9145667/how-to-post-json-to-the-server\">How to post JSON to the server?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 267, "user_id": 1489344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fdFQN.jpg?s=128&g=1", "display_name": "Daniel Rapaport", "link": "https://stackoverflow.com/users/1489344/daniel-rapaport"}, "is_accepted": false, "score": 0, "last_activity_date": 1534968382, "creation_date": 1534968382, "answer_id": 51974342, "question_id": 51974236, "link": "https://stackoverflow.com/questions/51974236/xamarin-c-post-to-restful-api/51974342#51974342", "title": "Xamarin/C# POST to RESTful api", "body": "<p>you basically represent the JSON as an object and wrap it </p>\n\n<pre><code>public class CardDetails\n{\n    public string cardholderName { get; set; }\n    public string cardNumber { get; set; }\n    public string expiryDate { get; set; }\n    public string securityCode { get; set; }\n}\n\npublic class YourObject\n{\n    public CardDetails cardDetails { get; set; }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "is_accepted": true, "score": 0, "last_activity_date": 1534968813, "creation_date": 1534968813, "answer_id": 51974434, "question_id": 51974236, "link": "https://stackoverflow.com/questions/51974236/xamarin-c-post-to-restful-api/51974434#51974434", "title": "Xamarin/C# POST to RESTful api", "body": "<p>You have your objects created in that link (json2csharp):</p>\n\n<pre><code>public class CardDetails\n{\n    public string cardholderName { get; set; }\n    public string cardNumber { get; set; }\n    public string expiryDate { get; set; }\n    public string securityCode { get; set; }\n}\n\npublic class RootObject\n{\n    public CardDetails cardDetails { get; set; }\n}\n</code></pre>\n\n<p>To serialize (JSON.Net):</p>\n\n<pre><code>var cardIdentifier = new RootObject{\n    cardDetails = new CardDetails{\n        cardholderName = \"EdSF\", \n        cardNumber = \"4111111111111111\", \n        expiryDate = \"0320\", \n        securityCode = \"123\"\n    }\n};\n\n\nConsole.WriteLine(JsonConvert.SerializeObject(cardIdentifier));\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>{\n  \"cardDetails\": {\n    \"cardholderName\": \"EdSF\",\n    \"cardNumber\": \"4111111111111111\",\n    \"expiryDate\": \"0320\",\n    \"securityCode\": \"123\"\n  }\n}\n</code></pre>\n\n<p>Hth....</p>\n"}], "owner": {"reputation": 25, "user_id": 2332757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66fc3072529ec84a999c11e1b19da95e?s=128&d=identicon&r=PG", "display_name": "Lewis Halliday", "link": "https://stackoverflow.com/users/2332757/lewis-halliday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 51974434, "answer_count": 2, "score": 0, "last_activity_date": 1534968813, "creation_date": 1534967848, "question_id": 51974236, "link": "https://stackoverflow.com/questions/51974236/xamarin-c-post-to-restful-api", "title": "Xamarin/C# POST to RESTful api", "body": "<p>Apologies if this is a stupid question, i've been thrown onto a project with very little prior C#/Xamarin knowledge and I've been banging my head against a wall with this for some time. </p>\n\n<p>So...</p>\n\n<p>I'm trying to make a post call to SagePay API \n(<a href=\"https://test.sagepay.com/documentation/#card-identifiers\" rel=\"nofollow noreferrer\">https://test.sagepay.com/documentation/#card-identifiers</a>)</p>\n\n<p>I've been accessing our API and i've accessed the other SagePay API fine,</p>\n\n<p>what i'm having issues with is that this call is a 'nested' json (apologies for incorrect terminology) </p>\n\n<p>How do I go about submitting a POST in this format</p>\n\n<pre><code>{\n\"cardDetails\":\n    {\n        \"cardholderName\": \"SAM JONES\",\n        \"cardNumber\": \"4929000000006\",\n        \"expiryDate\": \"0320\",\n        \"securityCode\": \"123\"\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "ssis", "active-directory"], "comments": [{"owner": {"reputation": 28745, "user_id": 1202807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09276b9edb245e928e7163b27b15691?s=128&d=identicon&r=PG", "display_name": "Gabriel Luci", "link": "https://stackoverflow.com/users/1202807/gabriel-luci"}, "edited": false, "score": 0, "creation_date": 1534981151, "post_id": 51974186, "comment_id": 90903249, "body": "Are you running the job with a domain account (not just the SYSTEM account)?"}, {"owner": {"reputation": 2736, "user_id": 4630376, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6a91de23186d36f9aef3ecacd421b9e6?s=128&d=identicon&r=PG&f=1", "display_name": "J Weezy", "link": "https://stackoverflow.com/users/4630376/j-weezy"}, "reply_to_user": {"reputation": 28745, "user_id": 1202807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09276b9edb245e928e7163b27b15691?s=128&d=identicon&r=PG", "display_name": "Gabriel Luci", "link": "https://stackoverflow.com/users/1202807/gabriel-luci"}, "edited": false, "score": 0, "creation_date": 1535034064, "post_id": 51974186, "comment_id": 90925524, "body": "@GabrielLuci I have updated my question"}], "owner": {"reputation": 2736, "user_id": 4630376, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/6a91de23186d36f9aef3ecacd421b9e6?s=128&d=identicon&r=PG&f=1", "display_name": "J Weezy", "link": "https://stackoverflow.com/users/4630376/j-weezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1535034266, "creation_date": 1534967569, "last_edit_date": 1535034266, "question_id": 51974186, "link": "https://stackoverflow.com/questions/51974186/ssis-active-directory-extract-getting-periodic-errors", "title": "SSIS Active Directory extract getting periodic errors", "body": "<p>I am running an Active Directory extract via SSIS Script Component and receiving the same error randomly:</p>\n\n<blockquote>\n  <p>Error Code: -1073450910 Error Description:\n  System.DirectoryServices.DirectoryServicesCOMException (0x80072020):\n  An operations error occurred.</p>\n  \n  <p>at\n  Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.HandleUserException(Exception\n  e)    at\n  Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput(Int32\n  outputs, Int32[] outputIDs, PipelineBuffer[] buffers)    at\n  Microsoft.SqlServer.Dts.Pipeline.ManagedComponentHost.HostPrimeOutput(IDTSManagedComponentWrapper100\n  wrapper, Int32 outputs, Int32[] outputIDs, IDTSBuffer100[] buffers,\n  IntPtr ppBufferWirePacket)</p>\n</blockquote>\n\n<p>I am unable to isolate what is causing the problem because it is happening randomly in many environments: production, development, my own laptop.</p>\n\n<p>When running the same script in the development application project, which makes it easier to identify what is causing problems, the problem goes away. When I re-run the application in development then it completes successfully.</p>\n\n<p>Does anyone know what is causing this random error?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I am running the job with an AD user account that is designated as a service account. I will note that there have been two phases to the project (I and II). </p>\n\n<ol>\n<li>Phase I has been in for 2+ months with no problem. </li>\n<li>When Phase II came up for release, which includes an enhancement to retrieve the <code>proxyaddresses</code> field, the problem started appearing intermittently. However, the new Phase II job was running in development for a month or two without problem. It wasn't until the day of the deployment (last Friday) did the problem first occur in the Stage environment.</li>\n</ol>\n"}, {"tags": ["c#", "noise", "lookup-tables"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 1, "creation_date": 1534968549, "post_id": 51974164, "comment_id": 90899173, "body": "We would need to see how <code>ni.noiseGen.Size</code> is created, and how it relates to the X, Y, and Z values. For example if it is a cubic 3D table, the X, Y, and Z will be the same dimensionally, but if it is not cubic Y may have a different size and using <code>.Size</code> may result in an out-of-bounds. So what we need to see is what <code>.Size</code> means in relation to each dimension."}, {"owner": {"reputation": 1802, "user_id": 7034621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZCc06.jpg?s=128&g=1", "display_name": "orhtej2", "link": "https://stackoverflow.com/users/7034621/orhtej2"}, "edited": false, "score": 0, "creation_date": 1534968600, "post_id": 51974164, "comment_id": 90899199, "body": "How is <code>ni.lookupTable</code> declared? Clearly in first example you fill <code>ni.noiseGen.Size</code>^2 cells and in second one you&#39;re trying to fill <code>ni.noiseGen.Size</code>^3 cells, is it long enough?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10261536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d1e1d03f537b21b7323b6a1a857963?s=128&d=identicon&r=PG&f=1", "display_name": "Spice", "link": "https://stackoverflow.com/users/10261536/spice"}, "is_accepted": false, "score": 1, "last_activity_date": 1534969247, "creation_date": 1534969247, "answer_id": 51974533, "question_id": 51974164, "link": "https://stackoverflow.com/questions/51974164/generating-lookup-table-for-3d-noise/51974533#51974533", "title": "Generating Lookup Table For 3D Noise", "body": "<p>Ah, after looking over how ni.lookupTable was declared I realized I forgot to multiply by the size one more time for 3D. It is now declared like this,</p>\n\n<pre><code>        ni.lookupTable = pools.FloatArrayPool.Pop(ni.noiseGen.Size*ni.noiseGen.Size*ni.noiseGen.Size);\n</code></pre>\n\n<p>My apologies!</p>\n"}], "owner": {"reputation": 11, "user_id": 10261536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91d1e1d03f537b21b7323b6a1a857963?s=128&d=identicon&r=PG&f=1", "display_name": "Spice", "link": "https://stackoverflow.com/users/10261536/spice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535000955, "creation_date": 1534967463, "last_edit_date": 1535000955, "question_id": 51974164, "link": "https://stackoverflow.com/questions/51974164/generating-lookup-table-for-3d-noise", "title": "Generating Lookup Table For 3D Noise", "body": "<p>I'm having trouble understanding why my lookup table is not working. I currently have one that generates a table for 2D noise, which works fine.</p>\n\n<pre><code>int xOffset = chunk.Pos.x;\nint zOffset = chunk.Pos.z;\n\n// Generate a lookup table\nint i = 0;\nfor (int z = 0; z&lt;ni.noiseGen.Size; z++)\n{\n    float zf = (z&lt;&lt;ni.noiseGen.Step)+zOffset;\n\n    for (int x = 0; x&lt;ni.noiseGen.Size; x++)\n    {\n        float xf = (x&lt;&lt;ni.noiseGen.Step)+xOffset;\n        ni.lookupTable[i++] = NoiseUtils.GetNoise(noise.Noise, xf, 0f, zf, 75f, 100, noise.Gain);\n    }\n}\n</code></pre>\n\n<p>When I try to iterate over a y axis, it does not work. An index out of range exception is thrown. Below is the attempted 3D lookup table.</p>\n\n<pre><code>int xOffset = chunk.Pos.x;\nint yOffset = chunk.Pos.y;\nint zOffset = chunk.Pos.z;\n\n// Generate a lookup table\nint i = 0;\nfor (int z = 0; z&lt;ni.noiseGen.Size; z++)\n{\n    float zf = (z&lt;&lt;ni.noiseGen.Step)+zOffset;\n\n    for (int y = 0; y&lt;ni.noiseGen.Size; y++)\n    {\n        float yf = (y&lt;&lt;ni.noiseGen.Step)+yOffset;\n\n        for (int x = 0; x&lt;ni.noiseGen.Size; x++)\n        {\n            float xf = (x&lt;&lt;ni.noiseGen.Step)+xOffset;\n            ni.lookupTable[i++] = NoiseUtils.GetNoise(noise.Noise, xf, yf, zf, 75f, 100, noise.Gain);\n        }\n    }\n}\n</code></pre>\n\n<p>I'd assume it'd be as easy as that, but I was wrong and do not understand why. Any enlightenment would be appreciated, thanks!</p>\n"}, {"tags": ["c#", "uwp", "uwp-xaml"], "answers": [{"tags": [], "owner": {"reputation": 3687, "user_id": 6346554, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/y8FJF.jpg?s=128&g=1", "display_name": "touseefbsb", "link": "https://stackoverflow.com/users/6346554/touseefbsb"}, "is_accepted": true, "score": 1, "last_activity_date": 1534970469, "creation_date": 1534970469, "answer_id": 51974788, "question_id": 51974119, "link": "https://stackoverflow.com/questions/51974119/uwp-frame-auto-resize-contents-inside/51974788#51974788", "title": "UWP Frame auto resize contents inside", "body": "<p>use the <strong>SizeChanged</strong> event tied to controls like Frame or Grids, and update the size in that event to keep it responsive.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 4762031, "user_type": "registered", "profile_image": "https://graph.facebook.com/1431805293798278/picture?type=large", "display_name": "St&#233;phane Vidouse", "link": "https://stackoverflow.com/users/4762031/st%c3%a9phane-vidouse"}, "is_accepted": false, "score": 0, "last_activity_date": 1535005957, "creation_date": 1535005957, "answer_id": 51979600, "question_id": 51974119, "link": "https://stackoverflow.com/questions/51974119/uwp-frame-auto-resize-contents-inside/51979600#51979600", "title": "UWP Frame auto resize contents inside", "body": "<p>If you're including another view in the frame, you should not do anything special for this... Could you explain more ?</p>\n"}], "owner": {"reputation": 29, "user_id": 3710388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa69da6ce1c4e23e1da086ddf5e692b1?s=128&d=identicon&r=PG&f=1", "display_name": "Edged", "link": "https://stackoverflow.com/users/3710388/edged"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 51974788, "answer_count": 2, "score": 2, "last_activity_date": 1535005957, "creation_date": 1534967285, "question_id": 51974119, "link": "https://stackoverflow.com/questions/51974119/uwp-frame-auto-resize-contents-inside", "title": "UWP Frame auto resize contents inside", "body": "<p>I got a window with a frame: </p>\n\n<p>&lt; Frame VerticalAlignment=\"Stretch\" VerticalContentAlignment=\"Stretch\"<br>\nHeight=\"Auto\"/></p>\n\n<p>And I want to fit in another window inside there. However, unless I hardcode the height, the Window will stay half empty, since its contents are sometimes not fully covering the Frame.</p>\n\n<p>Briefly, I have a Frame, in which I have a new Page, which has a Grid with 3 rows and they are of variable size depending on input from other parts. If the amount of contents is too small, the Window does not stretch, if the amount of contents is too big, the 3 rows go off the screen. I tried binding the height to its parent but that only seems to initially set the height and is not responsive to resizing of the App window.</p>\n\n<p>Any ideas how to fix that?</p>\n"}, {"tags": ["c#", "list", "serialization", "json.net"], "answers": [{"comments": [{"owner": {"reputation": 12857, "user_id": 4802649, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e3863cbe82a27e2480b7a969af49fe1f?s=128&d=identicon&r=PG", "display_name": "Phiter", "link": "https://stackoverflow.com/users/4802649/phiter"}, "edited": false, "score": 0, "creation_date": 1534967663, "post_id": 51974143, "comment_id": 90898819, "body": "Hey you&#39;re almost with the same points as I am. Take these 10 extra"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "reply_to_user": {"reputation": 12857, "user_id": 4802649, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e3863cbe82a27e2480b7a969af49fe1f?s=128&d=identicon&r=PG", "display_name": "Phiter", "link": "https://stackoverflow.com/users/4802649/phiter"}, "edited": false, "score": 0, "creation_date": 1534967749, "post_id": 51974143, "comment_id": 90898859, "body": "@Phiter And you as well!"}], "tags": [], "owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "is_accepted": false, "score": 2, "last_activity_date": 1534970873, "last_edit_date": 1534970873, "creation_date": 1534967366, "answer_id": 51974143, "question_id": 51974108, "link": "https://stackoverflow.com/questions/51974108/json-net-c-collection-serialize/51974143#51974143", "title": "json.net c# collection serialize", "body": "<p><code>preJsonData.inputs = inputs</code>... The list you are creating in your <code>MethodName</code> is not at all connected to the list inside your <code>preJsonData</code>.</p>\n\n<pre><code>public string MethodName(ref rdServerObjects rdObjects)\n{\n        RootObject preJsonData = new RootObject();\n\n        List&lt;Input&gt; inputs = new List&lt;Input&gt;();\n        Input input = new Input();\n        preJsonData.username = \"xxxx\";\n        preJsonData.password = \"yyyy\";\n        input.name = \"cccc\";\n        inputs.Add(input);\n        input = new Input();    //Add this line to keep from overwriting first\n        input.name = \"dddd\";\n        inputs.Add(input);\n\n        //THIS LINE\n        preJsonData.inputs = inputs;\n\n        string postJsonData = JsonConvert.SerializeObject(preJsonData);\n        //string postJsonData = new JavaScriptSerializer().Serialize(preJsonData);\n        return postJsonData;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9570436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c8b66ae46b3ee35020f19ebff2b1d3f?s=128&d=identicon&r=PG&f=1", "display_name": "VRam", "link": "https://stackoverflow.com/users/9570436/vram"}, "edited": false, "score": 0, "creation_date": 1534968748, "post_id": 51974145, "comment_id": 90899261, "body": "Thank you...one small issue still hanging. Even after i made the above change, i still get {&quot;username&quot;:&quot;xxxx&quot;,&quot;password&quot;:&quot;yyyy&quot;,&quot;inputs&quot;:[{&quot;name&quot;:&quot;dddd&zwnj;&#8203;&quot;},{&quot;name&quot;:&quot;dddd&quot;}]}&zwnj;&#8203;...Looks like the 1st inputs.add () is not taking effect or is overridden by any subsequent inputs.Add()...What is going on here?"}, {"owner": {"reputation": 12857, "user_id": 4802649, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e3863cbe82a27e2480b7a969af49fe1f?s=128&d=identicon&r=PG", "display_name": "Phiter", "link": "https://stackoverflow.com/users/4802649/phiter"}, "reply_to_user": {"reputation": 31, "user_id": 9570436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c8b66ae46b3ee35020f19ebff2b1d3f?s=128&d=identicon&r=PG&f=1", "display_name": "VRam", "link": "https://stackoverflow.com/users/9570436/vram"}, "edited": false, "score": 0, "creation_date": 1534969315, "post_id": 51974145, "comment_id": 90899525, "body": "Oh tricky isn&#39;t it? The thing is that input is the same so the same object is inserted twice in your list, and when you modify it, it is also updated in the list."}, {"owner": {"reputation": 12857, "user_id": 4802649, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e3863cbe82a27e2480b7a969af49fe1f?s=128&d=identicon&r=PG", "display_name": "Phiter", "link": "https://stackoverflow.com/users/4802649/phiter"}, "reply_to_user": {"reputation": 31, "user_id": 9570436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c8b66ae46b3ee35020f19ebff2b1d3f?s=128&d=identicon&r=PG&f=1", "display_name": "VRam", "link": "https://stackoverflow.com/users/9570436/vram"}, "edited": false, "score": 0, "creation_date": 1534969356, "post_id": 51974145, "comment_id": 90899542, "body": "check dj79&#39;s answer for a fix for that problem we overlooked"}], "tags": [], "owner": {"reputation": 12857, "user_id": 4802649, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e3863cbe82a27e2480b7a969af49fe1f?s=128&d=identicon&r=PG", "display_name": "Phiter", "link": "https://stackoverflow.com/users/4802649/phiter"}, "is_accepted": true, "score": 2, "last_activity_date": 1534967371, "creation_date": 1534967371, "answer_id": 51974145, "question_id": 51974108, "link": "https://stackoverflow.com/questions/51974108/json-net-c-collection-serialize/51974145#51974145", "title": "json.net c# collection serialize", "body": "<p>You didn't set the <code>inputs</code> property of <code>preJsonData</code>.</p>\n\n<pre><code>    List&lt;Input&gt; inputs = new List&lt;Input&gt;();\n    Input input = new Input();\n    preJsonData.username = \"xxxx\";\n    preJsonData.password = \"yyyy\";\n    input.name = \"cccc\";\n    inputs.Add(input);\n    input.name = \"dddd\";\n    inputs.Add(input);\n    preJsonData.inputs = inputs; //&lt;-- this bad boy\n    string postJsonData = JsonConvert.SerializeObject(preJsonData);\n    //string postJsonData = new JavaScriptSerializer().Serialize(preJsonData);\n    return postJsonData;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 9570436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c8b66ae46b3ee35020f19ebff2b1d3f?s=128&d=identicon&r=PG&f=1", "display_name": "VRam", "link": "https://stackoverflow.com/users/9570436/vram"}, "edited": false, "score": 1, "creation_date": 1534969544, "post_id": 51974265, "comment_id": 90899636, "body": "Awesome...that worked... Thank you all..Appreciate it."}], "tags": [], "owner": {"reputation": 1354, "user_id": 10230250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd88700623b97c996d5407464bd9c2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dj079", "link": "https://stackoverflow.com/users/10230250/dj079"}, "is_accepted": false, "score": 2, "last_activity_date": 1534967968, "creation_date": 1534967968, "answer_id": 51974265, "question_id": 51974108, "link": "https://stackoverflow.com/questions/51974108/json-net-c-collection-serialize/51974265#51974265", "title": "json.net c# collection serialize", "body": "<p>As Phiter &amp; Ron have mentioned, you didn't set the <code>inputs</code> property of <code>preJsonData</code>.</p>\n\n<p>One more part you are missing is, not re-initialising the <code>input</code> variable before setting its <code>name</code>. This will result in you getting \u201cdddd\u201d in your response. </p>\n\n<pre><code>Input input = new Input();\ninput.name = \"cccc\";\ninputs.Add(input);\ninput = new Input();\ninput.name = \"dddd\";\ninputs.Add(input);\npreJsonData.inputs = inputs;\n</code></pre>\n\n<p>This would fix your code. </p>\n"}], "owner": {"reputation": 31, "user_id": 9570436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c8b66ae46b3ee35020f19ebff2b1d3f?s=128&d=identicon&r=PG&f=1", "display_name": "VRam", "link": "https://stackoverflow.com/users/9570436/vram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 51974145, "answer_count": 3, "score": -1, "last_activity_date": 1535638905, "creation_date": 1534967195, "last_edit_date": 1535638905, "question_id": 51974108, "link": "https://stackoverflow.com/questions/51974108/json-net-c-collection-serialize", "title": "json.net c# collection serialize", "body": "<p>I have to build a JSON data that looks like the below. I am using JSON.net in C# to build the structure. \n<strong>{\n    \"username\":\"xxxx\",\n    \"password\":\"yyyy\",\n    \"inputs\" : \n    [ \n        {\n            \"name\" : \"cccc\"\n        },\n        {\n            \"name\" : \"dddd\"\n        } \n    ]\n}</strong></p>\n\n<p>The C# code looks like this.</p>\n\n<pre><code>    **public string MethodName(ref rdServerObjects rdObjects)\n    {\n        RootObject preJsonData = new RootObject();\n\n        List&lt;Input&gt; inputs = new List&lt;Input&gt;();\n        Input input = new Input();\n        preJsonData.username = \"xxxx\";\n        preJsonData.password = \"yyyy\";\n        input.name = \"cccc\";\n        inputs.Add(input);\n        input.name = \"dddd\";\n        inputs.Add(input);\n        string postJsonData = JsonConvert.SerializeObject(preJsonData);\n        return postJsonData;\n    }\n}\npublic class RootObject\n{\n    public string username { get; set; }\n    public string password { get; set; }\n    public List&lt;Input&gt; inputs { get; set; }\n}\npublic class Input\n{\n    public string name { get; set; }\n}**\n</code></pre>\n\n<p>When my code executes, the output comes as:</p>\n\n<p><strong>{\"username\":\"xxxx\",\"password\":\"yyyy\",\"inputs\":null}</strong></p>\n\n<p>Can someone please tell me what is wrong with my code? All help would be greatly appreciated.</p>\n\n<p>thanks</p>\n"}, {"tags": ["c#", "wpf", "multithreading", "asynchronous", "async-await"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 7, "creation_date": 1534967176, "post_id": 51974059, "comment_id": 90898608, "body": "If you want to avoid multiple clicks, disable the button until the task is complete. I would avoid rolling my own task system."}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 2, "creation_date": 1534967564, "post_id": 51974059, "comment_id": 90898776, "body": "If it&#39;s IO bound work like talking to a DB it shouldn&#39;t be using <code>Task.Run</code> at all, just async/await calls all the way down.  You only really need to spin up a thread if it&#39;s CPU bound work or if the IO doesn&#39;t expose async methods."}, {"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1534967652, "post_id": 51974059, "comment_id": 90898815, "body": "I&#39;m with @RonBeyer: Why do you want to allow your user to make multiple clicks without waiting for previous click &quot;result&quot;? Is it a value for the application and its user? Most of the times, it&#39;s not. But it actually depends on your scenario"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1534968661, "post_id": 51974059, "comment_id": 90899226, "body": "Why do you want to do this?  What are you hoping to gain from all of the work you&#39;re proposing doing?"}, {"owner": {"reputation": 1809, "user_id": 1383366, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3a4d9b9bba5c161be88d53ac75c6b7b5?s=128&d=identicon&r=PG", "display_name": "redcurry", "link": "https://stackoverflow.com/users/1383366/redcurry"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1534969500, "post_id": 51974059, "comment_id": 90899609, "body": "@Servy I&#39;m hoping to gain some consistency in handling UI events. For example, there could be a class that is the &quot;entry point&quot; of all non-UI code to be done (and executed on its own thread). This would make it harder to accidentally run non-UI code on the UI thread by new developers. I&#39;m also hoping to gain the piece of mind that the UI will be responsive regardless of the work being done---it could be long, it could be short---the point is that I don&#39;t even have to worry about it: it&#39;s all done on its own thread."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1534969627, "post_id": 51974059, "comment_id": 90899677, "body": "@redcurry And how is having a single thread handling all non-UI tasks through enqueued work accomplishing that any better than using the thread pool thread from the code in your question?"}, {"owner": {"reputation": 1809, "user_id": 1383366, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3a4d9b9bba5c161be88d53ac75c6b7b5?s=128&d=identicon&r=PG", "display_name": "redcurry", "link": "https://stackoverflow.com/users/1383366/redcurry"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1534970111, "post_id": 51974059, "comment_id": 90899906, "body": "@Servy It would afford some safety (let&#39;s say a developer forgot to disable the button referenced above that writes to a file or database). It would also remove the need to know or remember when to call <code>Task.Run</code>. Because all non-UI tasks would be executed on a separate thread, the UI would be responsive without calling <code>Task.Run</code> in every event handler."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1534971417, "post_id": 51974059, "comment_id": 90900463, "body": "@redcurry How do you expect to know what handlers are and are not using the UI, and how are you expecting to run whatever ones you determine to not need the UI as needing to use this other method?  And synchronizing all non-UI work wouldn&#39;t stop someone from pressing the button multiple times before the work finishes, it just means it&#39;s building up a big queue of work to do, perhaps without the user even realizing it.  That could be worse.  If you don&#39;t want the user to be allowed to press the button while the operation is running, you need to disable the button."}], "answers": [{"tags": [], "owner": {"reputation": 1000, "user_id": 1366407, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2D1g2.jpg?s=128&g=1", "display_name": "LadderLogic", "link": "https://stackoverflow.com/users/1366407/ladderlogic"}, "is_accepted": false, "score": 1, "last_activity_date": 1534967632, "creation_date": 1534967632, "answer_id": 51974195, "question_id": 51974059, "link": "https://stackoverflow.com/questions/51974059/is-it-a-good-idea-to-move-all-non-ui-code-to-a-different-thread/51974195#51974195", "title": "Is it a good idea to move all non-UI code to a different thread?", "body": "<p>What you're talking about is a <code>QueuedTaskScheduler</code> which could be found in parallel extensions.</p>\n\n<p>That being said, I wouldn't simply queue all the operations. While you now have a responsive UI, it'll appear as if nothing is actually happening. </p>\n\n<p>I wouldn't hesistate to do a Task.Factory.StartNew. A Task is not guaranteed to start a new thread. A Task and a Thread are two different things. The default task scheduler is smart enough to figure out if the required resources are available to start a new thread for the task. If you request a bunch of tasks to start at once, the queuing will happen automatically.</p>\n"}, {"tags": [], "owner": {"reputation": 1055, "user_id": 2310805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/REDuN.jpg?s=128&g=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/2310805/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1534967802, "creation_date": 1534967802, "answer_id": 51974230, "question_id": 51974059, "link": "https://stackoverflow.com/questions/51974059/is-it-a-good-idea-to-move-all-non-ui-code-to-a-different-thread/51974230#51974230", "title": "Is it a good idea to move all non-UI code to a different thread?", "body": "<p>For long running operation, it makes sense to use async in most of cases : <a href=\"https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/keep-the-ui-thread-responsive\" rel=\"nofollow noreferrer\">Keep the UI thread responsive</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 14634, "user_id": 64348, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/h3b3u.png?s=128&g=1", "display_name": "Kit", "link": "https://stackoverflow.com/users/64348/kit"}, "is_accepted": false, "score": 1, "last_activity_date": 1534969083, "creation_date": 1534969083, "answer_id": 51974495, "question_id": 51974059, "link": "https://stackoverflow.com/questions/51974059/is-it-a-good-idea-to-move-all-non-ui-code-to-a-different-thread/51974495#51974495", "title": "Is it a good idea to move all non-UI code to a different thread?", "body": "<p>Like many things, the answer is <strong>it depends</strong>. <code>async</code>/<code>await</code> all the way down is a good solution for I/O bound work as noted in the comments, and is the modern, preferred approach. <code>Task.Run()</code> is also ok.</p>\n\n<p>The pattern you describe <em>can</em> certainly be used to do what you want and would be a decent solution for keeping the UI responsive. Before you queue the command to the thread, disable your button. When your command completes you could set the button state to enabled (by \"enable/disable the button,\" I really mean changing a <code>bool</code> value on your view model). Your pattern is definitely suited to CPU bound work, but then so is <code>Task.Run()</code></p>\n\n<p>Your long running thread is basically a command queue, which can be advantageous if you need to serialize the work. So it can be a 'good' idea.</p>\n"}], "owner": {"reputation": 1809, "user_id": 1383366, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3a4d9b9bba5c161be88d53ac75c6b7b5?s=128&d=identicon&r=PG", "display_name": "redcurry", "link": "https://stackoverflow.com/users/1383366/redcurry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1534969083, "creation_date": 1534966911, "question_id": 51974059, "link": "https://stackoverflow.com/questions/51974059/is-it-a-good-idea-to-move-all-non-ui-code-to-a-different-thread", "title": "Is it a good idea to move all non-UI code to a different thread?", "body": "<p>I've seen many examples where long-running code is executed asynchronously from an event handler. For example, here's an event handler for a button click in WPF:</p>\n\n<pre><code>public async void Button_Click(object sender, EventArgs e)\n{\n    await Task.Run(() =&gt; DoWork());\n}\n\nprivate int DoWork()\n{\n    for (int i = 0; i &lt; 10000000; i++) { }\n    return 42;\n}\n</code></pre>\n\n<p>If <code>DoWork</code> was more complex, say wrote to a database, then multiple button clicks could cause multiple threads to try to write to the database at the same time.</p>\n\n<p>What if, instead of having many of these <code>Task.Run</code> calls, one creates a new single <code>Thread</code> for all non-UI work. Tasks could be queued on this thread using something like <code>BlockingCollection</code>.</p>\n\n<p>Because this thread is separate from the UI thread, the UI would still be responsive, and multiple button clicks would schedule the tasks (in order) to the same thread, avoiding concurrency issues.</p>\n\n<p>Is this a good idea?</p>\n"}, {"tags": ["c#", "angular", "asp.net-web-api", "web"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 2, "creation_date": 1534966593, "post_id": 51973977, "comment_id": 90898342, "body": "It would help if you showed your code that is throwing the errors."}, {"owner": {"reputation": 1, "user_id": 10118373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0tKAL8Ohnh8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pbNua8t9rcwzh6dbq44bxE206hyg/mo/photo.jpg?sz=128", "display_name": "itay tal", "link": "https://stackoverflow.com/users/10118373/itay-tal"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1534966868, "post_id": 51973977, "comment_id": 90898480, "body": "@Ron Beyer i cant uplode pic can i send it to you?"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 2, "creation_date": 1534966915, "post_id": 51973977, "comment_id": 90898492, "body": "Code is text, please <a href=\"https://stackoverflow.com/posts/51973977/edit\">edit your question</a> and add the code in there. Pictures of code don&#39;t help so much because we can&#39;t copy/paste and some images won&#39;t show up on some peoples computers."}, {"owner": {"reputation": 1, "user_id": 10118373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0tKAL8Ohnh8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pbNua8t9rcwzh6dbq44bxE206hyg/mo/photo.jpg?sz=128", "display_name": "itay tal", "link": "https://stackoverflow.com/users/10118373/itay-tal"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1534967506, "post_id": 51973977, "comment_id": 90898759, "body": "@Ron Beyer  been done"}, {"owner": {"reputation": 1477, "user_id": 4530745, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/DuBVx.png?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/4530745/nick"}, "edited": false, "score": 0, "creation_date": 1534970337, "post_id": 51973977, "comment_id": 90900017, "body": "Hey @itaytal.  Can you tell us which version of TypeScript and RxJS you are using (check your <code>package.json</code> file)?  It looks like others have may experienced this in the past. <a href=\"https://github.com/angular/angular/issues/17800\" rel=\"nofollow noreferrer\">github.com/angular/angular/issues/17800</a>"}, {"owner": {"reputation": 1, "user_id": 10118373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0tKAL8Ohnh8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pbNua8t9rcwzh6dbq44bxE206hyg/mo/photo.jpg?sz=128", "display_name": "itay tal", "link": "https://stackoverflow.com/users/10118373/itay-tal"}, "reply_to_user": {"reputation": 1477, "user_id": 4530745, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/DuBVx.png?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/4530745/nick"}, "edited": false, "score": 0, "creation_date": 1535028788, "post_id": 51973977, "comment_id": 90921918, "body": "@nickflynn it was 3.0. i change it to 2.4 and its working"}, {"owner": {"reputation": 1477, "user_id": 4530745, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/DuBVx.png?s=128&g=1", "display_name": "nick", "link": "https://stackoverflow.com/users/4530745/nick"}, "edited": false, "score": 0, "creation_date": 1535029821, "post_id": 51973977, "comment_id": 90922620, "body": "Cool.  Glad it&#39;s working then."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10118373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0tKAL8Ohnh8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pbNua8t9rcwzh6dbq44bxE206hyg/mo/photo.jpg?sz=128", "display_name": "itay tal", "link": "https://stackoverflow.com/users/10118373/itay-tal"}, "is_accepted": false, "score": 0, "last_activity_date": 1534970433, "creation_date": 1534970433, "answer_id": 51974775, "question_id": 51973977, "link": "https://stackoverflow.com/questions/51973977/web-api-with-angular-errors/51974775#51974775", "title": "web api with angular errors", "body": "<p>for error 2:\nneed to do casting for \"by.css('h1'))\" and import locator</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>import { browser, element, by } from 'protractor';\r\nimport { By } from 'selenium-webdriver';\r\nimport { Locator } from 'protractor/built/locators';\r\n\r\ndescribe('QuickStart E2E Tests', function () {\r\n\r\n  let expectedMsg = 'Hello Angular';\r\n\r\n  beforeEach(function () {\r\n    browser.get('');\r\n  });\r\n\r\n  it('should display: ' + expectedMsg, function () {\r\n    expect(element(&lt;Locator&gt;by.css('h1')).getText()).toEqual(expectedMsg);\r\n  });\r\n\r\n});</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1, "user_id": 10118373, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0tKAL8Ohnh8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pbNua8t9rcwzh6dbq44bxE206hyg/mo/photo.jpg?sz=128", "display_name": "itay tal", "link": "https://stackoverflow.com/users/10118373/itay-tal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534970433, "creation_date": 1534966511, "last_edit_date": 1534967720, "question_id": 51973977, "link": "https://stackoverflow.com/questions/51973977/web-api-with-angular-errors", "title": "web api with angular errors", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>import { browser, element, by } from 'protractor';\r\n\r\ndescribe('QuickStart E2E Tests', function () {\r\n\r\n  let expectedMsg = 'Hello Angular';\r\n\r\n  beforeEach(function () {\r\n    browser.get('');\r\n  });\r\n\r\n  it('should display: ' + expectedMsg, function () {\r\n    expect(element(by.css('h1')).getText()).toEqual(expectedMsg);\r\n  });\r\n\r\n});</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>import { Operator } from './Operator';\r\nimport { Observer } from './Observer';\r\nimport { Observable } from './Observable';\r\nimport { Subscriber } from './Subscriber';\r\nimport { ISubscription, Subscription } from './Subscription';\r\n/**\r\n * @class SubjectSubscriber&lt;T&gt;\r\n */\r\nexport declare class SubjectSubscriber&lt;T&gt; extends Subscriber&lt;T&gt; {\r\n    protected destination: Subject&lt;T&gt;;\r\n    constructor(destination: Subject&lt;T&gt;);\r\n}\r\n/**\r\n * @class Subject&lt;T&gt;\r\n */\r\nexport declare class Subject&lt;T&gt; extends Observable&lt;T&gt; implements ISubscription {\r\n    observers: Observer&lt;T&gt;[];\r\n    closed: boolean;\r\n    isStopped: boolean;\r\n    hasError: boolean;\r\n    thrownError: any;\r\n    constructor();\r\n    static create: Function;\r\n    lift&lt;R&gt;(operator: Operator&lt;T, R&gt;): Observable&lt;T&gt;;\r\n    next(value?: T): void;\r\n    error(err: any): void;\r\n    complete(): void;\r\n    unsubscribe(): void;\r\n    protected _subscribe(subscriber: Subscriber&lt;T&gt;): Subscription;\r\n    asObservable(): Observable&lt;T&gt;;\r\n}\r\n/**\r\n * @class AnonymousSubject&lt;T&gt;\r\n */\r\nexport declare class AnonymousSubject&lt;T&gt; extends Subject&lt;T&gt; {\r\n    protected destination: Observer&lt;T&gt;;\r\n    constructor(destination?: Observer&lt;T&gt;, source?: Observable&lt;T&gt;);\r\n    next(value: T): void;\r\n    error(err: any): void;\r\n    complete(): void;\r\n    protected _subscribe(subscriber: Subscriber&lt;T&gt;): Subscription;\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have just opened a new web api project using Angular. This is the first time I've been using Angular. I worked according to this guide: <a href=\"https://angular.io/guide/visual-studio-2015\" rel=\"nofollow noreferrer\">https://angular.io/guide/visual-studio-2015</a>\nBut I get errors. Does anyone know how to solve this?\nThanks!</p>\n\n<p><strong>erroe 1 :</strong></p>\n\n<blockquote>\n  <p>Severity   Code    Description Project File    Line    Suppression State\n  Error   TS2416  (TS) Property 'lift' in type 'Subject' is not assignable to the same property in base type 'Observable'.\n    Type '(operator: Operator) => Observable' is not assignable to type '(operator: Operator) => Observable'.\n      Type 'Observable' is not assignable to type 'Observable'.\n        Type 'T' is not assignable to type 'R'.   C:\\Users\\\u05d0\u05d9\u05ea\u05d9\\source\\repos\\Ctaxi - WeWorkShop\\Ctaxi - WeWorkShop\\src (tsconfig or jsconfig project) C:\\Users\\\u05d0\u05d9\u05ea\u05d9\\source\\repos\\Ctaxi - WeWorkShop\\Ctaxi - WeWorkShop\\node_modules\\rxjs\\Subject.d.ts 24  Active</p>\n</blockquote>\n\n<p><strong>error 2:</strong></p>\n\n<blockquote>\n  <p>Severity   Code    Description Project File    Line    Suppression State\n  Error   TS2559  (TS) Type 'By' has no properties in common with type 'Locator'. C:\\Users\\\u05d0\u05d9\u05ea\u05d9\\source\\repos\\Ctaxi - WeWorkShop\\Ctaxi - WeWorkShop\\e2e (tsconfig or jsconfig project) C:\\Users\\\u05d0\u05d9\u05ea\u05d9\\source\\repos\\Ctaxi - WeWorkShop\\Ctaxi - WeWorkShop\\e2e\\app.e2e-spec.ts    12  Active</p>\n</blockquote>\n"}, {"tags": ["c#", "entity-framework"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 2, "creation_date": 1534966598, "post_id": 51973941, "comment_id": 90898346, "body": "This is asking about the behavior of Entity Framework, not MVC."}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 2, "creation_date": 1534966777, "post_id": 51973941, "comment_id": 90898437, "body": "Is <code>context</code> a shared instance between the repositories or does each repo have its own?"}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 1, "creation_date": 1534967014, "post_id": 51973941, "comment_id": 90898540, "body": "I think it would awkward to call Save on one repo and have it actually save them all. At best it would cause developer misunderstanding. I hope each repo has its own context."}, {"owner": {"reputation": 1691, "user_id": 2568863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tf0h7.jpg?s=128&g=1", "display_name": "Dongdong", "link": "https://stackoverflow.com/users/2568863/dongdong"}, "edited": false, "score": 1, "creation_date": 1534968041, "post_id": 51973941, "comment_id": 90898980, "body": "<code>UnitOfWork</code> will save you. one operation is a kind of <code>transaction</code>, if one of them fail, others should fail too. so you cannot <code>save</code> one by one, no matter in that project. BTW, Repository Pattern is an anti-pattern, avoid to use it."}, {"owner": {"reputation": 371, "user_id": 6058174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XFXu0.png?s=128&g=1", "display_name": "Matthiee", "link": "https://stackoverflow.com/users/6058174/matthiee"}, "edited": false, "score": 0, "creation_date": 1534968180, "post_id": 51973941, "comment_id": 90899031, "body": "Try UoW pattern, see: <a href=\"https://docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application#creating-the-unit-of-work-class\" rel=\"nofollow noreferrer\">Creating the Unit of Work (MSDN)</a>"}, {"owner": {"reputation": 15541, "user_id": 526724, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fafcd128fb9ba805b41d8770c0345cc?s=128&d=identicon&r=PG", "display_name": "Bradley Uffner", "link": "https://stackoverflow.com/users/526724/bradley-uffner"}, "edited": false, "score": 4, "creation_date": 1534968509, "post_id": 51973941, "comment_id": 90899156, "body": "The Entity Framework <code>DbContext</code> is ALREADY using the Unit of Work pattern. You do NOT need to try and build a UoW framework around it. You will just end up creating pain and trouble for yourself. Unit of Work, is an Entity Framework Anti-Pattern."}, {"owner": {"reputation": 1691, "user_id": 2568863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tf0h7.jpg?s=128&g=1", "display_name": "Dongdong", "link": "https://stackoverflow.com/users/2568863/dongdong"}, "reply_to_user": {"reputation": 15541, "user_id": 526724, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fafcd128fb9ba805b41d8770c0345cc?s=128&d=identicon&r=PG", "display_name": "Bradley Uffner", "link": "https://stackoverflow.com/users/526724/bradley-uffner"}, "edited": false, "score": 0, "creation_date": 1534968576, "post_id": 51973941, "comment_id": 90899185, "body": "@BradleyUffner no, it&#39;s just data access layer, but for business logic layer, we need another wrapper."}, {"owner": {"reputation": 202, "user_id": 7003817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b651d5daa52cd9c4ad0caa2af2deca63?s=128&d=identicon&r=PG&f=1", "display_name": "C Smith", "link": "https://stackoverflow.com/users/7003817/c-smith"}, "edited": false, "score": 1, "creation_date": 1534969273, "post_id": 51973941, "comment_id": 90899505, "body": "You will need to show us how you are creating the context and setting it in the repo&#39;s otherwise we are just guessing"}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 2, "creation_date": 1534969530, "post_id": 51973941, "comment_id": 90899625, "body": "&quot;I could just try myself and see what works&quot; Sure! This has nothing to do with MVC. It&#39;s only about how you happen to implement the repository pattern of which we don&#39;t see all relevant details. So at this moment you&#39;re the only one who can give the &quot;definite answer&quot;"}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1534972350, "post_id": 51973941, "comment_id": 90900832, "body": "On a related note: never skip the basics."}, {"owner": {"reputation": 1235, "user_id": 5086100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20dbc2adfd0ba7f15b5956ec4dd3b516?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred Wallace", "link": "https://stackoverflow.com/users/5086100/alfred-wallace"}, "reply_to_user": {"reputation": 202, "user_id": 7003817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b651d5daa52cd9c4ad0caa2af2deca63?s=128&d=identicon&r=PG&f=1", "display_name": "C Smith", "link": "https://stackoverflow.com/users/7003817/c-smith"}, "edited": false, "score": 0, "creation_date": 1535033289, "post_id": 51973941, "comment_id": 90924988, "body": "@CSmith - I just added the context creation code. Can you comment on that?"}, {"owner": {"reputation": 1235, "user_id": 5086100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20dbc2adfd0ba7f15b5956ec4dd3b516?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred Wallace", "link": "https://stackoverflow.com/users/5086100/alfred-wallace"}, "reply_to_user": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1535035463, "post_id": 51973941, "comment_id": 90926475, "body": "@TylerH - as I keep learning, the basics keep changing..."}, {"owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "edited": false, "score": 0, "creation_date": 1535035773, "post_id": 51973941, "comment_id": 90926677, "body": "@Alfred The basics may expand a bit over time, but just because we have discovered stuff beyond calculus today does not mean you can skip basic arithmetic and jump straight to algebra or geometry :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1235, "user_id": 5086100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20dbc2adfd0ba7f15b5956ec4dd3b516?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred Wallace", "link": "https://stackoverflow.com/users/5086100/alfred-wallace"}, "edited": false, "score": 0, "creation_date": 1535035101, "post_id": 51974650, "comment_id": 90926247, "body": "Very constructive answer and useful tip with  <code>context.ChangeTracker</code>. As a best practice, do you recommend saving in 2 steps <code>orderRepository.UpdateOrder(order); orderRepository.Save();</code> or 1 step by including Save() inside <code>orderRepository.UpdateOrder(order);</code>?"}, {"owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "reply_to_user": {"reputation": 1235, "user_id": 5086100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20dbc2adfd0ba7f15b5956ec4dd3b516?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred Wallace", "link": "https://stackoverflow.com/users/5086100/alfred-wallace"}, "edited": false, "score": 0, "creation_date": 1535056125, "post_id": 51974650, "comment_id": 90937279, "body": "If possible, only one round trip (save) should be used. However, as you open two difference contexts, in your case it must be called for both unless you are injecting one into the other."}], "tags": [], "owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "is_accepted": true, "score": 1, "last_activity_date": 1534969784, "creation_date": 1534969784, "answer_id": 51974650, "question_id": 51973941, "link": "https://stackoverflow.com/questions/51973941/how-often-do-i-need-to-save-the-context/51974650#51974650", "title": "How often do I need to save the context?", "body": "<blockquote>\n  <p>How often do I need to save the context?</p>\n</blockquote>\n\n<p>As often as it makes sense to do so. In general, you will want to only call SaveChanges once, unless dealing with large sets in which case it will make sense to use transactions and save in batches.</p>\n\n<blockquote>\n  <p>Will calling Save() inside each repository save only changes to the context there, or will it save each and every change made to context in any other repositories up to that point?</p>\n</blockquote>\n\n<p>\"the context there\" is kind of vague. Calling SaveChanges will save <em>all</em> changes made inside of the context. So, if both <code>vendorOrderRepository</code> and <code>orderRepository</code> share the same context, then calling it once will save every change made.</p>\n\n<blockquote>\n  <p>In my example, is it redundant to call Save() twice? Will it work if I just call Save() at the very end?</p>\n</blockquote>\n\n<p>If they use the same context, then yes. If different, then it is not redundant.</p>\n\n<hr>\n\n<p>In a broader sense, the way that SaveChanges works is that it will save the entities stored in the change tracker (See <a href=\"https://docs.microsoft.com/en-us/ef/core/api/microsoft.entityframeworkcore.changetracking.changetracker\" rel=\"nofollow noreferrer\">ChangeTracker Class <sup>MDN</sup></a> for expanded details). The change tracker (accessible through <code>context.ChangeTracker</code>), among other things, holds a set of entities that it tracks. These will be the entities which are updated during SaveChanges, and technically these entities are referred to as being \"attached\".</p>\n\n<p>You can see the list of entities attached by type by iterating <code>context.ChangeTracker.Entries&lt;T&gt;()</code> where <code>T</code> is your type.</p>\n"}], "owner": {"reputation": 1235, "user_id": 5086100, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/20dbc2adfd0ba7f15b5956ec4dd3b516?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred Wallace", "link": "https://stackoverflow.com/users/5086100/alfred-wallace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 51974650, "answer_count": 1, "score": 1, "last_activity_date": 1535033242, "creation_date": 1534966335, "last_edit_date": 1535033242, "question_id": 51973941, "link": "https://stackoverflow.com/questions/51973941/how-often-do-i-need-to-save-the-context", "title": "How often do I need to save the context?", "body": "<p>In a repository, I am doing these two consecutive tasks:</p>\n\n<pre><code>// Update vendorOrder\nvendorOrder.VendorOrderStatus = VendorOrderStatus.Completed;\nvendorOrderRepository.UpdateVendorOrder(vendorOrder);\nvendorOrderRepository.Save();\n// Update order\norder.OrderStatus = OrderStatus.Completed;\norderRepository.UpdateOrder(order);\norderRepository.Save();\n</code></pre>\n\n<p>Both <code>vendorOrderRepository</code> and <code>orderRepositoryrepositorty</code> have their own <code>Save()</code> method:</p>\n\n<pre><code>public void Save()\n{\n    context.SaveChanges();\n}\n</code></pre>\n\n<ul>\n<li><p>Will calling <code>Save()</code> inside each repository save only changes to the \ncontext there, or will it save each and every change made to context\nin any other repositories up to that point?</p></li>\n<li><p>In my example, is it redundant to call <code>Save()</code> twice? Will it work if I just call <code>Save()</code> at the very end?</p></li>\n</ul>\n\n<p>(I could just try myself and see what works, but I want to have a definite answer based on how MVC works if possible, in case there are exceptions. It's probably basic understanding of MVC, but I skipped that part...)</p>\n\n<h2>Edit 1</h2>\n\n<p>vendorOrderRepository begins with:</p>\n\n<pre><code>public class VendorOrderRepository : IVendorOrderRepository, IDisposable\n{\n    private ApplicationDbContext context = new ApplicationDbContext();\n    private IOrderRepository orderRepository;\n    public VendorOrderRepository(ApplicationDbContext context)\n    {\n        this.context = context;\n        orderRepository = new OrderRepository(context);\n    }\n</code></pre>\n\n<p>orderRepository begins with:</p>\n\n<pre><code>public class OrderRepository : IOrderRepository, IDisposable\n{\n    private ApplicationDbContext context = new ApplicationDbContext();\n    private IVendorOrderRepository vendorOrderRepository;\n    public OrderRepository(ApplicationDbContext context)\n    {\n        this.context = context;\n        vendorOrderRepository = new VendorOrderRepository(context);\n    }\n</code></pre>\n"}, {"tags": ["c#", "xamarin.forms", "binding", "uiswitch"], "comments": [{"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 1, "creation_date": 1534966580, "post_id": 51973899, "comment_id": 90898340, "body": "the switch will inherit the page&#39;s BindingContext, or you can set a different one via XAML/code for just that element"}, {"owner": {"reputation": 2395, "user_id": 5165961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2y4EQ.jpg?s=128&g=1", "display_name": "Almir Vuk", "link": "https://stackoverflow.com/users/5165961/almir-vuk"}, "edited": false, "score": 1, "creation_date": 1535010689, "post_id": 51973899, "comment_id": 90911239, "body": "Also I recommend you to separate your models which you are using for Binding."}], "owner": {"reputation": 145, "user_id": 10133988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b06906586450e95069267fadb51174e?s=128&d=identicon&r=PG&f=1", "display_name": "positive perspective", "link": "https://stackoverflow.com/users/10133988/positive-perspective"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534966170, "creation_date": 1534966170, "question_id": 51973899, "link": "https://stackoverflow.com/questions/51973899/setting-binding-on-switch-in-xamarin-forms", "title": "Setting Binding on Switch in Xamarin.Forms", "body": "<p>I am using <code>Switch</code> to toggle some value.</p>\n\n<pre><code>&lt;Switch x:Name=\"masterSwitch\"  Grid.Row=\"1\" Grid.Column=\"0\" IsToggled=\"{Binding Value}\"/&gt;\n</code></pre>\n\n<p>Value is the parameter of record in table:</p>\n\n<pre><code>public class MasterSwitch\n{\n    [PrimaryKey, AutoIncrement]\n    public int Id { get; set; }\n    public DateTime Date { get; set; }\n    public bool Value { get; set; }\n}\n</code></pre>\n\n<p>But how do I specify which table look to?\nI want the switch be bound to <code>MasterSwitch</code> table(the one I've got model for).</p>\n\n<p>DO I set the <code>BindingContext</code> in xaml?</p>\n"}, {"tags": ["c#", "wpf", "entity-framework"], "answers": [{"comments": [{"owner": {"reputation": 23519, "user_id": 1177814, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/4Kl3d.jpg?s=128&g=1", "display_name": "Dipen Shah", "link": "https://stackoverflow.com/users/1177814/dipen-shah"}, "reply_to_user": {"reputation": 147, "user_id": 6635930, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10206994739539166/picture?type=large", "display_name": "Lawrence Vo", "link": "https://stackoverflow.com/users/6635930/lawrence-vo"}, "edited": false, "score": 0, "creation_date": 1534973188, "post_id": 51974329, "comment_id": 90901150, "body": "I don&#39;t think I have any good resource available right out of my mind, but you could search for design patterns by martin fowler that is a good resource. Also, you can browse <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/standard</a> for M$ suggested practices."}], "tags": [], "owner": {"reputation": 23519, "user_id": 1177814, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/4Kl3d.jpg?s=128&g=1", "display_name": "Dipen Shah", "link": "https://stackoverflow.com/users/1177814/dipen-shah"}, "is_accepted": false, "score": 1, "last_activity_date": 1534968307, "creation_date": 1534968307, "answer_id": 51974329, "question_id": 51973806, "link": "https://stackoverflow.com/questions/51973806/wpf-how-to-automatically-update-combobox-items-after-entity-framework-dbcontex/51974329#51974329", "title": "WPF - How to automatically update ComboBox items after Entity Framework DbContext saveChanges()?", "body": "<p>I were you I would use following approach:</p>\n\n<ol>\n<li>Add event to <code>EmployeeService</code> called <code>EmployeeCreated</code></li>\n<li>Invoke <code>EmployeeCreated</code> event every time you successfully add new employee </li>\n<li>Subscribe to <code>EmployeeCreated</code> event</li>\n<li>Update combobox items when event is invoked</li>\n</ol>\n\n<p>P.S I'm assuming you have service tier available and you are not interacting with <code>DbContext</code> directly.</p>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 2857650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ToJe.jpg?s=128&g=1", "display_name": "Subasish", "link": "https://stackoverflow.com/users/2857650/subasish"}, "is_accepted": false, "score": 0, "last_activity_date": 1534995898, "creation_date": 1534995898, "answer_id": 51978041, "question_id": 51973806, "link": "https://stackoverflow.com/questions/51973806/wpf-how-to-automatically-update-combobox-items-after-entity-framework-dbcontex/51978041#51978041", "title": "WPF - How to automatically update ComboBox items after Entity Framework DbContext saveChanges()?", "body": "<p>All you need is to create an ObservableCollection, perhaps can call it Employees. Bind your combobox itemsource to Employees.\nImplement INotifyPropertyChange interface in your view model if you are using MVVM or simply in your DataContext class and raise the PropertyChanged event each time your collection changes.\nEverytime you update your Employees, changes should reflect on the UI.</p>\n"}], "owner": {"reputation": 147, "user_id": 6635930, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10206994739539166/picture?type=large", "display_name": "Lawrence Vo", "link": "https://stackoverflow.com/users/6635930/lawrence-vo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534995898, "creation_date": 1534965884, "question_id": 51973806, "link": "https://stackoverflow.com/questions/51973806/wpf-how-to-automatically-update-combobox-items-after-entity-framework-dbcontex", "title": "WPF - How to automatically update ComboBox items after Entity Framework DbContext saveChanges()?", "body": "<p>So right now, I have a table with columns <code>EmployeeID, EmployeeName</code>. I also have a <code>ComboBox</code> in my WPF application that displays the <code>EmployeeName</code>. I used the <code>Entity Framework's Code First From Database</code> to generate a <code>DbContext</code> called <code>MyDbContext</code> and a class called <code>Employee</code>.</p>\n\n<p>Everytime I create a new <code>Employee</code>, how do I get this combobox to automatically update with the new Employee name?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "outsystems"], "answers": [{"comments": [{"owner": {"reputation": 1876, "user_id": 1144596, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7048b7a97634293717d07a27429e0958?s=128&d=identicon&r=PG", "display_name": "user1144596", "link": "https://stackoverflow.com/users/1144596/user1144596"}, "edited": false, "score": 0, "creation_date": 1534974291, "post_id": 51975445, "comment_id": 90901575, "body": "Cool, but when they do supply the code, will that be a 100% complete and work straight in visual studio?"}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 1876, "user_id": 1144596, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7048b7a97634293717d07a27429e0958?s=128&d=identicon&r=PG", "display_name": "user1144596", "link": "https://stackoverflow.com/users/1144596/user1144596"}, "edited": false, "score": 0, "creation_date": 1534974369, "post_id": 51975445, "comment_id": 90901605, "body": "HAHAHAHAHAHA.  If they were going to do that they would supply the code every time you did a build. They supply the code only when it is too late to complain."}, {"owner": {"reputation": 1876, "user_id": 1144596, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7048b7a97634293717d07a27429e0958?s=128&d=identicon&r=PG", "display_name": "user1144596", "link": "https://stackoverflow.com/users/1144596/user1144596"}, "edited": false, "score": 0, "creation_date": 1534974425, "post_id": 51975445, "comment_id": 90901623, "body": "so what do they supply then?"}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 1876, "user_id": 1144596, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7048b7a97634293717d07a27429e0958?s=128&d=identicon&r=PG", "display_name": "user1144596", "link": "https://stackoverflow.com/users/1144596/user1144596"}, "edited": false, "score": 0, "creation_date": 1534974480, "post_id": 51975445, "comment_id": 90901646, "body": "I don&#39;t know, I only know they won&#39;t supply it until you cancel your contract. Then they PINKY PROMISE you get a perfectly good set of code. \u2026 but no way to check beforehand if it actually compiles."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 1876, "user_id": 1144596, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7048b7a97634293717d07a27429e0958?s=128&d=identicon&r=PG", "display_name": "user1144596", "link": "https://stackoverflow.com/users/1144596/user1144596"}, "edited": false, "score": 0, "creation_date": 1534974571, "post_id": 51975445, "comment_id": 90901678, "body": "Happy to help!!"}, {"owner": {"reputation": 9627, "user_id": 19401, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/16a3d0fd9b0af26bbea094b64a52cea6?s=128&d=identicon&r=PG", "display_name": "Miguel Ventura", "link": "https://stackoverflow.com/users/19401/miguel-ventura"}, "edited": false, "score": 0, "creation_date": 1535569087, "post_id": 51975445, "comment_id": 91119057, "body": "Exporting the source code is also available during product evaluation, so you can use that period to evaluate the quality of the exported code."}, {"owner": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 0, "creation_date": 1547742008, "post_id": 51975445, "comment_id": 95304757, "body": "@Ben what&#39;s the point of getting it on-demand? You can&#39;t do any changes and &quot;import it back&quot; into the product. Whoever uses OutSystems, is not looking to use OutSystems as an easier way to build ASPX code - it&#39;s looking for an easier way to build applications as a whole. So, if the money you spend on licensing is not worth the time you&#39;re saving on current developments (corrective maintenance of a &quot;very, very stable app&quot;), you cancel the license and get your code because you&#39;re not taking advantage of it anymore. They sell a platform, not a product to build ASPX pages."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 0, "creation_date": 1547742522, "post_id": 51975445, "comment_id": 95305074, "body": "@ArmandoGomes the point is <b>I don&#39;t trust them</b>. Getting it on demand is the only way to make sure you can create a migration path away from Outsystems, and therefore the only way to make sure your business does not become a prisoner of Outsystems. The fact that they don&#39;t give it on demand tells me their <b>intention</b> is that I <b>should</b> become a prisoner locked into their expensive solution."}, {"owner": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 0, "creation_date": 1547832532, "post_id": 51975445, "comment_id": 95341675, "body": "@Ben if you don&#39;t trust a company neither the signed contracts between parties, then you should look for another vendor. Obviously, their interest is that you remain as their customer - any business loves to keep customers. I&#39;m an OutSystems MVP, just for disclosure. Creating a migration path from OutSystems shall involve OutSystems itself, because it means that you want to stop being their customer. If you want, I can (try to) get you numbers on % of customers that requested the source code and any more related info. Just let me know."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 0, "creation_date": 1547899467, "post_id": 51975445, "comment_id": 95357093, "body": "@ArmandoGomes I asked for the generated source and the company flatly refused. This is not the action of a trustworthy supplier in my opinion."}, {"owner": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 0, "creation_date": 1547908145, "post_id": 51975445, "comment_id": 95359038, "body": "@Ben were you in an eligible position to request the source code? I.e., ending your contract or during product evaluation? Because if you were and you didn&#39;t get it, then we have a problem that I would like to follow up. If you were not, well... that&#39;s a different story - with the refusal being a sign why they are thrustworthy: there&#39;s a contract to be followed upon."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 0, "creation_date": 1547910287, "post_id": 51975445, "comment_id": 95359625, "body": "@ArmandoGomes putting such a restriction in the contract is, in my opinion, a trap, and a clear indication of bad faith in itself. I have explained why. You may disagree with my opinion, that is up to you."}, {"owner": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 0, "creation_date": 1548092117, "post_id": 51975445, "comment_id": 95410696, "body": "@Ben I agree that we won&#39;t agree. I&#39;ll ask you that, in the case that you didn&#39;t had a pleasant experience, that you approach the company and tell them that. Other than that, I would ask to not make assumptions on the good faith - and signed contracts - of a company, possibly misleading other (current/prospective) users of the platform."}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "reply_to_user": {"reputation": 107, "user_id": 7172120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmYrZ.jpg?s=128&g=1", "display_name": "Armando Gomes", "link": "https://stackoverflow.com/users/7172120/armando-gomes"}, "edited": false, "score": 1, "creation_date": 1548092644, "post_id": 51975445, "comment_id": 95410917, "body": "@ArmandoGomes If Outsystems policy has changed and they no longer put this in their contracts and now give source code on request, then I would be glad to know that. Otherwise, I am setting out what happened for me. If others think &quot;that&#39;s fine why is he making a fuss&quot; then that&#39;s their business. I do not think it is fine, and I am warning others of this behaviour, which I personally consider bad."}], "tags": [], "owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1534973571, "creation_date": 1534973571, "answer_id": 51975445, "question_id": 51973789, "link": "https://stackoverflow.com/questions/51973789/convert-a-project-from-outsystems-to-c-visual-studio-solution/51975445#51975445", "title": "Convert a project from OutSystems to C# Visual Studio solution", "body": "<p>Yes. the steps are as follows:</p>\n\n<ol>\n<li>You must first cancel your contract with OutSystems</li>\n<li>Once you have done this, then, and <strong>only</strong> then, they will supply you with C#/ASPX code for your solution.</li>\n</ol>\n\n<p>They won't do this until you cancel the contract.</p>\n"}], "owner": {"reputation": 1876, "user_id": 1144596, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/7048b7a97634293717d07a27429e0958?s=128&d=identicon&r=PG", "display_name": "user1144596", "link": "https://stackoverflow.com/users/1144596/user1144596"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534973571, "creation_date": 1534965811, "question_id": 51973789, "link": "https://stackoverflow.com/questions/51973789/convert-a-project-from-outsystems-to-c-visual-studio-solution", "title": "Convert a project from OutSystems to C# Visual Studio solution", "body": "<p>We have an OutSystems subscription and we like to convert/ export that code into C#. Is there a \"reverse-converter\" or any other export tool?</p>\n\n<p>I am unable to define the approach and any help in this direction will be most useful.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "asp.net-web-api"], "comments": [{"owner": {"reputation": 59385, "user_id": 2630078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UHzHh.png?s=128&g=1", "display_name": "Kirk Larkin", "link": "https://stackoverflow.com/users/2630078/kirk-larkin"}, "edited": false, "score": 3, "creation_date": 1534966792, "post_id": 51973631, "comment_id": 90898444, "body": "You really don\u2019t need to handle OPTIONS this way. It\u2019s built-in to ASP.NET WebApi. See <a href=\"https://enable-cors.org/server_aspnet.html\" rel=\"nofollow noreferrer\">here</a> for more on how to set it up."}, {"owner": {"reputation": 1237, "user_id": 2498528, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/55d4d094bb5e738bb706d9a4a0dba730?s=128&d=identicon&r=PG", "display_name": "AnKing", "link": "https://stackoverflow.com/users/2498528/anking"}, "reply_to_user": {"reputation": 59385, "user_id": 2630078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UHzHh.png?s=128&g=1", "display_name": "Kirk Larkin", "link": "https://stackoverflow.com/users/2630078/kirk-larkin"}, "edited": false, "score": 0, "creation_date": 1534968274, "post_id": 51973631, "comment_id": 90899068, "body": "@KirkLarkin That&#39;s exactly what I&#39;ve been looking for! Thanks a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 2498528, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/55d4d094bb5e738bb706d9a4a0dba730?s=128&d=identicon&r=PG", "display_name": "AnKing", "link": "https://stackoverflow.com/users/2498528/anking"}, "edited": false, "score": 0, "creation_date": 1534966355, "post_id": 51973776, "comment_id": 90898242, "body": "wow, this seem like too much code for a very trivial function I&#39;m looking for. Is there a way to do this easier maybe by implementing filters?"}, {"owner": {"reputation": 999, "user_id": 6427909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd38e8f0df24e4302b6a0543e404bd?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek", "link": "https://stackoverflow.com/users/6427909/tarek"}, "reply_to_user": {"reputation": 1237, "user_id": 2498528, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/55d4d094bb5e738bb706d9a4a0dba730?s=128&d=identicon&r=PG", "display_name": "AnKing", "link": "https://stackoverflow.com/users/2498528/anking"}, "edited": false, "score": 0, "creation_date": 1534966661, "post_id": 51973776, "comment_id": 90898382, "body": "Yes, I think you can also create your own custom ActionFilter and either apply it globally in web api config, or on the controller level."}], "tags": [], "owner": {"reputation": 999, "user_id": 6427909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd38e8f0df24e4302b6a0543e404bd?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek", "link": "https://stackoverflow.com/users/6427909/tarek"}, "is_accepted": false, "score": 1, "last_activity_date": 1534966857, "last_edit_date": 1534966857, "creation_date": 1534965739, "answer_id": 51973776, "question_id": 51973631, "link": "https://stackoverflow.com/questions/51973631/wildcard-in-route-attribute-for-webapi/51973776#51973776", "title": "Wildcard in route attribute for webApi", "body": "<p>First I think you should check the regular attribute routing constrains found <a href=\"https://docs.microsoft.com/en-us/aspnet/web-api/overview/web-api-routing-and-actions/attribute-routing-in-web-api-2#route-constraints\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Secondly what you want to do can be done but you have to implement your own <a href=\"https://docs.microsoft.com/en-us/aspnet/web-api/overview/web-api-routing-and-actions/attribute-routing-in-web-api-2#custom-route-constraints\" rel=\"nofollow noreferrer\">Custom Route Constraint</a> but it probably won't be a wildcard (*) symbol.</p>\n\n<p>From Microsoft docs links above:</p>\n\n<blockquote>\n  <p>You can create custom route constraints by implementing the IHttpRouteConstraint interface. For example, the following constraint restricts a parameter to a non-zero integer value.</p>\n</blockquote>\n\n<pre><code>public class NonZeroConstraint : IHttpRouteConstraint\n{\n    public bool Match(HttpRequestMessage request, IHttpRoute route, string parameterName, \n        IDictionary&lt;string, object&gt; values, HttpRouteDirection routeDirection)\n    {\n        object value;\n        if (values.TryGetValue(parameterName, out value) &amp;&amp; value != null)\n        {\n            long longValue;\n            if (value is long)\n            {\n                longValue = (long)value;\n                return longValue != 0;\n            }\n\n            string valueString = Convert.ToString(value, CultureInfo.InvariantCulture);\n            if (Int64.TryParse(valueString, NumberStyles.Integer, \n                CultureInfo.InvariantCulture, out longValue))\n            {\n                return longValue != 0;\n            }\n        }\n        return false;\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>The following code shows how to register the constraint:</p>\n</blockquote>\n\n<pre><code>public static class WebApiConfig\n{\n    public static void Register(HttpConfiguration config)\n    {\n        var constraintResolver = new DefaultInlineConstraintResolver();\n        constraintResolver.ConstraintMap.Add(\"nonzero\", typeof(NonZeroConstraint));\n\n        config.MapHttpAttributeRoutes(constraintResolver);\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>Now you can apply the constraint in your routes:</p>\n</blockquote>\n\n<pre><code>[Route(\"{id:nonzero}\")]\npublic HttpResponseMessage GetNonZero(int id) { ... }\n</code></pre>\n\n<p>You can also implement a custom <a href=\"https://docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions-1/controllers-and-routing/understanding-action-filters-cs\" rel=\"nofollow noreferrer\">ActionFilter</a> where you have access to the HttpRequst including the request headers</p>\n\n<pre><code>public class CustomActionFilter: ActionFilterAttribute\n    {\n        public override void OnActionExecuting(HttpActionContext actionContext)\n        {\n            // Before Execution\n\n        }\n\n        public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)\n        {\n            //On Execution\n        }\n    }\n</code></pre>\n\n<p>Then you can apply the CustomActionFilter</p>\n\n<ul>\n<li>Controller Level</li>\n<li>Action Level</li>\n<li>Global Level: By registering it globally in web api config</li>\n</ul>\n"}], "owner": {"reputation": 1237, "user_id": 2498528, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/55d4d094bb5e738bb706d9a4a0dba730?s=128&d=identicon&r=PG", "display_name": "AnKing", "link": "https://stackoverflow.com/users/2498528/anking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534990411, "creation_date": 1534965104, "last_edit_date": 1534990411, "question_id": 51973631, "link": "https://stackoverflow.com/questions/51973631/wildcard-in-route-attribute-for-webapi", "title": "Wildcard in route attribute for webApi", "body": "<p>In my webApi I have all methods located in one controller with routes attached to every method like this:</p>\n\n<pre><code>[HttpPost]\n[Route(\"api/Users/Notary/Seal/Generate\")]\npublic IHttpActionResult GenerateNotarySeal([FromBody]GenerateSealContract SealInfo)\n{\n    return Ok(new RestResponse&lt;byte[]&gt;(buffer));\n}\n</code></pre>\n\n<p>When I test my webApi in swagger it does a preflight OPTIONS request to make sure \"Access-Control-Allow-Headers\" is set right. To send a response to this, I do something like:</p>\n\n<pre><code>[HttpOptions]\n[Route(\"api/Users/Notary/Seal/Generate\")]\npublic IHttpActionResult OptionsHandler([FromBody]GenerateSealContract SealInfo)\n{\n    ///.... I set my custom headers in ActionFilterAttribute           \n    return Ok();\n}\n</code></pre>\n\n<p>But I do not want to duplicate this code for every method. Is there any way to do a wildcard for just the OPTIONS requests? Something like:</p>\n\n<pre><code>[HttpOptions]\n[Route(\"api/*\")]\npublic IHttpActionResult OptionsHandler()\n{\n    ///.... I set my custom headers in ActionFilterAttribute           \n    return Ok();\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "asp.net-mvc", "asp.net-core"], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 3157874, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Yxupq.jpg?s=128&g=1", "display_name": "Rambo3", "link": "https://stackoverflow.com/users/3157874/rambo3"}, "edited": false, "score": 0, "creation_date": 1535033723, "post_id": 51974096, "comment_id": 90925290, "body": "Thank you very much"}], "tags": [], "owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "is_accepted": true, "score": 3, "last_activity_date": 1534967126, "creation_date": 1534967126, "answer_id": 51974096, "question_id": 51973601, "link": "https://stackoverflow.com/questions/51973601/redirect-only-from-certain-website/51974096#51974096", "title": "Redirect only from certain website", "body": "<p>Technically, no. While you can use the <code>Referer</code> (historically mispelled) header, that header is not guaranteed to be present and can also be spoofed. In other words, if the client simply doesn't send the header, there's no way to know whether the user was redirected from your other site or not. Even if it <em>is</em> present, the client could have simply sent the header manually and completely bypassed your other site.</p>\n\n<p>If the two sites are on the same domain or subdomains of the same domain, you can set a cookie at your other site that is then checked on the redirected site. However, the sites need to be able share cookies, which again, means same domain and both have data protections providers configured to utilize the same distributed store.</p>\n\n<p>If you want to limit access the best and most fool-proof way is always going to be auth. Make them login at both points and you can ensure that no one can do anything you don't want them to do.</p>\n"}], "owner": {"reputation": 351, "user_id": 3157874, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Yxupq.jpg?s=128&g=1", "display_name": "Rambo3", "link": "https://stackoverflow.com/users/3157874/rambo3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 51974096, "answer_count": 1, "score": 1, "last_activity_date": 1534967126, "creation_date": 1534964995, "question_id": 51973601, "link": "https://stackoverflow.com/questions/51973601/redirect-only-from-certain-website", "title": "Redirect only from certain website", "body": "<p>I'm working on a .NET Framework website that is only opened from a redirect command. Is it possible to do that only if I redirect from a certain website? </p>\n\n<p>For example, if I have a personal blog and I want to redirect users to a certain site, that site would only open if the previous website is one I can whitelist or something like that. \nIf possible, I'd like to do it server side (the redirecting application is built in .NET Core 2.1)</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["c#", "linux", ".net-core"], "comments": [{"owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "edited": false, "score": 0, "creation_date": 1534965341, "post_id": 51973599, "comment_id": 90897792, "body": "on Linux as well as on Windows, dynamic link libraries are not stand-alone executables. you could possibly only start executables (exe, extensionless in Linux by default) from a command line."}, {"owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "edited": false, "score": 0, "creation_date": 1534965407, "post_id": 51973599, "comment_id": 90897821, "body": "related: <a href=\"https://stackoverflow.com/a/40230574/1132334\">stackoverflow.com/a/40230574/1132334</a>"}, {"owner": {"reputation": 14428, "user_id": 232566, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a027b477262bd8ab1308afe9e8bdb1c5?s=128&d=identicon&r=PG", "display_name": "RQDQ", "link": "https://stackoverflow.com/users/232566/rqdq"}, "edited": false, "score": 0, "creation_date": 1534965475, "post_id": 51973599, "comment_id": 90897852, "body": "Does the Linux machine have the .NET Core runtime or SDK installed?"}, {"owner": {"reputation": 21548, "user_id": 825920, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7a8ad6df2714b0bddeacf7a073a7a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ca9163d9", "link": "https://stackoverflow.com/users/825920/ca9163d9"}, "edited": false, "score": 0, "creation_date": 1534965494, "post_id": 51973599, "comment_id": 90897860, "body": "Yes, I read the SO question too. I thought it would generate an executable file <code>myApp</code> for Linux by Visual Studio but it didn&#39;t."}, {"owner": {"reputation": 21548, "user_id": 825920, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7a8ad6df2714b0bddeacf7a073a7a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ca9163d9", "link": "https://stackoverflow.com/users/825920/ca9163d9"}, "reply_to_user": {"reputation": 14428, "user_id": 232566, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a027b477262bd8ab1308afe9e8bdb1c5?s=128&d=identicon&r=PG", "display_name": "RQDQ", "link": "https://stackoverflow.com/users/232566/rqdq"}, "edited": false, "score": 0, "creation_date": 1534965531, "post_id": 51973599, "comment_id": 90897875, "body": "@RQDQ, no it doesn&#39;t. I want to create a self-contained .Net net core application."}], "answers": [{"comments": [{"owner": {"reputation": 21548, "user_id": 825920, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7a8ad6df2714b0bddeacf7a073a7a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ca9163d9", "link": "https://stackoverflow.com/users/825920/ca9163d9"}, "edited": false, "score": 0, "creation_date": 1534969487, "post_id": 51973736, "comment_id": 90899608, "body": "I tried <code>dotnet publish -r linux-x64 -c Release</code> and it got <code>Error:   An assembly specified in the application dependencies manifest (myApp.deps.json) was not found:     package: &#39;AWSSDK.Core&#39;, version: &#39;3.3.24.8&#39;     path: &#39;lib&#47;netstandard1.3&#47;AWSSDK.Core.dll&#39;</code>"}, {"owner": {"reputation": 9353, "user_id": 3561275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jk8uY.png?s=128&g=1", "display_name": "omajid", "link": "https://stackoverflow.com/users/3561275/omajid"}, "reply_to_user": {"reputation": 21548, "user_id": 825920, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7a8ad6df2714b0bddeacf7a073a7a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ca9163d9", "link": "https://stackoverflow.com/users/825920/ca9163d9"}, "edited": false, "score": 0, "creation_date": 1534972264, "post_id": 51973736, "comment_id": 90900796, "body": "I donwnloaded <code>awssdk.core.3.3.24.8.nupkg</code> and it contains <code>lib&#47;netstandard1.3&#47;AWSSDK.Core.dll</code>. Does the package exist on your disk? Does it contain this file?"}, {"owner": {"reputation": 21548, "user_id": 825920, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7a8ad6df2714b0bddeacf7a073a7a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ca9163d9", "link": "https://stackoverflow.com/users/825920/ca9163d9"}, "edited": false, "score": 0, "creation_date": 1534976311, "post_id": 51973736, "comment_id": 90902236, "body": "I was in the wrong directory. It works when running the same <code>myApp</code> under the directory of <code>Publish</code>. However, I will need to manually copy the file <code>appsettings.json</code> from parent folder. It sounds like a glitch of .Net core publish."}], "tags": [], "owner": {"reputation": 9353, "user_id": 3561275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jk8uY.png?s=128&g=1", "display_name": "omajid", "link": "https://stackoverflow.com/users/3561275/omajid"}, "is_accepted": true, "score": 7, "last_activity_date": 1535033826, "last_edit_date": 1535033826, "creation_date": 1534965544, "answer_id": 51973736, "question_id": 51973599, "link": "https://stackoverflow.com/questions/51973599/net-core-application-cannot-run-on-linux/51973736#51973736", "title": ".Net core application cannot run on Linux?", "body": "<p>It looks like you did a <a href=\"https://docs.microsoft.com/en-us/dotnet/core/deploying/#framework-dependent-deployments-fdd\" rel=\"nofollow noreferrer\">Framework-Dependendent Deployment</a>. Essentially, the publish command was:</p>\n\n<pre><code>dotnet publish -c Release\n</code></pre>\n\n<p>FDD assumes that you are going to have a .NET Core runtime to run your application on the target platform.</p>\n\n<p>Once you copied over the <code>publish</code> directory to another machine (which could be Linux, macOS or Windows), your application still needs a .NET Core runtime to run your application.</p>\n\n<p>Installing the .NET Core runtime depends on the particular Linux distribution that you are using. Once you have it installed, you can run your application by doing:</p>\n\n<pre><code>dotnet /path/to/publish/myApp.dll\n</code></pre>\n\n<p>An alternative to Framework Dependent Deployment is <a href=\"https://docs.microsoft.com/en-us/dotnet/core/deploying/deploy-with-vs#simpleSelf\" rel=\"nofollow noreferrer\">Self-Contained Deployment</a>. In this mode, the published application will contain your application as well as a copy of the .NET Core runtime. On command line, doing a a SCD publish looks like this:</p>\n\n<pre><code>dotnet publish -r linux-x64 -c Release\n</code></pre>\n\n<p>For doing this in Visual Studio, see the link above. Then, you should see a <code>bin\\Release\\netcoreapp2.1\\linux-x64\\publish\\</code> directory that contains a <code>myApp</code> file. You can copy over this publish dir over to a Linux distribution and just run:</p>\n\n<pre><code>/path/to/linux-x64/publish/myApp\n</code></pre>\n"}], "owner": {"reputation": 21548, "user_id": 825920, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/7a8ad6df2714b0bddeacf7a073a7a9f8?s=128&d=identicon&r=PG&f=1", "display_name": "ca9163d9", "link": "https://stackoverflow.com/users/825920/ca9163d9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3295, "favorite_count": 0, "accepted_answer_id": 51973736, "answer_count": 1, "score": 1, "last_activity_date": 1535033826, "creation_date": 1534964993, "question_id": 51973599, "link": "https://stackoverflow.com/questions/51973599/net-core-application-cannot-run-on-linux", "title": ".Net core application cannot run on Linux?", "body": "<p>I created a .Net core C# console application in Visual Studio and used the following steps to test it on Linux. </p>\n\n<ol>\n<li>Use Visual Studio \"Build -> Publish\" menu item to create the executable files in <code>....\\bin\\Release\\netcoreapp2.1\\publish</code>.</li>\n<li>Copy the \"publish\" directory to the Linux machine</li>\n<li>On Linux, <code>chmod 777 myApp.dll</code></li>\n<li><code>./myApp.dll</code></li>\n</ol>\n\n<p>However, executing the app shows the error of </p>\n\n<blockquote>\n  <p>-bash: ./myApp.dll: cannot execute binary file</p>\n</blockquote>\n"}, {"tags": ["c#", "uwp", "textbox", "isenabled"], "comments": [{"owner": {"reputation": 141, "user_id": 10226784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/660b95c5a5ece83a056c56bdf18c8eb8?s=128&d=identicon&r=PG&f=1", "display_name": "Wilmilcard", "link": "https://stackoverflow.com/users/10226784/wilmilcard"}, "edited": false, "score": 1, "creation_date": 1534965492, "post_id": 51973585, "comment_id": 90897858, "body": "Okey the property is <code>ReadOnly</code>"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 7733580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa6e6cb3583c30ebe7ed07182c015203?s=128&d=identicon&r=PG&f=1", "display_name": "Ecordero", "link": "https://stackoverflow.com/users/7733580/ecordero"}, "is_accepted": true, "score": 1, "last_activity_date": 1534965400, "creation_date": 1534965400, "answer_id": 51973698, "question_id": 51973585, "link": "https://stackoverflow.com/questions/51973585/different-ways-to-block-a-textbox-uwp/51973698#51973698", "title": "Different ways to block a textbox UWP", "body": "<p>You can leave IsEnabled true but set the IsReadOnly property to true also. That will keep the default style but make it uneditable.</p>\n"}], "owner": {"reputation": 141, "user_id": 10226784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/660b95c5a5ece83a056c56bdf18c8eb8?s=128&d=identicon&r=PG&f=1", "display_name": "Wilmilcard", "link": "https://stackoverflow.com/users/10226784/wilmilcard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 51973698, "answer_count": 1, "score": 1, "last_activity_date": 1534965400, "creation_date": 1534964890, "question_id": 51973585, "link": "https://stackoverflow.com/questions/51973585/different-ways-to-block-a-textbox-uwp", "title": "Different ways to block a textbox UWP", "body": "<p>I have two textBox and I need to leave them disabled to show a loaded information</p>\n\n<pre><code>&lt;TextBox x: Name = \"txt_Name\" Header = \"Name:\" Margin = \"5\" Text = \"{Binding NamePlacta, Mode = TwoWay}\" IsEnabled = \"True\" /&gt;\n</code></pre>\n\n<p>The \"IsEnable\" property works, but visually I do not like it, I would like to block the option to edit the text but leaving a better look to the textBox.</p>\n\n<p>I leave an image of how it looks and how I would like it:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2kaTt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2kaTt.png\" alt=\"at the top is a textBox with IsEnable = false\"></a></p>\n"}, {"tags": ["c#", "itext", "itext7"], "comments": [{"owner": {"reputation": 70840, "user_id": 1622493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7S0d.jpg?s=128&g=1", "display_name": "Bruno Lowagie", "link": "https://stackoverflow.com/users/1622493/bruno-lowagie"}, "edited": false, "score": 1, "creation_date": 1535008281, "post_id": 51973578, "comment_id": 90909965, "body": "My mother once made carrot soup. She cut the carrots in pieces and mixed them. However, my father had promised his neighbor those carrots. How can my father extract the original carrots from the carrot soup my mother made? The answer is: he can&#39;t. That is also the answer to your question, because you&#39;re trying to do something similar. Someone created a PDF from content that was structured. However, all structure went lost in the process. Now you want to recreate the lost structure (<code>PDF_A_3A</code>). A human being might be able to do that. A machine can&#39;t until we reach singularity."}, {"owner": {"reputation": 70840, "user_id": 1622493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7S0d.jpg?s=128&g=1", "display_name": "Bruno Lowagie", "link": "https://stackoverflow.com/users/1622493/bruno-lowagie"}, "edited": false, "score": 0, "creation_date": 1535008352, "post_id": 51973578, "comment_id": 90910003, "body": "It&#39;s a different story if you replace the <code>A</code> with a <code>B</code>: <code>PdfAConformanceLevel.PDF_A_3B</code>."}, {"owner": {"reputation": 12354, "user_id": 524861, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9591879c1ef74486cf104a930edaa8d3?s=128&d=identicon&r=PG", "display_name": "Ivan-Mark Debono", "link": "https://stackoverflow.com/users/524861/ivan-mark-debono"}, "reply_to_user": {"reputation": 70840, "user_id": 1622493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7S0d.jpg?s=128&g=1", "display_name": "Bruno Lowagie", "link": "https://stackoverflow.com/users/1622493/bruno-lowagie"}, "edited": false, "score": 0, "creation_date": 1535008568, "post_id": 51973578, "comment_id": 90910098, "body": "@BrunoLowagie I understand. I changed it to B. I also added: <code>source.CopyPagesTo(1, source.GetNumberOfPages(), target);</code> which I assume copies the pages including all their related objects as is. Is this enough?"}], "owner": {"reputation": 12354, "user_id": 524861, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/9591879c1ef74486cf104a930edaa8d3?s=128&d=identicon&r=PG", "display_name": "Ivan-Mark Debono", "link": "https://stackoverflow.com/users/524861/ivan-mark-debono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1300, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534964866, "creation_date": 1534964866, "question_id": 51973578, "link": "https://stackoverflow.com/questions/51973578/convert-a-pdf-to-pdf-a-using-itext-7", "title": "Convert a PDF to PDF/A using IText 7?", "body": "<p>I need to convert a PDF file as a stream (1.7) to PDFA/3. The original file has the fonts and images already embedded.</p>\n\n<p>So far I did:</p>\n\n<pre><code>var output = new MemoryStream();\nvar reader = new PdfReader(stream);\nvar writer = new PdfWriter(output);\n\nStream s = new FileStream(\"sRGB Color Space Profile.icm\", FileMode.Open, FileAccess.Read);\nvar intent = new PdfOutputIntent(\"Custom\", \"\", \"http://www.color.org\", \"sRGB IEC61966-2.1\", s);\n\nvar pdfA = new PdfADocument(writer, PdfAConformanceLevel.PDF_A_3A, intent);\n\n//Setting some required parameters\npdfA.SetTagged();\npdfA.GetCatalog().SetLang(new PdfString(\"en-US\"));\npdfA.GetCatalog().SetViewerPreferences(new PdfViewerPreferences().SetDisplayDocTitle(true));\n\nPdfDocumentInfo info = pdfA.GetDocumentInfo();\ninfo.SetTitle(\"test pdf/a\");\n</code></pre>\n\n<p>However I got stuck on how to copy from the input stream to the writer and return the pdf/a as a stream.</p>\n\n<p>Furthermore, can I use iText to perform a conformance text on the output?</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c#", "excel"], "comments": [{"owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "edited": false, "score": 2, "creation_date": 1534964660, "post_id": 51973476, "comment_id": 90897477, "body": "Look into ExcelDataReader, or another 3rd party managed Excel library.  Interop can fail spectacularly in many ways."}, {"owner": {"reputation": 942, "user_id": 10247440, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0kwxp.jpg?s=128&g=1", "display_name": "Selmir", "link": "https://stackoverflow.com/users/10247440/selmir"}, "edited": false, "score": 1, "creation_date": 1534965068, "post_id": 51973476, "comment_id": 90897664, "body": "Try with <a href=\"https://www.nuget.org/packages/EPPlus/\" rel=\"nofollow noreferrer\">nuget.org/packages/EPPlus</a> it will be much easier."}, {"owner": {"reputation": 678, "user_id": 9453080, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422327507876526/picture?type=large", "display_name": "Ivan Garc&#237;a Topete", "link": "https://stackoverflow.com/users/9453080/ivan-garc%c3%ada-topete"}, "reply_to_user": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "edited": false, "score": 1, "creation_date": 1534965758, "post_id": 51973476, "comment_id": 90897970, "body": "As @ParrishHusband said, you can use <a href=\"https://www.nuget.org/packages/ExcelDataReader/\" rel=\"nofollow noreferrer\">ExcelDataReader</a> &amp; <a href=\"https://www.nuget.org/packages/ExcelDataReader.DataSet/\" rel=\"nofollow noreferrer\">ExcelDataReader.DataSet</a> to read an Excel file into a <code>DataSet</code>, then you can work your logic with <code>DataColumns</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10261333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28541189187bc866bae352dfa3b3ae11?s=128&d=identicon&r=PG&f=1", "display_name": "FotY", "link": "https://stackoverflow.com/users/10261333/foty"}, "edited": false, "score": 0, "creation_date": 1534973289, "post_id": 51974535, "comment_id": 90901199, "body": "How do i need to modify the code if the position from the quantity changes someday? Its to late i cant think anymore.."}, {"owner": {"reputation": 678, "user_id": 9453080, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422327507876526/picture?type=large", "display_name": "Ivan Garc&#237;a Topete", "link": "https://stackoverflow.com/users/9453080/ivan-garc%c3%ada-topete"}, "reply_to_user": {"reputation": 1, "user_id": 10261333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28541189187bc866bae352dfa3b3ae11?s=128&d=identicon&r=PG&f=1", "display_name": "FotY", "link": "https://stackoverflow.com/users/10261333/foty"}, "edited": false, "score": 0, "creation_date": 1534973606, "post_id": 51974535, "comment_id": 90901318, "body": "Changed <code>record[i] = product?[3] ?? 0;</code> to <code>record[i] = product?[&quot;Quantity&quot;] ?? 0;</code>"}, {"owner": {"reputation": 1, "user_id": 10261333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28541189187bc866bae352dfa3b3ae11?s=128&d=identicon&r=PG&f=1", "display_name": "FotY", "link": "https://stackoverflow.com/users/10261333/foty"}, "edited": false, "score": 0, "creation_date": 1534974230, "post_id": 51974535, "comment_id": 90901546, "body": "I get a System.ArgumentException at ds.Tables[0].Columns[i].ColumnName = ds.Tables[0].Rows[0][i].ToString(); If i make a column between products &amp; quantity"}, {"owner": {"reputation": 678, "user_id": 9453080, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422327507876526/picture?type=large", "display_name": "Ivan Garc&#237;a Topete", "link": "https://stackoverflow.com/users/9453080/ivan-garc%c3%ada-topete"}, "reply_to_user": {"reputation": 1, "user_id": 10261333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28541189187bc866bae352dfa3b3ae11?s=128&d=identicon&r=PG&f=1", "display_name": "FotY", "link": "https://stackoverflow.com/users/10261333/foty"}, "edited": false, "score": 0, "creation_date": 1534974701, "post_id": 51974535, "comment_id": 90901726, "body": "Edited to remove the <code>ArgumentException</code>!"}], "tags": [], "owner": {"reputation": 678, "user_id": 9453080, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422327507876526/picture?type=large", "display_name": "Ivan Garc&#237;a Topete", "link": "https://stackoverflow.com/users/9453080/ivan-garc%c3%ada-topete"}, "is_accepted": false, "score": 0, "last_activity_date": 1534974670, "last_edit_date": 1534974670, "creation_date": 1534969265, "answer_id": 51974535, "question_id": 51973476, "link": "https://stackoverflow.com/questions/51973476/difficulties-with-c-excel/51974535#51974535", "title": "Difficulties with C# + Excel", "body": "<p>With a reference to <a href=\"https://www.nuget.org/packages/ExcelDataReader/\" rel=\"nofollow noreferrer\">ExcelDataReader</a>, <a href=\"https://www.nuget.org/packages/ExcelDataReader.DataSet/\" rel=\"nofollow noreferrer\">ExcelDataReader.DataSet</a> and <a href=\"https://www.nuget.org/packages/System.Data.DataSetExtensions/\" rel=\"nofollow noreferrer\">DataSetExtensions (.Net)</a> you can read the Excel file pretty easy into a <code>DataSet</code>, then you just have to work with the logic:</p>\n\n<p>Input file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TDHlT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TDHlT.png\" alt=\"Input File\"></a></p>\n\n<pre><code>using System;\nusing System.Data;\nusing System.IO;\nusing System.Linq;\nusing ExcelDataReader;\n\npublic DataTable GetTableFromExcel(string filePath)\n{\n    DataSet ds = new DataSet();\n    using (var stream = System.IO.File.Open(filePath, System.IO.FileMode.Open, System.IO.FileAccess.Read))\n    {\n        using (var reader = ExcelReaderFactory.CreateReader(stream))\n        {\n            ds = reader.AsDataSet();\n        }\n    }\n\n    DataTable table = new DataTable();\n    table.Columns.Add(new DataColumn(\"CustomerNr\"));\n    table.Columns.Add(new DataColumn(\"Address\"));\n\n    // Set column names\n    for (int i = 0; i &lt; ds.Tables[0].Columns.Count; i++)\n    {\n        // DataColumn.ColumnName can't be empty when DataColumn is part\n        // of a DataTable (throws ArgumentException)\n        string columnName = ds.Tables[0].Rows[0][i].ToString();\n        if (string.IsNullOrWhiteSpace(columnName))\n        {\n            columnName = $\"Column{i}\";\n        }\n        ds.Tables[0].Columns[i].ColumnName = columnName;\n    }\n\n    // Remove the first row containing the headers\n    ds.Tables[0].Rows.Remove(ds.Tables[0].Rows[0]);\n\n    // I don't have the benchmarks with me right now, but I've tested\n    // DataTable.Select vs DataTable.AsEnumerable.Select many times\n    // and the AsEnumerable method its faster, that's why you need the\n    // reference to System.Data.DataSetExtensions\n    var enumerableTable = ds.Tables[0].AsEnumerable();\n\n    // list of unique products\n    var products = enumerableTable.Select(row =&gt; row.Field&lt;string&gt;(\"Product\")).Distinct();\n\n    // Add a column for each product\n    foreach (string product in products)\n    {\n        table.Columns.Add(new DataColumn(product));\n    }\n\n    // list of unique customers\n    var customerNumbers = enumerableTable.Select(row =&gt; row.Field&lt;double&gt;(\"CustomerNr\")).Distinct();\n    foreach (var customerNumber in customerNumbers)\n    {\n        DataRow record = table.NewRow();\n        record[\"CustomerNr\"] = customerNumber;\n        record[\"Address\"] = enumerableTable.First(row =&gt; row.Field&lt;double&gt;(\"CustomerNr\").Equals(customerNumber))[1];\n\n        for (int i = 2; i &lt; table.Columns.Count; i++)\n        {\n            DataRow product = enumerableTable.FirstOrDefault(row =&gt; row.Field&lt;double&gt;(\"CustomerNr\").Equals(customerNumber) \n                &amp;&amp; row.Field&lt;string&gt;(\"Product\").Equals(table.Columns[i].ColumnName));\n            // Quantity = 0 if product is null\n            record[i] = product?[\"Quantity\"] ?? 0;\n        }\n\n        table.Rows.Add(record);\n    }\n    return table;\n}\n</code></pre>\n\n<p>Result <code>DataTable</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0VHJ1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0VHJ1.png\" alt=\"Result DataTable\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 678, "user_id": 9453080, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422327507876526/picture?type=large", "display_name": "Ivan Garc&#237;a Topete", "link": "https://stackoverflow.com/users/9453080/ivan-garc%c3%ada-topete"}, "edited": false, "score": 0, "creation_date": 1534974905, "post_id": 51975611, "comment_id": 90901804, "body": "<a href=\"https://stackoverflow.com/a/158752/9453080\">Never use two dots with COM objects and ALWAYS dispose (release) them</a>"}, {"owner": {"reputation": 29, "user_id": 9708624, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "lokij", "link": "https://stackoverflow.com/users/9708624/lokij"}, "reply_to_user": {"reputation": 678, "user_id": 9453080, "user_type": "registered", "profile_image": "https://graph.facebook.com/1422327507876526/picture?type=large", "display_name": "Ivan Garc&#237;a Topete", "link": "https://stackoverflow.com/users/9453080/ivan-garc%c3%ada-topete"}, "edited": false, "score": 0, "creation_date": 1535004106, "post_id": 51975611, "comment_id": 90908080, "body": "another opinion to use two dots <a href=\"https://stackoverflow.com/a/25135685/3852958\">link</a>"}], "tags": [], "owner": {"reputation": 29, "user_id": 9708624, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "lokij", "link": "https://stackoverflow.com/users/9708624/lokij"}, "is_accepted": true, "score": -1, "last_activity_date": 1534974390, "creation_date": 1534974390, "answer_id": 51975611, "question_id": 51973476, "link": "https://stackoverflow.com/questions/51973476/difficulties-with-c-excel/51975611#51975611", "title": "Difficulties with C# + Excel", "body": "<p>The same result as @IvanGarc\u00edaTopete via Microsoft.Office.Interop.Excel.</p>\n\n<p>Class <em>ExcelModel</em> for Excel data:</p>\n\n<pre><code>public class ExcelModel\n{\n    public string CustomerNr { get; set; }\n    public string Address { get; set; }\n    public string Product { get; set; }\n    public string Quantity { get; set; }\n}\n</code></pre>\n\n<p>Read Excel and fill out model:</p>\n\n<pre><code>private void OpenReadExcel()\n{\n    var dlg = new OpenFileDialog();\n    if (dlg.ShowDialog() != DialogResult.OK) return;\n\n    var exApp = new Microsoft.Office.Interop.Excel.Application();\n\n    Workbook exWbk = exApp.Workbooks.Open(dlg.FileName);\n    Worksheet wSh = exWbk.Sheets[1];\n    int k = 2;\n    Customers.Clear();\n    while (wSh.Cells[k, 1].Text != \"\" &amp;&amp; wSh.Cells[k, 1].Value != null)\n    {\n        var rowExcelModel = new ExcelModel()\n        {\n            CustomerNr = wSh.Cells[k, 1].Text,\n            Address = wSh.Cells[k, 2].Text,\n            Product = wSh.Cells[k, 3].Text,\n            Quantity = wSh.Cells[k, 4].Text\n        };\n\n        Customers.Add(rowExcelModel);\n        k++;\n    }\n    exApp.Quit();        \n}\n</code></pre>\n\n<p>Generate Data table:</p>\n\n<pre><code>private void GenerateDataTable()\n{\n    // unique products and customers\n    var products = Customers.Select(x =&gt; x.Product).Distinct().ToList();\n    var customers = Customers.Select(x =&gt; x.CustomerNr).Distinct().ToList();\n\n    // columns CustomerNr and Address\n    var dataTable = new System.Data.DataTable();\n    dataTable.Columns.Add(new DataColumn(\"CustomerNr\"));\n    dataTable.Columns.Add(new DataColumn(\"Address\"));\n    // columns for each product\n    foreach (var product in products)\n    {\n        dataTable.Columns.Add(new DataColumn(product));\n    }\n\n    //fill rows for each customers\n    foreach (var customer in customers)\n    {\n        var row = dataTable.NewRow();\n        row[\"CustomerNr\"] = customer;\n        row[\"Address\"] = Customers.Where(x =&gt; x.CustomerNr == customer).Select(x =&gt; x.Address).FirstOrDefault();\n        foreach (var product in products)\n        {\n            var quantity = Customers.Where(x =&gt; x.CustomerNr == customer &amp;&amp; x.Product == product)\n                .Select(x =&gt; x.Quantity).FirstOrDefault();\n\n            row[product] = quantity ?? \"0\";\n        }\n        dataTable.Rows.Add(row);\n    }\n\n    dataGridView1.DataSource = dataTable;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10261333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28541189187bc866bae352dfa3b3ae11?s=128&d=identicon&r=PG&f=1", "display_name": "FotY", "link": "https://stackoverflow.com/users/10261333/foty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 51975611, "answer_count": 2, "score": 0, "last_activity_date": 1537802189, "creation_date": 1534964355, "question_id": 51973476, "link": "https://stackoverflow.com/questions/51973476/difficulties-with-c-excel", "title": "Difficulties with C# + Excel", "body": "<p>I have a problem.</p>\n\n<p>I have an Excel File where sometimes the same customer is in 2 rows.\nBut not always.</p>\n\n<p>Its like:\n<a href=\"https://i.stack.imgur.com/RJMLW.png\" rel=\"nofollow noreferrer\">Click</a></p>\n\n<p>Now, i want to create a DataGrid in C# which can list this in one row like:\n<a href=\"https://i.stack.imgur.com/5Dhta.png\" rel=\"nofollow noreferrer\">Click</a></p>\n\n<p>I know it would be easier to change the Excel file, but assume it wouldnt work that way(we get the file like this and we cant change it)</p>\n\n<p>I know i could too just make another Excel File and make it with Excel(already did it this way, but we would need it more as C#)</p>\n\n<p>Now i am at this point:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>private void button2_Click(object sender, EventArgs e)\r\n        {\r\n\r\n            OpenFileDialog ofd = new OpenFileDialog() { Filter = \"Excel Arbeitsmappe |*.xlsx\", ValidateNames = true };\r\n\r\n            if (ofd.ShowDialog() == DialogResult.OK)\r\n                textBox1.Text = ofd.SafeFileName;\r\n\r\n            Excel.Application excelApp = new Excel.Application();\r\n            excelApp.Visible = false;\r\n\r\n            string filename = ofd.FileName;\r\n\r\n            Excel.Workbook workbook = excelApp.Workbooks.Open(filename);\r\n            Excel.Worksheet worksheet = workbook.Worksheets[1];     \r\n            dataGridView1.ColumnCount = 2;\r\n            dataGridView1.Columns[0].Name = \"Number\";\r\n            dataGridView1.Columns[1].Name = \"Street\";\r\n            int rows = worksheet.UsedRange.Rows.Count;\r\n\r\n            for (int i = 2; i &lt;= rows; i++)\r\n            {\r\n                string combinehr = worksheet.Cells[i, 150].Text + worksheet.Cells[i, 151].Text;\r\n                dataGridView1.Rows.Add(worksheet.Cells[i,29].Text, combinehr);\r\n            }\r\n        }</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>How do i expand it that it works like i want?</p>\n\n<p>I would be so grateful</p>\n\n<p>(sorry for the english)</p>\n"}, {"tags": ["c#", "unity3d", "accelerometer", "gyroscope"], "comments": [{"owner": {"reputation": 271, "user_id": 3357315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4gfzx.jpg?s=128&g=1", "display_name": "Glurth", "link": "https://stackoverflow.com/users/3357315/glurth"}, "edited": false, "score": 1, "creation_date": 1535128913, "post_id": 51973452, "comment_id": 90967734, "body": "I notice that each cycle you LERP towards your Input.acceleration value, rather than setting it directly.  THEN, you also slerp the quaternion toward the final direction, rather than setting (or offseting) it directly.  Could these be the cause of your lag?"}, {"owner": {"reputation": 1859, "user_id": 5260872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08272816864f87e6b904fb63758f5bf?s=128&d=identicon&r=PG", "display_name": "Nish\u0101n Wickramarathna", "link": "https://stackoverflow.com/users/5260872/nish%c4%81n-wickramarathna"}, "reply_to_user": {"reputation": 271, "user_id": 3357315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4gfzx.jpg?s=128&g=1", "display_name": "Glurth", "link": "https://stackoverflow.com/users/3357315/glurth"}, "edited": false, "score": 0, "creation_date": 1535254407, "post_id": 51973452, "comment_id": 90996217, "body": "Thank you, So can you please explain how should I set it directly without LERP and SLERP. This was the only way that I can think of to achieve this."}, {"owner": {"reputation": 271, "user_id": 3357315, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4gfzx.jpg?s=128&g=1", "display_name": "Glurth", "link": "https://stackoverflow.com/users/3357315/glurth"}, "edited": false, "score": 1, "creation_date": 1535254575, "post_id": 51973452, "comment_id": 90996239, "body": "transform.rotation =  Quaternion.Euler( -zValue *5.0f,Input.compass.magneticHeading,0);"}], "owner": {"reputation": 1859, "user_id": 5260872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08272816864f87e6b904fb63758f5bf?s=128&d=identicon&r=PG", "display_name": "Nish\u0101n Wickramarathna", "link": "https://stackoverflow.com/users/5260872/nish%c4%81n-wickramarathna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 801, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534964234, "creation_date": 1534964234, "question_id": 51973452, "link": "https://stackoverflow.com/questions/51973452/simulate-gyroscope-in-unity-using-compass-and-accelerometer", "title": "Simulate gyroscope in Unity using compass and accelerometer", "body": "<p>I have been trying to simulate the gyroscope behavior in unity by using accelerometer and compass. So far I have achieved some functionality but it still has a lag; a delay of response. It does not change the view as fast as the tilt of the mobile phone. Any help is appreciated and thank you in advance.</p>\n\n<p>Note: Z axis rotation is still not added.</p>\n\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class GyroSimulator : MonoBehaviour {\n\nfloat zValue;\nfloat zValueMinMax = 5.0f;\nVector3 accelometerSmoothValue;\n//Smooth Accelerometer\npublic float AccelerometerUpdateInterval = 1.0f / 100.0f;\npublic float LowPassKernelWidthInSeconds = 0.001f;\npublic Vector3 lowPassValue = Vector3.zero;\nvoid Start () {\n    Screen.orientation = ScreenOrientation.LandscapeLeft;\n    Input.compass.enabled = true;\n}\n//Update is called once per frame\nvoid Update () {\n    //Set Z Min Max\n    if (zValue &lt; -zValueMinMax)\n        zValue = -zValueMinMax;\n\n    if (zValue &gt; zValueMinMax)\n        zValue = zValueMinMax;\n\n    accelometerSmoothValue = LowPass();\n    zValue += accelometerSmoothValue.z;\n\n    transform.rotation = Quaternion.Slerp(\n        transform.rotation,\n        Quaternion.Euler(\n            -zValue*5.0f,\n            Input.compass.magneticHeading, \n            0\n            ),\n        Time.deltaTime*5.0f\n        );\n}\n\nVector3 LowPass()\n{\n    Vector3 tilt = Input.acceleration;\n    float LowPassFilterFactor = AccelerometerUpdateInterval / LowPassKernelWidthInSeconds;\n    lowPassValue = Vector3.Lerp(lowPassValue, tilt, LowPassFilterFactor);\n    return lowPassValue;\n}\n}\n</code></pre>\n"}, {"tags": ["c#", "xaml", "mvvm"], "comments": [{"owner": {"reputation": 221, "user_id": 3583535, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/9724642ad03cce8963b092fbf284cda4?s=128&d=identicon&r=PG&f=1", "display_name": "user3583535", "link": "https://stackoverflow.com/users/3583535/user3583535"}, "edited": false, "score": 0, "creation_date": 1534965708, "post_id": 51973363, "comment_id": 90897954, "body": "Without understanding the context of your issue I&#39;m not sure why you need the KeyUp event?  Can you not run the keyUpCommand from the bound field&#39;s (Fouls in your case) set method?"}], "answers": [{"comments": [{"owner": {"reputation": 807, "user_id": 6158463, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/de265c4e1414331e01ab28eefdc9ed87?s=128&d=identicon&r=PG&f=1", "display_name": "nikotromus", "link": "https://stackoverflow.com/users/6158463/nikotromus"}, "edited": false, "score": 0, "creation_date": 1535048475, "post_id": 51973746, "comment_id": 90933658, "body": "I tried it.  Did not work.  It would have been cleaner than how I got it to work.  I added a keyup event to update the value."}, {"owner": {"reputation": 598, "user_id": 1353069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0pnLx.jpg?s=128&g=1", "display_name": "Ali Doustkani", "link": "https://stackoverflow.com/users/1353069/ali-doustkani"}, "reply_to_user": {"reputation": 807, "user_id": 6158463, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/de265c4e1414331e01ab28eefdc9ed87?s=128&d=identicon&r=PG&f=1", "display_name": "nikotromus", "link": "https://stackoverflow.com/users/6158463/nikotromus"}, "edited": false, "score": 0, "creation_date": 1535059119, "post_id": 51973746, "comment_id": 90938526, "body": "it worked on my computer. maybe I could help if I can see more of your code."}, {"owner": {"reputation": 807, "user_id": 6158463, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/de265c4e1414331e01ab28eefdc9ed87?s=128&d=identicon&r=PG&f=1", "display_name": "nikotromus", "link": "https://stackoverflow.com/users/6158463/nikotromus"}, "edited": false, "score": 0, "creation_date": 1535124635, "post_id": 51973746, "comment_id": 90965437, "body": "It worked.  I went to update my question and realized this does work.  I didn&#39;t see the property change the first time I tried it.  Thanks a bunch!!!"}], "tags": [], "owner": {"reputation": 598, "user_id": 1353069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0pnLx.jpg?s=128&g=1", "display_name": "Ali Doustkani", "link": "https://stackoverflow.com/users/1353069/ali-doustkani"}, "is_accepted": true, "score": 1, "last_activity_date": 1534965581, "creation_date": 1534965581, "answer_id": 51973746, "question_id": 51973363, "link": "https://stackoverflow.com/questions/51973363/keyup-fires-before-bound-textbox-value-updates/51973746#51973746", "title": "keyup fires before bound textbox value updates", "body": "<p>I think your problem is the triggering of update. Try this code and see what happens:</p>\n\n<pre><code> &lt;TextBox Text=\"{Binding VisitorTeamStats.Fouls, UpdateSourceTrigger=PropertyChanged}\"&gt;\n   &lt;i:Interaction.Triggers&gt;\n     &lt;i:EventTrigger EventName=\"KeyUp\"&gt;\n       &lt;i:InvokeCommandAction Command=\"{Binding VisitorFoulsKeyUpCmd}\"/&gt;\n     &lt;/i:EventTrigger&gt;\n   &lt;/i:Interaction.Triggers&gt;\n &lt;/TextBox&gt;\n</code></pre>\n"}], "owner": {"reputation": 807, "user_id": 6158463, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/de265c4e1414331e01ab28eefdc9ed87?s=128&d=identicon&r=PG&f=1", "display_name": "nikotromus", "link": "https://stackoverflow.com/users/6158463/nikotromus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 51973746, "answer_count": 1, "score": 0, "last_activity_date": 1534965581, "creation_date": 1534963788, "question_id": 51973363, "link": "https://stackoverflow.com/questions/51973363/keyup-fires-before-bound-textbox-value-updates", "title": "keyup fires before bound textbox value updates", "body": "<p>I have a textbox with the text value bound to a model.  The textbox has a KeyUp event.  Here is the xaml</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding VisitorTeamStats.Fouls}\"&gt;\n      &lt;i:Interaction.Triggers&gt;\n           &lt;i:EventTrigger EventName=\"KeyUp\"&gt;\n               &lt;i:InvokeCommandAction Command=\"{Binding VisitorFoulsKeyUpCmd}\"/&gt;\n            &lt;/i:EventTrigger&gt;\n      &lt;/i:Interaction.Triggers&gt;\n&lt;/TextBox&gt;\n</code></pre>\n\n<p>Everything is wired correctly.  Here is what happens.  The initial value of the textbox when you start the application is 0.  When I enter new number, say 8, the OnCommand method registers 0 for the bond value of the textbox in my model.  When I enter another number in the textbox, say a 9, the keyup even fires and the boud value of the textbox in my model is now 8. </p>\n\n<p>So, the keyup event fires BEFORE the bound value of VisitorTeamStats.Fouls updates.  How do I key the bound value to update first, or otherwise pass in the value from the textbox into the keyup event.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "entity-framework-core", "automapper"], "comments": [{"owner": {"reputation": 624, "user_id": 8207463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pJhJL.jpg?s=128&g=1", "display_name": "Just Fair", "link": "https://stackoverflow.com/users/8207463/just-fair"}, "edited": false, "score": 1, "creation_date": 1534964251, "post_id": 51973352, "comment_id": 90897295, "body": "Maybe you should use AsNoTracking()."}], "answers": [{"tags": [], "owner": {"reputation": 12422, "user_id": 6527049, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/smnwW.jpg?s=128&g=1", "display_name": "vivek nuna", "link": "https://stackoverflow.com/users/6527049/vivek-nuna"}, "is_accepted": true, "score": 1, "last_activity_date": 1535139741, "creation_date": 1535139741, "answer_id": 52010798, "question_id": 51973352, "link": "https://stackoverflow.com/questions/51973352/exception-when-i-try-to-update-graph-using-entity-framework-core-with-automapper/52010798#52010798", "title": "Exception when I try to update graph using Entity Framework Core with AutoMapper", "body": "<p>When you query the database for some record without using <code>AsNoTracking</code> EF Core will start tracking it in current context. So when you update Entity in your code, EF Core finds multiple entities with same id hence the error. <code>AsNoTracking</code> is one solution as you don't want EF Core to track any modifications to that. In many cases not having <code>AsNoTracking</code> is fine as long as you don't add/attach/update entity with same id in the context. But it is good to have it explicitly when tracking is not required.</p>\n"}, {"tags": [], "owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "is_accepted": false, "score": 0, "last_activity_date": 1535142818, "creation_date": 1535142818, "answer_id": 52011349, "question_id": 51973352, "link": "https://stackoverflow.com/questions/51973352/exception-when-i-try-to-update-graph-using-entity-framework-core-with-automapper/52011349#52011349", "title": "Exception when I try to update graph using Entity Framework Core with AutoMapper", "body": "<p>Your code has few issues. First of all, you cannot new up OrdersDbContext whenever you need it. If you do so, the instance of the entity cannot be tracked as exception message stated. </p>\n\n<p>For Unit Tests, you need to use either In-Memory Database or mock OrdersDbContext with Mocking Library such as Moq.</p>\n\n<p>If you call async extension methods, then you need to implement <a href=\"https://docs.microsoft.com/en-us/ef/ef6/fundamentals/testing/mocking#testing-with-async-queries\" rel=\"nofollow noreferrer\">async query provider</a>. </p>\n"}], "owner": {"reputation": 909, "user_id": 2117114, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/12cc69ff25c673e3d552e2758ad0bdb4?s=128&d=identicon&r=PG", "display_name": "yo2011", "link": "https://stackoverflow.com/users/2117114/yo2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "accepted_answer_id": 52010798, "answer_count": 2, "score": 0, "last_activity_date": 1535142818, "creation_date": 1534963713, "last_edit_date": 1534965518, "question_id": 51973352, "link": "https://stackoverflow.com/questions/51973352/exception-when-i-try-to-update-graph-using-entity-framework-core-with-automapper", "title": "Exception when I try to update graph using Entity Framework Core with AutoMapper", "body": "<p>I get an exception when I try to update graph. I use Automapper to map DTOs to my entities, then I check if my object already exists in the database before I do the update operation. </p>\n\n<p>When I call <code>dbContext.Update</code>, I get this exception </p>\n\n<blockquote>\n  <p>The instance of entity type 'Order' cannot be tracked because another instance with the same key value for {'OrderId'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.'</p>\n</blockquote>\n\n<p>My code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing AutoMapper;\nusing EFCoreIssue;\nusing EFCoreIssue.Dtos;\nusing EFCoreIssue.Models;\nusing Microsoft.EntityFrameworkCore;\nusing Xunit;\n\nnamespace EFCoreIssue_Tests\n{\n  public class OrdersTests\n  {\n    private readonly OrderRepository _orderRepository;\n\n    public OrdersTests()\n    {\n        _orderRepository = new OrderRepository(new OrdersDbContext());\n        Mapper.Initialize(cfg =&gt; cfg.CreateMap&lt;OrderDto, Order&gt;());\n    }\n\n    [Fact]\n    public async void Should_Update_Customer_Successfully()\n    {\n        //Arrange\n        var order = new Order\n        {\n            Description = \"Test Order\",\n            OrderLines = new List&lt;OrderLine&gt;\n            {\n                new OrderLine {ProductId = 1, Quantity = 1}\n            }\n        };\n        using (var dbContext = new OrdersDbContext())\n        {\n            dbContext.Orders.Add(order);\n            await dbContext.SaveChangesAsync();\n        }\n\n        //Act\n        var orderDto = new OrderDto\n        {\n            Description = \"Test Order 2\",\n            OrderLines = new List&lt;OrderLineDto&gt;\n            {\n                new OrderLineDto {OrderLineId = order.OrderLines[0].OrderLineId, ProductId = 2, Quantity = 2}\n            },\n            OrderId = order.OrderId\n        };\n\n        await _orderRepository.UpdateAsync(Mapper.Map&lt;Order&gt;(orderDto));\n\n        //Assert\n        using (var dbContext = new OrdersDbContext())\n        {\n            var updatedOrder = await dbContext.Orders.Include(c =&gt; c.OrderLines)\n                .Where(c =&gt; c.OrderId == order.OrderId).SingleAsync();\n            //updatedOrder.ShouldNotBeNull();\n            //customerFetch.Id.ShouldNotBeNull();\n            //customerFetch.Id.ShouldBe(customerDto.Id);\n        }\n    }\n  }\n}\n</code></pre>\n\n<p>and my order repository update method</p>\n\n<pre><code>    public async Task&lt;Order&gt; UpdateAsync(Order order)\n    {\n        var dbOrder = await GetOrderAsync(order.OrderId);\n        if (dbOrder == null)\n            throw new Exception($\"Invalid Or Missing Order with Id {order.OrderId}\");\n\n        _dbContext.Update(order);\n        await _dbContext.SaveChangesAsync();\n        return order;\n    }\n</code></pre>\n\n<p>Note: you can get the code on this github repository\n<a href=\"https://github.com/ahmedtolba1984/EFCoreIssue\" rel=\"nofollow noreferrer\">code repository</a></p>\n"}, {"tags": ["c#", "asp.net-core-2.0", "model-binding", "multi-select"], "answers": [{"comments": [{"owner": {"reputation": 22421, "user_id": 306478, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f790d6d3f1a75a30f6e525890f1d1964?s=128&d=identicon&r=PG", "display_name": "Bijan", "link": "https://stackoverflow.com/users/306478/bijan"}, "edited": false, "score": 1, "creation_date": 1560768363, "post_id": 51979620, "comment_id": 99831236, "body": "I wouldn&#39;t use viewbag and instead make use of a property."}, {"owner": {"reputation": 539, "user_id": 7087479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M0dCA.jpg?s=128&g=1", "display_name": "Markeli", "link": "https://stackoverflow.com/users/7087479/markeli"}, "edited": false, "score": 0, "creation_date": 1561564460, "post_id": 51979620, "comment_id": 100108927, "body": "Hey! Did you found the solution? Does multi-select work for asp.net core razor pages from the scratch?"}], "tags": [], "owner": {"reputation": 8924, "user_id": 10201850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rz0ZX.jpg?s=128&g=1", "display_name": "Xueli Chen", "link": "https://stackoverflow.com/users/10201850/xueli-chen"}, "is_accepted": false, "score": 6, "last_activity_date": 1605580258, "last_edit_date": 1605580258, "creation_date": 1535006042, "answer_id": 51979620, "question_id": 51973284, "link": "https://stackoverflow.com/questions/51973284/post-multi-select-list-to-list-of-objects-asp-net-core-2/51979620#51979620", "title": "post multi-select list to list of objects asp.net core 2", "body": "<p>The Select Tag Helper asp-for specifies the model property name for the select element, and asp-items specifies the option elements(a collection of SelectListItem ), rather than object collection.</p>\n<p>1.Add a ViewModel with a List as the property for your dropdown items.</p>\n<pre class=\"lang-cs prettyprint-override\"><code>public class UserViewModel\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n\n    public List&lt;int&gt; Roles { get; set; }\n}\n</code></pre>\n<p>2.In.cshtml file select like below</p>\n<pre><code>@model PostMultiSelect.Models.UserViewModel\n &lt;select multiple=&quot;multiple&quot; class=&quot;multi-select&quot; id=&quot;my_multi_select1&quot; asp-for=&quot;@Model.Roles&quot; asp-items=&quot;(List&lt;SelectListItem&gt;)ViewBag.Roles&quot;&gt;&lt;/select&gt;\n</code></pre>\n<p>3.The value of ViewBag.Roles like below, get the Roles with RoleId</p>\n<pre class=\"lang-cs prettyprint-override\"><code>ViewBag.Roles = _context.Roles.Select(r=&gt;new SelectListItem {Value=r.ID.ToString(),Text=r.Name}).ToList();\n</code></pre>\n<p>If you want to get Roles with name, you could change &quot;<em>Value=r.ID.ToString()</em>&quot; to&quot;<em>Value=r.Name</em>&quot;</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 3777978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a649bb9668226c7ac6ffe22c155dbf19?s=128&d=identicon&r=PG&f=1", "display_name": "Voinea Bogdan", "link": "https://stackoverflow.com/users/3777978/voinea-bogdan"}, "is_accepted": false, "score": 0, "last_activity_date": 1596627067, "creation_date": 1596627067, "answer_id": 63264251, "question_id": 51973284, "link": "https://stackoverflow.com/questions/51973284/post-multi-select-list-to-list-of-objects-asp-net-core-2/63264251#63264251", "title": "post multi-select list to list of objects asp.net core 2", "body": "<p>In controller u have a list of roles:</p>\n<pre><code> List&lt;Roles&gt; rolesList = new List&lt;Roles&gt;();\n roleList = _context.Roles.Tolist();\n ViewBag.Roles =rolesList;\n</code></pre>\n<p>In view:</p>\n<pre><code>&lt;select multiple=&quot;multiple&quot; class=&quot;multi-select&quot; id=&quot;my_multi_select1&quot; asp-for=&quot;Roles&quot; asp-items=@(new MultiSelectList(@ViewBag.Roles, &quot;IdRoles&quot;, &quot;Roles&quot;))&gt;&lt;/select&gt; \n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7418026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vyS6k.jpg?s=128&g=1", "display_name": "Alireza Mn", "link": "https://stackoverflow.com/users/7418026/alireza-mn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12229, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1605580258, "creation_date": 1534963464, "last_edit_date": 1605552060, "question_id": 51973284, "link": "https://stackoverflow.com/questions/51973284/post-multi-select-list-to-list-of-objects-asp-net-core-2", "title": "post multi-select list to list of objects asp.net core 2", "body": "<p>I have two classes called <code>User</code> and <code>Role</code>.</p>\n<pre><code>class User\n{\n    ...\n    public List&lt;Role&gt; Roles;\n}\n\nclass Role\n{\n    ...\n    public int ID;\n    public string Name;\n}\n</code></pre>\n<p>I also have an action (Submit)</p>\n<pre><code>public IActionResult Submit(User user)\n{\n    ...\n} \n</code></pre>\n<p>in my Index.cshtml <code>select</code> is</p>\n<pre><code>&lt;select multiple=&quot;multiple&quot; class=&quot;multi-select&quot; id=&quot;my_multi_select1&quot; asp-for=&quot;Roles&quot; asp-items=&quot;ViewBag.Roles&quot;&gt;&lt;/select&gt; \n</code></pre>\n<p>and <code>ViewBag.Roles</code> value is</p>\n<pre><code>ViewBag.Roles= new SelectList(Role.SelectAll(), &quot;Name&quot;, &quot;Name&quot;);\n</code></pre>\n<p>the problem is that when I post my form, data is sent like this\n<code>...&amp;Roles=role1,role2&amp;...</code>\nand so <code>user.Roles</code> becomes null while I want to make two Roles with names <code>role1</code> and <code>role2</code> and assign them to <code>user.Roles</code> (Actually, I want Asp does that)</p>\n"}, {"tags": ["c#", "asp.net", "ssl", "https"], "owner": {"reputation": 841, "user_id": 1441090, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c85a81b706c1c8f51e2ea177531e9107?s=128&d=identicon&r=PG", "display_name": "Jorgel", "link": "https://stackoverflow.com/users/1441090/jorgel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535231489, "creation_date": 1534962842, "last_edit_date": 1535231489, "question_id": 51973136, "link": "https://stackoverflow.com/questions/51973136/null-clientcertificate-when-doing-simultaneous-requests", "title": "Null ClientCertificate when doing simultaneous requests", "body": "<p>I have an application that uses SSL Mutual Authentication and I noticed an issue where parallel REST requests resulted in a null response from Request.GetClientCertificate.</p>\n\n<p>I created an empty ASP.NET Web Application to isolate another factors and got the same result. These are the files involved</p>\n\n<p>Index.html\n</p>\n\n<pre><code>&lt;script src=\"~/Scripts/testing.js\"&gt;&lt;/script&gt;\n&lt;div class=\"row\"&gt;\n    &lt;button onclick=\"x()\"&gt;Test&lt;/button&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><br>\ntesting.js</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>function x() {\n    // Making two simultaneous requests \n    $.ajax({\n        url: \"api/values\"\n    }).then(function (data) {\n        console.log(data);\n    });\n\n    $.ajax({\n        url: \"api/values\"\n    }).then(function (data) {\n        console.log(data);\n    });\n}\n</code></pre>\n\n<p><br>\nValuesController.cs\n</p>\n\n<pre><code>using System.Net.Http;\nusing System.Web.Http;\n\nnamespace WebTemp.Controllers {\n    public class ValuesController : ApiController {\n        // GET api/values\n        public string Get() {\n            var cert = Request.GetClientCertificate(); // Here I get null in one of the requests\n\n            return cert == null ? \"null\" : cert.SubjectName.Name;\n        }\n    }\n}\n</code></pre>\n\n<p>When I click the button on html, calling both ajax at the same time, I get a null from one call and the correct certificate value from the other. \nThe problem does not occur if I call one ajax only after the other has returned.</p>\n\n<p>I also noticed the error happens on Chrome, but the code works correctly on Edge.</p>\n"}, {"tags": ["c#", "asp.net", "treeview"], "comments": [{"owner": {"reputation": 3268, "user_id": 9850970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85lTf.png?s=128&g=1", "display_name": "Aldert", "link": "https://stackoverflow.com/users/9850970/aldert"}, "edited": false, "score": 0, "creation_date": 1534963323, "post_id": 51973022, "comment_id": 90896858, "body": "Isn\u2019t it so the previous node still has the color because you have never reset the color?"}], "answers": [{"tags": [], "owner": {"reputation": 32382, "user_id": 18941, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9a421fb11a71a933455f67131a0fc7ad?s=128&d=identicon&r=PG", "display_name": "TheSoftwareJedi", "link": "https://stackoverflow.com/users/18941/thesoftwarejedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1534963568, "creation_date": 1534963568, "answer_id": 51973310, "question_id": 51973022, "link": "https://stackoverflow.com/questions/51973022/change-node-color-in-treeview/51973310#51973310", "title": "Change node color in treeview", "body": "<p>You are setting the node's text to html with color after it is found.  You never remove the html when it is not found.</p>\n\n<pre><code>   else\n   {\n       currentNode.Text = currentNode.Text; //need to remove the HTML tags (if any) here\n       // currentNode.Collapse();\n     //  currentNode.ShowCheckBox = false;\n   }\n</code></pre>\n\n<p>To accomplish removing the HTML you could: </p>\n\n<ul>\n<li>Use what <a href=\"https://stackoverflow.com/a/18154046/18941\">this answer</a> suggests, or look through the other answers.  </li>\n<li>If you have the original source of the text you could grab it from there.  </li>\n<li>You could store the original text in a dictionary with the node as the key, then look it back up to reset it.</li>\n</ul>\n\n<p>To do the simple regex way, it would look like this:</p>\n\n<pre><code>   else\n   {\n       //remove the HTML tags (if any) here\n       currentNode.Text = Regex.Replace(currentNode.Text, \"&lt;.*?&gt;\", String.Empty);\n       // currentNode.Collapse();\n     //  currentNode.ShowCheckBox = false;\n   }\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 8936439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12fcaa00e1fc420613bd9b60899de38?s=128&d=identicon&r=PG&f=1", "display_name": "Ann Sara", "link": "https://stackoverflow.com/users/8936439/ann-sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534963568, "creation_date": 1534962360, "question_id": 51973022, "link": "https://stackoverflow.com/questions/51973022/change-node-color-in-treeview", "title": "Change node color in treeview", "body": "<p>I have a treeview with nodes.I am implementing searching through treeview nodes .Once matching node is find ,the node color should be changed .it is working fine ,but the problem is while searching for a new node the previously searched node color is also changed . Any help will be really appreciated .Thanks in advance.</p>\n\n<pre><code>protected void btn_search_Click(object sender, EventArgs e)\n   {\n       try\n       {\n           FindNodesByString();\n\n       }\n\n       catch { }\n   }\n\n   private void FindNodesByString()\n   {\n       foreach (TreeNode currentNode in tv_AccountView.Nodes)\n       {\n           FindNodeByString(currentNode);\n       }\n   }\n\n   private void FindNodeByString(TreeNode parentNode)\n   {\n       FindMatch(parentNode);\n       foreach (TreeNode currentNode in parentNode.ChildNodes)\n       {\n           //currentNode.Text = currentNode.Text;\n           FindMatch(currentNode);\n           FindNodeByString(currentNode);\n       }\n   }\n  private void FindMatch(TreeNode currentNode)\n   {\n       if (currentNode.Text.ToUpper().Contains(txt_searchbyname.Text.ToUpper()))\n       {\n           currentNode.Expand();\n           currentNode.Text = \"&lt;div style='background- \n           color:#ffffcc;color:#ff9900;'&gt;\" + currentNode.Text + \" \n          &lt;/div&gt;\";\n\n       }\n       else\n       {\n           currentNode.Text = currentNode.Text;\n           // currentNode.Collapse();\n         //  currentNode.ShowCheckBox = false;\n       }\n   }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", ".net", "visual-studio"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 2064917, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2cba69750c0e71569b6b8dcdde22d0ef?s=128&d=identicon&r=PG", "display_name": "mappingman", "link": "https://stackoverflow.com/users/2064917/mappingman"}, "edited": false, "score": 0, "creation_date": 1535052255, "post_id": 51973493, "comment_id": 90935456, "body": "I&#39;ve already tried the web.config per directory method. The problem with this method that I am having is that the error details are not as informative as that of the site web.config."}], "tags": [], "owner": {"reputation": 28506, "user_id": 86860, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/24414172673338a6bce690a6eeb53f64?s=128&d=identicon&r=PG", "display_name": "Nate", "link": "https://stackoverflow.com/users/86860/nate"}, "is_accepted": false, "score": 0, "last_activity_date": 1534964438, "creation_date": 1534964438, "answer_id": 51973493, "question_id": 51972988, "link": "https://stackoverflow.com/questions/51972988/c-net-force-detailed-errors-per-directory/51973493#51973493", "title": "C# .Net Force Detailed Errors per Directory", "body": "<p>The most straight forward way would be to create the web config for each directory explicitly. They should 'roll up' from <code>MachineConfig</code> all the way to your lowest level directory. </p>\n\n<p>Another post here on SO demonstrates how you might do this programmatically: <a href=\"https://stackoverflow.com/a/2260335/86860\">https://stackoverflow.com/a/2260335/86860</a></p>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 2064917, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2cba69750c0e71569b6b8dcdde22d0ef?s=128&d=identicon&r=PG", "display_name": "mappingman", "link": "https://stackoverflow.com/users/2064917/mappingman"}, "edited": false, "score": 0, "creation_date": 1535052087, "post_id": 51974471, "comment_id": 90935381, "body": "I&#39;ve already tried the web.config per directory method. The problem with this method that I am having is that the error details are not as informative as that of the site web.config."}, {"owner": {"reputation": 1354, "user_id": 10230250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd88700623b97c996d5407464bd9c2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dj079", "link": "https://stackoverflow.com/users/10230250/dj079"}, "reply_to_user": {"reputation": 123, "user_id": 2064917, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2cba69750c0e71569b6b8dcdde22d0ef?s=128&d=identicon&r=PG", "display_name": "mappingman", "link": "https://stackoverflow.com/users/2064917/mappingman"}, "edited": false, "score": 0, "creation_date": 1535074212, "post_id": 51974471, "comment_id": 90942007, "body": "@MarkMiller The error details depends on the custom page you decide. But in any case, there is a <b>second approach</b> which allows you to use single web.config and still target a particular application or directory. Check this out on the same article. <a href=\"https://support.microsoft.com/en-in/help/815174/how-to-make-application-and-directory-specific-configuration-settings#4\" rel=\"nofollow noreferrer\">support.microsoft.com/en-in/help/815174/&hellip;</a>"}, {"owner": {"reputation": 123, "user_id": 2064917, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2cba69750c0e71569b6b8dcdde22d0ef?s=128&d=identicon&r=PG", "display_name": "mappingman", "link": "https://stackoverflow.com/users/2064917/mappingman"}, "edited": false, "score": 0, "creation_date": 1535112961, "post_id": 51974471, "comment_id": 90957811, "body": "Thanks @dj79. I&#39;ll try it out."}], "tags": [], "owner": {"reputation": 1354, "user_id": 10230250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd88700623b97c996d5407464bd9c2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dj079", "link": "https://stackoverflow.com/users/10230250/dj079"}, "is_accepted": false, "score": 0, "last_activity_date": 1534968964, "last_edit_date": 1592644375, "creation_date": 1534968964, "answer_id": 51974471, "question_id": 51972988, "link": "https://stackoverflow.com/questions/51972988/c-net-force-detailed-errors-per-directory/51974471#51974471", "title": "C# .Net Force Detailed Errors per Directory", "body": "<p>There is an out-of-box solution for your query.</p>\n<blockquote>\n<p>This step-by-step article describes how to use ASP.NET to make application-specific and directory-specific configuration settings. The Web.config file resides in the root directory of an ASP.NET application. The Web.config file specifies configuration information that is specific to the application. You can also set configuration settings on a per-directory basis. There are two ways to do so:</p>\n<p>\u2022  Distribute multiple Web.config files to directories in the application. Add a Web.config file in the ASP.NET application directory with settings that override settings in a higher-level Web.config file or in the system machine configuration (Machine.config) file.</p>\n<p>\u2022  Add per-directory or per-file settings directly to the application Web.config file. This method uses a single Web.config file to turn on per-directory configuration settings. You can also use this method in the Machine.config file to force configuration settings on ASP.NET Web applications and then to stop Web.config files from overriding Machine.config settings.</p>\n</blockquote>\n<p><strong>You can get more details from here:</strong> <a href=\"https://support.microsoft.com/en-in/help/815174/how-to-make-application-and-directory-specific-configuration-settings\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-in/help/815174/how-to-make-application-and-directory-specific-configuration-settings</a></p>\n"}], "owner": {"reputation": 123, "user_id": 2064917, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2cba69750c0e71569b6b8dcdde22d0ef?s=128&d=identicon&r=PG", "display_name": "mappingman", "link": "https://stackoverflow.com/users/2064917/mappingman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1535052124, "creation_date": 1534962207, "last_edit_date": 1535052124, "question_id": 51972988, "link": "https://stackoverflow.com/questions/51972988/c-net-force-detailed-errors-per-directory", "title": "C# .Net Force Detailed Errors per Directory", "body": "<p>Wondering if it's possible to override web.config custom errors on a per directory basis. I'm thinking not, but thought I'd ask.</p>\n\n<p>Thanks,</p>\n\n<p>Mark</p>\n"}, {"tags": ["c#", "cakebuild"], "answers": [{"tags": [], "owner": {"reputation": 13665, "user_id": 671491, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e145406f495a61b6b22d0e72fe4dcd01?s=128&d=identicon&r=PG", "display_name": "Gary Ewan Park", "link": "https://stackoverflow.com/users/671491/gary-ewan-park"}, "is_accepted": true, "score": 6, "last_activity_date": 1534962937, "creation_date": 1534962937, "answer_id": 51973156, "question_id": 51972985, "link": "https://stackoverflow.com/questions/51972985/cake-build-how-to-invoke-other-cake-build-scripts-from-another-cake-build-scri/51973156#51973156", "title": "Cake Build - How to Invoke other Cake Build Scripts from another Cake Build Script", "body": "<p>My suggestion would be to keep each projects build.cake file isolated, only working/building that project. Then, I would have another, higher level build script which then used to run:</p>\n\n<p><a href=\"https://cakebuild.net/api/Cake.Common.Tools.Cake/CakeAliases/5FCD85B6\" rel=\"noreferrer\">https://cakebuild.net/api/Cake.Common.Tools.Cake/CakeAliases/5FCD85B6</a></p>\n\n<p>To invoke the project build scripts in the order that they are required.</p>\n\n<p>You could have something like:</p>\n\n<pre><code>CakeExecuteScript(\"./projects/C/build.cake\");\nCakeExecuteScript(\"./projects/B/build.cake\");    \nCakeExecuteScript(\"./projects/A/build.cake\");\n</code></pre>\n\n<p>Obviously, you could wrap each of those in a try/catch to take action to stop the overall build, if one of the project builds fail.</p>\n"}], "owner": {"reputation": 405, "user_id": 2791491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97bf9309d325ecb9c8ba93393efba051?s=128&d=identicon&r=PG", "display_name": "pixelTitan", "link": "https://stackoverflow.com/users/2791491/pixeltitan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1320, "favorite_count": 0, "accepted_answer_id": 51973156, "answer_count": 1, "score": 3, "last_activity_date": 1534962937, "creation_date": 1534962177, "question_id": 51972985, "link": "https://stackoverflow.com/questions/51972985/cake-build-how-to-invoke-other-cake-build-scripts-from-another-cake-build-scri", "title": "Cake Build - How to Invoke other Cake Build Scripts from another Cake Build Script", "body": "<p>If I have a large code-base with many inter-dependent projects, for example, <code>projects/A</code>, <code>projects/B</code>, and <code>projects/C</code>, where <code>A</code> requires <code>B</code>, and <code>B</code> requires <code>C</code>, and each of these projects has a Cake build script, for example, <code>projects/A/build.cake</code>, <code>projects/B/build.cake</code>, and <code>projects/C/build.cake</code>, what is the best way to write the <code>projects/A/build.cake</code> such that it invokes the Cake build <code>projects/B/build.cake</code> as a dependency task.</p>\n"}, {"tags": ["c#", "asp.net-core-2.0", "custom-validators"], "answers": [{"comments": [{"owner": {"reputation": 6125, "user_id": 846281, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01438c3df63caf4c986268852935fcbd?s=128&d=identicon&r=PG", "display_name": "Andrew Simpson", "link": "https://stackoverflow.com/users/846281/andrew-simpson"}, "edited": false, "score": 0, "creation_date": 1534963365, "post_id": 51973187, "comment_id": 90896877, "body": "Thank God!  Thank you very much for all :)"}], "tags": [], "owner": {"reputation": 5421, "user_id": 504757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e3af512b76d08790c8a9c6c9bce18b?s=128&d=identicon&r=PG", "display_name": "Maverik", "link": "https://stackoverflow.com/users/504757/maverik"}, "is_accepted": true, "score": 2, "last_activity_date": 1534963104, "creation_date": 1534963104, "answer_id": 51973187, "question_id": 51972964, "link": "https://stackoverflow.com/questions/51972964/how-to-register-client-validation-rules-in-startup/51973187#51973187", "title": "How to register client validation rules in startup?", "body": "<p>The options you need to configure are the <a href=\"https://docs.microsoft.com/en-gb/dotnet/api/microsoft.aspnetcore.mvc.mvcviewoptions?view=aspnetcore-2.1\" rel=\"nofollow noreferrer\">MvcViewOptions</a> accessible inside <code>services.AddMvc().AddViewOptions(o =&gt; o.ClientModelValidatorProviders.Add(new DateInputValidatorProvider()));</code></p>\n"}], "owner": {"reputation": 6125, "user_id": 846281, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01438c3df63caf4c986268852935fcbd?s=128&d=identicon&r=PG", "display_name": "Andrew Simpson", "link": "https://stackoverflow.com/users/846281/andrew-simpson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 51973187, "answer_count": 1, "score": 0, "last_activity_date": 1535757253, "creation_date": 1534962103, "last_edit_date": 1535757253, "question_id": 51972964, "link": "https://stackoverflow.com/questions/51972964/how-to-register-client-validation-rules-in-startup", "title": "How to register client validation rules in startup?", "body": "<p>So far I have this:</p>\n\n<pre><code>public class DateInputValidator : IClientModelValidator\n{\n    public void AddValidation(ClientModelValidationContext context)\n    {\n        context.Attributes[\"data-val\"] = \"true\";\n        context.Attributes[\"data-val-custom\"] = \"Error message\";\n        this.GetErrorMessage(context);\n    }\n\n    private string GetErrorMessage(ClientModelValidationContext context)\n    {\n        return $\"{context.ModelMetadata.GetDisplayName()} is not a valid youtube url\";\n    }\n}\n\npublic class DateInputValidatorProvider : IClientModelValidatorProvider\n{\n    public void CreateValidators(ClientValidatorProviderContext context)\n    {\n        if (context.ModelMetadata.ModelType == typeof(string) &amp;&amp;\n            context.ModelMetadata.DataTypeName == \"DateInputType\" &amp;&amp;\n            !context.Results.Any(m =&gt; m.Validator is DateInputValidator))\n        {\n            context.Results.Add(new ClientValidatorItem\n            {\n                Validator = new DateInputValidator(),\n                IsReusable = true\n            });\n        }\n    }\n}\n</code></pre>\n\n<p>and I am trying to register via the example I found on the web:</p>\n\n<p>In startUp.cs</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    services.Configure(o =&gt;\n    o.ClientModelValidatorProviders.Add(new DateInputValidatorProvider()));\n}\n</code></pre>\n\n<p>but get the error:</p>\n\n<blockquote>\n  <p>'IServiceCollection' does not contain a definition for 'Configure' and the best extension method overload 'WebHostBuilderExtensions.Configure(IWebHostBuilder, Action)' requires a receiver of type 'IWebHostBuilder'    </p>\n</blockquote>\n"}, {"tags": ["c#", ".net", "overloading", "console.writeline"], "comments": [{"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1534962320, "post_id": 51972949, "comment_id": 90896428, "body": "Your impression is indeed wrong, but without knowing <i>why</i> you believe a false thing, it is difficult to concisely disabuse you of your false belief. Can you tell us more about why you believe that the expected behaviour differs from the actual behaviour?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1534962386, "post_id": 51972949, "comment_id": 90896457, "body": "For example, it seems like you believe that putting an object in an array puts the <i>variable name used to store the reference</i> in the array, but it does no such thing.  In your case <code>gus</code> will be <code>null</code>, and so that is what is stored in the array."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1534962432, "post_id": 51972949, "comment_id": 90896474, "body": "For example, it seems like you believe that concatenating an array to a string prints the contents of the array; it does not. It prints the type of the array.  There <i>is</i> a case where passing an array to <code>WriteLine</code> prints the contents of the array, but this isn&#39;t it.  Were you expecting that?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1534962475, "post_id": 51972949, "comment_id": 90896491, "body": "My point is: there are any number of false beliefs you might have, all of which should be disabused, but we don&#39;t know what they are. Edit the question to say more about what you think this program should do and why, and we can explain where you&#39;re wrong."}, {"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1534962575, "post_id": 51972949, "comment_id": 90896537, "body": "Just to add that what you have done is not an <i>overload</i> of <code>Console.WriteLine</code>. You have effectively wrapped the functionality of it in another function, not overloaded it."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1534962878, "post_id": 51972949, "comment_id": 90896658, "body": "Also, you might say why you make your method a <code>params</code> method -- a <i>variadic</i> method, to use the jargon -- but then did not use that fact in your program. Can you say why you are calling a variadic method in its normal form, not its expanded form? Was this intentional?"}, {"owner": {"reputation": 21, "user_id": 10261225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8274523dd38c45ec7579f90c8fca3b03?s=128&d=identicon&r=PG&f=1", "display_name": "jz_17", "link": "https://stackoverflow.com/users/10261225/jz-17"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1534963200, "post_id": 51972949, "comment_id": 90896807, "body": "yes this is exactly what i was expecting : There is a case where passing an array to WriteLine prints the contents of the array, @EricLippert"}], "answers": [{"comments": [{"owner": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "edited": false, "score": 0, "creation_date": 1534964308, "post_id": 51973143, "comment_id": 90897313, "body": "If this helps, please mark my answer as accepted so that this question can be seen as answered."}, {"owner": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "reply_to_user": {"reputation": 21, "user_id": 10261225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8274523dd38c45ec7579f90c8fca3b03?s=128&d=identicon&r=PG&f=1", "display_name": "jz_17", "link": "https://stackoverflow.com/users/10261225/jz-17"}, "edited": false, "score": 0, "creation_date": 1534967228, "post_id": 51973143, "comment_id": 90898628, "body": "@jz_17 you&#39;re welcome.  just mark either my answer or Eric&#39;s as accepted (click the checkmark next to either of our answers) to show that this question has been answered."}], "tags": [], "owner": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "is_accepted": true, "score": 1, "last_activity_date": 1534962880, "creation_date": 1534962880, "answer_id": 51973143, "question_id": 51972949, "link": "https://stackoverflow.com/questions/51972949/having-trouble-using-the-console-writeline-overload-function-to-pass-arrays/51973143#51973143", "title": "having trouble using the console.writeline overload function to pass arrays", "body": "<p>First off, the problem you're experiencing has nothing to do with the overloaded function of <code>Console.WriteLine</code>.</p>\n\n<p>Rather.. you are creating <code>object</code> variables but not giving them any values to hold, so they're <code>null</code>.. so with your current code... it would end up with <code>\"you're cool \"</code>, and that's it because the variables that are <strong>named</strong> <code>mike</code>, <code>gus</code>, and <code>julio</code> don't actually contain any values.   </p>\n\n<hr>\n\n<p><strong>Solution One</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\npublic class Program\n{\n    private static object mike = \"mike\"; // give the variable a value to hold\n    private static object gus = \"gus\"; // give the variable a value to hold\n    private static object julio = \"julio\"; // give the variable a value to hold\n    public static void Main()\n    {\n        object[] names = new object[3];\n        names[1] = mike;\n        names[0] = gus;\n        names[2] = julio;\n        WriteAnswer(\" you're cool \", names);\n    }\n\n    static void WriteAnswer(string description, object[] result)\n    {\n            Console.WriteLine(description + string.Join(\",\", result));\n    }\n}\n</code></pre>\n\n<p>I have edited your code in <a href=\"https://dotnetfiddle.net/PAcgWg\" rel=\"nofollow noreferrer\">DotNetFiddle</a></p>\n\n<hr>\n\n<p><strong>Solution 2</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\npublic class Program\n{\n    private static object mike = \"mike\"; // give the variable a value to hold\n    private static object gus = \"gus\"; // give the variable a value to hold\n    private static object julio = \"julio\"; // give the variable a value to hold\n    public static void Main()\n    {\n        object[] names = new object[3];\n        names[1] = mike;\n        names[0] = gus;\n        names[2] = julio;\n        WriteAnswer(\" you're cool \", names);\n    }\n\n    static void WriteAnswer(string description, object[] result)\n    {\n        for(int i = 0; i &lt; result.Length; i++)\n        {\n            Console.WriteLine(description + result[i]);\n        }\n\n    }\n}\n</code></pre>\n\n<p><a href=\"https://dotnetfiddle.net/jGUj6Q\" rel=\"nofollow noreferrer\">DotNetFiddle</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 3, "last_activity_date": 1534964287, "creation_date": 1534964287, "answer_id": 51973460, "question_id": 51972949, "link": "https://stackoverflow.com/questions/51972949/having-trouble-using-the-console-writeline-overload-function-to-pass-arrays/51973460#51973460", "title": "having trouble using the console.writeline overload function to pass arrays", "body": "<p>As M12's answer points out, you are not ever assigning values to your variables, so they'll always be null. Plainly that has to be fixed first.  To answer your actual concern though:</p>\n\n<blockquote>\n  <p>I was expecting : There is a case where passing an array to WriteLine prints the contents of the array</p>\n</blockquote>\n\n<p>Let's make some modifications to your program and then discuss how <code>WriteLine</code> works. We'll make an array of strings, and initialize its contents:</p>\n\n<pre><code>string[] names = { \"Gus\", \"Mike\", \"Julio\" };\n</code></pre>\n\n<p>Now, what are our options for <code>WriteLine</code> and what do they do? Suppose you have</p>\n\n<pre><code>Console.WriteLine(\"you're cool \" + names);\n</code></pre>\n\n<p>What happens?</p>\n\n<p>First, <code>\"you're cool\" + names</code> is analyzed to determine that it is an addition of a string and an object, so this becomes:</p>\n\n<pre><code>string temp = String.Concat(\"you're cool \", names.ToString());\nConsole.WriteLine(temp);\n</code></pre>\n\n<p>(Aside: it is not <em>exactly</em> that; do you see why?)</p>\n\n<p>Now we must determine what <code>names.ToString()</code> does.  It returns a string giving the type of the array.  If you want instead to create a string that joins together the contents, use <code>string.Join</code>.</p>\n\n<p>What about the variadic overloads of <code>WriteLine</code>?  What if instead we called</p>\n\n<pre><code>Console.WriteLine(\"you're cool \", names);\n</code></pre>\n\n<p>The formal parameter types of the applicable <code>WriteLine</code>s are:</p>\n\n<pre><code>(string, object)\n(string, params object[])\n</code></pre>\n\n<p>So there are three possibilities:</p>\n\n<ol>\n<li>Call <code>(string, object)</code> with the array as the object.</li>\n<li>Call <code>(string, object[])</code> with the array as the <code>object[]</code>. (This is legal in C# because of <em>unsafe array covariance</em>.)</li>\n<li>Call <code>(string, object[])</code> in the expanded form: that is, create a new <code>object[1] {names}</code> and pass that.</li>\n</ol>\n\n<p>C# rejects the third option: a variadic method applicable in its normal form is always better than the expanded form.</p>\n\n<p>C# rejects the first option because <code>object</code> is more general than <code>object[]</code>.</p>\n\n<p>Therefore C# calls the second overload.  Now read the documentation for that overload; what do you think it will do, given the proposed <em>format string</em> and <em>format arguments</em>?</p>\n"}], "owner": {"reputation": 21, "user_id": 10261225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8274523dd38c45ec7579f90c8fca3b03?s=128&d=identicon&r=PG&f=1", "display_name": "jz_17", "link": "https://stackoverflow.com/users/10261225/jz-17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 51973143, "answer_count": 2, "score": 0, "last_activity_date": 1534964287, "creation_date": 1534962040, "last_edit_date": 1534962805, "question_id": 51972949, "link": "https://stackoverflow.com/questions/51972949/having-trouble-using-the-console-writeline-overload-function-to-pass-arrays", "title": "having trouble using the console.writeline overload function to pass arrays", "body": "<p>beginner here : </p>\n\n<p>I'm I misunderstanding the use of the overloaded function?  </p>\n\n<pre><code>namespace Grades\n{\n    class Program\n    {\n        private static object mike;\n        private static object gus;\n        private static object julio;\n\n        static void Main(string[] args)\n        {\n            object[] names = new object[3];\n            names[1] = mike;\n            names[0] = gus;\n            names[2] = julio;\n\n            WriteAnswer(\" you're cool \",  names );\n        }\n\n        static void WriteAnswer(string description, params  object[] result)\n        {\n            Console.WriteLine(description + \" \" + result);   \n        }\n    }\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>you're cool System.Object[]\n</code></pre>\n\n<p>I was under the impression that the output would be:</p>\n\n<pre><code>you're cool gus mike julio \n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>you're cool gus \nyou're cool mike \nyou're cool julio\n</code></pre>\n"}, {"tags": ["c#", "ios", "swift", "unity3d", "arkit"], "comments": [{"owner": {"reputation": 118118, "user_id": 957768, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/T6ijf.png?s=128&g=1", "display_name": "rickster", "link": "https://stackoverflow.com/users/957768/rickster"}, "edited": false, "score": 2, "creation_date": 1534982414, "post_id": 51972852, "comment_id": 90903453, "body": "Unity appears to have <a href=\"https://bitbucket.org/Unity-Technologies/unity-arkit-plugin/src/arkit2.0_beta/docs/WhatsNewInARKit2_0.md?fileviewer=file-view-default\" rel=\"nofollow noreferrer\">some docs</a> on the subject."}], "answers": [{"tags": [], "owner": {"reputation": 2087, "user_id": 2855173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/R46EO.jpg?s=128&g=1", "display_name": "halileohalilei", "link": "https://stackoverflow.com/users/2855173/halileohalilei"}, "is_accepted": true, "score": 1, "last_activity_date": 1535664694, "creation_date": 1535664694, "answer_id": 52105631, "question_id": 51972852, "link": "https://stackoverflow.com/questions/51972852/using-arkit-2-0s-arenvironmentprobeanchor-environmenttexture-in-unity-to-genera/52105631#52105631", "title": "Using ARKit 2.0&#39;s AREnvironmentProbeAnchor.environmentTexture in Unity to generate reflection probes", "body": "<p>As per @rickster's suggestion, I had a look at the ARKit 2.0 Unity plugin's implementation, and I managed to actually use the <code>AREnvironmentProbeAnchor.environmentTexture</code> inside my Unity scene.</p>\n\n<p><code>MTLTexture</code> has a property named <code>textureType</code>, which is an enum value and is <code>.typeCubeArray</code> for the texture returned by <code>AREnvironmentProbeAnchor.environmentTexture</code>. This is explained thoroughly on the <code>MTLTexture</code> <a href=\"https://developer.apple.com/documentation/metal/mtltexture\" rel=\"nofollow noreferrer\">documentation page</a>.</p>\n\n<p>A <code>MTLTexture</code> having a <code>texturetype</code> of type <code>.typeCubeArray</code> means that when you pass the pointer to this <code>MTLTexture</code> to the Unity side, you can use it to create a <code>Cubemap</code>, which you can then use as your reflection probes environment texture. Here's how things roughly work on the Unity side:</p>\n\n<pre><code>// You can pass the pointer to your MTLTexture as an IntPtr to the Unity side\n[DllImport(\"__Internal\")]\npublic static extern IntPtr GetEnvironmentTexture();\n\nvoid AddNewProbe() \n{\n    var texturePtr = GetEnvironmentTexture();\n    if (texturePtr == IntPtr.Zero)\n    {\n        continue;\n    }\n\n    var cubemap = Cubemap.CreateExternalTexture(0, TextureFormat.R8, false, texturePtr);\n    var probeComponent = AddComponent&lt;ReflectionProbe&gt;();\n    probeComponent.customBakedTexture = cubemap;\n}\n</code></pre>\n\n<p>And on the iOS side, you just need to have a method with the name you declared on the Unity side, which returns a pointer to your <code>MTLTexture</code>. Its return type can be <code>void*</code> or <code>id&lt;MTLTexture&gt;</code>, both of them works fine. This method should be placed on your Unity bridge for it to be visible to the Unity side.</p>\n\n<pre><code>extern \"C\" void* GetEnvironmentTexture() {\n    AREnvironmentProbeAnchor* anchor = [self updatedEnvironmentProbeAnchor];\n    return (__bridge_retained void*) [anchor environmentTexture];\n}\n</code></pre>\n\n<p>You can (and frankly, should) modify and improve this to fit your needs.</p>\n"}], "owner": {"reputation": 2087, "user_id": 2855173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/R46EO.jpg?s=128&g=1", "display_name": "halileohalilei", "link": "https://stackoverflow.com/users/2855173/halileohalilei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 1, "accepted_answer_id": 52105631, "answer_count": 1, "score": 0, "last_activity_date": 1535664878, "creation_date": 1534961687, "last_edit_date": 1535664878, "question_id": 51972852, "link": "https://stackoverflow.com/questions/51972852/using-arkit-2-0s-arenvironmentprobeanchor-environmenttexture-in-unity-to-genera", "title": "Using ARKit 2.0&#39;s AREnvironmentProbeAnchor.environmentTexture in Unity to generate reflection probes", "body": "<p>I'm playing around with ARKit 2.0 beta. I see that when I enable environment texturing, the <code>AREnvironmentProbeAnchor</code>'s that are added to the scene have a <code>environmentTexture</code> field which is a <code>MTLTexture</code>, and represents the actual cube map that will be used as environment maps. When I look at this texture from Quick View, I see that it has 6 different images for each direction, but how is this represented in the memory? How can I access each image separately and use them for whatever?</p>\n\n<p>What I'm trying to do is pass this <code>MTLTexture</code> to Unity and use it there on a reflection probe, but I need to know how this texture is represented and how to use it. Any information on this is appreciated.</p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 202, "user_id": 7003817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b651d5daa52cd9c4ad0caa2af2deca63?s=128&d=identicon&r=PG&f=1", "display_name": "C Smith", "link": "https://stackoverflow.com/users/7003817/c-smith"}, "edited": false, "score": 5, "creation_date": 1534961866, "post_id": 51972847, "comment_id": 90896233, "body": "Change the return type from &#39;object&#39; on RetrieveSession() to &#39;UserInfo&#39;?"}, {"owner": {"reputation": 2918, "user_id": 173225, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d4026278467f3d6b3222d6037919d35e?s=128&d=identicon&r=PG", "display_name": "Colin Young", "link": "https://stackoverflow.com/users/173225/colin-young"}, "edited": false, "score": 0, "creation_date": 1534961901, "post_id": 51972847, "comment_id": 90896248, "body": "What error or issue are you seeing?"}, {"owner": {"reputation": 180, "user_id": 2141030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gKFYH.jpg?s=128&g=1", "display_name": "DontThinkJustGo", "link": "https://stackoverflow.com/users/2141030/dontthinkjustgo"}, "edited": false, "score": 0, "creation_date": 1534962097, "post_id": 51972847, "comment_id": 90896330, "body": "In C#, you are returning the object not the class. Just an FYI for better question writing in the future. see: <a href=\"https://stackoverflow.com/questions/8550130/what-is-the-difference-between-objects-and-classes-in-c#8550151\" title=\"what is the difference between objects and classes in c%238550151\">stackoverflow.com/questions/8550130/&hellip;</a>"}, {"owner": {"reputation": 731, "user_id": 3692679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973ed2f40a0b084b506463a68e2e4560?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3692679/mike"}, "edited": false, "score": 0, "creation_date": 1534964524, "post_id": 51972847, "comment_id": 90897423, "body": "returning an object or a class?? a class is an object definition, there&#39;s no way to return a &quot;class&quot;, the class should be defined in your scope to be able to create an instance (object) out of it."}, {"owner": {"reputation": 731, "user_id": 3692679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973ed2f40a0b084b506463a68e2e4560?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3692679/mike"}, "edited": false, "score": 0, "creation_date": 1534964668, "post_id": 51972847, "comment_id": 90897485, "body": "so many terrible casts , change the &quot;var user&quot; for  &quot;UserInfo user&quot;  change the prive object restrievesession for &quot;Private UserInfo Retrievesession"}, {"owner": {"reputation": 29, "user_id": 10161584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NHtEx24fYa4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oaEnnC8vmPOtOOlNUENuvQF5QlJQ/mo/photo.jpg?sz=128", "display_name": "Tom Mauldin", "link": "https://stackoverflow.com/users/10161584/tom-mauldin"}, "edited": false, "score": 0, "creation_date": 1534964813, "post_id": 51972847, "comment_id": 90897551, "body": "The calling method does not recognize the object returned as the userinfo class.  It doesn&#39;t see the properties of the class."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1534965451, "post_id": 51972847, "comment_id": 90897841, "body": "That&#39;s because the return type for <code>RetrieveSession</code> is defined as <code>object</code>. See the first comment..."}], "answers": [{"comments": [{"owner": {"reputation": 202, "user_id": 7003817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b651d5daa52cd9c4ad0caa2af2deca63?s=128&d=identicon&r=PG&f=1", "display_name": "C Smith", "link": "https://stackoverflow.com/users/7003817/c-smith"}, "edited": false, "score": 0, "creation_date": 1534962060, "post_id": 51972917, "comment_id": 90896314, "body": "HttpContext.Current.Session acts like a dictionary for objects, so you just need to get the value via the indexer and cast it"}], "tags": [], "owner": {"reputation": 573, "user_id": 7015118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1PJLG.png?s=128&g=1", "display_name": "Any Moose", "link": "https://stackoverflow.com/users/7015118/any-moose"}, "is_accepted": false, "score": 0, "last_activity_date": 1534961936, "creation_date": 1534961936, "answer_id": 51972917, "question_id": 51972847, "link": "https://stackoverflow.com/questions/51972847/can-a-class-be-returned-to-the-calling-method-c/51972917#51972917", "title": "Can a class be returned to the calling method C#?", "body": "<p>Try new Object...</p>\n\n<pre><code> private void CheckForUserType()\n {\n    var user = RetrieveSession();\n }\n\n\n private UserInfo RetrieveSession()\n {\n    UserInfo userInfo = new UserInfo(HttpContext.Current.Session[\"userInfo\"]);\n    return userInfo;\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10261224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9WyG6.jpg?s=128&g=1", "display_name": "Dan P", "link": "https://stackoverflow.com/users/10261224/dan-p"}, "is_accepted": false, "score": -1, "last_activity_date": 1534964427, "creation_date": 1534964427, "answer_id": 51973492, "question_id": 51972847, "link": "https://stackoverflow.com/questions/51972847/can-a-class-be-returned-to-the-calling-method-c/51973492#51973492", "title": "Can a class be returned to the calling method C#?", "body": "<p>Like said above return the UserInfo object, and maybe make it public instead of private if you calling it from different areas.\nI'd be careful with session objects, especially if you're using multiple servers or azure, make sure that you're doing it right. Best to not use session object and user oauth2 owin/katana</p>\n"}, {"tags": [], "owner": {"reputation": 1354, "user_id": 10230250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd88700623b97c996d5407464bd9c2a9?s=128&d=identicon&r=PG&f=1", "display_name": "dj079", "link": "https://stackoverflow.com/users/10230250/dj079"}, "is_accepted": true, "score": 0, "last_activity_date": 1534969407, "creation_date": 1534969407, "answer_id": 51974572, "question_id": 51972847, "link": "https://stackoverflow.com/questions/51972847/can-a-class-be-returned-to-the-calling-method-c/51974572#51974572", "title": "Can a class be returned to the calling method C#?", "body": "<p>You need a small tweak in your code. Change return type from <code>object</code> to <code>UserInfo</code>. </p>\n\n<pre><code>   private UserInfo RetrieveSession()\n   {\n        var userInfo =(UserInfo)HttpContext.Current.Session[\"userInfo\"];\n        return userInfo;\n   }\n</code></pre>\n\n<p>You may need to change your <code>access modifier</code> based on the way you want to use this method. </p>\n"}], "owner": {"reputation": 29, "user_id": 10161584, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NHtEx24fYa4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oaEnnC8vmPOtOOlNUENuvQF5QlJQ/mo/photo.jpg?sz=128", "display_name": "Tom Mauldin", "link": "https://stackoverflow.com/users/10161584/tom-mauldin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 51974572, "answer_count": 3, "score": 0, "last_activity_date": 1534969407, "creation_date": 1534961651, "last_edit_date": 1534963310, "question_id": 51972847, "link": "https://stackoverflow.com/questions/51972847/can-a-class-be-returned-to-the-calling-method-c", "title": "Can a class be returned to the calling method C#?", "body": "<p>I am new to C# and need some help. I have a ASP.Net page that uses the Session variable in several different methods. The Session variable is a UserInfo class used to store user info between pages. I am trying to have one method creates the userinfo class from the Session and returns it to the calling methods. I am sure it can be done I just can't figure it out. Any help will be greatly appreciated.</p>\n\n<pre><code>private void CheckForUserType()\n{\n    var user = RetrieveSession();\n}\n\nprivate object RetrieveSession()\n{\n    var userInfo =(UserInfo)HttpContext.Current.Session[\"userInfo\"];\n    return userInfo;\n}\n</code></pre>\n"}, {"tags": ["c#", "json", "razor"], "comments": [{"owner": {"reputation": 3028, "user_id": 1316856, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c234d38e0abe44f3813ff88987e1ddaa?s=128&d=identicon&r=PG", "display_name": "Parrish Husband", "link": "https://stackoverflow.com/users/1316856/parrish-husband"}, "edited": false, "score": 0, "creation_date": 1534962675, "post_id": 51972812, "comment_id": 90896571, "body": "You don&#39;t need a dictionary, you have a database.  If you&#39;re using Web API write a Get method that calls &#39;SELECT make FROM cars WHERE year = @year&#39;."}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1534962874, "post_id": 51972812, "comment_id": 90896653, "body": "Why not try using a Dictionary yourself first and post any errors you are running into ?"}, {"owner": {"reputation": 31181, "user_id": 5176071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IQD5c.jpg?s=128&g=1", "display_name": "D-Shih", "link": "https://stackoverflow.com/users/5176071/d-shih"}, "edited": false, "score": 0, "creation_date": 1534963140, "post_id": 51972812, "comment_id": 90896776, "body": "Your json data is array not object so I think you can&#39;t use key/value to do it."}], "answers": [{"tags": [], "owner": {"reputation": 31181, "user_id": 5176071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IQD5c.jpg?s=128&g=1", "display_name": "D-Shih", "link": "https://stackoverflow.com/users/5176071/d-shih"}, "is_accepted": false, "score": 0, "last_activity_date": 1534964307, "creation_date": 1534964307, "answer_id": 51973465, "question_id": 51972812, "link": "https://stackoverflow.com/questions/51972812/c-razor-list-to-json-get-value-by-key/51973465#51973465", "title": "C# Razor List to JSON: Get value by key", "body": "<p>Your current JSON data is an array not object so I think you can't use key/value to do it.</p>\n\n<p>if you want to use JSON key/value in Javascript.</p>\n\n<p>You can try to create a <code>AutoMakes</code> class instead of <code>string[2]</code> to carry your data.</p>\n\n<pre><code>public class AutoMakes\n{\n\n    public string id { get; set; }\n    public string make { get; set; }\n}\n</code></pre>\n\n<p>then you can do it like, <code>SerializeObject</code> in controller carry the JSON with string.</p>\n\n<pre><code>List&lt;AutoMakes&gt; ListOfAutoMakes = new List&lt;AutoMakes&gt;();\nforeach (var item in SQDB.Query(\"SELECT year, make FROM cars\"))\n{\n    ListOfAutoMakes.Add(new AutoMakes()\n    {\n        id = item.id.Trim(),\n        make = item.make.Trim()\n    });\n}\nViewBag.ListOfAutoMakes = Newtonsoft.Json.JsonConvert.SerializeObject(ListOfAutoMakes);\n</code></pre>\n\n<p>then you can show array first object key=<code>id</code> value.</p>\n\n<pre><code>var AutoMakeList = @Html.Raw(ViewBag.ListOfAutoMakes);\nalert(AutoMakeList[0].id);  \n</code></pre>\n\n<p><a href=\"https://dotnetfiddle.net/eMmM5X\" rel=\"nofollow noreferrer\">Here is a sample</a> </p>\n\n<p><strong>Note</strong> </p>\n\n<p>I would use ajax to call the JSON data instead of use razor, becasue that will be More flexible.</p>\n"}], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1534964307, "creation_date": 1534961494, "question_id": 51972812, "link": "https://stackoverflow.com/questions/51972812/c-razor-list-to-json-get-value-by-key", "title": "C# Razor List to JSON: Get value by key", "body": "<p>I am pulling data from a database on a Razor page and putting it in a list. The intention is for the user to type in a year, and the Make of the car should pop up.</p>\n\n<p>C#</p>\n\n<pre><code>List&lt;string[]&gt; ListOfAutoMakes = new List&lt;string[]&gt;();\nforeach (var item in SQDB.Query(\"SELECT year, make FROM cars\"))\n{\n    string[] AutoMakes = new string[2];\n    AutoMakes [0] = item.id.Trim();\n    AutoMakes [1] = item.make.Trim();\n    ListOfAutoMakes.Add(AutoMakes);\n}\n</code></pre>\n\n<p>The Javascript in the cshtml file:</p>\n\n<pre><code>var AutoMakeList = '@Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(ListOfAutoMakes.ToArray()))';\nalert(AutoMakeList.1983 + ' ' + AutoMakeList['1991'])\n</code></pre>\n\n<p>The rendered Javascript shows my data looks like this:</p>\n\n<pre><code>var AutoMakeList = '[[\"1983\",\"VOLVO\"],[\"1991\",\"FIAT\"],[\"1982\",\"VOLVO\"]]'\n</code></pre>\n\n<p>And the output is <code>Undefined</code> or an empty string.</p>\n\n<p>Obviously, I am not getting a Key/Value pair. I am certain the issue is in how I am building my C# List, but I am not sure how I should be creating it. I'm a noob with C#, but I believe I am building an array of arrays when I really need to build a dictionary. I've spent the day googling creating a C# dictionary, serializing it to JSON, then accessing the resulting JSON via an Key. All the examples I find are either for older/other versions of C# or not complete enough for me to connect all the dots.</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1534961499, "post_id": 51972664, "comment_id": 90896050, "body": "Have you tried just calling the method, maybe like <code>btnGenerate_Click(null, null)</code> (or <code>btnGenerate_Click(sender, e)</code>? What happened?"}], "answers": [{"tags": [], "owner": {"reputation": 19618, "user_id": 860585, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/YagL1.jpg?s=128&g=1", "display_name": "Rotem", "link": "https://stackoverflow.com/users/860585/rotem"}, "is_accepted": true, "score": 2, "last_activity_date": 1534961026, "creation_date": 1534961026, "answer_id": 51972701, "question_id": 51972664, "link": "https://stackoverflow.com/questions/51972664/execute-click-event-in-load-form/51972701#51972701", "title": "Execute click event in load form", "body": "<p>You could simply call <code>btnGenerate_Click(sender, e);</code> from the <code>load</code> event, but the more idiomatic way is that both events call a separate method:</p>\n\n<pre><code>private void MyForm_Load(object sender, EventArgs e)\n{\n    DoSomething();\n}\n\nprivate void btnGenerate_Click(object sender, EventArgs e)\n{\n    DoSomething();\n}\n\nprivate void DoSomething() { ... }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3279, "user_id": 1459036, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yeDJp.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/1459036/brad"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1535028047, "post_id": 51972704, "comment_id": 90921403, "body": "Ok, I gave that as example, but you should be able to use the same logic but use the winforms button ID/Name"}], "tags": [], "owner": {"reputation": 3279, "user_id": 1459036, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/yeDJp.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/1459036/brad"}, "is_accepted": false, "score": -1, "last_activity_date": 1534961050, "creation_date": 1534961050, "answer_id": 51972704, "question_id": 51972664, "link": "https://stackoverflow.com/questions/51972664/execute-click-event-in-load-form/51972704#51972704", "title": "Execute click event in load form", "body": "<p>You can pass it the Button object:</p>\n\n<p>I am doing it with my submit button like this:</p>\n\n<pre><code>// calling it inline, where Submit is the object/button (see HTML below for declaring it)\nbtnSubmit_Click(Submit, null);\n\n\n// button submit call\nprotected void btnSubmit_Click(object sender, EventArgs e)\n\n\n&lt;asp:Button ID=\"Submit\" Text=\"Submit\" runat = \"server\" onClick=\"btnSubmit_Click\" /&gt;\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 10200754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885885af296b3202d40e7347040836db?s=128&d=identicon&r=PG&f=1", "display_name": "Rene", "link": "https://stackoverflow.com/users/10200754/rene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 51972701, "answer_count": 2, "score": 0, "last_activity_date": 1534961050, "creation_date": 1534960831, "question_id": 51972664, "link": "https://stackoverflow.com/questions/51972664/execute-click-event-in-load-form", "title": "Execute click event in load form", "body": "<p>I have a simple windows form with <code>_load</code> event</p>\n\n<pre><code> private void MyForm_Load(object sender, EventArgs e)\n        {\n          //Code there\n        }\n</code></pre>\n\n<p>and I have a button click event in the same form like</p>\n\n<pre><code>  private void btnGenerate_Click(object sender, EventArgs e)\n        {\n             //Code there\n        }\n</code></pre>\n\n<p>I want to know how can I execute click event in load form. Regards</p>\n"}, {"tags": ["c#", "list"], "comments": [{"owner": {"reputation": 131, "user_id": 10195983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c39cdcb7b9f67ca032cc0aa3cca2609?s=128&d=identicon&r=PG", "display_name": "Ludwig Von Chesterfield", "link": "https://stackoverflow.com/users/10195983/ludwig-von-chesterfield"}, "edited": false, "score": 0, "creation_date": 1534961051, "post_id": 51972660, "comment_id": 90895862, "body": "Now that I think of it, just having two seperate lists in these classes could work. But the question of &quot;overriding&quot;/redefining stands."}, {"owner": {"reputation": 202, "user_id": 7003817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b651d5daa52cd9c4ad0caa2af2deca63?s=128&d=identicon&r=PG&f=1", "display_name": "C Smith", "link": "https://stackoverflow.com/users/7003817/c-smith"}, "edited": false, "score": 0, "creation_date": 1534967274, "post_id": 51972660, "comment_id": 90898650, "body": "you could leave it as List&lt;Parent&gt; and that would still be valid to store child instances in it, you could use list_of.OfType&lt;Child&gt; to return them as child instances"}], "answers": [{"tags": [], "owner": {"reputation": 1194, "user_id": 7594662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PNwQk.jpg?s=128&g=1", "display_name": "Bagdan Gilevich", "link": "https://stackoverflow.com/users/7594662/bagdan-gilevich"}, "is_accepted": true, "score": 1, "last_activity_date": 1534967296, "last_edit_date": 1534967296, "creation_date": 1534961797, "answer_id": 51972880, "question_id": 51972660, "link": "https://stackoverflow.com/questions/51972660/redefining-lists-content-type/51972880#51972880", "title": "Redefining list&#39;s content type", "body": "<p>Basically, no. About overriding:</p>\n\n<ul>\n<li>It is not possible to override a field</li>\n<li>You can override a <code>virtual</code> property or function</li>\n<li>You can't change type when overriding anything (even type parameter of generic type)</li>\n</ul>\n\n<p>But you can <em>hide</em> field/property/function with a <code>new</code> keyword and change type:</p>\n\n<pre><code>public class Parent\n{\n    public List&lt;Parent&gt; ListOf = new List&lt;Parent&gt;();\n}\n\npublic class Child : Parent\n{\n    public new List&lt;Child&gt; ListOf = new List&lt;Child&gt;();\n}\n</code></pre>\n\n<p>It is not overriding, there you still can access <code>Parent</code>'s <code>ListOf</code> field, but only if you cast <code>Child</code> to <code>Parent</code>.</p>\n\n<p>Also, there should be mentioned that you can treat <code>ISomeGeneric&lt;Child&gt;</code> type as <code>ISomeGeneric&lt;Parent&gt;</code> type only if they are covariant (declared as <code>ISomeGeneric&lt;out T&gt;</code>). <code>List&lt;T&gt;</code> isn't covariant (<a href=\"https://stackoverflow.com/questions/2033912/c-sharp-variance-problem-assigning-listderived-as-listbase\">here's why</a>), so <code>List&lt;Child&gt;</code> can't be treated as <code>List&lt;Parent&gt;</code>, these are two different types.\nBut <code>IEnumerable&lt;T&gt;</code> is covariant, so you can make <code>ListOf</code> a property, change it's type to <code>IEnumerable&lt;Parent&gt;</code> and instantiate it with a <code>IEnumerable&lt;Child&gt;</code> in a derived class:</p>\n\n<pre><code>public class Parent\n{\n    public virtual IEnumerable&lt;Parent&gt; ListOf { get; set; } = new List&lt;Parent&gt;();\n}\n\npublic class Child : Parent\n{\n    public override IEnumerable&lt;Parent&gt; ListOf { get; set; } = new List&lt;Child&gt;();\n}\n</code></pre>\n\n<p>But even there you can't change property type <code>IEnumerable&lt;Parent&gt;</code> to <code>IEnumerable&lt;Child&gt;</code> when overriding.</p>\n"}], "owner": {"reputation": 131, "user_id": 10195983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c39cdcb7b9f67ca032cc0aa3cca2609?s=128&d=identicon&r=PG", "display_name": "Ludwig Von Chesterfield", "link": "https://stackoverflow.com/users/10195983/ludwig-von-chesterfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 51972880, "answer_count": 1, "score": 0, "last_activity_date": 1534967296, "creation_date": 1534960822, "question_id": 51972660, "link": "https://stackoverflow.com/questions/51972660/redefining-lists-content-type", "title": "Redefining list&#39;s content type", "body": "<p>Okay, this might be another stupid question to ask in a strict-type programming language, but...</p>\n\n<pre><code>public class Parent\n{\n    public List&lt;Parent&gt; list_of = new List&lt;Parent&gt;;\n}\n\npublic class Child : Parent\n{\n    public List&lt;Child&gt; list_of = new List&lt;Child&gt;;\n}\n</code></pre>\n\n<p>Basically, what I am asking, is it possible to change list's \"content\" type in children classes?</p>\n"}, {"tags": ["c#", "linq", "ienumerable", "ienumerator"], "comments": [{"owner": {"reputation": 531, "user_id": 2115318, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/39VBm.jpg?s=128&g=1", "display_name": "PiJei", "link": "https://stackoverflow.com/users/2115318/pijei"}, "edited": false, "score": 1, "creation_date": 1534961272, "post_id": 51972590, "comment_id": 90895956, "body": "The difference is that transformed  is IEnumerable, weheras transformedList  is a list, because you are calling ToList() on the latter. While you can modify the values in the List, you can only enumerate over the IEnumerable."}, {"owner": {"reputation": 202, "user_id": 7003817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b651d5daa52cd9c4ad0caa2af2deca63?s=128&d=identicon&r=PG&f=1", "display_name": "C Smith", "link": "https://stackoverflow.com/users/7003817/c-smith"}, "edited": false, "score": 4, "creation_date": 1534961321, "post_id": 51972590, "comment_id": 90895980, "body": "because you have not &#39;enumerated&#39; the first IEnumerable, when you iterate back through it again to print them out it will &#39;re-enumerate&#39; (run through the select statement again) the IEnumerable again and so will not have your changes."}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 2, "creation_date": 1534961758, "post_id": 51972590, "comment_id": 90896191, "body": "If you want to compare array to list you need to slap a <code>ToArray</code> on the end of that first one."}], "answers": [{"comments": [{"owner": {"reputation": 5911, "user_id": 1688785, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07b2da937aa23792045dff6ff19556eb?s=128&d=identicon&r=PG", "display_name": "Caramiriel", "link": "https://stackoverflow.com/users/1688785/caramiriel"}, "edited": false, "score": 1, "creation_date": 1534962167, "post_id": 51972882, "comment_id": 90896360, "body": "Maybe something to add is that everytime <code>foreach (var i in transformed)</code> is executed, new <code>Example</code> objects are being created. On the first iteration the <code>MyString</code> properties are updated for those instances, but on the second iteration new <code>Example</code>s are created (and do not have these changes applied obviously). I think its something you&#39;ve already said, but it makes it more explicit."}, {"owner": {"reputation": 1446, "user_id": 3825611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/543H3.jpg?s=128&g=1", "display_name": "Cory", "link": "https://stackoverflow.com/users/3825611/cory"}, "edited": false, "score": 0, "creation_date": 1534969381, "post_id": 51972882, "comment_id": 90899555, "body": "This is essentially what I&#39;m after. I&#39;m aware of the deferred execution and that by calling ToList() it will essentially force it to execute. The part I&#39;m interested in is that when it&#39;s actually called, deferred or not, I <i>expected</i> it to have a reference back to the &#39;underlying&#39; object. Thus, the first time it executes it wouldn&#39;t have one and it would evaluate the Select. Then second time I enumerated it, it would reference the same object. I.e. how List&lt;T&gt; operates."}, {"owner": {"reputation": 1446, "user_id": 3825611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/543H3.jpg?s=128&g=1", "display_name": "Cory", "link": "https://stackoverflow.com/users/3825611/cory"}, "edited": false, "score": 0, "creation_date": 1534970218, "post_id": 51972882, "comment_id": 90899961, "body": "Looking at it more, I&#39;m starting to see it. I&#39;m focused on the IEnumerable aspect.. when that&#39;s <i>potentially</i> not where the different functionality is coming from. That clone method may have sent me down the wrong rabbit hole."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": true, "score": 2, "last_activity_date": 1534963138, "last_edit_date": 1534963138, "creation_date": 1534961798, "answer_id": 51972882, "question_id": 51972590, "link": "https://stackoverflow.com/questions/51972590/ienumerable-performs-differently-on-array-vs-list/51972882#51972882", "title": "IEnumerable performs differently on Array vs List", "body": "<p>Linq works by making each function return another IEnumerable that is typically a deferred processor. No actual execution occurs until an enumeration of the finally returned Ienumerable occurs. This allows for the create of efficient pipelines.</p>\n\n<p>When you  do</p>\n\n<pre><code>var transformed = wtf.Select(s =&gt; new Example { MyString = s });\n</code></pre>\n\n<p>The select code has not actually executed yet. Only when you finally enumerate transformed will the select be done. ie here</p>\n\n<pre><code>foreach (var i in transformed)\n    i.MyString = \"somethingDifferent\";\n</code></pre>\n\n<p>Note that if you do</p>\n\n<pre><code>foreach (var i in transformed)\n    i.MyString = \"somethingDifferent\";\n</code></pre>\n\n<p>the pipeline will be executed again. Here thats is not a big deal but it can be huge if IO is involved.</p>\n\n<p>this line</p>\n\n<pre><code> var transformedList = wtf.Select(s =&gt; new Example { MyString = s }).ToList();\n</code></pre>\n\n<p>Is the same as </p>\n\n<pre><code>var transformedList = transformed.ToList();\n</code></pre>\n\n<p>The real eyeopener is to place debug statements or breakpoints inside a where or select to actually see the deferred pipeline execution</p>\n\n<p>reading the implementation of linq is useful. here is select <a href=\"https://referencesource.microsoft.com/#System.Core/System/Linq/Enumerable.cs,5c652c53e80df013,references\" rel=\"nofollow noreferrer\">https://referencesource.microsoft.com/#System.Core/System/Linq/Enumerable.cs,5c652c53e80df013,references</a></p>\n"}], "owner": {"reputation": 1446, "user_id": 3825611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/543H3.jpg?s=128&g=1", "display_name": "Cory", "link": "https://stackoverflow.com/users/3825611/cory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 51972882, "answer_count": 1, "score": 2, "last_activity_date": 1534974321, "creation_date": 1534960469, "last_edit_date": 1534974321, "question_id": 51972590, "link": "https://stackoverflow.com/questions/51972590/ienumerable-performs-differently-on-array-vs-list", "title": "IEnumerable performs differently on Array vs List", "body": "<p>This question is more of a \"is my understanding accurate\", and if not, please help me get my head around it. I have this bit of code to explain my question:</p>\n\n<pre><code>class Example\n{\n    public string MyString { get; set; }\n}\n\nvar wtf = new[] { \"string1\", \"string2\"};\nIEnumerable&lt;Example&gt; transformed = wtf.Select(s =&gt; new Example { MyString = s });\nIEnumerable&lt;Example&gt; transformedList = wtf.Select(s =&gt; new Example { MyString = s }).ToList();\n\nforeach (var i in transformed)\n    i.MyString = \"somethingDifferent\";\n\nforeach (var i in transformedList)\n    i.MyString = \"somethingDifferent\";\n\nforeach(var i in transformed)\n    Console.WriteLine(i.MyString);\n\nforeach (var i in transformedList)\n    Console.WriteLine(i.MyString);\n</code></pre>\n\n<p>It outputs:</p>\n\n<pre><code>string1\nstring2\nsomethingDifferent\nsomethingDifferent\n</code></pre>\n\n<p>Both <strong>Select()</strong> methods at first glance return <strong>IEnumerable&lt; Example></strong>. However, underlying types are <strong>WhereSelectArrayIterator&lt; string, Example></strong> and <strong>List&lt; Example ></strong>.</p>\n\n<p>This is where my sanity started to come into question. From my understanding the difference in output above is because of the way both underlying types implement the <strong>GetEnumerator()</strong> method.</p>\n\n<p>Using <a href=\"https://referencesource.microsoft.com/#system.core/System/Linq/Enumerable.cs\" rel=\"nofollow noreferrer\">this handy website</a>, I was able to (I think) track down the bit of code that was causing the difference.</p>\n\n<pre><code>class WhereSelectArrayIterator&lt;TSource, TResult&gt; : Iterator&lt;TResult&gt;\n{ }\n</code></pre>\n\n<p>Looking at that on <em>line 169</em> points me to <strong>Iterator&lt; TResult></strong>, since that's where it appears <strong>GetEnumerator()</strong> is called.</p>\n\n<p>Starting on line 90 I see:</p>\n\n<pre><code>public IEnumerator&lt;TSource&gt; GetEnumerator() {\n    if (threadId == Thread.CurrentThread.ManagedThreadId &amp;&amp; state == 0) {\n        state = 1;\n        return this;\n    }\n    Iterator&lt;TSource&gt; duplicate = Clone();\n    duplicate.state = 1;\n    return duplicate;\n}\n</code></pre>\n\n<p>What I gather from that is when you enumerate over it, you're actually enumerating over a cloned source (as written in the WhereSelectArrayIterator class' Clone() method).</p>\n\n<p>This will satisfy my need to understand for now, but as a bonus, if someone could help me figure out why <strong><em>this</em></strong> isn't returned the first time I enumerate over the data. From what I can tell, the <strong><em>state</em></strong> should = 0 the first pass. Unless, perhaps there is magic happening under the hood that is calling the same method from different threads. </p>\n\n<h2>Update</h2>\n\n<p>At this point I'm thinking my 'findings' were a bit misleading (damn Clone method taking me down the wrong rabbit hole) and it was indeed due to deferred execution. I mistakenly thought that even though I deferred execution, once it was enumerated the first time it would store those values in my variable. I should have known better; after all I was using the <em>new</em> keyword in the <em>Select</em>. That said, it still did open my eyes to the idea that a particular class' <em>GetEnumerator()</em> implementation could still return a clone which would present a very similar problem. It just so happened that my problem was different.</p>\n\n<h2>Update2</h2>\n\n<p>This is an example of what I <strong><em>thought</em></strong> my problem was. Thanks everyone for the information.</p>\n\n<pre><code>IEnumerable&lt;Example&gt; friendly = new FriendlyExamples();\nIEnumerable&lt;Example&gt; notFriendly = new MeanExamples();\n\nforeach (var example in friendly)\n    example.MyString = \"somethingDifferent\";\nforeach (var example in notFriendly)\n    example.MyString = \"somethingDifferent\";\n\nforeach (var example in friendly)\n    Console.WriteLine(example.MyString);\nforeach (var example in notFriendly)\n    Console.WriteLine(example.MyString);\n\n// somethingDifferent\n// somethingDifferent\n// string1\n// string2\n</code></pre>\n\n<p>Supporting classes:</p>\n\n<pre><code>class Example\n{\n    public string MyString { get; set; }\n    public Example(Example example)\n    {\n        MyString = example.MyString;\n    }\n    public Example(string s)\n    {\n        MyString = s;\n    }\n}\nclass FriendlyExamples : IEnumerable&lt;Example&gt;\n{\n    Example[] wtf = new[] { new Example(\"string1\"), new Example(\"string2\") };\n\n    public IEnumerator&lt;Example&gt; GetEnumerator()\n    {\n        return wtf.Cast&lt;Example&gt;().GetEnumerator();\n    }\n\n    IEnumerator IEnumerable.GetEnumerator()\n    {\n        return wtf.GetEnumerator();\n    }\n}\nclass MeanExamples : IEnumerable&lt;Example&gt;\n{\n    Example[] wtf = new[] { new Example(\"string1\"), new Example(\"string2\") };\n\n    public IEnumerator&lt;Example&gt; GetEnumerator()\n    {\n        return wtf.Select(e =&gt; new Example(e)).Cast&lt;Example&gt;().GetEnumerator();\n    }\n\n    IEnumerator IEnumerable.GetEnumerator()\n    {\n        return wtf.Select(e =&gt; new Example(e)).GetEnumerator();\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "powershell", "runspace", "scriptblock"], "comments": [{"owner": {"reputation": 234, "user_id": 3002329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cVhZE.jpg?s=128&g=1", "display_name": "RS Finance", "link": "https://stackoverflow.com/users/3002329/rs-finance"}, "edited": false, "score": 0, "creation_date": 1534960425, "post_id": 51972530, "comment_id": 90895591, "body": "Well alternatively for getting network configuration information you could use WMI queries."}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 3612502, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1727933b8cd9d5d7c0cbb1a776df14b4?s=128&d=identicon&r=PG&f=1", "display_name": "Bbb", "link": "https://stackoverflow.com/users/3612502/bbb"}, "edited": false, "score": 0, "creation_date": 1535120186, "post_id": 51973354, "comment_id": 90962660, "body": "This worked flawlessly, thank you. With my definitely overcomplicated function for this issue, I&#39;ve used it before and it worked without issue. I&#39;m not sure why I got that error?"}, {"owner": {"reputation": 14946, "user_id": 8188846, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/85a7614508b329eb4a495c59ccf64ac7?s=128&d=identicon&r=PG", "display_name": "Maximilian Burszley", "link": "https://stackoverflow.com/users/8188846/maximilian-burszley"}, "reply_to_user": {"reputation": 433, "user_id": 3612502, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1727933b8cd9d5d7c0cbb1a776df14b4?s=128&d=identicon&r=PG&f=1", "display_name": "Bbb", "link": "https://stackoverflow.com/users/3612502/bbb"}, "edited": false, "score": 1, "creation_date": 1535120485, "post_id": 51973354, "comment_id": 90962842, "body": "<code>Tuple&lt;string, string&gt;</code> your string compare with <code>scriptblock</code> is failing so it was being passed as a string instead of creating the correct type. @Jay"}], "tags": [], "owner": {"reputation": 14946, "user_id": 8188846, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/85a7614508b329eb4a495c59ccf64ac7?s=128&d=identicon&r=PG", "display_name": "Maximilian Burszley", "link": "https://stackoverflow.com/users/8188846/maximilian-burszley"}, "is_accepted": true, "score": 4, "last_activity_date": 1534963722, "creation_date": 1534963722, "answer_id": 51973354, "question_id": 51972530, "link": "https://stackoverflow.com/questions/51972530/how-to-use-powershell-invoke-command-within-c/51973354#51973354", "title": "How to use powershell invoke-command within C#?", "body": "<p>I feel like you've super over-complicated this:</p>\n\n<pre><code>using (PowerShell ps = PowerShell.Create())\n{\n    ps.AddScript($@\"Invoke-Command -ComputerName {name} -ScriptBlock {{ipconfig &gt; C:\\ipconfig.txt}}\")\n    ps.Invoke()\n}\n</code></pre>\n\n<p>Alternatively you can chain <code>.AddCommand().AddParameter()</code></p>\n"}], "owner": {"reputation": 433, "user_id": 3612502, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1727933b8cd9d5d7c0cbb1a776df14b4?s=128&d=identicon&r=PG&f=1", "display_name": "Bbb", "link": "https://stackoverflow.com/users/3612502/bbb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "accepted_answer_id": 51973354, "answer_count": 1, "score": 0, "last_activity_date": 1534963722, "creation_date": 1534960195, "question_id": 51972530, "link": "https://stackoverflow.com/questions/51972530/how-to-use-powershell-invoke-command-within-c", "title": "How to use powershell invoke-command within C#?", "body": "<p>If I run the below command inside of Powershell, it works as expected</p>\n\n<p><code>invoke-command -computername [name] -scriptblock { ipconfig.exe &gt; c:\\ipconfig.txt }</code></p>\n\n<p>But when I try to incorporate this into a c# function, I'm getting this error</p>\n\n<blockquote>\n  <p>{\"Cannot bind parameter 'ScriptBlock'. Cannot convert the\n  \\\"ipconfig.exe > c:\\ipconfig.txt\\\" value of type \\\"System.String\\\" to\n  type \\\"System.Management.Automation.ScriptBlock\\\".\"}</p>\n</blockquote>\n\n<p>even though I'm converting the scriptblock parameter value to a System.Management.Automation.ScriptBlock object? What am I doing incorrect?</p>\n\n<pre><code>    private void btnInstallTest_Click(object sender, EventArgs e)\n    {\n        List&lt;string&gt; commands = new List&lt;string&gt;();\n\n        commands.Add(\"invoke-command\");\n        List&lt;Tuple&lt;String, String&gt;&gt; parameters = new List&lt;Tuple&lt;string, string&gt;&gt;();\n        parameters.Add(new Tuple&lt;string, string&gt;(\"computername\", @\"server\"));\n        parameters.Add(new Tuple&lt;string, string&gt;(\"ScriptBlock\", @\"ipconfig.exe &gt; c:\\ipconfig.txt\"));\n\n        Collection&lt;PSObject&gt; psobject = runRemotePowerShellCommands(commands, parameters, \"server\", @\"domain\\user\", convertToSecureString(\"password\"));          \n    }\n\n    private Collection&lt;PSObject&gt; runRemotePowerShellCommands(List&lt;string&gt; commands, List&lt;Tuple&lt;String, String&gt;&gt; parameters, string remoteMachineName, string domainAndUsername, SecureString securePW)\n    {\n        Collection&lt;PSObject&gt; psobjs = new Collection&lt;PSObject&gt;();\n        string result = \"\";\n        string shellUri = \"http://schemas.microsoft.com/powershell/Microsoft.PowerShell\";\n        PSCredential psCredential = new PSCredential(domainAndUsername, securePW);\n        WSManConnectionInfo connectionInfo = new WSManConnectionInfo(false, remoteMachineName, 5985, \"/wsman\", shellUri, psCredential);\n        connectionInfo.AuthenticationMechanism = AuthenticationMechanism.Kerberos; //.Basic;\n\n        using (Runspace runspace = RunspaceFactory.CreateRunspace(connectionInfo))\n        {\n            PowerShell powershell = PowerShell.Create();\n            for (int i = 0; i &lt; commands.Count; i++)\n            {\n                if (commands[i].Contains(\";\"))\n                {\n\n                    string[] commandsSplit = commands[i].Split(';');\n                }\n                else\n                {\n                    powershell.AddCommand(commands[i]);\n                }\n\n                System.Management.Automation.ScriptBlock sb = null;\n                if (parameters != null)\n                {\n                    foreach (Tuple&lt;string, string&gt; param in parameters)\n                    {\n                        if (param.Item1.ToLower() == \"scriptblock\")\n                        {\n                            sb = ScriptBlock.Create(param.Item2);                                \n                            powershell.AddParameter(param.Item1, sb);\n                            //powershell.AddParameter(param.Item1, param.Item2);\n                        }\n                        else\n                        {\n                            powershell.AddParameter(param.Item1, param.Item2);\n                        }\n                    }\n                }\n\n                if (runspace.RunspaceStateInfo.State == RunspaceState.Opened)\n                {\n                    // do nothing, the runspace is already open\n                }\n                else\n                {\n                    runspace.Open();                        \n                    powershell.Runspace = runspace;\n                }\n\n                try\n                {\n                    psobjs = powershell.Invoke();\n\n                    if (powershell.HadErrors == true)\n                    {\n                        result = \"Failed - \" + powershell.Streams.Error[0].ToString();\n                        result = result.Replace(\"\\\"\", \"*\");\n                        psobjs.Add(result);\n                    }\n                }\n                catch (Exception ex)\n                {\n                    result = \"Failed: \" + ex.Message;\n                    psobjs.Add(result);\n                }\n            }\n\n            powershell.Commands.Clear();                \n        }\n\n        return psobjs;\n    }\n</code></pre>\n"}, {"tags": ["c#", "unity3d", "midi", "vst"], "comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 1, "creation_date": 1534960548, "post_id": 51972330, "comment_id": 90895661, "body": "First thing to do is create non Unity project and see if that piece of code works. If it works, show us how you installed the SDK in Unity. Screenshots are even better"}, {"owner": {"reputation": 23, "user_id": 252578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3ed1ebbf277a23f9e8d8d4be91b808?s=128&d=identicon&r=PG", "display_name": "spobin", "link": "https://stackoverflow.com/users/252578/spobin"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1534977278, "post_id": 51972330, "comment_id": 90902463, "body": "@Programmer - I&#39;ve just put together a small c# console app which returns OutputDevice.DeviceCount as 1 with loopMIDI running, indicating that it&#39;s not working correctly. It seems that no matter how many virtual midi ports I create, none are working as expected. At the moment I don&#39;t think that loopMidi is doing its job..."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 1, "creation_date": 1534984075, "post_id": 51972330, "comment_id": 90903742, "body": "Well, there you go. don&#39;t waste your time with it in Unity if it can&#39;t even work in a non Unity environment. I suggest you comment on the project&#39; codeproject page. Maybe the author can help you"}, {"owner": {"reputation": 2320, "user_id": 178897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/WUaNU.jpg?s=128&g=1", "display_name": "obiwanjacobi", "link": "https://stackoverflow.com/users/178897/obiwanjacobi"}, "edited": false, "score": 1, "creation_date": 1535001369, "post_id": 51972330, "comment_id": 90907116, "body": "You could also try using MIDI.NET <a href=\"https://github.com/obiwanjacobi/midi.net\" rel=\"nofollow noreferrer\">github.com/obiwanjacobi/midi.net</a> (Windows only)"}], "owner": {"reputation": 23, "user_id": 252578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f3ed1ebbf277a23f9e8d8d4be91b808?s=128&d=identicon&r=PG", "display_name": "spobin", "link": "https://stackoverflow.com/users/252578/spobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 773, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1534959360, "creation_date": 1534959360, "question_id": 51972330, "link": "https://stackoverflow.com/questions/51972330/how-to-send-midi-from-unity-to-external-vst", "title": "How to send MIDI from Unity to external VST", "body": "<p>Following on from <a href=\"https://stackoverflow.com/questions/50437265/using-vst-net-with-unity3d-to-create-a-simple-vst-host\">my failed attempt to run a VST instrument from inside Unity</a>, my new approach is to send midi messages from Unity to an external host.</p>\n\n<p>To achieve this I've been trying to follow <a href=\"https://forum.image-line.com/viewtopic.php?t=155550\" rel=\"nofollow noreferrer\">this approach</a>:</p>\n\n<ol>\n<li>Install loopMIDI (<a href=\"http://www.tobias-erichsen.de/software/loopmidi.html\" rel=\"nofollow noreferrer\">http://www.tobias-erichsen.de/software/loopmidi.html</a>)</li>\n<li>Create a virtual MIDI port within loopMIDI</li>\n<li>Download the Sanford C# MIDI Toolkit <a href=\"http://www.codeproject.com/Articles/6228/C-MIDI-Toolkit\" rel=\"nofollow noreferrer\">http://www.codeproject.com/Articles/6228/C-MIDI-Toolkit</a></li>\n<li>Add a Reference to the MIDI Toolkit in your project</li>\n<li><p>Write some code i.e.:</p>\n\n<pre><code>private OutputDevice outDevice = null;\n\nprivate void MIDITest()\n{\n    int devices = OutputDevice.DeviceCount;\n\n    if (devices == 0)\n    {\n        MessageBox.Show(\"No MIDI output devices available.\", \"Warning!\", MessageBoxButtons.OK, MessageBoxIcon.Warning);\n        return;\n    }\n\n    if (outDevice != null)\n    {\n        outDevice.Close();\n    }\n\n    outDevice = new OutputDevice(0);    // Change this for other MIDI devices\n    outDevice.Error += inDevice_Error;\n    outDevice.Reset();\n\n    // Send a Note On\n    ChannelMessage cm = new ChannelMessage(ChannelCommand.NoteOn, 0, 60, 127);\n    outDevice.Send(cm);\n}\n</code></pre></li>\n</ol>\n\n<p>I've managed to do all of these steps, however, I'm still not able to detect any midi messages coming out from Unity. I've tried installing <a href=\"http://www.midiox.com/\" rel=\"nofollow noreferrer\">Midi Ox</a> to monitor the midi signals but it doesn't seem to be showing my virtual midi port and there seems to be no midi activity, despite all of my Unity code running fine. The Unity game is actually playing the midi file I have loaded, so I know my Unity code is running correctly, I just can't seem to get the virtual midi port configured correctly.</p>\n\n<p>Does anyone know what I might be doing wrong? Thanks! </p>\n"}, {"tags": ["c#", "asp.net-core"], "comments": [{"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "edited": false, "score": 2, "creation_date": 1534959797, "post_id": 51972320, "comment_id": 90895283, "body": "put a breakpoint in your if(!ModelState.IsValid), and make sure it&#39;s not just returning the model that is sent in. *edit - I just saw the &quot;However&quot; - so it&#39;s probably not the case. Is the page reloading?"}], "answers": [{"comments": [{"owner": {"reputation": 850, "user_id": 3695641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8dfd27ce59f535568415a95374b28e21?s=128&d=identicon&r=PG&f=1", "display_name": "DespeiL", "link": "https://stackoverflow.com/users/3695641/despeil"}, "edited": false, "score": 0, "creation_date": 1534962520, "post_id": 51972618, "comment_id": 90896516, "body": "And what about ajax requests  when after ajax submit we want to get clear form or sometimes form with calculated values ?"}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "reply_to_user": {"reputation": 850, "user_id": 3695641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8dfd27ce59f535568415a95374b28e21?s=128&d=identicon&r=PG&f=1", "display_name": "DespeiL", "link": "https://stackoverflow.com/users/3695641/despeil"}, "edited": false, "score": 1, "creation_date": 1534962998, "post_id": 51972618, "comment_id": 90896714, "body": "That has nothing to do with any of this. If you&#39;re doing a submit via AJAX, the server is no longer involved in actually determine how the fields are rendered or with what values. If you need to clear the form, you&#39;d do what you&#39;d always do in any situation and literally clear the form via JavaScript, i.e. set the values of each input element to blank, call <code>form.reset()</code>, update the values on your client-side model in a two-way data-binding setup, etc. However, this all occurs client-side."}, {"owner": {"reputation": 850, "user_id": 3695641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8dfd27ce59f535568415a95374b28e21?s=128&d=identicon&r=PG&f=1", "display_name": "DespeiL", "link": "https://stackoverflow.com/users/3695641/despeil"}, "edited": false, "score": 0, "creation_date": 1539099495, "post_id": 51972618, "comment_id": 92374702, "body": "Thanks for theoretical knowledge but i finally found solutions that i was looking for and answer to my question by myself"}], "tags": [], "owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "is_accepted": false, "score": 2, "last_activity_date": 1534960658, "creation_date": 1534960658, "answer_id": 51972618, "question_id": 51972320, "link": "https://stackoverflow.com/questions/51972320/asp-net-core-2-1-model-binding-after-submit/51972618#51972618", "title": "asp.net core 2.1 model binding (after submit)", "body": "<p>The values displayed in the view come from <code>ModelState</code>, not the model. <code>ModelState</code> is composed of values from <code>Request</code>, <code>ViewData</code>/<code>ViewBag</code>, and <em>finally</em> <code>Model</code>. Since you've already posted, that means there's now a value for <code>Name</code> in <code>Request</code>, which will then take precedence over anything you set on your model.</p>\n\n<p>While there's some hacky ways around this, the most appropriate path is to follow the PRG (Post-Redirect-Get) pattern. Essentially, after posting, you only return the view again if there's validation errors (in which case, you <em>want</em> the posted values to be redisplayed, so the user can make necessary corrections). Otherwise, you redirect - even if you redirect to the same action. The sheer act of redirection causes a new GET request to be issued, and has the effect of resetting the page as if it's the first load - where the values in your model <em>will</em> apply.</p>\n"}, {"comments": [{"owner": {"reputation": 850, "user_id": 3695641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8dfd27ce59f535568415a95374b28e21?s=128&d=identicon&r=PG&f=1", "display_name": "DespeiL", "link": "https://stackoverflow.com/users/3695641/despeil"}, "edited": false, "score": 0, "creation_date": 1539099298, "post_id": 51972994, "comment_id": 92374608, "body": "Thanks for your solution , it work&#39;s fine but i finalny found solution that i was looking for .Please look into my answer."}], "tags": [], "owner": {"reputation": 106152, "user_id": 1108891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zUoEd.jpg?s=128&g=1", "display_name": "Shaun Luttin", "link": "https://stackoverflow.com/users/1108891/shaun-luttin"}, "is_accepted": false, "score": 2, "last_activity_date": 1534962799, "last_edit_date": 1534962799, "creation_date": 1534962241, "answer_id": 51972994, "question_id": 51972320, "link": "https://stackoverflow.com/questions/51972320/asp-net-core-2-1-model-binding-after-submit/51972994#51972994", "title": "asp.net core 2.1 model binding (after submit)", "body": "<p>As Chris Pratt suggests, the Post-Redirect-Get pattern is appropriate. </p>\n\n<p>Here is one way to achieve that (with a simplified version of your code). Store the updated model in <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/app-state?view=aspnetcore-2.1#tempdata\" rel=\"nofollow noreferrer\"><code>TempData</code></a> before calling <code>RedirectToAction</code>. </p>\n\n<pre><code>// using Newtonsoft.Json;\n\npublic IActionResult Contacts()\n{\n    var model = new EmailModel { Name = \"Test\" };\n\n    if (TempData[nameof(EmailModel)] is string json)\n    {\n        model = JsonConvert.DeserializeObject&lt;EmailModel&gt;(json);\n    }\n\n    return View(model);\n}\n\n[HttpPost]\npublic IActionResult Contacts(EmailModel model)\n{\n    model.Name = \"After submit name\";\n    TempData[nameof(EmailModel)] = JsonConvert.SerializeObject(model);\n\n    return RedirectToAction(\"Contacts\");\n}\n</code></pre>\n\n<p>Since <code>TempData</code> stores data only until it's read, it is particularly appropriate for redirection.</p>\n"}, {"comments": [{"owner": {"reputation": 106152, "user_id": 1108891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zUoEd.jpg?s=128&g=1", "display_name": "Shaun Luttin", "link": "https://stackoverflow.com/users/1108891/shaun-luttin"}, "edited": false, "score": 1, "creation_date": 1539102143, "post_id": 52724608, "comment_id": 92376080, "body": "Neat alternative to the Post-Redirect-Get pattern. You will still need to watch out for a form re-submission if the user refreshes the page."}, {"owner": {"reputation": 850, "user_id": 3695641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8dfd27ce59f535568415a95374b28e21?s=128&d=identicon&r=PG&f=1", "display_name": "DespeiL", "link": "https://stackoverflow.com/users/3695641/despeil"}, "reply_to_user": {"reputation": 106152, "user_id": 1108891, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zUoEd.jpg?s=128&g=1", "display_name": "Shaun Luttin", "link": "https://stackoverflow.com/users/1108891/shaun-luttin"}, "edited": false, "score": 0, "creation_date": 1539105286, "post_id": 52724608, "comment_id": 92377559, "body": "In first  option YES this is just example , in second NO because partial  is replaced by ajax.  In my case I &#39;m using ajax submite solution"}], "tags": [], "owner": {"reputation": 850, "user_id": 3695641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8dfd27ce59f535568415a95374b28e21?s=128&d=identicon&r=PG&f=1", "display_name": "DespeiL", "link": "https://stackoverflow.com/users/3695641/despeil"}, "is_accepted": true, "score": 2, "last_activity_date": 1539105367, "last_edit_date": 1539105367, "creation_date": 1539099191, "answer_id": 52724608, "question_id": 51972320, "link": "https://stackoverflow.com/questions/51972320/asp-net-core-2-1-model-binding-after-submit/52724608#52724608", "title": "asp.net core 2.1 model binding (after submit)", "body": "<p>Finaly found what I was looking for . The solution is to use <code>ModelState.Clear();</code></p>\n\n<p><strong>1)</strong></p>\n\n<pre><code>[HttpPost]\npublic IActionResult Contacts(EmailModel model)\n{\n    if(!ModelState.IsValid)\n    {\n        return View(\"Contacts\", model);\n    }\n   ///some code\n   ModelState.Clear();\n    return View(\"Contacts\", new EmailModel() );\n}\n</code></pre>\n\n<p>And If we need to replace only partial view ( for example ajax request):</p>\n\n<p><strong>2)</strong></p>\n\n<pre><code>[HttpPost]\npublic IActionResult Contacts(EmailModel model)\n{\n    if(!ModelState.IsValid)\n    {\n        return PartialView(\"Contacts\", model);\n    }\n   ///some code\n   ModelState.Clear();\n    return PartialView(\"Contacts\", new EmailModel() );\n}\n</code></pre>\n\n<p>Sorce: <a href=\"https://stackoverflow.com/questions/10855021/clear-fields-after-success\">Clear fields after success</a></p>\n"}], "owner": {"reputation": 850, "user_id": 3695641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8dfd27ce59f535568415a95374b28e21?s=128&d=identicon&r=PG&f=1", "display_name": "DespeiL", "link": "https://stackoverflow.com/users/3695641/despeil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 2, "accepted_answer_id": 52724608, "answer_count": 3, "score": 1, "last_activity_date": 1539105367, "creation_date": 1534959313, "last_edit_date": 1534959556, "question_id": 51972320, "link": "https://stackoverflow.com/questions/51972320/asp-net-core-2-1-model-binding-after-submit", "title": "asp.net core 2.1 model binding (after submit)", "body": "<p>I have experience with asp.net but  I'm new in .net core so when I tried to perform the simple submit task I got the strange behavior.\nWhen I'm opening the view and sending some model to it  the binding works fine but after i submit this form and try to return empty model or change the value of the passed model binding not working....it keep the value that was submitted.</p>\n\n<p>View</p>\n\n<pre><code> @model EmailModel\n\n\n    &lt;div class=\"w3-col m6 w3-panel\"&gt;\n        &lt;div class=\"w3-large w3-margin-bottom\"&gt;\n            &lt;i class=\"fa fa-map-marker fa-fw w3-hover-text-black w3-xlarge w3-margin-right\"&gt;&lt;/i&gt; Rzemie\u015blnicza 26, 30-403 Krak\u00f3w, POL&lt;br&gt;\n            &lt;i class=\"fa fa-phone fa-fw w3-hover-text-black w3-xlarge w3-margin-right\"&gt;&lt;/i&gt; Telefon: 667 071 064&lt;br&gt;\n            &lt;i class=\"fa fa-envelope fa-fw w3-hover-text-black w3-xlarge w3-margin-right\"&gt;&lt;/i&gt; Email: mail@mail.com&lt;br&gt;\n        &lt;/div&gt;\n        &lt;p&gt;Je\u017celi masz jakie\u015b pytania, zastrze\u017cenia lub w\u0105tpliwo\u015bci napisz do nas&lt;/p&gt;\n        &lt;p&gt;  &lt;span asp-validation-for=\"Name\" class=\"text-danger\"&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p&gt;  &lt;span asp-validation-for=\"EmailTo\" class=\"text-danger\"&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p&gt;  &lt;span asp-validation-for=\"Phone\" class=\"text-danger\"&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p&gt;  &lt;span asp-validation-for=\"Subject\" class=\"text-danger\"&gt;&lt;/span&gt;&lt;/p&gt;\n        &lt;p&gt;  &lt;span asp-validation-for=\"Text\" class=\"text-danger\"&gt;&lt;/span&gt;&lt;/p&gt;\n        @using (@Html.BeginForm(\"Contacts\", \"Home\", FormMethod.Post))\n        {\n\n            &lt;div class=\"w3-row-padding\" style=\"margin:0 -16px 8px -16px\"&gt;\n                &lt;div class=\"w3-third\"&gt;\n\n                    &lt;input asp-for=\"Name\" class=\"w3-input w3-border\" type=\"text\" placeholder=\"Imi\u0119 i Nazwisko\" required&gt;\n                &lt;/div&gt;\n                &lt;div class=\"w3-third\"&gt;\n\n                    &lt;input asp-for=\"EmailTo\" class=\"w3-input w3-border\" placeholder=\"Email\" required /&gt;\n\n                &lt;/div&gt;\n                &lt;div class=\"w3-third\"&gt;\n\n                    &lt;input asp-for=\"Phone\" class=\"w3-input w3-border\" type=\"tel\" placeholder=\"Telefon\" required /&gt;\n\n                &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div style=\"width:100%\"&gt;\n\n                &lt;input asp-for=\"Subject\" class=\"w3-input w3-border\" type=\"text\" placeholder=\"Temat wiadomo\u015bci\" required&gt;\n\n            &lt;/div&gt;\n\n            &lt;textarea asp-for=\"Text\" class=\"w3-input w3-border\" type=\"text\" placeholder=\"Temat wiadomo\u015bci\" required rows=\"6\"&gt;&lt;/textarea&gt;\n\n            &lt;button class=\"w3-button w3-black w3-right w3-section\" type=\"submit\"&gt;\n                &lt;i class=\"fa fa-paper-plane\"&gt;&lt;/i&gt; Wy\u015blij wiadomo\u015b\u0107\n            &lt;/button&gt;\n        }\n\n&lt;/div&gt;\n</code></pre>\n\n<p>Model</p>\n\n<pre><code>public class EmailModel\n{\n    [Required]\n    [EmailAddress]\n    public string EmailTo { get; set; }\n    [Required]\n    public string Name { get; set; }\n    public string Surname { get; set; }\n    [Required]\n    [Phone]\n    public string Phone { get; set; }\n    [Required]\n    public string Subject { get; set; }\n    [Required]\n    public string Text { get; set; }\n}\n</code></pre>\n\n<p>Actions</p>\n\n<pre><code>   public IActionResult Contacts()\n    {\n        ViewData[\"Title\"] = _translation[\"Contacts\"];\n\n        return View(new EmailModel() { Name = \"Test\" });\n    }\n    [HttpPost]\n    public IActionResult Contacts(EmailModel model)\n    {\n        if(!ModelState.IsValid)\n        {\n            return View(\"Contacts\", model);\n        }\n        try\n        {\n            string mailBodyhtml = \"Imi\u0119 i Nazwisko: \" + model.Name + \"&lt;br&gt;\" + \"Telefon: \" + model.Phone + \"&lt;br&gt;\" + \"Email: \" + model.EmailTo + \"&lt;br&gt;&lt;br&gt;\" + model.Text;\n            var msg = new MailMessage(\"******\", \"******\", \"ZD -\"+ model.Subject, mailBodyhtml);\n            msg.IsBodyHtml = true;\n            var smtpClient = new SmtpClient(\"******\", 587); //if your from email address is \"from@hotmail.com\" then host should be \"smtp.hotmail.com\"\n            smtpClient.UseDefaultCredentials = true;\n            smtpClient.Credentials = new NetworkCredential(\"***\", \"*****\"); \n            smtpClient.EnableSsl = true;\n            smtpClient.Send(msg);\n            Console.WriteLine(\"Email Sended Successfully\");\n        }\n        catch (Exception ex)\n        {\n            Console.Write(ex.ToString());\n        }\n        model.Name = \"After submit name\";\n\n        return View(\"Contacts\" ,model);\n    }\n</code></pre>\n\n<ol>\n<li>On first view load <code>Name =\"Test\"</code></li>\n<li>On before submit <code>Name =\"My submit name\"</code></li>\n<li>After submit  should be  <code>Name = \"After submit name\"</code> but it's s<code>till =\"My submit name\"</code></li>\n</ol>\n\n<p>However after submit in the debug  <code>Model.Name =\"After submit name\"</code></p>\n"}, {"tags": ["c#", "asp.net", ".net", "web-services", "wcf"], "comments": [{"owner": {"reputation": 723, "user_id": 5395603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Bz7Mx.png?s=128&g=1", "display_name": "wctiger", "link": "https://stackoverflow.com/users/5395603/wctiger"}, "edited": false, "score": 0, "creation_date": 1534959274, "post_id": 51972232, "comment_id": 90895057, "body": "If I understand correctly you are trying to find where the Session is being set. Have you tried just search with that session name?"}, {"owner": {"reputation": 45, "user_id": 7383190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abfd52cbdee7ab5ed14fb3b57066e145?s=128&d=identicon&r=PG&f=1", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/7383190/pradeep"}, "reply_to_user": {"reputation": 723, "user_id": 5395603, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/Bz7Mx.png?s=128&g=1", "display_name": "wctiger", "link": "https://stackoverflow.com/users/5395603/wctiger"}, "edited": false, "score": 0, "creation_date": 1534959612, "post_id": 51972232, "comment_id": 90895207, "body": "@wctiger : yes , i tried, it has been used at many places but unable to get the source of it or from which application it&#39;s value is coming from."}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1534963921, "post_id": 51972232, "comment_id": 90897139, "body": "You&#39;ve done a &quot;Find All References&quot; on <code>CurrentSession</code> ?"}], "owner": {"reputation": 45, "user_id": 7383190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abfd52cbdee7ab5ed14fb3b57066e145?s=128&d=identicon&r=PG&f=1", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/7383190/pradeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534962280, "creation_date": 1534958947, "last_edit_date": 1534962280, "question_id": 51972232, "link": "https://stackoverflow.com/questions/51972232/unable-to-get-the-source-page-of-session-value", "title": "unable to get the source page of Session value", "body": "<p>I know it's a question that everybody shall think to be silly. But i researched on net a lot but not getting it.\nI am not able to get the source page of session value. Only I can see the source as  in the current web application as below. We are also using web services and wcf services to communicate with other applications. what more could i find to get the session source page where its value is being set.</p>\n\n<pre><code>public SessionData CurrentSession\n        {\n            get { return Session[\"xyz\"] as SessionData; }\n            set { Session[\"xyz\"] = value; }\n        }\n</code></pre>\n"}, {"tags": ["c#", ".net", ".net-core", "dapper"], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 8973136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192c7c71548a427a945a4d92f9b7a805?s=128&d=identicon&r=PG&f=1", "display_name": "ThejaSingireddy", "link": "https://stackoverflow.com/users/8973136/thejasingireddy"}, "edited": false, "score": 0, "creation_date": 1534961130, "post_id": 51972301, "comment_id": 90895893, "body": "Is there any way to return List&lt;IDictionary&lt;string, string&gt;&gt;?"}, {"owner": {"reputation": 999, "user_id": 6427909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd38e8f0df24e4302b6a0543e404bd?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek", "link": "https://stackoverflow.com/users/6427909/tarek"}, "reply_to_user": {"reputation": 126, "user_id": 8973136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192c7c71548a427a945a4d92f9b7a805?s=128&d=identicon&r=PG&f=1", "display_name": "ThejaSingireddy", "link": "https://stackoverflow.com/users/8973136/thejasingireddy"}, "edited": false, "score": 0, "creation_date": 1534963447, "post_id": 51972301, "comment_id": 90896912, "body": "I don&#39;t think that has the desired effect you want, not every item in the dictionary is going to be a string, it could be bool, int, double, etc... you could try to do something like result.Select(x =&gt; ((IDictionary&lt;string, object&gt;)x).ToDictionary(ks =&gt; ks.Key, vs =&gt; vs.ToString())).ToList(); but that&#39;s really awful. You can always strongly type the result returned from dapper as well, so instead of connection.Query(query, parameters).ToList(), you would write connection.Query&lt;TYOURTYPE&gt;(query, parameters).ToList()"}], "tags": [], "owner": {"reputation": 999, "user_id": 6427909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd38e8f0df24e4302b6a0543e404bd?s=128&d=identicon&r=PG&f=1", "display_name": "Tarek", "link": "https://stackoverflow.com/users/6427909/tarek"}, "is_accepted": true, "score": 3, "last_activity_date": 1534963788, "last_edit_date": 1534963788, "creation_date": 1534959252, "answer_id": 51972301, "question_id": 51972188, "link": "https://stackoverflow.com/questions/51972188/how-to-convert-dapperrow-to-dictionarystring-string/51972301#51972301", "title": "How to convert DapperRow to Dictionary&lt;string,string&gt;", "body": "<p>Assuming that you are connecting to an SQL database</p>\n\n<pre><code>    public List&lt;IDictionary&lt;string, object&gt;&gt; DapperSelect(string connectionString, string query, object parameters)\n    {\n        using (var connection = new SqlConnection(connectionString))\n        {\n            var result = connection.Query(query, parameters).ToList();\n\n            return result.Select(x =&gt; (IDictionary&lt;string, object&gt;)x).ToList();\n        }\n    }\n</code></pre>\n\n<p>I don't think that you should be converting your result to <code>IDictionary&lt;string, string&gt;</code> I don't think that has the desired effect you want, not every item in the dictionary is going to be a string, it could be bool, int, double, etc...</p>\n\n<p>But if you insist, You could try to do something like </p>\n\n<p><code>result.Select(x =&gt; ((IDictionary&lt;string, object&gt;)x).ToDictionary(ks =&gt; ks.Key, vs =&gt; vs.ToString())).ToList();</code> </p>\n\n<p>but I don't recommend it.</p>\n\n<p>Better than all of that is that with dapper you can always strongly type the result returned from SQL, so instead of </p>\n\n<p><code>connection.Query(query, parameters).ToList();</code> </p>\n\n<p>you would write </p>\n\n<p><code>connection.Query&lt;YOURTYPE&gt;(query, parameters).ToList();</code></p>\n"}, {"tags": [], "owner": {"reputation": 3616, "user_id": 1981471, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/i44eN.jpg?s=128&g=1", "display_name": "RandomUs1r", "link": "https://stackoverflow.com/users/1981471/randomus1r"}, "is_accepted": false, "score": 1, "last_activity_date": 1534963989, "creation_date": 1534963989, "answer_id": 51973408, "question_id": 51972188, "link": "https://stackoverflow.com/questions/51972188/how-to-convert-dapperrow-to-dictionarystring-string/51973408#51973408", "title": "How to convert DapperRow to Dictionary&lt;string,string&gt;", "body": "<p>Something like this:</p>\n\n<pre><code>var foo = db.Query(\n                        \"MySp\",\n                        new { parameters },\n                        commandType: CommandType.StoredProcedure)\n                    .ToDictionary(\n                        row =&gt; (int) row.Id,\n                        row =&gt; (string) row.Name);\n</code></pre>\n\n<p>With row. being the names of the columns and foo being of type Dictionary .</p>\n"}], "owner": {"reputation": 126, "user_id": 8973136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192c7c71548a427a945a4d92f9b7a805?s=128&d=identicon&r=PG&f=1", "display_name": "ThejaSingireddy", "link": "https://stackoverflow.com/users/8973136/thejasingireddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8089, "favorite_count": 1, "accepted_answer_id": 51972301, "answer_count": 2, "score": 3, "last_activity_date": 1584368379, "creation_date": 1534958763, "last_edit_date": 1584368379, "question_id": 51972188, "link": "https://stackoverflow.com/questions/51972188/how-to-convert-dapperrow-to-dictionarystring-string", "title": "How to convert DapperRow to Dictionary&lt;string,string&gt;", "body": "<p>I've a method that returns IEnumerable with Dapper Row.\n<a href=\"https://i.stack.imgur.com/Ymdfb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ymdfb.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But I'm trying to access the data without typecasting it to a particular class and I'm getting null value.\n<a href=\"https://i.stack.imgur.com/auaax.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/auaax.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "linq", "asp.net-core", "entity-framework-core", "asp.net-core-2.1"], "comments": [{"owner": {"reputation": 2516, "user_id": 5011484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed5ec218d91ad9bba4e00f06f99c5b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mittal Patel", "link": "https://stackoverflow.com/users/5011484/mittal-patel"}, "edited": false, "score": 1, "creation_date": 1534958541, "post_id": 51972103, "comment_id": 90894729, "body": "Can you please share your LINQ Query and error?"}, {"owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "edited": false, "score": 1, "creation_date": 1534958687, "post_id": 51972103, "comment_id": 90894785, "body": "Does your ICollections have a name?"}, {"owner": {"reputation": 121, "user_id": 2624044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b5774b3032f323b08e7d934e460d6e?s=128&d=identicon&r=PG", "display_name": "el_M", "link": "https://stackoverflow.com/users/2624044/el-m"}, "edited": false, "score": 0, "creation_date": 1534959182, "post_id": 51972103, "comment_id": 90895009, "body": "Sorry i typed in the classes wrong by mistake. I have updated my question"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 2624044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b5774b3032f323b08e7d934e460d6e?s=128&d=identicon&r=PG", "display_name": "el_M", "link": "https://stackoverflow.com/users/2624044/el-m"}, "edited": false, "score": 0, "creation_date": 1534966856, "post_id": 51973033, "comment_id": 90898473, "body": "Thank you for the answer and the in depth explanation. Works perfectly"}], "tags": [], "owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "is_accepted": true, "score": 3, "last_activity_date": 1534963893, "last_edit_date": 1534963893, "creation_date": 1534962439, "answer_id": 51973033, "question_id": 51972103, "link": "https://stackoverflow.com/questions/51972103/use-where-clause-on-navigation-property-many-to-many-relationship/51973033#51973033", "title": "Use Where Clause on navigation property. Many-to-many relationship", "body": "<p>First, the lambda passed to <code>Include</code> must be a model expression. Specifically, that means you cannot use something like <code>Select</code>. If you're trying to include <code>EventCategories.Category</code>, then you should actually do:</p>\n\n<pre><code>.Include(e =&gt; e.EventCategories).ThenInclude(ms =&gt; ms.Category)\n</code></pre>\n\n<p>That will fix your immediate error. The next issue is that the way in which you're attempting to query the category ID is incorrect. The lamdas don't carry over from one clause to the next. In other words, when you're doing <code>Where(e =&gt; e.ID == 1)</code>, <code>e</code> is <code>Event</code>, not <code>Category</code>. The fact that you just included <code>Category</code> doesn't limit the where clause to that context. Therefore, what you actually need is:</p>\n\n<pre><code>.Where(e =&gt; e.EventCategories.Any(c =&gt; c.CategoryID == 1))\n</code></pre>\n\n<p>For what it's worth, you could also write that as:</p>\n\n<pre><code>.Where(e =&gt; e.EventCategories.Any(c =&gt; c.Category.ID == 1))\n</code></pre>\n\n<p>Notice the <code>.</code> between <code>Category</code> and <code>ID</code>. Now this where clause requires joins to be made between all of <code>Event</code>, <code>EventCategories</code>, <em>and</em> <code>Category</code>, which then means you don't actually need your <code>Include(...).ThenInclude(...)</code> statement, since all this does is tell EF to make the same JOINs it's already making. I will still usually do the includes explicitly, though, as otherwise, if your where clause were to change in some future iteration, you may end up no longer implicitly including everything you actually want included. Just food for thought.</p>\n"}], "owner": {"reputation": 121, "user_id": 2624044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b5774b3032f323b08e7d934e460d6e?s=128&d=identicon&r=PG", "display_name": "el_M", "link": "https://stackoverflow.com/users/2624044/el-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 51973033, "answer_count": 1, "score": 0, "last_activity_date": 1534963893, "creation_date": 1534958375, "last_edit_date": 1534959833, "question_id": 51972103, "link": "https://stackoverflow.com/questions/51972103/use-where-clause-on-navigation-property-many-to-many-relationship", "title": "Use Where Clause on navigation property. Many-to-many relationship", "body": "<p>I have been looking through other examples on SO and I am still unable to resolve this.</p>\n\n<p>I have the following model structure</p>\n\n<pre><code> public class Event\n    {\n        [Key]\n        public int ID { get; set; }\n        public ICollection&lt;EventCategory&gt; EventCategories{ get; set; }\n    }\n\n public class Category\n    {\n        [Key]\n        public int ID { get; set; }\n        public ICollection&lt;EventCategory&gt; EventCategories{ get; set; }\n    }\n\n public class EventCategory\n    {\n        [Key]\n        public int ID { get; set; }\n        public int EventID{ get; set; }\n        public Event Event{ get; set; }\n        public int CategoryID{ get; set; }\n        public Category Category{ get; set; }\n    }\n</code></pre>\n\n<p>From my Events controller I am trying to use a LINQ query to only show Events where the CategoryID is equal to 1 but i keep on coming into errors with my WHERE clause I think.</p>\n\n<p>UPDATE:</p>\n\n<p>I have been trying multiple queries but at present it is</p>\n\n<pre><code>    var eventsContext = _context.Events\n            .Include(e =&gt; e.EventCategories)\n            .Include(e=&gt;e.EventCategories.Select(ms =&gt; ms.Category))\n            .Where(e=&gt;e.ID==1)\n            .Take(15)\n            .OrderByDescending(o =&gt; o.StartDate);\n</code></pre>\n\n<p>This is the error I get</p>\n\n<p><a href=\"https://i.stack.imgur.com/rBCDU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rBCDU.png\" alt=\"Error Messsage\"></a></p>\n\n<p>TIA</p>\n"}, {"tags": ["c#", "asp.net-core", "unity-container"], "comments": [{"owner": {"reputation": 10256, "user_id": 1043380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2388aa1beb9ac75029a5b4fafec11eec?s=128&d=identicon&r=PG", "display_name": "gunr2171", "link": "https://stackoverflow.com/users/1043380/gunr2171"}, "edited": false, "score": 4, "creation_date": 1534958384, "post_id": 51971934, "comment_id": 90894650, "body": "I thought Asp.net core doesn&#39;t use web.config files?"}], "answers": [{"comments": [{"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 1, "creation_date": 1534963357, "post_id": 51972416, "comment_id": 90896874, "body": "App.config works because an ASP.NET Core web application is just a console app, and console apps can read from App.config. However, just because you can doesn&#39;t mean you should. There&#39;s a proper way to do configuration in ASP.NET Core, and this isn&#39;t it. However, if it&#39;s a requirement by some third-party library, you may not have a choice in the matter."}, {"owner": {"reputation": 550, "user_id": 2686723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQlU3.jpg?s=128&g=1", "display_name": "Luiz Bicalho", "link": "https://stackoverflow.com/users/2686723/luiz-bicalho"}, "reply_to_user": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 0, "creation_date": 1534963949, "post_id": 51972416, "comment_id": 90897149, "body": "That&#39;s the case, unity container uses the app.config to load the registrations, they are converting the unity.container to use the json format, but there isn&#39;t a plan to relase this. so we have to use unity, I didn&#39;t find another DI container that uses configuration file and integrates with ASP.NET Core DI"}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 0, "creation_date": 1534964486, "post_id": 51972416, "comment_id": 90897407, "body": "That&#39;s fine. It&#39;s just a general caution that you should use it only for what you absolutely have to use it for. Don&#39;t go whole hog and start throwing in everything and the kitchen sink, just because it&#39;s there."}, {"owner": {"reputation": 550, "user_id": 2686723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQlU3.jpg?s=128&g=1", "display_name": "Luiz Bicalho", "link": "https://stackoverflow.com/users/2686723/luiz-bicalho"}, "reply_to_user": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 0, "creation_date": 1534967151, "post_id": 51972416, "comment_id": 90898598, "body": "I only use the config to register what I can&#39;t load by default, or what I can&#39;t load by convention, for example, if I need to pass a parameter , or if I need to pass a dependency that is named."}, {"owner": {"reputation": 157, "user_id": 2357710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dad6c5f2746c477931828cc402b0b12f?s=128&d=identicon&r=PG", "display_name": "Suresh", "link": "https://stackoverflow.com/users/2357710/suresh"}, "edited": false, "score": 0, "creation_date": 1587855415, "post_id": 51972416, "comment_id": 108674829, "body": "I have similar requirement to be implemented in function app (NET Core 2.0 Azure Functions)..  Function app is class library not console application. any way to achieve this?"}], "tags": [], "owner": {"reputation": 550, "user_id": 2686723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQlU3.jpg?s=128&g=1", "display_name": "Luiz Bicalho", "link": "https://stackoverflow.com/users/2686723/luiz-bicalho"}, "is_accepted": true, "score": 2, "last_activity_date": 1534959748, "creation_date": 1534959748, "answer_id": 51972416, "question_id": 51971934, "link": "https://stackoverflow.com/questions/51971934/aspnet-core-web-config-not-loading/51972416#51972416", "title": "aspnet core web.config not loading", "body": "<p>Thanks to gunr2171 to post <a href=\"https://stackoverflow.com/questions/46996480/how-to-read-web-config-file-in-net-core-app\">How to read web.config file in .Net Core app</a> to another question.</p>\n\n<p>The problem was solved by a comment in that question:</p>\n\n<p>Just rename web.config to app.config that it will work.</p>\n"}], "owner": {"reputation": 550, "user_id": 2686723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NQlU3.jpg?s=128&g=1", "display_name": "Luiz Bicalho", "link": "https://stackoverflow.com/users/2686723/luiz-bicalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "closed_date": 1534960832, "accepted_answer_id": 51972416, "answer_count": 1, "score": 2, "last_activity_date": 1534959748, "creation_date": 1534957710, "last_edit_date": 1534958088, "question_id": 51971934, "link": "https://stackoverflow.com/questions/51971934/aspnet-core-web-config-not-loading", "closed_reason": "Duplicate", "title": "aspnet core web.config not loading", "body": "<p>I'm trying to make an aspnet core project using Unity.container.</p>\n\n<p>My problem is to load the unity.config, so I'm trying make the project use the web.config</p>\n\n<p>this is my startup.</p>\n\n<pre><code>    public static IWebHostBuilder CreateWebHostBuilder(string[] args) =&gt;\n        WebHost.CreateDefaultBuilder(args)\n            .UseStartup&lt;Startup&gt;().UseUnityServiceProvider(GetContainer());\n\n    private static IUnityContainer GetContainer()\n    {\n\n        var unitySection = (UnityConfigurationSection)ConfigurationManager.GetSection(\"unity\");\n        Dictionary&lt;string, IUnityContainer&gt; containers = new Dictionary&lt;string, IUnityContainer&gt;();\n        InitiateContainers(unitySection, containers);\n        return containers.Values.First();\n    }\n    internal const string DefaultContainerName = \"Default\";\n\n    internal static void InitiateContainers(UnityConfigurationSection unitySection, IDictionary&lt;string, IUnityContainer&gt; containers)\n    {\n        foreach (var element in unitySection.Containers)\n        {\n            string name = string.IsNullOrEmpty(element.Name) ? DefaultContainerName : element.Name;\n            if (!containers.ContainsKey(name))\n            {\n                containers.Add(name, new UnityContainer());\n            }\n            unitySection.Configure(containers[name], element.Name);\n        }\n    }\n</code></pre>\n\n<p>But the variable \"unitySection\" is always null.</p>\n\n<p>How can I make the aspnet core app load the web.config file?</p>\n\n<p>Do I need to import another nuget package?</p>\n"}, {"tags": ["c#", ".net", "split"], "comments": [{"owner": {"reputation": 925, "user_id": 9491208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vGGz3NCqHUo/AAAAAAAAAAI/AAAAAAAABtU/QLcpa2IbJMw/photo.jpg?sz=128", "display_name": "Simo", "link": "https://stackoverflow.com/users/9491208/simo"}, "edited": false, "score": 3, "creation_date": 1534957791, "post_id": 51971911, "comment_id": 90894390, "body": "did you tried to use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.text.regularexpressions.regex.match?redirectedfrom=MSDN&amp;view=netframework-4.7.2#System_Text_RegularExpressions_Regex_Match_System_String_\" rel=\"nofollow noreferrer\">Regex.Match Method</a> ?"}, {"owner": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "edited": false, "score": 0, "creation_date": 1534958777, "post_id": 51971911, "comment_id": 90894819, "body": "Or just split on comma, then use LINQ to group by the first two characters."}], "answers": [{"comments": [{"owner": {"reputation": 14614, "user_id": 572771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec86d88a4dfd26860ea208af88cf94ae?s=128&d=identicon&r=PG", "display_name": "Rafael Herscovici", "link": "https://stackoverflow.com/users/572771/rafael-herscovici"}, "edited": false, "score": 0, "creation_date": 1535013300, "post_id": 51971995, "comment_id": 90912670, "body": "Great, its not specifically for me, but for others that might visit the question :)"}], "tags": [], "owner": {"reputation": 61863, "user_id": 133910, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f1b913d48f914347dcafabff8d01ded?s=128&d=identicon&r=PG", "display_name": "Yuriy Faktorovich", "link": "https://stackoverflow.com/users/133910/yuriy-faktorovich"}, "is_accepted": true, "score": 1, "last_activity_date": 1534973202, "last_edit_date": 1534973202, "creation_date": 1534957935, "answer_id": 51971995, "question_id": 51971911, "link": "https://stackoverflow.com/questions/51971911/c-how-to-split-a-string-with-a-changing-prefix/51971995#51971995", "title": "C#: How to split a string with a changing prefix", "body": "<pre><code>Regex.Matches(myList, @\"M(?&lt;digit&gt;\\d+)\\..\") //find all M1.A etc\n    .Cast&lt;Match&gt;() //convert the resulting list to an enumerable of Match\n    .GroupBy(m =&gt; m.Groups[\"digit\"].Value) //find the groups with the same digits\n    .Select(g =&gt; new[] { \"time\" }.Union(g.Select(m =&gt; m.Value)).ToArray());\n    //combine the groups into arrays beginning with \"time\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 2013567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oSz2Q.gif?s=128&g=1", "display_name": "Rustem Bayetov", "link": "https://stackoverflow.com/users/2013567/rustem-bayetov"}, "is_accepted": false, "score": 0, "last_activity_date": 1534958865, "creation_date": 1534958865, "answer_id": 51972209, "question_id": 51971911, "link": "https://stackoverflow.com/questions/51971911/c-how-to-split-a-string-with-a-changing-prefix/51972209#51972209", "title": "C#: How to split a string with a changing prefix", "body": "<p>Some quick example for you. I think is better to parse it by you own way and have string structure of your Machine-Attribute pair.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace ConsoleApp4 {\n    class Program {\n        static void Main(string[] args) {\n            string inputString = \"time, M1.A, M1.B, M1.C, M2.A, M2.B, M2.C, M3.A, M3.B, M3.C\";\n\n            string[] attrList = inputString.Split(',');\n\n            // 1. Get all machines with attributes\n            List&lt;MachineAttribute&gt; MachineAttributeList = new List&lt;MachineAttribute&gt;();\n            for (int i = 1; i &lt; attrList.Length; i++) {\n                MachineAttributeList.Add(new MachineAttribute(attrList[i]));\n            }\n\n            // 2. For each machine create \n            foreach (var machine in MachineAttributeList.Select(x=&gt;x.Machine).Distinct()) {\n                Console.Write(attrList[0]);\n                foreach (var attribute in MachineAttributeList.Where(x=&gt;x.Machine == machine)) {\n                    Console.Write(attribute + \",\");\n                }\n                Console.WriteLine();\n            }\n\n            Console.ReadLine();\n        }\n    }\n\n    public class MachineAttribute {\n        public string Machine { get; }\n\n        public string Attribute { get; }\n\n        public MachineAttribute(string inputData) {\n            var array = inputData.Split('.');\n            if (array.Length &gt; 0) Machine = array[0];\n            if (array.Length &gt; 1) Attribute = array[1];\n        }\n\n        public override string ToString() {\n            return Machine + \".\" + Attribute;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 664834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c5627c08a25987e8c18fdde13b3597f?s=128&d=identicon&r=PG", "display_name": "Garrett", "link": "https://stackoverflow.com/users/664834/garrett"}, "is_accepted": false, "score": 1, "last_activity_date": 1534959557, "creation_date": 1534959557, "answer_id": 51972377, "question_id": 51971911, "link": "https://stackoverflow.com/questions/51971911/c-how-to-split-a-string-with-a-changing-prefix/51972377#51972377", "title": "C#: How to split a string with a changing prefix", "body": "<p>You mention \"the output should then look like this...\", but then you mention a list, so I'm going to assume that you mean to make the original string into a list of lists of strings.</p>\n\n<pre><code>List&lt;string&gt; split = new List&lt;string&gt;(s.Split(','));\nstring first = split[0];\nsplit.RemoveAt(0);\nList&lt;List&lt;string&gt;&gt; result = new List&lt;List&lt;string&gt;&gt;();\nforeach (var dist in split.Select(o =&gt; o.Split('.')[0]).Distinct())\n{\n    List&lt;string&gt; temp = new List&lt;string&gt; {first};\n    temp.AddRange(split.Where(o =&gt; o.StartsWith(dist)));\n    result.Add(temp);\n}\n</code></pre>\n\n<p>This does the original split, removes the first value (you didn't really specify that, I assumed), then loops around each machine.  The machines are created by splitting each value further by '.' and making a distinct list.  It then selects all values in the list that start with the machine and adds them with the first value to the resulting list.</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "is_accepted": false, "score": 1, "last_activity_date": 1534960097, "creation_date": 1534960097, "answer_id": 51972503, "question_id": 51971911, "link": "https://stackoverflow.com/questions/51971911/c-how-to-split-a-string-with-a-changing-prefix/51972503#51972503", "title": "C#: How to split a string with a changing prefix", "body": "<p>Using Regex I created a dictionary :</p>\n\n<pre><code>           string input = \"time, M1.A, M1.B, M1.C, M2.A, M2.B, M2.C, M3.A, M3.B, M3.C\";\n            string pattern1 = @\"^(?'name'[^,]*),(?'machines'.*)\";\n            Match match1 = Regex.Match(input, pattern1);\n            string name = match1.Groups[\"name\"].Value;\n            string machines = match1.Groups[\"machines\"].Value.Trim();\n\n            string pattern2 = @\"\\s*(?'machine'[^.]*).(?'attribute'\\w+)(,|$)\";\n            MatchCollection matches = Regex.Matches(machines, pattern2);\n\n            Dictionary&lt;string, List&lt;string&gt;&gt; dict = matches.Cast&lt;Match&gt;()\n                .GroupBy(x =&gt; x.Groups[\"machine\"].Value, y =&gt; y.Groups[\"attribute\"].Value)\n                .ToDictionary(x =&gt; x.Key, y =&gt; y.ToList());\n</code></pre>\n"}], "owner": {"reputation": 384, "user_id": 8832072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBLzt.png?s=128&g=1", "display_name": "AUBSieGUL", "link": "https://stackoverflow.com/users/8832072/aubsiegul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 1, "accepted_answer_id": 51971995, "answer_count": 4, "score": 0, "last_activity_date": 1534973202, "creation_date": 1534957590, "question_id": 51971911, "link": "https://stackoverflow.com/questions/51971911/c-how-to-split-a-string-with-a-changing-prefix", "title": "C#: How to split a string with a changing prefix", "body": "<p>Hello I looked at several post about this topics but no answer could help me.</p>\n\n<p>I extract data about various machines which look like this:</p>\n\n<pre><code>\"time, M1.A, M1.B, M1.C, M2.A, M2.B, M2.C, M3.A, M3.B, M3.C\"\n</code></pre>\n\n<p>M1 is the prefix which specifies which machine. A,B,C are attributes of this machine like temperature, pressure, etc.</p>\n\n<p>The output should then look like this:</p>\n\n<pre><code>{{\"time\", \"M1.A\", \"M1.B\", \"M1.C\"}, {\"time\", \"M2.A\",....}}\n</code></pre>\n\n<p>I know that I could possibly split at \",\" and then create the list but I was wondering if there is another way to detect if the prefix changed. </p>\n"}, {"tags": ["c#", "oracle", "asp.net-mvc-5", "entity-framework-6"], "comments": [{"owner": {"reputation": 2516, "user_id": 5011484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed5ec218d91ad9bba4e00f06f99c5b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mittal Patel", "link": "https://stackoverflow.com/users/5011484/mittal-patel"}, "edited": false, "score": 0, "creation_date": 1534957628, "post_id": 51971893, "comment_id": 90894309, "body": "How many records do you get into the Data object?"}, {"owner": {"reputation": 324, "user_id": 9913975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ed756fe74522b217489c19dc9cefc0?s=128&d=identicon&r=PG&f=1", "display_name": "lutakyn", "link": "https://stackoverflow.com/users/9913975/lutakyn"}, "reply_to_user": {"reputation": 2516, "user_id": 5011484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eed5ec218d91ad9bba4e00f06f99c5b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mittal Patel", "link": "https://stackoverflow.com/users/5011484/mittal-patel"}, "edited": false, "score": 0, "creation_date": 1534957823, "post_id": 51971893, "comment_id": 90894407, "body": "If I pass 3 as the number,i get 3 in the data object but it inserts only the last item in the object"}], "answers": [{"tags": [], "owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "is_accepted": true, "score": 1, "last_activity_date": 1534957825, "creation_date": 1534957825, "answer_id": 51971967, "question_id": 51971893, "link": "https://stackoverflow.com/questions/51971893/entity-framework-inserts-only-one-record/51971967#51971967", "title": "Entity Framework inserts only one record", "body": "<p>You are creating one entity, and then updating it 3 times.  You need to create a new entity for each new record.</p>\n\n<p>Move the <code>new IntermediaryAssignment()</code> inside the loop.</p>\n\n<pre><code>     foreach (var sticker in data)\n     {\n            var entity = new IntermediaryAssignment();\n\n\n            entity.CompanyCode = sticker.CompanyCode;\n            entity.StickerCode = sticker.StickerCode;\n            entity.RegistrationNumber = intermediary.RegistrationNumber;\n            entity.Status = EntityStatus.Active;\n            entity.CreatedDate = DateTime.Now;\n            entity.Dispatched = false;\n            entity.IntermediaryType = intermediary.IntermediaryType;\n\n\n            dbSet.Add(entity);\n\n        }\n</code></pre>\n"}], "owner": {"reputation": 324, "user_id": 9913975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ed756fe74522b217489c19dc9cefc0?s=128&d=identicon&r=PG&f=1", "display_name": "lutakyn", "link": "https://stackoverflow.com/users/9913975/lutakyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 1, "accepted_answer_id": 51971967, "answer_count": 1, "score": 1, "last_activity_date": 1534966648, "creation_date": 1534957521, "last_edit_date": 1534966648, "question_id": 51971893, "link": "https://stackoverflow.com/questions/51971893/entity-framework-inserts-only-one-record", "title": "Entity Framework inserts only one record", "body": "<p>I'm saving a record in my database by passing 3 parameters, the number parameter is passed to pick the number of records from one table to another table. However the loop written inserts only 1 record instead of the number parameter passed. </p>\n\n<p>I'm using the the <code>Take()</code> method in Entity Framework to pick the records. It inserts only the last records in the loop</p>\n\n<pre><code>public async Task&lt;bool&gt; Save(string company, int number, string registrationNumber)\n{\n    using (var trans = _dbContext.Database.BeginTransaction())\n    {\n        var db = new SibaCiidDbContext();\n        var dbSet = _dbContext.Set&lt;IntermediaryAssignment&gt;();\n\n        // pick number of records \n        var data = await (from s in db.StickerDistributions\n                          where s.Dispatched == false &amp;&amp;  \n                                s.CompanyCode == company\n                          select s).Take(number).ToListAsync();\n\n        var intermediary = (await _repo.FindBy(s =&gt; s.RegistrationNumber  == registrationNumber &amp;&amp; \n                                                    s.Status == EntityStatus.Active)).FirstOrDefault();\n\n        var entity = new IntermediaryAssignment();\n\n        foreach (var sticker in data)\n        {\n            entity.CompanyCode = sticker.CompanyCode;\n            entity.StickerCode = sticker.StickerCode;\n            entity.RegistrationNumber = intermediary.RegistrationNumber;\n            entity.Status = EntityStatus.Active;\n            entity.CreatedDate = DateTime.Now;\n            entity.Dispatched = false;\n            entity.IntermediaryType = intermediary.IntermediaryType;\n\n            dbSet.Add(entity);\n        }\n\n        trans.Commit();\n\n        return  await _dbContext.SaveChangesAsync() &gt; 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "selenium", "selenium-webdriver"], "comments": [{"owner": {"reputation": 1605, "user_id": 1689226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd71f9f43c5a587ef304196c5e667c3e?s=128&d=identicon&r=PG", "display_name": "Subbu", "link": "https://stackoverflow.com/users/1689226/subbu"}, "edited": false, "score": 1, "creation_date": 1534958793, "post_id": 51971855, "comment_id": 90894825, "body": "The <code>timeout</code> setting in the web.config is for the web application. For Selenium, you would need to set it in your code. This is the official documentation: <a href=\"https://www.seleniumhq.org/docs/04_webdriver_advanced.jsp\" rel=\"nofollow noreferrer\">seleniumhq.org/docs/04_webdriver_advanced.jsp</a> <code>WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10));</code> More specifically, where are you getting time out ? If you add your code / exception stack trace, you are likely to get better / more appropriate solutions."}], "answers": [{"tags": [], "owner": {"reputation": 2203, "user_id": 1416121, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/meEPF.jpg?s=128&g=1", "display_name": "so cal cheesehead", "link": "https://stackoverflow.com/users/1416121/so-cal-cheesehead"}, "is_accepted": false, "score": 1, "last_activity_date": 1534975315, "creation_date": 1534975315, "answer_id": 51975763, "question_id": 51971855, "link": "https://stackoverflow.com/questions/51971855/regarding-session-timeout-using-selenium-c/51975763#51975763", "title": "Regarding Session Timeout using selenium c#", "body": "<p>You could set an implicit wait for the driver in the following fashion:</p>\n\n<pre><code>driver.Manage().Timeouts().ImplicitWait = TimeSpan.FromSeconds(20);\n</code></pre>\n\n<blockquote>\n  <p>An implicit wait is to tell WebDriver to poll the DOM for a certain amount of time when trying to find an element or elements if they are not immediately available. The default setting is 0. Once set, the implicit wait is set for the life of the WebDriver object instance.</p>\n</blockquote>\n\n<p>Now the only reason to use app.config is if you want to make this timeout configurable. In which case in your app.config file you would add a  section:</p>\n\n<pre><code>&lt;appSettings&gt;\n    &lt;add key=\"driver.Timeout\" value=\"20\" /&gt;\n&lt;/appSettings&gt;\n</code></pre>\n\n<p>Then in your code you would do something like:</p>\n\n<pre><code>driver.Manage().Timeouts().ImplicitWait = TimeSpan.FromSeconds(Int32.Parse(ConfigurationManager.AppSettings[\"driver.Timeout\"]));\n</code></pre>\n\n<p>This way if you deploy your app somewhere and wanted to make the timeout configurable you would just edit your app.config file in a text editor and change the value. </p>\n"}], "owner": {"reputation": 73, "user_id": 9207738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25fbad60d7d5cb98051315a8b920fac3?s=128&d=identicon&r=PG&f=1", "display_name": "Hargovind ", "link": "https://stackoverflow.com/users/9207738/hargovind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1534975315, "creation_date": 1534957360, "question_id": 51971855, "link": "https://stackoverflow.com/questions/51971855/regarding-session-timeout-using-selenium-c", "title": "Regarding Session Timeout using selenium c#", "body": "<p>My Application has a Functionality which takes time to load the search results like more then a minute because of which my scripts fails and gives a 60 seconds session timeout error message. I googled few solutions and got one from stack overflow\"<a href=\"https://stackoverflow.com/questions/1205828/how-to-set-session-timeout-in-web-config\">How to set session timeout in web.config</a>\" but i am not sure where exactly to implement it. i have a file in my framework called \"app.config\" and the code in the app.config is below</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration&gt;\n  &lt;runtime&gt;\n    &lt;assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n      &lt;dependentAssembly&gt;\n        &lt;assemblyIdentity name=\"Newtonsoft.Json\" publicKeyToken=\"30ad4fe6b2a6aeed\" culture=\"neutral\" /&gt;\n        &lt;bindingRedirect oldVersion=\"0.0.0.0-11.0.0.0\" newVersion=\"11.0.0.0\" /&gt;\n      &lt;/dependentAssembly&gt;\n    &lt;/assemblyBinding&gt;\n  &lt;/runtime&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>This Below mentioned code is given in the stack overflow to make necessary changes in web.config file to set the session timeout</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;system.web&gt;\n     &lt;sessionState timeout=\"20\"&gt;&lt;/sessionState&gt;\n  &lt;/system.web&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>please help me where to make the necessary changes in app.config file.</p>\n"}, {"tags": ["c#", "logging", "log4net"], "comments": [{"owner": {"reputation": 5329, "user_id": 1395758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D5fXD.jpg?s=128&g=1", "display_name": "A. Chiesa", "link": "https://stackoverflow.com/users/1395758/a-chiesa"}, "edited": false, "score": 1, "creation_date": 1535670893, "post_id": 51971845, "comment_id": 91163959, "body": "Could you include the code in ExceptionHandler, in Logger.Log and a sample of InternalMethod2?"}, {"owner": {"reputation": 3389, "user_id": 3121975, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27507c7b9958f8863c6640543baec276?s=128&d=identicon&r=PG&f=1", "display_name": "Woody1193", "link": "https://stackoverflow.com/users/3121975/woody1193"}, "reply_to_user": {"reputation": 5329, "user_id": 1395758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D5fXD.jpg?s=128&g=1", "display_name": "A. Chiesa", "link": "https://stackoverflow.com/users/1395758/a-chiesa"}, "edited": false, "score": 0, "creation_date": 1535671367, "post_id": 51971845, "comment_id": 91164064, "body": "@A.Chiesa I have done so. As you can see, the call stack will show the exception being &quot;thrown&quot; in my logger class. Additionally, the <code>%location</code> variable will show the location of my logger class"}, {"owner": {"reputation": 5329, "user_id": 1395758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D5fXD.jpg?s=128&g=1", "display_name": "A. Chiesa", "link": "https://stackoverflow.com/users/1395758/a-chiesa"}, "edited": false, "score": 0, "creation_date": 1535672787, "post_id": 51971845, "comment_id": 91164344, "body": "Is the code complete or simplified? There is nothing in your code that could possibly change the stacktrace of the exception. Look for <code>throw e;</code> calls instead of <code>throw;</code>."}, {"owner": {"reputation": 3389, "user_id": 3121975, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27507c7b9958f8863c6640543baec276?s=128&d=identicon&r=PG&f=1", "display_name": "Woody1193", "link": "https://stackoverflow.com/users/3121975/woody1193"}, "reply_to_user": {"reputation": 5329, "user_id": 1395758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D5fXD.jpg?s=128&g=1", "display_name": "A. Chiesa", "link": "https://stackoverflow.com/users/1395758/a-chiesa"}, "edited": false, "score": 0, "creation_date": 1535683806, "post_id": 51971845, "comment_id": 91166362, "body": "@A.Chiesa The code is simplified but all <code>throw</code> statements occur within the method or within methods called by the method. I had found several <code>throw e;</code> statements when I was doing the conversion and I changed those but there are none that occur within <code>Logger.Log</code>. Furthermore, the stack trace that I&#39;m talking about is a <code>log4net</code> variable so I&#39;m unsure as to how that&#39;s being set"}, {"owner": {"reputation": 5329, "user_id": 1395758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D5fXD.jpg?s=128&g=1", "display_name": "A. Chiesa", "link": "https://stackoverflow.com/users/1395758/a-chiesa"}, "edited": false, "score": 1, "creation_date": 1535808680, "post_id": 51971845, "comment_id": 91207651, "body": "You are using the wrong pattern: the %exception token formats the exception text <i>including</i> the stacktrace of the exception. Instead, you are using the %stacktrace token, which, as per documentation (<a href=\"https://logging.apache.org/log4net/release/sdk/?topic=html/T_log4net_Layout_PatternLayout.htm\" rel=\"nofollow noreferrer\">logging.apache.org/log4net/release/sdk/?topic=html/&hellip;</a>) refers to the stacktrace of the log call. Personally, I prefer to pre format the exception by myself, unwrapping eventual inner exceptions, logging both message and stacktrace for every exception in the pack."}, {"owner": {"reputation": 3389, "user_id": 3121975, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27507c7b9958f8863c6640543baec276?s=128&d=identicon&r=PG&f=1", "display_name": "Woody1193", "link": "https://stackoverflow.com/users/3121975/woody1193"}, "reply_to_user": {"reputation": 5329, "user_id": 1395758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D5fXD.jpg?s=128&g=1", "display_name": "A. Chiesa", "link": "https://stackoverflow.com/users/1395758/a-chiesa"}, "edited": false, "score": 0, "creation_date": 1535948166, "post_id": 51971845, "comment_id": 91235966, "body": "@A.Chiesa In that case, please post that as your answer and I will accept it as it solves the problem I&#39;m currently having. However, that makes me wonder what the utility of <code>stacktrace</code> is and how I could go about removing the top levels from it."}], "answers": [{"tags": [], "owner": {"reputation": 5329, "user_id": 1395758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/D5fXD.jpg?s=128&g=1", "display_name": "A. Chiesa", "link": "https://stackoverflow.com/users/1395758/a-chiesa"}, "is_accepted": true, "score": 1, "last_activity_date": 1535957922, "creation_date": 1535957922, "answer_id": 52144593, "question_id": 51971845, "link": "https://stackoverflow.com/questions/51971845/remove-top-levels-of-stacktrace-from-log4net/52144593#52144593", "title": "Remove top levels of stacktrace from Log4Net", "body": "<p>As per documentation <a href=\"https://logging.apache.org/log4net/release/sdk/?topic=html/T_log4net_Layout_PatternLayout.htm\" rel=\"nofollow noreferrer\">here</a>.\nThe <code>%stacktrace</code> token inserts the stacktrace referring to the method outputting the log. This is useful when using a different pattern than yours, i.e. inserting a <code>ILog</code> in each class. Something like this:</p>\n\n<pre><code>private static log4net.ILog Logger = log4net.LogManager.GetLogger(typeof(ThisClass));\n</code></pre>\n\n<p>When outputting the exception details you can use the <code>%exception</code> token.</p>\n\n<p>However, I use a slightly different approach: I pre-format the exception details using an extension method of the <code>ILog</code> interface.</p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// Logs an exception as an error in the provided logger,\n    /// formatting message and stacktrace.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"logger\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    public static void ErrorFromException(this ILog logger, Exception e)\n    {\n        ErrorFromException(logger, null, e);\n    }\n\n    /// &lt;summary&gt;\n    /// Logs an exception as an error in the provided logger,\n    /// formatting message and stacktrace.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"logger\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"prefix\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    public static void ErrorFromException(this ILog logger, string prefix, Exception e)\n    {\n        if (logger == null) return;\n\n        if (e == null)\n        {\n            logger.Error(\n                \"LogExtension.ErrorFromException: A null exception was formatted. Probably there is a bug in the logging call.\");\n            return;\n        }\n\n        var sb = new StringBuilder(400);\n\n        if (!String.IsNullOrEmpty(prefix))\n            sb.AppendLine(prefix);\n\n        sb.AppendLine(\"Caught exception (\" + e.GetType().Name + \"): \" + e.Message);\n        sb.AppendLine(e.StackTrace);\n\n        var innerEx = e;\n\n        while (innerEx.InnerException != null)\n        {\n            innerEx = innerEx.InnerException;\n            sb.AppendLine(\"Inner exception (\" + innerEx.GetType().Name + \"): \" + innerEx.Message);\n            sb.AppendLine(innerEx.StackTrace);\n        }\n\n        sb.AppendLine();\n        logger.Error(sb.ToString());\n    }\n</code></pre>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 3389, "user_id": 3121975, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/27507c7b9958f8863c6640543baec276?s=128&d=identicon&r=PG&f=1", "display_name": "Woody1193", "link": "https://stackoverflow.com/users/3121975/woody1193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 52144593, "answer_count": 1, "score": 0, "last_activity_date": 1535957922, "creation_date": 1534957338, "last_edit_date": 1535671183, "question_id": 51971845, "link": "https://stackoverflow.com/questions/51971845/remove-top-levels-of-stacktrace-from-log4net", "title": "Remove top levels of stacktrace from Log4Net", "body": "<p>I have a log4net implementation that is kept in a class and that class is accessed from a static <code>ExceptionHandler</code> class (to avoid changing a bunch of usages, as this is a legacy codebase). So, when exceptions are logged, they look like this:</p>\n\n<pre><code>System.Timers.Timer.MyTimerCallback &gt; \nInternalMethod1 &gt; \nInternalMethod2 &gt; \nExceptionHandler.HandleException &gt; \nLogger.Log\n</code></pre>\n\n<p>I really don't want these last two to be present in the call stack because they obfuscate where the error was actually logged from, which is in <code>InternalMethod2</code>. However, the only way I see of doing this is to expose the actual logger to <code>InternalMethod2</code> and I don't want to do that either.</p>\n\n<p>Is there a way I can curate my stacktrace so that it displays the situation accurately?</p>\n\n<p>My Logger Class:</p>\n\n<pre><code>public class Logger : ILogger\n{\n    public void Log(Exception ex, string message)\n    {\n        log4net.LogManager.Get(\"MyLog\").Error(ex, message);\n    }\n}\n</code></pre>\n\n<p>My ExceptionHandler class:</p>\n\n<pre><code>public static class ExceptionHandler\n{\n    private readonly static Logger MyLogger = new Logger();\n\n    HandleException(Exception ex, string message)\n    {\n        MyLogger.Log(ex, message);\n    }\n}\n</code></pre>\n\n<p>My call in <code>InternalMethod2</code>:</p>\n\n<pre><code>void InternalMethod2()\n{\n    // do some stuff\n    try\n    {\n        // do other stuff\n    }\n    catch (Exception e)\n    {\n        ExceptionHandler.HandleException(e, \"An error occurred\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "winforms", "mvvm", "reactiveui"], "answers": [{"comments": [{"owner": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534962000, "post_id": 51972105, "comment_id": 90896286, "body": "I may be wrong, and the docs are not 100% clear about this, but isn&#39;t <code>BindTo</code> only one-way binding?"}, {"owner": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "reply_to_user": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534963178, "post_id": 51972105, "comment_id": 90896795, "body": "Yes that&#39;s correct but nothing stopping you from doing two statements. What Bind/WhenAnyValue do is they take in a Expression&lt;T&gt;, which they then read each property contained within and subscribe to property changes (We have a mechanism that allows us to detect the best binding mechanism). So your technique of using a non-constant value isn&#39;t going to work there. So you&#39;re effectively left with building that chain yourself and you can do that by doing WhenAnyValue chains. I&#39;ve in the past have created extension methods to help with this type of scenario."}, {"owner": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534963612, "post_id": 51972105, "comment_id": 90896987, "body": "I had seen the overload taking an <code>Expression</code>, but I admit I&#39;d need to see some example to wrap my head around how to use it. Can you edit your answer with some sample code?"}, {"owner": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "reply_to_user": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534964464, "post_id": 51972105, "comment_id": 90897397, "body": "The answer is the answer, what you want isn&#39;t possible with Bind(), you&#39;d have to use some other mechanism to get property updates."}, {"owner": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534965376, "post_id": 51972105, "comment_id": 90897804, "body": "I agree, but I&#39;ve been trying to get your suggestion of <code>ViewModel.ExcelData[Row].WhenAnyValue()</code> to work without success. Nothing gets &quot;triggered&quot;. If you have done something similar in the past, could you please update your answer with some code?"}, {"owner": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "reply_to_user": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534965766, "post_id": 51972105, "comment_id": 90897977, "body": "Does the modified answer help?"}, {"owner": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534965998, "post_id": 51972105, "comment_id": 90898061, "body": "I guess your last sentence nailed it down for me. As mentioned in my OP, <code>ExcelData</code> is of type <code>Dictionary&lt;string, object&gt;</code>, so no INPC. I have to rethink my approach if INPC is required."}, {"owner": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534966446, "post_id": 51972105, "comment_id": 90898275, "body": "What is funny though, is that <code>Bind</code>, using a literal key, picks up the changes in the object even if it doesn&#39;t implement INPC."}, {"owner": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "reply_to_user": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1534968633, "post_id": 51972105, "comment_id": 90899218, "body": "Yeah, the BindTo() will only pick up value changes and then bind. Bind() will also grab the initial value for POCO types. You can just achieve the same thing by setting the value onto your target control directly."}, {"owner": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1535028051, "post_id": 51972105, "comment_id": 90921407, "body": "Glenn, what you say about picking up the initial value is very interesting. Do you know of resources that would help me learn about those &quot;hidden&quot; pearls of knowledge about RxUI? I don&#39;t mind buying books if needed."}, {"owner": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "reply_to_user": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "edited": false, "score": 0, "creation_date": 1535035410, "post_id": 51972105, "comment_id": 90926438, "body": "Kent Boogart (one of my fellow RxUI maintainers) released a book earlier this year. Worth getting a copy and goes through a lot of these tricks <a href=\"https://kent-boogaart.com/you-i-and-reactiveui/\" rel=\"nofollow noreferrer\">kent-boogaart.com/you-i-and-reactiveui</a>"}], "tags": [], "owner": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "is_accepted": false, "score": 0, "last_activity_date": 1534965696, "last_edit_date": 1534965696, "creation_date": 1534958387, "answer_id": 51972105, "question_id": 51971802, "link": "https://stackoverflow.com/questions/51971802/bind-textbox-to-dictionary-using-a-variable-key/51972105#51972105", "title": "Bind textbox to dictionary using a variable key", "body": "<p>No you can't do what you want with Bind()</p>\n\n<p>We use Expression> to determine where the binding should come from. As the error message said you have to use constants if you want to use indexes. </p>\n\n<p>To give you an idea what the Expression is doing, Expression allows you to use details about a lambda a user provides. </p>\n\n<pre><code>this.Bind(this.ViewModel, vm =&gt; vm.Property1.Property2.Property3)\n</code></pre>\n\n<p>With Expression's you get details about each property/object along the way. </p>\n\n<p>What we do is subscribe to each object along the way's PropertyChanged event (if the object is not null), and we'll also set values appropriately to the other property.</p>\n\n<p>Expression have a limitation of having to be constant since it's mostly a compile time feature.</p>\n\n<p>In terms of what you want to achieve you'll have to do everything after your dynamic value. So you can subscribe to the PropertyChange events once you've resolved the ExcelData index.</p>\n\n<p>You can potentially use WhenAnyValue() on the resolved object,</p>\n\n<pre><code>myViewModel.ExcelData[propertyIndex].WhenAnyValue(x =&gt; x.Value).BindTo(this.ViewModel, view =&gt; view.TextBox.Text);\nthis.WhenAnyValue(view =&gt; view.TextBox.Text).BindTo(myViewModel.ExcelData[propertyIndex], x =&gt; x.Value);\n</code></pre>\n\n<p>You need the two BindTo due to it being OneWayOnly, and I've used the assumption you have a Value property on your ExcelData object.</p>\n\n<p>Be aware your ExcelData object contained at the propertyIndex must also be derived off <em>INotifyPropertyChanged</em></p>\n"}], "owner": {"reputation": 5142, "user_id": 172769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae58151e7cc8bdcf9f4135de6e20a0?s=128&d=identicon&r=PG", "display_name": "Luc Morin", "link": "https://stackoverflow.com/users/172769/luc-morin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535007376, "creation_date": 1534957163, "question_id": 51971802, "link": "https://stackoverflow.com/questions/51971802/bind-textbox-to-dictionary-using-a-variable-key", "title": "Bind textbox to dictionary using a variable key", "body": "<p>I want to implement a dynamic UI where TextBox controls will be created dynamically, and their content bound to a Dictionary on the ViewModel.</p>\n\n<p>I'm trying to implement two-way data binding using ReactiveUI.</p>\n\n<p>The issue I'm facing is that I only seem to be allowed to bind the TextBoxes to an entry in the Dictionary if I use a literal string as the key, but as soon as I try to use a string variable to setup the binding, I get the following error:</p>\n\n<pre><code>Index expressions are only supported with constants.\n</code></pre>\n\n<p>Here is a very simplified sample of what I'm trying to do. The TextBox is not dynamically instantiated in order to isolate the problem:</p>\n\n<pre><code>string PropNum = \"22017\";\nthis.Bind(ViewModel, vm =&gt; vm.ExcelData[PropNum], view =&gt; view.tbCreate.Text);\n</code></pre>\n\n<p>In this example, <code>ExcelData</code> is a <code>Dictionary&lt;string, object&gt;</code> defined on the ViewModel.</p>\n\n<p>On the other hand, the following works fine:</p>\n\n<pre><code>this.Bind(ViewModel, vm =&gt; vm.ExcelData[\"22017\"], view =&gt; view.tbCreate.Text);\n</code></pre>\n\n<p>I need the lookup key to be a variable. Any ways to achieve this result?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "agora.io"], "comments": [{"owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "edited": false, "score": 0, "creation_date": 1534957073, "post_id": 51971575, "comment_id": 90894017, "body": "do you mean you need a port of, for example, <a href=\"https://github.com/AgoraIO/AgoraDynamicKey/tree/master/java/src/main/java/io/agora\" rel=\"nofollow noreferrer\">the java version</a> to C#, or are you programming something with/against this API?"}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 4962647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f297181f7a95654a45ccf93b94c5b11?s=128&d=identicon&r=PG&f=1", "display_name": "Sidharth Sharma", "link": "https://stackoverflow.com/users/4962647/sidharth-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1534997677, "creation_date": 1534997677, "answer_id": 51978226, "question_id": 51971575, "link": "https://stackoverflow.com/questions/51971575/agora-io-dynamic-key-generating-on-c/51978226#51978226", "title": "Agora.io dynamic key generating on C#", "body": "<p>You don't need actually need to use C# for this. \nYou can use any of the provided libraries and just host the dynamic key script on a server somewhere and request the token that way. </p>\n\n<p>If you are looking to port it to C# for some reason, this is the <a href=\"https://github.com/AgoraIO/AgoraDynamicKey/blob/master/java/src/main/java/io/agora/media/AccessToken.java#L111\" rel=\"nofollow noreferrer\">main function</a> to look at</p>\n"}], "owner": {"reputation": 132, "user_id": 8032801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IE25C.jpg?s=128&g=1", "display_name": "rubyshine72", "link": "https://stackoverflow.com/users/8032801/rubyshine72"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "closed_date": 1535013373, "answer_count": 1, "score": 0, "last_activity_date": 1534997677, "creation_date": 1534956324, "question_id": 51971575, "link": "https://stackoverflow.com/questions/51971575/agora-io-dynamic-key-generating-on-c", "closed_reason": "Needs more focus", "title": "Agora.io dynamic key generating on C#", "body": "<p>Everyone,\nI have issue about generating Agora.io C# dynamic key generating.\nWho has experience on Agora.io, please help me.</p>\n\n<pre><code>https://github.com/AgoraIO/AgoraDynamicKey\n</code></pre>\n\n<p>Agora sample github doesn`t have C#.\nAnd now I am using C# Asp.net, So I need to generating Agora.io key on C#.\nPlease give me help.</p>\n"}, {"tags": ["c#", "asp.net", ".net", "ado.net", "odbc"], "answers": [{"tags": [], "owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_accepted": true, "score": 1, "last_activity_date": 1534959256, "last_edit_date": 1534959256, "creation_date": 1534958899, "answer_id": 51972218, "question_id": 51971538, "link": "https://stackoverflow.com/questions/51971538/drop-down-list-binding-through-odbc-in-asp-net-mvc-and-mysql/51972218#51972218", "title": "Drop down list binding through ODBC in ASP.NET MVC and MySQL", "body": "<p>You are using the incorrect overload of <code>SelectList</code> constructor.</p>\n\n<p>Use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.rendering.selectlist.-ctor?view=aspnetcore-2.1#Microsoft_AspNetCore_Mvc_Rendering_SelectList__ctor_System_Collections_IEnumerable_System_String_System_String_\" rel=\"nofollow noreferrer\">this overload</a></p>\n\n<pre><code>public SelectList (System.Collections.IEnumerable items, \n                   string dataValueField, \n                   string dataTextField);\n</code></pre>\n\n<p>The second parameter is the value field which will be used to set the OPTION value attribute value and the third parameter is the text filed which will be used to render the OPTION text.</p>\n\n<p>Since your controller code is only setting the <code>referenceNumber</code> property on the<br>\n<code>AddInventoryModel</code> objects, you can use that for both dataTextField and dataValueField.</p>\n\n<pre><code>@Html.DropDownListFor(model =&gt; model.referenceNumber, \n                       new SelectList(Model.refNumDD, \"referenceNumber\",\"referenceNumber\"),\n                       \"Choose reference number\")\n</code></pre>\n\n<p><em>For rendering SELECT elements, I personally prefer to use a collection <code>SelectListItem</code> in my view model, instead of a collection of custom objects.</em></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8205798"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 51972218, "answer_count": 1, "score": 0, "last_activity_date": 1534970052, "creation_date": 1534956163, "last_edit_date": 1534970052, "question_id": 51971538, "link": "https://stackoverflow.com/questions/51971538/drop-down-list-binding-through-odbc-in-asp-net-mvc-and-mysql", "title": "Drop down list binding through ODBC in ASP.NET MVC and MySQL", "body": "<p><strong>My problem:</strong></p>\n\n<p>Trying to establish a connection through ODBC from visual studio (ASP.NET MVC project) to a remote server (Fishbowl) which uses MYSQL. Ultimate goal is to bind data from database to the drop down list. Instead of actually retrieving the rows from the column in query, I get output like this when I run the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/W2s9X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W2s9X.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where am I going wrong? Any suggestions or alternate method? Thanks!</p>\n\n<p><strong>Controller Connection Part</strong></p>\n\n<pre><code>DataSet ds = new DataSet();\n\n        using (OdbcConnection connfb = new OdbcConnection(\"DSN=Fishbowl\"))\n        {\n            using (OdbcCommand cmd = new OdbcCommand(\"select xyz from abc\", connfb))\n            {\n                connfb.Open();\n                cmd.ExecuteNonQuery();\n\n                OdbcDataAdapter da = new OdbcDataAdapter(cmd);\n                //da.Fill(dt);\n                da.Fill(ds);\n\n                List&lt;AddInventoryModel&gt; refNumList = new List&lt;AddInventoryModel&gt;();\n                for (int i = 0; i &lt; ds.Tables[0].Rows.Count; i++)\n                {\n                    AddInventoryModel robj = new AddInventoryModel();\n                    robj.referenceNumber = ds.Tables[0].Rows[i][\"num\"].ToString();\n                    refNumList.Add(robj);\n                }\n                Adi.refNumDD = refNumList;\n            }\n            connfb.Close();\n</code></pre>\n\n<p><strong>Model</strong></p>\n\n<pre><code> public class AddInventoryModel\n    {\n    [Display(Name = \"1. Reference Number: \")]\n        [Required(ErrorMessage = \"Reference Number is required!\")]\n        public string referenceNumber { get; set; }\n\n    public List&lt;AddInventoryModel&gt; refNumDD { get; set; }\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>@Html.ValidationSummary(true, \"\", new { @class = \"text-danger\" })\n    &lt;div class=\"form-group\"&gt;\n        @Html.LabelFor(model =&gt; model.referenceNumber, htmlAttributes: new { @class = \"control-label col-md-100\" })\n        &lt;div class=\"col-md-20\"&gt;\n            @Html.DropDownListFor(model =&gt; model.referenceNumber, new SelectList(Model.refNumDD, \"referenceNumber\"), \"Choose reference number\")\n        &lt;/div&gt;\n    &lt;/div&gt;\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", "dynamic", "asp.net-core-webapi"], "comments": [{"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1534956574, "post_id": 51971527, "comment_id": 90893772, "body": "Sort of like how OData works?"}, {"owner": {"reputation": 51674, "user_id": 455493, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ub5uS.jpg?s=128&g=1", "display_name": "Tseng", "link": "https://stackoverflow.com/users/455493/tseng"}, "edited": false, "score": 0, "creation_date": 1534956694, "post_id": 51971527, "comment_id": 90893824, "body": "Why not fetch the data first, and then filter out the properties you don&#39;t want on the expando object?"}, {"owner": {"reputation": 51674, "user_id": 455493, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ub5uS.jpg?s=128&g=1", "display_name": "Tseng", "link": "https://stackoverflow.com/users/455493/tseng"}, "edited": false, "score": 0, "creation_date": 1534956758, "post_id": 51971527, "comment_id": 90893854, "body": "Otherwise you will have to choose the hard, non-trivial way to implement it: Building of dynamic Expression Trees (the way LINQ works and gets translated into by the compiler) using reflection and the Expression classes. See <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/expression-trees\" rel=\"nofollow noreferrer\">Expression Trees</a>"}, {"owner": {"reputation": 130, "user_id": 2642777, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3e7796484263c5804995a8bfb8fb9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Robert K", "link": "https://stackoverflow.com/users/2642777/robert-k"}, "reply_to_user": {"reputation": 51674, "user_id": 455493, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ub5uS.jpg?s=128&g=1", "display_name": "Tseng", "link": "https://stackoverflow.com/users/455493/tseng"}, "edited": false, "score": 0, "creation_date": 1534957106, "post_id": 51971527, "comment_id": 90894030, "body": "@Tseng Cause you could have a very large set of information. Maybe not in the workers  example but in another scenario."}, {"owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "edited": false, "score": 0, "creation_date": 1534957236, "post_id": 51971527, "comment_id": 90894102, "body": "Why not just write a SQL query and load the results into a DataTable, instead of a LINQ expression returning a type?  ADO.NET supports this scenario pretty well, and nothing at the EF level really does."}, {"owner": {"reputation": 51674, "user_id": 455493, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ub5uS.jpg?s=128&g=1", "display_name": "Tseng", "link": "https://stackoverflow.com/users/455493/tseng"}, "edited": false, "score": 0, "creation_date": 1534957874, "post_id": 51971527, "comment_id": 90894426, "body": "Well, then you are out of luck. Consider using raw queries (still use prepared statements/sql injection save code) and bind to and dto or use a micro orm such as dapper for that task. Or even plain old ADO.NET. As you can  <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/expression-trees-building#creating-nodes\" rel=\"nofollow noreferrer\">see here</a>, expression trees are rather expressive (no pun intended). For a very simple lambda you 4 expressions and you need to build them in reverse (starting with the leaves and building up to the root) if you would want to get that working with ef core/linq"}, {"owner": {"reputation": 51674, "user_id": 455493, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ub5uS.jpg?s=128&g=1", "display_name": "Tseng", "link": "https://stackoverflow.com/users/455493/tseng"}, "edited": false, "score": 0, "creation_date": 1534958084, "post_id": 51971527, "comment_id": 90894521, "body": "Or... mhh you could try to use the <a href=\"https://docs.microsoft.com/en-us/ef/core/modeling/shadow-properties\" rel=\"nofollow noreferrer\">shadow properties</a> of EF Core, but that&#39;s not really clean neither, i.e. using <code>b =&gt; EF.Property&lt;DateTime&gt;(b, &quot;LastUpdated&quot;)</code>, not sure that works with anonymous classes though"}, {"owner": {"reputation": 51674, "user_id": 455493, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ub5uS.jpg?s=128&g=1", "display_name": "Tseng", "link": "https://stackoverflow.com/users/455493/tseng"}, "edited": false, "score": 0, "creation_date": 1534958481, "post_id": 51971527, "comment_id": 90894696, "body": "Also some GIST example I just found on how to build an anonymous class with expression trees. <a href=\"https://gist.github.com/dcastro/9093000\" rel=\"nofollow noreferrer\">gist.github.com/dcastro/9093000</a> But like I said, non-trivial code to get right and it gets quite complex for simple expressions with a few instructions"}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 10238974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HSld1.jpg?s=128&g=1", "display_name": "PWND", "link": "https://stackoverflow.com/users/10238974/pwnd"}, "is_accepted": false, "score": 0, "last_activity_date": 1534957016, "creation_date": 1534957016, "answer_id": 51971764, "question_id": 51971527, "link": "https://stackoverflow.com/questions/51971527/create-a-dynamic-dto/51971764#51971764", "title": "Create a dynamic DTO", "body": "<p>We don't know your case, maybe use Directory  is better? But you can use this code:</p>\n\n<pre><code>        List&lt;string&gt; lstDummyFields = new List&lt;string&gt;\n        {\n            \"idWorker\",\n            \"first_name\",\n            \"last_name\",\n            \"birthday\",\n            \"adress\"\n        };\n\n        dynamic dto = new ExpandoObject();\n        foreach (var p in lstDummyFields)\n        {\n            ((IDictionary&lt;String, Object&gt;)dto).Add(new KeyValuePair&lt;string, object&gt;( p, null));\n        }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1534957422, "creation_date": 1534957422, "answer_id": 51971870, "question_id": 51971527, "link": "https://stackoverflow.com/questions/51971527/create-a-dynamic-dto/51971870#51971870", "title": "Create a dynamic DTO", "body": "<p>Use <a href=\"http://odata.github.io/RESTier/\" rel=\"nofollow noreferrer\">Restier</a>.  It's a wrapper around <a href=\"https://www.odata.org/getting-started/understand-odata-in-6-steps/\" rel=\"nofollow noreferrer\">OData</a> (in 2 lines of code !) that means you can call the API with things like:</p>\n\n<pre><code>http://services.odata.org/v4/TripPinServiceRW/People?$top=2&amp;$select=FirstName,LastName&amp;$filter=Trips/any(d:d/Budget gt 3000)\n</code></pre>\n\n<p>Which is a dynamic query, filter, and field selection.</p>\n"}], "owner": {"reputation": 130, "user_id": 2642777, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3e7796484263c5804995a8bfb8fb9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Robert K", "link": "https://stackoverflow.com/users/2642777/robert-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1392, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1534957957, "creation_date": 1534956127, "last_edit_date": 1534957957, "question_id": 51971527, "link": "https://stackoverflow.com/questions/51971527/create-a-dynamic-dto", "title": "Create a dynamic DTO", "body": "<p>Im trying to implement a dynamic dto. First there will be a information manager where you can select the fields you want to return by the WebApi.</p>\n\n<p>Later in the api you send a request to an endpoint with  the  DTO's Id you want. This method will recive the info, query it in the db and  obtain the fields that integrate the DTO(dynamic number of fields):</p>\n\n<pre><code>   [Route(\"api/workers\")]\n    public IEnumerable&lt;object&gt; GetWorkers([FromRoute] string idEnterprise,int idDTO)\n    {\n        //lstDummyFields = _context.Dtos.Include(\"DtoFields\").\n           //Where(n=&gt;n.idDto==idDTO).select(n=&gt;n.DtoFields.name).ToList();\n\n        //The property will look like this, the selected dto could have different properties(dynamic) but always call the same as the entity name fields\n        List&lt;string&gt; lstDummyFields = new List&lt;string&gt;\n        {\n            \"idWorker\",\n            \"first_name\",\n            \"last_name\",\n            \"birthday\",\n            \"adress\"\n        };\n\n        dynamic dto = new ExpandoObject() as IDictionary&lt;string,object&gt;;\n        foreach (var p in lstDummyProperty)\n        {\n            dto.Add(p, null);\n        }\n\n\n        return _context.workers.Where(n=&gt;n.IdEnterprise==idEnterprise).select.(new { ???? }) .ToList();\n    }\n</code></pre>\n\n<p>I dont know how to implement the select clause.Could be related to this post but its sligtly different.</p>\n\n<p><a href=\"https://stackoverflow.com/a/34726946/2642777\">https://stackoverflow.com/a/34726946/2642777</a></p>\n\n<p>I'm close to the answer or im going the wrong way? Could throw some help to solve this please.</p>\n"}, {"tags": ["c#", "asp.net", "sql-view", "notsupportedexception"], "comments": [{"owner": {"reputation": 3697, "user_id": 5484067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSbcB.jpg?s=128&g=1", "display_name": "Mohsin Mehmood", "link": "https://stackoverflow.com/users/5484067/mohsin-mehmood"}, "edited": false, "score": 0, "creation_date": 1534958469, "post_id": 51971524, "comment_id": 90894691, "body": "<code>somedb.vx_EligibilitySearch</code> what is <code>vx_EligibilitySearch</code> mapping to in the backend database? Is it some view?"}, {"owner": {"reputation": 91, "user_id": 10225695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176899c88b5e59c3ca17cfee89f411f5?s=128&d=identicon&r=PG&f=1", "display_name": "seesharp", "link": "https://stackoverflow.com/users/10225695/seesharp"}, "reply_to_user": {"reputation": 3697, "user_id": 5484067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSbcB.jpg?s=128&g=1", "display_name": "Mohsin Mehmood", "link": "https://stackoverflow.com/users/5484067/mohsin-mehmood"}, "edited": false, "score": 0, "creation_date": 1534958712, "post_id": 51971524, "comment_id": 90894793, "body": "Yes there is a View in SQL Server with that name"}, {"owner": {"reputation": 3697, "user_id": 5484067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSbcB.jpg?s=128&g=1", "display_name": "Mohsin Mehmood", "link": "https://stackoverflow.com/users/5484067/mohsin-mehmood"}, "edited": false, "score": 0, "creation_date": 1534958986, "post_id": 51971524, "comment_id": 90894913, "body": "Are you using Entity Framework core? Ensure your view returns Alternate_ID column. Share code related to how SQL View is mapped to <code>vx_EligibilitySearch</code> class?"}, {"owner": {"reputation": 91, "user_id": 10225695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176899c88b5e59c3ca17cfee89f411f5?s=128&d=identicon&r=PG&f=1", "display_name": "seesharp", "link": "https://stackoverflow.com/users/10225695/seesharp"}, "reply_to_user": {"reputation": 3697, "user_id": 5484067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSbcB.jpg?s=128&g=1", "display_name": "Mohsin Mehmood", "link": "https://stackoverflow.com/users/5484067/mohsin-mehmood"}, "edited": false, "score": 0, "creation_date": 1534960613, "post_id": 51971524, "comment_id": 90895689, "body": "I have EntityFramework in the References. I added some more of the vx_EligibilitySearch.cs at the bottom. Is this what you were looking for?"}, {"owner": {"reputation": 3697, "user_id": 5484067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSbcB.jpg?s=128&g=1", "display_name": "Mohsin Mehmood", "link": "https://stackoverflow.com/users/5484067/mohsin-mehmood"}, "edited": false, "score": 0, "creation_date": 1534961012, "post_id": 51971524, "comment_id": 90895848, "body": "Does <code>vx_EligibilitySearch</code> returns <code>Alternate_ID</code> column when you select from this view? Also, can you share your DbContext class <code>somedb</code> code?"}, {"owner": {"reputation": 91, "user_id": 10225695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176899c88b5e59c3ca17cfee89f411f5?s=128&d=identicon&r=PG&f=1", "display_name": "seesharp", "link": "https://stackoverflow.com/users/10225695/seesharp"}, "reply_to_user": {"reputation": 3697, "user_id": 5484067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lSbcB.jpg?s=128&g=1", "display_name": "Mohsin Mehmood", "link": "https://stackoverflow.com/users/5484067/mohsin-mehmood"}, "edited": false, "score": 0, "creation_date": 1534961534, "post_id": 51971524, "comment_id": 90896069, "body": "When I run that View in SQL Server it returns data. I just added DbContext to the post"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 10225695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176899c88b5e59c3ca17cfee89f411f5?s=128&d=identicon&r=PG&f=1", "display_name": "seesharp", "link": "https://stackoverflow.com/users/10225695/seesharp"}, "edited": false, "score": 0, "creation_date": 1534969082, "post_id": 51972828, "comment_id": 90899410, "body": "I&#39;m not sure I understand your comment. How would you not be able to read from a View? Why would they exist if they cant be used. Isn&#39;t this saying the opposite ? <a href=\"https://www.mssqltips.com/sqlservertip/1990/how-to-use-sql-server-views-with-the-entity-framework/\" rel=\"nofollow noreferrer\">mssqltips.com/sqlservertip/1990/&hellip;</a>"}], "tags": [], "owner": {"reputation": 657, "user_id": 5818897, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jwx9SMSRrOY/AAAAAAAAAAI/AAAAAAAAA6U/w29XkaKXWSc/photo.jpg?sz=128", "display_name": "Agnel Amodia", "link": "https://stackoverflow.com/users/5818897/agnel-amodia"}, "is_accepted": false, "score": 0, "last_activity_date": 1534961542, "creation_date": 1534961542, "answer_id": 51972828, "question_id": 51971524, "link": "https://stackoverflow.com/questions/51971524/display-data-from-sql-view-into-a-listview-on-an-asp-net-page-error-notsuppor/51972828#51972828", "title": "Display data from SQL View into a ListView on an ASP.net page | Error: NotSupportedException", "body": "<p>You cannot do object comparison inside the Entity Framework query because EF need to convert your LINQ statements  to SQL Queries in order to perform any actions(query).</p>\n"}], "owner": {"reputation": 91, "user_id": 10225695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176899c88b5e59c3ca17cfee89f411f5?s=128&d=identicon&r=PG&f=1", "display_name": "seesharp", "link": "https://stackoverflow.com/users/10225695/seesharp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534961728, "creation_date": 1534956120, "last_edit_date": 1534961728, "question_id": 51971524, "link": "https://stackoverflow.com/questions/51971524/display-data-from-sql-view-into-a-listview-on-an-asp-net-page-error-notsuppor", "title": "Display data from SQL View into a ListView on an ASP.net page | Error: NotSupportedException", "body": "<p><strong>Goal</strong>: Display data from SQL View into a ListView on an asp.net page\nThere is a new database with a new view and I need to point it to that</p>\n\n<p><strong>ERROR</strong>:</p>\n\n<p>System.Reflection.TargetInvocationException: 'Exception has been thrown by the target of an invocation.'\nInner Exception\nNotSupportedException: The specified type member 'Alternate_ID' is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported.</p>\n\n<p>System.InvalidOperationException: 'When the DataBoundControl has paging enabled, either the SelectMethod should return an IQueryable or should have all these mandatory parameters : int startRowIndex, int maximumRows, out int totalRowCount'</p>\n\n<p><strong>Tried:</strong>\nI've looked through the tutorials on listview, documentation, itemtype, data binding, etc. One of the SO I found was : <a href=\"https://stackoverflow.com/questions/11584660/the-specified-type-member-is-not-supported-in-linq-to-entities-only-initializer\">The specified type member is not supported in LINQ to Entities. Only initializers, entity members, and entity navigation properties are supported</a>\nIve looked into the models, views, checked spelling, designer files, pocos, etc.</p>\n\n<p><strong>CODE:</strong></p>\n\n<p><em>default.aspx</em>:</p>\n\n<pre><code> &lt;asp:ListView id=\"lstClaims\" runat=\"server\" ItemType=\"Placeholder.Data.vx_EligibilitySearch\" SelectMethod=\"lstMembers_GetData\" OnItemCommand=\"lstMembers_ItemCommand\" \n        ItemPlaceholderID=\"litPlaceHolder\"&gt;\n &lt;LayoutTemplate&gt;\n            &lt;div class=\"table-responsive\"&gt;\n                &lt;table class=\"table\"&gt;\n                    &lt;thead&gt;\n                        &lt;tr&gt;\n                            &lt;th&gt;&lt;/th&gt;\n                            &lt;th&gt;&lt;asp:LinkButton id=\"Sort_Claim_Number\" runat=\"server\" CommandArgument=\"Group_Description\" CommandName=\"Sort\"&gt;Group&lt;/asp:LinkButton&gt;&lt;/th&gt;\n                            &lt;th&gt;&lt;asp:LinkButton id=\"Sort_Claim_Status\" runat=\"server\" CommandArgument=\"Group_ID\" CommandName=\"Sort\"&gt;Group ID&lt;/asp:LinkButton&gt;&lt;/th&gt;\n                            &lt;th&gt;&lt;asp:LinkButton id=\"Sort_Plan\" runat=\"server\" CommandArgument=\"Alternate_ID\" CommandName=\"Sort\"&gt;Member ID&lt;/asp:LinkButton&gt;&lt;/th&gt;\n\n&lt;/thead&gt;\n                    &lt;asp:Literal ID=\"litPlaceHolder\" runat=\"server\" /&gt;\n                &lt;/table&gt;\n            &lt;/div&gt;\n        &lt;/LayoutTemplate&gt;\n\n\n\n &lt;ItemTemplate&gt;\n            &lt;tr&gt;\n                &lt;td&gt;&lt;%# Item.Group_Description %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%# Item.Group_ID %&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;%# Item.Alternate_ID %&gt;&lt;/td&gt;\n\n  &lt;/tr&gt;\n        &lt;/ItemTemplate&gt;\n    &lt;/asp:ListView&gt;\n</code></pre>\n\n<p>Note: protected global::System.Web.UI.WebControls.ListView lstClaims; is in default.aspx.designer.cs</p>\n\n<p>This points to [ lstClaims.DataBind(); ] :</p>\n\n<pre><code>  if (memberIDIsValid || memberIsValid)\n            {\n                ShouldSearch = true;\n                lstClaims.DataBind();\n            }\n</code></pre>\n\n<p>This is in the method: \nlnkSearch_Click, which is called from the aspx page here (When clicking the Search button):</p>\n\n<pre><code>&lt;p&gt;&lt;asp:LinkButton ID=\"lnkSearch\" runat=\"server\" OnClick=\"lnkSearch_Click\" CssClass=\"btn btn-default\"&gt;&lt;i class=\"fa fa-search\"&gt;&lt;/i&gt; Search Members&lt;/asp:LinkButton&gt;&lt;/p&gt;\n</code></pre>\n\n<p>Method to get Data:</p>\n\n<pre><code>public IQueryable&lt;vx_EligibilitySearch&gt; lstMembers_GetData()\n        {\n            litNumSearchResults.Text = \"\";\n\n            // IQueryable&lt;Member&gt; members = null;\n            IQueryable&lt;vx_EligibilitySearch&gt; members = null;\n\n\n            try\n            {\n                if (!ShouldSearch)\n                    return members;\n\n                panelSearchForm.Visible = false;\n                lnkButtonBackToSearch.Visible = true;\n\n                members = GetDataFromQuery();\n\n\npublic IQueryable&lt;vx_EligibilitySearch&gt; GetDataFromQuery()  \n        {\n            // IQueryable&lt;Member&gt; members = null;\n            IQueryable&lt;vx_EligibilitySearch&gt; members = null;\n\n\n\n            try\n            {\n                // members = somedb.Members.AsNoTracking().AsQueryable(); //.OrderBy(a =&gt; a.Claim_Number)\n                members = somedb.vx_EligibilitySearch.AsNoTracking().AsQueryable(); //.OrderBy(a =&gt; a.Claim_Number)\n\n\n                if (!string.IsNullOrEmpty(Search_MemberID))\n                    // members = members.Where(m =&gt; m.Subscriber_ID == Search_MemberID).AsQueryable();\n                    members = members.Where(m =&gt; m.Alternate_ID == Search_MemberID).AsQueryable();\n</code></pre>\n\n<p>In partial class vx_EligibilitySearch I have:</p>\n\n<pre><code>public string Alternate_ID { get; set; }\n</code></pre>\n\n<p>More:</p>\n\n<pre><code>namespace Placeholder.Data\n{\n    using System;\n    using System.Collections.Generic;\n\n    public partial class vx_EligibilitySearch\n    {\n        public string Subscriber_ID { get; set; }\n\n\n        public string Group_Description { get; set; }\n        public string Group_ID { get; set; }\n        public string Alternate_ID { get; set; }\n        public string Member_Name { get; set; }\n        public string Sex { get; set; }\n        public Nullable&lt;System.DateTime&gt; Birth_Date { get; set; }\n</code></pre>\n\n<p>DbContext :</p>\n\n<pre><code>members = somedb.vx_EligibilitySearch.AsNoTracking().AsQueryable(); //.OrderBy(a =&gt; a.Claim_Number)\n</code></pre>\n\n<p>Going to Definition of somedb takes me to BasePage.cs with:</p>\n\n<pre><code>protected VBADemoEntities somedb = new VBADemoEntities();\n</code></pre>\n\n<p>When I go to definition of VBADemoEntities:</p>\n\n<pre><code>namespace Placeholder.Data\n\npublic partial class VBADemoEntities : DbContext\n    {\n        public VBADemoEntities()\n            : base(\"name=VBADemoEntities\")\n        {\n        }\n\n        protected override void OnModelCreating(DbModelBuilder modelBuilder)\n        {\n            throw new UnintentionalCodeFirstException();\n        }\n\n        public virtual DbSet&lt;Auth&gt; Auths { get; set; }\n        ...........\n        public virtual DbSet&lt;Member&gt; Members { get; set; }\n        public virtual DbSet&lt;vx_EligibilitySearch&gt; vx_EligibilitySearch { get; set; }\n</code></pre>\n"}, {"tags": ["c#", ".net", "windows", "encryption", "dpapi"], "comments": [{"owner": {"reputation": 35071, "user_id": 316799, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0fa8da5d4aacf3078d23d33c4effadd5?s=128&d=identicon&r=PG", "display_name": "Felipe Oriani", "link": "https://stackoverflow.com/users/316799/felipe-oriani"}, "edited": false, "score": 0, "creation_date": 1534956628, "post_id": 51971447, "comment_id": 90893796, "body": "See the soureCode: <a href=\"https://github.com/dotnet/corefx/blob/master/src/System.Security.Cryptography.ProtectedData/src/System/Security/Cryptography/ProtectedData.cs\" rel=\"nofollow noreferrer\">github.com/dotnet/corefx/blob/master/src/&hellip;</a>"}, {"owner": {"reputation": 21664, "user_id": 26742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55b3f0161d8b3b4f573a655679220d?s=128&d=identicon&r=PG", "display_name": "Sani Singh Huttunen", "link": "https://stackoverflow.com/users/26742/sani-singh-huttunen"}, "reply_to_user": {"reputation": 35071, "user_id": 316799, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0fa8da5d4aacf3078d23d33c4effadd5?s=128&d=identicon&r=PG", "display_name": "Felipe Oriani", "link": "https://stackoverflow.com/users/316799/felipe-oriani"}, "edited": false, "score": 0, "creation_date": 1534956965, "post_id": 51971447, "comment_id": 90893953, "body": "@FelipeOriani: No such information in the source for ProtectData since it&#39;s calling CryptProtectData by interop. You&#39;ll need to look in the source of Crypt32 to determine the algorithm. However there is documentation that explains all without the need of looking in the source code."}], "answers": [{"comments": [{"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534956889, "post_id": 51971636, "comment_id": 90893916, "body": "Thanks, this helps a lot."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 1, "creation_date": 1534956895, "post_id": 51971636, "comment_id": 90893920, "body": "The only problem with this answer is the extraneous and possibly misleading adjectives &quot;strong&quot; and &quot;proven&quot;. It makes it seem like a marketing blurb."}, {"owner": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "edited": false, "score": 1, "creation_date": 1534956911, "post_id": 51971636, "comment_id": 90893929, "body": "SHA-1 is strong?? It&#39;s considered <code>broken</code> in cryptographic standards as of last year (2017)"}, {"owner": {"reputation": 21664, "user_id": 26742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55b3f0161d8b3b4f573a655679220d?s=128&d=identicon&r=PG", "display_name": "Sani Singh Huttunen", "link": "https://stackoverflow.com/users/26742/sani-singh-huttunen"}, "edited": false, "score": 0, "creation_date": 1534957020, "post_id": 51971636, "comment_id": 90893991, "body": "Any text in the answer (except first line) is directly from the linked source. You&#39;d see that if you&#39;d bothered to read the linked article. Which by the way is from 2001."}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "reply_to_user": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "edited": false, "score": 2, "creation_date": 1534959341, "post_id": 51971636, "comment_id": 90895083, "body": "@StenPetrov It seems unreasonable to me to criticize/downvote the answer because you disagree with Microsoft&#39;s implementation. The answer&#39;s summarizing the relevant parts of Microsoft&#39;s documentation on the topic (which is exactly what the question was asking for - this piece of documentation ended up being surprisingly hard to locate)."}, {"owner": {"reputation": 21664, "user_id": 26742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55b3f0161d8b3b4f573a655679220d?s=128&d=identicon&r=PG", "display_name": "Sani Singh Huttunen", "link": "https://stackoverflow.com/users/26742/sani-singh-huttunen"}, "reply_to_user": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534962253, "post_id": 51971636, "comment_id": 90896401, "body": "@EJoshuaS: Found some more information on DPAPI and updated the answer."}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1534963366, "post_id": 51971636, "comment_id": 90896878, "body": "@SaniSinghHuttunen Thanks"}, {"owner": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "reply_to_user": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1534990075, "post_id": 51971636, "comment_id": 90904880, "body": "@EJoshuaS picking up any article about crypto that is more than a couple years old and citing it without thinking is downright irresponsible, making the OP and others (1) consider DPAPI secure because of marketing language from 2001 and (2) consider SHA-1 secure"}, {"owner": {"reputation": 21664, "user_id": 26742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55b3f0161d8b3b4f573a655679220d?s=128&d=identicon&r=PG", "display_name": "Sani Singh Huttunen", "link": "https://stackoverflow.com/users/26742/sani-singh-huttunen"}, "reply_to_user": {"reputation": 10288, "user_id": 1416035, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/7ue1e.png?s=128&g=1", "display_name": "Sten Petrov", "link": "https://stackoverflow.com/users/1416035/sten-petrov"}, "edited": false, "score": 0, "creation_date": 1535002384, "post_id": 51971636, "comment_id": 90907476, "body": "@StenPetrov: That wasn&#39;t the question at all. The question was for information on the inner workings of DPAPI."}], "tags": [], "owner": {"reputation": 21664, "user_id": 26742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e55b3f0161d8b3b4f573a655679220d?s=128&d=identicon&r=PG", "display_name": "Sani Singh Huttunen", "link": "https://stackoverflow.com/users/26742/sani-singh-huttunen"}, "is_accepted": true, "score": 2, "last_activity_date": 1534962002, "last_edit_date": 1534962002, "creation_date": 1534956539, "answer_id": 51971636, "question_id": 51971447, "link": "https://stackoverflow.com/questions/51971447/which-encryption-algorithm-does-the-protectdata-class-use/51971636#51971636", "title": "Which encryption algorithm does the ProtectData class use?", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/ms995355.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">DPAPI</a> uses Triple-DES.</p>\n\n<blockquote>\n  <ul>\n  <li>It uses proven cryptographic routines, such as the strong Triple-DES algorithm in CBC mode, the strong SHA-1 algorithm, and the PBKDF2 password-based key derivation routine.</li>\n  <li>It uses proven cryptographic constructs to protect data. All critical data is cryptographically integrity protected, and secret data is wrapped by using standard methods.</li>\n  <li>It uses large secret sizes to greatly reduce the possibility of brute-force attacks to compromise the secrets.</li>\n  <li>It uses PBKDF2 with 4000 iterations to increase the work factor of an adversary trying to compromise the password.</li>\n  <li>It sanity checks MasterKey expiration dates.</li>\n  <li>It protects all required network communication with Domain Controllers by using mutually authenticated and privacy protected RPC channels.</li>\n  <li>It minimizes the risk of exposing any secrets, by never writing them to disk and minimizing their exposure in swappable RAM.</li>\n  <li>It requires Administrator privileges to make any modifications to the DPAPI parameters in the registry.</li>\n  <li>It uses Windows File Protection to help protect all critical DLLs from online changes even by processes with Administrator privileges.</li>\n  </ul>\n  \n  <p>DPAPI initially generates a strong key called a MasterKey, which is\n  protected by the user's password. DPAPI uses a standard cryptographic\n  process called Password-Based Key Derivation, described in PKCS #5, to\n  generate a key from the password. This password-derived key is then\n  used with Triple-DES to encrypt the MasterKey, which is finally stored\n  in the user's profile directory.</p>\n</blockquote>\n\n<p>However, according to <a href=\"https://www.passcape.com/index.php?section=docsys&amp;cmd=details&amp;id=28#14\" rel=\"nofollow noreferrer\">Passcape</a>, DPAPI uses AES256. Atleast on Windows 7.</p>\n\n<blockquote>\n  <ul>\n  <li>DPAPI uses proven cryptographic algorithms. For example, Windows 7 by default uses the AES256 encryption in the CBC mode, SHA512 for hashing and PBKDF2 as password-based key derivation routine.</li>\n  </ul>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/JAY4M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JAY4M.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1214, "favorite_count": 1, "accepted_answer_id": 51971636, "answer_count": 1, "score": 2, "last_activity_date": 1534962002, "creation_date": 1534955836, "question_id": 51971447, "link": "https://stackoverflow.com/questions/51971447/which-encryption-algorithm-does-the-protectdata-class-use", "title": "Which encryption algorithm does the ProtectData class use?", "body": "<p>I'm aware that the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.protecteddata?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">ProtectedData</a> class ends up calling Windows's Data Protection API (DPAPI). The <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectdata\" rel=\"nofollow noreferrer\">documentation on the DPAPI function</a> provides details like where the key is stored, who can decrypt the data, etc. However, I haven't been able to find any documentation on what the actual underlying encryption algorithm is. (I need to know the details of the protection method for security documentation for an upcoming audit). Is this just using AES or something like that? How secure is this?</p>\n"}, {"tags": ["c#"], "answers": [{"comments": [{"owner": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "edited": false, "score": 0, "creation_date": 1534956380, "post_id": 51971490, "comment_id": 90893669, "body": "<code>IsNullOrWhiteSpace</code> doesn&#39;t &quot;remove&quot; anything"}, {"owner": {"reputation": 61863, "user_id": 133910, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f1b913d48f914347dcafabff8d01ded?s=128&d=identicon&r=PG", "display_name": "Yuriy Faktorovich", "link": "https://stackoverflow.com/users/133910/yuriy-faktorovich"}, "reply_to_user": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "edited": false, "score": 0, "creation_date": 1534957124, "post_id": 51971490, "comment_id": 90894041, "body": "@spender reworded"}], "tags": [], "owner": {"reputation": 61863, "user_id": 133910, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f1b913d48f914347dcafabff8d01ded?s=128&d=identicon&r=PG", "display_name": "Yuriy Faktorovich", "link": "https://stackoverflow.com/users/133910/yuriy-faktorovich"}, "is_accepted": false, "score": 8, "last_activity_date": 1534957116, "last_edit_date": 1534957116, "creation_date": 1534955980, "answer_id": 51971490, "question_id": 51971435, "link": "https://stackoverflow.com/questions/51971435/how-to-remove-empty-item-from-liststring/51971490#51971490", "title": "How to remove empty item from List&lt;string&gt;?", "body": "<pre><code>list.RemoveAll(string.IsNullOrWhiteSpace);\n</code></pre>\n\n<p>Although be careful, <code>IsNullOrWhiteSpace</code> checks for more than just spaces. For the full list check <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.char.iswhitespace?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/api/system.char.iswhitespace?view=netframework-4.7.2</a></p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 10260810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9cc17c57f5e05835dbea0c3029c1277?s=128&d=identicon&r=PG&f=1", "display_name": "aleks", "link": "https://stackoverflow.com/users/10260810/aleks"}, "edited": false, "score": 0, "creation_date": 1534956106, "post_id": 51971496, "comment_id": 90893521, "body": "oh, and is it possible to do something like this? if(list[i].contains(Regex.Matches(something)))?"}, {"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "reply_to_user": {"reputation": 41, "user_id": 10260810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9cc17c57f5e05835dbea0c3029c1277?s=128&d=identicon&r=PG&f=1", "display_name": "aleks", "link": "https://stackoverflow.com/users/10260810/aleks"}, "edited": false, "score": 0, "creation_date": 1534957367, "post_id": 51971496, "comment_id": 90894177, "body": "@Daniel - Sure you could use regex, but general rule of thumb should be to avoid it if you can (and I mean <i>very</i> general rule, it obviously has it&#39;s uses). Especially with something so simple it&#39;s just not necessary. I&#39;d also assume it doesn&#39;t perform as well."}], "tags": [], "owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "is_accepted": false, "score": 2, "last_activity_date": 1534956000, "creation_date": 1534956000, "answer_id": 51971496, "question_id": 51971435, "link": "https://stackoverflow.com/questions/51971435/how-to-remove-empty-item-from-liststring/51971496#51971496", "title": "How to remove empty item from List&lt;string&gt;?", "body": "<p>You don't need regex for this, you can use <code>string.IsNullOrWhiteSpace</code> method.</p>\n\n<pre><code>foreach(var item in list)\n{\n    if(!string.IsNullOrWhiteSpace(item))\n    {\n        list1.Add(item);\n    }\n}\n</code></pre>\n\n<p>Another way to do it with LINQ:</p>\n\n<pre><code>var filteredList = list.Where(x =&gt; !string.IsNullOrWhiteSpace(x)).ToList();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 10238974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HSld1.jpg?s=128&g=1", "display_name": "PWND", "link": "https://stackoverflow.com/users/10238974/pwnd"}, "is_accepted": false, "score": 0, "last_activity_date": 1534956249, "creation_date": 1534956249, "answer_id": 51971560, "question_id": 51971435, "link": "https://stackoverflow.com/questions/51971435/how-to-remove-empty-item-from-liststring/51971560#51971560", "title": "How to remove empty item from List&lt;string&gt;?", "body": "<p>You can use method string.IsNullOrWhiteSpace()</p>\n\n<pre><code>        List&lt;string&gt; listWithEmtyAndNullElements = new List&lt;string&gt;\n            { \"\",\n              \" \",\n              \"Hi\",\n              \"Stack     \",\n              \"    Overflow\",\n                null\n            };\n\n        List&lt;string&gt; onlyStringList = new List&lt;string&gt;();\n\n        for (int i = 0; i &lt; listWithEmtyAndNullElements.Count; i++)\n        {\n            if (!string.IsNullOrWhiteSpace(listWithEmtyAndNullElements[i]))\n            {\n                onlyStringList.Add(listWithEmtyAndNullElements[i]);\n            }\n         }\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10260810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9cc17c57f5e05835dbea0c3029c1277?s=128&d=identicon&r=PG&f=1", "display_name": "aleks", "link": "https://stackoverflow.com/users/10260810/aleks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1534960458, "creation_date": 1534955785, "last_edit_date": 1534960458, "question_id": 51971435, "link": "https://stackoverflow.com/questions/51971435/how-to-remove-empty-item-from-liststring", "title": "How to remove empty item from List&lt;string&gt;?", "body": "<p>I have been trying for some time to remove empty items from List, what I mean:</p>\n\n<pre><code>list1.Add(\"1\")\nlist1.Add(\"\")\nlist1.Add(\"  \")\nlist1.Add(\"2\")\n</code></pre>\n\n<p>OutPut:\n1\n2</p>\n\n<p>Here is what I tried:</p>\n\n<pre><code>List&lt;string&gt; list = new List&lt;string&gt;();\nList&lt;string&gt; list1 = new List&lt;string&gt;();\nlist.Add(\"1  3\");\nlist.Add(\"     \");\nlist.Add(\"        \");\nlist.Add(\"2\");\nfor(int i = 0; i &lt; list.Count(); i++)\n{\n    MatchCollection mc = Regex.Matches(list[i], @\"\\s\");\n    foreach(Match m in mc)\n    {\n        if (!list.Contains(m.ToString()))\n            list1.Add(m.ToString());\n    }\n}\n</code></pre>\n\n<p>I new to programming so I sorry if this question is bad</p>\n"}, {"tags": ["c#", "mongodb"], "comments": [{"owner": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "edited": false, "score": 0, "creation_date": 1534965741, "post_id": 51971351, "comment_id": 90897965, "body": "Based on the version you mentioned you seem to be using the pretty dead legacy driver. May I suggest an upgrade? <a href=\"https://www.nuget.org/packages/MongoDB.Driver/\" rel=\"nofollow noreferrer\">nuget.org/packages/MongoDB.Driver</a>"}, {"owner": {"reputation": 26064, "user_id": 338068, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4cb6a6a3ccc0d568a0944a6655e22803?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/338068/chris"}, "reply_to_user": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "edited": false, "score": 0, "creation_date": 1534982596, "post_id": 51971351, "comment_id": 90903481, "body": "@dnickless: Yeah, I know its an old version (which is why i quoted the version). You know what its like finding time to upgrade - it works now so why spend the time? :) I may see if I can get it onto our dev schedule again though. Especially if it can do this better. :)"}], "answers": [{"comments": [{"owner": {"reputation": 26064, "user_id": 338068, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4cb6a6a3ccc0d568a0944a6655e22803?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/338068/chris"}, "edited": false, "score": 0, "creation_date": 1535013744, "post_id": 51978678, "comment_id": 90912922, "body": "Cool. I was expecting something like <code>{ &quot;Things.Value&quot; : &quot;bar&quot; }</code> but apparently that is equivalent to what you have (according to <a href=\"https://docs.mongodb.com/manual/reference/operator/query/elemMatch/#single-query-condition\" rel=\"nofollow noreferrer\">docs.mongodb.com/manual/reference/operator/query/elemMatch/&hellip;</a> ). I assume it will treat them exactly the same."}], "tags": [], "owner": {"reputation": 9279, "user_id": 6440033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f070f5eb58ce80fa0b975a805e712362?s=128&d=identicon&r=PG&f=1", "display_name": "dnickless", "link": "https://stackoverflow.com/users/6440033/dnickless"}, "is_accepted": true, "score": 2, "last_activity_date": 1535000866, "creation_date": 1535000866, "answer_id": 51978678, "question_id": 51971351, "link": "https://stackoverflow.com/questions/51971351/how-to-query-collection-using-generic-query-builder/51978678#51978678", "title": "How to query collection using generic query builder", "body": "<p>Using this version of the driver, the following query</p>\n\n<pre><code>var query = Query&lt;RootObject&gt;.ElemMatch(x =&gt; x.Things, x =&gt; x.EQ(y =&gt; y.Value, \"bar\"));\n</code></pre>\n\n<p>will be translated into the desired MongoDB query:</p>\n\n<pre><code>{ Things: { $elemMatch: { Value: \"bar\" } } }\n</code></pre>\n"}], "owner": {"reputation": 26064, "user_id": 338068, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4cb6a6a3ccc0d568a0944a6655e22803?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/338068/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 1, "accepted_answer_id": 51978678, "answer_count": 1, "score": 3, "last_activity_date": 1535000866, "creation_date": 1534955404, "question_id": 51971351, "link": "https://stackoverflow.com/questions/51971351/how-to-query-collection-using-generic-query-builder", "title": "How to query collection using generic query builder", "body": "<p>I am using the mongocsharpdriver nuget package (version 1.11.0) to run queries against a mongo database.</p>\n\n<p>When creating a query object in c# I can do this:</p>\n\n<pre><code>var query = Query.EQ(\"RootValue\", \"foo\");\n</code></pre>\n\n<p>I can use the nicer generic query Builders instead to do this:</p>\n\n<pre><code>var query = Query&lt;RootObject&gt;.EQ(x=&gt;x.RootValue, \"foo\");\n</code></pre>\n\n<p>Now consider this query::</p>\n\n<pre><code>var query = Query.EQ(\"Things.Value\", \"bar\");\n</code></pre>\n\n<p>Here <code>Things</code> is a collection of objects that have a string (<code>Value</code>) on them. In this case the query will return any object which has a match in any of the Values of Things.</p>\n\n<p><strong>How do I write this query using the generic Query builder?</strong></p>\n\n<p>I can't work out what expression I need that will get correctly translated to what I want...</p>\n\n<p>In case it makes it clearer here are the classes for my example:</p>\n\n<pre><code>public class RootObject\n{\n    [BsonId]\n    public ObjectId Id {get; set;}\n    public IEnumerable&lt;RepeatedObject&gt; Things {get; set;}\n    public string RootValue {get; set;}\n}\n\npublic class RepeatedObject\n{\n    public string Value {get; set;}\n}\n</code></pre>\n"}, {"tags": ["c#", "azure", "azure-functions", "azure-data-lake"], "answers": [{"tags": [], "owner": {"reputation": 265, "user_id": 1407246, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/194735dc280314156a2a5529ac20b8ba?s=128&d=identicon&r=PG", "display_name": "MV23", "link": "https://stackoverflow.com/users/1407246/mv23"}, "is_accepted": false, "score": 0, "last_activity_date": 1548709703, "creation_date": 1548709703, "answer_id": 54410317, "question_id": 51971326, "link": "https://stackoverflow.com/questions/51971326/c-parallel-writes-to-azure-data-lake-file/54410317#54410317", "title": "c# parallel writes to Azure Data Lake File", "body": "<p>I am a bit late to this but I guess one of the problems could be due to the use of \"Create\" and \"ConcurrentAppend\" on the same file stream?\nADLS documentation mentions that they can't be used on the same file. Maybe, try changing the \"Create\" command to \"ConcurrentAppend\" as the latter can be used to create a file if it doesn't exist.</p>\n\n<p>Also, if you found a better way to do it, please do post your solution here.</p>\n"}], "owner": {"reputation": 463, "user_id": 334783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/034bc926a7a475d97d79bba937c9855b?s=128&d=identicon&r=PG", "display_name": "Shannon Lowder", "link": "https://stackoverflow.com/users/334783/shannon-lowder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 680, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1548709703, "creation_date": 1534955336, "last_edit_date": 1535026487, "question_id": 51971326, "link": "https://stackoverflow.com/questions/51971326/c-parallel-writes-to-azure-data-lake-file", "title": "c# parallel writes to Azure Data Lake File", "body": "<p>In our Azure Data Lake, we have daily files recording events and coordinates for those events.  We need to take these coordinates and lookup what State, County, Township, and Section these coordinates fall into. I've attempted several versions of this code. </p>\n\n<ul>\n<li>I attempted to do this in U-SQL. I even uploaded a custom assembly that implemented Microsoft.SqlServer.Types.SqlGeography methods, only to find ADLA isn't set up to perform row-by-row operations like geocoding.</li>\n<li>I pulled all the rows into SQL Server, converted the coordinates into a SQLGeography and built T-SQL code that would perform the State, County, etc. lookups.  After much optimization, I got this process down to ~700ms / row. (with 133M rows in the backlog and ~16k rows added daily we're looking at nearly 3 years to catch up.  So I parallelized the T-SQL, things got better, but not enough.</li>\n<li>I took the T-SQL code, and built the process as a console application, since the SqlGeography library is actually a .Net library, not a native SQL Server product.  I was able to get single threaded processing down t0 ~ 500ms. Adding in .Net's parallelism (parallel.ForEach) and throwing 10/20 of the cores of my machine at it does a lot, but still isn't enough.</li>\n<li>I attempted to rewrite this code as an Azure Function and processing files in the data lake file-by-file. Most of the files timed out, since they took longer than 10 minutes to process. So I've updated the code to read in the files, and shread the rows into Azure Queue storage.  Then I have a second Azure function that fires for each row in the queue.  The idea is, Azure Functions can scale out far greater than any single machine can.</li>\n</ul>\n\n<p>And this is where I'm stuck. I can't reliably write rows to files in ADLS. Here is the code as I have it now.</p>\n\n<pre><code>public static void WriteGeocodedOutput(string Contents, String outputFileName, ILogger log) {\n\n        AdlsClient client = AdlsClient.CreateClient(ADlSAccountName, adlCreds);\n        //if the file doesn't exist write the header first\n        try {\n            if (!client.CheckExists(outputFileName)) {\n                using (var stream = client.CreateFile(outputFileName, IfExists.Fail)) {\n                    byte[] headerByteArray = Encoding.UTF8.GetBytes(\"EventDate, Longitude, Latitude, RadarSiteID, CellID, RangeNauticalMiles, Azimuth, SevereProbability, Probability, MaxSizeinInchesInUS, StateCode, CountyCode, TownshipCode, RangeCode\\r\\n\");\n                    //stream.Write(headerByteArray, 0, headerByteArray.Length);\n                    client.ConcurrentAppend(outputFileName, true, headerByteArray, 0, headerByteArray.Length);\n                }\n            }\n        } catch (Exception e) {\n            log.LogInformation(\"multiple attempts to create the file. Ignoring this error, since the file was created.\");\n        }\n\n        //the write the data\n        byte[] textByteArray = Encoding.UTF8.GetBytes(Contents);\n        for (int attempt = 0; attempt &lt; 5; attempt++) {\n            try {\n                log.LogInformation(\"prior to write, the outputfile size is: \" + client.GetDirectoryEntry(outputFileName).Length);\n                var offset = client.GetDirectoryEntry(outputFileName).Length;\n                client.ConcurrentAppend(outputFileName, false, textByteArray, 0, textByteArray.Length);\n                log.LogInformation(\"AFTER write, the outputfile size is: \" + client.GetDirectoryEntry(outputFileName).Length);\n                //if successful, stop trying to write this row\n                attempt = 6;                    \n            }\n            catch (Exception e){\n                log.LogInformation($\"exception on adls write: {e}\");\n            }\n            Random rnd = new Random();\n            Thread.Sleep(rnd.Next(attempt * 60));\n        }\n    }\n</code></pre>\n\n<p>The file will be created when it needs to be, but I do get several messages in my log that several threads tried to create it.  I'm not always getting the header row written. </p>\n\n<p>I also no longer get any data rows only: </p>\n\n<pre><code>\"BadRequest ( IllegalArgumentException  concurrentappend failed with error 0xffffffff83090a6f \n(Bad request. The target file does not support this particular type of append operation. \nIf the concurrent append operation has been used with this file in the past, you need to append to this file using the concurrent append operation.\nIf the append operation with offset has been used in the past, you need to append to this file using the append operation with offset. \nOn the same file, it is not possible to use both of these operations.). []\n</code></pre>\n\n<p>I feel like I'm missing some fundamental design idea here.  The code should try to write a row into a file. If the file doesn't yet exist, create it and put the header row in. Then, put in the row.  </p>\n\n<p>What's the best-practice way to accomplish this kind of write scenario?</p>\n\n<p>Any other suggestions of how to handle this kind of parallel-write workload in ADLS?</p>\n"}, {"tags": ["c#", "multithreading", "asp.net-web-api2", "custom-attributes"], "comments": [{"owner": {"reputation": 2444, "user_id": 6180031, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-HRw-01bXV4c/AAAAAAAAAAI/AAAAAAAACP8/Mi48YmzBWL0/photo.jpg?sz=128", "display_name": "ZorgoZ", "link": "https://stackoverflow.com/users/6180031/zorgoz"}, "edited": false, "score": 1, "creation_date": 1534955524, "post_id": 51971306, "comment_id": 90893197, "body": "An attribute is complie-time object. That means the attribute instance is part of the type definition, not of the custom object instance."}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 1, "creation_date": 1534955549, "post_id": 51971306, "comment_id": 90893214, "body": "I&#39;m not clear why you want to pass those 2 properties along at all. While the attribute is going to be reused, those properties will be preserved per instance."}, {"owner": {"reputation": 833, "user_id": 969431, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZTsGg.jpg?s=128&g=1", "display_name": "jlavallet", "link": "https://stackoverflow.com/users/969431/jlavallet"}, "edited": false, "score": 0, "creation_date": 1534956009, "post_id": 51971306, "comment_id": 90893483, "body": "I suppose that you are right that the parameters are set at compile time. That&#39;s good. I use what is compiled in \u2013 namely the parameterized message string and the Boolean indicator that tells me how much to log in the context of the controller action I am calling to produce a contextualized log message. So then my real question is \u2013 how do I get at those two parameter values in my <code>OnActionExecuted </code> method? Can I just access the public property? Note that I use this attribute with different parameters on a multitude of WebAPI controller actions. Am I confusing myself?"}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 1, "creation_date": 1534956070, "post_id": 51971306, "comment_id": 90893504, "body": "Yes, you&#39;re confusing yourself! Just use the properties."}, {"owner": {"reputation": 833, "user_id": 969431, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZTsGg.jpg?s=128&g=1", "display_name": "jlavallet", "link": "https://stackoverflow.com/users/969431/jlavallet"}, "reply_to_user": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1534956400, "post_id": 51971306, "comment_id": 90893679, "body": "Okay so just to give you a little more background, I had another public property at one point that I set to hold the contextualized message. I was creating the contextualized message in the <code>OnActionExecuting </code> method instead of in the <code>OnActionExecuted </code> method. I suppose that that property \u2013 which was dynamically set based on what happened in the context of the <code>OnActionExecuting </code> method is what was subject to each invocation and was producing results from prior calls.. Okay, thank you @DavidG. I think I am good."}], "owner": {"reputation": 833, "user_id": 969431, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/ZTsGg.jpg?s=128&g=1", "display_name": "jlavallet", "link": "https://stackoverflow.com/users/969431/jlavallet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 426, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534955276, "creation_date": 1534955276, "question_id": 51971306, "link": "https://stackoverflow.com/questions/51971306/how-do-you-pass-thread-safe-data-between-the-methods-of-a-system-web-http-filter", "title": "How do you pass thread safe data between the methods of a System.Web.Http.Filters.ActionFilterAttribute?", "body": "<p>I have a custom attribute extension of <code>System.Web.Http.Filters.ActionFilterAttribute</code> that I am using for logging with Web API controllers. I am experiencing an issue that indicates that the attribute object is being reused call to call. Data in my public properties from an initial call will appear in the logged information for a subsequent call and so on. </p>\n\n<p>I read in this <a href=\"https://stackoverflow.com/questions/8937200/are-actionfilterattributes-reused-across-threads-how-does-that-work\">post</a> that I <em>\"should never store instance state in an action filter that will be reused between the different methods.\"</em> He goes on to say,<em>\"This basically means that the same instance of the action filter can be reused for different actions and if you have stored instance state in it it will probably break.\"</em></p>\n\n<p>My custom attribute is apparently <em>\"break\"</em> ing. Thus began my search to answer the question \u2026</p>\n\n<p><strong>How do you pass thread safe data between the methods of a System.Web.Http.Filters.ActionFilterAttribute?</strong></p>\n\n<p>An example is given in the post I referenced above of how data should be passed method to method using the <code>HttpContext.Items</code> dictionary. That's great and I can see how that would help but I'm not using ASP.net MVC's<code>System.Web.Http.Mvc.ActionFilterAttribute</code> \u2013 which the poster uses in his answer. I'm doing Web API and the context object passed into the <code>OnActionExecuting</code> method is of type <code>HttpActionContext</code> and not of type <code>ActionExecutingContext</code>. I do not have access to the <code>HttpContext.Items</code> dictionary through the passed context, however, I believe that it is safe to access the <code>HttpContext</code> like this:</p>\n\n<pre><code>HttpContext.Current.Items[key]\n</code></pre>\n\n<p><strong>Is that safe?</strong></p>\n\n<p>I do not have access to that dictionary in the constructor however and since that is where I receive my parameterized message string as a positional parameter, I am seemingly dependent on stored instance state. </p>\n\n<p>So what to do?</p>\n\n<p>In this <a href=\"https://stackoverflow.com/questions/15530779/passing-action-method-parameter-to-actionfilterattribute-in-asp-net-mvc\">post</a> \u2013 also dependent on ASP.net MVC's <code>System.Web.Http.Mvc.ActionFilterAttribute</code>and its <code>ActionExecutingContext</code>\u2013 the poster uses the <code>ActionParameters</code> property of that context object to get at the parameters passed to the attribute, but I cannot find any equivalent in Web API's <code>HttpActionContext</code>. If I could, this would seem to be the answer! But alas\u2026</p>\n\n<p><strong>How can I safely get to the positional parameter value passed into my constructor and the named parameter value passed in through a public property within the <code>OnActionExecuting</code> method?</strong></p>\n\n<p>Posts I have researched:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/8937200/are-actionfilterattributes-reused-across-threads-how-does-that-work\">Are ActionFilterAttributes reused across threads? How does that work?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/8675103/mvc-action-filter-and-multiple-threads\">MVC Action Filter and Multiple Threads</a></li>\n<li><a href=\"https://stackoverflow.com/questions/15530779/passing-action-method-parameter-to-actionfilterattribute-in-asp-net-mvc\">passing action method parameter to ActionFilterAttribute in asp.net mvc</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12992722/why-is-my-asp-net-web-api-actionfilterattribute-onactionexecuting-not-firing\">Why is my ASP.NET Web API ActionFilterAttribute OnActionExecuting not firing?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/12606202/system-web-mvc-actionfilterattribute-vs-system-web-http-filters-actionfilterattr/12606393\">System.Web.Mvc.ActionFilterAttribute vs System.Web.Http.Filters.ActionFilterAttribute</a></li>\n<li><a href=\"https://stackoverflow.com/questions/28235979/web-api-2-httpcontext-or-httpactioncontext\">Web Api 2 HttpContext or HttpActionContext</a></li>\n</ul>\n\n<p>Background: In the constructor, I pass a parameterized message string that includes placeholders for the values of arguments passed to the method the attribute is applied to. I also have an optional LogAllResponses property that is set through a named parameter to the attribute that I use to decide how much information I will log. The public properties that receive these values are set through the constructor and attribute invocation like this:</p>\n\n<pre><code>[LogAction(\"Retrieve information for all ad week items with storeId: {storeId}.\", LogAllResponses = false)]\n</code></pre>\n\n<p>The important parts of the implementation of my action filter appear below:</p>\n\n<pre><code>public class LogActionAttribute : ActionFilterAttribute\n{\n    private static readonly Logger Log = LogManager.GetCurrentClassLogger();\n\n    public string ParameterizedMessage { get; set; }\n    public bool LogAllResponses { get; set; } = true;\n\n    public LogActionAttribute(string parameterizedMessage)\n    {\n        ParameterizedMessage = parameterizedMessage;\n    }\n\n    public override void OnActionExecuting(HttpActionContext actionContext)\n    {\n        HttpContext.Current.Items[\"__Parameterized_Message__\"] = ParameterizedMessage;\n        HttpContext.Current.Items[\"__Log_All_Responses__\"] = LogAllResponses.ToString();\n\n        base.OnActionExecuting(actionContext);\n    }\n\n    public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)\n    {   \n        var contextualizedMessage = HttpContext.Current.Items[\"__Parameterized_Message__\"] as string ?? \"\";\n        var logAllResponsesAsString = HttpContext.Current.Items[\"__Log_All_Responses__\"] as string ?? \"\";\n        var logAllResponses = logAllResponsesAsString.CompareIgnoreCase(\"true\") == 0;\n\n        // convert argument values with ID suffixes to identifiable names\n        var arguments = actionExecutedContext.ActionContext.ActionArguments;\n        //foreach (var arg in arguments)\n            // ...\n\n        // replace the placeholders in the parameterized message string with actual values\n\n        // log the contextualized message\n        //Log.Debug(...\n\n        base.OnActionExecuted(actionExecutedContext);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "entity-framework", "linq"], "comments": [{"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 3, "creation_date": 1534955247, "post_id": 51971253, "comment_id": 90893040, "body": "It&#39;s very difficult to diagnose anything without some code."}, {"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 2, "creation_date": 1534956283, "post_id": 51971253, "comment_id": 90893609, "body": "Your problem is likely to be fixable, but rather like it would be hard for someone to fix your car without seeing it, we also find it difficult to fix code without seeing it. Please edit your question to include relevant code and, if necessary, sample data. Thanks."}, {"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 2, "creation_date": 1534958374, "post_id": 51971253, "comment_id": 90894645, "body": "Please <a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">do not post screen shots of your IDE</a>; they include too much useless information and not enough useful information. We can&#39;t copy or search for text in screen shots."}, {"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 0, "creation_date": 1534967323, "post_id": 51971253, "comment_id": 90898678, "body": "Agreed, no pictures please. It&#39;s impossible to copy/paste anything to make a test, or use it in an answer. The resolution also interferes with readability. And lastly it&#39;s not searchable by anyone in future. If you can replace the images with proper text then we can start to help. An image of the debug data is probably acceptable, since that&#39;s more difficult to capture, but not for the code. Code is text to begin with, it should remain so. Thanks."}, {"owner": {"reputation": 14993, "user_id": 423497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c411e966f549fa07b3d7fb142ba733?s=128&d=identicon&r=PG", "display_name": "Steve Py", "link": "https://stackoverflow.com/users/423497/steve-py"}, "edited": false, "score": 1, "creation_date": 1534972818, "post_id": 51971253, "comment_id": 90901004, "body": "Set a breakpoint and check what <code>context.UserName</code> and <code>context.Password</code> are set to. My money would be on that they are empty strings and that the problem lies more with how you are retrieving those values from the request.  Also, do <i>not</i> store passwords in clear text in a database. Store a hash of a password, send passwords to API&#39;s over SSL, and hash the password in the API to compare against the database."}], "answers": [{"tags": [], "owner": {"reputation": 5009, "user_id": 1666800, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/wePua.png?s=128&g=1", "display_name": "Vahid Farahmandian", "link": "https://stackoverflow.com/users/1666800/vahid-farahmandian"}, "is_accepted": true, "score": 0, "last_activity_date": 1534975941, "last_edit_date": 1534975941, "creation_date": 1534975233, "answer_id": 51975752, "question_id": 51971253, "link": "https://stackoverflow.com/questions/51971253/the-server-doesnt-send-data-to-sql-server-database/51975752#51975752", "title": "The server doesn&#39;t send data to SQL Server database", "body": "<p>There is nothing wrong with your code. It seems that you have some interceptor that change the query, before sending it to SQL Server. Check to see if you have any class implemented <code>IDbCommandInterceptor</code> interface. If yes, check to see what is going to happen in that class?</p>\n"}], "owner": {"reputation": 88, "user_id": 10260624, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iWN6UAuw8W4/AAAAAAAAAAI/AAAAAAAAAAc/mPldVT2z7Jo/photo.jpg?sz=128", "display_name": "Mahdi Jannati", "link": "https://stackoverflow.com/users/10260624/mahdi-jannati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 1, "accepted_answer_id": 51975752, "answer_count": 1, "score": 1, "last_activity_date": 1535184859, "creation_date": 1534955108, "last_edit_date": 1535184859, "question_id": 51971253, "link": "https://stackoverflow.com/questions/51971253/the-server-doesnt-send-data-to-sql-server-database", "title": "The server doesn&#39;t send data to SQL Server database", "body": "<p>I have a strange problem using ASP.Net WebAPI 2, LINQ and Entity Framework.</p>\n\n<p>When I send a set of data from front-end to back-end, I saw my data in my ViewModel and data mapped to entity correctly. Now when I send the data to database I see my data is empty string and the EF doesn't send any data from back-end to SQL Server. I have attached the SQL Server Profiler's output for the given EF and LINQ code. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>using (MyContext dbContext = new MyContext())\n{\n      var user = dbContext.User\n                    .Where(x =&gt; x.Username == context.UserName &amp;&amp; x.Password == context.Password)\n                    .Select(x =&gt; new UserClaim()\n                    {\n                        Id = x.Id,\n                        Firstname = x.Firstname,\n                        Lastname = x.Lastname,\n                        Username = x.Username,\n                        Roles = x.UserInRoles.Select(u =&gt; u.Role.Id).ToList()\n                    }).FirstOrDefault();\n        if (user == null)\n        {\n            //user not found\n        }\n        //do something...user found!\n}\n</code></pre>\n\n<p>Here are my screenshots:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JvlAP.png\" alt=\"enter image description here\">\n<img src=\"https://i.stack.imgur.com/7VfLP.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c#", "drag-and-drop", "rows", "infragistics", "xamdatagrid"], "answers": [{"tags": [], "owner": {"reputation": 3188, "user_id": 394855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7dfc8411b04d7504836580c28650297?s=128&d=identicon&r=PG", "display_name": "alhalama", "link": "https://stackoverflow.com/users/394855/alhalama"}, "is_accepted": false, "score": 0, "last_activity_date": 1536696352, "creation_date": 1536696352, "answer_id": 52283496, "question_id": 51971202, "link": "https://stackoverflow.com/questions/51971202/xamdatagrid-dragging-rows-within-grid/52283496#52283496", "title": "XAMDataGrid: Dragging rows within grid", "body": "<p>I posted a sample with a behavior a few months ago on the <a href=\"https://www.infragistics.com/community/forums/f/ultimate-ui-for-wpf/118570/drag-and-drop-to-reorder-rows-in-xamdatagrid-2017-2\" rel=\"nofollow noreferrer\">Infragistics Forums</a> that reorders rows that it similar to your requirement.</p>\n\n<p>Relevant markup:</p>\n\n<pre><code>&lt;igDP:XamDataGrid DataSource=\"{Binding Items}\" IsSynchronizedWithCurrentItem=\"True\" GroupByAreaLocation=\"None\"&gt;\n    &lt;i:Interaction.Behaviors&gt;\n        &lt;DragGrid:XamDataGridDragDropBehavior/&gt;\n    &lt;/i:Interaction.Behaviors&gt;\n&lt;/igDP:XamDataGrid&gt;\n</code></pre>\n\n<p>C# code for the Behavior:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing Infragistics.Windows.DataPresenter;\nusing System.Windows.Interactivity;\nusing System.Windows;\nusing Infragistics.DragDrop;\nusing System.Windows.Input;\nusing Infragistics.Windows;\nusing System.Collections;\nusing System.Windows.Media;\nusing System.Reflection;\n\nnamespace DragGrid\n{\n    public class XamDataGridDragDropBehavior : Behavior&lt;DataPresenterBase&gt;\n    {\n        private DataPresenterBase dataPresenter;\n\n        protected override void OnAttached()\n        {\n            base.OnAttached();\n            dataPresenter = this.AssociatedObject;\n            EventManager.RegisterClassHandler(typeof(XamDataGrid), UIElement.MouseLeftButtonDownEvent, new MouseButtonEventHandler(XamDataGrid_MouseLeftButtonDown));\n            var dataPresenterStyle = new Style(typeof(DataRecordPresenter));\n            dataPresenterStyle.Setters.Add(new EventSetter(FrameworkElement.LoadedEvent, new RoutedEventHandler(OnRecordPresenterLoaded)));\n            dataPresenter.Resources.Add(typeof(DataRecordPresenter), dataPresenterStyle);\n            DropTarget dropTarget = new DropTarget() { IsDropTarget = true };\n            DragDropManager.SetDropTarget(dataPresenter, dropTarget);\n        }\n\n        private void OnRecordPresenterLoaded(object sender, RoutedEventArgs e)\n        {\n\n            var recordPresenter = sender as DataRecordPresenter;\n\n            if (DragDropManager.GetDragSource(recordPresenter) != null)\n            {\n                return;\n            }\n\n            var dragSource = new DragSource\n            {\n                IsDraggable = true\n            };\n\n            dragSource.DragStart += new System.EventHandler&lt;DragDropStartEventArgs&gt;(dragSource_DragStart);\n            dragSource.Drop += OnRecordDragDrop;\n            dragSource.DragTemplate = ((Window)Utilities.GetAncestorFromType(this.dataPresenter, typeof(Window), true)).Resources[\"dragTemplate\"] as DataTemplate;\n\n            DragDropManager.SetDragSource(recordPresenter, dragSource);\n        }\n\n        void dragSource_DragStart(object sender, DragDropStartEventArgs e)\n        {\n            ArrayList draggedItems = new ArrayList();\n            List&lt;IList&gt; sourceList = new List&lt;IList&gt;();\n            SelectedRecordCollection selectedRecords = this.dataPresenter.SelectedItems.Records;\n            DataRecord lastSelectedDataRecord = null;\n            foreach (Record r in selectedRecords)\n            {\n                DataRecord dr = r as DataRecord;\n                if (dr != null)\n                {\n                    lastSelectedDataRecord = dr;\n                    draggedItems.Add(dr.DataItem);\n                    sourceList.Add(GetSourceList(dr));\n                }\n            }\n            DraggingData data = new DraggingData();\n            data.Items = draggedItems;\n            data.Lists = sourceList;\n            if (lastSelectedDataRecord != null &amp;&amp; lastSelectedDataRecord.ParentRecord != null)\n            {\n                data.SourceProperty = lastSelectedDataRecord.RecordManager.Field.Name;\n            }\n            e.Data = data;\n        }\n\n        private IList GetSourceList(DataRecord record)\n        {\n            IList retVal = null;\n            DataRecord parent = record.ParentDataRecord;\n            if (parent == null)\n            {\n                // There is no parent, use the grids list\n                retVal = this.dataPresenter.DataSource as IList;\n            }\n            else\n            {\n                object parentDataItem = parent.DataItem;\n                Type dataItemType = parentDataItem.GetType();\n                PropertyInfo listProperty = dataItemType.GetProperty(record.RecordManager.Field.Name);\n                retVal = listProperty.GetValue(parentDataItem, null) as IList;\n            }\n            return retVal;\n        }\n\n        private void OnRecordDragDrop(object sender, DropEventArgs dragInfo)\n        {\n            var result = VisualTreeHelper.HitTest(dragInfo.DropTarget, dragInfo.GetPosition(dragInfo.DropTarget));\n            var targetElement = Utilities.GetAncestorFromType(result.VisualHit, typeof(DataRecordPresenter), true) as DataRecordPresenter;\n            if (targetElement != null)\n            {\n                DataRecord targetRecord = targetElement.DataRecord;\n                IList targetList = GetSourceList(targetRecord);\n                object targetItem = targetRecord.DataItem;\n                Type targetType = targetItem.GetType();\n                DraggingData draggedData = dragInfo.Data as DraggingData;\n                if (draggedData != null)\n                {\n                    IList itemsList = draggedData.Items;\n                    object firstItem = itemsList[0];\n                    IList&lt;IList&gt; listsList = draggedData.Lists;\n                    if (!targetType.IsInstanceOfType(firstItem))\n                    {\n                        // the target type doesn't match the items we are dropping, get the child list from the parent if we have a property.\n                        if (draggedData.SourceProperty != null)\n                        {\n                            PropertyInfo listProperty = targetType.GetProperty(draggedData.SourceProperty);\n                            targetList = listProperty.GetValue(targetItem, null) as IList;\n                            if (targetList != null)\n                            {\n                                for (int i = itemsList.Count - 1; i &gt;= 0; i--)\n                                {\n                                    object currentItem = itemsList[i];\n                                    int targetIndex = targetList.IndexOf(targetItem);\n                                    listsList[i].Remove(currentItem);\n                                    targetList.Add(currentItem);\n                                }\n                            }\n                        }\n                        else\n                        {\n                            MessageBox.Show(\"Can't drop here\");\n                        }\n                    }\n                    else\n                    {\n                        for (int i = itemsList.Count - 1; i &gt;= 0; i--)\n                        {\n                            object currentItem = itemsList[i];\n                            int targetIndex = targetList.IndexOf(targetItem);\n                            listsList[i].Remove(currentItem);\n                            targetList.Insert(targetIndex, currentItem);\n                        }\n                    }\n                }\n\n            }\n        }\n\n        void XamDataGrid_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)\n        {\n            if (this.dataPresenter.Equals(sender))\n            {\n                DataRecordPresenter drp = Utilities.GetAncestorFromType(e.OriginalSource as DependencyObject, typeof(DataRecordPresenter), true) as DataRecordPresenter;\n                if (drp != null)\n                {\n                    // If we already have a selection then we don't want the Grids SelectionController to be called which will cause a capture of the mouse and prevent dragging.\n                    if (drp.IsSelected)\n                    {\n                        e.Handled = true;\n                    }\n                }\n            }\n        }\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 8233658, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bfb22fd2c4992390483cef8c5fae8e3c?s=128&d=identicon&r=PG&f=1", "display_name": "rds80", "link": "https://stackoverflow.com/users/8233658/rds80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536696352, "creation_date": 1534954931, "question_id": 51971202, "link": "https://stackoverflow.com/questions/51971202/xamdatagrid-dragging-rows-within-grid", "title": "XAMDataGrid: Dragging rows within grid", "body": "<p>I'm using the XamDataGrid v14.2 and want to add the feature of dragging and dropping rows within the datagrid.</p>\n\n<p>I've looked thru the Infragistics forum posts, but most of the code samples show dragging and dropping rows from one grid to another.  </p>\n\n<p>Is it possible to drag and drop rows within the same grid?  The effect that I want to achieve is to move the sequence of the Web Announcement row numbers.   </p>\n\n<p>Here is an image of how the grid looks:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qXqpY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qXqpY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", ".net", "wpf", "observablecollection"], "comments": [{"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1534955116, "post_id": 51971168, "comment_id": 90892971, "body": "If you are having threading issues, then perhaps you should be doing the move on the UI thread?  I have also seen problems where if you don&#39;t clear the &#39;currently selected&#39; of the collection you are removing from, then it crashes."}, {"owner": {"reputation": 143, "user_id": 10115963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb28dd3e89d8c29cc7e0070a15f8a58?s=128&d=identicon&r=PG&f=1", "display_name": "J34245", "link": "https://stackoverflow.com/users/10115963/j34245"}, "reply_to_user": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1534957391, "post_id": 51971168, "comment_id": 90894198, "body": "The problem with my old solution is it worked if you were only moving a couple of objects, if you were however moving 5+ in a close time period the program wouldn&#39;t update the GUI to reflect that. It would never crash, just not reflect the change."}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1534957546, "post_id": 51971168, "comment_id": 90894275, "body": "So, pause the <code>OnPropertyChanged</code> mechanism until all changes have been made, and then release it afterwards.  Then there is only 1 &#39;change&#39; instead of 5."}, {"owner": {"reputation": 143, "user_id": 10115963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb28dd3e89d8c29cc7e0070a15f8a58?s=128&d=identicon&r=PG&f=1", "display_name": "J34245", "link": "https://stackoverflow.com/users/10115963/j34245"}, "reply_to_user": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 0, "creation_date": 1534957815, "post_id": 51971168, "comment_id": 90894400, "body": "I didn&#39;t know that was a thing, thank you. I will look into this and provide an update."}], "answers": [{"tags": [], "owner": {"reputation": 1000, "user_id": 1366407, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2D1g2.jpg?s=128&g=1", "display_name": "LadderLogic", "link": "https://stackoverflow.com/users/1366407/ladderlogic"}, "is_accepted": false, "score": 0, "last_activity_date": 1535004536, "creation_date": 1535004536, "answer_id": 51979300, "question_id": 51971168, "link": "https://stackoverflow.com/questions/51971168/move-objects-around-multiple-observablecollection/51979300#51979300", "title": "Move objects around multiple ObservableCollection", "body": "<p>You have two different questions here:</p>\n\n<ol>\n<li><p>Changing observable collections and the UI reacting to it: Observable Collections are made for this, and you shouldn't have a problem removing/adding. Of course, the exceptions are when the work is not done on the UI thread or if the synchronization is not done properly. I'd recommend enabling collection synchronization instead of marshalling every call to the UI thread. Refer to this post about <a href=\"https://stackoverflow.com/a/51902121/1366407\">collection synchronization</a></p></li>\n<li><p>Having one collection for all three items control, but show different things: Yes. You could do this with a <code>CollectionView</code> by applying the appropriate filter. Here is an article that talks about <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wpf/controls/how-to-group-sort-and-filter-data-in-the-datagrid-control\" rel=\"nofollow noreferrer\">CollectionViewSource</a>  </p></li>\n</ol>\n"}], "owner": {"reputation": 143, "user_id": 10115963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bb28dd3e89d8c29cc7e0070a15f8a58?s=128&d=identicon&r=PG&f=1", "display_name": "J34245", "link": "https://stackoverflow.com/users/10115963/j34245"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535004536, "creation_date": 1534954819, "last_edit_date": 1534957286, "question_id": 51971168, "link": "https://stackoverflow.com/questions/51971168/move-objects-around-multiple-observablecollection", "title": "Move objects around multiple ObservableCollection", "body": "<p>I have three Items Control, detailed bellow, currently I have three accompanying  Observable collections, one for each control. I want to be able to move one of the objects from one of the group boxes and for it to appear in another. Currently, I am removing it from the original observable collection and then adding it to the new one. This however has lead to threading issues, where the UI doesn't always update the move. Is there any better way of moving around the objects between observable collections. Such as having only one, but changing which are rendered in which control? Any help is appreciated.</p>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>&lt;GroupBox x:Name=\"OnTimeGroup\"&gt;\n    &lt;ScrollViewer VerticalScrollBarVisibility=\"Auto\"&gt;\n        &lt;StackPanel&gt;\n            &lt;ItemsControl x:Name=\"OnTimeCards\"&gt;\n                &lt;ItemsControl.ItemTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;UserControl:OnTimeCard Visibility=\"Visible\" /&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/ItemsControl.ItemTemplate&gt;\n            &lt;/ItemsControl&gt;\n        &lt;/StackPanel&gt;\n    &lt;/ScrollViewer&gt;\n&lt;/GroupBox&gt;\n&lt;GroupBox x:Name=\"LateGroup\"&gt;\n    &lt;StackPanel&gt;\n        &lt;ItemsControl x:Name=\"LateCards\"&gt;\n            &lt;ItemsControl.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;UserControl:LateActionNeededCard Ignore=\"LateCardIgnoreClicked\" Publish=\"LateCardPublishClicked\" Visibility=\"Visible\" /&gt;\n                    &lt;/materialDesign:TransitioningContent&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/ItemsControl.ItemTemplate&gt;\n            &lt;/ItemsControl&gt;\n        &lt;/StackPanel&gt;\n    &lt;/ScrollViewer&gt;\n&lt;/GroupBox&gt;\n&lt;GroupBox x:Name=\"PublishedGroup\"&gt;\n    &lt;ScrollViewer VerticalScrollBarVisibility=\"Auto\"&gt;\n        &lt;StackPanel&gt;\n            &lt;ItemsControl x:Name=\"PublishedCards\"&gt;\n                &lt;ItemsControl.ItemTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;UserControl:PublishedCard Update=\"PublishedCardUpdateClicked\" Visibility=\"{Binding IsVisible}\" /&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/ItemsControl.ItemTemplate&gt;\n                &lt;/ItemsControl&gt;\n            &lt;/StackPanel&gt;\n        &lt;/ScrollViewer&gt;\n    &lt;/GroupBox&gt;\n</code></pre>\n\n<p><strong>C#</strong></p>\n\n<pre><code>private ObservableCollection&lt;LiveTime&gt; OnTimeCardsCollection = new ObservableCollection&lt;LiveTime&gt;();\nprivate ObservableCollection&lt;LiveTime&gt; LateCardsCollection = new ObservableCollection&lt;LiveTime&gt;();\nprivate ObservableCollection&lt;LiveTime&gt; PublishedCardsCollection = new ObservableCollection&lt;LiveTime&gt;();\n</code></pre>\n\n<p><strong>Pseudo Code of Current Code</strong></p>\n\n<p>When the user clicks a button on the object, remove it from the current observable collection. Then create a brand new object in the adjoining observable collection.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "data-binding", "binding"], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 2857650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ToJe.jpg?s=128&g=1", "display_name": "Subasish", "link": "https://stackoverflow.com/users/2857650/subasish"}, "is_accepted": true, "score": 1, "last_activity_date": 1534963024, "last_edit_date": 1534963024, "creation_date": 1534955227, "answer_id": 51971295, "question_id": 51971072, "link": "https://stackoverflow.com/questions/51971072/change-binded-null-object-to-some-data/51971295#51971295", "title": "Change binded null object to some data", "body": "<p>Instead of using <code>List</code> as below, try with an <code>ObservableCollection</code> instead.</p>\n\n<p><code>public List&lt;List&lt;IOrg&gt;&gt; ListLayer { get; private set; }</code></p>\n\n<p>At any point, if you need to add an object to the collection, just raise the <code>PropertyChanged</code> event for the <code>INotifyPropertyChanged</code> interface which your ViewModel(DataContext) class needs to implement.</p>\n"}], "owner": {"reputation": 436, "user_id": 9547346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhTvC.jpg?s=128&g=1", "display_name": "osynavets", "link": "https://stackoverflow.com/users/9547346/osynavets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 51971295, "answer_count": 1, "score": 1, "last_activity_date": 1534963024, "creation_date": 1534954458, "last_edit_date": 1534955923, "question_id": 51971072, "link": "https://stackoverflow.com/questions/51971072/change-binded-null-object-to-some-data", "title": "Change binded null object to some data", "body": "<h2>problem</h2>\n\n<p>I have a 2d array of some objects. For greater flexibility, it is an array of interface types. At the start, some cells can be null, but it fills with data later. I bind this array to UniformGrid in WPF. When I create a new object and add it in the array my grid doesn't change. The question is how to design bindind that if bound objects change (not the properties in object), the grid will change too.</p>\n\n<p>Similar question was <a href=\"https://stackoverflow.com/questions/15126157/wpf-bind-to-an-objects-property-what-happens-when-the-object-changes\">there</a>\nbut without decisions </p>\n\n<h2><strong>my code</strong></h2>\n\n<p><em>cells in array</em>\n(simple classes with method that can change properties to be sure binding works correctly. nothing special here) </p>\n\n<pre><code>interface IOrg\n{\n    string Text { get; }\n    SolidColorBrush SolidColor { get; }\n    void SetColor();\n    void SetText();\n}\n\nclass IOrgA : IOrg\n{\n    Random random;\n\n    public IOrgA(Random random)\n    {\n        SolidColor = new SolidColorBrush();\n\n        this.random = random;\n        SetColor();\n        SetText();\n    }\n\n    public string Text { get; private set; }\n    public SolidColorBrush SolidColor { get; private set; }\n\n    public void SetColor()\n    {\n        SolidColor.Color = Color.FromRgb(255, 255, (byte)random.Next(256));\n    }\n\n    public void SetText()\n    {\n        Text = random.Next(1000).ToString();\n    }\n}\n\nclass IOrgB : IOrg\n{\n    Random random;\n\n    public IOrgB(Random random)\n    {\n        SolidColor = new SolidColorBrush();\n\n        this.random = random;\n        SetColor();\n        SetText();\n    }\n\n    public string Text { get; private set; }\n    public SolidColorBrush SolidColor { get; private set; }\n\n    public void SetColor()\n    {\n        SolidColor.Color = Color.FromRgb((byte)random.Next(256), 255, 255);\n    }\n\n    public void SetText()\n    {\n        Text = random.Next(1000, 2000).ToString();\n    }\n}\n</code></pre>\n\n<p><em>main class</em> </p>\n\n<pre><code>class Table\n{\n    //array with data\n    private IOrg[,] _layer;\n    private Random _random = new Random();\n\n    public Table(int heigth, int width)\n    {\n        Height = heigth;\n        Widht = width;\n\n        _layer = new IOrg[heigth, width];\n        ListLayer = new List&lt;List&lt;IOrg&gt;&gt;();\n\n        FillLayer();\n        FillList();\n    }\n\n    public int Height { get; private set; }\n    public int Widht { get; private set; }\n    //list for binding\n    public List&lt;List&lt;IOrg&gt;&gt; ListLayer { get; private set; }\n\n    void FillLayer()\n    {\n        for (int i = 0; i &lt; Height; i++)\n        {\n            for (int j = 0; j &lt; Widht; j++)\n            {\n                //randomly fill array\n                if (_random.Next(30) == 1)\n                {\n                    IOrg org;\n\n                    if (_random.Next(2) == 0)\n                    {\n                        org = new IOrgA(_random);\n                    }\n                    else\n                    {\n                        org = new IOrgB(_random);\n                    }\n\n                    _layer[i, j] = org;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><em>xaml</em></p>\n\n<pre><code>&lt;Window.Resources&gt;\n\n    &lt;!-- size of uniform gris --&gt;\n    &lt;sys:Int32 x:Key=\"GridSize\" &gt;50&lt;/sys:Int32&gt;\n\n    &lt;!-- template for each row --&gt;\n    &lt;DataTemplate x:Key=\"RowDataTemplate\"&gt;\n        &lt;ItemsControl ItemsSource=\"{Binding}\" ItemTemplate=\"{DynamicResource ElementDataTemplate}\"&gt;\n            &lt;ItemsControl.ItemsPanel&gt;\n                &lt;ItemsPanelTemplate&gt;\n                    &lt;UniformGrid x:Name=\"RowGrid\" Columns=\"{StaticResource GridSize}\"/&gt;\n                &lt;/ItemsPanelTemplate&gt;\n            &lt;/ItemsControl.ItemsPanel&gt;\n        &lt;/ItemsControl&gt;\n    &lt;/DataTemplate&gt;\n\n    &lt;!-- template for each element in row --&gt;\n    &lt;DataTemplate x:Key=\"ElementDataTemplate\"&gt;\n        &lt;TextBlock Text=\"{Binding Text, FallbackValue=__}\"&gt;\n            &lt;TextBlock.Background&gt;\n                &lt;SolidColorBrush Color=\"{Binding SolidColor.Color, FallbackValue=#123456}\"&gt;&lt;/SolidColorBrush&gt;\n            &lt;/TextBlock.Background&gt;\n        &lt;/TextBlock&gt;\n    &lt;/DataTemplate&gt;\n\n&lt;/Window.Resources&gt;\n&lt;Grid&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"14*\" /&gt;\n        &lt;RowDefinition Height=\"1*\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n    &lt;ItemsControl Grid.Row=\"0\" x:Name=\"lst\"  ItemTemplate=\"{DynamicResource RowDataTemplate}\"&gt;\n        &lt;ItemsControl.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;UniformGrid x:Name=\"World\" Rows=\"{StaticResource GridSize}\" Background=\"Bisque\"/&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ItemsControl.ItemsPanel&gt;\n    &lt;/ItemsControl&gt;\n\n    &lt;Button Grid.Row=\"1\" Width=\"100\" Height=\"50\" Click=\"Button_Click\"&gt;\n        button\n    &lt;/Button&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p><em>binding</em></p>\n\n<pre><code>table = new Table(50, 50);\nlst.ItemsSource = table.ListLayer;\n</code></pre>\n\n<p>I randomly fill my array with data, bind it in UniformGrid, and provide FallbackValue for null value objects. When I add a new object to the array, nothing changes. How do Ifix this problem?</p>\n"}]