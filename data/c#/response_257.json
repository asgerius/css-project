[{"tags": ["c#"], "comments": [{"owner": {"reputation": 2628, "user_id": 2495728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bgl4n.jpg?s=128&g=1", "display_name": "Jonathan Alfaro", "link": "https://stackoverflow.com/users/2495728/jonathan-alfaro"}, "edited": false, "score": 0, "creation_date": 1576107061, "post_id": 59295621, "comment_id": 104795629, "body": "please show what you have tried and why it does not work."}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576107263, "post_id": 59295656, "comment_id": 104795679, "body": "if the number is 10 then won&#39;t pad left result in a 5 digit number?"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "reply_to_user": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576107391, "post_id": 59295656, "comment_id": 104795715, "body": "@SmileyFtW 10 will get you <code>0010</code>. &quot;4&quot; is total number of characters in the result"}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576107523, "post_id": 59295656, "comment_id": 104795762, "body": "Perfect... thank you"}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576107931, "post_id": 59295656, "comment_id": 104795869, "body": "the result was for a return string and looks like this and appears to do what I need <code>return _seqnumber.ToString().PadLeft(_seqNumDigits,&#39;0&#39;)</code>"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "reply_to_user": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576108041, "post_id": 59295656, "comment_id": 104795893, "body": "@SmileyFtW Glad it worked for you. The reason whey they downvoted is because you have not done your research. Well, happens. This also works <code>10.ToString(&quot;D4&quot;)</code>"}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576166145, "post_id": 59295656, "comment_id": 104819021, "body": "Well, I had done <i>some</i> homework I found <code>Format</code> and <code>PadLeft</code>. I am just now trying to learn C# coming from VBA. I googled and what I found seemed to indicate <code>PadLeft</code> was not what I wanted even though it turned out to be exactly what I needed. I know how to do a quick test in VBA, but don&#39;t have that skill in C# just yet. Thank you for the answer. I upvoted your solution as it was indeed the answer."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "reply_to_user": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576167142, "post_id": 59295656, "comment_id": 104819654, "body": "No problem. If this answers, you should also accept this answer. Another way to do - old programmer way - if you have max 5 chars, and you can have 1 to 5 initial chars, just concatenate <code>&quot;0000&quot; + val</code>. Then substring 5 last chars. But .net makes it all easy for you. All this is already built-in"}], "tags": [], "owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1576107062, "creation_date": 1576107062, "answer_id": 59295656, "question_id": 59295621, "link": "https://stackoverflow.com/questions/59295621/format-an-integer-given-an-integer-and-the-number-of-digits-to-use/59295656#59295656", "title": "Format an integer given an integer and the number of digits to use", "body": "<p>You can do </p>\n\n<pre><code>string myString = 6.ToString().PadLeft(4, '0');\n</code></pre>\n"}], "owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "closed_date": 1576107138, "accepted_answer_id": 59295656, "answer_count": 1, "score": -2, "last_activity_date": 1576108155, "creation_date": 1576106835, "last_edit_date": 1576108155, "question_id": 59295621, "link": "https://stackoverflow.com/questions/59295621/format-an-integer-given-an-integer-and-the-number-of-digits-to-use", "closed_reason": "Duplicate", "title": "Format an integer given an integer and the number of digits to use", "body": "<p>Given</p>\n\n<pre><code>int myNumber=6\nint myDigits=4\n</code></pre>\n\n<p>how do I asssign</p>\n\n<pre><code>string myString = \"0006\"\n</code></pre>\n\n<p>I asssume it would use <code>string.Format()</code></p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "edited": false, "score": 0, "creation_date": 1576107782, "post_id": 59295616, "comment_id": 104795832, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/16914101/changing-a-programs-process-name-in-task-manager\">Changing a programs process name in task manager?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 5145250, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1370274443/picture?type=large", "display_name": "bakester14", "link": "https://stackoverflow.com/users/5145250/bakester14"}, "is_accepted": false, "score": 0, "last_activity_date": 1576110096, "creation_date": 1576110096, "answer_id": 59296022, "question_id": 59295616, "link": "https://stackoverflow.com/questions/59295616/how-do-i-change-the-process-namefully-on-launch-c/59296022#59296022", "title": "How do I change the process name(fully) on launch c#", "body": "<p>According to <a href=\"https://www.howtogeek.com/405806/windows-task-manager-the-complete-guide/\" rel=\"nofollow noreferrer\">this article</a>, Task Manager \"names\" the process based on the file name. I would suggest writing a separate program to act as the \"handler\" of the program who's name you want to modify, and changing the name of that exe in the handler, if you really need the process name in Task Manager to be different every time.</p>\n"}], "owner": {"reputation": 19, "user_id": 12519294, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L3a1QLjzEf0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rduEYWgjalquLy9GMSuP-k3GOFxvQ/photo.jpg?sz=128", "display_name": "Velmillion", "link": "https://stackoverflow.com/users/12519294/velmillion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576110492, "creation_date": 1576106778, "question_id": 59295616, "link": "https://stackoverflow.com/questions/59295616/how-do-i-change-the-process-namefully-on-launch-c", "title": "How do I change the process name(fully) on launch c#", "body": "<p>I'm currently trying to make the process name of my application change at every launch, I've tried using Console.Title with a random string</p>\n\n<pre><code>Console.Title = randomString + \"Loader\";\n</code></pre>\n\n<p>Is there any way to make the name also run differently every time with a random string?</p>\n\n<p>What I mean by this is, when you open Task Manager, you see that the process lets say we are running a .exe called <code>Google.exe</code>, and when you click the arrow it shows what is open inside. I'm trying to make it so that Google.exe launches in the form of a different app, (as if it was a notepad for example, but would still be a console app) This way my app stays different every time, and I can modify name string.</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 2628, "user_id": 2495728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bgl4n.jpg?s=128&g=1", "display_name": "Jonathan Alfaro", "link": "https://stackoverflow.com/users/2495728/jonathan-alfaro"}, "edited": false, "score": 0, "creation_date": 1576107191, "post_id": 59295590, "comment_id": 104795661, "body": "It depends on the type of the object and if the object can actually be converted to the target type"}, {"owner": {"reputation": 1361, "user_id": 11808788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90824afde2c0e06cc75077e8a411590b?s=128&d=identicon&r=PG&f=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/11808788/charles"}, "edited": false, "score": 1, "creation_date": 1576107789, "post_id": 59295590, "comment_id": 104795838, "body": "your string[] is not a list, so you cant cast it to that, you would have to do something like <code>((string[])value).ToList()</code>. JsonConvert can handle this, because it looks at the string and tries to parse the values."}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 1, "creation_date": 1576107857, "post_id": 59295590, "comment_id": 104795855, "body": "but this obviously will not work there is no conversion between <code>string[]</code> and <code>List&lt;string&gt;</code> ... feel free to use <code>GenericToStronglyTyped&lt;IEnumerable&lt;string&gt;&gt;</code> or <code>GenericToStronglyTyped&lt;string[]&gt;</code> ... v2 obviously will work as <code>List&lt;T&gt;</code> and <code>T[]</code> has the same JSON representation"}, {"owner": {"reputation": 390, "user_id": 10542513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KI47DMswagM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX8Jyi86l0cgUSnVVBJs9q9MU5aEA/mo/photo.jpg?sz=128", "display_name": "Brian says Reinstate Monica", "link": "https://stackoverflow.com/users/10542513/brian-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1576110844, "post_id": 59295590, "comment_id": 104796512, "body": "You may also be interested in seeing how how object mappings are accomplished in the Dapper library, which is one of the best-performing: <a href=\"https://github.com/StackExchange/Dapper\" rel=\"nofollow noreferrer\">github.com/StackExchange/Dapper</a>"}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1576112001, "post_id": 59295590, "comment_id": 104796703, "body": "You might try a few different ways. First try an <code>as</code> cast, then check if the type is convertible (using <code>is IConvertible</code>), then try a <i>classic</i> cast (with a <code>catch</code>). Take a look at @ericlippert&#39;s answer to <a href=\"https://stackoverflow.com/questions/2139798/does-it-make-sense-to-use-as-instead-of-a-cast-even-if-there-is-no-null-check\" title=\"does it make sense to use as instead of a cast even if there is no null check\">stackoverflow.com/questions/2139798/&hellip;</a> (and the link on his blog)"}], "answers": [{"tags": [], "owner": {"reputation": 390, "user_id": 10542513, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KI47DMswagM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DX8Jyi86l0cgUSnVVBJs9q9MU5aEA/mo/photo.jpg?sz=128", "display_name": "Brian says Reinstate Monica", "link": "https://stackoverflow.com/users/10542513/brian-says-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1576108228, "creation_date": 1576108228, "answer_id": 59295800, "question_id": 59295590, "link": "https://stackoverflow.com/questions/59295590/converting-a-generic-object-to-a-strongly-typed-t/59295800#59295800", "title": "Converting a generic object to a strongly typed T", "body": "<blockquote>\n  <p>That DOES work, but it feels like a bit of a gimmick. What is the best way to go about this?</p>\n</blockquote>\n\n<p>I feel that you're venturing into opinion here, but, here's mine: the solution you've presented as being gimmicky is both well-tested and extremely easy to read. I'll take those all day long.</p>\n\n<p>If at some point the serialization is too much overhead, then come back and take a closer look. But especially when shunting stringy data around, there are just too many edge cases to consider. This is a solved problem, so I'd recommend appreciating that those libraries exist and moving on to your actual business logic.</p>\n"}], "owner": {"reputation": 10230, "user_id": 1418704, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f23297149bdbeb4759cd00c5108f489b?s=128&d=identicon&r=PG", "display_name": "Casey Crookston", "link": "https://stackoverflow.com/users/1418704/casey-crookston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 59295800, "answer_count": 1, "score": 1, "last_activity_date": 1576108228, "creation_date": 1576106531, "question_id": 59295590, "link": "https://stackoverflow.com/questions/59295590/converting-a-generic-object-to-a-strongly-typed-t", "title": "Converting a generic object to a strongly typed T", "body": "<p>I am trying to write a method that will take a generic <code>object</code> and convert it into a type of <code>T</code>.  The context is, I've just made a REST API call and I have the content of the response in <code>value</code>. In THIS case, I happen to know that the return type is an array of strings.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5M2oK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5M2oK.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But of course, that won't always be the case.</p>\n\n<pre><code>using (var response = await client.SendAsync(request))\n{\n    HttpContent result = response.Content;\n    object value = ((ObjectContent)result).Value;\n\n    List&lt;string&gt; list = GenericToStronglyTyped&lt;List&lt;string&gt;&gt;(value);\n    List&lt;string&gt; list2 = GenericToStronglyTyped_v2&lt;List&lt;string&gt;&gt;(value);\n}\n</code></pre>\n\n<p>I found a similar question here that seemed positive:\n<a href=\"https://stackoverflow.com/questions/899629/cast-object-to-t\">Cast object to T</a></p>\n\n<p>And I tried the suggested answer as follows:</p>\n\n<pre><code>private T GenericToStronglyTyped&lt;T&gt;(object obj)\n{\n    if (obj is T)\n    {\n        return (T)obj;\n    }\n    try\n    {\n        return (T)Convert.ChangeType(obj, typeof(T));\n    }\n    catch (InvalidCastException)\n    {\n        return default(T);\n    }\n}\n</code></pre>\n\n<p>However, this returns <code>null</code> because of:</p>\n\n<blockquote>\n  <p>Object must implement IConvertible.</p>\n</blockquote>\n\n<p>So I came up with my own solution:</p>\n\n<pre><code>private T GenericToStronglyTyped_v2&lt;T&gt;(object obj)\n{            \n    try\n    {\n        string json = JsonConvert.SerializeObject(obj);\n        return JsonConvert.DeserializeObject&lt;T&gt;(json);\n    }\n    catch (InvalidCastException)\n    {\n        return default(T);\n    }\n}\n</code></pre>\n\n<p>That DOES work, but it feels like a bit of a gimmick. What is the best way to go about this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "xamarin", "xamarin.forms", "xamarin.android", "xamarin.ios"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 12520502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa20d2b716fbaf08fcfe02860ff6d03f?s=128&d=identicon&r=PG&f=1", "display_name": "Vreesie", "link": "https://stackoverflow.com/users/12520502/vreesie"}, "edited": false, "score": 0, "creation_date": 1576106826, "post_id": 59295600, "comment_id": 104795578, "body": "Thank you, I wasn&#39;t really looking for the code, but more the idea like this.... You are really helpful!"}], "tags": [], "owner": {"reputation": 7909, "user_id": 202179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xibo7.jpg?s=128&g=1", "display_name": "Ivan I\u010din", "link": "https://stackoverflow.com/users/202179/ivan-i%c4%8din"}, "is_accepted": true, "score": 0, "last_activity_date": 1576106612, "creation_date": 1576106612, "answer_id": 59295600, "question_id": 59295522, "link": "https://stackoverflow.com/questions/59295522/xamarin-add-click-event-in-custom-renderer/59295600#59295600", "title": "Xamarin Add click event in custom renderer", "body": "<p>There are lot of fine things that one needs to do here to make it work in a real good way and if you expect that then the question needs to be closed as this is not the site where someone else writes the code for you.</p>\n\n<p>Assuming you are fine with that, I'll give you just very basic idea on how to do it.</p>\n\n<p>The key is in recording the <code>DateTime</code> of <code>touchedDown = true;</code>and comparing it to the <code>DateTime</code> of <code>touchedDown = false;</code> and if it is below some threshold calling it 'click'. If you do just this there will be some artifacts but you need to resolve them.</p>\n"}], "owner": {"reputation": 93, "user_id": 12520502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa20d2b716fbaf08fcfe02860ff6d03f?s=128&d=identicon&r=PG&f=1", "display_name": "Vreesie", "link": "https://stackoverflow.com/users/12520502/vreesie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 59295600, "answer_count": 1, "score": 0, "last_activity_date": 1576106612, "creation_date": 1576105936, "question_id": 59295522, "link": "https://stackoverflow.com/questions/59295522/xamarin-add-click-event-in-custom-renderer", "title": "Xamarin Add click event in custom renderer", "body": "<p>I am using this Drag/Drop code: <a href=\"https://github.com/CrossGeeks/DragViewSample/tree/master/DragViewSample/DragViewSample\" rel=\"nofollow noreferrer\">https://github.com/CrossGeeks/DragViewSample/tree/master/DragViewSample/DragViewSample</a></p>\n\n<p>This works great, but now I want to not just be able to drag/drop an image, but also a click action. The function needs probably be done in the Custom renderer in this part of the code:</p>\n\n<pre><code>public override bool OnTouchEvent(MotionEvent e)\n{\n    float x = e.RawX;\n    float y = e.RawY;\n    var dragView = Element as DraggableView.DraggableView;\n    switch (e.Action)\n    {\n        case MotionEventActions.Down:\n            if (dragView.DragMode == DragMode.Touch)\n            {\n                if (!touchedDown)\n                {\n                    if (firstTime)\n                    {\n                        originalX = GetX();\n                        originalY = GetY();\n                        firstTime = false;\n                    }\n                    dragView.DragStarted();\n                }\n\n                touchedDown = true;\n            }\n            dX = x - this.GetX();\n            dY = y - this.GetY();\n            break;\n        case MotionEventActions.Move:\n            if (touchedDown)\n            {\n                if (dragView.DragDirection == DragDirectionType.All || dragView.DragDirection == DragDirectionType.Horizontal)\n                {\n                    SetX(x - dX);\n                }\n\n                if (dragView.DragDirection == DragDirectionType.All || dragView.DragDirection == DragDirectionType.Vertical)\n                {\n                    SetY(y - dY);\n                }\n\n            }\n            break;\n        case MotionEventActions.Up:\n            touchedDown = false;\n            dragView.DragEnded();\n            break;\n        case MotionEventActions.Cancel:\n            touchedDown = false;\n            break;\n    }\n    return base.OnTouchEvent(e);\n}\n</code></pre>\n\n<p>But I have no idea how I can add a Click function to it, without moving the image.\nJust for the idea, I want a popup when I click on the image and still be able to drag/drop when I hold it.\nCan someone help me?</p>\n"}, {"tags": ["c#", "azure"], "comments": [{"owner": {"reputation": 15383, "user_id": 8557999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e949becd6429559b4ae1e7d124475788?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Cai", "link": "https://stackoverflow.com/users/8557999/joey-cai"}, "edited": false, "score": 0, "creation_date": 1576545429, "post_id": 59295465, "comment_id": 104926539, "body": "Glad to hear that! You could accept it as answer(click on the check mark beside the answer to toggle it from greyed out to filled in)."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6688764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b059bf4561c8989ffec12c559d2a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Bomke", "link": "https://stackoverflow.com/users/6688764/ed-bomke"}, "edited": false, "score": 0, "creation_date": 1576171604, "post_id": 59300045, "comment_id": 104821925, "body": "Thanks Joey, that  fixed the problem !"}], "tags": [], "owner": {"reputation": 15383, "user_id": 8557999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e949becd6429559b4ae1e7d124475788?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Cai", "link": "https://stackoverflow.com/users/8557999/joey-cai"}, "is_accepted": false, "score": 5, "last_activity_date": 1576137709, "creation_date": 1576137709, "answer_id": 59300045, "question_id": 59295465, "link": "https://stackoverflow.com/questions/59295465/getting-metadata-generation-failed-when-building-c-function-app-in-visual-stu/59300045#59300045", "title": "Getting &quot;Metadata generation failed&quot; when building C# function app in Visual Studio 2019", "body": "<p>To solve this issue, upgraded <code>Microsoft.NET.Sdk.Functions</code> to last version(3.0.1).And delete the <code>netstandard1.0</code> folder:</p>\n\n<pre><code>\"C:\\Users\\myname\\.nuget\\packages\\microsoft.net.sdk.functions\\1.0.29\\build\\netstandard1.0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 944, "user_id": 1704837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DQtMg.gif?s=128&g=1", "display_name": "Aaron Reed", "link": "https://stackoverflow.com/users/1704837/aaron-reed"}, "is_accepted": false, "score": 0, "last_activity_date": 1588716841, "last_edit_date": 1588716841, "creation_date": 1588716455, "answer_id": 61623880, "question_id": 59295465, "link": "https://stackoverflow.com/questions/59295465/getting-metadata-generation-failed-when-building-c-function-app-in-visual-stu/61623880#61623880", "title": "Getting &quot;Metadata generation failed&quot; when building C# function app in Visual Studio 2019", "body": "<p>In Visual Studio, when locally building .net core \"azure functions\" apps with Visual Studio, you get these errors post-build:</p>\n\n<pre><code>Severity    Code    Description Project File    Line    Suppression State\nError       Metadata generation failed. MyProject.Api   C:\\Users\\user\\.nuget\\packages\\microsoft.net.sdk.functions\\3.0.7\\build\\Microsoft.NET.Sdk.Functions.Build.targets 44  \nError       Stack overflow.     MyProject.Api   C:\\Users\\user\\.nuget\\packages\\microsoft.net.sdk.functions\\3.0.7\\build\\Microsoft.NET.Sdk.Functions.Build.targets 44  \n</code></pre>\n\n<p>This is a very frustrating reoccurring build error and the app will not run via the Functions CLI tools.</p>\n\n<p>You may try:</p>\n\n<ul>\n<li>Rebooting system, close/reopen Visual Studio</li>\n<li>Manual steps of uninstall/reinstall .net frameworks or .net core</li>\n<li>Uninstall/reinstall Visual Studio\n\n<ul>\n<li>It may work for a while, then regress</li>\n</ul></li>\n<li>Completely reset Visual Studio</li>\n<li>Manual steps of deleting local nuget SDK items</li>\n<li>Upgrade your app's reference of \"Microsoft.NET.Sdk.Functions\" to the latest version</li>\n<li>The list goes on and on of things you may try to fix it...</li>\n</ul>\n\n<p>Note: This error does not happen in VS Code (for me), mainly because we run the explicit command: dotnet build</p>\n\n<p>So what fixed it?</p>\n\n<ul>\n<li>Uninstall all Visual Studio versions</li>\n<li>Uninstall all old Visual Studio build tools/TFS or Build tools/plugins/extensions (Jetbrains products included)</li>\n<li>Uninstall all .Net Core versions</li>\n<li>Uninstall all old SDKs</li>\n<li>Reviewing your installed \"Programs and Features\" list, be sure you uninstalled everything relating to SDKs, .Net Core, and Visual Studio.</li>\n<li>Install Visual Studio 2019\n\n<ul>\n<li>During Visual Studio 2019 install, on individual components tab, be sure this is check (should be by default):\n<a href=\"https://i.stack.imgur.com/r7lnq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r7lnq.png\" alt=\"individual components tab\"></a></li>\n</ul></li>\n</ul>\n\n<p>After install completes:</p>\n\n<ul>\n<li>Open Visual Studio -> Help -> About Microsoft Visual Studio</li>\n<li>Be sure these are installed:\n\n<ul>\n<li>Azure Functions and Web Jobs Tools (I have version: 16.5.236.49856)\n\n<ul>\n<li>Install instructions here: <a href=\"https://github.com/Azure/azure-functions-core-tools\" rel=\"nofollow noreferrer\">https://github.com/Azure/azure-functions-core-tools</a></li>\n</ul></li>\n<li>Microsoft Azure Tools (I have version: 2.9)\n\n<ul>\n<li>Search for installer or here's a link to 2.9: <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=51657\" rel=\"nofollow noreferrer\">https://www.microsoft.com/en-us/download/details.aspx?id=51657</a></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>In the freshly installed Visual Studio instance, open your Functions App, build it, and press F5 (the app runs via the AzureFunctionsTools cli_x64.exe process):\n<a href=\"https://i.stack.imgur.com/J0Sxe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J0Sxe.jpg\" alt=\"cli_x64.exe process\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 6688764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1b059bf4561c8989ffec12c559d2a7b?s=128&d=identicon&r=PG&f=1", "display_name": "Ed Bomke", "link": "https://stackoverflow.com/users/6688764/ed-bomke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1430, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1588716841, "creation_date": 1576105551, "question_id": 59295465, "link": "https://stackoverflow.com/questions/59295465/getting-metadata-generation-failed-when-building-c-function-app-in-visual-stu", "title": "Getting &quot;Metadata generation failed&quot; when building C# function app in Visual Studio 2019", "body": "<p>Starting with a C# function app created as a new project in VS2019 (16.4.1) and latest Azure libraries (Azure Functions and Web Jobs Tools 16.4.457.38025) from VS Installer, it fails to build every time.</p>\n\n<p><code>C:\\Users\\myname\\.nuget\\packages\\microsoft.net.sdk.functions\\1.0.29\\build\\netstandard1.0\\Microsoft.NET.Sdk.Functions.Build.targets(41,5): error : Metadata generation failed.</code></p>\n\n<p>Has anyone else been able to get this to work ?</p>\n"}, {"tags": ["c#", "combobox", "simplewifi"], "comments": [{"owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576104821, "post_id": 59295302, "comment_id": 104795001, "body": "SelectedItem is an object that can&#39;t be cast as combobox, this line is not correct <code>ComboBox selectedItem = (ComboBox)cbWifiname.SelectedItem</code>. what is the type of item you add there, is it a class or a string?"}, {"owner": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "reply_to_user": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576104992, "post_id": 59295302, "comment_id": 104795050, "body": "It&#39;s strings that are getting populated into the combobox"}, {"owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576105040, "post_id": 59295302, "comment_id": 104795061, "body": "instead of string use a class, let me write an answer."}, {"owner": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "reply_to_user": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576105109, "post_id": 59295302, "comment_id": 104795084, "body": "I&#39;m using a foreach loop to add the WiFi APs into the combobox"}, {"owner": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "reply_to_user": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576105118, "post_id": 59295302, "comment_id": 104795090, "body": "foreach (AccessPoint ap in aps)"}, {"owner": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "reply_to_user": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576105130, "post_id": 59295302, "comment_id": 104795095, "body": "cbWifiname.Items.Add(ap.Name.ToString());cbWifiname.Tag = ap;"}, {"owner": {"reputation": 1718, "user_id": 4394435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Er7lu.png?s=128&g=1", "display_name": "Blechdose", "link": "https://stackoverflow.com/users/4394435/blechdose"}, "edited": false, "score": 0, "creation_date": 1576151423, "post_id": 59295302, "comment_id": 104810403, "body": "by the way, what are you using? winforms? wpf? add the appropriate question tag"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "edited": false, "score": 0, "creation_date": 1576104844, "post_id": 59295339, "comment_id": 104795008, "body": "So would I have to use a key, value pair to save the value selcted from the ComboBox"}], "tags": [], "owner": {"reputation": 66, "user_id": 7631407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb608e093d07dbc12c46990b52e149d?s=128&d=identicon&r=PG&f=1", "display_name": "RPDF", "link": "https://stackoverflow.com/users/7631407/rpdf"}, "is_accepted": false, "score": 0, "last_activity_date": 1576104690, "creation_date": 1576104690, "answer_id": 59295339, "question_id": 59295302, "link": "https://stackoverflow.com/questions/59295302/getting-selected-item-from-combobox-and-setting-tag-value/59295339#59295339", "title": "Getting selected item from Combobox and setting tag value", "body": "<p>Please note that a combobox has a key, value pair, take a look on this\n<a href=\"https://stackoverflow.com/questions/6688157/how-to-set-selected-value-from-combobox\">How to set selected value from Combobox?</a></p>\n\n<p>hope it helps!</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "edited": false, "score": 0, "creation_date": 1576105518, "post_id": 59295395, "comment_id": 104795209, "body": "If I try this solution, my next line below of ap1 = (AccessPoint)selectedItem.Tag shows an error saying &quot;String does not contain a definition for Tag&quot;"}, {"owner": {"reputation": 1718, "user_id": 4394435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Er7lu.png?s=128&g=1", "display_name": "Blechdose", "link": "https://stackoverflow.com/users/4394435/blechdose"}, "reply_to_user": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "edited": false, "score": 0, "creation_date": 1576151080, "post_id": 59295395, "comment_id": 104810233, "body": "@SahilBora the second example i gave returns the string. the question is, do you really need a string or what does your code need. The class &quot;AccessPoint&quot; does not look like it accepts a string."}], "tags": [], "owner": {"reputation": 1718, "user_id": 4394435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Er7lu.png?s=128&g=1", "display_name": "Blechdose", "link": "https://stackoverflow.com/users/4394435/blechdose"}, "is_accepted": false, "score": 0, "last_activity_date": 1576105070, "creation_date": 1576105070, "answer_id": 59295395, "question_id": 59295302, "link": "https://stackoverflow.com/questions/59295302/getting-selected-item-from-combobox-and-setting-tag-value/59295395#59295395", "title": "Getting selected item from Combobox and setting tag value", "body": "<p>I think you cast the selectedItem to the type Combobox, while it actually is a ComboBoxItem. Maybe this will help:</p>\n\n<pre><code>ComboBoxItem selectedItem = ((ComboBox)cbWifiname).SelectedItem;\n</code></pre>\n\n<p>or if you really want to have it as a string:</p>\n\n<pre><code>string selectedItem = ((ComboBox)cbWifiname).SelectedItem.ToString();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "is_accepted": false, "score": 0, "last_activity_date": 1576105279, "creation_date": 1576105279, "answer_id": 59295426, "question_id": 59295302, "link": "https://stackoverflow.com/questions/59295302/getting-selected-item-from-combobox-and-setting-tag-value/59295426#59295426", "title": "Getting selected item from Combobox and setting tag value", "body": "<p>lets say that your items are a class like:</p>\n\n<pre><code>public class Wifi\n{\n     public string Name { get; set;}\n     public AccessPoint { get; set;}\n     //....\n}\n</code></pre>\n\n<p>Make display member to be the property you want to show:</p>\n\n<pre><code>cbWifiName.DisplayMember = \"Name\";\n</code></pre>\n\n<p>Add to ComboBox like:</p>\n\n<pre><code>cbWifiName.Items.Add(new Wifi{ Name = \"SomeName\", AccessPint = somevalue});\n</code></pre>\n\n<p>Now you can get it like:</p>\n\n<pre><code>Wifi selected = (Wifi)cbWifiName.SelectedItem;\nAccessPoint ap = selected.AccessPoint;\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6879807, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1421506484530441/picture?type=large", "display_name": "Sahil Bora", "link": "https://stackoverflow.com/users/6879807/sahil-bora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1576105279, "creation_date": 1576104458, "question_id": 59295302, "link": "https://stackoverflow.com/questions/59295302/getting-selected-item-from-combobox-and-setting-tag-value", "title": "Getting selected item from Combobox and setting tag value", "body": "<p>For my application, the user can select their preferred WiFi Access point they want to connect to using a Combobox. I'm trying to convert the selected item from the Combobox to a string value to be used with the SimpleWifi library</p>\n\n<p>This is my attempted solution:</p>\n\n<pre><code>ComboBox selectedItem = (ComboBox)cbWifiname.SelectedItem;\nAccessPoint ap = (AccessPoint)selectedItem.Tag;\n</code></pre>\n\n<p>An example code solution that I'm trying to follow</p>\n\n<pre><code>ListViewItem selecteditem = listView2.SelectedItems[0];\nAccessPoint ap = (AccessPoint)selecteditem.Tag;\n</code></pre>\n\n<p>But the result of my attempted solution of using a combobox, a debugging error showing \"Unable to cast object of type 'System.String to type 'System.Windows.Forms.Combobox''</p>\n"}, {"tags": ["c#", "firebase", "unity3d", "authentication"], "comments": [{"owner": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576107464, "post_id": 59295259, "comment_id": 104795743, "body": "PlayerPrefs.Save() writes data on the disk(e.g on pc it&#39;s hdd/ssd, on mobile it&#39;s internal storage (i know this info is 2*2=4 :D)). And maybe you don&#39;t have a permission on your machine to write the date from application, just try on other device or on other OS, otherwise everything looks fine in your code written above."}, {"owner": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576107555, "post_id": 59295259, "comment_id": 104795771, "body": "And also if I am wrong and there is not device permission issue, then you must search a problem in other scripts which are related to this one above(if there is any)"}, {"owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "reply_to_user": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576107838, "post_id": 59295259, "comment_id": 104795852, "body": "What kind of search problem? And I&#39;m admin on the computer and it works in the start method of the same script"}, {"owner": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576108351, "post_id": 59295259, "comment_id": 104795971, "body": "I mean your problem must be searched in other scripts not this one you posted here(that&#39;s only assumption) and where does it work? in editor or after build on actual device?"}, {"owner": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576108402, "post_id": 59295259, "comment_id": 104795979, "body": "or what is your target platform?"}, {"owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "reply_to_user": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576108409, "post_id": 59295259, "comment_id": 104795980, "body": "In editor. Haven&#39;t tested in build"}, {"owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "reply_to_user": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576108430, "post_id": 59295259, "comment_id": 104795985, "body": "Target is Android and ios"}, {"owner": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576109920, "post_id": 59295259, "comment_id": 104796315, "body": "just delete last line, playerperefs.save() and try, it may work"}, {"owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "reply_to_user": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576109964, "post_id": 59295259, "comment_id": 104796326, "body": "It doesn&#39;t even get that far though. It stops at seeing first name"}, {"owner": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576110584, "post_id": 59295259, "comment_id": 104796451, "body": "lets delete setPlayer() in getUserData() and let me know what unity does"}, {"owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "reply_to_user": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576111276, "post_id": 59295259, "comment_id": 104796588, "body": "Without it there it wouldn&#39;t try to set them at all"}, {"owner": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576111417, "post_id": 59295259, "comment_id": 104796614, "body": "I wonder it because to test if it crashes without using playerprefs"}, {"owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "reply_to_user": {"reputation": 450, "user_id": 9179925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t0P6M.jpg?s=128&g=1", "display_name": "Chestera", "link": "https://stackoverflow.com/users/9179925/chestera"}, "edited": false, "score": 0, "creation_date": 1576118702, "post_id": 59295259, "comment_id": 104798008, "body": "It never CRASHES persay, just doesnt execute the next lines of code. if i call the setPlayer() from start it works though. just not when i call it from the Firebase call."}, {"owner": {"reputation": 407, "user_id": 11699557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BtdFS.png?s=128&g=1", "display_name": "NSJacob1", "link": "https://stackoverflow.com/users/11699557/nsjacob1"}, "edited": false, "score": 0, "creation_date": 1577211441, "post_id": 59295259, "comment_id": 105122922, "body": "<code>Firebase.Auth</code> should be preferred over a homemade solution, and caches the current user so you don&#39;t have to connect every run to authenticate."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "edited": false, "score": 0, "creation_date": 1576161874, "post_id": 59297773, "comment_id": 104816329, "body": "thank you for pointing that out, i did notice that and have fixed it. however it was not the fix to my problem"}], "tags": [], "owner": {"reputation": 337, "user_id": 12302977, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_GH0fUyeOzQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdxeNYQiOkIaGwe7L4ajnYwgR1i2Q/photo.jpg?sz=128", "display_name": "gameDev_Unity", "link": "https://stackoverflow.com/users/12302977/gamedev-unity"}, "is_accepted": false, "score": 0, "last_activity_date": 1576126141, "last_edit_date": 1576126141, "creation_date": 1576125301, "answer_id": 59297773, "question_id": 59295259, "link": "https://stackoverflow.com/questions/59295259/unity-2019-2-12f1-playerprefs-halting-script/59297773#59297773", "title": "Unity 2019.2.12f1 PlayerPrefs halting script", "body": "<p>You are setting <code>userName</code></p>\n\n<blockquote>\n  <p>PlayerPrefs.SetString(\"userName\", LoggedUser[\"username\"]);</p>\n</blockquote>\n\n<p>and retrieving <code>username</code></p>\n\n<blockquote>\n  <p>Debug.Log(\"Welcome \" + PlayerPrefs.GetString(\"username\"));</p>\n</blockquote>\n\n<p>Also it should be </p>\n\n<blockquote>\n  <p>PlayerPrefs.SetString(\"userName\", LoggedUser[\"userName\"]);</p>\n</blockquote>\n\n<p>instead of </p>\n\n<blockquote>\n  <p>PlayerPrefs.SetString(\"userName\", LoggedUser[\"username\"]);</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/BWRW3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BWRW3.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "is_accepted": true, "score": 1, "last_activity_date": 1576161997, "creation_date": 1576161997, "answer_id": 59307106, "question_id": 59295259, "link": "https://stackoverflow.com/questions/59295259/unity-2019-2-12f1-playerprefs-halting-script/59307106#59307106", "title": "Unity 2019.2.12f1 PlayerPrefs halting script", "body": "<p>I was able to find the solution.</p>\n\n<p>getUserData() method is running async, which creats a new thread. the PlayerPrefs can only run on a main thread.</p>\n\n<p>My solution was to create a boolean that i flippd to true when the Data was loaded into LoggedUser. my Update() method was watching for that to flip to true, where it then called the setPlayer().</p>\n\n<p>Than you all for the help!</p>\n"}, {"tags": [], "owner": {"reputation": 1983, "user_id": 3043663, "user_type": "registered", "profile_image": "https://graph.facebook.com/290200030/picture?type=large", "display_name": "Patrick Martin", "link": "https://stackoverflow.com/users/3043663/patrick-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1577121033, "creation_date": 1577121033, "answer_id": 59458995, "question_id": 59295259, "link": "https://stackoverflow.com/questions/59295259/unity-2019-2-12f1-playerprefs-halting-script/59458995#59458995", "title": "Unity 2019.2.12f1 PlayerPrefs halting script", "body": "<p>If you don't mind, I can expand on your answer a little bit.</p>\n\n<p>If you use <a href=\"https://firebase.google.com/docs/reference/unity/class/firebase/extensions/task-extension\" rel=\"nofollow noreferrer\">ContinueWithOnMainThread</a> instead of ContinueWith, your continuation logic automatically occurs on the main thread (so you can write <code>PlayerPrefs</code>). I cover a whole ton of ways to handle threading with Firebase and Unity in <a href=\"https://firebase.googleblog.com/2019/07/firebase-and-tasks-how-to-deal-with.html\" rel=\"nofollow noreferrer\">this article</a> if you'd like to compare them.</p>\n\n<p>Furthermore, this is a stab in the dark, but if you're using Realtime Database then you may also be using <a href=\"https://firebase.google.com/products/auth\" rel=\"nofollow noreferrer\">Firebase Authentication</a>. If this is the case, then <a href=\"https://firebase.google.com/docs/reference/unity/class/firebase/auth/firebase-auth#currentuser\" rel=\"nofollow noreferrer\">FirebaseAuth.DefaultInstance.CurrentUser</a> actually persists between runs of your game (I cover this a little bit in <a href=\"https://youtu.be/52yUcKLMKX0\" rel=\"nofollow noreferrer\">this video</a>). Since Realtime Database also caches data you request locally, you may actually be doing extra work that the Firebase plugins will handle for you!</p>\n"}], "owner": {"reputation": 11, "user_id": 12521326, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-F-SZ_BXuzF4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2ribLHJ8joZQhgv_LPMFoZpXzvA/photo.jpg?sz=128", "display_name": "Ezekiel Hammond", "link": "https://stackoverflow.com/users/12521326/ezekiel-hammond"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 59307106, "answer_count": 3, "score": 0, "last_activity_date": 1577121033, "creation_date": 1576104243, "last_edit_date": 1576107093, "question_id": 59295259, "link": "https://stackoverflow.com/questions/59295259/unity-2019-2-12f1-playerprefs-halting-script", "title": "Unity 2019.2.12f1 PlayerPrefs halting script", "body": "<p>I am working on building out an authentication system for a project I am working on.</p>\n\n<p>Part of this is to save UserData locally so that it doesn't have to connect to cloud on every run, or force a login ETC.</p>\n\n<p>The problem i am having, is when i am trying to set PlayerPrefs it is not working. I have it running a Debug.Log before each PlayerPrefs.SetString and it only ever displays the first one.</p>\n\n<p>I am able to do PlayerPrefs.SetString in my Start() but for some reason it is not working here and i have no idea why.</p>\n\n<p>Everything works up until i am saving to PlayerPrefs</p>\n\n<p><code>public Dictionary&lt;string, string&gt; LoggedUser = new Dictionary&lt;string, string&gt;();</code></p>\n\n<pre><code>public void getUserData(string id, string email)\n    {\n        Debug.Log(\"Getting User Data for ID: \" + id);\n        FirebaseDatabase.DefaultInstance\n            .GetReference(id)\n            .GetValueAsync().ContinueWith(task1 =&gt;\n            {\n                if (task1.IsFaulted)\n                {\n                    Debug.Log(\"Failed\");\n                }\n                else if (task1.IsCompleted)\n                {\n                    Debug.Log(\"Data Retrieved\");\n                    DataSnapshot snapshot = task1.Result;\n                    foreach (DataSnapshot user in snapshot.Children)\n                    {\n\n                        string firstName = user.Child(\"firstName\").Value.ToString();\n                        string lastName = user.Child(\"lastName\").Value.ToString();\n                        string sex = user.Child(\"sex\").Value.ToString();\n                        string country = user.Child(\"country\").Value.ToString();\n                        string age = user.Child(\"age\").Value.ToString();\n                        string userName = user.Child(\"userName\").Value.ToString();\n\n                        Debug.Log(firstName);\n\n                        LoggedUser.Add(\"FirstName\", firstName);\n                        LoggedUser.Add(\"LastName\", lastName);\n                        LoggedUser.Add(\"Email\", email);\n                        LoggedUser.Add(\"age\", age);\n                        LoggedUser.Add(\"sex\", sex);\n                        LoggedUser.Add(\"country\", country);\n                        LoggedUser.Add(\"userName\", userName);\n\n\n                        Debug.Log(\"Welcome \" + LoggedUser[\"FirstName\"]);\n                        Debug.Log(\"User signed in successfully: \" +newUser.Email +\" \" +newUser.UserId);\n                        setPlayer();\n                    }\n                }\n            });\n    }\n\n</code></pre>\n\n<pre><code>public void setPlayer()\n    {\n        Debug.Log(\"Saving to PlayerPrefs\");\n        Debug.Log(\"Setting First Name\");\n        PlayerPrefs.SetString(\"FirstName\", \"Ezekiel\");\n        Debug.Log(\"Setting Last Name\");\n        PlayerPrefs.SetString(\"LastName\", LoggedUser[\"LastName\"]);\n        Debug.Log(\"Setting Email\");\n        PlayerPrefs.SetString(\"Email\", LoggedUser[\"Email\"]);\n        Debug.Log(\"Setting Age\");\n        PlayerPrefs.SetString(\"age\", LoggedUser[\"age\"]);\n        Debug.Log(\"Setting Sex\");\n        PlayerPrefs.SetString(\"sex\", LoggedUser[\"sex\"]);\n        Debug.Log(\"Setting Country\");\n        PlayerPrefs.SetString(\"country\", LoggedUser[\"country\"]);\n        Debug.Log(\"Setting userName\");\n        PlayerPrefs.SetString(\"userName\", LoggedUser[\"username\"]);\n        Debug.Log(\"Setting Loggedn State\");\n        PlayerPrefs.SetInt(\"LoggedIn\", 1);\n        Debug.Log(\"Saving Player Prefs\");\n        PlayerPrefs.Save();\n\n\n        Debug.Log(\"Welcome \" + PlayerPrefs.GetString(\"username\"));\n    }\n</code></pre>\n"}, {"tags": ["c#", "database"], "comments": [{"owner": {"reputation": 1865, "user_id": 5744718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c091b198fce4dd8b2f89083424eba63?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/5744718/sam"}, "edited": false, "score": 0, "creation_date": 1576103479, "post_id": 59295094, "comment_id": 104794595, "body": "what is the error you are getting?"}, {"owner": {"reputation": 5, "user_id": 12055696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e57d6749a2917534b6547f7ea8c49f0?s=128&d=identicon&r=PG&f=1", "display_name": "Minh Phan", "link": "https://stackoverflow.com/users/12055696/minh-phan"}, "reply_to_user": {"reputation": 1865, "user_id": 5744718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c091b198fce4dd8b2f89083424eba63?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/5744718/sam"}, "edited": false, "score": 0, "creation_date": 1576103626, "post_id": 59295094, "comment_id": 104794638, "body": "@sam It keeps saying invalid column name"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576103752, "post_id": 59295094, "comment_id": 104794675, "body": "undo the changes and see what broke it"}, {"owner": {"reputation": 2770, "user_id": 4123372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554c51966d0ad0646b8d62f8d25dccd3?s=128&d=identicon&r=PG&f=1", "display_name": "Train", "link": "https://stackoverflow.com/users/4123372/train"}, "edited": false, "score": 0, "creation_date": 1576103787, "post_id": 59295094, "comment_id": 104794690, "body": "For what column? <code>Status_ID</code>? Are you sure the data type is correct?"}, {"owner": {"reputation": 5, "user_id": 12055696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e57d6749a2917534b6547f7ea8c49f0?s=128&d=identicon&r=PG&f=1", "display_name": "Minh Phan", "link": "https://stackoverflow.com/users/12055696/minh-phan"}, "reply_to_user": {"reputation": 2770, "user_id": 4123372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/554c51966d0ad0646b8d62f8d25dccd3?s=128&d=identicon&r=PG&f=1", "display_name": "Train", "link": "https://stackoverflow.com/users/4123372/train"}, "edited": false, "score": 0, "creation_date": 1576103821, "post_id": 59295094, "comment_id": 104794701, "body": "@Train it says all the columns are invalid when I try to run it"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576103988, "post_id": 59295094, "comment_id": 104794754, "body": "@MinhPhan Please paste your code instead of screenshots"}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 0, "creation_date": 1576104008, "post_id": 59295094, "comment_id": 104794759, "body": "Are you connecting to right database?"}, {"owner": {"reputation": 5, "user_id": 12055696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e57d6749a2917534b6547f7ea8c49f0?s=128&d=identicon&r=PG&f=1", "display_name": "Minh Phan", "link": "https://stackoverflow.com/users/12055696/minh-phan"}, "reply_to_user": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 0, "creation_date": 1576104173, "post_id": 59295094, "comment_id": 104794809, "body": "@vendettamit yes because I have other mappers set to different webpages and all of those are still working fine"}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 1, "creation_date": 1576104250, "post_id": 59295094, "comment_id": 104794828, "body": "Then you might want to check if the correct reader is being passed to the Mapper method."}, {"owner": {"reputation": 5, "user_id": 12055696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e57d6749a2917534b6547f7ea8c49f0?s=128&d=identicon&r=PG&f=1", "display_name": "Minh Phan", "link": "https://stackoverflow.com/users/12055696/minh-phan"}, "reply_to_user": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576104262, "post_id": 59295094, "comment_id": 104794834, "body": "@Jawad Code is posted now"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576104488, "post_id": 59295094, "comment_id": 104794906, "body": "Can you post your Bug class ?"}, {"owner": {"reputation": 5, "user_id": 12055696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e57d6749a2917534b6547f7ea8c49f0?s=128&d=identicon&r=PG&f=1", "display_name": "Minh Phan", "link": "https://stackoverflow.com/users/12055696/minh-phan"}, "reply_to_user": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576105222, "post_id": 59295094, "comment_id": 104795122, "body": "@Jawad code is now posted"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576105384, "post_id": 59295094, "comment_id": 104795172, "body": "which line exactly does it throw the exception on"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576107408, "post_id": 59295094, "comment_id": 104795719, "body": "If you did a copy paste, then check your constructor. <code>public Bug(int id, string issuse</code>. Extra s in the word issue"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12055696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e57d6749a2917534b6547f7ea8c49f0?s=128&d=identicon&r=PG&f=1", "display_name": "Minh Phan", "link": "https://stackoverflow.com/users/12055696/minh-phan"}, "edited": false, "score": 0, "creation_date": 1576104054, "post_id": 59295182, "comment_id": 104794773, "body": "Good catch but it still says invalid column name &#39;ID&#39;, &#39;Issue&#39;, etc etc"}], "tags": [], "owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "is_accepted": false, "score": 3, "last_activity_date": 1576103799, "creation_date": 1576103799, "answer_id": 59295182, "question_id": 59295094, "link": "https://stackoverflow.com/questions/59295094/invalid-column-name-on-databases/59295182#59295182", "title": "Invalid Column Name on Databases", "body": "<p>line 20.. </p>\n\n<p>Change </p>\n\n<pre><code>int id = GetInteger(\"ID'\");\n</code></pre>\n\n<p>to </p>\n\n<pre><code>int id = GetInteger(\"ID\"); // Without the quote\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12055696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e57d6749a2917534b6547f7ea8c49f0?s=128&d=identicon&r=PG&f=1", "display_name": "Minh Phan", "link": "https://stackoverflow.com/users/12055696/minh-phan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576104723, "creation_date": 1576103366, "last_edit_date": 1576104723, "question_id": 59295094, "link": "https://stackoverflow.com/questions/59295094/invalid-column-name-on-databases", "title": "Invalid Column Name on Databases", "body": "<p>Screenshot showing column &amp; column entry\n<img src=\"https://i.stack.imgur.com/d4Izq.jpg\" alt=\"Screenshot showing column &amp; column entry\"></p>\n\n<p>Hey all, I'm getting an error saying my column names are invalid. I know it's not the table that is wrong because it worked perfectly fine an hour ago. I tried different variations of the Id, issue, etc with no luck. </p>\n\n<pre><code>namespace Csis265.DAL\n{\n    public class BugMapper : BaseMapper\n    {\n        public BugMapper(SqlDataReader rdr) : base(rdr)\n        { }\n\n        public override object DoMapping()\n        {\n            logger.Debug(\"INSIDE BugMapper DoMapping() !!!\");\n\n            int id = GetInteger(\"ID\");\n            string issue = GetString(\"ISSUE\");\n            string resolution = GetString(\"RESOLUTION\");\n            int statusId = GetInteger(\"STATUS_ID\");\n            int priorityId = GetInteger(\"PRIORITY_ID\");\n            int softwareappId = GetInteger(\"SOFTWARE_APP_ID\");\n            DateTime dateCreated = GetDateTime(\"DATE_CREATED\");\n            DateTime dateResolved = GetDateTime(\"DATE_RESOLVED\");\n\n            Bug rtnObj = new Bug(id, issue, resolution,\n                statusId, priorityId, softwareappId, dateCreated, dateResolved);\n\n            logger.Debug($\"INSIDE BugMapper DoMapping() {rtnObj.ToString()}\");\n\n            return rtnObj;\n        }\n    }\n</code></pre>\n\n<p>BUG CLASS - Nothing was touched besides the issue get/set. I originally had it as name instead of issue but have fixed that mistake </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing log4net;\n\nnamespace Csis265.Domain\n{\n    public class Bug : BaseObject\n    {\n        protected string issue;\n        protected string resolution;\n        protected int statusId;\n        protected int priorityId;\n        protected int softwareappId;\n        protected Status status;\n        protected Priority priority;\n        protected SoftwareApp softwareapp;\n\n        public Status Status\n        {\n            get { return status; }\n            set { status = value; }\n        }\n\n        public Priority Priority\n        {\n            get { return priority; }\n            set { priority = value; }\n        }\n\n        public SoftwareApp SoftwareApp\n        {\n            get { return softwareapp; }\n            set { softwareapp = value; }\n        }\n\n        public int Id\n        {\n            get { return id; }\n            set { id = value; }\n        }\n\n        public string Issue\n        {\n            get { return issue; }\n            set { issue = value; }\n        }\n\n        public string Resolution\n        {\n            get { return resolution; }\n            set { resolution = value; }\n        }\n\n        public string StatusName\n        {\n            get { return Status.Name; }\n        }\n\n        public string PriorityName\n        {\n            get { return Priority.Name; }\n        }\n\n        public string SoftwareAppName\n        {\n            get { return SoftwareApp.Name; }\n        }\n\n        public Bug(int id, string issuse, string resolution, \n            int statusId, int priorityId, int softwareappId, \n            DateTime dateCreated, DateTime dateResolved) : base(id, dateCreated)\n        {\n            SetIssue(issue);\n            SetResolution(resolution);\n            SetStatusId(statusId);\n            SetPriorityId(priorityId);\n            SetSoftwareAppId(softwareappId);\n        }\n\n        public void SetIssue(string issue)\n        {\n            this.issue = issue;\n        }\n\n        private void SetSoftwareAppId(int softwareappId)\n        {\n            this.softwareappId = softwareappId;\n        }\n\n        private void SetPriorityId(int priorityId)\n        {\n            this.priorityId = priorityId;\n        }\n\n        private void SetStatusId(int statusId)\n        {\n            this.statusId = statusId;\n        }\n\n        private void SetResolution(string resolution)\n        {\n            this.resolution = resolution;\n        }\n\n        public string GetIssue()\n        {\n            return issue;\n        }\n\n        public override string ToString()\n        {\n            return $\"BUG ID:{id} ISSUE: {issue} DTC: {dateCreated}\";\n        }\n\n        public string GetResolution()\n        {\n            return resolution;\n        }\n\n        public int GetStatusId()\n        {\n            return statusId;\n        }\n\n        public int GetPriorityId()\n        {\n            return priorityId;\n        }\n\n        public int GetSoftwareAppId()\n        {\n            return softwareappId;\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "clipboard"], "comments": [{"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576119336, "post_id": 59294906, "comment_id": 104798116, "body": "I dont believe the text has been erased, the proper word would be, &quot;sanitized&quot;. From MS site <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.clipboard?view=netframework-4.8\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a>: &quot;A non-Windows Presentation Foundation (WPF) full trust application can examine the ApplicationTrust format on the clipboard and sanitize the XAML if appropriate.&quot;"}, {"owner": {"reputation": 1, "user_id": 11466855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4018c4ff8b1132110d0ba29d03416be8?s=128&d=identicon&r=PG&f=1", "display_name": "techcase", "link": "https://stackoverflow.com/users/11466855/techcase"}, "reply_to_user": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576163833, "post_id": 59294906, "comment_id": 104817539, "body": "I agree, I think that this is what is happening since I still have the lines available.  So, the question is, how do I overcome this issue so that I can paste the data as it is copied?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11466855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4018c4ff8b1132110d0ba29d03416be8?s=128&d=identicon&r=PG&f=1", "display_name": "techcase", "link": "https://stackoverflow.com/users/11466855/techcase"}, "edited": false, "score": 0, "creation_date": 1576163559, "post_id": 59295477, "comment_id": 104817347, "body": "I checked and nothing else is updating the clipboard.  My application is a WPF application, so that handles the clipboard a little differently I suppose.  I think @Jawad is closest to the answer.  I think that the text is getting sanitized, but I don&#39;t know how to get the text to remain without being sanitized when I paste it."}], "tags": [], "owner": {"reputation": 143, "user_id": 5145250, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1370274443/picture?type=large", "display_name": "bakester14", "link": "https://stackoverflow.com/users/5145250/bakester14"}, "is_accepted": false, "score": 0, "last_activity_date": 1576105628, "creation_date": 1576105628, "answer_id": 59295477, "question_id": 59294906, "link": "https://stackoverflow.com/questions/59294906/how-to-maintain-data-in-the-clipboard-after-setting-it-in-a-wpf-application/59295477#59295477", "title": "How to maintain data in the clipboard after setting it in a WPF application", "body": "<p>I wrote a quick Linqpad script that just consists of the following line:</p>\n\n<p><code>System.Windows.Clipboard.SetText(\"Hello\");</code></p>\n\n<p>And my clipboard is successfully set to \"Hello\" and stays that way after the program exits. Is there something else in your application that is modifying the clipboard?</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11466855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4018c4ff8b1132110d0ba29d03416be8?s=128&d=identicon&r=PG&f=1", "display_name": "techcase", "link": "https://stackoverflow.com/users/11466855/techcase"}, "edited": false, "score": 0, "creation_date": 1576163701, "post_id": 59298664, "comment_id": 104817450, "body": "Yeah, I checked and the Main method has the STAThreadAttribute on it.  I think the biggest issue is that this is a WPF application."}], "tags": [], "owner": {"reputation": 673, "user_id": 5096993, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b27b9971e0e1e2006964e148b8cc22e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur Tripathi", "link": "https://stackoverflow.com/users/5096993/ankur-tripathi"}, "is_accepted": false, "score": 0, "last_activity_date": 1576131106, "creation_date": 1576131106, "answer_id": 59298664, "question_id": 59294906, "link": "https://stackoverflow.com/questions/59294906/how-to-maintain-data-in-the-clipboard-after-setting-it-in-a-wpf-application/59298664#59298664", "title": "How to maintain data in the clipboard after setting it in a WPF application", "body": "<p>Check this </p>\n\n<blockquote>\n  <p><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.clipboard.settext?redirectedfrom=MSDN&amp;view=netframework-4.8#System_Windows_Forms_Clipboard_SetText_System_String_\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.clipboard.settext?redirectedfrom=MSDN&amp;view=netframework-4.8#System_Windows_Forms_Clipboard_SetText_System_String_</a></p>\n</blockquote>\n\n<pre><code>public String SwapClipboardHtmlText(String replacementHtmlText)\n{\n    String returnHtmlText = null;\n    if (Clipboard.ContainsText(TextDataFormat.Html))\n    {\n        returnHtmlText = Clipboard.GetText(TextDataFormat.Html);\n        Clipboard.SetText(replacementHtmlText, TextDataFormat.Html);\n    }\n    return returnHtmlText;\n}\n</code></pre>\n\n<blockquote>\n  <p>The Clipboard class can only be used in threads set to single thread\n  apartment (STA) mode. To use this class, ensure that your Main method\n  is marked with the STAThreadAttribute attribute.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 11466855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4018c4ff8b1132110d0ba29d03416be8?s=128&d=identicon&r=PG&f=1", "display_name": "techcase", "link": "https://stackoverflow.com/users/11466855/techcase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576131106, "creation_date": 1576102388, "question_id": 59294906, "link": "https://stackoverflow.com/questions/59294906/how-to-maintain-data-in-the-clipboard-after-setting-it-in-a-wpf-application", "title": "How to maintain data in the clipboard after setting it in a WPF application", "body": "<p>I'm trying to set the Text value of the Clipboard to the value of a string variable in a WPF application on .NET 4.7.2.  If I debug the application and stop the execution right after the clipboard value has been saved then the value is there in clipboard and I can paste it as expected.  If I continue execution then the value is wiped of sorts.  For example, this is code that I can use to test with:</p>\n\n<pre><code>public void CopyToClipboard()\n{\n    string temp = \"test\\ntest\\ntest\";\n    System.Windows.Clipboard.SetText(temp);\n}\n</code></pre>\n\n<p>As you can see there are three lines that should be pasted.  When I stop execution right after saving to the clipboard I will see an output like so:</p>\n\n<pre><code>test\ntest\ntest\n</code></pre>\n\n<p>If I continue execution (by hitting F5 or the \"Continue\" button in Visual Studio) then when I paste I get three lines of '\\t' tabs.  So, my three lines still exist, but the text has been erased.</p>\n\n<p>Can anyone help me to get this resolved.  What is causing me to loose the data in the clipboard?</p>\n"}, {"tags": ["c#", "linq", "select", "properties"], "comments": [{"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1576102620, "post_id": 59294825, "comment_id": 104794312, "body": "Not quite. I know how to get a list of properties of a class. My problem is that since the acquired property names will be <code>string</code>, I can&#39;t do something like <code>list.Select(x =&gt; x.(property name)</code>, because, that wouldn&#39;t obviously work."}, {"owner": {"reputation": 4090, "user_id": 190042, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5ZXq7.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/190042/jonathan"}, "edited": false, "score": 0, "creation_date": 1576102669, "post_id": 59294825, "comment_id": 104794326, "body": "Not 100% sure how you&#39;d implement it, but this looks a lot like <code>IValidatable</code> that&#39;s widely used in MVC / with data annotations. Maybe you could use <code>IValidatable</code> here, or think about creating a custom version of it. You would have to have validation ruls and then <code>yield return</code> when you do your validation checks"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1576103665, "post_id": 59294825, "comment_id": 104794650, "body": "Then is something like this what you want?  <a href=\"https://dotnetfiddle.net/TCx5HN\" rel=\"nofollow noreferrer\">dotnetfiddle.net/TCx5HN</a>  I whipped it up quickly, it could probably be made more efficient by replacing the LINQ query by a manual loop..."}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1576104143, "post_id": 59294825, "comment_id": 104794803, "body": "@dbc this looks promising. Let me take a closer look."}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1576104496, "post_id": 59294825, "comment_id": 104794907, "body": "Sweet, it works perfect. I&#39;ll accept it if you post it as an answer."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 1, "creation_date": 1576104967, "post_id": 59294825, "comment_id": 104795045, "body": "@Sach - I sped it up a bit by replacing the LINQ query + <code>Distinct()</code> with a simple loop."}], "answers": [{"comments": [{"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1576105553, "post_id": 59295372, "comment_id": 104795226, "body": "Thanks, this looks perfect!"}], "tags": [], "owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "is_accepted": true, "score": 1, "last_activity_date": 1576105571, "last_edit_date": 1576105571, "creation_date": 1576104931, "answer_id": 59295372, "question_id": 59294825, "link": "https://stackoverflow.com/questions/59294825/based-on-a-list-of-class-objects-how-to-create-a-list-of-valid-property-names/59295372#59295372", "title": "Based on a list of class objects, how to create a list of valid property names?", "body": "<p>You can use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.type.getproperties?view=netframework-4.8\" rel=\"nofollow noreferrer\"><code>Type.GetProperties()</code></a> to get all properties of your type, then use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.reflection.memberinfo.name?view=netframework-4.8#System_Reflection_MemberInfo_Name\" rel=\"nofollow noreferrer\"><code>PropertyInfo.Name</code></a>, <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.reflection.propertyinfo.propertytype?view=netframework-4.8#System_Reflection_PropertyInfo_PropertyType\" rel=\"nofollow noreferrer\"><code>PropertyInfo.PropertyType</code></a> and <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.reflection.propertyinfo.getvalue?view=netframework-4.8#System_Reflection_PropertyInfo_GetValue_System_Object_\" rel=\"nofollow noreferrer\"><code>PropertyInfo.GetValue()</code></a> to get the names and values of all string properties of each <code>Data</code> item in your collection. With that you can collect the names of all properties with at least one valid value as follows:</p>\n\n<pre><code>public static class ValidationExtensions\n{\n    public static ICollection&lt;string&gt; ValidProperties&lt;TObject, TValue&gt;(this IEnumerable&lt;TObject&gt; items, Predicate&lt;TValue&gt; isValid)\n    {\n        var properties = typeof(TObject).GetProperties(BindingFlags.Public | BindingFlags.Instance)\n            .Where(p =&gt; typeof(TValue).IsAssignableFrom(p.PropertyType))\n            .Where(p =&gt; p.CanRead &amp;&amp; p.GetIndexParameters().Length == 0 &amp;&amp; p.GetGetMethod() != null)\n            .ToList();\n\n        var set = new HashSet&lt;string&gt;();\n\n        foreach (var i in items) // Only iterate through the items once.\n            foreach (var p in properties)\n            {\n                if (set.Contains(p.Name)) // Do not call GetValue() if not necessary, it's expensive.\n                    continue;\n                if (isValid((TValue)p.GetValue(i)))\n                    set.Add(p.Name);\n            }\n\n        // Return properties in order\n        return properties.Select(p =&gt; p.Name).Where(n =&gt; set.Contains(n)).ToList();\n    }\n}\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>If performance is an issue, you might want to build a table of delegates for accessing the property values of a given type using <code>Delegate.CreateDelegate</code>, e.g. as shown in <a href=\"https://stackoverflow.com/a/724427/3744182\">this answer</a> to <em><a href=\"https://stackoverflow.com/q/724143/3744182\">How do I create a delegate for a .NET property?</a></em>.</li>\n</ul>\n\n<p>Demo fiddle <a href=\"https://dotnetfiddle.net/TCx5HN\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 59295372, "answer_count": 1, "score": 1, "last_activity_date": 1576105571, "creation_date": 1576102009, "question_id": 59294825, "link": "https://stackoverflow.com/questions/59294825/based-on-a-list-of-class-objects-how-to-create-a-list-of-valid-property-names", "title": "Based on a list of class objects, how to create a list of valid property names?", "body": "<p>I have a <code>Data</code> class that looks like the following.</p>\n\n<pre><code>public class Data\n{\n    public string Dt1 { get; set; }\n    public string Dt2 { get; set; }\n    public string Dt3 { get; set; }\n    public string Dt4 { get; set; }\n    public string Dt5 { get; set; }\n}\n</code></pre>\n\n<p>And a list of class objects of it, with following sample data.</p>\n\n<pre><code>var list = new List&lt;Data&gt;\n{\n    new Data() { Dt1 = \"DtA\", Dt2 = string.Empty, Dt3 = \"-\", Dt5 = \"DtC\" },\n    new Data() { Dt1 = \"DtB\", Dt2 = string.Empty, Dt3 = string.Empty, Dt5 = \"-\" },\n    new Data() { Dt1 = \"DtC\", Dt2 = \"-\", Dt5 = \"-\" },\n    new Data() { Dt1 = \"DtD\", Dt2 = string.Empty, Dt3 = \"DtX\", Dt5 = string.Empty },\n    new Data() { Dt1 = \"DtE\", Dt3 = \"-\" }\n};\n</code></pre>\n\n<p>I have a list of 'invalid' strings, which are the following.</p>\n\n<pre><code>var invalid = new List&lt;string&gt;() { string.Empty, \"-\", null };\n</code></pre>\n\n<p>Now, I'd like to identify property names from the above list, which contain at least one <em>valid</em> string, and then create a <code>List&lt;string&gt;</code> with those property names. If we consider above sample data, you can see that,</p>\n\n<ul>\n<li>All <code>Dt1</code> values are valid.</li>\n<li>All <code>Dt2</code> values are invalid.</li>\n<li><code>Dt3</code> has at least one valid value.</li>\n<li><code>Dt4</code> is never assigned, therefore, all values are invalid.</li>\n<li><code>Dt5</code> has at least one valid value.</li>\n</ul>\n\n<p>So, my resulting list should be</p>\n\n<blockquote>\n  <p>Dt1, Dt3, Dt5</p>\n</blockquote>\n\n<p>My approach for this is to write a function that identify if there's at least one valid value in a string, and then check each property of the list using that.</p>\n\n<pre><code>public static bool IsDataValid(List&lt;string&gt; data, List&lt;string&gt; invalid)\n{\n    foreach (var item in data)\n    {\n        if (!invalid.Contains(item))\n        {\n            return true;\n        }\n    }\n    return false;\n}\n</code></pre>\n\n<p>Then,</p>\n\n<pre><code>var invalid = new List&lt;string&gt;() { string.Empty, \"-\", null };\nvar result = new List&lt;string&gt;();\nif (IsDataValid(list.Select(x =&gt; x.Dt1).ToList(), invalid))\n{\n    result.Add(\"Dt1\");\n}\nif (IsDataValid(list.Select(x =&gt; x.Dt2).ToList(), invalid))\n{\n    result.Add(\"Dt2\");\n}\nif (IsDataValid(list.Select(x =&gt; x.Dt3).ToList(), invalid))\n{\n    result.Add(\"Dt3\");\n}\nif (IsDataValid(list.Select(x =&gt; x.Dt4).ToList(), invalid))\n{\n    result.Add(\"Dt4\");\n}\nif (IsDataValid(list.Select(x =&gt; x.Dt5).ToList(), invalid))\n{\n    result.Add(\"Dt5\");\n}\n</code></pre>\n\n<p>This works, sure, but it's a bit 'ugly' for my taste. Also, my actual <code>Data</code> class has 20+ properties, so I'd have to use 20 <code>if</code> statements, which again smells of bad design. </p>\n\n<p>I was wondering if there's another way, particularly one where I don't have to 'hardcode' if statements. Something like the following where I can iterate the properties of the class and figure out which of them from the list are valid.</p>\n\n<pre><code>foreach (var prop in typeof(Data).GetProperties())\n{\n    // How do I do a `.Select()` here?\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "line", "draw", "measure"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 10725747, "user_type": "registered", "profile_image": "https://graph.facebook.com/1022816427905321/picture?type=large", "display_name": "Fallingsappy", "link": "https://stackoverflow.com/users/10725747/fallingsappy"}, "edited": false, "score": 1, "creation_date": 1576183172, "post_id": 59308672, "comment_id": 104826621, "body": "<code>private void ImageBox_OnMouseMove(object sender, MouseEventArgs e)     {         ImageSource imageSource = Image_Box.Source;         BitmapSource bitmapImage = (BitmapSource)imageSource;         TextBoxCursor_X.Text =( e.GetPosition(Image_Box).X * bitmapImage.PixelWidth &#47; Image_Box.ActualWidth).ToString();         TextBoxCursor_Y.Text = (e.GetPosition(Image_Box).Y * bitmapImage.PixelHeight &#47; Image_Box.ActualHeight).ToString();     }</code>"}, {"owner": {"reputation": 153, "user_id": 10725747, "user_type": "registered", "profile_image": "https://graph.facebook.com/1022816427905321/picture?type=large", "display_name": "Fallingsappy", "link": "https://stackoverflow.com/users/10725747/fallingsappy"}, "edited": false, "score": 1, "creation_date": 1576183237, "post_id": 59308672, "comment_id": 104826650, "body": "Had to also add this, but you solution is realy nice. Thanks a lot."}], "tags": [], "owner": {"reputation": 2032, "user_id": 5858936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpy9b.png?s=128&g=1", "display_name": "Keithernet", "link": "https://stackoverflow.com/users/5858936/keithernet"}, "is_accepted": true, "score": 1, "last_activity_date": 1576167106, "creation_date": 1576167106, "answer_id": 59308672, "question_id": 59294808, "link": "https://stackoverflow.com/questions/59294808/how-to-get-exact-pixel-count-between-two-points-on-jpeg-image-which-is-rendered/59308672#59308672", "title": "How to get exact pixel count between two points on jpeg image which is rendered with WPF. My solution differs from GIMP", "body": "<p>There is a Win32 GDI call (<code>LineDDA</code>) that will enumerate the points (pixels) between two points.</p>\n\n<p>Getting the count of points will give you the length of the line in pixels.</p>\n\n<p>This <a href=\"https://stackoverflow.com/a/17371697/5858936\">answer</a> has C# code that you can use. I tried it with your sample code and was able to get a proper pixel length.</p>\n\n<p>Here is the code for reference:</p>\n\n<pre><code>public static List&lt;Point&gt; GetPointsOnLine(System.Drawing.Point point1, System.Drawing.Point point2)\n{\n    var points = new List&lt;Point&gt;();\n    var handle = GCHandle.Alloc(points);\n    try\n    {\n        LineDDA(point1.X, point1.Y, point2.X, point2.Y, GetPointsOnLineCallback, GCHandle.ToIntPtr(handle));\n    }\n    finally\n    {\n        handle.Free();\n    }\n    return points;\n}\n\nprivate static void GetPointsOnLineCallback(int x, int y, IntPtr lpData)\n{\n    var handle = GCHandle.FromIntPtr(lpData);\n    var points = (List&lt;Point&gt;)handle.Target;\n    points.Add(new Point(x, y));\n}\n\n[DllImport(\"gdi32.dll\")]\nprivate static extern bool LineDDA(int nXStart, int nYStart, int nXEnd, int nYEnd, LineDDAProc lpLineFunc, IntPtr lpData);\n\n// The signature for the callback method\nprivate delegate void LineDDAProc(int x, int y, IntPtr lpData);\n</code></pre>\n\n<p>Note, that the <code>GetPointsOnLine</code> method using <code>System.Drawing.Point</code> instead of <code>System.Windows.Point</code>. </p>\n"}], "owner": {"reputation": 153, "user_id": 10725747, "user_type": "registered", "profile_image": "https://graph.facebook.com/1022816427905321/picture?type=large", "display_name": "Fallingsappy", "link": "https://stackoverflow.com/users/10725747/fallingsappy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 59308672, "answer_count": 1, "score": 1, "last_activity_date": 1576167106, "creation_date": 1576101923, "question_id": 59294808, "link": "https://stackoverflow.com/questions/59294808/how-to-get-exact-pixel-count-between-two-points-on-jpeg-image-which-is-rendered", "title": "How to get exact pixel count between two points on jpeg image which is rendered with WPF. My solution differs from GIMP", "body": "<p>I'm trying to get exact pixel count between two points on jpeg image. To do so i use user drawn line in WPF application using Line class. My solution is to calculate distance between two end points of this line seems to be pretty off and it returns fractional number which obviously not pixel count. Here is the code for drawing line:</p>\n\n<pre><code>        // The \"size\" of an object for mouse over purposes.\n    private const int ObjectRadius = 3;\n\n    // We're over an object if the distance squared\n    // between the mouse and the object is less than this.\n    private const int OverDistSquared = ObjectRadius * ObjectRadius;\n\n    // The line we're drawing or moving.\n    private Line _selectedLine;\n\n    private List&lt;Line&gt; _lines = new List&lt;Line&gt;();\n\n    // True if we're moving the line's first starting end point.\n    private bool _movingStartEndPoint = false;\n\n    // The offset from the mouse to the object being moved.\n    private double _offsetX, _offsetY;\n\n    // Save the trash can dimensions.\n    private double _trashWidth, _trashHeight;\n\n    // The mouse is up. See whether we're over an end point or segment.\n    private void canDrawing_MouseMove_NotDown(object sender, MouseEventArgs e)\n    {\n        Cursor newCursor = Cursors.Cross;\n\n        // See what we're over.\n        Point location = e.MouseDevice.GetPosition(canDrawing);\n        if (MouseIsOverEndpoint(location, out _selectedLine, out _movingStartEndPoint))\n            newCursor = Cursors.Arrow;\n        else if (MouseIsOverLine(location, out _selectedLine))\n            newCursor = Cursors.Hand;\n\n        // Set the new cursor.\n        if (canDrawing.Cursor != newCursor)\n            canDrawing.Cursor = newCursor;\n    }\n\n    // See what we're over and start doing whatever is appropriate.\n    private void canDrawing_MouseDown(object sender, MouseButtonEventArgs e)\n    {\n        // See what we're over.\n        Point location = e.MouseDevice.GetPosition(canDrawing);\n        if (MouseIsOverEndpoint(location, out _selectedLine, out _movingStartEndPoint))\n        {\n            // Start moving this end point.\n            canDrawing.MouseMove -= canDrawing_MouseMove_NotDown;\n            canDrawing.MouseMove += canDrawing_MouseMove_MovingEndPoint;\n            canDrawing.MouseUp += canDrawing_MouseUp_MovingEndPoint;\n\n            // Remember the offset from the mouse to the point.\n            Point hitPoint;\n            if (_movingStartEndPoint)\n                hitPoint = new Point(_selectedLine.X1, _selectedLine.Y1);\n            else\n                hitPoint = new Point(_selectedLine.X2, _selectedLine.Y2);\n            _offsetX = hitPoint.X - location.X;\n            _offsetY = hitPoint.Y - location.Y;\n        }\n        else if (MouseIsOverLine(location, out _selectedLine))\n        {\n            // Start moving this segment.\n            canDrawing.MouseMove -= canDrawing_MouseMove_NotDown;\n            canDrawing.MouseMove += canDrawing_MouseMove_MovingSegment;\n            canDrawing.MouseUp += canDrawing_MouseUp_MovingSegment;\n\n            // Remember the offset from the mouse\n            // to the segment's first end point.\n            _offsetX = _selectedLine.X1 - location.X;\n            _offsetY = _selectedLine.Y1 - location.Y;\n        }\n        else\n        {\n            // Start drawing a new segment.\n            canDrawing.MouseMove -= canDrawing_MouseMove_NotDown;\n            canDrawing.MouseMove += canDrawing_MouseMove_Drawing;\n            canDrawing.MouseUp += canDrawing_MouseUp_Drawing;\n\n            _selectedLine = new Line\n            {\n                Stroke = Brushes.Red,\n                X1 = location.X,\n                Y1 = location.Y,\n                X2 = location.X,\n                Y2 = location.Y\n            };\n\n            canDrawing.Children.Add(_selectedLine);\n        }\n    }\n\n    #region Distance Methods\n\n    // See if the mouse is over an end point.\n    private bool MouseIsOverEndpoint(Point mousePt, out Line hitLine, out bool startEndpoint)\n    {\n        foreach (object obj in canDrawing.Children)\n        {\n            // Only process Lines.\n            if (obj is Line)\n            {\n                Line line = obj as Line;\n\n                // Check the starting point.\n                Point point = new Point(line.X1, line.Y1);\n                if (FindDistanceToPointSquared(mousePt, point) &lt; OverDistSquared)\n                {\n                    // We're over this point.\n                    hitLine = line;\n                    startEndpoint = true;\n                    return true;\n                }\n\n                // Check the end point.\n                point = new Point(line.X2, line.Y2);\n                if (FindDistanceToPointSquared(mousePt, point) &lt; OverDistSquared)\n                {\n                    // We're over this point.\n                    hitLine = line;\n                    startEndpoint = false;\n                    return true;\n                }\n            }\n        }\n\n        hitLine = null;\n        startEndpoint = false;\n        return false;\n    }\n\n    // See if the mouse is over a line segment.\n    private bool MouseIsOverLine(Point mousePt, out Line hitLine)\n    {\n        foreach (object obj in canDrawing.Children)\n        {\n            // Only process Lines.\n            if (obj is Line)\n            {\n                Line line = obj as Line;\n\n                // See if we're over this line.\n                Point closest;\n                Point pt1 = new Point(line.X1, line.Y1);\n                Point pt2 = new Point(line.X2, line.Y2);\n                if (FindDistanceToSegmentSquared(\n                    mousePt, pt1, pt2, out closest)\n                        &lt; OverDistSquared)\n                {\n                    // We're over this segment.\n                    hitLine = line;\n                    return true;\n                }\n            }\n        }\n\n        hitLine = null;\n        return false;\n    }\n\n    // Calculate the distance squared between two points.\n    private double FindDistanceToPointSquared(Point pt1, Point pt2)\n    {\n        double dx = pt1.X - pt2.X;\n        double dy = pt1.Y - pt2.Y;\n        return dx * dx + dy * dy;\n    }\n\n    // Calculate the distance squared between\n    // point pt and the segment p1 --&gt; p2.\n    private double FindDistanceToSegmentSquared(Point pt, Point p1, Point p2, out Point closest)\n    {\n        double dx = p2.X - p1.X;\n        double dy = p2.Y - p1.Y;\n        if ((dx == 0) &amp;&amp; (dy == 0))\n        {\n            // It's a point not a line segment.\n            closest = p1;\n            dx = pt.X - p1.X;\n            dy = pt.Y - p1.Y;\n            return dx * dx + dy * dy;\n        }\n\n        // Calculate the t that minimizes the distance.\n        double t = ((pt.X - p1.X) * dx + (pt.Y - p1.Y) * dy) / (dx * dx + dy * dy);\n\n        // See if this represents one of the segment's\n        // end points or a point in the middle.\n        if (t &lt; 0)\n        {\n            closest = new Point(p1.X, p1.Y);\n            dx = pt.X - p1.X;\n            dy = pt.Y - p1.Y;\n        }\n        else if (t &gt; 1)\n        {\n            closest = new Point(p2.X, p2.Y);\n            dx = pt.X - p2.X;\n            dy = pt.Y - p2.Y;\n        }\n        else\n        {\n            closest = new Point(p1.X + t * dx, p1.Y + t * dy);\n            dx = pt.X - closest.X;\n            dy = pt.Y - closest.Y;\n        }\n\n        return dx * dx + dy * dy;\n    }\n\n    private double FindDistanceToPoint(Point pt1, Point pt2)\n    {\n        double dx = pt1.X - pt2.X;\n        double dy = pt1.Y - pt2.Y;\n        return Math.Sqrt(dx * dx + dy * dy);\n    }\n\n    #endregion Distance Methods\n\n    #region Moving End Point\n\n    // We're moving an end point.\n    private void canDrawing_MouseMove_MovingEndPoint(object sender, MouseEventArgs e)\n    {\n        // Move the point to its new location.\n        Point location = e.MouseDevice.GetPosition(canDrawing);\n        if (_movingStartEndPoint)\n        {\n            _selectedLine.X1 = location.X + _offsetX;\n            _selectedLine.Y1 = location.Y + _offsetY;\n        }\n        else\n        {\n            _selectedLine.X2 = location.X + _offsetX;\n            _selectedLine.Y2 = location.Y + _offsetY;\n        }\n    }\n\n    // Stop moving the end point.\n    private void canDrawing_MouseUp_MovingEndPoint(object sender, MouseEventArgs e)\n    {\n        // Reset the event handlers.\n        canDrawing.MouseMove += canDrawing_MouseMove_NotDown;\n        canDrawing.MouseMove -= canDrawing_MouseMove_MovingEndPoint;\n        canDrawing.MouseUp -= canDrawing_MouseUp_MovingEndPoint;\n    }\n\n    #endregion Moving End Point\n\n    #region Drawing\n\n    // We're drawing a new segment.\n    private void canDrawing_MouseMove_Drawing(object sender, MouseEventArgs e)\n    {\n        // Update the new line's end point.\n        Point location = e.MouseDevice.GetPosition(canDrawing);\n        _selectedLine.X2 = location.X;\n        _selectedLine.Y2 = location.Y;\n    }\n\n    // Stop drawing.\n    private void canDrawing_MouseUp_Drawing(object sender, MouseEventArgs e)\n    {\n        _selectedLine.Stroke = Brushes.DeepPink;\n\n        // Reset the event handlers.\n        canDrawing.MouseMove -= canDrawing_MouseMove_Drawing;\n        canDrawing.MouseMove += canDrawing_MouseMove_NotDown;\n        canDrawing.MouseUp -= canDrawing_MouseUp_Drawing;\n\n        // If the new segment has no length, delete it.\n        if ((_selectedLine.X1 == _selectedLine.X2) &amp;&amp; (_selectedLine.Y1 == _selectedLine.Y2))\n            canDrawing.Children.Remove(_selectedLine);\n        else\n        {\n            _lines.Add(_selectedLine);\n            var point1 = new Point(_selectedLine.X1, _selectedLine.Y1);\n            var point2 = new Point(_selectedLine.X2, _selectedLine.Y2);\n            PixelsInMillimeterTextBox.Text = FindDistanceToPoint(point1, point2).ToString(CultureInfo.InvariantCulture);\n        }\n\n    }\n\n    #endregion Drawing\n\n    #region \"Moving Segment\"\n\n    // We're moving a segment.\n    private void canDrawing_MouseMove_MovingSegment(object sender, MouseEventArgs e)\n    {\n        // Find the new location for the first end point.\n        Point location = e.MouseDevice.GetPosition(canDrawing);\n        double newX1 = location.X + _offsetX;\n        double newY1 = location.Y + _offsetY;\n\n        // See how far we are moving that point.\n        double dx = newX1 - _selectedLine.X1;\n        double dy = newY1 - _selectedLine.Y1;\n\n        // Move the line.\n        _selectedLine.X1 = newX1;\n        _selectedLine.Y1 = newY1;\n        _selectedLine.X2 += dx;\n        _selectedLine.Y2 += dy;\n    }\n\n    // Stop moving the segment.\n    private void canDrawing_MouseUp_MovingSegment(object sender, MouseEventArgs e)\n    {\n        // Reset the event handlers.\n        canDrawing.MouseMove += canDrawing_MouseMove_NotDown;\n        canDrawing.MouseMove -= canDrawing_MouseMove_MovingSegment;\n        canDrawing.MouseUp -= canDrawing_MouseUp_MovingSegment;\n\n        // See if the mouse is over the trash can.\n        Point location = e.MouseDevice.GetPosition(canDrawing);\n        if ((location.X &gt;= 0) &amp;&amp; (location.X &lt; _trashWidth) &amp;&amp;\n            (location.Y &gt;= 0) &amp;&amp; (location.Y &lt; _trashHeight))\n        {\n            if (MessageBox.Show(\"Delete this segment?\",\n                \"Delete Segment?\", MessageBoxButton.YesNo)\n                    == MessageBoxResult.Yes)\n            {\n                // Delete the segment.\n                canDrawing.Children.Remove(_selectedLine);\n            }\n        }\n    }\n\n    #endregion // Moving End Point\n</code></pre>\n\n<p>And here is the XAML for the control containing image:</p>\n\n<pre><code>                 &lt;Grid&gt;\n                    &lt;Border Name=\"Border\" BorderThickness=\"1\" BorderBrush=\"#34558b\" Margin=\"10,44,10,10\"&gt;\n                        &lt;utility:ZoomBorder x:Name=\"border\" ClipToBounds=\"True\" Background=\"Gray\"&gt;\n                            &lt;Canvas Name=\"canDrawing\"\n                                    MouseMove=\"canDrawing_MouseMove_NotDown\"\n                                    MouseDown=\"canDrawing_MouseDown\"&gt;\n                                &lt;Image Stretch=\"None\" Name=\"ReferenceImage\" Canvas.Left=\"0\" Canvas.Top=\"0\"/&gt;\n                            &lt;/Canvas&gt;\n                        &lt;/utility:ZoomBorder&gt;\n                    &lt;/Border&gt;\n                &lt;/Grid&gt;\n</code></pre>\n"}, {"tags": ["c#", "wpf", "hyperlink"], "comments": [{"owner": {"reputation": 476, "user_id": 6859121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YCTLp.png?s=128&g=1", "display_name": "Squirrel.Downy", "link": "https://stackoverflow.com/users/6859121/squirrel-downy"}, "edited": false, "score": 1, "creation_date": 1577173548, "post_id": 59294780, "comment_id": 105110907, "body": "Just another idea - why not loading it into your appliation?"}, {"owner": {"reputation": 611, "user_id": 3587031, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H_Me29R5RfY/AAAAAAAAAAI/AAAAAAAAAPo/e85Yb1bRVgk/photo.jpg?sz=128", "display_name": "k1ll3r8e", "link": "https://stackoverflow.com/users/3587031/k1ll3r8e"}, "edited": false, "score": 0, "creation_date": 1577329754, "post_id": 59294780, "comment_id": 105142888, "body": "Well, maybe a bit too easy, but have you tried to replace the <code>#</code>  with <code>%23</code>? Works for me with windows cmd/<code>Process.Start()</code>. Works also when you hit <code>WINLOGO+R</code> and insert for example: <code>https:&#47;&#47;de.ryte.com&#47;wiki&#47;Anchor_Tag%23href-Attribut</code>."}, {"owner": {"reputation": 3290, "user_id": 4916898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cdueC.jpg?s=128&g=1", "display_name": "Arnaud Develay", "link": "https://stackoverflow.com/users/4916898/arnaud-develay"}, "reply_to_user": {"reputation": 476, "user_id": 6859121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YCTLp.png?s=128&g=1", "display_name": "Squirrel.Downy", "link": "https://stackoverflow.com/users/6859121/squirrel-downy"}, "edited": false, "score": 0, "creation_date": 1577354751, "post_id": 59294780, "comment_id": 105148552, "body": "@Flithor good idea. It works well if using a WebBrowser control. Then simply use <code>webBrowser.Navigate(uri)</code> with a URI parameter."}, {"owner": {"reputation": 3577, "user_id": 2596334, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/30ba99c74af2eff0394b66c550486f59?s=128&d=identicon&r=PG", "display_name": "Scott Solmer", "link": "https://stackoverflow.com/users/2596334/scott-solmer"}, "reply_to_user": {"reputation": 476, "user_id": 6859121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YCTLp.png?s=128&g=1", "display_name": "Squirrel.Downy", "link": "https://stackoverflow.com/users/6859121/squirrel-downy"}, "edited": false, "score": 0, "creation_date": 1577971457, "post_id": 59294780, "comment_id": 105295966, "body": "@Flithor I agree that would be a good solution, however it is not the spec."}], "answers": [{"comments": [{"owner": {"reputation": 2785, "user_id": 1873567, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/moGq1.png?s=128&g=1", "display_name": "CalvT", "link": "https://stackoverflow.com/users/1873567/calvt"}, "edited": false, "score": 1, "creation_date": 1576839455, "post_id": 59416713, "comment_id": 105034355, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/24906095\">From Review</a>"}, {"owner": {"reputation": 3577, "user_id": 2596334, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/30ba99c74af2eff0394b66c550486f59?s=128&d=identicon&r=PG", "display_name": "Scott Solmer", "link": "https://stackoverflow.com/users/2596334/scott-solmer"}, "edited": false, "score": 0, "creation_date": 1577979656, "post_id": 59416713, "comment_id": 105299973, "body": "Thank you for the well written answer. It does appear the OS is to blame. Your work around (specifying the browser to use directly) works perfectly!"}], "tags": [], "owner": {"reputation": 3290, "user_id": 4916898, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cdueC.jpg?s=128&g=1", "display_name": "Arnaud Develay", "link": "https://stackoverflow.com/users/4916898/arnaud-develay"}, "is_accepted": true, "score": 6, "last_activity_date": 1576857503, "last_edit_date": 1576857503, "creation_date": 1576788524, "answer_id": 59416713, "question_id": 59294780, "link": "https://stackoverflow.com/questions/59294780/requestnavigate-to-hyperlink-with-page-anchor/59416713#59416713", "title": "RequestNavigate to Hyperlink with page anchor", "body": "<p>It seems that if you let the OS identify the default browser itself, it will remove the anchor from the URI.</p>\n\n<p>You need to use the following overload of <code>Process.Start</code> which allows to specify the executable and the parameters:</p>\n\n<pre><code>ProcessStartInfo processStartInfo = new ProcessStartInfo();\nprocessStartInfo.FileName = @\"C:\\Program Files\\Internet Explorer\\iexplore.exe\";\nprocessStartInfo.Arguments = \"file:///C:/OSP-P/P-MANUAL/MPA/ENG/ALARM-A.HTM#1101\";\nProcess.Start(processStartInfo);\n</code></pre>\n\n<p>If you want to use browser defined by the user instead of an hard-coded one, you will have to query the Windows Registry in order to retrieve it.</p>\n\n<p>For example on old version of windows (before Vista I think), you have to use the following registry key: <code>HKEY_CLASSES_ROOT\\http\\shell\\open\\command</code>. On later release, this key contains the default browser (if the browser does not made any change).</p>\n\n<pre><code>private string GetDefaultBrowser()\n{\n    string regKey = @\"HTTP\\shell\\open\\command\";\n    using (RegistryKey registrykey = Registry.ClassesRoot.OpenSubKey(regKey, false))\n    {\n        return ((string)registrykey.GetValue(null, null)).Split('\"')[1];\n    }\n}\n</code></pre>\n\n<p>On Windows 10, it is a bit more complex due to the application launcher that allows to select the default application. To retrieve the browser chosen by the user, you have to query the following registry key: <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.html\\UserChoice</code>. It the key does not exist you have to fallback on the previously mentioned key: <code>HKEY_CLASSES_ROOT\\http\\shell\\open\\command</code>.</p>\n\n<pre><code>private string GetDefaultBrowserOnWin10()\n{\n    string execPath;\n    try\n    {\n        string extension = \".htm\"; // either .htm or .html\n        RegistryKey propertyBag = Registry.CurrentUser.OpenSubKey($@\"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\{extension}\\UserChoice\", false);\n        var browserProgId = propertyBag.GetValue(\"ProgId\").ToString(); ;\n        using (RegistryKey execCommandKey = Registry.ClassesRoot.OpenSubKey(browserProgId + @\"\\shell\\open\\command\", false))\n        {\n            execPath = execCommandKey.GetValue(null).ToString().ToLower().Replace(\"\\\"\", \"\");\n            if (IsDefaultLauncherApp(execPath))\n            {\n                System.Diagnostics.Debug.WriteLine(\"No user-defined browser or IE selected; anchor will be lost.\");\n            }\n        }\n\n        if (!execPath.EndsWith(\"exe\"))\n        {\n            execPath = execPath.Substring(0, execPath.LastIndexOf(\".exe\") + 4);\n        }\n    }\n    catch (Exception ex)\n    {\n        System.Diagnostics.Debug.WriteLine(ex.Message);\n        execPath = GetDefaultBrowser();\n    }\n\n    return execPath;\n}\n\nprivate bool IsDefaultLauncherApp(string appPath)\n{\n    return appPath.Contains(\"launchwinapp.exe\");\n}\n</code></pre>\n\n<p>This will work for all browsers except <a href=\"https://social.msdn.microsoft.com/Forums/en-US/93ff5531-ee99-4414-b599-0feff55eb9af/how-to-open-local-htm-file-with-internal-link-in-edge-browser-from-command-line?forum=iewebdevelopment\" rel=\"noreferrer\"><strong>Microsoft Edge</strong>, which do not allow that at the moment</a>.\nYou can use in you program like this:</p>\n\n<pre><code>private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)\n{\n    try {\n        string link = e.Uri.ToString();\n        System.Diagnostics.ProcessStartInfo processStartInfo = new System.Diagnostics.ProcessStartInfo();\n        processStartInfo.FileName = GetDefaultBrowserOnWin10();\n        processStartInfo.Arguments = link;\n        System.Diagnostics.Process.Start(processStartInfo);\n    } catch (Exception ex) {\n        MessageBox.Show(ex.Message);\n    }\n}\n</code></pre>\n\n<p>Some additional answers:\n<a href=\"https://stackoverflow.com/questions/13621467/how-to-find-default-web-browser-using-c/17599201#answer-39036418\">How to find default web browser using C#?</a></p>\n"}], "owner": {"reputation": 3577, "user_id": 2596334, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/30ba99c74af2eff0394b66c550486f59?s=128&d=identicon&r=PG", "display_name": "Scott Solmer", "link": "https://stackoverflow.com/users/2596334/scott-solmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 59416713, "answer_count": 1, "score": 2, "last_activity_date": 1576857503, "creation_date": 1576101785, "question_id": 59294780, "link": "https://stackoverflow.com/questions/59294780/requestnavigate-to-hyperlink-with-page-anchor", "title": "RequestNavigate to Hyperlink with page anchor", "body": "<p>I need to open a local .HTM file and navigate to a specific anchor name.<br>\nIn this case it is an alarm information file with over 1,000 alarms / anchors.</p>\n\n<p>In my test example (full code below) the Uri Fragment doesn't make it into the browser.<br>\nI have tried other ways of creating the hyperlink but this is as close as I could get.</p>\n\n<p>The Test App:<br>\n<a href=\"https://i.stack.imgur.com/uYBJX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uYBJX.jpg\" alt=\"Test-App\"></a></p>\n\n<p>Result:<br>\n<a href=\"https://i.stack.imgur.com/KStzu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KStzu.jpg\" alt=\"Test-Result\"></a></p>\n\n<h3>MainWindow.xaml</h3>\n\n<pre><code>&lt;Window x:Class=\"HyperlinkWithPageAnchor.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        Height=\"100\" Width=\"200\"&gt;\n    &lt;Grid&gt;\n        &lt;TextBlock HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"&gt;\n            &lt;Hyperlink NavigateUri=\"{Binding HyperlinkNavUri}\" RequestNavigate=\"Hyperlink_RequestNavigate\"&gt;\n                &lt;TextBlock Text=\"Link Text\"/&gt;\n            &lt;/Hyperlink&gt;\n        &lt;/TextBlock&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<h3>MainWindow.xaml.cs</h3>\n\n<pre><code>namespace HyperlinkWithPageAnchor\n{\n    using System;\n    using System.Windows;\n    using System.ComponentModel;\n    using System.Windows.Navigation;\n\n    public partial class MainWindow : Window, INotifyPropertyChanged\n    {\n        private Uri _hyperlinkNavUri;\n        public Uri HyperlinkNavUri\n        {\n            get { return _hyperlinkNavUri; }\n            set { _hyperlinkNavUri = value; OnPropertyChanged(nameof(HyperlinkNavUri)); }\n        }\n\n        public MainWindow()\n        {\n            InitializeComponent(); DataContext = this;\n\n            // Desired Address: file:///C:/OSP-P/P-MANUAL/MPA/ENG/ALARM-A.HTM#1101\n\n            UriBuilder uBuild = new UriBuilder(new Uri(\"file://\"));\n            uBuild.Path = @\"C:\\OSP-P\\P-MANUAL\\MPA\\ENG\\ALARM-A.HTM\";\n            uBuild.Fragment = \"1101\"; \n            HyperlinkNavUri = uBuild.Uri; \n        }\n\n        private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)\n        {\n            try { string link = e.Uri.ToString();  MessageBox.Show(link); System.Diagnostics.Process.Start(link); }\n            catch (Exception ex) { MessageBox.Show(ex.Message); }\n        }\n\n        public event PropertyChangedEventHandler PropertyChanged;\n        public void OnPropertyChanged(string name) { PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(name)); }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "string", "escaping"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1576102032, "post_id": 59294777, "comment_id": 104794120, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/55514123/convert-a-c-sharp-string-value-to-an-escaped-string-literal-with-roslyn\">Convert a C# string value to an escaped string literal with Roslyn</a>"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1576102085, "post_id": 59294777, "comment_id": 104794134, "body": "@GSerg Thanks, that&#39;s the output I&#39;m looking for. Unfortunately it establishes a CodeDomProvider/Roslyn dependency which is a bit .. heavy."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1576102534, "post_id": 59294777, "comment_id": 104794284, "body": "Well, I guess the next best thing is to manually implement <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/strings/#string-escape-sequences\" rel=\"nofollow noreferrer\">this table</a>."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1576102569, "post_id": 59294777, "comment_id": 104794291, "body": "Hmm. I suppose that &quot;encode for a JSON string&quot; might be sufficiently close. Also doesn&#39;t appear readily a thing."}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1576172874, "post_id": 59294777, "comment_id": 104822517, "body": "Create a list of key/value pairs (or some other 2-tuple) that represent what you want to do.  Then walk through the list calling <code>StringBuilder.Replace</code> for each pair doing the transformation.  StringBuilder&#39;s Replace call is more appropriate than string&#39;s here."}], "owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1576102546, "creation_date": 1576101755, "last_edit_date": 1576102546, "question_id": 59294777, "link": "https://stackoverflow.com/questions/59294777/escape-a-string-as-though-it-was-for-a-c-string-literal-eg-repr-representa", "title": "Escape a string as though it was for a C# string literal? (eg. &quot;repr&quot; representation)", "body": "<p>There are various methods in C# to escape strings, most deal with XML (<a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.security.securityelement.escape?view=netframework-4.8\" rel=\"nofollow noreferrer\">SecurityElement.Escape</a>) or JavaScript (<a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.httputility.javascriptstringencode?view=netframework-4.8\" rel=\"nofollow noreferrer\">HttpUtility.JavaScriptStringEncode</a>).</p>\n\n<p><strong>Is there a standard .NET (.NET Standard 2.0) method to escape a string such that, when copied verbatim in a C# double-quoted literal, it will evaluate to original string?</strong></p>\n\n<p>Here is a sample desired transform of the <em>string content</em> from <code>ff \"Hello world!\" ^M^M &lt;&gt;'</code> to <code>ff \\\"Hello world!\\\" \\n\\n &lt;&gt;'</code> so that it can be copied verbatim into a valid program:</p>\n\n<pre><code> var x = \"ff \\\"Hello world!\\\" \\n\\n &lt;&gt;'\";\n</code></pre>\n\n<p>Note that <code>^M</code> (new line character) is transformed to the <code>\\n</code> escape and <code>&lt;&gt;'</code> is left alone as angle brackets are irrelevant in context and the string will be double-quoted (escaping of <code>'</code> would be OK).</p>\n\n<p>Consider the VS Debugger expression view's rendition of string values for an example of desired output. Sometimes this might be referred to as 'string representation form'.</p>\n"}, {"tags": ["c#", "unity3d", "machine-learning", "c#-4.0", "ml-agent"], "comments": [{"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 1, "creation_date": 1576102874, "post_id": 59294708, "comment_id": 104794396, "body": "So what exactly is your question here? Also, please don&#39;t include images of code. These make finding questions harder to search for and make copying code into answers absurdly inconvenient, not to mention make the information inaccessible to people who use screen readers. You should rather include any code as text in the body of the question."}, {"owner": {"reputation": 103, "user_id": 12521151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-es8Dd_T_6Hs/AAAAAAAAAAI/AAAAAAAAAT4/HFm7TbGd-uU/photo.jpg?sz=128", "display_name": "Jaden Williams", "link": "https://stackoverflow.com/users/12521151/jaden-williams"}, "reply_to_user": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 1, "creation_date": 1576104848, "post_id": 59294708, "comment_id": 104795011, "body": "@Ruzihm Thanks for the reply! Yes, you&#39;re right, I&#39;ll add the code. I just want to know how well I&#39;m writing my code to train my balancing agent. Because, when I try to train the agent using Anaconda, the prompt fails and Unity crashes. Thanks."}, {"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1576105979, "post_id": 59294708, "comment_id": 104795355, "body": "Aha, that&#39;s a very important thing to include in the question! When does Unity crash? As soon as learning begins?"}, {"owner": {"reputation": 103, "user_id": 12521151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-es8Dd_T_6Hs/AAAAAAAAAAI/AAAAAAAAAT4/HFm7TbGd-uU/photo.jpg?sz=128", "display_name": "Jaden Williams", "link": "https://stackoverflow.com/users/12521151/jaden-williams"}, "reply_to_user": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 1, "creation_date": 1576106281, "post_id": 59294708, "comment_id": 104795427, "body": "@Ruzihm Unity freezes/crashes right when I press play after Anaconda is set up. I added the anaconda error text. Thanks."}, {"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1576106508, "post_id": 59294708, "comment_id": 104795486, "body": "Looks like it&#39;s having trouble loading curricula. I can only guess that you don&#39;t have any in the directory you&#39;ve given it, since you haven&#39;t mentioned them. Try running the command without the <code>curriculum_folder</code> parameter. I&#39;m also voting to re-open this question"}, {"owner": {"reputation": 103, "user_id": 12521151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-es8Dd_T_6Hs/AAAAAAAAAAI/AAAAAAAAAT4/HFm7TbGd-uU/photo.jpg?sz=128", "display_name": "Jaden Williams", "link": "https://stackoverflow.com/users/12521151/jaden-williams"}, "reply_to_user": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1576108346, "post_id": 59294708, "comment_id": 104795970, "body": "@Ruzihm Removing that parameter did help it. I also had my vector branch size 1 too short. I&#39;m not fully sure what that param. did anyways. Still learning! But now, the person won&#39;t reset when he falls over. Shouldn&#39;t line 166 in my code accomplish that with &quot;Done()&quot;? Doesn&#39;t that method reset everything?"}, {"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1576125238, "post_id": 59294708, "comment_id": 104799330, "body": "You need to make/edit the <a href=\"https://github.com/Unity-Technologies/ml-agents/blob/master/docs/Learning-Environment-Design-Academy.md\" rel=\"nofollow noreferrer\">Academy</a> with a <code>AcademyReset</code> method that resets the environment (including the state of the joints that the agent is controlling). But, I think the solution to the problem in the question has been found so I&#39;m going to write it up as an answer. If you need more help beyond that, you should ask a new question."}], "answers": [{"tags": [], "owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "is_accepted": true, "score": 2, "last_activity_date": 1576131293, "last_edit_date": 1576131293, "creation_date": 1576125312, "answer_id": 59297778, "question_id": 59294708, "link": "https://stackoverflow.com/questions/59294708/expecting-property-name-enclosed-in-double-quotes-when-running-agents-scene/59297778#59297778", "title": "&quot;Expecting property name enclosed in double quotes&quot; when running agents scene", "body": "<p>It is having trouble finding and loading the curriculua in the specified <code>curriculum_folder</code> parameter. Because you don't need curricula, you can remove the <code>curriculum_folder</code> parameter and it will proceed without trying to load any of them.</p>\n"}], "owner": {"reputation": 103, "user_id": 12521151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-es8Dd_T_6Hs/AAAAAAAAAAI/AAAAAAAAAT4/HFm7TbGd-uU/photo.jpg?sz=128", "display_name": "Jaden Williams", "link": "https://stackoverflow.com/users/12521151/jaden-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 59297778, "answer_count": 1, "score": 2, "last_activity_date": 1576168101, "creation_date": 1576101376, "last_edit_date": 1576168101, "question_id": 59294708, "link": "https://stackoverflow.com/questions/59294708/expecting-property-name-enclosed-in-double-quotes-when-running-agents-scene", "title": "&quot;Expecting property name enclosed in double quotes&quot; when running agents scene", "body": "<p>In summary, I have a pair of legs that have rotation-axis-points and want to be able to allow the computer to figure out which way the legs should rotate to allow itself to balance and keep the 'waist' game-object greater than a certain height (Essentially <strong>self-balancing</strong>). If the waist falls under a certain height, (IE, falling over) the agent gets a reward-reduction. When I run the Anaconda prompt and run Unity when it asks me to, <strong>Unity freezes</strong> and Anaconda displays the error code shown below. It's hard to find up-to-date tutorials so I would really appreciate some support. <strong>What's going on?</strong> Thank you. (:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9KOmA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9KOmA.png\" alt=\"Agent environment\"></a></p>\n\n<pre><code>                        \u2584\u2584\u2584\u2593\u2593\u2593\u2593\n                   \u2553\u2593\u2593\u2593\u2593\u2593\u2593\u2588\u2593\u2593\u2593\u2593\u2593\n              ,\u2584\u2584\u2584m\u2580\u2580\u2580'  ,\u2593\u2593\u2593\u2580\u2593\u2593\u2584                           \u2593\u2593\u2593  \u2593\u2593\u258c\n            \u2584\u2593\u2593\u2593\u2580'      \u2584\u2593\u2593\u2580  \u2593\u2593\u2593      \u2584\u2584     \u2584\u2584 ,\u2584\u2584 \u2584\u2584\u2584\u2584   ,\u2584\u2584 \u2584\u2593\u2593\u258c\u2584 \u2584\u2584\u2584    ,\u2584\u2584\n          \u2584\u2593\u2593\u2593\u2580        \u2584\u2593\u2593\u2580   \u2590\u2593\u2593\u258c     \u2593\u2593\u258c   \u2590\u2593\u2593 \u2590\u2593\u2593\u2593\u2580\u2580\u2580\u2593\u2593\u258c \u2593\u2593\u2593 \u2580\u2593\u2593\u258c\u2580 ^\u2593\u2593\u258c  \u2552\u2593\u2593\u258c\n        \u2584\u2593\u2593\u2593\u2593\u2593\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2593\u2593\u2593      \u2593\u2580      \u2593\u2593\u258c   \u2590\u2593\u2593 \u2590\u2593\u2593    \u2593\u2593\u2593 \u2593\u2593\u2593  \u2593\u2593\u258c   \u2590\u2593\u2593\u2584 \u2593\u2593\u258c\n        \u2580\u2593\u2593\u2593\u2593\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2580\u2593\u2593\u2584     \u2593\u2593      \u2593\u2593\u258c   \u2590\u2593\u2593 \u2590\u2593\u2593    \u2593\u2593\u2593 \u2593\u2593\u2593  \u2593\u2593\u258c    \u2590\u2593\u2593\u2590\u2593\u2593\n          ^\u2588\u2593\u2593\u2593        \u2580\u2593\u2593\u2584   \u2590\u2593\u2593\u258c     \u2593\u2593\u2593\u2593\u2584\u2593\u2593\u2593\u2593 \u2590\u2593\u2593    \u2593\u2593\u2593 \u2593\u2593\u2593  \u2593\u2593\u2593\u2584    \u2593\u2593\u2593\u2593`\n            '\u2580\u2593\u2593\u2593\u2584      ^\u2593\u2593\u2593  \u2593\u2593\u2593       \u2514\u2580\u2580\u2580\u2580 \u2580\u2580 ^\u2580\u2580    `\u2580\u2580 `\u2580\u2580   '\u2580\u2580    \u2590\u2593\u2593\u258c\n               \u2580\u2580\u2580\u2580\u2593\u2584\u2584\u2584   \u2593\u2593\u2593\u2593\u2593\u2593,                                      \u2593\u2593\u2593\u2593\u2580\n                   `\u2580\u2588\u2593\u2593\u2593\u2593\u2593\u2593\u2593\u2593\u2593\u258c\n                        \u00ac`\u2580\u2580\u2580\u2588\u2593\n\n\nINFO:mlagents.trainers:CommandLineOptions(debug=False, num_runs=1, seed=-1, env_path=None, run_id='testRun1', load_model=False, train_model=False, save_freq=50000, keep_checkpoints=5, base_port=5005, num_envs=1, curriculum_folder='config/curricula/Balance/', lesson=0, slow=False, no_graphics=False, multi_gpu=False, trainer_config_path='config/trainer_config.yaml', sampler_file_path=None, docker_target_name=None, env_args=None, cpu=False)\nINFO:mlagents.envs:Start training by pressing the Play button in the Unity Editor.\nINFO:mlagents.envs:\n'BalanceAcademy' started successfully!\nUnity Academy name: BalanceAcademy\n        Reset Parameters : {}\nTraceback (most recent call last):\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\curriculum.py\", line 132, in _load_curriculum\n    return json.load(fp)\n  File \"C:\\Users\\Jaden Williams\\.conda\\envs\\ml_Balance01\\lib\\json\\__init__.py\", line 296, in load\n    parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)\n  File \"C:\\Users\\Jaden Williams\\.conda\\envs\\ml_Balance01\\lib\\json\\__init__.py\", line 348, in loads\n    return _default_decoder.decode(s)\n  File \"C:\\Users\\Jaden Williams\\.conda\\envs\\ml_Balance01\\lib\\json\\decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n  File \"C:\\Users\\Jaden Williams\\.conda\\envs\\ml_Balance01\\lib\\json\\decoder.py\", line 353, in raw_decode\n    obj, end = self.scan_once(s, idx)\njson.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 6 column 1 (char 112)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\Jaden Williams\\.conda\\envs\\ml_Balance01\\Scripts\\mlagents-learn-script.py\", line 11, in &lt;module&gt;\n    load_entry_point('mlagents', 'console_scripts', 'mlagents-learn')()\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\learn.py\", line 422, in main\n    run_training(0, run_seed, options, Queue())\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\learn.py\", line 232, in run_training\n    curriculum_folder, env, options.lesson\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\learn.py\", line 300, in try_create_meta_curriculum\n    meta_curriculum = MetaCurriculum(curriculum_folder, env.reset_parameters)\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\meta_curriculum.py\", line 43, in __init__\n    curriculum = Curriculum(curriculum_filepath, default_reset_parameters)\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\curriculum.py\", line 26, in __init__\n    self.data = Curriculum.load_curriculum_file(location)\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\curriculum.py\", line 119, in load_curriculum_file\n    return Curriculum._load_curriculum(data_file)\n  File \"c:\\users\\jaden williams\\dropbox\\documents\\ml-agents-0.12.0\\ml-agents\\mlagents\\trainers\\curriculum.py\", line 137, in _load_curriculum\n    ) from e\nmlagents.trainers.exception.CurriculumLoadingError: Error parsing JSON file. Please check for formatting errors. A tool such as https://jsonlint.com/ can be helpful with this.\n</code></pre>\n\n<p>And here is my code for the agent:</p>\n\n<pre><code>using MLAgents;\nusing System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class BalanceAgent : Agent\n{\n    private BalancingArea area;\n    public GameObject waist;\n    public GameObject buttR;\n    public GameObject buttL;\n    public GameObject thighR;\n    public GameObject thighL;\n    public GameObject legR;\n    public GameObject legL;\n    public GameObject footR;\n    public GameObject footL;\n    public GameObject goal;\n    // private float buttR = 0f;\n\n\n    public override void InitializeAgent() {\n        base.InitializeAgent();\n        area = GetComponentInParent&lt;BalancingArea&gt;();\n\n    }\n\n    public override void AgentAction(float[] vectorAction) {\n\n        int buttRDir = 0;\n        int buttRVec = (int)vectorAction[0];\n        switch (buttRVec) {\n            case 3:\n                buttRDir = 0;\n                break;\n            case 1:\n                buttRDir = -1;\n                break;\n            case 2:\n                buttRDir = 1;\n                break;\n        }\n        buttR.transform.Rotate(0, buttRDir, 0);\n\n        int buttLDir = 0;\n        int buttLVec = (int)vectorAction[1];\n        switch (buttLVec) {\n            case 3:\n                buttLDir = 0;\n                break;\n            case 1:\n                buttLDir = -1;\n                break;\n            case 2:\n                buttLDir = 1;\n                break;\n        }\n        buttL.transform.Rotate(0, buttLDir, 0);\n\n        int thighRDir = 0;\n        int thighRVec = (int)vectorAction[2];\n        switch (thighRVec) {\n            case 3:\n                thighRDir = 0;\n                break;\n            case 1:\n                thighRDir = -1;\n                break;\n            case 2:\n                thighRDir = 1;\n                break;\n        }\n        thighR.transform.Rotate(0, thighRDir, 0);\n\n        int thighLDir = 0;\n        int thighLVec = (int)vectorAction[3];\n        switch (thighLVec) {\n            case 3:\n                thighLDir = 0;\n                break;\n            case 1:\n                thighLDir = -1;\n                break;\n            case 2:\n                thighLDir = 1;\n                break;\n        }\n        thighL.transform.Rotate(0, thighLDir, 0);\n\n        int legRDir = 0;\n        int legRVec = (int)vectorAction[4];\n        switch (legRVec) {\n            case 3:\n                legRDir = 0;\n                break;\n            case 1:\n                legRDir = -1;\n                break;\n            case 2:\n                legRDir = 1;\n                break;\n        }\n        legR.transform.Rotate(0, legRDir, 0);\n\n        int legLDir = 0;\n        int legLVec = (int)vectorAction[5];\n        switch (legLVec) {\n            case 3:\n                legLDir = 0;\n                break;\n            case 1:\n                legLDir = -1;\n                break;\n            case 2:\n                legLDir = 1;\n                break;\n        }\n        legL.transform.Rotate(0, legLDir, 0);\n\n        int footRDir = 0;\n        int footRVec = (int)vectorAction[6];\n        switch (footRVec) {\n            case 3:\n                footRDir = 0;\n                break;\n            case 1:\n                footRDir = -1;\n                break;\n            case 2:\n                footRDir = 1;\n                break;\n        }\n        footR.transform.Rotate(0, footRDir, 0);\n\n        int footLDir = 0;\n        int footLVec = (int)vectorAction[7];\n        switch (footLVec) {\n            case 3:\n                footLDir = 0;\n                break;\n            case 1:\n                footLDir = -1;\n                break;\n            case 2:\n                footLDir = 1;\n                break;\n        }\n        footL.transform.Rotate(0, footLDir, 0);\n\n\n\n\n        //buttR = vectorAction[0]; //Right or none\n        //if (buttR == 2) buttR = -1f; //Left\n\n        if (waist.transform.position.y &gt; -1.3) {\n            AddReward(.1f);\n        }\n        else {\n            AddReward(-.02f);\n        }\n\n        if(waist.transform.position.y &lt;= -3) {\n            AddReward(-.1f);\n            Done();\n        }\n\n    }\n\n    public override void CollectObservations() {\n        AddVectorObs(waist.transform.localRotation.y);\n        AddVectorObs(buttR.transform.localRotation.x);\n        AddVectorObs(buttL.transform.localRotation.x);\n        AddVectorObs(thighR.transform.localRotation.y);\n        AddVectorObs(thighL.transform.localRotation.y);\n        AddVectorObs(legR.transform.localRotation.y);\n        AddVectorObs(legL.transform.localRotation.y);\n        AddVectorObs(footR.transform.localRotation.y);\n        AddVectorObs(footL.transform.localRotation.y);\n\n        AddVectorObs(waist.GetComponent&lt;Rigidbody&gt;().freezeRotation);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "powershell", "system.management"], "comments": [{"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576101372, "post_id": 59294628, "comment_id": 104793897, "body": "you are using Out-File.. it is supposed to give you any output anyway... Also, what user are you looking up ?"}, {"owner": {"reputation": 1, "user_id": 12521082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4723b1b029c7b89a9cdd0e8c65e3585f?s=128&d=identicon&r=PG&f=1", "display_name": "user12521082", "link": "https://stackoverflow.com/users/12521082/user12521082"}, "reply_to_user": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576105213, "post_id": 59294628, "comment_id": 104795120, "body": "It doesn&#39;t create a new file with output, but when I execute these powershell commands in terminal, it works fine. Actually I want to get all users from Azure AD, I just want to compare with local Active Directory"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576105616, "post_id": 59294628, "comment_id": 104795240, "body": "Have you tried to use a debugger and see if there is anything in the output? Any errors or exceptions"}, {"owner": {"reputation": 1, "user_id": 12521082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4723b1b029c7b89a9cdd0e8c65e3585f?s=128&d=identicon&r=PG&f=1", "display_name": "user12521082", "link": "https://stackoverflow.com/users/12521082/user12521082"}, "reply_to_user": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576112212, "post_id": 59294628, "comment_id": 104796747, "body": "There is no obvious errors, I just opened an additional output and got next: System.Management.Automation.PSDataCollection`1[System.Manag&zwnj;&#8203;ement.Automation.Err&zwnj;&#8203;orRecord]"}], "answers": [{"tags": [], "owner": {"reputation": 239138, "user_id": 45375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39f6e2dc52425b1e08027c01bb880be0?s=128&d=identicon&r=PG", "display_name": "mklement0", "link": "https://stackoverflow.com/users/45375/mklement0"}, "is_accepted": false, "score": 0, "last_activity_date": 1576116814, "creation_date": 1576116814, "answer_id": 59296750, "question_id": 59294628, "link": "https://stackoverflow.com/questions/59294628/null-results-after-execution-powershell-script-in-visual-studio-c/59296750#59296750", "title": "Null results after execution Powershell script in Visual Studio C#", "body": "<ul>\n<li><p>Sequencing <code>.AddScript()</code> calls without intervening <code>.AddStatement()</code> calls makes only the <em>last</em> <code>.AddScript()</code> call effective - all previous calls are ignored.</p></li>\n<li><p>In order to examine errors that may have occurred during execution via <code>.Invoke()</code>, you must access the <code>powershell.Streams.Error</code> stream.</p></li>\n</ul>\n\n<p>Therefore, the immediate fix is to replace your <code>powershell.AddScript(...)</code> calls with <code>$powershell.AddStatement().AddScript(...)</code></p>\n\n<p>Note that your PowerShellCode appears designed not to produce any output, so there's no point in trying to populate <code>listresults</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12521082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4723b1b029c7b89a9cdd0e8c65e3585f?s=128&d=identicon&r=PG&f=1", "display_name": "user12521082", "link": "https://stackoverflow.com/users/12521082/user12521082"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576116814, "creation_date": 1576100991, "question_id": 59294628, "link": "https://stackoverflow.com/questions/59294628/null-results-after-execution-powershell-script-in-visual-studio-c", "title": "Null results after execution Powershell script in Visual Studio C#", "body": "<p>I'm trying to get some data from Azure Active Directory using C# code with reference to System.Management.Automation. I've got no errors with code execution, just null results and no output to textfile. Does anyone have this problem before or maybe I missed something? Thank you!</p>\n\n<pre><code>public void RunScriptTest()\n        {\n            string username = \"Username\";\n            string password = \"Password\";\n            List&lt;String&gt; listResults = new List&lt;String&gt;();\n            PowerShell powershell = PowerShell.Create();\n            Runspace runspace = RunspaceFactory.CreateRunspace();\n            runspace.Open();\n            powershell.Runspace = runspace;\n            powershell.AddScript(\"Install-Module -Name AzureAD -Force; \\n\");\n            powershell.AddScript(\"Import-Module -Name AzureAD -Verbose \\n\");\n            powershell.AddScript(\"$username = \\\"\" + username + \"\\\"; \\n\" +\n                \"$password = convertTo-securestring '\" + password + \"' -AsPlainText -Force; \\n\" +\n                \"$cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $username, $password; \\n\" +\n                \"Connect-AzureAD - Credential $cred; \\n\");\n            powershell.AddScript(\"Get-AzureADUser | Out-File -FilePath \" + @\"C:\\TestResults\\1.txt\");\n            Collection&lt;PSObject&gt; results = powershell.Invoke();\n            runspace.Close();\n\n            StringBuilder stringBuilder = new StringBuilder();\n            foreach(PSObject obj in results)\n            {\n                listresults.Add(obj.ToString());\n\n            }\n\n        } \n</code></pre>\n"}, {"tags": ["c#", "macos", "selenium", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 2, "creation_date": 1576101163, "post_id": 59294593, "comment_id": 104793832, "body": "Well, <code>ProductPrice</code> is an <code>IWebElement</code>, and <code>Price</code> is a <code>string</code>. Why would they be considered equal?"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1576106421, "post_id": 59294593, "comment_id": 104795462, "body": "Need <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> - how would we know how mysterious <code>AssertLibrary.Assert.IsEqual</code> compares those two objects of different types?"}], "answers": [{"tags": [], "owner": {"reputation": 5497, "user_id": 11019743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R8NmK.png?s=128&g=1", "display_name": "Christine", "link": "https://stackoverflow.com/users/11019743/christine"}, "is_accepted": false, "score": 0, "last_activity_date": 1576101509, "last_edit_date": 1576101509, "creation_date": 1576101181, "answer_id": 59294669, "question_id": 59294593, "link": "https://stackoverflow.com/questions/59294593/test-never-fails-why-is-assert-not-working/59294669#59294669", "title": "Test never fails - why is Assert not working?", "body": "<p>So you are asserting that a <code>WebElement</code> equals a <code>string</code>, and that's why it's not working for you. You will want to use <code>.Text</code> to get the price contained in the <code>WebElement</code>:</p>\n\n<pre><code>// Compare Expected Price with Actual Price\nstring Price = \"\u00a329\";\nIWebElement ProductPrice = driver.FindElement(By.ClassName(\"search-product-price\"));\nAssertLibrary.Assert.IsEqual(ProductPrice.Text, Price);\n</code></pre>\n\n<p>But in order to achieve your desired functionality, I think you need to make a few updates to your code to get a list of <code>WebElement</code>, pick the <code>First()</code>, and check the <code>.Text</code> of that element. I also went to your website, searched \"Dinner for 2\", and your <code>By.ClassName(\"search-product-price\")</code> isn't returning any results on the search results page. I could be misunderstanding your example, but I updated your selector to something that works on this page <a href=\"https://www.buyagift.co.uk/Search/Key/dinner%20for%202\" rel=\"nofollow noreferrer\">https://www.buyagift.co.uk/Search/Key/dinner%20for%202</a>:</p>\n\n<pre><code>string Price = \"\u00a329\";\n\nvar priceText = driver.FindElements(By.XPath(\"//div[contains(@class, 'currentpricenow')]\")).First().Text;\n\nAssertLibrary.Assert.IsEqual(priceText, Price);\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6478886, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/d479fde6ec65cadd688342e64b13adc3?s=128&d=identicon&r=PG", "display_name": "markst33", "link": "https://stackoverflow.com/users/6478886/markst33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576101509, "creation_date": 1576100793, "last_edit_date": 1576101107, "question_id": 59294593, "link": "https://stackoverflow.com/questions/59294593/test-never-fails-why-is-assert-not-working", "title": "Test never fails - why is Assert not working?", "body": "<p>I am trying to teach myself Selenium with C# and have run into a problem with my assert. This is my code:</p>\n\n<pre><code>// Compare Expected Price with Actual Price\nstring Price = \"\u00a329\";\nIWebElement ProductPrice = driver.FindElement(By.ClassName(\"search-product-price\"));\nAssertLibrary.Assert.IsEqual(ProductPrice, Price);\n</code></pre>\n\n<p>The problem is that the test never fails regardless of the price I enter, so obviously the assert is not working</p>\n\n<p>The website I am using to test my code against is <a href=\"https://www.buyagift.co.uk/\" rel=\"nofollow noreferrer\">https://www.buyagift.co.uk/</a> so the full test is to go to the url, enter dinner for 2 into the search field and compare the price of the first one returned with the set price.</p>\n"}, {"tags": ["c#", "asp.net-core", "websocket"], "comments": [{"owner": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "edited": false, "score": 0, "creation_date": 1576119919, "post_id": 59294557, "comment_id": 104798242, "body": "<code>when I try to connect via WebSocket, no user code is hit</code> Based on my test, <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/websockets?view=aspnetcore-3.1\" rel=\"nofollow noreferrer\">WebSockets supports well in .NET Core 3.0</a>. Please share the code snippet you are using to establish connection and exchange message, so that we can troubleshoot the issue better."}, {"owner": {"reputation": 808, "user_id": 1352159, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d27d9335a14ff8e43de58eec500e616f?s=128&d=identicon&r=PG", "display_name": "Michal Dobrodenka", "link": "https://stackoverflow.com/users/1352159/michal-dobrodenka"}, "reply_to_user": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "edited": false, "score": 0, "creation_date": 1576129227, "post_id": 59294557, "comment_id": 104800307, "body": "@FeiHan I was trying to make minimal example based on that doc. When I download sample referenced from that document it works. But that is Asp Net Core 2.x. I&#39;m connecting to my server via Firefox Simple WebSocket client or simple c# websocket-sharp code. Both works with 2.x sample."}, {"owner": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "edited": false, "score": 1, "creation_date": 1576131878, "post_id": 59294557, "comment_id": 104801110, "body": "Did <a href=\"https://i.stack.imgur.com/JYa8P.png\" rel=\"nofollow noreferrer\">a test using Firefix Simple WebSocket Client plugin</a>, and which works well. I&#39;d like to know which one you try to connect, <code>ws:&#47;&#47;</code> or <code>wss:&#47;&#47;</code>?"}, {"owner": {"reputation": 808, "user_id": 1352159, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d27d9335a14ff8e43de58eec500e616f?s=128&d=identicon&r=PG", "display_name": "Michal Dobrodenka", "link": "https://stackoverflow.com/users/1352159/michal-dobrodenka"}, "reply_to_user": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "edited": false, "score": 1, "creation_date": 1576137873, "post_id": 59294557, "comment_id": 104803279, "body": "That&#39;s it! Using wss:// and everything works! Property in launchSettings.json - &quot;sslPort&quot;: decides whenever secure websocket connection is REQUIRED (&quot;Configure for HTTPS&quot; checkbox when creating a new project)"}, {"owner": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "edited": false, "score": 0, "creation_date": 1576143169, "post_id": 59294557, "comment_id": 104805802, "body": "Glad to hear the issue has been solved. Before we start to establish connection(s), we should check the server URL and port first."}], "answers": [{"tags": [], "owner": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "is_accepted": true, "score": 3, "last_activity_date": 1576143074, "creation_date": 1576143074, "answer_id": 59301463, "question_id": 59294557, "link": "https://stackoverflow.com/questions/59294557/cant-get-minimal-asp-net-core-3-1-websocket-example-to-work/59301463#59301463", "title": "Can&#39;t get minimal ASP .NET Core 3.1 WebSocket example to work", "body": "<blockquote>\n  <p>That's it! Using wss:// and everything works!</p>\n</blockquote>\n\n<p>As I mentioned, <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/websockets?view=aspnetcore-3.0\" rel=\"nofollow noreferrer\">WebSockets</a> supports well in ASP.NET Core 3.0 and 3.1.</p>\n\n<p>Besides, as we discussed in comments, we should check the server URL and port before we start to establish connection(s).</p>\n\n<p><em>Using wss://</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/JYa8P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JYa8P.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Using ws://</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/aTQkd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aTQkd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 808, "user_id": 1352159, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d27d9335a14ff8e43de58eec500e616f?s=128&d=identicon&r=PG", "display_name": "Michal Dobrodenka", "link": "https://stackoverflow.com/users/1352159/michal-dobrodenka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3061, "favorite_count": 0, "accepted_answer_id": 59301463, "answer_count": 1, "score": 1, "last_activity_date": 1576143074, "creation_date": 1576100600, "last_edit_date": 1576137906, "question_id": 59294557, "link": "https://stackoverflow.com/questions/59294557/cant-get-minimal-asp-net-core-3-1-websocket-example-to-work", "title": "Can&#39;t get minimal ASP .NET Core 3.1 WebSocket example to work", "body": "<p>I'm trying to migrate my old WebSocket server to ASP.NET Core 3.1. Problem is that even minimum example is not working - when connecting server via web socket on debug, no code is executed and websocket connect timeouts.</p>\n\n<p>I just create empty ASP.NET Core 3.1 project from template and add:\n- app.UseWebSockets();\n- app.Use - see code below\nI also comment out default Routing and UseEndpoints.</p>\n\n<p>Startup code:</p>\n\n<pre><code>\n        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.\n        public void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n        {\n            if (env.IsDevelopment())\n            {\n                app.UseDeveloperExceptionPage();\n            }\n\n            app.UseWebSockets();\n\n            app.Use(async (context, next) =&gt;\n            {\n                if (context.WebSockets.IsWebSocketRequest)\n                {\n                    WebSocket webSocket = await context.WebSockets.AcceptWebSocketAsync();\n\n                    await Echo(context, webSocket);\n                }\n                else\n                {\n                    await context.Response.WriteAsync(\"Not a websocket request\");\n                    //context.Response.StatusCode = 400;\n                }\n            });\n\n            //app.UseRouting();\n            //app.UseEndpoints(endpoints =&gt;\n            //{\n            //    endpoints.MapGet(\"/\", async context =&gt;\n            //    {\n            //        //int a = 0;\n            //        await context.Response.WriteAsync(\"Hello World!\");\n            //    });\n            //});\n        }\n\n        private async Task Echo(HttpContext context, WebSocket webSocket)\n        {\n            var buffer = new byte[1024 * 4];\n            WebSocketReceiveResult result = await webSocket.ReceiveAsync(new ArraySegment&lt;byte&gt;(buffer), CancellationToken.None);\n            while (!result.CloseStatus.HasValue)\n            {\n                await webSocket.SendAsync(new ArraySegment&lt;byte&gt;(buffer, 0, result.Count), result.MessageType, result.EndOfMessage, CancellationToken.None);\n\n                result = await webSocket.ReceiveAsync(new ArraySegment&lt;byte&gt;(buffer), CancellationToken.None);\n            }\n            await webSocket.CloseAsync(result.CloseStatus.Value, result.CloseStatusDescription, CancellationToken.None);\n        }\n</code></pre>\n\n<p>When I connect to this server via browser/normal http request, I get correct response \"Not a websocket request\". But when I try to connect via WebSocket, no user code is hit. In ASP .NET Core 2.2 code works.</p>\n\n<p>Do I have to specify somewhere to accept WebSockets?</p>\n"}, {"tags": ["c#", "wpf", "cancellationtokensource", "cancellation-token"], "comments": [{"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1576101367, "post_id": 59294541, "comment_id": 104793896, "body": "If you put a breakpoint on <code>MessageBox.Show</code> does the debugger stop there when you click the button?  You mightn&#39;t be seeing the message because its running in a child thread?"}, {"owner": {"reputation": 99, "user_id": 4131926, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000593797822/picture?type=large", "display_name": "Johny Wave", "link": "https://stackoverflow.com/users/4131926/johny-wave"}, "reply_to_user": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1576101585, "post_id": 59294541, "comment_id": 104793976, "body": "@MickyD Nope but when i click fast enough i get messagebox with &quot;operation was canceled&quot; thats why im suspecting return function"}], "answers": [{"tags": [], "owner": {"reputation": 1421, "user_id": 4128401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WuCvO.jpg?s=128&g=1", "display_name": "Imantas", "link": "https://stackoverflow.com/users/4128401/imantas"}, "is_accepted": false, "score": 0, "last_activity_date": 1576102402, "creation_date": 1576102402, "answer_id": 59294915, "question_id": 59294541, "link": "https://stackoverflow.com/questions/59294541/cancellationtoken-exception-not-executing/59294915#59294915", "title": "Cancellationtoken exception not executing", "body": "<p>First of all, your method checking whether the connection is valid doesn't respect the cancellation token at all. If it's blocked performing a network operation, simply nothing will happen until it finishes even if you cancel the token.\nIf your FTP client takes most of the whole processing time and there are no asynchronous overloads accepting a CancellationToken, then it's practically uncancellable and throws away all the advantages you expect to gain from the CancellationToken.</p>\n\n<p>Second, if the cancellation happens in the innermost try block, the OperationCanceledExceptions gets suppresses by your <code>catch (Exception)</code> part. You should rethrow the exception if it's OperationCanceledException.</p>\n\n<pre><code>                           try\n                            {\n                                var DecryptedInfo = FileCryptoDecryptor.ReadEncryptedConfiguration(\"hakuna.xml.aes\", Global_Variables.AppPassword);\n                                string DecryptedFTPPass = EncryDecryptor.Decrypt(DecryptedInfo.FtpPassword, \"blablabla\");\n                                token.ThrowIfCancellationRequested();\n                                return General_Functions.isValidConnection(info.HDSynologyIP, info.FtpUsername, DecryptedFTPPass);\n                            }\n                            catch (Exception ex) when (!(ex is OperatiomCanceledException))\n                            {\n                                MessageBox.Show(ex.ToString());\n                            }\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4131926, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000593797822/picture?type=large", "display_name": "Johny Wave", "link": "https://stackoverflow.com/users/4131926/johny-wave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576102402, "creation_date": 1576100496, "last_edit_date": 1576101944, "question_id": 59294541, "link": "https://stackoverflow.com/questions/59294541/cancellationtoken-exception-not-executing", "title": "Cancellationtoken exception not executing", "body": "<p>I need to cancel following async method by clicking on button.</p>\n\n<p>This is what i tried:</p>\n\n<pre><code>private CancellationTokenSource cts;\n\n    private async Task&lt;bool&gt; ValidateFtpAsync()\n    {\n\n        cts = new CancellationTokenSource();\n        CancellationToken token = cts.Token;\n        try\n        {\n            return await Task.Run(\n                    () =&gt;\n                    {\n\n                        token.ThrowIfCancellationRequested();\n\n                        Global_Variables.DoingStuff = true;\n\n                        if (File.Exists(\"settings.xml\"))\n                        {\n                            var xs = new XmlSerializer(typeof(Information));\n                            using (var read = new FileStream(\"settings.xml\", FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite))\n                            {\n\n                                token.ThrowIfCancellationRequested();\n\n                                Information info = (Information)xs.Deserialize(read);\n\n                                try\n                                {\n                                    var DecryptedInfo = FileCryptoDecryptor.ReadEncryptedConfiguration(\"hakuna.xml.aes\", Global_Variables.AppPassword);\n                                    string DecryptedFTPPass = EncryDecryptor.Decrypt(DecryptedInfo.FtpPassword, \"blablabla\");\n                                    token.ThrowIfCancellationRequested();\n                                    return General_Functions.isValidConnection(info.HDSynologyIP, info.FtpUsername, DecryptedFTPPass);\n                                }\n                                catch (Exception ex)\n                                {\n                                    MessageBox.Show(ex.ToString());\n                                }\n                            }\n                            return false;\n                        }\n                        else\n                        {\n                            MessageBox.Show(\"Missing settings file.\");\n                            return false;\n                        }\n                    }, token);\n        }\n        catch(OperationCanceledException)\n        {\n            MessageBox.Show(\"Canceled test\");\n            return false;\n        }\n    }\n\n    private void cancelButton_Click(object sender, RoutedEventArgs e)\n    {\n        cts.Cancel();\n    }\n</code></pre>\n\n<p>I'm <strong>not</strong> getting any cancel exception message when i click on the button.</p>\n\n<p>The function it self is returning if ftp connection is connected with following line:</p>\n\n<pre><code>return General_Functions.isValidConnection(info.HDSynologyIP, info.FtpUsername, DecryptedFTPPass);\n</code></pre>\n\n<p>And this function is not async and takes a most of the time executing could that cause a problem?</p>\n\n<p>Looks like this:</p>\n\n<pre><code> public static bool isValidConnection(string url, string user, string password)\n    {\n        try\n        {\n            FtpClient client = new FtpClient(url);\n            client.Credentials = new NetworkCredential(user, password);\n            client.SocketPollInterval = 60000;\n            client.ConnectTimeout = 60000;\n            client.ReadTimeout = 60000;\n            client.DataConnectionConnectTimeout = 60000;\n            client.DataConnectionReadTimeout = 60000;\n            client.Connect();\n\n            bool IsItConnected = client.IsConnected;\n\n            if (IsItConnected == true)\n            {\n                client.Disconnect();\n                client.Dispose();\n                return true;\n            }\n            else\n            {\n                client.Disconnect();\n                client.Dispose();\n                return false;\n            }\n\n        }\n        catch(Exception ex)\n        {\n            LogWriter loger = new LogWriter(ex.ToString());\n            return false;\n        }\n    }\n</code></pre>\n\n<p>//EDIT</p>\n\n<p>Ftpclient is from FluentFTP library: <a href=\"https://github.com/robinrodricks/FluentFTP\" rel=\"nofollow noreferrer\">https://github.com/robinrodricks/FluentFTP</a></p>\n"}, {"tags": ["c#", "unity3d"], "owner": {"reputation": 19, "user_id": 10846824, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tNOfSeyIUGc/AAAAAAAAAAI/AAAAAAAAADU/itSN01TB9Jk/photo.jpg?sz=128", "display_name": "Bruno Ferrari", "link": "https://stackoverflow.com/users/10846824/bruno-ferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576105380, "creation_date": 1576100205, "last_edit_date": 1576105380, "question_id": 59294467, "link": "https://stackoverflow.com/questions/59294467/unity-build-issue-difference-in-quality-maybye-lights-idk", "title": "Unity build Issue: Difference in quality, maybye lights? IDK", "body": "<p>when I play the game I'm coding in Unity I don't have any issues regarding on how the earth looks like. But once I build, It gets like this: </p>\n\n<p><img src=\"https://i.stack.imgur.com/dTSI8.jpg\" alt=\"enter image description here\"></p>\n\n<p>Can someone point me in the right direction to fix this problem? </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", "jquery", "ajax", "asp.net-mvc", "razor"], "comments": [{"owner": {"reputation": 10598, "user_id": 1179077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CyVen.jpg?s=128&g=1", "display_name": "zgood", "link": "https://stackoverflow.com/users/1179077/zgood"}, "edited": false, "score": 2, "creation_date": 1576100916, "post_id": 59294411, "comment_id": 104793758, "body": "Have you tried <code>return Json(test, JsonRequestBehavior.AllowGet);</code> instead of just <code>return test</code>, just like in the solution you linked."}, {"owner": {"reputation": 31, "user_id": 11783888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ki5HZVf4ACw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMjj0rat3b_aTF5qZrnkynQ_psnw/mo/photo.jpg?sz=128", "display_name": "Mordechai Hadad", "link": "https://stackoverflow.com/users/11783888/mordechai-hadad"}, "reply_to_user": {"reputation": 10598, "user_id": 1179077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CyVen.jpg?s=128&g=1", "display_name": "zgood", "link": "https://stackoverflow.com/users/1179077/zgood"}, "edited": false, "score": 0, "creation_date": 1576102583, "post_id": 59294411, "comment_id": 104794298, "body": "I&#39;m using net.core so can&#39;t really use JsonRequestBehavior.AllowGet"}, {"owner": {"reputation": 8019, "user_id": 9665021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlcMo.png?s=128&g=1", "display_name": "haldo", "link": "https://stackoverflow.com/users/9665021/haldo"}, "edited": false, "score": 0, "creation_date": 1576106304, "post_id": 59294411, "comment_id": 104795430, "body": "Are there any console errors?  Have you verified the the ajax method is actually called? I&#39;d add some logging to the javascript to verify the ajax method is being called"}, {"owner": {"reputation": 31, "user_id": 11783888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ki5HZVf4ACw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMjj0rat3b_aTF5qZrnkynQ_psnw/mo/photo.jpg?sz=128", "display_name": "Mordechai Hadad", "link": "https://stackoverflow.com/users/11783888/mordechai-hadad"}, "edited": false, "score": 0, "creation_date": 1576107384, "post_id": 59294411, "comment_id": 104795712, "body": "Hey the console does not give any errors but I&#39;ll do some breakpoints like how Jonathan suggested to see if it&#39;s actually being called."}, {"owner": {"reputation": 31, "user_id": 11783888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ki5HZVf4ACw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMjj0rat3b_aTF5qZrnkynQ_psnw/mo/photo.jpg?sz=128", "display_name": "Mordechai Hadad", "link": "https://stackoverflow.com/users/11783888/mordechai-hadad"}, "edited": false, "score": 0, "creation_date": 1576187308, "post_id": 59294411, "comment_id": 104828221, "body": "tried to do that nothing seem unusual"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11783888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ki5HZVf4ACw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMjj0rat3b_aTF5qZrnkynQ_psnw/mo/photo.jpg?sz=128", "display_name": "Mordechai Hadad", "link": "https://stackoverflow.com/users/11783888/mordechai-hadad"}, "edited": false, "score": 0, "creation_date": 1576103055, "post_id": 59294896, "comment_id": 104794459, "body": "Edited to add my script tag, it doesn&#39;t seem like ajax is being called even tho the event is definitely being &quot;called&quot;."}, {"owner": {"reputation": 4090, "user_id": 190042, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5ZXq7.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/190042/jonathan"}, "edited": false, "score": 0, "creation_date": 1576103802, "post_id": 59294896, "comment_id": 104794695, "body": "Run Fiddler. Is the <code>GET</code> request being passed through? Use Chrome Developer Tools and put a breakpoint on the <code>$.ajax</code> line. Is it getting hit? Put a breakpoint in your controller code. Is it getting hit? Trace the message from browser, to over the wire, to on the server for some insight."}], "tags": [], "owner": {"reputation": 41, "user_id": 6763163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6382a3a9937d8838068dc00be155803c?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Lieser", "link": "https://stackoverflow.com/users/6763163/thomas-lieser"}, "is_accepted": false, "score": 0, "last_activity_date": 1576102336, "creation_date": 1576102336, "answer_id": 59294896, "question_id": 59294411, "link": "https://stackoverflow.com/questions/59294411/execute-function-from-controller-via-ajax/59294896#59294896", "title": "Execute function from controller via Ajax", "body": "<p>I don't think there is enough information presented to give an accurate solution. I created a local MVC application and added a Test() action method that returns a string and I was able to get the result with your ajax code.</p>\n\n<p>A couple things you could try is:</p>\n\n<ol>\n<li>Making sure the $.ajax actually gets called. So if you have surrounding logic make sure it hits it as expected</li>\n<li>ajax has an error callback that you can add to the ajax call to see if there is an error. <a href=\"https://www.tutorialsteacher.com/jquery/jquery-ajax-method\" rel=\"nofollow noreferrer\">This</a> has an example how to use an error callback to see what is wrong</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 8019, "user_id": 9665021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HlcMo.png?s=128&g=1", "display_name": "haldo", "link": "https://stackoverflow.com/users/9665021/haldo"}, "is_accepted": false, "score": 0, "last_activity_date": 1576108959, "last_edit_date": 1576108959, "creation_date": 1576108442, "answer_id": 59295838, "question_id": 59294411, "link": "https://stackoverflow.com/questions/59294411/execute-function-from-controller-via-ajax/59295838#59295838", "title": "Execute function from controller via Ajax", "body": "<p>Place your <code>&lt;script&gt;</code> tags inside <code>@section</code> in the view and put <code>@RenderSection</code> at the bottom of <code>_Layout.cshtml</code>.</p>\n\n<pre><code>// in your view\n@section Scripts {\n    &lt;script&gt;\n    // your script here\n    ....\n    &lt;/script&gt;\n}\n</code></pre>\n\n<p>Then put this is at the bottom of <code>_Layout.cshtml</code> and make sure it comes after jQuery:</p>\n\n<pre><code>@RenderSection(\"Scripts\", required: false)\n</code></pre>\n\n<hr>\n\n<p><strong>Explanation</strong></p>\n\n<p>My guess is jQuery is not loaded when the the DOM parses your javascript.  If this is the case the your <code>$.ajax</code> call will never work.</p>\n\n<p>The current Visual Studio MVC templates (for .Net-core) place jQuery at the bottom of <code>_Layout.cshtml</code>.  If you place <code>&lt;script&gt;</code> tags in the middle of your view, they will appear before jQuery is requested by the browser.</p>\n\n<p>Placing the <code>&lt;script&gt;</code> tags inside a <code>@section Scripts { }</code> element means that the javascript will actually be added to <code>_Layout.cshtml</code> in the location specified by <code>@RenderSection(\"Scripts\")</code>. </p>\n"}], "owner": {"reputation": 31, "user_id": 11783888, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ki5HZVf4ACw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMjj0rat3b_aTF5qZrnkynQ_psnw/mo/photo.jpg?sz=128", "display_name": "Mordechai Hadad", "link": "https://stackoverflow.com/users/11783888/mordechai-hadad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1576108959, "creation_date": 1576099939, "last_edit_date": 1576102930, "question_id": 59294411, "link": "https://stackoverflow.com/questions/59294411/execute-function-from-controller-via-ajax", "title": "Execute function from controller via Ajax", "body": "<p>I have an ASP.net MVC and I am trying to get a string from a c# function using Ajax I have tried using <a href=\"https://stackoverflow.com/questions/12559515/jquery-ajax-call-to-controller\">this solution</a> but nothing seems to work.</p>\n\n<p><strong>This is my controller function:</strong></p>\n\n<pre><code>public string Test()\n    {\n        string test = \"hi\";\n\n        return test;\n    }\n</code></pre>\n\n<p><strong>This is my script tag:</strong></p>\n\n<pre><code>&lt;script&gt;\n    var textbox = document.getElementById(\"textbox\");\n    textbox.addEventListener(\"keyup\", function (event) {\n        if (event.keyCode === 13) {\n            $.ajax({\n                type: 'GET',\n                url: '@Url.Action(\"Test\", \"Home\")',\n                success: function (result) {\n                    alert(\"hi\");\n                },\n                error: function (request, status, error) {\n                    alert(request.responseText);\n                }\n            });\n        }\n    });\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["c#", ".net", "reflection"], "comments": [{"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 0, "creation_date": 1576101110, "post_id": 59294383, "comment_id": 104793814, "body": "Try changing the setter to internal, private setter can only be used in constructor."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1576102225, "post_id": 59294383, "comment_id": 104794192, "body": "<code>var flags = BindingFlags.Public | BindingFlags.Instance | BindingFlags.SetProperty | BindingFlags.GetProperty; var person = new PhysicalPerson(...); person.GetType().BaseType.GetProperty(&quot;Id&quot;, flags).SetValue(person, 100);</code>"}, {"owner": {"reputation": 39, "user_id": 12425703, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BzWcPOqha4w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfHrRl5IZv4B1mpx6eJD7TZXqxBdg/photo.jpg?sz=128", "display_name": "Marcelo Tropia", "link": "https://stackoverflow.com/users/12425703/marcelo-tropia"}, "edited": false, "score": 0, "creation_date": 1576150958, "post_id": 59294383, "comment_id": 104810166, "body": "Thanks Jimi. I used &quot;protected&quot; and it worked.Hadi explained in his answer what happened. &quot;Protected&quot; propagates the setter to the inheritted classes (private doesn&#39;t)."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1576169083, "post_id": 59294383, "comment_id": 104820695, "body": "That code works with <code>private set</code>, too."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 12425703, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BzWcPOqha4w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfHrRl5IZv4B1mpx6eJD7TZXqxBdg/photo.jpg?sz=128", "display_name": "Marcelo Tropia", "link": "https://stackoverflow.com/users/12425703/marcelo-tropia"}, "edited": false, "score": 1, "creation_date": 1576151060, "post_id": 59294632, "comment_id": 104810224, "body": "Thank you Hadi. I changed the modifier from private to protected and now it is working fine."}], "tags": [], "owner": {"reputation": 1392, "user_id": 10818730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118aa2b192964f9add06223ab97e47bd?s=128&d=identicon&r=PG&f=1", "display_name": "Hadi Samadzad", "link": "https://stackoverflow.com/users/10818730/hadi-samadzad"}, "is_accepted": true, "score": 0, "last_activity_date": 1576101005, "creation_date": 1576101005, "answer_id": 59294632, "question_id": 59294383, "link": "https://stackoverflow.com/questions/59294383/propertyinfo-setvalue-doesnt-work-when-the-property-in-a-base-class-doesnt-h/59294632#59294632", "title": "PropertyInfo.SetValue() doesn&#39;t work when the property in a base class doesn&#39;t have a setter", "body": "<p>When a <code>private</code> modifier is applied to the <code>Id</code>'s setter method, the property <strong>has</strong> a <code>SetMethod()</code> but it's accessible only in the <code>Client</code> class. So you can set a value using reflection. But if you remove the <code>set;</code>, it makes a similar error in the code without inheritance. Try this:</p>\n\n<pre><code>public int? Id { get; }\n</code></pre>\n\n<p>In contrast, when you inherit a new class from the base class, the <code>Id</code>'s setter is not inherited and <code>SetMethod()</code> will be null. Now, you are going to set a value using the child that has not inherited the <code>set;</code> and indeed the <code>PhysicalPerson</code>'s <code>Id</code> property's <code>SetMethod()</code> is null.</p>\n"}], "owner": {"reputation": 39, "user_id": 12425703, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BzWcPOqha4w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfHrRl5IZv4B1mpx6eJD7TZXqxBdg/photo.jpg?sz=128", "display_name": "Marcelo Tropia", "link": "https://stackoverflow.com/users/12425703/marcelo-tropia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 59294632, "answer_count": 1, "score": 1, "last_activity_date": 1576157266, "creation_date": 1576099797, "last_edit_date": 1576157266, "question_id": 59294383, "link": "https://stackoverflow.com/questions/59294383/propertyinfo-setvalue-doesnt-work-when-the-property-in-a-base-class-doesnt-h", "title": "PropertyInfo.SetValue() doesn&#39;t work when the property in a base class doesn&#39;t have a setter", "body": "<p>I am using reflection to get objects. Initially I created a class with an \"Id\" property without a setter because I don't want the user of the framework to set a value to the Id property:</p>\n\n<pre><code>public class Client {\n    public int? Id { get; private set; }\n    public string Name { get; set; }\n    public string Email { get; set; }\n\n    public Client(string name, string email) {\n        Id = null;\n        Name = name;\n        Email = email;\n    }\n}\n</code></pre>\n\n<p>Using reflection I am able to set a value to the Id property using the following code:</p>\n\n<pre><code>foreach (PropertyInfo prop in obj.GetType().GetProperties()) {\n    if (prop.Name == \"Id\") {\n       prop.SetValue(obj, id);\n       break;\n    }\n}\n</code></pre>\n\n<p>But when I use inheritance the PropertyInfo.SetValue doesn't work for the Id property:</p>\n\n<pre><code>public abstract class Client {\n    public int? Id { get; private set; }\n    public string Name { get; set; }\n    public string Email { get; set; }\n\n    public Client(string name, string email) {\n        Id = null;\n        Name = name;\n        Email = email;\n    }\n}\n\npublic class PhysicalPerson : Client {\n        public string CPF { get; set; }\n        public DateTime BirthDate { get; set; }\n\n        public PhysicalPerson(string name, string email, string cpf, DateTime birthDate) : base(name, email) { \n            CPF = cpf;\n            BirthDate = birthDate;\n        }\n    }\n</code></pre>\n\n<p>When prop.SetValue() is executed, it returns the exception \"Property set method not found\".\nI know the Id property doesn't have a setter, but why it works when there is no inheritance?\nI really want to keep the Id property without a setter. Does anyone know how to circumvent this situation?    </p>\n"}, {"tags": ["c#", "blogger"], "comments": [{"owner": {"reputation": 843, "user_id": 12417531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9vyc.png?s=128&g=1", "display_name": "xTwisteDx", "link": "https://stackoverflow.com/users/12417531/xtwistedx"}, "edited": false, "score": 0, "creation_date": 1576099938, "post_id": 59294373, "comment_id": 104793373, "body": "Can you provide the XML or JSON that the API is returning? You&#39;ll need to grab that data from the API and map it into an object. Once it&#39;s mapped then you can grab whatever you want from it and do simple logic on it."}, {"owner": {"reputation": 12675, "user_id": 636009, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IIQJV.jpg?s=128&g=1", "display_name": "David Conrad", "link": "https://stackoverflow.com/users/636009/david-conrad"}, "edited": false, "score": 0, "creation_date": 1576103746, "post_id": 59294373, "comment_id": 104794672, "body": "Have you tried anything?"}, {"owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "edited": false, "score": 0, "creation_date": 1576142785, "post_id": 59294373, "comment_id": 104805573, "body": "Yes, using httpClient i can read the posts (url above), but i think maybe using Blogger APIs Client Library i can do that easly. I didnt found any sample how to use it."}], "answers": [{"tags": [], "owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "is_accepted": true, "score": 0, "last_activity_date": 1576239648, "creation_date": 1576239648, "answer_id": 59322502, "question_id": 59294373, "link": "https://stackoverflow.com/questions/59294373/read-latest-post-from-blogspot-in-c/59322502#59322502", "title": "Read latest post from blogspot in c#", "body": "<p>The solution i found:</p>\n\n<p>Install package:</p>\n\n<pre><code>Install-Package Google.Apis.Blogger.v3 -Version 1.42.0.1720\n</code></pre>\n\n<p>the code:</p>\n\n<pre><code>.....\nusing Google.Apis.Blogger.v3.Data;\n.....    \n\nusing (HttpClient client = new HttpClient())\n{\n    HttpResponseMessage response = await client.GetAsync(\"https://www.googleapis.com/blogger/v3/blogs/&lt;blogkey&gt;/posts?key=&lt;mykey&gt;\");          \n    // Get all posts (typed as PostList) from blog.\n    var postList = JsonConvert.DeserializeObject&lt;PostList&gt;(response.Content.ReadAsStringAsync().Result);\n}\n</code></pre>\n"}], "owner": {"reputation": 1048, "user_id": 9194464, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-seaWoF1hiDU/AAAAAAAAAAI/AAAAAAAAADo/raR_sZ3tMJo/photo.jpg?sz=128", "display_name": "Jorge Ribeiro", "link": "https://stackoverflow.com/users/9194464/jorge-ribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "closed_date": 1576239833, "accepted_answer_id": 59322502, "answer_count": 1, "score": 0, "last_activity_date": 1576239648, "creation_date": 1576099771, "question_id": 59294373, "link": "https://stackoverflow.com/questions/59294373/read-latest-post-from-blogspot-in-c", "closed_reason": "Not suitable for this site", "title": "Read latest post from blogspot in c#", "body": "<p>I'm trying to list the latest post from a blog (blogspot) in blogspot using c#.\nI have a key that allows me to query the posts from google API.</p>\n\n<pre><code>https://www.googleapis.com/blogger/v3/blogs/&lt;blogkey&gt;/posts?key=&lt;mykey&gt;\n</code></pre>\n\n<p>Any sample or help how can i do that? </p>\n"}, {"tags": ["c#", "asp.net", ".net", "web-config", "machine.config"], "comments": [{"owner": {"reputation": 598, "user_id": 10008643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab005fef5de7bc17b121b7f345e237ba?s=128&d=identicon&r=PG&f=1", "display_name": "Merkle Groot", "link": "https://stackoverflow.com/users/10008643/merkle-groot"}, "edited": false, "score": 0, "creation_date": 1576128432, "post_id": 59294248, "comment_id": 104800081, "body": "Normally, the web.config values will take precedence over the machine.config values."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 8226049, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3SUFr9ieZOE/AAAAAAAAAAI/AAAAAAAAANQ/oaVL5WlP3tM/photo.jpg?sz=128", "display_name": "grafbumsdi", "link": "https://stackoverflow.com/users/8226049/grafbumsdi"}, "is_accepted": false, "score": 1, "last_activity_date": 1578989733, "creation_date": 1578989733, "answer_id": 59729802, "question_id": 59294248, "link": "https://stackoverflow.com/questions/59294248/overriding-values-of-machine-config-in-web-config-in-net-4-5/59729802#59729802", "title": "Overriding values of Machine.config in web.config in .net 4.5", "body": "<p>Checkout the documentation here:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/ms178685(v=vs.140)#the-processmodel-element\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/ms178685(v=vs.140)#the-processmodel-element</a></p>\n\n<p>It states:</p>\n\n<blockquote>\n  <p>Thus, processModel settings can be placed only in the Machine.config file, and they cannot be overridden by settings in any Web.config file.</p>\n</blockquote>\n\n<p>Some of the settings you mentioned are part of this <code>processModel</code> and so cannot be modified via web.config.</p>\n"}], "owner": {"reputation": 15538, "user_id": 1350476, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1fdc7b4b3da278b1c1c5b4c4b250bafb?s=128&d=identicon&r=PG", "display_name": "SharpCoder", "link": "https://stackoverflow.com/users/1350476/sharpcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1578989733, "creation_date": 1576099166, "question_id": 59294248, "link": "https://stackoverflow.com/questions/59294248/overriding-values-of-machine-config-in-web-config-in-net-4-5", "title": "Overriding values of Machine.config in web.config in .net 4.5", "body": "<p>I am using .net 4.5 ASP.NET Web API application. How can i overwrite following settings in web.config file.</p>\n\n<pre><code>\u2022maxWorkerThreads\n\u2022minWorkerThreads\n\u2022maxIoThreads\n\u2022minFreeThreads\n\u2022minLocalRequestFreeThreads\n\u2022maxconnection\n\u2022executionTimeout\n</code></pre>\n"}, {"tags": ["c#", "performance", "instrumentation"], "comments": [{"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 1, "creation_date": 1576098797, "post_id": 59294121, "comment_id": 104792891, "body": "Please read the speed rant, to verify that you actually need this: <a href=\"https://ericlippert.com/2012/12/17/performance-rant/\" rel=\"nofollow noreferrer\">ericlippert.com/2012/12/17/performance-rant</a> | If you still want to do this afterwards, I would generally advise for using existing options. As as the Article says, writing usefull Benchmarks is not trivial and easily done wrong."}, {"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1576098826, "post_id": 59294121, "comment_id": 104792907, "body": "especially automated ways of doing so is hard since you have to rewrite/inject il."}, {"owner": {"reputation": 211, "user_id": 5157915, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30099d2e5bad9fda13f0ef9c3b677e52?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/5157915/jack"}, "edited": false, "score": 0, "creation_date": 1576099488, "post_id": 59294121, "comment_id": 104793190, "body": "I am already using DI container to in my project. Does that solve some of my concern."}, {"owner": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "edited": false, "score": 0, "creation_date": 1576099516, "post_id": 59294121, "comment_id": 104793204, "body": "Instead of using a stopwatch, just keep track of the DateTime.Now.Ticks value. Keep a record of the ticks in start and end, then you know the duration by Timespan.FromTicks(afterTicks - beforeTicks).  If you want to get fancy then make a class to provide a Start() and Stop() method that can track the calling method and generate some reports for you."}, {"owner": {"reputation": 211, "user_id": 5157915, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30099d2e5bad9fda13f0ef9c3b677e52?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/5157915/jack"}, "reply_to_user": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576100067, "post_id": 59294121, "comment_id": 104793420, "body": "@Christopher what would be your recommendation that I should do ?"}, {"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "reply_to_user": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "edited": false, "score": 0, "creation_date": 1576100546, "post_id": 59294121, "comment_id": 104793633, "body": "@ZakkDiaz That is very incorrect, unless you got runtimes in the order of 10&#39;s of Milliseconds. The result of DateTime.Now only updates every ~20 ms. The stopwatch is actually reliable. | But even with that, you can not account for GC runs and the like reliably. As those only happen intermitently."}, {"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576100637, "post_id": 59294121, "comment_id": 104793671, "body": "@jack First you should show us you read the speed rant, by explaining why you need this and wich of the dozen or so &quot;speeds&quot; you want to optimize for."}, {"owner": {"reputation": 211, "user_id": 5157915, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30099d2e5bad9fda13f0ef9c3b677e52?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/5157915/jack"}, "reply_to_user": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576101079, "post_id": 59294121, "comment_id": 104793806, "body": "@Christopher : I updated my question with a scenario why I am looking for this."}, {"owner": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "reply_to_user": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576101227, "post_id": 59294121, "comment_id": 104793857, "body": "@Christopher You&#39;re right I wasn&#39;t aware of the refresh rate of DateTime.Now or that it could be affected by garbage collection. From the OP I was under the impression they didn&#39;t want to use a stopwatch. My suggestion for reflection with the method name was an attempt to remedy the need of passing an Id along. I fully anticipated that the process would take more than a few hundred MS, OP didn&#39;t state they are writing highly performant code."}, {"owner": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "edited": false, "score": 0, "creation_date": 1576101435, "post_id": 59294121, "comment_id": 104793919, "body": "<a href=\"https://stackoverflow.com/questions/307582/how-frequent-is-datetime-now-updated-or-is-there-a-more-precise-api-to-get-the\" title=\"how frequent is datetime now updated or is there a more precise api to get the\">stackoverflow.com/questions/307582/&hellip;</a> <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.datetime.now?redirectedfrom=MSDN&amp;view=netframework-4.8#System_DateTime_Now\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a>"}, {"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "reply_to_user": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "edited": false, "score": 0, "creation_date": 1576112206, "post_id": 59294121, "comment_id": 104796745, "body": "@ZakkDiaz Either measurement approach can not properly account for the GC. It is an issue in .NET | You could call a whole bunch of that function in a loop and then call GC.Collect() before getting the end time for this cycle. However that would only get you a lower bound, as the runtime for the GC increases the more elements (collectable or not) there is in memory. | Unfortunately Eric posted his posts about how to do it &quot;right&quot; on a Blog that is no longer reachable. So that is about the best I can do."}, {"owner": {"reputation": 211, "user_id": 5157915, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30099d2e5bad9fda13f0ef9c3b677e52?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/5157915/jack"}, "edited": false, "score": 0, "creation_date": 1576168039, "post_id": 59294121, "comment_id": 104820179, "body": "Thank you guys. But the discussion that you guys currently had is not what I was looking for. Thanks :)"}], "owner": {"reputation": 211, "user_id": 5157915, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/30099d2e5bad9fda13f0ef9c3b677e52?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/5157915/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576101044, "creation_date": 1576098591, "last_edit_date": 1576101044, "question_id": 59294121, "link": "https://stackoverflow.com/questions/59294121/creating-custom-performance-instrumentation-in-c", "title": "Creating custom performance instrumentation in C#", "body": "<p>I am trying to register how much time each method takes to execute. I do not want to use any 3rd party tools which does this. I also looked at few older posts that have some suggestion but they are pretty old, so I am looking for recommendation if there is a newer way to do it. Also, this instrumentation logic should work with .net core and .net full framework.</p>\n\n<p>I do not want to do something like this</p>\n\n<pre><code>class myClass{\n    public void mytest(){\n       StopWatch sw = new StopWatch();\n       sw.start();\n       // DO SOMETHING\n       sw.stop();\n       log(sw.elapse());\n    }\n}\n</code></pre>\n\n<p>Also, I want to tie everything to a ID and do not want to pass the ID to all the methods which would be a lot of work. So, want to create an interface and it does all the performance logging for all the methods which are used.</p>\n\n<p>Please let me know if this is not clear enough. I can provide with any clarification.</p>\n\n<p>What I am writing is a Nuget Package. This nuget packagae can be used in a .net core webapp or it can be used in a legacy WCF application. With that said the nuget package received a request, it then does some business logic and then calls a geospatical database. What I am looking for is a way to know the duration of each call that is done in the business logic or calling the DB. The reason for this is that when the geo data changes, some queries that we have may not function optimally or some others rules set in the business logic could become unoptimized and hence I would look at this speeds to see where the issue is and debug it accordingly.</p>\n"}, {"tags": ["c#", ".net", "asp.net-mvc", "asp.net-core", ".net-core"], "answers": [{"tags": [], "owner": {"reputation": 3302, "user_id": 12431728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5fb7b733c152599fa38023820400e9b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt U", "link": "https://stackoverflow.com/users/12431728/matt-u"}, "is_accepted": false, "score": 1, "last_activity_date": 1576102248, "creation_date": 1576102248, "answer_id": 59294879, "question_id": 59294099, "link": "https://stackoverflow.com/questions/59294099/net-core-return-iactionresult-from-a-custom-exception-middleware/59294879#59294879", "title": ".Net Core: Return IActionResult from a custom Exception Middleware", "body": "<p>That's not really possible due to where <code>IActionResult</code> and middleware sit in relation to one another in the architecture. Middleware sits much lower, and so it can't reach further up the stack to <code>IActionResult</code>. Here's an answer that talks more about it: <a href=\"https://stackoverflow.com/a/43111292/12431728\">https://stackoverflow.com/a/43111292/12431728</a></p>\n"}, {"tags": [], "owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "is_accepted": true, "score": 6, "last_activity_date": 1576106138, "creation_date": 1576106138, "answer_id": 59295539, "question_id": 59294099, "link": "https://stackoverflow.com/questions/59294099/net-core-return-iactionresult-from-a-custom-exception-middleware/59295539#59295539", "title": ".Net Core: Return IActionResult from a custom Exception Middleware", "body": "<p><a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.iactionresult?view=aspnetcore-3.0\" rel=\"noreferrer\"><code>IActionResult</code></a> is a thing from MVC, so it is only available within the MVC pipeline (including Razor Pages). Just before the MVC middleware terminates, it will <em>execute</em> those action results using <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.iactionresult.executeresultasync?view=aspnetcore-3.0\" rel=\"noreferrer\"><code>ExecuteAsync</code></a>. That method is then responsible of writing that response to <code>HttpContext.Response</code>.</p>\n\n<p>So in custom middleware, you cannot just set an action result and have it executed, since you are not running within the MVC pipeline. However, with that knowledge, you can simply execute the result yourself.</p>\n\n<p>Let\u2019s say you want to execute a <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.notfoundresult?view=aspnetcore-3.0\" rel=\"noreferrer\"><code>NotFoundResult</code></a> which is what <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.controllerbase.notfound?view=aspnetcore-3.0\" rel=\"noreferrer\"><code>Controller.NotFound()</code></a> creates. So you create that result and call <code>ExecuteAsync</code> with an . That executor will be able to execute that result object and write to the response:</p>\n\n<pre><code>var result = new NotFoundResult();\nawait result.ExecuteAsync(new ActionContext\n{\n    HttpContext = context,\n});\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10903, "user_id": 758093, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/78bf6c8ba2dff9e0ff636371460b0dfb?s=128&d=identicon&r=PG", "display_name": "Marko", "link": "https://stackoverflow.com/users/758093/marko"}, "is_accepted": false, "score": 1, "last_activity_date": 1576107086, "creation_date": 1576107086, "answer_id": 59295660, "question_id": 59294099, "link": "https://stackoverflow.com/questions/59294099/net-core-return-iactionresult-from-a-custom-exception-middleware/59295660#59295660", "title": ".Net Core: Return IActionResult from a custom Exception Middleware", "body": "<p>What you're trying to do can be done by simply adding this line:</p>\n\n<pre><code>app.UseStatusCodePagesWithReExecute(\"/Public/Error\", \"?statusCode={0}\");\n</code></pre>\n\n<p>to the Configure method in the Startup.cs. Then you can create your Public Controller with Error method that does the following:</p>\n\n<pre><code>[AllowAnonymous]\npublic IActionResult Error(int? statusCode = null)\n{\n    // Retrieve error information in case of internal errors.\n    var error = HttpContext.Features.Get&lt;IExceptionHandlerFeature&gt;()?.Error;\n    var path = HttpContext.Features.Get&lt;IExceptionHandlerPathFeature&gt;()?.Path;\n\n    // TODO: Redirect here based on your status code or perhaps just render different views for different status codes.\n}\n</code></pre>\n\n<p>There is also another middleware that allows you to do a similar thing:</p>\n\n<pre><code>app.UseStatusCodePages(async context =&gt;\n{\n    if (context.HttpContext.Response.StatusCode == 401)\n    {\n        context.HttpContext.Response.Redirect(\"Errors/Unauthorized/\");\n    }\n    else if (context.HttpContext.Response.StatusCode == 500)\n    {\n        // TODO: Redirect for 500 and so on...\n    }\n });\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 3646993, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/14f018036f19a4e4675543c5eed585d5?s=128&d=identicon&r=PG&f=1", "display_name": "shaikhspear", "link": "https://stackoverflow.com/users/3646993/shaikhspear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2863, "favorite_count": 0, "accepted_answer_id": 59295539, "answer_count": 3, "score": 3, "last_activity_date": 1576107086, "creation_date": 1576098501, "question_id": 59294099, "link": "https://stackoverflow.com/questions/59294099/net-core-return-iactionresult-from-a-custom-exception-middleware", "title": ".Net Core: Return IActionResult from a custom Exception Middleware", "body": "<p>I have created a new Exception middleware in my .Net Core application. All the exceptions throughout the application are captured and logged here. What I want is to return a IActionResult type like InternalServerError() or NotFound() from the Exception Middleware and not do response.WriteAsync as below.</p>\n\n<p>Controller Method:</p>\n\n<pre><code>   public async Task&lt;IActionResult&gt; Post()\n    {\n        //Do Something\n        return Ok();\n    }\n</code></pre>\n\n<p>Middleware:</p>\n\n<pre><code>public class ExceptionMiddleware\n    {\n        private readonly RequestDelegate _next;\n        public ExceptionMiddleware(RequestDelegate next)\n        {\n            _next = next;\n        }\n\n        public async Task Invoke(HttpContext context)\n        {\n            try\n            {\n                await _next.Invoke(context);\n            }\n            catch (Exception ex)\n            {\n                await HandleExceptionAsync(context, ex);\n            }\n        }\n\n        private async Task HandleExceptionAsync(HttpContext context, Exception exception)\n        {\n            var response = context.Response;\n            var statusCode = (int)HttpStatusCode.InternalServerError;\n            var message = exception.Message;\n            var description = exception.Message;\n\n            response.ContentType = \"application/json\";\n            response.StatusCode = statusCode;\n\n            await response.WriteAsync(JsonConvert.SerializeObject(new ErrorResponse\n            {\n                Message = message,\n                Description = description\n            }));\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "if-statement", "variables"], "comments": [{"owner": {"reputation": 11711, "user_id": 1361787, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/XR9JP.png?s=128&g=1", "display_name": "ChiefTwoPencils", "link": "https://stackoverflow.com/users/1361787/chieftwopencils"}, "edited": false, "score": 3, "creation_date": 1576098539, "post_id": 59294077, "comment_id": 104792804, "body": "There&#39;s no code to interact with a console user in the code you provided."}, {"owner": {"reputation": 556, "user_id": 7274172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dPFDl.jpg?s=128&g=1", "display_name": "Luchspeter", "link": "https://stackoverflow.com/users/7274172/luchspeter"}, "edited": false, "score": 0, "creation_date": 1576098671, "post_id": 59294077, "comment_id": 104792852, "body": "Where did you define a and b?  You might want to use <code>Console.ReadLine()</code> with appropriate conversion to &quot;Interact with it&quot;"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 3, "creation_date": 1576098692, "post_id": 59294077, "comment_id": 104792863, "body": "You need to learn how to use <a href=\"https://docs.microsoft.com/en-us/visualstudio/debugger/debugger-feature-tour?view=vs-2019\" rel=\"nofollow noreferrer\">the debugger</a> to step through the code line by line. That way you can understand what it&#39;s doing."}, {"owner": {"reputation": 10428, "user_id": 3135317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e914266956f4052eef356be7850ea49?s=128&d=identicon&r=PG&f=1", "display_name": "FoggyDay", "link": "https://stackoverflow.com/users/3135317/foggyday"}, "edited": false, "score": 2, "creation_date": 1576098712, "post_id": 59294077, "comment_id": 104792871, "body": "Step through your code in the MSVS debugger.  If you don&#39;t know how to use the debugger - this is a great opportunity to <i>LEARN</i>.  That will show you <i>exactly</i> why you&#39;re &quot;not seeing anything&quot; ;)"}, {"owner": {"reputation": 1, "user_id": 12191857, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBwZczw8sSOld68DSYzxn5XPKGtwVixjsZM1loV=k-s128", "display_name": "Aust", "link": "https://stackoverflow.com/users/12191857/aust"}, "edited": false, "score": 0, "creation_date": 1576100985, "post_id": 59294077, "comment_id": 104793774, "body": "Ohhhh thx guys i will try to use the visual studio debug feartures"}], "answers": [{"comments": [{"owner": {"reputation": 546, "user_id": 10756238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Kw0_pdhwDWE/AAAAAAAAAAI/AAAAAAAAEZE/E51zKLIJYr8/photo.jpg?sz=128", "display_name": "Henrique Sabino", "link": "https://stackoverflow.com/users/10756238/henrique-sabino"}, "edited": false, "score": 0, "creation_date": 1576107585, "post_id": 59294631, "comment_id": 104795776, "body": "You need to give more info to them, say in which part of the code they forgot to put the Console.ReadLine();"}], "tags": [], "owner": {"reputation": 1, "user_id": 12521138, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EQoFZtsyL68/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdlfVmWc46nGMKCA6ilp5fSrPQuYw/photo.jpg?sz=128", "display_name": "Hans Peter", "link": "https://stackoverflow.com/users/12521138/hans-peter"}, "is_accepted": false, "score": -1, "last_activity_date": 1576101005, "creation_date": 1576101005, "answer_id": 59294631, "question_id": 59294077, "link": "https://stackoverflow.com/questions/59294077/how-can-i-fix-this-code-that-when-running-dont-do-anything/59294631#59294631", "title": "How can i fix this code that, when running, don&#39;t do anything?", "body": "<p>U forgot the\nConsole.ReadLine();</p>\n"}], "owner": {"reputation": 1, "user_id": 12191857, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBwZczw8sSOld68DSYzxn5XPKGtwVixjsZM1loV=k-s128", "display_name": "Aust", "link": "https://stackoverflow.com/users/12191857/aust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1576101005, "creation_date": 1576098391, "last_edit_date": 1576100556, "question_id": 59294077, "link": "https://stackoverflow.com/questions/59294077/how-can-i-fix-this-code-that-when-running-dont-do-anything", "title": "How can i fix this code that, when running, don&#39;t do anything?", "body": "<p>Well im trying to do a simple code in c# with nothing more than some if statements, but for some reason i don't understand the code compile but don't let me interact with. The console window keep black and when i press some key nothing happens.It should show the value of result (one or two dependent of the case).\nThe code:</p>\n\n<pre><code>        int result1;\n        int result2;\n        int delta = (b * b) - 4 * a * b;\n        //Declaration of the variables results and delta, the ones that will be used in the following block\n        if ((a != 0) &amp;&amp; (b != 0) &amp;&amp; (c != 0))\n        {\n            if (delta == 0)\n            {\n                result1 = (-b) / (2 * a);\n                Console.WriteLine(result1);\n            }\n            else if (delta &gt; 0)\n            {\n                result1 = (-b + Root(delta)) / (2 * a);\n                result2 = (-b - Root(delta)) / (2 * a);\n                Console.WriteLine(result1);\n                Console.WriteLine(result2);\n            }\n            else\n            {\n                Console.WriteLine(\"Sem resultado: delta menor que zero.\");\n            }\n        }\n        //In this if clause the code will verify the use of Bhaskara and the value of delta. Then execute the right count.\n</code></pre>\n\n<p>The \"root\" method up there is this one:</p>\n\n<pre><code>static int Root (int radi) \n    {\n        int rootTester = 0;\n        int result;\n        for (; ;)\n        {\n            rootTester++;\n            if(rootTester * rootTester != radi)\n            {\n                continue;\n            }\n            else\n            {\n                break;\n            }\n        }\n        result = rootTester;\n        return result;\n        //Here the compiler will try to multiplie a number for itself until this number will get equal the value of the radial\n    }\n</code></pre>\n\n<p>The variables \"a\", \"b\" and \"c\" have respectively the values 1, -20 and 51.\nI tried to change the delta declaration of place, but it doesn't worked.\nHow can i solve this problem?\n(sorry if i said something wrong in english)</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1576098271, "post_id": 59293986, "comment_id": 104792695, "body": "I&#39;ve noticed when when consuming .NET Standard class library, the packages that library references aren&#39;t pulled in to the consuming project. Did you try adding a reference to the missing package from the actual startup project?"}, {"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1576098603, "post_id": 59293986, "comment_id": 104792831, "body": "guessing it isn&#39;t part of .net standard. you&#39;ll have to add <a href=\"https://www.nuget.org/packages/System.Security.Principal.Windows/\" rel=\"nofollow noreferrer\">nuget.org/packages/System.Security.Principal.Windows</a>"}, {"owner": {"reputation": 11, "user_id": 12520808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f725c8b9b3ae06903fbe38474867642?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil_", "link": "https://stackoverflow.com/users/12520808/kamil"}, "edited": false, "score": 0, "creation_date": 1576099397, "post_id": 59293986, "comment_id": 104793155, "body": "I added nuget package System.Security.Principal.Windows. My startup project is in .NET framework 4.6.1 but also tried add reference to the package"}], "owner": {"reputation": 11, "user_id": 12520808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f725c8b9b3ae06903fbe38474867642?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil_", "link": "https://stackoverflow.com/users/12520808/kamil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576102468, "creation_date": 1576097995, "last_edit_date": 1576102468, "question_id": 59293986, "link": "https://stackoverflow.com/questions/59293986/could-not-find-assembly-system-security-principal-windows", "title": "Could not find assembly System.Security.Principal.Windows", "body": "<p>In my solution I have .NET standard 2.0 project and it refers to System.Security.Principal.Windows package. All projects in solution have same outputPath (outputPath=\"../bin/Debug\"). After building the application dll file form mentioned package doesn't exist in bin/debug. I saw other similar topics but I still have this problem. I have the problem only when I am building application on jenkins when using msbuild 2019.</p>\n"}, {"tags": ["c#", "json"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 6, "creation_date": 1576097762, "post_id": 59293901, "comment_id": 104792496, "body": "I&#39;m not sure what you mean by a &quot;raw&quot; object, but a string is a string. Using standard JSON deserializer JSON.Net, you can <i>deserialize</i> to a <code>dynamic</code>, to <code>JObject</code>, or to a <code>Dictionary</code> and are not limited to a compile-time class definition."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 1, "creation_date": 1576098247, "post_id": 59293901, "comment_id": 104792687, "body": "I don&#39;t think <code>JsonUtility.FromJson()</code> can deserialize to a dictionary, see <a href=\"https://stackoverflow.com/q/40204522\">how to deserialize json with arbitrary string keys using JsonUtility(unity c#)?</a> and <a href=\"https://stackoverflow.com/q/38982324\">Is it possible to deserialize a dictionary in Unity?</a>.  If you could switch to a different serializer such as <a href=\"https://stackoverflow.com/questions/tagged/json.net\">json.net</a> it would be easy.  Can you do that?"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 1, "creation_date": 1576098896, "post_id": 59293901, "comment_id": 104792933, "body": "Generally speaking, what you are attempting to do defeats the purpose of having a strongly typed language. I would recommend instead you create classes to represent what you are expecting to receive."}, {"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 3, "creation_date": 1576099129, "post_id": 59293901, "comment_id": 104793030, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/q/36239705/1092820\">Serialize and Deserialize Json and Json Array in Unity</a> See part 3 of <a href=\"https://stackoverflow.com/a/36244111/1092820\">this answer</a>"}, {"owner": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1576099761, "post_id": 59293901, "comment_id": 104793296, "body": "@crashmstr You should&#39;ve posted that as the answer. Deserializing to dynamic would be the most appropriate answer but perhaps someone could document the downsides as well"}], "answers": [{"comments": [{"owner": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "edited": false, "score": 1, "creation_date": 1576099828, "post_id": 59294375, "comment_id": 104793324, "body": "Additional resources <a href=\"https://stackoverflow.com/questions/3142495/deserialize-json-into-c-sharp-dynamic-object\" title=\"deserialize json into c sharp dynamic object\">stackoverflow.com/questions/3142495/&hellip;</a>"}], "tags": [], "owner": {"reputation": 161, "user_id": 11911474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sa8hE.jpg?s=128&g=1", "display_name": "Chat Dp", "link": "https://stackoverflow.com/users/11911474/chat-dp"}, "is_accepted": false, "score": 0, "last_activity_date": 1576099775, "creation_date": 1576099775, "answer_id": 59294375, "question_id": 59293901, "link": "https://stackoverflow.com/questions/59293901/convert-json-string-to-c-object-without-declaring-class-to-deserialize-into/59294375#59294375", "title": "Convert JSON string to C# object without declaring class to deserialize into", "body": "<h2>Solution #1</h2>\n\n<p>Thank you guys for your helpful idea. Now with your all idea, I can figure it out.</p>\n\n<pre><code>using Newtonsoft;\n\nvoid callback(string response)\n{\n   dynamic level_1 = Newtonsoft.Json.JsonConvert.DeserializeObject(response);\n   print(\"code: \" + level_1.code); // The console now shows 200\n}\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 11911474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sa8hE.jpg?s=128&g=1", "display_name": "Chat Dp", "link": "https://stackoverflow.com/users/11911474/chat-dp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 511, "favorite_count": 0, "closed_date": 1576103475, "answer_count": 1, "score": 0, "last_activity_date": 1576099775, "creation_date": 1576097560, "last_edit_date": 1576099604, "question_id": 59293901, "link": "https://stackoverflow.com/questions/59293901/convert-json-string-to-c-object-without-declaring-class-to-deserialize-into", "closed_reason": "Duplicate", "title": "Convert JSON string to C# object without declaring class to deserialize into", "body": "<p>I have a JSON string. I want to cast the string to object <strong>without declaring a class before</strong>. This code will work if there's the object. but the problem is I can't use the result like a dictionary.</p>\n\n<p>JSON String sample:</p>\n\n<blockquote>\n  <p>{\"code\":200,\"detail\":\"your request is accepted\",\"data\":[{\"id\":1,\"name\":\"A\"},{\"id\":2,\"name\":\"Bee\"}]}</p>\n</blockquote>\n\n<p>The code:</p>\n\n<pre><code>void callback(string response)\n{\n   var obj = response as object; // It's not error but this may can't cast to object\n   var level_1 = obj as Dictionary&lt;string,object&gt;;\n   print(level_1[\"code\"]); // This should print 200 at Console. \n                           // but it doesn't this shows error \"Value cannot be null.\"\n                           // so the obj variable should be cast to empty object.\n\"\n}\n</code></pre>\n\n<p>I tried to find, but I found only casting the string to <strong>declared class</strong> such as:</p>\n\n<pre><code>[Serializable]\npublic MyClass()\n{\n   public code;\n}\nvar obj = JsonUtility.FromJson&lt;MyClass&gt;(Json);\n</code></pre>\n\n<p>Is there a way to convert an arbitrary JSON string into an object without declaring a class with all the fields it has? </p>\n"}, {"tags": ["c#", "asp.net-core", "dependency-injection", ".net-core"], "comments": [{"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576097837, "post_id": 59293871, "comment_id": 104792532, "body": "TryAdd speaks of worries about Race Conditions. Or generally a Multitasking focus for this class. This can include the function be called from Multiple Programms (like is the case with most Windows API functions - unless you got a locking mechanic in place instead. You find it in Concurrent Collections, the Channel (a modified Queue) and similar cases."}, {"owner": {"reputation": 2824, "user_id": 2869055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2c7c67d2983e8db074cbb68daa86a1?s=128&d=identicon&r=PG", "display_name": "mwilczynski", "link": "https://stackoverflow.com/users/2869055/mwilczynski"}, "edited": false, "score": 0, "creation_date": 1576097979, "post_id": 59293871, "comment_id": 104792584, "body": "This is not true with any <code>TryParse</code> and <code>TryAdd</code> on <code>Dictionary&lt;TKey, TValue&gt;</code>. Especially on key-value structures it&#39;s rather an alternative to throwing exception on attempt to add duplicate key."}, {"owner": {"reputation": 1504, "user_id": 2933946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fac94f311bc302b24e56e201ce7aef0?s=128&d=identicon&r=PG&f=1", "display_name": "xander", "link": "https://stackoverflow.com/users/2933946/xander"}, "edited": false, "score": 0, "creation_date": 1576101704, "post_id": 59293871, "comment_id": 104794010, "body": "The point of the IServiceCollection TryAdd methods isn&#39;t to deal with concurrency issues, and the container won&#39;t throw an exception on duplicate keys. I assume the OP is trying to add a &quot;sane default&quot; IOptions registration as part of a framework, and wants to allow framework users to optionally replace that registration. See <a href=\"https://stackoverflow.com/questions/41743150/aspnet-core-di-tryadd-vs-add-usage\">here</a> for an explanation of the pattern."}], "owner": {"reputation": 2625, "user_id": 3241128, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b505e78f740ee57edb21117db4e0ab4?s=128&d=identicon&r=PG&f=1", "display_name": "bubbleking", "link": "https://stackoverflow.com/users/3241128/bubbleking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1576117548, "creation_date": 1576097457, "question_id": 59293871, "link": "https://stackoverflow.com/questions/59293871/is-there-an-equivalent-to-iservicecollections-tryadd-methods-for-use-with-the", "title": "Is there an equivalent to IServiceCollection&#39;s &quot;TryAdd&quot; methods for use with the IOptions&lt;T&gt; pattern?", "body": "<p>I find the .NET Core IOptions pattern, as expressed in the syntax below, to be quite helpful.</p>\n\n<pre><code>services.Configure&lt;MySettings&gt;(configuration.GetSection(\"MySettings\"));\n</code></pre>\n\n<p>I also find the TryAdd methods helpful for guarding against duplicating a service registration, like this:</p>\n\n<pre><code>services.TryAddTransient&lt;IMyService, MyService&gt;();\n</code></pre>\n\n<p>I'm wondering if anyone knows of any technique for accomplishing the same thing with IOptions, or if duplicate registration protection is, perhaps, built into the framework.  In other words, I'm looking for something like this:</p>\n\n<pre><code>services.TryConfigure&lt;MySettings&gt;(configuration.GetSection(\"MySettings\"));\n</code></pre>\n"}, {"tags": ["c#", ".net-core", ".net-4.7.2"], "comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1576097442, "post_id": 59293824, "comment_id": 104792362, "body": "Assuming you&#39;ve verified that <code>Encoding.Default</code> is the same... Please <a href=\"https://stackoverflow.com/posts/59293824/edit\">edit</a> to confirm (or better yet - for <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> use fixed encoding like UTF8)"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1576097568, "post_id": 59293824, "comment_id": 104792411, "body": "Side note: there are much better looking array-&gt;hex (<a href=\"https://stackoverflow.com/questions/311165/how-do-you-convert-a-byte-array-to-a-hexadecimal-string-and-vice-versa\" title=\"how do you convert a byte array to a hexadecimal string and vice versa\">stackoverflow.com/questions/311165/&hellip;</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 4389106, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003185341531/picture?type=large", "display_name": "R&#233;my", "link": "https://stackoverflow.com/users/4389106/r%c3%a9my"}, "edited": false, "score": 0, "creation_date": 1576099470, "post_id": 59293900, "comment_id": 104793187, "body": "Thanks for your answer, I just have to find what is the defaut encoding of my computer"}], "tags": [], "owner": {"reputation": 148466, "user_id": 2319407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/98O16.jpg?s=128&g=1", "display_name": "Dmitry Bychenko", "link": "https://stackoverflow.com/users/2319407/dmitry-bychenko"}, "is_accepted": true, "score": 6, "last_activity_date": 1576097558, "creation_date": 1576097558, "answer_id": 59293900, "question_id": 59293824, "link": "https://stackoverflow.com/questions/59293824/same-code-gives-different-result-in-net-core-and-net-4-7-2/59293900#59293900", "title": "Same code gives different result in .net core and .net 4.7.2", "body": "<p>Check</p>\n\n<pre><code>  var md5val = md5(urlPart, Encoding.Default);\n</code></pre>\n\n<p>since <code>Encoding.Default</code> is always <strong>Utf-8</strong> in case of .net <em>core</em> and <strong>system's active code page</strong> in .net <em>framework</em>.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.text.encoding.default?view=netframework-4.8\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/dotnet/api/system.text.encoding.default?view=netframework-4.8</a></p>\n"}], "owner": {"reputation": 355, "user_id": 4389106, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003185341531/picture?type=large", "display_name": "R&#233;my", "link": "https://stackoverflow.com/users/4389106/r%c3%a9my"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 59293900, "answer_count": 1, "score": 3, "last_activity_date": 1576097558, "creation_date": 1576097239, "last_edit_date": 1576097434, "question_id": 59293824, "link": "https://stackoverflow.com/questions/59293824/same-code-gives-different-result-in-net-core-and-net-4-7-2", "title": "Same code gives different result in .net core and .net 4.7.2", "body": "<p>Here is the following C# code to obtain the Md5 value of a string</p>\n\n<pre><code>using System;\nusing System.Security.Cryptography;\nusing System.Text;\n\nnamespace ConsoleApp1\n{\n  class Program\n  {\n    static void Main(string[] args)\n    {\n        var urlPart = \"dd5fad78903da9d3ce4905f8e731d6c4\u00fdundefined\u00fd3780534\u00fd5\";\n        Console.WriteLine(\"value= \" + urlPart);\n        var md5val = md5(urlPart, Encoding.Default);\n        Console.WriteLine(\"md5= \" + md5val);\n    }\n\n    public static string md5(string value, System.Text.Encoding encoding)\n    {\n        var buffer = encoding.GetBytes(value);\n        //Console.WriteLine(\"buffer= \" + BitConverter.ToString(buffer));\n\n        MD5 md5Hasher = MD5.Create();\n        byte[] data = md5Hasher.ComputeHash(buffer);\n        StringBuilder sBuilder = new StringBuilder();\n        for (int i = 0; i &lt; data.Length; i++)\n        {\n            sBuilder.Append(data[i].ToString(\"x2\"));\n        }\n        return sBuilder.ToString();\n    }\n  }\n}\n</code></pre>\n\n<p>If I compiled on .Net 4.72 it gives </p>\n\n<blockquote>\n  <p>md5=\"b5d0f17bf46f869abf8d8f51156126b7\"</p>\n</blockquote>\n\n<p>If I compiled on .Net core 3.0 it gives </p>\n\n<blockquote>\n  <p>md5=\"96af5cbab2ae75384e0f46a961dcbc4e\"</p>\n</blockquote>\n\n<p>What's wrong, why different results ???</p>\n\n<p>Can somebody help me?</p>\n"}, {"tags": ["c#", "windows", "macos", "ms-word", "openxml-sdk"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1576169689, "post_id": 59293794, "comment_id": 104821021, "body": "But it works in Windows? What, more specifically, is in this content being &quot;appended&quot;? Without more information or a way to reproduce there&#39;s really not much anyone here can contribute."}, {"owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576187281, "post_id": 59293794, "comment_id": 104828207, "body": "@CindyMeister - thank you for answering, I appreciate it.  As a quick note, it is <i>not</i> reproducible on windows.  I&#39;m currently working on a console app on asp.net core 3 to reproduce the issue as a stand alone application away from proprietary work.  I will then try to see if I can get a generic document from the offending document (scrubbed) to use so that it can be reproducible on any mac.  If I achieve this, I will update my question."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576188106, "post_id": 59293794, "comment_id": 104828539, "body": "I&#39;d look closely at the content from the documents being added via altChunk - anything unusual (not &quot;plain text&quot;) they contain. Also, if there&#39;s a pattern in the version of Word (both OS as well as numeric version) where they&#39;re being created. I&#39;d suspect they may contain something not &quot;known&quot; to a Mac..."}, {"owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576188585, "post_id": 59293794, "comment_id": 104828704, "body": "There are pictures in the document.  When I created a new document with embedded pictures to test to see if this is the cause, I was not able to reproduce.  It may have something to do with the pictures but why?  They are viewable in the word doc on mac, the doc in mac looks fine, you just can&#39;t &quot;Save As&quot;."}, {"owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576188926, "post_id": 59293794, "comment_id": 104828828, "body": "Otherwise, there&#39;s nothing else I see as fishy.  Just text and bullet points."}, {"owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576195427, "post_id": 59293794, "comment_id": 104830443, "body": "I was able to successfully recreate the problem with a generic docx, all on mac, by using a simple jpg that I embedded.  I will update my answer."}, {"owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576196827, "post_id": 59293794, "comment_id": 104830791, "body": "@CindyMeister - I have updated my answer with a full working example.  If you or anyone need the original documents I used, I can see if I can setup a download place somewhere, but I think you can reproduce it with a jpg from apod."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576239067, "post_id": 59293794, "comment_id": 104844359, "body": "apod? or iPod? I would have an iPhone or iPad: any idea if those formats are also a problem?"}, {"owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576261007, "post_id": 59293794, "comment_id": 104855077, "body": "@CindyMeister - I mention &quot;apod&quot; as in &quot;Astronomical Picture of the Day&quot; as a resource to download an image from to embed in the appending word document.  I used these pictures in my testing and was able to reproduce so I mentioned it.  As far as iPhone or iPad, I don&#39;t have any issues there.  We don&#39;t use the phone for word docs so I&#39;m not sure what would be affected there.  This is primarily a concern on the MacOS for word using OpenXML as the server code to generate the document with."}], "answers": [{"tags": [], "owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "is_accepted": false, "score": 0, "last_activity_date": 1576480868, "creation_date": 1576480868, "answer_id": 59352112, "question_id": 59293794, "link": "https://stackoverflow.com/questions/59293794/document-cant-save-as-on-mac-after-appending-certain-documents-in-a-word-doc/59352112#59352112", "title": "Document can&#39;t &quot;Save As&quot; on mac after appending certain documents in a word doc via C#", "body": "<p>I found another solution that could help mitigate this problem but I think it's just a workaround.  I've posted this bug to OpenXML.  I'm not sure if it is in fact OpenXML's issue, seems it may be Word instead, but at least the issue is raised and noted somewhere.</p>\n\n<p>Otherwise I've resorted to finding this solution below.  Instead I have to go through each element and clone it and then append it to the source document. \n If there are images in the cloned element, I have to do some extra steps for the image to copy over to the new document.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private static void GenerateByCopying()\n{\n    using (var doc = WordprocessingDocument.Open(DestinationDoc, true))\n    using (var appendedDoc = WordprocessingDocument.Open(AppendedDoc, true))\n    {\n        var body = doc.MainDocumentPart.Document.Body;\n        var appendedBody = appendedDoc.MainDocumentPart.Document.Body;\n        AppendNecessaryText(body);\n\n        foreach (var part in appendedBody.Elements())\n        {\n            var clonedElement = part.CloneNode(true);\n            clonedElement.Descendants&lt;DocumentFormat.OpenXml.Drawing.Blip&gt;()\n                .ToList()\n                .ForEach(imageData =&gt;\n                {\n                    var newRelation = CopyImage(doc, imageData.Embed, appendedDoc);\n                    imageData.Embed = newRelation;\n\n                });\n            clonedElement.Descendants&lt;DocumentFormat.OpenXml.Vml.ImageData&gt;()\n                .ToList()\n                .ForEach(imageData =&gt;\n                {\n                    var newRelation = CopyImage(doc, imageData.RelationshipId, appendedDoc);\n                    imageData.RelationshipId = newRelation;\n                });\n            body.Append(clonedElement);\n        }\n\n        doc.MainDocumentPart.Document.Save();\n    }\n}\n\npublic static string CopyImage(WordprocessingDocument doc, string relId, WordprocessingDocument source)\n{\n    var p = source.MainDocumentPart.GetPartById(relId) as ImagePart;\n    var np = doc.MainDocumentPart.AddPart(p);\n    np.FeedData(p.GetStream());\n    return doc.MainDocumentPart.GetIdOfPart(np);\n}\n</code></pre>\n\n<p>Adjusting the console app run this method after <code>File.Copy()</code>, I'm indeed able to open the document with the image and save changes.</p>\n"}], "owner": {"reputation": 2477, "user_id": 521952, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/sREZ1.jpg?s=128&g=1", "display_name": "Paul Carlton", "link": "https://stackoverflow.com/users/521952/paul-carlton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576480868, "creation_date": 1576097086, "last_edit_date": 1576199122, "question_id": 59293794, "link": "https://stackoverflow.com/questions/59293794/document-cant-save-as-on-mac-after-appending-certain-documents-in-a-word-doc", "title": "Document can&#39;t &quot;Save As&quot; on mac after appending certain documents in a word doc via C#", "body": "<p>The behavior is as follows:  After downloading a document that is dynamically created on the server and then opening that document up on a Mac, the document will not \"Save As\".  It fails silently, setting the document name to the previous name, and no document in the save destination folder.</p>\n\n<p>Under the hood: The code creates the document and appends text and then at the end of that file it appends word documents that are uploaded by another person for that created document.  The code is using the <code>AltChunk</code> class as outlined in the MSDN documents <a href=\"https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.wordprocessing.altchunk?redirectedfrom=MSDN&amp;view=openxml-2.8.1\" rel=\"nofollow noreferrer\">here</a>.  This works well and there aren't much issues except, intermittently, with certain attachments as described above.</p>\n\n<p>This APPEARS to be a bug with word and I'm not sure if there's anything on my part that can be done until this bug is patched in word or in OpenXML.</p>\n\n<h1>Code to Reproduce Below</h1>\n\n<p>The following below are the steps needed to reproduce this bug:</p>\n\n<ol>\n<li>Create a new Console App in Visual Studio on Mac</li>\n<li>Add a folder to the top level called \"Docs\"</li>\n<li>Download the Nuget dependency <code>DocumentFormat.OpenXml</code></li>\n<li>Create a new word doc named \"test-source.docx\"\n\n<ol>\n<li>Put some test text in there, doesn't matter what</li>\n<li>Add the document to the solution in \"Docs\" folder</li>\n<li>Change the property to \"Copy always\"</li>\n</ol></li>\n<li><p>Create a new word doc named \"test-append.docx\" (the embedded word doc)</p>\n\n<ol>\n<li>Put in some test text at the top</li>\n<li>Copy over a jpg of your choice.  The image type I used to reproduce is a jpg.  I fetched mine from <a href=\"http://apod.nasa.gov/apod/\" rel=\"nofollow noreferrer\">http://apod.nasa.gov/apod/</a> , one of their big pics should do it.</li>\n<li>Add to the \"Docs\" folder in the solution</li>\n<li>Change property of document to \"Copy always\"</li>\n</ol></li>\n<li><p>Copy paste the code below into your <code>Program.cs</code> file:</p></li>\n</ol>\n\n<pre><code>using System.IO;\nusing System.Linq;\nusing DocumentFormat.OpenXml.Packaging;\nusing DocumentFormat.OpenXml.Wordprocessing;\nusing Text = DocumentFormat.OpenXml.Wordprocessing.Text;\n\nnamespace TestWordAppend\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            var destinationDoc = \"Docs/test-destination.docx\";\n            var sourceDoc = \"Docs/test-source.docx\";\n            var appendedDoc = \"Docs/test-append2.docx\";\n\n            File.Delete(destinationDoc);\n            File.Copy(sourceDoc, destinationDoc);\n\n            using (var doc = WordprocessingDocument.Open(destinationDoc, true))\n            {\n                var body = doc.MainDocumentPart.Document.Body;\n\n                var p2 = body.InsertAfter(\n                    new Paragraph(\n                        new ParagraphProperties(\n                            new PageBreakBefore()\n                    )),\n                    body.Elements&lt;Paragraph&gt;().Last()\n                );\n\n\n                var altChunkId = \"AltChunkId\";\n                var chunk = doc.MainDocumentPart.AddAlternativeFormatImportPart(\n                    AlternativeFormatImportPartType.WordprocessingML,\n                    altChunkId);\n\n                using (var fs = File.Open(appendedDoc, FileMode.Open))\n                    chunk.FeedData(fs);\n\n                var altChunk = new AltChunk { Id = altChunkId };\n                var run = new Run(new TabChar(), new Text(appendedDoc), new Break());\n                run.PrependChild(new RunProperties { RunStyle = new RunStyle { Val = \"Bold\" } });\n                var fileP = p2.InsertAfterSelf(new Paragraph());\n                fileP.Append(run);\n                run = new Run(new TabChar(), new Text(\"Uploaded by: \"), new TabChar(), new Text(\"Test User\"));\n                run.PrependChild(new RunProperties { RunStyle = new RunStyle { Val = \"Italic\" } });\n                fileP.Append(run);\n\n                body.Append(altChunk);\n                doc.MainDocumentPart.Document.Save();\n            }\n        }\n    }\n}\n</code></pre>\n\n<ol>\n<li>Run it</li>\n<li>Check the document in <code>~/bin/Debug/netcoreapp.3.0/Docs/test-destination.docx</code> where <code>~</code> is the base path the solution is located.</li>\n<li>Open it up and try and do a \"Save As\" in your <code>~/Documents</code> folder where <code>~</code> is your user's home path.</li>\n<li>It should not save, in fact it should revert back to the name \"test-destination.docx\".  When you check your documents folder, you will not see a new document there.</li>\n</ol>\n"}, {"tags": ["c#", "arrays", ".net", "list", "entity-framework"], "comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 2, "creation_date": 1576097114, "post_id": 59293784, "comment_id": 104792220, "body": "Hello and welcome to SO! Can you please update your post to include what you have tried, what isn&#39;t working and expected output for us to help you? Also please post the definition of <code>TimeOutJustification</code>."}, {"owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 2, "creation_date": 1576097291, "post_id": 59293784, "comment_id": 104792282, "body": "<code>list.Add(new TimeOutJustification {Card=&quot;1234&quot;,Date=&quot;12-03-19&quot;});</code>"}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "reply_to_user": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576097323, "post_id": 59293784, "comment_id": 104792302, "body": "@AshkanMobayenKhiabani maybe, from the post above it&#39;s <code>null</code>, that code will throw up..."}, {"owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576097381, "post_id": 59293784, "comment_id": 104792331, "body": "that&#39;s why i added as comment. OP is not talking about errors, but how to do it."}], "answers": [{"tags": [], "owner": {"reputation": 460, "user_id": 12477070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d36f204dd409830f00f1299cce1522?s=128&d=identicon&r=PG&f=1", "display_name": "jasonmchoe", "link": "https://stackoverflow.com/users/12477070/jasonmchoe"}, "is_accepted": true, "score": 2, "last_activity_date": 1576114227, "creation_date": 1576114227, "answer_id": 59296455, "question_id": 59293784, "link": "https://stackoverflow.com/questions/59293784/how-to-insert-values-to-a-list-collection/59296455#59296455", "title": "How to insert values to a list collection", "body": "<p>It's not super clear to me what the scenario is here, but I am going to assume that the list <code>TimeOutArray</code> may or may not have been initialized, and may or may not have items. It sounds like you want to check for those things, and, if it does not have items, add one. </p>\n\n<p>First, initialize the list if it is null:</p>\n\n<pre><code>if (TimeOutArray == null)\n{\n    TimeOutArray = new List&lt;TimeOutJustification&gt;();\n}\n</code></pre>\n\n<p>Then, check if the item count is 0, and add the new item.</p>\n\n<pre><code>if (TimeOutArray.Count == 0)\n{\n    TimeOutArray.Add(new TimeOutJustification\n    {\n        Card = \"1234\",\n        Date = \"12-03-19\"\n    });\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12518777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDse-kSF27FwP8f5Roob8Ke9-kDa5ukirU_DYyu=k-s128", "display_name": "Sam", "link": "https://stackoverflow.com/users/12518777/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 59296455, "answer_count": 1, "score": -1, "last_activity_date": 1576114227, "creation_date": 1576097056, "last_edit_date": 1576097365, "question_id": 59293784, "link": "https://stackoverflow.com/questions/59293784/how-to-insert-values-to-a-list-collection", "title": "How to insert values to a list collection", "body": "<p>I need to insert elements into my empty list collection as one array item that contains Card and Date.</p>\n\n<p>TimeOut Justification is my entity class that contains parameters like Card and Date</p>\n\n<p>I'm checking if TimeOutArray is 0, then i need to insert Card and Date.</p>\n\n<pre><code>List&lt;TimeOutJustification&gt;TimeOutArray;\n</code></pre>\n\n<p>Result should look like this</p>\n\n<pre><code>[0] = {Card=\"1234\",Date=\"12-03-19\"};\n</code></pre>\n"}, {"tags": ["c#", "azure", "x509certificate", ".net-core-3.0"], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 6501426, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zPaGv.jpg?s=128&g=1", "display_name": "GregN", "link": "https://stackoverflow.com/users/6501426/gregn"}, "is_accepted": false, "score": 1, "last_activity_date": 1576520662, "creation_date": 1576520662, "answer_id": 59362308, "question_id": 59293609, "link": "https://stackoverflow.com/questions/59293609/azure-iot-hub-unauthorized-access-for-additional-devices/59362308#59362308", "title": "Azure IoT Hub Unauthorized Access for Additional Devices", "body": "<p>I figured out the issue.  When the certificate was generated in the store, I was using FindByIssuerName to locate the certificate. </p>\n\n<pre><code>X509Certificate2Collection signerCollection = (X509Certificate2Collection)caStore.Certificates.Find(X509FindType.FindByIssuerName, \"CERTNAME\", true);\n</code></pre>\n\n<p>After investigating further, there were TWO certificates with the exact same name in the store. The issue: MMC snap-in was only showing one certificate.  After looking around, it was suggested somewhere to run a storerepair command on the store.  After running the store repair command, I could then see both certificates in MMC and was able to remove the offending certificate preventing the valid one from being detected.  </p>\n\n<p>Windows Version: Windows Embedded 8.1 Industry Pro</p>\n"}], "owner": {"reputation": 132, "user_id": 6501426, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zPaGv.jpg?s=128&g=1", "display_name": "GregN", "link": "https://stackoverflow.com/users/6501426/gregn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1576520662, "creation_date": 1576096186, "last_edit_date": 1576515378, "question_id": 59293609, "link": "https://stackoverflow.com/questions/59293609/azure-iot-hub-unauthorized-access-for-additional-devices", "title": "Azure IoT Hub Unauthorized Access for Additional Devices", "body": "<p>I have an issue attempting to register a second device through DPS to an IoT Hub using x509 certificates.  My root certificate authority is present and validated on both the DPS and IoT Hub (generated through openssl).  As for the client side certificate, I'm generating it once the application starts (if to doesn't already exist) in the below code.  What's bothering me is every single device gets enrolled into Azure DPS correctly but only the FIRST device gets authorized and registered.  Is it possibly something I'm doing during my client side certificate creation that is messing it up? Also the error is found in this line during device registration to the IoT Hub:</p>\n\n<pre><code>DeviceRegistrationResult result = await provisioningDeviceClient.RegisterAsync().ConfigureAwait(false);\n</code></pre>\n\n<p>Added error:</p>\n\n<p>2019/12/16 09:37:38.309|ERROR| Error found attempting to start service The device failed to register @ the IoT Hub : The device failes to provision correctly: AMQP transport exception | Tidel.DeviceAgent.DeviceAgent | </p>\n\n<p><strong>CLIENT SIDE CERTIFICATE GENERATION</strong></p>\n\n<pre><code>        X509Certificate2 caRootCertificate;\n        X509Store caStore = new X509Store(StoreName.Root, StoreLocation.LocalMachine);\n        caStore.Open(OpenFlags.ReadOnly | OpenFlags.OpenExistingOnly);\n\n        X509Certificate2Collection signerCollection = (X509Certificate2Collection)caStore.Certificates.Find(X509FindType.FindByIssuerName, \"CERTNAME\", true);\n\n        caStore.Close();\n\n        if (signerCollection.Count != 0)\n        {\n            caRootCertificate = signerCollection[0];\n\n            using (var rsa = RSA.Create())\n            {\n                rsa.KeySize = 2048;\n\n                var clientCertificateRequest = new CertificateRequest($\"CN={_writableOptions.Value.RegistrationId}\", rsa, HashAlgorithmName.SHA256, RSASignaturePadding.Pkcs1);\n\n                clientCertificateRequest.CertificateExtensions.Add(new X509BasicConstraintsExtension(false, false, 0, false));\n\n                var issuerSubjectKey = caRootCertificate.Extensions[\"Subject Key Identifier\"].RawData;\n                var segment = new ArraySegment&lt;byte&gt;(issuerSubjectKey, 2, issuerSubjectKey.Length - 2);\n                var authorityKeyIdentifier = new byte[segment.Count + 4];\n\n                authorityKeyIdentifier[0] = 0x30;\n                authorityKeyIdentifier[1] = 0x16;\n                authorityKeyIdentifier[2] = 0x80;\n                authorityKeyIdentifier[3] = 0x14; \n                segment.CopyTo(authorityKeyIdentifier, 4);\n                clientCertificateRequest.CertificateExtensions.Add(new X509Extension(\"2.5.29.35\", authorityKeyIdentifier, false));\n\n\n                var sanBuilder = new SubjectAlternativeNameBuilder();\n                sanBuilder.AddDnsName(_writableOptions.Value.RegistrationId);\n                var sanExtension = sanBuilder.Build();\n                clientCertificateRequest.CertificateExtensions.Add(sanExtension);\n\n                clientCertificateRequest.CertificateExtensions.Add(new X509EnhancedKeyUsageExtension(new OidCollection { new Oid(\"1.3.6.1.5.5.7.3.2\") }, false));\n                clientCertificateRequest.CertificateExtensions.Add(new X509SubjectKeyIdentifierExtension(clientCertificateRequest.PublicKey, false));\n\n                var notBefore = DateTimeOffset.UtcNow.AddDays(-1);\n\n                if (notBefore &lt; caRootCertificate.NotBefore)\n                {\n                    notBefore = new DateTimeOffset(caRootCertificate.NotBefore);\n                }\n\n                var notAfter = DateTimeOffset.UtcNow.AddDays(365);\n\n                if (notAfter &gt; caRootCertificate.NotAfter)\n                {\n                    notAfter = new DateTimeOffset(caRootCertificate.NotAfter);\n                }\n\n                var epoch = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc);\n                var unixTime = Convert.ToInt64((DateTime.UtcNow - epoch).TotalSeconds);\n                var serial = BitConverter.GetBytes(unixTime);\n\n                using (var cert = clientCertificateRequest.Create(caRootCertificate, notBefore, notAfter, serial))\n                {\n                    X509Certificate2 client = cert.CopyWithPrivateKey(rsa);\n\n                    return await Task.FromResult(client);\n                }\n            }\n        }\n        else\n        {\n            throw new FileNotFoundException($\"Could not find a root certificate.\");\n        }\n</code></pre>\n\n<p><strong>DEVICE ENROLLMENT TO DPS</strong></p>\n\n<pre><code>    Attestation attestation = X509Attestation.CreateFromClientCertificates(new X509Certificate2(certificate.Export(X509ContentType.Cert)));\n\n    IndividualEnrollment individualEnrollment = new IndividualEnrollment(_writableOptions.Value.RegistrationId, attestation)\n    {\n        DeviceId = _writableOptions.Value.DeviceId,\n        ProvisioningStatus = ProvisioningStatus.Enabled\n    };\n\n    individualEnrollmentResult = await _provisioningServiceClient.CreateOrUpdateIndividualEnrollmentAsync(individualEnrollment).ConfigureAwait(false);\n</code></pre>\n\n<p><strong>DEVICE REGISTRATION TO IOT HUB</strong></p>\n\n<pre><code>using (var certificatePassword = new X509Certificate2(certificate.GetRawCertData(), _writableOptions.Value.CertPass))\n{\n    using (var security = new SecurityProviderX509Certificate(certificatePassword))\n    {\n        using (var transport = new ProvisioningTransportHandlerAmqp(TransportFallbackType.TcpOnly))\n        {\n            ProvisioningDeviceClient provisioningDeviceClient = ProvisioningDeviceClient.Create(_writableOptions.Value.AzureEndpoint, _writableOptions.Value.IdScope, security, transport);\n            DeviceRegistrationResult result = await provisioningDeviceClient.RegisterAsync().ConfigureAwait(false);\n            IAuthenticationMethod authenticationMethod = new DeviceAuthenticationWithX509Certificate(result.DeviceId, certificate);\n            DeviceClient deviceClient = DeviceClient.Create(result.AssignedHub, authenticationMethod, TransportType.Amqp_Tcp_Only);\n\n            return await Task.FromResult(deviceClient);\n       }\n     }\n}\n</code></pre>\n"}, {"tags": ["c#", "parsing"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1576096703, "post_id": 59293605, "comment_id": 104792061, "body": "What is the actual value of <code>items[3]</code> PRIOR to <code>acceptTime</code> attempting to ParseExact?  Use a breakpoint right before.  I suspect that you&#39;re not seeing the full string of numbers in <code>items[3]</code> and instead pulling the exponent notation.  Ashkan&#39;s answer below also seems to suggest this - but you validating this case would provide an exact answer."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9352418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6412614c74b16a37787c7a69777dfb94?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hussain", "link": "https://stackoverflow.com/users/9352418/mohammad-hussain"}, "edited": false, "score": 0, "creation_date": 1576097094, "post_id": 59293687, "comment_id": 104792208, "body": "Hi Michael, thanks for you response.  I agree with what you have said.  I think the data provider has now changed the format of the cell into number and it longer is a string.  How would I overcome this? to pass into my function and convert into date time to get the desire out put per what you have shown above."}], "tags": [], "owner": {"reputation": 366, "user_id": 2942725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c6JFl.png?s=128&g=1", "display_name": "Michael Di Felice", "link": "https://stackoverflow.com/users/2942725/michael-di-felice"}, "is_accepted": false, "score": 0, "last_activity_date": 1576096562, "creation_date": 1576096562, "answer_id": 59293687, "question_id": 59293605, "link": "https://stackoverflow.com/questions/59293605/datetime-parsing-in-cgetting-a-system-formatexception-string-was-not-recogn/59293687#59293687", "title": "DateTime parsing in c#:getting a &#39;System.FormatException: &#39;String was not recognized as a valid DateTime&#39; error", "body": "<p>The following works in .NET fiddle (<a href=\"https://dotnetfiddle.net/\" rel=\"nofollow noreferrer\">https://dotnetfiddle.net/</a>), can you verify the string that is being used in the call to <code>DateTime.ParseExact</code>? Perhaps the string is not equal to what you would expect at runtime.</p>\n\n<pre><code>using System;\n\npublic class Program\n{\n    public static void Main()\n    {\n        Console.WriteLine(DateTime.ParseExact(\"20191211202600\", \"yyyyMMddHHmmss\", null));\n    }\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>12/11/2019 8:26:00 PM\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 9352418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6412614c74b16a37787c7a69777dfb94?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hussain", "link": "https://stackoverflow.com/users/9352418/mohammad-hussain"}, "edited": false, "score": 0, "creation_date": 1576096916, "post_id": 59293709, "comment_id": 104792151, "body": "The data set is coming from a WebAPI and my initial code is just downloading the .csv files and saving them  On the code could I parse the new format into datetime, and how would i do this?"}, {"owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "reply_to_user": {"reputation": 77, "user_id": 9352418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6412614c74b16a37787c7a69777dfb94?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hussain", "link": "https://stackoverflow.com/users/9352418/mohammad-hussain"}, "edited": false, "score": 0, "creation_date": 1576097170, "post_id": 59293709, "comment_id": 104792246, "body": "@MohammadHussain can you confirm this by manually downloading csv file and opening it via notepad (not excel)?"}, {"owner": {"reputation": 77, "user_id": 9352418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6412614c74b16a37787c7a69777dfb94?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hussain", "link": "https://stackoverflow.com/users/9352418/mohammad-hussain"}, "edited": false, "score": 0, "creation_date": 1576097512, "post_id": 59293709, "comment_id": 104792390, "body": "I have provited a screenshot of the data when opened in a Notepad, to me it still looks like a string and not a number, then why would this issue arise all of a sudden?"}, {"owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "reply_to_user": {"reputation": 77, "user_id": 9352418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6412614c74b16a37787c7a69777dfb94?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hussain", "link": "https://stackoverflow.com/users/9352418/mohammad-hussain"}, "edited": false, "score": 0, "creation_date": 1576097749, "post_id": 59293709, "comment_id": 104792488, "body": "ok, as you see, they are correct in the csv files (when opened as text) however if after download you are opening them with excel (and maybe edit save) causes the problem. and also make sure that the class you are mapping the csv files to, has string data type for those columns."}, {"owner": {"reputation": 77, "user_id": 9352418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6412614c74b16a37787c7a69777dfb94?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hussain", "link": "https://stackoverflow.com/users/9352418/mohammad-hussain"}, "reply_to_user": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "edited": false, "score": 0, "creation_date": 1576099925, "post_id": 59293709, "comment_id": 104793363, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/204085/discussion-between-mohammad-hussain-and-ashkan-mobayen-khiabani\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 30566, "user_id": 1079221, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/wFi75.jpg?s=128&g=1", "display_name": "Ashkan Mobayen Khiabani", "link": "https://stackoverflow.com/users/1079221/ashkan-mobayen-khiabani"}, "is_accepted": false, "score": 2, "last_activity_date": 1576099245, "last_edit_date": 1576099245, "creation_date": 1576096648, "answer_id": 59293709, "question_id": 59293605, "link": "https://stackoverflow.com/questions/59293605/datetime-parsing-in-cgetting-a-system-formatexception-string-was-not-recogn/59293709#59293709", "title": "DateTime parsing in c#:getting a &#39;System.FormatException: &#39;String was not recognized as a valid DateTime&#39; error", "body": "<p>I don't think the problem is with your C# code, the columns which contain date format <code>yyyymmddhhmmss</code> should be of type string, where they are now treated as a number. This problem arises from the program you are saving the CSV file (for example excel or google spreadsheets) you need to change the column data type to string (as it is now automatically detected as a number).</p>\n"}], "owner": {"reputation": 77, "user_id": 9352418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6412614c74b16a37787c7a69777dfb94?s=128&d=identicon&r=PG&f=1", "display_name": "Mohammad Hussain", "link": "https://stackoverflow.com/users/9352418/mohammad-hussain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1576099245, "creation_date": 1576096168, "last_edit_date": 1576098649, "question_id": 59293605, "link": "https://stackoverflow.com/questions/59293605/datetime-parsing-in-cgetting-a-system-formatexception-string-was-not-recogn", "title": "DateTime parsing in c#:getting a &#39;System.FormatException: &#39;String was not recognized as a valid DateTime&#39; error", "body": "<p>I have a dataset in a .csv file in a local folder, below is a sample row of the data, it has 13 attributes to each item.</p>\n\n<p>I am parsing this data in C#, my code has been working for 2 years and I cannot remember </p>\n\n<p>The code reading the .csv file is, this section is parsing the data into compiledList.</p>\n\n<pre><code>static string loadFile(string fileLocation)\n    {\n        string text = \"\";\n\n        try\n        {\n            text = File.ReadAllText(fileLocation);\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine(\"An error has occured...\");\n            Console.WriteLine(e.Message);\n        }\n\n        return text;\n    }\n    static ConcurrentBag&lt;Item&gt; interpretFile(string text, ConcurrentBag&lt;Item&gt; compiledList)\n    {\n        String[] substrings = text.Split('\\n');\n        int settlementPeriod = -1;   int totalSP = -1;\n\n        foreach (string line in substrings)\n        {\n            String[] items = line.Split(',');\n            if (items[0] == \"HDR\")\n            {\n                settlementPeriod = int.Parse(items[3]);\n                if (settlementPeriod &gt; 48)\n                    settlementPeriod -= 48;\n                if (settlementPeriod &lt; 0)\n                    settlementPeriod += 48;\n\n                totalSP = getTotalSettlementPeriod(DateTime.ParseExact(items[2], \"yyyyMMdd\", null), settlementPeriod);\n            }\n            if (items[0] == \"BOALF\")\n            {\n                //Item Bid = new Item(items);\n                Item Bid = new Item\n                {\n                    recordType = items[0],\n                    unitID = items[1],\n                    acceptID = float.Parse(items[2]),\n                    acceptTime = DateTime.ParseExact(items[3], \"yyyyMMddHHmmss\", null),\n                    deemedFlag = ToBoolean(items[4]),\n                    soFlag = ToBoolean(items[5]),\n                    storFlag = ToBoolean(items[6]),\n                    fromTime = DateTime.ParseExact(items[7], \"yyyyMMddHHmmss\", null),\n                    fromLevel = float.Parse(items[8]),\n                    toTime = DateTime.ParseExact(items[9], \"yyyyMMddHHmmss\", null),\n                    toLevel = float.Parse(items[10]),\n                    settlementPeriod = settlementPeriod,\n                    totalSP = totalSP\n                };\n                compiledList.Add(Bid);\n</code></pre>\n\n<p>Sample item from the .csv is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EHye7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EHye7.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I open the data set in Notebad below is what i see:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rQ6Xh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rQ6Xh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note that <code>items[0]</code> is the first colum from the about sample data set.  there the data which I am now having issues with is column 4 which is '2.02E+13' shown above.</p>\n\n<p>What that actually is '20191211202600'  which is the 'yyyymmddhhmmss' in number format.  I do not know what has changed such that the below is giving me an error.</p>\n\n<pre><code>acceptTime = DateTime.ParseExact(items[3], \"yyyyMMddHHmmss\", null)\n</code></pre>\n\n<p>`</p>\n\n<p>The error that I am getting is:</p>\n\n<blockquote>\n  <p>System.FormatException: 'String was not recognized as a valid\n  DateTime.'</p>\n</blockquote>\n\n<p>I would appreciate your assistance and let me know if further clarification is required.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "sql", "sql-server", "tsql"], "comments": [{"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 1, "creation_date": 1576096677, "post_id": 59293590, "comment_id": 104792052, "body": "That is because es-ES does not use <code>.</code> to signify the start of decimal places -- a string not formatted in that culture will not parse correctly.  I actually don&#39;t see es-ES but es is Spanish you can see below"}, {"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 0, "creation_date": 1576096778, "post_id": 59293590, "comment_id": 104792093, "body": "<a href=\"https://docs.oracle.com/cd/E19455-01/806-0169/overview-9/index.html\" rel=\"nofollow noreferrer\">docs.oracle.com/cd/E19455-01/806-0169/overview-9/index.html</a>"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576097105, "post_id": 59293590, "comment_id": 104792214, "body": "There are many posts about conversion of string to decimal with commas."}, {"owner": {"reputation": 19060, "user_id": 4003419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lIeUm.png?s=128&g=1", "display_name": "LukStorms", "link": "https://stackoverflow.com/users/4003419/lukstorms"}, "edited": false, "score": 0, "creation_date": 1576097441, "post_id": 59293590, "comment_id": 104792360, "body": "if you know the culture used in the file that user uses, then use that culture. The TRY_PARSE function is to check if the string data can be parsed, not to decide what culture is used."}, {"owner": {"reputation": 19060, "user_id": 4003419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lIeUm.png?s=128&g=1", "display_name": "LukStorms", "link": "https://stackoverflow.com/users/4003419/lukstorms"}, "edited": false, "score": 2, "creation_date": 1576099556, "post_id": 59293590, "comment_id": 104793222, "body": "Btw, the en-us parse fails on the comma. So you could switch them in the case. <code>CASE WHEN TRY_PARSE(amount AS decimal(12,2) using &#39;en-US&#39;) IS NOT NULL THEN PARSE(amount AS decimal(12,2) using &#39;en-US&#39;) ELSE ISNULL(TRY_PARSE(amount AS decimal(12,2) using &#39;es-ES&#39;), 0) END</code>."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1576167364, "post_id": 59293590, "comment_id": 104819790, "body": "Note that while you <i>can</i> now solve problems like these on the SQL end courtesy of <code>TRY_PARSE</code> and friends, that definitely does not mean you <i>should</i>. Focus all effort on solving this on the client end by making sure you have determined the correct format (either from the machine&#39;s regional settings or by <i>asking</i> the user) and sending it over to SQL Server as one unambiguous, typed value. Anything else is setting yourself up for failure, as these values can be completely ambiguous -- is <code>1.234</code> one thousand two hundred thirty-four or one plus two hundred thirty-four thousandths?"}, {"owner": {"reputation": 96, "user_id": 9381439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d8tnW.jpg?s=128&g=1", "display_name": "Nahuel Gonzalez", "link": "https://stackoverflow.com/users/9381439/nahuel-gonzalez"}, "reply_to_user": {"reputation": 19060, "user_id": 4003419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lIeUm.png?s=128&g=1", "display_name": "LukStorms", "link": "https://stackoverflow.com/users/4003419/lukstorms"}, "edited": false, "score": 0, "creation_date": 1576188418, "post_id": 59293590, "comment_id": 104828649, "body": "@LukStorms Yes i know the culture of the pc but i dont know in wich culture are the amount columns of each file. What I expected when using TRY_PARSE function was that if I could not convert the amount with the current culture, then use the opposite culture. But the problem is that it can covert it.."}, {"owner": {"reputation": 96, "user_id": 9381439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d8tnW.jpg?s=128&g=1", "display_name": "Nahuel Gonzalez", "link": "https://stackoverflow.com/users/9381439/nahuel-gonzalez"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1576188653, "post_id": 59293590, "comment_id": 104828733, "body": "@JeroenMostert Thanks for the help, yes I think i will try to solve this at the client side before sending the data to the server and forze both files to have the amounts in the same culture. 1.234 is one thousand two hundred thirty-four in spanish."}], "owner": {"reputation": 96, "user_id": 9381439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d8tnW.jpg?s=128&g=1", "display_name": "Nahuel Gonzalez", "link": "https://stackoverflow.com/users/9381439/nahuel-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576161321, "creation_date": 1576096125, "last_edit_date": 1576161321, "question_id": 59293590, "link": "https://stackoverflow.com/questions/59293590/issue-converting-string-to-decimal-with-different-cultures-in-sql", "title": "Issue converting string to decimal with different cultures in SQL", "body": "<p>I am developing an application where users may use files with amounts in invariant culture and at the same time other cultures (es-ES). The goal is to look for the same amount in the other grid.</p>\n\n<p>I have this code where I try to convert the string with current culture and if not use the opposite culture.</p>\n\n<p>(Amounts is a decimal column) \n(c01 is a nvarchar column)</p>\n\n<pre><code>update UserRecords set Amounts = CASE WHEN TRY_PARSE(c01 AS decimal(12,2) using 'es-ES') IS NOT NULL \nTHEN TRY_PARSE(c01 AS decimal(12,2) using 'es-ES') \nWHEN TRY_PARSE(c01 AS decimal(12,2) using 'en-US') IS NOT NULL \nTHEN TRY_PARSE(c01 AS decimal(12,2) using 'en-US')\nELSE 0 END\n</code></pre>\n\n<p>The problem is that for example value 200.14 (using es-ES) it converts to 20014.00 and it's not the behaviour I expect. </p>\n\n<p>Do I need to replace the decimal point?</p>\n"}, {"tags": ["c#", ".net", "generics", "dynamic", "interface"], "comments": [{"owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "edited": false, "score": 0, "creation_date": 1576096371, "post_id": 59293257, "comment_id": 104791917, "body": "You can try to find a type, which inherits <code>Extractor&lt;Unchangeable&gt;</code> for example and create its instance (since it isn&#39;t abstract one)"}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1576097332, "post_id": 59293257, "comment_id": 104792308, "body": "mark concrete extractor with some custom attribute like <code>[Extractor(typeof(ExtractedType))]</code> then find all types with such attribute and build dictionary ..."}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1576100079, "post_id": 59293257, "comment_id": 104793425, "body": "<a href=\"https://dotnetfiddle.net/6qlpqJ\" rel=\"nofollow noreferrer\">dotnetfiddle.net/6qlpqJ</a>"}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1576106186, "post_id": 59293257, "comment_id": 104795400, "body": "<a href=\"https://dotnetfiddle.net/LnJ6E5\" rel=\"nofollow noreferrer\">or with MEF(unfortunately not working in dotnetfiddle)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 5120311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ex7cI7X1RqA/AAAAAAAAAAI/AAAAAAAAEp4/wIkQgXRBnz4/photo.jpg?sz=128", "display_name": "Neils Schoenfelder", "link": "https://stackoverflow.com/users/5120311/neils-schoenfelder"}, "edited": false, "score": 0, "creation_date": 1576167668, "post_id": 59294078, "comment_id": 104819974, "body": "Outstanding in its clarity and simplicity!  Thanks you!"}], "tags": [], "owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "is_accepted": false, "score": 1, "last_activity_date": 1586872157, "last_edit_date": 1586872157, "creation_date": 1576098396, "answer_id": 59294078, "question_id": 59293257, "link": "https://stackoverflow.com/questions/59293257/constraining-generic-types-by-extrinsic-functionality/59294078#59294078", "title": "Constraining generic types by extrinsic functionality", "body": "<p>The following snippet will create the concrete instance of <code>Extractor&lt;T&gt;</code> class and dynamically invokes a method of this instance</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var test = new Unchangeable();\nvar baseType = typeof(Extractor&lt;&gt;).MakeGenericType(test.GetType());\nvar extractorType = Assembly.GetExecutingAssembly()\n    .GetTypes().FirstOrDefault(t =&gt; t.IsClass &amp;&amp; !t.IsAbstract &amp;&amp; t.IsSubclassOf(baseType));\nif (extractorType != null)\n{\n    dynamic extractor = Activator.CreateInstance(extractorType);\n    string result = extractor?.ExtractionTwo(test);\n}\n</code></pre>\n\n<p>Of course, it's simplified, you can pass a specific instance of <code>Unchangeable</code> or <code>Untouchable</code> class and restrict assembly types scanning (and get all types only once). </p>\n\n<p>The disadvantage here is that you have to pay attention to <code>ExtractionOne</code> and <code>ExtractionTwo</code> signatures, since they are invoked on dynamic object</p>\n\n<blockquote>\n  <p>The core issue with this approach is that it's unfortunately looking\n  for a class of the form <code>Extractor&lt;&gt;</code> instead of an interface of the\n  form <code>IExtractor&lt;&gt;</code>.</p>\n</blockquote>\n\n<p>This snippet can help you to look through types using <code>IExtrator&lt;&gt;</code> interface</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var baseType = typeof(IExtractor&lt;&gt;).MakeGenericType(typeof(Unchangeable));\nvar extractorType = Assembly.GetExecutingAssembly()\n    .GetTypes().FirstOrDefault(t =&gt; t.IsClass &amp;&amp; !t.IsAbstract &amp;&amp; baseType.IsAssignableFrom(t));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 5120311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ex7cI7X1RqA/AAAAAAAAAAI/AAAAAAAAEp4/wIkQgXRBnz4/photo.jpg?sz=128", "display_name": "Neils Schoenfelder", "link": "https://stackoverflow.com/users/5120311/neils-schoenfelder"}, "edited": false, "score": 0, "creation_date": 1576167714, "post_id": 59294981, "comment_id": 104820004, "body": "Outstandingly thorough and robust!  Thank you!"}], "tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": true, "score": 1, "last_activity_date": 1576106006, "last_edit_date": 1576106006, "creation_date": 1576102782, "answer_id": 59294981, "question_id": 59293257, "link": "https://stackoverflow.com/questions/59293257/constraining-generic-types-by-extrinsic-functionality/59294981#59294981", "title": "Constraining generic types by extrinsic functionality", "body": "<p>Combining some code from StackOverflow and my own testing, I suggest using Reflection to find all types implementing an interface:</p>\n\n<pre><code>public static class TypeExt {\n    public static bool IsBuiltin(this Type aType) =&gt; new[] { \"/dotnet/shared/microsoft\", \"/windows/microsoft.net\" }.Any(p =&gt; aType.Assembly.CodeBase.ToLowerInvariant().Contains(p));\n    public static IEnumerable&lt;Type&gt; ImplementingTypes(this Type interfaceType, bool includeAbstractClasses = false, bool includeStructs = false, bool includeSystemTypes = false, bool includeInterfaces = false) =&gt;\n        AppDomain.CurrentDomain.GetAssemblies()\n                               .SelectMany(a =&gt; a.GetLoadableTypes())\n                               .Distinct()\n                               .Where(aType =&gt; (includeAbstractClasses || !aType.IsAbstract) &amp;&amp;\n                                               (includeInterfaces ? aType != interfaceType : !aType.IsInterface) &amp;&amp;\n                                               (includeStructs || !aType.IsValueType) &amp;&amp;\n                                               (includeSystemTypes || !aType.IsBuiltin()) &amp;&amp;\n                                               interfaceType.IsAssignableFrom(aType) &amp;&amp;\n                                               aType.GetInterfaces().Contains(interfaceType));\n}\n\npublic static class AssemblyExt {\n    //https://stackoverflow.com/a/29379834/2557128\n    public static IEnumerable&lt;Type&gt; GetLoadableTypes(this Assembly assembly) {\n        if (assembly == null)\n            throw new ArgumentNullException(\"assembly\");\n        try {\n            return assembly.GetTypes();\n        } catch (ReflectionTypeLoadException e) {\n            return e.Types.Where(t =&gt; t != null);\n        }\n    }\n\n}\n</code></pre>\n\n<p>Reflection can be quite slow, and in my testing, getting all loaded types was the slowest part, so I added caching of the loaded types and the implementing types, but this does mean you will need to refresh the loaded types if you dynamically load assemblies:</p>\n\n<pre><code>public static class TypeExt {\n    public static bool IsBuiltin(this Type aType) =&gt; new[] { \"/dotnet/shared/microsoft\", \"/windows/microsoft.net\" }.Any(p =&gt; aType.Assembly.CodeBase.ToLowerInvariant().Contains(p));\n\n    static Dictionary&lt;Type, HashSet&lt;Type&gt;&gt; FoundTypes = null;\n    static List&lt;Type&gt; LoadableTypes = null;\n\n    public static void RefreshLoadableTypes() {\n        LoadableTypes = AppDomain.CurrentDomain.GetAssemblies().SelectMany(a =&gt; a.GetLoadableTypes()).ToList();\n        FoundTypes = new Dictionary&lt;Type, HashSet&lt;Type&gt;&gt;();\n    }\n\n    public static IEnumerable&lt;Type&gt; ImplementingTypes(this Type interfaceType, bool includeAbstractClasses = false, bool includeStructs = false, bool includeSystemTypes = false, bool includeInterfaces = false) {\n        if (FoundTypes != null &amp;&amp; FoundTypes.TryGetValue(interfaceType, out var ft))\n            return ft;\n        else {\n            if (LoadableTypes == null)\n                RefreshLoadableTypes();\n\n            var ans = LoadableTypes\n                       .Where(aType =&gt; (includeAbstractClasses || !aType.IsAbstract) &amp;&amp;\n                                       (includeInterfaces ? aType != interfaceType : !aType.IsInterface) &amp;&amp;\n                                       (includeStructs || !aType.IsValueType) &amp;&amp;\n                                       (includeSystemTypes || !aType.IsBuiltin()) &amp;&amp;\n                                       interfaceType.IsAssignableFrom(aType) &amp;&amp;\n                                       aType.GetInterfaces().Contains(interfaceType))\n                       .ToHashSet();\n\n            FoundTypes[interfaceType] = ans;\n\n            return ans;\n        }\n    }\n}\n\npublic static class AssemblyExt {\n    //https://stackoverflow.com/a/29379834/2557128\n    public static IEnumerable&lt;Type&gt; GetLoadableTypes(this Assembly assembly) {\n        if (assembly == null)\n            throw new ArgumentNullException(\"assembly\");\n        try {\n            return assembly.GetTypes();\n        }\n        catch (ReflectionTypeLoadException e) {\n            return e.Types.Where(t =&gt; t != null);\n        }\n    }\n}\n</code></pre>\n\n<p>Once you have one of these, you can make a factory method that takes a dynamic object:</p>\n\n<pre><code>public static class ImplementingFactory {\n    public static Type ExtractorType(dynamic anObject) {\n        Type oType = anObject.GetType();\n        var iType = typeof(IExtractor&lt;&gt;).MakeGenericType(oType);\n        var ans = iType.ImplementingTypes().FirstOrDefault();\n        if (ans == null)\n            throw new Exception($\"Unable to find IExtractor&lt;{oType.Name}&gt;\");\n        else\n            return ans;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 5120311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ex7cI7X1RqA/AAAAAAAAAAI/AAAAAAAAEp4/wIkQgXRBnz4/photo.jpg?sz=128", "display_name": "Neils Schoenfelder", "link": "https://stackoverflow.com/users/5120311/neils-schoenfelder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 59294981, "answer_count": 2, "score": 0, "last_activity_date": 1586872157, "creation_date": 1576094712, "last_edit_date": 1583179805, "question_id": 59293257, "link": "https://stackoverflow.com/questions/59293257/constraining-generic-types-by-extrinsic-functionality", "title": "Constraining generic types by extrinsic functionality", "body": "<p><strong>Background:</strong></p>\n\n<p>I am working with an organization that has an ever-growing collection of data types that they need to extract data from.  I have no ability to change these data types.  Some are machine-generated from XML files provided by other organizations; some are controlled by intransigent internal dev teams; and some are so old that no one is willing to change them in any way for fear that it will destabilize the entire Earth and cause it to crash into the sun.  These classes don't share any common interface, and don't derive from any common type other than <code>object</code>.  A few sample classes are given below for illustration purposes:</p>\n\n<pre><code>    public class Untouchable\n    {\n        public string Data;\n    }\n\n    public class Unchangeable\n    {\n        public int Info;\n    }\n</code></pre>\n\n<p>The good news is that most of the time, I can use canned functionality to get at least some of the data from instances of the various classes.  Unfortunately, most of these classes also have weird and specialized data that needs class-specific logic to extract data from.  Also, information often needs to persist inside of the data extractors because the data objects I'm pulling data from have \"interactions\" (don't ask).</p>\n\n<p>I have created an abstract generic <code>Extractor&lt;T&gt;</code> class to serve as a repository of common methodology, and an <code>IExtractor&lt;T&gt;</code> interface to serve as a convenient handle to access functionality.  I also have a few specific (de-generic?) implementations of this class that can extract information from the business objects built from some of the data types.  Here's some sample code to illustrate:</p>\n\n<pre><code>    public interface IExtractor&lt;T&gt;\n    {\n        string ExtractionOne(T something);\n        string ExtractionTwo(T something);\n    }\n\n    public abstract class Extractor&lt;T&gt; : IExtractor&lt;T&gt;\n    {\n        private string internalInfo; // Certain business logic requires us to keep internal info over multiple objects that we extract data from.\n        protected Extractor() { internalInfo=\"stuff\"; }\n\n        public virtual string ExtractionOne(T something)\n        {\n            return \"This manipulation is generally applicable to most conceivable types.\";\n        }\n\n        public abstract string ExtractionTwo(T something); // This DEFINITELY needs to be overridden for each class T\n    }\n\n    public class UntouchableExtractor : Extractor&lt;Untouchable&gt;\n    {\n        public UntouchableExtractor() : base() { }\n\n        public override string ExtractionTwo(Untouchable something)\n        {\n            return something.Data;\n        }\n    }\n\n    public class UnchangeableExtractor : Extractor&lt;Unchangeable&gt;\n    {\n        public UnchangeableExtractor() : base() { }\n\n        public override string ExtractionTwo(Unchangeable something)\n        {\n            return something.Info.ToString();\n        }\n    }\n</code></pre>\n\n<p>I don't yet support all of the available data types, but management wants to roll out the data extractor to end-users using a command-line interface.  They're telling me that we should start extracting the data we can extract, and get to the rest later.  Support for the many unmodifiable types will be added by me and by and other programmers as time permits, and the end-users are expected to work around our latency.  This actually makes sense in our real-world setting, so just go with it.</p>\n\n<p><strong>The Problem:</strong></p>\n\n<p>The list of data types that we want to pull information from is very large.  Maintaining an explicit list of supported types in code will be tricky and error prone -- especially if we find any problems with specific data extractors and need to revoke support until we fix some bugs.</p>\n\n<p>I would like to support the large and changing list of supported data types from a single entry point that dynamically determines the \"right version\" of <code>IExtractor&lt;&gt;</code> to use based on a passed in <code>dynamic dataObject</code>.  If there is no class that implements the <code>IExtractor&lt;&gt;</code> to support the given <code>dataObject</code>, than an error should be thrown.</p>\n\n<p><strong>What Doesn't Work:</strong></p>\n\n<p>I tried taking a <code>dynamic thing</code> and using <code>typeof(Extractor&lt;&gt;).MakeGenericType(thing.GetType())</code> to create an instance of <code>Extractor&lt;Untouchable&gt;</code> or <code>Extractor&lt;Unchangeable&gt;</code>, but those are abstract classes, so I can't use <code>Activator.CreateInstance()</code> to build an instance of those classes.  The core issue with this approach is that it's unfortunately looking for a <strong>class</strong> of the form <code>Extractor&lt;&gt;</code> instead of an <strong>interface</strong> of the form <code>IExtractor&lt;&gt;</code>.</p>\n\n<p>I considered putting extension methods like <code>IExtractor&lt;T&gt; BuildExtractor(this T something)</code> in some class, but I'm nervous about running into some business logic called <code>BuildExtractor</code> that already exists in one of these untouchable classes.  This may be an unhealthy level of paranoia, but that's where I'm at.</p>\n\n<p><strong>Where I need help:</strong></p>\n\n<p>I'd welcome any suggestions for how I can create a single entrypoint for an unconstrained collection of classes.  Thanks in advance.</p>\n"}, {"tags": ["c#", "delegates"], "comments": [{"owner": {"reputation": 2109, "user_id": 1538301, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c76f5389832d702d1033b2d31f348f7a?s=128&d=identicon&r=PG", "display_name": "gabriel.hayes", "link": "https://stackoverflow.com/users/1538301/gabriel-hayes"}, "edited": false, "score": 3, "creation_date": 1576094665, "post_id": 59293217, "comment_id": 104791206, "body": "Delegates are for late-bound function calls. Say you have a type, say a <code>Worker</code> that does a task. The worker might be defined with a delegate as one of its member variables and it might use that delegate, not knowing what the actual task to be performed is, until it is bound and invoked. In the example shown above, a delegate is rather useless, but it is showing you how delegates work (you have a variable <code>cd</code> and you bind it to several different methods depending on the branch of execution, then execute it)"}, {"owner": {"reputation": 2109, "user_id": 1538301, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c76f5389832d702d1033b2d31f348f7a?s=128&d=identicon&r=PG", "display_name": "gabriel.hayes", "link": "https://stackoverflow.com/users/1538301/gabriel-hayes"}, "edited": false, "score": 1, "creation_date": 1576094790, "post_id": 59293217, "comment_id": 104791264, "body": "A better example is with ASP.NET, delegates are extensively used. If you&#39;ve ever used ASP.NET, it uses Controller Actions to handle HTTP requests. ASP.NET does not know what actual logic you want to happen with HTTP requests, but it will take your controller and invoke its methods as delegates in order to abstract away much of the HTTP-specific code so that you can focus on building your application without worrying about the granular details of HTTP transmissions."}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "reply_to_user": {"reputation": 2109, "user_id": 1538301, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c76f5389832d702d1033b2d31f348f7a?s=128&d=identicon&r=PG", "display_name": "gabriel.hayes", "link": "https://stackoverflow.com/users/1538301/gabriel-hayes"}, "edited": false, "score": 1, "creation_date": 1576096876, "post_id": 59293217, "comment_id": 104792130, "body": "@user1538301 I&#39;m not too sure ASP.NET is a good example because callers of delegates don&#39;t know the name of the method, if they did they wouldn&#39;t use a delegate.  Since the behind-the-scenes script <i>knows</i> the name of the controller action, ASP.NET simply performs a one-off lookup of the concrete method to invoke before caching it.  This is more likely an example of <i>&quot;late binding&quot;</i> and .NET Reflection than delegates"}], "answers": [{"tags": [], "owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "is_accepted": true, "score": 4, "last_activity_date": 1576096320, "last_edit_date": 1576096320, "creation_date": 1576095456, "answer_id": 59293426, "question_id": 59293217, "link": "https://stackoverflow.com/questions/59293217/am-i-using-c-delegates-in-a-useful-way/59293426#59293426", "title": "Am I using C# delegates in a useful way?", "body": "<p>Delegates are types. Types that take a reference to a function, rather then some other value.</p>\n\n<p>Delegates are there to hand functions as a argument to another function. Or to be used as the type for a generic class - mostly collections in practice. There are one of the <em>many</em> replacements for naked pointers that had to be invented, so .NET could shield you from having to handle naked pointers. </p>\n\n<p>However they are also a case where the repalcement turned out to be <em>better</em> by a fair margin. For example, it is very possible to replace a switch/case with a <code>Dictionary&lt;caseLabel, delegateThatTakesAArgument&gt;</code>. If I gave you a <code>int</code> pointer in Native C++. you could not tell if this was a single variable I hand in by reference, the start of a array or a Function that returns int. With all those Pointer replacements, you know.</p>\n\n<p>For this specific case, those functions themself are overkill. Delegates are even more overkill. That \"PerformCalculation\" function, sounds like it should be the User Input Interpreation part of a Console Application, not a function. </p>\n\n<p>However there are not a lot of good, <em>unambigious</em> examples for Delegate use. So for learning it propably works okay. It is often a case where you have to make a judgement call between a switch/case with hardcoded operation and Delegates. </p>\n\n<p>However Events are one of the rare clear cut case for Delegates I can think off. If you learn them for nothing else, learn them for Events.</p>\n"}, {"tags": [], "owner": {"reputation": 2109, "user_id": 1538301, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c76f5389832d702d1033b2d31f348f7a?s=128&d=identicon&r=PG", "display_name": "gabriel.hayes", "link": "https://stackoverflow.com/users/1538301/gabriel-hayes"}, "is_accepted": false, "score": 0, "last_activity_date": 1576096253, "last_edit_date": 1576096253, "creation_date": 1576095922, "answer_id": 59293539, "question_id": 59293217, "link": "https://stackoverflow.com/questions/59293217/am-i-using-c-delegates-in-a-useful-way/59293539#59293539", "title": "Am I using C# delegates in a useful way?", "body": "<p>I've created a Repl demonstrating a Worker pattern utilizing basic delegates (<code>Action</code>s, a type of delegate built into the standard library that takes no parameters and returns nothing).</p>\n\n<p>You can check it out <a href=\"https://repl.it/@piboistudios/Delegates\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>ETA: The most common use-case for delegates is asynchronous/threaded programming.</p>\n\n<p>Threads require delegates to run as they do not know the code to be run beforehand, they simply carry it as a parameter into the newly created thread of execution, it would otherwise be impossible to create threads (well, without having lower-level access than C# provides)</p>\n\n<p>Check out the MSDN docs on the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.threading.thread?view=netframework-4.8\" rel=\"nofollow noreferrer\">Threading API</a></p>\n\n<p>Similarly, in asynchronous programming, you will generally need a callback (which would be a delegate in C#) in order to defer execution of the code until pre-existing conditions are met. (A runloop for example, a common alternative to threading which uses a single thread to execute multiple tasks \"concurrently\" step-by-step)</p>\n"}, {"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 0, "last_activity_date": 1576106969, "last_edit_date": 1576106969, "creation_date": 1576106629, "answer_id": 59295602, "question_id": 59293217, "link": "https://stackoverflow.com/questions/59293217/am-i-using-c-delegates-in-a-useful-way/59295602#59295602", "title": "Am I using C# delegates in a useful way?", "body": "<p>Once way you could use <code>delegate</code>s in your example is to have a mapping from choice to <code>CalculatorDelegate</code>, then you just lookup the desired calculation and perform it:</p>\n\n<pre><code>static List&lt;CalculatorDelegate&gt; ChoiceMap = new List&lt;CalculatorDelegate&gt; { Calculator.Add, Calculator.Subtract, Calculator.Multiply };\n\npublic class Calculation {\n    public int PerformCalculation(int choice, int number1, int number2) =&gt;\n        ChoiceMap[choice-1](number1, number2);\n}\n</code></pre>\n\n<p>But since delegates are converted automatically from lambdas (<code>CalculatorDelegate</code> is essentially <code>Func&lt;int,int,int&gt;</code>), you no longer need the <code>Calculator</code> class:</p>\n\n<pre><code>static List&lt;CalculatorDelegate&gt; ChoiceMap = new List&lt;CalculatorDelegate&gt; {\n    (n1, n2) =&gt; n1+n2,\n    (n1, n2) =&gt; n1-n2,\n    (n1, n2) =&gt; n1*n2\n};\n</code></pre>\n\n<p>Note that the types of <code>n1</code> and <code>n2</code> in each lambda are inferred from <code>CalculatorDelegate</code>. Now adding new operations to <code>PerformCalculation</code> is simply a matter of adding a new lambda to the <code>ChoiceMap</code>.</p>\n\n<p>Hopefully you can see how you could use a more complicated type for <code>ChoiceMap</code>, such as a <code>Dictionary&lt;string,Func&lt;int,int,int&gt;&gt;</code> where each key is a string representing an operator (e.g. <code>\"+\"</code>) and the value is the operation to perform, which makes mapping to a simple calculator easy.</p>\n\n<p>I use a similar <code>Dictionary</code> in a command line switch management helper, where each entry has the command name, the number of arguments, the delegate (method) to call (which may be a lambda when simple enough), the command grouping and some help text, where help output is generated automatically from the same <code>Dictionary</code>.</p>\n"}], "owner": {"reputation": 7, "user_id": 12513431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04a95018febdbb731dd00c3e6a67096?s=128&d=identicon&r=PG&f=1", "display_name": "bmakl", "link": "https://stackoverflow.com/users/12513431/bmakl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 59293426, "answer_count": 3, "score": 0, "last_activity_date": 1576106969, "creation_date": 1576094503, "last_edit_date": 1576095867, "question_id": 59293217, "link": "https://stackoverflow.com/questions/59293217/am-i-using-c-delegates-in-a-useful-way", "title": "Am I using C# delegates in a useful way?", "body": "<p>I am doing a simple exercise using delegates in C#. The basic premise is that it simply performs calculations like addition and subtraction. </p>\n\n<pre><code>public class Calculator\n{\n    public static int Add(int num1, int num2)\n    {\n        return num1 + num2;\n    }\n\n    public static int Multiply(int num1, int num2)\n    {\n        return num1 * num2; \n    }\n\n    public static int Subtract(int num1, int num2)\n    {\n        return num1 - num2;\n    }\n}\n</code></pre>\n\n<p>And I have created a delegate that will call these functions in another class. </p>\n\n<pre><code>public delegate int CalculatorDelegate(int num1, int num2);\n</code></pre>\n\n<p>The implementation class looks like this:</p>\n\n<pre><code>public class Calculation\n{\n    public int PerformCalculation(int choice, int number1, int number2)\n    {\n        CalculatorDelegate cd;\n        if (choice == 1)\n        {\n            cd = Calculator.Add;\n            return cd(number1, number2);\n        }\n        else if (choice == 2)\n        {\n            cd = Calculator.Subtract;\n            return cd(number1, number2);\n        }\n        else if (choice == 3)\n        {\n            cd = Calculator.Multiply;\n            return cd(number1, number2);\n        }\n        else\n        {\n            cd = Calculator.Add;\n            return cd(number1, number2);\n        }\n    }\n\n}\n</code></pre>\n\n<p>What's confusing me about delegates is why not just do the following instead?</p>\n\n<pre><code>if (choice == 1)\n{\n    return Calculator.Add(number1,number2);\n}\n</code></pre>\n\n<p>I think my confusion is surrounding the fact that if these methods are already static, what's the point of even making a delegate to them. I can simply just call them as static methods. If I try to make the methods non-static, then I cant have my delegate point to them in this other class, without creating some object of the other class. </p>\n\n<p>I am all turned around on this example and what it even accomplishes and maybe someone can provide me some insight as to if I'm even using this remotely close to how it should be?</p>\n"}, {"tags": ["c#", "wpf", "xaml", "datagrid"], "comments": [{"owner": {"reputation": 2734, "user_id": 2470362, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xlHsB.jpg?s=128&g=1", "display_name": "Abin", "link": "https://stackoverflow.com/users/2470362/abin"}, "edited": false, "score": 0, "creation_date": 1576095020, "post_id": 59293211, "comment_id": 104791370, "body": "I wonder what is your <code>Refresh</code> Button/?? doing ? If you bind to an <code>observablecollection</code> then refresh should just add or remove items to the collection. that will not affect the whole grid to refresh."}, {"owner": {"reputation": 21, "user_id": 12520604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8dc93bedad4596124b499a80cb00675?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna Muppidi", "link": "https://stackoverflow.com/users/12520604/prasanna-muppidi"}, "reply_to_user": {"reputation": 2734, "user_id": 2470362, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xlHsB.jpg?s=128&g=1", "display_name": "Abin", "link": "https://stackoverflow.com/users/2470362/abin"}, "edited": false, "score": 0, "creation_date": 1576096678, "post_id": 59293211, "comment_id": 104792053, "body": "This sounds right. Let me try this and see if this works. I will keep you posted. Thank you!"}, {"owner": {"reputation": 21, "user_id": 12520604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8dc93bedad4596124b499a80cb00675?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna Muppidi", "link": "https://stackoverflow.com/users/12520604/prasanna-muppidi"}, "reply_to_user": {"reputation": 2734, "user_id": 2470362, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xlHsB.jpg?s=128&g=1", "display_name": "Abin", "link": "https://stackoverflow.com/users/2470362/abin"}, "edited": false, "score": 0, "creation_date": 1576100143, "post_id": 59293211, "comment_id": 104793462, "body": "I tried binding observable collection to my Datagrid and the issue still persists."}, {"owner": {"reputation": 2734, "user_id": 2470362, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xlHsB.jpg?s=128&g=1", "display_name": "Abin", "link": "https://stackoverflow.com/users/2470362/abin"}, "edited": false, "score": 0, "creation_date": 1576103276, "post_id": 59293211, "comment_id": 104794526, "body": "it&#39;s better to show what <code>Refresh</code> does. Please add that to the question."}, {"owner": {"reputation": 86, "user_id": 10505137, "user_type": "registered", "profile_image": "https://graph.facebook.com/2112304929098865/picture?type=large", "display_name": "MarioWu", "link": "https://stackoverflow.com/users/10505137/mariowu"}, "edited": false, "score": 0, "creation_date": 1576223041, "post_id": 59293211, "comment_id": 104836891, "body": "How you use your GetScrollViewer()? after reset?"}, {"owner": {"reputation": 21, "user_id": 12520604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8dc93bedad4596124b499a80cb00675?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna Muppidi", "link": "https://stackoverflow.com/users/12520604/prasanna-muppidi"}, "reply_to_user": {"reputation": 86, "user_id": 10505137, "user_type": "registered", "profile_image": "https://graph.facebook.com/2112304929098865/picture?type=large", "display_name": "MarioWu", "link": "https://stackoverflow.com/users/10505137/mariowu"}, "edited": false, "score": 0, "creation_date": 1576270318, "post_id": 59293211, "comment_id": 104858637, "body": "@MarioWu Each time my application is refreshed, my ScrollChangeHandler is called. Right now, I hacked it a little bit by adding the if condition that I have in my code. So, when I get 0 offsets, I use the old scroll positions and set the scrollviewer in that position."}], "owner": {"reputation": 21, "user_id": 12520604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8dc93bedad4596124b499a80cb00675?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna Muppidi", "link": "https://stackoverflow.com/users/12520604/prasanna-muppidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576094480, "creation_date": 1576094480, "question_id": 59293211, "link": "https://stackoverflow.com/questions/59293211/differentiate-between-a-scroll-that-the-user-is-performing-and-a-scroll-wpf-is-t", "title": "Differentiate between a scroll that the user is performing and a scroll WPF is trying to do in a Datagrid", "body": "<p>I have a Datagrid with a bunch of rows in it. When I scroll down and click refresh, my scroll bar defaults to the top of the page. But I want my scroll bar to remember the scroll position after the refresh. </p>\n\n<p>My xaml looks like this.</p>\n\n<pre><code>&lt;DataGrid x:Name=\"inpatientorderGrid\" ItemsSource=\"{Binding InpatientOrdersList,  IsAsync=True}\" ScrollViewer.ScrollChanged=\"ScrollChangeHandler\"&gt;\n\n</code></pre>\n\n<p>my xaml.cs file looks like this.</p>\n\n<pre><code>private void ScrollChangeHandler(object sender, ScrollChangedEventArgs scrollChangeEvent)\n        {\n            if (scrollChangeEvent.VerticalOffset &gt; 0 || scrollChangeEvent.HorizontalOffset &gt; 0)\n            {\n                dVerticalOffset = scrollChangeEvent.VerticalOffset;\n                dHorizontalOffset = scrollChangeEvent.HorizontalOffset;\n            }\n                SetScrollViewerOffsets(dVerticalOffset, dHorizontalOffset);\n        }\n\nprivate void SetScrollViewerOffsets(double dVerticalOffset, double dHorizontalOffset)\n        {\n            DependencyObject dependencyObject = GetCurrentWorkItemDataGrid() as DependencyObject;\n            if (dependencyObject != null)\n            {\n                ScrollViewer scrollViewer = GetScrollViewer(dependencyObject);\n                if (scrollViewer != null)\n                {\n                    scrollViewer.ScrollToHorizontalOffset(dHorizontalOffset);\n                    scrollViewer.ScrollToVerticalOffset(dVerticalOffset);\n                }\n            }\n        }\n\nprivate ScrollViewer GetScrollViewer(DependencyObject dependencyObject)\n        {\n            ScrollViewer scrollViewer = null;\n            for (int i = 0; i &lt; VisualTreeHelper.GetChildrenCount(dependencyObject); i++)\n            {\n                if (VisualTreeHelper.GetChild(dependencyObject, i) is ScrollViewer)\n                {\n                    scrollViewer = (ScrollViewer)(VisualTreeHelper.GetChild(dependencyObject, i));\n                }\n                else\n                {\n                    scrollViewer = GetScrollViewer(VisualTreeHelper.GetChild(dependencyObject, i) as DependencyObject);\n                }\n            }\n            return scrollViewer;\n        }\n</code></pre>\n\n<p>Each time I scroll down, my ScrollChangeHandler is called and I get the vertical offset and the horizontal offset and set the srcollviewer but after that, wpf is trying to reload the page to the top and my values are being reset. Inorder to avoid that I'm performing my logic only when my offsets are > 0. This solves my original problem but I see a bug when I'm trying to manually go to the top of my page since it takes the old offsets when my scroll change event offsets are zero. How do I differntiate between a manual scroll and a scroll change that wpf is trying to do?</p>\n"}, {"tags": ["c#", "xml", "vsto", "powerpoint", "openxml"], "comments": [{"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "edited": false, "score": 0, "creation_date": 1576101686, "post_id": 59293193, "comment_id": 104794003, "body": "If you add a reference to the Open XML SDK in your project, your add-in will have access to your presentation&#39;s XML to modify it."}, {"owner": {"reputation": 105, "user_id": 4723936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4UzKy-p9LAg/AAAAAAAAAAI/AAAAAAAAAWY/8eO4pvfoyag/photo.jpg?sz=128", "display_name": "jAndersen", "link": "https://stackoverflow.com/users/4723936/jandersen"}, "edited": false, "score": 1, "creation_date": 1576148070, "post_id": 59293193, "comment_id": 104808656, "body": "As John Korchok has commented, you need to reference the Open XML SDK, however, you need to close and reopen the document for VSTO to see the changes."}, {"owner": {"reputation": 38, "user_id": 12520642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5adb7d12b857a76e907ece0ba4d2926?s=128&d=identicon&r=PG&f=1", "display_name": "ceetrox", "link": "https://stackoverflow.com/users/12520642/ceetrox"}, "edited": false, "score": 0, "creation_date": 1576150993, "post_id": 59293193, "comment_id": 104810187, "body": "Hi and thx for your input.... Unfortunately, reopening is not a solution for our case. I am searching for a runtime solution. Currently, we try to find out if we can build a custom solution with COM."}, {"owner": {"reputation": 1489, "user_id": 4654643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244f40d8ade929a04341d25eb34f9168?s=128&d=identicon&r=PG", "display_name": "Thomas Barnekow", "link": "https://stackoverflow.com/users/4654643/thomas-barnekow"}, "edited": false, "score": 0, "creation_date": 1578937628, "post_id": 59293193, "comment_id": 105593782, "body": "Were you able to build a custom solution with COM?"}, {"owner": {"reputation": 38, "user_id": 12520642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5adb7d12b857a76e907ece0ba4d2926?s=128&d=identicon&r=PG&f=1", "display_name": "ceetrox", "link": "https://stackoverflow.com/users/12520642/ceetrox"}, "edited": false, "score": 0, "creation_date": 1579025635, "post_id": 59293193, "comment_id": 105627637, "body": "It&#39;s only possible with memory manipulation on a c++ level. Thinkcell does this for example... But I don&#39;t find any solution about this"}, {"owner": {"reputation": 1110, "user_id": 796634, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/759a9c14c2ff6e3bf1a68534625f3985?s=128&d=identicon&r=PG", "display_name": "Geordie", "link": "https://stackoverflow.com/users/796634/geordie"}, "edited": false, "score": 0, "creation_date": 1612823574, "post_id": 59293193, "comment_id": 116882530, "body": "It would be a very long way around but if the pptx is hosted in Sharepoint could use REST APIs to trigger an upload and refresh."}], "answers": [{"tags": [], "owner": {"reputation": 1489, "user_id": 4654643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244f40d8ade929a04341d25eb34f9168?s=128&d=identicon&r=PG", "display_name": "Thomas Barnekow", "link": "https://stackoverflow.com/users/4654643/thomas-barnekow"}, "is_accepted": false, "score": 0, "last_activity_date": 1576342640, "creation_date": 1576342640, "answer_id": 59337240, "question_id": 59293193, "link": "https://stackoverflow.com/questions/59293193/vsto-openxml-c-edit-powerpoint-on-runtime/59337240#59337240", "title": "VSTO OpenXml C# - Edit PowerPoint on Runtime", "body": "<p>Unfortunately, Microsoft Word is the only Office application that offers an Interop API for reading and even writing Open XML markup, in that case of a given <code>Range</code> object (which can also be the <code>Range</code> representing the whole main document part). Neither Excel nor PowerPoint provides that capability.</p>\n\n<p>Even Microsoft Word does not give you the full markup, though, meaning you can't read or change every aspect of the opened document by reading or making changes to the Open XML markup. Thus, depending on what you would like to do with your document, you will have to close and reopen even Word documents to access and process the full Open XML markup.</p>\n"}, {"tags": [], "owner": {"reputation": 1110, "user_id": 796634, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/759a9c14c2ff6e3bf1a68534625f3985?s=128&d=identicon&r=PG", "display_name": "Geordie", "link": "https://stackoverflow.com/users/796634/geordie"}, "is_accepted": false, "score": 0, "last_activity_date": 1612939143, "creation_date": 1612939143, "answer_id": 66132047, "question_id": 59293193, "link": "https://stackoverflow.com/questions/59293193/vsto-openxml-c-edit-powerpoint-on-runtime/66132047#66132047", "title": "VSTO OpenXml C# - Edit PowerPoint on Runtime", "body": "<p>A sub-optimal yet functional way to do this is round trip using the clipboard.  Slide(s) copied to the clipboard are actually packaged up as ppt data (which is just a zip).  And you have control over the clipboard and inserting etc slides. So basically:</p>\n<ol>\n<li>Programmatically select and copy the content you want to edit to the clipboard using PP APIs.</li>\n<li>Read &quot;PowerPoint 14.0 Slides Package&quot; part of clipboard data into memory stream.</li>\n<li>Pass/edit memory stream with Open XML.</li>\n<li>Copy memory stream back to clipboard.</li>\n<li>paste back into PP as needed.</li>\n</ol>\n<p>Here's an example of steps 2-3 working using <a href=\"https://docs.microsoft.com/en-us/office/open-xml/how-to-get-all-the-text-in-a-slide-in-a-presentation\" rel=\"nofollow noreferrer\">this</a> Open XML example as a base that write all text in the first slide in the clipboard to the console:</p>\n<pre><code>using System;\nusing System.IO; \nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Windows;\n\nusing DocumentFormat.OpenXml;\nusing DocumentFormat.OpenXml.Drawing;\nusing DocumentFormat.OpenXml.Packaging;\nusing DocumentFormat.OpenXml.Presentation;\nusing P = DocumentFormat.OpenXml.Presentation;\nusing D = DocumentFormat.OpenXml.Drawing;\nusing DocumentFormat.OpenXml.Office2016.Drawing.ChartDrawing;\n\nnamespace PPClipboardTest\n{    \n    class Program\n    {\n        public static string format = &quot;PowerPoint 14.0 Slides Package&quot;;\n\n\n        // Get all the text in a slide.\n        public static string[] GetAllTextInSlide(string presentationFile, int slideIndex)\n        {\n            // Open the presentation as read-only.\n            using (PresentationDocument presentationDocument = PresentationDocument.Open(presentationFile, false))\n            {\n                // Pass the presentation and the slide index\n                // to the next GetAllTextInSlide method, and\n                // then return the array of strings it returns. \n                return GetAllTextInSlide(presentationDocument, slideIndex);\n            }\n        }\n\n        public static string[] GetAllTextInSlide(PresentationDocument presentationDocument, int slideIndex)\n        {\n            // Verify that the presentation document exists.\n            if (presentationDocument == null)\n            {\n                throw new ArgumentNullException(&quot;presentationDocument&quot;);\n            }\n\n            // Verify that the slide index is not out of range.\n            if (slideIndex &lt; 0)\n            {\n                throw new ArgumentOutOfRangeException(&quot;slideIndex&quot;);\n            }\n\n            // Get the presentation part of the presentation document.\n            PresentationPart presentationPart = presentationDocument.PresentationPart;\n\n            // Verify that the presentation part and presentation exist.\n            if (presentationPart != null &amp;&amp; presentationPart.Presentation != null)\n            {\n                // Get the Presentation object from the presentation part.\n                Presentation presentation = presentationPart.Presentation;\n\n                // Verify that the slide ID list exists.\n                if (presentation.SlideIdList != null)\n                {\n                    // Get the collection of slide IDs from the slide ID list.\n                    DocumentFormat.OpenXml.OpenXmlElementList slideIds =\n                        presentation.SlideIdList.ChildElements;\n\n                    // If the slide ID is in range...\n                    if (slideIndex &lt; slideIds.Count)\n                    {\n                        // Get the relationship ID of the slide.\n                        string slidePartRelationshipId = (slideIds[slideIndex] as SlideId).RelationshipId;\n\n                        // Get the specified slide part from the relationship ID.\n                        SlidePart slidePart =\n                            (SlidePart)presentationPart.GetPartById(slidePartRelationshipId);\n\n                        // Pass the slide part to the next method, and\n                        // then return the array of strings that method\n                        // returns to the previous method.\n                        return GetAllTextInSlide(slidePart);\n                    }\n                }\n            }\n\n            // Else, return null.\n            return null;\n        }\n\n        public static string[] GetAllTextInSlide(SlidePart slidePart)\n        {\n            // Verify that the slide part exists.\n            if (slidePart == null)\n            {\n                throw new ArgumentNullException(&quot;slidePart&quot;);\n            }\n\n            // Create a new linked list of strings.\n            LinkedList&lt;string&gt; texts = new LinkedList&lt;string&gt;();\n\n            // If the slide exists...\n            if (slidePart.Slide != null)\n            {\n                // Iterate through all the paragraphs in the slide.\n                foreach (DocumentFormat.OpenXml.Drawing.Paragraph paragraph in\n                    slidePart.Slide.Descendants&lt;DocumentFormat.OpenXml.Drawing.Paragraph&gt;())\n                {\n                    // Create a new string builder.                    \n                    StringBuilder paragraphText = new StringBuilder();\n\n                    // Iterate through the lines of the paragraph.\n                    foreach (DocumentFormat.OpenXml.Drawing.Text text in\n                        paragraph.Descendants&lt;DocumentFormat.OpenXml.Drawing.Text&gt;())\n                    {\n                        // Append each line to the previous lines.\n                        paragraphText.Append(text.Text);\n                    }\n\n                    if (paragraphText.Length &gt; 0)\n                    {\n                        // Add each paragraph to the linked list.\n                        texts.AddLast(paragraphText.ToString());\n                    }\n                }\n            }\n\n            if (texts.Count &gt; 0)\n            {\n                // Return an array of strings.\n                return texts.ToArray();\n            }\n            else\n            {\n                return null;\n            }\n        }\n\n\n\n        [STAThread]\n        static void Main(string[] args)\n        {\n            IDataObject iData = new DataObject();\n\n            iData = Clipboard.GetDataObject();\n            string[] formats = iData.GetFormats();\n\n            foreach(string f in formats)\n            {\n                if(f == format)\n                {\n                    MemoryStream ms = iData.GetData(format) as MemoryStream;\n\n                    using (PresentationDocument pres = PresentationDocument.Open(ms, true))\n                    {\n                        string[] allText = GetAllTextInSlide(pres, 0);\n                        Console.Write(&quot;Text in first slide copied to clipboard:\\n&quot;);\n                        foreach (string txt in allText)\n                        {\n                            \n                            Console.Write(txt + &quot;\\n&quot;);\n                        }\n                    }\n\n                    /*\n                    // Write to file\n                    using (FileStream file = new FileStream(&quot;file.ppt&quot;, FileMode.Create, System.IO.FileAccess.Write)) // Bin chunk from clipboard is just a zip file\n                    {\n                        byte[] bytes = new byte[ms.Length];\n                        ms.Read(bytes, 0, (int)ms.Length);\n                        file.Write(bytes, 0, bytes.Length);\n                        ms.Close();\n                    }\n                    */\n\n\n                    break;\n                }\n            }            \n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 38, "user_id": 12520642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5adb7d12b857a76e907ece0ba4d2926?s=128&d=identicon&r=PG&f=1", "display_name": "ceetrox", "link": "https://stackoverflow.com/users/12520642/ceetrox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1612939143, "creation_date": 1576094412, "last_edit_date": 1576095024, "question_id": 59293193, "link": "https://stackoverflow.com/questions/59293193/vsto-openxml-c-edit-powerpoint-on-runtime", "title": "VSTO OpenXml C# - Edit PowerPoint on Runtime", "body": "<p>I've read a lot about editing pptx files with OpenXml like</p>\n\n<pre><code>PresentationDocument presentationDocument = PresentationDocument.Open(\"C:\\\\Users\\\\beggers\\\\Desktop\\\\Test.pptx\", true)\n</code></pre>\n\n<p>But how can I modify the XML data of my slides/presentation on runtime? Specialy when I run a new presentation witch is not saved. </p>\n\n<p>I am working on a C# VSTO Add-in and I want to modify my slide/xml in a way, which is not supportet by Microsoft.Office.Interop.</p>\n"}, {"tags": ["c#", "excel", "excel-interop"], "comments": [{"owner": {"reputation": 723, "user_id": 418950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PFmX.jpg?s=128&g=1", "display_name": "ScottWelker", "link": "https://stackoverflow.com/users/418950/scottwelker"}, "edited": false, "score": 1, "creation_date": 1576094701, "post_id": 59293160, "comment_id": 104791220, "body": "Consider whether your error relates to a run-time failure to load your application&#39;s dependent assemblies or one of their dependent assemblies. Check out the the Fusion Log: <a href=\"https://www.hanselman.com/blog/BackToBasicsUsingFusionLogViewerToDebugObscureLoaderErrors.aspx\" rel=\"nofollow noreferrer\">hanselman.com/blog/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 3842019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d68c6c98fed3ab23de4ff4b38bd34c7?s=128&d=identicon&r=PG&f=1", "display_name": "ChangeJar", "link": "https://stackoverflow.com/users/3842019/changejar"}, "is_accepted": true, "score": 1, "last_activity_date": 1576172931, "creation_date": 1576172931, "answer_id": 59310214, "question_id": 59293160, "link": "https://stackoverflow.com/questions/59293160/c-loading-excel-file-using-interop-unhandled-system-io-filenotfoundexception/59310214#59310214", "title": "C# Loading Excel File Using Interop Unhandled &#39;System.IO.FileNotFoundException&#39; in Unknown Module", "body": "<p>Target Framework was off for the VS Project.</p>\n"}], "owner": {"reputation": 155, "user_id": 3842019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d68c6c98fed3ab23de4ff4b38bd34c7?s=128&d=identicon&r=PG&f=1", "display_name": "ChangeJar", "link": "https://stackoverflow.com/users/3842019/changejar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 59310214, "answer_count": 1, "score": 0, "last_activity_date": 1576172931, "creation_date": 1576094261, "question_id": 59293160, "link": "https://stackoverflow.com/questions/59293160/c-loading-excel-file-using-interop-unhandled-system-io-filenotfoundexception", "title": "C# Loading Excel File Using Interop Unhandled &#39;System.IO.FileNotFoundException&#39; in Unknown Module", "body": "<p>Attempting to load multiple .xlsx files.  After updating Office versions to 2013 to make sure the .dll was compatible, I'm still getting this error.  </p>\n\n<blockquote>\n  <p>An unhandled exception of type 'System.IO.FileNotFoundException' occurred in Unknown Module.\n  Could not load file or assembly 'office, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'. The system cannot find the file specified.</p>\n</blockquote>\n\n<p>When attempting to execute the following code. </p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\nusing Excel = Microsoft.Office.Interop.Excel;\n\nnamespace SolnName\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            //File paths\n            string path1 = @\"path\\file1.xlsx\";\n            string path2 = @\"path\\file2.xlsx\";\n\n            try\n            {\n                Excel.Application xlApp = new Excel.Application();\n\n                Excel.Workbook book1 = xlApp.Workbooks.Open(path1);\n                Excel.Worksheet sheet1 = (Excel.Worksheet)book1.Worksheets.get_Item(1);\n\n                Excel.Workbook book2 = xlApp.Workbooks.Open(path2);\n                Excel.Worksheet sheet2 = (Excel.Worksheet)book2.Worksheets.get_Item(1);\n\n                book1.Close(true, null, null);\n                book2.Close(true, null, null);\n\n                xlApp.Quit();\n\n                Marshal.ReleaseComObject(sheet1);\n                Marshal.ReleaseComObject(sheet2);\n                Marshal.ReleaseComObject(book1);\n                Marshal.ReleaseComObject(book2);\n                Marshal.ReleaseComObject(xlApp);\n            }\n            catch (Exception e)\n            {\n                Console.WriteLine(e.StackTrace);\n                Console.WriteLine(e.Data);\n                Console.WriteLine(e.Message);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The plan ultimately is to create pivot tables in a new file based off the data, but I can't even execute opening and closing the files.  The files DO exist at the actual file paths.  All help is greatly appreciated!  </p>\n"}, {"tags": ["c#", "explorer"], "comments": [{"owner": {"reputation": 10183, "user_id": 9604, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3740b508fb7c60ad79d9bc43eb05c48e?s=128&d=identicon&r=PG", "display_name": "mxmissile", "link": "https://stackoverflow.com/users/9604/mxmissile"}, "edited": false, "score": 0, "creation_date": 1576094423, "post_id": 59293142, "comment_id": 104791080, "body": "<code>&quot;C:\\\\Temp\\\\test.txt&quot; != &quot;C:\\Temp\\test.txt&quot;</code> does it work if you use the same value for <code>path</code>?"}, {"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576094856, "post_id": 59293142, "comment_id": 104791293, "body": "What <i>exactly</i> is the value of path? You are working with strings. And strings are notoriously likely to not match. As &quot;\\&quot; is the String Escape Character as well as a possible Path Seperator, &quot;C:\\Temp\\test.txt&quot; is something very different from &quot;C:\\\\Temp\\\\test.txt&quot;."}, {"owner": {"reputation": 23, "user_id": 12091122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2503d5eef50bebb39989836f24a915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Conchors", "link": "https://stackoverflow.com/users/12091122/conchors"}, "edited": false, "score": 0, "creation_date": 1576095777, "post_id": 59293142, "comment_id": 104791684, "body": "When checked in the Debugger: <code>path</code> is &quot;C:\\\\Temp\\\\test.txt&quot; I chose my value for the hardcode based on what I saw in the variable in the debugger, and copied it exactly"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 1, "creation_date": 1576096825, "post_id": 59293142, "comment_id": 104792110, "body": "That&#39;s pretty much impossible with the given code - if <code>path</code> in the first sample equals the hardcoded string in the second sample, then the behavior will be identical. Please post an example that reproduces the issue."}, {"owner": {"reputation": 23, "user_id": 12091122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2503d5eef50bebb39989836f24a915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Conchors", "link": "https://stackoverflow.com/users/12091122/conchors"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1576097652, "post_id": 59293142, "comment_id": 104792442, "body": "@RufusL I added an image showing that Path and the Hardcoded string are the same. The 2 cropped Explorer windows are the Respective results of the 2 calls. (Images cropped for Security reasons)"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1576097809, "post_id": 59293142, "comment_id": 104792523, "body": "All I&#39;m saying is that I created a <code>C:\\Temp\\test.txt</code> file and ran your code both ways, and got the same results each time, so something else is going on. Where are you getting the <code>path</code> string from? Could it have a strange character that doesn&#39;t appear in the UI?"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 1, "creation_date": 1576097927, "post_id": 59293142, "comment_id": 104792564, "body": "<i>&quot;Is there something wrong with the internal formatting on my string variable or something&quot;</i> Yes, most likely."}, {"owner": {"reputation": 23, "user_id": 12091122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2503d5eef50bebb39989836f24a915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Conchors", "link": "https://stackoverflow.com/users/12091122/conchors"}, "reply_to_user": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1576099162, "post_id": 59293142, "comment_id": 104793050, "body": "@RufusL There was a hidden AScii 8234 Character. It was being taken from a WPF control that was loaded from a file."}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 11964634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1D45.jpg?s=128&g=1", "display_name": "Arthur Grigoryan", "link": "https://stackoverflow.com/users/11964634/arthur-grigoryan"}, "is_accepted": false, "score": 1, "last_activity_date": 1576096761, "creation_date": 1576096761, "answer_id": 59293736, "question_id": 59293142, "link": "https://stackoverflow.com/questions/59293142/using-process-start-to-open-explorer/59293736#59293736", "title": "Using Process.Start to open explorer", "body": "<pre><code>    public static class Program\n    {\n        static void Main()\n        {\n            Explore(\"C:\\\\Users\\\\art_g\\\\Desktop\\\\Sample.txt\");\n        }\n        static void Explore(string path) =&gt;\n            Process.Start(\"explorer.exe\", \"/select, \" + path);\n    }\n</code></pre>\n\n<p><strong>Works like a charm. Check your path string.</strong></p>\n"}], "owner": {"reputation": 23, "user_id": 12091122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2503d5eef50bebb39989836f24a915ad?s=128&d=identicon&r=PG&f=1", "display_name": "Conchors", "link": "https://stackoverflow.com/users/12091122/conchors"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576099500, "creation_date": 1576094200, "last_edit_date": 1592644375, "question_id": 59293142, "link": "https://stackoverflow.com/questions/59293142/using-process-start-to-open-explorer", "title": "Using Process.Start to open explorer", "body": "<p>Edit: solution found, will note under image at the end of the question</p>\n<p>After a bunch of research here on SO, I found that the way to open explorer with a selected file was:</p>\n<p><code>Process.Start(&quot;explorer.exe&quot;, &quot;/select, &quot; + path);</code></p>\n<p>However when I do this with controlled input, Explorer opens just its main window, however when I harcode the function call to the same value that's in the path variable (In my control test its a text file in C:\\Temp) it works. So if I do the above when path is &quot;C:\\Temp\\test.txt&quot; It does't open explorer in the temp folder, however when I do:</p>\n<p><code>Process.Start(&quot;explorer.exe&quot;, &quot;/select, C:\\\\Temp\\\\test.txt&quot;);</code></p>\n<p>It works perfectly, opening explorer and highlighting the file. What is happening here? Is there something wrong with the internal formatting on my string variable or something?</p>\n<p>(Additionally, I ran into the same issue using the path variable to open a FileInfo. Hardcoded to the same value would work, but using the variable gave me a &quot;the given path's format is not supported&quot; exception&quot;)</p>\n<p>Image showing that path and the harcoded value are the same:\n<a href=\"https://i.stack.imgur.com/7Am3C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Am3C.png\" alt=\"Image showing that path and the harcoded value are the same\" /></a></p>\n<p>The 2 explorer windows (cropped for Security) are the results of the 2 respective calls. The one with the variable shows te basic explorer main page. The one that's hardcoded shows the file selected as expected.</p>\n<p>Edit: There was a hidden Left-To-Right Format character hidden in the front of the string.</p>\n"}, {"tags": ["c#", ".net-core", "controller", "model-binding"], "comments": [{"owner": {"reputation": 2109, "user_id": 1538301, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c76f5389832d702d1033b2d31f348f7a?s=128&d=identicon&r=PG", "display_name": "gabriel.hayes", "link": "https://stackoverflow.com/users/1538301/gabriel-hayes"}, "edited": false, "score": 0, "creation_date": 1576094188, "post_id": 59293082, "comment_id": 104790964, "body": "Wouldn&#39;t it make more sense to have the payload consist of an actual string instead of an object then, since JavaScript&#39;s JSON serialization is faster anyways?"}, {"owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "edited": false, "score": 0, "creation_date": 1576444997, "post_id": 59293082, "comment_id": 104892340, "body": "Could you provide an ajax call how you send data?"}], "answers": [{"comments": [{"owner": {"reputation": 3159, "user_id": 3680874, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/g0nsG.png?s=128&g=1", "display_name": "David Gourde", "link": "https://stackoverflow.com/users/3680874/david-gourde"}, "edited": false, "score": 0, "creation_date": 1576168083, "post_id": 59293163, "comment_id": 104820210, "body": "What I&#39;m trying to find is a way to have a DTO use a string type, and pre-process the convertion with a binding of some sort, maybe with an attribute? I do not know how I could do that. Right now I&#39;m using an object type (similar to dynamic), but this means I have to convert it in my mappings to Entities and add special IEquals implementations to compare object with string and vise versa (or dynamic with string)"}], "tags": [], "owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "is_accepted": false, "score": 0, "last_activity_date": 1576094278, "creation_date": 1576094278, "answer_id": 59293163, "question_id": 59293082, "link": "https://stackoverflow.com/questions/59293082/is-there-a-way-in-dotnet-core-to-deserialize-an-object-field-into-a-string-direc/59293163#59293163", "title": "Is there a way in dotnet core to deserialize an object field into a string directly in the DTO?", "body": "<p>You can change the type of Json to dynamic.</p>\n\n<pre><code>  public class MyDto\n  {\n      public string Field1 { get; set; }\n      public dynamic Json { get; set; } \n  }\n</code></pre>\n\n<p>when you deserialize, it will convert it to a dynamic object, not a string. </p>\n\n<p>Ideally, you want to use another object that classifies what the json object is supposed to be</p>\n\n<pre><code>  public class MyJsonObject\n  {\n    public string Field1OfJson {get;set;}\n    public string Field2OfJson {get;set;}\n  }\n\n  // Then use that as the type\n  public class MyDto\n  {\n      public string Field1 { get; set; }\n      public MyJsonObject Json { get; set; } \n  }\n</code></pre>\n\n<p>This way you can access the data under Json easily.</p>\n"}], "owner": {"reputation": 3159, "user_id": 3680874, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/g0nsG.png?s=128&g=1", "display_name": "David Gourde", "link": "https://stackoverflow.com/users/3680874/david-gourde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576094278, "creation_date": 1576093984, "question_id": 59293082, "link": "https://stackoverflow.com/questions/59293082/is-there-a-way-in-dotnet-core-to-deserialize-an-object-field-into-a-string-direc", "title": "Is there a way in dotnet core to deserialize an object field into a string directly in the DTO?", "body": "<p>My DTO has a field that is a JSON. I would like to receive it as a string instead.</p>\n\n<p>The controller receives a body like so: <code>public async Task&lt;IActionResult&gt; Post([FromBody] MyDto dto)</code></p>\n\n<p>The DTO looks like this:</p>\n\n<pre><code>public class MyDto\n{\n    public string Field1 { get; set; }\n    public string Json { get; set; }\n}\n</code></pre>\n\n<p>This does not work, as it won't automatically deserialize the \"Json\" object into a string. I need to use another type, like JObject or Dynamic, then transfer it in an Entity which has this field as a string.</p>\n\n<p>I would like to directly transform the JObject I receive into a string, so my DTO could still use a string. Is there a way to specify a binding or deserialization method to this specific field, so it does a <code>.ToString()</code> before?</p>\n"}, {"tags": ["c#", "xamarin", "xamarin.forms", "xamarin.android", "xamarin.ios"], "comments": [{"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1576093400, "post_id": 59292726, "comment_id": 104790591, "body": "I&#39;d suggest you use a much simpler layout first to get the drag-and-drop behavior working, then add in the other elements.  Right now you have an incredibly complicated nested layout so it&#39;s very difficult to determine what is happening."}, {"owner": {"reputation": 93, "user_id": 12520502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa20d2b716fbaf08fcfe02860ff6d03f?s=128&d=identicon&r=PG&f=1", "display_name": "Vreesie", "link": "https://stackoverflow.com/users/12520502/vreesie"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1576095958, "post_id": 59292726, "comment_id": 104791759, "body": "I made the page way easier as you said, but still same result. Code is above..."}, {"owner": {"reputation": 415, "user_id": 10366303, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PZ965.png?s=128&g=1", "display_name": "Shaw", "link": "https://stackoverflow.com/users/10366303/shaw"}, "edited": false, "score": 0, "creation_date": 1576102975, "post_id": 59292726, "comment_id": 104794433, "body": "Have you added the custom renderer to Android and iOS proj, check <a href=\"https://github.com/CrossGeeks/DragViewSample/tree/master/DragViewSample/DragViewSample.Android/Renderers\" rel=\"nofollow noreferrer\">this class</a>"}, {"owner": {"reputation": 93, "user_id": 12520502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa20d2b716fbaf08fcfe02860ff6d03f?s=128&d=identicon&r=PG&f=1", "display_name": "Vreesie", "link": "https://stackoverflow.com/users/12520502/vreesie"}, "edited": false, "score": 0, "creation_date": 1576104154, "post_id": 59292726, "comment_id": 104794804, "body": "Thanks, this fixed it. Totally missed the renderer!"}], "owner": {"reputation": 93, "user_id": 12520502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa20d2b716fbaf08fcfe02860ff6d03f?s=128&d=identicon&r=PG&f=1", "display_name": "Vreesie", "link": "https://stackoverflow.com/users/12520502/vreesie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576097696, "creation_date": 1576092414, "last_edit_date": 1576097696, "question_id": 59292726, "link": "https://stackoverflow.com/questions/59292726/xamarin-drag-drop-labels", "title": "Xamarin Drag/Drop labels", "body": "<p>I have a problem. I am following this code from someone: <a href=\"https://github.com/CrossGeeks/DragViewSample/tree/master/DragViewSample/DragViewSample\" rel=\"nofollow noreferrer\">https://github.com/CrossGeeks/DragViewSample/tree/master/DragViewSample/DragViewSample</a> to drag/drop labels, so I used this xaml:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;ContentPage xmlns=\"http://xamarin.com/schemas/2014/forms\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"\n             xmlns:local=\"clr-namespace:Memento.DraggableView\"\n             x:Class=\"MyApp.TestPage\"&gt;\n    &lt;AbsoluteLayout&gt;\n        &lt;StackLayout AbsoluteLayout.LayoutFlags=\"All\" x:Name=\"dragLayout\"\n                          AbsoluteLayout.LayoutBounds=\"0,0,1,1\" IsVisible=\"true\"\n                          VerticalOptions=\"FillAndExpand\"  HorizontalOptions=\"FillAndExpand\"&gt;\n            &lt;local:DraggableView x:Name=\"dragView\"  VerticalOptions=\"CenterAndExpand\"\n                          DragMode=\"Touch\" DragDirection=\"All\" &gt;\n                &lt;local:DraggableView.Content&gt;\n                    &lt;Label Text=\"Test Label\" TextColor=\"Black\" /&gt;\n                &lt;/local:DraggableView.Content&gt;\n            &lt;/local:DraggableView&gt;\n        &lt;/StackLayout&gt;\n    &lt;/AbsoluteLayout&gt;\n&lt;/ContentPage&gt;\n</code></pre>\n\n<p>But when I try to move the label, nothing happens!?\nI didn't add any C# code on the background, because I don't think that was neccesary. In his example he only uses c# for a listview, but I removed that, so....</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c#", "unity3d", "2d", "coroutine"], "comments": [{"owner": {"reputation": 354, "user_id": 12088786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3763fa775657867038a35239f23a26e?s=128&d=identicon&r=PG&f=1", "display_name": "barteezy", "link": "https://stackoverflow.com/users/12088786/barteezy"}, "edited": false, "score": 0, "creation_date": 1576099091, "post_id": 59292689, "comment_id": 104793011, "body": "I think this might be related to you changing the velocity in <code>FixedUpdate()</code>. Can you try deleting your <code>FixedUpdate()</code>"}, {"owner": {"reputation": 15, "user_id": 3089584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf63fc129b45f2643629a3856d4696?s=128&d=identicon&r=PG&f=1", "display_name": "Tycho 9000", "link": "https://stackoverflow.com/users/3089584/tycho-9000"}, "reply_to_user": {"reputation": 354, "user_id": 12088786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3763fa775657867038a35239f23a26e?s=128&d=identicon&r=PG&f=1", "display_name": "barteezy", "link": "https://stackoverflow.com/users/12088786/barteezy"}, "edited": false, "score": 0, "creation_date": 1576099838, "post_id": 59292689, "comment_id": 104793331, "body": "I tested removing it to see if there was a difference and I can&#39;t see one, <code>FixedUpdate()</code> should only be affecting the horizontal movement as I don&#39;t change the y component of the velocity unless I&#39;m looking at it wrong"}, {"owner": {"reputation": 303, "user_id": 11501893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b5d47cae85fc7ed1b014e1b068e301?s=128&d=identicon&r=PG&f=1", "display_name": "jmalenfant", "link": "https://stackoverflow.com/users/11501893/jmalenfant"}, "edited": false, "score": 0, "creation_date": 1576126316, "post_id": 59292689, "comment_id": 104799550, "body": "There&#39;s a video on YouTube you might find helpful: <a href=\"https://www.youtube.com/watch?v=7KiK0Aqtmzc\" rel=\"nofollow noreferrer\">Better jumping in Unity with four lines of code</a>"}, {"owner": {"reputation": 15, "user_id": 3089584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf63fc129b45f2643629a3856d4696?s=128&d=identicon&r=PG&f=1", "display_name": "Tycho 9000", "link": "https://stackoverflow.com/users/3089584/tycho-9000"}, "edited": false, "score": 0, "creation_date": 1576134771, "post_id": 59292689, "comment_id": 104802126, "body": "Ah yeah that works so much better than the one I was trying, way less floaty thanks"}], "owner": {"reputation": 15, "user_id": 3089584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49bf63fc129b45f2643629a3856d4696?s=128&d=identicon&r=PG&f=1", "display_name": "Tycho 9000", "link": "https://stackoverflow.com/users/3089584/tycho-9000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576093927, "creation_date": 1576092226, "last_edit_date": 1576093927, "question_id": 59292689, "link": "https://stackoverflow.com/questions/59292689/unity-c-jumping-coroutine-creates-floaty-jump", "title": "Unity C# jumping coroutine creates floaty jump", "body": "<p>I'm trying to implement a variable jump in unity and found this tutorial from a few years ago where the last one (called \"The Just Right\") looks like the exact jump I want (I'm making a small endless runner). </p>\n\n<p>Unfortunately I am having trouble figuring out how it works, as only part of the code is shown and since it's old no one is answering in the comments anymore. </p>\n\n<p>I figured out what jumpButtonPressed and jumpTime are, but I am stuck on what jumpVector could mean. </p>\n\n<p><strong>I have the jump working right now</strong>, but it seems floatier than the example looks like so I don't think I've substituted jumpVector correctly.</p>\n\n<p>This is the tutorial it's from: <a href=\"https://www.gamasutra.com/blogs/DanielFineberg/20150825/244650/Designing_a_Jump_in_Unity.php\" rel=\"nofollow noreferrer\">https://www.gamasutra.com/blogs/DanielFineberg/20150825/244650/Designing_a_Jump_in_Unity.php</a></p>\n\n<p>Here's what I have for it so far, the jump coroutine is basically the same as the one from the tutorial except instead of jumpVector I have Vector2.up + new Vector2(0, jumpDist). I can never seem to get jumps that feel nice and any advice would be good.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class PlayerController : MonoBehaviour {\n\n    [SerializeField]\n    private float speed = 3.0f;\n    [SerializeField]\n    private float jumpDist = 20.0f;\n    [SerializeField]\n    private float airTime = 0.5f;\n\n    private Rigidbody2D rigidbody;\n    private bool jumping = false;\n    private bool jumpBtnDown = false;\n\n    private void Start() {\n        rigidbody = GetComponent&lt;Rigidbody2D&gt;();\n    }\n\n    private void Update() {\n        //when space clicked, sets jumping and jumpBtnDown to true, starts jump coroutine\n        if(Input.GetKeyDown(KeyCode.Space) &amp;&amp; jumping == false) {\n            Debug.Log(\"jump button pressed\");\n            //rigidbody.AddForce(Vector2.up * jumpDist);\n            jumping = true;\n            jumpBtnDown = true;\n            StartCoroutine(jump());\n        }\n\n        //if space let go, sets jumpBtnDown to false so the jump coroutine can end early\n        if(Input.GetKeyUp(KeyCode.Space)) {\n            Debug.Log(\"jump button released\");\n            jumpBtnDown = false;\n        }\n\n    }\n\n    private void FixedUpdate() {\n        //basic movement for testing\n        float move = Input.GetAxisRaw(\"Horizontal\");\n\n        rigidbody.velocity = new Vector2(speed * move, rigidbody.velocity.y);\n    }\n\n    IEnumerator jump() {\n        Debug.Log(\"jump coroutine started\");\n        rigidbody.velocity = Vector2.zero;\n        float timer = 0;\n\n        while(jumpBtnDown == true &amp;&amp; timer &lt; airTime) {\n            float percentJumpCompleted = timer / airTime;\n\n            //this is the line that I don't think is working right and causing the jump to be floaty\n            Vector2 jumpVectorThisFrame = Vector2.Lerp((Vector2.up + new Vector2(0, jumpDist)), Vector2.zero, percentJumpCompleted);\n            rigidbody.AddForce(jumpVectorThisFrame);\n            timer += Time.deltaTime;\n            yield return null;\n        }\n\n        jumping = false;\n        Debug.Log(\"jump coroutine ended\");\n    }\n}\n</code></pre>\n\n<p>(I'm not testing for if the player is grounded yet so jumping forever is something this code currently allows for, but I plan to add that in once I get the jump working nicely)</p>\n"}, {"tags": ["c#", ".net", "docusignapi"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576095097, "post_id": 59292707, "comment_id": 104791406, "body": "Seems like the blog is attempting to address the issue but I dont see the additional values and the server template is not being sent"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576095271, "post_id": 59292707, "comment_id": 104791479, "body": "you can add tabs to the Signer object that you see in the C# code in this blog, a TextTab would be what you want, I think"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576095294, "post_id": 59292707, "comment_id": 104791491, "body": "or, you can add your text in a document, not a tab, there are a few ways to add text"}, {"owner": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576095696, "post_id": 59292707, "comment_id": 104791647, "body": "I literally copied and pasted and inserted my template id and file but the values dont show."}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576096211, "post_id": 59292707, "comment_id": 104791867, "body": "you mean the tab values right? you can add them, the code you copy/pasted doesn&#39;t do that"}, {"owner": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576096638, "post_id": 59292707, "comment_id": 104792041, "body": "I am referring to the blog you linked (<a href=\"https://www.docusign.com/blog/dsdev-from-the-trenches-composite-templates/\" rel=\"nofollow noreferrer\">docusign.com/blog/dsdev-from-the-trenches-composite-templat&zwnj;&#8203;es</a> ) which  adds tabs with values  to the signer object. The text Hourly Rate (180.00) does not show up in the doc"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 1, "creation_date": 1576099861, "post_id": 59292707, "comment_id": 104793343, "body": "the most likely reason is that the tabLabel doesn&#39;t match, but it can also be some other reason. If you download API Logs, these may have some information if you can get the template JSON"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576100090, "post_id": 59292707, "comment_id": 104793428, "body": "routingOrder must also match, make sure your template and the code has it in both cases."}, {"owner": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 0, "creation_date": 1576170341, "post_id": 59292707, "comment_id": 104821314, "body": "Yeah the role name didnt match, didnt realize I had to set it"}, {"owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "reply_to_user": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "edited": false, "score": 1, "creation_date": 1576257071, "post_id": 59292707, "comment_id": 104853306, "body": "great, do you want me to post an answer to this?"}], "tags": [], "owner": {"reputation": 7023, "user_id": 3255871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gzaC9.jpg?s=128&g=1", "display_name": "Inbar Gazit", "link": "https://stackoverflow.com/users/3255871/inbar-gazit"}, "is_accepted": false, "score": 1, "last_activity_date": 1576092328, "creation_date": 1576092328, "answer_id": 59292707, "question_id": 59292571, "link": "https://stackoverflow.com/questions/59292571/dynamically-add-text-to-docusign-template-in-c/59292707#59292707", "title": "Dynamically add text to docusign template in C#", "body": "<p>Best approach to do this is to use Composite Templates.\nWith composite templates, you can mix and match and customize your templates via the API in any way you choose.\nThis blog post would be a good place to start:</p>\n\n<p><a href=\"https://www.docusign.com/blog/dsdev-from-the-trenches-composite-templates/\" rel=\"nofollow noreferrer\">https://www.docusign.com/blog/dsdev-from-the-trenches-composite-templates/</a> and it has C# code to do something similar, but you can modify it for your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "is_accepted": true, "score": 1, "last_activity_date": 1576262345, "creation_date": 1576262345, "answer_id": 59328152, "question_id": 59292571, "link": "https://stackoverflow.com/questions/59292571/dynamically-add-text-to-docusign-template-in-c/59328152#59328152", "title": "Dynamically add text to docusign template in C#", "body": "<p>Thanks to Inbar Gazit, I realized that my role name was not matching what I set from the server side.</p>\n\n<pre><code>tRole.Name = \"testing\";\ntRole.RoleName = \"{ROLE}\" \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/6LZJJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6LZJJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>and the lable had to match as well.</p>\n\n<pre><code>textTab.TabLabel = \"Someones Address\"; \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/U4xW9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U4xW9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Fairly straight forward, just an over site. Hopefully this helps someone.</p>\n"}], "owner": {"reputation": 522, "user_id": 8066170, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/5c35b7d3e948b6a378e81f869bb5df34?s=128&d=identicon&r=PG&f=1", "display_name": "Curious-programmer", "link": "https://stackoverflow.com/users/8066170/curious-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 59328152, "answer_count": 2, "score": 0, "last_activity_date": 1576262578, "creation_date": 1576091692, "last_edit_date": 1576262578, "question_id": 59292571, "link": "https://stackoverflow.com/questions/59292571/dynamically-add-text-to-docusign-template-in-c", "title": "Dynamically add text to docusign template in C#", "body": "<p>Is it possible to dynamically add a text value to an existing docusign template ? </p>\n\n<p>I have an existing template that I retrieve from docusign, but I want to customize certain fields based on who I am sending it to.</p>\n\n<p>I have seen text Tabs being used, but in my case it is not succesfull and I am not sure if that only works, when creating the template within the code itself.</p>\n\n<pre><code>  EnvelopeDefinition envDef = new EnvelopeDefinition();\n            envDef.EmailSubject = \"[DocuSign C# SDK] - Please sign this doc\";\n\n\n            TemplateRole tRole = new TemplateRole();\n            tRole.Email = \"sample@gmail.com\";\n            tRole.Name = \"testing\";\n            tRole.RoleName = \"{ROLE}\";\n            List&lt;Text&gt; tabsTextList = new List&lt;Text&gt;();\n\n\n            tRole.Tabs = new Tabs();\n            tRole.Tabs.TextTabs = new List&lt;Text&gt;();\n            Text textTab = new Text();\n            textTab.TabLabel = \"Someones Address\";\n            textTab.Value = userName.Address;\n            textTab.XPosition = \"100\";\n            textTab.YPosition = \"100\";\n            tRole.Tabs.TextTabs.Add(textTab);\n\n            List&lt;TemplateRole&gt; rolesList = new List&lt;TemplateRole&gt;() { tRole };\n\n            // add the role to the envelope and assign valid templateId from your account\n            envDef.TemplateRoles = rolesList;\n\n            envDef.TemplateId = \"***679-987***\";\n</code></pre>\n"}, {"tags": ["c#", "linq", "xpath"], "comments": [{"owner": {"reputation": 1831, "user_id": 11102282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a4ukS.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/11102282/alejandro"}, "edited": false, "score": 1, "creation_date": 1576100564, "post_id": 59292553, "comment_id": 104793643, "body": "The question has unnecessary details. First, XPath prior 3.0 do not serialize, but selects or outputs scalar value instead. Because the relation between <code>LineItemNumber</code> and <code>PurchaseOrderNumber</code>, it looks like you want to group with aggregation. XPath can be used for grouping, but then you would need the host language to iterate over the the grouping keys and after that you would be able to use XPath again for aggregation."}, {"owner": {"reputation": 3, "user_id": 12258526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e963fb84f1e0c1c023d9f8c510ee5eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valentina Bishay", "link": "https://stackoverflow.com/users/12258526/valentina-bishay"}, "reply_to_user": {"reputation": 1831, "user_id": 11102282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a4ukS.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/11102282/alejandro"}, "edited": false, "score": 0, "creation_date": 1576174570, "post_id": 59292553, "comment_id": 104823230, "body": "hi, thanks for the comment:"}, {"owner": {"reputation": 3, "user_id": 12258526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e963fb84f1e0c1c023d9f8c510ee5eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valentina Bishay", "link": "https://stackoverflow.com/users/12258526/valentina-bishay"}, "reply_to_user": {"reputation": 1831, "user_id": 11102282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a4ukS.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/11102282/alejandro"}, "edited": false, "score": 0, "creation_date": 1576370100, "post_id": 59292553, "comment_id": 104878262, "body": "do you think which method should i use to aggregate?"}, {"owner": {"reputation": 1831, "user_id": 11102282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a4ukS.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/11102282/alejandro"}, "edited": false, "score": 0, "creation_date": 1576504961, "post_id": 59292553, "comment_id": 104910688, "body": "If you are able to use XSLT, look at <a href=\"https://stackoverflow.com/questions/15112496/xslt-for-grouping-and-summing-values\" title=\"xslt for grouping and summing values\">stackoverflow.com/questions/15112496/&hellip;</a>"}], "owner": {"reputation": 3, "user_id": 12258526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e963fb84f1e0c1c023d9f8c510ee5eb?s=128&d=identicon&r=PG&f=1", "display_name": "Valentina Bishay", "link": "https://stackoverflow.com/users/12258526/valentina-bishay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576369299, "creation_date": 1576091611, "last_edit_date": 1576369299, "question_id": 59292553, "link": "https://stackoverflow.com/questions/59292553/how-to-add-elements-to-the-line-item-using-xpath", "title": "How to add elements to the line item using XPATH", "body": "<p>How to add sum of all sublineitems bill of rating quantity and ladingquantity to main lineitem? </p>\n\n<p>Main line item is the line item where integer <code>&lt;LineItemNumber V=\"00000000000000000010\" /&gt;</code> equals integer after the pipe line | of <code>&lt;PurchaseOrderNumber V=\"0100230946|00010\" /&gt;</code> </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;Transmission&gt;\r\n  &lt;TransmissionSenderID V=\"Co\" /&gt;\r\n  &lt;TransmissionReceiverID V=\"8004171844\" /&gt;\r\n  &lt;InterchangeControlNumber V=\"1\" /&gt;\r\n  &lt;InterchangeCreationDate V=\"2019-11-15\" /&gt;\r\n  &lt;InterchangeCreationTime V=\"02:00:02\" /&gt;\r\n  &lt;TotalNumberOfGroupsInTransmission V=\"00001\" /&gt;\r\n  &lt;InterchangeUsageIndicator V=\"T\" /&gt;\r\n  &lt;Groups&gt;\r\n    &lt;Group&gt;\r\n      &lt;GroupSenderID V=\"Co\" /&gt;\r\n      &lt;GroupReceiverID V=\"8004171844\" /&gt;\r\n      &lt;GroupCreationDate V=\"2019-11-15\" /&gt;\r\n      &lt;GroupCreationTime V=\"02:00:02\" /&gt;\r\n      &lt;GroupControlNumber V=\"1\" /&gt;\r\n      &lt;TotalNumberOfShipmentsInGroup V=\"000005\" /&gt;\r\n      &lt;Documents&gt;\r\n        &lt;Document&gt;\r\n          &lt;DocumentHeader&gt;\r\n            &lt;InvoiceChargeType V=\"T\" /&gt;\r\n            &lt;DocumentType V=\"ORDER\" /&gt;\r\n            &lt;DocumentProcessingCode C=\"00\" /&gt;\r\n            &lt;BOLNumber V=\"BOL2309460180582136\" /&gt;\r\n            &lt;BOLIssueDate V=\"2019-11-14\" /&gt;\r\n            &lt;InvoiceNumber V=\"0180582136\" /&gt;\r\n            &lt;Mode C=\"S\" /&gt;\r\n            &lt;FreightTerms V=\"CC\" /&gt;\r\n            &lt;INCOTerms V=\"FOB\" /&gt;\r\n            &lt;DocumentTotal V=\"0.0\" /&gt;\r\n            &lt;CurrencyCode V=\"USD\" /&gt;\r\n            &lt;RequestedPickupDate V=\"2019-12-19\" /&gt;\r\n            &lt;RequestedDeliveryDate V=\"2019-12-31\" /&gt;\r\n            &lt;SpecialInstructions V=\"SHSV154946\" /&gt;\r\n            &lt;AlternateQuantities&gt;\r\n              &lt;AlternateQuantity Quantity=\"12.0\" UOM=\"PK\" UOMType=\"SQ\" Characteristic=\"\" /&gt;\r\n            &lt;/AlternateQuantities&gt;\r\n            &lt;Buyer Name=\"\" Q=\"ZP\" ID=\"COUSPO001\"&gt;\r\n              &lt;AlternateIDs /&gt;\r\n            &lt;/Buyer&gt;\r\n            &lt;Seller Name=\"\" Q=\"2\" ID=\"CNTR\"&gt;\r\n              &lt;AlternateIDs /&gt;\r\n            &lt;/Seller&gt;\r\n            &lt;Parties&gt;\r\n              &lt;Party PartyType=\"SF\"&gt;\r\n                &lt;Name V=\"SHA\" /&gt;\r\n                &lt;LocationID Q=\"\" ID=\"\" /&gt;\r\n                &lt;AlternateLocationIDs&gt;\r\n                  &lt;LocationID Q=\"\" ID=\"SHA\" /&gt;\r\n                &lt;/AlternateLocationIDs&gt;\r\n                &lt;City V=\"Shanghai\" /&gt;\r\n                &lt;Country V=\"CN\" /&gt;\r\n                &lt;LocationPurpose V=\"\" /&gt;\r\n              &lt;/Party&gt;\r\n              &lt;Party PartyType=\"ST\"&gt;\r\n                &lt;Name V=\"LEB\" /&gt;\r\n                &lt;LocationID Q=\"\" ID=\"\" /&gt;\r\n                &lt;AlternateLocationIDs&gt;\r\n                  &lt;LocationID Q=\"\" ID=\"LEB\" /&gt;\r\n                &lt;/AlternateLocationIDs&gt;\r\n                &lt;City V=\"Lebanon\" /&gt;\r\n                &lt;Country V=\"TN\" /&gt;\r\n                &lt;LocationPurpose V=\"\" /&gt;\r\n              &lt;/Party&gt;\r\n              &lt;Party PartyType=\"VN\"&gt;\r\n                &lt;Name V=\"YANGZHOU BAOYI SHOES\" /&gt;\r\n                &lt;LocationID Q=\"\" ID=\"4100000423\" /&gt;\r\n                &lt;AlternateLocationIDs /&gt;\r\n                &lt;City V=\"JIANGSU\" /&gt;\r\n                &lt;Country V=\"CN\" /&gt;\r\n                &lt;LocationPurpose V=\"\" /&gt;\r\n              &lt;/Party&gt;\r\n            &lt;/Parties&gt;\r\n            &lt;DateReferences&gt;\r\n              &lt;DR Type=\"D\" Q=\"ETA\" Date=\"2019-12-19\" /&gt;\r\n              &lt;DR Type=\"D\" Q=\"EST\" Date=\"2019-11-28\" /&gt;\r\n            &lt;/DateReferences&gt;\r\n            &lt;ReservedReferences&gt;\r\n              &lt;RR Type=\"R\" Q=\"K6\" V=\"86|SEAL230946\" /&gt;\r\n              &lt;RR Type=\"R\" Q=\"V3\" V=\"VYG230946|BKG230946\" /&gt;\r\n            &lt;/ReservedReferences&gt;\r\n          &lt;/DocumentHeader&gt;\r\n          &lt;Vessel VesselName=\"VSL230946\" VesselNumber=\"\" VesselCountryOfRegistration=\"\" VesselRegistrationNumber=\"\" /&gt;\r\n          &lt;Equipments&gt;\r\n            &lt;Equipment Initial=\"CNTR\" Number=\"230946\" Length=\"0\" Type=\"\" TotalContainerVolume=\"52.06\" /&gt;\r\n          &lt;/Equipments&gt;\r\n          &lt;LineItems&gt;\r\n\t\t\t&lt;LineItem&gt;\r\n\t\t\t  &lt;LineItemNumber V=\"00000000000000900001\" /&gt;\r\n\t\t\t  &lt;LineItemType C=\"LI\" /&gt;\r\n\t\t\t  &lt;LineItemSubType C=\"SCH\" /&gt;\r\n\t\t\t  &lt;TransportationServiceCode Code=\"\" /&gt;\r\n\t\t\t  &lt;PurchaseOrderNumber V=\"123456789|00020\" /&gt;\r\n\t\t\t  &lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n\t\t\t  &lt;DescriptionMarksAndNumbers&gt;\r\n\t\t\t\t&lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n\t\t\t\t&lt;BuyerProductID V=\"\" /&gt;\r\n\t\t\t  &lt;/DescriptionMarksAndNumbers&gt;\r\n\t\t\t  &lt;BilledRatedAsQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n\t\t\t  &lt;LadingQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n\t\t\t  &lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n\t\t\t  &lt;UserDefinedReferences&gt;\r\n\t\t\t\t&lt;UDR Type=\"U\" Q=\"CR\" V=\"22859470896|001|0001\" Description=\"\" /&gt;\r\n\t\t\t\t&lt;UDR Type=\"U\" Q=\"S6\" V=\"|3|20\" Description=\"\" /&gt;\r\n\t\t\t\t&lt;UDR Type=\"U\" Q=\"19\" V=\"M9160|USDS|0001\" Description=\"\" /&gt;\r\n\t\t\t  &lt;/UserDefinedReferences&gt;\r\n\t\t\t  &lt;LineItemWeight V=\"2959.54\" /&gt;\r\n\t\t\t  &lt;LineItemVolume V=\"104.12\" /&gt;\r\n\t\t\t&lt;/LineItem&gt;\r\n\t\t\t&lt;LineItem&gt;\r\n\t\t\t  &lt;LineItemNumber V=\"00000000000000900002\" /&gt;\r\n\t\t\t  &lt;LineItemType C=\"LI\" /&gt;\r\n\t\t\t  &lt;LineItemSubType C=\"SCH\" /&gt;\r\n\t\t\t  &lt;TransportationServiceCode Code=\"\" /&gt;\r\n\t\t\t  &lt;PurchaseOrderNumber V=\"123456789|00020\" /&gt;\r\n\t\t\t  &lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n\t\t\t  &lt;DescriptionMarksAndNumbers&gt;\r\n\t\t\t\t&lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n\t\t\t\t&lt;BuyerProductID V=\"\" /&gt;\r\n\t\t\t  &lt;/DescriptionMarksAndNumbers&gt;\r\n\t\t\t  &lt;BilledRatedAsQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n\t\t\t  &lt;LadingQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n\t\t\t  &lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n\t\t\t  &lt;UserDefinedReferences&gt;\r\n\t\t\t\t&lt;UDR Type=\"U\" Q=\"CR\" V=\"22859470896|001|0001\" Description=\"\" /&gt;\r\n\t\t\t\t&lt;UDR Type=\"U\" Q=\"S6\" V=\"|3|20\" Description=\"\" /&gt;\r\n\t\t\t\t&lt;UDR Type=\"U\" Q=\"19\" V=\"M9160|USDS|0001\" Description=\"\" /&gt;\r\n\t\t\t  &lt;/UserDefinedReferences&gt;\r\n\t\t\t  &lt;LineItemWeight V=\"2959.54\" /&gt;\r\n\t\t\t  &lt;LineItemVolume V=\"104.12\" /&gt;\r\n\t\t\t&lt;/LineItem&gt;\r\n\t\t\t&lt;LineItem&gt;\r\n\t\t\t  &lt;LineItemNumber V=\"00000000000000000020\" /&gt;\r\n\t\t\t  &lt;LineItemType C=\"LI\" /&gt;\r\n\t\t\t  &lt;TransportationServiceCode Code=\"\" /&gt;\r\n\t\t\t  &lt;PurchaseOrderNumber V=\"123456789|00020\" /&gt;\r\n\t\t\t  &lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n\t\t\t  &lt;DescriptionMarksAndNumbers&gt;\r\n\t\t\t\t&lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n\t\t\t\t&lt;BuyerProductID V=\"\" /&gt;\r\n\t\t\t  &lt;/DescriptionMarksAndNumbers&gt;\r\n\t\t\t  &lt;BilledRatedAsQuantity V=\"0.0\" UOM=\"PA\" /&gt;\r\n\t\t\t  &lt;LadingQuantity V=\"0.0\" UOM=\"PA\" /&gt;\r\n\t\t\t  &lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n\t\t\t  &lt;LineItemWeight V=\"0.00\" /&gt;\r\n\t\t\t  &lt;LineItemVolume V=\"0.00\" /&gt;\r\n\t\t\t&lt;/LineItem&gt;\r\n            &lt;LineItem&gt;\r\n              &lt;LineItemNumber V=\"00000000000000000010\" /&gt;\r\n              &lt;LineItemType C=\"LI\" /&gt;\r\n              &lt;TransportationServiceCode Code=\"\" /&gt;\r\n              &lt;PurchaseOrderNumber V=\"0100230946|00010\" /&gt;\r\n              &lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n              &lt;DescriptionMarksAndNumbers&gt;\r\n                &lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n                &lt;BuyerProductID V=\"\" /&gt;\r\n              &lt;/DescriptionMarksAndNumbers&gt;\r\n              &lt;BilledRatedAsQuantity V=\"0.0\" UOM=\"PA\" /&gt;\r\n              &lt;LadingQuantity V=\"0.0\" UOM=\"PA\" /&gt;\r\n              &lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n              &lt;LineItemWeight V=\"0.00\" /&gt;\r\n              &lt;LineItemVolume V=\"0.00\" /&gt;\r\n            &lt;/LineItem&gt;\r\n            &lt;LineItem&gt;\r\n              &lt;LineItemNumber V=\"00000000000000900001\" /&gt;\r\n              &lt;LineItemType C=\"LI\" /&gt;\r\n              &lt;LineItemSubType C=\"SCH\" /&gt;\r\n              &lt;TransportationServiceCode Code=\"\" /&gt;\r\n              &lt;PurchaseOrderNumber V=\"0100230946|00010\" /&gt;\r\n              &lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n              &lt;DescriptionMarksAndNumbers&gt;\r\n                &lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n                &lt;BuyerProductID V=\"\" /&gt;\r\n              &lt;/DescriptionMarksAndNumbers&gt;\r\n              &lt;BilledRatedAsQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n              &lt;LadingQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n              &lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n              &lt;UserDefinedReferences&gt;\r\n                &lt;UDR Type=\"U\" Q=\"CR\" V=\"22859470896|001|0001\" Description=\"\" /&gt;\r\n                &lt;UDR Type=\"U\" Q=\"S6\" V=\"|3|20\" Description=\"\" /&gt;\r\n                &lt;UDR Type=\"U\" Q=\"19\" V=\"M9160|USDS|0001\" Description=\"\" /&gt;\r\n              &lt;/UserDefinedReferences&gt;\r\n              &lt;LineItemWeight V=\"2959.54\" /&gt;\r\n              &lt;LineItemVolume V=\"104.12\" /&gt;\r\n            &lt;/LineItem&gt;\r\n            &lt;LineItem&gt;\r\n              &lt;LineItemNumber V=\"00000000000000900002\" /&gt;\r\n              &lt;LineItemType C=\"LI\" /&gt;\r\n              &lt;LineItemSubType C=\"SCH\" /&gt;\r\n              &lt;TransportationServiceCode Code=\"\" /&gt;\r\n              &lt;PurchaseOrderNumber V=\"0100230946|00010\" /&gt;\r\n              &lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n              &lt;DescriptionMarksAndNumbers&gt;\r\n                &lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n                &lt;BuyerProductID V=\"\" /&gt;\r\n              &lt;/DescriptionMarksAndNumbers&gt;\r\n              &lt;BilledRatedAsQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n              &lt;LadingQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n              &lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n              &lt;UserDefinedReferences&gt;\r\n                &lt;UDR Type=\"U\" Q=\"CR\" V=\"22859470902|001|0002\" Description=\"\" /&gt;\r\n                &lt;UDR Type=\"U\" Q=\"S6\" V=\"|3.5|20\" Description=\"\" /&gt;\r\n                &lt;UDR Type=\"U\" Q=\"19\" V=\"M9160|USDS|0001\" Description=\"\" /&gt;\r\n              &lt;/UserDefinedReferences&gt;\r\n              &lt;LineItemWeight V=\"2959.54\" /&gt;\r\n              &lt;LineItemVolume V=\"104.12\" /&gt;\r\n            &lt;/LineItem&gt;\r\n            &lt;LineItem&gt;\r\n              &lt;LineItemNumber V=\"00000000000000900003\" /&gt;\r\n              &lt;LineItemType C=\"LI\" /&gt;\r\n              &lt;LineItemSubType C=\"SCH\" /&gt;\r\n              &lt;TransportationServiceCode Code=\"\" /&gt;\r\n              &lt;PurchaseOrderNumber V=\"0100230946|00010\" /&gt;\r\n              &lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n              &lt;DescriptionMarksAndNumbers&gt;\r\n                &lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n                &lt;BuyerProductID V=\"\" /&gt;\r\n              &lt;/DescriptionMarksAndNumbers&gt;\r\n              &lt;BilledRatedAsQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n              &lt;LadingQuantity V=\"24.0\" UOM=\"PA\" /&gt;\r\n           ...</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>After the script  lineitems should look like:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;LineItems&gt;\r\n\t&lt;LineItem&gt;\r\n\t\t&lt;LineItemNumber V=\"00000000000000000020\" /&gt;\r\n\t\t&lt;LineItemType C=\"LI\" /&gt;\r\n\t\t&lt;TransportationServiceCode Code=\"\" /&gt;\r\n\t\t&lt;PurchaseOrderNumber V=\"123456789|00020\" /&gt;\r\n\t\t&lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n\t\t&lt;DescriptionMarksAndNumbers&gt;\r\n\t\t\t&lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n\t\t\t&lt;BuyerProductID V=\"\" /&gt;\r\n\t\t&lt;/DescriptionMarksAndNumbers&gt;\r\n\t\t&lt;BilledRatedAsQuantity V=\"48.0\" UOM=\"PA\" /&gt;\r\n\t\t&lt;LadingQuantity V=\"48.0\" UOM=\"PA\" /&gt;\r\n\t\t&lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n\t\t&lt;LineItemWeight V=\"0.00\" /&gt;\r\n\t\t&lt;LineItemVolume V=\"0.00\" /&gt;\r\n\t\t&lt;UserDefinedReferences&gt;\r\n\t\t\t&lt;UDR Type=\"U\" Q=\"19\" V=\"M9160|USDS|0001\" Description=\"\" /&gt;\r\n\t\t&lt;/UserDefinedReferences&gt;\r\n\t&lt;/LineItem&gt;\r\n\t&lt;LineItem&gt;\r\n\t\t&lt;LineItemNumber V=\"00000000000000000010\" /&gt;\r\n\t\t&lt;LineItemType C=\"LI\" /&gt;\r\n\t\t&lt;TransportationServiceCode Code=\"\" /&gt;\r\n\t\t&lt;PurchaseOrderNumber V=\"0100230946|00010\" /&gt;\r\n\t\t&lt;AdditionalReferenceNumber V=\"\" /&gt;\r\n\t\t&lt;DescriptionMarksAndNumbers&gt;\r\n\t\t\t&lt;CommodityCode Q=\"\" C=\"M9160\" /&gt;\r\n\t\t\t&lt;BuyerProductID V=\"\" /&gt;\r\n\t\t&lt;/DescriptionMarksAndNumbers&gt;\r\n\t\t&lt;BilledRatedAsQuantity V=\"144.0\" UOM=\"PA\" /&gt;\r\n\t\t&lt;LadingQuantity V=\"144.0\" UOM=\"PA\" /&gt;\r\n\t\t&lt;LineItemTotalAmount V=\"0.0\" /&gt;\r\n\t\t&lt;LineItemWeight V=\"0.00\" /&gt;\r\n\t\t&lt;LineItemVolume V=\"0.00\" /&gt;\r\n\t\t&lt;UserDefinedReferences&gt;\r\n\t\t\t&lt;UDR Type=\"U\" Q=\"19\" V=\"M9160|USDS|0001\" Description=\"\" /&gt;\r\n\t\t&lt;/UserDefinedReferences&gt;\r\n\t&lt;/LineItem&gt;\r\n&lt;/LineItems&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I tried to start in LINQ, but need guidance to use XPATH Addafterself</p>\n"}, {"tags": ["c#", ".net", "http", "web-crawler"], "comments": [{"owner": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576095194, "post_id": 59292476, "comment_id": 104791439, "body": "Hmmm...Stream dataStream is allocated with a using block and then reused after it is disposed. Not sure if that might be causing problems?"}, {"owner": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 1, "creation_date": 1576095758, "post_id": 59292476, "comment_id": 104791676, "body": "To clarify: The dataStream in the using block causes it to dispose which might be closing the connection"}, {"owner": {"reputation": 1370, "user_id": 7135977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a95d9f9f77f19d76c72da3a2a8782a?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Sasdy", "link": "https://stackoverflow.com/users/7135977/guillaume-sasdy"}, "reply_to_user": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576101623, "post_id": 59292476, "comment_id": 104793984, "body": "@Nikki9696 I thought the same, so I wrote the OP code against <code>https:&#47;&#47;httpbin.org&#47;post </code> and it works. I get the response back."}, {"owner": {"reputation": 153, "user_id": 11667403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9ZnolzFu2D8/AAAAAAAAAAI/AAAAAAAAAio/mukx-5JaVwo/photo.jpg?sz=128", "display_name": "Bruno Leyne", "link": "https://stackoverflow.com/users/11667403/bruno-leyne"}, "reply_to_user": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576102617, "post_id": 59292476, "comment_id": 104794310, "body": "@Nikki9696  I tried to use out of blocks, still no success. I already used this function in other crawlers, and it works good, but in this specific website that I&#39;m trying to get infos doesnt work the post, my get method works."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 11667403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9ZnolzFu2D8/AAAAAAAAAAI/AAAAAAAAAio/mukx-5JaVwo/photo.jpg?sz=128", "display_name": "Bruno Leyne", "link": "https://stackoverflow.com/users/11667403/bruno-leyne"}, "is_accepted": true, "score": 0, "last_activity_date": 1576171287, "creation_date": 1576171287, "answer_id": 59309830, "question_id": 59292476, "link": "https://stackoverflow.com/questions/59292476/c-httpwebrequest-the-underlying-connection-was-closed-a-connection-that-was-e/59309830#59309830", "title": "C# HttpWebRequest &quot;The underlying connection was closed: A connection that was expected to be kept alive was closed by the server.&quot;", "body": "<p>Found the solution:</p>\n\n<p>The website I was trying trying to crawl use http 1.0 instead of 1.1. Have to add to code:</p>\n\n<pre><code>request.ProtocolVersion = HttpVersion.Version10;\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 11667403, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9ZnolzFu2D8/AAAAAAAAAAI/AAAAAAAAAio/mukx-5JaVwo/photo.jpg?sz=128", "display_name": "Bruno Leyne", "link": "https://stackoverflow.com/users/11667403/bruno-leyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 59309830, "answer_count": 1, "score": 0, "last_activity_date": 1576171442, "creation_date": 1576091290, "last_edit_date": 1576171442, "question_id": 59292476, "link": "https://stackoverflow.com/questions/59292476/c-httpwebrequest-the-underlying-connection-was-closed-a-connection-that-was-e", "title": "C# HttpWebRequest &quot;The underlying connection was closed: A connection that was expected to be kept alive was closed by the server.&quot;", "body": "<p>I'm trying to build a web crawler that need two requests. First request is a GET(create session) and another is a POST(submit form). When I try to submit a form I get the error: </p>\n\n<pre><code>The underlying connection was closed: A connection that was expected to be kept alive was closed by the server.\n</code></pre>\n\n<p>I already tried to use TLS12, set keep alive to false, change timeout propety, but still don't work;\nThe stacktrace:</p>\n\n<pre><code>   at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)\n   at System.Net.FixedSizeReader.ReadPacket(Byte[] buffer, Int32 offset, Int32 count)\n   at System.Net.Security._SslStream.StartFrameHeader(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest)\n   at System.Net.Security._SslStream.StartReading(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest)\n   at System.Net.Security._SslStream.ProcessRead(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest)\n   at System.Net.TlsStream.Read(Byte[] buffer, Int32 offset, Int32 size)\n   at System.Net.PooledStream.Read(Byte[] buffer, Int32 offset, Int32 size)\n   at System.Net.Connection.SyncRead(HttpWebRequest request, Boolean userRetrievedStream, Boolean probeRead)\n</code></pre>\n\n<p>A print: </p>\n\n<p><a href=\"https://i.stack.imgur.com/K6pxU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K6pxU.png\" alt=\"enter image description here\"></a></p>\n\n<p>My request function:</p>\n\n<pre><code>public static string ObterHtmlPostTest(string url, string post, ref CookieContainer cookieContainer)\n        {\n            try\n            {\n                Encoding encoding = Encoding.UTF8;\n                string postData = post.ToString();\n                byte[] byteArray = encoding.GetBytes(postData);\n                string html = string.Empty;\n                var request = (HttpWebRequest)WebRequest.Create(url);\n                Stream dataStream;\n                StreamReader reader;\n                HttpWebResponse response;\n\n                NonValidatedWebHeader header = new NonValidatedWebHeader();\n                header.Add(\"Accept-Language\", \"pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7\");\n                request.Headers = header;\n                request.AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate;\n                request.CookieContainer = cookieContainer;\n                request.Method = \"POST\";\n                request.Accept = \"*/*\";\n                request.UserAgent = \"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36\";\n\n                request.Referer = url;\n                request.AllowAutoRedirect = true;\n                request.KeepAlive = true;\n                request.ContentType = \"application/x-www-form-urlencoded\";\n                request.ContentLength = byteArray.Length;\n\n                ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };\n\n                using (dataStream = request.GetRequestStream())\n                {\n                    dataStream.Write(byteArray, 0, byteArray.Length);\n                }\n\n                response = (HttpWebResponse)request.GetResponse();\n                cookieContainer.Add(response.Cookies);\n                dataStream = response.GetResponseStream();\n                reader = new StreamReader(dataStream, encoding);\n                html = reader.ReadToEnd();\n                reader.Close();\n                dataStream.Close();\n                response.Close();\n\n                return html;\n            }\n            catch (Exception ex)\n            {\n                throw;\n            }\n        }\n</code></pre>\n"}, {"tags": ["c#", "encapsulation", "access-rights"], "comments": [{"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576091541, "post_id": 59292407, "comment_id": 104789792, "body": "The MVVM pattern requires a lot of Plumbing code for classes. In particular, every property must be given change Notification and possibly a relay call to the Model class (the nested class for you). If one group knows of a good way to encapsulate stuff without too much writing work, it is WPF/UWP developers."}, {"owner": {"reputation": 812, "user_id": 1596045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2c1e43768a22cf234ddcf4a6306190?s=128&d=identicon&r=PG", "display_name": "PraveenB", "link": "https://stackoverflow.com/users/1596045/praveenb"}, "edited": false, "score": 0, "creation_date": 1576091689, "post_id": 59292407, "comment_id": 104789851, "body": "I think a proper example with some fields would make more sense. Is Sanitized accessing internal variables of complete than how could you use it across multiple classes.  What I could say is Sanitized has some rules (implemented as functions/prop) and it requires data that it will get from Complete. Sanitized should be independent of the class,  a generic class that just acts on data. How you pass the data is different topic ?"}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 2, "creation_date": 1576091848, "post_id": 59292407, "comment_id": 104789913, "body": "Does your new nested generic class even compile?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1576093547, "post_id": 59292407, "comment_id": 104790665, "body": "I was thinking the Decorator or Visitor patterns could be used here."}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 0, "creation_date": 1576093947, "post_id": 59292407, "comment_id": 104790850, "body": "@Dan if you can provide a little more clarity on existing samples then someone might be able to provide you a prototype of class design."}], "answers": [{"tags": [], "owner": {"reputation": 2824, "user_id": 2869055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2c7c67d2983e8db074cbb68daa86a1?s=128&d=identicon&r=PG", "display_name": "mwilczynski", "link": "https://stackoverflow.com/users/2869055/mwilczynski"}, "is_accepted": false, "score": 0, "last_activity_date": 1576095338, "last_edit_date": 1576095338, "creation_date": 1576094899, "answer_id": 59293307, "question_id": 59292407, "link": "https://stackoverflow.com/questions/59292407/reuse-of-a-nested-utility-class/59293307#59293307", "title": "Reuse of a nested utility class", "body": "<p>If what you're trying to achieve here is to narrow public API to only that data, that should be accessible from outside, how about introducing public interface, that is used in property signature?</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class FooContainer\n{\n   private Foo _myFoo;\n   public IFoo MyFoo =&gt; _myFoo;\n}\n\npublic class Foo : IFoo\n{\n   //This is visible in your public API\n   public bool NonSensitiveFlag { get; private set; }\n   public string NonSensitiveString { get; private set; }\n\n   //This is not visible due to not being present in IFoo definition\n   public string MySensitiveString { get; set; }\n}\n\npublic interface IFoo\n{\n   bool NonSensitiveFlag { get; }\n   string NonSensitiveString { get; }\n}\n</code></pre>\n\n<p>This of course, only somehow solves the problem you had in the beginning, no the issue with <code>SanitizedValue&lt;T&gt;</code> itself.</p>\n"}, {"tags": [], "owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "is_accepted": false, "score": 0, "last_activity_date": 1576097329, "last_edit_date": 1592644375, "creation_date": 1576097329, "answer_id": 59293843, "question_id": 59292407, "link": "https://stackoverflow.com/questions/59292407/reuse-of-a-nested-utility-class/59293843#59293843", "title": "Reuse of a nested utility class", "body": "<p>You're attempting to limit access via accessor instead of using a contract (interface).  It's much easier to limit the exposure of class properties, methods and fields by interface.</p>\n<p>In this example, I not only limited <code>Person</code> via <code>IPerson</code> but also limited <code>Person.SSN</code> by exposing only <code>ISensitiveString</code> not <code>SensitiveString</code></p>\n<p><a href=\"https://dotnetfiddle.net/Ig9Hzw\" rel=\"nofollow noreferrer\">DotNetFiddle Example</a></p>\n<pre class=\"lang-cs prettyprint-override\"><code>namespace One\n{\n    using System;\n\n    public class Program\n    {\n        public static void Main()\n        {\n            var person = Two.PersonFactory.Create(&quot;123-45-6789&quot;);\n            Console.WriteLine(person.SSN.Value);\n            // Console.WriteLine(person.SSN.RawValue); // 'ISensitiveString' does not contain a definition for 'RawValue' and no accessible extension method 'RawValue' accepting a first argument of type 'ISensitiveString' could be found\n        }\n    }\n}\n\nnamespace Two\n{\n    using System;\n    using System.Security.Cryptography;\n    \n    public static class PersonFactory\n    {\n        public static IPerson Create(string SSN)\n        {\n            var result = new Person();\n            result.SSN.RawValue = SSN;\n            \n            Console.WriteLine(result.SSN.RawValue);\n            Console.WriteLine(result.SSN.Value);\n            \n            return result;\n        }\n    }\n\n    public interface IPerson \n    {\n        ISensitiveString SSN { get; }\n    }\n\n    internal class Person : IPerson\n    {\n        ISensitiveString IPerson.SSN =&gt; SSN;\n\n        public SensitiveString SSN { get; set; } = new SensitiveString();\n    }\n\n    public interface ISensitiveString\n    {\n        string Value { get; }\n    }\n    \n    internal class SensitiveString : ISensitiveString\n    {\n        public string Value\n        {\n            get\n            {\n                string result;\n                using (var sha512 = SHA512.Create())\n                {\n                    var bytes = System.Text.Encoding.UTF8.GetBytes(RawValue);\n                    var hash = sha512.ComputeHash(bytes);\n                    var sb = new System.Text.StringBuilder(128);\n                    foreach (var b in hash)\n                        sb.Append(b.ToString(&quot;X2&quot;));\n                    result = sb.ToString();\n                }\n                return result;\n            }\n        }\n        \n        public string RawValue { get; set; }\n    }\n}\n</code></pre>\n<p>Ouput</p>\n<blockquote>\n<p>123-45-6789\nFBE47783B1D59D46DD437BDE9236A5404A8E8394F76E1C31D8421FD604D9BD1DF0C52DF5E5FD9C41879659D46C9A839266144E6C5FCAA678653290ED9EFFAEA7</p>\n<p>FBE47783B1D59D46DD437BDE9236A5404A8E8394F76E1C31D8421FD604D9BD1DF0C52DF5E5FD9C41879659D46C9A839266144E6C5FCAA678653290ED9EFFAEA7</p>\n</blockquote>\n"}], "owner": {"reputation": 840, "user_id": 2197315, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/dd60a5067b08b6d51468e552d936fc6a?s=128&d=identicon&r=PG", "display_name": "Dan Brenner", "link": "https://stackoverflow.com/users/2197315/dan-brenner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576097329, "creation_date": 1576091029, "last_edit_date": 1576091332, "question_id": 59292407, "link": "https://stackoverflow.com/questions/59292407/reuse-of-a-nested-utility-class", "title": "Reuse of a nested utility class", "body": "<p>I was designing a class where I wanted the properties to be accessible in a complete form internally to the class but only in a sanitized form externally. My first solution was to implement two different <code>get</code>ers with different access rights:</p>\n\n<pre><code>public class MyClass\n{   \n   private Foo CompleteFoo { get; set; }\n   public Foo SanitizedFoo =&gt; CompleteFoo.WithoutSensitiveInfo();\n}\n</code></pre>\n\n<p>As my class grew, it ended up with a lot properties like this, and having to define these accessors for each value became tiresome and made the class harder to read. So I decided to introduce a nested helper class:</p>\n\n<pre><code>public class MyClass\n{\n    private class SanitizedValue&lt;T&gt; where T : Sanitizable \n    {\n        private T Complete { get; set; }\n        public T Sanitized =&gt; T.WithoutSensitiveInfo();\n    }\n\n    public SanitizedValue&lt;Foo&gt; foo { get; }\n} \n</code></pre>\n\n<p>Now <code>MyClass</code> itself has access to both the <code>Sanitized</code> and <code>Complete</code> values, but external users only have access to the <code>Sanitized</code> value.</p>\n\n<p>The issue is that I find this <code>SanitizedValue</code> class to be a pretty useful utility, and something I might want to use in a variety of different classes in order to replicate the access-rights pattern. But because <code>SanitizedValue</code> has to be internal to <code>MyClass</code> in order to properly allow access to the <code>Complete</code> property, it seems like I would have to rewrite the <code>SanitizedValue</code> class for every parent that would want to use it.</p>\n\n<p>Is there a strategy to avoid this duplication of the internal class?</p>\n"}, {"tags": ["c#", ".net", "visual-studio", "zip"], "comments": [{"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576091656, "post_id": 59292403, "comment_id": 104789836, "body": "where is the file supposed to exist?"}, {"owner": {"reputation": 27, "user_id": 12447857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c051edd26da1ef2cfd34e5b8ded723?s=128&d=identicon&r=PG&f=1", "display_name": "CruZer0", "link": "https://stackoverflow.com/users/12447857/cruzer0"}, "reply_to_user": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576091836, "post_id": 59292403, "comment_id": 104789912, "body": "in theory in your downloads folder, because this program is supposed to install a mod for a game."}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576091906, "post_id": 59292403, "comment_id": 104789937, "body": "is the zip file present in the source of your directory: &quot;sourceZIP&quot;. Your Source directory is: <code>C:\\Users\\luca-\\OneDrive\\Visual Studio\\TF2DuckHitSound\\TF2DuckHitSound\\bin\\Release\\netcoreap&zwnj;&#8203;p3.0\\TF2DuckHitSound&zwnj;&#8203;2.1</code>"}, {"owner": {"reputation": 27, "user_id": 12447857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c051edd26da1ef2cfd34e5b8ded723?s=128&d=identicon&r=PG&f=1", "display_name": "CruZer0", "link": "https://stackoverflow.com/users/12447857/cruzer0"}, "reply_to_user": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576092209, "post_id": 59292403, "comment_id": 104790082, "body": "no actually dont. but that dosent make sense. why does c# autotarget the path that i used at the beginning."}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576092403, "post_id": 59292403, "comment_id": 104790156, "body": "Error message says that the file is not present :) Can you validate that it is with same name and retry your code"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576092460, "post_id": 59292403, "comment_id": 104790178, "body": "Please move the file to some place that can be accessed (outside of your Release folder) then try again."}, {"owner": {"reputation": 598, "user_id": 10008643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab005fef5de7bc17b121b7f345e237ba?s=128&d=identicon&r=PG&f=1", "display_name": "Merkle Groot", "link": "https://stackoverflow.com/users/10008643/merkle-groot"}, "edited": false, "score": 0, "creation_date": 1576128746, "post_id": 59292403, "comment_id": 104800166, "body": "Also, since it&#39;s a Users path, make sure that the process running the application has rights to that folder."}], "owner": {"reputation": 27, "user_id": 12447857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9c051edd26da1ef2cfd34e5b8ded723?s=128&d=identicon&r=PG&f=1", "display_name": "CruZer0", "link": "https://stackoverflow.com/users/12447857/cruzer0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576094295, "creation_date": 1576091015, "last_edit_date": 1576094295, "question_id": 59292403, "link": "https://stackoverflow.com/questions/59292403/c-error-could-not-find-a-part-of-the-path-in-a-written-program-that-should", "title": "C# | error &quot;Could not find a part of the path&quot; in a written program that should unzip an file", "body": "<pre><code>using System;\nusing System.IO.Compression;\n\nnamespace TF2DuckHitSound\n{\n    class Program\n    {\n\n        static void Main(string[] args)\n        {\n            int version = 1;\n            string sourcePath = @\".\\TF2DuckHitSounds2.1\\\";\n            string destPath = @\".\\steamapps\\common\\Team Fortress 2\\tf\\custom\\\";\n            string sourceZIP = @\".\\TF2DuckHitSound2.1\\duckhitsound.zip\";\n            string destPathAlt;\n            bool destPathExist;\n\n\n            Console.WriteLine($\"Installer for TF2DuckHitsound. Version {version}\");\n            Console.WriteLine(\"Looking for TF2 Directory...\");\n            if (System.IO.Directory.Exists(destPath))\n            {\n                destPathExist = true;\n            }\n            else\n            {\n                destPathExist = false;\n                Console.WriteLine(\"TF2 Directory not found!\");\n            }\n            if (destPathExist == true)\n            {\n                ZipFile.CreateFromDirectory(sourcePath, sourceZIP);\n                ZipFile.ExtractToDirectory(sourceZIP, destPath);\n            }\n            else\n            {\n                Console.WriteLine(\"Please enter the full path of your custom directory...\");\n                destPathAlt = Console.ReadLine();\n                ZipFile.CreateFromDirectory(sourcePath, sourceZIP);\n                ZipFile.ExtractToDirectory(sourceZIP, destPathAlt);\n            }\n            Console.ReadKey();\n\n        }\n    }\n}\n</code></pre>\n\n<p>Pls help. Here is the exact error code:</p>\n\n<blockquote>\n  <p>Could not find a part of the path 'C:\\Users\\luca-\\OneDrive\\Visual Studio\\TF2DuckHitSound\\TF2DuckHitSound\\bin\\Release\\netcoreapp3.0\\TF2DuckHitSound2.1\\duckhitsound.zip'.</p>\n</blockquote>\n"}, {"tags": ["c#", ".net-core", "ef-core-3.0"], "comments": [{"owner": {"reputation": 1596, "user_id": 196698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e2d9c7aae835b4a4130893bbb12039?s=128&d=identicon&r=PG", "display_name": "Zied", "link": "https://stackoverflow.com/users/196698/zied"}, "edited": false, "score": 0, "creation_date": 1576091646, "post_id": 59292391, "comment_id": 104789830, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/37527783/get-sql-code-from-an-entity-framework-core-iqueryablet\">Get SQL code from an Entity Framework Core IQueryable&lt;T&gt;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1596, "user_id": 196698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e2d9c7aae835b4a4130893bbb12039?s=128&d=identicon&r=PG", "display_name": "Zied", "link": "https://stackoverflow.com/users/196698/zied"}, "is_accepted": false, "score": 11, "last_activity_date": 1576091606, "creation_date": 1576091606, "answer_id": 59292551, "question_id": 59292391, "link": "https://stackoverflow.com/questions/59292391/net-core-3-ef-core-3-what-happened-to-querymodelgenerator-relationalquer/59292551#59292551", "title": ".NET Core 3 / EF.Core 3: what happened to `QueryModelGenerator`, `RelationalQueryModelVisitor` and etc", "body": "<p>Isn't supported anymore in EF 3.</p>\n\n<p>Here how to do it now</p>\n\n<pre><code>    public static string ToSql&lt;TEntity&gt;(this IQueryable&lt;TEntity&gt; query)\n    {\n        var enumerator = query.Provider.Execute&lt;IEnumerable&lt;TEntity&gt;&gt;(query.Expression).GetEnumerator();\n        var enumeratorType = enumerator.GetType();\n        var selectFieldInfo = enumeratorType.GetField(\"_selectExpression\", BindingFlags.NonPublic | BindingFlags.Instance) ?? throw new InvalidOperationException($\"cannot find field _selectExpression on type {enumeratorType.Name}\");\n        var sqlGeneratorFieldInfo = enumeratorType.GetField(\"_querySqlGeneratorFactory\", BindingFlags.NonPublic | BindingFlags.Instance) ?? throw new InvalidOperationException($\"cannot find field _querySqlGeneratorFactory on type {enumeratorType.Name}\");\n        var selectExpression = selectFieldInfo.GetValue(enumerator) as SelectExpression ?? throw new InvalidOperationException($\"could not get SelectExpression\");\n        var factory = sqlGeneratorFieldInfo.GetValue(enumerator) as IQuerySqlGeneratorFactory ?? throw new InvalidOperationException($\"could not get IQuerySqlGeneratorFactory\");\n        var sqlGenerator = factory.Create();\n        var command = sqlGenerator.GetCommand(selectExpression);\n        var sql = command.CommandText;\n        return sql;\n    }\n</code></pre>\n\n<p>See more here :\n<a href=\"https://stackoverflow.com/a/51583047/196698\">https://stackoverflow.com/a/51583047/196698</a>\n<a href=\"https://gist.github.com/rionmonster/2c59f449e67edf8cd6164e9fe66c545a#gistcomment-3059688\" rel=\"noreferrer\">https://gist.github.com/rionmonster/2c59f449e67edf8cd6164e9fe66c545a#gistcomment-3059688</a></p>\n"}], "owner": {"reputation": 1785, "user_id": 1834787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c06bd5ac140ad017a995d6aa83cd8aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Node.JS", "link": "https://stackoverflow.com/users/1834787/node-js"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1977, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1576091606, "creation_date": 1576090943, "question_id": 59292391, "link": "https://stackoverflow.com/questions/59292391/net-core-3-ef-core-3-what-happened-to-querymodelgenerator-relationalquer", "title": ".NET Core 3 / EF.Core 3: what happened to `QueryModelGenerator`, `RelationalQueryModelVisitor` and etc", "body": "<p>I'm wondering what happened to: <code>QueryModelGenerator</code>, <code>RelationalQueryModelVisitor</code> and <code>queryCompilationContext.CreateQuerymodelVisitor()</code> all seems to have vanished.</p>\n\n<p>I have the following code and I'm failing to try to convert it to .NET Core 3 from 2.2</p>\n\n<pre><code>public static string ToSql&lt;TEntity&gt;(this IQueryable&lt;TEntity&gt; query, DbContext dbCtx)\n{\n    var modelGenerator = dbCtx.GetService&lt;IQueryModelGenerator&gt;();\n    var queryModel = modelGenerator.ParseQuery(query.Expression);\n    var databaseDependencies = dbCtx.GetService&lt;DatabaseDependencies&gt;();\n    var queryCompilationContext = databaseDependencies.QueryCompilationContextFactory.Create(false);\n    var modelVisitor = (RelationalQueryModelVisitor) queryCompilationContext.CreateQueryModelVisitor();\n    modelVisitor.CreateQueryExecutor&lt;TEntity&gt;(queryModel);\n    var sql = modelVisitor.Queries.FirstOrDefault()?.ToString();\n    return sql;\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml", "mvvm"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12519591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fV-xH-r5T-Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdx0mgjrrJdBA4vlVeKYdetmIUquQ/photo.jpg?sz=128", "display_name": "Gianlu Ri", "link": "https://stackoverflow.com/users/12519591/gianlu-ri"}, "edited": false, "score": 0, "creation_date": 1576240463, "post_id": 59319336, "comment_id": 104845062, "body": "Thank you very much but I don&#39;t want to use Toolkit or Framework. I started learning VMMV recently and at this stage I would like to understand as much as possible by creating everything myself."}], "tags": [], "owner": {"reputation": 31, "user_id": 5864393, "user_type": "registered", "profile_image": "https://graph.facebook.com/1301965149829543/picture?type=large", "display_name": "Fabian P.", "link": "https://stackoverflow.com/users/5864393/fabian-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1576228393, "creation_date": 1576228393, "answer_id": 59319336, "question_id": 59292361, "link": "https://stackoverflow.com/questions/59292361/datagrid-with-button-redo-undo-for-the-cell-change/59319336#59319336", "title": "Datagrid with button redo/undo for the cell change", "body": "<p>If you are asking for a way to bind the event after editing a cell to a command, you should go with an Eventtrigger.</p>\n\n<p>Just add the binding to the trigger in your xaml:</p>\n\n<pre><code>      &lt;DataGrid x:Name=\"dataGrid_Car\"  Margin=\"10\" Grid.ColumnSpan=\"2\" ItemsSource=\"{Binding Path=Cars, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\" AutoGenerateColumns=\"False\" CanUserAddRows=\"False\"&gt;\n        &lt;i:Interaction.Triggers&gt;\n          &lt;i:EventTrigger EventName=\"CellEditEnding\"&gt;\n            &lt;i:InvokeCommandAction Command=\"{Binding SomeCommand}\"/&gt;\n          &lt;/i:EventTrigger&gt;\n        &lt;/i:Interaction.Triggers&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn x:Name=\"Constructor\" Header=\"Constructor\"  Width=\"*\" Binding=\"{Binding _constructor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"&gt;\n\n            &lt;/DataGridTextColumn&gt;\n\n            &lt;DataGridTextColumn x:Name=\"Model\" Header=\"Model\" Width=\"*\" Binding=\"{Binding model}\"&gt;\n\n            &lt;/DataGridTextColumn&gt;\n\n            &lt;DataGridTextColumn x:Name=\"Price\" Header=\"Price\" Width=\"*\" Binding=\"{Binding price}\"&gt;\n\n            &lt;/DataGridTextColumn&gt;\n\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n</code></pre>\n\n<p>And add a command to your ViewModel.\nIf you use mvvmlight you could just create a RelayCommand and do whatever you like with that.</p>\n"}], "owner": {"reputation": 1, "user_id": 12519591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fV-xH-r5T-Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdx0mgjrrJdBA4vlVeKYdetmIUquQ/photo.jpg?sz=128", "display_name": "Gianlu Ri", "link": "https://stackoverflow.com/users/12519591/gianlu-ri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576228393, "creation_date": 1576090821, "last_edit_date": 1576097687, "question_id": 59292361, "link": "https://stackoverflow.com/questions/59292361/datagrid-with-button-redo-undo-for-the-cell-change", "title": "Datagrid with button redo/undo for the cell change", "body": "<p>Hi I want create 2 button Redo and Undo. </p>\n\n<p>I am thinking of creating two stacks to handle the change into a Datagrid. But I don't know the event to manage the changed value into the cell(after focus).</p>\n\n<p>My xaml code Datagrid:</p>\n\n<pre><code>  &lt;DataGrid x:Name=\"dataGrid_Car\"  Margin=\"10\" Grid.ColumnSpan=\"2\" ItemsSource=\"{Binding Path=Cars, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\" AutoGenerateColumns=\"False\" CanUserAddRows=\"False\"&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridTextColumn x:Name=\"Constructor\" Header=\"Constructor\"  Width=\"*\" Binding=\"{Binding _constructor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"&gt;\n\n            &lt;/DataGridTextColumn&gt;\n\n            &lt;DataGridTextColumn x:Name=\"Model\" Header=\"Model\" Width=\"*\" Binding=\"{Binding model}\"&gt;\n\n            &lt;/DataGridTextColumn&gt;\n\n            &lt;DataGridTextColumn x:Name=\"Price\" Header=\"Price\" Width=\"*\" Binding=\"{Binding price}\"&gt;\n\n            &lt;/DataGridTextColumn&gt;\n\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Into ModelView the definition</p>\n\n<pre><code>private ObservableCollection&lt;Car&gt; _cars = null;\n    public ObservableCollection&lt;Car&gt; Cars\n    {\n        get { return _cars; }\n        set\n        {\n            _cars = value;\n            NotifyPropertyChanged();\n        }\n    }\n</code></pre>\n\n<p>My implementation for NotifyPropertyChanged():</p>\n\n<pre><code>   public event PropertyChangedEventHandler PropertyChanged;\n\n    protected void NotifyPropertyChanged([CallerMemberName] string propertyName = \"\")\n    {\n        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));\n    }\n</code></pre>\n"}, {"tags": ["c#", "json"], "comments": [{"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 0, "creation_date": 1576090884, "post_id": 59292349, "comment_id": 104789478, "body": "What is you game object look like?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1576090890, "post_id": 59292349, "comment_id": 104789480, "body": "Not every object is serializable.  What is this <code>Game</code> object?"}, {"owner": {"reputation": 8797, "user_id": 12270289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f90bXHFopV0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfStPF8S5OWF3hBzDu-oJeTx3xOfQ/photo.jpg?sz=128", "display_name": "Klaycon", "link": "https://stackoverflow.com/users/12270289/klaycon"}, "edited": false, "score": 3, "creation_date": 1576090977, "post_id": 59292349, "comment_id": 104789530, "body": "have you tried explicitly deserializing to a game object instead of .net object? <code>JsonConvert.DeserializeObject&lt;Game&gt;(x);</code>"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1576091089, "post_id": 59292349, "comment_id": 104789582, "body": "Okay, most of the types in your <code>Game</code> object can be serialized.  What are <code>GameHasPlayer</code> and <code>Move</code>?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 8797, "user_id": 12270289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f90bXHFopV0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfStPF8S5OWF3hBzDu-oJeTx3xOfQ/photo.jpg?sz=128", "display_name": "Klaycon", "link": "https://stackoverflow.com/users/12270289/klaycon"}, "edited": false, "score": 0, "creation_date": 1576091125, "post_id": 59292349, "comment_id": 104789603, "body": "@Klaycon that did it, I knew my game object wasn&#39;t too complex for it, I just thought I had to <code>Cast</code> my object but putting it here works fine."}], "answers": [{"comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1576091390, "post_id": 59292463, "comment_id": 104789732, "body": "Will accept in 6 minutes! I dunno what <code>&lt;&gt;</code> symbols mean calling a method like this, but it looks and acts like how I imagined the <code>Cast</code> to work so this is exactly what I needed and works perfect."}, {"owner": {"reputation": 8797, "user_id": 12270289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f90bXHFopV0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfStPF8S5OWF3hBzDu-oJeTx3xOfQ/photo.jpg?sz=128", "display_name": "Klaycon", "link": "https://stackoverflow.com/users/12270289/klaycon"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1576091555, "post_id": 59292463, "comment_id": 104789802, "body": "Feel free to peruse the C# Programming Guide&#39;s <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/generics/generic-type-parameters\" rel=\"nofollow noreferrer\">page</a> on generic type parameters if you&#39;d like to understand what <code>&lt;Game&gt;</code> means and why it solved the problem."}], "tags": [], "owner": {"reputation": 8797, "user_id": 12270289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f90bXHFopV0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfStPF8S5OWF3hBzDu-oJeTx3xOfQ/photo.jpg?sz=128", "display_name": "Klaycon", "link": "https://stackoverflow.com/users/12270289/klaycon"}, "is_accepted": true, "score": 2, "last_activity_date": 1576091606, "last_edit_date": 1576091606, "creation_date": 1576091238, "answer_id": 59292463, "question_id": 59292349, "link": "https://stackoverflow.com/questions/59292349/why-is-jsonconvert-deserialize-not-parsing-to-the-object-it-was-serialised-fro/59292463#59292463", "title": "Why is JsonConvert.Deserialize() not parsing to the object it was serialised from?", "body": "<p>Calling <code>JsonConvert.DeserializeObject(x);</code> with no generic type parameter will just deserialize it to the <code>Object</code> base class, which cannot be cast to a class deriving from it since it wasn't created as one.</p>\n\n<p>Instead, pass the method a <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/generics/generic-type-parameters\" rel=\"nofollow noreferrer\">type parameter</a> like this: <code>JsonConvert.DeserializeObject&lt;Game&gt;(x);</code> to explicitly tell the deserializer to create an instance of <code>Game</code>.</p>\n"}], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 59292463, "answer_count": 1, "score": 0, "last_activity_date": 1576095984, "creation_date": 1576090789, "last_edit_date": 1576095984, "question_id": 59292349, "link": "https://stackoverflow.com/questions/59292349/why-is-jsonconvert-deserialize-not-parsing-to-the-object-it-was-serialised-fro", "title": "Why is JsonConvert.Deserialize() not parsing to the object it was serialised from?", "body": "<p>I'm just exploring NewtonSoft - Why doesn't this work?</p>\n\n<pre><code>var x = JsonConvert.SerializeObject(MethodThatProducesGameInstance());\nvar y = JsonConvert.DeserializeObject(x);\nGame g = (Game)y; // Error here\n</code></pre>\n\n<p>I can't serialize a <code>Game</code> object to a string and then deserialize the string back to a <code>Game</code> object - I thought that was the whole point of converting to and from Json? What am I missing?</p>\n\n<p>My Game object is like so:</p>\n\n<pre><code>public class Game\n{\n    public Game()\n    {\n        Moves = new HashSet&lt;Move&gt;();\n        GameHasPlayers = new HashSet&lt;GameHasPlayer&gt;();\n    }\n\n    public int Id { get; set; }\n\n    public DateTime DateCreated { get; set; }\n\n    [StringLength(1024)]\n    public string Comment { get; set; }\n\n    public virtual ICollection&lt;Move&gt; Moves { get; set; }\n\n    public virtual ICollection&lt;GameHasPlayer&gt; GameHasPlayers { get; set; }\n}\n</code></pre>\n\n<p>and the JSON produced from it into <code>var x</code> is like this:</p>\n\n<pre><code>\"{\\\"Id\\\":3,\\\"DateCreated\\\":\\\"2019-11-13T14:31:54.303\\\",\\\"Comment\\\":\\\"First test game\\\",\\\"Moves\\\":[],\\\"GameHasPlayers\\\":[]}\"\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", "kendo-ui"], "answers": [{"tags": [], "owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "is_accepted": true, "score": 0, "last_activity_date": 1576101986, "creation_date": 1576101986, "answer_id": 59294820, "question_id": 59292295, "link": "https://stackoverflow.com/questions/59292295/how-to-pass-array-from-kendo-preflight-to-mvc-list-parameter/59294820#59294820", "title": "How to pass array from kendo preflight to MVC list parameter?", "body": "<p>Well, the problem is the same as seen <a href=\"https://stackoverflow.com/questions/28855763/how-to-pass-a-list-of-ids-in-a-ajax-request-to-the-server-in-mvc/28856506\">here</a> or <a href=\"https://stackoverflow.com/questions/56382671/how-to-pass-array-object-as-a-parameter-in-kendo-datasource-read-methods\">here</a>.  </p>\n\n<p>As pointed out in <a href=\"https://docs.telerik.com/kendo-ui/api/javascript/data/datasource/configuration/transport.read\" rel=\"nofollow noreferrer\">the documentation</a> the read transport is a wrapper to jquery ajax method, so (some of) the same configuration parameters can be passed through. The fix is to pass <code>traditional: true</code> to the read transport configuration. This is not possible using the MVC wrappers, so you have to define the kendo widget in javascript. </p>\n\n<p>I tried setting the option after the widget was initialized like in <a href=\"https://www.telerik.com/forums/changing-the-contenttype-in-the-http-request#db5uWGfZIUmIOkEz91V8ig\" rel=\"nofollow noreferrer\">this post</a> but couldn't get this to work:  </p>\n\n<pre class=\"lang-js prettyprint-override\"><code>multiselect.dataSource.transport.options.read.traditional = true; // doesn't do anything    \n</code></pre>\n\n<p>I also tried to use <code>JSON.stringify</code> instead of <code>traditional</code> but couldn't ever get a working request. In the end, I had to (1) change from MVC to javascript definition of the widget and (2) add <code>traditional: true</code> to transport options. The view now looks like</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div id=\"personnelWrapper\" name=\"personnel\"&gt;&lt;/div&gt;\n&lt;script&gt;\n    $(\"#personnelWrapper\").kendoMultiSelect({\n        \"filter\": \"contains\",\n        \"placeholder\": \"Select an option...\",\n        \"dataTextField\": \"@nameof(PersonnelEmployerViewModel.DisplayName)\",\n        \"dataValueField\": \"@nameof(PersonnelEmployerViewModel.PersonnelId)\",\n        \"minLength\": 2,\n        \"value\": [@(string.Join(\",\", Model.Select(x =&gt; x.PersonnelId)))],\n        \"dataSource\": {\n            \"transport\": {\n                \"read\": {\n                    \"url\": \"@(Url.Action(nameof(PersonnelController.GetCompanyPersonnelMany),\n                          ControllerName.Personnel) )\",\n                    \"dataType\": \"json\",\n                    \"data\":employeeComboDataPreFlight,\n                    \"traditional\": true, // &lt;- this is the solution\n                },\n                \"prefix\":\"\"\n            },\n            \"serverFiltering\":true,\n            \"filter\":[],\n            \"schema\":{\n                \"errors\":\"Errors\"\n            }\n        }\n    });\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 59294820, "answer_count": 1, "score": 0, "last_activity_date": 1576144410, "creation_date": 1576090490, "last_edit_date": 1576144410, "question_id": 59292295, "link": "https://stackoverflow.com/questions/59292295/how-to-pass-array-from-kendo-preflight-to-mvc-list-parameter", "title": "How to pass array from kendo preflight to MVC list parameter?", "body": "<p>I have a web endpoint</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public JsonResult GetCompanyPersonnelMany(string text, IEnumerable&lt;int&gt; includeIds)\n{\n</code></pre>\n\n<p>I want to pass some data from a kendo multiselect. The multi select uses server side filtering; it uses a remote datasource; and it needs to process the data pre-flight.</p>\n\n<p>My problem is that the <code>text</code> parameter will be set, but <code>includeIds</code> is always empty.</p>\n\n<p>The pre-flight method looks like</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>var employeeComboDataPreFlight_loading = true;\nfunction employeeComboDataPreFlight() {\n    var data = multiSelectPreFlightCommon(getMultiSelectByName('personnel'));\n    if (employeeComboDataPreFlight_loading) { data.includeIds = [568,572,585] || []; }\n    return data;\n}\n</code></pre>\n\n<p>The multiselect is defined in the view as </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>@(Html.Kendo().MultiSelect()\n    .Name(\"personnel\")\n    .Filter(FilterType.Contains)\n    .Placeholder(\"Select an option...\")\n    .DataTextField(nameof(PersonnelEmployerViewModel.DisplayName))\n    .DataValueField(nameof(PersonnelEmployerViewModel.PersonnelId))\n    .MinLength(2)\n    .Value(Model.Select(x =&gt; x.PersonnelId))\n    .DataSource(source =&gt;\n    {\n      source.Read(read =&gt;\n      {\n          read.Action(nameof(PersonnelController.GetCompanyPersonnelMany),\n              ControllerName.Personnel\n              )\n          .Data(\"employeeComboDataPreFlight\")\n          ;\n      })\n      .ServerFiltering(true);\n    })\n    )\n</code></pre>\n\n<p>Evaluating the pre-flight method (in chrome console) shows the following:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&gt; employeeComboDataPreFlight()\n&lt;- {text: \"\", includeIds: Array(3)}\n    includeIds: Array(3)\n      0: 568\n      1: 572\n      2: 585\n&gt; JSON.stringify(employeeComboDataPreFlight())\n&lt;- \"{\"text\":\"\",\"includeIds\":[568,572,585]}\"\n</code></pre>\n\n<p>Opening the chrome network tab, it shows Query String Parameters:  </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>text:\nincludeIds[]: 568\nincludeIds[]: 572\nincludeIds[]: 585\n</code></pre>\n\n<p>And my request URL:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Request URL: https://localhost:44363/Personnel/GetCompanyPersonnelMany?text=&amp;includeIds%5B%5D=568&amp;includeIds%5B%5D=572&amp;includeIds%5B%5D=585\n</code></pre>\n\n<p>So it looks like there is an array of data for a variable named <code>includeIds</code> being sent to the server.  </p>\n\n<p>My problem is that the controller isn't getting the the <code>includeIds</code> parameter (the <code>text</code> parameter works correctly), the List is always empty (non-null, length: 0). How do I get the kendo multiselect to pass my javascript array into a format the controller will accept?</p>\n"}, {"tags": ["c#", "entity-framework", "ef-code-first", "asp.net-mvc-5.2"], "comments": [{"owner": {"reputation": 2824, "user_id": 2869055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2c7c67d2983e8db074cbb68daa86a1?s=128&d=identicon&r=PG", "display_name": "mwilczynski", "link": "https://stackoverflow.com/users/2869055/mwilczynski"}, "edited": false, "score": 0, "creation_date": 1576095702, "post_id": 59292281, "comment_id": 104791655, "body": "I would recommend introducing independent property for primary key for both <code>AdverseEvent</code> and <code>FullBloodCount</code>."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1576098496, "post_id": 59292281, "comment_id": 104792785, "body": "Please also show the code that populates the tables."}], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 2044140, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fa78acab3ab8f23498d6c1393049752d?s=128&d=identicon&r=PG&f=1", "display_name": "Damian70", "link": "https://stackoverflow.com/users/2044140/damian70"}, "is_accepted": false, "score": 0, "last_activity_date": 1576146960, "creation_date": 1576146960, "answer_id": 59302653, "question_id": 59292281, "link": "https://stackoverflow.com/questions/59292281/adding-a-second-one-to-one-relationship-with-table-entity-framework-6-fluent-api/59302653#59302653", "title": "Adding a second one-to-one relationship with table Entity Framework 6 fluent api", "body": "<p>I've resolved this issue, it wasn't related to the fluent API code that I was working on at the time - it was related to a DateTime problem.</p>\n"}], "owner": {"reputation": 327, "user_id": 2044140, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fa78acab3ab8f23498d6c1393049752d?s=128&d=identicon&r=PG&f=1", "display_name": "Damian70", "link": "https://stackoverflow.com/users/2044140/damian70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576146960, "creation_date": 1576090420, "last_edit_date": 1576092570, "question_id": 59292281, "link": "https://stackoverflow.com/questions/59292281/adding-a-second-one-to-one-relationship-with-table-entity-framework-6-fluent-api", "title": "Adding a second one-to-one relationship with table Entity Framework 6 fluent api", "body": "<p>I've been task with creating a web app using code-first, I've added a first one-to-one relationship which works as I expected, I then added a second one-to-one relationship but can't get it to work.</p>\n\n<p>Here are my models (most properties removed for brevity)...</p>\n\n<p><strong><em>FollowUpAssessment.cs</em></strong></p>\n\n<pre><code>public class FollowUpAssessment\n{\n    [Key]\n    public int FollowUpAssessmentId { get; set; }\n    public virtual FullBloodCount FullBloodCount { get; set; }\n    public virtual AdverseEvent AdverseEvent { get; set; }\n}\n</code></pre>\n\n<p><strong><em>FullBloodCount.cs</em></strong></p>\n\n<pre><code>public class FullBloodCount\n{\n    [Key]\n    [ForeignKey(\"FollowUpAssessment\")]\n    public int FollowUpAssessmentId { get; set; }\n\n    public virtual FollowUpAssessment FollowUpAssessment { get; set; }\n}\n</code></pre>\n\n<p><strong><em>AdverseEvent.cs</em></strong></p>\n\n<pre><code>public class AdverseEvent\n{\n    [Key]\n    [ForeignKey(\"FollowUpAssessment\")]\n    public int FollowUpAssessmentId { get; set; }\n\n    public virtual FollowUpAssessment FollowUpAssessment { get; set; }\n}\n</code></pre>\n\n<p><strong><em>Context</em></strong></p>\n\n<pre><code>protected override void OnModelCreating(DbModelBuilder modelBuilder)\n{\n        base.OnModelCreating(modelBuilder);\n\n        modelBuilder.Entity&lt;FollowUpAssessment&gt;()\n                    .HasOptional(s =&gt; s.FullBloodCount)\n                    .WithRequired(s =&gt; s.FollowUpAssessment);\n\n        modelBuilder.Entity&lt;FollowUpAssessment&gt;()\n                    .HasOptional(s =&gt; s.AdverseEvent)\n                    .WithRequired(s =&gt; s.FollowUpAssessment);\n}\n</code></pre>\n\n<p>When adding a follow up the full blood count data is added to its table correctly with the foreign key, but try as I may I cannot seem to make the adverse event data populate the table.</p>\n\n<p>I've spent most of today looking at this, and have search the internet and only seem able to find .NET Core solutions for this. I'm having to work with .NET 4.7.1, MVC 5 and EF 6.2.0 to complete this task. I would be grateful for any suggestions to make it work as needed thanks!</p>\n"}, {"tags": ["c#", "list", "linq", "boolean", "logical-operators"], "comments": [{"owner": {"reputation": 10256, "user_id": 1043380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2388aa1beb9ac75029a5b4fafec11eec?s=128&d=identicon&r=PG", "display_name": "gunr2171", "link": "https://stackoverflow.com/users/1043380/gunr2171"}, "edited": false, "score": 4, "creation_date": 1576090409, "post_id": 59292249, "comment_id": 104789314, "body": "Do you know about <code>.Zip()</code>?"}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "reply_to_user": {"reputation": 10256, "user_id": 1043380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2388aa1beb9ac75029a5b4fafec11eec?s=128&d=identicon&r=PG", "display_name": "gunr2171", "link": "https://stackoverflow.com/users/1043380/gunr2171"}, "edited": false, "score": 0, "creation_date": 1576090459, "post_id": 59292249, "comment_id": 104789332, "body": "@gunr2171 not really. Let me look it up."}, {"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1576090759, "post_id": 59292249, "comment_id": 104789445, "body": "Attempting to synchronize lists of the same length is usually a symptom of <a href=\"https://refactoring.guru/smells/primitive-obsession\" rel=\"nofollow noreferrer\">primitive obsession</a> and is solved by creating a class that contains the data. Properties like the logical OR of two values can be class properties."}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "reply_to_user": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1576091102, "post_id": 59292249, "comment_id": 104789592, "body": "@DourHighArch, the lists are in fact properties of a class. I&#39;m developing a WPF app with a datagrid, where I show/hide columns depending on the contents of these lists. The datagrid displays contents of files, and since I don&#39;t know which files user will select, I don&#39;t know how many columns there will be in advance."}], "answers": [{"comments": [{"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 1, "creation_date": 1576090552, "post_id": 59292293, "comment_id": 104789369, "body": "How would I extend this to 3 or more lists? Suppose I have 5 or even 20?"}, {"owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "reply_to_user": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1576090758, "post_id": 59292293, "comment_id": 104789444, "body": "@Sach IMO, in this case the regular loop will be more readable:) but let me think about it"}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 2, "creation_date": 1576090850, "post_id": 59292293, "comment_id": 104789470, "body": "I came up with this <code>var result = (list1.Zip(list2, (first, second) =&gt; first || second)).Zip(list3, (first, second) =&gt; first || second);</code> which I guess is fine for 3 the most, but beyond that it does look like good old for loops will in fact be clearer to understand."}], "tags": [], "owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "is_accepted": false, "score": 3, "last_activity_date": 1588953481, "last_edit_date": 1588953481, "creation_date": 1576090476, "answer_id": 59292293, "question_id": 59292249, "link": "https://stackoverflow.com/questions/59292249/logical-or-on-two-lists-of-boolean/59292293#59292293", "title": "Logical OR on two lists of boolean", "body": "<p>You can try <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.zip?view=netframework-4.8\" rel=\"nofollow noreferrer\"><code>IEnumerable.Zip</code></a> for that</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var result = list1.Zip(list2, (first, second) =&gt; first || second);\n</code></pre>\n\n<p>It produces a result sequence by applying a logical OR to every pair of elements from two source sequences.</p>\n"}, {"comments": [{"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1576091290, "post_id": 59292456, "comment_id": 104789682, "body": "Perfect, this is really what I wanted."}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "reply_to_user": {"reputation": 10256, "user_id": 1043380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2388aa1beb9ac75029a5b4fafec11eec?s=128&d=identicon&r=PG", "display_name": "gunr2171", "link": "https://stackoverflow.com/users/1043380/gunr2171"}, "edited": false, "score": 0, "creation_date": 1576091315, "post_id": 59292456, "comment_id": 104789695, "body": "@gunr2171, I think it was by about 20s. Haha."}, {"owner": {"reputation": 15450, "user_id": 11178549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N3P6o.png?s=128&g=1", "display_name": "Theodor Zoulias", "link": "https://stackoverflow.com/users/11178549/theodor-zoulias"}, "edited": false, "score": 0, "creation_date": 1576091941, "post_id": 59292456, "comment_id": 104789955, "body": "Instead of <code>ZipMultiple</code> you could name it with something having &quot;Or&quot; as a component. Or even simply <code>Or</code>."}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "reply_to_user": {"reputation": 15450, "user_id": 11178549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N3P6o.png?s=128&g=1", "display_name": "Theodor Zoulias", "link": "https://stackoverflow.com/users/11178549/theodor-zoulias"}, "edited": false, "score": 1, "creation_date": 1576092042, "post_id": 59292456, "comment_id": 104790013, "body": "@TheodorZoulias: That makes sense. Let me think about it a bit. Sounds like a good candidate for a high-order function."}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "reply_to_user": {"reputation": 15450, "user_id": 11178549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N3P6o.png?s=128&g=1", "display_name": "Theodor Zoulias", "link": "https://stackoverflow.com/users/11178549/theodor-zoulias"}, "edited": false, "score": 0, "creation_date": 1576093995, "post_id": 59292456, "comment_id": 104790871, "body": "@TheodorZoulias: Let me know what you think of the edit."}, {"owner": {"reputation": 15450, "user_id": 11178549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N3P6o.png?s=128&g=1", "display_name": "Theodor Zoulias", "link": "https://stackoverflow.com/users/11178549/theodor-zoulias"}, "edited": false, "score": 0, "creation_date": 1576094908, "post_id": 59292456, "comment_id": 104791313, "body": "Two words: I approve. \ud83d\ude03"}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 0, "creation_date": 1576095369, "post_id": 59292456, "comment_id": 104791531, "body": "Thanks for making the suggestion."}], "tags": [], "owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "is_accepted": true, "score": 3, "last_activity_date": 1576093938, "last_edit_date": 1576093938, "creation_date": 1576091209, "answer_id": 59292456, "question_id": 59292249, "link": "https://stackoverflow.com/questions/59292249/logical-or-on-two-lists-of-boolean/59292456#59292456", "title": "Logical OR on two lists of boolean", "body": "<p>In a comment on Pavel Anikhouski's answer, you mentioned multiple lists.  I'll expand on that answer by using the <code>Aggregate</code> extension method.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static IEnumerable&lt;bool&gt; OrBooleanSequences(IEnumerable&lt;IEnumerable&lt;bool&gt;&gt; source)\n{\n    return source.Aggregate((a, b) =&gt; a.Zip(b, (x, y) =&gt; x || y));\n}\n</code></pre>\n\n<p>Simply pass the lists as an array or other enumerable and then reify the result.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var list1 = new List&lt;bool&gt;() { true, false, true, false, false, false };\nvar list2 = new List&lt;bool&gt;() { true, true, true, false, true, false };\nvar list3 = new List&lt;bool&gt;() { false, true, false, true, true, false };\n\nvar result = ZipMultiple(new[] { list1, list2, list3 }).ToList();\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>On @Theodor Zoulias's recommendation, I've renamed the method above. I chose <code>OrBooleanSequences</code>.  The name is fairly arbitrary, though, so if you use it and you want to name it something else that makes better sense to you, more power to you.</p>\n\n<p>And so, this leads to a more generalized method that I'll call <code>AggregateSequences</code> and it would be a high-order function taking a function that describes how to perform the aggregation (<code>resultSelector</code> here and in the <code>Zip</code> overloads).</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static IEnumerable&lt;TSource&gt; AggregateSequences&lt;TSource&gt;(IEnumerable&lt;IEnumerable&lt;TSource&gt;&gt; source, Func&lt;TSource, TSource, TSource&gt; resultSelector)\n{\n    return source.Aggregate((a, b) =&gt; a.Zip(b, resultSelector));\n}\n</code></pre>\n\n<p>...and you would pass the logical OR operation to it as a lambda.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var result = AggregateSequences(new[] { list1, list2, list3 }, (x, y) =&gt; x || y).ToList();\n</code></pre>\n\n<p>This could be used for other operations, like summing elements in a list:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var list1 = new List&lt;int&gt;() { 1, 2, 3 };\nvar list2 = new List&lt;int&gt;() { 4, 5, 6 };\nvar list3 = new List&lt;int&gt;() { 7, 8, 9 };\n\nvar result = AggregateSequences(new[] { list1, list2, list3 }, (x, y) =&gt; x + y).ToList();\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>[ 12, 15, 18 ]\n</code></pre>\n\n<p>This method is just one variation, of course.  <code>Zip</code> and <code>Aggregate</code> have multiple overloads that could be combined.  I'm not sure all combinations make sense but I'll leave that as an exercise to the reader.</p>\n"}, {"tags": [], "owner": {"reputation": 10256, "user_id": 1043380, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2388aa1beb9ac75029a5b4fafec11eec?s=128&d=identicon&r=PG", "display_name": "gunr2171", "link": "https://stackoverflow.com/users/1043380/gunr2171"}, "is_accepted": false, "score": 2, "last_activity_date": 1576091230, "creation_date": 1576091230, "answer_id": 59292461, "question_id": 59292249, "link": "https://stackoverflow.com/questions/59292249/logical-or-on-two-lists-of-boolean/59292461#59292461", "title": "Logical OR on two lists of boolean", "body": "<p>Let's say you have a list of lists:</p>\n\n<pre><code>var listsOfLists = new List&lt;IEnumerable&lt;bool&gt;&gt;\n{\n    new List&lt;bool&gt;() { true, false, true, false, false },\n    new List&lt;bool&gt;() { true, true, true, false, true },\n    new List&lt;bool&gt;() { true, false, true, false, false },\n    new List&lt;bool&gt;() { true, false, true, true, true }\n};\n</code></pre>\n\n<p>Using Linq you can use a combination of <code>Aggregate</code> and <code>Zip</code></p>\n\n<pre><code>var combinedResults = listsOfLists\n    .Aggregate((a, b) =&gt; a\n        .Zip(b, (aElement, bElement) =&gt; aElement || bElement)\n     );\n</code></pre>\n\n<p><code>Zip</code> will pair every element in the two selected lists and run the \"or\" operator against those element pairs, giving you a new bool list. That resulting list will be used in the next Aggregate operation.</p>\n"}], "owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 1, "accepted_answer_id": 59292456, "answer_count": 3, "score": 0, "last_activity_date": 1588953481, "creation_date": 1576090292, "last_edit_date": 1584897863, "question_id": 59292249, "link": "https://stackoverflow.com/questions/59292249/logical-or-on-two-lists-of-boolean", "title": "Logical OR on two lists of boolean", "body": "<p>I have two <code>bool</code> lists, both of which will always be of the same length. Suppose these are my two lists:</p>\n\n<pre><code>var list1 = new List&lt;bool&gt;() { true, false, true, false, false };\nvar list2 = new List&lt;bool&gt;() { true, true, true, false, true };\n</code></pre>\n\n<p>I'd like to create a new list by applying the logical <code>OR</code> operator to each corresponding index on either list. So, if my two lists were the above, my expected result would be the following.</p>\n\n<blockquote>\n  <p>true, true, true, false, true</p>\n</blockquote>\n\n<p>Now, I can easily do this by using a <code>for</code> loop like this:</p>\n\n<pre><code>var result = new List&lt;bool&gt;();\nfor (int i = 0; i &lt; list1.Count; i++)\n{\n    result.Add(list1[i] || list2[i]);\n}\n</code></pre>\n\n<p>This works perfectly well, and isn't even necessarily inefficient. But in my application I have more than 2 lists, even 20 sometimes, and I'll need to get the <code>OR</code> of all of them.</p>\n\n<p>Is there an easier way of doing this, considering all lists?</p>\n"}, {"tags": ["c#", ".net-core", "mocking", "nsubstitute"], "comments": [{"owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "edited": false, "score": 1, "creation_date": 1576094207, "post_id": 59292245, "comment_id": 104790976, "body": "Have you tried to use <code>Arg.Any&lt;ValueType&gt;</code>? Since <code>FormattedLogValues</code> is <code>struct</code>"}, {"owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "edited": false, "score": 1, "creation_date": 1576094618, "post_id": 59292245, "comment_id": 104791182, "body": "There is GitHub <a href=\"https://github.com/nsubstitute/NSubstitute/issues/597\" rel=\"nofollow noreferrer\">issue</a> for that"}], "answers": [{"comments": [{"owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "edited": false, "score": 1, "creation_date": 1576094651, "post_id": 59293215, "comment_id": 104791195, "body": "But OP wants to check <code>LogLevel.Critical</code>, I guess"}, {"owner": {"reputation": 8768, "user_id": 906, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1390df8051dd4455a02939d2ec3c6d55?s=128&d=identicon&r=PG", "display_name": "David Tchepak", "link": "https://stackoverflow.com/users/906/david-tchepak"}, "edited": false, "score": 1, "creation_date": 1576113377, "post_id": 59293215, "comment_id": 104796982, "body": "&quot;If it gets too complicated, I tend to just create a Test version of the interface&quot;  This is most excellent advice! Mocking libraries automate this process; for cases that need more custom logic creating a custom mock is usually a much better alternative."}], "tags": [], "owner": {"reputation": 9834, "user_id": 25338, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d43a93d4bc05e4c2922966e7f9f72d49?s=128&d=identicon&r=PG", "display_name": "Erik A. Brandstadmoen", "link": "https://stackoverflow.com/users/25338/erik-a-brandstadmoen"}, "is_accepted": false, "score": 1, "last_activity_date": 1576094497, "creation_date": 1576094497, "answer_id": 59293215, "question_id": 59292245, "link": "https://stackoverflow.com/questions/59292245/how-to-check-properly-that-ilogger-logcritical-has-been-called-with-nsubstitute/59293215#59293215", "title": "How to check properly that ILogger.LogCritical has been called with NSubstitute?", "body": "<p>I would use <code>ReceivedWithAnyArgs()</code> (<a href=\"https://nsubstitute.github.io/help/received-calls/\" rel=\"nofollow noreferrer\">https://nsubstitute.github.io/help/received-calls/</a>) if matching on the parameters is very difficult. NSubstitute is nice if things are simple. If it gets too complicated, I tend to just create a Test version of the interface (e.g. <code>ILogger</code>), and register the arguments I'm interested in from the calls there, and check on those. </p>\n"}, {"tags": [], "owner": {"reputation": 5323, "user_id": 4636721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6NGhx.jpg?s=128&g=1", "display_name": "Mary Perret", "link": "https://stackoverflow.com/users/4636721/mary-perret"}, "is_accepted": true, "score": 1, "last_activity_date": 1576121492, "creation_date": 1576121492, "answer_id": 59297322, "question_id": 59292245, "link": "https://stackoverflow.com/questions/59292245/how-to-check-properly-that-ilogger-logcritical-has-been-called-with-nsubstitute/59297322#59297322", "title": "How to check properly that ILogger.LogCritical has been called with NSubstitute?", "body": "<p>I ended up using Moq for that particular kind of tests:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// Defining an extension method\npublic static void IsLogReceived(this IMock&lt;ILogger&lt;StockService&gt;&gt;logger, LogLevel level, int count = 1) =&gt;\n    logger.Verify(x =&gt;\n        x.Log(level,\n            It.IsAny&lt;EventId&gt;(),\n            It.IsAny&lt;It.IsAnyType&gt;(),\n            It.IsAny&lt;Exception&gt;(),\n            (Func&lt;It.IsAnyType, Exception, string&gt;)It.IsAny&lt;object&gt;()), \n        Times.Exactly(count));\n\n// [...]\n\n// and using the ext. method like that:\n[Fact]\npublic void TestNSubstituteAgain()\n{\n    var loggerMock = new Mock&lt;ILogger&lt;StockService&gt;&gt;();\n    var logger = loggerMock.Object;\n    logger.LogCritical(new Exception(), \"Hey lads!\");\n    loggerMock.IsLogReceived(LogLevel.Critical);\n}\n\n</code></pre>\n\n<p>It's not that accurate but depending on what's going on in the method scope, that can get the job done.</p>\n\n<p>That being said, I concede that the most precise way of achieving that would be to declare a wrapping type.</p>\n\n<p>Resources that helped me a bit:</p>\n\n<ul>\n<li><a href=\"https://github.com/nsubstitute/NSubstitute/issues/597\" rel=\"nofollow noreferrer\">https://github.com/nsubstitute/NSubstitute/issues/597</a></li>\n<li><a href=\"https://github.com/aspnet/Extensions/issues/1319\" rel=\"nofollow noreferrer\">https://github.com/aspnet/Extensions/issues/1319</a></li>\n</ul>\n"}], "owner": {"reputation": 5323, "user_id": 4636721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6NGhx.jpg?s=128&g=1", "display_name": "Mary Perret", "link": "https://stackoverflow.com/users/4636721/mary-perret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 59297322, "answer_count": 2, "score": 0, "last_activity_date": 1576121492, "creation_date": 1576090285, "question_id": 59292245, "link": "https://stackoverflow.com/questions/59292245/how-to-check-properly-that-ilogger-logcritical-has-been-called-with-nsubstitute", "title": "How to check properly that ILogger.LogCritical has been called with NSubstitute?", "body": "<p>I have some hard times with NSubstitute to check whether the method <code>ILogger.LogCritical(...)</code> has been called.</p>\n\n<p>For example with the code below:</p>\n\n<pre><code>[Fact]\npublic void TestNSubstituteAgain()\n{\n    var logger = Substitute.For&lt;ILogger&lt;StockService&gt;&gt;();\n    logger.LogCritical(new Exception(), \"Hey lads!\");\n    logger.Received().Log(\n        LogLevel.Critical, \n        Arg.Any&lt;EventId&gt;(), \n        Arg.Any&lt;object&gt;(), \n        Arg.Any&lt;Exception&gt;(),\n        Arg.Any&lt;Func&lt;object, Exception, string&gt;&gt;()\n        );\n}\n</code></pre>\n\n<p>I am getting that exception:</p>\n\n<pre><code>Rm.Combo.App.Tests.VirtualParcels.Services.StockServiceTest.TestNSubstituteAgain\n\nNSubstitute.Exceptions.ReceivedCallsException : Expected to receive a call matching:\n    Log&lt;Object&gt;(Critical, any EventId, any Object, any Exception, any Func&lt;Object, Exception, String&gt;)\nActually received no matching calls.\n\n   at NSubstitute.Core.ReceivedCallsExceptionThrower.Throw(ICallSpecification callSpecification, IEnumerable`1 matchingCalls, IEnumerable`1 nonMatchingCalls, Quantity requiredQuantity)\n   at NSubstitute.Routing.Handlers.CheckReceivedCallsHandler.Handle(ICall call)\n   at NSubstitute.Routing.Route.Handle(ICall call)\n   at NSubstitute.Core.CallRouter.Route(ICall call)\n   at NSubstitute.Proxies.CastleDynamicProxy.CastleForwardingInterceptor.Intercept(IInvocation invocation)\n   at Castle.DynamicProxy.AbstractInvocation.Proceed()\n   at NSubstitute.Proxies.CastleDynamicProxy.ProxyIdInterceptor.Intercept(IInvocation invocation)\n   at Castle.DynamicProxy.AbstractInvocation.Proceed()\n   at Castle.Proxies.ObjectProxy_2.Log[TState](LogLevel logLevel, EventId eventId, TState state, Exception exception, Func`3 formatter)\n   at Rm.Combo.App.Tests.VirtualParcels.Services.StockServiceTest.TestNSubstituteAgain() in C:\\Users\\eperret\\Desktop\\combo\\api\\Rm.Combo.App.Tests\\VirtualParcels\\Services\\StockServiceTest.cs:line 99\n</code></pre>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// 1] Ok the call I am making is that ext. method below:\npublic static void LogCritical(this ILogger logger, Exception exception, string message, params object[] args)\n{\n    logger.Log(LogLevel.Critical, exception, message, args);\n}\n\n// 2] Which forwards to that other ext. method below:\npublic static void Log(this ILogger logger, LogLevel logLevel, Exception exception, string message, params object[] args)\n{\n    logger.Log(logLevel, 0, exception, message, args);\n}\n\n// 3] and... then here (still an ext. method tho):\npublic static void Log(this ILogger logger, LogLevel logLevel, EventId eventId, Exception exception, string message, params object[] args)\n{\n    if (logger == null)\n    {\n        throw new ArgumentNullException(nameof(logger));\n    }\n\n    logger.Log(logLevel, eventId, new FormattedLogValues(message, args), exception, _messageFormatter);\n}\n\n// 4] to finally end up with this \"direct\" interface method:\nvoid Log&lt;TState&gt;(\nLogLevel logLevel,\nEventId eventId,\nTState state,\nException exception,\nFunc&lt;TState, Exception, string&gt; formatter);\n// Note: which is supposedly what I am gonna ask NSubstitute to check against, right? (since we cannot use NSubstitute `Received` method on ext. method, it has to be the corresponding instance method)\n</code></pre>\n\n<p>Note: <code>FormattedLogValues</code> is an <code>internal struct</code> so I really had to use <code>Arg.Any&lt;object&gt;</code>.</p>\n\n<p>When I check the calls actually received,I see that the logger has a call and I am not too sure to how it differs from I am asserting against. Like I am putting a breakpoint on something like <code>var re = logger.ReceivedCalls();</code> while debugging my unit test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zpo4y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zpo4y.png\" alt=\"enter image description here\"></a></p>\n\n<p>I really don't know what is not considered as proper parametes(s) of the NSubstitute <code>Received()</code> assertion.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["c#", ".net", "xml", "mef"], "comments": [{"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1576090433, "post_id": 59292178, "comment_id": 104789323, "body": "Does this answer your question?  <a href=\"https://stackoverflow.com/q/2689566/3744182\">How to add XmlInclude attribute dynamically</a>"}, {"owner": {"reputation": 9, "user_id": 1919963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4223700baeb5ad0af2de4277f4c50a?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/1919963/jeremy"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1576106310, "post_id": 59292178, "comment_id": 104795432, "body": "So the process would be to load the extensions then add the xml include attribute dynamically, then perform the xml deserialization?"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1576106405, "post_id": 59292178, "comment_id": 104795460, "body": "Yes.  You would also need to cache the <code>XmlSerializer</code> statically as explained in <a href=\"https://stackoverflow.com/q/23897145/3744182\">Memory Leak using StreamReader and XmlSerializer</a>."}], "owner": {"reputation": 9, "user_id": 1919963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd4223700baeb5ad0af2de4277f4c50a?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/1919963/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1576089961, "creation_date": 1576089961, "question_id": 59292178, "link": "https://stackoverflow.com/questions/59292178/xml-deserialization-with-mef-objects-as-xmlincludes", "title": "XML Deserialization with MEF objects as XmlIncludes", "body": "<p>I use XML for my configuration files and currently I deserialize into objects or lists of objects directly.  I also use Managed Extensibility Framework (MEF) to make extensions to our application platform but I haven't found a way to tie the two together.</p>\n\n<p>For instance if I wanted to add a new object to this base class using XMLInclude:</p>\n\n<pre><code>[XmlInclude(typeof(SubObject1))]\n[XmlInclude(typeof(SubObject2))]\n[XmlInclude(typeof(SubObject3))]\n//New XmlInclude Types based on plugins?\n[XmlType(\"SupportedObject\")]\npublic class SupportedObject\n{\n    public string Name { get; set; }\n}\n</code></pre>\n\n<p>with XML:</p>\n\n<pre><code>&lt;SupportedObjects&gt;\n  &lt;SupportedObject xsi:type=\"SubObject1\"&gt;\n      &lt;Name&gt;MainSub1&lt;/Name&gt;\n      &lt;SubObject1Param&gt;FooBar&lt;/SubObject1Param&gt;\n  &lt;/SupportedObject&gt;\n\n  &lt;!-- MEF Plugin Object --&gt;\n  &lt;SupportedObject xsi:type=\"MefObject1\"&gt;\n      &lt;Name&gt;MainSub1&lt;/Name&gt;\n      &lt;MefParam1&gt;something new&lt;/MefParam1&gt;\n  &lt;/SupportedObject&gt;\n&lt;/SupportedObjects&gt;\n</code></pre>\n\n<p>The first object would load fine because it is defined using the XmlInclude but how do I define an extension that is compiled in a dll and loaded as a lazy list object with contract to be included as a supported object xmlinclude as well?  I'm quite vexed.</p>\n"}, {"tags": ["c#", ".net", ".net-core", "redis", ".net-core-3.0"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 11096043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c55e659689381ad83640baa392ffdc?s=128&d=identicon&r=PG&f=1", "display_name": "cash", "link": "https://stackoverflow.com/users/11096043/cash"}, "edited": false, "score": 0, "creation_date": 1576160086, "post_id": 59301035, "comment_id": 104815214, "body": "Thanks for trying to help, but this answer suggests the exact same link that I&#39;ve posted. This NuGet package was developed for .NET Core 2.2. I would like to know if there is a Microsoft package for .NET Core 3.0 or if I must use a third party library (Stack Exchange)."}, {"owner": {"reputation": 666, "user_id": 8607723, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hVQByfNa7fo/AAAAAAAAAAI/AAAAAAAAAAs/N0ylGlC7Mc4/photo.jpg?sz=128", "display_name": "Leisen Chang", "link": "https://stackoverflow.com/users/8607723/leisen-chang"}, "reply_to_user": {"reputation": 165, "user_id": 11096043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c55e659689381ad83640baa392ffdc?s=128&d=identicon&r=PG&f=1", "display_name": "cash", "link": "https://stackoverflow.com/users/11096043/cash"}, "edited": false, "score": 0, "creation_date": 1576196246, "post_id": 59301035, "comment_id": 104830639, "body": "@cash The package is .Net Standard 2.0 and about these link, the thing I want to point out is that even if you use <code>AddDistributedRedisCache</code> you&#39;ll still depend on StackExchange.Redis."}, {"owner": {"reputation": 91, "user_id": 1331362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1288158afab50b636d3e7ca8a3c0cc?s=128&d=identicon&r=PG", "display_name": "hrillo666", "link": "https://stackoverflow.com/users/1331362/hrillo666"}, "edited": false, "score": 0, "creation_date": 1604308014, "post_id": 59301035, "comment_id": 114297637, "body": "@LeisenChang the problem is, as stated in the link above, that the StackExchange.Redis package used in the Mirosoft.Extensions.Caching.Redis is much older and has a bug meaning it can starve the threadpool. This is a real thing."}, {"owner": {"reputation": 141, "user_id": 2686617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6891ae45cbbb9265643f20d855a5cecc?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Barnwal", "link": "https://stackoverflow.com/users/2686617/avinash-barnwal"}, "reply_to_user": {"reputation": 91, "user_id": 1331362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1288158afab50b636d3e7ca8a3c0cc?s=128&d=identicon&r=PG", "display_name": "hrillo666", "link": "https://stackoverflow.com/users/1331362/hrillo666"}, "edited": false, "score": 0, "creation_date": 1604503046, "post_id": 59301035, "comment_id": 114367430, "body": "@hrillo666, As per latest source code at <a href=\"https://github.com/dotnet/extensions/blob/master/src/Caching/StackExchangeRedis/src/Microsoft.Extensions.Caching.StackExchangeRedis.csproj\" rel=\"nofollow noreferrer\">github.com/dotnet/extensions/blob/master/src/Caching/&hellip;</a>,  The Extension doesn&#39;t depend on specific version of StackExchange.Redis Library.  Moreover the Extension is also compiled for   netstandard2.0, which helps it be referenced in .Net 3.1 as well."}], "tags": [], "owner": {"reputation": 666, "user_id": 8607723, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hVQByfNa7fo/AAAAAAAAAAI/AAAAAAAAAAs/N0ylGlC7Mc4/photo.jpg?sz=128", "display_name": "Leisen Chang", "link": "https://stackoverflow.com/users/8607723/leisen-chang"}, "is_accepted": false, "score": 1, "last_activity_date": 1576141619, "creation_date": 1576141619, "answer_id": 59301035, "question_id": 59292159, "link": "https://stackoverflow.com/questions/59292159/does-redis-cache-in-net-core-3-requires-the-usage-of-the-stack-exchange-package/59301035#59301035", "title": "Does Redis Cache in .NET Core 3 requires the usage of the Stack Exchange package?", "body": "<p>To use <code>AddDistributedRedisCache</code>, you need to install <code>Microsoft.Extensions.Caching.Redis</code> from nuget. On the other hand, if you check the document you post carefully, <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.rediscacheservicecollectionextensions.adddistributedrediscache?view=dotnet-plat-ext-2.2\" rel=\"nofollow noreferrer\">AdddistributedRedisCache</a> use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.caching.redis.rediscacheoptions?view=dotnet-plat-ext-2.2\" rel=\"nofollow noreferrer\">RedisCacheOptions</a> and the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.caching.redis.rediscacheoptions.configurationoptions?view=dotnet-plat-ext-2.2#Microsoft_Extensions_Caching_Redis_RedisCacheOptions_ConfigurationOptions\" rel=\"nofollow noreferrer\">ConfigurationOptions property</a> is <code>StackExchange.Redis.ConfigurationOptions</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 88, "user_id": 2662738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f3295e1520c437e066d9b476439ee7?s=128&d=identicon&r=PG", "display_name": "divinebovine", "link": "https://stackoverflow.com/users/2662738/divinebovine"}, "edited": false, "score": 0, "creation_date": 1576621305, "post_id": 59313344, "comment_id": 104957831, "body": "Followup: Apparently it was announced here: <a href=\"https://github.com/aspnet/Announcements/issues/322\" rel=\"nofollow noreferrer\">github.com/aspnet/Announcements/issues/322</a>"}, {"owner": {"reputation": 424, "user_id": 2573572, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/uADil.jpg?s=128&g=1", "display_name": "Kyle L.", "link": "https://stackoverflow.com/users/2573572/kyle-l"}, "edited": false, "score": 0, "creation_date": 1609852573, "post_id": 59313344, "comment_id": 115946319, "body": "The link provided are not docs, just a microsoft stub page. Referring to the very last link"}, {"owner": {"reputation": 88, "user_id": 2662738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f3295e1520c437e066d9b476439ee7?s=128&d=identicon&r=PG", "display_name": "divinebovine", "link": "https://stackoverflow.com/users/2662738/divinebovine"}, "reply_to_user": {"reputation": 424, "user_id": 2573572, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/uADil.jpg?s=128&g=1", "display_name": "Kyle L.", "link": "https://stackoverflow.com/users/2573572/kyle-l"}, "edited": false, "score": 0, "creation_date": 1609868659, "post_id": 59313344, "comment_id": 115954353, "body": "Here&#39;s some updated documentation <a href=\"https://docs.microsoft.com/en-us/aspnet/core/performance/caching/distributed?view=aspnetcore-5.0#distributed-redis-cache\" rel=\"nofollow noreferrer\">here</a>. They try to push you to Azure Cache for Redis, but they link to a github coment about doing it locally."}], "tags": [], "owner": {"reputation": 88, "user_id": 2662738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f3295e1520c437e066d9b476439ee7?s=128&d=identicon&r=PG", "display_name": "divinebovine", "link": "https://stackoverflow.com/users/2662738/divinebovine"}, "is_accepted": true, "score": 7, "last_activity_date": 1581179324, "last_edit_date": 1581179324, "creation_date": 1576188234, "answer_id": 59313344, "question_id": 59292159, "link": "https://stackoverflow.com/questions/59292159/does-redis-cache-in-net-core-3-requires-the-usage-of-the-stack-exchange-package/59313344#59313344", "title": "Does Redis Cache in .NET Core 3 requires the usage of the Stack Exchange package?", "body": "<p>It took a bit of digging through their git repos, but it has been removed. The removal did not happen in the current repository, <a href=\"https://github.com/aspnet/Extensions\" rel=\"noreferrer\">https://github.com/aspnet/Extensions</a>, but in the previous repository, that is now archived, <a href=\"https://github.com/aspnet/Caching\" rel=\"noreferrer\">https://github.com/aspnet/Caching</a>.</p>\n\n<p>You can see some of the issues with the original package in this thread: <a href=\"https://github.com/aspnet/Caching/issues/410#issuecomment-418912525\" rel=\"noreferrer\">https://github.com/aspnet/Caching/issues/410#issuecomment-418912525</a></p>\n\n<p>The removal happened here: <a href=\"https://github.com/aspnet/Caching/issues/423\" rel=\"noreferrer\">https://github.com/aspnet/Caching/issues/423</a></p>\n\n<p>I've looked through the list of breaking changes in aspnet from 2.1 -> 2.2 and 2.2 -> 3.0 and nothing is listed for it. I'm going to create an issue on the documentation to see it included.</p>\n\n<p>At this point, I believe the answer is to use the StackExchange version. It apparently has some major improvements over the older package anyway.</p>\n\n<p><strong>UPDATE:</strong> The latest package supported would be <code>Microsoft.Extensions.Caching.StackExchangeRedis</code> simply utilising this package would be best for .NET Core 3.0 and above.</p>\n\n<p>Something along the lines of</p>\n\n<pre><code>services.AddStackExchangeRedisCache(action =&gt;\n                {\n                    action.InstanceName = \"WhatYouWantToNameIt\";\n                    action.Configuration = \"127.0.0.1:6379\";\n                });\n</code></pre>\n\n<p>Documentation is <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.caching.stackexchangeredis?view=dotnet-plat-ext-3.1\" rel=\"noreferrer\">here</a>!</p>\n"}], "owner": {"reputation": 165, "user_id": 11096043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6c55e659689381ad83640baa392ffdc?s=128&d=identicon&r=PG&f=1", "display_name": "cash", "link": "https://stackoverflow.com/users/11096043/cash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4222, "favorite_count": 0, "accepted_answer_id": 59313344, "answer_count": 2, "score": 0, "last_activity_date": 1581179324, "creation_date": 1576089876, "question_id": 59292159, "link": "https://stackoverflow.com/questions/59292159/does-redis-cache-in-net-core-3-requires-the-usage-of-the-stack-exchange-package", "title": "Does Redis Cache in .NET Core 3 requires the usage of the Stack Exchange package?", "body": "<p>In .NET Core 2.2, in my <code>Startup.cs</code>, I had the following:</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    services.AddDistributedRedisCache(...);             \n}\n</code></pre>\n\n<p>But now, in .NET Core 3.0, the <code>AddDistributedRedisCache</code> method can't be found. In <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.rediscacheservicecollectionextensions.adddistributedrediscache?view=dotnet-plat-ext-2.2\" rel=\"nofollow noreferrer\">docs</a>, the \"Applies to\" section shows support only up to .NET Core 2.2</p>\n\n<p>Following <a href=\"https://docs.microsoft.com/en-us/aspnet/core/performance/caching/distributed?view=aspnetcore-3.1#distributed-redis-cache\" rel=\"nofollow noreferrer\">this tutorial</a> from Microsoft, they use <code>services.AddStackExchangeRedisCache</code> in the example. Does it means that I'm required to install the Stack Exchange NuGet package for Redis? Why did the native Microsoft's Redis client solution removed?</p>\n"}, {"tags": ["c#", ".net", "string", "list"], "comments": [{"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 5, "creation_date": 1576089542, "post_id": 59292069, "comment_id": 104788956, "body": "<code>xList = listOfStrings.Select(x =&gt; new XClass(x)).ToList()</code>"}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 1, "creation_date": 1576090327, "post_id": 59292069, "comment_id": 104789282, "body": "What have you tried to do? Please show us <i>your</i> attempt..."}], "answers": [{"comments": [{"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 1, "creation_date": 1576089832, "post_id": 59292089, "comment_id": 104789053, "body": "<code>var</code> would be excluded. It&#39;s a property of <code>MockClass</code> so it&#39;s already declared."}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 1, "creation_date": 1576090741, "post_id": 59292089, "comment_id": 104789437, "body": "An explanation would be great to support your answer as well as give explanation to the OP..."}, {"owner": {"reputation": 460, "user_id": 12477070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d36f204dd409830f00f1299cce1522?s=128&d=identicon&r=PG&f=1", "display_name": "jasonmchoe", "link": "https://stackoverflow.com/users/12477070/jasonmchoe"}, "edited": false, "score": 0, "creation_date": 1576091263, "post_id": 59292089, "comment_id": 104789668, "body": "Edited with explanation."}], "tags": [], "owner": {"reputation": 460, "user_id": 12477070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d36f204dd409830f00f1299cce1522?s=128&d=identicon&r=PG&f=1", "display_name": "jasonmchoe", "link": "https://stackoverflow.com/users/12477070/jasonmchoe"}, "is_accepted": true, "score": 6, "last_activity_date": 1576091250, "last_edit_date": 1576091250, "creation_date": 1576089520, "answer_id": 59292089, "question_id": 59292069, "link": "https://stackoverflow.com/questions/59292069/what-is-the-best-way-to-convert-list-string-to-listtype-in-c/59292089#59292089", "title": "What is the best way to convert List &lt;string&gt; to List&lt;type&gt; in C#", "body": "<p>Using linq:</p>\n\n<pre><code>xList = listOfString.Select(a =&gt; new XClass(a)).ToList();\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>Use the linq <code>Enumerable.Select</code> extension method, passing a <code>Func&lt;string, XClass&gt;</code> selector. The selector will convert each element of <code>listOfString</code> from a <code>string</code> to an instance of <code>XClass</code>. The result will be an <code>IEnumerable&lt;XClass&gt;</code>, which you convert to a <code>List&lt;XClass&gt;</code> by calling <code>ToList()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1576171174, "creation_date": 1576171174, "answer_id": 59309801, "question_id": 59292069, "link": "https://stackoverflow.com/questions/59292069/what-is-the-best-way-to-convert-list-string-to-listtype-in-c/59309801#59309801", "title": "What is the best way to convert List &lt;string&gt; to List&lt;type&gt; in C#", "body": "<p>The <a href=\"https://docs.microsoft.com/dotnet/api/system.collections.generic.list-1.convertall\" rel=\"nofollow noreferrer\"><code>List.ConvertAll</code></a> method can be used to convert the list items :</p>\n\n<pre><code>xList = listOfString.ConvertAll(name =&gt; new XClass(name));\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6436925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6d305036c36fe314b42e899d6463ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Antero00", "link": "https://stackoverflow.com/users/6436925/antero00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 59292089, "answer_count": 2, "score": 0, "last_activity_date": 1578511270, "creation_date": 1576089418, "last_edit_date": 1578511270, "question_id": 59292069, "link": "https://stackoverflow.com/questions/59292069/what-is-the-best-way-to-convert-list-string-to-listtype-in-c", "title": "What is the best way to convert List &lt;string&gt; to List&lt;type&gt; in C#", "body": "<p>I'm writing because I did not find a solution to my problem.\nI have something like this: </p>\n\n<pre><code>private class MockClass\n{\n    public List&lt;XClass&gt; xList { get; set; }\n}\n\nprivate class XClass\n{\n    public XClass(string name)\n    {\n        this.name = name;\n    }\n    public string Name{ get; }\n}\n</code></pre>\n\n<p>Next, I have a method which takes a <code>List&lt;string&gt;</code>, and I want to convert this <code>List&lt;string&gt;</code> to a list like this: </p>\n\n<pre><code>private void CreateRequest(List&lt;string&gt; listOfString)\n{\n    var request = new MockClass\n    {\n        xList = // here I have no idea if this can be done\n    };\n}\n</code></pre>\n\n<p>Is there any point in doing so or just change  to string in the MockClass class?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 9018, "user_id": 5105949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd9d7ecb21c40f7a4256317fd80cecc?s=128&d=identicon&r=PG&f=1", "display_name": "churill", "link": "https://stackoverflow.com/users/5105949/churill"}, "edited": false, "score": 1, "creation_date": 1576088902, "post_id": 59291886, "comment_id": 104788669, "body": "Why is this tagged c++?"}, {"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 1, "creation_date": 1576088990, "post_id": 59291886, "comment_id": 104788717, "body": "And what is the question exactly ?"}], "answers": [{"tags": [], "owner": {"reputation": 2038, "user_id": 2929738, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/dabyK.jpg?s=128&g=1", "display_name": "akaBase", "link": "https://stackoverflow.com/users/2929738/akabase"}, "is_accepted": true, "score": 0, "last_activity_date": 1576090444, "creation_date": 1576090444, "answer_id": 59292286, "question_id": 59291886, "link": "https://stackoverflow.com/questions/59291886/shuffle-unique-images-and-call-to-form-button-c/59292286#59292286", "title": "shuffle unique images and call to form button-C#", "body": "<p>If I'm undestanding you correctly you wish to shuffle then return 5 items from a list.</p>\n\n<p>To do this you can use a generic <code>List</code> <code>shuffle</code> extension method.</p>\n\n\n\n<pre><code>public static class MyExtensions\n{\n    public static void Shuffle&lt;T&gt;(this IList&lt;T&gt; list)\n    {\n        using (var provider = new RNGCryptoServiceProvider())\n        {\n            int n = list.Count;\n            while (n &gt; 1)\n            {\n                byte[] box = new byte[1];\n                do provider.GetBytes(box);\n                while (!(box[0] &lt; n * (byte.MaxValue / n)));\n                int k = (box[0] % n);\n                n--;\n                T value = list[k];\n                list[k] = list[n];\n                list[n] = value;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>And then use that to randomize the list and get the first <code>n</code> from the list.</p>\n\n\n\n<pre><code>public List&lt;int&gt; GetRandomItemsFromList(List&lt;int&gt;list, int amount)\n{\n    list.shuffle();\n    return list.GetRange(0, amount);\n}\n</code></pre>\n\n<p>And its usage is</p>\n\n\n\n<pre><code>List&lt;int&gt;items = GetRandomItemsFromList(list, 5);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12520165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Gfh8bVi9dQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOJLbfOsmYOTF_WGLuVrYEyodVZg/photo.jpg?sz=128", "display_name": "Mircea Stroila", "link": "https://stackoverflow.com/users/12520165/mircea-stroila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 59292286, "answer_count": 1, "score": -1, "last_activity_date": 1576099661, "creation_date": 1576088602, "last_edit_date": 1576099661, "question_id": 59291886, "link": "https://stackoverflow.com/questions/59291886/shuffle-unique-images-and-call-to-form-button-c", "title": "shuffle unique images and call to form button-C#", "body": "<p>i'm building a poker game with classes.I have a class image where i want to load images from a string,shuffle and return unique images.After i want to call images to 5 picturebox in main.</p>\n\n<p>this is in my class:</p>\n\n<pre><code>String[] img = Directory.GetFiles(@\"...\\...\\cards\");\nList&lt;int&gt; deck = new List&lt;int&gt;();\n\npublic List&lt;int&gt; pachet1()\n{\n    Random rnd = new Random(DateTime.Now.Millisecond);\n    var lista = new List&lt;int&gt;();\n\n    for (int i = 0; i &lt; 52; i++)\n    {\n        deck.Add(i);\n    }\n    foreach (int a in deck)\n    {\n        int c = a;\n        lista.Add(c);\n    }\n    return lista;\n}\n</code></pre>\n\n<p>This is in main:</p>\n\n<pre><code>private void pictureBox_Click(object sender, EventArgs e)\n{\n    //here i want to call fucntion\n}   \n</code></pre>\n"}, {"tags": ["c#", "rest", "post"], "answers": [{"comments": [{"owner": {"reputation": 432, "user_id": 1619684, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d8330c940ab960f01ed70897c7918f83?s=128&d=identicon&r=PG&f=1", "display_name": "Pete Kozak", "link": "https://stackoverflow.com/users/1619684/pete-kozak"}, "edited": false, "score": 1, "creation_date": 1576501755, "post_id": 59292374, "comment_id": 104909007, "body": "Hi this was correct, so what&#39;s been actually happening was that &quot;https:/url&quot; was redirected to &quot;https:/url/&quot; and during this action header was being lost. I switched off  automatic redirections in Postman as mentioned here: <a href=\"https://stackoverflow.com/questions/56763018/is-there-a-way-to-retrieve-the-redirected-url-from-a-postman-response\" title=\"is there a way to retrieve the redirected url from a postman response\">stackoverflow.com/questions/56763018/&hellip;</a> then followed the shown response - where I found out that there is &quot;/&quot; at the end! :) Thanks"}], "tags": [], "owner": {"reputation": 147, "user_id": 12520358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef991a43c985a09180c28b8d23e46a81?s=128&d=identicon&r=PG&f=1", "display_name": "Tomsen", "link": "https://stackoverflow.com/users/12520358/tomsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1576090872, "creation_date": 1576090872, "answer_id": 59292374, "question_id": 59291884, "link": "https://stackoverflow.com/questions/59291884/c-httpclient-post-with-authorization-and-json-data-401-unauthorized/59292374#59292374", "title": "C# HttpClient Post with Authorization and JSON data - 401 Unauthorized", "body": "<p>The HttpClient loses it's headers on redirections.</p>\n\n<p>So make sure, that you use the correct API address. If your API doesn't allow insecure connections but you use \"<a href=\"http://your-api-address.xy/\" rel=\"nofollow noreferrer\">http://your-api-address.xy/</a>\" instead of \"<a href=\"https://your-api-address.xy/\" rel=\"nofollow noreferrer\">https://your-api-address.xy/</a>\" it will return a redirection and your client loses the headers.</p>\n"}], "owner": {"reputation": 432, "user_id": 1619684, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d8330c940ab960f01ed70897c7918f83?s=128&d=identicon&r=PG&f=1", "display_name": "Pete Kozak", "link": "https://stackoverflow.com/users/1619684/pete-kozak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1686, "favorite_count": 0, "accepted_answer_id": 59292374, "answer_count": 1, "score": 0, "last_activity_date": 1576090872, "creation_date": 1576088580, "question_id": 59291884, "link": "https://stackoverflow.com/questions/59291884/c-httpclient-post-with-authorization-and-json-data-401-unauthorized", "title": "C# HttpClient Post with Authorization and JSON data - 401 Unauthorized", "body": "<p>trying to send a post request (works fine in postman) but keep getting 401 Unauthorised exception in C#. Here is my code:</p>\n\n<pre><code>var httpClient = new HttpClient();\nvar creds = string.Format(\"{0}:{1}\", \"username\", \"password\");\nvar basicAuth = string.Format(\"Basic {0}\", Convert.ToBase64String(Encoding.UTF8.GetBytes(creds)));\nhttpClient.DefaultRequestHeaders.Add(\"Authorization\", basicAuth);\n\nvar requestMessage = new HttpRequestMessage(HttpMethod.Post, url);\nrequestMessage.Content = new StringContent(postData, Encoding.UTF8, \"application/json\");\nrequestMessage.Headers.Authorization = new AuthenticationHeaderValue(\"Basic\", \"encodedValue==\");\n\nvar post = httpClient.SendAsync(requestMessage);\npost.Wait();\n</code></pre>\n\n<p>same thing is happening when using HttpWebRequest:</p>\n\n<pre><code>var webReq = (HttpWebRequest)WebRequest.Create(url);\nwebReq.Headers.Add(\"Authorization\",\"Basic encodedValue==\");\nwebReq.Method = \"POST\";\nwebReq.ContentType = \"application/json\";\n\ntry\n{\n    using (var streamWriter = new StreamWriter(webReq.GetRequestStream()))\n    {\n        streamWriter.Write(json);\n        streamWriter.Flush();\n        streamWriter.Close();\n    }\n\n    var httpResponse = (HttpWebResponse)webReq.GetResponse();\n    using (var streamReader = new StreamReader(httpResponse.GetResponseStream()))\n    {\n        response = streamReader.ReadToEnd();\n    }\n}\n</code></pre>\n\n<p>Does any one have any ideas what could I try?\nPS (encodedValue== is correctly encoded)</p>\n"}, {"tags": ["c#", "http", "asp.net-mvc-4", "https"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11540692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96b4252789611545d9243562f8e80ae?s=128&d=identicon&r=PG&f=1", "display_name": "lesioTheProgrammer", "link": "https://stackoverflow.com/users/11540692/lesiotheprogrammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1576097697, "creation_date": 1576097697, "answer_id": 59293924, "question_id": 59291828, "link": "https://stackoverflow.com/questions/59291828/define-https-on-asp-net/59293924#59293924", "title": "Define Https on asp.net", "body": "<p>Use HttpPost attribute on the post method and HttpGet on get</p>\n\n<p>Already answered here </p>\n\n<p><a href=\"https://stackoverflow.com/questions/18052794/force-http-instead-of-https\">Stack HTTP instead of HTTPS</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11133025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1ad07bc789bbee6274ea8539ba843e?s=128&d=identicon&r=PG&f=1", "display_name": "hoanguyen40", "link": "https://stackoverflow.com/users/11133025/hoanguyen40"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576097697, "creation_date": 1576088258, "last_edit_date": 1576095359, "question_id": 59291828, "link": "https://stackoverflow.com/questions/59291828/define-https-on-asp-net", "title": "Define Https on asp.net", "body": "<p>How can I change the request to be HTTP instead of HTTPS in asp.net</p>\n\n<ol>\n<li>What I'm getting <a href=\"https://localhost/files/P-2019-00001/Scan/Request\" rel=\"nofollow noreferrer\">https://localhost/files/P-2019-00001/Scan/Request</a> Flow.png</li>\n<li>What I won't <a href=\"http://localhost/files/P-2019-00001/Scan/Request\" rel=\"nofollow noreferrer\">http://localhost/files/P-2019-00001/Scan/Request</a> Flow.png</li>\n</ol>\n\n<p>My web.config</p>\n\n<pre><code> &lt;add key=\"WebServerName\" value=\"localhost\"/&gt;\n &lt;add key=\"RedactingDownload\" value=\"\\\\[WebServerName]\\Users\\developer1\\tiff-editor\\Release\"/&gt;\n</code></pre>\n"}, {"tags": ["c#", ".net", "winforms"], "comments": [{"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1576166033, "post_id": 59291811, "comment_id": 104818948, "body": "If you&#39;re plan on using this in a <i>library</i> of sort, state it clearly, because it&#39;s a game changer."}], "answers": [{"comments": [{"owner": {"reputation": 4013, "user_id": 3346060, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b95421fd24a21feef7bb0217c4f1523f?s=128&d=identicon&r=PG", "display_name": "micnil", "link": "https://stackoverflow.com/users/3346060/micnil"}, "edited": false, "score": 0, "creation_date": 1576147496, "post_id": 59302230, "comment_id": 104808335, "body": "I think this might be a good solution for some people that might find this question, but this is kind-off what what I meant with &quot;<i>[...] have to make this implementation independent of the actual dialog [...]</i>&quot;, but I understand it might not have been clear. If this only works if other developers remember to call this class everytime they open a dialog, it is very bug prone in the future. It would also require me to modify the potentially hundreds (or thousands) of places we open modal dialogs. I was hoping there was a way to keep the implementation contained to a single class or function."}], "tags": [], "owner": {"reputation": 4238, "user_id": 4424024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b2dDh.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/4424024/martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1576145666, "creation_date": 1576145666, "answer_id": 59302230, "question_id": 59291811, "link": "https://stackoverflow.com/questions/59291811/how-to-wait-for-all-modal-dialogs-to-close-asynchronously/59302230#59302230", "title": "How to wait for all modal dialogs to close asynchronously?", "body": "<p>Would it be an option for you to write a dedicated singleton class (<em>\"DialogManager\"?</em>) that keeps track of the opended dialogs of your application? This class would store the dialog instances or alternatively at least their number).</p>\n\n<p>In order to open / show a dialog you would then call this DialogManager class instead of doing it directly.</p>\n\n<p>When the number of open dialogs reaches zero, you could throw an event in that class e.g. \"AllDialogsClosed\".</p>\n\n<p>Then you could subscribe to that \"AllDialogsClosed\" event in your application in another class and do your logic.</p>\n\n<pre><code>public class DialogManager\n{\n  private int _numberOfOpenDialogs;\n  public event EventHandler AllDialogsClosed;\n\n\n  public ShowDialog(object dialogInstance)\n  {\n      _numberOfOpenDialogs++;\n  }\n\n  public CloseDialog(object dialogInstance)\n  {\n      _numberOfOpenDialogs--;\n\n      if (_numberOfOpenDialogs == 0)\n      {\n          OnAllDialogsClosed();\n      }\n  }\n\n  protected virtual void OnAllDialogsClosed(EventArgs e)\n  {\n    EventHandler handler = AllDialogsClosed;\n    if (handler != null)\n    {\n        handler(this, e);\n    }\n  } \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1576159234, "post_id": 59306147, "comment_id": 104814710, "body": "I&#39;m also interested to know the real requirement as it looks like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a> to me."}, {"owner": {"reputation": 4013, "user_id": 3346060, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b95421fd24a21feef7bb0217c4f1523f?s=128&d=identicon&r=PG", "display_name": "micnil", "link": "https://stackoverflow.com/users/3346060/micnil"}, "edited": false, "score": 0, "creation_date": 1576174457, "post_id": 59306147, "comment_id": 104823184, "body": "This looks more like the effect was after, but a lot more complicated than I hoped for compared to how we solve this today (see updated Background section). I&#39;m a bit confused that we have to loop over all threads in the process to check for dialogs, I thought only the UI thread could open them... but my understanding of .NET is probably lacking. It might take some time for me to dig into this, but i&#39;ll be sure to mark it as correct if I find it&#39;s the best answer to the question. Thank you."}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 4013, "user_id": 3346060, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b95421fd24a21feef7bb0217c4f1523f?s=128&d=identicon&r=PG", "display_name": "micnil", "link": "https://stackoverflow.com/users/3346060/micnil"}, "edited": false, "score": 1, "creation_date": 1576226136, "post_id": 59306147, "comment_id": 104838109, "body": "&quot;Usually&quot; a Windows Forms application have a single UI thread. But for example in the above example, using <code>Task.Run</code> I&#39;ve created the modal dialog windows in different threads. And thanks for the feedback, no worries, put enough effort to validate all the solutions."}], "tags": [], "owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "is_accepted": true, "score": 1, "last_activity_date": 1576171395, "last_edit_date": 1576171395, "creation_date": 1576158717, "answer_id": 59306147, "question_id": 59291811, "link": "https://stackoverflow.com/questions/59291811/how-to-wait-for-all-modal-dialogs-to-close-asynchronously/59306147#59306147", "title": "How to wait for all modal dialogs to close asynchronously?", "body": "<p>I'm not sure what's the real requirement behind this, but what you are trying to do in your example could be easily done this way:</p>\n\n<pre><code>private async void Form1_Load(object sender, EventArgs e)\n{\n    await Task.Run(() =&gt; MessageBox.Show(\"Hi\"));\n    MessageBox.Show(\"All dialog closed!\");\n}\n</code></pre>\n\n<p>It will show the \"Hi\" as a non-modal and you have access to main window. It also does not block the UI thread, but waits until the \"Hi\" dialog close and then run the next line.</p>\n\n<blockquote>\n  <p>If above piece of code is what you are looking for, you can ignore rest of the post; however if\n  you want to read it for learning purpose, it shows <strong>How to detect all modal\n  dialogs in the current application and How to wait for all of them to\n  close</strong>.</p>\n</blockquote>\n\n<p>You can create a function to count number of modal windows. I see the following modal windows:</p>\n\n<ul>\n<li>Those windows like <code>MessageBox</code> or <code>ColorDialog</code> which have <code>#32770</code> as <a href=\"https://docs.microsoft.com/en-us/windows/win32/winmsg/about-window-classes?WT.mc_id=DT-MVP-5003235\" rel=\"nofollow noreferrer\">window class</a></li>\n<li>Those <code>Form</code>s which you have shown using <code>ShowDialog</code>, which have <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.form.modal?WT.mc_id=DT-MVP-5003235&amp;view=netframework-4.8\" rel=\"nofollow noreferrer\"><code>Modal</code></a> property as true.</li>\n</ul>\n\n<p>To enumerate them, you can get all threads of the current process, and then for each thread, then using <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-enumthreadwindows?WT.mc_id=DT-MVP-5003235\" rel=\"nofollow noreferrer\"><code>EnumThreadWindows</code></a> get all windows and using <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getclassname?WT.mc_id=DT-MVP-5003235\" rel=\"nofollow noreferrer\"><code>GetClassName</code></a> check if the class is <code>#32770</code>.</p>\n\n<p>Then using <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.application.openforms?WT.mc_id=DT-MVP-5003235&amp;view=netframework-4.8\" rel=\"nofollow noreferrer\"><code>Application.OpenForms</code></a> get the list of forms which their <code>Modal</code> property is <code>true</code>.</p>\n\n<pre><code>delegate bool EnumThreadDelegate(IntPtr hWnd, IntPtr lParam);\n[DllImport(\"user32.dll\")]\nstatic extern bool EnumThreadWindows(int dwThreadId, EnumThreadDelegate lpfn, IntPtr lParam);\n[DllImport(\"user32.dll\")]\nstatic extern int GetClassName(IntPtr hWnd, StringBuilder lpClassName, int nMaxCount);\n\nstatic IEnumerable&lt;IntPtr&gt; GetModalWindowsHandles(int processId)\n{\n    var handles = new List&lt;IntPtr&gt;();\n    foreach (ProcessThread thread in Process.GetProcessById(processId).Threads)\n        EnumThreadWindows(thread.Id,\n            (hWnd, lParam) =&gt;\n            {\n                var className = new StringBuilder(256);\n                GetClassName(hWnd, className, 256);\n                if (className.ToString() == \"#32770\")\n                {\n                    handles.Add(hWnd);\n                }\n                return true;\n            }, IntPtr.Zero);\n    foreach (Form form in Application.OpenForms)\n        form.Invoke(new Action(() =&gt;\n        {\n            if (form.Modal)\n                handles.Add(form.Handle);\n        }));\n    return handles;\n}\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>The following example, opens multiple modals and waits until all of them are closed:</p>\n\n<pre><code>private async void Form1_Load(object sender, EventArgs e)\n{\n    Task.Run(() =&gt; MessageBox.Show(\"Hi\"));\n    Task.Run(() =&gt; new ColorDialog().ShowDialog());\n    Task.Run(() =&gt; new Form().ShowDialog());\n    await WaitUntil(() =&gt; GetModalWindowsHandles(Process.GetCurrentProcess().Id).Count() == 0);\n    MessageBox.Show(\"All dialog closed!\");\n}\npublic async Task WaitUntil(Func&lt;bool&gt; condition, int frequency = 25, int timeout = -1)\n{\n    var waitTask = Task.Run(async () =&gt;\n    {\n        while (!condition()) await Task.Delay(frequency);\n    });\n    if (waitTask != await Task.WhenAny(waitTask,\n            Task.Delay(timeout)))\n        throw new TimeoutException();\n}\n</code></pre>\n\n<p><sub>WaitUntil has taken from <a href=\"https://stackoverflow.com/a/52357854/3110834\">this post</a> to use in this example.</sub></p>\n"}], "owner": {"reputation": 4013, "user_id": 3346060, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b95421fd24a21feef7bb0217c4f1523f?s=128&d=identicon&r=PG", "display_name": "micnil", "link": "https://stackoverflow.com/users/3346060/micnil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 59306147, "answer_count": 2, "score": 1, "last_activity_date": 1576173583, "creation_date": 1576088177, "last_edit_date": 1576173583, "question_id": 59291811, "link": "https://stackoverflow.com/questions/59291811/how-to-wait-for-all-modal-dialogs-to-close-asynchronously", "title": "How to wait for all modal dialogs to close asynchronously?", "body": "<p><strong>Background</strong></p>\n\n<p>As part of a state transaction<sup>1</sup> between different applications on the client (WCF interprocess messaging), it is important that no application state is modified by the user in the meantime. Today, this \"blocking\" is done with modal dialogs in two steps. First an \"invisible\"<sup>2</sup> modal dialog is opened for a few hundred milliseconds. This blocks user interaction and also stops execution of the method until the dialog is closed. If the transaction is still not finished after the timeout, we show a visible modal progress dialog instead.</p>\n\n<p>This invisible modal dialog is causing issues for us, which I thought I could solve by simply making this an <code>await Task.Delay(timoutBeforeProgressDialog)</code><sup>3</sup> + blocking user input with a <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.application.addmessagefilter?view=netframework-4.8\" rel=\"nofollow noreferrer\">message filter</a>. I thought this would give the same effect as showing an invisible modal dialog for a short duration of time. This does however not seem to be the case. If during a callback in the transaction we show a message box to the user, asking to save their changes, the <code>await Task.Delay(timoutBeforeProgressDialog)</code> will just continue after the timout and pop up the progress dialog above the message box, blocking user input. This will not happen with the invisible modal. When the invisible modal is closed by the timout, it will not continue executing until the callbacks modal dialog is closed.</p>\n\n<p>You could argue that we shouldn't do it this way, and the transaction logic should be redesigned. This logic is however very ingrained and widespread across the application, and a therefore a costly refactor. I was hoping to just refactor this invisible modal dialog logic.</p>\n\n<p>I might also add that historically, we did not show an invisible modal in this situation, instead we called Application.DoEvents() in a loop until ready to continue (which gives the same effect). All this was implemented long before async await came to .NET.</p>\n\n<p><sup>1</sup> Transaction includes asking if OK to switch context, and then handling context switching callbacks. </p>\n\n<p><sup>2</sup> Invisible modal: Simply a modal dialog that does not steal focus, has no width or height, and opens off-screen.</p>\n\n<p><sup>3</sup> There is also a cancellation token to stop the delay if the transaction finishes before.</p>\n\n<hr>\n\n<p><strong>Question</strong></p>\n\n<p>I want to stop execution of a method until all modal dialogs in the application are closed (or rephrased: until the <em>main</em> message loop is pumping). Example of what i'm trying to achieve:</p>\n\n<pre><code>public partial class Form1 :Form\n{\n    public Form1() {\n        InitializeComponent();\n    }\n\n    private async void button_Click(object sender, EventArgs e) {\n\n        this.BeginInvoke(new MethodInvoker(() =&gt; {\n            MessageBox.Show(this, \"A modal dialog\", \"Dialog\", MessageBoxButtons.OK, MessageBoxIcon.Information);\n        }));\n\n        await Task.Delay(1000);\n\n        // wait for all modals to be closed / the main message loop is running. \n        await AllModalsClosed();\n\n        Console.WriteLine(\"This should be logged after user presses OK in the dialog shown above.\");\n    }\n\n    private async Task AllModalsClosed() {\n        var allModalsClosedSource = new TaskCompletionSource&lt;bool&gt;();\n        if (!this.TopLevelControl.CanFocus) {\n            // Modals are open\n            Application.LeaveThreadModal += (object s, EventArgs args) =&gt; {\n                allModalsClosedSource.SetResult(true);\n            };\n            await allModalsClosedSource.Task;\n        }\n    }\n}\n</code></pre>\n\n<p>But I'm not sure if this will be correct in all situations, or if its the best way. I also have to make this implementation independent of the actual dialog, since it might be anywhere in the application. Note that I don't want to block the main thread.</p>\n\n<p>I've also tried researching if there is any way to dispatch with BeginInvoke to the main message loop, if this was possible I could rewrite <code>AllModalsClosed</code> to:</p>\n\n<pre><code>private async Task AllModalsClosed() {\n    var allModalsClosedSource = new TaskCompletionSource&lt;bool&gt;();\n\n    // Made up BeginInvoke variant.\n    // Is anything like this possible?\n    this.BeginInvokeToMainMessageLoop(new MethodInvoker(() =&gt; {\n        allModalsClosedSource.SetResult(true);\n    }));\n    await allModalsClosedSource.Task;\n}\n</code></pre>\n\n<p>Alternatively, is there maybe some way to configure a Task to only continue on the main message loop when completed?</p>\n"}, {"tags": ["c#", "dll", "reflection"], "comments": [{"owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576088221, "post_id": 59291780, "comment_id": 104788347, "body": "If a previous version worked, just continue using it. If you need the faulty versions for any new functions/solutions, disable those or roll them back until you got a working example. 2 Months is not a long time to wait for an update."}, {"owner": {"reputation": 924, "user_id": 7253534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f42111c75149a00a6c9389ad305f530?s=128&d=identicon&r=PG", "display_name": "MathieuAuclair", "link": "https://stackoverflow.com/users/7253534/mathieuauclair"}, "reply_to_user": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "edited": false, "score": 0, "creation_date": 1576088424, "post_id": 59291780, "comment_id": 104788432, "body": "This is a critical bug impacting all of our production, I don&#39;t care if it&#39;s not fancy, I need this to work in order to buy time to find a proper fix, and I&#39;m not sure what you mean @&#199;&#246;\u0111\u011bx\u011b\u0155 this is how you change a static value with reflection, please review your downvote!"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 3, "creation_date": 1576088603, "post_id": 59291780, "comment_id": 104788517, "body": "The static variable in the dll is in the Global Stack and not on the regular stack.  Try OR all the BindingFlags options (not just NonPublic and Static) and see if you get results."}, {"owner": {"reputation": 924, "user_id": 7253534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f42111c75149a00a6c9389ad305f530?s=128&d=identicon&r=PG", "display_name": "MathieuAuclair", "link": "https://stackoverflow.com/users/7253534/mathieuauclair"}, "edited": false, "score": 0, "creation_date": 1576088731, "post_id": 59291780, "comment_id": 104788582, "body": "How do you do that? You just don&#39;t specify any binding flags? Post this as an answer, I&#39;ll tell you if it works"}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 0, "creation_date": 1576089143, "post_id": 59291780, "comment_id": 104788782, "body": "NonPublic|Static should be enough. Which library are you using? There&#39;s not enough information here to reproduce the issue."}, {"owner": {"reputation": 924, "user_id": 7253534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f42111c75149a00a6c9389ad305f530?s=128&d=identicon&r=PG", "display_name": "MathieuAuclair", "link": "https://stackoverflow.com/users/7253534/mathieuauclair"}, "edited": false, "score": 0, "creation_date": 1576089727, "post_id": 59291780, "comment_id": 104789015, "body": "I use a DLL from an internal product, nothing fancy, just a regular DLL with in-house code"}, {"owner": {"reputation": 924, "user_id": 7253534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f42111c75149a00a6c9389ad305f530?s=128&d=identicon&r=PG", "display_name": "MathieuAuclair", "link": "https://stackoverflow.com/users/7253534/mathieuauclair"}, "edited": false, "score": 0, "creation_date": 1576089862, "post_id": 59291780, "comment_id": 104789071, "body": "I used reflection for a lot of things and never had a single problem, but it&#39;s the first time I try it with a value in another DLL, and it looks like it doesn&#39;t work"}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 1, "creation_date": 1576090010, "post_id": 59291780, "comment_id": 104789142, "body": "The suggestions you&#39;ve seen should work, even across assemblies, so if they don&#39;t, there&#39;s something we&#39;re not seeing and it&#39;s difficult to guess what that could be. You would need to share that code. If you&#39;re concerned about sharing proprietary code, anonymize the names and leave out method bodies."}, {"owner": {"reputation": 924, "user_id": 7253534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f42111c75149a00a6c9389ad305f530?s=128&d=identicon&r=PG", "display_name": "MathieuAuclair", "link": "https://stackoverflow.com/users/7253534/mathieuauclair"}, "edited": false, "score": 0, "creation_date": 1576091028, "post_id": 59291780, "comment_id": 104789553, "body": "I&#39;ve updated the question with more sample, thanks for the comment"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 2, "creation_date": 1576096093, "post_id": 59291780, "comment_id": 104791825, "body": "@jdweng There is no such thing as the global stack."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576096373, "post_id": 59291780, "comment_id": 104791918, "body": "In c++?????????"}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 1, "creation_date": 1576100459, "post_id": 59291780, "comment_id": 104793589, "body": "Your code worked fine for me. The only thing I can think of is that it might be that it&#39;s running in Medium or Low Trust, or something like that. Using <code>BindingFlags.NonPublic | BindingFlags.Static</code> is indeed sufficient (no need to search public members when you know it&#39;s not public).  See if you can find a public, static field (be sure to switch to <code>BindingFlags.Public</code>) without doing anything else different. If that works, it&#39;s almost certainly a trust/security limitation."}], "owner": {"reputation": 924, "user_id": 7253534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f42111c75149a00a6c9389ad305f530?s=128&d=identicon&r=PG", "display_name": "MathieuAuclair", "link": "https://stackoverflow.com/users/7253534/mathieuauclair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576090604, "creation_date": 1576088046, "last_edit_date": 1576090604, "question_id": 59291780, "link": "https://stackoverflow.com/questions/59291780/is-it-possible-to-use-reflection-for-a-private-static-variable-in-a-dll", "title": "Is it possible to use reflection for a private static variable in a DLL?", "body": "<p>I'm trying to <strong>change the value of a singleton in a DLL</strong> for a project, a fix is coming in 2 months, but until then I want to use reflexion to change some settings into that singleton to keep working. I have access to the DLL's code, so I know the private members.</p>\n\n<p>each time I try to use reflexion on the DLL class, I get a null value for the field. Am I missing something, or is reflexion simply impossible in between DLL?</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var field = typeof(SingletonClass).GetField(\"_Instance\", BindingFlags.NonPublic | BindingFlags.Static);\nvar customSettings = new SingletonClass();\n// ...\n\nfield.SetValue(null, customSettings);\n</code></pre>\n\n<h1>Update</h1>\n\n<p>Add more code snippet as requested</p>\n\n<p>my reflection</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code> private TeamCityLogger GetLoggerInstance()\n {\n     // This will be empty\n     var test = typeof(TeamCityLogger).GetFields(BindingFlags.NonPublic | BindingFlags.Static | BindingFlags.Public); \n\n     // and this null\n     var field = typeof(TeamCityLogger).GetField(\"_Instance\", BindingFlags.NonPublic | BindingFlags.Static);\n\n     if (field == null)\n     {\n         Log.Warn($\"Could not override the teamcity logger, can't find _Instance in {typeof(TeamCityLogger)} teabox will log as normal\");\n         return null;\n     }\n\n     return (TeamCityLogger)field.GetValue(null);\n }\n</code></pre>\n\n<p>the code in the DLL</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code> public class TeamCityLogger\n {\n     private static TeamCityLogger _Instance;\n\n     // some other code ...\n\n     internal static void Register()\n     {\n         if (_Instance != null)\n         {\n            LogRaw(\"TeamCityLogger already Registered\");\n            return;\n         }\n\n         _Instance = new TeamCityLogger();\n     }\n }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "multithreading", "task"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 3, "creation_date": 1576088090, "post_id": 59291739, "comment_id": 104788298, "body": "You used <code>.Wait()</code> and <code>.Result</code>. These are code smells. You need to await the results and have the method marked as async and return a Task (or Task&lt;T&gt;) all the way up the call stack as far as you can. See <a href=\"https://docs.microsoft.com/en-us/archive/msdn-magazine/2013/march/async-await-best-practices-in-asynchronous-programming\" rel=\"nofollow noreferrer\">Async Await Best Practices</a>. You need to change <code>GetQueries_Sync</code> and how it&#39;s called."}, {"owner": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1576088173, "post_id": 59291739, "comment_id": 104788327, "body": "So, you show working code and asking about not  working?"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1576088269, "post_id": 59291739, "comment_id": 104788362, "body": "Your SqlConnection handling is not good. You need to follow the proper <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.idisposable?view=netframework-4.8\" rel=\"nofollow noreferrer\">IDisposable</a> patterns."}, {"owner": {"reputation": 13, "user_id": 6227028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d75182dceb6df27ecfcd6fa3e84f062?s=128&d=identicon&r=PG&f=1", "display_name": "magnvs78", "link": "https://stackoverflow.com/users/6227028/magnvs78"}, "reply_to_user": {"reputation": 6441, "user_id": 690952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9WfV.png?s=128&g=1", "display_name": "Selvin", "link": "https://stackoverflow.com/users/690952/selvin"}, "edited": false, "score": 0, "creation_date": 1576088353, "post_id": 59291739, "comment_id": 104788399, "body": "@Selvin:  the code is the same just different environments.  this code works in a console app but not in an asp.net app"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576088367, "post_id": 59291739, "comment_id": 104788406, "body": "Are you getting any exceptions? Add exception handlers to make sure code is not getting an exception due to running two SQL connections in parallel."}, {"owner": {"reputation": 13, "user_id": 6227028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d75182dceb6df27ecfcd6fa3e84f062?s=128&d=identicon&r=PG&f=1", "display_name": "magnvs78", "link": "https://stackoverflow.com/users/6227028/magnvs78"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1576088429, "post_id": 59291739, "comment_id": 104788436, "body": "@mason no debate there... i&#39;m trying to get the concept to work and then i&#39;ll worry about best practices"}, {"owner": {"reputation": 13, "user_id": 6227028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d75182dceb6df27ecfcd6fa3e84f062?s=128&d=identicon&r=PG&f=1", "display_name": "magnvs78", "link": "https://stackoverflow.com/users/6227028/magnvs78"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576088641, "post_id": 59291739, "comment_id": 104788537, "body": "@jdweng i don&#39;t think so as i&#39;d expect the same behavior in both environments... i&#39;ll add the handlers to be 100% sure and will report back.  stuck in a meeting now but will do it as soon as possible"}, {"owner": {"reputation": 1745, "user_id": 7478734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98041a41db9a4159ace877a35aa849a3?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro Mukalov", "link": "https://stackoverflow.com/users/7478734/dmytro-mukalov"}, "edited": false, "score": 0, "creation_date": 1576088917, "post_id": 59291739, "comment_id": 104788678, "body": "The <code>Out.Wait()</code> call simply blocks execution of <code>await Task.WhenAll(Tasks)</code> continuation under ASP.NET because it uses <code>SynchronizationContext</code> unlike a console application. <a href=\"https://blog.stephencleary.com/2012/07/dont-block-on-async-code.html\" rel=\"nofollow noreferrer\">Don&#39;t block on async code</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1173, "user_id": 1710221, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f9838288d0b1e44d00b6ee3476947905?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/1710221/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1576093891, "last_edit_date": 1576093891, "creation_date": 1576088961, "answer_id": 59291969, "question_id": 59291739, "link": "https://stackoverflow.com/questions/59291739/awaiting-task-never-completes-in-asp-net-but-does-in-console-app/59291969#59291969", "title": "Awaiting task never completes in ASP.net but does in Console app", "body": "<p>The reason why this happens in ASP.Net and not in the console app, it's due to how the former works behind the scenes when switching from an asynchronous context to a synchrounous context... to put it shortly, when you try to do something like this, you get a deadlock.</p>\n\n<p>There are some ways to alleviate this behaviour (ConfigureAwait) but when you go on this path you have to be careful with how you chain/manage threads etc... that's why it's not usually recommended.</p>\n\n<p>You can read more about this here:\n<a href=\"https://blogs.msdn.microsoft.com/alazarev/2017/05/20/fun-with-configureawait-and-deadlocks-in-asp-net/\" rel=\"nofollow noreferrer\">Fun with ConfigureAwait, and deadlocks in ASP.NET</a></p>\n\n<p>Note that this doesn't happen with ASP.Net Core.</p>\n"}, {"tags": [], "owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "is_accepted": true, "score": 0, "last_activity_date": 1576091939, "last_edit_date": 1576091939, "creation_date": 1576091165, "answer_id": 59292442, "question_id": 59291739, "link": "https://stackoverflow.com/questions/59291739/awaiting-task-never-completes-in-asp-net-but-does-in-console-app/59292442#59292442", "title": "Awaiting task never completes in ASP.net but does in Console app", "body": "<p>There are two ways to wait for an asynchronous task to finish.</p>\n\n<p><strong>Blocking</strong>. The following will block the current thread and wait for the task to finish.</p>\n\n<pre><code>task.Wait();\ntask.Result;\ntask.GetAwaiter().GetResult();\n</code></pre>\n\n<p><strong>Nonblocking.</strong> The following breaks the method in two and posts the remainder of it, called the \"continuation,\" to the synchronization context. It then returns control to the caller, along with a task that represents the continuation. The caller can force the continuation to complete by awaiting the task, using another await, recursively.</p>\n\n<pre><code>await task;\n</code></pre>\n\n<p>To a developer, the flow of control looks very similar, but they are in fact very <a href=\"https://stackoverflow.com/questions/20765723/async-and-await-difference-between-console-windows-forms-and-asp-net\">different</a> in terms of what thread run what piece of code. The difference depends on the specific <a href=\"https://stackoverflow.com/questions/18097471/what-does-synchronizationcontext-do\">SynchronizationContext</a>, which varies by application type. ASP.NET, for example, uses <a href=\"https://stackoverflow.com/questions/12659851/aspnetsynchronizationcontext\">AspNetSynchronizationContext</a>, while a WinForms app runs with a <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.windowsformssynchronizationcontext?view=netframework-4.8\" rel=\"nofollow noreferrer\">WindowsFormsSynchronizationContext</a>.</p>\n\n<p>In a console application, the synchronization context is just the thread pool, and is free-threaded. So you can use either technique without deadlock. The continuation will be able to execute even if the current thread is blocked, so <code>Wait()</code>, <code>Result</code>, and <code>GetResult()</code> will eventually return.</p>\n\n<p>In an ASP.NET application, the synchronization context is designed to allow for execution on a single thread (not <em>exactly</em>, due to to <a href=\"https://stackoverflow.com/questions/11306888/what-is-the-meaning-of-thread-agility-in-asp-net\">thread agility</a>, but you can read about that separately). This allows you to write ASP.NET code without worrying about locking or race conditions (mostly). But it also means that blocking the current thread will prevent the continuation from running. Since the current thread is blocking until the continuation has finished, and the continuation can't be executed, you have a deadlock situation.  <code>Wait()</code>, <code>Result</code>, and <code>GetResult()</code> will never return, and the application will hang.</p>\n\n<p>You can avoid the problem by ensuring that you only wait for tasks to complete using <code>await</code>. However this means that the method must be marked async.</p>\n\n<p>If you literally can't mark the method async, you have to use a workaround, which is more complicated than you might think. See <a href=\"https://stackoverflow.com/a/9343733/2791540\">Stephen Cleary's excellent answer</a> to learn how.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/a/42291461/2791540\">this answer on async flow of control</a> and <a href=\"https://stackoverflow.com/a/15022170/2791540\">this answer which provides a simple deadlock example</a>.</p>\n"}], "owner": {"reputation": 13, "user_id": 6227028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d75182dceb6df27ecfcd6fa3e84f062?s=128&d=identicon&r=PG&f=1", "display_name": "magnvs78", "link": "https://stackoverflow.com/users/6227028/magnvs78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 59292442, "answer_count": 2, "score": 0, "last_activity_date": 1576093891, "creation_date": 1576087873, "question_id": 59291739, "link": "https://stackoverflow.com/questions/59291739/awaiting-task-never-completes-in-asp-net-but-does-in-console-app", "title": "Awaiting task never completes in ASP.net but does in Console app", "body": "<p>I needed a way to shave some additional time off of some reporting queries and opted to use async methods to perform some of the tasks in parallel.  I'm pretty new to async so I made a test console application to prove the concept before plugging it into my asp.net MVC application.  Everything works as expected in the console app but the same code never gets past \"whenall\" within asp.net.  Here is my code:</p>\n\n<pre><code>//Synchronous call for outside world\npublic DataSet GetQueries_Sync()\n{\n    Task&lt;DataSet&gt; Out = GetQueries();\n    Out.Wait();\n    return Out.Result;\n}\n\n//Run all needed tasks in parallel\nprivate async Task&lt;DataSet&gt; GetQueries()\n{\n    Task&lt;DataTable&gt; Task1 = QueryOne();\n    Task&lt;DataTable&gt; Task2 = QueryTwo();\n    Task&lt;DataTable&gt;[] Tasks = new Task&lt;DataTable&gt;[] { Task1, Task2 };\n    await Task.WhenAll(Tasks);\n    DataSet Out = new DataSet();\n    Out.Tables.Add(Task1.Result);\n    Out.Tables.Add(Task2.Result);\n    return Out;\n}\n\n//Individual Queries\nprivate string ConnString = \"MyConnectionString\";\nprivate Task&lt;DataTable&gt; QueryOne()\n{\n    return Task.Run(() =&gt;\n    {\n        DataTable Out = new DataTable();\n        string SQL = \"\";\n        SqlConnection Conn = new SqlConnection(ConnString);\n        SqlDataAdapter Adapter = new SqlDataAdapter(SQL, Conn);\n        Conn.Open();\n        Adapter.Fill(Out);\n        Out.TableName = \"QueryOne\";\n        Conn.Close();\n        return Out;\n    });\n}\n\nprivate Task&lt;DataTable&gt; QueryTwo()\n{\n    return Task.Run(() =&gt;\n    {\n        DataTable Out = new DataTable();\n        string SQL = \"SQL Statement #2, ~30sec\";\n        SqlConnection Conn = new SqlConnection(ConnString);\n        SqlDataAdapter Adapter = new SqlDataAdapter(SQL, Conn);\n        Conn.Open();\n        Adapter.Fill(Out);\n        Out.TableName = \"QueryTwo\";\n        Conn.Close();\n        return Out;\n    });\n}\n</code></pre>\n\n<p>In asp.net (.net Framework 4.7), nothing past \"Task.WhenAll(Tasks)\" within GetQueries() is run even though each of the individual query functions return their results.  The console app is basically the same except that the methods are static.  Task.WhenAll(Tasks) continues as expected in the console environment.  Any ideas why the same code would work within a console app but not within an asp.net app?</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "edited": false, "score": 0, "creation_date": 1576090291, "post_id": 59291709, "comment_id": 104789264, "body": "You can try to manage <code>IsSelected</code> property inside a treeview items and disallow collapsing using a <code>DataTrigger</code> Btw, can you share the item style?"}, {"owner": {"reputation": 2264, "user_id": 1127872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/aEhLJ.jpg?s=128&g=1", "display_name": "voidengine", "link": "https://stackoverflow.com/users/1127872/voidengine"}, "reply_to_user": {"reputation": 18074, "user_id": 4728685, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NiNlU.png?s=128&g=1", "display_name": "Pavel Anikhouski", "link": "https://stackoverflow.com/users/4728685/pavel-anikhouski"}, "edited": false, "score": 0, "creation_date": 1576140057, "post_id": 59291709, "comment_id": 104804184, "body": "@PavelAnikhouski I&#39;ve added the item style for reference. Can you elaborate how a DataTrigger could help?"}], "owner": {"reputation": 2264, "user_id": 1127872, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/aEhLJ.jpg?s=128&g=1", "display_name": "voidengine", "link": "https://stackoverflow.com/users/1127872/voidengine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576139905, "creation_date": 1576087717, "last_edit_date": 1576139905, "question_id": 59291709, "link": "https://stackoverflow.com/questions/59291709/always-show-selected-item-in-treeview", "title": "Always show selected item in TreeView", "body": "<p>Is there a way to have the selected item of a <code>TreeView</code> always shown? In other words, to disallow collapsing of the nodes that contain the selected item?</p>\n\n<p>I have a <code>TreeView</code> with a hierarchical data template</p>\n\n<pre><code>&lt;TreeView ItemsSource=\"{Binding Properties, Mode=OneWay}\"&gt;\n    &lt;TreeView.Resources&gt;\n        &lt;ResourceDictionary&gt;\n            &lt;ResourceDictionary.MergedDictionaries&gt;\n                &lt;ResourceDictionary Source=\"ExpanderTreeViewItemStyle.xaml\"/&gt;\n            &lt;/ResourceDictionary.MergedDictionaries&gt;\n            &lt;HierarchicalDataTemplate DataType=\"{x:Type viewModel:ComplexProperty}\" ItemsSource=\"{Binding Properties, Mode=OneWay}\"&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                    &lt;TextBlock Text=\"{Binding DisplayName}\"/&gt;\n                &lt;/StackPanel&gt;\n            &lt;/HierarchicalDataTemplate&gt;\n            &lt;DataTemplate DataType=\"{x:Type viewModel:SimpleProperty}\"&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                    &lt;TextBlock Text=\"{Binding DisplayName, Mode=OneWay}\"/&gt;\n                    &lt;TextBlock Text=\"{Binding Value, Mode=OneWay}\"/&gt;\n                &lt;/StackPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/ResourceDictionary&gt;\n    &lt;/TreeView.Resources&gt;\n&lt;/TreeView&gt;\n</code></pre>\n\n<p>styled so that only the nodes without children are focusable (the container items are templated to use an expander instead of the usual tree with +/- buttons, but that shouldn't make a difference). </p>\n\n<p>When a leaf node is selected, how do I prevent the containing node(s) from being wrapped, hiding the selected node?</p>\n\n<p>Here's the style for reference</p>\n\n<pre><code>&lt;Style TargetType=\"TreeViewItem\"&gt;\n    &lt;Setter Property=\"Template\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ControlTemplate TargetType=\"TreeViewItem\"&gt;\n                &lt;Grid Margin=\"8,4\"&gt;\n                    &lt;Border Name=\"ItemBorder\" BorderBrush=\"Gray\" BorderThickness=\"0.3\" Padding=\"6\" SnapsToDevicePixels=\"True\"&gt;\n                        &lt;Grid&gt;\n                            &lt;Expander Name=\"StructuredItemExpander\"&gt;\n                                &lt;Expander.Header&gt;\n                                    &lt;ContentPresenter ContentSource=\"Header\"/&gt;\n                                &lt;/Expander.Header&gt;\n                                &lt;ItemsPresenter/&gt;\n                            &lt;/Expander&gt;\n\n                            &lt;ContentPresenter Name=\"AtomicItemContents\" ContentSource=\"Header\" Visibility=\"Collapsed\"/&gt;\n                        &lt;/Grid&gt;\n                    &lt;/Border&gt;\n                &lt;/Grid&gt;\n                &lt;ControlTemplate.Triggers&gt;\n                    &lt;Trigger Property=\"TreeViewItem.HasItems\" Value=\"False\"&gt;\n                        &lt;Setter TargetName=\"StructuredItemExpander\" Property=\"Visibility\" Value=\"Collapsed\"/&gt;\n                        &lt;Setter TargetName=\"AtomicItemContents\" Property=\"Visibility\" Value=\"Visible\"/&gt;\n                        &lt;Setter TargetName=\"ItemBorder\" Property=\"BorderBrush\" Value=\"Transparent\"/&gt;\n                        &lt;Setter Property=\"Focusable\" Value=\"True\"/&gt;\n                    &lt;/Trigger&gt;\n                    &lt;Trigger Property=\"IsSelected\" Value=\"True\"&gt;\n                        &lt;Setter TargetName=\"ItemBorder\" Property=\"BorderBrush\" Value=\"Aqua\"/&gt;\n                    &lt;/Trigger&gt;\n                &lt;/ControlTemplate.Triggers&gt;\n            &lt;/ControlTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n\n    &lt;Setter Property=\"Focusable\" Value=\"False\"/&gt;\n\n    &lt;Setter Property=\"ItemsPanel\"&gt;\n        &lt;Setter.Value&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;StackPanel IsItemsHost=\"True\" Orientation=\"Vertical\"/&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/Setter.Value&gt;\n    &lt;/Setter&gt;\n&lt;/Style&gt;\n</code></pre>\n"}, {"tags": ["c#", "winforms", "infragistics"], "answers": [{"tags": [], "owner": {"reputation": 2297, "user_id": 6630084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e0d817b4f28ee3d219b87ceefcda2ed?s=128&d=identicon&r=PG&f=1", "display_name": "Jackdaw", "link": "https://stackoverflow.com/users/6630084/jackdaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1576845133, "last_edit_date": 1576845133, "creation_date": 1576496303, "answer_id": 59355882, "question_id": 59291486, "link": "https://stackoverflow.com/questions/59291486/exporting-ultraexpandablegroupbox-default-expansion-indicator/59355882#59355882", "title": "Exporting UltraExpandableGroupBox default expansion indicator", "body": "<p>When the ViewStyle property for the <strong><code>UltraExpandableGroupBox</code></strong> control is set to the <code>GroupBoxViewStyle.Office2003</code> the Expanded/Collapsed indicator uses an embedded bitmap.\nCode below demonstrates how this bitmap can be obtained from the assembly on the runtime and can be used to reverse the current Expanded/Collapsed indicators:</p>\n\n<pre><code>private void ReverseImage_Click(object sender, EventArgs e)\n{\n    var imageName = \"GroupBox.ExpansionIndicator_Chevron.bmp\";\n    System.IO.Stream stream = typeof(UltraExpandableGroupBox).Module.Assembly.GetManifestResourceStream(typeof(UltraExpandableGroupBox), imageName);\n\n    if (stream != null)\n    {\n        // The source bitmap has 7x10px size. \n        var image = Bitmap.FromStream(stream);\n        // Converting the image to 16x16 pixels\n        ultraExpandableGroupBox1.ExpansionIndicatorExpanded = ResizeImage(image, 16, 16);\n        // Rotation\n        using (var bmp = new Bitmap(image))\n        {\n            bmp.RotateFlip(RotateFlipType.Rotate180FlipNone);\n            image = bmp.Clone() as Image;\n\n            // Exporting bitmap to a file\n            bmp.Save(@\".\\\" + imageName, ImageFormat.Bmp);\n        }                \n        ultraExpandableGroupBox1.ExpansionIndicatorCollapsed = ResizeImage(image, 16, 16);\n    }\n} \n\npublic static Image ResizeImage(Image image, int new_height, int new_width)\n{\n    var dest = new Bitmap(new_width, new_height);\n    var g = Graphics.FromImage(dest);\n    g.InterpolationMode = InterpolationMode.High;\n    g.DrawImage(image, (dest.Width - image.Width)/2, (dest.Height-image.Height)/2);\n    return dest;\n}\n</code></pre>\n\n<blockquote>\n  <p>Exported to a file the Expanded/Collapsed indicator bitmap looks like on the picture below:</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/WSMde.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WSMde.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1400, "user_id": 4398005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b12990fcd36a06a2b18f4fa891ced75?s=128&d=identicon&r=PG&f=1", "display_name": "wnvko", "link": "https://stackoverflow.com/users/4398005/wnvko"}, "is_accepted": false, "score": 0, "last_activity_date": 1576849144, "creation_date": 1576849144, "answer_id": 59426174, "question_id": 59291486, "link": "https://stackoverflow.com/questions/59291486/exporting-ultraexpandablegroupbox-default-expansion-indicator/59426174#59426174", "title": "Exporting UltraExpandableGroupBox default expansion indicator", "body": "<p>You can achieve this with simple <a href=\"https://www.infragistics.com/help/winforms/win-draw-filter\" rel=\"nofollow noreferrer\">DrawFilter</a>. Set to your UltraExpandableGroupBox DraFilter property like this:</p>\n\n<pre><code>this.myUltraExpandableGroupBox.DrawFilter = new MyDrawFilter(expandedIndicator, collapsedInidcator);\n</code></pre>\n\n<p>Then create a new class named <code>MyDrawFilter</code> and let it inherit <code>IUIElementDrawFilter</code>. Your draw filter class may look like this:</p>\n\n<pre><code>    public class MyDrawFilter : IUIElementDrawFilter\n    {\n        Image expandedIndicator;\n        Image collapsedIndicator;\n        public MyDrawFilter(Image expandedIndicator, Image collapsedInidcator)\n        {\n            this.expandedIndicator = expandedIndicator;\n            this.collapsedIndicator = collapsedInidcator;\n        }\n        public bool DrawElement(DrawPhase drawPhase, ref UIElementDrawParams drawParams)\n        {\n            if (drawParams.Element is GroupBoxExpansionIndicatorUIElement)\n            {\n                // if groupbox is expanded change the image with one provided in the constructor\n                // as expandedIndicator\n                if ((drawParams.Element.Control as UltraExpandableGroupBox).Expanded)\n                {\n                    (drawParams.Element.ChildElements[0] as ImageUIElement).Image = this.expandedIndicator;\n                }\n                // else gropbox is collapsed change the image with one provided in the constructor\n                // as collapsedIndicator\n                else\n                {\n                    (drawParams.Element.ChildElements[0] as ImageUIElement).Image = this.collapsedIndicator;\n                }\n            }\n\n            return false;\n        }\n\n        public DrawPhase GetPhasesToFilter(ref UIElementDrawParams drawParams)\n        {\n            // filter when GroupBoxExpansionIndicatorUIElement should be drawn. This element has\n            // one child UIElement of ImageUIElement type. This UIElement holds the expansion\n            // indicator image.\n            if (drawParams.Element is GroupBoxExpansionIndicatorUIElement)\n            {\n                // we return BeforeDrawChildeElements in order to be able to change the image\n                return DrawPhase.BeforeDrawChildElements;\n            }\n\n            return DrawPhase.None;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 961, "user_id": 63134, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65dd8210b204af9fb2c76dc3947d796a?s=128&d=identicon&r=PG", "display_name": "KingErroneous", "link": "https://stackoverflow.com/users/63134/kingerroneous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576849144, "creation_date": 1576086786, "last_edit_date": 1576501582, "question_id": 59291486, "link": "https://stackoverflow.com/questions/59291486/exporting-ultraexpandablegroupbox-default-expansion-indicator", "title": "Exporting UltraExpandableGroupBox default expansion indicator", "body": "<p>I am using a UltraExpandableGroupBox in my WinForms application. And I am using the Office2003 style with it. However, I would like to reverse the Expanded and Collapsed Indicator images used.  I tried to export the images from the .isl file, but these images don't seems to be among the images exported. How do I access these images?</p>\n"}, {"tags": ["c#", "list", "email", "move"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1576086396, "post_id": 59291296, "comment_id": 104787519, "body": "This code will move the mail into the Error folder only the first email and only if that first email has the specific parameter value. Otherwise everything will go into the Success folder. You need to get rid of that <i>emailBool</i> and just test the parameter value"}, {"owner": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1576087614, "post_id": 59291296, "comment_id": 104788088, "body": "The code move the 5 mails store in emailList.emails and I need move only the mail that has met the logical."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "edited": false, "score": 0, "creation_date": 1576087518, "post_id": 59291407, "comment_id": 104788048, "body": "I&#39;m tried your solution but the problem is  that after moving that email, for example to the error folder, the foreach searches again for the other 4 items that are stored in emailList.emails."}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "reply_to_user": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "edited": false, "score": 0, "creation_date": 1576088952, "post_id": 59291407, "comment_id": 104788697, "body": "what is Cmmd in your context?"}, {"owner": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "edited": false, "score": 0, "creation_date": 1576089066, "post_id": 59291407, "comment_id": 104788750, "body": "Its the connection to the DB              using (OracleCommand Cmmd = new OracleCommand())"}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "reply_to_user": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "edited": false, "score": 0, "creation_date": 1576089171, "post_id": 59291407, "comment_id": 104788794, "body": "and how is it supposed to check against each item ? :)"}, {"owner": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "edited": false, "score": 0, "creation_date": 1576089573, "post_id": 59291407, "comment_id": 104788967, "body": "The project searches for 5 in 5 (emailList.emails) in the inbox folder a specific sender and extracts a number from the subject, then in the body it looks for another number and if that number is classified then it must be entered into the DB, by means of a procedure. The return parameter indicates if the data has been entered into the DB, if it is 0 it was entered correctly, if it is 1 there was an error entering the data, and it will move to the errors folder."}, {"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "reply_to_user": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "edited": false, "score": 0, "creation_date": 1576089652, "post_id": 59291407, "comment_id": 104788989, "body": "the If Statement, <code>if (!Cmmd.Parameters[&quot;p_retorno&quot;].Value.ToString().Equals(&quot;0&quot;)</code> has nothing to do with the item you are iterating over."}, {"owner": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "edited": false, "score": 0, "creation_date": 1576171216, "post_id": 59291407, "comment_id": 104821727, "body": "Yes was my mistake, I edited my post to clarify the context, the class moves the 5 emails and must to move the email that met with the conditional."}], "tags": [], "owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "is_accepted": true, "score": 0, "last_activity_date": 1576172432, "last_edit_date": 1576172432, "creation_date": 1576086491, "answer_id": 59291407, "question_id": 59291296, "link": "https://stackoverflow.com/questions/59291296/move-an-mail-of-a-list-of-mail-by-the-id/59291407#59291407", "title": "Move an mail of a list of mail by the id", "body": "<p>Once you process an email with error, you set the flag 'emailbool' to false, which moves every other email to the PathSuccess. Not sure how emailbool actually serves any purpose other than making sure only one email from all goes to error path.</p>\n\n<pre><code>foreach (Email item in emailList.emails)\n{\n    // This IF statement will either be true of false for ALL items.\n    if (!Cmmd.Parameters[\"p_retorno\"].Value.ToString().Equals(\"0\")) \n    {\n        emailList.moveMail(item.id, emailList.config.PathError);\n    }\n    else\n    {\n        emailList.moveMail(item.id, emailList.config.PathSuccess); \n    }\n}\n</code></pre>\n\n<p>EDIT:<br> For new code you posted, try this to move all emails that contain any string from statusList in its body.</p>\n\n<pre><code>    // This will move all emails that have one or more statusList in their body\n    foreach (Email item in emailList.emails)\n    {\n        if (statusList.Where(x =&gt; item.body.Contains(x)).Count &gt; 0)\n        {\n            emailList.moveMail(item.id, emailList.config.PathSuccess);\n            break; // This statement will stop processing of any other emails.\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12519882, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4dOGY0Gry3M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdmc3eSnFJHn3hx7tpoWOoKxmBFoA/photo.jpg?sz=128", "display_name": "Anmonr200", "link": "https://stackoverflow.com/users/12519882/anmonr200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 59291407, "answer_count": 1, "score": 0, "last_activity_date": 1597693785, "creation_date": 1576085993, "last_edit_date": 1597693785, "question_id": 59291296, "link": "https://stackoverflow.com/questions/59291296/move-an-mail-of-a-list-of-mail-by-the-id", "title": "Move an mail of a list of mail by the id", "body": "<p>I need to move a mail from a list of 5 mails that a class reads. This mail already has been processed by a logical that I created and has met the conditional created. The problem is that it moves those 5 emails and some do not meet the conditions. If the mail that has fulfilled the condition manages to enter the data into the database then it must be moved to the processed mail folder otherwise it must be moved to the error folder.</p>\n\n<p>This is the class that gets the emails</p>\n\n<pre><code>    int bufferLength = 5;\n    int indiceMail = 0;\n    string from = \"mail@gmail.com&gt;\";\n    do\n        {\n            emailList.getEmails(bufferLength);\n        while(indiceMail&lt;emailList.emails.Count)\n        {\n            indiceMail++;\n        }\n        Console.WriteLine(\"Reading: {0}\", emailList.emails.Count);\n    }while (emailList.MoreAvailable);\n</code></pre>\n\n<p>And this is the condition to move the mails</p>\n\n<pre><code>    string bodyMail = emailList.emails[indiceMail].body;\n    match3 = Regex.Match(bodyMail, @\"(?&lt;=Status:) (\\S+\\b)\");\n    statuscompare = match3.Value;\n\n    List&lt;String&gt; statusList = new List&lt;string&gt; { \"i2\", \"i3\", \"i4\", \"i8\" };\n    bool ex = false;\n    foreach (string item1 in statusList)\n    {\n        if (item1.Contains(statuscompare.Trim()))\n        {\n            ex = true;\n            if (item1.Contains(\"i4\"))\n            {\n\n                bool moveEmail = false;\n                foreach (Email item in emailList.emails)\n                {\n                    if (emailList.emails[indiceMail].body.Contains(\"i4\"))\n                    {\n                        // if (item.body.Contains(item1))\n                        //{\n                        moveEmail = true;\n                        emailList.moveMail(item.id, emailList.config.PathSuccess);\n                        break;\n                        // }\n                    }\n                    if (moveEmail)\n                    {\n                        continue;\n                    }\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>This is part of a class to move the mails</p>\n\n<pre><code>        public void moveMail(string emailId, string folderPath)\n        {\n            string folderId = getMailFolderId(folderPath);\n            EmailMessage message = EmailMessage.Bind(service, emailId);\n            message.Move(folderId);\n        }\n</code></pre>\n"}, {"tags": ["java", "c#", "time", "datetime-conversion", "java.time.instant"], "answers": [{"comments": [{"owner": {"reputation": 64281, "user_id": 5772882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/58mlb.png?s=128&g=1", "display_name": "Ole V.V.", "link": "https://stackoverflow.com/users/5772882/ole-v-v"}, "edited": false, "score": 0, "creation_date": 1576120944, "post_id": 59291453, "comment_id": 104798458, "body": "From your sample value your code prints 2013-11-05T00:58:24Z. This agrees perfectly with <a href=\"https://www.silisoftware.com/tools/date.php?inputdate=130280867040000000&amp;inputformat=filetime\" rel=\"nofollow noreferrer\">SiliSoftware Date format converter</a>. It seems you are not converting any fraction of second; I\u2019m sure that could be done if needed."}], "tags": [], "owner": {"reputation": 8229, "user_id": 1174024, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9zaVE.jpg?s=128&g=1", "display_name": "Nicholas DiPiazza", "link": "https://stackoverflow.com/users/1174024/nicholas-dipiazza"}, "is_accepted": false, "score": 2, "last_activity_date": 1576098786, "last_edit_date": 1576098786, "creation_date": 1576086643, "answer_id": 59291453, "question_id": 59291268, "link": "https://stackoverflow.com/questions/59291268/how-do-you-represent-ms-dtyp-datetime-in-java-8-instant/59291453#59291453", "title": "How do you represent MS-DTYP `DATETIME` in Java 8 Instant?", "body": "<p>Ah I was barking up the wrong tree when I split the bytes in half like that. </p>\n\n<p>Basically it's just saying that the units are in 100ns. </p>\n\n<p>And the Epoch has a different base time too. So you have to add the offset as well. </p>\n\n<p>So it is:</p>\n\n<pre><code>    private static final long DATETIME_EPOCH_DIFF_1601;\n    static {\n        LocalDateTime time32Epoch1601 = LocalDateTime.of(1601, Month.JANUARY, 1, 0, 0);\n        Instant instant = time32Epoch1601.atZone(ZoneOffset.UTC).toInstant();\n        DATETIME_EPOCH_DIFF_1601 = (instant.toEpochMilli() - Instant.EPOCH.toEpochMilli()) / 1000;\n    }\n    Instant answer = Instant.ofEpochSecond(fullval / 10000000 + DATETIME_EPOCH_DIFF_1601)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64281, "user_id": 5772882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/58mlb.png?s=128&g=1", "display_name": "Ole V.V.", "link": "https://stackoverflow.com/users/5772882/ole-v-v"}, "is_accepted": true, "score": 1, "last_activity_date": 1576126322, "last_edit_date": 1576126322, "creation_date": 1576121988, "answer_id": 59297374, "question_id": 59291268, "link": "https://stackoverflow.com/questions/59291268/how-do-you-represent-ms-dtyp-datetime-in-java-8-instant/59297374#59297374", "title": "How do you represent MS-DTYP `DATETIME` in Java 8 Instant?", "body": "<p>For converting with 1 second precision your own answer is just fine. In case you also need to convert the fraction of second, here\u2019s one way to do that.</p>\n\n<pre><code>    Instant msFiletimeEpoch = Instant.parse(\"1601-01-01T00:00:00Z\");\n    // a tick is 100 nanoseconds\n    int nanosPerTick = 100;\n    long ticksPerSecond = TimeUnit.SECONDS.toNanos(1) / nanosPerTick;\n\n    long fullval = 130_280_867_040_000_000L;\n\n    long seconds = fullval / ticksPerSecond;\n    long nanos = fullval % ticksPerSecond * nanosPerTick;\n\n    Instant answer = msFiletimeEpoch.plusSeconds(seconds).plusNanos(nanos);\n\n    System.out.println(answer);\n</code></pre>\n\n<p>Output is:</p>\n\n<blockquote>\n  <p>2013-11-05T00:58:24Z</p>\n</blockquote>\n\n<p>Let\u2019s try to put 1 more tick on your oroginal value; it should add 100 nanoseconds.</p>\n\n<pre><code>    long fullval = 130_280_867_040_000_001L;\n</code></pre>\n\n<blockquote>\n  <p>2013-11-05T00:58:24.000000100Z</p>\n</blockquote>\n\n<p>So so it does.</p>\n\n<p>Caveat for very far future dates: According to your quote the Microsoft integers are both unsigned. A Java <code>long</code> is signed. So some time in year 30828 we will start getting results that are very wrong. Just in case we ought to throw an exception if the <code>long</code> value is negative.</p>\n"}], "owner": {"reputation": 8229, "user_id": 1174024, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9zaVE.jpg?s=128&g=1", "display_name": "Nicholas DiPiazza", "link": "https://stackoverflow.com/users/1174024/nicholas-dipiazza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 59297374, "answer_count": 2, "score": 2, "last_activity_date": 1576126322, "creation_date": 1576085873, "last_edit_date": 1576122535, "question_id": 59291268, "link": "https://stackoverflow.com/questions/59291268/how-do-you-represent-ms-dtyp-datetime-in-java-8-instant", "title": "How do you represent MS-DTYP `DATETIME` in Java 8 Instant?", "body": "<p>In the Microsoft Spec, <code>DATETIME</code> is represented as 2 32-bit integers: <code>low</code> and <code>high</code></p>\n\n<p>Reference: <a href=\"https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/cca27429-5689-4a16-b2b4-9325d93e4ba2\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/cca27429-5689-4a16-b2b4-9325d93e4ba2</a></p>\n\n<blockquote>\n  <p>The FILETIME structure is a 64-bit value that represents the number of\n  100-nanosecond intervals that have elapsed since January 1, 1601,\n  Coordinated Universal Time (UTC). typedef struct _FILETIME { DWORD\n  dwLowDateTime; DWORD dwHighDateTime; } FILETIME,\n  *PFILETIME,\n  *LPFILETIME; dwLowDateTime: A 32-bit unsigned integer that contains the low-order bits of the file time. dwHighDateTime: A 32-bit unsigned\n  integer that contains the high-order bits of the file time.</p>\n</blockquote>\n\n<p>For example, here is the long <code>130280867040000000</code></p>\n\n<p>So the the high and low computed with</p>\n\n<pre><code>int high = (int)(fullval &gt;&gt; 32);\nint low = (int)fullval;\n</code></pre>\n\n<p>so high = <code>30333378</code>\nand low = <code>552794112</code></p>\n\n<p>How do I compute these to a Java 8 Instant? </p>\n"}, {"tags": ["c#", ".net", "razor", "blazor", "blazor-server-side"], "answers": [{"comments": [{"owner": {"reputation": 25716, "user_id": 6152891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b45b7f89429f8766cdbf6c776c0a9d41?s=128&d=identicon&r=PG", "display_name": "enet", "link": "https://stackoverflow.com/users/6152891/enet"}, "edited": false, "score": 0, "creation_date": 1576088525, "post_id": 59291255, "comment_id": 104788490, "body": "This method of course may fail as it is residing in the wrong location. Please, move it to the OnAfterRenderAsync method. And provide a parameter in the form &quot;namespace.methodname&quot;. No hard feelings! I&#39;ll delete this comment after you update your answer..."}, {"owner": {"reputation": 28123, "user_id": 1308743, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/92ec7a7b317928af4b975419239ffa99?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/1308743/kyle"}, "reply_to_user": {"reputation": 25716, "user_id": 6152891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b45b7f89429f8766cdbf6c776c0a9d41?s=128&d=identicon&r=PG", "display_name": "enet", "link": "https://stackoverflow.com/users/6152891/enet"}, "edited": false, "score": 3, "creation_date": 1576089610, "post_id": 59291255, "comment_id": 104788978, "body": "There are valid use cases for calling javascript in <code>OnInitializedAsync</code>, like if you only want the JS to run the first time and not on every rerender and are not accessing DOM elements in the component, this discussion is also not particularly relevant to the question of how to inject something in a razor component code behind file."}, {"owner": {"reputation": 25716, "user_id": 6152891, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b45b7f89429f8766cdbf6c776c0a9d41?s=128&d=identicon&r=PG", "display_name": "enet", "link": "https://stackoverflow.com/users/6152891/enet"}, "edited": false, "score": 0, "creation_date": 1576092539, "post_id": 59291255, "comment_id": 104790211, "body": "I just wanted to ensure that your code, no matter what it is purported to demonstrate, is coded well, not to enter into any kind of arguments. However, JavaScript is not available when pr-rendering, etc., some child components, are not yet created, etc., and  OnAfterRenderAsync is the most appropriate place to initialize (only once) JavaScript objects, and to apply new settings, etc. (occurring multiple times). This is exactly why the boolean parameter named firstRender was introduced as of late to  OnAfterRenderAsync."}, {"owner": {"reputation": 2341, "user_id": 3589609, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VPC24.jpg?s=128&g=1", "display_name": "Joshua Schlichting", "link": "https://stackoverflow.com/users/3589609/joshua-schlichting"}, "edited": false, "score": 0, "creation_date": 1602721026, "post_id": 59291255, "comment_id": 113813070, "body": "Don&#39;t forget <code>using Microsoft.AspNetCore.Components;</code>!"}, {"owner": {"reputation": 6607, "user_id": 6717178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbOLx.jpg?s=128&g=1", "display_name": "JHBonarius", "link": "https://stackoverflow.com/users/6717178/jhbonarius"}, "edited": false, "score": 0, "creation_date": 1614509471, "post_id": 59291255, "comment_id": 117402014, "body": "small edit, altough it also could (or should?) just be <code>protected override Task MyFunction() =&gt; JSRuntime.InvokeVoidAsync(&quot;console.log(&#39;test&#39;)&quot;);</code>"}], "tags": [], "owner": {"reputation": 28123, "user_id": 1308743, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/92ec7a7b317928af4b975419239ffa99?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/1308743/kyle"}, "is_accepted": true, "score": 17, "last_activity_date": 1614509347, "last_edit_date": 1614509347, "creation_date": 1576085826, "answer_id": 59291255, "question_id": 59291254, "link": "https://stackoverflow.com/questions/59291254/how-to-inject-in-blazor-code-behind-razor-cs-file-ijsruntime-for-example/59291255#59291255", "title": "How to inject in blazor code behind .razor.cs file? IJSRuntime for example", "body": "<p>In the code behind razor.cs file, <code>IJSRunTime</code> or others can be injected with the <code>[Inject]</code> attribute</p>\n<pre><code>public partial class BillingDashboard\n{\n    [Inject]\n    IJSRuntime JSRuntime { get; set; }\n\n    protected override async Task MyFunction()\n    {\n         await JSRuntime.InvokeVoidAsync(&quot;console.log('test')&quot;);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 28123, "user_id": 1308743, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/92ec7a7b317928af4b975419239ffa99?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/1308743/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4366, "favorite_count": 2, "accepted_answer_id": 59291255, "answer_count": 1, "score": 16, "last_activity_date": 1614509347, "creation_date": 1576085826, "last_edit_date": 1576086712, "question_id": 59291254, "link": "https://stackoverflow.com/questions/59291254/how-to-inject-in-blazor-code-behind-razor-cs-file-ijsruntime-for-example", "title": "How to inject in blazor code behind .razor.cs file? IJSRuntime for example", "body": "<p>With a normal single page razor component in Blazor. I can inject <code>IJSRuntime</code> like this at the top of the page:</p>\n\n<pre><code>@inject IJSRuntime JSRuntime\n</code></pre>\n\n<p>If I create a code behind .razor.cs file for the component, how do I inject something like <code>IJSRuntime</code> into the code behind file?</p>\n"}, {"tags": ["c#", "azure-functions", "asp.net-core-3.1", ".net-core-3.1"], "comments": [{"owner": {"reputation": 513, "user_id": 583523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d3feb3f2c8373a0945b8f56b5cabcb54?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/583523/andrea"}, "edited": false, "score": 0, "creation_date": 1576085611, "post_id": 59291143, "comment_id": 104787149, "body": "The problem appears also if you just refer a different project (class library) that includes Entity Framework Core: that was my situation giving the problem."}, {"owner": {"reputation": 513, "user_id": 583523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d3feb3f2c8373a0945b8f56b5cabcb54?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/583523/andrea"}, "edited": false, "score": 0, "creation_date": 1576086017, "post_id": 59291143, "comment_id": 104787349, "body": "Looking at the inner dependencies, I see that all the nuget packages refer to Microsoft.Extensions.Logging(3.1.0), Microsoft.Extensions.Logging.Abstractions(3.1.0), Microsoft.Extensions.Logging.Configuration(2.1.0), so they shouldn&#39;t conflict each other."}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1576086517, "post_id": 59291143, "comment_id": 104787584, "body": ".NET Core 3 support for Azure Functions is still (Dec 2019) in <b>preview</b> - maybe let the Azure Functions team know about this problem?"}, {"owner": {"reputation": 513, "user_id": 583523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d3feb3f2c8373a0945b8f56b5cabcb54?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/583523/andrea"}, "reply_to_user": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1576086873, "post_id": 59291143, "comment_id": 104787773, "body": "Good point, marc_s: but I just tried using .NET Core 3.0 and .NET Core 2.2, and the error(s) is exactly the same..."}, {"owner": {"reputation": 513, "user_id": 583523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d3feb3f2c8373a0945b8f56b5cabcb54?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/583523/andrea"}, "reply_to_user": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1576087120, "post_id": 59291143, "comment_id": 104787882, "body": "marc_s: see a comment below. Using .NET Core 2.2 and EF Core 2.2.6 it works, still maintaining the other packages over version 3... It looks weird, to me, anyway... :-)"}], "answers": [{"tags": [], "owner": {"reputation": 2604, "user_id": 4778497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd1fa84d8157df885055afeaa3fa2288?s=128&d=identicon&r=PG", "display_name": "jeffhollan", "link": "https://stackoverflow.com/users/4778497/jeffhollan"}, "is_accepted": false, "score": 1, "last_activity_date": 1576104525, "last_edit_date": 1576104525, "creation_date": 1576102515, "answer_id": 59294939, "question_id": 59291143, "link": "https://stackoverflow.com/questions/59291143/simply-adding-entity-framework-core-to-a-basic-azure-function-application-result/59294939#59294939", "title": "Simply Adding Entity Framework Core to a basic Azure function application results in an error", "body": "<p>Update: Just tested and pushed an update for 3.1.0 - I'd check out my project and try to figure out if you are pulling in some other conflicting dependencies - but that is working with 3.1.0 and netcoreapp3.1</p>\n\n<p><a href=\"https://github.com/jeffhollan/functions-chsarp-entitycore-3\" rel=\"nofollow noreferrer\">https://github.com/jeffhollan/functions-chsarp-entitycore-3</a></p>\n\n<p>-- Original Answer</p>\n\n<p>Had this working with entity core 3.0.1. Haven\u2019t yet tried with 3.1.0 but can check out later. For now this should work </p>\n"}], "owner": {"reputation": 513, "user_id": 583523, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d3feb3f2c8373a0945b8f56b5cabcb54?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea", "link": "https://stackoverflow.com/users/583523/andrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1576104525, "creation_date": 1576085344, "last_edit_date": 1576086483, "question_id": 59291143, "link": "https://stackoverflow.com/questions/59291143/simply-adding-entity-framework-core-to-a-basic-azure-function-application-result", "title": "Simply Adding Entity Framework Core to a basic Azure function application results in an error", "body": "<p>It's very simple to describe:  </p>\n\n<ul>\n<li>Create a new solution using the \"Azure Functions\" template from Visual Studio 2019 (16.4.1).  </li>\n<li>Change the TargetFramework to \".NET Core 3.1\".  </li>\n<li>It will be created with Microsoft.NET.Sdk.Functions (1.0.29).  </li>\n<li>Update it to the latest version (3.0.1).  </li>\n<li>It will not work, because now we will need some other nuget packages:  \n\n<ul>\n<li>Microsoft.Azure.WebJobs.Core (3.0.14)  </li>\n<li>Microsoft.Azure.WebJobs.Extensions.Http (3.0.2)  </li>\n</ul></li>\n<li><p>At this moment, the application runs in the emulator. Just start the debugger, and the console window shows that everything is fine and working.  </p></li>\n<li><p>Now add the <code>Microsoft.EntityFrameworkCore</code> (3.1.0) package</p></li>\n</ul>\n\n<p>At this point, we didn't touch any line of code, and we just added the latest versions of the given nuget packages, also setting the latest target framework. Nonetheless, the Azure Functions application doesn't work anymore, throwing this error, when starting the emulator with or without the debugger:  </p>\n\n<blockquote>\n  <p>Microsoft.Azure.WebJobs.Host: Error indexing method 'Function1'.<br>\n  Microsoft.Azure.WebJobs.Host: Cannot bind parameter 'log' to type ILogger. Make sure the parameter Type is supported by the binding. If you're using binding extensions (e.g. Azure Storage, ServiceBus, Timers, etc.) make sure you've called the registration method for the extension(s) in your startup code (e.g. builder.AddAzureStorage(), builder.AddServiceBus(), builder.AddTimers(), etc.).</p>\n</blockquote>\n"}, {"tags": ["c#", ".net", "sendgrid", "sendgrid-api-v3"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1576085704, "post_id": 59291117, "comment_id": 104787208, "body": "CORS only applies to browser code.  The status is unauthorized.  Are you sure your API key is being set?"}, {"owner": {"reputation": 1531, "user_id": 1533068, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5g9lz.jpg?s=128&g=1", "display_name": "sfaust", "link": "https://stackoverflow.com/users/1533068/sfaust"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1576097469, "post_id": 59291117, "comment_id": 104792377, "body": "Agh, sorry, no it isn&#39;t, now I have to figure out why...  When I go to command prompt and type &#39;set&#39; it shows me that variable with the appropriate value... not sure why it isn&#39;t recognizing in the program though..."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1576098364, "post_id": 59291117, "comment_id": 104792729, "body": "How are you setting the environment variable?  Also, <i>when</i> did you set it?  Was it set <i>after</i> you launched Visual Studio?  VS launches applications with the set of env. variables it had when VS itself launched.  If you set the variable after VS was launched, then VS doesn&#39;t have it, and consequently, neither will your application.  This is a guess at what is happening though."}, {"owner": {"reputation": 1531, "user_id": 1533068, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5g9lz.jpg?s=128&g=1", "display_name": "sfaust", "link": "https://stackoverflow.com/users/1533068/sfaust"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1576098680, "post_id": 59291117, "comment_id": 104792855, "body": "Ok, yeah that was it.  I set it after starting VS so it wasn&#39;t recognized by VS...  Restarted VS and it was there and everything worked.  <i>facepalm</i>.  Sorry, I&#39;ll leave this in case anyone else has the same facepalm moment but if mods want to delete feel free."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1576100513, "post_id": 59291117, "comment_id": 104793621, "body": "I will submit that as an answer then."}], "answers": [{"tags": [], "owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "is_accepted": true, "score": 1, "last_activity_date": 1576100561, "creation_date": 1576100561, "answer_id": 59294549, "question_id": 59291117, "link": "https://stackoverflow.com/questions/59291117/sendgrid-cors-response-in-c/59294549#59294549", "title": "SendGrid CORS Response in C#", "body": "<p>If you set the environment variable after starting Visual Studio, you need to restart VS.  VS launches applications with the set of environment variables it had when VS itself launched. If you set the variable after VS was launched, then VS doesn't have it, and consequently, neither will your application. </p>\n"}], "owner": {"reputation": 1531, "user_id": 1533068, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5g9lz.jpg?s=128&g=1", "display_name": "sfaust", "link": "https://stackoverflow.com/users/1533068/sfaust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 59294549, "answer_count": 1, "score": 0, "last_activity_date": 1576100561, "creation_date": 1576085257, "last_edit_date": 1576097174, "question_id": 59291117, "link": "https://stackoverflow.com/questions/59291117/sendgrid-cors-response-in-c", "title": "SendGrid CORS Response in C#", "body": "<p>I'm trying to implement SendGrid for emails and I'm running into some issues.  I found the example <a href=\"https://github.com/sendgrid/sendgrid-csharp/blob/master/USE_CASES.md#with-mail-helper-class\" rel=\"nofollow noreferrer\">here</a> for c# and set up a quick desktop example based on this.  I create a WPF application and put this in a button handler:</p>\n\n<pre><code>    async void BtnSend_Click(object sender, RoutedEventArgs e)\n    {\n        var apikey = Environment.GetEnvironmentVariable(\"SENDGRID_API_KEY\");\n        var client = new SendGridClient(apikey);\n\n        var from = new EmailAddress(\"&lt;&lt;my email&gt;&gt;\", \"me\");\n        var to = new EmailAddress(\"&lt;&lt;test receiver email&gt;&gt;\", \"you\");\n\n        var msg = new SendGridMessage();\n        msg.SetFrom(from);\n        msg.AddTo(to);\n        msg.SetTemplateId(\"&lt;&lt;my template id&gt;&gt;\");\n\n        var response = await client.SendEmailAsync(msg);\n\n        MessageBox.Show($\"Status: {response.StatusCode}\\n\\nHeaders:\\n{response.Headers}\");\n    }\n</code></pre>\n\n<p>However when I click the button I get this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GH0Qy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GH0Qy.png\" alt=\"Result\"></a></p>\n\n<p>I did go to the url on that header as well as found it elsewhere <a href=\"https://sendgrid.com/docs/for-developers/sending-email/cors/\" rel=\"nofollow noreferrer\">here</a>.  However that link is talking about browser based which this is not, plus it says to use one of the libraries which I am (I'm using the c# NuGet package).</p>\n\n<p>What am I doing wrong?  I will eventually put this on a web server in my AWS lambda API so I guess if I have to do that for testing I can but was hoping to do some testing and setup on desktop to familiarize before I move it over to the server...</p>\n"}, {"tags": ["c#", "sql-server", "asp.net-core-2.1", "serilog"], "comments": [{"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1576085302, "post_id": 59291078, "comment_id": 104786980, "body": "Post the <i>code</i> not a screenshot of the code. Screenshots don&#39;t compile. YOu should mention you use Serilog too. Your code doesn&#39;t contain a valid connection string either. Did you replace <code>Connection String Here</code> with a real connection string?"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1576085373, "post_id": 59291078, "comment_id": 104787029, "body": "How do you know that logging doesn&#39;t work? The table seems to be created according to the settings"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1576085496, "post_id": 59291078, "comment_id": 104787088, "body": "BTW your code never sets the Serilog logger (<code>Log.Logger =logger;</code>) and .NET&#39;s logging is configured <i>after</i> you execute all logging calls"}], "answers": [{"tags": [], "owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "is_accepted": false, "score": 0, "last_activity_date": 1576085747, "creation_date": 1576085747, "answer_id": 59291233, "question_id": 59291078, "link": "https://stackoverflow.com/questions/59291078/attempting-to-log-to-a-sql-server-database-but-it-doesnt-seem-to-be-working/59291233#59291233", "title": "Attempting to log to a SQL Server database, but it doesn&#39;t seem to be working", "body": "<p>Your code doesn't set the default Serilog Logger so all logging calls are lost. You should add </p>\n\n<pre><code>Log.Logger=logger;`\n</code></pre>\n\n<p>This is shown in the <a href=\"https://github.com/serilog/serilog-aspnetcore\" rel=\"nofollow noreferrer\">Serilog.AspNetCore</a> repo page:</p>\n\n<pre><code>\n    public static int Main(string[] args)\n    {\n        Log.Logger = new LoggerConfiguration()\n            .MinimumLevel.Debug()\n            .MinimumLevel.Override(\"Microsoft\", LogEventLevel.Information)\n            .Enrich.FromLogContext()\n            .WriteTo.Console()\n            .CreateLogger();\n\n        try\n        {\n            Log.Information(\"Starting web host\");\n            CreateWebHostBuilder(args).Build().Run();\n            return 0;\n        }\n        catch (Exception ex)\n        {\n            Log.Fatal(ex, \"Host terminated unexpectedly\");\n            return 1;\n        }\n        finally\n        {\n            Log.CloseAndFlush();\n        }\n    }\n\n    public static IWebHostBuilder CreateWebHostBuilder(string[] args) =&gt;\n            WebHost.CreateDefaultBuilder(args)\n                .UseStartup&lt;Startup&gt;()\n                .UseSerilog(); // &lt;-- Add this line;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8447252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466d9a22f5d8184030392280ce538542?s=128&d=identicon&r=PG&f=1", "display_name": "dhz", "link": "https://stackoverflow.com/users/8447252/dhz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576090564, "creation_date": 1576085093, "last_edit_date": 1576090564, "question_id": 59291078, "link": "https://stackoverflow.com/questions/59291078/attempting-to-log-to-a-sql-server-database-but-it-doesnt-seem-to-be-working", "title": "Attempting to log to a SQL Server database, but it doesn&#39;t seem to be working", "body": "<p>I'm attempting to log to SQL Server. From what I found it looks like it should be right but it still doesn't seem to be logging. Can you see if there's anything I'm doing in this code? Sorry about posting the code as a picture, it wasn't formatting right for me here.   </p>\n\n<p>I tried attempting this in a way that is a little closer to how it'll actually, but still not having any luck.</p>\n\n<p><a href=\"https://i.stack.imgur.com/FwZD0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FwZD0.png\" alt=\"Path where the info should be going to in the database.\"></a></p>\n\n<pre><code>public class Startup\n{\n    public Startup(IConfiguration configuration)\n    {\n        Configuration = configuration;\n\n        Log.Logger = new LoggerConfiguration()\n           .Enrich.FromLogContext()\n           .WriteTo.MSSqlServer(connectionString: \"\",\n                 tableName: \"Logs\"\n                , schemaName: \"LOG\"\n                , autoCreateSqlTable: true,\n                 restrictedToMinimumLevel: LogEventLevel.Information)\n           .CreateLogger();\n    }\n\n    public IConfiguration Configuration { get; }\n\n    // This method gets called by the runtime. Use this method to add services to the container.\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);\n    }\n\n    // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.\n    public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)\n    {\n        loggerFactory.AddSerilog();\n\n        if (env.IsDevelopment())\n        {\n            app.UseDeveloperExceptionPage();\n        }\n        else\n        {\n            // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.\n            app.UseHsts();\n        }\n\n        app.UseHttpsRedirection();\n        app.UseMvc();\n    }\n}\n\npublic class ValuesController : ControllerBase\n{\n    private readonly ILogger&lt;ValuesController&gt; _logger;\n\n    public ValuesController(ILogger&lt;ValuesController&gt; logger)\n    {\n        _logger = logger;\n    }\n\n    // GET api/values\n    [HttpGet]\n    public ActionResult&lt;IEnumerable&lt;string&gt;&gt; Get()\n    {\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        _logger.LogInformation($\"Start:\");\n        return new string[] { \"value1\", \"value2\" };\n    }\n }\n</code></pre>\n"}, {"tags": ["c#", "attributes"], "comments": [{"owner": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576085424, "post_id": 59291034, "comment_id": 104787052, "body": "Are you okay with using a class instead of String? For a cleaner way of doing things, I think that&#39;s the way I&#39;d go. You can overrdide / extend your class to make it do other things string does if needed."}, {"owner": {"reputation": 1309, "user_id": 3089271, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e0b91a7c8c3b12362285d9c28bd37987?s=128&d=identicon&r=PG&f=1", "display_name": "Maxqueue", "link": "https://stackoverflow.com/users/3089271/maxqueue"}, "reply_to_user": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576085557, "post_id": 59291034, "comment_id": 104787128, "body": "@Nikki9696 are you referring to a class inside the attribute definition?"}, {"owner": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576085589, "post_id": 59291034, "comment_id": 104787138, "body": "No, you&#39;d have a custom class, like MyEscapedString, and use that for your property instead of &quot;string&quot;"}, {"owner": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576085645, "post_id": 59291034, "comment_id": 104787172, "body": "Because I don&#39;t think you can use attributes for this. I could be wrong of course.  =)"}, {"owner": {"reputation": 1309, "user_id": 3089271, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e0b91a7c8c3b12362285d9c28bd37987?s=128&d=identicon&r=PG&f=1", "display_name": "Maxqueue", "link": "https://stackoverflow.com/users/3089271/maxqueue"}, "reply_to_user": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576085669, "post_id": 59291034, "comment_id": 104787182, "body": "No i can&#39;t do that because this class is a request that is sent off to api and needs to not change"}, {"owner": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 0, "creation_date": 1576085906, "post_id": 59291034, "comment_id": 104787303, "body": "Ah, okay. If it&#39;s just a few places, no biggies, but if it&#39;s all over, you might consider a class that has that sort of thing and use automapper to just map this one to your new one. It would let you do custom validation and anything else you need. It&#39;s a lot of work though if there&#39;s just this one class that needs it."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1576107938, "post_id": 59291034, "comment_id": 104795870, "body": "A lot of developers seem to think attributes can be used in a way similar to <a href=\"https://en.wikipedia.org/wiki/Aspect-oriented_programming\" rel=\"nofollow noreferrer\">Aspect-Oriented Programming</a> to inject functionality into classes while putting the (possibly shared) code in another location (implementing cross cutting concerns). That is entirely not what attributes do - can you tell me why you think that?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1576108171, "post_id": 59291034, "comment_id": 104795934, "body": "You can use something like <a href=\"https://www.postsharp.net/aop.net\" rel=\"nofollow noreferrer\">PostSharp</a> to implement Aspect-Oriented Programming in C#, but that seems like overkill."}], "answers": [{"comments": [{"owner": {"reputation": 1309, "user_id": 3089271, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e0b91a7c8c3b12362285d9c28bd37987?s=128&d=identicon&r=PG&f=1", "display_name": "Maxqueue", "link": "https://stackoverflow.com/users/3089271/maxqueue"}, "edited": false, "score": 0, "creation_date": 1576085621, "post_id": 59291157, "comment_id": 104787158, "body": "Thanks for feedback. Ya i wasn&#39;t sure if this was possible. It&#39;s not the end of the world for me to just update setters to apply the escape where applicable."}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "reply_to_user": {"reputation": 1309, "user_id": 3089271, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e0b91a7c8c3b12362285d9c28bd37987?s=128&d=identicon&r=PG&f=1", "display_name": "Maxqueue", "link": "https://stackoverflow.com/users/3089271/maxqueue"}, "edited": false, "score": 0, "creation_date": 1576086463, "post_id": 59291157, "comment_id": 104787548, "body": "Just wondering why a downvote here? would be nice to provide reasoning for this."}], "tags": [], "owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "is_accepted": false, "score": 0, "last_activity_date": 1576085415, "creation_date": 1576085415, "answer_id": 59291157, "question_id": 59291034, "link": "https://stackoverflow.com/questions/59291034/c-add-custom-attribute-that-will-set-property-value-when-setter-is-called/59291157#59291157", "title": "C# Add custom attribute that will set property value when setter is called", "body": "<p>Attributes are supported in C# for supplying run time information. It doesn't have pre processor like other Attribute Based programming languages that can change the behavior of data type at runtime. </p>\n\n<p>There is a hard way to do it by creating an IL injector to support this behavior, but that's not very popular in .Net world and requires a lot of plumbing code to achieve it. </p>\n"}, {"comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 1, "creation_date": 1576109351, "post_id": 59295815, "comment_id": 104796191, "body": "Ideally, shouldn&#39;t you use a <code>ProxyGenerationHook</code> class to filter at proxy creation time the methods to proxy?"}], "tags": [], "owner": {"reputation": 12628, "user_id": 12339804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677529a68dbdac610158cfc55ec65aec?s=128&d=identicon&r=PG&f=1", "display_name": "timur", "link": "https://stackoverflow.com/users/12339804/timur"}, "is_accepted": false, "score": 0, "last_activity_date": 1576110718, "last_edit_date": 1576110718, "creation_date": 1576108302, "answer_id": 59295815, "question_id": 59291034, "link": "https://stackoverflow.com/questions/59291034/c-add-custom-attribute-that-will-set-property-value-when-setter-is-called/59295815#59295815", "title": "C# Add custom attribute that will set property value when setter is called", "body": "<p>If you are open to making your properties virtual, you can use <a href=\"https://www.castleproject.org/projects/dynamicproxy/\" rel=\"nofollow noreferrer\"><code>Castle DynamicProxy</code></a> to intercept calls to setters and change the values as you please. A huge advantage of this method would be - you are relying on a industry proven library that has heaps of support and maintenance.\nOne obvious disadvantage - introducing a layer over all your method invocations will impact performance (must be noted, <code>NHibernate</code> and <code>EF Core</code> <a href=\"https://github.com/castleproject/Core/blob/master/docs/dynamicproxy.md\" rel=\"nofollow noreferrer\">seem to not have issues with that</a>)</p>\n\n<pre><code>public class Hook : IProxyGenerationHook\n{\n    public void MethodsInspected()\n    {\n        // again, we probably won't use it here\n    }\n\n    public void NonProxyableMemberNotification(Type type, MemberInfo memberInfo)\n    {\n        // we assume everything is correctly marked `virtual` and do nothing here\n    }\n\n    public bool ShouldInterceptMethod(Type type, MethodInfo methodInfo)\n    {\n        // you of course can go way fancier than that. \n        // one thing of note here is that your Property setters would be prefixed with \"set_\", but nothing stops you from targeting other methods as well\n        var prop = type.GetProperties()\n        .FirstOrDefault(p =&gt; methodInfo.Name == $\"set_{p.Name}\" &amp;&amp; p.GetCustomAttribute(typeof(EscapeInvalidAttribute)) != null);\n        return prop != null;\n    }\n}\npublic class EscapeInterceptor : IInterceptor\n{\n    public void Intercept(IInvocation invocation)\n    {        \n        invocation.Arguments[0] = EscapeInvalidAttribute.Escape((string)invocation.Arguments[0]);\n        invocation.Proceed(); // allow the call to proceed anyway       \n    }\n}\npublic class EscapeInvalidAttribute : Attribute\n{\n    public static string Escape(string input)\n    {\n        return $\"escape|{input}|string\";\n    }\n}\npublic class MyClass\n{\n    [EscapeInvalid]\n    public virtual string Prop1 { get; set; }\n\n    public virtual string Prop2 { get; set; }\n\n}\nvoid Main()\n{\n    var generator = new ProxyGenerator();\n    var options = new ProxyGenerationOptions\n    {\n        Hook  = new Hook()\n    };\n    MyClass myClassProxy = (MyClass)generator.CreateClassProxy(typeof(MyClass), options, new[] {new EscapeInterceptor()});\n    myClassProxy.Prop1 = \"test\";\n    myClassProxy.Prop2 = \"test\";\n    Console.WriteLine(myClassProxy.Prop1);\n    Console.WriteLine(myClassProxy.Prop2);\n}\n</code></pre>\n\n<p><strong>UPD</strong> added more canonical implementation using a <a href=\"https://github.com/castleproject/Core/blob/master/docs/dynamicproxy-fine-grained-control.md\" rel=\"nofollow noreferrer\">IProxyGenerationHook</a> </p>\n"}], "owner": {"reputation": 1309, "user_id": 3089271, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e0b91a7c8c3b12362285d9c28bd37987?s=128&d=identicon&r=PG&f=1", "display_name": "Maxqueue", "link": "https://stackoverflow.com/users/3089271/maxqueue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576110718, "creation_date": 1576084970, "question_id": 59291034, "link": "https://stackoverflow.com/questions/59291034/c-add-custom-attribute-that-will-set-property-value-when-setter-is-called", "title": "C# Add custom attribute that will set property value when setter is called", "body": "<p>The problem i am trying to solve is that i want all properties for a given class to escape invalid characters depending on whether a given attribute has been applied.</p>\n\n<p>Take following class:</p>\n\n<pre><code>public class MyClass\n{\n    [EscapeInvalid]\n    public string Prop1 {get; set;}\n\n    public string Prop2 {get; set;}\n}\n</code></pre>\n\n<p>Here is my defined attribute class</p>\n\n<pre><code>public class EscapeInvalidAttribute : Attribute \n{\n    string escapedValue;\n    public string EscapedValue\n    {\n        get\n        {\n            return escapedValue;\n        }\n        set\n        {\n            escapedValue= Escape(value);\n        }\n    } \n}\n</code></pre>\n\n<p>In a nutshell if the property for a given class has the [EscapeInvalid] applied i want to have the setter escape the value. </p>\n\n<p>Is this possible?</p>\n\n<p>I understand that i can just update each setter to apply the escape but was looking for a cleaner way to do this. Thanks in advance for any guidance.</p>\n"}, {"tags": ["c#", "asp.net", "html-parsing", "html-agility-pack"], "answers": [{"tags": [], "owner": {"reputation": 1722, "user_id": 1649997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb4f8bdc58aa0bf2f701c8d8d36ee5f?s=128&d=identicon&r=PG", "display_name": "Ivan R.", "link": "https://stackoverflow.com/users/1649997/ivan-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1576173646, "creation_date": 1576173646, "answer_id": 59310366, "question_id": 59290931, "link": "https://stackoverflow.com/questions/59290931/agility-helper-html-retrieving-p-paragraphs-text-until-another-anchor-is-reached/59310366#59310366", "title": "Agility Helper Html retrieving p/paragraphs text until another anchor is reached", "body": "<p>You could implement this like:</p>\n\n<pre><code>    foreach (HtmlNode l in linkDoc.DocumentNode.SelectNodes(\"//p\"))\n    {\n        if (l.ChildNodes.Any(node =&gt; node.Name == \"a\"))\n        {\n            Console.WriteLine();\n            Console.Write(\"text #\" + i++);\n        }\n        Console.Write(l.InnerText + \" \");\n    }\n</code></pre>\n"}], "owner": {"reputation": 1122, "user_id": 1576413, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/rdblZ.jpg?s=128&g=1", "display_name": "NoviceDeveloper", "link": "https://stackoverflow.com/users/1576413/novicedeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 59310366, "answer_count": 1, "score": 0, "last_activity_date": 1576173646, "creation_date": 1576084633, "last_edit_date": 1576087527, "question_id": 59290931, "link": "https://stackoverflow.com/questions/59290931/agility-helper-html-retrieving-p-paragraphs-text-until-another-anchor-is-reached", "title": "Agility Helper Html retrieving p/paragraphs text until another anchor is reached", "body": "<p>I am using Agility Helper HTML and I have thus far a code as such: </p>\n\n<pre><code>        var linkWeb = new HtmlWeb();\n        var linkDoc = web.Load(link);\n        foreach (HtmlNode l in linkDoc.DocumentNode.SelectNodes(\"//p\"))\n        {\n            Console.WriteLine(\"text #\"+ i++= + l.InnerText);\n        }\n</code></pre>\n\n<p>So this reads the web paragraph text just fine except, I want it to read all the paragraphs text combined until another anchor a tag is reached or if you can think of a better method.</p>\n\n<pre><code>&lt;p&gt;\n&lt;a href=\"1.shtml#Top\" target=\"_top\"&gt;PART 1&lt;/a&gt;\nCONTENT1;\nCONTENT2;\n&lt;/p&gt;\n&lt;p&gt;CONTENT3.&lt;/p&gt;\n\n&lt;p&gt;\n&lt;a href=\"2.shtml#Top\" target=\"_top\"&gt;PART 2&lt;/a&gt;\nCONTENT1&amp;nbsp;\nCONTENT2&amp;nbsp;\nCONTENT3&amp;nbsp;\nCONTENT4\n&lt;/p&gt;\n&lt;p&gt;CONTENT5.&lt;/p&gt;\n&lt;p&gt;CONTENT6.&lt;/p&gt;\n&lt;p&gt;CONTENT8.&lt;/p&gt;\n\n&lt;p&gt;\n&lt;a href=\"3.shtml#Top\" target=\"_top\"&gt;PART 3&lt;/a&gt;\nCONTENT1&amp;nbsp;\nCONTENT2&amp;nbsp;\nCONTENT3&amp;nbsp;\nCONTENT4.\n&lt;/p&gt;\n</code></pre>\n\n<p>So right now with the code I have, it reads the P text of each paragraph separately.</p>\n\n<p>TEXT #1 is </p>\n\n<p>CONTENT1\nCONTENT2</p>\n\n<p>TEXT # 2 is\nCONTENT3.</p>\n\n<p>I want this to read \nTEXT #1 is\nCONTENT1\nCONTENT2\nCONTENT3.</p>\n\n<p>this is dynamic and # of paragraphs change.</p>\n\n<p>Some kind of check to make sure before hitting the anchor it reads all paragraphs / InnerTexts and knows it is the supposed to be in the same Text #. </p>\n"}, {"tags": ["c#", "entity-framework-core"], "answers": [{"comments": [{"owner": {"reputation": 1328, "user_id": 1671557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e762bf5d94b10211c14e4c4e59aabfd6?s=128&d=identicon&r=PG", "display_name": "Mark Bonafe", "link": "https://stackoverflow.com/users/1671557/mark-bonafe"}, "edited": false, "score": 0, "creation_date": 1576085411, "post_id": 59290998, "comment_id": 104787043, "body": "Thanks, but I&#39;m not even getting .ThenInclude in intellisense and the project will not compile if I add it.  Error:  IQueryable&lt;Patient&gt;&#39; does not contain a definition for &#39;ThenInclude&#39; and no accessible extension method &#39;ThenInclude&#39; accepting a first argument of type &#39;IQueryable&lt;Patient&gt;&#39; could be found (are you missing a using directive or an assembly reference?)"}, {"owner": {"reputation": 2026, "user_id": 1582065, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/408d659eb2b51ec4a76c12e835b3de78?s=128&d=identicon&r=PG", "display_name": "bruno.almeida", "link": "https://stackoverflow.com/users/1582065/bruno-almeida"}, "reply_to_user": {"reputation": 1328, "user_id": 1671557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e762bf5d94b10211c14e4c4e59aabfd6?s=128&d=identicon&r=PG", "display_name": "Mark Bonafe", "link": "https://stackoverflow.com/users/1671557/mark-bonafe"}, "edited": false, "score": 0, "creation_date": 1576086474, "post_id": 59290998, "comment_id": 104787553, "body": "Try <code>using Microsoft.EntityFrameworkCore;</code>"}, {"owner": {"reputation": 1328, "user_id": 1671557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e762bf5d94b10211c14e4c4e59aabfd6?s=128&d=identicon&r=PG", "display_name": "Mark Bonafe", "link": "https://stackoverflow.com/users/1671557/mark-bonafe"}, "edited": false, "score": 0, "creation_date": 1576087592, "post_id": 59290998, "comment_id": 104788078, "body": "And there it is.  I wish code examples would include required &quot;using&quot; statements.  Thank you!"}], "tags": [], "owner": {"reputation": 2026, "user_id": 1582065, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/408d659eb2b51ec4a76c12e835b3de78?s=128&d=identicon&r=PG", "display_name": "bruno.almeida", "link": "https://stackoverflow.com/users/1582065/bruno-almeida"}, "is_accepted": true, "score": 0, "last_activity_date": 1576163482, "last_edit_date": 1576163482, "creation_date": 1576084872, "answer_id": 59290998, "question_id": 59290823, "link": "https://stackoverflow.com/questions/59290823/how-to-query-entityframework-core-3-0-dbcontext-with-theninclude/59290998#59290998", "title": "How to Query EntityFramework.Core 3.0 DbContext with ThenInclude", "body": "<p><strong>Edit</strong></p>\n\n<p>First you have to include the extensions in your class:</p>\n\n<pre><code>using Microsoft.EntityFrameworkCore;\n</code></pre>\n\n<p><strong>Original answer</strong></p>\n\n<p>It exists, but:</p>\n\n<blockquote>\n  <p>Code completion still does not offer up properties in ThenInclude.\n  e.g., Author not an option in the docs example:</p>\n\n<pre><code>var blogs = context.Blogs\n       .Include(blog =&gt; blog.Posts)\n           .ThenInclude(post =&gt; post.Author)\n       .ToList();\n</code></pre>\n  \n  <p>When entered manually, compiles with no errors or underlining and runs\n  correctly.</p>\n</blockquote>\n\n<p>See <a href=\"https://github.com/dotnet/roslyn/issues/8237#issuecomment-562997436\" rel=\"nofollow noreferrer\">https://github.com/dotnet/roslyn/issues/8237#issuecomment-562997436</a></p>\n"}], "owner": {"reputation": 1328, "user_id": 1671557, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e762bf5d94b10211c14e4c4e59aabfd6?s=128&d=identicon&r=PG", "display_name": "Mark Bonafe", "link": "https://stackoverflow.com/users/1671557/mark-bonafe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "closed_date": 1576090850, "accepted_answer_id": 59290998, "answer_count": 1, "score": 0, "last_activity_date": 1576163482, "creation_date": 1576084215, "last_edit_date": 1576084572, "question_id": 59290823, "link": "https://stackoverflow.com/questions/59290823/how-to-query-entityframework-core-3-0-dbcontext-with-theninclude", "closed_reason": "Duplicate", "title": "How to Query EntityFramework.Core 3.0 DbContext with ThenInclude", "body": "<p>I must be missing something simple.  I have created a project to hold data models.  I have added the following packages:</p>\n\n<ul>\n<li>Microsoft.EntifyFrameworkCore (3.1.0)</li>\n<li>Microsoft.EntitiFrameworkCore.SqlServer (3.1.0)</li>\n<li>Microsoft.EntityFrameworkCore.Tools (3.1.0)</li>\n</ul>\n\n<p>I created the models using the following command in the Package Manager Console:</p>\n\n<pre><code>Scaffold-DbContext \"server=MyServer;database=MyDB;Integrated Security=False;User ID=MyUserId;Password=myPassword;\" Microsoft.EntityFrameworkCore.SqlServer -OutputDir Models\n</code></pre>\n\n<p>Now I have a context called MyDBContext.  However, I don't seem to have the methods required to write the LINQ queries I was expecting.  I was hoping to be able to write something like this:</p>\n\n<pre><code>var pt = context.Patient.Where(p =&gt; p.PatientId == 1234)\n                        .Include(pa =&gt; pa.PatientAddress)\n                        .ThenInclude(....)\n</code></pre>\n\n<p>ThenInclude is not available.  What am I missing?</p>\n\n<p>On a side note, I was expecting the DbSets to be pluralized.  Why didn't this happen?</p>\n"}, {"tags": ["c#", "json.net", "stripe-payments", "httphandler"], "answers": [{"tags": [], "owner": {"reputation": 3035, "user_id": 974781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e2f303f86d3e0c59f6c6357590dea5fd?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/974781/david"}, "is_accepted": true, "score": 1, "last_activity_date": 1576093740, "creation_date": 1576093740, "answer_id": 59293034, "question_id": 59290818, "link": "https://stackoverflow.com/questions/59290818/how-to-process-response-from-stripe/59293034#59293034", "title": "How to process response from Stripe", "body": "<p>Try setting up a <a href=\"https://stripe.com/docs/webhooks\" rel=\"nofollow noreferrer\">Stripe webhook</a>. The bottom of this page contains some next steps. Additionally, the Dashboard has a section under Developer for managing <a href=\"https://dashboard.stripe.com/test/webhooks\" rel=\"nofollow noreferrer\">webhooks</a>.</p>\n\n<p>By using a webhook, you can let Stripe <strong><em>call you</em></strong> with all sorts of event types. For example, after a charge you can receive notification of the pending charge and  success (usually milliseconds behind). This is also a good way to learn of disputes being opened.</p>\n\n<p>These messages will have the JSON you are looking for. Your handler can then take action on your database.</p>\n"}], "owner": {"reputation": 1776, "user_id": 2078265, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aae0314049288d471f30844af2f98050?s=128&d=identicon&r=PG", "display_name": "Computer", "link": "https://stackoverflow.com/users/2078265/computer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 59293034, "answer_count": 1, "score": 0, "last_activity_date": 1576093740, "creation_date": 1576084198, "question_id": 59290818, "link": "https://stackoverflow.com/questions/59290818/how-to-process-response-from-stripe", "title": "How to process response from Stripe", "body": "<p>I am making a payment to the Stripe gateway which returns as a successful payment.</p>\n\n<p>I have setup the CLI to listen and forward the response to my localhost handler.</p>\n\n<p>I have the below code in my Handler</p>\n\n<pre><code>    public void ProcessRequest(HttpContext context)\n    {\n        var reques = context.Request;\n    }\n</code></pre>\n\n<p>However when the successful response comes back in, the breakpoint is hit and i analyse it. Im looking for a JSON response but i cant seem to find anything related to the feedback of this transaction. Nothing in Response, nothing in reques.Form.</p>\n\n<p>How do i retrieve the response to take action for database related tasks?</p>\n"}, {"tags": ["c#", "oledb", "oledbconnection", "oledbcommand"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1576084282, "post_id": 59290796, "comment_id": 104786507, "body": "<i>tot = total / total1 * 100;</i> you are using integer division that can only produce integer values. You need a floating point division."}, {"owner": {"reputation": 1, "user_id": 12519813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCwYL-jkXeW7kuyEdDbOJt7Kvaw3IoNEkI5gLckuA=k-s128", "display_name": "YourBestSenpai", "link": "https://stackoverflow.com/users/12519813/yourbestsenpai"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 1, "creation_date": 1576084407, "post_id": 59290796, "comment_id": 104786563, "body": "So converting the numbers to double, and the dividing it like dat: tot = (double)total/(double)total1? That would be for the result, thanks for that, but the first value is always 0, and it&#39;s not supposed to be"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1576084548, "post_id": 59290796, "comment_id": 104786617, "body": "Try to run the same query on your db"}, {"owner": {"reputation": 1, "user_id": 12519813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCwYL-jkXeW7kuyEdDbOJt7Kvaw3IoNEkI5gLckuA=k-s128", "display_name": "YourBestSenpai", "link": "https://stackoverflow.com/users/12519813/yourbestsenpai"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1576085039, "post_id": 59290796, "comment_id": 104786859, "body": "Yeah, it shows nothing on the access query as well, but I&#39;m not sure why, Female with capital F everywhere, no spaces, no special characters  UPDATE: Actually, whenever I try to run any query on access, no records show up, tried age right now, and name UPDATE2: Instead of writing gender = &quot;female&quot; etc i just entered female and it worked properly, in access that is."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12519813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCwYL-jkXeW7kuyEdDbOJt7Kvaw3IoNEkI5gLckuA=k-s128", "display_name": "YourBestSenpai", "link": "https://stackoverflow.com/users/12519813/yourbestsenpai"}, "edited": false, "score": 0, "creation_date": 1576087716, "post_id": 59291598, "comment_id": 104788135, "body": "Umm, I don&#39;t know how to say this, but I asked my friend for help in the meanwhile, he told me few things and nothing worked, so I went back to the same code and it worked, I don&#39;t know how or why, but it does work with the slashes indeed, thanks for that"}], "tags": [], "owner": {"reputation": 21, "user_id": 5251897, "user_type": "registered", "profile_image": "https://graph.facebook.com/1155170621163612/picture?type=large", "display_name": "Han Alister", "link": "https://stackoverflow.com/users/5251897/han-alister"}, "is_accepted": false, "score": 0, "last_activity_date": 1576088601, "last_edit_date": 1576088601, "creation_date": 1576087235, "answer_id": 59291598, "question_id": 59290796, "link": "https://stackoverflow.com/questions/59290796/how-to-count-number-of-records-set-under-a-condition/59291598#59291598", "title": "How to count number of records set under a condition?", "body": "<p>Maybe try this command query: <code>\"SELECT Count(Gender) FROM Survey WHERE Gender = \\\"\" + Gender1 + \"\\\"\";</code></p>\n\n<p>From what I can remember. access uses quotation marks for strings.</p>\n"}], "owner": {"reputation": 1, "user_id": 12519813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCwYL-jkXeW7kuyEdDbOJt7Kvaw3IoNEkI5gLckuA=k-s128", "display_name": "YourBestSenpai", "link": "https://stackoverflow.com/users/12519813/yourbestsenpai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576088601, "creation_date": 1576084114, "question_id": 59290796, "link": "https://stackoverflow.com/questions/59290796/how-to-count-number-of-records-set-under-a-condition", "title": "How to count number of records set under a condition?", "body": "<p>I'm basically new in coding, and I'm in uni, we have a small project to complete and I'm using OleDb to do it, as I have used it before, I'm trying to count the number of rows where a field is equal to a specific value, but I always get 0. To be more clear, I want statistics showing percentage of males/females who completed the survey(the program I'm making), currently I have 1 male and 2 females, so my string for all rows shows 3, which is correct, but when I want to count all the rows that contain females, it shows 0, so the total percentage is 0, and the textbox that's supposed to show the stat shows 0, here is the code:</p>\n\n<pre><code>private void Form2_Load(object sender, EventArgs e)\n    {\n        String connectionString;\n        connectionString = @\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source='C:\\Users\\kubas\\Desktop\\MyProject\\ProjectDB.accdb'\";\n        using (OleDbConnection myConnection = new OleDbConnection(connectionString))\n        {\n            string Gender1 = \"Female\";\n            OleDbConnection con;\n            OleDbCommand cmd = new OleDbCommand();\n            OleDbCommand cmd1 = new OleDbCommand();\n            con = new OleDbConnection(connectionString);\n            con.Open();\n            cmd.CommandText = \"SELECT Count(Gender) FROM Survey WHERE Gender = '\" + Gender1 + \"'\";\n            cmd1.CommandText = \"SELECT Count(Gender) FROM Survey\";\n            cmd.Connection = con;\n            cmd1.Connection = con;\n            con.Close();\n            try\n            {\n                con.Open();\n                int total = (Int32)cmd.ExecuteScalar();\n                int total1 = (Int32)cmd1.ExecuteScalar();\n                int tot;\n                tot = total / total1 * 100;\n                string ttal = Convert.ToString(tot);\n                textBox1.Text = ttal;\n                con.Close();\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n            }\n            finally\n            {\n                if (con.State == ConnectionState.Open)\n                {\n                    con.Close();\n                }\n\n            }\n</code></pre>\n\n<p>sorry if there is something you can't understand, English isn't my first language.</p>\n"}, {"tags": ["c#", "entity-framework", "ef-core-3.0"], "answers": [{"comments": [{"owner": {"reputation": 631, "user_id": 4180696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e7543e459f0b57af6fe62eaef73a44?s=128&d=identicon&r=PG&f=1", "display_name": "riemannzz", "link": "https://stackoverflow.com/users/4180696/riemannzz"}, "edited": false, "score": 0, "creation_date": 1586872132, "post_id": 59290906, "comment_id": 108283353, "body": "Spot on. Thank you."}], "tags": [], "owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "is_accepted": true, "score": 8, "last_activity_date": 1576084563, "creation_date": 1576084563, "answer_id": 59290906, "question_id": 59290754, "link": "https://stackoverflow.com/questions/59290754/net-core-ef-core-3-add-console-logging-to-dbcontext/59290906#59290906", "title": ".NET Core / EF.Core 3+ add Console logging to DbContext", "body": "<p>I think the initialization of logger is changed in EFCore 3.x. Try using this:</p>\n\n<pre><code>public static readonly ILoggerFactory factory \n    = LoggerFactory.Create(builder =&gt; { builder.AddConsole(); });\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/ef/core/miscellaneous/logging?tabs=v3\" rel=\"noreferrer\">See details here.</a></p>\n"}], "owner": {"reputation": 1785, "user_id": 1834787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c06bd5ac140ad017a995d6aa83cd8aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Node.JS", "link": "https://stackoverflow.com/users/1834787/node-js"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2751, "favorite_count": 1, "accepted_answer_id": 59290906, "answer_count": 1, "score": 2, "last_activity_date": 1576084563, "creation_date": 1576083953, "question_id": 59290754, "link": "https://stackoverflow.com/questions/59290754/net-core-ef-core-3-add-console-logging-to-dbcontext", "title": ".NET Core / EF.Core 3+ add Console logging to DbContext", "body": "<p>I'm wondering how to add console logging to EF.Core without getting an \"obsolete\" warning.</p>\n\n<p>Given:\n<code>DbContextOptionsBuilder&lt;BenchmarkDbContext&gt; builder = ...;</code></p>\n\n<p>I tried:</p>\n\n<pre><code>builder.UseLoggerFactory(new LoggerFactory().AddConsole())\n</code></pre>\n\n<p>And tried:</p>\n\n<pre><code>var factory = new LoggerFactory();\n\nfactory.AddProvider(new ConsoleLoggerProvider((a, b) =&gt; true, true));\n\nbuilder.UseLoggerFactory(factory)\n</code></pre>\n"}, {"tags": ["c#", ".net", "unity3d", "visual-studio-code"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user12531529"}, "is_accepted": true, "score": 1, "last_activity_date": 1576259899, "last_edit_date": 1576259899, "creation_date": 1576259143, "answer_id": 59327485, "question_id": 59290716, "link": "https://stackoverflow.com/questions/59290716/visual-studio-code-c-extension-does-not-recognize-the-unity-classes/59327485#59327485", "title": "Visual Studio Code - C# extension does not recognize the Unity classes", "body": "<p>You don't need .Net for working with Unity projects.\nJust install Microsoft .Net Framework 4.7.1 SDK to make your C# Omnisharp VS Code extension work properly. Nothing else should be done, just open your project and everything should be OK.</p>\n\n<p>See your VS Code OUTPUT->Omnisharp Log, it'll ask you to install .Net Framework SDK</p>\n\n<p>Also, you need to open your project with Unity Editor at least once, otherwise you'll get a lot of <code>The name 'gameObject' does not exist in the current context [Assembly-CSharp]csharp(CS0103)</code>, <code>The type or namespace name 'GameObject' could not be found (are you missing a using directive or an assembly reference?) [Assembly-CSharp]csharp(CS0246)</code> and so on erros in your VS Code even for a workable project.</p>\n"}], "owner": {"reputation": 305, "user_id": 5553962, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/65260546818887168ac7491b33bfaae0?s=128&d=identicon&r=PG&f=1", "display_name": "El_Merendero", "link": "https://stackoverflow.com/users/5553962/el-merendero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2430, "favorite_count": 0, "accepted_answer_id": 59327485, "answer_count": 1, "score": 1, "last_activity_date": 1576259899, "creation_date": 1576083780, "last_edit_date": 1576084106, "question_id": 59290716, "link": "https://stackoverflow.com/questions/59290716/visual-studio-code-c-extension-does-not-recognize-the-unity-classes", "title": "Visual Studio Code - C# extension does not recognize the Unity classes", "body": "<p>I'm trying to set up my VS Code in order to properly work with a Unity project using Windows 10 as OS. This is what I've done:</p>\n\n<ul>\n<li>Installation of Unity v.2019.3.0a2;</li>\n<li>Installation of Visual Studio Code v.1.40.2;</li>\n<li>Installation of C# (the Visual Studio Code extension);</li>\n<li>Installation of .Net;</li>\n<li>Setting up VS Code as Unity Script Editor (as described <a href=\"https://code.visualstudio.com/docs/other/unity\" rel=\"nofollow noreferrer\">here</a>);</li>\n</ul>\n\n<p>At this point I imported my project root folder in the VS Code workspace but the IntelliSense function doesn't work. So I read <a href=\"https://code.visualstudio.com/docs/languages/dotnet\" rel=\"nofollow noreferrer\">this guide</a> and then I ran:</p>\n\n<pre><code>dotnet new console\ndotnet run\n</code></pre>\n\n<p>Now it seems that the IntelliSense works but VS Code doesn't recognize the Unity classes and, for this reason, my project is full of errors. Is there a way to fix it or to import the UnityEngine package?</p>\n"}, {"tags": ["c#", "exception", "process"], "comments": [{"owner": {"reputation": 583, "user_id": 2720343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cvJ2G.jpg?s=128&g=1", "display_name": "Dortimer", "link": "https://stackoverflow.com/users/2720343/dortimer"}, "edited": false, "score": 1, "creation_date": 1576088983, "post_id": 59290682, "comment_id": 104788714, "body": "Is there a specific reason as to why you can&#39;t use a <code>try-catch</code> block in the event handler? This might have some useful information: <a href=\"https://stackoverflow.com/a/8745599/2720343\">stackoverflow.com/a/8745599/2720343</a>"}, {"owner": {"reputation": 372, "user_id": 2050381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8c40cc7933b602e3bebb8ce1499370?s=128&d=identicon&r=PG", "display_name": "klev", "link": "https://stackoverflow.com/users/2050381/klev"}, "reply_to_user": {"reputation": 583, "user_id": 2720343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cvJ2G.jpg?s=128&g=1", "display_name": "Dortimer", "link": "https://stackoverflow.com/users/2720343/dortimer"}, "edited": false, "score": 0, "creation_date": 1576090817, "post_id": 59290682, "comment_id": 104789460, "body": "i thought i was missing something, but didn&#39;t thought it was a bad practice. I will do it in another way. Thanks for the link!"}], "answers": [{"tags": [], "owner": {"reputation": 372, "user_id": 2050381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8c40cc7933b602e3bebb8ce1499370?s=128&d=identicon&r=PG", "display_name": "klev", "link": "https://stackoverflow.com/users/2050381/klev"}, "is_accepted": true, "score": 0, "last_activity_date": 1576147250, "creation_date": 1576147250, "answer_id": 59302734, "question_id": 59290682, "link": "https://stackoverflow.com/questions/59290682/how-to-catch-exception-thrown-by-a-datareceivedeventhandler/59302734#59302734", "title": "How to catch Exception thrown by a DataReceivedEventHandler?", "body": "<p>As Dortimer made me understand thanks to his <a href=\"https://stackoverflow.com/questions/59290682/how-to-catch-exception-thrown-by-a-datareceivedeventhandler#comment104788714_59290682\">comment</a>, to throw an exception from an event handler is a bad practice. So here's an equivalent way to achieve what i was trying to do:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>bool error = false;\nstring errorMsg = String.Empty;\n\npublic static void Main()\n{\n    try\n    {\n        using (Process process = CreateProcess())\n        {\n            process.Start();\n            process.BeginErrorReadLine();\n\n            process.WaitForExit();\n\n            if (error)\n            {\n                throw new Exception(errorMsg);\n            }\n        }   \n    }\n    catch (Exception e)\n    {\n        Console.WriteLine(e.Message);\n    }\n}\n\nprivate static Process CreateProcess()\n{\n    Process process = new Process();\n\n    process.ErrorDataReceived += ActionOnErrorDataReceived;\n\n    return process;\n}\n\nprivate static void ActionOnErrorDataReceived(object sender, DataReceivedEventArgs e)\n{\n    error = true;\n    errorMsg = e?.Data;\n\n    Process p = (sender as Process);\n    if (p != null &amp;&amp; p.HasExited == false)\n    {\n        p.Kill();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 2050381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8c40cc7933b602e3bebb8ce1499370?s=128&d=identicon&r=PG", "display_name": "klev", "link": "https://stackoverflow.com/users/2050381/klev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 59302734, "answer_count": 1, "score": 0, "last_activity_date": 1576147250, "creation_date": 1576083658, "last_edit_date": 1576088238, "question_id": 59290682, "link": "https://stackoverflow.com/questions/59290682/how-to-catch-exception-thrown-by-a-datareceivedeventhandler", "title": "How to catch Exception thrown by a DataReceivedEventHandler?", "body": "<p>How could i catch the <code>Exception</code> thrown by a <code>DataReceivedEventHandler</code> ?</p>\n\n<p>This post is the same as mine, but for async methods instead of handlers : <a href=\"https://stackoverflow.com/questions/5383310/catch-an-exception-thrown-by-an-async-void-method\">Catch an exception thrown by an async void method</a></p>\n\n<p>Here's an oversimplified version of my code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static void Main()\n{\n    try\n    {\n        using (Process process = CreateProcess())\n        {\n            process.Start();\n            process.BeginErrorReadLine();\n\n            process.WaitForExit();\n        }   \n    }\n    catch (Exception e)\n    {\n        Console.WriteLine(e.Message); // never goes here\n    }\n}\n\nprivate static Process CreateProcess()\n{\n    Process process = new Process();\n\n    process.ErrorDataReceived += ActionOnErrorDataReceived;\n\n    return process;\n}\n\nprivate static void ActionOnErrorDataReceived(object sender, DataReceivedEventArgs e)\n{\n    throw new Exception(e?.Data);\n}\n</code></pre>\n"}, {"tags": ["c#", "xml", "rest"], "comments": [{"owner": {"reputation": 214980, "user_id": 470005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09536b39b586f3ae555f8ce20d5d8bd1?s=128&d=identicon&r=PG", "display_name": "Sergey Berezovskiy", "link": "https://stackoverflow.com/users/470005/sergey-berezovskiy"}, "edited": false, "score": 0, "creation_date": 1576083814, "post_id": 59290664, "comment_id": 104786268, "body": "Just rename <code>Quantity</code> array field to <code>Quantities</code> which is true. Also I would use name <code>Value</code> instead of <code>QuantityString</code>"}, {"owner": {"reputation": 89, "user_id": 8073387, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh6.googleusercontent.com/-Wt_MuzU94JM/AAAAAAAAAAI/AAAAAAAAABE/l3vGrs3KKSQ/photo.jpg?sz=128", "display_name": "Ahmad Meer", "link": "https://stackoverflow.com/users/8073387/ahmad-meer"}, "reply_to_user": {"reputation": 214980, "user_id": 470005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09536b39b586f3ae555f8ce20d5d8bd1?s=128&d=identicon&r=PG", "display_name": "Sergey Berezovskiy", "link": "https://stackoverflow.com/users/470005/sergey-berezovskiy"}, "edited": false, "score": 0, "creation_date": 1576083916, "post_id": 59290664, "comment_id": 104786324, "body": "Can&#39;t I need to match this XML Structure."}, {"owner": {"reputation": 214980, "user_id": 470005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09536b39b586f3ae555f8ce20d5d8bd1?s=128&d=identicon&r=PG", "display_name": "Sergey Berezovskiy", "link": "https://stackoverflow.com/users/470005/sergey-berezovskiy"}, "edited": false, "score": 0, "creation_date": 1576084014, "post_id": 59290664, "comment_id": 104786372, "body": "So if your xml matches the required schema, what is the problem then?"}, {"owner": {"reputation": 89, "user_id": 8073387, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh6.googleusercontent.com/-Wt_MuzU94JM/AAAAAAAAAAI/AAAAAAAAABE/l3vGrs3KKSQ/photo.jpg?sz=128", "display_name": "Ahmad Meer", "link": "https://stackoverflow.com/users/8073387/ahmad-meer"}, "reply_to_user": {"reputation": 214980, "user_id": 470005, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09536b39b586f3ae555f8ce20d5d8bd1?s=128&d=identicon&r=PG", "display_name": "Sergey Berezovskiy", "link": "https://stackoverflow.com/users/470005/sergey-berezovskiy"}, "edited": false, "score": 0, "creation_date": 1576084124, "post_id": 59290664, "comment_id": 104786432, "body": "it&#39;s not matched, in their XML they have Quantity one and two.. but in mine, i have one list which inside of it Quantity one and two. using a list caused duplicate tags how to avoid it."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576084300, "post_id": 59290664, "comment_id": 104786516, "body": "Add following above public Quantity[] Quantity :  [XmlElement(ElementName = &quot;Quantity&quot;)]  The code is defaulting to an array type that is creating two levels of tags.  Using XmlElement will eliminate one level of tag."}, {"owner": {"reputation": 89, "user_id": 8073387, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh6.googleusercontent.com/-Wt_MuzU94JM/AAAAAAAAAAI/AAAAAAAAABE/l3vGrs3KKSQ/photo.jpg?sz=128", "display_name": "Ahmad Meer", "link": "https://stackoverflow.com/users/8073387/ahmad-meer"}, "edited": false, "score": 0, "creation_date": 1576084521, "post_id": 59290664, "comment_id": 104786609, "body": "Did this but the tag disappeared now."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 8073387, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh6.googleusercontent.com/-Wt_MuzU94JM/AAAAAAAAAAI/AAAAAAAAABE/l3vGrs3KKSQ/photo.jpg?sz=128", "display_name": "Ahmad Meer", "link": "https://stackoverflow.com/users/8073387/ahmad-meer"}, "edited": false, "score": 0, "creation_date": 1576085116, "post_id": 59291041, "comment_id": 104786893, "body": "what more logic I can share, this is using rest API, and I&#39;m trying to build the DataContract to match what I have in the XML sent."}], "tags": [], "owner": {"reputation": 1, "user_id": 8759382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b05670b741b96a7c9bf94995ea95b27?s=128&d=identicon&r=PG&f=1", "display_name": "proamg 9", "link": "https://stackoverflow.com/users/8759382/proamg-9"}, "is_accepted": false, "score": 0, "last_activity_date": 1576084995, "creation_date": 1576084995, "answer_id": 59291041, "question_id": 59290664, "link": "https://stackoverflow.com/questions/59290664/duplicate-xml-structure-tag-appear/59291041#59291041", "title": "Duplicate XML structure tag appear", "body": "<p>We need to see more of the code logic itself to get a better understanding your calling strategy.</p>\n"}], "owner": {"reputation": 89, "user_id": 8073387, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh6.googleusercontent.com/-Wt_MuzU94JM/AAAAAAAAAAI/AAAAAAAAABE/l3vGrs3KKSQ/photo.jpg?sz=128", "display_name": "Ahmad Meer", "link": "https://stackoverflow.com/users/8073387/ahmad-meer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576084995, "creation_date": 1576083570, "question_id": 59290664, "link": "https://stackoverflow.com/questions/59290664/duplicate-xml-structure-tag-appear", "title": "Duplicate XML structure tag appear", "body": "<p>I'm trying to build a Serliazation for an XML structure the Goal is to achieve a tag with multiple children such as quantity, and I can achieve that by adding a subclass inside the structure, however, the node of the class is appearing as well the child nodes as a duplicate for Example: </p>\n\n<p>The Goal is to Achieve this structure:</p>\n\n<pre><code>        &lt;Quantity&gt;\n          &lt;QuantityString&gt;13686.37&lt;/QuantityString&gt;\n          &lt;DataType&gt;float&lt;/DataType&gt;\n          &lt;UnitOfMeasure&gt;KG&lt;/UnitOfMeasure&gt;\n        &lt;/Quantity&gt;\n        &lt;Quantity&gt;\n          &lt;QuantityString&gt;13.69&lt;/QuantityString&gt;\n          &lt;DataType&gt;float&lt;/DataType&gt;\n          &lt;UnitOfMeasure&gt;TO&lt;/UnitOfMeasure&gt;\n        &lt;/Quantity&gt;\n</code></pre>\n\n<p>My Result appeared as follows:</p>\n\n<pre><code>      &lt;Quantity&gt;\n        &lt;Quantity&gt;\n          &lt;QuantityString&gt;sample string 1&lt;/QuantityString&gt;\n          &lt;DataType&gt;sample string 2&lt;/DataType&gt;\n          &lt;UnitOfMeasure&gt;sample string 3&lt;/UnitOfMeasure&gt;\n        &lt;/Quantity&gt;\n        &lt;Quantity&gt;\n          &lt;QuantityString&gt;sample string 1&lt;/QuantityString&gt;\n          &lt;DataType&gt;sample string 2&lt;/DataType&gt;\n          &lt;UnitOfMeasure&gt;sample string 3&lt;/UnitOfMeasure&gt;\n        &lt;/Quantity&gt;\n      &lt;/Quantity&gt;\n</code></pre>\n\n<p>The First Quantity comes from the Class it self:</p>\n\n<pre><code>[DataContract]\npublic class PersonShopList\n{\n    [DataMember(Name = \"Item\", Order = 1)]\n    public String ItemName{ get; set; }\n\n    [DataMember(Name = \"Quantity\", Order = 2)]\n    public Quantity[] Quantity;\n}\n\n[DataContract]\npublic class Quantity\n{\n    [DataMember(Name = \"QuantityString\", Order = 1)]\n    public String QuantityString { get; set; }\n\n    [DataMember(Name = \"DataType\", Order = 2)]\n    public String DataType { get; set; }\n\n    [DataMember(Name = \"UnitOfMeasure\", Order = 3)]\n    public String UnitOfMeasure { get; set; }\n}\n</code></pre>\n"}, {"tags": ["c#", "validation", "asp.net-core"], "comments": [{"owner": {"reputation": 5401, "user_id": 456669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/865f6e52b2997cf077edb24d807fd0ca?s=128&d=identicon&r=PG", "display_name": "Nikki9696", "link": "https://stackoverflow.com/users/456669/nikki9696"}, "edited": false, "score": 1, "creation_date": 1576086293, "post_id": 59290556, "comment_id": 104787466, "body": "Maybe something like this, but for your situation? <a href=\"https://stackoverflow.com/questions/58515337/how-to-define-conditional-model-binding-in-asp-net-core-razor-pages\" title=\"how to define conditional model binding in asp net core razor pages\">stackoverflow.com/questions/58515337/&hellip;</a>"}, {"owner": {"reputation": 8924, "user_id": 10201850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rz0ZX.jpg?s=128&g=1", "display_name": "Xueli Chen", "link": "https://stackoverflow.com/users/10201850/xueli-chen"}, "edited": false, "score": 1, "creation_date": 1576129241, "post_id": 59290556, "comment_id": 104800312, "body": "Why did you put the <code>ModelState.IsValid</code> in Delete handler ? Generally, <code>ModelState.IsValid</code> is performed when adding or updating data, and you could judge whether there is data to be deleted in the database before deleting."}, {"owner": {"reputation": 2587, "user_id": 10823490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58aab0dd119c8dac4dc2bc5a209c3f11?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/10823490/jackal"}, "reply_to_user": {"reputation": 8924, "user_id": 10201850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rz0ZX.jpg?s=128&g=1", "display_name": "Xueli Chen", "link": "https://stackoverflow.com/users/10201850/xueli-chen"}, "edited": false, "score": 0, "creation_date": 1576138039, "post_id": 59290556, "comment_id": 104803345, "body": "@XueliChen Good point. I&#39;m so used to check modelstate on every handler that i didn&#39;r realize it is not necessary here. Nonetheless, it is good to know a way around this in case of multiple forms on the same page."}], "owner": {"reputation": 2587, "user_id": 10823490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58aab0dd119c8dac4dc2bc5a209c3f11?s=128&d=identicon&r=PG&f=1", "display_name": "Jackal", "link": "https://stackoverflow.com/users/10823490/jackal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576083177, "creation_date": 1576083177, "question_id": 59290556, "link": "https://stackoverflow.com/questions/59290556/asp-net-core-ignore-property-from-different-form-posted", "title": "Asp .NET Core Ignore property from different form posted", "body": "<p>I have 2 forms on a single page and each one has a different Property. However, in my Delete Handler, the modelstate checks for validation from a property that is not inside the respective form... I only want the validation of the <strong>Mail</strong> property to be done on the OnPostAsync Handler and not on the Delete</p>\n\n<pre><code>[BindProperty]\npublic StockMailDelivery Mail { get; set; }\n[BindProperty]\npublic IList&lt;int&gt; MailsToDelete { get; set; }\npublic IList&lt;StockMailDelivery&gt; Mails { get; set; }\n\n#region Handlers\npublic void OnGet()\n{\n    GetData();\n}\n\npublic async Task&lt;IActionResult&gt; OnPostAsync()\n{\n    if (!ModelState.IsValid)\n    {\n        GetData();\n        _toastNotification.AddErrorToastMessage(\"Dados inv\u00e1lidos.\");\n        return Page();\n    }\n\n    _context.StockMailDelivery.Add(Mail);\n\n    try\n    {\n        await _context.SaveChangesAsync();\n    }\n    catch (DbUpdateException ex)\n    {\n        _toastNotification.AddErrorToastMessage(\"Falha ao adicionar.\");\n        _logger.LogError(ex.InnerException.ToString());\n        GetData();\n        return Page();\n    }\n\n    _toastNotification.AddSuccessToastMessage(\"Email adicionado.\");\n    return RedirectToPage(\"StockMailDelivery\");\n}\npublic async Task&lt;IActionResult&gt; OnPostDeleteAsync()\n{\n    if (!ModelState.IsValid)\n    {\n        GetData();\n        _toastNotification.AddErrorToastMessage(\"Dados inv\u00e1lidos.\");\n        return Page();\n    }\n\n\n    var mailsToDelete = new List&lt;StockMailDelivery&gt;();\n    foreach(var item in MailsToDelete)\n    {\n        mailsToDelete.Add(new StockMailDelivery(item));\n    }\n\n    _context.StockMailDelivery.RemoveRange(mailsToDelete);\n\n    try\n    {\n        await _context.SaveChangesAsync();\n    }\n    catch(DbUpdateException ex)\n    {\n        _toastNotification.AddErrorToastMessage(\"Falha ao eliminar.\");\n        _logger.LogError(ex.InnerException.ToString());\n        GetData();\n        return Page();\n    }\n\n    _toastNotification.AddSuccessToastMessage($\"{MailsToDelete.Count()} Email(s) eliminados.\");\n    return RedirectToPage(\"Mail\");\n}\n</code></pre>\n\n<p>html </p>\n\n<pre><code>        &lt;form method=\"post\"&gt;\n            &lt;card&gt;\n                &lt;card-header icon=\"fas fa-plus\" title=\"Adicionar Recipiente\"&gt;&lt;/card-header&gt;\n                &lt;card-body&gt;\n                    &lt;label asp-for=\"Mail.Email\"&gt;&lt;/label&gt;\n                    &lt;input asp-for=\"Mail.Email\" class=\"form-control\" /&gt;\n                &lt;/card-body&gt;\n                &lt;card-footer&gt;\n                    &lt;button class=\"btn btn-success btn-sm\"&gt;&lt;i class=\"fas fa-plus\"&gt;&lt;/i&gt; Adicionar&lt;/button&gt;\n                &lt;/card-footer&gt;\n            &lt;/card&gt;\n        &lt;/form&gt;\n\n\n\n\n    &lt;form id=\"delete-mail-form\" asp-page-handler=\"Delete\"&gt;\n        &lt;div class=\"table-responsive\"&gt;\n            &lt;table id=\"tblEmails\" class=\"table table-sm table-bordered\" style=\"width:100%;display:none;\"&gt;\n                &lt;thead class=\"bg-olive\"&gt;\n                    &lt;tr&gt;\n                        &lt;td&gt;@Html.DisplayNameFor(model =&gt; model.Mails[0].Id)&lt;/td&gt;\n                        &lt;td&gt;@Html.DisplayNameFor(model =&gt; model.Mails[0].Email)&lt;/td&gt;\n                        &lt;td&gt;&lt;/td&gt;\n                    &lt;/tr&gt;\n                &lt;/thead&gt;\n                &lt;tbody&gt;\n                    @for (int i = 0; i &lt; Model.Mails.Count(); i++)\n                    {\n                        &lt;tr&gt;\n                            &lt;td&gt;\n                                @Html.DisplayFor(model =&gt; Model.Mails[i].Id)\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                @Html.DisplayFor(model =&gt; Model.Mails[i].Email)\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                &lt;input type=\"checkbox\" onclick=\"selectRow(this)\" /&gt;\n                                &lt;input type=\"hidden\" asp-for=\"MailsToDelete[i]\" value=\"@Model.Mails[i].Id\" /&gt;\n                            &lt;/td&gt;\n                        &lt;/tr&gt;\n                    }\n                &lt;/tbody&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n    &lt;/form&gt;\n</code></pre>\n"}, {"tags": ["c#", "ffmpeg", "process", "file-writing"], "comments": [{"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1576084568, "post_id": 59290552, "comment_id": 104786632, "body": "Share full command."}, {"owner": {"reputation": 151, "user_id": 7237421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/169dbdc7aa72bf937d62c8d16153a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Czarnek", "link": "https://stackoverflow.com/users/7237421/matthew-czarnek"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1576086010, "post_id": 59290552, "comment_id": 104787344, "body": "Sorry, have some html open and close brackets to represent variables, which stack decided to remove. Should be fixed now."}], "owner": {"reputation": 151, "user_id": 7237421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/169dbdc7aa72bf937d62c8d16153a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Czarnek", "link": "https://stackoverflow.com/users/7237421/matthew-czarnek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576085967, "creation_date": 1576083157, "last_edit_date": 1576085967, "question_id": 59290552, "link": "https://stackoverflow.com/questions/59290552/how-to-check-when-ffmpeg-completes-a-video-segment", "title": "How to check when ffmpeg completes a video segment?", "body": "<p>I'm using a ffmpeg Process from within my C# program. I start it off and run it in segmented mode.</p>\n\n<p>ffmpeg -i rtsp://127.0.0.1/axis-media/media.amp?resolution=1280x720 -c copy -map 0 -f segment -segment_time 21600 -strftime 1 -reset_timestamps 1 -segment_format flv \"C:\\REPLACE_ME_WITH_REAL_DIRECTORY\\%Y-%m-%d_%H%M%S.flv\"</p>\n\n<p>This creates a number of recording segments each in their own folder that are 6 hours long. I now need to be able to detect whether a file has started being written and whether it's completed being written as fast as possible to record it to a database. And this needs to work even in the face of crashes.</p>\n\n<p>I'm polling the folder and can detect that a file has started being written. But detecting whether a file has completed is much trickier. Possibly can be done by polling whether or not a file is being written to. Does ffmpeg have some sort of support for this? Such as when it finishes a file it can launch another program or run a command?  </p>\n\n<p>I will occasionally scan through all the files and make sure that I record the ones that are there in case one is missed. But the more reliable, the better for this application.</p>\n"}, {"tags": ["c#", "selenium", "unit-testing", "selenium-webdriver", "nunit"], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 1875540, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1219a8886cd0947f812814481f10adc8?s=128&d=identicon&r=PG", "display_name": "Zuno", "link": "https://stackoverflow.com/users/1875540/zuno"}, "edited": false, "score": 0, "creation_date": 1576181055, "post_id": 59293121, "comment_id": 104825818, "body": "True champion, thank you :) There is one side effect - in Visual Studio, when you change code or add tests (perhaps both) and then Build, a browser instance is loaded up for every test for every browser in that test&#39;s list. This problem doesn&#39;t occur if running via a console like NUnit Console Runner."}], "tags": [], "owner": {"reputation": 2824, "user_id": 2869055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2c7c67d2983e8db074cbb68daa86a1?s=128&d=identicon&r=PG", "display_name": "mwilczynski", "link": "https://stackoverflow.com/users/2869055/mwilczynski"}, "is_accepted": true, "score": 2, "last_activity_date": 1576094115, "creation_date": 1576094115, "answer_id": 59293121, "question_id": 59290543, "link": "https://stackoverflow.com/questions/59290543/how-do-i-call-a-method-just-after-each-test-has-been-constructed-c-nunit/59293121#59293121", "title": "How do I call a method just after each test has been constructed? C#, NUnit", "body": "<p>Do you use <code>Browsers</code> anywhere else in the test? Or is it just needed for instantiating <code>WebDriver</code>?</p>\n\n<p>You could possibly either create yet another method or change current one to invoke driver after retrieving <code>browserList</code> and provide it to test case ie.:</p>\n\n<pre><code>   public static IEnumerable&lt;IWebDriver&gt; BrowserListInitialized()\n    {\n        return BrowserList().Select(browser =&gt; InvokeDriver(browser));            \n    }\n</code></pre>\n\n<p>Change <code>InvokeDriver</code> to static and to return initialized driver:</p>\n\n<pre><code>    public static IWebDriver InvokeDriver(Browsers browser)\n    {\n        switch (browser)\n        {\n            case Browsers.Chrome:\n                return new ChromeDriver();\n                break;\n            case Browsers.Firefox:\n                return new FirefoxDriver();\n                break;\n            case Browsers.Edge:\n                return new EdgeDriver();\n                break;\n            default:\n                throw new Exception(\"InitialiseDriver(): chosen browser not recognised.\");\n        }\n    }\n</code></pre>\n\n<p>And use it:</p>\n\n<pre><code>    [Test]\n    public void Test1([ValueSource(\"BrowserListInitialized\")] IWebDriver driver)\n    {\n        //driver already initialized and passed as an argument\n        driver.DoStuff();\n    }\n</code></pre>\n"}], "owner": {"reputation": 384, "user_id": 1875540, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/1219a8886cd0947f812814481f10adc8?s=128&d=identicon&r=PG", "display_name": "Zuno", "link": "https://stackoverflow.com/users/1875540/zuno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1576444012, "accepted_answer_id": 59293121, "answer_count": 1, "score": 0, "last_activity_date": 1576094371, "creation_date": 1576083133, "last_edit_date": 1576094371, "question_id": 59290543, "link": "https://stackoverflow.com/questions/59290543/how-do-i-call-a-method-just-after-each-test-has-been-constructed-c-nunit", "closed_reason": "Needs more focus", "title": "How do I call a method just after each test has been constructed? C#, NUnit", "body": "<p>I'm writing Web UI tests using NUnit + Selenium. I'm using ValueSource to pass a list of browsers into a test method, this creates a copy of that test for each browser in the test runner. Inside the test method, I call another method, passing the browser into it so the relevant browser driver is invoked and the test can be conducted.</p>\n\n<p>The issue I'm having is that I need to call the InvokeDriver(browser) method in every single test case, which duplicates code. All the tests need to call this method, passing through the browser from the ValueSource list. So I need a way to call this method <em>just after</em> the test is constructed but without this code repetition. I can't call the method in [SetUp] because that gets run before the test (at which time there is no ValueSource value available to pass into InvokeDriver).</p>\n\n<pre><code>namespace CoreSeleniumFramework.Tests\n{\n    public class HomePageTests : TestBase\n    {\n        [Test]\n        public void Test1([ValueSource(\"BrowserList\")] Browsers browser)\n        {\n            InvokeDriver(browser);\n            // Do testing here\n        }\n    }\n}\n</code></pre>\n\n<p>Test base...</p>\n\n<pre><code>namespace CoreSeleniumFramework.Base\n{\n    public enum TestCategories\n    {\n        Acceptance, Regression, Sanity\n    }\n\n    public enum Browsers\n    {\n        Chrome, Firefox, Edge\n    }\n\n    [TestFixture]\n    public class TestBase\n    {\n        public static TestCategories categoryToTest = TestCategories.Acceptance;\n\n        public static List&lt;Browsers&gt; acceptanceBrowsers = new List&lt;Browsers&gt;() {\n            Browsers.Chrome\n        };\n        public static List&lt;Browsers&gt; regressionBrowsers = new List&lt;Browsers&gt;() {\n            Browsers.Firefox\n        };\n        public static List&lt;Browsers&gt; sanityBrowsers = new List&lt;Browsers&gt;() {\n            Browsers.Edge\n        };\n\n        public IWebDriver driver;\n\n        public void InvokeDriver(Browsers browser)\n        {\n            switch (browser)\n            {\n                case Browsers.Chrome:\n                    driver = new ChromeDriver();\n                    break;\n                case Browsers.Firefox:\n                    driver = new FirefoxDriver();\n                    break;\n                case Browsers.Edge:\n                    driver = new EdgeDriver();\n                    break;\n                default:\n                    throw new Exception(\"InitialiseDriver(): chosen browser not recognised.\");\n            }\n        }\n\n        public static List&lt;Browsers&gt; BrowserList()\n        {\n            List&lt;Browsers&gt; browserList;\n\n            switch (categoryToTest)\n            {\n                case TestCategories.Acceptance:\n                    browserList = acceptanceBrowsers;\n                    break;\n                case TestCategories.Regression:\n                    browserList = regressionBrowsers;\n                    break;\n                case TestCategories.Sanity:\n                    browserList = sanityBrowsers;\n                    break;\n                default:\n                    throw new Exception(\"BrowserList(): no browser list available.\");\n            }\n\n            return browserList;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "wcf", "asp.net-core"], "comments": [{"owner": {"reputation": 6039, "user_id": 10163251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fwrh.jpg?s=128&g=1", "display_name": "Abraham Qian", "link": "https://stackoverflow.com/users/10163251/abraham-qian"}, "edited": false, "score": 0, "creation_date": 1583487251, "post_id": 59290464, "comment_id": 107141526, "body": "Try to generate a client code by adding service reference, then we can check the binding configuration automatically generated on the client-side."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6635827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1cafae0ed066c4c13efdce637fa752?s=128&d=identicon&r=PG&f=1", "display_name": "Fraser", "link": "https://stackoverflow.com/users/6635827/fraser"}, "edited": false, "score": 0, "creation_date": 1576089830, "post_id": 59290528, "comment_id": 104789051, "body": "So if I set my ClientCredentialType to &#39;None&#39; it should work? It looks as though that is what allows Anonymous authentication - <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.httpclientcredentialtype?view=netframework-4.8#System_ServiceModel_HttpClientCredentialType_None\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a>"}, {"owner": {"reputation": 751, "user_id": 3376474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ckj2N.jpg?s=128&g=1", "display_name": "Jos&#233; Am&#237;lcar Casimiro", "link": "https://stackoverflow.com/users/3376474/jos%c3%a9-am%c3%adlcar-casimiro"}, "reply_to_user": {"reputation": 139, "user_id": 6635827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1cafae0ed066c4c13efdce637fa752?s=128&d=identicon&r=PG&f=1", "display_name": "Fraser", "link": "https://stackoverflow.com/users/6635827/fraser"}, "edited": false, "score": 0, "creation_date": 1576144661, "post_id": 59290528, "comment_id": 104806631, "body": "depends on the code implemented in the service, did you have a chance to test?"}], "tags": [], "owner": {"reputation": 751, "user_id": 3376474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ckj2N.jpg?s=128&g=1", "display_name": "Jos&#233; Am&#237;lcar Casimiro", "link": "https://stackoverflow.com/users/3376474/jos%c3%a9-am%c3%adlcar-casimiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1576083073, "creation_date": 1576083073, "answer_id": 59290528, "question_id": 59290464, "link": "https://stackoverflow.com/questions/59290464/how-to-fix-the-http-request-was-forbidden-with-client-authentication-scheme-an/59290528#59290528", "title": "How to fix &quot;The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;&quot;", "body": "<p><strong>result.Security.Mode = System.ServiceModel.BasicHttpSecurityMode.Transport;</strong> </p>\n\n<p>Security is provided using HTTPS. The service must be configured with SSL certificates. The SOAP message is protected as a whole using HTTPS. The service is authenticated by the client using the service's SSL certificate. The client authentication is controlled through the ClientCredentialType.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.basichttpsecuritymode?view=netframework-4.8\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/api/system.servicemodel.basichttpsecuritymode?view=netframework-4.8</a></p>\n"}, {"comments": [{"owner": {"reputation": 1600, "user_id": 497458, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/731d911620ede276d8dd1b15e7740e8a?s=128&d=identicon&r=PG", "display_name": "President Camacho", "link": "https://stackoverflow.com/users/497458/president-camacho"}, "edited": false, "score": 0, "creation_date": 1583489130, "post_id": 59299732, "comment_id": 107142550, "body": "Solved it for me :)"}], "tags": [], "owner": {"reputation": 6039, "user_id": 10163251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Fwrh.jpg?s=128&g=1", "display_name": "Abraham Qian", "link": "https://stackoverflow.com/users/10163251/abraham-qian"}, "is_accepted": false, "score": 1, "last_activity_date": 1576136179, "creation_date": 1576136179, "answer_id": 59299732, "question_id": 59290464, "link": "https://stackoverflow.com/questions/59290464/how-to-fix-the-http-request-was-forbidden-with-client-authentication-scheme-an/59299732#59299732", "title": "How to fix &quot;The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;&quot;", "body": "<p>This error typically indicates that the WCF server authenticates the client-side with a certificate. The error will occur when the trust relationship between the server and the client have not been established yet.<br>\n<a href=\"https://i.stack.imgur.com/uBckr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uBckr.png\" alt=\"enter image description here\"></a><br>\nIn general, we need to provide client credential to be authenticated by the server so that be able to call the service. As for what kind of credentials need to be provided, it depends on the binding information on the server-side.</p>\n\n<pre><code> BasicHttpBinding binding = new BasicHttpBinding();\n            binding.Security.Mode = BasicHttpSecurityMode.Transport;\nbinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Windows;\n</code></pre>\n\n<p>Namely, the above errors have indicated that the server authenticates the client with a certificate.</p>\n\n<pre><code>binding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Certificate;\n</code></pre>\n\n<p>About authenticating the client with a certificate, you could refer to the below link for details.<br>\n<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/transport-security-with-certificate-authentication\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/transport-security-with-certificate-authentication</a><br>\nFeel free to let me know if there is anything I can help with.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 7578947, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-2AXtakXGJkI/AAAAAAAAAAI/AAAAAAAAJXo/56d2Rg-duoI/photo.jpg?sz=128", "display_name": "Aastha Kathuria", "link": "https://stackoverflow.com/users/7578947/aastha-kathuria"}, "edited": false, "score": 0, "creation_date": 1615186685, "post_id": 61519087, "comment_id": 117603423, "body": "what was the firewall parameter that you removed ?"}], "tags": [], "owner": {"reputation": 139, "user_id": 6635827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1cafae0ed066c4c13efdce637fa752?s=128&d=identicon&r=PG&f=1", "display_name": "Fraser", "link": "https://stackoverflow.com/users/6635827/fraser"}, "is_accepted": true, "score": 1, "last_activity_date": 1588235351, "creation_date": 1588235351, "answer_id": 61519087, "question_id": 59290464, "link": "https://stackoverflow.com/questions/59290464/how-to-fix-the-http-request-was-forbidden-with-client-authentication-scheme-an/61519087#61519087", "title": "How to fix &quot;The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;&quot;", "body": "<p>Thanks for all the suggestions. This was actually just caused by a firewall rule that was setup within our organisation. Once that was removed the code worked as expected.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 6635827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1cafae0ed066c4c13efdce637fa752?s=128&d=identicon&r=PG&f=1", "display_name": "Fraser", "link": "https://stackoverflow.com/users/6635827/fraser"}, "edited": false, "score": 0, "creation_date": 1589897884, "post_id": 61893263, "comment_id": 109471605, "body": "That&#39;s exactly what was causing the issue :) I managed to sort it out after some time."}], "tags": [], "owner": {"reputation": 41, "user_id": 10598834, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aHRF5MBYTho/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAUIlXPPZ8xWDJugwWiFpH6rO9t3w/mo/photo.jpg?sz=128", "display_name": "Ram", "link": "https://stackoverflow.com/users/10598834/ram"}, "is_accepted": false, "score": 3, "last_activity_date": 1589898941, "last_edit_date": 1589898941, "creation_date": 1589897689, "answer_id": 61893263, "question_id": 59290464, "link": "https://stackoverflow.com/questions/59290464/how-to-fix-the-http-request-was-forbidden-with-client-authentication-scheme-an/61893263#61893263", "title": "How to fix &quot;The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;&quot;", "body": "<p>This more linked to firewall rules within corporate network.</p>\n\n<p>I had same issue using non authorized proxy but got resolved secured proxy with ntlm <code>ClientCredentialType</code></p>\n"}], "owner": {"reputation": 139, "user_id": 6635827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee1cafae0ed066c4c13efdce637fa752?s=128&d=identicon&r=PG&f=1", "display_name": "Fraser", "link": "https://stackoverflow.com/users/6635827/fraser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12254, "favorite_count": 0, "accepted_answer_id": 61519087, "answer_count": 4, "score": 1, "last_activity_date": 1589898941, "creation_date": 1576082770, "last_edit_date": 1576082924, "question_id": 59290464, "link": "https://stackoverflow.com/questions/59290464/how-to-fix-the-http-request-was-forbidden-with-client-authentication-scheme-an", "title": "How to fix &quot;The HTTP request was forbidden with client authentication scheme &#39;Anonymous&#39;&quot;", "body": "<p>I'm having some issues implementing a client that talks to a WCF service. It's a WCF hosted by another company so I don't have access to its code. I used the Connected Service provider tool in Visual Studio to generate the client code so that I could make requests and everything works fine on my local machine. I am having an issue on our development environment where I receive the following error if I try to make a request with the client:</p>\n\n<pre><code>The HTTP request was forbidden with client authentication scheme 'Anonymous'\n</code></pre>\n\n<p>I've been looking at the client code (it's a lot of code) which is generated by the Provider tool and I think it may have something to do with the following block of code.</p>\n\n<pre><code>System.ServiceModel.BasicHttpBinding result = new System.ServiceModel.BasicHttpBinding();\nresult.MaxBufferSize = int.MaxValue;\nresult.ReaderQuotas = System.Xml.XmlDictionaryReaderQuotas.Max;\nresult.MaxReceivedMessageSize = int.MaxValue;\nresult.AllowCookies = true;\nresult.Security.Mode = System.ServiceModel.BasicHttpSecurityMode.Transport;\nreturn result;\n</code></pre>\n"}, {"tags": ["c#", ".net", "async-await"], "comments": [{"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 8, "creation_date": 1576082743, "post_id": 59290394, "comment_id": 104785746, "body": "In the first code block you start each task and wait for it to complete before moving to the next task and doing the same, they run in sequence where the next one only starts after the previous one completes. Think of that block like a relay race. In the second block of code you start each task first and then await them to completion one by one. They are running in parallel. Think of that like a race where everyone starts at the same time."}, {"owner": {"reputation": 5883, "user_id": 888617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0781deefa89f1c7242c8ecd28b7337c2?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/888617/justin"}, "edited": false, "score": 0, "creation_date": 1576088354, "post_id": 59290394, "comment_id": 104788400, "body": "As an aside for future reference you can also wait for multiple things to finish using the <code>Task.WaitAll</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 460, "user_id": 12477070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d36f204dd409830f00f1299cce1522?s=128&d=identicon&r=PG&f=1", "display_name": "jasonmchoe", "link": "https://stackoverflow.com/users/12477070/jasonmchoe"}, "is_accepted": false, "score": 5, "last_activity_date": 1576082935, "creation_date": 1576082935, "answer_id": 59290501, "question_id": 59290394, "link": "https://stackoverflow.com/questions/59290394/what-is-the-difference-between-this-two-await-calls/59290501#59290501", "title": "What is the difference between this two await calls", "body": "<p>In variant 2, all three tasks have started before you call <code>await</code> on them. In variant 1, you wait for each to finish before starting the next.</p>\n"}, {"tags": [], "owner": {"reputation": 42271, "user_id": 37815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/goSUJ.png?s=128&g=1", "display_name": "Bryan Watts", "link": "https://stackoverflow.com/users/37815/bryan-watts"}, "is_accepted": false, "score": 1, "last_activity_date": 1576083076, "creation_date": 1576083076, "answer_id": 59290529, "question_id": 59290394, "link": "https://stackoverflow.com/questions/59290394/what-is-the-difference-between-this-two-await-calls/59290529#59290529", "title": "What is the difference between this two await calls", "body": "<p>A <code>Task</code> starts running as soon as you call the method. You are calling <code>Task1</code>, <code>Task2</code>, and <code>Task3</code> without awaiting any of them, so they all start running simultaneously.</p>\n\n<p>In the second part, you are calling <code>Task1</code>, then awaiting it, before calling <code>Task2</code> and <code>Task3</code>. This means <code>Task2</code> doesn't start until <code>Task1</code> finishes, and <code>Task3</code> doesn't start until <code>Task2</code> finishes. They run one after the other, stretching out the total run time.</p>\n"}, {"tags": [], "owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "is_accepted": false, "score": 1, "last_activity_date": 1576083274, "creation_date": 1576083274, "answer_id": 59290578, "question_id": 59290394, "link": "https://stackoverflow.com/questions/59290394/what-is-the-difference-between-this-two-await-calls/59290578#59290578", "title": "What is the difference between this two await calls", "body": "<p>In the first code block you start each task and wait for it to complete before moving to the next task and doing the same, they run in sequence where the next one only starts after the previous one completes. Think of this like a relay race, each racer must wait for the previous racer to complete before starting.</p>\n\n<p>In the second block of code you start each of the 3 tasks first and then await them to completion one by one. They are running in parallel because you started them at nearly the same time. Think of that like a race where everyone starts at the same time and then you wait for them to complete.</p>\n"}, {"tags": [], "owner": {"reputation": 28745, "user_id": 1202807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e09276b9edb245e928e7163b27b15691?s=128&d=identicon&r=PG", "display_name": "Gabriel Luci", "link": "https://stackoverflow.com/users/1202807/gabriel-luci"}, "is_accepted": true, "score": 4, "last_activity_date": 1576089726, "last_edit_date": 1576089726, "creation_date": 1576089055, "answer_id": 59291991, "question_id": 59290394, "link": "https://stackoverflow.com/questions/59290394/what-is-the-difference-between-this-two-await-calls/59291991#59291991", "title": "What is the difference between this two await calls", "body": "<p>The other answers are partially right, but I wanted to write my own answer to clear something up.</p>\n\n<p><strong>The tasks are not started in parallel.</strong></p>\n\n<p>Strictly speaking, \"parallel\" means that two lines of code are being evaluated simultaneously. That doesn't happen here.</p>\n\n<p>Every asynchronous method starts out running synchronously. The magic happens when <code>await</code> acts on an incomplete <code>Task</code> (e.g. when an I/O request is started). At that point, the method <em>returns</em> its own incomplete <code>Task</code> and the continuation of the method is scheduled for later.</p>\n\n<p>When you do this:</p>\n\n<pre><code>var t1 = Task1();\nvar t2 = Task2();\nvar t3 = Task3();\n</code></pre>\n\n<p>This is what happens:</p>\n\n<ol>\n<li><code>Task1</code> starts executing.</li>\n<li>At the first <code>await</code>, <code>Task1</code> returns a <code>Task</code>.</li>\n<li><code>Task2</code> starts executing.</li>\n<li>At the first <code>await</code>, <code>Task2</code> returns a <code>Task</code>.</li>\n<li><code>Task3</code> starts executing.</li>\n<li>At the first <code>await</code>, <code>Task3</code> returns a <code>Task</code>.</li>\n</ol>\n\n<p>So what makes this run faster is that your code uses the time while <code>Task1</code> is waiting for a response to start the request in <code>Task2</code>.</p>\n\n<hr>\n\n<p>The <em>continuations</em> of those tasks <em>might</em> run in parallel depending on the circumstances.</p>\n\n<p>In a situation where there is a synchronization context (like ASP.NET), the continuations must come back to the same context and nothing will run in parallel. That means that execution of <code>Task1</code> will not continue until the nothing else is running under that context. In your code, that happens at:</p>\n\n<pre><code>m1 = await t1;\n</code></pre>\n\n<p>Only after that line, the current context is freed, the continuation of <code>Task1</code> can run in that context, and when that's done, everything after <code>await t1</code> is put on the \"to-do\" list to complete.</p>\n\n<p>If you are running in a situation where there is no synchronization context (like <a href=\"https://blog.stephencleary.com/2017/03/aspnetcore-synchronization-context.html\" rel=\"nofollow noreferrer\">ASP.NET Core</a>), or you specify <code>.ConfigureAwait(false)</code> to tell it that you do not need it to return to the same context, the continuations of the tasks will run on ThreadPool threads. That means that the continuations of all three tasks could run in parallel on different threads. If that happens, then by the time you hit <code>await t1</code>, it could already be done.</p>\n\n<hr>\n\n<p>If you do this:</p>\n\n<pre><code>var m1 = await Task1();\nvar m2 = await Task2();\nvar m3 = await Task3();\n</code></pre>\n\n<p>You wait until <code>Task1</code> finishes entirely before even starting <code>Task2</code>. There is still benefit in this depending on your application. In ASP.NET, for example, it frees the thread to be used by some other unrelated request coming in. In a desktop app, it could free the UI thread to respond to user input.</p>\n"}, {"tags": [], "owner": {"reputation": 11114, "user_id": 402366, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/43074670e3a479a1d3ae5242ce00819e?s=128&d=identicon&r=PG", "display_name": "Paulo Morgado", "link": "https://stackoverflow.com/users/402366/paulo-morgado"}, "is_accepted": false, "score": -1, "last_activity_date": 1576097817, "creation_date": 1576097817, "answer_id": 59293953, "question_id": 59290394, "link": "https://stackoverflow.com/questions/59290394/what-is-the-difference-between-this-two-await-calls/59293953#59293953", "title": "What is the difference between this two await calls", "body": "<p>The problem here is that you're including JIT compilation in your measures.</p>\n\n<p>Have you tried switching the first option with the second to see how it measures?</p>\n\n<p>If you look at <a href=\"https://sharplab.io/#v2:D4AQTAjAsAUCAMACEEB0ARAlgQwOYDsB7AZwBdMBjYgblgWQgFZa4BmZMRAYVgG9ZEg5AA5kANkQBZbJnwAKAJQCh/GEPWIAyqUIAHAO7ZSFABaJi+xAF5E+AKaXtew8ZOKWyjYgD03xADVsACccfFI7RGg1L3N9VG1g0ndPDQA3YMQ5AFsIABpELLB8rNYFa2QATikIZOivFArsiAUWGIZGwpaU9Qbs0taYi3idXVq23qGAUQAbbF1iOwATSUxp6cwFikJ8ReIumG6hXwDg0PDEMEPBIYAlOzJEsZim4qKC0vKQKska/fGIDrNAb1AHZMB/GK9EoQrxDJyjGEaCZxGZzBbLVbrTbbXaIgC+KRSIFEIDEAB45CgkDl8lSCm86dCAHzVRQpVRtdJBAoQT5VAAq2GIAGtfsC0hlCnzEIKRWAnl4ue9pbLhawFUiAOyZGn04r9FIEuqIIkk8mUiDUvIMakMy3vBQsyTypTGjkxJWkXk2VViq6IT2cH1C4Uu8XqT3sYMi9WIiOS72VRBe8NCJVSmxfZNgVOCdNRpOkVi55Dal56h3io0pY7oOwAM1kEUIpBMdm5WTsrcIu1pYHuiGwO1s2E7xF02AoA7bQTsRPYxPEZKpLN9bLd/qzpIwdlmAE85Ix4Me40IQNqAES+xCz7CLPcXqtCWDzkRLlcykMu9mbqrbuv7oex7wKegjnogV5fjedh3g+VYvsaIALmay6WquIaxj+xo9H+Yg7oBR4niW4GQTG0GwY+hqwHiQA==\" rel=\"nofollow noreferrer\">the compiler generated code</a>, you'll see that there are no significant differences.</p>\n\n<p>The effectively measure performance, you need to use something like <a href=\"https://benchmarkdotnet.org/\" rel=\"nofollow noreferrer\">BenchMarkDotNet</a>.</p>\n"}], "owner": {"reputation": 1278, "user_id": 1398504, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5360d280de531e0f43242db0cc7f88d2?s=128&d=identicon&r=PG", "display_name": "GreenEyedAndy", "link": "https://stackoverflow.com/users/1398504/greeneyedandy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 59291991, "answer_count": 5, "score": 2, "last_activity_date": 1576097817, "creation_date": 1576082541, "question_id": 59290394, "link": "https://stackoverflow.com/questions/59290394/what-is-the-difference-between-this-two-await-calls", "title": "What is the difference between this two await calls", "body": "<p>I have the following code:</p>\n\n<pre><code>async Task Main()\n{\n    Stopwatch sw = new Stopwatch();\n\n    // Variante 1\n    sw.Start();\n    var m1 = await Task1();\n    var m2 = await Task2();\n    var m3 = await Task3();\n    Console.WriteLine(m1);\n    Console.WriteLine(m2);\n    Console.WriteLine(m3);\n    sw.Stop();\n    Console.WriteLine(sw.ElapsedMilliseconds);\n\n    // Variante 2\n    sw.Restart();\n    var t1 = Task1();\n    var t2 = Task2();\n    var t3 = Task3();\n    m1 = await t1;\n    m2 = await t2;\n    m3 = await t3;\n    Console.WriteLine(m1);\n    Console.WriteLine(m2);\n    Console.WriteLine(m3);\n    sw.Stop();\n    Console.WriteLine(sw.ElapsedMilliseconds);\n}\n\n// Define other methods, classes and namespaces here\npublic async Task&lt;string&gt; Task1()\n{\n    await Task.Delay(5000);\n    return \"Task1 ready\";\n}   \n\npublic async Task&lt;string&gt; Task2()\n{\n    await Task.Delay(5000);\n    return \"Task2 ready\";\n}\n\npublic async Task&lt;string&gt; Task3()\n{\n    await Task.Delay(5000);\n    return \"Task3 ready\";\n}\n</code></pre>\n\n<p>The first part results in nearly 15000ms and the second one in 5000ms, but I don't get the point why!</p>\n\n<p>In the first part I await an async method returning a Task and in the second part I get this Task and await the Task.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c#", "visual-studio", "envdte"], "comments": [{"owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "edited": false, "score": 0, "creation_date": 1576082447, "post_id": 59290351, "comment_id": 104785579, "body": "Can you provide an example of what you have attempted so far."}, {"owner": {"reputation": 13353, "user_id": 366064, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/0cSD6.png?s=128&g=1", "display_name": "Bizhan", "link": "https://stackoverflow.com/users/366064/bizhan"}, "edited": false, "score": 0, "creation_date": 1576082542, "post_id": 59290351, "comment_id": 104785637, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/1358540/how-to-count-all-the-lines-of-code-in-a-directory-recursively\">How to count all the lines of code in a directory recursively?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 358, "user_id": 9675356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hm0GK.png?s=128&g=1", "display_name": "AndrewToasterr", "link": "https://stackoverflow.com/users/9675356/andrewtoasterr"}, "edited": false, "score": 0, "creation_date": 1576083806, "post_id": 59290615, "comment_id": 104786264, "body": "It is a valid answer, it worked, but i wanted to use it with EnvDTE. Anyway thanks."}], "tags": [], "owner": {"reputation": 9368, "user_id": 1390548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee99f66a15a8e049467a0fca2b80eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jawad", "link": "https://stackoverflow.com/users/1390548/jawad"}, "is_accepted": true, "score": 1, "last_activity_date": 1576084552, "last_edit_date": 1576084552, "creation_date": 1576083420, "answer_id": 59290615, "question_id": 59290351, "link": "https://stackoverflow.com/questions/59290351/envdte-how-to-get-the-text-from-a-file-in-a-project/59290615#59290615", "title": "EnvDTE - How to get the text from a file in a project", "body": "<p>In order for you to get the count of all lines, you will need to recursively go through each folder and get the length of each files within them.</p>\n\n<p><br>\n<strong>Process the directories recursively. Get the number of lines for text files and recursively call itself for more directories</strong></p>\n\n<pre><code>    public static int GetTotalLinesInAllFiles(string targetDirectory)\n    {\n        int totalLines = 0;\n\n        // Process the list of files found in the directory.\n        foreach (string fileName in Directory.GetFiles(targetDirectory))\n            totalLines += File.ReadAllLines(fileName).Length;\n\n        // Recurse into subdirectories of this directory.\n        foreach (string subdirectory in Directory.GetDirectories(targetDirectory))\n            totalLines += GetTotalLinesInAllFiles(subdirectory);\n\n        return totalLines;\n    }\n</code></pre>\n\n<p>In your main function, you can start the call with </p>\n\n<pre><code>    ProcessDirectory(Environment.CurrentDirectory);\n</code></pre>\n"}], "owner": {"reputation": 358, "user_id": 9675356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hm0GK.png?s=128&g=1", "display_name": "AndrewToasterr", "link": "https://stackoverflow.com/users/9675356/andrewtoasterr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 59290615, "answer_count": 1, "score": 0, "last_activity_date": 1576084552, "creation_date": 1576082401, "question_id": 59290351, "link": "https://stackoverflow.com/questions/59290351/envdte-how-to-get-the-text-from-a-file-in-a-project", "title": "EnvDTE - How to get the text from a file in a project", "body": "<p><em>I will ask you to please explain your answer, as I'm not acquainted with this Library</em></p>\n\n<p>So what I'm trying is to is get the text of all project items and count all lines.\nWhat is the best way is approaching this problem ?</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 2, "creation_date": 1576081374, "post_id": 59289872, "comment_id": 104785042, "body": "When you destroy an object and instantiate a new object, all your references are lost because <i>they&#39;re different objects.</i> C# isn&#39;t magic."}, {"owner": {"reputation": 825, "user_id": 9660968, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Benzi Avrumi", "link": "https://stackoverflow.com/users/9660968/benzi-avrumi"}, "reply_to_user": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1576087421, "post_id": 59289872, "comment_id": 104788000, "body": "@Draco18s I know that I wonder how in games they make a start new game ? If not using scenes loading.  The destroy and creating the objects or using game state ? What is the proper way to start a new game ?"}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1576087517, "post_id": 59289872, "comment_id": 104788046, "body": "Depends on the game. In all cases, the player object doesn&#39;t actually get referenced directly. Instead either a <code>Game.GetPlayer()</code> method exists or the player data is stored separately from the object-in-the-world representation."}], "owner": {"reputation": 825, "user_id": 9660968, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Benzi Avrumi", "link": "https://stackoverflow.com/users/9660968/benzi-avrumi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576080654, "creation_date": 1576080654, "question_id": 59289872, "link": "https://stackoverflow.com/questions/59289872/how-can-i-reference-back-to-objects-components-of-a-parent-object-after-destroye", "title": "How can I reference back to objects/components of a parent object after destroyed it and re instantiated?", "body": "<p>I have in the Hierarchy one scene and 3 parent objects. The 3 parent objects are :</p>\n\n<p>Game Data (Where all the gameplay objects are childs of it)</p>\n\n<p>Main Menu</p>\n\n<p>Game Manager (That control on pausing/unpausing the game in some cases)</p>\n\n<p>The idea the main goal is when the game start it's starting with the main menu then when clicking the start new game button it will start the game when hit the escape key it will be back to the main menu and again I can start a new game or resuming the game. I also did that while the game is running if you hit the P button it will pause/unpause the game.</p>\n\n<p>First the script that is attached to the Game Manager :</p>\n\n<p>Here I'm doing a reference for the Dialogue System, Depth Of Field, Main Menu And in the bottom I'm using find to find back the Depth Of Field and the Dialogue System since I'm destroying the Game Data object when starting a new game :</p>\n\n<pre><code> using System.Collections;\n using System.Collections.Generic;\n using UnityEngine;\n using UnityEngine.SceneManagement;\n\n public class GameController : MonoBehaviour\n {\n     public GameObject dialogueSystem;\n     public DepthOfField depthOfField;\n     public static bool gamepaused = false;\n\n     public GameObject mainMenu;\n\n     private void Start()\n     {\n         Time.timeScale = 0f;\n     }\n\n     private void Update()\n     {\n         if (Input.GetKeyDown(KeyCode.P))\n         {\n             gamepaused = !gamepaused;\n\n             if (gamepaused)\n             {\n                 Time.timeScale = 0f;\n             }\n             else\n             {\n                 Time.timeScale = 1f;\n             }\n         }\n\n         if (Input.GetKeyDown(KeyCode.Escape))\n         {\n             if(depthOfField == null || dialogueSystem == null)\n             {\n                 depthOfField = GameObject.Find(\"Player Camera\").GetComponent&lt;DepthOfField&gt;();\n                 dialogueSystem = GameObject.Find(\"Dialogue System\");\n             }\n             depthOfField.DepthOfFieldInit(3f);\n             Time.timeScale = 0f;\n             dialogueSystem.SetActive(false);\n             mainMenu.SetActive(true);\n\n             Cursor.visible = true;\n             Cursor.lockState = CursorLockMode.None;\n         }\n     }\n }\n</code></pre>\n\n<p>The problem is that the Dialogue System and Depth Of Field are in the Game Data and when I destroy the Game Data and instantiate the Game Data using a prefab over again to make a new game to start the variables in the GameController script lost reference and I need to use find. But using find so many times is a good idea ?</p>\n\n<p>This script the next one is attached to the Main Menu :</p>\n\n<pre><code> using System.Collections;\n using System.Collections.Generic;\n using UnityEngine;\n using UnityEngine.SceneManagement;\n\n public class MainMenu : MonoBehaviour\n {\n     public GameObject gameDataPrefab;\n     public GameObject gameData;\n     public GameObject mainMenu;\n\n     public void StartNewGame()\n     {\n         var gdata = GameObject.Find(\"Game Data\");\n         if (gdata != null)\n         {\n             Destroy(gdata);\n         }\n\n         GameObject go = Instantiate(gameDataPrefab);\n         go.name = \"Game Data\";\n\n         mainMenu.SetActive(false);\n         GameController.gamepaused = false;\n         Time.timeScale = 1f;\n     }\n\n     public void ResumeGame()\n     {\n\n     }\n\n     public void QuitGame()\n     {\n         Application.Quit();\n     }\n }\n</code></pre>\n\n<p>Here when I click the UI button to start a new game in the function StartNewGame I destroy the Game Data and create a new one. This make the variables in the GameController script to lost references.</p>\n\n<p>The last script is attached to the Game Data this script I'm calling the method DepthOfFieldInit to make effect when I hit the escape key back to the Main Menu.</p>\n\n<p>The problem is that some variables are lost references since the Game Data is destroyed. For example I'm getting null on :</p>\n\n<pre><code>playerLockMode.PlayerLockState(true, true);\n</code></pre>\n\n<p>Since playerLockMode is also on the Game Data that have been destroyed.</p>\n\n<pre><code> using System.Collections;\n using System.Collections.Generic;\n using UnityEngine;\n using UnityEngine.PostProcessing;\n\n public class DepthOfField : MonoBehaviour\n {\n     public UnityEngine.GameObject player;\n     public PostProcessingProfile postProcessingProfile;\n     public bool dephOfFieldFinished = false;\n     public LockSystem playerLockMode;\n\n     private Animator playerAnimator;\n     private float clipLength;\n     private Coroutine depthOfFieldRoutineRef;\n\n     // Start is called before the first frame update\n     void Start()\n     {\n         if (depthOfFieldRoutineRef != null)\n         {\n             StopCoroutine(depthOfFieldRoutineRef);\n         }\n\n         playerAnimator = player.GetComponent&lt;Animator&gt;();\n\n         AnimationClip[] clips = playerAnimator.runtimeAnimatorController.animationClips;\n         foreach (AnimationClip clip in clips)\n         {\n             clipLength = clip.length;\n         }\n\n         DepthOfFieldInit(clipLength);\n\n         // Don't forget to set depthOfFieldRoutineRef to null again at the end of routine!\n     }\n\n     public void DepthOfFieldInit(float duration)\n     {\n         var depthOfField = postProcessingProfile.depthOfField.settings;\n         depthOfField.focalLength = 300;\n         StartCoroutine(changeValueOverTime(depthOfField.focalLength, 1, duration));\n         postProcessingProfile.depthOfField.settings = depthOfField;\n     }\n\n     public IEnumerator changeValueOverTime(float fromVal, float toVal, float duration)\n     {\n         playerLockMode.PlayerLockState(true, true);\n\n         float counter = 0f;\n\n         while (counter &lt; duration)\n         {\n             var dof = postProcessingProfile.depthOfField.settings;\n\n             counter += Time.deltaTime;\n\n             float val = Mathf.Lerp(fromVal, toVal, counter / duration);\n\n             dof.focalLength = val;\n             postProcessingProfile.depthOfField.settings = dof;\n\n             yield return null;\n         }\n\n         playerAnimator.enabled = false;\n         dephOfFieldFinished = true;\n         depthOfFieldRoutineRef = null;\n     }\n }\n</code></pre>\n\n<p>But I don't understand if I instantiate right away back the Game Data when starting a new game why the variables lost references ? And is there a better way to use Find at any place many times after the Game Data have been destroyed ? And maybe the whole code in the StartNewGame is wrong ?</p>\n\n<p>My main goal is when clicking the StartNewGame start over a new game. When hit the escape key pause the game and go back to the main menu.</p>\n\n<p>Here is a screenshot of my Hierarchy :</p>\n\n<p><a href=\"https://i.stack.imgur.com/GUjbm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GUjbm.jpg\" alt=\"Hierarchy\"></a></p>\n"}, {"tags": ["c#", "itext7"], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 1566339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc60c65804a26cd3db62d62132fd7f?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Lemos", "link": "https://stackoverflow.com/users/1566339/andr%c3%a9-lemos"}, "edited": false, "score": 1, "creation_date": 1576084077, "post_id": 59290668, "comment_id": 104786402, "body": "there is a pretty good article that shows some key differences between iText 5 (iTextSharp) and iText 7. Although it is for Java, it&#39;s applicable for the C# port as well - <a href=\"https://riptutorial.com/itext/topic/3557/getting-started-with-itext\" rel=\"nofollow noreferrer\">riptutorial.com/itext/topic/3557/getting-started-with-itext</a>"}], "tags": [], "owner": {"reputation": 671, "user_id": 1566339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc60c65804a26cd3db62d62132fd7f?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Lemos", "link": "https://stackoverflow.com/users/1566339/andr%c3%a9-lemos"}, "is_accepted": true, "score": 1, "last_activity_date": 1576083577, "creation_date": 1576083577, "answer_id": 59290668, "question_id": 59289771, "link": "https://stackoverflow.com/questions/59289771/itext7-and-missing-getpagen-method-in-c/59290668#59290668", "title": "IText7 and missing GetPageN method in C#", "body": "<p>Indeed, now the <a href=\"https://api.itextpdf.com/iText7/dotnet/7.1.9/classi_text_1_1_kernel_1_1_pdf_1_1_pdf_document.html#a8107104328de86454719d87038be478c\" rel=\"nofollow noreferrer\">GetPage()</a> method is inside of the <a href=\"https://api.itextpdf.com/iText7/dotnet/7.1.9/classi_text_1_1_kernel_1_1_pdf_1_1_pdf_document.html\" rel=\"nofollow noreferrer\">PdfDocument</a> class.</p>\n\n<p>There are also some little changes as to how you get the Dictionary entries from the document, which I took the liberty to adjust your code to.</p>\n\n<pre><code>public static PdfReader Fix(PdfReader pdfReader, int pagina)\n{\n    var dic = new PdfDocument(pdfReader).GetPage(pagina);\n    var resources = dic.GetPdfObject().GetAsDictionary(PdfName.Resources);\n\n    var fonts = resources?.GetAsDictionary(PdfName.Font);\n    if (fonts == null) return pdfReader;\n\n    foreach (var key in fonts.KeySet())\n    {\n        var font = fonts.GetAsDictionary(key);\n\n        var firstChar = font.Get(PdfName.FirstChar);\n        if (firstChar == null)\n            font.Put(PdfName.FirstChar, new PdfNumber(32));\n\n        var lastChar = font.Get(PdfName.LastChar);\n        if (lastChar == null)\n            font.Put(PdfName.LastChar, new PdfNumber(255));\n\n        var widths = font.GetAsArray(PdfName.Widths);\n\n        if (widths != null) continue;\n        var array = Enumerable.Repeat(600, 256).ToArray();\n        font.Put(PdfName.Widths, new PdfArray(array));\n    }\n\n    return pdfReader;\n}\n</code></pre>\n\n<p>(I haven't checked your code, just made sure that at least what you posted now compiles)</p>\n"}], "owner": {"reputation": 12013, "user_id": 735864, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e874b8d9cc4d11850829e6681e29a869?s=128&d=identicon&r=PG", "display_name": "danyolgiax", "link": "https://stackoverflow.com/users/735864/danyolgiax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 59290668, "answer_count": 1, "score": 1, "last_activity_date": 1576083577, "creation_date": 1576080282, "question_id": 59289771, "link": "https://stackoverflow.com/questions/59289771/itext7-and-missing-getpagen-method-in-c", "title": "IText7 and missing GetPageN method in C#", "body": "<p>I've this <code>C#</code> code working with <code>iTextSharp 5</code> and I need to port it to <code>IText7</code>.</p>\n\n<pre><code>public static PdfReader Fix(PdfReader pdfReader, int pagina)\n{\n    var dic = pdfReader.GetPageN(pagina);\n    var resources = dic.GetAsDict(PdfName.Resources);\n\n    var fonts = resources?.GetAsDict(PdfName.Font);\n    if (fonts == null) return pdfReader;\n\n    foreach (var key in fonts.Keys)\n    {\n        var font = fonts.GetAsDict(key);\n\n        var firstChar = font.Get(PdfName.FirstChar);\n        if (firstChar == null)\n            font.Put(PdfName.FirstChar, new PdfNumber(32));\n\n        var lastChar = font.Get(PdfName.LastChar);\n        if (lastChar == null)\n            font.Put(PdfName.LastChar, new PdfNumber(255));\n\n        var widths = font.GetAsArray(PdfName.Widths);\n\n        if (widths != null) continue;\n        var array = Enumerable.Repeat(600, 256).ToArray();\n        font.Put(PdfName.Widths, new PdfArray(array));\n    }\n\n    return pdfReader;\n}\n</code></pre>\n\n<p>The problem I have is that the method <code>GetPageN</code> in this line:</p>\n\n<pre><code>var dic = pdfReader.GetPageN(pagina);\n</code></pre>\n\n<p>has been removed.</p>\n\n<p>Have someone faced the same problem?</p>\n"}, {"tags": ["c#", ".net", "directory", "path"], "comments": [{"owner": {"reputation": 2785, "user_id": 3959259, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/eEIKa.png?s=128&g=1", "display_name": "Bill T&#252;r", "link": "https://stackoverflow.com/users/3959259/bill-t%c3%bcr"}, "edited": false, "score": 0, "creation_date": 1576080609, "post_id": 59289740, "comment_id": 104784626, "body": "I&#39;d guess <code>userinput</code> is <code>null</code>"}, {"owner": {"reputation": 11, "user_id": 12475851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EsxaUv2MKhA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1fd0rKqX9pqrRwBHX-6yE6SN55A/photo.jpg?sz=128", "display_name": "Joshua Anthony", "link": "https://stackoverflow.com/users/12475851/joshua-anthony"}, "reply_to_user": {"reputation": 2785, "user_id": 3959259, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/eEIKa.png?s=128&g=1", "display_name": "Bill T&#252;r", "link": "https://stackoverflow.com/users/3959259/bill-t%c3%bcr"}, "edited": false, "score": 0, "creation_date": 1576080758, "post_id": 59289740, "comment_id": 104784712, "body": "@ThomasSchremser No, because userinput is defined by a readline function in the line of code directly preceding the pathcombine function.     string userinput = Console.ReadLine();"}, {"owner": {"reputation": 3302, "user_id": 12431728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5fb7b733c152599fa38023820400e9b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt U", "link": "https://stackoverflow.com/users/12431728/matt-u"}, "edited": false, "score": 0, "creation_date": 1576080766, "post_id": 59289740, "comment_id": 104784719, "body": "The error states that the <code>path3</code> parameter is <code>null</code>. Make sure that <code>classrooms.inventory</code> (in the position of <code>path3</code>) is not null when you call <code>Path.Combine</code>."}, {"owner": {"reputation": 11, "user_id": 12475851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EsxaUv2MKhA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1fd0rKqX9pqrRwBHX-6yE6SN55A/photo.jpg?sz=128", "display_name": "Joshua Anthony", "link": "https://stackoverflow.com/users/12475851/joshua-anthony"}, "reply_to_user": {"reputation": 3302, "user_id": 12431728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5fb7b733c152599fa38023820400e9b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt U", "link": "https://stackoverflow.com/users/12431728/matt-u"}, "edited": false, "score": 0, "creation_date": 1576080924, "post_id": 59289740, "comment_id": 104784801, "body": "@MattU It isn&#39;t null, which is the problem here. I defined it in the classrooms class with public static string inventory = &quot;inventory&quot;;"}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 0, "creation_date": 1576088844, "post_id": 59289740, "comment_id": 104788643, "body": "Error is not in Path.Combine. It&#39;s your <code>perhaps.Functions</code> type constructor that&#39;s throwing exception."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12475851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EsxaUv2MKhA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1fd0rKqX9pqrRwBHX-6yE6SN55A/photo.jpg?sz=128", "display_name": "Joshua Anthony", "link": "https://stackoverflow.com/users/12475851/joshua-anthony"}, "edited": false, "score": 0, "creation_date": 1576081199, "post_id": 59290017, "comment_id": 104784946, "body": "That being that the Roomnumber string wasn&#39;t defined in the classrooms class. It had to be assigned to a string apparently."}], "tags": [], "owner": {"reputation": 11, "user_id": 12475851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EsxaUv2MKhA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1fd0rKqX9pqrRwBHX-6yE6SN55A/photo.jpg?sz=128", "display_name": "Joshua Anthony", "link": "https://stackoverflow.com/users/12475851/joshua-anthony"}, "is_accepted": false, "score": 1, "last_activity_date": 1576081162, "creation_date": 1576081162, "answer_id": 59290017, "question_id": 59289740, "link": "https://stackoverflow.com/questions/59289740/c-value-cannot-be-null-using-path-combine/59290017#59290017", "title": "C# Value Cannot be null using Path.Combine", "body": "<p>I figured it out.\nIt was an improperly defined string that the pathcombine function was using in another instance of the code, and it was just getting caught up once i reused the path.combine function. Thanks for all the answers, I wouldn't have thought to look at that without all the input.</p>\n"}], "owner": {"reputation": 11, "user_id": 12475851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EsxaUv2MKhA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1fd0rKqX9pqrRwBHX-6yE6SN55A/photo.jpg?sz=128", "display_name": "Joshua Anthony", "link": "https://stackoverflow.com/users/12475851/joshua-anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576082844, "creation_date": 1576080177, "last_edit_date": 1576082844, "question_id": 59289740, "link": "https://stackoverflow.com/questions/59289740/c-value-cannot-be-null-using-path-combine", "title": "C# Value Cannot be null using Path.Combine", "body": "<p>I'm attempting to construct a database using the C# Console, but I'm getting an error thrown that I can't seem to find the problem with. The problem is in my Query function, when I attempt to define the path based off of user input. Essentially, it looks into a given folder in the user folder, and within it another subfolder containing the files wherein is the database information. Im using the Path.Combine function to dynamically define the path throughout my code, but I'm getting the following error;</p>\n\n<p>ArgumentNullException: Value cannot be null. (Parameter 'path3')</p>\n\n<p>Even though all strings are defined and not null. </p>\n\n<p>this is what the line of code looks like:</p>\n\n<pre><code>path = Path.Combine(Info.path, \"infolder\", classrooms.inventory, classrooms.geninv, userinput)\n</code></pre>\n\n<p>And here is all of the code that the strings in the path arguement are referencing:</p>\n\n<pre><code>class classrooms\n{\n    public static string Teacher;\n    public static string Roomnumber;\n    public static string Changes;\n    public static string inventory = \"inventory\";\n    public static string geninv = \"GenInv\";\n    public static string classinv = \"ClassInv\";\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Info\n    {\n        public static string path = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile);\n    }\n</code></pre>\n\n<p>if necessary I can attach my full code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3ot36.png\" rel=\"nofollow noreferrer\">Screenshot of Error</a></p>\n"}, {"tags": ["c#", "async-await", "polymorphism"], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 4603080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904a38634c3ccb6a41e7039420538508?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4603080/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1576081892, "creation_date": 1576081892, "answer_id": 59290203, "question_id": 59289669, "link": "https://stackoverflow.com/questions/59289669/awaiting-a-list-of-asynchronous-tasks-that-have-polymorphic-results/59290203#59290203", "title": "Awaiting a list of asynchronous tasks that have polymorphic results", "body": "<p>Do you care about the return value from <code>GetBaseAsync()</code> or <code>GetDerivedAsync()</code>?</p>\n\n<p>If not you may be able to add them both to a <code>List&lt;Task&gt;</code> or <code>List&lt;Task&lt;object&gt;&gt;</code> instead of <code>List&lt;Task&lt;Base&gt;&gt;</code>.</p>\n\n<p>If you do care about the return value one of your options would be to add an <code>interface</code> on <code>Base</code> and use that <code>interface</code> on your <code>List&lt;Task&lt;T&gt;&gt;</code> declaration like below</p>\n\n<pre><code>interface IBaseResult {\n    string PropertyYouCareAbout1 { get; }\n    bool PropertyYouCareAbout2 { get; }\n    // ...\n    int PropertyYouCareAboutN { get; }\n}\n\nclass Base : IBaseResult {\n\n}\n\nclass Derived : Base {\n\n}\n\npublic void Main() {\n    List&lt;Task&lt;IBaseResult&gt;&gt; taskList = new List&lt;Task&lt;IBaseResult&gt;&gt;();\n\n    for ( var i = 1; i &lt; 10; i++) {\n        switch (i%2) {\n            case 0:\n                taskList.Add(GetDerivedAsync());\n                break;\n            default:\n                taskList.Add(GetBaseAsync());\n                break;\n        }\n    }\n\n    Task.WhenAll(taskList);\n\n    // Do somethign with results in taskList\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 460, "user_id": 12477070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d36f204dd409830f00f1299cce1522?s=128&d=identicon&r=PG&f=1", "display_name": "jasonmchoe", "link": "https://stackoverflow.com/users/12477070/jasonmchoe"}, "is_accepted": true, "score": 3, "last_activity_date": 1576082360, "creation_date": 1576082360, "answer_id": 59290341, "question_id": 59289669, "link": "https://stackoverflow.com/questions/59289669/awaiting-a-list-of-asynchronous-tasks-that-have-polymorphic-results/59290341#59290341", "title": "Awaiting a list of asynchronous tasks that have polymorphic results", "body": "<p>I think you will have to convert the result of <code>GetDerivedAsync()</code> from <code>Task&lt;Derived&gt;</code> to <code>Task&lt;Base&gt;</code> in order to get them into the same list.</p>\n\n<pre><code>public Task&lt;Base&gt; GetBaseTaskFromDerived(Task&lt;Derived&gt; derivedTask)\n{\n    return await derivedTask;\n}\n</code></pre>\n\n<p>Then add like this: <code>taskList.Add(GetBaseTaskFromDerived(GetDerivedAsync()));</code></p>\n"}, {"tags": [], "owner": {"reputation": 15450, "user_id": 11178549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N3P6o.png?s=128&g=1", "display_name": "Theodor Zoulias", "link": "https://stackoverflow.com/users/11178549/theodor-zoulias"}, "is_accepted": false, "score": 1, "last_activity_date": 1576084160, "last_edit_date": 1576084160, "creation_date": 1576082413, "answer_id": 59290354, "question_id": 59289669, "link": "https://stackoverflow.com/questions/59289669/awaiting-a-list-of-asynchronous-tasks-that-have-polymorphic-results/59290354#59290354", "title": "Awaiting a list of asynchronous tasks that have polymorphic results", "body": "<p>You could exploit the fact that <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.task-1\" rel=\"nofollow noreferrer\"><code>Task&lt;TResult&gt;</code></a> derives from <code>Task</code>, and store the tasks in a <code>List&lt;Task&gt;</code>:</p>\n\n<pre><code>var taskList = new List&lt;Task&gt;();\n</code></pre>\n\n<p>Then awaiting all tasks is easy.</p>\n\n<pre><code>await Task.WhenAll(taskList);\n</code></pre>\n\n<p>The tricky part is how to collect the results of these tasks after the awaiting, into a <code>List&lt;Base&gt;</code>. It can be done by casting, but it's neither pretty nor safe. In the example below I used a <em>switch expression</em> (C# 8 syntax) to reduce the verbosity of the casting:</p>\n\n<pre><code>List&lt;Base&gt; list = taskList.Select(task =&gt; task switch\n{\n    Task&lt;Base&gt; taskBase =&gt; taskBase.Result,\n    Task&lt;Derived&gt; taskDerived =&gt; taskDerived.Result,\n    _ =&gt; throw new NotImplementedException()\n}).ToList();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1071, "user_id": 10674402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb26a5c756c10da951c114ecc5aaea67?s=128&d=identicon&r=PG", "display_name": "kalimag", "link": "https://stackoverflow.com/users/10674402/kalimag"}, "is_accepted": false, "score": 0, "last_activity_date": 1576082484, "creation_date": 1576082484, "answer_id": 59290371, "question_id": 59289669, "link": "https://stackoverflow.com/questions/59289669/awaiting-a-list-of-asynchronous-tasks-that-have-polymorphic-results/59290371#59290371", "title": "Awaiting a list of asynchronous tasks that have polymorphic results", "body": "<p><code>Task&lt;T&gt;</code> inherits <code>Task</code>, so you can use a <code>List&lt;Task&gt;</code> to store both of them.</p>\n\n<pre><code>List&lt;Task&gt; taskList = new List&lt;Task&gt;();\ntaskList.Add(GetDerivedTask());\ntaskList.Add(GetBaseTask());\n</code></pre>\n\n<p>You'll then have to cast the tasks back to their respective types to access the result:</p>\n\n<pre><code>foreach (var task in taskList)\n{\n    if (task is Task&lt;Base&gt; baseTask)\n        ProcessBase(baseTask.Result);            \n    else if (task is Task&lt;Derived&gt; derivedTask)\n        ProcessDerived(derivedTask.Result);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": false, "score": 0, "last_activity_date": 1576083779, "creation_date": 1576083779, "answer_id": 59290715, "question_id": 59289669, "link": "https://stackoverflow.com/questions/59289669/awaiting-a-list-of-asynchronous-tasks-that-have-polymorphic-results/59290715#59290715", "title": "Awaiting a list of asynchronous tasks that have polymorphic results", "body": "<p>You could use two lists, one for the base types and one for the derived types:</p>\n\n<pre><code>public void Main() {\n    var baseTaskList = new List&lt;Task&lt;Base&gt;&gt;();\n    var derivedTaskList = new List&lt;Task&lt;Derived&gt;&gt;();\n\n    for ( var i = 1; i &lt; 10; i++) {\n        switch (i%2) {\n            case 0:\n                derivedTaskList.Add(GetDerivedAsync());\n                break;\n            default:\n                baseTaskList.Add(GetBaseAsync());\n                break;\n        }\n    }\n\n    Task.WhenAll(baseTaskList);\n    Task.WhenAll(derivedTaskList);\n}\n</code></pre>\n\n<p>This way you don't have to modify your types and you can easily get the results of the tasks.</p>\n"}], "owner": {"reputation": 1082, "user_id": 715239, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/96c26230e324cbacff58e61452951409?s=128&d=identicon&r=PG", "display_name": "Artog", "link": "https://stackoverflow.com/users/715239/artog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 59290341, "answer_count": 5, "score": 2, "last_activity_date": 1576084160, "creation_date": 1576080000, "last_edit_date": 1576080546, "question_id": 59289669, "link": "https://stackoverflow.com/questions/59289669/awaiting-a-list-of-asynchronous-tasks-that-have-polymorphic-results", "title": "Awaiting a list of asynchronous tasks that have polymorphic results", "body": "<p>The problem I need to solve is that of having different calls that returns tasks, but they may or may not contain the base or some derived class, and then awaiting all those calls before proceeding.</p>\n\n<p>The following, non-working, code illustrates the problem:</p>\n\n<pre><code>class Base {\n\n}\n\nclass Derived : Base {\n\n}\n\npublic void Main() {\n    List&lt;Task&lt;Base&gt;&gt; taskList = new List&lt;Task&lt;Base&gt;&gt;();\n\n    for ( var i = 1; i &lt; 10; i++) {\n        switch (i%2) {\n            case 0:\n                taskList.Add(GetDerivedAsync());\n                break;\n            default:\n                taskList.Add(GetBaseAsync());\n                break;\n        }\n    }\n\n    Task.WhenAll(taskList);\n}\n\n</code></pre>\n\n<p>The above code doesn't work becauase you cant add a <code>Task&lt;Derived&gt;</code> to a list of <code>Task&lt;Base&gt;</code>.</p>\n\n<p><strong>How can I make a bunch of asynchronos calls whose returned object is polymorphic in nature, add them to a list and then await all of them before continuing the code?</strong></p>\n"}, {"tags": ["c#", "asp.net", "angular"], "answers": [{"tags": [], "owner": {"reputation": 565, "user_id": 12279362, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDeRyy_GQnGetFSOnilqVIDmBW8YMrKGUbNkQ2SPA=k-s128", "display_name": "LALIT KANTA DIBYADARSHAN", "link": "https://stackoverflow.com/users/12279362/lalit-kanta-dibyadarshan"}, "is_accepted": false, "score": 1, "last_activity_date": 1576083725, "creation_date": 1576083725, "answer_id": 59290698, "question_id": 59289659, "link": "https://stackoverflow.com/questions/59289659/angular-6-registration-form-not-sending/59290698#59290698", "title": "Angular 6 registration form not sending", "body": "<p>Add <code>type=\"submit\"</code> in <code>button</code> tag</p>\n\n<pre><code>&lt;button  type=\"submit\" class=\"btn btn-primary mr-2\" [disabled]=\"registerForm.invalid\"&gt;\n     Sign up\n&lt;/button&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 317, "user_id": 3623760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kmiv0.jpg?s=128&g=1", "display_name": "thrashead", "link": "https://stackoverflow.com/users/3623760/thrashead"}, "is_accepted": false, "score": 0, "last_activity_date": 1576084168, "creation_date": 1576084168, "answer_id": 59290806, "question_id": 59289659, "link": "https://stackoverflow.com/questions/59289659/angular-6-registration-form-not-sending/59290806#59290806", "title": "Angular 6 registration form not sending", "body": "<p>You can add <code>type=\"submit\"</code> to your <code>button</code> tag or you can remove <code>(ngSubmit)=\"onRegister()\"</code> from your <code>form</code> tag and add <code>(click)=\"onRegister()\"</code> to your <code>button</code> tag.</p>\n"}], "owner": {"reputation": 21, "user_id": 12452482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72cf92fc6f8bea8612cd47ba343b5e69?s=128&d=identicon&r=PG&f=1", "display_name": "bannersmith", "link": "https://stackoverflow.com/users/12452482/bannersmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576084168, "creation_date": 1576079956, "last_edit_date": 1576083397, "question_id": 59289659, "link": "https://stackoverflow.com/questions/59289659/angular-6-registration-form-not-sending", "title": "Angular 6 registration form not sending", "body": "<p>I'm doing a project an asp.net angular 6 project and am trying to include a registration and login form. So far my login form is working but my registration form isn't doing anything when pressing the register button. I'm following the same logic from my login form, I was wondering if anyone could point out to me why it isn't working.</p>\n\n<p>register.component.html</p>\n\n<pre><code>&lt;div class=\"container card\" style=\"width:40rem;\"&gt;\n  &lt;div class=\"row justify-content-center card-header bg-primary\" &gt;\n    &lt;div class=\"col\"&gt;\n      &lt;h2 class=\"text-center text-white mb-4\"&gt;Register&lt;/h2&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  &lt;div class=\"row justify-content-center card-body mt-2\"&gt;\n    &lt;div class=\"col-6\"&gt;\n      &lt;form (ngSubmit)=\"onRegister()\" [formGroup]=\"registerForm\"&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              First name\n              &lt;input class=\"form-control\" type=\"text\" formControlName=\"firstName\"/&gt;\n            &lt;/label&gt;\n            &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('firstName').touched &amp;&amp; registerForm.get('firstName').invalid\"&gt;First name is required.&lt;/span&gt;\n          &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              Last name\n              &lt;input class=\"form-control\" type=\"text\" formControlName=\"lastName\"/&gt;\n            &lt;/label&gt;\n            &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('lastName').touched &amp;&amp; registerForm.get('lastName').invalid\"&gt;Last name is required.&lt;/span&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              Address\n              &lt;input class=\"form-control\" type=\"text\" formControlName=\"address\"/&gt;\n            &lt;/label&gt;\n            &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('address').touched &amp;&amp; registerForm.get('address').invalid\"&gt;Address is required.&lt;/span&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              E-mail\n              &lt;input type=\"email\" class=\"form-control\" formControlName=\"email\"/&gt;\n            &lt;/label&gt;\n            &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('email').touched &amp;&amp; registerForm.get('email').invalid\"&gt;Email is required and must be a valid email address.&lt;/span&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              Date of Birth\n              &lt;input type=\"date\" class=\"form-control\" formControlName=\"dateOfBirth\"/&gt;\n            &lt;/label&gt;\n            &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('dateOfBirth').touched &amp;&amp; registerForm.get('dateOfBirth').invalid\"&gt;Date of birth is required.&lt;/span&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              Password\n              &lt;input type=\"password\" class=\"form-control\" formControlName=\"password\"/&gt;\n            &lt;/label&gt;\n              &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('password').touched &amp;&amp; registerForm.get('password').invalid\"&gt;\n                &lt;span *ngIf=\"registerForm.get('password').errors['passwordComplexity']\" class=\"help-block d-block\"&gt;The password needs to start with a letter and contain a number and a special character.&lt;/span&gt;\n                &lt;span *ngIf=\"registerForm.get('password').errors['passwordLength']\" class=\"help-block d-block\"&gt;The password must be at least 8 characters long.&lt;/span&gt;\n              &lt;/span&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              Security question\n              &lt;select class=\"form-control\" formControlName=\"securityQuestion\"&gt;\n                &lt;option *ngFor=\"let question of securityQuestions\" value=\"{{question.id}}\"&gt;{{question.question}}&lt;/option&gt;\n              &lt;/select&gt;\n            &lt;/label&gt;\n            &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('securityQuestion').touched &amp;&amp; registerForm.get('securityQuestion').invalid\"&gt;Answer to security question is required&lt;/span&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col\"&gt;\n            &lt;label&gt;\n              Answer to security question\n              &lt;input type=\"text\" class=\"form-control\" formControlName=\"securityAnswer\"/&gt;\n            &lt;/label&gt;\n            &lt;span class=\"help-block text-danger\" *ngIf=\"registerForm.get('securityAnswer').touched &amp;&amp; registerForm.get('securityAnswer').invalid\"&gt;Answer to security question is required&lt;/span&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-row\"&gt;\n          &lt;div class=\"col text-right\"&gt;\n            &lt;button  class=\"btn btn-primary mr-2\" [disabled]=\"registerForm.invalid\"&gt;\n              Sign up\n            &lt;/button&gt;\n            &lt;a class=\"mr-2\" [routerLink]=\"['/account']\"&gt;\n              &lt;button class=\"btn btn-warning\"&gt;\n                Cancel\n              &lt;/button&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>register.component.ts</p>\n\n<pre><code>import {Component, OnInit} from \"@angular/core\";\nimport {FormControl, FormGroup, Validators} from \"@angular/forms\";\nimport {MessageService} from \"../../services/message.service\";\nimport {ApiMethod, ApiService} from \"../../services/api.service\";\nimport {PasswordValidator} from \"../../shared/validators/password.validator\";\nimport {User, UserUpdateResult} from \"../../shared/user-model\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {SecurityQuestion} from \"../../shared/security.question.model\";\n\n@Component({\n  selector: 'app-register',\n  templateUrl: './register.component.html',\n  styleUrls: ['./register.component.css']\n})\nexport class RegisterComponent implements OnInit{\n  public securityQuestions: SecurityQuestion[] = [];\n  public registerForm: FormGroup = new FormGroup({\n    firstName: new FormControl(null, Validators.required),\n    lastName: new FormControl(null, Validators.required),\n    address: new FormControl(null, Validators.required),\n    email: new FormControl(null, [Validators.email, Validators.required]),\n    dateOfBirth: new FormControl(null, Validators.required),\n    password: new FormControl(null, [Validators.required, PasswordValidator.Length, PasswordValidator.Complexity]),\n    securityQuestion: new FormControl(1, Validators.required),\n    securityAnswer: new FormControl(null, [Validators.required]),\n  });\n\n  constructor(public messageService: MessageService,\n              public apiService: ApiService,\n              public httpClient: HttpClient){}\n\n  ngOnInit(): void {\n    this.httpClient.get(this.apiService.getUrl(ApiMethod.GetSecurityQuestions)).subscribe((questions: SecurityQuestion[]) =&gt; {\n      this.securityQuestions = questions;\n    })\n  }\n\n  public onRegister(){\n    const user = new User();\n\n    user.fullName = this.registerForm.value.firstName + ' ' + this.registerForm.value.lastName;\n    user.password = this.registerForm.value.password;\n    user.email = this.registerForm.value.email;\n    user.address = this.registerForm.value.address;\n    user.dateOfBirth = new Date(this.registerForm.value.dateOfBirth);\n\n    const securityQuestion = new SecurityQuestion();\n    securityQuestion.id = this.registerForm.value.securityQuestion;\n    securityQuestion.answer = this.registerForm.value.securityAnswer;\n    user.securityQuestion = securityQuestion;\n\n    this.httpClient.post(this.apiService.getUrl(ApiMethod.UserSelfRegister), user).subscribe((result: UserUpdateResult) =&gt; {\n      if(result == UserUpdateResult.UsernameTaken){\n        this.messageService.error('User cannot be created', 'This user is already registered.');\n        return;\n      }\n      this.messageService.success('User registered', 'Waiting for activation. Please check your inbox for an email once your account has been activated.');\n      this.registerForm.reset();\n    });\n  }\n\n}\n</code></pre>\n"}, {"tags": ["c#", "sdk"], "comments": [{"owner": {"reputation": 4229, "user_id": 9363973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cbbp7.png?s=128&g=1", "display_name": "MindSwipe", "link": "https://stackoverflow.com/users/9363973/mindswipe"}, "edited": false, "score": 0, "creation_date": 1576079598, "post_id": 59289442, "comment_id": 104784032, "body": "This seems like the Tizen SDK wasn&#39;t correctly installed. Or installed for an older version. Go check the <code>C:&#47;&#47;Program Files\\dotnet\\3.100\\sdks\\Tizen.Net.Sdk\\sdk</code> folder, and others in the subfolder <code>C:&#47;&#47;Program Files\\dotnet</code>"}, {"owner": {"reputation": 93, "user_id": 7931394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RpaXB.jpg?s=128&g=1", "display_name": "David Ruland", "link": "https://stackoverflow.com/users/7931394/david-ruland"}, "reply_to_user": {"reputation": 4229, "user_id": 9363973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cbbp7.png?s=128&g=1", "display_name": "MindSwipe", "link": "https://stackoverflow.com/users/9363973/mindswipe"}, "edited": false, "score": 0, "creation_date": 1576079915, "post_id": 59289442, "comment_id": 104784209, "body": "Tizen.Net.sdk file is missing from C://Program Files\\dotnet\\3.100\\sdks\\Tizen.Net.Sdk\\sdk and C://Program Files\\dotnet. I installed Tizen  studio 3.5 for Visual Studio 2019. Should I uninstall Tizen studio 3.5 and install 3.6 instead?"}, {"owner": {"reputation": 93, "user_id": 7931394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RpaXB.jpg?s=128&g=1", "display_name": "David Ruland", "link": "https://stackoverflow.com/users/7931394/david-ruland"}, "reply_to_user": {"reputation": 4229, "user_id": 9363973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cbbp7.png?s=128&g=1", "display_name": "MindSwipe", "link": "https://stackoverflow.com/users/9363973/mindswipe"}, "edited": false, "score": 0, "creation_date": 1576151045, "post_id": 59289442, "comment_id": 104810211, "body": "Uninstall Tizen studio and Visual Studio 2019 and reinstalled it didnt work. What should I do?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6812569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17b82d1b07cd33ebe391bb55d56d84c?s=128&d=identicon&r=PG&f=1", "display_name": "envy", "link": "https://stackoverflow.com/users/6812569/envy"}, "is_accepted": false, "score": 1, "last_activity_date": 1577678716, "creation_date": 1577678716, "answer_id": 59525602, "question_id": 59289442, "link": "https://stackoverflow.com/questions/59289442/visual-studio-2019-cant-build-tizen-project/59525602#59525602", "title": "Visual Studio 2019 cant build Tizen project", "body": "<p>Lost nearly a day on the same issue. </p>\n\n<pre><code>Tools &gt; Options &gt; NuGet Package Manager &gt; Package Sources\n</code></pre>\n\n<p>Under <code>Available Package Sources</code> add <code>Name: whatever</code>, <code>Source: https://api.nuget.org/v3/index.json</code>. </p>\n\n<p>That should work. </p>\n"}], "owner": {"reputation": 93, "user_id": 7931394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RpaXB.jpg?s=128&g=1", "display_name": "David Ruland", "link": "https://stackoverflow.com/users/7931394/david-ruland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1611851407, "creation_date": 1576079312, "question_id": 59289442, "link": "https://stackoverflow.com/questions/59289442/visual-studio-2019-cant-build-tizen-project", "title": "Visual Studio 2019 cant build Tizen project", "body": "<p>I have installed Tizen studio 3.5 for Visual Studio 2019 but I cant create Tizen project. I got error unable to find Tizen.NET.SDK in C://Program Files\\dotnet\\3.100\\sdks\\Tizen.Net.Sdk\\sdk. How do I fix this error?<a href=\"https://i.stack.imgur.com/ugEEI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ugEEI.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "web-services", "iis", ".aspxauth"], "comments": [{"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1576092049, "post_id": 59289396, "comment_id": 104790017, "body": "Create a test HTML page there and try to see what happens when you access the HTML page. That in turn can tell what&#39;s up."}, {"owner": {"reputation": 15643, "user_id": 7609093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lwHJH.png?s=128&g=1", "display_name": "Brando Zhang", "link": "https://stackoverflow.com/users/7609093/brando-zhang"}, "edited": false, "score": 0, "creation_date": 1576115265, "post_id": 59289396, "comment_id": 104797338, "body": "According to your description, it seems that you have enabled the windows auth in your application that caused your ajax request need auth firstly. The reason why your browser doesn&#39;t show the auth form is the browser will send the credenticial to the server. I suggest you could check if there is some special auth setting in your codes or IIS web.config again."}], "owner": {"reputation": 526, "user_id": 6855073, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d2bf882e99e2955a56239cfac0349df4?s=128&d=identicon&r=PG&f=1", "display_name": "User1899289003", "link": "https://stackoverflow.com/users/6855073/user1899289003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576079179, "creation_date": 1576079179, "question_id": 59289396, "link": "https://stackoverflow.com/questions/59289396/ajax-call-to-web-service-returns-error-401-unauthorized", "title": "Ajax call to web service returns Error 401: Unauthorized", "body": "<p>Hello I have a C# ASMX Web Service, everything works fine on my local IIS, the problem is when I move my project to my server. Now when I try to execute any ajax call I get a form to type username and password. All username and password are wrong (I don't know which credentials is looking for) if I close the form I get the Error 401: Unauthorized message. Something weird is that if I enter to my webservice by writing the url on another window I can see all my web methods and if I return to my website and refresh the page now the system don't ask for any username or password and everything works fine.</p>\n\n<p>On server IIS I change Authentication to Anonymus Authentication but this doesn't solve my problem.</p>\n\n<p>What could be the problem?</p>\n"}, {"tags": ["c#", "backgroundworker", "semaphore", "windowsformshost"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576079510, "post_id": 59289307, "comment_id": 104783971, "body": "I usually use the state object in the report progress for backgroundworker to send text to main thread. Then in main thread add your code to show form."}, {"owner": {"reputation": 29, "user_id": 11987866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ec9e3660a892155965d529f6de5c96?s=128&d=identicon&r=PG", "display_name": "Christ Kennedy", "link": "https://stackoverflow.com/users/11987866/christ-kennedy"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576082487, "post_id": 59289307, "comment_id": 104785596, "body": "thanks, but what I&#39;m trying to do is have the calling form stall(the same way the OpenFileDialogue native to C# does) while the backgroundworker shows the form.  unfortunately, everything is stalled right now."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576083972, "post_id": 59289307, "comment_id": 104786356, "body": "You cannot do that!!! The background class is in a different thread from the form.  You have to create a Report Progress Event method in the form class and then from the Event open the dialog."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1576087826, "post_id": 59289307, "comment_id": 104788186, "body": "There are a lot of things wrong with this code.  You ask about the deadlock you got from calling semStall.WaitOne().  That hangs the UI thread, preventing the RunWorkerCompleted event from ever getting activated.  But much more wrong than that.  You must call the form&#39;s ShowDialog() method instead, strictly on the main thread."}, {"owner": {"reputation": 29, "user_id": 11987866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ec9e3660a892155965d529f6de5c96?s=128&d=identicon&r=PG", "display_name": "Christ Kennedy", "link": "https://stackoverflow.com/users/11987866/christ-kennedy"}, "edited": false, "score": 0, "creation_date": 1576088182, "post_id": 59289307, "comment_id": 104788331, "body": "OK.  so the worker-thread cannot run a form.  but is there a way to create a form-show it-while stalling the main-thread until a user clicks &#39;ok&#39; and have that form return a value in a way similar to OpenFileDialog.ShowDialog() ?"}, {"owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "edited": false, "score": 1, "creation_date": 1576140042, "post_id": 59289307, "comment_id": 104804172, "body": "You shouldn&#39;t &#39;stall&#39; the main UI thread.  this is bad design.  The UI thread must always be &#39;free-flowing&#39; to maintain user responsiveness.  BackgroundWorkers are just that, they work in the background, so that the main UI thread never blocks.  You need to rethink your design."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 11987866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ec9e3660a892155965d529f6de5c96?s=128&d=identicon&r=PG", "display_name": "Christ Kennedy", "link": "https://stackoverflow.com/users/11987866/christ-kennedy"}, "edited": false, "score": 0, "creation_date": 1576158520, "post_id": 59300622, "comment_id": 104814245, "body": "wow!  That&#39;s what it is.  That&#39;s the magic word I was looking for trying to twist myself into a knot to make it work when there&#39;s the ShowDialog() native instruction all along.  thank you."}], "tags": [], "owner": {"reputation": 8169, "user_id": 759558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/kz2la.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/759558/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1576140168, "creation_date": 1576140168, "answer_id": 59300622, "question_id": 59289307, "link": "https://stackoverflow.com/questions/59289307/trying-to-stall-main-thread-while-background-worker-displays-a-user-interactive/59300622#59300622", "title": "Trying to stall main-thread while background worker displays a user-interactive form in C#", "body": "<p>Sounds like you want to make a 'Modal Form'.</p>\n\n<pre><code>var form = new MyModalForm();\nform.ShowDialog();\n</code></pre>\n\n<p>This will 'stall' the UI until you cancel (or otherwise close) the form.</p>\n"}], "owner": {"reputation": 29, "user_id": 11987866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ec9e3660a892155965d529f6de5c96?s=128&d=identicon&r=PG", "display_name": "Christ Kennedy", "link": "https://stackoverflow.com/users/11987866/christ-kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1577187973, "creation_date": 1576078881, "last_edit_date": 1577187973, "question_id": 59289307, "link": "https://stackoverflow.com/questions/59289307/trying-to-stall-main-thread-while-background-worker-displays-a-user-interactive", "title": "Trying to stall main-thread while background worker displays a user-interactive form in C#", "body": "<p>I'm making(trying) to make a dialogue box similar to the openFileDialogue where the program flow of the Main Thread is stalled until the <code>OPF.ShowDialogue()</code> function stalls while running a separate thread.</p>\n\n<p>I have a <code>OpenFileDialogue_Gui</code> class which uses a semaphore and a background worker.</p>\n\n<p>The background worker is first launched to generate a separate form with the necessary user-interface</p>\n\n<p>Then the semaphore stalls the main thread until the user clicks one of the buttons on the background thread's form.</p>\n\n<p>Then it releases the semaphore and the result is sent back to the calling function.</p>\n\n<p>Sounds nice in theory, but there's a problem. The background-worker is not displaying its form and it's not working.</p>\n\n<p>Here's the code :</p>\n\n<pre><code>public class openfiledialogue_Gui\n{\n    Semaphore semStall = new Semaphore(0, 1);\n    BackgroundWorker bck = new BackgroundWorker();\n\n    public openfiledialogue_Gui()\n    {\n        bck.WorkerSupportsCancellation = true;\n        bck.DoWork += Bck_DoWork;\n        bck.RunWorkerCompleted += Bck_RunWorkerCompleted;\n    }\n\n    public enum enuResult { Ok, Cancel, _num };\n    public enuResult ShowDialogue()\n    {\n        bck.RunWorkerAsync();\n        semStall.WaitOne();\n        return eResult;\n    }\n\n    enuResult eResult = enuResult.Cancel;\n\n    void EventOk_click(object sender, EventArgs e)\n        {\n            eResult = enuResult.Ok;\n            strFilename = \"ok clicked\";\n            semStall.Release();\n        }\n\n    void EventCancel_click(object sender, EventArgs e)\n        {\n            eResult = enuResult.Cancel;\n            strFilename = \"cancel clicked\";\n            semStall.Release();\n        }\n\n    private void Bck_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e){semStall.Release();}\n\n    private void Bck_DoWork(object sender, DoWorkEventArgs e)\n    {\n        Form frmShow = new Form();\n        Button btnOk = new Button();\n        btnOk.Text = \"ok\";\n\n        Button btnCancel = new Button();\n        btnCancel.Text = \"Cancel\";\n\n        btnOk.AutoSize\n            = btnCancel.AutoSize\n            = true;\n\n        frmShow.Controls.Add(btnOk);\n        frmShow.Controls.Add(btnCancel);\n\n        frmShow.ControlBox = false;\n\n        btnOk.Location = new Point(100, 25);\n        btnCancel.Location = new Point(100, 75);\n\n        btnCancel.Click += EventCancel_click;\n        btnOk.Click += EventOk_click;\n        frmShow.Show();\n\n    }\n\n    public string strFilename = \"this is a test\";\n    public string Filename\n    { \n    get { return strFilename; }\n    }\n}\n</code></pre>\n\n<p>Is there any way to make this work?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4763353"}, "edited": false, "score": 0, "creation_date": 1576079110, "post_id": 59289288, "comment_id": 104783738, "body": "This is a classic &quot;Producer\u2013consumer problem&quot; <a href=\"https://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem</a>"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1576079882, "post_id": 59289288, "comment_id": 104784192, "body": "You should be using Asynchronous events to read TCP.  See msdn samples : <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/network-programming/socket-code-examples\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/network-programmin&zwnj;&#8203;g/&hellip;</a>.  The Waitone can be used to synchronize your queues."}], "owner": {"reputation": 25, "user_id": 12504261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad11ba956a1e7f118a6c96488d5307ba?s=128&d=identicon&r=PG&f=1", "display_name": "user12504261", "link": "https://stackoverflow.com/users/12504261/user12504261"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576078825, "creation_date": 1576078825, "question_id": 59289288, "link": "https://stackoverflow.com/questions/59289288/tcplistener-waiting-for-client-and-a-queue-is-processed-at-the-same-time", "title": "TcpListener waiting for client and a queue is processed at the same time", "body": "<p>I have a TcpListener, waiting for a client, who sends hin an order. When he gets the order, a generator generates a new file. This takes a while and only one object of generator can work at the same time. So I like to make a queue of orders, put the new order in the queue and close the connection to the client again. So the programm can get a lot of orders in a short time but needs time to process them. </p>\n\n<p>I want that my programm is processing my queue like the methode StartGenerator, but how can I let my listener waiting for the client requests and still process orders, when there are orders in the queue?</p>\n\n<pre><code> class Program\n{\n    private static Queue&lt;Order&gt; requestList = new Queue&lt;Order&gt;();\n\n    static void Main(string[] args)\n    {\n        TcpListener listener = new TcpListener(IPAddress.Any, port);\n        listener.Start();\n        StartGenerator();\n        while (true)\n        {\n            TcpClient client = listener.AcceptTcpClient();\n            //Adds the order from the client to the Queue\n            AddOrder(client);\n        }\n    }\n\n    private static void StartGenerator() {\n        while (true) {\n            if (generateRequestList != null &amp;&amp; generateRequestList.Count != 0) {\n                Order currentOrder = generateRequestList.Dequeue();\n                Generator generator = new Generator(currentOrder);\n                while (!File.Exists(resultFileFromGenerator))\n                {\n                    Thread.Sleep(10000);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "json.net"], "comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1576078891, "post_id": 59289251, "comment_id": 104783620, "body": "<code>I get what I want</code>, that&#39;s not feasible according to your <code>json</code> above. It&#39;s invalid <code>json</code> and fails all RFC&#39;s, what should we do?"}, {"owner": {"reputation": 4229, "user_id": 9363973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cbbp7.png?s=128&g=1", "display_name": "MindSwipe", "link": "https://stackoverflow.com/users/9363973/mindswipe"}, "reply_to_user": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1576079240, "post_id": 59289251, "comment_id": 104783826, "body": "@&#199;&#246;\u0111\u011bx\u011b\u0155 Which RFC&#39;s exactly? Putting it through a JSON validator shows that there is 1 comma too many, which I guess is a leftover from copy and pasting. <b>Edit after OPs edit:</b> Now there is not error in the JSON"}, {"owner": {"reputation": 4787, "user_id": 190281, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/21127f16e7235060e9bc6ef97b685a73?s=128&d=identicon&r=PG", "display_name": "SOReader", "link": "https://stackoverflow.com/users/190281/soreader"}, "edited": false, "score": 0, "creation_date": 1576079334, "post_id": 59289251, "comment_id": 104783882, "body": "I don&#39;t see what&#39;s wrong with it. Anyway - reformatted"}, {"owner": {"reputation": 4229, "user_id": 9363973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cbbp7.png?s=128&g=1", "display_name": "MindSwipe", "link": "https://stackoverflow.com/users/9363973/mindswipe"}, "edited": false, "score": 0, "creation_date": 1576079419, "post_id": 59289251, "comment_id": 104783923, "body": "The problem is that the <code>prop1</code>, <code>prop2</code>, <code>a</code>... properties aren&#39;t inside an array with the name <code>properties</code>. If they were this would work. Do you have control over the JSON source? If not, I&#39;m afraid a custom converter will be the only option"}, {"owner": {"reputation": 4787, "user_id": 190281, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/21127f16e7235060e9bc6ef97b685a73?s=128&d=identicon&r=PG", "display_name": "SOReader", "link": "https://stackoverflow.com/users/190281/soreader"}, "reply_to_user": {"reputation": 4229, "user_id": 9363973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cbbp7.png?s=128&g=1", "display_name": "MindSwipe", "link": "https://stackoverflow.com/users/9363973/mindswipe"}, "edited": false, "score": 0, "creation_date": 1576079569, "post_id": 59289251, "comment_id": 104784017, "body": "@MindSwipe yeah, I know there are not there but that&#39;s not the point. I want them to be represented inside my model as such. How to get that without writing custom converter? In instead of <code>Input[] Inputs</code> I had <code>JObject[] Inputs</code> this is exactly what I&#39;d get except then I won&#39;t have <code>Type</code> property. So.... this way or another - not ideal ;)"}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "reply_to_user": {"reputation": 4229, "user_id": 9363973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cbbp7.png?s=128&g=1", "display_name": "MindSwipe", "link": "https://stackoverflow.com/users/9363973/mindswipe"}, "edited": false, "score": 0, "creation_date": 1576079850, "post_id": 59289251, "comment_id": 104784170, "body": "@MindSwipe specifically it <i>was</i> 8259, 7159 and 4627"}], "answers": [{"tags": [], "owner": {"reputation": 4787, "user_id": 190281, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/21127f16e7235060e9bc6ef97b685a73?s=128&d=identicon&r=PG", "display_name": "SOReader", "link": "https://stackoverflow.com/users/190281/soreader"}, "is_accepted": false, "score": 1, "last_activity_date": 1576079818, "creation_date": 1576079818, "answer_id": 59289607, "question_id": 59289251, "link": "https://stackoverflow.com/questions/59289251/partial-object-deserialization-from-json/59289607#59289607", "title": "Partial object deserialization from JSON", "body": "<p>Ok, I'm really sorry for bothering you. It turned out that I missed <code>JsonExtensionData</code> attribute. So the <code>Input</code> type should look like this:</p>\n\n<pre><code>class Input {\n  [JsonConverter(typeof(......))]\n  public InputType Type {get; set;}\n\n  [JsonExtensionData]\n  public IDictionary&lt;string, object&gt; Properties {get; set;}\n}\n</code></pre>\n"}], "owner": {"reputation": 4787, "user_id": 190281, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/21127f16e7235060e9bc6ef97b685a73?s=128&d=identicon&r=PG", "display_name": "SOReader", "link": "https://stackoverflow.com/users/190281/soreader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576079818, "creation_date": 1576078661, "last_edit_date": 1576079265, "question_id": 59289251, "link": "https://stackoverflow.com/questions/59289251/partial-object-deserialization-from-json", "title": "Partial object deserialization from JSON", "body": "<p>I have a JSON that looks similar to this:</p>\n\n<pre><code>{\n  \"definition\": [\n    {\n      \"inputs\": [\n        {\n          \"type\": \"xxx\",\n          \"prop1\": 0,\n          \"prop2\": 1\n        },\n        {\n          \"type\": \"yyy\",\n          \"a\": 0,\n          \"b\": 1\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>My model looks like that:</p>\n\n<pre><code>class Configuration {\n  public Definition[] Definition {get; set;}\n}\n\nclass Definition {\n  public Input[] Inputs {get; set;}\n}\n\nclass Input {\n  [JsonConverter(typeof(ControlTypeConverter))]\n  public InputType Type {get; set;}\n  public IDictionary&lt;string, object&gt; Properties {get; set;}\n}\n</code></pre>\n\n<p>When I deserialise input using <code>JsonConvert.DeserializeObject&lt;Configuration&gt;(input)</code>, where <code>input</code> is an above-mentioned string, I get what I want but <code>Properties</code> property is always <code>null</code>.</p>\n\n<p>What I'd like to get is that all unmapped properties for objects from <code>input.definition[].inputs[]</code> get squized into <code>Properties</code> property, just as if I used <code>.DeserializeObject&lt;Dictionary&lt;string, object&gt;&gt;</code>.</p>\n\n<p>Is there a any better way than writing custom converter for <code>Input</code>?</p>\n"}, {"tags": ["javascript", "c#", "jquery", "razor"], "answers": [{"tags": [], "owner": {"reputation": 9049, "user_id": 181315, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c7a87152d5f5bdb6a451f3e3cc03faee?s=128&d=identicon&r=PG", "display_name": "Polyfun", "link": "https://stackoverflow.com/users/181315/polyfun"}, "is_accepted": true, "score": 4, "last_activity_date": 1576144460, "last_edit_date": 1576144460, "creation_date": 1576079095, "answer_id": 59289371, "question_id": 59289172, "link": "https://stackoverflow.com/questions/59289172/session-variable-defaults-to-the-last-one-set/59289371#59289371", "title": "Session variable defaults to the last one set", "body": "<p>As this is a Razor page, when you do:</p>\n\n<pre><code>@{Session[\"Clinician\"] = \"diag\"};\n</code></pre>\n\n<p>this will execute before the page is rendered in the browser. So as the page loads, the following are executed <em>server-side</em> in sequence:</p>\n\n<pre><code>@{Session[\"Clinician\"] = \"opa\"};\n@{Session[\"Clinician\"] = \"ca\"};\n@{Session[\"Clinician\"] = \"diag\"};\n</code></pre>\n\n<p>Contrary to your expectations, they are <em>not</em> being executed on clicking the respective grid, as that is a pure client-side interactive event.</p>\n\n<p>I suggest you replace \"@{Session[\"Clinician\"] = \"...\"};\" with an ajax call to a new controller action that sets the string in the session. So something like this:</p>\n\n<p>JavaScript:</p>\n\n<pre><code>function Session()\n{\n}\n\nSession.SetString = function (key, value)\n{\n    $.post(\"/Home/SessionString?key=\" + key + \"&amp;value=\" + value);\n};\n\nSession.GetString = function (key, successCallback)\n{\n    $.get(\"/Home/SessionString?key=\" + key, null, function (data, textStatus, jqXHR) { successCallback(data) });\n};\n\n$('body').on('click', '#clinician-appointments&gt;tbody&gt;tr&gt;td:not(:last-child):not(:first-child)', function () {\n     var id = $(this).closest(\"tr\").children(\"td.grid__col--id\").find(\"[name=patient-link]\").text().trim();\n     Session.SetString(\"Clinician\", \"opa\");\n     location.href = \"@Url.Action(\"Summary\", \"Patient\")\" + \"/\" + id;\n});\n</code></pre>\n\n<p>Controller (for .NET Core):</p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// Sets a value in the user's session.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"key\"&gt;The key for the value.&lt;/param&gt;\n    /// &lt;param name=\"value\"&gt;The value.&lt;/param&gt;\n    [HttpPost]\n    public IActionResult SessionString(string key, string value)\n    {\n        HttpContext.Session.SetString(key, value);\n        return new JsonResult(null);\n    }\n\n    /// &lt;summary&gt;\n    /// Get a value from the user's session.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"key\"&gt;The key for the value.&lt;/param&gt;\n    /// &lt;returns&gt;The value.&lt;/returns&gt;\n    [HttpGet]\n    public IActionResult SessionString(string key)\n    {\n        string value = HttpContext.Session.GetString(key);\n        return new JsonResult(value);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 10407961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2be5201f6f8b2f672695c80cc98ba3f?s=128&d=identicon&r=PG&f=1", "display_name": "S.Gray", "link": "https://stackoverflow.com/users/10407961/s-gray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59289371, "answer_count": 1, "score": 2, "last_activity_date": 1576144460, "creation_date": 1576078405, "last_edit_date": 1576079487, "question_id": 59289172, "link": "https://stackoverflow.com/questions/59289172/session-variable-defaults-to-the-last-one-set", "title": "Session variable defaults to the last one set", "body": "<p>I know this is bad practice the way I am doing it, still I would like to understand why this is not working.</p>\n\n<p>I have 3 <code>onclick</code> methods for different grids in Javascript:</p>\n\n<pre><code>    $('body').on('click', '#clinician-appointments&gt;tbody&gt;tr&gt;td:not(:last-child):not(:first-child)', function () {\n         var id = $(this).closest(\"tr\").children(\"td.grid__col--id\").find(\"[name=patient-link]\").text().trim();\n         @{Session[\"Clinician\"] = \"opa\"};\n         location.href = \"@Url.Action(\"Summary\", \"Patient\")\" + \"/\" + id;\n             });\n\n    $('body').on('click', '#clinician-current-admissions&gt;tbody&gt;tr&gt;td:not(:last-child):not(:first-child)', function () {\n        var id = $(this).closest(\"tr\").children(\"td.grid__col--id\").find(\"[name=patient-link]\").text().trim();\n        location.href = \"@Url.Action(\"Summary\", \"Patient\")\" + \"/\" + id;\n       @{Session[\"Clinician\"] = \"ca\"};\n            });\n\n    $('body').on('click', '#clinician-diagnostics&gt;tbody&gt;tr&gt;td:not(:last-child):not(:first-child)', function () {\n        var id = $(this).closest(\"tr\").children(\"td.grid__col--id\").find(\"[name=patient-link]\").text().trim();\n        location.href = \"@Url.Action(\"Summary\", \"Patient\")\" + \"/\" + id;\n        @{Session[\"Clinician\"] = \"diag\"};\n            });  \n</code></pre>\n\n<p>However when I call the session in C# it is always \"diag\", the last one assigned.</p>\n\n<p>So as they are in different events the other ones will be missed.</p>\n"}, {"tags": ["c#", "unity3d", "delegates"], "comments": [{"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 2, "creation_date": 1576080519, "post_id": 59289140, "comment_id": 104784562, "body": "reusing the class name as a variable name is confusing"}, {"owner": {"reputation": 53, "user_id": 12519292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af7326cafac2fcf46915b7e30937452?s=128&d=identicon&r=PG", "display_name": "McGregor777", "link": "https://stackoverflow.com/users/12519292/mcgregor777"}, "reply_to_user": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1576080727, "post_id": 59289140, "comment_id": 104784696, "body": "I agree. On Visual Studio, the color scheme makes the Class name green and the Property name white, which is much less confusing. I&#39;ll make it clearer for the forum, thank you :)"}, {"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "edited": false, "score": 0, "creation_date": 1576081823, "post_id": 59289140, "comment_id": 104785266, "body": "BTW, you don&#39;t have a <code>OnDeselectAction</code> delegate. You have <i>two</i> <code>OnSelectAction</code>s instead."}, {"owner": {"reputation": 53, "user_id": 12519292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af7326cafac2fcf46915b7e30937452?s=128&d=identicon&r=PG", "display_name": "McGregor777", "link": "https://stackoverflow.com/users/12519292/mcgregor777"}, "edited": false, "score": 0, "creation_date": 1576084005, "post_id": 59289140, "comment_id": 104786367, "body": "Corrected, thank you ! :)"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 12519292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af7326cafac2fcf46915b7e30937452?s=128&d=identicon&r=PG", "display_name": "McGregor777", "link": "https://stackoverflow.com/users/12519292/mcgregor777"}, "edited": false, "score": 0, "creation_date": 1576084101, "post_id": 59290252, "comment_id": 104786419, "body": "This was so simple, this is so frustrating ! &gt;&lt; ^^&quot;  I didn&#39;t know about Function Closure, I&#39;ll take a look at that so I won&#39;t have any problem with this for the future. Thank you Draco ! :)"}], "tags": [], "owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "is_accepted": true, "score": 2, "last_activity_date": 1576082086, "creation_date": 1576082086, "answer_id": 59290252, "question_id": 59289140, "link": "https://stackoverflow.com/questions/59289140/delegates-for-onselect-and-ondeselect-purposes/59290252#59290252", "title": "Delegates for OnSelect and OnDeselect purposes", "body": "<p>Your first attempt doesn't work because that's not how you assign delegates.</p>\n\n<p>You need to do it like this:</p>\n\n<pre><code>selectableButton.onDeselect = Deselect;\n</code></pre>\n\n<p>Because you're assigning a method <em>reference</em> not the return value of a method <em>call.</em></p>\n\n<p>But because your Select/Deselect methods take a parameter, they don't match your delegate definitions. So you can't do it this way anyway (or you have to change the definition of your delegates to accept that parameter, but you probably don't want that).</p>\n\n<p>So then we get to your lambda version, which <em>assigns</em> correctly, but doesn't <em>function</em> correctly. And it doesn't <em>function</em> correctly because of <a href=\"https://stackoverflow.com/questions/111102/how-do-javascript-closures-work\">Function Closure</a>.</p>\n\n<pre><code>for(int i = 0; i &lt; racesData.RaceList.Count; i++)\n{\n    int j = i; //declare new local variable with a copy of the data\n    selectableButton.onSelect = () =&gt; Select(racesData.RaceList[j]);\n    selectableButton.onDeselect = () =&gt; Deselect(racesData.RaceList[j]);\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 12519292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4af7326cafac2fcf46915b7e30937452?s=128&d=identicon&r=PG", "display_name": "McGregor777", "link": "https://stackoverflow.com/users/12519292/mcgregor777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 59290252, "answer_count": 1, "score": 5, "last_activity_date": 1576083964, "creation_date": 1576078248, "last_edit_date": 1576083964, "question_id": 59289140, "link": "https://stackoverflow.com/questions/59289140/delegates-for-onselect-and-ondeselect-purposes", "title": "Delegates for OnSelect and OnDeselect purposes", "body": "<p>I'm working on Unity and trying hard to make a custom SelectableButton that stores method(s) in two different delegates, and executes one whenever the button is selected and the other when it is deselected. The relevant part shows like that :</p>\n\n<pre><code>public delegate void OnSelectAction();\npublic delegate void OnDeselectAction();\n\npublic class SelectableButton : MonoBehaviour\n{\n    private bool selected;\n\n    public OnSelectAction onSelect;\n    public OnDeselectAction onDeselect;\n\n    public bool Selected\n    {\n        get { return selected; }\n        set\n        {\n            selected = value;\n\n            if(selected)\n                onSelect();\n            else\n                onDeselect();\n        }\n    }\n}\n</code></pre>\n\n<p>On another script, I try to encapsulate a method in onSelect and another in onDeselect.</p>\n\n<pre><code>for(int i = 0; i &lt; racesData.RaceList.Count; i++)\n{\n    selectableButton.onSelect = Select(racesData.RaceList[i]);\n    selectableButton.onDeselect = Deselect(racesData.RaceList[i]);\n}\n\npublic void Select(Race race)\n{\n// Does its selection stuff\n}\n\npublic void Deselect(Race race)\n{\n// Does its deselection stuff\n}\n</code></pre>\n\n<p>In the end, I end up with an error telling me that I can't \"convert void to OnSelectAction/OnDeselectAction\". And if I try to write it rather this way :</p>\n\n<pre><code>selectableButton.onSelect = () =&gt; Select(racesData.RaceList[i]);\nselectableButton.onDeselect = () =&gt; Deselect(racesData.RaceList[i]);\n</code></pre>\n\n<p>The Select() and Deselect() methods don't execute the way they are supposed to. If someone could help in giving me the part that I'm lacking to make this work, it would be nice and I'd be grateful for the hand :)</p>\n"}]