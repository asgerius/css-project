[{"tags": ["c#", "signalr"], "comments": [{"owner": {"reputation": 30145, "user_id": 1168070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e461ac690e034cb5b99cf011311c1c7?s=128&d=identicon&r=PG", "display_name": "Pawel", "link": "https://stackoverflow.com/users/1168070/pawel"}, "edited": false, "score": 1, "creation_date": 1436400599, "post_id": 31305882, "comment_id": 50601445, "body": "Have you seen this: <a href=\"http://stackoverflow.com/questions/21849511/how-to-prevent-signalr-errors-from-stopping-further-execution-of-javascript\" title=\"how to prevent signalr errors from stopping further execution of javascript\">stackoverflow.com/questions/21849511/&hellip;</a> ?"}, {"owner": {"reputation": 153, "user_id": 2151460, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/594ab11fd7c482dbdc5c7d854de4fff0?s=128&d=identicon&r=PG", "display_name": "Dexception", "link": "https://stackoverflow.com/users/2151460/dexception"}, "reply_to_user": {"reputation": 30145, "user_id": 1168070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e461ac690e034cb5b99cf011311c1c7?s=128&d=identicon&r=PG", "display_name": "Pawel", "link": "https://stackoverflow.com/users/1168070/pawel"}, "edited": false, "score": 0, "creation_date": 1436430917, "post_id": 31305882, "comment_id": 50612602, "body": "Yes i have now. Didn&#39;t really help me so much tho. Looking in Chrome devtools it shows that i get the &quot;ERR_CONNECTION_REFUSED&quot; on the line with <code>&lt;script src=&quot;http:&#47;&#47;localhost:8080&#47;signalr&#47;hubs&quot;&gt;&lt;&#47;script&gt;</code>"}, {"owner": {"reputation": 153, "user_id": 2151460, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/594ab11fd7c482dbdc5c7d854de4fff0?s=128&d=identicon&r=PG", "display_name": "Dexception", "link": "https://stackoverflow.com/users/2151460/dexception"}, "reply_to_user": {"reputation": 30145, "user_id": 1168070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e461ac690e034cb5b99cf011311c1c7?s=128&d=identicon&r=PG", "display_name": "Pawel", "link": "https://stackoverflow.com/users/1168070/pawel"}, "edited": false, "score": 0, "creation_date": 1436477895, "post_id": 31305882, "comment_id": 50643475, "body": "I tried now to download a sample project from here <a href=\"http://www.asp.net/signalr/overview/deployment/tutorial-signalr-self-host\" rel=\"nofollow noreferrer\">asp.net/signalr/overview/deployment/tutorial-signalr-self-ho&zwnj;&#8203;st</a> , and it works with that one using the same adress and port. Could it be that im using wpf and they used console applikation?"}, {"owner": {"reputation": 175, "user_id": 4382444, "user_type": "registered", "profile_image": "https://graph.facebook.com/1467064386/picture?type=large", "display_name": "Edward Chopuryan", "link": "https://stackoverflow.com/users/4382444/edward-chopuryan"}, "edited": false, "score": 0, "creation_date": 1487321486, "post_id": 31305882, "comment_id": 71741855, "body": "Could it be that you have some kind of ad blocker like U Block or something that blocks it? Can you try with another browser that doesn&#39;t have any plugins to see if you still get the same error?"}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 5710578, "user_type": "registered", "profile_image": "https://graph.facebook.com/1620974474835285/picture?type=large", "display_name": "Ufuk Ayd\u0131n", "link": "https://stackoverflow.com/users/5710578/ufuk-ayd%c4%b1n"}, "is_accepted": false, "score": 0, "last_activity_date": 1512740840, "creation_date": 1512740840, "answer_id": 47715671, "question_id": 31305882, "link": "https://stackoverflow.com/questions/31305882/signalr-err-conection-refused-on-signalr-hubs/47715671#47715671", "title": "SignalR ERR_CONECTION_REFUSED on signalr/hubs", "body": "<p>Try this-->CorsOptions.AllowAll;            </p>\n\n<pre><code>        app.UseCors(CorsOptions.AllowAll);\n        var hubConfiguration = new HubConfiguration() ;\n        hubConfiguration.EnableDetailedErrors = true;\n\n        app.MapSignalR(hubConfiguration); \n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 2151460, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/594ab11fd7c482dbdc5c7d854de4fff0?s=128&d=identicon&r=PG", "display_name": "Dexception", "link": "https://stackoverflow.com/users/2151460/dexception"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2454, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1512740840, "creation_date": 1436399925, "question_id": 31305882, "link": "https://stackoverflow.com/questions/31305882/signalr-err-conection-refused-on-signalr-hubs", "title": "SignalR ERR_CONECTION_REFUSED on signalr/hubs", "body": "<p>Have changed computer to run my project and website on, and now it doesn't work at all.</p>\n\n<p>When I go to <a href=\"http://localhost:8080/signalr/hubs\" rel=\"nofollow\">http://localhost:8080/signalr/hubs</a> I get \"ERR_CONNECTION_REFUSED\"</p>\n\n<p>In my Self-Hosted aplikation:</p>\n\n<pre><code>string url = \"http://*:8080\";\nusing (WebApp.Start(url))\n {\n     writeStatus(\"Server running on \" + url);\n }\n</code></pre>\n\n<p>And on my website: </p>\n\n<pre><code>&lt;script src=\"http://localhost:8080/signalr/hubs\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>What have i missed?</p>\n"}, {"tags": ["c#", "algorithm", "geolocation", "coordinates", "binning"], "comments": [{"owner": {"reputation": 203, "user_id": 5016905, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7534f7a6db73bfb6dd79edf41bc773df?s=128&d=identicon&r=PG", "display_name": "Uthsav Chitra", "link": "https://stackoverflow.com/users/5016905/uthsav-chitra"}, "edited": false, "score": 2, "creation_date": 1436402672, "post_id": 31305866, "comment_id": 50601927, "body": "If the size of the boxes is constant, you probably can eliminate the first pass-- just build the boxes coming out of the first point.   It&#39;s unclear what you&#39;re using this for exactly. Without this information, it&#39;s hard to answer your question."}, {"owner": {"reputation": 255, "user_id": 3973398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4d0c258e247c910d2f7ca37a2bd14c?s=128&d=identicon&r=PG&f=1", "display_name": "markiz", "link": "https://stackoverflow.com/users/3973398/markiz"}, "edited": false, "score": 0, "creation_date": 1436429530, "post_id": 31305866, "comment_id": 50611632, "body": "You might want to check out data structures that are better suited to hold spatial information such as quadtrees or R-trees."}], "owner": {"reputation": 2235, "user_id": 3905007, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c5ad2a3d34bacb4e2c90b2046cf4422c?s=128&d=identicon&r=PG&f=1", "display_name": "youngrrrr", "link": "https://stackoverflow.com/users/3905007/youngrrrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436402505, "creation_date": 1436399849, "last_edit_date": 1436402505, "question_id": 31305866, "link": "https://stackoverflow.com/questions/31305866/most-efficient-way-to-bin-an-array-of-geographic-points", "title": "Most efficient way to bin an array of geographic points?", "body": "<p>Term(s):</p>\n\n<ul>\n<li>Binning: in maps-based UI, the objective of binning is to help make spatial data more visible to the user. Rather than render each geographical point individually, it is easier to digest a 'bin' (e.g. a hexagonal or rectangular shape, like in the below example) with simpler information instead (e.g. the number of points the bin contains).</li>\n</ul>\n\n<p>I am trying to bin a set of geographic points (example: <a href=\"http://a.tiles.mapbox.com/v3/devseed.map-hw6ew799/page.html#9/-0.3246/35.8887\" rel=\"nofollow\">http://a.tiles.mapbox.com/v3/devseed.map-hw6ew799/page.html#9/-0.3246/35.8887</a>). I'm unsure if my approach is the most efficient implementation. Thoughts on my 'algorithm' or pointers would be appreciated.</p>\n\n<p>I will be implementing this in C#.</p>\n\n<p>Say I have a csv where each line is a (<code>lat</code>,<code>lon</code>) <code>point</code>. I read <code>n</code> of them and must render these <code>points</code> in bins to make the data easier to view on a map.</p>\n\n<p>For this implementation I will try to bin the <code>points</code> into rectangular shapes (so what was in the example, except more square-y because it's simpler for calculations). Here it is:</p>\n\n<ol>\n<li><p>Determine the maximum and minimum latitude and longitude for a total of 4 different values. These values will form my overall <code>bounding box</code> of all possible <code>points</code>. <strong>Cost:</strong> n=> <strong>O(n)</strong><code>using a</code>for loop<code>, where</code>n<code>is the number of</code>points` I read.</p></li>\n<li><p>Once I have the above 4 values, I will subdivide this big <code>bounding box</code> into a <code>HashMap</code>, mapping from single points to the respective mini-bounding <code>box object</code> (which will contain information like: what specific points it contains, its <code>point</code> <code>count</code>, its <code>bounds</code>, etc). <strong>Cost:</strong> a * b => <strong>O(a * b)</strong>, where <code>a</code> is the time it takes to construct a single <code>bounding box</code> and <code>b</code> is the number of <code>bounding boxes</code> constructed.</p></li>\n<li><p>Then, re-iterate through the list of <code>points</code>, hashing each point to its respective bounding box. <strong>Cost:</strong> n => <strong>O(n)</strong>, where <code>n</code> is the number of points.</p></li>\n</ol>\n\n<p><strong>Sum cost</strong> (if I did this right): <strong>O(n + b)</strong>.</p>\n\n<p>Is this the most efficient algorithm?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "vb.net", "asp.net-web-api", "webforms"], "comments": [{"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1436399974, "post_id": 31305843, "comment_id": 50601270, "body": "Mixing languages within projects is not workable to my knowledge. If the classes are in different assemblies, you should be able to do this though."}], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 4911512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJhcB.png?s=128&g=1", "display_name": "Carey Tzou", "link": "https://stackoverflow.com/users/4911512/carey-tzou"}, "is_accepted": true, "score": 1, "last_activity_date": 1436402409, "creation_date": 1436402409, "answer_id": 31306246, "question_id": 31305843, "link": "https://stackoverflow.com/questions/31305843/setup-c-web-api-in-vb-net-website/31306246#31306246", "title": "Setup c# web api in vb.net Website", "body": "<p>Maybe you need write your csharp method in another project, and using it at your vb.net project.</p>\n"}], "owner": {"reputation": 153, "user_id": 3806260, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6d1999e56ed75409d4ac916dbca63bd3?s=128&d=identicon&r=PG&f=1", "display_name": "Ray Sun", "link": "https://stackoverflow.com/users/3806260/ray-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 31306246, "answer_count": 1, "score": 2, "last_activity_date": 1436402409, "creation_date": 1436399721, "last_edit_date": 1436402377, "question_id": 31305843, "link": "https://stackoverflow.com/questions/31305843/setup-c-web-api-in-vb-net-website", "title": "Setup c# web api in vb.net Website", "body": "<p>I have a website that was built in <code>VB.Net</code> using <code>ASP.NET web forms</code>, now I want to add a <code>Web Api</code> to it and using <code>c#</code>, is it possible? If so how to do it.</p>\n\n<p>I did tried it and getting the message </p>\n\n<blockquote>\n  <p>\"No type was found that matches the controller named 'get' \"</p>\n</blockquote>\n\n<p>, so I suspect it may not be possible to mixing languages on <code>Web Api's</code>, but want to confirm.</p>\n"}, {"tags": ["c#", "methods", "entity-framework-4"], "comments": [{"owner": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 0, "creation_date": 1436401122, "post_id": 31305839, "comment_id": 50601546, "body": "You could use a better title for your question :)  Some thing like <code>How to dynamically generate Includes in entity framework</code> or something like that.  And you might want to add the <code>entity-framework</code> tag to your question."}, {"owner": {"reputation": 861, "user_id": 2923465, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w8XHf.jpg?s=128&g=1", "display_name": "Ege Ayd\u0131n", "link": "https://stackoverflow.com/users/2923465/ege-ayd%c4%b1n"}, "reply_to_user": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 0, "creation_date": 1436401930, "post_id": 31305839, "comment_id": 50601767, "body": "Well that&#39;s a better title for sure. :) But this is not a EF specified question but you might be right though."}, {"owner": {"reputation": 861, "user_id": 2923465, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w8XHf.jpg?s=128&g=1", "display_name": "Ege Ayd\u0131n", "link": "https://stackoverflow.com/users/2923465/ege-ayd%c4%b1n"}, "reply_to_user": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 0, "creation_date": 1436402009, "post_id": 31305839, "comment_id": 50601783, "body": "I took your advice. :)"}], "answers": [{"comments": [{"owner": {"reputation": 861, "user_id": 2923465, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w8XHf.jpg?s=128&g=1", "display_name": "Ege Ayd\u0131n", "link": "https://stackoverflow.com/users/2923465/ege-ayd%c4%b1n"}, "edited": false, "score": 0, "creation_date": 1436402019, "post_id": 31305870, "comment_id": 50601786, "body": "I am giving it a try."}], "tags": [], "owner": {"reputation": 117905, "user_id": 1163867, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2fe5ef74a2c17f19c75d2f49b95fb71d?s=128&d=identicon&r=PG", "display_name": "MarcinJuraszek", "link": "https://stackoverflow.com/users/1163867/marcinjuraszek"}, "is_accepted": true, "score": 6, "last_activity_date": 1436399870, "creation_date": 1436399870, "answer_id": 31305870, "question_id": 31305839, "link": "https://stackoverflow.com/questions/31305839/how-to-dynamically-generate-includes-in-entity-framework/31305870#31305870", "title": "How to dynamically generate Includes in entity framework", "body": "<p>Declare your local variable as <code>DbQuery&lt;Entity&gt;</code>, reassign result of <code>Include</code> call to it and call <code>ToList</code> on it after the loop:</p>\n\n<pre><code>public List&lt;Entity&gt; GetAll(List&lt;string&gt; includes&gt;)\n{\n     DbQuery&lt;Entity&gt; entites = context.Entites;\n     foreach(string s in includes)\n     {\n          entities = entites.Include(s);\n     }\n     return entites.ToList();\n}\n</code></pre>\n"}], "owner": {"reputation": 861, "user_id": 2923465, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/w8XHf.jpg?s=128&g=1", "display_name": "Ege Ayd\u0131n", "link": "https://stackoverflow.com/users/2923465/ege-ayd%c4%b1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 31305870, "answer_count": 1, "score": 6, "last_activity_date": 1436401995, "creation_date": 1436399702, "last_edit_date": 1436401995, "question_id": 31305839, "link": "https://stackoverflow.com/questions/31305839/how-to-dynamically-generate-includes-in-entity-framework", "title": "How to dynamically generate Includes in entity framework", "body": "<p>Well I am not sure if this questions asked before but I have no idea how the search for it. Well this is not an Entity Framework specified question but I am gonna give example using it.</p>\n\n<p>So in EF we need to use <code>.Include(\"Related Object\")</code> to include related data. However what I want to is that write a method that takes a List of strings and returns the entity or entity list with the related objects.</p>\n\n<p>In example</p>\n\n<pre><code>public List&lt;Entity&gt; GetAll(List&lt;string&gt; includes&gt;)\n{\n     List&lt;Entity&gt; entites = context.Entites;\n     foreach(string s in includes)\n     {\n          entites.Include(s);\n     }\n     return entites;\n}\n</code></pre>\n\n<p>Obviously above example won't work since I already called out the Entites when I declared the list. But I think it demonstrates the point. </p>\n"}, {"tags": ["c#", "sql", "database", "ado.net"], "comments": [{"owner": {"reputation": 12613, "user_id": 2312877, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0510f99ab1ac9f932e34c2081745d710?s=128&d=identicon&r=PG", "display_name": "Kritner", "link": "https://stackoverflow.com/users/2312877/kritner"}, "edited": false, "score": 0, "creation_date": 1436403818, "post_id": 31305838, "comment_id": 50602212, "body": "are you sure the database you&#39;re checking in visual studio is the same database your ADO object is saving too?"}, {"owner": {"reputation": 1081, "user_id": 4974464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ad5ebda289a6189691686c1b54efb?s=128&d=identicon&r=PG&f=1", "display_name": "Sky Fang", "link": "https://stackoverflow.com/users/4974464/sky-fang"}, "edited": false, "score": 0, "creation_date": 1436404007, "post_id": 31305838, "comment_id": 50602268, "body": "<code>int i = command.ExecuteNonQuery();</code> You can have a look at how many rows changed"}, {"owner": {"reputation": 71, "user_id": 4139687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dHw9v.jpg?s=128&g=1", "display_name": "Argent Drake", "link": "https://stackoverflow.com/users/4139687/argent-drake"}, "edited": false, "score": 0, "creation_date": 1436410643, "post_id": 31305838, "comment_id": 50603824, "body": "Kritner- I believe so, I&#39;ve cleaned up all files and folders, removed the connection and reconnected it to the db.  sky- Thank you I hadn&#39;t noticed that it returns an int for rows affected. As expected it hands back a 1 unless I cause an error."}, {"owner": {"reputation": 6213, "user_id": 167611, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d13bd8fb71bb869c984ec2bcd772eee9?s=128&d=identicon&r=PG", "display_name": "SteveCav", "link": "https://stackoverflow.com/users/167611/stevecav"}, "edited": false, "score": 0, "creation_date": 1436415906, "post_id": 31305838, "comment_id": 50605163, "body": "How are you checking the data through VS? It looks like that&#39;s the only &quot;problem&quot;."}, {"owner": {"reputation": 71, "user_id": 4139687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dHw9v.jpg?s=128&g=1", "display_name": "Argent Drake", "link": "https://stackoverflow.com/users/4139687/argent-drake"}, "edited": false, "score": 0, "creation_date": 1436418870, "post_id": 31305838, "comment_id": 50606040, "body": "SteveCav- I&#39;ve been opening my database through visual studio using the solution explorer, or just opening it under server explorer. Once I can see the table, I just right click and hit show table data."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4139687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dHw9v.jpg?s=128&g=1", "display_name": "Argent Drake", "link": "https://stackoverflow.com/users/4139687/argent-drake"}, "edited": false, "score": 0, "creation_date": 1436418903, "post_id": 31308048, "comment_id": 50606057, "body": "Thanks for the input! I&#39;ve changed my code but still have the same problem. I&#39;m a little bewildered the compiler didn&#39;t have a fit over the way I had been doing it."}, {"owner": {"reputation": 2551, "user_id": 891394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/1VvYa.png?s=128&g=1", "display_name": "RobCroll", "link": "https://stackoverflow.com/users/891394/robcroll"}, "reply_to_user": {"reputation": 71, "user_id": 4139687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dHw9v.jpg?s=128&g=1", "display_name": "Argent Drake", "link": "https://stackoverflow.com/users/4139687/argent-drake"}, "edited": false, "score": 0, "creation_date": 1436420538, "post_id": 31308048, "comment_id": 50606695, "body": "2nd parameter in the AddWithValue method is of type object.  That is why no compiler error/warning"}, {"owner": {"reputation": 2551, "user_id": 891394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/1VvYa.png?s=128&g=1", "display_name": "RobCroll", "link": "https://stackoverflow.com/users/891394/robcroll"}, "reply_to_user": {"reputation": 71, "user_id": 4139687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dHw9v.jpg?s=128&g=1", "display_name": "Argent Drake", "link": "https://stackoverflow.com/users/4139687/argent-drake"}, "edited": false, "score": 0, "creation_date": 1436422433, "post_id": 31308048, "comment_id": 50607493, "body": "Hi @ArgentDrake text maps to SqlDbType.VarChar so there may be an issue there as well.  A better mapping would be nvarchar -&gt; SqlDbType.NVarChar"}], "tags": [], "owner": {"reputation": 2551, "user_id": 891394, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/1VvYa.png?s=128&g=1", "display_name": "RobCroll", "link": "https://stackoverflow.com/users/891394/robcroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1436422022, "last_edit_date": 1436422022, "creation_date": 1436415462, "answer_id": 31308048, "question_id": 31305838, "link": "https://stackoverflow.com/questions/31305838/ado-net-database-saves-but-doesnt-save/31308048#31308048", "title": "ADO.NET database saves, but doesn&#39;t save", "body": "<p><code>AddWithValue</code> method is supposed to take a parameterName and an object representing the value, not the <code>SqlDbType</code> so there is a problem there.  Also @Username is not the same as @username.  One has a capital U.</p>\n\n<p>Try this pattern instead:</p>\n\n<pre><code>command.Parameters.Add(\"@username \", SqlDbType.Text);\ncommand.Parameters[\"@username \"].Value = this.Name;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4139687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dHw9v.jpg?s=128&g=1", "display_name": "Argent Drake", "link": "https://stackoverflow.com/users/4139687/argent-drake"}, "is_accepted": false, "score": 0, "last_activity_date": 1436425036, "creation_date": 1436425036, "answer_id": 31310209, "question_id": 31305838, "link": "https://stackoverflow.com/questions/31305838/ado-net-database-saves-but-doesnt-save/31310209#31310209", "title": "ADO.NET database saves, but doesn&#39;t save", "body": "<p>I've found the solution. It turns out visual studio was generating a copy of my database into the debug folder. It explains why it would save but not be shown. To fix this, I just removed my data connection and pointed a new one at the .mdf file in my debug directory.</p>\n\n<p>Thank you all for the help!</p>\n"}], "owner": {"reputation": 71, "user_id": 4139687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/dHw9v.jpg?s=128&g=1", "display_name": "Argent Drake", "link": "https://stackoverflow.com/users/4139687/argent-drake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1436425036, "creation_date": 1436399698, "last_edit_date": 1436403769, "question_id": 31305838, "link": "https://stackoverflow.com/questions/31305838/ado-net-database-saves-but-doesnt-save", "title": "ADO.NET database saves, but doesn&#39;t save", "body": "<p>I have a program that allows the user to fill out their information, it is then stored in a local database. I can execute the stored procedure that handles it just fine, however when I check the data through visual studio the changes aren't there. However if I run my program and enter a duplicate primary key, the error is thrown that the value already exists. I've made sure that there are no duplicate files. </p>\n\n<p>Any suggestions?</p>\n\n<p>Stored procedure</p>\n\n<pre><code>CREATE PROCEDURE [dbo].[NewUser]\n@username as text,\n@password as text,\n@attackMethod as text,\n@statPreference as text\nAS\n    INSERT INTO Users\n    VALUES (@username,@password,@attackMethod,@statPreference)\nRETURN 0\n</code></pre>\n\n<p>and the code that runs to throw it into the database.</p>\n\n<pre><code>            try\n        {\n            connection.Open();\n            SqlCommand command = new SqlCommand(\"NewUser\",connection);\n            command.Connection = connection;\n\n            command.CommandType = CommandType.StoredProcedure;\n            command.Parameters.AddWithValue(\"@Username\", SqlDbType.NVarChar);\n            command.Parameters.AddWithValue(\"@Password\", SqlDbType.Text);\n            command.Parameters.AddWithValue(\"@attackMethod\", SqlDbType.Text);\n            command.Parameters.AddWithValue(\"@StatPreference\", SqlDbType.Text);\n            command.Parameters[\"@Username\"].Value = this.Name;\n            command.Parameters[\"@Password\"].Value = this.Password;\n            command.Parameters[\"@attackMethod\"].Value = this.AttackMethod;\n            command.Parameters[\"@StatPreference\"].Value = this.SkillPreference;\n            command.ExecuteNonQuery();\n            connection.Close();\n            return true;\n        }\n        catch(Exception ex)\n        {\n            System.Windows.Forms.MessageBox.Show(ex.Message);\n\n            connection.Close();\n            return false;\n        }\n</code></pre>\n"}, {"tags": ["c#", "json", "linq", "entity-framework"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436399567, "post_id": 31305743, "comment_id": 50601149, "body": "Could you give us an idea of the what <code>repository</code>&#39;s definition looks like? Also could you confirm that in code, when you set a break point after that return, that all the expected related objects have been deserialized. My suspicion is that feature doesn&#39;t apply to the entity relationships. My experience with it was that if you had a recursive structure, you needed it. Like a type that referenced an array of the same type."}, {"owner": {"reputation": 7159, "user_id": 1251127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w1M26.jpg?s=128&g=1", "display_name": "ESG", "link": "https://stackoverflow.com/users/1251127/esg"}, "edited": false, "score": 2, "creation_date": 1436399578, "post_id": 31305743, "comment_id": 50601152, "body": "Are you using code first? Can you display your entities?"}, {"owner": {"reputation": 25, "user_id": 5096150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0474b6362853d223f274584e92bcdd?s=128&d=identicon&r=PG&f=1", "display_name": "Iftikhar Ali", "link": "https://stackoverflow.com/users/5096150/iftikhar-ali"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436399791, "post_id": 31305743, "comment_id": 50601215, "body": "@evanmcdonnal I&#39;ve used architecture explained in below link <a href=\"http://blog.longle.net/2013/05/11/genericizing-the-unit-of-work-pattern-repository-pattern-with-entity-framework-in-mvc/\" rel=\"nofollow noreferrer\">blog.longle.net/2013/05/11/&hellip;</a>  I&#39;ve set a break point and even serialized the return object from repository it contains all related objects. It&#39;s only on the client side that I don&#39;t receive JSON consisting of all objects."}, {"owner": {"reputation": 25, "user_id": 5096150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0474b6362853d223f274584e92bcdd?s=128&d=identicon&r=PG&f=1", "display_name": "Iftikhar Ali", "link": "https://stackoverflow.com/users/5096150/iftikhar-ali"}, "reply_to_user": {"reputation": 7159, "user_id": 1251127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w1M26.jpg?s=128&g=1", "display_name": "ESG", "link": "https://stackoverflow.com/users/1251127/esg"}, "edited": false, "score": 0, "creation_date": 1436400090, "post_id": 31305743, "comment_id": 50601299, "body": "@TheVedge I&#39;ve reverse engineered my entities using Entity Framework Power Tools."}], "answers": [{"tags": [], "owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "is_accepted": true, "score": 1, "last_activity_date": 1436403972, "creation_date": 1436403972, "answer_id": 31306451, "question_id": 31305743, "link": "https://stackoverflow.com/questions/31305743/asp-net-webapi-json-response-does-not-serialize-entity-relationships/31306451#31306451", "title": "ASP.Net WebAPI JSON response does not serialize entity relationships", "body": "<p>If you're using OData query then you can use $expand property to get the reference included in your response. \nE.g.</p>\n\n<p><code>GET http://localhost/odata/Products(1)?$expand=Products/Supplier</code></p>\n\n<p>Will result in loading the Supplier details rather than just returning ID of supplier.</p>\n\n<pre><code>{\n  \"odata.metadata\":\"http://localhost/odata/$metadata#Categories/@Element\",\n  \"Products\":[\n    {\n      \"Supplier\":{\"Key\":\"CTSO\",\"Name\":\"Contoso, Ltd.\"},\n      \"ID\":1,\"Name\":\"Hat\",\"Price\":\"15.00\",\"CategoryId\":1,\"SupplierId\":\"CTSO\"\n    },\n    {\n      \"Supplier\":{\"Key\":\"CTSO\",\"Name\":\"Contoso, Ltd.\"},\n      \"ID\":2,\"Name\":\"Scarf\",\"Price\":\"12.00\",\"CategoryId\":1,\"SupplierId\":\"CTSO\"\n    },{\n      \"Supplier\":{\n        \"Key\":\"FBRK\",\"Name\":\"Fabrikam, Inc.\"\n      },\"ID\":3,\"Name\":\"Socks\",\"Price\":\"5.00\",\"CategoryId\":1,\"SupplierId\":\"FBRK\"\n    }\n  ],\"ID\":1,\"Name\":\"Apparel\"\n}\n</code></pre>\n\n<p>See this <a href=\"http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/using-$select,-$expand,-and-$value\" rel=\"nofollow\">article</a> for details.</p>\n"}], "owner": {"reputation": 25, "user_id": 5096150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed0474b6362853d223f274584e92bcdd?s=128&d=identicon&r=PG&f=1", "display_name": "Iftikhar Ali", "link": "https://stackoverflow.com/users/5096150/iftikhar-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "accepted_answer_id": 31306451, "answer_count": 1, "score": 2, "last_activity_date": 1436403972, "creation_date": 1436399028, "last_edit_date": 1436400225, "question_id": 31305743, "link": "https://stackoverflow.com/questions/31305743/asp-net-webapi-json-response-does-not-serialize-entity-relationships", "title": "ASP.Net WebAPI JSON response does not serialize entity relationships", "body": "<p>I'm developing an ASP.Net MVC5 application using Web API 5, OData and Entity Framework 6. I've created Repositories and used Entity Framework Power Tools to generate my entity models. I've turned OFF lazy loading and proxy generation on my DBContext. Below is how i'm writing my LINQ queries in repository classes to return entities with relationships;</p>\n\n<pre><code>           return repository\n            .Query(i =&gt; i.IsTransaction == true)\n            .Include(i =&gt; i.SubInventory)\n            .Include(c =&gt; c.Contact)                \n            .OrderBy(q =&gt; q\n                .OrderBy(i =&gt; i.ItemFullCode))                \n            .Select();\n</code></pre>\n\n<p>Further in my ODataConfig file I've set;</p>\n\n<pre><code>config.Formatters.JsonFormatter.SerializerSettings.ReferenceLoopHandling\n            = Newtonsoft.Json.ReferenceLoopHandling.Ignore;\n\nconfig.Formatters.JsonFormatter.SerializerSettings.PreserveReferencesHandling\n            = Newtonsoft.Json.PreserveReferencesHandling.Objects;\n</code></pre>\n\n<p>The issue that I'm struggling with is that my Web API method JSON response does NOT contain relationships which are Included in LINQ query but just the main entity data. Any idea what I'm missing here?</p>\n\n<p>Below is the code of my main entity.</p>\n\n<pre><code>    public partial class Item : Entity\n{\n    public Item()\n    {\n        this.DocumentDatas = new List&lt;DocumentData&gt;();\n        this.ItemColorSizes = new List&lt;ItemColorSize&gt;();\n        this.ItemPrices = new List&lt;ItemPrice&gt;();\n        this.Items1 = new List&lt;Item&gt;();\n        this.ItemStocks = new List&lt;ItemStock&gt;();\n        this.SeasonalSaleDetails = new List&lt;SeasonalSaleDetail&gt;();\n    }\n\n    public string ItemFullCode { get; set; }\n    public string ItemCode { get; set; }\n    public string ItemName { get; set; }\n    public string ItemShortCode { get; set; }\n    public string LevelItemFullCode { get; set; }\n    public string SupplierCode { get; set; }\n    public string SubInvCode { get; set; }\n    public Nullable&lt;decimal&gt; PurchasePrice { get; set; }\n    public Nullable&lt;decimal&gt; SalePrice { get; set; }\n    public Nullable&lt;System.DateTime&gt; ArrivalDate { get; set; }\n    public string RefCode { get; set; }\n    public Nullable&lt;decimal&gt; TColumn { get; set; }\n    public Nullable&lt;bool&gt; TColumnByAmt { get; set; }\n    public Nullable&lt;bool&gt; IsGiftItem { get; set; }\n    public Nullable&lt;bool&gt; IsTransaction { get; set; }\n    public Nullable&lt;bool&gt; IsActive { get; set; }\n    public string CreatedBy { get; set; }\n    public Nullable&lt;System.DateTime&gt; CreatedDate { get; set; }\n    public string ModifiedBy { get; set; }\n    public Nullable&lt;System.DateTime&gt; ModifiedDate { get; set; }\n    public Contact Contact { get; set; }\n    public ICollection&lt;DocumentData&gt; DocumentDatas { get; set; }\n    public ICollection&lt;ItemColorSize&gt; ItemColorSizes { get; set; }\n    public ICollection&lt;ItemPrice&gt; ItemPrices { get; set; }\n    public ICollection&lt;Item&gt; Items1 { get; set; }\n    public Item Item1 { get; set; }\n    public SubInventory SubInventory { get; set; }\n    public ICollection&lt;ItemStock&gt; ItemStocks { get; set; }\n    public ICollection&lt;SeasonalSaleDetail&gt; SeasonalSaleDetails { get; set; }\n}\n</code></pre>\n"}, {"tags": ["c#", "console-application", "azure-servicebus-queues"], "comments": [{"owner": {"reputation": 1349, "user_id": 3590921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PjoWk.jpg?s=128&g=1", "display_name": "Jason Hogg - MSFT", "link": "https://stackoverflow.com/users/3590921/jason-hogg-msft"}, "edited": false, "score": 0, "creation_date": 1436650006, "post_id": 31305651, "comment_id": 50704738, "body": "I updated the tag as you are using Service Bus Queues not Azure Storage Queues."}], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 1693952, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f2e1ed58595ace31b47edd895a4a9521?s=128&d=identicon&r=PG", "display_name": "Loki", "link": "https://stackoverflow.com/users/1693952/loki"}, "is_accepted": true, "score": 1, "last_activity_date": 1441296883, "creation_date": 1441296883, "answer_id": 32380731, "question_id": 31305651, "link": "https://stackoverflow.com/questions/31305651/cant-debug-using-queueclient-onmessage-on-a-console-app/32380731#32380731", "title": "Cant debug Using QueueClient.OnMessage on a console app", "body": "<p>We've run into this exact problem this afternoon and after taking code out line by line found that it's something to do with using Newtonsoft. If you comment out your line:</p>\n\n<pre><code>Empresa empresa = JsonConvert.DeserializeObject&lt;Empresa&gt;(mensaje);\n</code></pre>\n\n<p>You should find that it works. </p>\n\n<p>We've got round this by wrapping the JsonConvert functionality in another class which we're calling from our OnMessage method. </p>\n\n<p>I've no idea why this is the case unfortunately, but I hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6583886, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/57c83998d64110509377a258929805fc?s=128&d=identicon&r=PG", "display_name": "Martijn", "link": "https://stackoverflow.com/users/6583886/martijn"}, "is_accepted": false, "score": 1, "last_activity_date": 1468405182, "creation_date": 1468405182, "answer_id": 38348904, "question_id": 31305651, "link": "https://stackoverflow.com/questions/31305651/cant-debug-using-queueclient-onmessage-on-a-console-app/38348904#38348904", "title": "Cant debug Using QueueClient.OnMessage on a console app", "body": "<p>Wow... I have had this problem too. </p>\n\n<p>Hours of trying to debug this (because it just does nothing apearantly) and found a potential issue with Newtonsoft.JSON in combination with an Azure Worker Role.</p>\n\n<p>Newtonsoft Package was installed fine. In my testing env. everything works too. As soon as I run the worker, it just sat there without emptying the queue.</p>\n\n<p>So... before deployment to Azure, reinstall the Nuget package again (or use downgrade/update) if you experience this. You can also quickly debug this problem locally if you comment out SerializeObject or DeserializeObject calls. Or move the call outside of the Client.OnMessage statement, then you will see the error.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3607792, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002068095802/picture?type=large", "display_name": "Alex", "link": "https://stackoverflow.com/users/3607792/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1474843475, "creation_date": 1474843475, "answer_id": 39692524, "question_id": 31305651, "link": "https://stackoverflow.com/questions/31305651/cant-debug-using-queueclient-onmessage-on-a-console-app/39692524#39692524", "title": "Cant debug Using QueueClient.OnMessage on a console app", "body": "<p>Exctracting the message handling logic from Client.OnMessage() function into a separate method finally threw an exception (otherwise it failed silently).\nAnd the problem in my case was that different versions of Newtonsoft.Json Nuget package were installed in the projects of my solution. \nI had to update them all to the latest version (9.0.1) and the problem was fixed.</p>\n"}], "owner": {"reputation": 26702, "user_id": 1014217, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6zW1x.jpg?s=128&g=1", "display_name": "Luis Valencia", "link": "https://stackoverflow.com/users/1014217/luis-valencia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 32380731, "answer_count": 3, "score": 1, "last_activity_date": 1474843475, "creation_date": 1436398473, "last_edit_date": 1436652767, "question_id": 31305651, "link": "https://stackoverflow.com/questions/31305651/cant-debug-using-queueclient-onmessage-on-a-console-app", "title": "Cant debug Using QueueClient.OnMessage on a console app", "body": "<p>I need to be able to debug the following console application to know if the messages are correctly deserialized or not.</p>\n\n<p>However, when I press F5 on visual studio, I can debug this line:</p>\n\n<p>string mensaje = message.GetBody();</p>\n\n<p>but the following line seems is not executed, and the console APP closes and I can't even  see the message I wrote to the console. My best guess its because the nature of async calls with the OnMessage thing. but I am not sure.</p>\n\n<pre><code>class Program\n    {\n        static void Main(string[] args)\n        {\n            try\n            {\n                string connectionString = CloudConfigurationManager.GetSetting(\"Microsoft.ServiceBus.ConnectionString\");\n                Console.WriteLine(\"Press key to continue\");\n                Console.ReadKey();\n                QueueHelper.ReceiveMessageEmpresa(\"Empresa\", connectionString);\n            }\n            catch (Exception ex)\n            {\n                throw ex;\n            }\n        }\n    }\n\npublic static void ReceiveMessageEmpresa(string queuName, string connectionString)\n        {\n            QueueClient Client = QueueClient.CreateFromConnectionString(connectionString, \"Empresa\");\n\n            // Configure the callback options\n            OnMessageOptions options = new OnMessageOptions();\n            options.AutoComplete = false;\n            options.AutoRenewTimeout = TimeSpan.FromMinutes(1);\n\n            // Callback to handle received messages\n            Client.OnMessage((message) =&gt;\n            {\n                try\n                {\n                    string mensaje = message.GetBody&lt;string&gt;();\n                    Empresa empresa = JsonConvert.DeserializeObject&lt;Empresa&gt;(mensaje);\n                    // Process message from queue\n                    //Console.WriteLine(\"Body: \" + );\n                    Console.WriteLine(\"MessageID: \" + message.MessageId);\n                    Console.ReadKey();\n\n                    // Remove message from queue\n                    message.Complete();\n                }\n                catch (Exception ex)\n                {\n                    // Indicates a problem, unlock message in queue\n                    message.Abandon();\n                }\n            }, options);\n        }\n</code></pre>\n\n<p>or how can I rewrite this method to return the object? or what would you suggest?</p>\n"}, {"tags": ["c#", "xml-parsing"], "comments": [{"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "edited": false, "score": 0, "creation_date": 1436398393, "post_id": 31305582, "comment_id": 50600811, "body": "Are you saying that you have a file that contains a mix of XML and non-XML data?"}, {"owner": {"reputation": 498, "user_id": 3768330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1369e06e05dda95195ecb6fab970df8e?s=128&d=identicon&r=PG", "display_name": "sidhartha madipalli", "link": "https://stackoverflow.com/users/3768330/sidhartha-madipalli"}, "reply_to_user": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "edited": false, "score": 0, "creation_date": 1436398805, "post_id": 31305582, "comment_id": 50600923, "body": "@Dweeberly yup and non XML data contains some unsupported characters etc should be excluded"}, {"owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "edited": false, "score": 0, "creation_date": 1436399141, "post_id": 31305582, "comment_id": 50601032, "body": "That is a hard problem unless you can find a way to filter the non-XML data, or you can assure that the non-XML data doesn&#39;t contain anything of the form &lt;tag&gt; &lt;/tag&gt;.  Otherwise, the ambiguities will likely require some sort of manual intervention."}, {"owner": {"reputation": 498, "user_id": 3768330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1369e06e05dda95195ecb6fab970df8e?s=128&d=identicon&r=PG", "display_name": "sidhartha madipalli", "link": "https://stackoverflow.com/users/3768330/sidhartha-madipalli"}, "reply_to_user": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "edited": false, "score": 0, "creation_date": 1436400405, "post_id": 31305582, "comment_id": 50601380, "body": "Non XML data does not contain any &lt;tag&gt;&lt;/tag&gt; forms. will it help to parse or strip the XML data out!!"}], "answers": [{"tags": [], "owner": {"reputation": 4286, "user_id": 1440105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QxCty.jpg?s=128&g=1", "display_name": "Dweeberly", "link": "https://stackoverflow.com/users/1440105/dweeberly"}, "is_accepted": true, "score": 1, "last_activity_date": 1436407811, "creation_date": 1436407811, "answer_id": 31306950, "question_id": 31305582, "link": "https://stackoverflow.com/questions/31305582/how-do-i-strip-valid-xml-from-file-that-contains-excess-data-and-junk/31306950#31306950", "title": "How do I strip valid XML from file that contains excess data and junk", "body": "<p>As I said in the comments this is a hard problem, especially without any knowledge of your data.  There could be a lot of edge cases.</p>\n\n<p>The code below may work for what you want.  It attempts to find elements ('&lt;element ...' or '&lt;element/&gt;', then determine the XML content by finding the end tag.  It checks this by trying to parse the XML and if that false it rejects the XML.</p>\n\n<p>This code was written for clarity, not performance or good structure (it's all mainline fall-thru).  This should give you an example you can use as a good starting point for the type of parsing you described.</p>\n\n<pre><code>using System;\nusing System.Linq;\nusing System.Text;\nusing System.Xml.Linq;\n\nnamespace messyXml {\nclass Program {\n\n    const String almostXml = @\"\n@#$%random junk\n&lt;Fruits&gt;\n  &lt;Apples&gt;\n    Pies\n  &lt;/Apples&gt;\n  &lt;Pears&gt;\n    Tarts\n  &lt;/Pears&gt;\n&lt;/Fruits&gt;\nThis is some junk about Fruits like Apples and Pears \nwhich can be made into Pies and Tarts.  I think that\nPears&lt;Apples.  Edge case might be &lt;Parts or /Apples&gt;\n&lt;Parts No='123'&gt;\n  Pie Plate\n&lt;/Parts&gt;\";\n\n    static void Main(string[] args) {\n        Console.WriteLine(\"Extracting XML from:\");\n        Console.WriteLine(almostXml);\n        Console.WriteLine();\n        int i = 0;\n        var validXml = new StringBuilder();\n        while (i &lt; almostXml.Length) {\n            if (almostXml[i] == '&lt;') { // might be an xml start\n                int ix = almostXml.IndexOfAny(\" &gt;\\t\".ToArray(), i + 1); \n                // this only check for space, &gt; and tab, you may want to\n                // include other whitespace chars\n\n                if (ix &lt; 0) {\n                    ix = almostXml.IndexOf(\"/&gt;\", i + 1); // you might have &lt;element/&gt;\n                    if (ix &gt;= 0) {\n                        // you could check if element name is valid\n                        var xml = almostXml.Substring(i, (ix + 2) - i);\n                        try {\n                            // see if this is really xml\n                            var doc = XDocument.Parse(xml);\n                            validXml.AppendLine(xml);\n                            i = ix + 2;\n                            continue; // next iteration of while i \n                            }\n                        catch (System.Xml.XmlException) {\n                            // do nothing\n                            }\n                        }\n                    ix = almostXml.IndexOf(\"&gt;\", i + 1); // you might have &lt;element/&gt;\n                    }\n                else { // we found something like &lt;element ...\n                    var ix2 = almostXml.IndexOf('&gt;', ix); // where is the '&gt;'\n                    if (ix2 &gt;= 0) {\n                        // build an end tag\n                        var endtag = \"&lt;/\" + almostXml.Substring(i + 1, (ix - i) - 1) + \"&gt;\";\n                        var endix = almostXml.IndexOf(endtag, ix2);\n                        if (endix &gt;= 0) {\n                            var xml = almostXml.Substring(i, (endix + endtag.Length) - i);\n                            try {\n                                // see if this is really xml\n                                var doc = XDocument.Parse(xml);\n                                validXml.AppendLine(xml);\n                                i = (endix + endtag.Length);\n                                continue; // next iteration of while i\n                                }\n                            catch (System.Xml.XmlException) {\n                                // do nothing\n                                }\n                            }\n                        }\n                    }\n                }\n            i++;\n            }\n        Console.WriteLine(\"-----------\");\n        Console.WriteLine(\"Valid XML found:\");\n        Console.WriteLine(validXml.ToString());\n        Console.ReadKey();\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 498, "user_id": 3768330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1369e06e05dda95195ecb6fab970df8e?s=128&d=identicon&r=PG", "display_name": "sidhartha madipalli", "link": "https://stackoverflow.com/users/3768330/sidhartha-madipalli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1436425052, "accepted_answer_id": 31306950, "answer_count": 1, "score": 1, "last_activity_date": 1436424881, "creation_date": 1436398137, "last_edit_date": 1436424881, "question_id": 31305582, "link": "https://stackoverflow.com/questions/31305582/how-do-i-strip-valid-xml-from-file-that-contains-excess-data-and-junk", "closed_reason": "Needs details or clarity", "title": "How do I strip valid XML from file that contains excess data and junk", "body": "<p>I have tried parsing with regex but not all XML files are being parsed!!</p>\n\n<p>Tag names are not predefined which means, solution should identify the start and end of XML tag it self </p>\n\n<p>Sample data goes like this: </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&lt;XML data&gt; \nRandom text \n&lt;XML data&gt; \nRandom text \n</code></pre>\n"}, {"tags": ["c#", "azure-web-app-service", "azure-servicebus-queues"], "answers": [{"comments": [{"owner": {"reputation": 3528, "user_id": 610561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QeHxV.jpg?s=128&g=1", "display_name": "VulgarBinary", "link": "https://stackoverflow.com/users/610561/vulgarbinary"}, "edited": false, "score": 0, "creation_date": 1436468505, "post_id": 31311954, "comment_id": 50638420, "body": "How can you tell if the OnMessage is no longer attached?  There is no OnClose for it?"}, {"owner": {"reputation": 3528, "user_id": 610561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QeHxV.jpg?s=128&g=1", "display_name": "VulgarBinary", "link": "https://stackoverflow.com/users/610561/vulgarbinary"}, "edited": false, "score": 0, "creation_date": 1436544248, "post_id": 31311954, "comment_id": 50674491, "body": "This still doesn&#39;t answer whether or not OnMessage itself is blocking.  I imagine it is not... or pseudo is not, which leads to an interesting question of how to know if it fails, disconnects, or hangs?"}], "tags": [], "owner": {"reputation": 2048, "user_id": 50911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhtCa.jpg?s=128&g=1", "display_name": "Dominic Betts", "link": "https://stackoverflow.com/users/50911/dominic-betts"}, "is_accepted": false, "score": 0, "last_activity_date": 1436430094, "creation_date": 1436430094, "answer_id": 31311954, "question_id": 31305524, "link": "https://stackoverflow.com/questions/31305524/azure-servicebus-onmessage-blocking-call-or-not/31311954#31311954", "title": "Azure ServiceBus OnMessage Blocking Call or Not?", "body": "<p>Your first approach is correct, and the value of <strong>MaxThreadsPerQueue</strong> determines how many threads are available to handle your messages. It sounds as if these threads are being used up (maybe the processing of your messages by the callback is taking some time?).</p>\n\n<p>You should instead consider using the <a href=\"https://msdn.microsoft.com/en-us/library/azure/microsoft.servicebus.messaging.queueclient.onmessageasync.aspx\" rel=\"nofollow\">QueueClient.OnMessageAsync Method</a> to receive your messages.</p>\n"}, {"tags": [], "owner": {"reputation": 3528, "user_id": 610561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QeHxV.jpg?s=128&g=1", "display_name": "VulgarBinary", "link": "https://stackoverflow.com/users/610561/vulgarbinary"}, "is_accepted": true, "score": 1, "last_activity_date": 1437080689, "last_edit_date": 1495542220, "creation_date": 1437080689, "answer_id": 31464496, "question_id": 31305524, "link": "https://stackoverflow.com/questions/31305524/azure-servicebus-onmessage-blocking-call-or-not/31464496#31464496", "title": "Azure ServiceBus OnMessage Blocking Call or Not?", "body": "<p>OnMessage and OnMessageAsync are NOT blocking calls.  These need instantiated a single time and will continue subscribing to the queue until the application is terminated.</p>\n\n<p>See related post for further details:  <a href=\"https://stackoverflow.com/questions/31344899/azure-service-bus-determine-if-onmessage-stops-processing/31464449#31464449\">Azure Service Bus, determine if OnMessage stops processing</a></p>\n"}], "owner": {"reputation": 3528, "user_id": 610561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QeHxV.jpg?s=128&g=1", "display_name": "VulgarBinary", "link": "https://stackoverflow.com/users/610561/vulgarbinary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 0, "accepted_answer_id": 31464496, "answer_count": 2, "score": 3, "last_activity_date": 1437080689, "creation_date": 1436397690, "last_edit_date": 1436540655, "question_id": 31305524, "link": "https://stackoverflow.com/questions/31305524/azure-servicebus-onmessage-blocking-call-or-not", "title": "Azure ServiceBus OnMessage Blocking Call or Not?", "body": "<p>We are utilizing Azure ServiceBus queues to process high volumes of client requests.  However, the <code>OnMessage</code> call seems to be a blocking call, however the blocking on this call is incredibly inconsistent if it is indeed a blocking call.</p>\n\n<p>What I am attempting to accomplish is watch a queue on a permanent basis from a web service application (to allow metrics to be mined from the running application)</p>\n\n<p>I am creating the subscription below:</p>\n\n<pre><code>protected virtual void Subscribe(string queueName, Func&lt;QueueRequest, bool&gt; callback)\n{\n    var client = GetClient(queueName, PollingTimeout);\n    var transformCallback = new Action&lt;BrokeredMessage&gt;((message) =&gt;\n    {\n        try\n        {\n            var request = message.ToQueueRequest();\n            if (callback(request))\n            {\n                message.Complete();\n            }\n            else\n            {\n                message.Abandon();\n            }\n        }\n        catch (Exception ex)\n        {\n            //TODO: Log the error\n            message.Abandon();\n        }\n    });\n    var options = new OnMessageOptions\n    {\n        MaxConcurrentCalls = _config.GetInt(\"MaxThreadsPerQueue\"),\n        AutoComplete = false\n    };\n    options.ExceptionReceived += OnMessageError;\n    client.OnMessage(transformCallback, options);\n}\n</code></pre>\n\n<p>If I only have the subscription called once, the application stops watching the queue and thus stops processing the messages.  However, if I place a while loop around my subscribe call.  So with great hesitation I wrote the below snippet to resubscribe if this <code>OnMessage</code> completed.</p>\n\n<pre><code>protected void MonitorQueue()\n{\n    IsRunning = true;\n    while (IsRunning)\n    {\n        try\n        {\n            Log.Info(\"MonitoringThread: OnMessage beginning logging for {0}\", QueueName);\n            QueueClient.Subscribe(QueueName, Processor);\n            Log.Info(\"MonitoringThread:  OnMessage ended logging for {0}\", QueueName);\n        }\n        catch (Exception ex)\n        {\n            IsRunning = false;\n            Log.Error(\"MonitoringThread: Error in subscription for {0}: \", ex, QueueName);\n        }\n\n        if (SleepBeforeReinit &gt; 0 &amp;&amp; IsRunning)\n        {\n            Thread.Sleep(SleepBeforeReinit);\n        }\n    }\n}\n</code></pre>\n\n<p>This fixed the problem of messages expiring to the dead letter due to not being picked up, however this caused other problems.</p>\n\n<p>With OnMessage being a billable operation I am concerned when I see the log file telling me that a queue is beginning and ending less than a second apart and the size of my log file increases <em>very</em> rapidly.</p>\n\n<p>I have my <code>MessagingFactory</code> set to have an <code>OperationTimeout</code> of 1 day, yet this does not seem to impact the frequency of the subscriptions open / close status as I would expect.</p>\n\n<p>I have seen plenty of samples doing this as a worker role, however this will not accomplish what we are trying to do.  I am currently wiring this from the Global.asax.cs of our web application.  Any advice is greatly appreciated!</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1436397688, "post_id": 31305505, "comment_id": 50600614, "body": "Is this just a c# question?  You&#39;ve tagged 4 different languages."}, {"owner": {"reputation": 1232, "user_id": 4847772, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fd5efa4bdec75631678b36842fea7c5a?s=128&d=identicon&r=PG&f=1", "display_name": "PJTraill", "link": "https://stackoverflow.com/users/4847772/pjtraill"}, "edited": false, "score": 1, "creation_date": 1436397950, "post_id": 31305505, "comment_id": 50600672, "body": "Have you tried anything at all? Please show your efforts, along with their results."}, {"owner": {"reputation": 13, "user_id": 5096147, "user_type": "registered", "profile_image": "https://graph.facebook.com/1468684996775340/picture?type=large", "display_name": "Ahmed Abdelhakem", "link": "https://stackoverflow.com/users/5096147/ahmed-abdelhakem"}, "edited": false, "score": 0, "creation_date": 1436398383, "post_id": 31305505, "comment_id": 50600808, "body": "sorry iam beginner in c#  i just started to learn it yesterday   i tried to do lots of things but failed to achieve my goal and i searched  about it but i cant find what i want so i asked here ....                          this is one  of my My attempts so u can tell me why it is wrong                                                 MessageBox.Show((numbers[0] \\nnumbers[1] \\nnumbers[2] \\nnumbers[3]) .ToString());"}], "answers": [{"comments": [{"owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "reply_to_user": {"reputation": 13, "user_id": 5096147, "user_type": "registered", "profile_image": "https://graph.facebook.com/1468684996775340/picture?type=large", "display_name": "Ahmed Abdelhakem", "link": "https://stackoverflow.com/users/5096147/ahmed-abdelhakem"}, "edited": false, "score": 0, "creation_date": 1436399697, "post_id": 31305531, "comment_id": 50601192, "body": "@AhmedAbdelhakem You can mark this as the answer by clicking the check mark next to this post."}], "tags": [], "owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "is_accepted": true, "score": 3, "last_activity_date": 1436397751, "creation_date": 1436397751, "answer_id": 31305531, "question_id": 31305505, "link": "https://stackoverflow.com/questions/31305505/messagebox-to-show-many-variables-in-a-list/31305531#31305531", "title": "messagebox to show many variables in a list", "body": "<p>Use <a href=\"https://msdn.microsoft.com/en-us/library/57a79xd0%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\"><code>string.Join</code></a> to insert a newline between each number.</p>\n\n<pre><code>MessageBox.Show(string.Join(Environment.NewLine, numbers));\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/FJwbE.png\" alt=\"http://i.imgur.com/vehpU35.png\"></p>\n\n<p>The resulting string displayed is: <code>\"2\\r\\n4\\r\\n6\\r\\n8\"</code></p>\n"}], "owner": {"reputation": 13, "user_id": 5096147, "user_type": "registered", "profile_image": "https://graph.facebook.com/1468684996775340/picture?type=large", "display_name": "Ahmed Abdelhakem", "link": "https://stackoverflow.com/users/5096147/ahmed-abdelhakem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1436414626, "accepted_answer_id": 31305531, "answer_count": 1, "score": -1, "last_activity_date": 1436397767, "creation_date": 1436397590, "last_edit_date": 1436397767, "question_id": 31305505, "link": "https://stackoverflow.com/questions/31305505/messagebox-to-show-many-variables-in-a-list", "closed_reason": "Needs details or clarity", "title": "messagebox to show many variables in a list", "body": "<p>How to show all the list (how to use the messagebox to show the numbers under each other )</p>\n\n<pre><code> List&lt;int&gt; numbers =new List&lt;int&gt;();\n                numbers.Add(2);\n                numbers.Add(4);\n                numbers.Add(6);\n                numbers.Add(8);\n</code></pre>\n"}, {"tags": ["javascript", "c#", "asp.net", "datatables", "string-formatting"], "comments": [{"owner": {"reputation": 1594, "user_id": 3939772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ef76f6b4fceacac70453ad4854fc4eb?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Fitzpatrick", "link": "https://stackoverflow.com/users/3939772/mark-fitzpatrick"}, "edited": false, "score": 1, "creation_date": 1436399029, "post_id": 31305504, "comment_id": 50600997, "body": "Then try to turn the string into a number. C# doesn&#39;t have any special rules for sorting with numbers in a string, it just sorts it based on alpha-numeric characters. The only way you can get accurate sorting is if you store it as a number truly within the datatable then sort on it and display the string value after sort."}, {"owner": {"reputation": 12758, "user_id": 881798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9t68n.jpg?s=128&g=1", "display_name": "vendettamit", "link": "https://stackoverflow.com/users/881798/vendettamit"}, "edited": false, "score": 0, "creation_date": 1436404197, "post_id": 31305504, "comment_id": 50602313, "body": "Is it JQuery Datatable?"}, {"owner": {"reputation": 197, "user_id": 2643293, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/192cg.jpg?s=128&g=1", "display_name": "aas", "link": "https://stackoverflow.com/users/2643293/aas"}, "edited": false, "score": 0, "creation_date": 1436715191, "post_id": 31305504, "comment_id": 50718223, "body": "yes is it is JQuery Datatable"}], "answers": [{"comments": [{"owner": {"reputation": 50625, "user_id": 3549014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290cbac6da9b4ef5ac976e5d50ab637e?s=128&d=identicon&r=PG", "display_name": "Gyrocode.com", "link": "https://stackoverflow.com/users/3549014/gyrocode-com"}, "reply_to_user": {"reputation": 1282, "user_id": 1052495, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/24f800d9750220e912c876f011d22ca6?s=128&d=identicon&r=PG", "display_name": "Juan", "link": "https://stackoverflow.com/users/1052495/juan"}, "edited": false, "score": 0, "creation_date": 1436809319, "post_id": 31388891, "comment_id": 50756589, "body": "@Juan, there is a confusion I believe. The question is about jQuery DataTables plug-in as OP noted in the comments, not .NET class <code>DataTable</code>. Although the formatting problem could be solved on the server-side as well with C#, there are downsides since the number would still need to be formatted on the client-side."}], "tags": [], "owner": {"reputation": 50625, "user_id": 3549014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290cbac6da9b4ef5ac976e5d50ab637e?s=128&d=identicon&r=PG", "display_name": "Gyrocode.com", "link": "https://stackoverflow.com/users/3549014/gyrocode-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1436805688, "creation_date": 1436805688, "answer_id": 31388891, "question_id": 31305504, "link": "https://stackoverflow.com/questions/31305504/how-to-sort-a-number-with-thousands-separator/31388891#31388891", "title": "How to sort a number with thousands separator", "body": "<p><strong>For DataTables 1.10</strong></p>\n\n<p>DataTables 1.10+ has formatted number detection and sorting abilities built- in, there is no extra coding needed.</p>\n\n<p>Alternatively you can set <a href=\"http://datatables.net/reference/option/columns.type\" rel=\"nofollow\">columns.type</a> to <code>num-fmt</code> to force specific data type.</p>\n\n<p>See the example below for demonstration.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>$(document).ready(function() {\r\n  $('#example').dataTable();\r\n\r\n});\r\n\r\n\r\n\r\n    \r\n\r\n    \r\n\r\n    </code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n\r\n&lt;head&gt;\r\n&lt;meta charset=\"ISO-8859-1\"&gt;\r\n\r\n&lt;link href=\"//cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css\" rel=\"stylesheet\" /&gt;\r\n&lt;link href=\"https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css\" rel=\"stylesheet\" /&gt;\r\n&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n&lt;script src=\"//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js\"&gt;&lt;/script&gt;\r\n\r\n  &lt;/head&gt;\r\n&lt;body&gt;\r\n&lt;table id=\"example\" class=\"display\" cellspacing=\"0\" width=\"100%\"&gt;\r\n\r\n  &lt;thead&gt;\r\n    &lt;tr&gt;\r\n      &lt;th&gt;Name&lt;/th&gt;\r\n      &lt;th&gt;Position&lt;/th&gt;\r\n      &lt;th&gt;Office&lt;/th&gt;\r\n      &lt;th&gt;Age&lt;/th&gt;\r\n      &lt;th&gt;Start date&lt;/th&gt;\r\n      &lt;th&gt;Salary&lt;/th&gt;\r\n    &lt;/tr&gt;\r\n  &lt;/thead&gt;\r\n\r\n  &lt;tfoot&gt;\r\n    &lt;tr&gt;\r\n      &lt;th&gt;Name&lt;/th&gt;\r\n      &lt;th&gt;Position&lt;/th&gt;\r\n      &lt;th&gt;Office&lt;/th&gt;\r\n      &lt;th&gt;Age&lt;/th&gt;\r\n      &lt;th&gt;Start date&lt;/th&gt;\r\n      &lt;th&gt;Salary&lt;/th&gt;\r\n    &lt;/tr&gt;\r\n  &lt;/tfoot&gt;\r\n\r\n  &lt;tbody&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;Tiger Nixon&lt;/td&gt;\r\n      &lt;td&gt;System Architect&lt;/td&gt;\r\n      &lt;td&gt;Edinburgh&lt;/td&gt;\r\n      &lt;td&gt;61&lt;/td&gt;\r\n      &lt;td&gt;2011/04/25&lt;/td&gt;\r\n      &lt;td&gt;111,111.11&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;Garrett Winters&lt;/td&gt;\r\n      &lt;td&gt;Accountant&lt;/td&gt;\r\n      &lt;td&gt;Tokyo&lt;/td&gt;\r\n      &lt;td&gt;63&lt;/td&gt;\r\n      &lt;td&gt;2011/07/25&lt;/td&gt;\r\n      &lt;td&gt;222,191.00&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n      &lt;td&gt;Ashton Cox&lt;/td&gt;\r\n      &lt;td&gt;Junior Technical Author&lt;/td&gt;\r\n      &lt;td&gt;San Francisco&lt;/td&gt;\r\n      &lt;td&gt;66&lt;/td&gt;\r\n      &lt;td&gt;2009/01/12&lt;/td&gt;\r\n      &lt;td&gt;32,222.00&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n  &lt;/tbody&gt;\r\n&lt;/table&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><strong>For DataTables 1.9</strong></p>\n\n<p>For older DataTables 1.9 you can use <a href=\"http://datatables.net/plug-ins/sorting/formatted-numbers\" rel=\"nofollow\">Formatted numbers</a> sorting plug-in.</p>\n\n<p>You just need to include this JS file: <a href=\"//cdn.datatables.net/plug-ins/1.10.7/sorting/formatted-numbers.js\" rel=\"nofollow\">//cdn.datatables.net/plug-ins/1.10.7/sorting/formatted-numbers.js</a> and use the code below to set data type to formatted number.</p>\n\n<pre><code>$('#example').dataTable({\n   columnDefs: [\n     { type: 'formatted-num', targets: 0 }\n   ]\n});\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 2643293, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/192cg.jpg?s=128&g=1", "display_name": "aas", "link": "https://stackoverflow.com/users/2643293/aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1436883258, "creation_date": 1436883258, "answer_id": 31409221, "question_id": 31305504, "link": "https://stackoverflow.com/questions/31305504/how-to-sort-a-number-with-thousands-separator/31409221#31409221", "title": "How to sort a number with thousands separator", "body": "<p>I have done like this to overcome to this issue.</p>\n\n<pre><code>\"aoColumnDefs\": [ {\n                    \"aTargets\": [3,4,6],\n                    \"fnCreatedCell\": function (nTd, sData, oData, iRow, iCol) {\n                        var $currencyCell = $(nTd);\n                        var commaValue = $currencyCell.text().replace(/(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, \"$1,\");\n                        $currencyCell.text(commaValue);\n                    }\n                }]\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 2643293, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/192cg.jpg?s=128&g=1", "display_name": "aas", "link": "https://stackoverflow.com/users/2643293/aas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1914, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1436883258, "creation_date": 1436397585, "last_edit_date": 1592644375, "question_id": 31305504, "link": "https://stackoverflow.com/questions/31305504/how-to-sort-a-number-with-thousands-separator", "title": "How to sort a number with thousands separator", "body": "<p>I have tried to sort the number with <a href=\"http://datatables.net/\" rel=\"nofollow noreferrer\">jQuery Datatables plug-in</a> but is not working with C# string number formats.</p>\n<p>I have tried:</p>\n<pre><code>decimal value= 12345678.00\nvalue..ToString(&quot;#,##.00&quot;);\nvalue.ToString(&quot;##,##.##&quot;);\nvalue.ToString(&quot;0,0.00&quot;, CultureInfo.InvariantCulture)\n</code></pre>\n<p>but no luck because of the comma. If there is no comma is works fine or all the numbers with same count also working i.e.</p>\n<blockquote>\n<p>01,121,372.01</p>\n<p>02,002,009.22</p>\n<p>11,222,222,33</p>\n</blockquote>\n<p>If it is as below then it is not working</p>\n<blockquote>\n<p>1,111,111.11</p>\n<p>222,191.00</p>\n<p>32,222.00</p>\n</blockquote>\n"}, {"tags": ["c#", "messagepack"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 2753743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a9417f40925d636890a11a1c6fa557?s=128&d=identicon&r=PG&f=1", "display_name": "user2753743", "link": "https://stackoverflow.com/users/2753743/user2753743"}, "is_accepted": false, "score": 2, "last_activity_date": 1436476424, "creation_date": 1436476424, "answer_id": 31328333, "question_id": 31305482, "link": "https://stackoverflow.com/questions/31305482/system-typeloadexception-access-is-denied-when-using-messagepack/31328333#31328333", "title": "System.TypeLoadException: Access is denied when using MessagePack", "body": "<p>Figured it out! My Script class wasn't declared public which is why the serializer couldn't find it</p>\n"}], "owner": {"reputation": 41, "user_id": 2753743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a9417f40925d636890a11a1c6fa557?s=128&d=identicon&r=PG&f=1", "display_name": "user2753743", "link": "https://stackoverflow.com/users/2753743/user2753743"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1989, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436476424, "creation_date": 1436397467, "last_edit_date": 1436397806, "question_id": 31305482, "link": "https://stackoverflow.com/questions/31305482/system-typeloadexception-access-is-denied-when-using-messagepack", "title": "System.TypeLoadException: Access is denied when using MessagePack", "body": "<p>I'm trying to use MessagePack to serialize my objects, but whenever I try to run the serialization I'm getting an Unhandled Exception error.</p>\n\n<p>Here's my code:</p>\n\n<p>CSCDP_TCPClient.cs</p>\n\n<pre><code>using System.Text;\nusing System.Threading.Tasks;\nusing System.Net.Sockets;\nusing System.Diagnostics;\nusing System.IO;\nusing MsgPack;\nusing MsgPack.Serialization;\n\nnamespace CSCDPApp\n{\n    class CSCDP_TCPClient\n    {\n        public void Connect(string server, int portno, Script Script)  \n        {\n\n            var serializer = MessagePackSerializer.Get&lt;Script&gt;();\n            var tempstream = new MemoryStream();\n            serializer.Pack(tempstream, script);\n\n            tempstream.Position = 0;\n\n            var deserializedObject = serializer.Unpack(tempstream);\n            Debug.WriteLine(\"Same object? {0}\", Object.ReferenceEquals(script, deserializedObject));\n        }\n    }\n}\n</code></pre>\n\n<p>Script.cs:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace CSCDPApp\n{\n    class Script\n    {\n        public string cardID;\n        public string time;\n        public string device;\n        public string command;\n\n        public Script()\n        {\n            //Parameterless Constructor for serialization\n        }\n\n        public Script(string cardID, string time, string device, string command)\n        {\n            this.cardID = cardID;\n            this.time = time;\n            this.device = device;\n            this.command = command;\n        } \n    }\n}\n</code></pre>\n\n<p>And I'm just calling it in main with:</p>\n\n<pre><code>        CSCDP_TCPClient tcpclient = new CSCDP_TCPClient();\n        Script tempscript = new Script(\"test1\",\"test2\",\"test3\",\"test4\");\n        tcpclient.Connect(\"0.0.0.0\",1,tempscript);\n</code></pre>\n\n<p>And here's the error I'm getting:</p>\n\n<pre><code>Unhandled Exception: System.TypeLoadException: Access is denied: 'MsgPack.Serial\nization.MessagePackSerializer`1[CSCDPApp.Script]'.\n   at System.Reflection.Emit.TypeBuilder.TermCreateClass(RuntimeModule module, I\nnt32 tk, ObjectHandleOnStack type)\n   at System.Reflection.Emit.TypeBuilder.CreateTypeNoLock()\n   at System.Reflection.Emit.TypeBuilder.CreateType()\n   at MsgPack.Serialization.EmittingSerializers.FieldBasedSerializerEmitter.Crea\nteConstructor[T]()\n   at MsgPack.Serialization.EmittingSerializers.SerializerEmitter.CreateInstance\n[T](SerializationContext context)\n   at MsgPack.Serialization.EmittingSerializers.ILEmittingSerializerBuilder`2.&lt;&gt;\nc__DisplayClass5a.&lt;CreateSerializerConstructor&gt;b__59(SerializationContext contex\nt)\n   at MsgPack.Serialization.AbstractSerializers.SerializerBuilder`3.BuildSeriali\nzerInstance(SerializationContext context)\n   at MsgPack.Serialization.AutoMessagePackSerializer`1..ctor(SerializationConte\nxt context, ISerializerBuilder`1 builder)\n   at MsgPack.Serialization.MessagePackSerializer.CreateInternal[T](Serializatio\nnContext context)\n   at MsgPack.Serialization.SerializationContext.GetSerializer[T](Object provide\nrParameter)\n   at MsgPack.Serialization.MessagePackSerializer.Get[T](SerializationContext co\nntext, Object providerParameter)\n   at CSCDPApp.CSCDP_TCPClient.Connect(String server, Int32 portno, Script scrip\nt) in d:\\TFS\\MSVC 2013_CTSDev1\\CommonComponents\\sdnet\\tools\\CSCDPService\\CSCDPAp\np\\CSCDP_TCPClient.cs:line 21\n   at CSCDPApp.Program.Main(String[] args) in d:\\TFS\\MSVC 2013_CTSDev1\\CommonCom\nponents\\sdnet\\tools\\CSCDPService\\CSCDPApp\\Program.cs:line 64\n</code></pre>\n\n<p>I have my visual studio project in my D: drive, and I've checked that permissions are correct. I have the MessagePack.dll in the same directory as all my compiled executeables and have the reference linked. Is there anything I might possibly be missing?</p>\n"}, {"tags": ["c#", "android", "xamarin", "xamarin.android"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3716688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06230bf2942d9c891f370026b5ff0f21?s=128&d=identicon&r=PG&f=1", "display_name": "skchandra", "link": "https://stackoverflow.com/users/3716688/skchandra"}, "edited": false, "score": 0, "creation_date": 1436398168, "post_id": 31305526, "comment_id": 50600733, "body": "I just tried it out, and though it compiled when I clicked on the item I got the error:  &#39;[MonoDroid] System.ArgumentException: type [MonoDroid] Parameter name: Type is not derived from a java type.&#39; Is this a feature that is only available in Java?"}, {"owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "reply_to_user": {"reputation": 3, "user_id": 3716688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06230bf2942d9c891f370026b5ff0f21?s=128&d=identicon&r=PG&f=1", "display_name": "skchandra", "link": "https://stackoverflow.com/users/3716688/skchandra"}, "edited": false, "score": 0, "creation_date": 1436398437, "post_id": 31305526, "comment_id": 50600826, "body": "Okay, what about get fullpath for type via reflection from existing Activity and then put it in &quot;part of full path&quot;?"}, {"owner": {"reputation": 3, "user_id": 3716688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06230bf2942d9c891f370026b5ff0f21?s=128&d=identicon&r=PG&f=1", "display_name": "skchandra", "link": "https://stackoverflow.com/users/3716688/skchandra"}, "edited": false, "score": 1, "creation_date": 1436399336, "post_id": 31305526, "comment_id": 50601081, "body": "It worked, I just had to change the path name (I had an extra &#39;Activity&#39; in there). Thank you!"}], "tags": [], "owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "is_accepted": true, "score": 1, "last_activity_date": 1437746013, "last_edit_date": 1495540242, "creation_date": 1436397700, "answer_id": 31305526, "question_id": 31305447, "link": "https://stackoverflow.com/questions/31305447/convert-string-to-activity-name-c/31305526#31305526", "title": "Convert string to activity name C#", "body": "<p>You need attach full path for your Activities.</p>\n\n<pre><code>var actType = Type.GetType(\"part of full path\" + items[position] + \"Activity\")\n</code></pre>\n\n<p>I haven't tested it, but it should work :)</p>\n\n<pre><code>protected override void OnListItemClick(ListView l, View v, int position, long id)\n{\n    var actType = Type.GetType(\"part of full path\" + items[position] + \"Activity\")\n    var intentPlace = new Intent(this, actType);\n    StartActivity(intentPlace);\n}\n</code></pre>\n\n<p>Also usefull <a href=\"https://stackoverflow.com/a/7286354/2313116\">if the assembly with activity has been loaded in the current domain</a></p>\n"}], "owner": {"reputation": 3, "user_id": 3716688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06230bf2942d9c891f370026b5ff0f21?s=128&d=identicon&r=PG&f=1", "display_name": "skchandra", "link": "https://stackoverflow.com/users/3716688/skchandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1943, "favorite_count": 0, "accepted_answer_id": 31305526, "answer_count": 1, "score": 0, "last_activity_date": 1437746013, "creation_date": 1436397209, "question_id": 31305447, "link": "https://stackoverflow.com/questions/31305447/convert-string-to-activity-name-c", "title": "Convert string to activity name C#", "body": "<p>I am using a ListView in Xamarin Android to display a list of restaurants, and when one is clicked on I would like to navigate to a new activity. The activity for each is named using this convention: [restaurantName]Activity. \nI'm trying to use intents:</p>\n\n<pre><code>    protected override void OnListItemClick(ListView l, View v, int position, long id)\n    {\n        string t = items[position] + \"Activity\";\n        var intentPlace = new Intent(this, typeof(???));\n        StartActivity(intentPlace);\n    }\n</code></pre>\n\n<p>String t gives the correct format, but is the wrong type to put inside the typeof(). However, I have no idea what to put in place of the '???', as I wasn't able to use setTitle  in order to create the activity name. \nWould anyone be able to point me in the right direction? </p>\n"}, {"tags": ["c#", "jquery", "html", "asp.net", "jsajaxfileuploader"], "answers": [{"tags": [], "owner": {"reputation": 635, "user_id": 862772, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/d0b1C.jpg?s=128&g=1", "display_name": "Prasad Raja", "link": "https://stackoverflow.com/users/862772/prasad-raja"}, "is_accepted": false, "score": 0, "last_activity_date": 1436419892, "last_edit_date": 1436419892, "creation_date": 1436418859, "answer_id": 31308686, "question_id": 31305360, "link": "https://stackoverflow.com/questions/31305360/how-do-you-pass-html-input-files-to-c-asp-net-using-ajaxfileupload-js/31308686#31308686", "title": "How do you pass HTML input files to C# ASP.Net using AjaxFileUpload.js?", "body": "<p>I have attached the source code here..</p>\n\n<p>Js uploadFile\n<a href=\"http://hayageek.com/docs/jquery-upload-file.php\" rel=\"nofollow\">Reference </a></p>\n\n<p>just check it let me know..\n<a href=\"https://onedrive.live.com/redir?resid=9FC54C5F947E1701!1182&amp;authkey=!ANophbgr7vP5ii4&amp;ithint=file%2Crar\" rel=\"nofollow\">File Upload Example</a></p>\n\n<p>Handler.ashx</p>\n\n<pre><code>  &lt;appSettings&gt;\n    &lt;add key=\"FolderPath\" value=\"/Resources/UploadFiles/\" /&gt;\n  &lt;/appSettings&gt;\n\npublic void ProcessRequest(HttpContext context)\n        {\n            context.Response.ContentType = \"text/plain\";\n            context.Response.Expires = -1;\n            try\n            {\n                HttpPostedFile postedFile = context.Request.Files[0];\n                string savepath = \"\";\n                string tempPath = \"\";\n                tempPath = System.Configuration.ConfigurationManager.AppSettings[\"FolderPath\"];\n                savepath = context.Server.MapPath(tempPath);\n                string filename = postedFile.FileName;\n                if (!Directory.Exists(savepath))\n                {\n                    Directory.CreateDirectory(savepath);\n                }\n                postedFile.SaveAs(savepath + @\"\\\" + filename);\n                context.Response.Write(tempPath + \"/\" + filename);\n                context.Response.StatusCode = 200;\n            }\n            catch (Exception ex)\n            {\n                context.Response.Write(\"Error: \" + ex.Message);\n            }\n        }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5092534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oDwyp.jpg?s=128&g=1", "display_name": "Dark Prince Zen", "link": "https://stackoverflow.com/users/5092534/dark-prince-zen"}, "is_accepted": true, "score": 0, "last_activity_date": 1436420913, "creation_date": 1436420913, "answer_id": 31309150, "question_id": 31305360, "link": "https://stackoverflow.com/questions/31305360/how-do-you-pass-html-input-files-to-c-asp-net-using-ajaxfileupload-js/31309150#31309150", "title": "How do you pass HTML input files to C# ASP.Net using AjaxFileUpload.js?", "body": "<p>I had a bit of a light bulb moment before where I realised that I was already hiding <code>fileUploader</code>. All I did was made it static and made sure the selectors used the server control ID so that <code>uploadBtn</code> was able to trigger it.</p>\n\n<p>Also had a look at Prasad Raja's answer thoroughly as well and would recommend anyone starting a new project to consider it. Was very insightful.</p>\n"}], "owner": {"reputation": 1, "user_id": 5092534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oDwyp.jpg?s=128&g=1", "display_name": "Dark Prince Zen", "link": "https://stackoverflow.com/users/5092534/dark-prince-zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1889, "favorite_count": 0, "accepted_answer_id": 31309150, "answer_count": 2, "score": 0, "last_activity_date": 1436420913, "creation_date": 1436396763, "last_edit_date": 1436416128, "question_id": 31305360, "link": "https://stackoverflow.com/questions/31305360/how-do-you-pass-html-input-files-to-c-asp-net-using-ajaxfileupload-js", "title": "How do you pass HTML input files to C# ASP.Net using AjaxFileUpload.js?", "body": "<p>I'm new to stackoverflow so my apologies if I misuse any of the guidelines. I am in the middle of making a ASP.Net website and I have run into a very specific problem where I am using <code>ProcessRequest</code> to try and retrieve multiple files.</p>\n\n<p><strong>C# ASP.Net Code</strong></p>\n\n<p>The variable <code>files</code> is not retreiving requested files <code>context.Request.Files</code></p>\n\n<pre><code>public void ProcessRequest(HttpContext context)\n{\n     try\n     {\n          var files = context.Request.Files;\n\n          for (int i = 0; i &lt; files.Count; i++)\n          {\n               //Checking to see if the files exist\n               var postedFile = files[i];\n          }\n     }\n     catch (Exception e)\n     {\n          context.Response.Write(e.Message);\n     }\n}\n</code></pre>\n\n<p>I am trying to avoid refreshing the web page and types of <code>submit</code> to allow the user to navigate through the content fluently. I believe my problem stems from dynamically adding my input file html elements from the C# backend.</p>\n\n<p><strong>HTML</strong></p>\n\n<pre><code>&lt;div id='fmAddFiles'&gt;\n    &lt;input id='fileUploader' type='file' multiple='true' runat='server'/&gt;\n    &lt;input id='addFilesBtn' type='button' value='Add Files'/&gt;\n&lt;/div&gt;\n&lt;div id='fmSubmit'&gt;&lt;input id='uploadBtn' type='button' value='Upload'/&gt;&lt;/div&gt;\n</code></pre>\n\n<p>I have bound click and trigger events for <code>addFilesBtn</code> and <code>fileUploader</code> and they get hit correctly. It is when I attempt to pass the files to the backend using <code>$.ajaxFileUpload</code> that nothing happens.</p>\n\n<pre><code>$.ajaxFileUpload({\n     url: 'WebHandler.ashx',\n     async: false,\n     secureuri: false,\n     fileElementId: 'fileUploader',\n     dataType: 'json',\n     success: function (data, status) {\n          alert(data);\n     },\n     error: function (data, status, e) {\n          alert(e);\n     }\n});\n</code></pre>\n\n<p>All the mentioned functions get hit just I can't for the life of me can't figure out why it is not retrieving any of the files.</p>\n\n<p>Where might I be going wrong?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I tried adding static elements to my html and found out that the server control does not work when dynamically adding elements. The <code>runat='server'</code> tag no longer works when this is done.</p>\n\n<p>Now I am a crossroads. Is there a way to bind the server control to an element or am I going to have to use a bunch of CSS tricks? Which to me is rather messy at the best of times.</p>\n"}, {"tags": ["javascript", "c#", "http", "ssl", "https"], "comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1436397653, "post_id": 31305234, "comment_id": 50600599, "body": "Side note: I assume you know that regular FORM posts don&#39;t have same origin policy and have some reasons to use ajax. Still may deserve edit to clarify what would/would not work in your case."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 2026360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5811be9fbcd93e578cebb6008c672b6?s=128&d=identicon&r=PG", "display_name": "\uc724\uc9c4\uc218", "link": "https://stackoverflow.com/users/2026360/%ec%9c%a4%ec%a7%84%ec%88%98"}, "is_accepted": false, "score": 0, "last_activity_date": 1436406943, "creation_date": 1436406943, "answer_id": 31306840, "question_id": 31305234, "link": "https://stackoverflow.com/questions/31305234/sending-data-from-an-https-page-to-a-localhost-server/31306840#31306840", "title": "Sending data from an HTTPS page to a localhost server", "body": "<p>Basically, you can't do this. because It is hacking.</p>\n\n<p>but, if you can modifiy client's hosts file, then route localhost to 'yourdomain.com' and generate ssl certificate to 'yourdomain.com'.</p>\n\n<p>or you can make proxy server(<a href=\"https://targetdomain.com\" rel=\"nofollow\">https://targetdomain.com</a> to <a href=\"http://localhost\" rel=\"nofollow\">http://localhost</a>) in localhost server.</p>\n"}, {"tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": false, "score": 0, "last_activity_date": 1436423707, "creation_date": 1436423707, "answer_id": 31309809, "question_id": 31305234, "link": "https://stackoverflow.com/questions/31305234/sending-data-from-an-https-page-to-a-localhost-server/31309809#31309809", "title": "Sending data from an HTTPS page to a localhost server", "body": "<p>There is no way to get a certificate for localhost, since the hostname localhost is not owned by yourself. But you can get a certificate for foo.example.com if you own example.com and it does not matter which IP foo.example.com resolves too. \nThus a common workaround used by Spotify and others is to have a certificate for their own hostname, but with the DNS entry pointing to 127.0.0.1.</p>\n\n<p>But unaware to most this only works if the user does not use a web proxy. When using the proxy the name will only resolved at the proxy so it effectively means that it tries to connect to the localhost from the view of the proxy, i.e. the proxy itself.</p>\n\n<p>In summary: working with resources from localhost will not work fully. From a security perspective your web application has no control what is really running on localhost, so trusting anything from localhost by including it into your page is a bad idea anyway. This is the same as you would include a <code>file://</code> from the users systems into your application.</p>\n"}], "owner": {"reputation": 23, "user_id": 2364064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46265d80a4d8cd5da6a5ad01d931d709?s=128&d=identicon&r=PG", "display_name": "pendo324", "link": "https://stackoverflow.com/users/2364064/pendo324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3469, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436423707, "creation_date": 1436396096, "last_edit_date": 1495542106, "question_id": 31305234, "link": "https://stackoverflow.com/questions/31305234/sending-data-from-an-https-page-to-a-localhost-server", "title": "Sending data from an HTTPS page to a localhost server", "body": "<p>I was wondering what the best way to send data from an HTTPS webpage loaded in a browser to a server running on localhost would be. Currently I have a solution that works with both HTTP and HTTPS pages, but with HTTPS pages the browser will output a <code>Mixed Content</code> warning (as it should). This can be bypassed by changing browser settings, but I'd rather not have users do that. This is my javascript that is loaded in the browser through a bookmark (not really sure if this is the best way to do it, but its browser independent): </p>\n\n<pre><code>    function sendLocalPOST(player, song) {\n    var url = \"http://localhost:13337/\";\n\n    $.ajax({\n        type: \"POST\",\n        crossdomain: true,\n        contentType: \"application/json; charset=utf-8\",\n        url: url,\n        dataType: \"json\",\n        data: { 'player': player, 'song': song },\n        success: function (data) {\n        }\n    });\n}\n</code></pre>\n\n<p>and here are some important snippets from the C# server code:</p>\n\n<pre><code>    public WebAppHandler()\n    {\n        // Other non-important stuff\n        listener = new HttpListener();\n        listener.Prefixes.Add(\"http://localhost:13337/\");\n    }\n\n    public void pollForSongChanges()\n    {\n        try\n        {\n            listener.Start();\n        }\n        catch (HttpListenerException)\n        {\n            return;\n        }\n        while (listener.IsListening)\n        {\n            var context = listener.GetContext();\n            ProcessRequest(context);\n        }\n        listener.Close();\n    }\n\n    public void start()\n    {\n        pr = new Thread(new ThreadStart(pollForSongChanges));\n        pr.Start();\n    }\n</code></pre>\n\n<p>There's another <a href=\"https://stackoverflow.com/questions/11403333/httplistener-with-https-support\">question</a> that I saw on stackoverflow that has a great answer (the accepted one), that requires you to bind an SSL certificate to your application, but does that mean I have to get an actual trusted SSL certificate for a localhost server in order to have it work out-of-the-box on other computers?</p>\n\n<p>Maybe I'm going about this all wrong, just wondering if there is a better way. Thanks for any answers.</p>\n\n<p>@AlexeiLevenkov, do you mean something like this: </p>\n\n<pre><code>    function postToIframe(data) {\n        var url = \"http://localhost:13337/\";\n        var target = \"npiframe\";\n\n        $('body').append('&lt;form action=\"' + url + '\" method=\"post\" target=\"' + target + '\" id=\"postToIframe\"&gt;&lt;/form&gt;');\n        $.each(data, function (n, v) {\n            $('#postToIframe').append('&lt;input type=\"hidden\" name=\"' + n + '\" value=\"' + v + '\" /&gt;');\n        });\n        $('#postToIframe').submit().remove();\n    }\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1436397040, "post_id": 31305203, "comment_id": 50600395, "body": "It is unclear to me why you would need this. Simply configure the full URI."}, {"owner": {"reputation": 289, "user_id": 2702444, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05084ab873590749902a09ad82bb4c16?s=128&d=identicon&r=PG&f=1", "display_name": "Serge111", "link": "https://stackoverflow.com/users/2702444/serge111"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1436397328, "post_id": 31305203, "comment_id": 50600503, "body": "Easier said there&#39;s a ton of other areas in the application doing similar things calling different pages. Changing the global setting would require fixing them all. I agree it would be the better solution, but requires a lot more work and extensive testing which is not my call"}], "owner": {"reputation": 289, "user_id": 2702444, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05084ab873590749902a09ad82bb4c16?s=128&d=identicon&r=PG&f=1", "display_name": "Serge111", "link": "https://stackoverflow.com/users/2702444/serge111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1436396011, "creation_date": 1436395889, "last_edit_date": 1436396011, "question_id": 31305203, "link": "https://stackoverflow.com/questions/31305203/c-url-handling-to-allow-either-separate-sites-or-virtual-directories", "title": "C# URL Handling to allow either separate sites or virtual directories?", "body": "<p>I've got a question more for my own learning experience than anything as I've already found a solution, or two to be more specific.</p>\n\n<p>The issue was that I have a web service I connect to with an application, but the web service can be deployed different ways, IE, IIS Virtual Directories, or Separate Sites. Obviously, these will have an impact on the URL. The URL in this case gets pulled from a configuration file wherever the application is installed, so the application has to be able to handle whatever gets pulled from there.</p>\n\n<p>I wrote a quick chunk in a sample console example. The first method doesn't work in the case of virtual directories which is where the issue arises. The other 2 methods return the correct result, I'm just curious, if there would be a reason why one wouldn't simply replace string over using LastIndexOf, and if maybe there's another solution? </p>\n\n<pre><code>Uri SiteNameUrl = new Uri(\"http://SiteName.test.com/PackageDlService.aspx\");\nConsole.WriteLine(String.Format(\"URL Scenario 1: {0}\",SiteNameUrl));\n\nString path = SiteNameUrl.GetLeftPart(UriPartial.Authority);\nString uriStr = String.Format(@\"{0}/SiteName/Packages/{1}/CurrentPackage.zip\", path, \"1.0\");\nConsole.WriteLine(String.Format(\"URL Method 1 (Broken): {0}\", uriStr));\n\npath = SiteNameUrl.ToString().Replace(\"/PackageDlService.aspx\",\"\");\nuriStr = String.Format(@\"{0}/Packages/{1}/CurrentPackage.zip\", path, \"1.0\");\nConsole.WriteLine(String.Format(\"URL Method 2: {0}\", uriStr));\n\npath = SiteNameUrl.ToString().Substring(0, SiteNameUrl.ToString().LastIndexOfAny(new char[] { '/', '\\\\' }) + 1);\nuriStr = String.Format(@\"{0}Packages/{1}/CurrentPackage.zip\", path, \"1.0\");\nConsole.WriteLine(String.Format(\"URL Method 3: {0}\", uriStr));\n\nConsole.WriteLine(); // add a line break between examples\n\nUri SiteNameUrl1 = new Uri(\"http://www.test.com/SiteName/PackageDlService.aspx\");\nConsole.WriteLine(String.Format(\"URL Scenario 2: {0}\", SiteNameUrl1));\n\nString path1 = SiteNameUrl1.GetLeftPart(UriPartial.Authority);\nString uriStr1 = String.Format(@\"{0}/SiteName/Packages/{1}/CurrentPackage.zip\", path1, \"1.0\");\nConsole.WriteLine(String.Format(\"URL Method 1 (Broken): {0}\", uriStr1));\n\npath1 = SiteNameUrl1.ToString().Replace(\"/PackageDlService.aspx\",\"\");\nuriStr1 = String.Format(@\"{0}/Packages/{1}/CurrentPackage.zip\", path1, \"1.0\");\nConsole.WriteLine(String.Format(\"URL Method 2: {0}\", uriStr1));\n\npath1 = SiteNameUrl1.ToString().Substring(0, SiteNameUrl1.ToString().LastIndexOfAny(new char[] { '/', '\\\\' }) + 1);\nuriStr1 = String.Format(@\"{0}Packages/{1}/CurrentPackage.zip\", path1, \"1.0\");\nConsole.WriteLine(String.Format(\"URL Method 3: {0}\", uriStr1));\n</code></pre>\n"}, {"tags": ["c#", "sql", "linq", "entity-framework"], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 5096078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87323c5362be018db50ef2d8b795999?s=128&d=identicon&r=PG&f=1", "display_name": "Allan Woods", "link": "https://stackoverflow.com/users/5096078/allan-woods"}, "edited": false, "score": 0, "creation_date": 1436396837, "post_id": 31305266, "comment_id": 50600345, "body": "Yes Mahmudul and thank you. I have edited and reposted."}], "tags": [], "owner": {"reputation": 5892, "user_id": 1476941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UX0GO.jpg?s=128&g=1", "display_name": "brainless coder", "link": "https://stackoverflow.com/users/1476941/brainless-coder"}, "is_accepted": false, "score": 0, "last_activity_date": 1436396239, "creation_date": 1436396239, "answer_id": 31305266, "question_id": 31305114, "link": "https://stackoverflow.com/questions/31305114/c-linq-to-sql-multiple-entity-join/31305266#31305266", "title": "C# LINQ to SQL Multiple entity join", "body": "<p>Apart from the fact that you are not doing joins properly, that query where clause does not seems okay. Wasn't it supposed to be something like this ? - </p>\n\n<pre><code>from a in Dbs.SalesBikes.DefaultIfEmpty() where a.DebtorID == y.ID &amp;&amp; finYear.ID == a.FinYearID &amp;&amp; a.BikeBrandID == 1\nfrom b in Dbs.SalesBikes.DefaultIfEmpty() where b.DebtorID == y.ID &amp;&amp; b.FinYearID == finYear.ID &amp;&amp; b.BikeBrandID == 2\nfrom c in Dbs.SalesBikes.DefaultIfEmpty() where c.DebtorID == y.ID &amp;&amp; c.FinYearID == finYear.ID &amp;&amp; c.BikeBrandID == 3\nfrom d in Dbs.SalesBikes.DefaultIfEmpty() where d.DebtorID == y.ID &amp;&amp; d.FinYearID == finYear.ID &amp;&amp; d.BikeBrandID == 4\nfrom e in Dbs.SalesBikes.DefaultIfEmpty() where  e.DebtorID == y.ID &amp;&amp; e.FinYearID == finYear.ID &amp;&amp; e.BikeBrandID == 7\nfrom f in Dbs.SalesBikes.DefaultIfEmpty() where  f.DebtorID == y.ID &amp;&amp; f.FinYearID == finYear.ID &amp;&amp; f.BikeBrandID == 8\nfrom g in Dbs.SalesBikes.DefaultIfEmpty() where  g.DebtorID == y.ID &amp;&amp; g.FinYearID == finYear.ID &amp;&amp; g.BikeBrandID == 9\nfrom h in Dbs.SalesBikes.DefaultIfEmpty() where  h.DebtorID == y.ID &amp;&amp; h.FinYearID == finYear.ID &amp;&amp; h.BikeBrandID == 10\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1436410431, "post_id": 31305528, "comment_id": 50603775, "body": "Please post the link you found, then"}, {"owner": {"reputation": 36, "user_id": 5096078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87323c5362be018db50ef2d8b795999?s=128&d=identicon&r=PG&f=1", "display_name": "Allan Woods", "link": "https://stackoverflow.com/users/5096078/allan-woods"}, "reply_to_user": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 0, "creation_date": 1436421581, "post_id": 31305528, "comment_id": 50607115, "body": "Here is one of the @JonSkeet links I found :-) <a href=\"http://stackoverflow.com/questions/9720225/how-to-perform-join-between-multiple-tables-in-linq-lambda\" title=\"how to perform join between multiple tables in linq lambda\">stackoverflow.com/questions/9720225/&hellip;</a>"}], "tags": [], "owner": {"reputation": 36, "user_id": 5096078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87323c5362be018db50ef2d8b795999?s=128&d=identicon&r=PG&f=1", "display_name": "Allan Woods", "link": "https://stackoverflow.com/users/5096078/allan-woods"}, "is_accepted": false, "score": 0, "last_activity_date": 1436421833, "last_edit_date": 1495535206, "creation_date": 1436397710, "answer_id": 31305528, "question_id": 31305114, "link": "https://stackoverflow.com/questions/31305114/c-linq-to-sql-multiple-entity-join/31305528#31305528", "title": "C# LINQ to SQL Multiple entity join", "body": "<p>I believe I found a post from one <a href=\"https://stackoverflow.com/a/9720282/563532\" title=\"Jon Skeet\">Jon Skeet</a> which answers my question.\nApparently I do need to use Join On syntax but what I was missing was the need to imitate transparent identifiers so that the preprocessor can be sure that datatypes are the same.</p>\n\n<p>I shall try that now and make this the answer if it suceeds.</p>\n\n<p>Again, kudos to Jon Skeet.</p>\n"}], "owner": {"reputation": 36, "user_id": 5096078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87323c5362be018db50ef2d8b795999?s=128&d=identicon&r=PG&f=1", "display_name": "Allan Woods", "link": "https://stackoverflow.com/users/5096078/allan-woods"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1436421833, "creation_date": 1436395374, "last_edit_date": 1436396769, "question_id": 31305114, "link": "https://stackoverflow.com/questions/31305114/c-linq-to-sql-multiple-entity-join", "title": "C# LINQ to SQL Multiple entity join", "body": "<p>I have a table full of data split across year, brand and customer which I want to join with a customer master table. I want each output record to be customer, brand1 qty for the year, brand2 qty for the year, etc and a total of the brands.\nI created a class to recieve the output.\nWhen I view the data in the statistics table it has data which should meet the criteria used (i.e. debtorid, financialyearid and brandid.</p>\n\n<p>My select currently looks like this</p>\n\n<pre><code>            var Debtors = Dbs.Debtors;\n            var BikeSales = Dbs.SalesBikes.DefaultIfEmpty();\n            if (sortStatePostCode)\n            {\n                dquery = from y in Debtors\n                         from a in BikeSales where a.DebtorID == y.ID &amp;&amp; a.FinYearID == finYear.ID &amp;&amp; a.BikeBrandID == 1\n                         from b in BikeSales where b.DebtorID == y.ID &amp;&amp; b.FinYearID == finYear.ID &amp;&amp; b.BikeBrandID == 2\n                         from c in BikeSales where c.DebtorID == y.ID &amp;&amp; c.FinYearID == finYear.ID &amp;&amp; c.BikeBrandID == 3\n                         from d in BikeSales where d.DebtorID == y.ID &amp;&amp; d.FinYearID == finYear.ID &amp;&amp; d.BikeBrandID == 4\n                         from e in BikeSales where e.DebtorID == y.ID &amp;&amp; e.FinYearID == finYear.ID &amp;&amp; e.BikeBrandID == 7\n                         from f in BikeSales where f.DebtorID == y.ID &amp;&amp; f.FinYearID == finYear.ID &amp;&amp; f.BikeBrandID == 8\n                         from g in BikeSales where g.DebtorID == y.ID &amp;&amp; g.FinYearID == finYear.ID &amp;&amp; g.BikeBrandID == 9\n                         from h in BikeSales where h.DebtorID == y.ID &amp;&amp; h.FinYearID == finYear.ID &amp;&amp; h.BikeBrandID == 10\n\n                         orderby y.SortDelState == null ? \"ZZZZ\" : y.SortDelState, y.SortDelPCode == null ? \"9999\" : y.SortDelPCode, y.CustomerName\n                         select new DealerBikeResult\n                         {\n                             LongYear = finyear,\n                             CustomerCode = y.CustomerCode,\n                             CustomerName = y.CustomerName,\n                             City = y.SortDelCity,\n                             PostCode = y.SortDelPCode,\n                             State = y.SortDelState,\n                             Terms = y.TermsCode,\n                             Total = (\n                                 (f == null ? 0 : (int)f.TotalQty) +\n                                 (g == null ? 0 : (int)g.TotalQty) +\n                                 (a == null ? 0 : (int)a.TotalQty) +\n                                 (b == null ? 0 : (int)b.TotalQty) +\n                                 (c == null ? 0 : (int)c.TotalQty) +\n                                 (d == null ? 0 : (int)d.TotalQty) +\n                                 (e == null ? 0 : (int)e.TotalQty) +\n                                 (h == null ? 0 : (int)h.TotalQty)\n                             ),\n                             Bombtrack = f == null ? 0 : (int)f.TotalQty,\n                             Fairdale = g == null ? 0 : (int)g.TotalQty,\n                             Mirraco = a == null ? 0 : (int)a.TotalQty,\n                             Radio = b == null ? 0 : (int)b.TotalQty,\n                             Redline = c == null ? 0 : (int)c.TotalQty,\n                             Sunday = d == null ? 0 : (int)d.TotalQty,\n                             United = e == null ? 0 : (int)e.TotalQty,\n                             WTP = h == null ? 0 : (int)h.TotalQty,\n                             DealerBO = y.DealerBombTrack == null ? 3 : (int)y.DealerBombTrack,\n                             DealerFA = y.DealerFairdale == null ? 3 : (int)y.DealerFairdale,\n                             DealerMI = y.DealerMirraco == null ? 3 : (int)y.DealerMirraco,\n                             DealerRA = y.DealerRadio == null ? 3 : (int)y.DealerRadio,\n                             DealerRL = y.DealerRedline == null ? 3 : (int)y.DealerRedline,\n                             DealerSU = y.DealerSunday == null ? 3 : (int)y.DealerSunday,\n                             DealerUN = y.DealerUnited == null ? 3 : (int)y.DealerUnited,\n                             DealerWP = y.DealerWTP == null ? 3 : (int)y.DealerWTP\n                         };\n            }\n</code></pre>\n\n<p>No matter what financialyearid I send to the query my return set is empty.\nI am able to get results when I create a view in SQL management studio which essentially achieves the same thing I want to get but I dont want to use views.</p>\n\n<p>Could anyone point me in the right direction please.\n(Edited code to fix a few typos).</p>\n\n<p>Several other posts have addressed the question in other ways (i.e. should you use multi-select or Join On etc.). I could not find a suitable Join On with multi column equals to work from and I need the three column selection which is why I have tried this way. Other posts have shown this method as achieving a join while others suggest this can't work.</p>\n\n<p>Utilising Join ... On ... equals   format has not worked for me with multiple columns or I would be using it.</p>\n"}, {"tags": ["c#", "owin", "middleware"], "comments": [{"owner": {"reputation": 16646, "user_id": 1139099, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/AWxKH.png?s=128&g=1", "display_name": "harishr", "link": "https://stackoverflow.com/users/1139099/harishr"}, "edited": false, "score": 0, "creation_date": 1436413311, "post_id": 31305108, "comment_id": 50604448, "body": "write a filter and use stopwatch to compute the time spent... use reflection to check if property exist in response and set it accordingly"}, {"owner": {"reputation": 1290, "user_id": 1727540, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/1XvnL.jpg?s=128&g=1", "display_name": "nastassiar", "link": "https://stackoverflow.com/users/1727540/nastassiar"}, "reply_to_user": {"reputation": 16646, "user_id": 1139099, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/AWxKH.png?s=128&g=1", "display_name": "harishr", "link": "https://stackoverflow.com/users/1139099/harishr"}, "edited": false, "score": 0, "creation_date": 1436478430, "post_id": 31305108, "comment_id": 50643714, "body": "@entre Sorry I&#39;m relatively new to Owin. Create an owin filter? Or an Asp.net action filter?"}], "answers": [{"tags": [], "owner": {"reputation": 1217, "user_id": 5106565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d5PFJ.jpg?s=128&g=1", "display_name": "MichaelDotKnox", "link": "https://stackoverflow.com/users/5106565/michaeldotknox"}, "is_accepted": true, "score": 2, "last_activity_date": 1436646308, "creation_date": 1436646308, "answer_id": 31361488, "question_id": 31305108, "link": "https://stackoverflow.com/questions/31305108/owin-call-duration/31361488#31361488", "title": "Owin Call Duration", "body": "<p>I don't think that you need the overhead of creating a timer, just record the start time into a variable and then end time in another variable to set the duration.</p>\n\n<pre><code>var startTime = DateTime.Now;\nawait Next.Invoke(context);\nvar endTime = DateTime.Now;\nDuration = endTime - startTime;\n</code></pre>\n\n<p>It's a little messy, but if all you are doing in this middleware is logging, you want it to be quick, and this should fit the bill.</p>\n"}], "owner": {"reputation": 1290, "user_id": 1727540, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/1XvnL.jpg?s=128&g=1", "display_name": "nastassiar", "link": "https://stackoverflow.com/users/1727540/nastassiar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 31361488, "answer_count": 1, "score": 2, "last_activity_date": 1436646308, "creation_date": 1436395318, "question_id": 31305108, "link": "https://stackoverflow.com/questions/31305108/owin-call-duration", "title": "Owin Call Duration", "body": "<p>Is there simple way to find the call duration in c#. </p>\n\n<p>I am using Owin middleware to intercept calls to an API and log information about them and part of what I would like to log is the duration of the call. </p>\n\n<pre><code>public override async Task Invoke(IOwinContext context)\n{\n   var request = context.Request;\n   var response = context.Response;\n   var userName = request.User != null &amp;&amp; request.User.Identity.IsAuthenticated ? request.User.Identity.Name : \"No username\";\n\n   var entity = new TrackingEntity()\n   {\n      UserName = userName\n   };\n\n   // invoke the next middleware in the pipeline\n\n   await Next.Invoke(context);\n\n   WriteRequestHeaders(request, entity);\n   WriteResponseHeaders(response, entity);\n\n   await storage.InsertEntity(entity);\n}\n</code></pre>\n\n<p>If my tracking entity has a Duration field on it for storing the time length of the call what is the best way to go about recording it?</p>\n\n<pre><code>public TimeSpan Duration { get; set; }\n</code></pre>\n\n<p>Is the most accurate way to use a timer that starts before calling next and ends after? </p>\n\n<p>Any input would be appreciated I think I'm just overthinking this.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 403, "user_id": 718373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QHw2j.png?s=128&g=1", "display_name": "fujiFX", "link": "https://stackoverflow.com/users/718373/fujifx"}, "edited": false, "score": 0, "creation_date": 1436396427, "post_id": 31305102, "comment_id": 50600202, "body": "Answer by Carlitrosss should address your need. It should be noted that setting `AppendDataBoundItems=True&#39; ensures that your datasource items will be appended without removing the initial item added in the markup."}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 724222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sg5sd.jpg?s=128&g=1", "display_name": "Carlitrosss", "link": "https://stackoverflow.com/users/724222/carlitrosss"}, "is_accepted": false, "score": 0, "last_activity_date": 1436395846, "creation_date": 1436395846, "answer_id": 31305195, "question_id": 31305102, "link": "https://stackoverflow.com/questions/31305102/how-to-add-a-default-text-on-drop-down-list/31305195#31305195", "title": "How to add a Default text on Drop Down List?", "body": "<p>How about adding a ListItem directly in the mark up, such as:</p>\n\n<pre><code>&lt;asp:DropDownList runat=\"server\" ID=\"ddlTypes\" AppendDataBoundItems=\"true\"&gt;\n    &lt;asp:ListItem Text=\"Select value...\" Value=\"0\" Selected=\"True\"&gt;&lt;/asp:ListItem&gt;\n&lt;/asp:DropDownList&gt;\n</code></pre>\n\n<p>Make sure AppendDataBoundItems=\"true\" is present though.\nAnd in your event listener or validation, check that dllTypes.SelectedValue != 0.</p>\n"}, {"tags": [], "owner": {"reputation": 1081, "user_id": 4974464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a3ad5ebda289a6189691686c1b54efb?s=128&d=identicon&r=PG&f=1", "display_name": "Sky Fang", "link": "https://stackoverflow.com/users/4974464/sky-fang"}, "is_accepted": false, "score": 0, "last_activity_date": 1436399158, "creation_date": 1436399158, "answer_id": 31305771, "question_id": 31305102, "link": "https://stackoverflow.com/questions/31305102/how-to-add-a-default-text-on-drop-down-list/31305771#31305771", "title": "How to add a Default text on Drop Down List?", "body": "<pre><code>ddlTypes.DataBind();\nddlType.Insert(0,new ListItem(\"\",\"Select a department...\"))\n</code></pre>\n\n<p>when you submit,you need to check the ddlType's value,just like</p>\n\n<pre><code>if(ddlType.SelectedIndex&gt;0)\n{\n    //your code\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4158779, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1594627149/picture?type=large", "display_name": "Rhym", "link": "https://stackoverflow.com/users/4158779/rhym"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1703, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436399158, "creation_date": 1436395273, "question_id": 31305102, "link": "https://stackoverflow.com/questions/31305102/how-to-add-a-default-text-on-drop-down-list", "title": "How to add a Default text on Drop Down List?", "body": "<p>I'm having a hard time adding a default text to a drop down list. \nI want to have a default \"Select a department...\" text to my drop down list. Where the text has no value at all and will never be add to the database when selected. It is just a display, like an instruction to a user.</p>\n\n<hr>\n\n<pre><code>void GetUserTypes()\n{\n    con.Open();\n    SqlCommand cmd = new SqlCommand();\n    cmd.Connection = con;\n    cmd.CommandText = \"SELECT TypeID, TypeName FROM Types\";\n    SqlDataReader dr = cmd.ExecuteReader();\n    ddlTypes.DataSource = dr;\n    ddlTypes.DataTextField = \"TypeName\";\n    ddlTypes.DataValueField = \"TypeID\";\n    ddlTypes.DataBind();\n    con.Close();\n}\n</code></pre>\n\n<hr>\n\n<pre><code>    &lt;!--Department--&gt;\n    &lt;div class=\"form-group\"&gt;\n        &lt;label class=\"control-label col-lg-4\"&gt;\n            Department&lt;/label&gt;\n        &lt;div class=\"col-lg-8\"&gt;\n            &lt;asp:DropDownList ID=\"ddlTypes\" runat=\"server\" class=\"form-control\" /&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<hr>\n\n<p>I have tried adding a AppendDataBoundItems but the problem is when I submit the form having the selected item of the drop down list is \"Select a department...\" it will have an error.</p>\n"}, {"tags": ["c#", "asp.net", "entity-framework", "asp.net-identity"], "answers": [{"tags": [], "owner": {"reputation": 679, "user_id": 2553952, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cc95b919a176fb6b0991e6032f47fe0e?s=128&d=identicon&r=PG", "display_name": "bateloche", "link": "https://stackoverflow.com/users/2553952/bateloche"}, "is_accepted": true, "score": 8, "last_activity_date": 1436396947, "last_edit_date": 1495540828, "creation_date": 1436396947, "answer_id": 31305398, "question_id": 31305074, "link": "https://stackoverflow.com/questions/31305074/stop-ef-from-trying-to-create-initial-db/31305398#31305398", "title": "Stop EF from trying to create initial DB", "body": "<p>Add the following line to your context constructor</p>\n\n<pre><code>Database.SetInitializer&lt;YourContextClass&gt;(null);\n</code></pre>\n\n<p>This should be enough.</p>\n\n<p>But if you want to create the database only if it doesn't exists and correctly configure migrations, take a look at this question <a href=\"https://stackoverflow.com/questions/28618257/how-to-avoid-recreate-an-existing-database-using-automatic-code-first-migration\">How to avoid recreate an existing database using automatic Code First Migration</a></p>\n"}, {"tags": [], "owner": {"reputation": 1391, "user_id": 1011591, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/QwmcG.jpg?s=128&g=1", "display_name": "gh0st", "link": "https://stackoverflow.com/users/1011591/gh0st"}, "is_accepted": false, "score": 1, "last_activity_date": 1436399169, "last_edit_date": 1436399169, "creation_date": 1436397446, "answer_id": 31305477, "question_id": 31305074, "link": "https://stackoverflow.com/questions/31305074/stop-ef-from-trying-to-create-initial-db/31305477#31305477", "title": "Stop EF from trying to create initial DB", "body": "<p>You might be able to get away with adding this</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;contexts&gt; \n &lt;context type=\"Blogging.BlogContext, MyAssembly\" disableDatabaseInitialization=\"true\" /&gt; \n&lt;/contexts&gt;\n</code></pre>\n\n<p>to your Web.config. Of course changing <code>Blogging.BlogContext, MyAssembly</code> to more accurately reflect your model.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/data/jj556606#Initializers\" rel=\"nofollow\">Source</a></p>\n"}, {"tags": [], "owner": {"reputation": 1874, "user_id": 2392247, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/c75972031d4bef871cc9cb8da36a67f9?s=128&d=identicon&r=PG", "display_name": "user34660", "link": "https://stackoverflow.com/users/2392247/user34660"}, "is_accepted": false, "score": 0, "last_activity_date": 1544819802, "creation_date": 1544819802, "answer_id": 53786583, "question_id": 31305074, "link": "https://stackoverflow.com/questions/31305074/stop-ef-from-trying-to-create-initial-db/53786583#53786583", "title": "Stop EF from trying to create initial DB", "body": "<p>The first thing to try in response to that message is to look in Server Explorer in VS and right-click the database. If the <code>Detach Database</code> menu item is not disabled then click on that. That solved the problem for me when I was getting those messages.</p>\n"}], "owner": {"reputation": 163, "user_id": 2109201, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qHbiM.jpg?s=128&g=1", "display_name": "Clint Clark", "link": "https://stackoverflow.com/users/2109201/clint-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7809, "favorite_count": 1, "accepted_answer_id": 31305398, "answer_count": 3, "score": 8, "last_activity_date": 1544819802, "creation_date": 1436395145, "question_id": 31305074, "link": "https://stackoverflow.com/questions/31305074/stop-ef-from-trying-to-create-initial-db", "title": "Stop EF from trying to create initial DB", "body": "<p>So I successfully got my solution to create and initialize the Identity database. The problem now is, as I am working on it I keep getting this error </p>\n\n<pre><code>Cannot create file 'C:\\Webs\\SomeScheduler\\SomeScheduler\\App_Data\\SomeSchedulerUsers.mdf' \nbecause it already exists. Change the file path or the file name, and retry the operation.\nCREATE DATABASE failed. Some file names listed could not be created. Check related errors.\nDescription: An unhandled exception occurred during the execution of the current web request.\nPlease review the stack trace for more information about the error and where it originated in \nthe code.\n\nException Details: System.Data.SqlClient.SqlException: Cannot create file \n'C:\\Webs\\SomeScheduler\\SomeScheduler\\App_Data\\SomeSchedulerUsers.mdf' \nbecause it already exists. Change the file path or the file name, and retry the operation.\nCREATE DATABASE failed. Some file names listed could not be created. Check related errors.\n</code></pre>\n\n<p>I know that it already exists, that is what I want. \nHow do I stop it from trying to re-create it every time I try to run my code as I develop this site?</p>\n\n<p>As always, any and all help is greatly appreciated.</p>\n"}, {"tags": ["c#", "multithreading", "invoke"], "comments": [{"owner": {"reputation": 12857, "user_id": 1282539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d73911f3fb624361e7d39b82f9395cc1?s=128&d=identicon&r=PG", "display_name": "SimpleVar", "link": "https://stackoverflow.com/users/1282539/simplevar"}, "edited": false, "score": 0, "creation_date": 1436395250, "post_id": 31305059, "comment_id": 50599769, "body": "It&#39;s a matter of whether the method is executed on the main thread or not. I don&#39;t know how you&#39;re using those methods and your code logic, but the snippet suggests that the Received is running on the UI thread, while the DCed is running on a different thread (and I&#39;m not saying that this makes sense). Regardless, the Invoke is required due to touching UI business (from different thread), so if you had different logic you might not have needed to use Invoke in either of those methods."}, {"owner": {"reputation": 315, "user_id": 4245373, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abebec378f10821908bf8b7faea56eec?s=128&d=identicon&r=PG&f=1", "display_name": "Miko", "link": "https://stackoverflow.com/users/4245373/miko"}, "reply_to_user": {"reputation": 12857, "user_id": 1282539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d73911f3fb624361e7d39b82f9395cc1?s=128&d=identicon&r=PG", "display_name": "SimpleVar", "link": "https://stackoverflow.com/users/1282539/simplevar"}, "edited": false, "score": 0, "creation_date": 1436395560, "post_id": 31305059, "comment_id": 50599895, "body": "@YoryeNathan About threads, how can I know when something is running on main thread and when not ? When does this happen, is something in code or is just how this works ?"}, {"owner": {"reputation": 12857, "user_id": 1282539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d73911f3fb624361e7d39b82f9395cc1?s=128&d=identicon&r=PG", "display_name": "SimpleVar", "link": "https://stackoverflow.com/users/1282539/simplevar"}, "edited": false, "score": 0, "creation_date": 1436395665, "post_id": 31305059, "comment_id": 50599944, "body": "The code itself indicates on what threads things run. If you&#39;re lazy, you can just set a breakpoint in the method and open the Threads tab in Debug, and see where you at."}], "answers": [{"comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1436397203, "post_id": 31305381, "comment_id": 50600457, "body": "Calling the UI thread the &quot;Form main thread&quot; might be a bit misleading. I get the sense that each form may have its own main thread. It might be better to just say &quot;UI thread&quot; instead."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1436397389, "post_id": 31305381, "comment_id": 50600521, "body": "Also, it&#39;s not safe to have code that makes &quot;no changes&quot; (i.e. reading UI elements) running on another thread. To be certain that UI code runs correctly it must be run on the UI thread - for all read and write operations."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1436400237, "post_id": 31305381, "comment_id": 50601333, "body": "I&#39;m sorry to be a painful, but even &quot;get partial results&quot; could be wrong. There&#39;s no guarantee that what appears to be a read-only operation might update something internally. It would be easy to write code that does that. We don&#39;t know what the framework code is doing. Also, it is possible to have a race condition where a purely read-only operation would return not a &quot;partial&quot; result, but a completely incorrect result. The bottom-line is you cannot safely do any operation on a non-UI-thread."}, {"owner": {"reputation": 8035, "user_id": 347348, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/40cd07bc9546df9840ba02f04607f681?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/347348/andy"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1436402946, "post_id": 31305381, "comment_id": 50601999, "body": "@Enigmativity no, there is only ever one UI thread and it handles all forms and controls."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "reply_to_user": {"reputation": 8035, "user_id": 347348, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/40cd07bc9546df9840ba02f04607f681?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/347348/andy"}, "edited": false, "score": 0, "creation_date": 1436403330, "post_id": 31305381, "comment_id": 50602085, "body": "@Andy - Yes, I know. I was just commenting that the wording in this answer was potentially misleading for others."}], "tags": [], "owner": {"reputation": 7165, "user_id": 479137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9aae86663c8906e056d2c1d6ce0e6cb?s=128&d=identicon&r=PG", "display_name": "David M&#229;rtensson", "link": "https://stackoverflow.com/users/479137/david-m%c3%a5rtensson"}, "is_accepted": true, "score": 0, "last_activity_date": 1436397504, "last_edit_date": 1436397504, "creation_date": 1436396858, "answer_id": 31305381, "question_id": 31305059, "link": "https://stackoverflow.com/questions/31305059/why-invoke-is-needed/31305381#31305381", "title": "Why Invoke is needed?", "body": "<p>It all depends on how the method is called.</p>\n\n<p>There is a property InvokeRequired property on some objects (Controls) that can be used to selectively invoke when needed.</p>\n\n<p>In a WinForms application, any method that changes the form will have to be run within the Form UI thread to avoid conflicts but any method that makes no changes could often safely be called without invoke but it could get partial results.</p>\n"}], "owner": {"reputation": 315, "user_id": 4245373, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/abebec378f10821908bf8b7faea56eec?s=128&d=identicon&r=PG&f=1", "display_name": "Miko", "link": "https://stackoverflow.com/users/4245373/miko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 31305381, "answer_count": 1, "score": 0, "last_activity_date": 1436397504, "creation_date": 1436395069, "question_id": 31305059, "link": "https://stackoverflow.com/questions/31305059/why-invoke-is-needed", "title": "Why Invoke is needed?", "body": "<p>I kinda do understand point of threads and invokes, but not so great. I'm having server/client application made from tutorial. Now I'm having 2 functions. In Disconnect function I need to have Invoke but in Received function I don't. </p>\n\n<p>Why is that (problem is lstClient) ? </p>\n\n<p>And if I have Invoke in Received function then Invoke is just looping for some reason, why?</p>\n\n<pre><code>void client_Disconnected(Client sender)\n{\n    Invoke((MethodInvoker)delegate\n    {\n        for (int i = 0; i &lt; lstClient.Items.Count; i++)\n        {\n            Client client = lstClient.Items[i].Tag as Client;\n            if(client.ID == sender.ID)\n            {\n                lb_ID.Items.RemoveAt(i); lb_ip.Items.RemoveAt(i); lb_users.Items.RemoveAt(i);\n                lstClient.Items.RemoveAt(i);\n                break;\n            }\n        }\n    });\n}\n\nvoid client_Received(Client sender, byte[] data)\n{\n    /*Invoke((MethodInvoker)delegate\n    {*/\n        for (int i = 0; i &lt; lstClient.Items.Count; i++)\n        {\n            Client client = lstClient.Items[i].Tag as Client;\n            if (client.ID == sender.ID)\n            {\n                if (Encoding.Default.GetString(data) == \"end\") \n                {\n                    client_Disconnected(client); \n                    break;\n                }\n                lstClient.Items[i].SubItems[2].Text = Encoding.Default.GetString(data);\n                lstClient.Items[i].SubItems[3].Text = DateTime.Now.ToString() ;\n                break;\n            }\n        }\n    //});\n}\n</code></pre>\n"}, {"tags": ["c#", "json", "linq"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5095993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122465667767262/picture?type=large", "display_name": "Connor Jensen", "link": "https://stackoverflow.com/users/5095993/connor-jensen"}, "edited": false, "score": 0, "creation_date": 1436395187, "post_id": 31305014, "comment_id": 50599742, "body": "oh sorry... I should probably be more specific. I used something similar to your code and it worked, but the data I&#39;m using now is actually layered a lot more and I was just using this data set to test if I could do what I described above. Is the problem how I&#39;m approaching this though and unnecessarily creating a problem?"}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "reply_to_user": {"reputation": 51, "user_id": 5095993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122465667767262/picture?type=large", "display_name": "Connor Jensen", "link": "https://stackoverflow.com/users/5095993/connor-jensen"}, "edited": false, "score": 0, "creation_date": 1436395408, "post_id": 31305014, "comment_id": 50599838, "body": "@ConnorJensen I am not sure I can understand your problem, but it is not import how deep your nested classes are, Just create your classes using that site and write your linq."}, {"owner": {"reputation": 51, "user_id": 5095993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122465667767262/picture?type=large", "display_name": "Connor Jensen", "link": "https://stackoverflow.com/users/5095993/connor-jensen"}, "edited": false, "score": 0, "creation_date": 1436395719, "post_id": 31305014, "comment_id": 50599964, "body": "yup that&#39;s what I&#39;m doing now... thank you for referencing me to that tool, I think that solves my problems :)"}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "reply_to_user": {"reputation": 51, "user_id": 5095993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122465667767262/picture?type=large", "display_name": "Connor Jensen", "link": "https://stackoverflow.com/users/5095993/connor-jensen"}, "edited": false, "score": 0, "creation_date": 1436396349, "post_id": 31305014, "comment_id": 50600173, "body": "@ConnorJensen If that answer helped, you may want to <i>accept</i> it. <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>"}], "tags": [], "owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "is_accepted": true, "score": 0, "last_activity_date": 1436395195, "last_edit_date": 1436395195, "creation_date": 1436394904, "answer_id": 31305014, "question_id": 31304950, "link": "https://stackoverflow.com/questions/31304950/linq-to-json-target-specific-items-to-deserialize/31305014#31305014", "title": "linq to json target specific items to deserialize", "body": "<p>I would use these classes</p>\n\n<pre><code>public class Recipe\n{\n    public string publisher { get; set; }\n    public string f2f_url { get; set; }\n    public string title { get; set; }\n    public string source_url { get; set; }\n    public string recipe_id { get; set; }\n    public string image_url { get; set; }\n    public double social_rank { get; set; }\n    public string publisher_url { get; set; }\n}\n\npublic class RootObject\n{\n    public int count { get; set; }\n    public List&lt;Recipe&gt; recipes { get; set; }\n}\n</code></pre>\n\n<p>and </p>\n\n<p>deserialize as</p>\n\n<pre><code>var obj = JsonConvert.DeserializeObject&lt;RootObject&gt;(json)\n</code></pre>\n\n<p>Now you can write your linq in a <em>compile-time safe</em> way</p>\n\n<p><em>PS: See <a href=\"http://json2csharp.com/\" rel=\"nofollow\">http://json2csharp.com/</a></em></p>\n"}], "owner": {"reputation": 51, "user_id": 5095993, "user_type": "registered", "profile_image": "https://graph.facebook.com/1122465667767262/picture?type=large", "display_name": "Connor Jensen", "link": "https://stackoverflow.com/users/5095993/connor-jensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 31305014, "answer_count": 1, "score": 1, "last_activity_date": 1436395195, "creation_date": 1436394622, "question_id": 31304950, "link": "https://stackoverflow.com/questions/31304950/linq-to-json-target-specific-items-to-deserialize", "title": "linq to json target specific items to deserialize", "body": "<p>So here's my code:</p>\n\n<pre><code>        // converts JSON data to an object I can use to pull select data out of\n        JObject o = JObject.Parse(data);\n\n        // this works fine. I can go one layer deep for a single piece of data\n        int count = (int)o[\"count\"];\n        Console.WriteLine(\"This: {0} should say 30\", count);\n\n        // this also works. I can go multiple layers deep for SINGLE pieces of data...\n        string publisherOne = (string)o[\"recipes\"][0][\"publisher\"];\n        Console.WriteLine(\"This: {0} should say Closet Cooking\", publisherOne);\n\n        // this is where the issue is... I can't go multiple layers deep and\n        // get single pieces of data from each JSON object\n        List&lt;string&gt; allPublishers = o[\"recipes\"][\"publisher\"].Select(t =&gt; (string)t).ToList();\n        Console.WriteLine(allPublishers[2] + \"should say picky palate\");\n</code></pre>\n\n<p>data is a string of JSON, which here is a sample of what I'm using: (It's longer, but this is enough)</p>\n\n<pre><code>{\n  \"count\": 30,\n  \"recipes\": [\n{\n  \"publisher\": \"Closet Cooking\",\n  \"f2f_url\": \"http://food2fork.com/view/35186\",\n  \"title\": \"Caprese Grilled Cheese Sandwich\",\n  \"source_url\": \"http://www.closetcooking.com/2011/09/caprese-grilled-cheese-sandwich.html\",\n  \"recipe_id\": \"35186\",\n  \"image_url\": \"http://static.food2fork.com/Caprese2BGrilled2BCheese2BSandwich2B5002B21616ce448f5.jpg\",\n  \"social_rank\": 99.99999999999993,\n  \"publisher_url\": \"http://closetcooking.com\"\n},\n{\n  \"publisher\": \"Closet Cooking\",\n  \"f2f_url\": \"http://food2fork.com/view/35596\",\n  \"title\": \"Spinach Pesto Grilled Cheese Sandwich\",\n  \"source_url\": \"http://www.closetcooking.com/2010/05/spinach-pesto-grilled-cheese-sandwich.html\",\n  \"recipe_id\": \"35596\",\n  \"image_url\": \"http://static.food2fork.com/SpinachPestoGrilledCheeseSandwich50053b8a9a0.jpg\",\n  \"social_rank\": 99.99999999999862,\n  \"publisher_url\": \"http://closetcooking.com\"\n},\n{\n  \"publisher\": \"Picky Palate\",\n  \"f2f_url\": \"http://food2fork.com/view/484d98\",\n  \"title\": \"Crock Pot Pesto Ranch Chicken Thighs\",\n  \"source_url\": \"http://picky-palate.com/2012/09/20/pesto-ranch-crock-pot-chicken-thighs/\",\n  \"recipe_id\": \"484d98\",\n  \"image_url\": \"http://static.food2fork.com/CrockPotPestoRanchChickenThighs1text1300x248ca0b.jpg\",\n  \"social_rank\": 99.99999999941502,\n  \"publisher_url\": \"http://picky-palate.com\"\n},\n</code></pre>\n\n<p>The first two (count and publisherOne) work absolutely fine.\nallPublishers is supposed to be a list of all the publishers, but it's causing me trouble because the publisher info is just a single piece of data within the array of recipes. This is what I'm using for reference in trying to do this:\n<a href=\"http://www.newtonsoft.com/json/help/html/LINQtoJSON.htm\" rel=\"nofollow\">http://www.newtonsoft.com/json/help/html/LINQtoJSON.htm</a>\nThanks in advance!</p>\n"}, {"tags": ["c#", "asp.net-web-api", "odata"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2079948, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e921c5c9fe43cdcfd8ec160abb806973?s=128&d=identicon&r=PG", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/2079948/prashanth"}, "edited": false, "score": 0, "creation_date": 1436447643, "post_id": 31310776, "comment_id": 50624266, "body": "Sam, thanks a bunch. I was stuck with this problem for few days, not being able to find an example. you saved me."}], "tags": [], "owner": {"reputation": 2883, "user_id": 3304931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c3443a4f06cb5b80251971d64f3c4b9?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Xu", "link": "https://stackoverflow.com/users/3304931/sam-xu"}, "is_accepted": true, "score": 0, "last_activity_date": 1436426795, "creation_date": 1436426795, "answer_id": 31310776, "question_id": 31304784, "link": "https://stackoverflow.com/questions/31304784/odata-getter-for-dynamicproerties/31310776#31310776", "title": "oData getter for Dynamicproerties", "body": "<p>For #1, I think you shouldn't do that. There are two ways you can use to query dynamic property since <a href=\"http://www.nuget.org/packages/Microsoft.AspNet.OData/5.6.0\" rel=\"nofollow\">Web API OData v5.6</a></p>\n\n<ol>\n<li>Convention routing</li>\n</ol>\n\n<p>It should work to define a method named \"GetDynamicProperty\" in your <code>BooksController</code>. For example:</p>\n\n<pre><code>public IHttpActionResult GetDynamicProperty([FromODataUri] string key, [FromODataUri] string dynamicProperty)\n{\n ...\n}\n</code></pre>\n\n<p>Where, parameter name should named <code>dynamicProperty</code>.</p>\n\n<ol start=\"2\">\n<li>Attribute routing</li>\n</ol>\n\n<p>It should work to define a random method in any controller with an ODataRoute attribute on it. For example:</p>\n\n<pre><code>[HttpGet]\n[ODataRoute(\"Books({key})/Press/{pName:dynamicproperty}\")]\npublic IHttpActionResult XxxxDynamicPropertyXxxx([FromODataUri] string key, [FromODataUri] string pName)\n{\n...\n}\n</code></pre>\n\n<p>The template for dynamic property should be \"<code>{anyName:dynamicproperty}</code>\"</p>\n\n<p>For #2, please add the following method in your controller,</p>\n\n<pre><code>private IHttpActionResult Ok(object content, Type type)\n{\n    var resultType = typeof(OkNegotiatedContentResult&lt;&gt;).MakeGenericType(type);\n    return Activator.CreateInstance(resultType, content, this) as IHttpActionResult;\n}\n</code></pre>\n\n<p>and call it in your HTTP response method. for example:</p>\n\n<pre><code>[HttpGet]\n[ODataRoute(\"Books({key})/Press/{pName:dynamicproperty}\")]\npublic IHttpActionResult XxxxDynamicPropertyXxxx([FromODataUri] string key, [FromODataUri] string pName)\n{\n    Book book = _books.FirstOrDefault(e =&gt; e.ISBN == key);\n    if (book == null)\n    {\n        return NotFound();\n    }\n\n    object value;\n    if (!book.Press.DynamicProperties.TryGetValue(pName, out value))\n    {\n       return NotFound();\n    }\n\n     return Ok(value, value.GetType());\n}\n</code></pre>\n\n<p>Test:</p>\n\n<p>if I use the sample \"Books\" in <a href=\"http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/odata-v4/use-open-types-in-odata-v4\" rel=\"nofollow\">http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/odata-v4/use-open-types-in-odata-v4</a></p>\n\n<p>I query </p>\n\n<pre><code>http://localhost/odata/Books('978-0-7356-7942-9')/Authors   \n</code></pre>\n\n<p>I can get the result as:</p>\n\n<pre><code>{\n  \"@odata.context\":\"http://localhost/odata/$metadata#Collection(Edm.String)\",\"va\nlue\":[\n    \"Leonard G. Lobel\",\"Eric D. Boyd\"\n  ]\n}\n</code></pre>\n\n<p>while, I query:</p>\n\n<pre><code>http://localhost/odata/Books('978-0-7356-7942-9')/Press/Address\n</code></pre>\n\n<p>I can get the result as:</p>\n\n<pre><code>{\n  \"@odata.context\":\"http://localhost/odata/$metadata#Books('978-0-7356-7942-9')/\nPress/Address\",\"City\":\"Redmond\",\"Street\":\"One Microsoft Way\"\n}\n</code></pre>\n\n<p>Hope it can help you. Thanks.</p>\n"}], "owner": {"reputation": 89, "user_id": 2079948, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e921c5c9fe43cdcfd8ec160abb806973?s=128&d=identicon&r=PG", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/2079948/prashanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 31310776, "answer_count": 1, "score": 0, "last_activity_date": 1436426795, "creation_date": 1436393746, "last_edit_date": 1436411002, "question_id": 31304784, "link": "https://stackoverflow.com/questions/31304784/odata-getter-for-dynamicproerties", "title": "oData getter for Dynamicproerties", "body": "<p>I have a class with DynamicProperties (open type) which I am exposing via oData. As per my understanding, if the user queries one of the dynamicproperties the request goes to getDynamicProperty method (or is there any other better way to do it ?). </p>\n\n<ol>\n<li><p>How do I get the property user is trying to access ?. At present I am parsing the uri using oDatauriParser. Is it right approach ?. Is there any other better way to do it?</p></li>\n<li><p>When I return I am not able to return the value of the property as it is stored as type object in dictionary. At present I am returning it as a string. But I want it to return its actual type or any other means which will preserve its actual type, how do i do it ?</p>\n\n<pre><code>public class BooksController : ODataController\n{           \n   public IHttpActionResult getDynamicProperty([FromODataUri]string key)  \n   {\n\n     try\n     {\n        ODataUriParser uriParser = new ODataUriParser(WebApiConfig.GetEdmModel(), new Uri(Request.RequestUri.PathAndQuery, UriKind.Relative));\n        OpenPropertySegment propertySegment = uriParser.ParsePath().LastSegment as OpenPropertySegment;\n        if(propertySegment == null || string.IsNullOrEmpty(propertySegment.PropertyName))\n        {\n            return NotFound();\n        }\n        string property = propertySegment.PropertyName;\n        Book book = getBook(key);\n        return Ok(book.DynamicProperties[property].ToString());\n     }\n     catch(Exception)\n     {\n        return NotFound();\n     }\n   }\n}\n\npublic class Book\n{\n   public string ISBN { get; set; }\n   public string Title { get; set; }\n   public Press Press { get; set; }\n   public Dictionary&lt;string, object&gt; DynamicProperties { get; set; }\n}\n</code></pre></li>\n</ol>\n"}, {"tags": ["c#", "serialization", "protobuf-net"], "comments": [{"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "edited": false, "score": 0, "creation_date": 1436475665, "post_id": 31304674, "comment_id": 50642371, "body": "Sam removed his answer (it didn&#39;t compile), but since I edited my question due to his response, I felt it may be useful to summarize his solution to give context to the edit.  Essentially, what he suggested, was to use a surrogate, via a call to <code>RuntimeTypeModel.Default.Add(typeof(IFoo), false).SetSurrogate(typeof(Foo))</code> in the static constructor of MyClass."}, {"owner": {"reputation": 316, "user_id": 5025265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e95e0dd547580db24566fe9e693082?s=128&d=identicon&r=PG&f=1", "display_name": "kirbatious", "link": "https://stackoverflow.com/users/5025265/kirbatious"}, "edited": false, "score": 0, "creation_date": 1522935369, "post_id": 31304674, "comment_id": 86358175, "body": "I&#39;ve just hit the same issue with the surrogate InvalidOperationException - did you ever solve it?"}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "reply_to_user": {"reputation": 316, "user_id": 5025265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e95e0dd547580db24566fe9e693082?s=128&d=identicon&r=PG&f=1", "display_name": "kirbatious", "link": "https://stackoverflow.com/users/5025265/kirbatious"}, "edited": false, "score": 1, "creation_date": 1522950786, "post_id": 31304674, "comment_id": 86368600, "body": "@kirbatious Usually I&#39;ll answer my own question if I figure something out, so my guess is no.  However, I&#39;ll double check the code in the next few days to see if I ultimately figured out how to make this work.  I&#39;ll either post an answer, or replace this comment once I know for certain."}, {"owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "reply_to_user": {"reputation": 316, "user_id": 5025265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5e95e0dd547580db24566fe9e693082?s=128&d=identicon&r=PG&f=1", "display_name": "kirbatious", "link": "https://stackoverflow.com/users/5025265/kirbatious"}, "edited": false, "score": 0, "creation_date": 1523197344, "post_id": 31304674, "comment_id": 86450555, "body": "@kirbatious Unfortunately, I eventually gave up on this.  Since I only had one implementing type for <code>IFoo</code>, I just made the private serialized member use the underlying concrete class.  I have added an answer explaining how that works in my case.  However, I <i>think</i> you might be able to do something like this using Surrogates, if you serialize the concrete class name with each member of the list (or the containing class, if you know everything in the list has the same type).  I have never tried that, though."}, {"owner": {"reputation": 820, "user_id": 290887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fcbf0de88cd6e74f1a461a0f062e42?s=128&d=identicon&r=PG", "display_name": "JasonCG", "link": "https://stackoverflow.com/users/290887/jasoncg"}, "edited": false, "score": 0, "creation_date": 1548625422, "post_id": 31304674, "comment_id": 95597972, "body": "I have gotten this to work. The main difference I can tell from your original question and what I&#39;ve been able to implement is I put <code>ProtoContract</code> and <code>ProtoMember</code> on the interface. But my implementation is rather complex using an interface, then a generic abstract class, then concrete classes implementing the generic abstract class. I rigged up the interface with ProtoBuf decorators, ProtoInclude the concrete classes, and decorated the concrete classes with ProtoMember where appropriate."}], "answers": [{"tags": [], "owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1523197059, "creation_date": 1523197059, "answer_id": 49718812, "question_id": 31304674, "link": "https://stackoverflow.com/questions/31304674/how-to-serialize-a-collection-of-interface-objects-using-protobuf-net/49718812#49718812", "title": "How to Serialize a Collection of Interface Objects Using Protobuf-Net", "body": "<p>I was never able to get this working where the interface class was used in the serialized member.  Instead, I ended up having to put the concrete class as the list member type.  The following is what ultimately worked for me:</p>\n\n<pre><code>[ProtoContract]\npublic class MyClass\n{\n    [ProtoMember(1, OverwriteList = true)]\n    private List&lt;Foo&gt; MutableFoos { get; set; }\n\n    public IReadOnlyList&lt;IFoo&gt; Foos\n    {\n        get { return MutableFoos; }\n    }\n}\n</code></pre>\n\n<p>Note the type in the serialized member is <code>List&lt;Foo&gt;</code>, instead of <code>List&lt;IFoo&gt;</code>.  I never figured out how to get the latter to work.</p>\n"}], "owner": {"reputation": 3828, "user_id": 960115, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/oZ1UM.gif?s=128&g=1", "display_name": "Jeff G", "link": "https://stackoverflow.com/users/960115/jeff-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1146, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1523197059, "creation_date": 1436393130, "last_edit_date": 1495542589, "question_id": 31304674, "link": "https://stackoverflow.com/questions/31304674/how-to-serialize-a-collection-of-interface-objects-using-protobuf-net", "title": "How to Serialize a Collection of Interface Objects Using Protobuf-Net", "body": "<p>I have the following class definitions:</p>\n\n<pre><code>[ProtoInclude(2, typeof(Foo))]\npublic interface IFoo\n{\n    double Bar { get; }\n}\n\n\n\n[ProtoContract]\npublic class Foo : IFoo\n{\n    [ProtoMember(1)]\n    private double _bar\n    {\n        get { return Bar / 10; }\n        set { Bar = 10 * value; }\n    }\n\n    public double Bar { get; private set; }\n}\n\n\n\n[ProtoContract]\npublic class MyClass\n{\n    [ProtoMember(1, OverwriteList = true)]\n    public IReadOnlyList&lt;IFoo&gt; Foos { get; private set; }\n}\n</code></pre>\n\n<p>When I try to serialize a <em>MyClass</em> object using protobuf-net, I get the exception:<blockquote>System.InvalidOperationException : It was not possible to prepare a serializer for: MyNamespace.MyClass\n  ----> System.InvalidOperationException : No serializer defined for type: MyNamespace.IFoo</blockquote></p>\n\n<p>In my case, I know that the concrete type of the items stored in <em>MyClass.Foos</em> is <em>Foo</em>.  How can I tell protobuf to use type <em>Foo</em> anywhere it sees type <em>IFoo</em>?  Alternatively, how can I make it include <em>Foo</em> as one of the classes available to implement <em>IFoo</em> in the collection?</p>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>The answer from Sam is close enough such that it revealed another issue with this approach.  Namely, that <a href=\"https://stackoverflow.com/questions/30557636/is-there-a-way-to-use-ireadonlycollectiont-ireadonlylistt-with-protobuf-net\">it is not possible to serialize a property of type IReadOnlyList&lt;T&gt; using protobuf-net</a>.  There is a simple workaround, however, since the list is being created in the constructor of MyClass.  Hence, MyClass can change to the following:</p>\n\n<pre><code>[ProtoContract]\npublic class MyClass\n{\n    [ProtoMember(1, OverwriteList = true)]\n    private List&lt;IFoo&gt; MutableFoos { get; set; }\n\n    public IReadOnlyList&lt;IFoo&gt; Foos\n    {\n        get { return MutableFoos; }\n    }\n}\n</code></pre>\n\n<p>However, serialization of <em>MyClass</em> is still failing with the message, \"<em>System.InvalidOperationException : No suitable conversion operator found for surrogate: MyNamespace.IFoo / MyNamespace.Foo</em>\".</p>\n"}, {"tags": ["c#", "exception-handling", "async-await"], "comments": [{"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 1, "creation_date": 1436393381, "post_id": 31304614, "comment_id": 50599100, "body": "Keep in mind that if <code>OperationThatMayCompleteSynchronously</code> is an async method, all exceptions will be stored in the task and no exceptions will be thrown synchronously"}], "answers": [{"comments": [{"owner": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "reply_to_user": {"reputation": 113291, "user_id": 234, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3a9ff49a9e689dcbfc8242f05180cc31?s=128&d=identicon&r=PG", "display_name": "Orion Edwards", "link": "https://stackoverflow.com/users/234/orion-edwards"}, "edited": false, "score": 1, "creation_date": 1436398804, "post_id": 31304646, "comment_id": 50600922, "body": "@OrionEdwards, to get the 100% behavior you want, you&#39;d need to amend the above to add something like this:  <code>var task = OperationThatMayCompleteSynchronously(parameter); if (task.IsFaulted) task.GetAwaiter().GetResult(); ...</code>. Check <a href=\"http://stackoverflow.com/a/21082631/1768303\">this</a>."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "reply_to_user": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "edited": false, "score": 1, "creation_date": 1436433790, "post_id": 31304646, "comment_id": 50614424, "body": "@Noseratio can you explain what that would accomplish? It seems the await does just that."}, {"owner": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "edited": false, "score": 0, "creation_date": 1436437016, "post_id": 31304646, "comment_id": 50616828, "body": "AFAIU, the OP wants the 1st line to throw instantly if <code>OperationThatMayCompleteSynchronously</code> throws from its synchronous part, rather than at the <code>await</code> line. This is not gonna happen if this method is <code>async</code>, e.g. <code>async Task OperationThatMayCompleteSynchronously() { throw new Exception(); }</code>. It will still throw at the <code>await</code> line, @usr."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "edited": false, "score": 0, "creation_date": 1436438327, "post_id": 31304646, "comment_id": 50617702, "body": "@Noseratio How does removing the await from the caller changes that?"}, {"owner": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "reply_to_user": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 0, "creation_date": 1436439434, "post_id": 31304646, "comment_id": 50618394, "body": "@i3arnon, it doesn&#39;t alone, but following it with <code>if (task.IsFaulted) task.GetAwaiter().GetResult()</code> does, as I mentioned <a href=\"http://stackoverflow.com/questions/31304614/async-await-exception-catching-which-thread-am-i-on/31304646?noredirect=1#comment50600922_31304646\">above</a>. The OP wants <i>I&#39;d like to be able to tell the difference between an exception thrown immediately, and I&#39;m still on the calling thread</i>, but it might not be the same thread after <code>await</code>, that&#39;s why that line."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "edited": false, "score": 0, "creation_date": 1436439934, "post_id": 31304646, "comment_id": 50618720, "body": "@Noseratio I see what you&#39;re trying to do (though it&#39;s not 100% correct as it depends on time and race conditions, but that doesn&#39;t really matter). I would use <code>Task.IsCompleted</code> instead for this."}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 1, "creation_date": 1436444390, "post_id": 31304646, "comment_id": 50621736, "body": "@usr: Consider amending your answer to also update <code>OperationThatMayCompleteSynchronously</code> so that it does its synchronous exceptions in a non-async method. Otherwise, your first line won&#39;t actually ever throw. I think that&#39;s cleaner than using <code>IsFaulted</code>/<code>IsCompleted</code>."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "reply_to_user": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1436444970, "post_id": 31304646, "comment_id": 50622190, "body": "@StephenCleary I think that check would be inherently racy. As I understand it the OP only wants to differentiate between OperationThatMayCompleteSynchronously throwing and the task being faulted. I don&#39;t think he is concerned with thread affinity that much (contrary to what his wording suggests).; I make no assumptions about the implementation of OperationThatMayCompleteSynchronously. If he thinks that this method can throw then I assume it&#39;s not an async method."}, {"owner": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "reply_to_user": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 0, "creation_date": 1436445214, "post_id": 31304646, "comment_id": 50622396, "body": "@i3arnon, the race might be about either hitting <code>await</code> or not. Say, the task fails asynchronously on another thread, while the calling thread has executed my <code>if</code> check and is about to call <code>TaskAwaiter.IsCompleted</code> (or <code>TaskAwaiter,UnsafeOnCompleted</code>). The exception will still be thrown on the same calling thread and the same stack frame, which is the desired behavior."}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 1, "creation_date": 1436446570, "post_id": 31304646, "comment_id": 50623480, "body": "@usr: Agree re thread identity as a red herring. I would just point out the &quot;wrapper method&quot; explicitly because sometimes people do assume <code>throw</code> before <code>await</code> will be thrown directly and not placed on the task. And in fact the first Async CTP did have this behavior."}], "tags": [], "owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "is_accepted": true, "score": 10, "last_activity_date": 1436446741, "last_edit_date": 1436446741, "creation_date": 1436393008, "answer_id": 31304646, "question_id": 31304614, "link": "https://stackoverflow.com/questions/31304614/async-await-exception-catching-which-thread-am-i-on/31304646#31304646", "title": "async await exception catching - which thread am I on?", "body": "<p>Store the task in a variable:</p>\n\n<pre><code>var task = OperationThatMayCompleteSynchronously(parameter); //may throw\n</code></pre>\n\n<p>Then await it:</p>\n\n<pre><code>await task; //may throw\n</code></pre>\n\n<p>That way you can differentiate between the two origins for a potential exception.</p>\n\n<p>Note, that <code>async</code> methods never throw directly. They pass exceptions through the task they return. This is true even for \"validation\" throws that execute before the first await.</p>\n"}, {"tags": [], "owner": {"reputation": 11114, "user_id": 402366, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/43074670e3a479a1d3ae5242ce00819e?s=128&d=identicon&r=PG", "display_name": "Paulo Morgado", "link": "https://stackoverflow.com/users/402366/paulo-morgado"}, "is_accepted": false, "score": 1, "last_activity_date": 1436429478, "creation_date": 1436429478, "answer_id": 31311725, "question_id": 31304614, "link": "https://stackoverflow.com/questions/31304614/async-await-exception-catching-which-thread-am-i-on/31311725#31311725", "title": "async await exception catching - which thread am I on?", "body": "<p>Instead of awaiting, you can call <code>Wait()</code> or <code>Result</code>, since you claim that there's no synchronization context, and, if the exception caught is <a href=\"https://msdn.microsoft.com/library/system.aggregateexception.aspx\" rel=\"nofollow\" title=\"AggregateException Class\"><code>AggregateException</code></a>, it was not thrown in the calling thread.</p>\n"}], "owner": {"reputation": 113291, "user_id": 234, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3a9ff49a9e689dcbfc8242f05180cc31?s=128&d=identicon&r=PG", "display_name": "Orion Edwards", "link": "https://stackoverflow.com/users/234/orion-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 31304646, "answer_count": 2, "score": 7, "last_activity_date": 1436446741, "creation_date": 1436392845, "last_edit_date": 1436427896, "question_id": 31304614, "link": "https://stackoverflow.com/questions/31304614/async-await-exception-catching-which-thread-am-i-on", "title": "async await exception catching - which thread am I on?", "body": "<p>I'd like to do something like this:</p>\n\n<pre><code>public async Task&lt;int&gt; DoWork(int parameter) {\n    try {\n        await OperationThatMayCompleteSynchronously(parameter);\n    } catch(Exception) e { \n        if(completedSynchronously)\n           doSyncThing();\n        else\n           doAsyncThing();\n    }\n}\n</code></pre>\n\n<p>Note: I'm running tasks on the thread pool, so there is no async context.</p>\n\n<p>I'd like to be able to tell the difference between an exception thrown immediately, and I'm still on the calling thread (e.g. <code>parameter</code> is invalid causing the function to abort), and an exception thrown when the async task completes, and I'm on some other random callback thread (e.g. network failure)</p>\n\n<p>I can work out how I might achieve this if I didn't use <code>await</code>, and just used <code>ContinueWith</code> on the async operation, but is it possible using <code>await</code>?</p>\n"}, {"tags": ["c#", ".net", "winforms"], "comments": [{"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 2, "creation_date": 1436392710, "post_id": 31304541, "comment_id": 50598813, "body": "Hey, you <a href=\"http://stackoverflow.com/a/7162873/21475\">found my related answer</a> :-)"}], "answers": [{"comments": [{"owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "edited": false, "score": 0, "creation_date": 1436395782, "post_id": 31304663, "comment_id": 50599983, "body": "@Manuel: You&#39;re getting a null reference exception because you&#39;re unconditionally doing <code>FindActivatedProcess().Name</code>, but <code>FindActivatedProcess()</code> returns <code>null</code> when no activated process could be found. You need to put the result in a variable (e.g. <code>proc</code>) first, then do something like <code>Text = proc == null ? &quot;&lt;none&gt;&quot; : proc.Name</code>."}], "tags": [], "owner": {"reputation": 85720, "user_id": 21475, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/003174af5095d12b7f9a5efc293eb041?s=128&d=identicon&r=PG", "display_name": "Cameron", "link": "https://stackoverflow.com/users/21475/cameron"}, "is_accepted": true, "score": 3, "last_activity_date": 1436393079, "last_edit_date": 1495539831, "creation_date": 1436393079, "answer_id": 31304663, "question_id": 31304541, "link": "https://stackoverflow.com/questions/31304541/how-do-i-return-a-false-or-true-each-process-so-i-can-monitor-if-the-process-is/31304663#31304663", "title": "How do i return a false or true each process so i can monitor if the process is in front or not?", "body": "<p>Instead of checking if each process is the activated one, you can find the activated process directly:</p>\n\n<pre><code>Process FindActivatedProcess()\n{\n    var activatedHandle = GetForegroundWindow();\n    if (activatedHandle == IntPtr.Zero)\n        return null;    // No window has focus\n\n    int activeProcId;\n    GetWindowThreadProcessId(activatedHandle, out activeProcId);\n    return Process.GetProcessById(activeProcId);\n}\n\n[DllImport(\"user32.dll\", CharSet = CharSet.Auto, ExactSpelling = true)]\nprivate static extern IntPtr GetForegroundWindow();\n\n[DllImport(\"user32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\nprivate static extern int GetWindowThreadProcessId(IntPtr handle, out int processId);\n</code></pre>\n\n<p>To determine when the activated application changes, you can do polling like you do now (though I suggest a larger interval -- 50ms seems like overkill to me), or you can <a href=\"https://stackoverflow.com/q/4407631/21475\">ask Windows to notify you when it happens</a>.</p>\n"}], "owner": {"reputation": 349, "user_id": 5081341, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d301b907273d15dd9a63288ed96b8b26?s=128&d=identicon&r=PG&f=1", "display_name": "Manuel Spechia", "link": "https://stackoverflow.com/users/5081341/manuel-spechia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1436431472, "accepted_answer_id": 31304663, "answer_count": 1, "score": -1, "last_activity_date": 1436395789, "creation_date": 1436392529, "last_edit_date": 1436395789, "question_id": 31304541, "link": "https://stackoverflow.com/questions/31304541/how-do-i-return-a-false-or-true-each-process-so-i-can-monitor-if-the-process-is", "closed_reason": "Needs details or clarity", "title": "How do i return a false or true each process so i can monitor if the process is in front or not?", "body": "<p>In form1 I have a timer:</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n        {\n            System.Windows.Forms.Timer t1 = new System.Windows.Forms.Timer();\n            t1.Interval = 50;\n            t1.Tick += new EventHandler(timer1_Tick);\n            t1.Enabled = true;\n        }\n</code></pre>\n\n<p>The tick event:</p>\n\n<pre><code>private void timer1_Tick(object sender, EventArgs e)\n        {\n           label4.Text =  SetProcessWindow.ApplicationIsActivated().ToString();           \n\n        }\n</code></pre>\n\n<p>And the ApplicationIsActivated method:</p>\n\n<pre><code>public static bool ApplicationIsActivated()\n        {\n\n            Process[] Processes = Process.GetProcesses();\n            foreach (Process SingleProcess in Processes)\n            {\n                var activatedHandle = GetForegroundWindow();\n                if (activatedHandle == IntPtr.Zero)\n                {\n                    return false;\n                }\n                var procId = SingleProcess.Id;//Process.GetCurrentProcess().Id;\n                int activeProcId;\n                GetWindowThreadProcessId(activatedHandle, out activeProcId);\n\n                return activeProcId == procId;\n            }            \n        }\n</code></pre>\n\n<p>I want somehow to monitor the processes and if I move any process to the front then show me it in label4 in form1.</p>\n\n<p>ApplicationIsActivated is not written good.\nFirst i'm not sure if making foreach each time is good and second i'm not sure how to return the activeProcId == procId; per process.</p>\n"}, {"tags": ["c#", "automapper"], "comments": [{"owner": {"reputation": 29640, "user_id": 1123123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c4f71e418588524bba4c9c0b3a7d393?s=128&d=identicon&r=PG", "display_name": "Sam I am says Reinstate Monica", "link": "https://stackoverflow.com/users/1123123/sam-i-am-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1436392959, "post_id": 31304518, "comment_id": 50598925, "body": "When you get the exception and visual studio opens the debugger, are you able to mouse over <code>x</code> and see what it&#39;s value is?"}, {"owner": {"reputation": 8910, "user_id": 4977957, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55ddc749972794b1664cbb5179f397b7?s=128&d=identicon&r=PG&f=1", "display_name": "VSO", "link": "https://stackoverflow.com/users/4977957/vso"}, "reply_to_user": {"reputation": 29640, "user_id": 1123123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c4f71e418588524bba4c9c0b3a7d393?s=128&d=identicon&r=PG", "display_name": "Sam I am says Reinstate Monica", "link": "https://stackoverflow.com/users/1123123/sam-i-am-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1436393434, "post_id": 31304518, "comment_id": 50599124, "body": "Good thought, but it&#39;s an automapper exception and I can&#39;t click out of it until I click &quot;Ok&quot; or whatever, at which point it moves on."}], "answers": [{"comments": [{"owner": {"reputation": 8910, "user_id": 4977957, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55ddc749972794b1664cbb5179f397b7?s=128&d=identicon&r=PG&f=1", "display_name": "VSO", "link": "https://stackoverflow.com/users/4977957/vso"}, "edited": false, "score": 0, "creation_date": 1436393169, "post_id": 31304583, "comment_id": 50599024, "body": "I am getting the following exception: &quot;Error 1909\tA lambda expression with a statement body cannot be converted to an expression tree&quot;, but that probably has to do with all our weird automapper usage and I understand how your answer would apply in a normal scenario. I will try the try/catch. Thank you very much for the answer."}, {"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 8910, "user_id": 4977957, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55ddc749972794b1664cbb5179f397b7?s=128&d=identicon&r=PG&f=1", "display_name": "VSO", "link": "https://stackoverflow.com/users/4977957/vso"}, "edited": false, "score": 0, "creation_date": 1436393328, "post_id": 31304583, "comment_id": 50599077, "body": "@VSO Hmm... I&#39;ve never used automapper before (honestly don&#39;t even know what it is), so I don&#39;t know how to fix your problem. I hope somebody else can help you with that!"}, {"owner": {"reputation": 29640, "user_id": 1123123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c4f71e418588524bba4c9c0b3a7d393?s=128&d=identicon&r=PG", "display_name": "Sam I am says Reinstate Monica", "link": "https://stackoverflow.com/users/1123123/sam-i-am-says-reinstate-monica"}, "reply_to_user": {"reputation": 8910, "user_id": 4977957, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55ddc749972794b1664cbb5179f397b7?s=128&d=identicon&r=PG&f=1", "display_name": "VSO", "link": "https://stackoverflow.com/users/4977957/vso"}, "edited": false, "score": 0, "creation_date": 1436393552, "post_id": 31304583, "comment_id": 50599163, "body": "@VSO for the sake of debugging, you might try changing it to <code>.Select(x =&gt; ...)</code>  If you&#39;re using Linq to sql or Entity Framework, or something like it, you might have to put a <code>.ToList()</code> before the <code>Select(...</code>"}, {"owner": {"reputation": 8910, "user_id": 4977957, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55ddc749972794b1664cbb5179f397b7?s=128&d=identicon&r=PG&f=1", "display_name": "VSO", "link": "https://stackoverflow.com/users/4977957/vso"}, "edited": false, "score": 1, "creation_date": 1436393557, "post_id": 31304583, "comment_id": 50599167, "body": "@JashaszunIt&#39;s: All good, you were very helpful. I am sure a lot of people will find your reply useful for troubleshooting lambda (including in entity framework) and such.  In the meantime, if anyone else has any other ideas, that&#39;s cool."}, {"owner": {"reputation": 8910, "user_id": 4977957, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55ddc749972794b1664cbb5179f397b7?s=128&d=identicon&r=PG&f=1", "display_name": "VSO", "link": "https://stackoverflow.com/users/4977957/vso"}, "reply_to_user": {"reputation": 29640, "user_id": 1123123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4c4f71e418588524bba4c9c0b3a7d393?s=128&d=identicon&r=PG", "display_name": "Sam I am says Reinstate Monica", "link": "https://stackoverflow.com/users/1123123/sam-i-am-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1436393829, "post_id": 31304583, "comment_id": 50599270, "body": "@Sam: I am mapping from MongoDb to an entity view model, I will see what I can do with that. Ty for the suggestions!"}], "tags": [], "owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "is_accepted": true, "score": 2, "last_activity_date": 1436392709, "creation_date": 1436392709, "answer_id": 31304583, "question_id": 31304518, "link": "https://stackoverflow.com/questions/31304518/how-to-find-out-which-record-automapper-errors-out-on/31304583#31304583", "title": "How to Find Out Which Record Automapper Errors Out On?", "body": "<p>Well, you <em>can</em> actually put a <code>Debug.WriteLine()</code> in your lambda here. Simply make it a block instead of just an expression:</p>\n\n<pre><code>var processedRecords = await queriedRecords.Project(x =&gt;\n    {\n        System.Diagnostics.Debug.WriteLine(x);\n        return Mapper.Map&lt;BsonDocument, RecordViewModel&gt;(x);\n    }).ToListAsync();\n</code></pre>\n\n<p>You can also put a <code>try</code>/<code>catch</code> around the <code>Mapper.Map&lt;,&gt;()</code> call if you want to now.</p>\n"}], "owner": {"reputation": 8910, "user_id": 4977957, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55ddc749972794b1664cbb5179f397b7?s=128&d=identicon&r=PG&f=1", "display_name": "VSO", "link": "https://stackoverflow.com/users/4977957/vso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 31304583, "answer_count": 1, "score": 2, "last_activity_date": 1436392709, "creation_date": 1436392417, "question_id": 31304518, "link": "https://stackoverflow.com/questions/31304518/how-to-find-out-which-record-automapper-errors-out-on", "title": "How to Find Out Which Record Automapper Errors Out On?", "body": "<p>I am using automapper. The code looks something like this:</p>\n\n<pre><code>var processedRecords = await queriedRecords.Project(x =&gt;   \n                               Mapper.Map&lt;BsonDocument, RecordViewModel&gt;(x)).ToListAsync();\n</code></pre>\n\n<p>My problem is that I cannot put System.Diagnostics.Debug.WriteLine() inside the map definition. Is there any way to know which record automapper errors out on? The way I have been doing it is putting a break point in and clicking continue, but now I am working with a db with millions of records, so obviously that's not practical. </p>\n\n<p>The exception is \"Object reference not set to an instance of an object.\" Which I assume means that the object doesn't have the property I am trying to map, but it's irrelevant to the q. More interested in the theory here. </p>\n"}, {"tags": ["c#", "multithreading", "windows-services"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1436392176, "post_id": 31304415, "comment_id": 50598558, "body": "Thread off the heavy lifting, yes."}, {"owner": {"reputation": 27886, "user_id": 63333, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce32261b3151a207d5340154940410c8?s=128&d=identicon&r=PG", "display_name": "Lloyd", "link": "https://stackoverflow.com/users/63333/lloyd"}, "edited": false, "score": 0, "creation_date": 1436392361, "post_id": 31304415, "comment_id": 50598654, "body": "You dont really need to request additional time unless you&#39;re stopping the service and you need more time to dispose."}, {"owner": {"reputation": 1575, "user_id": 1828605, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b508e10e69c5abfe04f7a08a8f6813f1?s=128&d=identicon&r=PG", "display_name": "user1828605", "link": "https://stackoverflow.com/users/1828605/user1828605"}, "edited": false, "score": 0, "creation_date": 1436392411, "post_id": 31304415, "comment_id": 50598677, "body": "So, how can I make sure that the code runs again the next day (or every day)?"}, {"owner": {"reputation": 27886, "user_id": 63333, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce32261b3151a207d5340154940410c8?s=128&d=identicon&r=PG", "display_name": "Lloyd", "link": "https://stackoverflow.com/users/63333/lloyd"}, "edited": false, "score": 2, "creation_date": 1436392480, "post_id": 31304415, "comment_id": 50598707, "body": "You&#39;d be better off using something like a console application and just scheduling it with a scheduled task."}, {"owner": {"reputation": 1575, "user_id": 1828605, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b508e10e69c5abfe04f7a08a8f6813f1?s=128&d=identicon&r=PG", "display_name": "user1828605", "link": "https://stackoverflow.com/users/1828605/user1828605"}, "edited": false, "score": 0, "creation_date": 1436392486, "post_id": 31304415, "comment_id": 50598710, "body": "So, if I understand it correctly, I spawn a thread for <code>this.RunService()</code>, and make the thread sleep for 24hrs?"}, {"owner": {"reputation": 1575, "user_id": 1828605, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b508e10e69c5abfe04f7a08a8f6813f1?s=128&d=identicon&r=PG", "display_name": "user1828605", "link": "https://stackoverflow.com/users/1828605/user1828605"}, "reply_to_user": {"reputation": 27886, "user_id": 63333, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce32261b3151a207d5340154940410c8?s=128&d=identicon&r=PG", "display_name": "Lloyd", "link": "https://stackoverflow.com/users/63333/lloyd"}, "edited": false, "score": 0, "creation_date": 1436392680, "post_id": 31304415, "comment_id": 50598796, "body": "@Lloyd, that&#39;s a good thought. Perhaps I should try to do it in console application. Thanks"}, {"owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1436392890, "post_id": 31304415, "comment_id": 50598895, "body": "why don&#39;t you create a timer in OnStart? and do the work in tick handler"}], "answers": [{"comments": [{"owner": {"reputation": 1575, "user_id": 1828605, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b508e10e69c5abfe04f7a08a8f6813f1?s=128&d=identicon&r=PG", "display_name": "user1828605", "link": "https://stackoverflow.com/users/1828605/user1828605"}, "edited": false, "score": 0, "creation_date": 1436416118, "post_id": 31305030, "comment_id": 50605223, "body": "Thanks @Lloyd for your suggestion. I&#39;ve upvoted your comment. I think this answer is what I needed. I wasn&#39;t sure how to do it in windows service. I&#39;m going to give it a try and get it working using windows service, since I&#39;ll need to make windows service for my other project anyway."}], "tags": [], "owner": {"reputation": 61, "user_id": 5042281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/405ba29f80eae30181ce1ebf5ebbb2af?s=128&d=identicon&r=PG&f=1", "display_name": "poprogrammer", "link": "https://stackoverflow.com/users/5042281/poprogrammer"}, "is_accepted": true, "score": 2, "last_activity_date": 1436395281, "last_edit_date": 1436395281, "creation_date": 1436394947, "answer_id": 31305030, "question_id": 31304415, "link": "https://stackoverflow.com/questions/31304415/how-to-create-a-scheduled-long-running-process-using-windows-service-in-c/31305030#31305030", "title": "How to create a scheduled long running process using windows service in c#", "body": "<p>Your situation might be better suited for a scheduled task as Lloyd said in the comments above. But if you really want to use a Windows service, this is what you would need to add/update in your service code. This will allow your service to list as started and not timeout on you. You can adjust the timer length to suit your needs.</p>\n\n<pre><code>private Timer processingTimer;\n\npublic YourService()\n{\n    InitializeComponent();\n    //Initialize timer\n    processingTimer = new Timer(60000); //Set to run every 60 seconds\n    processingTimer.Elapsed += processingTimer_Elapsed;\n    processingTimer.AutoReset = true;\n    processingTimer.Enabled = true;\n}\nprivate void processingTimer_Elapsed(object sender, ElapsedEventArgs e)\n{\n    //Check the time\n    if (timeCheck &amp;&amp; haventRunToday)\n        //Run your code\n        //You should probably still run this as a separate thread\n        this.RunService();\n}\nprotected override void OnStart(string[] args)\n{\n    //Start the timer\n    processingTimer.Start();\n}\nprotected override void OnStop()\n{\n    //Check to make sure that your code isn't still running... (if separate thread)\n\n    //Stop the timer\n    processingTimer.Stop();\n}\nprotected override void OnPause()\n{\n    //Stop the timer\n    processingTimer.Stop();\n}\nprotected override void OnContinue()\n{\n    //Start the timer\n    processingTimer.Start();\n}\n</code></pre>\n"}], "owner": {"reputation": 1575, "user_id": 1828605, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b508e10e69c5abfe04f7a08a8f6813f1?s=128&d=identicon&r=PG", "display_name": "user1828605", "link": "https://stackoverflow.com/users/1828605/user1828605"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 0, "accepted_answer_id": 31305030, "answer_count": 1, "score": 1, "last_activity_date": 1436395281, "creation_date": 1436392083, "last_edit_date": 1436392444, "question_id": 31304415, "link": "https://stackoverflow.com/questions/31304415/how-to-create-a-scheduled-long-running-process-using-windows-service-in-c", "title": "How to create a scheduled long running process using windows service in c#", "body": "<p>I want to create a windows service that performs some really long and heavy work. The code is inside OnStart method like this:</p>\n\n<pre><code>protected override void OnStart(string[] args)\n{\n    System.IO.File.WriteAllText(\n        @\"C:\\MMS\\Logs\\WinServiceLogs.txt\", \n        DateTime.Now + \"\\t MMS Service started.\"\n    );\n\n    this.RequestAdditionalTime(5*60*1000);           \n    this.RunService();\n}\n</code></pre>\n\n<p><code>this.RunService()</code> sends a request to WCF service library hosted on IIS. It does some really long processes, ranging from 1-20 min, depending on the data it has to process. This service that I'm writing is supposed to be scheduled to run every day in the morning. So far, it runs and works fine, but when the time goes over a few seconds or min, it generates timeout exception. This causes the windows service to be in unstable state, and I can't stop or uninstall it without restarting the computer. Since, I'm trying to create an automated system, this is an issue. </p>\n\n<p>I did do <code>this.RequestAdditionalTime()</code>, but I'm not sure whether it's doing what it's supposed to or not. I don't get the timeout error message, but now I don't know how to schedule it so it runs every day. If the exception occurs, then it won't run the next time. There were several articles and SO's I found, but there's something I'm missing and I can't understand it. </p>\n\n<p>Should I create a thread? Some articles say I shouldn't put heavy programs in OnStart, where should I put the heavy codes then? Right now, when the service starts, it does this huge data processing which makes the Windows Service status to \"Starting\", and it stays there for long time until either the program crashes due to timeout, or completes successfully. How can I start the service, then set the status to <code>Running</code> while the code is running to do some data processing? </p>\n"}, {"tags": ["c#", "xml", "c#-4.0", "xml-parsing", "c#-3.0"], "answers": [{"tags": [], "owner": {"reputation": 5456, "user_id": 502395, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GesJX.jpg?s=128&g=1", "display_name": "venerik", "link": "https://stackoverflow.com/users/502395/venerik"}, "is_accepted": false, "score": 0, "last_activity_date": 1436394960, "creation_date": 1436394960, "answer_id": 31305034, "question_id": 31304307, "link": "https://stackoverflow.com/questions/31304307/cast-or-convert-xmlnodelist-to-xmlnode/31305034#31305034", "title": "cast or convert XmlNodeList to XmlNode", "body": "<p>There is no such thing as casting an <code>XmlNodeList</code> to an <code>XmlNode</code>. An <code>XmlNodeList</code> is, as the name suggests, a list of <code>XmlNode</code>s. So, if you want to do something with the <code>XmlNode</code>s in the list, you will have to go through the list and perform some action on every node in that list. </p>\n\n<p>In your case, I suspect <code>GetDetailPageSectionBySA</code> could return multiple sections from the bill. If so, you could add a <code>foreach</code> loop:</p>\n\n<pre><code>foreach (GetBillForCAResponse eBillResponse in eBillResponseList)\n{\n   // removed code for brevity\n\n   foreach(var saDetailedPageNode =x mlBillParser.GetDetailPageSectionBySA(requestSA, xmlBill)\n   {\n       var customerBill = new CustomerBill();\n       customerBill.IsSurepay = XmlBillParser.GetSurepayFlagFromBill(document);\n       customerBill.ServiceAddress = XmlBillParser.GetServiceAddress(requestSA, document);\n       customerBill.MonthName = XmlBillParser.GetBillStatementDate(requestSA, xmlBill);\n       customerBill.EqCurPlanBal = XmlBillParser.GetEqualizerCurrentPlanBalance(document);\n       customerBill.EqPymntDue = XmlBillParser.GetEqualizerPaymentDue(document);\n\n       customerBill.Service = GetServiceAccountUsageAndBillingDetail(requestSA, xmlBill, saDetailedPageNode)\n       response.Add(customerBill);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5068440, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3ee98879295df7a923321639cfff0ba?s=128&d=identicon&r=PG&f=1", "display_name": "robert kline", "link": "https://stackoverflow.com/users/5068440/robert-kline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 941, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436394960, "creation_date": 1436391621, "last_edit_date": 1436392601, "question_id": 31304307, "link": "https://stackoverflow.com/questions/31304307/cast-or-convert-xmlnodelist-to-xmlnode", "title": "cast or convert XmlNodeList to XmlNode", "body": "<p>Im having an issue with my code and was hoping i could get some assistance from you. I have a method that is of type XmlNodeList (GetDetailPageSectionBySA), now that method is used as one of the parameters in another method. But that method (GetServiceAccountusageAndBillingDetail) is expecting a type of XmlNode for that parameter(saDetailedPageNode). If i change that data type to XmlNodeList for that parameter then it messes up a whole bunch of stuff down the line where only XmlNode can be used. </p>\n\n<p>Why dont I just change the type of the first method (GetDetailPageSectionBySA) to XmlNode and solve all my issues you ask? Because that type can only return one node and that method returns a collection of nodes and needs to use XmlNodeList. </p>\n\n<p>So im just wondering if there is any ways to convert or cast XmlNodeList to XmlNode and if so how is it done?</p>\n\n<pre><code>foreach (GetBillForCAResponse eBillResponse in eBillResponseList)\n{\n   var statementDetailsResponse = GetStatementDetails(\n       new GetStatementDetailsRequest\n       {\n           BatchId = eBillResponse.BatchId,\n           CustomerAccountId = eBillResponse.CA.ToString(\"000000000\"),\n           StatementId = eBillResponse.CAS_NUM.ToString(\"0000\")\n       });\n\n   string xmlBill = statementDetailsResponse.StatementAsXML.ToString();\n   var document = new XmlDocument();\n   document.LoadXml(xmlBill);\n\n   ****var saDetailedPageNode = XmlBillParser.GetDetailPageSectionBySA(requestSA, xmlBill);// This is the method of type XmlNodeList\n   if (saDetailedPageNode == null) continue;\n\n   var customerBill = new CustomerBill();\n   customerBill.IsSurepay = XmlBillParser.GetSurepayFlagFromBill(document);\n   customerBill.ServiceAddress = XmlBillParser.GetServiceAddress(requestSA, document);\n   customerBill.MonthName = XmlBillParser.GetBillStatementDate(requestSA, xmlBill);\n   customerBill.EqCurPlanBal = XmlBillParser.GetEqualizerCurrentPlanBalance(document);\n   customerBill.EqPymntDue = XmlBillParser.GetEqualizerPaymentDue(document);\n\n   ****customerBill.Service = GetServiceAccountUsageAndBillingDetail(requestSA, xmlBill, saDetailedPageNode);// This is where the invalid argument is because saDetailedPageNode should be of type XmlNode\n   response.Add(customerBill);\n}\n</code></pre>\n\n<p>I have put **** where the issue is as well as comments on those lines. I am a beginner in coding and any help would be great. Thanks in advanced.</p>\n"}, {"tags": ["c#", "entity-framework", "ef-code-first", "database-connection", "connection-string"], "answers": [{"tags": [], "owner": {"reputation": 1127, "user_id": 1379704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/55142aaa62409dd78e577b30b8efd628?s=128&d=identicon&r=PG", "display_name": "brian4342", "link": "https://stackoverflow.com/users/1379704/brian4342"}, "is_accepted": false, "score": 0, "last_activity_date": 1436392502, "creation_date": 1436392502, "answer_id": 31304535, "question_id": 31304282, "link": "https://stackoverflow.com/questions/31304282/getting-a-system-invalidoperationexception-when-changing-the-connection-string/31304535#31304535", "title": "Getting a &#39;System.InvalidOperationException&#39; when changing the connection string for connecting to a database C#", "body": "<p>SOLVED</p>\n\n<p>There was an error in the connection sting, I had forgotten to add '\\SQLEXPRESS'</p>\n\n<pre><code>&lt;connectionStrings&gt;\n&lt;add name=\"BehaviourConnectionString\"\nconnectionString=\"Data Source=.\\SQLEXPRESS;Initial Catalog=BehaviourDB-ByConnectionString;Integrated Security=true\"\nproviderName=\"System.Data.SqlClient\"/&gt;\n</code></pre>\n\n<p>.</p>\n"}], "owner": {"reputation": 1127, "user_id": 1379704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/55142aaa62409dd78e577b30b8efd628?s=128&d=identicon&r=PG", "display_name": "brian4342", "link": "https://stackoverflow.com/users/1379704/brian4342"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1591, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436392502, "creation_date": 1436391528, "last_edit_date": 1592644375, "question_id": 31304282, "link": "https://stackoverflow.com/questions/31304282/getting-a-system-invalidoperationexception-when-changing-the-connection-string", "title": "Getting a &#39;System.InvalidOperationException&#39; when changing the connection string for connecting to a database C#", "body": "<p>I am getting an unhandled exception of type 'System.InvalidOperationException' occurred in EntityFramework.dll when I run my application.</p>\n<p>My application is a basic C# application using entity framework code first approach and I am trying to connect to a database.</p>\n<p>The following code is used to add data to the database (which worked before I added a connection string to the App.Config file.</p>\n<pre><code>static void Main(string[] args)\n    {\n        using (var context = new BehaviourContext())\n        {\n            Behaviour behaviour = new Behaviour()\n            {\n                Name = &quot;test behaviour&quot;,\n                Activation_Threshold = 90,\n                Currently_Executing = false,\n                Preconditions_Met = false,\n                Priority = 0.9f\n            };\n            context.Behaviours.Add(behaviour);\n            context.SaveChanges();\n        }\n    }\n</code></pre>\n<p>This is my context class:</p>\n<pre><code>public class BehaviourContext: DbContext\n{\n    public BehaviourContext(): base(&quot;name=BehaviourConnectionString&quot;)\n    {\n\n    }\n    public DbSet&lt;Behaviour&gt; Behaviours { get; set; }\n}\n</code></pre>\n<p>This was working fine until I added a connection string:</p>\n<pre><code>&lt;connectionStrings&gt;\n&lt;add name=&quot;BehaviourConnectionString&quot;\nconnectionString=&quot;Data Source=.;Initial Catalog=BehaviourDB-ByConnectionString;Integrated Security=true&quot;\nproviderName=&quot;System.Data.SqlClient&quot;/&gt;\n</code></pre>\n  \n<p>And this is the full error I get when I run the application:</p>\n<blockquote>\n<p>An unhandled exception of type 'System.InvalidOperationException' occurred in EntityFramework.dll</p>\n<p>Additional information: The context cannot be used while the model is being created. This exception may be thrown if the context is used inside the OnModelCreating method or if the same context instance is accessed by multiple threads concurrently. Note that instance members of DbContext and related classes are not guaranteed to be thread safe.</p>\n</blockquote>\n<p>Any help, hints or tip will be greatly appreciated. :)</p>\n"}, {"tags": ["c#", "entity-framework", "asp.net-web-api"], "comments": [{"owner": {"reputation": 110, "user_id": 1361939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c97rz.jpg?s=128&g=1", "display_name": "Russ Wilson", "link": "https://stackoverflow.com/users/1361939/russ-wilson"}, "edited": false, "score": 0, "creation_date": 1436391782, "post_id": 31304236, "comment_id": 50598378, "body": "I&#39;m having trouble understanding your question.  Are you saying that if GetMember(...) is called with a id value of &#39;0&#39; that we should return a new default member object?  But, if the GetMember(...) method is called with something other than 0 we should try to find the corresponding member in the db.Members collection and return that?  If it&#39;s not found, then it should return &quot;NotFound()&quot;?"}, {"owner": {"reputation": 3940, "user_id": 4204026, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-m3Fign7XvCY/AAAAAAAAAAI/AAAAAAAAACo/OOBjG7fpC4g/photo.jpg?sz=128", "display_name": "Drew Kennedy", "link": "https://stackoverflow.com/users/4204026/drew-kennedy"}, "edited": false, "score": 0, "creation_date": 1436391790, "post_id": 31304236, "comment_id": 50598381, "body": "So you want the controller to create a new <code>member</code> object, and insert it as a record in the database if <code>member</code> turns out to be null? The question is all over the place, and really your attempt to achieve what it is you want provides no insight."}, {"owner": {"reputation": 1999, "user_id": 1995301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5u1Fy.jpg?s=128&g=1", "display_name": "Stefan Wanitzek", "link": "https://stackoverflow.com/users/1995301/stefan-wanitzek"}, "edited": false, "score": 0, "creation_date": 1436391803, "post_id": 31304236, "comment_id": 50598390, "body": "It&#39;s hard to understand what you are exactly asking for."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2577126"}, "edited": false, "score": 0, "creation_date": 1436393669, "post_id": 31304236, "comment_id": 50599202, "body": "Sorry for the confusion. Found it hard to explain my problem. But Yes what you both explained is  exactly what I&#39;m trying to achieve."}], "answers": [{"comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 2, "creation_date": 1436392979, "post_id": 31304428, "comment_id": 50598937, "body": "<i>&quot;or add to the database and get the member&quot;</i> see my <a href=\"http://stackoverflow.com/questions/31304236/get-method-specifically-to-handle-a-0-value/31304434?noredirect=1#comment50598723_31304488\">other comment</a>, you may not want to do that depending on why this method is called with id=0."}, {"owner": {"reputation": 490, "user_id": 1558859, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2K2fu.jpg?s=128&g=1", "display_name": "Jerode", "link": "https://stackoverflow.com/users/1558859/jerode"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1436393222, "post_id": 31304428, "comment_id": 50599048, "body": "@CodeCaster, I completely agree, it would not be a good idea to add this to a database."}, {"owner": {"reputation": 46655, "user_id": 1647604, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/de0a77110ab57284e2a8d57858f714a3?s=128&d=identicon&r=PG", "display_name": "DeborahK", "link": "https://stackoverflow.com/users/1647604/deborahk"}, "edited": false, "score": 1, "creation_date": 1436809565, "post_id": 31304428, "comment_id": 50756726, "body": "Not sure why the above code example is doing a find twice? Suggestion: Remove the first call to Find and instead just declare the member variable. Then only if the id &gt; 0 is it worth doing the find passing in the Id. If the Find then finds the item, the FirstOrDefault method should not be required?"}, {"owner": {"reputation": 490, "user_id": 1558859, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2K2fu.jpg?s=128&g=1", "display_name": "Jerode", "link": "https://stackoverflow.com/users/1558859/jerode"}, "reply_to_user": {"reputation": 46655, "user_id": 1647604, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/de0a77110ab57284e2a8d57858f714a3?s=128&d=identicon&r=PG", "display_name": "DeborahK", "link": "https://stackoverflow.com/users/1647604/deborahk"}, "edited": false, "score": 0, "creation_date": 1436810223, "post_id": 31304428, "comment_id": 50757126, "body": "@DeborahK has a good suggestion. I used what submitter had and just made the small change, do you need me to update my answer?"}], "tags": [], "owner": {"reputation": 490, "user_id": 1558859, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2K2fu.jpg?s=128&g=1", "display_name": "Jerode", "link": "https://stackoverflow.com/users/1558859/jerode"}, "is_accepted": false, "score": 2, "last_activity_date": 1436810461, "last_edit_date": 1436810461, "creation_date": 1436392127, "answer_id": 31304428, "question_id": 31304236, "link": "https://stackoverflow.com/questions/31304236/get-method-specifically-to-handle-a-0-value/31304428#31304428", "title": "Get method specifically to handle a 0 value", "body": "<p>Just initialize a new member object and return it to the calling method.</p>\n\n<pre><code>public IHttpActionResult GetMember(int id)\n{\n    Member member = new Member();\n    if (id &gt; 0)\n    {\n        var members = db.Members.Find();\n        member = members.FirstOrDefault((m) =&gt; m.MemberId == id);\n    }\n    else\n    {\n        // Set some values if you need Ok(new Member { MemberId = 0, FirstName = \"New\"} )\n    }\n\n    return Ok(member);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1436392794, "post_id": 31304434, "comment_id": 50598862, "body": "@CodeCaster, you could be correct. I edited the answer accordingly."}], "tags": [], "owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "is_accepted": false, "score": 2, "last_activity_date": 1436392736, "last_edit_date": 1436392736, "creation_date": 1436392144, "answer_id": 31304434, "question_id": 31304236, "link": "https://stackoverflow.com/questions/31304236/get-method-specifically-to-handle-a-0-value/31304434#31304434", "title": "Get method specifically to handle a 0 value", "body": "<p>I am not sure if I understand the goal, but this might do if I understand correctly:</p>\n\n<pre><code>public IHttpActionResult GetMember(int id)\n{\n    Member member = db.Members.Find(id);\n    if (member == null)\n    {\n        if (id != 0)\n        {\n            member = new Member();\n        }\n        else\n        {\n            return NotFound();\n        }\n    }\n    return Ok(member);\n}\n</code></pre>\n\n<p>Is that what you want?</p>\n"}, {"comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 1, "creation_date": 1436392521, "post_id": 31304488, "comment_id": 50598723, "body": "You don&#39;t want to save the default user immediately, that would create a new member in the database ever time a user opens the Add screen (at least I guess that&#39;s what this call is being used for). OP wants to <i>display</i> the Add Member screen with the defaults for registration or something."}, {"owner": {"reputation": 110, "user_id": 1361939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c97rz.jpg?s=128&g=1", "display_name": "Russ Wilson", "link": "https://stackoverflow.com/users/1361939/russ-wilson"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1436393296, "post_id": 31304488, "comment_id": 50599070, "body": "I agree with you that they may not want to save to the DB immediately, however it was happening in their original attempt, so I included it in the flow.  But, your are correct in your caution to add it immediately after creating the default value... you don&#39;t want thousands of users ending up in your database that are never actually used."}], "tags": [], "owner": {"reputation": 110, "user_id": 1361939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c97rz.jpg?s=128&g=1", "display_name": "Russ Wilson", "link": "https://stackoverflow.com/users/1361939/russ-wilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1436393369, "last_edit_date": 1436393369, "creation_date": 1436392302, "answer_id": 31304488, "question_id": 31304236, "link": "https://stackoverflow.com/questions/31304236/get-method-specifically-to-handle-a-0-value/31304488#31304488", "title": "Get method specifically to handle a 0 value", "body": "<pre><code>public IHttpActionResult GetMember(int id)\n{\n    Member member = null; \n\n    if(id == 0)\n    {\n        member = new Member();\n        // Set default member values here\n        // member.MemberId = 123456;\n        // member.Name = \"My Name\";\n        // set other default property values.......\n\n        // Depending on why you are calling this method w/ a '0', you may or may not want to execute these next two lines.  It's up to you.\n        db.Members.Add(member);\n        db.SaveChanges();  \n    }\n    else\n    {\n        member = db.Members.Where(m =&gt; m.MemberId == id).FirstOrDefault();\n    }\n\n    if (member == null)\n        return NotFound();\n\n    return Ok(member);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46655, "user_id": 1647604, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/de0a77110ab57284e2a8d57858f714a3?s=128&d=identicon&r=PG", "display_name": "DeborahK", "link": "https://stackoverflow.com/users/1647604/deborahk"}, "is_accepted": false, "score": 0, "last_activity_date": 1436809915, "creation_date": 1436809915, "answer_id": 31390144, "question_id": 31304236, "link": "https://stackoverflow.com/questions/31304236/get-method-specifically-to-handle-a-0-value/31390144#31390144", "title": "Get method specifically to handle a 0 value", "body": "<p>Here is the original code that this code was based on:</p>\n\n<pre><code>        public IHttpActionResult Get(int id)\n    {\n        try\n        {\n            Product product;\n            var productRepository = new ProductRepository();\n\n            if (id &gt; 0)\n            {\n                var products = productRepository.Retrieve();\n                product = products.FirstOrDefault(p =&gt; p.ProductId == id);\n                if (product == null)\n                {\n                    return NotFound();\n                }\n            }\n            else\n            {\n                product = productRepository.Create();\n            }\n            return Ok(product);\n        }\n        catch (Exception ex)\n        {\n            return InternalServerError(ex);\n        }\n    }\n</code></pre>\n\n<p>The requirement was to change from products to members and include EF. </p>\n\n<p>Consider retaining the use of the repository and adding the EF code in the repository class instead of here. \nAlso consider adding an overload to the repository retrieve method that would take in an id and locate the desired member. Then you could remove the call to FirstOrDefault here.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2577126"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1436810461, "creation_date": 1436391347, "last_edit_date": 1436550438, "question_id": 31304236, "link": "https://stackoverflow.com/questions/31304236/get-method-specifically-to-handle-a-0-value", "title": "Get method specifically to handle a 0 value", "body": "<p>In my web api controller method I have. </p>\n\n<pre><code>public IHttpActionResult GetMember(int id)\n    {\n        Member member = db.Members.Find(id);\n        if (member == null)\n        {\n            return NotFound();\n        }\n\n\n        return Ok(member);\n    }\n</code></pre>\n\n<p>Basically its checking here if there  is no current member with an id = 0, its returning NotFound ... and that is what the UI is receiving.</p>\n\n<p>The scenario is that for a 0 value the API should provide a new item with good defaults.Any examples on how to achieve this?</p>\n\n<p>I came up with this but not able to get it to work right.</p>\n\n<pre><code>public IHttpActionResult GetMember(int id)\n    {\n        Member member = db.Members.Find(id);\n        if (id &gt; 0)\n        {\n            var members = db.Members.Find();\n            member = members.FirstOrDefault((m) =&gt; m.MemberId == id);\n            //return NotFound();\n\n            if (member == null)\n            {\n                return NotFound();\n            }\n            else\n            {\n               db.Members.Add(member);\n                db.SaveChanges();\n\n            }\n            return Ok(member);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "razor", "dictionary"], "comments": [{"owner": {"reputation": 7165, "user_id": 479137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9aae86663c8906e056d2c1d6ce0e6cb?s=128&d=identicon&r=PG", "display_name": "David M&#229;rtensson", "link": "https://stackoverflow.com/users/479137/david-m%c3%a5rtensson"}, "edited": false, "score": 0, "creation_date": 1436391636, "post_id": 31304227, "comment_id": 50598309, "body": "Do you have a complete example for the Razor template including Model type definition?"}, {"owner": {"reputation": 1484, "user_id": 82812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4cf131857f3496224ac57b3948c5f1?s=128&d=identicon&r=PG", "display_name": "Jerry Federspiel", "link": "https://stackoverflow.com/users/82812/jerry-federspiel"}, "edited": false, "score": 0, "creation_date": 1436391805, "post_id": 31304227, "comment_id": 50598392, "body": "If you make a class that has Month, MonthlyAmount, and TotalYearAmount members instead of using an anonymous type, @item.Value.Month will work.  Is there a reason not to replace the anonymous type with a class?"}, {"owner": {"reputation": 7165, "user_id": 479137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9aae86663c8906e056d2c1d6ce0e6cb?s=128&d=identicon&r=PG", "display_name": "David M&#229;rtensson", "link": "https://stackoverflow.com/users/479137/david-m%c3%a5rtensson"}, "reply_to_user": {"reputation": 1484, "user_id": 82812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4cf131857f3496224ac57b3948c5f1?s=128&d=identicon&r=PG", "display_name": "Jerry Federspiel", "link": "https://stackoverflow.com/users/82812/jerry-federspiel"}, "edited": false, "score": 0, "creation_date": 1436391961, "post_id": 31304227, "comment_id": 50598473, "body": "@Jerry Federspiel Add that as an answer :D"}], "answers": [{"tags": [], "owner": {"reputation": 23953, "user_id": 469533, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/CQueM.jpg?s=128&g=1", "display_name": "Aducci", "link": "https://stackoverflow.com/users/469533/aducci"}, "is_accepted": false, "score": 0, "last_activity_date": 1436392424, "creation_date": 1436392424, "answer_id": 31304520, "question_id": 31304227, "link": "https://stackoverflow.com/questions/31304227/displaying-values-from-a-dictionary-within-a-dictionary-within-mvc-razor-view/31304520#31304520", "title": "Displaying values from a Dictionary within a Dictionary within MVC Razor view", "body": "<p>You can use <code>dynamic</code> instead of <code>var</code> like this:</p>\n\n<pre><code> @foreach (dynamic item in Model.MyDictionary[0][1])\n { \n     @item.Value.TotalYearAmount \n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3119, "user_id": 3175526, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dL8dY.jpg?s=128&g=1", "display_name": "JoshYates1980", "link": "https://stackoverflow.com/users/3175526/joshyates1980"}, "edited": false, "score": 0, "creation_date": 1436455031, "post_id": 31305162, "comment_id": 50630151, "body": "Interesting...so how would I reference my dictionary within my View?"}, {"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "reply_to_user": {"reputation": 3119, "user_id": 3175526, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dL8dY.jpg?s=128&g=1", "display_name": "JoshYates1980", "link": "https://stackoverflow.com/users/3175526/joshyates1980"}, "edited": false, "score": 0, "creation_date": 1436455921, "post_id": 31305162, "comment_id": 50630777, "body": "Just like you have written: <code>@item.Value.TotalYearAmount</code>"}, {"owner": {"reputation": 3119, "user_id": 3175526, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dL8dY.jpg?s=128&g=1", "display_name": "JoshYates1980", "link": "https://stackoverflow.com/users/3175526/joshyates1980"}, "edited": false, "score": 0, "creation_date": 1436464883, "post_id": 31305162, "comment_id": 50636351, "body": "Thank you so much!  I&#39;ve never heard of the ExpandoObject class.  I got my code working.....(it&#39;s kinda ugly), but for what I&#39;m doing you helped me out."}], "tags": [], "owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "is_accepted": true, "score": 1, "last_activity_date": 1436395673, "creation_date": 1436395673, "answer_id": 31305162, "question_id": 31304227, "link": "https://stackoverflow.com/questions/31304227/displaying-values-from-a-dictionary-within-a-dictionary-within-mvc-razor-view/31305162#31305162", "title": "Displaying values from a Dictionary within a Dictionary within MVC Razor view", "body": "<p>Change your line </p>\n\n<pre><code>dict.Add(beginningYear, new { Month = 12, MonthlyAmount = nextYearAmount.premium, TotalYearAmount = TotalYearAmount });\n</code></pre>\n\n<p>with usage of <a href=\"https://msdn.microsoft.com/de-de/library/system.dynamic.expandoobject%28v=vs.110%29.aspx\" rel=\"nofollow\">ExpandoObject</a> to </p>\n\n<pre><code>dynamic expandoObject = new ExpandoObject();\nexpandoObject.Month = 12;\nexpandoObject.MonthlyAmount = nextYearAmount.premium;\nexpandoObject.TotalYearAmount = TotalYearAmount;\ndict.Add(beginningYear, expandoObject);\n</code></pre>\n\n<p>If your Dictionary is longer, you can use following link to convert it in a method: <a href=\"http://theburningmonk.com/2011/05/idictionarystring-object-to-expandoobject-extension-method/\" rel=\"nofollow\">http://theburningmonk.com/2011/05/idictionarystring-object-to-expandoobject-extension-method/</a></p>\n"}], "owner": {"reputation": 3119, "user_id": 3175526, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dL8dY.jpg?s=128&g=1", "display_name": "JoshYates1980", "link": "https://stackoverflow.com/users/3175526/joshyates1980"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "accepted_answer_id": 31305162, "answer_count": 2, "score": 0, "last_activity_date": 1436395673, "creation_date": 1436391321, "last_edit_date": 1436391476, "question_id": 31304227, "link": "https://stackoverflow.com/questions/31304227/displaying-values-from-a-dictionary-within-a-dictionary-within-mvc-razor-view", "title": "Displaying values from a Dictionary within a Dictionary within MVC Razor view", "body": "<p>I'm not even sure this is possible with MVC Razor, but I would like to pass my Dictionary that includes another Dictionary to my view and display the child Dictionary keys and values.</p>\n\n<pre><code>public Dictionary&lt;int, dynamic&gt; Getdata(DateInfo dataInfo)\n{\n\n//Create a parent dictionary\nDictionary&lt;int, dynamic&gt; parentDict = new Dictionary&lt;int, dynamic&gt;();\n\n//Load the child dictionary\nfor (int i = 0; i &lt; list.Count; i++)\n{\n     //Create a child dictionary to store all values\n     Dictionary&lt;int, dynamic&gt; dict = new Dictionary&lt;int, dynamic&gt;();\n\n     parentDict[i] = dict;\n     parentDict[i].Clear();\n    if (beginningYear &lt; DateTime.Now.Year)\n    {\n         //...code left out for brevity\n\n        if (NumberOfYears &gt; 1)\n        {\n            for(int j = 1; j &lt; NumberOfYears; j++)\n            {\n               beginningYear = beginningYear + 1;\n\n               //...code left out for brevity\n\n               dict.Add(beginningYear, new { Month = 12, MonthlyAmount = nextYearAmount.premium, TotalYearAmount = TotalYearAmount });\n            }\n        }\n     else\n     {\n         //...code left out for brevity\n     }\n}\nreturn parentDict;\n</code></pre>\n\n<p>My Parent Dictionary values looks like this:</p>\n\n<pre><code>[0] = {[0, System.Collections.Generic.Dictionary`2[System.Int32,System.Object]]}\n\n[1] = {[1, System.Collections.Generic.Dictionary`2[System.Int32,System.Object]]}\n</code></pre>\n\n<p>My Child Dictionary values like this:</p>\n\n<pre><code>[0] { Month = 5, MonthlyAmount = 99.90, TotalYearAmount = 499.50 }\n\n[1] { Month = 12, MonthlyAmount = 399.90, TotalYearAmount = 1499.50 }\n\n[2] { Month = 12, MonthlyAmount = 499.90, TotalYearAmount = 1794.50 }\n</code></pre>\n\n<hr>\n\n<pre><code>[0] { Month = 9, MonthlyAmount = 999.90, TotalYearAmount = 6499.50 }\n\n[1] { Month = 12, MonthlyAmount = 3.90, TotalYearAmount = 39.50 }\n</code></pre>\n\n<p>Within the view:</p>\n\n<pre><code> @foreach (var item in Model.MyDictionary[0])\n { \n     @item.Value\n }\n</code></pre>\n\n<p>That code will display the child value, which is:</p>\n\n<pre><code> { Month = 5, MonthlyAmount = 99.90, TotalYearAmount = 499.50 }\n</code></pre>\n\n<p>Is it possible to reference Month, MonthlyAmount, TotalYearAmount?</p>\n\n<pre><code>     @item.Value.Month \n</code></pre>\n\n<p>will not work.  'object' does not contain a definition for 'Month'</p>\n\n<p>And I would like to go through the parent dictionary to reference the child.  If I use:</p>\n\n<pre><code> @foreach (var item in Model.MyDictionary[1])\n { \n     @item.Value\n }\n</code></pre>\n\n<p>That will display</p>\n\n<pre><code> { Month = 9, MonthlyAmount = 999.90, TotalYearAmount = 6499.50 }\n</code></pre>\n\n<p>This code will not work, but I would like to get the values such as:</p>\n\n<pre><code> @foreach (var item in Model.MyDictionary[0][1])\n { \n     @item.Value.TotalYearAmount \n }\n</code></pre>\n\n<p>and the value displays:  1499.50</p>\n\n<p>Any advice is appreciated.</p>\n"}, {"tags": ["java", "c#", "dependency-injection", "di-containers"], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 3990042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6924e1c35a76565bbf51f5d6f7b7f41b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/3990042/jonas"}, "is_accepted": false, "score": 1, "last_activity_date": 1436397508, "creation_date": 1436397508, "answer_id": 31305489, "question_id": 31304214, "link": "https://stackoverflow.com/questions/31304214/di-container-vs-factories/31305489#31305489", "title": "DI-container vs. Factories", "body": "<p>The DI-Container can be seen as a big set of <em>intelligent</em> factory-methods, which is being configured using several ways (code,xml,auto-mapping). I called these factory-methods intelligent, because the container keeps track of its registered types and uses them for the creation of more complex objects. \nWhen using factories, you'll need to set these dependencies yourself, otherwise you're already using a dependency-container.</p>\n"}, {"comments": [{"owner": {"reputation": 31953, "user_id": 2528063, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5776e315b2aeae4338bee6b40ef1104d?s=128&d=identicon&r=PG", "display_name": "HimBromBeere", "link": "https://stackoverflow.com/users/2528063/himbrombeere"}, "edited": false, "score": 0, "creation_date": 1436768378, "post_id": 31344700, "comment_id": 50731715, "body": "But how does contaienr know WHEN to construct a new instance of any class?"}, {"owner": {"reputation": 46, "user_id": 5080209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9xwF.jpg?s=128&g=1", "display_name": "wunzsh", "link": "https://stackoverflow.com/users/5080209/wunzsh"}, "reply_to_user": {"reputation": 31953, "user_id": 2528063, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5776e315b2aeae4338bee6b40ef1104d?s=128&d=identicon&r=PG", "display_name": "HimBromBeere", "link": "https://stackoverflow.com/users/2528063/himbrombeere"}, "edited": false, "score": 0, "creation_date": 1436780421, "post_id": 31344700, "comment_id": 50738035, "body": "Of course, there should be explicit call to DI container and this should be done at some &quot;entry point&quot;. For example in web app this point is creating of controller where resolve is called:  container.Resolve&lt;ISomeController&gt;. But SomeController itself is ignorant that DI container is used. That is the essence of Composition Root pattern."}], "tags": [], "owner": {"reputation": 46, "user_id": 5080209, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D9xwF.jpg?s=128&g=1", "display_name": "wunzsh", "link": "https://stackoverflow.com/users/5080209/wunzsh"}, "is_accepted": true, "score": 3, "last_activity_date": 1436542213, "creation_date": 1436542213, "answer_id": 31344700, "question_id": 31304214, "link": "https://stackoverflow.com/questions/31304214/di-container-vs-factories/31344700#31344700", "title": "DI-container vs. Factories", "body": "<p>The whole point of DI containers is that you never need/should write code like </p>\n\n<pre><code>foo.Bar = myContainer.CreateDependency();\n</code></pre>\n\n<p>It is considered an antipattern. DI container should be used only once in Composition Root(it is a main DI container usage pattern).</p>\n\n<p>DI container automatically construct objects and inject dependencies via constructors or properties based on configuration. In case of Factory you have to do everything yourself. Beside creation DI containers provide you with:</p>\n\n<p>LifeTime management. So every time dependency is needed container might inject the same object(singleton lifetime), or return new everytime.</p>\n\n<p>Limited AOP capabilities such as method call interception and executing custom logic before and after methods.</p>\n\n<p>You might take a look into this book <a href=\"http://www.manning.com/seemann/\" rel=\"nofollow\">Dependency Injection in .NET</a>. It helped me a lot to understand DI containers, patterns of usage and Dependency injection in general.</p>\n"}, {"tags": [], "owner": {"reputation": 1175, "user_id": 273542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35d88f02a3d786384df011db91c16ae?s=128&d=identicon&r=PG", "display_name": "xeye", "link": "https://stackoverflow.com/users/273542/xeye"}, "is_accepted": false, "score": 0, "last_activity_date": 1436644624, "creation_date": 1436644624, "answer_id": 31361240, "question_id": 31304214, "link": "https://stackoverflow.com/questions/31304214/di-container-vs-factories/31361240#31361240", "title": "DI-container vs. Factories", "body": "<p>Ideally the code should be unaware it's running with DI. \nIt just externalizes its dependencies and assumes they're provided. </p>\n"}, {"tags": [], "owner": {"reputation": 728, "user_id": 1407544, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/15af6c9f81387924f91fd65a8bd13951?s=128&d=identicon&r=PG", "display_name": "Redwan", "link": "https://stackoverflow.com/users/1407544/redwan"}, "is_accepted": false, "score": 2, "last_activity_date": 1436646600, "creation_date": 1436646600, "answer_id": 31361528, "question_id": 31304214, "link": "https://stackoverflow.com/questions/31304214/di-container-vs-factories/31361528#31361528", "title": "DI-container vs. Factories", "body": "<p>You can see DI-container/library as a factory framework with lots of high-level object construction methods (via reflection). It is useful because usually you don't have to write any high-level method, for example, for loading plugin assemblies and getting plugin data types. But the downside is that reflection is slow and it is reasonable to use it during your application init phase. But, if you want to create lots of small objects with it during runtime, it will slow you down. </p>\n\n<p>On the other hand your own factories are custom made and usually contain list of concrete implementations and big switch-case, or map or something like that. They work faster but you have to write all object construction logic yourself.</p>\n\n<p>You don't have to choose between these two options you can combine them. For example, you can construct complex factories via DI</p>\n"}], "owner": {"reputation": 31953, "user_id": 2528063, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5776e315b2aeae4338bee6b40ef1104d?s=128&d=identicon&r=PG", "display_name": "HimBromBeere", "link": "https://stackoverflow.com/users/2528063/himbrombeere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 31344700, "answer_count": 4, "score": 4, "last_activity_date": 1436646600, "creation_date": 1436391255, "question_id": 31304214, "link": "https://stackoverflow.com/questions/31304214/di-container-vs-factories", "title": "DI-container vs. Factories", "body": "<p>I know there are many aricles and threads on Dependency Injection, but not as much on Depenedency-Injection-Containers. I found <a href=\"http://fabien.potencier.org/do-you-need-a-dependency-injection-container.html\" rel=\"nofollow\">this one by Fabien Potencier</a> quite helpful, although it targets PHP. However the more I read about those containers I come to the conclusion that such is none more then a simple collection of factory-methods, is this true?</p>\n\n<p>A deeper and more concrete view:\nWhen injecting a dependency to an object</p>\n\n<pre><code>foo.Bar = new Dependency();\n</code></pre>\n\n<p>I could also write</p>\n\n<pre><code>foo.Bar = new myFactory.CreateDependency();\n</code></pre>\n\n<p>or with a container</p>\n\n<pre><code>foo.Bar = myContainer.CreateDependency();\n</code></pre>\n\n<p>Here the container within the last approach does not have only one but many other methods to create other types also, so it is just a container for factory-methods, right?</p>\n"}, {"tags": ["c#", "asp.net", "arduino", "arduino-uno"], "comments": [{"owner": {"reputation": 500, "user_id": 5088220, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-4E0Ab3Ir4G8/AAAAAAAAAAI/AAAAAAAAABE/oz3MAPgAAig/photo.jpg?sz=128", "display_name": "Stian Sandve", "link": "https://stackoverflow.com/users/5088220/stian-sandve"}, "edited": false, "score": 1, "creation_date": 1436392183, "post_id": 31304180, "comment_id": 50598564, "body": "Are you able to print anything to your LCD at all? You should try to isolate the problem better. Pleasy verify that <code>outgoing[i].ToString()</code> is not empty, and that it is indeed being received at the Arduino side. If this is the case, you have a problem with the way you interact with your LCD or a hardware issue."}, {"owner": {"reputation": 417, "user_id": 4774832, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2dd6e6c2a9345082be9e38c94788e2d?s=128&d=identicon&r=PG&f=1", "display_name": "ardatosun", "link": "https://stackoverflow.com/users/4774832/ardatosun"}, "reply_to_user": {"reputation": 500, "user_id": 5088220, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-4E0Ab3Ir4G8/AAAAAAAAAAI/AAAAAAAAABE/oz3MAPgAAig/photo.jpg?sz=128", "display_name": "Stian Sandve", "link": "https://stackoverflow.com/users/5088220/stian-sandve"}, "edited": false, "score": 0, "creation_date": 1436393111, "post_id": 31304180, "comment_id": 50598998, "body": "Yes I can print to LCD with no problem. I debugged the C# side. When I check <code>outgoing</code> I see it has the username entered in the textbox but when I check <code>outgoing.[i].ToString()</code> I still see the whole username. Shouldn&#39;t it be the first letter of it instead?"}, {"owner": {"reputation": 417, "user_id": 4774832, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2dd6e6c2a9345082be9e38c94788e2d?s=128&d=identicon&r=PG&f=1", "display_name": "ardatosun", "link": "https://stackoverflow.com/users/4774832/ardatosun"}, "reply_to_user": {"reputation": 500, "user_id": 5088220, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-4E0Ab3Ir4G8/AAAAAAAAAAI/AAAAAAAAABE/oz3MAPgAAig/photo.jpg?sz=128", "display_name": "Stian Sandve", "link": "https://stackoverflow.com/users/5088220/stian-sandve"}, "edited": false, "score": 0, "creation_date": 1436393787, "post_id": 31304180, "comment_id": 50599251, "body": "If you meant if I got any output on LCD after logging in, yes i have 3 weird characters on first 3 columns on the first row which is still weird because I set the row value to 1 to print it on the 2nd row."}], "answers": [{"comments": [{"owner": {"reputation": 1380, "user_id": 675561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab1f8d1bd45b30c2e1cbe4ed74cd83c?s=128&d=identicon&r=PG", "display_name": "Graeme Wicksted", "link": "https://stackoverflow.com/users/675561/graeme-wicksted"}, "edited": false, "score": 0, "creation_date": 1475862339, "post_id": 31323369, "comment_id": 67129775, "body": "Ah yes!  This is very common with the 1402 displays.  Some even allow you to control the backlight using PWM (on pin 10/11 I think) or simply turn on/off (pin 13). Depends how the board is made -- follow the traces to see where they go."}, {"owner": {"reputation": 417, "user_id": 4774832, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2dd6e6c2a9345082be9e38c94788e2d?s=128&d=identicon&r=PG&f=1", "display_name": "ardatosun", "link": "https://stackoverflow.com/users/4774832/ardatosun"}, "reply_to_user": {"reputation": 1380, "user_id": 675561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab1f8d1bd45b30c2e1cbe4ed74cd83c?s=128&d=identicon&r=PG", "display_name": "Graeme Wicksted", "link": "https://stackoverflow.com/users/675561/graeme-wicksted"}, "edited": false, "score": 0, "creation_date": 1478527668, "post_id": 31323369, "comment_id": 68178444, "body": "@GraemeWicksted looking back, this question seems so silly lol. Thanks for the comment though."}], "tags": [], "owner": {"reputation": 417, "user_id": 4774832, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2dd6e6c2a9345082be9e38c94788e2d?s=128&d=identicon&r=PG&f=1", "display_name": "ardatosun", "link": "https://stackoverflow.com/users/4774832/ardatosun"}, "is_accepted": true, "score": 1, "last_activity_date": 1436503959, "last_edit_date": 1436503959, "creation_date": 1436459658, "answer_id": 31323369, "question_id": 31304180, "link": "https://stackoverflow.com/questions/31304180/how-to-send-data-from-asp-net-c-to-arduino-through-serial-and-print-it-on-lcd/31323369#31323369", "title": "How to send data from ASP.Net C# to Arduino through Serial and print it on LCD?", "body": "<p>I found out that the order of the pin numbers mattered. Changed the <code>LiquidCrystal lcd(4,5,6,7,8,9);</code> line to <code>LiquidCrystal lcd(8,9,4,5,6,7);</code> I can see the desired output now and there are no white cells on startup too.</p>\n"}], "owner": {"reputation": 417, "user_id": 4774832, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2dd6e6c2a9345082be9e38c94788e2d?s=128&d=identicon&r=PG&f=1", "display_name": "ardatosun", "link": "https://stackoverflow.com/users/4774832/ardatosun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1880, "favorite_count": 1, "accepted_answer_id": 31323369, "answer_count": 1, "score": 1, "last_activity_date": 1576930348, "creation_date": 1436391078, "last_edit_date": 1436394634, "question_id": 31304180, "link": "https://stackoverflow.com/questions/31304180/how-to-send-data-from-asp-net-c-to-arduino-through-serial-and-print-it-on-lcd", "title": "How to send data from ASP.Net C# to Arduino through Serial and print it on LCD?", "body": "<p>I have an ASP.Net page for login/register operations. What I'm trying to do is show the user name on LCD when the user logs in. The hardware I'm using is LCD Keypad Shield not just LCD if that matters. And the lovely Arduino UNO.</p>\n\n<p>C# side</p>\n\n<p>I tried storing the username in a char array and send to arduino one by one but the Serial.Write() gives error if I don't give a string to it. I wanted to send the whole name at once then, but Serial.Read() seems to be reading one at a time.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Web.Security;\nusing System.IO.Ports;\nusing System.Text;\nusing System.ComponentModel;\nusing System.Windows;\n\nnamespace EComm\n{\n    public partial class Login : System.Web.UI.Page\n    {\n        SerialPort sp;\n        protected void Page_Load(object sender, EventArgs e)\n        {\n            sp = new SerialPort();\n            sp.PortName = \"COM13\";\n            sp.BaudRate = 9600;\n            txtPass.TextMode = TextBoxMode.Password;\n        }\n\n        protected void Button1_Click(object sender, EventArgs e)\n        {\n            DBDataContext db = new DBDataContext();\n            db.Connection.Open();\n            var users = from allusers in db.Users select allusers;\n            foreach (User _user in users)\n            {\n                if (txtUser.Text == _user.UserName.Trim())\n                    if (txtPass.Text == _user.UserPassword.Trim())\n                    {\n                        Session[\"User\"] = _user.UserName;\n                        String outgoing = Session[\"User\"].ToString();\n                        for (int i = 0; i &lt; outgoing.Length; i++)\n                        {\n                            sp.Open();\n                            sp.Write(outgoing[i].ToString());\n                            sp.Close();\n                        }\n                        Response.Redirect(\"Default.aspx\");\n                    }\n            }\n        }\n</code></pre>\n\n<p>Arduino side</p>\n\n<pre><code>#include &lt;LiquidCrystal.h&gt;\nchar usrName[10];\nchar incomingChar;\nbyte index=0;\n\nLiquidCrystal lcd(4,5,6,7,8,9);\nint baud = 9600; \nint x=0;\nint y=0;\n\nvoid setup()\n{\n lcd.begin(16,2);\n lcd.setCursor(x,y); \n Serial.begin(baud);\n}\n\nvoid loop()\n{\n    while(Serial.available()&gt;0){\n    if(index&lt;10){\n      y=1;\n      incomingChar=Serial.read();\n      usrName[index]=incomingChar;\n      lcd.setCursor(x,y);\n      lcd.print(usrName[index]);\n      index++;\n      x++;\n    }\n}\n}\n</code></pre>\n\n<p>Both codes do not give any errors or warnings. When I upload the program to Arduino and run the login page, I am succesfully redirected to the page stated but nothing shows up on the LCD.</p>\n\n<p>Actually this is what I see after I login to the site. I have no idea why there are white cells, they just show up when I plug in the board. But when I upload an example program for keypad shield those cells just turn to normal.</p>\n\n<p><img src=\"https://i.stack.imgur.com/3cRjG.jpg\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/FsHXY.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c#", "asp.net-mvc", "azure", "servicebus", "azure-servicebus-queues"], "comments": [{"owner": {"reputation": 26702, "user_id": 1014217, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6zW1x.jpg?s=128&g=1", "display_name": "Luis Valencia", "link": "https://stackoverflow.com/users/1014217/luis-valencia"}, "edited": false, "score": 0, "creation_date": 1436390946, "post_id": 31304108, "comment_id": 50597971, "body": "brokeredMessage.ContentType is null, but I am sending it on the sendmessage"}, {"owner": {"reputation": 579, "user_id": 4020159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rXd13.jpg?s=128&g=1", "display_name": "Nicolas Dias", "link": "https://stackoverflow.com/users/4020159/nicolas-dias"}, "edited": false, "score": 0, "creation_date": 1436391589, "post_id": 31304108, "comment_id": 50598291, "body": "You can not pass a null value for the GetType method, ie brokeredMessage.ContentType is returning null."}, {"owner": {"reputation": 26702, "user_id": 1014217, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6zW1x.jpg?s=128&g=1", "display_name": "Luis Valencia", "link": "https://stackoverflow.com/users/1014217/luis-valencia"}, "reply_to_user": {"reputation": 579, "user_id": 4020159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rXd13.jpg?s=128&g=1", "display_name": "Nicolas Dias", "link": "https://stackoverflow.com/users/4020159/nicolas-dias"}, "edited": false, "score": 0, "creation_date": 1436392870, "post_id": 31304108, "comment_id": 50598884, "body": "and where is the error then?"}, {"owner": {"reputation": 1349, "user_id": 3590921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PjoWk.jpg?s=128&g=1", "display_name": "Jason Hogg - MSFT", "link": "https://stackoverflow.com/users/3590921/jason-hogg-msft"}, "edited": false, "score": 0, "creation_date": 1436650095, "post_id": 31304108, "comment_id": 50704765, "body": "You are using Service Bus Queues not Storage Queues. Updated the tags appropriately."}], "owner": {"reputation": 26702, "user_id": 1014217, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6zW1x.jpg?s=128&g=1", "display_name": "Luis Valencia", "link": "https://stackoverflow.com/users/1014217/luis-valencia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1436659263, "creation_date": 1436390799, "last_edit_date": 1436659263, "question_id": 31304108, "link": "https://stackoverflow.com/questions/31304108/value-cannot-be-null-r-nparameter-name-typename-when-receiving-queue-message", "title": "&quot;Value cannot be null.\\r\\nParameter name: typeName&quot; when receiving queue messages", "body": "<p>I have the error above</p>\n\n<p>\"Value cannot be null.\\r\\nParameter name: typeName\"</p>\n\n<p>this is the stack trace:</p>\n\n<pre><code>&gt;     \"   at System.RuntimeType.GetType(String typeName, Boolean throwOnError, Boolean ignoreCase, Boolean reflectionOnly,\n&gt; StackCrawlMark&amp; stackMark)\\r\\n   at System.Type.GetType(String\n&gt; typeName, Boolean throwOnError)\\r\\n   at\n&gt; x.QueueHelper.GetBody[T](BrokeredMessage brokeredMessage)\\r\\n   at\n&gt; x.QueueHelper.&lt;&gt;c.&lt;ReceiveMessage&gt;b__3_0(BrokeredMessage message)\"\n</code></pre>\n\n<p>The code I have is as follows</p>\n\n<p>I send a message like this without exceptions(this is controller action)</p>\n\n<pre><code>[HttpPost]\n        [ValidateAntiForgeryToken]\n        public ActionResult Create([Bind(Include=\"Id,Nombre,NIT,NombreRepresentanteLegal,TelefonoRepresentanteLegal,NombreContacto,TelefonoContacto,PropiedadesExtra\")] Empresa empresa)\n        {\n            if (ModelState.IsValid)\n            {\n                var propiedadesList = from formvalues in Request.Form.ToDictionary()\n                                      join propiedades in unitOfWork.PropiedadRepository.Get() on formvalues.Key equals propiedades.Nombre\n                                      where propiedades.Entidad.Nombre == \"Empresa\"\n                                      select new { Clave = formvalues.Key, Valor = formvalues.Value };\n                XElement el = new XElement(\"root\",propiedadesList.Select(kv =&gt; new XElement(kv.Clave, kv.Valor)));\n                empresa.PropiedadesExtra = el.ToString();\n\n                QueueHelper.SendMessage(\"Empresa\", empresa, queueConnectionString);\n                //unitOfWork.EmpresaRepository.Insert(empresa);\n                //unitOfWork.Save();\n\n                return RedirectToAction(\"Index\");\n            }\n\n            return View(empresa);\n        }\n</code></pre>\n\n<p>The SendMessage is like this:</p>\n\n<pre><code> public static void SendMessage&lt;T&gt;(string queuName, T objeto, string connectionString)\n        {\n            QueueClient Client =QueueClient.CreateFromConnectionString(connectionString, \"Empresa\");\n            BrokeredMessage message = new BrokeredMessage(objeto);\n            message.ContentType = objeto.GetType().Name;\n            Client.Send(new BrokeredMessage(message));\n        }\n</code></pre>\n\n<p>Then on a console application I want to receive the messages to process them.</p>\n\n<p>so I have this:</p>\n\n<pre><code>  static void Main(string[] args)\n        {\n            try\n            {\n                string connectionString = CloudConfigurationManager.GetSetting(\"Microsoft.ServiceBus.ConnectionString\");\n                Console.WriteLine(\"Press key to continue\");\n                Console.ReadKey();\n                QueueHelper.ReceiveMessage(\"Empresa\", connectionString);\n            }\n            catch (Exception ex)\n            {\n                throw ex;\n            }\n        }\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>public static void ReceiveMessage(string queuName, string connectionString)\n    {\n        QueueClient Client = QueueClient.CreateFromConnectionString(connectionString, \"Empresa\");\n\n        // Configure the callback options\n        OnMessageOptions options = new OnMessageOptions();\n        options.AutoComplete = false;\n        options.AutoRenewTimeout = TimeSpan.FromMinutes(1);\n\n        // Callback to handle received messages\n        Client.OnMessage((message) =&gt;\n        {\n            try\n            {\n                Empresa empresa = GetBody&lt;Empresa&gt;(message);\n                // Process message from queue\n                //Console.WriteLine(\"Body: \" + );\n                Console.WriteLine(\"MessageID: \" + message.MessageId);\n\n                // Remove message from queue\n                message.Complete();\n            }\n            catch (Exception ex)\n            {\n                // Indicates a problem, unlock message in queue\n                message.Abandon();\n            }\n        }, options);\n    }\n</code></pre>\n\n<p>and the GetBody method</p>\n\n<pre><code>public static T GetBody&lt;T&gt;(BrokeredMessage brokeredMessage)\n        {\n            var ct = brokeredMessage.ContentType;\n            Type bodyType = Type.GetType(ct, true);\n\n            var stream = brokeredMessage.GetBody&lt;Stream&gt;();\n            DataContractSerializer serializer = new DataContractSerializer(bodyType);\n            XmlDictionaryReader reader = XmlDictionaryReader.CreateBinaryReader(stream, XmlDictionaryReaderQuotas.Max);\n            object deserializedBody = serializer.ReadObject(reader);\n            T msgBase = (T)deserializedBody;\n            return msgBase;\n        }\n</code></pre>\n\n<p>apparently the problem is in this line:</p>\n\n<p>Type bodyType = Type.GetType(ct, true);</p>\n"}, {"tags": ["c#", "performance", "visual-c++", "compiler-optimization"], "comments": [{"owner": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1436391167, "post_id": 31304096, "comment_id": 50598085, "body": "Firstly, using a 64 bit compiler doesn&#39;t mean compiling <b>for</b> 64 bit computers. Secondly, what are you passing &quot;by value&quot; in C#? You say you pass an object which contains structures, but is this a value type or reference type?"}, {"owner": {"reputation": 742, "user_id": 2402806, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6bf1a2b8ad51ce1f4f3c9a3a1d911584?s=128&d=identicon&r=PG", "display_name": "&#198;&#240;elstan", "link": "https://stackoverflow.com/users/2402806/%c3%86%c3%b0elstan"}, "reply_to_user": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1436391423, "post_id": 31304096, "comment_id": 50598206, "body": "I meant that the target platform is 64-bit, sorry. The object is of reference type."}, {"owner": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 3, "creation_date": 1436391451, "post_id": 31304096, "comment_id": 50598221, "body": "Well that&#39;s hardly a fair comparison, as &quot;by value&quot; in C# with a reference type is not by value at all."}, {"owner": {"reputation": 742, "user_id": 2402806, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6bf1a2b8ad51ce1f4f3c9a3a1d911584?s=128&d=identicon&r=PG", "display_name": "&#198;&#240;elstan", "link": "https://stackoverflow.com/users/2402806/%c3%86%c3%b0elstan"}, "reply_to_user": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1436391587, "post_id": 31304096, "comment_id": 50598290, "body": "True, but the main point is why is the x64 build in C++ much slower than Win32."}, {"owner": {"reputation": 7072, "user_id": 1816262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IcKpN.png?s=128&g=1", "display_name": "OMGtechy", "link": "https://stackoverflow.com/users/1816262/omgtechy"}, "edited": false, "score": 0, "creation_date": 1436391694, "post_id": 31304096, "comment_id": 50598333, "body": "it depends on a lot of things, but I&#39;d imagine that in 32 bit mode it&#39;s using 32 bit bools, so it can pass 2 along the address bus or something like that"}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 1, "creation_date": 1436427047, "post_id": 31304096, "comment_id": 50610147, "body": "It is challenging to make a synthetic compiler test that has any bearing on real-world scenarios, and comparing C# directly to C++ for the same task is largely irrelevant. C# code is architecture neutral, JIT-based, and all about productivity. C++ development is architecture-specific, intended for high levels of control and low-level performance-sensitive development, and is compiled once to native code. Badly written C++ code is going to perform badly. Extremely well written C# is not going to match C++ performance for sufficiently complicated tasks."}, {"owner": {"reputation": 742, "user_id": 2402806, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6bf1a2b8ad51ce1f4f3c9a3a1d911584?s=128&d=identicon&r=PG", "display_name": "&#198;&#240;elstan", "link": "https://stackoverflow.com/users/2402806/%c3%86%c3%b0elstan"}, "edited": false, "score": 0, "creation_date": 1436441138, "post_id": 31304096, "comment_id": 50619475, "body": "I understand most of this, however the task is extremely simple I think, as it involves only basic arithmetic on bools and ints (mostly) on a large scale within a struct. I use the same struct in C# as in C++, one with a generic, the other with  a template. The point for me was comparing two ways of getting the same end result. Interesting point about C++ being architecture-specific. I&#39;ve googled and found a lot of ways to optimize C++ based on architecture, however I still can&#39;t understand why the x64 build performs so poorly."}], "answers": [{"comments": [{"owner": {"reputation": 6920, "user_id": 4394169, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aETL5.jpg?s=128&g=1", "display_name": "Vlad Feinstein", "link": "https://stackoverflow.com/users/4394169/vlad-feinstein"}, "edited": false, "score": 0, "creation_date": 1440451204, "post_id": 31362163, "comment_id": 52268969, "body": "First, you said &quot;C# 32 : 50% slower&quot;, now you are saying &quot;both are currently much worse than in C#&quot;. So which one is faster? Also, without seeing the code for both cases, any comparisons are kind of silly."}], "tags": [], "owner": {"reputation": 742, "user_id": 2402806, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6bf1a2b8ad51ce1f4f3c9a3a1d911584?s=128&d=identicon&r=PG", "display_name": "&#198;&#240;elstan", "link": "https://stackoverflow.com/users/2402806/%c3%86%c3%b0elstan"}, "is_accepted": true, "score": 0, "last_activity_date": 1436651169, "creation_date": 1436651169, "answer_id": 31362163, "question_id": 31304096, "link": "https://stackoverflow.com/questions/31304096/c-vs-c-32-bit-vs-64-bit-compiler-performance/31362163#31362163", "title": "C# vs C++ 32 bit vs 64 bit compiler performance", "body": "<p>Solved, I actually made the silly mistake of believing bool is initialized to false by default in C++, as it is it C#... </p>\n\n<p>In C++, the 32-bit application now has the same performance as the 64-bit one, even though both are currently much worse than in C#; there is probably something bad in my code!</p>\n"}], "owner": {"reputation": 742, "user_id": 2402806, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6bf1a2b8ad51ce1f4f3c9a3a1d911584?s=128&d=identicon&r=PG", "display_name": "&#198;&#240;elstan", "link": "https://stackoverflow.com/users/2402806/%c3%86%c3%b0elstan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 0, "accepted_answer_id": 31362163, "answer_count": 1, "score": 1, "last_activity_date": 1436651169, "creation_date": 1436390748, "last_edit_date": 1436442836, "question_id": 31304096, "link": "https://stackoverflow.com/questions/31304096/c-vs-c-32-bit-vs-64-bit-compiler-performance", "title": "C# vs C++ 32 bit vs 64 bit compiler performance", "body": "<p>I am writing a performance-critical program and I hesitate between C# which I am more familiar with or Visual C++. I've run several benchmark tests specific to the kind of operations I will need to use and the results puzzle me:\n(The reference for these tests is C++ Win32 build)</p>\n\n<p><strong>By reference</strong>\nC# 32 : 50% slower,\nC# 64 : 4% slower</p>\n\n<p><strong>By value</strong>\nC# 32 : 21% slower,\nC# 64 : 1% faster</p>\n\n<p>Building for x64 in Visual C++ is about 20-30 slower than building as Win32 with the same compiler options (optimized for speed).</p>\n\n<p>I am amazed at how the 64-bit C# compiler performs compared to its 32-bit counterpart. Why does the same not happen in Visual C++? Is the 64-bit compiler not optimized for 64-bit?</p>\n\n<p>In the benchmark I pass an object which has several imbricated structs as attributes.\nThe benchmark consists of a series of 50 imbricated if statements which test booleans contained in the structs. There are also no long types involved.\nI can post the code if needed, but I thought maybe this is just something I don't know about the compilers.</p>\n\n<p><strong>Edit</strong>: C++ Win32 is compiled with /MT for the best performance. I've tried compiling x64 with /MD and the performance is only about 6 times slower. <em>I also remember that when I ran the same test on a similar piece of code a year ago in VS2013, the x64 and Win32 builds performed the same as I remember...</em></p>\n"}, {"tags": ["c#", "asp.net", "vb.net", "excel", "vba"], "comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1436410196, "post_id": 31304064, "comment_id": 50603711, "body": "C# or Vb which one is it. According to code its not C#. Please fix the tags..."}], "answers": [{"tags": [], "owner": {"reputation": 856, "user_id": 1404038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/871378e0b9fac80c52dc519a75f1e101?s=128&d=identicon&r=PG", "display_name": "Sarin Vadakkey Thayyil", "link": "https://stackoverflow.com/users/1404038/sarin-vadakkey-thayyil"}, "is_accepted": false, "score": 1, "last_activity_date": 1436390997, "creation_date": 1436390997, "answer_id": 31304162, "question_id": 31304064, "link": "https://stackoverflow.com/questions/31304064/export-datatable-to-excel-file-xlsx/31304162#31304162", "title": "Export Datatable to Excel File (.XLSX)", "body": "<p>Your are creating a TSV - tab separated value.\nInstead .xlsx try using .tsv</p>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 4911512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IJhcB.png?s=128&g=1", "display_name": "Carey Tzou", "link": "https://stackoverflow.com/users/4911512/carey-tzou"}, "is_accepted": false, "score": -1, "last_activity_date": 1436393919, "creation_date": 1436393919, "answer_id": 31304815, "question_id": 31304064, "link": "https://stackoverflow.com/questions/31304064/export-datatable-to-excel-file-xlsx/31304815#31304815", "title": "Export Datatable to Excel File (.XLSX)", "body": "<p>If you want to export as excel, maybe you can the third-party lib NPOI to make a excel object.</p>\n"}], "owner": {"reputation": 73, "user_id": 4811783, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fe69ac067b63ebbe203a5c6175a18aa0?s=128&d=identicon&r=PG&f=1", "display_name": "Johnny Bravo", "link": "https://stackoverflow.com/users/4811783/johnny-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436393919, "creation_date": 1436390637, "last_edit_date": 1531161705, "question_id": 31304064, "link": "https://stackoverflow.com/questions/31304064/export-datatable-to-excel-file-xlsx", "title": "Export Datatable to Excel File (.XLSX)", "body": "<p>I use this code to export Datatable to excel file (.xlsx)</p>\n\n<pre><code>Dim attachment As String = \"attachment; filename=Excel.xlsx\"\n    Response.ClearContent()\n    Response.AddHeader(\"content-disposition\", attachment)\n    Response.ContentType = \"application/vnd.ms-excel\"\n    Dim tab As String = \"\"\n    For Each dc As DataColumn In dt.Columns\n        Response.Write(tab + dc.ColumnName)\n        tab = vbTab\n    Next\n    Response.Write(vbLf)\n\n    Dim i As Integer\n    For Each dr As DataRow In dt.Rows\n        tab = \"\"\n        For i = 0 To dt.Columns.Count - 1\n            Response.Write(tab &amp; dr(i).ToString())\n            tab = vbTab\n        Next\n        Response.Write(vbLf)\n    Next\n    Response.End()\n</code></pre>\n\n<p>When I download the file I get This message :</p>\n\n<p>\"Excel cannot open the file 'Excel.xlsx' because the file format or file extension is not valid \"</p>\n\n<p>I use Excel 2010</p>\n\n<p>Any Ideas why ?!</p>\n"}, {"tags": ["c#", "asp.net-web-api", "casting", "owin"], "owner": {"reputation": 2914, "user_id": 999571, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/85f2f801cfb39822bf9c807f80d80b35?s=128&d=identicon&r=PG", "display_name": "K. Alan Bates", "link": "https://stackoverflow.com/users/999571/k-alan-bates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 814, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1436393166, "creation_date": 1436390514, "last_edit_date": 1436393166, "question_id": 31304022, "link": "https://stackoverflow.com/questions/31304022/unable-to-cast-httprequestmessage-propertiesms-requestcontext-as-owinhttpreq", "title": "Unable to cast HttpRequestMessage.Properties[&quot;MS_RequestContext&quot;] as OwinHttpRequestContext at build time but valid at runtime", "body": "<p>I'm trying to manually fiddle with a property of my <code>MS_RequestContext</code> during Controller Activation inside my WebApi's CompositionRoot.</p>\n\n<p>My Create method receives a <code>System.Net.Http.HttpRequestMessage</code> argument.</p>\n\n<p>I can drill down request to grab</p>\n\n<pre>\nrequest.Properties[\"MS_RequestContext\"]\n</pre>\n\n<p>Properties is a <code>dictionary&lt;string,object&gt;</code>  That object will be an OwinHttpRequestContext at runtime.</p>\n\n<p>But whenever I attempt to cast, so that I can access the properties on the RequestContext, I get a nasty-gram from Visual Studio</p>\n\n<pre>\n(request.Properties[\"MS_RequestContext\"] as OwinHttpRequestContext).Request.Properties;\n</pre>\n\n<p>The error that comes back is:</p>\n\n<pre>\nThe type or namespace 'OwinHttpRequestContext' could not be found (are you missing a using directive or an assembly reference?)\n</pre>\n\n<p>OwinHttpRequestContext lives inside the System.Web.Http.Owin namespace. My references are all set up. I even have added a using statement for good measure.</p>\n\n<p>So the crazy part is that if I roll back my code that attempts to directly reference <code>request.Properties</code>, but instead set a breakpoint inside my Create method, I can -through a watch- execute</p>\n\n<pre>\n(request.Properties[\"MS_RequestContext\"] as System.Web.Http.Owin.OwinHttpRequestContext).Request.Properties\n</pre>\n\n<p>without issue.  I can confirm that I have no problem modifying the properties at runtime through the immediate window.</p>\n\n<pre>(request.Properties[\"MS_RequestContext\"] as System.Web.Http.Owin.OwinHttpRequestContext).Request.Properties.Add(\"Foo\",\"Bar\")</pre>\n\n<p>And the property \"Foo\" will be available to all of my MessageHandlers.</p>\n\n<p>Why am I not able to perform this same cast at build time?</p>\n"}, {"tags": ["c#", "if-statement", "boolean-logic"], "comments": [{"owner": {"reputation": 2076, "user_id": 2860193, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0793dc8385ef6af35cebe31c1ecc10ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathismyfriend", "link": "https://stackoverflow.com/users/2860193/deathismyfriend"}, "edited": false, "score": 2, "creation_date": 1436390336, "post_id": 31303948, "comment_id": 50597707, "body": "The error says it all."}, {"owner": {"reputation": 47, "user_id": 2620963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/13a12efd3944b7bc589810a72326f5ad?s=128&d=identicon&r=PG", "display_name": "Ryan Dwyer", "link": "https://stackoverflow.com/users/2620963/ryan-dwyer"}, "reply_to_user": {"reputation": 2076, "user_id": 2860193, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0793dc8385ef6af35cebe31c1ecc10ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathismyfriend", "link": "https://stackoverflow.com/users/2860193/deathismyfriend"}, "edited": false, "score": 0, "creation_date": 1436390343, "post_id": 31303948, "comment_id": 50597711, "body": "I realized I need the bool done = false; outside of the if statement, I did so. Still getting the error."}, {"owner": {"reputation": 47, "user_id": 2620963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/13a12efd3944b7bc589810a72326f5ad?s=128&d=identicon&r=PG", "display_name": "Ryan Dwyer", "link": "https://stackoverflow.com/users/2620963/ryan-dwyer"}, "reply_to_user": {"reputation": 2076, "user_id": 2860193, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0793dc8385ef6af35cebe31c1ecc10ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathismyfriend", "link": "https://stackoverflow.com/users/2860193/deathismyfriend"}, "edited": false, "score": 0, "creation_date": 1436390367, "post_id": 31303948, "comment_id": 50597723, "body": "Okay @deathismyfriend... how can I fix it?"}, {"owner": {"reputation": 8732, "user_id": 1874522, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1BXUD.png?s=128&g=1", "display_name": "peinearydevelopment", "link": "https://stackoverflow.com/users/1874522/peinearydevelopment"}, "edited": false, "score": 0, "creation_date": 1436390406, "post_id": 31303948, "comment_id": 50597741, "body": "What he is saying is that you don&#39;t have a loop anywhere, only an if statement(two actually). No while, or for statement, etc."}, {"owner": {"reputation": 2076, "user_id": 2860193, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0793dc8385ef6af35cebe31c1ecc10ba?s=128&d=identicon&r=PG&f=1", "display_name": "deathismyfriend", "link": "https://stackoverflow.com/users/2860193/deathismyfriend"}, "edited": false, "score": 0, "creation_date": 1436390565, "post_id": 31303948, "comment_id": 50597813, "body": "You have a continue that isn&#39;t inside the loop.  If you read the error it tells you exactly that. Remove the continue and there will be no error. Also to make code only run once you need to move the bool to outside of the method and make it global. If it is inside a loop then it needs to be moved outside of the loop. The done = true; should also be inside the if(!done) { } block."}, {"owner": {"user_type": "does_not_exist", "display_name": "user330606"}, "edited": false, "score": 1, "creation_date": 1436390642, "post_id": 31303948, "comment_id": 50597846, "body": "<code>The continue statement passes control to the next iteration of the enclosing while, do, for, or foreach statement in which it appears.</code> <a href=\"https://msdn.microsoft.com/en-us/library/923ahwt1.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/923ahwt1.aspx</a>  <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=7029\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=7029</a>. Then you shold use <code>if(!done){...}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 10183, "user_id": 9604, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3740b508fb7c60ad79d9bc43eb05c48e?s=128&d=identicon&r=PG", "display_name": "mxmissile", "link": "https://stackoverflow.com/users/9604/mxmissile"}, "is_accepted": true, "score": 2, "last_activity_date": 1436390523, "creation_date": 1436390523, "answer_id": 31304025, "question_id": 31303948, "link": "https://stackoverflow.com/questions/31303948/c-error-with-continue/31304025#31304025", "title": "C# Error with &#39;continue&#39;", "body": "<p>Depending on the class/method requirements, you could possibly reverse your logic:</p>\n\n<pre><code> if (!done)\n {\n   Console.WriteLine(\"Not done!\");\n   done = true;\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 1, "creation_date": 1436390893, "post_id": 31304068, "comment_id": 50597945, "body": "Seriously?  Done is a local variable you set to false.    Done does nothing in you your code."}, {"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "reply_to_user": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 0, "creation_date": 1436390964, "post_id": 31304068, "comment_id": 50597981, "body": "Of course you&#39;re right! I took this example as it is in the question. So I guess/hope this was just for making the code easier. Don&#39;t blame me."}], "tags": [], "owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1436390650, "creation_date": 1436390650, "answer_id": 31304068, "question_id": 31303948, "link": "https://stackoverflow.com/questions/31303948/c-error-with-continue/31304068#31304068", "title": "C# Error with &#39;continue&#39;", "body": "<p>You can't use a continue only inside a loop. So you must live without this:</p>\n\n<pre><code>int random = Program._random.Next(0, 133);\nif(random &lt; 33)\n{\n    bool done = false;\n    if(!done)\n    {\n        Console.WriteLine(\"Not done!\");\n        done = true;\n    }\n}\n</code></pre>\n\n<p>In this case, you should reverse the if with <code>if (!done) { ... }</code></p>\n"}, {"tags": [], "owner": {"reputation": 637210, "user_id": 69083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db0cdfd3fe268e270ec481a73046c2f?s=128&d=identicon&r=PG", "display_name": "Guffa", "link": "https://stackoverflow.com/users/69083/guffa"}, "is_accepted": false, "score": 0, "last_activity_date": 1436390718, "creation_date": 1436390718, "answer_id": 31304087, "question_id": 31303948, "link": "https://stackoverflow.com/questions/31303948/c-error-with-continue/31304087#31304087", "title": "C# Error with &#39;continue&#39;", "body": "<p>You can't use <code>continue</code> like that, it can only be used in a loop. The <code>continue</code> statement will go to the end of the loop and continue with the next iteration, without a loop there is no end of the loop to go to.</p>\n\n<p>You can use <code>else</code> instead:</p>\n\n<pre><code>if (done) {\n  // anything to do?\n} else {\n  Console.WriteLine(\"Not done!\");\n  done = true;\n}\n</code></pre>\n\n<p>If there is nothing to do if the variable is true, you can just reverse the expression instead:</p>\n\n<pre><code>if (!done) {\n  Console.WriteLine(\"Not done!\");\n  done = true;\n}\n</code></pre>\n\n<p>Note: You need to store the variable <code>done</code> outside the scope. Now you have a local variable that is always set to <code>false</code>, so the code will never be skipped.</p>\n"}, {"tags": [], "owner": {"reputation": 5514, "user_id": 3190758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MM5AT.jpg?s=128&g=1", "display_name": "grovesNL", "link": "https://stackoverflow.com/users/3190758/grovesnl"}, "is_accepted": false, "score": 0, "last_activity_date": 1436390733, "creation_date": 1436390733, "answer_id": 31304093, "question_id": 31303948, "link": "https://stackoverflow.com/questions/31303948/c-error-with-continue/31304093#31304093", "title": "C# Error with &#39;continue&#39;", "body": "<p>The exception is telling you that <a href=\"https://msdn.microsoft.com/en-us/library/923ahwt1.aspx\" rel=\"nofollow\"><code>continue</code></a> is ineffective here. It simply has nothing to do, and doesn't know <i>where</i> to continue. It is meant to be used within the iteration of a loop. </p>\n"}], "owner": {"reputation": 47, "user_id": 2620963, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/13a12efd3944b7bc589810a72326f5ad?s=128&d=identicon&r=PG", "display_name": "Ryan Dwyer", "link": "https://stackoverflow.com/users/2620963/ryan-dwyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 31304025, "answer_count": 4, "score": 0, "last_activity_date": 1436392102, "creation_date": 1436390270, "last_edit_date": 1436392102, "question_id": 31303948, "link": "https://stackoverflow.com/questions/31303948/c-error-with-continue", "title": "C# Error with &#39;continue&#39;", "body": "<p>I'm trying to use an if statement with a bool that will make it that if a code runs once it will not run again. Here is the code I am using.</p>\n\n<pre><code>int random = Program._random.Next(0, 133);\n\nif (random &lt; 33) {\n   bool done = false;\n\n   if(done)\n   {\n      continue; // Error is shown for this statement\n   }\n\n   Console.WriteLine(\"Not done!\");\n   done = true;\n}\n</code></pre>\n\n<p>The error that Visual Studio is displaying is: \"No enclosing loop out of which to break or continue\".</p>\n"}, {"tags": ["c#", "wpf", "wpf-controls"], "comments": [{"owner": {"reputation": 96748, "user_id": 74757, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/10331bb0b4eb995500acc85fb0d16aea?s=128&d=identicon&r=PG", "display_name": "C\u1d0f\u0280\u028f", "link": "https://stackoverflow.com/users/74757/c%e1%b4%8f%ca%80%ca%8f"}, "edited": false, "score": 0, "creation_date": 1436390851, "post_id": 31303913, "comment_id": 50597931, "body": "What you really want is a &quot;watermark&quot; or &quot;placeholder&quot; text that disappears when the user starts typing. Trying to build this logic around every single textbox is going to be ugly and unmaintainable. You could follow <a href=\"http://stackoverflow.com/a/836463/74757\">this answer</a> for a way to decorate a text box, <i>any</i> textbox, with this functionality, with very little markup."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 4971115, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60cd457a1d470216e59dd0e3a89f3180?s=128&d=identicon&r=PG&f=1", "display_name": "james andy", "link": "https://stackoverflow.com/users/4971115/james-andy"}, "edited": false, "score": 0, "creation_date": 1436454485, "post_id": 31304547, "comment_id": 50629751, "body": "I get error for (I think) the double quotes but then when I use single quotes ie pwd.PasswordChar = &#39; &#39;, i get error - Empty character literal.."}, {"owner": {"reputation": 67, "user_id": 4971115, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60cd457a1d470216e59dd0e3a89f3180?s=128&d=identicon&r=PG&f=1", "display_name": "james andy", "link": "https://stackoverflow.com/users/4971115/james-andy"}, "edited": false, "score": 0, "creation_date": 1436550206, "post_id": 31304547, "comment_id": 50677629, "body": "Since I got my desired result playing with your code. I am going to upvote you answer."}], "tags": [], "owner": {"reputation": 96, "user_id": 3618043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8de4147532f50431f7260bcfdac804a?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo F&#233;bolo", "link": "https://stackoverflow.com/users/3618043/pablo-f%c3%a9bolo"}, "is_accepted": true, "score": 0, "last_activity_date": 1436478585, "last_edit_date": 1436478585, "creation_date": 1436392553, "answer_id": 31304547, "question_id": 31303913, "link": "https://stackoverflow.com/questions/31303913/how-to-use-passchar-conditionally-in-c-login-form/31304547#31304547", "title": "How to use passchar conditionally in c# login form", "body": "<p>Play with empty string for PasswordChar and TextChanged event</p>\n\n<p>in vb.net</p>\n\n<pre><code>Private Sub pwd_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles pwd.TextChanged\n    If pwd.Text = \"enter password\" Then\n        pwd.PasswordChar = \"\"\n    Else\n        pwd.PasswordChar = \"*\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>in c#, probe this</p>\n\n<pre><code>    private void pwd_TextChanged(object sender, EventArgs e)\n    {\n        if (pwd.Text == \"enter password\")\n            pwd.PasswordChar = Convert.ToChar(0);\n        else if (pwd.Text == \"\")\n            pwd.Text = \"enter password\";\n        else\n           pwd.PasswordChar = '*'; \n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 4971115, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60cd457a1d470216e59dd0e3a89f3180?s=128&d=identicon&r=PG&f=1", "display_name": "james andy", "link": "https://stackoverflow.com/users/4971115/james-andy"}, "is_accepted": false, "score": 0, "last_activity_date": 1436456099, "creation_date": 1436456099, "answer_id": 31322073, "question_id": 31303913, "link": "https://stackoverflow.com/questions/31303913/how-to-use-passchar-conditionally-in-c-login-form/31322073#31322073", "title": "How to use passchar conditionally in c# login form", "body": "<p>This worked for me -</p>\n\n<pre><code>if (pwd.Text == \"enter password\" || pwd.Text == \"\")\n        {\n            //Do nothing. Enter Password text will be seen\n        }\n        else\n        {\n            pwd.PasswordChar = '*';\n        }\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4971115, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/60cd457a1d470216e59dd0e3a89f3180?s=128&d=identicon&r=PG&f=1", "display_name": "james andy", "link": "https://stackoverflow.com/users/4971115/james-andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 31304547, "answer_count": 2, "score": 0, "last_activity_date": 1436478585, "creation_date": 1436390158, "question_id": 31303913, "link": "https://stackoverflow.com/questions/31303913/how-to-use-passchar-conditionally-in-c-login-form", "title": "How to use passchar conditionally in c# login form", "body": "<p>I have created a login form where by default it shows text 'enter username' in user name text field when one clicks on password text field and vice versa shows 'enter password' when clicked on username text field</p>\n\n<p>Now I want to use pwd.passchar = \"*\" here. But password field doesn't shows 'enter password' as text but *****. It should display the text unless user starts typing actual password</p>\n\n<p>Here is my code - </p>\n\n<pre><code>public Login()\n    {\n        InitializeComponent();\n\n        if (pwd.Text == \"enter password\")\n        {             \n            // Don't show $$ in password text field\n        }\n        else\n        {\n            pwd.PasswordChar = '*';\n        }\n    }\n\n\n\nprivate void textBox1_Click(object sender, EventArgs e)\n    {\n        uname.Text = string.Empty;\n\n        if (string.IsNullOrWhiteSpace(pwd.Text))\n        {\n            pwd.Text = \"enter password\";\n        }\n\n    }\n\nprivate void textBox2_Click(object sender, EventArgs e)\n    {\n        pwd.Text = string.Empty;\n\n        if (string.IsNullOrWhiteSpace(uname.Text))\n        {\n            uname.Text = \"enter username\";\n</code></pre>\n\n<p>Please suggest changes...</p>\n"}, {"tags": ["c#", "dynamic-programming"], "comments": [{"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "edited": false, "score": 1, "creation_date": 1436391797, "post_id": 31303904, "comment_id": 50598385, "body": "This code does not even compile. How did you try it?"}, {"owner": {"reputation": 109546, "user_id": 38206, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4eea78103ba2306f23b41fd15b46228e?s=128&d=identicon&r=PG", "display_name": "Brian Rasmussen", "link": "https://stackoverflow.com/users/38206/brian-rasmussen"}, "edited": false, "score": 0, "creation_date": 1436391919, "post_id": 31303904, "comment_id": 50598454, "body": "I assume that <code>as as</code> is a typo."}, {"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "edited": false, "score": 0, "creation_date": 1436392109, "post_id": 31303904, "comment_id": 50598528, "body": "Yep, also words[]. This means probably, he didn&#39;t copy and paste it from editor."}, {"owner": {"reputation": 100, "user_id": 4790304, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eec073ea8c6eaba9cb8c47061b1a1b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Suhas Anjaria", "link": "https://stackoverflow.com/users/4790304/suhas-anjaria"}, "reply_to_user": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "edited": false, "score": 1, "creation_date": 1436414686, "post_id": 31303904, "comment_id": 50604832, "body": "Yup sorry, I corrected the code a few days ago on a WPF application I was working on, and got lazy to fire up another CLR to rewrite this. I will look into @Matt&#39;s answer and try to figure out the reason."}, {"owner": {"reputation": 679, "user_id": 4510219, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/VFMC9.jpg?s=128&g=1", "display_name": "Shubham Sharma", "link": "https://stackoverflow.com/users/4510219/shubham-sharma"}, "edited": false, "score": 0, "creation_date": 1436447605, "post_id": 31303904, "comment_id": 50624235, "body": "Dynamic programming??"}], "answers": [{"tags": [], "owner": {"reputation": 7194, "user_id": 2781524, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93088ac00f4ee4d9d9f4fc22f9294634?s=128&d=identicon&r=PG&f=1", "display_name": "Peheje", "link": "https://stackoverflow.com/users/2781524/peheje"}, "is_accepted": false, "score": 0, "last_activity_date": 1436391774, "creation_date": 1436391774, "answer_id": 31304340, "question_id": 31303904, "link": "https://stackoverflow.com/questions/31303904/expandoobject-quirky-behavior-while-adding-items-dynamically/31304340#31304340", "title": "ExpandoObject quirky behavior while adding items dynamically", "body": "<p>Your code doesn't run directly. I couldn't get the double as cast to work. And your string words[] didn't compile, so I changed it to string[] words.</p>\n\n<p>From there on the failing code gave me this valuable info:</p>\n\n<blockquote>\n  <p>Additional information: Cannot apply indexing with [] to an expression\n  of type 'System.Dynamic.ExpandoObject'</p>\n</blockquote>\n\n<p>Your second piece of code works, because you have an instance of IDictionary while the failing piece tries to call []-indexing operator on dynamic.</p>\n"}, {"comments": [{"owner": {"reputation": 100, "user_id": 4790304, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eec073ea8c6eaba9cb8c47061b1a1b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Suhas Anjaria", "link": "https://stackoverflow.com/users/4790304/suhas-anjaria"}, "edited": false, "score": 0, "creation_date": 1436414860, "post_id": 31304482, "comment_id": 50604879, "body": "But doesn&#39;t the ExpandoObject implement the IDictionary, IEnumerable and all that god stuff? I thought since the object instance of type dynamic has been set to be of a class  that implements certain interfaces, the compiler recognises them at Runtime?"}, {"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "reply_to_user": {"reputation": 100, "user_id": 4790304, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eec073ea8c6eaba9cb8c47061b1a1b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Suhas Anjaria", "link": "https://stackoverflow.com/users/4790304/suhas-anjaria"}, "edited": false, "score": 0, "creation_date": 1436433382, "post_id": 31304482, "comment_id": 50614138, "body": "I changed the answer. Actually I am a bit confused also, so I don&#39;t explain, just show some output the compiler does. Also the compiler is not executed anymore after compiling, so there is not possibility for it to recognize at runtime."}], "tags": [], "owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1436433238, "last_edit_date": 1495540272, "creation_date": 1436392279, "answer_id": 31304482, "question_id": 31303904, "link": "https://stackoverflow.com/questions/31303904/expandoobject-quirky-behavior-while-adding-items-dynamically/31304482#31304482", "title": "ExpandoObject quirky behavior while adding items dynamically", "body": "<p>This is not a real answer, but I try to show what the compiler does. So try out an easier version of your program:    </p>\n\n<pre><code>private static void Main(string[] args)\n{\n    Method1();\n    Method2();\n\n}\n\nprivate static void Method1()\n{\n    var expando = new ExpandoObject() as IDictionary&lt;string, object&gt;;\n    expando[\"key\"] = 1;\n}\n\nprivate static void Method2()\n{\n    dynamic expando = new ExpandoObject() as IDictionary&lt;string, object&gt;;\n    expando[\"key\"] = 1;\n}\n</code></pre>\n\n<p>Using <a href=\"http://ilspy.net/\" rel=\"nofollow noreferrer\">ILSpy</a> you can see, what the compiler creates, even before any runtime is used:</p>\n\n<pre><code>[CompilerGenerated]\nprivate static class &lt;Method2&gt;o__SiteContainer0\n{\n    public static CallSite&lt;Func&lt;CallSite, object, string, int, object&gt;&gt; &lt;&gt;p__Site1;\n}\nprivate static void Main(string[] args)\n{\n    Program.Method1();\n    Program.Method2();\n}\nprivate static void Method1()\n{\n    IDictionary&lt;string, object&gt; expando = new ExpandoObject();\n    expando[\"key\"] = 1;\n}\nprivate static void Method2()\n{\n    object expando = new ExpandoObject();\n    if (Program.&lt;Method2&gt;o__SiteContainer0.&lt;&gt;p__Site1 == null)\n    {\n        Program.&lt;Method2&gt;o__SiteContainer0.&lt;&gt;p__Site1 = CallSite&lt;Func&lt;CallSite, object, string, int, object&gt;&gt;.Create(Binder.SetIndex(CSharpBinderFlags.None, typeof(Program), new CSharpArgumentInfo[]\n        {\n            CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.None, null),\n            CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType | CSharpArgumentInfoFlags.Constant, null),\n            CSharpArgumentInfo.Create(CSharpArgumentInfoFlags.UseCompileTimeType | CSharpArgumentInfoFlags.Constant, null)\n        }));\n    }\n    Program.&lt;Method2&gt;o__SiteContainer0.&lt;&gt;p__Site1.Target(Program.&lt;Method2&gt;o__SiteContainer0.&lt;&gt;p__Site1, expando, \"key\", 1);\n}\n</code></pre>\n\n<p>Method1 should be very clear, since the compiler does only change the var to IDictionary and uses expando as expected.</p>\n\n<p>In Method2 here the compiler does the \"magic\". As stated in <a href=\"https://stackoverflow.com/a/26778625/1028957\">this answer</a> IDictionary is an explicit interface, which cannot accessed through the class instance. </p>\n\n<p>If you cast the dynamic to IDictionary, the compiler creates a very different code:</p>\n\n<pre><code>private static void Method3()\n{\n    dynamic expando = new ExpandoObject();\n    ((IDictionary&lt;string, object&gt;)expando)[\"key\"] = 1;\n}\n</code></pre>\n\n<p>will become </p>\n\n<pre><code>[CompilerGenerated]\nprivate static class &lt;Method3&gt;o__SiteContainer0\n{\n    public static CallSite&lt;Func&lt;CallSite, object, IDictionary&lt;string, object&gt;&gt;&gt; &lt;&gt;p__Site1;\n}\n\nprivate static void Method3()\n{\n    object expando = new ExpandoObject();\n    if (Program.&lt;Method3&gt;o__SiteContainer0.&lt;&gt;p__Site1 == null)\n    {\n        Program.&lt;Method3&gt;o__SiteContainer0.&lt;&gt;p__Site1 = CallSite&lt;Func&lt;CallSite, object, IDictionary&lt;string, object&gt;&gt;&gt;.Create(Binder.Convert(CSharpBinderFlags.ConvertExplicit, typeof(IDictionary&lt;string, object&gt;), typeof(Program)));\n    }\n    Program.&lt;Method3&gt;o__SiteContainer0.&lt;&gt;p__Site1.Target(Program.&lt;Method3&gt;o__SiteContainer0.&lt;&gt;p__Site1, expando)[\"key\"] = 1;\n}\n</code></pre>\n\n<p>As you can see, the CallSite now uses the type IDictionary. </p>\n"}], "owner": {"reputation": 100, "user_id": 4790304, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eec073ea8c6eaba9cb8c47061b1a1b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Suhas Anjaria", "link": "https://stackoverflow.com/users/4790304/suhas-anjaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 692, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1436433238, "creation_date": 1436390141, "question_id": 31303904, "link": "https://stackoverflow.com/questions/31303904/expandoobject-quirky-behavior-while-adding-items-dynamically", "title": "ExpandoObject quirky behavior while adding items dynamically", "body": "<p>So I'm using an ExpandoObject to add properties dynamically populated into a string. I am going to use these to bind to a DataGrid later. Given below are 2 variations of the code, which look like they are doing the same thing (to me atleast) but one fails and one doesn't. Can someone help me understand why this is?</p>\n\n<p><strong>Failed Code</strong></p>\n\n<pre><code>    dynamic dynamo = new ExpandoObject() as IDictionary&lt;string,object&gt;;\n    string words[] = basestring.Split('|');\n    foreach(string word in words)\n   {\n        dynamo[word] = word.ToUpperInvariant();\n   }\n</code></pre>\n\n<p><strong>Successful Code</strong></p>\n\n<pre><code> dynamic dynamo = new ExpandoObject();\n var dynamoose = dynamo as as IDictionary&lt;string,object&gt;; //Notice the cast\n string words[] = basestring.Split('|');\n foreach(string word in words)\n{\n   dynamoose[word] = word.ToUpperInvariant();\n}\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "asp.net-mvc-4"], "comments": [{"owner": {"reputation": 13318, "user_id": 1221684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f83137a1e0ee44a266b26d2ff01bc4?s=128&d=identicon&r=PG", "display_name": "JamieD77", "link": "https://stackoverflow.com/users/1221684/jamied77"}, "edited": false, "score": 0, "creation_date": 1436390634, "post_id": 31303897, "comment_id": 50597842, "body": "can you not make the int property nullable like <code>public int?</code>"}, {"owner": {"reputation": 2824, "user_id": 2869055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac2c7c67d2983e8db074cbb68daa86a1?s=128&d=identicon&r=PG", "display_name": "mwilczynski", "link": "https://stackoverflow.com/users/2869055/mwilczynski"}, "edited": false, "score": 0, "creation_date": 1436390635, "post_id": 31303897, "comment_id": 50597843, "body": "You can play with Model binder, you can set default value for this property, you can add a pair of values with <code>&quot;&quot; - 0</code> pair added to collection before you generate the view etc. Question is how do you create the view and how data model passed on there looks like?"}], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 1742344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c468edbcf088c807da9cc70308054dbe?s=128&d=identicon&r=PG", "display_name": "Garry", "link": "https://stackoverflow.com/users/1742344/garry"}, "is_accepted": true, "score": 25, "last_activity_date": 1461267034, "last_edit_date": 1461267034, "creation_date": 1436390623, "answer_id": 31304055, "question_id": 31303897, "link": "https://stackoverflow.com/questions/31303897/how-do-i-change-a-value-in-the-modelstate-so-that-it-will-be-valid-using-asp-n/31304055#31304055", "title": "How do I change a value in the ModelState, so that it will be valid, using ASP.NET MVC?", "body": "<p>Try using</p>\n\n<pre><code>ModelState.SetModelValue(\"PropertyID\", new ValueProviderResult(\"New value\", \"\", CultureInfo.InvariantCulture));\n</code></pre>\n\n<p>Here is a usefull article.</p>\n\n<p><a href=\"http://geekswithblogs.net/BobHardister/archive/2013/03/11/retain-and-set-posted-checkbox-value-in-the-mvc-4.aspx\" rel=\"noreferrer\">http://geekswithblogs.net/BobHardister/archive/2013/03/11/retain-and-set-posted-checkbox-value-in-the-mvc-4.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 4997287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51c1678c658d67e46b82d18da30039c5?s=128&d=identicon&r=PG&f=1", "display_name": "Louise", "link": "https://stackoverflow.com/users/4997287/louise"}, "edited": false, "score": 2, "creation_date": 1436392574, "post_id": 31304107, "comment_id": 50598750, "body": "Thanks, this was very useful to use after changing the value.  As I found when the value is changed, the related error still remains. :)"}], "tags": [], "owner": {"reputation": 13318, "user_id": 1221684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f83137a1e0ee44a266b26d2ff01bc4?s=128&d=identicon&r=PG", "display_name": "JamieD77", "link": "https://stackoverflow.com/users/1221684/jamied77"}, "is_accepted": false, "score": 9, "last_activity_date": 1436390795, "creation_date": 1436390795, "answer_id": 31304107, "question_id": 31303897, "link": "https://stackoverflow.com/questions/31303897/how-do-i-change-a-value-in-the-modelstate-so-that-it-will-be-valid-using-asp-n/31304107#31304107", "title": "How do I change a value in the ModelState, so that it will be valid, using ASP.NET MVC?", "body": "<p>you could just remove the error</p>\n\n<pre><code>if (ModelState.ContainsKey(\"{key}\"))\n    ModelState[\"{key}\"].Errors.Clear();\n\nif (ModelState.IsValid)\n{\n}\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4997287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51c1678c658d67e46b82d18da30039c5?s=128&d=identicon&r=PG&f=1", "display_name": "Louise", "link": "https://stackoverflow.com/users/4997287/louise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18367, "favorite_count": 1, "accepted_answer_id": 31304055, "answer_count": 2, "score": 12, "last_activity_date": 1461267034, "creation_date": 1436390108, "question_id": 31303897, "link": "https://stackoverflow.com/questions/31303897/how-do-i-change-a-value-in-the-modelstate-so-that-it-will-be-valid-using-asp-n", "title": "How do I change a value in the ModelState, so that it will be valid, using ASP.NET MVC?", "body": "<p>I am currently allowing a selectlist to have an initial value of \"\".  The user can choose whether to fill in this option or leave it on the default value.  </p>\n\n<p>This selectList works on an ID, where the ID is passed to my controller.  However, as an int is not being selected, the ModelState results in False as the input was an empty string rather than an int.</p>\n\n<p>I want to change the value of this empty string to be 0.  This would result in the ModelState being True.  I have been looking at the ModelState dictionary class, so that I can change the key, value pair before the ModelState is checked.   However, I have been unable to use this successfully.<br>\n<a href=\"https://msdn.microsoft.com/en-us/library/system.web.mvc.modelstatedictionary(v=vs.118).aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/system.web.mvc.modelstatedictionary(v=vs.118).aspx</a></p>\n\n<p>Any help would be greatly appreciated. </p>\n"}, {"tags": ["c#", "wpf", "xaml", "listbox"], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 4548093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39653e5b364726dea36c46660a6553e8?s=128&d=identicon&r=PG&f=1", "display_name": "sidjames", "link": "https://stackoverflow.com/users/4548093/sidjames"}, "is_accepted": false, "score": 0, "last_activity_date": 1436390944, "creation_date": 1436390944, "answer_id": 31304150, "question_id": 31303864, "link": "https://stackoverflow.com/questions/31303864/get-the-selected-color-from-colors-listbox/31304150#31304150", "title": "Get the selected color from Colors listBox", "body": "<p>Looking at your XAML, you haven't given the listbox you are trying to get the value from a name. As such I'm not sure why the code to get the selected colour isn't throwing an error.</p>\n\n<p>When I want to get a value from some form of ListView I do 2 things.</p>\n\n<p>First add a property in the view model, or code behind to hold the selected colour.</p>\n\n<pre><code>Color selectedColor {get; set;}\n</code></pre>\n\n<p>Then change the start of you ListBox XAML slightly so the selected value is bound to this property. So your XAML would start like this:</p>\n\n<pre><code>&lt;ListBox ItemsSource=\"{Binding Source={StaticResource colorPropertiesOdp}}\"\n    SelectedValue={Binding selectedColor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged\"}\n    ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\"\n    ScrollViewer.VerticalScrollBarVisibility=\"Auto\" &gt;\n</code></pre>\n\n<p>Then you should just be able to read the selected value from the 'selectedColor' property.</p>\n"}, {"comments": [{"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 4761, "user_id": 1561742, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/5OrRR.jpg?s=128&g=1", "display_name": "Moez Rebai", "link": "https://stackoverflow.com/users/1561742/moez-rebai"}, "edited": false, "score": 0, "creation_date": 1436391225, "post_id": 31304161, "comment_id": 50598108, "body": "@MoezRebai Thanks :). It took a bit of debugging and wondering what each object&#39;s <code>.ToString()</code> was telling me, but I&#39;m glad I could help you out. Thanks for making a fun question to answer!"}], "tags": [], "owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "is_accepted": true, "score": 2, "last_activity_date": 1436391488, "last_edit_date": 1436391488, "creation_date": 1436390995, "answer_id": 31304161, "question_id": 31303864, "link": "https://stackoverflow.com/questions/31303864/get-the-selected-color-from-colors-listbox/31304161#31304161", "title": "Get the selected color from Colors listBox", "body": "<p>That's because <code>listbox.SelectedItem</code> is of type <code>System.Reflection.PropertyInfo</code>. What it's referencing is the static property of the <code>System.Windows.Media.Color</code> class that holds the selected color.</p>\n\n<pre><code>System.Reflection.PropertyInfo prop = (System.Reflection.PropertyInfo)listbox.SelectedItem;\nColor color = (Color)prop.GetValue(null, null);\nstring colorName = prop.Name;\n</code></pre>\n\n<p><code>color</code> is then the <code>System.Windows.Media.Color</code> that was selected, and <code>colorName</code> is the name of the property (such as <code>Azure</code> or <code>Aquamarine</code>).</p>\n"}], "owner": {"reputation": 4761, "user_id": 1561742, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/5OrRR.jpg?s=128&g=1", "display_name": "Moez Rebai", "link": "https://stackoverflow.com/users/1561742/moez-rebai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 31304161, "answer_count": 2, "score": 1, "last_activity_date": 1436423811, "creation_date": 1436389985, "last_edit_date": 1436423811, "question_id": 31303864, "link": "https://stackoverflow.com/questions/31303864/get-the-selected-color-from-colors-listbox", "title": "Get the selected color from Colors listBox", "body": "<p>I'm trying to shows all colors in a <code>ListBox</code>. using that <a href=\"http://stuff.seans.com/2011/02/14/creating-a-listbox-that-shows-all-predefined-wpf-colors/\" rel=\"nofollow noreferrer\">example</a></p>\n\n<p>and here's the code </p>\n\n<pre><code>&lt;Window\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"d\"\n    xmlns:local=\"clr-namespace:WpfApplication1\"\n    xmlns:sys=\"clr-namespace:System;assembly=mscorlib\"\n    x:Class=\"WpfApplication1.MainWindow\"\n    x:Name=\"Window\"\n    Title=\"All Colors\"\n    Width=\"640\" Height=\"480\" &gt;\n\n    &lt;Window.Resources&gt;\n        &lt;ObjectDataProvider MethodName=\"GetType\"\n        ObjectType=\"{x:Type sys:Type}\" x:Key=\"colorsTypeOdp\"&gt;\n            &lt;ObjectDataProvider.MethodParameters&gt;\n                &lt;sys:String&gt;System.Windows.Media.Colors, PresentationCore,\n                Version=3.0.0.0, Culture=neutral,\n                PublicKeyToken=31bf3856ad364e35&lt;/sys:String&gt;\n            &lt;/ObjectDataProvider.MethodParameters&gt;\n        &lt;/ObjectDataProvider&gt;\n\n        &lt;ObjectDataProvider ObjectInstance=\"{StaticResource colorsTypeOdp}\"\n        MethodName=\"GetProperties\" x:Key=\"colorPropertiesOdp\"&gt;\n        &lt;/ObjectDataProvider&gt;\n    &lt;/Window.Resources&gt;\n\n    &lt;ListBox ItemsSource=\"{Binding Source={StaticResource colorPropertiesOdp}}\"\n        ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\"\n        ScrollViewer.VerticalScrollBarVisibility=\"Auto\" &gt;\n        &lt;ListBox.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;WrapPanel /&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ListBox.ItemsPanel&gt;\n        &lt;ListBox.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;StackPanel Orientation=\"Vertical\"&gt;\n                &lt;Rectangle Fill=\"{Binding Path=Name}\" Stroke=\"Black\" Margin=\"4\" StrokeThickness=\"1\" Height=\"50\" Width=\"81\"/&gt;\n                &lt;Label Content=\"{Binding Path=Name}\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListBox.ItemTemplate&gt;\n    &lt;/ListBox&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>I want to get the selected color from the <code>ListBox selectedItem</code> which is a <code>System.Windows.Media.Color</code>. But It always return null when I cast the selected Item to <code>Color</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/2eNIz.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c#", "azure", "azure-webjobs"], "answers": [{"tags": [], "owner": {"reputation": 2846, "user_id": 1979800, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/650f7e5dbd2d8ca3871b2fd90db64b40?s=128&d=identicon&r=PG", "display_name": "Sandesh", "link": "https://stackoverflow.com/users/1979800/sandesh"}, "is_accepted": true, "score": 1, "last_activity_date": 1438945567, "creation_date": 1438945567, "answer_id": 31876233, "question_id": 31303851, "link": "https://stackoverflow.com/questions/31303851/pass-value-from-app-config-from-one-console-application-to-one-class-library/31876233#31876233", "title": "pass value from app.config from one console application to one class library", "body": "<p>Using reflection you might be able to get hold of the application configuration from the calling assembly.</p>\n\n<p>Below is a sample code</p>\n\n<pre><code>public static void ReceiveMessage(string queuName)\n    {\n        var assembly = Assembly.GetCallingAssembly();\n\n        string configPath = new Uri(assembly.CodeBase).LocalPath;\n        var configManager = ConfigurationManager.OpenExeConfiguration(configPath);\n        var connectionString = configManager.ConnectionStrings.CurrentConfiguration.AppSettings.Settings[\"Microsoft.ServiceBus.ConnectionString\"];\n\n\n        QueueClient Client = QueueClient.CreateFromConnectionString(connectionString, \"Empresa\");\n\n        // Configure the callback options\n        OnMessageOptions options = new OnMessageOptions();\n        options.AutoComplete = false;\n        options.AutoRenewTimeout = TimeSpan.FromMinutes(1);\n\n        // Callback to handle received messages\n        Client.OnMessage((message) =&gt;\n        {\n            try\n            {\n                Empresa empresa = GetBody(message);\n                // Process message from queue\n                //Console.WriteLine(\"Body: \" + );\n                Console.WriteLine(\"MessageID: \" + message.MessageId);\n\n                // Remove message from queue\n                message.Complete();\n            }\n            catch (Exception ex)\n            {\n                // Indicates a problem, unlock message in queue\n                message.Abandon();\n            }\n        }, options);\n    }\n</code></pre>\n\n<p>The <code>ConfigurationManager</code> is a part of <code>System.Configuration</code> Assembly.</p>\n\n<p>If you have an even more complex scenario then please post the details and I will try to figure out the solution.</p>\n"}], "owner": {"reputation": 26702, "user_id": 1014217, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6zW1x.jpg?s=128&g=1", "display_name": "Luis Valencia", "link": "https://stackoverflow.com/users/1014217/luis-valencia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 31876233, "answer_count": 1, "score": 1, "last_activity_date": 1438945567, "creation_date": 1436389952, "question_id": 31303851, "link": "https://stackoverflow.com/questions/31303851/pass-value-from-app-config-from-one-console-application-to-one-class-library", "title": "pass value from app.config from one console application to one class library", "body": "<p>In my console application I have this on app.config</p>\n\n<pre><code> &lt;appSettings&gt;\n    &lt;add key=\"Microsoft.ServiceBus.ConnectionString\" value=\"Endpoint=sb://xx.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=xx/KrM=\"/&gt;\n  &lt;/appSettings&gt;\n</code></pre>\n\n<p>The console application does the following:</p>\n\n<pre><code> static void Main(string[] args)\n        {\n            try\n            {\n                Console.WriteLine(\"Press key to continue\");\n                Console.ReadKey();\n                QueueHelper.ReceiveMessage(\"Empresa\");\n            }\n            catch (Exception ex)\n            {\n\n                throw ex;\n            }\n        }\n</code></pre>\n\n<p>However I wanted to isolate the Queing methods in a different class library, so the actual implementation of ReceiveMessage is in another class library</p>\n\n<pre><code> /// &lt;summary&gt;\n        /// Receives a message\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"queuName\"&gt;&lt;/param&gt;\n        public static void ReceiveMessage(string queuName)\n        {\n            QueueClient Client = QueueClient.CreateFromConnectionString(connectionString, \"Empresa\");\n\n            // Configure the callback options\n            OnMessageOptions options = new OnMessageOptions();\n            options.AutoComplete = false;\n            options.AutoRenewTimeout = TimeSpan.FromMinutes(1);\n\n            // Callback to handle received messages\n            Client.OnMessage((message) =&gt;\n            {\n                try\n                {\n                    Empresa empresa = GetBody&lt;Empresa&gt;(message);\n                    // Process message from queue\n                    //Console.WriteLine(\"Body: \" + );\n                    Console.WriteLine(\"MessageID: \" + message.MessageId);\n\n                    // Remove message from queue\n                    message.Complete();\n                }\n                catch (Exception ex)\n                {\n                    // Indicates a problem, unlock message in queue\n                    message.Abandon();\n                }\n            }, options);\n        }\n</code></pre>\n\n<p>The problem is that its trying to get the connection string info from app.config which is local to that library and not to the caller.</p>\n\n<p>So I get a null connection string.</p>\n\n<p>Now, I dont want to duplicate app settings in my class library projects, how and what would be the best way to achieve this?</p>\n\n<p>One of the reasons for this is that at the end this console app will be installed in Azure as a WebJob, and Azure has an interface to change AppSettings for webjobs, but not for class libraries.</p>\n"}, {"tags": ["c#", "com", "activex"], "comments": [{"owner": {"reputation": 31953, "user_id": 2528063, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5776e315b2aeae4338bee6b40ef1104d?s=128&d=identicon&r=PG", "display_name": "HimBromBeere", "link": "https://stackoverflow.com/users/2528063/himbrombeere"}, "edited": false, "score": 0, "creation_date": 1436390456, "post_id": 31303767, "comment_id": 50597760, "body": "Immutability does not mean you can&#180;t re-reference a variable . It simply means it&#180;s internal value does not change. But with ref-keyword you simply reference a NEW string, so you won&#180;t need a stringBuilder at all"}, {"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1436394563, "post_id": 31303767, "comment_id": 50599508, "body": "@HansPassant I don&#39;t know what you mean ... I&#39;m calling a method from an API."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1436394752, "post_id": 31303767, "comment_id": 50599580, "body": "Start the Visual Studio Command Prompt.  Run oleview.exe, use File + View Typelib and select the ActiveX executable.  What does &#39;api.func&#39; <i>really</i> look like in that program?"}, {"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1436395183, "post_id": 31303767, "comment_id": 50599740, "body": "@HansPassant at the moment I get <code>TYPE_E_CANNOTLOADLIBRARY</code> when opening it from oleview; trying to fix that. I&#39;m not sure what you would expect to see -- the object browser shows the signature <code>int func(ref string returnValue)</code>."}, {"owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "edited": false, "score": 0, "creation_date": 1436396312, "post_id": 31303767, "comment_id": 50600158, "body": "Could you attach screen?"}, {"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1436401233, "post_id": 31303767, "comment_id": 50601573, "body": "@HansPassant finally got it, <code>long func(BSTR* returnValue);</code>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1436401623, "post_id": 31303767, "comment_id": 50601687, "body": "That is correct.  It doesn&#39;t have anything to do with the way you call it, the function itself fails when it calls something else.  Contact the owner or author for support."}, {"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 0, "creation_date": 1436553525, "post_id": 31303767, "comment_id": 50679390, "body": "Update: I can call the API from C++ without problem. That seems to suggest bad marshalling from C#?"}], "answers": [{"comments": [{"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 0, "creation_date": 1436390118, "post_id": 31303797, "comment_id": 50597587, "body": "That causes a compile-time error &quot;Use of unassigned local variable&quot; or runtime error, <code>DISP_E_TYPEMISMATCH</code> if I assign <code>&quot;&quot;</code> to the string."}, {"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "reply_to_user": {"reputation": 31953, "user_id": 2528063, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5776e315b2aeae4338bee6b40ef1104d?s=128&d=identicon&r=PG", "display_name": "HimBromBeere", "link": "https://stackoverflow.com/users/2528063/himbrombeere"}, "edited": false, "score": 0, "creation_date": 1436391414, "post_id": 31303797, "comment_id": 50598200, "body": "@HimBromBeere ZachB never said it causes both. He said that if he doesn&#39;t assign <code>&quot;&quot;</code>, it causes a compile-time error, and if he does, it causes a runtime error. Those are two different scenarios."}], "tags": [], "owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "is_accepted": false, "score": -1, "last_activity_date": 1436391337, "last_edit_date": 1436391337, "creation_date": 1436389772, "answer_id": 31303797, "question_id": 31303767, "link": "https://stackoverflow.com/questions/31303767/passing-string-by-ref-to-activex-component-in-c/31303797#31303797", "title": "Passing string by ref to activex component in C#", "body": "<p>Call it with a reference to a <code>string</code> variable, as it says:</p>\n\n<pre><code>string returnValue = \"\";\napi.func(ref returnValue);\n</code></pre>\n\n<p>You might want to take a look at the <a href=\"https://msdn.microsoft.com/en-us/library/14akc2c7.aspx\" rel=\"nofollow\">ref</a> and <a href=\"https://msdn.microsoft.com/en-us/library/t3c3bfhx.aspx\" rel=\"nofollow\">out</a> keywords in C#.</p>\n"}, {"comments": [{"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 0, "creation_date": 1436394458, "post_id": 31303830, "comment_id": 50599475, "body": "Indeed <code>func</code> should change <code>returnValue</code>. Using your suggestion causes <code>Type mismatch (DISP_E_TYPEMISMATCH)</code> unfortunately."}, {"owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "reply_to_user": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 0, "creation_date": 1436395414, "post_id": 31303830, "comment_id": 50599840, "body": "Could you add name of ActiveX API function or attach it? Because looks like problem is little bit deeper."}, {"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 0, "creation_date": 1436395677, "post_id": 31303830, "comment_id": 50599947, "body": "It&#39;s a very rare API that has no documentation online. Something from the same manufacturer is on page 30 of <a href=\"http://www.velocity11.com/techdocs/previoususerguides/VSpin/July2002/VSpinUserGuide_July2002.pdf\" rel=\"nofollow noreferrer\">velocity11.com/techdocs/previoususerguides/VSpin/July2002/&hellip;</a>."}, {"owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "reply_to_user": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 0, "creation_date": 1436396455, "post_id": 31303830, "comment_id": 50600215, "body": "@ZachB I wan&#39;t to help, but I haven&#39;t enough info for it. I&#39;ve added some UPD maybe it will help you. Good luck."}, {"owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "edited": false, "score": 1, "creation_date": 1436396621, "post_id": 31303830, "comment_id": 50600270, "body": "Re: update, yeah, tried explicitly marshalling to a BSTR, but that gives an IntPtr and thus a type-mismatch. That should be the default marshalling anyway. Thanks for the help, sorry for the tricky problem without much useful info."}], "tags": [], "owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "is_accepted": false, "score": 0, "last_activity_date": 1436396552, "last_edit_date": 1436396552, "creation_date": 1436389893, "answer_id": 31303830, "question_id": 31303767, "link": "https://stackoverflow.com/questions/31303767/passing-string-by-ref-to-activex-component-in-c/31303830#31303830", "title": "Passing string by ref to activex component in C#", "body": "<p>If <code>func</code> should change <code>returnValue</code> , I think your code should be changed like this:</p>\n\n<pre><code>string returnValue = String.Empty;\napi.func(ref returnValue);\n</code></pre>\n\n<p>You should init <code>returnValue</code> before pass it by <a href=\"https://msdn.microsoft.com/en-us/library/14akc2c7.aspx\" rel=\"nofollow\">ref</a>.</p>\n\n<p><strong>UPD:</strong> Did you try to call it like this?:</p>\n\n<pre><code>api.func(ref Marshal.StringToBSTR(string value));\n</code></pre>\n"}], "owner": {"reputation": 9285, "user_id": 1218408, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/YqwCY.png?s=128&g=1", "display_name": "ZachB", "link": "https://stackoverflow.com/users/1218408/zachb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1436396552, "creation_date": 1436389679, "last_edit_date": 1436395988, "question_id": 31303767, "link": "https://stackoverflow.com/questions/31303767/passing-string-by-ref-to-activex-component-in-c", "title": "Passing string by ref to activex component in C#", "body": "<p>I'm trying to us an ActiveX API function with the pattern <code>function(ref string returnvalue)</code> in C#. The API function modifies the string.</p>\n\n<pre><code>string returnValue = String.Empty;\napi.func(ref returnValue); // DISP_E_TYPEMISMATCH\n</code></pre>\n\n<p>OK, maybe that's because strings are immutable. Trying a <code>StringBuilder</code> per <a href=\"https://msdn.microsoft.com/en-us/library/s9ts558h%28v=vs.110%29.aspx?cs-save-lang=1&amp;cs-lang=csharp#cpcondefaultmarshalingforstringsanchor3\" rel=\"nofollow\">this</a>:</p>\n\n<pre><code>StringBuilder returnValue = new StringBuilder(128);\napi.func(returnValue);\n</code></pre>\n\n<p>This causes a compile-time error about type mismatch.</p>\n\n<p>How do I call this function?</p>\n\n<p>I don't know if I need to marshal the C# string to a BStr, and if so, I don't know how to pass that by ref to the API function.</p>\n"}, {"tags": ["c#", "powershell"], "comments": [{"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "edited": false, "score": 0, "creation_date": 1436392709, "post_id": 31303725, "comment_id": 50598812, "body": "Could you provide more info? Like the specific part in your .ps1?"}, {"owner": {"reputation": 18739, "user_id": 4003407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb6a20caae0ab19fe7eab3ac3f74fb?s=128&d=identicon&r=PG&f=1", "display_name": "user4003407", "link": "https://stackoverflow.com/users/4003407/user4003407"}, "edited": false, "score": 0, "creation_date": 1436394315, "post_id": 31303725, "comment_id": 50599424, "body": "<code>AddScript</code> -&gt; <code>AddCommand</code>"}], "answers": [{"tags": [], "owner": {"reputation": 17248, "user_id": 1400869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/eTsCt.jpg?s=128&g=1", "display_name": "D.R.", "link": "https://stackoverflow.com/users/1400869/d-r"}, "is_accepted": true, "score": 3, "last_activity_date": 1436394911, "creation_date": 1436394911, "answer_id": 31305019, "question_id": 31303725, "link": "https://stackoverflow.com/questions/31303725/how-to-run-a-powershell-script-from-c-that-references-another-script/31305019#31305019", "title": "How to run a Powershell script from C# that references another script", "body": "<p>Probably you have different working directories. How does the line look like inside <code>&lt;full-path-to-script&gt;.ps1</code> that includes the second script? It should use <code>$PSScriptRoot</code>.</p>\n"}], "owner": {"reputation": 2705, "user_id": 1899926, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/215754c0c3a3444a99446e99c2cbf9dd?s=128&d=identicon&r=PG", "display_name": "Barodapride", "link": "https://stackoverflow.com/users/1899926/barodapride"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "accepted_answer_id": 31305019, "answer_count": 1, "score": 2, "last_activity_date": 1436394911, "creation_date": 1436389519, "question_id": 31303725, "link": "https://stackoverflow.com/questions/31303725/how-to-run-a-powershell-script-from-c-that-references-another-script", "title": "How to run a Powershell script from C# that references another script", "body": "<p>I'm trying to run a powershell script from my C# program like so:</p>\n\n<pre><code>var ps = PowerShell.Create();\nps.AddScript(@\"&lt;full-path-to-script&gt;.ps1\").Invoke()\n</code></pre>\n\n<p>but it fails because within the script it references another script which gives me an error saying it's not found. However, running the script from the commandline works fine. I'm not sure I understand why this is not working from within C# but works in the commandline. Any ideas?</p>\n"}, {"tags": ["java", "c#", "jdbc", "visual-c#-express-2010", "windows-xp-sp3"], "comments": [{"owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "edited": false, "score": 1, "creation_date": 1436389746, "post_id": 31303687, "comment_id": 50597374, "body": "Use <code>SqlConnection</code> to connect to <code>SQL Server</code> , take a look at this page : <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 4431827, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/31841611578ad9eb765b22b095a55b3a?s=128&d=identicon&r=PG&f=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/4431827/igor"}, "reply_to_user": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "edited": false, "score": 1, "creation_date": 1436390110, "post_id": 31303687, "comment_id": 50597584, "body": "And I use this: <code>SqlCommand command = new SqlCommand(queryString, connection);</code>         <code>command.Connection.Open();</code>         <code>command.ExecuteNonQuery();</code> but What is <code>queryString</code>? and <code>connection</code>? The <code>URL</code>?? The <code>server</code>??"}], "answers": [{"tags": [], "owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "is_accepted": true, "score": 0, "last_activity_date": 1436390732, "creation_date": 1436390732, "answer_id": 31304091, "question_id": 31303687, "link": "https://stackoverflow.com/questions/31303687/connecto-to-sql-server-with-c-and-jdbc/31304091#31304091", "title": "Connecto to SQL Server with c# and JDBC", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring%28v=vs.110%29.aspx\" rel=\"nofollow\">ConnectionString</a> is similar to an <code>OLE DB</code> connection string, but is not identical. Unlike OLE DB or ADO, the connection string that is returned is the same as the user-set <code>ConnectionString</code>, minus security information if the Persist Security Info value is set to false (default). The .NET Framework Data Provider for <code>SQL Server</code> does not persist or return the password in a connection string unless you set Persist Security Info to true.</p>\n\n<p>You can use the <code>ConnectionString</code> property to connect to a database. The following example illustrates a typical connection string.</p>\n\n<pre><code>\"Persist Security Info=False;Integrated Security=true;Initial Catalog=Northwind;server=(local)\"\n</code></pre>\n\n<p>Use the new <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder(v=vs.110).aspx\" rel=\"nofollow\">SqlConnectionStringBuilder</a> to construct valid connection strings at run time.</p>\n\n<pre><code>private static void OpenSqlConnection()\n{\n    string connectionString = GetConnectionString();\n\n    using (SqlConnection connection = new SqlConnection())\n    {\n        connection.ConnectionString = connectionString;\n\n        connection.Open();\n\n        Console.WriteLine(\"State: {0}\", connection.State);\n        Console.WriteLine(\"ConnectionString: {0}\",\n            connection.ConnectionString);\n    }\n}\n\nstatic private string GetConnectionString()\n{\n    // To avoid storing the connection string in your code,  \n    // you can retrieve it from a configuration file. \n    return \"Data Source=MSSQL1;Initial Catalog=AdventureWorks;\"\n        + \"Integrated Security=true;\";\n}\n</code></pre>\n\n<ol>\n<li><code>Data Source</code> or <code>Server or</code>Address<code>or</code>Addr<code>or</code>Network Address<code>\n: The name or network address of the instance of SQL Server to which\nto connect. The port number can be specified after the server name :\n</code>server=tcp:servername, portnumber`</li>\n<li>The <code>Initial Catalog</code> or <code>Database</code> : The name of the database. The database name can be 128 characters or less.</li>\n<li>The <code>Integrated Security</code> or <code>Trusted_Connection</code> : When <code>false</code>, <code>User ID</code> and <code>Password</code> are specified in the connection. When true, the current Windows account credentials are used for authentication. Recognized values are true, <code>false</code>, yes, no, and <code>sspi</code> (strongly recommended), which is equivalent to <code>true</code>. If <code>User ID</code> and <code>Password</code> are specified and Integrated Security is set to true, the <code>User ID</code> and <code>Password</code> will be ignored and <code>Integrated Security</code> will be used.</li>\n</ol>\n\n<p>and <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring%28v=vs.110%29.aspx\" rel=\"nofollow\">other items</a></p>\n\n<p>I hope this help you :) .</p>\n"}], "owner": {"reputation": 43, "user_id": 4431827, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/31841611578ad9eb765b22b095a55b3a?s=128&d=identicon&r=PG&f=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/4431827/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3478, "favorite_count": 0, "accepted_answer_id": 31304091, "answer_count": 1, "score": 0, "last_activity_date": 1436390732, "creation_date": 1436389421, "question_id": 31303687, "link": "https://stackoverflow.com/questions/31303687/connecto-to-sql-server-with-c-and-jdbc", "title": "Connecto to SQL Server with c# and JDBC", "body": "<p>I have this program in <code>java</code> to connect to a <code>SQL Server</code></p>\n\n<pre><code>server = \"ZF-SQL-MTRAZDB.NIS.LOCAL\"\ndbName = \"MRAZ\"\nnameBaseDatos = \"CD_LO\"\ntable = \"dbo.CD_LO_DATA\"\nuser = \"user\"\npassword = \"Pass\"\nurl = \"jdbc:sqlserver//\"+ server + \"\\\\\" + dbName + \"jdatabaseName=\" +     nameBaseDatos\ndriver = \"com.microsoft.sqlserver.jdbc_SQLServerDriver\"\n</code></pre>\n\n<p>Now I have to do the same with <code>Visual C# 2010</code> in <code>Windows XP</code></p>\n\n<p>How can I do this program?? Because in java use <code>JDBC</code>, Should I also use <code>JDBC</code>?</p>\n\n<p>Thanks for all!</p>\n"}, {"tags": ["c#", "winforms", "visual-studio-2013", "datetimepicker"], "comments": [{"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "edited": false, "score": 0, "creation_date": 1436389659, "post_id": 31303659, "comment_id": 50597338, "body": "You would have to make your own control, unfortunately. The DateTimePicker is very specific as to what it allows, and parts of a second are not included."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "reply_to_user": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "edited": false, "score": 0, "creation_date": 1436390008, "post_id": 31303659, "comment_id": 50597531, "body": "Do you have any good references for how to go about making my own datetimepicker type control?"}], "answers": [{"tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1436449199, "creation_date": 1436449199, "answer_id": 31319267, "question_id": 31303659, "link": "https://stackoverflow.com/questions/31303659/c-winforms-datetimepicker-custom-formatted-to-tenths-of-a-second-default-sele/31319267#31319267", "title": "C# Winforms DateTimePicker Custom Formatted to Tenths of a Second / Default Selection to Seconds", "body": "<p>This could work</p>\n\n<ol>\n<li><p>Add a DomainUpDown control</p></li>\n<li><p>Add a bunch of datetimes that vary by .1 seconds and display them as strings formatted to show miliseconds. Your user can then click up and down to see .1 second deltas</p>\n\n<pre><code>    string dateString = \"7/9/2015 9:32:45.126 AM\";\n    DateTime dateValue = DateTime.Parse(dateString);\n\n    for (int i = 0; i &lt; 5; i++)\n    {\n        dtPicker.Items.Add(dateValue.AddSeconds(.1*i).ToString(\"MM/dd/yyyy hh:mm:ss.fff tt\"));\n    }\n</code></pre></li>\n<li><p>If you want to let the user pick say the hour first and then generate your datetime deltas from there it won't work as well. You could create multiple numeric controls, but at that point you might want to go down the path of extending the datetime picker like <a href=\"http://www.codeproject.com/Articles/3579/Extended-DateTimePicker\" rel=\"nofollow\">here</a>.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1436551015, "post_id": 31321256, "comment_id": 50678027, "body": "Thank you! your code is SUPER helpful, but I am still tinkering with it to get it to work perfectly. Right now I am trying to tweak the way selection is handled and the way values are changed OnKeyDown and OnKeyUp events. I basically want it to mimic how things normally work on the datetimepicker, such that if I type in a single digit, it adds it to the &quot;tens&quot; place, however, I enter 2 digits it moves the first digit entered to the &quot;ones&quot; place. This is insanely trickky for me."}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1436553437, "post_id": 31321256, "comment_id": 50679348, "body": "@user3653277 The <code>MaskedTextBox</code> control provides <code>InsertKeyMode</code>, but the only options are <code>Insert</code> or <code>Overwrite</code>. I think to do what you are asking would require intercepting the Key Down message (possibly by overriding the <code>WndProc</code>) method and then creating the text to mimic the <code>DateTimePicker</code> behavior. I&#39;ll look into it and see if it&#39;s possible."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1436810127, "post_id": 31321256, "comment_id": 50757063, "body": "Were you able to see if that was possible? I am a little out of my zone here, I have been trying to make it work manually, but it not going terribly well."}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1436905418, "post_id": 31321256, "comment_id": 50805757, "body": "@user3653277 Still working on it, taking longer than expected."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1436920208, "post_id": 31321256, "comment_id": 50811618, "body": "that&#39;s okay I appreciate it! thank you for the update :)"}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1437222172, "post_id": 31321256, "comment_id": 50945797, "body": "is your timePicker still going okay?"}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1437426303, "post_id": 31321256, "comment_id": 51013861, "body": "@user3653277 Putting the control through more testing. Making sure inputting text is handled properly."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1437871775, "post_id": 31321256, "comment_id": 51212104, "body": "Just checking in, anything I can do to help?"}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1437888313, "post_id": 31321256, "comment_id": 51214723, "body": "Another project came up that requires a few days to finish. Sorry for the delay, I will definitely release the control as soon as possible."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1438790046, "post_id": 31321256, "comment_id": 51596190, "body": "Checking in again. Is there anyway I can finish up from where you are at if you don&#39;t have time to finish?"}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1438985637, "post_id": 31321256, "comment_id": 51692309, "body": "New code is updated. All source code files are in the &quot;src&quot; folder in the zip file. Let me know if you run into any issues."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1439131506, "post_id": 31321256, "comment_id": 51724734, "body": "Awesome! Thank you so much, I cant wait to implement it. I will let you know :)"}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1439836784, "post_id": 31321256, "comment_id": 52013745, "body": "@user3653277 It might interest you that a clock drop down menu was added to the time picker."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1440001540, "post_id": 31321256, "comment_id": 52096112, "body": "Thank you again! I still have not had the time quite yet to implement this. I will very soon."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1441816334, "post_id": 31321256, "comment_id": 52830749, "body": "Sorry, about this question, i am new at this. I am finally able to implement this MaskedTextBox project you created. What is the best way to go about doing this? I was able to add the whole thing as a standalone project to my current solution, but should I be adding this specifically as a control or reference somehow? or am i doing it correctly?"}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1441830880, "post_id": 31321256, "comment_id": 52837930, "body": "There are two common ways to use a 3rd party project. Compile it into a DLL and then import the DLL. Or add the .cs files directly to your project. You can look at the <code>TimePickerMillisPanel</code> class inside the <code>MaskedTextBoxTestPanel.cs</code> file as an example on how to use the control."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1443205737, "post_id": 31321256, "comment_id": 53415757, "body": "I apologize, but am I missing something? When I open the solution file, many of the classes say they have been &quot;Moved or deleted&quot;. In fact, MaskedTextBoxTestPanel.cs, Program.cs, and SpinControlTestPanel.cs are the only ones available. I looked at the code in the TimePickerMillisPanel class but I dont understand where the control even is to implement it."}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1443207597, "post_id": 31321256, "comment_id": 53416633, "body": "@user3653277 They are all in the &quot;/src/&quot; folder in the zip file. You will need to remove the existing links that don&#39;t work and re-add them from the src folder. Limitation of trying to organize projects in Visual Studio."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1443628285, "post_id": 31321256, "comment_id": 53572710, "body": "I am determined to get this implemented :) thank you for all your continued help. I have sort of run into yet another problem. I decided to go ahead and compile the project into a DLL and import the DLL into my current solution. I added a reference to the &quot;MaskedTextBoxLibrary&quot; I created, but I cannot add it with a &quot;using&quot; statement because the library wont show up with intellisense."}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1443632615, "post_id": 31321256, "comment_id": 53575371, "body": "@user3653277 Are you typing <code>using Opulos.Core.UI</code> ? If you can&#39;t see that namespace, it probably means the DLL is missing the files in the <code>&#47;src&#47;</code> folder. So in the <code>MaskedTextBoxLibrary</code> solution, check how many files it contains, should be 18."}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1443701611, "post_id": 31321256, "comment_id": 53604265, "body": "that was it! I changed the default namespace of the dll when i imported into my project but I forgot that the namespaces of the actual project were still under Opulos. Thanks again! ... getting closer :)"}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1444078583, "post_id": 31321256, "comment_id": 53740420, "body": "So I am definitely making progress now! I have the &quot;enchanced maskedtextbox&quot; (as timepicker) control showing up on my form at runtime. I also tweaked it to properly obtain milliseconds. Now my question is how I can get the maskedtextbox control to work more closely to the normal timepicker. (I havent spent to much time looking yet). I see that you have a property &quot;Keep Token Selected&quot;. This is the effect I want, however, if you try to select seconds, It selects both seconds and milliseconds. Seconds and milliseconds act as a single token almost. Is that by design? or can I change it?"}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1444079812, "post_id": 31321256, "comment_id": 53741013, "body": "@user3653277 Yes, it&#39;s possible to change and make them separate tokens. However, if they are two separate tokens, then typing &quot;12.345&quot; won&#39;t work. So the default is a combined token. To split them into two different tokens, at the top of the <code>TimePicker(...)</code> constructor, add the line <code>SplitChars = new [] { &#39;:&#39;, &#39;.&#39; };</code>"}, {"owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1444249982, "post_id": 31321256, "comment_id": 53828703, "body": "perfect! I now have that implemented. The final I would like make would be the ability to have each token act as a tab stop. For instance, I noticed that when tabbing into the control, the &quot;Hours&quot; token is selected by default as the control&#39;s tabstop. If I press tab again, the next tab stop is on the &quot;Hours&quot; of the other TimePicker control I have on the form. Is there anyway to make each consecutive token a tabstop, such that for every tab press; Hours, mins, sec, then millisec are highlighted in that order?"}, {"owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "reply_to_user": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "edited": false, "score": 0, "creation_date": 1444262076, "post_id": 31321256, "comment_id": 53833421, "body": "@user3653277 The left and right arrows do that. However, if you want to use <code>Tab</code> and <code>Shift+Tab</code>, then in the <code>MaskedTextBox.cs</code> code, look at the <code>PreProcessMessage(ref Message msg)</code> method when <code>key == LEFT.</code> That will show you how to select tokens. However, you would probably need to have a special case that pressing the <code>Tab</code> key on the last token is not intercepted. Similarly, <code>Shift+Tab</code> on the first token is not intercepted."}], "tags": [], "owner": {"reputation": 4589, "user_id": 904156, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/KiDwe.png?s=128&g=1", "display_name": "Loathing", "link": "https://stackoverflow.com/users/904156/loathing"}, "is_accepted": true, "score": 2, "last_activity_date": 1439836864, "last_edit_date": 1439836864, "creation_date": 1436453970, "answer_id": 31321256, "question_id": 31303659, "link": "https://stackoverflow.com/questions/31303659/c-winforms-datetimepicker-custom-formatted-to-tenths-of-a-second-default-sele/31321256#31321256", "title": "C# Winforms DateTimePicker Custom Formatted to Tenths of a Second / Default Selection to Seconds", "body": "<p>You could try to force the <code>DateTimePicker</code> to display milliseconds, but it will be a painful experience. You are better off using a <code>MaskedTextBox</code>. You can download TimePicker.cs from sourceforge: <a href=\"https://sourceforge.net/projects/time-picker/\" rel=\"nofollow noreferrer\">https://sourceforge.net/projects/time-picker/</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/nnwhS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nnwhS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is some sample code:</p>\n\n<pre><code>    [STAThread]\n    static void Main() {\n        Application.EnableVisualStyles();\n        Form f = new Form();\n        var dp = new TimePicker(\"hh:mm:ss.f\", true) { Location = new Point(100, 100) };\n        dp.ByValue[2] = false;\n        f.Controls.Add(dp);\n        var bt1 = new Button { Text = \"Now\", Location = new Point(110, 130) };\n        bt1.Click += delegate {\n            dp.Value = DateTime.Now;\n        };\n\n        int k = 0;\n        dp.ValueChanged += delegate {\n            bt1.Text = \"Now \" + (k++);\n        };\n        f.Controls.Add(bt1);\n        Application.Run(f);\n    }\n</code></pre>\n"}], "owner": {"reputation": 689, "user_id": 3653277, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/bwZS0.jpg?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/3653277/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 1, "accepted_answer_id": 31321256, "answer_count": 2, "score": 0, "last_activity_date": 1439836864, "creation_date": 1436389326, "question_id": 31303659, "link": "https://stackoverflow.com/questions/31303659/c-winforms-datetimepicker-custom-formatted-to-tenths-of-a-second-default-sele", "title": "C# Winforms DateTimePicker Custom Formatted to Tenths of a Second / Default Selection to Seconds", "body": "<p>My application currently uses the DateTimePicker custom formatted to display HH:mm:ss.</p>\n\n<p>How can I format it so to allow for tenths of a second? \nMy second question is that when I tab into the datetimepicker, the Hours section is selected first by default, is there anyway to change this so that seconds are selected first by default? I noticed that If you click the updown arrows without tabbing into the control the seconds section is selected by default.</p>\n\n<p>Any experts on the datetimepicker out there? Or does anyone have an ideas on an alternative I can use to implement these features?</p>\n\n<p>Below is a picture of how it is formatted as well as the properties:\n<img src=\"https://i.stack.imgur.com/rvLOI.png\" alt=\"DateTimePickers\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/AOdxN.png\" alt=\"Properties\"></p>\n"}, {"tags": ["c#", "xml", "performance", "linq"], "comments": [{"owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "edited": false, "score": 0, "creation_date": 1436389280, "post_id": 31303640, "comment_id": 50597171, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/bb943859.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb943859.aspx</a>"}, {"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1436389658, "post_id": 31303640, "comment_id": 50597337, "body": "Is the documents structure well known (every time the same)?"}, {"owner": {"reputation": 9495, "user_id": 1395740, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/793c4377313587d742fad6f069d92d89?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/1395740/nick"}, "reply_to_user": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1436389902, "post_id": 31303640, "comment_id": 50597467, "body": "@Shnugo no, unfortunately it can change at runtime."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 1, "creation_date": 1436390438, "post_id": 31303640, "comment_id": 50597753, "body": "If <code>XDocument</code> is too slow, try scanning through the file with <code>XmlReader</code>: <a href=\"https://stackoverflow.com/questions/9518266/xmlreader-reading-xml-file-based-on-attribute-value\" title=\"xmlreader reading xml file based on attribute value\">stackoverflow.com/questions/9518266/&hellip;</a>"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1436391010, "post_id": 31303640, "comment_id": 50598005, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/bb155325%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\"><code>Enumerable.Single</code></a> throws an exception if &gt; 1 item is in the enumerable, and so must needs scan the entire collection.  Your manual loop breaks as soon as the first match is found.  Which do you want?"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1436392240, "post_id": 31303640, "comment_id": 50598596, "body": "If the document is loaded only once but changed many times in memory, consider maintaining a lookup table of element names &amp; attributes to elements.  I <i>think</i> you should be able to use the <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.linq.xobject.changed%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\"><code>XObject.Changed</code></a> event to keep the dictionary updated, though I&#39;ve never tried it myself."}], "answers": [{"comments": [{"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "reply_to_user": {"reputation": 9495, "user_id": 1395740, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/793c4377313587d742fad6f069d92d89?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/1395740/nick"}, "edited": false, "score": 0, "creation_date": 1436390797, "post_id": 31303733, "comment_id": 50597911, "body": "@Nick - Can you describe your performance scenario a little more?  Are you loading the document into memory once and running many queries, or loading and running only one query?  Is the <code>&quot;def&quot;</code> node a high-level node or a leaf node?  You say the document structure can change, but by how much?  Any way to cut down the scope of the search?"}, {"owner": {"reputation": 9495, "user_id": 1395740, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/793c4377313587d742fad6f069d92d89?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/1395740/nick"}, "edited": false, "score": 0, "creation_date": 1436391253, "post_id": 31303733, "comment_id": 50598118, "body": "The document is loaded once at starup. &quot;Def&quot; can easily be a leaf node, but there art not so many level of deepness (4/5). New nodes are frequently added."}], "tags": [], "owner": {"reputation": 8893, "user_id": 2150749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQ97m.png?s=128&g=1", "display_name": "Jashaszun", "link": "https://stackoverflow.com/users/2150749/jashaszun"}, "is_accepted": true, "score": 2, "last_activity_date": 1436391178, "last_edit_date": 1436391178, "creation_date": 1436389570, "answer_id": 31303733, "question_id": 31303640, "link": "https://stackoverflow.com/questions/31303640/linq-performance-parsing-xml-file/31303733#31303733", "title": "Linq performance parsing XML file", "body": "<p>LINQ uses <a href=\"https://msdn.microsoft.com/en-us/library/bb943859.aspx\" rel=\"nofollow\">deferred (lazy) execution</a>, which means that it only iterates through collections <em>once</em> and only when it needs to.</p>\n\n<blockquote>\n  <p>Deferred execution can greatly improve performance when you have to manipulate large data collections, especially in programs that contain a series of chained queries or manipulations. In the best case, deferred execution enables only a single iteration through the source collection.</p>\n</blockquote>\n\n<p>In this case, there is no new list being generated from your <code>Where</code> clause. In fact, the compiled version of your LINQ statement will function in almost the same way as your <code>foreach</code> statement.</p>\n\n<p><strong>Edit:</strong> My only idea about improving performance is to follow Robert McKee's answer, which says that you should use <code>.First()</code> instead of <code>.Single()</code> to not have to iterate through your entire list. Beyond that, I'm not sure what else you <em>can</em> do, except use a different library or a different language.</p>\n"}, {"comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1436389890, "post_id": 31303771, "comment_id": 50597459, "body": "Id be surprised if OP would see a significant difference: judging from the results of the loop (which terminates early) there should be very little difference."}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1436390130, "post_id": 31303771, "comment_id": 50597594, "body": "True.  I wonder if it&#39;s never finding a match and both are traversing the entire document before returning null."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1436391079, "post_id": 31303771, "comment_id": 50598038, "body": "<code>Single</code> <a href=\"https://msdn.microsoft.com/en-us/library/bb155325%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">throws an exception if there is not exactly one element in the sequence.</a>, so it must be finding exactly one match."}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1436391295, "post_id": 31303771, "comment_id": 50598140, "body": "@dbc You are correct.  Ok, perhaps it&#39;s the last one in the document."}], "tags": [], "owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "is_accepted": false, "score": 1, "last_activity_date": 1436391388, "last_edit_date": 1436391388, "creation_date": 1436389686, "answer_id": 31303771, "question_id": 31303640, "link": "https://stackoverflow.com/questions/31303640/linq-performance-parsing-xml-file/31303771#31303771", "title": "Linq performance parsing XML file", "body": "<p>Switch <code>.Single()</code> to <code>.First()</code> and it should perform much better.  Your for-loop is almost exactly like what <code>.First()</code> will do, while <code>.Single</code> is more like:</p>\n\n<pre><code>for (int i = 0; i &lt; 1000; i++)\n{\n    foreach (var elm in xdoc.Descendants(\"def\"))\n    {\n        if (elm.Attribute(\"name\").Value == def)\n        {\n            if (xelm!=null)\n                throw new InvalidOperationException();\n            xelm = elm;\n        }\n    }\n    if (xelm==null)\n       throw new InvalidOperationException();\n}\n</code></pre>\n\n<p>which will continue to traverse the document until it either finds another match (and throws an exception), or hits the end of the document.</p>\n\n<p>You could possibly try using PLINQ, but you'll need to do extensive peformance testing, as there are a large number of factors that play into PLINQ's performance changes, including the hardware it runs on, and the structure of the document, etc.</p>\n\n<pre><code>stopwatch.Start();\n\nfor (int i = 0; i &lt; 1000; i++)\n    xelm = xdoc.AsParallel()\n        .Descendants(\"def\")\n        .Where(d =&gt; d.Attribute(\"name\").Value == def)\n        .Single();\n\nstopwatch.Stop();\nConsole.WriteLine(stopwatch.ElapsedMilliseconds);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "is_accepted": false, "score": 0, "last_activity_date": 1436398941, "last_edit_date": 1436398941, "creation_date": 1436395323, "answer_id": 31305109, "question_id": 31303640, "link": "https://stackoverflow.com/questions/31303640/linq-performance-parsing-xml-file/31305109#31305109", "title": "Linq performance parsing XML file", "body": "<p>To summarize your situation:</p>\n\n<ol>\n<li>You load a large <code>XDocument</code> at startup.</li>\n<li>You run many linear searches through the <code>XDocument</code> to find nodes by name and attribute value.</li>\n<li>Nodes can be added or removed after being loaded.</li>\n<li>The performance of repeated linear searches is too slow.</li>\n</ol>\n\n<p>In that case, it would appear to be necessary to put the nodes in some sort of lookup table to reduce the scope of the search.  The difficulty here is that that your document is changed after being loaded, so some mechanism would be needed to keep the tables up to date.  Luckily the <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.linq.xobject.changing%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>XObject.Changing</code></a> and <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.linq.xobject.changed%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>XObject.Changed</code></a> on the <code>XDocument</code> itself can be used for that purpose.  </p>\n\n<p>For instance, the following class can be used to look up <code>XElement</code> nodes by name, and will dynamically update its lookup tables when nodes are added or removed, or node names are changed:</p>\n\n<pre><code>public class XDocumentRepository\n{\n    readonly XDocument doc;\n    readonly Dictionary&lt;XName, List&lt;XElement&gt;&gt; elementsByName = new Dictionary&lt;XName, List&lt;XElement&gt;&gt;();\n\n    public XDocument Document { get { return doc; } }\n\n    public IEnumerable&lt;XElement&gt; ElementsByName(XName name)\n    {\n        return elementsByName.Items(name);\n    }\n\n    public XDocumentRepository(XDocument doc)\n    {\n        if (doc == null)\n            throw new ArgumentNullException();\n        this.doc = doc;\n        doc.Changing += new EventHandler&lt;XObjectChangeEventArgs&gt;(doc_Changing);\n        doc.Changed += new EventHandler&lt;XObjectChangeEventArgs&gt;(doc_Changed);\n        AddAll(doc.Root);\n    }\n\n    private void AddAll(XElement root)\n    {\n        foreach (var element in root.DescendantsAndSelf())\n            elementsByName.AddItem(element.Name, element);\n    }\n\n    private void RemoveAll(XElement root)\n    {\n        foreach (var element in root.DescendantsAndSelf())\n            elementsByName.RemoveItem(element.Name, element);\n    }\n\n    void doc_Changed(object sender, XObjectChangeEventArgs e)\n    {\n        XElement xSender = sender as XElement;\n        if (xSender != null &amp;&amp; xSender.Document == doc)\n        {\n            switch (e.ObjectChange)\n            {\n                case XObjectChange.Add:\n                case XObjectChange.Remove:\n                    AddAll(xSender);\n                    break;\n\n                case XObjectChange.Name:\n                    elementsByName.AddItem(xSender.Name, xSender);\n                    break;\n\n                case XObjectChange.Value:\n                    break;\n\n                default:\n                    Debug.Assert(false, \"unknown ObjectChange\");\n                    break;\n            }\n        }\n        // If an attribute value were changed, sender would be an XAttribute\n    }\n\n    void doc_Changing(object sender, XObjectChangeEventArgs e)\n    {\n        XElement xSender = sender as XElement;\n        if (xSender != null)\n        {\n            switch (e.ObjectChange)\n            {\n                case XObjectChange.Add:\n                case XObjectChange.Remove:\n                    RemoveAll(xSender);\n                    break;\n\n                case XObjectChange.Name:\n                    elementsByName.RemoveItem(xSender.Name, xSender);\n                    break;\n\n                case XObjectChange.Value:\n                    break;\n\n                default:\n                    Debug.Assert(false, \"unknown ObjectChange\");\n                    break;\n            }\n        }\n        // If an attribute value were changed, sender would be an XAttribute\n    }\n}\n\npublic static class DictionaryExtensions\n{\n    public static void AddItem&lt;TKey, TValueList, TValue&gt;(this IDictionary&lt;TKey, TValueList&gt; listDictionary, TKey key, TValue value)\n        where TValueList : IList&lt;TValue&gt;, new()\n    {\n        if (listDictionary == null)\n            throw new ArgumentNullException();\n        TValueList values;\n        if (!listDictionary.TryGetValue(key, out values))\n            listDictionary[key] = values = new TValueList();\n        values.Add(value);\n    }\n\n    public static IEnumerable&lt;TValue&gt; Items&lt;TKey, TValue&gt;(this IDictionary&lt;TKey, List&lt;TValue&gt;&gt; listDictionary, TKey key)\n    {\n        if (listDictionary == null)\n            throw new ArgumentNullException();\n        List&lt;TValue&gt; list;\n        if (!listDictionary.TryGetValue(key, out list))\n            return Enumerable.Empty&lt;TValue&gt;();\n        return list;\n    }\n\n    public static bool RemoveItem&lt;TKey, TValueList, TValue&gt;(this IDictionary&lt;TKey, TValueList&gt; listDictionary, TKey key, TValue value)\n        where TValueList : IList&lt;TValue&gt;, new()\n    {\n        if (listDictionary == null)\n            throw new ArgumentNullException();\n        TValueList values;\n        if (!listDictionary.TryGetValue(key, out values))\n            return false;\n        return values.Remove(value);\n    }\n}\n</code></pre>\n\n<p>This only handles querying elements by name, but you could extend this idea to attribute values as well.</p>\n\n<p>And then use it like:</p>\n\n<pre><code>    public static void Test()\n    {\n        string filePath = @\"filename.xml\";\n\n        var xdoc = XDocument.Load(filePath);\n        var repository = new XDocumentRepository(xdoc);\n\n        string defName = \"def\";\n        string defValue = \"Some Test Value For Querying\";\n\n        Test(repository, defName, defValue, null); // Assert element not found.\n\n        var test = new XElement(defName, new XAttribute(\"name\", defValue));\n\n        // Find the first deepest node in the document, for testing purposes.\n        var node = xdoc.Descendants().OrderByDescending(e =&gt; e.AncestorsAndSelf().Count()).First();\n        node.Add(test);\n\n        Test(repository, defName, defValue, test); // Assert element found\n\n        test.Attribute(\"name\").Value = \"fobar\";\n        Test(repository, defName, defValue, null); // Assert element not found when attribute value is changed\n\n        test.Attribute(\"name\").Value = defValue;\n        Test(repository, defName, defValue, test); // Assert element found when attribute value restored\n\n        test.Name = \"flubber\";\n        Test(repository, defName, defValue, null); // Assert element not found when name changed\n\n        test.Name = defName;\n        Test(repository, defName, defValue, test); // Assert element found when name restored\n\n        var parent = test.Parent;\n        var parentParent = parent.Parent;\n\n        test.Remove();\n        Test(repository, defName, defValue, null); // Assert element not found when removed.\n\n        parent.Add(test);\n        Test(repository, defName, defValue, test); // Assert element found when added back\n\n        if (parentParent != null)\n        {\n            parent.Remove();\n            Test(repository, defName, defValue, null); // Assert element not found when parent removed.\n\n            parentParent.Add(parent);\n            Test(repository, defName, defValue, test); // Assert element found when parent added back.\n        }\n    }\n\n    static void Test(XDocumentRepository repository, string elementName, string attributeValue, XElement expectedValue)\n    {\n        var xelm1 = repository.Document.Descendants(elementName).Where(d =&gt; (string)d.Attribute(\"name\") == attributeValue).SingleOrDefault();\n        var xelm2 = repository.ElementsByName(elementName).Where(d =&gt; (string)d.Attribute(\"name\") == attributeValue).SingleOrDefault();\n        Debug.Assert(xelm1 == xelm2 &amp;&amp; xelm1 == expectedValue); // No assert\n    }\n</code></pre>\n\n<p>Note that, because dictionaries are being used, the order in which elements are returned is undefined.  If multiple elements match any given query, you can sort them into document order by using <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.linq.xnode.comparedocumentorder%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>XNode.CompareDocumentOrder</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 220, "user_id": 1509939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0466cb74b659df4bc2d1cc9255da4045?s=128&d=identicon&r=PG", "display_name": "Megha", "link": "https://stackoverflow.com/users/1509939/megha"}, "is_accepted": false, "score": 0, "last_activity_date": 1436453378, "creation_date": 1436453378, "answer_id": 31320980, "question_id": 31303640, "link": "https://stackoverflow.com/questions/31303640/linq-performance-parsing-xml-file/31320980#31320980", "title": "Linq performance parsing XML file", "body": "<p>You might want to give a try with this. I tried this on my machine and I can see it to be beneficial if the order is not really important to you though i did not print out the elements being selected. Depending on what your  actual code is you might need to take care of synchronization using locks.</p>\n\n<pre><code>stopwatch.Restart();\nParallel.For(0, 1000, i =&gt;\n{\n   foreach (var elm in xdoc.Descendants(\"def\"))\n   {\n        if (elm.Attribute(\"name\").Value == \"def\")\n        {\n               xelm = elm;\n               break;\n         }\n    }\n});\nstopwatch.Stop();\nConsole.WriteLine(stopwatch.ElapsedMilliseconds);\n</code></pre>\n\n<p>Please note that parallelising the line \"  foreach (var elm in xdoc.Descendants(\"def\")) \" using Parallel.foreach did not seem to give a good performance on my machine which could be due to the fact that the overhead in parallelising this is high (my guess).</p>\n"}], "owner": {"reputation": 9495, "user_id": 1395740, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/793c4377313587d742fad6f069d92d89?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/1395740/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "accepted_answer_id": 31303733, "answer_count": 4, "score": 2, "last_activity_date": 1436453378, "creation_date": 1436389232, "question_id": 31303640, "link": "https://stackoverflow.com/questions/31303640/linq-performance-parsing-xml-file", "title": "Linq performance parsing XML file", "body": "<p>I need to parse an XML file  (1~10 MB); I am using <code>XDocument</code> for the purpose.</p>\n\n<p>At the moment I am using <code>Linq</code> to query the XML document, but I need to improve the performance of my application and I thought to replace the <code>Linq</code> query with <em>old style loops</em>, but I did not have any boost.</p>\n\n<p>Following is a piece of code with the most called query:</p>\n\n<pre><code>Stopwatch stopwatch = new Stopwatch();\nXDocument xdoc = XDocument.Load(\"filename.xml\");\nstring def = \"Version\";\nXElement xelm;\n\nstopwatch.Start();\n\nfor (int i = 0; i &lt; 1000; i++)\n    xelm = xdoc.Descendants(\"def\").Where(d =&gt; d.Attribute(\"name\").Value == def).Single();\n\nstopwatch.Stop();\nConsole.WriteLine(stopwatch.ElapsedMilliseconds);\n\n\nstopwatch.Restart();\n\nfor (int i = 0; i &lt; 1000; i++)\n{\n    foreach (var elm in xdoc.Descendants(\"def\"))\n    {\n        if (elm.Attribute(\"name\").Value == def)\n        {\n            xelm = elm;\n            break;\n        }\n    }\n}\n\nstopwatch.Stop();\nConsole.WriteLine(stopwatch.ElapsedMilliseconds);\n</code></pre>\n\n<p>The elapsed time is pretty much the same for both versions, and for me this result is quite strange since I thought that the <code>Where</code> method of <code>Linq</code> has to create a new list when invoked.</p>\n\n<p>Why both versions have the same performace? Is there a way to improve the original code?</p>\n"}, {"tags": ["c#", "properties", "lambda", "linq-expressions", "propertyinfo"], "comments": [{"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1436389343, "post_id": 31303566, "comment_id": 50597211, "body": "Please show a sample invocation of <code>SetPropertyValue</code>."}, {"owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "edited": false, "score": 1, "creation_date": 1436389572, "post_id": 31303566, "comment_id": 50597297, "body": "Why you don&#39;t use SetPropertyValue ,directly? like: `ContactImport.Address.SetPropertyValue(c =&gt; c.id, 5)&#39; ?"}, {"owner": {"reputation": 2289, "user_id": 263651, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ac074df80909eac5b2cf86054ad19f34?s=128&d=identicon&r=PG", "display_name": "Hammerstein", "link": "https://stackoverflow.com/users/263651/hammerstein"}, "edited": false, "score": 0, "creation_date": 1436390198, "post_id": 31303566, "comment_id": 50597640, "body": "I have taken a string before to build a property expression, <a href=\"https://github.com/tbd-develop/roastpotato/blob/master/server/dotnet/RoastPotato.Recipes/Infrastructure/RecipeExtensions.cs\" rel=\"nofollow noreferrer\">github.com/tbd-develop/roastpotato/blob/master/server/dotnet&zwnj;&#8203;/&hellip;</a> it wouldn&#39;t be too hard to adapt this to give you an expression to set."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 1, "creation_date": 1436391089, "post_id": 31303566, "comment_id": 50598043, "body": "&quot;Nested properties&quot; generally implies recursion. If you can provide <a href=\"https://stackoverflow.com/help/mcve\">a good, <i>minimal</i>, <i>complete</i> code example</a> that clearly illustrates your question, it would be feasible to provide an actual answer. In the meantime, <a href=\"https://stackoverflow.com/a/30333434\">my answer to this previous question</a> might give you some ideas about how to proceed. (It uses reflection instead of expressions and is specifically about value types, but the basic concepts are the same)."}, {"owner": {"reputation": 1189, "user_id": 141995, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GK1uO.png?s=128&g=1", "display_name": "Gaz", "link": "https://stackoverflow.com/users/141995/gaz"}, "reply_to_user": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "edited": false, "score": 0, "creation_date": 1436392482, "post_id": 31303566, "comment_id": 50598708, "body": "@AliAdlavaran I can&#39;t do that as it&#39;s a generic method which is why I use the expression, this way I can use the same function for multiple different import types."}, {"owner": {"reputation": 1189, "user_id": 141995, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GK1uO.png?s=128&g=1", "display_name": "Gaz", "link": "https://stackoverflow.com/users/141995/gaz"}, "reply_to_user": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 0, "creation_date": 1436392718, "post_id": 31303566, "comment_id": 50598819, "body": "@dasblinkenlight Hope the above edit helps the <code>AssociatedProperty</code> would be set using something like <code>x=&gt;x.Contact.FirstName</code>"}], "owner": {"reputation": 1189, "user_id": 141995, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GK1uO.png?s=128&g=1", "display_name": "Gaz", "link": "https://stackoverflow.com/users/141995/gaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1436447896, "creation_date": 1436388985, "last_edit_date": 1436447896, "question_id": 31303566, "link": "https://stackoverflow.com/questions/31303566/setting-nested-properties-via-an-expression", "title": "Setting nested properties via an Expression", "body": "<p>I have the following object:</p>\n\n<pre><code>public class ContactImport { \n    public long Id {get;set;}\n    public Contact Contact {get;set;}\n    public Company Company {get;set;}\n    public Address Address {get;set;}\n}\n</code></pre>\n\n<p>I want to be able to set the properties on the the nested objects dynamically based on an expression passed in (<code>Expression&lt;Func&lt;T, dynamic&gt;&gt;</code>).</p>\n\n<p>To do this I have the following method, this works fine for setting properties on the top level object (such as Id) but fails when trying to set anything on the nested objects (such as Contact.FirstName)</p>\n\n<pre><code>public static void SetPropertyValue&lt;T, TProp&gt;(this T target, Expression&lt;Func&lt;T, TProp&gt;&gt; member, TProp value) {\n    var selectorExpr = (MemberExpression)(member.Body is UnaryExpression ? ((UnaryExpression)member.Body).Operand : member.Body);\n    if (selectorExpr != null) {\n        var property = selectorExpr.Member as PropertyInfo;\n        if (property != null) {\n            property.SetValue(target, value);\n        }\n     }\n }\n</code></pre>\n\n<p>It looks like it's trying to set the property on the top level object but can't. I take it this is possible but I'm unsure how to achieve it with what I currently have.</p>\n\n<p>The <code>SetPropertyValue</code> method is invoke like this:</p>\n\n<pre><code>public class ImportCheck&lt;T&gt; {\n\n    public int id { get; set; }\n    public string Name { get; set; }\n    public Type Type { get; set; }\n    public bool Required { get; set; }\n    public int? MinLength { get; set; }\n    public int? MaxLength { get; set; }\n    public string Value { get; set; }\n    public Expression&lt;Func&lt;T, dynamic&gt;&gt; AssociatedProperty { get; set; }\n}\n\n\n    T pt = (T)Activator.CreateInstance(typeof(T));\n    foreach (var m in mapping) {\n        pt.SetPropertyValue(m.AssociatedProperty, Convert.ChangeType(m.Value, Nullable.GetUnderlyingType(m.Type) ?? m.Type));\n    }\n</code></pre>\n\n<p>In the above example <code>T</code> is <code>ContactImport</code>, <code>m.AssociatedProperty</code> is the expression and <code>mapping</code> is a <code>List&lt;ImportCheck&lt;ContactImport&gt;&gt;</code>. </p>\n\n<p><strong>Update</strong></p>\n\n<p>My issue seems to boil down to the fact that the expression being passed into <code>SetPropertyValue</code> has a return type of <code>dynamic</code>. If this is set to <code>int</code> and the property on the nested object is an <code>int</code> then it all works. The problem I have then is that I need to explicitly set the result of the expression to match the type of the target property. This however leaves me with another issue in that I need a list of <code>ImportCheck</code>s with the possibility of each <code>Expression&lt;Func&lt;T,dynamic&gt;&gt;</code> having a different return type.</p>\n"}, {"tags": ["c#", "arrays", "image", "parameters", "bytearray"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1436389292, "post_id": 31303550, "comment_id": 50597177, "body": "And how do you save the images?"}, {"owner": {"reputation": 10220, "user_id": 70104, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/859c44ae8a94cf8def8a9728369fcd2e?s=128&d=identicon&r=PG", "display_name": "Chris Dunaway", "link": "https://stackoverflow.com/users/70104/chris-dunaway"}, "edited": false, "score": 5, "creation_date": 1436389294, "post_id": 31303550, "comment_id": 50597178, "body": "Please show the complete exception along with a stack trace, as well as the code that is throwing the exception."}, {"owner": {"reputation": 28707, "user_id": 125981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2077dbed28ae040719cbe698800ec29?s=128&d=identicon&r=PG", "display_name": "Mark Schultheiss", "link": "https://stackoverflow.com/users/125981/mark-schultheiss"}, "edited": false, "score": 1, "creation_date": 1436389360, "post_id": 31303550, "comment_id": 50597221, "body": "As others noted the code for &quot;save out a picture from my other program and try to open it in the test program&quot; would be useful to see."}, {"owner": {"reputation": 31, "user_id": 5095785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6SdGyzZqU00/AAAAAAAAAAI/AAAAAAAAAGU/AJu5HuGQ1CE/photo.jpg?sz=128", "display_name": "Zachary Dentler", "link": "https://stackoverflow.com/users/5095785/zachary-dentler"}, "edited": false, "score": 0, "creation_date": 1436390183, "post_id": 31303550, "comment_id": 50597630, "body": "edited. That&#39;s the whole thing. My big program is saving images exactly the same way."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5095785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6SdGyzZqU00/AAAAAAAAAAI/AAAAAAAAAGU/AJu5HuGQ1CE/photo.jpg?sz=128", "display_name": "Zachary Dentler", "link": "https://stackoverflow.com/users/5095785/zachary-dentler"}, "edited": false, "score": 0, "creation_date": 1436415184, "post_id": 31303991, "comment_id": 50604962, "body": "Good to know and thank you for the info. But the problem persists in the same manner. I can open one file but not one that is exactly the same but created from my other program. My other program also adds some extra info above the image which I must manually delete, but then the files are exactly the same. I save and then cannot read it in my test program."}, {"owner": {"reputation": 31, "user_id": 5095785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6SdGyzZqU00/AAAAAAAAAAI/AAAAAAAAAGU/AJu5HuGQ1CE/photo.jpg?sz=128", "display_name": "Zachary Dentler", "link": "https://stackoverflow.com/users/5095785/zachary-dentler"}, "edited": false, "score": 0, "creation_date": 1436416178, "post_id": 31303991, "comment_id": 50605242, "body": "So I decided to copy the text from the working file and paste it into the other non-working file, just to make sure they were identical and it still didn&#39;t work. Then when I pasted the working file text back into itself after deleting its contents it failed to open and threw the same error. What is it about being modified that causes this? Even when the modification is just deleting the text and repasting the same text?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 31, "user_id": 5095785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6SdGyzZqU00/AAAAAAAAAAI/AAAAAAAAAGU/AJu5HuGQ1CE/photo.jpg?sz=128", "display_name": "Zachary Dentler", "link": "https://stackoverflow.com/users/5095785/zachary-dentler"}, "edited": false, "score": 0, "creation_date": 1436417548, "post_id": 31303991, "comment_id": 50605618, "body": "Text? Bitmap files need tools designed for processing binary data."}, {"owner": {"reputation": 31, "user_id": 5095785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6SdGyzZqU00/AAAAAAAAAAI/AAAAAAAAAGU/AJu5HuGQ1CE/photo.jpg?sz=128", "display_name": "Zachary Dentler", "link": "https://stackoverflow.com/users/5095785/zachary-dentler"}, "edited": false, "score": 0, "creation_date": 1436417767, "post_id": 31303991, "comment_id": 50605676, "body": "The images are being converted to byte arrays then saved to a text file. Which works, but not consistently. Is this problem caused by encoding? Or lack thereof?"}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 31, "user_id": 5095785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6SdGyzZqU00/AAAAAAAAAAI/AAAAAAAAAGU/AJu5HuGQ1CE/photo.jpg?sz=128", "display_name": "Zachary Dentler", "link": "https://stackoverflow.com/users/5095785/zachary-dentler"}, "edited": false, "score": 0, "creation_date": 1436417952, "post_id": 31303991, "comment_id": 50605723, "body": "Perhaps.  You should at least use binary tools (eg hexadecimal view of bytes) to determine what is different between your working and non-working cases."}], "tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": false, "score": 3, "last_activity_date": 1436390419, "creation_date": 1436390419, "answer_id": 31303991, "question_id": 31303550, "link": "https://stackoverflow.com/questions/31303550/c-byte-array-to-image-not-working-with-identical-byte-arrays/31303991#31303991", "title": "C# byte array to image not working with identical byte arrays", "body": "<p>This code contains a common problem.  Here you create an <code>Image</code> bound to a stream containing your bitmap...</p>\n\n<pre><code>public Image ByteArrayToImage(byte[] byteArrayIn)\n{\n    using (MemoryStream ms = new MemoryStream(byteArrayIn))\n    {\n        ms.Position = 0;\n        Image returnImage = Image.FromStream(ms);\n        return returnImage;\n    }\n}\n</code></pre>\n\n<p>... and the <code>using</code> block disposes the <code>MemoryStream</code> instance on the way out, which makes the <code>Image</code> rather useless.</p>\n\n<p>You can get an <code>Image</code> that manages its own memory instead of expecting your stream to stick around by calling <code>Clone()</code>:</p>\n\n<pre><code>public Image ByteArrayToImage(byte[] byteArrayIn)\n{\n    using (MemoryStream ms = new MemoryStream(byteArrayIn))\n    using (Image returnImage = Image.FromStream(ms))\n    {\n        return returnImage.Clone();\n    }\n}\n</code></pre>\n\n<p>The clone isn't bound to the original stream.</p>\n"}], "owner": {"reputation": 31, "user_id": 5095785, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6SdGyzZqU00/AAAAAAAAAAI/AAAAAAAAAGU/AJu5HuGQ1CE/photo.jpg?sz=128", "display_name": "Zachary Dentler", "link": "https://stackoverflow.com/users/5095785/zachary-dentler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1436390419, "creation_date": 1436388917, "last_edit_date": 1436390140, "question_id": 31303550, "link": "https://stackoverflow.com/questions/31303550/c-byte-array-to-image-not-working-with-identical-byte-arrays", "title": "C# byte array to image not working with identical byte arrays", "body": "<p>The complete code</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.IO;\n\nnamespace WindowsFormsApplication1\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        //Display byte array as image\n        private void button1_Click(object sender, EventArgs e)\n        {\n            pictureBox1.SizeMode = PictureBoxSizeMode.StretchImage;\n            Image img = ByteArrayToImage(File.ReadAllBytes(\"\")); //fill with path info\n\n            pictureBox1.Image = (Image)img.Clone();\n        }\n\n        //Convert to image from bytes\n        public Image ByteArrayToImage(byte[] byteArrayIn)\n        {\n            using (MemoryStream ms = new MemoryStream(byteArrayIn))\n            {\n                ms.Position = 0;\n                Image returnImage = Image.FromStream(ms);\n                return returnImage;\n            }\n        }\n\n        //Open Image for conversion\n        private void loadImage_Click(object sender, EventArgs e)\n        {\n            OpenFileDialog opf = new OpenFileDialog();\n            DialogResult dr = new DialogResult();\n            dr = opf.ShowDialog();\n            if (dr == DialogResult.OK)\n            {\n                pictureBox1.SizeMode = PictureBoxSizeMode.StretchImage;\n                pictureBox1.Image = Image.FromFile(opf.FileName);\n            }\n        }\n\n        private void convertImage_Click(object sender, EventArgs e)\n        {\n            //Choose Path to Save To\n            SaveFileDialog saveDialog = new SaveFileDialog();\n            saveDialog.Title = \"Choose Directory and File Name\";\n            saveDialog.Filter = \"Canga Comix *.CCMX|*.CCMX\";\n            DialogResult dr = saveDialog.ShowDialog();\n            if (dr == DialogResult.OK)\n            {\n                byte[] array;\n\n                //Save Image\n                using (MemoryStream ms = new MemoryStream())\n                {\n                    Image img = pictureBox1.Image;\n                    img.Save(ms, System.Drawing.Imaging.ImageFormat.Png);\n                    array = ms.ToArray();\n                }\n\n                using(FileStream fs = new FileStream(saveDialog.FileName, FileMode.Create))\n                {\n                    fs.Write(array, 0, array.Length);\n                }\n            }\n        }\n\n        //clear image\n        private void clearImage_Click(object sender, EventArgs e)\n        {\n            pictureBox1.Image = null;\n        }\n    }\n}\n</code></pre>\n\n<p>These are pretty standard. I have a test program that uses these methods. It opens an image in a pictureBox and then converts it to byte[] and clears the pictureBox Image. Then you can hit Load byte[] and it will display the picture properly as it runs the ByteArrayToImage method.</p>\n\n<p>Then if I save out a picture from my other program and try to open it in the test program it gives me the unholy \"Parameter is not valid\" error. Even though both text documents are exactly the same as far as I can tell.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 10220, "user_id": 70104, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/859c44ae8a94cf8def8a9728369fcd2e?s=128&d=identicon&r=PG", "display_name": "Chris Dunaway", "link": "https://stackoverflow.com/users/70104/chris-dunaway"}, "edited": false, "score": 0, "creation_date": 1436389017, "post_id": 31303536, "comment_id": 50597035, "body": "Make the <code>ClientListener</code> class public.  It is currently private."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1436389110, "post_id": 31303536, "comment_id": 50597090, "body": "This question has many duplicates. Please search to see if your problem is already reported, and solved, by someone else."}, {"owner": {"reputation": 23, "user_id": 4321905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5d2dd91c6526968dd15215e0896dedf?s=128&d=identicon&r=PG&f=1", "display_name": "Omar6995", "link": "https://stackoverflow.com/users/4321905/omar6995"}, "edited": false, "score": 0, "creation_date": 1436389493, "post_id": 31303536, "comment_id": 50597272, "body": "Thanks guys I didn&#39;t notice it ...."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 2126842, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/16410bb72de683277fa4850db352c10d?s=128&d=identicon&r=PG", "display_name": "Vijay Vj", "link": "https://stackoverflow.com/users/2126842/vijay-vj"}, "edited": false, "score": 0, "creation_date": 1563598131, "post_id": 31303573, "comment_id": 100761556, "body": "but internal works for the entire assembly!! But why does it creates such error message when two classes are in same assembly?"}, {"owner": {"reputation": 479, "user_id": 2638841, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/30efb03e74af194815328da48d956417?s=128&d=identicon&r=PG&f=1", "display_name": "SSD", "link": "https://stackoverflow.com/users/2638841/ssd"}, "reply_to_user": {"reputation": 187, "user_id": 2126842, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/16410bb72de683277fa4850db352c10d?s=128&d=identicon&r=PG", "display_name": "Vijay Vj", "link": "https://stackoverflow.com/users/2126842/vijay-vj"}, "edited": false, "score": 0, "creation_date": 1597834156, "post_id": 31303573, "comment_id": 112260829, "body": "@VijayVj - its because, access specifier of other class - Form1 is public. public means it can be accessible outside of assembly so if you would use internal class in Form 1, its of no use as internal can&#39;t be accessed outside so less accessible as it is restricting power of public. If you are sure your Form 1 class is not going to be used outside then make it internal and then you can use other internal class inside it."}], "tags": [], "owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "is_accepted": true, "score": 4, "last_activity_date": 1436389007, "creation_date": 1436389007, "answer_id": 31303573, "question_id": 31303536, "link": "https://stackoverflow.com/questions/31303536/c-inconsistent-accessibility-parameter-type-is-less-accessible-than-method/31303573#31303573", "title": "C# Inconsistent accessibility : parameter type is less accessible than method", "body": "<p>Make your class public.</p>\n\n<pre><code>public class ClientListener\n...\n</code></pre>\n\n<p>The default access for a class if you do not specify one explicitly is internal.  Internal is less accessible than public, therefore you're getting an error.</p>\n"}], "owner": {"reputation": 23, "user_id": 4321905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5d2dd91c6526968dd15215e0896dedf?s=128&d=identicon&r=PG&f=1", "display_name": "Omar6995", "link": "https://stackoverflow.com/users/4321905/omar6995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7403, "favorite_count": 0, "closed_date": 1436389068, "accepted_answer_id": 31303573, "answer_count": 1, "score": -1, "last_activity_date": 1436389098, "creation_date": 1436388873, "question_id": 31303536, "link": "https://stackoverflow.com/questions/31303536/c-inconsistent-accessibility-parameter-type-is-less-accessible-than-method", "closed_reason": "Duplicate", "title": "C# Inconsistent accessibility : parameter type is less accessible than method", "body": "<p>I'm getting an error I can't find how to fix here's the code</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace MITM_Omar\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n\n        }\n\n        public void button1_Click(object sender, EventArgs e)\n        {\n          ClientListener Client = new ClientListener();\n            Client.ClientConnected += clientconnect;\n        }\n        public void clientconnect(ClientListener client)\n        {\n            ServeurListener Serveur = new ServeurListener(\"213.248.126.39\", 5555);\n            client.associated = Serveur;\n            Serveur.associated = client;\n            client.onReception += forwadtoserver;\n            Serveur.onReception += forwadtoclient;\n            Serveur.connect(); \n        }\n        public void forwadtoclient(ServeurListener sender, byte[] buffer)\n        {\n            sender.associated.send(buffer);\n        }\n        public void forwadtoserver(ClientListener sender, byte[] buffer)\n        {\n            sender.associated.send(buffer);\n        }\n    }\n}\n</code></pre>\n\n<p>I get the error Inconsistent accessibility : parameter type'MITM_OMAR.ClientListener' is less accessible than method 'MITM_OMAR.Form1.clientconnect(MITM_OMAR.ClientListener)</p>\n\n<p>Here's the Client Listener class</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Net.Sockets;\nusing System.Threading;\nusing System.Net;\nnamespace MITM_Omar\n{\n    class ClientListener\n    {\n        public Socket _Socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);\n        public Thread _ConnectionThread;\n        public Thread _ReceptionThread;\n\n\n        public delegate void onClientActionEventHandler(ClientListener client);\n        public event onClientActionEventHandler ClientConnected;\n\n\n        public delegate void onTravellingDataEventHandler(ClientListener sender, byte[] buffer);\n        public event onTravellingDataEventHandler onReception;\n        public ServeurListener associated;\n       public ClientListener()\n        {\n            _ConnectionThread = new Thread(new ThreadStart(accept));\n            _Socket.Connect(\"127.0.0.1\", 5555);\n            _ConnectionThread.Start();\n            _ReceptionThread = new Thread(new ThreadStart(Reception));\n            _ReceptionThread.Start();\n        }\n        public void accept()\n        {\n            while (true)\n            {\n                Socket socket = _Socket.Accept();\n                if (ClientConnected != null)\n                {\n                    ClientConnected(this);\n                }\n            }\n\n        }\n        public void send(byte[] data)\n        {\n            _Socket.Send(data);\n\n\n        }\n        public void Reception()\n        {\n            // On re\u00e7oit les donn\u00e9es tant qu'on est connect\u00e9.\n            while (_Socket.Connected)\n            {\n                // On cr\u00e9e notre buffer dynamique.\n                byte[] _buffer = new byte[_Socket.Available];\n\n                // Si le buffer n'est pas vide, on le parse.\n                if (_buffer.Length != 0)\n                {\n                    _Socket.Receive(_buffer); // R\u00e9c\u00e9ption des donn\u00e9es.\n                    if (onReception != null) onReception(this, _buffer); // un event qui dit qui a re\u00e7u des donn\u00e9es et le tableau de bytes re\u00e7u\n\n                }\n            }\n        }\n\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "android", "xamarin"], "comments": [{"owner": {"reputation": 640, "user_id": 1264899, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mPCVH.png?s=128&g=1", "display_name": "godidier", "link": "https://stackoverflow.com/users/1264899/godidier"}, "edited": false, "score": 0, "creation_date": 1436391842, "post_id": 31303496, "comment_id": 50598409, "body": "Check if you do not have any special characters like &#39;-&#39; in the file name of your image."}, {"owner": {"reputation": 20105, "user_id": 451540, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/jajjn.png?s=128&g=1", "display_name": "thumbmunkeys", "link": "https://stackoverflow.com/users/451540/thumbmunkeys"}, "edited": false, "score": 0, "creation_date": 1436392209, "post_id": 31303496, "comment_id": 50598575, "body": "is the build action of the image set to <code>AndroidResource</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 660, "user_id": 978656, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6446f0a408d33dce83e8f08e1735e01b?s=128&d=identicon&r=PG", "display_name": "gmaster", "link": "https://stackoverflow.com/users/978656/gmaster"}, "is_accepted": true, "score": 0, "last_activity_date": 1436452037, "creation_date": 1436452037, "answer_id": 31320445, "question_id": 31303496, "link": "https://stackoverflow.com/questions/31303496/xamarin-visual-studio-not-recognizing-images/31320445#31320445", "title": "Xamarin Visual Studio not recognizing images", "body": "<p>Right clicking the folder in solution explorer, selecting add > existing file, selecting the file, and then rebuilding the project solved the issue.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4232181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dMtXalNX-xw/AAAAAAAAAAI/AAAAAAAAAC0/QiPQ37Ef7Qc/photo.jpg?sz=128", "display_name": "T shuvo", "link": "https://stackoverflow.com/users/4232181/t-shuvo"}, "is_accepted": false, "score": 1, "last_activity_date": 1480485687, "creation_date": 1480485687, "answer_id": 40881367, "question_id": 31303496, "link": "https://stackoverflow.com/questions/31303496/xamarin-visual-studio-not-recognizing-images/40881367#40881367", "title": "Xamarin Visual Studio not recognizing images", "body": "<p>just remove the .imagetype portion </p>\n\n<p>like: <strong>image.png</strong> will be replace by <strong>image</strong></p>\n\n<p>its work for me</p>\n"}], "owner": {"reputation": 660, "user_id": 978656, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6446f0a408d33dce83e8f08e1735e01b?s=128&d=identicon&r=PG", "display_name": "gmaster", "link": "https://stackoverflow.com/users/978656/gmaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1703, "favorite_count": 0, "accepted_answer_id": 31320445, "answer_count": 2, "score": 0, "last_activity_date": 1480485687, "creation_date": 1436388747, "question_id": 31303496, "link": "https://stackoverflow.com/questions/31303496/xamarin-visual-studio-not-recognizing-images", "title": "Xamarin Visual Studio not recognizing images", "body": "<p>I'm using Xamarin to develop an Android app in C# using Visual Studio 2012.  It's been going fairly well so far but I'm having a problem with designing the interface.  I put some images in Resources/drawable for the project, but I can't get the solution explorer in VS to pick up that these images are there.  It only shows the default Icon.png file that is included in every new project.  I was briefly able to get it to detect one other image by cleaning and rebuilding the solution, but that hasn't worked since, and even in that case I couldn't get it to actually display in an ImageView.  I'm unable to point my ImageView to any of my images since VS isn't creating a reference for them to use (e.g. @drawable/myimage).  Refreshing the solution explorer does nothing.  Anyone have any other ideas on what I could try?</p>\n"}, {"tags": ["c#", ".net", "file", "atomic"], "comments": [{"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1436389916, "post_id": 31303474, "comment_id": 50597474, "body": "At the end of those operations where actually is the file? Is it in one spot or multiple? I would guess that it is in the last success move&#39;s location only. It would shed some light on what is happening."}, {"owner": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "reply_to_user": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1436390136, "post_id": 31303474, "comment_id": 50597601, "body": "@mikez, I&#39;ve added this info to the question - it&#39;s 3rd"}, {"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 1, "creation_date": 1436390230, "post_id": 31303474, "comment_id": 50597665, "body": "Interesting, but remember atomic means the system is observable in the starting state (the file is unchanged) or the ending state (the file is in a new location) but not in between. It does not make any guarantee about <i>when</i> it is observable in a particular state. It also makes no guarantee about the order in which particular operations are processed."}, {"owner": {"reputation": 1570, "user_id": 5008193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iOKgE.jpg?s=128&g=1", "display_name": "Graffito", "link": "https://stackoverflow.com/users/5008193/graffito"}, "edited": false, "score": 0, "creation_date": 1436390752, "post_id": 31303474, "comment_id": 50597885, "body": "I believe that the file system behaves as indicated by @Peter duniho. But, I consider that the file move should send exceptions when operation fails (for any reason, even in case of concurent move). In other words, no exception shall be a guarantee of success. If the move behavior was normal (not the case), the code is perfectly correct. A work around is to test that file exists, i.e. File.Exists(newPath)."}, {"owner": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "reply_to_user": {"reputation": 1570, "user_id": 5008193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iOKgE.jpg?s=128&g=1", "display_name": "Graffito", "link": "https://stackoverflow.com/users/5008193/graffito"}, "edited": false, "score": 0, "creation_date": 1436526028, "post_id": 31303474, "comment_id": 50662267, "body": "@Graffito, I&#39;ve tried File.Exists as post Move validation step and it does not solve the issue - I can get two thread reported that it is moved and target exists, but it does not. Any thoughts? Things becomes much more interesting :)"}, {"owner": {"reputation": 1570, "user_id": 5008193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iOKgE.jpg?s=128&g=1", "display_name": "Graffito", "link": "https://stackoverflow.com/users/5008193/graffito"}, "edited": false, "score": 0, "creation_date": 1436527109, "post_id": 31303474, "comment_id": 50662897, "body": "I suspect a SMB2 file system cache issue. Look <a href=\"http://stackoverflow.com/questions/5159220/windows-file-share-why-sometimes-newly-created-files-arent-visible-for-some-pe\">here</a>. It&#39;s realy annoying: I also used the &quot;File.Move()&quot; for synchronization purpose in some applications."}], "answers": [{"comments": [{"owner": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "edited": false, "score": 1, "creation_date": 1436389987, "post_id": 31303760, "comment_id": 50597521, "body": "Does this all mean that successful competition of File.Move means ... nothing ? :) we should ensure then that that target file really exists via additional calls?"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "reply_to_user": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "edited": false, "score": 0, "creation_date": 1436390358, "post_id": 31303760, "comment_id": 50597718, "body": "I guess that depends on how you wrote the code. If your implementation actually ensured you only ever called <code>Move()</code> on a given file in one thread at a time, then the success of the call is (should be) indication of actual success. But in your scenario, yes...each individual operation does in fact succeed, but you are misusing the API and so are getting an undesirable result. If you care about the outcome, either fix your usage, or verify the result after the fact (noting, however, that will still not <i>guarantee</i> success...thread race conditions can still mislead you)."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 1, "creation_date": 1436390413, "post_id": 31303760, "comment_id": 50597743, "body": "Oh god, file systems are from the stone age. Not even a move is really atomic."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1436390719, "post_id": 31303760, "comment_id": 50597872, "body": "<i>&quot;file systems are from the stone age&quot;</i> -- you can say that again. :) That said, it seems to me that to complain that <i>&quot;Not even a move is really atomic&quot;</i>, one must first define &quot;atomic&quot;. I don&#39;t know the specific implementation details, but assuming in NTFS one has to first obtain the actual file object handle, and then rename the hard link to that file object, it could be arguably true to say that the rename is &quot;atomic&quot; at the file system level. From the OS API point of view it&#39;s not, but at the file system level it could be."}, {"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1436392024, "post_id": 31303760, "comment_id": 50598493, "body": "It&#39;s just not what anybody wants. NTFS has a transaction log. They are able to make things atomic if they want to. Databases do it all the time. No excuses for the NTFS team."}, {"owner": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "edited": false, "score": 0, "creation_date": 1436442558, "post_id": 31303760, "comment_id": 50620439, "body": "@PeterDuniho, Can you advise an easiest reliable way to ensure that File.Move really succeeded without introducing complex central manager to be a point of synchronization?"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1436456632, "post_id": 31303760, "comment_id": 50631261, "body": "What does it mean for it to &quot;really succeed&quot; when you are allowing more than one attempt to occur concurrently? Which attempt do you want to actually have effect? What is your <i>specification</i> to unambiguously describe how to select the attempt that should succeed?"}, {"owner": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "edited": false, "score": 0, "creation_date": 1436467621, "post_id": 31303760, "comment_id": 50637939, "body": "@Peterduniho, let me try to define it, I thought it was clear, sorry. I don&#39;t want certain concurrent attempt to succeed, I just want to know <i>which one</i> actually done the deal and <i>which ones</i> silently failed."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1436468833, "post_id": 31303760, "comment_id": 50638589, "body": "Until you rid yourself of the race condition, I don&#39;t see a way to do that. You can call <code>File.Exists()</code> after performing the <code>File.Move()</code>, and I would expect that would <i>usually</i> give you some indication of success (i.e. if the intended new name is present, it <i>probably</i> succeeded), but I see no reason that depending on thread scheduling, you wouldn&#39;t still sometimes see <code>File.Exists()</code> return <code>true</code>, only to find some other thread still manage to change the name just moments later."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1436468976, "post_id": 31303760, "comment_id": 50638670, "body": "It seems to me that fundamentally, you have a flawed design...multiple threads all trying to rename the same file at the same time, I just cannot see any reason that&#39;s a desirable design, never mind correct, in the first place. Even ignoring the immediate concern, it just doesn&#39;t seem correct, and the immediate concern seems like reasonably strong proof of the flawed nature of the design."}, {"owner": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "edited": false, "score": 0, "creation_date": 1436544702, "post_id": 31303760, "comment_id": 50674770, "body": "@PeterDuniho, actually it&#39;s not several threads, but several servers running it code that point to same shared folder. As to File.Exsits, it doesn&#39;t really change anything (updated post). By the way i&#39;ve trying creating special &quot;.lock&quot; file while operations with file and it seems to work! Tested with multi-thread environment, not multi-server, but suspect it will be ok as well"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 1, "creation_date": 1436545557, "post_id": 31303760, "comment_id": 50675284, "body": "Yes, for cross-process synchronization, a &quot;lock&quot; file can work (make sure you use it properly, with the &quot;CreateNew&quot; option, to ensure only one process can ever create it). If the processes are on the same machine, you can use a named mutex for the same result. Both of these are what I&#39;d call solutions that involve a <i>&quot;complex central manager to be a point of synchronization&quot;</i>, which you said you were trying to avoid. But yes, synchronizing the processes is the only reliable way to fix the issue."}], "tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": true, "score": 4, "last_activity_date": 1436389669, "creation_date": 1436389669, "answer_id": 31303760, "question_id": 31303474, "link": "https://stackoverflow.com/questions/31303474/concurrent-file-move-of-the-same-file/31303760#31303760", "title": "Concurrent File.Move of the same file", "body": "<blockquote>\n  <p>Does anyone know what is wrong with this code?</p>\n</blockquote>\n\n<p>I guess that depends on what you mean by \"wrong\".</p>\n\n<p>The behavior you're seeing is not IMHO unexpected, at least if you're using NTFS (other file systems may or may not behave similarly).</p>\n\n<p>The documentation for the underlying OS API (<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365239(v=vs.85).aspx\" rel=\"nofollow\">MoveFile()</a> and <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365240(v=vs.85).aspx\" rel=\"nofollow\">MoveFileEx()</a> functions) is not specific, but in general the APIs are thread-safe, in that they guarantee the <em>file system</em> will not be corrupted by concurrent operations (of course, your own data could be corrupted, but it will be done in a file-system-coherent way).</p>\n\n<p>Most likely what is occurring is that as the move-file operation proceeds, it does so by first getting the actual file handle from the given directory link to it (in NTFS, all \"file names\" that you see are actually hard links to an underlying file object). Having obtained that file handle, the API then creates a new file name for the underlying file object (i.e. as a hard link), and then deletes the previous hard link.</p>\n\n<p>Of course, as this progresses, there is a window during the time between a thread having obtained the underlying file handle but before the original hard link has been deleted. This allows some but not all of the other concurrent move operations to appear to succeed. I.e. eventually the original hard link doesn't exist and further attempts to move it won't succeed.</p>\n\n<p>No doubt the above is an oversimplification. File system behaviors can be complex. In particular, your stated observation is that you only wind up with a single instance of the file when all is said and done. This suggests that the API does also somehow coordinate the various operations, such that only one of the newly-created hard links survives, probably by virtue of the API actually just renaming the associated hard link after retrieving the file object handle, as opposed to creating a new one and deleting the old one (implementation detail).</p>\n\n<p><br/>\nAt the end of the day, what's \"wrong\" with the code is that it is intentionally attempting to perform concurrent operations on a single file. While the file system itself will ensure that it remains coherent, it's up to your own code to ensure that such operations are coordinated so that the results are predictable and reliable.</p>\n"}], "owner": {"reputation": 4535, "user_id": 1319147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/53LDq.jpg?s=128&g=1", "display_name": "Eugene D. Gubenkov", "link": "https://stackoverflow.com/users/1319147/eugene-d-gubenkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1732, "favorite_count": 0, "accepted_answer_id": 31303760, "answer_count": 1, "score": 3, "last_activity_date": 1436717142, "creation_date": 1436388694, "last_edit_date": 1495540272, "question_id": 31303474, "link": "https://stackoverflow.com/questions/31303474/concurrent-file-move-of-the-same-file", "title": "Concurrent File.Move of the same file", "body": "<p>It was clearly stated that File.Move is atomic operation here: <a href=\"https://stackoverflow.com/questions/774098/atomicity-of-file-move\">Atomicity of File.Move</a>.</p>\n\n<p>But the following code snippet results in <strong>visibility of moving the same file multiple times</strong>.</p>\n\n<p>Does anyone know what is wrong with this code?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Threading.Tasks;\n\nnamespace FileMoveTest\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string path = \"test/\" + Guid.NewGuid().ToString();\n\n            CreateFile(path, new string('a', 10 * 1024 * 1024));\n\n            var tasks = new List&lt;Task&gt;();\n\n            for (int i = 0; i &lt; 10; i++)\n            {\n                var task = Task.Factory.StartNew(() =&gt;\n                {\n                    try\n                    {\n                        string newPath = path + \".\" + Guid.NewGuid();\n\n                        File.Move(path, newPath);\n\n                        // this line does NOT solve the issue\n                        if (File.Exists(newPath))\n                            Console.WriteLine(string.Format(\"Moved {0} -&gt; {1}\", path, newPath));\n                    }\n                    catch (Exception e)\n                    {\n                        Console.WriteLine(string.Format(\"  {0}: {1}\", e.GetType(), e.Message));\n                    }\n                });\n\n                tasks.Add(task);\n            }\n\n            Task.WaitAll(tasks.ToArray());\n        }\n\n        static void CreateFile(string path, string content)\n        {\n            string dir = Path.GetDirectoryName(path);\n\n            if (!Directory.Exists(dir))\n            {\n                Directory.CreateDirectory(dir);\n            }\n\n            using (FileStream f = new FileStream(path, FileMode.OpenOrCreate))\n            {\n                using (StreamWriter w = new StreamWriter(f))\n                {\n                    w.Write(content);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The paradoxical output is below. Seems that file was moved multiple times onto different locations. On the disk only one of them is present. Any thoughts?</p>\n\n<pre>Moved test/eb85560d-8c13-41c1-926a-6871be030742 -> test/eb85560d-8c13-41c1-926a-6871be030742.0018d317-ed7c-4732-92ac-3bb974d29017\nMoved test/eb85560d-8c13-41c1-926a-6871be030742 -> test/eb85560d-8c13-41c1-926a-6871be030742.3965dc15-7ef9-4f36-bdb7-94a5939b17db\nMoved test/eb85560d-8c13-41c1-926a-6871be030742 -> test/eb85560d-8c13-41c1-926a-6871be030742.fb66306a-5a13-4f26-ade2-acff3fb896be\nMoved test/eb85560d-8c13-41c1-926a-6871be030742 -> test/eb85560d-8c13-41c1-926a-6871be030742.c6de8827-aa46-48c1-b036-ad4bf79eb8a9\nSystem.IO.FileNotFoundException: Could not find file 'C:\\file-move-test\\test\\eb85560d-8c13-41c1-926a-6871be030742'.\nSystem.IO.FileNotFoundException: Could not find file 'C:\\file-move-test\\test\\eb85560d-8c13-41c1-926a-6871be030742'.\nSystem.IO.FileNotFoundException: Could not find file 'C:\\file-move-test\\test\\eb85560d-8c13-41c1-926a-6871be030742'.\nSystem.IO.FileNotFoundException: Could not find file 'C:\\file-move-test\\test\\eb85560d-8c13-41c1-926a-6871be030742'.\nSystem.IO.FileNotFoundException: Could not find file 'C:\\file-move-test\\test\\eb85560d-8c13-41c1-926a-6871be030742'.\nSystem.IO.FileNotFoundException: Could not find file 'C:\\file-move-test\\test\\eb85560d-8c13-41c1-926a-6871be030742'.</pre>\n\n<p>The resulting file is here: <pre>eb85560d-8c13-41c1-926a-6871be030742.fb66306a-5a13-4f26-ade2-acff3fb896be</pre></p>\n\n<p><strong>UPDATE.</strong> I can confirm that checking File.Exists also does <strong>NOT</strong> solve the issue - it can report that single file was really moved into several different locations.</p>\n\n<p><strong>SOLUTION</strong>. The solution I end up with is following: Prior to operations with source file create special \"lock\" file, if it succeeded then we can be sure that only this thread got exclusive access to the file and we are safe to do anything we want. The below is right set of parameters to create suck \"lock\" file.</p>\n\n<pre><code>File.Open(lockPath, FileMode.CreateNew, FileAccess.Write);\n</code></pre>\n"}, {"tags": ["c#", "sql", "linq"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 1, "creation_date": 1436388809, "post_id": 31303469, "comment_id": 50596925, "body": "As ever, you should show what you&#39;ve already tried, along with what research you&#39;ve performed."}], "answers": [{"tags": [], "owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1436388811, "creation_date": 1436388811, "answer_id": 31303518, "question_id": 31303469, "link": "https://stackoverflow.com/questions/31303469/using-linq-to-group-by-multiple-properties-and-return-an-anonymous-type/31303518#31303518", "title": "Using linq to group by multiple properties and return an anonymous type", "body": "<p>You would get the same result with</p>\n\n<pre><code>SELECT distinct ProductId, ProductName\nFROM Items\n</code></pre>\n\n<p>So select the two columns and use <code>Distinct()</code> on the result.</p>\n"}, {"comments": [{"owner": {"reputation": 315, "user_id": 5011397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a786ce8b9cfadaf5f51c227eec7b540?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Peterson", "link": "https://stackoverflow.com/users/5011397/matthew-peterson"}, "edited": false, "score": 0, "creation_date": 1436389093, "post_id": 31303519, "comment_id": 50597081, "body": "Thank you very much for the clean and simple answer. Worked perfectly."}], "tags": [], "owner": {"reputation": 12144, "user_id": 259946, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/849b5057cdc84934daae1942749f0270?s=128&d=identicon&r=PG", "display_name": "hazzik", "link": "https://stackoverflow.com/users/259946/hazzik"}, "is_accepted": false, "score": 2, "last_activity_date": 1436388816, "creation_date": 1436388816, "answer_id": 31303519, "question_id": 31303469, "link": "https://stackoverflow.com/questions/31303469/using-linq-to-group-by-multiple-properties-and-return-an-anonymous-type/31303519#31303519", "title": "Using linq to group by multiple properties and return an anonymous type", "body": "<p>You don't need to group here. Use distinct</p>\n\n<pre><code>Items.Select(i =&gt; new { i.ProductId, i.ProductName }).Distinct();\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 5011397, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7a786ce8b9cfadaf5f51c227eec7b540?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Peterson", "link": "https://stackoverflow.com/users/5011397/matthew-peterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1436388816, "creation_date": 1436388657, "question_id": 31303469, "link": "https://stackoverflow.com/questions/31303469/using-linq-to-group-by-multiple-properties-and-return-an-anonymous-type", "title": "Using linq to group by multiple properties and return an anonymous type", "body": "<p>How I can write the following query in linq and return the results as an anonymous object?</p>\n\n<pre><code>SELECT ProductId, ProductName\nFROM Items\nGROUP BY ProductId, ProductName\n</code></pre>\n"}, {"tags": ["c#", "registry"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1436389107, "post_id": 31303454, "comment_id": 50597089, "body": "&quot;//Reads as SOFTWARE\\\\Wow6432Node\\\\Xactware\\\\Xactimate28\\\\&quot; is an incorrect comment. That is <i>not</i> the key being opened. Is this a typo or is it really a different key being accessed? Also, don&#39;t supply a trailing &quot;\\\\&quot; to OpenSubKey. If you <i>attach a debugger</i> you can inspect the <code>key</code> object directly - use the Watch or Immediate Evaluation Windows."}], "answers": [{"comments": [{"owner": {"reputation": 1557, "user_id": 180014, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2018d49f59b92a02e4a1d0e716c6e4b?s=128&d=identicon&r=PG", "display_name": "Cistoran", "link": "https://stackoverflow.com/users/180014/cistoran"}, "edited": false, "score": 0, "creation_date": 1436392229, "post_id": 31303943, "comment_id": 50598586, "body": "I figured out what my issue was, <code>sVersionSelected = versionServerBox.Text;</code> was pulling from the wrong text box and I didn&#39;t realize it. It&#39;s meant to get from <code>versionSelectorBox</code> but I got it working thanks to you giving me some code to troubleshoot mine against. Thanks!"}], "tags": [], "owner": {"reputation": 4396, "user_id": 4202984, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/62e6efea78c6e9bdc9a211b24c909874?s=128&d=identicon&r=PG", "display_name": "Jason H", "link": "https://stackoverflow.com/users/4202984/jason-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1436390699, "last_edit_date": 1436390699, "creation_date": 1436390262, "answer_id": 31303943, "question_id": 31303454, "link": "https://stackoverflow.com/questions/31303454/registrykey-getvalue-returns-null/31303943#31303943", "title": "RegistryKey.GetValue(..) returns null", "body": "<p>I will be honest, without having Xactimate installed, I do not have the same registry entry you do so I used Skype as my key.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Xn3aS.png\" alt=\"enter image description here\"></p>\n\n<p>I changed one thing, I changed it from \\ to using the literal string flag.\nFYI, I ran in this in LINQPad so ignore the 'dump' commands</p>\n\n<pre><code>var test = @\"SOFTWARE\\Wow6432Node\\Skype\\Phone\";\nvar reg = Microsoft.Win32.Registry.LocalMachine.OpenSubKey(test);\nreg.Dump(\"OpenSubKey: \");\nvar result = reg.GetValue(\"SkypeFolder\");\nresult.Dump(\"GetValue: \");\n</code></pre>\n\n<p>Here are the results from the two dumps\n<img src=\"https://i.stack.imgur.com/NzhRx.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 1557, "user_id": 180014, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2018d49f59b92a02e4a1d0e716c6e4b?s=128&d=identicon&r=PG", "display_name": "Cistoran", "link": "https://stackoverflow.com/users/180014/cistoran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1213, "favorite_count": 0, "accepted_answer_id": 31303943, "answer_count": 1, "score": 2, "last_activity_date": 1436390699, "creation_date": 1436388611, "last_edit_date": 1436388741, "question_id": 31303454, "link": "https://stackoverflow.com/questions/31303454/registrykey-getvalue-returns-null", "title": "RegistryKey.GetValue(..) returns null", "body": "<p>I'm trying to retrieve the value of a (REG_SZ) registry key and write it to a string. However this code seems to think the key is null or doesn't exist and won't allow me to <code>GetValue()</code> it. Here's the code I'm using to retrieve the value.</p>\n\n<pre><code>string s64BasePath = \"SOFTWARE\\\\Wow6432Node\\\\Xactware\\\\\";\nprivate void versionSelectorBox_SelectedIndexChanged(object sender, EventArgs e)\n{\n    showForms();\n    sVersionSelected = versionServerBox.Text;\n    if (b64Bit == true)\n    {\n        string sRKey = s64BasePath + sVersionSelected + \"\\\\\"; //Reads as SOFTWARE\\\\Wow6432Node\\\\Xactware\\\\Xactimate28\\\\\n        using (RegistryKey key = Registry.LocalMachine.OpenSubKey(sRKey))\n        {\n            if (key != null)\n            {\n                //label1.Text = \"Test.\"; //Reaches this point just fine\n                Object o = key.GetValue(\"Location\");\n                if (o != null)\n                {\n                    //label1.Text = \"Test.\"; //Does not reach this point, o = null?\n                    sLocationKey = Convert.ToString(o);\n                }\n            }\n        }\n        //label1.Text = sLocationKey;\n}\n</code></pre>\n\n<p>Here is what the registry looks like. As you can see the Location key exists in the path provided. However the code isn't dropping into the inner most if statement, acting like the <code>o</code> object is null.</p>\n\n<p><img src=\"https://i.imgur.com/fCDjLln.png\" alt=\"Registry Key Screenshot\">           </p>\n\n<p>Thanks in Advance.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 752, "user_id": 3390214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d352e10143a62c1fc5765565d028a629?s=128&d=identicon&r=PG&f=1", "display_name": "DanS", "link": "https://stackoverflow.com/users/3390214/dans"}, "edited": false, "score": 1, "creation_date": 1436388785, "post_id": 31303439, "comment_id": 50596911, "body": "My guess is maybe you aren&#39;t trimming whitespace or other characters? I just tested your format string and statement with some sample values, and it worked fine for me. Can you paste the &#39;exact&#39; value of your <code>dateString</code> value?"}, {"owner": {"reputation": 25180, "user_id": 668272, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e4b4df6df17383aa6721c783a5a87335?s=128&d=identicon&r=PG", "display_name": "Bas", "link": "https://stackoverflow.com/users/668272/bas"}, "edited": false, "score": 4, "creation_date": 1436388810, "post_id": 31303439, "comment_id": 50596926, "body": "Why don&#39;t you use the debugger to verify the value when the exception is thrown?"}, {"owner": {"reputation": 25, "user_id": 5094647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b2ef6a26b4d09933bb14877875196a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Donovan", "link": "https://stackoverflow.com/users/5094647/jay-donovan"}, "edited": false, "score": 0, "creation_date": 1436389098, "post_id": 31303439, "comment_id": 50597086, "body": "I figured it out.  There was a trailing \\r in the file after the date.  Thank you!"}, {"owner": {"reputation": 10871, "user_id": 1698987, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cg2Q3.jpg?s=128&g=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/1698987/noctis"}, "edited": false, "score": 0, "creation_date": 1436389158, "post_id": 31303439, "comment_id": 50597113, "body": "Why don&#39;t you use a <code>try{...} catch (exception e){...}</code> and look at the exception message and stack ?"}, {"owner": {"reputation": 25, "user_id": 5094647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b2ef6a26b4d09933bb14877875196a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Donovan", "link": "https://stackoverflow.com/users/5094647/jay-donovan"}, "edited": false, "score": 0, "creation_date": 1436389268, "post_id": 31303439, "comment_id": 50597166, "body": "I&#39;m new here, what do I do once a question has been resolved?  Do I just leave it or should I delete it?"}, {"owner": {"reputation": 1080, "user_id": 1120393, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6f342d790e54a2ab2bd4caec3f37f44f?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan", "link": "https://stackoverflow.com/users/1120393/nathan"}, "edited": false, "score": 0, "creation_date": 1436389568, "post_id": 31303439, "comment_id": 50597296, "body": "@JayDonovan Post an answer to your question below and then accept it."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5094647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b2ef6a26b4d09933bb14877875196a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Donovan", "link": "https://stackoverflow.com/users/5094647/jay-donovan"}, "edited": false, "score": 0, "creation_date": 1436389767, "post_id": 31303775, "comment_id": 50597384, "body": "I figured it out using Notepad++ to view all characters in the file.  There was a trailing \\r after the date.  Thank you."}, {"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "edited": false, "score": 2, "creation_date": 1436389895, "post_id": 31303775, "comment_id": 50597461, "body": "According to this I would replace your Split by <code>var lines = text.Split(new[] {&quot;\\r\\n&quot;, &quot;\\r&quot;, &quot;\\n&quot;}, StringSplitOptions.None)</code> Edit: changed to String.Split, since it is faster"}, {"owner": {"reputation": 22524, "user_id": 285795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/597432bc4cb512372176db67c6fba151?s=128&d=identicon&r=PG", "display_name": "\u03a9megaMan", "link": "https://stackoverflow.com/users/285795/%ce%a9megaman"}, "reply_to_user": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "edited": false, "score": 2, "creation_date": 1436390059, "post_id": 31303775, "comment_id": 50597563, "body": "@Matt <code>[\\r\\n]+</code> will do the same."}, {"owner": {"reputation": 4245, "user_id": 1028957, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/g0fqq.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1028957/matt"}, "edited": false, "score": 1, "creation_date": 1436390134, "post_id": 31303775, "comment_id": 50597599, "body": "Yes, you&#39;re right (it was <code>\\r?\\n|\\r</code> before). But I think here is String.Split the better solution anyway."}], "tags": [], "owner": {"reputation": 22524, "user_id": 285795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/597432bc4cb512372176db67c6fba151?s=128&d=identicon&r=PG", "display_name": "\u03a9megaMan", "link": "https://stackoverflow.com/users/285795/%ce%a9megaman"}, "is_accepted": true, "score": 3, "last_activity_date": 1436389697, "creation_date": 1436389697, "answer_id": 31303775, "question_id": 31303439, "link": "https://stackoverflow.com/questions/31303439/c-error-system-formatexception/31303775#31303775", "title": "C# Error - System.FormatException", "body": "<p>Make sure that the text to has no whitespace, pay close attention to any carriage return and line feed characters which are invisible to the naked eye. The string method <a href=\"https://msdn.microsoft.com/en-us/library/t97s7bs3(v=vs.110).aspx\" rel=\"nofollow\">Trim</a> is a good function to remove such whitespace.  </p>\n"}], "owner": {"reputation": 25, "user_id": 5094647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b2ef6a26b4d09933bb14877875196a?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Donovan", "link": "https://stackoverflow.com/users/5094647/jay-donovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 31303775, "answer_count": 1, "score": 2, "last_activity_date": 1436390749, "creation_date": 1436388562, "last_edit_date": 1436390749, "question_id": 31303439, "link": "https://stackoverflow.com/questions/31303439/c-error-system-formatexception", "title": "C# Error - System.FormatException", "body": "<p>Someone was helping me with another question and gave me a code example that worked great.  I tried tweaking it a bit to write to a file instead of the console and I'm getting the following error:</p>\n\n<p><em>System.FormatException:  String was not recognized as a valid DateTime</em></p>\n\n<p>The code is as follows:</p>\n\n<pre><code>// There is probably a more efficient way to do this...\nstring[] getFiles = Directory.GetFiles(@\"C:\\TestFiles\", \"*.x12\");\nstring fn = getFiles[0];\n\nstring text = File.ReadAllText(fn);\n\nvar lines = text.Split('\\n');\n\nusing (StreamWriter sw = new StreamWriter(\"outfile.txt\"))\n{\n    foreach (var line in lines)\n    {\n        if (line.StartsWith(\"DTP*348\"))\n        {\n            var elements = line.Split('*');\n            var dateString = elements[3];\n\n            var dateFormat = \"yyyyMMdd\";\n            var date = DateTime.ParseExact(dateString, dateFormat, CultureInfo.InvariantCulture); // The error is thrown by this line\n\n            if (date &lt; new DateTime(2014, 06, 01))\n            {\n                date = new DateTime(2014, 06, 01);\n                sw.WriteLine(\"DTP*\" + elements[1] + \"*\" + elements[2] + \"*\" + \"20140601\");\n            }\n            else\n            {\n                sw.WriteLine(line);\n            }\n        }\n        else\n        {\n            sw.WriteLine(line);\n        }\n    }\n}\n</code></pre>\n\n<p>I have verified that <code>dateString</code> does contain a valid date in yyyyMMdd format.  Any idea what I'm doing wrong?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "entity-framework"], "comments": [{"owner": {"reputation": 80, "user_id": 4962854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-fb8tr0tGGsA/AAAAAAAAAAI/AAAAAAAAAXs/6m4b5iITY0E/photo.jpg?sz=128", "display_name": "Mrunal ", "link": "https://stackoverflow.com/users/4962854/mrunal"}, "edited": false, "score": 0, "creation_date": 1436472710, "post_id": 31303373, "comment_id": 50640740, "body": "I am getting a new error today &quot;Unable to retrieve metadata for&#39;JMAP.Models..Class1&#39;. A null was returned after calling the &#39;get_ProviderFactory&#39; method on a store provider instance of type &#39;System.Data.OracleClient.OracleConnection&#39;. The store provider might not be functining correctly.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 4962854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-fb8tr0tGGsA/AAAAAAAAAAI/AAAAAAAAAXs/6m4b5iITY0E/photo.jpg?sz=128", "display_name": "Mrunal ", "link": "https://stackoverflow.com/users/4962854/mrunal"}, "is_accepted": true, "score": -1, "last_activity_date": 1436894831, "creation_date": 1436894831, "answer_id": 31413400, "question_id": 31303373, "link": "https://stackoverflow.com/questions/31303373/unable-to-retrieve-metadata-for-jmap-models-tempsource-keyword-not-supported/31413400#31413400", "title": "Unable to retrieve metadata for &#39;JMAP.Models.tempSource&#39;. Keyword not supported &#39;data source&#39;", "body": "<p>It was my bad! I was following a wrong approach. I was using the  code-first approach whereas I wanted to use Data-first approach,but being new to MVC and C# , I just got confused.</p>\n\n<p>If someone needs help with MVC and is a beginner like me, you can go through the following website for databse design approaches. Pretty useful.</p>\n\n<p><a href=\"http://www.asp.net/mvc/overview/getting-started/database-first-development/generating-views\" rel=\"nofollow\">http://www.asp.net/mvc/overview/getting-started/database-first-development/generating-views</a></p>\n\n<p>Moreover, you can also go through these videos, a bit time consuming, but it gives you an understanding of MVC.</p>\n\n<p><a href=\"https://www.microsoftvirtualacademy.com/en-us/training-courses/introduction-to-asp-net-mvc-8322\" rel=\"nofollow\">https://www.microsoftvirtualacademy.com/en-us/training-courses/introduction-to-asp-net-mvc-8322</a></p>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 80, "user_id": 4962854, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-fb8tr0tGGsA/AAAAAAAAAAI/AAAAAAAAAXs/6m4b5iITY0E/photo.jpg?sz=128", "display_name": "Mrunal ", "link": "https://stackoverflow.com/users/4962854/mrunal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 31413400, "answer_count": 1, "score": 0, "last_activity_date": 1436894831, "creation_date": 1436388367, "last_edit_date": 1436389473, "question_id": 31303373, "link": "https://stackoverflow.com/questions/31303373/unable-to-retrieve-metadata-for-jmap-models-tempsource-keyword-not-supported", "title": "Unable to retrieve metadata for &#39;JMAP.Models.tempSource&#39;. Keyword not supported &#39;data source&#39;", "body": "<p>I am using Visual studio 2010 and EntityFramework version 5.0.0.0\nI am trying to create a controller for a 'tempSource' table in Oracle 11.2 and getting the following error.\n<img src=\"https://i.stack.imgur.com/JFabs.png\" alt=\"\"></p>\n\n<p>This is the code for the entity.</p>\n\n<p>namespace JMAP.Models\n{</p>\n\n<pre><code>public class tempSource\n{               \n    public string systemname { get; set; }\n    public string systemdesc { get; set; }\n    public string userid { get; set; }\n}\n\npublic class tempSourceDBContext : DbContext\n{\n    public DbSet&lt;tempSource&gt; tempSources { get; set; }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>add name=\"tempSourceDBContext\" \nconnectionString=\"User Id=user_id;Password=pwd;DATASOURCE=(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = hostname)(PORT = portnumber))) (CONNECT_DATA = (SERVICE_NAME = dbname)))\" </p>\n\n<p>providerName=\"System.Data.OracleCLient\"</p>\n\n<p>And I have added the above connection string in the web.config file.</p>\n\n<p>Can someone help me with this error.</p>\n"}, {"tags": ["c#", "date"], "comments": [{"owner": {"reputation": 1570, "user_id": 5008193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iOKgE.jpg?s=128&g=1", "display_name": "Graffito", "link": "https://stackoverflow.com/users/5008193/graffito"}, "edited": false, "score": 7, "creation_date": 1436388636, "post_id": 31303302, "comment_id": 50596838, "body": "Add 1 to WatMonths (not a joke!)"}, {"owner": {"reputation": 327, "user_id": 4258146, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b32ccbd8975457a3f5e17a0db78073ff?s=128&d=identicon&r=PG", "display_name": "Youssef Lourayad", "link": "https://stackoverflow.com/users/4258146/youssef-lourayad"}, "edited": false, "score": 1, "creation_date": 1436389754, "post_id": 31303302, "comment_id": 50597379, "body": "It&#39;s a general math rule, to get the count of something: (endIndex- startIndex) + 1."}, {"owner": {"reputation": 1826, "user_id": 3078539, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/z8LeR.jpg?s=128&g=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/3078539/artem"}, "edited": false, "score": 0, "creation_date": 1436391102, "post_id": 31303302, "comment_id": 50598059, "body": "and what result you are expecting for 9/1/2015 and 9/28/2015 ? if the result is 1 - the answer is posted in comment above"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5087043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbabbf43f58003f6403a306117fd2f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cartman23", "link": "https://stackoverflow.com/users/5087043/cartman23"}, "edited": false, "score": 0, "creation_date": 1436538173, "post_id": 31304154, "comment_id": 50670397, "body": "Thanks! It&#39;s easier than I made it !"}, {"owner": {"reputation": 5514, "user_id": 3190758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MM5AT.jpg?s=128&g=1", "display_name": "grovesNL", "link": "https://stackoverflow.com/users/3190758/grovesnl"}, "reply_to_user": {"reputation": 53, "user_id": 5087043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbabbf43f58003f6403a306117fd2f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cartman23", "link": "https://stackoverflow.com/users/5087043/cartman23"}, "edited": false, "score": 0, "creation_date": 1436540212, "post_id": 31304154, "comment_id": 50671893, "body": "@Cartman23: Just be careful when calculating injection water duration... ;-) From my industry experience you may want to represent partial months instead (typical for &quot;Days Online&quot;/&quot;Months Online&quot; calculations)."}, {"owner": {"reputation": 53, "user_id": 5087043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbabbf43f58003f6403a306117fd2f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cartman23", "link": "https://stackoverflow.com/users/5087043/cartman23"}, "edited": false, "score": 0, "creation_date": 1436540906, "post_id": 31304154, "comment_id": 50672366, "body": "I agree. but this will be used for calculation and inventory in future. Hence, will be based on Days online = Days of the month."}, {"owner": {"reputation": 5514, "user_id": 3190758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MM5AT.jpg?s=128&g=1", "display_name": "grovesNL", "link": "https://stackoverflow.com/users/3190758/grovesnl"}, "reply_to_user": {"reputation": 53, "user_id": 5087043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbabbf43f58003f6403a306117fd2f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cartman23", "link": "https://stackoverflow.com/users/5087043/cartman23"}, "edited": false, "score": 0, "creation_date": 1436542895, "post_id": 31304154, "comment_id": 50673620, "body": "@Cartman23: As long as you are getting the rate/volume calculations correct you should be fine! Also, if my answer solved your question, it would be good to mark it as the accepted answer."}], "tags": [], "owner": {"reputation": 5514, "user_id": 3190758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MM5AT.jpg?s=128&g=1", "display_name": "grovesNL", "link": "https://stackoverflow.com/users/3190758/grovesnl"}, "is_accepted": true, "score": 0, "last_activity_date": 1436390956, "creation_date": 1436390956, "answer_id": 31304154, "question_id": 31303302, "link": "https://stackoverflow.com/questions/31303302/difference-between-two-months-only-based-on-months-and-not-date/31304154#31304154", "title": "Difference between two months - only based on months and not date", "body": "<p>In this case, you are defining the <i>number of months between dates</i> as being inclusive of both the month of start date and the end date. So the number of months between 2015/1/1 and 2015/1/1 would be 1. Are you sure this is the behavior you want?</p>\n\n<p>In order to accomplish the behavior you described, simply add <code>+ 1</code> to the end of your assignment.</p>\n\n<pre><code>var WatMonths = ((WatInjEndDate.Year - WaterStartDate.Year) * 12) + \n                    WatInjEndDate.Month - WaterStartDate.Month + 1\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5087043, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbabbf43f58003f6403a306117fd2f2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cartman23", "link": "https://stackoverflow.com/users/5087043/cartman23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 31304154, "answer_count": 1, "score": 1, "last_activity_date": 1436393172, "creation_date": 1436388138, "last_edit_date": 1436393172, "question_id": 31303302, "link": "https://stackoverflow.com/questions/31303302/difference-between-two-months-only-based-on-months-and-not-date", "title": "Difference between two months - only based on months and not date", "body": "<p>I am currently using below code to find month difference between two dates.</p>\n\n<pre><code>var WatMonths = ((WatInjEndDate.Year - WaterStartDate.Year) * 12) + WatInjEndDate.Month - WaterStartDate.Month\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>WaterStartDate = 9/28/2015\nWaterInjEndDate = 12/4/2015\n</code></pre>\n\n<p>The answer that I get from above code is 3. But my ultimate requirement is to get \"4\" that depicts months 9,10,11,12 as WaterStartDate is in the 9th month and Enddate is in 12th month of the year. </p>\n\n<p>What should I modify in the code?</p>\n"}, {"tags": ["c#"], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 2472753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZxU49.jpg?s=128&g=1", "display_name": "Fullmetal_Alchemist_Fan", "link": "https://stackoverflow.com/users/2472753/fullmetal-alchemist-fan"}, "edited": false, "score": 1, "creation_date": 1436389442, "post_id": 31303298, "comment_id": 50597246, "body": "Beautiful answer, sir. This gives a wider range of flexibility. My program now works as desired. Many thanks!"}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "reply_to_user": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 1, "creation_date": 1436393037, "post_id": 31303298, "comment_id": 50598965, "body": "@EmpereurAiman: You can&#39;t use anonymous types as a return type, so unless this result is just getting serialized as part of a REST service or something, that won&#39;t work."}, {"owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1436457195, "post_id": 31303298, "comment_id": 50631632, "body": "@StriplingWarrior Thanks for correcting me. I got confused seeing the usage in LINQ."}], "tags": [], "owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "is_accepted": true, "score": 3, "last_activity_date": 1436388122, "creation_date": 1436388122, "answer_id": 31303298, "question_id": 31303234, "link": "https://stackoverflow.com/questions/31303234/how-do-i-return-a-single-object-with-an-array-and-a-list/31303298#31303298", "title": "How do I return a single object with an array and a list?", "body": "<p>Create a new class to represent the combination of these two pieces of data:</p>\n\n<pre><code>public class MyReturnType \n{\n    public List&lt;myData.DataOne&gt; ListOne {get;set;}\n    public string[] Array {get;set;}\n}\n</code></pre>\n\n<p>Then return it:</p>\n\n<pre><code>return new MyReturnType {ListOne = listOne, Array = array};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 856, "user_id": 1404038, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/871378e0b9fac80c52dc519a75f1e101?s=128&d=identicon&r=PG", "display_name": "Sarin Vadakkey Thayyil", "link": "https://stackoverflow.com/users/1404038/sarin-vadakkey-thayyil"}, "is_accepted": false, "score": 2, "last_activity_date": 1436388716, "creation_date": 1436388716, "answer_id": 31303478, "question_id": 31303234, "link": "https://stackoverflow.com/questions/31303234/how-do-i-return-a-single-object-with-an-array-and-a-list/31303478#31303478", "title": "How do I return a single object with an array and a list?", "body": "<p>Create a Tuple with types as List&lt;> and string[].</p>\n\n<pre><code>var tupleObject = new Tuple&lt;List&lt;myData.DataOne&gt;, string[]&gt;(listOne, array);\nreturn tupleObject;\n</code></pre>\n"}], "owner": {"reputation": 713, "user_id": 2472753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ZxU49.jpg?s=128&g=1", "display_name": "Fullmetal_Alchemist_Fan", "link": "https://stackoverflow.com/users/2472753/fullmetal-alchemist-fan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 31303298, "answer_count": 2, "score": 3, "last_activity_date": 1436388716, "creation_date": 1436387899, "last_edit_date": 1436388163, "question_id": 31303234, "link": "https://stackoverflow.com/questions/31303234/how-do-i-return-a-single-object-with-an-array-and-a-list", "title": "How do I return a single object with an array and a list?", "body": "<p>I have a list and an array that I would like to return, but I'm unsure how to bring the two together. I have deserialized my JSON and created two objects. How do I bring this list and array together in a single object?  :</p>\n\n<pre><code>var one = JsonConvert.DeserializeObject&lt;MyData.RootObject&gt;(first);\nvar two = JsonConvert.DeserializeObject&lt;MyData.RootObject&gt;(second);\n\nList&lt;myData.DataOne&gt; listOne = new List&lt;myData.DataOne&gt;();\n\nforeach (var items in one) \n{\n     someDataModel model = new someDataModel();\n     model.property = one.rows.f[0].v;\n     listOne.Add(model);\n}\n\nstring[] array = new string[two.rows.Count];\n\n        for (var items = 0; items &lt; two.rows.Count; items++)\n        {\n            array[items] = two.rows[items].f[0].v;\n        }\n\nreturn null;\n</code></pre>\n"}, {"tags": ["c#", ".net", "wpf"], "owner": {"reputation": 11, "user_id": 5092951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a08e64a7cc6fb2468dc62cf3f0667590?s=128&d=identicon&r=PG&f=1", "display_name": "Hubert123", "link": "https://stackoverflow.com/users/5092951/hubert123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1436391068, "answer_count": 0, "score": 1, "last_activity_date": 1436390824, "creation_date": 1436387787, "last_edit_date": 1436390824, "question_id": 31303198, "link": "https://stackoverflow.com/questions/31303198/c-wpf-get-current-angle-of-control", "closed_reason": "Duplicate", "title": "C# WPF get current angle of Control", "body": "<p>Hi im trying to the get the current angle of an imagebox.</p>\n\n<p>I can't find any property to figure it out.</p>\n\n<p>Im working in code-behind (c#) wpf app.</p>\n\n<p>I hope you can help me.</p>\n"}, {"tags": ["c#", "powershell", "datagridview"], "comments": [{"owner": {"reputation": 172964, "user_id": 153982, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/bcc517cd604f90500c5dcef5a6ed7f81?s=128&d=identicon&r=PG", "display_name": "Keith Hill", "link": "https://stackoverflow.com/users/153982/keith-hill"}, "edited": false, "score": 0, "creation_date": 1436461815, "post_id": 31303143, "comment_id": 50634532, "body": "Can you run the <code>Hide-WUUpdate</code> command directly from the console to see if you have it working with the specified parameters?  Just trying to see if the issue is in your program or in your use of this command."}, {"owner": {"reputation": 7289, "user_id": 1057052, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qGN8h.jpg?s=128&g=1", "display_name": "Jose A", "link": "https://stackoverflow.com/users/1057052/jose-a"}, "reply_to_user": {"reputation": 172964, "user_id": 153982, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/bcc517cd604f90500c5dcef5a6ed7f81?s=128&d=identicon&r=PG", "display_name": "Keith Hill", "link": "https://stackoverflow.com/users/153982/keith-hill"}, "edited": false, "score": 0, "creation_date": 1436471235, "post_id": 31303143, "comment_id": 50639934, "body": "@KeithHill: Yup. I can run it perfectly from PowerShell. On the PowerShell console it asks me if I want to proceed, that&#39;s why I&#39;ve added the confirm:false parameter. I&#39;ve also tried it in the console this way and it works!  I really don&#39;t know where the problem is :("}, {"owner": {"reputation": 7289, "user_id": 1057052, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qGN8h.jpg?s=128&g=1", "display_name": "Jose A", "link": "https://stackoverflow.com/users/1057052/jose-a"}, "reply_to_user": {"reputation": 172964, "user_id": 153982, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/bcc517cd604f90500c5dcef5a6ed7f81?s=128&d=identicon&r=PG", "display_name": "Keith Hill", "link": "https://stackoverflow.com/users/153982/keith-hill"}, "edited": false, "score": 0, "creation_date": 1436474066, "post_id": 31303143, "comment_id": 50641449, "body": "Because the program passes OK. There are no errors registered, but it seems that it does not take effect."}, {"owner": {"reputation": 172964, "user_id": 153982, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/bcc517cd604f90500c5dcef5a6ed7f81?s=128&d=identicon&r=PG", "display_name": "Keith Hill", "link": "https://stackoverflow.com/users/153982/keith-hill"}, "edited": false, "score": 0, "creation_date": 1436474237, "post_id": 31303143, "comment_id": 50641557, "body": "Did you check <code>ps.Streams.Error</code> to see if there is anything in that collection after you invoke that command?"}, {"owner": {"reputation": 7289, "user_id": 1057052, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qGN8h.jpg?s=128&g=1", "display_name": "Jose A", "link": "https://stackoverflow.com/users/1057052/jose-a"}, "reply_to_user": {"reputation": 172964, "user_id": 153982, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/bcc517cd604f90500c5dcef5a6ed7f81?s=128&d=identicon&r=PG", "display_name": "Keith Hill", "link": "https://stackoverflow.com/users/153982/keith-hill"}, "edited": false, "score": 0, "creation_date": 1436477162, "post_id": 31303143, "comment_id": 50643137, "body": "@KeithHill: I did. No errors shown :("}], "owner": {"reputation": 7289, "user_id": 1057052, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qGN8h.jpg?s=128&g=1", "display_name": "Jose A", "link": "https://stackoverflow.com/users/1057052/jose-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 655, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1545261258, "creation_date": 1436387620, "last_edit_date": 1545261258, "question_id": 31303143, "link": "https://stackoverflow.com/questions/31303143/executing-powershell-script-with-parameters", "title": "Executing PowerShell Script with Parameters", "body": "<p>I'm adapting <a href=\"http://hmemcpy.com/2015/04/preventing-a-certain-windows-update-from-installing-on-windows-10/\" rel=\"nofollow noreferrer\">this solution</a> to a Windows Forms solution. So far I've been able to execute the <code>Get-WUList</code> command with no problems. But it doesn't seem to go well with the <code>Hide-WUUpdate</code>. This is what I've tried so far:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class PowerShellController : IPowerShell\n{\n\n    //Created at a global scope so anyone can fetch it.\n    InitialSessionState initial;\n    RunspaceInvoke scriptInvoker;\n    Runspace runspace;\n    PowerShell ps;\n\n    //The View to Control\n    IView view;\n\n    //The Helper GridViewProcessor class\n    IGridViewProcessor gp;\n\n    //Initializing the Controller - Loads the Module.\n    public PowerShellController()\n    {\n        initial = InitialSessionState.CreateDefault();\n        initial.ImportPSModule(new string[] { @\"C:\\Users\\Jose\\Documents\\WindowsPowerShell\\Modules\\PSWindowsUpdate\\PSWindowsUpdate.psd1\" });\n        scriptInvoker = new RunspaceInvoke();\n        scriptInvoker.Invoke(\"Set-ExecutionPolicy Unrestricted -Scope Process\");\n\n        runspace = RunspaceFactory.CreateRunspace(initial);\n        runspace.Open();\n\n        using (ps = PowerShell.Create())\n        {\n            ps.Runspace = runspace;\n        }\n\n        //Console.WriteLine(\"Please Wait. This will take a while to load.\");\n\n    }\n\n\n    public void SetView(IView view, IGridViewProcessor gp)\n    {\n        this.view = view;\n        this.gp = gp;\n    }\n\n\n    public void GetAvailableUpdates()\n    {\n\n        MessageBox.Show(\"Ok. The program will kind of hang. This is normal.\" +\n                        \"This Means that it will start looking for updates \"\n            );\n\n        IEnumerable&lt;PSObject&gt; WUList; //Placeholder for the PS Executed Command\n\n        using (ps = PowerShell.Create())\n        {\n            //Adds the PowerShell Command\n            ps.Commands.AddCommand(\"Get-WUList\");\n            //Executes the PowerShell command\n            WUList = ps.Invoke();\n        }\n\n        //Loads the Model - Can be later on rewritten for Ninject Support.\n        List&lt;WindowsUpdate&gt; model = new List&lt;WindowsUpdate&gt;();\n        int id = 1;\n        foreach (PSObject result in WUList)\n        {\n            WindowsUpdate item = new WindowsUpdate\n            {\n                Id = id,\n                Name = result.Members[\"Title\"].Value.ToString(),\n                Size = result.Members[\"Size\"].Value.ToString(),\n                Type = UpdateType.Undefined,\n\n            };\n            model.Add(item);\n            id++; //Icnrease ID count\n            //Console.WriteLine(\"Update Name {0} --- Size: {1}\", result.Members[\"Title\"].Value.ToString(), result.Members[\"Size\"].Value.ToString());\n        }\n\n        //Adds it to the view:\n        view.AddUpdateToGrid(model);\n    }\n\n    public void HideSelectedUpdates(DataGridView grid)\n    {\n        //Gets SelectedUpdates to the WindowsUpdate model\n        var SelectedUpdates = gp.GetSelectedUpdates(grid);\n        using (ps = PowerShell.Create())\n        {\n            foreach (var update in SelectedUpdates)\n            {\n                ps.Commands.Clear();\n                ps.Commands.AddCommand(\"Hide-WUUpdate\").AddParameter(\"Title\",update.Name).AddParameter(\"Confirm\", false);\n\n                //ps.Commands.AddCommand(\"Hide-WUUpdate -Title \\\"\"+update.Name+\"\\\"\");\n               var result = ps.Invoke();\n\n            }\n\n        }\n\n        MessageBox.Show(\"Updates Have been hidden\");\n\n    }\n\n}\n</code></pre>\n\n<p>The method I can't seem to work is the <code>HideSelectedUpdates(DataGridView grid)</code>.</p>\n\n<p>Script gets executed and no exceptions are thrown, but it doesn't seem to reflect any changes at all.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c#", ".net", "asp.net-mvc", "asp.net-mvc-3", "csrf"], "comments": [{"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1436402682, "post_id": 31303013, "comment_id": 50601929, "body": "Curious: if you&#39;re &quot;parsing&quot; <i>other</i> data for an XHR (e.g. <code>password</code>) why <i>&quot;don&#39;t you have to&quot;</i> (for the token)? Wouldn&#39;t the answers essentially end up having to (generate and send it in a POST request <i>anyway</i>)?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1436457538, "post_id": 31303013, "comment_id": 50631854, "body": "@EdSF by don&#39;t have to I mean I should be able to work with the data as an object server side so I don&#39;t have JS intercepting the ajax call, parsing a value out of the DOM, adding it as a header then letting execution continue. When the page is served I should be able to embed the value in the ajax call just as I have in the HTML. Sadly, you can&#39;t directly but that&#39;s just because the library is poorly designed."}, {"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1436469780, "post_id": 31303013, "comment_id": 50639093, "body": "Still curious :) Based on that (and the answer below) which <i>seems</i> to change how things work, I&#39;m feeling a little insecure :) <b>If</b> I&#39;m reading it right, I can reuse that value (replay, mock, etc.)?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1436471304, "post_id": 31303013, "comment_id": 50639976, "body": "@EdSF it prevents a replay. The only way you could replay with a token in my cookie or DOM is if you&#39;ve already exposed a cross-site-scripting vulnerability so that you&#39;re parsing my DOM or reading my cookies. Neither of those things are allowed by the browser."}], "answers": [{"tags": [], "owner": {"reputation": 2281, "user_id": 2778089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7OqZN.jpg?s=128&g=1", "display_name": "BhavO", "link": "https://stackoverflow.com/users/2778089/bhavo"}, "is_accepted": false, "score": 0, "last_activity_date": 1436388310, "last_edit_date": 1436388310, "creation_date": 1436387604, "answer_id": 31303136, "question_id": 31303013, "link": "https://stackoverflow.com/questions/31303013/get-the-raw-values-not-html-from-antiforgerytoken/31303136#31303136", "title": "Get the raw values (not html) from AntiForgeryToken()", "body": "<p>Look at the Html.AntiForgeryToken() in ILSpy and copy out the code that builds an input tag and create your own extension method that returns only the token string.</p>\n"}, {"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436457644, "post_id": 31303247, "comment_id": 50631929, "body": "I didn&#39;t quite use this (the server side code wasn&#39;t necessary) but I ended up adding an extension method to HtmlHelper and used it like in the example above."}], "tags": [], "owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "is_accepted": true, "score": 8, "last_activity_date": 1436394502, "last_edit_date": 1436394502, "creation_date": 1436387949, "answer_id": 31303247, "question_id": 31303013, "link": "https://stackoverflow.com/questions/31303013/get-the-raw-values-not-html-from-antiforgerytoken/31303247#31303247", "title": "Get the raw values (not html) from AntiForgeryToken()", "body": "<p>You can use code like this (in for example _Layout.cshtml) to add the AntiForgery header to all Ajax POST requests, or you could adapt it for a specific request. <em>(Code assumes you are using jQuery)</em></p>\n\n<pre><code>@functions{\n    private static string TokenHeaderValue()\n    {\n        string cookieToken, formToken;\n        AntiForgery.GetTokens(null, out cookieToken, out formToken);\n        return cookieToken + \":\" + formToken;\n    }\n}\n\n&lt;script type=\"text/javascript\"&gt;\n    $(document).ajaxSend(function (event, jqxhr, settings) {\n        if (settings.type == \"POST\") {   \n            jqxhr.setRequestHeader('@ValidateHttpAntiForgeryTokenAttribute.RequestVerificationTokenName',\n                                   '@TokenHeaderValue()');\n        }\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>On the server side for these Ajax calls, you then want to call <a href=\"https://msdn.microsoft.com/en-us/library/jj158363(v=vs.111).aspx\" rel=\"noreferrer\">the overload of AntiForgery.Validate that takes the cookie and form token</a>, which you would enable by adding this attribute to the action methods called via Ajax (explicitly, or by parent controller, or via a filter)</p>\n\n<pre><code>[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class,\n                AllowMultiple = false, Inherited = true)]\npublic sealed class ValidateHttpAntiForgeryTokenAttribute \n                                 : FilterAttribute, IAuthorizationFilter\n\n{\n    public const string RequestVerificationTokenName = \"RequestVerificationToken\";\n\n    public void OnAuthorization(AuthorizationContext filterContext)\n    {\n        if (filterContext.HttpContext.Request.IsAjaxRequest())\n        {\n            ValidateRequestHeader(filterContext.HttpContext.Request);\n        }\n        else\n        {\n            AntiForgery.Validate();\n        }\n    }\n\n    private static void ValidateRequestHeader(HttpRequestBase request)\n    {\n        string cookieToken = string.Empty;\n        string formToken = string.Empty;\n\n        var tokenValue = request.Headers[RequestVerificationTokenName];\n\n        if (string.IsNullOrEmpty(tokenValue) == false)\n        {\n            string[] tokens = tokenValue.Split(':');\n\n            if (tokens.Length == 2)\n            {\n                cookieToken = tokens[0].Trim();\n                formToken = tokens[1].Trim();\n            }\n        }\n\n        AntiForgery.Validate(cookieToken, formToken);\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 176, "user_id": 724222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sg5sd.jpg?s=128&g=1", "display_name": "Carlitrosss", "link": "https://stackoverflow.com/users/724222/carlitrosss"}, "is_accepted": false, "score": 0, "last_activity_date": 1436388989, "last_edit_date": 1495541704, "creation_date": 1436388989, "answer_id": 31303569, "question_id": 31303013, "link": "https://stackoverflow.com/questions/31303013/get-the-raw-values-not-html-from-antiforgerytoken/31303569#31303569", "title": "Get the raw values (not html) from AntiForgeryToken()", "body": "<p>Short answer: there is not a native way to do what you're trying to, but as a previous answer states, you can create an HTML helper method.</p>\n\n<p>This guy seems to have a working solution: <a href=\"https://stackoverflow.com/a/16057568/724222\">https://stackoverflow.com/a/16057568/724222</a></p>\n"}], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8053, "favorite_count": 4, "accepted_answer_id": 31303247, "answer_count": 3, "score": 7, "last_activity_date": 1436394502, "creation_date": 1436387158, "question_id": 31303013, "link": "https://stackoverflow.com/questions/31303013/get-the-raw-values-not-html-from-antiforgerytoken", "title": "Get the raw values (not html) from AntiForgeryToken()", "body": "<p>This beautiful abstraction lets you place <code>@Html.AntiForgeryToken()</code> in cshtml file which is magically expanded to something like;</p>\n\n<pre><code>&lt;input name=\"__RequestVerificationToken\" type=\"hidden\" value=\"JjMHm5KJQ/qJsyC4sgifQWWX/WmADmNvEgHZXXuB07bWoL84DrmQzE6k9irVyFSJ5VSYqeUIXgl4Dw4NHSotLwflGYTyECzLvrgzbtonxJ9m3GVPgUV7Z6s2Ih/klUB78GN7Fl4Gj7kxg62MEoGcZw175eVwTmkKJ0XrtEfD5KCVvYIMHNY8MT2l+qhltsGL87c9dII42AVoUUQ2gTvfPg==\" /&gt;\n</code></pre>\n\n<p>By mvc before the page is served. However my page has some JavaScript making ajax calls which don't include the token even though it's been added to the form. They are currently getting the expected <code>[HttpAntiForgeryException]: A required anti-forgery token was not supplied or was invalid.</code> because they don't have the token. I'm aware I <em>could</em> parse the value out of the DOM but I shouldn't have to. Are there other ways of accessing/getting this value? To be clear, I mean I'd like an overload of the method that returns just the value as a string or some kind of object that has the name and value both.</p>\n\n<p>To provide a bit more context my form and the relevant JS looks a little like this;</p>\n\n<pre><code>&lt;form action=\"/settings\" method=\"post\"&gt;&lt;input name=\"__RequestVerificationToken\" type=\"hidden\" value=\"JjMHm5KJQ/qJsyC4sgifQWWX/WmADmNvEgHZXXuB07bWoL84DrmQzE6k9irVyFSJ5VSYqeUIXgl4Dw4NHSotLwflGYTyECzLvrgzbtonxJ9m3GVPgUV7Z6s2Ih/klUB78GN7Fl4Gj7kxg62MEoGcZw175eVwTmkKJ0XrtEfD5KCVvYIMHNY8MT2l+qhltsGL87c9dII42AVoUUQ2gTvfPg==\" /&gt;    &lt;fieldset&gt;\n        &lt;h3&gt;User Settings&lt;/h3&gt;\n        &lt;ul&gt;\n            &lt;li&gt;\n            label for=\"password\"&gt;Password&lt;/label&gt;\n                &lt;a href=\"#\" id=\"change_password\" class=\"changePasswordButton\"&gt;Edit&lt;/a&gt;\n                &lt;div id=\"password_section\" class=\"inlineedit\"&gt;\n                    &lt;div&gt;\n                        &lt;span for=\"existing_password\"&gt;Current password&lt;/span&gt; &lt;input autocomplete=\"off\" class=\"required\" id=\"existing_password\" name=\"existing_password\" type=\"password\" /&gt;\n                    &lt;/div&gt;\n                    &lt;div&gt;\n                        &lt;span for=\"new_password\"&gt;New password&lt;/span&gt; &lt;input autocomplete=\"off\" class=\"required\" id=\"new_password\" name=\"new_password\" type=\"password\" /&gt;\n                        &lt;span id=\"password_strength\" /&gt;\n                    &lt;/div&gt;\n                    &lt;div&gt;\n                        &lt;span for=\"confirm_password\"&gt;Confirm password&lt;/span&gt; &lt;input autocomplete=\"off\" class=\"required\" id=\"confirm_password\" name=\"confirm_password\" type=\"password\" /&gt;\n                    &lt;/div&gt;\n                    &lt;div class=\"inlinesave\"&gt;\n                        &lt;input type=\"button\" value=\"Change\" onclick=\"onPostChangePassword();\"/&gt;\n                        &lt;a href=\"#\" id=\"cancel_password\" class=\"cancel\"&gt;Cancel&lt;/a&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/li&gt;\n    // a bunch more of these that call their own onPostChangeSetting method\n</code></pre>\n\n<p><code>onPostChangePassword()</code> does some input validation then;</p>\n\n<pre><code> if(validPWD &amp;&amp; validNewPWD &amp;&amp; validConfirmPWD &amp;&amp; current_pwd != new_pwd){\n                        // Post the password change\n                        var currentAjaxRequest = $.ajax({\n                            type: \"POST\",\n                            url: \"/settings/preferences/changepassword\",\n                            cache: false,\n                            data: {password: $('#new_password').val(), current: $('#existing_password').val(),confirm: $('#confirm_password').val()},\n                            success: password_success,\n                            error: password_error,\n                            dataType: \"json\"\n                        });\n                        return true;\n                  }\n</code></pre>\n\n<p>Which ideally (since this is verbatim in a cshtml file) would be modified with something like this;</p>\n\n<pre><code>data: {password: $('#new_password').val(), current: $('#existing_password').val(),confirm: $('#confirm_password').val(),\n__RequestVerificationToken:@Html.AntiForgeryValue() }\n</code></pre>\n\n<p>tl;dr is there a way to interact with the AntiForgeyToken before it's turned into an string of html?</p>\n"}, {"tags": ["c#", "excel", "export-to-excel", "export-to-csv"], "comments": [{"owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "edited": false, "score": 0, "creation_date": 1436387188, "post_id": 31302933, "comment_id": 50596065, "body": "off the point, but would your code not be tidier with a using Microsoft.Office.Interop.Excel statement?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1436404547, "post_id": 31302933, "comment_id": 50602385, "body": "I&#39;m not sure how you are going to transcribe this into your c# code but you need to set the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa215749%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">TextFileColumnDataTypes property</a> within the parameters of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193593.aspx\" rel=\"nofollow noreferrer\">Range.TextToColumns method</a>. I suspect it has to do with one or more of your <code>Type.Missing</code> values. You need to pass in an array of arrays. The nested arrays decribe the position and format; e.g. Array(4, 2) is the fourth field in <code>xlTextFormat</code> format."}], "owner": {"reputation": 51, "user_id": 4816713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bc392d5c54d28d4f04958c49b379b33?s=128&d=identicon&r=PG&f=1", "display_name": "erick", "link": "https://stackoverflow.com/users/4816713/erick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1436386868, "creation_date": 1436386868, "question_id": 31302933, "link": "https://stackoverflow.com/questions/31302933/texttocolumns-with-numberformat", "title": "&quot;.TextToColumns&quot; with &quot;.NumberFormat&quot;", "body": "<p>I've got a text file I'm trying to save as an XLSX file. However before saving and closing I need to perform a TextToColumns and ALSO I need column \"H\" to remain in \"Text\" format. </p>\n\n<p>The below code converts column \"H\" to \"Text\" format but then when the \".TextToColumns\" executes column \"H\" changes to a \"Custom\" format thus changing the the data.</p>\n\n<pre><code>        Microsoft.Office.Interop.Excel.Application oXL;\n        Microsoft.Office.Interop.Excel.Workbook dataB;\n        Microsoft.Office.Interop.Excel.Worksheet dataS;\n\n        string path = @\"C:\\Users\\fakename\\Desktop\\EXTRACTED_FORMATTED sampleFile.csv\";\n\n        oXL = new Microsoft.Office.Interop.Excel.Application();\n        dataB = oXL.Workbooks.Open(path, 0,\n            false, 5, Missing.Value, Missing.Value, false, Missing.Value, Missing.Value,\n            false, false, Missing.Value, false, false, false);\n        dataB.Application.DisplayAlerts = false;\n        oXL.Visible = true;\n        dataS = (Microsoft.Office.Interop.Excel.Worksheet)dataB.ActiveSheet;\n\n        Range excelRange = dataS.get_Range(\"H1\").EntireColumn;\n        excelRange.NumberFormat = \"@\";\n\n        dataS.get_Range(\"A1\", (\"A\" + dataS.UsedRange.Rows.Count)).TextToColumns(\n            Type.Missing, Microsoft.Office.Interop.Excel.XlTextParsingType.xlDelimited,\n            Microsoft.Office.Interop.Excel.XlTextQualifier.xlTextQualifierNone, false,\n            false, false, false, false, true, \"|\", Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n\n        dataS.Name = \"PSH\";\n        dataS.SaveAs(@\"C:\\Users\\fakename\\Desktop\\2\\moresamplefiles\", Microsoft.Office.Interop.Excel.XlFileFormat.xlWorkbookDefault);\n        dataB.Close(Missing.Value, Missing.Value, Missing.Value);\n        oXL.Quit();\n</code></pre>\n"}, {"tags": ["c#", "mysql", "raspberry-pi", "raspberry-pi2"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4850555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/104cb4964e848e05357ac2981993181d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAgren", "link": "https://stackoverflow.com/users/4850555/mragren"}, "edited": false, "score": 0, "creation_date": 1436454458, "post_id": 31303001, "comment_id": 50629726, "body": "Changed, saved and restarted mysql. Still same issue, buddy."}, {"owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "reply_to_user": {"reputation": 3, "user_id": 4850555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/104cb4964e848e05357ac2981993181d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAgren", "link": "https://stackoverflow.com/users/4850555/mragren"}, "edited": false, "score": 0, "creation_date": 1436514739, "post_id": 31303001, "comment_id": 50655284, "body": "Do you have port 3306 forwarded on your router?"}, {"owner": {"reputation": 3, "user_id": 4850555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/104cb4964e848e05357ac2981993181d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAgren", "link": "https://stackoverflow.com/users/4850555/mragren"}, "edited": false, "score": 0, "creation_date": 1436541422, "post_id": 31303001, "comment_id": 50672688, "body": "Yes sir. Both TCP and UDP opened"}, {"owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "reply_to_user": {"reputation": 3, "user_id": 4850555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/104cb4964e848e05357ac2981993181d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAgren", "link": "https://stackoverflow.com/users/4850555/mragren"}, "edited": false, "score": 0, "creation_date": 1436556733, "post_id": 31303001, "comment_id": 50680997, "body": "Try just in case the inline <code>GRANT&#47;CREATE</code> syntax. I.E. <code>GRANT ALL PRIVILEGES ON database.* TO &#39;admin2&#39;@&#39;%&#39; IDENTIFIED BY &#39;password&#39;;</code>  Maybe your grant is giving a blank password to your user for that specific table?  I think that depends on the version of mysql."}, {"owner": {"reputation": 3, "user_id": 4850555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/104cb4964e848e05357ac2981993181d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAgren", "link": "https://stackoverflow.com/users/4850555/mragren"}, "edited": false, "score": 0, "creation_date": 1436569364, "post_id": 31303001, "comment_id": 50686125, "body": "Still same issue. I checked the grants for the user    SHOW GRANTS FOR Admin2. Updated the main post with the info I got."}, {"owner": {"reputation": 3, "user_id": 4850555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/104cb4964e848e05357ac2981993181d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAgren", "link": "https://stackoverflow.com/users/4850555/mragren"}, "edited": false, "score": 0, "creation_date": 1436615657, "post_id": 31303001, "comment_id": 50695300, "body": "I had not forwarded the port using the IP on my PI. Works flawlessly now. Super happy! Thanks!"}], "tags": [], "owner": {"reputation": 2525, "user_id": 1762117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gt9Rc.jpg?s=128&g=1", "display_name": "MiltoxBeyond", "link": "https://stackoverflow.com/users/1762117/miltoxbeyond"}, "is_accepted": true, "score": 0, "last_activity_date": 1436387107, "creation_date": 1436387107, "answer_id": 31303001, "question_id": 31302903, "link": "https://stackoverflow.com/questions/31302903/c-mysql-raspberry-pi-access-denied-for-user/31303001#31303001", "title": "C# MySQL Raspberry Pi - Access denied for user", "body": "<p>Don't forget that MySQL is set to only listen on 127.0.0.1 by default. In other words the default instance does not listen to public IP Addresses. Bind it instead to 0.0.0.0 otherwise it will listen only local linux sockets.</p>\n"}], "owner": {"reputation": 3, "user_id": 4850555, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/104cb4964e848e05357ac2981993181d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAgren", "link": "https://stackoverflow.com/users/4850555/mragren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 31303001, "answer_count": 1, "score": 0, "last_activity_date": 1436569468, "creation_date": 1436386767, "last_edit_date": 1436569468, "question_id": 31302903, "link": "https://stackoverflow.com/questions/31302903/c-mysql-raspberry-pi-access-denied-for-user", "title": "C# MySQL Raspberry Pi - Access denied for user", "body": "<p>Heyhey!</p>\n\n<p>I am having issues with my MySQL server on my Raspberry pi.\nIt works flawlessly to connect remotely from both my PC and from others in my house, but when I send the application to my friend, they get:</p>\n\n<p>\"Access denied for user \"Admin2\"----.\"</p>\n\n<p>Things I've tried:</p>\n\n<p>\u2022 Quoting out the bind-address in my config file, as well as using my static IP from my RPI, and also using 0.0.0.0 as IP.</p>\n\n<p>\u2022 Added the line \"skip-name-resolve\" in my \"/etc/mysql/my.cnf\" file.</p>\n\n<p>\u2022 Port 3306 is open on my router. Checked it using CanYouSeeMe.</p>\n\n<p>The following queries:</p>\n\n<pre><code>CREATE USER 'Admin2'@'%' IDENTIFIED BY 'password';\nGRANT ALL PRIVILEGES ON database.* TO 'Admin2'@'%';\nFLUSH PRIVILEGES;\n\nSHOW GRANTS FOR 'Admin2';\n|\nGRANT USAGE ON *.* TO 'Admin2'@'%' IDENTIFIED BY PASSWORD '&lt;Lots of encrypted password letters here I assume&gt;'\nGRANT ALL PRIVILEGES ON 'database.* TO 'Admin2'@'%'\n</code></pre>\n\n<p>I have a loginData.settings in my Visual Studio project with the strings: username, password &amp; ipString which each has a textbox assigned to them that saves the info. We tried connecting using my Pi's static IP as well as the IP obtained from whatsmyip.</p>\n\n<pre><code>project.loginData.Default.username = this.usernameText.Text;\nproject.loginData.Default.password = this.passwordText.Text;\nproject.loginData.Default.ipString = this.ipTest.Text;\n</code></pre>\n\n<p>And finally the connect string.</p>\n\n<pre><code>string wsUN = project.loginData.Default.username;\nstring wsPW = project.loginData.Default.password;\nstring wsIP = project.loginData.Default.ipString;\n\nstring projectConnect = \"datasource=\" + wsIP + \";port=3306;username=\" + wsUN + \";password=\" + wsPW;\n</code></pre>\n\n<p>I am completely clueless. Thanks in advance!</p>\n"}, {"tags": ["c#", "constructor"], "comments": [{"owner": {"reputation": 5460, "user_id": 4564272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RujrA.jpg?s=128&g=1", "display_name": "Der Kommissar", "link": "https://stackoverflow.com/users/4564272/der-kommissar"}, "edited": false, "score": 3, "creation_date": 1436386540, "post_id": 31302825, "comment_id": 50595684, "body": "Variables are implicitly <code>private</code>. In the lack of an access specifier, they are inaccessible to <b>anything</b> that is not that exact class."}, {"owner": {"reputation": 39314, "user_id": 385844, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/21ffea7aa8a0cf833901322567c61df9?s=128&d=identicon&r=PG", "display_name": "phoog", "link": "https://stackoverflow.com/users/385844/phoog"}, "reply_to_user": {"reputation": 5460, "user_id": 4564272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RujrA.jpg?s=128&g=1", "display_name": "Der Kommissar", "link": "https://stackoverflow.com/users/4564272/der-kommissar"}, "edited": false, "score": 2, "creation_date": 1436386737, "post_id": 31302825, "comment_id": 50595811, "body": "@EBrown it is worth noting that the private variables here, a, b, and c, are more precisely called <i>fields.</i>"}, {"owner": {"reputation": 5460, "user_id": 4564272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RujrA.jpg?s=128&g=1", "display_name": "Der Kommissar", "link": "https://stackoverflow.com/users/4564272/der-kommissar"}, "reply_to_user": {"reputation": 39314, "user_id": 385844, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/21ffea7aa8a0cf833901322567c61df9?s=128&d=identicon&r=PG", "display_name": "phoog", "link": "https://stackoverflow.com/users/385844/phoog"}, "edited": false, "score": 0, "creation_date": 1436386810, "post_id": 31302825, "comment_id": 50595855, "body": "@phoog Indeed, adding that to my answer as well."}], "answers": [{"tags": [], "owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "is_accepted": true, "score": 4, "last_activity_date": 1436386706, "creation_date": 1436386706, "answer_id": 31302886, "question_id": 31302825, "link": "https://stackoverflow.com/questions/31302825/inaccessible-due-to-its-protection-level/31302886#31302886", "title": "Inaccessible due to its protection level?", "body": "<p>Even though the variables are in a public class, they must be declared as public as they are private by default.</p>\n\n<p>See: <a href=\"http://msdn.microsoft.com/en-us/library/ms173121.aspx\" rel=\"nofollow\">Access Modifiers</a></p>\n\n<blockquote>\n  <p>Class members, including nested classes and structs, can be public,\n  protected internal, protected, internal, or private. <strong>The access level\n  for class members and struct members, including nested classes and\n  structs, is private by default</strong>.</p>\n</blockquote>\n\n<p>It is best practice to use capitalized names and <a href=\"https://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx\" rel=\"nofollow\">properties</a> for public variables.</p>\n\n<pre><code>public A { get; set; }\n</code></pre>\n\n<p>Properties allow you to control the access of reading/writing of the member, as well as adding logic when they are read or set.</p>\n"}, {"comments": [{"owner": {"reputation": 39314, "user_id": 385844, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/21ffea7aa8a0cf833901322567c61df9?s=128&d=identicon&r=PG", "display_name": "phoog", "link": "https://stackoverflow.com/users/385844/phoog"}, "edited": false, "score": 1, "creation_date": 1436386956, "post_id": 31302894, "comment_id": 50595946, "body": "Also doesn&#39;t the private by default rule apply to all class and struct members, including properties, methods, and events?  These are not variables."}, {"owner": {"reputation": 5460, "user_id": 4564272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RujrA.jpg?s=128&g=1", "display_name": "Der Kommissar", "link": "https://stackoverflow.com/users/4564272/der-kommissar"}, "reply_to_user": {"reputation": 39314, "user_id": 385844, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/21ffea7aa8a0cf833901322567c61df9?s=128&d=identicon&r=PG", "display_name": "phoog", "link": "https://stackoverflow.com/users/385844/phoog"}, "edited": false, "score": 0, "creation_date": 1436386978, "post_id": 31302894, "comment_id": 50595959, "body": "Yes. It does. Private is assumed for all members of classes and structures."}], "tags": [], "owner": {"reputation": 5460, "user_id": 4564272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RujrA.jpg?s=128&g=1", "display_name": "Der Kommissar", "link": "https://stackoverflow.com/users/4564272/der-kommissar"}, "is_accepted": false, "score": 0, "last_activity_date": 1436387015, "last_edit_date": 1436387015, "creation_date": 1436386740, "answer_id": 31302894, "question_id": 31302825, "link": "https://stackoverflow.com/questions/31302825/inaccessible-due-to-its-protection-level/31302894#31302894", "title": "Inaccessible due to its protection level?", "body": "<p>Your problem is that, in C#, variables (in this case, <code>fields</code>) are marked as <code>private</code> if they are not specifically marked with an access modifier.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/wxh6fsc7.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/wxh6fsc7.aspx</a></p>\n\n<p>Classes and structures default to <code>internal</code>, fields, methods, events, properties, etc (basically, <strong>all</strong> members of <code>classes</code> and <code>structures</code>) default to <code>private</code>.</p>\n\n<p>Changing <code>int a</code> to <code>public int a</code> (and the same for b/c) will fix it.</p>\n\n<p>Though, I recommend <strong>not</strong> doing that. Instead, make a property for each.</p>\n\n<pre><code>public A { get { return a; } set { a = value; } }\npublic B { get { return b; } set { b = value; } }\npublic C { get { return c; } set { c = value; } }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19681, "user_id": 4751173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Haz6W.jpg?s=128&g=1", "display_name": "Glorfindel", "link": "https://stackoverflow.com/users/4751173/glorfindel"}, "is_accepted": false, "score": 1, "last_activity_date": 1436386741, "creation_date": 1436386741, "answer_id": 31302895, "question_id": 31302825, "link": "https://stackoverflow.com/questions/31302825/inaccessible-due-to-its-protection-level/31302895#31302895", "title": "Inaccessible due to its protection level?", "body": "<p>This is <strong>not</strong> caused by the constructor. You get the error because the field <code>methodTest.b</code> is private (in C#, fields are private by default; you need to specify an explicit modifier, so something like <code>public int b;</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 1278, "user_id": 4486694, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GXzvj.jpg?s=128&g=1", "display_name": "Chris Schubert", "link": "https://stackoverflow.com/users/4486694/chris-schubert"}, "is_accepted": false, "score": 0, "last_activity_date": 1436386819, "creation_date": 1436386819, "answer_id": 31302914, "question_id": 31302825, "link": "https://stackoverflow.com/questions/31302825/inaccessible-due-to-its-protection-level/31302914#31302914", "title": "Inaccessible due to its protection level?", "body": "<p>If you want to access your integers a, b, and c from outside of the class they are instantiated in, you have to declare them as <code>public</code>.  However a cleaner option is to use a property, such as:</p>\n\n<pre><code>public int A {get; set;}\npublic int B {get; set}\npublic int C {get; set;}\n</code></pre>\n\n<p>This sets up you up to potentially limit write access from outside classes, while still leaving the the properties open for reading, such as:</p>\n\n<pre><code>public int A {get; private set;}\npublic int B {get; private set}\npublic int C {get; private set;}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "is_accepted": false, "score": 3, "last_activity_date": 1436386910, "creation_date": 1436386910, "answer_id": 31302946, "question_id": 31302825, "link": "https://stackoverflow.com/questions/31302825/inaccessible-due-to-its-protection-level/31302946#31302946", "title": "Inaccessible due to its protection level?", "body": "<p>Access modifiers are keywords used to specify the declared accessibility of a member or a type. This section introduces the four access modifiers:</p>\n\n<p>The following five accessibility levels can be specified using the access modifiers:</p>\n\n<ol>\n<li><strong>public</strong> : Access is not restricted.</li>\n<li><strong>protected</strong> : Access is limited to the containing class or types\nderived from the containing class.</li>\n<li><strong>Internal</strong> : Access is limited to the current assembly.</li>\n<li><strong>protected</strong> internal: Access is limited to the current assembly or\ntypes derived from the containing class.</li>\n<li><strong>private</strong> : Access is limited to the containing type.</li>\n</ol>\n\n<p>Every members in <code>C#</code> are implicitly private, so in your question the <code>a,b</code> and <code>c</code> are defined as <code>private</code> and so you could not access to them from outside of <code>methodTest</code>.\nfor more information you may need to look at this page :\n<a href=\"https://msdn.microsoft.com/en-us/library/ms173121.aspx\" rel=\"nofollow\">Access Modifiers (C# Programming Guide)</a></p>\n\n<p>Good Luck! :)</p>\n"}], "owner": {"reputation": 105, "user_id": 5095638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a48d62ffc537be00b7ea2807bb0b0eae?s=128&d=identicon&r=PG", "display_name": "Forumpy", "link": "https://stackoverflow.com/users/5095638/forumpy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25342, "favorite_count": 0, "accepted_answer_id": 31302886, "answer_count": 5, "score": 4, "last_activity_date": 1436387015, "creation_date": 1436386509, "last_edit_date": 1436386792, "question_id": 31302825, "link": "https://stackoverflow.com/questions/31302825/inaccessible-due-to-its-protection-level", "title": "Inaccessible due to its protection level?", "body": "<p>I'm still quite new to coding in general, and while this simple program is only meant to be a test to learn how constructors work, I'd still like to know why I'm getting this error. </p>\n\n<pre><code>    using System;\n\n    public class methodTest\n    {\n        int a;\n        int b;\n        int c;\n         public methodTest(int i, int j, int k)\n        {\n            a = i;\n            b = j;\n            c = k;\n        }\n    }\n\n    public class methodObj\n    {\n        static void Main()\n        {\n        methodTest obj = new methodTest(10, 20, 30);\n        Console.WriteLine(\"obj = \" + obj.b);\n        Console.ReadKey();\n        }\n    }\n</code></pre>\n\n<p>I'm not entirely sure why I'm getting the error. The problem is with the Console.WriteLine, where it states it cannot access obj.b. The variables seem to be declared within a public class, so why can they not be accessed? I tried searching for a solution to this, but all the questions I found were much too convoluted for me to get an answer I could translate to my own understanding.\nAll help appreciated! </p>\n"}, {"tags": ["javascript", "c#", "web-services", "pdf"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 1, "creation_date": 1436386949, "post_id": 31302799, "comment_id": 50595939, "body": "Your AJAX call is expecting JSON back. That seems fishy. Plus, you have no error handler. I suspect you re-read the <a href=\"http://api.jquery.com/jquery.ajax/\" rel=\"nofollow noreferrer\">jQuery AJAX</a> documentation. Also, watch the network traffic in your browser&#39;s development tools. Pay particular attention to the path taken to the ASMX."}, {"owner": {"reputation": 16793, "user_id": 4665, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8f83c3e22eab30856c803b1d96e1a04f?s=128&d=identicon&r=PG", "display_name": "Jon P", "link": "https://stackoverflow.com/users/4665/jon-p"}, "edited": false, "score": 0, "creation_date": 1436399857, "post_id": 31302799, "comment_id": 50601236, "body": "Also remember with AJAX that the browser does not refresh, so you have to explicitly handle the response from the service in your AJAX call, things like downloads are not automatically handled."}], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 2410605, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8941c77bd740aec256146412667987?s=128&d=identicon&r=PG", "display_name": "Jimmy Genslinger", "link": "https://stackoverflow.com/users/2410605/jimmy-genslinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1436550327, "creation_date": 1436550327, "answer_id": 31347113, "question_id": 31302799, "link": "https://stackoverflow.com/questions/31302799/using-a-webservice-to-create-pdf-only-works-when-the-service-is-called-directly/31347113#31347113", "title": "Using a webservice to Create PDF only works when the service is called directly", "body": "<p>Thanks for the response, Mason!  I've been working on this and found a solution; and while I admit it's not perfect, I don't think it's too bad.  From all the different material I read, I started to get the feeling that a web service is more of a \"go between\" for passing data and not really meant to handle functionality like posting PDF documents.  It would let you get away with it when debugging and invoking it directly, but that's about it.  </p>\n\n<p>So instead of using a web service, I created a class object.  I also created a hidden field in my html.  This field gets populated with the desired div.innerHtml content via JavaScript when somebody clicks the \"Export to PDF\" button.  Upon postback, my codebehind checks to see if the hidden field is empty and if it isn't, it calls the exportPDF function, which in turn instantiates the class object that creates/downloads the PDF. The biggest pitfall to doing it this way, and some may consider this a big pitfall, is that to read in a field in the codebehind that has html markup in it you have to turn off validation for the web page, which obviously opens up your code for malicious attacks.</p>\n\n<p>Below are the highlights of my code: </p>\n\n<p><strong>Web.Config</strong></p>\n\n<p>Add requestValidationMode = \"2.0\" to the web.config file</p>\n\n<pre><code>&lt;system.web&gt;\n  &lt;httpRuntime \n    requestValidationMode=\"2.0\" \n    targetFramework=\"4.5\" \n  /&gt;\n&lt;/system.web&gt;\n</code></pre>\n\n<p><strong>.aspx Page:</strong></p>\n\n<p>Set ValidateRequest=\"false\" in Page reference</p>\n\n<pre><code>&lt;%@ Page Title=\"Referrals\" Language=\"C#\" MasterPageFile=\"~/Behavior/Behavior.master\" AutoEventWireup=\"true\" CodeBehind=\"Referrals.aspx.cs\"\nInherits=\"DMC.Behavior.Referrals\" ClientIDMode=\"Static\" EnableEventValidation=\"false\" ValidateRequest=\"false\" %&gt;\n.\n.\n.\n    &lt;asp:LinkButton ID=\"LinkButton2\" runat=\"server\" OnClientClick=\"createPDF();\"&gt;\n        &lt;img src='../Images/icons/pdf.png'&gt;PDF&lt;/asp:LinkButton&gt;\n.\n.\n.\n&lt;div id=\"export_pdf\" class=\"pdfWidth_Portrait pdfSection\" style=\"margin-top: 10px;\" runat=\"server\"&gt;\n    &lt;div class=\"alert-info text-center\" style=\"margin: 0; padding: 0;\"&gt;\n        &lt;table class=\"table table-condensed\" style=\"margin-top: 0; padding: 30px; width: 100%;\"&gt;\n    .\n    .\n    .   \n        &lt;/table&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n.\n.\n.\n&lt;asp:HiddenField ID=\"pdfData\" runat=\"server\" /&gt;\n.\n.\n.\n&lt;script type=\"text/javascript\"&gt;\n    function createPDF() {\n        document.getElementById(\"pdfData\").value = document.getElementById(\"export_pdf\").innerHTML;\n    }\n&lt;/script&gt;\n</code></pre>\n\n<p><strong>Code Behind:</strong></p>\n\n<pre><code>    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!IsPostBack)\n        {\n            //Set the hidden pdf field to null initially\n            pdfData.Value = \"\";\n        }\n\n        //If this field is no longer null, it means somebody is wanting to export into PDF\n        if (pdfData.Value != \"\")\n        {\n            exportPDF();\n        }\n    }\n\n    public void exportPDF()\n    {\n        string fileName = null;\n        export dmc = new export();\n\n        fileName = lblLocation.Text + \" Behavior Statistics YTD \" + lblDate.Text;\n\n        dmc.exportPDF(fileName, \"Portrait\", pdfData.Value);\n\n        //PDF downloaded, reset value to \"\"\n        pdfData.Value = \"\";\n    }\n</code></pre>\n\n<p><strong>Export Class</strong></p>\n\n<pre><code>using NReco.PdfGenerator;\nusing System.Configuration;\nusing System.Data;\nusing System.Data.SqlClient;\nusing System.IO;\nusing System.Text;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.HtmlControls;\nusing System.Web.UI.WebControls;\n\nnamespace DMC.Classes\n{\n    public class export \n    {\n        public void exportPDF(string fileName, string Orientation, string html)\n        {\n            HtmlToPdfConverter pdf = new HtmlToPdfConverter();\n\n            //Remove these control characters, they interfere with the formatting of the pdf document\n            html = html.Replace(\"\\n\", \"\");\n            html = html.Replace(\"\\t\", \"\");\n            html = html.Replace(\"\\r\", \"\");\n\n            switch (Orientation)\n            {\n                case \"Portrait\":\n                    pdf.Orientation = PageOrientation.Portrait;\n                    break;\n                case \"Landscape\":\n                    pdf.Orientation = PageOrientation.Landscape;\n                    break;\n                default:\n                    pdf.Orientation = PageOrientation.Default;\n                    break;\n            }\n\n            //In case needed for future\n            //pdf.CustomWkHtmlArgs = \"--margin-top 35 --header-spacing 0 --margin-left 0 --margin-right 0\";\n\n            pdf.Margins.Top = 25;\n            pdf.PageFooterHtml = createPDFFooter();\n\n            var pdfBytes = pdf.GeneratePdf(createPDFScript() + html + \"&lt;/body&gt;&lt;/html&gt;\");\n\n            HttpContext.Current.Response.ContentType = \"application/pdf\";\n            HttpContext.Current.Response.ContentEncoding = System.Text.Encoding.UTF8;\n            HttpContext.Current.Response.AddHeader(\"content-disposition\", \"attachment; filename=\" + fileName + \".pdf\");\n            HttpContext.Current.Response.BinaryWrite(pdfBytes);\n            HttpContext.Current.Response.Flush();\n            HttpContext.Current.Response.End();\n        }\n\n        private string createPDFScript()\n        {\n            return \"&lt;html&gt;&lt;head&gt;&lt;style&gt;td,th{line-height:20px;} tr { page-break-inside: avoid }&lt;/style&gt;&lt;script&gt;function subst() {var vars={};var x=document.location.search.substring(1).split('&amp;');for(var i in x) {var z=x[i].split('=',2);vars[z[0]] = unescape(z[1]);}\" +\n        \"var x=['frompage','topage','page','webpage','section','subsection','subsubsection'];for(var i in x) {var y = document.getElementsByClassName(x[i]);\" +\n        \"for(var j=0; j&lt;y.length; ++j) y[j].textContent = vars[x[i]];}}&lt;/script&gt;&lt;/head&gt;&lt;body onload=\\\"subst()\\\"&gt;\";\n        }\n\n        private string createPDFFooter()\n        {\n            return \"&lt;div&gt;&lt;table style='font-family:Tahoma; font-size:9px; width:100%'&gt;&lt;tr&gt;&lt;td style='text-align:left'&gt;Research Dept|RR:mm:jpg&lt;/td&gt;&lt;td style='text-align:right'&gt;Page &lt;span class=\\\"page\\\"&gt;&lt;/span&gt; of &lt;span class=\\\"topage\\\"&gt;&lt;/span&gt;&lt;/td&gt;&lt;/div&gt;\";\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 453, "user_id": 2410605, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7b8941c77bd740aec256146412667987?s=128&d=identicon&r=PG", "display_name": "Jimmy Genslinger", "link": "https://stackoverflow.com/users/2410605/jimmy-genslinger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1027, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436550327, "creation_date": 1436386441, "question_id": 31302799, "link": "https://stackoverflow.com/questions/31302799/using-a-webservice-to-create-pdf-only-works-when-the-service-is-called-directly", "title": "Using a webservice to Create PDF only works when the service is called directly", "body": "<p>I'm a novice with webservices, so this one has me stumped.  I have created a webservice that will (eventually) accept a block of html and create a pdf file from it.  To keep it simple, currently I'm not passing any parameters into the service; I'm just creating a pdf document with \"hello world\" in it.  In debug mode, when I call the service directly (i.e. start debugging from that asmx page), I can invoke the exportPDF() method and the results are perfect -- it creates the pdf just as I'd hoped.  </p>\n\n<p>The problem is when I call the webservice from a javascript, nothing happens.  I've set up a breakpoint inside the service, so I know it's getting called, and as I mentioned there are no parameters being passed in, so I don't understand why it works when it's invoked directly, but not when it's invoked from a javascript call.  </p>\n\n<p>My javascript and webservice code is below...any help would be greatly, greatly appreciated!!</p>\n\n<p><strong>Javascript:</strong></p>\n\n<pre><code>    function getPDF(elem) {\n    var param = { html: elem.innerHTML };\n\n    $.ajax({\n        type: \"POST\",\n        contentType: \"application/json; charset=UTF-8\",\n        url: \"../WebServices/exporting.asmx/exportPDF\",\n        data: \"{ }\",\n        dataType: \"json\",\n        success: function (response) {\n        }\n    })\n}\n</code></pre>\n\n<p><strong>WebService:</strong></p>\n\n<pre><code>using DMC.Classes;\nusing NReco.PdfGenerator;\nusing System;\nusing System.IO;\nusing System.Web;\nusing System.Web.Services;\nusing System.Web.UI;\n\nnamespace DMC.WebServices\n{\n    [WebService(Namespace = \"http://tempuri.org/\")]\n    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\n    [System.ComponentModel.ToolboxItem(false)]\n    [System.Web.Script.Services.ScriptService]\n\n    public class exporting : System.Web.Services.WebService\n    {\n        [WebMethod]\n        public void exportPDF()\n        {\n            WriteDocument(\"htmlToPDF.pdf\", \"application/pdf\", ConvertHtmlToPDF());\n        }\n\n        public byte[] ConvertHtmlToPDF()\n        {\n            HtmlToPdfConverter nRecohtmltoPdfObj = new HtmlToPdfConverter();\n            nRecohtmltoPdfObj.Orientation = PageOrientation.Portrait;\n            nRecohtmltoPdfObj.PageFooterHtml = CreatePDFFooter();\n            nRecohtmltoPdfObj.CustomWkHtmlArgs = \"--margin-top 35 --header-spacing 0 --margin-left 0 --margin-right 0\";\n            return nRecohtmltoPdfObj.GeneratePdf(CreatePDFScript() + \"Hello world\" + \"&lt;/body&gt;&lt;/html&gt;\");\n        }\n\n        public string CreatePDFScript()\n        {\n            return \"&lt;html&gt;&lt;head&gt;&lt;style&gt;td,th{line-height:20px;} tr { page-break-inside: avoid }&lt;/style&gt;&lt;script&gt;function subst() {var vars={};var x=document.location.search.substring(1).split('&amp;');for(var i in x) {var z=x[i].split('=',2);vars[z[0]] = unescape(z[1]);}\" +\n            \"var x=['frompage','topage','page','webpage','section','subsection','subsubsection'];for(var i in x) {var y = document.getElementsByClassName(x[i]);\" +\n            \"for(var j=0; j&lt;y.length; ++j) y[j].textContent = vars[x[i]];}}&lt;/script&gt;&lt;/head&gt;&lt;body onload=\\\"subst()\\\"&gt;\";\n        }\n\n        public string CreatePDFFooter()\n        {\n            return \"&lt;div style='text-align:center;font-family:Tahoma; font-size:9px;'&gt;Page &lt;span class=\\\"page\\\"&gt;&lt;/span&gt; of &lt;span class=\\\"topage\\\"&gt;&lt;/span&gt;&lt;/div&gt;\";\n        }\n\n        public void WriteDocument(string fileName, string contentType, byte[] content)\n        {\n            HttpContext.Current.Response.Clear();\n            HttpContext.Current.Response.ContentType = contentType;\n            HttpContext.Current.Response.AddHeader(\"content-disposition\", \"attachment; filename=\" + fileName);\n            HttpContext.Current.Response.CacheControl = \"No-cache\";\n            HttpContext.Current.Response.BinaryWrite(content);\n            HttpContext.Current.Response.Flush();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "configuration"], "answers": [{"comments": [{"owner": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "edited": false, "score": 0, "creation_date": 1436389966, "post_id": 31303218, "comment_id": 50597502, "body": "Interesting.  I never saw an example of the <code>add</code> element that used anything other than <code>name</code> and <code>value</code> attributes.  I&#39;m trying this, but running into other problems.  Stay tuned...."}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "reply_to_user": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "edited": false, "score": 0, "creation_date": 1436390643, "post_id": 31303218, "comment_id": 50597849, "body": "Odd.  You&#39;ve never seen a connection strings section?  Or pages/namespaces? Or httpHandlers?  Modules?  SqlDependencies? OutputCacheSettings?  Compilation/assemblies?"}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "reply_to_user": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "edited": false, "score": 0, "creation_date": 1436390776, "post_id": 31303218, "comment_id": 50597898, "body": "Although, system.webserver/runtime/assemblybinding does have multiple dependentAssembly children that don&#39;t use &quot;add&quot; as the tag but &quot;dependentAssembly&quot; as the tag with it&#39;s own children.  So you can do that too, it is just a lot less common."}, {"owner": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "edited": false, "score": 0, "creation_date": 1436394453, "post_id": 31303218, "comment_id": 50599471, "body": "The sarcasm isn&#39;t particularly appreciated (or necessary) but, yeah I&#39;m a newbie at using System.Configuration and I&#39;m not working with databases, or http, or ... so I haven&#39;t gone down those pathways in the massive but mostly unhelpful documentation in MSDN.  It&#39;s amazing how effectively they tell you everything except what you want to know. (I know, sarcasm on my part.)"}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "reply_to_user": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "edited": false, "score": 0, "creation_date": 1436473534, "post_id": 31303218, "comment_id": 50641178, "body": "Sorry, didn&#39;t mean to be sarcastic, just not usual to run across someone who is trying to create custom configurations and hasn&#39;t worked with either the web or a database yet."}], "tags": [], "owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "is_accepted": false, "score": 1, "last_activity_date": 1436388841, "last_edit_date": 1436388841, "creation_date": 1436387863, "answer_id": 31303218, "question_id": 31302781, "link": "https://stackoverflow.com/questions/31302781/net-configuration-with-multiple-instances-of-a-set-of-parameters/31303218#31303218", "title": ".NET configuration with multiple instances of a set of parameters", "body": "<p>Haven't worked with custom config sections, but from a purely logical point of view, isn't this more appropriate:</p>\n\n<pre><code>&lt;userSettings&gt;\n    &lt;servers&gt;\n        &lt;add name=\"washington\" host=\"abc.presidents.com\" port=\"1414\" credentials=\"george\"/&gt;\n        &lt;add name=\"adams\" host=\"def.presidents.com\" port=\"1419\" credentials=\"john\"/&gt;\n        &lt;!--insert more server definitions here --&gt;\n    &lt;/servers&gt;\n    &lt;!-- insert more user settings here --&gt;\n&lt;/userSettings&gt;\n</code></pre>\n\n<p>You can do it other ways, but if you want a collection of \"server\", then it must be in a grouping element like \"servers\".  You can't just have multiple \"server\" in a parent element that can also contain other types of children.  The tag within the group is almost always \"add\".</p>\n\n<p>In any case \"System.Configuration.SingleTagSectionHandler\" definitely is not the correct type.</p>\n"}, {"comments": [{"owner": {"reputation": 1262, "user_id": 175269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9285d0800418f5faa5aba025830fc846?s=128&d=identicon&r=PG", "display_name": "zomf", "link": "https://stackoverflow.com/users/175269/zomf"}, "edited": false, "score": 0, "creation_date": 1477992750, "post_id": 31347782, "comment_id": 67967940, "body": "Thank your posting your final working result!  I took inspiration from this and from .Net Framework source code for ConnectionStringSettingsCollection, which looks quite similar to what you have here. I&#39;m posting this a link to the .Net reference source because it validates your approach, and contains a plethora of other useful implimentations to glean from. <a href=\"https://referencesource.microsoft.com/#System.Configuration/System/Configuration/ConnectionStringSettingsCollection.cs,ce6c273ea26349e5\" rel=\"nofollow noreferrer\">referencesource.microsoft.com/#System.Configuration/System/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "is_accepted": true, "score": 2, "last_activity_date": 1436552753, "creation_date": 1436552753, "answer_id": 31347782, "question_id": 31302781, "link": "https://stackoverflow.com/questions/31302781/net-configuration-with-multiple-instances-of-a-set-of-parameters/31347782#31347782", "title": ".NET configuration with multiple instances of a set of parameters", "body": "<h1>Conclusions</h1>\n\n<ul>\n<li>Collections of property sets cannot be supported without creating custom property classes.</li>\n<li>Support for creating custom property classes is pretty good.</li>\n<li>Documentation for creating custom property classes is abysmal, however I did finally find a decent <a href=\"http://www.codeproject.com/Articles/16466/Unraveling-the-Mysteries-of-NET-2-0-Configuration\" rel=\"nofollow\">overview document</a> that helped me find an answer.</li>\n</ul>\n\n<h1>The Configuration file</h1>\n\n<p>The app.config file I ended up with is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n    &lt;configSections&gt;\n        &lt;sectionGroup name=\"userSettings\" \n                      type=\"System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" &gt;\n            &lt;section name=\"executiveBranch\" \n                     type=\"PropProto.Properties.ExecutiveBranchSection, PropProto, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" \n                     allowExeDefinition=\"MachineToLocalUser\" \n                     requirePermission=\"false\" /&gt;\n        &lt;/sectionGroup&gt;\n    &lt;/configSections&gt;\n    &lt;userSettings&gt;\n        &lt;executiveBranch&gt;\n            &lt;presidents&gt;\n                &lt;president key=\"first\"\n                           name=\"George Washington\"\n                           legacy=\"The Fother of Our County\"\n                           /&gt;\n                &lt;president key=\"honestAbe\"\n                           name=\"Abraham Lincoln\"\n                           legacy=\"Freed the Slaves\"\n                           /&gt;\n                &lt;president key=\"who\"\n                           name=\"Chester Arthur\"\n                           /&gt;\n                &lt;president key=\"dubya\"\n                           name=\"George W. Bush\"\n                           legacy=\"Mission Accomplished!!!\"\n                           /&gt;\n                &lt;president key=\"barack\"\n                           name=\"Barack Obama\"\n                           legacy=\"Affordable Health Care\"\n                           /&gt;\n\n            &lt;/presidents&gt;\n        &lt;/executiveBranch&gt;\n    &lt;/userSettings&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>There is one more nesting level than I had expected (or want).  That's because <code>presidents</code> is a <code>ConfigurationElementCollection</code> and <code>userSettings</code> cannot include a <code>ConfigurationElementCollection</code> directly, so I had to introduce <code>executiveBranch</code>.</p>\n\n<h1>Using the Configuration</h1>\n\n<p>The code to read these settings is:</p>\n\n<pre><code>var exeConfiguration = ConfigurationManager.OpenExeConfiguration(\n      ConfigurationUserLevel.PerUserRoamingAndLocal);\nvar userSettings = exeConfiguration.GetSectionGroup(\"userSettings\");\nvar executiveBranch = (ExecutiveBranchSection)userSettings.Sections.Get(\n        ExecutiveBranchSection.Tag);\nvar presidents = executiveBranch.Presidents;\nforeach (President president in presidents)\n{\n    Console.WriteLine(\"{0}: {1}\", president.Name, president.Legacy);\n}\n</code></pre>\n\n<h1>The Custom Properties Classes</h1>\n\n<p>And the custom classes to make all this work:</p>\n\n<pre><code>public class ExecutiveBranchSection : ConfigurationSection\n{\n    public const string Tag = \"executiveBranch\";\n    [ConfigurationProperty(PresidentCollection.Tag)]\n    public PresidentCollection Presidents { get { return (PresidentCollection)base[PresidentCollection.Tag]; } }\n}\n\n[ConfigurationCollection(typeof(President),\n    CollectionType = ConfigurationElementCollectionType.BasicMap,\n    AddItemName = President.Tag)]\npublic class PresidentCollection : ConfigurationElementCollection\n{\n    public const string Tag = \"presidents\";\n    protected override string ElementName { get { return President.Tag; } }\n\n    public President this[int index]\n    {\n        get { return (President)base.BaseGet(index); }\n        set\n        {\n            if (base.BaseGet(index) != null)\n            {\n                base.BaseRemoveAt(index);\n            }\n\n            base.BaseAdd(index, value);\n        }\n    }\n\n    new public President this[string name] { get { return (President)base.BaseGet(name); } }\n\n    protected override ConfigurationElement CreateNewElement()\n    {\n        return new President();\n    }\n\n    protected override object GetElementKey(ConfigurationElement element)\n    {\n        return (element as President).Key;\n    }\n}\n\npublic class President : ConfigurationElement\n{\n    public const string Tag = \"president\";\n    [ConfigurationProperty(\"key\", IsRequired = true)]\n    public string Key { get { return (string)base[\"key\"]; } }\n    [ConfigurationProperty(\"name\", IsRequired = true)]\n    public string Name { get { return (string)base[\"name\"]; } }\n    [ConfigurationProperty(\"legacy\", IsRequired = false)]\n    public string Legacy { get { return (string)base[\"legacy\"]; } }\n}\n</code></pre>\n"}], "owner": {"reputation": 8289, "user_id": 391806, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/88a2ea78dadbdaf73e1033fe7cbdeb73?s=128&d=identicon&r=PG", "display_name": "Dale Wilson", "link": "https://stackoverflow.com/users/391806/dale-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "accepted_answer_id": 31347782, "answer_count": 2, "score": 1, "last_activity_date": 1436552753, "creation_date": 1436386374, "last_edit_date": 1436455513, "question_id": 31302781, "link": "https://stackoverflow.com/questions/31302781/net-configuration-with-multiple-instances-of-a-set-of-parameters", "title": ".NET configuration with multiple instances of a set of parameters", "body": "<p>I have an application that can connect to several servers.  The actual number of servers is not known until runtime,and may change from day to day.  It takes several actual parameters to fully define a server.</p>\n\n<p>I'm trying to configure the application using .NET support for application configurations.</p>\n\n<p>The configuration file looks something like:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n    &lt;configSections&gt;\n        &lt;sectionGroup\n           name=\"userSettings\"\n            type=\"System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" &gt;\n            &lt;section name=\"server\"\n                type=\"System.Configuration.SingleTagSectionHandler\"\n                allowExeDefinition=\"MachineToLocalUser\"\n                requirePermission=\"false\" /&gt;\n        &lt;/sectionGroup&gt;\n    &lt;/configSections&gt;\n    &lt;userSettings&gt;\n        &lt;server name=\"washington\"&gt;\n            &lt;add name=\"host\" value=\"abc.presidents.com\"/&gt;\n            &lt;add name=\"port\" value=\"1414\"/&gt;\n            &lt;add name=\"credentials\" value=\"george\"/&gt;\n        &lt;/server&gt;\n        &lt;server name=\"adams\"&gt;\n            &lt;add name=\"host\" value=\"def.presidents.com\"/&gt;\n            &lt;add name=\"port\" value=\"1419\"/&gt;\n            &lt;add name=\"credentials\" value=\"john\"/&gt;\n        &lt;/server&gt;\n        &lt;!--insert more server definitions here --&gt;\n    &lt;/userSettings&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>And I tried to read this with code something like this (the WriteLines are for diagnosing the problem.  They will go away when/if it works.):</p>\n\n<pre><code>try\n{\n    var exeConfiguration = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.PerUserRoamingAndLocal);\n    Console.WriteLine(exeConfiguration);\n\n    var userSettings = exeConfiguration.GetSectionGroup(\"userSettings\");\n    Console.WriteLine(\"{0}: {1}\", userSettings, userSettings.Name);\n\n    var sections = userSettings.Sections;\n    Console.WriteLine(\"{0}: {1}\", sections, sections.Count);\n    foreach (ConfigurationSection section in sections)\n    {\n        Console.WriteLine(\"{0}\", section);\n        // todo Here's where we capture information about a server\n    }\n\n}\ncatch (System.Exception ex)\n{\n    Console.WriteLine(\"Exception: {0}\", ex.Message);\n}\n</code></pre>\n\n<p>This throws an exception from the foreach and produces the following output:</p>\n\n<pre><code>    System.Configuration.Configuration\n    System.Configuration.UserSettingsGroup: userSettings\n    System.Configuration.ConfigurationSectionCollection: 1\n    Exception: Sections must only appear once per config file.  See the help topic &lt;location&gt; for exceptions.\n</code></pre>\n\n<p>If I remove the second server, leaving only washington, it \"works\" producing this output:</p>\n\n<pre><code>System.Configuration.Configuration\nSystem.Configuration.ConfigurationSectionGroup: userSettings\nSystem.Configuration.ConfigurationSectionCollection: 1\nSystem.Configuration.DefaultSection\n</code></pre>\n\n<p>I've tried other variations on the theme (nested sectionGroups, etc.) without finding a solution.  The various tutorial examples I've found seem to want me to create a separate class for each Server.  This is obviously impractical, and should be unnecessary since all servers are created equal.</p>\n\n<p>Questions: </p>\n\n<ul>\n<li>Does System.Configuration support the concept of a collection of sets of related settings  (like an array of structures)?</li>\n<li>If so.. how?</li>\n<li>If not.. is there another way to store persistent configuration information that does support this concept, or am I going to have to roll-my-own?</li>\n</ul>\n\n<h1>Progress Report</h1>\n\n<p>Based on the partial answer by Robert McKee I modified the xml like so:</p>\n\n<pre><code>            &lt;section name=\"servers\"\n                type=\"System.Configuration.DefaultSection, System.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>&lt;servers&gt;\n    &lt;add name=\"washington\" host=\"abc.presidents.com\" port=\"1414\" credentials=\"george\"/&gt;\n    &lt;add name=\"adams\" host=\"def.presidents.com\" port=\"1419\" credentials=\"john\"/&gt;\n    &lt;!--insert more server definitions here --&gt;\n&lt;/servers&gt;\n</code></pre>\n\n<p>This is an improvement with one fatal problem.  As you can see I changed the <code>type</code> attribute of the <code>section</code> element to name the class <code>ystem.Configuration.DefaultSection</code>  <code>DefaultSection</code> succeeds at reading the configuration information (I think, at least it does not complain.) but it does not expose any way to access the information it read!</p>\n\n<p>Therefore I need to use some other type of <code>*Section</code> class. Microsoft provides 95 classes derived from the <code>ConfigurationSection</code> base class, but all of them except <code>DefaultSection</code> and <code>ClientSettingsSection</code> appear to be targeted at special cases (urls, database connection strings, date and times, etc...)  <code>ClientSettingsSection</code> won't even read the servers section -- complaining that <code>&lt;add/&gt;</code> is not a valid nested element.</p>\n\n<p>So, bottom line is I'm going to have to write a custom <code>ConfigurationSection</code> to handle these settings.  If I get it working I'll add an answer with the ultimate solution (unless someone provide a better answer first.)</p>\n"}, {"tags": ["c#", "forms", "winforms"], "comments": [{"owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "edited": false, "score": 0, "creation_date": 1436386488, "post_id": 31302767, "comment_id": 50595649, "body": "what did you have tried ? you would use a simple static class to share data."}, {"owner": {"reputation": 47, "user_id": 5019419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a54fde9215cee8b678ef7ca02a1b50c?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/5019419/dylan"}, "reply_to_user": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "edited": false, "score": 0, "creation_date": 1436386602, "post_id": 31302767, "comment_id": 50595726, "body": "@AliAdlavaran I&#39;ve tried using stuff like   (mainForm form1 = new mainForm)   For some reason I can&#39;t make the main form in my 2nd class though.  Can you link me to an example of a simple static class? I&#39;m pretty new to programming."}], "answers": [{"tags": [], "owner": {"reputation": 1660, "user_id": 1911199, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/02d88411e93d397468c660cb16b2be6a?s=128&d=identicon&r=PG", "display_name": "oppassum", "link": "https://stackoverflow.com/users/1911199/oppassum"}, "is_accepted": false, "score": 2, "last_activity_date": 1436386618, "creation_date": 1436386618, "answer_id": 31302855, "question_id": 31302767, "link": "https://stackoverflow.com/questions/31302767/sending-a-string-from-one-form-to-another-form-c/31302855#31302855", "title": "Sending a String From One Form To another Form C#", "body": "<p>This is done in two ways.  If you are trying to pass a string from the owner form to the child form, you can do it in a parameter, like so:</p>\n\n<pre><code>class Owner : Form\n{\n   private Child Child;\n   public Owner()\n   {\n       Child = new Child(\"Value To Pass\");\n   }\n}\nclass Child : Form\n{\n\n    public Child(string value)\n    {\n        //do something with value\n    }\n}\n</code></pre>\n\n<p>If you want to pass from the Child to the Owner, it would be like this:</p>\n\n<pre><code>class Owner : Form\n{\n   public Owner()\n   {\n       Child = new Child();\n       Child.ShowDialog();\n       string childValue = Child.Value;\n   }\n}\nclass Child : Form\n{\n    public string Value{get;set;}\n    public Child()\n    {\n\n    }\n\n    protected override void OnShown(EventArgs e)\n    {\n        base.OnShown(e);\n        value = \"Value To Set\";\n        this.Close();\n    }\n}\n</code></pre>\n\n<p>Note that I'm using \"Child.ShowDialog()\" to make sure that the child form is closed before the value returns.  This isn't necessary, but safer.</p>\n"}], "owner": {"reputation": 47, "user_id": 5019419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a54fde9215cee8b678ef7ca02a1b50c?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/5019419/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1436387117, "answer_count": 1, "score": 0, "last_activity_date": 1436386618, "creation_date": 1436386320, "question_id": 31302767, "link": "https://stackoverflow.com/questions/31302767/sending-a-string-from-one-form-to-another-form-c", "closed_reason": "Duplicate", "title": "Sending a String From One Form To another Form C#", "body": "<p>I've been trying to send a string from one form named mainForm to my other form unlockForm.</p>\n\n<p>The references I've found are sending values from things like textboxes. I simply want to send a string.</p>\n"}, {"tags": ["c#", "sql", "entity-framework", "entity-framework-6"], "comments": [{"owner": {"reputation": 11383, "user_id": 1753728, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dad2593d1ec5637c74e1057592f01c94?s=128&d=identicon&r=PG", "display_name": "Oluwafemi", "link": "https://stackoverflow.com/users/1753728/oluwafemi"}, "edited": false, "score": 0, "creation_date": 1436386220, "post_id": 31302709, "comment_id": 50595495, "body": "Show some code like what you&#39;ve tried?"}, {"owner": {"reputation": 3837, "user_id": 821054, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/9d7Md.jpg?s=128&g=1", "display_name": "RMalke", "link": "https://stackoverflow.com/users/821054/rmalke"}, "edited": false, "score": 0, "creation_date": 1436386697, "post_id": 31302709, "comment_id": 50595774, "body": "I think the OP wants this to use like a &quot;lock&quot; bit"}, {"owner": {"reputation": 147, "user_id": 2058139, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mUk2r.jpg?s=128&g=1", "display_name": "rmnblm", "link": "https://stackoverflow.com/users/2058139/rmnblm"}, "edited": false, "score": 0, "creation_date": 1436387091, "post_id": 31302709, "comment_id": 50596019, "body": "Excactly, this will be the use of this table, as a &quot;lock&quot; bit."}], "answers": [{"tags": [], "owner": {"reputation": 2373, "user_id": 314770, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c058a73231ee730c25e5efac69bec99d?s=128&d=identicon&r=PG", "display_name": "Krishna", "link": "https://stackoverflow.com/users/314770/krishna"}, "is_accepted": false, "score": 1, "last_activity_date": 1436386916, "last_edit_date": 1495542167, "creation_date": 1436386916, "answer_id": 31302947, "question_id": 31302709, "link": "https://stackoverflow.com/questions/31302709/single-row-table-in-entity-framework-6/31302947#31302947", "title": "Single Row Table in Entity Framework 6", "body": "<p>you could make one of the columns as primary and also allow only one value. unfortunately fluent api currently doenst support default value</p>\n\n<pre><code>public class StatusIdentifer\n{\n  [DefaultValue(\"1\")]\n  [Key]\n  public int id {get; set}; //set can be removed here?\n  public bool status {get:set;} //your boolean value\n}\n</code></pre>\n\n<p>the trick is not to expose any set methods for id.</p>\n\n<p>at database level you can still break the paradigm. The answer <a href=\"https://stackoverflow.com/questions/4413084/unique-constraint-in-entity-framework-code-first\">here</a> tells how to create a check constraint</p>\n\n<pre><code>public void InitializeDatabase(MyRepository context) {\n            if (!context.Database.Exists() || !context.Database.ModelMatchesDatabase()) {\n                context.Database.DeleteIfExists();\n                context.Database.Create();\n\n                context.ObjectContext.ExecuteStoreCommand(\"CREATE UNIQUE CONSTRAINT...\");\n                context.ObjectContext.ExecuteStoreCommand(\"CREATE INDEX...\");\n                context.ObjectContext.ExecuteStoreCommand(\"ETC...\");\n            }\n        }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 2058139, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mUk2r.jpg?s=128&g=1", "display_name": "rmnblm", "link": "https://stackoverflow.com/users/2058139/rmnblm"}, "is_accepted": false, "score": 0, "last_activity_date": 1436478237, "last_edit_date": 1436478237, "creation_date": 1436477935, "answer_id": 31328696, "question_id": 31302709, "link": "https://stackoverflow.com/questions/31302709/single-row-table-in-entity-framework-6/31328696#31328696", "title": "Single Row Table in Entity Framework 6", "body": "<p>With a bit of research I came up with this solution.\nI created an Initializer for the database (because ExecuteSqlCommand cannot be invoked in the OnModelCreating method).</p>\n\n<pre><code>class UserDbInitializer : CreateDatabaseIfNotExists&lt;UserDbContext&gt;\n{\n    protected override void Seed(UserDbContext context)\n    {\n        context.Database.ExecuteSqlCommand(\n            \"CREATE TABLE __Lock(\" +\n            \"Id char(1) NOT NULL DEFAULT 'X',\" +\n            \"Lock bit NOT NULL,\" +\n            \"CONSTRAINT PK_LOCK PRIMARY KEY (Id),\" +\n            \"CONSTRAINT CK_LOCK_Locked CHECK (Id='X'))\"\n        );\n\n        context.Database.ExecuteSqlCommand(\n            \"INSERT INTO __Lock VALUES('X', 0)\"\n        );\n\n        base.Seed(context);\n    }\n}\n</code></pre>\n\n<p>And in the UserDbContext is following property:</p>\n\n<pre><code>public bool Locked\n{\n    get\n    {\n        return Database.SqlQuery&lt;bool&gt;(\"SELECT Lock FROM __Lock\").SingleAsync().Result;\n    }\n    set\n    {\n        if (value)\n            Database.ExecuteSqlCommand(\"UPDATE __Lock SET Lock = 1\");\n        else\n            Database.ExecuteSqlCommand(\"UPDATE __Lock SET Lock = 0\");\n    }\n}\n</code></pre>\n\n<p>Hope this helps for others :)</p>\n"}], "owner": {"reputation": 147, "user_id": 2058139, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/mUk2r.jpg?s=128&g=1", "display_name": "rmnblm", "link": "https://stackoverflow.com/users/2058139/rmnblm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1776, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1436478237, "creation_date": 1436386147, "question_id": 31302709, "link": "https://stackoverflow.com/questions/31302709/single-row-table-in-entity-framework-6", "title": "Single Row Table in Entity Framework 6", "body": "<p>I couldn't find a solution for this problem but the title makes clear what I want. </p>\n\n<p>Is it possible to create a single row table (I only need to store a boolean value in a table)? And how can I configure this constraint with Fluent API?</p>\n"}, {"tags": ["c#", "report-viewer2010"], "answers": [{"tags": [], "owner": {"reputation": 251, "user_id": 1253821, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d017e7838b6f7a346369325840a93dda?s=128&d=identicon&r=PG", "display_name": "Bernie Hunt", "link": "https://stackoverflow.com/users/1253821/bernie-hunt"}, "is_accepted": true, "score": 0, "last_activity_date": 1437255781, "creation_date": 1437255781, "answer_id": 31495875, "question_id": 31302675, "link": "https://stackoverflow.com/questions/31302675/column-total-on-sub-report-for-displayed-rows/31495875#31495875", "title": "Column total on sub report for displayed rows", "body": "<p>The answer turned out to be to filter the dataset for the one employee needed in the subreport at that time. Apparently the MS reporting software doesn't filter based on the subreport criteria. I used a LINQ query against the datatable to get the employeeID that comes as part of the subreport handler. Now the sum calculation is correct.</p>\n"}], "owner": {"reputation": 251, "user_id": 1253821, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d017e7838b6f7a346369325840a93dda?s=128&d=identicon&r=PG", "display_name": "Bernie Hunt", "link": "https://stackoverflow.com/users/1253821/bernie-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 31495875, "answer_count": 1, "score": 0, "last_activity_date": 1437255781, "creation_date": 1436386056, "question_id": 31302675, "link": "https://stackoverflow.com/questions/31302675/column-total-on-sub-report-for-displayed-rows", "title": "Column total on sub report for displayed rows", "body": "<p>I'm working on a time sheet report that will display day by day punch records for the employee and then total out their hours for the week. The master report is a list of all employees and their demographic information. The sub report is a list of each days punch in and out information. When I put a sum at the end of the total time column, it sums all of the time for all employees sub report records. </p>\n\n<p>I want it to display the sum of the column just for this employee.</p>\n\n<p>What am I missing to make this work?</p>\n"}, {"tags": ["c#", "asp.net", "session", "viewstate", "page-lifecycle"], "comments": [{"owner": {"reputation": 504, "user_id": 4972837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c610752461191be3bcd0c4bfc5af06?s=128&d=identicon&r=PG&f=1", "display_name": "Elisheva Wasserman", "link": "https://stackoverflow.com/users/4972837/elisheva-wasserman"}, "edited": false, "score": 0, "creation_date": 1436387384, "post_id": 31302628, "comment_id": 50596188, "body": "Click on view source, and see what size of viewState do you have, Storing big objects in the view state is not a best practice, as viewstate are simple hidden fields, and the html file&#39;s size becomes huge"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3353662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56964c34cf119783c47bc92fcffeac77?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3353662/daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1436399563, "creation_date": 1436399563, "answer_id": 31305819, "question_id": 31302628, "link": "https://stackoverflow.com/questions/31302628/c-changing-code-from-session-to-viewstate-causing-page-refresh/31305819#31305819", "title": "C#: Changing code from Session to ViewState causing page refresh", "body": "<p>Each User Control uses its own ViewState that later is merged with the page ViewState. Anyways, ViewState isn't a good option for big objects.</p>\n\n<p>You can try using this.Context.Item collection that it will be shared between your User Controls and your Page, but it will only hold the information in the same HTTP Request.</p>\n"}], "owner": {"reputation": 555, "user_id": 1319657, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/tYlyV.jpg?s=128&g=1", "display_name": "Mucida", "link": "https://stackoverflow.com/users/1319657/mucida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436399563, "creation_date": 1436385924, "question_id": 31302628, "link": "https://stackoverflow.com/questions/31302628/c-changing-code-from-session-to-viewstate-causing-page-refresh", "title": "C#: Changing code from Session to ViewState causing page refresh", "body": "<p>I have a page that contain some UserControls. Theses UC have some contents that are visible or not depending on where you click. \nThis page was using Sessions to retain data from database, like this:</p>\n\n<pre><code>private ViewPersonCollection collection\n    {\n        get\n        {\n            if (Session[\"ViewPersonCollection.test1\"] == null)\n                Session[\"ViewPersonCollection.test1\"] = new ViewPersonCollection ();\n            return (ViewPersonCollection )Session[\"ViewPersonCollection.test1\"];\n        }\n        set { Session[\"ViewPersonCollection.test1\"] = value; }\n    }\n</code></pre>\n\n<p>Since I was having some problems with session when clients were using different tabs at same browser, I changed it to view state, like this:</p>\n\n<pre><code>private ViewPersonCollection collection\n    {\n        get\n        {\n            if (ViewState[\"ViewPersonCollection.test1\"] == null)\n                ViewState[\"ViewPersonCollection.test1\"] = new ViewPersonCollection ();\n            return (ViewPersonCollection )ViewState[\"ViewPersonCollection.test1\"];\n        }\n        set { ViewState[\"ViewPersonCollection.test1\"] = value; }\n    }\n</code></pre>\n\n<p>but after this change, my page stopped loading the UserControls. If I click on a button, the page gets reloaded. I debugged it and the code is running ok, but for some reason the main page is being reloaded.</p>\n\n<p>What could be doing it?</p>\n"}, {"tags": ["javascript", "c#", "signalr"], "answers": [{"tags": [], "owner": {"reputation": 30145, "user_id": 1168070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e461ac690e034cb5b99cf011311c1c7?s=128&d=identicon&r=PG", "display_name": "Pawel", "link": "https://stackoverflow.com/users/1168070/pawel"}, "is_accepted": true, "score": 0, "last_activity_date": 1436400466, "creation_date": 1436400466, "answer_id": 31305970, "question_id": 31302605, "link": "https://stackoverflow.com/questions/31302605/signalr-incorrect-content-type-from-javascript-call/31305970#31305970", "title": "SignalR Incorrect Content-Type from javascript call", "body": "<p>Looks like you are using AspNet v5 - this is a <a href=\"https://github.com/aspnet/SignalR-Server/issues/70\" rel=\"nofollow\">bug</a>. The bug says it happens for long polling so it may work if you try a different transport.</p>\n"}], "owner": {"reputation": 49, "user_id": 4690855, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206456779368493/picture?type=large", "display_name": "Carlos Freire", "link": "https://stackoverflow.com/users/4690855/carlos-freire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 31305970, "answer_count": 1, "score": 0, "last_activity_date": 1436400466, "creation_date": 1436385845, "last_edit_date": 1436386033, "question_id": 31302605, "link": "https://stackoverflow.com/questions/31302605/signalr-incorrect-content-type-from-javascript-call", "title": "SignalR Incorrect Content-Type from javascript call", "body": "<p>When I make the call to SignalR (Cross-Domain) server from javascript fails the call telling Oops.</p>\n\n<blockquote>\n  <p>500 Internal Server Error System.InvalidOperationException Incorrect\n  Content-Type:  at\n  Microsoft.AspNet.Http.Features.Internal.FormFeature.d__12.MoveNext()\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task\n  task)  at\n  System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task\n  task)  at\n  System.Runtime.CompilerServices.ConfiguredTaskAwaitable.ConfiguredTaskAwaiter.GetResult()\n  at\n  Microsoft.AspNet.SignalR.TaskAwaiterHelper.PreserveCultureAwaiter.GetResult()\n  at\n  Microsoft.AspNet.SignalR.Transports.LongPollingTransport.d__28.MoveNext()\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task\n  task)  at\n  System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task\n  task)  at\n  System.Runtime.CompilerServices.ConfiguredTaskAwaitable.ConfiguredTaskAwaiter.GetResult()\n  at\n  Microsoft.AspNet.SignalR.TaskAwaiterHelper.PreserveCultureAwaiter.GetResult()\n  at\n  Microsoft.AspNet.SignalR.Transports.ForeverTransport.d__29.MoveNext()\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task\n  task)  at\n  System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task\n  task)  at\n  System.Runtime.CompilerServices.ConfiguredTaskAwaitable.ConfiguredTaskAwaiter.GetResult()\n  at\n  Microsoft.AspNet.SignalR.TaskAwaiterHelper.PreserveCultureAwaiter.GetResult()</p>\n</blockquote>\n\n\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"~/lib/jquery/jquery.signalr-2.0.3.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" src=\"~/lib/jquery/jquery.signalr.hubs.js\"&gt;&lt;/script&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n    $(function () {\n        /*SignalR*/\n        actividadSignalR = $.connection.Cross2BusinessHub;\n        if (actividadSignalR != undefined) {\n            actividadSignalR.on('RespuestaActividad', function (id) {\n                alert(\"Respuesta recibida\");\n            });\n        }\n        /**Fin SignalR*/\n        $('#table_@guid').customDataTable();\n\n        $('.pausarContinuarActividad').on('click', function (e) {\n\n            var controlEstadoActividad = $(this);\n            if (controlEstadoActividad.hasClass('disabled'))\n                return;\n            var estadoActividadDiv = controlEstadoActividad.parent().parent().parent().find('.estadoActividad');\n            var estadoActividad = estadoActividadDiv.html();\n            estadoActividadDiv.loading(2);\n            controlEstadoActividad.parent().find('a').addClass('disabled');\n\n            $.connection.hub.start({ transport: activeTransport, jsonp: true }, function () {\n                actividadSignalR.server.notificarCambioEstadoActividad(controlEstadoActividad.attr('data-identificacion'), controlEstadoActividad.attr('data-evento'))\n                    .done(function () {\n                        alert(\"Respuesta enviada\");\n                    }).fail(function () {\n                        notify('Informaci\u00f3n', 'No se puede pausar la actividad.', { hPos: 'center', showCloseOnHover: false });\n                        estadoActividadDiv.html(estadoActividad);\n                        controlEstadoActividad.parent().find('a').removeClass('disabled');\n                    });\n            });\n        });\n\n        $('.cancelarActividad').on('click', function (e) {\n\n        });\n    });\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["c#", "post", "get", "localhost"], "answers": [{"comments": [{"owner": {"reputation": 7953, "user_id": 226006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6a51ebf93e05e8a06b599ab0c205fb?s=128&d=identicon&r=PG", "display_name": "Jacob", "link": "https://stackoverflow.com/users/226006/jacob"}, "edited": false, "score": 1, "creation_date": 1436387463, "post_id": 31302880, "comment_id": 50596235, "body": "Correct answer - only other thing I&#39;d add is that they are closing the request before they have read it. You cannot resp.Close() before you have read the stream."}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436398047, "post_id": 31302880, "comment_id": 50600695, "body": "Thank you, Bhavo. I have amended the code as you suggested. It is now obvious that I was using this function incorrectly and calling it all wrong. Also, thank you and Jacob for catching that close() call I had there at the bottom. I was not even to the point of hitting that in the code because I was (and still am) getting this error: An unhandled exception of type &#39;System.Net.WebException&#39; occurred in System.dll  Additional information: The server committed a protocol violation. Section=ResponseStatusLine  I have googled this and found a few answers, but none of them worked...."}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436398116, "post_id": 31302880, "comment_id": 50600715, "body": "One of the solutions was the update the config file and do what appears as just sweeping the error under the rug and eating it globally. I&#39;d rather just fix whatever it is trying to tell me. Oh, and that error occurs on the System.Net.WebResponse resp = req.GetResponse(); line down near the end. Any ideas anyone?"}, {"owner": {"reputation": 2281, "user_id": 2778089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7OqZN.jpg?s=128&g=1", "display_name": "BhavO", "link": "https://stackoverflow.com/users/2778089/bhavo"}, "edited": false, "score": 0, "creation_date": 1436399023, "post_id": 31302880, "comment_id": 50600995, "body": "Is your service working, you can use fiddler to send a request to see if its ready to go."}, {"owner": {"reputation": 2281, "user_id": 2778089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7OqZN.jpg?s=128&g=1", "display_name": "BhavO", "link": "https://stackoverflow.com/users/2778089/bhavo"}, "edited": false, "score": 1, "creation_date": 1436399601, "post_id": 31302880, "comment_id": 50601161, "body": "Looks like your app isn&#39;t responding correctly, Response status isn&#39;t being set in response looks like, you can debug and look at the response detail being sent back, or use fiddler."}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436402584, "post_id": 31302880, "comment_id": 50601913, "body": "I just ran fiddler on it and it sends back the ID just fine. Man, this is so close. Any idea?"}, {"owner": {"reputation": 2281, "user_id": 2778089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7OqZN.jpg?s=128&g=1", "display_name": "BhavO", "link": "https://stackoverflow.com/users/2778089/bhavo"}, "edited": false, "score": 0, "creation_date": 1436402738, "post_id": 31302880, "comment_id": 50601943, "body": "What&#39;s the raw response look like in fiddler?, add to your question"}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "reply_to_user": {"reputation": 2281, "user_id": 2778089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7OqZN.jpg?s=128&g=1", "display_name": "BhavO", "link": "https://stackoverflow.com/users/2778089/bhavo"}, "edited": false, "score": 0, "creation_date": 1436404474, "post_id": 31302880, "comment_id": 50602367, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/82765/discussion-between-fujibob-and-bhavo\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2281, "user_id": 2778089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7OqZN.jpg?s=128&g=1", "display_name": "BhavO", "link": "https://stackoverflow.com/users/2778089/bhavo"}, "is_accepted": true, "score": 3, "last_activity_date": 1436387917, "last_edit_date": 1436387917, "creation_date": 1436386669, "answer_id": 31302880, "question_id": 31302540, "link": "https://stackoverflow.com/questions/31302540/post-to-my-localhost-on-port-5587/31302880#31302880", "title": "POST to my localhost on port 5587", "body": "<p>The query string parameters should be part of the uri string, and a message needs to be set in the request body</p>\n\n<p>Call it like this</p>\n\n<pre><code>string uuid = HttpPost(\"http://localhost:5587/send/?username=user&amp;password=pw&amp;to=destination&amp;bcc=bccDestination&amp;subject=messageSubject\", \"message=hi there\");\nConsole.WriteLine(uuid);\nConsole.ReadLine();\n</code></pre>\n\n<p>Change last two lines of HttpPost method to</p>\n\n<pre><code>string uuid = sr.ReadToEnd().Trim();\nresp.Close(); \nreturn uuid;\n</code></pre>\n\n<p>Of course you will need to change the parameters values to those that are valid</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436401466, "post_id": 31303268, "comment_id": 50601642, "body": "Thank you for this! I got it to work ALMOST. I changed the var request line to have &quot;message&quot; instead of &quot;messageBody&quot; but that was all. Coincidentally, though, I cannot get it to send a message along with the POST. I have a listener on my localhost 5587 so I can see what goes in and it simply does the POST and the header info but I never see the message= part in there anywhere. Any ideas?"}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436401734, "post_id": 31303268, "comment_id": 50601721, "body": "Here is a screen shot of my data that was picked up by this listening app: <a href=\"http://i.imgur.com/TvisIsL.png\" rel=\"nofollow noreferrer\">i.imgur.com/TvisIsL.png</a>    shouldn&#39;t the message= part have been there where the red arrow is?"}, {"owner": {"reputation": 176, "user_id": 724222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sg5sd.jpg?s=128&g=1", "display_name": "Carlitrosss", "link": "https://stackoverflow.com/users/724222/carlitrosss"}, "reply_to_user": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436401819, "post_id": 31303268, "comment_id": 50601744, "body": "can you share the code of your listener&#39;s endpoint? (e.g the <i>/save</i> method)"}, {"owner": {"reputation": 176, "user_id": 724222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sg5sd.jpg?s=128&g=1", "display_name": "Carlitrosss", "link": "https://stackoverflow.com/users/724222/carlitrosss"}, "reply_to_user": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436402014, "post_id": 31303268, "comment_id": 50601785, "body": "try changing <code>client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(&quot;application&#47;x-www-form-urle&zwnj;&#8203;ncoded&quot;));</code> to <code>client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(&quot;application&#47;xml&quot;));</code>"}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436402802, "post_id": 31303268, "comment_id": 50601959, "body": "The listener app is closed off and third party. I cannot get access to its code. But it does respond well to Fiddler."}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436402856, "post_id": 31303268, "comment_id": 50601977, "body": "I also tried changing that line and, although there are no errors, it still never sends the message= part over to the listener. The listener app, which is a message sending app, just sends messages with all the right data but with no message in them."}, {"owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "edited": false, "score": 0, "creation_date": 1436403810, "post_id": 31303268, "comment_id": 50602210, "body": "<a href=\"http://i.imgur.com/xls1qjr.png\" rel=\"nofollow noreferrer\">i.imgur.com/xls1qjr.png</a> There is a screen shot of what the output I need looks like versus the output that I am currently putting out."}], "tags": [], "owner": {"reputation": 176, "user_id": 724222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sg5sd.jpg?s=128&g=1", "display_name": "Carlitrosss", "link": "https://stackoverflow.com/users/724222/carlitrosss"}, "is_accepted": false, "score": 1, "last_activity_date": 1436388028, "creation_date": 1436388028, "answer_id": 31303268, "question_id": 31302540, "link": "https://stackoverflow.com/questions/31302540/post-to-my-localhost-on-port-5587/31303268#31303268", "title": "POST to my localhost on port 5587", "body": "<p>First, I'd like to say that <strong>HttpClient</strong> is much more efficient and simple than <strong>WebRequest</strong>.</p>\n\n<p>For this code to work with HttpClient, you'll need to:</p>\n\n<p>1.Add the NuGet package <strong>Microsoft.AspNet.WebApi.Client</strong> (Tools>NuGet Package manager>Manage NuGet packages for solution).</p>\n\n<p>2.Create Request and Response classes, such as:</p>\n\n<pre><code>    public class RequestClass\n    {\n        public string message { get; set; }\n    }\n\n    public class ResponseClass\n    {\n        public string UUID { get; set; }\n    }\n</code></pre>\n\n<p>Now, the method that does the POST request (using Generics and HttpClient):</p>\n\n<pre><code>    using System;\n    using System.Net.Http;\n    using System.Net.Http.Headers;\n\n    private static T PostData&lt;T, P&gt;(P postData, string uri, string path)\n    {\n        var ret = default(T);\n        try\n        {\n            using (var client = new HttpClient())\n            {\n                client.BaseAddress = new Uri(uri);\n                client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(\"application/x-www-form-urlencoded\"));\n\n                var response = client.PostAsXmlAsync(path, postData).Result;\n                //var response = client.PostAsJsonAsync(path, postData).Result; if your endpoint accepts json content\n                ret = response.Content.ReadAsAsync&lt;T&gt;().Result;\n            }\n        }\n        catch (Exception ex)\n        {\n            //Do something\n        }\n\n        return ret;\n    }\n</code></pre>\n\n<p>The usage of this method is simple:</p>\n\n<pre><code>        var request = new RequestClass {messageBody = \"Something\"};\n        var uri = \"http://localhost:5587\";\n        var path = \"/send?username=user&amp;password=pw&amp;to=destination&amp;bcc=bccDestination&amp;subject=messageSubject\";\n        var result = PostData&lt;ResponseClass, RequestClass&gt;(request, uri, path); //this will be of type ResponseClass which has the UUID property.\n</code></pre>\n\n<p>Keep in mind though, you need to know what content type does your endpoint support (json, xml,...) so you can specify it in the PostData() method.</p>\n"}], "owner": {"reputation": 115, "user_id": 1905320, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3dddb4fd65a33445359a504072eb27c1?s=128&d=identicon&r=PG&f=1", "display_name": "CodingIsSwell", "link": "https://stackoverflow.com/users/1905320/codingisswell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5045, "favorite_count": 0, "accepted_answer_id": 31302880, "answer_count": 2, "score": 0, "last_activity_date": 1436404135, "creation_date": 1436385604, "last_edit_date": 1436404135, "question_id": 31302540, "link": "https://stackoverflow.com/questions/31302540/post-to-my-localhost-on-port-5587", "title": "POST to my localhost on port 5587", "body": "<p>I want to be able to write code that interacts with an app running on my computer which is listening on port 5587. </p>\n\n<pre><code>static void Main(string[] args)\n{\n    HttpPost(\"http://localhost:5587\", \"/send/?username=testingname&amp;password=testingpw\");\n}\n\npublic static string HttpPost(string URI, string Parameters)\n{\n    System.Net.WebRequest req = System.Net.WebRequest.Create(URI);\n    req.Proxy = WebRequest.DefaultWebProxy;\n    //Add these, as we're doing a POST\n    req.ContentType = \"application/x-www-form-urlencoded\";\n    req.Method = \"POST\";\n    //We need to count how many bytes we're sending. Params should be name=value&amp;\n    byte[] bytes = System.Text.Encoding.ASCII.GetBytes(Parameters);\n    req.ContentLength = bytes.Length;\n    System.IO.Stream os = req.GetRequestStream();\n    os.Write(bytes, 0, bytes.Length); //Push it out there\n    os.Close();\n    System.Net.WebResponse resp = req.GetResponse();\n    if (resp == null) return null;\n    System.IO.StreamReader sr = new System.IO.StreamReader(resp.GetResponseStream());\n    resp.Close(); \n    return sr.ReadToEnd().Trim();\n}\n</code></pre>\n\n<p>When I read the specs on the app, it says:</p>\n\n<p>1) The POST <strong>request</strong> should be:</p>\n\n<blockquote>\n  <p><a href=\"http://HOST:PORT/send/\" rel=\"nofollow noreferrer\">http://HOST:PORT/send/</a>? \n         username=user&amp;\n         password=pw&amp; \n         to=destination&amp; \n         bcc=bccDestination&amp;\n         subject=messageSubject</p>\n</blockquote>\n\n<p>2) And also the POST <strong>data</strong> should be:</p>\n\n<blockquote>\n  <p>message=messageBody</p>\n</blockquote>\n\n<p>3) Also, this POST request returns a UUID of the message in the queue. This UUID is used later for checking the status of messages in the queue. </p>\n\n<p>How might I change this code to pull off the three things there that I need to do including getting a response back with an ID so I can save it for later?</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p><img src=\"https://i.stack.imgur.com/jFBZe.png\" alt=\"enter image description here\">There is a screen shot of what the output I need looks like versus the output that I am currently putting out.</p>\n"}, {"tags": ["c#", ".net", "fonts"], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 5010479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/ca077cd7e82d536680cb55da237620f2?s=128&d=identicon&r=PG&f=1", "display_name": "mark yer", "link": "https://stackoverflow.com/users/5010479/mark-yer"}, "edited": false, "score": 0, "creation_date": 1436386261, "post_id": 31302634, "comment_id": 50595516, "body": "I don&#39;t want to load the font but only from resources folder"}, {"owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "reply_to_user": {"reputation": 393, "user_id": 5010479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/ca077cd7e82d536680cb55da237620f2?s=128&d=identicon&r=PG&f=1", "display_name": "mark yer", "link": "https://stackoverflow.com/users/5010479/mark-yer"}, "edited": false, "score": 0, "creation_date": 1436386387, "post_id": 31302634, "comment_id": 50595605, "body": "ok, it loads font from resource folder and converts it to <code>Font</code>. then you can use it for <code>Label.Font</code>. :) is it clear?"}, {"owner": {"reputation": 393, "user_id": 5010479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/ca077cd7e82d536680cb55da237620f2?s=128&d=identicon&r=PG&f=1", "display_name": "mark yer", "link": "https://stackoverflow.com/users/5010479/mark-yer"}, "edited": false, "score": 0, "creation_date": 1436387080, "post_id": 31302634, "comment_id": 50596013, "body": "But what should i write inside &quot;yourfont.ttf&quot; ? just the font name ?"}, {"owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "reply_to_user": {"reputation": 393, "user_id": 5010479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/ca077cd7e82d536680cb55da237620f2?s=128&d=identicon&r=PG&f=1", "display_name": "mark yer", "link": "https://stackoverflow.com/users/5010479/mark-yer"}, "edited": false, "score": 0, "creation_date": 1436387276, "post_id": 31302634, "comment_id": 50596130, "body": "@markyer, you would write <code>MyNamespace.Properties.Resources.yourfont.ttf</code> :)."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1249792, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Dio2k.jpg?s=128&g=1", "display_name": "Ali Adlavaran", "link": "https://stackoverflow.com/users/1249792/ali-adlavaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1436386282, "last_edit_date": 1436386282, "creation_date": 1436385941, "answer_id": 31302634, "question_id": 31302500, "link": "https://stackoverflow.com/questions/31302500/byte-array-to-font-from-my-solution-resources-folder/31302634#31302634", "title": "Byte Array to font from my solution resources folder", "body": "<p>Try this function</p>\n\n<pre><code>private System.Drawing.Font GetFontFromResource()\n{\n Stream fontStream = this.GetType().Assembly.GetManifestResourceStream(\"yourfont.ttf\");\n\n      byte[] fontdata = new byte[fontStream.Length];\n      fontStream.Read(fontdata,0,(int)fontStream.Length);\n      fontStream.Close();\n      unsafe\n      {\n        fixed(byte * pFontData = fontdata)\n        {\n          return new  System.Drawing.Font((System.IntPtr)pFontData, 16, FontStyle.Regular);\n        }\n      }\n}\n</code></pre>\n\n<p>How load resource from assembly:(<code>YourNamespace.file.ttf</code>):\n<img src=\"https://i.stack.imgur.com/9rKGw.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 393, "user_id": 5010479, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/ca077cd7e82d536680cb55da237620f2?s=128&d=identicon&r=PG&f=1", "display_name": "mark yer", "link": "https://stackoverflow.com/users/5010479/mark-yer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1187, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1436386282, "creation_date": 1436385455, "question_id": 31302500, "link": "https://stackoverflow.com/questions/31302500/byte-array-to-font-from-my-solution-resources-folder", "title": "Byte Array to font from my solution resources folder", "body": "<p>I have Specific <code>Font</code> in my <code>resources</code> folder that i want to use.</p>\n\n<pre><code>Label label;\nlabel.FontFamily=MyNamespace.Properties.Resources.\n</code></pre>\n\n<p>I can see my <code>Font</code> name but this return <code>Byte[]</code>.\nHow can i use it as <code>Font</code> ?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 2, "creation_date": 1436385391, "post_id": 31302421, "comment_id": 50595067, "body": "Technically you have a static method and an extension method.  Yes I could see where they could be confusing."}, {"owner": {"reputation": 1071, "user_id": 3711660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tu0WU.jpg?s=128&g=1", "display_name": "Toumash", "link": "https://stackoverflow.com/users/3711660/toumash"}, "edited": false, "score": 3, "creation_date": 1436385411, "post_id": 31302421, "comment_id": 50595078, "body": "Not a good decision. Are you going to duplicate all of your classes methods? No, so be consistent :)   + Dont create extension methods for your classes that you own"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 2, "creation_date": 1436385422, "post_id": 31302421, "comment_id": 50595085, "body": "There&#39;s not a technically right or wrong answer; voting to close an opinion-based."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 2, "creation_date": 1436385481, "post_id": 31302421, "comment_id": 50595109, "body": "Agree with @Tournash - extension methods are to extend classes that <i>you don&#39;t own</i>.  If you want it to look like an instance method then <i>make it an instance method</i>."}, {"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1436385637, "post_id": 31302421, "comment_id": 50595190, "body": "Why is allowing that an advantage and not a disadvantage? Do you provide two different APIs for other features?"}, {"owner": {"reputation": 5311, "user_id": 1310846, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/JM0Y6.jpg?s=128&g=1", "display_name": "G.Y", "link": "https://stackoverflow.com/users/1310846/g-y"}, "edited": false, "score": 1, "creation_date": 1436385655, "post_id": 31302421, "comment_id": 50595201, "body": "It depends what you are trying to achieve exactly with that class, who will consume it and etc.. but technically I see no problem with the fact that you have a static method and an instance method of the same name. I would suggest that having an extension method to a class of your own is not a good practice as Tourmash already suggested. and as D Stanley noted - this tend to be opinion based discussion and therefore I will vote to close it as well - but u do get +1 since it is an interesting question :)"}, {"owner": {"reputation": 2208, "user_id": 571380, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/98tU0.jpg?s=128&g=1", "display_name": "Machtyn", "link": "https://stackoverflow.com/users/571380/machtyn"}, "edited": false, "score": 0, "creation_date": 1436386410, "post_id": 31302421, "comment_id": 50595615, "body": "Thank you, all. Feel free to close. It is more of an opinion discussion, isn&#39;t it.  You addressed my concern, though. Better to be consistent, no duplicating work.  And, I suppose, I can leave it static as it is not modifying anything in this object. (But I will read up on that topic as Microsoft (and others) have good explanations on that.)"}, {"owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "edited": false, "score": 0, "creation_date": 1436386513, "post_id": 31302421, "comment_id": 50595670, "body": "FYI: I find it interesting that this works."}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1436387479, "post_id": 31302421, "comment_id": 50596249, "body": "@Machtyn you can also make it non-static - then it would be called just like the extension method would.  There&#39;s no reason to make it static that I can see."}], "owner": {"reputation": 2208, "user_id": 571380, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/98tU0.jpg?s=128&g=1", "display_name": "Machtyn", "link": "https://stackoverflow.com/users/571380/machtyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "closed_date": 1436385946, "answer_count": 0, "score": 4, "last_activity_date": 1436387299, "creation_date": 1436385214, "last_edit_date": 1436387299, "question_id": 31302421, "link": "https://stackoverflow.com/questions/31302421/providing-a-similarly-named-static-and-non-static-method-in-c", "closed_reason": "Opinion-based", "title": "providing a similarly named static and non-static method in C#", "body": "<p>I apologize if this is a repeat. But I am wondering if it is wise in some situations to provide a method that has both a static and non-static version. (Non-static version provided through Extension.) I just created such a thing, but I'm wondering if I should have in the first place.</p>\n\n<p>Take the following as an example:</p>\n\n<pre><code>public class MyClass\n{\n    public Dictionary&lt;string, string&gt; Dict {get; private set;}\n\n    public MyClass(Dictionary&lt;string, string&gt; dict) { this.Dict = dict; }\n\n    public static DataTable CreateTable(MyClass data)\n    {\n        DataTable result = new DataTable();\n        foreach (string column in data.Dict.Keys)\n        {\n            result.Columns.Add(column, typeof(string));\n        }  \n        DataRow dr = result.NewRow();\n        foreach (string column in data.Dict.Keys)\n        {\n            dr[column] = data.Dict[column];\n        } \n        return result;\n    }  \n}\n\npublic static class MyClassExtension\n{\n    public static DataTable CreateTable(this MyClass data)\n    {\n        return MyClass.CreateTable(data);\n    }\n}\n</code></pre>\n\n<p>Doing this will allow person to use \n<code>MyClass.CreateTable(new MyClass(a dictionary object));</code> \nor </p>\n\n<pre><code>List&lt;MyClass&gt; cs = new List&lt;MyClass&gt;();\nDictionary&lt;string,string&gt; d;\nMyClass c;\n\nd = new Dictionary&lt;string,string&gt;() {{\"First Name\", \"John\"}, {\"Last Name\", \"Doe\"}, {\"ID\", \"123-1234-123\"}};\nc = new MyClass(d);\ncs.Add(c);\n\nd = new Dictionary&lt;string,string&gt;() {{\"First Name\", \"Jack\"}, {\"Last Name\", \"Mare\"}, {\"ID\", \"123-1234-124\"}};\nc = new MyClass(d);\ncs.Add(c);\n\nd = new Dictionary&lt;string,string&gt;() {{\"First Name\", \"Jill\"}, {\"Last Name\", \"Hen\"}, {\"ID\", \"123-1234-126\"}};\nc = new MyClass(d);\ncs.Add(c);\n\nDataTable dt = new DataTable();\nforeach (MyClass ct in cs)\n{\n    dt.Merge(ct.CreateDataTable(), false, MissingSchemaAction.Add);\n}\n</code></pre>\n\n<p>Obviously, my application of the class is slightly more complicated than this. Also, even though I have this set up as a Dictionary -> DataTable conversion, I suppose one could do a DataTable -> Dictionary conversion.  That's not the point of the question, though.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "web-config"], "comments": [{"owner": {"reputation": 13318, "user_id": 1221684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f83137a1e0ee44a266b26d2ff01bc4?s=128&d=identicon&r=PG", "display_name": "JamieD77", "link": "https://stackoverflow.com/users/1221684/jamied77"}, "edited": false, "score": 1, "creation_date": 1436385555, "post_id": 31302418, "comment_id": 50595145, "body": "sounds like a possible duplicate of this possible duplicate <a href=\"http://stackoverflow.com/questions/7471234/how-to-create-a-custom-section-that-behaves-like-an-appsettings-section\" title=\"how to create a custom section that behaves like an appsettings section\">stackoverflow.com/questions/7471234/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 63736, "user_id": 245860, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/11c56b07a08ba381090605a5904dc0e4?s=128&d=identicon&r=PG", "display_name": "Claudio Redi", "link": "https://stackoverflow.com/users/245860/claudio-redi"}, "is_accepted": true, "score": 1, "last_activity_date": 1534361323, "last_edit_date": 1534361323, "creation_date": 1436385638, "answer_id": 31302552, "question_id": 31302418, "link": "https://stackoverflow.com/questions/31302418/reading-values-from-web-config-file-in-asp-net/31302552#31302552", "title": "Reading Values from Web.config file in ASP.NET", "body": "<p>You should use <a href=\"https://msdn.microsoft.com/es-es/library/system.configuration.configurationmanager.getsection(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>ConfigurationManager.GetSection(String)</code></a></p>\n\n<pre><code>// Assuming 'service.settings' is on the root of your web.config...\nvar yourSection = (YourSectionClass)ConfigurationManager\n   .GetSection(\"service.settings\")\n</code></pre>\n"}], "owner": {"reputation": 12038, "user_id": 70192, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d43e340df1b55745a3e70e9f7e40461?s=128&d=identicon&r=PG", "display_name": "user70192", "link": "https://stackoverflow.com/users/70192/user70192"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 792, "favorite_count": 0, "accepted_answer_id": 31302552, "answer_count": 1, "score": 0, "last_activity_date": 1534361323, "creation_date": 1436385205, "question_id": 31302418, "link": "https://stackoverflow.com/questions/31302418/reading-values-from-web-config-file-in-asp-net", "title": "Reading Values from Web.config file in ASP.NET", "body": "<p>I have an ASP.NET MVC 5 app. My app has a web.config app. In this app, I have a custom section that looks like this:</p>\n\n<pre><code>&lt;service.settings&gt;\n  &lt;service1 isEnabled=\"true\" emailAddress=\"someone@somewhere.com\" /&gt;\n  &lt;service2 isEnabled=\"true\" emailAddress=\"another@address.com\" /&gt;\n  &lt;bonzai type=\"ficus\" age=\"13\" /&gt;\n&lt;/service.settings&gt;\n</code></pre>\n\n<p>My question is, how do I access these configuration values in my C# code? I'm familiar with <code>ConfigurationManager.AppSettings</code>. However, I'm not sure how to get configuration settings out of custom sections.</p>\n"}, {"tags": ["c#", "generics", "emgucv"], "answers": [{"comments": [{"owner": {"reputation": 8973, "user_id": 3367144, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LZ7Af.png?s=128&g=1", "display_name": "kdbanman", "link": "https://stackoverflow.com/users/3367144/kdbanman"}, "edited": false, "score": 0, "creation_date": 1436385359, "post_id": 31302442, "comment_id": 50595054, "body": "Do you mean <code>Image</code> must provide a parameterless constructor, or <code>TDepth</code>?"}, {"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "reply_to_user": {"reputation": 8973, "user_id": 3367144, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LZ7Af.png?s=128&g=1", "display_name": "kdbanman", "link": "https://stackoverflow.com/users/3367144/kdbanman"}, "edited": false, "score": 2, "creation_date": 1436385407, "post_id": 31302442, "comment_id": 50595076, "body": "<code>TDepth</code>.  I updated my answer to avoid any confusion :)"}], "tags": [], "owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "is_accepted": true, "score": 6, "last_activity_date": 1436385397, "last_edit_date": 1436385397, "creation_date": 1436385273, "answer_id": 31302442, "question_id": 31302408, "link": "https://stackoverflow.com/questions/31302408/what-does-it-mean-to-constrain-a-type-parameter-with-new/31302442#31302442", "title": "What does it mean to constrain a type parameter with `new()`?", "body": "<p>It doesn't.  All <code>new()</code> guarantees is that the generic type with the constraint (in this case <code>TDepth</code>) MUST provide a parameterless constructor and that it is not abstract, per the <a href=\"https://msdn.microsoft.com/en-us/library/sd2w2ew5.aspx\">documentation</a>.</p>\n"}], "owner": {"reputation": 8973, "user_id": 3367144, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/LZ7Af.png?s=128&g=1", "display_name": "kdbanman", "link": "https://stackoverflow.com/users/3367144/kdbanman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 31302442, "answer_count": 1, "score": 2, "last_activity_date": 1436385397, "creation_date": 1436385181, "question_id": 31302408, "link": "https://stackoverflow.com/questions/31302408/what-does-it-mean-to-constrain-a-type-parameter-with-new", "title": "What does it mean to constrain a type parameter with `new()`?", "body": "<p>Here is a class signature from the popular EmguCV package.  It's the <code>Image</code> class - not all of it is important:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// An Image is a wrapper to IplImage of OpenCV. \n/// &lt;/summary&gt;\n/// &lt;typeparam name=\"TColor\"&gt;Color type of this image (either Gray, Bgr, Bgra, Hsv, Hls, Lab, Luv, Xyz, Ycc, Rgb or Rbga)&lt;/typeparam&gt;\n/// &lt;typeparam name=\"TDepth\"&gt;Depth of this image (either Byte, SByte, Single, double, UInt16, Int16 or Int32)&lt;/typeparam&gt;\npublic partial class Image&lt;TColor, TDepth&gt;\n  : CvArray&lt;TDepth&gt;, IImage, IEquatable&lt;Image&lt;TColor, TDepth&gt;&gt;\n  where TColor : struct, IColor\n  where TDepth : new()\n</code></pre>\n\n<p>Specifically, note </p>\n\n<pre><code>  ...\n  where TDepth : new()  // &lt;-- either Byte, SByte, Single, double, UInt16, Int16 or Int32\n</code></pre>\n\n<p><strong>How does <code>new()</code> constrain the type parameter <code>TDepth</code> to the .NET integral types?</strong></p>\n"}, {"tags": ["c#", "xaml", "windows-phone-8.1", "window"], "owner": {"reputation": 31, "user_id": 5095586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe2a7ebc58c31595bbec1defb8eb0b41?s=128&d=identicon&r=PG&f=1", "display_name": "Om narayan", "link": "https://stackoverflow.com/users/5095586/om-narayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1436385114, "creation_date": 1436385114, "question_id": 31302396, "link": "https://stackoverflow.com/questions/31302396/want-to-add-multiple-contact-for-sharing-information-in-windows-phone-8-1-app-de", "title": "Want to add multiple contact for sharing information in windows phone 8.1 app developement", "body": "<p>I am very new in windows phone application development.\nI am developing contact sharing app in which once a user clicks on Contact Push  radio button as mentioned in the below :</p>\n\n<pre>\n            \n            SMS\n            Bluetooth\n            Email\n            Contact Push\n            Button x:Name=\"sendContact_Btn\"  Margin=\"20\" HorizontalAlignment=\"Center\" Content=\"Send\" Height=\"65\" Width=\"160\" VerticalAlignment=\"Top\" Click=\"sendContact_Btn_Click\"  />\n        \n</pre>\n\n<p>A popup box should be open in which I am able to add multiple number to whom I want to send the information.</p>\n\n<p>Platform - WIndows phone 8.1\nXAML and C#</p>\n\n<p>Can you please someone help me how to create a popup layout having contact details information.</p>\n"}, {"tags": ["c#", "azure", "servicebus"], "answers": [{"tags": [], "owner": {"reputation": 1484, "user_id": 82812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab4cf131857f3496224ac57b3948c5f1?s=128&d=identicon&r=PG", "display_name": "Jerry Federspiel", "link": "https://stackoverflow.com/users/82812/jerry-federspiel"}, "is_accepted": false, "score": 5, "last_activity_date": 1436385250, "last_edit_date": 1436385250, "creation_date": 1436385155, "answer_id": 31302402, "question_id": 31302356, "link": "https://stackoverflow.com/questions/31302356/how-to-put-generic-type-t-as-parameter/31302402#31302402", "title": "How to put generic Type (T) as parameter?", "body": "<pre><code>public static void SendMessage&lt;T&gt;(string queuName, T objeto)\n{\n    QueueClient Client =QueueClient.CreateFromConnectionString(connectionString, \"Empresa\");\n    BrokeredMessage message = new BrokeredMessage(objeto);\n    message.ContentType = objeto.GetType().Name;\n    Client.Send(new BrokeredMessage(message));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11824, "user_id": 3107430, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/55fDR.jpg?s=128&g=1", "display_name": "Domysee", "link": "https://stackoverflow.com/users/3107430/domysee"}, "is_accepted": true, "score": 3, "last_activity_date": 1436385503, "creation_date": 1436385503, "answer_id": 31302513, "question_id": 31302356, "link": "https://stackoverflow.com/questions/31302356/how-to-put-generic-type-t-as-parameter/31302513#31302513", "title": "How to put generic Type (T) as parameter?", "body": "<p>You forgot to specify the type parameter.\nYou can do that in 2 ways:</p>\n\n<p>Either you define them at the method definition (which is the way to go in your case, because your method is static):</p>\n\n<p><code>public static void SendMessage&lt;T&gt;(string queuName, T objeto)</code></p>\n\n<p>Or you can specify them on the class definition (for instance methods):</p>\n\n<pre><code>class MyClass&lt;T&gt;{\n    public void SendMessage(string queuName, T objeto){}\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2064, "user_id": 2013192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f61664c28be6e3faeb34d1ba67c043e2?s=128&d=identicon&r=PG", "display_name": "honzakuzel1989", "link": "https://stackoverflow.com/users/2013192/honzakuzel1989"}, "is_accepted": false, "score": 1, "last_activity_date": 1436386191, "creation_date": 1436386191, "answer_id": 31302727, "question_id": 31302356, "link": "https://stackoverflow.com/questions/31302356/how-to-put-generic-type-t-as-parameter/31302727#31302727", "title": "How to put generic Type (T) as parameter?", "body": "<p>The correct syntax for your example is:</p>\n\n<pre><code>public static void SendMessage&lt;T&gt;(string queuName, T objeto)\n{\n// Type of T is\nType t = typeof(T);\n// Obtain Name\nstring name = t.Name\n// Create another instance of T\nobject to = Activator.CreateInstance&lt;T&gt;();\n// etc.\n}\n</code></pre>\n\n<p>In general:</p>\n\n<pre><code>T method&lt;T&gt;(T param) where T: restrictions //new() for example\n{ return (T)Activator.CreateInstance&lt;T&gt;(); }\n</code></pre>\n"}], "owner": {"reputation": 26702, "user_id": 1014217, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6zW1x.jpg?s=128&g=1", "display_name": "Luis Valencia", "link": "https://stackoverflow.com/users/1014217/luis-valencia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 31302513, "answer_count": 3, "score": 0, "last_activity_date": 1436386191, "creation_date": 1436384992, "question_id": 31302356, "link": "https://stackoverflow.com/questions/31302356/how-to-put-generic-type-t-as-parameter", "title": "How to put generic Type (T) as parameter?", "body": "<p>I have this error:</p>\n\n<pre><code>Severity    Code    Description Project File    Line\nError   CS0246  The type or namespace name 'T' could not be found (are you missing a using directive or an assembly reference?) \n</code></pre>\n\n<p>on the method signature for this method:</p>\n\n<pre><code> public static void SendMessage(string queuName, T objeto)\n        {\n            QueueClient Client =QueueClient.CreateFromConnectionString(connectionString, \"Empresa\");\n            BrokeredMessage message = new BrokeredMessage(objeto);\n            message.ContentType = objeto.GetType().Name;\n            Client.Send(new BrokeredMessage(message));\n        }\n</code></pre>\n"}, {"tags": ["c#", "entity-framework", "linq-to-entities", "entity-framework-6"], "answers": [{"comments": [{"owner": {"reputation": 1328, "user_id": 261549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db16644a1be56fd92e1d9809ebb5cf0?s=128&d=identicon&r=PG", "display_name": "Chorinator", "link": "https://stackoverflow.com/users/261549/chorinator"}, "edited": false, "score": 0, "creation_date": 1436392692, "post_id": 31304233, "comment_id": 50598804, "body": "Thank you sir. It worked perfectly. You helped me refactor tons of repeated code."}, {"owner": {"reputation": 23953, "user_id": 469533, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/CQueM.jpg?s=128&g=1", "display_name": "Aducci", "link": "https://stackoverflow.com/users/469533/aducci"}, "reply_to_user": {"reputation": 1328, "user_id": 261549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db16644a1be56fd92e1d9809ebb5cf0?s=128&d=identicon&r=PG", "display_name": "Chorinator", "link": "https://stackoverflow.com/users/261549/chorinator"}, "edited": false, "score": 0, "creation_date": 1436392735, "post_id": 31304233, "comment_id": 50598828, "body": "@Chorinator - I am glad I could help!"}, {"owner": {"reputation": 1328, "user_id": 261549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db16644a1be56fd92e1d9809ebb5cf0?s=128&d=identicon&r=PG", "display_name": "Chorinator", "link": "https://stackoverflow.com/users/261549/chorinator"}, "edited": false, "score": 0, "creation_date": 1436402901, "post_id": 31304233, "comment_id": 50601988, "body": "What about dates. Is there a way to truncate the time part on the database part so I end up comparing only dates? I&#39;ve tried using Convert and Cast but I get an exception saying that those functions don&#39;t exist on System.Date"}, {"owner": {"reputation": 23953, "user_id": 469533, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/CQueM.jpg?s=128&g=1", "display_name": "Aducci", "link": "https://stackoverflow.com/users/469533/aducci"}, "reply_to_user": {"reputation": 1328, "user_id": 261549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db16644a1be56fd92e1d9809ebb5cf0?s=128&d=identicon&r=PG", "display_name": "Chorinator", "link": "https://stackoverflow.com/users/261549/chorinator"}, "edited": false, "score": 0, "creation_date": 1436415069, "post_id": 31304233, "comment_id": 50604924, "body": "@Chorinator - I believe there is a way, but ask another question"}, {"owner": {"reputation": 1328, "user_id": 261549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db16644a1be56fd92e1d9809ebb5cf0?s=128&d=identicon&r=PG", "display_name": "Chorinator", "link": "https://stackoverflow.com/users/261549/chorinator"}, "edited": false, "score": 0, "creation_date": 1436459145, "post_id": 31304233, "comment_id": 50632828, "body": "I&#39;ve found a way to do it, based on this post <a href=\"http://stackoverflow.com/a/1759993/261549\">stackoverflow.com/a/1759993/261549</a>"}], "tags": [], "owner": {"reputation": 23953, "user_id": 469533, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/CQueM.jpg?s=128&g=1", "display_name": "Aducci", "link": "https://stackoverflow.com/users/469533/aducci"}, "is_accepted": true, "score": 7, "last_activity_date": 1436391340, "creation_date": 1436391340, "answer_id": 31304233, "question_id": 31302196, "link": "https://stackoverflow.com/questions/31302196/dynamically-select-column-name-using-linq-to-entities-ef6/31304233#31304233", "title": "Dynamically select column name using Linq to Entities (EF6)", "body": "<p>You can dynamically create a <code>Expression&lt;Func&lt;T, bool&gt;&gt;</code> using the <a href=\"https://msdn.microsoft.com/en-us/library/system.linq.expressions.expression(v=vs.110).aspx\" rel=\"noreferrer\">Expression</a> class like this:</p>\n\n<pre><code>protected override IQueryable&lt;T&gt; Execute&lt;T&gt;(IQueryable&lt;T&gt; original, string propertyName)\n{\n   var parameter = Expression.Parameter(typeof(T));\n   var property = Expression.PropertyOrField(parameter, propertyName);\n   var constant = Expression.Constant(Name);\n\n   Expression predicate;\n   if(RequestExactMatch())  \n   {     \n      predicate = Expression.Equal(property, constant);    \n   }\n   else \n   {\n      predicate = Expression.Call(property, \"Contains\", null, constant);    \n   }\n\n   var lambda = Expression.Lambda&lt;Func&lt;T, bool&gt;&gt;(predicate, parameter);\n\n   return original.Where(lambda);\n}\n</code></pre>\n"}], "owner": {"reputation": 1328, "user_id": 261549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2db16644a1be56fd92e1d9809ebb5cf0?s=128&d=identicon&r=PG", "display_name": "Chorinator", "link": "https://stackoverflow.com/users/261549/chorinator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2469, "favorite_count": 2, "accepted_answer_id": 31304233, "answer_count": 1, "score": 3, "last_activity_date": 1436391340, "creation_date": 1436384452, "last_edit_date": 1436388999, "question_id": 31302196, "link": "https://stackoverflow.com/questions/31302196/dynamically-select-column-name-using-linq-to-entities-ef6", "title": "Dynamically select column name using Linq to Entities (EF6)", "body": "<p>I want to encapsulate common scenarios when using EF6.\nHere's an example:</p>\n\n<pre><code>   public class StringRequest : DbRequestProperty\n   {\n      public string Name { get; set; }\n      public bool? ExactMatch { get; set; }\n\n      protected override bool IsValid()\n      {\n         return !string.IsNullOrWhiteSpace(Name);\n      }\n\n      private bool RequestExactMatch()\n      {\n         return ExactMatch.HasValue &amp;&amp; ExactMatch.Value;\n      }\n\n      protected override IQueryable&lt;T&gt; Execute&lt;T&gt;(IQueryable&lt;T&gt; original, string propertyName)\n      {\n         return RequestExactMatch()\n            ? original.Where(o =&gt; GetProperty&lt;string&gt;(o, propertyName) == Name)\n            : original.Where(o =&gt; GetProperty&lt;string&gt;(o, propertyName).Contains(Name));\n      }\n   }\n</code></pre>\n\n<p>But GetProperty can't be converted to a query.\nSo I'm thinking on selecting dynamically the column using \"propertyName\".</p>\n\n<pre><code>  protected override IQueryable&lt;T&gt; Execute&lt;T&gt;(IQueryable&lt;T&gt; original, string propertyName)\n  {\n     return RequestExactMatch()\n        ? original.Where(o =&gt; GetColumnByName&lt;string&gt;(propertyName) == Name)\n        : original.Where(o =&gt; GetColumnByName&lt;string&gt;(propertyName).Contains(Name));\n  }\n</code></pre>\n\n<p>Is this possible?\nThanks in advance.</p>\n"}, {"tags": ["c#", "drop-down-menu", "keyvaluepair"], "comments": [{"owner": {"reputation": 652, "user_id": 1856992, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eed63f2945cf3d8f6611e856fc36c674?s=128&d=identicon&r=PG", "display_name": "thinklarge", "link": "https://stackoverflow.com/users/1856992/thinklarge"}, "edited": false, "score": 0, "creation_date": 1436384712, "post_id": 31302162, "comment_id": 50594643, "body": "Are these KeyValuePairs coming from a list?  Can you modify the list before it becomes a DataSource or are you stuck with a DataSource that is in this format?"}, {"owner": {"reputation": 21, "user_id": 5095542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68d8a502356e0880b093115882fdc0de?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/5095542/anand"}, "reply_to_user": {"reputation": 652, "user_id": 1856992, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/eed63f2945cf3d8f6611e856fc36c674?s=128&d=identicon&r=PG", "display_name": "thinklarge", "link": "https://stackoverflow.com/users/1856992/thinklarge"}, "edited": false, "score": 0, "creation_date": 1436387953, "post_id": 31302162, "comment_id": 50596492, "body": "- Are these KeyValuePairs coming from a list? These KeyValuePairs are being created at runtime.  I am stuck with the DataSource which is of the format KeyValuePair&lt;string, KeyValuePair&lt;string,string&gt;&gt;.  And more importantly, I cant give up the KeyValuePair type for the dropdown. :("}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5095542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68d8a502356e0880b093115882fdc0de?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/5095542/anand"}, "edited": false, "score": 0, "creation_date": 1436388689, "post_id": 31303304, "comment_id": 50596869, "body": "I am already trying to make use of the NameValuePair which is provided by the CSLA framework. Any suggestions on this front ? I would not want to move out of the CSLA framework as I am using some default operation provided by CSLA."}, {"owner": {"reputation": 110, "user_id": 1361939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c97rz.jpg?s=128&g=1", "display_name": "Russ Wilson", "link": "https://stackoverflow.com/users/1361939/russ-wilson"}, "reply_to_user": {"reputation": 21, "user_id": 5095542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68d8a502356e0880b093115882fdc0de?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/5095542/anand"}, "edited": false, "score": 0, "creation_date": 1436389584, "post_id": 31303304, "comment_id": 50597304, "body": "Unfortunately, I don&#39;t have experience with CLSA or the NameValuePair class, but my quick research tells me that it&#39;s just a non-generic class.  However, you would STILL need a wrapper, given the fact that the &quot;Value&quot;  property of the NameValuePair object would be a nested property."}], "tags": [], "owner": {"reputation": 110, "user_id": 1361939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c97rz.jpg?s=128&g=1", "display_name": "Russ Wilson", "link": "https://stackoverflow.com/users/1361939/russ-wilson"}, "is_accepted": false, "score": 1, "last_activity_date": 1436388141, "creation_date": 1436388141, "answer_id": 31303304, "question_id": 31302162, "link": "https://stackoverflow.com/questions/31302162/c-nested-keyvaluepairs-for-a-dropdown-list/31303304#31303304", "title": "C# - Nested KeyValuePairs for a dropdown list", "body": "<p>Unfortunately, you can't bind to nested properties using <code>DisplayMember</code>.  So, trying to set <code>DisplayMember</code> to something like <code>\"Value.Key\"</code> doesn't work.  However, I would suggest making a custom type that wraps your <code>KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;&gt;</code> type into one object and give it properties that can be easily accessed.  Here's an example:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    public Form1()\n    {\n        InitializeComponent();\n\n        // This was the old way \n        //List&lt;KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;&gt; myList = new List&lt;KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;&gt;();\n\n        //myList.Add(new KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;(\"A\", new KeyValuePair&lt;string, string&gt;(\"B\", \"C\")));\n        //myList.Add(new KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;(\"D\", new KeyValuePair&lt;string, string&gt;(\"E\", \"F\")));\n        //myList.Add(new KeyValuePair&lt;string, KeyValuePair&lt;string, string&gt;&gt;(\"G\", new KeyValuePair&lt;string, string&gt;(\"H\", \"I\")));\n\n        // This is the new way\n        List&lt;CustomKeyValuePairWrapper&gt; myList = new List&lt;CustomKeyValuePairWrapper&gt;();\n        myList.Add(new CustomKeyValuePairWrapper(\"A\", new KeyValuePair&lt;string, string&gt;(\"B\", \"C\")));\n        myList.Add(new CustomKeyValuePairWrapper(\"D\", new KeyValuePair&lt;string, string&gt;(\"E\", \"F\")));\n        myList.Add(new CustomKeyValuePairWrapper(\"G\", new KeyValuePair&lt;string, string&gt;(\"H\", \"I\")));\n\n        comboBox1.DataSource = myList;\n        comboBox1.DisplayMember = \"ValueKey\";\n    }\n}\n\npublic class CustomKeyValuePairWrapper\n{\n\n    public string Key { get; private set; }\n\n    public KeyValuePair&lt;string, string&gt; Value { get; private set; }\n\n    public string ValueKey\n    {\n        get { return Value.Key; }\n    }\n\n    public CustomKeyValuePairWrapper(string key, KeyValuePair&lt;string, string&gt; value)\n    {\n        Key = key;\n        Value = value;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 858, "user_id": 2364774, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IQ3Uc.jpg?s=128&g=1", "display_name": "Elton Garcia de Santana", "link": "https://stackoverflow.com/users/2364774/elton-garcia-de-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1436388557, "creation_date": 1436388557, "answer_id": 31303437, "question_id": 31302162, "link": "https://stackoverflow.com/questions/31302162/c-nested-keyvaluepairs-for-a-dropdown-list/31303437#31303437", "title": "C# - Nested KeyValuePairs for a dropdown list", "body": "<p>Try the following:</p>\n\n<pre><code>public class CustomKeyValuePair\n{\n    public CustomKeyValuePair(string key, string value)\n    {\n        this.Key = key;\n        this.Value = value;\n    }\n    public string Key { get; set; }\n    public string Value { get; set; }\n    public override string ToString()\n    {\n        return Key;\n    }\n}\n\nKeyValuePair&lt;'string',KeyValuePair&lt;'string',CustomKeyValuePair&gt;('A', new CustomKeyValuePair('B','C'))\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5095542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68d8a502356e0880b093115882fdc0de?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/5095542/anand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1441046949, "creation_date": 1436384343, "last_edit_date": 1441046949, "question_id": 31302162, "link": "https://stackoverflow.com/questions/31302162/c-nested-keyvaluepairs-for-a-dropdown-list", "title": "C# - Nested KeyValuePairs for a dropdown list", "body": "<p>I have a dropdown control placed on a winform. Today the datasource for this dropdown is KeyValuePair&lt;'string','string'> and hence it is easy to directly assign the 'DisplayMember' property of the dropdown to 'Value' from the KeyValuePair.</p>\n\n<p>One of my requirements has caused this datasource to be changed to KeyValuePair&lt;'string', KeyValuePair&lt;'string','string'>. This poses problems for me when I run my code. Thats because 'DisplayMember' being set to 'Value' causes the dropdown item to be shown as ('AB') (where 'A' and 'B' are the respective strings in KeyValuePair&lt;'string','string'> of the new datasource).</p>\n\n<p>I want to assign the 'DisplayMember' property of the dropdown to the 'Key' in the KeyValuePair&lt;'string','string'> from the changed datasource.</p>\n\n<p>Old requirement - </p>\n\n<pre><code>KeyValuePair&lt;'string','string'&gt;('A','B')\n</code></pre>\n\n<p>Dropdown item shows - 'B'</p>\n\n<p>New requirement -</p>\n\n<pre><code>KeyValuePair&lt;'string',KeyValuePair&lt;'string','string'&gt;('A', new KeyValuePair&lt;'B','C'&gt;)\n</code></pre>\n\n<p>Dropdown item should show - 'B'</p>\n\n<p>Is it possible to do implement with only change in dropdowns properties?</p>\n\n<p>Have checked the datasource but it only shows me the top level of Key-Value pair and not the hierarchical model.</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "angularjs"], "owner": {"reputation": 43, "user_id": 3096390, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/oKfiw.jpg?s=128&g=1", "display_name": "a.amin", "link": "https://stackoverflow.com/users/3096390/a-amin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1531399277, "creation_date": 1436384219, "last_edit_date": 1531399277, "question_id": 31302120, "link": "https://stackoverflow.com/questions/31302120/mvc-dropdownlist-dont-select-item-with-value-pass-from-ng-model-hope-get-repl", "title": "MVC dropdownlist don&#39;t select item with value pass from ng-model - hope get reply?", "body": "<p>I'm trying to edit data though angularjs and I've got all the data in view - but the only problem is that the dropdownlist does not select the value that is passed to it and I don't know why.</p>\n\n<p>JS Code:</p>\n\n<pre><code>function getCustomer() {\n    var promiseGetStudent = SPACRUDService.getCustomer(ShareData.value);\n\n    promiseGetStudent.then(function (pl) {\n        pl.data.MirageDate = $filter('date')(pl.data.MirageDate, 'yyyy-MM-dd');\n        $scope.Cust = pl.data;\n    },\n          function (errorPl) {\n              $scope.error = 'failure loading Student', errorPl;\n          });\n}\n</code></pre>\n\n<p>HTML Code:</p>\n\n<pre><code>&lt;table class=\"table\"&gt;\n                &lt;td style=\"width:200px; text-align:center; vertical-align:central\"&gt;\u0625\u0633\u0645 \u0627\u0644\u0639\u0645\u064a\u0644&lt;/td&gt;\n                &lt;td&gt;\n                    &lt;table class=\"table\" style=\"margin-bottom: -3px;\"&gt;\n                        &lt;tr&gt;\n                            &lt;td style=\"padding:0; vertical-align:central; width:50%;\"&gt;\n                                &lt;div class=\"input-group\"&gt;\n                                    &lt;span class=\"input-group-addon ion ion-person\"&gt;&lt;/span&gt;\n                                    &lt;input type=\"text\" class=\"form-control\" placeholder=\"\u0625\u0633\u0645 \u0627\u0644\u0639\u0645\u064a\u0644\" ng-model=\"Cust.CustomerName\"&gt;\n                                &lt;/div&gt;\n                            &lt;/td&gt;\n                            &lt;td style=\"width:125px; vertical-align:central\" class=\"text-center\"&gt;\u0627\u0644\u0645\u062f\u064a\u0646\u0629&lt;/td&gt;\n                            &lt;td style=\"padding:0; vertical-align:central\"&gt;\n                                &lt;input type=\"text\" ng-model=\"Cust.CityID\" name=\"cid\" id=\"cid\" /&gt;\n                                @Html.DropDownList(\"CityID\", null, \"\u0625\u062e\u062a\u0631 \u0627\u0644\u0645\u062f\u064a\u0646\u0629\", htmlAttributes: new { @class = \"form-control\", @style = \"width=100%\", @ng_model = \"Cust.CityID\" })\n                            &lt;/td&gt;\n                        &lt;/tr&gt;\n                    &lt;/table&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/table&gt;\n</code></pre>\n\n<p>I get the value of \"CityID\" but the dropdownlist does not select it from the items, and when I look into html of the dropdownlist I found:</p>\n\n<pre><code>&lt;option value=\"? number:2 ?\"&gt;&lt;/option&gt;\n</code></pre>\n\n<p>So please what is the problem here and how can I make it work?</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 4, "creation_date": 1436384384, "post_id": 31302106, "comment_id": 50594426, "body": "If BookingBusiness is not a static class, you need an instance of it (i.e. do a <code>new BookingBusiness()</code> somewhere) and use that instance for the <code>UpdateBooking</code> method. You cannot call classes magically like that, unless they&#39;re static."}, {"owner": {"reputation": 2624, "user_id": 403404, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/H9F8d.jpg?s=128&g=1", "display_name": "Johnie Karr", "link": "https://stackoverflow.com/users/403404/johnie-karr"}, "reply_to_user": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 0, "creation_date": 1436384463, "post_id": 31302106, "comment_id": 50594477, "body": "@Pierre-LucPineault ... looks like an answer :)"}, {"owner": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "reply_to_user": {"reputation": 2624, "user_id": 403404, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/H9F8d.jpg?s=128&g=1", "display_name": "Johnie Karr", "link": "https://stackoverflow.com/users/403404/johnie-karr"}, "edited": false, "score": 2, "creation_date": 1436384493, "post_id": 31302106, "comment_id": 50594501, "body": "@JohnieKarr Looks like a duplicate, I&#39;ll flag it instead."}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 0, "creation_date": 1436384658, "post_id": 31302106, "comment_id": 50594609, "body": "<code>An object reference is required for the non-static field, method, or property</code> the error is pretty explicit and means exactly what it says. <code>UpdateBooking</code> is an <i>instance</i> method and so you need an <i>instance</i> of <code>BookingBusiness</code> to call it. Now since your method doesn&#39;t appear to actually touch any members of the <code>BookingBusiness</code> class at all, you could just mark it static. If you whole class is like that, then probably the class should be static. Also note, if you make the a method static, it won&#39;t be able to call other instance methods either unless you give it an instance to work with."}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "reply_to_user": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 0, "creation_date": 1436384766, "post_id": 31302106, "comment_id": 50594677, "body": "@Pierre-LucPineault: The class doesn&#39;t <i>have</i> to be static. You could just make that method static since it doesn&#39;t seem to be accessing any variables outside it&#39;s own scope."}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 0, "creation_date": 1436384843, "post_id": 31302106, "comment_id": 50594724, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/2505181/error-an-object-reference-is-required-for-the-non-static-field-method-or-prop\">Error: &quot;an object reference is required for the non-static field, method or property...&quot;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4693041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f616a158bde4f96e0dabe869313aee73?s=128&d=identicon&r=PG&f=1", "display_name": "minenhle", "link": "https://stackoverflow.com/users/4693041/minenhle"}, "edited": false, "score": 0, "creation_date": 1436386311, "post_id": 31302415, "comment_id": 50595554, "body": "thank you for pointing that out.i actually had instantiated an object of type bookingbusiness but i then forgot to use it to call my updatebooking method and used my bookingbusiness clss directly which is wrong.the help is appreciated"}, {"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "reply_to_user": {"reputation": 57, "user_id": 4693041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f616a158bde4f96e0dabe869313aee73?s=128&d=identicon&r=PG&f=1", "display_name": "minenhle", "link": "https://stackoverflow.com/users/4693041/minenhle"}, "edited": false, "score": 0, "creation_date": 1436387565, "post_id": 31302415, "comment_id": 50596306, "body": "@minenhle, glad I could help. It&#39;s always funny when our issues are caused by such small mistakes :)"}, {"owner": {"reputation": 10220, "user_id": 70104, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/859c44ae8a94cf8def8a9728369fcd2e?s=128&d=identicon&r=PG", "display_name": "Chris Dunaway", "link": "https://stackoverflow.com/users/70104/chris-dunaway"}, "edited": false, "score": 0, "creation_date": 1436391118, "post_id": 31302415, "comment_id": 50598065, "body": "@DangerZone - It&#39;s not always funny!  Sometimes it&#39;s downright maddening!  :P"}, {"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "reply_to_user": {"reputation": 10220, "user_id": 70104, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/859c44ae8a94cf8def8a9728369fcd2e?s=128&d=identicon&r=PG", "display_name": "Chris Dunaway", "link": "https://stackoverflow.com/users/70104/chris-dunaway"}, "edited": false, "score": 0, "creation_date": 1436391359, "post_id": 31302415, "comment_id": 50598170, "body": "@ChrisDunaway, very true! At least this one gave an error. Can&#39;t tell you how many programs I&#39;ve wasted hours on because I did something stupid like <code>myClass.ToString();</code> and expecting console output or <code>someString.Replace(&quot;X&quot;,&quot;O&quot;);</code> and expecting a different string from <code>someString</code> much later!"}], "tags": [], "owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "is_accepted": false, "score": 0, "last_activity_date": 1436385193, "creation_date": 1436385193, "answer_id": 31302415, "question_id": 31302106, "link": "https://stackoverflow.com/questions/31302106/an-object-reference-is-required-for-the-non-static-field-method-or-property/31302415#31302415", "title": "An object reference is required for the non-static field, method, or property", "body": "<p>To use your <code>UpdateBooking</code> method, either your <code>BookingBusiness</code> class or <code>UpdateBooking</code> method must be static (you won't refer to individual instance objects) OR you must instantiate an object of type <code>BookingBusiness</code> like so (obviously depending on how you intend on implementing these):  </p>\n\n<pre><code>BookingBusiness yourObject = new BookingBusiness(/*constructor args*/);  \n</code></pre>\n\n<p>Then you can call your method via <code>yourObject.UpdateBooking(model);</code></p>\n"}], "owner": {"reputation": 57, "user_id": 4693041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f616a158bde4f96e0dabe869313aee73?s=128&d=identicon&r=PG&f=1", "display_name": "minenhle", "link": "https://stackoverflow.com/users/4693041/minenhle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1284, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1436385193, "creation_date": 1436384182, "question_id": 31302106, "link": "https://stackoverflow.com/questions/31302106/an-object-reference-is-required-for-the-non-static-field-method-or-property", "title": "An object reference is required for the non-static field, method, or property", "body": "<p>ive looked at duplicate errors like this but i havent found a solution</p>\n\n<p>here is my method im implementing in the business logic</p>\n\n<pre><code>  public  void UpdateBooking(BookingView model)\n    {\n        using (var booking = new BookingRepository())\n        {\n            var user = new ApplicationUser();\n            Booking book = booking.GetById(model.BookingId);\n\n            if (book != null)\n            {\n\n                book.BookingId = model.BookingId;\n                book.BookingDate = model.BookingDate;\n                book.BookingTime = model.BookingTime;\n                book.Location = model.Location;\n                //book.Status = DefaultStatus();\n                //book.TreatmentName = book.TreatmentName;\n                //book.AddInfo = model.AddInfo;\n\n                booking.Update(book);\n            }\n        }\n    }\n</code></pre>\n\n<p>but my error is on my booking controller method</p>\n\n<pre><code> [HttpPost]\n    [ValidateAntiForgeryToken]\n    public ActionResult postponeBooking([Bind(Include = \"location,BookingDate,BookingTime\")]BookingView model)\n    {\n\n        if (ModelState.IsValid)\n        {\n\n            BookingBusiness.UpdateBooking(model);\n\n        }\n        return RedirectToAction(\"BookingDetails\", TempData[\"alertMessage\"] = \"&lt;script&gt; alert('Booking details saved!!');&lt;/script&gt;\");\n    }\n</code></pre>\n\n<p>exactly on this line</p>\n\n<pre><code>            BookingBusiness.UpdateBooking(model);\n</code></pre>\n\n<p>im completely clueless i tried adding static to my methods but still no luck.maybe im not understanding the error properly i need abit of guidance\nthank you</p>\n"}, {"tags": ["c#", "wpf", "multithreading"], "comments": [{"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1436385676, "post_id": 31302057, "comment_id": 50595209, "body": "All this trouble to find back a Window you created yourself? How about keeping track of that <code>ofd</code> variable at the class scope?"}, {"owner": {"reputation": 5996, "user_id": 2598770, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ac98ed5ba8dd996d7489d6bebadfbeec?s=128&d=identicon&r=PG&f=1", "display_name": "Rand Random", "link": "https://stackoverflow.com/users/2598770/rand-random"}, "reply_to_user": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1436386557, "post_id": 31302057, "comment_id": 50595692, "body": "@HenkHolterman I wanted to make this example simple its not sooo easy in my real live code. Talking about different processes working with window handles like all over the place, I just simple don&#39;t know if or if not something is open. I also don&#39;t even need to be the caller of the openfiledialog someone could get the handle of my window and open a System.Windows.Forms dialog and pass this handle to the ShowDialog method, or use WindowInteropHandler to set owner randomly."}], "answers": [{"comments": [{"owner": {"reputation": 5996, "user_id": 2598770, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ac98ed5ba8dd996d7489d6bebadfbeec?s=128&d=identicon&r=PG&f=1", "display_name": "Rand Random", "link": "https://stackoverflow.com/users/2598770/rand-random"}, "edited": false, "score": 0, "creation_date": 1436386510, "post_id": 31302361, "comment_id": 50595666, "body": "I was afraid this &quot;solution&quot; might popup, seems like my example code is too easy for ya guys, gona try to be more specific why this isn&#39;t a good solution for me tomorrow."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 2, "creation_date": 1436386633, "post_id": 31302361, "comment_id": 50595741, "body": "Yes, you get answers on the question you ask. Not the on the ones you should have asked."}], "tags": [], "owner": {"reputation": 1660, "user_id": 1911199, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/02d88411e93d397468c660cb16b2be6a?s=128&d=identicon&r=PG", "display_name": "oppassum", "link": "https://stackoverflow.com/users/1911199/oppassum"}, "is_accepted": true, "score": 3, "last_activity_date": 1436385000, "creation_date": 1436385000, "answer_id": 31302361, "question_id": 31302057, "link": "https://stackoverflow.com/questions/31302057/block-closing-wpf-window-from-a-different-thread-if-openfiledialog-is-open/31302361#31302361", "title": "Block closing WPF window (from a different thread) if OpenFileDialog is open", "body": "<p>You can solve this with a boolean value tracking if it's open or not:</p>\n\n<pre><code>bool dialogOpen = false;\n\npublic void OpenDialogAndCloseMe()\n{\n    var ofd = new OpenFileDialog();\n\n    Thread th = new Thread(() =&gt; CloseMe());\n    th.Start();\n\n    dialogOpen = true;\n    ofd.ShowDialog(this);\n    dialogOpen = false;\n}\n\n\nprivate void OnClosing(object sender, CancelEventArgs e)\n{\n    //check if OpenFileDialog is still open and block the close...\n    if(dialogOpen)\n    {\n        e.Cancel = true;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5996, "user_id": 2598770, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ac98ed5ba8dd996d7489d6bebadfbeec?s=128&d=identicon&r=PG&f=1", "display_name": "Rand Random", "link": "https://stackoverflow.com/users/2598770/rand-random"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "accepted_answer_id": 31302361, "answer_count": 1, "score": -1, "last_activity_date": 1436385000, "creation_date": 1436384052, "question_id": 31302057, "link": "https://stackoverflow.com/questions/31302057/block-closing-wpf-window-from-a-different-thread-if-openfiledialog-is-open", "title": "Block closing WPF window (from a different thread) if OpenFileDialog is open", "body": "<p>To clear things up before you mention the most obvious choice, I am already calling ShowDialog and not the Show method!!!</p>\n\n<p>I would like to block the close (invoked from a different thread) off an WPF window if a OpenFileDialog is open.</p>\n\n<p>Here is the code I have (reduced to show my problem):</p>\n\n<pre><code>public class FooWindow : Window\n{\n    public FooWindow()\n    {\n        InitializeComponent();\n        this.Closing += OnClosing;    \n    }\n\n    public void OpenDialogAndCloseMe()\n    {\n        var ofd = new OpenFileDialog();\n\n        Thread th = new Thread(() =&gt; CloseMe());\n        th.Start();\n\n        ofd.ShowDialog(this);\n    }\n\n    public void CloseMe()\n    {\n        System.Threading.Thread.Sleep(2000); //give the OpenFileDialog time to pop up...\n\n        //since this method gets called from a different thread invoke it...\n        this.Dispatcher.Invoke(() =&gt; this.Close());\n    }\n\n    private void OnClosing(object sender, CancelEventArgs e)\n    {\n        //check if OpenFileDialog is still open and block the close...\n        e.Cancel = true;\n    }\n}\n</code></pre>\n\n<p>The problem I am facing is the OnClosing part, how would I get the OpenFileDialog (or any other Dialog in that case).</p>\n\n<p>I have searched the web and found Win32 methods like:</p>\n\n<pre><code>[DllImport(\"user32\")]\n[return: MarshalAs(UnmanagedType.Bool)]\nprivate static extern bool EnumChildWindows(IntPtr window, EnumedWindow callback, ArrayList lParam);\n\n[DllImport(\"user32.dll\", EntryPoint = \"FindWindowEx\", CharSet = CharSet.Auto)]\nstatic extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);\n</code></pre>\n\n<p>I have tried them both but they return 0 children, any ideas what's going wrong?</p>\n\n<p>Here is the full code I tried so far:</p>\n\n<pre><code>//replace the above OnClosing with this implementation... all 3 return false\nprivate void OnClosing(object sender, CancelEventArgs e)\n{\n    //check if OpenFileDialog is still open and block the close...\n    var hWnd = new WindowInteropHelper(this).Handle;\n\n    if (WindowHandling.GetChildren(hWnd).Any())\n        e.Cancel = true;\n\n    if (WindowHandling.GetChildrenV2(hWnd).Any())\n        e.Cancel = true;\n\n    if (WindowHandling.GetChildrenV3(hWnd).Any())\n        e.Cancel = true;\n}\n\npublic static class WindowHandling\n{\n    private delegate bool EnumedWindow(IntPtr handleWindow, ArrayList handles);\n\n    [DllImport(\"user32\")]\n    [return: MarshalAs(UnmanagedType.Bool)]\n    private static extern bool EnumChildWindows(IntPtr window, EnumedWindow callback, ArrayList lParam);\n\n    [DllImport(\"user32.dll\", EntryPoint = \"FindWindowEx\", CharSet = CharSet.Auto)]\n    static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);\n\n    private static bool GetWindowHandle(IntPtr windowHandle, ArrayList windowHandles)\n    {\n        windowHandles.Add(windowHandle);\n        return true;\n    }\n\n    public static IEnumerable&lt;IntPtr&gt; GetChildren(IntPtr hWnd)\n    {\n        if (hWnd == IntPtr.Zero)\n            return Enumerable.Empty&lt;IntPtr&gt;();\n\n        var x = new WindowHandleInfo(hWnd);\n        return x.GetAllChildHandles();\n    }\n\n    public static IEnumerable&lt;IntPtr&gt; GetChildrenV2(IntPtr hWnd)\n    {\n        var windowHandles = new ArrayList();\n        EnumedWindow callBackPtr = GetWindowHandle;\n        EnumChildWindows(hWnd, callBackPtr, windowHandles);\n\n        return windowHandles.OfType&lt;IntPtr&gt;();\n    }\n    public static IEnumerable&lt;IntPtr&gt; GetChildrenV3(IntPtr hParent)\n    {\n        var result = new List&lt;IntPtr&gt;();\n        var ct = 0;\n        var maxCount = 100;\n        var prevChild = IntPtr.Zero;\n\n        while (true &amp;&amp; ct &lt; maxCount)\n        {\n            var currChild = FindWindowEx(hParent, prevChild, null, null);\n            if (currChild == IntPtr.Zero)\n                break;\n\n            result.Add(currChild);\n            prevChild = currChild;\n            ++ct;\n        }\n\n        return result;\n    }\n\n    //http://stackoverflow.com/questions/1363167/how-can-i-get-the-child-windows-of-a-window-given-its-hwnd\n    private class WindowHandleInfo\n    {\n        private delegate bool EnumWindowProc(IntPtr hwnd, IntPtr lParam);\n\n        [DllImport(\"user32.dll\", SetLastError = true)]\n        [return: MarshalAs(UnmanagedType.Bool)]\n        private static extern bool EnumChildWindows(IntPtr window, EnumWindowProc callback, IntPtr lParam);\n\n        private readonly IntPtr _mainHandle;\n\n        public WindowHandleInfo(IntPtr handle)\n        {\n            _mainHandle = handle;\n        }\n\n        public IEnumerable&lt;IntPtr&gt; GetAllChildHandles()\n        {\n            var childHandles = new List&lt;IntPtr&gt;();\n\n            var gcChildhandlesList = GCHandle.Alloc(childHandles);\n            var pointerChildHandlesList = GCHandle.ToIntPtr(gcChildhandlesList);\n\n            try\n            {\n                var childProc = new EnumWindowProc(EnumWindow);\n                var x = EnumChildWindows(this._mainHandle, childProc, pointerChildHandlesList);\n                if (x == false)\n                {\n                    var error = Marshal.GetLastWin32Error();\n                }\n            }\n            finally\n            {\n                gcChildhandlesList.Free();\n            }\n\n            return childHandles;\n        }\n\n        private static bool EnumWindow(IntPtr hWnd, IntPtr lParam)\n        {\n            var gcChildhandlesList = GCHandle.FromIntPtr(lParam);\n\n            if (gcChildhandlesList.Target == null)\n                return false;\n\n            var childHandles = gcChildhandlesList.Target as List&lt;IntPtr&gt;;\n            if (childHandles != null)\n                childHandles.Add(hWnd);\n\n            return true;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "unity3d", "rotation", "gameobject"], "comments": [{"owner": {"reputation": 1590, "user_id": 2237804, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b87b4c3229d61e94af6237eb22a63790?s=128&d=identicon&r=PG", "display_name": "Rasmus Damgaard Nielsen", "link": "https://stackoverflow.com/users/2237804/rasmus-damgaard-nielsen"}, "edited": false, "score": 0, "creation_date": 1436422055, "post_id": 31302014, "comment_id": 50607313, "body": "I dont know unity that well, but isnt there an event called something like &quot;move&quot; which you can subscribe to, and then in the method body test if the new position is acceptable something like  if (object.positoon.Y){&lt;&lt;&lt;your code here&gt;&gt;&gt;}"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4507007"}, "edited": false, "score": 0, "creation_date": 1436400486, "post_id": 31302788, "comment_id": 50601410, "body": "The problem is im not rotating the same amount of degrees every time, it depends how far back the baseball bat has been pulled so i cant do it like that, also i cant use time to measure it either because the speed of the forwardswing varies also. Im at a loss here"}, {"owner": {"reputation": 6414, "user_id": 4979159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22618a43082c5a2336cc1db5e93c15f1?s=128&d=identicon&r=PG&f=1", "display_name": "maksymiuk", "link": "https://stackoverflow.com/users/4979159/maksymiuk"}, "edited": false, "score": 0, "creation_date": 1436405790, "post_id": 31302788, "comment_id": 50602667, "body": "Cant use time to measure it? What are you talking about? you want to use time whenever you are doing an iterative call on a movement. Also what you want to do is a Slerp i already said that, it will do exactly what you are trying to do. Just do a Slerp from any current rotation to the end rotation your looking for, that way you aren&#39;t rotating the same amount of degrees every time but the exact amount you need."}], "tags": [], "owner": {"reputation": 6414, "user_id": 4979159, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22618a43082c5a2336cc1db5e93c15f1?s=128&d=identicon&r=PG&f=1", "display_name": "maksymiuk", "link": "https://stackoverflow.com/users/4979159/maksymiuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1436405890, "last_edit_date": 1436405890, "creation_date": 1436386400, "answer_id": 31302788, "question_id": 31302014, "link": "https://stackoverflow.com/questions/31302014/how-do-i-stop-the-rotation-of-my-gameobject-when-it-reaches-a-certain-point-on-i/31302788#31302788", "title": "How do I stop the rotation of my gameobject when it reaches a certain point on its y-axis?", "body": "<p>if your rotating a certain amount of degrees, you should use a <code>Slerp</code> or <code>RotateTowards</code></p>\n\n<pre><code>Vector3 targetDir = (target.position - transform.position).normalized;\n\n// The step size is equal to speed times frame time.\nfloat step = speed * Time.deltaTime;\n\nVector3 newDir = Vector3.RotateTowards(transform.up, targetDir, step, 0.0);\n\ntransform.rotation = Quaternion.LookRotation(newDir)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4507007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1023, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436405890, "creation_date": 1436383939, "last_edit_date": 1436385050, "question_id": 31302014, "link": "https://stackoverflow.com/questions/31302014/how-do-i-stop-the-rotation-of-my-gameobject-when-it-reaches-a-certain-point-on-i", "title": "How do I stop the rotation of my gameobject when it reaches a certain point on its y-axis?", "body": "<p>I'm currently working on a simple baseball game. What I'm trying to do is have the player be able to swing the bat backwards to \"charge up\" power, so to speak, and then when a button is released he will swing the bat forward at a speed equal to the amount of power stored up.</p>\n\n<p>This is all well and good, but my problem is I need to stop the motion of the bat when he reach a certain point on the y-axis, and I'm a bit unsure how to go about doing this as I cannot just tell it to stop rotating after a set time as the bat won't reach the front point at the same time every time due to the difference in speed each swing might have.</p>\n\n<p>What I'm trying to do basically is something like <code>if(reached 266 on the y-axis stop rotating)</code>, but I'm unsure of how to do this. </p>\n\n<p>Anyway here is the code I've written so far:</p>\n\n<pre><code>public int rotateSpeed = 50;\npublic float AmountOfPowerChargedUp = 0;\n\nvoid Update() \n{\n\n    if (Input.GetMouseButton(0))    \n    {\n        AmountOfPowerChargedUp += 5f;\n        transform.Rotate(Vector3.up * rotateSpeed * Time.deltaTime); \n        Debug.Log(AmountOfPowerChargedUp);\n    }\n\n    if (!Input.GetMouseButton (0)) \n    {\n        transform.Rotate(Vector3.down * AmountOfPowerChargedUp * Time.deltaTime);\n    }   \n\n}\n\nprivate void OnGUI()\n{\n    GUI.Label (new Rect (50, 15, 250, 25), \"AmountOfPowerChargedUp: \" + AmountOfPowerChargedUp); \n}\n</code></pre>\n"}, {"tags": ["c#", "excel", "visual-studio", "spreadsheetlight"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5095530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7672cd148d7085067e292946f4e21dd?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Gates", "link": "https://stackoverflow.com/users/5095530/brendan-gates"}, "edited": false, "score": 2, "creation_date": 1436388207, "post_id": 31302241, "comment_id": 50596621, "body": "Thanks Grant!  The method is called GetSheetNames() in the version i downloaded, but it should do the trick."}], "tags": [], "owner": {"reputation": 60839, "user_id": 301857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4KmT.jpg?s=128&g=1", "display_name": "Grant Winney", "link": "https://stackoverflow.com/users/301857/grant-winney"}, "is_accepted": true, "score": 3, "last_activity_date": 1436384578, "creation_date": 1436384578, "answer_id": 31302241, "question_id": 31301928, "link": "https://stackoverflow.com/questions/31301928/how-to-loop-through-unknown-worksheet-names-in-a-workbook-using-the-spreadsheetl/31302241#31302241", "title": "How to loop through unknown worksheet names in a workbook using the SpreadsheetLight Library", "body": "<p>There's a <code>GetWorksheetNames()</code> method that looks like it will do exactly what you want:</p>\n\n<pre><code>var sl = new SLDocument(\"ModifyExistingSpreadsheetOriginal.xlsx\");\n\nforeach (var name in sl.GetWorksheetNames())\n{\n    // do something with each worksheet name\n}\n</code></pre>\n\n<p>From their docs:</p>\n\n<blockquote>\n  <p>Get a list of names of existing worksheets currently in the spreadsheet, excluding chart sheets, macro sheets and dialog sheets.</p>\n</blockquote>\n"}], "owner": {"reputation": 103, "user_id": 5095530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7672cd148d7085067e292946f4e21dd?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Gates", "link": "https://stackoverflow.com/users/5095530/brendan-gates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "accepted_answer_id": 31302241, "answer_count": 1, "score": 3, "last_activity_date": 1436384578, "creation_date": 1436383673, "last_edit_date": 1436384546, "question_id": 31301928, "link": "https://stackoverflow.com/questions/31301928/how-to-loop-through-unknown-worksheet-names-in-a-workbook-using-the-spreadsheetl", "title": "How to loop through unknown worksheet names in a workbook using the SpreadsheetLight Library", "body": "<p>I'm trying to loop through unknown worksheet names in a workbook using the SpreadsheetLight Library.  </p>\n\n<p>Using the <code>SLDocument sl = new SLDocument(\"ModifyExistingSpreadsheetOriginal.xlsx\", \"Sheet1\")</code> statement in the examples only allows a string input for the worksheet.</p>\n\n<p>Is there some way to refer to a worksheet index or do something similar to a <code>foreach string sh in Workbook.Sheets</code> loop?</p>\n"}, {"tags": ["c#", ".net", "expression", "expression-trees"], "comments": [{"owner": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1436384110, "post_id": 31301830, "comment_id": 50594261, "body": "Expression.Call? What have you tried?"}, {"owner": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "reply_to_user": {"reputation": 161657, "user_id": 122718, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/213Kw.png?s=128&g=1", "display_name": "usr", "link": "https://stackoverflow.com/users/122718/usr"}, "edited": false, "score": 0, "creation_date": 1436384709, "post_id": 31301830, "comment_id": 50594639, "body": "Brilliant that did the trick :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 280562, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/899ffd9c60cf022e495343afd66fc74c?s=128&d=identicon&r=PG", "display_name": "MBoros", "link": "https://stackoverflow.com/users/280562/mboros"}, "edited": false, "score": 0, "creation_date": 1436537998, "post_id": 31302276, "comment_id": 50670282, "body": "if you compile an expression straight away, then most of the time you dont need it, what is wrong with your first line?"}], "tags": [], "owner": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "is_accepted": true, "score": 2, "last_activity_date": 1444489510, "last_edit_date": 1444489510, "creation_date": 1436384684, "answer_id": 31302276, "question_id": 31301830, "link": "https://stackoverflow.com/questions/31301830/how-can-i-build-an-expression-that-compiles-to-a-funct/31302276#31302276", "title": "How can I build an expression that compiles to a Func&lt;T&gt;?", "body": "<p>Thanks to the tip from <code>usr</code> I managed to do it using <code>Expression.Call</code> so given:</p>\n\n<pre><code>public static class MyClass\n{\n    public static string GetTime() \n    {\n        return DateTime.Now.ToString(\"yyyy-MM-dd HH:mm:ss,fff\");\n    }\n\n    public static string GetName(Type type)\n    {\n        return type.Name;\n    }\n}\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>// Calls static method GetTime with no args\nvar mCallGetTime = Expression.Call(typeof(MyClass), \"GetTime\", null);\nFunc&lt;string&gt; resultNoArg = Expression.Lambda&lt;Func&lt;string&gt;&gt;(mCallGetTime).Compile();\n\n// The input param for GetName which is of type Type\nvar paramExp = Expression.Parameter(typeof(Type));\n\n// Calls static method GetName passing in the param\nvar mCallGetName = Expression.Call(typeof(MyClass), \"GetName\", null, paramExp);\nFunc&lt;Type, string&gt; resultWithArg = Expression.Lambda&lt;Func&lt;Type, string&gt;&gt;(mCallGetName, paramExp).Compile();\n\n// You can then call them like so... Print() just prints the string\nresultNoArg().Print();\nresultWithArg(typeof(string)).Print();\nresultWithArg(typeof(int)).Print();\n</code></pre>\n\n<p>Alternatively, Instead of:</p>\n\n<pre><code>var mCallGetTime = Expression.Call(typeof(MyClass), \"GetTime\", null);\n</code></pre>\n\n<p>We could compose the <code>Expression.Call</code> using:</p>\n\n<pre><code>// Get the method info for GetTime (note the Type[0] signifying no args taken by GetTime);\nvar methodInfo = typeof(MyClass).GetMethod(\"GetTime\", new Type[0]);\nvar mCallGetTime = Expression.Call(methodInfo);\n</code></pre>\n\n<p>Likewise for <code>GetName</code>:</p>\n\n<pre><code>// Get the method info for GetName (note the new[] {typeof(Type)} signifying the arg taken by GetName\nvar getNameMethodInfo = typeof(MyClass).GetMethod(\"GetName\", new[] { typeof(Type)});\nvar mCallGetName = Expression.Call(getNameMethodInfo, paramExp);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1436385017, "creation_date": 1436385017, "answer_id": 31302365, "question_id": 31301830, "link": "https://stackoverflow.com/questions/31301830/how-can-i-build-an-expression-that-compiles-to-a-funct/31302365#31302365", "title": "How can I build an expression that compiles to a Func&lt;T&gt;?", "body": "<p>An alternative to your answer is to create a fully generic method that will construct a <code>Func&lt;T&gt;</code> for any generic, static method in any type.</p>\n\n<pre><code>public Func&lt;T&gt; BuildGenericStaticFunc&lt;T&gt;()\n{\n    var type = typeof(T);\n    return Expression.Lambda&lt;Func&lt;T&gt;&gt;(\n        Expression\n            .Call(\n                type.GetMethod(\"Create\", BindingFlags.Static | BindingFlags.Public)\n                    .MakeGenericMethod(type),\n                Expression.Constant(type)\n                ))\n            .Compile();\n}\n\nvar result = BuildGenericStaticFunc&lt;MyClass&gt;();\n</code></pre>\n"}], "owner": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 31302276, "answer_count": 2, "score": 4, "last_activity_date": 1444489510, "creation_date": 1436383325, "question_id": 31301830, "link": "https://stackoverflow.com/questions/31301830/how-can-i-build-an-expression-that-compiles-to-a-funct", "title": "How can I build an expression that compiles to a Func&lt;T&gt;?", "body": "<p>Suppose I have a static method that returns T such as:</p>\n\n<pre><code>T myT = MyClass.Create(type); // type is System.Type\n</code></pre>\n\n<p>I then want to be able to build and compile an expression so that I can have a <code>Func&lt;T&gt;</code> but I cannot figure out how to do it.</p>\n\n<p>I can build it for a <code>Constant</code> doing:</p>\n\n<pre><code>Func&lt;T&gt; result = Expression.Lambda&lt;Func&lt;T&gt;&gt;(Expression.Constant(string.Empty)).Compile()\n</code></pre>\n\n<p>but for <code>MyClass.Create(type)</code> I am stuck.</p>\n\n<pre><code>Func&lt;T&gt; result = ....?\n</code></pre>\n"}, {"tags": ["c#", "image", "unit-testing", "deterministic"], "comments": [{"owner": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 0, "creation_date": 1436383625, "post_id": 31301770, "comment_id": 50593961, "body": "You could extract the Bitmap/Graphics away from your class (With Adapters, for example), so you can test your actual logic and the calls made instead of the graphical components themselves (which you don&#39;t need to test - we already know Graphics work correctly)."}, {"owner": {"reputation": 2215, "user_id": 1075980, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119d0b08394d2a9da34a3577421b37e4?s=128&d=identicon&r=PG", "display_name": "Zarepheth", "link": "https://stackoverflow.com/users/1075980/zarepheth"}, "reply_to_user": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 0, "creation_date": 1436383888, "post_id": 31301770, "comment_id": 50594127, "body": "The code has been used for quite some time, but we have not had much unit testing. I know it&#39;s poor practice, but I&#39;m trying to rectify the situation by creating unit tests now. So, without changing the code under test, would you suggest I use MS Fakes to Shim the graphics calls and verify they are called with expected parameters."}, {"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 1, "creation_date": 1436383894, "post_id": 31301770, "comment_id": 50594131, "body": "One thing you can check is that does ImageToByteArray return the same thing when called multiple times on the same image. This is not the way way I&#39;ve typically done this, which would be to use GetPixel on both and compare the values. It might be a little slower but then you can report exactly where the images differ."}, {"owner": {"reputation": 2215, "user_id": 1075980, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119d0b08394d2a9da34a3577421b37e4?s=128&d=identicon&r=PG", "display_name": "Zarepheth", "link": "https://stackoverflow.com/users/1075980/zarepheth"}, "reply_to_user": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1436384515, "post_id": 31301770, "comment_id": 50594516, "body": "@mikez I called the <code>ImageToByteArray</code> method 5 times, 17 seconds apart, with the same source image. Comparing the first result against each of the subsequent results indicated that all 5 calls returned the same value. Non-deterministic behavior must be occuring within the method under test."}, {"owner": {"reputation": 3571, "user_id": 2018731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134baab491cb1a3ebff752e5ea96dcaa?s=128&d=identicon&r=PG", "display_name": "RogerN", "link": "https://stackoverflow.com/users/2018731/rogern"}, "edited": false, "score": 0, "creation_date": 1436386543, "post_id": 31301770, "comment_id": 50595685, "body": "I noticed that you&#39;re using <code>PixelFormat.Format48bppRgb</code> to create your bitmap, but then you save it as a .bmp.  That might be causing unintended behavior... the bit depth of your image will be reduced to 24bpp when you save it that way.  Perhaps that affected how your reference image was saved?"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1436387892, "post_id": 31301770, "comment_id": 50596456, "body": "The <code>Save()</code> method is deterministic. That is, it will always produce the same output given the same input. But the <code>Save()</code> method in different versions of .NET or the OS may produce different results, as would the method in a single environment if given different inputs. Please provide <a href=\"https://stackoverflow.com/help/mcve\">a good, <i>minimal</i>, <i>complete</i> code example</a> that reliably reproduces the problem."}, {"owner": {"reputation": 3571, "user_id": 2018731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134baab491cb1a3ebff752e5ea96dcaa?s=128&d=identicon&r=PG", "display_name": "RogerN", "link": "https://stackoverflow.com/users/2018731/rogern"}, "edited": false, "score": 0, "creation_date": 1436387970, "post_id": 31301770, "comment_id": 50596500, "body": "Also, was your reference image (TestImageLandscapeDesertResized_300_300) created on the same machine?  Since you&#39;re rescaling the bitmap, it might be important to know that bitmap stretching can be hardware-accelerated.  Thus the exact output of calling <code>graphic.DrawImage</code> could vary depending on video card / drivers."}, {"owner": {"reputation": 2215, "user_id": 1075980, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119d0b08394d2a9da34a3577421b37e4?s=128&d=identicon&r=PG", "display_name": "Zarepheth", "link": "https://stackoverflow.com/users/1075980/zarepheth"}, "reply_to_user": {"reputation": 3571, "user_id": 2018731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134baab491cb1a3ebff752e5ea96dcaa?s=128&d=identicon&r=PG", "display_name": "RogerN", "link": "https://stackoverflow.com/users/2018731/rogern"}, "edited": false, "score": 0, "creation_date": 1436388617, "post_id": 31301770, "comment_id": 50596827, "body": "@RogerN at this time the reference image was created on the machine as the image being tested. However, I was expecting this to run correctly even on different machines; which means my assumption may fail when my team members run the test..."}, {"owner": {"reputation": 2215, "user_id": 1075980, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119d0b08394d2a9da34a3577421b37e4?s=128&d=identicon&r=PG", "display_name": "Zarepheth", "link": "https://stackoverflow.com/users/1075980/zarepheth"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1436388774, "post_id": 31301770, "comment_id": 50596903, "body": "@PeterDuniho, so if the reference image in my resources is tested on a machine with a newer version of Windows, or the .Net version is incremented the test may fail - even if I get the unit test working on my machine?"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1436390039, "post_id": 31301770, "comment_id": 50597550, "body": "Yes. There&#39;s no reason to expect the exact output to be identical. Note that I <i>would</i> expect the actual <i>pixel</i> data to be the same, at least for a non-lossy format like BMP (which is what you&#39;re saving here). But image files have other metadata that could vary according to implementation. And in your example, you appear to be scaling the image, which is also implementation-dependent. Again, with a good code example, you would probably get a specific answer. Without one, that&#39;s unlikely."}, {"owner": {"reputation": 2215, "user_id": 1075980, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119d0b08394d2a9da34a3577421b37e4?s=128&d=identicon&r=PG", "display_name": "Zarepheth", "link": "https://stackoverflow.com/users/1075980/zarepheth"}, "edited": false, "score": 0, "creation_date": 1436396382, "post_id": 31301770, "comment_id": 50600189, "body": "By empirical testing I have discovered that this line <code>return new Bitmap(image);</code> returns an image with different properties than the original. The color palette is different and also the pixel format."}], "answers": [{"tags": [], "owner": {"reputation": 2215, "user_id": 1075980, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119d0b08394d2a9da34a3577421b37e4?s=128&d=identicon&r=PG", "display_name": "Zarepheth", "link": "https://stackoverflow.com/users/1075980/zarepheth"}, "is_accepted": true, "score": 0, "last_activity_date": 1436396233, "creation_date": 1436396233, "answer_id": 31305264, "question_id": 31301770, "link": "https://stackoverflow.com/questions/31301770/in-net-is-system-drawing-image-save-deterministic/31305264#31305264", "title": "In .Net is System.Drawing.Image.Save deterministic?", "body": "<p>This eventually worked. I don't know whether or not this is a good idea for unit tests, but with the GDI+ logic being non-deterministic (or my logic interfacing with it), this seems the best approach.</p>\n\n<p>I use MS Fakes Shimming feature to Shim the dependent calls and verify expected values are passed to the called methods. Then I call the native methods to get the required functionality for the rest of the method under test. And finally I verify a few attributes of the returned image.</p>\n\n<p>Still, I would prefer to perform a straight comparison of expected output against actual output...</p>\n\n\n\n<pre class=\"lang-cs prettyprint-override\"><code>[TestMethod]\n[TestCategory(\"ImageHelper\")]\n[TestCategory(\"ResizeImage\")]\npublic void ResizeImage_LandscapeTooLarge_SmallerLandscape()\n{\n    Image testImageLandscape = Resources.TestImageLandscapeDesert;\n\n    const int HEIGHT = 300;\n    const int WIDTH = 300;\n    const int EXPECTED_WIDTH = WIDTH;\n    const int EXPECTED_HEIGHT = (int)(EXPECTED_WIDTH / (1024m / 768m));\n    const PixelFormat EXPECTED_FORMAT = PixelFormat.Format48bppRgb;\n    bool calledBitMapConstructor = false;\n    bool calledGraphicsFromImage = false;\n    bool calledGraphicsDrawImage = false;\n\n    using (ShimsContext.Create())\n    {\n        ShimBitmap.ConstructorInt32Int32PixelFormat = (instance, w, h, f) =&gt; {\n            calledBitMapConstructor = true;\n            Assert.AreEqual(EXPECTED_WIDTH, w);\n            Assert.AreEqual(EXPECTED_HEIGHT, h);\n            Assert.AreEqual(EXPECTED_FORMAT, f);\n            ShimsContext.ExecuteWithoutShims(() =&gt; {\n                ConstructorInfo constructor = typeof(Bitmap).GetConstructor(new[] { typeof(int), typeof(int), typeof(PixelFormat) });\n                Assert.IsNotNull(constructor);\n                constructor.Invoke(instance, new object[] { w, h, f });\n            });\n        };\n        ShimGraphics.FromImageImage = i =&gt; {\n            calledGraphicsFromImage = true;\n            Assert.IsNotNull(i);\n            return ShimsContext.ExecuteWithoutShims(() =&gt; Graphics.FromImage(i));\n        };\n        ShimGraphics.AllInstances.DrawImageImageInt32Int32Int32Int32 = (instance, i, x, y, w, h) =&gt; {\n            calledGraphicsDrawImage = true;\n            Assert.IsNotNull(i);\n            Assert.AreEqual(0, x);\n            Assert.AreEqual(0, y);\n            Assert.AreEqual(EXPECTED_WIDTH, w);\n            Assert.AreEqual(EXPECTED_HEIGHT, h);\n            ShimsContext.ExecuteWithoutShims(() =&gt; instance.DrawImage(i, x, y, w, h));\n        };\n        using (Image resizedImage = ImageHelper.ResizeImage(testImageLandscape, HEIGHT, WIDTH))\n        {\n            Assert.IsNotNull(resizedImage);\n            Assert.AreEqual(EXPECTED_WIDTH, resizedImage.Size.Width);\n            Assert.AreEqual(EXPECTED_HEIGHT, resizedImage.Size.Height);\n            Assert.AreEqual(EXPECTED_FORMAT, resizedImage.PixelFormat);\n        }\n    }\n\n    Assert.IsTrue(calledBitMapConstructor);\n    Assert.IsTrue(calledGraphicsFromImage);\n    Assert.IsTrue(calledGraphicsDrawImage);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1354, "user_id": 1887802, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/715b79524dd12f9ef11382d5e4f11389?s=128&d=identicon&r=PG", "display_name": "Stevo", "link": "https://stackoverflow.com/users/1887802/stevo"}, "is_accepted": false, "score": 0, "last_activity_date": 1528734596, "creation_date": 1528734596, "answer_id": 50802278, "question_id": 31301770, "link": "https://stackoverflow.com/questions/31301770/in-net-is-system-drawing-image-save-deterministic/50802278#50802278", "title": "In .Net is System.Drawing.Image.Save deterministic?", "body": "<p>A bit late to the table with this, but adding this in case it helps anyone out. In my unit tests, this reliably compared images I had dynamically generated using GDI+.</p>\n\n<pre><code>private static bool CompareImages(string source, string expected)\n{\n    var image1 = new Bitmap($\".\\\\{source}\");\n    var image2 = new Bitmap($\".\\\\Expected\\\\{expected}\");\n\n    var converter = new ImageConverter();\n    var image1Bytes = (byte[])converter.ConvertTo(image1, typeof(byte[]));\n    var image2Bytes = (byte[])converter.ConvertTo(image2, typeof(byte[]));\n\n    // ReSharper disable AssignNullToNotNullAttribute\n    var same = image1Bytes.SequenceEqual(image2Bytes);\n    // ReSharper enable AssignNullToNotNullAttribute\n\n    return same;\n}\n</code></pre>\n"}], "owner": {"reputation": 2215, "user_id": 1075980, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/119d0b08394d2a9da34a3577421b37e4?s=128&d=identicon&r=PG", "display_name": "Zarepheth", "link": "https://stackoverflow.com/users/1075980/zarepheth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 31305264, "answer_count": 2, "score": 0, "last_activity_date": 1528734596, "creation_date": 1436383135, "last_edit_date": 1436383684, "question_id": 31301770, "link": "https://stackoverflow.com/questions/31301770/in-net-is-system-drawing-image-save-deterministic", "title": "In .Net is System.Drawing.Image.Save deterministic?", "body": "<p>I'm trying to compare two Images via their byte content. However, they do not match.</p>\n\n<p>Both images were generated from the same source image, using the same method with the same parameters. I am guessing that something in the image generation or the way I convert to a byte array is not deterministic. Does anyone know where the non-deterministic behavior is occurring and whether or not I can readily force deterministic behavior for my unit testing?</p>\n\n<p>This method within my test class converts the image to a byte array - is <code>image.Save</code> deterministic? Is <code>memStream.ToArray()</code> deterministic?</p>\n\n\n\n<pre class=\"lang-cs prettyprint-override\"><code>private static byte[] ImageToByteArray(Image image)\n{\n    byte[] actualBytes;\n    using (MemoryStream memStream = new MemoryStream())\n    {\n        image.Save(memStream, ImageFormat.Bmp);\n        actualBytes = memStream.ToArray();\n    }\n    return actualBytes;\n}\n</code></pre>\n\n<p>Here is the unit test, which is failing - <code>TestImageLandscapeDesertResized_300_300</code> was generated from <code>TestImageLandscapeDesert</code> using the <code>ImageHelper.ResizeImage(testImageLandscape, 300, 300)</code> and then saving to a file before loading into the project's resource file. If all calls within my code were deterministic based upon my input parameters, this test should pass.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public void ResizeImage_Landscape_SmallerLandscape()\n{\n    Image testImageLandscape = Resources.TestImageLandscapeDesert;\n    Image expectedImage = Resources.TestImageLandscapeDesertResized_300_300;\n    byte[] expectedBytes = ImageToByteArray(expectedImage);\n    byte[] actualBytes;\n    using (Image resizedImage = ImageHelper.ResizeImage(testImageLandscape, 300, 300))\n    {\n        actualBytes = ImageToByteArray(resizedImage);\n    }\n    Assert.IsTrue(expectedBytes.SequenceEqual(actualBytes));\n}\n</code></pre>\n\n<p>The method under test - this method will shrink the input image so its height and width are less than <code>maxHeight</code> and <code>maxWidth</code>, retaining the existing aspect ratio. Some of the graphics calls may be non-deterministic, I cannot tell from Microsoft's limited documentation.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public static Image ResizeImage(Image image, int maxWidth, int maxHeight)\n{\n    decimal width = image.Width;\n    decimal height = image.Height;\n    decimal newWidth;\n    decimal newHeight;\n\n    //Calculate new width and height\n    if (width &gt; maxWidth || height &gt; maxHeight)\n    {\n        // need to preserve the original aspect ratio\n        decimal originalAspectRatio = width / height;\n\n        decimal widthReductionFactor = maxWidth / width;\n        decimal heightReductionFactor = maxHeight / height;\n\n        if (widthReductionFactor &lt; heightReductionFactor)\n        {\n            newWidth = maxWidth;\n            newHeight = newWidth / originalAspectRatio;\n        }\n        else\n        {\n            newHeight = maxHeight;\n            newWidth = newHeight * originalAspectRatio;\n        }\n    }\n\n    else\n        //Return a copy of the image if smaller than allowed width and height\n        return new Bitmap(image);\n\n    //Resize image\n    Bitmap bitmap = new Bitmap((int)newWidth, (int)newHeight, PixelFormat.Format48bppRgb);\n    Graphics graphic = Graphics.FromImage(bitmap);\n    graphic.InterpolationMode = InterpolationMode.HighQualityBicubic;\n    graphic.DrawImage(image, 0, 0, (int)newWidth, (int)newHeight);\n    graphic.Dispose();\n\n    return bitmap;\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", "entity-framework-core"], "comments": [{"owner": {"reputation": 45352, "user_id": 1625737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/v8qtx.png?s=128&g=1", "display_name": "haim770", "link": "https://stackoverflow.com/users/1625737/haim770"}, "edited": false, "score": 0, "creation_date": 1436383728, "post_id": 31301688, "comment_id": 50594034, "body": "Was the database created by EF?"}, {"owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "reply_to_user": {"reputation": 45352, "user_id": 1625737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/v8qtx.png?s=128&g=1", "display_name": "haim770", "link": "https://stackoverflow.com/users/1625737/haim770"}, "edited": false, "score": 0, "creation_date": 1436383762, "post_id": 31301688, "comment_id": 50594057, "body": "No, it was created via SQL statement, Table and Foreign key"}, {"owner": {"reputation": 45352, "user_id": 1625737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/v8qtx.png?s=128&g=1", "display_name": "haim770", "link": "https://stackoverflow.com/users/1625737/haim770"}, "edited": false, "score": 0, "creation_date": 1436385318, "post_id": 31301688, "comment_id": 50595035, "body": "Your <code>ForeignKey&lt;CompanyStatus&gt;(c =&gt; c.StatusId)</code> mapping doesn&#39;t look right. Try to remove it."}, {"owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "reply_to_user": {"reputation": 45352, "user_id": 1625737, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/v8qtx.png?s=128&g=1", "display_name": "haim770", "link": "https://stackoverflow.com/users/1625737/haim770"}, "edited": false, "score": 0, "creation_date": 1436387672, "post_id": 31301688, "comment_id": 50596367, "body": "I have removed and it cause another exceptions in GetAll or GetOne function. I have changed by ForeignKey&lt;CompanyStatus&gt;(cs =&gt; cs.StatusId) to have different identifier. It still throwing exception"}], "answers": [{"comments": [{"owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436383662, "post_id": 31301831, "comment_id": 50593986, "body": "I get the same Exception"}, {"owner": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "reply_to_user": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436385071, "post_id": 31301831, "comment_id": 50594881, "body": "&quot;Cannot insert the value NULL into column &#39;Status&#39;, table &#39;Company&#39;; column does not allow nulls. INSERT fails.&quot;  -  can you just assign some value to this Status property ?"}, {"owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436387823, "post_id": 31301831, "comment_id": 50596428, "body": "With company.Status = new CompanyStatus { StatusId = 1, Name = &quot;Active&quot; }; before Insert, I get the same Exception also..."}, {"owner": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "reply_to_user": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436388452, "post_id": 31301831, "comment_id": 50596747, "body": "What if firstly add related CompanyStatus entity to DB and only then - add your Company entity ?"}, {"owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436460475, "post_id": 31301831, "comment_id": 50633679, "body": "The values of CompanyStatus are already in my DB. EF does not have to insert anything in the child entity table."}], "tags": [], "owner": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436383327, "creation_date": 1436383327, "answer_id": 31301831, "question_id": 31301688, "link": "https://stackoverflow.com/questions/31301688/ef7-beta5-error-trying-to-insert-child-entity/31301831#31301831", "title": "EF7 beta5: Error trying to insert child entity", "body": "<p>Try to change Repository method to :</p>\n\n<pre><code>public int Create(Company company)\n{\n    using (MyDbcontextdbcontext context = new MyDbcontext()) \n    { \n        context.Entry(company).State = EntityState.Added; \n        context.SaveChanges(); \n    }\n}\n</code></pre>\n\n<p>More information : <a href=\"https://msdn.microsoft.com/en-us/data/jj592676.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/data/jj592676.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436463352, "post_id": 31303628, "comment_id": 50635449, "body": "If I add a CLR property to Company, and configure the FK using this new property, I get an Exception: The type &#39;int&#39; must be a reference type in order to use it as parameter &#39;TRelatedEntity&#39; in the generic type or method &#39;EntityTypeBuilder&lt;Company&gt;  In your code there are any reference to CompanyStatus entity, It is not necessary? PS.: I have added my CompanyStatus model code above...I think that is a one-to-one reference."}, {"owner": {"reputation": 21905, "user_id": 2526265, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/692c58f37a3704944bd31c4cbcb287e7?s=128&d=identicon&r=PG", "display_name": "natemcmaster", "link": "https://stackoverflow.com/users/2526265/natemcmaster"}, "reply_to_user": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436463824, "post_id": 31303628, "comment_id": 50635722, "body": "If you want one-to-one, why not just put the status in the same table (entity) rather than using a FK?"}, {"owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "edited": false, "score": 0, "creation_date": 1436473555, "post_id": 31303628, "comment_id": 50641186, "body": "By design, Status is a Entity in my model. And as such it have some other information and behaviors attached. Anyway, this is not the question."}], "tags": [], "owner": {"reputation": 21905, "user_id": 2526265, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/692c58f37a3704944bd31c4cbcb287e7?s=128&d=identicon&r=PG", "display_name": "natemcmaster", "link": "https://stackoverflow.com/users/2526265/natemcmaster"}, "is_accepted": false, "score": 0, "last_activity_date": 1436391594, "last_edit_date": 1436391594, "creation_date": 1436389193, "answer_id": 31303628, "question_id": 31301688, "link": "https://stackoverflow.com/questions/31301688/ef7-beta5-error-trying-to-insert-child-entity/31303628#31303628", "title": "EF7 beta5: Error trying to insert child entity", "body": "<p>The model configuration is incorrect. This is attempting to configure the foreign key for <code>Company</code> by pointing to a property on <code>CompanyStatus</code>. Foreign Keys must be a property on <code>Company</code>.</p>\n\n<p>Also, <code>InverseReference()</code> is for one-to-one relationships. It appears this is trying to get a one-to-many, so use <code>InverseCollection()</code> instead.</p>\n\n<h3>Two solutions</h3>\n\n<p>(This assumes the schema is correctly setup to use foreign keys).</p>\n\n<ol>\n<li>Add a CLR property to <code>Company</code> that contains StatusId. The configuration line should be changed to</li>\n</ol>\n\n<p><code>modelBuilder.Entity&lt;Company&gt;()\n    .Reference(c =&gt; c.Status)\n    .InverseCollection()\n    .ForeignKey(cs =&gt; cs.StatusId);\n</code></p>\n\n<ol start=\"2\">\n<li>If you don't want StatusId in the CLR type, then configure a shadow state property.</li>\n</ol>\n\n<p><code>\n    modelBuilder.Entity&lt;Company&gt;(b=&gt;{\n        b.Property&lt;int&gt;(\"StatusId\"); //this configures the shadow property\n        b.Reference(c =&gt; c.Status).InverseCollection().ForeignKey(\"StatusId\");\n    });\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 17780, "user_id": 826568, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e16aa3062298de19ab239848e85e8041?s=128&d=identicon&r=PG", "display_name": "Bart Calixto", "link": "https://stackoverflow.com/users/826568/bart-calixto"}, "is_accepted": false, "score": 0, "last_activity_date": 1436463995, "creation_date": 1436463995, "answer_id": 31324701, "question_id": 31301688, "link": "https://stackoverflow.com/questions/31301688/ef7-beta5-error-trying-to-insert-child-entity/31324701#31324701", "title": "EF7 beta5: Error trying to insert child entity", "body": "<p>In EF7, you need to have your child object attached into the context. This is different from EF6, and I'm pretty sure is the scenario you are facing. Try to attach the object to the dbcontext before saving.</p>\n\n<p>happened to me, check out this Issue : <a href=\"https://github.com/aspnet/EntityFramework/issues/2387\" rel=\"nofollow\">https://github.com/aspnet/EntityFramework/issues/2387</a> for more information.</p>\n"}], "owner": {"reputation": 2427, "user_id": 1051565, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3b8bd56394c960ae471453deecfc3fba?s=128&d=identicon&r=PG", "display_name": "unairoldan", "link": "https://stackoverflow.com/users/1051565/unairoldan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 806, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1436463995, "creation_date": 1436382886, "last_edit_date": 1495541716, "question_id": 31301688, "link": "https://stackoverflow.com/questions/31301688/ef7-beta5-error-trying-to-insert-child-entity", "title": "EF7 beta5: Error trying to insert child entity", "body": "<p>I have created an API using ASP.NET5 and Entity Framework 7.0.0-beta 5.</p>\n\n<p>I have the Model, DbContext and the Repository created as is described <a href=\"https://stackoverflow.com/questions/31256142/ef7-beta5-foreign-key-returns-null-value\">here</a>, and when I try to insert data with a child entity my app throw an exception: </p>\n\n<p><em>\"Cannot insert the value NULL into column 'Status', table 'Company'; column does not allow nulls. INSERT fails.\"</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/mq3fb.jpg\" alt=\"Code + Exception\"></p>\n\n<p>The Status attribute is not null in my Company entity, but I don't know why EF is not capable of insert the value of the child entity. (in this case, \"1\")</p>\n\n<p>This is the stack trace:</p>\n\n<pre><code>   at Microsoft.Data.Entity.Relational.Update.ReaderModificationCommandBatch.Execute(RelationalTransaction transaction, IRelationalTypeMapper typeMapper, DbContext context, ILogger logger)\n   at Microsoft.Data.Entity.Relational.Update.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)\n   at Microsoft.Data.Entity.Relational.RelationalDataStore.SaveChanges(IReadOnlyList`1 entries)\n   at Microsoft.Data.Entity.ChangeTracking.Internal.StateManager.SaveChanges(IReadOnlyList`1 entriesToSave)\n   at Microsoft.Data.Entity.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)\n   at Microsoft.Data.Entity.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)\n   at Microsoft.Data.Entity.DbContext.SaveChanges()\n   at **.Data.Repositories.CompanyRepository.Create(Company company) in D:\\**.Data\\Repositories\\CompanyRepository.cs:line 36\n   at **.API.Controllers.CompanyController.Create(Company company) in D:\\**.API\\Controllers\\CompanyController.cs:line 48\n</code></pre>\n\n<p>Here is the code:</p>\n\n<p><strong>DbContext</strong></p>\n\n<pre><code>public class MrBellhopContext : DbContext\n{\n\n    public DbSet&lt;Company&gt; Company { get; set; }\n    public DbSet&lt;CompanyStatus&gt; CompanyStatus { get; set; }\n\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity&lt;Company&gt;().Table(\"Company\");\n        modelBuilder.Entity&lt;Company&gt;().Key(c =&gt; c.CompanyId);\n        modelBuilder.Entity&lt;Company&gt;().Index(c =&gt; c.Name);\n        modelBuilder.Entity&lt;Company&gt;().Reference(c =&gt; c.Status).InverseReference().ForeignKey&lt;CompanyStatus&gt;(cs =&gt; cs.StatusId);\n\n        modelBuilder.Entity&lt;CompanyStatus&gt;().Table(\"CompanyStatus\");\n        modelBuilder.Entity&lt;CompanyStatus&gt;().Key(cs =&gt; cs.StatusId);\n\n        base.OnModelCreating(modelBuilder);\n    }\n\n}\n</code></pre>\n\n<p><strong>Model</strong></p>\n\n<pre><code>public class Company\n{\n\n    public int CompanyId { get; set; }\n\n    public string Name { get; set; }\n\n    public string Email { get; set; }\n\n    public CompanyStatus Status { get; set; }\n\n    public DateTime CreatedAt { get; set; }\n\n    public DateTime UpdatedAt { get; set; }\n\n}\n\npublic class CompanyStatus\n{\n\n    public int StatusId { get; set; }\n\n    public string Name { get; set; }\n\n}\n</code></pre>\n\n<p><strong>Repository</strong> (only create method)</p>\n\n<pre><code>    public int Create(Company company)\n    {\n        _dbcontext.Add(company);\n        _dbcontext.SaveChanges();\n\n        return company.CompanyId;\n    }\n</code></pre>\n\n<p><strong>Does anyone know how to insert correctly child entities?</strong></p>\n"}, {"tags": ["javascript", "c#", "jquery", "asp.net"], "answers": [{"comments": [{"owner": {"reputation": 1391, "user_id": 1011591, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/QwmcG.jpg?s=128&g=1", "display_name": "gh0st", "link": "https://stackoverflow.com/users/1011591/gh0st"}, "edited": false, "score": 0, "creation_date": 1436389046, "post_id": 31302997, "comment_id": 50597050, "body": "And add <code>OnClientClick=checkText()</code> to my submit button?"}, {"owner": {"reputation": 1391, "user_id": 1011591, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/QwmcG.jpg?s=128&g=1", "display_name": "gh0st", "link": "https://stackoverflow.com/users/1011591/gh0st"}, "edited": false, "score": 0, "creation_date": 1436391623, "post_id": 31302997, "comment_id": 50598300, "body": "Ok if I catch the submit with jQuery it does something to the <code>Label</code> element. After it passes through the jQuery and is sent to the method inside my <code>btnUpdateClientTable_Click</code> the reference to the <code>Label</code> is lost and calls to <code>suggestedAmount</code> in <code>Label suggestedAmount = (Label)gvPayments.Rows[i].FindControl(&quot;lblSuggestedAmount&quot;);</code> turn up <code>null</code>."}], "tags": [], "owner": {"reputation": 504, "user_id": 4972837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c610752461191be3bcd0c4bfc5af06?s=128&d=identicon&r=PG&f=1", "display_name": "Elisheva Wasserman", "link": "https://stackoverflow.com/users/4972837/elisheva-wasserman"}, "is_accepted": false, "score": 0, "last_activity_date": 1436390012, "last_edit_date": 1436390012, "creation_date": 1436387086, "answer_id": 31302997, "question_id": 31301683, "link": "https://stackoverflow.com/questions/31301683/show-modal-dialog-confirmation-box-based-on-user-input-in-code-behind-asp-net/31302997#31302997", "title": "Show Modal Dialog/Confirmation Box Based on User Input in Code Behind/ASP.net", "body": "<p>First of all, you can't use Windows.Forms on asp.net application, remember that  the UI is running in the browser of the client computer, the code behind that you write is running on the <strong>server</strong> side, in different computer...</p>\n\n<p>You have 2 options to achieve the goal:  </p>\n\n<ol>\n<li><p>Short way, bad performance: Add javascript function to the end of the response, the javascript will show confirmation box in the browser, but all the logic still written in code behind, this is done by calling to \n<a href=\"https://msdn.microsoft.com/en-us/library/btf44dc9(v=vs.110).aspx\" rel=\"nofollow\">ClientScript.RegisterClientScriptBlock </a></p>\n\n<pre><code>RegisterClientScriptBlock(this.GetType(),\n    \"confirmmsg\",\n    \"&lt;script&gt; if(Confirm('do you want to proceed')) forms.submit();&lt;/script&gt;\");\n</code></pre></li>\n<li><p>Long and best way, javascript &amp; jquery can easily implement the code you need, for example:</p>\n\n<pre><code>function checkText(txt) {\n    var allLables = $(\"[id*='lblSuggestedAmount']\"); //get all the labels in the  grid\n    for (var i = 0; i &lt; allLables.length; i++) {\n        if (allLabels[i].html() == txt) { \n            txt.style.bakground-color = \"yellow\";\n            if(Confirm(\"This is message to confirm\")) {\n                form1.submit() // what ever you need\n            }\n        }\n    }\n}\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1391, "user_id": 1011591, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/QwmcG.jpg?s=128&g=1", "display_name": "gh0st", "link": "https://stackoverflow.com/users/1011591/gh0st"}, "is_accepted": true, "score": 0, "last_activity_date": 1436471443, "creation_date": 1436471443, "answer_id": 31326950, "question_id": 31301683, "link": "https://stackoverflow.com/questions/31301683/show-modal-dialog-confirmation-box-based-on-user-input-in-code-behind-asp-net/31326950#31326950", "title": "Show Modal Dialog/Confirmation Box Based on User Input in Code Behind/ASP.net", "body": "<p>Firstly in the front end I did add some JavaScript/jQuery that the other answer provided.</p>\n\n<h2>Front End</h2>\n\n<pre><code>&lt;script&gt;\n// not sure exactly how much of this I need but here goes!\nvar confirm_value = document.createElement(\"INPUT\");\nconfirm_value.type = \"hidden\";\nconfirm_value.name = \"confirm_value\";\nconfirm_value.value = \"no\";\n$(document).ready(function () {\n    confirm_value.type = \"hidden\";\n    confirm_value.name = \"confirm_value\";\n    confirm_value.value = \"no\";\n});\nfunction confirmPayment() {\n    var allLabels = $(\"[id*='lblSuggestedAmount']\");\n    var allTextBoxes = $(\"[id*='txtbxActualAmount']\");\n    var failFlag = false;\n    for (var i = 0; i &lt; allLabels.length; i++) {\n        if (allTextBoxes[i].value != \"\" &amp;&amp; parseFloat(allLabels[i].innerText) != parseFloat(allTextBoxes[i].value)) {\n            failFlag = true;\n        }\n    }\n    if (failFlag) {\n        if (confirm(\"Some payments have actual payment amounts that are different from the suggested amount. If this is correct, click Ok, if not click Cancel.\")) {\n            confirm_value.value = \"yes\";\n            document.forms[0].appendChild(confirm_value);\n        } else {\n            confirm_value.value = \"no\";\n            document.forms[0].appendChild(confirm_value);\n        }\n    }\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>and in my <code>asp:Button</code> that also fires the code-behind</p>\n\n<pre><code>&lt;asp:Button ID=\"btnUpdateClient\" Text=\"Update Client\" OnClientClick=\"confirmPayment()\" OnClick=\"btnUpdateClientTable_Click\" Visible=\"true\" runat=\"server\" /&gt;\n</code></pre>\n\n<h2>Back End</h2>\n\n<p>In my btnUpdateClientTable_Click() method</p>\n\n<p>I needed</p>\n\n<pre><code>string confirm = Request.Form[\"confirm_value\"];\nbool paymentErrorFlag = false;\n</code></pre>\n\n<p>to get the response to the confirm dialog. This would house a \"yes\" or \"no\" response. The flag would get set to true whenever a value was input in the text box but a value was not selected from my drop down list.</p>\n\n<p>I would cycle through every row in the grid view and using a combination of the <code>paymentErrorFlag</code> and checks on <code>.Text == string.Empty</code> and <code>.SelectedIndex == 0</code> to break the function and <code>return;</code> without updating the database.</p>\n\n<p>Essentially the key was the <code>Request.Form[]</code> returning the value of the selection in the confirmation dialog.</p>\n"}], "owner": {"reputation": 1391, "user_id": 1011591, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/QwmcG.jpg?s=128&g=1", "display_name": "gh0st", "link": "https://stackoverflow.com/users/1011591/gh0st"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1771, "favorite_count": 0, "accepted_answer_id": 31326950, "answer_count": 2, "score": 3, "last_activity_date": 1436471443, "creation_date": 1436382875, "last_edit_date": 1495540318, "question_id": 31301683, "link": "https://stackoverflow.com/questions/31301683/show-modal-dialog-confirmation-box-based-on-user-input-in-code-behind-asp-net", "title": "Show Modal Dialog/Confirmation Box Based on User Input in Code Behind/ASP.net", "body": "<p>I have a grid view consisting of a text box and drop down for every row in the grid view. <strong>I want a confirmation dialog to show when the user enters a value in the text box if it does not match the value of a corresponding label for each row in which this is true.</strong></p>\n\n<h2>Front End</h2>\n\n<pre><code>&lt;asp:TemplateField HeaderText=\"Payment Amount\"&gt;\n    &lt;ItemTemplate&gt;\n        &lt;asp:Label ID=\"lblSuggestedAmount\" runat=\"server\"&gt;&lt;/asp:Label&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n&lt;asp:TemplateField HeaderText=\"Actual Payment Amount\"&gt;\n    &lt;ItemTemplate&gt;\n        &lt;asp:TextBox ID=\"txtbxActualAmount\" Visible=\"true\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n&lt;asp:TemplateField HeaderText=\"For Rental Month\"&gt;\n    &lt;ItemTemplate&gt;\n        &lt;asp:DropDownList ID=\"ddlPaymentMonth\" Visible=\"true\" runat=\"server\"&gt;&lt;/asp:DropDownList&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n</code></pre>\n\n<p>What I found to work on my local machine when debugging was <code>System.Windows.Forms.MessageBox.Show()</code> but when I upload my project to my IIS the prompt does not appear.</p>\n\n<h2>Code Behind</h2>\n\n<pre><code>TextBox actualAmount = (TextBox)gvPayments.Rows[i].FindControl(\"txtbxActualAmount\");\nLabel suggestedAmount = (Label)gvPayments.Rows[i].FindControl(\"lblSuggestedAmount\");\nif (Convert.ToDouble(actualAmount.Text) != Convert.ToDouble(suggestedAmount.Text)) {\n    System.Windows.Forms.DialogResult dr = System.Windows.Forms.MessageBox.Show(\"Some payments have actual payment amounts greater than the suggested amount. Is this correct?\", \"Warning\", \n        System.Windows.Forms.MessageBoxButtons.YesNo, \n        System.Windows.Forms.MessageBoxIcon.Warning,\n        System.Windows.Forms.MessageBoxDefaultButton.Button1,\n        System.Windows.Forms.MessageBoxOptions.ServiceNotification);\n    if (dr == System.Windows.Forms.DialogResult.No) {\n        return;\n    } else {\n        actualAmount.BackColor = Color.White;\n    }\n}\n</code></pre>\n\n<p>I understand that because the dialog shows up on client side, where the code is run that the dialog is showing up on the server, and not on the clients browser.</p>\n\n<p>From reading <a href=\"https://stackoverflow.com/questions/13519281/calling-a-confirm-dialog-box-on-code-behind-and-get-the-chosen-option\">other</a> <a href=\"https://stackoverflow.com/questions/22368090/show-confirm-dialog-from-code-behind-asp-net\">similar</a> <a href=\"https://stackoverflow.com/questions/8928713/how-to-resolve-error-showing-a-modal-dialog-box-or-form-when-the-application-i\">questions</a> I also understand I need to achieve this with JavaScript.<br>\n<strong>I imagine I will attach an <code>OnClick</code> event to my update/submit button but will the javascript be able to cycle row through row of my gridview, compare the <code>Label.text</code> and the <code>TextBox.Text</code> and set that text boxes background color to yellow and display my dialog? And then will it know to continue with the rest of the code-behind execution once the user has clicked ok?</strong></p>\n"}, {"tags": ["c#", "sql", "sql-server"], "comments": [{"owner": {"reputation": 11460, "user_id": 1437934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/dwjZm.png?s=128&g=1", "display_name": "Gonzalo.-", "link": "https://stackoverflow.com/users/1437934/gonzalo"}, "edited": false, "score": 0, "creation_date": 1436382793, "post_id": 31301634, "comment_id": 50593448, "body": "You may want to check this question <a href=\"http://stackoverflow.com/questions/861552/when-should-i-open-and-close-a-connection-to-sql-server?rq=1\" title=\"when should i open and close a connection to sql server\">stackoverflow.com/questions/861552/&hellip;</a>"}, {"owner": {"reputation": 1660, "user_id": 1911199, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/02d88411e93d397468c660cb16b2be6a?s=128&d=identicon&r=PG", "display_name": "oppassum", "link": "https://stackoverflow.com/users/1911199/oppassum"}, "reply_to_user": {"reputation": 11460, "user_id": 1437934, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/dwjZm.png?s=128&g=1", "display_name": "Gonzalo.-", "link": "https://stackoverflow.com/users/1437934/gonzalo"}, "edited": false, "score": 0, "creation_date": 1436382915, "post_id": 31301634, "comment_id": 50593526, "body": "@Gonzalo -- In reference to that article, this poster is not mentioning making the SqlConnection static, only the methods and class."}, {"owner": {"reputation": 11383, "user_id": 1753728, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dad2593d1ec5637c74e1057592f01c94?s=128&d=identicon&r=PG", "display_name": "Oluwafemi", "link": "https://stackoverflow.com/users/1753728/oluwafemi"}, "edited": false, "score": 1, "creation_date": 1436382974, "post_id": 31301634, "comment_id": 50593572, "body": "what is your question?"}, {"owner": {"reputation": 1760, "user_id": 2900738, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7a55544fe5771efc63ef8d5f94e9e111?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/2900738/eric"}, "reply_to_user": {"reputation": 11383, "user_id": 1753728, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dad2593d1ec5637c74e1057592f01c94?s=128&d=identicon&r=PG", "display_name": "Oluwafemi", "link": "https://stackoverflow.com/users/1753728/oluwafemi"}, "edited": false, "score": 0, "creation_date": 1436383092, "post_id": 31301634, "comment_id": 50593630, "body": "@Oluwafemi &quot;is it acceptable or &quot;best practice&quot; to have the constructor create the connection object, and then have each method/Query open and then close that connection&quot;"}, {"owner": {"reputation": 11383, "user_id": 1753728, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dad2593d1ec5637c74e1057592f01c94?s=128&d=identicon&r=PG", "display_name": "Oluwafemi", "link": "https://stackoverflow.com/users/1753728/oluwafemi"}, "edited": false, "score": 0, "creation_date": 1436383216, "post_id": 31301634, "comment_id": 50593702, "body": "I see. sorry so sleepy..."}], "answers": [{"comments": [{"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 7, "creation_date": 1436383953, "post_id": 31301674, "comment_id": 50594169, "body": "The <code>using</code> statement means you don&#39;t need the <code>.Close()</code>. <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.close(v=vs.110).aspx\" rel=\"nofollow noreferrer\">When the connection is disposed it is closed.</a>"}, {"owner": {"reputation": 1660, "user_id": 1911199, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/02d88411e93d397468c660cb16b2be6a?s=128&d=identicon&r=PG", "display_name": "oppassum", "link": "https://stackoverflow.com/users/1911199/oppassum"}, "reply_to_user": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 11, "creation_date": 1436383977, "post_id": 31301674, "comment_id": 50594177, "body": "Yes but it doesn&#39;t hurt, and makes me feel warm and fuzzy inside :-)"}], "tags": [], "owner": {"reputation": 1660, "user_id": 1911199, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/02d88411e93d397468c660cb16b2be6a?s=128&d=identicon&r=PG", "display_name": "oppassum", "link": "https://stackoverflow.com/users/1911199/oppassum"}, "is_accepted": true, "score": 11, "last_activity_date": 1577310344, "last_edit_date": 1577310344, "creation_date": 1436382847, "answer_id": 31301674, "question_id": 31301634, "link": "https://stackoverflow.com/questions/31301634/c-sql-create-one-connection-and-open-and-close-for-each-query/31301674#31301674", "title": "C# sql create one connection and open and close for each query", "body": "<p>Either one of these are acceptable.  A <code>SqlConnection</code> uses a connection-pool so it shouldn't affect performance much.  Having multiple <code>SqlConnection</code> objects isn't going to hurt anything.  This comes down to a preference.</p>\n\n<p>I would suggest encapsulating the commands in a <code>using</code> statement if you keep the connections inside the methods, such as:</p>\n\n<pre><code>using (SqlConnection conn = new SqlConnection(...))\n{\n    conn.Open();\n    //commands\n    conn.Close();\n}\n</code></pre>\n\n<p>This ensures proper disposal of the connection.</p>\n"}, {"comments": [{"owner": {"reputation": 2595, "user_id": 117531, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2121f0903b5830478551426da1e80b5b?s=128&d=identicon&r=PG", "display_name": "bobbyalex", "link": "https://stackoverflow.com/users/117531/bobbyalex"}, "edited": false, "score": 0, "creation_date": 1543895694, "post_id": 31303599, "comment_id": 94073070, "body": "The remark regarding the exceptions is incorrect. A using block ensures that Dispose is called on the object even if an exception is thrown. <a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/yh598w02(v=vs.100)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/visualstudio/&hellip;</a>"}], "tags": [], "owner": {"reputation": 79, "user_id": 3192174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P3lyV.png?s=128&g=1", "display_name": "Zohar Israel", "link": "https://stackoverflow.com/users/3192174/zohar-israel"}, "is_accepted": false, "score": 2, "last_activity_date": 1436389108, "creation_date": 1436389108, "answer_id": 31303599, "question_id": 31301634, "link": "https://stackoverflow.com/questions/31301634/c-sql-create-one-connection-and-open-and-close-for-each-query/31303599#31303599", "title": "C# sql create one connection and open and close for each query", "body": "<p>It is important that you keep the connection open for the <strong>shortest possible time</strong>.\nSQL connection is using a <a href=\"https://msdn.microsoft.com/en-us/library/8xx3tyca(v=vs.110).aspx\" rel=\"nofollow\">connection pool</a> so opening a connection actually reuses a connection behind the scenes.\nIf you keep the connection open your at risk of running into error: 'Parallel transactions are not supported' if you use the method <a href=\"https://msdn.microsoft.com/en-us/library/8aht5dh7(v=vs.110).aspx\" rel=\"nofollow\">BeginTransaction</a>.</p>\n\n<p>This being a web app with a potentially large number of connections, \nleaving the connection object open longer puts you in risk of exhausting the connection pool and getting: 'The timeout period elapsed prior to obtaining a connection from the pool' error.</p>\n\n<p>Additionally, you must make sure the connection is closed even if an exception is thrown.</p>\n\n<p>This should be done with a using block like:</p>\n\n<pre><code>using (SqlConnection conn = new SqlConnection(...))\n{\n    conn.Open();\n    //commands\n}\n</code></pre>\n\n<p>since exiting a 'using' block calls .Dispose() on the used object.</p>\n\n<p>or with a try / catch / finally block like:</p>\n\n<pre><code>SqlConnection conn = null;\n\ntry\n{\n    conn = new SqlConnection(...);    \n    conn.Open();\n    //commands\n}\ncatch(Exception ex)\n{\n    ...\n}\nfinally\n{\n    if(conn != null)\n        conn.Close();\n}\n</code></pre>\n"}], "owner": {"reputation": 1760, "user_id": 2900738, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/7a55544fe5771efc63ef8d5f94e9e111?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/2900738/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6117, "favorite_count": 1, "accepted_answer_id": 31301674, "answer_count": 2, "score": 5, "last_activity_date": 1577310344, "creation_date": 1436382676, "last_edit_date": 1436384943, "question_id": 31301634, "link": "https://stackoverflow.com/questions/31301634/c-sql-create-one-connection-and-open-and-close-for-each-query", "title": "C# sql create one connection and open and close for each query", "body": "<p>I recently inherited a C# Web app that creates a new connection for every query like so:</p>\n\n<pre><code>public class QueryForm\n{\n    public bool getStudents()\n    {\n        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"conn\"].ConnectionString);\n        conn.Open();\n        //commands\n        conn.Close();\n    }\n\n    protected void getProfessors()\n    {\n        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"conn\"].ConnectionString);\n        conn.Open();\n        //Commands\n        conn.Close();\n    }\n\n\n    protected void getProfessors()\n    {\n        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"conn\"].ConnectionString);\n        conn.Open();\n        //Commands\n        conn.Close();\n    }\n}\n</code></pre>\n\n<p>I understand that this is typically the best way to do it, but is it acceptable or \"best practice\" to have the constructor create the connection object, and then have each method/Query open and then close that connection like so:</p>\n\n<pre><code>public class QueryForm\n{\n    SqlConnection conn;\n\n    public QueryForm()\n    {\n        conn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"conn\"].ConnectionString);\n    }\n\n    public bool getStudents()\n    {\n        conn.Open();\n        //commands\n        conn.Close();\n    }\n\n    protected void getProfessors()\n    {\n        conn.Open();\n        //Commands\n        conn.Close();\n    }\n\n    protected void getCourses()\n    {\n        conn.Open();\n        //Commands\n        conn.Close();\n    }\n}\n</code></pre>\n\n<p>I prefer the second way as it does not make multiple connection objects. However, the first way would also be preferable if I were to make the methods and class static.</p>\n"}, {"tags": ["c#", "wpf", "data-binding", "custom-controls", "dependency-properties"], "answers": [{"comments": [{"owner": {"reputation": 1443, "user_id": 2040460, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/E01x5.png?s=128&g=1", "display_name": "kformeck", "link": "https://stackoverflow.com/users/2040460/kformeck"}, "edited": false, "score": 0, "creation_date": 1436798843, "post_id": 31302488, "comment_id": 50749719, "body": "Thanks for the response but after adding the property changed listener to the SelectedGelPakProperty, the view models property still does not update."}], "tags": [], "owner": {"reputation": 3243, "user_id": 2396510, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/w9K3z.gif?s=128&g=1", "display_name": "Maximus", "link": "https://stackoverflow.com/users/2396510/maximus"}, "is_accepted": false, "score": 0, "last_activity_date": 1436386526, "last_edit_date": 1436386526, "creation_date": 1436385418, "answer_id": 31302488, "question_id": 31301626, "link": "https://stackoverflow.com/questions/31301626/issues-binding-selecteditem-of-combobox-in-a-customcontrol-using-dependencyprope/31302488#31302488", "title": "Issues Binding SelectedItem of ComboBox in a CustomControl using DependencyProperty", "body": "<p>You do not specify any action to assign when SelectedGelPak changes its value\n(only <em>FrameworkPropertyMetadataOptions.BindsTwoWayByDefault</em>).\nAdd  </p>\n\n<pre><code>new FrameworkPropertyMetadata(null, OnSelectedGelPakChanged));\n</code></pre>\n\n<p>and in this method assign SelectedGelPak to gpSelector.SelectedItem</p>\n\n<p><strong>EDIT</strong>: <br/>\nHonestly, your code looks nasty since you placed in one class both visual declaration and logic. You have .xaml file to declare how your class looks like and .xaml.cs for some logic. Separate then them as follows:</p>\n\n<p>XAML:</p>\n\n<pre><code>&lt;StackPanel Name=\"MainPanel\"&gt;\n    &lt;ComboBox SelectedItem=\"{Binding SelectedGelPak}\"\n              ItemsSource=\"{Binding GelPakSource}\"/&gt;\n    &lt;TextBox Text=\"{Binding Location}\"/&gt;\n    &lt;Button Command=\"{Binding SaveCommand}\"/&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>.XAML.CS:</p>\n\n<pre><code>  public static readonly DependencyProperty SelectedGelPakProperty =\n    DependencyProperty.Register(\n        \"SelectedGelPak\",\n        typeof(object),\n        typeof(GelPakPickerOverlay),\n        new FrameworkPropertyMetadata(\n            null, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));\npublic static readonly DependencyProperty LocationProperty =\n    DependencyProperty.Register(\n        \"Location\",\n        typeof(string),\n        typeof(GelPakPickerOverlay),\n        new FrameworkPropertyMetadata(string.Empty, OnLocationChanged));\npublic static readonly DependencyProperty GelPakSourceProperty =\n    DependencyProperty.Register(\n        \"GelPakSource\",\n        typeof(IEnumerable),\n        typeof(GelPakPickerOverlay),\n        new FrameworkPropertyMetadata(null, OnGelPakSourceChanged));\npublic static readonly DependencyProperty SaveCommandProperty =\n    DependencyProperty.Register(\n        \"SaveCommand\",\n        typeof(ICommand),\n        typeof(GelPakPickerOverlay),\n        new FrameworkPropertyMetadata(null, OnSaveCommandChanged));\n\npublic GelPakPickerOverlay()\n{\n    this.MainPanel.DataContext = this;\n}\n\npublic object SelectedGelPak\n{\n    get { return GetValue(SelectedGelPakProperty); }\n    set { SetValue(SelectedGelPakProperty, value); }\n}\npublic string Location\n{\n    get { return GetValue(LocationProperty).ToString(); }\n    set { SetValue(LocationProperty, value); }\n}\npublic IEnumerable GelPakSource\n{\n    get { return (IEnumerable) GetValue(GelPakSourceProperty); }\n    set { SetValue(GelPakSourceProperty, value); }\n}\npublic ICommand SaveCommand\n{\n    get { return (ICommand) GetValue(SaveCommandProperty); }\n    set { SetValue(SaveCommandProperty, value); }\n}\n}\n</code></pre>\n\n<p>Crucial in this case is constructor. Your StackPanel's DataContext points to your code-behind file so elements within StackPanel have effortless access to declared Dependency Properties but in turn DataContext of the whole GelPakPickerOverlay still bases on parent's so nothing has changed. Try it.</p>\n"}, {"comments": [{"owner": {"reputation": 1443, "user_id": 2040460, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/E01x5.png?s=128&g=1", "display_name": "kformeck", "link": "https://stackoverflow.com/users/2040460/kformeck"}, "edited": false, "score": 0, "creation_date": 1436803636, "post_id": 31388023, "comment_id": 50753156, "body": "I have tried this already and it doesn&#39;t work.  Is there any more code that I should post that could help you out?"}, {"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "reply_to_user": {"reputation": 1443, "user_id": 2040460, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/E01x5.png?s=128&g=1", "display_name": "kformeck", "link": "https://stackoverflow.com/users/2040460/kformeck"}, "edited": false, "score": 0, "creation_date": 1436804804, "post_id": 31388023, "comment_id": 50753904, "body": "See the edited answer. <code>AncestorType=Border</code> should also work."}], "tags": [], "owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1436804779, "last_edit_date": 1436804779, "creation_date": 1436802958, "answer_id": 31388023, "question_id": 31301626, "link": "https://stackoverflow.com/questions/31301626/issues-binding-selecteditem-of-combobox-in-a-customcontrol-using-dependencyprope/31388023#31388023", "title": "Issues Binding SelectedItem of ComboBox in a CustomControl using DependencyProperty", "body": "<p>The <code>SelectedGelPak</code> binding should be two-way.</p>\n\n<p>Either you set the <code>Binding.Mode</code> property, like</p>\n\n<pre><code>SelectedGelPak=\"{Binding GelPakPickerViewModel.SelectedGelPak, Mode=TwoWay}\"\n</code></pre>\n\n<p>or you make the <code>SelectedGelPak</code> property bind two-way by default, by setting the corresponding flag in the property metadata:</p>\n\n<pre><code>public static readonly DependencyProperty SelectedGelPakProperty =\n    DependencyProperty.Register(\n        \"SelectedGelPak\",\n        typeof(object),\n        typeof(GelPakPickerOverlay),\n        new FrameworkPropertyMetadata(\n            null,\n            FrameworkPropertyMetadataOptions.BindsTwoWayByDefault)); // here\n</code></pre>\n\n<hr>\n\n<p>EDIT: Instead of having a PropertyChangedCallback (<code>OnSelectedGelPakChanged</code>), you may now directly bind the <code>SelectedItem</code> property of the internal ComboBox to the <code>SelectedGelPak</code> property:</p>\n\n<pre><code>&lt;ComboBox ... SelectedItem=\"{Binding SelectedGelPak,\n    RelativeSource={RelativeSource AncestorType=local:GelPakPickerOverlay}}\"/&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9221, "user_id": 2018357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l8gp3.jpg?s=128&g=1", "display_name": "Grx70", "link": "https://stackoverflow.com/users/2018357/grx70"}, "edited": false, "score": 1, "creation_date": 1436812906, "post_id": 31389034, "comment_id": 50758617, "body": "I think you&#39;ve diagnosed the problem correctly, although I think your solution won&#39;t actually work - setting <code>SelectedGetPak</code> directly calls the <code>SetValue</code> method in the setter, which clears the existing binding on the property (that is the one that binds to the view model property). To maintain the binding and update the value one should call <code>SetCurrentValue(SelectedGelPakProperty, gpSelector.SelectedItem)</code>."}, {"owner": {"reputation": 1443, "user_id": 2040460, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/E01x5.png?s=128&g=1", "display_name": "kformeck", "link": "https://stackoverflow.com/users/2040460/kformeck"}, "edited": false, "score": 0, "creation_date": 1436812915, "post_id": 31389034, "comment_id": 50758627, "body": "Thank you good sir, you&#39;re answer works perfectly!  I will award you the 50 point bounty in 20 hours when stackoverflow lets me."}, {"owner": {"reputation": 4518, "user_id": 967254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b7af7beaff77cc9ceca61d1a2bb1cd?s=128&d=identicon&r=PG", "display_name": "almulo", "link": "https://stackoverflow.com/users/967254/almulo"}, "reply_to_user": {"reputation": 9221, "user_id": 2018357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l8gp3.jpg?s=128&g=1", "display_name": "Grx70", "link": "https://stackoverflow.com/users/2018357/grx70"}, "edited": false, "score": 0, "creation_date": 1436862586, "post_id": 31389034, "comment_id": 50777330, "body": "@Grx70 If the Binding is set to <code>Mode=TwoWay</code> (like in this case), then <code>SetValue</code> doesn&#39;t clear it. But yes, in general, <code>SetCurrentValue</code> is more advisable. I&#39;ll edit the answer to reflect that."}], "tags": [], "owner": {"reputation": 4518, "user_id": 967254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b7af7beaff77cc9ceca61d1a2bb1cd?s=128&d=identicon&r=PG", "display_name": "almulo", "link": "https://stackoverflow.com/users/967254/almulo"}, "is_accepted": true, "score": 2, "last_activity_date": 1436862638, "last_edit_date": 1436862638, "creation_date": 1436806168, "answer_id": 31389034, "question_id": 31301626, "link": "https://stackoverflow.com/questions/31301626/issues-binding-selecteditem-of-combobox-in-a-customcontrol-using-dependencyprope/31389034#31389034", "title": "Issues Binding SelectedItem of ComboBox in a CustomControl using DependencyProperty", "body": "<p>You're listening to changes on the property of your ViewModel, but that's just one of the ways in which the data is flowing. You need to listen to changes in the view, in your Combo.</p>\n\n<p>To do so, subscribe to its <code>SelectionChanged</code> event like this:</p>\n\n<pre><code>gpSelector = new ComboBox();\ngpSelector.Width = 100;\ngpSelector.Margin = new Thickness(10);\ngpSelector.HorizontalAlignment = HorizontalAlignment.Left;\ngpSelector.VerticalAlignment = VerticalAlignment.Center;\ngpSelector.SelectionChanged += OnGpSelectorSelectionChanged;\n</code></pre>\n\n<p>And then in your event handler, change the value of your DependencyProperty accordingly:</p>\n\n<pre><code>private void OnGpSelectorSelectionChanged(object sender, SelectionChangedEventArgs e)\n{\n    SetCurrentValue(SelectedGelPakProperty, gpSelector.SelectedItem);\n}\n</code></pre>\n\n<p>This way you're supporting the two-way communication between ViewModel and Control.</p>\n"}], "owner": {"reputation": 1443, "user_id": 2040460, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/E01x5.png?s=128&g=1", "display_name": "kformeck", "link": "https://stackoverflow.com/users/2040460/kformeck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "accepted_answer_id": 31389034, "answer_count": 3, "score": 1, "last_activity_date": 1436862638, "creation_date": 1436382645, "last_edit_date": 1436798803, "question_id": 31301626, "link": "https://stackoverflow.com/questions/31301626/issues-binding-selecteditem-of-combobox-in-a-customcontrol-using-dependencyprope", "title": "Issues Binding SelectedItem of ComboBox in a CustomControl using DependencyProperty", "body": "<p>I am creating a custom control in WPF that contains a text box, image button and a combo box.  I am able to get everything to layout correctly and all the bindings work with everything except for the SelectedItem of the combo box.</p>\n\n<p>Here is the custom control code:</p>\n\n<pre><code>public class GelPakPickerOverlay : Border\n{\n    public static readonly DependencyProperty SelectedGelPakProperty =\n        DependencyProperty.Register(\n            \"SelectedGelPak\",\n            typeof(object),\n            typeof(GelPakPickerOverlay),\n            new FrameworkPropertyMetadata(\n                null, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault));\n    public static readonly DependencyProperty LocationProperty =\n        DependencyProperty.Register(\n            \"Location\",\n            typeof(string),\n            typeof(GelPakPickerOverlay),\n            new FrameworkPropertyMetadata(string.Empty, OnLocationChanged));\n    public static readonly DependencyProperty GelPakSourceProperty =\n        DependencyProperty.Register(\n            \"GelPakSource\",\n            typeof(IEnumerable),\n            typeof(GelPakPickerOverlay),\n            new FrameworkPropertyMetadata(null, OnGelPakSourceChanged));\n    public static readonly DependencyProperty SaveCommandProperty =\n        DependencyProperty.Register(\n            \"SaveCommand\",\n            typeof(ICommand),\n            typeof(GelPakPickerOverlay),\n            new FrameworkPropertyMetadata(null, OnSaveCommandChanged));\n    private static ComboBox gpSelector;\n    private static TextBox gpLocation;\n    private static Button saveButton;\n\n    public GelPakPickerOverlay()\n    {\n        Height = 98;\n\n        gpSelector = new ComboBox();\n        gpSelector.Width = 100;\n        gpSelector.Margin = new Thickness(10);\n        gpSelector.HorizontalAlignment = HorizontalAlignment.Left;\n        gpSelector.VerticalAlignment = VerticalAlignment.Center;\n\n        Grid grid = new Grid();\n        grid.ColumnDefinitions.Add(new ColumnDefinition());\n        ColumnDefinition def = new ColumnDefinition();\n        def.Width = new GridLength(40);\n        grid.ColumnDefinitions.Add(def);\n\n        gpLocation = new TextBox();\n        gpLocation.Style = (Style) FindResource(\"TextBoxStyleBase\");\n        gpLocation.Width = 70;\n        gpLocation.Margin = new Thickness(10);\n        gpLocation.HorizontalAlignment = HorizontalAlignment.Left;\n        gpLocation.VerticalAlignment = VerticalAlignment.Center;\n        Grid.SetColumn(gpLocation, 0);\n\n        saveButton = new Button();\n        saveButton.Style = (Style) FindResource(\"SaveButton\");\n        saveButton.Margin = new Thickness(0, 10, 10, 10);\n        saveButton.HorizontalAlignment = HorizontalAlignment.Center;\n        Grid.SetColumn(saveButton, 1);\n\n        grid.Children.Add(gpLocation);\n        grid.Children.Add(saveButton);\n\n        StackPanel mainChild = new StackPanel();\n        mainChild.Orientation = Orientation.Vertical;\n        mainChild.Children.Add(gpSelector);\n        mainChild.Children.Add(grid);\n\n        Child = mainChild;\n    }\n\n    public object SelectedGelPak\n    {\n        get { return GetValue(SelectedGelPakProperty); }\n        set { SetValue(SelectedGelPakProperty, value); }\n    }\n    public string Location\n    {\n        get { return GetValue(LocationProperty).ToString(); }\n        set { SetValue(LocationProperty, value); }\n    }\n    public IEnumerable GelPakSource\n    {\n        get { return (IEnumerable) GetValue(GelPakSourceProperty); }\n        set { SetValue(GelPakSourceProperty, value); }\n    }\n    public ICommand SaveCommand\n    {\n        get { return (ICommand) GetValue(SaveCommandProperty); }\n        set { SetValue(SaveCommandProperty, value); }\n    }\n\n    private static void OnLocationChanged(\n        DependencyObject source, DependencyPropertyChangedEventArgs e)\n    {\n        if (gpLocation != null)\n        {\n            gpLocation.Text = e.NewValue.ToString();\n        }\n    }\n    private static void OnGelPakSourceChanged(\n        DependencyObject source, DependencyPropertyChangedEventArgs e)\n    {\n        if (gpSelector != null)\n        {\n            gpSelector.ItemsSource = (IEnumerable) e.NewValue;\n        }\n    }\n    private static void OnSaveCommandChanged(\n        DependencyObject source, DependencyPropertyChangedEventArgs e)\n    {\n        if (saveButton != null)\n        {\n            saveButton.Command = (ICommand) e.NewValue;\n        }\n    }\n}\n</code></pre>\n\n<p>This is how it is referenced in the main window:</p>\n\n<pre><code>    &lt;ctl:GelPakPickerOverlay\n        Width=\"132\"\n        DockPanel.Dock=\"Right\"\n        VerticalAlignment=\"Bottom\"\n        Background=\"{StaticResource primaryBrush}\"\n        BorderBrush=\"{StaticResource accentBrushOne}\"\n        BorderThickness=\"2,2,0,0\"\n        Visibility=\"{\n            Binding GelPakPickerViewModel.IsPickerVisible,\n            Converter={StaticResource BoolToHiddenVisConverter},\n            FallbackValue=Visible}\"\n        GelPakSource=\"{Binding GelPakPickerViewModel.GelPakList}\"\n        SelectedGelPak=\"{Binding GelPakPickerViewModel.SelectedGelPak}\"\n        Location=\"{Binding GelPakPickerViewModel.GelPakLocation, UpdateSourceTrigger=LostFocus}\"\n        SaveCommand=\"{Binding GelPakPickerViewModel.UpdateGpDataCommand}\"/&gt;\n</code></pre>\n\n<p>The data context of this window is MainWindowViewModel which has a GelPakPickerViewModel property which all of the bindings are hooked up to.  The \"Location\", \"GelPakSource\" and \"SaveCommand\" properties all work correctly and routes everything to the GelPakPickerViewModel the way I expect.  However, when you select anything from the combo box, it never actually makes it into the GelPakViewModels SelectedGelPak property (which is of type GelPak).</p>\n\n<p>What is going on here?  Does anyone have any suggestions to fix this issue?!?</p>\n\n<p><strong>EDIT: I added a property changed event listener to the SelectedGelPakProperty like this:</strong></p>\n\n<pre><code>    public static readonly DependencyProperty SelectedGelPakProperty =\n        DependencyProperty.Register(\n            \"SelectedGelPak\",\n            typeof(object),\n            typeof(GelPakPickerOverlay),\n            new FrameworkPropertyMetadata(null, OnSelectedGelPakChanged));\n\n    ........\n\n    private static void OnSelectedGelPakChanged(\n        DependencyObject source, DependencyPropertyChangedEventArgs e)\n    {\n        if (gpLocation != null)\n        {\n            gpSelector.SelectedItem = e.NewValue;\n        }\n    }\n</code></pre>\n\n<p>but this still doesn't actually change the SelectedGelPak object in the view model.</p>\n"}, {"tags": ["c#", ".net", "dependency-injection", "typeconverter"], "answers": [{"comments": [{"owner": {"reputation": 1722, "user_id": 1480946, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e87530abcbb61636ac0b5197e3848b8b?s=128&d=identicon&r=PG", "display_name": "Jake Smith", "link": "https://stackoverflow.com/users/1480946/jake-smith"}, "edited": false, "score": 2, "creation_date": 1454697205, "post_id": 31546356, "comment_id": 58176726, "body": "Don&#39;t you have to implement the rest of the interface?"}, {"owner": {"reputation": 6371, "user_id": 55721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2fd1ee46d378a04d8a40d4ea36f6668e?s=128&d=identicon&r=PG", "display_name": "dss539", "link": "https://stackoverflow.com/users/55721/dss539"}, "reply_to_user": {"reputation": 1722, "user_id": 1480946, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/e87530abcbb61636ac0b5197e3848b8b?s=128&d=identicon&r=PG", "display_name": "Jake Smith", "link": "https://stackoverflow.com/users/1480946/jake-smith"}, "edited": false, "score": 2, "creation_date": 1454698271, "post_id": 31546356, "comment_id": 58177337, "body": "@Jake Smith Yes you do, but those fields can just return null. See the note at <a href=\"https://msdn.microsoft.com/en-us/library/system.componentmodel.itypedescriptorcontext(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6371, "user_id": 55721, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2fd1ee46d378a04d8a40d4ea36f6668e?s=128&d=identicon&r=PG", "display_name": "dss539", "link": "https://stackoverflow.com/users/55721/dss539"}, "is_accepted": false, "score": 1, "last_activity_date": 1437501579, "creation_date": 1437501579, "answer_id": 31546356, "question_id": 31301522, "link": "https://stackoverflow.com/questions/31301522/dependency-injection-with-typeconverters/31546356#31546356", "title": "Dependency Injection with TypeConverters", "body": "<p>The <code>context</code> argument is the intended injection point.</p>\n\n<p>Create a class like this:</p>\n\n<pre><code>class SheathingContext : ITypeDescriptorContext\n{\n    public List&lt;Sheathing&gt; AvailableSheathings \n    {\n        get { return SettingsController.AvailableSheathings; }\n    }\n}\n</code></pre>\n\n<p>Then pass it as the <code>context</code> to the type converter.\nIn the type converter, you can use <code>((SheathingContext)context).AvailableSheathings</code> for your list.</p>\n"}], "owner": {"reputation": 3909, "user_id": 2757398, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/D7ZKF.jpg?s=128&g=1", "display_name": "Nick Gilbert", "link": "https://stackoverflow.com/users/2757398/nick-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 2, "answer_count": 1, "score": 10, "last_activity_date": 1437501579, "creation_date": 1436382272, "last_edit_date": 1436392770, "question_id": 31301522, "link": "https://stackoverflow.com/questions/31301522/dependency-injection-with-typeconverters", "title": "Dependency Injection with TypeConverters", "body": "<p>I have an application I'm designing which references a library that I'm also designing. Specifically, the application needs to make instances of my Sheathing class which is defined in my lower level library. </p>\n\n<pre><code>[TypeConverter(typeof(SheathingOptionsConverter))]\npublic class Sheathing : Lumber\n{\n    public string Description { get; set; }\n\n    public Sheathing(string passedDescription)\n    {\n        Description = passedDescription;\n    }\n}\n</code></pre>\n\n<p>My application lists different sheathing options in a properties grid. Because it lists them in a drop down menu I had to extend the ExpandableObjectConverter twice. The first level down is my SheathingObjectConverter which properly displays a single Sheathing object</p>\n\n<pre><code>public class SheathingObjectConverter : ExpandableObjectConverter\n{\n    public override bool CanConvertTo(ITypeDescriptorContext context, Type destinationType)\n    {\n        if (destinationType == typeof(Sheathing))\n        {\n            return true;\n        }\n        return base.CanConvertTo(context, destinationType);\n    }\n\n    public override bool CanConvertFrom(ITypeDescriptorContext context, Type sourceType)\n    {\n        if (sourceType == typeof(string))\n        {\n            return true;\n        }\n        return base.CanConvertFrom(context, sourceType);\n    }\n\n    public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, System.Type destinationType)\n    {\n        if (destinationType == typeof(System.String) &amp;&amp; value is Sheathing)\n        {\n            Sheathing s = (Sheathing)value;\n            return \"Description: \" + s.Description;\n        }\n        return base.ConvertTo(context, culture, value, destinationType);\n    }\n\n    public override object ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, object value)\n    {\n        if (value is string)\n        {\n            try\n            {\n                string description = (string)value;\n                Sheathing s = new Sheathing(description);\n                return s;\n            }\n            catch\n            {\n                throw new ArgumentException(\"Can not convert '\" + (string)value + \"' to type Sheathing\");\n            }\n        }\n        return base.ConvertFrom(context, culture, value);\n    }\n}\n</code></pre>\n\n<p>And the second level down extends SheathingObjectConverter to display a list of Sheathing objects as a drop-down menu in a property grid</p>\n\n<pre><code>public class SheathingOptionsConverter : SheathingObjectConverter\n{\n    /// &lt;summary&gt;\n    /// Override the GetStandardValuesSupported method and return true to indicate that this object supports a standard set of values that can be picked from a list\n    /// &lt;/summary&gt;\n    public override bool GetStandardValuesSupported(ITypeDescriptorContext context)\n    {\n        return true;\n    }\n\n    /// &lt;summary&gt;\n    /// Override the GetStandardValues method and return a StandardValuesCollection filled with your standard values\n    /// &lt;/summary&gt;\n    public override StandardValuesCollection GetStandardValues(ITypeDescriptorContext context)\n    {\n        List&lt;Sheathing&gt; sheathingDescriptions = SettingsController.AvailableSheathings; //ToDo: Fix needing a list from the application (higher level)\n        return new StandardValuesCollection(sheathingDescriptions.ToArray());\n    }\n}\n</code></pre>\n\n<p>Here lies the problem; all the code above is in my lower level library but SettingsController is a class in my higher level application because thats where the list of sheathings is defined. Normally this problem could be solved with dependency injection but because this deals with typeconverters I am not sure if it is possible to use dependency injection. I'm not sure how to fix this issue</p>\n"}, {"tags": ["c#", "httppostedfile"], "comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1436382180, "post_id": 31301448, "comment_id": 50593047, "body": "You&#39;ll probably have to write your own conversion code."}, {"owner": {"reputation": 7706, "user_id": 1955346, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8qnQY.png?s=128&g=1", "display_name": "Marcin Zablocki", "link": "https://stackoverflow.com/users/1955346/marcin-zablocki"}, "edited": false, "score": 1, "creation_date": 1436387560, "post_id": 31301448, "comment_id": 50596301, "body": "This topic was discussed here:    <a href=\"http://stackoverflow.com/questions/1920977/creating-an-instance-of-httppostedfile-with-reflection\" title=\"creating an instance of httppostedfile with reflection\">stackoverflow.com/questions/1920977/&hellip;</a>    and    <a href=\"http://stackoverflow.com/questions/5514715/how-to-instantiate-a-httppostedfile\" title=\"how to instantiate a httppostedfile\">stackoverflow.com/questions/5514715/&hellip;</a>"}, {"owner": {"reputation": 661, "user_id": 339323, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b355188979ee2e835e1dceca91105c5b?s=128&d=identicon&r=PG", "display_name": "pessi", "link": "https://stackoverflow.com/users/339323/pessi"}, "edited": false, "score": 0, "creation_date": 1436562607, "post_id": 31301448, "comment_id": 50683742, "body": "2nd link solved the problem. Thank you."}], "owner": {"reputation": 661, "user_id": 339323, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b355188979ee2e835e1dceca91105c5b?s=128&d=identicon&r=PG", "display_name": "pessi", "link": "https://stackoverflow.com/users/339323/pessi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1436382183, "creation_date": 1436382051, "last_edit_date": 1436382183, "question_id": 31301448, "link": "https://stackoverflow.com/questions/31301448/localfile-cast-as-httppostedfile", "title": "LocalFile cast as httppostedfile", "body": "<p>I have a dll to which I have no source code. This has a method that accepts httppostedfile as an input. I wanted to pass a local file stream to this method.</p>\n\n<p>Is it possible somehow to convert the local file stream or bytes to httppostedfile format? An explicit castings does not work.</p>\n"}, {"tags": ["c#", "visual-studio-2015", "win-universal-app", "windows-10"], "comments": [{"owner": {"reputation": 886, "user_id": 4753834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BazXc.png?s=128&g=1", "display_name": "JimiLoe", "link": "https://stackoverflow.com/users/4753834/jimiloe"}, "edited": false, "score": 0, "creation_date": 1436382561, "post_id": 31301440, "comment_id": 50593311, "body": "What have tried so far? Can you show some code?"}, {"owner": {"reputation": 3, "user_id": 5095452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oHqJx1A9XLA/AAAAAAAAAAI/AAAAAAAAAFA/7vSFOE1HwL8/photo.jpg?sz=128", "display_name": "14 24", "link": "https://stackoverflow.com/users/5095452/14-24"}, "reply_to_user": {"reputation": 886, "user_id": 4753834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BazXc.png?s=128&g=1", "display_name": "JimiLoe", "link": "https://stackoverflow.com/users/4753834/jimiloe"}, "edited": false, "score": 0, "creation_date": 1436382958, "post_id": 31301440, "comment_id": 50593559, "body": "@JimiLoe I&#39;ve tried to use a function which download the WebPage of the webview and it searchs if the information for change the page is in but it&#39;s really complicated and it can&#39;t be done for page which require login access. It would be great if a WebPage could trigger a C# function or something like that."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5095452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oHqJx1A9XLA/AAAAAAAAAAI/AAAAAAAAAFA/7vSFOE1HwL8/photo.jpg?sz=128", "display_name": "14 24", "link": "https://stackoverflow.com/users/5095452/14-24"}, "edited": false, "score": 0, "creation_date": 1436607526, "post_id": 31332735, "comment_id": 50693184, "body": "It&#39;s exactly what I need, Thanks !"}], "tags": [], "owner": {"reputation": 21144, "user_id": 4068779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0Hsj.png?s=128&g=1", "display_name": "Rob Caplan - MSFT", "link": "https://stackoverflow.com/users/4068779/rob-caplan-msft"}, "is_accepted": true, "score": 0, "last_activity_date": 1436504152, "creation_date": 1436504152, "answer_id": 31332735, "question_id": 31301440, "link": "https://stackoverflow.com/questions/31301440/change-the-xaml-page-based-on-the-content-of-the-webview/31332735#31332735", "title": "Change the XAML Page based on the content of the webview", "body": "<p>Assuming you control the page and the page has permission to raise notifications (i.e. generated from the app with NavigateToString or https and in \n<a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/br211416.aspx\" rel=\"nofollow\">ApplicationContentUriRules</a>. See <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/hh849625.aspx#validate_the_origin_of_invokescriptasync_and_postmessage_data\" rel=\"nofollow\">Developing secure apps</a>), the JavaScript in your page can call window.external.notify to trigger a <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.scriptnotify.aspx\" rel=\"nofollow\">WebView.ScriptNotify</a> event. The Xaml page can subscribe to ScriptNotify and navigate in response to that notification.</p>\n\n<p>If you just want to follow navigation within the WebView you can listen to the WebView.<a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.aspx\" rel=\"nofollow\">NavigationStarting</a> (etc.) events and trigger Xaml code based on that.</p>\n"}], "owner": {"reputation": 3, "user_id": 5095452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oHqJx1A9XLA/AAAAAAAAAAI/AAAAAAAAAFA/7vSFOE1HwL8/photo.jpg?sz=128", "display_name": "14 24", "link": "https://stackoverflow.com/users/5095452/14-24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 31332735, "answer_count": 1, "score": 0, "last_activity_date": 1436504152, "creation_date": 1436382018, "last_edit_date": 1436382280, "question_id": 31301440, "link": "https://stackoverflow.com/questions/31301440/change-the-xaml-page-based-on-the-content-of-the-webview", "title": "Change the XAML Page based on the content of the webview", "body": "<p>I have an Windows 10 Universal App (C#), and I don't find how I can change to another XAML page if the webview said to change the page. </p>\n\n<p>Thanks !</p>\n"}, {"tags": ["c#", ".net", "reflection", ".net-assembly", "unmanaged"], "comments": [{"owner": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "edited": false, "score": 5, "creation_date": 1436382014, "post_id": 31301381, "comment_id": 50592956, "body": "sorry to say but reflection works only on the managed code ..."}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1436382359, "post_id": 31301381, "comment_id": 50593171, "body": "There&#39;s an old tool called DUMPBIN that lets you do quite a bit of lurking inside an unamanged executable, but it&#39;s not a programmatic interface. It might <i>leverage</i> some existing interfaces you could try once you determine a given exe isn&#39;t managed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5095320"}, "reply_to_user": {"reputation": 163341, "user_id": 314488, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aYzi5.jpg?s=128&g=1", "display_name": "Pranay Rana", "link": "https://stackoverflow.com/users/314488/pranay-rana"}, "edited": false, "score": 0, "creation_date": 1436386296, "post_id": 31301381, "comment_id": 50595543, "body": "@PranayRana I understand that reflection only works on managed code, however is there a way to apply some sort of wrapper around unmanaged code to make it &quot;appear&quot; to be managed?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5095320"}, "edited": false, "score": 0, "creation_date": 1436389282, "post_id": 31301381, "comment_id": 50597172, "body": "I guess a way to put it would be whereas Platform Invoke allows managed code access to functions in unmanaged assemblies given the function signature is redeclared in the managed code, what I&#39;m looking for is a way just to get a string representing the signature in the unmanaged code, given the name of the assembly (So I don&#39;t even need the functionality that P/Invoke allows, just what gets supplied to it)."}, {"owner": {"reputation": 41122, "user_id": 2101267, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06383b51463f855d7cc0f07d4566bd42?s=128&d=identicon&r=PG", "display_name": "Dark Falcon", "link": "https://stackoverflow.com/users/2101267/dark-falcon"}, "edited": false, "score": 0, "creation_date": 1436443639, "post_id": 31301381, "comment_id": 50621209, "body": "Can&#39;t be done. The only place that info would be available is in the debug information or in the original source. Native code has no concept of signature, only of a symbol name. The caller is expected to know the signature. Now if it is C++, the symbol name may be mangled to include the signature, but anything beyond that is unlikely. The other option is to disassemble the function in a manner similar to IDA Pro or some other tool like that, but even that is imperfect and definitely not trivial."}], "owner": {"user_type": "does_not_exist", "display_name": "user5095320"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 444, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436381836, "creation_date": 1436381836, "question_id": 31301381, "link": "https://stackoverflow.com/questions/31301381/how-can-i-use-reflection-in-c-to-gather-information-from-unmanaged-assemblies-w", "title": "How can I use Reflection in C# to gather information from unmanaged assemblies written in C++/VB?", "body": "<p>I have a project I'm working on in which I parse a .vbp file which contains a list of paths to assemblies and their GUID's (along with other things). The goal in parsing the file is to use the full path of each assembly to load them, and then use Reflection to get information about each assembly such as its interfaces and the methods and properties they define.</p>\n\n<p>Now the code I have so far works just fine on <em>managed</em> assemblies (such as a .exe written in C#), however all of these assemblies that are being loaded are <em>unmanaged</em> C++/VB assemblies. When I try calling:</p>\n\n<pre><code>var assemblyPath = @\"C:\\*path to unmanaged .dll*\";\nvar assemblyObj = Assembly.LoadFrom(assemblyPath);\n</code></pre>\n\n<p>on the unmanaged assemblies, I get a BadImageFormat exception, which is expected since it isn't a managed assembly. I've looked all over for how to go about this but most of the information I've found so far has been asking about actually using the things defined in unmanaged assemblies. In these instances, the solution required knowing information such as the name of a function the User was trying to get from the unmanaged assembly to utilize in their managed application. The only things I know about the assemblies are their paths, names, and that they're unmanaged C++/VB. I don't need to call any functions or <em>use</em> anything from these assemblies, I just need to obtain their information such as the names of their defined interfaces and the signatures of the methods within those interfaces.</p>\n\n<p>Two pages I've found that looked promising are:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa645736(v=vs.71).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa645736(v=vs.71).aspx</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-CA/library/ch59zxfc(v=vs.90).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-CA/library/ch59zxfc(v=vs.90).aspx</a></p>\n\n<p>While I've looked through these, I can't claim to be well-versed in Reflection, or even .NET, and as such I'm not really sure what I should be going with/how to implement what I'm trying to do.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1352, "user_id": 4965962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bfa9bd3b9af517534c8c23baa12593?s=128&d=identicon&r=PG&f=1", "display_name": "fsacer", "link": "https://stackoverflow.com/users/4965962/fsacer"}, "edited": false, "score": 3, "creation_date": 1436382436, "post_id": 31301368, "comment_id": 50593232, "body": "Well it would be helpful if you could show us the <code>Main</code> method. Right off the bat I can see that you are not using any constructors which would help you with creating the objects."}, {"owner": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "reply_to_user": {"reputation": 1352, "user_id": 4965962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bfa9bd3b9af517534c8c23baa12593?s=128&d=identicon&r=PG&f=1", "display_name": "fsacer", "link": "https://stackoverflow.com/users/4965962/fsacer"}, "edited": false, "score": 0, "creation_date": 1436383756, "post_id": 31301368, "comment_id": 50594054, "body": "I&#39;ve added the Main()method.Hope now you will find it useful.Thank you"}, {"owner": {"reputation": 2321, "user_id": 2535356, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8517bb7eb580d6bed728339d79ba5d1d?s=128&d=identicon&r=PG", "display_name": "transporter_room_3", "link": "https://stackoverflow.com/users/2535356/transporter-room-3"}, "edited": false, "score": 1, "creation_date": 1436384391, "post_id": 31301368, "comment_id": 50594430, "body": "I think you are misusing inheritance. You should create two classes ATM and Account. Let ATM keep a list of Accounts and have methods CreateAccount (that adds a new account to the list) and Deposit (that adds funds to an account)."}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1436385076, "post_id": 31301368, "comment_id": 50594887, "body": "Hi! Welcome to StackOverflow. Could you reduce your code example down to a <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">minimal working example</a> that re-creates your problem? This will definitely result in higher quality (and more!) answers."}, {"owner": {"reputation": 1352, "user_id": 4965962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bfa9bd3b9af517534c8c23baa12593?s=128&d=identicon&r=PG&f=1", "display_name": "fsacer", "link": "https://stackoverflow.com/users/4965962/fsacer"}, "edited": false, "score": 0, "creation_date": 1436385962, "post_id": 31301368, "comment_id": 50595357, "body": "@smita Could you have a look at my answer?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "edited": false, "score": 0, "creation_date": 1436385590, "post_id": 31302159, "comment_id": 50595165, "body": "Thank you so much for giving me an answer .This means a lot.So basically you are saying that as i&#39;m creating an object of ATM class a new constructor is getting called and hence creating a new memory."}, {"owner": {"reputation": 1352, "user_id": 4965962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bfa9bd3b9af517534c8c23baa12593?s=128&d=identicon&r=PG&f=1", "display_name": "fsacer", "link": "https://stackoverflow.com/users/4965962/fsacer"}, "reply_to_user": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "edited": false, "score": 0, "creation_date": 1436385892, "post_id": 31302159, "comment_id": 50595329, "body": "@smita Basically you are interpreting account object diffrently as an ATM object with use of a casting."}, {"owner": {"reputation": 1149, "user_id": 3103633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbd88bf9092a48379de11e592474fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Window", "link": "https://stackoverflow.com/users/3103633/window"}, "edited": false, "score": 0, "creation_date": 1436386073, "post_id": 31302159, "comment_id": 50595418, "body": "Yes, take a look at fsacer&#39;s answer as well. My answer is a quick fix to the exact problem you describe, his answer shows how you would properly implement an atm program."}, {"owner": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "edited": false, "score": 0, "creation_date": 1436425484, "post_id": 31302159, "comment_id": 50609176, "body": "tinonw01 answer is not working, it is showing an error.Sorry."}], "tags": [], "owner": {"reputation": 1149, "user_id": 3103633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbd88bf9092a48379de11e592474fbd?s=128&d=identicon&r=PG&f=1", "display_name": "Window", "link": "https://stackoverflow.com/users/3103633/window"}, "is_accepted": false, "score": 1, "last_activity_date": 1436384327, "creation_date": 1436384327, "answer_id": 31302159, "question_id": 31301368, "link": "https://stackoverflow.com/questions/31301368/how-to-create-a-simple-atm-program-in-c-using-inheritance/31302159#31302159", "title": "How to Create a simple atm program in c# using inheritance", "body": "<p>You are creating two different objects: a 'CreateAccount' Object and an 'ATM' object.\nAn ATM object does not automatically inherit the values from a previously created CreateAccount object, they are two completely different, unrelated entities.</p>\n\n<p>So for your ATM object to have the same values that your CreateAccount object has, you would have to copy the CreateAccount object to your ATM object.</p>\n\n<pre><code>CreateAccount account = new CreateAccount();\n//set account variables here\nATM atm = (ATM)account;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "edited": false, "score": 0, "creation_date": 1436386181, "post_id": 31302468, "comment_id": 50595470, "body": "This is absolutely brilliant fsacer.Thank you so much for giving your time on my code from your precious time."}, {"owner": {"reputation": 1352, "user_id": 4965962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bfa9bd3b9af517534c8c23baa12593?s=128&d=identicon&r=PG&f=1", "display_name": "fsacer", "link": "https://stackoverflow.com/users/4965962/fsacer"}, "reply_to_user": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "edited": false, "score": 0, "creation_date": 1436386453, "post_id": 31302468, "comment_id": 50595632, "body": "@smita If this works for you could you please accept as answer with a tick or at least an upvote would be appreciated."}, {"owner": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "edited": false, "score": 0, "creation_date": 1437337019, "post_id": 31302468, "comment_id": 50973901, "body": "Hi fsacer .what&#39;s the point of making the dictionary static??"}, {"owner": {"reputation": 1352, "user_id": 4965962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bfa9bd3b9af517534c8c23baa12593?s=128&d=identicon&r=PG&f=1", "display_name": "fsacer", "link": "https://stackoverflow.com/users/4965962/fsacer"}, "reply_to_user": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "edited": false, "score": 0, "creation_date": 1437416951, "post_id": 31302468, "comment_id": 51008535, "body": "@smita Well that is a consideration. This makes it that you have one <code>AccountList</code> for all the ATMs. You could on the other side without <code>static</code> have a list of accounts which would be able to deposit on only specific ATMs, but I suppose that isn&#39;t the case."}], "tags": [], "owner": {"reputation": 1352, "user_id": 4965962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09bfa9bd3b9af517534c8c23baa12593?s=128&d=identicon&r=PG&f=1", "display_name": "fsacer", "link": "https://stackoverflow.com/users/4965962/fsacer"}, "is_accepted": false, "score": 0, "last_activity_date": 1436386079, "last_edit_date": 1436386079, "creation_date": 1436385357, "answer_id": 31302468, "question_id": 31301368, "link": "https://stackoverflow.com/questions/31301368/how-to-create-a-simple-atm-program-in-c-using-inheritance/31302468#31302468", "title": "How to Create a simple atm program in c# using inheritance", "body": "<p>Here is how it's done with proper use of inheritance which is useless in this case actually. <code>Dictionary</code> is the proper datastructure to use in this case because you can avoid duplicates with it. Also from this code you might want to remove the <code>accountNo</code> from <code>Account</code> class to avoid duplicate numbers being kept and the ask it beffore calling <code>GenerateAccount()</code> method. So this is full console app:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace ATM\n{\n    class Account\n    {\n        string firstName, lastName, dateOfBirth, phoneNO, fathersName, mothersName;\n        double initialBalance; \n        int pinNo, accountNo, age; \n        DateTime yearOfBirth;\n\n        public Account() \n        {\n            pinNo = 100;\n            accountNo = 1234;\n        }\n\n        public string FirstName\n        {\n            get { return this.firstName; }\n            set\n            {\n                if (string.IsNullOrEmpty(value)) throw new Exception();\n                else firstName = value;\n            }\n        }\n        public string LastName\n        {\n            get { return this.lastName; }\n            set\n            {\n                if (string.IsNullOrEmpty(value)) throw new Exception();\n                else lastName = value;\n            }\n        }\n        public string DateOfBirth\n        {\n            get { return this.dateOfBirth; }\n            set\n            {\n                if (string.IsNullOrEmpty(value)) throw new Exception();\n                else dateOfBirth = value;\n            }\n        }\n        public string PhoneNo\n        {\n            get { return this.phoneNO; }\n            set\n            {\n                if ((string.IsNullOrEmpty(value)) || value.Length != 10)\n                    throw new Exception();\n                else\n                    phoneNO = value;\n            }\n        }\n        public string FathersName\n        {\n            get { return this.fathersName; }\n            set\n            {\n                if (string.IsNullOrEmpty(value))\n                    throw new Exception();\n                else\n                    fathersName = value;\n            }\n        }\n        public string MothersName\n        {\n            get { return this.mothersName; }\n            set\n            {\n                if (string.IsNullOrEmpty(value))\n                    throw new Exception();\n                else\n                    mothersName = value;\n            }\n        }\n        public double InititailBalance\n        {\n            get { return this.initialBalance; }\n            set\n            {\n                if (double.IsNaN(value))\n                    throw new Exception();\n\n                else\n                    initialBalance = value;\n            }\n        }\n        public int PinNo\n        {\n            get { return this.pinNo; }\n        }\n        public int AccountNo\n        {\n            get { return this.accountNo; }\n        }\n        public void GenerateAccount()\n        {\n            // code for asking user for their details.\n        }\n    }\n\n\n    class ATM\n    {\n        public static Dictionary&lt;int, Account&gt; AccountsList;\n\n        static ATM() \n        {\n            AccountsList = new Dictionary&lt;int, Account&gt;();\n        }\n\n        public void CreateAccount()\n        {\n            Account acc = new Account();\n            acc.GenerateAccount();\n            AccountsList.Add(acc.AccountNo, acc);\n        }\n\n        public void Deposit()\n        {\n            Console.WriteLine(\"Enter your account number\");\n            int accountNo = int.Parse(Console.ReadLine());\n\n            if (AccountsList.ContainsKey(accountNo))\n            {\n                Console.WriteLine(\"Enter your amount you wish to deposit\");\n                int amount = int.Parse(Console.ReadLine());\n                AccountsList[accountNo].InititailBalance += amount;\n            }\n        }\n    }\n\n\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            ATM atm = new ATM();\n            while (true)\n            {\n                Console.WriteLine(\"Menu\");\n                Console.WriteLine(\"1.Create Account\");\n                Console.WriteLine(\"2.ATM\");\n                Console.Write(\"Please enter your selections: \");\n                int select = int.Parse(Console.ReadLine());\n\n                switch (select)\n                {\n                    case 1:\n                        atm.CreateAccount();\n                        break;\n\n                    case 2:\n                        atm.Deposit();\n                        break;\n                    default:\n                        Console.WriteLine(\"Invalid selection!\");\n                        break;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2321, "user_id": 2535356, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8517bb7eb580d6bed728339d79ba5d1d?s=128&d=identicon&r=PG", "display_name": "transporter_room_3", "link": "https://stackoverflow.com/users/2535356/transporter-room-3"}, "is_accepted": false, "score": 0, "last_activity_date": 1436386428, "creation_date": 1436386428, "answer_id": 31302793, "question_id": 31301368, "link": "https://stackoverflow.com/questions/31301368/how-to-create-a-simple-atm-program-in-c-using-inheritance/31302793#31302793", "title": "How to Create a simple atm program in c# using inheritance", "body": "<p><code>CreateAccount</code> is an operation of <code>Atm</code> and this is why I don't think you should be using inheritance. I propose this solution:</p>\n\n<p><strong>Class Account:</strong></p>\n\n<pre><code>class Account\n{\n    public int Id { get; set; }\n    public string FirstName { get; set; }\n    public string LastName { get; set; }\n    public DateTime DateOfBirth { get; set; }\n    public string PhoneNumber { get; set; }\n    public double Balance { get; set; }\n\n    // More properties here\n    ...\n}\n</code></pre>\n\n<p><strong>Class Atm:</strong></p>\n\n<pre><code>class Atm\n{\n    public List&lt;Account&gt; Accounts { get; set; }\n\n    public Atm()\n    {\n        Accounts = new List&lt;Account&gt;();\n    }\n\n    public void CreateAccount()\n    {\n        var account = new Account();\n\n        // Get details from user here:\n        ...\n\n        account.Balance = 0.0;\n        account.Id = Accounts.Count + 1;\n\n        Accounts.Add(account);\n    }\n\n    public void Deposit()\n    {\n        int accountId;\n\n        // Get input from the user here:\n        // --------------------------------\n        // 1. Check that the account exists\n        // 2. Deposit into the account.\n        ...\n    }\n</code></pre>\n\n<p><strong>Full example:</strong></p>\n\n<pre><code>class Program\n{\n    static void Main()\n    {\n        var atm = new Atm();\n        while (true)\n        {\n            int option;\n\n            Console.WriteLine();\n            Console.WriteLine(\"Menu:\");\n            Console.WriteLine(\"1. Create Account\");\n            Console.WriteLine(\"2. Deposit\");\n            Console.WriteLine();\n            Console.Write(\"Please make a selection: \");\n\n            var input = int.TryParse(Console.ReadLine(), out option);\n\n            Console.WriteLine(\"-----------------\");\n\n            switch (option)\n            {\n                case 1:\n                    atm.CreateAccount();\n                    break;\n                case 2:\n                    atm.Deposit();\n                    break;\n            }\n        }\n    }\n}\n\nclass Account\n{\n    public int Id { get; set; }\n    public string FirstName { get; set; }\n    public string LastName { get; set; }\n    public DateTime DateOfBirth { get; set; }\n    public string PhoneNumber { get; set; }\n    public double Balance { get; set; }\n}\n\nclass Atm\n{\n    public List&lt;Account&gt; Accounts { get; set; }\n\n    public Atm()\n    {\n        Accounts = new List&lt;Account&gt;();\n    }\n\n    public void CreateAccount()\n    {\n        var account = new Account();\n\n        Console.WriteLine(\"Create a new account!\");\n        Console.WriteLine();\n        Console.Write(\"Enter first name: \");\n        account.FirstName = Console.ReadLine();\n        Console.Write(\"Enter last name: \");\n        account.LastName = Console.ReadLine();\n        Console.Write(\"Enter date of birth: \");\n        account.DateOfBirth = DateTime.Parse(Console.ReadLine());\n        Console.Write(\"Enter phone number: \");\n        account.PhoneNumber = Console.ReadLine();\n\n        account.Balance = 0.0;\n        account.Id = Accounts.Count + 1;\n\n        Accounts.Add(account);\n    }\n\n    public void Deposit()\n    {\n        int accountId;\n\n        Console.Write(\"Enter your account number: \");\n        int.TryParse(Console.ReadLine(), out accountId);\n\n        var account = Accounts.FirstOrDefault(a =&gt; a.Id == accountId);\n        if (account != null)\n        {\n            double amount;\n            Console.Write(\"Enter amount to deposit: \");\n            double.TryParse(Console.ReadLine(), out amount);\n            account.Balance += amount;\n            Console.Write(\"Your new balance is {0}\", account.Balance);\n        }\n        else\n        {\n            Console.WriteLine(\"That account does not exist!\");\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4990764, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33325b3f5613bb350a63a05116711b56?s=128&d=identicon&r=PG&f=1", "display_name": "smita", "link": "https://stackoverflow.com/users/4990764/smita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10090, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1597804350, "creation_date": 1436381802, "last_edit_date": 1436384988, "question_id": 31301368, "link": "https://stackoverflow.com/questions/31301368/how-to-create-a-simple-atm-program-in-c-using-inheritance", "title": "How to Create a simple atm program in c# using inheritance", "body": "<p>I'm trying to create an e-ATM console app using C# using inheritance, but every time I debug I see that the derived class values are <code>null</code>, whereas the base class fields or properties are filled with values. Why is the derived class not showing the list with their data even after it is inherited from the base class?</p>\n\n<pre><code>class CreateAccount\n{\n    string firstName, lastName, dateOfBirth, phoneNO, fathersName, mothersName;\n    double initialBalance; int pinNo = 100, accountNo = 1234, age; DateTime yearOfBirth;\n\n    protected static List&lt;CreateAccount&gt; data = new List&lt;CreateAccount&gt;();\n\n    protected string FirstName\n    {\n        get { return this.firstName; }\n        set\n        {\n            if (string.IsNullOrEmpty(value)) throw new Exception();\n            else firstName = value;\n        }\n    }\n    protected string LastName\n    {\n        get { return this.lastName; }\n        set\n        {\n            if (string.IsNullOrEmpty(value)) throw new Exception();\n            else lastName = value;\n        }\n    }\n    protected string DateOfBirth\n    {\n        get { return this.dateOfBirth; }\n        set\n        {\n            if (string.IsNullOrEmpty(value)) throw new Exception();\n            else dateOfBirth = value;\n        }\n    }\n    protected string PhoneNo\n    {\n        get { return this.phoneNO; }\n        set\n        {\n            if ((string.IsNullOrEmpty(value)) || value.Length != 10)\n                throw new Exception();\n            else\n                phoneNO = value;\n        }\n    }\n    protected string FathersName\n    {\n        get { return this.fathersName; }\n        set\n        {\n            if (string.IsNullOrEmpty(value))\n                throw new Exception();\n            else\n                fathersName = value;\n        }\n    }\n    protected string MothersName\n    {\n        get { return this.mothersName; }\n        set\n        {\n            if (string.IsNullOrEmpty(value))\n                throw new Exception();\n            else\n                mothersName = value;\n        }\n    }\n    protected double InititailBalance\n    {\n        get { return this.initialBalance; }\n        set\n        {\n            if (double.IsNaN(value))\n                throw new Exception();\n\n            else\n                initialBalance = value;\n        }\n    }\n    protected int PinNo\n    {\n        get { return this.pinNo; }\n    }\n    protected int AccountNo\n    {\n        get { return this.accountNo; }\n    }\n    public void GenerateAccount()\n    { \n         // code for asking user for their details.\n        data.Add(this);\n    }\n}\n\n\nclass ATM :CreateAccount\n{\n    public void Deposit()\n    {\n        Console.WriteLine(\"Enter your account number\");\n        int accountNo = int.Parse(Console.ReadLine());\n\n        if (accountNo == AccountNo)\n        {\n            Console.WriteLine(\"Enter your amount you wish to deposit\");\n            int amount = int.Parse(Console.ReadLine());\n            InititailBalance+= amount;\n        }\n    }\n}   \n\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        while (true)\n        {\n            Console.WriteLine(\"Menu\");\n            Console.WriteLine(\"1.Create Account\");\n            Console.WriteLine(\"2.ATM\");\n            Console.Write(\"Please enter your selections: \");\n            int select = int.Parse(Console.ReadLine());\n\n            switch (select)\n            {\n                case 1:\n                    CreateAccount account = new CreateAccount();\n                    account.GenerateAccount();\n                    break;\n\n                case 2:\n                    ATM atm = new ATM();\n                    atm.Deposit();\n                    break;\n\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "wcf", "soap"], "comments": [{"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1436420762, "post_id": 31301218, "comment_id": 50606767, "body": "You have a space in the URI for the <code>xmlns:soap</code> namespace - <code>&quot;http:&#47;&#47;www.w3.org&#47;2003&#47;05&#47;soap-   envelope&quot;</code> - was that a typo?  If not, it should be <code>xmlns:soap=&quot;&quot;http:&#47;&#47;www.w3.org&#47;2003&#47;05&#47;soap-envelope&quot;&quot;</code>, I believe."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5003089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c42506a156c6eace9bee8d667f062272?s=128&d=identicon&r=PG&f=1", "display_name": "Cihan", "link": "https://stackoverflow.com/users/5003089/cihan"}, "is_accepted": false, "score": 0, "last_activity_date": 1436430558, "creation_date": 1436430558, "answer_id": 31312111, "question_id": 31301218, "link": "https://stackoverflow.com/questions/31301218/configuration-to-an-binding-using-soap-1-2-in-a-wcf-project-to-be-consumed-for-a/31312111#31312111", "title": "Configuration to an binding using soap 1.2 in a WCF Project to be consumed for a non C# client", "body": "<p>I think you must binding=\"basicHttpBinding\" on endpoint. </p>\n\n<p>App.config of my project . </p>\n\n<pre><code>        &lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n\n  &lt;appSettings&gt;\n    &lt;add key=\"aspnet:UseTaskFriendlySynchronizationContext\" value=\"true\" /&gt;\n  &lt;/appSettings&gt;\n  &lt;system.web&gt;\n    &lt;compilation debug=\"true\" /&gt;\n  &lt;/system.web&gt;\n  &lt;!-- When deploying the service library project, the content of the config file must be added to the host's \n  app.config file. System.Configuration does not support config files for libraries. --&gt;\n  &lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service name=\"WcfServiceLibrary1.Service1\"&gt;\n        &lt;host&gt;\n          &lt;baseAddresses&gt;\n            &lt;add baseAddress = \"http://localhost:8733/Design_Time_Addresses/WcfServiceLibrary1/Service1/\" /&gt;\n          &lt;/baseAddresses&gt;\n        &lt;/host&gt;\n        &lt;!-- Service Endpoints --&gt;\n        &lt;!-- Unless fully qualified, address is relative to base address supplied above --&gt;\n        &lt;endpoint address=\"\" binding=\"basicHttpBinding\" contract=\"WcfServiceLibrary1.IService1\"&gt;\n          &lt;!-- \n              Upon deployment, the following identity element should be removed or replaced to reflect the \n              identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity \n              automatically.\n          --&gt;\n          &lt;identity&gt;\n            &lt;dns value=\"localhost\"/&gt;\n          &lt;/identity&gt;\n        &lt;/endpoint&gt;\n        &lt;!-- Metadata Endpoints --&gt;\n        &lt;!-- The Metadata Exchange endpoint is used by the service to describe itself to clients. --&gt; \n        &lt;!-- This endpoint does not use a secure binding and should be secured or removed before deployment --&gt;\n        &lt;endpoint address=\"mex\" binding=\"mexHttpBinding\" contract=\"IMetadataExchange\"/&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior&gt;\n          &lt;!-- To avoid disclosing metadata information, \n          set the values below to false before deployment --&gt;\n          &lt;serviceMetadata httpGetEnabled=\"True\" httpsGetEnabled=\"True\"/&gt;\n          &lt;!-- To receive exception details in faults for debugging purposes, \n          set the value below to true.  Set to false before deployment \n          to avoid disclosing exception information --&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"False\" /&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n  &lt;/system.serviceModel&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Also you can look my web site about soap but my web is turkish . There are codes in there . <a href=\"http://cihanasan.com/2015/06/13/net-soap-ile-xml-kullanimi/\" rel=\"nofollow\">cihanasan.com</a></p>\n"}], "owner": {"reputation": 1, "user_id": 5003103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65535a3bbb2dddccfe9b4b8f369770e3?s=128&d=identicon&r=PG&f=1", "display_name": "djsk", "link": "https://stackoverflow.com/users/5003103/djsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1644, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436430558, "creation_date": 1436381374, "last_edit_date": 1436382034, "question_id": 31301218, "link": "https://stackoverflow.com/questions/31301218/configuration-to-an-binding-using-soap-1-2-in-a-wcf-project-to-be-consumed-for-a", "title": "Configuration to an binding using soap 1.2 in a WCF Project to be consumed for a non C# client", "body": "<p>i have study and read about it a little, but i can't do this yet so i post this question.\nHere is my binding configuration: </p>\n\n<p><code>&lt;bindings&gt;\n      &lt;customBinding&gt;\n        &lt;binding name=\"httpSoap12\"&gt;\n          &lt;textMessageEncoding messageVersion=\"Soap12\"/&gt;\n          &lt;httpTransport /&gt;\n        &lt;/binding&gt;\n      &lt;/customBinding&gt;\n    &lt;/bindings&gt;\n    &lt;services&gt;\n      &lt;service name=\"Service.OnOffService\"&gt;\n        &lt;host&gt;\n          &lt;baseAddresses&gt;\n            &lt;add baseAddress = \"http://192.168.0.14:5554/Service/OnOffService\" /&gt;\n          &lt;/baseAddresses&gt;\n        &lt;/host&gt;\n        &lt;endpoint address=\"soap12\" binding=\"customBinding\" bindingConfiguration=\"httpSoap12\" contract=\"Service.IOnOffService\"&gt;</code></p>\n\n<p>and this is my contract:</p>\n\n<pre><code>[ServiceContract(Namespace = \"http://testeService\")]\npublic interface IOnOffService\n{\n    [OperationContract]\n    string OnOff(string Usuario);\n}\n</code></pre>\n\n<p>and here i build the Envelope to consume this service:</p>\n\n<pre><code>sEnv = sEnv &amp; \"&lt;soap:Envelope xmlns:soap=\"\"http://www.w3.org/2003/05/soap-   envelope\"\" xmlns:tem=\"\"http://testeService/\"\"&gt;\"\nsEnv = sEnv &amp; \"  &lt;soap:Header xmlns:wsa=\"\"http://www.w3.org/2005/08/addressing\"\"&gt;\"\nsEnv = sEnv &amp; \"     &lt;wsa:Action&gt;http://testeService/IOnOffService/OnOff&lt;/wsa:Action&gt;\"\nsEnv = sEnv &amp; \"     &lt;wsa:To&gt;http://192.168.0.14:5554/Service/OnOffService&lt;/wsa:To&gt;\"\nsEnv = sEnv &amp; \"  &lt;/soap:Header&gt;\"\nsEnv = sEnv &amp; \"  &lt;soap:Body&gt;\"\nsEnv = sEnv &amp; \"    &lt;tem:OnOff&gt;\"\nsEnv = sEnv &amp; \"      &lt;tem:Usuario&gt;A&lt;/tem:Usuario&gt;\"\nsEnv = sEnv &amp; \"    &lt;/tem:OnOff&gt;\"\nsEnv = sEnv &amp; \"  &lt;/soap:Body&gt;\"\nsEnv = sEnv &amp; \"&lt;/soap:Envelope&gt;\"\n</code></pre>\n\n<p>the problem is, i've received a 400 bad request error....</p>\n"}, {"tags": ["c#", "oracle", "odbc"], "owner": {"reputation": 408, "user_id": 1987724, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/IsH6B.jpg?s=128&g=1", "display_name": "Fam", "link": "https://stackoverflow.com/users/1987724/fam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436381324, "creation_date": 1436381324, "last_edit_date": 1495542251, "question_id": 31301193, "link": "https://stackoverflow.com/questions/31301193/add-multiple-restrictions-to-odbcconnection-getschema", "title": "Add multiple restrictions to OdbcConnection.GetSchema", "body": "<p>Is there a way to add multiple restrictions to a <code>GetSchema</code> call? There is nothing in the documentation <a href=\"https://msdn.microsoft.com/en-us/library/ms135853%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://msdn.microsoft.com/en-us/library/cc716722%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">here</a> that indicates that I can do so.</p>\n\n<p>I want to take this:</p>\n\n<pre><code>OdbcConnection.GetSchema(\"Tables\", new string[] { null, \"SYS\" });\nOdbcConnection.GetSchema(\"Tables\", new string[] { null, \"DBSYS\" });\nOdbcConnection.GetSchema(\"Tables\", new string[] { null, \"MDSYS\" });\n</code></pre>\n\n<p>And make it into this:</p>\n\n<pre><code>OdbcConnection.GetSchema(\"Tables\", new string[] { null, \"SYS,DBSYS,MDSYS\" });\n</code></pre>\n\n<p>Or something similar. Is that possible? It would be even better if I could somehow request the inverse of those restrictions. So (the following won't be syntactically correct):</p>\n\n<pre><code>OdbcConnection.GetSchema(\"Tables\", new string[] { null, !\"SYS,DBSYS,MDSYS\" });\n// notice the ! operator in front of the restriction string\n</code></pre>\n\n<p>For reference, SYS/DBSYS/MDSYS are Oracle system schemas. There is a similar question <a href=\"https://stackoverflow.com/questions/8006991/how-to-specify-multiple-restiction-values-in-connection-getschema-in-c-sharp\">here</a> but I figured I'd give it another shot for another opinion.</p>\n"}]