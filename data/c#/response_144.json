[{"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 3935, "user_id": 6564276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24e7a72ccc1527b501c1672edff06203?s=128&d=identicon&r=PG&f=1", "display_name": "Vijunav Vastivch", "link": "https://stackoverflow.com/users/6564276/vijunav-vastivch"}, "edited": false, "score": 0, "creation_date": 1507765764, "post_id": 46699169, "comment_id": 80345888, "body": "what do you mean accept only numbers.. Do you have a sample code to show here?"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1507765986, "post_id": 46699169, "comment_id": 80345940, "body": "Can you show us the full extent of brackets and parentheses?"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1507766150, "post_id": 46699169, "comment_id": 80345985, "body": "Also, would a period in a sentence be valid, e.g. <code>I am here.</code> ?"}, {"owner": {"reputation": 5, "user_id": 8762106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4428b0e45fc7c060a9965afa5ed8edb9?s=128&d=identicon&r=PG&f=1", "display_name": "xGreatx", "link": "https://stackoverflow.com/users/8762106/xgreatx"}, "edited": false, "score": 0, "creation_date": 1507769043, "post_id": 46699169, "comment_id": 80346671, "body": "Every number without dots is valid. Mine input is one word from txt file e,g, [[12]] and it detects 12."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8762106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4428b0e45fc7c060a9965afa5ed8edb9?s=128&d=identicon&r=PG&f=1", "display_name": "xGreatx", "link": "https://stackoverflow.com/users/8762106/xgreatx"}, "edited": false, "score": 0, "creation_date": 1507771916, "post_id": 46699886, "comment_id": 80347323, "body": "Edited first post. I need to detect 12 from input e.g. foo(12) but do not detect 12.12 from foo(12.12) so your answer is not correct."}, {"owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "reply_to_user": {"reputation": 5, "user_id": 8762106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4428b0e45fc7c060a9965afa5ed8edb9?s=128&d=identicon&r=PG&f=1", "display_name": "xGreatx", "link": "https://stackoverflow.com/users/8762106/xgreatx"}, "edited": false, "score": 0, "creation_date": 1507774722, "post_id": 46699886, "comment_id": 80347965, "body": "you use the supplied regex to check if valid match (does not contain dot) and then use another regex to capture the number on only valid matches."}], "tags": [], "owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "is_accepted": false, "score": 1, "last_activity_date": 1562124155, "last_edit_date": 1562124155, "creation_date": 1507771003, "answer_id": 46699886, "question_id": 46699169, "link": "https://stackoverflow.com/questions/46699169/regex-for-numbers-without-dots/46699886#46699886", "title": "Regex for numbers without dots", "body": "<p>You can use this regex:</p>\n\n<pre><code>^[^\\.]+$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 8397456, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/91bf6a56269404dfadf39ee3ae6b67b2?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/8397456/tommy"}, "is_accepted": true, "score": 0, "last_activity_date": 1507790665, "creation_date": 1507790665, "answer_id": 46703068, "question_id": 46699169, "link": "https://stackoverflow.com/questions/46699169/regex-for-numbers-without-dots/46703068#46703068", "title": "Regex for numbers without dots", "body": "<p>according to your post example and comments the right pattern should be this:</p>\n\n<pre><code>(?&lt;![.\\d])\\d+(?![.\\d])\n</code></pre>\n\n<p>This is very close to your one.\nDifferences:</p>\n\n<ul>\n<li>you didn't set the check to sure that are no digits on both sides too. You checked only <code>.</code> symbol</li>\n<li>you used negative look-ahead on left side of <code>\\d+</code>. You need to use negative look-<strong>behind</strong> (not ahead) if you want to \"look\" left \"negatively\".</li>\n</ul>\n\n<p><strong>Note</strong>: I don't use starting symbol <code>^</code>, but I hope it's not big deal for you.</p>\n"}], "owner": {"reputation": 5, "user_id": 8762106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4428b0e45fc7c060a9965afa5ed8edb9?s=128&d=identicon&r=PG&f=1", "display_name": "xGreatx", "link": "https://stackoverflow.com/users/8762106/xgreatx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1472, "favorite_count": 0, "accepted_answer_id": 46703068, "answer_count": 2, "score": -3, "last_activity_date": 1562124155, "creation_date": 1507765280, "last_edit_date": 1507771667, "question_id": 46699169, "link": "https://stackoverflow.com/questions/46699169/regex-for-numbers-without-dots", "title": "Regex for numbers without dots", "body": "<p>I need a regular expression that accepts only integer numbers like this:</p>\n\n<pre><code>12 valid output 12\n(12) valid output 12\n[12] valid output 12\n12foo valid output 12\n12. not valid\n.12 not valid\n12.12 not valid\n</code></pre>\n\n<p>I have something like this:</p>\n\n<pre><code>^(?![.])\\d+(?![.])\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1507783718, "post_id": 46699129, "comment_id": 80350240, "body": "Obviously it will generate collision at some point if you call it more than once... But impossible to give correct answer without knowing quality of your random number generator and number of results you want."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8649713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VGwLZyKwVZU/AAAAAAAAAAI/AAAAAAAAABY/nYzMB08l65Q/photo.jpg?sz=128", "display_name": "Helder Boone", "link": "https://stackoverflow.com/users/8649713/helder-boone"}, "edited": false, "score": 0, "creation_date": 1508016096, "post_id": 46699342, "comment_id": 80444951, "body": "Just to clarify i&#39;m using Random Number Generator which belongs System.Security.Criptography.Algorithms namespace c# language and not Sytem.Random()"}], "tags": [], "owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "is_accepted": false, "score": 1, "last_activity_date": 1507767584, "last_edit_date": 1507767584, "creation_date": 1507766585, "answer_id": 46699342, "question_id": 46699129, "link": "https://stackoverflow.com/questions/46699129/random-number-generator-collision/46699342#46699342", "title": "Random number generator collision", "body": "<p>It depends on the implementation of <code>RandomNumberGenerator</code>, but right now, I'm thinking the probability of a collision is 100%, since you are instantiating a new instance with each call. If you were using System.Random, that would be the case... <a href=\"https://dotnetfiddle.net/CojGnJ\" rel=\"nofollow noreferrer\">try it out on DotNetFiddle</a>.</p>\n\n<pre><code>public class Program\n{\n    public static string RandomNumber()\n    {\n        var rng = new System.Random();\n        var bytes = new byte[8];\n\n        rng.NextBytes(bytes);\n\n        return Convert.ToBase64String(bytes);\n    }\n\n    public static void Main()\n    {\n        Console.WriteLine(RandomNumber());\n        Console.WriteLine(RandomNumber());\n    }\n}\n</code></pre>\n\n<p>Output (oops!):</p>\n\n<pre><code>EgNMBvntr1w=\nEgNMBvntr1w=\n</code></pre>\n\n<p>My suggestion would be to instantiate only one instance of <code>RandomNumberGenerator</code> and hold it in a static variable throughout the lifespan of your program. If you do it that way, the odds will be more like 1 in 2^64.</p>\n\n<pre><code>public class Program\n{\n    private static readonly rng = new System.Random();\n\n    public static string RandomNumber()\n    {\n        var bytes = new byte[8];\n\n        rng.NextBytes(bytes);\n\n        return Convert.ToBase64String(bytes);\n    }\n\n    public static void Main()\n    {\n        Console.WriteLine(RandomNumber());\n        Console.WriteLine(RandomNumber());\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8649713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VGwLZyKwVZU/AAAAAAAAAAI/AAAAAAAAABY/nYzMB08l65Q/photo.jpg?sz=128", "display_name": "Helder Boone", "link": "https://stackoverflow.com/users/8649713/helder-boone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1508030158, "creation_date": 1507764995, "last_edit_date": 1508030158, "question_id": 46699129, "link": "https://stackoverflow.com/questions/46699129/random-number-generator-collision", "title": "Random number generator collision", "body": "<p>I implemented a method which generates automaric letters and numbers in random way.</p>\n\n<pre><code>public static string GenerateRandomNumber()\n{\n    using (var rng = RandomNumberGenerator.Create())\n    {\n        var bytes = new byte[8];\n\n        rng.GetBytes(bytes);\n\n        return Convert.ToBase64String(bytes);\n    }\n}\n</code></pre>\n\n<p>What are the probabilities that this randomNumberGenerator class would generate collision?</p>\n"}, {"tags": ["c#", "winforms", "system.drawing.graphics"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1507764808, "post_id": 46698991, "comment_id": 80345652, "body": "Don&#39;t forget to <code>.Dispose()</code> your <code>g</code> and <code>p</code> otherwise you&#39;ll end up crashing your app."}, {"owner": {"reputation": 470, "user_id": 6713390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5476b312d6588ca5d86dbbd5c40ddee7?s=128&d=identicon&r=PG&f=1", "display_name": "4D1C70", "link": "https://stackoverflow.com/users/6713390/4d1c70"}, "edited": false, "score": 0, "creation_date": 1507820532, "post_id": 46698991, "comment_id": 80372208, "body": "@Ivan Spajic, consider the edit on my answer."}], "answers": [{"comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 2, "creation_date": 1507767339, "post_id": 46699076, "comment_id": 80346249, "body": "You should properly show how to dispose the disposables."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1507815105, "post_id": 46699076, "comment_id": 80368237, "body": "You likely will want to call <code>base.OnPaint(e)</code> first instead of last, or else the form may draw over whatever you just painted."}, {"owner": {"reputation": 141, "user_id": 1315765, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb0ca08e4e1559c386be751318143c4e?s=128&d=identicon&r=PG", "display_name": "Ivan Spaji\u0107", "link": "https://stackoverflow.com/users/1315765/ivan-spaji%c4%87"}, "edited": false, "score": 1, "creation_date": 1507826300, "post_id": 46699076, "comment_id": 80375755, "body": "Thank you for your contribution, however this unfortunately didn&#39;t do it for me. I found the answer in a very similar question to mine, so I marked this question as a duplicate. You are still right about having to dispose the respective objects."}], "tags": [], "owner": {"reputation": 470, "user_id": 6713390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5476b312d6588ca5d86dbbd5c40ddee7?s=128&d=identicon&r=PG&f=1", "display_name": "4D1C70", "link": "https://stackoverflow.com/users/6713390/4d1c70"}, "is_accepted": false, "score": 1, "last_activity_date": 1507820453, "last_edit_date": 1507820453, "creation_date": 1507764662, "answer_id": 46699076, "question_id": 46698991, "link": "https://stackoverflow.com/questions/46698991/painting-with-system-drawing-graphics-on-form-load/46699076#46699076", "title": "Painting with System.Drawing.Graphics on form load", "body": "<p>You can achieve this overriding the OnLoad event of Form, also you can reuse the PaintEvent parameter.</p>\n\n<pre><code>protected override void OnPaint(PaintEventArgs e)\n{\n    base.OnPaint(e);\n    using (Graphics g = e.Graphics)\n    {\n        g.Clear(Color.White);\n        using (Pen p = new Pen(Color.Black, 1))\n        {\n            g.DrawRectangle(p, 0, 0, 50, 50);\n        }\n    }\n}\n</code></pre>\n\n<p>Edit: added <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/using-statement\" rel=\"nofollow noreferrer\">using</a> statement for disposing resources</p>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 1315765, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb0ca08e4e1559c386be751318143c4e?s=128&d=identicon&r=PG", "display_name": "Ivan Spaji\u0107", "link": "https://stackoverflow.com/users/1315765/ivan-spaji%c4%87"}, "edited": false, "score": 1, "creation_date": 1507824391, "post_id": 46710151, "comment_id": 80374694, "body": "I tried this, and it does not work for me. I&#39;m able to get a print confirming that I&#39;m hitting the correct method delegated by the event, however upon calling my Draw() method, nothing happens."}], "tags": [], "owner": {"reputation": 795, "user_id": 4279598, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh4.googleusercontent.com/-gUjrLyAWHAE/AAAAAAAAAAI/AAAAAAAAAEI/gTQv1d8e0y4/photo.jpg?sz=128", "display_name": "0014", "link": "https://stackoverflow.com/users/4279598/0014"}, "is_accepted": false, "score": 0, "last_activity_date": 1507812823, "creation_date": 1507812823, "answer_id": 46710151, "question_id": 46698991, "link": "https://stackoverflow.com/questions/46698991/painting-with-system-drawing-graphics-on-form-load/46710151#46710151", "title": "Painting with System.Drawing.Graphics on form load", "body": "<p>You also should be fine placing your function under Form1's <code>Load</code> event. </p>\n\n<p>After subscribing for the <code>Load</code> event try this;</p>\n\n<pre><code>public Form1()\n{\n    InitializeComponent();\n}\n\nprivate void Form1_Load(object sender, EventArgs e)\n{\n    Draw();\n}\n\nprivate void Draw()\n{\n    Graphics g = pictureBox.CreateGraphics();\n    g.Clear(Color.White);\n    Pen p = new Pen(Color.Black, 1);\n    g.DrawRectangle(p, 0, 0, 50, 50);\n}\n</code></pre>\n\n<p><code>Load</code> event is called after the constructor. Your form elements are being created in the constructor therefore you are having some problems trying to use them in the same function.</p>\n"}], "owner": {"reputation": 141, "user_id": 1315765, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb0ca08e4e1559c386be751318143c4e?s=128&d=identicon&r=PG", "display_name": "Ivan Spaji\u0107", "link": "https://stackoverflow.com/users/1315765/ivan-spaji%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 0, "closed_date": 1507826182, "answer_count": 2, "score": 0, "last_activity_date": 1507820453, "creation_date": 1507764084, "last_edit_date": 1507812305, "question_id": 46698991, "link": "https://stackoverflow.com/questions/46698991/painting-with-system-drawing-graphics-on-form-load", "closed_reason": "Duplicate", "title": "Painting with System.Drawing.Graphics on form load", "body": "<p>I'm trying to draw a rectangle using <code>System.Drawing.Graphics</code> in C# Windows Forms, but I cannot seem to get it to work without using a button click event.</p>\n\n<p>Searching online uncovered that I must use either the Paint or the Shown event within the form itself, however my attempts were unsuccessful.</p>\n\n<p>I would like to run my <code>Draw()</code> method upon loading the form and its components.    </p>\n\n<pre><code>public Form1()\n{\n    InitializeComponent();\n    Draw(); //doesn't work\n}\n\nprivate void Draw()\n{\n    Graphics g = pictureBox.CreateGraphics();\n    g.Clear(Color.White);\n    Pen p = new Pen(Color.Black, 1);\n    g.DrawRectangle(p, 0, 0, 50, 50);\n}\n\nprivate void ApproximateButton_Click(object sender, EventArgs e)\n{\n    Draw(); //works\n}\n</code></pre>\n\n<p>What is the correct way of achieving this?</p>\n\n\n"}, {"tags": ["c#", "xamarin", "xamarin.forms", "uwp", "nuget"], "comments": [{"owner": {"reputation": 1232, "user_id": 1970551, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/HaTWL.jpg?s=128&g=1", "display_name": "Patrick Goode", "link": "https://stackoverflow.com/users/1970551/patrick-goode"}, "edited": false, "score": 0, "creation_date": 1507767548, "post_id": 46698962, "comment_id": 80346305, "body": "I noticed the latest version uses .net standard.  I wonder if that has anything to do with it.  Anyway,  if you put some other native dialogue in the event you could see if the code is reaching it."}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 2962027, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4655f2da77423e28384418d16ac5c06a?s=128&d=identicon&r=PG&f=1", "display_name": "tayoung", "link": "https://stackoverflow.com/users/2962027/tayoung"}, "is_accepted": true, "score": 1, "last_activity_date": 1507820992, "creation_date": 1507820992, "answer_id": 46713074, "question_id": 46698962, "link": "https://stackoverflow.com/questions/46698962/nuget-package-missing-in-release-yet-it-compiles/46713074#46713074", "title": "NuGet package missing in release yet it compiles", "body": "<p>Found the problem. It was my own dumbness.</p>\n\n<p>The line that created the dialog was in a Task which ran on a non-UI thread. For some reason Debug was fine with this, but Release wasn\u2019t. An exception was being thrown on the Task so it wouldn\u2019t complete, and that\u2019s why nothing happened.</p>\n\n<p>I refactored the code so only the stuff that needs to be run on a different thread goes in the Task so that the UI isn\u2019t blocked.</p>\n"}], "owner": {"reputation": 366, "user_id": 2962027, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4655f2da77423e28384418d16ac5c06a?s=128&d=identicon&r=PG&f=1", "display_name": "tayoung", "link": "https://stackoverflow.com/users/2962027/tayoung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 46713074, "answer_count": 1, "score": 0, "last_activity_date": 1507820992, "creation_date": 1507763895, "question_id": 46698962, "link": "https://stackoverflow.com/questions/46698962/nuget-package-missing-in-release-yet-it-compiles", "title": "NuGet package missing in release yet it compiles", "body": "<p>I've been building a Xamarin.Forms application and using Debug to build this entire time. Everything in it works OK.</p>\n\n<p>However, today, when I went to build Release, everything built fine. However, a menu item I'd click\u30fcwhich should open an <a href=\"https://github.com/aritchie/userdialogs\" rel=\"nofollow noreferrer\">Acr.UserDialogs</a> dialog, would not do anything, no matter how many times I clicked the item. Again, this works perfectly in the Debug build.</p>\n\n<p>My best guess is the Acr.UserDialogs NuGet reference is somehow not making it into the Release build. This sounds absurd, but it's the only logical explanation I can think of, as all other selectable menu options work perfectly (none of which create any dialogs).</p>\n\n<p>I even uninstalled and reinstalled the NuGet package with no difference in functionality. Is it even possible for that to happen?</p>\n\n<p>I remember having to downgrade Xamarin.Forms due to menu item tapping not working correctly for groups, but this isn't even a ListViewGroup, and as I said, the other menu items function correctly.</p>\n"}, {"tags": ["c#", ".net", "lucene", "lucene.net", "fuzzy-search"], "answers": [{"tags": [], "owner": {"reputation": 8298, "user_id": 2663985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/531b51e8cd1cf8655256f3e913ed9eef?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterion", "link": "https://stackoverflow.com/users/2663985/mysterion"}, "is_accepted": false, "score": 1, "last_activity_date": 1507813276, "creation_date": 1507813276, "answer_id": 46710294, "question_id": 46698919, "link": "https://stackoverflow.com/questions/46698919/fuzzy-substring-matching-in-a-string-lucene-net/46710294#46710294", "title": "Fuzzy substring matching in a string Lucene.NET", "body": "<p>Yes, Lucene.Net supports single fuzzy matching in a text. You could do it with the help of <a href=\"https://lucenenet.apache.org/docs/3.0.3/d0/db9/class_lucene_1_1_net_1_1_search_1_1_fuzzy_query.html\" rel=\"nofollow noreferrer\">FuzzyQuery</a>.</p>\n\n<p>Unfortunately, you could only somehow mimic the behavior of the first example. One possible solution is to create big <a href=\"https://lucenenet.apache.org/docs/3.0.3/d8/d7c/class_lucene_1_1_net_1_1_search_1_1_boolean_query.html\" rel=\"nofollow noreferrer\">BooleanQuery</a> with each clause being <a href=\"https://lucenenet.apache.org/docs/3.0.3/d0/db9/class_lucene_1_1_net_1_1_search_1_1_fuzzy_query.html\" rel=\"nofollow noreferrer\">FuzzyQuery</a>, but this will lead to poor performance, as well, as it will lose the order of the terms.</p>\n\n<p>Another possibility is to use <a href=\"https://lucenenet.apache.org/docs/3.0.3/d2/dc9/class_lucene_1_1_net_1_1_search_1_1_spans_1_1_span_near_query.html\" rel=\"nofollow noreferrer\">SpanNearQuery</a> which will help to store the positions (you could specify the needed slop), but there is no possibility to add FuzzyQuery as clauses (you could only somehow try to use <a href=\"https://lucenenet.apache.org/docs/3.0.3/d6/d56/class_contrib_1_1_regex_1_1_span_regex_query.html\" rel=\"nofollow noreferrer\">SpanRegexQuery</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 8298, "user_id": 2663985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/531b51e8cd1cf8655256f3e913ed9eef?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterion", "link": "https://stackoverflow.com/users/2663985/mysterion"}, "edited": false, "score": 0, "creation_date": 1507841285, "post_id": 46713752, "comment_id": 80383637, "body": "you&#39;re right in general Lucene, but unfortunately, it&#39;s not true for Lucene.Net, since Lucene.Net is a very outdated version of java Lucene"}, {"owner": {"reputation": 30915, "user_id": 1628375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9070d56379b05ec9417627d9378c6f8e?s=128&d=identicon&r=PG", "display_name": "femtoRgon", "link": "https://stackoverflow.com/users/1628375/femtorgon"}, "reply_to_user": {"reputation": 8298, "user_id": 2663985, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/531b51e8cd1cf8655256f3e913ed9eef?s=128&d=identicon&r=PG&f=1", "display_name": "Mysterion", "link": "https://stackoverflow.com/users/2663985/mysterion"}, "edited": false, "score": 0, "creation_date": 1507847128, "post_id": 46713752, "comment_id": 80386276, "body": "@Mysterion - Ah, you are right, my mistake. Was thinking it was up to 4.X, but that&#39;s apparently <a href=\"http://code972.com/blog/2016/07/98-lucene-net-4-8-is-in-beta-and-we-need-your-help\" rel=\"nofollow noreferrer\">still in beta</a>."}], "tags": [], "owner": {"reputation": 30915, "user_id": 1628375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9070d56379b05ec9417627d9378c6f8e?s=128&d=identicon&r=PG", "display_name": "femtoRgon", "link": "https://stackoverflow.com/users/1628375/femtorgon"}, "is_accepted": false, "score": 1, "last_activity_date": 1507822951, "creation_date": 1507822951, "answer_id": 46713752, "question_id": 46698919, "link": "https://stackoverflow.com/questions/46698919/fuzzy-substring-matching-in-a-string-lucene-net/46713752#46713752", "title": "Fuzzy substring matching in a string Lucene.NET", "body": "<p>Mysterion is right, that Span Queries can be helpful, but wrong in saying the FuzzyQueries cannot be used. That is what <a href=\"https://lucene.apache.org/core/6_6_0//core/org/apache/lucene/search/spans/SpanMultiTermQueryWrapper.html\" rel=\"nofollow noreferrer\">SpanMultiTermQueryWrapper</a> is for. Something like this:</p>\n\n<pre><code>SpanQuery query = new SpanNearQuery.Builder(\"myField\", true).\n    .addClause(new SpanMultiTermQueryWrapper(new FuzzyQuery(new Term(\"myField\", \"question\"))))\n    .addClause(new SpanMultiTermQueryWrapper(new FuzzyQuery(new Term(\"myField\", \"abot\"))))\n    .addClause(new SpanMultiTermQueryWrapper(new FuzzyQuery(new Term(\"myField\", \"lucene\"))))\n    .build();\n</code></pre>\n\n<p>Remember, by the way, when manually constructing queries (rather than using a queryparser), you need to take analysis into account, as they will not be run through an analyzer.</p>\n"}], "owner": {"reputation": 27804, "user_id": 716092, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/kcc7I.png?s=128&g=1", "display_name": "Dan Dinu", "link": "https://stackoverflow.com/users/716092/dan-dinu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507822951, "creation_date": 1507763572, "question_id": 46698919, "link": "https://stackoverflow.com/questions/46698919/fuzzy-substring-matching-in-a-string-lucene-net", "title": "Fuzzy substring matching in a string Lucene.NET", "body": "<p>I've just installed Lucene.NET. </p>\n\n<p>I'm doing a text search.\nI want to check if a large text contains / fuzzy matches a word/phrase, say:</p>\n\n<p>Eg1: </p>\n\n<p>text: \n\"I posted a question about Lucene.NET on stackoverflow. Will I get an asnwer?\" </p>\n\n<p>textToSearch: \"posted a question abot Lucene\" </p>\n\n<p>These 2 should be a match, since text contains textToSearch (except the samll typo abot -> about. </p>\n\n<p>Is this possible with Lucene.NET library? </p>\n\n<p>If not, does it support at least single word fuzzy matching in a text? </p>\n\n<p>Eg:</p>\n\n<p>text: \"I posted a question on stackoverflow\"</p>\n\n<p>textToSearch \"stackovrlow\" (missspelled) </p>\n"}, {"tags": ["c#", "ranorex"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1507763779, "post_id": 46698885, "comment_id": 80345432, "body": "There is a fine line when licensing questions are off-topic. I think this question should be sent directly to Ranorex. The reason its not a good fit is because: Unlikely we can read the full license, so answers will be speculative, Unlikely to be of value to future visitors and Likely to need an attorney to interpret what the terms actually mean."}], "answers": [{"comments": [{"owner": {"reputation": 822, "user_id": 3774666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2670bc05ad5ff76f047761278e6f8f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptonian", "link": "https://stackoverflow.com/users/3774666/kryptonian"}, "edited": false, "score": 0, "creation_date": 1515571705, "post_id": 46711054, "comment_id": 83345208, "body": "I just realized that i forgot to upvote this answer... \u263a\ufe0f"}], "tags": [], "owner": {"reputation": 637, "user_id": 2570073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHi43.jpg?s=128&g=1", "display_name": "Sup3rHugh", "link": "https://stackoverflow.com/users/2570073/sup3rhugh"}, "is_accepted": true, "score": 1, "last_activity_date": 1507815352, "creation_date": 1507815352, "answer_id": 46711054, "question_id": 46698885, "link": "https://stackoverflow.com/questions/46698885/ranorex-installation/46711054#46711054", "title": "Ranorex installation", "body": "<p>Ranorex licence file is normally installed in <strong>%ProgramData%\\Ranorex3_Server.lic</strong> when installed for all users.</p>\n\n<p>Look in the user profile directory of user1 (follow environment variable %USERPROFILE%) for the licence file and copy/move it to the %ProgramData% directory.</p>\n\n<p>If you can't find the licence file, from the Windows start menu, open \"Ranorex Licensing\" tool as user2 and reconfigure the licence server.</p>\n\n<p>I agree with Jeremy, this is not related to programming but maybe the licence file information can be useful for somebody else.  On our side, we have created scripts to install/upgrade Ranorex on our computers (and to automatically install the licence file). In that case, the information about licence file could be useful to somebody else.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 822, "user_id": 3774666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2670bc05ad5ff76f047761278e6f8f7a?s=128&d=identicon&r=PG&f=1", "display_name": "Kryptonian", "link": "https://stackoverflow.com/users/3774666/kryptonian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 46711054, "answer_count": 1, "score": 0, "last_activity_date": 1507815352, "creation_date": 1507763374, "question_id": 46698885, "link": "https://stackoverflow.com/questions/46698885/ranorex-installation", "title": "Ranorex installation", "body": "<p>I have installed ranorex as user1 and while running the automated test I am impersonating user2, \nwhen i try to use ranorex assemblies for finding the controls I get error with license manager which does not occur if I run the tests with user1.</p>\n\n<p>Since the test require some part to be run as user1 and some part as user2 can I install ranorex in such a way that it is available for all/both the users?</p>\n"}, {"tags": ["c#", "dynamics-crm", "openxml-sdk", "ilmerge"], "comments": [{"owner": {"reputation": 20105, "user_id": 7920473, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10155688613669453/picture?type=large", "display_name": "Arun Vinoth", "link": "https://stackoverflow.com/users/7920473/arun-vinoth"}, "edited": false, "score": 1, "creation_date": 1507773012, "post_id": 46698874, "comment_id": 80347567, "body": "Instead of updating the existing plugin in PRT, unregister the existing &amp; register the new assembly with merged dll"}, {"owner": {"reputation": 20105, "user_id": 7920473, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10155688613669453/picture?type=large", "display_name": "Arun Vinoth", "link": "https://stackoverflow.com/users/7920473/arun-vinoth"}, "edited": false, "score": 1, "creation_date": 1507774213, "post_id": 46698874, "comment_id": 80347850, "body": "You can use any decompiler to see the content of merged dll &amp; verify"}, {"owner": {"reputation": 1238, "user_id": 1075932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8efd92b51f5897d9421fb198f932d8b2?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/1075932/rob"}, "reply_to_user": {"reputation": 20105, "user_id": 7920473, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10155688613669453/picture?type=large", "display_name": "Arun Vinoth", "link": "https://stackoverflow.com/users/7920473/arun-vinoth"}, "edited": false, "score": 1, "creation_date": 1507778365, "post_id": 46698874, "comment_id": 80348822, "body": "@ArunVinoth, I deleted my .dll and rebuilt it.  I used dotPeek to check the .dll to make sure it included the DocumentFormat.OpenXml assembly.  I then unregistered and re-registered the .dll in Plugin Registration Tool and it all worked!  If you want to post an Answer for unregistering and to re-register the .dll, I&#39;ll mark it.  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 20105, "user_id": 7920473, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10155688613669453/picture?type=large", "display_name": "Arun Vinoth", "link": "https://stackoverflow.com/users/7920473/arun-vinoth"}, "is_accepted": true, "score": 1, "last_activity_date": 1507787605, "creation_date": 1507787605, "answer_id": 46702334, "question_id": 46698874, "link": "https://stackoverflow.com/questions/46698874/how-can-i-merge-referenced-assembly-into-single-dll-for-dynamics-crm-plugin/46702334#46702334", "title": "How can I merge referenced assembly into single .dll for Dynamics CRM plugin?", "body": "<blockquote>\n  <p>I am unable to find any documentation that could further help in ensuring that my referenced DocumentFormat.OpenXml.dll actually gets merged into my target .dll.</p>\n</blockquote>\n\n<p>You can use any decompiler (ex: dotPeek) to see the content of merged dll &amp; verify.</p>\n\n<blockquote>\n  <p>when I update the plugin with the new .dll, I get the same \"Could not load file or assembly\" error message.</p>\n</blockquote>\n\n<p>Instead of updating the existing plugin in PRT, unregister the existing &amp; register the new assembly with merged dll.</p>\n"}], "owner": {"reputation": 1238, "user_id": 1075932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8efd92b51f5897d9421fb198f932d8b2?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/1075932/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 46702334, "answer_count": 1, "score": 1, "last_activity_date": 1508032495, "creation_date": 1507763283, "last_edit_date": 1508032495, "question_id": 46698874, "link": "https://stackoverflow.com/questions/46698874/how-can-i-merge-referenced-assembly-into-single-dll-for-dynamics-crm-plugin", "title": "How can I merge referenced assembly into single .dll for Dynamics CRM plugin?", "body": "<p>I've followed every guide I could find related to <code>ILMerge</code> in order to merge a third party .dll into a custom Dynamics CRM plugin (.dll) so that I may use the functionality.</p>\n\n<p>I am writing a Dynamics CRM plugin that will take a .docx document, populate some information, and add an annotation (Note) to an associated entity.  Retrieving the document template and creating an annotation work fine. so, I know my plugin is sound (registers and runs okay).  </p>\n\n<p>However, once I attempt to use <code>DocumentFormat.OpenXml</code> to manipulate my document template, I get an error that Dynamics CRM:</p>\n\n<blockquote>\n  <p>Could not load file or assembly 'DocumentFormat.OpenXml, Version=2.5.5631.0.......\"  </p>\n</blockquote>\n\n<p>After doing some research, I found that I needed to \"merge\" the <code>DocumentFormat.OpenXml.dll</code> into my plugin .dll.</p>\n\n<p>I installed <code>MSBuild.ILMerge.Task</code> (and ILMerge) in VS2015.  During the build process, I now get two messages \"Transitive merge\" and \"Merged assemblies:  <em>pathname</em>\\my.dll; <em>pathname</em>\\DocumentFormat.OpenXml.dll\".  It seemed to do what I needed. However, when I update the plugin with the new .dll, I get the same \"<em>Could not load file or assembly</em>\" error message.</p>\n\n<p>I am unable to find any documentation that could further help in ensuring that my referenced DocumentFormat.OpenXml.dll actually gets merged into my target .dll.</p>\n"}, {"tags": ["c#", ".net", "wpf", "visual-studio"], "comments": [{"owner": {"reputation": 1529, "user_id": 1933308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/l6fcp.jpg?s=128&g=1", "display_name": "zambonee", "link": "https://stackoverflow.com/users/1933308/zambonee"}, "edited": false, "score": 0, "creation_date": 1507763231, "post_id": 46698812, "comment_id": 80345297, "body": "Without seeing the rest of your code, I have a hunch you are looking for <code>(sender as TextBox).BackColor = Color.White;</code>."}, {"owner": {"reputation": 149, "user_id": 4823319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6l3VlRzW4u0/AAAAAAAAAAI/AAAAAAAAAB4/h6zHPx0FhLM/photo.jpg?sz=128", "display_name": "Tony Lancer", "link": "https://stackoverflow.com/users/4823319/tony-lancer"}, "edited": false, "score": 0, "creation_date": 1507763251, "post_id": 46698812, "comment_id": 80345303, "body": "No, I changed my code to <code>Textbox textbox = sender as Textbox textbox.BackColour = Color.White</code> That&#39;s where I get the <code>NullReferenceException</code>."}, {"owner": {"reputation": 1529, "user_id": 1933308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/l6fcp.jpg?s=128&g=1", "display_name": "zambonee", "link": "https://stackoverflow.com/users/1933308/zambonee"}, "edited": false, "score": 1, "creation_date": 1507763309, "post_id": 46698812, "comment_id": 80345319, "body": "It also sounds like sender is not a TextBox if you are getting a NullReferenceException"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1507768659, "post_id": 46698812, "comment_id": 80346579, "body": "You should do this with a style instead. You won&#39;t get any null reference exceptions that way."}, {"owner": {"reputation": 149, "user_id": 4823319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6l3VlRzW4u0/AAAAAAAAAAI/AAAAAAAAAB4/h6zHPx0FhLM/photo.jpg?sz=128", "display_name": "Tony Lancer", "link": "https://stackoverflow.com/users/4823319/tony-lancer"}, "reply_to_user": {"reputation": 1529, "user_id": 1933308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/l6fcp.jpg?s=128&g=1", "display_name": "zambonee", "link": "https://stackoverflow.com/users/1933308/zambonee"}, "edited": false, "score": 0, "creation_date": 1507769120, "post_id": 46698812, "comment_id": 80346689, "body": "@zambonee, that doesn&#39;t work (if that was a suggestion)"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1507769636, "post_id": 46698812, "comment_id": 80346798, "body": "@TonyLancer How are you assigning this event to the textboxes? Can you show ALL references to this event in your XAML? Can you put a breakpoint on the open curly brace of the event handler, and when it breaks into the debugger, hover the mouse over <code>sender</code>? If <code>sender</code> isn&#39;t a TextBox, you can&#39;t cast it as one. If <code>sender</code> isn&#39;t a TextBox, you put the event on the wrong control."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1507769745, "post_id": 46698812, "comment_id": 80346824, "body": "@TonyLancer &quot;That doesn&#39;t work&quot; isn&#39;t very specific. On Stack Overflow, we ask people to provide much more detail about problems. We need to know if it failed to compile, or threw an exception at runtime. If it did throw an exception, we need to know which exception, and often we want to see the stack trace as well."}], "answers": [{"tags": [], "owner": {"reputation": 312, "user_id": 6255303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8854ff22b291a0695a6ec42fc3c19a92?s=128&d=identicon&r=PG&f=1", "display_name": "lvoros", "link": "https://stackoverflow.com/users/6255303/lvoros"}, "is_accepted": false, "score": 1, "last_activity_date": 1507787441, "creation_date": 1507787441, "answer_id": 46702293, "question_id": 46698812, "link": "https://stackoverflow.com/questions/46698812/colour-multiple-textboxes-with-one-method-wpf/46702293#46702293", "title": "Colour multiple textboxes with one method wpf", "body": "<p>First of all: TextBox has only the property Background and not BackColor!</p>\n\n<p>If you want to change the color of the focused TextBox, a simple way is, to use a Style with a Trigger.</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;Style TargetType=\"TextBox\" x:Key=\"TextBoxFocusBackgroundStyle\" BasedOn=\"{StaticResource {x:Type TextBox}}\"&gt;\n        &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"IsFocused\" Value=\"true\" &gt;\n                &lt;Setter Property=\"Background\" Value=\"Brown\" /&gt;\n            &lt;/Trigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>As you can see, the Trigger watches on the property IsFocused. If the TextBox got the Focus (so IsFocused changes to true), the Background will be brown.</p>\n\n<p>To use this Style:</p>\n\n<pre><code>&lt;StackPanel&gt;\n    &lt;TextBox Text=\"Peter\" Style=\"{StaticResource TextBoxFocusBackgroundStyle}\"/&gt;\n    &lt;TextBox Text=\"Laszlo\" Style=\"{StaticResource TextBoxFocusBackgroundStyle}\"/&gt;\n    &lt;TextBox Text=\"Julia\" Style=\"{StaticResource TextBoxFocusBackgroundStyle}\"/&gt;\n    &lt;TextBox Text=\"Romeo\" Style=\"{StaticResource TextBoxFocusBackgroundStyle}\"/&gt;\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>If you already has a Style for the TextBoxes you should use that Style in the BasedOn attribute.</p>\n"}], "owner": {"reputation": 149, "user_id": 4823319, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6l3VlRzW4u0/AAAAAAAAAAI/AAAAAAAAAB4/h6zHPx0FhLM/photo.jpg?sz=128", "display_name": "Tony Lancer", "link": "https://stackoverflow.com/users/4823319/tony-lancer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1507787441, "creation_date": 1507762843, "question_id": 46698812, "link": "https://stackoverflow.com/questions/46698812/colour-multiple-textboxes-with-one-method-wpf", "title": "Colour multiple textboxes with one method wpf", "body": "<p>I have a method that is supposed to color the background of a textbox that is on focus(Enter)</p>\n\n<pre><code> private void onEnter_ColourChange(object sender, EventArgs e)\n    {\n        this.BackColor = Color.White;\n    }\n</code></pre>\n\n<p>This doesn't work, however. I checked this <a href=\"https://stackoverflow.com/questions/44843044/one-event-for-multiple-textboxes-wpf#44843082\">answer</a>, but I just got a NullReferenceException.</p>\n\n<p>Essentially, I would like to color multiple textboxes when the textbox is in focus, with one method. Is there a way to do this?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 4035, "user_id": 4162955, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/LXfGt.png?s=128&g=1", "display_name": "Ziv Weissman", "link": "https://stackoverflow.com/users/4162955/ziv-weissman"}, "edited": false, "score": 0, "creation_date": 1507762347, "post_id": 46698698, "comment_id": 80345043, "body": "oO 100-what_you_get?"}, {"owner": {"reputation": 2115, "user_id": 6810689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OP5tU.jpg?s=128&g=1", "display_name": "Scott Perham", "link": "https://stackoverflow.com/users/6810689/scott-perham"}, "edited": false, "score": 0, "creation_date": 1507762390, "post_id": 46698698, "comment_id": 80345058, "body": "er... 100 - {free space as percentage} ? :)"}, {"owner": {"reputation": 25889, "user_id": 245183, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78abf6a54b468eea1a39282e705878a8?s=128&d=identicon&r=PG", "display_name": "Ondrej Tucny", "link": "https://stackoverflow.com/users/245183/ondrej-tucny"}, "edited": false, "score": 0, "creation_date": 1507762548, "post_id": 46698698, "comment_id": 80345107, "body": "I&#39;m voting to close this question as off-topic because it&#39;s about basic math, not programming."}], "answers": [{"tags": [], "owner": {"reputation": 71114, "user_id": 567435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zYyZz.jpg?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/567435/rahul"}, "is_accepted": true, "score": 1, "last_activity_date": 1507762337, "creation_date": 1507762337, "answer_id": 46698743, "question_id": 46698698, "link": "https://stackoverflow.com/questions/46698698/getting-drive-used-space-as-percentage/46698743#46698743", "title": "Getting Drive Used Space as Percentage", "body": "<p>It would almost be same as the linked answer like</p>\n\n<pre><code>DriveInfo drive = new DriveInfo(\"C\");\ndouble percentFree = 100 * (double)(drive.TotalSize - drive.AvailableFreeSpace) / drive.TotalSize;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 0, "last_activity_date": 1507762444, "creation_date": 1507762444, "answer_id": 46698757, "question_id": 46698698, "link": "https://stackoverflow.com/questions/46698698/getting-drive-used-space-as-percentage/46698757#46698757", "title": "Getting Drive Used Space as Percentage", "body": "<pre><code>DriveInfo drive = new DriveInfo(\"C\");\nvar totalUsed = drive.TotalSize-drive.TotalFreeSpace;\nvar percentUsed = 100 * (double)totalUsed / drive.TotalSize;\n</code></pre>\n"}], "owner": {"reputation": 1188, "user_id": 3342256, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/500048741/picture?type=large", "display_name": "user3342256", "link": "https://stackoverflow.com/users/3342256/user3342256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 46698743, "answer_count": 2, "score": -1, "last_activity_date": 1507762444, "creation_date": 1507762120, "question_id": 46698698, "link": "https://stackoverflow.com/questions/46698698/getting-drive-used-space-as-percentage", "title": "Getting Drive Used Space as Percentage", "body": "<p>I have found the following post which gives me the inverse of what I want (<a href=\"https://stackoverflow.com/questions/2984629/how-to-find-the-free-percentage-of-a-drive-in-c-sharp\">how to find the free percentage of a drive in c#</a>), but I can't quite wrap my head around how to return the USED space of a drive as a percentage.</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 71114, "user_id": 567435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zYyZz.jpg?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/567435/rahul"}, "edited": false, "score": 0, "creation_date": 1507761981, "post_id": 46698657, "comment_id": 80344944, "body": "cause <code>QuoteAddress</code> isn&#39;t same as <code>Address</code>. Co-variance in classes are not supported"}, {"owner": {"reputation": 484, "user_id": 4522506, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/azaHE.jpg?s=128&g=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4522506/pavel"}, "reply_to_user": {"reputation": 71114, "user_id": 567435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zYyZz.jpg?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/567435/rahul"}, "edited": false, "score": 0, "creation_date": 1507762057, "post_id": 46698657, "comment_id": 80344963, "body": "But by definition of inheritance, a QuoteAddress is an Address."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507762078, "post_id": 46698657, "comment_id": 80344971, "body": "what is type of <code>c1.Addresses</code>? I suppose its type of <code>AddressCollection&lt;Address&gt;</code>"}, {"owner": {"reputation": 71114, "user_id": 567435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zYyZz.jpg?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/567435/rahul"}, "edited": false, "score": 0, "creation_date": 1507762093, "post_id": 46698657, "comment_id": 80344978, "body": "read about <code>Covariance</code> in Generics"}, {"owner": {"reputation": 484, "user_id": 4522506, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/azaHE.jpg?s=128&g=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4522506/pavel"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507762220, "post_id": 46698657, "comment_id": 80345010, "body": "@M.kazemAkhgary c1.Addresses is of type AddressCollection&lt;QuoteAddress&gt;"}, {"owner": {"reputation": 91923, "user_id": 41956, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b9da2ca6abf3a1e28fb470f2b3ae2c34?s=128&d=identicon&r=PG", "display_name": "abatishchev", "link": "https://stackoverflow.com/users/41956/abatishchev"}, "edited": false, "score": 0, "creation_date": 1507762259, "post_id": 46698657, "comment_id": 80345023, "body": "It will work only if you convert <code>c1.Addresses</code> to <code>AddressCollection&lt;Address&gt;</code>"}, {"owner": {"reputation": 484, "user_id": 4522506, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/azaHE.jpg?s=128&g=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4522506/pavel"}, "reply_to_user": {"reputation": 91923, "user_id": 41956, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b9da2ca6abf3a1e28fb470f2b3ae2c34?s=128&d=identicon&r=PG", "display_name": "abatishchev", "link": "https://stackoverflow.com/users/41956/abatishchev"}, "edited": false, "score": 0, "creation_date": 1507762353, "post_id": 46698657, "comment_id": 80345045, "body": "@abatishchev not sure how. I tried c1.Addresses.Cast&lt;Address&gt;() as AddressCollection&lt;Address&gt; but that just returns a null."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507762446, "post_id": 46698657, "comment_id": 80345077, "body": "@Pavel does your collection in <code>Client1</code> have to be always in sync with <code>CurrentAddressCollection</code>? that is when you change collection in <code>Client1</code> do you expect <code>CurrentAddressCollection</code> to change as well?"}, {"owner": {"reputation": 484, "user_id": 4522506, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/azaHE.jpg?s=128&g=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4522506/pavel"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507762550, "post_id": 46698657, "comment_id": 80345108, "body": "@M.kazemAkhgary yes. More importantly, the other way around. AddressControl is a Web UserControl where users can add/remove addresses. When they add/remove address from CurrentAddressCollection, the client&#39;s Addresses also need to see these changes."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507762690, "post_id": 46698657, "comment_id": 80345149, "body": "if user should be able to<code>add&#47;remove</code> on <code>AddressControl</code>&#39;s collection  then <code>covariance</code> wont help you here. you need a collection adapter that will be simply a wrapper around <code>AddressCollection&lt;Address&gt;</code> and filters items to <code>QuoteAddress</code>"}, {"owner": {"reputation": 484, "user_id": 4522506, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/azaHE.jpg?s=128&g=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4522506/pavel"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507763098, "post_id": 46698657, "comment_id": 80345260, "body": "@M.kazemAkhgary My understanding is that this wrapper will do casting behind the scenes, but I&#39;m still struggling with the basic concept of converting from a collection of QuoteAddress to collection of Address."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507763428, "post_id": 46698657, "comment_id": 80345345, "body": "converting a collection to other type requires copying from the main collection to new collection and convert each item. in that case,copied collection will have different reference of main collection, they become completely separate collections. so if you change new collection, changes wont reflect main one (or viceversa). on the other hand, covariance doesn&#39;t copy, it will cast, but it will be a cast into a read only interface so you can not change collection with interface. you got it pretty right. wrapper has main collection underneath, but will only show you items that are of type address"}, {"owner": {"reputation": 484, "user_id": 4522506, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/azaHE.jpg?s=128&g=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4522506/pavel"}, "edited": false, "score": 0, "creation_date": 1507763442, "post_id": 46698657, "comment_id": 80345352, "body": "Ideally, AddressControl&#39;s CurrentAddressCollection property would look like this instead:  public AddressCollection&lt;T&gt; CurrentAddressCollection { get; set; } But this is not allowed, the type or namespace name &#39;T&#39; could not be found."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1507763884, "post_id": 46698657, "comment_id": 80345454, "body": "Two questions linked as duplicates explain the fact that A : B does not mean C&lt;A&gt; : C&lt;B&gt;. It sounds like you actually want something quite different from what questions actually asks about but it is not reflected in the post. You may want to think what you actually need, clarify that and ask as new question."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1507764129, "post_id": 46698657, "comment_id": 80345512, "body": "(And for your edit - duplicates simply state that you can&#39;t do that if you need write access to collection - please re-read accepted answer <a href=\"https://stackoverflow.com/a/3720845/477420\">stackoverflow.com/a/3720845/477420</a> or more lighthearted version <a href=\"https://stackoverflow.com/a/1817341/477420\">stackoverflow.com/a/1817341/477420</a>)"}], "owner": {"reputation": 484, "user_id": 4522506, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/azaHE.jpg?s=128&g=1", "display_name": "Pavel", "link": "https://stackoverflow.com/users/4522506/pavel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 311, "favorite_count": 0, "closed_date": 1507763434, "answer_count": 0, "score": 0, "last_activity_date": 1507763989, "creation_date": 1507761789, "last_edit_date": 1507763989, "question_id": 46698657, "link": "https://stackoverflow.com/questions/46698657/net-casting-error-cannot-implicitly-convert-type", "closed_reason": "Duplicate", "title": ".NET casting error: Cannot implicitly convert type", "body": "<p>I have a class QuoteAddress which inherits from Address, and a generic collection called AddressCollection which holds these address objects. </p>\n\n<p>When I try to cast a QuoteAddress to Address, <strong>everything works fine</strong>.\nBut when I try to cast AddressCollection&lt;<strong>QuoteAddress</strong>> to AddressCollection&lt;<strong>Address</strong>> I get a compile-time error:</p>\n\n<blockquote>\n  <p>Cannot implicitly cast type AddressCollection&lt;<strong>QuoteAddress</strong>> to\n  AddressCollection&lt;<strong>Address</strong>>.</p>\n</blockquote>\n\n<p><strong>EDIT</strong>: I don't believe this question is a duplicate because the suggested duplicate question assumes the collection is ReadOnly. I need to be able to Add/Remove items from my collection.</p>\n\n<p>What can I do to work around this? Since one inherits from the other, I thought this would be a straightforward cast.</p>\n\n<pre><code>public class QuoteAddress : Address\n{\n   ...\n}\n</code></pre>\n\n<p>I also have an AddressCollection class which holds these addresses.</p>\n\n<pre><code>public class AddressCollection&lt;T&gt; : AddressHack where T : Address, new()\n{\n   ...\n}\n</code></pre>\n\n<p>I have two client objects that each have a property called Addresses which hold addresses. Client1's Address proprety is of type AddressCollection&lt;<strong>QuoteAddress</strong>>, while Client2's is of type AddressCollection&lt;<strong>Address</strong>>.</p>\n\n<p><strong>Client1</strong></p>\n\n<pre><code>public class Client1\n{\n   ...\n   public AddressCollection&lt;QuoteAddress&gt; Addresses { get; set; }\n   ...\n}\n</code></pre>\n\n<p><strong>Client2</strong></p>\n\n<pre><code>public class Client2\n{\n   ...\n   public AddressCollection&lt;Address&gt; Addresses { get; set; }\n   ...\n}\n</code></pre>\n\n<p>Lastly, I have an AddressControl class with a properties called CurrentAddressCollection of type AddressCollection&lt;<strong>Address</strong>> and CurrentAddress of type Address.</p>\n\n<pre><code>public class AddressControl : System.Web.UI.UserControl\n{\n   public Address CurrentAddress { get; set; }\n   public AddressCollection&lt;Address&gt; CurrentAddressCollection { get; set; }\n}\n\n\nClient1 c1 = new Client1();\nAddressControl.CurrentAddress = c1.Addresses.GetFirstAddress(); // GetFirstAddress returns type of QuoteAddress\nAddressControl.CurrentAddressCollection = c1.Addresses; // compile-time error\n\nClient2 c2 = new Client2 ();\nAddressControl.CurrentAddress = c2.Addresses.GetFirstAddress(); // GetFirstAddress returns type of Address\nAddressControl.CurrentAddressCollection = c2.Addresses; // no problems\n</code></pre>\n"}, {"tags": ["c#", "computational-geometry"], "comments": [{"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 4, "creation_date": 1507826401, "post_id": 46698537, "comment_id": 80375797, "body": "Debugging your program and keeping us up-to-date about the state of your debugging session is not an effective use of StackOverflow. This isn&#39;t a service for finding your bugs.  If you want to know if a method is correct then <b>write test cases for that method</b>.  If you want more good advice on how to debug a small buggy program that you just wrote, see <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 315, "user_id": 4367913, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/RSoYe.jpg?s=128&g=1", "display_name": "pbordeaux", "link": "https://stackoverflow.com/users/4367913/pbordeaux"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1507828161, "post_id": 46698537, "comment_id": 80376743, "body": "@EricLippert, thanks for the advice. I was simply trying to provide as much info as possible but appreciate what you are saying. I am in the process of writing unit tests at the moment. I will edit my question accordingly after."}, {"owner": {"reputation": 298, "user_id": 3225391, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1856e5b9382e0c4c388180e4124af62a?s=128&d=identicon&r=PG&f=1", "display_name": "ephraim", "link": "https://stackoverflow.com/users/3225391/ephraim"}, "edited": false, "score": 0, "creation_date": 1514969210, "post_id": 46698537, "comment_id": 83121435, "body": "Any way - using Theraot.Core makes you have to use &quot;extern alias&quot; and give an alias to that dll, otherwise you&#39;ll find yourself having ambigous calls vs System.Linq functions...They built that dll in the same namespace."}, {"owner": {"reputation": 950, "user_id": 2542768, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95bd7d816ffab4879f715ae1998e212e?s=128&d=identicon&r=PG", "display_name": "Wize", "link": "https://stackoverflow.com/users/2542768/wize"}, "edited": false, "score": 0, "creation_date": 1535710806, "post_id": 46698537, "comment_id": 91177093, "body": "Hi, Do you have an updated version of this code?"}], "answers": [{"tags": [], "owner": {"reputation": 298, "user_id": 3225391, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1856e5b9382e0c4c388180e4124af62a?s=128&d=identicon&r=PG&f=1", "display_name": "ephraim", "link": "https://stackoverflow.com/users/3225391/ephraim"}, "is_accepted": true, "score": 1, "last_activity_date": 1514985268, "creation_date": 1514985268, "answer_id": 48078142, "question_id": 46698537, "link": "https://stackoverflow.com/questions/46698537/concave-hull-implementation/48078142#48078142", "title": "Concave Hull implementation", "body": "<p>You have some bug:</p>\n\n<pre><code>var kNearest = KNearestNeighbors(dataset, currentPoint, k, out kk);\n</code></pre>\n\n<p>Change the kk to just some var. You override the incrementation of that \"kk\" value, and then you're getting StackOverflow exceptions.</p>\n\n<p>Change your code to the following:</p>\n\n<pre><code>int someVal;    \nvar kNearest = KNearestNeighbors(dataset, currentPoint, k, out someVal);\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 4367913, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/RSoYe.jpg?s=128&g=1", "display_name": "pbordeaux", "link": "https://stackoverflow.com/users/4367913/pbordeaux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1490, "favorite_count": 1, "accepted_answer_id": 48078142, "answer_count": 1, "score": 1, "last_activity_date": 1514985268, "creation_date": 1507760985, "last_edit_date": 1507907636, "question_id": 46698537, "link": "https://stackoverflow.com/questions/46698537/concave-hull-implementation", "title": "Concave Hull implementation", "body": "<p>I am trying to implement the algorithm described in the following <a href=\"http://repositorium.sdum.uminho.pt/bitstream/1822/6429/1/ConcaveHull_ACM_MYS.pdf\" rel=\"nofollow noreferrer\">http://repositorium.sdum.uminho.pt/bitstream/1822/6429/1/ConcaveHull_ACM_MYS.pdf</a></p>\n\n<p>I am using the following class libraries. Loyc libs come from <a href=\"http://core.loyc.net/\" rel=\"nofollow noreferrer\">http://core.loyc.net/</a> </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Device.Location;\nusing Loyc.Collections;\nusing Loyc.Geometry;\nusing Loyc;\n</code></pre>\n\n<p>Here is the basic class</p>\n\n<pre><code>public class Hulls\n{\n    private static List&lt;Point&lt;double&gt;&gt; KNearestNeighbors(List&lt;Point&lt;double&gt;&gt; points, Point&lt;double&gt; currentPoint, int k, out int kk)\n    {\n        kk = Math.Min(k, points.Count - 1);\n        var ret = points\n            .OrderBy(x =&gt; PointMath.Length(new Vector&lt;double&gt;(currentPoint.X - x.X, currentPoint.Y - x.Y)))\n            .Take(k)\n            .ToList();\n        return ret;\n    }\n    private static double Angle(Point&lt;double&gt; a, Point&lt;double&gt; b)\n    {\n        var ret = -Math.Atan2(b.Y - a.Y, b.X - a.X);\n        return NormaliseAngle(ret);\n    }\n    private static double NormaliseAngle(double a)\n    {\n        //while (a &lt; b - Math.PI) a += Math.PI * 2;\n        //while (b &lt; a - Math.PI) b += Math.PI * 2;\n        if (a &lt; 0.0) { return a + Math.PI + Math.PI; }\n        return a;\n    }\n    private static List&lt;Point&lt;double&gt;&gt; SortByAngle(List&lt;Point&lt;double&gt;&gt; kNearest, Point&lt;double&gt; currentPoint, double angle)\n    {\n        //kNearest\n        //    .Sort((v1, v2) =&gt; AngleDifference(angle, Angle(currentPoint, v1)).CompareTo(AngleDifference(angle, Angle(currentPoint, v2))));\n        //return kNearest.ToList();\n        kNearest = kNearest.OrderByDescending(x =&gt; NormaliseAngle(Angle(currentPoint, x) - angle)).ToList();\n        return kNearest;\n    }\n\n    private static bool CCW(Point&lt;double&gt; p1, Point&lt;double&gt; p2, Point&lt;double&gt; p3)\n    {\n        var cw = ((p3.Y - p1.Y) * (p2.X - p1.X)) - ((p2.Y - p1.Y) * (p3.X - p1.X));\n        return cw &gt; 0 ? true : cw &lt; 0 ? false : true; // colinear \n    }\n\n    private static bool _Intersect(LineSegment&lt;double&gt; seg1, LineSegment&lt;double&gt; seg2)\n    {\n        return CCW(seg1.A, seg2.A, seg2.B) != CCW(seg1.B, seg2.A, seg2.B) &amp;&amp; CCW(seg1.A, seg1.B, seg2.A) != CCW(seg1.A, seg1.B, seg2.B);\n    }\n\n    private static bool Intersect(LineSegment&lt;double&gt; seg1, LineSegment&lt;double&gt; seg2)\n    {\n        if ((seg1.A.X == seg2.A.X &amp;&amp; seg1.A.Y == seg2.A.Y) \n            || (seg1.B.X == seg2.B.X &amp;&amp; seg1.B.Y == seg2.B.Y))\n        {\n            return false;\n        }\n        if (_Intersect(seg1, seg2))\n        {\n            return true;\n        }\n        return false;\n    }\n\n    public IListSource&lt;Point&lt;double&gt;&gt; KNearestConcaveHull(List&lt;Point&lt;double&gt;&gt; points, int k)\n    {\n        points.Sort((a, b) =&gt; a.Y == b.Y ? (a.X &gt; b.X ? 1 : -1) : (a.Y &gt;= b.Y ? 1 : -1));\n        Console.WriteLine(\"Starting with size {0}\", k.ToString());\n\n        DList&lt;Point&lt;double&gt;&gt; hull = new DList&lt;Point&lt;double&gt;&gt;();\n        var len = points.Count;\n\n        if (len &lt; 3) { return null; }\n        if (len == 3) { return hull; }\n\n        var kk = Math.Min(Math.Max(k, 3), len);\n\n        var dataset = new List&lt;Point&lt;double&gt;&gt;();\n        dataset.AddRange(points.Distinct());\n\n        var firstPoint = dataset[0];\n        hull.PushFirst(firstPoint);\n\n        var currentPoint = firstPoint;\n        dataset.RemoveAt(0);\n\n        double previousAngle = 0;\n        int step = 2;\n        int i;\n        while ((currentPoint != firstPoint || step == 2) &amp;&amp; dataset.Count &gt; 0)\n        {\n            if (step == 5) { dataset.Add(firstPoint); }\n            var kNearest = KNearestNeighbors(dataset, currentPoint, k, out kk);\n            var cPoints = SortByAngle(kNearest, currentPoint, previousAngle);\n            var its = true;\n            i = 0;\n            while (its == true &amp;&amp; i &lt; cPoints.Count)\n            {\n                i++;\n                int lastPoint = 0;\n                if (cPoints[i - 1] == firstPoint)\n                {\n                    lastPoint = 1;\n                }\n                int j = 2;\n                its = false;\n                while (its == false &amp;&amp; j &lt; hull.Count - lastPoint)\n                {\n                    LineSegment&lt;double&gt; line1 = new LineSegment&lt;double&gt;(hull[step - 2], cPoints[i - 1]);\n                    LineSegment&lt;double&gt; line2 = new LineSegment&lt;double&gt;(hull[step - 2 - j], hull[step - 1 - j]);\n\n                    //its = LineMath.ComputeIntersection(line1, line2, out pfrac, LineType.Segment);\n                    its = Intersect(line1, line2);\n                    j++;\n                }\n            }\n            if (its == true)\n            {\n                return KNearestConcaveHull(points, kk + 1);\n            }\n            currentPoint = cPoints[i - 1];\n            hull.PushLast(currentPoint);\n            previousAngle = Angle(hull[step - 1], hull[step - 2]);\n            dataset.Remove(currentPoint); \n            step++;\n        }\n        bool allInside = true;\n        i = dataset.Count;\n        while (allInside == true &amp;&amp; i &gt; 0)\n        {\n            allInside = PolygonMath.IsPointInPolygon(hull, dataset[i - 1]);\n            i--;\n        }\n        if (allInside == false) { return KNearestConcaveHull(points, kk + 1); }\n        return hull;\n    }\n}\n</code></pre>\n\n<p>The above is supposed to pick a new edge for the boundary based on the furthest right-hand turn from the previous edge going around the point set counterclockwise. The code seems to pick the correct first edge from the initial vertex which has the lowest y-value, but then does not pick the next edge correctly when the offset angle is nonzero. I think the issue is the SortByAngle or Angle. -atan2 would return the clockwise turn, correct? Possibly I should be adding the offset angle?</p>\n\n<p>EDIT (SOLUTION): Found the issue after following Eric's helpful advice provided in the first comment to the question. It was SortByAngle and Angle: </p>\n\n<pre><code>private static double Angle(Point&lt;double&gt; a, Point&lt;double&gt; b)\n    {\n        var ret = Math.Atan2(b.Y - a.Y, b.X - a.X);\n        return NormaliseAngle(ret);\n    }\n\n    private static double NormaliseAngle(double a)\n    {\n        if (a &lt; 0.0) { return a + Math.PI + Math.PI; }\n        return a;\n    }\n\n    private static List&lt;Point&lt;double&gt;&gt; SortByAngle(List&lt;Point&lt;double&gt;&gt; kNearest, Point&lt;double&gt; currentPoint, double angle)\n    {\n        //kNearest = kNearest.OrderByDescending(x =&gt; NormaliseAngle(Angle(currentPoint, x) - angle)).ToList();\n        kNearest.Sort((a, b) =&gt; NormaliseAngle(Angle(currentPoint, a) - angle) &gt; NormaliseAngle(Angle(currentPoint, b) - angle) ? 1 : -1);\n        return kNearest;\n    }\n</code></pre>\n"}, {"tags": ["c#", "xamarin", "xamarin.forms", "xamarin.mac"], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 2391304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f725c629885bc4ccf621c8154515d344?s=128&d=identicon&r=PG", "display_name": "Yini", "link": "https://stackoverflow.com/users/2391304/yini"}, "edited": false, "score": 0, "creation_date": 1557520667, "post_id": 46701630, "comment_id": 98807328, "body": "Hi SushiHangover, do you have a github repo or something for your source code ? I am new to xamarin would be nice to have some sample to follow. Thanks"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "reply_to_user": {"reputation": 671, "user_id": 2391304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f725c629885bc4ccf621c8154515d344?s=128&d=identicon&r=PG", "display_name": "Yini", "link": "https://stackoverflow.com/users/2391304/yini"}, "edited": false, "score": 0, "creation_date": 1557524422, "post_id": 46701630, "comment_id": 98808502, "body": "@Yini I doubt I still have that example around after 1.5 years, but if I find it later, I&#39;ll send you another comment..."}, {"owner": {"reputation": 671, "user_id": 2391304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f725c629885bc4ccf621c8154515d344?s=128&d=identicon&r=PG", "display_name": "Yini", "link": "https://stackoverflow.com/users/2391304/yini"}, "edited": false, "score": 0, "creation_date": 1557615598, "post_id": 46701630, "comment_id": 98825737, "body": "Thanks! I&#39;ll try to do up a hack myself see how it goes."}, {"owner": {"reputation": 671, "user_id": 2391304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f725c629885bc4ccf621c8154515d344?s=128&d=identicon&r=PG", "display_name": "Yini", "link": "https://stackoverflow.com/users/2391304/yini"}, "edited": false, "score": 0, "creation_date": 1558042381, "post_id": 46701630, "comment_id": 98980271, "body": "hey thanks for looking into it. I&#39;ve decided to install windows on Mac and access webcam from there."}, {"owner": {"reputation": 661, "user_id": 1700775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b6babf699e0d7215b68663a72c96dfc?s=128&d=identicon&r=PG", "display_name": "Amir Hajiha", "link": "https://stackoverflow.com/users/1700775/amir-hajiha"}, "edited": false, "score": 1, "creation_date": 1566654785, "post_id": 46701630, "comment_id": 101729206, "body": "Would be great to have this solution implemented in Xamarin.Forms.macOS"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "reply_to_user": {"reputation": 661, "user_id": 1700775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b6babf699e0d7215b68663a72c96dfc?s=128&d=identicon&r=PG", "display_name": "Amir Hajiha", "link": "https://stackoverflow.com/users/1700775/amir-hajiha"}, "edited": false, "score": 1, "creation_date": 1566673386, "post_id": 46701630, "comment_id": 101733323, "body": "@AmirNo-Family That code sample was from a Xamarin.Forms project, using a custom Forms&#39; View renderer."}], "tags": [], "owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "is_accepted": true, "score": 6, "last_activity_date": 1509389879, "last_edit_date": 1509389879, "creation_date": 1507783852, "answer_id": 46701630, "question_id": 46698517, "link": "https://stackoverflow.com/questions/46698517/access-macbook-camera-using-c-and-xamarin-mac-forms-on-visual-studio/46701630#46701630", "title": "Access MacBook camera using C# and Xamarin.Mac forms on Visual Studio?", "body": "<p>You will want to review the <code>AVFoundation</code> APIs (<code>QTKit</code> is deprecated).</p>\n\n<p>You can create a custom Xamarin.Forms View renderer based on a <code>NSView</code> and assign the <code>AVCaptureVideoPreviewLayer</code> as the control's layer to stream the camera output to this control.</p>\n\n<p>Store class level references to following and make sure you <code>Dispose</code> them when your control goes out of scope otherwise there will be leaks: </p>\n\n<pre><code>AVCaptureDevice device;\nAVCaptureDeviceInput input;\nAVCaptureStillImageOutput output;\nAVCaptureSession session;\n</code></pre>\n\n<p>In your capture setup, you can grab the default AV device assuming you want to use the build-in FaceTime Camera (also known as <code>iSight</code>).</p>\n\n<p>macOS/Forms Example:</p>\n\n<pre><code>device = AVCaptureDevice.GetDefaultDevice(AVMediaTypes.Video);\ninput = AVCaptureDeviceInput.FromDevice(device, out var error);\nif (error == null)\n{\n    session = new AVCaptureSession();\n    session.AddInput(input);\n    session.SessionPreset = AVCaptureSession.PresetPhoto;\n    var previewLayer = AVCaptureVideoPreviewLayer.FromSession(session);\n    previewLayer.Frame = Control.Bounds;\n    Control.Layer = previewLayer;\n    output = new AVCaptureStillImageOutput();\n    session.AddOutput(output);\n    session.StartRunning();\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LeGGv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LeGGv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note: A lot of the <code>AVFoundation</code> framework is shared between iOS and MacOS, but there are some differences so if you end up looking at iOS sample code be aware you might need to alter it for macOS.</p>\n\n<ul>\n<li><a href=\"https://developer.apple.com/documentation/avfoundation\" rel=\"nofollow noreferrer\">https://developer.apple.com/documentation/avfoundation</a></li>\n</ul>\n"}], "owner": {"reputation": 177, "user_id": 3984614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ce74c6adb7a79103fce85f7f925dd1?s=128&d=identicon&r=PG&f=1", "display_name": "net30", "link": "https://stackoverflow.com/users/3984614/net30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "accepted_answer_id": 46701630, "answer_count": 1, "score": 4, "last_activity_date": 1509389879, "creation_date": 1507760838, "last_edit_date": 1507783504, "question_id": 46698517, "link": "https://stackoverflow.com/questions/46698517/access-macbook-camera-using-c-and-xamarin-mac-forms-on-visual-studio", "title": "Access MacBook camera using C# and Xamarin.Mac forms on Visual Studio?", "body": "<p>I need to integrate a video stream from my Macbook camera using a Xamarin.Mac form. However, all of the documentation that I find only tells you how to do so in iOS and Android platforms.</p>\n\n<p>How would you go at getting a video stream from a Macbook then? Any libraries I should look at?</p>\n"}, {"tags": ["c#", "unity2d"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1507761746, "post_id": 46698513, "comment_id": 80344875, "body": "There isn&#39;t enough information in your post. Can you describe what you expect <code>OnTriggerEnter2D</code> to do, and what it actually does now?"}, {"owner": {"reputation": 4084, "user_id": 7974050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e021e6e6a4105f47b1ccce712d0af6e?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Kumar Singh", "link": "https://stackoverflow.com/users/7974050/amit-kumar-singh"}, "edited": false, "score": 0, "creation_date": 1507773163, "post_id": 46698513, "comment_id": 80347610, "body": "Where have you declared respawnPoint?"}, {"owner": {"reputation": 5521, "user_id": 1253136, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/78ed265f0b33e2208570927bc7b5dcb4?s=128&d=identicon&r=PG", "display_name": "XenoRo", "link": "https://stackoverflow.com/users/1253136/xenoro"}, "edited": false, "score": 0, "creation_date": 1507774048, "post_id": 46698513, "comment_id": 80347809, "body": "Since <code>TakeDamage</code> is a coroutine (it really doesn&#39;t need to be, btw), and since your description of the problem is &quot;it stopped working&quot; (a useless description, unless you&#39;re talking about the entire program), my guess is that you&#39;re getting stuck on an infinite loop of some sort(?)..."}], "owner": {"reputation": 1, "user_id": 8761864, "user_type": "registered", "profile_image": "https://graph.facebook.com/1440117949369612/picture?type=large", "display_name": "Radu Andrei", "link": "https://stackoverflow.com/users/8761864/radu-andrei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507835901, "creation_date": 1507760810, "last_edit_date": 1507835901, "question_id": 46698513, "link": "https://stackoverflow.com/questions/46698513/code-stopped-working-and-i-dont-get-any-errors", "title": "Code stopped working and I don&#39;t get any errors", "body": "<p>I have the following issue: the <code>//takedamage</code> code below was working but when I added the <code>//respawn</code> code, it stopped working and I don't get any errors. The rest of the game seems to run fine, its just the <code>//takedamage</code> code which doesn't work.</p>\n\n<pre><code>//takedamage\n\npublic override IEnumerator TakeDamage (){\n    health -= 10;\n\n    if (!IsDead) {\n        MyAnimator.SetTrigger (\"damage\");\n    } else {\n        MyAnimator.SetLayerWeight (1, 0);\n        MyAnimator.SetTrigger (\"die\");\n    }\n    yield return null;\n}\n\n//respawn\nvoid OnTriggerEnter2D(Collider2D other){\n    if(other.tag == \"FallDetector\"){\n        transform.position = respawnPoint;\n\n    }\n    if (other.tag == \"Checkpoint\") {\n        respawnPoint = other.transform.position;\n    }\n}\n</code></pre>\n\n<p>I can't figure out what the problem is. I am new to <code>C#</code> so any help is welcome.</p>\n"}, {"tags": ["c#", "excel", "windows"], "comments": [{"owner": {"reputation": 166, "user_id": 5744754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNRWn.png?s=128&g=1", "display_name": "cChacon", "link": "https://stackoverflow.com/users/5744754/cchacon"}, "edited": false, "score": 0, "creation_date": 1507761002, "post_id": 46698508, "comment_id": 80344667, "body": "Is there an error message from your application?  If so, please give the entire message and which line number it occurs."}, {"owner": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "reply_to_user": {"reputation": 166, "user_id": 5744754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNRWn.png?s=128&g=1", "display_name": "cChacon", "link": "https://stackoverflow.com/users/5744754/cchacon"}, "edited": false, "score": 0, "creation_date": 1507761211, "post_id": 46698508, "comment_id": 80344722, "body": "@cChacon yeah sorry, added it to the post"}, {"owner": {"reputation": 166, "user_id": 5744754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNRWn.png?s=128&g=1", "display_name": "cChacon", "link": "https://stackoverflow.com/users/5744754/cchacon"}, "edited": false, "score": 0, "creation_date": 1507761422, "post_id": 46698508, "comment_id": 80344790, "body": "Check Access data file Properties on machine &#39;M&#39;.  Is it &quot;Read only&quot;??"}, {"owner": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "reply_to_user": {"reputation": 166, "user_id": 5744754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNRWn.png?s=128&g=1", "display_name": "cChacon", "link": "https://stackoverflow.com/users/5744754/cchacon"}, "edited": false, "score": 0, "creation_date": 1507761602, "post_id": 46698508, "comment_id": 80344833, "body": "@cChacon , no it is not, in the end the files were created on machine M and transfered to V then back to M, i did create other new excel sheet on M and tested.. same result."}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1507761647, "post_id": 46698508, "comment_id": 80344848, "body": "What is the exact path passed to the method. Are you sure that this path allows the file to be opened in read/write mode by the current user? Permissions, permissions....."}, {"owner": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "reply_to_user": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1507761725, "post_id": 46698508, "comment_id": 80344871, "body": "@Steve ,yes, i do many manipulations with that file&#39;s data, it does get read and processed and displayed, but update is restricted. all users inc this has full control over it permission on it inc. the folder it is in. also program path is folder on desktop and excel is in another folder also on desktop"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "edited": false, "score": 0, "creation_date": 1507823478, "post_id": 46699418, "comment_id": 80374166, "body": "I used the 2007 and 2010 engines, both installed and was working properly, I did install both everywhere else. the problem now exists even on the V machine, which was working fine earlier.. I added the <code>mode=ReadWrite</code> attribute and it caused a problem so I removed it and the file became read only. I will still try installing later engines and test."}, {"owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "reply_to_user": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "edited": false, "score": 0, "creation_date": 1507825547, "post_id": 46699418, "comment_id": 80375352, "body": "@bakz without being able to replicate the error it&#39;s very difficult to offer advice."}, {"owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "reply_to_user": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "edited": false, "score": 0, "creation_date": 1507825852, "post_id": 46699418, "comment_id": 80375505, "body": "@bakz does the excel file contain macros?"}, {"owner": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "edited": false, "score": 0, "creation_date": 1507848204, "post_id": 46699418, "comment_id": 80386599, "body": "no it does not contain any macros, it is a clean sheet I made which i also populated myself.. I don&#39;t know how can you replicate the problem, the V machine that did not have that problem now has it and I don&#39;t know why.. all I did is change the connection string and then reverted change. this is maddening"}, {"owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "reply_to_user": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "edited": false, "score": 0, "creation_date": 1507848647, "post_id": 46699418, "comment_id": 80386727, "body": "@bakz, ok, don&#39;t panic, try not to change the connection string randomly to try an make this work. Be methodical about it. What is the new connection string you are using. Then one that has caused V machine to no longer work. If I can replicate error here with same connection string then all the better. Also what is the name of the file?"}, {"owner": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "edited": false, "score": 0, "creation_date": 1508766257, "post_id": 46699418, "comment_id": 80728967, "body": "I only added &quot;ReadOnly=false&quot; to the connection string, but since it is an extended attribute i placed it badly and did not work, to i returned the connection string back to it&#39;s original working version but the error started occurring in the V Machine... I can&#39;t even circle around what could cause this problem."}, {"owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "reply_to_user": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "edited": false, "score": 0, "creation_date": 1509010143, "post_id": 46699418, "comment_id": 80848311, "body": "@bakz step away from your code for a moment and try the above code on it&#39;s own. Test the engine using some code that is known to work."}], "tags": [], "owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "is_accepted": false, "score": 1, "last_activity_date": 1507822705, "last_edit_date": 1507822705, "creation_date": 1507767156, "answer_id": 46699418, "question_id": 46698508, "link": "https://stackoverflow.com/questions/46698508/excel-c-cannot-update-database-read-only/46699418#46699418", "title": "Excel C# cannot update: database read only", "body": "<p>I had a look, and the open connection is working fine here. </p>\n\n<p>I needed to install the 2016 version of the ACE engine. I see the M machine is running Office 2007. It's unlikely a difference in engine would create a read only problem on connection open; but you never know. It's worth exploring differences in machine configuration when these type of errors happen.</p>\n\n<p>Here is the code I used. This works fine.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Data.OleDb;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace ExcelReadOnly\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            PreProcess(\"Sample File.xlsx\");\n            Console.In.ReadLine();\n        }\n\n        public static bool PreProcess(string dbpath)\n        {\n            string connStr = $\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={dbpath};Extended Properties=\\\"Excel 12.0 Xml;HDR=YES;\\\";\";\n\n            using (var conn = new OleDbConnection(connStr))\n            {\n                conn.Open();\n\n                var cmd = new OleDbCommand(\"SELECT * FROM [Sheet1$]\", conn);\n                var reader = cmd.ExecuteReader();\n                while (reader?.Read() == true)\n                    Console.Out.WriteLine($\"Name: {reader[0]}, Par1: {reader[1]}\");\n                reader?.Close();\n\n                new OleDbCommand(\"INSERT INTO [Sheet1$] ([Name], [Par1]) VALUES ('Name 0', '0')\", conn)\n                    .ExecuteNonQuery();\n                new OleDbCommand(\"INSERT INTO [Sheet1$] ([Name], [Par1]) VALUES ('Name 1', '1')\", conn)\n                    .ExecuteNonQuery();\n                new OleDbCommand(\"INSERT INTO [Sheet1$] ([Name], [Par1]) VALUES ('Name 2', '2')\", conn)\n                    .ExecuteNonQuery();\n\n                reader = cmd.ExecuteReader();\n                while (reader?.Read() == true)\n                    Console.Out.WriteLine($\"Name: {reader[0]}, Par1: {reader[1]}\");\n                reader?.Close();\n            }\n\n            return false;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5647204, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f1093213c7a0be1dd5fb41d1c2a54060?s=128&d=identicon&r=PG&f=1", "display_name": "bakz", "link": "https://stackoverflow.com/users/5647204/bakz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507822705, "creation_date": 1507760792, "last_edit_date": 1507822465, "question_id": 46698508, "link": "https://stackoverflow.com/questions/46698508/excel-c-cannot-update-database-read-only", "title": "Excel C# cannot update: database read only", "body": "<p>I have 2 PCs:</p>\n\n<ul>\n<li>Main M = Win 7, 32 bit, Office 2007</li>\n<li>Virtual V = Win 7, 32 bit, Visual Studio 2013</li>\n</ul>\n\n<p>I created 3 Excel files with data on M and sent via network the V machine where I was constructing a program, the thing is the program works fine and updates the Excel sheet on the V machine, bu does not work on my M machine!</p>\n\n<p>I have tried:</p>\n\n<ul>\n<li>setting permission</li>\n<li>setting \"OleDb-Readonly=false;\"</li>\n<li>tried it on another machine win7 32bit and 64bit</li>\n<li>tried it on a win10 64bit machine</li>\n<li>creating a new excel file on that machine and copying data to the new\nsheet</li>\n<li>started program as administrator on each step above and without</li>\n<li>Chaning the IMEX between 0 and 1</li>\n</ul>\n\n<p>All of them are not working EXCEPT the V machine... WHY?</p>\n\n<p>Note that the V machine does not have office installed, I am trying to get hold of a machine without the office installed (or one I can uninstall it from) to test it, but not sure if that would actually cause the problem.</p>\n\n<p>Also note I am using an Access 2007 connection in the program as well and it is working fine.</p>\n\n<p>here is the C# update code:</p>\n\n<pre><code> public static bool PreProcess(string dbpath)\n{\n    //string file = System.IO.Path.Combine(\"./\", dbpath);\n    string connStr = string.Format(\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};Extended Properties=\\\"Excel 12.0 Xml;HDR=YES;\\\";\", dbpath);\n\n    using (var conn = new OleDbConnection(connStr))\n    {\n        conn.Open();\n        var sql = \"SELECT * FROM [Sheet1$]\";\n        var cmd = new OleDbCommand(sql, conn);\n        var reader = cmd.ExecuteReader();\n\n        List&lt;string&gt; list = new List&lt;string&gt;();\n        bool notExists;\n        while (reader.Read())\n        {\n            notExists = true;\n            if (reader[0].ToString().Equals(\"\"))continue;\n\n            for (int cn = 0; cn &lt; list.Count; cn++)\n            {\n                if (reader[0].ToString().Equals(list[cn]) || reader[0].ToString().Equals(\"\"))\n                {\n                    new OleDbCommand(\"UPDATE [Sheet1$] SET [name] = '' WHERE [name]= '\" + reader[0].ToString() + \"' AND [par1]=\"+reader[1].ToString()+\"\", conn).ExecuteNonQuery();\n                    notExists = false;\n                    break;\n                }\n            }\n\n            if (notExists)\n            {\n                list.Add(reader[0].ToString());\n                for (int i = 1; i &lt; reader.FieldCount; i++)\n                {\n                    try\n                    {\n                        double d = Double.Parse(reader[i].ToString());\n                    }catch(Exception e)\n                    {\n                        //new OleDbCommand(\"UPDATE [Sheet1$] SET par\"+i+\" = '0' WHERE id = '\"+reader[0].ToString()+\"'\");\n                        new OleDbCommand(\"UPDATE [Sheet1$] SET [par\"+i+\"] = 0 WHERE [name]= '\" + reader[0].ToString() + \"'\", conn).ExecuteNonQuery();\n                    }\n\n                    //MessageBox.Show(\"Data: \"+reader[i].ToString() + \" - i=\"+i);\n                }\n            }\n        }\n        return true;\n    }\n    return false;\n}\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Cannot update. Database or object is read only.\n</code></pre>\n\n<p>Details:</p>\n\n<pre><code>See the end of this message for details on invoking \njust-in-time (JIT) debugging instead of this dialog box.\n\n************** Exception Text **************\nSystem.Data.OleDb.OleDbException (0x80004005): Cannot update. Database or object is read-only.\n   at System.Data.OleDb.OleDbConnectionInternal..ctor(OleDbConnectionString constr, OleDbConnection connection)\n   at System.Data.OleDb.OleDbConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningObject)\n   at System.Data.ProviderBase.DbConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)\n   at System.Data.ProviderBase.DbConnectionFactory.CreateNonPooledConnection(DbConnection owningConnection, DbConnectionPoolGroup poolGroup, DbConnectionOptions userOptions)\n   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal&amp; connection)\n   at System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\n   at System.Data.ProviderBase.DbConnectionInternal.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)\n   at System.Data.OleDb.OleDbConnection.Open()\n   at KMean.ExcelCon.PreProcess(String dbpath)\n   at KMean.Form1.PrePBtn_Click(Object sender, EventArgs e)\n   at System.Windows.Forms.Control.OnClick(EventArgs e)\n   at System.Windows.Forms.Button.OnClick(EventArgs e)\n   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n   at System.Windows.Forms.Control.WndProc(Message&amp; m)\n   at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n   at System.Windows.Forms.Button.WndProc(Message&amp; m)\n   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n\n\n************** Loaded Assemblies **************\nmscorlib\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.NET/Framework/v4.0.30319/mscorlib.dll\n----------------------------------------\nKMean\n    Assembly Version: 1.0.0.0\n    Win32 Version: 1.0.0.0\n    CodeBase: file:///C:/Users/Abubakar/Desktop/KMean/KMean/bin/Release/KMean.exe\n----------------------------------------\nSystem.Windows.Forms\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Windows.Forms/v4.0_4.0.0.0__b77a5c561934e089/System.Windows.Forms.dll\n----------------------------------------\nSystem.Drawing\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Drawing/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll\n----------------------------------------\nSystem\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System/v4.0_4.0.0.0__b77a5c561934e089/System.dll\n----------------------------------------\nSystem.Data\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Data/v4.0_4.0.0.0__b77a5c561934e089/System.Data.dll\n----------------------------------------\nSystem.Core\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Core/v4.0_4.0.0.0__b77a5c561934e089/System.Core.dll\n----------------------------------------\nSystem.Xml\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Xml/v4.0_4.0.0.0__b77a5c561934e089/System.Xml.dll\n----------------------------------------\nSystem.Transactions\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.Transactions/v4.0_4.0.0.0__b77a5c561934e089/System.Transactions.dll\n----------------------------------------\nSystem.EnterpriseServices\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_32/System.EnterpriseServices/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.EnterpriseServices.dll\n----------------------------------------\nSystem.Configuration\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Configuration/v4.0_4.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll\n----------------------------------------\nSystem.Numerics\n    Assembly Version: 4.0.0.0\n    Win32 Version: 4.0.30319.17929 built by: FX45RTMREL\n    CodeBase: file:///C:/Windows/Microsoft.Net/assembly/GAC_MSIL/System.Numerics/v4.0_4.0.0.0__b77a5c561934e089/System.Numerics.dll\n----------------------------------------\n\n************** JIT Debugging **************\nTo enable just-in-time (JIT) debugging, the .config file for this\napplication or computer (machine.config) must have the\njitDebugging value set in the system.windows.forms section.\nThe application must also be compiled with debugging\nenabled.\n\nFor example:\n\n&lt;configuration&gt;\n    &lt;system.windows.forms jitDebugging=\"true\" /&gt;\n&lt;/configuration&gt;\n\nWhen JIT debugging is enabled, any unhandled exception\nwill be sent to the JIT debugger registered on the computer\nrather than be handled by this dialog box.\n</code></pre>\n\n<p><strong><em>EDIT</em></strong></p>\n\n<p>I have managed to get the V machine to give me the same issue. I changed nothing except the connection string which failed then returned it to it's original status. Now it is gone.... same error: \"cannot update...\"</p>\n"}, {"tags": ["c#", ".net", "visual-studio"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1507759844, "post_id": 46698281, "comment_id": 80344316, "body": "You can edit the code in your post and change 150 to 40."}, {"owner": {"reputation": 344, "user_id": 6015844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s77pY.jpg?s=128&g=1", "display_name": "Thowk", "link": "https://stackoverflow.com/users/6015844/thowk"}, "edited": false, "score": 0, "creation_date": 1507759877, "post_id": 46698281, "comment_id": 80344327, "body": "Sure you can. You just have to make Sleep conditional, and handle user click which will change mentioned condition. Do it yourself and learn."}], "answers": [{"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": true, "score": 1, "last_activity_date": 1507760187, "creation_date": 1507760187, "answer_id": 46698403, "question_id": 46698281, "link": "https://stackoverflow.com/questions/46698281/how-can-i-have-the-user-hit-a-key-to-either-speed-up-or-instantly-finish-the-tex/46698403#46698403", "title": "How can I have the user hit a key to either speed up or instantly finish the text?", "body": "<p>You can check if a key has been pressed without reading it:</p>\n\n<pre><code>static void TypeLine(string line) {\n    for (int i = 0; i &lt; line.Length; ++i) {\n        Console.Write(line[i]);\n        if (!Console.KeyAvailable)\n            System.Threading.Thread.Sleep(40); // Sleep between characters\n    }\n    Console.Write(\"\\n\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1507762124, "post_id": 46698604, "comment_id": 80344988, "body": "Why would you print the partial output again when a key is pressed?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1507762857, "post_id": 46698604, "comment_id": 80345198, "body": "Well that&#39;s a neat way to cheat... though I sense issues if the <code>textToPrint</code> is over console width."}], "tags": [], "owner": {"reputation": 1, "user_id": 8741302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2be6e1041a99bdc7e3a458c162dd7500?s=128&d=identicon&r=PG&f=1", "display_name": "Xeruus", "link": "https://stackoverflow.com/users/8741302/xeruus"}, "is_accepted": false, "score": 0, "last_activity_date": 1507762627, "last_edit_date": 1507762627, "creation_date": 1507761484, "answer_id": 46698604, "question_id": 46698281, "link": "https://stackoverflow.com/questions/46698281/how-can-i-have-the-user-hit-a-key-to-either-speed-up-or-instantly-finish-the-tex/46698604#46698604", "title": "How can I have the user hit a key to either speed up or instantly finish the text?", "body": "<pre><code>static void printText(string textToPrint)\n    {\n        ConsoleKeyInfo cki;\n        do\n        {\n            int x = 0;\n            while (Console.KeyAvailable == false)\n            {\n                Console.Write(textToPrint[x]);\n                System.Threading.Thread.Sleep(150);\n                x++;\n                if (x &gt;= textToPrint.Length)\n                    return;\n            }\n            cki = Console.ReadKey(true);\n            Console.WriteLine(\"\\r\" + textToPrint);\n        } while (cki.Key != ConsoleKey.X);\n        Console.ReadLine();\n    }\n</code></pre>\n\n<p>To call it:</p>\n\n<pre><code>printText(\"I Took an Arrow in the Knee\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "is_accepted": false, "score": 0, "last_activity_date": 1507762129, "creation_date": 1507762129, "answer_id": 46698700, "question_id": 46698281, "link": "https://stackoverflow.com/questions/46698281/how-can-i-have-the-user-hit-a-key-to-either-speed-up-or-instantly-finish-the-tex/46698700#46698700", "title": "How can I have the user hit a key to either speed up or instantly finish the text?", "body": "<p>Example using threading</p>\n\n<pre><code>class Program\n{\n    static bool running = true;\n\n    static void Main(string[] args)\n    {\n        Thread t = new Thread(Keyboard);\n        t.SetApartmentState(ApartmentState.STA);\n        t.Start();\n\n        Thread t1 = new Thread(Print);\n        t1.Start();\n    }\n\n    static void Print()\n    {\n        TypeLine(\"hello world\");\n    }\n\n    static void TypeLine(string line)\n    {\n        for (int i = 0; i &lt; line.Length; i++)\n        {\n            Console.Write(line[i]);\n\n            if (running)\n            {\n                System.Threading.Thread.Sleep(40);\n            }\n        }\n        Console.Write(\"\\n\");\n    }\n\n    static void Keyboard()\n    {\n        while (running)\n        {\n            if (System.Windows.Input.Keyboard.IsKeyDown(System.Windows.Input.Key.LeftShift))\n            {\n                running = false;\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8761821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66e5281f714c8e11bbde7f0a417206ed?s=128&d=identicon&r=PG&f=1", "display_name": "Matthfinn", "link": "https://stackoverflow.com/users/8761821/matthfinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 46698403, "answer_count": 3, "score": -1, "last_activity_date": 1507762627, "creation_date": 1507759570, "last_edit_date": 1507762088, "question_id": 46698281, "link": "https://stackoverflow.com/questions/46698281/how-can-i-have-the-user-hit-a-key-to-either-speed-up-or-instantly-finish-the-tex", "title": "How can I have the user hit a key to either speed up or instantly finish the text?", "body": "<p>So I'm making a text based adventure for a SENG 100 class.\nI'm using this function to type out any text in the game:</p>\n\n<pre><code>static void TypeLine(string line)\n{\n    for (int i = 0; i &lt; line.Length; i++)\n    {\n        Console.Write(line[i]);\n        System.Threading.Thread.Sleep(40); // Sleep for 40 milliseconds\n    }\n    Console.Write(\"\\n\");\n}\n</code></pre>\n\n<p>Is there any way I can have the user hit a key to either speed up or instantly finish the text?</p>\n"}, {"tags": ["javascript", "c#", "jquery", "asp.net-mvc"], "comments": [{"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1507759503, "post_id": 46698217, "comment_id": 80344219, "body": "Why are you passing <code>dateOut</code> to <code>parseInt()</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1507759515, "post_id": 46698217, "comment_id": 80344223, "body": "<code>parseInt(dateOut)</code> return <code>30</code> - you would need to split the value based on <code>&#47;</code> to get the components"}, {"owner": {"reputation": 411, "user_id": 7666932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vs5xH.jpg?s=128&g=1", "display_name": "Koni", "link": "https://stackoverflow.com/users/7666932/koni"}, "reply_to_user": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1507759645, "post_id": 46698217, "comment_id": 80344257, "body": "@Pointy if I dont parseInt, I get &quot;NaN&quot;"}, {"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 0, "creation_date": 1507759784, "post_id": 46698217, "comment_id": 80344295, "body": "Well getting the completely wrong date isn&#39;t much better than that. Search for date parsing questions here - there are <i>thousands</i> of them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1507759789, "post_id": 46698217, "comment_id": 80344297, "body": "Of course it would be better to just change the culture on the server to one that expects dates in <code>dd&#47;MM&#47;yyyy</code> format, or to create a custom ModelBinder for dates"}], "answers": [{"comments": [{"owner": {"reputation": 411, "user_id": 7666932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vs5xH.jpg?s=128&g=1", "display_name": "Koni", "link": "https://stackoverflow.com/users/7666932/koni"}, "edited": false, "score": 1, "creation_date": 1507807826, "post_id": 46698374, "comment_id": 80363295, "body": "To solve my problem, I just put the month first so c# would understand it"}], "tags": [], "owner": {"reputation": 11449, "user_id": 6525724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CZEkk.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/6525724/nick"}, "is_accepted": true, "score": 2, "last_activity_date": 1507760043, "creation_date": 1507760043, "answer_id": 46698374, "question_id": 46698217, "link": "https://stackoverflow.com/questions/46698217/javascript-jquery-converting-string-to-datetime-using-new-date-in-javascript-t/46698374#46698374", "title": "Javascript/jquery converting string to datetime (using New date in javascript) to pass to .net MVC", "body": "<p>If you're certain that will be the entered date format, you could do something like this.  All it's doing is reversing the month/day prior to creating the new <code>Date</code> object.</p>\n\n<pre><code>var dateOut = $(\".txtOut\").val().split(\"/\");\nvar dateToSend = new Date(dateOut[1] + \"/\" + dateOut[0] + \"/\" + dateOut[2]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 411, "user_id": 7666932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vs5xH.jpg?s=128&g=1", "display_name": "Koni", "link": "https://stackoverflow.com/users/7666932/koni"}, "edited": false, "score": 0, "creation_date": 1507807720, "post_id": 46700876, "comment_id": 80363236, "body": "Thanks a lot for the detailed question, I really apreciate the time you took. However, I&#180;m going with the other answer since it&#180;s a more simple way to solve my specific problem."}], "tags": [], "owner": {"reputation": 1749, "user_id": 6306772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nbcR5.jpg?s=128&g=1", "display_name": "Jeric Cruz", "link": "https://stackoverflow.com/users/6306772/jeric-cruz"}, "is_accepted": false, "score": 1, "last_activity_date": 1507781465, "last_edit_date": 1507781465, "creation_date": 1507778498, "answer_id": 46700876, "question_id": 46698217, "link": "https://stackoverflow.com/questions/46698217/javascript-jquery-converting-string-to-datetime-using-new-date-in-javascript-t/46700876#46700876", "title": "Javascript/jquery converting string to datetime (using New date in javascript) to pass to .net MVC", "body": "<p>you could try to use <code>moment.js</code> to parse your data in your client side.</p>\n\n<p>First is to make the field <code>type=\"date\"</code> then we can modify the field to format it <code>DD/MM/YYYY</code> by using <code>moment.js</code> </p>\n\n<p>Second is we can add CSS to tweak the date field</p>\n\n<p>then we can get the value by using <code>moment.js</code> again to format of <code>MM/DD/YYYY</code></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>//format field\r\n$(\".txtOut\").on(\"change\", function() {\r\n    this.setAttribute(\r\n        \"data-date\",\r\n        moment(this.value, \"YYYY-MM-DD\")\r\n        .format( this.getAttribute(\"data-date-format\") )\r\n    )\r\n}).trigger(\"change\")\r\n\r\n\r\n$(function(e){\r\n  $(\"#btn\").click(function(e){\r\n     //parse date using moment.js, then use this to pass in your ajax.\r\n     var DateToSend = moment($(\".txtOut\").val()).format(\"MM/DD/YYYY\");     \r\n     console.log(DateToSend);\r\n     //format it whatever you want base on this docs https://momentjs.com/docs/\r\n     console.log(moment($(\".txtOut\").val()).format(\"MMMM DD, YYYY\"))\r\n  })\r\n})</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>.txtOut {\r\n    position: relative;\r\n    width: 150px; height: 20px;\r\n    color: white;\r\n}\r\n\r\n.txtOut:before {\r\n    position: absolute;\r\n    top: 3px; left: 3px;\r\n    content: attr(data-date);\r\n    display: inline-block;\r\n    color: black;\r\n}\r\n\r\n.txtOut::-webkit-datetime-edit, input::-webkit-inner-spin-button, input::-webkit-clear-button {\r\n    display: none;\r\n}\r\n\r\n.txtOut::-webkit-calendar-picker-indicator {\r\n    position: absolute;\r\n    top: 3px;\r\n    right: 0;\r\n    color: black;\r\n    opacity: 1;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.js\"&gt;&lt;/script&gt;\r\n&lt;input name=\"EgresoStJohns\" class=\"form-control txtOut\" type=\"date\" data-date=\"\" data-date-format=\"DD/MM/YYYY\" value=\"2017-03-30\"&gt;\r\n&lt;button id=\"btn\"&gt;Click me&lt;/button&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 411, "user_id": 7666932, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Vs5xH.jpg?s=128&g=1", "display_name": "Koni", "link": "https://stackoverflow.com/users/7666932/koni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5617, "favorite_count": 0, "accepted_answer_id": 46698374, "answer_count": 2, "score": 0, "last_activity_date": 1507807848, "creation_date": 1507759235, "last_edit_date": 1507807848, "question_id": 46698217, "link": "https://stackoverflow.com/questions/46698217/javascript-jquery-converting-string-to-datetime-using-new-date-in-javascript-t", "title": "Javascript/jquery converting string to datetime (using New date in javascript) to pass to .net MVC", "body": "<p>I need to convert my string to a date format to pass it in a way that my mvc c# understands it.</p>\n\n<p>Please read the following, where I explain the problem step by step.</p>\n\n<p>I have an input</p>\n\n<pre><code>&lt;input name=\"EgresoStJohns\" class=\"form-control txtOut\"/&gt;\n</code></pre>\n\n<p>When the user saves the form, I do the following in Jquery</p>\n\n<pre><code>var dateOut = $(\".txtOut\").val();\n</code></pre>\n\n<p>dateOut becomes something like this, depending on the date that the user picks: 30/03/2017</p>\n\n<p>Then I try to parse my date, so the controller in c# mvc understands that I want to send a dd/mm/yy, otherwise, if I send 30/03/2017 the controller will understand month=30 and it will conver the entire date to null.</p>\n\n<pre><code>var DateToSend = new Date(parseInt(dateOut));\nDateToSend = DateToSend.getDate() + \"/\" + (DateToSend.getMonth() + 1) + \"/\" + DateToSend.getFullYear();\n</code></pre>\n\n<p>However, inmmediately after doing the New Date, the input ALWAYS becomes \"31/12/1969\", so I am unable to work with it.</p>\n\n<p>What can I do to solve this inconvenience? </p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1507759123, "post_id": 46698164, "comment_id": 80344092, "body": "Because you creating  form control named <code>listOfGoals</code> but your model does not have a property with that name (its <code>Type</code>). Your editing data so always use a view model. Refer the code in <a href=\"https://stackoverflow.com/questions/34366305/the-viewdata-item-that-has-the-key-xxx-is-of-type-system-int32-but-must-be-o\">this Q/A</a> for a typical example (your using the worst possible overload to generate a <code>&lt;select&gt;</code> element which does not give 2-way model binding or client side validation)"}, {"owner": {"reputation": 55708, "user_id": 296861, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/957c8334a5950ba301f66662b36da7d1?s=128&d=identicon&r=PG&f=1", "display_name": "Win", "link": "https://stackoverflow.com/users/296861/win"}, "edited": false, "score": 0, "creation_date": 1507759218, "post_id": 46698164, "comment_id": 80344117, "body": "You might want to look at this <a href=\"https://stackoverflow.com/a/37819577/296861\">answer</a>."}, {"owner": {"reputation": 1443, "user_id": 1167735, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a0a8aa04abe9989901272f066a1e17cd?s=128&d=identicon&r=PG", "display_name": "gardarvalur", "link": "https://stackoverflow.com/users/1167735/gardarvalur"}, "edited": false, "score": 0, "creation_date": 1507759221, "post_id": 46698164, "comment_id": 80344120, "body": "When you submit a dropdownlist you are submitting selected value but not the complex type.  Can you inspect the formcollection upon submitting?"}, {"owner": {"reputation": 59, "user_id": 2926186, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1137516658/picture?type=large", "display_name": "Ceri Westcott", "link": "https://stackoverflow.com/users/2926186/ceri-westcott"}, "reply_to_user": {"reputation": 1443, "user_id": 1167735, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a0a8aa04abe9989901272f066a1e17cd?s=128&d=identicon&r=PG", "display_name": "gardarvalur", "link": "https://stackoverflow.com/users/1167735/gardarvalur"}, "edited": false, "score": 0, "creation_date": 1507759556, "post_id": 46698164, "comment_id": 80344235, "body": "@gardarvalur im happy submitting the selected value, if Im only getting to grips with this stuff so maybe later down the line I will edit it to submit complex types."}, {"owner": {"reputation": 1443, "user_id": 1167735, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a0a8aa04abe9989901272f066a1e17cd?s=128&d=identicon&r=PG", "display_name": "gardarvalur", "link": "https://stackoverflow.com/users/1167735/gardarvalur"}, "edited": false, "score": 0, "creation_date": 1507760190, "post_id": 46698164, "comment_id": 80344413, "body": "@CeriWestcott well, it sounds as if you need javascript to help you out with that. Maybe I am misunderstand but it sounds as if you would need to hook onto the onselect event of the dropdownlist to update the form with new selected type, perhaps with partialview injected into the form.  I am not sure..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "reply_to_user": {"reputation": 1443, "user_id": 1167735, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a0a8aa04abe9989901272f066a1e17cd?s=128&d=identicon&r=PG", "display_name": "gardarvalur", "link": "https://stackoverflow.com/users/1167735/gardarvalur"}, "edited": false, "score": 0, "creation_date": 1507760584, "post_id": 46698164, "comment_id": 80344538, "body": "@gardarvalur, You definitely do NOT need javascript. The view just needs to be be generated correctly - <code>@Html.DropDownListFor(m =&gt; m.Type, (IEnumerable&lt;SelectListItem&gt;)ViewBag.listOfGoals, &quot;Select a Goal&quot;)</code> (except that the property should be <code>int Type</code>, not <code>string</code>)"}, {"owner": {"reputation": 1443, "user_id": 1167735, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a0a8aa04abe9989901272f066a1e17cd?s=128&d=identicon&r=PG", "display_name": "gardarvalur", "link": "https://stackoverflow.com/users/1167735/gardarvalur"}, "edited": false, "score": 0, "creation_date": 1507760749, "post_id": 46698164, "comment_id": 80344586, "body": "@CeriWestcott What are the parameters of the post action?"}], "answers": [{"comments": [{"owner": {"reputation": 28101, "user_id": 3082296, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5eac8c095f63cb9fe29a9af3cb97eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "adiga", "link": "https://stackoverflow.com/users/3082296/adiga"}, "edited": false, "score": 0, "creation_date": 1507785492, "post_id": 46699799, "comment_id": 80350869, "body": "That&#39;s not necessary if <code>listOfGoals</code> is available in <code>ViewBag</code> <a href=\"https://docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions/working-with-the-dropdownlist-box-and-jquery/using-the-dropdownlist-helper-with-aspnet-mvc\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 597, "user_id": 4017742, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100000040169140/picture?type=large", "display_name": "Rodrigo de Farias", "link": "https://stackoverflow.com/users/4017742/rodrigo-de-farias"}, "reply_to_user": {"reputation": 28101, "user_id": 3082296, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5eac8c095f63cb9fe29a9af3cb97eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "adiga", "link": "https://stackoverflow.com/users/3082296/adiga"}, "edited": false, "score": 0, "creation_date": 1507815253, "post_id": 46699799, "comment_id": 80368360, "body": "In that case, the View doesn&#39;t seem be a typed view."}, {"owner": {"reputation": 28101, "user_id": 3082296, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5eac8c095f63cb9fe29a9af3cb97eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "adiga", "link": "https://stackoverflow.com/users/3082296/adiga"}, "edited": false, "score": 0, "creation_date": 1507839578, "post_id": 46699799, "comment_id": 80382746, "body": "It&#39;s not strongly typed even with the second parameter. I think you misunderstood what I meant. If you populate <code>ViewBag.listOfGoals</code> in the controller, and you have <code>@Html.DropDownList(&quot;listOfGoals&quot;)</code> in the view, it will work as it is. No need to add the <code>(SelectList)ViewBag.listOfGoals</code> explicitly as you have suggested in the first part of the answer."}, {"owner": {"reputation": 597, "user_id": 4017742, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100000040169140/picture?type=large", "display_name": "Rodrigo de Farias", "link": "https://stackoverflow.com/users/4017742/rodrigo-de-farias"}, "reply_to_user": {"reputation": 28101, "user_id": 3082296, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5eac8c095f63cb9fe29a9af3cb97eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "adiga", "link": "https://stackoverflow.com/users/3082296/adiga"}, "edited": false, "score": 0, "creation_date": 1507843536, "post_id": 46699799, "comment_id": 80384788, "body": "I get it, there is no need for casting."}, {"owner": {"reputation": 597, "user_id": 4017742, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100000040169140/picture?type=large", "display_name": "Rodrigo de Farias", "link": "https://stackoverflow.com/users/4017742/rodrigo-de-farias"}, "reply_to_user": {"reputation": 28101, "user_id": 3082296, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5eac8c095f63cb9fe29a9af3cb97eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "adiga", "link": "https://stackoverflow.com/users/3082296/adiga"}, "edited": false, "score": 0, "creation_date": 1507846345, "post_id": 46699799, "comment_id": 80386017, "body": "I don&#39;t know why it was downvoted, once it has given an answer, and the code above works."}], "tags": [], "owner": {"reputation": 597, "user_id": 4017742, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/100000040169140/picture?type=large", "display_name": "Rodrigo de Farias", "link": "https://stackoverflow.com/users/4017742/rodrigo-de-farias"}, "is_accepted": false, "score": -1, "last_activity_date": 1507845846, "last_edit_date": 1507845846, "creation_date": 1507770232, "answer_id": 46699799, "question_id": 46698164, "link": "https://stackoverflow.com/questions/46698164/creating-a-dropdownlist-in-mvc-that-still-populates-the-model-backing-it/46699799#46699799", "title": "Creating a DropDownList in MVC that still populates the model backing it", "body": "<p>You have to pass you @ViewBag for the @Html.DropDownList, as follow:</p>\n\n<pre><code>@Html.DropDownList(\"listOfGoals\", ViewBag.listOfGoals)\n</code></pre>\n\n<p>or create a helper:</p>\n\n<pre><code>public class MyHelpers{\n   public static SelectList DropDownListGoalTypes(int? selected) {\n        var list = db.GoalType.ToList();\n        return new SelectList(list, \"Id\", \"Type\", selected);\n   } \n } \n</code></pre>\n\n<p>View:</p>\n\n<pre><code>@Html.DropDownListFor(x =&gt; x.Id, MyHelpers.DropDownListGoalTypes(Model.Id))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28101, "user_id": 3082296, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5eac8c095f63cb9fe29a9af3cb97eb0e?s=128&d=identicon&r=PG&f=1", "display_name": "adiga", "link": "https://stackoverflow.com/users/3082296/adiga"}, "is_accepted": false, "score": -1, "last_activity_date": 1507841858, "last_edit_date": 1507841858, "creation_date": 1507788336, "answer_id": 46702511, "question_id": 46698164, "link": "https://stackoverflow.com/questions/46698164/creating-a-dropdownlist-in-mvc-that-still-populates-the-model-backing-it/46702511#46702511", "title": "Creating a DropDownList in MVC that still populates the model backing it", "body": "<p><code>@Html.DropDownList(\"listOfGoals\", \"Select a Goal\")</code> generates a select element like this:</p>\n\n<pre><code>&lt;select name=\"listOfGoals\" id=\"listOfGoals\"&gt;&lt;/select&gt; \n</code></pre>\n\n<p>But you're trying to bind the dropdown to <code>Type</code> property in your model upon submission,</p>\n\n<p>So, you need to change it to:</p>\n\n<pre><code>@Html.DropDownListFor(model =&gt; model.Type, (IEnumerable&lt;SelectListItem&gt;)ViewBag.listOfGoals, \"Select a Goal\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>@Html.DropDownListFor(\"Type\", (IEnumerable&lt;SelectListItem&gt;)ViewBag.listOfGoals, \"Select a Goal\")\n</code></pre>\n\n<p>Now, the <code>select</code> is created with <code>name</code> attribute as \"Type\" and the <code>DefaultModelBinder</code> can bind it to the property in the <code>POST</code> action. </p>\n\n<p>Also, as Stephen suggested, you need to change the <code>Type</code> to an <code>int</code>. Because the <code>value</code> of the selected <code>option</code> is submitted, not the text.</p>\n\n<pre><code>public int Type { get; set; }\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 2926186, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1137516658/picture?type=large", "display_name": "Ceri Westcott", "link": "https://stackoverflow.com/users/2926186/ceri-westcott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507845846, "creation_date": 1507758936, "last_edit_date": 1507758964, "question_id": 46698164, "link": "https://stackoverflow.com/questions/46698164/creating-a-dropdownlist-in-mvc-that-still-populates-the-model-backing-it", "title": "Creating a DropDownList in MVC that still populates the model backing it", "body": "<p>I have a small model called GoalTypes which would contain stuff like \"Running, Cycling, Weight..\" etc</p>\n\n<pre><code>public class GoalType\n{\n    public int Id { get; set; }\n    public string Type { get; set; }\n}\n</code></pre>\n\n<p>I also have a model called Goals\n  public class Goals\n{\n    public int Id { get; set; }</p>\n\n<pre><code>[DataType(DataType.Date)]\n[DisplayFormat(DataFormatString = \"{0:dd/MM/yyyy}\", ApplyFormatInEditMode = true)]\npublic DateTime StartDate  { get; set; }\n\n[DataType(DataType.Date)]\n[DisplayFormat(DataFormatString = \"{0:dd/MM/yyyy}\", ApplyFormatInEditMode = true)]\npublic  DateTime? EndDate { get; set; }\n\npublic string Type { get; set; }\npublic double Level { get; set; }\n</code></pre>\n\n<p>}\nThe type field would be populated by the Type field from GoalTypes.\nIn my goals controller I have done:</p>\n\n<pre><code>public ActionResult Create()\n{\n    ViewBag.listOfGoals = new SelectList(db.GoalTypes, \"Id\", \"Type\");\n    return View();\n}\n</code></pre>\n\n<p>and in my view</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n    @Html.LabelFor(model =&gt; model.Type, htmlAttributes: new { @class = \"control-label col-md-2\" })\n    &lt;div class=\"col-md-10\"&gt;\n        @Html.DropDownList(\"listOfGoals\", \"Select a Goal\")\n        @Html.ValidationMessageFor(model =&gt; model.Type, \"\", new { @class = \"text-danger\" })\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>this populates the dropdown but if i submit it, the type field is left blank</p>\n"}, {"tags": ["c#", "xunit", "asp.net-core-2.0"], "comments": [{"owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "edited": false, "score": 0, "creation_date": 1507759902, "post_id": 46698161, "comment_id": 80344337, "body": "for each get method you wanna test what will be the result it is returning ??"}, {"owner": {"reputation": 835, "user_id": 1650231, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f2da21433258099d3212568396296c20?s=128&d=identicon&r=PG&f=1", "display_name": "yams", "link": "https://stackoverflow.com/users/1650231/yams"}, "reply_to_user": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "edited": false, "score": 0, "creation_date": 1507760277, "post_id": 46698161, "comment_id": 80344445, "body": "@RJ-   To start with I&#39;d like to test that those don&#39;t return errors. Something basic."}, {"owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "edited": false, "score": 0, "creation_date": 1507760520, "post_id": 46698161, "comment_id": 80344520, "body": "Please follow this link maybe it will be helpfull for you.<a href=\"https://stackoverflow.com/questions/37475387/unit-testing-integration-testing-web-api-with-httpclient-in-visual-studio-2013\">existing ans</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1071, "user_id": 1952580, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c0926806aa5d0bf355ccd803f160ede6?s=128&d=identicon&r=PG&f=1", "display_name": "r.mirzojonov", "link": "https://stackoverflow.com/users/1952580/r-mirzojonov"}, "edited": false, "score": 1, "creation_date": 1531126827, "post_id": 46893928, "comment_id": 89462056, "body": "Thank you, you saved me so much time"}, {"owner": {"reputation": 835, "user_id": 1650231, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f2da21433258099d3212568396296c20?s=128&d=identicon&r=PG&f=1", "display_name": "yams", "link": "https://stackoverflow.com/users/1650231/yams"}, "reply_to_user": {"reputation": 1071, "user_id": 1952580, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c0926806aa5d0bf355ccd803f160ede6?s=128&d=identicon&r=PG&f=1", "display_name": "r.mirzojonov", "link": "https://stackoverflow.com/users/1952580/r-mirzojonov"}, "edited": false, "score": 0, "creation_date": 1532630149, "post_id": 46893928, "comment_id": 90058736, "body": "@r.mirzojonov glad I could help someone."}], "tags": [], "owner": {"reputation": 835, "user_id": 1650231, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f2da21433258099d3212568396296c20?s=128&d=identicon&r=PG&f=1", "display_name": "yams", "link": "https://stackoverflow.com/users/1650231/yams"}, "is_accepted": true, "score": 1, "last_activity_date": 1508775187, "creation_date": 1508775187, "answer_id": 46893928, "question_id": 46698161, "link": "https://stackoverflow.com/questions/46698161/testing-asp-net-core-2-0-project-with-xunit-how-to-test-httpget/46893928#46893928", "title": "Testing asp.net core 2.0 project with Xunit how to test httpget", "body": "<p>So I found that the first step is to setup a mock connection that is somewhat generic so I created a method to mock the connection to a server via the method below.</p>\n\n<pre><code>    private CollectionsController SetupController()\n    {\n        if (controller != null)\n        {\n            controller = null;\n        }\n        if (controllerContext != null)\n        {\n            controllerContext = null;\n        }\n        controller = new CollectionsController();\n        controller.ControllerContext = new ControllerContext();\n        controllerContext = controller.ControllerContext;\n        controllerContext.HttpContext = new DefaultHttpContext();\n        //The header below is generic don't really care what the device id is\n        controllerContext.HttpContext.Request.Headers[\"device-id\"] = \"20317\";\n\n    }\n</code></pre>\n\n<p>Then as an example I've set up a test below that just checks the status code and asserts the object returning from the controller is not null.</p>\n\n<pre><code>    [Fact]\n    public void TestPostCollectionName()\n    {\n        valData = new ValData();\n        valData.value = \"NewObject\";\n        controller = SetupController();\n        var results = controller.PostCollectionName(valData, testCollecName);\n        Assert.NotNull(results);\n        Assert.True(controllerContext.HttpContext.Response.StatusCode == 200);\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 835, "user_id": 1650231, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f2da21433258099d3212568396296c20?s=128&d=identicon&r=PG&f=1", "display_name": "yams", "link": "https://stackoverflow.com/users/1650231/yams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 1, "accepted_answer_id": 46893928, "answer_count": 1, "score": 1, "last_activity_date": 1508775187, "creation_date": 1507758917, "question_id": 46698161, "link": "https://stackoverflow.com/questions/46698161/testing-asp-net-core-2-0-project-with-xunit-how-to-test-httpget", "title": "Testing asp.net core 2.0 project with Xunit how to test httpget", "body": "<p>I've got a asp.net core 2.0 project I'm building in Visual Studio 2017.  I'm learning the ropes with testing a asp.net core project but I'm wondering how to test the HHTPGET methods within  my controller.<br>\nBelow is my initial controller.</p>\n\n<pre><code>public class ValuesController : Controller\n{\n    private Config MyConfig { get; }\n\n    private Solr Solr { get; }\n\n    private Voyager Voyager { get; }\n\n    private Messages Messages { get; }\n\n    public ValuesController(Config config, Solr solr, Voyager voyager, Messages messages)\n    {\n        MyConfig = config;\n        Solr = solr;\n        Voyager = voyager;\n        Messages = messages;\n    }\n\n    // GET api/values\n    [HttpGet]\n    [Route(\"/api/[Controller]\")]\n    public IEnumerable&lt;string&gt; Get()\n    {\n        string version = \".NET Framework: \" + Environment.Version.ToString();\n        string vers = \"ASP.NET Core Framework: \" + typeof(Controller).Assembly.GetName().Version.ToString();\n        return new string[] { version, vers };\n    }\n\n    [HttpGet]\n    [Route(\"/api/[Controller]/config\")]\n    public JsonResult GetConfig()\n    {\n        return new JsonResult(MyConfig);\n    }\n\n    [HttpGet]\n    [Route(\"/api/[Controller]/solr\")]\n    public JsonResult GetSolr()\n    {\n        return new JsonResult(Solr);\n    }\n\n    [HttpGet]\n    [Route(\"/api/[Controller]/voyager\")]\n    public JsonResult GetVoyager()\n    {\n        return new JsonResult(Voyager);\n    }\n\n    [HttpGet]\n    [Route(\"/api/[Controller]/messages\")]\n    public JsonResult GetMessages()\n    {\n        return new JsonResult(Messages);\n    }\n</code></pre>\n\n<p>Just wondering if someone could give an example of how to test these routes or HTTPGets...</p>\n"}, {"tags": ["c#", "xml", "sorting", "datagridview"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 1, "creation_date": 1507779353, "post_id": 46698106, "comment_id": 80349096, "body": "Try following : dataGridView1.Sort(dataGridView1.Columns[0].Select(x =&gt; int.Parse(x)), ListSortDirection.Descending);"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6544837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8436f90ae1c27b00f5cddb98722a516e?s=128&d=identicon&r=PG&f=1", "display_name": "Noob Coder", "link": "https://stackoverflow.com/users/6544837/noob-coder"}, "edited": false, "score": 0, "creation_date": 1507781532, "post_id": 46699943, "comment_id": 80349702, "body": "Thank you VERY much that did exactly what I was asking for and also thank you for the compliment.  I&#39;m self taught and also very thorough."}], "tags": [], "owner": {"reputation": 261, "user_id": 8548154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e672a056f4b7d7a0626f9c9cf749758?s=128&d=identicon&r=PG&f=1", "display_name": "null", "link": "https://stackoverflow.com/users/8548154/null"}, "is_accepted": true, "score": 0, "last_activity_date": 1507774943, "last_edit_date": 1507774943, "creation_date": 1507771448, "answer_id": 46699943, "question_id": 46698106, "link": "https://stackoverflow.com/questions/46698106/sorting-data-from-xml-as-numeric-in-a-datagridview/46699943#46699943", "title": "sorting data from XML as numeric in a dataGridView", "body": "<p>Had a look and everything you have is excellent. There is one little change.</p>\n\n<p>When you read the XML then InferTypedSchema; this will infer that Score is a numeric column.</p>\n\n<pre><code>scorexml.DataSet.ReadXml(Application.StartupPath + \"\\\\Leaderboard.xml\", XmlReadMode.InferTypedSchema);\n</code></pre>\n\n<p>The XML also has a little problem, the root node and first element are a little mixed up.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?&gt;\n&lt;Leaderboard&gt;\n  &lt;Leaderboard Name=\"Nine\"&gt;\n    &lt;Score&gt;9&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n  &lt;Leaderboard Name=\"FourtyFour\"&gt;\n    &lt;Score&gt;44&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n  &lt;Leaderboard Name=\"Twelve\"&gt;\n    &lt;Score&gt;12&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n  &lt;Leaderboard Name=\"Sixer\"&gt;\n    &lt;Score&gt;6&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n  &lt;Leaderboard Name=\"Fifteen\"&gt;\n    &lt;Score&gt;15&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n&lt;/Leaderboard&gt;\n</code></pre>\n\n<p>Addition: The code and the research provided does not justify the Noob title you've given yourself. That's good work.</p>\n"}], "owner": {"reputation": 11, "user_id": 6544837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8436f90ae1c27b00f5cddb98722a516e?s=128&d=identicon&r=PG&f=1", "display_name": "Noob Coder", "link": "https://stackoverflow.com/users/6544837/noob-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 46699943, "answer_count": 1, "score": 0, "last_activity_date": 1507789340, "creation_date": 1507758646, "last_edit_date": 1507789340, "question_id": 46698106, "link": "https://stackoverflow.com/questions/46698106/sorting-data-from-xml-as-numeric-in-a-datagridview", "title": "sorting data from XML as numeric in a dataGridView", "body": "<p>This is my XML that is loaded into the dataGridView on load.</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?&gt;\n&lt;!--Game Scores--&gt;\n&lt;Leaderboard Name=\"Nine\"&gt;\n  &lt;Score&gt;9&lt;/Score&gt;\n  &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;Leaderboard Name=\"FourtyFour\"&gt;\n    &lt;Score&gt;44&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n  &lt;Leaderboard Name=\"Twelve\"&gt;\n    &lt;Score&gt;12&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n  &lt;Leaderboard Name=\"Sixer\"&gt;\n    &lt;Score&gt;6&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;\n  &lt;Leaderboard Name=\"Fifteen\"&gt;\n    &lt;Score&gt;15&lt;/Score&gt;\n    &lt;Difficulty&gt;Normal&lt;/Difficulty&gt;\n  &lt;/Leaderboard&gt;  \n&lt;/Leaderboard&gt;\n</code></pre>\n\n<p>This Loads the XML and places it into the dataGridView</p>\n\n<pre><code>XmlDataDocument scorexml = new XmlDataDocument();             \n        scorexml.DataSet.ReadXml(Application.StartupPath + \"\\\\Leaderboard.xml\");\n        dataGridView1.DataSource = scorexml.DataSet;\n        dataGridView1.DataMember = \"Leaderboard\";\n        dataGridView1.Columns[\"Name\"].ReadOnly = true;\n        dataGridView1.Columns[\"Score\"].ReadOnly = true;\n        dataGridView1.Columns[\"Difficulty\"].ReadOnly = true;\n        dataGridView1.Sort(dataGridView1.Columns[0], ListSortDirection.Descending);\n        dataGridView1.Columns.Cast&lt;DataGridViewColumn&gt;().ToList().ForEach(f =&gt; f.SortMode = DataGridViewColumnSortMode.NotSortable);\n</code></pre>\n\n<p>I removed all ability to sort manually and so the rows are not selectable.\nIt does sort the \"Score\" BUT it sorts it incorreclty as a string and not as a decimal and that is where my problem continues to taunt me. </p>\n\n<p>For example the provided XML has 5 individual entries and are being sorted exactly like this</p>\n\n<pre><code>Score   Difficulty   Name\n9         Normal     Nine\n6         Normal     Sixer\n44        Normal     FourtyFour\n12        Normal     Twelve\n15        Normal     Fifteen\n</code></pre>\n\n<p>But the desired sorting is the number from high to low. (hence the \"leaderboard\")</p>\n\n<pre><code>    Score   Difficulty   Name\n    44        Normal     FourtyFour \n    15        Normal     Fifteen\n    12        Normal     Twelve\n    9         Normal     Nine\n    6         Normal     Sixer\n</code></pre>\n\n<p>I have done a LOT of research throughout SO, Microsoft, CP and many other sites all which have had a basic similar problem although most of them was not using XML to load the data into it so the difference's are there.\nI tried every possible fix for the problem provided by the other members for the OP and none of which has fixed my problem but it was a fix for most others that had the same similar problem. \ncan anyone tell what it is that I am doing wrong or what it is that I need to convert it to decimal instead of a string since I know by default the dataGridView everything is a string.</p>\n\n<p>links to other similar questions (proof of research)</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21687407/how-to-sort-data-from-xml-as-numeric-in-a-datagrid\">Link 1</a> -- <a href=\"https://stackoverflow.com/questions/1073594/c-sharp-datagridview-order-rows/1073625#1073625\">Link 2</a> -- <a href=\"https://stackoverflow.com/questions/17504306/datagridview-decimal-not-sorting\">Link 3</a> -- <a href=\"https://stackoverflow.com/questions/31336046/how-to-sort-string-as-numbers-in-datagridview\">Link 4</a></p>\n\n<p>and MANY MANY More. </p>\n"}, {"tags": ["c#", "entity-framework", "azure", "azure-functions"], "answers": [{"comments": [{"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "edited": false, "score": 0, "creation_date": 1507823603, "post_id": 46706044, "comment_id": 80374244, "body": "Thank you for the response. This is something I would gladly do; however, I&#39;m trying to use a bunch of existing data access code which has the dbcontext being created with the parameterless constructor. I&#39;m trying to avoid having to edit all these other services. I just took a quick look at the link you provided. This may help."}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "edited": false, "score": 0, "creation_date": 1507829335, "post_id": 46706044, "comment_id": 80377410, "body": "I found the issue. I will add an answer"}], "tags": [], "owner": {"reputation": 17081, "user_id": 6755924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2016daeafc6c9469fde7bab85f8214d6?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Chen", "link": "https://stackoverflow.com/users/6755924/bruce-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1507800524, "creation_date": 1507800524, "answer_id": 46706044, "question_id": 46698103, "link": "https://stackoverflow.com/questions/46698103/missing-providername-when-debugging-azurefunction-as-well-as-deploying-azure-fun/46706044#46706044", "title": "Missing ProviderName when debugging AzureFunction as well as deploying azure function", "body": "<p>I encountered the similar issue before, I would use the following approach for achieving my purpose, you could refer to it:</p>\n\n<p><strong>local.settings.json</strong></p>\n\n<pre class=\"lang-html prettyprint-override\"><code>{\n  \"IsEncrypted\": false,\n  \"Values\": {\n    \"AzureWebJobsStorage\": \"DefaultEndpointsProtocol=https;AccountName=brucchstorage;AccountKey=&lt;AccountKey&gt;\",\n    \"AzureWebJobsDashboard\": \"DefaultEndpointsProtocol=https;AccountName=brucchstorage;AccountKey=&lt;AccountKey&gt;\",\n    \"sqldb-connectionstring\": \"Data Source=.\\\\sqlexpress;Initial Catalog=DefaultConnection;Integrated Security=True;Connect Timeout=15;Encrypt=False;TrustServerCertificate=True;ApplicationIntent=ReadWrite;MultiSubnetFailover=False\"\n  },\n  \"ConnectionStrings\": {\n    \"Bruce_SQLConnectionString\": \"Data Source=.\\\\sqlexpress;Initial Catalog=DefaultConnection;Integrated Security=True;Connect Timeout=15;Encrypt=False;TrustServerCertificate=True;ApplicationIntent=ReadWrite;MultiSubnetFailover=False\"\n  }\n} \n</code></pre>\n\n\n\n<p>For retrieving the connection string:</p>\n\n<pre><code>var connString = ConfigurationManager.AppSettings[\"sqldb-connectionstring\"];\n//or var connString = ConfigurationManager.ConnectionStrings[\"Bruce_SQLConnectionString\"].ConnectionString;\nusing (var dbContext = new BruceDbContext(connString))\n{\n    //TODO:\n}\n</code></pre>\n\n<p>Or you could init your no-argument constructor for your <code>DbContext</code> as follows:</p>\n\n<pre><code>public class BruceDbContext:DbContext\n{\n    public BruceDbContext()\n        : base(\"Bruce_SQLConnectionString\")\n    {\n    }\n\n    public BruceDbContext(string connectionString) : base(connectionString)\n    {\n    }\n}\n</code></pre>\n\n<p>Then, you could create the instance for your <code>DbContext</code> as follows:</p>\n\n<pre><code>using (var dbContext = new BruceDbContext(connString))\n{\n    //TODO:\n}\n</code></pre>\n\n<p>Moreover, you could refer to <a href=\"https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local#local-settings-file\" rel=\"nofollow noreferrer\">Local settings file</a> for Azure Functions.</p>\n"}, {"comments": [{"owner": {"reputation": 3836, "user_id": 1514780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TS7PV.jpg?s=128&g=1", "display_name": "Mavi Domates", "link": "https://stackoverflow.com/users/1514780/mavi-domates"}, "edited": false, "score": 0, "creation_date": 1508368613, "post_id": 46715669, "comment_id": 80588699, "body": "Exactly how does this bypasses the providerName issue in production? I understand in local you&#39;re passing the ProviderName but in prod you&#39;re still missing that. Do you have any special stuff in the entityframeworkconnectionstring or is it identical to what you have in the local settings file (connectionstring) ?"}, {"owner": {"reputation": 3836, "user_id": 1514780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TS7PV.jpg?s=128&g=1", "display_name": "Mavi Domates", "link": "https://stackoverflow.com/users/1514780/mavi-domates"}, "edited": false, "score": 0, "creation_date": 1508368675, "post_id": 46715669, "comment_id": 80588715, "body": "Actually if you have an app.config or web.config can you please share that as well - or at least the relevant bits"}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "reply_to_user": {"reputation": 3836, "user_id": 1514780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TS7PV.jpg?s=128&g=1", "display_name": "Mavi Domates", "link": "https://stackoverflow.com/users/1514780/mavi-domates"}, "edited": false, "score": 0, "creation_date": 1508387785, "post_id": 46715669, "comment_id": 80593104, "body": "Hey Mavi, so the connection string that is being read by the constructor is the same exact connection string that is found in the local.settings.json. The only difference is the <code>ProviderName</code> is left out of it. There is no need to specify that in the constructor of a db context. I&#39;m assuming because it&#39;s already implied that the provider is entity framework if you are using a dbcontext. I do not have any <code>app.config</code> or <code>web.config</code>&#39;s at all. I simply add the 2 keys mentioned above to my app settings in the actual portal."}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "reply_to_user": {"reputation": 3836, "user_id": 1514780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TS7PV.jpg?s=128&g=1", "display_name": "Mavi Domates", "link": "https://stackoverflow.com/users/1514780/mavi-domates"}, "edited": false, "score": 0, "creation_date": 1508388058, "post_id": 46715669, "comment_id": 80593161, "body": "Example: place this as an <code>appsetting</code> in your azure portal: <code>metadata=res:&#47;&#47;*&#47;Model1.csdl|res:&#47;&#47;*&#47;Model1.ssdl|res:&#47;&#47;*&#47;Mod&zwnj;&#8203;el1.msl;provider=Sys&zwnj;&#8203;tem.Data.SqlClient;p&zwnj;&#8203;rovider connection string=&#39;data source=***;initial catalog=***;persist security info=True;User Id=***;Password=***;;multipleactiveresultsets=True;applicati&zwnj;&#8203;on name=EntityFramework&#39;</code> Then follow my code sample above to retrieve it. Make sure your property and constructors are static so they run before the instance constructors"}, {"owner": {"reputation": 3836, "user_id": 1514780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TS7PV.jpg?s=128&g=1", "display_name": "Mavi Domates", "link": "https://stackoverflow.com/users/1514780/mavi-domates"}, "edited": false, "score": 0, "creation_date": 1508440840, "post_id": 46715669, "comment_id": 80622206, "body": "I&#39;ve hardcoded the string and I&#39;m still getting this error"}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "reply_to_user": {"reputation": 3836, "user_id": 1514780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TS7PV.jpg?s=128&g=1", "display_name": "Mavi Domates", "link": "https://stackoverflow.com/users/1514780/mavi-domates"}, "edited": false, "score": 0, "creation_date": 1508447432, "post_id": 46715669, "comment_id": 80625615, "body": "I started a chat with you so we can talk there"}, {"owner": {"reputation": 3836, "user_id": 1514780, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TS7PV.jpg?s=128&g=1", "display_name": "Mavi Domates", "link": "https://stackoverflow.com/users/1514780/mavi-domates"}, "edited": false, "score": 1, "creation_date": 1508763904, "post_id": 46715669, "comment_id": 80727288, "body": "Oh! found what I was doing wrong! It was another method which initialized the entities without the hardcoded string (so still looking for the config values in a file). This method works. Thanks a lot Adrian"}, {"owner": {"reputation": 5260, "user_id": 492482, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c5d99b3cfb389c0b439851242982900c?s=128&d=identicon&r=PG", "display_name": "Emil", "link": "https://stackoverflow.com/users/492482/emil"}, "edited": false, "score": 0, "creation_date": 1515091927, "post_id": 46715669, "comment_id": 83178624, "body": "why do you use the AppSettings instead of using adding a new ConnectionString in the Portal? does this not work?"}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "edited": false, "score": 0, "creation_date": 1515104452, "post_id": 46715669, "comment_id": 83184467, "body": "It has been a while since I&#39;ve messed with this code but I believe the issue is that you cannot access the connection strings via <code>Environment.GetEnvironmentVariable</code> as only the app settings are loaded as environment variables. Also there are differences in the way you access these variables in local dev and in prod. For example, I also believe you cannot access app settings in prod by using ConfigurationManager but in local you can. It should be easy to test."}, {"owner": {"reputation": 5260, "user_id": 492482, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c5d99b3cfb389c0b439851242982900c?s=128&d=identicon&r=PG", "display_name": "Emil", "link": "https://stackoverflow.com/users/492482/emil"}, "edited": false, "score": 0, "creation_date": 1515411084, "post_id": 46715669, "comment_id": 83277053, "body": "Thank you for your answer. Beside that I am using EF edmx from database generated. Is it a good approach to amend Auto generated Context file? it will be overwritten anyway with the next update. there should be a safer way"}, {"owner": {"reputation": 5260, "user_id": 492482, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c5d99b3cfb389c0b439851242982900c?s=128&d=identicon&r=PG", "display_name": "Emil", "link": "https://stackoverflow.com/users/492482/emil"}, "edited": false, "score": 2, "creation_date": 1515423242, "post_id": 46715669, "comment_id": 83284045, "body": "Also you can use ConfigurationManager to get Connection string from Azure Function settings."}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "edited": false, "score": 0, "creation_date": 1515465163, "post_id": 46715669, "comment_id": 83300876, "body": "Hello batmaci, I saw your answer. If it works for others awesome! In response to your question above, yes the edmx files get overwritten unless you edit the t4 templates. I mentioned that in the edit."}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "edited": false, "score": 0, "creation_date": 1515529323, "post_id": 46715669, "comment_id": 83331921, "body": "Batmaci, can you use ConfigurationManager to get the connection strings on a deployed environment?"}, {"owner": {"reputation": 1453, "user_id": 816663, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MwTyd.jpg?s=128&g=1", "display_name": "SvenAelterman", "link": "https://stackoverflow.com/users/816663/svenaelterman"}, "edited": false, "score": 0, "creation_date": 1571429947, "post_id": 46715669, "comment_id": 103252338, "body": "I am confused. Your example uses Pascal case, but you say you <b>MUST</b> use camel case?"}, {"owner": {"reputation": 1453, "user_id": 816663, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MwTyd.jpg?s=128&g=1", "display_name": "SvenAelterman", "link": "https://stackoverflow.com/users/816663/svenaelterman"}, "edited": false, "score": 0, "creation_date": 1571430705, "post_id": 46715669, "comment_id": 103252614, "body": "Pro tip: if you copy and paste the Entity Framework connection string from an app.config file, replace the &amp;quot; by a single quote (<code>&#39;</code>)."}], "tags": [], "owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "is_accepted": true, "score": 12, "last_activity_date": 1523122020, "last_edit_date": 1592644375, "creation_date": 1507829632, "answer_id": 46715669, "question_id": 46698103, "link": "https://stackoverflow.com/questions/46698103/missing-providername-when-debugging-azurefunction-as-well-as-deploying-azure-fun/46715669#46715669", "title": "Missing ProviderName when debugging AzureFunction as well as deploying azure function", "body": "<p>So the solution ended up being trivial. The <code>ProviderName</code> attribute specified in <code>local.settings.json</code> <strong>MUST</strong> be camel case.</p>\n<p>From the original git hub discussions :<br />\n<a href=\"https://github.com/Azure/azure-functions-cli/issues/46\" rel=\"noreferrer\">https://github.com/Azure/azure-functions-cli/issues/46</a><br />\n<em>Shows the provider name as being pascal case</em></p>\n<p><a href=\"https://github.com/Azure/azure-functions-cli/issues/193\" rel=\"noreferrer\">https://github.com/Azure/azure-functions-cli/issues/193</a><br />\n<em>Shows the provider name being camel case in pseudo code</em>\nIt was very easy to miss but your config section must be exactly as follows</p>\n<pre><code>&quot;ConnectionStrings&quot;: {\n&quot;ShipBob_DevEntities&quot;: {\n  &quot;ConnectionString&quot;: &quot;metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SqlClient;provider connection string='data source=***;initial catalog=***;persist security info=True;User Id=***;Password=***;;multipleactiveresultsets=True;application name=EntityFramework'&quot;,\n  &quot;ProviderName&quot;:  &quot;System.Data.EntityClient&quot;\n  }\n}  \n</code></pre>\n<p>These points are important:</p>\n<ul>\n<li>Make sure your connection string has metadata information</li>\n<li>If copying your string from an xml config, make sure you unescape apostrophes</li>\n<li>Make sure the <code>ProviderName</code> attribute is <strong>camel case</strong></li>\n<li>Make sure the provider name is <code>System.Data.EntityClient</code></li>\n</ul>\n<h2>Fix for missing providername in deployment</h2>\n<p><em>Note, this answer assumes you are trying to use the parameterless constructor of a DbContext. If you are creating new code you can easily follow the second upvoted answer</em></p>\n<p>I figured out a way to circumvent the provider name issue while still retaining the use of the portal config and thus deployment slots. It involves setting the default connection string of db context using static properties</p>\n<pre><code>private static string _connectionString = &quot;name=ShipBob_DevEntities&quot;;\n\n    static ShipBob_DevEntities()\n    {\n        if(!string.IsNullOrEmpty(System.Environment.GetEnvironmentVariable(&quot;AzureFunction&quot;)))\n        {\n            var connectionString = System.Environment.GetEnvironmentVariable(&quot;EntityFrameworkConnectionString&quot;);\n\n            if (!string.IsNullOrEmpty(connectionString))\n            {\n                _connectionString = connectionString;\n            }\n        }\n    }\n\n    public ShipBob_DevEntities()\n        : base(_connectionString)\n    {\n        this.Configuration.LazyLoadingEnabled = false;\n    }  \n</code></pre>\n<p>This involves the developer to create an app setting in the azure portal as a flag. In my case it is <strong>AzureFunction</strong>. This makes sure that our code is only run in an azure function and all other clients of this DbContext, whether they be web apps, windows apps, etc, can still continue behaving as expected. This also involves adding your connection string to the azure portal as an <strong>AppSetting</strong> and not an actual connection string. Please use the full connection string including them <strong>metadata</strong> information but without the provider name!</p>\n<h2>EDIT</h2>\n<p>You will need to edit your auto generated .tt file t4 template to make sure this code does not get overridden if you are using db first.</p>\n<p>Here is a link on the T4 syntax: <a href=\"https://docs.microsoft.com/en-us/visualstudio/modeling/writing-a-t4-text-template\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/visualstudio/modeling/writing-a-t4-text-template</a></p>\n<p>And here is an explanation on EF T4 templates: <a href=\"https://msdn.microsoft.com/en-us/library/jj613116(v=vs.113).aspx#1159a805-1bcf-4700-9e99-86d182f143fe\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/jj613116(v=vs.113).aspx#1159a805-1bcf-4700-9e99-86d182f143fe</a></p>\n"}, {"comments": [{"owner": {"reputation": 1393, "user_id": 6566310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/804893c54aae1db13f3004f89624696f?s=128&d=identicon&r=PG", "display_name": "Jawand Singh", "link": "https://stackoverflow.com/users/6566310/jawand-singh"}, "edited": false, "score": 1, "creation_date": 1516860616, "post_id": 48152780, "comment_id": 83864532, "body": "your approach is better than the accepted answer. Thanks a lot. However, for Step 5, I have added a base class for my repository method and extracted the connection string in there and passed that property to DBContext Ctor."}, {"owner": {"reputation": 5260, "user_id": 492482, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c5d99b3cfb389c0b439851242982900c?s=128&d=identicon&r=PG", "display_name": "Emil", "link": "https://stackoverflow.com/users/492482/emil"}, "reply_to_user": {"reputation": 1393, "user_id": 6566310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/804893c54aae1db13f3004f89624696f?s=128&d=identicon&r=PG", "display_name": "Jawand Singh", "link": "https://stackoverflow.com/users/6566310/jawand-singh"}, "edited": false, "score": 0, "creation_date": 1516971372, "post_id": 48152780, "comment_id": 83916367, "body": "@JawandSingh indeed it is almost the same thing. If you are using POCO classes, it is easier to do that but using Database Generated Edmx file, i didnt want to change my DBContext as it might be overwritten later. therefore I did it using a partial class"}, {"owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "edited": false, "score": 1, "creation_date": 1523121916, "post_id": 48152780, "comment_id": 86433472, "body": "Hey @batmaci I&#39;m coming back after reviewing your answer. I just want to let others know, the difference between this answer and mine is that this answer assumes you have the luxury of newing up a new dbcontext in code. In my situation I did not have the luxury of doing that as I was reusing work units and services already written. There for my solution provides a way to continue using parameterless dbcontexts without having to specify a conection string in the constructors. Just to clarify for everyone."}, {"owner": {"reputation": 580, "user_id": 1864489, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/rikEY.jpg?s=128&g=1", "display_name": "Richard Griffiths", "link": "https://stackoverflow.com/users/1864489/richard-griffiths"}, "edited": false, "score": 0, "creation_date": 1525171784, "post_id": 48152780, "comment_id": 87247403, "body": "Unfortunately this doesn&#39;t work on my own project with a testdatalayer - I&#39;m beginning to think it&#39;s not intended to work on the current version of azure functions!"}, {"owner": {"reputation": 5260, "user_id": 492482, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c5d99b3cfb389c0b439851242982900c?s=128&d=identicon&r=PG", "display_name": "Emil", "link": "https://stackoverflow.com/users/492482/emil"}, "reply_to_user": {"reputation": 580, "user_id": 1864489, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/rikEY.jpg?s=128&g=1", "display_name": "Richard Griffiths", "link": "https://stackoverflow.com/users/1864489/richard-griffiths"}, "edited": false, "score": 0, "creation_date": 1525181505, "post_id": 48152780, "comment_id": 87252006, "body": "@RichardGriffiths do you mean in unit test project?  maybe you can create another ticket for your issue with more details."}, {"owner": {"reputation": 580, "user_id": 1864489, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/rikEY.jpg?s=128&g=1", "display_name": "Richard Griffiths", "link": "https://stackoverflow.com/users/1864489/richard-griffiths"}, "edited": false, "score": 0, "creation_date": 1525182084, "post_id": 48152780, "comment_id": 87252308, "body": "@batmaci I&#39;ve setup another question as I&#39;ve tried now publishing from VS and working from the portal (two separate functions of course) and nothing I try works. The detail on my question is regarding the first version - using the portal editor and largely following your approach.  I think one problem is trying to stick with .net 4.6 and similar simply because of the EF datalayer project. However, my understanding is this SHOULD work lol.  <a href=\"https://stackoverflow.com/questions/50115519/azure-functions-can-compile-but-cannot-run-with-custom-datalayer-library\" title=\"azure functions can compile but cannot run with custom datalayer library\">stackoverflow.com/questions/50115519/&hellip;</a>"}, {"owner": {"reputation": 317, "user_id": 1210069, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/N5jLS.jpg?s=128&g=1", "display_name": "jrichview", "link": "https://stackoverflow.com/users/1210069/jrichview"}, "edited": false, "score": 0, "creation_date": 1534873041, "post_id": 48152780, "comment_id": 90858332, "body": "This works if it is the only EF Context used in your project. I have a context in class library shared between apps, but another context in a web app using the class library. Web app context is instantiated 1st, and when I create the class lib context I get &quot;The default DbConfiguration instance was used by the Entity Framework before the &#39;AdminDBContextConfig&#39; type was discovered. An instance of &#39;AdminDBContextConfig&#39; must be set at application start before using any Entity Framework features or must be registered in the application&#39;s config file.  (etc)&quot;"}], "tags": [], "owner": {"reputation": 5260, "user_id": 492482, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c5d99b3cfb389c0b439851242982900c?s=128&d=identicon&r=PG", "display_name": "Emil", "link": "https://stackoverflow.com/users/492482/emil"}, "is_accepted": false, "score": 13, "last_activity_date": 1515423406, "creation_date": 1515423406, "answer_id": 48152780, "question_id": 46698103, "link": "https://stackoverflow.com/questions/46698103/missing-providername-when-debugging-azurefunction-as-well-as-deploying-azure-fun/48152780#48152780", "title": "Missing ProviderName when debugging AzureFunction as well as deploying azure function", "body": "<p>I went through several similar questions and answers here. Many of them are either misleading or assuming everybody is on the same level and understands how the azure functions are working. there is no answer for newbies like me. I would like to summarize here my solution step by step. I dont think that provided answer is the best option because it forces you to change the auto generated edmx files which can be overwritten by mistake or next update of your edmx from database. Also best option here is to use Connection strings instead of App settings in my opinion.</p>\n\n<ol>\n<li><p>most important thing is that we understand local.settings.json file\nIS NOT FOR AZURE. it is to run your app in the local as the name is\nclearly saying. So solution is nothing to do with this file.</p></li>\n<li><p>App.Config or Web.Config doesnt work for Azure function connection strings. If you have Database Layer Library you cant overwrite connection string using any of these as you would do in Asp.Net applications.</p></li>\n<li><p>In order to work with, you need to define your connection string on the azure portal under the <code>Application Settings</code> in your Azure function. There is \nConnection strings. there you should copy your connection string of your DBContext. if it is edmx, it will look like as below. There is Connection type, I use it SQlAzure but I tested with Custom(somebody claimed only works with custom) works with both. </p></li>\n</ol>\n\n<blockquote>\n  <p>metadata=res://<em>/Models.myDB.csdl|res://</em>/Models.myDB.ssdl|res://*/Models.myDB.msl;provider=System.Data.SqlClient;provider\n  connection string='data source=[yourdbURL];initial\n  catalog=myDB;persist security info=True;user\n  id=xxxx;password=xxx;MultipleActiveResultSets=True;App=EntityFramework</p>\n</blockquote>\n\n<ol start=\"4\">\n<li>After you set this up, You need to read the url in your application and provide the DBContext. DbContext implements a constructor with connection string parameter. By default constructor is without any parameter but you can extend this. if you are using POCO class, you can amend DbContext class simply. If you use Database generated Edmx classes like me, you dont want to touch the auto generated edmx class instead of you want to create partial class in the same namespace and extend this class as below.</li>\n</ol>\n\n<p>This is auto generated DbContext</p>\n\n<pre><code>namespace myApp.Data.Models\n{   \n\n    public partial class myDBEntities : DbContext\n    {\n        public myDBEntities()\n           : base(\"name=myDBEntities\")\n        {\n        }\n\n        protected override void OnModelCreating(DbModelBuilder modelBuilder)\n        {\n            throw new UnintentionalCodeFirstException();\n        }\n\n}\n</code></pre>\n\n<p>this is the new partial class, you create</p>\n\n<pre><code>namespace myApp.Data.Models\n{\n    [DbConfigurationType(typeof(myDBContextConfig))]\n    partial class myDBEntities\n    {\n\n        public myDBEntities(string connectionString) : base(connectionString)\n        {\n        }\n    }\n\n      public  class myDBContextConfig : DbConfiguration\n        {\n            public myDBContextConfig()\n            {\n                SetProviderServices(\"System.Data.EntityClient\", \n                SqlProviderServices.Instance);\n                SetDefaultConnectionFactory(new SqlConnectionFactory());\n            }\n        }\n    }\n</code></pre>\n\n<ol start=\"5\">\n<li>After all you can get the connection string from azure settings, in your Azure Function project with the code below and provide to your DbContext\nmyDBEntities is the name you gave in the azure portal for your connection string.</li>\n</ol>\n\n<blockquote>\n<pre><code>var connString = ConfigurationManager.ConnectionStrings[\"myDBEntities\"].ConnectionString;\n\n\n using (var dbContext = new myDBEntities(connString))\n{\n        //TODO:\n}\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5519, "user_id": 7009990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pv4MG.jpg?s=128&g=1", "display_name": "quervernetzt", "link": "https://stackoverflow.com/users/7009990/quervernetzt"}, "is_accepted": false, "score": 0, "last_activity_date": 1554298338, "last_edit_date": 1554298338, "creation_date": 1554297549, "answer_id": 55496200, "question_id": 46698103, "link": "https://stackoverflow.com/questions/46698103/missing-providername-when-debugging-azurefunction-as-well-as-deploying-azure-fun/55496200#55496200", "title": "Missing ProviderName when debugging AzureFunction as well as deploying azure function", "body": "<p>Here are two approaches that work for me:</p>\n\n<p><strong>Approach 1</strong></p>\n\n<ul>\n<li>Add the connection string to the App Settings (respectively local.settings.json) in the following format: </li>\n</ul>\n\n<blockquote>\n  <p>metadata=res://<em>/xxx.csdl|res://</em>/xxx.ssdl|res://*/xxx.msl;provider=System.Data.SqlClient;provider connection string='data source=xxx.database.windows.net;initial catalog=xxx;user id=xxx;password=xxx;MultipleActiveResultSets=True;App=EntityFramework'`</p>\n</blockquote>\n\n<ul>\n<li>Go to the class that extends DbContext (\"TestEntities\") and extend the constructor to take the connection string as argument</li>\n</ul>\n\n<pre><code>public partial class TestEntities: DbContext\n{\n    public TestEntities(string connectionString)\n        : base(connectionString)\n    {\n    }\n</code></pre>\n\n<ul>\n<li>If you want then to interact with the database you need to retrieve the connection string from the app settings and then pass it over when initializing DbContext</li>\n</ul>\n\n<pre><code>string connectionString = Environment.GetEnvironmentVariable(\"connectionStringAppSettings\");\n\nusing (var dbContext = new TestEntities(connectionString))\n{\n// Do Something\n}\n</code></pre>\n\n<ul>\n<li>The problem with this approach is that every time you update the database you need to update the class \"TestEntities\" as it is overwritten</li>\n</ul>\n\n<p><strong>Approach 2</strong></p>\n\n<ul>\n<li><p>The goal here is to leave the class \"TestEntities\" as is to avoid the issue from Approach 1</p></li>\n<li><p>Add the connection string to the App Settings (respectively local.settings.json) like in Approach 1</p></li>\n<li><p>Leave TestEntities as is</p></li>\n</ul>\n\n<pre><code>public partial class TestEntities : DbContext\n    {\n        public TestEntities ()\n            : base(\"name=TestEntities\")\n        {\n        }\n</code></pre>\n\n<ul>\n<li>As TestEntities is partial you can extend that class by creating another one that is also partial with the same name in the same namespace. The goal of this class is to provide the constructor that takes the connection string as argument</li>\n</ul>\n\n<pre><code>\npublic partial class TestEntities\n{\n    public TestEntities(string connectionString)\n        : base(connectionString)\n    {\n    }\n}\n</code></pre>\n\n<ul>\n<li>Then you can go on like with Approach 1</li>\n</ul>\n"}], "owner": {"reputation": 2922, "user_id": 1683744, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8efe8fdef92562316f432320f749d600?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1683744/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4928, "favorite_count": 4, "accepted_answer_id": 46715669, "answer_count": 4, "score": 14, "last_activity_date": 1554298338, "creation_date": 1507758628, "last_edit_date": 1508172579, "question_id": 46698103, "link": "https://stackoverflow.com/questions/46698103/missing-providername-when-debugging-azurefunction-as-well-as-deploying-azure-fun", "title": "Missing ProviderName when debugging AzureFunction as well as deploying azure function", "body": "<p>I have an issue getting a <code>DbContext</code> to correctly pull my connection string from my <code>local.settings.json</code></p>\n\n<p>Context:</p>\n\n<ul>\n<li>This is an Azure function project</li>\n<li>The main problem code is in <code>System.Data.Entity.Internal.AppConfig</code></li>\n<li>Although I have a <code>local.settings.json</code> file this is not dotnet core. It's .net 4.6.1</li>\n</ul>\n\n<p>Error message: </p>\n\n<blockquote>\n  <p>'The connection string 'ShipBob_DevEntities' in the application's configuration file does not contain the required providerName attribute.\"'  </p>\n</blockquote>\n\n<p>Json configuration:</p>\n\n<pre><code>{\n  \"IsEncrypted\": false,\n  \"Values\": {\n    \"AzureWebJobsStorage\": \"\",\n    \"AzureWebJobsDashboard\": \"\"\n},\n\n\"ConnectionStrings\": {\n\"ShipBob_DevEntities\": {\n  \"ConnectionString\": \"metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SqlClient;provider connection string='data source=***;initial catalog=***;persist security info=True;User Id=***;Password=***;;multipleactiveresultsets=True;application name=EntityFramework'\",\n  \"providerName\": \"System.Data.EntityClient\"\n    }\n  }\n}  \n</code></pre>\n\n<p>Configuration versions tested:</p>\n\n<ul>\n<li>Moving the provider name into the actual <code>ConnectionString</code> token value : same error ocurrs</li>\n<li>Setting the <code>provider</code> attribute inside the <code>ConnectionString</code> attribute to <code>EntityClient</code>: this did nothing</li>\n<li><p>Making <code>ShipBob_DevEntities</code> a string value = to the value of <code>ConnectionString</code> : this throws new errors the likes of which are </p>\n\n<blockquote>\n  <p>keyword metadata is not supported</p>\n</blockquote></li>\n<li><p>I tried using an ADO connection string which throws a <code>code first</code> exception which seems to occur when your connection string is incorrect in a <code>database first</code> approach.  </p></li>\n</ul>\n\n<p>I've taken the liberty to decompile <code>EntityFramework.dll</code> using <em>dotPeek</em> and have traced the problem down to <code>System.Data.Entity.Internal.LazyInternalConnection.TryInitializeFromAppConfig</code>. Inside this method there is a call to <code>LazyInternalConnection.FindConnectionInConfig</code> which spits out a <code>ConnectionStringSettings</code> object that has it's <code>ProviderName</code> value set to null. Unfortunately I am unable to debug the <code>AppConfig.cs</code> class which it seems to use to generate this value so I am stuck.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/magpD.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/magpD.png\" alt=\"enter image description here\"></a>   </p>\n\n<p>So far I have consulted these two articles. One of which states to put the provider name as it's own token; however, this is not working.</p>\n\n<p><a href=\"https://github.com/Azure/azure-functions-cli/issues/193\" rel=\"noreferrer\">https://github.com/Azure/azure-functions-cli/issues/193</a><br>\n<a href=\"https://github.com/Azure/azure-functions-cli/issues/46\" rel=\"noreferrer\">https://github.com/Azure/azure-functions-cli/issues/46</a> </p>\n\n<p>Does anyone know the correct format to use in local.settings.json for an Entity Framework connection?</p>\n"}, {"tags": ["c#", "multithreading"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1507758692, "post_id": 46698099, "comment_id": 80343948, "body": "Whether or not that&#39;s appropriate is going to depend on how you use it, and what you actually expect it to do (and not do)."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1507758981, "post_id": 46698099, "comment_id": 80344053, "body": "Define &quot;safely&quot;. No thread will crash, if that&#39;s what you mean. If you mean &quot;if any thread sets the flag to X at time T, will any thread reading the flag at time T + 1 read X&quot;, then <a href=\"https://stackoverflow.com/q/6139699/4137916\">we don&#39;t really know</a>."}, {"owner": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1507759390, "post_id": 46698099, "comment_id": 80344174, "body": "@JeroenMostert It&#39;s a private flag and only accessed via Interlocked methods. As such, I&#39;m not sure the link you posted is applicable as there are no other actors trying a read on the (private) field."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "reply_to_user": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "edited": false, "score": 0, "creation_date": 1507759455, "post_id": 46698099, "comment_id": 80344204, "body": "@spender: Private vs. public is completely irrelevant, as far as concurrent operations are concerned. The only thing that matters is whether multiple threads are involved, which the question posits there are."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1507759487, "post_id": 46698099, "comment_id": 80344214, "body": "It is not invalid, but very inefficient due to the full memory barrier and the pain of making Int64 work in 32-bit code.  Use Thread.VolatileRead/Write().  Int32 will do.  ManualResetEventSlim is likely the better way since it is waitable."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 1, "creation_date": 1507759544, "post_id": 46698099, "comment_id": 80344232, "body": "you don&#39;t need interlocked exchange. read write for fields of primitive types and reference types are atomic."}, {"owner": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1507759650, "post_id": 46698099, "comment_id": 80344258, "body": "@JeroenMostert : In a comment below the answer you shared &quot;Interlocked methods are safe and they always operate with fresh values. However, if you just read the variable value elsewhere, the value you get is not necessarily the same that you have updated with the Interlocked methods&quot; There is no &quot;reading elsewhere&quot; because the access to the flag is private."}, {"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "reply_to_user": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "edited": false, "score": 1, "creation_date": 1507759824, "post_id": 46698099, "comment_id": 80344309, "body": "@spender: that comment isn&#39;t what I was referring to. That is also correct, but not the issue here. The issue is whether <code>Interlocked</code> is enough, or you need <code>volatile</code>, or maybe neither, or both. The answers and the comments (and all the online material I&#39;ve ever read, even by authorities) have a devil of a time agreeing on this stuff. I&#39;m not questioning whether reading it without <i>any</i> synchronization would be correct, that&#39;s much simpler to settle."}, {"owner": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "reply_to_user": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1507760043, "post_id": 46698099, "comment_id": 80344374, "body": "@JeroenMostert Agreed. A constant source of confusion. I cant remember the last time I relied on code like this because it is confusing to verify. Most of the time, higher level (and well-tested) abstractions (such as Task) take care of these details for you."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507760184, "post_id": 46698099, "comment_id": 80344410, "body": "why are you using <code>Int64</code> for flag? you should provide more detail in your question."}, {"owner": {"reputation": 8613, "user_id": 1644813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HgpPS.jpg?s=128&g=1", "display_name": "Kirill Shlenskiy", "link": "https://stackoverflow.com/users/1644813/kirill-shlenskiy"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507762421, "post_id": 46698099, "comment_id": 80345068, "body": "@M.kazemAkhgary, <code>Interlocked</code> methods do more than just read and write stuff. They also insert fences. And <code>Int64</code> reads/writes are definitely not atomic on x86, although why <code>Int64</code> is even used here is beyond me."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1507767293, "post_id": 46698099, "comment_id": 80346232, "body": "&quot;both thread-safe and non-blocking&quot;? No - you must choose one or the other, unless you can accept stale (or possibly corrupt) data."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507813670, "post_id": 46698099, "comment_id": 80367302, "body": "@M.kazemAkhgary You&#39;re assuming that all that matters is that the code is atomic, and nothing else.  That&#39;s quite likely a false assumption, although since the question doesn&#39;t mention anything about how the code is used or what it needs to do, there really is no way of knowing for sure.  Odds are though that atomicity isn&#39;t enough."}, {"owner": {"reputation": 235, "user_id": 2953161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae68cccacab5333f25cb8afd4748b655?s=128&d=identicon&r=PG", "display_name": "Casey Anderson", "link": "https://stackoverflow.com/users/2953161/casey-anderson"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1507831257, "post_id": 46698099, "comment_id": 80378501, "body": "@M.kazemAkhgary Updated with an example and added clarification of 32/64 bit requirements. According to the <a href=\"https://msdn.microsoft.com/en-us/library/yss0xc74(v=vs.110).aspx\" rel=\"nofollow noreferrer\">MSDN on Interlocked</a>, it says &quot;The compare and exchange operations are performed as an atomic operation.&quot; Because this happens with 1 atomic transaction, is this not thread-safe and non-blocking?"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1507839232, "post_id": 46698099, "comment_id": 80382583, "body": "Just because it is atomic does not mean it is non-blocking. It makes the operation atomic by one of two methods, either waiting for the resource to become available, taking a exclusive lock, then doing it&#39;s operation, or it does the operation, then checks after the operation is done if it got the expected value, if not it does the operation again after waiting for a small period of time. Both of those techniques require blocking on the method till it can complete it&#39;s action."}, {"owner": {"reputation": 235, "user_id": 2953161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae68cccacab5333f25cb8afd4748b655?s=128&d=identicon&r=PG", "display_name": "Casey Anderson", "link": "https://stackoverflow.com/users/2953161/casey-anderson"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1507840927, "post_id": 46698099, "comment_id": 80383441, "body": "@ScottChamberlain: It looks like <a href=\"https://msdn.microsoft.com/en-us/library/yss0xc74(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Interlocked</a> is non-blocking and atomic according to this <a href=\"http://www.albahari.com/threading/part4.aspx\" rel=\"nofollow noreferrer\">source</a>:   &quot;Interlocked\u2019s methods have a typical overhead of 10 ns \u2014 half that of an uncontended lock. Further, they can never suffer the additional cost of context switching due to blocking. The flip side is that using Interlocked within a loop with many iterations can be less efficient than obtaining a single lock around the loop (although Interlocked enables greater concurrency).&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 23468, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 0, "creation_date": 1507766915, "post_id": 46699082, "comment_id": 80346150, "body": "&quot;Trying to avoid it&quot; is fine and all, except that by not using it (nor any kind of memory barrier) you&#39;ve lost any guarantees that the read of <code>_flag</code> won&#39;t be cached (possibly indefinitely) as a (thread-)local value, if the local code never writes to it. This is not an actual optimization the JIT will perform on x86 or x64 (I <i>think</i>), but it is at least theoretically permitted and valid (I <i>think</i>), unless you indicate that you really would like the compiler not to consider that. I think that a <code>Volatile.Read</code> would not be amiss."}], "tags": [], "owner": {"reputation": 27804, "user_id": 716092, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/kcc7I.png?s=128&g=1", "display_name": "Dan Dinu", "link": "https://stackoverflow.com/users/716092/dan-dinu"}, "is_accepted": false, "score": 0, "last_activity_date": 1507840581, "last_edit_date": 1507840581, "creation_date": 1507764707, "answer_id": 46699082, "question_id": 46698099, "link": "https://stackoverflow.com/questions/46698099/non-blocking-thread-safe-boolean-flag-in-c/46699082#46699082", "title": "Non-blocking thread-safe boolean flag in C#", "body": "<p>You're close but check MSDN documentation on CompareExchange: <a href=\"https://msdn.microsoft.com/en-us/library/801kt583(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/801kt583(v=vs.110).aspx</a> </p>\n\n<p>First of all, you can use an int instead of Int64 to keep the state of your flag, and reading an int is an atomic operation. Only reading an Int64 on a 32bit machine is not atomic. </p>\n\n<p>Your code should be something like: (i haven't tested it)</p>\n\n<pre><code>public bool Flag {\nget {\n    return _flag == 1; // no Interlocked.Read here, reading an int from memory is an atomic operation\n}\nset {\n    if ( value ) {\n        // set flag to \"true\" if it's false\n\n        int newFlagValue = 1;\n        int initialFlagValue;\n        do {\n        // Save the current flag value in a local variable.\n        initialFlagValue = _flag; \n        } while (initialFlagValue != Interlocked.CompareExchange(\n            ref _flag, newFlagValue, initialFlagValue));            \n    }\n    else {\n        // similar as above.\n    }\n}\n}\nprivate int _flag;\n</code></pre>\n\n<p>Update:</p>\n\n<p>Regarding the use of volatile, there are a lot of miss usages of it, so I would try to avoid it. Check this great post: \n<a href=\"https://stackoverflow.com/questions/72275/when-should-the-volatile-keyword-be-used-in-c\">When should the volatile keyword be used in C#?</a></p>\n"}], "owner": {"reputation": 235, "user_id": 2953161, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ae68cccacab5333f25cb8afd4748b655?s=128&d=identicon&r=PG", "display_name": "Casey Anderson", "link": "https://stackoverflow.com/users/2953161/casey-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1423, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1507840581, "creation_date": 1507758600, "last_edit_date": 1507838546, "question_id": 46698099, "link": "https://stackoverflow.com/questions/46698099/non-blocking-thread-safe-boolean-flag-in-c", "title": "Non-blocking thread-safe boolean flag in C#", "body": "<p>I want to create boolean flag that is both thread-safe and non-blocking on both <em>32 bit and 64 bit systems</em>. Does this solution satisfy those 2 requirements? If not, what will?</p>\n\n<pre><code>public bool Flag {\n    get {\n        return Interlocked.Read( ref _flag ) == 1;\n    }\n    set {\n        if ( value ) {\n            // set flag to \"true\" if it's false\n            Interlocked.CompareExchange( ref _flag, 1, 0 );\n        }\n        else {\n            // set flag to \"false\" if it's true\n            Interlocked.CompareExchange( ref _flag, 0, 1 );\n        }\n    }\n}\nprivate Int32 _flag;\n</code></pre>\n\n<p><em>(edited) to use <code>Int32</code> via. @M.kazemAkhgary</em></p>\n\n<p><strong>Example:</strong> 3 timers, each with intentionally overlapping tick intervals for this example. 2 timer callbacks are reading the flag. 1 timer callback reads and writes to the flag. </p>\n\n<pre><code>// Inline function\nvoid Callback( object msg ) {\n    if ( Flag ) Debug.WriteLine( (string) msg );\n}\n\n// Checks Flag\nvar timer1 = new Timer( \n    Callback,\n    \"Tick\", // callback arg\n    0,      // start timer now\n    100     // callback interval ms\n);\n\n// Checks Flag\nvar timer2 = new Timer( \n    Callback, \n    \"Tock\", // callback arg\n    0,      // start timer now\n    20      // callback interval ms\n);\n\n// Toggles Flag every second\nvar timer3 = new Timer( \n    _ =&gt; {\n        Flag = !Flag;\n    }, \n    null, // callback arg\n    0,    // start timer now\n    1000  // callback interval ms\n);\n</code></pre>\n"}, {"tags": ["c#"], "answers": [{"tags": [], "owner": {"reputation": 105321, "user_id": 14357, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SfY0b.png?s=128&g=1", "display_name": "spender", "link": "https://stackoverflow.com/users/14357/spender"}, "is_accepted": true, "score": 2, "last_activity_date": 1507759073, "last_edit_date": 1507759073, "creation_date": 1507758596, "answer_id": 46698098, "question_id": 46698076, "link": "https://stackoverflow.com/questions/46698076/no-arguments-that-correspond-to-the-mandatory-formal-parameter-item1-have-been-s/46698098#46698098", "title": "no arguments that correspond to the mandatory formal parameter item1 have been specified", "body": "<p>Tuples are immutable, so cannot be changed after construction. You can't set <code>Item1</code> or <code>Item2</code> after this point, so the only way to get values into it are at construction. This is enforced by a constructor signature that <em>requires</em> the values.</p>\n\n<p>You need to supply values to the constructor, or use the handy helper method:</p>\n\n<pre><code>Tuple.Create(new List&lt;Ranking&gt;(), new List&lt;RankingLegend&gt;())\n</code></pre>\n\n<p>Given that a Tuple is immutable, placing mutable structures within it is, IMO, somewhat questionable.</p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 8738586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c9f3993cc6f0292721114f931244e20?s=128&d=identicon&r=PG&f=1", "display_name": "Ilnumerouno", "link": "https://stackoverflow.com/users/8738586/ilnumerouno"}, "edited": false, "score": 0, "creation_date": 1507804998, "post_id": 46698112, "comment_id": 80361567, "body": "I just need to create the tuple"}, {"owner": {"reputation": 2185, "user_id": 2661801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mp7cr.jpg?s=128&g=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/2661801/carlos-rodriguez"}, "reply_to_user": {"reputation": 55, "user_id": 8738586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c9f3993cc6f0292721114f931244e20?s=128&d=identicon&r=PG&f=1", "display_name": "Ilnumerouno", "link": "https://stackoverflow.com/users/8738586/ilnumerouno"}, "edited": false, "score": 0, "creation_date": 1507817011, "post_id": 46698112, "comment_id": 80369666, "body": "You can\u2019t just create a tuple without items in the tuple (passed into the constructor)"}], "tags": [], "owner": {"reputation": 2185, "user_id": 2661801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Mp7cr.jpg?s=128&g=1", "display_name": "Carlos Rodriguez", "link": "https://stackoverflow.com/users/2661801/carlos-rodriguez"}, "is_accepted": false, "score": 0, "last_activity_date": 1507758668, "creation_date": 1507758668, "answer_id": 46698112, "question_id": 46698076, "link": "https://stackoverflow.com/questions/46698076/no-arguments-that-correspond-to-the-mandatory-formal-parameter-item1-have-been-s/46698112#46698112", "title": "no arguments that correspond to the mandatory formal parameter item1 have been specified", "body": "<p>Your tuple requires two items (A List and a List) to be passed into the constructor. You can't construct a tuple without the members of the tuple being provided. </p>\n"}], "owner": {"reputation": 55, "user_id": 8738586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c9f3993cc6f0292721114f931244e20?s=128&d=identicon&r=PG&f=1", "display_name": "Ilnumerouno", "link": "https://stackoverflow.com/users/8738586/ilnumerouno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 46698098, "answer_count": 2, "score": 0, "last_activity_date": 1507759073, "creation_date": 1507758487, "question_id": 46698076, "link": "https://stackoverflow.com/questions/46698076/no-arguments-that-correspond-to-the-mandatory-formal-parameter-item1-have-been-s", "title": "no arguments that correspond to the mandatory formal parameter item1 have been specified", "body": "<p>I've this object:</p>\n\n<pre><code>public class RankingAll\n{\n   public Tuple&lt;List&lt;Ranking&gt;, List&lt;RankingLegend&gt;&gt; Ranking { get; set; } \n}\n</code></pre>\n\n<p>I've declared this:</p>\n\n<pre><code>RankingAll rankingAll = new RankingAll();\nrankingAll.Ranking = new Tuple&lt;List&lt;Ranking&gt;, List&lt;RankingLegend&gt;&gt;();\n</code></pre>\n\n<p>but I get a compiler error on the last line</p>\n\n<blockquote>\n  <p>no arguments that correspond to the mandatory formal parameter item1 have been specified</p>\n</blockquote>\n\n<p>what's wrong?</p>\n"}, {"tags": ["c#", "json", "ajax", "asp.net-mvc-5", "asp.net-ajax"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4082943, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b8240c9e64f012a6310b062075879646?s=128&d=identicon&r=PG&f=1", "display_name": "oussama_tr", "link": "https://stackoverflow.com/users/4082943/oussama-tr"}, "is_accepted": false, "score": 0, "last_activity_date": 1507801695, "creation_date": 1507801695, "answer_id": 46706457, "question_id": 46698047, "link": "https://stackoverflow.com/questions/46698047/keep-geography-coords-from-ajax/46706457#46706457", "title": "keep geography coords from ajax", "body": "<p>we need to convert lng &amp; lant to double </p>\n\n<pre><code>   var currentLatLng = position.coords;\n                var Lat = currentLatLng.latitude;\n                var Lng = currentLatLng.longitude;\n                var LatDouble = parseFloat(Lat);\n                var LngDouble = parseFloat(Lng);\n</code></pre>\n\n<p>for Ajax is to delete att stringify</p>\n\n<pre><code> data: JSON({ CurrentLng:LngDouble , CurrentLat: LatDouble  }),\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4082943, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b8240c9e64f012a6310b062075879646?s=128&d=identicon&r=PG&f=1", "display_name": "oussama_tr", "link": "https://stackoverflow.com/users/4082943/oussama-tr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507801695, "creation_date": 1507758341, "question_id": 46698047, "link": "https://stackoverflow.com/questions/46698047/keep-geography-coords-from-ajax", "title": "keep geography coords from ajax", "body": "<p>good evening,\nj tries to retrieve the data from the user but the problem i\u00e7 that i can not handle the coords because of \",\" longitude and latitude, i do not know how to treat these give, i tried with parsefloat but without result, thank you\ncode controller action :</p>\n\n<pre><code>    public ActionResult GetNeaarByLocations(string CurrentLat, string CurrentLng)\n    {\n        using (GeolocationTestEntities context = new GeolocationTestEntities ())\n        {\n            var CurrentLocation = DbGeography.FromText(\"POINT(\" + CurrentLat + \" \" + CurrentLng + \")\");\n            //var CurrentLocation = DbGeography.FromText(\"POINT(36,806494799999996 10,181531600000001)\");\n            var places = (from u in context.schoolinfo orderby u.Location.Distance(CurrentLocation)\n                          select u).Take(4).Select(x=&gt;new schoollinfo(){ Name = x.name ,Lat = x.Location.Latitude, Lng = x.Location.Longitude,Distance = x.Location.Distance(CurrentLocation)});\n            var nearschools = places.ToList();\n            return Json(nearschools , JsonRequestBehavior.AllowGet);\n        }\n    }\n</code></pre>\n\n<p>and this is code Ajax :</p>\n\n<pre><code>jQuery.ajax({\n                    cache: false,\n                    type: \"POST\",\n                    url: \"@Url.Action(\"GetNeaarByLocations\")\",\n                    dataType: \"json\",\n                contentType: \"application/json;charset=utf-8\",\n                data: JSON.stringify({ CurrentLng:currentLatLng.longitude, CurrentLat: currentLatLng.latitude }),\n                success: function (data) {\n                    if (data != undefined) {\n                        $.each(data, function (i, item) {\n                            addMarker(item[\"lat\"], item[\"lng\"], \"Click to get  directions\");\n\n                        })\n                    }\n                },\n                failure: function (errMsg) {\n                    alert(errMsg);\n                }\n\n            });\n</code></pre>\n\n<p>thanks all.</p>\n"}, {"tags": ["c#", "serialization", "enums"], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 3772416, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/968873dced9c9bdc8cc206b38cbc9d1e?s=128&d=identicon&r=PG&f=1", "display_name": "cce1911", "link": "https://stackoverflow.com/users/3772416/cce1911"}, "edited": false, "score": 0, "creation_date": 1507759359, "post_id": 46698120, "comment_id": 80344167, "body": "Almost! <code>CycleTimeUnit = (TimeUnit)info.GetValue(&quot;CycleTimeUnit&quot;, typeof(TimeUnit));</code> did the trick! Thanks for your help."}, {"owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "reply_to_user": {"reputation": 313, "user_id": 3772416, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/968873dced9c9bdc8cc206b38cbc9d1e?s=128&d=identicon&r=PG&f=1", "display_name": "cce1911", "link": "https://stackoverflow.com/users/3772416/cce1911"}, "edited": false, "score": 0, "creation_date": 1507786837, "post_id": 46698120, "comment_id": 80351406, "body": "You&#39;re welcome, I edited to give the right answer for the future."}], "tags": [], "owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "is_accepted": true, "score": 4, "last_activity_date": 1507786781, "last_edit_date": 1507786781, "creation_date": 1507758701, "answer_id": 46698120, "question_id": 46697964, "link": "https://stackoverflow.com/questions/46697964/deserializing-enum-from-the-serializationinfo-store/46698120#46698120", "title": "Deserializing enum from the Serializationinfo store?", "body": "<p>Try this:</p>\n\n<pre><code>private Process(SerializationInfo info, StreamingContext context)\n{\n    CycleTime = info.GetDouble(\"CycleTime\");\n    CycleTimeUnit = (TimeUnit) info.GetValue(\"CycleTimeUnit\", typeof(TimeUnit)); \n}\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 3772416, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/968873dced9c9bdc8cc206b38cbc9d1e?s=128&d=identicon&r=PG&f=1", "display_name": "cce1911", "link": "https://stackoverflow.com/users/3772416/cce1911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "accepted_answer_id": 46698120, "answer_count": 1, "score": 4, "last_activity_date": 1507786781, "creation_date": 1507757855, "question_id": 46697964, "link": "https://stackoverflow.com/questions/46697964/deserializing-enum-from-the-serializationinfo-store", "title": "Deserializing enum from the Serializationinfo store?", "body": "<p>I have a class called <code>UnitsManager</code>. In this class is an enum:</p>\n\n<pre><code>public enum TimeUnit\n{\n    Seconds,\n    Milliseconds,\n    Minutes,\n    Hours,\n    Days,\n    Months,\n    Years\n}\n</code></pre>\n\n<p>This enum is used in another class called <code>Process</code>. It has a property:</p>\n\n<pre><code>    private TimeUnit cycleTimeUnit = TimeUnit.Seconds; \n    [XmlAttribute(\"CycleTimeUnit\")]\n    public TimeUnit CycleTimeUnit\n    {\n        get { return this.cycleTimeUnit; }\n        set { this.cycleTimeUnit = value; }\n    }\n</code></pre>\n\n<p>I'm trying to serialize and deserialize the <code>Process</code> class. I've implemented ISerializable on the <code>Process</code> class </p>\n\n<pre><code>    public override void GetObjectData(SerializationInfo info, StreamingContext context)\n    {\n        base.GetObjectData(info, context);\n\n        info.AddValue(\"CycleTime\", CycleTime);\n        info.AddValue(\"CycleTimeUnit\", CycleTimeUnit);\n    }\n</code></pre>\n\n<p>My problem comes in the deserialization</p>\n\n<pre><code>    private Process(SerializationInfo info, StreamingContext context)\n    {\n        CycleTime = info.GetDouble(\"CycleTime\");\n        CycleTimeUnit = info.????(\"CycleTimeUnit\"); // &lt;--- ???\n    }\n</code></pre>\n\n<p>How do I cast this as a type <code>CycleTimeUnit</code>?</p>\n"}, {"tags": ["c#", "asp.net", "sql-server"], "comments": [{"owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 4, "creation_date": 1507758620, "post_id": 46697954, "comment_id": 80343920, "body": "If you are going to support time zones in your applications then you would be better served storing your DateTimes in UTC, such as DateTime.UtcNow. It will make date time math less error prone. Basically, just Convert from user&#39;s zone to UTC when saving and convert from UTC to user&#39;s zone when retrieving."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "edited": false, "score": 0, "creation_date": 1507761163, "post_id": 46697954, "comment_id": 80344714, "body": "@RossBush You should post that as the answer. Also, you would convert the current day to two UTC times and filter on that to return today&#39;s followups."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 1314622, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32b805154c94e52d6937f9e87a36f819?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/1314622/mark"}, "edited": false, "score": 0, "creation_date": 1507777492, "post_id": 46700073, "comment_id": 80348624, "body": "Thanks Ross for your help, most appreciated :)"}], "tags": [], "owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "is_accepted": true, "score": 2, "last_activity_date": 1507772392, "creation_date": 1507772392, "answer_id": 46700073, "question_id": 46697954, "link": "https://stackoverflow.com/questions/46697954/handling-timezone-differences/46700073#46700073", "title": "Handling timezone differences", "body": "<p>Here is a static class that you may find useful. If you are at a point where you can tweak the design then you may want to think about if you really need to save DateTimeOffsets in  your database the way you are (it is basically a DateTime with an offset designator). It can be done, however, to me, it seems unnecessary. Feel free to use of modify if you would like. When I use I wrap it with another class that is created with a reference to a specific time zone instance and then all calculations can be done from there. </p>\n\n<pre><code>var usersTimeZoneInfo = TimeZoneInfo.FindSystemTimeZoneById(\"Cen. Australia Standard Time\");\nvar utcTime=  myDb.GetSomeUTCDateTime();\nvar userslocalTime = TimeZoneConversion.FromUTCToSpecificTimeZone(usersTimeZoneInfo, utcTime); \n\nusersLocalTime.AddsHours(2);\n//Display some time and save\n\nvar utcTimeToSave = TimeZoneConversion.FromSpecificTimeZoneToUTC(usersTimeZoneInfo,userLocalTime); \nmyDb.SaveUTCTime(utcTimeToSave);\n</code></pre>\n\n<p>The pseudo code above uses the static class attached below.</p>\n\n<pre><code>namespace MyApp.Core.DateTime\n{\n    public static class TimeZoneConversion\n    {\n        public static System.DateTime FromSpecificTimeZoneToUTC(string specificZone, System.DateTime specificTimeZoneDateTime)\n        {\n            TimeZoneInfo fromZone = TimeZoneInfo.FindSystemTimeZoneById(specificZone);\n            return TimeZoneInfo.ConvertTimeToUtc(specificTimeZoneDateTime, fromZone);\n        }\n\n        public static System.DateTime FromSpecificTimeZoneToUTC(TimeZoneInfo fromZone, System.DateTime specificTimeZoneDateTime)\n        {\n            System.DateTime temp = System.DateTime.SpecifyKind(specificTimeZoneDateTime, DateTimeKind.Unspecified);\n            return TimeZoneInfo.ConvertTimeToUtc(temp, fromZone);\n        }\n\n        public static System.DateTime FromUTCToSpecificTimeZone(TimeZoneInfo toZone, System.DateTime UTCTimeZoneDateTime)\n        {          \n            return TimeZoneInfo.ConvertTimeFromUtc(UTCTimeZoneDateTime, toZone);\n        }\n\n        public static TimeSpan GetTimeZoneOffsetDifference(TimeZoneInfo oldZone, TimeZoneInfo newZone)\n        {           \n            var now = DateTimeOffset.UtcNow;\n            TimeSpan oldOffset = oldZone.GetUtcOffset(now);\n            TimeSpan newOffset = newZone.GetUtcOffset(now);\n            TimeSpan difference = oldOffset - newOffset;\n            return difference;\n        }\n\n        public static System.DateTime FromUTCToSpecificTimeZone(string totimezone, System.DateTime UTCTimeZoneDateTime)\n        {\n            TimeZoneInfo toZone = TimeZoneInfo.FindSystemTimeZoneById(totimezone);\n            return TimeZoneInfo.ConvertTimeFromUtc(UTCTimeZoneDateTime, toZone);\n        }\n\n        public static System.DateTime FromLocalTimeZoneToUTC(System.DateTime localDateTime)\n        {\n            return localDateTime.ToUniversalTime();\n        }\n\n        public static string GetServerTimeZoneID()\n        {\n            return \"Eastern Standard Time\";\n        }\n\n\n        public static int GetServerDatabaseTimeZoneID()\n        {\n            return 40;\n        }\n\n        public static string TimeZoneShortName(TimeZoneInfo tzi)\n        {\n            switch (tzi.StandardName)\n            {\n                case \"Eastern Standard Time\": return \"EST\";\n                case \"Hawaiian Time\": return \"HST\";\n                case \"Dateline Time\": return \"GMT\";\n                case \"Alaskan Time\": return \"\";\n                case \"Pacific Standard Time\": return \"PST\";\n                case \"Mountain Standard Time\": return \"MST\";\n                case \"Central Standard Time\": return \"CST\";\n                case \"Canada Central Standard Time\": return \"CST\";\n                case \"GMT Standard Time\": return \"GMT\";\n                default:\n                    return \"\";\n\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 1314622, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/32b805154c94e52d6937f9e87a36f819?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/1314622/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 46700073, "answer_count": 1, "score": 0, "last_activity_date": 1507772392, "creation_date": 1507757821, "question_id": 46697954, "link": "https://stackoverflow.com/questions/46697954/handling-timezone-differences", "title": "Handling timezone differences", "body": "<p>I am creating a small CRM and I need to be able to take into account the fact that the software will be used internationally and therefore dates and offsets will be an issue.</p>\n\n<p>Specifically, the software needs to be able to show leads that need following up for a specified date depending on the persons timezone. e.g When logging into the software all leads that need following up need to be displayed for the <em>current</em> day for the persons timezone.</p>\n\n<p>I have the following database schema where I am storing the dates as datatype datetimeoffset</p>\n\n<p><a href=\"https://i.stack.imgur.com/ruEwj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ruEwj.png\" alt=\"enter image description here\"></a></p>\n\n<p>When registering I am also capturing the persons timezone and saving that into another database table (e.g. \"Cen. Australia Standard Time\") based on the C# TimeZones. </p>\n\n<p>For this example the FollowUpDate is simply being stored in the database as a C# DateTime.Now;</p>\n\n<p>I can use the following code to work out date offsets based on the FollowUpDate that is stored in the database as well as leveraging the persons timezone.</p>\n\n<pre><code>var FollowUpDate = DateTime.Now;\nvar result = new DateTimeOffset(FollowUpDate,             TimeZoneInfo.FindSystemTimeZoneById(\"Cen. Australia Standard Time\")\n            .GetUtcOffset(FollowUpDate));\n</code></pre>\n\n<p>My question is using the above how would I get leads for the current day for the person based on the FollowUpDate? I'm assuming I can use some sort of TimeSpan calculation??</p>\n\n<p>Also, is the above the best way to handle this scenarion? I have done some research but it's all a bit cryptic tbh</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "linq", "sorting"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 1, "creation_date": 1507758009, "post_id": 46697936, "comment_id": 80343693, "body": "There is no need of the external foreach and the if. Just do the sort and then set the DataSource of the summaryListBox to sortNames.ToList(); unless the DisplayCustomers doesn&#39;t simply return the customer name"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1507758030, "post_id": 46697936, "comment_id": 80343700, "body": "Your code seems to have a problem - you are doing <code>orderby Name</code> without defining <code>Name</code> anywhere? You should be doing <code>orderby</code> something in <code>Customer</code> i.e. <code>Customer.Name</code>? Also, you shouldn&#39;t be using your <code>Customer</code> type as the range variable in your LINQ, so <code>from aCust in allCustomers orderby aCust.Name select aCust.Name</code>"}], "answers": [{"comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 1, "creation_date": 1507758160, "post_id": 46698007, "comment_id": 80343738, "body": "Apparently <code>Customer</code> contains multiple fields so you need a <code>Select</code>."}], "tags": [], "owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "is_accepted": false, "score": 1, "last_activity_date": 1507758744, "last_edit_date": 1507758744, "creation_date": 1507758065, "answer_id": 46698007, "question_id": 46697936, "link": "https://stackoverflow.com/questions/46697936/sort-list-according-to-names-in-c-using-linq-queries/46698007#46698007", "title": "Sort List according to names in C# using Linq queries", "body": "<p>Im not sure I quite understand what you are asking, but if you just want all the Customers to be added in alphabetic order, I think you can just change your <code>sNameBtn_Click()</code> method to this:</p>\n\n<pre><code>private void sNameBtn_Click(object sender, EventArgs e)\n{\n    summaryListBox.Items.Clear();\n    summaryListBox.Items.AddRange(allCustomers.OrderBy(x =&gt; x).Select(x =&gt; x.DisplayCustomers()));                 \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 962, "user_id": 4487790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a52ad2d5bf34587b81c01e624d7aeb40?s=128&d=identicon&r=PG&f=1", "display_name": "Ayaz", "link": "https://stackoverflow.com/users/4487790/ayaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1507758864, "last_edit_date": 1507758864, "creation_date": 1507758333, "answer_id": 46698044, "question_id": 46697936, "link": "https://stackoverflow.com/questions/46697936/sort-list-according-to-names-in-c-using-linq-queries/46698044#46698044", "title": "Sort List according to names in C# using Linq queries", "body": "<p>First sort the list then loop through and it to the list item.</p>\n\n<pre><code>summaryListBox.Items.Clear(); allCustomers = (from Customer in allCustomers orderby Customer.Name ascending select Customer).ToList(); foreach (Customer aCustomer in allCustomers) {  summaryListBox.Items.Add(aCustomer.DisplayCustomers());  } \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7644293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507758864, "creation_date": 1507757754, "last_edit_date": 1507758041, "question_id": 46697936, "link": "https://stackoverflow.com/questions/46697936/sort-list-according-to-names-in-c-using-linq-queries", "title": "Sort List according to names in C# using Linq queries", "body": "<p>Here is where I get a new customer when the user saves the customer information. I have a List called allcustomers where I store the customer object. So I generate a list of customers on my summary list with all the customer information. But I want to be able to use linq query to sort the names alphabetically in the Listbox. Here is my code for that, it doesn't sort the names. Any suggestions?</p>\n\n<pre><code>List&lt;Customer&gt; allCustomers = new List&lt;Customers&gt;();\n\nprivate void saveCustomerBtn_Click_1(object sender, EventArgs e)\n{\n    if (lNameTextBox.Text.Length &gt; 0 &amp;&amp; addressTextBox.Text.Length &gt; 0)\n    {                \n        Customer aCustomer = new Customer(lNameTextBox.Text, addressTextBox.Text, Convert.ToDouble(idTextBox.Text), aReservation);\n        conCustLabel.Text = \"Customer Information has been saved!\";\n\n        allCustomers.Add(aCustomer);\n    }\n    else\n    {\n        MessageBox.Show(\"No data has been entered, Please enter the information!\");\n    }\n}\n\nprivate void sNameBtn_Click(object sender, EventArgs e)\n{\n    summaryListBox.Items.Clear();\n\n    foreach (Customer aCustomer in allCustomers)\n    {                \n        var sortNames = from Customer in allCustomers\n                        orderby Name ascending   \n                        select Name;\n\n        if (sortNames.Any())\n        {\n            summaryListBox.Items.Add(aCustomer.DisplayCustomers());\n        }             \n    }                    \n}\n</code></pre>\n"}, {"tags": ["c#", "fortify"], "answers": [{"comments": [{"owner": {"reputation": 3859, "user_id": 391656, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9051bf8057ffcd22c3988ed052431f26?s=128&d=identicon&r=PG", "display_name": "Mr.Mindor", "link": "https://stackoverflow.com/users/391656/mr-mindor"}, "edited": false, "score": 0, "creation_date": 1508337075, "post_id": 46810007, "comment_id": 80572375, "body": "-1 Please try reading the question again, this answer gets almost everything about this scenario wrong, and reads as &#39;Do that thing you said you already did and isn&#39;t working like it should.&#39; 1. Fortify is not complaining about what is coming out of the database, but what is going in.(A vulnerability is reported where the sql is set on the command, not where it is executed, and not where the results are used(no results used). I&#39;ve added an example and comments to hopefully better demonstrate this.) 2. The problem I&#39;m reporting is <b>Even with the rule</b>, Fortify is not trusting the sql."}, {"owner": {"reputation": 3859, "user_id": 391656, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9051bf8057ffcd22c3988ed052431f26?s=128&d=identicon&r=PG", "display_name": "Mr.Mindor", "link": "https://stackoverflow.com/users/391656/mr-mindor"}, "edited": false, "score": 0, "creation_date": 1508337144, "post_id": 46810007, "comment_id": 80572427, "body": "3. Fortify is not showing where the &#39;tainted&#39; input is coming from. (I&#39;ve added screenshots for the Analysis Evidence and Diagram to better demonstrate this.) 4. No vulnerability reported for <code>ExecuteSomeLocalSql</code> and <code>ReadEmbeddedSqlLocallyDefined</code>  5. &#39;Write additional cleanse rules&#39; Again the problem reported is that the cleanse rules don&#39;t cleanse the distrust. I know I put a lot of information into my questions, but it is because I want to make it clear what I have already attempted. How can I make that more clear?"}, {"owner": {"reputation": 3859, "user_id": 391656, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9051bf8057ffcd22c3988ed052431f26?s=128&d=identicon&r=PG", "display_name": "Mr.Mindor", "link": "https://stackoverflow.com/users/391656/mr-mindor"}, "edited": false, "score": 1, "creation_date": 1508356813, "post_id": 46810007, "comment_id": 80583869, "body": "Thanks for the second look/update. I did look at filters but had decided against using them because they seem like either an overly broad brush (silence a particular rule, or category) or more work than not doing anything (if filtering on issue number, the issue has to show up before it can be filtered, so still has to be examined on a per-issue basis."}, {"owner": {"reputation": 3859, "user_id": 391656, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9051bf8057ffcd22c3988ed052431f26?s=128&d=identicon&r=PG", "display_name": "Mr.Mindor", "link": "https://stackoverflow.com/users/391656/mr-mindor"}, "edited": false, "score": 0, "creation_date": 1508356910, "post_id": 46810007, "comment_id": 80583925, "body": "Turns out your assumption about the analyzer was spot on: These are being triggered by the semantic analyzer, and that would be why the dataflow rule doesn&#39;t help. Which analyzer wasn&#39;t displayed anywhere I could find in the application (Visual Studio plugin), and only showed up on the BIRT report."}], "tags": [], "owner": {"reputation": 6968, "user_id": 31474, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4a52e5464bf4559fc5dc6065d1ddfaca?s=128&d=identicon&r=PG", "display_name": "SBurris", "link": "https://stackoverflow.com/users/31474/sburris"}, "is_accepted": false, "score": 1, "last_activity_date": 1508360922, "last_edit_date": 1508360922, "creation_date": 1508329087, "answer_id": 46810007, "question_id": 46697869, "link": "https://stackoverflow.com/questions/46697869/fortify-cleanse-rule-doesnt-cleanse-everything/46810007#46810007", "title": "Fortify cleanse rule doesn&#39;t cleanse everything", "body": "<p>When I run your sample code (I do have to modify it since it will not compile as is).  When I run it with SCA 17.10 with 2017Q3 (I also did this on 2017Q2) I did not get a the same SQL Injection Rule ID as you.</p>\n\n<p>Looking at your Analysis Evidence, I assume that the analyzer that found this was not Dataflow or Control flow but maybe the Semantic or Structural?</p>\n\n<p>You can see the type of analyzer that found the finding by looking at the summary tab:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Zu6UL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zu6UL.png\" alt=\"Displaying the summary tab of Visual Studio Fortify plugin, highlighting the analyzer engine that found the specific issue selected.\"></a></p>\n\n<p>Either way, I don't think a Custom Rule is what I would do here.</p>\n\n<p>An option you can do is to use a Filter file.</p>\n\n<p>This a file that can contain</p>\n\n<ul>\n<li>RuleIDs</li>\n<li>InstanceIDs</li>\n<li>Categories</li>\n</ul>\n\n<p>When this file is passed into the scan command, any finding that matches any of the fields in the filter file will be filtered out from the results.</p>\n\n<p>You can find examples of using the filter file in <code>&lt;SCA Install Dir&gt;\\Samples\\Advanced\\filter</code></p>\n\n<p>or you can look in the <a href=\"https://community.saas.hpe.com/t5/PDF-HPE-Security-Fortify/HPE-Security-Fortify-Static-Code-Analyzer-User-Guide/ta-p/1587846\" rel=\"nofollow noreferrer\">Fortify SCA Users Guide</a> in Appendix B: Filtering the Analysis</p>\n\n<p>*Note: Your analysis of using filters (in comment) are spot on.</p>\n"}], "owner": {"reputation": 3859, "user_id": 391656, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9051bf8057ffcd22c3988ed052431f26?s=128&d=identicon&r=PG", "display_name": "Mr.Mindor", "link": "https://stackoverflow.com/users/391656/mr-mindor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508360922, "creation_date": 1507757391, "last_edit_date": 1508337159, "question_id": 46697869, "link": "https://stackoverflow.com/questions/46697869/fortify-cleanse-rule-doesnt-cleanse-everything", "title": "Fortify cleanse rule doesn&#39;t cleanse everything", "body": "<p>My team has recently started using Fortify Static Code Analyzer (version 17.10.0 156) on our .NET code base (C# 6 and VB.NET), and are experiencing some pain with the amount of false positives it reports. For any given issue we can't know if it is a false positive without looking at it, and we don't want any actual problems to get lost in the clutter. </p>\n\n<p>We have a utilities library with a method <code>ReadEmbeddedSql</code> which extracts sql from resources embedded in the assembly to execute. Fortify flags any <code>OracleCommand</code> (from <code>Oracle.ManagedDataAccess.Client</code>) which execute the sql returned from this method with a Sql Injection vulnerability. \nThis vulnerability is reported at the point the sql is set on the command, be it via constructor, or via the CommandText property. </p>\n\n<p>It does not do this if the <code>ReadEmbeddedSql</code> method is defined in the local assembly.</p>\n\n<p>A pared down listing of the source code which produces this result follows below. In the example code, <code>ExecuteSomeSql()</code> and <code>ExecuteSomeSqlDifferently()</code> are flagged with a vulnerability where <code>ExecuteSomeLocalSql()</code> is not.</p>\n\n<p>For Analysis Evidence it only lists the line the OracleCommand is created:\n<a href=\"https://i.stack.imgur.com/ajcDv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ajcDv.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>TestDao.cs:27 - OracleCommand()</p>\n  \n  <p>RuleID: 31D4607A-A3FF-447C-908A-CA2BBE4CE4B7</p>\n</blockquote>\n\n<p>in the details for the issue it provides:</p>\n\n<blockquote>\n  <p>On line 27 of TestDao.cs, the method ExecuteSomeSql() invokes a SQL query\n  built using input coming from an untrusted source. This call could\n  allow an attacker to modify the statement's meaning or to execute\n  arbitrary SQL commands.</p>\n</blockquote>\n\n<p>A sample diagram presented by Fortify for this issue:\n<a href=\"https://i.stack.imgur.com/XdTco.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XdTco.png\" alt=\"ExecuteSomeSql Diagram\"></a></p>\n\n<p>After much searching, I came across this post describing a similar problem and proposed solution: <a href=\"https://community.saas.hpe.com/t5/Fortify-Questions/Can-I-register-a-trusted-source-for-SQL-statements/qaq-p/1558238%20%22Can%20I%20register%20a%20trusted%20source%20for%20SQL%20statements\" rel=\"nofollow noreferrer\">Can I register a trusted source for SQL statements</a></p>\n\n<p>After following the instructions there, and verifying the instructions independently in a <a href=\"http://file:///C:/Users/mxp026/Documents/HP_Fortify_Audit_Workbench_User_Guide_4.00.pdf\" rel=\"nofollow noreferrer\">different version of the user guide</a> (page 90)</p>\n\n<p>The result is unchanged. I added an additional 'SQL Injection Validation Rule'  rule which is specifically described as \"... identifies a function that properly validates data before using them in a SQL query.\" </p>\n\n<p>Still no avail.</p>\n\n<p>EDIT:\nI have played around with custom rules more, and have been able to determine that the CustomCleanseRules are actually being applied (they do remove other types of taint), but not removing some trust specific flag Fortify applies to our in-house library. </p>\n\n<p>Every value returned from any method of my libraries is distrusted, and none of the rules I've created seem to be able to remove this distrust.</p>\n\n<p>Is there something I am doing wrong, or does Fortify just not work?</p>\n\n<p>Is there a different type of rule needed to cleanse this general distrust?</p>\n\n<p>Example Source code:</p>\n\n<p>In library:</p>\n\n<pre><code>namespace Our.Utilities.Database\n{\n    public abstract class BaseDao\n    {\n        protected string ReadEmbeddedSql(string key)\n        {\n            //... extract sql from assembly\n            return sql;\n        }\n    }\n}\n</code></pre>\n\n<p>In application:</p>\n\n<pre><code>namespace Our.Application.DataAccess\n{\n    public class TestDao: Our.Utilities.Database.BaseDao\n    {\n        public void ExecuteSomeSql()\n        {\n            //... connection is created\n            // Fortify Does not trust sqlText returned from library method.\n            var sqlText = ReadEmbeddedSql(\"sql.for.ExecuteSomeSql\");\n            using(var someSqlCommand = new OracleCommand(sqlText, connection)) // Fortify flags creation of OracleCommand as SqlInjection vulnerability.\n            {\n                 someSqlCommand.ExecuteNonQuery();\n            }\n        }\n        public void ExecuteSomeSqlDifferently()\n        {\n            //... connection is created\n            // Fortify Does not trust sqlText returned from library method.\n            var sqlText = ReadEmbeddedSql(\"sql.for.ExecuteSomeSql\");\n            using(var someSqlCommand = connection.CreateCommand()) \n            {\n                 someSqlCommand.CommandText = sqlText; //Fortify flags setting CommandText as SqlInjection vulnerability.\n                 someSqlCommand.ExecuteNonQuery();\n            }\n        }\n        public void ExecuteSomeLocalSql()\n        {\n\n            //... connection is created\n            var sqlText = ReadEmbeddedSqlLocallyDefined(\"sql.for.ExecuteSomeSql\");\n            using(var someSqlCommand = new OracleCommand(sqlText, connection))\n            {\n                 someSqlCommand.ExecuteNonQuery();\n            }\n        }\n        protected string ReadEmbeddedSqlLocallyDefined(string key)\n        {\n            //... extract sql from assembly\n            return sql;\n        }\n    }\n}\n</code></pre>\n\n<p>XML of custom rules:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;RulePack xmlns=\"xmlns://www.fortifysoftware.com/schema/rules\"&gt;\n    &lt;RulePackID&gt;5A78FC44-4EEB-49C7-91DA-6564805C3F23&lt;/RulePackID&gt;\n    &lt;SKU&gt;SKU-C:\\local\\path\\to\\custom\\rules\\Our-Utilities&lt;/SKU&gt;\n    &lt;Name&gt;&lt;![CDATA[C:\\local\\path\\to\\custom\\rules\\Our-Utilities]]&gt;&lt;/Name&gt;\n    &lt;Version&gt;1.0&lt;/Version&gt;\n    &lt;Description&gt;&lt;![CDATA[]]&gt;&lt;/Description&gt;\n    &lt;Rules version=\"17.10\"&gt;\n        &lt;RuleDefinitions&gt;\n            &lt;DataflowCleanseRule formatVersion=\"17.10\" language=\"dotnet\"&gt;\n                &lt;RuleID&gt;7C49FEDA-AA67-490D-8820-684F3BDD58B7&lt;/RuleID&gt;\n                &lt;FunctionIdentifier&gt;\n                    &lt;NamespaceName&gt;\n                        &lt;Pattern&gt;Our.Utilities.Database&lt;/Pattern&gt;\n                    &lt;/NamespaceName&gt;\n                    &lt;ClassName&gt;\n                        &lt;Pattern&gt;BaseDao&lt;/Pattern&gt;\n                    &lt;/ClassName&gt;\n                    &lt;FunctionName&gt;\n                        &lt;Pattern&gt;ReadSqlTemplate&lt;/Pattern&gt;\n                    &lt;/FunctionName&gt;\n                    &lt;ApplyTo implements=\"true\" overrides=\"true\" extends=\"true\"/&gt;\n                &lt;/FunctionIdentifier&gt;\n                &lt;OutArguments&gt;return&lt;/OutArguments&gt;\n            &lt;/DataflowCleanseRule&gt;\n            &lt;DataflowCleanseRule formatVersion=\"17.10\" language=\"dotnet\"&gt;\n                &lt;RuleID&gt;14C423ED-5A51-4BA1-BAE1-075E566BE58D&lt;/RuleID&gt;\n                &lt;TaintFlags&gt;+VALIDATED_SQL_INJECTION&lt;/TaintFlags&gt;\n                &lt;FunctionIdentifier&gt;\n                    &lt;NamespaceName&gt;\n                        &lt;Pattern&gt;Our.Utilities.Database&lt;/Pattern&gt;\n                    &lt;/NamespaceName&gt;\n                    &lt;ClassName&gt;\n                        &lt;Pattern&gt;BaseDao&lt;/Pattern&gt;\n                    &lt;/ClassName&gt;\n                    &lt;FunctionName&gt;\n                        &lt;Pattern&gt;ReadSqlTemplate&lt;/Pattern&gt;\n                    &lt;/FunctionName&gt;\n                    &lt;ApplyTo implements=\"true\" overrides=\"true\" extends=\"true\"/&gt;\n                &lt;/FunctionIdentifier&gt;\n                &lt;OutArguments&gt;return&lt;/OutArguments&gt;\n            &lt;/DataflowCleanseRule&gt;\n        &lt;/RuleDefinitions&gt;\n    &lt;/Rules&gt;\n&lt;/RulePack&gt;\n</code></pre>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 1, "creation_date": 1507757345, "post_id": 46697806, "comment_id": 80343394, "body": "I&#39;m having a very hard time understanding what you are trying to ask.  I would suggest adding some code examples.  I was not the downvoter though"}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1507757833, "post_id": 46697806, "comment_id": 80343612, "body": "I am still pretty lost."}, {"owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1507757920, "post_id": 46697806, "comment_id": 80343651, "body": "@maccettura if I create a method <code>protected virtual</code> I guarantee that only child implementations can use the method as <code>protected</code>. I can&#39;t have a child implementation override it as <code>public</code>. Is the approach above the only way of doing this?"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1507767697, "post_id": 46697806, "comment_id": 80346338, "body": "@DiskJunky - I&#39;m really lost too. Any methods declared as <code>protected abstract</code> or <code>protected virtual</code> can only ever be overridden in a child class as <code>protected override</code> - this can&#39;t change. And the method can only ever be called by the class or the children anyway. Are you getting confused with the <code>new</code> (shadowing, not constructor) keyword?"}], "answers": [{"comments": [{"owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507759957, "post_id": 46698327, "comment_id": 80344355, "body": "The scope of implementations of an interface are left up to the implementer and are not <code>public</code> unless the implementer declares so (as far as I&#39;m aware). This doesn&#39;t answer my question though: is there another way of limiting scope in a child implementation?"}, {"owner": {"reputation": 655, "user_id": 18323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556194fe4f85b7cfd762402c0f8d1bc6?s=128&d=identicon&r=PG", "display_name": "Rupert Morrish", "link": "https://stackoverflow.com/users/18323/rupert-morrish"}, "reply_to_user": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 1, "creation_date": 1507760118, "post_id": 46698327, "comment_id": 80344397, "body": "&quot;To implement an interface member, the corresponding member of the implementing class must be public, non-static, and have the same name and signature as the interface member.&quot; <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/interfaces/\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/csharp/programming-guide/&hellip;</a>"}, {"owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507760181, "post_id": 46698327, "comment_id": 80344407, "body": "I stand corrected. This does answer that an interface is not the way to go"}, {"owner": {"reputation": 655, "user_id": 18323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556194fe4f85b7cfd762402c0f8d1bc6?s=128&d=identicon&r=PG", "display_name": "Rupert Morrish", "link": "https://stackoverflow.com/users/18323/rupert-morrish"}, "reply_to_user": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507760210, "post_id": 46698327, "comment_id": 80344423, "body": "Your question does not make sense the way you&#39;re asking it. It is not possible to change the visibility of a method by overriding it."}, {"owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507760871, "post_id": 46698327, "comment_id": 80344625, "body": "That&#39;s the crux of my question - is it impossible given the current C# spec? Or is there a workaround?"}, {"owner": {"reputation": 655, "user_id": 18323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556194fe4f85b7cfd762402c0f8d1bc6?s=128&d=identicon&r=PG", "display_name": "Rupert Morrish", "link": "https://stackoverflow.com/users/18323/rupert-morrish"}, "reply_to_user": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 1, "creation_date": 1507761086, "post_id": 46698327, "comment_id": 80344694, "body": "It&#39;s not just possible, it&#39;s mandatory. I don&#39;t know why you don&#39;t want to use <code>protected virtual</code>, but there is no overriding of methods without <code>virtual</code>, and if you want <code>protected</code> then you should use <code>protected</code>."}, {"owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507761551, "post_id": 46698327, "comment_id": 80344823, "body": "Well given the example of <code>Object.Finalize()</code>, you&#39;d create <code>protected virtual</code> to allow implementations of any object to clean themselves up and tie it into the GC. <code>Object</code> itself doesn&#39;t care as there isn&#39;t anything to clean and an interface isn&#39;t the way to go as an object may or may not implement it. By specifying <code>Object.Finalize()</code>, you give a way of any child implementations to clean up what they need as and when they&#39;re needed. My curiousity was as to whether there was another approach possible given the language spec"}, {"owner": {"reputation": 655, "user_id": 18323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556194fe4f85b7cfd762402c0f8d1bc6?s=128&d=identicon&r=PG", "display_name": "Rupert Morrish", "link": "https://stackoverflow.com/users/18323/rupert-morrish"}, "reply_to_user": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507762677, "post_id": 46698327, "comment_id": 80345146, "body": "&quot;an interface isn&#39;t the way to go as an object may or may not implement it&quot; You have this completely the wrong way round. A concrete class that declares an interface must implement it, or it will not compile. There&#39;s no such requirement that a child class override a virtual method in the parent.  All this is orthogonal to whether the visibility is public or protected."}], "tags": [], "owner": {"reputation": 655, "user_id": 18323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/556194fe4f85b7cfd762402c0f8d1bc6?s=128&d=identicon&r=PG", "display_name": "Rupert Morrish", "link": "https://stackoverflow.com/users/18323/rupert-morrish"}, "is_accepted": true, "score": 3, "last_activity_date": 1507759790, "creation_date": 1507759790, "answer_id": 46698327, "question_id": 46697806, "link": "https://stackoverflow.com/questions/46697806/limit-scope-of-method-for-child-implementations/46698327#46698327", "title": "Limit scope of method for child implementations", "body": "<p>I think you're misunderstanding the meaning and use of <code>virtual</code>. You can <em>only</em> override a method in the parent class if it is declared virtual. The override method in the child class must have the same visibility as the method in the parent class.</p>\n\n<p>Implementations of methods declared in interfaces are always <code>public</code>.</p>\n\n<p>Declaring a method <code>abstract</code> has the same effect as declaring it <code>virtual</code>, except you do not implement it in your class and any concrete classes that derive from your class must implement it.</p>\n"}, {"comments": [{"owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507800176, "post_id": 46699442, "comment_id": 80358495, "body": "My question wasn&#39;t around <code>protected</code> / <code>public</code> but more around giving a child class a way of implementing functionality. That said, any confusion as to <code>public</code> / <code>protected</code> is more down to bad phrasing of my question and for that, apologies. Your points are good ones and well stated, just not what I was driving at."}], "tags": [], "owner": {"reputation": 1030, "user_id": 6204167, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209872751922417/picture?type=large", "display_name": "Kyle Burns", "link": "https://stackoverflow.com/users/6204167/kyle-burns"}, "is_accepted": false, "score": 2, "last_activity_date": 1507771425, "last_edit_date": 1507771425, "creation_date": 1507767308, "answer_id": 46699442, "question_id": 46697806, "link": "https://stackoverflow.com/questions/46697806/limit-scope-of-method-for-child-implementations/46699442#46699442", "title": "Limit scope of method for child implementations", "body": "<p>Technically, the compiler will not allow you to change the access modifiers of a method when overriding it from the parent, so the answer to the question is that by declaring a method as protected within a class, you are only making it available to derived classes (whether abstract or not is a separate concern and doesn't bear on the access level).</p>\n\n<p>Keep in mind, however, that derived class would be free to expose the function in some other way such as calling the protected method from a public one and there is no way to prevent that.</p>\n\n<p>As far as \"why\" you would have a protected abstract member, a great example can be seen in many implementations of the Template Method pattern.  You may have an abstract base class that describes the structure of an algorithm and leave the specific steps of what happens inside the boundary of each step to derived classes.  In this case, one way to implement would be to declare the base class as abstract, have a public method serve as the \"entry point\" for the algorithm, and define specific methods used within the algorithm as protected abstract methods to lay out what the responsibility of derived classes will be.  This pattern does a nice job of leaving public only those things that are intended to be consumed by the world, but can present some challenges from a unit testing perspective which are sometimes addressed by raising the visibility of the helper methods from protected to internal.</p>\n"}, {"comments": [{"owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "edited": false, "score": 0, "creation_date": 1507799915, "post_id": 46699566, "comment_id": 80358323, "body": "The question wasn&#39;t around trying to limit access (though your answer is thorough on that), it was around if there was another way to give a child implementation the option of implementing functionality via a mechanism other than <code>abstract</code>, <code>interface</code> or <code>protected virtual</code>. Based on the answers so far, that&#39;s a &quot;no&quot;. I appreciate the reasons for the question are esoteric but it centers around why <code>Finalize</code> was implemented as it is."}], "tags": [], "owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "is_accepted": false, "score": 1, "last_activity_date": 1507798572, "last_edit_date": 1507798572, "creation_date": 1507768152, "answer_id": 46699566, "question_id": 46697806, "link": "https://stackoverflow.com/questions/46697806/limit-scope-of-method-for-child-implementations/46699566#46699566", "title": "Limit scope of method for child implementations", "body": "<p>You cannot use the c# language to prevent a derived class from implementing a public version of <code>OnlyMeOrChildrenCanDoAction</code>. Even if you mark it as <code>protected  virtual</code>, the derived class can use the <code>new</code> keyword to cover the method and change its accessibility. For example:</p>\n\n<pre><code>public class BaseClass\n{\n     protected virtual void OnlyMeOrChildrenCanDoAction()\n     {\n         // leave empty as current class is structural/conceptual\n         // but child instances may need it\n     }\n}\n\npublic class DerivedClass : BaseClass\n{\n    public new void OnlyMeOrChildrenCanDoAction()\n    {\n        Console.WriteLine(\"This is public.\");\n    }\n}\n\npublic class Program\n{\n    public static void Main()\n    {\n        var b = new BaseClass();\n        //b.OnlyMeOrChildrenCanDoAction(); //Will not compile\n\n        var d = new DerivedClass();\n        d.OnlyMeOrChildrenCanDoAction();  //Look! It's public!\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>This is public.\n</code></pre>\n\n<p>Code available on <a href=\"https://dotnetfiddle.net/BOXFTh\" rel=\"nofollow noreferrer\">DotNetFiddle</a>.</p>\n\n<p>If you want to protect the caller from calling <code>OnlyMeOrChildrenCanDoAction</code>, your best bet is for the caller to use only interfaces. If <code>OnlyMeOrChildrenCanDoAction</code> isn't in the interface, there is no way a caller could call it, even if a derived class decided to expose it as a public class member. This is good SOLID design anyway.</p>\n\n<p>On the other hand, if you're not so much worried about the caller as you are worried about your own development team doing bad things, perhaps your best option is to use <a href=\"https://en.wikipedia.org/wiki/FxCop\" rel=\"nofollow noreferrer\">FxCop</a> or some other source code rules engine integrated into your continuous build process. Developers could still add the method but you could set up a rule to cause it to fail the build if they do so. </p>\n"}], "owner": {"reputation": 4300, "user_id": 1838819, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/c8610c6d584b1ea73a92ae7a8f394dcd?s=128&d=identicon&r=PG", "display_name": "DiskJunky", "link": "https://stackoverflow.com/users/1838819/diskjunky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 46698327, "answer_count": 3, "score": 0, "last_activity_date": 1507798572, "creation_date": 1507757114, "last_edit_date": 1507759599, "question_id": 46697806, "link": "https://stackoverflow.com/questions/46697806/limit-scope-of-method-for-child-implementations", "title": "Limit scope of method for child implementations", "body": "<p>I hope this isn't a duplicate but I can't find one via Google or SO search. If I want to force the accessibility for a method's implementation of an overridden method to be <code>protected</code>, is my only option to either create as <code>abstract</code> or <code>protected virtual</code>? I know that interfaces specify the declaration but leave the accessibility/scope to the class implementation but I'd like to be sure.</p>\n\n<p>I'd like to know/be certain of if the only way to limit the scope of a method is via a <code>abstract</code> \\ <code>protected virtual</code> to give semantics of \"this applies to the class implementation or the child override implementation\".</p>\n\n<p>A code sample to illustrate. I know I can do the following and limit the scope of an implementation like so;</p>\n\n<pre><code>public class BaseClass\n{\n     protected virtual void OnlyMeOrChildrenCanDoAction()\n     {\n         // leave empty as current class is structural/conceptual\n         // but child instances may need it\n     }\n}\n</code></pre>\n\n<p>By doing the above I guarantee that child implementations can only <code>override</code> <code>OnlyMeorChildrenCanDoAction()</code>as <code>protected</code> but not <code>public</code>.</p>\n\n<p>But is there another way of limiting to <code>protected</code> without resorting to <code>abstract</code> or <code>protected virtual</code>? An example of creating a method like this is <code>Object.Finalize()</code> as seen <a href=\"https://msdn.microsoft.com/en-us/library/system.object.finalize(v=vs.110).aspx\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>Or, to invert the question somewhat, why would you create a method as <code>protected virtual</code> unless to ensure that any implementations were limited in scope? Or is there another way to do the same?</p>\n"}, {"tags": ["c#", "html", "asp.net-mvc", "pdf", "selectpdf"], "comments": [{"owner": {"reputation": 4601, "user_id": 4031953, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/633d039b26a8ed672ce3432ada8a9645?s=128&d=identicon&r=PG", "display_name": "Robert Wade", "link": "https://stackoverflow.com/users/4031953/robert-wade"}, "edited": false, "score": 1, "creation_date": 1507757540, "post_id": 46697804, "comment_id": 80343481, "body": "First thing I&#39;d do would be to remove the two style sheets from the source and run it again.  See if it actually includes the missing objects.  If it does you&#39;ve narrowed it down to a CSS issue.  Go from there."}, {"owner": {"reputation": 10598, "user_id": 1179077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CyVen.jpg?s=128&g=1", "display_name": "zgood", "link": "https://stackoverflow.com/users/1179077/zgood"}, "edited": false, "score": 1, "creation_date": 1507757698, "post_id": 46697804, "comment_id": 80343557, "body": "That HTML string is invalid btw. It has a <code>&lt;head&gt;</code> and <code>&lt;body&gt;</code> tags nested instead a <code>&lt;form&gt;</code> with what looks like some validation errors. Maybe you should look into that. Also, make sure you are linking the correct stylesheets"}], "answers": [{"tags": [], "owner": {"reputation": 235, "user_id": 7168144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a93d93a774421661022260bab5241eb?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/7168144/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1507802006, "creation_date": 1507802006, "answer_id": 46706573, "question_id": 46697804, "link": "https://stackoverflow.com/questions/46697804/selectpdf-missing-content-after-conversion/46706573#46706573", "title": "SelectPDF missing content after conversion", "body": "<p>It seems that the html/css engine used to render the page does not support vh, vw for font sizes. It's a common issue with all converters, so probably you should try to change this if you need the page converted to pdf.</p>\n\n<p>Later update: it seems that there is support for vw, but not for vh. That's why the \"each\" words appear. They use vw in css.</p>\n"}], "owner": {"reputation": 649, "user_id": 6718764, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/dYZcF.jpg?s=128&g=1", "display_name": "Tiaan", "link": "https://stackoverflow.com/users/6718764/tiaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1072, "favorite_count": 0, "accepted_answer_id": 46706573, "answer_count": 1, "score": 0, "last_activity_date": 1507802006, "creation_date": 1507757100, "question_id": 46697804, "link": "https://stackoverflow.com/questions/46697804/selectpdf-missing-content-after-conversion", "title": "SelectPDF missing content after conversion", "body": "<p>So I am using SelectPDF to convert an MVC view's html to PDF, but for some reason, a great deal of the content is missing from the PDF.</p>\n\n<p>I have tested the program on other sites I have made in MVC and they work...</p>\n\n<p>So as per the readme doc's recommendation, I use this code to produce a </p>\n\n<pre><code>SelectPdf.HtmlToPdf converter = new SelectPdf.HtmlToPdf();\nSelectPdf.PdfDocument doc = converter.ConvertUrl(HTMLPath);\n//SelectPdf.PdfDocument doc = converter.ConvertHtmlString(ViewHTML);\n\ndoc.Save(PDFSavePath);\ndoc.Close();\n</code></pre>\n\n<p>So <code>HTMLSave</code> path is the location of the HTML file created from the rendered MVC view. While <code>ViewHTML</code> contains the HTML in the form of a string.</p>\n\n<p>So this is how the HTML looks (the file and the view look identical, I did double check in case the HTML was captured incorrectly):</p>\n\n<p><a href=\"https://i.stack.imgur.com/py2dS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/py2dS.png\" alt=\"HTML\"></a></p>\n\n<p>But this is how the PDF looks:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3Cv3i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Cv3i.png\" alt=\"PDF\"></a>\nAbsolutely tragic...</p>\n\n<p>Not sure if it will be helpful, but here's the HTML:</p>\n\n<p><a href=\"https://drive.google.com/open?id=0B8DiACLG11oYd3p5Tzc2ZlJQLVk\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=0B8DiACLG11oYd3p5Tzc2ZlJQLVk</a></p>\n\n<p>Unfortunately, all the HTML is on one line thanks to the MVC View to HTML</p>\n"}, {"tags": ["c#", "selenium", "selenium-chromedriver"], "comments": [{"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1507762704, "post_id": 46697568, "comment_id": 80345151, "body": "I don&#39;t remember what the current version is supposed to be ... have you updated Selenium, Chrome, and Chrome drivers to all the latest and greatest?"}, {"owner": {"reputation": 133, "user_id": 6167573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f71a29dda15e88750d7dc759e45fac?s=128&d=identicon&r=PG&f=1", "display_name": "Clarkie235", "link": "https://stackoverflow.com/users/6167573/clarkie235"}, "reply_to_user": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1507764138, "post_id": 46697568, "comment_id": 80345513, "body": "So all my chrome (v61), chromedriver (v2.33) and Selenium (v3.6.0) are up to date."}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1507765091, "post_id": 46697568, "comment_id": 80345712, "body": "Hmm.. it&#39;s possible with all the recent updates that it got broken. You might post a bug on the Selenium site for the Chromedriver and see what they say."}], "owner": {"reputation": 133, "user_id": 6167573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f71a29dda15e88750d7dc759e45fac?s=128&d=identicon&r=PG&f=1", "display_name": "Clarkie235", "link": "https://stackoverflow.com/users/6167573/clarkie235"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1569097121, "creation_date": 1507755999, "question_id": 46697568, "link": "https://stackoverflow.com/questions/46697568/selenium-webdriver-v3-6-0-not-accepting-chromedriver-arguments-c", "title": "Selenium Webdriver v3.6.0 Not accepting chromedriver arguments - C#", "body": "<p>I have recently updated my Selenium Webdriver to v3.6.0 and now none of my arguments for my chromedriver are working. If I was to roll back to Selenium Webdriver v3.5.0 the given arguments would once again work.</p>\n\n<p>This is my code:</p>\n\n<pre><code>ChromeOptions options = new ChromeOptions();\noptions.AddArgument(@\"--C:\\Users\\user_name\\AppData\\Local\\Google\\Chrome\\User Data\");\noptions.AddArgument(\"--incognito\");\nIWebDriver driver = new ChromeDriver(@\"C:\\Selenium\", options);\n</code></pre>\n\n<p>I have tried to find a solution to this but have had no luck.</p>\n\n<p>My chromedriver version: 2.33</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "nosql", "litedb"], "comments": [{"owner": {"reputation": 31, "user_id": 8748133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f912dc6373ebf9fb6d19d0fa6032d7?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/8748133/just-me"}, "reply_to_user": {"reputation": 37744, "user_id": 578411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qj33e.png?s=128&g=1", "display_name": "rene", "link": "https://stackoverflow.com/users/578411/rene"}, "edited": false, "score": 2, "creation_date": 1507756299, "post_id": 46697553, "comment_id": 80342968, "body": "It is not a duplication of &quot;What is a NullReferenceException&quot;. Null reference is in LiteDb code."}, {"owner": {"reputation": 31, "user_id": 8748133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f912dc6373ebf9fb6d19d0fa6032d7?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/8748133/just-me"}, "reply_to_user": {"reputation": 37744, "user_id": 578411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qj33e.png?s=128&g=1", "display_name": "rene", "link": "https://stackoverflow.com/users/578411/rene"}, "edited": false, "score": 0, "creation_date": 1507756634, "post_id": 46697553, "comment_id": 80343094, "body": "@rene. No. There are no &quot;Writers&quot; collection in my Db. I tried with empty database. Result is the same."}, {"owner": {"reputation": 31, "user_id": 8748133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f912dc6373ebf9fb6d19d0fa6032d7?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/8748133/just-me"}, "reply_to_user": {"reputation": 37744, "user_id": 578411, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qj33e.png?s=128&g=1", "display_name": "rene", "link": "https://stackoverflow.com/users/578411/rene"}, "edited": false, "score": 1, "creation_date": 1507756892, "post_id": 46697553, "comment_id": 80343195, "body": "@rene. It works with the Writer class. It does not work with the string."}, {"owner": {"reputation": 1771, "user_id": 8365439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v76vl.jpg?s=128&g=1", "display_name": "Valerii", "link": "https://stackoverflow.com/users/8365439/valerii"}, "edited": false, "score": 1, "creation_date": 1507758988, "post_id": 46697553, "comment_id": 80344058, "body": "Maybe it&#39;s because strings are immutable in C#. There are only 2 options: you can try look through the code of BsonMapper or ask LiteDb developers."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8748133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f912dc6373ebf9fb6d19d0fa6032d7?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/8748133/just-me"}, "edited": false, "score": 2, "creation_date": 1507824127, "post_id": 46710047, "comment_id": 80374552, "body": "Thanks you. I think LiteDb should return more meaningful exception in this case ;("}], "tags": [], "owner": {"reputation": 976, "user_id": 3286260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de1c780045182b2fa9499260694fd334?s=128&d=identicon&r=PG", "display_name": "mbdavid", "link": "https://stackoverflow.com/users/3286260/mbdavid"}, "is_accepted": true, "score": 3, "last_activity_date": 1507812545, "creation_date": 1507812545, "answer_id": 46710047, "question_id": 46697553, "link": "https://stackoverflow.com/questions/46697553/impossible-to-save-collection-of-strings-to-litedb/46710047#46710047", "title": "Impossible to save collection of strings to LiteDb", "body": "<p>LiteDB is a \"Document Store\" database, so you can only store documents. You can't store inside a collection any primitive data type or array.</p>\n\n<p>Document structure is required because each document must contains an unique <code>_id</code> value field. If you do not provide (like in your example), LiteDB will auto create this Id field using <code>ObjectId</code>.</p>\n\n<p>If you want avoid create this class, you can use <code>BsonDocument</code> to be more simple to use.</p>\n\n<pre><code>using (var db = new LiteDatabase(@\"MyData.db\"))\n{\n    var col = db.GetCollection(\"Writers\");\n    col.Insert(new BsonDocument { [\"Name\"] = \"Mark Twain\" });\n    col.Insert(new BsonDocument { [\"Name\"] = \"Jack London\" });\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8748133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f912dc6373ebf9fb6d19d0fa6032d7?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/8748133/just-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2356, "favorite_count": 1, "accepted_answer_id": 46710047, "answer_count": 1, "score": 0, "last_activity_date": 1507812545, "creation_date": 1507755937, "last_edit_date": 1507756373, "question_id": 46697553, "link": "https://stackoverflow.com/questions/46697553/impossible-to-save-collection-of-strings-to-litedb", "title": "Impossible to save collection of strings to LiteDb", "body": "<p>I am trying to save collection of the strings to LiteDb</p>\n\n<pre><code>using (var db = new LiteDatabase(@\"MyData.db\"))\n{\n    var col = db.GetCollection&lt;string&gt;(\"Writers\");\n    col.Insert(\"Mark Twain\");\n    col.Insert(\"Jack London\");\n }\n</code></pre>\n\n<p>It throws \"Object reference not set to an instance of an object.\" at LiteDB.BsonMapper.ToDocument[T](T entity) on Insert.</p>\n\n<p>Code like this works:</p>\n\n<pre><code>public class Writer\n{\n    public string Name { get; set; }\n}\n\nusing (var db = new LiteDatabase(@\"MyData.db\"))\n{\n    var col = db.GetCollection&lt;Writer&gt;(\"Writers\");\n    col.Insert(new Writer { Name = \"Mark Twain\" });\n    col.Insert(new Writer { Name = \"Jack London\" });\n}\n</code></pre>\n\n<p>Why? What's wrong with the string?</p>\n"}, {"tags": ["c#", "plugins", "dynamics-crm", "geocoding", "bing-api"], "comments": [{"owner": {"reputation": 504, "user_id": 1081871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb8453e66cf9700c642087a2118de50?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/1081871/jeffrey"}, "edited": false, "score": 0, "creation_date": 1507761321, "post_id": 46697510, "comment_id": 80344755, "body": "Are you concerned with the URL encoding of the hash or the fact that bing maps doesn&#39;t appropriately handle addresses with a hash in them?"}], "answers": [{"tags": [], "owner": {"reputation": 12410, "user_id": 5217142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57daeb5f96b7a591e3447d41e59bbc94?s=128&d=identicon&r=PG&f=1", "display_name": "traktor", "link": "https://stackoverflow.com/users/5217142/traktor"}, "is_accepted": false, "score": 1, "last_activity_date": 1507759892, "creation_date": 1507759892, "answer_id": 46698347, "question_id": 46697510, "link": "https://stackoverflow.com/questions/46697510/bing-maps-api-problems-geocoding-addresses-with/46698347#46698347", "title": "Bing Maps api Problems geocoding addresses with &quot;#&quot;", "body": "<p>You can use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent\" rel=\"nofollow noreferrer\">encodeURIComponent</a> to escape the <code>#</code> character to <code>%23</code>, which then prevents it from starting a hash component of the URI. As an untested example:</p>\n\n<pre><code>stringUrl = \"https://dev.virtualearth.net/REST/v1/Locations?query=\" + \n             encodeURIComponent( strAddress) + \"&amp;key=\" +\n             encodeURIComponent( key);\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 1526522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2812651d781df59886fba53a3d817455?s=128&d=identicon&r=PG", "display_name": "Kantamneni Janaki Devi", "link": "https://stackoverflow.com/users/1526522/kantamneni-janaki-devi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508359632, "creation_date": 1507755772, "last_edit_date": 1508359632, "question_id": 46697510, "link": "https://stackoverflow.com/questions/46697510/bing-maps-api-problems-geocoding-addresses-with", "title": "Bing Maps api Problems geocoding addresses with &quot;#&quot;", "body": "<p>With Bing Maps API, is it possible to geocode the addresses with \"#\" </p>\n\n<p>Example -\nThis geocodes OK with Address:</p>\n\n<blockquote>\n  <p>1600 Amphitheatre Pkwy APT 23, Mountain View, CA 94043, USA</p>\n</blockquote>\n\n<p>But if I replace the Apt with #,\n1600 Amphitheatre Pkwy #23, Mountain View, CA 94043, USA\n the result is an error.</p>\n\n<p>This is my url:</p>\n\n<pre><code>var strAddress ;\n\nstring url = \"https://dev.virtualearth.net/REST/v1/Locations?query=\" + \nstrAddress + \"&amp;key=\" + key;\n</code></pre>\n\n<p>I tried using \nencodeUriComponent,\n System.Web.HttpUtility.UrlEncode,\nUri.EscapeUriString,</p>\n\n<p>Like this \nstring url = \"<a href=\"https://dev.virtualearth.net/REST/v1/Locations?query=\" rel=\"nofollow noreferrer\">https://dev.virtualearth.net/REST/v1/Locations?query=</a>\" + \n    System.Web.HttpUtility.UrlEncode(strAddress) + \"&amp;key=\" + key;</p>\n\n<p>none of them worked for me!</p>\n\n<p>Basically we are do geocoding in  <strong>Plugin</strong> but not javascript.<br>\nCould anyone please help me?\nThanks in Advance. </p>\n"}, {"tags": ["c#", "garbage-collection"], "comments": [{"owner": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507758908, "post_id": 46697379, "comment_id": 80344024, "body": "Whoever down voted this thread should give an explanation. This is not an easy search-and-get-answer kind of question."}], "answers": [{"comments": [{"owner": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507757625, "post_id": 46697674, "comment_id": 80343521, "body": "I forget the finalizer method. How do I find out who answer the fininalizer first between you and @Konrad Kokosa?"}, {"owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "reply_to_user": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507757790, "post_id": 46697674, "comment_id": 80343597, "body": "What do you mean?"}, {"owner": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507757818, "post_id": 46697674, "comment_id": 80343605, "body": "Thank you for your answer, but I think I pick @Konrad  as both code and explanation are provided."}, {"owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "reply_to_user": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507758016, "post_id": 46697674, "comment_id": 80343697, "body": "Oh you mean for accepting the answer. You can accept what you want, but Finalizer and Finalize-Method are not really the same. Especially when a class doesn&#39;t implement IDisposable."}], "tags": [], "owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "is_accepted": false, "score": 1, "last_activity_date": 1507756506, "creation_date": 1507756506, "answer_id": 46697674, "question_id": 46697379, "link": "https://stackoverflow.com/questions/46697379/native-resource-cleanup-and-not-calling-dispose/46697674#46697674", "title": "Native resource cleanup and Not calling Dispose", "body": "<p>The garbageCollector is cleaning up unreferenced Objects, when it gets resources of the OS, but if you have a highly frequented Application it might be useful not to have to wait for it, because otherwise your memory gets filled up. Then the usage of Dispose is quite necessary.</p>\n\n<p>Update:\nThe objects do not even need to implement IDisposable to be cleaned up, because it's the Finalize-Method that is called.</p>\n"}, {"comments": [{"owner": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507757633, "post_id": 46697696, "comment_id": 80343522, "body": "I forget the finalizer method. How do I find out who answer the fininalizer first between @Nikolaus and you?"}, {"owner": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507757775, "post_id": 46697696, "comment_id": 80343589, "body": "I think I pick you as both code and explanation are provided."}, {"owner": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "edited": false, "score": 0, "creation_date": 1507758216, "post_id": 46697696, "comment_id": 80343765, "body": "UpVote for the link"}], "tags": [], "owner": {"reputation": 15750, "user_id": 2894974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/L31Cn.jpg?s=128&g=1", "display_name": "Konrad Kokosa", "link": "https://stackoverflow.com/users/2894974/konrad-kokosa"}, "is_accepted": true, "score": 1, "last_activity_date": 1507791891, "last_edit_date": 1507791891, "creation_date": 1507756605, "answer_id": 46697696, "question_id": 46697379, "link": "https://stackoverflow.com/questions/46697379/native-resource-cleanup-and-not-calling-dispose/46697696#46697696", "title": "Native resource cleanup and Not calling Dispose", "body": "<p><code>FileStream</code> contains <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.object.finalize?view=netframework-4.7\" rel=\"nofollow noreferrer\">Finalize method</a> which calls <code>Dispose</code> inside:</p>\n\n<pre><code>~FileStream()\n{\n    if (_handle != null) {\n        BCLDebug.Correctness(_handle.IsClosed, \"You didn't close a FileStream &amp; it got finalized.  Name: \\\"\"+_fileName+\"\\\"\");\n        Dispose(false);\n    }\n}\n</code></pre>\n\n<p>Which means it will be eventually called by Finalizer when the object will not be longer reachable. Of course, it is good to call <code>Dispose</code> explictly as it let's you control cleanup deterministicaly as you've mentioned.</p>\n"}], "owner": {"reputation": 6374, "user_id": 665335, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f55f2a5ab31b088c1fea75647d5e7d89?s=128&d=identicon&r=PG", "display_name": "Pingpong", "link": "https://stackoverflow.com/users/665335/pingpong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 46697696, "answer_count": 2, "score": -1, "last_activity_date": 1507791891, "creation_date": 1507755241, "question_id": 46697379, "link": "https://stackoverflow.com/questions/46697379/native-resource-cleanup-and-not-calling-dispose", "title": "Native resource cleanup and Not calling Dispose", "body": "<p>Can anyone explain why not calling Dispose() explicitly, and native resource still gets cleaned up. Does it get called implicitly?</p>\n\n<p>I came cross below</p>\n\n<blockquote>\n  <p>calling Dispose is not required to guarantee native resource cleanup.\n  Native  resource cleanup will always happen eventually; calling\n  Dispose lets you control when that cleanup  happens.</p>\n</blockquote>\n\n<pre><code>  // Create the bytes to write to the temporary file.  \n  Byte[] bytesToWrite = new Byte[] { 1, 2, 3, 4, 5 };  \n\n  // Create the temporary file.  \n  FileStream fs = new FileStream(\"Temp.dat\", FileMode.Create);  \n\n  // Write the bytes to the temporary file.  \n  fs.Write(bytesToWrite, 0, bytesToWrite.Length);  \n\n  // Explicitly close the file when finished writing to it.  \n  //fs.Dispose();\n</code></pre>\n\n<p>Dispose should be called explicitly in code within finally block or via using statement.</p>\n"}, {"tags": ["c#", "unity5"], "comments": [{"owner": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507754321, "post_id": 46697082, "comment_id": 80342025, "body": "Are you making a new class <code>move</code> every time before you call <code>move:Update()</code> by any chance? You could try making <code>loop</code> static or reusing your <code>move</code> class?"}, {"owner": {"reputation": 21, "user_id": 6618355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b43477b01138bd9e4d1a76b561dcc3?s=128&d=identicon&r=PG&f=1", "display_name": "frajo mathews", "link": "https://stackoverflow.com/users/6618355/frajo-mathews"}, "reply_to_user": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507755049, "post_id": 46697082, "comment_id": 80342401, "body": "Thankyou for your reply.I tried making loop static.But things remains same."}, {"owner": {"reputation": 10997, "user_id": 75852, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fe6c5931802371700bddfa845f8a4d86?s=128&d=identicon&r=PG", "display_name": "squillman", "link": "https://stackoverflow.com/users/75852/squillman"}, "edited": false, "score": 0, "creation_date": 1507755495, "post_id": 46697082, "comment_id": 80342592, "body": "Post the code that creates an instance of <code>move</code> and call&#39;s <code>Update()</code>"}, {"owner": {"reputation": 957, "user_id": 6219084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbUSA.png?s=128&g=1", "display_name": "yes", "link": "https://stackoverflow.com/users/6219084/yes"}, "edited": false, "score": 0, "creation_date": 1507756092, "post_id": 46697082, "comment_id": 80342878, "body": "are you sure this is the code you use? because i can tell for sure <code>Destrou</code> is no function of MonoBehaviour. But aside of that, ofc the value only get incremented once if you destroy the gameobject holding the script right after you print it out."}, {"owner": {"reputation": 21, "user_id": 6618355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b43477b01138bd9e4d1a76b561dcc3?s=128&d=identicon&r=PG&f=1", "display_name": "frajo mathews", "link": "https://stackoverflow.com/users/6618355/frajo-mathews"}, "edited": false, "score": 0, "creation_date": 1507840789, "post_id": 46697082, "comment_id": 80383362, "body": "Thankyou for your concern.I meant Destroy().Sorry for that..&#39;Post the code that creates an instance of move and call&#39;s Update()&#39;Can you explain the.I am a begginer in programing."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6618355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b43477b01138bd9e4d1a76b561dcc3?s=128&d=identicon&r=PG&f=1", "display_name": "frajo mathews", "link": "https://stackoverflow.com/users/6618355/frajo-mathews"}, "edited": false, "score": 0, "creation_date": 1507840960, "post_id": 46704721, "comment_id": 80383461, "body": "It was a typing mistake.I meant Destroy().Sorry for that.Actually i want to increment loop to 9 and then make loop=0 and increment to 9 and  repeat."}, {"owner": {"reputation": 69, "user_id": 8440308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nvRpr.png?s=128&g=1", "display_name": "DavEat", "link": "https://stackoverflow.com/users/8440308/daveat"}, "reply_to_user": {"reputation": 21, "user_id": 6618355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b43477b01138bd9e4d1a76b561dcc3?s=128&d=identicon&r=PG&f=1", "display_name": "frajo mathews", "link": "https://stackoverflow.com/users/6618355/frajo-mathews"}, "edited": false, "score": 0, "creation_date": 1507908337, "post_id": 46704721, "comment_id": 80412917, "body": "<code>loop++;     if (loop &gt; 9)  loop = 0;</code>          and like I said in the point 3 you need to put that in an other script"}], "tags": [], "owner": {"reputation": 69, "user_id": 8440308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nvRpr.png?s=128&g=1", "display_name": "DavEat", "link": "https://stackoverflow.com/users/8440308/daveat"}, "is_accepted": false, "score": 0, "last_activity_date": 1507796362, "creation_date": 1507796362, "answer_id": 46704721, "question_id": 46697082, "link": "https://stackoverflow.com/questions/46697082/variable-not-incrementing-in-void-update/46704721#46704721", "title": "Variable not incrementing in void update", "body": "<ol>\n<li><p>Your gameobject with the move component is well under '-2' in the world pos ?\n(see -> <code>if(transform.position.y &lt; -2)</code>) or the loop can be increment.</p></li>\n<li><p>As \"yes\" say in his comment, what is <code>Destrou</code> ? <br>You want to use <code>Destroy</code> ? In this case why use loop, to count the all the destroy element ?<br>So loop was increased and the object destroyed just after.</p></li>\n<li><p>If <code>loop</code> is to count the number of element you must place the loop variable in an other script who cant be destroyed (for example : you can use <a href=\"https://gamedev.stackexchange.com/questions/116009/in-unity-how-do-i-correctly-implement-the-singleton-pattern\"><code>Singleton</code></a> to access to it properly)</p></li>\n</ol>\n"}], "owner": {"reputation": 21, "user_id": 6618355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6b43477b01138bd9e4d1a76b561dcc3?s=128&d=identicon&r=PG&f=1", "display_name": "frajo mathews", "link": "https://stackoverflow.com/users/6618355/frajo-mathews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1507839576, "creation_date": 1507754136, "last_edit_date": 1507839576, "question_id": 46697082, "link": "https://stackoverflow.com/questions/46697082/variable-not-incrementing-in-void-update", "title": "Variable not incrementing in void update", "body": "<p>In the code given below,the variable <code>loop</code> <strong>is not incremented</strong>.It gives the output as 0 always.If we print loop after incrementing the value,the loop increments once.</p>\n\n<pre><code>public class move : MonoBehaviour\n{\n    int loop = 0;\n    float[,] comp = new float[10,2];\n    public Vector3 speed;\n\n    void Start ()\n    {\n        speed = new Vector3(0,0.15f,0);\n    }\n\n    void Update ()\n    {\n        comp = spawner.score;\n        transform.Translate(speed);\n\n        if(transform.position.y &lt; -2)\n        {   \n            loop++;\n            Debug.Log(\"Loop:\"+loop);\n            Destroy(gameObject);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "c++-cli"], "comments": [{"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1507754234, "post_id": 46697031, "comment_id": 80341979, "body": "It should have worked using <code>^</code>.  It should also work using <code>^%</code> and using the <code>ref</code> keyword in C#.  Please show your attempt that failed."}, {"owner": {"reputation": 1, "user_id": 4740252, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BWEzMk08hPc/AAAAAAAAAAI/AAAAAAAABRU/VN9GyLSEw_0/photo.jpg?sz=128", "display_name": "Saeid Zarrinmehr", "link": "https://stackoverflow.com/users/4740252/saeid-zarrinmehr"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1507754619, "post_id": 46697031, "comment_id": 80342182, "body": "When using &#39;^&#39;  , &#39;^%&#39; or &#39;%^&#39; the cli compiler throws: left of &#39;.do_it&#39; must have class/struct/union."}, {"owner": {"reputation": 25655, "user_id": 480937, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/448470e105833cd4179b24314714360e?s=128&d=identicon&r=PG", "display_name": "David Yaw", "link": "https://stackoverflow.com/users/480937/david-yaw"}, "edited": false, "score": 1, "creation_date": 1507754722, "post_id": 46697031, "comment_id": 80342225, "body": "<code>^</code> is the managed equivalent of <code>*</code>. You need to use <code>-&gt;</code>, not <code>.</code>."}, {"owner": {"reputation": 1, "user_id": 4740252, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BWEzMk08hPc/AAAAAAAAAAI/AAAAAAAABRU/VN9GyLSEw_0/photo.jpg?sz=128", "display_name": "Saeid Zarrinmehr", "link": "https://stackoverflow.com/users/4740252/saeid-zarrinmehr"}, "edited": false, "score": 0, "creation_date": 1507755157, "post_id": 46697031, "comment_id": 80342442, "body": "Yes. You are right. Thanks. ^ and -&gt; solve the problem :)"}], "answers": [{"tags": [], "owner": {"reputation": 25655, "user_id": 480937, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/448470e105833cd4179b24314714360e?s=128&d=identicon&r=PG", "display_name": "David Yaw", "link": "https://stackoverflow.com/users/480937/david-yaw"}, "is_accepted": false, "score": 1, "last_activity_date": 1507755577, "creation_date": 1507755577, "answer_id": 46697474, "question_id": 46697031, "link": "https://stackoverflow.com/questions/46697031/method-is-not-supported-by-the-language/46697474#46697474", "title": "&quot;method&quot; is not supported by the language", "body": "<blockquote>\n  <p>\"not supported by the language\"</p>\n</blockquote>\n\n<p>I'm assuming that you're getting this error from C#, not from C++/CLI.</p>\n\n<pre><code>public ref class do_something\n\nvoid run(do_something% doer)\n</code></pre>\n\n<p>This combination is not supported by C#: A tracking reference to a value of a reference type. </p>\n\n<p>Since it's a reference type, <code>do_something</code> by itself in C# is equivalent to <code>do_something^</code> in C++/CLI. Declaring a method with a <code>ref do_something</code> parameter in C# makes it <code>do_something^%</code> in C++/CLI. For reference types, that's all that C# supports. </p>\n\n<p>C++/CLI does support using a ref class as a value: <code>do_something</code> by itself gives you stack semantics, and you can pass it using <code>do_something%</code> for a tracking reference, but neither of these is used in C#. </p>\n\n<p>The proper way to pass around a ref class is with <code>^</code>, and initialize variables with <code>gcnew</code>. This is the way that other .Net languages do it, so you need to follow their rules if you want to be callable from them. And as you noted in the comments, switching to <code>^</code> fixed your problem.</p>\n\n<hr>\n\n<p>Other notes:</p>\n\n<p>That's the C++ way to declaring an abstract class, which I wasn't even aware was still supported in C++/CLI. If you want to declare it in the managed way (which I would recommend), use the keyword <code>abstract</code> on the class and the method.</p>\n\n<pre><code>public ref class do_something abstract\n{\npublic:\n    virtual void do_it() abstract;\n};\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4740252, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BWEzMk08hPc/AAAAAAAAAAI/AAAAAAAABRU/VN9GyLSEw_0/photo.jpg?sz=128", "display_name": "Saeid Zarrinmehr", "link": "https://stackoverflow.com/users/4740252/saeid-zarrinmehr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507755577, "creation_date": 1507753892, "question_id": 46697031, "link": "https://stackoverflow.com/questions/46697031/method-is-not-supported-by-the-language", "title": "&quot;method&quot; is not supported by the language", "body": "<p>My solution in VS2010 has a CLI project which is referenced in a c# project. I have an abstract class in CLI named do_something. In C# I inherit DoSomething class from it. I want to run the c# implementation from c++ by passing the c# implementation as an abstract class argument but the \"not supported by the language\" exception is thrown.</p>\n\n<p>CLI/c++</p>\n\n<pre><code>//abstract class\npublic ref class do_something{\n  public:\n  virtual void do_it()=0;\n};\n//using an implementation of the abstract class\npublic ref class cpp_caller{\n  public:\n  void run(do_something% doer){\n    cout&lt;&lt;\"run c# from c++\"&lt;&lt;endl;\n    doer.do_it();\n  }\n};\n</code></pre>\n\n<p>c# </p>\n\n<pre><code>//implementation of abstract class\nclass DoSomething : do_something\n{\n  public override void do_it()\n  {\n    Console.WriteLine(\"call from c#\");\n  }\n}\n//inside main\nDoSomething csharp_implementation = new DoSomething();\ncpp_caller caller = new cpp_caller();\ncaller.run(csharp_implementation);\n</code></pre>\n\n<p>The c++ project compiles but when compiling the last line of c# code the compiler throws an exception: 'run' is not supported by the language</p>\n\n<p>NOTE: Previous solutions in stack overflow are not helpful! Calling run.do_it() works fine in c#. Finally, the CLI compiler does not like using '^' or '&amp;' to pass an argument to the run method by reference.</p>\n"}, {"tags": ["javascript", "c#", "asp.net", "angularjs", "asp.net-web-api"], "comments": [{"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1507755676, "post_id": 46697028, "comment_id": 80342686, "body": "Have you wired your route to model? If you have <code>ProductController</code> then route must be <code>...\\Product</code>, not <code>products</code>. I believe, it is case sensitive."}, {"owner": {"reputation": 5605, "user_id": 2611237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gd9EW.jpg?s=128&g=1", "display_name": "Andrei Dragotoniu", "link": "https://stackoverflow.com/users/2611237/andrei-dragotoniu"}, "edited": false, "score": 0, "creation_date": 1507803659, "post_id": 46697028, "comment_id": 80360752, "body": "returning IQueryable in your controller is a bad idea. That&#39;s not data, IQueryable is a way of building up your query but it doesn&#39;t actually execute anything until you do a ToList() or specifically call the execution. There is no reason to return that from your controller and it will be cause of many issues if you go down that route."}, {"owner": {"reputation": 133, "user_id": 8056544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d521f741463c1cc9079904d63bfc5a62?s=128&d=identicon&r=PG&f=1", "display_name": "M. Gamie", "link": "https://stackoverflow.com/users/8056544/m-gamie"}, "edited": false, "score": 0, "creation_date": 1507922284, "post_id": 46697028, "comment_id": 80420129, "body": "This is the tutorial instructions, I just want to get the idea . the model is Products not product"}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 6452129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23eca2d2b7e9d11742068f3902b33799?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6452129/robert"}, "edited": false, "score": 0, "creation_date": 1507754351, "post_id": 46697103, "comment_id": 80342045, "body": "More information you can get there:  <a href=\"https://docs.microsoft.com/en-us/aspnet/web-api/overview/odata-support-in-aspnet-web-api/odata-v4/create-an-odata-v4-endpoint\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/aspnet/web-api/overview/&hellip;</a>"}, {"owner": {"reputation": 133, "user_id": 8056544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d521f741463c1cc9079904d63bfc5a62?s=128&d=identicon&r=PG&f=1", "display_name": "M. Gamie", "link": "https://stackoverflow.com/users/8056544/m-gamie"}, "edited": false, "score": 0, "creation_date": 1507922152, "post_id": 46697103, "comment_id": 80420066, "body": "What is the EDM configuration, I am new to asp.net and c#, can you please explain further?, I found a WebApiConfig file in  the App_start, is that what you meant?"}, {"owner": {"reputation": 66, "user_id": 6452129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23eca2d2b7e9d11742068f3902b33799?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6452129/robert"}, "reply_to_user": {"reputation": 133, "user_id": 8056544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d521f741463c1cc9079904d63bfc5a62?s=128&d=identicon&r=PG&f=1", "display_name": "M. Gamie", "link": "https://stackoverflow.com/users/8056544/m-gamie"}, "edited": false, "score": 0, "creation_date": 1508131987, "post_id": 46697103, "comment_id": 80472209, "body": "EDM - entity data manager. You should configure your configuration to provide OData routing."}], "tags": [], "owner": {"reputation": 66, "user_id": 6452129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23eca2d2b7e9d11742068f3902b33799?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6452129/robert"}, "is_accepted": false, "score": 0, "last_activity_date": 1507754225, "creation_date": 1507754225, "answer_id": 46697103, "question_id": 46697028, "link": "https://stackoverflow.com/questions/46697028/odata-with-asp-net-and-angularjs/46697103#46697103", "title": "Odata with Asp.net and angularjs", "body": "<p>Maybe you don't have odataConfiguration?? Where's you EDM configuration?</p>\n\n<p>In your config file you need something like that:</p>\n\n<pre><code>   public static class WebApiConfig\n{\n    public static void Register(HttpConfiguration config)\n    {\n        // New code:\n        ODataModelBuilder builder = new ODataConventionModelBuilder();\n        builder.EntitySet&lt;Product&gt;(\"Products\");\n        config.MapODataServiceRoute(\n            routeName: \"ODataRoute\",\n            routePrefix: null,\n            model: builder.GetEdmModel());\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8056544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d521f741463c1cc9079904d63bfc5a62?s=128&d=identicon&r=PG&f=1", "display_name": "M. Gamie", "link": "https://stackoverflow.com/users/8056544/m-gamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1507755492, "creation_date": 1507753879, "last_edit_date": 1507755492, "question_id": 46697028, "link": "https://stackoverflow.com/questions/46697028/odata-with-asp-net-and-angularjs", "title": "Odata with Asp.net and angularjs", "body": "<p>I am following up in the course AngularJS Front to Back with Web API using ASP.net, we are trying to do queries using ODATA so i added this code in the <code>ProductController</code> in the WebAPI</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// GET: api/Products\n[EnableQuery()]\npublic IQueryable&lt;Product&gt; Get()\n{\n    var productRepository = new ProductRepository();\n    return productRepository.Retrieve().AsQueryable();\n}\n</code></pre>\n\n<p>then added the below code in the productcontroller in the angular code:</p>\n\n<pre><code>function ProductListCtrl(productResource) {\n    var vm = this;\n\n    productResource.query({$skip:1, $top:3}, function (data) {\n        vm.products = data;\n })\n</code></pre>\n\n<p>but when I try to run it gives me the below error:</p>\n\n<blockquote>\n  <p>angular.js:12701 GET <a href=\"http://localhost:59302//api/products\" rel=\"nofollow noreferrer\">http://localhost:59302//api/products</a>?$skip=1&amp;$top=3 400 (Bad Request)\n  Possibly unhandled rejection: {\"data\":{\"message\":\"The query specified in the URI is not valid. No non-OData HTTP route registered.\",\"exceptionMessage\":\"No non-OData HTTP route registered.\",.....</p>\n</blockquote>\n"}, {"tags": ["c#", "asp.net-mvc", "repository-pattern"], "answers": [{"tags": [], "owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_accepted": true, "score": 0, "last_activity_date": 1507757929, "last_edit_date": 1507757929, "creation_date": 1507757515, "answer_id": 46697890, "question_id": 46696978, "link": "https://stackoverflow.com/questions/46696978/navigation-property-in-a-dropdown-list/46697890#46697890", "title": "Navigation property in a dropdown list", "body": "<p>Add a new property to <code>VehicleModelViewModel</code> class to hold the list of available options for the vehicle make dropdown.</p>\n\n<pre><code>public class VehicleModelViewModel\n{\n   public List&lt;SelectListItem&gt; Makes { set;get;}\n\n   [Required]\n   [Display(Name = \"Vehicle Model Name\")]\n   public string Name { get; set; }\n\n   [Required]\n   [Display(Name = \"Vehicle Make Id\")]  \n   public int VehicleMakeId { get; set; } \n}\n</code></pre>\n\n<p>Now in your GET action for the create screen, create an object of this view model, load the <code>Makes</code> property from the list of Makes</p>\n\n<pre><code>public class VehicleModelController : Controller\n{    \n    private readonly IVehicleRepository _vehicleRepository;    \n    public VehicleModelController()\n    {\n        _vehicleRepository = new VehicleRepository(new VehicleDbContext());\n    }    \n\n    public ActionResult Create()\n    {\n        var vm=new VehicleModelViewModel();\n        vm.Makes = GetMakeOptions();\n        return View(vm);\n    }\n    private List&lt;SelectListeItem&gt; GetMakeOptions()\n    {\n      return this._vehicleRepository.AllMakes\n                 .Select(x=&gt;new SelectListItem { Value=x.Id.ToString(), \n                                                 Text=x.Name})\n                 .ToList();\n    }  \n}\n</code></pre>\n\n<p>Now in your view, which is strongly typed to your view model, we will use the <code>Html.DropDownListFor</code> helper method to generate the SELECT element</p>\n\n<pre><code>@model VehicleViewModel\n@using(Html.BeginForm())\n{\n   @Html.LabelFor(s=&gt;s.Name)\n   @Html.TextBoxFor(s=&gt;s.Name)\n   @Html.ValidationMessageFor(s=&gt;s.Name)\n\n   @Html.LabelFor(s=&gt;s.MakeId)\n   @Html.DropDownListFor(s=&gt;s.VehicleMakeId , Model.Makes)\n   @Html.ValidationMessageFor(s=&gt;s.VehicleMakeId)\n\n   &lt;input type=\"submit\" /&gt;\n}\n</code></pre>\n\n<p>This will render the view with the SELECT element inside the form. Make sure you have an HttpPost Create action method in the controller which handles the form submit and saves the data back to your table</p>\n\n<pre><code>[HttpPost]\npublic ActionResult Create(VehicleViewModel model)\n{\n  if(ModelState.IsValid)\n  {\n     var e = new VehicleModel { Name = model.Name, VehicleMakeId = model.VehicleMakeId };\n     _vehicleRepository.Add(e);\n     return RedirectToAction(\"Index\");\n  }\n  model.Makes=GetMakes();\n  return View(model);\n}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6715288, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/92e03300fef564e05ba40ba514190509?s=128&d=identicon&r=PG", "display_name": "iantukic", "link": "https://stackoverflow.com/users/6715288/iantukic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 46697890, "answer_count": 1, "score": 0, "last_activity_date": 1507757929, "creation_date": 1507753664, "question_id": 46696978, "link": "https://stackoverflow.com/questions/46696978/navigation-property-in-a-dropdown-list", "title": "Navigation property in a dropdown list", "body": "<p>I'm currently learning interfaces and repository pattern and have difficulties with CRUD operations in my simple project. </p>\n\n<p>I have domain class \"VehicleMake\"</p>\n\n<pre><code>public class VehicleMake\n{\n    public VehicleMake()\n    {\n\n    }\n\n    [Key]\n    [Column(Order = 1)]\n    public int Id { get; set; }\n\n    [Required]\n    [StringLength(50)]\n    public string Name { get; set; }\n\n    public virtual ICollection&lt;VehicleModel&gt; VehicleModels { get; set; }\n}\n</code></pre>\n\n<p>and a domain class \"VehicleModel\"</p>\n\n<pre><code>public class VehicleModel\n{\n    [Key]\n    [Column(Order = 1)]\n    public int Id { get; set; }\n\n    public int VehicleMakeId { get; set; }\n\n    [Required]\n    [StringLength(50)]\n    public string Name { get; set; }\n\n    public virtual VehicleMake VehicleMake { get; set; }\n}\n</code></pre>\n\n<p>I also have an Interface \"IVehicleRepository\"</p>\n\n<pre><code>  public interface IVehicleRepository\n{\n    void Add(VehicleMake vehicleMake);\n\n    IEnumerable&lt;VehicleMake&gt; AllMakes { get; }\n    IEnumerable&lt;VehicleModel&gt; AllModels { get; }\n}\n</code></pre>\n\n<p>and a class \"VehicleRepository\" which implements that interface</p>\n\n<pre><code> public class VehicleRepository : IVehicleRepository\n{\n    private readonly VehicleDbContext _context;\n\n    public VehicleRepository(VehicleDbContext context)\n    {\n        _context = context;\n    }\n\n    public void Add(VehicleMake vehicleMake)\n    {\n        _context.VehicleMakes.Add(vehicleMake);\n        _context.SaveChanges();\n    }\n\n    public IEnumerable&lt;VehicleMake&gt; AllMakes =&gt; _context.VehicleMakes;\n    public IEnumerable&lt;VehicleModel&gt; AllModels =&gt; _context.VehicleModels;\n}\n</code></pre>\n\n<p>My DbContext class is following</p>\n\n<pre><code>public class VehicleDbContext : DbContext\n{\n    public VehicleDbContext() : base(\"VehicleDbContext\")\n    {\n\n    }\n\n    public DbSet&lt;VehicleMake&gt; VehicleMakes { get; set; }\n    public DbSet&lt;VehicleModel&gt; VehicleModels { get; set; }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n\n    }\n\n}\n</code></pre>\n\n<p>My \"VehicleMakeViewModel\" is following</p>\n\n<pre><code>public class VehicleMakeViewModel\n{\n    [Required]\n    [Display(Name = \"Vehicle Make Number\")]\n    public int Id { get; set; }\n\n    [Required]\n    [Display(Name = \"Vehicle Make Name\")]\n    public string Name { get; set; }\n}\n</code></pre>\n\n<p>and my \"VehicleModelViewModel\" is following</p>\n\n<pre><code>  public class VehicleModelViewModel\n{\n    [Required]\n    [Display(Name = \"Vehicle Model Number\")]\n    public int Id { get; set; }\n\n    [Required]\n    [Display(Name = \"Vehicle Model Name\")]\n    public string Name { get; set; }\n\n    [Required]\n    [Display(Name = \"Vehicle Make Id\")]\n    public int VehicleMakeId { get; set; }\n}\n</code></pre>\n\n<p>I have \"VehicleMakeController\" </p>\n\n<pre><code> public class VehicleMakeController : Controller\n{\n    private readonly IVehicleRepository _vehicleRepository;\n\n    public VehicleMakeController()\n    {\n        _vehicleRepository = new VehicleRepository(new VehicleDbContext());\n    }\n\n    // GET: VehicleMake\n    public ActionResult Index()\n    {\n        return View(_vehicleRepository.AllMakes);\n    }\n\n    public ActionResult CreateVehicleMake()\n    {\n        return View(new VehicleMakeViewModel());\n    }\n\n    [HttpPost]\n    public ActionResult CreateVehicleMake(VehicleMakeViewModel viewModel)\n    {\n        if (ModelState.IsValid)\n        {\n            var vehicleMake = new VehicleMake();\n            UpdateVehicleMake(vehicleMake, viewModel);\n            _vehicleService.Add(vehicleMake);\n            return RedirectToAction(\"Index\");\n        }\n\n        return View(viewModel);\n    }\n\n    private void UpdateVehicleMake(VehicleMake vehicleMake, VehicleMakeViewModel viewModel)\n    {\n        vehicleMake.Id = viewModel.Id;\n        vehicleMake.Name = viewModel.Name;\n    }\n}\n</code></pre>\n\n<p>and a \"VehicleModelController</p>\n\n<pre><code> public class VehicleModelController : Controller\n{\n\n    private readonly IVehicleRepository _vehicleRepository;\n\n    public VehicleModelController()\n    {\n        _vehicleRepository = new VehicleRepository(new VehicleDbContext());\n    }\n\n    // GET: VehicleModel\n    public ActionResult Index()\n    {\n        return View(_vehicleRepository.AllModels);\n    }\n\n\n}\n</code></pre>\n\n<p>As you can see in my \"VehicleMakeController\" I have methods for adding of new Vehicle Makes \"CreateVehicleMake\". Problem is that I don't know how to do that in my \"VehicleModelController\" for vehicle models. When the user wants to add a new vehicle model he should enter a name of the new vehicle model in the text box and then he should in the dropdown list select the vehicle make that belongs to that vehicle model. I don't know how to implement this with repository pattern and any help would be appreciated.</p>\n"}, {"tags": ["c#", "oracle", "entity-framework"], "comments": [{"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 0, "creation_date": 1507753495, "post_id": 46696909, "comment_id": 80341588, "body": "The most likely problem is that your mapping is wrong. If you want further help you will have to provide the mapping code."}, {"owner": {"reputation": 12943, "user_id": 2673029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbcZN.jpg?s=128&g=1", "display_name": "Isma", "link": "https://stackoverflow.com/users/2673029/isma"}, "edited": false, "score": 0, "creation_date": 1507753539, "post_id": 46696909, "comment_id": 80341612, "body": "Can you post your context class?"}, {"owner": {"reputation": 224, "user_id": 8715951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fee127aff9fbb2b1030e516caab9236?s=128&d=identicon&r=PG&f=1", "display_name": "Ioannis G.", "link": "https://stackoverflow.com/users/8715951/ioannis-g"}, "edited": false, "score": 0, "creation_date": 1507753607, "post_id": 46696909, "comment_id": 80341652, "body": "are you sure that the column accepts null values and it is not a &quot;not null&quot; column?"}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "edited": false, "score": 0, "creation_date": 1507753675, "post_id": 46696909, "comment_id": 80341681, "body": "Igor, I added the mapping of my entity."}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "edited": false, "score": 0, "creation_date": 1507753749, "post_id": 46696909, "comment_id": 80341710, "body": "Isma , here is the context"}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "edited": false, "score": 0, "creation_date": 1507753814, "post_id": 46696909, "comment_id": 80341753, "body": "Ioannis, the column really can&#39;t accept nullable values, knowing that I&#39;m trying to add an Id value at my database. The problem is that even forcing the value, the framework is passing null to the query and I really don&#39;t know why ."}, {"owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "edited": false, "score": 0, "creation_date": 1507754440, "post_id": 46696909, "comment_id": 80342092, "body": "Are you using CodeFirst or DatabaseFirst?"}, {"owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "edited": false, "score": 0, "creation_date": 1507754526, "post_id": 46696909, "comment_id": 80342130, "body": "@ruynunes  so according to your model there is no Id column in Area entity ? or AreaCore is primary column for that entity ?"}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "edited": false, "score": 0, "creation_date": 1507754570, "post_id": 46696909, "comment_id": 80342160, "body": "No. I&#39;m just testing the implementation of the entity framework. Then I mapped it by myself. Is there anyway to use code first or database first at an oracle database ?"}, {"owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "edited": false, "score": 0, "creation_date": 1507754676, "post_id": 46696909, "comment_id": 80342205, "body": "This means you created the Database yourself? Can you add the script of the CreateTable?"}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "reply_to_user": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "edited": false, "score": 0, "creation_date": 1507754731, "post_id": 46696909, "comment_id": 80342230, "body": "@RJ the annotation key as I know,  is the identification for the id column at an entity or I am wrong ?"}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "reply_to_user": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "edited": false, "score": 0, "creation_date": 1507754845, "post_id": 46696909, "comment_id": 80342293, "body": "@Nikolaus this is an old system at where I work. this isn&#39;t a new table. I just tried to test my CRUD based at this table and I mapped this manually. I&#39;m gonna update my post to include the script"}, {"owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "edited": false, "score": 0, "creation_date": 1507755036, "post_id": 46696909, "comment_id": 80342394, "body": "@ruynunes Key attribute makes the AreCode as a primary key and it is auto-generated. so I think in your scenario the AreCode need not be passed a value while creating the record. I am not sure if you forcefully assign the value for it it will be considered."}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "reply_to_user": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "edited": false, "score": 0, "creation_date": 1507755237, "post_id": 46696909, "comment_id": 80342473, "body": "@RJ I tried to force but without any success. Is there a way to do that even using the [Key] annotation? Or should I remove it ? but the problem is if I&#39;m gonna have any other errors by removing it ."}, {"owner": {"reputation": 1704, "user_id": 8445537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b869206b49bd1e6d7c7009bc163b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikolaus", "link": "https://stackoverflow.com/users/8445537/nikolaus"}, "edited": false, "score": 0, "creation_date": 1507755378, "post_id": 46696909, "comment_id": 80342533, "body": "@ruynunes The CreateTable script does not contain a Primary Key. Maybe EF handles the AreaCode as autogenerated and supplies null, while the dbms does expect a Value. Is this possible?"}, {"owner": {"reputation": 11009, "user_id": 1549450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SuCm4.jpg?s=128&g=1", "display_name": "Steve Greene", "link": "https://stackoverflow.com/users/1549450/steve-greene"}, "edited": false, "score": 1, "creation_date": 1507755598, "post_id": 46696909, "comment_id": 80342648, "body": "See Isma&#39;s answer..."}, {"owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "reply_to_user": {"reputation": 12943, "user_id": 2673029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbcZN.jpg?s=128&g=1", "display_name": "Isma", "link": "https://stackoverflow.com/users/2673029/isma"}, "edited": false, "score": 0, "creation_date": 1507755729, "post_id": 46696909, "comment_id": 80342714, "body": "@Isma answer is much better than article link i posted"}], "answers": [{"comments": [{"owner": {"reputation": 11009, "user_id": 1549450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SuCm4.jpg?s=128&g=1", "display_name": "Steve Greene", "link": "https://stackoverflow.com/users/1549450/steve-greene"}, "edited": false, "score": 0, "creation_date": 1507755561, "post_id": 46697429, "comment_id": 80342631, "body": "Beat me to it :)"}, {"owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "edited": false, "score": 0, "creation_date": 1507755815, "post_id": 46697429, "comment_id": 80342749, "body": "Thanks man !!!!! I&#39;m really a noob into entity framework and those easy things sometimes aren&#39;t so easy to discover !"}, {"owner": {"reputation": 12943, "user_id": 2673029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbcZN.jpg?s=128&g=1", "display_name": "Isma", "link": "https://stackoverflow.com/users/2673029/isma"}, "edited": false, "score": 0, "creation_date": 1507755947, "post_id": 46697429, "comment_id": 80342819, "body": "No problem, we&#39;ve all been there ;-)"}], "tags": [], "owner": {"reputation": 12943, "user_id": 2673029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbcZN.jpg?s=128&g=1", "display_name": "Isma", "link": "https://stackoverflow.com/users/2673029/isma"}, "is_accepted": true, "score": 4, "last_activity_date": 1507755409, "creation_date": 1507755409, "answer_id": 46697429, "question_id": 46696909, "link": "https://stackoverflow.com/questions/46696909/inserting-data-inside-database-using-entity-framework/46697429#46697429", "title": "Inserting data inside Database using Entity Framework", "body": "<p>The error might occur because Entity Framework is ignoring the value you set for  your AreaCode property because it is set up as the Key and by convention EF expects this key to be generated automatically by your DB system.</p>\n\n<p>You can try to disable it as follows:</p>\n\n<pre><code>[Table(\"EPW_AREAS\", Schema=\"CELG\")]\npublic class Area\n{\n    [Key]\n    [DatabaseGenerated(DatabaseGeneratedOption.None)]\n    [Column(\"AREA_CODE\")]\n    public int AreCode { get; set; }\n    [Column(\"AREA_NAME\")]\n    public string AreName { get; set; }\n}\n</code></pre>\n\n<p>Make sure you don't try to add the same area code more than once though.</p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "is_accepted": false, "score": 0, "last_activity_date": 1507755872, "last_edit_date": 1507755872, "creation_date": 1507755662, "answer_id": 46697489, "question_id": 46696909, "link": "https://stackoverflow.com/questions/46696909/inserting-data-inside-database-using-entity-framework/46697489#46697489", "title": "Inserting data inside Database using Entity Framework", "body": "<p>Please read <a href=\"https://www.codeproject.com/Articles/813912/Create-Primary-Key-using-Entity-Framework-Code-Fir\" rel=\"nofollow noreferrer\">this article</a>.</p>\n\n<p>It mentions how to enable and disable the auto-generated primary key.</p>\n"}], "owner": {"reputation": 67, "user_id": 4862578, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae7829a4a20ba80a68c17a8ddd4a11?s=128&d=identicon&r=PG&f=1", "display_name": "ruynunes", "link": "https://stackoverflow.com/users/4862578/ruynunes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 869, "favorite_count": 0, "accepted_answer_id": 46697429, "answer_count": 2, "score": 0, "last_activity_date": 1507755872, "creation_date": 1507753371, "last_edit_date": 1507754963, "question_id": 46696909, "link": "https://stackoverflow.com/questions/46696909/inserting-data-inside-database-using-entity-framework", "title": "Inserting data inside Database using Entity Framework", "body": "<p>I have a generic repository where I have a method to save data into database. Knowing that I'm changing an old system, I have faced with this situation:</p>\n\n<p>When I have to save an Area, for example, I need to insert the Id of the field based on the last value inserted inside by database, but for some reason when I try to persist this, an error telling that I can't insert null values into the id of the table appears.</p>\n\n<p>I tried to do this: </p>\n\n<pre><code>areaRepository.Save(new Area{AreaCode = 999, AreaName =  \"teste\"});\nareaRepository.SaveAll();\n</code></pre>\n\n<p>The save method is:</p>\n\n<pre><code>public void Save(T obj)\n{\n    ctx.Set&lt;T&gt;().Add(obj);\n}\n</code></pre>\n\n<p>And the save all method is </p>\n\n<pre><code>public void SaveAll()\n{\n    ctx.SaveChanges();\n}\n</code></pre>\n\n<p>After executing the SaveAll method the error rises. </p>\n\n<p>{\"ORA-01400: is not possible to insert null in (\\\"CELG\\\".\\\"EPW_AREAS\\\".\\\"AREA_CODE\\\")\\nORA-06512: at line 4\"}</p>\n\n<p>Knowing that I'm trying to force the AREA_CODE value, why entity framework doesn't add it and consider the value as null?</p>\n\n<p>Is there a way to force it ?</p>\n\n<p>Does anyone can help ? </p>\n\n<p>Thanks in advice.</p>\n\n<p>Update:</p>\n\n<p>Entity class:</p>\n\n<pre><code>[Table(\"EPW_AREAS\", Schema=\"CELG\")]\npublic class Area\n{\n    [Key]\n    [Column(\"AREA_CODE\")]\n    public int AreCode { get; set; }\n    [Column(\"AREA_NAME\")]\n    public string AreName { get; set; }\n}\n</code></pre>\n\n<p>Update 2</p>\n\n<p>Context</p>\n\n<pre><code>    public WsContext(string sConnectionString)\n        : base(sConnectionString)\n    {\n    }\n\n    public DbSet&lt;Area&gt; Areas { get; set; }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        modelBuilder.Conventions.Remove&lt;PluralizingTableNameConvention&gt;();\n    }\n</code></pre>\n\n<p>Update 3</p>\n\n<pre><code>CREATE TABLE CELG.EPW_AREAS\n(\n  AREA_CODE  NUMBER                            NOT NULL,\n  AREA_NAME    VARCHAR2(30 BYTE)\n)\nTABLESPACE TBS_CELG_DATA\nPCTUSED    0\nPCTFREE    10\nINITRANS   1\nMAXTRANS   255\nSTORAGE    (\n        INITIAL          64K\n        NEXT             1M\n        MINEXTENTS       1\n        MAXEXTENTS       UNLIMITED\n        PCTINCREASE      0\n        BUFFER_POOL      DEFAULT\n       )\nLOGGING \nNOCOMPRESS \nNOCACHE\nNOPARALLEL\nMONITORING;\n</code></pre>\n"}, {"tags": ["c#", "tsql", "sqlcommand"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 3, "creation_date": 1507753418, "post_id": 46696840, "comment_id": 80341554, "body": "Your select command is not a StoredProcedure. Remove the line that sets the CommandType"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1507753586, "post_id": 46696840, "comment_id": 80341644, "body": "On top of that, apply <code>using</code> to all the other things, not just <code>SqlConnection</code>, remove <code>[WebMethod]</code> that is not needed in asp.net mvc, and assign <code>departments</code> directly, without using a manual <code>JavaScriptSerializer</code> (didn&#39;t it feel weird to you that you are serializing just a part of the json response?)."}], "answers": [{"tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": true, "score": 4, "last_activity_date": 1507753539, "creation_date": 1507753539, "answer_id": 46696946, "question_id": 46696840, "link": "https://stackoverflow.com/questions/46696840/sqlexception-occurred-in-system-data-dll-but-was-not-handled-in-user-code/46696946#46696946", "title": "SqlException occurred in System.Data.dll but was not handled in user code", "body": "<p>You use the CommandType.StoredProcedure when you want to execute a stored procedure, when your command is a plain text sql command you shouldn't set this property because the default is appropriate for a command text</p>\n\n<p>By the way, while it is not a fatal error, it is always better to use the using statement around disposable objects like the SqlCommand and the SqlDataReader </p>\n\n<pre><code>using (SqlConnection con = new SqlConnection(cs))\nusing (SqlCommand cmd = new SqlCommand(sql, con))\n{\n    // cmd.CommandType = CommandType.StoredProcedure;\n    ... \n    using(SqlDataReader rdr = cmd.ExecuteReader())\n    {\n        ....\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 246, "user_id": 5297244, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh3.googleusercontent.com/-StfT8gQJaNU/AAAAAAAAAAI/AAAAAAAAADw/rzj1g3YH4XY/photo.jpg?sz=128", "display_name": "E.Rawrdr&#237;guez.Ophanim", "link": "https://stackoverflow.com/users/5297244/e-rawrdr%c3%adguez-ophanim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 46696946, "answer_count": 1, "score": 1, "last_activity_date": 1507753781, "creation_date": 1507753093, "last_edit_date": 1507753781, "question_id": 46696840, "link": "https://stackoverflow.com/questions/46696840/sqlexception-occurred-in-system-data-dll-but-was-not-handled-in-user-code", "title": "SqlException occurred in System.Data.dll but was not handled in user code", "body": "<p>I'm trying to run this method from a AJAX in ASP.Net with Razor. I don't have any visible error but every time I try to run it sends me this. I have a method like this running perfectly. But I guess I'm missing something.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cZI2D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cZI2D.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is my C# method</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[WebMethod]\npublic JsonResult  GetDeparments()\n{\n    string cs = \"Data Source=DMX87025;Initial Catalog=DB_PCC;Integrated Security=True\";\n    string sql = \"SELECT * FROM[DB_PCC].[dbo].[Departments]\";\n    List&lt;Departments&gt; departaments = new List&lt;Departments&gt;();\n\n    using (SqlConnection con = new SqlConnection(cs))\n    {\n        SqlCommand cmd = new SqlCommand(sql , con);\n        cmd.CommandType = CommandType.StoredProcedure;\n        con.Open();\n        SqlDataReader rdr = cmd.ExecuteReader(); //unhandled expection here\n        while (rdr.Read())\n        {\n            Departments dep = new Departments();\n            dep.Id = Convert.ToInt32(rdr[\"Id\"]);\n            dep.Code = rdr[\"Code\"].ToString();\n            dep.Description = rdr[\"Description\"].ToString();\n            departaments.Add(dep);\n        }\n    }\n\n    JavaScriptSerializer js = new JavaScriptSerializer();\n\n    return Json(new { success = true, message = (js.Serialize(departaments)) },\n        JsonRequestBehavior.AllowGet); \n}\n</code></pre>\n"}, {"tags": ["c#", "xcode", "unity3d", "ogg"], "comments": [{"owner": {"reputation": 1612, "user_id": 3142741, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8d823983245110f781dc5bc8e4bba5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Arshia001", "link": "https://stackoverflow.com/users/3142741/arshia001"}, "edited": false, "score": 0, "creation_date": 1507790868, "post_id": 46696830, "comment_id": 80353155, "body": "C# in Xcode? How&#39;s that even possible?"}], "owner": {"reputation": 11, "user_id": 8761460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afb449c2ffe181fa7be74504a1c16a8b?s=128&d=identicon&r=PG&f=1", "display_name": "min", "link": "https://stackoverflow.com/users/8761460/min"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507753052, "creation_date": 1507753052, "question_id": 46696830, "link": "https://stackoverflow.com/questions/46696830/is-it-possible-to-play-ogg-file-using-c-in-xcode", "title": "Is it possible to play ogg file using c# in Xcode?", "body": "<p>I have audio files that have to be looped, but it adds short silence when I make mp3 files. Wav files are too big to use. My only option looks like ogg file, but I've been struggling with playing ogg file using c# in Xcode. Can I get some help?</p>\n"}, {"tags": ["c#", ".net", "winforms", "arraylist", "datagridview"], "comments": [{"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 0, "creation_date": 1507821570, "post_id": 46696714, "comment_id": 80372939, "body": "Don&#39;t post images. Not everyone can see them, and it makes it harder for us to help you... meaning you&#39;re less likely to get a good answer. Convert those images into text blocks."}, {"owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "edited": false, "score": 0, "creation_date": 1507821590, "post_id": 46696714, "comment_id": 80372948, "body": "Also... posting the FindDuplicates() method would help."}], "answers": [{"tags": [], "owner": {"reputation": 1060, "user_id": 7702748, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/K2jOI.png?s=128&g=1", "display_name": "Twometer", "link": "https://stackoverflow.com/users/7702748/twometer"}, "is_accepted": false, "score": 0, "last_activity_date": 1507753222, "creation_date": 1507753222, "answer_id": 46696878, "question_id": 46696714, "link": "https://stackoverflow.com/questions/46696714/binding-an-arraylist-containing-datarow-objects-to-datagridview-datasource/46696878#46696878", "title": "Binding an ArrayList containing DataRow objects to DataGridView.DataSource", "body": "<p>As far as I can see you want to bind these numbers to the datagridview. What you are doing is binding an array list with some objects that has this array you want as a member, and that's what the datagridview displays. </p>\n\n<p>Try to not use an array with 5 items but a class with 5 members and then use a list of these objects as your data source.</p>\n\n<p>Extended tutorial can be found here: <a href=\"http://www.c-sharpcorner.com/article/binding-an-arraylist-with-datagrid-control/\" rel=\"nofollow noreferrer\">http://www.c-sharpcorner.com/article/binding-an-arraylist-with-datagrid-control/</a></p>\n\n<p>Please excuse my bad English, I'm writing from my mobile phone.</p>\n"}, {"tags": [], "owner": {"reputation": 360447, "user_id": 3043, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61d2a0f034915fa9d2acd6f6b145bba8?s=128&d=identicon&r=PG", "display_name": "Joel Coehoorn", "link": "https://stackoverflow.com/users/3043/joel-coehoorn"}, "is_accepted": false, "score": 0, "last_activity_date": 1507755861, "creation_date": 1507755861, "answer_id": 46697539, "question_id": 46696714, "link": "https://stackoverflow.com/questions/46696714/binding-an-arraylist-containing-datarow-objects-to-datagridview-datasource/46697539#46697539", "title": "Binding an ArrayList containing DataRow objects to DataGridView.DataSource", "body": "<p>This problem goes away if you change the <code>FindDuplicates()</code> method to instead return a strongly-typed <code>List&lt;T&gt;</code> with a real type in there. Then the DataGridView has actual properties it can look into to know what columns to create.</p>\n\n<p>ArrayLists are dead. You should pretty much never user them in new code. Even if you legitimately can't find a real type to use with a <code>List&lt;T&gt;</code>, <code>List&lt;Object&gt;</code> is still a better choice over <code>ArrayList</code>, as it communicates to the maintainer that the base Object type is really what you want, and it sets you up for easier change if you're ever able to get a stronger type (like an interface) in the future.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6384657, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a7915d9dba7b9da6af6298a400c04e57?s=128&d=identicon&r=PG&f=1", "display_name": "Deeyo Pradhan", "link": "https://stackoverflow.com/users/6384657/deeyo-pradhan"}, "edited": false, "score": 0, "creation_date": 1508413394, "post_id": 46700790, "comment_id": 80605446, "body": "I totally got it and had been working on it fixing bugs and it works now. Sorry for the late response and Thank you."}], "tags": [], "owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "is_accepted": true, "score": 0, "last_activity_date": 1507778178, "last_edit_date": 1507778178, "creation_date": 1507777772, "answer_id": 46700790, "question_id": 46696714, "link": "https://stackoverflow.com/questions/46696714/binding-an-arraylist-containing-datarow-objects-to-datagridview-datasource/46700790#46700790", "title": "Binding an ArrayList containing DataRow objects to DataGridView.DataSource", "body": "<p>You are trying to show an <code>ArrayList</code> containing some <code>DataRow</code> objects and the <code>DataGridView</code> is showing properties of <code>DataRow</code>. It's expected.</p>\n\n<p>But propbably you have noticed that when you show a <code>DataTable</code> in <code>DataGridView</code>, the control shows the columns rather than properties.</p>\n\n<p><strong>Why? What's the difference between showing a <code>DataTable</code> and showing a list of <code>DataRow</code> objects?</strong></p>\n\n<p>The difference is here, <code>DataGridView</code> shows <code>DefaultView</code> property of the <code>DataTable</code> which is of type of <code>DataView</code> which implements <a href=\"https://msdn.microsoft.com/en-us/library/system.componentmodel.itypedlist%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\"><code>ITypedList</code></a>. So it shows just what is returned by <a href=\"https://msdn.microsoft.com/en-us/library/system.componentmodel.itypedlist.getitemproperties(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>GetItemProperties</code></a> which in fact is asked from <code>DataTable</code> and it's a list of table columns.</p>\n\n<p><strong>How can I show a list of <code>DataRow</code> object in <code>DataGridView</code>?</strong></p>\n\n<p>Just add them to a table having the same schema of the origibal table. For examle:</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n{\n    var originalTable = new DataTable();\n    originalTable.Columns.Add(\"C1\");\n    originalTable.Columns.Add(\"C2\");\n\n    //Original data\n    originalTable.Rows.Add(\"A\", \"B\");\n    originalTable.Rows.Add(\"X\", \"Y\");\n    originalTable.Rows.Add(\"A\", \"B\");\n    originalTable.Rows.Add(\"X\", \"Y\");\n\n    //An ArrayList containing duplicate DataRow objects\n    var duplicates = new System.Collections.ArrayList();\n    duplicates.Add(originalTable.Rows[2]);\n    duplicates.Add(originalTable.Rows[3]);\n\n    //Create a Table having the same schema of the original table\n    var duplicatesTable = originalTable.Clone();\n\n    //Add copy of duplicates to the duplicate table\n    foreach (DataRow item in duplicates)\n    {\n        duplicatesTable.Rows.Add(item.ItemArray);\n    }\n    this.dataGridView1.DataSource = duplicates;\n}\n</code></pre>\n\n<p><strong>Note</strong></p>\n\n<p>You don't need to use <code>ArrayList</code> when working with <code>DataTable</code>. You have different options like creating an empty DataTable with the same schema using <code>Clone</code> method of DataTable, creating a copy of data and schema using <code>Copy</code> method, perform some searches using <code>AsDataView</code> and <code>AsEnumerable</code> and <code>AsEnumerable().CopyToDataTable()</code> and so on.</p>\n"}], "owner": {"reputation": 33, "user_id": 6384657, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a7915d9dba7b9da6af6298a400c04e57?s=128&d=identicon&r=PG&f=1", "display_name": "Deeyo Pradhan", "link": "https://stackoverflow.com/users/6384657/deeyo-pradhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 46700790, "answer_count": 3, "score": 1, "last_activity_date": 1512726807, "creation_date": 1507752578, "last_edit_date": 1512726807, "question_id": 46696714, "link": "https://stackoverflow.com/questions/46696714/binding-an-arraylist-containing-datarow-objects-to-datagridview-datasource", "title": "Binding an ArrayList containing DataRow objects to DataGridView.DataSource", "body": "<p>I'm trying to bind Items from an <code>ArrayList</code> called <code>duplicates</code> to <code>DataGridView</code>. However It is not showing data from <code>ArrayList</code> <code>ItemArray</code> which is what I want but instead showing metadata.</p>\n\n<p><code>duplicates</code> is type <code>ArrayList</code>:</p>\n\n<pre><code>duplicates = compare.FindDuplicates(existingLeadFilePath, newLeadFilePath);\ngridViewMain.DataSource = duplicates;\n</code></pre>\n\n<p>The Results</p>\n\n<p><img src=\"https://i.stack.imgur.com/ks5gl.png\" alt=\"Results I get\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/CV8ib.png\" alt=\"Results I require To be displayed\"></p>\n"}, {"tags": ["c#", "templates", "inheritance", "sitecore"], "comments": [{"owner": {"reputation": 5698, "user_id": 81631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rVmxs.jpg?s=128&g=1", "display_name": "Mark Cassidy", "link": "https://stackoverflow.com/users/81631/mark-cassidy"}, "edited": false, "score": 0, "creation_date": 1507758235, "post_id": 46696703, "comment_id": 80343775, "body": "Your solution lies in the LinkDatabase"}, {"owner": {"reputation": 3905, "user_id": 3784238, "user_type": "registered", "accept_rate": 26, "profile_image": "https://lh3.googleusercontent.com/-5TiQ_Wr94Kg/AAAAAAAAAAI/AAAAAAAAAUg/N0Pp2l_1mdM/photo.jpg?sz=128", "display_name": "Erica Stockwell-Alpert", "link": "https://stackoverflow.com/users/3784238/erica-stockwell-alpert"}, "reply_to_user": {"reputation": 5698, "user_id": 81631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rVmxs.jpg?s=128&g=1", "display_name": "Mark Cassidy", "link": "https://stackoverflow.com/users/81631/mark-cassidy"}, "edited": false, "score": 0, "creation_date": 1507822524, "post_id": 46696703, "comment_id": 80373554, "body": "care to elaborate?"}], "answers": [{"tags": [], "owner": {"reputation": 26247, "user_id": 157833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q24uk.jpg?s=128&g=1", "display_name": "Marek Musielak", "link": "https://stackoverflow.com/users/157833/marek-musielak"}, "is_accepted": true, "score": 3, "last_activity_date": 1507789171, "last_edit_date": 1507789171, "creation_date": 1507757505, "answer_id": 46697888, "question_id": 46696703, "link": "https://stackoverflow.com/questions/46696703/c-sitecore-get-inherited-templates/46697888#46697888", "title": "C# Sitecore get inherited templates", "body": "<p>The part <code>item.Template</code> in the </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var baseTemplates = item.Template.BaseTemplates.ToList();\n</code></pre>\n\n<p>line is incorrect.</p>\n\n<p><code>item.Template</code> returns <code>/sitecore/templates/System/Templates/Template</code> here, so you're checking for a <code>BaseTemplate</code> of <code>Template</code> template always.</p>\n\n<p>Your code should be:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>foreach (var item in templateItems)\n{\n    var baseTemplates = new TemplateItem(item).BaseTemplates.ToList();\n    foreach (var baseTemplate in baseTemplates)\n    {\n        if (baseTemplate.ID == templateItem.ID)\n        {\n            inheritors.Add(item.ID.ToString());\n        }\n    }\n}\n</code></pre>\n\n<p>And the better approach may be using <code>LinkDatabase</code> to find all the referrers of your item which link from <code>BaseTemplate</code> field like that:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var links = Sitecore.Globals.LinkDatabase.GetItemReferrers(templateItem, false);\nforeach (var link in links)\n{\n    if (link.SourceFieldID == Sitecore.FieldIDs.BaseTemplate)\n    {\n        inheritors.Add(link.SourceItemID.ToString());\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3905, "user_id": 3784238, "user_type": "registered", "accept_rate": 26, "profile_image": "https://lh3.googleusercontent.com/-5TiQ_Wr94Kg/AAAAAAAAAAI/AAAAAAAAAUg/N0Pp2l_1mdM/photo.jpg?sz=128", "display_name": "Erica Stockwell-Alpert", "link": "https://stackoverflow.com/users/3784238/erica-stockwell-alpert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3446, "favorite_count": 2, "accepted_answer_id": 46697888, "answer_count": 1, "score": 2, "last_activity_date": 1507789171, "creation_date": 1507752520, "last_edit_date": 1507757725, "question_id": 46696703, "link": "https://stackoverflow.com/questions/46696703/c-sitecore-get-inherited-templates", "title": "C# Sitecore get inherited templates", "body": "<p>I'm trying to find all templates that inherit a particular template through code. I have the ID of the base template (<code>Base Web Page</code>), and I'm iterating through all of the template items in Sitecore looking for items that inherit <code>Base Web Page</code>. </p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>foreach (var item in templateItems)\n{\n    var baseTemplates = item.Template.BaseTemplates.ToList();\n    foreach (var baseTemplate in baseTemplates)\n    {\n        if (baseTemplate.ID == templateItem.ID)\n        {\n            inheritors.Add(item.ID.ToString());\n        }\n    }\n}\n</code></pre>\n\n<p>However, <code>item.Template.BaseTemplates</code> gives me a list of the root level base templates; instead of giving me <code>Base Web Page</code>, it gives me the templates that <code>Base Web Page</code> inherits from (<code>Advanced</code>, <code>Appearance</code>, <code>Help</code>, etc)</p>\n\n<p><a href=\"https://i.stack.imgur.com/aJdWb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aJdWb.png\" alt=\"enter image description here\"></a></p>\n\n<p>Therefore I don't know if the item is actually inheriting <code>Base Web Page</code> or not.</p>\n\n<p>Is there a method to get directly inherited templates? How can I find all templates that inherit <code>Base Web Page</code>?</p>\n"}, {"tags": ["c#", ".net", "wpf"], "comments": [{"owner": {"reputation": 1771, "user_id": 8365439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v76vl.jpg?s=128&g=1", "display_name": "Valerii", "link": "https://stackoverflow.com/users/8365439/valerii"}, "edited": false, "score": 0, "creation_date": 1507753706, "post_id": 46696600, "comment_id": 80341690, "body": "It is really hard to understand what are you want to achive, but I&#39;ll try. Maybe you do not need to save window, you just need to save some values and apply these values to the window when you open it again. Am I right?"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1507765612, "post_id": 46696600, "comment_id": 80345840, "body": "Can you explain what you thought would happen when you created that static field? Can you walk through the reasoning process where you concluded that it would do something useful?"}], "answers": [{"tags": [], "owner": {"reputation": 507, "user_id": 5817136, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9b2ab95c30a057160a821a073a1c4a1e?s=128&d=identicon&r=PG", "display_name": "Iman", "link": "https://stackoverflow.com/users/5817136/iman"}, "is_accepted": false, "score": 1, "last_activity_date": 1507752883, "creation_date": 1507752883, "answer_id": 46696791, "question_id": 46696600, "link": "https://stackoverflow.com/questions/46696600/how-do-i-save-the-ui-of-a-new-instanced-window-when-it-closes/46696791#46696791", "title": "How do I save the UI of a new instanced window when it closes?", "body": "<p>Bind the value of the check box to a global variable. You can read or write into a global variable like this</p>\n\n<pre><code>App.Current.Properties[\"NameOfProperty\"] = \"ValueOfProperty\";\nstring myProperty = App.Current.Properties[\"NameOfProperty\"];\n</code></pre>\n\n<p>Like this, you can persist the value of the checkbox.</p>\n"}, {"tags": [], "owner": {"reputation": 133235, "user_id": 7252182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUgxG.png?s=128&g=1", "display_name": "mm8", "link": "https://stackoverflow.com/users/7252182/mm8"}, "is_accepted": false, "score": 1, "last_activity_date": 1507901449, "creation_date": 1507901449, "answer_id": 46731158, "question_id": 46696600, "link": "https://stackoverflow.com/questions/46696600/how-do-i-save-the-ui-of-a-new-instanced-window-when-it-closes/46731158#46731158", "title": "How do I save the UI of a new instanced window when it closes?", "body": "<p>You cannot call the <code>Show()</code> method of a window that has already been closed once.</p>\n\n<p>What you could do is to create a view model class that keeps track of the value of the <code>IsChecked</code> property of the <code>CheckBox</code>, set the <code>DataContext</code> of <code>SecondaryWindow</code> to an instance of this class and bind the <code>CheckBox</code> in the view to the source property, e.g.:</p>\n\n<pre><code>public class MainWindow : Window\n{\n    private readonly ViewModel _vm = new ViewModel();\n\n    public MainWindow()\n    {\n        InitializeComponent();\n    }\n\n    private void Open_Click(object sender, RoutedEventArgs e)\n    {\n        SecondaryWindow sw = new SecondaryWindow();\n        sw.DataContext = _vm;\n        sw.Show();\n    }\n}\n\npublic class ViewModel\n{\n    public bool IsChecked { get; set; }\n}\n</code></pre>\n\n<p><strong>SecondaryWindow.xaml:</strong></p>\n\n<pre><code>&lt;CheckBox Content=\"Check\" IsChecked=\"{Binding IsChecked}\" /&gt;\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8420023, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/21b486bb4ca0b5feb9d75cc34b54f291?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Jones", "link": "https://stackoverflow.com/users/8420023/jordan-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524827866, "creation_date": 1507752179, "last_edit_date": 1507752501, "question_id": 46696600, "link": "https://stackoverflow.com/questions/46696600/how-do-i-save-the-ui-of-a-new-instanced-window-when-it-closes", "title": "How do I save the UI of a new instanced window when it closes?", "body": "<p>So I have this project with two windows.</p>\n\n<p>MainWindow and SecondaryWindow &amp; I have a button on the MainWindow that initializes a new instance of the SecondaryWindow &amp; opens it.</p>\n\n<pre><code>SecondaryWindow sw = new SecondaryWindow();\nsw.Show();\n</code></pre>\n\n<p>The issue is.. When I check a checkbox on the SecondaryWindow and then close it, it clears the window when I open it again. I know why because it's opening a <em>NEW</em> isntance of the window everytime.\nHow do I make it save?</p>\n\n<p>I tried doing this..</p>\n\n<pre><code>public static SecondaryWindow instance;\npublic SecondaryWindow()\n        {\n            InitializeComponent();\n            instance = this;\n        }\n</code></pre>\n\n<p>And then this in the MainWindow</p>\n\n<pre><code>SecondaryWindow sw;\n</code></pre>\n\n<p>And then doing this..</p>\n\n<pre><code>sw.Show();\n</code></pre>\n\n<p>but that line throws an error saying that it's null</p>\n\n<p>I think thats called singleton what I was trying to do.</p>\n"}, {"tags": ["c#", ".net", "mono"], "comments": [{"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 1, "creation_date": 1507753769, "post_id": 46696562, "comment_id": 80341726, "body": "Are you trying to build for a Arm/x86 supported CF board/device, or just re-use existing non-GUI CF-based code to run on a *nix/macOS?"}, {"owner": {"reputation": 674, "user_id": 1893155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jvtf4.jpg?s=128&g=1", "display_name": "Eric Fulmer", "link": "https://stackoverflow.com/users/1893155/eric-fulmer"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1507755697, "post_id": 46696562, "comment_id": 80342697, "body": "@SushiHangover The latter: trying to run an existing GUI-less CF app on *nix (specifically Ubuntu 16.04 here)."}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 2, "creation_date": 1507756266, "post_id": 46696562, "comment_id": 80342949, "body": "You can remove the MSBuild CF target and make sure that a  <code>&lt;Import Project=&quot;$(MSBuildBinPath)\\Microsoft.CSharp.targets&quot; &#47;&gt;</code> exists. That should get it at least compiling and producing code-related errors (depending upon what the code is referencing that only exists in CF, you could have a little or a lot of refactoring to do...)"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1507913105, "post_id": 46696562, "comment_id": 80415552, "body": "As other comments indicated, you should port the CF project back to full .NET Framework, and then try on Mono. CF is Windows CE/Mobile specific, so it is meaningless to use that anywhere else."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10872292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf98339a1aaaf5f2c64f1cc11285eaa7?s=128&d=identicon&r=PG", "display_name": "Kevin Cozens", "link": "https://stackoverflow.com/users/10872292/kevin-cozens"}, "is_accepted": false, "score": 0, "last_activity_date": 1546719721, "last_edit_date": 1546719721, "creation_date": 1546707404, "answer_id": 54054136, "question_id": 46696562, "link": "https://stackoverflow.com/questions/46696562/mono-building-running-microsoft-compact-framework-applications-under-mono/54054136#54054136", "title": "Mono - Building/running Microsoft Compact Framework applications under Mono?", "body": "<p>You may have a problem with case sensitivity. I had a similar problem with a program not finding <code>Microsoft.CSHARP.Targets</code></p>\n\n<p>It turns out that MSBuild provides a file called <code>Microsoft.CSharp.targets</code></p>\n\n<p>I created a symlink from <code>Microsoft.CSHARP.Targets</code> to <code>Microsoft.CSharp.targets</code> and that worked around the problem.</p>\n"}], "owner": {"reputation": 674, "user_id": 1893155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jvtf4.jpg?s=128&g=1", "display_name": "Eric Fulmer", "link": "https://stackoverflow.com/users/1893155/eric-fulmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546719721, "creation_date": 1507752056, "question_id": 46696562, "link": "https://stackoverflow.com/questions/46696562/mono-building-running-microsoft-compact-framework-applications-under-mono", "title": "Mono - Building/running Microsoft Compact Framework applications under Mono?", "body": "<p>I'm trying to build a .NET project on Mono. </p>\n\n<pre><code>efulmer:[~/projects/MyApp]$ msbuild MyApp.csproj \nMicrosoft (R) Build Engine version 15.3.0.0 ( Mon Aug 14 21:03:24 UTC 2017) for Mono\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nBuild started 10/11/2017 3:46:23 PM.\nProject \"/home/efulmer/projects/MyApp/MyApp.csproj\" on node 1 (default targets).\n/home/efulmer/projects/MyApp/MyApp.csproj(161,3): error MSB4019: The imported project \"/usr/lib/mono/msbuild/15.0/bin/Microsoft.CompactFramework.CSharp.targets\" was not found. Confirm that the path in the &lt;Import&gt; declaration is correct, and that the file exists on disk.\nDone Building Project \"/home/efulmer/projects/MyApp/MyApp.csproj\" (default targets) -- FAILED.\n\nBuild FAILED.\n\n\"/home/efulmer/projects/MyApp/MyApp.csproj\" (default target) (1) -&gt;\n  /home/efulmer/projects/MyApp/MyApp.csproj(161,3): error MSB4019: The imported project \"/usr/lib/mono/msbuild/15.0/bin/Microsoft.CompactFramework.CSharp.targets\" was not found. Confirm that the path in the &lt;Import&gt; declaration is correct, and that the file exists on disk.\n\n0 Warning(s)\n1 Error(s)\n\nTime Elapsed 00:00:00.14\n</code></pre>\n\n<p>The line in question is <code>&lt;Import Project=\"$(MSBuildBinPath)/Microsoft.CompactFramework.CSharp.targets\" /&gt;</code></p>\n\n<p>The underlying problem is fairly obvious to me after some searching (missing .NET Compact Framework) but I'm not sure how to solve it, as I installed <code>mono-complete</code>. But I don't know how to solve it. Help appreciated!</p>\n"}, {"tags": ["c#", "tree"], "comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1507752237, "post_id": 46696547, "comment_id": 80341025, "body": "You should work on your naming conventions and casing... <code>Employees</code> should not be your class name, it should be <code>Employee</code> (its a single entity).   <code>employees</code> should be <code>Subordinates</code> or something that <i>actually</i> describes what it is.  Never mix up casing like that."}, {"owner": {"reputation": 1, "user_id": 8676978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2110100ef3861d0ac2c09b76278a640a?s=128&d=identicon&r=PG&f=1", "display_name": "devweb", "link": "https://stackoverflow.com/users/8676978/devweb"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1507752909, "post_id": 46696547, "comment_id": 80341343, "body": "I agree with you thank you, in the rush to put the post I committed this error should be Employee. The structure of the classes is not real, but only to demonstrate how we could do this research in this tree structure"}, {"owner": {"reputation": 718, "user_id": 830486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kSv6L.jpg?s=128&g=1", "display_name": "DSway", "link": "https://stackoverflow.com/users/830486/dsway"}, "edited": false, "score": 0, "creation_date": 1507753092, "post_id": 46696547, "comment_id": 80341418, "body": "I&#39;d go with hashset (if speed matters](<a href=\"https://stackoverflow.com/questions/2728500/hashsett-versus-dictionaryk-v-w-r-t-searching-time-to-find-if-an-item-exist\" title=\"hashsett versus dictionaryk v w r t searching time to find if an item exist\">stackoverflow.com/questions/2728500/&hellip;</a>).  I would use the employee ID as the key and then an object with an Employee pointer and either top-down or bottom-up list of IDs as the value."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8676978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2110100ef3861d0ac2c09b76278a640a?s=128&d=identicon&r=PG&f=1", "display_name": "devweb", "link": "https://stackoverflow.com/users/8676978/devweb"}, "edited": false, "score": 0, "creation_date": 1507760613, "post_id": 46696981, "comment_id": 80344546, "body": "Yes, I used the names as an example. Your solution works, but I am looking for not read all tree more than once, and improve the search. I don&#39;t know what you think to transform that list(tree) in a dictionary or HashSet?"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 1, "user_id": 8676978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2110100ef3861d0ac2c09b76278a640a?s=128&d=identicon&r=PG&f=1", "display_name": "devweb", "link": "https://stackoverflow.com/users/8676978/devweb"}, "edited": false, "score": 0, "creation_date": 1507760981, "post_id": 46696981, "comment_id": 80344659, "body": "Well, perhaps a tree isn&#39;t the proper data structure to use in that case. The @DependencyInjection answer suggests converting the tree to a <code>Dictionary</code> and using that, and while it lacks error checking, the main problem I see is what happens when you update the tree?"}], "tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 0, "last_activity_date": 1507757230, "last_edit_date": 1507757230, "creation_date": 1507753685, "answer_id": 46696981, "question_id": 46696547, "link": "https://stackoverflow.com/questions/46696547/c-challenge-employee-tree/46696981#46696981", "title": "C# challenge employee tree", "body": "<p>A recursive function is generally used to search a tree. I assumed you fix the variable names as suggested:</p>\n\n<pre><code>public static Employee FindById(Employee root, int id) {\n    if (root.Id == id)\n        return root;\n    else if (root.Employees != null) {\n        foreach (var e in root.Employees) {\n            var pe = FindById(e, id);\n            if (pe != null)\n                return pe;\n        }\n    }\n    return null;\n}\n</code></pre>\n\n<p>To use, find the employee and then the manager:</p>\n\n<pre><code>var emp = FindById(root, 51);\nvar manager = emp.ManagerId.HasValue ? FindById(root, emp.ManagerId.Value) : null;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2853, "user_id": 6682181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QWWHj.png?s=128&g=1", "display_name": "haindl", "link": "https://stackoverflow.com/users/6682181/haindl"}, "edited": false, "score": 0, "creation_date": 1507754801, "post_id": 46697017, "comment_id": 80342267, "body": "Welcome to StackOverflow! It would be nice if you could explain your code a little bit so we can understand what you are proposing as an answer."}, {"owner": {"reputation": 1, "user_id": 8676978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2110100ef3861d0ac2c09b76278a640a?s=128&d=identicon&r=PG&f=1", "display_name": "devweb", "link": "https://stackoverflow.com/users/8676978/devweb"}, "edited": false, "score": 0, "creation_date": 1507759937, "post_id": 46697017, "comment_id": 80344347, "body": "In &quot;public static IDictionary&lt;int, Employees&gt; EmployeesToDictionary(Employees employees)&quot; you can not use &quot;var dictionary = new Dictionary&lt;int, Employees&gt;();&quot; Because you are always creating the dictionary again. Also in the foreach if you have an employee wihout children it`s going to give you a exception."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 1, "user_id": 8676978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2110100ef3861d0ac2c09b76278a640a?s=128&d=identicon&r=PG&f=1", "display_name": "devweb", "link": "https://stackoverflow.com/users/8676978/devweb"}, "edited": false, "score": 0, "creation_date": 1507760904, "post_id": 46697017, "comment_id": 80344635, "body": "@devweb You may want to read the answer again more carefully."}], "tags": [], "owner": {"reputation": 1, "user_id": 8761468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0125b47c268e7eb8bccbe4b7352a0605?s=128&d=identicon&r=PG&f=1", "display_name": "DependencyInjection", "link": "https://stackoverflow.com/users/8761468/dependencyinjection"}, "is_accepted": false, "score": 0, "last_activity_date": 1507876690, "last_edit_date": 1507876690, "creation_date": 1507753838, "answer_id": 46697017, "question_id": 46696547, "link": "https://stackoverflow.com/questions/46696547/c-challenge-employee-tree/46697017#46697017", "title": "C# challenge employee tree", "body": "<p>Add there two functions :</p>\n\n<pre><code>public static IDictionary&lt;int, Employees&gt; EmployeesToDictionary(Employees employees)\n{\n    var dictionary = new Dictionary&lt;int, Employees&gt;();\n    EmployeesToDictionary(employees, dictionary);\n    return dictionary;\n}\n\nprivate static void EmployeesToDictionary(Employees employees, IDictionary&lt;int, Employees&gt; dictionary)\n{\n    if (employees == null) return;\n    dictionary.Add(employees.Id, employees);\n    if (employees.employees == null) return;\n    foreach (var sub in employees.employees)\n    {\n        EmployeesToDictionary(sub);\n    }\n}\n</code></pre>\n\n<p>And usage :</p>\n\n<pre><code>var id = 5;\nvar dict = EmployeesToDictionary(root);\nvar employee = dict[id];\nvar manager = dict[employee.ManagerId.Value];\n</code></pre>\n\n<p>Edit : \n@haindl Documentation is an admission of failure Yeah you're right.\n@devweb I have added the check for the exception. The dictionnary is created only one time, check again</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8761468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0125b47c268e7eb8bccbe4b7352a0605?s=128&d=identicon&r=PG&f=1", "display_name": "DependencyInjection", "link": "https://stackoverflow.com/users/8761468/dependencyinjection"}, "is_accepted": false, "score": 0, "last_activity_date": 1507877145, "creation_date": 1507877145, "answer_id": 46723985, "question_id": 46696547, "link": "https://stackoverflow.com/questions/46696547/c-challenge-employee-tree/46723985#46723985", "title": "C# challenge employee tree", "body": "<p>If you want to do a traversal only once, there are this possibility :</p>\n\n<pre><code>public static void FindById(Employees root, int id, out Employees employees, out Employees manager)\n{\n    employees = manager = null;\n    // todo stack\n    var stack = new Stack&lt;Employees&gt;();\n    stack.Push(root);\n    // all managers seens\n    var managers = new List&lt;Employees&gt;();\n    while (stack.Count &gt; 0)\n    {\n        var e = stack.Pop();\n        if (e.Id == id) // if found\n        {\n            employees = e;\n            manager = managers.FirstOrDefault(m =&gt; m.Id == e.ManagerId);\n            return;\n        }\n        else if (e.employees != null)\n        {\n            // add only managers with employee\n            managers.Add(e);\n            foreach (var ep in e.employees)\n            {\n                stack.Push(ep);\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8676978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2110100ef3861d0ac2c09b76278a640a?s=128&d=identicon&r=PG&f=1", "display_name": "devweb", "link": "https://stackoverflow.com/users/8676978/devweb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1507877145, "creation_date": 1507751998, "last_edit_date": 1507752215, "question_id": 46696547, "link": "https://stackoverflow.com/questions/46696547/c-challenge-employee-tree", "title": "C# challenge employee tree", "body": "<p>I have a <code>c#</code> project, and I've created a class called <code>Employees</code>.<br>\nInside this class, I have a new list:  </p>\n\n<pre><code>public class Employees\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n    public int? ManagerId { get; set; }\n    public List&lt;Employees&gt; employees { get; set; }\n}\n</code></pre>\n\n<p>Imagine that I have the following structure shown in the image:<br>\n<a href=\"https://i.stack.imgur.com/C3NQr.jpg\" rel=\"nofollow noreferrer\">companytree</a></p>\n\n<p>Then in the main program, I have this structure to represent the picture above:  </p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        var root = new Employees()\n        {\n            Id = 15,\n            Name = \"President\",\n            employees = new List&lt;Employees&gt;()\n            {\n                new Employees() {\n\n                    Id = 23, ManagerId = 15, Name = \"Director23\",\n                    employees = new List&lt;Employees&gt;()\n                    {\n                        new Employees() {\n                            Id = 21, ManagerId = 23, Name = \"Manager21\",\n                            employees = new List&lt;Employees&gt;()\n                            {\n                                new Employees() { Id = 31, ManagerId=21, Name = \"Employee31\" },\n                                new Employees() { Id = 41, ManagerId=21, Name = \"Employee41\" },\n                                new Employees() { Id = 51, ManagerId=21, Name = \"Employee51\" }\n                            }\n                        },\n\n                        new Employees() {\n                            Id = 22, ManagerId = 23, Name = \"Manager22\",\n                            employees = new List&lt;Employees&gt;()\n                            {\n                                new Employees() { Id = 32, ManagerId=22, Name = \"Employee32\" },\n                                new Employees() { Id = 42, ManagerId=22, Name = \"Employee42\" },\n                                new Employees() { Id = 52, ManagerId=22, Name = \"Employee52\" }\n                            }\n                        }\n                    }\n                },\n\n                new Employees() {\n\n                    Id = 25, ManagerId = 15, Name = \"Director25\",\n                    employees = new List&lt;Employees&gt;()\n                    {\n                        new Employees() {\n                            Id = 51, ManagerId = 25, Name = \"Manager51\",\n                            employees = new List&lt;Employees&gt;()\n                            {\n                                new Employees() { Id = 61, ManagerId=51, Name = \"Employee61\" },\n                                new Employees() { Id = 71, ManagerId=51, Name = \"Employee71\" },\n                                new Employees() { Id = 81, ManagerId=51, Name = \"Employee81\" }\n                            }\n                        },\n\n                        new Employees() {\n                            Id = 62, ManagerId = 25, Name = \"Manager62\",\n                            employees = new List&lt;Employees&gt;()\n                            {\n                                new Employees() { Id = 72, ManagerId=62, Name = \"Employee72\" },\n                                new Employees() { Id = 82, ManagerId=62, Name = \"Employee82\" }\n                            }\n                        }\n                    }\n                }\n\n            }\n        };\n\n        Console.ReadLine();\n    }\n}\n</code></pre>\n\n<p>How to create a function where I pass the tree root list of the employee and the ID of any employee of the company and you need to return your manager closer or higher and also the employee itself. </p>\n\n<p>Remembering that you could pass the ID of a director (you would have to return the president), the ID of the manager(you would have to return the director), the ID of the employee (you would have to return the manager), the ID of the presidente return himself.</p>\n\n<p>What better way to do this research taking into account that we can have a much larger hierarchical structure than this example. It would be costly to scan all lists.</p>\n\n<p>Use hastable, dictionary, hashset??</p>\n"}, {"tags": ["c#", ".net", "windows", "wcf", "iis"], "comments": [{"owner": {"reputation": 3109, "user_id": 6086968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o38dO.png?s=128&g=1", "display_name": "Hameed Syed", "link": "https://stackoverflow.com/users/6086968/hameed-syed"}, "edited": false, "score": 0, "creation_date": 1509299636, "post_id": 46696516, "comment_id": 80953229, "body": "Try to roleback dll using nuget.So that particular version of dll is removed .Refer this <a href=\"https://stackoverflow.com/questions/10206090/how-to-install-an-older-version-of-package-via-nuget\" title=\"how to install an older version of package via nuget\">stackoverflow.com/questions/10206090/&hellip;</a> and alter accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 884, "user_id": 746544, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0973856256c91179f003696ef7091bb2?s=128&d=identicon&r=PG", "display_name": "Shah", "link": "https://stackoverflow.com/users/746544/shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1508992240, "creation_date": 1508992240, "answer_id": 46945889, "question_id": 46696516, "link": "https://stackoverflow.com/questions/46696516/intermittent-serializationexception-in-wcf-service-looks-for-incorrect-dll-versi/46945889#46945889", "title": "Intermittent SerializationException in WCF service looks for incorrect DLL version", "body": "<p>It seems actual error is something else and caused due to some un-handled error in WCF service. </p>\n\n<p>This is because when an unhandled exception is thrown in a ASP.NET-based application the application unexpectedly quits. When this problem occurs, no exception information that you must have to understanding the issue is logged in the Application log.</p>\n\n<p>So to get actual error, </p>\n\n<ul>\n<li>Try adding try-catch blocks to code (some global error handling or for every service method) and check error logs</li>\n<li>Or to check actual error, follow steps from this <a href=\"https://support.microsoft.com/en-nz/help/911816/unhandled-exceptions-cause-asp-net-based-applications-to-quit-unexpect\" rel=\"nofollow noreferrer\">article</a> (Method 1, don't go for Method 2 from article) and will log the actual error.</li>\n</ul>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 108, "user_id": 848156, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9cd4037c404f0d13cefb6360080d2b66?s=128&d=identicon&r=PG", "display_name": "Alireza", "link": "https://stackoverflow.com/users/848156/alireza"}, "is_accepted": false, "score": 0, "last_activity_date": 1509313686, "creation_date": 1509313686, "answer_id": 47005580, "question_id": 46696516, "link": "https://stackoverflow.com/questions/46696516/intermittent-serializationexception-in-wcf-service-looks-for-incorrect-dll-versi/47005580#47005580", "title": "Intermittent SerializationException in WCF service looks for incorrect DLL version", "body": "<p>1- If you have multi projects in one solution you should open every project file that referenced old version DLL and replace it with new version.</p>\n\n<p>2- I suggest to you if you have model in a separated class library and to prevent any type of serialization exception add you serialization contract to <code>AssemblyInfo.cs</code> in that class library like this:</p>\n\n<pre><code>[assembly: AssemblyProduct(\"blah.Data.Domain\")]\n</code></pre>\n\n<p>and you contract can be like this:</p>\n\n<pre><code>[assembly: ContractNamespace(\"http://blah.xyz/test\",  ClrNamespace = \"blah.Data.Domain\"\n</code></pre>\n\n<p>this contract serialization apply to all model inside class library.</p>\n"}, {"tags": [], "owner": {"reputation": 545, "user_id": 1018350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/498df1ec972fce6ea408dccf29feff89?s=128&d=identicon&r=PG", "display_name": "PraveenLearnsEveryday", "link": "https://stackoverflow.com/users/1018350/praveenlearnseveryday"}, "is_accepted": false, "score": 0, "last_activity_date": 1509532336, "creation_date": 1509532336, "answer_id": 47052809, "question_id": 46696516, "link": "https://stackoverflow.com/questions/46696516/intermittent-serializationexception-in-wcf-service-looks-for-incorrect-dll-versi/47052809#47052809", "title": "Intermittent SerializationException in WCF service looks for incorrect DLL version", "body": "<p>As you have mentioned the stacktrace referring to the old version of dll, Is there  any chance you have the old DLL registered in GAC? </p>\n"}, {"tags": [], "owner": {"reputation": 3109, "user_id": 6086968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o38dO.png?s=128&g=1", "display_name": "Hameed Syed", "link": "https://stackoverflow.com/users/6086968/hameed-syed"}, "is_accepted": false, "score": 0, "last_activity_date": 1509534482, "creation_date": 1509534482, "answer_id": 47053474, "question_id": 46696516, "link": "https://stackoverflow.com/questions/46696516/intermittent-serializationexception-in-wcf-service-looks-for-incorrect-dll-versi/47053474#47053474", "title": "Intermittent SerializationException in WCF service looks for incorrect DLL version", "body": "<p>So dll version is the issue.</p>\n\n<p><strong>Error :My.Org.Core, Version=1.8.0.0 coudlnt be found</strong></p>\n\n<p>Expected dll as per you is My.Org.Core, Version=2.0.0.0.</p>\n\n<p>First step is to look for that dll in your GAC.</p>\n\n<p><strong>RUN</strong> then type %windir%\\assembly\\GAC_MSIL ,now dive deep to see or search the My.Org dll,right click and if found check the version.If not found ,then you dont have the dll.It means you dont have My.Org.Core, Version=1.8.0.0 dll neither in your bin/solution or GAC.</p>\n\n<p>Looks like this is your internal organization dll.So get the 1.8.0.0 th dll and put it in your bin folder and restart the client service.</p>\n\n<p><strong>Why you are missing the dll</strong>? Probably when the client application was build,the dll was being referenced from GAC and hence in the developer machine didnt face this issue.</p>\n\n<p><strong>How to avoid such situation</strong> ? While the application build/deployed set the property copy to local true so that while the application is build,that particular dll is dropped in the package or bin folder explicitly and no need to refer from the GAC.But obviously it will increase the build time.</p>\n"}], "owner": {"reputation": 736, "user_id": 212474, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1d4181fa2086a81d3623be9c460bfa5?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/212474/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 1, "answer_count": 4, "score": -1, "last_activity_date": 1509534482, "creation_date": 1507751890, "question_id": 46696516, "link": "https://stackoverflow.com/questions/46696516/intermittent-serializationexception-in-wcf-service-looks-for-incorrect-dll-versi", "title": "Intermittent SerializationException in WCF service looks for incorrect DLL version", "body": "<p>So intermittently I am getting an Exception written out to my server's Event Logs from something bad happening in WCF.</p>\n\n<p>This Exception happens at the same time as a \"System.TimeoutException\" for an async callback to the client. I guess the serialization problem causes the timeout issue, because the calls are not all that long.</p>\n\n<p>The client side sometimes logs a stacktrace including \"The server did not provide a meaningful reply\" when it gets its async answer back from the service.</p>\n\n<p>So the \"bin\" folder for my web service contains a copy of My.Org.Core DLL with version 2.0.0.0 however the stacktrace refers to version 1.8.0.0! I searched my entire solution for any mention of this old 1.8.0.0 and it cannot be found! Please help.</p>\n\n<p>Here is the serialization problem:</p>\n\n<pre><code>An unhandled exception occurred and the process was terminated.\n\nApplication ID: DefaultDomain\n\nProcess ID: xxxx\n\nException: System.Runtime.Serialization.SerializationException\n\nMessage: Unable to find assembly 'My.Org.Core, Version=1.8.0.0, Culture=neutral, PublicKeyToken=null'.\n\nStackTrace:\nat System.Runtime.Serialization.Formatters.Binary.BinaryAssemblyInfo.GetAssembly()\nat System.Runtime.Serialization.Formatters.Binary.ObjectReader.GetType(BinaryAssemblyInfo assemblyInfo, String name)\nat System.Runtime.Serialization.Formatters.Binary.ObjectMap..ctor(String objectName, String[] memberNames, BinaryTypeEnum[] binaryTypeEnumA, Object[] typeInformationA, Int32[] memberAssemIds, ObjectReader objectReader, Int32 objectId, BinaryAssemblyInfo assemblyInfo, SizedArray assemIdToAssemblyTable)\nat System.Runtime.Serialization.Formatters.Binary.__BinaryParser.ReadObjectWithMapTyped(BinaryObjectWithMapTyped record)\nat System.Runtime.Serialization.Formatters.Binary.__BinaryParser.Run()\nat System.Runtime.Serialization.Formatters.Binary.ObjectReader.Deserialize(HeaderHandler handler, __BinaryParser serParser, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)\nat System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Deserialize(Stream serializationStream, HeaderHandler handler, Boolean fCheck, Boolean isCrossAppDomain, IMethodCallMessage methodCallMessage)\nat System.Runtime.Remoting.Channels.CrossAppDomainSerializer.DeserializeObject(MemoryStream stm)\nat System.AppDomain.Deserialize(Byte[] blob)\nat System.AppDomain.UnmarshalObject(Byte[] blob)\n</code></pre>\n"}, {"tags": ["c#", "saml", "wif", "ws-federation"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 2679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee2dabc0fcfee410cf3518cd5640008?s=128&d=identicon&r=PG&f=1", "display_name": "Rick LaBarbera", "link": "https://stackoverflow.com/users/2679816/rick-labarbera"}, "edited": false, "score": 0, "creation_date": 1508358467, "post_id": 46778725, "comment_id": 80584688, "body": "i&#39;ve accepted the answer.  i get a BootstrapContext reference but the .Token property is null.  the .SecurityToken property looks good, but i need the raw text of the .Token property.   any suggestions?"}, {"owner": {"reputation": 35, "user_id": 2679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee2dabc0fcfee410cf3518cd5640008?s=128&d=identicon&r=PG&f=1", "display_name": "Rick LaBarbera", "link": "https://stackoverflow.com/users/2679816/rick-labarbera"}, "edited": false, "score": 1, "creation_date": 1508364236, "post_id": 46778725, "comment_id": 80587408, "body": "solved!  SecurityToken bootstrapToken = bc.SecurityToken;           using (var wrtr = XmlWriter.Create(sbToken))  {    new Saml2SecurityTokenHandler(new SamlSecurityTokenRequirement()).WriteToken(wrtr, bootstrapToken);  } theXml = sbToken.ToString();"}], "tags": [], "owner": {"reputation": 487, "user_id": 5227606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828fc6382fa0df8e90a394e8210e719e?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis K", "link": "https://stackoverflow.com/users/5227606/dennis-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1508186327, "creation_date": 1508186327, "answer_id": 46778725, "question_id": 46696504, "link": "https://stackoverflow.com/questions/46696504/how-can-i-access-the-raw-xml-of-the-saml-token/46778725#46778725", "title": "how can i access the raw xml of the saml token?", "body": "<p>First you must configure WIF to save the \"BootstrapContext\":</p>\n\n<pre><code>&lt;system.identityModel&gt;\n  &lt;identityConfiguration saveBootstrapContext=\"true\"&gt;\n</code></pre>\n\n<p>Then you can use the Property \"BootstrapContext\" on the \"ClaimsIdentity\"</p>\n\n<pre><code>ClaimsPrincipal cp = Thread.CurrentPrincipal as ClaimsPrincipal;\nClaimsIdentity cid = (ClaimsIdentity)cp.Identity; \nBootstrapContext bc = cid.BootstrapContext as BootstrapContext;\n</code></pre>\n\n<p>And use the \"Token\" Property on the BootstrapContext to get the raw xml of the saml token.</p>\n\n<p>See also:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.security.claims.claimsidentity.bootstrapcontext(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.security.claims.claimsidentity.bootstrapcontext(v=vs.110).aspx</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.identitymodel.tokens.bootstrapcontext(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.identitymodel.tokens.bootstrapcontext(v=vs.110).aspx</a></p>\n\n<p><a href=\"http://www.cloudidentity.com/blog/2012/11/30/using-the-bootstrapcontext-property-in-net-4-5-2/\" rel=\"nofollow noreferrer\">http://www.cloudidentity.com/blog/2012/11/30/using-the-bootstrapcontext-property-in-net-4-5-2/</a></p>\n"}], "owner": {"reputation": 35, "user_id": 2679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dee2dabc0fcfee410cf3518cd5640008?s=128&d=identicon&r=PG&f=1", "display_name": "Rick LaBarbera", "link": "https://stackoverflow.com/users/2679816/rick-labarbera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 46778725, "answer_count": 1, "score": 0, "last_activity_date": 1508186327, "creation_date": 1507751833, "question_id": 46696504, "link": "https://stackoverflow.com/questions/46696504/how-can-i-access-the-raw-xml-of-the-saml-token", "title": "how can i access the raw xml of the saml token?", "body": "<p>I can get all the claims values with code like this:</p>\n\n<pre><code>ClaimsPrincipal cp = Thread.CurrentPrincipal as ClaimsPrincipal;            \nClaimsIdentity cid = (ClaimsIdentity)cp.Identity;\n\nforeach (Claim claim in cid.Claims)\n{\n   ...\n}\n</code></pre>\n\n<p>but i want to be able to read the entire token as i suspect a some info i need is in a non-attribute section of the token.\nI've read about the security token visualizer control, but it's not something i can use because i don't want end users seeing the control output, but would like to send the raw token xml via email.</p>\n"}, {"tags": ["c#", "math", "unity3d"], "answers": [{"tags": [], "owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "is_accepted": false, "score": 1, "last_activity_date": 1507801004, "last_edit_date": 1507801004, "creation_date": 1507761320, "answer_id": 46698583, "question_id": 46696444, "link": "https://stackoverflow.com/questions/46696444/math-mercator-projection-convert-360-video-pixel-coordinate-to-sphere-surface-c/46698583#46698583", "title": "Math: Mercator Projection Convert 360 video pixel coordinate to sphere surface coordinate", "body": "<p>As a side note, the radius is arbitrary. The pixel coordinates only map to the directional coordinates (polar [<code>\u03b8</code>] and azimuthal [<code>\u03d5</code>] angles).</p>\n\n<hr>\n\n<p>We can do this by mapping each pixel to equal <code>\u03b8</code> and <code>\u03d5</code> intervals. The diagram below illustrates a low-resolution setup:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M7LrY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M7LrY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Let us adopt the convention that, for an image of with <code>W</code>, <code>\u03d5 = 0</code> corresponds to:</p>\n\n<ul>\n<li>Even <code>W</code>: half way between <code>X = floor((W - 1) / 2)</code> and <code>X = ceil((W - 1) / 2)</code></li>\n<li>Odd <code>W</code>: in the middle of the pixel column at <code>X = floor((W - 1) / 2)</code></li>\n</ul>\n\n<p>The pixel row at <code>Y</code> maps to the equilatitudinal line at <code>\u03b8 = (Y + 0.5) / H * \u03c0</code>.</p>\n\n<p>To map all pixels in their <em>entirety</em>, let <code>X</code> start at <code>-0.5</code> instead of <code>0</code>, and end at <code>W - 0.5</code>; likewise for <code>Y</code>. Since integer coordinates map to the <em>centers</em> of the pixel regions shown above, this allows the whole area of any particular pixel to be addressed. You may need this later on if you plan on doing multi-sampling filtering for e.g. anti-aliasing.</p>\n\n<p>Code:</p>\n\n<pre><code>Vector3 Mercator(float x, float y, int w, int h)\n{\n   // outside of valid pixel region\n   if (x &lt; -0.5f || x &gt;= w - 0.5f || y &lt; -0.5f || y &gt;= h - 0.5f)\n      return new Vector3();\n\n   float theta = (y + 0.5f) / h * Math.PI;\n   float phi = ((x + 0.5f) / w - 0.5f) * 2.0 * Math.PI;\n\n   float c_t = Math.Cos(theta);\n   return new Vector3(c_t * Math.Cos(phi), c_t * Math.Sin(phi), Math.Sin(theta));\n}\n</code></pre>\n\n<p>... and multiply the resulting direction vector by any \"radius\" you like, since it has (basically) nothing to do with the mapping anyway.</p>\n"}], "owner": {"reputation": 49, "user_id": 7121446, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1109069192474617/picture?type=large", "display_name": "Tats", "link": "https://stackoverflow.com/users/7121446/tats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507801004, "creation_date": 1507751613, "question_id": 46696444, "link": "https://stackoverflow.com/questions/46696444/math-mercator-projection-convert-360-video-pixel-coordinate-to-sphere-surface-c", "title": "Math: Mercator Projection Convert 360 video pixel coordinate to sphere surface coordinate", "body": "<p>I was trying to map the 360 video pixel coordinate to sphere surface coordinate but I couldn't get right result... It just mapped to the wrong position I already know the points of the XY data for 360 video pixels.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12732590/how-map-2d-grid-points-x-y-onto-sphere-as-3d-points-x-y-z\">how map 2d grid points (x,y) onto sphere as 3d points (x,y,z)</a></p>\n\n<p>I checked this link and I copied method from this but what I'm getting is not mapped to the desired position.</p>\n\n<h2>How can I get radius from the pixels?</h2>\n\n<p>I am not sure if I'm passing right radius for imageRadius but I thought it will be circumference/PI to get radius and the video ratio is 4096x2048. I also tried to pass the number 1 because UV is 0-1 but it was not right...</p>\n\n<h2>Is Method wrong?</h2>\n\n<p>Maybe the method is wrong. I passed random numbers into the imageRadius but couldn't get the right position... If I make X to negative number the seems like little bit closer to result....?</p>\n\n<h2>Current Result</h2>\n\n<p><a href=\"https://youtu.be/t0I7Hlb-tbk\" rel=\"nofollow noreferrer\">https://youtu.be/t0I7Hlb-tbk</a>\nIt mapped to up right position with the method that I found online...</p>\n\n<h2>Project File</h2>\n\n<p><a href=\"https://drive.google.com/a/swordfish-sf.com/file/d/0B45RYzVs0t0_VVdaaHdmNHRWTk0/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/a/swordfish-sf.com/file/d/0B45RYzVs0t0_VVdaaHdmNHRWTk0/view?usp=sharing</a>\nIf somebody can check the Unity project file that will be great...</p>\n\n<h2>Current Code</h2>\n\n<pre><code>public class mapScript : MonoBehaviour {\n\npublic int input = 4098;\nfloat imageRadius = 4098f / Mathf.PI; //2098? 3072? 4098?\nfloat radius;\npublic GameObject testSphere;\n\nvoid Start () {\n    radius = this.transform.localScale.x;\n}\n\n\nvoid Update () {\n    imageRadius = input / Mathf.PI;\n    int currentFrame = (int)this.GetComponent&lt;VideoPlayer&gt;().frame;\n\n    testSphere.transform.position = MercatorProjection(mapVals[currentFrame,0],mapVals[currentFrame,1]);\n}\n\nVector3 MercatorProjection(float xVal, float yVal)\n{\n    float lon = (xVal / imageRadius);\n    float lat = (2 * Mathf.Atan(Mathf.Exp(yVal / imageRadius)) - Mathf.PI / 2);\n\n\n    float calcX = radius * Mathf.Cos(lat) * Mathf.Cos(lon);\n    float calcY = radius * Mathf.Cos(lat) * Mathf.Sin(lon);\n    float calcZ = radius * Mathf.Sin(lat);\n\n    Vector3 result = new Vector3(calcX,calcY,calcZ);\n    Debug.Log(result);\n    return result;\n}\n\n\n\nfloat[,] mapVals = new float[,] {\n{1969.21f, 928.625f},\n{1969.6f, 928.533f},\n{1968.92f, 928.825f},\n{1968.68f, 929f},\n{1968.47f, 929.067f},\n{1968.41f, 929.025f},\n{1968.48f, 928.992f},\n....\n};\n}\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["c#", "interlocked"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1507751715, "post_id": 46696414, "comment_id": 80340725, "body": "And what problem are you having with that solution?"}, {"owner": {"reputation": 507, "user_id": 5817136, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9b2ab95c30a057160a821a073a1c4a1e?s=128&d=identicon&r=PG", "display_name": "Iman", "link": "https://stackoverflow.com/users/5817136/iman"}, "edited": false, "score": 0, "creation_date": 1507752482, "post_id": 46696414, "comment_id": 80341137, "body": "Well, everything looks good to me. Ran your code and is perfectly fine. I am not sure if I see where you need help."}, {"owner": {"reputation": 8905, "user_id": 681040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24aee106202d9dd35e4c594ce4acbe53?s=128&d=identicon&r=PG", "display_name": "Dan S", "link": "https://stackoverflow.com/users/681040/dan-s"}, "edited": false, "score": 0, "creation_date": 1507754360, "post_id": 46696414, "comment_id": 80342053, "body": "I really misunderstood my original error!"}], "answers": [{"tags": [], "owner": {"reputation": 507, "user_id": 5817136, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9b2ab95c30a057160a821a073a1c4a1e?s=128&d=identicon&r=PG", "display_name": "Iman", "link": "https://stackoverflow.com/users/5817136/iman"}, "is_accepted": true, "score": 1, "last_activity_date": 1507752008, "creation_date": 1507752008, "answer_id": 46696553, "question_id": 46696414, "link": "https://stackoverflow.com/questions/46696414/how-can-i-use-an-array-item-with-interlocked-compareexchange/46696553#46696553", "title": "How can I use an array item with Interlocked.CompareExchange", "body": "<p>I am using it like this</p>\n\n<pre><code>string[] myArray = new string[] { \"A\", \"B\", \"C\" };\n        string myStr = Interlocked.CompareExchange(ref myArray[0], \"F\", myArray[0]);\n        foreach (var item in myArray)\n        {\n            Console.WriteLine(item.ToString());\n        }\n</code></pre>\n\n<p>And this is the out put</p>\n\n<pre><code>F B C\n</code></pre>\n\n<p>Everything is Fine.</p>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 8497160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f54997a40ea880f98c93eba245af6dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8497160/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1605812223, "last_edit_date": 1605812223, "creation_date": 1507752337, "answer_id": 46696644, "question_id": 46696414, "link": "https://stackoverflow.com/questions/46696414/how-can-i-use-an-array-item-with-interlocked-compareexchange/46696644#46696644", "title": "How can I use an array item with Interlocked.CompareExchange", "body": "<p>I don't see the problem. You are setting the first string in the array to null. And that's why it's null. This is how you use it:</p>\n<pre><code>string[] myArray = new string[] { &quot;A&quot;, &quot;B&quot;, &quot;C&quot; }; \nstring myStr = Interlocked.CompareExchange(ref myArray[0], &quot;ASDF&quot; /* VALUE */, \nmyArray[0]); \n//myArray[0] == &quot;ASDF&quot;    &lt;- VALUE YOU SET\n</code></pre>\n"}], "owner": {"reputation": 8905, "user_id": 681040, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24aee106202d9dd35e4c594ce4acbe53?s=128&d=identicon&r=PG", "display_name": "Dan S", "link": "https://stackoverflow.com/users/681040/dan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 46696553, "answer_count": 2, "score": 1, "last_activity_date": 1605812223, "creation_date": 1507751520, "last_edit_date": 1507751616, "question_id": 46696414, "link": "https://stackoverflow.com/questions/46696414/how-can-i-use-an-array-item-with-interlocked-compareexchange", "title": "How can I use an array item with Interlocked.CompareExchange", "body": "<p>I'm familiar with using <code>Interlocked.CompareExchange()</code> with plain objects. However I'd like to use it with the member of an array:</p>\n\n<pre><code>string[] myArray = new string[] { \"A\", \"B\", \"C\" }; \nstring myStr = (string) Interlocked.CompareExchange(ref myArray[0], null, myArray[0]); \n// myArray[0] == null\n</code></pre>\n\n<p>How can I accomplish this?</p>\n"}, {"tags": ["c#", "azure-ad-b2c", "azure-ad-graph-api"], "answers": [{"comments": [{"owner": {"reputation": 3116, "user_id": 2896495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/42c90f6a4aa3a6adf856c6d3cafc54a1?s=128&d=identicon&r=PG&f=1", "display_name": "alvipeo", "link": "https://stackoverflow.com/users/2896495/alvipeo"}, "edited": false, "score": 1, "creation_date": 1507757762, "post_id": 46696782, "comment_id": 80343585, "body": "Why can&#39;t I add custom attribute programmatically? I have a library which defines MyOwnUser, and for that user I need custom attributes. Why would I add those in the portal every time for different directories?"}, {"owner": {"reputation": 4756, "user_id": 1669464, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/EVzJC.jpg?s=128&g=1", "display_name": "Pytry", "link": "https://stackoverflow.com/users/1669464/pytry"}, "reply_to_user": {"reputation": 3116, "user_id": 2896495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/42c90f6a4aa3a6adf856c6d3cafc54a1?s=128&d=identicon&r=PG&f=1", "display_name": "alvipeo", "link": "https://stackoverflow.com/users/2896495/alvipeo"}, "edited": false, "score": 0, "creation_date": 1507820538, "post_id": 46696782, "comment_id": 80372214, "body": "@alvipeo That is an excellent question! I have asked it many times myself. It&#39;s equally frustrating that I had to manually create an account with those attribute values before they would become available. If I were dead set on programmatic creation, I might look more into the B2C module for the azure powershell; I have never done it, but maybe you could create a script that would setup each environment. I have not worked with custom policies yet either, but I understand them to be more configurable (xml and stuff), although it takes more initial effort."}, {"owner": {"reputation": 3116, "user_id": 2896495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/42c90f6a4aa3a6adf856c6d3cafc54a1?s=128&d=identicon&r=PG&f=1", "display_name": "alvipeo", "link": "https://stackoverflow.com/users/2896495/alvipeo"}, "edited": false, "score": 0, "creation_date": 1507825958, "post_id": 46696782, "comment_id": 80375560, "body": "I just made a class creating extension properties in code. Need to finish with setting/reading its value from a User"}, {"owner": {"reputation": 4756, "user_id": 1669464, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/EVzJC.jpg?s=128&g=1", "display_name": "Pytry", "link": "https://stackoverflow.com/users/1669464/pytry"}, "reply_to_user": {"reputation": 3116, "user_id": 2896495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/42c90f6a4aa3a6adf856c6d3cafc54a1?s=128&d=identicon&r=PG&f=1", "display_name": "alvipeo", "link": "https://stackoverflow.com/users/2896495/alvipeo"}, "edited": false, "score": 0, "creation_date": 1507836148, "post_id": 46696782, "comment_id": 80381007, "body": "Are you able to share the code you made for that? Also, which api version are you using?  Also, if you want to see what I did for updating a user and getting custom attributes, look here: <a href=\"https://github.com/Xitikit/xitikit-blue/blob/master/blue-kit/graph-api/src/main/java/org/xitikit/blue/graphapi/AzureGraphApiClient.java\" rel=\"nofollow noreferrer\">github.com/Xitikit/xitikit-blue/blob/master/blue-kit/graph-a&zwnj;&#8203;pi/&hellip;</a>  It&#39;s based off of what I am using in production, but this version is still in progress. I had to change some things for licensing and legal reasons so everyone could use it."}, {"owner": {"reputation": 3116, "user_id": 2896495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/42c90f6a4aa3a6adf856c6d3cafc54a1?s=128&d=identicon&r=PG&f=1", "display_name": "alvipeo", "link": "https://stackoverflow.com/users/2896495/alvipeo"}, "edited": false, "score": 0, "creation_date": 1507843524, "post_id": 46696782, "comment_id": 80384780, "body": "I&#39;ve got the whole lib with a bunch of tests now. Almost there. Will share some when it&#39;s all green."}], "tags": [], "owner": {"reputation": 4756, "user_id": 1669464, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/EVzJC.jpg?s=128&g=1", "display_name": "Pytry", "link": "https://stackoverflow.com/users/1669464/pytry"}, "is_accepted": true, "score": 0, "last_activity_date": 1507753992, "last_edit_date": 1507753992, "creation_date": 1507752853, "answer_id": 46696782, "question_id": 46696386, "link": "https://stackoverflow.com/questions/46696386/azure-ad-b2c-how-to-add-custom-attribute-programmatically-extension-property/46696782#46696782", "title": "Azure AD B2C - how to add custom attribute programmatically (extension property)", "body": "<p>The correct way of adding attributes is through the 'portal.azure.com' administration portal. </p>\n\n<p>You will also need to create a user through a policy before those attributes actually become available for all users.</p>\n\n<p>The other thing to consider is that the extension name will be different in each environment, so you will need some custom logic to parse the users JSON that you get from the GraphApi, and check to be sure that the attribute ends with the name you gave that attribute.</p>\n\n<p>Example:</p>\n\n<pre><code>//Java, sorry\nprivate YourCustomGraphApiUser populateCustomProperty(JsonNode jsonUser) throws JsonProcessingException{\n\n    YourCustomGraphApiUser azureUser = mapper.treeToValue(jsonUser, YourCustomGraphApiUser.class);\n    String[] customAttributeNames = new String()[\"one\",\"two\"]; //Replace this with some values from some injected properties\n    for(String attributeName : customAttributeNames){\n        JsonNode customAttribute = jsonUser.get(attributeName);\n        if(customAttribute != null){\n            azureUser.set(attributeName, customAttribute.asText());//Assuming custom attributes are stored in a map-like structure in YourCustomGraphApiUser. \n        }\n        else{                           \n            throw new NotFoundException(\"Error getting the name for custom attribute \"+attributeName, e);\n            // OR you could ignore and just log an error. Whatever.\n        }           \n    }\n    return azureUser;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196, "user_id": 762756, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/19b657c20ddcb4966203879fbecddfb4?s=128&d=identicon&r=PG", "display_name": "Anshu Kunal", "link": "https://stackoverflow.com/users/762756/anshu-kunal"}, "is_accepted": false, "score": 1, "last_activity_date": 1507893094, "creation_date": 1507893094, "answer_id": 46728570, "question_id": 46696386, "link": "https://stackoverflow.com/questions/46696386/azure-ad-b2c-how-to-add-custom-attribute-programmatically-extension-property/46728570#46728570", "title": "Azure AD B2C - how to add custom attribute programmatically (extension property)", "body": "<p>You create extensionProperty on the desired Application object using Graph API.</p>\n\n<p>Sample JSON request:</p>\n\n<pre><code>POST https://graph.windows.net/contoso.onmicrosoft.com/applications/269fc2f7-6420-4ea4-be90-9e1f93a87a64/extensionProperties?api-version=1.5 HTTP/1.1\nAuthorization: Bearer eyJ0eXAiOiJKV1Qi...r6Xh5KVA\nContent-Type: application/json\nHost: graph.windows.net\nContent-Length: 104\n{\n\"name\": \"skypeId\",\n\"dataType\": \"String\",\n\"targetObjects\": [\n    \"User\"\n]\n\n}\n</code></pre>\n\n<p>If the operation was successful, it will return an HTTP 201 Created status code along with the fully-qualified extension property name, which can be used for writing values to the target type.\nReference: <a href=\"https://msdn.microsoft.com/en-us/library/azure/ad/graph/howto/azure-ad-graph-api-directory-schema-extensions\" rel=\"nofollow noreferrer\">azure-ad-graph-api-directory-schema-extensions</a></p>\n"}], "owner": {"reputation": 3116, "user_id": 2896495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/42c90f6a4aa3a6adf856c6d3cafc54a1?s=128&d=identicon&r=PG&f=1", "display_name": "alvipeo", "link": "https://stackoverflow.com/users/2896495/alvipeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 0, "accepted_answer_id": 46696782, "answer_count": 2, "score": 0, "last_activity_date": 1507893094, "creation_date": 1507751375, "question_id": 46696386, "link": "https://stackoverflow.com/questions/46696386/azure-ad-b2c-how-to-add-custom-attribute-programmatically-extension-property", "title": "Azure AD B2C - how to add custom attribute programmatically (extension property)", "body": "<p>In order to have some extra data for my Azure AD B2C Users I want to create a new custom attribute for a User object (or extension property, which is I suppose the same thing). So I found this <strong><a href=\"https://developer.microsoft.com/en-us/graph/docs/api-reference/beta/api/application_post_extensionproperties\" rel=\"nofollow noreferrer\">documentation</a></strong>. Is this a correct way of adding a custom attribute for a User?</p>\n"}, {"tags": ["c#", "pdfsharp"], "comments": [{"owner": {"reputation": 43527, "user_id": 98094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VkdLW.jpg?s=128&g=1", "display_name": "Icemanind", "link": "https://stackoverflow.com/users/98094/icemanind"}, "edited": false, "score": 2, "creation_date": 1507751320, "post_id": 46696341, "comment_id": 80340503, "body": "MSG file, as in an Outlook email message?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1507751364, "post_id": 46696341, "comment_id": 80340528, "body": "Are you simply printing the messages to a PDF?"}, {"owner": {"reputation": 49, "user_id": 8473644, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4c34a3b862ec78be7c6154eafcda833?s=128&d=identicon&r=PG&f=1", "display_name": "Taborator", "link": "https://stackoverflow.com/users/8473644/taborator"}, "edited": false, "score": 0, "creation_date": 1507751378, "post_id": 46696341, "comment_id": 80340538, "body": "Yes. As in the Outlook email format."}, {"owner": {"reputation": 43527, "user_id": 98094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VkdLW.jpg?s=128&g=1", "display_name": "Icemanind", "link": "https://stackoverflow.com/users/98094/icemanind"}, "edited": false, "score": 1, "creation_date": 1507751412, "post_id": 46696341, "comment_id": 80340561, "body": "Look here: <a href=\"https://stackoverflow.com/questions/5223834/how-to-print-msg-into-pdf\" title=\"how to print msg into pdf\">stackoverflow.com/questions/5223834/how-to-print-msg-into-pd&zwnj;&#8203;f</a>"}, {"owner": {"reputation": 49, "user_id": 8473644, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4c34a3b862ec78be7c6154eafcda833?s=128&d=identicon&r=PG&f=1", "display_name": "Taborator", "link": "https://stackoverflow.com/users/8473644/taborator"}, "edited": false, "score": 1, "creation_date": 1507751526, "post_id": 46696341, "comment_id": 80340627, "body": "And the Stack Overflow stereotypes continue. Linking to another thread that&#39;s, for certain, already been looked at.  That doesn&#39;t help, unfortunately."}, {"owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "edited": false, "score": 2, "creation_date": 1507751649, "post_id": 46696341, "comment_id": 80340687, "body": "but it is a duplicate of <a href=\"https://stackoverflow.com/questions/5223834/how-to-print-msg-into-pdf\">How to print .MSG into PDF</a>. for a no-code question, mainly about libraries, this will be as good as it gets :) edit a more specific problem into your question, and something useful may become of it."}, {"owner": {"reputation": 43527, "user_id": 98094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VkdLW.jpg?s=128&g=1", "display_name": "Icemanind", "link": "https://stackoverflow.com/users/98094/icemanind"}, "edited": false, "score": 0, "creation_date": 1507751694, "post_id": 46696341, "comment_id": 80340711, "body": "How does the link not help? One answer tells you how to do it and another answers gives you actual code to do it"}, {"owner": {"reputation": 49, "user_id": 8473644, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4c34a3b862ec78be7c6154eafcda833?s=128&d=identicon&r=PG&f=1", "display_name": "Taborator", "link": "https://stackoverflow.com/users/8473644/taborator"}, "edited": false, "score": 0, "creation_date": 1507751747, "post_id": 46696341, "comment_id": 80340749, "body": "Not in C#. The other answer is vague, simply stating that PDFSharp could potentially be used.   The other answer is using Aspose. I&#39;m specifically asking if there&#39;s a way to implement this in C# using the PDFSharp library."}, {"owner": {"reputation": 7510, "user_id": 1132334, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8o6Nl.png?s=128&g=1", "display_name": "Cee McSharpface", "link": "https://stackoverflow.com/users/1132334/cee-mcsharpface"}, "edited": false, "score": 0, "creation_date": 1507751813, "post_id": 46696341, "comment_id": 80340790, "body": "to which the vague answer is &quot;basically yes, but you will need to convert msg into one of the possible input formats that this library accepts&quot;. one way is to use outlook automation to save the msg as html, and go from there, <a href=\"https://stackoverflow.com/questions/5223834/how-to-print-msg-into-pdf\">as described here</a>. But then, modern versions of outlook can save to pdf themselves, so probably outlook is not a viable option?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 2, "creation_date": 1507753669, "post_id": 46696341, "comment_id": 80341678, "body": "@Taborator we have no idea what you have or have not looked at.  Did you state somewhere in your question that you had looked at that question?  If so please point it out.  It&#39;s disappointing that &quot;attempting to be helpful&quot; is considered a stereotype."}], "answers": [{"tags": [], "owner": {"reputation": 18344, "user_id": 162529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWVD6.png?s=128&g=1", "display_name": "I liked the old Stack Overflow", "link": "https://stackoverflow.com/users/162529/i-liked-the-old-stack-overflow"}, "is_accepted": false, "score": -1, "last_activity_date": 1507796606, "last_edit_date": 1507796606, "creation_date": 1507796279, "answer_id": 46704699, "question_id": 46696341, "link": "https://stackoverflow.com/questions/46696341/convert-msg-to-pdf-programmatically-in-c/46704699#46704699", "title": "Convert .msg to .pdf programmatically in C#", "body": "<p>To answer the question: PDFsharp creates PDF files without annoying message boxes. Yes, it can be done.</p>\n\n<p>Parsing the Outlook MSG files and extracting the text is up to you. The other thread suggests using Outlook Redemption, a tool I am not familiar with.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 8473644, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4c34a3b862ec78be7c6154eafcda833?s=128&d=identicon&r=PG&f=1", "display_name": "Taborator", "link": "https://stackoverflow.com/users/8473644/taborator"}, "edited": false, "score": 0, "creation_date": 1507909919, "post_id": 46733626, "comment_id": 80413837, "body": "Unfortunately, I figured out that the dialogue box I&#39;m seeing isn&#39;t from UDC. I&#39;ve already disabled all notifications in its user interface. This &quot;Printing...&quot; dialogue box is handled by Windows. It shows up no matter what printer you&#39;re using, virtual or real."}, {"owner": {"reputation": 41, "user_id": 3861014, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001972481387/picture?type=large", "display_name": "Mikhael Bolgov", "link": "https://stackoverflow.com/users/3861014/mikhael-bolgov"}, "reply_to_user": {"reputation": 49, "user_id": 8473644, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4c34a3b862ec78be7c6154eafcda833?s=128&d=identicon&r=PG&f=1", "display_name": "Taborator", "link": "https://stackoverflow.com/users/8473644/taborator"}, "edited": false, "score": 0, "creation_date": 1507910426, "post_id": 46733626, "comment_id": 80414131, "body": "OK, try use FolderMill then. It converts MSG files to PDF without virtual printing technology usage."}, {"owner": {"reputation": 49, "user_id": 8473644, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4c34a3b862ec78be7c6154eafcda833?s=128&d=identicon&r=PG&f=1", "display_name": "Taborator", "link": "https://stackoverflow.com/users/8473644/taborator"}, "edited": false, "score": 0, "creation_date": 1507910509, "post_id": 46733626, "comment_id": 80414187, "body": "For reasons I can&#39;t really disclose, I cannot use any third party software. Assemblies and libraries are okay, but not outside software."}], "tags": [], "owner": {"reputation": 41, "user_id": 3861014, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001972481387/picture?type=large", "display_name": "Mikhael Bolgov", "link": "https://stackoverflow.com/users/3861014/mikhael-bolgov"}, "is_accepted": false, "score": 1, "last_activity_date": 1507909715, "creation_date": 1507909715, "answer_id": 46733626, "question_id": 46696341, "link": "https://stackoverflow.com/questions/46696341/convert-msg-to-pdf-programmatically-in-c/46733626#46733626", "title": "Convert .msg to .pdf programmatically in C#", "body": "<p>Actually in the most recent version of Universal Document Converter it is possible to get rid of that dialogue:</p>\n\n<p>1) open UDC preferences window and go to \"Advanced\" section</p>\n\n<p>2) Uncheck \"Show progress window while processing\" feature</p>\n\n<p>3) Go to \"Output location\" section and check \"Use predefined location and file name\"</p>\n\n<p>By the way, I advise you to try use <a href=\"https://www.foldermill.com/\" rel=\"nofollow noreferrer\">FolderMill</a> software. It works by monitoring hot folder. So you just copy source MSG files to the \"Hot Folder\" FolderMill monitors. And it will automatically convert all incoming files to PDF with no user interaction.</p>\n"}], "owner": {"reputation": 49, "user_id": 8473644, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4c34a3b862ec78be7c6154eafcda833?s=128&d=identicon&r=PG&f=1", "display_name": "Taborator", "link": "https://stackoverflow.com/users/8473644/taborator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3902, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1560924775, "creation_date": 1507751173, "last_edit_date": 1560924775, "question_id": 46696341, "link": "https://stackoverflow.com/questions/46696341/convert-msg-to-pdf-programmatically-in-c", "title": "Convert .msg to .pdf programmatically in C#", "body": "<p>I've been trying to convert a large batch of .msg files into .pdf. So far, I've been able to leverage the Universal Document Converter and its libraries, but there's an issue: because it's basically a printer, it pops up a small dialogue box in the background between the conversion of each file, momentarily holding up the system.</p>\n\n<p>I need this to be completely set-and-forget, running silently in the background. I have upwards of 3,600 messages to convert at once, and this happens at least weekly.</p>\n\n<p>I've utilized the PDFsharp libraries before, but I'm still really new to them. Is it possible PDFsharp can do this, without the annoying dialogue boxes?</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["c#", "uwp", "windows-runtime"], "comments": [{"owner": {"reputation": 839, "user_id": 7958307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f6efbadbbb01ffa0461b1b9f7d2f71?s=128&d=identicon&r=PG&f=1", "display_name": "Kostya", "link": "https://stackoverflow.com/users/7958307/kostya"}, "edited": false, "score": 0, "creation_date": 1507751820, "post_id": 46696314, "comment_id": 80340798, "body": "Use <code>PickSingleFileAndContinue()</code> instead?"}, {"owner": {"reputation": 839, "user_id": 7958307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5f6efbadbbb01ffa0461b1b9f7d2f71?s=128&d=identicon&r=PG&f=1", "display_name": "Kostya", "link": "https://stackoverflow.com/users/7958307/kostya"}, "edited": false, "score": 0, "creation_date": 1507752091, "post_id": 46696314, "comment_id": 80340952, "body": "Or check this one <a href=\"https://www.codeproject.com/Tips/1179716/Extending-Content-Message-Dialog-Class-in-UWP-to-A\" rel=\"nofollow noreferrer\">codeproject.com/Tips/1179716/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29042, "user_id": 2681948, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NUQlM.jpg?s=128&g=1", "display_name": "Romasz", "link": "https://stackoverflow.com/users/2681948/romasz"}, "is_accepted": false, "score": 2, "last_activity_date": 1507754864, "creation_date": 1507754864, "answer_id": 46697277, "question_id": 46696314, "link": "https://stackoverflow.com/questions/46696314/fileopenpicker-opening-twice-on-doubleclick/46697277#46697277", "title": "FileOpenPicker opening twice on doubleclick", "body": "<p>There are couple of options to solve this issue, first may be to use <em>Semaphore/SemaphoreSlim</em> and await it. Second - at the begginging of the event unsubscribe it, do work, then subscribe:</p>\n\n<pre><code>private\u00a0async\u00a0void\u00a0openBtn_Click(object\u00a0sender,\u00a0RoutedEventArgs\u00a0e)\u00a0\u00a0\n{\u00a0\u00a0\n    var button = sender as Button;\n    button.Clik -= openBtn_Click;\n    FileOpenPicker\u00a0openPicker\u00a0=\u00a0new\u00a0FileOpenPicker();\u00a0\u00a0\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0StorageFile\u00a0file\u00a0=\u00a0await\u00a0openPicker.PickSingleFileAsync();\n    // do smth\n    button.Clik += openBtn_Click;\n</code></pre>\n"}], "owner": {"reputation": 943, "user_id": 967565, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/BtGgS.jpg?s=128&g=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/967565/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507758407, "creation_date": 1507751087, "last_edit_date": 1507758407, "question_id": 46696314, "link": "https://stackoverflow.com/questions/46696314/fileopenpicker-opening-twice-on-doubleclick", "title": "FileOpenPicker opening twice on doubleclick", "body": "<p>Examples always show something like this:</p>\n\n<pre><code>private\u00a0async\u00a0void\u00a0openBtn_Click(object\u00a0sender,\u00a0RoutedEventArgs\u00a0e)\u00a0\u00a0\n{\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0FileOpenPicker\u00a0openPicker\u00a0=\u00a0new\u00a0FileOpenPicker();\u00a0\u00a0\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0StorageFile\u00a0file\u00a0=\u00a0await\u00a0openPicker.PickSingleFileAsync();\u00a0\u00a0\n}\n</code></pre>\n\n<p>But if the user clicks twice it will open two picker windows. Is that really the right way?</p>\n"}, {"tags": ["c#", "properties"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 2, "creation_date": 1507751395, "post_id": 46696281, "comment_id": 80340547, "body": "Why do you think that <code>Page</code> is a value type?"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1507751622, "post_id": 46696281, "comment_id": 80340674, "body": "You seem to have some inconsistent <code>Page</code>/<code>page</code> issues here."}, {"owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1507751960, "post_id": 46696281, "comment_id": 80340871, "body": "@crashmstr good catch - fixed"}], "answers": [{"tags": [], "owner": {"reputation": 507, "user_id": 5817136, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9b2ab95c30a057160a821a073a1c4a1e?s=128&d=identicon&r=PG", "display_name": "Iman", "link": "https://stackoverflow.com/users/5817136/iman"}, "is_accepted": true, "score": 0, "last_activity_date": 1510263173, "last_edit_date": 1510263173, "creation_date": 1507756172, "answer_id": 46697593, "question_id": 46696281, "link": "https://stackoverflow.com/questions/46696281/expose-sub-objects-through-a-property/46697593#46697593", "title": "Expose sub objects through a property", "body": "<p>I can directly access the value of the child like this. </p>\n\n<pre><code>public class Page\n    {\n        public Page Child { get; set; }\n        public string PageNumber { get; set; }\n    }\n    private static void Main()\n    {\n        var page1 = new Page {PageNumber = \"1\"};\n        var page2 = new Page {PageNumber = \"2\"};\n        var page3 = new Page {PageNumber = \"3\"};\n        page1.Child = page2;\n        page2.Child = page3;\n\n        var x = page1.Child.Child.PageNumber;\n\n        Console.WriteLine(x);\n    }\n</code></pre>\n"}], "owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 46697593, "answer_count": 1, "score": 1, "last_activity_date": 1510263173, "creation_date": 1507750940, "last_edit_date": 1507751907, "question_id": 46696281, "link": "https://stackoverflow.com/questions/46696281/expose-sub-objects-through-a-property", "title": "Expose sub objects through a property", "body": "<p>I'm modeling an API for a client application.  As part of this i'm trying to build a cache that maintains the structure/map of the API as it crawls it (I have to crawl this API, its just that way :(  )</p>\n\n<p>So what I want to do is build a model object like this:</p>\n\n<pre><code> page1\n  |\n  |__page2\n        |\n        |_page3\n</code></pre>\n\n<p>So if each page is an object and each object contains a property for child then I can have a repeating set of classes that all look like:</p>\n\n<pre><code>public class Page\n{\n   public Page Child { get; set; }\n}\n</code></pre>\n\n<p>So <code>page1.Child</code> = <code>page2</code>, <code>page2.Child</code> = <code>page3</code></p>\n\n<p>On my class where I construct the Cache i'd like to expose the current page like:</p>\n\n<pre><code>public class Cache\n{\n   public Page CurrentPage { get; set; }\n\n   public Cache(){\n      //logic to construct cache\n   }\n   // add, delete Page logic\n}\n</code></pre>\n\n<p>So if I load my CurrentPage variable like:\n  <code>cache.CurrentPage = page1.Child.Child</code></p>\n\n<p>I'll get a value type copy of the child.  So how do I instead expose the member so that I can operate on the original object instead.  The idea here is that I wan't to be able to work on the current page of the cache without actually having to know where I am in the cache. </p>\n"}, {"tags": ["c#", "entity-framework", "unit-testing", "poco"], "comments": [{"owner": {"reputation": 1732, "user_id": 43754, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/92405e88dfc1d780af16bce6ce22a3d6?s=128&d=identicon&r=PG", "display_name": "Rick Ratayczak", "link": "https://stackoverflow.com/users/43754/rick-ratayczak"}, "edited": false, "score": 0, "creation_date": 1507752605, "post_id": 46696189, "comment_id": 80341211, "body": "I would leave the fake context as a &quot;one time&quot; generation and customize it."}, {"owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "reply_to_user": {"reputation": 1732, "user_id": 43754, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/92405e88dfc1d780af16bce6ce22a3d6?s=128&d=identicon&r=PG", "display_name": "Rick Ratayczak", "link": "https://stackoverflow.com/users/43754/rick-ratayczak"}, "edited": false, "score": 0, "creation_date": 1507784406, "post_id": 46696189, "comment_id": 80350474, "body": "How would I do that?"}, {"owner": {"reputation": 1732, "user_id": 43754, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/92405e88dfc1d780af16bce6ce22a3d6?s=128&d=identicon&r=PG", "display_name": "Rick Ratayczak", "link": "https://stackoverflow.com/users/43754/rick-ratayczak"}, "edited": false, "score": 0, "creation_date": 1507784454, "post_id": 46696189, "comment_id": 80350487, "body": "Move the context out. Then fill in the blanks from the original."}, {"owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "reply_to_user": {"reputation": 1732, "user_id": 43754, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/92405e88dfc1d780af16bce6ce22a3d6?s=128&d=identicon&r=PG", "display_name": "Rick Ratayczak", "link": "https://stackoverflow.com/users/43754/rick-ratayczak"}, "edited": false, "score": 0, "creation_date": 1507841904, "post_id": 46696189, "comment_id": 80383981, "body": "This file is auto generated I can&#39;t modify that code... It will get overwritten next time someone clicks save..."}, {"owner": {"reputation": 1732, "user_id": 43754, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/92405e88dfc1d780af16bce6ce22a3d6?s=128&d=identicon&r=PG", "display_name": "Rick Ratayczak", "link": "https://stackoverflow.com/users/43754/rick-ratayczak"}, "edited": false, "score": 0, "creation_date": 1507844039, "post_id": 46696189, "comment_id": 80385031, "body": "yes. but, you would have to move it somewhere else, and then when someone clicks save, delete the newly generated copy."}], "answers": [{"tags": [], "owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "is_accepted": false, "score": 0, "last_activity_date": 1508778496, "creation_date": 1508778496, "answer_id": 46894858, "question_id": 46696189, "link": "https://stackoverflow.com/questions/46696189/ef-reverse-poco-generator-unit-test/46894858#46894858", "title": "EF reverse POCO generator Unit Test", "body": "<p>i figured it out. You can write code in <strong>EF.Reverse.POCO.ttinclude</strong> file which will be regenerated. Open that file and locate function <strong>Set()</strong> then you can write something like this to get desired functionality. Hope this will be helpful to someone. </p>\n\n<pre><code>public System.Data.Entity.DbSet&lt;TEntity&gt; Set&lt;TEntity&gt;() where TEntity : \nclass\n    {\n&lt;#\nforeach (Table tbl in from t in tables.Where(t =&gt; !t.IsMapping &amp;&amp; \nt.HasPrimaryKey).OrderBy(x =&gt; x.NameHumanCase) select t)\n{\n#&gt;\n\n\n        if(typeof(TEntity) == typeof(&lt;#=tbl.NameHumanCaseWithSuffix #&gt;))\n        {\n            return &lt;#=Inflector.MakePlural(tbl.NameHumanCase) #&gt; as \nSystem.Data.Entity.DbSet&lt;TEntity&gt;;\n        }\n\n&lt;# } #&gt;\n\n        throw new System.NotImplementedException(\"Doesn't have this table type!\");\n     }\n</code></pre>\n"}], "owner": {"reputation": 1904, "user_id": 2015971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0d00720da7357eaaf24d2f6dd99b1a74?s=128&d=identicon&r=PG", "display_name": "Farukh", "link": "https://stackoverflow.com/users/2015971/farukh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508778496, "creation_date": 1507750588, "question_id": 46696189, "link": "https://stackoverflow.com/questions/46696189/ef-reverse-poco-generator-unit-test", "title": "EF reverse POCO generator Unit Test", "body": "<p>I am using <a href=\"https://marketplace.visualstudio.com/items?itemName=SimonHughes.EntityFrameworkReversePOCOGenerator\" rel=\"nofollow noreferrer\">EntityFramework Reverse POCO Generator</a> which has a flag</p>\n\n<pre><code>AddUnitTestingDbContext = true; // Will add a FakeDbContext and FakeDbSet for easy unit testing\n</code></pre>\n\n<p>It creates <strong>FakeDbContext</strong> and <strong>FakeDbSet</strong> for unit testing, but inside <strong>FakeDbContext</strong> some of the methods are not implemented. </p>\n\n<pre><code> public System.Data.Entity.Infrastructure.DbEntityEntry&lt;TEntity&gt; Entry&lt;TEntity&gt;(TEntity entity) where TEntity : class\n    {\n        throw new System.NotImplementedException();\n    }\n    public System.Data.Entity.Infrastructure.DbEntityEntry Entry(object entity)\n    {\n        throw new System.NotImplementedException();\n    }\n    public System.Collections.Generic.IEnumerable&lt;System.Data.Entity.Validation.DbEntityValidationResult&gt; GetValidationErrors()\n    {\n        throw new System.NotImplementedException();\n    }\n    public System.Data.Entity.DbSet Set(System.Type entityType)\n    {\n        throw new System.NotImplementedException();\n    }\n    public System.Data.Entity.DbSet&lt;TEntity&gt; Set&lt;TEntity&gt;() where TEntity : class\n    {\n        throw new System.NotImplementedException();\n    }\n    public override string ToString()\n    {\n        throw new System.NotImplementedException();\n    }\n</code></pre>\n\n<p>What would be the correct way to overwrite them or implement them so that I can use those calls in my unit tests. </p>\n\n<p>Thank you for your time. </p>\n"}, {"tags": ["c#", "datagridview"], "answers": [{"tags": [], "owner": {"reputation": 783, "user_id": 2152078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e339c1632e33d8fa567c8daa62e40637?s=128&d=identicon&r=PG", "display_name": "Rick Davin", "link": "https://stackoverflow.com/users/2152078/rick-davin"}, "is_accepted": false, "score": 0, "last_activity_date": 1507751674, "creation_date": 1507751674, "answer_id": 46696462, "question_id": 46696185, "link": "https://stackoverflow.com/questions/46696185/populate-datagridview-by-passing-column-and-row-name/46696462#46696462", "title": "Populate datagridview by passing column and row name", "body": "<p>DataGridView has a CurrentCell property that includes a RowIndex and ColumnIndex.</p>\n\n<p>There is also the CellEnter event where the DataGridViewCellEventArgs includes a RowIndex and ColumnIndex.</p>\n\n<p>There is the Rows and Columns properties that have overloads to accept an index or a name.  However, there is a difference between the name of a column and the column heading.  In your case \"<strong>31 - SEGUROS</strong>\" is heading of the column and not its name.  Each Column object has a HeaderText property.</p>\n\n<p>If a column or row is not selected, its index will be -1.</p>\n"}, {"tags": [], "owner": {"reputation": 1428, "user_id": 3260548, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/8uqgR.png?s=128&g=1", "display_name": "Oak_3260548", "link": "https://stackoverflow.com/users/3260548/oak-3260548"}, "is_accepted": false, "score": 0, "last_activity_date": 1507752649, "last_edit_date": 1507752649, "creation_date": 1507751776, "answer_id": 46696489, "question_id": 46696185, "link": "https://stackoverflow.com/questions/46696185/populate-datagridview-by-passing-column-and-row-name/46696489#46696489", "title": "Populate datagridview by passing column and row name", "body": "<p>Are you looking for row and column indexing? I read your question three times and still it looks like it...</p>\n\n<p>VB.NET:</p>\n\n<pre><code>    Dim MyVal = 1234\n    Dim ColIdx = 5\n    Dim RowIdx = 10\n    Me.DataGridView1.Rows(RowIdx).Cells(ColIdx).Value = MyVal\n</code></pre>\n\n<p>C#:</p>\n\n<pre><code>    Dynamic MyVal = 1234;\n    Dynamic ColIdx = 5;\n    Dynamic RowIdx = 10;\n    this.DataGridView1.Rows(RowIdx).Cells(ColIdx).Value = MyVal;\n</code></pre>\n\n<p>You can also address the rows and cells by their names, simply putting their name into double quotes.</p>\n\n<p>To get column index by name of a column (not text in the heading):</p>\n\n<p>VB.NET:</p>\n\n<pre><code>Private Function GetColIdx(MyStringName As String)\n    Dim ColIdx As Int16\n    For ic = 0 To Me.DataGridView1.Columns.Count - 1\n        Dim dc As DataGridViewColumn = Me.DataGridView1.Rows(ic)\n        If dc.Name = MyStringName Then\n            ColIdx = ic\n            Exit For\n        End If\n    Next\n    Return ColIdx\nEnd Function\n</code></pre>\n\n<p>C#:</p>\n\n<pre><code>Private Object GetColIdx(String MyStringName)\n{\n    Int16 ColIdx = default(Int16);\n    For (ic = 0; ic &lt;= this.DataGridView1.Columns.Count - 1; ic++) {\n        DataGridViewColumn dc = this.DataGridView1.Rows(ic);\n        If (dc.Name == MyStringName) {\n            ColIdx = ic;\n            break; \n        }\n    }\n    Return ColIdx;\n}\n</code></pre>\n\n<p>To get column index, you then simply call (C#) the function with the <strong>name</strong> of the column:</p>\n\n<pre><code>GetColIdx(\"SEGUROS\")\n</code></pre>\n\n<p>Similar function can get row by name. Though it is very uncommon to use row names, it is possible. It can also be modified to match text in the heading, but names are more safe.</p>\n"}], "owner": {"reputation": 309, "user_id": 6181859, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1b332853d7bc07ce9e24166d28e1b141?s=128&d=identicon&r=PG&f=1", "display_name": "G. Sena", "link": "https://stackoverflow.com/users/6181859/g-sena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507752649, "creation_date": 1507750558, "question_id": 46696185, "link": "https://stackoverflow.com/questions/46696185/populate-datagridview-by-passing-column-and-row-name", "title": "Populate datagridview by passing column and row name", "body": "<p>I have the DataGridView below and I need to check the cell according to the receipt of some files, I am looking for the best way to do this and I thought it would be possible to insert a value in the cell by the name of the column and the name of the row</p>\n\n<p><a href=\"https://i.stack.imgur.com/uHvc2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uHvc2.png\" alt=\"enter image description here\"></a></p>\n\n<p>The positions are</p>\n\n<p><a href=\"https://i.stack.imgur.com/DfTDl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DfTDl.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I wanted to mark the position 0,0 I would look for <strong>31 - SEGUROS</strong> (Name of the column) and <strong>01</strong> (Name of row) and then it would be marked the cell 0,0</p>\n\n<p>It is possible?</p>\n"}, {"tags": ["c#", "json"], "comments": [{"owner": {"reputation": 542, "user_id": 1563677, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a479a5c1533895a87c1266d4d587d6ad?s=128&d=identicon&r=PG", "display_name": "user1563677", "link": "https://stackoverflow.com/users/1563677/user1563677"}, "reply_to_user": {"reputation": 1032, "user_id": 7919890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1hAL5.png?s=128&g=1", "display_name": "wha7ever", "link": "https://stackoverflow.com/users/7919890/wha7ever"}, "edited": false, "score": 0, "creation_date": 1507812295, "post_id": 46696142, "comment_id": 80366316, "body": "see my updated question. Looks like my array is not constructing right. Is there some issue in how i send data to my controller"}], "answers": [{"comments": [{"owner": {"reputation": 542, "user_id": 1563677, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a479a5c1533895a87c1266d4d587d6ad?s=128&d=identicon&r=PG", "display_name": "user1563677", "link": "https://stackoverflow.com/users/1563677/user1563677"}, "edited": false, "score": 0, "creation_date": 1507810157, "post_id": 46697858, "comment_id": 80364767, "body": "This throw error: CS1579\tforeach statement cannot operate on variables of type &#39;object&#39; because &#39;object&#39; does not contain a public definition for &#39;GetEnumerator&#39;"}], "tags": [], "owner": {"reputation": 3457, "user_id": 1143681, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/1Q8mW.png?s=128&g=1", "display_name": "smoore4", "link": "https://stackoverflow.com/users/1143681/smoore4"}, "is_accepted": false, "score": 0, "last_activity_date": 1507757343, "creation_date": 1507757343, "answer_id": 46697858, "question_id": 46696142, "link": "https://stackoverflow.com/questions/46696142/parse-json-array-data/46697858#46697858", "title": "Parse json array data", "body": "<p>Since JArray is <a href=\"https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_Linq_JArray.htm\" rel=\"nofollow noreferrer\">Newtonsoft</a>, you can use something like this to deserialize and then loop through the results:</p>\n\n<pre><code>var m_json = JsonConvert.DeserializeObject(ar);\n\nforeach (var item in m_json)\n{\n  Console.Write(item.name);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 542, "user_id": 1563677, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a479a5c1533895a87c1266d4d587d6ad?s=128&d=identicon&r=PG", "display_name": "user1563677", "link": "https://stackoverflow.com/users/1563677/user1563677"}, "edited": false, "score": 0, "creation_date": 1507814404, "post_id": 46710228, "comment_id": 80367756, "body": "Thank you very much. That did it. I have also updated my code to use proper data models."}], "tags": [], "owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "is_accepted": true, "score": 3, "last_activity_date": 1507813056, "creation_date": 1507813056, "answer_id": 46710228, "question_id": 46696142, "link": "https://stackoverflow.com/questions/46696142/parse-json-array-data/46710228#46710228", "title": "Parse json array data", "body": "<p>You need to cast to the correct type to enumerate:</p>\n\n<pre><code>using Newtonsoft.Json;\nusing Newtonsoft.Json.Linq;\n\nstring ar = \"[{\\\"id\\\":\\\"1\\\",\\\"name\\\":\\\"John\\\"},{\\\"id\\\":\\\"2\\\",\\\"name\\\":\\\"Steve\\\"}]\";\n\nvar obj = JsonConvert.DeserializeObject(ar);\n\nforeach (var item in ((JArray)obj))\n{\n    Console.WriteLine(\n        string.Format(\"id:{0}, name:{1}\",\n                        item.Value&lt;int&gt;(\"id\"),\n                        item.Value&lt;string&gt;(\"name\")));\n}\n</code></pre>\n\n<p>output  </p>\n\n<pre><code>id:1, name:John\nid:2, name:Steve\n</code></pre>\n\n<p>But I would really recommend synchronizing your front and back end data models  </p>\n\n<pre><code>public class Person\n{\n    [JsonProperty(PropertyName = \"id\")]\n    public int Id { get; set; }\n\n    [JsonProperty(PropertyName = \"name\")]\n    public string Name { get; set; }\n}\n\nvar obj = JsonConvert.DeserializeObject&lt;List&lt;Person&gt;&gt;(ar);\n\nforeach (var person in obj)\n{\n    Console.WriteLine(\n        string.Format(\"id:{0}, name:{1}\",\n                        person.Id,\n                        person.Name));\n}\n</code></pre>\n\n<p>output   </p>\n\n<pre><code>id:1, name:John\nid:2, name:Steve\n</code></pre>\n"}], "owner": {"reputation": 542, "user_id": 1563677, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a479a5c1533895a87c1266d4d587d6ad?s=128&d=identicon&r=PG", "display_name": "user1563677", "link": "https://stackoverflow.com/users/1563677/user1563677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2296, "favorite_count": 0, "accepted_answer_id": 46710228, "answer_count": 2, "score": 0, "last_activity_date": 1507813056, "creation_date": 1507750367, "last_edit_date": 1507811764, "question_id": 46696142, "link": "https://stackoverflow.com/questions/46696142/parse-json-array-data", "title": "Parse json array data", "body": "<p>I have the following code where on button click I make a ajax call to c# controller. I also need to pass some values back to controller.</p>\n\n<pre><code>var array = JSON.stringify(myArrayList);\n\n     $.ajax({\n            type: \"POST\",                \n            dataType: 'json',\n            data: {\n                'type': vm.myType,\n                 'mod': vm.myMod,\n                 'ar' : array \n            },\n            url: rootDir + \"/Home/GetData\",                              \n            success: function (data) {\n                console.log(data);                   \n            },\n            error: function (xhr, status, error) {\n                console.log(\"Error\");\n            }                \n        });\n</code></pre>\n\n<p>And in my c# controller I have:</p>\n\n<pre><code> [HttpPost]\n    public IActionResult GetData(string type, string mod, string ar)\n    {\n       //I can get type and mod but having issues in getting my array data\n    }\n</code></pre>\n\n<p>My Array data is as below:</p>\n\n<pre><code>[{\"id\":\"1\",\"name\":\"John\"},{\"id\":\"2\",\"name\":\"Steve\"}]\n</code></pre>\n\n<p>In my loop I want to grab is and name values. I tried with </p>\n\n<pre><code>JArray v = JArray.Parse(ar);\n</code></pre>\n\n<p>But cant loop though and get the values</p>\n\n<p><strong>Updated:</strong></p>\n\n<p>I think there is issue in my json array because of which I am not able to get the values of json array in my c# controller.</p>\n\n<p>When I debug my array in java script it has values like this:</p>\n\n<pre><code>Array(2)\n0 Object\n  id: \"1\"\n  name: \"John\"\n1 Object\n  id: \"2\"\n  name: \"Steve\"\n</code></pre>\n\n<p>After I use Json.stringify as below:</p>\n\n<pre><code>var array = JSON.stringify(myArrayList);\n</code></pre>\n\n<p>Now in my C# controller I get the resultant string as:</p>\n\n<pre><code>[{\"id\":\"1\",\"name\":\"John\"},{\"id\":\"2\",\"name\":\"Steve\"}]\n</code></pre>\n\n<p>This I think is not correct because when I use the below code:\n     dynamic stuff = JObject.Parse(ar);</p>\n\n<p>It throws error: </p>\n\n<pre><code>  'Error reading JObject from JsonReader. Current JsonReader item is not an object: \n</code></pre>\n"}, {"tags": ["c#", "mono", "discord", "discord.net", "debian-jessie"], "comments": [{"owner": {"reputation": 11, "user_id": 8715646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d18be533f16f358b5c21431af64571?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Koorneweerd", "link": "https://stackoverflow.com/users/8715646/devin-koorneweerd"}, "edited": false, "score": 0, "creation_date": 1507817263, "post_id": 46696131, "comment_id": 80369858, "body": "I am not a native English speaker, editing my question seems a little rude to me..."}, {"owner": {"reputation": 688, "user_id": 7875013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRDU4.jpg?s=128&g=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/7875013/unknown"}, "edited": false, "score": 0, "creation_date": 1507860329, "post_id": 46696131, "comment_id": 80389542, "body": "Make your bot in .NET Core and then install <a href=\"https://www.microsoft.com/net/core#linuxredhat\" rel=\"nofollow noreferrer\">dotnet</a> on the Linux machine. I&#39;ve done this and it works like a charm."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6278710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TQZUCIN_DpA/AAAAAAAAAAI/AAAAAAAAAck/WIC3rgOG1OA/photo.jpg?sz=128", "display_name": "Markus Kitsinger", "link": "https://stackoverflow.com/users/6278710/markus-kitsinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1508330824, "creation_date": 1508330824, "answer_id": 46810545, "question_id": 46696131, "link": "https://stackoverflow.com/questions/46696131/hosting-c-discord-bot-on-a-debian-8-vps/46810545#46810545", "title": "Hosting C# Discord bot on a Debian 8 VPS", "body": "<p>Do you know specifically which bot you want to run? Nadeko is a C# bot, but it uses dotnet core/standard rather than Mono. Instructions for getting it up and running can be found here: <a href=\"http://nadekobot.readthedocs.io/en/latest/guides/Linux%20Guide/\" rel=\"nofollow noreferrer\">http://nadekobot.readthedocs.io/en/latest/guides/Linux%20Guide/</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9297147"}, "is_accepted": false, "score": 0, "last_activity_date": 1517441414, "creation_date": 1517441414, "answer_id": 48553148, "question_id": 46696131, "link": "https://stackoverflow.com/questions/46696131/hosting-c-discord-bot-on-a-debian-8-vps/48553148#48553148", "title": "Hosting C# Discord bot on a Debian 8 VPS", "body": "<p>If you're using a pre-existing bot, make sure it uses dotnet core or mono for cross compatability (as Markus said) - If you're making it yourself, install dotnet core and make your bot using that instead of a standard dotnet version.</p>\n\n<p>Dotnet Core: <a href=\"https://www.microsoft.com/net/learn/get-started/windows\" rel=\"nofollow noreferrer\">https://www.microsoft.com/net/learn/get-started/windows</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8715646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5d18be533f16f358b5c21431af64571?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Koorneweerd", "link": "https://stackoverflow.com/users/8715646/devin-koorneweerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1105, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1517441414, "creation_date": 1507750312, "last_edit_date": 1507810823, "question_id": 46696131, "link": "https://stackoverflow.com/questions/46696131/hosting-c-discord-bot-on-a-debian-8-vps", "title": "Hosting C# Discord bot on a Debian 8 VPS", "body": "<p>I'm trying to get my discord C# bot to host on my Debian 8 VPS. I've not worked with Linux a lot before and I tried, but can't seem to find how to run my bot/code on my VPS.</p>\n\n<p>If it's possible can a step-by-step be provided? I already installed Mono (because I've read that I need that).</p>\n\n<p>PS: Not a big coder. Using Visual Studio 2015.</p>\n"}, {"tags": ["c#", "configuration", ".net-core", "asp.net-core-webapi", "asp.net-core-2.0"], "answers": [{"comments": [{"owner": {"reputation": 2027, "user_id": 241004, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/h60RD.png?s=128&g=1", "display_name": "Jawad Al Shaikh", "link": "https://stackoverflow.com/users/241004/jawad-al-shaikh"}, "edited": false, "score": 0, "creation_date": 1507759896, "post_id": 46698285, "comment_id": 80344333, "body": "To override  hosting.json or any [name].json urls from command line, its done by .AddCommandLine(args), nothing special about hosting.json in that regards."}, {"owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "reply_to_user": {"reputation": 2027, "user_id": 241004, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/h60RD.png?s=128&g=1", "display_name": "Jawad Al Shaikh", "link": "https://stackoverflow.com/users/241004/jawad-al-shaikh"}, "edited": false, "score": 0, "creation_date": 1507760101, "post_id": 46698285, "comment_id": 80344388, "body": "I think to override hosting.json. that&#39;s what the documentation says. Also, it makes sense to have hosting.json which has specific host config other like any other jargons like db config or logging or another config details."}, {"owner": {"reputation": 2027, "user_id": 241004, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/h60RD.png?s=128&g=1", "display_name": "Jawad Al Shaikh", "link": "https://stackoverflow.com/users/241004/jawad-al-shaikh"}, "edited": false, "score": 0, "creation_date": 1507761723, "post_id": 46698285, "comment_id": 80344870, "body": "It&#39;s very common design to have single config file per app. when user plan to deploy an app, jumping between different config files to tweak or verify config params isn&#39;t nice."}, {"owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "reply_to_user": {"reputation": 2027, "user_id": 241004, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/h60RD.png?s=128&g=1", "display_name": "Jawad Al Shaikh", "link": "https://stackoverflow.com/users/241004/jawad-al-shaikh"}, "edited": false, "score": 0, "creation_date": 1507790320, "post_id": 46698285, "comment_id": 80352900, "body": "@JawadAlShaikh yes it is and I do agree."}], "tags": [], "owner": {"reputation": 166, "user_id": 7394630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f0323f0a46daa0517f721d09712519?s=128&d=identicon&r=PG&f=1", "display_name": "RJ-", "link": "https://stackoverflow.com/users/7394630/rj"}, "is_accepted": false, "score": -1, "last_activity_date": 1507760318, "last_edit_date": 1507760318, "creation_date": 1507759590, "answer_id": 46698285, "question_id": 46696115, "link": "https://stackoverflow.com/questions/46696115/whats-the-point-of-hosting-json-since-appsettings-json-is-sufficient/46698285#46698285", "title": "What&#39;s the point of hosting.json since appsettings.json is sufficient", "body": "<p>I think, <strong>hosting.json</strong> is a configuration file used specifically for asp.net core application hosting. (if you know more about hosting)</p>\n\n<p>WebHostBuilder directly maps its keys with the hosting.json file and it doesn't have the capability to load the <strong>config section</strong> as we do in normal configuration settings.</p>\n\n<p>According to link attached in your post</p>\n\n<blockquote>\n  <p>Use Configuration to configure the host. In the following example,\n  host configuration is optionally specified in a hosting.json file. Any\n  configuration loaded from the hosting.json file may be overridden by\n  command-line arguments.</p>\n</blockquote>\n\n<p>If only we explicitly us <strong>hosting.json</strong> then the WebHostBuilder configurations can be modified using dotnet command. </p>\n\n<p>for example </p>\n\n<p>dotnet run --urls \"http://*:8080\"</p>\n\n<p>this will override the urls from hostings.json file.</p>\n\n<p>Hopefully, this may give some idea.</p>\n\n<blockquote>\n  <p>PC: <strong>hosting.json</strong> can be renamed like <strong>myappsettings.json</strong> it can\n  have configuration and Web Host Builder configuration.</p>\n</blockquote>\n"}], "owner": {"reputation": 2027, "user_id": 241004, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/h60RD.png?s=128&g=1", "display_name": "Jawad Al Shaikh", "link": "https://stackoverflow.com/users/241004/jawad-al-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2643, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1507775860, "creation_date": 1507750242, "last_edit_date": 1507775860, "question_id": 46696115, "link": "https://stackoverflow.com/questions/46696115/whats-the-point-of-hosting-json-since-appsettings-json-is-sufficient", "title": "What&#39;s the point of hosting.json since appsettings.json is sufficient", "body": "<p>In .NET Core 2 Web API app, I could override configuration <code>urls</code> using <code>appsettings.json</code>, but in the <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/hosting?tabs=aspnetcore2x#overriding-configuration\" rel=\"nofollow noreferrer\">official docs</a> they introduced extra file \"hosting.json\", Why? What's the point of adding complexity?</p>\n\n<p>Below code is fully working using <code>appsettings.json</code>:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class Program\n{\n    public static void Main(string[] args)\n    {\n        BuildWebHost(args).Run();\n    }\n\n    public static IWebHost BuildWebHost(string[] args)\n    {\n        var config = new ConfigurationBuilder()\n            .SetBasePath(Directory.GetCurrentDirectory()) //see Side note below\n            .AddJsonFile(\"appsettings.json\", optional: true)\n            .AddCommandLine(args)\n            .Build();\n\n        return WebHost.CreateDefaultBuilder(args)\n            .UseConfiguration(config)\n            .UseStartup&lt;Startup&gt;()\n            .Build();\n    }\n}\n</code></pre>\n\n<p>appsettings.json content:\n</p>\n\n<pre><code>{\n  \"Logging\": {\n    \"IncludeScopes\": false,\n    \"Debug\": {\n      \"LogLevel\": {\n        \"Default\": \"Warning\"\n      }\n    },\n    \"Console\": {\n      \"LogLevel\": {\n        \"Default\": \"Warning\"\n      }\n    }\n  },\n  \"urls\": \"http://*:5005/\"\n}\n</code></pre>\n\n<p>Side note:\nCommenting <code>.SetBasePath(Directory.GetCurrentDirectory())</code> will keep VS 2017 debug mode operational (means apply <code>launchSettings.json</code>, and auto launch url) otherwise it won't. I guess its related to the <a href=\"https://github.com/aspnet/MetaPackages/blob/dev/src/Microsoft.AspNetCore/WebHost.cs#L152\" rel=\"nofollow noreferrer\">CreateDefaultBuilder</a> implementation.</p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 2, "creation_date": 1507749856, "post_id": 46695991, "comment_id": 80339765, "body": "Duplicate of <a href=\"https://stackoverflow.com/questions/3980909/microsoft-webapplication-targets-was-not-found-on-the-build-server-whats-your\">this</a> and <a href=\"https://stackoverflow.com/questions/17433904/v11-0-webapplications-microsoft-webapplication-targets-was-not-found-when-file-a\">this</a>?"}, {"owner": {"reputation": 53, "user_id": 7880813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9a531263d4a4c30ec139d98e5e50a20?s=128&d=identicon&r=PG&f=1", "display_name": "I.PSARN", "link": "https://stackoverflow.com/users/7880813/i-psarn"}, "reply_to_user": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 0, "creation_date": 1507750263, "post_id": 46695991, "comment_id": 80339951, "body": "This is not duplicate question, the other problems were for projects using VS. my problem involves MSBuild without Visual Studio."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1507780898, "post_id": 46695991, "comment_id": 80349533, "body": "You&#39;re going to find you need VS. It&#39;s pretty much essential."}, {"owner": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 0, "creation_date": 1508091398, "post_id": 46695991, "comment_id": 80462075, "body": "This is already answered in my first post but... 1. Solution: install MSBuild tools on build machine from <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=40760\" rel=\"nofollow noreferrer\">here</a>. 2. Solution: Copying the following folder from your dev machine to your build server fixes this if it&#39;s just web applications: C:\\Program Files (x86)\\MSBuild\\Microsoft\\VisualStudio\\v10.0\\WebApplications. Second solution is to upgrade to VS 2015/2017 and to install MS Build Tools on build machine."}], "owner": {"reputation": 53, "user_id": 7880813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9a531263d4a4c30ec139d98e5e50a20?s=128&d=identicon&r=PG&f=1", "display_name": "I.PSARN", "link": "https://stackoverflow.com/users/7880813/i-psarn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "closed_date": 1507750113, "answer_count": 0, "score": 0, "last_activity_date": 1507750226, "creation_date": 1507749742, "last_edit_date": 1507750226, "question_id": 46695991, "link": "https://stackoverflow.com/questions/46695991/c-build-failed-using-msbuild-without-visual-studio", "closed_reason": "Duplicate", "title": "C# Build failed using MSbuild without Visual Studio", "body": "<p>Basically, I'm trying to build my project using MSbuild inside the .NET framework.</p>\n\n<p><strong>NOTE: Visual Studio is not installed on the Windows server, however, all necessary .NET framework is installed.</strong></p>\n\n<pre><code>C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\msbuild \"D:\\myCProject\\WebApplication7.csproj\" /p:Configuration=Debug;DeployOnBuild=True;PackageAsSingleFile=False;outdir=D:\\myCProject\\Publish\n</code></pre>\n\n<p>the above command is what I'm trying to run in the MSbuild.I'm getting then this error.</p>\n\n<pre><code>Build started 10/11/2017 12:47:13 PM.\nProject \"D:\\myCProject\\WebApplication7.csproj\" on node 1 (default targets).\nD:\\myCProject\\WebApplication7.csproj(212,3): error MSB4019: The imported projec\nt \"C:\\Program Files (x86)\\MSBuild\\Microsoft\\VisualStudio\\v11.0\\WebApplications\\\nMicrosoft.WebApplication.targets\" was not found. Confirm that the path in the &lt;\nImport&gt; declaration is correct, and that the file exists on disk.\nDone Building Project \"D:\\myCProject\\WebApplication7.csproj\" (default targets)\n-- FAILED.\n\n\nBuild FAILED.\n\n\"D:\\myCProject\\WebApplication7.csproj\" (default target) (1) -&gt;\n  D:\\myCProject\\WebApplication7.csproj(212,3): error MSB4019: The imported proj\nect \"C:\\Program Files (x86)\\MSBuild\\Microsoft\\VisualStudio\\v11.0\\WebApplication\ns\\Microsoft.WebApplication.targets\" was not found. Confirm that the path in the\n &lt;Import&gt; declaration is correct, and that the file exists on disk.\n\n    0 Warning(s)\n    1 Error(s)\n</code></pre>\n\n<p>Any ideas? </p>\n\n<p><strong>I need to build the project with MSBuild without Visual Studio without errors during the build.</strong></p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "razor", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507750759, "post_id": 46695950, "comment_id": 80340201, "body": "if you want to access model properties without sending them as a routevalue, you&#39;ll need to post the form with a submit element, or perform the submit via jquery."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507751054, "post_id": 46695950, "comment_id": 80340364, "body": "@akerra So I have to change the <code>a</code> link which currently holds <code>Url.Action</code> to a form post button ?"}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507751322, "post_id": 46695950, "comment_id": 80340505, "body": "Yes, I would recommend something like &#39;&lt;input type=&quot;submit&quot; class=&quot;btn btn-accent&quot;&gt;More info&lt;/input&gt;&#39; However you&#39;ll need some way of knowing which technician was selected, so you&#39;ll probably need to set the value of a hidden div to the id of the selected technician and bind that to a new model field"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507751453, "post_id": 46695950, "comment_id": 80340582, "body": "And that hidden div would probably map to the <code>TechnicianViewModel</code>&#39;s ID property. Than I can use that ID to retrieve the entire object from the <code>Technician</code> Model"}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 1, "creation_date": 1507751606, "post_id": 46695950, "comment_id": 80340660, "body": "If I were doing it, I wouldn&#39;t use an IEnumerable&lt;Model&gt; but rather make the model contain a List&lt;Technician&gt; field and SelectedTechnicianId field (which would be the hidden div value)"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507751721, "post_id": 46695950, "comment_id": 80340727, "body": "@akerra Can you show me how you would do it, I am still learning and would be enlightened to learn better practices."}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507751817, "post_id": 46695950, "comment_id": 80340793, "body": "I will post as an answer. Give me a few."}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507752066, "post_id": 46695950, "comment_id": 80340934, "body": "is it acceptable to have their username in the routevalue? That would make things easier"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507752654, "post_id": 46695950, "comment_id": 80341231, "body": "I need the ID in the routevalue so that I can pull out their complete data from the database model."}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507753061, "post_id": 46695950, "comment_id": 80341401, "body": "oh it looks like you&#39;re saying in the question that is not allowed by the requirements."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507753232, "post_id": 46695950, "comment_id": 80341477, "body": "Sorry for not being clear, the ID has to be passed but not via a GET request, because that will cause it to be appended to the Querystring.** So the requirement of the project is usage of Clean URLS.**"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1507754230, "post_id": 46695950, "comment_id": 80341975, "body": "@UmarAftab then all your requests requiring an ID will have a temporary Id and redirected as akerra has shown, or you need to post all your requests that require an Id."}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507753531, "post_id": 46696924, "comment_id": 80341607, "body": "Will that prevent the ID from appearing in the URL ?"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1507753975, "post_id": 46696924, "comment_id": 80341831, "body": "Why do you not want the ID in the URL?"}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507754105, "post_id": 46696924, "comment_id": 80341903, "body": "try the above which uses TempData to pass the guid along while cleansing the URL"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507754175, "post_id": 46696924, "comment_id": 80341946, "body": "Because thats what I have been asked by the manager to do. He does not want to see any question marks in the url. I adviced him that it does not affect google listing in anyway. However, this is my current situation and this is the requirement I have been asked to comply with."}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 1, "creation_date": 1507754274, "post_id": 46696924, "comment_id": 80341996, "body": "if hes only worried about question marks, passing the id as a parameter won&#39;t add one, because it&#39;s a registered route configuration. The url would look like .../Technician/Profile/1233-12312-4322-4322-2342. But the edited answer I provided should look like .../Technician/Profile. Note I have not tested it."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507754443, "post_id": 46696924, "comment_id": 80342094, "body": "If what you have provided works, I will definitely mark that as the answer. I will try it out."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507756759, "post_id": 46696924, "comment_id": 80343138, "body": "The url of the pages come up as /Technician/Profile/1233-12312-4322-4322-2342 with the following error on the page : <code>AmbiguousActionException: Multiple actions matched. The following actions matched route data and had all constraints satisfied:</code>"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507818105, "post_id": 46696924, "comment_id": 80370446, "body": "Ok I figured that one out, but how can I keep the <code>[Route]</code> parameter as the url needs to show the technician&#39;s name."}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507820665, "post_id": 46696924, "comment_id": 80372299, "body": "you need to add username as a routevalue, and then edit the parameters of the controller method to match. If the username is unique, I&#39;d suggest avoiding the redirect stuff and just find the technician based on username instead of guid (pass the username as the id instead of the guid, then create a TechnicianRepository.GetByUsername method)."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507820930, "post_id": 46696924, "comment_id": 80372510, "body": "Oh man, that is awesome. Thanks a lot @akerra , I do not know why I did not think of that before."}], "tags": [], "owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "is_accepted": true, "score": 0, "last_activity_date": 1507754050, "last_edit_date": 1507754050, "creation_date": 1507753435, "answer_id": 46696924, "question_id": 46695950, "link": "https://stackoverflow.com/questions/46695950/how-to-get-the-view-to-return-the-id-via-a-viewmodel-to-the-controller/46696924#46696924", "title": "How to get the View to return the ID via a ViewModel to the controller?", "body": "<p>In your View, change the link to the following:</p>\n\n<pre><code>&lt;a href=\"@Url.Action(\"Profile\",\"Technician\",new { id = item.ID.ToString() })\" class=\"btn btn-accent\"&gt;More info&lt;/a&gt;\n</code></pre>\n\n<p>You can get rid of the HttpGet and Route decorators on your controller method. Those will be taken care of by the default routing config:</p>\n\n<pre><code>public ActionResult Profile(string id)\n{\n    TempData[\"guid\"] = id;\n    return RedirectToAction(\"Profile\");\n}\n\npublic ActionResult Profile()\n{\n    Guid guid = Guid.Parse(TempData[\"guid\"]);\n    var Profile = unitOfWork.TechnicianRepository.GetByGuidId(guid);\n    return View(Profile);\n}\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 46696924, "answer_count": 1, "score": 1, "last_activity_date": 1507754297, "creation_date": 1507749569, "last_edit_date": 1507754297, "question_id": 46695950, "link": "https://stackoverflow.com/questions/46695950/how-to-get-the-view-to-return-the-id-via-a-viewmodel-to-the-controller", "title": "How to get the View to return the ID via a ViewModel to the controller?", "body": "<p>I currently have a view which returns an <code>IEnumerable</code> collection of Technicians via the <code>TechnicianViewModel</code>. The view model populates fine and displays the objects correctly. </p>\n\n<p>However, at the moment I need someone to point me in the right direction with regards to selecting a specific technician. </p>\n\n<p>If I was to click <code>More Info</code> on the technician, an <code>[HttpGet]</code> request would be initiated which would result in a queryString. And this is exactly what is against the requirements of this project.(Requirements of the project: no query string should appear in the URL)</p>\n\n<p>Here is the view :- </p>\n\n<pre><code>  @model IEnumerable&lt;ActionAugerMVC.ViewModels.TechnicianViewModel&gt;\n  &lt;div class=\"row\"&gt;\n        @foreach (var item in Model)\n        {\n            &lt;div class=\"col-sm-6 col-md-3\"&gt;\n                &lt;div class=\"\"&gt;\n                    &lt;div class=\"\"&gt;\n                        &lt;div class=\"\"&gt;\n                           @item.UserName\n                        &lt;/div&gt;\n                        &lt;div class=\"\"&gt;\n                            Technician\n                        &lt;/div&gt;\n                    &lt;/div&gt; \n                    &lt;div class=\"\"&gt;\n                        &lt;img src=\"~\\imagesurl-@item.GenerateName()\" class=\"img-responsive\" alt=\"...\"&gt;\n                    &lt;/div&gt;\n                    &lt;div class=\"\"&gt;\n                        &lt;p class=\"overlay__desc\"&gt;\n                           @item.Bio\n                        &lt;/p&gt;\n                        &lt;ul class=\"overlay__social\"&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;&lt;i class=\"ion-social-twitter\"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;&lt;i class=\"ion-social-facebook\"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;&lt;i class=\"ion-social-skype\"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;&lt;i class=\"ion-social-whatsapp-outline\"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/li&gt;\n                        &lt;/ul&gt;\n                        &lt;a href=\"@Url.Action(\"Profile\",\"Technician\",new { url = item.GenerateURL() })\" class=\"btn btn-accent\"&gt;More info&lt;/a&gt;\n\n\n                    &lt;/div&gt; \n                &lt;/div&gt; \n            &lt;/div&gt;\n        }\n        &lt;/div&gt; &lt;!-- / .row --&gt;\n</code></pre>\n\n<p>Here is the View Model :-</p>\n\n<pre><code> public class TechnicianViewModel\n {\n public Guid ID { get; set; }\n public string UserName { get; set; }\n public string Bio { get; set; }\n public string GenerateName()\n {\n    string str = GenerateURL();\n    str = str + \".jpg\";\n    return str;\n }\n public string GenerateURL()\n {\n    string phrase = string.Format(\"{0}\", UserName);\n    string str = phrase.ToLower();\n    str = Regex.Replace(str, @\"\\s\", \"-\");\n    return str;\n }\n}\n</code></pre>\n\n<p>How can I avoid my controller method being an <code>[HttpGet]</code> as I had implemented here so that I can have the ID from the viewmodel object returned by the view.</p>\n\n<pre><code>        [HttpGet]\n    [Route(\"technician/profile/calgary-{url}\")]\n    public IActionResult Profile(Guid? ID,string url)\n    {\n        var Profile = unitOfWork.TechnicianRepository.GetByGuidId(ID);\n        return View(Profile);\n    }\n</code></pre>\n"}, {"tags": ["c#", "oop", "casting"], "comments": [{"owner": {"reputation": 3255, "user_id": 2134021, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/6vRxL.png?s=128&g=1", "display_name": "Marshall Tigerus", "link": "https://stackoverflow.com/users/2134021/marshall-tigerus"}, "edited": false, "score": 4, "creation_date": 1507749356, "post_id": 46695828, "comment_id": 80339529, "body": "If you need to handle an object as a MachineRecord, your input type should be MachineRecord, not IRecord.  If you need it to remain as IRecord, you should probably move the required properties and methods into the interface"}, {"owner": {"reputation": 1549, "user_id": 5890367, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10206951008588352/picture?type=large", "display_name": "Blake Thingstad", "link": "https://stackoverflow.com/users/5890367/blake-thingstad"}, "edited": false, "score": 1, "creation_date": 1507749378, "post_id": 46695828, "comment_id": 80339542, "body": "Can IRecord have <code>string GenerateRecord()</code>? That way anything that is an IRecord automatically has to implement a way to generate the CSV using its own properties"}, {"owner": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507749631, "post_id": 46695828, "comment_id": 80339660, "body": "I&#39;m wondering where you add the C of the CSV... There could be a generic way using reflection, getting all the properties of the current IRecord implementation, and using a <code>string.Join</code> to get them together separated by a separator of your choice."}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 5215844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g2ib5Eg3Wq8/AAAAAAAAAAI/AAAAAAAAAfM/2Z6MFYnR78M/photo.jpg?sz=128", "display_name": "Mazaher Bazari", "link": "https://stackoverflow.com/users/5215844/mazaher-bazari"}, "edited": false, "score": 0, "creation_date": 1507749998, "post_id": 46695983, "comment_id": 80339836, "body": "Also you must add Public access modifer to Name and ErrorCount Properties"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "reply_to_user": {"reputation": 366, "user_id": 5215844, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-g2ib5Eg3Wq8/AAAAAAAAAAI/AAAAAAAAAfM/2Z6MFYnR78M/photo.jpg?sz=128", "display_name": "Mazaher Bazari", "link": "https://stackoverflow.com/users/5215844/mazaher-bazari"}, "edited": false, "score": 0, "creation_date": 1507750255, "post_id": 46695983, "comment_id": 80339944, "body": "Good catch @MazaherBazari. They won&#39;t show if not properly exposed."}, {"owner": {"reputation": 43, "user_id": 3593770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd7b44fe8fae94a238ea6edadea2af3?s=128&d=identicon&r=PG&f=1", "display_name": "kokocola", "link": "https://stackoverflow.com/users/3593770/kokocola"}, "edited": false, "score": 0, "creation_date": 1507755751, "post_id": 46695983, "comment_id": 80342724, "body": "This is right, but I was hoping to keep all my IRecord there. Darn. I was hoping to have a more generic CSVMachineRecordStore that took abstractions. Trying to follow the Dependency Inversion principle in SOLID. Wouldn&#39;t this be tightly coupling my code?"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1507756306, "post_id": 46695983, "comment_id": 80342972, "body": "Well, with IoC your class has no knowledge of the injected object. Your current method implementation expects properties of a particular type (<code>MachineRecord</code>) so you are already breaking the IoC principle there. If the two properties in question (<code>Name</code> and <code>ErrorCount</code>) are shared by all objects, then you can just define them in the <code>IRecord</code> interface. That will make them available regardless of the type of object and your code will work without generics."}, {"owner": {"reputation": 43, "user_id": 3593770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd7b44fe8fae94a238ea6edadea2af3?s=128&d=identicon&r=PG&f=1", "display_name": "kokocola", "link": "https://stackoverflow.com/users/3593770/kokocola"}, "edited": false, "score": 0, "creation_date": 1507756889, "post_id": 46695983, "comment_id": 80343194, "body": "If I used the factory method pattern, would it fix this problem? If I create another class that takes care of the creation of string creation in GenerateRecord. I would think it would fix this issue?  For example, I pass GenerateRecord(IRecord record) and then inside the function, do something like CSVRecordFactory.CreateCSVString(record, &quot;MachineRecord&quot;);Thank you by the way! Trying to learn to do things the right way."}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1507757347, "post_id": 46695983, "comment_id": 80343397, "body": "I think I see where you are going with this. You could create an <code>ICsvStringFormatter</code> interface with a <code>GenerateRecord</code> method. You can then inject a concrete implementation (<code>MachineRecordCsvStringFormatter</code>) and let it format the record."}, {"owner": {"reputation": 43, "user_id": 3593770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd7b44fe8fae94a238ea6edadea2af3?s=128&d=identicon&r=PG&f=1", "display_name": "kokocola", "link": "https://stackoverflow.com/users/3593770/kokocola"}, "edited": false, "score": 0, "creation_date": 1507758217, "post_id": 46695983, "comment_id": 80343768, "body": "I think that&#39;s the best way. Thanks!!!! It would make the system easier to unit test and keeps it more SOLID."}], "tags": [], "owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "is_accepted": true, "score": 3, "last_activity_date": 1507749703, "creation_date": 1507749703, "answer_id": 46695983, "question_id": 46695828, "link": "https://stackoverflow.com/questions/46695828/object-oriented-casting-issue/46695983#46695983", "title": "Object Oriented Casting issue", "body": "<p>Use generics:</p>\n\n<pre><code>public interface IRecordStore&lt;T&gt; where T:IRecord\n{\n    string GenerateRecord(T record);\n}\n</code></pre>\n\n<p>Then implement:</p>\n\n<pre><code>public class CSVMachineRecordStore : IRecordStore&lt;MachineRecord&gt;\n{\n    public string GenerateRecord(MachineRecord record)\n    {\n        var machineRecord = record; //we want to remove the explicit cast\n        var strBuilder = new StringBuilder();\n        strBuilder.Append(machineRecord.Name);\n        strBuilder.Append(machineRecord.ErrorCount);\n        return strBuilder.ToString();\n    }\n}\n</code></pre>\n\n<p>I wrote this in a hurry, make sure to check for silly errors.</p>\n"}, {"comments": [{"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1507750832, "post_id": 46696082, "comment_id": 80340243, "body": "I posted the same answer seven minutes ago. Why post it again?"}, {"owner": {"reputation": 324, "user_id": 5679537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6jazE.png?s=128&g=1", "display_name": "Julian A", "link": "https://stackoverflow.com/users/5679537/julian-a"}, "reply_to_user": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 1, "creation_date": 1507752225, "post_id": 46696082, "comment_id": 80341018, "body": "Sorry, I was testing some code variances before posting, because I prefer to deliver the best possible answer I can give. Therefore, I didn&#39;t see you already answered. I gave you an upvote :)"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 0, "creation_date": 1507754428, "post_id": 46696082, "comment_id": 80342082, "body": "Got it. No worries. Thanks!"}], "tags": [], "owner": {"reputation": 324, "user_id": 5679537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6jazE.png?s=128&g=1", "display_name": "Julian A", "link": "https://stackoverflow.com/users/5679537/julian-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1507751785, "last_edit_date": 1507751785, "creation_date": 1507750143, "answer_id": 46696082, "question_id": 46695828, "link": "https://stackoverflow.com/questions/46695828/object-oriented-casting-issue/46696082#46696082", "title": "Object Oriented Casting issue", "body": "<p>The type casting exception occurs when the <code>IRecord</code> instance is not an instance of <code>MachineRecord</code>. </p>\n\n<p>To answer your question how to fix the casting issue, you should have a look at the <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/as\" rel=\"nofollow noreferrer\">as operator</a>.</p>\n\n<p>However, for me this looks like making the <code>IRecordStore</code> interface generic could help you prevent the type issues you're experiencing:</p>\n\n<p>[Edit] I noticed since IRecordStore is an interface you could even make the generic type <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/in-generic-modifier\" rel=\"nofollow noreferrer\">contravariant</a>. This allows you to assign a variable \n of type <code>IRecordStore&lt;IRecord&gt;</code> with an instance of <code>IRecordStore&lt;MachineRecord&gt;</code> or more explicitly <code>CSVMachineRecordStore</code>.</p>\n\n<pre><code>public interface IRecordStore&lt;in T&gt; where T : IRecord\n{\n    string GenerateRecord(T record);\n}\n\npublic class CSVMachineRecordStore : IRecordStore&lt;MachineRecord&gt;\n{\n    public string GenerateRecord(MachineRecord record)\n    {\n        var machineRecord = record;\n        var strBuilder = new StringBuilder();\n        strBuilder.Append(machineRecord.Name);\n        strBuilder.Append(machineRecord.ErrorCount);\n        return strBuilder.ToString();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3593770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cd7b44fe8fae94a238ea6edadea2af3?s=128&d=identicon&r=PG&f=1", "display_name": "kokocola", "link": "https://stackoverflow.com/users/3593770/kokocola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 46695983, "answer_count": 2, "score": 0, "last_activity_date": 1507751785, "creation_date": 1507749038, "last_edit_date": 1507749468, "question_id": 46695828, "link": "https://stackoverflow.com/questions/46695828/object-oriented-casting-issue", "title": "Object Oriented Casting issue", "body": "<p>I have a casting issue and I was wondering if anyone would be able to help me see how I can fix this issue?</p>\n\n<p>Basically I'm trying to create a CSV generator console program that will take a list of machine records from the DB and put them into a CSV.</p>\n\n<p>The code below is simplified but generally similar to my implementation currently:</p>\n\n<pre><code>public interface IRecord \n{\n\n}\n\npublic class MachineRecord : IRecord\n{\n    string Name {get;set;}\n    string ErrorCount {get;set;}\n}\n\npublic interface IRecordStore\n{\n    string GenerateRecord(IRecord record);\n}\n\npublic class CSVMachineRecordStore : IRecordStore\n{\n    public string GenerateRecord(IRecord record)\n    {\n        var machineRecord = (MachineRecord)record;\n        var strBuilder = new StringBuilder();\n        strBuilder.Append(machineRecord.Name);\n        strBuilder.Append(machineRecord.ErrorCount);\n        return strBuilder.ToString();\n    }\n}\n</code></pre>\n\n<p>So basically here I've created a class that inherits from IRecordStore, and in our case we have to create an implementation of GenerateRecord. The problem here is I have to cast the record of be of type MachineRecord or the compiler will throw a casting error out, this is due to Record not having any properties set.</p>\n\n<p>Is it possible to not have the direct cast in this implementation so this line of code will be like:</p>\n\n<pre><code>public class CSVMachineRecordStore : IRecordStore\n{\n    public string GenerateRecord(IRecord record)\n    {\n        var machineRecord = record; //we want to remove the explicit cast\n        var strBuilder = new StringBuilder();\n        strBuilder.Append(machineRecord.Name);\n        strBuilder.Append(machineRecord.ErrorCount);\n        return strBuilder.ToString();\n    }\n}\n</code></pre>\n\n<p>I know I can fix this issue by adding Name and ErrorCount properties to IRecord, but IRecord is a very generic interface that can have anything.</p>\n\n<p>We want to be able to create a CSV program that can handle machine records, customer records, employee records, supplier records, etc...</p>\n\n<p>I'm thinking of using generics, and I've played with them a bit but I've had some trouble getting it to work too.</p>\n"}, {"tags": ["c#", ".net", "winforms", "wcf", "webclient"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1507750046, "post_id": 46695826, "comment_id": 80339857, "body": "There are few possibilities.  1) All you changes did not get into the executable due t a dependency issue with the compiler.  So you can delete the bin folder which will completely rebuild project so the release mode will get rebuilt 2) The code works first time.But 2nd time a cookie was established and there is something wrong with running code with cookie.So you can open an IE and delete history including cookies and try again.Or go back to the debug version and see if it still works.3) Your old connection is not closed and server isn&#39;t allowing more than one connection from same IP address."}, {"owner": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "edited": false, "score": 1, "creation_date": 1507751990, "post_id": 46695826, "comment_id": 80340886, "body": "Wouldn&#39;t <code>UseDefaultCredentials</code> and your supplying current user credentials be in conflict?  I&#39;d look in the output window when you&#39;re &quot;succeeding&quot; in debug to be sure it&#39;s not throwing there as well, but letting you get away with it anyhow."}, {"owner": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "edited": false, "score": 0, "creation_date": 1507753233, "post_id": 46695826, "comment_id": 80341480, "body": "Thanks for the quick response. I tried your suggestions. 1) I deleted the bin folder and completely rebuilt the project. No success. 2) I re-ran the program in debug mode and it still works correctly in debug mode. 3) Is there a way for me to close the webclient? weblient.Close()?"}, {"owner": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "reply_to_user": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "edited": false, "score": 0, "creation_date": 1507754279, "post_id": 46695826, "comment_id": 80341998, "body": "@DonBoitnott - You are the man! Thanks for your help. That was my issue. I removed the two lines of default credentials and it is working now."}, {"owner": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "edited": false, "score": 0, "creation_date": 1507755946, "post_id": 46695826, "comment_id": 80342817, "body": "I got excited too soon. It appears that this problem is intermittent. It worked on my machine but when I used the executable on a different machine, it had the same error that I was seeing previously."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "edited": false, "score": 0, "creation_date": 1507818708, "post_id": 46708102, "comment_id": 80370889, "body": "Thanks again. However, I get the same error with HttpWebRequest as with WebClient. I think my problem has more to do with the website that I am trying to access. For example, I can access one distributor website but not another. The website seems to recognize that my application is a bot."}, {"owner": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "reply_to_user": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "edited": false, "score": 0, "creation_date": 1507820981, "post_id": 46708102, "comment_id": 80372554, "body": "@TylerWilson That and perhaps it limits similar connections by their frequency.  The intermittent pattern you see might be because you&#39;re trying them too close together and it doesn&#39;t like that.  DDoS prevention and the like."}, {"owner": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "edited": false, "score": 0, "creation_date": 1507824095, "post_id": 46708102, "comment_id": 80374536, "body": "Is there any way to get around this DDoS prevention? It is obviously there for a reason. Would adding delays in my code allow for this?"}, {"owner": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "reply_to_user": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "edited": false, "score": 1, "creation_date": 1507828255, "post_id": 46708102, "comment_id": 80376790, "body": "Only someone who knows the site you&#39;re after could answer that.  If there is, it probably requires logging in so the site knows who/what you are.  Otherwise, you&#39;re just another potential attacker."}], "tags": [], "owner": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "is_accepted": false, "score": 0, "last_activity_date": 1507806528, "creation_date": 1507806528, "answer_id": 46708102, "question_id": 46695826, "link": "https://stackoverflow.com/questions/46695826/system-net-webexception-the-underlying-connection-was-closed-an-existing-conne/46708102#46708102", "title": "System.Net.WebException: The underlying connection was closed: An existing connection was forcibly closed by the remote host", "body": "<p>An alternative would be to use an <code>HttpWebRequest</code> instead:</p>\n\n<pre><code>String responseFromServer = null;\nvar url = webPath + manPartNum;\nvar request = (HttpWebRequest)HttpWebRequest.Create(urlPing);\nrequest.UserAgent = \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\";\nvar response = (HttpWebResponse)request.GetResponse();\nif (response.StatusCode == HttpStatusCode.OK)\n{\n    using (var dataStream = response.GetResponseStream())\n    {\n        using (var reader = new StreamReader(dataStream))\n            responseFromServer = reader.ReadToEnd();\n    }\n}\n\nif (!String.IsNullOrEmpty(responseFromServer))\n{\n}\n</code></pre>\n\n<p>Unless you are truly \"loggin in\" to the page, your use of <code>WebClient</code> might be unnecessary.  If all you need is to request the page response, then this should avoid all of those authentication headaches.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1507903291, "creation_date": 1507903291, "answer_id": 46731700, "question_id": 46695826, "link": "https://stackoverflow.com/questions/46695826/system-net-webexception-the-underlying-connection-was-closed-an-existing-conne/46731700#46731700", "title": "System.Net.WebException: The underlying connection was closed: An existing connection was forcibly closed by the remote host", "body": "<p>After doing more research, I was able to determine that the website that I was attempting to access has OAuth 2.0 Authentication and Authorization. It looks like I must register with the company and use their API to access their website with my application. Hopefully this helps someone else.</p>\n"}], "owner": {"reputation": 99, "user_id": 5505171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-XEeyZysjA2w/AAAAAAAAAAI/AAAAAAAAAVg/_MU81BahLHw/photo.jpg?sz=128", "display_name": "Tyler Wilson", "link": "https://stackoverflow.com/users/5505171/tyler-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5974, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513974215, "creation_date": 1507749032, "question_id": 46695826, "link": "https://stackoverflow.com/questions/46695826/system-net-webexception-the-underlying-connection-was-closed-an-existing-conne", "title": "System.Net.WebException: The underlying connection was closed: An existing connection was forcibly closed by the remote host", "body": "<p>I have seen a few other threads on this but haven't found a solution. When running my C# Windows From from debug mode, I am able to use the WebClient to read data from a web page. However, as soon as I create the executable for the application, I am unable to read the data from the web page. Here the exception that I am getting:</p>\n\n<p>System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send. ---> System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host. --->\nSystem.Net.Sockets.SocketException: An existing connection was forcibly closed by the remote host\n at System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)\n at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)</p>\n\n<p>---End of inner exception stack trace ---</p>\n\n<p>Here is a snippet of the code I am using:</p>\n\n<pre><code>WebClient webClient = new WebClient();\nwebClient.UseDefaultCredentials = true;\nwebClient.Proxy.Credentials = CredentialCache.DefaultCredentials;\nwebClient.Headers.Add(\"user-agent\", \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\");\nstring page = webClient.DownloadString(webPath + manPartNum);\n</code></pre>\n\n<p>Like I said previously, I am able to get this to work correctly in debug mode of visual studio but as soon as I create the executable, I am no longer able to read from the web page. Any help would be appreciated. What could be causing this issue?</p>\n"}, {"tags": ["c#"], "answers": [{"tags": [], "owner": {"reputation": 478, "user_id": 5810912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/il66y.jpg?s=128&g=1", "display_name": "imerso", "link": "https://stackoverflow.com/users/5810912/imerso"}, "is_accepted": true, "score": 0, "last_activity_date": 1507751379, "creation_date": 1507751379, "answer_id": 46696388, "question_id": 46695682, "link": "https://stackoverflow.com/questions/46695682/how-to-make-of-slopes-terrain/46696388#46696388", "title": "how to make of slopes/terrain?", "body": "<p>You can create something like that procedurally. I just created a behaviour that will create a senoidal track much like your picture above:</p>\n\n<pre><code>// written by 'imerso' as a StackOverflow answer.\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class SlopeTerrain : MonoBehaviour\n{\n    public int heightInMeters = 5;\n    public int widthInMeters = 128;\n    public float ondulationFactor = 0.1f;\n    public Material material;\n\n    // Use this for initialization\n    void Start ()\n    {\n        Mesh mesh = new Mesh();\n        List&lt;Vector3&gt; vertices = new List&lt;Vector3&gt;();\n        List&lt;int&gt; triangles = new List&lt;int&gt;();\n\n        for (int p = 0; p &lt; widthInMeters; p++)\n        {\n            // add two vertices, one at the horizontal position but displaced by a sine wave,\n            // and other at the same horizontal position, but at bottom\n            vertices.Add(new Vector3(p, Mathf.Abs(heightInMeters * Mathf.Sin(p * ondulationFactor)), 0));\n            vertices.Add(new Vector3(p, 0, 0));\n\n            if (p &gt; 0)\n            {\n                // we have enough vertices created already,\n                // so start creating triangles using the previous vertices indices\n                int v0 = p * 2 - 2;         // first sine vertex\n                int v1 = p * 2 - 1;         // first bottom vertex\n                int v2 = p * 2;             // second sine vertex\n                int v3 = p * 2 + 1;         // second bottom vertex\n\n                // first triangle\n                triangles.Add(v0);\n                triangles.Add(v1);\n                triangles.Add(v2);\n\n                // second triangle\n                triangles.Add(v2);\n                triangles.Add(v1);\n                triangles.Add(v3);\n            }\n        }\n\n        mesh.vertices = vertices.ToArray();\n        mesh.triangles = triangles.ToArray();\n\n        mesh.RecalculateBounds();\n\n        MeshRenderer r = gameObject.AddComponent&lt;MeshRenderer&gt;();\n        MeshFilter f = gameObject.AddComponent&lt;MeshFilter&gt;();\n\n        if (material != null)\n        {\n            r.sharedMaterial = material;\n        }\n\n        f.sharedMesh = mesh;\n    }\n}\n</code></pre>\n\n<p>To keep it simple for you to understand though, I made it just 2D. To use it, create an empty GameObject, then put the above script on it. It has a few parameters which you can tweak as well. Good luck.</p>\n"}], "owner": {"reputation": 445, "user_id": 7244662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TflZq.jpg?s=128&g=1", "display_name": "Arihant", "link": "https://stackoverflow.com/users/7244662/arihant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 791, "favorite_count": 0, "closed_date": 1507753769, "accepted_answer_id": 46696388, "answer_count": 1, "score": -8, "last_activity_date": 1544316176, "creation_date": 1507748414, "last_edit_date": 1544316176, "question_id": 46695682, "link": "https://stackoverflow.com/questions/46695682/how-to-make-of-slopes-terrain", "closed_reason": "Needs more focus", "title": "how to make of slopes/terrain?", "body": "<p>How to create this type of slopes/terrain in unity 5? </p>\n\n<p>I am creating a game in which I need random mountain slopes. I don't need the details inside the mountain, but only its boundaries.</p>\n\n<p>I want to know what are the tools in unity available to make this slope.</p>\n\n<p>I'm confused whether I have to create this type of slope by code or is there any direct feature in unity for making random mountains boundaries.\n <a href=\"https://i.stack.imgur.com/XLanY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XLanY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "entity-framework", "linq", "database-design"], "comments": [{"owner": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507748449, "post_id": 46695646, "comment_id": 80339117, "body": "First off, I&#39;m wondering why you put answers in a questions table. If you would put them in their own table (where one would expect them) you would not have to ask this question :)"}, {"owner": {"reputation": 637, "user_id": 5446775, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/92a536f7870770956c9b61fc7b5fb741?s=128&d=identicon&r=PG&f=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/5446775/henri"}, "reply_to_user": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507748599, "post_id": 46695646, "comment_id": 80339180, "body": "Hey, @oerkelens! Some answers are also questions (alternatives)"}, {"owner": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507748709, "post_id": 46695646, "comment_id": 80339226, "body": "Can you include an example of such an answer that is also a question? I&#39;m not getting the point with the given examples..."}, {"owner": {"reputation": 637, "user_id": 5446775, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/92a536f7870770956c9b61fc7b5fb741?s=128&d=identicon&r=PG&f=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/5446775/henri"}, "reply_to_user": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507749054, "post_id": 46695646, "comment_id": 80339401, "body": "The question 1 (id) asks what is your gender, with an &quot;male&quot; (3) or &quot;non-male&quot; (4) child questions. If you choose &quot;male&quot; (id 3), there will be a record in the <code>Answer</code> table like this: [id = some identity id; id_question = 3; value = true]. If 1000 users also answer &quot;male&quot;, there will be 1000 answers for the question of id 3, just like the Google Forms"}, {"owner": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 0, "creation_date": 1507749215, "post_id": 46695646, "comment_id": 80339466, "body": "Most people I know would consider &quot;Male&quot; an answer, not a question, and they would pout it in a separate table. If you want your answers in a questions table, go ahead, but this won&#39;t be the last problem you run into :)"}, {"owner": {"reputation": 4590, "user_id": 2784290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOUxC.jpg?s=128&g=1", "display_name": "oerkelens", "link": "https://stackoverflow.com/users/2784290/oerkelens"}, "edited": false, "score": 1, "creation_date": 1507749304, "post_id": 46695646, "comment_id": 80339509, "body": "You might want to try something like <code>.Include(i =&gt; i.Questions.Where(q =&gt; q.Type == null))</code> if you want the questions, or <code>.Include(i =&gt; i.Questions.Where(q =&gt; q.Type != null))</code> for questions."}, {"owner": {"reputation": 637, "user_id": 5446775, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/92a536f7870770956c9b61fc7b5fb741?s=128&d=identicon&r=PG&f=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/5446775/henri"}, "edited": false, "score": 0, "creation_date": 1507750322, "post_id": 46695646, "comment_id": 80339976, "body": "Adding a <code>Where</code> inside the <code>Include</code> causes an exception: Additional information: The Include path expression must refer to a navigation property defined on the type. Use dotted paths for reference navigation properties and the Select operator for collection navigation properties."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1507760838, "post_id": 46695646, "comment_id": 80344613, "body": "Your problem appears to be your mapping or your model - <code>Form.Questions</code> is all questions with a matching (what???) - you seem to be missing columns in your example. In any case, the EF model is defining <code>Questions</code> differently from what you expect, your query can&#39;t help with that."}, {"owner": {"reputation": 6624, "user_id": 1750324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eea6f502a6e4334864b2d0f47181db2?s=128&d=identicon&r=PG", "display_name": "Steve Ford", "link": "https://stackoverflow.com/users/1750324/steve-ford"}, "edited": false, "score": 0, "creation_date": 1507810877, "post_id": 46695646, "comment_id": 80365321, "body": "Seems you have questions and allowable responses in your table, why not separate them into questions, questionOptions and answers?"}, {"owner": {"reputation": 2045, "user_id": 1697088, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/LoOXx.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1697088/rob"}, "edited": false, "score": 0, "creation_date": 1507811851, "post_id": 46695646, "comment_id": 80365993, "body": "The part where you do this .Where(w =&gt; w.Questions.Any(q =&gt; q.QuestionId != null)) is quite useless as you pointed out. This is because you are effectivley saying: Get me all forms that have at least one question that has a aparent question. You can completely get rid of that since you are interested in questions. Can you try and put that condition in Include method you call."}, {"owner": {"reputation": 637, "user_id": 5446775, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/92a536f7870770956c9b61fc7b5fb741?s=128&d=identicon&r=PG&f=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/5446775/henri"}, "reply_to_user": {"reputation": 2045, "user_id": 1697088, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/LoOXx.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/1697088/rob"}, "edited": false, "score": 0, "creation_date": 1507892213, "post_id": 46695646, "comment_id": 80402463, "body": "@Rob two others have said that, although it wont work because EF does not support <code>include filtering</code> as of now (6.1.3). @NetMage that sounds good, however what will be the FKs of <code>Answer</code>? Will it point to two other tables (<code>Question</code> and <code>QuestionOption</code>)?"}], "owner": {"reputation": 637, "user_id": 5446775, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/92a536f7870770956c9b61fc7b5fb741?s=128&d=identicon&r=PG&f=1", "display_name": "Henri", "link": "https://stackoverflow.com/users/5446775/henri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507750802, "creation_date": 1507748247, "last_edit_date": 1507750802, "question_id": 46695646, "link": "https://stackoverflow.com/questions/46695646/list-all-member-lists-items-given-a-criteria-on-entity-framework-with-no-loop", "title": "List all member list&#39;s items given a criteria on Entity Framework with no loop", "body": "<p>I am developing a custom Google Form's like project. These are the entities related to my problem:</p>\n\n<pre><code>public class Form\n{\n    public int Id;\n    public string Title;\n    public virtual List&lt;Question&gt; Questions;\n}\n\npublic class Question\n{\n    public int Id;\n    public int? QuestionId; // Self reference pointer for nested questions (alternatives)\n    public string Type; // Radio, checkbox, text or image\n    public string Description;\n    public virtual List&lt;Question&gt; Alternatives;\n}\n</code></pre>\n\n<p>Here's my current tables (example):\n<a href=\"https://i.stack.imgur.com/DV5Gq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DV5Gq.png\" alt=\"Forms\"></a>\n<a href=\"https://i.stack.imgur.com/uZLQ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uZLQ8.png\" alt=\"Questions\"></a></p>\n\n<p>From now on, lets just assume everything is correctly mapped/linked (using Fluent API) and that I can successfuly list all the forms and their questions, as follows:</p>\n\n<pre><code>public List&lt;Form&gt; ListForms()\n{\n    return context.Forms\n        .Where(w =&gt; w.Questions.Any(q =&gt; q.QuestionId != null)) // Useless\n        .Include(i =&gt; i.Questions.Select(q =&gt; q.Alternatives))\n        .ToList();\n}\n</code></pre>\n\n<p>Based on the both images, the above snippet produces a list of 1 <code>Form</code>, with 5 <code>Question</code>, when it should be 2 if it skipped the child questions (these should be put into the <code>Alternatives</code> list), like so: \"What is your gender?\", \"How old are you?\", <strong>\"Male\", \"Non-male\" and \"I am 18yo or older\"</strong>.</p>\n\n<p>How can I edit it in order to list all the forms and all the questions, except those NULL TYPE questions, <strong>WITHOUT USING A VANILLA LOOP</strong> (after the ToList() call)?</p>\n"}, {"tags": ["c#", "linq", "listview"], "comments": [{"owner": {"reputation": 934, "user_id": 1315390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BCcQU.png?s=128&g=1", "display_name": "Eric Beaulieu", "link": "https://stackoverflow.com/users/1315390/eric-beaulieu"}, "edited": false, "score": 0, "creation_date": 1507749868, "post_id": 46695600, "comment_id": 80339770, "body": "What is the type of sale.City, does it implement IComparable?"}, {"owner": {"reputation": 149, "user_id": 6939221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/64a0fe3e26dad5bcaee2913d371268bc?s=128&d=identicon&r=PG&f=1", "display_name": "fdsafdsafdsafdsafs", "link": "https://stackoverflow.com/users/6939221/fdsafdsafdsafdsafs"}, "edited": false, "score": 0, "creation_date": 1507750057, "post_id": 46695600, "comment_id": 80339862, "body": "You may find your answer here: <a href=\"https://stackoverflow.com/questions/29465104/at-least-one-object-must-implement-icomparable-calling-orderby\" title=\"at least one object must implement icomparable calling orderby\">stackoverflow.com/questions/29465104/&hellip;</a>"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1507750451, "post_id": 46695600, "comment_id": 80340035, "body": "Your results are a List&lt;List&lt;List&lt;object&gt;&gt;&gt;.  The groups is the first list and the last two are the rows and columns of a table."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 8562711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/121203274c53c85c23bd269717fb78e4?s=128&d=identicon&r=PG&f=1", "display_name": "Renat Baratov", "link": "https://stackoverflow.com/users/8562711/renat-baratov"}, "is_accepted": false, "score": 0, "last_activity_date": 1507750020, "creation_date": 1507750020, "answer_id": 46696049, "question_id": 46695600, "link": "https://stackoverflow.com/questions/46695600/trying-to-group-by-distinct-values-and-add-results-to-a-listview/46696049#46696049", "title": "Trying to group by distinct values and add results to a listview", "body": "<p>That is happen because chekBoxAdd contains no <code>House</code> Objects. Your checkBoxAdd is a <code>IEnumerable&lt;IGrouping&lt;IEnumerable&lt;char&gt;, string&gt;&gt;</code>.\nYou're trying to compare <code>House</code> object with <code>IGrouping&lt;IEnumerable&lt;char&gt;, string&gt;</code> element.</p>\n"}], "owner": {"reputation": 129, "user_id": 7077773, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10157615296720035/picture?type=large", "display_name": "Rick D", "link": "https://stackoverflow.com/users/7077773/rick-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1507750204, "answer_count": 1, "score": 0, "last_activity_date": 1507750101, "creation_date": 1507748100, "last_edit_date": 1507750101, "question_id": 46695600, "link": "https://stackoverflow.com/questions/46695600/trying-to-group-by-distinct-values-and-add-results-to-a-listview", "closed_reason": "Duplicate", "title": "Trying to group by distinct values and add results to a listview", "body": "<p>as the title says, I'm trying to group a selection by it's distinct values, and then iterate through the result to populate a listView of checkboxes, my code is below</p>\n\n<pre><code>var checkBoxAdd =\n            from sale in saleData\n            orderby sale.City.ToList()\n            group sale.City by sale.City.Distinct() into cityDistinct\n            select cityDistinct;\n\n\nforeach (House s in checkBoxAdd)\n{\n    listViewCities.Items.Add(s.City.ToString());\n}\n</code></pre>\n\n<p>I am getting the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jNasd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jNasd.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can anyone help me out with this please</p>\n"}, {"tags": ["c#", "scope", "visibility", "public"], "comments": [{"owner": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 1, "creation_date": 1507748229, "post_id": 46695578, "comment_id": 80339003, "body": "Just change <code>OleDbConnection con1 = new OleDbConnection(...)</code> to <code>this.con1 = new OleDbConnection(...)</code> to access the expected property."}, {"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 1, "creation_date": 1507748670, "post_id": 46695578, "comment_id": 80339211, "body": "consider using some naming convention that helps you identify member variables, such <code>m_Con1</code> or <code>_con1</code> (really opinion based on what convention to use, but I advice to use something different from the &quot;simple names&quot; used for local variables / function parameters)"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 1, "creation_date": 1507748863, "post_id": 46695578, "comment_id": 80339304, "body": "You shouldn&#39;t store database connections in fields (class level variables). ADO.NET connections (such as OleDbConnection) implement <a href=\"https://msdn.microsoft.com/en-us/library/system.idisposable(v=vs.110).aspx\" rel=\"nofollow noreferrer\">IDisposable</a> They should be created in a using block."}, {"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1507750945, "post_id": 46695578, "comment_id": 80340307, "body": "@mason, for a connection helper as <code>Clshelper</code> seems to be, storing the connection in a member variable (and having the class itself implement IDisposable) can be a good idea. I think .Net <code>OleDbConnection</code> class does exactly the same"}, {"owner": {"reputation": 55, "user_id": 3511553, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df99336119e4536da264bb46e6e05ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3511553", "link": "https://stackoverflow.com/users/3511553/user3511553"}, "reply_to_user": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 0, "creation_date": 1507751996, "post_id": 46695578, "comment_id": 80340894, "body": "@Gian Paolo (and others) does a class like my helper automatically implement iDisposable in the background or do I have to code it manually - and based on standards would the &quot;using&quot; approach be better ?"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 0, "creation_date": 1507754292, "post_id": 46695578, "comment_id": 80342010, "body": "@GianPaolo No, it is NOT a good idea. This helper is not following a good pattern. It&#39;s not able to ensure that the connection is disposed of properly. Please read up on IDisposable so that you understand why it&#39;s necessary."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1507754379, "post_id": 46695578, "comment_id": 80342060, "body": "@user3511553 If your helper implements IDisposable, then you need to ensure that it disposes of the connection in the Dispose method. And you need to make sure that the helper itself is then created in a <code>using</code> block to ensure that it gets disposed properly. It&#39;s really just moving the goal posts. Rather than having a helper like this, I suggest looking into modern repository patterns with ADO.NET connections."}, {"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1507755981, "post_id": 46695578, "comment_id": 80342828, "body": "@Mason, thinking more at it, I agree with you. A method such <code>readfromdb()</code> should create, use and dispose its connection. I&#39;m trying to figure out a scenario where the connection need to be used across more methods (maybe a transaction?), but cannot see it right now."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 0, "creation_date": 1507756884, "post_id": 46695578, "comment_id": 80343191, "body": "@Gian yes, transaction is a valid reason for it, you have to be very careful if you go that route to make sure it gets disposed properly."}, {"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1507796308, "post_id": 46695578, "comment_id": 80356118, "body": "@mason, I agree, definitely. Actually, that&#39;s true for every IDisposable object, an <code>using</code> keyword is so helpful here! As a rule of thumb, if your class store an instance of an IDisposable object, the class itself should be Disposable, should implement Dispose correctly, and it&#39;s responsibility of client code to properly dispose it."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 0, "creation_date": 1507810624, "post_id": 46695578, "comment_id": 80365114, "body": "@GianPaolo Not <i>every</i> IDisposable, but almost. <a href=\"https://aspnetmonsters.com/2016/08/2016-08-27-httpclientwrong/\" rel=\"nofollow noreferrer\">HttpClient</a> is a special circumstance when you shouldn&#39;t. Then there&#39;s classes like <a href=\"https://msdn.microsoft.com/en-us/library/system.data.datatable(v=vs.110).aspx\" rel=\"nofollow noreferrer\">DataTable</a> that implement IDisposable but usually don&#39;t need to be disposed of. Of course, I&#39;d avoid DataTable at all costs anyways."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3511553, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df99336119e4536da264bb46e6e05ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3511553", "link": "https://stackoverflow.com/users/3511553/user3511553"}, "edited": false, "score": 0, "creation_date": 1507750681, "post_id": 46695645, "comment_id": 80340152, "body": "thank you very much JDB - what a silly newbie error on my part - or course the new keyword  is a declaration of a new variable / object. Was originally trying to create the connection method as a static of some sort since it always will stay the same - but it failed me so i just created everything as public - so any suggestion regarding making the connection oject or the makeconn method static are welcome improvements - great community"}], "tags": [], "owner": {"reputation": 21514, "user_id": 211627, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "JDB still remembers Monica", "link": "https://stackoverflow.com/users/211627/jdb-still-remembers-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1507748722, "last_edit_date": 1507748722, "creation_date": 1507748246, "answer_id": 46695645, "question_id": 46695578, "link": "https://stackoverflow.com/questions/46695578/public-object-from-public-method-not-visible-in-another-public-method-in-same-cl/46695645#46695645", "title": "public Object from public method not visible in another public method in same class", "body": "<p>The line</p>\n\n<pre><code>OleDbConnection con1 = // ...\n</code></pre>\n\n<p>actually creates a brand new variable within the scope of the <code>makeconn</code> function. While you have another class-scoped variable named <code>con1</code>, they are separated variables, so assigning a value to one (function-scoped) variable does not assign the value to the other (class-scoped) variable.</p>\n\n<p>The fix is pretty easy. Rather than declaring a new variable, just use the one you've already declared in your class:</p>\n\n<pre><code>public void  makeconn() {\n   // Don't declare a new variable here:\n   con1 = new OleDbConnection(\"Provider = Microsoft.ACE.OLEDB.12.0; Data Source = D:\\\\DATA.accdb\");\n}\n</code></pre>\n\n<hr>\n\n<p>Interesting side-note. If you have a function-scoped variable named the same as a class-scoped instance variable, you can access the class-scoped variable using the <code>this</code> keyword:</p>\n\n<pre><code>class MyClass {\n    private int myVar = 1;\n\n    private void myFunc(){\n        int myVar = 2; // function-scoped myVar overrides class-scoped myVar\n\n        int myOtherVar;\n\n        myOtherVar = myVar; // myOtherVar = 2 (function-scoped myVar)\n        myOtherVar = this.myVar; // myOtherVar = 1 (class-scoped myVar)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 3511553, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df99336119e4536da264bb46e6e05ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3511553", "link": "https://stackoverflow.com/users/3511553/user3511553"}, "edited": false, "score": 0, "creation_date": 1507763887, "post_id": 46697470, "comment_id": 80345456, "body": "thanks mason - 1. is &quot;using&quot; recommended for connections and command objects as per your example and                                                                               2. in the industry / workplace is it acceptable to use       &quot;var con1&quot; as a shortcut instead of say &quot;OleDbConnection con1&quot;"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 55, "user_id": 3511553, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df99336119e4536da264bb46e6e05ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3511553", "link": "https://stackoverflow.com/users/3511553/user3511553"}, "edited": false, "score": 0, "creation_date": 1507777532, "post_id": 46697470, "comment_id": 80348637, "body": "I specifically showed it with the using statement because that&#39;s the correct way of doing it. The using statement will ensure that the objects get disposed of, even if there&#39;s an exception. You should do that with almost every object that implements IDisposable interface. Using <code>var</code> is a shortcut for not having to explicitly write the type, but you still have full type safety. Many companies have a coding style dictating when it can and can&#39;t be used. Learn to use it, so if you come across it you&#39;re familiar with it. And when you get to a company, see what their preferences are."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 55, "user_id": 3511553, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df99336119e4536da264bb46e6e05ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3511553", "link": "https://stackoverflow.com/users/3511553/user3511553"}, "edited": false, "score": 0, "creation_date": 1507778012, "post_id": 46697470, "comment_id": 80348749, "body": "@user35 did you read the documentation I gave you the link to?"}], "tags": [], "owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "is_accepted": false, "score": 1, "last_activity_date": 1507755549, "creation_date": 1507755549, "answer_id": 46697470, "question_id": 46695578, "link": "https://stackoverflow.com/questions/46695578/public-object-from-public-method-not-visible-in-another-public-method-in-same-cl/46697470#46697470", "title": "public Object from public method not visible in another public method in same class", "body": "<p>Your helper class is not able to follow good practices regarding disposing connections. Eventually this can lead to exhausting the available connections. And when this happens, it's extremely difficult to track down. That's why you need to take care when working with <a href=\"https://msdn.microsoft.com/en-us/library/system.idisposable(v=vs.110).aspx\" rel=\"nofollow noreferrer\">IDisposable</a> objects to make sure you've handled them properly.</p>\n\n<p>Here's one way of following this pattern correctly:</p>\n\n<pre><code>public class ProductRepository\n{\n    private readonly string _connectionString;\n\n    public MyRepository(string connectionString)\n    {\n        _connectionString = connectionString;\n    }\n\n    public List&lt;Product&gt; GetProducts()\n    {\n        using (var connection = new OleDbConnection(_connectionString))\n        using (var command = new OleDbCommand(\"command text\", connection))\n        {\n            connection.Open();\n            //execute command and return results here\n        }\n    }\n\n    public void AddProduct(Product product)\n    {\n        using (var connection = new OleDbConnection(_connectionString))\n        using (var command = new OleDbCommand(\"command text\", connection))\n        {\n            connection.Open();\n            //execute command here\n        }\n    }\n}\n</code></pre>\n\n<p>Using <a href=\"https://github.com/StackExchange/Dapper\" rel=\"nofollow noreferrer\">Dapper</a> (not shown here) simplifies it further so you don't have to create the command object and map the results to/from your strongly typed classes.</p>\n"}], "owner": {"reputation": 55, "user_id": 3511553, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2df99336119e4536da264bb46e6e05ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3511553", "link": "https://stackoverflow.com/users/3511553/user3511553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1516, "favorite_count": 0, "accepted_answer_id": 46695645, "answer_count": 2, "score": 0, "last_activity_date": 1507755549, "creation_date": 1507748044, "last_edit_date": 1507748388, "question_id": 46695578, "link": "https://stackoverflow.com/questions/46695578/public-object-from-public-method-not-visible-in-another-public-method-in-same-cl", "title": "public Object from public method not visible in another public method in same class", "body": "<p>I am a struggling newbie trying to learn and figure out this new C# language and OO style and my brain is not as sharp as 20 years ago.\nHere we have a simple database connection to Access (.accdb)\nI am instantiating a helper class which contains two methods i.e. makeconn and  the readfrondb methods as follows</p>\n\n<pre><code>public void Form1_Load(object sender, EventArgs e)  {\n\n        Clshelper chelp = new Clshelper();\n\n        chelp.makeconn(); \n        chelp.readfromdb();\n\n    }\n</code></pre>\n\n<p>This is the helper class below - created because I want to keep the connection part and whatever type of data manipulation I do in separate methods.\nHowever unless the line that creates a connection object con1 in the method makeconn throws an exception because the con1 is a NULL object if i code it as below.</p>\n\n<pre><code>public class Clshelper {\n    public OleDbConnection con1;\n    public OleDbCommand cmd;\n\n    public Clshelper() {\n        Console.WriteLine(\"instantiated Cls_helper()\");\n    }\n\n    public void  makeconn() {   \n       OleDbConnection con1 = new OleDbConnection(\"Provider = Microsoft.ACE.OLEDB.12.0; Data Source = D:\\\\DATA.accdb\");\n    }\n\n    public void readfromdb() {\n\n        con1.Open();\n      (...)\n      }\n</code></pre>\n\n<p>However If I place the line from makeconn that creates the con1 connection object into the top of readfromdb and only run readfromdb everything works fine.\nSo why isn't the readfromdb method able to \"see\" the con1 object i created in the makeconn method - I thought any variables in a class are visible to all methods in the that same class ?? </p>\n"}, {"tags": ["c#", "oauth-2.0", "openid", "identityserver4"], "comments": [{"owner": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507748149, "post_id": 46695567, "comment_id": 80338957, "body": "what is the json returned from your POST?  and then what are you using from the POST for your GET?"}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "reply_to_user": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507748483, "post_id": 46695567, "comment_id": 80339138, "body": "updated with more info. Check the token here: <a href=\"https://jwt.io/#debugger\" rel=\"nofollow noreferrer\">jwt.io/#debugger</a>  ;-)"}, {"owner": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507748594, "post_id": 46695567, "comment_id": 80339174, "body": "are you are passing everything but the quotes for that access_token?"}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "reply_to_user": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507748652, "post_id": 46695567, "comment_id": 80339204, "body": "without quotes yes! Problem is also not the expiration time... my wild guess is something like that here: <a href=\"https://github.com/IdentityServer/IdentityServer3/issues/703\" rel=\"nofollow noreferrer\">github.com/IdentityServer/IdentityServer3/issues/703</a> quote:&quot;Ok, your error indicates that the SSL cert IdentityServer is using is not trusted for the token validation from the Web API project to IdentityServer. IOW, you need to establish machine trust to your SSL cert (not just clicking &quot;ignore SSL error&quot; in the browser).&quot;"}, {"owner": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507748717, "post_id": 46695567, "comment_id": 80339233, "body": "sorry for the silly questions, but needed to be sure.  does this happen with postman? and the app you created?"}, {"owner": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507748845, "post_id": 46695567, "comment_id": 80339296, "body": "I have NOT used the IdentityServer so knowledge is vague.  have you checked the error logs for IdentityServer (assuming they exist)?  Event Viewer?  anywhere else besides what postman is reporting?"}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "reply_to_user": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507749008, "post_id": 46695567, "comment_id": 80339380, "body": "yes with postman. I have created a self signed certificate for identity server which is put into my user account in the thrusted store so I was able at all to make a Post request to /connect/token. The certificate fixed that problem."}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "reply_to_user": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507749401, "post_id": 46695567, "comment_id": 80339557, "body": "I have not more logging information!"}, {"owner": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507749456, "post_id": 46695567, "comment_id": 80339581, "body": "the installed certificate allowed you to post but didn&#39;t fix the issue?"}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "reply_to_user": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507749568, "post_id": 46695567, "comment_id": 80339632, "body": "the installed certificate just allowed me to POST yes. But maybe I still have to do more with it...dont know."}, {"owner": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507837870, "post_id": 46695567, "comment_id": 80381907, "body": "I am sorry I cannot help further, maybe all of the back and forth will be enough for someone more knowledgeable with IdentityServer can help"}, {"owner": {"reputation": 1417, "user_id": 6835380, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/D0iXZ.jpg?s=128&g=1", "display_name": "aaronR", "link": "https://stackoverflow.com/users/6835380/aaronr"}, "edited": false, "score": 0, "creation_date": 1508461562, "post_id": 46695567, "comment_id": 80629833, "body": "Do you have a separate API project from the IdentityServer4 project?"}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "edited": false, "score": 0, "creation_date": 1508525563, "post_id": 46695567, "comment_id": 80658539, "body": "2 projects. IdentityProvider and Api project."}], "answers": [{"comments": [{"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "edited": false, "score": 0, "creation_date": 1508585299, "post_id": 46854562, "comment_id": 80672953, "body": "sorry Alex I thought I posted all code... I have updated my question with more information."}, {"owner": {"reputation": 9906, "user_id": 336378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ee9272dbc4fd98a65807b5149559b1eb?s=128&d=identicon&r=PG", "display_name": "Alex AIT", "link": "https://stackoverflow.com/users/336378/alex-ait"}, "reply_to_user": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "edited": false, "score": 0, "creation_date": 1508586222, "post_id": 46854562, "comment_id": 80673204, "body": "See if this can resolve the kestrel error in your log: <a href=\"https://stackoverflow.com/questions/38839034/cannot-debug-in-visual-studio-after-changing-the-port-number\" title=\"cannot debug in visual studio after changing the port number\">stackoverflow.com/questions/38839034/&hellip;</a> also could you add your example token again? Also try renaming your client teachers_test_client while keeping scope and api the same. Lastly, try removing the certificate from your setup to reduce the possible error sources:  .AddSigningCredential"}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "edited": false, "score": 0, "creation_date": 1508599281, "post_id": 46854562, "comment_id": 80677007, "body": "Token is added again. Renamed the clientId to &#39;teachers_test_client&#39;. Removed the certificate with AddSigningCredential and got this error:                     &lt;h2 class=&quot;stackerror&quot;&gt;InvalidOperationException: No signing credential is configured. Can&amp;#x27;t create JWT token&lt;/h2&gt;"}, {"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "edited": false, "score": 0, "creation_date": 1508599672, "post_id": 46854562, "comment_id": 80677117, "body": "I will upload the test project to github this evening :-)"}], "tags": [], "owner": {"reputation": 9906, "user_id": 336378, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ee9272dbc4fd98a65807b5149559b1eb?s=128&d=identicon&r=PG", "display_name": "Alex AIT", "link": "https://stackoverflow.com/users/336378/alex-ait"}, "is_accepted": false, "score": 0, "last_activity_date": 1508521393, "creation_date": 1508521393, "answer_id": 46854562, "question_id": 46695567, "link": "https://stackoverflow.com/questions/46695567/token-from-identity-server-connection-token-is-not-valid-for-my-api/46854562#46854562", "title": "Token from identity server connection\\token is not valid for my API", "body": "<p>This can happen if you request a \"wrong\" token.</p>\n\n<p>Assuming you have Client C calling API A, \"POST GetToken\" would look something like this:</p>\n\n<ul>\n<li>ClientId: C.ClientId</li>\n<li>Resource: A.Resource (\"audience\")</li>\n</ul>\n\n<p>Your token suggests that you are doing the following request</p>\n\n<ul>\n<li>ClientId: teachers_test_planner</li>\n<li>Resource/Audience: \"<a href=\"http://localhost:65535/resources\" rel=\"nofollow noreferrer\">http://localhost:65535/resources</a>\" &amp;   \"teachers_test_planner\"</li>\n</ul>\n\n<p>Is \"<a href=\"http://localhost:65535/resources\" rel=\"nofollow noreferrer\">http://localhost:65535/resources</a>\" the audience of your target API?</p>\n"}, {"comments": [{"owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "edited": false, "score": 0, "creation_date": 1508957033, "post_id": 46932240, "comment_id": 80826868, "body": "I tried it on my production solution and it works there, thanks. Tested with postman. I was just that I added AddIdentityServerAuthentication and I did not app.UseAuthentication... the other corrections are due to copy/paste errors from production to github test solution :-)"}, {"owner": {"reputation": 2898, "user_id": 3501052, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QwJvY.jpg?s=128&g=1", "display_name": "MJK", "link": "https://stackoverflow.com/users/3501052/mjk"}, "reply_to_user": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "edited": false, "score": 0, "creation_date": 1508964143, "post_id": 46932240, "comment_id": 80830630, "body": "Glad it works for you. @Elisabeth thanks for the bounty, this is my first earned bounty :)"}], "tags": [], "owner": {"reputation": 2898, "user_id": 3501052, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QwJvY.jpg?s=128&g=1", "display_name": "MJK", "link": "https://stackoverflow.com/users/3501052/mjk"}, "is_accepted": true, "score": 2, "last_activity_date": 1508945395, "last_edit_date": 1592644375, "creation_date": 1508933883, "answer_id": 46932240, "question_id": 46695567, "link": "https://stackoverflow.com/questions/46695567/token-from-identity-server-connection-token-is-not-valid-for-my-api/46932240#46932240", "title": "Token from identity server connection\\token is not valid for my API", "body": "<p>All you missed is <code>app.UseAuthentication()</code>. You have to add this into <code>Configure</code> method on Api <code>startup.cs</code></p>\n<pre><code>public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)\n{\n    loggerFactory.AddConsole(); // Configuration.GetSection(&quot;Logging&quot;));\n    loggerFactory.AddDebug();\n\n    app.UseAuthentication();// The missing line\n\n    app.UseStaticFiles();\n\n    app.UseMvc();\n}\n</code></pre>\n<p>I write the following consle app to test calling your api</p>\n<pre><code>class Program\n{\n    public static void Main(string[] args) =&gt; MainAsync().GetAwaiter().GetResult();\n\n    private static async Task MainAsync()\n    {\n        // discover endpoints from metadata\n        var disco = await DiscoveryClient.GetAsync(&quot;http://localhost:65535&quot;);\n            \n        // request token\n        var tokenClient = new TokenClient(disco.TokenEndpoint, &quot;teachers_test_client&quot;, &quot;secret&quot;);\n        var tokenResponse = await tokenClient.RequestClientCredentialsAsync(&quot;teachers_test_planner&quot;);\n\n        if (tokenResponse.IsError)\n        {\n            Console.WriteLine(tokenResponse.Error);\n            return;\n        }\n\n        Console.WriteLine(tokenResponse.Json);\n        Console.WriteLine(&quot;\\n\\n&quot;);\n\n        // call api\n        var client = new HttpClient();\n        client.SetBearerToken(tokenResponse.AccessToken);\n\n        var response = await client.GetAsync(&quot;http://localhost:52129/api/values/1&quot;);\n        if (!response.IsSuccessStatusCode)\n        {\n            Console.WriteLine(response.StatusCode);\n        }\n        else\n        {\n            var content = await response.Content.ReadAsStringAsync();\n            Console.WriteLine(content);\n        }\n        Console.ReadKey();\n    }\n}\n</code></pre>\n<p>You could try on the postman, i haven't tried that</p>\n<p>However, I had to change few more things on your project(github) to make it run on my machine. And they are</p>\n<p>Project: <code>IdentityProvider</code></p>\n<ul>\n<li><code>mytestplanner.pfx</code> was not set to <strong>Copy Always</strong></li>\n</ul>\n<p>Project: <code>Api2</code></p>\n<ul>\n<li>uninstall IdentityServer4 package. Why do you need IdentityServer4 on the client?</li>\n<li>Change target framework from <code>&lt;TargetFramework&gt;net462&lt;/TargetFramework&gt;</code> to <code>&lt;TargetFramework&gt;netcoreapp2.0&lt;/TargetFramework&gt;</code>, (the reason is that 4.6.2 is not installed on my machine)</li>\n</ul>\n<p>Anyway, let me know if this works for you</p>\n<h2>Update</h2>\n<p>I have added the working project <a href=\"https://github.com/jobairkhan/IdS4Test\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 18152, "user_id": 320460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f01a0f0ee570e81375d7261711cad52b?s=128&d=identicon&r=PG", "display_name": "Elisabeth", "link": "https://stackoverflow.com/users/320460/elisabeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7924, "favorite_count": 1, "accepted_answer_id": 46932240, "answer_count": 2, "score": 6, "last_activity_date": 1508945395, "creation_date": 1507748007, "last_edit_date": 1508875842, "question_id": 46695567, "link": "https://stackoverflow.com/questions/46695567/token-from-identity-server-connection-token-is-not-valid-for-my-api", "title": "Token from identity server connection\\token is not valid for my API", "body": "<p>I am getting a token from my identityserver 4 via url connection/token with a POST request:</p>\n\n<p>Then I copy/paste the value of the access_token key to my API GET request as a header:</p>\n\n<p><strong>mytokenstring</strong></p>\n\n<p>eyJhbGciOiJSUzI1NiIsImtpZCI6IkYxMDhCODA2NUNFMTRBOEEwOTZBODUyMkIxQUNBMkFDMTdEQjQwNEEiLCJ0eXAiOiJKV1QiLCJ4NXQiOiI4UWk0Qmx6aFNvb0phb1Vpc2F5aXJCZmJRRW8ifQ.eyJuYmYiOjE1MDg1OTU5MzIsImV4cCI6MTUwODU5OTUzMiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo2NTUzNSIsImF1ZCI6WyJodHRwOi8vbG9jYWxob3N0OjY1NTM1L3Jlc291cmNlcyIsInRlYWNoZXJzX3Rlc3RfcGxhbm5lciJdLCJjbGllbnRfaWQiOiJ0ZWFjaGVyc190ZXN0X3BsYW5uZXIiLCJzY29wZSI6WyJ0ZWFjaGVyc190ZXN0X3BsYW5uZXIiXX0.g2x31JcYrXyIavfxCu7UKY3kndznI_gYHJYCxl0dQn3u7l7vWo6qKr13XYMo6P1Lqtu68T2FEXL-5kyS0XwFClpdJE6m13-hfKZsd2QHBmOlgZ2ANwghXW4hfU5nWiwkUACwkP9wfDCULV3oQm5i49L5TQmUiiqcy0TTS2FDBdS5ymFBi1bCKnPh5ErsD8V_4eTqLzxv8CyVkPx2gPd6aBIf_2JNrjrMrrm69kghOHnktVG17KPQhppbIeJO8RP-URiJUJGXIY09yRGVF7YXtkFj-I5QOMvNIAWgUeqNYqH0cuQol9nglA4mtU1MfXtnRoEpRRzGViw7gxJ_-MFadA</p>\n\n<p>Authorization: Bearer <strong>mytokenstring</strong></p>\n\n<p>What can cause that the token from the identity server is not valid for my API?</p>\n\n<p>I get a 401 error with <strong>POSTMAN</strong></p>\n\n<p>Looking into the output of the kestrel server I get this:</p>\n\n<pre><code>Api&gt; fail: Microsoft.AspNetCore.Server.IISIntegration.IISMiddleware[0]\nApi&gt;       'MS-ASPNETCORE-TOKEN' does not match the expected pairing token '52da49ee-6599-483a-b97a-15ced1603005', request rejected.\n</code></pre>\n\n<p>What do I wrong and what pairing token Guid is that?</p>\n\n<p><strong>API HttpGet:</strong></p>\n\n<p>header:</p>\n\n<p>Authorization Bearer eyJh...UntilTheEndOfTheString</p>\n\n<p>IdentityServer setup:</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    string certificateFilePath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, \"certifiateselfsigned.pfx\");\n\n    var certificate = new X509Certificate2(certificateFilePath, \"test\");\n\n    services.AddIdentityServer()\n    .AddSigningCredential(certificate)\n        .AddInMemoryApiResources(InMemoryConfiguration.GetApiResources())\n        .AddInMemoryClients(InMemoryConfiguration.GetClients())\n        .AddTestUsers(InMemoryConfiguration.GetUsers());\n\n    services.AddMvc();\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p><strong>Api</strong></p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    services.AddAuthentication(options =&gt;\n    {\n        options.DefaultScheme = JwtBearerDefaults.AuthenticationScheme;\n\n        })\n            .AddIdentityServerAuthentication(opt =&gt;\n           {\n               opt.RequireHttpsMetadata = false;\n               opt.Authority = \"http://localhost:65535\"; // IdentityProvider =&gt; port running IDP on\n               opt.ApiName = \"teachers_test_planner\"; // IdentityProvider =&gt; api resource name\n           });\n\n    services.AddMvc();\n}\n</code></pre>\n\n<p><strong>IdentityProvider</strong></p>\n\n<pre><code>public static class InMemoryConfiguration\n{\n    public static List&lt;TestUser&gt; GetUsers()\n    {\n        return new List&lt;TestUser&gt;\n    {\n        new TestUser{ SubjectId = \"6ed26693-b0a1-497e-aa14-7b880536920f\", Username = \"orders.tatum@gmail.com\", Password = \"mypassword\",\n            Claims = new List&lt;Claim&gt;\n            {\n                new Claim(\"family_name\", \"tatum\")\n            }\n        }\n    };\n    }\n\n    public static IEnumerable&lt;ApiResource&gt; GetApiResources()\n    {\n        return new List&lt;ApiResource&gt;\n    {\n        new ApiResource(\"teachers_test_planner\", \"Mein Testplaner\")\n    };\n    }\n\n    public static IEnumerable&lt;IdentityResource&gt; GetIdentyResources()\n    {\n        return new List&lt;IdentityResource&gt;\n    {\n        new IdentityResources.OpenId(),\n        new IdentityResources.Profile(),\n    };\n    }\n\n    public static IEnumerable&lt;Client&gt; GetClients()\n    {\n        return new List&lt;Client&gt;\n    {\n        new Client\n        {\n            ClientId = \"teachers_test_planner\",\n            ClientSecrets = new[]{ new Secret(\"secret\".Sha256()) },\n            AllowedGrantTypes = GrantTypes.ResourceOwnerPasswordAndClientCredentials,\n            AllowedScopes = new []{ \"teachers_test_planner\" }\n        }\n    };\n    }\n}\n</code></pre>\n\n<p><strong>UPDATE 2</strong></p>\n\n<p>You can find the test project here:</p>\n\n<p><a href=\"https://github.com/LisaTatum/IdentityServer4Test\" rel=\"noreferrer\">https://github.com/LisaTatum/IdentityServer4Test</a></p>\n\n<p><strong>UPDATE 3</strong></p>\n\n<p>As nobody asked how I do the http_post to the connect/token endpoint here it is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JevOd.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/JevOd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "asp.net", "dependency-injection", "asp.net-core", "asp.net-core-2.0"], "comments": [{"owner": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 0, "creation_date": 1507751188, "post_id": 46695557, "comment_id": 80340427, "body": "Maybe <code>services.AddTransient&lt;MyObject &gt;();</code>"}, {"owner": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "reply_to_user": {"reputation": 59385, "user_id": 2630078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UHzHh.png?s=128&g=1", "display_name": "Kirk Larkin", "link": "https://stackoverflow.com/users/2630078/kirk-larkin"}, "edited": false, "score": 0, "creation_date": 1507751548, "post_id": 46695557, "comment_id": 80340636, "body": "@Kirk Ready, I included more details"}, {"owner": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "reply_to_user": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 0, "creation_date": 1507751591, "post_id": 46695557, "comment_id": 80340650, "body": "@IvanMilosavljevic I need to avoid this."}, {"owner": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "reply_to_user": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 0, "creation_date": 1507751926, "post_id": 46695557, "comment_id": 80340853, "body": "@IvanMilosavljevic yes I know but I need to avoid this. It is possible to do in Unity."}, {"owner": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 1, "creation_date": 1507752360, "post_id": 46695557, "comment_id": 80341084, "body": "Are you strictly using Microsoft DI? There is <a href=\"http://docs.autofac.org/en/latest/register/prop-method-injection.html\" rel=\"nofollow noreferrer\">autofac property injection</a>."}, {"owner": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "reply_to_user": {"reputation": 799, "user_id": 497177, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4c10e145d31130fcb978f87ff4546022?s=128&d=identicon&r=PG", "display_name": "Ivan Milosavljevic", "link": "https://stackoverflow.com/users/497177/ivan-milosavljevic"}, "edited": false, "score": 0, "creation_date": 1507752507, "post_id": 46695557, "comment_id": 80341152, "body": "@IvanMilosavljevic yes, I only can use ms DI"}], "answers": [{"comments": [{"owner": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "edited": false, "score": 0, "creation_date": 1507752035, "post_id": 46696423, "comment_id": 80340921, "body": "yes I know this, but I need to avoid this. It is possible to do in Unity."}, {"owner": {"reputation": 11059, "user_id": 185123, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Fsyqo.jpg?s=128&g=1", "display_name": "spottedmahn", "link": "https://stackoverflow.com/users/185123/spottedmahn"}, "reply_to_user": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "edited": false, "score": 0, "creation_date": 1507752133, "post_id": 46696423, "comment_id": 80340972, "body": "Sorry, I don&#39;t follow.  Do you have an Unity example?"}, {"owner": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "edited": false, "score": 1, "creation_date": 1507757076, "post_id": 46696423, "comment_id": 80343262, "body": "I included a example"}], "tags": [], "owner": {"reputation": 11059, "user_id": 185123, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/Fsyqo.jpg?s=128&g=1", "display_name": "spottedmahn", "link": "https://stackoverflow.com/users/185123/spottedmahn"}, "is_accepted": false, "score": 0, "last_activity_date": 1507751550, "creation_date": 1507751550, "answer_id": 46696423, "question_id": 46695557, "link": "https://stackoverflow.com/questions/46695557/asp-net-core-2-0-dependency-injection-default-instance/46696423#46696423", "title": "ASP.NET Core 2.0 Dependency Injection default instance", "body": "<p>You can add them to DI via</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>services.AddScoped&lt;MyObject&gt;();\n</code></pre>\n\n<p>or something more complicated like</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>services.AddScoped(provider =&gt;\n{\n    var res = new MyObject\n    {\n        Message = \"Hello World 2\"\n    };\n    return res;\n});\n</code></pre>\n\n<p>where you can constructor the object yourself.</p>\n\n<p><a href=\"https://github.com/spottedmahn/Experiments/tree/master/DI-2\" rel=\"nofollow noreferrer\">Sample prj here</a></p>\n"}, {"comments": [{"owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 1, "creation_date": 1507776447, "post_id": 46697962, "comment_id": 80348385, "body": "Creating extensions like this could be more easily reusable if someone were to take the initiative. If Microsoft rejects the idea of adding these to their own library, there is nothing stopping anyone from creating their own NuGet.org package that provides them for the masses."}, {"owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "reply_to_user": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 3, "creation_date": 1507793454, "post_id": 46697962, "comment_id": 80354539, "body": "@NightOwl888 There is nothing stopping <i>you</i> from doing exactly that. If you look on NuGet, there are actually quite a few extension packages available for certain parts of the framework. \u2013 That being said, I\u2019m personally not a fan of convention based DI setups. If you really <i>need</i> them, then you should make it very explicit that this is happening. Those few lines don\u2019t really hurt and convey the intention very clearly."}], "tags": [], "owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "is_accepted": true, "score": 4, "last_activity_date": 1507793304, "last_edit_date": 1507793304, "creation_date": 1507757853, "answer_id": 46697962, "question_id": 46695557, "link": "https://stackoverflow.com/questions/46695557/asp-net-core-2-0-dependency-injection-default-instance/46697962#46697962", "title": "ASP.NET Core 2.0 Dependency Injection default instance", "body": "<p>The built-in dependency injection container, <code>Microsoft.Extensions.DependencyInjection</code>, does not support convention based registration. So when you would usually set up some convention that e.g. all types within a namespace will be registered as a transient dependency, this does not work out of the box with the standard container.</p>\n\n<p>If you still want to do this, you would either have to change the dependency injection container to a more powerful one (remember that the built-in container is <em>by design</em> a very slim one), or create your own convention-based logic to register your dependencies. For example, you could simply loop through the current assembly and check for all types within a certain namespace and register those:</p>\n\n<pre><code>var types = Assembly.GetExecutingAssembly()\n    .GetTypes()\n    .Where(t =&gt; t.Namespace == \"Your.Custom.Namespace\");\n\nforeach (var type in types)\n{\n    services.AddTransient(type);\n}\n</code></pre>\n\n<hr>\n\n<p>If you don\u2019t want to register <em>all</em> the types, there is one more thing you can do. There are the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.activatorutilities?view=aspnetcore-2.0\" rel=\"nofollow noreferrer\">activator utilities</a> which offer a way to construct objects of types that are not registered themselves in the container, but require dependencies <em>from</em> the container to be constructed. You can use the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.dependencyinjection.activatorutilities.createinstance\" rel=\"nofollow noreferrer\"><code>ActivatorUtilities.CreateInstance</code></a> method to create an object. For example, with your service definition, you could create a <code>MyObject</code> instance like this:</p>\n\n<pre><code>var myObject = ActivatorUtilities.CreateInstance&lt;MyObject&gt;(serviceCollection);\n</code></pre>\n\n<p>This will automatically get the <code>IOther</code> from the container and inject it into the constructor of <code>MyObject</code>. <code>MyObject</code> does not need to be registered for this, but <code>IOther</code> does.</p>\n\n<p>So this only works for instantiating types that are not registered in the container. It does not work <em>for dependencies</em> that are required by other types. Dependency injection can only automatically provide instances for those dependencies that are registered in the dependency injection container.</p>\n\n<p>So you <em>cannot</em> create a <code>MyService</code> object through dependency injection since its dependency, <code>MyObject</code>, is not registered. There is no way around this, you <em>have</em> to register it if you want the DI framework to automatically instantiate the object for you.</p>\n"}], "owner": {"reputation": 14441, "user_id": 138071, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d6468f441fdf3940cea18ff5b7f1d3e3?s=128&d=identicon&r=PG", "display_name": "andres descalzo", "link": "https://stackoverflow.com/users/138071/andres-descalzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1820, "favorite_count": 0, "accepted_answer_id": 46697962, "answer_count": 2, "score": 3, "last_activity_date": 1507812895, "creation_date": 1507747966, "last_edit_date": 1507812895, "question_id": 46695557, "link": "https://stackoverflow.com/questions/46695557/asp-net-core-2-0-dependency-injection-default-instance", "title": "ASP.NET Core 2.0 Dependency Injection default instance", "body": "<p>I'm using <code>ASP.NET Core 2.0</code> and <code>Microsoft.Extensions.DependencyInjection</code>. I have a few class where I don't want to specified its implementation or I don't need to specified. </p>\n\n<p>For example:</p>\n\n<pre><code>public interface IMyService\n{\n    void WriteSomething();\n}\n\npublic class MyService : IMyService\n{\n    private readonly MyObject myObject;\n\n    public MyService(MyObject myObject)\n    {\n        this.myObject = myObject;\n    }\n\n    public void WriteSomething()\n    {\n        this.myObject.Write();\n    }\n}\n\npublic interface IOther\n{\n    string GetName();\n}\n\npublic class Other : IOther\n{\n    public string GetName()\n    {\n        return \"james bond\";\n    }\n}\n\npublic class MyObject\n{\n    private readonly IOther other;\n\n    public MyObject(IOther other)\n    {\n        this.other = other;\n    }\n\n    public void Write()\n    {\n        Console.WriteLine(string.Concat(\"hi \", this.other.GetName()));\n    }\n}\n\npublic class Startup\n{\n    public void ConfigureServices(IServiceCollection services)\n    {\n        ...\n        services.AddScoped&lt;IOther, Other&gt;();\n        services.AddScoped&lt;IMyService, MyService&gt;();\n        ...\n    }\n}\n</code></pre>\n\n<p>and I want to specified only <code>IMyToolGeneral</code> with <code>MyToolGeneral</code> and <code>IOther</code> with <code>Other</code>, but <code>MyObject</code> not, because I have a lot of classes like this (validators, helpers, ...) and I don't need to specified these.</p>\n\n<p>how can I do that in <code>ASP.NET Core 2.0</code>?</p>\n\n<p><strong>edit</strong></p>\n\n<p>I need that  <code>ASP.NET Core 2.0 DI</code> can inject a instance of MyObject without specified it in DI configuration. MyObject haven't a contract (interface) o base class, and all parameters in its constructor are specified in DI configuration.</p>\n\n<p><strong>edit II</strong> \nI rewrite classes and include a example in Unity (that works) and the same example in MS DI (that dont' work)</p>\n\n<p><strong>unity example (work)</strong></p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        var container = UnityConfig();\n\n        var service = container.Resolve&lt;IMyService&gt;();\n\n        service.WriteSomething();\n\n        Console.ReadKey();\n    }\n\n    static UnityContainer UnityConfig()\n    {\n        var container = new UnityContainer();\n\n        container.RegisterType&lt;IMyService, MyService&gt;();\n\n        container.RegisterType&lt;IOther, Other&gt;();\n\n        return container;\n    }\n}\n</code></pre>\n\n<p><strong>MS DI (don't work)</strong>\nUnhandled Exception: System.InvalidOperationException: Unable to resolve service for type 'ConsoleDI.MyObject' while attempting to activate 'ConsoleDI.MyService'.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        var serviceProvider = new ServiceCollection()\n                .AddTransient&lt;IMyService, MyService&gt;()\n                .AddTransient&lt;IOther, Other&gt;()\n                .BuildServiceProvider();\n\n        var service = serviceProvider.GetService&lt;IMyService&gt;();\n\n        service.WriteSomething();\n\n        Console.ReadKey();\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "azure", "azure-ad-b2c", "azure-ad-graph-api"], "answers": [{"tags": [], "owner": {"reputation": 12365, "user_id": 7378174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d363b6d7b360ed5e0094cd7a3bfb0f94?s=128&d=identicon&r=PG", "display_name": "Chris Padgett", "link": "https://stackoverflow.com/users/7378174/chris-padgett"}, "is_accepted": true, "score": 1, "last_activity_date": 1508103130, "last_edit_date": 1508103130, "creation_date": 1507759464, "answer_id": 46698254, "question_id": 46695526, "link": "https://stackoverflow.com/questions/46695526/azure-ad-b2c-my-app-has-businesses-and-their-employees/46698254#46698254", "title": "Azure AD B2C - my app has Businesses and their Employees", "body": "<p>The \"TenantDetail\" entity contains details for the Azure AD tenant rather than users.</p>\n\n<p>You should create a custom attribute for representing the company name for a registered user as described at <a href=\"https://docs.microsoft.com/en-us/azure/active-directory-b2c/active-directory-b2c-reference-custom-attr\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>You can get and set this custom attribute for the user objects using the Graph API as documented at <a href=\"https://docs.microsoft.com/en-us/azure/active-directory-b2c/active-directory-b2c-devquickstarts-graph-dotnet#use-custom-attributes\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 3116, "user_id": 2896495, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/42c90f6a4aa3a6adf856c6d3cafc54a1?s=128&d=identicon&r=PG&f=1", "display_name": "alvipeo", "link": "https://stackoverflow.com/users/2896495/alvipeo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 46698254, "answer_count": 1, "score": 0, "last_activity_date": 1508103130, "creation_date": 1507747840, "question_id": 46695526, "link": "https://stackoverflow.com/questions/46695526/azure-ad-b2c-my-app-has-businesses-and-their-employees", "title": "Azure AD B2C - my app has Businesses and their Employees", "body": "<p>I'm trying to create a custom login form with Azure B2C, primarily because I need every registered user to be approved. So I created a lib which has <code>CreateUser</code> method and it uses Graph API to do so. Now, I see <code>jobTitle</code>, <code>department</code>, <code>physicalDeliveryOfficeName</code> properties for a User (<strong><a href=\"https://msdn.microsoft.com/library/azure/ad/graph/api/entity-and-complex-type-reference#user-entity\" rel=\"nofollow noreferrer\">here</a></strong>) but I don't see a <strong>Company Name</strong>!</p>\n\n<p>I've found <strong>TenantDetail Entity</strong> at the same page and I'd like to know how are they related and should I create this <code>TenantDetail Entity</code> first and then associate new users to it?</p>\n\n<p>As a reminder, this is just for having multiple users in my app which may work for a different companies (businesses).</p>\n\n<p>Consequently, I may have <em>Edit user details</em> page later.</p>\n"}, {"tags": ["c#", "asp.net-web-api", "unity-container"], "comments": [{"owner": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1507748264, "post_id": 46695517, "comment_id": 80339023, "body": "Are you able to trap it in Global <code>Application_Error()</code>?"}, {"owner": {"reputation": 153, "user_id": 4301579, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ee78df5540665c201ad3fc544b0916a5?s=128&d=identicon&r=PG&f=1", "display_name": "KrimblKrum", "link": "https://stackoverflow.com/users/4301579/krimblkrum"}, "reply_to_user": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1507840867, "post_id": 46695517, "comment_id": 80383410, "body": "No, I&#39;m not.  It seems that the error is being caught by something, and then packaged as a HTTP 200 response with an XML representation of the error in the body.  I don&#39;t know what that &quot;something&quot; is though."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 4301579, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ee78df5540665c201ad3fc544b0916a5?s=128&d=identicon&r=PG&f=1", "display_name": "KrimblKrum", "link": "https://stackoverflow.com/users/4301579/krimblkrum"}, "is_accepted": false, "score": 2, "last_activity_date": 1509160746, "last_edit_date": 1509160746, "creation_date": 1509159890, "answer_id": 46985836, "question_id": 46695517, "link": "https://stackoverflow.com/questions/46695517/resolutionfailedexception-returned-as-success/46985836#46985836", "title": "ResolutionFailedException Returned As Success", "body": "<p>I found the answer here: <a href=\"https://stackoverflow.com/questions/16028919/catch-all-unhandled-exceptions-in-asp-net-web-api#answer-16158704\">catch all unhandled exceptions in ASP.NET Web Api</a></p>\n\n<p>I learned the following things when implementing my preferred solution:</p>\n\n<ul>\n<li>The full error w/ stack trace is only visible because of the CustomErrors setting. I forgot that I was running everything locally and CustomErrors=RemoteOnly.</li>\n<li>If I only want to catch the exceptions and log them, then add an IExceptionLogger. This is the solution I implemented for my current needs.</li>\n<li>If I want to catch the exception and manipulate the response, then <em>replace</em> IExceptionHandler. This is good to know.</li>\n<li>Neither solution captures ALL exceptions. I'm still using Application_Error to capture exceptions that aren't caught within my ApiController methods.</li>\n</ul>\n"}], "owner": {"reputation": 153, "user_id": 4301579, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ee78df5540665c201ad3fc544b0916a5?s=128&d=identicon&r=PG&f=1", "display_name": "KrimblKrum", "link": "https://stackoverflow.com/users/4301579/krimblkrum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1509160746, "creation_date": 1507747788, "question_id": 46695517, "link": "https://stackoverflow.com/questions/46695517/resolutionfailedexception-returned-as-success", "title": "ResolutionFailedException Returned As Success", "body": "<p>I'm using Unity with my WebApi project, and registering types using the config file.  I've been injecting dependencies into controller constructors and it has been working beautifully... until I forgot a type mapping and received the following error:</p>\n\n<blockquote>\n  <p>An error occurred when trying to create a controller of type 'FooController'. Make sure that the controller has a parameterless public constructor.</p>\n</blockquote>\n\n<p>The problem isn't that I received the error.  I can easily add the mapping to resolve it.  The problem is that internals were shared with the client and the client received a HTTP Status Code of 200.</p>\n\n<p>I read a similar article (<a href=\"https://stackoverflow.com/questions/7165439/unity-wraps-exception-to-the-resolutionfailedexception-how-to-avoid\">Unity wraps exception to the ResolutionFailedException. How to avoid?</a>), but those answers were not helpful; stating there is no solution or seeming off topic.  It is difficult for me to accept that there is no solution, so I thought I might rephrase the question in hopes that it will receive a better answer.</p>\n\n<p>How can I catch/intercept the ResolutionFailedException so that a Http Error 500 is returned instead?  Is there an event I can listen for or a class I can wrap in some way?  For example, can I wrap the DefaultHttpControllerActivator and use my wrapper to catch an exception and return it as a HTTP 500 error?  I would expect a HTTP 500 to be filtered from the client based on the CustomErrors configuration setting.  Also, I could log the error to my log file instead of returning details to the client.</p>\n\n<p>Here's a example of the error as XML:</p>\n\n<pre><code>&lt;Error&gt;\n&lt;Message&gt;An error has occurred.&lt;/Message&gt;\n&lt;ExceptionMessage&gt;\nAn error occurred when trying to create a controller of type 'FooController'. Make sure that the controller has a parameterless public constructor.\n&lt;/ExceptionMessage&gt;\n&lt;ExceptionType&gt;System.InvalidOperationException&lt;/ExceptionType&gt;\n&lt;StackTrace&gt;\nat System.Web.Http.Dispatcher.DefaultHttpControllerActivator.Create(HttpRequestMessage request, HttpControllerDescriptor controllerDescriptor, Type controllerType) \nat System.Web.Http.Controllers.HttpControllerDescriptor.CreateController(HttpRequestMessage request) \nat System.Web.Http.Dispatcher.HttpControllerDispatcher.&lt;SendAsync&gt;d__1.MoveNext()\n&lt;/StackTrace&gt;\n&lt;InnerException&gt;\n&lt;Message&gt;An error has occurred.&lt;/Message&gt;\n&lt;ExceptionMessage&gt;\nResolution of the dependency failed, type = \"MyWebApi.API.Controllers.FooController\", name = \"(none)\". Exception occurred while: while resolving. Exception is: InvalidOperationException - The current type, MyWebApi.DataProvider.Interfaces.IFooProvider, is an interface and cannot be constructed. Are you missing a type mapping? ----------------------------------------------- \nAt the time of the exception, the container was: Resolving MyWebApi.API.Controllers.FooController,(none) Resolving parameter \"FooProvider\" of constructor MyWebApi.API.Controllers.FooController(MyWebApi.DataProvider.Interfaces.IFooProvider FooProvider) Resolving MyWebApi.DataProvider.Interfaces.IFooProvider,(none)\n&lt;/ExceptionMessage&gt;\n&lt;ExceptionType&gt;\nMicrosoft.Practices.Unity.ResolutionFailedException\n&lt;/ExceptionType&gt;\n&lt;StackTrace&gt;\nat Microsoft.Practices.Unity.UnityContainer.DoBuildUp(Type t, Object existing, String name, IEnumerable`1 resolverOverrides) \nat Microsoft.Practices.Unity.UnityContainer.Resolve(Type t, String name, ResolverOverride[] resolverOverrides) \nat Microsoft.Practices.Unity.UnityContainerExtensions.Resolve(IUnityContainer container, Type t, ResolverOverride[] overrides) \nat Microsoft.Practices.Unity.WebApi.UnityDependencyResolver.SharedDependencyScope.GetService(Type serviceType) \nat System.Web.Http.Dispatcher.DefaultHttpControllerActivator.GetInstanceOrActivator(HttpRequestMessage request, Type controllerType, Func`1&amp; activator) \nat System.Web.Http.Dispatcher.DefaultHttpControllerActivator.Create(HttpRequestMessage request, HttpControllerDescriptor controllerDescriptor, Type controllerType)\n&lt;/StackTrace&gt;\n&lt;InnerException&gt;\n&lt;Message&gt;An error has occurred.&lt;/Message&gt;\n&lt;ExceptionMessage&gt;\nThe current type, MyWebApi.DataProvider.Interfaces.IFooProvider, is an interface and cannot be constructed. Are you missing a type mapping?\n&lt;/ExceptionMessage&gt;\n&lt;ExceptionType&gt;System.InvalidOperationException&lt;/ExceptionType&gt;\n&lt;StackTrace&gt;\nat Microsoft.Practices.ObjectBuilder2.DynamicMethodConstructorStrategy.ThrowForAttemptingToConstructInterface(IBuilderContext context) \nat lambda_method(Closure , IBuilderContext ) \nat Microsoft.Practices.ObjectBuilder2.DynamicBuildPlanGenerationContext.&lt;&gt;c__DisplayClass1.&lt;GetBuildMethod&gt;b__0(IBuilderContext context) \nat Microsoft.Practices.ObjectBuilder2.DynamicMethodBuildPlan.BuildUp(IBuilderContext context) \nat Microsoft.Practices.ObjectBuilder2.BuildPlanStrategy.PreBuildUp(IBuilderContext context) \nat Microsoft.Practices.ObjectBuilder2.StrategyChain.ExecuteBuildUp(IBuilderContext context) \nat Microsoft.Practices.ObjectBuilder2.BuilderContext.NewBuildUp(NamedTypeBuildKey newBuildKey) \nat Microsoft.Practices.Unity.ObjectBuilder.NamedTypeDependencyResolverPolicy.Resolve(IBuilderContext context) \nat lambda_method(Closure , IBuilderContext ) \nat Microsoft.Practices.ObjectBuilder2.DynamicBuildPlanGenerationContext.&lt;&gt;c__DisplayClass1.&lt;GetBuildMethod&gt;b__0(IBuilderContext context) \nat Microsoft.Practices.ObjectBuilder2.DynamicMethodBuildPlan.BuildUp(IBuilderContext context) \nat Microsoft.Practices.ObjectBuilder2.BuildPlanStrategy.PreBuildUp(IBuilderContext context) \nat Microsoft.Practices.ObjectBuilder2.StrategyChain.ExecuteBuildUp(IBuilderContext context) \nat Microsoft.Practices.Unity.UnityContainer.DoBuildUp(Type t, Object existing, String name, IEnumerable`1 resolverOverrides)\n&lt;/StackTrace&gt;\n&lt;/InnerException&gt;\n&lt;/InnerException&gt;\n&lt;/Error&gt;\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "sql-server", "csv"], "comments": [{"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 1, "creation_date": 1507747632, "post_id": 46695442, "comment_id": 80338704, "body": "Are you able to stream (or otherwise import) the csv into a DataTable?"}, {"owner": {"reputation": 5118, "user_id": 1288545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33fa1a4d6db4dbf552c915e4a8d88c18?s=128&d=identicon&r=PG", "display_name": "Cinchoo", "link": "https://stackoverflow.com/users/1288545/cinchoo"}, "edited": false, "score": 0, "creation_date": 1507759502, "post_id": 46695442, "comment_id": 80344218, "body": "You can try bulk insert using Cinchoo ETL lib, see this article <a href=\"https://www.codeproject.com/Tips/1170498/Cinchoo-ETL-Bulk-Insert-CSV-File-into-SQLServer\" rel=\"nofollow noreferrer\">codeproject.com/Tips/1170498/&hellip;</a> for more information"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "is_accepted": false, "score": 1, "last_activity_date": 1507751120, "creation_date": 1507751120, "answer_id": 46696326, "question_id": 46695442, "link": "https://stackoverflow.com/questions/46695442/turn-csv-stream-parser-sql-insert-into-bulk-insert/46696326#46696326", "title": "Turn csv stream parser sql insert into bulk insert", "body": "<p>You need to create a DataTable and then add a mapping to the datatable so the columns of the DataTable are mapped to the columns of the database.  I got you started by creating and filling the datatable.  Now search web for info on bulk copy datatable to database.</p>\n\n<pre><code>            DataTable dt = new DataTable();\n\n            dt.Columns.Add(\"ItemCode\", typeof(string));\n            dt.Columns.Add(\"Description\", typeof(string));\n            dt.Columns.Add(\"BoxQty\", typeof(int));\n            dt.Columns.Add(\"PalletQty\", typeof(int));\n            dt.Columns.Add(\"Weight\", typeof(decimal));\n            dt.Columns.Add(\"Barcode\", typeof(string));\n\n            //inside while  loop\n            dt.Rows.Add(new object[] {itemCode, description, boxQty, palletQty, weight, barcode});\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4715871, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-VVy4yMu3lLI/AAAAAAAAAAI/AAAAAAAAALU/Mk0VJs66ox8/photo.jpg?sz=128", "display_name": "Tommy Graffam", "link": "https://stackoverflow.com/users/4715871/tommy-graffam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1507751120, "creation_date": 1507747470, "question_id": 46695442, "link": "https://stackoverflow.com/questions/46695442/turn-csv-stream-parser-sql-insert-into-bulk-insert", "title": "Turn csv stream parser sql insert into bulk insert", "body": "<p>I have this specific way of getting a CSV where a web service generates the CSV file in the web browser and I then grab all of the data and parse it and stream it into variables and do an SQL insert for each row. Now the problem is this takes to long and I am not sure how to convert this to do a bulk insert. </p>\n\n<p>my code is below</p>\n\n<pre><code>    using System;\n    using System.Collections.Generic;\n    using System.Linq;\n    using System.Web;\n    using System.Web.UI;\n    using System.Web.UI.WebControls;\n    using System.Net;\n    using System.Text;\n    using System.Windows.Forms;\n    using System.Threading;\n    using System.ComponentModel;\n    using Microsoft.VisualBasic;\n    using Microsoft.VisualBasic.FileIO;\n    using System.IO;\n    using System.Data.SqlClient;\n    using System.Data.Sql;\n\n\n    public partial class _Default : System.Web.UI.Page\n    {\n        protected void Page_Load(object sender, EventArgs e)\n        {\n\n        }\n\n         WebClient client = new WebClient();\n         Uri ur = new Uri(\"http://1.1.1.1/portal/FEDE?ORGANIZATION_ID=96&amp;SERVLET_ACTION=getItemsList\");\n        public void scrapeCSV()\n            {\n\n        Stream myStream = client.OpenRead(ur);\n        StreamReader stream = new StreamReader(myStream);\n        //Parse the stream\n\n        using (TextFieldParser parser = new TextFieldParser(stream))\n        {\n            parser.TextFieldType = FieldType.Delimited;\n            parser.TextFieldType = FieldType.Delimited;\n            parser.SetDelimiters(\",\");\n            int rowCount = 1, colCount = 1;\n            string strInsert = \"\";\n            string rowName = \"\";\n            string itemCode = \"\", description = \"\", barcode = \"\";\n            int boxQty = 0, palletQty = 0;\n            double weight = 0.0;\n            SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings[\"casi\"].ConnectionString);\n            conn.Open();\n            SqlCommand cmd1 = new SqlCommand(\"delete from itemslist\", conn);\n            cmd1.ExecuteNonQuery();\n            while (!parser.EndOfData)\n            {\n                //Processing row\n                string[] row = parser.ReadFields();\n                rowName = row[0].ToString();\n                    if (rowCount &gt; 2) //Skip header row\n                    {\n\n\n                        foreach (string field in row)\n                        {\n                                if (colCount == 1)\n                                {\n                                    itemCode = field;\n                                }\n                                else if (colCount == 2)\n                                {\n\n                                    description = field.Replace(\"'\", \"''\"); ;\n                                }\n                                else if (colCount == 3)\n                                {\n                                    if (field != \"\")\n                                    {\n                                        boxQty = Convert.ToInt32(field);\n                                    }\n                                    else\n                                    {\n                                        boxQty = 0;\n                                    }\n                                }\n                                else if (colCount == 4)\n                                {\n                                    if (field != \"\")\n                                    {\n                                        palletQty = Convert.ToInt32(field);\n                                    }\n                                    else\n                                    {\n                                        palletQty = 0;\n                                    }\n                                }\n                                else if (colCount == 5)\n                                {\n                                    if (field != \"\")\n                                    {\n                                        weight = Convert.ToDouble(field);\n                                    }\n                                    else\n                                    {\n                                        weight = 0.0;\n                                    }\n                                }\n                                else if (colCount == 6)\n                                {\n                                    barcode = field;\n                                }\n                                colCount++; \n                        }\n                        colCount = 1;\n\n\n                        strInsert = @\"INSERT INTO ItemsList (ItemCode, Description, BoxQty, PalletQty,Weight,Barcode)\n    VALUES ('\" + itemCode + \"', '\" + description + \"', '\" + boxQty + \"', '\" + palletQty + \"', '\" + weight + \"', '\" + barcode + \"')\";\n\n\n\n                            SqlCommand cmd2 = new SqlCommand(strInsert, conn);\n\n       try\n        {\n         cmd2.ExecuteNonQuery();\n        }\n    catch (Exception ex)\n         {\n             //put code trace log here such as write a txt file content ex.tostring;\n             if (ex is FormatException || ex is OverflowException)\n\n             {\n                 Response.Write(strInsert);\n                 continue;\n             }\n             //continue;//will run code bellow cmd.ExecuteNonQuery(); or you can put any code running if\n             Response.Write(strInsert);\n             continue;\n         }\n\n                      }\n                    this.Label1.Text = Convert.ToString(rowCount);\n                    rowCount++;\n\n                }\n            conn.Close();\n            }\n        }\n\n        protected void Button1_Click(object sender, EventArgs e)\n        {\n            scrapeCSV();\n            Response.Write(\"Download finished!\");\n        }\n    }\n</code></pre>\n\n<p>If someone is able to help me figure this out that would be very appreciated.</p>\n"}, {"tags": ["c#", ".net", "windows", "registry"], "answers": [{"comments": [{"owner": {"reputation": 2223, "user_id": 5480409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySDx0.png?s=128&g=1", "display_name": "Francesco B.", "link": "https://stackoverflow.com/users/5480409/francesco-b"}, "edited": false, "score": 0, "creation_date": 1509273445, "post_id": 46999162, "comment_id": 80945026, "body": "Btw it&#39;s been almost 20 days since you asked this question; did you come up with something else?"}, {"owner": {"reputation": 867, "user_id": 2494584, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/496f64dad31e72e5eae5c96ffbc635aa?s=128&d=identicon&r=PG", "display_name": "user2494584", "link": "https://stackoverflow.com/users/2494584/user2494584"}, "edited": false, "score": 1, "creation_date": 1509382535, "post_id": 46999162, "comment_id": 80987596, "body": "I have unfortunately not found a solution."}], "tags": [], "owner": {"reputation": 2223, "user_id": 5480409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ySDx0.png?s=128&g=1", "display_name": "Francesco B.", "link": "https://stackoverflow.com/users/5480409/francesco-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1509273320, "creation_date": 1509273320, "answer_id": 46999162, "question_id": 46695416, "link": "https://stackoverflow.com/questions/46695416/open-an-exported-registry-in-c/46999162#46999162", "title": "Open an Exported Registry in C#", "body": "<p>I'm sorry but AFAIK there's no way you can do that with built-in .NET registry functions; you will have to build your own text parser or use one that's already been  made to get the keys inside your file.</p>\n\n<p>See <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/02a19067-16ea-4475-8267-1122a17ca35f/how-to-read-a-regfile-reg?forum=vbgeneral\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://stackoverflow.com/questions/1242023/import-reg-files-using-win32-or-other-libraries\">this</a> saying the same thing; <a href=\"https://github.com/EricZimmerman/Registry\" rel=\"nofollow noreferrer\">this project</a> is a registry parser with about 40 stars on GitHub.</p>\n"}], "owner": {"reputation": 867, "user_id": 2494584, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/496f64dad31e72e5eae5c96ffbc635aa?s=128&d=identicon&r=PG", "display_name": "user2494584", "link": "https://stackoverflow.com/users/2494584/user2494584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509273320, "creation_date": 1507747392, "question_id": 46695416, "link": "https://stackoverflow.com/questions/46695416/open-an-exported-registry-in-c", "title": "Open an Exported Registry in C#", "body": "<p>From different machines, I have exported different branches of the registry. (The whole registry was too large to take in its entirety.)</p>\n\n<p>I have saved these registries on .reg files on my own machine, and so far have only examined them as plaintext. I don't want to open them with Regedit because I don't want the keys to merge with my machine's registry.</p>\n\n<p>In my C# application, in an attempt to determine if a piece of software is installed, I have been examining my machine's existing registry. </p>\n\n<pre><code>string REGISTRY_KEY = @\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\";\nstring REGISTRY_NAME = \"Name of Software\";\nbool is64bit = true;\nRegistryView registryView = is64Bit ? RegistryView.Registry64 : RegistryView.Registry32;\nRegistryKey registryKey = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, registryView).OpenSubKey(REGISTRY_KEY);\nif (registryKey != null)\n{\n    using (registryKey)\n    {\n        foreach (string subkeyName in registryKey.GetSubKeyNames())\n        {\n            using (RegistryKey subkey = registryKey.OpenSubKey(subkeyName))\n            {\n                string displayName = (string)subkey.GetValue(\"DisplayName\");\n                if (displayName != null &amp;&amp; displayName.Contains(REGISTRY_NAME))\n                {\n                    Console.WriteLine( \"Found the program\" );\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>This searches within the 64-bit view of my machine's HKLM.</p>\n\n<p>However, now I want to run this same code, but instead of using my machine's registry file, I want to use one of the exported .reg files I have.\nThe branch I exported from is the <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion</code> branch.</p>\n\n<p>How do I use the RegistryKey tools with C# to open a registry file saved on my machine (but is not the actual registry for my own machine)?</p>\n"}, {"tags": ["c#", "file", "asp.net-web-api"], "comments": [{"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 4, "creation_date": 1507747453, "post_id": 46695394, "comment_id": 80338610, "body": "Imagine a world where any website you visit could copy any file from your computer.  What you&#39;re looking for is an <code>&lt;input type=&quot;file&quot;&gt;</code> for the user to <i>upload</i> a file to the server."}, {"owner": {"reputation": 39, "user_id": 4412682, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea4009d692cc4d3377374931e9f3bb0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack philip", "link": "https://stackoverflow.com/users/4412682/jack-philip"}, "reply_to_user": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507747754, "post_id": 46695394, "comment_id": 80338775, "body": "Yes i&#39;m using &lt;input type=&quot;File&quot;&gt; to get the path from client... But in API server, File.Copy is what is causing the problem... File.Copy Couldn&#39;t find the file..."}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507747866, "post_id": 46695394, "comment_id": 80338816, "body": "Where is <code>File.Copy</code> <i>looking for</i> the file?  Show the complete code you&#39;re using.  If you&#39;re trying to access the client&#39;s file system, obviously that won&#39;t work."}, {"owner": {"reputation": 39, "user_id": 4412682, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea4009d692cc4d3377374931e9f3bb0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack philip", "link": "https://stackoverflow.com/users/4412682/jack-philip"}, "reply_to_user": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507747950, "post_id": 46695394, "comment_id": 80338855, "body": "Yes..i&#39;m trying to access the client file... Is that any other alternative way to achieve this??"}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 1, "creation_date": 1507748230, "post_id": 46695394, "comment_id": 80339004, "body": "The user has to upload the file.  Again, for obvious reasons, a website can\u2019t access the client\u2019s file system.  Use a file input to allow the user to upload the file."}, {"owner": {"reputation": 934, "user_id": 1315390, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BCcQU.png?s=128&g=1", "display_name": "Eric Beaulieu", "link": "https://stackoverflow.com/users/1315390/eric-beaulieu"}, "edited": false, "score": 0, "creation_date": 1507750382, "post_id": 46695394, "comment_id": 80340000, "body": "Once uploaded, files can be access from the server side using Page.Request.Files or HttpContext.Current.Request.Files"}], "answers": [{"tags": [], "owner": {"reputation": 5605, "user_id": 2611237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gd9EW.jpg?s=128&g=1", "display_name": "Andrei Dragotoniu", "link": "https://stackoverflow.com/users/2611237/andrei-dragotoniu"}, "is_accepted": false, "score": 0, "last_activity_date": 1507804134, "creation_date": 1507804134, "answer_id": 46707308, "question_id": 46695394, "link": "https://stackoverflow.com/questions/46695394/move-file-in-client-to-another-drive/46707308#46707308", "title": "Move file in client to another drive", "body": "<p>Think of web api as a web application. As such it will have an application pool which means it will execute everything under that particular identity meaning it is bound by the specific rights of that identity. </p>\n\n<p>Second, being a web app, it doesn't have access to anything outside of its own location. This means that you can't access anything on the user's drive and that's a good thing as that would open major security flaws to just about anyone.</p>\n\n<p>Third when you do stuff like this you really want to work with virtual paths. You can have files under your App_Data for example, but you also have to keep in mind what you are copying from where to where.</p>\n\n<p>You will be able to make it work locally depending on where your application is located, but when deployed to a server, the paths will be different hence why you really want to work with virtual paths and you also need to understand the security implications of what you are building. </p>\n\n<p>If you try to upload a file for example,you can do that in a place under the folder where your application is located not outside of it.</p>\n"}], "owner": {"reputation": 39, "user_id": 4412682, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ea4009d692cc4d3377374931e9f3bb0e?s=128&d=identicon&r=PG&f=1", "display_name": "Jack philip", "link": "https://stackoverflow.com/users/4412682/jack-philip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1507804134, "creation_date": 1507747298, "question_id": 46695394, "link": "https://stackoverflow.com/questions/46695394/move-file-in-client-to-another-drive", "title": "Move file in client to another drive", "body": "<p>I'm trying to copy a file from client to network drive using File.Copy(\"C:\\somepath\\file.bmp\",\"\\xxx\\data\\file.bmp\"). While debugging in local it worked fine, whereas in server it fails to work. I believe File.copy looks in API server's C Drive and it fails to find the file. How do i fix this issue?? Please help me with this... </p>\n"}, {"tags": ["c#", "wpf", "methods", "listbox"], "comments": [{"owner": {"reputation": 1010, "user_id": 275330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/721a8307678bb06684f2f976ece0a2b5?s=128&d=identicon&r=PG", "display_name": "Maciek \u015awiszczowski", "link": "https://stackoverflow.com/users/275330/maciek-%c5%9awiszczowski"}, "edited": false, "score": 0, "creation_date": 1507798301, "post_id": 46695368, "comment_id": 80357280, "body": "Hi Nikola. You wrote a long question, with details on what you want to do in your project, but you didn&#39;t provide a stack for the exception... Try to rewrite this question so that we may help you, remove the details that are unnecessary to understand the issue."}, {"owner": {"reputation": 322, "user_id": 3088451, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/713889313/picture?type=large", "display_name": "Nikola L.", "link": "https://stackoverflow.com/users/3088451/nikola-l"}, "reply_to_user": {"reputation": 1010, "user_id": 275330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/721a8307678bb06684f2f976ece0a2b5?s=128&d=identicon&r=PG", "display_name": "Maciek \u015awiszczowski", "link": "https://stackoverflow.com/users/275330/maciek-%c5%9awiszczowski"}, "edited": false, "score": 0, "creation_date": 1507802859, "post_id": 46695368, "comment_id": 80360257, "body": "@swiszcz I have tried to post my question better. Let me know if there&#39;s somethign missing, and thanks for the help (and tip)."}], "answers": [{"tags": [], "owner": {"reputation": 1010, "user_id": 275330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/721a8307678bb06684f2f976ece0a2b5?s=128&d=identicon&r=PG", "display_name": "Maciek \u015awiszczowski", "link": "https://stackoverflow.com/users/275330/maciek-%c5%9awiszczowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1507811644, "creation_date": 1507811644, "answer_id": 46709725, "question_id": 46695368, "link": "https://stackoverflow.com/questions/46695368/return-a-value-from-the-method-initiated-by-selectionchanged-event/46709725#46709725", "title": "Return a value from the method initiated by SelectionChanged event", "body": "<p>Thanks for the post edit. </p>\n\n<p>I'd recommend you to use <code>ObservableCollection&lt;string&gt;</code> to keep your list of items to display and bind this observable collection to XMLista.ItemsSource (or assign in the code behind). Now operate on this ObsevableCollection only (add or remove items). That's the recommended way of using collection controls in WPF and nobody has issues with that.</p>\n\n<p>I'm guessing that the exception you get may be caused by operating erroneously on the XMLista.Items level. </p>\n"}, {"comments": [{"owner": {"reputation": 322, "user_id": 3088451, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/713889313/picture?type=large", "display_name": "Nikola L.", "link": "https://stackoverflow.com/users/3088451/nikola-l"}, "edited": false, "score": 0, "creation_date": 1507823100, "post_id": 46712269, "comment_id": 80373928, "body": "I tested this out and it works. But I don&#39;t get it? I was quite positive that I get the value needed for the removing to work (I even included the messagebox to say it to me once selected). How is this working differently?"}, {"owner": {"reputation": 133235, "user_id": 7252182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUgxG.png?s=128&g=1", "display_name": "mm8", "link": "https://stackoverflow.com/users/7252182/mm8"}, "reply_to_user": {"reputation": 322, "user_id": 3088451, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/713889313/picture?type=large", "display_name": "Nikola L.", "link": "https://stackoverflow.com/users/3088451/nikola-l"}, "edited": false, "score": 0, "creation_date": 1507885473, "post_id": 46712269, "comment_id": 80398561, "body": "The SelectionChanged event handler may be invoked before the elements have been initialized."}], "tags": [], "owner": {"reputation": 133235, "user_id": 7252182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LUgxG.png?s=128&g=1", "display_name": "mm8", "link": "https://stackoverflow.com/users/7252182/mm8"}, "is_accepted": true, "score": 1, "last_activity_date": 1507818683, "creation_date": 1507818683, "answer_id": 46712269, "question_id": 46695368, "link": "https://stackoverflow.com/questions/46695368/return-a-value-from-the-method-initiated-by-selectionchanged-event/46712269#46712269", "title": "Return a value from the method initiated by SelectionChanged event", "body": "<p>Check that the elements have been initialized and that there is a selected item:</p>\n\n<pre><code>private void XMLista_SelectionChanged(object sender, SelectionChangedEventArgs e)\n{\n    if (brisanjeDugme != null)\n        brisanjeDugme.IsEnabled = true;\n    if(XMLista != null &amp;&amp; XMLista.SelectedItem != null)\n        selected = XMLista.SelectedItem.ToString();\n}\n</code></pre>\n"}], "owner": {"reputation": 322, "user_id": 3088451, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/713889313/picture?type=large", "display_name": "Nikola L.", "link": "https://stackoverflow.com/users/3088451/nikola-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 46712269, "answer_count": 2, "score": -1, "last_activity_date": 1507818683, "creation_date": 1507747212, "last_edit_date": 1507802795, "question_id": 46695368, "link": "https://stackoverflow.com/questions/46695368/return-a-value-from-the-method-initiated-by-selectionchanged-event", "title": "Return a value from the method initiated by SelectionChanged event", "body": "<p>I have ListBox item in xaml that gets ListBoxItems from a method that reads items from xml file.</p>\n\n<p>I have the list loaded successfully, and I also have a function that can add items to the list via the application. Now I need a way to remove the items. I want to get an item to remove by selecting a ListBoxItem from the list. What I had in mind is to use the SelectionChanged event and then use the following code:</p>\n\n<pre><code>string selected;\n\n   private void XMLista_SelectionChanged(object sender, SelectionChangedEventArgs e)\n    {\n        brisanjeDugme.IsEnabled = true;\n        selected = XMLista.SelectedItem.ToString();\n\n    }\n</code></pre>\n\n<p>then I would use this to open up the machineList.xml file and then based on the value there remove the parent node if the node equals to the selected ListBoxItem. </p>\n\n<p>so here is the method for removal:</p>\n\n<pre><code>    private void Button_Click_1(object sender, RoutedEventArgs e)\n    {\n\n\n        XDocument root = XDocument.Load(\"machineList.xml\");\n        root.Descendants(\"stampac\").Where(p =&gt; p.Element(\"IP\").Value == selected).Remove(); // &lt;- selected variable is used here.\n        root.Save(\"machineList.xml\");\n\n        XMLista.Items.Clear();\n        ListBox_Load(sender, e);\n        brisanjeDugme.IsEnabled = false;\n\n    }\n</code></pre>\n\n<p>However, I'm having issues with using the selected variable in the above method I get an System.NullReferenceException error shown in the XMLista_SelectionChanged method, line where I defined the selected variable. I don't understand why do I get that, when I'm making sure that the button can only be pressed if I have a selected listboxitem (and I tested the value received in the messagebox, which shows correct value). </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c#", "google-maps", "unity3d", "3d", "2d"], "comments": [{"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1507748137, "post_id": 46695317, "comment_id": 80338952, "body": "Just 0 the y of the target direction."}, {"owner": {"reputation": 896, "user_id": 5801049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ZrkR.jpg?s=128&g=1", "display_name": "genaray", "link": "https://stackoverflow.com/users/5801049/genaray"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1507750040, "post_id": 46695317, "comment_id": 80339851, "body": "@DreamsOfElectricSheep Thanks for your fast answer ! But that doesnt work. The player &quot;Lays&quot; on the ground all the time to create the illusion he would walk on it. When i set y to zero he suddenly really stands on the ground O.o"}, {"owner": {"reputation": 957, "user_id": 6219084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbUSA.png?s=128&g=1", "display_name": "yes", "link": "https://stackoverflow.com/users/6219084/yes"}, "edited": false, "score": 0, "creation_date": 1507750137, "post_id": 46695317, "comment_id": 80339893, "body": "i think if you switch y and z it should show this effect. if your target direction is (1,0,1) make him face (1,1,0) instead."}, {"owner": {"reputation": 896, "user_id": 5801049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ZrkR.jpg?s=128&g=1", "display_name": "genaray", "link": "https://stackoverflow.com/users/5801049/genaray"}, "reply_to_user": {"reputation": 957, "user_id": 6219084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbUSA.png?s=128&g=1", "display_name": "yes", "link": "https://stackoverflow.com/users/6219084/yes"}, "edited": false, "score": 0, "creation_date": 1507750749, "post_id": 46695317, "comment_id": 80340196, "body": "@yes Thanks for your answer ! Unfortunately that doesnt work either. When i tap somewhere the character either rotates on the wrong axis or even does nothing :/."}, {"owner": {"reputation": 957, "user_id": 6219084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbUSA.png?s=128&g=1", "display_name": "yes", "link": "https://stackoverflow.com/users/6219084/yes"}, "edited": false, "score": 0, "creation_date": 1507755389, "post_id": 46695317, "comment_id": 80342535, "body": "yes after i thought about it for a bit, it was stupid to assume it would be that easy. posted a little snippet for you."}], "answers": [{"comments": [{"owner": {"reputation": 896, "user_id": 5801049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ZrkR.jpg?s=128&g=1", "display_name": "genaray", "link": "https://stackoverflow.com/users/5801049/genaray"}, "edited": false, "score": 0, "creation_date": 1507818654, "post_id": 46697357, "comment_id": 80370848, "body": "Thanks for your fast answer ! I just tested it. But somehow the Character stands on the map instead of being paralell now. Also he rotates around the z axis. He should be parallel to the map and rotates around the x axis to make him look to the point. And i just get the point by listening for touch inputs and raycasting :)"}], "tags": [], "owner": {"reputation": 957, "user_id": 6219084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbUSA.png?s=128&g=1", "display_name": "yes", "link": "https://stackoverflow.com/users/6219084/yes"}, "is_accepted": true, "score": 1, "last_activity_date": 1507757056, "last_edit_date": 1507757056, "creation_date": 1507755166, "answer_id": 46697357, "question_id": 46695317, "link": "https://stackoverflow.com/questions/46695317/make-a-3d-object-look-like-it-is-facing-a-point-in-an-2d-space/46697357#46697357", "title": "Make a 3D Object look like it is facing a point in an 2D space", "body": "<p>This should do the trick. Make your model a child of an unrotated empty, facing is like in your first image, and put the below script on it. I didnt know how you get the point to look at, it is what i tried in unity. Hope it helps.</p>\n\n<pre><code>using UnityEngine;\n\npublic class LookAtTarget : MonoBehaviour {\n\n    //assign in inspector\n    public Collider floor;\n\n    //make sure you Camera is taged as MainCamera, or make it public and assign in inspector\n    Camera mainCamera;\n\n    RaycastHit rayHit;\n\n    //not needed when assigned in the inspector    \n    void Start() {\n        mainCamera = Camera.main;\n    }\n\n    void Update () {\n\n        if(Input.GetMouseButtonUp(0)) {\n\n            if(floor.Raycast(mainCamera.ScreenPointToRay(Input.mousePosition), out rayHit, Mathf.Infinity)) {\n                //its actually the inverse of the lookDirection, but thats is because the rotation around z later.\n                Vector3 lookDirection = transform.position - rayHit.point;\n\n                float angle = Vector3.Angle(lookDirection, transform.forward);\n\n                transform.rotation = Quaternion.AngleAxis(Vector3.Dot(Vector3.right, lookDirection) &gt; 0 ? angle : angle * -1, Vector3.forward);\n\n            } \n\n        }\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 896, "user_id": 5801049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2ZrkR.jpg?s=128&g=1", "display_name": "genaray", "link": "https://stackoverflow.com/users/5801049/genaray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 1, "accepted_answer_id": 46697357, "answer_count": 1, "score": 1, "last_activity_date": 1507818669, "creation_date": 1507747030, "last_edit_date": 1507818669, "question_id": 46695317, "link": "https://stackoverflow.com/questions/46695317/make-a-3d-object-look-like-it-is-facing-a-point-in-an-2d-space", "title": "Make a 3D Object look like it is facing a point in an 2D space", "body": "<p>The first thing you will notice is the complicated and confusing title.\nSo let me explain that.</p>\n\n<p>I'm trying to make an 2D game in an 3D space using Unity. And i'm using a 3D Character as an Player. This looks like that : </p>\n\n<p><a href=\"https://i.stack.imgur.com/FJZXD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FJZXD.png\" alt=\"Pic1\"></a></p>\n\n<p>As you can see the Background ( A Google map ) is two dimensional. While the Player is a 3D Object laying on the ground ( It just Looks like it is Standing ).</p>\n\n<p>Thats working fine so far. But i want that the 3D Character Looks like it is facing a tapped Point on the Background map.</p>\n\n<p>For example : </p>\n\n<p><a href=\"https://i.stack.imgur.com/LjsAu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LjsAu.png\" alt=\"Hes looking towards\"></a></p>\n\n<p>And two more examples : </p>\n\n<p><a href=\"https://i.stack.imgur.com/5JpSM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5JpSM.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/tcPE7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tcPE7.png\" alt=\"enter image description here\"></a></p>\n\n<p>The black circle represents the tapped Position. So i have totally no clue if theres a way to do that, or even if its possible to do that.</p>\n\n<p>I tried the following code, but that only rotates my character on an different axis :</p>\n\n<pre><code>    Vector3 targetDir = tapped.position - transform.position;\n\n    float step = speed * Time.deltaTime;\n\n    Vector3 newDir = Vector3.RotateTowards(transform.forward, targetDir, step, 0.0F);\n\n    transform.rotation = Quaternion.LookRotation(newDir);\n</code></pre>\n\n<p>Is there even a way to achieve that ? Im currently out of ideas...\nI would be very glad for any help i can get !</p>\n"}, {"tags": ["c#", "c++", "com", "marshalling", "idl"], "comments": [{"owner": {"reputation": 430, "user_id": 8260167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c96d4326074daace4cf1303c49e121?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron. S", "link": "https://stackoverflow.com/users/8260167/aaron-s"}, "edited": false, "score": 0, "creation_date": 1507748337, "post_id": 46695313, "comment_id": 80339059, "body": "have you looked at <a href=\"http://www.pinvoke.net/\" rel=\"nofollow noreferrer\">pinvoke.net</a> for examples?"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1507756118, "post_id": 46695313, "comment_id": 80342890, "body": "Have you tried <code>SetProperties(int cProperties, string[] Properties, object[] Values)</code>  (unsafe is not necessary) ? PS: BSTR, VARIANT and SAFEARRAY were born the same day (or so)."}, {"owner": {"reputation": 109, "user_id": 2367030, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7d7f0257ea3cb69bfcd77e29e91bfc2c?s=128&d=identicon&r=PG", "display_name": "jsparkes", "link": "https://stackoverflow.com/users/2367030/jsparkes"}, "edited": false, "score": 0, "creation_date": 1507808727, "post_id": 46695313, "comment_id": 80363822, "body": "When I use string[], I get an error that SetProperties is not implemented for the interface.    Looking a pinvoke,net doesn&#39;t help because I can declare the function however I need; in this case <b>tlbimp</b> is providing the external function definition."}, {"owner": {"reputation": 109, "user_id": 2367030, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7d7f0257ea3cb69bfcd77e29e91bfc2c?s=128&d=identicon&r=PG", "display_name": "jsparkes", "link": "https://stackoverflow.com/users/2367030/jsparkes"}, "edited": false, "score": 0, "creation_date": 1507811327, "post_id": 46695313, "comment_id": 80365636, "body": "I guess the original developers made an explicit decision not to use SAFEARRAY.  I can&#39;t ask them why because they are no longer around."}], "owner": {"reputation": 109, "user_id": 2367030, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7d7f0257ea3cb69bfcd77e29e91bfc2c?s=128&d=identicon&r=PG", "display_name": "jsparkes", "link": "https://stackoverflow.com/users/2367030/jsparkes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1552480283, "creation_date": 1507747013, "last_edit_date": 1552480283, "question_id": 46695313, "link": "https://stackoverflow.com/questions/46695313/accessing-c-arrays-passed-via-com-in-c", "title": "Accessing C++ arrays passed via COM in C#", "body": "<p>I have a legacy COM class that passes C++ array pointers without using SAFEARRAY.  (It was probably implemented before that existed.)   I'd like to implement an interface in C# without change the COM interface.  In the IDL, the function is defined as:</p>\n\n<pre><code>    HRESULT SetProperties([in] int cProperties,\n                  [in, size_is(cProperties)] BSTR Properties[],\n                  [in, size_is(cProperties)] VARIANT Values[]);\n</code></pre>\n\n<p>When I reference the DLL in a C# project and select implement interface, it turns into the following:</p>\n\n<pre><code>   unsafe public void SetProperties(int cProperties, ref string Properties, ref object Values)\n    {\n        throw new NotImplementedException();\n    }\n</code></pre>\n\n<p>Is there some way to access the Properties and Values as arrays in C#?</p>\n\n<p>I have taken this issue up again.  It appears that the partial answer is in Marshalling.   I can redo the C# function as the following:</p>\n\n<pre><code>public void SetProperties(int cProperties,\n         [MarshalAs(UnmanagedType.LPArray, ArraySubType = UnmanagedType.BStr, SizeParamIndex=0)] ref string[] Properties,\n         [MarshalAs(UnmanagedType.LPArray, ArraySubType = UnmanagedType.Struct, SizeParamIndex=0)] ref object[] Values)\n    {\n        throw new NotImplementedException();\n    }\n</code></pre>\n\n<p>Now the C# compiler says that the COM interface function SetProperties() has not been implemented.   It's still looking for a function with first type signature, according to the Visual Studio object browser.</p>\n\n<p>Is there any way to implement the interface using Marshalled arguments?</p>\n"}, {"tags": ["c#", "asp.net", "webforms", "machinekey"], "comments": [{"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 1, "creation_date": 1507747190, "post_id": 46695312, "comment_id": 80338452, "body": "Use a different PostBack URL instead of a server transfer to handle the form post."}, {"owner": {"reputation": 705, "user_id": 5327403, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c293099c7e61e9c0396c0ca2d2e983f6?s=128&d=identicon&r=PG&f=1", "display_name": "FrankTheTank", "link": "https://stackoverflow.com/users/5327403/frankthetank"}, "reply_to_user": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1507748161, "post_id": 46695312, "comment_id": 80338965, "body": "Can you elaborate on this a little?"}, {"owner": {"reputation": 96748, "user_id": 74757, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/10331bb0b4eb995500acc85fb0d16aea?s=128&d=identicon&r=PG", "display_name": "C\u1d0f\u0280\u028f", "link": "https://stackoverflow.com/users/74757/c%e1%b4%8f%ca%80%ca%8f"}, "edited": false, "score": 1, "creation_date": 1507748597, "post_id": 46695312, "comment_id": 80339179, "body": "Are you just trying to redirect to a different page when you click the button? Seems like a job for a good old fashioned anchor tag to me. Or use an <code>&lt;asp:LinkButton &#47;&gt;</code> with a <code>href</code> property."}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 1, "creation_date": 1507748615, "post_id": 46695312, "comment_id": 80339186, "body": "Use it like this: <code>&lt;asp:Button ID=&quot;Button1&quot; runat=&quot;server&quot; PostBackUrl=&quot;~&#47;Page2.aspx&quot; &#47;&gt;</code>"}, {"owner": {"reputation": 705, "user_id": 5327403, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c293099c7e61e9c0396c0ca2d2e983f6?s=128&d=identicon&r=PG&f=1", "display_name": "FrankTheTank", "link": "https://stackoverflow.com/users/5327403/frankthetank"}, "edited": false, "score": 0, "creation_date": 1507831803, "post_id": 46695312, "comment_id": 80378751, "body": "That worked thanks!"}], "owner": {"reputation": 705, "user_id": 5327403, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c293099c7e61e9c0396c0ca2d2e983f6?s=128&d=identicon&r=PG&f=1", "display_name": "FrankTheTank", "link": "https://stackoverflow.com/users/5327403/frankthetank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1507747001, "creation_date": 1507747001, "last_edit_date": 1592644375, "question_id": 46695312, "link": "https://stackoverflow.com/questions/46695312/asp-net-validation-of-viewstate-mac-failed-on-button-press", "title": "ASP.NET Validation of Viewstate MAC failed on Button Press", "body": "<p>When I try and click on a button in my asp.net web form I am thrown an error that states:</p>\n<blockquote>\n<p>Server Error in '/' Application.</p>\n<p>Validation of viewstate MAC failed. If this application is hosted by a Web Farm or cluster, ensure that  configuration specifies the same validationKey and validation algorithm. AutoGenerate cannot be used in a cluster.</p>\n<p>See <a href=\"http://go.microsoft.com/fwlink/?LinkID=314055\" rel=\"nofollow noreferrer\">http://go.microsoft.com/fwlink/?LinkID=314055</a> for more information.</p>\n</blockquote>\n<p>The html code is as follows:</p>\n<pre><code>&lt;asp:Button Text=&quot;Create New NetEvent&quot; runat=&quot;server&quot; ID=&quot;testBtn&quot; OnClick=&quot;testBtn_Click&quot;/&gt;\n</code></pre>\n<p>My CodeBehind file is never reached as the error is thrown before the new page loads. I am able to open the page I am trying to navigate to separately and it works I am just not able to make a Server.Transfer call in C# to get to it. My c# code is as follows:</p>\n<pre><code>protected void testBtn_Click(object sender, EventArgs e)\n    {\n        Server.Transfer(&quot;~/NetEvent/NetEvent/Default.aspx&quot;);\n    }\n</code></pre>\n"}, {"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 2713, "user_id": 6611487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/m9imL.jpg?s=128&g=1", "display_name": "boop_the_snoot", "link": "https://stackoverflow.com/users/6611487/boop-the-snoot"}, "edited": false, "score": 0, "creation_date": 1507746999, "post_id": 46695248, "comment_id": 80338359, "body": "Kindly post StackTrace as Text and <b>not as an Image</b>"}, {"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 1, "creation_date": 1507747735, "post_id": 46695248, "comment_id": 80338765, "body": "<code>PackUriHelper.Create</code> doesn&#39;t seem to make sense here, as you already have a Pack URI. <code>img.UriSource = new Uri(@&quot;pack:&#47;&#47;application:,,,&#47;Images&#47;TestImage.png&quot;)</code> is sufficient in a standard WPF app. For a non-WPF app, <a href=\"https://stackoverflow.com/a/6005606/1136211\">this answer</a> may be helpful."}, {"owner": {"reputation": 33, "user_id": 1382419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45bab81dc098a2fd17f4c0a3ea2c3acc?s=128&d=identicon&r=PG", "display_name": "Ben Adelson", "link": "https://stackoverflow.com/users/1382419/ben-adelson"}, "edited": false, "score": 0, "creation_date": 1507748054, "post_id": 46695248, "comment_id": 80338902, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/system.io.packaging.packurihelper(v=vs.110).aspx\" rel=\"nofollow noreferrer\">MSDN</a> - If I don&#39;t use PackUriHelper I get a different exception &quot;The URI prefix is not recognized&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 1382419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45bab81dc098a2fd17f4c0a3ea2c3acc?s=128&d=identicon&r=PG", "display_name": "Ben Adelson", "link": "https://stackoverflow.com/users/1382419/ben-adelson"}, "is_accepted": true, "score": 0, "last_activity_date": 1507757601, "last_edit_date": 1507757601, "creation_date": 1507757300, "answer_id": 46697850, "question_id": 46695248, "link": "https://stackoverflow.com/questions/46695248/bitmapimage-throwing-notimplementedexception-on-endinit/46697850#46697850", "title": "BitmapImage throwing NotImplementedException on EndInit()", "body": "<p>I've got this working now - I believe this exception was being thrown because I was attempting to resolve/load the <code>BitmapImage</code> before any of the xaml resources had loaded. I forced the initialization of the <code>BitmapImage</code> into the getter for my bound Image property and it is no longer throwing.</p>\n\n<p>I also noticed that I am able to correctly able to resolve pack:// URIs directly from the XAML itself.</p>\n\n<pre><code>private BitmapImage _listIcon;\npublic BitmapImage ListIcon\n{\n    get\n    {\n        if (_listIcon == null)\n        {\n            _listIcon = ProvideListIcon();\n        }\n\n        return _listIcon;\n    }\n}\n\nprotected override BitmapImage ProvideListIcon()\n{\n    BitmapImage img = new BitmapImage(new Uri(\"pack://application:,,,/[Project];Component/Images/TestImage.png\", UriKind.RelativeOrAbsolute));\n    if (img.CanFreeze)\n    {\n        img.Freeze();\n    }\n\n    return img;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1382419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45bab81dc098a2fd17f4c0a3ea2c3acc?s=128&d=identicon&r=PG", "display_name": "Ben Adelson", "link": "https://stackoverflow.com/users/1382419/ben-adelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 46697850, "answer_count": 1, "score": 0, "last_activity_date": 1507757601, "creation_date": 1507746741, "question_id": 46695248, "link": "https://stackoverflow.com/questions/46695248/bitmapimage-throwing-notimplementedexception-on-endinit", "title": "BitmapImage throwing NotImplementedException on EndInit()", "body": "<p>I am attempting to load a bitmap image from file in a WPF window but I'm getting an exception thrown on the EndInit() line below</p>\n\n<pre><code>BitmapImage img = new BitmapImage();\nimg.BeginInit();\nimg.CacheOption = BitmapCacheOption.OnLoad;\nimg.UriSource = PackUriHelper.Create(new Uri(@\"pack://application:,,,/Images/TestImage.png\", UriKind.Absolute));\nimg.EndInit();\nimg.Freeze();\n</code></pre>\n\n<p>Exception stack trace:<a href=\"https://i.stack.imgur.com/vxM91.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vxM91.jpg\" alt=\"stack trace\"></a></p>\n\n<p>Any ideas? If it's relevant at all this WPF window is being hosted in a native application.</p>\n"}, {"tags": ["c#", "math", "gps", "mapping", "cartography"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user354134"}, "edited": false, "score": 0, "creation_date": 1507820154, "post_id": 46695239, "comment_id": 80371933, "body": "It looks like 13.2687 and 43.7684 represent minutes of arc. That gets you a lot closer to the values you indicate. So <code>42 + 13.2687&#47;60</code> for example"}, {"owner": {"reputation": 13978, "user_id": 1019952, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ryrqT.jpg?s=128&g=1", "display_name": "Mohamed Taher Alrefaie", "link": "https://stackoverflow.com/users/1019952/mohamed-taher-alrefaie"}, "edited": false, "score": 0, "creation_date": 1508667544, "post_id": 46695239, "comment_id": 80692966, "body": "Is this helpful? <a href=\"https://www.uwgb.edu/dutchs/UsefulData/UTMFormulas.HTM\" rel=\"nofollow noreferrer\">uwgb.edu/dutchs/UsefulData/UTMFormulas.HTM</a>"}], "owner": {"reputation": 1, "user_id": 8760904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5348d9f5f3515532a1e38c7c9f09df0?s=128&d=identicon&r=PG&f=1", "display_name": "Micheal Teller", "link": "https://stackoverflow.com/users/8760904/micheal-teller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507781515, "creation_date": 1507746708, "last_edit_date": 1507781515, "question_id": 46695239, "link": "https://stackoverflow.com/questions/46695239/latitude-and-longitude-utm-radian-base-to-decimal-base-huh", "title": "Latitude and longitude UTM (Radian base) to decimal base - huh?", "body": "<p>I'm recording data coming from some devices and I can't figure out how they are performing the conversion based on the following documentation:</p>\n\n<p>LATITUDE (4213.2687N). Latitude in UTM (Radians base). In the database we store\nthat number in decimal base (42.221187)</p>\n\n<p>LONGITUDE (00843.7684W). Longitude in UTM (Radians base). As the latitude, we\nstore that number in decimal base (-8.729533).</p>\n\n<p>So I need to create a formula that takes: 4213.2687N, 00843.7684W and converts it to 42.221187, -8.729533. It seems like it should be easy but everything I try fails.</p>\n\n<p>Help?</p>\n"}, {"tags": ["c#", "asp.net", "json"], "comments": [{"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1507746839, "post_id": 46695172, "comment_id": 80338258, "body": "1) What is the full <code>ToString()</code> output of the exception including the exception type, message, traceback and inner exception, if any?  2) Can you <a href=\"https://stackoverflow.com/posts/46695172/edit\">edit</a> your question to clarify <i>4 lacs records</i>?  Perhaps this is a typo?  3) Is there any way to expand your question to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates your problem?"}, {"owner": {"reputation": 29, "user_id": 5793332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27ffd0c752bc34cb971c69ce81a4d82a?s=128&d=identicon&r=PG&f=1", "display_name": "Shail", "link": "https://stackoverflow.com/users/5793332/shail"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1507746967, "post_id": 46695172, "comment_id": 80338336, "body": "I have to create json file of around 400000 records of SQL Server"}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1507747075, "post_id": 46695172, "comment_id": 80338398, "body": "Maybe <a href=\"https://www.newtonsoft.com/json\" rel=\"nofollow noreferrer\">Json.NET</a> can handle 400000  records?"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1507747154, "post_id": 46695172, "comment_id": 80338441, "body": "Likely you&#39;re hitting the .Net <a href=\"https://stackoverflow.com/q/140468\">max string length</a>.  What you want to do is to serialize directly to a stream, but <code>JavaScriptSerializer</code> does not support this.  Instead, switch to <a href=\"https://stackoverflow.com/questions/tagged/json.net\">json.net</a> and then use <code>DataReaderConverter</code> from <a href=\"https://stackoverflow.com/a/33837306/3744182\">JSON.net serialize directly from oledbconnection</a> to stream directly from your <code>IDataReader</code> to the file without ever loading the entire query result into memory."}, {"owner": {"reputation": 29, "user_id": 5793332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27ffd0c752bc34cb971c69ce81a4d82a?s=128&d=identicon&r=PG&f=1", "display_name": "Shail", "link": "https://stackoverflow.com/users/5793332/shail"}, "edited": false, "score": 0, "creation_date": 1507747193, "post_id": 46695172, "comment_id": 80338455, "body": "I don&#39;t know how to handle it in Json.Net"}, {"owner": {"reputation": 29, "user_id": 5793332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27ffd0c752bc34cb971c69ce81a4d82a?s=128&d=identicon&r=PG&f=1", "display_name": "Shail", "link": "https://stackoverflow.com/users/5793332/shail"}, "edited": false, "score": 0, "creation_date": 1507747374, "post_id": 46695172, "comment_id": 80338565, "body": "actually after this  =&gt; string jsondata = new JavaScriptSerializer().Serialize(stockdet);         I am creating file like this = &gt; System.IO.File.WriteAllText(path + &quot;stock.json&quot;, jsondata);"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1507747474, "post_id": 46695172, "comment_id": 80338620, "body": "@Shail - the linked answer to <a href=\"https://stackoverflow.com/a/33837306/3744182\">JSON.net serialize directly from oledbconnection</a> shows how to serialize directly to a stream.  See also the documentation page <a href=\"https://www.newtonsoft.com/json/help/html/SerializeWithJsonSerializerToFile.htm\" rel=\"nofollow noreferrer\">Serialize JSON to a file</a>."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1507747583, "post_id": 46695172, "comment_id": 80338679, "body": "@Shail - <i>actually after this .. I am creating file like this...</i> - and this is why you are running out of memory.  You need to skip the in-memory string representation of your JSON and serialize directly to a file.  Anyway, to give a proper answer I think we need to know what <code>stockdet</code> is -- i.e. a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2223, "user_id": 5362552, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/64254c97ca3295bc25f024cc2c1a5d41?s=128&d=identicon&r=PG&f=1", "display_name": "Saif", "link": "https://stackoverflow.com/users/5362552/saif"}, "edited": false, "score": 0, "creation_date": 1507773852, "post_id": 46695172, "comment_id": 80347773, "body": "please show where the exception occurred"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5793332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27ffd0c752bc34cb971c69ce81a4d82a?s=128&d=identicon&r=PG&f=1", "display_name": "Shail", "link": "https://stackoverflow.com/users/5793332/shail"}, "edited": false, "score": 0, "creation_date": 1508156929, "post_id": 46695509, "comment_id": 80485986, "body": "Thanks James, Solved my problem."}], "tags": [], "owner": {"reputation": 224, "user_id": 8715951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fee127aff9fbb2b1030e516caab9236?s=128&d=identicon&r=PG&f=1", "display_name": "Ioannis G.", "link": "https://stackoverflow.com/users/8715951/ioannis-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1507829068, "last_edit_date": 1507829068, "creation_date": 1507747761, "answer_id": 46695509, "question_id": 46695172, "link": "https://stackoverflow.com/questions/46695172/an-exception-of-type-system-outofmemoryexception-occurred-in-mscorlib-dll-but/46695509#46695509", "title": "An exception of type &#39;System.OutOfMemoryException&#39; occurred in mscorlib.dll but was not handled in user code, while creating json file", "body": "<p>This means that your memory is not enough to handle this huge object as you are trying to serialize 400 000 records, so I would suggest to follow this approach</p>\n\n<ol>\n<li><p>Go to nuget packages and add the newtonsoft.json</p></li>\n<li><p>Add the following references</p>\n\n<pre><code>using Newtonsoft.Json;\nusing System.IO;\n</code></pre></li>\n<li><p>place the following code</p>\n\n<pre><code>//replace {path} with your path\nusing (StreamWriter sw = new StreamWriter(@\"{path}\\temp.json\"))\n        using (JsonWriter writer = new JsonTextWriter(sw))\n        {\n            new JsonSerializer().Serialize(writer, stockdet);\n\n        }\n</code></pre></li>\n<li><p>read the serialized object from the file located at the {path}</p></li>\n</ol>\n"}], "owner": {"reputation": 29, "user_id": 5793332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/27ffd0c752bc34cb971c69ce81a4d82a?s=128&d=identicon&r=PG&f=1", "display_name": "Shail", "link": "https://stackoverflow.com/users/5793332/shail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 0, "accepted_answer_id": 46695509, "answer_count": 1, "score": -1, "last_activity_date": 1507829141, "creation_date": 1507746469, "last_edit_date": 1507829141, "question_id": 46695172, "link": "https://stackoverflow.com/questions/46695172/an-exception-of-type-system-outofmemoryexception-occurred-in-mscorlib-dll-but", "title": "An exception of type &#39;System.OutOfMemoryException&#39; occurred in mscorlib.dll but was not handled in user code, while creating json file", "body": "<p>Got an error while getting data from database in json format and create json file on web server using asp.net c#.  I have to create json file of around 400 000 records of SQL Server.</p>\n\n<p>Error shows in line:</p>\n\n<pre><code>string jsondata = new JavaScriptSerializer().Serialize(stockdet);\n</code></pre>\n\n<p>There is around 400 000 records in database table</p>\n\n<blockquote>\n  <p>An exception of type 'System.OutOfMemoryException' occurred in mscorlib.dll but was not handled in user code</p>\n</blockquote>\n"}, {"tags": ["c#", "winforms", "gif", "picturebox"], "comments": [{"owner": {"reputation": 43527, "user_id": 98094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VkdLW.jpg?s=128&g=1", "display_name": "Icemanind", "link": "https://stackoverflow.com/users/98094/icemanind"}, "edited": false, "score": 0, "creation_date": 1507746599, "post_id": 46695116, "comment_id": 80338140, "body": "If you are trying to do an animated GIF then I think you need to use <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.media.imaging.gifbitmapencoder(v=vs.110).aspx\" rel=\"nofollow noreferrer\">GifBitmapEncoder</a> or <a href=\"https://github.com/dlemstra/Magick.NET\" rel=\"nofollow noreferrer\">Magick.NET</a>"}, {"owner": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "edited": false, "score": 0, "creation_date": 1507746981, "post_id": 46695116, "comment_id": 80338345, "body": "I suppose you&#39;d have to capture a series of frames, using a timer, and then stitch those together into a GIF.  GIF is just a series of frames."}, {"owner": {"reputation": 324, "user_id": 6496400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/880117145467104/picture?type=large", "display_name": "Zuriel Rodriguez", "link": "https://stackoverflow.com/users/6496400/zuriel-rodriguez"}, "reply_to_user": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "edited": false, "score": 0, "creation_date": 1507747302, "post_id": 46695116, "comment_id": 80338524, "body": "@DonBoitnott yes, That&#39;s it, But I don&#39;t know how."}, {"owner": {"reputation": 10001, "user_id": 1633308, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/3MhNf.jpg?s=128&g=1", "display_name": "DonBoitnott", "link": "https://stackoverflow.com/users/1633308/donboitnott"}, "edited": false, "score": 0, "creation_date": 1507748450, "post_id": 46695116, "comment_id": 80339118, "body": "There are some answers on SO about it, but it looks like you might need a 3rd party tool to do it well.  I didn&#39;t find any native ways to do it, in a quick search."}], "owner": {"reputation": 324, "user_id": 6496400, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/880117145467104/picture?type=large", "display_name": "Zuriel Rodriguez", "link": "https://stackoverflow.com/users/6496400/zuriel-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507746257, "creation_date": 1507746257, "question_id": 46695116, "link": "https://stackoverflow.com/questions/46695116/save-picturebox-live-preview-as-a-gif", "title": "Save pictureBox live preview as a GIF", "body": "<p>I'm using a WebCam to show a live Preview of the webcam</p>\n\n<p>I'm trying to save about 5 seconds of the live Preview as a Gif, but i cant find the right way.</p>\n\n<p>This is the code I'm using to save pictureBox as jpg.</p>\n\n<pre><code>    private void saveButton_Click(object sender, EventArgs e)\n    {\n        saveFileDialog1.InitialDirectory = @\"c:\\picture\";\n        if(saveFileDialog1.ShowDialog() == DialogResult.OK)\n        {\n            pictureBox2.Image.Save(saveFileDialog1.FileName);\n        }\n</code></pre>\n\n<p>But I want to save a GIF.</p>\n\n<p>Hope you can help me.</p>\n"}, {"tags": ["c#", "youtube"], "comments": [{"owner": {"reputation": 2537, "user_id": 4167186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0e37559a079e50b2122462bdd92844?s=128&d=identicon&r=PG&f=1", "display_name": "Brian from state farm", "link": "https://stackoverflow.com/users/4167186/brian-from-state-farm"}, "edited": false, "score": 3, "creation_date": 1507746266, "post_id": 46695055, "comment_id": 80337935, "body": "Try not to save files to the root folder of c:, latest versions of windows are protected from that."}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 5903479, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Giscu.png?s=128&g=1", "display_name": "novac", "link": "https://stackoverflow.com/users/5903479/novac"}, "is_accepted": false, "score": 1, "last_activity_date": 1507746566, "creation_date": 1507746566, "answer_id": 46695198, "question_id": 46695055, "link": "https://stackoverflow.com/questions/46695055/c-app-to-download-youtube-files-gives-unauthorizedaccessexception/46695198#46695198", "title": "C# app to download youtube files gives UnauthorizedAccessException", "body": "<p>Did you create this directory?</p>\n\n<p>'C:\\Practical Machine Learning Tutorial with Python Intro p.1 - YouTube.mp4'</p>\n\n<p>The framework is trying access this path</p>\n"}, {"tags": [], "owner": {"reputation": 1555, "user_id": 2205454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb2c6de339fec5e0fd8c0c8e79cfe54e?s=128&d=identicon&r=PG", "display_name": "Tyrrrz", "link": "https://stackoverflow.com/users/2205454/tyrrrz"}, "is_accepted": false, "score": 0, "last_activity_date": 1530617241, "creation_date": 1530617241, "answer_id": 51153462, "question_id": 46695055, "link": "https://stackoverflow.com/questions/46695055/c-app-to-download-youtube-files-gives-unauthorizedaccessexception/51153462#51153462", "title": "C# app to download youtube files gives UnauthorizedAccessException", "body": "<p><code>UnauthorizedAccessException</code> means that the stream signature was not deciphered correctly. Consider using <a href=\"https://github.com/Tyrrrz/YoutubeExplode\" rel=\"nofollow noreferrer\">YoutubeExplode</a> as a more up-to-date alternative.</p>\n"}], "owner": {"reputation": 12459, "user_id": 316082, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/a18baaf9417df189af31b53af03adb1c?s=128&d=identicon&r=PG", "display_name": "liv2hak", "link": "https://stackoverflow.com/users/316082/liv2hak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1530617241, "creation_date": 1507746071, "question_id": 46695055, "link": "https://stackoverflow.com/questions/46695055/c-app-to-download-youtube-files-gives-unauthorizedaccessexception", "title": "C# app to download youtube files gives UnauthorizedAccessException", "body": "<p>I am trying to implement a program that will download video files from youtube. I have written this small windows console app that has two files.</p>\n\n<p>Downloader.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing VideoLibrary;\nusing System.IO;\n\nnamespace AsyncAwait\n{\n    public class Downloader\n    {\n\n        public Task DownloadFilesAsync()\n        {\n            // In the Real World, we would actually do something...\n            // For this example, we're just going to print file 0, file 1.\n            //this will execute the function in a strictly sequential manner.\n\n            //await DownloadFile0();\n            //await DownloadFile1();\n\n            //var task1 = DownloadFile0();\n            //var task2 = DownloadFile1();\n            //return Task.WhenAll(task1, task2);\n\n            //var tasks = new Func&lt;Task&gt;[]\n            //{\n            //     () =&gt; DownloadFile(1),\n            //     () =&gt; DownloadFile(2),\n            //     () =&gt; DownloadFile(3),\n            //     () =&gt; DownloadFile(4),\n            //     () =&gt; DownloadFile(5)\n            //};\n            //return Task.WhenAll(tasks.Select(task =&gt; task()).ToArray());\n\n            var tasks2 = new Func&lt;Task&gt;[]\n            {\n                 () =&gt; DownloadYoutubeVideo(\"https://www.youtube.com/watch?v=OGxgnH8y2NM\"),\n                 () =&gt; DownloadYoutubeVideo(\"https://www.youtube.com/watch?v=FNQxxpM1yOs\"),\n            };\n            return Task.WhenAll(tasks2.Select(task =&gt; task()).ToArray());\n        }\n\n        private void SaveVideoToDisk(string link)\n        {\n            var youTube = YouTube.Default; // starting point for YouTube actions\n            var video = youTube.GetVideo(link); // gets a Video object with info about the video\n            File.WriteAllBytes(@\"C:\\\" + video.FullName, video.GetBytes());\n        }\n\n        public async Task DownloadYoutubeVideo(string link)\n        {\n            await Task.Run(() =&gt; SaveVideoToDisk(link));\n        }\n\n        public async Task DownloadFile(int TaskNumber)\n        {\n            int count = 0;\n            while (count &lt; 100)\n            {\n                Console.WriteLine(\"Downloading File {0,2} ----&gt; {1,3}%\", TaskNumber, count);\n                await Task.Delay(100);\n                count++;\n            }\n            await Task.Delay(100);\n        }      \n    }\n}\n</code></pre>\n\n<p>Program.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace AsyncAwait\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Downloader d = new Downloader();\n            d.DownloadFilesAsync().Wait();\n            Console.WriteLine(\"finished\");            \n        }\n    }\n}\n</code></pre>\n\n<p>I am getting the following error here.</p>\n\n<pre><code>Unhandled Exception: System.AggregateException: One or more errors occurred. ---&gt; System.UnauthorizedAccessException: Access to the path 'C:\\Practical Machine Learning Tutorial with Python Intro p.1 - YouTube.mp4' is denied.\n   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)\n   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost)\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost)\n   at System.IO.File.InternalWriteAllBytes(String path, Byte[] bytes, Boolean checkHost)\n   at System.IO.File.WriteAllBytes(String path, Byte[] bytes)\n   at AsyncAwait.Downloader.SaveVideoToDisk(String link) in C:\\Software\\csharppen\\AsyncAwait\\AsyncAwait\\Downloader.cs:line 50\n   at AsyncAwait.Downloader.&lt;&gt;c__DisplayClass2_0.&lt;DownloadYoutubeVideo&gt;b__0() in C:\\Software\\csharppen\\AsyncAwait\\AsyncAwait\\Downloader.cs:line 55\n   at System.Threading.Tasks.Task.InnerInvoke()\n   at System.Threading.Tasks.Task.Execute()\n--- End of stack trace from previous location where exception was thrown ---\n   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\n   at System.Runtime.CompilerServices.TaskAwaiter.GetResult()\n   at AsyncAwait.Downloader.&lt;DownloadYoutubeVideo&gt;d__2.MoveNext() in C:\\Software\\csharppen\\AsyncAwait\\AsyncAwait\\Downloader.cs:line 55\n   --- End of inner exception stack trace ---\n   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)\n   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)\n   at System.Threading.Tasks.Task.Wait()\n   at AsyncAwait.Program.Main(String[] args) in C:\\Software\\csharppen\\AsyncAwait\\AsyncAwait\\Program.cs:line 14\n</code></pre>\n\n<p>why is this error happening. I am using <a href=\"https://github.com/i3arnon/libvideo\" rel=\"nofollow noreferrer\">libvideo</a> to download youtube videos</p>\n"}, {"tags": ["c#", "entity-framework", "asp.net-core"], "comments": [{"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 2, "creation_date": 1507745810, "post_id": 46694909, "comment_id": 80337710, "body": "Change your model so it doesn&#39;t have that property. There is nothing wrong with having models designed for specific views, in fact that&#39;s kind of the point of MVC."}, {"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "edited": false, "score": 0, "creation_date": 1507745966, "post_id": 46694909, "comment_id": 80337795, "body": "can you look up the password from the id that is sent in, set the employee.password = [looked up password], and then save? I wouldn&#39;t expose the password to the view, but you shouldn&#39;t have any issues doing it in the controller."}, {"owner": {"reputation": 1081, "user_id": 1464160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aba121da658c6c428963d05357c502b6?s=128&d=identicon&r=PG", "display_name": "TheDude", "link": "https://stackoverflow.com/users/1464160/thedude"}, "reply_to_user": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1507745974, "post_id": 46694909, "comment_id": 80337797, "body": "@Crowcoder That&#39;s one of the things I tried but having used Entity Framework and Scaffolded out the controllers when I tried I kept getting an error that the <code>UserEditViewModel</code> table did not exist."}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1507746182, "post_id": 46694909, "comment_id": 80337891, "body": "Yeah, you would have to add the complexity of a service layer to abstract view models from the data layer representations. It is common practice if the software complexity warrants it - only you will know if it is worth the effort."}, {"owner": {"reputation": 1081, "user_id": 1464160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aba121da658c6c428963d05357c502b6?s=128&d=identicon&r=PG", "display_name": "TheDude", "link": "https://stackoverflow.com/users/1464160/thedude"}, "edited": false, "score": 0, "creation_date": 1507746337, "post_id": 46694909, "comment_id": 80337986, "body": "It&#39;s just a sample app so I can get used to .NET Core so A service layer probably isn&#39;t going to happen today."}, {"owner": {"reputation": 11009, "user_id": 1549450, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SuCm4.jpg?s=128&g=1", "display_name": "Steve Greene", "link": "https://stackoverflow.com/users/1549450/steve-greene"}, "edited": false, "score": 0, "creation_date": 1507756477, "post_id": 46694909, "comment_id": 80343044, "body": "ViewModels are the way to go. You don&#39;t need a whole service layer. In your [HttpGet] fill the viewmodel with what you need from your entities (AutoMapper can greatly help here). Then in your [HttpPost], if the model is valid reverse the process and update your entities. No need for those ugly Bind statements either. <a href=\"http://www.dotnettricks.com/learn/mvc/understanding-viewmodel-in-aspnet-mvc\" rel=\"nofollow noreferrer\">dotnettricks.com/learn/mvc/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1081, "user_id": 1464160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aba121da658c6c428963d05357c502b6?s=128&d=identicon&r=PG", "display_name": "TheDude", "link": "https://stackoverflow.com/users/1464160/thedude"}, "edited": false, "score": 0, "creation_date": 1507747652, "post_id": 46694998, "comment_id": 80338720, "body": "Removing the key from the ModelState did not resolve the validation errors but the Customer ViewModel is definitely the best way to go so that&#39;s what I am doing for now."}], "tags": [], "owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "is_accepted": false, "score": 0, "last_activity_date": 1507745832, "creation_date": 1507745832, "answer_id": 46694998, "question_id": 46694909, "link": "https://stackoverflow.com/questions/46694909/exclude-a-models-password-field-wihtout-causing-model-validation-failure/46694998#46694998", "title": "Exclude a Model&#39;s Password field wihtout causing Model Validation Failure", "body": "<p>In your controller, you could do the following:</p>\n\n<pre><code>ModelState.Remove(\"Password\");\n</code></pre>\n\n<p>which will prevent that field from being Validated.</p>\n\n<p>However that's not a very clean fix. If you're not using that field in the current view, you should consider moving that field to another model.</p>\n"}], "owner": {"reputation": 1081, "user_id": 1464160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aba121da658c6c428963d05357c502b6?s=128&d=identicon&r=PG", "display_name": "TheDude", "link": "https://stackoverflow.com/users/1464160/thedude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507745832, "creation_date": 1507745473, "question_id": 46694909, "link": "https://stackoverflow.com/questions/46694909/exclude-a-models-password-field-wihtout-causing-model-validation-failure", "title": "Exclude a Model&#39;s Password field wihtout causing Model Validation Failure", "body": "<p>I am working with EntityFramework, and MVC in .NET Core and have run across an issue that I'm not sure how to handle. I have a User model with a <code>Password</code> Field. I would like the User Model to be edited but I don't want the <code>Password</code> Field to appear on the same Edit View as the rest of the User Fields. Hiding the Password is easy enough but now the Model always fails validation when saving the edits.</p>\n\n<p>I've toyed around with just hiding the password field in the view which works but leaves the password being displayed on the page source. I've also tried creating a <code>UserEditView</code> model but that creates a lot of translation code that shouldn't be necessary for what I'm trying to achieve.</p>\n\n<p>Any help would be greatly appreciated. Below is the code I've been working with.</p>\n\n<p><strong>Model:</strong> User.cs</p>\n\n<pre><code>public class User\n{\n    [Display(Name=\"User ID\")]\n    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n    public int ID { get; set; }\n\n    [Required()]\n    [Display(Name=\"Email Address\")]\n    [DataType(DataType.EmailAddress)]\n    public string Email { get; set; }\n\n    [Required()]\n    public string Name { get; set; }\n\n    [Required]\n    [DataType(DataType.Password)]\n    public string Password { get; set; }\n\n    [Required()]\n    public string Salt { get; set; }\n}\n</code></pre>\n\n<p><strong>Edit Action:</strong> UsersController.cs</p>\n\n<pre><code>public async Task&lt;IActionResult&gt; Edit(int? id)\n{\n    if (id == null)\n    {\n        return NotFound();\n    }\n\n    var employee = await _context.Employees.SingleOrDefaultAsync(m =&gt; m.ID == id);\n    if (employee == null)\n    {\n        return NotFound();\n    }\n    ViewData[\"LocationID\"] = new SelectList(_context.Locations, \"ID\", \"Address\", employee.LocationID);\n    ViewData[\"PositionID\"] = new SelectList(_context.Jobs, \"ID\", \"Name\", employee.PositionID);\n\n    return View(employee);\n}\n\n\n[HttpPost]\n[ValidateAntiForgeryToken]\npublic async Task&lt;IActionResult&gt; Edit(int id, [Bind(\"ID,Email,Name,LocationID,PositionID\")] Employee employee)\n{\n    if (id != employee.ID)\n    {\n        return NotFound();\n    }\n\n    if (ModelState.IsValid)\n    {\n        try\n        {\n            _context.Update(employee);\n            await _context.SaveChangesAsync();\n        }\n        catch (DbUpdateConcurrencyException)\n        {\n            if (!EmployeeExists(employee.ID))\n            {\n                 return NotFound();\n            }\n            else\n            {\n                 throw;\n            }\n        }\n        return RedirectToAction(nameof(Index));\n    }\n    ViewData[\"LocationID\"] = new SelectList(_context.Locations, \"ID\", \"Address\", employee.LocationID);\n    ViewData[\"PositionID\"] = new SelectList(_context.Jobs, \"ID\", \"Name\", employee.PositionID);\n    return View(employee);\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "split"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1507745460, "post_id": 46694880, "comment_id": 80337529, "body": "Show us your code.  Depending on how you&#39;re doing this, this could be 1 line of code or 5."}, {"owner": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1507745576, "post_id": 46694880, "comment_id": 80337590, "body": "sorry, code is now added"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 2, "creation_date": 1507745605, "post_id": 46694880, "comment_id": 80337603, "body": "FYI, comments like &quot;//declare string highestword with starting value null.&quot; don&#39;t provide any value whatsoever.  It&#39;s obvious from the code next to it that you&#39;re declaring a variable with a null value.  Such comments are just clutter."}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 1, "creation_date": 1507745737, "post_id": 46694880, "comment_id": 80337672, "body": "Split can take an array of chars to split on. So you can split on space and comma. Then remove the empty entries with the appropriate StringSplitOption"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 1, "creation_date": 1507745871, "post_id": 46694880, "comment_id": 80337743, "body": "Adding to what steve said <code>var words = text.Split(new char[] { &#39; &#39;, &#39;,&#39; }, StringSplitOptions.RemoveEmptyEntries);</code>"}, {"owner": {"reputation": 1549, "user_id": 5890367, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10206951008588352/picture?type=large", "display_name": "Blake Thingstad", "link": "https://stackoverflow.com/users/5890367/blake-thingstad"}, "edited": false, "score": 0, "creation_date": 1507747278, "post_id": 46694880, "comment_id": 80338510, "body": "I would think you would want to remove all punctuation except maybe special handling for hyphens."}], "answers": [{"tags": [], "owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "is_accepted": false, "score": 3, "last_activity_date": 1507745560, "creation_date": 1507745560, "answer_id": 46694941, "question_id": 46694880, "link": "https://stackoverflow.com/questions/46694880/how-to-split-a-string-by-ignoring-commas-c/46694941#46694941", "title": "How to split a string by ignoring commas c#?", "body": "<p>You could replace the commas with an empty string, then run the output through your algorithm.</p>\n\n<pre><code>string original = \", . ? a a, b cdef cfed, abef abef abef,\";\nstring noCommas = original.Replace(\",\", string.Empty);\n</code></pre>\n\n<p>Reference:\n<a href=\"https://msdn.microsoft.com/en-us/library/fk49wtc1(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/fk49wtc1(v=vs.110).aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "edited": false, "score": 0, "creation_date": 1507747250, "post_id": 46695022, "comment_id": 80338490, "body": "Thank you for your solution, however i stumbled upon problem, lets say the space and comma is not the only things i want to remove - i wanna also remove all the curly brackets and dots and equal signs - when i do that, <code>string[] userText = richTextBox1.Text.ToLower().Split(new char[] { &#39; &#39;, &#39;,&#39;,&#39;=&#39;,&#39;+&#39;,&#39;}&#39;,&#39;{&#39; }, StringSplitOptions.RemoveEmptyEntries);</code> it starts taking commas again as the most frequent word in a string , am i missing something?"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "edited": false, "score": 0, "creation_date": 1507748001, "post_id": 46695022, "comment_id": 80338876, "body": "Can you give an example string that produces the problem?"}, {"owner": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "edited": false, "score": 0, "creation_date": 1507748667, "post_id": 46695022, "comment_id": 80339210, "body": "Nevermind, it was just the comma from my textbox! However, it still returns that something invisible is the most common word, no idea what it is? String i am using is from .cs file so i will use pastebin, since there is a character limit in comment section: <a href=\"https://pastebin.com/mVH3CEYb\" rel=\"nofollow noreferrer\">pastebin.com/mVH3CEYb</a> (it says that the most used word is &lt;blank&gt; and it occured 6 times in this string."}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "edited": false, "score": 1, "creation_date": 1507749231, "post_id": 46695022, "comment_id": 80339478, "body": "Add a \\r and a \\n characters to the string to split."}, {"owner": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "edited": false, "score": 0, "creation_date": 1507750146, "post_id": 46695022, "comment_id": 80339899, "body": "Works like a charm now! thank you! those were new line characters?(they occur when you press enter) i assume."}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "edited": false, "score": 0, "creation_date": 1507750310, "post_id": 46695022, "comment_id": 80339970, "body": "Yes newlines. But using the two char that compose a newline in Windows system individually. Otherwise there is Environment.NewLine but not sure if that will catch the chars correctly if the file is built on a different Operating System"}], "tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": true, "score": 6, "last_activity_date": 1507746684, "last_edit_date": 1507746684, "creation_date": 1507745913, "answer_id": 46695022, "question_id": 46694880, "link": "https://stackoverflow.com/questions/46694880/how-to-split-a-string-by-ignoring-commas-c/46695022#46695022", "title": "How to split a string by ignoring commas c#?", "body": "<p>Split can take an array of chars to split on. So you can split on space and comma. Then remove the empty entries with the appropriate StringSplitOption </p>\n\n<pre><code> string[] userText = richTextBox1.Text.ToLower().Split(new char[] { ' ', ','}, StringSplitOptions.RemoveEmptyEntries );\n</code></pre>\n\n<p>Also you can use Linq to calculate the frequency of a word with code like this </p>\n\n<pre><code>var g = userText.GroupBy(x =&gt; x)\n                .Select(z =&gt; new \n                { word = z.Key, count = z.Count()})\n                .ToList();\nstring mostUsed = g.OrderByDescending(x =&gt; x.count)\n                   .Select(x =&gt; x.word)\n                   .FirstOrDefault();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17564, "user_id": 2780791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1feea731a99cb95e342d196802bb868a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexei - check Codidact", "link": "https://stackoverflow.com/users/2780791/alexei-check-codidact"}, "is_accepted": false, "score": 2, "last_activity_date": 1507746451, "creation_date": 1507746451, "answer_id": 46695165, "question_id": 46694880, "link": "https://stackoverflow.com/questions/46694880/how-to-split-a-string-by-ignoring-commas-c/46695165#46695165", "title": "How to split a string by ignoring commas c#?", "body": "<p>Another option is to make the splitting easier to extend by using regular expressions, <a href=\"https://msdn.microsoft.com/en-us/library/8yttk7sy%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Regex.Split</a> more specifically:</p>\n\n<pre><code>  string input = \", . ? a a, b cdef cfed, abef abef abef, , ,\";\n  string[] result = Regex.Split(input, @\"\\w+\");\n</code></pre>\n\n<p>Check <a href=\"https://regex101.com/r/YbpCTi/1\" rel=\"nofollow noreferrer\">live testing</a> here.</p>\n\n<p>If <code>?</code> is a valid word, than the regex could be <code>@\"\\w+|\\?\"</code>.</p>\n\n<p>So, my recommendation is to use regex, even if the split method is enough for now, since it is more powerful and can easily accommodate for later changes. </p>\n\n<p>As a bonus, it is nice to learn about regular expressions.</p>\n"}], "owner": {"reputation": 77, "user_id": 5963495, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-BABTHH7FxnE/AAAAAAAAAAI/AAAAAAAAADo/4aTtBaUT0b0/photo.jpg?sz=128", "display_name": "Ralfs R", "link": "https://stackoverflow.com/users/5963495/ralfs-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 46695022, "answer_count": 3, "score": 0, "last_activity_date": 1507746684, "creation_date": 1507745331, "last_edit_date": 1507746066, "question_id": 46694880, "link": "https://stackoverflow.com/questions/46694880/how-to-split-a-string-by-ignoring-commas-c", "title": "How to split a string by ignoring commas c#?", "body": "<p>I have made a little project that takes .cs files, reads them and returns the most frequent word in the file. However, right now it returns that the most common word is a comma.\nHow can i make it so splitting the string ignores commas?</p>\n\n<p>For example: i have a string:</p>\n\n<blockquote>\n  <p>, . ? a a, b cdef cfed, abef abef abef,</p>\n</blockquote>\n\n<p>right now it returns that the most common word is 'abef' and it occured 2 times (the program doesn't count the third abef, the one which is with a comma in the end.)</p>\n\n<p>Another example:</p>\n\n<blockquote>\n  <p>, . ? a a, b cdef cfed, abef abef abef, , , </p>\n</blockquote>\n\n<p>this right now returns that the most common word is a comma ',' and it occured 3 times, but the thing is - i want my program to ignore commas and focus purely on words only.</p>\n\n<pre><code>namespace WindowsFormsApp8\n{\n  public partial class Form1 : Form\n  {\n    public Form1()\n    {\n        InitializeComponent();\n    }\n\n\n    private async void button1_Click(object sender, EventArgs e)\n    {\n        using (OpenFileDialog ofd = new OpenFileDialog() { Filter = \"Text Documents |*.cs;*.txt\", ValidateNames = true, Multiselect = false }) //openfiledialog (all .cs; all.txt)\n        {\n            if (ofd.ShowDialog() == DialogResult.OK) //if in file dialog a file gets selected\n            {\n                using (StreamReader sr = new StreamReader(ofd.FileName)) //text reader\n                {\n                    richTextBox1.Text = await sr.ReadToEndAsync(); //reads the file and returns it into textbox\n                }\n            }\n        }\n    }\n\n    private void button2_Click(object sender, EventArgs e)\n    {          \n        string[] userText = richTextBox1.Text.ToLower().Split( ' ' );\n        var frequencies = new Dictionary&lt;string, int&gt;(); // variable frequencies, dictionary with key string, value int.\n        string highestWord = null;  //declare string highestword with starting value null.\n        int highestFreq = 0; //declare integer highestfreq with starting value zero.\n\n        foreach (string word in userText) //search words in our array userText that we declared at the beginning.\n        {\n            int freq; //declare integer freq.\n            frequencies.TryGetValue(word, out freq); //trygetvalue from dictionary key, out value.\n            freq += 1; //count it.\n\n            if (freq &gt; highestFreq) \n            {\n                highestFreq = freq;\n                highestWord = word;\n            }\n            frequencies[word] = freq; //assign most frequent word in frequencies dictionary to freq\n        }\n        MessageBox.Show(\"the most occuring word is: \" + highestWord + \", it occured \" + highestFreq + \" times\"); //display data to messagebox.\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["c#", "wix", "custom-action"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8760088"}, "edited": false, "score": 0, "creation_date": 1508618496, "post_id": 46856683, "comment_id": 80683057, "body": "Nice answer. But I want use it without any other projects. Is it still possible?"}], "tags": [], "owner": {"reputation": 83, "user_id": 4115109, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OlQwVF8MKOg/AAAAAAAAAAI/AAAAAAAAAC8/K2guVaQKt6Q/photo.jpg?sz=128", "display_name": "Jonathan Monsonego", "link": "https://stackoverflow.com/users/4115109/jonathan-monsonego"}, "is_accepted": false, "score": 0, "last_activity_date": 1508530421, "creation_date": 1508530421, "answer_id": 46856683, "question_id": 46694804, "link": "https://stackoverflow.com/questions/46694804/getting-log-from-custom-action-with-extra-classes-c-in-wix/46856683#46856683", "title": "Getting log from Custom Action with Extra Classes C# in WiX", "body": "<p>gettingPath() is a member method of the class NewPath.\nThe only interface I know to the wix logging session from a custom action is the <code>Session</code> object.</p>\n\n<p>You can pass the session object to a class within a custom action, for example NewPath.</p>\n\n<p>Another option is to define a static NLog in the class containing the custom actions signatures.</p>\n\n<pre><code>_logger = LogManager.GetCurrentClassLogger();\n</code></pre>\n\n<p>and configure NLog target as the same session object. That way you can use _logger anywhere in the containing class.</p>\n\n<p>For more information about NLog, see <a href=\"http://nlog-project.org/\" rel=\"nofollow noreferrer\">http://nlog-project.org/</a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8760088"}, "edited": false, "score": 0, "creation_date": 1508619249, "post_id": 46858025, "comment_id": 80683241, "body": "Nice answer, but it doesn&#39;t help me, becaus this answer doesn&#39;t replies my question. I know that I don&#39;t need creating a new directory. WiX can do it itself. But my code, which I don&#39;t want to show, has something more than this example."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8760088"}, "edited": false, "score": 0, "creation_date": 1513773139, "post_id": 46858025, "comment_id": 82779042, "body": "&quot;So this might only be a C# programming question because you want to access the session object (to do logging) from other places in your code. In that case and with your example code, your NewPath constructor just needs an overload that takes the Session object and keeps a local reference in the class. Or you have an overload to the gettingPath method that takes a Session as a parameter. &quot; - An how is that possilble? That is my question."}], "tags": [], "owner": {"reputation": 19184, "user_id": 3261150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0821e1dca957dda1214f1d273a08e161?s=128&d=identicon&r=PG&f=1", "display_name": "PhilDW", "link": "https://stackoverflow.com/users/3261150/phildw"}, "is_accepted": false, "score": 0, "last_activity_date": 1508803143, "last_edit_date": 1508803143, "creation_date": 1508537517, "answer_id": 46858025, "question_id": 46694804, "link": "https://stackoverflow.com/questions/46694804/getting-log-from-custom-action-with-extra-classes-c-in-wix/46858025#46858025", "title": "Getting log from Custom Action with Extra Classes C# in WiX", "body": "<p>In general it seems that you're going about this the wrong way. Custom actions are the LAST thing you should learn, and that's after finding out what Windows Installer can do without any code at all. WiX and Windows Installer are not some coding framework for all your classes. It's a data-driven install where custom actions should be avoided if at all possible. The WiX inventor/owner says that custom actions are an admission of failure:</p>\n\n<p><a href=\"http://robmensching.com/blog/posts/2007/8/17/zataoca-custom-actions-are-generally-an-admission-of-failure/\" rel=\"nofollow noreferrer\">http://robmensching.com/blog/posts/2007/8/17/zataoca-custom-actions-are-generally-an-admission-of-failure/</a></p>\n\n<p>So instead of talking about classes and coding, whatever you want to do might already be available with WiX built-in custom actions, Windows Installer capabilities, or WiX Util functions. In your case, it appears from your code that you might be trying to get a path to use. Rather than describe your coding issue you should say what it is you are trying to accomplish with that code because there might be any number of ways to solve the problem that do not require any code at all. </p>\n\n<p>Your code also contains a CreateDirectory call, which is not recommended at all because 1) Windows Installer/WiX can do that without code and 2) everything you do (such as create a directory) in your custom action requires a rollback custom action to delete it if the install fails and an uninstall custom action (or equivalent) to delete it. This is part of why code should be avoided if at all possible.</p>\n\n<p>I assume you have worked through the WiX tutorial:</p>\n\n<p><a href=\"https://www.firegiant.com/wix/tutorial/\" rel=\"nofollow noreferrer\">https://www.firegiant.com/wix/tutorial/</a></p>\n\n<p>and maybe the book WiX: A Developer's Guide to Windows Installer XML, as well as all the examples available. </p>\n\n<p>Logging is a built-in Windows Installer capability - the log is produced with a msiexec command line that includes /l*vx, and your log entries will be included there. In managed code custom actions it's the session object that provides logging. So this might only be a C# programming question because you want to access the session object (to do logging) from other places in your code. In that case and with your example code, your NewPath constructor just needs an overload that takes the Session object and keeps a local reference in the class. Or you have an overload to the gettingPath method that takes a Session as a parameter. </p>\n\n<p>In the Win32 world MsiProcessMessage and C++ custom actions are what you would use. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8760088"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512579178, "creation_date": 1507745078, "last_edit_date": 1512579178, "question_id": 46694804, "link": "https://stackoverflow.com/questions/46694804/getting-log-from-custom-action-with-extra-classes-c-in-wix", "title": "Getting log from Custom Action with Extra Classes C# in WiX", "body": "<p>I am learning at the moment WiX with VS 2015 and I understand it. I found out lots of options (e. g. putting data into the installer, getting info with CAs). But one thing would be also nice to know:\nIs it possible to get <strong>logs</strong> not only from Custom Actions but also from some extra classes, which I want to use in the installer? Is there a possible way?</p>\n\n<p>EDIT:\nI think some people don't understand my question. That is the reason why I try to do an easy example.\nFirst we have have our custom-action:</p>\n\n<pre><code>[Custom Action]\npublic static ActionResult Example (Session session)\n{\n   session.Log(\"Beginn of Custom Action 'Example'\");\n   NewPath newPath = new NewPath(\"any path\");\n   session[\"NEWPATH\"] = newPath.gettingPath();\n   session.Log(\"End of Custom Action 'Example'\");\n   return ActionResult.Success;\n}\n</code></pre>\n\n<p>And to get the path in this example I need an extra class in C#:</p>\n\n<pre><code>namespace Path\n{\n   private string _path;\n   class NewPath\n   {\n      public NewPath(string path)\n      {\n         this._path = path;\n      }\n      public string gettingPath()\n      {\n         if(Directory.exists(this._path))\n         {\n            Directory.CreateDirectory(this._path);\n         }\n         return this._path;\n      }\n   }\n}\n</code></pre>\n\n<p>And now I wanna try to get also <strong>logs</strong> from the class <code>gettingPath</code>\nI hope this example is understandable (and there are no mistakes :D)</p>\n\n<p>EDIT 2: Added some things to end my class. And <strong>THIS</strong> is only a little example. Of course it's not absolutely right.</p>\n"}, {"tags": ["c#", "python", "sockets"], "comments": [{"owner": {"reputation": 2837, "user_id": 6811012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7da4b7e9c8b479f7645b62dc5a28a297?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Blaszczynski", "link": "https://stackoverflow.com/users/6811012/jacek-blaszczynski"}, "edited": false, "score": 0, "creation_date": 1508587029, "post_id": 46694774, "comment_id": 80673384, "body": "It is necessary to get information on application stack your are using on client side and server side to create a working repro of the problem and then solve it. From my perspective it could be a double conversion of endianess somewhere in the networking/application app stack."}], "answers": [{"comments": [{"owner": {"reputation": 1075, "user_id": 740521, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e724ef960b60005ddfdf845d82e358de?s=128&d=identicon&r=PG", "display_name": "user740521", "link": "https://stackoverflow.com/users/740521/user740521"}, "edited": false, "score": 0, "creation_date": 1507765689, "post_id": 46695491, "comment_id": 80345862, "body": "yes there was a bug like that, fixed now. the length is now 13330654897016668160 when using &gt;Q, but when I use &lt;Q it gives the correct value of 185 which is the length of the string I am sending"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "reply_to_user": {"reputation": 1075, "user_id": 740521, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e724ef960b60005ddfdf845d82e358de?s=128&d=identicon&r=PG", "display_name": "user740521", "link": "https://stackoverflow.com/users/740521/user740521"}, "edited": false, "score": 3, "creation_date": 1507783749, "post_id": 46695491, "comment_id": 80350248, "body": "@user740521: please don&#39;t make your question a moving target. The initial problem of reading the wrong data was found. Now you&#39;ve just changed the question to give different - and inconsistent - values where you claim that you&#39;ve got 13330654897016668160 for a real length of 8 even though the real length for this was 185 as you correctly show in your comment but not in the question."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 8, "last_activity_date": 1507748039, "last_edit_date": 1507748039, "creation_date": 1507747668, "answer_id": 46695491, "question_id": 46694774, "link": "https://stackoverflow.com/questions/46694774/why-is-the-endian-reversed-after-sending-over-tcp/46695491#46695491", "title": "Why is the endian reversed after sending over TCP", "body": "<p>Something is wrong with your code:</p>\n\n<blockquote>\n  <p>length is 1658170187863248538</p>\n</blockquote>\n\n<p>This is in hex 1703010020BB4E9A. This has nothing to do with a length of 8, no matter which endianess is involved. Instead it looks suspiciously like a TLS record:</p>\n\n<pre><code> 17    - record type application data (decimal 23)\n 03 01 - protocol version TLS 1.0 (aka SSL 3.1)\n 00 20 - length of the following encrypted data (32 byte)\n .. \n</code></pre>\n\n<p>Since according to your code your are doing SSL there is probably something wrong in your receiver. My guess is that you read from the plain socket instead of the SSL socket and thus read the encrypted data instead of the decrypted ones.</p>\n"}, {"tags": [], "owner": {"reputation": 554, "user_id": 776940, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6b67f21cb40679174c25c0d41c07a84d?s=128&d=identicon&r=PG", "display_name": "Rob Fagen", "link": "https://stackoverflow.com/users/776940/rob-fagen"}, "is_accepted": false, "score": 1, "last_activity_date": 1508551074, "creation_date": 1508551074, "answer_id": 46859360, "question_id": 46694774, "link": "https://stackoverflow.com/questions/46694774/why-is-the-endian-reversed-after-sending-over-tcp/46859360#46859360", "title": "Why is the endian reversed after sending over TCP", "body": "<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/z78xtwts(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/z78xtwts(v=vs.110).aspx</a> you are reversing 9 bytes when you invoke:</p>\n\n<pre><code>if (BitConverter.IsLittleEndian)\n    Array.Reverse(bArr, 0, 8);\n</code></pre>\n\n<p>and according to <a href=\"https://www.displayfusion.com/Discussions/View/converting-c-data-types-to-c/?ID=38db6001-45e5-41a3-ab39-8004450204b3\" rel=\"nofollow noreferrer\">https://www.displayfusion.com/Discussions/View/converting-c-data-types-to-c/?ID=38db6001-45e5-41a3-ab39-8004450204b3</a> a ulong in C# is only 8 bytes.</p>\n\n<p>I don't think that this is necessarily an answer, but maybe it's a clue?</p>\n"}, {"tags": [], "owner": {"reputation": 2153, "user_id": 5794617, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-TROJaYSnBKc/AAAAAAAAAAI/AAAAAAAABuk/GOtsluKDIg0/photo.jpg?sz=128", "display_name": "Artavazd Balayan", "link": "https://stackoverflow.com/users/5794617/artavazd-balayan"}, "is_accepted": false, "score": 2, "last_activity_date": 1508624871, "creation_date": 1508624871, "answer_id": 46868719, "question_id": 46694774, "link": "https://stackoverflow.com/questions/46694774/why-is-the-endian-reversed-after-sending-over-tcp/46868719#46868719", "title": "Why is the endian reversed after sending over TCP", "body": "<p>On client side, when you write data to stream, you're doing two Write calls:</p>\n\n<pre><code>sslStream.Write(dataLenPacked);\nsslStream.Write(data);\nsslStream.Flush();\n</code></pre>\n\n<p>MSDN says about <a href=\"https://msdn.microsoft.com/en-us/library/system.net.sockets.networkstream.write(v=vs.110).aspx\" rel=\"nofollow noreferrer\">NetworkStream.Write</a>: <em>The Write method blocks until the requested number of bytes are sent or a SocketException is thrown.</em> On the server side, there is no guarantee that you will receive all bytes in  one receive call - it depends on OS, eth driver/config and etc. So, you have to handle this scenario. As I can see in you're handling it by reading 8 or less bytes, but <a href=\"https://docs.python.org/2/library/socket.html#socket.socket.recv\" rel=\"nofollow noreferrer\">socket.recv</a> says, it's better to receive by bigger portions. Here is my implementation of the server on Python. It creates binary file in the current folder with received bytes - might be helpful to analyze what's wrong. To set listening port need to use -p/--port argument:</p>\n\n<pre><code>#!/usr/bin/env python\n\nimport sys, socket, io\nimport argparse\nimport struct\n\nCHUNK_SIZE = 4096\n\ndef read_payload(connection, payload_len):\n    recv_bytes = 0\n    total_data = \"\"\n    while (recv_bytes &lt; payload_len):\n        data = connection.recv(CHUNK_SIZE)\n        if not data:\n            break\n        total_data += data\n        recv_bytes += len(data)\n    if len(total_data) != payload_len:\n        print &gt;&gt; sys.stderr, \"-ERROR. Expected to read {0} bytes, but have read {0} bytes\\n\".format(payload_len, len(total_data))\n    return total_data\n\ndef handle_connection(connection, addr):\n    total_received = 0\n    addrAsStr = \"{0}:{1}\".format(addr[0], addr[1])\n\n    # write receved bytes to file for analyzis\n    filename = \"{0}_{1}.bin\".format(addr[0], addr[1])\n    file = io.FileIO(filename, \"w\")\n    print \"Connection from {0}\".format(addrAsStr)\n\n    try:\n        # loop for handling data transfering for particular connection\n        while True:\n            header = connection.recv(CHUNK_SIZE)\n            header_len = len(header)\n            total_received += header_len\n            if header_len == 0:\n                break\n            if header_len &lt; 8:\n                print &gt;&gt; sys.stderr, \"-ERROR. Received header with len {0} less than 8 bytes!\\n\".format(header_len)\n                break\n\n            print(\"Header len is {0} bytes\".format(len(header)))\n\n            # extract payload length - it's first 8 bytes\n            real_header = header[0:8]\n            file.write(real_header)\n\n            # more about unpack - https://docs.python.org/3/library/struct.html#module-struct\n            # Byte order - network (= big-endian), type - unsigned long long (8 bytes)\n            payload_len = struct.unpack(\"!Q\", real_header)[0]\n            print(\"Payload len is {0} bytes\".format(payload_len))\n\n            # extract payload from header\n            payload_in_header = header[8:] if header_len &gt; 8 else \"\"\n            if len(payload_in_header) &gt; 0:\n                print \"Payload len in header is {0} bytes\".format(len(payload_in_header))\n                file.write(payload_in_header)\n\n            # calculate remains\n            remains_payload_len = payload_len - len(payload_in_header)\n            remains_payload = read_payload(connection, remains_payload_len)\n            payload = payload_in_header + remains_payload\n            print(\"Payload is '{0}'\".format(payload))\n\n            if remains_payload:\n                file.write(remains_payload)\n            else:\n                break\n            total_received += len(remains_payload)\n    finally:\n            file.close()\n\n    return total_received\n\ndef main():\n    parser = argparse.ArgumentParser()\n    parser.add_argument('-p', '--port', required=True)\n    args = parser.parse_args()\n\n    # listen tcp socket on all interfaces\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    s.bind((\"0.0.0.0\", int(args.port)))\n    s.listen(1)\n\n    # loop for handling incoming connection\n    while True:\n        print \"Waiting for a connection...\"\n        (connection, addr) = s.accept()\n        addrAsStr = \"{0}:{1}\".format(addr[0], addr[1])\n\n        try:\n            total_received = handle_connection(connection, addr)\n            print \"Handled connection from {0}. Received: {1} bytes\\n\".format(addrAsStr, total_received)\n        finally:\n            # Clean up the connection\n            connection.close()\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>\n\n<p>To make this example full, here is C# client. It uses one external library - <a href=\"https://www.nuget.org/packages/Newtonsoft.Json/\" rel=\"nofollow noreferrer\">Newtonsoft.Json</a> for serialization:</p>\n\n<pre><code>using Newtonsoft.Json;\nusing System;\nusing System.Net;\nusing System.Net.Sockets;\nusing System.Text;\nusing System.Threading;\n\nnamespace SimpleTcpClient\n{\n    class SimpleTcpClient : IDisposable\n    {\n        readonly TcpClient _client;\n\n        public SimpleTcpClient(string host, int port)\n        {\n            _client = new TcpClient(host, port);\n        }\n        public void Send(byte[] payload)\n        {\n            // Get network order of array length\n            ulong length = (ulong)IPAddress.HostToNetworkOrder(payload.LongLength);\n            var stream = _client.GetStream();\n            // Write length\n            stream.Write(BitConverter.GetBytes(length), 0, sizeof(long));\n            // Write payload\n            stream.Write(payload, 0, payload.Length);\n            stream.Flush();\n            Console.WriteLine(\"Have sent {0} bytes\", sizeof(long) + payload.Length);\n        }\n        public void Dispose()\n        {\n            try { _client.Close(); }\n            catch { }\n        }\n    }\n    class Program\n    {\n        class DTO\n        {\n            public string Name { get; set; }\n            public int Age { get; set; }\n            public double Weight { get; set; }\n            public double Height { get; set; }\n            public string RawBase64 { get; set; }\n        }\n\n        static void Main(string[] args)\n        {\n            // Set server name/ip-address\n            string server = \"192.168.1.101\";\n            // Set server port\n            int port = 8080;\n            string[] someNames = new string[]\n            {\n                \"James\", \"David\",    \"Christopher\",  \"George\",   \"Ronald\",\n                \"John\", \"Richard\",  \"Daniel\",   \"Kennet\",  \"Anthony\",\n                \"Robert\",\"Charles\", \"Paul\", \"Steven\",   \"Kevin\",\n                \"Michae\", \"Joseph\", \"Mark\", \"Edward\",   \"Jason\",\n                \"Willia\", \"Thomas\", \"Donald\",   \"Brian\",    \"Jeff\"\n            };\n            // Init random generator\n            Random rnd = new Random(Environment.TickCount);\n            int i = 1;\n            while (true) {\n                try {\n                    using (var c = new SimpleTcpClient(server, port)) {\n                        byte[] rawData = new byte[rnd.Next(16, 129)];\n                        rnd.NextBytes(rawData);\n\n                        // Create random data transfer object\n                        var d = new DTO() {\n                            Name = someNames[rnd.Next(0, someNames.Length)],\n                            Age = rnd.Next(10, 101),\n                            Weight = rnd.Next(70, 101),\n                            Height = rnd.Next(165, 200),\n                            RawBase64 = Convert.ToBase64String(rawData)\n                        };\n\n                        // UTF-8 doesn't have endianness - so we can convert it to byte array and send it\n                        // More about it - https://stackoverflow.com/questions/3833693/isn-t-on-big-endian-machines-utf-8s-byte-order-different-than-on-little-endian \n                        var bytes = Encoding.UTF8.GetBytes(JsonConvert.SerializeObject(d));\n                        c.Send(bytes);\n                    }\n                }\n                catch (Exception ex) {\n                    Console.WriteLine(\"Get exception when send: {0}\\n\", ex);\n                }\n                Thread.Sleep(200);\n                i++;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/9hDb6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9hDb6.png\" alt=\"Example\"></a></p>\n"}], "owner": {"reputation": 1075, "user_id": 740521, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e724ef960b60005ddfdf845d82e358de?s=128&d=identicon&r=PG", "display_name": "user740521", "link": "https://stackoverflow.com/users/740521/user740521"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1518, "favorite_count": 2, "accepted_answer_id": 46695491, "answer_count": 3, "score": 8, "last_activity_date": 1508760762, "creation_date": 1507744994, "last_edit_date": 1508760762, "question_id": 46694774, "link": "https://stackoverflow.com/questions/46694774/why-is-the-endian-reversed-after-sending-over-tcp", "title": "Why is the endian reversed after sending over TCP", "body": "<p>I have a client written in C#, and a server written in python. The messages that I send over the socket are 8 bytes followed by the data, the 8 bytes are the data length.</p>\n\n<p>In C# before sending, I convert the 8-byte data length too big endian as shown:</p>\n\n<pre><code>public void Send(SSLMsg m)\n{\n    string json = m.Serialize();\n    byte[] data = Encoding.ASCII.GetBytes(json);\n    ulong dataLen = (ulong)data.Length;\n    byte[] dataLenPacked = packIt(dataLen);\n\n    Log(\"Sending \" + dataLen + \" \" + json);\n\n    sslStream.Write(dataLenPacked);\n    sslStream.Write(data);\n    sslStream.Flush();\n\n}\n\nprivate byte[] packIt(ulong n)\n{\n    byte[] bArr = BitConverter.GetBytes(n);\n    if (BitConverter.IsLittleEndian)\n        Array.Reverse(bArr, 0, 8);\n    return bArr;\n}\n</code></pre>\n\n<p>The message is sent successfully and I am getting tied up in the python server code since the unpack format should be correct here shouldn't it?</p>\n\n<pre><code>(length,) = unpack('&gt;Q', data)\n# len(data) is 8 here\n# length is 1658170187863248538\n</code></pre>\n\n<p>Isn't the big-endian character '>'? Why is my length so long?</p>\n\n<h2>UPDATE:</h2>\n\n<p>There was a bug where I was unpacking the wrong 8 bytes, that has been fixed, now that I am unpacking the correct data I still have the same question.</p>\n\n<pre><code>(length,) = unpack('&gt;Q', data)\n# len(data) is 8 here\n# length is 13330654897016668160L\n</code></pre>\n\n<p>The correct length is given only if I unpack using little endian even though I sent the bytes to the server using big-endian... so I am expecting >Q to work, but instead \n\n<pre><code>(length,) = unpack('&lt;Q', data)\n# len(data) is 8 here\n# length is 185\n</code></pre>\n\n<p>Here is how I am receiving the bytes in python:</p>\n\n<pre><code>while (True):\n    r,w,e = select.select(...)\n    for c in r:\n        if (c == socket):\n            connection_accept(c)\n        else\n           # c is SSL wrapped  at this point\n           read = 0\n           data = []\n           while (read != 8):\n               bytes = c.recv(min(8-read, 8))\n               read += len(bytes)\n               data.append(bytes)\n           joinedData = ''.join(data)\n\n           # the below length is 13330654897016668160L\n           # I am expecting it to be 185\n           (length,) = unpack('&gt;Q', joinedData)\n\n           # the below length is 185, it should not be however\n           # since the bytes were sent in big-endian\n           (length,) = unpack('&lt;Q', joinedData)\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", "asp.net-core-mvc"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 3063246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZB2SX.jpg?s=128&g=1", "display_name": "petko", "link": "https://stackoverflow.com/users/3063246/petko"}, "edited": false, "score": 0, "creation_date": 1583920639, "post_id": 46695827, "comment_id": 107271156, "body": "Is it possible to assign values to property values during this validation? Is it a good idea?"}, {"owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "reply_to_user": {"reputation": 113, "user_id": 3063246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZB2SX.jpg?s=128&g=1", "display_name": "petko", "link": "https://stackoverflow.com/users/3063246/petko"}, "edited": false, "score": 2, "creation_date": 1583952015, "post_id": 46695827, "comment_id": 107288826, "body": "I&#39;ve already deleted this sample code so I don&#39;t have access to a running code and prove you can assign values to properties. I don&#39;t think that&#39;s a good idea anyway because of single responsibility principle?"}], "tags": [], "owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "is_accepted": false, "score": 10, "last_activity_date": 1554771642, "last_edit_date": 1554771642, "creation_date": 1507749037, "answer_id": 46695827, "question_id": 46694745, "link": "https://stackoverflow.com/questions/46694745/asp-net-core-custom-model-validation/46695827#46695827", "title": "ASP.NET Core - Custom model validation", "body": "<p>To create a custom validation attribute in <code>.Net Core</code>, you need to inherit from <code>IModelValidator</code> and implement <code>Validate</code> method.</p>\n\n<h1>Custom validator</h1>\n\n<pre><code>public class ValidUrlAttribute : Attribute, IModelValidator\n{\n    public string ErrorMessage { get; set; }\n\n    public IEnumerable&lt;ModelValidationResult&gt; Validate(ModelValidationContext context)\n    {\n        var url = context.Model as string;\n        if (url != null &amp;&amp; Uri.IsWellFormedUriString(url, UriKind.Absolute))\n        {\n            return Enumerable.Empty&lt;ModelValidationResult&gt;();\n        }\n\n        return new List&lt;ModelValidationResult&gt;\n        {\n            new ModelValidationResult(context.ModelMetadata.PropertyName, ErrorMessage)\n        };\n    }\n}\n</code></pre>\n\n<h1>The model</h1>\n\n<pre><code>public class Product\n{\n    public int ProductId { get; set; }\n\n    [Required]\n    public string ProductName { get; set; }\n\n    [Required]\n    [ValidUrl]\n    public string ProductThumbnailUrl { get; set; }\n}\n</code></pre>\n\n<blockquote>\n  <p>Will this approach give opportunity to work with \"ModelState.IsValid\" property in controller action method?</p>\n</blockquote>\n\n<p>Yes! The <code>ModelState</code> object will correctly reflect the errors.</p>\n\n<blockquote>\n  <p>Can this approach be applied to the model class? Or it can be used with model class properties only?</p>\n</blockquote>\n\n<p>I don't know if that could be applied onto class level. I know you can get the information about the class from <code>ModelValidationContext</code> though:</p>\n\n<ul>\n<li><code>context.Model</code>: returns the property value that is to be validated</li>\n<li><code>context.Container</code>: returns the object that contains the property</li>\n<li><code>context.ActionContext</code>: provides context data and describes the action method that processes the request</li>\n<li><code>context.ModelMetadata</code>: describes the model class that is being validated in detail</li>\n</ul>\n\n<h1>Notes:</h1>\n\n<p>This validation attribute doesn't work with Client Validation, as requested in OP.</p>\n"}, {"comments": [{"owner": {"reputation": 12917, "user_id": 937440, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5ba5f9ad02a9ab43d4664d17747a1230?s=128&d=identicon&r=PG", "display_name": "w0051977", "link": "https://stackoverflow.com/users/937440/w0051977"}, "edited": false, "score": 1, "creation_date": 1554747888, "post_id": 46695926, "comment_id": 97857654, "body": "Could you add the front end code as well? It would help me and other readers I suspect."}, {"owner": {"reputation": 59385, "user_id": 2630078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UHzHh.png?s=128&g=1", "display_name": "Kirk Larkin", "link": "https://stackoverflow.com/users/2630078/kirk-larkin"}, "reply_to_user": {"reputation": 12917, "user_id": 937440, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5ba5f9ad02a9ab43d4664d17747a1230?s=128&d=identicon&r=PG", "display_name": "w0051977", "link": "https://stackoverflow.com/users/937440/w0051977"}, "edited": false, "score": 0, "creation_date": 1554801291, "post_id": 46695926, "comment_id": 97875240, "body": "The full example with the client-side implementation is available in the docs, <a href=\"https://docs.microsoft.com/en-us/aspnet/core/mvc/models/validation?view=aspnetcore-2.2#custom-client-side-validation\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 448, "user_id": 7969733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-edZLsbGJLu0/AAAAAAAAAAI/AAAAAAAABYw/1hHG5UCYwVA/photo.jpg?sz=128", "display_name": "sgrysoft", "link": "https://stackoverflow.com/users/7969733/sgrysoft"}, "edited": false, "score": 0, "creation_date": 1563110228, "post_id": 46695926, "comment_id": 100584751, "body": "I got a question about, because I hace done exactly like you, but, on the client side never validate my customs things"}, {"owner": {"reputation": 59385, "user_id": 2630078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UHzHh.png?s=128&g=1", "display_name": "Kirk Larkin", "link": "https://stackoverflow.com/users/2630078/kirk-larkin"}, "reply_to_user": {"reputation": 448, "user_id": 7969733, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-edZLsbGJLu0/AAAAAAAAAAI/AAAAAAAABYw/1hHG5UCYwVA/photo.jpg?sz=128", "display_name": "sgrysoft", "link": "https://stackoverflow.com/users/7969733/sgrysoft"}, "edited": false, "score": 0, "creation_date": 1563139754, "post_id": 46695926, "comment_id": 100591428, "body": "@sgrysoft This answer doesn&#39;t cover client-side validation. I linked above to the docs that explains how to do that. If you&#39;re having problems, ask a new question and feel free to post a link to it here."}], "tags": [], "owner": {"reputation": 59385, "user_id": 2630078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UHzHh.png?s=128&g=1", "display_name": "Kirk Larkin", "link": "https://stackoverflow.com/users/2630078/kirk-larkin"}, "is_accepted": true, "score": 32, "last_activity_date": 1554779693, "last_edit_date": 1554779693, "creation_date": 1507749449, "answer_id": 46695926, "question_id": 46694745, "link": "https://stackoverflow.com/questions/46694745/asp-net-core-custom-model-validation/46695926#46695926", "title": "ASP.NET Core - Custom model validation", "body": "<p>In .NET Core, you can simply create a class that inherits from <code>ValidationAttribute</code>. You can see the full details in the ASP.NET Core MVC <a href=\"https://docs.microsoft.com/en-us/aspnet/core/mvc/models/validation#custom-validation\" rel=\"noreferrer\">Docs</a>.</p>\n\n<p>Here's the example taken straight from the docs:</p>\n\n<pre><code>public class ClassicMovieAttribute : ValidationAttribute\n{\n    private int _year;\n\n    public ClassicMovieAttribute(int Year)\n    {\n        _year = Year;\n    }\n\n    protected override ValidationResult IsValid(object value, ValidationContext validationContext)\n    {\n        Movie movie = (Movie)validationContext.ObjectInstance;\n\n        if (movie.Genre == Genre.Classic &amp;&amp; movie.ReleaseDate.Year &gt; _year)\n        {\n            return new ValidationResult(GetErrorMessage());\n        }\n\n        return ValidationResult.Success;\n    }\n}\n</code></pre>\n\n<p>I've adapted the example to exclude client-side validation, as requested in your question.</p>\n\n<p>In order to use this new attribute (again, taken from the docs), you need to add it to the relevant field:</p>\n\n<pre><code>[ClassicMovie(1960)]\n[DataType(DataType.Date)]\npublic DateTime ReleaseDate { get; set; }\n</code></pre>\n\n<p>Here's another, simpler example for ensuring that a value is <code>true</code>:</p>\n\n<pre><code>public class EnforceTrueAttribute : ValidationAttribute\n{\n    public EnforceTrueAttribute()\n        : base(\"The {0} field must be true.\") { }\n\n    public override bool IsValid(object value) =&gt;\n        value is bool valueAsBool &amp;&amp; valueAsBool;\n}\n</code></pre>\n\n<p>This is applied in the same way:</p>\n\n<pre><code>[EnforceTrue]\npublic bool ThisShouldBeTrue { get; set; }\n</code></pre>\n\n<p><strong>Edit:</strong> Front-End Code as requested:</p>\n\n<pre><code>&lt;div asp-validation-summary=\"All\" class=\"text-danger\"&gt;&lt;/div&gt;\n</code></pre>\n\n<p>The options are All, ModelOnly or None.</p>\n"}], "owner": {"reputation": 5175, "user_id": 2818430, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a16f1277601b3bb40b01f97d8bbce0ac?s=128&d=identicon&r=PG&f=1", "display_name": "user2818430", "link": "https://stackoverflow.com/users/2818430/user2818430"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33493, "favorite_count": 6, "accepted_answer_id": 46695926, "answer_count": 2, "score": 23, "last_activity_date": 1554779693, "creation_date": 1507744860, "question_id": 46694745, "link": "https://stackoverflow.com/questions/46694745/asp-net-core-custom-model-validation", "title": "ASP.NET Core - Custom model validation", "body": "<p>In MVC when we post a model to an action we do the following in order to validate the model against the data annotation of that model:</p>\n\n<pre><code>if (ModelState.IsValid)\n</code></pre>\n\n<p>If we mark a property as [Required], the ModelState.IsValid will validate that property if contains a value or not.</p>\n\n<p>My question: How can I manually build and run custom validator?</p>\n\n<p>P.S. I am talking about backend validator only.</p>\n"}, {"tags": ["c#", ".net", "xml", "wpf", "combobox"], "comments": [{"owner": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "edited": false, "score": 1, "creation_date": 1507746225, "post_id": 46694682, "comment_id": 80337919, "body": "I think the XmlDataProvider&#39;s <code>XPath</code> only selects one block, so it should be <code>&quot;DAL&quot;</code>, the ComboBox binding&#39;s <code>XPath</code> should be <code>entry&#47;project_name</code>, and the ListView binding&#39;s <code>XPath</code> should be <code>entry</code>. I&#39;m not at a computer now, so can&#39;t confirm, but I remember getting bit by this not so straightforward XmlDataProvider behavior."}, {"owner": {"reputation": 347, "user_id": 1769062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f07322de4a432604519c09d5e4a8dd8?s=128&d=identicon&r=PG", "display_name": "SteveP", "link": "https://stackoverflow.com/users/1769062/stevep"}, "reply_to_user": {"reputation": 7906, "user_id": 4620101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPIEi.jpg?s=128&g=1", "display_name": "Szabolcs D&#233;zsi", "link": "https://stackoverflow.com/users/4620101/szabolcs-d%c3%a9zsi"}, "edited": false, "score": 0, "creation_date": 1507746785, "post_id": 46694682, "comment_id": 80338224, "body": "Thank you Szabolcs, that has done the trick. I&#39;ll supply the fixed code when I&#39;ve managed to filter out the duplicates from the ComboBox."}], "owner": {"reputation": 347, "user_id": 1769062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f07322de4a432604519c09d5e4a8dd8?s=128&d=identicon&r=PG", "display_name": "SteveP", "link": "https://stackoverflow.com/users/1769062/stevep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507744592, "creation_date": 1507744592, "question_id": 46694682, "link": "https://stackoverflow.com/questions/46694682/bind-wpf-combobox-to-xmldataprovider-in-code", "title": "Bind WPF ComboBox to XmlDataProvider in code", "body": "<p><strong>Problem</strong>\nUnable to populate WPF ComboBox from XmlDataProvider in cs code behind.</p>\n\n<p><strong>Background</strong>\nWe have a WPF window as part of a much larger desktop WPF application. The window displays a ListView the data for which is obtained from an external xml file. </p>\n\n<p>The objective is to be able to filter the ListView based on the selection made in a ComboBox.</p>\n\n<p>The ListView is populated using an XmlDataProvider at Window_Loaded.</p>\n\n<p>The ListView has four columns:</p>\n\n<ul>\n<li>Entry Date</li>\n<li>Project Name</li>\n<li>Node</li>\n<li>Entry</li>\n</ul>\n\n<p>We need to be able to filter the list by Project Name.</p>\n\n<p>The XML file needs to be external as it is up to the user which XML file they wish to view.</p>\n\n<p><strong>WPF XAML Code:</strong></p>\n\n<pre><code>    &lt;Grid&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"106*\"/&gt;\n        &lt;ColumnDefinition Width=\"227*\"/&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"17*\"/&gt;\n        &lt;RowDefinition Height=\"73*\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n    &lt;Label Content=\"DAL File Location\" HorizontalAlignment=\"Left\" Margin=\"46,10,0,0\" VerticalAlignment=\"Top\"/&gt;\n    &lt;TextBox x:Name=\"DALLocation\" HorizontalAlignment=\"Left\" Height=\"23\" Margin=\"170,13,0,0\" TextWrapping=\"Wrap\" VerticalAlignment=\"Top\" Width=\"258\" Grid.ColumnSpan=\"2\"/&gt;\n    &lt;Button x:Name=\"DALBrowse\" Content=\"Browse\" HorizontalAlignment=\"Left\" Margin=\"235,13,0,0\" VerticalAlignment=\"Top\" Width=\"75\" Grid.Column=\"1\" Click=\"DALBrowse_Click\"/&gt;\n    &lt;ListView x:Name=\"dal_list\" HorizontalAlignment=\"Stretch\" Height=\"Auto\" Margin=\"6,6,6,6\" Grid.Row=\"1\" VerticalAlignment=\"Stretch\" Width=\"Auto\" Grid.ColumnSpan=\"2\" ItemsSource=\"{Binding}\"&gt;\n        &lt;ListView.View&gt;\n            &lt;GridView&gt;\n                &lt;GridViewColumn Header=\"Entry Date\" Width=\"120\" DisplayMemberBinding=\"{Binding XPath=entry_date}\" /&gt;\n                &lt;GridViewColumn Header=\"Project\" Width=\"120\" DisplayMemberBinding=\"{Binding XPath=project_name}\" /&gt;\n                &lt;GridViewColumn Header=\"Node\" Width=\"120\" DisplayMemberBinding=\"{Binding XPath=node_name}\" /&gt;\n                &lt;GridViewColumn Header=\"Entry\" Width=\"120\" DisplayMemberBinding=\"{Binding XPath=entry_text}\" /&gt;\n                &lt;GridViewColumn Width=\"0\" DisplayMemberBinding=\"{Binding XPath=sort_date}\" /&gt;\n            &lt;/GridView&gt;\n        &lt;/ListView.View&gt;\n    &lt;/ListView&gt;\n    &lt;Label Content=\"Project\" HorizontalAlignment=\"Left\" Margin=\"46,41,0,0\" VerticalAlignment=\"Top\"/&gt;\n    &lt;ComboBox x:Name=\"cbProjects\" Grid.ColumnSpan=\"2\" HorizontalAlignment=\"Left\" Margin=\"170,41,0,0\" VerticalAlignment=\"Top\" Width=\"120\" ItemsSource=\"{Binding  XPath=project_name}\" DisplayMemberPath=\"@Name\" SelectedValuePath=\"@Name\"/&gt;\n\n&lt;/Grid&gt;\n</code></pre>\n\n<p><strong>Code Behind</strong></p>\n\n<pre><code>    public partial class DALManager : Window\n{\n    public string dalFolder;\n    public string dalFile;\n    public DALManager()\n    {\n        InitializeComponent();\n    }\n\n    private void Window_Loaded(object sender, RoutedEventArgs e)\n    {\n        this.DALLocation.Text = dalFolder;\n        XmlDataProvider xmlData = new XmlDataProvider();\n        xmlData.Source = new Uri(dalFolder + dalFile);\n        xmlData.XPath = \"DAL/entry\";\n        dal_list.DataContext = xmlData;\n        cbProjects.DataContext = xmlData;\n\n    }\n\n    private void DALBrowse_Click(object sender, RoutedEventArgs e)\n    {\n        System.Windows.Forms.FolderBrowserDialog fbd = new System.Windows.Forms.FolderBrowserDialog();\n        fbd.ShowNewFolderButton = false;\n        if (fbd.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n        {\n            this.DALLocation.Text = fbd.SelectedPath;\n            string oldPath = CGlobals.dal_path + \"\\\\DAL.xml\";\n            string newPath = fbd.SelectedPath + \"\\\\DAL.xml\";\n            File.Move(oldPath, newPath);\n            RegistryKey rgKey = Registry.CurrentUser.CreateSubKey(\"SOFTWARE\\\\SCP-Computers\\\\DocuMinder\");\n            CGlobals.dal_path = fbd.SelectedPath;\n            using (RegistryKey\n               rgInfo = rgKey.CreateSubKey(\"UserInfo\"))\n            {\n                rgInfo.SetValue(\"dal_path\", CGlobals.dal_path);\n            }\n\n        }\n\n    }\n}\n</code></pre>\n\n<p>The XML File</p>\n\n<pre><code>    &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;DAL&gt;\n  &lt;entry id=\"fe08125d-c785-40fc-816a-1e5ed3f06c7f-1\"&gt;\n    &lt;sort_date&gt;2017-10-01&lt;/sort_date&gt;\n    &lt;entry_date&gt;01/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test\"&gt;DAL Test&lt;/project_name&gt;\n    &lt;node_name&gt;notes&lt;/node_name&gt;\n    &lt;entry_text&gt;here is line 1 changed&lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"fe08125d-c785-40fc-816a-1e5ed3f06c7f-2\"&gt;\n    &lt;sort_date&gt;2017-10-03&lt;/sort_date&gt;\n    &lt;entry_date&gt;03/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test\"&gt;DAL Test&lt;/project_name&gt;\n    &lt;node_name&gt;notes&lt;/node_name&gt;\n    &lt;entry_text&gt;Here is line 2&lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"fe08125d-c785-40fc-816a-1e5ed3f06c7f-3\"&gt;\n    &lt;sort_date&gt;2017-10-10&lt;/sort_date&gt;\n    &lt;entry_date&gt;10/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test\"&gt;DAL Test&lt;/project_name&gt;\n    &lt;node_name&gt;notes&lt;/node_name&gt;\n    &lt;entry_text&gt;Here is line 3 &lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"fe08125d-c785-40fc-816a-1e5ed3f06c7f-4\"&gt;\n    &lt;sort_date&gt;2017-10-11&lt;/sort_date&gt;\n    &lt;entry_date&gt;11/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test\"&gt;DAL Test&lt;/project_name&gt;\n    &lt;node_name&gt;notes&lt;/node_name&gt;\n    &lt;entry_text&gt;Added line 4&lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"d9832a83-4aaa-4dd1-8c19-e469f1e5e1ed-1\"&gt;\n    &lt;sort_date&gt;2017-10-11&lt;/sort_date&gt;\n    &lt;entry_date&gt;11/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test\"&gt;DAL Test&lt;/project_name&gt;\n    &lt;node_name&gt;Another Node With Notes&lt;/node_name&gt;\n    &lt;entry_text&gt;Here is a note in another node.&lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"b0e36598-26e1-4204-b11a-665da02ff121-1\"&gt;\n    &lt;sort_date&gt;2017-10-11&lt;/sort_date&gt;\n    &lt;entry_date&gt;11/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test 2\"&gt;DAL Test 2&lt;/project_name&gt;\n    &lt;node_name&gt;Testing DAL in another project&lt;/node_name&gt;\n    &lt;entry_text&gt;This is another project.&lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"280743c7-c7e0-4345-9be3-fc502e3d1a45-1\"&gt;\n    &lt;sort_date&gt;2017-10-11&lt;/sort_date&gt;\n    &lt;entry_date&gt;11/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test 2\"&gt;DAL Test 2&lt;/project_name&gt;\n    &lt;node_name&gt;Test new node&lt;/node_name&gt;\n    &lt;entry_text&gt;Test if node name gets include when new.&lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"5a660158-3d56-477f-935b-d8270560cd1d-1\"&gt;\n    &lt;sort_date&gt;2017-10-11&lt;/sort_date&gt;\n    &lt;entry_date&gt;11/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test 2\"&gt;DAL Test 2&lt;/project_name&gt;\n    &lt;node_name&gt;Finding new node name&lt;/node_name&gt;\n    &lt;entry_text&gt;Add the note text. &lt;/entry_text&gt;\n  &lt;/entry&gt;\n  &lt;entry id=\"414844c2-7498-4794-9267-1abcc99de3c3-1\"&gt;\n    &lt;sort_date&gt;2017-10-11&lt;/sort_date&gt;\n    &lt;entry_date&gt;11/10/2017&lt;/entry_date&gt;\n    &lt;project_id&gt;0&lt;/project_id&gt;\n    &lt;project_name Name=\"Dal Test 2\"&gt;DAL Test 2&lt;/project_name&gt;\n    &lt;node_name&gt;Test new new node&lt;/node_name&gt;\n    &lt;entry_text&gt;Here is the text&lt;/entry_text&gt;\n  &lt;/entry&gt;\n&lt;/DAL&gt;\n</code></pre>\n\n<p><strong>The Result</strong></p>\n\n<p>I am only getting the first of the project names listed in the ComboBox.</p>\n\n<p>I have tried various combinations in the XAML file for binding the ComboBox based on numerous other questions on stackoverflow but am unable to find anything that works in my situation.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["c#", "linq"], "answers": [{"comments": [{"owner": {"reputation": 49855, "user_id": 5862071, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/II4q8.jpg?s=128&g=1", "display_name": "Ousmane D.", "link": "https://stackoverflow.com/users/5862071/ousmane-d"}, "edited": false, "score": 3, "creation_date": 1507744789, "post_id": 46694701, "comment_id": 80337186, "body": "Or just TotalLaborHours = db.Timesheet         .Sum(a =&gt; a.Date &lt;= MDate &amp;&amp; a.Date.Month == MDate.Month?       a.RegularPaidHours + a.OvertimeHours : 0);"}, {"owner": {"reputation": 513, "user_id": 8050298, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cdfbf4cdc892d07ed43f0757975e8d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/8050298/cosmin"}, "edited": false, "score": 0, "creation_date": 1507745290, "post_id": 46694701, "comment_id": 80337460, "body": "This is exactly what I was looking for. Thank you!"}], "tags": [], "owner": {"reputation": 389, "user_id": 2371215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4651132131eba1b4a741280d8779cea?s=128&d=identicon&r=PG", "display_name": "amburt05", "link": "https://stackoverflow.com/users/2371215/amburt05"}, "is_accepted": true, "score": 3, "last_activity_date": 1507744663, "creation_date": 1507744663, "answer_id": 46694701, "question_id": 46694637, "link": "https://stackoverflow.com/questions/46694637/summing-columns-using-linq/46694701#46694701", "title": "Summing columns using LINQ", "body": "<p>Would this not have the same effect? </p>\n\n<pre><code>TotalLaborHours = db.Timesheet\n    .Where(a =&gt; a.Date &lt;= MDate &amp; a.Date.Month == MDate.Month)\n    .Select(a =&gt; a.RegularPaidHours + a.OvertimeHours).Sum();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 36783, "user_id": 2946329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ygJ.jpg?s=128&g=1", "display_name": "Salah Akbari", "link": "https://stackoverflow.com/users/2946329/salah-akbari"}, "edited": false, "score": 3, "creation_date": 1507745246, "post_id": 46694722, "comment_id": 80337431, "body": "As it&#39;s currently written, doesn&#39;t compiles. You need to change your <code>Sum</code> method to this <code>Sum(c =&gt; c.hrs)</code> to make this compiles."}], "tags": [], "owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "is_accepted": false, "score": 0, "last_activity_date": 1507745358, "last_edit_date": 1507745358, "creation_date": 1507744742, "answer_id": 46694722, "question_id": 46694637, "link": "https://stackoverflow.com/questions/46694637/summing-columns-using-linq/46694722#46694722", "title": "Summing columns using LINQ", "body": "<p>You could use an anonymous type which is the sum of the two columns, then sum the sum like so:</p>\n\n<pre><code>TotalLaborHours = db.Timesheet\n    .Where(a =&gt; a.Date &lt;= MDate &amp; a.Date.Month == MDate.Month)\n    .Select(a =&gt; new { hrs = a.RegularPaidHours + a.OvertimeHours }).Sum(b =&gt; b.hrs);\n</code></pre>\n"}], "owner": {"reputation": 513, "user_id": 8050298, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cdfbf4cdc892d07ed43f0757975e8d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/8050298/cosmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 46694701, "answer_count": 2, "score": 0, "last_activity_date": 1507745358, "creation_date": 1507744442, "last_edit_date": 1507744637, "question_id": 46694637, "link": "https://stackoverflow.com/questions/46694637/summing-columns-using-linq", "title": "Summing columns using LINQ", "body": "<p>I am searching for a more elegant way of summing 2 columns, month to date using LINQ. I have the following query which works just fine but it looks inefficient.</p>\n\n<p>What's a better way of rewriting it?</p>\n\n<p>Thank you</p>\n\n<pre><code>TotalLaborHours = db.Timesheet.Where(a =&gt; a.Date &lt;= MDate &amp; a.Date.Month == MDate.Month)\n                              .Select(a =&gt; a.RegularPaidHours).Sum() + \n                  db.Timesheet.Where(a =&gt; a.Date &lt;= MDate &amp; a.Date.Month == MDate.Month)\n                              .Select(a =&gt; a.OvertimeHours).Sum();\n</code></pre>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507744302, "post_id": 46694531, "comment_id": 80336921, "body": "what type of field is it? Maybe try hfResourceID.Text instead of .Value, then parse the string value to an int or whatever type."}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507744335, "post_id": 46694531, "comment_id": 80336942, "body": "Well, you&#39;re not providing a parameter called <code>&quot;@ResourceID&quot;</code>.  According to the error, the stored procedure expects that parameter.  It looks like you tried to supply that parameter at some point, but now it&#39;s commented out.  Code in comments doesn&#39;t execute."}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507744589, "post_id": 46694531, "comment_id": 80337093, "body": "Additionally, the &quot;embedded statement...&quot; error refers to your if/else blocks.  The <i>only</i> thing you do in each block is declare a variable, nothing else.  The compiler doesn&#39;t allow that.  There&#39;s no purpose to it, the variable would immediately fall out of scope."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "reply_to_user": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507744989, "post_id": 46694531, "comment_id": 80337299, "body": "@David Originally, the commented line was not commented and the if/else was not there; I was trying a workaround.  And yes, I understand that the &#39;embedded&#39; issue came from the if/else; I pretty much added insult to injury.  I&#39;m afraid that I don&#39;t understand your 2nd post.  Are you saying that I can&#39;t set values under the if and else at the same time?"}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507745210, "post_id": 46694531, "comment_id": 80337410, "body": "@Akerra.  I am using the code that was in the video and it worked for him so I am at a loss why it doesn&#39;t work for me.  I will try your suggestion."}, {"owner": {"reputation": 775, "user_id": 1111790, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/79dc09d34bc431d6226506aafc873c80?s=128&d=identicon&r=PG", "display_name": "Kixoka", "link": "https://stackoverflow.com/users/1111790/kixoka"}, "edited": false, "score": 0, "creation_date": 1507745450, "post_id": 46694531, "comment_id": 80337526, "body": "You need to create a parameter for the &quot;resourceid&quot; to be passed back to the stored procedure you are making a call against.  Your commented out line should give you the clue... alternatively you can default the parameter in the stored proc to have a default value if nothing is passed in."}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507745472, "post_id": 46694531, "comment_id": 80337534, "body": "@MonicaCollins: For starters, get rid of everything you&#39;re trying to do in the if/else.  You originally had something that wasn&#39;t working, then you tried adding a bunch of random things.  Go back to the original problem and we can help solve that.  Don&#39;t confuse the problem by adding more problems."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "reply_to_user": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507746063, "post_id": 46694531, "comment_id": 80337839, "body": "@David, you are right, I should have started at my original problem.  Thanks for pointing that out.  I&#39;ll make sure to do that in future.  I don&#39;t know how to modify my original message above to replace that code with what I had previously.  Going back to that, when I try updating an existing record, hfResourceID.Value shows to contain &quot;1&quot;.  When I execute, I get &quot;Procedure or function &#39;ResourceCreateOrUpdate&#39; expects parameter &#39;@ResourceID&#39;, which was not supplied.&quot; even though it should have the value of &quot;1&quot;."}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1507746206, "post_id": 46694531, "comment_id": 80337908, "body": "@MonicaCollins: Press the &quot;edit&quot; link on the question to modify it.  You&#39;re going to need to show us your code in order for anybody to help you with that code."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507746291, "post_id": 46694531, "comment_id": 80337955, "body": "@akerra When I try to change Convert.Value to Convert.ToString, the entire parameter errors out."}, {"owner": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507746433, "post_id": 46694531, "comment_id": 80338037, "body": "@MonicaCollins that&#39;s not what I was suggesting. Everywhere you have hfResourceID.Value, change it to hfResourceID.Text."}, {"owner": {"reputation": 2710, "user_id": 7193132, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3aAPt.jpg?s=128&g=1", "display_name": "Masoud Andalibi", "link": "https://stackoverflow.com/users/7193132/masoud-andalibi"}, "edited": false, "score": 0, "creation_date": 1507746433, "post_id": 46694531, "comment_id": 80338038, "body": "Are you sure that hidden field does have value even? instead of checking if its == &quot;&quot; check if its null or not. point a breakpoint and track it carefully."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507746598, "post_id": 46694531, "comment_id": 80338139, "body": "Ok, I trying copying into the comment and it looked like crap.  I don&#39;t have an edit button for my original entry.  I&#39;ve looked.  The only ones I have are for the comments.  I&#39;m sure that I&#39;m missing something that is probably right out in the open."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "reply_to_user": {"reputation": 427, "user_id": 7897865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e85affefd77c713c7a05f85ed2ff3d?s=128&d=identicon&r=PG&f=1", "display_name": "akerra", "link": "https://stackoverflow.com/users/7897865/akerra"}, "edited": false, "score": 0, "creation_date": 1507746860, "post_id": 46694531, "comment_id": 80338273, "body": "@akerra I tried that and got an error on the entire parameter."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "reply_to_user": {"reputation": 2710, "user_id": 7193132, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3aAPt.jpg?s=128&g=1", "display_name": "Masoud Andalibi", "link": "https://stackoverflow.com/users/7193132/masoud-andalibi"}, "edited": false, "score": 0, "creation_date": 1507746960, "post_id": 46694531, "comment_id": 80338335, "body": "@ecKO When I debug and follow the execution, under Autos, I see &quot;1&quot; for hfResourceID.Value when working with record #1.  When I tried to add, I see &quot;&quot;."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507746998, "post_id": 46694531, "comment_id": 80338355, "body": "Is there a way to add screen shots to my post?"}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507747070, "post_id": 46694531, "comment_id": 80338393, "body": "I found the edit button.  I figured it was in plain sight lol."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507908995, "post_id": 46695007, "comment_id": 80413340, "body": "I included the asp statement for the hidden field above."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507928468, "post_id": 46695007, "comment_id": 80422759, "body": "I tried adding System.Diagnostics.Debug.Writeline() however I never received anything so I guess that I using it incorrectly.  Is there any way to see the commands in sqlcndCreateOrUpdate.ExecuteNonQuery()?"}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507929179, "post_id": 46695007, "comment_id": 80423070, "body": "It looks like the stack trace on the yellow page is what I was just asking about.  Is that correct?  If so, is there a way to see the actual values once within the execution?"}], "tags": [], "owner": {"reputation": 583, "user_id": 668751, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/462a25076f8fdd98ca7e9a41e8f1c83e?s=128&d=identicon&r=PG", "display_name": "willyMon", "link": "https://stackoverflow.com/users/668751/willymon"}, "is_accepted": false, "score": -1, "last_activity_date": 1507745873, "creation_date": 1507745873, "answer_id": 46695007, "question_id": 46694531, "link": "https://stackoverflow.com/questions/46694531/cant-get-a-value-out-an-asp-net-hidden-field/46695007#46695007", "title": "Can&#39;t get a value out an ASP.NET hidden field", "body": "<p>Take a look on ASP code, specifically the way you are setting hidden field value. I guess it is properly marked as runat=server but maybe some problem is going on in your asp.net code, try to debug client code by using: console.log function and see the output in your console browser.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507748095, "post_id": 46695109, "comment_id": 80338923, "body": "Thanks for pointing that out.  There is another If/else statment that doesn&#39;t have them and they don&#39;t get errors.  I will err on the side of caution and get in the habit of using the curly brackets."}, {"owner": {"reputation": 2214, "user_id": 3739842, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d9a7ea5bdc5e8b8ae08d62cbef30c7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Sean T", "link": "https://stackoverflow.com/users/3739842/sean-t"}, "reply_to_user": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507750076, "post_id": 46695109, "comment_id": 80339869, "body": "It&#39;s because you&#39;re making a declaration of a variable on the very next line after the if ( your &#39;int&#39;). I also omit curly brackets but only if the statement requires one line of code after the &#39;if&#39;, and it is not a new variable declaration. :)"}, {"owner": {"reputation": 2214, "user_id": 3739842, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d9a7ea5bdc5e8b8ae08d62cbef30c7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Sean T", "link": "https://stackoverflow.com/users/3739842/sean-t"}, "reply_to_user": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507750132, "post_id": 46695109, "comment_id": 80339891, "body": "It&#39;s probably best to read up on what scope is when programming in c#, it will clear things up for you"}], "tags": [], "owner": {"reputation": 2214, "user_id": 3739842, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d9a7ea5bdc5e8b8ae08d62cbef30c7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Sean T", "link": "https://stackoverflow.com/users/3739842/sean-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1507746231, "creation_date": 1507746231, "answer_id": 46695109, "question_id": 46694531, "link": "https://stackoverflow.com/questions/46694531/cant-get-a-value-out-an-asp-net-hidden-field/46695109#46695109", "title": "Can&#39;t get a value out an ASP.NET hidden field", "body": "<p>Your error regarding the embedded statement is because you a declaring </p>\n\n<pre><code>if (strResourceID == \"\")\n        int intResourceID = 0;\n    else\n        int intResourceID = (Convert.ToInt32(hfResourceID.Value));\n</code></pre>\n\n<p>When decalring a variable directly after an If or else then you need your curly brackets. So...</p>\n\n<pre><code>if (strResourceID == \"\")\n{       \n    int intResourceID = 0;\n}\nelse\n{\n    int intResourceID = (Convert.ToInt32(hfResourceID.Value));\n}\n</code></pre>\n\n<p>As for your other issues I would need to see your client side code.</p>\n"}, {"comments": [{"owner": {"reputation": 2710, "user_id": 7193132, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3aAPt.jpg?s=128&g=1", "display_name": "Masoud Andalibi", "link": "https://stackoverflow.com/users/7193132/masoud-andalibi"}, "edited": false, "score": 0, "creation_date": 1507746547, "post_id": 46695186, "comment_id": 80338108, "body": "this at least checks if it&#39;s null or not."}, {"owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "edited": false, "score": 0, "creation_date": 1507908840, "post_id": 46695186, "comment_id": 80413248, "body": "I tried this.  I even put my code within a boolean true, so now I am sure that I have a valid value."}], "tags": [], "owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1507746585, "last_edit_date": 1507746585, "creation_date": 1507746510, "answer_id": 46695186, "question_id": 46694531, "link": "https://stackoverflow.com/questions/46694531/cant-get-a-value-out-an-asp-net-hidden-field/46695186#46695186", "title": "Can&#39;t get a value out an ASP.NET hidden field", "body": "<p>There are a few issues with the code you copied from that video. But here a snippet as to how it should be done. I've added 3 ways to convert from the HiddenField value to an actual <code>int</code>. Which one you use can depend on how you want to handle errors, 0 values etc. Not included in the snippet, but I like to check for IsNullOrEmpty while using <code>Trim()</code>, that gets rid of spaces that might make the value non-convertible <code>if (!string.IsNullOrEmpty(hfResourceID.Value.Trim()))</code>.</p>\n\n<pre><code>int intResourceID = 0;\n\n//this will try to convert but you won't see exeptions when failed\nInt32.TryParse(hfResourceID.Value, out intResourceID);\n\n//checks if there is a value in the hiddenfield, but throws yellow screen if not convertible\nif (!string.IsNullOrEmpty(hfResourceID.Value))\n{\n    intResourceID = Convert.ToInt32(hfResourceID.Value);\n}\n\n//catch an error when the value is not convertible, can be wrapped with !string.IsNullOrEmpty(hfResourceID.Value)\ntry\n{\n    intResourceID = Convert.ToInt32(hfResourceID.Value);\n}\ncatch (Exception ex)\n{\n    //handle the error, can be seen with ex.Message\n}\n\n//if the hidden value is still 0 (for whatever reason) you might not want to execute the query\n//so the next part will return and stop executing the rest of the code\nif (intResourceID == 0)\n{\n    return;\n}\n\n//update the database, using 'using' will ensure proper closure of the connection and disposing of any objects\nusing (SqlConnection connection = new SqlConnection(\"myConnectionString\"))\nusing (SqlCommand command = new SqlCommand(\"ResourceCreateOrUpdate\", connection))\n{\n    //set the command type and add the parameters\n    command.CommandType = CommandType.StoredProcedure;\n    command.Parameters.Add(\"@ResourceID\", SqlDbType.Int).Value = intResourceID;\n\n    try\n    {\n        //open the database connection and execute the command\n        connection.Open();\n        command.ExecuteNonQuery();\n    }\n    catch (Exception ex)\n    {\n        //there was an error opening the database connection or with the command, can be viewed with ex.Message\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8760599, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZVf8vd84FtI/AAAAAAAAAAI/AAAAAAAAEPY/A453OVt_KkM/photo.jpg?sz=128", "display_name": "Monica Collins", "link": "https://stackoverflow.com/users/8760599/monica-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1521485340, "creation_date": 1507744014, "last_edit_date": 1521485340, "question_id": 46694531, "link": "https://stackoverflow.com/questions/46694531/cant-get-a-value-out-an-asp-net-hidden-field", "title": "Can&#39;t get a value out an ASP.NET hidden field", "body": "<p>I am going through a YouTube video, to learn ASP.NET.  I've gotten it to work for the most part, with a somewhat major caveat: I can't retrieve a value from a hidden field ID.  Because of that, I don't have a value to send to a stored procedure to create or update. </p>\n\n<p>The commented out line is the original statement. When I have that then execute \n<code>.ExecuteNonQuery</code>, I get the following error: </p>\n\n<blockquote>\n  <p>Procedure or function 'ResourceCreateOrUpdate' expects parameter '@ResourceID', which was not supplied</p>\n</blockquote>\n\n<p>When I try to display hfResourceID, I have nothing when trying to pass 0, for a create, or the ResourceID value, i.e. 1.  That value however, doesn't get there.  I know the stored procedure works because I can execute it in SQL Server Management.</p>\n\n<p>I tried moving hfResourceID to a string, then a integer value, but I seem to be having problems creating the if/else: everything is marked as an error.  When I hover over the lines, I get the following message, which pretty much leave me clueless: </p>\n\n<blockquote>\n  <p>\"Embedded statement cannot be a declaration or labeled statement\".</p>\n</blockquote>\n\n<p>Would I be able to get any pointers on how to clear up my error, please?  Thanks.</p>\n\n<p><strong>2017-10-13 @ 10:38: code updated</strong></p>\n\n<pre><code>    &lt;asp:HiddenField ID=\"hfResourceID\" runat=\"server\" /&gt;\n\n    protected void btnSave_Click(object sender, EventArgs e)\n    {\n        int intResourceID = 0;\n        bool boolIDHasValue = true;\n        try\n        {\n            intResourceID = Convert.ToInt32(hfResourceID.Value);\n        }\n        catch (Exception ex)\n        {\n            lblErrorMessage.Text = ex.Message;\n            boolIDHasValue = false;\n        }\n        if (boolIDHasValue)\n        {\n            if (sqlconnODRConnection.State == System.Data.ConnectionState.Closed)\n                sqlconnODRConnection.Open();\n            SqlCommand sqlcmdCreateOrUpdate = new SqlCommand(\"ResourceCreateOrUpdate\", sqlconnODRConnection);\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@ResourceID\", intResourceID);\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@Status\", txtStatus.Text.Trim());\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@FirstName\", txtFirstName.Text.Trim());\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@MiddleName\", txtMiddleName.Text.Trim());\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@LastName\", txtLastName.Text.Trim());\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@NickName\", txtNickName.Text.Trim());\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@Gender\", txtGender.Text.Trim());\n            sqlcmdCreateOrUpdate.Parameters.AddWithValue(\"@USCitizen\", txtUSCitizen.Text.Trim());\n            sqlcmdCreateOrUpdate.ExecuteNonQuery();\n            sqlconnODRConnection.Close();\n            string strResourceID = hfResourceID.Value;\n            Clear();\n            if (strResourceID == \"\")\n                lblSuccessMessage.Text = \"Saved Successfully\";\n            else\n                lblSuccessMessage.Text = \"Updated Successfully\";\n            FillGridView();\n        }\n\n    }\n</code></pre>\n"}, {"tags": ["c#", "parsing", "math", "dll"], "answers": [{"comments": [{"owner": {"reputation": 292363, "user_id": 37213, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/eeec80237213c91e5bab56b77ac5b8ca?s=128&d=identicon&r=PG", "display_name": "duffymo", "link": "https://stackoverflow.com/users/37213/duffymo"}, "edited": false, "score": 0, "creation_date": 1507745314, "post_id": 46694544, "comment_id": 80337475, "body": "I agree - I won&#39;t write Java without Maven now."}, {"owner": {"reputation": 633, "user_id": 8086906, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8b237d2a37507a1739d8835b56b10e38?s=128&d=identicon&r=PG&f=1", "display_name": "user8086906", "link": "https://stackoverflow.com/users/8086906/user8086906"}, "edited": false, "score": 0, "creation_date": 1507745500, "post_id": 46694544, "comment_id": 80337549, "body": "i wanted to do that but my nuget package tab doesnt open"}, {"owner": {"reputation": 389, "user_id": 2371215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4651132131eba1b4a741280d8779cea?s=128&d=identicon&r=PG", "display_name": "amburt05", "link": "https://stackoverflow.com/users/2371215/amburt05"}, "reply_to_user": {"reputation": 633, "user_id": 8086906, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8b237d2a37507a1739d8835b56b10e38?s=128&d=identicon&r=PG&f=1", "display_name": "user8086906", "link": "https://stackoverflow.com/users/8086906/user8086906"}, "edited": false, "score": 0, "creation_date": 1507746331, "post_id": 46694544, "comment_id": 80337981, "body": "@user8086906 Can you access the Package Manager Console? Here is where you can find the command to download the particular package:  <a href=\"https://www.nuget.org/packages/MathParser.org-mXparser/\" rel=\"nofollow noreferrer\">nuget.org/packages/MathParser.org-mXparser</a>"}], "tags": [], "owner": {"reputation": 389, "user_id": 2371215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4651132131eba1b4a741280d8779cea?s=128&d=identicon&r=PG", "display_name": "amburt05", "link": "https://stackoverflow.com/users/2371215/amburt05"}, "is_accepted": false, "score": 1, "last_activity_date": 1507744081, "creation_date": 1507744081, "answer_id": 46694544, "question_id": 46694458, "link": "https://stackoverflow.com/questions/46694458/c-i-cant-find-mxparser-dll/46694544#46694544", "title": "C# - I can&#39;t find mxparser dll", "body": "<p>I would use NuGet to manage your dependencies. It just makes things easier on you. It also appears there is a package for mXparser.</p>\n"}, {"tags": [], "owner": {"reputation": 926, "user_id": 5999910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4867623bfa8282d0b6a920a8c394388f?s=128&d=identicon&r=PG&f=1", "display_name": "Leroy Kegan", "link": "https://stackoverflow.com/users/5999910/leroy-kegan"}, "is_accepted": false, "score": 0, "last_activity_date": 1507762672, "creation_date": 1507762672, "answer_id": 46698787, "question_id": 46694458, "link": "https://stackoverflow.com/questions/46694458/c-i-cant-find-mxparser-dll/46698787#46698787", "title": "C# - I can&#39;t find mxparser dll", "body": "<p>Use nuget as previously suggested, If you still prefer dll then follow the download link in the release section on github or better on the mathparser.org page</p>\n\n<p><a href=\"http://mathparser.org/mxparser-downloads/\" rel=\"nofollow noreferrer\">http://mathparser.org/mxparser-downloads/</a></p>\n\n<p><a href=\"https://www.nuget.org/packages/MathParser.org-mXparser/\" rel=\"nofollow noreferrer\">https://www.nuget.org/packages/MathParser.org-mXparser/</a></p>\n\n<p><a href=\"https://search.maven.org/#search%7Cga%7C1%7Ca%3A%22MathParser.org-mXparser%22\" rel=\"nofollow noreferrer\">https://search.maven.org/#search%7Cga%7C1%7Ca%3A%22MathParser.org-mXparser%22</a></p>\n\n<p><a href=\"https://github.com/mariuszgromada/MathParser.org-mXparser/releases\" rel=\"nofollow noreferrer\">https://github.com/mariuszgromada/MathParser.org-mXparser/releases</a></p>\n\n<p>Best regards</p>\n"}], "owner": {"reputation": 633, "user_id": 8086906, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8b237d2a37507a1739d8835b56b10e38?s=128&d=identicon&r=PG&f=1", "display_name": "user8086906", "link": "https://stackoverflow.com/users/8086906/user8086906"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507762672, "creation_date": 1507743745, "question_id": 46694458, "link": "https://stackoverflow.com/questions/46694458/c-i-cant-find-mxparser-dll", "title": "C# - I can&#39;t find mxparser dll", "body": "<p>I am creating a software in which i need a really good math parser, i found out that mxparser is a grat one so wanted to try it out, however, i downloaded the whole source, went to the specified folder but i didnt see any dll to add to my project...\n<a href=\"https://github.com/mariuszgromada/mXparser\" rel=\"nofollow noreferrer\">https://github.com/mariuszgromada/mXparser</a>\ntht is the github link\naccording to the helloworld tutorial, the dll is supposed to be in\nmxparser/current/c sharp/bin/release\nbut there is nothing there\nso my question is that: is there somewhere else i can get the dll or is there any other method that i can use it</p>\n"}, {"tags": ["c#", "ios", "xamarin.ios"], "comments": [{"owner": {"reputation": 2065, "user_id": 5474400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6w6U5.jpg?s=128&g=1", "display_name": "Kevin Li", "link": "https://stackoverflow.com/users/5474400/kevin-li"}, "edited": false, "score": 0, "creation_date": 1507795380, "post_id": 46694457, "comment_id": 80355607, "body": "Did the label create via the storyboard or code?"}, {"owner": {"reputation": 1, "user_id": 8063317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7eba145e35a7b8f097d840479f588fe?s=128&d=identicon&r=PG&f=1", "display_name": "iOSDev456", "link": "https://stackoverflow.com/users/8063317/iosdev456"}, "reply_to_user": {"reputation": 2065, "user_id": 5474400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6w6U5.jpg?s=128&g=1", "display_name": "Kevin Li", "link": "https://stackoverflow.com/users/5474400/kevin-li"}, "edited": false, "score": 0, "creation_date": 1507806084, "post_id": 46694457, "comment_id": 80362242, "body": "it is created by storyboard."}, {"owner": {"reputation": 2065, "user_id": 5474400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6w6U5.jpg?s=128&g=1", "display_name": "Kevin Li", "link": "https://stackoverflow.com/users/5474400/kevin-li"}, "edited": false, "score": 0, "creation_date": 1507875348, "post_id": 46694457, "comment_id": 80393396, "body": "Will this issue happen if you create the label via C# code?"}, {"owner": {"reputation": 1, "user_id": 8063317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7eba145e35a7b8f097d840479f588fe?s=128&d=identicon&r=PG&f=1", "display_name": "iOSDev456", "link": "https://stackoverflow.com/users/8063317/iosdev456"}, "reply_to_user": {"reputation": 2065, "user_id": 5474400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6w6U5.jpg?s=128&g=1", "display_name": "Kevin Li", "link": "https://stackoverflow.com/users/5474400/kevin-li"}, "edited": false, "score": 0, "creation_date": 1507877144, "post_id": 46694457, "comment_id": 80394193, "body": "I don&#39;t try that..but i think this issue not happen when i create label via code.."}, {"owner": {"reputation": 2065, "user_id": 5474400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6w6U5.jpg?s=128&g=1", "display_name": "Kevin Li", "link": "https://stackoverflow.com/users/5474400/kevin-li"}, "edited": false, "score": 0, "creation_date": 1508217568, "post_id": 46694457, "comment_id": 80512182, "body": "Maybe it&#39;s a bug with xamarin storyboard, you may file a bug here:<a href=\"https://bugzilla.xamarin.com/\" rel=\"nofollow noreferrer\">bugzilla.xamarin.com</a>."}], "owner": {"reputation": 1, "user_id": 8063317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7eba145e35a7b8f097d840479f588fe?s=128&d=identicon&r=PG&f=1", "display_name": "iOSDev456", "link": "https://stackoverflow.com/users/8063317/iosdev456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507744107, "creation_date": 1507743742, "last_edit_date": 1507744107, "question_id": 46694457, "link": "https://stackoverflow.com/questions/46694457/xamarin-ios-produce-random-crash", "title": "Xamarin iOS produce random crash", "body": "<p>I am working on Xamarin iOS from last 3 weeks, before this i am using objective c and swift for developing native iOS apps.\nWhat actually happened is very rare, i never seen this type of issue in native iOS.\nLet suppose there are two view controllers FirstVC and SecondVC, and there are some outlets defined in storyboard for both of them. Now i am navigating(Push) from FirstVC to SecondVC vice-versa(Pop). After doing this 5 to 6 times, in any of view controller i get a crash and when i debug it, what i found is something rare(please see attached image), the label has an instance but properties of label like text, frame, color, background nothing can be accessible and when i am setting something on this property it produces SIGSEGV error. </p>\n\n<p>Because of this, my application is getting crash after every 3 to 4 minutes of usage.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5BhW4.png\" rel=\"nofollow noreferrer\">Issue Image</a></p>\n\n<p>In attached image, one label has this issue whereas other have all its properties.</p>\n\n<p><strong>Note:</strong> It is not because of memory management.</p>\n"}, {"tags": ["c#", "task-parallel-library", "tpl-dataflow", "dataflow"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 6340050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8487fd4baac816221af56adeaa1d13?s=128&d=identicon&r=PG&f=1", "display_name": "Zorik", "link": "https://stackoverflow.com/users/6340050/zorik"}, "edited": false, "score": 0, "creation_date": 1507910991, "post_id": 46697300, "comment_id": 80414469, "body": "Thanks VMAtm. I never tried to pass the predicate before and I learned a lot from your sample. Still not sure it is applicable to my case. But maybe I miss something because have not totally understood it. So one question - you wrote &quot;<i>Note that you still should link the block without any predicate at least once for avoiding the memory issues</i>&quot;. Can you explain what memory issues do you mean?"}, {"owner": {"reputation": 26725, "user_id": 213550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cyZ5c.jpg?s=128&g=1", "display_name": "VMAtm", "link": "https://stackoverflow.com/users/213550/vmatm"}, "reply_to_user": {"reputation": 147, "user_id": 6340050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8487fd4baac816221af56adeaa1d13?s=128&d=identicon&r=PG&f=1", "display_name": "Zorik", "link": "https://stackoverflow.com/users/6340050/zorik"}, "edited": false, "score": 0, "creation_date": 1507912255, "post_id": 46697300, "comment_id": 80415114, "body": "As I said, this code isn&#39;t properly tested, and, maybe, there is a situation then all the predicate return false. After that the message will stay in <code>BufferBlock</code> till the end of the program. It is a common practice to create a block for &quot;bad&quot; messages to leave the biffer. <code>NullTarget</code> simply ignores the message, but you can use any block you like and logg all the predicate misses."}], "tags": [], "owner": {"reputation": 26725, "user_id": 213550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cyZ5c.jpg?s=128&g=1", "display_name": "VMAtm", "link": "https://stackoverflow.com/users/213550/vmatm"}, "is_accepted": true, "score": 1, "last_activity_date": 1507754947, "creation_date": 1507754947, "answer_id": 46697300, "question_id": 46694427, "link": "https://stackoverflow.com/questions/46694427/tpl-block-with-round-robin-link/46697300#46697300", "title": "TPL Block with round robin link?", "body": "<p>Are you aware of possibility to <a href=\"https://msdn.microsoft.com/en-us/library/system.threading.tasks.dataflow.dataflowblock.linkto.aspx\" rel=\"nofollow noreferrer\">link the blocks with a predicate</a>? This is a very simple and not well tested solution for sample:</p>\n\n<pre><code>var buffer = new BufferBlock&lt;int&gt;();\nvar consumer1 = new ActionBlock&lt;int&gt;(i =&gt; Console.WriteLine($\"First: {i}\"));\nvar consumer2 = new ActionBlock&lt;int&gt;(i =&gt; Console.WriteLine($\"Second: {i}\"));\nvar consumer3 = new ActionBlock&lt;int&gt;(i =&gt; Console.WriteLine($\"Third: {i}\"));\nvar consumer4 = new ActionBlock&lt;int&gt;(i =&gt; Console.WriteLine($\"Forth: {i}\"));\n\nbuffer.LinkTo(consumer1, i =&gt; Predicate(0));\nbuffer.LinkTo(consumer2, i =&gt; Predicate(1));\nbuffer.LinkTo(consumer3, i =&gt; Predicate(2));\nbuffer.LinkTo(consumer4, i =&gt; Predicate(3));\nbuffer.LinkTo(DataflowBlock.NullTarget&lt;int&gt;());\n\nfor (var i = 0; i &lt; 10; ++i)\n{\n    buffer.Post(i);\n}\nbuffer.Completion.Wait();\n</code></pre>\n\n<p>One of the outputs:</p>\n\n<pre><code>Third: 2\nFirst: 0\nForth: 3\nSecond: 1\nSecond: 5\nSecond: 9\nThird: 6\nForth: 7\nFirst: 4\nFirst: 8\n</code></pre>\n\n<p>What is going on here is you're maintaining the number of operation, and if current is suitable for the consumer, we just increment that. Note that you still should link the block without any predicate at least once for avoiding the memory issues (also, it's a good idea to test the round robin with block which do monitor the lost messages).</p>\n"}], "owner": {"reputation": 147, "user_id": 6340050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b8487fd4baac816221af56adeaa1d13?s=128&d=identicon&r=PG&f=1", "display_name": "Zorik", "link": "https://stackoverflow.com/users/6340050/zorik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 46697300, "answer_count": 1, "score": 1, "last_activity_date": 1507754992, "creation_date": 1507743642, "last_edit_date": 1507754992, "question_id": 46694427, "link": "https://stackoverflow.com/questions/46694427/tpl-block-with-round-robin-link", "title": "TPL Block with round robin link?", "body": "<p>I am using TPL a lot and have large data flow pipeline structure.<br>\nAs part of the pipeline network I want to write some data to azure blob storage. We have a lot of data therefore we have <code>4</code> storage accounts and we want to distribute the data evenly between them.</p>\n\n<p>Wanted to continue using the dataflow pipeline pattern therefore I want to implement a <code>SourceBlock</code> that if I link it to several target blocks it will send the messages to them with round robin. <code>BufferBlock</code> is not good enough because he is sending the message to the first block that accepts it, and assuming all the target blocks have large bounded capacity - all the messages will go to the first target block. <code>BroadcastBlock</code> is not good as well because I don`t want duplicates. </p>\n\n<p>Any recommendations? Implementing the <code>ISourceBlock</code> interface with the round robing behavior seems not so simple and I wondered if there are simpler solutions out there? or any extensions to TPL that I am not familar with?</p>\n"}, {"tags": ["c#", "inputbox"], "comments": [{"owner": {"reputation": 1549, "user_id": 5890367, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10206951008588352/picture?type=large", "display_name": "Blake Thingstad", "link": "https://stackoverflow.com/users/5890367/blake-thingstad"}, "edited": false, "score": 0, "creation_date": 1507743953, "post_id": 46694390, "comment_id": 80336692, "body": "What does it mean for an inputBox to close? Do you mean a TextBox? Do you mean for it to disappear or remove all text?"}, {"owner": {"reputation": 5589, "user_id": 2516718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f217994662dd192226b028af33abaebc?s=128&d=identicon&r=PG", "display_name": "Daniel Manta", "link": "https://stackoverflow.com/users/2516718/daniel-manta"}, "edited": false, "score": 1, "creation_date": 1507743984, "post_id": 46694390, "comment_id": 80336708, "body": "winforms, WPF, web ? where is that &quot;inputbox&quot;? please tag question"}, {"owner": {"reputation": 7, "user_id": 8760653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8UkDP.jpg?s=128&g=1", "display_name": "Robert Garcia", "link": "https://stackoverflow.com/users/8760653/robert-garcia"}, "edited": false, "score": 0, "creation_date": 1507744302, "post_id": 46694390, "comment_id": 80336922, "body": "it&#39;s windowsform, it&#39;s the inputbox component, I want it to close only I added the code"}, {"owner": {"reputation": 1549, "user_id": 5890367, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10206951008588352/picture?type=large", "display_name": "Blake Thingstad", "link": "https://stackoverflow.com/users/5890367/blake-thingstad"}, "edited": false, "score": 0, "creation_date": 1507744484, "post_id": 46694390, "comment_id": 80337031, "body": "Do you have a link to the inputbox documentation? I can&#39;t find anything on it with a google search. Or perhaps it is a custom form you made?"}, {"owner": {"reputation": 7, "user_id": 8760653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8UkDP.jpg?s=128&g=1", "display_name": "Robert Garcia", "link": "https://stackoverflow.com/users/8760653/robert-garcia"}, "edited": false, "score": 0, "creation_date": 1507748370, "post_id": 46694390, "comment_id": 80339071, "body": "I saw in the inputbox documentation but nothing helped. Thanks friend, I will try another way."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1507761570, "post_id": 46694390, "comment_id": 80344826, "body": "Where did the <code>InputBox</code> component come from? It is not standard in C#."}, {"owner": {"reputation": 5589, "user_id": 2516718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f217994662dd192226b028af33abaebc?s=128&d=identicon&r=PG", "display_name": "Daniel Manta", "link": "https://stackoverflow.com/users/2516718/daniel-manta"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1507840865, "post_id": 46694390, "comment_id": 80383408, "body": "@NetMage, there&#39;s a pop up dialog InputBox to prompt user for a value. Need to add reference to <code>Microsoft.VisualBasic.dll</code> and then you do <code>InputBox(&quot;Question?&quot;,&quot;Title&quot;,&quot;Default Text&quot;);</code>. The control used by OP might be a derived version or something created from scratch, as getPasswordInputBox doesn&#39;t even follow naming convention. It should start with uppercase."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1507844208, "post_id": 46694390, "comment_id": 80385120, "body": "That&#39;s why I don&#39;t think it is the <code>InputBox</code> from VB."}], "owner": {"reputation": 7, "user_id": 8760653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8UkDP.jpg?s=128&g=1", "display_name": "Robert Garcia", "link": "https://stackoverflow.com/users/8760653/robert-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507744201, "creation_date": 1507743498, "last_edit_date": 1507744201, "question_id": 46694390, "link": "https://stackoverflow.com/questions/46694390/how-do-i-associate-esc-key-to-return-cancel-on-a-c-inputbox", "title": "How do I associate ESC key to return/cancel on a C# inputbox?", "body": "<p>I have an inputbox that is receiving a password, but if I press ESC it's the same thing of pressing ENTER for some reason, I would like that ESC have could have the same action as cancel/close box here.</p>\n\n<p>Does anyone have a solution or has been through the same problem?</p>\n\n<pre><code> private void configura\u00e7\u00f5esToolStripMenuItem_Click(object sender, EventArgs e)\n    {\n\n        String result = \"\";\n        InputBox.getPasswordInputBox(\"Senha\", \"Digite a senha\", ref result);\n\n        if (\"xxxx\".Equals(result))\n        {\n            new fConfiguracao().ShowDialog();\n        }\n        else\n        {\n            MessageBox.Show(\"Senha incorreta\");\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "azure", "azure-cosmosdb"], "comments": [{"owner": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "edited": false, "score": 0, "creation_date": 1507789741, "post_id": 46694334, "comment_id": 80352633, "body": "Please read <a href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/tutorial-develop-documentdb-dotnet#parallel-query-execution\" rel=\"nofollow noreferrer\">Parallel query execution</a> and try to specify the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.documents.client.feedoptions.maxdegreeofparallelism?redirectedfrom=MSDN&amp;view=azure-dotnet#overloads\" rel=\"nofollow noreferrer\">MaxDegreeOfParallelism</a> property."}, {"owner": {"reputation": 278, "user_id": 783189, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7510166193c4d718002ccc766e2e3aef?s=128&d=identicon&r=PG", "display_name": "Trey", "link": "https://stackoverflow.com/users/783189/trey"}, "reply_to_user": {"reputation": 21271, "user_id": 6751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kjSAI.jpg?s=128&g=1", "display_name": "Fei Han", "link": "https://stackoverflow.com/users/6751634/fei-han"}, "edited": false, "score": 0, "creation_date": 1507912663, "post_id": 46694334, "comment_id": 80415322, "body": "Thanks. My question means to refer to the capacity of the SDK to convert the .Contains into parallel queries, assuming the MaxDegreeOfParallelism is properly set (which it wasn&#39;t)."}], "answers": [{"tags": [], "owner": {"reputation": 7345, "user_id": 4002490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pnrxe.png?s=128&g=1", "display_name": "Aravind Krishna R.", "link": "https://stackoverflow.com/users/4002490/aravind-krishna-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1508619314, "creation_date": 1508619314, "answer_id": 46867983, "question_id": 46694334, "link": "https://stackoverflow.com/questions/46694334/documentdb-query-with-multiple-partitions-using-ilist-containspartition/46867983#46867983", "title": "DocumentDb query with multiple partitions using IList.Contains(partition)", "body": "<p>Yes, Contains queries (translated to SQL <code>IN</code>) will be batched/parallelized to the matching partitions. Like @fred-han mentions, please set <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.azure.documents.client.feedoptions.maxdegreeofparallelism?redirectedfrom=MSDN&amp;view=azure-dotnet#overloads\" rel=\"nofollow noreferrer\">FeedOptions.MaxDegreeOfParallelism</a>.</p>\n"}], "owner": {"reputation": 278, "user_id": 783189, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7510166193c4d718002ccc766e2e3aef?s=128&d=identicon&r=PG", "display_name": "Trey", "link": "https://stackoverflow.com/users/783189/trey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1508619314, "creation_date": 1507743261, "question_id": 46694334, "link": "https://stackoverflow.com/questions/46694334/documentdb-query-with-multiple-partitions-using-ilist-containspartition", "title": "DocumentDb query with multiple partitions using IList.Contains(partition)", "body": "<p>Can Azure DocumentDB parallelize queries across partitions if the query filter uses the IList Contains method rather than explicitly ORing the partitions?</p>\n\n<p>E.g.</p>\n\n<pre><code>DocumentClient client = ...\nUri documentUri = ...\nFeedOptions = new FeedOptions { EnableCrossPartitionQuery = true };\n\nIList&lt;string&gt; partitions = new List&lt;string&gt; { \"x\", \"y\", \"z\" };\nExpression&lt;Func&lt;ResourceType, bool&gt;&gt; filter =\n    (ResourceType rt) =&gt; partitions.Contains(rt.PartitionId);\n\nIDocumentQuery&lt;ResourceType&gt; queryable =\n    client.CreateDocumentQuery&lt;ResourceType&gt;(documentUri, feedOptions)\n          .Where(filter)\n          .AsDocumentQuery();\nFeedResponse&lt;ResourceType&gt; response = await queryable.ExecuteNextAsync&lt;ResourceType&gt;();\n</code></pre>\n"}, {"tags": ["c#", "plugins", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 1905329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e2b3d3f7c08984d1b3c83ea465c430b?s=128&d=identicon&r=PG", "display_name": "Troublesum", "link": "https://stackoverflow.com/users/1905329/troublesum"}, "edited": false, "score": 0, "creation_date": 1507767403, "post_id": 46694597, "comment_id": 80346270, "body": "Perfect!.. Thank you"}], "tags": [], "owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "is_accepted": true, "score": 1, "last_activity_date": 1507746646, "last_edit_date": 1507746646, "creation_date": 1507744276, "answer_id": 46694597, "question_id": 46694265, "link": "https://stackoverflow.com/questions/46694265/c-outlook-plugin-detect-when-recurring-meeting-is-deleted/46694597#46694597", "title": "C# Outlook Plugin - Detect when recurring meeting is deleted", "body": "<p>Use the <code>RecurrenceState</code> property.</p>\n\n<p>From the documentation, this property is set to the <code>OlRecurrenceState</code> enumeration:</p>\n\n<ul>\n<li>olApptMaster:    1 - The appointment is a master appointment.</li>\n<li>olApptOccurrence:    2 - The appointment is an occurrence of a recurring appointment defined by a master appointment.</li>\n</ul>\n\n<p>Here are a couple of links to the documentation:</p>\n\n<p><a href=\"https://msdn.microsoft.com/VBA/Outlook-VBA/articles/appointmentitem-recurrencestate-property-outlook\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/VBA/Outlook-VBA/articles/appointmentitem-recurrencestate-property-outlook</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/VBA/Outlook-VBA/articles/olrecurrencestate-enumeration-outlook\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/VBA/Outlook-VBA/articles/olrecurrencestate-enumeration-outlook</a></p>\n"}], "owner": {"reputation": 237, "user_id": 1905329, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5e2b3d3f7c08984d1b3c83ea465c430b?s=128&d=identicon&r=PG", "display_name": "Troublesum", "link": "https://stackoverflow.com/users/1905329/troublesum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "accepted_answer_id": 46694597, "answer_count": 1, "score": 1, "last_activity_date": 1507746646, "creation_date": 1507742971, "question_id": 46694265, "link": "https://stackoverflow.com/questions/46694265/c-outlook-plugin-detect-when-recurring-meeting-is-deleted", "title": "C# Outlook Plugin - Detect when recurring meeting is deleted", "body": "<p>I need my plugin to detect when a recurring meeting is deleted. My problem is the BeforeDelete event is fired off in the same manner if I delete just one of the occurrences in the set or if I delete the entire set. I need to know when a user is deleting the entire set and not just a single occurrence with in it. Is there a variable in Item that gives reference to this?</p>\n\n<pre><code>public void MailItem_BeforeDelete(object Item, ref bool Cancel) {\n\n     Outlook.AppointmentItem MailItem = Item as Outlook.AppointmentItem;\n\n     //Somewhere in this little guy [MailItem] should be something telling me if the \n     //item that is being deleted is a single occurance or is the entire set that is being deleted?\n     //MailItem.IsRecurring is true in both instances so thats doesnt work. \n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", "asp.net-core-mvc", "asp.net-core-2.0"], "answers": [{"comments": [{"owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "edited": false, "score": 0, "creation_date": 1507761577, "post_id": 46696111, "comment_id": 80344829, "body": "Did you try removing the <code>MapRoute</code> and just use default mvc routing? Get and Post methods should be accessible that way. Now regarding to other   extra GET and POST methods, there is an ordering logic on how the mvc picks which method first. Maybe you should update your post and post those extra methods too."}], "tags": [], "owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "is_accepted": false, "score": 3, "last_activity_date": 1507750226, "creation_date": 1507750226, "answer_id": 46696111, "question_id": 46694246, "link": "https://stackoverflow.com/questions/46694246/how-can-add-separate-default-routes-for-get-and-post-requests-in-asp-net-core-2/46696111#46696111", "title": "How can add separate default routes for GET and POST requests in ASP.NET Core 2.0 MVC?", "body": "<p>Of course every request will use the <code>Get</code> method because you told it to default it to:</p>\n\n<pre><code>routes.MapRoute(\"default\", \"api/{controller}/{action=Get}\");\n</code></pre>\n\n<p>If you specify the literal segment (action token), i.e., <code>/api/example/get</code>, MVC sees that as the top-most level in the pecking order. That's why it always pick <code>Get</code> action inside your controller because you have specified the action token as well in the url.</p>\n\n<p><strong>Don't do that with web api!</strong></p>\n\n<p>Instead, web api uses <code>HttpVerb</code> to map the route. So you shouldn't specify the <code>HttpVerb</code> along with the Url. You supply the <code>HttpVerb</code>as the method type along with the request instead.</p>\n\n<p>Think about api routes as identifying a resource / resource collection. It's different than how you think with MVC (RPC style).</p>\n\n<p>Change to these and give it a try:</p>\n\n<h1>Startup.cs</h1>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    services.AddMvc();\n}\n\npublic void Configure(IApplicationBuilder app, IHostingEnvironment env)\n{\n    app.UseMvcWithDefaultRoute();\n}\n</code></pre>\n\n<h1>Customer resource</h1>\n\n<pre><code>[Route(\"api/[controller]\")]\npublic class CustomersController : Controller \n{\n    [HttpGet]\n    public IActionResult Get()\n    {   ...   }\n\n    [HttpPost]\n    public IActionResult Post()\n    {   ...   }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5477154"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1581, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1507759938, "creation_date": 1507742895, "last_edit_date": 1507759938, "question_id": 46694246, "link": "https://stackoverflow.com/questions/46694246/how-can-add-separate-default-routes-for-get-and-post-requests-in-asp-net-core-2", "title": "How can add separate default routes for GET and POST requests in ASP.NET Core 2.0 MVC?", "body": "<p>Currently I have the following in my Startup.cs class:</p>\n\n<pre><code>app.UseMvc(routes =&gt;\n    {\n        routes.MapRoute(\"default\", \"api/{controller}/{action=Get}\");\n    });\n</code></pre>\n\n<p>All my MVC controllers have a method Get on them, and a number of them have a Post as well. Something like this:</p>\n\n<pre><code>public class ExampleController : Controller\n{\n    [HttpGet]\n    public MyType Get()\n    {\n        return GetMyTypeFromSomewhere();\n    }\n\n    [HttpPost(\"api/[controller]\")]\n    public void Post([FromBody]MyType updated)\n    {\n        //do some stuff with the new instance\n    }\n}\n</code></pre>\n\n<p>Currently I need to have <code>(\"api/[controller]\")</code> on the Post method so that post requests will reach it.</p>\n\n<p>I wish to be able to remove this and redirect POST requests to controller Post methods by default. Problem is, if I do so in the current state, HTTP POST requests will end up posting to <code>/api/Example/Get</code>.</p>\n\n<p>I have looked into <code>MapGet</code> and <code>MapPost</code>, but the only implementations of these I can find short circuit the pipeline, handling and responding within the RequestDelegate passed. My controller methods are never reached this way.</p>\n\n<p>How can I achieve this?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>It would probably be worth adding, some controllers have extra GET and POST methods on them which are reached at <code>api/controller/action</code>, meaning I need to have a route to <code>{action}</code> specified somewhere. However doing so means that my default Get and Post methods are no longer accessible by just the controller name, hence adding <code>=Get</code> as a default action in MapRoute</p>\n"}, {"tags": ["c#", "sql-server"], "comments": [{"owner": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 0, "creation_date": 1507743045, "post_id": 46694231, "comment_id": 80336239, "body": "The login failed is a different issue than what you are asking."}, {"owner": {"reputation": 2123, "user_id": 2367096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GeWgS.png?s=128&g=1", "display_name": "Seano666", "link": "https://stackoverflow.com/users/2367096/seano666"}, "edited": false, "score": 0, "creation_date": 1507743071, "post_id": 46694231, "comment_id": 80336257, "body": "The application can&#39;t log into SQL with that connection string.  After you&#39;ve fixed that you should be able to do whatever you want."}, {"owner": {"reputation": 61, "user_id": 8066749, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/bbfcaa07a780ef902b18c77183c37110?s=128&d=identicon&r=PG&f=1", "display_name": "user8066749", "link": "https://stackoverflow.com/users/8066749/user8066749"}, "reply_to_user": {"reputation": 2123, "user_id": 2367096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GeWgS.png?s=128&g=1", "display_name": "Seano666", "link": "https://stackoverflow.com/users/2367096/seano666"}, "edited": false, "score": 0, "creation_date": 1507743256, "post_id": 46694231, "comment_id": 80336339, "body": "@Seano666 so the code is good to update disable trigger? if the login error fixed?"}, {"owner": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 0, "creation_date": 1507744217, "post_id": 46694231, "comment_id": 80336869, "body": "Answered here. <a href=\"https://stackoverflow.com/questions/2838062/enable-disable-trigger-via-code-c-sharp\" title=\"enable disable trigger via code c sharp\">stackoverflow.com/questions/2838062/&hellip;</a>"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 4, "creation_date": 1507744604, "post_id": 46694231, "comment_id": 80337099, "body": "I have to say the disabling a database trigger is a pretty good indication that there are some serious design issues."}], "owner": {"reputation": 61, "user_id": 8066749, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/bbfcaa07a780ef902b18c77183c37110?s=128&d=identicon&r=PG&f=1", "display_name": "user8066749", "link": "https://stackoverflow.com/users/8066749/user8066749"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1507745008, "answer_count": 0, "score": 0, "last_activity_date": 1507743206, "creation_date": 1507742841, "last_edit_date": 1507743206, "question_id": 46694231, "link": "https://stackoverflow.com/questions/46694231/enabling-disabling-sqlserver-trigger-on-button-click", "closed_reason": "Duplicate", "title": "Enabling Disabling Sqlserver Trigger on button Click", "body": "<p>Is it possible to enable or disable sqlserver triggers from C# on Button Click</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n        {\n           try\n                {\n                    string connectionString = @\"Data Source=ABC-SERVER;Initial Catalog=TESTCO;Persist Security Info=True;User ID=sa;Password=password\";\n                    using (SqlConnection conn =\n                        new SqlConnection(connectionString))\n                    {\n                        conn.Open();\n                        using (SqlCommand cmd =new SqlCommand(\"DISABLE TRIGGER [dbo].[MSETUP] ON [dbo].[parts] \", conn))\n                        {\n                             int rows = cmd.ExecuteNonQuery();\n\n                        }\n                    }\n                }\n                catch (SqlException ex)\n                {\n                    MessageBox.Show(ex.Message);\n\n                }\n          }\n</code></pre>\n\n<p>How can i get this to work from C# or any suggestions?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 1771, "user_id": 8365439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v76vl.jpg?s=128&g=1", "display_name": "Valerii", "link": "https://stackoverflow.com/users/8365439/valerii"}, "edited": false, "score": 0, "creation_date": 1507743180, "post_id": 46694180, "comment_id": 80336305, "body": "You can iterate throw collection and create instances of TechnicianViewModel and add to your list. To copy properties you can use automaper."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 1771, "user_id": 8365439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v76vl.jpg?s=128&g=1", "display_name": "Valerii", "link": "https://stackoverflow.com/users/8365439/valerii"}, "edited": false, "score": 0, "creation_date": 1507743856, "post_id": 46694180, "comment_id": 80336634, "body": "Can you show me how that is done, I am using IEnumerable Collection, how would a list help ?"}, {"owner": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1507743863, "post_id": 46694180, "comment_id": 80336643, "body": "What are you stuck on? You just map the needed properties <code>new TechnicianViewModel { Id = item.UserId, ... }</code>. You don&#39;t need an explicit loop either -- you can use a projection <code>data.Select(t =&gt; new TechnicianViewModel { Id = t.UserId, ... })</code>"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1507743960, "post_id": 46694180, "comment_id": 80336697, "body": "@Jasen I was trying to do the following : <code>this.ID = item.UserId</code>.. but let me try that projection property, I am still new to this."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1507744148, "post_id": 46694180, "comment_id": 80336817, "body": "@Jasen ..Is it fine that I am doing all this within the constructor of the same View Model"}, {"owner": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1507744167, "post_id": 46694180, "comment_id": 80336833, "body": "What you are doing doesn&#39;t make sense. It looks like you are trying to assign a collection to a single instance. If you want a collection of TechnicianViewModels then move the query out of the constructor."}, {"owner": {"reputation": 1037, "user_id": 2655263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2sZ0.jpg?s=128&g=1", "display_name": "Kevin Fichter", "link": "https://stackoverflow.com/users/2655263/kevin-fichter"}, "edited": false, "score": 0, "creation_date": 1507744526, "post_id": 46694180, "comment_id": 80337054, "body": "It might be helpful to sketch out the entities and what they&#39;re doing.  I&#39;m trying to picture what you want the end result to look like.  Is the idea to have one page (one VM) that displays 8 rows with tech info?  If so, then the VM would have the properties for the page, including a collection of techs.  The Controller will get the techs and generate the VM, passing in the techs.  Then it passes that VM to the view.  In the view, you can iterate through the techs."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "edited": false, "score": 0, "creation_date": 1507744547, "post_id": 46694180, "comment_id": 80337069, "body": "@Jasen I edited my question based on what you had commented, now can you take a look and advice on creating multiple instances of the <code>TechnicianViewModel</code>"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 1037, "user_id": 2655263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2sZ0.jpg?s=128&g=1", "display_name": "Kevin Fichter", "link": "https://stackoverflow.com/users/2655263/kevin-fichter"}, "edited": false, "score": 0, "creation_date": 1507744663, "post_id": 46694180, "comment_id": 80337134, "body": "@K_foxer9 I as actually able to do that without using a ViewModel, the reason for introducing a viewmodel was to get the selected technician&#39;s ID sent back via the view model rather than the querystring. So that I have clean URL."}, {"owner": {"reputation": 1037, "user_id": 2655263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2sZ0.jpg?s=128&g=1", "display_name": "Kevin Fichter", "link": "https://stackoverflow.com/users/2655263/kevin-fichter"}, "edited": false, "score": 0, "creation_date": 1507744868, "post_id": 46694180, "comment_id": 80337235, "body": "In that case, I&#39;d suggest adding a ctor in the vm that takes a tech model and maps the few properties. Then, all you have to do is modify the data query and tack on after the last Where ... Select(a =&gt; new TechViewModel(a)); You might want to call ToList() before that select, though."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 1037, "user_id": 2655263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2sZ0.jpg?s=128&g=1", "display_name": "Kevin Fichter", "link": "https://stackoverflow.com/users/2655263/kevin-fichter"}, "edited": false, "score": 0, "creation_date": 1507744985, "post_id": 46694180, "comment_id": 80337298, "body": "@K_foxer9 Can you give me a rundown on how that would look like, still new to all of this..."}, {"owner": {"reputation": 1037, "user_id": 2655263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2sZ0.jpg?s=128&g=1", "display_name": "Kevin Fichter", "link": "https://stackoverflow.com/users/2655263/kevin-fichter"}, "edited": false, "score": 0, "creation_date": 1507745227, "post_id": 46694180, "comment_id": 80337417, "body": "<a href=\"https://stackoverflow.com/a/46694740/2655263\">@Jasen&#39;s answer</a> is pretty much what I was suggesting, except for the ctor bit.  Same end result."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 1037, "user_id": 2655263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2sZ0.jpg?s=128&g=1", "display_name": "Kevin Fichter", "link": "https://stackoverflow.com/users/2655263/kevin-fichter"}, "edited": false, "score": 0, "creation_date": 1507747552, "post_id": 46694180, "comment_id": 80338666, "body": "@K_foxer9 I was able to use Jasen&#39;s answer and solve the issue at hand. Now the main reason for me using a view model was to pass the ID of the selected Technician to the controller using a view model. Can you advice how I can achieve that without using <code>[HttpGet]</code>"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "reply_to_user": {"reputation": 1037, "user_id": 2655263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2sZ0.jpg?s=128&g=1", "display_name": "Kevin Fichter", "link": "https://stackoverflow.com/users/2655263/kevin-fichter"}, "edited": false, "score": 0, "creation_date": 1507749989, "post_id": 46694180, "comment_id": 80339827, "body": "@K_foxer9 Can you take a look at this :- <a href=\"https://stackoverflow.com/questions/46695950/how-to-get-the-view-to-return-the-id-via-a-viewmodel-to-the-controller\" title=\"how to get the view to return the id via a viewmodel to the controller\">stackoverflow.com/questions/46695950/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507745295, "post_id": 46694740, "comment_id": 80337462, "body": "Let me try this out, seems like a solution to my issue here"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507746728, "post_id": 46694740, "comment_id": 80338197, "body": "Ok this works, now how do I use this <code>TechnicianViewModel</code> to transfer the selected object back to the controller without the controller method being a [HttpGet] method. Because that is the whole reason why I introduced a View Model into the picture."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507746831, "post_id": 46694740, "comment_id": 80338252, "body": "I appreciate all your assistance here. Thanks !"}, {"owner": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "reply_to_user": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507747703, "post_id": 46694740, "comment_id": 80338742, "body": "I left GET/POST out of the answer because it was unclear how you would use it. You can add <code>[HttpPost]</code> if you require that. Then change the string parameters to a <code>TechnicianViewModel</code> for the action signature."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507748186, "post_id": 46694740, "comment_id": 80338984, "body": "This is what I am doing inside my view for someone to select a specific technician.So it is basically going to a different function within the controller.   <code>@Url.Action(&quot;Profile&quot;,&quot;Technician&quot;,new { url = item.GenerateURL() })</code>"}, {"owner": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "reply_to_user": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507748395, "post_id": 46694740, "comment_id": 80339090, "body": "An anchor will generate a GET request. And it sounds like a different problem. You should create a new question (if one doesn&#39;t already exist)."}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507748535, "post_id": 46694740, "comment_id": 80339160, "body": "Ok let me write another question and probably you could help me out on it. Thanks"}, {"owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "edited": false, "score": 0, "creation_date": 1507749591, "post_id": 46694740, "comment_id": 80339643, "body": "Checkout the question here :- <a href=\"https://stackoverflow.com/questions/46695950/how-to-get-the-view-to-return-the-id-via-a-viewmodel-to-the-controller\" title=\"how to get the view to return the id via a viewmodel to the controller\">stackoverflow.com/questions/46695950/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13140, "user_id": 2030565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FWvli.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/2030565/jasen"}, "is_accepted": true, "score": -1, "last_activity_date": 1507744834, "creation_date": 1507744834, "answer_id": 46694740, "question_id": 46694180, "link": "https://stackoverflow.com/questions/46694180/how-to-create-multiple-instances-of-a-viewmodel-based-on-the-ienumerable-data-ob/46694740#46694740", "title": "How to create multiple instances of a ViewModel based on the IEnumerable data object?", "body": "<p>I'd argue the query doesn't belong in a view model. If you want a collection of your view model then move this query out of the constructor. You can do it in the controller action.</p>\n\n<pre><code>public ActionResult GetTechnicians(string branch, string status)\n{\n    var data = unitOfWork.TechnicianRepository.GetAll()\n                   .Where(c =&gt; c.Branch == \"Calgary\")\n                   .Where(a =&gt; a.ActivityStatus == \"Active\")\n                   .Select(t =&gt; new TechnicianViewModel\n                   {\n                       Id = t.UserId,\n                       UserName = t.UserName,\n                       Bio = t.Bio\n                   });\n    ...\n}\n</code></pre>\n\n<p>When you have a number of these or if you find yourself repeating this query move it to a new class.</p>\n\n<pre><code>public class TechnicianService\n{\n    private AADataContext context;\n\n    public TechnicianService(AADataContext context)\n    {\n        this.context = context;\n    }\n\n    public IEnumerable&lt;TechnicianViewModel&gt; GetTechnicians(string branch, string status)\n    {\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 1525396, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/pigQs.jpg?s=128&g=1", "display_name": "Umar Aftab", "link": "https://stackoverflow.com/users/1525396/umar-aftab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 46694740, "answer_count": 1, "score": 0, "last_activity_date": 1507758788, "creation_date": 1507742644, "last_edit_date": 1507758788, "question_id": 46694180, "link": "https://stackoverflow.com/questions/46694180/how-to-create-multiple-instances-of-a-viewmodel-based-on-the-ienumerable-data-ob", "title": "How to create multiple instances of a ViewModel based on the IEnumerable data object?", "body": "<p>I have a technician repository returning 8 results. I want to instantiate the ViewModel properties with those results. How can I achieve that ?</p>\n\n<pre><code>public class TechnicianViewModel\n{\n    public Guid ID { get; set; }\n    public string UserName { get; set; }\n    public string Bio { get; set; }\n    public string GenerateName()\n    {\n        string str = GenerateURL();\n        str = str + \".jpg\";\n        return str;\n    }\n    public string GenerateURL()\n    {\n        string phrase = string.Format(\"{0}\", UserName);\n        string str = phrase.ToLower();\n        str = Regex.Replace(str, @\"\\s\", \"-\");\n        return str;\n    }\n}\n</code></pre>\n\n<p>The value returned by the data object contains the 8 results grouped as the technician model.</p>\n\n<p>And the Technician Model looks like this. </p>\n\n<pre><code>   public class Technician\n   {\n    [ScaffoldColumn(false)]\n    [Key]\n    public Guid UserId { get; set; }\n\n    [Required]\n    public string UserName { get; set; }\n\n    [Required]\n    public bool Licensed { get; set; }\n\n    [Required]\n    public bool Insured { get; set; }\n\n    [Required]\n    public bool DrugTested { get; set; }\n\n    public string EducationalLevel { get; set; }\n\n    public string Specialities { get; set; }\n\n    public string Bio { get; set; }\n\n    [Required,Display(Name = \"Date of Birth\")]\n    public DateTime DOB { get; set; }\n\n    public bool IsFormerTech { get; set; }\n\n    public DateTime ExperienceDate { get; set; }\n\n    public string MobilePhone { get; set; }\n\n    [Required]\n    public string Branch { get; set; }\n\n    public DateTime ApprenticeshipStatusDate { get; set; }\n\n    public string ActivityStatus { get; set; }\n\n    public string ReviewURL { get; set; }\n</code></pre>\n\n<p>Edit:-</p>\n\n<p>I have moved the query out of the constructor, now I will try to access it within the controller.</p>\n\n<pre><code>    public class TechnicianController : Controller\n   {\n    private readonly AADataContext aADataContext;\n    private readonly UnitOfWork unitOfWork;\n    private readonly TechnicianViewModel TechnicianViewModel;\n\n\n    public TechnicianController(AADataContext context)\n    {\n        aADataContext = context;\n        unitOfWork = new UnitOfWork(aADataContext);\n        var data = unitOfWork.TechnicianRepository.GetAll().Where(c =&gt; c.Branch == \"Calgary\").Where(a =&gt; a.ActivityStatus == \"Active\");\n\n\n    }\n</code></pre>\n"}, {"tags": ["c#", ".net", "automapper"], "comments": [{"owner": {"reputation": 1771, "user_id": 8365439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v76vl.jpg?s=128&g=1", "display_name": "Valerii", "link": "https://stackoverflow.com/users/8365439/valerii"}, "edited": false, "score": 0, "creation_date": 1507743814, "post_id": 46694166, "comment_id": 80336609, "body": "It looks like the same problem as I had: <a href=\"https://stackoverflow.com/questions/46186129/map-nested-elements-to-related-lists-using-automapper\" title=\"map nested elements to related lists using automapper\">stackoverflow.com/questions/46186129/&hellip;</a>"}, {"owner": {"reputation": 1771, "user_id": 8365439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v76vl.jpg?s=128&g=1", "display_name": "Valerii", "link": "https://stackoverflow.com/users/8365439/valerii"}, "edited": false, "score": 0, "creation_date": 1507743855, "post_id": 46694166, "comment_id": 80336632, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46186129/map-nested-elements-to-related-lists-using-automapper\">Map nested elements to related lists using AutoMapper</a>"}, {"owner": {"reputation": 111, "user_id": 7817752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2e3450fdf8f605a9b88c05f06091f95?s=128&d=identicon&r=PG&f=1", "display_name": "Ssheverdin", "link": "https://stackoverflow.com/users/7817752/ssheverdin"}, "edited": false, "score": 0, "creation_date": 1507745609, "post_id": 46694166, "comment_id": 80337605, "body": "I think you are looking for ProjectTo&lt;&gt;() <a href=\"https://github.com/AutoMapper/AutoMapper/wiki/Queryable-Extensions\" rel=\"nofollow noreferrer\">github.com/AutoMapper/AutoMapper/wiki/Queryable-Extensions</a>"}], "owner": {"reputation": 453, "user_id": 3185855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1f644e46078235890681775d07e93354?s=128&d=identicon&r=PG", "display_name": "Eldorian", "link": "https://stackoverflow.com/users/3185855/eldorian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1260, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507743215, "creation_date": 1507742610, "last_edit_date": 1507743215, "question_id": 46694166, "link": "https://stackoverflow.com/questions/46694166/automapper-how-do-i-iterate-through-a-collection", "title": "Automapper: how do I iterate through a collection", "body": "<p>Right now I have some models that look like this:</p>\n\n<p>Consumer ResourceModel:</p>\n\n<pre><code>    public ConsumerResourceModel()\n    {\n        consumerData = new List&lt;ConsumerData&gt;();\n        Memberships = new List&lt;MemberResourceModel&gt;();\n    }\n\n    public List&lt;ConsumerData&gt; consumerData { get; set; }\n    public List&lt;MemberResourceModel&gt; Memberships { get; set; }\n</code></pre>\n\n<p>ConsumerResponseModel:</p>\n\n<pre><code> public class ConsumerResponseModel\n{\n    public List&lt;Consumer&gt; consumers { get; set; }\n}\n\npublic class Membership\n{\n    public string membershipType { get; set; }\n}\n\npublic class Consumer\n{\n    public decimal consumerId { get; set; }\n    public Name name { get; set; }\n    public List&lt;Membership&gt; memberships { get; set; }\n}\n</code></pre>\n\n<p>My current Mapping looks like this:</p>\n\n<pre><code> public static class AutoMapperConfig\n{\n    public static void RegisterMappings()\n    {\n        Mapper.Initialize(config =&gt;\n        {\n            config.CreateMap&lt;ConsumerData, Consumer&gt;()                    \n                .ForMember(dest=&gt;dest.memberships, opts=&gt;opts.MapFrom(src=&gt;new List&lt;Membership&gt;()))\n                .ReverseMap();\n\n            config.CreateMap&lt;ConsumerData, Name&gt;()\n                .ReverseMap();\n\n            config.CreateMap&lt;MemberResourceModel, Membership&gt;()  \n                .ReverseMap();\n        });\n    }\n</code></pre>\n\n<p>I have everything being mapped correctly for consumer and membership but I'm basically having to do something like this in my method:</p>\n\n<pre><code>        public ConsumerResponseModel MapConsumer(IEnumerable&lt;ConsumerResourceModel&gt; res)\n    {\n        var responseModel = new ConsumerResponseModel {consumers = new List&lt;Consumer&gt;()};\n        var consumerResourceModels = res as IList&lt;ConsumerResourceModel&gt; ?? res.ToList();\n        foreach (var item in consumerResourceModels)\n        {\n            foreach(var consumerData in item.consumerData)\n            {\n                  var consumer = Mapper.Map&lt;Consumer&gt;(consumerData);\n\n                  foreach(var membership in item.Memberships)\n                  {\n                       consumer.memberships.Add(Mapper.Map&lt;Membership&gt;(membership);\n                  }\n                responseModel.consumers.Add(consumer);\n             }\n        }\n        return responseModel;\n    }\n</code></pre>\n\n<p>While this code is doing the mapping I need it to do and everything works fine, I'm trying to figure out how I can make one call to Mapper.Map and it just automaps everything in this collection for me instead of having this extra method iterating through and just have it all being done in my AutoMapperConfig class.</p>\n\n<p>I'm having a tough time wrapping my head around how to get that piece to work as everything I have tried like doing .AfterMap in the ConsumerData, Consumer mapping just ends up creating empty memberships. I haven't mapped ConsumerResourceModel yet as I figured once I learned how to map the memberships then I could move a level up to map that all correctly.</p>\n"}]